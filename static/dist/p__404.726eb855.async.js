"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[571],{6145:function(Oe,$,t){t.r($),t.d($,{default:function(){return Ke}});var w=t(97857),r=t.n(w),b=t(57288),_=t(15009),G=t.n(_),ee=t(99289),te=t.n(ee),ae=t(5574),T=t.n(ae),ne=t(33067),z=t(38345),le=t(16968),W=t(1524),V=t(13943),Z=t(7837),Q=t(27076),se=t(63430),re=t(79611),ie=t(78677),oe=t(14474),de=t(80652),ue=t(98165),ve=t(99559),fe=t(7134),Y=t(71230),P=t(15746),J=t(15867),ce=t(3321),X=t(86250),me=t(48096),ge=t(45582),xe=t(27484),k=t.n(xe),F=t(67294),he=t(13208),ye=t(33237),pe=t(17003),B={pageHeaderContent:"pageHeaderContent___exWxI",avatar:"avatar___rptEO",content:"content___jBAzR",contentTitle:"contentTitle___TsVhT",extraContent:"extraContent___tNqx0",statItem:"statItem___jPU6u"},e=t(85893),je=function(o){var u=(0,Z.useModel)("@@initialState"),l=u.initialState,i=l.currentUser,s=i&&Object.keys(i).length;return s?(0,e.jsxs)("div",{className:B.pageHeaderContent,children:[(0,e.jsx)("div",{className:B.avatar,children:(0,e.jsx)(fe.C,{size:"large",src:i.avatar?i.avatar:l==null?void 0:l.settings.logo})}),(0,e.jsxs)("div",{className:B.content,children:[(0,e.jsx)("div",{className:B.contentTitle,children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsxs)(P.Z,{span:12,children:["\u4F60\u597D\uFF0C",i.realname?i.realname:i.name]}),(0,e.jsx)(P.Z,{span:12,style:{textAlign:"right"},children:(0,e.jsx)(Se,{})})]})}),(0,e.jsxs)("div",{children:[i.rolename," ",(0,e.jsx)(J.ZP,{shape:"circle",type:"text",onClick:function(){var c;(c=o.flash)===null||c===void 0||c.call(o)},icon:(0,e.jsx)(ue.Z,{})})]})]})]}):(0,e.jsx)(ve.Z,{avatar:!0,paragraph:{rows:1},active:!0})},Se=function(){var o=(0,F.useState)(k()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),u=T()(o,2),l=u[0],i=u[1],s=function d(){i(k()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),setTimeout(function(){return d()},1e3)};return setTimeout(function(){return s()},1e3),(0,e.jsx)(e.Fragment,{children:l})},Ze=function(o){var u=o.url,l=u===void 0?"":u,i=(0,F.useState)(),s=T()(i,2),d=s[0],c=s[1],M=ce.Z.useApp(),C=M.message,L=(0,F.useState)(),N=T()(L,2),A=N[0],H=N[1],I=(0,Z.useModel)("@@initialState"),K=I.initialState,R=function(){var a=te()(G()().mark(function n(){var f,g,m,y=arguments;return G()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return f=y.length>0&&y[0]!==void 0?y[0]:{},C.loading("\u52A0\u8F7D\u4E2D..."),v.next=4,ne.ZP.get(l,{params:r()(r()({},A),f),then:function(){}});case 4:g=v.sent,m=g.data,C.destroy(),c(m);case 8:case"end":return v.stop()}},n)}));return function(){return a.apply(this,arguments)}}();(0,F.useEffect)(function(){R()},[]);var O=function(n){var f=n.type;if(f=="pie")return(0,e.jsx)(se.Z,r()({height:280,appendPadding:10,data:n.data,radius:.9,label:{type:"inner",offset:"-30%",content:function(y){var S=y.percent;return"".concat((S*100).toFixed(0),"%")},style:{fontSize:14,textAlign:"center"}},interactions:[{type:"element-active"}]},n.config));if(f=="bar")return(0,e.jsx)(re.Z,r()({xField:"x",yField:"y",data:n.data},n.config));if(f=="column")return(0,e.jsx)(ie.Z,r()({xField:"x",yField:"y",data:n.data},n.config));if(f=="areaMap"){var g=r()({map:{type:"mapbox",style:"blank",center:[120.19382669582967,30.258134],zoom:13,pitch:0},source:{data:n.data,parser:{type:"geojson"}},autoFit:!0,color:{field:n.field,value:["#1A4397","#3165D1","#6296FE","#98B7F7","#DDE6F7","#F2F5FC"].reverse(),scale:{type:"quantile"}},style:{opacity:1,stroke:"#eee",lineWidth:.8,lineOpacity:1},state:{active:!0,select:{stroke:"blue",lineWidth:1.5,lineOpacity:.8}},label:{visible:!0,field:"name",style:{fill:"black",opacity:.5,fontSize:12,spacing:1,padding:[15,15]}},zoom:{position:"bottomright"},legend:{position:"bottomleft"}},n.config);return(0,e.jsx)("div",{style:{width:"100%",height:500},children:(0,e.jsx)(oe.Z,r()({},g))})}else return(0,e.jsx)(de.Z,r()({smooth:!0,height:280,data:n.data,xField:"x",yField:"y",title:{visible:!0,text:n.title,style:{fontSize:14}},meta:{y:{alias:n.y}},label:{content:function(y){return y.y},position:"top",style:{fill:"#000000",opacity:.6}}},n.config))},U=function a(n,f){var g;return(0,e.jsx)(X.Z,{vertical:!0,gap:"middle",children:n==null||(g=n.row)===null||g===void 0?void 0:g.map(function(m,y){var S;return(0,e.jsxs)(Y.Z,{gutter:[16,16],children:[m.form?(0,e.jsx)(P.Z,{span:24,children:(0,e.jsx)(z.Z,{bodyStyle:{padding:0},children:(0,e.jsx)(le.Z,{layoutType:"QueryFilter",columns:(0,ye.ab)({initRequest:!0,columns:m.form.columns,devEnable:!1}),initialValues:A||m.form.value,onFinish:function(p){R(p),console.log("onFinish",p)}})})},y+"form"):null,m==null||(S=m.col)===null||S===void 0?void 0:S.map(function(v,p){if(v.row){var D;return(0,e.jsx)(P.Z,{span:v.span?v.span:24/((D=m.col)===null||D===void 0?void 0:D.length),children:a(v,f)},p)}else if(v.tab){var x;return(0,e.jsx)(P.Z,{span:v.span?v.span:24/((x=m.col)===null||x===void 0?void 0:x.length),children:(0,e.jsx)(z.Z,{style:{borderTopRightRadius:0,borderTopLeftRadius:0},children:(0,e.jsx)(me.Z,{style:{background:"none"},tabBarStyle:{paddingLeft:0,marginBottom:0},items:v.tab.map(function(j,q){return{key:q,label:j.title,children:j.row?a(j,f):f(j,q,{notitle:!0})}})})},p)},p)}else{var h;return(0,e.jsx)(P.Z,{span:v.span?v.span:24/((h=m.col)===null||h===void 0?void 0:h.length),children:f(v,p)},p)}})]},y)})})};return(0,e.jsx)(W._z,{title:!1,className:"saContainer",fixedHeader:Q.P.fixedHeader,header:{breadcrumbRender:function(n,f){return(0,e.jsx)(b.Lr,{})}},children:(0,e.jsxs)(X.Z,{vertical:!0,gap:"middle",children:[(0,e.jsx)(z.Z,{children:(0,e.jsx)(je,{flash:R})},"headcard"),U(d,function(a,n,f){return a.type=="card"?(0,e.jsx)(V.Z,{style:{height:"100%"},statistic:{title:a.title,value:a.value,prefix:a.prefix,suffix:a.suffix,description:a.href?(0,e.jsx)(Z.Link,{to:a.href,style:{fontSize:12},children:"\u67E5\u770B\u66F4\u591A"}):""}},n+"card"):a.type=="table"?(0,e.jsx)(z.Z,{style:{height:"100%"},children:(0,e.jsx)(ge.Z,r()({columns:(0,pe.S)({initRequest:!0,columns:a.columns,initialState:K,devEnable:!1}),dataSource:a.data,title:function(){return a.title},rowKey:"id"},a.props))},n+"table"):a.type=="mapDots"?(0,e.jsx)(z.Z,{title:a.title,style:{height:"100%"},children:(0,e.jsx)(he.O1,r()(r()({},a.props),{},{dots:a.data}))},n+"mapDots"):(0,e.jsx)(V.Z,{style:{height:"100%"},title:f!=null&&f.notitle?(0,e.jsx)("div",{style:{height:20}}):a.title,chart:O(a)},n+"chart")})]})})},Pe=Ze,Fe=t(19632),Ce=t.n(Fe),Te=t(9783),De=t.n(Te),Ee=t(95038),Me=t(34528),Ue=t(21655),Ne=t(85109),Ae=function(o){var u=o.tableTitle,l=u===void 0?!1:u,i=o.path,s=o.leftMenu,d=s===void 0?{name:"categorys",url_name:"category_id",title:"\u5206\u7C7B\u9009\u62E9",field:{title:"label",key:"value"}}:s,c=d?d.name:"",M=d?d.title:"",C=d?d.url_name:"",L=d?d.field:!1,N=(0,F.useState)([]),A=T()(N,2),H=A[0],I=A[1],K=(0,Z.useSearchParams)(),R=T()(K,2),O=R[0],U=R[1],a=O.get(C),n=(0,F.useState)(a?isNaN(a)?a:parseInt(a):0),f=T()(n,2),g=f[0],m=f[1],y=(0,F.useState)([]),S=T()(y,2),v=S[0],p=S[1];return(0,e.jsx)(W._z,{title:l,className:"saContainer",fixedHeader:Q.P.fixedHeader,header:{breadcrumbRender:function(x,h){return(0,e.jsx)(b.Lr,{path:i})}},children:(0,e.jsxs)(Y.Z,{gutter:[24,16],style:H.length>1?{marginLeft:0,marginRight:0}:{},children:[H.length>1&&(0,e.jsxs)(P.Z,{span:3,title:M,style:{background:"#fff",paddingTop:20},children:[(0,e.jsx)(Me.Z,{level:5,children:M}),(0,e.jsx)(Ee.Z,{selectedKeys:[g],expandedKeys:v,treeData:H,fieldNames:L,onSelect:function(x){var h=0;x.length>0&&(h=x.pop()),m(h);var j=(0,b.Cc)([C]);h&&(j[C]=h+""),U(r()({},j))},onExpand:function(x){p(x)}})]}),(0,e.jsx)(P.Z,{span:H.length>1?21:24,children:(0,e.jsx)(Ne.Z,r()(r()({},o),{},{paramExtra:g?r()(r()({},o.paramExtra),{},De()({},C,g)):r()({},o.paramExtra),beforeTableGet:function(x){var h;if(d&&!(H.length>0||!((h=x.search)!==null&&h!==void 0&&h[c]))&&(I(Ce()(x.search[c])),g&&v.length<1)){var j=(0,b.aT)(x.search[c],g,{id:"value",children:"children"});console.log(j,111),p(j)}},tableProps:o.tableProps}))})]})})},He=Ae,Re=t(32250),be=t(72644),ze=t(83832),Le=t(29905),Be=function(){return(0,e.jsx)(Le.ZP,{status:"403",title:"403",subTitle:"\u4F60\u6CA1\u6709\u6B64\u9875\u9762\u7684\u8BBF\u95EE\u6743\u9650",extra:(0,e.jsx)(J.ZP,{type:"primary",onClick:function(){return Z.history.push("/")},children:"\u8FD4\u56DE\u5DE5\u4F5C\u53F0"})})},Ye=function(){var o,u=(0,Z.useLocation)(),l=u.pathname,i=l.match(/\/(\d+)$/);i&&(l=u.pathname.replace(i[0],""));var s=(0,b.Sj)(l);return s?((0,F.useEffect)(function(){var d;if((d=s.data)!==null&&d!==void 0&&d.redirect){var c;Z.history.push((c=s.data)===null||c===void 0?void 0:c.redirect)}},[s]),(0,e.jsx)(e.Fragment,{children:(o=s.data)!==null&&o!==void 0&&o.redirect?(0,e.jsx)(ze.S,{}):(0,e.jsx)(Ie,{menu:s,match:i,pathname:l})})):(0,e.jsx)(Be,{})},Ie=function(o){var u=o.menu,l=o.match,i=o.pathname,s=u.data,d=u.page_type,c=u.name;if(l||d=="form"){var M=(s.postUrl?s.postUrl:s.url+"/show")+(l?"?id="+(l==null?void 0:l[1]):"");return(0,e.jsx)(be.Z,r()(r()({formTitle:!1,pageMenu:u},s),{},{msgcls:function(L){var N=L.code;s.noBack||N||d!="form"&&Z.history.back()},url:M,match:!!l,dataId:l?l==null?void 0:l[1]:0}),i)}else switch(d){case"category":return(0,e.jsx)(Re.Z,r()(r()({pageMenu:u,path:i,name:c},s),{},{tableTitle:!1}),i);case"table":return(0,e.jsx)(He,r()(r()({path:i,name:c,pageMenu:u},s),{},{tableTitle:!1}),i);case"panel":return(0,e.jsx)(Pe,r()({pageMenu:u},s));default:return null}},Ke=Ye}}]);
