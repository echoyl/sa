"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[890],{4559:function(gl,Qi,I){I.d(Qi,{$6:function(){return Re},$p:function(){return ys},Aw:function(){return ye},Cd:function(){return Vn},Dk:function(){return X},E9:function(){return pe},Ee:function(){return $n},F6:function(){return mt},GL:function(){return Ke},GZ:function(){return T},I8:function(){return ua},L1:function(){return Ps},MD:function(){return tl},N1:function(){return oi},NB:function(){return ae},O4:function(){return ke},Oi:function(){return ci},Pj:function(){return Hn},R:function(){return Vt},RV:function(){return q},Rr:function(){return vt},S3:function(){return qu},UL:function(){return Qn},V1:function(){return Pr},Vl:function(){return Q},Xz:function(){return $u},YR:function(){return Io},ZA:function(){return At},_O:function(){return Dt},aH:function(){return Jn},b_:function(){return Ai},bn:function(){return R},gz:function(){return Mn},h0:function(){return N},iM:function(){return se},jf:function(){return ne},k9:function(){return Yn},lu:function(){return ft},mN:function(){return me},mg:function(){return Rt},s$:function(){return ee},sC:function(){return rl},ux:function(){return Bu},x1:function(){return Xn},xA:function(){return Jt},xv:function(){return en},y$:function(){return Kn}});var B=I(1413),S=I(15671),C=I(43144),j=I(74902),Y=I(53640),$=I(60136),oe=I(97685),lr=I(89093),E=I(77160),le=I(98333),M=I(85975),ln=I(35600),W=I(32945),Ot=I(31437),We=I(25897),Ve=I(44078),ge=I(95147),Ee=I(76714),dt=I(81957),qi=I(69877),cr=I(71523),fr=I(13882),ji=I(80450),hr=I(8614),vr=I(4848),dr=I(75839),ea=I(99872),gr=I(92455),ta=I(65850),na=I(28659),ra=I(83555),ie=I(71154),ia=I(5199),pr=I(90134),gt=I(45607),aa=I(4637),oa=I(84329),V=I(4942),mr=I(71937),sa=I(30907),He=I(11702),Ze=I(55850),pt=I(15861),it=I(37762),Ye=I(91);var R=function(n){return n.GROUP="g",n.FRAGMENT="fragment",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh",n}({}),Lt=function(n){return n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE",n}({}),mt=function(){function n(){(0,S.Z)(this,n),this.plugins=[]}return(0,C.Z)(n,[{key:"addRenderingPlugin",value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)}},{key:"removeAllRenderingPlugins",value:function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})}}])}(),ua=function(){function n(i){(0,S.Z)(this,n),this.clipSpaceNearZ=Lt.NEGATIVE_ONE,this.plugins=[],this.config=(0,B.Z)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},i)}return(0,C.Z)(n,[{key:"registerPlugin",value:function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)}},{key:"unregisterPlugin",value:function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(e){return this.plugins.find(function(t){return t.name===e})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){Object.assign(this.config,e)}}])}(),cn=E.IH,at=E.JG,la=E.Fp,ca=E.VV,yr=E.bA,fn=E.lu,me=function(){function n(){(0,S.Z)(this,n),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return(0,C.Z)(n,[{key:"update",value:function(e,t){at(this.center,e),at(this.halfExtents,t),fn(this.min,this.center,this.halfExtents),cn(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(e,t){cn(this.center,t,e),yr(this.center,this.center,.5),fn(this.halfExtents,t,e),yr(this.halfExtents,this.halfExtents,.5),at(this.min,e),at(this.max,t)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],a=t[1],o=t[2],s=this.halfExtents,u=s[0],l=s[1],c=s[2],f=r-u,h=r+u,d=a-l,v=a+l,g=o-c,p=o+c,y=e.center,m=y[0],k=y[1],x=y[2],L=e.halfExtents,O=L[0],P=L[1],w=L[2],F=m-O,U=m+O,_=k-P,D=k+P,H=x-w,K=x+w;F<f&&(f=F),U>h&&(h=U),_<d&&(d=_),D>v&&(v=D),H<g&&(g=H),K>p&&(p=K),t[0]=(f+h)*.5,t[1]=(d+v)*.5,t[2]=(g+p)*.5,s[0]=(h-f)*.5,s[1]=(v-d)*.5,s[2]=(p-g)*.5,this.min[0]=f,this.min[1]=d,this.min[2]=g,this.max[0]=h,this.max[1]=v,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(e,t){var r=this.center,a=this.halfExtents,o=e.center,s=e.halfExtents,u=t[0],l=t[4],c=t[8],f=t[1],h=t[5],d=t[9],v=t[2],g=t[6],p=t[10],y=Math.abs(u),m=Math.abs(l),k=Math.abs(c),x=Math.abs(f),L=Math.abs(h),O=Math.abs(d),P=Math.abs(v),w=Math.abs(g),F=Math.abs(p);r[0]=t[12]+u*o[0]+l*o[1]+c*o[2],r[1]=t[13]+f*o[0]+h*o[1]+d*o[2],r[2]=t[14]+v*o[0]+g*o[1]+p*o[2],a[0]=y*s[0]+m*s[1]+k*s[2],a[1]=x*s[0]+L*s[1]+O*s[2],a[2]=P*s[0]+w*s[1]+F*s[2],fn(this.min,r,a),cn(this.max,r,a)}},{key:"intersects",value:function(e){var t=this.getMax(),r=this.getMin(),a=e.getMax(),o=e.getMin();return r[0]<=a[0]&&t[0]>=o[0]&&r[1]<=a[1]&&t[1]>=o[1]&&r[2]<=a[2]&&t[2]>=o[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var t=new n,r=la([0,0,0],this.getMin(),e.getMin()),a=ca([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,a),t}},{key:"getNegativeFarPoint",value:function(e){return e.pnVertexFlag===273?at([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(e){return e.pnVertexFlag===273?at([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0}}])}(),fa=function(){function n(i,e){(0,S.Z)(this,n),this.distance=i||0,this.normal=e||E.al(0,1,0),this.updatePNVertexFlag()}return(0,C.Z)(n,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(e){return E.AK(e,this.normal)-this.distance}},{key:"normalize",value:function(){var e=1/E.Zh(this.normal);E.bA(this.normal,this.normal,e),this.distance*=e}},{key:"intersectsLine",value:function(e,t,r){var a=this.distanceToPoint(e),o=this.distanceToPoint(t),s=a/(a-o),u=s>=0&&s<=1;return u&&r&&E.t7(r,e,t,s),u}}])}(),ot=function(n){return n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE",n}({}),ha=function(){function n(i){if((0,S.Z)(this,n),this.planes=[],i)this.planes=i;else for(var e=0;e<6;e++)this.planes.push(new fa)}return(0,C.Z)(n,[{key:"extractFromVPMatrix",value:function(e){var t=(0,oe.Z)(e,16),r=t[0],a=t[1],o=t[2],s=t[3],u=t[4],l=t[5],c=t[6],f=t[7],h=t[8],d=t[9],v=t[10],g=t[11],p=t[12],y=t[13],m=t[14],k=t[15];E.t8(this.planes[0].normal,s-r,f-u,g-h),this.planes[0].distance=k-p,E.t8(this.planes[1].normal,s+r,f+u,g+h),this.planes[1].distance=k+p,E.t8(this.planes[2].normal,s+a,f+l,g+d),this.planes[2].distance=k+y,E.t8(this.planes[3].normal,s-a,f-l,g-d),this.planes[3].distance=k-y,E.t8(this.planes[4].normal,s-o,f-c,g-v),this.planes[4].distance=k-m,E.t8(this.planes[5].normal,s+o,f+c,g+v),this.planes[5].distance=k+m,this.planes.forEach(function(x){x.normalize(),x.updatePNVertexFlag()})}}])}(),pe=function(){function n(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(0,S.Z)(this,n),this.x=0,this.y=0,this.x=i,this.y=e}return(0,C.Z)(n,[{key:"clone",value:function(){return new n(this.x,this.y)}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y}}])}(),st=function(){function n(i,e,t,r){(0,S.Z)(this,n),this.x=i,this.y=e,this.width=t,this.height=r,this.left=i,this.right=i+t,this.top=e,this.bottom=e+r}return(0,C.Z)(n,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new n(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,t){var r=le.al(e.x,e.y,0,1),a=le.al(e.x+e.width,e.y,0,1),o=le.al(e.x,e.y+e.height,0,1),s=le.al(e.x+e.width,e.y+e.height,0,1),u=le.Ue(),l=le.Ue(),c=le.Ue(),f=le.Ue();le.fF(u,r,t),le.fF(l,a,t),le.fF(c,o,t),le.fF(f,s,t);var h=Math.min(u[0],l[0],c[0],f[0]),d=Math.min(u[1],l[1],c[1],f[1]),v=Math.max(u[0],l[0],c[0],f[0]),g=Math.max(u[1],l[1],c[1],f[1]);return n.fromRect({x:h,y:d,width:v-h,height:g-d})}}])}(),ne="Method not implemented.",ut="Use document.documentElement instead.",va="Cannot append a destroyed element.";function Dt(n){return n===void 0?0:n>360||n<-360?n%360:n}var hn=E.Ue();function ke(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(n)&&n.length===3?t?E.d9(n):E.JG(hn,n):(0,We.Z)(n)?t?E.al(n,i,e):E.t8(hn,n,i,e):t?E.al(n[0],n[1]||i,n[2]||e):E.t8(hn,n[0],n[1]||i,n[2]||e)}var da=Math.PI/180;function Q(n){return n*da}var ga=180/Math.PI;function we(n){return n*ga}var pa=.9;function pl(n){return n%=400,n<0&&(n+=400),n*pa}function ml(n){return n/360}function ma(n){return 360*n}var It=Math.PI/2;function ya(n,i){var e=i[0],t=i[1],r=i[2],a=i[3],o=e*e,s=t*t,u=r*r,l=a*a,c=o+s+u+l,f=e*a-t*r;return f>.499995*c?(n[0]=It,n[1]=2*Math.atan2(t,e),n[2]=0):f<-.499995*c?(n[0]=-It,n[1]=2*Math.atan2(t,e),n[2]=0):(n[0]=Math.asin(2*(e*r-a*t)),n[1]=Math.atan2(2*(e*a+t*r),1-2*(u+l)),n[2]=Math.atan2(2*(e*t+r*a),1-2*(s+u))),n}function Ea(n,i){var e,t,r=M.getScaling(E.Ue(),i),a=(0,oe.Z)(r,3),o=a[0],s=a[1],u=a[2],l=Math.asin(-i[2]/o);return l<It?l>-It?(e=Math.atan2(i[6]/s,i[10]/u),t=Math.atan2(i[1]/o,i[0]/o)):(t=0,e=-Math.atan2(i[4]/s,i[5]/s)):(t=0,e=Math.atan2(i[4]/s,i[5]/s)),n[0]=e,n[1]=l,n[2]=t,n}function vn(n,i){return i.length===16?Ea(n,i):ya(n,i)}function ka(n,i,e,t,r){var a=Math.cos(n),o=Math.sin(n);return ln.al(t*a,r*o,0,-t*o,r*a,0,i,e,1)}function xa(n,i,e,t,r,a,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,u=2*a,l=e-i,c=t-r,f=u/l,h=u/c,d=(e+i)/l,v=(t+r)/c,g,p,y=o-a,m=o*a;return s?(g=-o/y,p=-m/y):(g=-(o+a)/y,p=-2*m/y),n[0]=f,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=d,n[9]=v,n[10]=g,n[11]=-1,n[12]=0,n[13]=0,n[14]=p,n[15]=0,n}function Er(n){var i=n[0],e=n[1],t=n[3],r=n[4],a=Math.sqrt(i*i+e*e),o=Math.sqrt(t*t+r*r),s=i*r-e*t;if(s<0&&(i<r?a=-a:o=-o),a){var u=1/a;i*=u,e*=u}if(o){var l=1/o;t*=l,r*=l}var c=Math.atan2(e,i),f=we(c);return[n[6],n[7],a,o,f]}var _e=M.create(),be=M.create(),yt=le.Ue(),Z=[E.Ue(),E.Ue(),E.Ue()],kr=E.Ue();function Ta(n,i,e,t,r,a){if(!Pa(_e,n)||(M.copy(be,_e),be[3]=0,be[7]=0,be[11]=0,be[15]=1,Math.abs(M.determinant(be))<1e-8))return!1;var o=_e[3],s=_e[7],u=_e[11],l=_e[12],c=_e[13],f=_e[14],h=_e[15];if(o!==0||s!==0||u!==0){yt[0]=o,yt[1]=s,yt[2]=u,yt[3]=h;var d=M.invert(be,be);if(!d)return!1;M.transpose(be,be),le.fF(r,yt,be)}else r[0]=r[1]=r[2]=0,r[3]=1;if(i[0]=l,i[1]=c,i[2]=f,Sa(Z,_e),e[0]=E.kE(Z[0]),E.Fv(Z[0],Z[0]),t[0]=E.AK(Z[0],Z[1]),dn(Z[1],Z[1],Z[0],1,-t[0]),e[1]=E.kE(Z[1]),E.Fv(Z[1],Z[1]),t[0]/=e[1],t[1]=E.AK(Z[0],Z[2]),dn(Z[2],Z[2],Z[0],1,-t[1]),t[2]=E.AK(Z[1],Z[2]),dn(Z[2],Z[2],Z[1],1,-t[2]),e[2]=E.kE(Z[2]),E.Fv(Z[2],Z[2]),t[1]/=e[2],t[2]/=e[2],E.kC(kr,Z[1],Z[2]),E.AK(Z[0],kr)<0)for(var v=0;v<3;v++)e[v]*=-1,Z[v][0]*=-1,Z[v][1]*=-1,Z[v][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Z[0][0]-Z[1][1]-Z[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Z[0][0]+Z[1][1]-Z[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Z[0][0]-Z[1][1]+Z[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Z[0][0]+Z[1][1]+Z[2][2],0)),Z[2][1]>Z[1][2]&&(a[0]=-a[0]),Z[0][2]>Z[2][0]&&(a[1]=-a[1]),Z[1][0]>Z[0][1]&&(a[2]=-a[2]),!0}function Pa(n,i){var e=i[15];if(e===0)return!1;for(var t=1/e,r=0;r<16;r++)n[r]=i[r]*t;return!0}function Sa(n,i){n[0][0]=i[0],n[0][1]=i[1],n[0][2]=i[2],n[1][0]=i[4],n[1][1]=i[5],n[1][2]=i[6],n[2][0]=i[8],n[2][1]=i[9],n[2][2]=i[10]}function dn(n,i,e,t,r){n[0]=i[0]*t+e[0]*r,n[1]=i[1]*t+e[1]*r,n[2]=i[2]*t+e[2]*r}var se=function(n){return n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING",n}({}),gn=function(n){return n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC",n}({}),Ne=function(n){return n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE",n}({}),xr={UPDATED:"updated"},Tr=2e-4,Pr=function(){function n(){(0,S.Z)(this,n),this.clipSpaceNearZ=Lt.NEGATIVE_ONE,this.eventEmitter=new lr.Z,this.matrix=M.create(),this.right=E.al(1,0,0),this.up=E.al(0,1,0),this.forward=E.al(0,0,1),this.position=E.al(0,0,1),this.focalPoint=E.al(0,0,0),this.distanceVector=E.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=M.create(),this.projectionMatrixInverse=M.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=se.EXPLORING,this.trackingMode=gn.DEFAULT,this.projectionMode=Ne.PERSPECTIVE,this.frustum=new ha,this.orthoMatrix=M.create()}return(0,C.Z)(n,[{key:"isOrtho",value:function(){return this.projectionMode===Ne.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e}},{key:"setType",value:function(e,t){return this.type=e,this.type===se.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===se.TRACKING&&t!==void 0&&this.setTrackingMode(t),this}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this}},{key:"setTrackingMode",value:function(e){if(this.type!==se.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this}},{key:"getViewTransform",value:function(){return M.invert(M.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(e,t){var r=M.fromTranslation(M.create(),[e,t,0]);this.jitteredProjectionMatrix=M.multiply(M.create(),r,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:"setNear",value:function(e){return this.projectionMode===Ne.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this}},{key:"setFar",value:function(e){return this.projectionMode===Ne.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this}},{key:"setViewOffset",value:function(e,t,r,a,o,s){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=a,this.view.width=o,this.view.height=s,this.projectionMode===Ne.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ne.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===Ne.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ne.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),a=r.x,o=r.y,s=this.roll;this.rotate(0,0,-s),this.setPosition(a,o),this.setFocalPoint(a,o),this.setZoom(e),this.rotate(0,0,s);var u=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=u.x,c=u.y,f=E.al(l-a,c-o,0),h=E.AK(f,this.right)/E.kE(this.right),d=E.AK(f,this.up)/E.kE(this.up),v=this.getPosition(),g=(0,oe.Z)(v,2),p=g[0],y=g[1],m=this.getFocalPoint(),k=(0,oe.Z)(m,2),x=k[0],L=k[1];return this.setPosition(p-h,y-d),this.setFocalPoint(x-h,L-d),this}},{key:"setPerspective",value:function(e,t,r,a){var o;this.projectionMode=Ne.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=a;var s=this.near*Math.tan(Q(.5*this.fov))/this.zoom,u=2*s,l=this.aspect*u,c=-.5*l;if((o=this.view)!==null&&o!==void 0&&o.enabled){var f=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/f,s-=this.view.offsetY*u/h,l*=this.view.width/f,u*=this.view.height/h}return xa(this.projectionMatrix,c,c+l,s-u,s,e,this.far,this.clipSpaceNearZ===Lt.ZERO),M.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(e,t,r,a,o,s){var u;this.projectionMode=Ne.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=a,this.near=o,this.far=s;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),f=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,d=f-l,v=f+l,g=h+c,p=h-c;if((u=this.view)!==null&&u!==void 0&&u.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=y*this.view.offsetX,v=d+y*this.view.width,g-=m*this.view.offsetY,p=g-m*this.view.height}return this.clipSpaceNearZ===Lt.NEGATIVE_ONE?M.ortho(this.projectionMatrix,d,v,g,p,o,s):M.orthoZO(this.projectionMatrix,d,v,g,p,o,s),M.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],a=ke(e,t,r);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],a=E.al(0,1,0);if(this.focalPoint=ke(e,t,r),this.trackingMode===gn.CINEMATIC){var o=E.$X(E.Ue(),this.focalPoint,this.position);e=o[0],t=o[1],r=o[2];var s=E.kE(o),u=we(Math.asin(t/s)),l=90+we(Math.atan2(r,e)),c=M.create();M.rotateY(c,c,Q(l)),M.rotateX(c,c,Q(u)),a=E.fF(E.Ue(),[0,1,0],c)}return M.invert(this.matrix,M.lookAt(M.create(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<Tr&&(this.distance=Tr),this.dollyingStep=this.distance/100;var t=E.Ue();e=this.distance;var r=this.forward,a=this.focalPoint;return t[0]=e*r[0]+a[0],t[1]=e*r[1]+a[1],t[2]=e*r[2]+a[2],this._setPosition(t),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this}},{key:"setAzimuth",value:function(e){return this.azimuth=Dt(e),this.computeMatrix(),this._getAxes(),this.type===se.ORBITING||this.type===se.EXPLORING?this._getPosition():this.type===se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(e){return this.elevation=Dt(e),this.computeMatrix(),this._getAxes(),this.type===se.ORBITING||this.type===se.EXPLORING?this._getPosition():this.type===se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(e){return this.roll=Dt(e),this.computeMatrix(),this._getAxes(),this.type===se.ORBITING||this.type===se.EXPLORING?this._getPosition():this.type===se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var e=W.yY(W.Ue(),[0,0,1],Q(this.roll));M.identity(this.matrix);var t=W.yY(W.Ue(),[1,0,0],Q((this.rotateWorld&&this.type!==se.TRACKING||this.type===se.TRACKING?1:-1)*this.elevation)),r=W.yY(W.Ue(),[0,1,0],Q((this.rotateWorld&&this.type!==se.TRACKING||this.type===se.TRACKING?1:-1)*this.azimuth)),a=W.Jp(W.Ue(),r,t);a=W.Jp(W.Ue(),a,e);var o=M.fromQuat(M.create(),a);this.type===se.ORBITING||this.type===se.EXPLORING?(M.translate(this.matrix,this.matrix,this.focalPoint),M.multiply(this.matrix,this.matrix,o),M.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===se.TRACKING&&(M.translate(this.matrix,this.matrix,this.position),M.multiply(this.matrix,this.matrix,o))}},{key:"_setPosition",value:function(e,t,r){this.position=ke(e,t,r);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){E.JG(this.right,ke(le.fF(le.Ue(),[1,0,0,0],this.matrix))),E.JG(this.up,ke(le.fF(le.Ue(),[0,1,0,0],this.matrix))),E.JG(this.forward,ke(le.fF(le.Ue(),[0,0,1,0],this.matrix))),E.Fv(this.right,this.right),E.Fv(this.up,this.up),E.Fv(this.forward,this.forward)}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],a=E.kE(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===se.TRACKING?(this.elevation=we(Math.asin(t/a)),this.azimuth=we(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=we(Math.asin(t/a)),this.azimuth=we(Math.atan2(-e,-r))):(this.elevation=-we(Math.asin(t/a)),this.azimuth=-we(Math.atan2(-e,-r)))}},{key:"_getPosition",value:function(){E.JG(this.position,ke(le.fF(le.Ue(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){E.kK(this.distanceVector,[0,0,-this.distance],ln.xO(ln.Ue(),this.matrix)),E.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=E.$X(E.Ue(),this.focalPoint,this.position),this.distance=E.kE(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Ne.ORTHOGRAPHIC){var e=this.position,t=W.yY(W.Ue(),[0,0,1],-this.roll*Math.PI/180);M.fromRotationTranslationScaleOrigin(this.orthoMatrix,t,E.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),E.al(this.zoom,this.zoom,1),e)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),t=M.multiply(M.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(xr.UPDATED)}}},{key:"rotate",value:function(e,t,r){throw new Error(ne)}},{key:"pan",value:function(e,t){throw new Error(ne)}},{key:"dolly",value:function(e){throw new Error(ne)}},{key:"createLandmark",value:function(e,t){throw new Error(ne)}},{key:"gotoLandmark",value:function(e,t){throw new Error(ne)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(ne)}}])}(),Ca=function(n){return n[n.Standard=0]="Standard",n}({}),Zt=function(n){return n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",n}({}),Ma=E.Ue(),Et=M.create(),wa=W.Ue();function Sr(n){if(n.localDirtyFlag){var i=n.localSkew[0]!==0||n.localSkew[1]!==0;if(i){M.fromRotationTranslationScaleOrigin(n.localTransform,n.localRotation,n.localPosition,E.al(1,1,1),n.origin),(n.localSkew[0]!==0||n.localSkew[1]!==0)&&(M.identity(Et),Et[4]=Math.tan(n.localSkew[0]),Et[1]=Math.tan(n.localSkew[1]),M.multiply(n.localTransform,n.localTransform,Et));var e=M.fromRotationTranslationScaleOrigin(Et,W.t8(wa,0,0,0,1),E.t8(Ma,1,1,1),n.localScale,n.origin);M.multiply(n.localTransform,n.localTransform,e)}else{var t=n.localTransform,r=n.localPosition,a=n.localRotation,o=n.localScale,s=n.origin,u=r[0]!==0||r[1]!==0||r[2]!==0,l=a[3]!==1||a[0]!==0||a[1]!==0||a[2]!==0,c=o[0]!==1||o[1]!==1||o[2]!==1,f=s[0]!==0||s[1]!==0||s[2]!==0;!l&&!c&&!f?u?M.fromTranslation(t,r):M.identity(t):M.fromRotationTranslationScaleOrigin(t,a,r,o,s)}n.localDirtyFlag=!1}}function Na(n,i){n.dirtyFlag&&(i?M.multiply(n.worldTransform,i.worldTransform,n.localTransform):M.copy(n.worldTransform,n.localTransform),n.dirtyFlag=!1)}var Cr={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new st(0,0,0,0)},N=function(n){return n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>",n}({});function pn(n,i,e){n.prototype=i.prototype=e,e.constructor=n}function Mr(n,i){var e=Object.create(n.prototype);for(var t in i)e[t]=i[t];return e}function kt(){}var xt=.7,_t=1/xt,lt="\\s*([+-]?\\d+)\\s*",Tt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Aa=/^#([0-9a-f]{3,8})$/,Ra=new RegExp(`^rgb\\(${lt},${lt},${lt}\\)$`),ba=new RegExp(`^rgb\\(${Fe},${Fe},${Fe}\\)$`),Oa=new RegExp(`^rgba\\(${lt},${lt},${lt},${Tt}\\)$`),La=new RegExp(`^rgba\\(${Fe},${Fe},${Fe},${Tt}\\)$`),Da=new RegExp(`^hsl\\(${Tt},${Fe},${Fe}\\)$`),Ia=new RegExp(`^hsla\\(${Tt},${Fe},${Fe},${Tt}\\)$`),wr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pn(kt,Ft,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:Nr,formatHex:Nr,formatHex8:Za,formatHsl:_a,formatRgb:Ar,toString:Ar});function Nr(){return this.rgb().formatHex()}function Za(){return this.rgb().formatHex8()}function _a(){return Dr(this).formatHsl()}function Ar(){return this.rgb().formatRgb()}function Ft(n){var i,e;return n=(n+"").trim().toLowerCase(),(i=Aa.exec(n))?(e=i[1].length,i=parseInt(i[1],16),e===6?Rr(i):e===3?new Te(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):e===8?Gt(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):e===4?Gt(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=Ra.exec(n))?new Te(i[1],i[2],i[3],1):(i=ba.exec(n))?new Te(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=Oa.exec(n))?Gt(i[1],i[2],i[3],i[4]):(i=La.exec(n))?Gt(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Da.exec(n))?Lr(i[1],i[2]/100,i[3]/100,1):(i=Ia.exec(n))?Lr(i[1],i[2]/100,i[3]/100,i[4]):wr.hasOwnProperty(n)?Rr(wr[n]):n==="transparent"?new Te(NaN,NaN,NaN,0):null}function Rr(n){return new Te(n>>16&255,n>>8&255,n&255,1)}function Gt(n,i,e,t){return t<=0&&(n=i=e=NaN),new Te(n,i,e,t)}function Fa(n){return n instanceof kt||(n=Ft(n)),n?(n=n.rgb(),new Te(n.r,n.g,n.b,n.opacity)):new Te}function Ga(n,i,e,t){return arguments.length===1?Fa(n):new Te(n,i,e,t==null?1:t)}function Te(n,i,e,t){this.r=+n,this.g=+i,this.b=+e,this.opacity=+t}pn(Te,Ga,Mr(kt,{brighter(n){return n=n==null?_t:Math.pow(_t,n),new Te(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?xt:Math.pow(xt,n),new Te(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Te($e(this.r),$e(this.g),$e(this.b),Ut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:br,formatHex:br,formatHex8:Ua,formatRgb:Or,toString:Or}));function br(){return`#${Xe(this.r)}${Xe(this.g)}${Xe(this.b)}`}function Ua(){return`#${Xe(this.r)}${Xe(this.g)}${Xe(this.b)}${Xe((isNaN(this.opacity)?1:this.opacity)*255)}`}function Or(){const n=Ut(this.opacity);return`${n===1?"rgb(":"rgba("}${$e(this.r)}, ${$e(this.g)}, ${$e(this.b)}${n===1?")":`, ${n})`}`}function Ut(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function $e(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Xe(n){return n=$e(n),(n<16?"0":"")+n.toString(16)}function Lr(n,i,e,t){return t<=0?n=i=e=NaN:e<=0||e>=1?n=i=NaN:i<=0&&(n=NaN),new Oe(n,i,e,t)}function Dr(n){if(n instanceof Oe)return new Oe(n.h,n.s,n.l,n.opacity);if(n instanceof kt||(n=Ft(n)),!n)return new Oe;if(n instanceof Oe)return n;n=n.rgb();var i=n.r/255,e=n.g/255,t=n.b/255,r=Math.min(i,e,t),a=Math.max(i,e,t),o=NaN,s=a-r,u=(a+r)/2;return s?(i===a?o=(e-t)/s+(e<t)*6:e===a?o=(t-i)/s+2:o=(i-e)/s+4,s/=u<.5?a+r:2-a-r,o*=60):s=u>0&&u<1?0:o,new Oe(o,s,u,n.opacity)}function Ba(n,i,e,t){return arguments.length===1?Dr(n):new Oe(n,i,e,t==null?1:t)}function Oe(n,i,e,t){this.h=+n,this.s=+i,this.l=+e,this.opacity=+t}pn(Oe,Ba,Mr(kt,{brighter(n){return n=n==null?_t:Math.pow(_t,n),new Oe(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?xt:Math.pow(xt,n),new Oe(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,i=isNaN(n)||isNaN(this.s)?0:this.s,e=this.l,t=e+(e<.5?e:1-e)*i,r=2*e-t;return new Te(mn(n>=240?n-240:n+120,r,t),mn(n,r,t),mn(n<120?n+240:n-120,r,t),this.opacity)},clamp(){return new Oe(Ir(this.h),Bt(this.s),Bt(this.l),Ut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Ut(this.opacity);return`${n===1?"hsl(":"hsla("}${Ir(this.h)}, ${Bt(this.s)*100}%, ${Bt(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Ir(n){return n=(n||0)%360,n<0?n+360:n}function Bt(n){return Math.max(0,Math.min(1,n||0))}function mn(n,i,e){return(n<60?i+(e-i)*n/60:n<180?e:n<240?i+(e-i)*(240-n)/60:i)*255}function ce(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError("Expected a function");var e=function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var s=i?i.apply(this,a):a[0],u=e.cache;if(u.has(s))return u.get(s);var l=n.apply(this,a);return e.cache=u.set(s,l)||u,l};return e.cache=new(ce.Cache||Map),ce.cacheList.push(e.cache),e}ce.Cache=Map,ce.cacheList=[],ce.clearCache=function(){ce.cacheList.forEach(function(n){return n.clear()})};var A=function(n){return n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger",n}({}),Le=function(n){return n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther",n}({}),za=function(n){return n[n.kYes=0]="kYes",n[n.kNo=1]="kNo",n}({}),Wa=function(n){return n[n.kYes=0]="kYes",n[n.kNo=1]="kNo",n}({}),Va=[{name:"em",unit_type:A.kEms},{name:"px",unit_type:A.kPixels},{name:"deg",unit_type:A.kDegrees},{name:"rad",unit_type:A.kRadians},{name:"grad",unit_type:A.kGradians},{name:"ms",unit_type:A.kMilliseconds},{name:"s",unit_type:A.kSeconds},{name:"rem",unit_type:A.kRems},{name:"turn",unit_type:A.kTurns}],ct=function(n){return n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType",n}({}),Ha=function(i){return Va.find(function(e){return e.name===i}).unit_type},Ya=function(i){return i?i==="number"?A.kNumber:i==="percent"||i==="%"?A.kPercentage:Ha(i):A.kUnknown},$a=function(i){switch(i){case A.kNumber:case A.kInteger:return Le.kUNumber;case A.kPercentage:return Le.kUPercent;case A.kPixels:return Le.kULength;case A.kMilliseconds:case A.kSeconds:return Le.kUTime;case A.kDegrees:case A.kRadians:case A.kGradians:case A.kTurns:return Le.kUAngle;default:return Le.kUOther}},Xa=function(i){switch(i){case Le.kUNumber:return A.kNumber;case Le.kULength:return A.kPixels;case Le.kUPercent:return A.kPercentage;case Le.kUTime:return A.kSeconds;case Le.kUAngle:return A.kDegrees;default:return A.kUnknown}},Zr=function(i){var e=1;switch(i){case A.kPixels:case A.kDegrees:case A.kSeconds:break;case A.kMilliseconds:e=.001;break;case A.kRadians:e=180/Math.PI;break;case A.kGradians:e=.9;break;case A.kTurns:e=360;break}return e},yn=function(i){switch(i){case A.kNumber:case A.kInteger:return"";case A.kPercentage:return"%";case A.kEms:return"em";case A.kRems:return"rem";case A.kPixels:return"px";case A.kDegrees:return"deg";case A.kRadians:return"rad";case A.kGradians:return"grad";case A.kMilliseconds:return"ms";case A.kSeconds:return"s";case A.kTurns:return"turn"}return""},zt=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"toString",value:function(){return this.buildCSSText(za.kNo,Wa.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=ct.kUnitType&&this.getType()<=ct.kClampType}}],[{key:"isAngle",value:function(e){return e===A.kDegrees||e===A.kRadians||e===A.kGradians||e===A.kTurns}},{key:"isLength",value:function(e){return e>=A.kEms&&e<A.kDegrees}},{key:"isRelativeUnit",value:function(e){return e===A.kPercentage||e===A.kEms||e===A.kRems}},{key:"isTime",value:function(e){return e===A.kSeconds||e===A.kMilliseconds}}])}(),Ka=function(n){function i(e){var t;return(0,S.Z)(this,i),t=(0,Y.Z)(this,i),t.colorSpace=e,t}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"getType",value:function(){return ct.kColorType}},{key:"to",value:function(t){return this}}])}(zt),Ke=function(n){return n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient",n}({}),Wt=function(n){function i(e,t){var r;return(0,S.Z)(this,i),r=(0,Y.Z)(this,i),r.type=e,r.value=t,r}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"clone",value:function(){return new i(this.type,this.value)}},{key:"buildCSSText",value:function(t,r,a){return a}},{key:"getType",value:function(){return ct.kColorType}}])}(zt),Ae=function(n){function i(e){var t;return(0,S.Z)(this,i),t=(0,Y.Z)(this,i),t.value=e,t}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"clone",value:function(){return new i(this.value)}},{key:"getType",value:function(){return ct.kKeywordType}},{key:"buildCSSText",value:function(t,r,a){return a+this.value}}])}(zt),Ja=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t="";return Number.isFinite(i)?t="NaN":i>0?t="infinity":t="-infinity",t+=e},En=function(i){return Xa($a(i))},J=function(n){function i(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.kNumber;(0,S.Z)(this,i),t=(0,Y.Z)(this,i);var a;return typeof r=="string"?a=Ya(r):a=r,t.unit=a,t.value=e,t}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"clone",value:function(){return new i(this.value,this.unit)}},{key:"equals",value:function(t){var r=t;return this.value===r.value&&this.unit===r.unit}},{key:"getType",value:function(){return ct.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new i(this.value,this.unit);var r=En(this.unit);if(r!==En(t)||r===A.kUnknown)return null;var a=Zr(this.unit)/Zr(t);return new i(this.value*a,t)}},{key:"buildCSSText",value:function(t,r,a){var o;switch(this.unit){case A.kUnknown:break;case A.kInteger:o=Number(this.value).toFixed(0);break;case A.kNumber:case A.kPercentage:case A.kEms:case A.kRems:case A.kPixels:case A.kDegrees:case A.kRadians:case A.kGradians:case A.kMilliseconds:case A.kSeconds:case A.kTurns:{var s=-999999,u=999999,l=this.value,c=yn(this.unit);if(l<s||l>u){var f=yn(this.unit);!Number.isFinite(l)||Number.isNaN(l)?o=Ja(l,f):o=l+(f||"")}else o="".concat(l).concat(c)}}return a+=o,a}}])}(zt),De=new J(0,"px");new J(1,"px");var Je=new J(0,"deg"),kn=function(n){function i(e,t,r){var a,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(0,S.Z)(this,i),a=(0,Y.Z)(this,i,["rgb"]),a.r=e,a.g=t,a.b=r,a.alpha=o,a.isNone=s,a}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"clone",value:function(){return new i(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,r,a){return"".concat(a,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(Ka),_r=new Ae("unset"),Qa=new Ae("initial"),qa=new Ae("inherit"),xn={"":_r,unset:_r,initial:Qa,inherit:qa},ja=function(i){return xn[i]||(xn[i]=new Ae(i)),xn[i]},Fr=new kn(0,0,0,0,!0),Gr=new kn(0,0,0,0),eo=ce(function(n,i,e,t){return new kn(n,i,e,t)},function(n,i,e,t){return"rgba(".concat(n,",").concat(i,",").concat(e,",").concat(t,")")}),re=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.kNumber;return new J(i,e)};new J(50,"%");function to(n){var i=n.type,e=n.value;return i==="hex"?"#".concat(e):i==="literal"?e:i==="rgb"?"rgb(".concat(e.join(","),")"):"rgba(".concat(e.join(","),")")}var no=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},i="";function e(b){throw new Error("".concat(i,": ").concat(b))}function t(){var b=r();return i.length>0&&e("Invalid input not EOF"),b}function r(){return k(a)}function a(){return o("linear-gradient",n.linearGradient,u)||o("repeating-linear-gradient",n.repeatingLinearGradient,u)||o("radial-gradient",n.radialGradient,f)||o("repeating-radial-gradient",n.repeatingRadialGradient,f)||o("conic-gradient",n.conicGradient,f)}function o(b,G,z){return s(G,function(ve){var de=z();return de&&(te(n.comma)||e("Missing comma before color stops")),{type:b,orientation:de,colorStops:k(x)}})}function s(b,G){var z=te(b);if(z){te(n.startCall)||e("Missing (");var ve=G(z);return te(n.endCall)||e("Missing )"),ve}}function u(){return l()||c()}function l(){return K("directional",n.sideOrCorner,1)}function c(){return K("angular",n.angleValue,1)}function f(){var b,G=h(),z;return G&&(b=[],b.push(G),z=i,te(n.comma)&&(G=h(),G?b.push(G):i=z)),b}function h(){var b=d()||v();if(b)b.at=p();else{var G=g();if(G){b=G;var z=p();z&&(b.at=z)}else{var ve=y();ve&&(b={type:"default-radial",at:ve})}}return b}function d(){var b=K("shape",/^(circle)/i,0);return b&&(b.style=H()||g()),b}function v(){var b=K("shape",/^(ellipse)/i,0);return b&&(b.style=_()||g()),b}function g(){return K("extent-keyword",n.extentKeywords,1)}function p(){if(K("position",/^at/,0)){var b=y();return b||e("Missing positioning value"),b}}function y(){var b=m();if(b.x||b.y)return{type:"position",value:b}}function m(){return{x:_(),y:_()}}function k(b){var G=b(),z=[];if(G)for(z.push(G);te(n.comma);)G=b(),G?z.push(G):e("One extra comma");return z}function x(){var b=L();return b||e("Expected color definition"),b.length=_(),b}function L(){return P()||F()||w()||O()}function O(){return K("literal",n.literalColor,0)}function P(){return K("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:k(U)}})}function F(){return s(n.rgbaColor,function(){return{type:"rgba",value:k(U)}})}function U(){return te(n.number)[1]}function _(){return K("%",n.percentageValue,1)||D()||H()}function D(){return K("position-keyword",n.positionKeywords,1)}function H(){return K("px",n.pixelValue,1)||K("em",n.emValue,1)}function K(b,G,z){var ve=te(G);if(ve)return{type:b,value:ve[z]}}function te(b){var G=/^[\n\r\t\s]+/.exec(i);G&&he(G[0].length);var z=b.exec(i);return z&&he(z[0].length),z}function he(b){i=i.substring(b)}return function(b){return i=b,t()}}();function ro(n,i,e,t){var r=Q(t.value),a=0,o=0,s=a+i/2,u=o+e/2,l=Math.abs(i*Math.cos(r))+Math.abs(e*Math.sin(r)),c=n[0]+s-Math.cos(r)*l/2,f=n[1]+u-Math.sin(r)*l/2,h=n[0]+s+Math.cos(r)*l/2,d=n[1]+u+Math.sin(r)*l/2;return{x1:c,y1:f,x2:h,y2:d}}function io(n,i,e,t,r,a){var o=t.value,s=r.value;t.unit===A.kPercentage&&(o=t.value/100*i),r.unit===A.kPercentage&&(s=r.value/100*e);var u=Math.max((0,Ve.y)([0,0],[o,s]),(0,Ve.y)([0,e],[o,s]),(0,Ve.y)([i,e],[o,s]),(0,Ve.y)([i,0],[o,s]));return a&&(a instanceof J?u=a.value:a instanceof Ae&&(a.value==="closest-side"?u=Math.min(o,i-o,s,e-s):a.value==="farthest-side"?u=Math.max(o,i-o,s,e-s):a.value==="closest-corner"&&(u=Math.min((0,Ve.y)([0,0],[o,s]),(0,Ve.y)([0,e],[o,s]),(0,Ve.y)([i,e],[o,s]),(0,Ve.y)([i,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:u}}var ao=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,oo=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,so=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Ur=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function uo(n){var i,e=n.length;if(n[e-1].length=(i=n[e-1].length)!==null&&i!==void 0?i:{type:"%",value:"100"},e>1){var t;n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"}}for(var r=0,a=Number(n[0].length.value),o=1;o<e;o++){var s,u=(s=n[o].length)===null||s===void 0?void 0:s.value;if(!(0,ge.Z)(u)&&!(0,ge.Z)(a)){for(var l=1;l<o-r;l++)n[r+l].length={type:"%",value:"".concat(a+(Number(u)-a)*l/(o-r))};r=o,a=Number(u)}}}var lo={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},co=ce(function(n){var i;return n.type==="angular"?i=Number(n.value):i=lo[n.value]||0,re(i,"deg")}),fo=ce(function(n){var i=50,e=50,t="%",r="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?i=0:o.value==="center"?i=50:o.value==="right"?i=100:o.value==="top"?e=0:o.value==="bottom"&&(e=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?i=0:s.value==="center"?e=50:s.value==="right"?i=100:s.value==="top"?e=0:s.value==="bottom"&&(e=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(t=o==null?void 0:o.type,i=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(r=s==null?void 0:s.type,e=Number(s.value))}return{cx:re(i,t),cy:re(e,r)}}),ho=ce(function(n){if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var i=no(n);return i.map(function(s){var u=s.type,l=s.orientation,c=s.colorStops;uo(c);var f=c.map(function(k){return{offset:re(Number(k.length.value),"%"),color:to(k)}});if(u==="linear-gradient")return new Wt(Ke.LinearGradient,{angle:l?co(l):Je,steps:f});if(u==="radial-gradient"&&(l||(l=[{type:"shape",value:"circle"}]),l[0].type==="shape"&&l[0].value==="circle")){var h=fo(l[0].at),d=h.cx,v=h.cy,g;if(l[0].style){var p=l[0].style,y=p.type,m=p.value;y==="extent-keyword"?g=ja(m):g=re(m,y)}return new Wt(Ke.RadialGradient,{cx:d,cy:v,size:g,steps:f})}})}var e=n[0];if(n[1]==="("||n[2]==="("){if(e==="l"){var t=ao.exec(n);if(t){var r,a=((r=t[2].match(Ur))===null||r===void 0?void 0:r.map(function(s){return s.split(":")}))||[];return[new Wt(Ke.LinearGradient,{angle:re(parseFloat(t[1]),"deg"),steps:a.map(function(s){var u=(0,oe.Z)(s,2),l=u[0],c=u[1];return{offset:re(Number(l)*100,"%"),color:c}})})]}}else if(e==="r"){var o=vo(n);if(o)if((0,Ee.Z)(o))n=o;else return[new Wt(Ke.RadialGradient,o)]}else if(e==="p")return go(n)}});function vo(n){var i=oo.exec(n);if(i){var e,t=((e=i[4].match(Ur))===null||e===void 0?void 0:e.map(function(r){return r.split(":")}))||[];return{cx:re(50,"%"),cy:re(50,"%"),steps:t.map(function(r){var a=(0,oe.Z)(r,2),o=a[0],s=a[1];return{offset:re(Number(o)*100,"%"),color:s}})}}return null}function go(n){var i=so.exec(n);if(i){var e=i[1],t=i[2];switch(e){case"a":e="repeat";break;case"x":e="repeat-x";break;case"y":e="repeat-y";break;case"n":e="no-repeat";break;default:e="no-repeat"}return{image:t,repetition:e}}return null}function yl(n){return!!n.type&&!!n.value}function Vt(n){return n&&!!n.image}function Ht(n){return n&&!(0,ge.Z)(n.r)&&!(0,ge.Z)(n.g)&&!(0,ge.Z)(n.b)}var ft=ce(function(n){if(Vt(n))return(0,B.Z)({repetition:"repeat"},n);if((0,ge.Z)(n)&&(n=""),n==="transparent")return Gr;if(n==="currentColor")n="black";else if(n==="none")return Fr;var i=ho(n);if(i)return i;var e=Ft(n),t=[0,0,0,0];return e!==null&&(t[0]=e.r||0,t[1]=e.g||0,t[2]=e.b||0,t[3]=e.opacity),eo.apply(void 0,t)});function po(n,i){if(!(!Ht(n)||!Ht(i)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(i.r),Number(i.g),Number(i.b),Number(i.alpha)],function(e){var t=e.slice();if(t[3])for(var r=0;r<3;r++)t[r]=Math.round((0,dt.Z)(t[r],0,255));return t[3]=(0,dt.Z)(t[3],0,1),"rgba(".concat(t.join(","),")")}]}function Pt(n,i){if((0,ge.Z)(i))return re(0,"px");if(i="".concat(i).trim().toLowerCase(),isFinite(Number(i))){if("px".search(n)>=0)return re(Number(i),"px");if("deg".search(n)>=0)return re(Number(i),"deg")}var e=[];i=i.replace(n,function(r){return e.push(r),"U".concat(r)});var t="U(".concat(n.source,")");return e.map(function(r){return re(Number(i.replace(new RegExp("U".concat(r),"g"),"").replace(new RegExp(t,"g"),"*0")),r)})[0]}var Br=function(i){return Pt(new RegExp("px","g"),i)},mo=ce(Br),yo=function(i){return Pt(new RegExp("%","g"),i)};ce(yo);var zr=function(i){return(0,We.Z)(i)||isFinite(Number(i))?re(Number(i)||0,"px"):Pt(new RegExp("px|%|em|rem","g"),i)},Tn=ce(zr),Wr=function(i){return Pt(new RegExp("deg|rad|grad|turn","g"),i)},Eo=ce(Wr);function ko(n,i,e,t){var r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a="",o=n.value||0,s=i.value||0,u=En(n.unit),l=n.convertTo(u),c=i.convertTo(u);return l&&c?(o=l.value,s=c.value,a=yn(n.unit)):(J.isLength(n.unit)||J.isLength(i.unit))&&(o=Ce(n,r,e),s=Ce(i,r,e),a="px"),[o,s,function(f){return t&&(f=Math.max(f,0)),f+a}]}function Pe(n){var i=0;return n.unit===A.kDegrees?i=n.value:n.unit===A.kRadians?i=we(Number(n.value)):n.unit===A.kTurns?i=ma(Number(n.value)):n.value&&(i=n.value),i}function Vr(n,i){var e;return Array.isArray(n)?e=n.map(function(t){return Number(t)}):(0,Ee.Z)(n)?e=n.split(" ").map(function(t){return Number(t)}):(0,We.Z)(n)&&(e=[n]),i===2?e.length===1?[e[0],e[0]]:[e[0],e[1]]:i===4?e.length===1?[e[0],e[0],e[0],e[0]]:e.length===2?[e[0],e[1],e[0],e[1]]:e.length===3?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]:i==="even"&&e.length%2===1?[].concat((0,j.Z)(e),(0,j.Z)(e)):e}function Ce(n,i,e){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(n.unit===A.kPixels)return Number(n.value);if(n.unit===A.kPercentage&&e){var r=e.nodeName===R.GROUP?e.getLocalBounds():e.getGeometryBounds();return(t?r.min[i]:0)+n.value/100*r.halfExtents[i]*2}return 0}var xo=function(i){return Pt(/deg|rad|grad|turn|px|%/g,i)},To=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function Po(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(n=n.toLowerCase().trim(),n==="none")return[];for(var i=/\s*([\w-]+)\(([^)]*)\)/g,e=[],t,r=0;t=i.exec(n);){if(t.index!==r)return[];if(r=t.index+t[0].length,To.indexOf(t[1])>-1&&e.push({name:t[1],params:t[2].split(" ").map(function(a){return xo(a)||ft(a)})}),i.lastIndex===n.length)return e}return[]}function Hr(n){return n.toString()}var Yr=function(i){return typeof i=="number"?re(i):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(i)?re(Number(i)):re(0)},Pn=ce(Yr);ce(function(n){return(0,Ee.Z)(n)?n.split(" ").map(Pn):n.map(Pn)});function Sn(n,i){return[n,i,Hr]}function Cn(n,i){return function(e,t){return[e,t,function(r){return Hr((0,dt.Z)(r,n,i))}]}}function $r(n,i){if(n.length===i.length)return[n,i,function(e){return e}]}function Mn(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=(0,qi.D)(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function So(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=(0,He.hE)(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function Co(n){for(var i=0;i<n.length;i++){var e=n[i-1],t=n[i],r=t[0];if(r==="M"&&e){var a=e[0],o=[t[1],t[2]],s=void 0;a==="L"||a==="M"?s=[e[1],e[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[e[e.length-2],e[e.length-1]]),s&&Yt(o,s)&&(n.splice(i,1),i--)}}}function Mo(n){for(var i=!1,e=n.length,t=0;t<e;t++){var r=n[t],a=r[0];if(a==="C"||a==="A"||a==="Q"){i=!0;break}}return i}function wo(n){for(var i=[],e=[],t=[],r=0;r<n.length;r++){var a=n[r],o=a[0];o==="M"?(t.length&&(e.push(t),t=[]),t.push([a[1],a[2]])):o==="Z"?t.length&&(i.push(t),t=[]):t.push([a[1],a[2]])}return t.length>0&&e.push(t),{polygons:i,polylines:e}}function Yt(n,i){return n[0]===i[0]&&n[1]===i[1]}function No(n,i){for(var e=[],t=[],r=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,u=o.params,l=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,He.x4)(l[0],l[1],u[1],u[2],u[3],u[4]);break;case"C":c=(0,He.l5)(l[0],l[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var f=o.arcParams;c=(0,He.vp)(f.cx,f.cy,f.rx,f.ry,f.xRotation,f.startAngle,f.endAngle);break;default:e.push(s[0]),t.push(s[1]);break}c&&(o.box=c,e.push(c.x,c.x+c.width),t.push(c.y,c.y+c.height)),i&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&r.push(o)}e=e.filter(function(x){return!Number.isNaN(x)&&x!==1/0&&x!==-1/0}),t=t.filter(function(x){return!Number.isNaN(x)&&x!==1/0&&x!==-1/0});var h=(0,cr.Z)(e),d=(0,cr.Z)(t),v=(0,fr.Z)(e),g=(0,fr.Z)(t);if(r.length===0)return{x:h,y:d,width:v-h,height:g-d};for(var p=0;p<r.length;p++){var y=r[p],m=y.currentPoint,k=void 0;m[0]===h?(k=$t(y,i),h-=k.xExtra):m[0]===v&&(k=$t(y,i),v+=k.xExtra),m[1]===d?(k=$t(y,i),d-=k.yExtra):m[1]===g&&(k=$t(y,i),g+=k.yExtra)}return{x:h,y:d,width:v-h,height:g-d}}function $t(n,i){var e=n.prePoint,t=n.currentPoint,r=n.nextPoint,a=Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2),o=Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2),s=Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2),u=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!u||Math.sin(u)===0||(0,ji.Z)(u,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(r[1]-t[1],r[0]-t[0])),c=Math.abs(Math.atan2(r[0]-t[0],r[1]-t[1]));l=l>Math.PI/2?Math.PI-l:l,c=c>Math.PI/2?Math.PI-c:c;var f={xExtra:Math.cos(u/2-l)*(i/2*(1/Math.sin(u/2)))-i/2||0,yExtra:Math.cos(c-u/2)*(i/2*(1/Math.sin(u/2)))-i/2||0};return f}function Xr(n,i){return[i[0]+(i[0]-n[0]),i[1]+(i[1]-n[1])]}var Kr=function(i,e){var t=i.x*e.x+i.y*e.y,r=Math.sqrt((Math.pow(i.x,2)+Math.pow(i.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),a=i.x*e.y-i.y*e.x<0?-1:1,o=a*Math.acos(t/r);return o},Jr=function(i,e,t,r,a,o,s,u){e=Math.abs(e),t=Math.abs(t),r=(0,hr.Z)(r,360);var l=Q(r);if(i.x===s.x&&i.y===s.y)return{x:i.x,y:i.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(i.x-s.x)/2,f=(i.y-s.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*f,y:-Math.sin(l)*c+Math.cos(l)*f},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);d>1&&(e*=Math.sqrt(d),t*=Math.sqrt(d));var v=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),g=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),p=v/g;p=p<0?0:p;var y=(a!==o?1:-1)*Math.sqrt(p),m={x:y*(e*h.y/t),y:y*(-(t*h.x)/e)},k={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(i.x+s.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(i.y+s.y)/2},x={x:(h.x-m.x)/e,y:(h.y-m.y)/t},L=Kr({x:1,y:0},x),O={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},P=Kr(x,O);!o&&P>0?P-=2*Math.PI:o&&P<0&&(P+=2*Math.PI),P%=2*Math.PI;var w=L+P*u,F=e*Math.cos(w),U=t*Math.sin(w),_={x:Math.cos(l)*F-Math.sin(l)*U+k.x,y:Math.sin(l)*F+Math.cos(l)*U+k.y,ellipticalArcStartAngle:L,ellipticalArcEndAngle:L+P,ellipticalArcAngle:w,ellipticalArcCenter:k,resultantRx:e,resultantRy:t};return _};function Ao(n){for(var i=[],e=null,t=null,r=null,a=0,o=n.length,s=0;s<o;s++){var u=n[s];t=n[s+1];var l=u[0],c={command:l,prePoint:e,params:u,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(l){case"M":r=[u[1],u[2]],a=s;break;case"A":var f=Ro(e,u);c.arcParams=f;break}if(l==="Z")e=r,t=n[a+1];else{var h=u.length;e=[u[h-2],u[h-1]]}t&&t[0]==="Z"&&(t=n[a],i[a]&&(i[a].prePoint=e)),c.currentPoint=e,i[a]&&Yt(e,i[a].currentPoint)&&(i[a].prePoint=c.prePoint);var d=t?[t[t.length-2],t[t.length-1]]:null;c.nextPoint=d;var v=c.prePoint;if(["L","H","V"].includes(l))c.startTangent=[v[0]-e[0],v[1]-e[1]],c.endTangent=[e[0]-v[0],e[1]-v[1]];else if(l==="Q"){var g=[u[1],u[2]];c.startTangent=[v[0]-g[0],v[1]-g[1]],c.endTangent=[e[0]-g[0],e[1]-g[1]]}else if(l==="T"){var p=i[s-1],y=Xr(p.currentPoint,v);p.command==="Q"?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[e[0]-y[0],e[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-e[0],v[1]-e[1]],c.endTangent=[e[0]-v[0],e[1]-v[1]])}else if(l==="C"){var m=[u[1],u[2]],k=[u[3],u[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[e[0]-k[0],e[1]-k[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[k[0]-m[0],k[1]-m[1]])}else if(l==="S"){var x=i[s-1],L=Xr(x.currentPoint,v),O=[u[1],u[2]];x.command==="C"?(c.command="C",c.startTangent=[v[0]-L[0],v[1]-L[1]],c.endTangent=[e[0]-O[0],e[1]-O[1]]):(c.command="SQ",c.startTangent=[v[0]-O[0],v[1]-O[1]],c.endTangent=[e[0]-O[0],e[1]-O[1]])}else if(l==="A"){var P=Qr(c,0),w=P.x,F=P.y,U=Qr(c,1,!1),_=U.x,D=U.y;c.startTangent=[w,F],c.endTangent=[_,D]}i.push(c)}return i}function Qr(n,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t=n.arcParams,r=t.rx,a=r===void 0?0:r,o=t.ry,s=o===void 0?0:o,u=t.xRotation,l=t.arcFlag,c=t.sweepFlag,f=Jr({x:n.prePoint[0],y:n.prePoint[1]},a,s,u,!!l,!!c,{x:n.currentPoint[0],y:n.currentPoint[1]},i),h=Jr({x:n.prePoint[0],y:n.prePoint[1]},a,s,u,!!l,!!c,{x:n.currentPoint[0],y:n.currentPoint[1]},e?i+.005:i-.005),d=h.x-f.x,v=h.y-f.y,g=Math.sqrt(d*d+v*v);return{x:-d/g,y:-v/g}}function Xt(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function wn(n,i){return Xt(n)*Xt(i)?(n[0]*i[0]+n[1]*i[1])/(Xt(n)*Xt(i)):1}function qr(n,i){return(n[0]*i[1]<n[1]*i[0]?-1:1)*Math.acos(wn(n,i))}function Ro(n,i){var e=i[1],t=i[2],r=(0,hr.Z)(Q(i[3]),Math.PI*2),a=i[4],o=i[5],s=n[0],u=n[1],l=i[6],c=i[7],f=Math.cos(r)*(s-l)/2+Math.sin(r)*(u-c)/2,h=-1*Math.sin(r)*(s-l)/2+Math.cos(r)*(u-c)/2,d=f*f/(e*e)+h*h/(t*t);d>1&&(e*=Math.sqrt(d),t*=Math.sqrt(d));var v=e*e*(h*h)+t*t*(f*f),g=v?Math.sqrt((e*e*(t*t)-v)/v):1;a===o&&(g*=-1),isNaN(g)&&(g=0);var p=t?g*e*h/t:0,y=e?g*-t*f/e:0,m=(s+l)/2+Math.cos(r)*p-Math.sin(r)*y,k=(u+c)/2+Math.sin(r)*p+Math.cos(r)*y,x=[(f-p)/e,(h-y)/t],L=[(-1*f-p)/e,(-1*h-y)/t],O=qr([1,0],x),P=qr(x,L);return wn(x,L)<=-1&&(P=Math.PI),wn(x,L)>=1&&(P=0),o===0&&P>0&&(P-=2*Math.PI),o===1&&P<0&&(P+=2*Math.PI),{cx:m,cy:k,rx:Yt(n,[l,c])?0:e,ry:Yt(n,[l,c])?0:t,startAngle:O,endAngle:O+P,xRotation:r,arcFlag:a,sweepFlag:o}}function bo(n,i,e){return n.reduce(function(t,r){var a="";if(r[0]==="M"||r[0]==="L"){var o=E.al(r[1],r[2],0);e&&E.fF(o,o,e),a="".concat(r[0]).concat(o[0],",").concat(o[1])}else if(r[0]==="Z")a=r[0];else if(r[0]==="C"){var s=E.al(r[1],r[2],0),u=E.al(r[3],r[4],0),l=E.al(r[5],r[6],0);e&&(E.fF(s,s,e),E.fF(u,u,e),E.fF(l,l,e)),a="".concat(r[0]).concat(s[0],",").concat(s[1],",").concat(u[0],",").concat(u[1],",").concat(l[0],",").concat(l[1])}else if(r[0]==="A"){var c=E.al(r[6],r[7],0);e&&E.fF(c,c,e),a="".concat(r[0]).concat(r[1],",").concat(r[2],",").concat(r[3],",").concat(r[4],",").concat(r[5],",").concat(c[0],",").concat(c[1])}else if(r[0]==="Q"){var f=E.al(r[1],r[2],0),h=E.al(r[3],r[4],0);e&&(E.fF(f,f,e),E.fF(h,h,e)),a="".concat(r[0]).concat(r[1],",").concat(r[2],",").concat(r[3],",").concat(r[4],"}")}return t+=a},"")}function Oo(n,i,e,t){return[["M",n,i],["L",e,t]]}function jr(n,i,e,t){var r=(-1+Math.sqrt(2))/3*4,a=n*r,o=i*r,s=e-n,u=e+n,l=t-i,c=t+i;return[["M",s,t],["C",s,t-o,e-a,l,e,l],["C",e+a,l,u,t-o,u,t],["C",u,t+o,e+a,c,e,c],["C",e-a,c,s,t+o,s,t],["Z"]]}function Lo(n,i){var e=n.map(function(t,r){return[r===0?"M":"L",t[0],t[1]]});return i&&e.push(["Z"]),e}function Do(n,i,e,t,r){if(r){var a=(0,oe.Z)(r,4),o=a[0],s=a[1],u=a[2],l=a[3],c=n>0?1:-1,f=i>0?1:-1,h=c+f!==0?1:0;return[["M",c*o+e,t],["L",n-c*s+e,t],s?["A",s,s,0,0,h,n+e,f*s+t]:null,["L",n+e,i-f*u+t],u?["A",u,u,0,0,h,n+e-c*u,i+t]:null,["L",e+c*l,i+t],l?["A",l,l,0,0,h,e,i+t-f*l]:null,["L",e,f*o+t],o?["A",o,o,0,0,h,c*o+e,t]:null,["Z"]].filter(function(d){return d})}return[["M",e,t],["L",e+n,t],["L",e+n,t+i],["L",e,t+i],["Z"]]}function Io(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.getLocalTransform(),e=[];switch(n.nodeName){case R.LINE:var t=n.parsedStyle,r=t.x1,a=r===void 0?0:r,o=t.y1,s=o===void 0?0:o,u=t.x2,l=u===void 0?0:u,c=t.y2,f=c===void 0?0:c;e=Oo(a,s,l,f);break;case R.CIRCLE:{var h=n.parsedStyle,d=h.r,v=d===void 0?0:d,g=h.cx,p=g===void 0?0:g,y=h.cy,m=y===void 0?0:y;e=jr(v,v,p,m);break}case R.ELLIPSE:{var k=n.parsedStyle,x=k.rx,L=x===void 0?0:x,O=k.ry,P=O===void 0?0:O,w=k.cx,F=w===void 0?0:w,U=k.cy,_=U===void 0?0:U;e=jr(L,P,F,_);break}case R.POLYLINE:case R.POLYGON:var D=n.parsedStyle.points;e=Lo(D.points,n.nodeName===R.POLYGON);break;case R.RECT:var H=n.parsedStyle,K=H.width,te=K===void 0?0:K,he=H.height,b=he===void 0?0:he,G=H.x,z=G===void 0?0:G,ve=H.y,de=ve===void 0?0:ve,Ie=H.radius,sr=Ie&&Ie.some(function(bt){return bt!==0});e=Do(te,b,z,de,sr&&Ie.map(function(bt){return(0,dt.Z)(bt,0,Math.min(Math.abs(te)/2,Math.abs(b)/2))}));break;case R.PATH:var ur=n.parsedStyle.d.absolutePath;e=(0,j.Z)(ur);break}if(e.length)return bo(e,n,i)}function El(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a=n.map(function(o,s){var u=o[0],l=n[s+1],c=s===0&&(i!==0||e!==0),f=(s===n.length-1||l&&(l[0]==="M"||l[0]==="Z"))&&t!==0&&r!==0,h=c?[i,e]:[0,0],d=_slicedToArray(h,2),v=d[0],g=d[1],p=f?[t,r]:[0,0],y=_slicedToArray(p,2),m=y[0],k=y[1];switch(u){case"M":return"M ".concat(o[1]+v,",").concat(o[2]+g);case"L":return"L ".concat(o[1]+m,",").concat(o[2]+k);case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]+m," ").concat(o[4]+k);case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]+m," ").concat(o[6]+k);case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7]).concat(f?" L ".concat(o[6]+t,",").concat(o[7]+r):"");case"Z":return"Z";default:return null}}).filter(function(o){return o!==null}).join(" ");return~a.indexOf("NaN")?"":a}var ei=function(i){if(i===""||Array.isArray(i)&&i.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=(0,vr.A)(i)}catch(d){e=(0,vr.A)(""),console.error("[g]: Invalid SVG Path definition: ".concat(i))}Co(e);var t=Mo(e),r=wo(e),a=r.polygons,o=r.polylines,s=Ao(e),u=No(s,0),l=u.x,c=u.y,f=u.width,h=u.height;return{absolutePath:e,hasArc:t,segments:s,polygons:a,polylines:o,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(f)?f:0,height:Number.isFinite(h)?h:0}}},Zo=ce(ei);function ti(n){return(0,Ee.Z)(n)?Zo(n):ei(n)}function _o(n,i,e){var t=n.curve,r=i.curve;(!t||t.length===0)&&(t=(0,dr.Y)(n.absolutePath,!1),n.curve=t),(!r||r.length===0)&&(r=(0,dr.Y)(i.absolutePath,!1),i.curve=r);var a=[t,r];t.length!==r.length&&(a=(0,ea.x)(t,r));var o=(0,gr.b)(a[0])!==(0,gr.b)(a[1])?(0,ta.G)(a[0]):(0,na.U)(a[0]);return[o,(0,ra.g)(a[1],o),function(s){return s}]}function Fo(n,i){var e;return(0,Ee.Z)(n)?e=n.split(" ").map(function(t){var r=t.split(","),a=(0,oe.Z)(r,2),o=a[0],s=a[1];return[Number(o),Number(s)]}):e=n,{points:e,totalLength:0,segments:[]}}function Go(n,i){return[n.points,i.points,function(e){return e}]}var ue=null,ht=/\s*(\w+)\(([^)]*)\)/g;function Se(n){return function(i){var e=0;return n.map(function(t){return t===ue?i[e++]:t})}}function Qe(n){return n}var St={matrix:["NNNNNN",[ue,ue,0,0,ue,ue,0,0,0,0,1,0,ue,ue,0,1],Qe],matrix3d:["NNNNNNNNNNNNNNNN",Qe],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Se([ue,ue,new J(1)]),Qe],scaleX:["N",Se([ue,new J(1),new J(1)]),Se([ue,new J(1)])],scaleY:["N",Se([new J(1),ue,new J(1)]),Se([new J(1),ue])],scaleZ:["N",Se([new J(1),new J(1),ue])],scale3d:["NNN",Qe],skew:["Aa",null,Qe],skewX:["A",null,Se([ue,Je])],skewY:["A",null,Se([Je,ue])],translate:["Tt",Se([ue,ue,De]),Qe],translateX:["T",Se([ue,De,De]),Se([ue,De])],translateY:["T",Se([De,ue,De]),Se([De,ue])],translateZ:["L",Se([De,De,ue])],translate3d:["TTL",Qe]};function ni(n){for(var i=[],e=n.length,t=0;t<e;t++){var r=n[t],a=r[0],o=r.slice(1);a==="translate"||a==="skew"?o.length===1&&o.push(0):a==="scale"&&o.length===1&&o.push(o[0]);var s=St[a];if(!s)return[];var u=o.map(function(l){return re(l)});i.push({t:a,d:u})}return i}function ri(n){if(Array.isArray(n))return ni(n);if(n=(n||"none").trim(),n==="none")return[];var i=[],e,t=0;for(ht.lastIndex=0;e=ht.exec(n);){if(e.index!==t)return[];t=e.index+e[0].length;var r=e[1],a=St[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var u=[],l=0;l<s.length;l++){var c=o[l],f=s[l],h=void 0;if(c?h={A:function(v){return v.trim()==="0"?Je:Eo(v)},N:Pn,T:Tn,L:mo}[f.toUpperCase()](c):h={a:Je,n:u[0],t:De}[f],h===void 0)return[];u.push(h)}if(i.push({t:r,d:u}),ht.lastIndex===n.length)return i}return[]}function Uo(n){if(Array.isArray(n))return ni(n);if(n=(n||"none").trim(),n==="none")return[];var i=[],e,t=0;for(ht.lastIndex=0;e=ht.exec(n);){if(e.index!==t)return[];t=e.index+e[0].length;var r=e[1],a=St[r];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var u=[],l=0;l<s.length;l++){var c=o[l],f=s[l],h=void 0;if(c?h={A:function(v){return v.trim()==="0"?Je:Wr(v)},N:Yr,T:zr,L:Br}[f.toUpperCase()](c):h={a:Je,n:u[0],t:De}[f],h===void 0)return[];u.push(h)}if(i.push({t:r,d:u}),ht.lastIndex===n.length)return i}return[]}function Bo(n){var i,e,t,r;switch(n.t){case"rotateX":return r=Q(Pe(n.d[0])),[1,0,0,0,0,Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1];case"rotateY":return r=Q(Pe(n.d[0])),[Math.cos(r),0,-Math.sin(r),0,0,1,0,0,Math.sin(r),0,Math.cos(r),0,0,0,0,1];case"rotate":case"rotateZ":return r=Q(Pe(n.d[0])),[Math.cos(r),Math.sin(r),0,0,-Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1];case"rotate3d":i=n.d[0].value,e=n.d[1].value,t=n.d[2].value,r=Q(Pe(n.d[3]));var a=i*i+e*e+t*t;if(a===0)i=1,e=0,t=0;else if(a!==1){var o=Math.sqrt(a);i/=o,e/=o,t/=o}var s=Math.sin(r/2),u=s*Math.cos(r/2),l=s*s;return[1-2*(e*e+t*t)*l,2*(i*e*l+t*u),2*(i*t*l-e*u),0,2*(i*e*l-t*u),1-2*(i*i+t*t)*l,2*(e*t*l+i*u),0,2*(i*t*l+e*u),2*(e*t*l-i*u),1-2*(i*i+e*e)*l,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var c=Q(Pe(n.d[0])),f=Q(Pe(n.d[1]));return[1,Math.tan(f),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return r=Q(Pe(n.d[0])),[1,0,0,0,Math.tan(r),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return r=Q(Pe(n.d[0])),[1,Math.tan(r),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return i=Ce(n.d[0],0,null)||0,e=Ce(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,i,e,0,1];case"translateX":return i=Ce(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,i,0,0,1];case"translateY":return e=Ce(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1];case"translateZ":return t=Ce(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,t,1];case"translate3d":return i=Ce(n.d[0],0,null)||0,e=Ce(n.d[1],0,null)||0,t=Ce(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,i,e,t,1];case"perspective":var h=Ce(n.d[0],0,null)||0,d=h?-1/h:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(v){return v.value})}}function zo(n,i){return[n[0]*i[0]+n[4]*i[1]+n[8]*i[2]+n[12]*i[3],n[1]*i[0]+n[5]*i[1]+n[9]*i[2]+n[13]*i[3],n[2]*i[0]+n[6]*i[1]+n[10]*i[2]+n[14]*i[3],n[3]*i[0]+n[7]*i[1]+n[11]*i[2]+n[15]*i[3],n[0]*i[4]+n[4]*i[5]+n[8]*i[6]+n[12]*i[7],n[1]*i[4]+n[5]*i[5]+n[9]*i[6]+n[13]*i[7],n[2]*i[4]+n[6]*i[5]+n[10]*i[6]+n[14]*i[7],n[3]*i[4]+n[7]*i[5]+n[11]*i[6]+n[15]*i[7],n[0]*i[8]+n[4]*i[9]+n[8]*i[10]+n[12]*i[11],n[1]*i[8]+n[5]*i[9]+n[9]*i[10]+n[13]*i[11],n[2]*i[8]+n[6]*i[9]+n[10]*i[10]+n[14]*i[11],n[3]*i[8]+n[7]*i[9]+n[11]*i[10]+n[15]*i[11],n[0]*i[12]+n[4]*i[13]+n[8]*i[14]+n[12]*i[15],n[1]*i[12]+n[5]*i[13]+n[9]*i[14]+n[13]*i[15],n[2]*i[12]+n[6]*i[13]+n[10]*i[14]+n[14]*i[15],n[3]*i[12]+n[7]*i[13]+n[11]*i[14]+n[15]*i[15]]}function Wo(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(Bo).reduce(zo)}function ii(n){var i=[0,0,0],e=[1,1,1],t=[0,0,0],r=[0,0,0,1],a=[0,0,0,1];return Ta(Wo(n),i,e,t,r,a),[[i,e,t,a,r]]}var Vo=function(){function n(t,r){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var u=0;u<4;u++)a[o][s]+=r[o][u]*t[u][s];return a}function i(t){return t[0][2]===0&&t[0][3]===0&&t[1][2]===0&&t[1][3]===0&&t[2][0]===0&&t[2][1]===0&&t[2][2]===1&&t[2][3]===0&&t[3][2]===0&&t[3][3]===1}function e(t,r,a,o,s){for(var u=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)u[l][3]=s[l];for(var c=0;c<3;c++)for(var f=0;f<3;f++)u[3][c]+=t[f]*u[f][c];var h=o[0],d=o[1],v=o[2],g=o[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+v*v),p[0][1]=2*(h*d-v*g),p[0][2]=2*(h*v+d*g),p[1][0]=2*(h*d+v*g),p[1][1]=1-2*(h*h+v*v),p[1][2]=2*(d*v-h*g),p[2][0]=2*(h*v-d*g),p[2][1]=2*(d*v+h*g),p[2][2]=1-2*(h*h+d*d),u=n(u,p);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(y[2][1]=a[2],u=n(u,y)),a[1]&&(y[2][1]=0,y[2][0]=a[0],u=n(u,y)),a[0]&&(y[2][0]=0,y[1][0]=a[0],u=n(u,y));for(var m=0;m<3;m++)for(var k=0;k<3;k++)u[m][k]*=r[m];return i(u)?[u[0][0],u[0][1],u[1][0],u[1][1],u[3][0],u[3][1]]:u[0].concat(u[1],u[2],u[3])}return e}();function Ho(n){return n.toFixed(6).replace(".000000","")}function Nn(n,i){var e,t;return n.decompositionPair!==i&&(n.decompositionPair=i,e=ii(n)),i.decompositionPair!==n&&(i.decompositionPair=n,t=ii(i)),e[0]===null||t[0]===null?[[!1],[!0],function(r){return r?i[0].d:n[0].d}]:(e[0].push(0),t[0].push(1),[e,t,function(r){var a=$o(e[0][3],t[0][3],r[5]),o=Vo(r[0],r[1],r[2],a,r[4]),s=o.map(Ho).join(",");return s}])}function Yo(n,i){for(var e=0,t=0;t<n.length;t++)e+=n[t]*i[t];return e}function $o(n,i,e){var t=Yo(n,i);t=(0,dt.Z)(t,-1,1);var r=[];if(t===1)r=n;else for(var a=Math.acos(t),o=Math.sin(e*a)*1/Math.sqrt(1-t*t),s=0;s<4;s++)r.push(n[s]*(Math.cos(e*a)-t*o)+i[s]*o);return r}function An(n){return n.replace(/[XY]/,"")}function Rn(n){return n.replace(/(X|Y|Z|3d)?$/,"3d")}var Xo=function(i,e){return i==="perspective"&&e==="perspective"||(i==="matrix"||i==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function Ko(n,i,e){var t=!1;if(!n.length||!i.length){n.length||(t=!0,n=i,i=[]);for(var r=function(){var _=n[a],D=_.t,H=_.d,K=D.substring(0,5)==="scale"?1:0;i.push({t:D,d:H.map(function(te){return typeof te=="number"?re(K):re(K,te.unit)})})},a=0;a<n.length;a++)r()}var o=[],s=[],u=[];if(n.length!==i.length){var l=Nn(n,i);o=[l[0]],s=[l[1]],u=[["matrix",[l[2]]]]}else for(var c=0;c<n.length;c++){var f=n[c].t,h=i[c].t,d=n[c].d,v=i[c].d,g=St[f],p=St[h],y=void 0;if(Xo(f,h)){var m=Nn([n[c]],[i[c]]);o.push(m[0]),s.push(m[1]),u.push(["matrix",[m[2]]]);continue}else if(f===h)y=f;else if(g[2]&&p[2]&&An(f)===An(h))y=An(f),d=g[2](d),v=p[2](v);else if(g[1]&&p[1]&&Rn(f)===Rn(h))y=Rn(f),d=g[1](d),v=p[1](v);else{var k=Nn(n,i);o=[k[0]],s=[k[1]],u=[["matrix",[k[2]]]];break}for(var x=[],L=[],O=[],P=0;P<d.length;P++){var w=ko(d[P],v[P],e,!1,P);x[P]=w[0],L[P]=w[1],O.push(w[2])}o.push(x),s.push(L),u.push([y,O])}if(t){var F=o;o=s,s=F}return[o,s,function(U){return U.map(function(_,D){var H=_.map(function(K,te){return u[D][1][te](K)}).join(",");return u[D][0]==="matrix"&&H.split(",").length===16&&(u[D][0]="matrix3d"),u[D][0]==="matrix3d"&&H.split(",").length===6&&(u[D][0]="matrix"),"".concat(u[D][0],"(").concat(H,")")}).join(" ")}]}var Jo=ce(function(n){if((0,Ee.Z)(n)){if(n==="text-anchor")return[re(0,"px"),re(0,"px")];var i=n.split(" ");return i.length===1&&(i[0]==="top"||i[0]==="bottom"?(i[1]=i[0],i[0]="center"):i[1]="center"),i.length!==2?null:[Tn(ai(i[0])),Tn(ai(i[1]))]}return[re(n[0]||0,"px"),re(n[1]||0,"px")]});function ai(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var bn=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:N.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:N.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:N.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:N.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:N.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:N.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:N.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:N.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:N.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:N.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:N.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:N.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:N.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:N.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:N.FILTER},{n:"clipPath",syntax:N.DEFINED_PATH},{n:"textPath",syntax:N.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:N.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:N.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:N.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:N.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:N.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:N.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:N.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:N.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:N.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:N.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:N.COORDINATE},{n:"y1",int:!0,l:!0,syntax:N.COORDINATE},{n:"z1",int:!0,l:!0,syntax:N.COORDINATE},{n:"x2",int:!0,l:!0,syntax:N.COORDINATE},{n:"y2",int:!0,l:!0,syntax:N.COORDINATE},{n:"z2",int:!0,l:!0,syntax:N.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:N.PATH,p:50},{n:"points",int:!0,l:!0,syntax:N.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:N.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:N.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:N.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:N.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:N.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:N.NUMBER,d:function(i){return i===R.PATH||i===R.POLYGON||i===R.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:N.MARKER},{n:"markerEnd",syntax:N.MARKER},{n:"markerMid",syntax:N.MARKER},{n:"markerStartOffset",syntax:N.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:N.LENGTH,l:!0,int:!0,d:"0"}],Qo=new Set(bn.filter(function(n){return!!n.l}).map(function(n){return n.n})),oi={},qo=function(){function n(i){var e=this;(0,S.Z)(this,n),this.runtime=i,bn.forEach(function(t){e.registerMetadata(t)})}return(0,C.Z)(n,[{key:"registerMetadata",value:function(e){[e.n].concat((0,j.Z)(e.a||[])).forEach(function(t){oi[t]=e})}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e]}},{key:"processProperties",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(e.attributes,t);var a=e.parsedStyle.clipPath,o=e.parsedStyle.offsetPath;jo(e,t);var s=!!r.forceUpdateGeometry;if(!s){for(var u in t)if(Qo.has(u)){s=!0;break}}var l=si(e);l.has("fill")&&t.fill&&(e.parsedStyle.fill=ft(t.fill)),l.has("stroke")&&t.stroke&&(e.parsedStyle.stroke=ft(t.stroke)),l.has("shadowColor")&&t.shadowColor&&(e.parsedStyle.shadowColor=ft(t.shadowColor)),l.has("filter")&&t.filter&&(e.parsedStyle.filter=Po(t.filter)),l.has("radius")&&!(0,ge.Z)(t.radius)&&(e.parsedStyle.radius=Vr(t.radius,4)),l.has("lineDash")&&!(0,ge.Z)(t.lineDash)&&(e.parsedStyle.lineDash=Vr(t.lineDash,"even")),l.has("points")&&t.points&&(e.parsedStyle.points=Fo(t.points)),l.has("d")&&t.d===""&&(e.parsedStyle.d=(0,B.Z)({},Cr)),l.has("d")&&t.d&&(e.parsedStyle.d=ti(t.d)),l.has("textTransform")&&t.textTransform&&this.runtime.CSSPropertySyntaxFactory[N.TEXT_TRANSFORM].calculator(null,null,{value:t.textTransform},e,null),l.has("clipPath")&&!(0,ie.Z)(t.clipPath)&&this.runtime.CSSPropertySyntaxFactory[N.DEFINED_PATH].calculator("clipPath",a,t.clipPath,e,this.runtime),l.has("offsetPath")&&t.offsetPath&&this.runtime.CSSPropertySyntaxFactory[N.DEFINED_PATH].calculator("offsetPath",o,t.offsetPath,e,this.runtime),l.has("transform")&&t.transform&&(e.parsedStyle.transform=ri(t.transform)),l.has("transformOrigin")&&t.transformOrigin&&(e.parsedStyle.transformOrigin=Jo(t.transformOrigin)),l.has("markerStart")&&t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[N.MARKER].calculator(null,t.markerStart,t.markerStart,null,null)),l.has("markerEnd")&&t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[N.MARKER].calculator(null,t.markerEnd,t.markerEnd,null,null)),l.has("markerMid")&&t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[N.MARKER].calculator("",t.markerMid,t.markerMid,null,null)),l.has("zIndex")&&!(0,ge.Z)(t.zIndex)&&this.runtime.CSSPropertySyntaxFactory[N.Z_INDEX].postProcessor(e),l.has("offsetDistance")&&!(0,ge.Z)(t.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[N.OFFSET_DISTANCE].postProcessor(e),l.has("transform")&&t.transform&&this.runtime.CSSPropertySyntaxFactory[N.TRANSFORM].postProcessor(e),l.has("transformOrigin")&&t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[N.TRANSFORM_ORIGIN].postProcessor(e),s&&(e.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(e))}},{key:"updateGeometry",value:function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var a=e.geometry;a.contentBounds||(a.contentBounds=new me),a.renderBounds||(a.renderBounds=new me);var o=e.parsedStyle,s=r.update(o,e),u=s.cx,l=u===void 0?0:u,c=s.cy,f=c===void 0?0:c,h=s.cz,d=h===void 0?0:h,v=s.hwidth,g=v===void 0?0:v,p=s.hheight,y=p===void 0?0:p,m=s.hdepth,k=m===void 0?0:m,x=[Math.abs(g),Math.abs(y),k],L=o.stroke,O=o.lineWidth,P=O===void 0?1:O,w=o.increasedLineWidthForHitTesting,F=w===void 0?0:w,U=o.shadowType,_=U===void 0?"outer":U,D=o.shadowColor,H=o.filter,K=H===void 0?[]:H,te=o.transformOrigin,he=[l,f,d];a.contentBounds.update(he,x);var b=t===R.POLYLINE||t===R.POLYGON||t===R.PATH?Math.SQRT2:.5,G=L&&!L.isNone;if(G){var z=((P||0)+(F||0))*b;x[0]+=z,x[1]+=z}if(a.renderBounds.update(he,x),D&&_&&_!=="inner"){var ve=a.renderBounds,de=ve.min,Ie=ve.max,sr=o.shadowBlur,ur=o.shadowOffsetX,bt=o.shadowOffsetY,on=sr||0,Bi=ur||0,zi=bt||0,al=de[0]-on+Bi,ol=Ie[0]+on+Bi,sl=de[1]-on+zi,ul=Ie[1]+on+zi;de[0]=Math.min(de[0],al),Ie[0]=Math.max(Ie[0],ol),de[1]=Math.min(de[1],sl),Ie[1]=Math.max(Ie[1],ul),a.renderBounds.setMinMax(de,Ie)}K.forEach(function(Hi){var Yi=Hi.name,sn=Hi.params;if(Yi==="blur"){var $i=sn[0].value;a.renderBounds.update(a.renderBounds.center,E.IH(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[$i,$i,0]))}else if(Yi==="drop-shadow"){var Xi=sn[0].value,Ki=sn[1].value,un=sn[2].value,Ji=a.renderBounds,nt=Ji.min,rt=Ji.max,fl=nt[0]-un+Xi,hl=rt[0]+un+Xi,vl=nt[1]-un+Ki,dl=rt[1]+un+Ki;nt[0]=Math.min(nt[0],fl),rt[0]=Math.max(rt[0],hl),nt[1]=Math.min(nt[1],vl),rt[1]=Math.max(rt[1],dl),a.renderBounds.setMinMax(nt,rt)}}),e.geometry.dirty=!1;var ll=g<0,cl=y<0,Wi=(ll?-1:1)*(te?Ce(te[0],0,e,!0):0),Vi=(cl?-1:1)*(te?Ce(te[1],1,e,!0):0);(Wi||Vi)&&e.setOrigin(Wi,Vi)}}},{key:"updateSizeAttenuation",value:function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===R.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===R.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))}}])}();function jo(n,i){var e=si(n);for(var t in i)e.has(t)&&(n.parsedStyle[t]=i[t])}function si(n){return n.constructor.PARSED_STYLE_LIST}var es=function(){function n(){(0,S.Z)(this,n),this.mixer=Sn}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){return Pe(r)}}])}(),ts=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a,o){return r instanceof Ae&&(r=null),o.sceneGraphService.updateDisplayObjectDependency(e,t,r,a),e==="clipPath"&&a.forEach(function(s){s.childNodes.length===0&&o.sceneGraphService.dirtyToRoot(s)}),r}}])}(),ns=function(){function n(){(0,S.Z)(this,n),this.parser=ft,this.mixer=po}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){return r instanceof Ae?r.value==="none"?Fr:Gr:r}}])}(),rs=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r instanceof Ae?[]:r}}])}();function ui(n){var i=n.parsedStyle,e=i.fontSize;return(0,ge.Z)(e)?null:e}var On=function(){function n(){(0,S.Z)(this,n),this.mixer=Sn}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a,o){if((0,We.Z)(r))return r;if(J.isRelativeUnit(r.unit)){if(r.unit===A.kPercentage)return 0;if(r.unit===A.kEms){if(a.parentNode){var s=ui(a.parentNode);if(s)return s*=r.value,s}return 0}if(r.unit===A.kRems){var u;if(a!=null&&(u=a.ownerDocument)!==null&&u!==void 0&&u.documentElement){var l=ui(a.ownerDocument.documentElement);if(l)return l*=r.value,l}return 0}}else return r.value}}])}(),is=function(){function n(){(0,S.Z)(this,n),this.mixer=$r}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r.map(function(a){return a.value})}}])}(),as=function(){function n(){(0,S.Z)(this,n),this.mixer=$r}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r.map(function(a){return a.value})}}])}(),os=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){var o;r instanceof Ae&&(r=null);var s=(o=r)===null||o===void 0?void 0:o.cloneNode(!0);return s&&(s.style.isMarker=!0),s}}])}(),ss=function(){function n(){(0,S.Z)(this,n),this.mixer=Sn}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r.value}}])}(),us=function(){function n(){(0,S.Z)(this,n),this.mixer=Cn(0,1)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r.value}},{key:"postProcessor",value:function(e){var t=e.parsedStyle,r=t.offsetPath,a=t.offsetDistance;if(r){var o=r.nodeName;if(o===R.LINE||o===R.PATH||o===R.POLYLINE){var s=r.getPoint(a);s&&e.setLocalPosition(s.x,s.y)}}}}])}(),ls=function(){function n(){(0,S.Z)(this,n),this.mixer=Cn(0,1)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r.value}}])}(),cs=function(){function n(){(0,S.Z)(this,n),this.parser=ti,this.mixer=_o}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r){return r instanceof Ae&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new st(0,0,0,0)}:r}}])}(),fs=(0,C.Z)(function n(){(0,S.Z)(this,n),this.mixer=Go}),hs=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.mixer=Cn(0,1/0),e}return(0,$.Z)(i,n),(0,C.Z)(i)}(On),vs=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){return r instanceof Ae?r.value==="unset"?"":r.value:"".concat(r)}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||""}}])}(),ds=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){var o=a.getAttribute("text");if(o){var s=o;r.value==="capitalize"?s=o.charAt(0).toUpperCase()+o.slice(1):r.value==="lowercase"?s=o.toLowerCase():r.value==="uppercase"&&(s=o.toUpperCase()),a.parsedStyle.text=s}return r.value}}])}(),kl=function(i){return Object.fromEntries(Object.entries(i).filter(function(e){var t=_slicedToArray(e,2),r=t[1];return r!==void 0}))},Ln=new WeakMap;function gs(n,i,e){if(n){var t=typeof n=="string"?document.getElementById(n):n;Ln.has(t)&&Ln.get(t).destroy(e),Ln.set(t,i)}}var Dn=typeof window!="undefined"&&typeof window.document!="undefined";function ps(n){return!!n.getAttribute}function ms(n,i){for(var e=0,t=n.length;e<t;){var r=e+t>>>1;li(n[r],i)<0?e=r+1:t=r}return e}function li(n,i){var e=Number(n.parsedStyle.zIndex||0),t=Number(i.parsedStyle.zIndex||0);if(e===t){var r=n.parentNode;if(r){var a=r.childNodes||[];return a.indexOf(n)-a.indexOf(i)}}return e-t}function ci(n){var i=n;do{var e,t=(e=i.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(t)return i;i=i.parentElement}while(i!==null);return null}var fi="px";function ys(n,i,e){Dn&&n.style&&(n.style.width=i+fi,n.style.height=e+fi)}function hi(n,i){if(Dn)return document.defaultView.getComputedStyle(n,null).getPropertyValue(i)}function Es(n){var i=hi(n,"width");return i==="auto"?n.offsetWidth:parseFloat(i)}function ks(n){var i=hi(n,"height");return i==="auto"?n.offsetHeight:parseFloat(i)}var xs=1,Ts={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},In=typeof performance=="object"&&performance.now?performance:Date;function Kt(n){return n.nodeName===R.FRAGMENT?!0:n.getRootNode().nodeName===R.FRAGMENT}function Ps(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",i=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,t=!1,r=!1,a=!!i&&!i.isNone,o=!!e&&!e.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(t=a,r=o):n==="visiblefill"||n==="fill"?t=!0:n==="visiblestroke"||n==="stroke"?r=!0:(n==="visible"||n==="all")&&(t=!0,r=!0),[t,r]}var Ss=1,Cs=function(){return Ss++},Ge=typeof self=="object"&&self.self===self?self:typeof I.g=="object"&&I.g.global===I.g?I.g:{},Ms=Date.now(),ws=function(){return Ge.performance&&typeof Ge.performance.now=="function"?Ge.performance.now():Date.now()-Ms},Ct={},vi=Date.now(),Ns=function(i){if(typeof i!="function")throw new TypeError("".concat(i," is not a function"));var e=Date.now(),t=e-vi,r=t>16?0:16-t,a=Cs();return Ct[a]=i,Object.keys(Ct).length>1||setTimeout(function(){vi=e;var o=Ct;Ct={},Object.keys(o).forEach(function(s){return o[s](ws())})},r),a},As=function(i){delete Ct[i]},Rs=["","webkit","moz","ms","o"],di=function(i){return typeof i!="string"?Ns:i===""?Ge.requestAnimationFrame:Ge["".concat(i,"RequestAnimationFrame")]},bs=function(i){return typeof i!="string"?As:i===""?Ge.cancelAnimationFrame:Ge["".concat(i,"CancelAnimationFrame")]||Ge["".concat(i,"CancelRequestAnimationFrame")]},Os=function(i,e){for(var t=0;i[t]!==void 0;){if(e(i[t]))return i[t];t+=1}},gi=Os(Rs,function(n){return!!di(n)}),Zn=di(gi),pi=bs(gi);Ge.requestAnimationFrame=Zn,Ge.cancelAnimationFrame=pi;var Ls=function(){function n(){(0,S.Z)(this,n),this.callbacks=[]}return(0,C.Z)(n,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(e,t){this.callbacks.push(t)}},{key:"promise",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.all(this.callbacks.map(function(a){return a.apply(void 0,t)}))}}])}(),Ds=function(){function n(){(0,S.Z)(this,n),this.callbacks=[]}return(0,C.Z)(n,[{key:"tapPromise",value:function(e,t){this.callbacks.push(t)}},{key:"promise",value:function(){var i=(0,pt.Z)((0,Ze.Z)().mark(function t(){var r,a,o,s,u=arguments;return(0,Ze.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.callbacks.length){l.next=6;break}return l.next=1,(r=this.callbacks)[0].apply(r,u);case 1:a=l.sent,o=1;case 2:if(!(o<this.callbacks.length)){l.next=5;break}return s=this.callbacks[o],l.next=3,s(a);case 3:a=l.sent;case 4:o++,l.next=2;break;case 5:return l.abrupt("return",a);case 6:return l.abrupt("return",null);case 7:case"end":return l.stop()}},t,this)}));function e(){return i.apply(this,arguments)}return e}()}])}(),xe=function(){function n(){(0,S.Z)(this,n),this.callbacks=[]}return(0,C.Z)(n,[{key:"tap",value:function(e,t){this.callbacks.push(t)}},{key:"call",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=arguments;this.callbacks.forEach(function(o){o.apply(void 0,a)})}}])}(),_n=function(){function n(){(0,S.Z)(this,n),this.callbacks=[]}return(0,C.Z)(n,[{key:"tap",value:function(e,t){this.callbacks.push(t)}},{key:"call",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(this.callbacks.length){for(var a=arguments,o=this.callbacks[0].apply(void 0,a),s=1;s<this.callbacks.length;s++){var u=this.callbacks[s];o=u(o)}return o}return null}}])}(),Is=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Zs=/([\"\'])[^\'\"]+\1/;function mi(n){var i=n.fontSize,e=i===void 0?16:i,t=n.fontFamily,r=t===void 0?"sans-serif":t,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,u=s===void 0?"normal":s,l=n.fontWeight,c=l===void 0?"normal":l;return{fontSize:e,fontFamily:r,fontStyle:o,fontVariant:u,fontWeight:c}}var yi=ce(function(i){for(var e=mi(i),t=e.fontSize,r=e.fontFamily,a=e.fontStyle,o=e.fontVariant,s=e.fontWeight,u=(0,We.Z)(t)&&"".concat(t,"px")||"16px",l=r.split(","),c=l.length-1;c>=0;c--){var f=l[c].trim();!Zs.test(f)&&Is.indexOf(f)<0&&(f='"'.concat(f,'"')),l[c]=f}return"".concat(a," ").concat(o," ").concat(s," ").concat(u," ").concat(l.join(","))},function(n){var i=mi(n),e=i.fontSize,t=i.fontFamily,r=i.fontStyle,a=i.fontVariant,o=i.fontWeight;return"".concat(r,"_").concat(a,"_").concat(o,"_").concat(e,"_").concat(t)}),_s=1e-6,Mt=function(i){return Math.max(i,_s)};function Fn(n,i,e){return M.identity(n),n[4]=Math.tan(i),n[1]=Math.tan(e),n}var fe=M.create(),Fs=M.create(),Gs={scale:function(i){M.fromScaling(fe,[i[0].value,i[1].value,1].map(function(e){return Mt(e)}))},scaleX:function(i){M.fromScaling(fe,[i[0].value,1,1].map(function(e){return Mt(e)}))},scaleY:function(i){M.fromScaling(fe,[1,i[0].value,1].map(function(e){return Mt(e)}))},scaleZ:function(i){M.fromScaling(fe,[1,1,i[0].value].map(function(e){return Mt(e)}))},scale3d:function(i){M.fromScaling(fe,[i[0].value,i[1].value,i[2].value].map(function(e){return Mt(e)}))},translate:function(i){M.fromTranslation(fe,[i[0].value,i[1].value,0])},translateX:function(i){M.fromTranslation(fe,[i[0].value,0,0])},translateY:function(i){M.fromTranslation(fe,[0,i[0].value,0])},translateZ:function(i){M.fromTranslation(fe,[0,0,i[0].value])},translate3d:function(i){M.fromTranslation(fe,[i[0].value,i[1].value,i[2].value])},rotate:function(i){M.fromZRotation(fe,Q(Pe(i[0])))},rotateX:function(i){M.fromXRotation(fe,Q(Pe(i[0])))},rotateY:function(i){M.fromYRotation(fe,Q(Pe(i[0])))},rotateZ:function(i){M.fromZRotation(fe,Q(Pe(i[0])))},rotate3d:function(i){M.fromRotation(fe,Q(Pe(i[3])),[i[0].value,i[1].value,i[2].value])},skew:function(i){Fn(fe,Q(i[0].value),Q(i[1].value))},skewX:function(i){Fn(fe,Q(i[0].value),0)},skewY:function(i){Fn(fe,0,Q(i[0].value))},matrix:function(i){M.set(fe,i[0].value,i[1].value,0,0,i[2].value,i[3].value,0,0,0,0,1,0,i[4].value,i[5].value,0,1)},matrix3d:function(i){M.set.apply(M,[fe].concat((0,j.Z)(i.map(function(e){return e.value}))))}},Us=E.al(1,1,1),Bs=E.Ue(),Ei={translate:function(i,e){T.sceneGraphService.setLocalScale(i,Us,!1),T.sceneGraphService.setLocalEulerAngles(i,Bs,void 0,void 0,!1),T.sceneGraphService.setLocalPosition(i,[e[0].value,e[1].value,0],!1),T.sceneGraphService.dirtyLocalTransform(i,i.transformable)}};function ki(n,i){if(n.length){if(n.length===1&&Ei[n[0].t]){Ei[n[0].t](i,n[0].d);return}for(var e=M.identity(Fs),t=0;t<n.length;t++){var r=n[t],a=r.t,o=r.d,s=Gs[a];s&&(s(o),M.mul(e,e,fe))}i.setLocalTransform(e)}else i.resetLocalTransform();return i.getLocalTransform()}var zs=function(){function n(){(0,S.Z)(this,n),this.parser=Uo,this.mixer=Ko}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){return r instanceof Ae?[]:r}},{key:"postProcessor",value:function(e){ki(e.parsedStyle.transform,e)}}])}(),Ws=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"postProcessor",value:function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===A.kPixels&&t[1].unit===A.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()}}])}(),Vs=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"calculator",value:function(e,t,r,a){return r.value}},{key:"postProcessor",value:function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,a=t.sortable;r&&t.dirty(),a&&(a.dirty=!0,a.dirtyReason=Zt.Z_INDEX_CHANGED)}}}])}(),Hs=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e,t){var r=e.cx,a=r===void 0?0:r,o=e.cy,s=o===void 0?0:o,u=e.r,l=u===void 0?0:u;return{cx:a,cy:s,hwidth:l,hheight:l}}}])}(),Ys=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e,t){var r=e.cx,a=r===void 0?0:r,o=e.cy,s=o===void 0?0:o,u=e.rx,l=u===void 0?0:u,c=e.ry,f=c===void 0?0:c;return{cx:a,cy:s,hwidth:l,hheight:f}}}])}(),$s=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e){var t=e.x1,r=e.y1,a=e.x2,o=e.y2,s=Math.min(t,a),u=Math.max(t,a),l=Math.min(r,o),c=Math.max(r,o),f=u-s,h=c-l,d=f/2,v=h/2;return{cx:s+d,cy:l+v,hwidth:d,hheight:v}}}])}(),Xs=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e){var t=e.d,r=t.rect,a=r.x,o=r.y,s=r.width,u=r.height,l=s/2,c=u/2;return{cx:a+l,cy:o+c,hwidth:l,hheight:c}}}])}(),Ks=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e){if(e.points&&(0,ia.Z)(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,(0,j.Z)(t.map(function(h){return h[0]}))),a=Math.max.apply(Math,(0,j.Z)(t.map(function(h){return h[0]}))),o=Math.min.apply(Math,(0,j.Z)(t.map(function(h){return h[1]}))),s=Math.max.apply(Math,(0,j.Z)(t.map(function(h){return h[1]}))),u=a-r,l=s-o,c=u/2,f=l/2;return{cx:r+c,cy:o+f,hwidth:c,hheight:f}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),Js=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e,t){var r=e.x,a=r===void 0?0:r,o=e.y,s=o===void 0?0:o,u=e.src,l=e.width,c=l===void 0?0:l,f=e.height,h=f===void 0?0:f,d=c,v=h;return u&&!(0,Ee.Z)(u)&&(d||(d=u.width,e.width=d),v||(v=u.height,e.height=v)),{cx:a+d/2,cy:s+v/2,hwidth:d/2,hheight:v/2}}}])}(),Qs=function(){function n(i){(0,S.Z)(this,n),this.globalRuntime=i}return(0,C.Z)(n,[{key:"isReadyToMeasure",value:function(e,t){var r=e.text;return r}},{key:"update",value:function(e,t){var r,a=e.text,o=e.textAlign,s=o===void 0?"start":o,u=e.lineWidth,l=u===void 0?1:u,c=e.textBaseline,f=c===void 0?"alphabetic":c,h=e.dx,d=h===void 0?0:h,v=e.dy,g=v===void 0?0:v,p=e.x,y=p===void 0?0:p,m=e.y,k=m===void 0?0:m;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var x=(t==null||(r=t.ownerDocument)===null||r===void 0||(r=r.defaultView)===null||r===void 0?void 0:r.getConfig())||{},L=x.offscreenCanvas,O=this.globalRuntime.textService.measureText(a,e,L);e.metrics=O;var P=O.width,w=O.height,F=P/2,U=w/2,_=y+F;s==="center"||s==="middle"?_+=l/2-F:(s==="right"||s==="end")&&(_+=l-F*2);var D=k-U;return f==="middle"?D+=U:f==="top"||f==="hanging"?D+=U*2:f==="alphabetic"||(f==="bottom"||f==="ideographic")&&(D+=0),d&&(_+=d),g&&(D+=g),{cx:_,cy:D,hwidth:F,hheight:U}}}])}(),qs=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),js=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"update",value:function(e,t){var r=e.x,a=r===void 0?0:r,o=e.y,s=o===void 0?0:o,u=e.width,l=u===void 0?0:u,c=e.height,f=c===void 0?0:c;return{cx:a+l/2,cy:s+f/2,hwidth:l/2,hheight:f/2}}}])}();function xl(n){return!!n.type}var Jt=function(){function n(i){(0,S.Z)(this,n),this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new pe,this.page=new pe,this.canvas=new pe,this.viewport=new pe,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=i}return(0,C.Z)(n,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(ne)}}])}(),xi=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.client=new pe,e.movement=new pe,e.offset=new pe,e.global=new pe,e.screen=new pe,e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(ne)}}])}(Jt),Gn=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.width=0,e.height=0,e.isPrimary=!1,e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(xi),Un=function(n){function i(){return(0,S.Z)(this,i),(0,Y.Z)(this,i,arguments)}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(xi),ye=function(n){function i(e,t){var r;return(0,S.Z)(this,i),r=(0,Y.Z)(this,i,[null]),r.type=e,r.detail=t==null?void 0:t.detail,t&&!("detail"in t)&&(r.detail=t),Object.assign(r,t),r}return(0,$.Z)(i,n),(0,C.Z)(i)}(Jt),Ti=function(){function n(){(0,S.Z)(this,n),this.emitter=new lr.Z}return(0,C.Z)(n,[{key:"on",value:function(e,t,r){return this.addEventListener(e,t,r),this}},{key:"addEventListener",value:function(e,t,r){var a=!1,o=!1;if((0,pr.Z)(r))a=r;else if(r){var s=r.capture;a=s===void 0?!1:s;var u=r.once;o=u===void 0?!1:u}a&&(e+="capture"),t=(0,gt.Z)(t)?t:t.handleEvent;var l=(0,gt.Z)(t)?void 0:t;return o?this.emitter.once(e,t,l):this.emitter.on(e,t,l),this}},{key:"off",value:function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var e;(e=this.emitter)===null||e===void 0||e.removeAllListeners()}},{key:"removeEventListener",value:function(e,t,r){var a;if(!this.emitter)return this;var o=(0,pr.Z)(r)?r:r==null?void 0:r.capture;o&&(e+="capture"),t=(0,gt.Z)(t)?t:(a=t)===null||a===void 0?void 0:a.handleEvent;var s=(0,gt.Z)(t)?void 0:t;return this.emitter.off(e,t,s),this}},{key:"emit",value:function(e,t){this.dispatchEvent(new ye(e,t))}},{key:"dispatchEventToSelf",value:function(e){e.target||(e.target=this),e.currentTarget=this,this.emitter.emit(e.type,e)}},{key:"dispatchEvent",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2?arguments[2]:void 0;if(r)return this.dispatchEventToSelf(e),!0;var a;if(this.document)a=this;else if(this.defaultView)a=this.defaultView;else{var o;a=(o=this.ownerDocument)===null||o===void 0?void 0:o.defaultView}if(a){if(e.manager=a.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],t||(e.target=this),e.manager.dispatchEvent(e,e.type,t)}else this.dispatchEventToSelf(e);return!e.defaultPrevented}}])}(),ae=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.mutations=void 0,e.parentNode=null,e.destroyed=!1,e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"textContent",get:function(){var t="";this.nodeName===R.TEXT&&(t+=this.style.text);var r=(0,it.Z)(this.childNodes),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;o.nodeName===R.TEXT?t+=o.nodeValue:t+=o.textContent}}catch(s){r.e(s)}finally{r.f()}return t},set:function(t){var r=this;this.childNodes.slice().forEach(function(a){r.removeChild(a)}),this.nodeName===R.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(ne)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(ne)}},{key:"lookupPrefix",value:function(t){throw new Error(ne)}},{key:"normalize",value:function(){throw new Error(ne)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var r=t,a=this,o=[r],s=[a];(u=r.parentNode)!==null&&u!==void 0?u:a.parentNode;){var u;r=r.parentNode?(o.push(r.parentNode),r.parentNode):r,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a}if(r!==a)return i.DOCUMENT_POSITION_DISCONNECTED|i.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|i.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?i.DOCUMENT_POSITION_CONTAINED_BY|i.DOCUMENT_POSITION_FOLLOWING:i.DOCUMENT_POSITION_CONTAINS|i.DOCUMENT_POSITION_PRECEDING;for(var f=l.length-c.length,h=c.length-1;h>=0;h--){var d=c[h],v=l[f+h];if(v!==d){var g=d.parentNode.childNodes;return g.indexOf(d)<g.indexOf(v)?c===o?i.DOCUMENT_POSITION_PRECEDING:i.DOCUMENT_POSITION_FOLLOWING:l===o?i.DOCUMENT_POSITION_PRECEDING:i.DOCUMENT_POSITION_FOLLOWING}}return i.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r}},{key:"getAncestor",value:function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r}},{key:"forEach",value:function(t){for(var r=[this];r.length>0;){var a=r.pop(),o=t(a);if(o===!1)break;for(var s=a.childNodes.length-1;s>=0;s--)r.push(a.childNodes[s])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(Ti);ae.DOCUMENT_POSITION_DISCONNECTED=1,ae.DOCUMENT_POSITION_PRECEDING=2,ae.DOCUMENT_POSITION_FOLLOWING=4,ae.DOCUMENT_POSITION_CONTAINS=8,ae.DOCUMENT_POSITION_CONTAINED_BY=16,ae.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var eu=2048,tu=function(){function n(i,e){var t=this;(0,S.Z)(this,n),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=M.create(),this.tmpVec3=E.Ue(),this.onPointerDown=function(r){var a=t.createPointerEvent(r);if(t.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")t.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;t.dispatchEvent(a,o?"rightdown":"mousedown")}var s=t.trackingData(r.pointerId);s.pressTargetsByButton[r.button]=a.composedPath(),t.freeEvent(a)},this.onPointerUp=function(r){var a=In.now(),o=t.createPointerEvent(r,void 0,void 0,t.context.config.alwaysTriggerPointerEventOnCanvas?t.rootTarget:void 0);if(t.dispatchEvent(o,"pointerup"),o.pointerType==="touch")t.dispatchEvent(o,"touchend");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var s=o.button===2;t.dispatchEvent(o,s?"rightup":"mouseup")}var u=t.trackingData(r.pointerId),l=t.findMountedTarget(u.pressTargetsByButton[r.button]),c=l;if(l&&!o.composedPath().includes(l)){for(var f=l;f&&!o.composedPath().includes(f);){if(o.currentTarget=f,t.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch")t.notifyTarget(o,"touchendoutside");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var h=o.button===2;t.notifyTarget(o,h?"rightupoutside":"mouseupoutside")}ae.isNode(f)&&(f=f.parentNode)}delete u.pressTargetsByButton[r.button],c=f}if(c){var d,v=t.clonePointerEvent(o,"click");v.target=c,v.path=[],u.clicksByButton[r.button]||(u.clicksByButton[r.button]={clickCount:0,target:v.target,timeStamp:a});var g=t.context.renderingContext.root.ownerDocument.defaultView,p=u.clicksByButton[r.button];p.target===v.target&&a-p.timeStamp<g.getConfig().dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=v.target,p.timeStamp=a,v.detail=p.clickCount,(d=o.detail)!==null&&d!==void 0&&d.preventClick||(!t.context.config.useNativeClickEvent&&(v.pointerType==="mouse"||v.pointerType==="touch")&&t.dispatchEvent(v,"click"),t.dispatchEvent(v,"pointertap")),t.freeEvent(v)}t.freeEvent(o)},this.onPointerMove=function(r){var a=t.createPointerEvent(r,void 0,void 0,t.context.config.alwaysTriggerPointerEventOnCanvas?t.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=t.trackingData(r.pointerId),u=t.findMountedTarget(s.overTargets);if(s.overTargets&&u!==a.target){var l=r.type==="mousemove"?"mouseout":"pointerout",c=t.createPointerEvent(r,l,u||void 0);if(t.dispatchEvent(c,"pointerout"),o&&t.dispatchEvent(c,"mouseout"),!a.composedPath().includes(u)){var f=t.createPointerEvent(r,"pointerleave",u||void 0);for(f.eventPhase=f.AT_TARGET;f.target&&!a.composedPath().includes(f.target);)f.currentTarget=f.target,t.notifyTarget(f),o&&t.notifyTarget(f,"mouseleave"),ae.isNode(f.target)&&(f.target=f.target.parentNode);t.freeEvent(f)}t.freeEvent(c)}if(u!==a.target){var h=r.type==="mousemove"?"mouseover":"pointerover",d=t.clonePointerEvent(a,h);t.dispatchEvent(d,"pointerover"),o&&t.dispatchEvent(d,"mouseover");for(var v=u&&ae.isNode(u)&&u.parentNode;v&&v!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode)&&v!==a.target;)v=v.parentNode;var g=!v||v===(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);if(g){var p=t.clonePointerEvent(a,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==u&&p.target!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);)p.currentTarget=p.target,t.notifyTarget(p),o&&t.notifyTarget(p,"mouseenter"),ae.isNode(p.target)&&(p.target=p.target.parentNode);t.freeEvent(p)}t.freeEvent(d)}t.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&t.dispatchEvent(a,"touchmove"),o&&(t.dispatchEvent(a,"mousemove"),t.cursor=t.getCursor(a.target)),s.overTargets=a.composedPath(),t.freeEvent(a)},this.onPointerOut=function(r){var a=t.trackingData(r.pointerId);if(a.overTargets){var o=r.pointerType==="mouse"||r.pointerType==="pen",s=t.findMountedTarget(a.overTargets),u=t.createPointerEvent(r,"pointerout",s||void 0);t.dispatchEvent(u),o&&t.dispatchEvent(u,"mouseout");var l=t.createPointerEvent(r,"pointerleave",s||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);)l.currentTarget=l.target,t.notifyTarget(l),o&&t.notifyTarget(l,"mouseleave"),ae.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=null,t.freeEvent(u),t.freeEvent(l)}t.cursor=null},this.onPointerOver=function(r){var a=t.trackingData(r.pointerId),o=t.createPointerEvent(r),s=o.pointerType==="mouse"||o.pointerType==="pen";t.dispatchEvent(o,"pointerover"),s&&t.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(t.cursor=t.getCursor(o.target));var u=t.clonePointerEvent(o,"pointerenter");for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);)u.currentTarget=u.target,t.notifyTarget(u),s&&t.notifyTarget(u,"mouseenter"),ae.isNode(u.target)&&(u.target=u.target.parentNode);a.overTargets=o.composedPath(),t.freeEvent(o),t.freeEvent(u)},this.onPointerUpOutside=function(r){var a=t.trackingData(r.pointerId),o=t.findMountedTarget(a.pressTargetsByButton[r.button]),s=t.createPointerEvent(r);if(o){for(var u=o;u;)s.currentTarget=u,t.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&t.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),ae.isNode(u)&&(u=u.parentNode);delete a.pressTargetsByButton[r.button]}t.freeEvent(s)},this.onWheel=function(r){var a=t.createWheelEvent(r);t.dispatchEvent(a),t.freeEvent(a)},this.onClick=function(r){if(t.context.config.useNativeClickEvent){var a=t.createPointerEvent(r);t.dispatchEvent(a),t.freeEvent(a)}},this.onPointerCancel=function(r){var a=t.createPointerEvent(r,void 0,void 0,t.context.config.alwaysTriggerPointerEventOnCanvas?t.rootTarget:void 0);t.dispatchEvent(a),t.freeEvent(a)},this.globalRuntime=i,this.context=e}return(0,C.Z)(n,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,a=this.context.contextService.getDomElement();if(a&&e){var o=a.offsetWidth,s=a.offsetHeight;o&&s&&(t=e.width/o,r=e.height/s)}return{scaleX:t,scaleY:r,bbox:e}}},{key:"client2Viewport",value:function(e){var t=this.getScale(),r=t.scaleX,a=t.scaleY,o=t.bbox;return new pe((e.x-((o==null?void 0:o.left)||0))/r,(e.y-((o==null?void 0:o.top)||0))/a)}},{key:"viewport2Client",value:function(e){var t=this.getScale(),r=t.scaleX,a=t.scaleY,o=t.bbox;return new pe((e.x+((o==null?void 0:o.left)||0))*r,(e.y+((o==null?void 0:o.top)||0))*a)}},{key:"viewport2Canvas",value:function(e){var t=e.x,r=e.y,a=this.rootTarget.defaultView,o=a.getCamera(),s=this.context.config,u=s.width,l=s.height,c=o.getPerspectiveInverse(),f=o.getWorldTransform(),h=M.multiply(this.tmpMatrix,f,c),d=E.t8(this.tmpVec3,t/u*2-1,(1-r/l)*2-1,0);return E.fF(d,d,h),new pe(d[0],d[1])}},{key:"canvas2Viewport",value:function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),a=r.getPerspective(),o=r.getViewTransform(),s=M.multiply(this.tmpMatrix,a,o),u=E.t8(this.tmpVec3,e.x,e.y,0);E.fF(this.tmpVec3,this.tmpVec3,s);var l=this.context.config,c=l.width,f=l.height;return new pe((u[0]+1)/2*c,(1-(u[1]+1)/2)*f)}},{key:"setPickHandler",value:function(e){this.pickHandler=e}},{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,a){return r.priority-a.priority})}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,a=t.length;r<a;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}}},{key:"dispatchEvent",value:function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var a=this.rootTarget.defaultView||null;e.currentTarget=a,this.notifyListeners(e,t)}}},{key:"propagate",value:function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var a=r.length-1;a>=1;a--)if(e.currentTarget=r[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var o=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var s=o+1;s<r.length;s++)if(e.currentTarget=r[s],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var a=0;a<eu&&e!==this.rootTarget;a++)ae.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t}},{key:"hitTest",value:function(e){var t=e.viewportX,r=e.viewportY,a=this.context.config,o=a.width,s=a.height,u=a.disableHitTesting;return t<0||r<0||t>o||r>s?null:!u&&this.pickHandler(e)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(e,t){var r,a=t==null?void 0:t.target;if((r=a)!==null&&r!==void 0&&r.shadowRoot&&(a=t.composedPath()[0]),a){if(a===e)return!0;if(e&&e.contains)return e.contains(a)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var t=0,r=e.nativeEvent.composedPath();t<r.length;t++){var a=r[t],o=this.nativeHTMLMap.get(a);if(o)return o}return null}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})}},{key:"createPointerEvent",value:function(e,t,r,a){var o=this.allocateEvent(Gn);this.copyPointerData(e,o),this.copyMouseData(e,o),this.copyData(e,o),o.nativeEvent=e.nativeEvent,o.originalEvent=e;var s=this.getExistedHTML(o),u=this.context.contextService.getDomElement();return o.target=r!=null?r:s||this.isNativeEventFromCanvas(u,o.nativeEvent)&&this.pickTarget(o)||a,typeof t=="string"&&(o.type=t),o}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(Un);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),a=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(a,t.nativeEvent)&&this.pickTarget(t),t}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:"cloneWheelEvent",value:function(e){var t=this.allocateEvent(Un);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t}},{key:"clonePointerEvent",value:function(e,t){var r=this.allocateEvent(Gn);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r}},{key:"copyPointerData",value:function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist}},{key:"copyMouseData",value:function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=In.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}},{key:"notifyTarget",value:function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}},{key:"notifyListeners",value:function(e,t){var r=e.currentTarget.emitter,a=r._events[t];if(a)if("fn"in a)a.once&&r.removeListener(t,a.fn,void 0,!0),a.fn.call(e.currentTarget||a.context,e);else for(var o=0;o<a.length&&!e.propagationImmediatelyStopped;o++)a[o].once&&r.removeListener(t,a[o].fn,void 0,!0),a[o].fn.call(e.currentTarget||a[o].context,e)}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var a=e[r];if(a===this.rootTarget||ae.isNode(a)&&a.parentNode===t)t=e[r];else break}return t}},{key:"getCursor",value:function(e){for(var t=e;t;){var r=ps(t)&&t.getAttribute("cursor");if(r)return r;t=ae.isNode(t)&&t.parentNode}}}])}(),Bn=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"getOrCreateCanvas",value:function(e,t){if(this.canvas)return this.canvas;if(e||T.offscreenCanvas)this.canvas=e||T.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,B.Z)({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,B.Z)({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,B.Z)({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(e){}try{return document.createElement("canvas")}catch(e){}return null}}])}(),vt=function(n){return n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE",n}({}),nu=function(){function n(i,e){(0,S.Z)(this,n),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new xe,initAsync:new Ls,dirtycheck:new _n,cull:new _n,beginFrame:new xe,beforeRender:new xe,render:new xe,afterRender:new xe,endFrame:new xe,destroy:new xe,pick:new Ds,pickSync:new _n,pointerDown:new xe,pointerUp:new xe,pointerMove:new xe,pointerOut:new xe,pointerOver:new xe,pointerWheel:new xe,pointerCancel:new xe,click:new xe},this.globalRuntime=i,this.context=e}return(0,C.Z)(n,[{key:"init",value:function(e){var t=this,r=(0,B.Z)((0,B.Z)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()}).catch(function(a){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var e=this.context.config.renderer,t=e.getConfig(),r=t.enableDirtyRectangleRendering;return!r||this.context.renderingContext.renderReasons.has(vt.CAMERA_CHANGED)}},{key:"render",value:function(e,t,r){var a=this,o=e.getConfig(),s=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(e),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var u=s.renderReasons.size===1&&s.renderReasons.has(vt.CAMERA_CHANGED),l=!o.disableRenderHooks||!u;l&&this.renderDisplayObject(s.root,o,s),this.hooks.beginFrame.call(t),l&&s.renderListCurrentFrame.forEach(function(c){a.hooks.beforeRender.call(c),a.hooks.render.call(c),a.hooks.afterRender.call(c)}),this.hooks.endFrame.call(t),s.renderListCurrentFrame=[],s.renderReasons.clear(),r()}}},{key:"renderDisplayObject",value:function(e,t,r){var a=this,o=t.renderer.getConfig(),s=o.enableDirtyCheck,u=o.enableCulling;function l(g){var p=g.renderable,y=g.sortable,m=s?p.dirty||r.dirtyRectangleRenderingDisabled?g:null:g,k=null;m&&(k=u?a.hooks.cull.call(m,a.context.camera):m,k&&(a.stats.rendered+=1,r.renderListCurrentFrame.push(k))),g.dirty(!1),y.renderOrder=a.zIndexCounter,a.zIndexCounter+=1,a.stats.total+=1,y.dirty&&(a.sort(g,y),y.dirty=!1,y.dirtyChildren=[],y.dirtyReason=void 0)}for(var c=[e];c.length>0;){var f,h=c.pop();l(h);for(var d=((f=h.sortable)===null||f===void 0||(f=f.sorted)===null||f===void 0?void 0:f.length)>0?h.sortable.sorted:h.childNodes,v=d.length-1;v>=0;v--)c.push(d[v])}}},{key:"sort",value:function(e,t){var r,a;(t==null||(r=t.sorted)===null||r===void 0?void 0:r.length)>0&&t.dirtyReason!==Zt.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(o){var s=t.sorted.indexOf(o);s>-1&&t.sorted.splice(s,1);var u=e.childNodes.indexOf(o);if(u>-1)if(t.sorted.length===0)t.sorted.push(o);else{var l=ms(t.sorted,o);t.sorted.splice(l,0,o)}}):t.sorted=e.childNodes.slice().sort(li),((a=t.sorted)===null||a===void 0?void 0:a.length)>0&&e.childNodes.filter(function(o){return o.parsedStyle.zIndex}).length===0&&(t.sorted=[])}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call()}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(vt.DISPLAY_OBJECT_CHANGED)}}])}(),ru=/\[\s*(.*)=(.*)\s*\]/,iu=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"selectOne",value:function(e,t){var r=this;if(e.startsWith("."))return t.find(function(u){return((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(u){return u.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),o=a.name,s=a.value;return o?t.find(function(u){return t!==u&&(o==="name"?u.name===s:r.attributeToString(u,o)===s)}):null}return t.find(function(u){return t!==u&&u.nodeName===e})}},{key:"selectAll",value:function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(u){return t!==u&&((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(u){return t!==u&&u.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),o=a.name,s=a.value;return o?t.findAll(function(u){return t!==u&&(o==="name"?u.name===s:r.attributeToString(u,o)===s)}):[]}return t.findAll(function(u){return t!==u&&u.nodeName===e})}},{key:"is",value:function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),a=r.name,o=r.value;return a==="name"?t.name===o:this.attributeToString(t,a)===o}return t.nodeName===e}},{key:"getIdOrClassname",value:function(e){return e.substring(1)}},{key:"getAttribute",value:function(e){var t=e.match(ru),r="",a="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),a=t[2].replace(/"/g,"")),{name:r,value:a}}},{key:"attributeToString",value:function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return(0,ge.Z)(r)?"":r.toString?r.toString():""}}])}(),X=function(n){return n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.MOUNTED="DOMNodeInsertedIntoDocument",n.REMOVED="removed",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.REPARENT="reparent",n.DESTROY="destroy",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled",n}({}),Ue=function(n){function i(e,t,r,a,o,s,u,l){var c;return(0,S.Z)(this,i),c=(0,Y.Z)(this,i,[null]),c.relatedNode=t,c.prevValue=r,c.newValue=a,c.attrName=o,c.attrChange=s,c.prevParsedValue=u,c.newParsedValue=l,c.type=e,c}return(0,$.Z)(i,n),(0,C.Z)(i)}(Jt);Ue.ADDITION=2,Ue.MODIFICATION=1,Ue.REMOVAL=3;var au=new Ue(X.REPARENT,null,"","","",0,"",""),ou=Ot.Ue(),Qt=E.Ue(),su=E.al(1,1,1),uu=M.create(),lu=Ot.Ue(),qe=E.Ue(),cu=M.create(),je=W.Ue(),fu=E.Ue(),hu=W.Ue(),vu=E.Ue(),wt=E.Ue(),et=E.Ue(),qt=M.create(),Pi=W.Ue(),Si=W.Ue(),jt=W.Ue(),du=function(){function n(i){(0,S.Z)(this,n),this.displayObjectDependencyMap=new WeakMap,this.runtime=i}return(0,C.Z)(n,[{key:"matches",value:function(e,t){return this.runtime.sceneGraphSelector.is(e,t)}},{key:"querySelector",value:function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)}},{key:"querySelectorAll",value:function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)}},{key:"attach",value:function(e,t,r){var a,o=!1;e.parentNode&&(o=e.parentNode!==t,this.detach(e));var s=e.nodeName===R.FRAGMENT,u=Kt(t);e.parentNode=t;var l=s?e.childNodes:[e];(0,We.Z)(r)?l.forEach(function(g){t.childNodes.splice(r,0,g),g.parentNode=t}):l.forEach(function(g){t.childNodes.push(g),g.parentNode=t});var c=t,f=c.sortable;if((f!=null&&(a=f.sorted)!==null&&a!==void 0&&a.length||f.dirty||e.parsedStyle.zIndex)&&(f.dirtyChildren.indexOf(e)===-1&&f.dirtyChildren.push(e),f.dirty=!0,f.dirtyReason=Zt.ADDED),!u){if(s)this.dirtyFragment(e);else{var h=e.transformable;h&&this.dirtyWorldTransform(e,h)}if(o){var d,v=((d=t.ownerDocument)===null||d===void 0||(d=d.defaultView)===null||d===void 0||(d=d.getConfig())===null||d===void 0||(d=d.future)===null||d===void 0?void 0:d.experimentalCancelEventPropagation)===!0;e.dispatchEvent(au,v,v)}}}},{key:"detach",value:function(e){var t,r;if(e.parentNode){var a=e.transformable,o=e.parentNode,s=o.sortable;(s!=null&&(t=s.sorted)!==null&&t!==void 0&&t.length||(r=e.style)!==null&&r!==void 0&&r.zIndex)&&(s.dirtyChildren.indexOf(e)===-1&&s.dirtyChildren.push(e),s.dirty=!0,s.dirtyReason=Zt.REMOVED);var u=e.parentNode.childNodes.indexOf(e);u>-1&&e.parentNode.childNodes.splice(u,1),a&&this.dirtyWorldTransform(e,a),e.parentNode=null}}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation}},{key:"getLocalScale",value:function(e){return e.transformable.localScale}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew}},{key:"getLocalTransform",value:function(e){var t=e.transformable;return Sr(t),t.localTransform}},{key:"setLocalPosition",value:function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=e.transformable;wt[0]=t[0],wt[1]=t[1],wt[2]=(r=t[2])!==null&&r!==void 0?r:0,!E.fS(o.localPosition,wt)&&(E.JG(o.localPosition,wt),a&&this.dirtyLocalTransform(e,o))}},{key:"translateLocal",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=E.al(t,r,a));var o=e.transformable;E.fS(t,Qt)||(E.VC(t,t,o.localRotation),E.IH(o.localPosition,o.localPosition,t),this.dirtyLocalTransform(e,o))}},{key:"setLocalRotation",value:function(e,t,r,a,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof t=="number"&&(t=W.t8(je,t,r,a,o));var u=e.transformable;W.JG(u.localRotation,t),s&&this.dirtyLocalTransform(e,u)}},{key:"rotateLocal",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=E.al(t,r,a));var o=e.transformable;W.Su(Si,t[0],t[1],t[2]),W.dC(o.localRotation,o.localRotation,Si),this.dirtyLocalTransform(e,o)}},{key:"setLocalScale",value:function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=e.transformable;E.t8(qe,t[0],t[1],(r=t[2])!==null&&r!==void 0?r:o.localScale[2]),!E.fS(qe,o.localScale)&&(E.JG(o.localScale,qe),a&&this.dirtyLocalTransform(e,o))}},{key:"scaleLocal",value:function(e,t){var r,a=e.transformable;E.Jp(a.localScale,a.localScale,E.t8(qe,t[0],t[1],(r=t[2])!==null&&r!==void 0?r:1)),this.dirtyLocalTransform(e,a)}},{key:"setLocalSkew",value:function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof t=="number"&&(t=Ot.t8(lu,t,r));var o=e.transformable;Ot.JG(o.localSkew,t),a&&this.dirtyLocalTransform(e,o)}},{key:"setLocalEulerAngles",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof t=="number"&&(t=E.al(t,r,a));var s=e.transformable;W.Su(s.localRotation,t[0],t[1],t[2]),o&&this.dirtyLocalTransform(e,s)}},{key:"setLocalTransform",value:function(e,t){var r=M.getTranslation(fu,t),a=M.getRotation(hu,t),o=M.getScaling(vu,t);this.setLocalScale(e,o,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,a,void 0,void 0,void 0,!1),this.dirtyLocalTransform(e,e.transformable)}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,su,!1),this.setLocalPosition(e,Qt,!1),this.setLocalEulerAngles(e,Qt,void 0,void 0,!1),this.setLocalSkew(e,ou,void 0,!1),this.dirtyLocalTransform(e,e.transformable)}},{key:"getPosition",value:function(e){var t=e.transformable;return M.getTranslation(t.position,this.getWorldTransform(e,t))}},{key:"getRotation",value:function(e){var t=e.transformable;return M.getRotation(t.rotation,this.getWorldTransform(e,t))}},{key:"getScale",value:function(e){var t=e.transformable;return M.getScaling(t.scaling,this.getWorldTransform(e,t))}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin}},{key:"getWorldTransform",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.transformable;return!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.internalUpdateTransform(e)),t.worldTransform}},{key:"setPosition",value:function(e,t){var r,a=e.transformable;if(et[0]=t[0],et[1]=t[1],et[2]=(r=t[2])!==null&&r!==void 0?r:0,!E.fS(this.getPosition(e),et)){if(E.JG(a.position,et),e.parentNode===null||!e.parentNode.transformable)E.JG(a.localPosition,et);else{var o=e.parentNode.transformable;M.copy(qt,o.worldTransform),M.invert(qt,qt),E.fF(a.localPosition,et,qt)}this.dirtyLocalTransform(e,a)}}},{key:"translate",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=E.t8(qe,t,r,a)),!E.fS(t,Qt)&&(E.IH(qe,this.getPosition(e),t),this.setPosition(e,qe))}},{key:"setRotation",value:function(e,t,r,a,o){var s=e.transformable;if(typeof t=="number"&&(t=W.al(t,r,a,o)),e.parentNode===null||!e.parentNode.transformable)this.setLocalRotation(e,t);else{var u=this.getRotation(e.parentNode);W.JG(je,u),W.U_(je,je),W.Jp(s.localRotation,je,t),W.Fv(s.localRotation,s.localRotation),this.dirtyLocalTransform(e,s)}}},{key:"rotate",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=E.al(t,r,a));var o=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.rotateLocal(e,t);else{var s=je;W.Su(s,t[0],t[1],t[2]);var u=this.getRotation(e),l=this.getRotation(e.parentNode);W.JG(jt,l),W.U_(jt,jt),W.Jp(s,jt,s),W.Jp(o.localRotation,s,u),W.Fv(o.localRotation,o.localRotation),this.dirtyLocalTransform(e,o)}}},{key:"setOrigin",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=[t,r,a]);var o=e.transformable;if(!(t[0]===o.origin[0]&&t[1]===o.origin[1]&&t[2]===o.origin[2])){var s=o.origin;s[0]=t[0],s[1]=t[1],s[2]=t[2]||0,this.dirtyLocalTransform(e,o)}}},{key:"setEulerAngles",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=E.al(t,r,a));var o=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.setLocalEulerAngles(e,t);else{W.Su(o.localRotation,t[0],t[1],t[2]);var s=this.getRotation(e.parentNode);W.JG(Pi,W.U_(je,s)),W.dC(o.localRotation,o.localRotation,Pi),this.dirtyLocalTransform(e,o)}}},{key:"getGeometryBounds",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e,a=r.geometry;a.dirty&&T.styleValueRegistry.updateGeometry(e);var o=t?a.renderBounds:a.contentBounds||null;return o||new me}},{key:"getTransformedGeometryBounds",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2?arguments[2]:void 0,a=this.getGeometryBounds(e,t);if(!me.isEmpty(a)){var o=r||new me;return o.setFromTransformedAABB(a,this.getWorldTransform(e)),o}return null}},{key:"getBounds",value:function(e){var t=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e,o=a.renderable;if(!o.boundsDirty&&!r&&o.bounds)return o.bounds;if(!o.renderBoundsDirty&&r&&o.renderBounds)return o.renderBounds;var s=r?o.renderBounds:o.bounds,u=this.getTransformedGeometryBounds(e,r,s),l=e.childNodes;if(l.forEach(function(h){var d=t.getBounds(h,r);d&&(u?u.add(d):(u=s||new me,u.update(d.center,d.halfExtents)))}),u||(u=new me),r){var c=ci(e);if(c){var f=c.parsedStyle.clipPath.getBounds(r);u?f&&(u=f.intersection(u)):u.update(f.center,f.halfExtents)}}return r?(o.renderBounds=u,o.renderBoundsDirty=!1):(o.bounds=u,o.boundsDirty=!1),u}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var t=uu;e.parentNode.transformable&&(t=M.invert(cu,this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!me.isEmpty(r)){var a=new me;return a.setFromTransformedAABB(r,t),a}}return this.getBounds(e)}},{key:"getBoundingClientRect",value:function(e){var t,r,a=this.getGeometryBounds(e);me.isEmpty(a)||(r=new me,r.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(t=e.ownerDocument)===null||t===void 0||(t=t.defaultView)===null||t===void 0?void 0:t.getContextService().getBoundingClientRect();if(r){var s=r.getMin(),u=(0,oe.Z)(s,2),l=u[0],c=u[1],f=r.getMax(),h=(0,oe.Z)(f,2),d=h[0],v=h[1];return new st(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),d-l,v-c)}return new st((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(e){var t,r=(t=e.parentNode)===null||t===void 0?void 0:t.transformable;Sr(e.transformable),Na(e.transformable,r)}},{key:"internalUpdateElement",value:function(e,t){var r,a,o,s,u=((r=e.ownerDocument)===null||r===void 0||(r=r.defaultView)===null||r===void 0||(r=r.getConfig())===null||r===void 0||(r=r.future)===null||r===void 0?void 0:r.experimentalAttributeUpdateOptimization)===!0,l=t[t.length-1],c=(l==null?void 0:l.transformDirty)||((a=e.transformable)===null||a===void 0?void 0:a.localDirtyFlag);if(e.transformable){var f;(f=e.transformable).dirtyFlag||(f.dirtyFlag=c)}if(this.internalUpdateTransform(e),c){var h;(h=e.dirty)===null||h===void 0||h.call(e,!0,!0)}var d=((o=e.renderable)===null||o===void 0?void 0:o.boundsDirty)||((s=e.renderable)===null||s===void 0?void 0:s.renderBoundsDirty);if((c||d)&&(l==null?void 0:l.shapeUpdated)===!1&&u)for(var v=t.length-1;v>=0;){var g,p,y=t[v];if(y.shapeUpdated)break;(g=(p=y.node).dirty)===null||g===void 0||g.call(p,!0,!0),y.shapeUpdated=!0,v-=1}return c}},{key:"syncHierarchy",value:function(e){for(var t,r,a=[e],o=e.parentNode?[{node:e.parentNode,transformDirty:((t=e.parentNode.transformable)===null||t===void 0?void 0:t.localDirtyFlag)||((r=e.parentNode.transformable)===null||r===void 0?void 0:r.dirtyFlag),shapeUpdated:!1}]:[];a.length>0;){for(var s=a.pop(),u=o[o.length-1];o.length>0&&s.parentNode!==u.node;)u=o.pop();var l=this.internalUpdateElement(s,o);if(s.childNodes.length>0){for(var c=s.childNodes.length-1;c>=0;c--)a.push(s.childNodes[c]);o.push({node:s,transformDirty:l,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(e,t){Kt(e)||t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtyWorldTransform(e,t))}},{key:"dirtyWorldTransform",value:function(e,t){this.dirtyWorldInternal(e,t),this.dirtyToRoot(e,!0)}},{key:"dirtyWorldInternal",value:function(e,t){var r,a=this,o=((r=e.ownerDocument)===null||r===void 0||(r=r.defaultView)===null||r===void 0||(r=r.getConfig())===null||r===void 0||(r=r.future)===null||r===void 0?void 0:r.experimentalAttributeUpdateOptimization)===!0;t.dirtyFlag||(t.dirtyFlag=!0,e.dirty(!0,!0),o||e.childNodes.forEach(function(s){var u=s.transformable;a.dirtyWorldInternal(s,u)}))}},{key:"dirtyToRoot",value:function(e){for(var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e,o=((t=e.ownerDocument)===null||t===void 0||(t=t.defaultView)===null||t===void 0||(t=t.getConfig())===null||t===void 0||(t=t.future)===null||t===void 0?void 0:t.experimentalAttributeUpdateOptimization)===!0;a;){var s,u;if((s=(u=a).dirty)===null||s===void 0||s.call(u,!0,!0),o)break;a=a.parentNode}r&&e.forEach(function(f){var h;(h=f.dirty)===null||h===void 0||h.call(f,!0,!0)}),this.informDependentDisplayObjects(e);var l=e.mutations||[],c=l.find(function(f){return f.type==="attributes"&&f._boundsChangeData});c?c._boundsChangeData={affectChildren:c._boundsChangeData.affectChildren||r}:(c={type:"attributes",target:e,_boundsChangeData:{affectChildren:r}},l.push(c)),e.mutations=l}},{key:"dirtyFragment",value:function(e){var t,r,a=e.transformable;a&&(a.dirtyFlag=!0,a.localDirtyFlag=!0),(t=(r=e).dirty)===null||t===void 0||t.call(r,!0,!0);for(var o=e.childNodes.length,s=0;s<o;s++)this.dirtyFragment(e.childNodes[s])}},{key:"notifyMutationObservers",value:function(e){var t=new Set;if(e.getRoot().forEach(function(a){(a.mutations||[]).forEach(function(o){o.type==="attributes"&&o._boundsChangeData&&(o._boundsChangeData.affectChildren?a.forEach(function(s){var u=(0,B.Z)({},o);u.target=s,t.add(u)}):t.add(o))}),a.mutations=void 0}),t.size>0){var r=new ye(X.BOUNDS_CHANGED,{detail:Array.from(t)});e.dispatchEvent(r,!0,!0)}}},{key:"updateDisplayObjectDependency",value:function(e,t,r,a){if(t&&t!==r){var o=this.displayObjectDependencyMap.get(t);if(o&&o[e]){var s=o[e].indexOf(a);o[e].splice(s,1)}}if(r){var u=this.displayObjectDependencyMap.get(r);u||(this.displayObjectDependencyMap.set(r,{}),u=this.displayObjectDependencyMap.get(r)),u[e]||(u[e]=[]),u[e].push(a)}}},{key:"informDependentDisplayObjects",value:function(e){var t,r=this,a=this.displayObjectDependencyMap.get(e);if(a){var o=(t=e.ownerDocument)===null||t===void 0||(t=t.defaultView)===null||t===void 0||(t=t.getConfig())===null||t===void 0||(t=t.future)===null||t===void 0?void 0:t.experimentalCancelEventPropagation;Object.keys(a).forEach(function(s){a[s].forEach(function(u){r.dirtyToRoot(u,!0),u.dispatchEvent(new Ue(X.ATTR_MODIFIED,u,r,r,s,Ue.MODIFICATION,r,r),o,o),u.isCustomElement&&u.isConnected&&u.attributeChangedCallback&&u.attributeChangedCallback(s,r,r)})})}}}])}(),Ci=function(){function n(i){if((0,S.Z)(this,n),i<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=i,this.cache=new Map}return(0,C.Z)(n,[{key:"get",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}}},{key:"put",value:function(e,t){if(this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,t),this.cache.size>this.capacity){var r=this.cache.keys().next().value;this.cache.delete(r)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])}(),tt={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Mi=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,gu=/[!%),.:;?\]}'""]/,pu=/[$('"]/,mu=/[!),.:;?\]}'""]/,yu=/[([{'"]/,Eu=/[)\]'"?!:;,.]/,ku=/[(['"...]/,xu=/[!%),.:;?\]}'"]/,Tu=/[$([{'"#]/,Pu=new RegExp("".concat(gu.source,"|").concat(mu.source,"|").concat(Eu.source,"|").concat(xu.source)),Su=new RegExp("".concat(pu.source,"|").concat(yu.source,"|").concat(ku.source,"|").concat(Tu.source)),Cu=function(){function n(i){var e=this;(0,S.Z)(this,n),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,r){return e.isBreakingSpace(r)?!1:!!(t&&(Su.exec(r)||Pu.exec(t)))},this.trimByKinsokuShorui=function(t){var r=(0,j.Z)(t),a=r[r.length-2];if(!a)return t;var o=a[a.length-1];return r[r.length-2]=a.slice(0,-1),r[r.length-1]=o+r[r.length-1],r},this.runtime=i,this.charWidthCache=new Ci(100)}return(0,C.Z)(n,[{key:"measureFont",value:function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),o=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});o.font=e;var s=tt.MetricsString+tt.BaselineSymbol,u=Math.ceil(o.measureText(s).width),l=Math.ceil(o.measureText(tt.BaselineSymbol).width),c=tt.HeightMultiplier*l;l=l*tt.BaselineMultiplier|0,a.width=u,a.height=c,o.fillStyle="#f00",o.fillRect(0,0,u,c),o.font=e,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText(s,0,l);var f=o.getImageData(0,0,u||1,c||1).data,h=f.length,d=u*4,v=0,g=0,p=!1;for(v=0;v<l;++v){for(var y=0;y<d;y+=4)if(f[g+y]!==255){p=!0;break}if(!p)g+=d;else break}for(r.ascent=l-v,g=h-d,p=!1,v=c;v>l;--v){for(var m=0;m<d;m+=4)if(f[g+m]!==255){p=!0;break}if(!p)g-=d;else break}return r.descent=v-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r}},{key:"measureText",value:function(e,t,r){var a=t.fontSize,o=a===void 0?16:a,s=t.wordWrap,u=s===void 0?!1:s,l=t.lineHeight,c=t.lineWidth,f=c===void 0?1:c,h=t.textBaseline,d=h===void 0?"alphabetic":h,v=t.textAlign,g=v===void 0?"start":v,p=t.letterSpacing,y=p===void 0?0:p,m=t.textPath;t.textPathSide,t.textPathStartOffset;var k=t.leading,x=k===void 0?0:k,L=yi(t),O=this.measureFont(L,r);O.fontSize===0&&(O.fontSize=o,O.ascent=o);var P=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);P.font=L,t.isOverflowing=!1;var w=u?this.wordWrap(e,t,r):e,F=w.split(/(?:\r\n|\r|\n)/),U=new Array(F.length),_=0;if(m){m.getTotalLength();for(var D=0;D<F.length;D++)P.measureText(F[D]).width+(F[D].length-1)*y}else{for(var H=0;H<F.length;H++){var K=P.measureText(F[H]).width+(F[H].length-1)*y;U[H]=K,_=Math.max(_,K)}var te=_+f,he=l||O.fontSize+f,b=Math.max(he,O.fontSize+f)+(F.length-1)*(he+x);he+=x;var G=0;return d==="middle"?G=-b/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?G=-b:(d==="top"||d==="hanging")&&(G=0),{font:L,width:te,height:b,lines:F,lineWidths:U,lineHeight:he,maxLineWidth:_,fontProperties:O,lineMetrics:U.map(function(z,ve){var de=0;return g==="center"||g==="middle"?de-=z/2:(g==="right"||g==="end")&&(de-=z),new st(de-f/2,G+ve*he,z+f,he)})}}}},{key:"wordWrap",value:function(e,t,r){var a=this,o=Array.from(e);if(o.length===0)return"";var s=this,u=t.wordWrapWidth,l=u===void 0?0:u,c=t.letterSpacing,f=c===void 0?0:c,h=t.maxLines,d=h===void 0?1/0:h,v=t.textOverflow,g=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),p=l+f,y="";v==="ellipsis"?y="...":v&&v!=="clip"&&(y=v);var m=[""],k=0,x=0,L=-1,O=yi(t),P=this.charWidthCache.get(O);P||(P=new Ci(500),this.charWidthCache.put(O,P));var w=function(z){return a.getFromCache(z,f,P,g)},F=w(y);function U(G,z,ve,de){for(;w(G)<de&&z<o.length-1&&!s.isNewline(o[z+1]);)z+=1,G+=o[z];for(;w(G)>de&&z>=ve;)z-=1,G=G.slice(0,-1);return{lineTxt:G,txtLastCharIndex:z}}function _(G,z){if(!(F<=0||F>p)){if(!m[G]){m[G]=y;return}var ve=U(m[G],z,L+1,p-F);m[G]=ve.lineTxt+y}}for(var D=0;D<o.length;D++){var H=o[D],K=o[D-1],te=o[D+1],he=w(H);if(this.isNewline(H)){if(k+1>=d){D<o.length-1&&_(k,D-1),t.isOverflowing=!0;break}L=D-1,k+=1,x=0,m[k]="";continue}if(he>p){_(k,D-1),t.isOverflowing=!0;break}if(x>0&&x+he>p){var b=U(m[k],D-1,L+1,p);if(b.txtLastCharIndex!==D-1){if(m[k]=b.lineTxt,b.txtLastCharIndex===o.length-1)break;D=b.txtLastCharIndex+1,H=o[D],K=o[D-1],te=o[D+1],he=w(H)}if(k+1>=d){_(k,D-1),t.isOverflowing=!0;break}if(L=D-1,k+=1,x=0,m[k]="",this.isBreakingSpace(H))continue;this.canBreakInLastChar(H)||(m=this.trimToBreakable(m),x=this.sumTextWidthByCache(m[k]||"",w)),this.shouldBreakByKinsokuShorui(H,te)&&(m=this.trimByKinsokuShorui(m),x+=w(K||""))}x+=he,m[k]+=H}return m.join(`
`)}},{key:"isBreakingSpace",value:function(e){return typeof e!="string"?!1:tt.BreakingSpaces.indexOf(e.charCodeAt(0))>=0}},{key:"isNewline",value:function(e){return typeof e!="string"?!1:tt.Newlines.indexOf(e.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(e){var t=(0,j.Z)(e),r=t[t.length-2],a=this.findBreakableIndex(r);if(a===-1||!r)return t;var o=r.slice(a,a+1),s=this.isBreakingSpace(o),u=a+1,l=a+(s?0:1);return t[t.length-1]+=r.slice(u,r.length),t[t.length-2]=r.slice(0,l),t}},{key:"canBreakInLastChar",value:function(e){return!(e&&Mi.test(e))}},{key:"sumTextWidthByCache",value:function(e,t){return e.split("").reduce(function(r,a){return r+t(a)},0)}},{key:"findBreakableIndex",value:function(e){for(var t=e.length-1;t>=0;t--)if(!Mi.test(e[t]))return t;return-1}},{key:"getFromCache",value:function(e,t,r,a){var o=r.get(e);if(typeof o!="number"){var s=e.length*t,u=a.measureText(e);o=u.width+s,r.put(e,o)}return o}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),T={},Mu=function(n){var i=new Js,e=new Ks;return n={},(0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)(n,R.FRAGMENT,null),R.CIRCLE,new Hs),R.ELLIPSE,new Ys),R.RECT,i),R.IMAGE,i),R.GROUP,new qs),R.LINE,new $s),R.TEXT,new Qs(T)),R.POLYLINE,e),R.POLYGON,e),(0,V.Z)((0,V.Z)((0,V.Z)(n,R.PATH,new Xs),R.HTML,new js),R.MESH,null)}(),wu=function(n){var i=new ns,e=new On;return n={},(0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)(n,N.PERCENTAGE,null),N.NUMBER,new ss),N.ANGLE,new es),N.DEFINED_PATH,new ts),N.PAINT,i),N.COLOR,i),N.FILTER,new rs),N.LENGTH,e),N.LENGTH_PERCENTAGE,e),N.LENGTH_PERCENTAGE_12,new is),(0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)((0,V.Z)(n,N.LENGTH_PERCENTAGE_14,new as),N.COORDINATE,new On),N.OFFSET_DISTANCE,new us),N.OPACITY_VALUE,new ls),N.PATH,new cs),N.LIST_OF_POINTS,new fs),N.SHADOW_BLUR,new hs),N.TEXT,new vs),N.TEXT_TRANSFORM,new ds),N.TRANSFORM,new zs),(0,V.Z)((0,V.Z)((0,V.Z)(n,N.TRANSFORM_ORIGIN,new Ws),N.Z_INDEX,new Vs),N.MARKER,new os)}(),Nu=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof I.g!="undefined"?I.g:{}};T.CameraContribution=Pr,T.AnimationTimeline=null,T.EasingFunction=null,T.offscreenCanvasCreator=new Bn,T.sceneGraphSelector=new iu,T.sceneGraphService=new du(T),T.textService=new Cu(T),T.geometryUpdaterFactory=Mu,T.CSSPropertySyntaxFactory=wu,T.styleValueRegistry=new qo(T),T.layoutRegistry=null,T.globalThis=Nu(),T.enableStyleSyntax=!0,T.enableSizeAttenuation=!1;var wi=0;function Tl(){wi=0}var zn=new Ue(X.INSERTED,null,"","","",0,"",""),Wn=new Ue(X.REMOVED,null,"","","",0,"",""),Ni=new ye(X.DESTROY),Au=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.entity=wi++,e.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.cullable={strategy:Ca.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"dirty",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,r!==void 0&&(this.renderable.boundsDirty=r,this.renderable.renderBoundsDirty=r,this.geometry.dirty=r)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return t!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(ne)}},{key:"appendChild",value:function(t,r){var a;if(t.destroyed)throw new Error(va);return T.sceneGraphService.attach(t,this,r),(a=this.ownerDocument)!==null&&a!==void 0&&a.defaultView&&(!Kt(this)&&t.nodeName===R.FRAGMENT?this.ownerDocument.defaultView.mountFragment(t):this.ownerDocument.defaultView.mountChildren(t)),this.isMutationObserved&&(zn.relatedNode=this,t.dispatchEvent(zn)),t}},{key:"insertBefore",value:function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var a=this.childNodes.indexOf(r);a===-1?this.appendChild(t):this.appendChild(t,a)}return t}},{key:"replaceChild",value:function(t,r){var a=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,a),r}},{key:"removeChild",value:function(t){var r,a,o=((r=this.ownerDocument)===null||r===void 0||(r=r.defaultView)===null||r===void 0||(r=r.getConfig().future)===null||r===void 0?void 0:r.experimentalCancelEventPropagation)===!0;return Wn.relatedNode=this,t.dispatchEvent(Wn,o,o),(a=t.ownerDocument)!==null&&a!==void 0&&a.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),T.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length>0&&r.destroyChildren(),r.destroy()}}},{key:"matches",value:function(t){return T.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return T.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return T.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return T.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return T.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return T.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return T.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var r=this;do{if(T.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null}},{key:"find",value:function(t){var r=this,a=null;return this.forEach(function(o){return o!==r&&t(o)?(a=o,!1):!0}),a}},{key:"findAll",value:function(t){var r=this,a=[];return this.forEach(function(o){o!==r&&t(o)&&a.push(o)}),a}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var r=this.parentNode.childNodes.indexOf(this),a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];o.forEach(function(u,l){var c;return(c=t.parentNode)===null||c===void 0?void 0:c.appendChild(u,r+l+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var t,r=this.parentNode.childNodes.indexOf(this),a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var u=o[0],l=(0,sa.Z)(o).slice(1);this.parentNode.appendChild(u,r),(t=u).after.apply(t,(0,j.Z)(l))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];a.forEach(function(s){return t.appendChild(s)})}},{key:"prepend",value:function(){for(var t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];a.forEach(function(s,u){return t.appendChild(s,u)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var t,r=((t=this.ownerDocument)===null||t===void 0||(t=t.defaultView)===null||t===void 0||(t=t.getConfig().future)===null||t===void 0?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(Ni,r,r),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return T.sceneGraphService.getGeometryBounds(this,t)}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return T.sceneGraphService.getTransformedGeometryBounds(this,t)}},{key:"getBounds",value:function(){return T.sceneGraphService.getBounds(this)}},{key:"getRenderBounds",value:function(){return T.sceneGraphService.getBounds(this,!0)}},{key:"getLocalBounds",value:function(){return T.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return T.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if(typeof t!="symbol"){var r=this.attributes[t];return r}}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,r){this.attributes[t]=r}},{key:"getAttributeNS",value:function(t,r){throw new Error(ne)}},{key:"getAttributeNode",value:function(t){throw new Error(ne)}},{key:"getAttributeNodeNS",value:function(t,r){throw new Error(ne)}},{key:"hasAttributeNS",value:function(t,r){throw new Error(ne)}},{key:"removeAttributeNS",value:function(t,r){throw new Error(ne)}},{key:"removeAttributeNode",value:function(t){throw new Error(ne)}},{key:"setAttributeNS",value:function(t,r,a){throw new Error(ne)}},{key:"setAttributeNode",value:function(t){throw new Error(ne)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(ne)}},{key:"toggleAttribute",value:function(t,r){throw new Error(ne)}}])}(ae);function q(n){return!!(n!=null&&n.nodeName)}var Ru=T.globalThis.Proxy?T.globalThis.Proxy:function(){},Be=new Ue(X.ATTR_MODIFIED,null,null,null,null,Ue.MODIFICATION,null,null),Nt=E.Ue(),bu=W.Ue(),ee=function(n){function i(e){var t;return(0,S.Z)(this,i),t=(0,Y.Z)(this,i),t.isCustomElement=!1,t.isMutationObserved=!1,t.activeAnimations=[],t.config=e,t.id=e.id||"",t.name=e.name||"",(e.className||e.class)&&(t.className=e.className||e.class),t.nodeName=e.type||R.GROUP,e.initialParsedStyle&&Object.assign(t.parsedStyle,e.initialParsedStyle),t.initAttributes(e.style),T.enableStyleSyntax&&(t.style=new Ru({setProperty:function(a,o){t.setAttribute(a,o)},getPropertyValue:function(a){return t.getAttribute(a)},removeProperty:function(a){t.removeAttribute(a)},item:function(){return""}},{get:function(a,o){return a[o]!==void 0?a[o]:t.getAttribute(o)},set:function(a,o,s){return t.setAttribute(o,s),!0}})),t}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"destroy",value:function(){(0,mr.Z)(i,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel()})}},{key:"cloneNode",value:function(t,r){var a=(0,B.Z)({},this.attributes);for(var o in a){var s=a[o];q(s)&&o!=="clipPath"&&o!=="offsetPath"&&o!=="textPath"&&(a[o]=s.cloneNode(t)),r&&(a[o]=r(o,s))}var u=new this.constructor((0,B.Z)((0,B.Z)({},this.config),{},{style:a}));return u.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);u.appendChild(c)}}),u}},{key:"initAttributes",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r={forceUpdateGeometry:!0};T.styleValueRegistry.processProperties(this,t,r),this.dirty()}},{key:"setAttribute",value:function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;(0,ie.Z)(r)||(a||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:o}),(0,mr.Z)(i,"setAttribute",this,3)([t,r]))}},{key:"setAttributes",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.skipDispatchAttrModifiedEvent,o=a===void 0?!1:a,s,u;if(o||(s=(0,B.Z)({},this.attributes),u=(0,B.Z)({},this.parsedStyle)),T.styleValueRegistry.processProperties(this,t,r),this.dirty(),!o)for(var l in t)this.dispatchAttrModifiedEvent(l,s[l],t[l],u[l])}},{key:"internalSetAttribute",value:function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=this.attributes[t],s=this.parsedStyle[t];T.styleValueRegistry.processProperties(this,(0,V.Z)({},t,r),a),this.dirty(),this.dispatchAttrModifiedEvent(t,o,r,s)}},{key:"dispatchAttrModifiedEvent",value:function(t,r,a,o){var s=this.parsedStyle[t];if(this.isConnected)if(Be.relatedNode=this,Be.prevValue=r,Be.newValue=a,Be.attrName=t,Be.prevParsedValue=o,Be.newParsedValue=s,this.isMutationObserved)this.dispatchEvent(Be);else{var u,l=((u=this.ownerDocument.defaultView.getConfig().future)===null||u===void 0?void 0:u.experimentalCancelEventPropagation)===!0;Be.target=this,this.ownerDocument.defaultView.dispatchEvent(Be,!0,l)}if(this.isCustomElement&&this.isConnected||!this.isCustomElement){var c,f;(c=(f=this).attributeChangedCallback)===null||c===void 0||c.call(f,t,r,a,o,s)}}},{key:"getBBox",value:function(){var t=this.getBounds(),r=t.getMin(),a=(0,oe.Z)(r,2),o=a[0],s=a[1],u=t.getMax(),l=(0,oe.Z)(u,2),c=l[0],f=l[1];return new st(o,s,c-o,f-s)}},{key:"setOrigin",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return T.sceneGraphService.setOrigin(this,ke(t,r,a,!1)),this}},{key:"getOrigin",value:function(){return T.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return T.sceneGraphService.setPosition(this,ke(t,r,a,!1)),this}},{key:"setLocalPosition",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return T.sceneGraphService.setLocalPosition(this,ke(t,r,a,!1)),this}},{key:"translate",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return T.sceneGraphService.translate(this,ke(t,r,a,!1)),this}},{key:"translateLocal",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return T.sceneGraphService.translateLocal(this,ke(t,r,a,!1)),this}},{key:"getPosition",value:function(){return T.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return T.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,r,a){return this.scaleLocal(t,r,a)}},{key:"scaleLocal",value:function(t,r,a){return typeof t=="number"&&(r=r||t,a=a||t,t=ke(t,r,a,!1)),T.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,r,a){return typeof t=="number"&&(r=r||t,a=a||t,t=ke(t,r,a,!1)),T.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return T.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return T.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var t=vn(Nt,T.sceneGraphService.getWorldTransform(this)),r=(0,oe.Z)(t,3),a=r[2];return we(a)}},{key:"getLocalEulerAngles",value:function(){var t=vn(Nt,T.sceneGraphService.getLocalRotation(this)),r=(0,oe.Z)(t,3),a=r[2];return we(a)}},{key:"setEulerAngles",value:function(t){return T.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return T.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,r,a){return(0,ge.Z)(r)&&(0,ge.Z)(a)?T.sceneGraphService.rotateLocal(this,0,0,t):T.sceneGraphService.rotateLocal(this,t,r,a),this}},{key:"rotate",value:function(t,r,a){return(0,ge.Z)(r)&&(0,ge.Z)(a)?T.sceneGraphService.rotate(this,0,0,t):T.sceneGraphService.rotate(this,t,r,a),this}},{key:"setRotation",value:function(t,r,a,o){return T.sceneGraphService.setRotation(this,t,r,a,o),this}},{key:"setLocalRotation",value:function(t,r,a,o){return T.sceneGraphService.setLocalRotation(this,t,r,a,o),this}},{key:"setLocalSkew",value:function(t,r){return T.sceneGraphService.setLocalSkew(this,t,r),this}},{key:"getRotation",value:function(){return T.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return T.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return T.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return T.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return T.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return T.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){T.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,r){var a,o=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return o?o.play(this,t,r):null}},{key:"isVisible",value:function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,j.Z)(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,j.Z)(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var s=a[0],u=a[1];return s?(0,aa.Z)(s)?(Object.keys(s).forEach(function(l){t.setAttribute(l,s[l])}),this):a.length===2?(this.setAttribute(s,u),this):this.attributes[s]:this.attributes}},{key:"getMatrix",value:function(t){var r=t||this.getWorldTransform(),a=M.getTranslation(Nt,r),o=(0,oe.Z)(a,2),s=o[0],u=o[1],l=M.getScaling(Nt,r),c=(0,oe.Z)(l,2),f=c[0],h=c[1],d=M.getRotation(bu,r),v=vn(Nt,d),g=(0,oe.Z)(v,3),p=g[0],y=g[2];return ka(p||y,s,u,f,h)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var r=Er(t),a=(0,oe.Z)(r,5),o=a[0],s=a[1],u=a[2],l=a[3],c=a[4];this.setEulerAngles(c).setPosition(o,s).setLocalScale(u,l)}},{key:"setLocalMatrix",value:function(t){var r=Er(t),a=(0,oe.Z)(r,5),o=a[0],s=a[1],u=a[2],l=a[3],c=a[4];this.setLocalEulerAngles(c).setLocalPosition(o,s).setLocalScale(u,l)}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,r){return this.appendChild(t,r)}},{key:"set",value:function(t,r){this.config[t]=r}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(t,r,a),this}},{key:"move",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(t,r,a),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(Au);ee.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Vn=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.CIRCLE},e)])}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);Vn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var Ou=["style"],Ai=function(n){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.style,a=(0,Ye.Z)(t,Ou);return(0,S.Z)(this,i),e=(0,Y.Z)(this,i,[(0,B.Z)({style:r},a)]),e.isCustomElement=!0,e}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);Ai.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Hn=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.ELLIPSE},e)])}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);Hn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var Lu=function(n){function i(){return(0,S.Z)(this,i),(0,Y.Z)(this,i,[{type:R.FRAGMENT}])}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);Lu.PARSED_STYLE_LIST=new Set(["class","className"]);var At=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.GROUP},e)])}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);At.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Du=["style"],Yn=function(n){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.style,a=(0,Ye.Z)(t,Du);return(0,S.Z)(this,i),e=(0,Y.Z)(this,i,[(0,B.Z)({type:R.HTML,style:r},a)]),e.cullable.enable=!1,e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=M.invert(M.create(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!me.isEmpty(r)){var a=new me;return a.setFromTransformedAABB(r,t),a}}return this.getBounds()}}])}(ee);Yn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var $n=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.IMAGE},e)])}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);$n.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var Iu=["style"],Xn=function(n){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.style,a=(0,Ye.Z)(t,Iu);(0,S.Z)(this,i),e=(0,Y.Z)(this,i,[(0,B.Z)({type:R.LINE,style:(0,B.Z)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},a)]),e.markerStartAngle=0,e.markerEndAngle=0;var o=e.parsedStyle,s=o.markerStart,u=o.markerEnd;return s&&q(s)&&(e.markerStartAngle=s.getLocalEulerAngles(),e.appendChild(s)),u&&q(u)&&(e.markerEndAngle=u.getLocalEulerAngles(),e.appendChild(u)),e.transformMarker(!0),e.transformMarker(!1),e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"attributeChangedCallback",value:function(t,r,a,o,s){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(o&&q(o)&&(this.markerStartAngle=0,o.remove()),s&&q(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"&&(o&&q(o)&&(this.markerEndAngle=0,o.remove()),s&&q(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var r=this.parsedStyle,a=r.markerStart,o=r.markerEnd,s=r.markerStartOffset,u=r.markerEndOffset,l=r.x1,c=r.x2,f=r.y1,h=r.y2,d=t?a:o;if(!(!d||!q(d))){var v=0,g,p,y,m,k,x;t?(y=l,m=f,g=c-l,p=h-f,k=s||0,x=this.markerStartAngle):(y=c,m=h,g=l-c,p=f-h,k=u||0,x=this.markerEndAngle),v=Math.atan2(p,g),d.setLocalEulerAngles(v*180/Math.PI+x),d.setLocalPosition(y+Math.cos(v)*k,m+Math.sin(v)*k)}}},{key:"getPoint",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle,o=a.x1,s=a.y1,u=a.x2,l=a.y2,c=(0,He.U4)(o,s,u,l,t),f=c.x,h=c.y,d=E.fF(E.Ue(),E.al(f,h,0),r?this.getWorldTransform():this.getLocalTransform());return new pe(d[0],d[1])}},{key:"getPointAtLength",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(t/this.getTotalLength(),r)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,r=t.x1,a=t.y1,o=t.x2,s=t.y2;return(0,He.Xk)(r,a,o,s)}}])}(ee);Xn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var Zu=["style"],Kn=function(n){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.style,a=(0,Ye.Z)(t,Zu);(0,S.Z)(this,i),e=(0,Y.Z)(this,i,[(0,B.Z)({type:R.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,B.Z)({},Cr)}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var o=e.parsedStyle,s=o.markerStart,u=o.markerEnd,l=o.markerMid;return s&&q(s)&&(e.markerStartAngle=s.getLocalEulerAngles(),e.appendChild(s)),l&&q(l)&&e.placeMarkerMid(l),u&&q(u)&&(e.markerEndAngle=u.getLocalEulerAngles(),e.appendChild(u)),e.transformMarker(!0),e.transformMarker(!1),e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"attributeChangedCallback",value:function(t,r,a,o,s){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(o&&q(o)&&(this.markerStartAngle=0,o.remove()),s&&q(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"?(o&&q(o)&&(this.markerEndAngle=0,o.remove()),s&&q(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(s)}},{key:"transformMarker",value:function(t){var r=this.parsedStyle,a=r.markerStart,o=r.markerEnd,s=r.markerStartOffset,u=r.markerEndOffset,l=t?a:o;if(!(!l||!q(l))){var c=0,f,h,d,v,g,p;if(t){var y=this.getStartTangent(),m=(0,oe.Z)(y,2),k=m[0],x=m[1];d=x[0],v=x[1],f=k[0]-x[0],h=k[1]-x[1],g=s||0,p=this.markerStartAngle}else{var L=this.getEndTangent(),O=(0,oe.Z)(L,2),P=O[0],w=O[1];d=w[0],v=w[1],f=P[0]-w[0],h=P[1]-w[1],g=u||0,p=this.markerEndAngle}c=Math.atan2(h,f),l.setLocalEulerAngles(c*180/Math.PI+p),l.setLocalPosition(d+Math.cos(c)*g,v+Math.sin(c)*g)}}},{key:"placeMarkerMid",value:function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&q(t))for(var a=1;a<r.length-1;a++){var o=(0,oe.Z)(r[a].currentPoint,2),s=o[0],u=o[1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(s,u)}}},{key:"getTotalLength",value:function(){return Mn(this)}},{key:"getPointAtLength",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.d.absolutePath,o=(0,oa.r)(a,t),s=o.x,u=o.y,l=E.fF(E.Ue(),E.al(s,u,0),r?this.getWorldTransform():this.getLocalTransform());return new pe(l[0],l[1])}},{key:"getPoint",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(t*Mn(this),r)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var a=t[0].currentPoint,o=t[1].currentPoint,s=t[1].startTangent;r=[],s?(r.push([a[0]-s[0],a[1]-s[1]]),r.push([a[0],a[1]])):(r.push([o[0],o[1]]),r.push([a[0],a[1]]))}return r}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,r=t.length,a=[];if(r>1){var o=t[r-2].currentPoint,s=t[r-1].currentPoint,u=t[r-1].endTangent;a=[],u?(a.push([s[0]-u[0],s[1]-u[1]]),a.push([s[0],s[1]])):(a.push([o[0],o[1]]),a.push([s[0],s[1]]))}return a}}])}(ee);Kn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var _u=["style"],Rt=function(n){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.style,a=(0,Ye.Z)(t,_u);(0,S.Z)(this,i),e=(0,Y.Z)(this,i,[(0,B.Z)({type:R.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var o=e.parsedStyle,s=o.markerStart,u=o.markerEnd,l=o.markerMid;return s&&q(s)&&(e.markerStartAngle=s.getLocalEulerAngles(),e.appendChild(s)),l&&q(l)&&e.placeMarkerMid(l),u&&q(u)&&(e.markerEndAngle=u.getLocalEulerAngles(),e.appendChild(u)),e.transformMarker(!0),e.transformMarker(!1),e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"attributeChangedCallback",value:function(t,r,a,o,s){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(o&&q(o)&&(this.markerStartAngle=0,o.remove()),s&&q(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"?(o&&q(o)&&(this.markerEndAngle=0,o.remove()),s&&q(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(s)}},{key:"transformMarker",value:function(t){var r=this.parsedStyle,a=r.markerStart,o=r.markerEnd,s=r.markerStartOffset,u=r.markerEndOffset,l=r.points,c=l||{},f=c.points,h=t?a:o;if(!(!h||!q(h)||!f)){var d=0,v,g,p,y,m,k;if(p=f[0][0],y=f[0][1],t)v=f[1][0]-f[0][0],g=f[1][1]-f[0][1],m=s||0,k=this.markerStartAngle;else{var x=f.length;this.parsedStyle.isClosed?(v=f[x-1][0]-f[0][0],g=f[x-1][1]-f[0][1]):(p=f[x-1][0],y=f[x-1][1],v=f[x-2][0]-f[x-1][0],g=f[x-2][1]-f[x-1][1]),m=u||0,k=this.markerEndAngle}d=Math.atan2(g,v),h.setLocalEulerAngles(d*180/Math.PI+k),h.setLocalPosition(p+Math.cos(d)*m,y+Math.sin(d)*m)}}},{key:"placeMarkerMid",value:function(t){var r=this.parsedStyle.points,a=r||{},o=a.points;if(this.markerMidList.forEach(function(f){f.remove()}),this.markerMidList=[],t&&q(t)&&o)for(var s=1;s<(this.parsedStyle.isClosed?o.length:o.length-1);s++){var u=o[s][0],l=o[s][1],c=s===1?t:t.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(u,l)}}}])}(ee);Rt.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var Fu=["style"],Jn=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.style,r=(0,Ye.Z)(e,Fu);return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.POLYLINE,style:t,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)])}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"getTotalLength",value:function(){return So(this)}},{key:"getPointAtLength",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(t/this.getTotalLength(),r)}},{key:"getPoint",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var o=[],s=0,u,l,c=this.getTotalLength();a.forEach(function(y,m){a[m+1]&&(u=[0,0],u[0]=s/c,l=(0,He.Xk)(y[0],y[1],a[m+1][0],a[m+1][1]),s+=l,u[1]=s/c,o.push(u))}),this.parsedStyle.points.segments=o}var f=0,h=0;this.parsedStyle.points.segments.forEach(function(y,m){t>=y[0]&&t<=y[1]&&(f=(t-y[0])/(y[1]-y[0]),h=m)});var d=(0,He.U4)(a[h][0],a[h][1],a[h+1][0],a[h+1][1],f),v=d.x,g=d.y,p=E.fF(E.Ue(),E.al(v,g,0),r?this.getWorldTransform():this.getLocalTransform());return new pe(p[0],p[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,r=t.length-1,a=[];return a.push([t[r-1][0],t[r-1][1]]),a.push([t[r][0],t[r][1]]),a}}])}(Rt);Jn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(Rt.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Qn=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.RECT},e)])}return(0,$.Z)(i,n),(0,C.Z)(i)}(ee);Qn.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var Gu=["style"],en=function(n){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.style,r=(0,Ye.Z)(e,Gu);return(0,S.Z)(this,i),(0,Y.Z)(this,i,[(0,B.Z)({type:R.TEXT,style:(0,B.Z)({fill:"black"},t)},r)])}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(ee);en.PARSED_STYLE_LIST=new Set([].concat((0,j.Z)(ee.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"]));var Uu=function(){function n(){(0,S.Z)(this,n),this.registry={},this.define(R.CIRCLE,Vn),this.define(R.ELLIPSE,Hn),this.define(R.RECT,Qn),this.define(R.IMAGE,$n),this.define(R.LINE,Xn),this.define(R.GROUP,At),this.define(R.PATH,Kn),this.define(R.POLYGON,Rt),this.define(R.POLYLINE,Jn),this.define(R.TEXT,en),this.define(R.HTML,Yn)}return(0,C.Z)(n,[{key:"define",value:function(e,t){this.registry[e]=t}},{key:"get",value:function(e){return this.registry[e]}}])}(),Bu={number:function(i){return new J(i)},percent:function(i){return new J(i,"%")},px:function(i){return new J(i,"px")},em:function(i){return new J(i,"em")},rem:function(i){return new J(i,"rem")},deg:function(i){return new J(i,"deg")},grad:function(i){return new J(i,"grad")},rad:function(i){return new J(i,"rad")},turn:function(i){return new J(i,"turn")},s:function(i){return new J(i,"s")},ms:function(i){return new J(i,"ms")},registerProperty:function(i){var e=i.name,t=i.inherits,r=i.interpolable,a=i.initialValue,o=i.syntax;T.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:a,syntax:o})},registerLayout:function(i,e){T.layoutRegistry.registerLayout(i,e)}},zu=function(n){function i(){var e;(0,S.Z)(this,i),e=(0,Y.Z)(this,i),e.defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new T.AnimationTimeline(e)}catch(r){}var t={};return bn.forEach(function(r){var a=r.n,o=r.inh,s=r.d;o&&s&&(t[a]=(0,gt.Z)(s)?s(R.GROUP):s)}),e.documentElement=new At({id:"g-root",style:t}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,r){if(t==="svg")return this.documentElement;var a=this.defaultView.customElements.get(t);a||(console.warn("Unsupported tagName: ",t),a=t==="tspan"?en:At);var o=new a(r);return o.ownerDocument=this,o}},{key:"createElementNS",value:function(t,r,a){return this.createElement(r,a)}},{key:"cloneNode",value:function(t){throw new Error(ne)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,r,a,o){var s=[],u=function(c){if(!(!c.isInteractive()||c.isCulled())){var f=c.parsedStyle.pointerEvents,h=f===void 0?"auto":f,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(h);if(!d||c.isVisible()){var v=c.getTransformedGeometryBounds(!0);v&&!me.isEmpty(v)&&v.max[0]>=t&&v.min[0]<=a&&v.max[1]>=r&&v.min[1]<=o&&s.push(c)}c.childNodes&&c.childNodes.forEach(function(g){g instanceof ee&&u(g)})}};return u(this.documentElement),s.sort(function(l,c){return c.sortable.renderOrder-l.sortable.renderOrder}),s}},{key:"elementFromPointSync",value:function(t,r){var a=this.defaultView.canvas2Viewport({x:t,y:r}),o=a.x,s=a.y,u=this.defaultView.getConfig(),l=u.width,c=u.height;if(o<0||s<0||o>l||s>c)return null;var f=this.defaultView.viewport2Client({x:o,y:s}),h=f.x,d=f.y,v=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:o,viewportY:s,clientX:h,clientY:d},picked:[]}),g=v.picked;return g&&g[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var e=(0,pt.Z)((0,Ze.Z)().mark(function r(a,o){var s,u,l,c,f,h,d,v,g,p,y;return(0,Ze.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=this.defaultView.canvas2Viewport({x:a,y:o}),u=s.x,l=s.y,c=this.defaultView.getConfig(),f=c.width,h=c.height,!(u<0||l<0||u>f||l>h)){m.next=1;break}return m.abrupt("return",null);case 1:return d=this.defaultView.viewport2Client({x:u,y:l}),v=d.x,g=d.y,m.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:a,y:o,viewportX:u,viewportY:l,clientX:v,clientY:g},picked:[]});case 2:return p=m.sent,y=p.picked,m.abrupt("return",y&&y[0]||this.documentElement);case 3:case"end":return m.stop()}},r,this)}));function t(r,a){return e.apply(this,arguments)}return t}()},{key:"elementsFromPointSync",value:function(t,r){var a=this.defaultView.canvas2Viewport({x:t,y:r}),o=a.x,s=a.y,u=this.defaultView.getConfig(),l=u.width,c=u.height;if(o<0||s<0||o>l||s>c)return[];var f=this.defaultView.viewport2Client({x:o,y:s}),h=f.x,d=f.y,v=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:o,viewportY:s,clientX:h,clientY:d},picked:[]}),g=v.picked;return g[g.length-1]!==this.documentElement&&g.push(this.documentElement),g}},{key:"elementsFromPoint",value:function(){var e=(0,pt.Z)((0,Ze.Z)().mark(function r(a,o){var s,u,l,c,f,h,d,v,g,p,y;return(0,Ze.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=this.defaultView.canvas2Viewport({x:a,y:o}),u=s.x,l=s.y,c=this.defaultView.getConfig(),f=c.width,h=c.height,!(u<0||l<0||u>f||l>h)){m.next=1;break}return m.abrupt("return",[]);case 1:return d=this.defaultView.viewport2Client({x:u,y:l}),v=d.x,g=d.y,m.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:a,y:o,viewportX:u,viewportY:l,clientX:v,clientY:g},picked:[]});case 2:return p=m.sent,y=p.picked,y[y.length-1]!==this.documentElement&&y.push(this.documentElement),m.abrupt("return",y);case 3:case"end":return m.stop()}},r,this)}));function t(r,a){return e.apply(this,arguments)}return t}()},{key:"appendChild",value:function(t,r){throw new Error(ut)}},{key:"insertBefore",value:function(t,r){throw new Error(ut)}},{key:"removeChild",value:function(t,r){throw new Error(ut)}},{key:"replaceChild",value:function(t,r,a){throw new Error(ut)}},{key:"append",value:function(){throw new Error(ut)}},{key:"prepend",value:function(){throw new Error(ut)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}])}(ae),Ri=function(){function n(i){(0,S.Z)(this,n),this.strategies=i}return(0,C.Z)(n,[{key:"apply",value:function(e){var t=e.config,r=e.camera,a=e.renderingService,o=e.renderingContext,s=this.strategies;a.hooks.cull.tap(n.tag,function(u){if(u){var l,c=u.cullable;if(s.length===0?c.visible=o.unculledEntities.indexOf(u.entity)>-1:c.visible=s.every(function(h){return h.isVisible(r,u)}),!u.isCulled()&&u.isVisible())return u;var f=((l=t.future)===null||l===void 0?void 0:l.experimentalCancelEventPropagation)===!0;return u.dispatchEvent(new ye(X.CULLED),f,f),null}return u}),a.hooks.afterRender.tap(n.tag,function(u){u.cullable.visibilityPlaneMask=-1})}}])}();Ri.tag="Culling";var bi=function(){function n(){var i=this;(0,S.Z)(this,n),this.autoPreventDefault=!1,this.rootPointerEvent=new Gn(null),this.rootWheelEvent=new Un(null),this.onPointerMove=function(e){var t,r=(t=i.context.renderingContext.root)===null||t===void 0||(t=t.ownerDocument)===null||t===void 0?void 0:t.defaultView;if(!(r.supportsTouchEvents&&e.pointerType==="touch")){var a=i.normalizeToPointerEvent(e,r),o=(0,it.Z)(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=i.bootstrapEvent(i.rootPointerEvent,u,r,e);i.context.eventService.mapEvent(l)}}catch(c){o.e(c)}finally{o.f()}i.setCursor(i.context.eventService.cursor)}},this.onClick=function(e){var t,r=(t=i.context.renderingContext.root)===null||t===void 0||(t=t.ownerDocument)===null||t===void 0?void 0:t.defaultView,a=i.normalizeToPointerEvent(e,r),o=(0,it.Z)(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=i.bootstrapEvent(i.rootPointerEvent,u,r,e);i.context.eventService.mapEvent(l)}}catch(c){o.e(c)}finally{o.f()}i.setCursor(i.context.eventService.cursor)}}return(0,C.Z)(n,[{key:"apply",value:function(e){var t=this;this.context=e;var r=e.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(o){var s=t.context.renderingService.hooks.pickSync.call({position:o,picked:[],topmost:!0}),u=s.picked;return u[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(o){var s=t.normalizeWheelEvent(o);t.context.eventService.mapEvent(s)}),r.hooks.pointerDown.tap(n.tag,function(o){if(!(a.supportsTouchEvents&&o.pointerType==="touch")){var s=t.normalizeToPointerEvent(o,a);if(t.autoPreventDefault&&s[0].isNormalized){var u=o.cancelable||!("cancelable"in o);u&&o.preventDefault()}var l=(0,it.Z)(s),c;try{for(l.s();!(c=l.n()).done;){var f=c.value,h=t.bootstrapEvent(t.rootPointerEvent,f,a,o);t.context.eventService.mapEvent(h)}}catch(d){l.e(d)}finally{l.f()}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(o){if(!(a.supportsTouchEvents&&o.pointerType==="touch")){var s=t.context.contextService.getDomElement(),u=t.context.eventService.isNativeEventFromCanvas(s,o),l=u?"":"outside",c=t.normalizeToPointerEvent(o,a),f=(0,it.Z)(c),h;try{for(f.s();!(h=f.n()).done;){var d=h.value,v=t.bootstrapEvent(t.rootPointerEvent,d,a,o);v.type+=l,t.context.eventService.mapEvent(v)}}catch(g){f.e(g)}finally{f.f()}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(o){var s=t.normalizeToPointerEvent(o,a),u=(0,it.Z)(s),l;try{for(u.s();!(l=u.n()).done;){var c=l.value,f=t.bootstrapEvent(t.rootPointerEvent,c,a,o);t.context.eventService.mapEvent(f)}}catch(h){u.e(h)}finally{u.f()}t.setCursor(t.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(e,t,r,a){e.view=r,e.originalEvent=null,e.nativeEvent=a,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var o=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),s=o.x,u=o.y;e.viewport.x=s,e.viewport.y=u;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,f=l.y;return e.canvas.x=c,e.canvas.y=f,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=a.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Ts[e.type]||e.type),e}},{key:"normalizeWheelEvent",value:function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=r.x,o=r.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),u=s.x,l=s.y;return t.canvas.x=u,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t}},{key:"transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=In.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(e,t){var r=[];if(t.isTouchEvent(e))for(var a=0;a<e.changedTouches.length;a++){var o=e.changedTouches[a];(0,ie.Z)(o.button)&&(o.button=0),(0,ie.Z)(o.buttons)&&(o.buttons=1),(0,ie.Z)(o.isPrimary)&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),(0,ie.Z)(o.width)&&(o.width=o.radiusX||1),(0,ie.Z)(o.height)&&(o.height=o.radiusY||1),(0,ie.Z)(o.tiltX)&&(o.tiltX=0),(0,ie.Z)(o.tiltY)&&(o.tiltY=0),(0,ie.Z)(o.pointerType)&&(o.pointerType="touch"),(0,ie.Z)(o.pointerId)&&(o.pointerId=o.identifier||0),(0,ie.Z)(o.pressure)&&(o.pressure=o.force||.5),(0,ie.Z)(o.twist)&&(o.twist=0),(0,ie.Z)(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,o.type=e.type,r.push(o)}else if(t.isMouseEvent(e)){var s=e;(0,ie.Z)(s.isPrimary)&&(s.isPrimary=!0),(0,ie.Z)(s.width)&&(s.width=1),(0,ie.Z)(s.height)&&(s.height=1),(0,ie.Z)(s.tiltX)&&(s.tiltX=0),(0,ie.Z)(s.tiltY)&&(s.tiltY=0),(0,ie.Z)(s.pointerType)&&(s.pointerType="mouse"),(0,ie.Z)(s.pointerId)&&(s.pointerId=xs),(0,ie.Z)(s.pressure)&&(s.pressure=.5),(0,ie.Z)(s.twist)&&(s.twist=0),(0,ie.Z)(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,r.push(s)}else r.push(e);return r}}])}();bi.tag="Event";var Wu=[R.CIRCLE,R.ELLIPSE,R.IMAGE,R.RECT,R.LINE,R.POLYLINE,R.POLYGON,R.TEXT,R.PATH,R.HTML],Vu=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"isVisible",value:function(e,t){var r,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(me.isEmpty(o))return!1;var s=e.getFrustum(),u=(r=t.parentNode)===null||r===void 0||(r=r.cullable)===null||r===void 0?void 0:r.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,u||ot.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==ot.OUTSIDE,a.visible}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,r,a){if(r===ot.OUTSIDE||r===ot.INSIDE)return r;for(var o=ot.INSIDE,s=Wu.indexOf(e.nodeName)>-1,u=0,l=a.length;u<l;++u){var c=1<<u;if(r&c&&!(s&&(u===4||u===5))){var f=a[u],h=f.normal,d=f.distance;if(E.AK(h,t.getPositiveFarPoint(a[u]))+d<0)return ot.OUTSIDE;E.AK(h,t.getNegativeFarPoint(a[u]))+d<0&&(o|=c)}}return o}}])}(),Oi=function(){function n(){(0,S.Z)(this,n),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1}return(0,C.Z)(n,[{key:"apply",value:function(e){var t=this,r,a=e.renderingService,o=e.renderingContext,s=o.root.ownerDocument.defaultView,u=function(v){a.dirty()},l=function(v){var g,p=v.detail;(g=t.mutationRecords).push.apply(g,(0,j.Z)(p)),a.dirty()},c=function(v){var g=v.target;T.enableSizeAttenuation&&T.styleValueRegistry.updateSizeAttenuation(g,s.getCamera().getZoom())},f=function(v){var g=v.target;T.sceneGraphService.dirtyToRoot(g),a.dirty()};a.hooks.init.tap(n.tag,function(){s.addEventListener(X.MOUNTED,c),s.addEventListener(X.UNMOUNTED,f),s.addEventListener(X.ATTR_MODIFIED,u),s.addEventListener(X.BOUNDS_CHANGED,l)}),a.hooks.destroy.tap(n.tag,function(){s.removeEventListener(X.MOUNTED,c),s.removeEventListener(X.UNMOUNTED,f),s.removeEventListener(X.ATTR_MODIFIED,u),s.removeEventListener(X.BOUNDS_CHANGED,l),t.mutationRecords=[]});var h=(r=T.globalThis.requestIdleCallback)!==null&&r!==void 0?r:Zn.bind(T.globalThis);a.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering&&(t.isFirstTimeRendering=!1,h(function(){t.isFirstTimeRenderingFinished=!0})),t.mutationRecords=[]})}}])}();Oi.tag="Prepare";function Pl(n){return!!n.document}var Re=function(n){return n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged",n}({}),Li=500,Hu=.1,Yu=1e3,tn=new ye(X.MOUNTED),nn=new ye(X.UNMOUNTED),qn=new ye(Re.BEFORE_RENDER),Di=new ye(Re.RERENDER),jn=new ye(Re.AFTER_RENDER),$u=function(n){function i(e){var t;(0,S.Z)(this,i),t=(0,Y.Z)(this,i),t.Element=ee,t.inited=!1,t.context={};var r=e.container,a=e.canvas,o=e.renderer,s=e.width,u=e.height,l=e.background,c=e.cursor,f=e.supportsMutipleCanvasesInOneContainer,h=e.cleanUpOnDestroy,d=h===void 0?!0:h,v=e.offscreenCanvas,g=e.devicePixelRatio,p=e.requestAnimationFrame,y=e.cancelAnimationFrame,m=e.createImage,k=e.supportsTouchEvents,x=e.supportsPointerEvents,L=e.isTouchEvent,O=e.isMouseEvent,P=e.dblClickSpeed,w=s,F=u,U=g||Dn&&window.devicePixelRatio||1;return U=U>=1?Math.ceil(U):1,a&&(w=s||Es(a)||a.width/U,F=u||ks(a)||a.height/U),t.customElements=new Uu,t.devicePixelRatio=U,t.requestAnimationFrame=p!=null?p:Zn.bind(T.globalThis),t.cancelAnimationFrame=y!=null?y:pi.bind(T.globalThis),t.createImage=m!=null?m:function(){return new window.Image},t.supportsTouchEvents=k!=null?k:"ontouchstart"in T.globalThis,t.supportsPointerEvents=x!=null?x:!!T.globalThis.PointerEvent,t.isTouchEvent=L!=null?L:function(_){return t.supportsTouchEvents&&_ instanceof T.globalThis.TouchEvent},t.isMouseEvent=O!=null?O:function(_){return!T.globalThis.MouseEvent||_ instanceof T.globalThis.MouseEvent&&(!t.supportsPointerEvents||!(_ instanceof T.globalThis.PointerEvent))},v&&(T.offscreenCanvas=v),t.document=new zu,t.document.defaultView=t,f||gs(r,t,d),t.initRenderingContext((0,B.Z)((0,B.Z)({},e),{},{width:w,height:F,background:l!=null?l:"transparent",cursor:c!=null?c:"default",cleanUpOnDestroy:d,devicePixelRatio:U,requestAnimationFrame:t.requestAnimationFrame,cancelAnimationFrame:t.cancelAnimationFrame,createImage:t.createImage,supportsTouchEvents:t.supportsTouchEvents,supportsPointerEvents:t.supportsPointerEvents,isTouchEvent:t.isTouchEvent,isMouseEvent:t.isMouseEvent,dblClickSpeed:P!=null?P:200})),t.initDefaultCamera(w,F,o.clipSpaceNearZ),t.initRenderer(o,!0),t}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,r,a){var o=this,s=new T.CameraContribution;s.clipSpaceNearZ=a,s.setType(se.EXPLORING,gn.DEFAULT).setPosition(t/2,r/2,Li).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,Hu,Yu),s.canvas=this,s.eventEmitter.on(xr.UPDATED,function(){o.context.renderingContext.renderReasons.add(vt.CAMERA_CHANGED),T.enableSizeAttenuation&&o.getConfig().renderer.getConfig().enableSizeAttenuation&&o.updateSizeAttenuation()}),this.context.camera=s}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){T.styleValueRegistry.updateSizeAttenuation(r,t)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=arguments.length>1?arguments[1]:void 0;ce.clearCache();var o=((t=this.getConfig().future)===null||t===void 0?void 0:t.experimentalCancelEventPropagation)===!0;a||this.dispatchEvent(new ye(Re.BEFORE_DESTROY),o,o),this.frameId&&this.cancelAnimationFrame(this.frameId);var s=this.getRoot();r&&(this.unmountChildren(s),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),a||this.dispatchEvent(new ye(Re.AFTER_DESTROY),o,o);var u=function(c){c.currentTarget=null,c.manager=null,c.target=null,c.relatedNode=null};u(tn),u(nn),u(qn),u(Di),u(jn),u(Be),u(zn),u(Wn),u(Ni),T.textService.clearCache()}},{key:"changeSize",value:function(t,r){this.resize(t,r)}},{key:"resize",value:function(t,r){var a,o=this.context.config;o.width=t,o.height=r,this.getContextService().resize(t,r);var s=this.context.camera,u=s.getProjectionMode();s.setPosition(t/2,r/2,Li).setFocalPoint(t/2,r/2,0),u===Ne.ORTHOGRAPHIC?s.setOrthographic(t/-2,t/2,r/2,r/-2,s.getNear(),s.getFar()):s.setAspect(t/r);var l=((a=o.future)===null||a===void 0?void 0:a.experimentalCancelEventPropagation)===!0;this.dispatchEvent(new ye(Re.RESIZE,{width:t,height:r}),l,l)}},{key:"appendChild",value:function(t,r){return this.document.documentElement.appendChild(t,r)}},{key:"insertBefore",value:function(t,r){return this.document.documentElement.insertBefore(t,r)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var r,a=this;t&&(qn.detail=t,jn.detail=t);var o=((r=this.getConfig().future)===null||r===void 0?void 0:r.experimentalCancelEventPropagation)===!0;this.dispatchEvent(qn,o,o);var s=this.getRenderingService();s.render(this,t,function(){a.dispatchEvent(Di,o,o)}),this.dispatchEvent(jn,o,o)}},{key:"run",value:function(){var t=this,r=function(o,s){t.render(s),t.frameId=t.requestAnimationFrame(r)};r()}},{key:"initRenderer",value:function(t){var r=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new bi,new Oi,new Ri([new Vu])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService((0,B.Z)((0,B.Z)({},T),this.context)),this.context.renderingService=new nu(T,this.context),this.context.eventService=new tu(T,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,a,!0)):this.context.contextService.initAsync().then(function(){r.initRenderingService(t,a)}).catch(function(o){console.error(o)})}},{key:"initRenderingService",value:function(t){var r=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){var s;r.inited=!0;var u=((s=r.getConfig().future)===null||s===void 0?void 0:s.experimentalCancelEventPropagation)===!0;a?o?r.requestAnimationFrame(function(){r.dispatchEvent(new ye(Re.READY),u,u)}):r.dispatchEvent(new ye(Re.READY),u,u):r.dispatchEvent(new ye(Re.RENDERER_CHANGED),u,u),r.readyPromise&&r.resolveReadyPromise(),a||r.getRoot().forEach(function(l){var c,f;(c=(f=l).dirty)===null||c===void 0||c.call(f,!0,!0)}),r.mountChildren(r.getRoot()),t.getConfig().enableAutoRendering&&r.run()})}},{key:"loadRendererContainerModule",value:function(t){var r=this,a=t.getPlugins();a.forEach(function(o){o.context=r.context,o.init(T)})}},{key:"setRenderer",value:function(t){var r=this.getConfig();if(r.renderer!==t){var a=r.renderer;r.renderer=t,this.destroy(!1,!0),(0,j.Z)((a==null?void 0:a.getPlugins())||[]).reverse().forEach(function(o){o.destroy(T)}),this.initRenderer(t)}}},{key:"setCursor",value:function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var r=this;if(t.childNodes.forEach(function(s){r.unmountChildren(s)}),this.inited){if(t.isMutationObserved)t.dispatchEvent(nn);else{var a,o=((a=this.getConfig().future)===null||a===void 0?void 0:a.experimentalCancelEventPropagation)===!0;nn.target=t,this.dispatchEvent(nn,!0,o)}t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1}t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var r=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kt(t);if(this.inited){if(!t.isConnected&&(t.ownerDocument=this.document,t.isConnected=!0,!a))if(t.isMutationObserved)t.dispatchEvent(tn);else{var o,s=((o=this.getConfig().future)===null||o===void 0?void 0:o.experimentalCancelEventPropagation)===!0;tn.target=t,this.dispatchEvent(tn,!0,s)}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName);t.childNodes.forEach(function(u){r.mountChildren(u,a)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,r){return this.client2Viewport({x:t,y:r})}},{key:"getClientByPoint",value:function(t,r){return this.viewport2Client({x:t,y:r})}}])}(Ti),Sl=0,Ii=new WeakMap,Zi=null,Cl=null,Ml=null,rn,ze;function wl(n,i){return rn=new Zi(n,i)}function Nl(n){return ze||(ze=Zi.copy(rn),ze.oldValue=n,ze)}function Al(){rn=ze=void 0}function Xu(n){return n===ze||n===rn}function Rl(n,i){return n===i?n:ze&&Xu(n)?ze:null}function Ku(n){n.nodes.forEach(function(i){var e=Ii.get(i);e&&e.forEach(function(t){t.observer===n&&t.removeTransientObservers()})})}function bl(n,i){for(var e=n;e;e=e.parentNode){var t=Ii.get(e);if(t)for(var r=0;r<t.length;r++){var a=t[r],o=a.options;if(!(e!==n&&!o.subtree)){var s=i(o);s&&a.enqueue(s)}}}}var er=!1,tr=null;function Ol(n){tr.push(n),er||(er=!0,typeof T.globalThis!="undefined"?T.globalThis.setTimeout(nr):nr())}function nr(){er=!1;var n=tr;tr=[],n.sort(function(e,t){return e.uid-t.uid});var i=!1;n.forEach(function(e){var t=e.takeRecords();Ku(e),t.length&&(e.callback(t,e),i=!0)}),i&&nr()}var Ju=function(){function n(){(0,S.Z)(this,n),this.cacheStore=new Map}return(0,C.Z)(n,[{key:"onRefAdded",value:function(e){}},{key:"has",value:function(e){return this.cacheStore.has(e)}},{key:"put",value:function(e,t,r){return this.cacheStore.has(e)?!1:(this.cacheStore.set(e,{value:t,counter:new Set([r.entity])}),this.onRefAdded(r),!0)}},{key:"get",value:function(e,t){var r=this.cacheStore.get(e);return r?(r.counter.has(t.entity)||(r.counter.add(t.entity),this.onRefAdded(t)),r.value):null}},{key:"update",value:function(e,t,r){var a=this.cacheStore.get(e);return a?(a.value=(0,B.Z)((0,B.Z)({},a.value),t),a.counter.has(r.entity)||(a.counter.add(r.entity),this.onRefAdded(r)),!0):!1}},{key:"release",value:function(e,t){var r=this.cacheStore.get(e);return r?(r.counter.delete(t.entity),r.counter.size<=0&&this.cacheStore.delete(e),!0):!1}},{key:"releaseRef",value:function(e){var t=this;Array.from(this.cacheStore.keys()).forEach(function(r){t.release(r,e)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),rr=[],ir=[],ar=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,null,[{key:"stop",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n.api;n.rafId&&(e.cancelAnimationFrame(n.rafId),n.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n.api;rr.length<=0&&ir.length<=0||(ir.forEach(function(t){return t()}),ir=rr.splice(0,n.TASK_NUM_PER_FRAME),n.rafId=e.requestAnimationFrame(function(){n.executeTask(e)}))}},{key:"sliceImage",value:function(e,t,r,a){for(var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:n.api,u=e.naturalWidth||e.width,l=e.naturalHeight||e.height,c=t-o,f=r-o,h=Math.ceil(u/c),d=Math.ceil(l/f),v={tileSize:[t,r],gridSize:[d,h],tiles:Array(d).fill(null).map(function(){return Array(h).fill(null)})},g=function(m){for(var k=function(O){rr.push(function(){var P=O*c,w=m*f,F=[Math.min(t,u-P),Math.min(r,l-w)],U=F[0],_=F[1],D=s.createCanvas();D.width=t,D.height=r;var H=D.getContext("2d");H.drawImage(e,P,w,U,_,0,0,U,_),v.tiles[m][O]={x:P,y:w,tileX:O,tileY:m,data:D},a()})},x=0;x<h;x++)k(x)},p=0;p<d;p++)g(p);return n.stop(),n.executeTask(),v}}])}();ar.TASK_NUM_PER_FRAME=10;var Me=new Ju;Me.onRefAdded=function(i){var e=this;i.addEventListener(X.DESTROY,function(){e.releaseRef(i)},{once:!0})};var or=function(){function n(i,e){(0,S.Z)(this,n),this.gradientCache={},this.patternCache={},this.context=i,this.runtime=e}return(0,C.Z)(n,[{key:"getImageSync",value:function(e,t,r){var a=(0,Ee.Z)(e)?e:e.src;if(Me.has(a)){var o=Me.get(a,t);if(o.img.complete)return r==null||r(o),o}return this.getOrCreateImage(e,t).then(function(s){r==null||r(s)}).catch(function(s){console.error(s)}),null}},{key:"getOrCreateImage",value:function(e,t){var r=this,a=(0,Ee.Z)(e)?e:e.src;if(!(0,Ee.Z)(e)&&!Me.has(a)){var o={img:e,size:[e.naturalWidth||e.width,e.naturalHeight||e.height],tileSize:an(e)};Me.put(a,o,t)}if(Me.has(a)){var s=Me.get(a,t);return s.img.complete?Promise.resolve(s):new Promise(function(u,l){s.img.addEventListener("load",function(){s.size=[s.img.naturalWidth||s.img.width,s.img.naturalHeight||s.img.height],s.tileSize=an(s.img),u(s)}),s.img.addEventListener("error",function(c){l(c)})})}return new Promise(function(u,l){var c=r.context.config.createImage();if(c){var f={img:c,size:[0,0],tileSize:an(c)};Me.put(a,f,t),c.onload=function(){f.size=[c.naturalWidth||c.width,c.naturalHeight||c.height],f.tileSize=an(f.img),u(f)},c.onerror=function(h){l(h)},c.crossOrigin="Anonymous",c.src=a}})}},{key:"createDownSampledImage",value:function(){var i=(0,pt.Z)((0,Ze.Z)().mark(function t(r,a){var o,s,u,l,c,f,h,d,v,g,p,y,m,k;return(0,Ze.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=1,this.getOrCreateImage(r,a);case 1:if(o=x.sent,typeof o.downSamplingRate=="undefined"){x.next=2;break}return x.abrupt("return",o);case 2:if(s=this.context.config.enableLargeImageOptimization,u=typeof s=="boolean"?{}:s,l=u.maxDownSampledImageSize,c=l===void 0?2048:l,f=u.downSamplingRateThreshold,h=f===void 0?.5:f,d=this.runtime.globalThis.createImageBitmap,v=(0,oe.Z)(o.size,2),g=v[0],p=v[1],y=o.img,m=Math.min((c+c)/(g+p),Math.max(.01,Math.min(h,.5))),k=(0,B.Z)((0,B.Z)({},o),{},{downSamplingRate:m}),Me.update(o.img.src,k,a),!d){x.next=7;break}return x.prev=3,x.next=4,d(o.img,{resizeWidth:g*m,resizeHeight:p*m});case 4:y=x.sent,x.next=6;break;case 5:x.prev=5,x.catch(3),m=1;case 6:x.next=8;break;case 7:m=1;case 8:return k=(0,B.Z)((0,B.Z)({},this.getImageSync(r,a)),{},{downSampled:y,downSamplingRate:m}),Me.update(o.img.src,k,a),x.abrupt("return",k);case 9:case"end":return x.stop()}},t,this,[[3,5]])}));function e(t,r){return i.apply(this,arguments)}return e}()},{key:"createImageTiles",value:function(){var i=(0,pt.Z)((0,Ze.Z)().mark(function t(r,a,o,s){var u,l,c,f,h;return(0,Ze.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=1,this.getOrCreateImage(r,s);case 1:return u=d.sent,l=s.ownerDocument.defaultView,c=l.requestAnimationFrame,f=l.cancelAnimationFrame,ar.api={requestAnimationFrame:c,cancelAnimationFrame:f,createCanvas:function(){return Bn.createCanvas()}},h=(0,B.Z)((0,B.Z)({},u),ar.sliceImage(u.img,u.tileSize[0],u.tileSize[0],o)),Me.update(u.img.src,h,s),d.abrupt("return",h);case 2:case"end":return d.stop()}},t,this)}));function e(t,r,a,o){return i.apply(this,arguments)}return e}()},{key:"releaseImage",value:function(e,t){Me.release((0,Ee.Z)(e)?e:e.src,t)}},{key:"releaseImageRef",value:function(e){Me.releaseRef(e)}},{key:"getOrCreatePatternSync",value:function(e,t,r,a,o,s,u){var l=this.generatePatternKey(t);if(l&&this.patternCache[l])return this.patternCache[l];var c=t.image,f=t.repetition,h=t.transform,d,v=!1;if((0,Ee.Z)(c)){var g=this.getImageSync(c,e,u);d=g==null?void 0:g.img}else a?(d=a,v=!0):d=c;var p=d&&r.createPattern(d,f);if(p){var y;h?y=ki(ri(h),new ee({})):y=M.identity(M.create()),v&&M.scale(y,y,[1/o,1/o,1]),p.setTransform({a:y[0],b:y[1],c:y[4],d:y[5],e:y[12]+s[0],f:y[13]+s[1]})}return l&&p&&(this.patternCache[l]=p),p}},{key:"getOrCreateGradient",value:function(e,t){var r=this.generateGradientKey(e),a=e.type,o=e.steps,s=e.min,u=e.width,l=e.height,c=e.angle,f=e.cx,h=e.cy,d=e.size;if(this.gradientCache[r])return this.gradientCache[r];var v=null;if(a===Ke.LinearGradient){var g=ro(s,u,l,c),p=g.x1,y=g.y1,m=g.x2,k=g.y2;v=t.createLinearGradient(p,y,m,k)}else if(a===Ke.RadialGradient){var x=io(s,u,l,f,h,d),L=x.x,O=x.y,P=x.r;v=t.createRadialGradient(L,O,0,L,O,P)}return v&&(o.forEach(function(w){var F=w.offset,U=w.color;if(F.unit===A.kPercentage){var _;(_=v)===null||_===void 0||_.addColorStop(F.value/100,U.toString())}}),this.gradientCache[r]=v),this.gradientCache[r]}},{key:"generateGradientKey",value:function(e){var t=e.type,r=e.min,a=e.width,o=e.height,s=e.steps,u=e.angle,l=e.cx,c=e.cy,f=e.size;return"gradient-".concat(t,"-").concat((u==null?void 0:u.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((f==null?void 0:f.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(a,"-").concat(o,"-").concat(s.map(function(h){var d=h.offset,v=h.color;return"".concat(d).concat(v)}).join("-"))}},{key:"generatePatternKey",value:function(e){var t=e.image,r=e.repetition;if((0,Ee.Z)(t))return"pattern-".concat(t,"-").concat(r);if(t.nodeName==="rect")return"pattern-".concat(t.entity,"-").concat(r)}}])}();or.isSupportTile=!!Bn.createCanvas();function an(n){if(!n.complete)return[0,0];var i=n.naturalWidth||n.width,e=n.naturalHeight||n.height,t=256;return[256,512].forEach(function(r){var a=Math.ceil(e/r),o=Math.ceil(i/r);a*o<1e3&&(t=r)}),[t,t]}var _i=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"apply",value:function(e){var t=e.renderingService,r=e.renderingContext,a=e.imagePool,o=r.root.ownerDocument.defaultView,s=function(f,h,d){var v=f.parsedStyle,g=v.width,p=v.height;g&&!p?f.setAttribute("height",d/h*g):!g&&p&&f.setAttribute("width",h/d*p)},u=function(f){var h=f.target,d=h.nodeName,v=h.attributes;if(d===R.IMAGE){var g=v.src,p=v.keepAspectRatio;a.getImageSync(g,h,function(y){var m=y.img,k=m.width,x=m.height;p&&s(h,k,x),h.dirty(),t.dirty()})}},l=function(f){var h=f.target,d=f.attrName,v=f.prevValue,g=f.newValue;h.nodeName!==R.IMAGE||d!=="src"||(v!==g&&a.releaseImage(v,h),(0,Ee.Z)(g)&&a.getOrCreateImage(g,h).then(function(p){var y=p.img,m=y.width,k=y.height;h.attributes.keepAspectRatio&&s(h,m,k),h.dirty(),t.dirty()}).catch(function(){}))};t.hooks.init.tap(n.tag,function(){o.addEventListener(X.MOUNTED,u),o.addEventListener(X.ATTR_MODIFIED,l)}),t.hooks.destroy.tap(n.tag,function(){o.removeEventListener(X.MOUNTED,u),o.removeEventListener(X.ATTR_MODIFIED,l)})}}])}();_i.tag="LoadImage";var Qu=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.name="image-loader",e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"init",value:function(t){this.context.imagePool=new or(this.context,t),this.addRenderingPlugin(new _i)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(mt),qu=Object.freeze({__proto__:null,ImagePool:or,Plugin:Qu}),ju="g-canvas-camera",Fi=function(){function n(){(0,S.Z)(this,n),this.displayObjectHTMLElementMap=new WeakMap}return(0,C.Z)(n,[{key:"joinTransformMatrix",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([e[0],e[1],e[4],e[5],e[12]+t[0],e[13]+t[1]].join(","),")")}},{key:"apply",value:function(e,t){var r=this,a=e.camera,o=e.renderingContext,s=e.renderingService;this.context=e;var u=o.root.ownerDocument.defaultView,l=u.context.eventService.nativeHTMLMap,c=function(y,m){m.style.transform=r.joinTransformMatrix(y.getWorldTransform(),y.getOrigin())},f=function(y){var m=y.target;if(m.nodeName===R.HTML){r.$camera||(r.$camera=r.createCamera(a));var k=r.getOrCreateEl(m);r.$camera.appendChild(k),Object.keys(m.attributes).forEach(function(x){r.updateAttribute(x,m)}),c(m,k),l.set(k,m)}},h=function(y){var m=y.target;if(m.nodeName===R.HTML&&r.$camera){var k=r.getOrCreateEl(m);k&&(k.remove(),l.delete(k))}},d=function(y){var m=y.target;if(m.nodeName===R.HTML){var k=y.attrName;r.updateAttribute(k,m)}},v=function(y){for(var m=y.detail,k=0;k<m.length;k++){var x=m[k],L=x.target,O=L.nodeName===R.FRAGMENT?L.childNodes:[L];O.forEach(function(P){if(P.nodeName===R.HTML){var w=r.getOrCreateEl(P);c(P,w)}})}},g=function(){if(r.$camera){var y=r.context.config,m=y.width,k=y.height;r.$camera.parentElement.style.width="".concat(m||0,"px"),r.$camera.parentElement.style.height="".concat(k||0,"px")}};s.hooks.init.tap(n.tag,function(){u.addEventListener(Re.RESIZE,g),u.addEventListener(X.MOUNTED,f),u.addEventListener(X.UNMOUNTED,h),u.addEventListener(X.ATTR_MODIFIED,d),u.addEventListener(X.BOUNDS_CHANGED,v)}),s.hooks.endFrame.tap(n.tag,function(){r.$camera&&o.renderReasons.has(vt.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(a.getOrthoMatrix()))}),s.hooks.destroy.tap(n.tag,function(){r.$camera&&r.$camera.remove(),u.removeEventListener(Re.RESIZE,g),u.removeEventListener(X.MOUNTED,f),u.removeEventListener(X.UNMOUNTED,h),u.removeEventListener(X.ATTR_MODIFIED,d),u.removeEventListener(X.BOUNDS_CHANGED,v)})}},{key:"createCamera",value:function(e){var t=this.context.config,r=t.document,a=t.width,o=t.height,s=this.context.contextService.getDomElement(),u=s.parentNode;if(u){var l=ju,c=u.querySelector("#".concat(l));if(!c){var f=(r||document).createElement("div");f.style.overflow="hidden",f.style.pointerEvents="none",f.style.position="absolute",f.style.left="0px",f.style.top="0px",f.style.width="".concat(a||0,"px"),f.style.height="".concat(o||0,"px");var h=(r||document).createElement("div");c=h,h.id=l,h.style.position="absolute",h.style.left="".concat(s.offsetLeft||0,"px"),h.style.top="".concat(s.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),h.style.pointerEvents="none",h.style.width="100%",h.style.height="100%",f.appendChild(h),u.appendChild(f)}return c}return null}},{key:"getOrCreateEl",value:function(e){var t=this.context.config.document,r=this.displayObjectHTMLElementMap.get(e);return r||(r=(t||document).createElement("div"),e.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(e,r),e.id&&(r.id=e.id),e.name&&r.setAttribute("name",e.name),e.className&&(r.className=e.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),r}},{key:"updateAttribute",value:function(e,t){var r=this.getOrCreateEl(t);switch(e){case"innerHTML":var a=t.parsedStyle.innerHTML;(0,Ee.Z)(a)?r.innerHTML=a:(r.innerHTML="",r.appendChild(a));break;case"x":r.style.left="".concat(t.parsedStyle.x,"px");break;case"y":r.style.top="".concat(t.parsedStyle.y,"px");break;case"transformOrigin":var o=t.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(o[0].buildCSSText(null,null,"")," ").concat(o[1].buildCSSText(null,null,""));break;case"width":var s=t.parsedStyle.width;r.style.width=(0,We.Z)(s)?"".concat(s,"px"):s.toString();break;case"height":var u=t.parsedStyle.height;r.style.height=(0,We.Z)(u)?"".concat(u,"px"):u.toString();break;case"zIndex":var l=t.parsedStyle.zIndex;r.style["z-index"]="".concat(l);break;case"visibility":var c=t.parsedStyle.visibility;r.style.visibility=c;break;case"pointerEvents":var f=t.parsedStyle.pointerEvents,h=f===void 0?"auto":f;r.style.pointerEvents=h;break;case"opacity":var d=t.parsedStyle.opacity;r.style.opacity="".concat(d);break;case"fill":var v=t.parsedStyle.fill,g="";Ht(v)?v.isNone?g="transparent":g=t.getAttribute("fill"):Array.isArray(v)?g=t.getAttribute("fill"):Vt(v),r.style.background=g;break;case"stroke":var p=t.parsedStyle.stroke,y="";Ht(p)?p.isNone?y="transparent":y=t.getAttribute("stroke"):Array.isArray(p)?y=t.getAttribute("stroke"):Vt(p),r.style["border-color"]=y,r.style["border-style"]="solid";break;case"lineWidth":var m=t.parsedStyle.lineWidth;r.style["border-width"]="".concat(m||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var k=t.style.filter;r.style.filter=k;break;default:!(0,ge.Z)(t.style[e])&&t.style[e]!==""&&(r.style[e]=t.style[e])}}}])}();Fi.tag="HTMLRendering";var el=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.name="html-renderer",e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"init",value:function(){this.addRenderingPlugin(new Fi)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(mt),tl=Object.freeze({__proto__:null,Plugin:el}),Gi=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"apply",value:function(e,t){var r=this,a=e.renderingService,o=e.renderingContext,s=e.config;this.context=e;var u=o.root.ownerDocument.defaultView,l=function(w){a.hooks.pointerMove.call(w)},c=function(w){a.hooks.pointerUp.call(w)},f=function(w){a.hooks.pointerDown.call(w)},h=function(w){a.hooks.pointerOver.call(w)},d=function(w){a.hooks.pointerOut.call(w)},v=function(w){a.hooks.pointerCancel.call(w)},g=function(w){a.hooks.pointerWheel.call(w)},p=function(w){a.hooks.click.call(w)},y=function(w){t.globalThis.document.addEventListener("pointermove",l,!0),w.addEventListener("pointerdown",f,!0),w.addEventListener("pointerleave",d,!0),w.addEventListener("pointerover",h,!0),t.globalThis.addEventListener("pointerup",c,!0),t.globalThis.addEventListener("pointercancel",v,!0)},m=function(w){w.addEventListener("touchstart",f,!0),w.addEventListener("touchend",c,!0),w.addEventListener("touchmove",l,!0),w.addEventListener("touchcancel",v,!0)},k=function(w){t.globalThis.document.addEventListener("mousemove",l,!0),w.addEventListener("mousedown",f,!0),w.addEventListener("mouseout",d,!0),w.addEventListener("mouseover",h,!0),t.globalThis.addEventListener("mouseup",c,!0)},x=function(w){t.globalThis.document.removeEventListener("pointermove",l,!0),w.removeEventListener("pointerdown",f,!0),w.removeEventListener("pointerleave",d,!0),w.removeEventListener("pointerover",h,!0),t.globalThis.removeEventListener("pointerup",c,!0),t.globalThis.removeEventListener("pointercancel",v,!0)},L=function(w){w.removeEventListener("touchstart",f,!0),w.removeEventListener("touchend",c,!0),w.removeEventListener("touchmove",l,!0),w.removeEventListener("touchcancel",v,!0)},O=function(w){t.globalThis.document.removeEventListener("mousemove",l,!0),w.removeEventListener("mousedown",f,!0),w.removeEventListener("mouseout",d,!0),w.removeEventListener("mouseover",h,!0),t.globalThis.removeEventListener("mouseup",c,!0)};a.hooks.init.tap(n.tag,function(){var P=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(P.style.msContentZooming="none",P.style.msTouchAction="none"):u.supportsPointerEvents&&(P.style.touchAction="none"),u.supportsPointerEvents?y(P):k(P),u.supportsTouchEvents&&m(P),s.useNativeClickEvent&&P.addEventListener("click",p,!0),P.addEventListener("wheel",g,{passive:!0,capture:!0})}),a.hooks.destroy.tap(n.tag,function(){var P=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(P.style.msContentZooming="",P.style.msTouchAction=""):u.supportsPointerEvents&&(P.style.touchAction=""),u.supportsPointerEvents?x(P):O(P),u.supportsTouchEvents&&L(P),s.useNativeClickEvent&&P.removeEventListener("click",p,!0),P.removeEventListener("wheel",g,!0)})}}])}();Gi.tag="DOMInteraction";var nl=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.name="dom-interaction",e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"init",value:function(){this.addRenderingPlugin(new Gi)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(mt),rl=Object.freeze({__proto__:null,Plugin:nl}),Ui=function(){function n(){(0,S.Z)(this,n)}return(0,C.Z)(n,[{key:"apply",value:function(e){var t=e.renderingService,r=e.contextService,a=e.config,o=r.getDomElement(),s=function(g){t.hooks.pointerDown.call(g)},u=function(g){t.hooks.pointerUp.call(g)},l=function(g){t.hooks.pointerMove.call(g)},c=function(g){t.hooks.pointerOver.call(g)},f=function(g){t.hooks.pointerOut.call(g)},h=function(g){t.hooks.click.call(g)},d=function(g){t.hooks.pointerCancel.call(g)};t.hooks.init.tap(n.tag,function(){o.addEventListener("touchstart",s,!0),o.addEventListener("touchend",u,!0),o.addEventListener("touchmove",l,!0),o.addEventListener("touchcancel",d,!0),o.addEventListener("mouseout",f,!0),o.addEventListener("mouseover",c,!0),a.useNativeClickEvent&&o.addEventListener("click",h,!0)}),t.hooks.destroy.tap(n.tag,function(){o.removeEventListener("touchstart",s,!0),o.removeEventListener("touchend",u,!0),o.removeEventListener("touchmove",l,!0),o.removeEventListener("touchcancel",d,!0),o.removeEventListener("mouseout",f,!0),o.removeEventListener("mouseover",c,!0),a.useNativeClickEvent&&o.removeEventListener("click",h,!0)})}}])}();Ui.tag="MobileInteraction";var il=function(n){function i(){var e;(0,S.Z)(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=(0,Y.Z)(this,i,[].concat(r)),e.name="mobile-interaction",e}return(0,$.Z)(i,n),(0,C.Z)(i,[{key:"init",value:function(){this.addRenderingPlugin(new Ui)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(mt),Ll=Object.freeze({__proto__:null,Plugin:il})}}]);
