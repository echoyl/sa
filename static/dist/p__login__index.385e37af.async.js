"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{19034:function(tt,be,n){n.r(be),n.d(be,{default:function(){return Mn}});var Xe=n(15009),K=n.n(Xe),Je=n(99289),oe=n.n(Je),qe=n(97857),Q=n.n(qe),_e=n(5574),j=n.n(_e),en=n(56034),ge=n(45360),Ae=n(42075),Fe=n(55102),Re=n(14726),nn=n(74330),i=n(67294),ee=n(97584),e=n(85893),tn=function(r){var s=r.value,b=s===void 0?{}:s,A=r.onChange,x=r.reload,f=x===void 0?0:x,P=r.placeholder,U=P===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":P,N=(0,i.useState)(""),L=j()(N,2),d=L[0],V=L[1],Y=(0,i.useState)(""),D=j()(Y,2),E=D[0],X=D[1],W=(0,i.useState)(""),y=j()(W,2),Z=y[0],w=y[1],J=(0,i.useState)(!1),k=j()(J,2),G=k[0],z=k[1],C=function(){var q=oe()(K()().mark(function H(){var B;return K()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,(0,ee.xx)({key:E});case 3:if(B=p.sent,B.code!==0){p.next=6;break}return p.abrupt("return",B.data);case 6:p.next=12;break;case 8:return p.prev=8,p.t0=p.catch(0),ge.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),p.abrupt("return",[]);case 12:return ge.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),p.abrupt("return",[]);case 14:case"end":return p.stop()}},H,null,[[0,8]])}));return function(){return q.apply(this,arguments)}}(),g=function(H){A&&A(Q()(Q()({captchaCode:d,captchaKey:E},b),H))},T=function(H){z(!0),C().then(function(B){z(!1),X(B.key),w(B.img),H&&g({captchaKey:B.key})})};(0,i.useEffect)(function(){T(!1)},[]),(0,i.useEffect)(function(){f>0&&T(!0)},[f]);var h=function(H){var B=H.target.value||"";B&&V(B),g({captchaCode:B})},F=function(){T(!0)};return(0,e.jsxs)(Ae.Z,{children:[(0,e.jsx)(Fe.Z,{prefix:(0,e.jsx)(en.Z,{}),size:"large",placeholder:U,onChange:h}),(0,e.jsx)(Re.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)(nn.Z,{spinning:G,size:"small",children:(0,e.jsx)("img",{src:Z,onClick:F})})})]})},ve=tn,an=n(99702),rn=n(62871),he=n(64182),Le=n(73406),Be=n(87547),Ne=n(94149),on=n(71356),sn=n(84517),me=n(5966),se=n(34994),ln=n(97462),c=n(1413),le=n(74165),De=n(15861),fe=n(45987),pe=n(97685),un=n(8232),Ee=n(90789),cn=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],dn=i.forwardRef(function(a,r){var s=un.Z.useFormInstance(),b=(0,i.useState)(a.countDown||60),A=(0,pe.Z)(b,2),x=A[0],f=A[1],P=(0,i.useState)(!1),U=(0,pe.Z)(P,2),N=U[0],L=U[1],d=(0,i.useState)(),V=(0,pe.Z)(d,2),Y=V[0],D=V[1],E=a.rules,X=a.name,W=a.phoneName,y=a.fieldProps,Z=a.onTiming,w=a.captchaTextRender,J=w===void 0?function(C,g){return C?"".concat(g," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:w,k=a.captchaProps,G=(0,fe.Z)(a,cn),z=function(){var C=(0,De.Z)((0,le.Z)().mark(function g(T){return(0,le.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.prev=0,D(!0),F.next=4,G.onGetCaptcha(T);case 4:D(!1),L(!0),F.next=13;break;case 8:F.prev=8,F.t0=F.catch(0),L(!1),D(!1),console.log(F.t0);case 13:case"end":return F.stop()}},g,null,[[0,8]])}));return function(T){return C.apply(this,arguments)}}();return(0,i.useImperativeHandle)(r,function(){return{startTiming:function(){return L(!0)},endTiming:function(){return L(!1)}}}),(0,i.useEffect)(function(){var C=0,g=a.countDown;return N&&(C=window.setInterval(function(){f(function(T){return T<=1?(L(!1),clearInterval(C),g||60):T-1})},1e3)),function(){return clearInterval(C)}},[N]),(0,i.useEffect)(function(){Z&&Z(x)},[x,Z]),(0,e.jsxs)("div",{style:(0,c.Z)((0,c.Z)({},y==null?void 0:y.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[(0,e.jsx)(Fe.Z,(0,c.Z)((0,c.Z)({},y),{},{style:(0,c.Z)({flex:1,transition:"width .3s",marginRight:8},y==null?void 0:y.style)})),(0,e.jsx)(Re.ZP,(0,c.Z)((0,c.Z)({style:{display:"block"},disabled:N,loading:Y},k),{},{onClick:(0,De.Z)((0,le.Z)().mark(function C(){var g;return(0,le.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(h.prev=0,!W){h.next=9;break}return h.next=4,s.validateFields([W].flat(1));case 4:return g=s.getFieldValue([W].flat(1)),h.next=7,z(g);case 7:h.next=11;break;case 9:return h.next=11,z("");case 11:h.next=16;break;case 13:h.prev=13,h.t0=h.catch(0),console.log(h.t0);case 16:case"end":return h.stop()}},C,null,[[0,13]])})),children:J(N,x)}))]})}),gn=(0,Ee.G)(dn),vn=gn,hn=n(10915),mn=n(28459),fn=n(93967),pn=n.n(fn),Se=n(4942),Sn=n(98082),xn=function(r){return(0,Se.Z)((0,Se.Z)({},r.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:r.colorTextSecondary,fontSize:r.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),"@media (min-width: @screen-md-min)",(0,Se.Z)({},"".concat(r.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}))};function yn(a){return(0,Sn.Xj)("LoginForm",function(r){var s=(0,c.Z)((0,c.Z)({},r),{},{componentCls:".".concat(a)});return[xn(s)]})}var Cn=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function Zn(a){var r,s=a.logo,b=a.message,A=a.contentStyle,x=a.title,f=a.subTitle,P=a.actions,U=a.children,N=a.containerStyle,L=a.otherStyle,d=(0,fe.Z)(a,Cn),V=(0,hn.YB)(),Y=d.submitter===!1?!1:(0,c.Z)((0,c.Z)({searchConfig:{submitText:V.getMessage("loginForm.submitText","\u767B\u5F55")}},d.submitter),{},{submitButtonProps:(0,c.Z)({size:"large",style:{width:"100%"}},(r=d.submitter)===null||r===void 0?void 0:r.submitButtonProps),render:function(k,G){var z,C=G.pop();if(typeof(d==null||(z=d.submitter)===null||z===void 0?void 0:z.render)=="function"){var g,T;return d==null||(g=d.submitter)===null||g===void 0||(T=g.render)===null||T===void 0?void 0:T.call(g,k,G)}return C}}),D=(0,i.useContext)(mn.ZP.ConfigContext),E=D.getPrefixCls("pro-form-login"),X=yn(E),W=X.wrapSSR,y=X.hashId,Z=function(k){return"".concat(E,"-").concat(k," ").concat(y)},w=(0,i.useMemo)(function(){return s?typeof s=="string"?(0,e.jsx)("img",{src:s}):s:null},[s]);return W((0,e.jsxs)("div",{className:pn()(Z("container"),y),style:N,children:[(0,e.jsxs)("div",{className:"".concat(Z("top")," ").concat(y).trim(),children:[x||w?(0,e.jsxs)("div",{className:"".concat(Z("header")),children:[w?(0,e.jsx)("span",{className:Z("logo"),children:w}):null,x?(0,e.jsx)("span",{className:Z("title"),children:x}):null]}):null,f?(0,e.jsx)("div",{className:Z("desc"),children:f}):null]}),(0,e.jsxs)("div",{className:Z("main"),style:(0,c.Z)({width:328},A),children:[(0,e.jsxs)(se.A,(0,c.Z)((0,c.Z)({isKeyPressSubmit:!0},d),{},{submitter:Y,children:[b,U]})),P?(0,e.jsx)("div",{className:Z("main-other"),style:L,children:P}):null]})]}))}var ke=n(22270),jn=n(84567),ze=n(55018),Pn=["options","fieldProps","proFieldProps","valueEnum"],Tn=i.forwardRef(function(a,r){var s=a.options,b=a.fieldProps,A=a.proFieldProps,x=a.valueEnum,f=(0,fe.Z)(a,Pn);return(0,e.jsx)(ze.Z,(0,c.Z)({ref:r,valueType:"checkbox",valueEnum:(0,ke.h)(x,void 0),fieldProps:(0,c.Z)({options:s},b),lightProps:(0,c.Z)({labelFormatter:function(){return(0,e.jsx)(ze.Z,(0,c.Z)({ref:r,valueType:"checkbox",mode:"read",valueEnum:(0,ke.h)(x,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,c.Z)({options:s},b),proFieldProps:A},f))}},f.lightProps),proFieldProps:A},f))}),In=i.forwardRef(function(a,r){var s=a.fieldProps,b=a.children;return(0,e.jsx)(jn.Z,(0,c.Z)((0,c.Z)({ref:r},s),{},{children:b}))}),bn=(0,Ee.G)(In,{valuePropName:"checked"}),Me=bn;Me.Group=Tn;var An=Me,ne=n(7837),Fn=n(26855),Rn=n(9361),Ln=n(97253),Bn=n(48096),$e=n(73935),xe=n(37233),Nn=n(38477),Dn=n(70853),m=n(34720),we=(0,Nn.kc)(function(a){var r=a.token,s=a.css;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:r.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:r.borderRadius,":hover":{backgroundColor:r.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),En=function(){var r=we(),s=r.styles;return(0,e.jsxs)("div",{className:s.lang,"data-lang":!0,children:[(0,e.jsx)(Dn.pD,{}),","]})},kn=function(){return(0,e.jsx)(zn,{})},zn=function(){var r,s,b,A,x,f,P,U=we(),N=U.styles,L=(0,ne.useModel)("@@initialState"),d=L.initialState,V=L.setInitialState,Y=(0,i.useState)(0),D=j()(Y,2),E=D[0],X=D[1],W=(0,i.useState)(0),y=j()(W,2),Z=y[0],w=y[1],J=(0,i.useState)(!1),k=j()(J,2),G=k[0],z=k[1],C=(0,i.useState)(!1),g=j()(C,2),T=g[0],h=g[1],F=(0,ne.useSearchParams)(),q=j()(F,1),H=q[0],B=ge.ZP.useMessage(),ye=j()(B,2),p=ye[0],$n=ye[1],wn=Fn.ZP.useNotification(),Ge=j()(wn,2),Gn=Ge[0],Wn=Ge[1],ue=(0,i.useContext)(he.DN),Hn=ue.clientId,Ce=ue.messageData,Ze=ue.bind,at=ue.setMessageData,Kn=(0,i.useState)(),We=j()(Kn,2),t=We[0],Un=We[1],Vn=(0,i.useState)(),He=j()(Vn,2),te=He[0],Ke=He[1];(0,i.useEffect)(function(){(0,Le.Zl)().then(function(l){var o;Un(l),Ke(l==null||(o=l.adminSetting)===null||o===void 0?void 0:o.loginTypeDefault)})},[]);var Ue=function(o){Ze==null||Ze();var M=(0,Le.Y0)(o.setting);V(function(I){return Q()(Q()({},I),{},{currentUser:o.userinfo,settings:M})}).then(function(){var I,v="/",$="/";if(o.userinfo.redirect)$=o.userinfo.redirect;else if(d!=null&&(I=d.settings)!==null&&I!==void 0&&(I=I.adminSetting)!==null&&I!==void 0&&I.baseurl){var u;$=v.replace(d==null||(u=d.settings)===null||u===void 0||(u=u.adminSetting)===null||u===void 0?void 0:u.baseurl,"/")}ne.history.push($)})};(0,i.useEffect)(function(){if(Ce){var l=Ce.data;(l==null?void 0:l.action)=="login"&&(xe.Z.set("Sa-Remember",1),(0,ee.MU)(l.access_token).then(function(){p.success({content:l.msg,duration:1,onClose:function(){(0,$e.flushSync)(function(){Ue(l)})}})}))}},[Ce]);var On=function(){var l=oe()(K()().mark(function o(M){return K()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,ee.ZP.post("login",{data:Q()(Q()({},M),{},{loginType:te}),duration:1,then:function(u){var _=u.code,O=u.msg,ae=u.data;u.code?(Gn.error({description:O,message:"\u63D0\u793A"}),te=="phone"&&u.code==3&&w(E+1),G&&X(E+1),(u.code==3||u.code==2)&&z(!0)):(M.autoLogin?xe.Z.set("Sa-Remember",1):xe.Z.set("Sa-Remember",0),(0,ee.MU)(u.data.access_token).then(function(){p.success({content:O,duration:1,onClose:function(){(0,$e.flushSync)(function(){Ue(u.data)})}})}))}});case 2:return v.abrupt("return");case 3:case"end":return v.stop()}},o)}));return function(M){return l.apply(this,arguments)}}(),Ve=(0,i.useRef)(),S=(0,ne.useIntl)(),Qn=[{label:(0,m.t)("pages.login.phoneLogin.tab",S),key:"phone",children:te!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(me.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(Be.Z,{})},placeholder:(0,m.t)("pages.login.phoneNumber.placeholder",S),rules:[{required:!0,message:(0,m.t)("pages.login.phoneNumber.required",S)},{pattern:/^1\d{10}$/,message:(0,m.t)("pages.login.phoneNumber.invalid",S)}]}),(0,e.jsx)(se.A.Item,{name:"captchaPhone",rules:[{required:!0,message:(0,m.t)("pages.login.captcha.required",S)}],children:(0,e.jsx)(ve,{reload:Z,placeholder:(0,m.t)("pages.login.captcha.placeholder",S)})}),(0,e.jsx)(ln.Z,{name:["captchaPhone"],children:function(o){var M=o.captchaPhone;return(0,e.jsx)(vn,{fieldProps:{size:"large",prefix:(0,e.jsx)(Ne.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:(0,m.t)("pages.login.captcha.placeholder",S),captchaTextRender:function(v,$){return v?"".concat($," ").concat((0,m.t)("pages.login.phoneLogin.getVerificationCode",S)):(0,m.t)("pages.login.phoneLogin.getVerificationCode",S)},name:"mobilecode",rules:[{required:!0,message:(0,m.t)("pages.login.captcha.required",S)}],onGetCaptcha:function(){var I=oe()(K()().mark(function v($){var u,_,O,ae;return K()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.prev=0,R.next=3,(u=Ve.current)===null||u===void 0?void 0:u.validateFields(["captcha"]);case 3:R.next=8;break;case 5:throw R.prev=5,R.t0=R.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return R.next=10,ee.ZP.post("sms",{data:{mobile:$,captcha:M}});case 10:if(_=R.sent,O=_.code,ae=_.msg,!O){R.next=15;break}throw new Error(ae);case 15:case"end":return R.stop()}},v,null,[[0,5]])}));return function(v){return I.apply(this,arguments)}}()})}}),G&&(0,e.jsx)(se.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ve,{reload:E})})]})},{label:(0,m.t)("pages.login.accountLogin.tab",S),key:"password",children:te!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(me.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(Be.Z,{})},placeholder:(0,m.t)("pages.login.username.placeholder",S),rules:[{required:!0,message:(0,m.t)("pages.login.username.required",S)}]}),(0,e.jsx)(me.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(Ne.Z,{}),autoComplete:""},placeholder:(0,m.t)("pages.login.password.placeholder",S),rules:[{required:!0,message:(0,m.t)("pages.login.password.required",S)}]}),G&&(0,e.jsx)(se.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ve,{reload:E})})]})}],Yn=Rn.Z.useToken(),Xn=Yn.token,je={};if((t==null?void 0:t.navTheme)=="light"){var Pe;if(t!=null&&(Pe=t.adminSetting)!==null&&Pe!==void 0&&Pe.loginBgImgage){var Te;je.backgroundImage='url("'+(t==null||(Te=t.adminSetting)===null||Te===void 0?void 0:Te.loginBgImgage)+'")'}}else je.background=Xn.colorBgBase;var Jn=function(o){var M=o.type,I=(0,i.useState)(0),v=j()(I,2),$=v[0],u=v[1],_=(0,i.useState)("active"),O=j()(_,2),ae=O[0],ce=O[1],R=3*60,de,Oe=function re(ie){var nt=Date.now();nt>ie+R*1e3?ce("expired"):de=setTimeout(function(){return re(ie)},1e3)},qn=function(){var ie=Date.now();u(ie),ce("active"),de=setTimeout(function(){return Oe(ie)},1e3)};if((0,i.useEffect)(function(){var re=Date.now();return u(re),de=setTimeout(function(){return Oe(re)},1e3),function(){return clearTimeout(de)}},[]),M=="wechat"){var Ie,Qe=t==null||(Ie=t.adminSetting)===null||Ie===void 0?void 0:Ie.loginWechat,_n=Qe.url,et=Qe.desc,Ye=_n+"?client_id="+Hn+"&timestamp="+$;return console.log("qrcodeUrl",Ye),(0,e.jsxs)("div",{style:{textAlign:"center"},children:[$?(0,e.jsx)(Ln.Z,{style:{margin:"0 auto"},value:Ye,status:ae,onRefresh:qn}):null,(0,e.jsx)("div",{style:{marginTop:20},children:et})]})}return null};return t?(0,e.jsxs)(he.ZP,{children:[(0,e.jsx)(he.E0,{}),(0,e.jsxs)("div",{className:N.container,style:Q()({},je),children:[(0,e.jsx)(ne.Helmet,{children:(0,e.jsxs)("title",{children:["\u767B\u5F55 - ",t==null?void 0:t.title]})}),$n,Wn,t!=null&&(r=t.adminSetting)!==null&&r!==void 0&&r.lang?(0,e.jsx)(En,{}):null,(0,e.jsx)("div",{style:{flex:"1",padding:"48px 0"},children:(0,e.jsx)(sn.ZP,{style:{margin:"0px auto",background:t==null||(s=t.adminSetting)===null||s===void 0?void 0:s.loginBgCardColor,width:376},bodyStyle:{paddingTop:0,paddingBottom:0},className:N.card,children:(0,e.jsxs)(Zn,{contentStyle:{minWidth:280,maxWidth:"75vw"},containerStyle:{paddingInline:0},formRef:Ve,logo:t==null?void 0:t.logo,title:t==null?void 0:t.title,subTitle:t!=null&&(b=t.adminSetting)!==null&&b!==void 0&&b.subtitle?(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:t==null||(A=t.adminSetting)===null||A===void 0?void 0:A.subtitle}}):null,initialValues:{autoLogin:!0},onFinish:function(){var l=oe()(K()().mark(function o(M){return K()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,On(M);case 2:case"end":return v.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),actions:t!=null&&(x=t.adminSetting)!==null&&x!==void 0&&x.loginActions?(0,e.jsxs)(Ae.Z,{children:[(0,m.t)("pages.login.loginWith",S),(0,e.jsx)(rn.Z,{trigger:(0,e.jsx)(on.Z,{className:N.action}),width:350,title:"\u626B\u7801\u767B\u5F55",children:t==null||(f=t.adminSetting)===null||f===void 0||(f=f.loginActions)===null||f===void 0?void 0:f.map(function(l,o){return(0,e.jsx)(Jn,{type:l},o)})})]}):null,children:[(0,e.jsx)(Bn.Z,{centered:!0,activeKey:te,onChange:function(o){Ke(o),h(o=="phone")},items:(P=t.adminSetting)===null||P===void 0||(P=P.loginType)===null||P===void 0?void 0:P.map(function(l){return Qn.find(function(o){return o.key==l})})}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(An,{noStyle:!0,name:"autoLogin",children:(0,m.t)("pages.login.rememberMe",S)}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){p.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:(0,m.t)("pages.login.forgotPassword",S)})]})]})})}),(0,e.jsx)(an.Z,{})]})]}):null},Mn=kn}}]);
