"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{61865:function(ct,fe,t){t.r(fe),t.d(fe,{default:function(){return ut}});var Fe=t(15009),R=t.n(Fe),Be=t(97857),E=t.n(Be),Ie=t(99289),Y=t.n(Ie),Te=t(5574),b=t.n(Te),s=t(1413),l=t(67294),Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zm-405.8-201c-3-4.1-7.8-6.6-13-6.6H336c-6.5 0-10.3 7.4-6.5 12.7l126.4 174a16.1 16.1 0 0026 0l212.6-292.7c3.8-5.3 0-12.7-6.5-12.7h-55.2c-5.1 0-10 2.5-13 6.6L468.9 542.4l-64.7-89.1z"}}]},name:"safety-certificate",theme:"outlined"},be=Re,Ae=t(84089),he=function(r,i){return l.createElement(Ae.Z,(0,s.Z)((0,s.Z)({},r),{},{ref:i,icon:be}))};he.displayName="SafetyCertificateOutlined";var Le=l.forwardRef(he),re=t(45360),Ne=t(42075),ge=t(96365),me=t(15867),De=t(57953),_=t(33067),e=t(85893),Ee=function(r){var i=r.value,y=i===void 0?{}:i,C=r.onChange,f=r.reload,a=f===void 0?0:f,A=r.placeholder,z=A===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":A,I=(0,l.useState)(""),S=b()(I,2),h=S[0],w=S[1],M=(0,l.useState)(""),L=b()(M,2),k=L[0],W=L[1],N=(0,l.useState)(""),d=b()(N,2),g=d[0],D=d[1],K=(0,l.useState)(!1),$=b()(K,2),G=$[0],B=$[1],v=function(){var O=Y()(R()().mark(function j(){var P;return R()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,(0,_.xx)({key:k});case 3:if(P=p.sent,P.code!==0){p.next=6;break}return p.abrupt("return",P.data);case 6:p.next=12;break;case 8:return p.prev=8,p.t0=p.catch(0),re.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),p.abrupt("return",[]);case 12:return re.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),p.abrupt("return",[]);case 14:case"end":return p.stop()}},j,null,[[0,8]])}));return function(){return O.apply(this,arguments)}}(),c=function(j){C&&C(E()(E()({captchaCode:h,captchaKey:k},y),j))},m=function(j){B(!0),v().then(function(P){B(!1),W(P.key),D(P.img),j&&c({captchaKey:P.key})})};(0,l.useEffect)(function(){m(!1)},[]),(0,l.useEffect)(function(){a>0&&m(!0)},[a]);var o=function(j){var P=j.target.value||"";P&&w(P),c({captchaCode:P})},Z=function(){m(!0)};return(0,e.jsxs)(Ne.Z,{children:[(0,e.jsx)(ge.Z,{prefix:(0,e.jsx)(Le,{}),size:"large",placeholder:z,onChange:o}),(0,e.jsx)(me.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)(De.Z,{spinning:G,size:"small",children:(0,e.jsx)("img",{src:g,onClick:Z})})})]})},ie=Ee,$e=t(99702),pe=t(87547),Se=t(94149),ze=t(84517),se=t(5966),ee=t(34994),we=t(97462),te=t(74165),xe=t(15861),le=t(91),oe=t(97685),Me=t(40741),ye=t(90789),ke=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],Ge=l.forwardRef(function(n,r){var i=Me.Z.useFormInstance(),y=(0,l.useState)(n.countDown||60),C=(0,oe.Z)(y,2),f=C[0],a=C[1],A=(0,l.useState)(!1),z=(0,oe.Z)(A,2),I=z[0],S=z[1],h=(0,l.useState)(),w=(0,oe.Z)(h,2),M=w[0],L=w[1],k=n.rules,W=n.name,N=n.phoneName,d=n.fieldProps,g=n.onTiming,D=n.captchaTextRender,K=D===void 0?function(v,c){return v?"".concat(c," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:D,$=n.captchaProps,G=(0,le.Z)(n,ke),B=function(){var v=(0,xe.Z)((0,te.Z)().mark(function c(m){return(0,te.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,L(!0),Z.next=4,G.onGetCaptcha(m);case 4:L(!1),S(!0),Z.next=13;break;case 8:Z.prev=8,Z.t0=Z.catch(0),S(!1),L(!1),console.log(Z.t0);case 13:case"end":return Z.stop()}},c,null,[[0,8]])}));return function(m){return v.apply(this,arguments)}}();return(0,l.useImperativeHandle)(r,function(){return{startTiming:function(){return S(!0)},endTiming:function(){return S(!1)}}}),(0,l.useEffect)(function(){var v=0,c=n.countDown;return I&&(v=window.setInterval(function(){a(function(m){return m<=1?(S(!1),clearInterval(v),c||60):m-1})},1e3)),function(){return clearInterval(v)}},[I]),(0,l.useEffect)(function(){g&&g(f)},[f,g]),(0,e.jsxs)("div",{style:(0,s.Z)((0,s.Z)({},d==null?void 0:d.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[(0,e.jsx)(ge.Z,(0,s.Z)((0,s.Z)({},d),{},{style:(0,s.Z)({flex:1,transition:"width .3s",marginRight:8},d==null?void 0:d.style)})),(0,e.jsx)(me.ZP,(0,s.Z)((0,s.Z)({style:{display:"block"},disabled:I,loading:M},$),{},{onClick:(0,xe.Z)((0,te.Z)().mark(function v(){var c;return(0,te.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,!N){o.next=9;break}return o.next=4,i.validateFields([N].flat(1));case 4:return c=i.getFieldValue([N].flat(1)),o.next=7,B(c);case 7:o.next=11;break;case 9:return o.next=11,B("");case 11:o.next=16;break;case 13:o.prev=13,o.t0=o.catch(0),console.log(o.t0);case 16:case"end":return o.stop()}},v,null,[[0,13]])})),children:K(I,f)}))]})}),Oe=(0,ye.G)(Ge),He=Oe,We=t(10915),Ke=t(28459),Ve=t(94184),Ue=t.n(Ve),ue=t(4942),Xe=t(98082),Ye=function(r){var i;return i={},(0,ue.Z)(i,r.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:r.colorTextSecondary,fontSize:r.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),(0,ue.Z)(i,"@media (min-width: @screen-md-min)",(0,ue.Z)({},"".concat(r.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"})),i};function Je(n){return(0,Xe.Xj)("LoginForm",function(r){var i=(0,s.Z)((0,s.Z)({},r),{},{componentCls:".".concat(n)});return[Ye(i)]})}var Qe=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function qe(n){var r,i=n.logo,y=n.message,C=n.contentStyle,f=n.title,a=n.subTitle,A=n.actions,z=n.children,I=n.containerStyle,S=n.otherStyle,h=(0,le.Z)(n,Qe),w=(0,We.YB)(),M=h.submitter===!1?!1:(0,s.Z)((0,s.Z)({searchConfig:{submitText:w.getMessage("loginForm.submitText","\u767B\u5F55")}},h.submitter),{},{submitButtonProps:(0,s.Z)({size:"large",style:{width:"100%"}},(r=h.submitter)===null||r===void 0?void 0:r.submitButtonProps),render:function($,G){var B,v=G.pop();if(typeof(h==null||(B=h.submitter)===null||B===void 0?void 0:B.render)=="function"){var c,m;return h==null||(c=h.submitter)===null||c===void 0||(m=c.render)===null||m===void 0?void 0:m.call(c,$,G)}return v}}),L=(0,l.useContext)(Ke.ZP.ConfigContext),k=L.getPrefixCls("pro-form-login"),W=Je(k),N=W.wrapSSR,d=W.hashId,g=function($){return"".concat(k,"-").concat($," ").concat(d)},D=(0,l.useMemo)(function(){return i?typeof i=="string"?(0,e.jsx)("img",{src:i}):i:null},[i]);return N((0,e.jsxs)("div",{className:Ue()(g("container"),d),style:I,children:[(0,e.jsxs)("div",{className:"".concat(g("top")," ").concat(d).trim(),children:[f||D?(0,e.jsxs)("div",{className:"".concat(g("header")),children:[D?(0,e.jsx)("span",{className:g("logo"),children:D}):null,f?(0,e.jsx)("span",{className:g("title"),children:f}):null]}):null,a?(0,e.jsx)("div",{className:g("desc"),children:a}):null]}),(0,e.jsxs)("div",{className:g("main"),style:(0,s.Z)({width:328},C),children:[(0,e.jsxs)(ee.A,(0,s.Z)((0,s.Z)({isKeyPressSubmit:!0},h),{},{submitter:M,children:[y,z]})),A?(0,e.jsx)("div",{className:g("main-other"),style:S,children:A}):null]})]}))}var Ce=t(22270),_e=t(84567),Ze=t(19323),et=["options","fieldProps","proFieldProps","valueEnum"],tt=l.forwardRef(function(n,r){var i=n.options,y=n.fieldProps,C=n.proFieldProps,f=n.valueEnum,a=(0,le.Z)(n,et);return(0,e.jsx)(Ze.Z,(0,s.Z)({ref:r,valueType:"checkbox",valueEnum:(0,Ce.h)(f,void 0),fieldProps:(0,s.Z)({options:i},y),lightProps:(0,s.Z)({labelFormatter:function(){return(0,e.jsx)(Ze.Z,(0,s.Z)({ref:r,valueType:"checkbox",mode:"read",valueEnum:(0,Ce.h)(f,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,s.Z)({options:i},y),proFieldProps:C},a))}},a.lightProps),proFieldProps:C},a))}),at=l.forwardRef(function(n,r){var i=n.fieldProps,y=n.children;return(0,e.jsx)(_e.Z,(0,s.Z)((0,s.Z)({ref:r},i),{},{children:y}))}),nt=(0,ye.G)(at,{valuePropName:"checked"}),je=nt;je.Group=tt;var rt=je,U=t(7837),it=t(3321),st=t(48096),lt=t(73935),J={container:"container___ldtvs",lang:"lang___qrAB8",content:"content___wB3e_","ant-pro-form-login-container":"ant-pro-form-login-container___Z1bnX",icon:"icon___CBYA8"},dt=function(r){var i=r.content;return _jsx(Alert,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},ot=function(){var r,i,y,C,f=(0,U.useModel)("@@initialState"),a=f.initialState,A=f.setInitialState,z=(0,l.useState)(0),I=b()(z,2),S=I[0],h=I[1],w=(0,l.useState)(0),M=b()(w,2),L=M[0],k=M[1],W=(0,l.useState)(!1),N=b()(W,2),d=N[0],g=N[1],D=(0,U.useSearchParams)(),K=b()(D,1),$=K[0],G=re.ZP.useMessage(),B=b()(G,2),v=B[0],c=B[1],m=function(){var H=Y()(R()().mark(function T(V){return R()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,_.ZP.post("login",{data:E()(E()({},V),{},{loginType:j}),duration:1,msgcls:function(){var Q=Y()(R()().mark(function X(F){return R()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:F.code?(j=="phone"&&F.code==3&&k(S+1),d&&h(S+1),(F.code==3||F.code==2)&&g(!0)):F.code||(V.autoLogin?localStorage.setItem("Sa-Remember","1"):localStorage.setItem("Sa-Remember","0"),localStorage.setItem(_.lH,F.data.access_token),(0,lt.flushSync)(function(){A(function(u){return E()(E()({},u),{},{currentUser:F.data.userinfo,settings:E()(E()({},u==null?void 0:u.settings),F.data.setting)})}).then(function(){var u,Pe="/";if(F.data.userinfo.redirect)U.history.push(F.data.userinfo.redirect);else if(a!=null&&(u=a.settings)!==null&&u!==void 0&&u.baseurl){var ve;U.history.push(Pe.replace(a==null||(ve=a.settings)===null||ve===void 0?void 0:ve.baseurl,"/"))}else U.history.push(Pe)})}));case 1:case"end":return ne.stop()}},X)}));function q(X){return Q.apply(this,arguments)}return q}()});case 2:return x.abrupt("return");case 3:case"end":return x.stop()}},T)}));return function(V){return H.apply(this,arguments)}}(),o={},Z=(0,l.useState)(a==null||(r=a.settings)===null||r===void 0?void 0:r.loginTypeDefault),O=b()(Z,2),j=O[0],P=O[1];a!=null&&(i=a.settings)!==null&&i!==void 0&&i.loginBgImgage&&(o.backgroundImage='url("'+(a==null?void 0:a.settings.loginBgImgage)+'")');var ce=(0,l.useRef)(),p=[{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"phone",children:j!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(pe.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"},{pattern:/^1\d{10}$/,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"}]}),(0,e.jsx)(ee.A.Item,{name:"captchaPhone",rules:[{required:!0,message:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ie,{reload:L,placeholder:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"})}),(0,e.jsx)(we.Z,{name:["captchaPhone"],children:function(T){var V=T.captchaPhone;return(0,e.jsx)(He,{fieldProps:{size:"large",prefix:(0,e.jsx)(Se.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(x,Q){return x?"".concat(Q," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"mobilecode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"}],onGetCaptcha:function(){var ae=Y()(R()().mark(function x(Q){var q,X,F,de;return R()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(q=ce.current)===null||q===void 0?void 0:q.validateFields(["captcha"]);case 3:u.next=8;break;case 5:throw u.prev=5,u.t0=u.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return u.next=10,_.ZP.post("sms",{data:{mobile:Q,captcha:V}});case 10:if(X=u.sent,F=X.code,de=X.msg,!F){u.next=15;break}throw new Error(de);case 15:case"end":return u.stop()}},x,null,[[0,5]])}));return function(x){return ae.apply(this,arguments)}}()})}}),d&&(0,e.jsx)(ee.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ie,{reload:S})})]})},{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"password",children:j!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(pe.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]}),(0,e.jsx)(se.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(Se.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),d&&(0,e.jsx)(ee.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ie,{reload:S})})]})}];return(0,e.jsx)(it.Z,{children:(0,e.jsxs)("div",{className:J.container,style:E()({},o),children:[(0,e.jsx)(U.Helmet,{children:(0,e.jsxs)("title",{children:["\u767B\u5F55 - ",a==null||(y=a.settings)===null||y===void 0?void 0:y.title]})}),(0,e.jsx)("div",{className:J.content,children:(0,e.jsxs)(ze.ZP,{style:{margin:"60px auto",padding:"20px 0",background:o.backgroundImage?"#fff":"none"},children:[c,(0,e.jsxs)(qe,{contentStyle:{minWidth:280,maxWidth:"75vw"},containerStyle:{paddingInline:0},formRef:ce,logo:a==null?void 0:a.settings.logo,title:a==null?void 0:a.settings.title,subTitle:a==null?void 0:a.settings.subtitle,initialValues:{autoLogin:!0},onFinish:function(){var H=Y()(R()().mark(function T(V){return R()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,m(V);case 2:case"end":return x.stop()}},T)}));return function(T){return H.apply(this,arguments)}}(),children:[(0,e.jsx)(st.Z,{centered:!0,activeKey:j,onChange:function(T){return P(T)},items:a==null||(C=a.settings.loginType)===null||C===void 0?void 0:C.map(function(H){return p.find(function(T){return T.key==H})})}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(rt,{noStyle:!0,name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){v.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:"\u5FD8\u8BB0\u5BC6\u7801"})]})]})]})}),(0,e.jsx)($e.Z,{})]})})},ut=ot}}]);
