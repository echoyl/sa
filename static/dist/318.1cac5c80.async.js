"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[318],{55318:function(He,H,t){t.r(H),t.d(H,{default:function(){return Ce}});var se=t(19632),f=t.n(se),le=t(15009),J=t.n(le),de=t(99289),ue=t.n(de),oe=t(5574),y=t.n(oe),ve=t(68400),ce=t.n(ve),fe=t(97857),u=t.n(fe),K=t(97584),A=t(51042),me=t(79090),ge=t(14726),he=t(9361),Q=t(36457),xe=t(40411),ye=t(96917),m=t(67294),F=t(60887),U=t(45587),je=t(97133),pe=t(73219),n=t(85893),W,Se=function(i){var N=i.originNode,L=i.file,o=(0,U.nB)({id:L.uid}),B=o.attributes,D=o.listeners,g=o.setNodeRef,j=o.transform,v=o.transition,h=o.isDragging,p={cursor:"move",transition:"unset",height:"100%",width:"100%"},I=j?u()(u()({},p),{},{transform:"translate3d(".concat(j.x,"px, ").concat(j.y,"px, 0)"),transition:h?"unset":v},h?{zIndex:9999}:{}):p,O=h?(0,je.iv)(W||(W=ce()([`
        a {
          pointer-events: none;
        }
      `]))):"";return(0,n.jsx)("div",u()(u()(u()({ref:g,style:I,className:O},B),D),{},{children:L.status==="error"&&h?N.props.children:N}))},Te=function(i){var N=(0,m.useState)(),L=y()(N,2),o=L[0],B=L[1];(0,m.useEffect)(function(){(0,K.hu)().then(function(r){B(r)})},[]);var D=i.max,g=D===void 0?1:D,j=i.type,v=j===void 0?"image":j,h=i.value,p=h===void 0?[]:h,I=i.size,O=I===void 0?0:I,X=i.accept,Pe=X===void 0?v=="image"?"image/*":"application/*,text/*":X,Y=i.fieldProps,S=Y===void 0?{name:"file",listType:"picture-card",data:{toSize:O,isFile:v=="image"?0:1}}:Y,$=i.buttonType,c=$===void 0?"card":$,w=i.readonly,z=w===void 0?!1:w,Re=(0,m.useState)(p&&typeof p!="string"?p:[]),k=y()(Re,2),a=k[0],P=k[1],Ze=(0,m.useContext)(pe.r),E=Ze.notificationApi,Ne=(0,m.useState)(!1),q=y()(Ne,2),De=q[0],_=q[1],Ie=(0,m.useState)(0),ee=y()(Ie,2),ze=ee[0],te=ee[1],Ee=(0,m.useState)(!1),ae=y()(Ee,2),b=ae[0],V=ae[1];S.maxCount=g,S.multiple=g>1,S.accept=Pe;var be=function(){var r=ue()(J()().mark(function e(l){return J()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(v!="file"){d.next=2;break}return d.abrupt("return");case 2:a.forEach(function(T,C){l.uid==T.uid&&te(C)}),_(!0);case 4:case"end":return d.stop()}},e)}));return function(l){return r.apply(this,arguments)}}();v=="image"&&(S.onPreview=be);var Ae=(0,n.jsxs)("div",{children:[(0,n.jsx)(A.Z,{}),(0,n.jsx)("div",{style:{marginTop:4},children:v=="image"?"\u9009\u56FE\u7247":"\u9009\u6587\u4EF6"}),(0,n.jsxs)("div",{children:[a.length,"/",g]})]}),Fe=c=="card"||c=="table"?(0,n.jsxs)("div",{children:[b?(0,n.jsx)(me.Z,{}):(0,n.jsx)(A.Z,{}),(0,n.jsx)("div",{style:{marginTop:8},children:v=="image"?"\u9009\u56FE\u7247":"\u9009\u6587\u4EF6"})]}):(0,n.jsx)(ge.ZP,{icon:(0,n.jsx)(A.Z,{}),children:v=="image"?"\u9009\u56FE\u7247":"\u9009\u6587\u4EF6"}),Ue=(0,F.VT)(F.we,{activationConstraint:{distance:10}}),Be=function(e){var l=e.active,s=e.over;if(l.id!==(s==null?void 0:s.id)){var d,T=a.findIndex(function(x){return x.uid===l.id}),C=a.findIndex(function(x){return x.uid===(s==null?void 0:s.id)}),R=(0,U.Rp)(a,T,C);P(f()(R)),(d=i.onChange)===null||d===void 0||d.call(i,f()(R))}},ne=function(e){if(e.file.status==="uploading"&&(V(!0),P(f()(e.fileList))),e.file.status==="done"){var l=e.file.response,s=l.code,d=l.msg,T=l.data,C=a.findIndex(function(Z){return Z.uid==e.file.uid}),R={uid:e.file.uid,name:e.file.name,url:s?"":T.src,value:s?"":T.url,status:s?"error":"done"};if(C>=0?a.splice(C,1,R):a.push(R),s)e.file.status="error",e.file.errorMsg=d;else{var x;(x=i.onChange)===null||x===void 0||x.call(i,f()(a))}P(f()(a)),V(!1)}if(e.file.status==="removed"){var G,re=a.filter(function(Z){return Z.uid!=e.file.uid});(G=i.onChange)===null||G===void 0||G.call(i,f()(re)),P(re)}if(e.file.status==="error"){var M;E==null||(M=E.error)===null||M===void 0||M.call(E,{description:"".concat(e.file.name," \u4E0A\u4F20\u5931\u8D25. ").concat(e.file.errorMsg),message:"\u63D0\u793A"});var Me=a.findIndex(function(Z){return Z.uid==e.file.uid});a.splice(Me,1),P(f()(a)),V(!1)}},ie=K.m7+"uploader/index",Oe=he.Z.useToken,Ve=Oe(),Ge=Ve.token;return(0,n.jsxs)(n.Fragment,{children:[g==1||z?(0,n.jsx)(Q.Z,u()(u()({},S),{},{headers:o,listType:c=="card"||c=="table"?"picture-card":"text",className:c=="table"?"sa-upload-list sa-upload-list-table":"sa-upload-list",showUploadList:a.length&&!b?{showRemoveIcon:!z}:!1,action:ie,fileList:a.length?[a[0]]:[],onChange:ne,itemRender:function(e){return(0,n.jsx)(xe.Z,{color:Ge.colorPrimary,count:a.length>1&&z?a.length:0,size:"small",offset:[-10,10],styles:{root:{height:"100%",width:"100%"}},children:e})},children:a.length&&!b||z?null:Fe})):(0,n.jsx)(F.LB,{sensors:[Ue],onDragEnd:Be,children:(0,n.jsx)(U.Fo,{items:a.map(function(r){return r.uid}),children:(0,n.jsx)(Q.Z,u()(u()({},S),{},{headers:o,action:ie,listType:c=="card"||c=="table"?"picture-card":"text",className:c=="table"?"sa-upload-list sa-upload-list-table":"sa-upload-list",itemRender:function(e,l){return(0,n.jsx)(Se,{originNode:e,file:l})},fileList:a,onChange:ne,children:a.length&&a.length==g&&!b?null:Ae}))})}),a.length>0&&(0,n.jsx)("div",{style:{display:"none"},children:(0,n.jsx)(ye.Z.PreviewGroup,{preview:{visible:De,current:ze,onVisibleChange:function(e){_(e)},onChange:function(e){te(e)}},items:a.map(function(r){if(r.url){var e=r.url.split("?"),l=y()(e,1),s=l[0];return s}else return""})})})]})},Ce=Te}}]);
