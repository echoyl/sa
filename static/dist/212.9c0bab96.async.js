!(function(){var BM=($t,W)=>(W=Symbol[$t])?W:Symbol.for("Symbol."+$t),bte=$t=>{throw TypeError($t)},vf=Math.pow;var FM=($t,W,D)=>new Promise((ee,X)=>{var E=fe=>{try{re(D.next(fe))}catch(ae){X(ae)}},ve=fe=>{try{re(D.throw(fe))}catch(ae){X(ae)}},re=fe=>fe.done?ee(fe.value):Promise.resolve(fe.value).then(E,ve);re((D=D.apply($t,W)).next())}),xte=function($t,W){this[0]=$t,this[1]=W};var Sk=$t=>{var W=$t[BM("asyncIterator")],D=!1,ee,X={};return W==null?(W=$t[BM("iterator")](),ee=E=>X[E]=ve=>W[E](ve)):(W=W.call($t),ee=E=>X[E]=ve=>{if(D){if(D=!1,E==="throw")throw ve;return ve}return D=!0,{done:!1,value:new xte(new Promise(re=>{var fe=W[E](ve);fe instanceof Object||bte("Object expected"),re(fe)}),1)}}),X[BM("iterator")]=()=>X,ee("next"),"throw"in W?ee("throw"):X.throw=E=>{throw E},"return"in W&&ee("return"),X};(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[212],{25330:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};W.default=D},67303:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};W.default=D},83647:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};W.default=D},57583:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};W.default=D},29260:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"};W.default=D},25828:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};W.default=D},64183:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var fe,ae=1,Ee=arguments.length;ae<Ee;ae++){fe=arguments[ae];for(var oe in fe)Object.prototype.hasOwnProperty.call(fe,oe)&&(re[oe]=fe[oe])}return re},E.apply(this,arguments)},ve=(0,ee.forwardRef)(function(re,fe){return ee.createElement(X.P,E({},re,{chartType:"Area",ref:fe}))});W.Z=ve},79611:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var fe,ae=1,Ee=arguments.length;ae<Ee;ae++){fe=arguments[ae];for(var oe in fe)Object.prototype.hasOwnProperty.call(fe,oe)&&(re[oe]=fe[oe])}return re},E.apply(this,arguments)},ve=(0,ee.forwardRef)(function(re,fe){return ee.createElement(X.P,E({},re,{chartType:"Bar",ref:fe}))});W.Z=ve},7366:function($t,W,D){"use strict";D.d(W,{P:function(){return mte}});var ee={};D.r(ee),D.d(ee,{area:function(){return Ak},bottom:function(){return Nv},bottomLeft:function(){return Nv},bottomRight:function(){return Nv},inside:function(){return Nv},left:function(){return Nv},outside:function(){return Rk},right:function(){return Nv},spider:function(){return Lk},surround:function(){return Nk},top:function(){return Nv},topLeft:function(){return Nv},topRight:function(){return Nv}});var X={};D.r(X),D.d(X,{interpolateBlues:function(){return v9},interpolateBrBG:function(){return $7},interpolateBuGn:function(){return i9},interpolateBuPu:function(){return o9},interpolateCividis:function(){return E9},interpolateCool:function(){return O9},interpolateCubehelixDefault:function(){return A9},interpolateGnBu:function(){return a9},interpolateGreens:function(){return g9},interpolateGreys:function(){return y9},interpolateInferno:function(){return B9},interpolateMagma:function(){return N9},interpolateOrRd:function(){return s9},interpolateOranges:function(){return x9},interpolatePRGn:function(){return K7},interpolatePiYG:function(){return q7},interpolatePlasma:function(){return F9},interpolatePuBu:function(){return c9},interpolatePuBuGn:function(){return l9},interpolatePuOr:function(){return Q7},interpolatePuRd:function(){return u9},interpolatePurples:function(){return _9},interpolateRainbow:function(){return R9},interpolateRdBu:function(){return J7},interpolateRdGy:function(){return e9},interpolateRdPu:function(){return f9},interpolateRdYlBu:function(){return t9},interpolateRdYlGn:function(){return n9},interpolateReds:function(){return b9},interpolateSinebow:function(){return I9},interpolateSpectral:function(){return r9},interpolateTurbo:function(){return L9},interpolateViridis:function(){return D9},interpolateWarm:function(){return C9},interpolateYlGn:function(){return d9},interpolateYlGnBu:function(){return h9},interpolateYlOrBr:function(){return p9},interpolateYlOrRd:function(){return m9},schemeAccent:function(){return E7},schemeBlues:function(){return $I},schemeBrBG:function(){return OI},schemeBuGn:function(){return FI},schemeBuPu:function(){return kI},schemeCategory10:function(){return x7},schemeDark2:function(){return S7},schemeGnBu:function(){return zI},schemeGreens:function(){return KI},schemeGreys:function(){return qI},schemeObservable10:function(){return T7},schemeOrRd:function(){return UI},schemeOranges:function(){return e5},schemePRGn:function(){return RI},schemePaired:function(){return w7},schemePastel1:function(){return A7},schemePastel2:function(){return C7},schemePiYG:function(){return MI},schemePuBu:function(){return VI},schemePuBuGn:function(){return jI},schemePuOr:function(){return PI},schemePuRd:function(){return HI},schemePurples:function(){return QI},schemeRdBu:function(){return II},schemeRdGy:function(){return LI},schemeRdPu:function(){return ZI},schemeRdYlBu:function(){return DI},schemeRdYlGn:function(){return NI},schemeReds:function(){return JI},schemeSet1:function(){return O7},schemeSet2:function(){return R7},schemeSet3:function(){return M7},schemeSpectral:function(){return BI},schemeTableau10:function(){return P7},schemeYlGn:function(){return GI},schemeYlGnBu:function(){return WI},schemeYlOrBr:function(){return XI},schemeYlOrRd:function(){return YI}});var E={};D.r(E),D.d(E,{geoAlbers:function(){return JF},geoAlbersUsa:function(){return T$},geoAzimuthalEqualArea:function(){return w$},geoAzimuthalEqualAreaRaw:function(){return GR},geoAzimuthalEquidistant:function(){return A$},geoAzimuthalEquidistantRaw:function(){return XR},geoConicConformal:function(){return O$},geoConicConformalRaw:function(){return n8},geoConicEqualArea:function(){return rw},geoConicEqualAreaRaw:function(){return QF},geoConicEquidistant:function(){return M$},geoConicEquidistantRaw:function(){return r8},geoEqualEarth:function(){return I$},geoEqualEarthRaw:function(){return YR},geoEquirectangular:function(){return R$},geoEquirectangularRaw:function(){return g2},geoGnomonic:function(){return L$},geoGnomonicRaw:function(){return $R},geoIdentity:function(){return D$},geoMercator:function(){return C$},geoMercatorRaw:function(){return v2},geoNaturalEarth1:function(){return N$},geoNaturalEarth1Raw:function(){return KR},geoOrthographic:function(){return B$},geoOrthographicRaw:function(){return qR},geoProjection:function(){return Qm},geoProjectionMutator:function(){return ZR},geoStereographic:function(){return F$},geoStereographicRaw:function(){return QR},geoTransverseMercator:function(){return k$},geoTransverseMercatorRaw:function(){return JR}});var ve={};D.r(ve),D.d(ve,{frequency:function(){return kq},id:function(){return zq},name:function(){return Uq},weight:function(){return Fq}});var re=D(67294),fe=D(73935),ae=D.t(fe,2),Ee=function(){return Ee=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ee.apply(this,arguments)},oe=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},ze=function(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(p){return function(m){return h([p,m])}}function h(p){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(n=0)),n;)try{if(r=1,i&&(s=p[0]&2?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,i=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){n.label=p[1];break}if(p[0]===6&&n.label<s[1]){n.label=s[1],s=p;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(p);break}s[2]&&n.ops.pop(),n.trys.pop();continue}p=t.call(e,n)}catch(m){p=[6,m],i=0}finally{r=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},te=Ee({},ae),ye=te.version,De=te.render,Se=te.unmountComponentAtNode,we;try{var ce=Number((ye||"").split(".")[0]);ce>=18&&(we=te.createRoot)}catch(e){}function Ze(e){var t=te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&typeof t=="object"&&(t.usingClientEntryPoint=e)}var xt="__rc_react_root__";function ht(e,t){Ze(!0);var n=t[xt]||we(t);Ze(!1),n.render(e),t[xt]=n}function Gt(e,t){De(e,t)}function mt(e,t){}function gt(e,t){if(we){ht(e,t);return}Gt(e,t)}function Be(e){return oe(this,void 0,void 0,function(){return ze(this,function(t){return[2,Promise.resolve().then(function(){var n;(n=e[xt])===null||n===void 0||n.unmount(),delete e[xt]})]})})}function Re(e){Se(e)}function bt(e){}function yt(e){return oe(this,void 0,void 0,function(){return ze(this,function(t){return we!==void 0?[2,Be(e)]:(Re(e),[2])})})}var At=new Map;typeof document!="undefined"&&At.set("tooltip",document.createElement("div"));var bn=function(e,t){t===void 0&&(t=!1);var n=null;if(t)n=At.get("tooltip");else if(n=document.createElement("div"),e!=null&&e.key){var r=At.get(e.key);r?n=r:At.set(e.key,n)}return gt(e,n),n},He=function(e){if(typeof document=="undefined")return"loading";var t=e.attachShadow({mode:"open"}),n=document.createElement("div"),r=document.createElement("style");r.innerHTML=`.loading {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .loading div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #ccc;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
  }
  .loading div:nth-child(1) {
    left: 8px;
    animation: loading1 0.6s infinite;
  }
  .loading div:nth-child(2) {
    left: 8px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(3) {
    left: 32px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(4) {
    left: 56px;
    animation: loading3 0.6s infinite;
  }
  @keyframes loading1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes loading3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes loading2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  `,n.classList.add("loading"),n.innerHTML="<div></div><div></div><div></div><div></div>",t.appendChild(r),t.appendChild(n)},Rt=function(e){var t=e.loadingTemplate,n=e.theme,r=n===void 0?"light":n,i=re.useRef(null);re.useEffect(function(){!t&&i.current&&He(i.current)},[]);var s=function(){return t||re.createElement("div",{ref:i})};return re.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:r==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},s())},Oe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(e){Oe(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.state={hasError:!1},n.renderError=function(r){var i=n.props.errorTemplate;switch(r){default:return typeof i=="function"?i(r):i||re.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",r.message)}},n}return t.getDerivedStateFromError=function(n){return{hasError:!0,error:n}},t.getDerivedStateFromProps=function(n,r){return r.children!==n.children?{children:n.children,hasError:!1,error:void 0}:null},t.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):re.createElement(re.Fragment,null,this.props.children)},t}(re.Component),Qe=D(73234),$e=function(e){var t=/react|\.jsx|children:\[\(|return\s+[A-Za-z0-9].createElement\((?!['"][g|circle|ellipse|image|rect|line|polyline|polygon|text|path|html|mesh]['"])([^\)])*,/i;return t.test(e)},Ot=D(27771),vt=D(77226),Me=D(50576),Xt=D(68652),on=D(16423),Fn=function(){return Fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Fn.apply(this,arguments)},$n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function nr(e,t){var n=(0,re.useRef)(),r=(0,re.useRef)(),i=(0,re.useRef)(null),s=t.onReady,l=t.onEvent,u=function(m,y){var b;m===void 0&&(m="image/png");var w=(b=i.current)===null||b===void 0?void 0:b.getElementsByTagName("canvas")[0];return w==null?void 0:w.toDataURL(m,y)},h=function(m,y,b){m===void 0&&(m="download"),y===void 0&&(y="image/png");var w=m;m.indexOf(".")===-1&&(w="".concat(m,".").concat(y.split("/")[1]));var R=u(y,b),M=document.createElement("a");return M.href=R,M.download=w,document.body.appendChild(M),M.click(),document.body.removeChild(M),M=null,w},p=function(m,y){y===void 0&&(y=!1);var b=Object.keys(m),w=y;b.forEach(function(R){var M=m[R];R==="tooltip"&&(w=!0),(0,Qe.Z)(M)&&$e("".concat(M))?m[R]=function(){for(var I=[],N=0;N<arguments.length;N++)I[N]=arguments[N];return bn(M.apply(void 0,I),w)}:(0,Ot.Z)(M)?M.forEach(function(I){p(I,w)}):(0,vt.Z)(M)?p(M,w):w=y})};return(0,re.useEffect)(function(){if(n.current&&!(0,Me.Z)(r.current,t)){var m=!1;if(r.current){var y=r.current,b=y.data,w=$n(y,["data"]),R=t.data,M=$n(t,["data"]);m=(0,Me.Z)(w,M)}r.current=(0,Xt.Z)(t),m?n.current.changeData((0,on.Z)(t,"data")):(p(t),n.current.update(t),n.current.render())}},[t]),(0,re.useEffect)(function(){if(!i.current)return function(){return null};r.current||(r.current=(0,Xt.Z)(t)),p(t);var m=new e(i.current,Fn({},t));m.toDataURL=u,m.downloadImage=h,m.render(),n.current=m,s&&s(m);var y=function(b){l&&l(m,b)};return m.on("*",y),function(){n.current&&(n.current.destroy(),n.current.off("*",y),n.current=void 0)}},[]),{chart:n,container:i}}var Ht="*",Jt=function(){function e(){this._events={}}return e.prototype.on=function(t,n,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:n,once:!!r}),this},e.prototype.once=function(t,n){return this.on(t,n,!0)},e.prototype.emit=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=this._events[t]||[],l=this._events[Ht]||[],u=function(h){for(var p=h.length,m=0;m<p;m++)if(h[m]){var y=h[m],b=y.callback,w=y.once;w&&(h.splice(m,1),h.length===0&&delete n._events[t],p--,m--),b.apply(n,r)}};u(s),u(l)},e.prototype.off=function(t,n){if(!t)this._events={};else if(!n)delete this._events[t];else{for(var r=this._events[t]||[],i=r.length,s=0;s<i;s++)r[s].callback===n&&(r.splice(s,1),i--,s--);r.length===0&&delete this._events[t]}return this},e.prototype.getEvents=function(){return this._events},e}(),_n=Jt;const tr="main-layer",an="label-layer",Ut="element",Dt="view",Ie="plot",qe="component",Bt="label",j="area",le="mask";var z=D(97582),de=D(38554),Zt=de,nt=D(77160),St=D(85975),In=D(49685);function Wn(){var e=new In.WT(9);return In.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function qn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function hn(e){var t=new glMatrix.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function pt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Wt(e,t,n,r,i,s,l,u,h){var p=new In.WT(9);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=l,p[7]=u,p[8]=h,p}function An(e,t,n,r,i,s,l,u,h,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=l,e[6]=u,e[7]=h,e[8]=p,e}function Pn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Xn(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function dt(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8],y=m*l-u*p,b=-m*s+u*h,w=p*s-l*h,R=n*y+r*b+i*w;return R?(R=1/R,e[0]=y*R,e[1]=(-m*r+i*p)*R,e[2]=(u*r-i*l)*R,e[3]=b*R,e[4]=(m*n-i*h)*R,e[5]=(-u*n+i*s)*R,e[6]=w*R,e[7]=(-p*n+r*h)*R,e[8]=(l*n-r*s)*R,e):null}function be(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8];return e[0]=l*m-u*p,e[1]=i*p-r*m,e[2]=r*u-i*l,e[3]=u*h-s*m,e[4]=n*m-i*h,e[5]=i*s-n*u,e[6]=s*p-l*h,e[7]=r*h-n*p,e[8]=n*l-r*s,e}function Ne(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],l=e[5],u=e[6],h=e[7],p=e[8];return t*(p*s-l*h)+n*(-p*i+l*u)+r*(h*i-s*u)}function ot(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],p=t[6],m=t[7],y=t[8],b=n[0],w=n[1],R=n[2],M=n[3],I=n[4],N=n[5],U=n[6],Z=n[7],Y=n[8];return e[0]=b*r+w*l+R*p,e[1]=b*i+w*u+R*m,e[2]=b*s+w*h+R*y,e[3]=M*r+I*l+N*p,e[4]=M*i+I*u+N*m,e[5]=M*s+I*h+N*y,e[6]=U*r+Z*l+Y*p,e[7]=U*i+Z*u+Y*m,e[8]=U*s+Z*h+Y*y,e}function Pt(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],p=t[6],m=t[7],y=t[8],b=n[0],w=n[1];return e[0]=r,e[1]=i,e[2]=s,e[3]=l,e[4]=u,e[5]=h,e[6]=b*r+w*l+p,e[7]=b*i+w*u+m,e[8]=b*s+w*h+y,e}function It(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],p=t[6],m=t[7],y=t[8],b=Math.sin(n),w=Math.cos(n);return e[0]=w*r+b*l,e[1]=w*i+b*u,e[2]=w*s+b*h,e[3]=w*l-b*r,e[4]=w*u-b*i,e[5]=w*h-b*s,e[6]=p,e[7]=m,e[8]=y,e}function xn(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Qn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function br(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Jn(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function xe(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=n+n,u=r+r,h=i+i,p=n*l,m=r*l,y=r*u,b=i*l,w=i*u,R=i*h,M=s*l,I=s*u,N=s*h;return e[0]=1-y-R,e[3]=m-N,e[6]=b+I,e[1]=m+N,e[4]=1-p-R,e[7]=w-M,e[2]=b-I,e[5]=w+M,e[8]=1-p-y,e}function ke(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8],y=t[9],b=t[10],w=t[11],R=t[12],M=t[13],I=t[14],N=t[15],U=n*u-r*l,Z=n*h-i*l,Y=n*p-s*l,$=r*h-i*u,J=r*p-s*u,se=i*p-s*h,pe=m*M-y*R,Ce=m*I-b*R,Ue=m*N-w*R,Je=y*I-b*M,lt=y*N-w*M,Ge=b*N-w*I,at=U*Ge-Z*lt+Y*Je+$*Ue-J*Ce+se*pe;return at?(at=1/at,e[0]=(u*Ge-h*lt+p*Je)*at,e[1]=(h*Ue-l*Ge-p*Ce)*at,e[2]=(l*lt-u*Ue+p*pe)*at,e[3]=(i*lt-r*Ge-s*Je)*at,e[4]=(n*Ge-i*Ue+s*Ce)*at,e[5]=(r*Ue-n*lt-s*pe)*at,e[6]=(M*se-I*J+N*$)*at,e[7]=(I*Y-R*se-N*Z)*at,e[8]=(R*J-M*Y+N*U)*at,e):null}function tt(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Et(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function tn(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function fn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function _t(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function en(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function Gn(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function Tr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function jr(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],u=e[5],h=e[6],p=e[7],m=e[8],y=t[0],b=t[1],w=t[2],R=t[3],M=t[4],I=t[5],N=t[6],U=t[7],Z=t[8];return Math.abs(n-y)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-R)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(l-M)<=glMatrix.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-I)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(h-N)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(p-U)<=glMatrix.EPSILON*Math.max(1,Math.abs(p),Math.abs(U))&&Math.abs(m-Z)<=glMatrix.EPSILON*Math.max(1,Math.abs(m),Math.abs(Z))}var vr=null,Ur=null,Fr=D(98333);function qr(){var e=new In.WT(4);return In.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function wr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function fi(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function di(e,t){var n=Math.acos(t[3])*2,r=Math.sin(n/2);return r>glMatrix.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function vi(e,t){var n=Zr(e,t);return Math.acos(2*n*n-1)}function vo(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=n[0],h=n[1],p=n[2],m=n[3];return e[0]=r*m+l*u+i*p-s*h,e[1]=i*m+l*h+s*u-r*p,e[2]=s*m+l*p+r*h-i*u,e[3]=l*m-r*u-i*h-s*p,e}function Oi(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],l=t[3],u=Math.sin(n),h=Math.cos(n);return e[0]=r*h+l*u,e[1]=i*h+s*u,e[2]=s*h-i*u,e[3]=l*h-r*u,e}function Ko(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],l=t[3],u=Math.sin(n),h=Math.cos(n);return e[0]=r*h-s*u,e[1]=i*h+l*u,e[2]=s*h+r*u,e[3]=l*h-i*u,e}function va(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],l=t[3],u=Math.sin(n),h=Math.cos(n);return e[0]=r*h+i*u,e[1]=i*h-r*u,e[2]=s*h+l*u,e[3]=l*h-s*u,e}function Co(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function Xo(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=Math.sqrt(n*n+r*r+i*i),u=Math.exp(s),h=l>0?u*Math.sin(l)/l:0;return e[0]=n*h,e[1]=r*h,e[2]=i*h,e[3]=u*Math.cos(l),e}function Ye(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=Math.sqrt(n*n+r*r+i*i),u=l>0?Math.atan2(l,s)/l:0;return e[0]=n*u,e[1]=r*u,e[2]=i*u,e[3]=.5*Math.log(n*n+r*r+i*i+s*s),e}function Ke(e,t,n){return Ye(e,t),Li(e,e,n),Xo(e,e),e}function Ct(e,t,n,r){var i=t[0],s=t[1],l=t[2],u=t[3],h=n[0],p=n[1],m=n[2],y=n[3],b,w,R,M,I;return w=i*h+s*p+l*m+u*y,w<0&&(w=-w,h=-h,p=-p,m=-m,y=-y),1-w>In.Ib?(b=Math.acos(w),R=Math.sin(b),M=Math.sin((1-r)*b)/R,I=Math.sin(r*b)/R):(M=1-r,I=r),e[0]=M*i+I*h,e[1]=M*s+I*p,e[2]=M*l+I*m,e[3]=M*u+I*y,e}function sn(e){var t=glMatrix.RANDOM(),n=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=s*Math.sin(2*Math.PI*r),e[3]=s*Math.cos(2*Math.PI*r),e}function Ln(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=n*n+r*r+i*i+s*s,u=l?1/l:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=s*u,e}function zn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function mn(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,l=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[s*3+s]-t[l*3+l]+1),e[i]=.5*r,r=.5/r,e[3]=(t[s*3+l]-t[l*3+s])*r,e[s]=(t[s*3+i]+t[i*3+s])*r,e[l]=(t[l*3+i]+t[i*3+l])*r}return e}function wn(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var s=Math.sin(t),l=Math.cos(t),u=Math.sin(n),h=Math.cos(n),p=Math.sin(r),m=Math.cos(r);return e[0]=s*h*m-l*u*p,e[1]=l*u*m+s*h*p,e[2]=l*h*p-s*u*m,e[3]=l*h*m+s*u*p,e}function gr(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var mr=Fr.d9,ai=Fr.al,Vi=Fr.JG,fo=Fr.t8,ei=Fr.IH,zi=vo,Li=Fr.bA,Zr=Fr.AK,go=Fr.t7,Mi=Fr.kE,bo=null,Si=Fr.we,wo=null,Yo=Fr.Fv,Wa=Fr.I6,na=Fr.fS,jo=function(){var e=nt.Ue(),t=nt.al(1,0,0),n=nt.al(0,1,0);return function(r,i,s){var l=nt.AK(i,s);return l<-.999999?(nt.kC(e,t,i),nt.Zh(e)<1e-6&&nt.kC(e,n,i),nt.Fv(e,e),fi(r,e,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(nt.kC(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+l,Yo(r,r))}}(),Va=function(){var e=qr(),t=qr();return function(n,r,i,s,l,u){return Ct(e,r,l,u),Ct(t,i,s,u),Ct(n,e,t,2*u*(1-u)),n}}(),fs=function(){var e=Wn();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Yo(t,mn(t,e))}}(),Tt=D(31437),Ft=D(25897);function Dn(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var sr=D(95147),_i=D(95456),bi=function(e){return(0,_i.Z)(e,"String")},so=D(81957),Ha={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Bs(e){return Array.isArray(e)&&e.every(function(t){var n=t[0].toLowerCase();return Ha[n]===t.length-1&&"achlmqstvz".includes(n)})}function Os(e){return Bs(e)&&e.every(function(t){var n=t[0];return n===n.toUpperCase()})}function il(e){return Os(e)&&e.every(function(t){var n=t[0];return"ACLMQZ".includes(n)})}var Xf={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function zd(e){for(var t=e.pathValue[e.segmentStart],n=t.toLowerCase(),r=e.data;r.length>=Ha[n]&&(n==="m"&&r.length>2?(e.segments.push([t].concat(r.splice(0,2))),n="l",t=t==="m"?"l":"L"):e.segments.push([t].concat(r.splice(0,Ha[n]))),!!Ha[n]););}function md(e){var t=e.index,n=e.pathValue,r=n.charCodeAt(t);if(r===48){e.param=0,e.index+=1;return}if(r===49){e.param=1,e.index+=1;return}e.err='[path-util]: invalid Arc flag "'+n[t]+'", expecting 0 or 1 at index '+t}function Dl(e){return e>=48&&e<=57||e===43||e===45||e===46}function Qc(e){return e>=48&&e<=57}function Mf(e){var t=e.max,n=e.pathValue,r=e.index,i=r,s=!1,l=!1,u=!1,h=!1,p;if(i>=t){e.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(p=n.charCodeAt(i),(p===43||p===45)&&(i+=1,p=n.charCodeAt(i)),!Qc(p)&&p!==46){e.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" is not a number';return}if(p!==46){if(s=p===48,i+=1,p=n.charCodeAt(i),s&&i<t&&p&&Qc(p)){e.err="[path-util]: Invalid path value at index "+r+', "'+n[r]+'" illegal number';return}for(;i<t&&Qc(n.charCodeAt(i));)i+=1,l=!0;p=n.charCodeAt(i)}if(p===46){for(h=!0,i+=1;Qc(n.charCodeAt(i));)i+=1,u=!0;p=n.charCodeAt(i)}if(p===101||p===69){if(h&&!l&&!u){e.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" invalid float exponent';return}if(i+=1,p=n.charCodeAt(i),(p===43||p===45)&&(i+=1),i<t&&Qc(n.charCodeAt(i)))for(;i<t&&Qc(n.charCodeAt(i));)i+=1;else{e.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" invalid integer exponent';return}}e.index=i,e.param=+e.pathValue.slice(r,i)}function Jc(e){var t=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return e===10||e===13||e===8232||e===8233||e===32||e===9||e===11||e===12||e===160||e>=5760&&t.includes(e)}function Ic(e){for(var t=e.pathValue,n=e.max;e.index<n&&Jc(t.charCodeAt(e.index));)e.index+=1}function eu(e){switch(e|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function Yf(e){return(e|32)===97}function ac(e){var t=e.max,n=e.pathValue,r=e.index,i=n.charCodeAt(r),s=Ha[n[r].toLowerCase()];if(e.segmentStart=r,!eu(i)){e.err='[path-util]: Invalid path value "'+n[r]+'" is not a path command';return}if(e.index+=1,Ic(e),e.data=[],!s){zd(e);return}for(;;){for(var l=s;l>0;l-=1){if(Yf(i)&&(l===3||l===4)?md(e):Mf(e),e.err.length)return;e.data.push(e.param),Ic(e),e.index<t&&n.charCodeAt(e.index)===44&&(e.index+=1,Ic(e))}if(e.index>=e.max||!Dl(n.charCodeAt(e.index)))break}zd(e)}var Xs=function(){function e(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return e}();function Ru(e){if(Bs(e))return[].concat(e);var t=new Xs(e);for(Ic(t);t.index<t.max&&!t.err.length;)ac(t);return t.err?t.err:t.segments}function gf(e){if(Os(e))return[].concat(e);var t=Ru(e),n=0,r=0,i=0,s=0;return t.map(function(l){var u=l.slice(1).map(Number),h=l[0],p=h.toUpperCase();if(h==="M")return n=u[0],r=u[1],i=n,s=r,["M",n,r];var m;if(h!==p)switch(p){case"A":m=[p,u[0],u[1],u[2],u[3],u[4],u[5]+n,u[6]+r];break;case"V":m=[p,u[0]+r];break;case"H":m=[p,u[0]+n];break;default:{var y=u.map(function(w,R){return w+(R%2?r:n)});m=[p].concat(y)}}else m=[p].concat(u);var b=m.length;switch(p){case"Z":n=i,r=s;break;case"H":n=m[1];break;case"V":r=m[1];break;default:n=m[b-2],r=m[b-1],p==="M"&&(i=n,s=r)}return m})}function kh(e,t){var n=e[0],r=t.x1,i=t.y1,s=t.x2,l=t.y2,u=e.slice(1).map(Number),h=e;if("TQ".includes(n)||(t.qx=null,t.qy=null),n==="H")h=["L",e[1],i];else if(n==="V")h=["L",r,e[1]];else if(n==="S"){var p=r*2-s,m=i*2-l;t.x1=p,t.y1=m,h=["C",p,m].concat(u)}else if(n==="T"){var y=r*2-t.qx,b=i*2-t.qy;t.qx=y,t.qy=b,h=["Q",y,b].concat(u)}else if(n==="Q"){var w=u[0],R=u[1];t.qx=w,t.qy=R}return h}function zh(e){if(il(e))return[].concat(e);for(var t=gf(e),n=(0,z.pi)({},Xf),r=0;r<t.length;r+=1){t[r]=kh(t[r],n);var i=t[r],s=i.length;n.x1=+i[s-2],n.y1=+i[s-1],n.x2=+i[s-4]||n.x1,n.y2=+i[s-3]||n.y1}return t}function tu(e,t,n){var r=e[0],i=e[1],s=t[0],l=t[1];return[r+(s-r)*n,i+(l-i)*n]}function mh(e,t,n,r,i){var s=Dn([e,t],[n,r]),l={x:0,y:0};if(typeof i=="number")if(i<=0)l={x:e,y:t};else if(i>=s)l={x:n,y:r};else{var u=tu([e,t],[n,r],i/s),h=u[0],p=u[1];l={x:h,y:p}}return{length:s,point:l,min:{x:Math.min(e,n),y:Math.min(t,r)},max:{x:Math.max(e,n),y:Math.max(t,r)}}}function Uh(e,t){var n=e.x,r=e.y,i=t.x,s=t.y,l=n*i+r*s,u=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(s,2))),h=n*s-r*i<0?-1:1,p=h*Math.acos(l/u);return p}function vd(e,t,n,r,i,s,l,u,h,p){var m=Math.abs,y=Math.sin,b=Math.cos,w=Math.sqrt,R=Math.PI,M=m(n),I=m(r),N=(i%360+360)%360,U=N*(R/180);if(e===u&&t===h)return{x:e,y:t};if(M===0||I===0)return mh(e,t,u,h,p).point;var Z=(e-u)/2,Y=(t-h)/2,$={x:b(U)*Z+y(U)*Y,y:-y(U)*Z+b(U)*Y},J=Math.pow($.x,2)/Math.pow(M,2)+Math.pow($.y,2)/Math.pow(I,2);J>1&&(M*=w(J),I*=w(J));var se=Math.pow(M,2)*Math.pow(I,2)-Math.pow(M,2)*Math.pow($.y,2)-Math.pow(I,2)*Math.pow($.x,2),pe=Math.pow(M,2)*Math.pow($.y,2)+Math.pow(I,2)*Math.pow($.x,2),Ce=se/pe;Ce=Ce<0?0:Ce;var Ue=(s!==l?1:-1)*w(Ce),Je={x:Ue*(M*$.y/I),y:Ue*(-(I*$.x)/M)},lt={x:b(U)*Je.x-y(U)*Je.y+(e+u)/2,y:y(U)*Je.x+b(U)*Je.y+(t+h)/2},Ge={x:($.x-Je.x)/M,y:($.y-Je.y)/I},at=Uh({x:1,y:0},Ge),st={x:(-$.x-Je.x)/M,y:(-$.y-Je.y)/I},ft=Uh(Ge,st);!l&&ft>0?ft-=2*R:l&&ft<0&&(ft+=2*R),ft%=2*R;var Vt=at+ft*p,wt=M*b(Vt),zt=I*y(Vt),En={x:b(U)*wt-y(U)*zt+lt.x,y:y(U)*wt+b(U)*zt+lt.y};return En}function gd(e,t,n,r,i,s,l,u,h,p,m){var y,b=m.bbox,w=b===void 0?!0:b,R=m.length,M=R===void 0?!0:R,I=m.sampleSize,N=I===void 0?30:I,U=typeof p=="number",Z=e,Y=t,$=0,J=[Z,Y,$],se=[Z,Y],pe=0,Ce={x:0,y:0},Ue=[{x:Z,y:Y}];U&&p<=0&&(Ce={x:Z,y:Y});for(var Je=0;Je<=N;Je+=1){if(pe=Je/N,y=vd(e,t,n,r,i,s,l,u,h,pe),Z=y.x,Y=y.y,w&&Ue.push({x:Z,y:Y}),M&&($+=Dn(se,[Z,Y])),se=[Z,Y],U&&$>=p&&p>J[2]){var lt=($-p)/($-J[2]);Ce={x:se[0]*(1-lt)+J[0]*lt,y:se[1]*(1-lt)+J[1]*lt}}J=[Z,Y,$]}return U&&p>=$&&(Ce={x:u,y:h}),{length:$,point:Ce,min:{x:Math.min.apply(null,Ue.map(function(Ge){return Ge.x})),y:Math.min.apply(null,Ue.map(function(Ge){return Ge.y}))},max:{x:Math.max.apply(null,Ue.map(function(Ge){return Ge.x})),y:Math.max.apply(null,Ue.map(function(Ge){return Ge.y}))}}}function yd(e,t,n,r,i,s,l,u,h){var p=1-h;return{x:Math.pow(p,3)*e+3*Math.pow(p,2)*h*n+3*p*Math.pow(h,2)*i+Math.pow(h,3)*l,y:Math.pow(p,3)*t+3*Math.pow(p,2)*h*r+3*p*Math.pow(h,2)*s+Math.pow(h,3)*u}}function vp(e,t,n,r,i,s,l,u,h,p){var m,y=p.bbox,b=y===void 0?!0:y,w=p.length,R=w===void 0?!0:w,M=p.sampleSize,I=M===void 0?10:M,N=typeof h=="number",U=e,Z=t,Y=0,$=[U,Z,Y],J=[U,Z],se=0,pe={x:0,y:0},Ce=[{x:U,y:Z}];N&&h<=0&&(pe={x:U,y:Z});for(var Ue=0;Ue<=I;Ue+=1){if(se=Ue/I,m=yd(e,t,n,r,i,s,l,u,se),U=m.x,Z=m.y,b&&Ce.push({x:U,y:Z}),R&&(Y+=Dn(J,[U,Z])),J=[U,Z],N&&Y>=h&&h>$[2]){var Je=(Y-h)/(Y-$[2]);pe={x:J[0]*(1-Je)+$[0]*Je,y:J[1]*(1-Je)+$[1]*Je}}$=[U,Z,Y]}return N&&h>=Y&&(pe={x:l,y:u}),{length:Y,point:pe,min:{x:Math.min.apply(null,Ce.map(function(lt){return lt.x})),y:Math.min.apply(null,Ce.map(function(lt){return lt.y}))},max:{x:Math.max.apply(null,Ce.map(function(lt){return lt.x})),y:Math.max.apply(null,Ce.map(function(lt){return lt.y}))}}}function $f(e,t,n,r,i,s,l){var u=1-l;return{x:Math.pow(u,2)*e+2*u*l*n+Math.pow(l,2)*i,y:Math.pow(u,2)*t+2*u*l*r+Math.pow(l,2)*s}}function Mu(e,t,n,r,i,s,l,u){var h,p=u.bbox,m=p===void 0?!0:p,y=u.length,b=y===void 0?!0:y,w=u.sampleSize,R=w===void 0?10:w,M=typeof l=="number",I=e,N=t,U=0,Z=[I,N,U],Y=[I,N],$=0,J={x:0,y:0},se=[{x:I,y:N}];M&&l<=0&&(J={x:I,y:N});for(var pe=0;pe<=R;pe+=1){if($=pe/R,h=$f(e,t,n,r,i,s,$),I=h.x,N=h.y,m&&se.push({x:I,y:N}),b&&(U+=Dn(Y,[I,N])),Y=[I,N],M&&U>=l&&l>Z[2]){var Ce=(U-l)/(U-Z[2]);J={x:Y[0]*(1-Ce)+Z[0]*Ce,y:Y[1]*(1-Ce)+Z[1]*Ce}}Z=[I,N,U]}return M&&l>=U&&(J={x:i,y:s}),{length:U,point:J,min:{x:Math.min.apply(null,se.map(function(Ue){return Ue.x})),y:Math.min.apply(null,se.map(function(Ue){return Ue.y}))},max:{x:Math.max.apply(null,se.map(function(Ue){return Ue.x})),y:Math.max.apply(null,se.map(function(Ue){return Ue.y}))}}}function _d(e,t,n){for(var r,i,s,l,u,h,p=zh(e),m=typeof t=="number",y,b=[],w,R=0,M=0,I=0,N=0,U,Z=[],Y=[],$=0,J={x:0,y:0},se=J,pe=J,Ce=J,Ue=0,Je=0,lt=p.length;Je<lt;Je+=1)U=p[Je],w=U[0],y=w==="M",b=y?b:[R,M].concat(U.slice(1)),y?(I=U[1],N=U[2],J={x:I,y:N},se=J,$=0,m&&t<.001&&(Ce=J)):w==="L"?(r=mh(b[0],b[1],b[2],b[3],(t||0)-Ue),$=r.length,J=r.min,se=r.max,pe=r.point):w==="A"?(i=gd(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],(t||0)-Ue,n||{}),$=i.length,J=i.min,se=i.max,pe=i.point):w==="C"?(s=vp(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],(t||0)-Ue,n||{}),$=s.length,J=s.min,se=s.max,pe=s.point):w==="Q"?(l=Mu(b[0],b[1],b[2],b[3],b[4],b[5],(t||0)-Ue,n||{}),$=l.length,J=l.min,se=l.max,pe=l.point):w==="Z"&&(b=[R,M,I,N],u=mh(b[0],b[1],b[2],b[3],(t||0)-Ue),$=u.length,J=u.min,se=u.max,pe=u.point),m&&Ue<t&&Ue+$>=t&&(Ce=pe),Y.push(se),Z.push(J),Ue+=$,h=w!=="Z"?U.slice(-2):[I,N],R=h[0],M=h[1];return m&&t>=Ue&&(Ce={x:R,y:M}),{length:Ue,point:Ce,min:{x:Math.min.apply(null,Z.map(function(Ge){return Ge.x})),y:Math.min.apply(null,Z.map(function(Ge){return Ge.y}))},max:{x:Math.max.apply(null,Y.map(function(Ge){return Ge.x})),y:Math.max.apply(null,Y.map(function(Ge){return Ge.y}))}}}function Nl(e,t){return _d(e,void 0,(0,z.pi)((0,z.pi)({},t),{bbox:!1,length:!0})).length}var Is=function(e){return Array.isArray?Array.isArray(e):(0,_i.Z)(e,"Array")},nu=function(e){if(Is(e))return e.reduce(function(t,n){return Math.min(t,n)},e[0])},sc=function(e){if(Is(e))return e.reduce(function(t,n){return Math.max(t,n)},e[0])},of=1e-5;function lc(e,t,n){return n===void 0&&(n=of),Math.abs(e-t)<n}var af=function(e,t){return(e%t+t)%t},Bl=af;function Pu(e,t,n){if(e[n].length>7){e[n].shift();for(var r=e[n],i=n;r.length;)t[n]="A",e.splice(i+=1,0,["C"].concat(r.splice(0,6)));e.splice(n,1)}}function yf(e){return il(e)&&e.every(function(t){var n=t[0];return"MC".includes(n)})}function vh(e,t,n){var r=e*Math.cos(n)-t*Math.sin(n),i=e*Math.sin(n)+t*Math.cos(n);return{x:r,y:i}}function Kf(e,t,n,r,i,s,l,u,h,p){var m=e,y=t,b=n,w=r,R=u,M=h,I=Math.PI*120/180,N=Math.PI/180*(+i||0),U=[],Z,Y,$,J,se;if(p)Y=p[0],$=p[1],J=p[2],se=p[3];else{Z=vh(m,y,-N),m=Z.x,y=Z.y,Z=vh(R,M,-N),R=Z.x,M=Z.y;var pe=(m-R)/2,Ce=(y-M)/2,Ue=pe*pe/(b*b)+Ce*Ce/(w*w);Ue>1&&(Ue=Math.sqrt(Ue),b*=Ue,w*=Ue);var Je=b*b,lt=w*w,Ge=(s===l?-1:1)*Math.sqrt(Math.abs((Je*lt-Je*Ce*Ce-lt*pe*pe)/(Je*Ce*Ce+lt*pe*pe)));J=Ge*b*Ce/w+(m+R)/2,se=Ge*-w*pe/b+(y+M)/2,Y=Math.asin(((y-se)/w*Math.pow(10,9)>>0)/Math.pow(10,9)),$=Math.asin(((M-se)/w*Math.pow(10,9)>>0)/Math.pow(10,9)),Y=m<J?Math.PI-Y:Y,$=R<J?Math.PI-$:$,Y<0&&(Y=Math.PI*2+Y),$<0&&($=Math.PI*2+$),l&&Y>$&&(Y-=Math.PI*2),!l&&$>Y&&($-=Math.PI*2)}var at=$-Y;if(Math.abs(at)>I){var st=$,ft=R,Vt=M;$=Y+I*(l&&$>Y?1:-1),R=J+b*Math.cos($),M=se+w*Math.sin($),U=Kf(R,M,b,w,i,0,l,ft,Vt,[$,st,J,se])}at=$-Y;var wt=Math.cos(Y),zt=Math.sin(Y),En=Math.cos($),Vn=Math.sin($),ar=Math.tan(at/4),lr=4/3*b*ar,Vr=4/3*w*ar,ui=[m,y],qi=[m+lr*zt,y-Vr*wt],Jr=[R+lr*Vn,M-Vr*En],Qr=[R,M];if(qi[0]=2*ui[0]-qi[0],qi[1]=2*ui[1]-qi[1],p)return qi.concat(Jr,Qr,U);U=qi.concat(Jr,Qr,U);for(var Mo=[],Qi=0,Zi=U.length;Qi<Zi;Qi+=1)Mo[Qi]=Qi%2?vh(U[Qi-1],U[Qi],N).y:vh(U[Qi],U[Qi+1],N).x;return Mo}function ps(e,t,n,r,i,s){var l=.3333333333333333,u=2/3;return[l*e+u*n,l*t+u*r,l*i+u*n,l*s+u*r,i,s]}var jh=function(e,t,n,r){var i=.5,s=tu([e,t],[n,r],i);return(0,z.ev)((0,z.ev)([],s,!0),[n,r,n,r],!1)};function Vh(e,t){var n=e[0],r=e.slice(1).map(Number),i=r[0],s=r[1],l,u=t.x1,h=t.y1,p=t.x,m=t.y;switch("TQ".includes(n)||(t.qx=null,t.qy=null),n){case"M":return t.x=i,t.y=s,e;case"A":return l=[u,h].concat(r),["C"].concat(Kf(l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9]));case"Q":return t.qx=i,t.qy=s,l=[u,h].concat(r),["C"].concat(ps(l[0],l[1],l[2],l[3],l[4],l[5]));case"L":return["C"].concat(jh(u,h,i,s));case"Z":return u===p&&h===m?["C",u,h,p,m,p,m]:["C"].concat(jh(u,h,p,m));default:}return e}function gh(e,t){if(t===void 0&&(t=!1),yf(e)){var n=[].concat(e);return t?[n,[]]:n}for(var r=zh(e),i=(0,z.pi)({},Xf),s=[],l="",u=r.length,h,p,m=[],y=0;y<u;y+=1){r[y]&&(l=r[y][0]),s[y]=l;var b=Vh(r[y],i);r[y]=b,Pu(r,s,y),u=r.length,l==="Z"&&m.push(y),h=r[y],p=h.length,i.x1=+h[p-2],i.y1=+h[p-1],i.x2=+h[p-4]||i.x1,i.y2=+h[p-3]||i.y1}return t?[r,m]:r}function ol(e,t){t===void 0&&(t=.5);var n=e.slice(0,2),r=e.slice(2,4),i=e.slice(4,6),s=e.slice(6,8),l=tu(n,r,t),u=tu(r,i,t),h=tu(i,s,t),p=tu(l,u,t),m=tu(u,h,t),y=tu(p,m,t);return[["C"].concat(l,p,y),["C"].concat(m,h,s)]}function qf(e){return e.map(function(t,n,r){var i=n&&r[n-1].slice(-2).concat(t.slice(1)),s=n?vp(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,l;return n?l=s?ol(i):[t,t]:l=[t],{s:t,ss:l,l:s}})}function Qf(e,t,n){var r=qf(e),i=qf(t),s=r.length,l=i.length,u=r.filter(function(I){return I.l}).length,h=i.filter(function(I){return I.l}).length,p=r.filter(function(I){return I.l}).reduce(function(I,N){var U=N.l;return I+U},0)/u||0,m=i.filter(function(I){return I.l}).reduce(function(I,N){var U=N.l;return I+U},0)/h||0,y=n||Math.max(s,l),b=[p,m],w=[y-s,y-l],R=0,M=[r,i].map(function(I,N){return I.l===y?I.map(function(U){return U.s}):I.map(function(U,Z){return R=Z&&w[N]&&U.l>=b[N],w[N]-=R?1:0,R?U.ss:[U.s]}).flat()});return M[0].length===M[1].length?M:Qf(M[0],M[1],y)}function ne(e,t,n,r,i,s,l,u){return 3*((u-t)*(n+i)-(l-e)*(r+s)+r*(e-i)-n*(t-s)+u*(i+e/3)-l*(s+t/3))/20}function _e(e){var t=0,n=0,r=0;return gh(e).map(function(i){var s;switch(i[0]){case"M":return t=i[1],n=i[2],0;default:var l=i.slice(1),u=l[0],h=l[1],p=l[2],m=l[3],y=l[4],b=l[5];return r=ne(t,n,u,h,p,m,y,b),s=i.slice(-2),t=s[0],n=s[1],r}}).reduce(function(i,s){return i+s},0)}function et(e){return _e(e)>=0}function dn(e){var t=e.slice(1).map(function(n,r,i){return r?i[r-1].slice(-2).concat(n.slice(1)):e[0].slice(1).concat(n.slice(1))}).map(function(n){return n.map(function(r,i){return n[n.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map(function(n){return["C"].concat(n.slice(2))}))}function K(e){return e.map(function(t){return Array.isArray(t)?[].concat(t):t})}function rr(e){var t=e.length,n=t-1;return e.map(function(r,i){return e.map(function(s,l){var u=i+l,h;return l===0||e[u]&&e[u][0]==="M"?(h=e[u],["M"].concat(h.slice(-2))):(u>=t&&(u-=n),e[u])})})}function Mr(e,t){var n=e.length-1,r=[],i=0,s=0,l=rr(e);return l.forEach(function(u,h){e.slice(1).forEach(function(p,m){s+=Dn(e[(h+m)%n].slice(-2),t[m%n].slice(-2))}),r[h]=s,s=0}),i=r.indexOf(Math.min.apply(null,r)),l[i]}var ki=function(e){return e===void 0},ti=ki,uo=function(e){return(0,_i.Z)(e,"Boolean")},lo=uo,ca=function(e){var t=typeof e;return e!==null&&t==="object"||t==="function"};function Io(e,t,n){return _d(e,t,(0,z.pi)((0,z.pi)({},n),{bbox:!1,length:!0})).point}function xa(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Qa(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function aa(){}var ga=.7,hs=1/ga,Oa="\\s*([+-]?\\d+)\\s*",La="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ks=/^#([0-9a-f]{3,8})$/,Fs=new RegExp("^rgb\\(".concat(Oa,",").concat(Oa,",").concat(Oa,"\\)$")),Ec=new RegExp("^rgb\\(".concat(Fa,",").concat(Fa,",").concat(Fa,"\\)$")),is=new RegExp("^rgba\\(".concat(Oa,",").concat(Oa,",").concat(Oa,",").concat(La,"\\)$")),Iu=new RegExp("^rgba\\(".concat(Fa,",").concat(Fa,",").concat(Fa,",").concat(La,"\\)$")),du=new RegExp("^hsl\\(".concat(La,",").concat(Fa,",").concat(Fa,"\\)$")),Lc=new RegExp("^hsla\\(".concat(La,",").concat(Fa,",").concat(Fa,",").concat(La,"\\)$")),Pf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xa(aa,Lf,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Hh,formatHex:Hh,formatHex8:Zh,formatHsl:If,formatRgb:Lu,toString:Lu});function Hh(){return this.rgb().formatHex()}function Zh(){return this.rgb().formatHex8()}function If(){return Yp(this).formatHsl()}function Lu(){return this.rgb().formatRgb()}function Lf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ks.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?yh(t):n===3?new Dc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Du(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Du(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Fs.exec(e))?new Dc(t[1],t[2],t[3],1):(t=Ec.exec(e))?new Dc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=is.exec(e))?Du(t[1],t[2],t[3],t[4]):(t=Iu.exec(e))?Du(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=du.exec(e))?Jf(t[1],t[2]/100,t[3]/100,1):(t=Lc.exec(e))?Jf(t[1],t[2]/100,t[3]/100,t[4]):Pf.hasOwnProperty(e)?yh(Pf[e]):e==="transparent"?new Dc(NaN,NaN,NaN,0):null}function yh(e){return new Dc(e>>16&255,e>>8&255,e&255,1)}function Du(e,t,n,r){return r<=0&&(e=t=n=NaN),new Dc(e,t,n,r)}function P0(e){return e instanceof aa||(e=Lf(e)),e?(e=e.rgb(),new Dc(e.r,e.g,e.b,e.opacity)):new Dc}function bd(e,t,n,r){return arguments.length===1?P0(e):new Dc(e,t,n,r==null?1:r)}function Dc(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}xa(Dc,bd,Qa(aa,{brighter:function(t){return t=t==null?hs:Math.pow(hs,t),new Dc(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?ga:Math.pow(ga,t),new Dc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new Dc(Nu(this.r),Nu(this.g),Nu(this.b),_h(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wh,formatHex:Wh,formatHex8:gp,formatRgb:Gh,toString:Gh}));function Wh(){return"#".concat(Df(this.r)).concat(Df(this.g)).concat(Df(this.b))}function gp(){return"#".concat(Df(this.r)).concat(Df(this.g)).concat(Df(this.b)).concat(Df((isNaN(this.opacity)?1:this.opacity)*255))}function Gh(){var e=_h(this.opacity);return"".concat(e===1?"rgb(":"rgba(").concat(Nu(this.r),", ").concat(Nu(this.g),", ").concat(Nu(this.b)).concat(e===1?")":", ".concat(e,")"))}function _h(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Nu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Df(e){return e=Nu(e),(e<16?"0":"")+e.toString(16)}function Jf(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ja(e,t,n,r)}function Yp(e){if(e instanceof Ja)return new Ja(e.h,e.s,e.l,e.opacity);if(e instanceof aa||(e=Lf(e)),!e)return new Ja;if(e instanceof Ja)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),l=NaN,u=s-i,h=(s+i)/2;return u?(t===s?l=(n-r)/u+(n<r)*6:n===s?l=(r-t)/u+2:l=(t-n)/u+4,u/=h<.5?s+i:2-s-i,l*=60):u=h>0&&h<1?0:l,new Ja(l,u,h,e.opacity)}function Nf(e,t,n,r){return arguments.length===1?Yp(e):new Ja(e,t,n,r==null?1:r)}function Ja(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}xa(Ja,Nf,Qa(aa,{brighter:function(t){return t=t==null?hs:Math.pow(hs,t),new Ja(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?ga:Math.pow(ga,t),new Ja(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new Dc(ue(t>=240?t-240:t+120,s,i),ue(t,s,i),ue(t<120?t+240:t-120,s,i),this.opacity)},clamp:function(){return new Ja(xd(this.h),pu(this.s),pu(this.l),_h(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=_h(this.opacity);return"".concat(t===1?"hsl(":"hsla(").concat(xd(this.h),", ").concat(pu(this.s)*100,"%, ").concat(pu(this.l)*100,"%").concat(t===1?")":", ".concat(t,")"))}}));function xd(e){return e=(e||0)%360,e<0?e+360:e}function pu(e){return Math.max(0,Math.min(1,e||0))}function ue(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function Pe(e,t,n,r){var i=e-n,s=t-r;return Math.sqrt(i*i+s*s)}function ct(e,t){var n=Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(e),!1)),r=Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(t),!1)),i=Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(e),!1)),s=Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(t),!1));return{x:n,y:r,width:i-n,height:s-r}}function Sn(e){return(e+Math.PI*2)%(Math.PI*2)}function cr(e,t){var n=Math.abs(e);return t>0?n:n*-1}function kr(e,t,n,r,i,s){var l=n,u=r;if(l===0||u===0)return{x:e,y:t};for(var h=i-e,p=s-t,m=Math.abs(h),y=Math.abs(p),b=l*l,w=u*u,R=Math.PI/4,M=0,I=0,N=0;N<4;N++){M=l*Math.cos(R),I=u*Math.sin(R);var U=(b-w)*Math.pow(Math.cos(R),3)/l,Z=(w-b)*Math.pow(Math.sin(R),3)/u,Y=M-U,$=I-Z,J=m-U,se=y-Z,pe=Math.hypot($,Y),Ce=Math.hypot(se,J),Ue=pe*Math.asin((Y*se-$*J)/(pe*Ce)),Je=Ue/Math.sqrt(b+w-M*M-I*I);R+=Je,R=Math.min(Math.PI/2,Math.max(0,R))}return{x:e+cr(M,h),y:t+cr(I,p)}}function gi(e,t,n,r,i,s,l,u){return-1*n*Math.cos(i)*Math.sin(u)-r*Math.sin(i)*Math.cos(u)}function $i(e,t,n,r,i,s,l,u){return-1*n*Math.sin(i)*Math.sin(u)+r*Math.cos(i)*Math.cos(u)}function pa(e,t,n){return Math.atan(-t/e*Math.tan(n))}function Ea(e,t,n){return Math.atan(t/(e*Math.tan(n)))}function _s(e,t,n,r,i,s){return n*Math.cos(i)*Math.cos(s)-r*Math.sin(i)*Math.sin(s)+e}function za(e,t,n,r,i,s){return n*Math.sin(i)*Math.cos(s)+r*Math.cos(i)*Math.sin(s)+t}function ka(e,t,n,r){var i=Math.atan2(r*e,n*t);return(i+Math.PI*2)%(Math.PI*2)}function cc(e,t,n){return{x:e*Math.cos(n),y:t*Math.sin(n)}}function Bu(e,t,n){var r=Math.cos(n),i=Math.sin(n);return[e*r-t*i,e*i+t*r]}function qs(e,t,n,r,i,s,l){for(var u=pa(n,r,i),h=1/0,p=-1/0,m=[s,l],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var b=u+y;s<l?s<b&&b<l&&m.push(b):l<b&&b<s&&m.push(b)}for(var y=0;y<m.length;y++){var w=_s(e,t,n,r,i,m[y]);w<h&&(h=w),w>p&&(p=w)}for(var R=Ea(n,r,i),M=1/0,I=-1/0,N=[s,l],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var U=R+y;s<l?s<U&&U<l&&N.push(U):l<U&&U<s&&N.push(U)}for(var y=0;y<N.length;y++){var Z=za(e,t,n,r,i,N[y]);Z<M&&(M=Z),Z>I&&(I=Z)}return{x:h,y:M,width:p-h,height:I-M}}function ho(e,t,n,r,i,s,l,u,h){var p=Bu(u-e,h-t,-i),m=__read(p,2),y=m[0],b=m[1],w=kr(0,0,n,r,y,b),R=ka(n,r,w.x,w.y);R<s?w=cc(n,r,s):R>l&&(w=cc(n,r,l));var M=Bu(w.x,w.y,i);return{x:M[0]+e,y:M[1]+t}}function ru(e,t,n,r,i,s,l,u){var h=(l-s)*u+s,p=gi(e,t,n,r,i,s,l,h),m=$i(e,t,n,r,i,s,l,h);return Sn(Math.atan2(m,p))}var Ed=1e-4;function eh(e,t,n,r,i,s){var l=-1,u=1/0,h=[n,r],p=20;s&&s>200&&(p=s/10);for(var m=1/p,y=m/10,b=0;b<=p;b++){var w=b*m,R=[i.apply(void 0,(0,z.ev)([],(0,z.CR)(e.concat([w])),!1)),i.apply(void 0,(0,z.ev)([],(0,z.CR)(t.concat([w])),!1))],M=Pe(h[0],h[1],R[0],R[1]);M<u&&(l=w,u=M)}if(l===0)return{x:e[0],y:t[0]};if(l===1){var I=e.length;return{x:e[I-1],y:t[I-1]}}u=1/0;for(var b=0;b<32&&!(y<Ed);b++){var N=l-y,U=l+y,R=[i.apply(void 0,(0,z.ev)([],(0,z.CR)(e.concat([N])),!1)),i.apply(void 0,(0,z.ev)([],(0,z.CR)(t.concat([N])),!1))],M=Pe(h[0],h[1],R[0],R[1]);if(N>=0&&M<u)l=N,u=M;else{var Z=[i.apply(void 0,(0,z.ev)([],(0,z.CR)(e.concat([U])),!1)),i.apply(void 0,(0,z.ev)([],(0,z.CR)(t.concat([U])),!1))],Y=Pe(h[0],h[1],Z[0],Z[1]);U<=1&&Y<u?(l=U,u=Y):y*=.5}}return{x:i.apply(void 0,(0,z.ev)([],(0,z.CR)(e.concat([l])),!1)),y:i.apply(void 0,(0,z.ev)([],(0,z.CR)(t.concat([l])),!1))}}function ml(e,t){for(var n=0,r=e.length,i=0;i<r;i++){var s=e[i],l=t[i],u=e[(i+1)%r],h=t[(i+1)%r];n+=Pe(s,l,u,h)}return n/2}function os(e,t,n,r){return ct([e,n],[t,r])}function yp(e,t,n,r){return Pe(e,t,n,r)}function Ii(e,t,n,r,i){return{x:(1-i)*e+i*n,y:(1-i)*t+i*r}}function th(e,t,n,r,i,s){var l=(n-e)*(i-e)+(r-t)*(s-t);if(l<0)return Pe(e,t,i,s);var u=(n-e)*(n-e)+(r-t)*(r-t);return l>u?Pe(n,r,i,s):Sd(e,t,n,r,i,s)}function Sd(e,t,n,r,i,s){var l=[n-e,r-t];if(Tt.I6(l,[0,0]))return Math.sqrt((i-e)*(i-e)+(s-t)*(s-t));var u=[-l[1],l[0]];Tt.Fv(u,u);var h=[i-e,s-t];return Math.abs(Tt.AK(h,u))}function $p(e,t,n,r){return Math.atan2(r-t,n-e)}function Nc(e,t,n,r,i){var s=1-i;return s*s*s*e+3*t*i*s*s+3*n*i*i*s+r*i*i*i}function mu(e,t,n,r,i){var s=1-i;return 3*(s*s*(t-e)+2*s*i*(n-t)+i*i*(r-n))}function _p(e,t,n,r){var i=-3*e+9*t-9*n+3*r,s=6*e-12*t+6*n,l=3*t-3*e,u=[],h,p,m;if(lc(i,0))lc(s,0)||(h=-l/s,h>=0&&h<=1&&u.push(h));else{var y=s*s-4*i*l;lc(y,0)?u.push(-s/(2*i)):y>0&&(m=Math.sqrt(y),h=(-s+m)/(2*i),p=(-s-m)/(2*i),h>=0&&h<=1&&u.push(h),p>=0&&p<=1&&u.push(p))}return u}function Kp(e,t,n,r,i,s,l,u,h){var p=Nc(e,n,i,l,h),m=Nc(t,r,s,u,h),y=Ii(e,t,n,r,h),b=Ii(n,r,i,s,h),w=Ii(i,s,l,u,h),R=Ii(y.x,y.y,b.x,b.y,h),M=Ii(b.x,b.y,w.x,w.y,h);return[[e,t,y.x,y.y,R.x,R.y,p,m],[p,m,M.x,M.y,w.x,w.y,l,u]]}function Bc(e,t,n,r,i,s,l,u,h){if(h===0)return ml([e,n,i,l],[t,r,s,u]);var p=Kp(e,t,n,r,i,s,l,u,.5),m=__spreadArray(__spreadArray([],__read(p[0]),!1),[h-1],!1),y=__spreadArray(__spreadArray([],__read(p[1]),!1),[h-1],!1);return Bc.apply(void 0,__spreadArray([],__read(m),!1))+Bc.apply(void 0,__spreadArray([],__read(y),!1))}function nh(e,t,n,r,i,s,l,u){for(var h=[e,l],p=[t,u],m=_p(e,n,i,l),y=_p(t,r,s,u),b=0;b<m.length;b++)h.push(Nc(e,n,i,l,m[b]));for(var b=0;b<y.length;b++)p.push(Nc(t,r,s,u,y[b]));return ct(h,p)}function Jm(e,t,n,r,i,s,l,u){return Bc(e,t,n,r,i,s,l,u,3)}function Td(e,t,n,r,i,s,l,u,h,p,m){return eh([e,n,i,l],[t,r,s,u],h,p,Nc,m)}function bp(e,t,n,r,i,s,l,u,h,p,m){var y=Td(e,t,n,r,i,s,l,u,h,p,m);return Pe(y.x,y.y,h,p)}function sm(e,t,n,r,i,s,l,u,h){return{x:Nc(e,n,i,l,h),y:Nc(t,r,s,u,h)}}function Fu(e,t,n,r,i,s,l,u,h){var p=mu(e,n,i,l,h),m=mu(t,r,s,u,h);return Sn(Math.atan2(m,p))}function vu(e){for(var t=0,n=[],r=0;r<e.length-1;r++){var i=e[r],s=e[r+1],l=Pe(i[0],i[1],s[0],s[1]),u={from:i,to:s,length:l};n.push(u),t+=l}return{segments:n,totalLength:t}}function ya(e){if(e.length<2)return 0;for(var t=0,n=0;n<e.length-1;n++){var r=e[n],i=e[n+1];t+=Pe(r[0],r[1],i[0],i[1])}return t}function ku(e,t){if(t>1||t<0||e.length<2)return null;var n=vu(e),r=n.segments,i=n.totalLength;if(i===0)return{x:e[0][0],y:e[0][1]};for(var s=0,l=null,u=0;u<r.length;u++){var h=r[u],p=h.from,m=h.to,y=h.length/i;if(t>=s&&t<=s+y){var b=(t-s)/y;l=Ii(p[0],p[1],m[0],m[1],b);break}s+=y}return l}function zu(e,t){if(t>1||t<0||e.length<2)return 0;for(var n=vu(e),r=n.segments,i=n.totalLength,s=0,l=0,u=0;u<r.length;u++){var h=r[u],p=h.from,m=h.to,y=h.length/i;if(t>=s&&t<=s+y){l=Math.atan2(m[1]-p[1],m[0]-p[0]);break}s+=y}return l}function uc(e,t,n){for(var r=1/0,i=0;i<e.length-1;i++){var s=e[i],l=e[i+1],u=th(s[0],s[1],l[0],l[1],t,n);u<r&&(r=u)}return r}function Xh(e){for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r];t.push(i[0]),n.push(i[1])}return ct(t,n)}function Wl(e){return ya(e)}function Wc(e,t){return ku(e,t)}function iu(e,t,n){return uc(e,t,n)}function xp(e,t){return zu(e,t)}function Oo(e){var t=e.slice(0);return e.length&&t.push(e[0]),t}function So(e){return Xh(e)}function Uu(e){return ya(Oo(e))}function ou(e,t){return ku(Oo(e),t)}function rh(e,t,n){return uc(Oo(e),t,n)}function fl(e,t){return zu(Oo(e),t)}function Gc(e,t,n,r){var i=1-r;return i*i*e+2*r*i*t+r*r*n}function Bf(e,t,n){var r=e+n-2*t;if(lc(r,0))return[.5];var i=(e-t)/r;return i<=1&&i>=0?[i]:[]}function wd(e,t,n,r,i,s,l){var u=Gc(e,n,i,l),h=Gc(t,r,s,l),p=Ii(e,t,n,r,l),m=Ii(n,r,i,s,l);return[[e,t,p.x,p.y,u,h],[u,h,m.x,m.y,i,s]]}function ms(e,t,n,r,i,s,l){if(l===0)return(Pe(e,t,n,r)+Pe(n,r,i,s)+Pe(e,t,i,s))/2;var u=wd(e,t,n,r,i,s,.5),h=u[0],p=u[1];return h.push(l-1),p.push(l-1),ms.apply(void 0,__spreadArray([],__read(h),!1))+ms.apply(void 0,__spreadArray([],__read(p),!1))}function fc(e,t,n,r,i,s){var l=Bf(e,n,i)[0],u=Bf(t,r,s)[0],h=[e,i],p=[t,s];return l!==void 0&&h.push(Gc(e,n,i,l)),u!==void 0&&p.push(Gc(t,r,s,u)),ct(h,p)}function I0(e,t,n,r,i,s){return ms(e,t,n,r,i,s,3)}function Yh(e,t,n,r,i,s,l,u){return eh([e,n,i],[t,r,s],l,u,Gc)}function qp(e,t,n,r,i,s,l,u){var h=Yh(e,t,n,r,i,s,l,u);return Pe(h.x,h.y,l,u)}var bh=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},au={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(bh,function(){function n($,J,se,pe,Ce){r($,J,se||0,pe||$.length-1,Ce||s)}function r($,J,se,pe,Ce){for(;pe>se;){if(pe-se>600){var Ue=pe-se+1,Je=J-se+1,lt=Math.log(Ue),Ge=.5*Math.exp(2*lt/3),at=.5*Math.sqrt(lt*Ge*(Ue-Ge)/Ue)*(Je-Ue/2<0?-1:1),st=Math.max(se,Math.floor(J-Je*Ge/Ue+at)),ft=Math.min(pe,Math.floor(J+(Ue-Je)*Ge/Ue+at));r($,J,st,ft,Ce)}var Vt=$[J],wt=se,zt=pe;for(i($,se,J),Ce($[pe],Vt)>0&&i($,se,pe);wt<zt;){for(i($,wt,zt),wt++,zt--;Ce($[wt],Vt)<0;)wt++;for(;Ce($[zt],Vt)>0;)zt--}Ce($[se],Vt)===0?i($,se,zt):(zt++,i($,zt,pe)),zt<=J&&(se=zt+1),J<=zt&&(pe=zt-1)}}function i($,J,se){var pe=$[J];$[J]=$[se],$[se]=pe}function s($,J){return $<J?-1:$>J?1:0}var l=function(J){J===void 0&&(J=9),this._maxEntries=Math.max(4,J),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function(J){var se=this.data,pe=[];if(!U(J,se))return pe;for(var Ce=this.toBBox,Ue=[];se;){for(var Je=0;Je<se.children.length;Je++){var lt=se.children[Je],Ge=se.leaf?Ce(lt):lt;U(J,Ge)&&(se.leaf?pe.push(lt):N(J,Ge)?this._all(lt,pe):Ue.push(lt))}se=Ue.pop()}return pe},l.prototype.collides=function(J){var se=this.data;if(!U(J,se))return!1;for(var pe=[];se;){for(var Ce=0;Ce<se.children.length;Ce++){var Ue=se.children[Ce],Je=se.leaf?this.toBBox(Ue):Ue;if(U(J,Je)){if(se.leaf||N(J,Je))return!0;pe.push(Ue)}}se=pe.pop()}return!1},l.prototype.load=function(J){if(!(J&&J.length))return this;if(J.length<this._minEntries){for(var se=0;se<J.length;se++)this.insert(J[se]);return this}var pe=this._build(J.slice(),0,J.length-1,0);if(!this.data.children.length)this.data=pe;else if(this.data.height===pe.height)this._splitRoot(this.data,pe);else{if(this.data.height<pe.height){var Ce=this.data;this.data=pe,pe=Ce}this._insert(pe,this.data.height-pe.height-1,!0)}return this},l.prototype.insert=function(J){return J&&this._insert(J,this.data.height-1),this},l.prototype.clear=function(){return this.data=Z([]),this},l.prototype.remove=function(J,se){if(!J)return this;for(var pe=this.data,Ce=this.toBBox(J),Ue=[],Je=[],lt,Ge,at;pe||Ue.length;){if(pe||(pe=Ue.pop(),Ge=Ue[Ue.length-1],lt=Je.pop(),at=!0),pe.leaf){var st=u(J,pe.children,se);if(st!==-1)return pe.children.splice(st,1),Ue.push(pe),this._condense(Ue),this}!at&&!pe.leaf&&N(pe,Ce)?(Ue.push(pe),Je.push(lt),lt=0,Ge=pe,pe=pe.children[0]):Ge?(lt++,pe=Ge.children[lt],at=!1):pe=null}return this},l.prototype.toBBox=function(J){return J},l.prototype.compareMinX=function(J,se){return J.minX-se.minX},l.prototype.compareMinY=function(J,se){return J.minY-se.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function(J){return this.data=J,this},l.prototype._all=function(J,se){for(var pe=[];J;)J.leaf?se.push.apply(se,J.children):pe.push.apply(pe,J.children),J=pe.pop();return se},l.prototype._build=function(J,se,pe,Ce){var Ue=pe-se+1,Je=this._maxEntries,lt;if(Ue<=Je)return lt=Z(J.slice(se,pe+1)),h(lt,this.toBBox),lt;Ce||(Ce=Math.ceil(Math.log(Ue)/Math.log(Je)),Je=Math.ceil(Ue/Math.pow(Je,Ce-1))),lt=Z([]),lt.leaf=!1,lt.height=Ce;var Ge=Math.ceil(Ue/Je),at=Ge*Math.ceil(Math.sqrt(Je));Y(J,se,pe,at,this.compareMinX);for(var st=se;st<=pe;st+=at){var ft=Math.min(st+at-1,pe);Y(J,st,ft,Ge,this.compareMinY);for(var Vt=st;Vt<=ft;Vt+=Ge){var wt=Math.min(Vt+Ge-1,ft);lt.children.push(this._build(J,Vt,wt,Ce-1))}}return h(lt,this.toBBox),lt},l.prototype._chooseSubtree=function(J,se,pe,Ce){for(;Ce.push(se),!(se.leaf||Ce.length-1===pe);){for(var Ue=1/0,Je=1/0,lt=void 0,Ge=0;Ge<se.children.length;Ge++){var at=se.children[Ge],st=w(at),ft=M(J,at)-st;ft<Je?(Je=ft,Ue=st<Ue?st:Ue,lt=at):ft===Je&&st<Ue&&(Ue=st,lt=at)}se=lt||se.children[0]}return se},l.prototype._insert=function(J,se,pe){var Ce=pe?J:this.toBBox(J),Ue=[],Je=this._chooseSubtree(Ce,this.data,se,Ue);for(Je.children.push(J),m(Je,Ce);se>=0&&Ue[se].children.length>this._maxEntries;)this._split(Ue,se),se--;this._adjustParentBBoxes(Ce,Ue,se)},l.prototype._split=function(J,se){var pe=J[se],Ce=pe.children.length,Ue=this._minEntries;this._chooseSplitAxis(pe,Ue,Ce);var Je=this._chooseSplitIndex(pe,Ue,Ce),lt=Z(pe.children.splice(Je,pe.children.length-Je));lt.height=pe.height,lt.leaf=pe.leaf,h(pe,this.toBBox),h(lt,this.toBBox),se?J[se-1].children.push(lt):this._splitRoot(pe,lt)},l.prototype._splitRoot=function(J,se){this.data=Z([J,se]),this.data.height=J.height+1,this.data.leaf=!1,h(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function(J,se,pe){for(var Ce,Ue=1/0,Je=1/0,lt=se;lt<=pe-se;lt++){var Ge=p(J,0,lt,this.toBBox),at=p(J,lt,pe,this.toBBox),st=I(Ge,at),ft=w(Ge)+w(at);st<Ue?(Ue=st,Ce=lt,Je=ft<Je?ft:Je):st===Ue&&ft<Je&&(Je=ft,Ce=lt)}return Ce||pe-se},l.prototype._chooseSplitAxis=function(J,se,pe){var Ce=J.leaf?this.compareMinX:y,Ue=J.leaf?this.compareMinY:b,Je=this._allDistMargin(J,se,pe,Ce),lt=this._allDistMargin(J,se,pe,Ue);Je<lt&&J.children.sort(Ce)},l.prototype._allDistMargin=function(J,se,pe,Ce){J.children.sort(Ce);for(var Ue=this.toBBox,Je=p(J,0,se,Ue),lt=p(J,pe-se,pe,Ue),Ge=R(Je)+R(lt),at=se;at<pe-se;at++){var st=J.children[at];m(Je,J.leaf?Ue(st):st),Ge+=R(Je)}for(var ft=pe-se-1;ft>=se;ft--){var Vt=J.children[ft];m(lt,J.leaf?Ue(Vt):Vt),Ge+=R(lt)}return Ge},l.prototype._adjustParentBBoxes=function(J,se,pe){for(var Ce=pe;Ce>=0;Ce--)m(se[Ce],J)},l.prototype._condense=function(J){for(var se=J.length-1,pe=void 0;se>=0;se--)J[se].children.length===0?se>0?(pe=J[se-1].children,pe.splice(pe.indexOf(J[se]),1)):this.clear():h(J[se],this.toBBox)};function u($,J,se){if(!se)return J.indexOf($);for(var pe=0;pe<J.length;pe++)if(se($,J[pe]))return pe;return-1}function h($,J){p($,0,$.children.length,J,$)}function p($,J,se,pe,Ce){Ce||(Ce=Z(null)),Ce.minX=1/0,Ce.minY=1/0,Ce.maxX=-1/0,Ce.maxY=-1/0;for(var Ue=J;Ue<se;Ue++){var Je=$.children[Ue];m(Ce,$.leaf?pe(Je):Je)}return Ce}function m($,J){return $.minX=Math.min($.minX,J.minX),$.minY=Math.min($.minY,J.minY),$.maxX=Math.max($.maxX,J.maxX),$.maxY=Math.max($.maxY,J.maxY),$}function y($,J){return $.minX-J.minX}function b($,J){return $.minY-J.minY}function w($){return($.maxX-$.minX)*($.maxY-$.minY)}function R($){return $.maxX-$.minX+($.maxY-$.minY)}function M($,J){return(Math.max(J.maxX,$.maxX)-Math.min(J.minX,$.minX))*(Math.max(J.maxY,$.maxY)-Math.min(J.minY,$.minY))}function I($,J){var se=Math.max($.minX,J.minX),pe=Math.max($.minY,J.minY),Ce=Math.min($.maxX,J.maxX),Ue=Math.min($.maxY,J.maxY);return Math.max(0,Ce-se)*Math.max(0,Ue-pe)}function N($,J){return $.minX<=J.minX&&$.minY<=J.minY&&J.maxX<=$.maxX&&J.maxY<=$.maxY}function U($,J){return J.minX<=$.maxX&&J.minY<=$.maxY&&J.maxX>=$.minX&&J.maxY>=$.minY}function Z($){return{children:$,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Y($,J,se,pe,Ce){for(var Ue=[J,se];Ue.length;)if(se=Ue.pop(),J=Ue.pop(),!(se-J<=pe)){var Je=J+Math.ceil((se-J)/pe/2)*pe;n($,Je,J,se,Ce),Ue.push(J,Je,Je,se)}}return l})})(au);var Ud=au.exports,Gr;(function(e){e.GROUP="g",e.CIRCLE="circle",e.ELLIPSE="ellipse",e.IMAGE="image",e.RECT="rect",e.LINE="line",e.POLYLINE="polyline",e.POLYGON="polygon",e.TEXT="text",e.PATH="path",e.HTML="html",e.MESH="mesh"})(Gr||(Gr={}));var ih;(function(e){e[e.ZERO=0]="ZERO",e[e.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(ih||(ih={}));var Xc=function(){function e(){this.plugins=[]}return e.prototype.addRenderingPlugin=function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)},e.prototype.removeAllRenderingPlugins=function(){var t=this;this.plugins.forEach(function(n){var r=t.context.renderingPlugins.indexOf(n);r>=0&&t.context.renderingPlugins.splice(r,1)})},e}(),jd=function(){function e(t){this.clipSpaceNearZ=ih.NEGATIVE_ONE,this.plugins=[],this.config=(0,z.pi)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},t)}return e.prototype.registerPlugin=function(t){var n=this.plugins.findIndex(function(r){return r===t});n===-1&&this.plugins.push(t)},e.prototype.unregisterPlugin=function(t){var n=this.plugins.findIndex(function(r){return r===t});n>-1&&this.plugins.splice(n,1)},e.prototype.getPlugins=function(){return this.plugins},e.prototype.getPlugin=function(t){return this.plugins.find(function(n){return n.name===t})},e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(t){Object.assign(this.config,t)},e}();function xh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function oh(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function ah(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Qp(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function sh(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function Ff(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function Eh(e){return e===void 0?0:e>360||e<-360?e%360:e}function Al(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=0),Array.isArray(e)&&e.length===3?nt.d9(e):(0,Ft.Z)(e)?nt.al(e,t,n):nt.al(e[0],e[1]||t,e[2]||n)}function ts(e){return e*(Math.PI/180)}function ju(e){return e*(180/Math.PI)}function Jp(e){return e=e%400,e<0&&(e+=400),e/400*360}function L0(e){return e/360}function e0(e){return 360*e}function _(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=n*n,u=r*r,h=i*i,p=s*s,m=l+u+h+p,y=n*s-r*i;return y>.499995*m?(e[0]=Math.PI/2,e[1]=2*Math.atan2(r,n),e[2]=0):y<-.499995*m?(e[0]=-Math.PI/2,e[1]=2*Math.atan2(r,n),e[2]=0):(e[0]=Math.asin(2*(n*i-s*r)),e[1]=Math.atan2(2*(n*s+r*i),1-2*(h+p)),e[2]=Math.atan2(2*(n*r+i*s),1-2*(u+h))),e}function S(e,t){var n,r,i=Math.PI*.5,s=(0,z.CR)(St.getScaling(nt.Ue(),t),3),l=s[0],u=s[1],h=s[2],p=Math.asin(-t[2]/l);return p<i?p>-i?(n=Math.atan2(t[6]/u,t[10]/h),r=Math.atan2(t[1]/l,t[0]/l)):(r=0,n=-Math.atan2(t[4]/u,t[5]/u)):(r=0,n=Math.atan2(t[4]/u,t[5]/u)),e[0]=n,e[1]=p,e[2]=r,e}function x(e,t){return t.length===16?S(e,t):_(e,t)}function C(e,t,n,r,i){var s=Math.cos(e),l=Math.sin(e);return Wt(r*s,i*l,0,-r*l,i*s,0,t,n,1)}function k(e,t,n,r,i,s,l,u){u===void 0&&(u=!1);var h=2*s/(n-t),p=2*s/(r-i),m=(n+t)/(n-t),y=(r+i)/(r-i),b,w;return u?(b=-l/(l-s),w=-l*s/(l-s)):(b=-(l+s)/(l-s),w=-2*l*s/(l-s)),e[0]=h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=m,e[9]=y,e[10]=b,e[11]=-1,e[12]=0,e[13]=0,e[14]=w,e[15]=0,e}function G(e){var t=e[0],n=e[1],r=e[3],i=e[4],s=Math.sqrt(t*t+n*n),l=Math.sqrt(r*r+i*i),u=t*i-n*r;u<0&&(t<i?s=-s:l=-l),s&&(t*=1/s,n*=1/s),l&&(r*=1/l,i*=1/l);var h=Math.atan2(n,t),p=ju(h);return[e[6],e[7],s,l,p]}var q=St.create(),he=St.create(),je=Fr.Ue(),Xe=[nt.Ue(),nt.Ue(),nt.Ue()],kt=nt.Ue();function jt(e,t,n,r,i,s){if(!Yt(q,e)||(St.copy(he,q),he[3]=0,he[7]=0,he[11]=0,he[15]=1,Math.abs(St.determinant(he))<1e-8))return!1;var l=q[3],u=q[7],h=q[11],p=q[12],m=q[13],y=q[14],b=q[15];if(l!==0||u!==0||h!==0){je[0]=l,je[1]=u,je[2]=h,je[3]=b;var w=St.invert(he,he);if(!w)return!1;St.transpose(he,he),Fr.fF(i,je,he)}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=p,t[1]=m,t[2]=y,gn(Xe,q),n[0]=nt.kE(Xe[0]),nt.Fv(Xe[0],Xe[0]),r[0]=nt.AK(Xe[0],Xe[1]),pn(Xe[1],Xe[1],Xe[0],1,-r[0]),n[1]=nt.kE(Xe[1]),nt.Fv(Xe[1],Xe[1]),r[0]/=n[1],r[1]=nt.AK(Xe[0],Xe[2]),pn(Xe[2],Xe[2],Xe[0],1,-r[1]),r[2]=nt.AK(Xe[1],Xe[2]),pn(Xe[2],Xe[2],Xe[1],1,-r[2]),n[2]=nt.kE(Xe[2]),nt.Fv(Xe[2],Xe[2]),r[1]/=n[2],r[2]/=n[2],nt.kC(kt,Xe[1],Xe[2]),nt.AK(Xe[0],kt)<0)for(var R=0;R<3;R++)n[R]*=-1,Xe[R][0]*=-1,Xe[R][1]*=-1,Xe[R][2]*=-1;return s[0]=.5*Math.sqrt(Math.max(1+Xe[0][0]-Xe[1][1]-Xe[2][2],0)),s[1]=.5*Math.sqrt(Math.max(1-Xe[0][0]+Xe[1][1]-Xe[2][2],0)),s[2]=.5*Math.sqrt(Math.max(1-Xe[0][0]-Xe[1][1]+Xe[2][2],0)),s[3]=.5*Math.sqrt(Math.max(1+Xe[0][0]+Xe[1][1]+Xe[2][2],0)),Xe[2][1]>Xe[1][2]&&(s[0]=-s[0]),Xe[0][2]>Xe[2][0]&&(s[1]=-s[1]),Xe[1][0]>Xe[0][1]&&(s[2]=-s[2]),!0}function Yt(e,t){var n=t[15];if(n===0)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0}function gn(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function pn(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i}var Cn=function(){function e(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return e.isEmpty=function(t){return!t||t.halfExtents[0]===0&&t.halfExtents[1]===0&&t.halfExtents[2]===0},e.prototype.update=function(t,n){xh(this.center,t),xh(this.halfExtents,n),oh(this.min,this.center,this.halfExtents),ah(this.max,this.center,this.halfExtents)},e.prototype.setMinMax=function(t,n){ah(this.center,n,t),Qp(this.center,this.center,.5),oh(this.halfExtents,n,t),Qp(this.halfExtents,this.halfExtents,.5),xh(this.min,t),xh(this.max,n)},e.prototype.getMin=function(){return this.min},e.prototype.getMax=function(){return this.max},e.prototype.add=function(t){if(!e.isEmpty(t)){if(e.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return}var n=this.center,r=n[0],i=n[1],s=n[2],l=this.halfExtents,u=l[0],h=l[1],p=l[2],m=r-u,y=r+u,b=i-h,w=i+h,R=s-p,M=s+p,I=t.center,N=I[0],U=I[1],Z=I[2],Y=t.halfExtents,$=Y[0],J=Y[1],se=Y[2],pe=N-$,Ce=N+$,Ue=U-J,Je=U+J,lt=Z-se,Ge=Z+se;pe<m&&(m=pe),Ce>y&&(y=Ce),Ue<b&&(b=Ue),Je>w&&(w=Je),lt<R&&(R=lt),Ge>M&&(M=Ge),n[0]=(m+y)*.5,n[1]=(b+w)*.5,n[2]=(R+M)*.5,l[0]=(y-m)*.5,l[1]=(w-b)*.5,l[2]=(M-R)*.5,this.min[0]=m,this.min[1]=b,this.min[2]=R,this.max[0]=y,this.max[1]=w,this.max[2]=M}},e.prototype.setFromTransformedAABB=function(t,n){var r=this.center,i=this.halfExtents,s=t.center,l=t.halfExtents,u=n[0],h=n[4],p=n[8],m=n[1],y=n[5],b=n[9],w=n[2],R=n[6],M=n[10],I=Math.abs(u),N=Math.abs(h),U=Math.abs(p),Z=Math.abs(m),Y=Math.abs(y),$=Math.abs(b),J=Math.abs(w),se=Math.abs(R),pe=Math.abs(M);r[0]=n[12]+u*s[0]+h*s[1]+p*s[2],r[1]=n[13]+m*s[0]+y*s[1]+b*s[2],r[2]=n[14]+w*s[0]+R*s[1]+M*s[2],i[0]=I*l[0]+N*l[1]+U*l[2],i[1]=Z*l[0]+Y*l[1]+$*l[2],i[2]=J*l[0]+se*l[1]+pe*l[2],oh(this.min,r,i),ah(this.max,r,i)},e.prototype.intersects=function(t){var n=this.getMax(),r=this.getMin(),i=t.getMax(),s=t.getMin();return r[0]<=i[0]&&n[0]>=s[0]&&r[1]<=i[1]&&n[1]>=s[1]&&r[2]<=i[2]&&n[2]>=s[2]},e.prototype.intersection=function(t){if(!this.intersects(t))return null;var n=new e,r=sh([0,0,0],this.getMin(),t.getMin()),i=Ff([0,0,0],this.getMax(),t.getMax());return n.setMinMax(r,i),n},e.prototype.getNegativeFarPoint=function(t){return t.pnVertexFlag===273?xh([0,0,0],this.min):t.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:t.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},e.prototype.getPositiveFarPoint=function(t){return t.pnVertexFlag===273?xh([0,0,0],this.max):t.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:t.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},e}(),un=function(){function e(t,n){this.distance=t||0,this.normal=n||nt.al(0,1,0),this.updatePNVertexFlag()}return e.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},e.prototype.distanceToPoint=function(t){return nt.AK(t,this.normal)-this.distance},e.prototype.normalize=function(){var t=1/nt.Zh(this.normal);nt.bA(this.normal,this.normal,t),this.distance*=t},e.prototype.intersectsLine=function(t,n,r){var i=this.distanceToPoint(t),s=this.distanceToPoint(n),l=i/(i-s),u=l>=0&&l<=1;return u&&r&&nt.t7(r,t,n,l),u},e}(),kn;(function(e){e[e.OUTSIDE=4294967295]="OUTSIDE",e[e.INSIDE=0]="INSIDE",e[e.INDETERMINATE=2147483647]="INDETERMINATE"})(kn||(kn={}));var er=function(){function e(t){if(this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new un)}return e.prototype.extractFromVPMatrix=function(t){var n=(0,z.CR)(t,16),r=n[0],i=n[1],s=n[2],l=n[3],u=n[4],h=n[5],p=n[6],m=n[7],y=n[8],b=n[9],w=n[10],R=n[11],M=n[12],I=n[13],N=n[14],U=n[15];nt.t8(this.planes[0].normal,l-r,m-u,R-y),this.planes[0].distance=U-M,nt.t8(this.planes[1].normal,l+r,m+u,R+y),this.planes[1].distance=U+M,nt.t8(this.planes[2].normal,l+i,m+h,R+b),this.planes[2].distance=U+I,nt.t8(this.planes[3].normal,l-i,m-h,R-b),this.planes[3].distance=U-I,nt.t8(this.planes[4].normal,l-s,m-p,R-w),this.planes[4].distance=U-N,nt.t8(this.planes[5].normal,l+s,m+p,R+w),this.planes[5].distance=U+N,this.planes.forEach(function(Z){Z.normalize(),Z.updatePNVertexFlag()})},e}(),ur=function(){function e(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this.x=0,this.y=0,this.x=t,this.y=n}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},e}(),Cr=function(){function e(t,n,r,i){this.x=t,this.y=n,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=n,this.bottom=n+i}return e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e.applyTransform=function(t,n){var r=Fr.al(t.x,t.y,0,1),i=Fr.al(t.x+t.width,t.y,0,1),s=Fr.al(t.x,t.y+t.height,0,1),l=Fr.al(t.x+t.width,t.y+t.height,0,1),u=Fr.Ue(),h=Fr.Ue(),p=Fr.Ue(),m=Fr.Ue();Fr.fF(u,r,n),Fr.fF(h,i,n),Fr.fF(p,s,n),Fr.fF(m,l,n);var y=Math.min(u[0],h[0],p[0],m[0]),b=Math.min(u[1],h[1],p[1],m[1]),w=Math.max(u[0],h[0],p[0],m[0]),R=Math.max(u[1],h[1],p[1],m[1]);return e.fromRect({x:y,y:b,width:w-y,height:R-b})},e.prototype.toJSON=function(){},e}(),dr="Method not implemented.",Br="Use document.documentElement instead.",ri="Cannot append a destroyed element.",Yr;(function(e){e[e.ORBITING=0]="ORBITING",e[e.EXPLORING=1]="EXPLORING",e[e.TRACKING=2]="TRACKING"})(Yr||(Yr={}));var wi;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ROTATIONAL=1]="ROTATIONAL",e[e.TRANSLATIONAL=2]="TRANSLATIONAL",e[e.CINEMATIC=3]="CINEMATIC"})(wi||(wi={}));var Hi;(function(e){e[e.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",e[e.PERSPECTIVE=1]="PERSPECTIVE"})(Hi||(Hi={}));var Lo={UPDATED:"updated"},Fo=2e-4,ko=function(){function e(){this.clipSpaceNearZ=ih.NEGATIVE_ONE,this.eventEmitter=new Zt,this.matrix=St.create(),this.right=nt.al(1,0,0),this.up=nt.al(0,1,0),this.forward=nt.al(0,0,1),this.position=nt.al(0,0,1),this.focalPoint=nt.al(0,0,0),this.distanceVector=nt.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=St.create(),this.projectionMatrixInverse=St.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Yr.EXPLORING,this.trackingMode=wi.DEFAULT,this.projectionMode=Hi.PERSPECTIVE,this.frustum=new er,this.orthoMatrix=St.create()}return e.prototype.isOrtho=function(){return this.projectionMode===Hi.ORTHOGRAPHIC},e.prototype.getProjectionMode=function(){return this.projectionMode},e.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},e.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},e.prototype.getFrustum=function(){return this.frustum},e.prototype.getPosition=function(){return this.position},e.prototype.getFocalPoint=function(){return this.focalPoint},e.prototype.getDollyingStep=function(){return this.dollyingStep},e.prototype.getNear=function(){return this.near},e.prototype.getFar=function(){return this.far},e.prototype.getZoom=function(){return this.zoom},e.prototype.getOrthoMatrix=function(){return this.orthoMatrix},e.prototype.getView=function(){return this.view},e.prototype.setEnableUpdate=function(t){this.enableUpdate=t},e.prototype.setType=function(t,n){return this.type=t,this.type===Yr.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Yr.TRACKING&&n!==void 0&&this.setTrackingMode(n),this},e.prototype.setProjectionMode=function(t){return this.projectionMode=t,this},e.prototype.setTrackingMode=function(t){if(this.type!==Yr.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this},e.prototype.setWorldRotation=function(t){return this.rotateWorld=t,this._getAngles(),this},e.prototype.getViewTransform=function(){return St.invert(St.create(),this.matrix)},e.prototype.getWorldTransform=function(){return this.matrix},e.prototype.jitterProjectionMatrix=function(t,n){var r=St.fromTranslation(St.create(),[t,n,0]);this.jitteredProjectionMatrix=St.multiply(St.create(),r,this.projectionMatrix)},e.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},e.prototype.setMatrix=function(t){return this.matrix=t,this._update(),this},e.prototype.setProjectionMatrix=function(t){this.projectionMatrix=t},e.prototype.setFov=function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this},e.prototype.setAspect=function(t){return this.setPerspective(this.near,this.far,this.fov,t),this},e.prototype.setNear=function(t){return this.projectionMode===Hi.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this},e.prototype.setFar=function(t){return this.projectionMode===Hi.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this},e.prototype.setViewOffset=function(t,n,r,i,s,l){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=l,this.projectionMode===Hi.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Hi.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.prototype.setZoom=function(t){return this.zoom=t,this.projectionMode===Hi.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Hi.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},e.prototype.setZoomByViewportPoint=function(t,n){var r=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),i=r.x,s=r.y,l=this.roll;this.rotate(0,0,-l),this.setPosition(i,s),this.setFocalPoint(i,s),this.setZoom(t),this.rotate(0,0,l);var u=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),h=u.x,p=u.y,m=nt.al(h-i,p-s,0),y=nt.AK(m,this.right)/nt.kE(this.right),b=nt.AK(m,this.up)/nt.kE(this.up),w=(0,z.CR)(this.getPosition(),2),R=w[0],M=w[1],I=(0,z.CR)(this.getFocalPoint(),2),N=I[0],U=I[1];return this.setPosition(R-y,M-b),this.setFocalPoint(N-y,U-b),this},e.prototype.setPerspective=function(t,n,r,i){var s;this.projectionMode=Hi.PERSPECTIVE,this.fov=r,this.near=t,this.far=n,this.aspect=i;var l=this.near*Math.tan(ts(.5*this.fov))/this.zoom,u=2*l,h=this.aspect*u,p=-.5*h;if(!((s=this.view)===null||s===void 0)&&s.enabled){var m=this.view.fullWidth,y=this.view.fullHeight;p+=this.view.offsetX*h/m,l-=this.view.offsetY*u/y,h*=this.view.width/m,u*=this.view.height/y}return k(this.projectionMatrix,p,p+h,l-u,l,t,this.far,this.clipSpaceNearZ===ih.ZERO),St.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},e.prototype.setOrthographic=function(t,n,r,i,s,l){var u;this.projectionMode=Hi.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=r,this.bottom=i,this.near=s,this.far=l;var h=(this.rright-this.left)/(2*this.zoom),p=(this.top-this.bottom)/(2*this.zoom),m=(this.rright+this.left)/2,y=(this.top+this.bottom)/2,b=m-h,w=m+h,R=y+p,M=y-p;if(!((u=this.view)===null||u===void 0)&&u.enabled){var I=(this.rright-this.left)/this.view.fullWidth/this.zoom,N=(this.top-this.bottom)/this.view.fullHeight/this.zoom;b+=I*this.view.offsetX,w=b+I*this.view.width,R-=N*this.view.offsetY,M=R-N*this.view.height}return this.clipSpaceNearZ===ih.NEGATIVE_ONE?St.ortho(this.projectionMatrix,b,w,R,M,s,l):St.orthoZO(this.projectionMatrix,b,w,R,M,s,l),St.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},e.prototype.setPosition=function(t,n,r){n===void 0&&(n=this.position[1]),r===void 0&&(r=this.position[2]);var i=Al(t,n,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},e.prototype.setFocalPoint=function(t,n,r){n===void 0&&(n=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=nt.al(0,1,0);if(this.focalPoint=Al(t,n,r),this.trackingMode===wi.CINEMATIC){var s=nt.$X(nt.Ue(),this.focalPoint,this.position);t=s[0],n=s[1],r=s[2];var l=nt.kE(s),u=ju(Math.asin(n/l)),h=90+ju(Math.atan2(r,t)),p=St.create();St.rotateY(p,p,ts(h)),St.rotateX(p,p,ts(u)),i=nt.fF(nt.Ue(),[0,1,0],p)}return St.invert(this.matrix,St.lookAt(St.create(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},e.prototype.getDistance=function(){return this.distance},e.prototype.getDistanceVector=function(){return this.distanceVector},e.prototype.setDistance=function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<Fo&&(this.distance=Fo),this.dollyingStep=this.distance/100;var n=nt.Ue();t=this.distance;var r=this.forward,i=this.focalPoint;return n[0]=t*r[0]+i[0],n[1]=t*r[1]+i[1],n[2]=t*r[2]+i[2],this._setPosition(n),this.triggerUpdate(),this},e.prototype.setMaxDistance=function(t){return this.maxDistance=t,this},e.prototype.setMinDistance=function(t){return this.minDistance=t,this},e.prototype.setAzimuth=function(t){return this.azimuth=Eh(t),this.computeMatrix(),this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.prototype.getAzimuth=function(){return this.azimuth},e.prototype.setElevation=function(t){return this.elevation=Eh(t),this.computeMatrix(),this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.prototype.getElevation=function(){return this.elevation},e.prototype.setRoll=function(t){return this.roll=Eh(t),this.computeMatrix(),this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.prototype.getRoll=function(){return this.roll},e.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},e.prototype.computeMatrix=function(){var t=fi(qr(),[0,0,1],ts(this.roll));St.identity(this.matrix);var n=fi(qr(),[1,0,0],ts((this.rotateWorld&&this.type!==Yr.TRACKING||this.type===Yr.TRACKING?1:-1)*this.elevation)),r=fi(qr(),[0,1,0],ts((this.rotateWorld&&this.type!==Yr.TRACKING||this.type===Yr.TRACKING?1:-1)*this.azimuth)),i=vo(qr(),r,n);i=vo(qr(),i,t);var s=St.fromQuat(St.create(),i);this.type===Yr.ORBITING||this.type===Yr.EXPLORING?(St.translate(this.matrix,this.matrix,this.focalPoint),St.multiply(this.matrix,this.matrix,s),St.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===Yr.TRACKING&&(St.translate(this.matrix,this.matrix,this.position),St.multiply(this.matrix,this.matrix,s))},e.prototype._setPosition=function(t,n,r){this.position=Al(t,n,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},e.prototype._getAxes=function(){nt.JG(this.right,Al(Fr.fF(Fr.Ue(),[1,0,0,0],this.matrix))),nt.JG(this.up,Al(Fr.fF(Fr.Ue(),[0,1,0,0],this.matrix))),nt.JG(this.forward,Al(Fr.fF(Fr.Ue(),[0,0,1,0],this.matrix))),nt.Fv(this.right,this.right),nt.Fv(this.up,this.up),nt.Fv(this.forward,this.forward)},e.prototype._getAngles=function(){var t=this.distanceVector[0],n=this.distanceVector[1],r=this.distanceVector[2],i=nt.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===Yr.TRACKING?(this.elevation=ju(Math.asin(n/i)),this.azimuth=ju(Math.atan2(-t,-r))):this.rotateWorld?(this.elevation=ju(Math.asin(n/i)),this.azimuth=ju(Math.atan2(-t,-r))):(this.elevation=-ju(Math.asin(n/i)),this.azimuth=-ju(Math.atan2(-t,-r)))},e.prototype._getPosition=function(){nt.JG(this.position,Al(Fr.fF(Fr.Ue(),[0,0,0,1],this.matrix))),this._getDistance()},e.prototype._getFocalPoint=function(){nt.kK(this.distanceVector,[0,0,-this.distance],qn(Wn(),this.matrix)),nt.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},e.prototype._getDistance=function(){this.distanceVector=nt.$X(nt.Ue(),this.focalPoint,this.position),this.distance=nt.kE(this.distanceVector),this.dollyingStep=this.distance/100},e.prototype._getOrthoMatrix=function(){if(this.projectionMode===Hi.ORTHOGRAPHIC){var t=this.position,n=fi(qr(),[0,0,1],-this.roll*Math.PI/180);St.fromRotationTranslationScaleOrigin(this.orthoMatrix,n,nt.al((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),nt.al(this.zoom,this.zoom,1),t)}},e.prototype.triggerUpdate=function(){if(this.enableUpdate){var t=this.getViewTransform(),n=St.multiply(St.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit(Lo.UPDATED)}},e.prototype.rotate=function(t,n,r){throw new Error(dr)},e.prototype.pan=function(t,n){throw new Error(dr)},e.prototype.dolly=function(t){throw new Error(dr)},e.prototype.createLandmark=function(t,n){throw new Error(dr)},e.prototype.gotoLandmark=function(t,n){throw new Error(dr)},e.prototype.cancelLandmarkAnimation=function(){throw new Error(dr)},e}();function fa(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=t?t.apply(this,r):r[0],l=n.cache;if(l.has(s))return l.get(s);var u=e.apply(this,r);return n.cache=l.set(s,u)||l,u};return n.cache=new(fa.Cache||Map),n}fa.Cache=Map;var Bn;(function(e){e[e.kUnknown=0]="kUnknown",e[e.kNumber=1]="kNumber",e[e.kPercentage=2]="kPercentage",e[e.kEms=3]="kEms",e[e.kPixels=4]="kPixels",e[e.kRems=5]="kRems",e[e.kDegrees=6]="kDegrees",e[e.kRadians=7]="kRadians",e[e.kGradians=8]="kGradians",e[e.kTurns=9]="kTurns",e[e.kMilliseconds=10]="kMilliseconds",e[e.kSeconds=11]="kSeconds",e[e.kInteger=12]="kInteger"})(Bn||(Bn={}));var qt;(function(e){e[e.kUNumber=0]="kUNumber",e[e.kUPercent=1]="kUPercent",e[e.kULength=2]="kULength",e[e.kUAngle=3]="kUAngle",e[e.kUTime=4]="kUTime",e[e.kUOther=5]="kUOther"})(qt||(qt={}));var ua;(function(e){e[e.kAll=0]="kAll",e[e.kNonNegative=1]="kNonNegative",e[e.kInteger=2]="kInteger",e[e.kNonNegativeInteger=3]="kNonNegativeInteger",e[e.kPositiveInteger=4]="kPositiveInteger"})(ua||(ua={}));var ra;(function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"})(ra||(ra={}));var Ho;(function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"})(Ho||(Ho={}));var _a=[{name:"em",unit_type:Bn.kEms},{name:"px",unit_type:Bn.kPixels},{name:"deg",unit_type:Bn.kDegrees},{name:"rad",unit_type:Bn.kRadians},{name:"grad",unit_type:Bn.kGradians},{name:"ms",unit_type:Bn.kMilliseconds},{name:"s",unit_type:Bn.kSeconds},{name:"rem",unit_type:Bn.kRems},{name:"turn",unit_type:Bn.kTurns}],Vo;(function(e){e[e.kUnknownType=0]="kUnknownType",e[e.kUnparsedType=1]="kUnparsedType",e[e.kKeywordType=2]="kKeywordType",e[e.kUnitType=3]="kUnitType",e[e.kSumType=4]="kSumType",e[e.kProductType=5]="kProductType",e[e.kNegateType=6]="kNegateType",e[e.kInvertType=7]="kInvertType",e[e.kMinType=8]="kMinType",e[e.kMaxType=9]="kMaxType",e[e.kClampType=10]="kClampType",e[e.kTransformType=11]="kTransformType",e[e.kPositionType=12]="kPositionType",e[e.kURLImageType=13]="kURLImageType",e[e.kColorType=14]="kColorType",e[e.kUnsupportedColorType=15]="kUnsupportedColorType"})(Vo||(Vo={}));var Do=function(e){return _a.find(function(t){return t.name===e}).unit_type},hc=function(e){return e?e==="number"?Bn.kNumber:e==="percent"||e==="%"?Bn.kPercentage:Do(e):Bn.kUnknown},vl=function(e){switch(e){case Bn.kNumber:case Bn.kInteger:return qt.kUNumber;case Bn.kPercentage:return qt.kUPercent;case Bn.kPixels:return qt.kULength;case Bn.kMilliseconds:case Bn.kSeconds:return qt.kUTime;case Bn.kDegrees:case Bn.kRadians:case Bn.kGradians:case Bn.kTurns:return qt.kUAngle;default:return qt.kUOther}},Fc=function(e){switch(e){case qt.kUNumber:return Bn.kNumber;case qt.kULength:return Bn.kPixels;case qt.kUPercent:return Bn.kPercentage;case qt.kUTime:return Bn.kSeconds;case qt.kUAngle:return Bn.kDegrees;default:return Bn.kUnknown}},Gl=function(e){var t=1;switch(e){case Bn.kPixels:case Bn.kDegrees:case Bn.kSeconds:break;case Bn.kMilliseconds:t=.001;break;case Bn.kRadians:t=180/Math.PI;break;case Bn.kGradians:t=.9;break;case Bn.kTurns:t=360;break}return t},bs=function(e){switch(e){case Bn.kNumber:case Bn.kInteger:return"";case Bn.kPercentage:return"%";case Bn.kEms:return"em";case Bn.kRems:return"rem";case Bn.kPixels:return"px";case Bn.kDegrees:return"deg";case Bn.kRadians:return"rad";case Bn.kGradians:return"grad";case Bn.kMilliseconds:return"ms";case Bn.kSeconds:return"s";case Bn.kTurns:return"turn"}return""},Qs=function(){function e(){}return e.isAngle=function(t){return t===Bn.kDegrees||t===Bn.kRadians||t===Bn.kGradians||t===Bn.kTurns},e.isLength=function(t){return t>=Bn.kEms&&t<Bn.kDegrees},e.isRelativeUnit=function(t){return t===Bn.kPercentage||t===Bn.kEms||t===Bn.kRems},e.isTime=function(t){return t===Bn.kSeconds||t===Bn.kMilliseconds},e.prototype.toString=function(){return this.buildCSSText(ra.kNo,Ho.kNo,"")},e.prototype.isNumericValue=function(){return this.getType()>=Vo.kUnitType&&this.getType()<=Vo.kClampType},e}(),ll=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this)||this;return r.colorSpace=n,r}return t.prototype.getType=function(){return Vo.kColorType},t.prototype.to=function(n){return this},t}(Qs),gl;(function(e){e[e.Constant=0]="Constant",e[e.LinearGradient=1]="LinearGradient",e[e.RadialGradient=2]="RadialGradient"})(gl||(gl={}));var _f=function(e){(0,z.ZT)(t,e);function t(n,r){var i=e.call(this)||this;return i.type=n,i.value=r,i}return t.prototype.clone=function(){return new t(this.type,this.value)},t.prototype.buildCSSText=function(n,r,i){return i},t.prototype.getType=function(){return Vo.kColorType},t}(Qs),al=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this)||this;return r.value=n,r}return t.prototype.clone=function(){return new t(this.value)},t.prototype.getType=function(){return Vo.kKeywordType},t.prototype.buildCSSText=function(n,r,i){return i+this.value},t}(Qs),sf=fa(function(e){return e===void 0&&(e=""),e.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})}),Vu=function(e){return e.split("").map(function(t,n){return t.toUpperCase()===t?"".concat(n!==0?"-":"").concat(t.toLowerCase()):t}).join("")};function Vd(e){if(!e)throw new Error}function kf(e){return typeof e=="function"}function Sh(e){return typeof e=="symbol"}var Hd=function(e){return Object.fromEntries(Object.entries(e).filter(function(t){var n=__read(t,2),r=n[1];return r!==void 0}))},$h={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},bf=fa(function(e){var t=sf(e),n=$h[t];return t=(n==null?void 0:n.alias)||t,t}),Ai=function(e,t){t===void 0&&(t="");var n="";return Number.isFinite(e)?(Vd(Number.isNaN(e)),n="NaN"):e>0?n="infinity":n="-infinity",n+=t},hl=function(e){return Fc(vl(e))},ba=function(e){(0,z.ZT)(t,e);function t(n,r){r===void 0&&(r=Bn.kNumber);var i=e.call(this)||this,s;return typeof r=="string"?s=hc(r):s=r,i.unit=s,i.value=n,i}return t.prototype.clone=function(){return new t(this.value,this.unit)},t.prototype.equals=function(n){var r=n;return this.value===r.value&&this.unit===r.unit},t.prototype.getType=function(){return Vo.kUnitType},t.prototype.convertTo=function(n){if(this.unit===n)return new t(this.value,this.unit);var r=hl(this.unit);if(r!==hl(n)||r===Bn.kUnknown)return null;var i=Gl(this.unit)/Gl(n);return new t(this.value*i,n)},t.prototype.buildCSSText=function(n,r,i){var s;switch(this.unit){case Bn.kUnknown:break;case Bn.kInteger:s=Number(this.value).toFixed(0);break;case Bn.kNumber:case Bn.kPercentage:case Bn.kEms:case Bn.kRems:case Bn.kPixels:case Bn.kDegrees:case Bn.kRadians:case Bn.kGradians:case Bn.kMilliseconds:case Bn.kSeconds:case Bn.kTurns:{var l=-999999,u=999999,h=this.value,p=bs(this.unit);if(h<l||h>u){var m=bs(this.unit);!Number.isFinite(h)||Number.isNaN(h)?s=Ai(h,m):s=h+(m||"")}else s="".concat(h).concat(p)}}return i+=s,i},t}(Qs),xs=new ba(0,"px");new ba(1,"px");var Fl=new ba(0,"deg"),Hu=function(e){(0,z.ZT)(t,e);function t(n,r,i,s,l){s===void 0&&(s=1),l===void 0&&(l=!1);var u=e.call(this,"rgb")||this;return u.r=n,u.g=r,u.b=i,u.alpha=s,u.isNone=l,u}return t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.alpha)},t.prototype.buildCSSText=function(n,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},t}(ll),No=new al("unset"),kl=new al("initial"),Xl=new al("inherit"),xf={"":No,unset:No,initial:kl,inherit:Xl},Zd=function(e){return xf[e]||(xf[e]=new al(e)),xf[e]},lf=new Hu(0,0,0,0,!0),Ep=new Hu(0,0,0,0),Ad=fa(function(e,t,n,r){return new Hu(e,t,n,r)},function(e,t,n,r){return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")}),Ls=function(e,t){return t===void 0&&(t=Bn.kNumber),new ba(e,t)};new ba(50,"%");var cf;(function(e){e[e.Standard=0]="Standard"})(cf||(cf={}));var lh;(function(e){e[e.ADDED=0]="ADDED",e[e.REMOVED=1]="REMOVED",e[e.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(lh||(lh={}));var D0={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Cr(0,0,0,0)},io;(function(e){e.COORDINATE="<coordinate>",e.COLOR="<color>",e.PAINT="<paint>",e.NUMBER="<number>",e.ANGLE="<angle>",e.OPACITY_VALUE="<opacity-value>",e.SHADOW_BLUR="<shadow-blur>",e.LENGTH="<length>",e.PERCENTAGE="<percentage>",e.LENGTH_PERCENTAGE="<length> | <percentage>",e.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",e.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",e.LIST_OF_POINTS="<list-of-points>",e.PATH="<path>",e.FILTER="<filter>",e.Z_INDEX="<z-index>",e.OFFSET_DISTANCE="<offset-distance>",e.DEFINED_PATH="<defined-path>",e.MARKER="<marker>",e.TRANSFORM="<transform>",e.TRANSFORM_ORIGIN="<transform-origin>",e.TEXT="<text>",e.TEXT_TRANSFORM="<text-transform>"})(io||(io={}));function gu(e){var t=e.type,n=e.value;return t==="hex"?"#".concat(n):t==="literal"?n:t==="rgb"?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}var ey=function(){var e={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function n(Vt){throw new Error(t+": "+Vt)}function r(){var Vt=i();return t.length>0&&n("Invalid input not EOF"),Vt}function i(){return Z(s)}function s(){return l("linear-gradient",e.linearGradient,h)||l("repeating-linear-gradient",e.repeatingLinearGradient,h)||l("radial-gradient",e.radialGradient,y)||l("repeating-radial-gradient",e.repeatingRadialGradient,y)||l("conic-gradient",e.conicGradient,y)}function l(Vt,wt,zt){return u(wt,function(En){var Vn=zt();return Vn&&(st(e.comma)||n("Missing comma before color stops")),{type:Vt,orientation:Vn,colorStops:Z(Y)}})}function u(Vt,wt){var zt=st(Vt);if(zt){st(e.startCall)||n("Missing (");var En=wt(zt);return st(e.endCall)||n("Missing )"),En}}function h(){return p()||m()}function p(){return at("directional",e.sideOrCorner,1)}function m(){return at("angular",e.angleValue,1)}function y(){var Vt,wt=b(),zt;return wt&&(Vt=[],Vt.push(wt),zt=t,st(e.comma)&&(wt=b(),wt?Vt.push(wt):t=zt)),Vt}function b(){var Vt=w()||R();if(Vt)Vt.at=I();else{var wt=M();if(wt){Vt=wt;var zt=I();zt&&(Vt.at=zt)}else{var En=N();En&&(Vt={type:"default-radial",at:En})}}return Vt}function w(){var Vt=at("shape",/^(circle)/i,0);return Vt&&(Vt.style=Ge()||M()),Vt}function R(){var Vt=at("shape",/^(ellipse)/i,0);return Vt&&(Vt.style=Je()||M()),Vt}function M(){return at("extent-keyword",e.extentKeywords,1)}function I(){if(at("position",/^at/,0)){var Vt=N();return Vt||n("Missing positioning value"),Vt}}function N(){var Vt=U();if(Vt.x||Vt.y)return{type:"position",value:Vt}}function U(){return{x:Je(),y:Je()}}function Z(Vt){var wt=Vt(),zt=[];if(wt)for(zt.push(wt);st(e.comma);)wt=Vt(),wt?zt.push(wt):n("One extra comma");return zt}function Y(){var Vt=$();return Vt||n("Expected color definition"),Vt.length=Je(),Vt}function $(){return se()||Ce()||pe()||J()}function J(){return at("literal",e.literalColor,0)}function se(){return at("hex",e.hexColor,1)}function pe(){return u(e.rgbColor,function(){return{type:"rgb",value:Z(Ue)}})}function Ce(){return u(e.rgbaColor,function(){return{type:"rgba",value:Z(Ue)}})}function Ue(){return st(e.number)[1]}function Je(){return at("%",e.percentageValue,1)||lt()||Ge()}function lt(){return at("position-keyword",e.positionKeywords,1)}function Ge(){return at("px",e.pixelValue,1)||at("em",e.emValue,1)}function at(Vt,wt,zt){var En=st(wt);if(En)return{type:Vt,value:En[zt]}}function st(Vt){var wt=/^[\n\r\t\s]+/.exec(t);wt&&ft(wt[0].length);var zt=Vt.exec(t);return zt&&ft(zt[0].length),zt}function ft(Vt){t=t.substring(Vt)}return function(Vt){return t=Vt,r()}}();function lm(e,t,n,r){var i=ts(r.value),s=0,l=0,u=s+t/2,h=l+n/2,p=Math.abs(t*Math.cos(i))+Math.abs(n*Math.sin(i)),m=e[0]+u-Math.cos(i)*p/2,y=e[1]+h-Math.sin(i)*p/2,b=e[0]+u+Math.cos(i)*p/2,w=e[1]+h+Math.sin(i)*p/2;return{x1:m,y1:y,x2:b,y2:w}}function Sp(e,t,n,r,i,s){var l=r.value,u=i.value;r.unit===Bn.kPercentage&&(l=r.value/100*t),i.unit===Bn.kPercentage&&(u=i.value/100*n);var h=Math.max(Dn([0,0],[l,u]),Dn([0,n],[l,u]),Dn([t,n],[l,u]),Dn([t,0],[l,u]));return s&&(s instanceof ba?h=s.value:s instanceof al&&(s.value==="closest-side"?h=Math.min(l,t-l,u,n-u):s.value==="farthest-side"?h=Math.max(l,t-l,u,n-u):s.value==="closest-corner"&&(h=Math.min(Dn([0,0],[l,u]),Dn([0,n],[l,u]),Dn([t,n],[l,u]),Dn([t,0],[l,u]))))),{x:l+e[0],y:u+e[1],r:h}}var ty=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Gv=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ny=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,cm=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function um(e){var t,n,r,i=e.length;e[i-1].length=(t=e[i-1].length)!==null&&t!==void 0?t:{type:"%",value:"100"},i>1&&(e[0].length=(n=e[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"});for(var s=0,l=Number(e[0].length.value),u=1;u<i;u++){var h=(r=e[u].length)===null||r===void 0?void 0:r.value;if(!(0,sr.Z)(h)&&!(0,sr.Z)(l)){for(var p=1;p<u-s;p++)e[s+p].length={type:"%",value:"".concat(l+(Number(h)-l)*p/(u-s))};s=u,l=Number(h)}}}var N0={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},ry=fa(function(e){var t;return e.type==="angular"?t=Number(e.value):t=N0[e.value]||0,Ls(t,"deg")}),Tp=fa(function(e){var t=50,n=50,r="%",i="%";if((e==null?void 0:e.type)==="position"){var s=e.value,l=s.x,u=s.y;(l==null?void 0:l.type)==="position-keyword"&&(l.value==="left"?t=0:l.value==="center"?t=50:l.value==="right"?t=100:l.value==="top"?n=0:l.value==="bottom"&&(n=100)),(u==null?void 0:u.type)==="position-keyword"&&(u.value==="left"?t=0:u.value==="center"?n=50:u.value==="right"?t=100:u.value==="top"?n=0:u.value==="bottom"&&(n=100)),((l==null?void 0:l.type)==="px"||(l==null?void 0:l.type)==="%"||(l==null?void 0:l.type)==="em")&&(r=l==null?void 0:l.type,t=Number(l.value)),((u==null?void 0:u.type)==="px"||(u==null?void 0:u.type)==="%"||(u==null?void 0:u.type)==="em")&&(i=u==null?void 0:u.type,n=Number(u.value))}return{cx:Ls(t,r),cy:Ls(n,i)}}),wp=fa(function(e){var t;if(e.indexOf("linear")>-1||e.indexOf("radial")>-1){var n=ey(e);return n.map(function(u){var h=u.type,p=u.orientation,m=u.colorStops;um(m);var y=m.map(function(Z){return{offset:Ls(Number(Z.length.value),"%"),color:gu(Z)}});if(h==="linear-gradient")return new _f(gl.LinearGradient,{angle:p?ry(p):Fl,steps:y});if(h==="radial-gradient"&&(p||(p=[{type:"shape",value:"circle"}]),p[0].type==="shape"&&p[0].value==="circle")){var b=Tp(p[0].at),w=b.cx,R=b.cy,M=void 0;if(p[0].style){var I=p[0].style,N=I.type,U=I.value;N==="extent-keyword"?M=Zd(U):M=Ls(U,N)}return new _f(gl.RadialGradient,{cx:w,cy:R,size:M,steps:y})}})}var r=e[0];if(e[1]==="("||e[2]==="("){if(r==="l"){var i=ty.exec(e);if(i){var s=((t=i[2].match(cm))===null||t===void 0?void 0:t.map(function(u){return u.split(":")}))||[];return[new _f(gl.LinearGradient,{angle:Ls(parseFloat(i[1]),"deg"),steps:s.map(function(u){var h=(0,z.CR)(u,2),p=h[0],m=h[1];return{offset:Ls(Number(p)*100,"%"),color:m}})})]}}else if(r==="r"){var l=ev(e);if(l)if(bi(l))e=l;else return[new _f(gl.RadialGradient,l)]}else if(r==="p")return tv(e)}});function ev(e){var t,n=Gv.exec(e);if(n){var r=((t=n[4].match(cm))===null||t===void 0?void 0:t.map(function(i){return i.split(":")}))||[];return{cx:Ls(50,"%"),cy:Ls(50,"%"),steps:r.map(function(i){var s=(0,z.CR)(i,2),l=s[0],u=s[1];return{offset:Ls(Number(l)*100,"%"),color:u}})}}return null}function tv(e){var t=ny.exec(e);if(t){var n=t[1],r=t[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;case"n":n="no-repeat";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}function iy(e){return!!e.type&&!!e.value}function Wd(e){return e&&!!e.image}function t0(e){return e&&!(0,sr.Z)(e.r)&&!(0,sr.Z)(e.g)&&!(0,sr.Z)(e.b)}var Kh=fa(function(e){if(Wd(e))return(0,z.pi)({repetition:"repeat"},e);if((0,sr.Z)(e)&&(e=""),e==="transparent")return Ep;if(e==="currentColor")e="black";else if(e==="none")return lf;var t=wp(e);if(t)return t;var n=Lf(e),r=[0,0,0,0];return n!==null&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),Ad.apply(void 0,(0,z.ev)([],(0,z.CR)(r),!1))});function nv(e,t){if(!(!t0(e)||!t0(t)))return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(n){var r=n.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round((0,so.Z)(r[i],0,255));return r[3]=(0,so.Z)(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function qh(e,t){if((0,sr.Z)(t))return Ls(0,"px");if(t="".concat(t).trim().toLowerCase(),isFinite(Number(t))){if("px".search(e)>=0)return Ls(Number(t),"px");if("deg".search(e)>=0)return Ls(Number(t),"deg")}var n=[];t=t.replace(e,function(i){return n.push(i),"U"+i});var r="U("+e.source+")";return n.map(function(i){return Ls(Number(t.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var B0=function(e){return qh(new RegExp("px","g"),e)},Yc=fa(B0),Ap=function(e){return qh(new RegExp("%","g"),e)};fa(Ap);var Js=function(e){return(0,Ft.Z)(e)||isFinite(Number(e))?Ls(Number(e)||0,"px"):qh(new RegExp("px|%|em|rem","g"),e)},Ef=fa(Js),F0=function(e){return qh(new RegExp("deg|rad|grad|turn","g"),e)},Gd=fa(F0);function Cp(e,t,n,r,i){i===void 0&&(i=0);var s="",l=e.value||0,u=t.value||0,h=hl(e.unit),p=e.convertTo(h),m=t.convertTo(h);return p&&m?(l=p.value,u=m.value,s=bs(e.unit)):(ba.isLength(e.unit)||ba.isLength(t.unit))&&(l=yl(e,i,n),u=yl(t,i,n),s="px"),[l,u,function(y){return r&&(y=Math.max(y,0)),y+s}]}function dc(e){var t=0;return e.unit===Bn.kDegrees?t=e.value:e.unit===Bn.kRadians?t=ju(Number(e.value)):e.unit===Bn.kTurns&&(t=e0(Number(e.value))),t}function Xd(e,t){var n;return Array.isArray(e)?n=e.map(function(r){return Number(r)}):bi(e)?n=e.split(" ").map(function(r){return Number(r)}):(0,Ft.Z)(e)&&(n=[e]),t===2?n.length===1?[n[0],n[0]]:[n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===3?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]}function Qh(e){return bi(e)?e.split(" ").map(function(t){return Ef(t)}):e.map(function(t){return Ef(t.toString())})}function yl(e,t,n,r){if(r===void 0&&(r=!1),e.unit===Bn.kPixels)return Number(e.value);if(e.unit===Bn.kPercentage&&n){var i=n.nodeName===Gr.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[t]:0)+e.value/100*i.halfExtents[t]*2}return 0}var Op=function(e){return qh(/deg|rad|grad|turn|px|%/g,e)},n0=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function fm(e){if(e===void 0&&(e=""),e=e.toLowerCase().trim(),e==="none")return[];for(var t=/\s*([\w-]+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];if(i=r.index+r[0].length,n0.indexOf(r[1])>-1&&n.push({name:r[1],params:r[2].split(" ").map(function(s){return Op(s)||Kh(s)})}),t.lastIndex===e.length)return n}return[]}function Th(e){return e.toString()}var su=function(e){return typeof e=="number"?Ls(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?Ls(Number(e)):Ls(0)},yu=fa(su);fa(function(e){return bi(e)?e.split(" ").map(yu):e.map(yu)});function r0(e,t){return[e,t,Th]}function i0(e,t){return function(n,r){return[n,r,function(i){return Th((0,so.Z)(i,e,t))}]}}function Rp(e,t){if(e.length===t.length)return[e,t,function(n){return n}]}function Sf(e){return e.parsedStyle.d.totalLength===0&&(e.parsedStyle.d.totalLength=Nl(e.parsedStyle.d.absolutePath)),e.parsedStyle.d.totalLength}function Cd(e){return e.parsedStyle.points.totalLength===0&&(e.parsedStyle.points.totalLength=Wl(e.parsedStyle.points.points)),e.parsedStyle.points.totalLength}function oy(e){for(var t=0;t<e.length;t++){var n=e[t-1],r=e[t],i=r[0];if(i==="M"&&n){var s=n[0],l=[r[1],r[2]],u=void 0;s==="L"||s==="M"?u=[n[1],n[2]]:(s==="C"||s==="A"||s==="Q")&&(u=[n[n.length-2],n[n.length-1]]),u&&k0(l,u)&&(e.splice(t,1),t--)}}}function ay(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r],s=i[0];if(s==="C"||s==="A"||s==="Q"){t=!0;break}}return t}function rv(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var s=e[i],l=s[0];l==="M"?(r.length&&(n.push(r),r=[]),r.push([s[1],s[2]])):l==="Z"?r.length&&(t.push(r),r=[]):r.push([s[1],s[2]])}return r.length>0&&n.push(r),{polygons:t,polylines:n}}function k0(e,t){return e[0]===t[0]&&e[1]===t[1]}function Jh(e,t){for(var n=[],r=[],i=[],s=0;s<e.length;s++){var l=e[s],u=l.currentPoint,h=l.params,p=l.prePoint,m=void 0;switch(l.command){case"Q":m=fc(p[0],p[1],h[1],h[2],h[3],h[4]);break;case"C":m=nh(p[0],p[1],h[1],h[2],h[3],h[4],h[5],h[6]);break;case"A":var y=l.arcParams;m=qs(y.cx,y.cy,y.rx,y.ry,y.xRotation,y.startAngle,y.endAngle);break;default:n.push(u[0]),r.push(u[1]);break}m&&(l.box=m,n.push(m.x,m.x+m.width),r.push(m.y,m.y+m.height)),t&&(l.command==="L"||l.command==="M")&&l.prePoint&&l.nextPoint&&i.push(l)}n=n.filter(function(N){return!Number.isNaN(N)&&N!==1/0&&N!==-1/0}),r=r.filter(function(N){return!Number.isNaN(N)&&N!==1/0&&N!==-1/0});var b=nu(n),w=nu(r),R=sc(n),M=sc(r);if(i.length===0)return{x:b,y:w,width:R-b,height:M-w};for(var s=0;s<i.length;s++){var l=i[s],u=l.currentPoint,I=void 0;u[0]===b?(I=hm(l,t),b=b-I.xExtra):u[0]===R&&(I=hm(l,t),R=R+I.xExtra),u[1]===w?(I=hm(l,t),w=w-I.yExtra):u[1]===M&&(I=hm(l,t),M=M+I.yExtra)}return{x:b,y:w,width:R-b,height:M-w}}function hm(e,t){var n=e.prePoint,r=e.currentPoint,i=e.nextPoint,s=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),l=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),u=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),h=Math.acos((s+l-u)/(2*Math.sqrt(s)*Math.sqrt(l)));if(!h||Math.sin(h)===0||lc(h,0))return{xExtra:0,yExtra:0};var p=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),m=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));p=p>Math.PI/2?Math.PI-p:p,m=m>Math.PI/2?Math.PI-m:m;var y={xExtra:Math.cos(h/2-p)*(t/2*(1/Math.sin(h/2)))-t/2||0,yExtra:Math.cos(m-h/2)*(t/2*(1/Math.sin(h/2)))-t/2||0};return y}function zf(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}var o0=function(e,t){var n=e.x*t.x+e.y*t.y,r=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2))),i=e.x*t.y-e.y*t.x<0?-1:1,s=i*Math.acos(n/r);return s},Yd=function(e,t,n,r,i,s,l,u){t=Math.abs(t),n=Math.abs(n),r=Bl(r,360);var h=ts(r);if(e.x===l.x&&e.y===l.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(t===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var p=(e.x-l.x)/2,m=(e.y-l.y)/2,y={x:Math.cos(h)*p+Math.sin(h)*m,y:-Math.sin(h)*p+Math.cos(h)*m},b=Math.pow(y.x,2)/Math.pow(t,2)+Math.pow(y.y,2)/Math.pow(n,2);b>1&&(t=Math.sqrt(b)*t,n=Math.sqrt(b)*n);var w=Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(y.y,2)-Math.pow(n,2)*Math.pow(y.x,2),R=Math.pow(t,2)*Math.pow(y.y,2)+Math.pow(n,2)*Math.pow(y.x,2),M=w/R;M=M<0?0:M;var I=(i!==s?1:-1)*Math.sqrt(M),N={x:I*(t*y.y/n),y:I*(-(n*y.x)/t)},U={x:Math.cos(h)*N.x-Math.sin(h)*N.y+(e.x+l.x)/2,y:Math.sin(h)*N.x+Math.cos(h)*N.y+(e.y+l.y)/2},Z={x:(y.x-N.x)/t,y:(y.y-N.y)/n},Y=o0({x:1,y:0},Z),$={x:(-y.x-N.x)/t,y:(-y.y-N.y)/n},J=o0(Z,$);!s&&J>0?J-=2*Math.PI:s&&J<0&&(J+=2*Math.PI),J%=2*Math.PI;var se=Y+J*u,pe=t*Math.cos(se),Ce=n*Math.sin(se),Ue={x:Math.cos(h)*pe-Math.sin(h)*Ce+U.x,y:Math.sin(h)*pe+Math.cos(h)*Ce+U.y,ellipticalArcStartAngle:Y,ellipticalArcEndAngle:Y+J,ellipticalArcAngle:se,ellipticalArcCenter:U,resultantRx:t,resultantRy:n};return Ue};function $d(e){for(var t=[],n=null,r=null,i=null,s=0,l=e.length,u=0;u<l;u++){var h=e[u];r=e[u+1];var p=h[0],m={command:p,prePoint:n,params:h,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(p){case"M":i=[h[1],h[2]],s=u;break;case"A":var y=_u(n,h);m.arcParams=y;break}if(p==="Z")n=i,r=e[s+1];else{var b=h.length;n=[h[b-2],h[b-1]]}r&&r[0]==="Z"&&(r=e[s],t[s]&&(t[s].prePoint=n)),m.currentPoint=n,t[s]&&k0(n,t[s].currentPoint)&&(t[s].prePoint=m.prePoint);var w=r?[r[r.length-2],r[r.length-1]]:null;m.nextPoint=w;var R=m.prePoint;if(["L","H","V"].includes(p))m.startTangent=[R[0]-n[0],R[1]-n[1]],m.endTangent=[n[0]-R[0],n[1]-R[1]];else if(p==="Q"){var M=[h[1],h[2]];m.startTangent=[R[0]-M[0],R[1]-M[1]],m.endTangent=[n[0]-M[0],n[1]-M[1]]}else if(p==="T"){var I=t[u-1],M=zf(I.currentPoint,R);I.command==="Q"?(m.command="Q",m.startTangent=[R[0]-M[0],R[1]-M[1]],m.endTangent=[n[0]-M[0],n[1]-M[1]]):(m.command="TL",m.startTangent=[R[0]-n[0],R[1]-n[1]],m.endTangent=[n[0]-R[0],n[1]-R[1]])}else if(p==="C"){var N=[h[1],h[2]],U=[h[3],h[4]];m.startTangent=[R[0]-N[0],R[1]-N[1]],m.endTangent=[n[0]-U[0],n[1]-U[1]],m.startTangent[0]===0&&m.startTangent[1]===0&&(m.startTangent=[N[0]-U[0],N[1]-U[1]]),m.endTangent[0]===0&&m.endTangent[1]===0&&(m.endTangent=[U[0]-N[0],U[1]-N[1]])}else if(p==="S"){var I=t[u-1],N=zf(I.currentPoint,R),U=[h[1],h[2]];I.command==="C"?(m.command="C",m.startTangent=[R[0]-N[0],R[1]-N[1]],m.endTangent=[n[0]-U[0],n[1]-U[1]]):(m.command="SQ",m.startTangent=[R[0]-U[0],R[1]-U[1]],m.endTangent=[n[0]-U[0],n[1]-U[1]])}else if(p==="A"){var Z=iv(m,0),Y=Z.x,$=Z.y,J=iv(m,1,!1),se=J.x,pe=J.y;m.startTangent=[Y,$],m.endTangent=[se,pe]}t.push(m)}return t}function iv(e,t,n){n===void 0&&(n=!0);var r=e.arcParams,i=r.rx,s=i===void 0?0:i,l=r.ry,u=l===void 0?0:l,h=r.xRotation,p=r.arcFlag,m=r.sweepFlag,y=Yd({x:e.prePoint[0],y:e.prePoint[1]},s,u,h,!!p,!!m,{x:e.currentPoint[0],y:e.currentPoint[1]},t),b=Yd({x:e.prePoint[0],y:e.prePoint[1]},s,u,h,!!p,!!m,{x:e.currentPoint[0],y:e.currentPoint[1]},n?t+.005:t-.005),w=b.x-y.x,R=b.y-y.y,M=Math.sqrt(w*w+R*R);return{x:-w/M,y:-R/M}}function wh(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function a0(e,t){return wh(e)*wh(t)?(e[0]*t[0]+e[1]*t[1])/(wh(e)*wh(t)):1}function Mp(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(a0(e,t))}function _u(e,t){var n=t[1],r=t[2],i=Bl(ts(t[3]),Math.PI*2),s=t[4],l=t[5],u=e[0],h=e[1],p=t[6],m=t[7],y=Math.cos(i)*(u-p)/2+Math.sin(i)*(h-m)/2,b=-1*Math.sin(i)*(u-p)/2+Math.cos(i)*(h-m)/2,w=y*y/(n*n)+b*b/(r*r);w>1&&(n*=Math.sqrt(w),r*=Math.sqrt(w));var R=n*n*(b*b)+r*r*(y*y),M=R?Math.sqrt((n*n*(r*r)-R)/R):1;s===l&&(M*=-1),isNaN(M)&&(M=0);var I=r?M*n*b/r:0,N=n?M*-r*y/n:0,U=(u+p)/2+Math.cos(i)*I-Math.sin(i)*N,Z=(h+m)/2+Math.sin(i)*I+Math.cos(i)*N,Y=[(y-I)/n,(b-N)/r],$=[(-1*y-I)/n,(-1*b-N)/r],J=Mp([1,0],Y),se=Mp(Y,$);return a0(Y,$)<=-1&&(se=Math.PI),a0(Y,$)>=1&&(se=0),l===0&&se>0&&(se=se-2*Math.PI),l===1&&se<0&&(se=se+2*Math.PI),{cx:U,cy:Z,rx:k0(e,[p,m])?0:n,ry:k0(e,[p,m])?0:r,startAngle:J,endAngle:J+se,xRotation:i,arcFlag:s,sweepFlag:l}}function lu(e,t,n){return e.reduce(function(r,i){var s="";if(i[0]==="M"||i[0]==="L"){var l=nt.al(i[1],i[2],0);n&&nt.fF(l,l,n),s="".concat(i[0]).concat(l[0],",").concat(l[1])}else if(i[0]==="Z")s=i[0];else if(i[0]==="C"){var u=nt.al(i[1],i[2],0),h=nt.al(i[3],i[4],0),p=nt.al(i[5],i[6],0);n&&(nt.fF(u,u,n),nt.fF(h,h,n),nt.fF(p,p,n)),s="".concat(i[0]).concat(u[0],",").concat(u[1],",").concat(h[0],",").concat(h[1],",").concat(p[0],",").concat(p[1])}else if(i[0]==="A"){var m=nt.al(i[6],i[7],0);n&&nt.fF(m,m,n),s="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(m[0],",").concat(m[1])}else if(i[0]==="Q"){var u=nt.al(i[1],i[2],0),h=nt.al(i[3],i[4],0);n&&(nt.fF(u,u,n),nt.fF(h,h,n)),s="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=s},"")}function pc(e,t,n,r){return[["M",e,t],["L",n,r]]}function Zu(e,t,n,r){var i=(-1+Math.sqrt(2))/3*4,s=e*i,l=t*i,u=n-e,h=n+e,p=r-t,m=r+t;return[["M",u,r],["C",u,r-l,n-s,p,n,p],["C",n+s,p,h,r-l,h,r],["C",h,r+l,n+s,m,n,m],["C",n-s,m,u,r+l,u,r],["Z"]]}function bu(e,t){var n=e.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return t&&n.push(["Z"]),n}function Pp(e,t,n,r,i){if(i){var s=(0,z.CR)(i,4),l=s[0],u=s[1],h=s[2],p=s[3],m=e>0?1:-1,y=t>0?1:-1,b=m+y!==0?1:0;return[["M",m*l+n,r],["L",e-m*u+n,r],u?["A",u,u,0,0,b,e+n,y*u+r]:null,["L",e+n,t-y*h+r],h?["A",h,h,0,0,b,e+n-m*h,t+r]:null,["L",n+m*p,t+r],p?["A",p,p,0,0,b,n,t+r-y*p]:null,["L",n,y*l+r],l?["A",l,l,0,0,b,m*l+n,r]:null,["Z"]].filter(function(w){return w})}return[["M",n,r],["L",n+e,r],["L",n+e,r+t],["L",n,r+t],["Z"]]}function dm(e,t){t===void 0&&(t=e.getLocalTransform());var n=[];switch(e.nodeName){case Gr.LINE:var r=e.parsedStyle,i=r.x1,s=i===void 0?0:i,l=r.y1,u=l===void 0?0:l,h=r.x2,p=h===void 0?0:h,m=r.y2,y=m===void 0?0:m;n=pc(s,u,p,y);break;case Gr.CIRCLE:{var b=e.parsedStyle,w=b.r,R=w===void 0?0:w,M=b.cx,I=M===void 0?0:M,N=b.cy,U=N===void 0?0:N;n=Zu(R,R,I,U);break}case Gr.ELLIPSE:{var Z=e.parsedStyle,Y=Z.rx,$=Y===void 0?0:Y,J=Z.ry,se=J===void 0?0:J,pe=Z.cx,I=pe===void 0?0:pe,Ce=Z.cy,U=Ce===void 0?0:Ce;n=Zu($,se,I,U);break}case Gr.POLYLINE:case Gr.POLYGON:var Ue=e.parsedStyle.points;n=bu(Ue.points,e.nodeName===Gr.POLYGON);break;case Gr.RECT:var Je=e.parsedStyle,lt=Je.width,Ge=lt===void 0?0:lt,at=Je.height,st=at===void 0?0:at,ft=Je.x,Vt=ft===void 0?0:ft,wt=Je.y,zt=wt===void 0?0:wt,En=Je.radius,Vn=En&&En.some(function(lr){return lr!==0});n=Pp(Ge,st,Vt,zt,Vn&&En.map(function(lr){return(0,so.Z)(lr,0,Math.min(Math.abs(Ge)/2,Math.abs(st)/2))}));break;case Gr.PATH:var ar=e.parsedStyle.d.absolutePath;n=(0,z.ev)([],(0,z.CR)(ar),!1);break}if(n.length)return lu(n,e,t)}function A1(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0);var s=e.map(function(l,u){var h=l[0],p=e[u+1],m=u===0&&(t!==0||n!==0),y=(u===e.length-1||p&&(p[0]==="M"||p[0]==="Z"))&&r!==0&&i!==0;switch(h){case"M":return m?"M ".concat(l[1]+t,",").concat(l[2]+n," L ").concat(l[1],",").concat(l[2]):"M ".concat(l[1],",").concat(l[2]);case"L":return"L ".concat(l[1]+(y?r:0),",").concat(l[2]+(y?i:0));case"Q":return"Q ".concat(l[1]," ").concat(l[2],",").concat(l[3]," ").concat(l[4])+(y?" L ".concat(l[3]+r,",").concat(l[4]+i):"");case"C":return"C ".concat(l[1]," ").concat(l[2],",").concat(l[3]," ").concat(l[4],",").concat(l[5]," ").concat(l[6])+(y?" L ".concat(l[5]+r,",").concat(l[6]+i):"");case"A":return"A ".concat(l[1]," ").concat(l[2]," ").concat(l[3]," ").concat(l[4]," ").concat(l[5]," ").concat(l[6]," ").concat(l[7])+(y?" L ".concat(l[6]+r,",").concat(l[7]+i):"");case"Z":return"Z"}}).join(" ");return~s.indexOf("NaN")?"":s}var Xv=function(e){if(e===""||Array.isArray(e)&&e.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var t;try{t=zh(e)}catch(b){t=zh(""),console.error("[g]: Invalid SVG Path definition: ".concat(e))}oy(t);var n=ay(t),r=rv(t),i=r.polygons,s=r.polylines,l=$d(t),u=Jh(l,0),h=u.x,p=u.y,m=u.width,y=u.height;return{absolutePath:t,hasArc:n,segments:l,polygons:i,polylines:s,totalLength:0,rect:{x:Number.isFinite(h)?h:0,y:Number.isFinite(p)?p:0,width:Number.isFinite(m)?m:0,height:Number.isFinite(y)?y:0}}},z0=fa(Xv);function U0(e){return bi(e)?z0(e):Xv(e)}function ov(e,t,n){var r=e.curve,i=t.curve;(!r||r.length===0)&&(r=gh(e.absolutePath,!1),e.curve=r),(!i||i.length===0)&&(i=gh(t.absolutePath,!1),t.curve=i);var s=[r,i];r.length!==i.length&&(s=Qf(r,i));var l=et(s[0])!==et(s[1])?dn(s[0]):K(s[0]);return[l,Mr(s[1],l),function(u){return u}]}function cu(e,t){var n;return bi(e)?n=e.split(" ").map(function(r){var i=(0,z.CR)(r.split(","),2),s=i[0],l=i[1];return[Number(s),Number(l)]}):n=e,{points:n,totalLength:0,segments:[]}}function pm(e,t){return[e.points,t.points,function(n){return n}]}var Cl=null;function Wu(e){return function(t){var n=0;return e.map(function(r){return r===Cl?t[n++]:r})}}function Ah(e){return e}var Ch={matrix:["NNNNNN",[Cl,Cl,0,0,Cl,Cl,0,0,0,0,1,0,Cl,Cl,0,1],Ah],matrix3d:["NNNNNNNNNNNNNNNN",Ah],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Wu([Cl,Cl,new ba(1)]),Ah],scalex:["N",Wu([Cl,new ba(1),new ba(1)]),Wu([Cl,new ba(1)])],scaley:["N",Wu([new ba(1),Cl,new ba(1)]),Wu([new ba(1),Cl])],scalez:["N",Wu([new ba(1),new ba(1),Cl])],scale3d:["NNN",Ah],skew:["Aa",null,Ah],skewx:["A",null,Wu([Cl,Fl])],skewy:["A",null,Wu([Fl,Cl])],translate:["Tt",Wu([Cl,Cl,xs]),Ah],translatex:["T",Wu([Cl,xs,xs]),Wu([Cl,xs])],translatey:["T",Wu([xs,Cl,xs]),Wu([xs,Cl])],translatez:["L",Wu([xs,xs,Cl])],translate3d:["TTL",Ah]};function av(e){if(e=(e||"none").toLowerCase().trim(),e==="none")return[];for(var t=/\s*(\w+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];i=r.index+r[0].length;var s=r[1],l=Ch[s];if(!l)return[];var u=r[2].split(","),h=l[0];if(h.length<u.length)return[];for(var p=[],m=0;m<h.length;m++){var y=u[m],b=h[m],w=void 0;if(y?w={A:function(R){return R.trim()==="0"?Fl:Gd(R)},N:yu,T:Ef,L:Yc}[b.toUpperCase()](y):w={a:Fl,n:p[0],t:xs}[b],w===void 0)return[];p.push(w)}if(n.push({t:s,d:p}),t.lastIndex===e.length)return n}return[]}function Yv(e){if(e=(e||"none").toLowerCase().trim(),e==="none")return[];for(var t=/\s*(\w+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];i=r.index+r[0].length;var s=r[1],l=Ch[s];if(!l)return[];var u=r[2].split(","),h=l[0];if(h.length<u.length)return[];for(var p=[],m=0;m<h.length;m++){var y=u[m],b=h[m],w=void 0;if(y?w={A:function(R){return R.trim()==="0"?Fl:F0(R)},N:su,T:Js,L:B0}[b.toUpperCase()](y):w={a:Fl,n:p[0],t:xs}[b],w===void 0)return[];p.push(w)}if(n.push({t:s,d:p}),t.lastIndex===e.length)return n}return[]}function $v(e){var t,n,r,i;switch(e.t){case"rotatex":return i=ts(dc(e.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=ts(dc(e.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=ts(dc(e.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=e.d[0].value,n=e.d[1].value,r=e.d[2].value,i=ts(dc(e.d[3]));var s=t*t+n*n+r*r;if(s===0)t=1,n=0,r=0;else if(s!==1){var l=Math.sqrt(s);t/=l,n/=l,r/=l}var u=Math.sin(i/2),h=u*Math.cos(i/2),p=u*u;return[1-2*(n*n+r*r)*p,2*(t*n*p+r*h),2*(t*r*p-n*h),0,2*(t*n*p-r*h),1-2*(t*t+r*r)*p,2*(n*r*p+t*h),0,2*(t*r*p+n*h),2*(n*r*p-t*h),1-2*(t*t+n*n)*p,0,0,0,0,1];case"scale":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[e.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,e.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,e.d[0].value,0,0,0,0,1];case"scale3d":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,e.d[2].value,0,0,0,0,1];case"skew":var m=ts(dc(e.d[0])),y=ts(dc(e.d[1]));return[1,Math.tan(y),0,0,Math.tan(m),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=ts(dc(e.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=ts(dc(e.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return t=yl(e.d[0],0,null)||0,n=yl(e.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,0,1];case"translatex":return t=yl(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1];case"translatey":return n=yl(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,n,0,1];case"translatez":return r=yl(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return t=yl(e.d[0],0,null)||0,n=yl(e.d[1],0,null)||0,r=yl(e.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,r,1];case"perspective":var b=yl(e.d[0],0,null)||0,w=b?-1/b:0;return[1,0,0,0,0,1,0,0,0,0,1,w,0,0,0,1];case"matrix":return[e.d[0].value,e.d[1].value,0,0,e.d[2].value,e.d[3].value,0,0,0,0,1,0,e.d[4].value,e.d[5].value,0,1];case"matrix3d":return e.d.map(function(R){return R.value})}}function Kv(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]]}function Fe(e){return e.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map($v).reduce(Kv)}function Qt(e){var t=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],s=[0,0,0,1];return jt(Fe(e),t,n,r,i,s),[[t,n,r,s,i]]}var On=function(){function e(r,i){for(var s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],l=0;l<4;l++)for(var u=0;u<4;u++)for(var h=0;h<4;h++)s[l][u]+=i[l][h]*r[h][u];return s}function t(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function n(r,i,s,l,u){for(var h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],p=0;p<4;p++)h[p][3]=u[p];for(var p=0;p<3;p++)for(var m=0;m<3;m++)h[3][p]+=r[m]*h[m][p];var y=l[0],b=l[1],w=l[2],R=l[3],M=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];M[0][0]=1-2*(b*b+w*w),M[0][1]=2*(y*b-w*R),M[0][2]=2*(y*w+b*R),M[1][0]=2*(y*b+w*R),M[1][1]=1-2*(y*y+w*w),M[1][2]=2*(b*w-y*R),M[2][0]=2*(y*w-b*R),M[2][1]=2*(b*w+y*R),M[2][2]=1-2*(y*y+b*b),h=e(h,M);var I=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];s[2]&&(I[2][1]=s[2],h=e(h,I)),s[1]&&(I[2][1]=0,I[2][0]=s[0],h=e(h,I)),s[0]&&(I[2][0]=0,I[1][0]=s[0],h=e(h,I));for(var p=0;p<3;p++)for(var m=0;m<3;m++)h[p][m]*=i[p];return t(h)?[h[0][0],h[0][1],h[1][0],h[1][1],h[3][0],h[3][1]]:h[0].concat(h[1],h[2],h[3])}return n}();function Or(e){return e.toFixed(6).replace(".000000","")}function Wr(e,t){var n,r;return e.decompositionPair!==t&&(e.decompositionPair=t,n=Qt(e)),t.decompositionPair!==e&&(t.decompositionPair=e,r=Qt(t)),n[0]===null||r[0]===null?[[!1],[!0],function(i){return i?t[0].d:e[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(i){var s=_r(n[0][3],r[0][3],i[5]),l=On(i[0],i[1],i[2],s,i[4]),u=l.map(Or).join(",");return u}])}function Rr(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function _r(e,t,n){var r=Rr(e,t);r=(0,so.Z)(r,-1,1);var i=[];if(r===1)i=e;else for(var s=Math.acos(r),l=Math.sin(n*s)*1/Math.sqrt(1-r*r),u=0;u<4;u++)i.push(e[u]*(Math.cos(n*s)-r*l)+t[u]*l);return i}function Ti(e){return e.replace(/[xy]/,"")}function li(e){return e.replace(/(x|y|z|3d)?$/,"3d")}var Fi=function(e,t){return e==="perspective"&&t==="perspective"||(e==="matrix"||e==="matrix3d")&&(t==="matrix"||t==="matrix3d")};function Ri(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=function(J){var se=e[J],pe=se.t,Ce=se.d,Ue=pe.substring(0,5)==="scale"?1:0;t.push({t:pe,d:Ce.map(function(Je){return typeof Je=="number"?Ls(Ue):Ls(Ue,Je.unit)})})},s=0;s<e.length;s++)i(s)}var l=[],u=[],h=[];if(e.length!==t.length){var p=Wr(e,t);l=[p[0]],u=[p[1]],h=[["matrix",[p[2]]]]}else for(var s=0;s<e.length;s++){var m=e[s].t,y=t[s].t,b=e[s].d,w=t[s].d,R=Ch[m],M=Ch[y],I=void 0;if(Fi(m,y)){var p=Wr([e[s]],[t[s]]);l.push(p[0]),u.push(p[1]),h.push(["matrix",[p[2]]]);continue}else if(m===y)I=m;else if(R[2]&&M[2]&&Ti(m)===Ti(y))I=Ti(m),b=R[2](b),w=M[2](w);else if(R[1]&&M[1]&&li(m)===li(y))I=li(m),b=R[1](b),w=M[1](w);else{var p=Wr(e,t);l=[p[0]],u=[p[1]],h=[["matrix",[p[2]]]];break}for(var N=[],U=[],Z=[],Y=0;Y<b.length;Y++){var p=Cp(b[Y],w[Y],n,!1,Y);N[Y]=p[0],U[Y]=p[1],Z.push(p[2])}l.push(N),u.push(U),h.push([I,Z])}if(r){var $=l;l=u,u=$}return[l,u,function(J){return J.map(function(se,pe){var Ce=se.map(function(Ue,Je){return h[pe][1][Je](Ue)}).join(",");return h[pe][0]==="matrix"&&Ce.split(",").length===16&&(h[pe][0]="matrix3d"),h[pe][0]==="matrix3d"&&Ce.split(",").length===6&&(h[pe][0]="matrix"),h[pe][0]+"("+Ce+")"}).join(" ")}]}var Di=fa(function(e){if(bi(e)){if(e==="text-anchor")return[Ls(0,"px"),Ls(0,"px")];var t=e.split(" ");return t.length===1&&(t[0]==="top"||t[0]==="bottom"?(t[1]=t[0],t[0]="center"):t[1]="center"),t.length!==2?null:[Ef(pi(t[0])),Ef(pi(t[1]))]}else return[Ls(e[0]||0,"px"),Ls(e[1]||0,"px")]}),Xi=function(e){if(bi(e)){if(e==="text-anchor")return[Ls(0,"px"),Ls(0,"px")];var t=e.split(" ");return t.length===1&&(t[0]==="top"||t[0]==="bottom"?(t[1]=t[0],t[0]="center"):t[1]="center"),t.length!==2?null:[Js(pi(t[0])),Js(pi(t[1]))]}else return[Ls(e[0]||0,"px"),Ls(e[1]||0,"px")]};function pi(e){return e==="center"?"50%":e==="left"||e==="top"?"0%":e==="right"||e==="bottom"?"100%":e}var Ni=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:io.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:io.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:io.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:io.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:io.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:io.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:io.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:io.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:io.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:io.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:io.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:io.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:io.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:io.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:io.FILTER},{n:"clipPath",syntax:io.DEFINED_PATH},{n:"textPath",syntax:io.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:io.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:io.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:io.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:io.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:io.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:io.COORDINATE},{n:"y1",int:!0,l:!0,syntax:io.COORDINATE},{n:"z1",int:!0,l:!0,syntax:io.COORDINATE},{n:"x2",int:!0,l:!0,syntax:io.COORDINATE},{n:"y2",int:!0,l:!0,syntax:io.COORDINATE},{n:"z2",int:!0,l:!0,syntax:io.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:io.PATH,p:50},{n:"points",int:!0,l:!0,syntax:io.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:io.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:io.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:io.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:io.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:io.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:io.NUMBER,d:function(e){return e===Gr.PATH||e===Gr.POLYGON||e===Gr.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:io.MARKER},{n:"markerEnd",syntax:io.MARKER},{n:"markerMid",syntax:io.MARKER},{n:"markerStartOffset",syntax:io.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:io.LENGTH,l:!0,int:!0,d:"0"}],pr=Ni.filter(function(e){return!!e.l}).map(function(e){return e.n}),Lr={},yi=new WeakMap,eo=function(e,t){var n=yi.get(e);return!n||n.length===0?!0:n.includes(t)},ii=function(){function e(t){var n=this;this.runtime=t,Ni.forEach(function(r){n.registerMetadata(r)})}return e.prototype.registerMetadata=function(t){(0,z.ev)([t.n],(0,z.CR)(t.a||[]),!1).forEach(function(n){Lr[n]=t})},e.prototype.unregisterMetadata=function(t){delete Lr[t]},e.prototype.getPropertySyntax=function(t){return this.runtime.CSSPropertySyntaxFactory[t]},e.prototype.processProperties=function(t,n,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var m=r.skipUpdateAttribute,y=r.skipParse,b=r.forceUpdateGeometry,w=r.usedAttributes,R=r.memoize,M=b,I=Object.keys(n);I.forEach(function(N){var U;m||(t.attributes[N]=n[N]),!M&&(!((U=Lr[N])===null||U===void 0)&&U.l)&&(M=!0)}),y||I.forEach(function(N){t.computedStyle[N]=i.parseProperty(N,t.attributes[N],t,R)}),w!=null&&w.length&&(I=Array.from(new Set(I.concat(w)))),I.forEach(function(N){N in t.computedStyle&&(t.parsedStyle[N]=i.computeProperty(N,t.computedStyle[N],t,R))}),M&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t)),I.forEach(function(N){N in t.parsedStyle&&i.postProcessProperty(N,t,I)}),this.runtime.enableCSSParsing&&t.children.length&&I.forEach(function(N){N in t.parsedStyle&&i.isPropertyInheritable(N)&&t.children.forEach(function(U){U.internalSetAttribute(N,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(t.attributes,n);var s=Object.keys(n),l=t.parsedStyle.clipPath,u=t.parsedStyle.offsetPath;t.parsedStyle=Object.assign(t.parsedStyle,n);var h=!!r.forceUpdateGeometry;if(!h){for(var p=0;p<pr.length;p++)if(pr[p]in n){h=!0;break}}n.fill&&(t.parsedStyle.fill=Kh(n.fill)),n.stroke&&(t.parsedStyle.stroke=Kh(n.stroke)),n.shadowColor&&(t.parsedStyle.shadowColor=Kh(n.shadowColor)),n.filter&&(t.parsedStyle.filter=fm(n.filter)),(0,sr.Z)(n.radius)||(t.parsedStyle.radius=Xd(n.radius,4)),(0,sr.Z)(n.lineDash)||(t.parsedStyle.lineDash=Xd(n.lineDash,2)),n.points&&(t.parsedStyle.points=cu(n.points)),n.d===""&&(t.parsedStyle.d=(0,z.pi)({},D0)),n.d&&(t.parsedStyle.d=U0(n.d)),n.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:n.textTransform},t,null),ti(n.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",l,n.clipPath,t,this.runtime),n.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",u,n.offsetPath,t,this.runtime),n.transform&&(t.parsedStyle.transform=av(n.transform)),n.transformOrigin&&(t.parsedStyle.transformOrigin=Di(n.transformOrigin)),n.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,n.markerStart,n.markerStart,null,null)),n.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,n.markerEnd,n.markerEnd,null,null)),n.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",n.markerMid,n.markerMid,null,null)),(0,sr.Z)(n.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(t,s),(0,sr.Z)(n.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(t,s),n.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(t,s),n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(t,s),h&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},e.prototype.parseProperty=function(t,n,r,i){var s=Lr[t],l=n;if((n===""||(0,sr.Z)(n))&&(n="unset"),n==="unset"||n==="initial"||n==="inherit")l=Zd(n);else if(s){var u=s.k,h=s.syntax,p=h&&this.getPropertySyntax(h);u&&u.indexOf(n)>-1?l=Zd(n):p&&(!i&&p.parserUnmemoize?l=p.parserUnmemoize(n,r):p.parser&&(l=p.parser(n,r)))}return l},e.prototype.computeProperty=function(t,n,r,i){var s=Lr[t],l=r.id==="g-root",u=n;if(s){var h=s.syntax,p=s.inh,m=s.d;if(n instanceof al){var y=n.value;if(y==="unset"&&(p&&!l?y="inherit":y="initial"),y==="initial")(0,sr.Z)(m)||(n=this.parseProperty(t,kf(m)?m(r.nodeName):m,r,i));else if(y==="inherit"){var b=this.tryToResolveProperty(r,t,{inherited:!0});if((0,sr.Z)(b)){this.addUnresolveProperty(r,t);return}else return b}}var w=h&&this.getPropertySyntax(h);if(w&&w.calculator){var R=r.parsedStyle[t];u=w.calculator(t,R,n,r,this.runtime)}else n instanceof al?u=n.value:u=n}return u},e.prototype.postProcessProperty=function(t,n,r){var i=Lr[t];if(i&&i.syntax){var s=i.syntax&&this.getPropertySyntax(i.syntax),l=s;l&&l.postProcessor&&l.postProcessor(n,r)}},e.prototype.addUnresolveProperty=function(t,n){var r=yi.get(t);r||(yi.set(t,[]),r=yi.get(t)),r.indexOf(n)===-1&&r.push(n)},e.prototype.tryToResolveProperty=function(t,n,r){r===void 0&&(r={});var i=r.inherited;if(i&&t.parentElement&&eo(t.parentElement,n)){var s=t.parentElement.parsedStyle[n];return s==="unset"||s==="initial"||s==="inherit"?void 0:s}},e.prototype.recalc=function(t){var n=yi.get(t);if(n&&n.length){var r={};n.forEach(function(i){r[i]=t.attributes[i]}),this.processProperties(t,r),yi.delete(t)}},e.prototype.updateGeometry=function(t){var n=t.nodeName,r=this.runtime.geometryUpdaterFactory[n];if(r){var i=t.geometry;i.contentBounds||(i.contentBounds=new Cn),i.renderBounds||(i.renderBounds=new Cn);var s=t.parsedStyle,l=r.update(s,t),u=l.cx,h=u===void 0?0:u,p=l.cy,m=p===void 0?0:p,y=l.cz,b=y===void 0?0:y,w=l.hwidth,R=w===void 0?0:w,M=l.hheight,I=M===void 0?0:M,N=l.hdepth,U=N===void 0?0:N,Z=[Math.abs(R),Math.abs(I),U],Y=s,$=Y.stroke,J=Y.lineWidth,se=J===void 0?1:J,pe=Y.increasedLineWidthForHitTesting,Ce=pe===void 0?0:pe,Ue=Y.shadowType,Je=Ue===void 0?"outer":Ue,lt=Y.shadowColor,Ge=Y.filter,at=Ge===void 0?[]:Ge,st=Y.transformOrigin,ft=[h,m,b];i.contentBounds.update(ft,Z);var Vt=n===Gr.POLYLINE||n===Gr.POLYGON||n===Gr.PATH?Math.SQRT2:.5,wt=$&&!$.isNone;if(wt){var zt=((se||0)+(Ce||0))*Vt;Z[0]+=zt,Z[1]+=zt}if(i.renderBounds.update(ft,Z),lt&&Je&&Je!=="inner"){var En=i.renderBounds,Vn=En.min,ar=En.max,lr=s,Vr=lr.shadowBlur,ui=lr.shadowOffsetX,qi=lr.shadowOffsetY,Jr=Vr||0,Qr=ui||0,Mo=qi||0,Qi=Vn[0]-Jr+Qr,Zi=ar[0]+Jr+Qr,Eo=Vn[1]-Jr+Mo,Go=ar[1]+Jr+Mo;Vn[0]=Math.min(Vn[0],Qi),ar[0]=Math.max(ar[0],Zi),Vn[1]=Math.min(Vn[1],Eo),ar[1]=Math.max(ar[1],Go),i.renderBounds.setMinMax(Vn,ar)}at.forEach(function(us){var wl=us.name,Cu=us.params;if(wl==="blur"){var Gf=Cu[0].value;i.renderBounds.update(i.renderBounds.center,ah(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[Gf,Gf,0]))}else if(wl==="drop-shadow"){var Zc=Cu[0].value,ph=Cu[1].value,Ou=Cu[2].value,kd=i.renderBounds,bc=kd.min,Pc=kd.max,Bh=bc[0]-Ou+Zc,Rf=Pc[0]+Ou+Zc,ta=bc[1]-Ou+ph,qa=Pc[1]+Ou+ph;bc[0]=Math.min(bc[0],Bh),Pc[0]=Math.max(Pc[0],Rf),bc[1]=Math.min(bc[1],ta),Pc[1]=Math.max(Pc[1],qa),i.renderBounds.setMinMax(bc,Pc)}}),t.geometry.dirty=!1;var oa=R<0,Ca=I<0,Vs=(oa?-1:1)*(st?yl(st[0],0,t,!0):0),Sa=(Ca?-1:1)*(st?yl(st[1],1,t,!0):0);(Vs||Sa)&&t.setOrigin(Vs,Sa)}},e.prototype.updateSizeAttenuation=function(t,n){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/n,t.nodeName===Gr.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/n)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===Gr.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))},e.prototype.isPropertyInheritable=function(t){var n=Lr[t];return n?n.inh:!1},e}(),oo=function(){function e(){this.parser=Gd,this.parserUnmemoize=F0,this.parserWithCSSDisabled=null,this.mixer=r0}return e.prototype.calculator=function(t,n,r,i){return dc(r)},e}(),xi=function(){function e(){}return e.prototype.calculator=function(t,n,r,i,s){return r instanceof al&&(r=null),s.sceneGraphService.updateDisplayObjectDependency(t,n,r,i),t==="clipPath"&&i.forEach(function(l){l.childNodes.length===0&&s.sceneGraphService.dirtifyToRoot(l)}),r},e}(),to=function(){function e(){this.parser=Kh,this.parserWithCSSDisabled=Kh,this.mixer=nv}return e.prototype.calculator=function(t,n,r,i){return r instanceof al?r.value==="none"?lf:Ep:r},e}(),si=function(){function e(){this.parser=fm}return e.prototype.calculator=function(t,n,r){return r instanceof al?[]:r},e}();function Yi(e){var t=e.parsedStyle.fontSize;return(0,sr.Z)(t)?null:t}var Bo=function(){function e(){this.parser=Ef,this.parserUnmemoize=Js,this.parserWithCSSDisabled=null,this.mixer=r0}return e.prototype.calculator=function(t,n,r,i,s){var l;if((0,Ft.Z)(r))return r;if(ba.isRelativeUnit(r.unit)){var u=s.styleValueRegistry;if(r.unit===Bn.kPercentage)return 0;if(r.unit===Bn.kEms){if(i.parentNode){var h=Yi(i.parentNode);if(h)return h*=r.value,h;u.addUnresolveProperty(i,t)}else u.addUnresolveProperty(i,t);return 0}else if(r.unit===Bn.kRems){if(!((l=i==null?void 0:i.ownerDocument)===null||l===void 0)&&l.documentElement){var h=Yi(i.ownerDocument.documentElement);if(h)return h*=r.value,h;u.addUnresolveProperty(i,t)}else u.addUnresolveProperty(i,t);return 0}}else return r.value},e}(),ha=function(){function e(){this.mixer=Rp}return e.prototype.parser=function(t){var n=Qh((0,Ft.Z)(t)?[t]:t),r;return n.length===1?r=[n[0],n[0]]:r=[n[0],n[1]],r},e.prototype.calculator=function(t,n,r){return r.map(function(i){return i.value})},e}(),Ki=function(){function e(){this.mixer=Rp}return e.prototype.parser=function(t){var n=Qh((0,Ft.Z)(t)?[t]:t),r;return n.length===1?r=[n[0],n[0],n[0],n[0]]:n.length===2?r=[n[0],n[1],n[0],n[1]]:n.length===3?r=[n[0],n[1],n[2],n[1]]:r=[n[0],n[1],n[2],n[3]],r},e.prototype.calculator=function(t,n,r){return r.map(function(i){return i.value})},e}(),Ei=function(){function e(){}return e.prototype.calculator=function(t,n,r,i){r instanceof al&&(r=null);var s=r==null?void 0:r.cloneNode(!0);return s&&(s.style.isMarker=!0),s},e}(),$r=function(){function e(){this.mixer=r0,this.parser=yu,this.parserUnmemoize=su,this.parserWithCSSDisabled=null}return e.prototype.calculator=function(t,n,r){return r.value},e}(),zo=function(){function e(){this.parser=yu,this.parserUnmemoize=su,this.parserWithCSSDisabled=null,this.mixer=i0(0,1)}return e.prototype.calculator=function(t,n,r){return r.value},e.prototype.postProcessor=function(t){var n=t.parsedStyle,r=n.offsetPath,i=n.offsetDistance;if(r){var s=r.nodeName;if(s===Gr.LINE||s===Gr.PATH||s===Gr.POLYLINE){var l=r.getPoint(i);l&&t.setLocalPosition(l.x,l.y)}}},e}(),Ua=function(){function e(){this.parser=yu,this.parserUnmemoize=su,this.parserWithCSSDisabled=null,this.mixer=i0(0,1)}return e.prototype.calculator=function(t,n,r){return r.value},e}(),co=function(){function e(){this.parser=U0,this.parserWithCSSDisabled=U0,this.mixer=ov}return e.prototype.calculator=function(t,n,r){return r instanceof al&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Cr(0,0,0,0)}:r},e}(),Da=function(){function e(){this.parser=cu,this.mixer=pm}return e}(),da=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.mixer=i0(0,1/0),n}return t}(Bo),Jo=function(){function e(){}return e.prototype.calculator=function(t,n,r,i){return r instanceof al?r.value==="unset"?"":r.value:"".concat(r)},e.prototype.postProcessor=function(t){t.nodeValue="".concat(t.parsedStyle.text)||""},e}(),vs=function(){function e(){}return e.prototype.calculator=function(t,n,r,i){var s=i.getAttribute("text");if(s){var l=s;r.value==="capitalize"?l=s.charAt(0).toUpperCase()+s.slice(1):r.value==="lowercase"?l=s.toLowerCase():r.value==="uppercase"&&(l=s.toUpperCase()),i.parsedStyle.text=l}return r.value},e}(),_l={},$c=0;function Ga(e,t){if(e){var n=typeof e=="string"?e:e.id||$c++;_l[n]&&_l[n].destroy(),_l[n]=t}}var dl=typeof window!="undefined"&&typeof window.document!="undefined";function el(e){return!!e.getAttribute}function Yl(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;zl(e[i],t)<0?n=i+1:r=i}return n}function zl(e,t){var n=Number(e.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(n===r){var i=e.parentNode;if(i){var s=i.childNodes||[];return s.indexOf(e)-s.indexOf(t)}}return n-r}function as(e){var t,n=e;do{var r=(t=n.parsedStyle)===null||t===void 0?void 0:t.clipPath;if(r)return n;n=n.parentElement}while(n!==null);return null}var $l="px";function ec(e,t,n){dl&&e.style&&(e.style.width=t+$l,e.style.height=n+$l)}function mc(e,t){if(dl)return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function Ra(e){var t=mc(e,"width");return t==="auto"?e.offsetWidth:parseFloat(t)}function Kc(e){var t=mc(e,"height");return t==="auto"?e.offsetHeight:parseFloat(t)}var Rs=1,Zo={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Ta=typeof performance=="object"&&performance.now?performance:Date;function Za(e,t,n){e===void 0&&(e="auto");var r=!1,i=!1,s=!!t&&!t.isNone,l=!!n&&!n.isNone;return e==="visiblepainted"||e==="painted"||e==="auto"?(r=s,i=l):e==="visiblefill"||e==="fill"?r=!0:e==="visiblestroke"||e==="stroke"?i=!0:(e==="visible"||e==="all")&&(r=!0,i=!0),[r,i]}var Kl=1,ch=function(){return Kl++},ln=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},Pr=Date.now(),Er=function(){return ln.performance&&typeof ln.performance.now=="function"?ln.performance.now():Date.now()-Pr},no={},Na=Date.now(),Es=function(e){if(typeof e!="function")throw new TypeError(e+" is not a function");var t=Date.now(),n=t-Na,r=n>16?0:16-n,i=ch();return no[i]=e,Object.keys(no).length>1||setTimeout(function(){Na=t;var s=no;no={},Object.keys(s).forEach(function(l){return s[l](Er())})},r),i},Lt=function(e){delete no[e]},nn=["","webkit","moz","ms","o"],Mn=function(e){return typeof e!="string"?Es:e===""?ln.requestAnimationFrame:ln[e+"RequestAnimationFrame"]},Ar=function(e){return typeof e!="string"?Lt:e===""?ln.cancelAnimationFrame:ln[e+"CancelAnimationFrame"]||ln[e+"CancelRequestAnimationFrame"]},xr=function(e,t){for(var n=0;e[n]!==void 0;){if(t(e[n]))return e[n];n=n+1}},Un=xr(nn,function(e){return!!Mn(e)}),Kn=Mn(Un),ir=Ar(Un);ln.requestAnimationFrame=Kn,ln.cancelAnimationFrame=ir;var yn=function(){function e(){this.callbacks=[]}return e.prototype.getCallbacksNum=function(){return this.callbacks.length},e.prototype.tapPromise=function(t,n){this.callbacks.push(n)},e.prototype.promise=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,(0,z.ev)([],(0,z.CR)(t),!1))}))},e}(),Hn=function(){function e(){this.callbacks=[]}return e.prototype.tapPromise=function(t,n){this.callbacks.push(n)},e.prototype.promise=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(0,z.mG)(this,void 0,void 0,function(){var r,i,s,l;return(0,z.Jh)(this,function(u){switch(u.label){case 0:return this.callbacks.length?[4,(l=this.callbacks)[0].apply(l,(0,z.ev)([],(0,z.CR)(t),!1))]:[3,6];case 1:r=u.sent(),i=0,u.label=2;case 2:return i<this.callbacks.length-1?(s=this.callbacks[i],[4,s(r)]):[3,5];case 3:r=u.sent(),u.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},e}(),Kt=function(){function e(){this.callbacks=[]}return e.prototype.tap=function(t,n){this.callbacks.push(n)},e.prototype.call=function(){var t=arguments;this.callbacks.forEach(function(n){n.apply(void 0,t)})},e}(),Yn=function(){function e(){this.callbacks=[]}return e.prototype.tap=function(t,n){this.callbacks.push(n)},e.prototype.call=function(){if(this.callbacks.length){for(var t=arguments,n=this.callbacks[0].apply(void 0,t),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];n=i(n)}return n}return null},e}(),Dr=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],zr=/([\"\'])[^\'\"]+\1/;function mi(e){for(var t=e.fontSize,n=t===void 0?16:t,r=e.fontFamily,i=r===void 0?"sans-serif":r,s=e.fontStyle,l=s===void 0?"normal":s,u=e.fontVariant,h=u===void 0?"normal":u,p=e.fontWeight,m=p===void 0?"normal":p,y=(0,Ft.Z)(n)&&"".concat(n,"px")||"16px",b=i.split(","),w=b.length-1;w>=0;w--){var R=b[w].trim();!zr.test(R)&&Dr.indexOf(R)<0&&(R='"'.concat(R,'"')),b[w]=R}return"".concat(l," ").concat(h," ").concat(m," ").concat(y," ").concat(b.join(","))}function Kr(e,t,n){return St.identity(e),e[4]=Math.tan(t),e[1]=Math.tan(n),e}var hi=1e-5,Ro=St.create(),Ui=St.create();function xo(e,t){if(e.length){var n=St.identity(Ro);e.forEach(function(r){var i=r.t,s=r.d;if(i==="scale"){var l=(s==null?void 0:s.map(function(N){return Math.max(N.value,hi)}))||[1,1];St.fromScaling(Ui,[l[0],l[1],1])}else if(i==="scalex"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,hi)}))||[1];St.fromScaling(Ui,[l[0],1,1])}else if(i==="scaley"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,hi)}))||[1];St.fromScaling(Ui,[1,l[0],1])}else if(i==="scalez"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,hi)}))||[1];St.fromScaling(Ui,[1,1,l[0]])}else if(i==="scale3d"){var l=(s==null?void 0:s.map(function(U){return Math.max(U.value,hi)}))||[1,1,1];St.fromScaling(Ui,[l[0],l[1],l[2]])}else if(i==="translate"){var u=s||[xs,xs];St.fromTranslation(Ui,[u[0].value,u[1].value,0])}else if(i==="translatex"){var u=s||[xs];St.fromTranslation(Ui,[u[0].value,0,0])}else if(i==="translatey"){var u=s||[xs];St.fromTranslation(Ui,[0,u[0].value,0])}else if(i==="translatez"){var u=s||[xs];St.fromTranslation(Ui,[0,0,u[0].value])}else if(i==="translate3d"){var u=s||[xs,xs,xs];St.fromTranslation(Ui,[u[0].value,u[1].value,u[2].value])}else if(i==="rotate"){var h=s||[Fl];St.fromZRotation(Ui,ts(dc(h[0])))}else if(i==="rotatex"){var h=s||[Fl];St.fromXRotation(Ui,ts(dc(h[0])))}else if(i==="rotatey"){var h=s||[Fl];St.fromYRotation(Ui,ts(dc(h[0])))}else if(i==="rotatez"){var h=s||[Fl];St.fromZRotation(Ui,ts(dc(h[0])))}else if(i==="rotate3d"){var h=s||[xs,xs,xs,Fl];St.fromRotation(Ui,ts(dc(h[3])),[h[0].value,h[1].value,h[2].value])}else if(i==="skew"){var p=(s==null?void 0:s.map(function(N){return N.value}))||[0,0];Kr(Ui,ts(p[0]),ts(p[1]))}else if(i==="skewx"){var p=(s==null?void 0:s.map(function(U){return U.value}))||[0];Kr(Ui,ts(p[0]),0)}else if(i==="skewy"){var p=(s==null?void 0:s.map(function(U){return U.value}))||[0];Kr(Ui,0,ts(p[0]))}else if(i==="matrix"){var m=(0,z.CR)(s.map(function(N){return N.value}),6),y=m[0],b=m[1],w=m[2],R=m[3],M=m[4],I=m[5];St.set(Ui,y,b,0,0,w,R,0,0,0,0,1,0,M,I,0,1)}else i==="matrix3d"&&St.set.apply(St,(0,z.ev)([Ui],(0,z.CR)(s.map(function(N){return N.value})),!1));St.mul(n,n,Ui)}),t.setLocalTransform(n)}else t.resetLocalTransform();return t.getLocalTransform()}var qo=function(){function e(){this.parser=av,this.parserUnmemoize=Yv,this.parserWithCSSDisabled=Yv,this.mixer=Ri}return e.prototype.calculator=function(t,n,r,i){return r instanceof al?[]:r},e.prototype.postProcessor=function(t){var n=t.parsedStyle.transform;xo(n,t)},e}(),ia=function(){function e(){this.parser=Di,this.parserUnmemoize=Xi}return e.prototype.postProcessor=function(t){var n=t.parsedStyle.transformOrigin;n[0].unit===Bn.kPixels&&n[1].unit===Bn.kPixels?t.setOrigin(n[0].value,n[1].value):t.getGeometryBounds()},e}(),As=function(){function e(){this.parser=yu,this.parserUnmemoize=su}return e.prototype.calculator=function(t,n,r,i){return r.value},e.prototype.postProcessor=function(t){if(t.parentNode){var n=t.parentNode,r=n.renderable,i=n.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=lh.Z_INDEX_CHANGED)}},e}(),Sc=function(){function e(){}return e.prototype.update=function(t,n){var r=t.cx,i=r===void 0?0:r,s=t.cy,l=s===void 0?0:s,u=t.r,h=u===void 0?0:u;return{cx:i,cy:l,hwidth:h,hheight:h}},e}(),xu=function(){function e(){}return e.prototype.update=function(t,n){var r=t.cx,i=r===void 0?0:r,s=t.cy,l=s===void 0?0:s,u=t.rx,h=u===void 0?0:u,p=t.ry,m=p===void 0?0:p;return{cx:i,cy:l,hwidth:h,hheight:m}},e}(),mm=function(){function e(){}return e.prototype.update=function(t){var n=t.x1,r=t.y1,i=t.x2,s=t.y2,l=Math.min(n,i),u=Math.max(n,i),h=Math.min(r,s),p=Math.max(r,s),m=u-l,y=p-h,b=m/2,w=y/2;return{cx:l+b,cy:h+w,hwidth:b,hheight:w}},e}(),uf=function(){function e(){}return e.prototype.update=function(t){var n=t.d,r=n.rect,i=r.x,s=r.y,l=r.width,u=r.height,h=l/2,p=u/2;return{cx:i+h,cy:s+p,hwidth:h,hheight:p}},e}(),qv=function(){function e(){}return e.prototype.update=function(t){if(t.points&&Is(t.points.points)){var n=t.points.points,r=Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(n.map(function(y){return y[0]})),!1)),i=Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(n.map(function(y){return y[0]})),!1)),s=Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(n.map(function(y){return y[1]})),!1)),l=Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(n.map(function(y){return y[1]})),!1)),u=i-r,h=l-s,p=u/2,m=h/2;return{cx:r+p,cy:s+m,hwidth:p,hheight:m}}return{cx:0,cy:0,hwidth:0,hheight:0}},e}(),Od=function(){function e(){}return e.prototype.update=function(t,n){var r=t.x,i=r===void 0?0:r,s=t.y,l=s===void 0?0:s,u=t.src,h=t.width,p=h===void 0?0:h,m=t.height,y=m===void 0?0:m,b=p,w=y;return u&&!bi(u)&&(b||(b=u.width,t.width=b),w||(w=u.height,t.height=w)),{cx:i+b/2,cy:l+w/2,hwidth:b/2,hheight:w/2}},e}(),Kd=function(){function e(t){this.globalRuntime=t}return e.prototype.isReadyToMeasure=function(t,n){var r=t.text,i=t.textAlign,s=t.textBaseline,l=t.fontSize,u=t.fontStyle,h=t.fontWeight,p=t.fontVariant,m=t.lineWidth;return g.enableCSSParsing?r&&l&&u&&h&&p&&i&&s&&!(0,sr.Z)(m):r},e.prototype.update=function(t,n){var r,i,s=t.text,l=t.textAlign,u=l===void 0?"start":l,h=t.lineWidth,p=h===void 0?1:h,m=t.textBaseline,y=m===void 0?"alphabetic":m,b=t.dx,w=b===void 0?0:b,R=t.dy,M=R===void 0?0:R,I=t.x,N=I===void 0?0:I,U=t.y,Z=U===void 0?0:U;if(!this.isReadyToMeasure(t,n))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var Y=(((i=(r=n==null?void 0:n.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,$=this.globalRuntime.textService.measureText(s,t,Y);t.metrics=$;var J=$.width,se=$.height,pe=$.lineHeight,Ce=$.fontProperties,Ue=J/2,Je=se/2,lt=N+Ue;u==="center"||u==="middle"?lt+=p/2-Ue:(u==="right"||u==="end")&&(lt+=p-Ue*2);var Ge=Z-Je;return y==="middle"?Ge+=Je:y==="top"||y==="hanging"?Ge+=Je*2:y==="alphabetic"?Ge+=this.globalRuntime.enableCSSParsing?pe-Ce.ascent:0:(y==="bottom"||y==="ideographic")&&(Ge+=0),w&&(lt+=w),M&&(Ge+=M),{cx:lt,cy:Ge,hwidth:Ue,hheight:Je}},e}(),C1=function(){function e(){}return e.prototype.update=function(t,n){return{cx:0,cy:0,hwidth:0,hheight:0}},e}();function O1(e){return!!e.type}var Qv=function(){function e(t){this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ur,this.page=new ur,this.canvas=new ur,this.viewport=new ur,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),e.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(e.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},e.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.initEvent=function(){},e.prototype.initUIEvent=function(){},e.prototype.clone=function(){throw new Error(dr)},e}(),Jv=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.client=new ur,n.movement=new ur,n.offset=new ur,n.global=new ur,n.screen=new ur,n}return Object.defineProperty(t.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),t.prototype.getModifierState=function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)},t.prototype.initMouseEvent=function(){throw new Error(dr)},t}(Qv),s0=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.width=0,n.height=0,n.isPrimary=!1,n}return t.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},t.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},t.prototype.clone=function(){return this.manager.clonePointerEvent(this)},t}(Jv),eg=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},t}(Jv),tl=function(e){(0,z.ZT)(t,e);function t(n,r){var i=e.call(this,null)||this;return i.type=n,i.detail=r,Object.assign(i,r),i}return t}(Qv),R1=":",Tc=function(){function e(){this.emitter=new Zt}return e.prototype.on=function(t,n,r){return this.addEventListener(t,n,r),this},e.prototype.addEventListener=function(t,n,r){var i=lo(r)&&r||ca(r)&&r.capture,s=ca(r)&&r.once,l=kf(n)?void 0:n,u=!1,h="";if(t.indexOf(R1)>-1){var p=(0,z.CR)(t.split(R1),2),m=p[0],y=p[1];t=y,h=m,u=!0}if(t=i?"".concat(t,"capture"):t,n=kf(n)?n:n.handleEvent,u){var b=n;n=function(){for(var w,R=[],M=0;M<arguments.length;M++)R[M]=arguments[M];((w=R[0].target)===null||w===void 0?void 0:w.name)===h&&b.apply(void 0,(0,z.ev)([],(0,z.CR)(R),!1))}}return s?this.emitter.once(t,n,l):this.emitter.on(t,n,l),this},e.prototype.off=function(t,n,r){return t?this.removeEventListener(t,n,r):this.removeAllEventListeners(),this},e.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},e.prototype.removeEventListener=function(t,n,r){var i=lo(r)&&r||ca(r)&&r.capture,s=kf(n)?void 0:n;return t=i?"".concat(t,"capture"):t,n=kf(n)?n:n==null?void 0:n.handleEvent,this.emitter.off(t,n,s),this},e.prototype.emit=function(t,n){this.dispatchEvent(new tl(t,n))},e.prototype.dispatchEvent=function(t,n){var r,i;if(n===void 0&&(n=!1),!O1(t))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var s;if(this.document?s=this:this.defaultView?s=this.defaultView:s=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,s){if(t.manager=s.getEventService()||null,!t.manager)return!1;t.defaultPrevented=!1,t.path=[],n||(t.target=this),(i=t.manager)===null||i===void 0||i.dispatchEvent(t,t.type,n)}return!t.defaultPrevented},e}(),Xa=function(e){(0,z.ZT)(t,e);function t(){var n=e.call(this)||this;return n.shadow=!1,n.ownerDocument=null,n.isConnected=!1,n.baseURI="",n.childNodes=[],n.nodeType=0,n.nodeName="",n.nodeValue=null,n.parentNode=null,n}return t.isNode=function(n){return!!n.childNodes},Object.defineProperty(t.prototype,"textContent",{get:function(){var n,r,i="";this.nodeName===Gr.TEXT&&(i+=this.style.text);try{for(var s=(0,z.XA)(this.childNodes),l=s.next();!l.done;l=s.next()){var u=l.value;u.nodeName===Gr.TEXT?i+=u.nodeValue:i+=u.textContent}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},set:function(n){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===Gr.TEXT&&(this.style.text="".concat(n))},enumerable:!1,configurable:!0}),t.prototype.getRootNode=function(n){return n===void 0&&(n={}),this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this},t.prototype.hasChildNodes=function(){return this.childNodes.length>0},t.prototype.isDefaultNamespace=function(n){throw new Error(dr)},t.prototype.lookupNamespaceURI=function(n){throw new Error(dr)},t.prototype.lookupPrefix=function(n){throw new Error(dr)},t.prototype.normalize=function(){throw new Error(dr)},t.prototype.isEqualNode=function(n){return this===n},t.prototype.isSameNode=function(n){return this.isEqualNode(n)},Object.defineProperty(t.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),t.prototype.compareDocumentPosition=function(n){var r;if(n===this)return 0;for(var i=n,s=this,l=[i],u=[s];(r=i.parentNode)!==null&&r!==void 0?r:s.parentNode;)i=i.parentNode?(l.push(i.parentNode),i.parentNode):i,s=s.parentNode?(u.push(s.parentNode),s.parentNode):s;if(i!==s)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var h=l.length>u.length?l:u,p=h===l?u:l;if(h[h.length-p.length]===p[0])return h===l?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var m=h.length-p.length,y=p.length-1;y>=0;y--){var b=p[y],w=h[m+y];if(w!==b){var R=b.parentNode.childNodes;return R.indexOf(b)<R.indexOf(w)?p===l?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING:h===l?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING}}return t.DOCUMENT_POSITION_FOLLOWING},t.prototype.contain=function(n){return this.contains(n)},t.prototype.contains=function(n){for(var r=n;r&&this!==r;)r=r.parentNode;return!!r},t.prototype.getAncestor=function(n){for(var r=this;n>0&&r;)r=r.parentNode,n--;return r},t.prototype.forEach=function(n,r){r===void 0&&(r=!1),n(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(n)})},t.DOCUMENT_POSITION_DISCONNECTED=1,t.DOCUMENT_POSITION_PRECEDING=2,t.DOCUMENT_POSITION_FOLLOWING=4,t.DOCUMENT_POSITION_CONTAINS=8,t.DOCUMENT_POSITION_CONTAINED_BY=16,t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,t}(Tc),sy=2048,ab=function(){function e(t,n){var r=this;this.globalRuntime=t,this.context=n,this.emitter=new Zt,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=St.create(),this.tmpVec3=nt.Ue(),this.onPointerDown=function(i){var s=r.createPointerEvent(i);if(r.dispatchEvent(s,"pointerdown"),s.pointerType==="touch")r.dispatchEvent(s,"touchstart");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightdown":"mousedown")}var u=r.trackingData(i.pointerId);u.pressTargetsByButton[i.button]=s.composedPath(),r.freeEvent(s)},this.onPointerUp=function(i){var s,l=Ta.now(),u=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(u,"pointerup"),u.pointerType==="touch")r.dispatchEvent(u,"touchend");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;r.dispatchEvent(u,h?"rightup":"mouseup")}var p=r.trackingData(i.pointerId),m=r.findMountedTarget(p.pressTargetsByButton[i.button]),y=m;if(m&&!u.composedPath().includes(m)){for(var b=m;b&&!u.composedPath().includes(b);){if(u.currentTarget=b,r.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch")r.notifyTarget(u,"touchendoutside");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;r.notifyTarget(u,h?"rightupoutside":"mouseupoutside")}Xa.isNode(b)&&(b=b.parentNode)}delete p.pressTargetsByButton[i.button],y=b}if(y){var w=r.clonePointerEvent(u,"click");w.target=y,w.path=[],p.clicksByButton[i.button]||(p.clicksByButton[i.button]={clickCount:0,target:w.target,timeStamp:l});var R=r.context.renderingContext.root.ownerDocument.defaultView,M=p.clicksByButton[i.button];M.target===w.target&&l-M.timeStamp<R.dblClickSpeed?++M.clickCount:M.clickCount=1,M.target=w.target,M.timeStamp=l,w.detail=M.clickCount,!((s=u.detail)===null||s===void 0)&&s.preventClick||(!r.context.config.useNativeClickEvent&&(w.pointerType==="mouse"||w.pointerType==="touch")&&r.dispatchEvent(w,"click"),r.dispatchEvent(w,"pointertap")),r.freeEvent(w)}r.freeEvent(u)},this.onPointerMove=function(i){var s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),l=s.pointerType==="mouse"||s.pointerType==="pen",u=r.trackingData(i.pointerId),h=r.findMountedTarget(u.overTargets);if(u.overTargets&&h!==s.target){var p=i.type==="mousemove"?"mouseout":"pointerout",m=r.createPointerEvent(i,p,h||void 0);if(r.dispatchEvent(m,"pointerout"),l&&r.dispatchEvent(m,"mouseout"),!s.composedPath().includes(h)){var y=r.createPointerEvent(i,"pointerleave",h||void 0);for(y.eventPhase=y.AT_TARGET;y.target&&!s.composedPath().includes(y.target);)y.currentTarget=y.target,r.notifyTarget(y),l&&r.notifyTarget(y,"mouseleave"),Xa.isNode(y.target)&&(y.target=y.target.parentNode);r.freeEvent(y)}r.freeEvent(m)}if(h!==s.target){var b=i.type==="mousemove"?"mouseover":"pointerover",w=r.clonePointerEvent(s,b);r.dispatchEvent(w,"pointerover"),l&&r.dispatchEvent(w,"mouseover");for(var R=h&&Xa.isNode(h)&&h.parentNode;R&&R!==(Xa.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&R!==s.target;)R=R.parentNode;var M=!R||R===(Xa.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(M){var I=r.clonePointerEvent(s,"pointerenter");for(I.eventPhase=I.AT_TARGET;I.target&&I.target!==h&&I.target!==(Xa.isNode(r.rootTarget)&&r.rootTarget.parentNode);)I.currentTarget=I.target,r.notifyTarget(I),l&&r.notifyTarget(I,"mouseenter"),Xa.isNode(I.target)&&(I.target=I.target.parentNode);r.freeEvent(I)}r.freeEvent(w)}r.dispatchEvent(s,"pointermove"),s.pointerType==="touch"&&r.dispatchEvent(s,"touchmove"),l&&(r.dispatchEvent(s,"mousemove"),r.cursor=r.getCursor(s.target)),u.overTargets=s.composedPath(),r.freeEvent(s)},this.onPointerOut=function(i){var s=r.trackingData(i.pointerId);if(s.overTargets){var l=i.pointerType==="mouse"||i.pointerType==="pen",u=r.findMountedTarget(s.overTargets),h=r.createPointerEvent(i,"pointerout",u||void 0);r.dispatchEvent(h),l&&r.dispatchEvent(h,"mouseout");var p=r.createPointerEvent(i,"pointerleave",u||void 0);for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==(Xa.isNode(r.rootTarget)&&r.rootTarget.parentNode);)p.currentTarget=p.target,r.notifyTarget(p),l&&r.notifyTarget(p,"mouseleave"),Xa.isNode(p.target)&&(p.target=p.target.parentNode);s.overTargets=null,r.freeEvent(h),r.freeEvent(p)}r.cursor=null},this.onPointerOver=function(i){var s=r.trackingData(i.pointerId),l=r.createPointerEvent(i),u=l.pointerType==="mouse"||l.pointerType==="pen";r.dispatchEvent(l,"pointerover"),u&&r.dispatchEvent(l,"mouseover"),l.pointerType==="mouse"&&(r.cursor=r.getCursor(l.target));var h=r.clonePointerEvent(l,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==(Xa.isNode(r.rootTarget)&&r.rootTarget.parentNode);)h.currentTarget=h.target,r.notifyTarget(h),u&&r.notifyTarget(h,"mouseenter"),Xa.isNode(h.target)&&(h.target=h.target.parentNode);s.overTargets=l.composedPath(),r.freeEvent(l),r.freeEvent(h)},this.onPointerUpOutside=function(i){var s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.pressTargetsByButton[i.button]),u=r.createPointerEvent(i);if(l){for(var h=l;h;)u.currentTarget=h,r.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch"||(u.pointerType==="mouse"||u.pointerType==="pen")&&r.notifyTarget(u,u.button===2?"rightupoutside":"mouseupoutside"),Xa.isNode(h)&&(h=h.parentNode);delete s.pressTargetsByButton[i.button]}r.freeEvent(u)},this.onWheel=function(i){var s=r.createWheelEvent(i);r.dispatchEvent(s),r.freeEvent(s)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var s=r.createPointerEvent(i);r.dispatchEvent(s),r.freeEvent(s)}},this.onPointerCancel=function(i){var s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(s),r.freeEvent(s)}}return e.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},e.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},e.prototype.getScale=function(){var t=this.context.contextService.getBoundingClientRect(),n=1,r=1,i=this.context.contextService.getDomElement();if(i&&t){var s=i.offsetWidth,l=i.offsetHeight;s&&l&&(n=t.width/s,r=t.height/l)}return{scaleX:n,scaleY:r,bbox:t}},e.prototype.client2Viewport=function(t){var n=this.getScale(),r=n.scaleX,i=n.scaleY,s=n.bbox;return new ur((t.x-((s==null?void 0:s.left)||0))/r,(t.y-((s==null?void 0:s.top)||0))/i)},e.prototype.viewport2Client=function(t){var n=this.getScale(),r=n.scaleX,i=n.scaleY,s=n.bbox;return new ur((t.x+((s==null?void 0:s.left)||0))*r,(t.y+((s==null?void 0:s.top)||0))*i)},e.prototype.viewport2Canvas=function(t){var n=t.x,r=t.y,i=this.rootTarget.defaultView,s=i.getCamera(),l=this.context.config,u=l.width,h=l.height,p=s.getPerspectiveInverse(),m=s.getWorldTransform(),y=St.multiply(this.tmpMatrix,m,p),b=nt.t8(this.tmpVec3,n/u*2-1,(1-r/h)*2-1,0);return nt.fF(b,b,y),new ur(b[0],b[1])},e.prototype.canvas2Viewport=function(t){var n=this.rootTarget.defaultView,r=n.getCamera(),i=r.getPerspective(),s=r.getViewTransform(),l=St.multiply(this.tmpMatrix,i,s),u=nt.t8(this.tmpVec3,t.x,t.y,0);nt.fF(this.tmpVec3,this.tmpVec3,l);var h=this.context.config,p=h.width,m=h.height;return new ur((u[0]+1)/2*p,(1-(u[1]+1)/2)*m)},e.prototype.setPickHandler=function(t){this.pickHandler=t},e.prototype.addEventMapping=function(t,n){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:n,priority:0}),this.mappingTable[t].sort(function(r,i){return r.priority-i.priority})},e.prototype.mapEvent=function(t){if(this.rootTarget){var n=this.mappingTable[t.type];if(n)for(var r=0,i=n.length;r<i;r++)n[r].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}},e.prototype.dispatchEvent=function(t,n,r){if(!r)t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,n);else{t.eventPhase=t.AT_TARGET;var i=this.rootTarget.defaultView||null;t.currentTarget=i,this.notifyListeners(t,n)}this.emitter.emit(n||t.type,t)},e.prototype.propagate=function(t,n){if(t.target){var r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(t.currentTarget=r[i],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,n),!(t.propagationStopped||t.propagationImmediatelyStopped)){var s=r.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var i=s+1;i<r.length;i++)if(t.currentTarget=r[i],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return}}},e.prototype.propagationPath=function(t){var n=[t],r=this.rootTarget.defaultView||null;if(r&&r===t)return n.unshift(r.document),n;for(var i=0;i<sy&&t!==this.rootTarget;i++)Xa.isNode(t)&&t.parentNode&&(n.push(t.parentNode),t=t.parentNode);return r&&n.push(r),n},e.prototype.hitTest=function(t){var n=t.viewportX,r=t.viewportY,i=this.context.config,s=i.width,l=i.height,u=i.disableHitTesting;return n<0||r<0||n>s||r>l?null:!u&&this.pickHandler(t)||this.rootTarget||null},e.prototype.isNativeEventFromCanvas=function(t,n){var r=n==null?void 0:n.target;if(r!=null&&r.shadowRoot&&(r=n.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r)}return n!=null&&n.composedPath?n.composedPath().indexOf(t)>-1:!1},e.prototype.getExistedHTML=function(t){var n,r;if(t.nativeEvent.composedPath)try{for(var i=(0,z.XA)(t.nativeEvent.composedPath()),s=i.next();!s.done;s=i.next()){var l=s.value,u=this.nativeHTMLMap.get(l);if(u)return u}}catch(h){n={error:h}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null},e.prototype.pickTarget=function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})},e.prototype.createPointerEvent=function(t,n,r,i){var s=this.allocateEvent(s0);this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t;var l=this.getExistedHTML(s),u=this.context.contextService.getDomElement();return s.target=r!=null?r:l||this.isNativeEventFromCanvas(u,s.nativeEvent)&&this.pickTarget(s)||i,typeof n=="string"&&(s.type=n),s},e.prototype.createWheelEvent=function(t){var n=this.allocateEvent(eg);this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t;var r=this.getExistedHTML(n),i=this.context.contextService.getDomElement();return n.target=r||this.isNativeEventFromCanvas(i,n.nativeEvent)&&this.pickTarget(n),n},e.prototype.trackingData=function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]},e.prototype.cloneWheelEvent=function(t){var n=this.allocateEvent(eg);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=t.type,n},e.prototype.clonePointerEvent=function(t,n){var r=this.allocateEvent(s0);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=n!=null?n:r.type,r},e.prototype.copyPointerData=function(t,n){n.pointerId=t.pointerId,n.width=t.width,n.height=t.height,n.isPrimary=t.isPrimary,n.pointerType=t.pointerType,n.pressure=t.pressure,n.tangentialPressure=t.tangentialPressure,n.tiltX=t.tiltX,n.tiltY=t.tiltY,n.twist=t.twist},e.prototype.copyMouseData=function(t,n){n.altKey=t.altKey,n.button=t.button,n.buttons=t.buttons,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.client.copyFrom(t.client),n.movement.copyFrom(t.movement),n.canvas.copyFrom(t.canvas),n.screen.copyFrom(t.screen),n.global.copyFrom(t.global),n.offset.copyFrom(t.offset)},e.prototype.copyWheelData=function(t,n){n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ},e.prototype.copyData=function(t,n){n.isTrusted=t.isTrusted,n.timeStamp=Ta.now(),n.type=t.type,n.detail=t.detail,n.view=t.view,n.page.copyFrom(t.page),n.viewport.copyFrom(t.viewport)},e.prototype.allocateEvent=function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var n=this.eventPool.get(t).pop()||new t(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n},e.prototype.freeEvent=function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=t.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(t)},e.prototype.notifyTarget=function(t,n){n=n!=null?n:t.type;var r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,n)},e.prototype.notifyListeners=function(t,n){var r=t.currentTarget.emitter,i=r._events[n];if(i)if("fn"in i)i.once&&r.removeListener(n,i.fn,void 0,!0),i.fn.call(t.currentTarget||i.context,t);else for(var s=0;s<i.length&&!t.propagationImmediatelyStopped;s++)i[s].once&&r.removeListener(n,i[s].fn,void 0,!0),i[s].fn.call(t.currentTarget||i[s].context,t)},e.prototype.findMountedTarget=function(t){if(!t)return null;for(var n=t[t.length-1],r=t.length-2;r>=0;r--){var i=t[r];if(i===this.rootTarget||Xa.isNode(i)&&i.parentNode===n)n=t[r];else break}return n},e.prototype.getCursor=function(t){for(var n=t;n;){var r=el(n)&&n.getAttribute("cursor");if(r)return r;n=Xa.isNode(n)&&n.parentNode}},e}(),tg=function(){function e(){}return e.prototype.getOrCreateCanvas=function(t,n){if(this.canvas)return this.canvas;if(t||g.offscreenCanvas)this.canvas=t||g.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,z.pi)({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,z.pi)({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,z.pi)({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas},e.prototype.getOrCreateContext=function(t,n){return this.context?this.context:(this.getOrCreateCanvas(t,n),this.context)},e}(),Oh;(function(e){e[e.CAMERA_CHANGED=0]="CAMERA_CHANGED",e[e.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",e[e.NONE=2]="NONE"})(Oh||(Oh={}));var sb=function(){function e(t,n){this.globalRuntime=t,this.context=n,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Kt,initAsync:new yn,dirtycheck:new Yn,cull:new Yn,beginFrame:new Kt,beforeRender:new Kt,render:new Kt,afterRender:new Kt,endFrame:new Kt,destroy:new Kt,pick:new Hn,pickSync:new Yn,pointerDown:new Kt,pointerUp:new Kt,pointerMove:new Kt,pointerOut:new Kt,pointerOver:new Kt,pointerWheel:new Kt,pointerCancel:new Kt,click:new Kt}}return e.prototype.init=function(t){var n=this,r=(0,z.pi)((0,z.pi)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){n.inited=!0,t()})},e.prototype.getStats=function(){return this.stats},e.prototype.disableDirtyRectangleRendering=function(){var t=this.context.config.renderer,n=t.getConfig().enableDirtyRectangleRendering;return!n||this.context.renderingContext.renderReasons.has(Oh.CAMERA_CHANGED)},e.prototype.render=function(t,n,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var l=s.renderReasons.size===1&&s.renderReasons.has(Oh.CAMERA_CHANGED),u=!t.disableRenderHooks||!(t.disableRenderHooks&&l);u&&this.renderDisplayObject(s.root,t,s),this.hooks.beginFrame.call(n),u&&s.renderListCurrentFrame.forEach(function(h){i.hooks.beforeRender.call(h),i.hooks.render.call(h),i.hooks.afterRender.call(h)}),this.hooks.endFrame.call(n),s.renderListCurrentFrame=[],s.renderReasons.clear(),r()}},e.prototype.renderDisplayObject=function(t,n,r){var i=this,s=n.renderer.getConfig(),l=s.enableDirtyCheck,u=s.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(t);var h=t.renderable,p=l?h.dirty||r.dirtyRectangleRenderingDisabled?t:null:t;if(p){var m=u?this.hooks.cull.call(p,this.context.camera):p;m&&(this.stats.rendered++,r.renderListCurrentFrame.push(m))}t.renderable.dirty=!1,t.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var y=t.sortable;y.dirty&&(this.sort(t,y),y.dirty=!1,y.dirtyChildren=[],y.dirtyReason=void 0),(y.sorted||t.childNodes).forEach(function(b){i.renderDisplayObject(b,n,r)})},e.prototype.sort=function(t,n){n.sorted&&n.dirtyReason!==lh.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(r){var i=t.childNodes.indexOf(r);if(i===-1){var s=n.sorted.indexOf(r);s>=0&&n.sorted.splice(s,1)}else if(n.sorted.length===0)n.sorted.push(r);else{var l=Yl(n.sorted,r);n.sorted.splice(l,0,r)}}):n.sorted=t.childNodes.slice().sort(zl)},e.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},e.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(Oh.DISPLAY_OBJECT_CHANGED)},e}(),sv=/\[\s*(.*)=(.*)\s*\]/,Ip=function(){function e(){}return e.prototype.selectOne=function(t,n){var r=this;if(t.startsWith("."))return n.find(function(u){return((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.find(function(u){return u.id===r.getIdOrClassname(t)});if(t.startsWith("[")){var i=this.getAttribute(t),s=i.name,l=i.value;return s?n.find(function(u){return n!==u&&(s==="name"?u.name===l:r.attributeToString(u,s)===l)}):null}else return n.find(function(u){return n!==u&&u.nodeName===t})},e.prototype.selectAll=function(t,n){var r=this;if(t.startsWith("."))return n.findAll(function(u){return n!==u&&((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.findAll(function(u){return n!==u&&u.id===r.getIdOrClassname(t)});if(t.startsWith("[")){var i=this.getAttribute(t),s=i.name,l=i.value;return s?n.findAll(function(u){return n!==u&&(s==="name"?u.name===l:r.attributeToString(u,s)===l)}):[]}else return n.findAll(function(u){return n!==u&&u.nodeName===t})},e.prototype.is=function(t,n){if(t.startsWith("."))return n.className===this.getIdOrClassname(t);if(t.startsWith("#"))return n.id===this.getIdOrClassname(t);if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,s=r.value;return i==="name"?n.name===s:this.attributeToString(n,i)===s}else return n.nodeName===t},e.prototype.getIdOrClassname=function(t){return t.substring(1)},e.prototype.getAttribute=function(t){var n=t.match(sv),r="",i="";return n&&n.length>2&&(r=n[1].replace(/"/g,""),i=n[2].replace(/"/g,"")),{name:r,value:i}},e.prototype.attributeToString=function(t,n){if(!t.getAttribute)return"";var r=t.getAttribute(n);return(0,sr.Z)(r)?"":r.toString?r.toString():""},e}(),Gu=function(e){(0,z.ZT)(t,e);function t(n,r,i,s,l,u,h,p){var m=e.call(this,null)||this;return m.relatedNode=r,m.prevValue=i,m.newValue=s,m.attrName=l,m.attrChange=u,m.prevParsedValue=h,m.newParsedValue=p,m.type=n,m}return t.ADDITION=2,t.MODIFICATION=1,t.REMOVAL=3,t}(Qv),wa;(function(e){e.REPARENT="reparent",e.DESTROY="destroy",e.ATTR_MODIFIED="DOMAttrModified",e.INSERTED="DOMNodeInserted",e.REMOVED="removed",e.MOUNTED="DOMNodeInsertedIntoDocument",e.UNMOUNTED="DOMNodeRemovedFromDocument",e.BOUNDS_CHANGED="bounds-changed",e.CULLED="culled"})(wa||(wa={}));function tc(e){var t=e.renderable;t&&(t.renderBoundsDirty=!0,t.boundsDirty=!0)}var kc=new Gu(wa.REPARENT,null,"","","",0,"",""),Lp=function(){function e(t){var n=this;this.runtime=t,this.pendingEvents=[],this.boundsChangedEvent=new tl(wa.BOUNDS_CHANGED),this.rotate=function(){var r=qr();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=nt.al(s,l,u));var p=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)n.rotateLocal(i,s);else{var m=qr();wn(m,s[0],s[1],s[2]);var y=n.getRotation(i),b=n.getRotation(i.parentNode);Vi(r,b),Ln(r,r),vo(m,r,m),vo(p.localRotation,m,y),Yo(p.localRotation,p.localRotation),h&&n.dirtifyLocal(i,p)}}}(),this.rotateLocal=function(){var r=qr();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=nt.al(s,l,u));var p=i.transformable;wn(r,s[0],s[1],s[2]),zi(p.localRotation,p.localRotation,r),h&&n.dirtifyLocal(i,p)}}(),this.setEulerAngles=function(){var r=qr();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=nt.al(s,l,u));var p=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)n.setLocalEulerAngles(i,s);else{wn(p.localRotation,s[0],s[1],s[2]);var m=n.getRotation(i.parentNode);Vi(r,Ln(qr(),m)),zi(p.localRotation,p.localRotation,r),h&&n.dirtifyLocal(i,p)}}}(),this.translateLocal=function(){return function(r,i,s,l,u){s===void 0&&(s=0),l===void 0&&(l=0),u===void 0&&(u=!0),typeof i=="number"&&(i=nt.al(i,s,l));var h=r.transformable;nt.fS(i,nt.Ue())||(nt.VC(i,i,h.localRotation),nt.IH(h.localPosition,h.localPosition,i),u&&n.dirtifyLocal(r,h))}}(),this.setPosition=function(){var r=St.create(),i=nt.Ue();return function(s,l,u){u===void 0&&(u=!0);var h=s.transformable;if(i[0]=l[0],i[1]=l[1],i[2]=l[2]||0,!nt.fS(n.getPosition(s),i)){if(nt.JG(h.position,i),s.parentNode===null||!s.parentNode.transformable)nt.JG(h.localPosition,i);else{var p=s.parentNode.transformable;St.copy(r,p.worldTransform),St.invert(r,r),nt.fF(h.localPosition,i,r)}u&&n.dirtifyLocal(s,h)}}}(),this.setLocalPosition=function(){var r=nt.Ue();return function(i,s,l){l===void 0&&(l=!0);var u=i.transformable;r[0]=s[0],r[1]=s[1],r[2]=s[2]||0,!nt.fS(u.localPosition,r)&&(nt.JG(u.localPosition,r),l&&n.dirtifyLocal(i,u))}}(),this.translate=function(){var r=nt.Ue(),i=nt.Ue(),s=nt.Ue();return function(l,u,h,p,m){h===void 0&&(h=0),p===void 0&&(p=0),m===void 0&&(m=!0),typeof u=="number"&&(u=nt.t8(i,u,h,p)),!nt.fS(u,r)&&(nt.IH(s,n.getPosition(l),u),n.setPosition(l,s,m))}}(),this.setRotation=function(){var r=qr();return function(i,s,l,u,h,p){p===void 0&&(p=!0);var m=i.transformable;if(typeof s=="number"&&(s=ai(s,l,u,h)),i.parentNode===null||!i.parentNode.transformable)n.setLocalRotation(i,s);else{var y=n.getRotation(i.parentNode);Vi(r,y),Ln(r,r),vo(m.localRotation,r,s),Yo(m.localRotation,m.localRotation),p&&n.dirtifyLocal(i,m)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=St.create(),i=nt.Ue(),s=ai(0,0,0,1);return function(l){var u=l.localSkew[0]!==0||l.localSkew[1]!==0;if(u){if(St.fromRotationTranslationScaleOrigin(l.localTransform,l.localRotation,l.localPosition,nt.al(1,1,1),l.origin),l.localSkew[0]!==0||l.localSkew[1]!==0){var h=St.identity(r);h[4]=Math.tan(l.localSkew[0]),h[1]=Math.tan(l.localSkew[1]),St.multiply(l.localTransform,l.localTransform,h)}var p=St.fromRotationTranslationScaleOrigin(r,s,i,l.localScale,l.origin);St.multiply(l.localTransform,l.localTransform,p)}else St.fromRotationTranslationScaleOrigin(l.localTransform,l.localRotation,l.localPosition,l.localScale,l.origin)}}()}return e.prototype.matches=function(t,n){return this.runtime.sceneGraphSelector.is(t,n)},e.prototype.querySelector=function(t,n){return this.runtime.sceneGraphSelector.selectOne(t,n)},e.prototype.querySelectorAll=function(t,n){return this.runtime.sceneGraphSelector.selectAll(t,n)},e.prototype.attach=function(t,n,r){var i,s=!1;t.parentNode&&(s=t.parentNode!==n,this.detach(t)),t.parentNode=n,(0,sr.Z)(r)?t.parentNode.childNodes.push(t):t.parentNode.childNodes.splice(r,0,t);var l=n.sortable;(!((i=l==null?void 0:l.sorted)===null||i===void 0)&&i.length||t.parsedStyle.zIndex)&&(l.dirtyChildren.indexOf(t)===-1&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=lh.ADDED);var u=t.transformable;u&&this.dirtifyWorld(t,u),u.frozen&&this.unfreezeParentToRoot(t),s&&t.dispatchEvent(kc)},e.prototype.detach=function(t){var n,r;if(t.parentNode){var i=t.transformable,s=t.parentNode.sortable;(!((n=s==null?void 0:s.sorted)===null||n===void 0)&&n.length||!((r=t.style)===null||r===void 0)&&r.zIndex)&&(s.dirtyChildren.indexOf(t)===-1&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=lh.REMOVED);var l=t.parentNode.childNodes.indexOf(t);l>-1&&t.parentNode.childNodes.splice(l,1),i&&this.dirtifyWorld(t,i),t.parentNode=null}},e.prototype.getOrigin=function(t){return t.getGeometryBounds(),t.transformable.origin},e.prototype.setOrigin=function(t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof n=="number"&&(n=[n,r,i]);var s=t.transformable;if(!(n[0]===s.origin[0]&&n[1]===s.origin[1]&&n[2]===s.origin[2])){var l=s.origin;l[0]=n[0],l[1]=n[1],l[2]=n[2]||0,this.dirtifyLocal(t,s)}},e.prototype.setLocalEulerAngles=function(t,n,r,i,s){r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=!0),typeof n=="number"&&(n=nt.al(n,r,i));var l=t.transformable;wn(l.localRotation,n[0],n[1],n[2]),s&&this.dirtifyLocal(t,l)},e.prototype.scaleLocal=function(t,n,r){r===void 0&&(r=!0);var i=t.transformable;nt.Jp(i.localScale,i.localScale,nt.al(n[0],n[1],n[2]||1)),r&&this.dirtifyLocal(t,i)},e.prototype.setLocalScale=function(t,n,r){r===void 0&&(r=!0);var i=t.transformable,s=nt.al(n[0],n[1],n[2]||i.localScale[2]);nt.fS(s,i.localScale)||(nt.JG(i.localScale,s),r&&this.dirtifyLocal(t,i))},e.prototype.setLocalRotation=function(t,n,r,i,s,l){l===void 0&&(l=!0),typeof n=="number"&&(n=ai(n,r,i,s));var u=t.transformable;Vi(u.localRotation,n),l&&this.dirtifyLocal(t,u)},e.prototype.setLocalSkew=function(t,n,r){typeof n=="number"&&(n=Tt.al(n,r));var i=t.transformable;Tt.JG(i.localSkew,n),this.dirtifyLocal(t,i)},e.prototype.dirtifyLocal=function(t,n){n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtifyWorld(t,n))},e.prototype.dirtifyWorld=function(t,n){n.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,n),this.dirtifyToRoot(t,!0)},e.prototype.triggerPendingEvents=function(){var t=this,n=new Set,r=function(i,s){i.isConnected&&!n.has(i.entity)&&(t.boundsChangedEvent.detail=s,t.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(t.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),n.add(i.entity))};this.pendingEvents.forEach(function(i){var s=(0,z.CR)(i,2),l=s[0],u=s[1];u.affectChildren?l.forEach(function(h){r(h,u)}):r(l,u)}),this.clearPendingEvents(),n.clear()},e.prototype.clearPendingEvents=function(){this.pendingEvents=[]},e.prototype.dirtifyToRoot=function(t,n){n===void 0&&(n=!1);var r=t;for(r.renderable&&(r.renderable.dirty=!0);r;)tc(r),r=r.parentNode;n&&t.forEach(function(i){tc(i)}),this.informDependentDisplayObjects(t),this.pendingEvents.push([t,{affectChildren:n}])},e.prototype.updateDisplayObjectDependency=function(t,n,r,i){if(n&&n!==r){var s=this.displayObjectDependencyMap.get(n);if(s&&s[t]){var l=s[t].indexOf(i);s[t].splice(l,1)}}if(r){var u=this.displayObjectDependencyMap.get(r);u||(this.displayObjectDependencyMap.set(r,{}),u=this.displayObjectDependencyMap.get(r)),u[t]||(u[t]=[]),u[t].push(i)}},e.prototype.informDependentDisplayObjects=function(t){var n=this,r=this.displayObjectDependencyMap.get(t);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(s){n.dirtifyToRoot(s,!0),s.dispatchEvent(new Gu(wa.ATTR_MODIFIED,s,n,n,i,Gu.MODIFICATION,n,n)),s.isCustomElement&&s.isConnected&&s.attributeChangedCallback&&s.attributeChangedCallback(i,n,n)})})},e.prototype.getPosition=function(t){var n=t.transformable;return St.getTranslation(n.position,this.getWorldTransform(t,n))},e.prototype.getRotation=function(t){var n=t.transformable;return St.getRotation(n.rotation,this.getWorldTransform(t,n))},e.prototype.getScale=function(t){var n=t.transformable;return St.getScaling(n.scaling,this.getWorldTransform(t,n))},e.prototype.getWorldTransform=function(t,n){return n===void 0&&(n=t.transformable),!n.localDirtyFlag&&!n.dirtyFlag||(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,n)),n.worldTransform},e.prototype.getLocalPosition=function(t){return t.transformable.localPosition},e.prototype.getLocalRotation=function(t){return t.transformable.localRotation},e.prototype.getLocalScale=function(t){return t.transformable.localScale},e.prototype.getLocalSkew=function(t){return t.transformable.localSkew},e.prototype.getLocalTransform=function(t){var n=t.transformable;return n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.localTransform},e.prototype.setLocalTransform=function(t,n){var r=St.getTranslation(nt.Ue(),n),i=St.getRotation(qr(),n),s=St.getScaling(nt.Ue(),n);this.setLocalScale(t,s,!1),this.setLocalPosition(t,r,!1),this.setLocalRotation(t,i,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)},e.prototype.resetLocalTransform=function(t){this.setLocalScale(t,[1,1,1]),this.setLocalPosition(t,[0,0,0]),this.setLocalEulerAngles(t,[0,0,0]),this.setLocalSkew(t,[0,0])},e.prototype.getTransformedGeometryBounds=function(t,n,r){n===void 0&&(n=!1);var i=this.getGeometryBounds(t,n);if(Cn.isEmpty(i))return null;var s=r||new Cn;return s.setFromTransformedAABB(i,this.getWorldTransform(t)),s},e.prototype.getGeometryBounds=function(t,n){n===void 0&&(n=!1);var r=t.geometry;r.dirty&&g.styleValueRegistry.updateGeometry(t);var i=n?r.renderBounds:r.contentBounds||null;return i||new Cn},e.prototype.getBounds=function(t,n){var r=this;n===void 0&&(n=!1);var i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var s=n?i.renderBounds:i.bounds,l=this.getTransformedGeometryBounds(t,n,s),u=t.childNodes;if(u.forEach(function(m){var y=r.getBounds(m,n);y&&(l?l.add(y):(l=s||new Cn,l.update(y.center,y.halfExtents)))}),l||(l=new Cn),n){var h=as(t);if(h){var p=h.parsedStyle.clipPath.getBounds(n);l?p&&(l=p.intersection(l)):l.update(p.center,p.halfExtents)}}return n?(i.renderBounds=l,i.renderBoundsDirty=!1):(i.bounds=l,i.boundsDirty=!1),l},e.prototype.getLocalBounds=function(t){if(t.parentNode){var n=St.create();t.parentNode.transformable&&(n=St.invert(St.create(),this.getWorldTransform(t.parentNode)));var r=this.getBounds(t);if(!Cn.isEmpty(r)){var i=new Cn;return i.setFromTransformedAABB(r,n),i}}return this.getBounds(t)},e.prototype.getBoundingClientRect=function(t){var n,r,i,s=this.getGeometryBounds(t);Cn.isEmpty(s)||(i=new Cn,i.setFromTransformedAABB(s,this.getWorldTransform(t)));var l=(r=(n=t.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var u=(0,z.CR)(i.getMin(),2),h=u[0],p=u[1],m=(0,z.CR)(i.getMax(),2),y=m[0],b=m[1];return new Cr(h+((l==null?void 0:l.left)||0),p+((l==null?void 0:l.top)||0),y-h,b-p)}return new Cr((l==null?void 0:l.left)||0,(l==null?void 0:l.top)||0,0,0)},e.prototype.dirtifyWorldInternal=function(t,n){var r=this;if(!n.dirtyFlag){n.dirtyFlag=!0,n.frozen=!1,t.childNodes.forEach(function(s){var l=s.transformable;l.dirtyFlag||r.dirtifyWorldInternal(s,l)});var i=t.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},e.prototype.syncHierarchy=function(t){var n=t.transformable;if(!n.frozen){n.frozen=!0,(n.localDirtyFlag||n.dirtyFlag)&&this.sync(t,n);for(var r=t.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},e.prototype.sync=function(t,n){if(n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.dirtyFlag){var r=t.parentNode,i=r&&r.transformable;r===null||!i?St.copy(n.worldTransform,n.localTransform):St.multiply(n.worldTransform,i.worldTransform,n.localTransform),n.dirtyFlag=!1}},e.prototype.unfreezeParentToRoot=function(t){for(var n=t.parentNode;n;){var r=n.transformable;r&&(r.frozen=!1),n=n.parentNode}},e}(),qd={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ks=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ly=/[!%),.:;?\]}'""]/,Qd=/[$('"]/,Rh=/[!),.:;?\]}'""]/,M1=/[([{'"]/,P1=/[)\]'"?!:;,.]/,lb=/[(['"...]/,qc=/[!%),.:;?\]}'"]/,l0=/[$([{'"#]/,cy=new RegExp("".concat(ly.source,"|").concat(Rh.source,"|").concat(P1.source,"|").concat(qc.source)),c=new RegExp("".concat(Qd.source,"|").concat(M1.source,"|").concat(lb.source,"|").concat(l0.source)),d=function(){function e(t){var n=this;this.runtime=t,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return n.isBreakingSpace(i)?!1:!!(r&&(c.exec(i)||cy.exec(r)))},this.trimByKinsokuShorui=function(r){var i=(0,z.ev)([],(0,z.CR)(r),!1),s=i[i.length-2];if(!s)return r;var l=s[s.length-1];return i[i.length-2]=s.slice(0,-1),i[i.length-1]=l+i[i.length-1],i}}return e.prototype.measureFont=function(t,n){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});s.font=t;var l=qd.MetricsString+qd.BaselineSymbol,u=Math.ceil(s.measureText(l).width),h=Math.ceil(s.measureText(qd.BaselineSymbol).width),p=qd.HeightMultiplier*h;h=h*qd.BaselineMultiplier|0,i.width=u,i.height=p,s.fillStyle="#f00",s.fillRect(0,0,u,p),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(l,0,h);var m=s.getImageData(0,0,u||1,p||1).data,y=m.length,b=u*4,w=0,R=0,M=!1;for(w=0;w<h;++w){for(var I=0;I<b;I+=4)if(m[R+I]!==255){M=!0;break}if(!M)R+=b;else break}for(r.ascent=h-w,R=y-b,M=!1,w=p;w>h;--w){for(var I=0;I<b;I+=4)if(m[R+I]!==255){M=!0;break}if(!M)R-=b;else break}return r.descent=w-h,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[t]=r,r},e.prototype.measureText=function(t,n,r){var i=n.fontSize,s=i===void 0?16:i,l=n.wordWrap,u=l===void 0?!1:l,h=n.lineHeight,p=n.lineWidth,m=p===void 0?1:p,y=n.textBaseline,b=y===void 0?"alphabetic":y,w=n.textAlign,R=w===void 0?"start":w,M=n.letterSpacing,I=M===void 0?0:M,N=n.textPath;n.textPathSide,n.textPathStartOffset;var U=n.leading,Z=U===void 0?0:U,Y=mi(n),$=this.measureFont(Y,r);$.fontSize===0&&($.fontSize=s,$.ascent=s);var J=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);J.font=Y,n.isOverflowing=!1;var se=u?this.wordWrap(t,n,r):t,pe=se.split(/(?:\r\n|\r|\n)/),Ce=new Array(pe.length),Ue=0;if(N){N.getTotalLength();for(var Je=0;Je<pe.length;Je++)var lt=J.measureText(pe[Je]).width+(pe[Je].length-1)*I}else{for(var Je=0;Je<pe.length;Je++){var Ge=J.measureText(pe[Je]).width+(pe[Je].length-1)*I;Ce[Je]=Ge,Ue=Math.max(Ue,Ge)}var lt=Ue+m,at=h||$.fontSize+m,st=Math.max(at,$.fontSize+m)+(pe.length-1)*(at+Z);at+=Z;var ft=0;return b==="middle"?ft=-st/2:b==="bottom"||b==="alphabetic"||b==="ideographic"?ft=-st:(b==="top"||b==="hanging")&&(ft=0),{font:Y,width:lt,height:st,lines:pe,lineWidths:Ce,lineHeight:at,maxLineWidth:Ue,fontProperties:$,lineMetrics:Ce.map(function(wt,zt){var En=0;return R==="center"||R==="middle"?En-=wt/2:(R==="right"||R==="end")&&(En-=wt),new Cr(En-m/2,ft+zt*at,wt+m,at)})}}},e.prototype.setGraphemeOnPath=function(){},e.prototype.wordWrap=function(t,n,r){var i=this,s=n.wordWrapWidth,l=s===void 0?0:s,u=n.letterSpacing,h=u===void 0?0:u,p=n.maxLines,m=p===void 0?1/0:p,y=n.textOverflow,b=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),w=l+h,R="";y==="ellipsis"?R="...":y&&y!=="clip"&&(R=y);for(var M=[],I=0,N=0,U={},Z=function(ft){return i.getFromCache(ft,h,U,b)},Y=Array.from(R).reduce(function(ft,Vt){return ft+Z(Vt)},0),$=Array.from(t),J=0;J<$.length;J++){var se=$[J],pe=t[J-1],Ce=t[J+1],Ue=Z(se);if(this.isNewline(se)){if(I++,I>=m){n.isOverflowing=!0;break}N=0,M[I]="";continue}if(N>0&&N+Ue>w){if(I+1>=m){if(n.isOverflowing=!0,Y>0&&Y<=w){for(var Je=M[I].length,lt=0,Ge=Je,at=0;at<Je;at++){var st=Z(M[I][at]);if(lt+st+Y>w){Ge=at;break}lt+=st}M[I]=(M[I]||"").slice(0,Ge)+R}break}if(I++,N=0,M[I]="",this.isBreakingSpace(se))continue;this.canBreakInLastChar(se)||(M=this.trimToBreakable(M),N=this.sumTextWidthByCache(M[I]||"",U)),this.shouldBreakByKinsokuShorui(se,Ce)&&(M=this.trimByKinsokuShorui(M),N+=Z(pe||""))}N+=Ue,M[I]=(M[I]||"")+se}return M.join(`
`)},e.prototype.isBreakingSpace=function(t){return typeof t!="string"?!1:qd.BreakingSpaces.indexOf(t.charCodeAt(0))>=0},e.prototype.isNewline=function(t){return typeof t!="string"?!1:qd.Newlines.indexOf(t.charCodeAt(0))>=0},e.prototype.trimToBreakable=function(t){var n=(0,z.ev)([],(0,z.CR)(t),!1),r=n[n.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return n;var s=r.slice(i,i+1),l=this.isBreakingSpace(s),u=i+1,h=i+(l?0:1);return n[n.length-1]+=r.slice(u,r.length),n[n.length-2]=r.slice(0,h),n},e.prototype.canBreakInLastChar=function(t){return!(t&&ks.test(t))},e.prototype.sumTextWidthByCache=function(t,n){return t.split("").reduce(function(r,i){if(!n[i])throw Error("cannot count the word without cache");return r+n[i]},0)},e.prototype.findBreakableIndex=function(t){for(var n=t.length-1;n>=0;n--)if(!ks.test(t[n]))return n;return-1},e.prototype.getFromCache=function(t,n,r,i){var s=r[t];if(typeof s!="number"){var l=t.length*n;s=i.measureText(t).width+l,r[t]=s}return s},e}(),g={},A=function(){var e,t=new Od,n=new qv;return e={},e[Gr.CIRCLE]=new Sc,e[Gr.ELLIPSE]=new xu,e[Gr.RECT]=t,e[Gr.IMAGE]=t,e[Gr.GROUP]=new C1,e[Gr.LINE]=new mm,e[Gr.TEXT]=new Kd(g),e[Gr.POLYLINE]=n,e[Gr.POLYGON]=n,e[Gr.PATH]=new uf,e[Gr.HTML]=null,e[Gr.MESH]=null,e}(),P=function(){var e,t=new to,n=new Bo;return e={},e[io.PERCENTAGE]=null,e[io.NUMBER]=new $r,e[io.ANGLE]=new oo,e[io.DEFINED_PATH]=new xi,e[io.PAINT]=t,e[io.COLOR]=t,e[io.FILTER]=new si,e[io.LENGTH]=n,e[io.LENGTH_PERCENTAGE]=n,e[io.LENGTH_PERCENTAGE_12]=new ha,e[io.LENGTH_PERCENTAGE_14]=new Ki,e[io.COORDINATE]=new Bo,e[io.OFFSET_DISTANCE]=new zo,e[io.OPACITY_VALUE]=new Ua,e[io.PATH]=new co,e[io.LIST_OF_POINTS]=new Da,e[io.SHADOW_BLUR]=new da,e[io.TEXT]=new Jo,e[io.TEXT_TRANSFORM]=new vs,e[io.TRANSFORM]=new qo,e[io.TRANSFORM_ORIGIN]=new ia,e[io.Z_INDEX]=new As,e[io.MARKER]=new Ei,e}(),B=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};g.CameraContribution=ko,g.AnimationTimeline=null,g.EasingFunction=null,g.offscreenCanvasCreator=new tg,g.sceneGraphSelector=new Ip,g.sceneGraphService=new Lp(g),g.textService=new d(g),g.geometryUpdaterFactory=A,g.CSSPropertySyntaxFactory=P,g.styleValueRegistry=new ii(g),g.layoutRegistry=null,g.globalThis=B(),g.enableCSSParsing=!1,g.enableDataset=!1,g.enableStyleSyntax=!0,g.enableAttributeDashCased=!1,g.enableSizeAttenuation=!1;var V=0;function Q(){V=0}var me=new Gu(wa.INSERTED,null,"","","",0,"",""),Le=new Gu(wa.REMOVED,null,"","","",0,"",""),We=new tl(wa.DESTROY),rt=function(e){(0,z.ZT)(t,e);function t(){var n=e.call(this)||this;return n.entity=V++,n.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},n.cullable={strategy:cf.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},n.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},n.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},n.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},n.rBushNode={aabb:void 0},n.namespaceURI="g",n.scrollLeft=0,n.scrollTop=0,n.clientTop=0,n.clientLeft=0,n.destroyed=!1,n.style={},n.computedStyle=g.enableCSSParsing?{opacity:No,fillOpacity:No,strokeOpacity:No,fill:No,stroke:No,transform:No,transformOrigin:No,visibility:No,pointerEvents:No,lineWidth:No,lineCap:No,lineJoin:No,increasedLineWidthForHitTesting:No,fontSize:No,fontFamily:No,fontStyle:No,fontWeight:No,fontVariant:No,textAlign:No,textBaseline:No,textTransform:No,zIndex:No,filter:No,shadowType:No}:null,n.parsedStyle={},n.attributes={},n}return Object.defineProperty(t.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(n){return n!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null},enumerable:!1,configurable:!0}),t.prototype.cloneNode=function(n){throw new Error(dr)},t.prototype.appendChild=function(n,r){var i;if(n.destroyed)throw new Error(ri);return g.sceneGraphService.attach(n,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(n),this.isMutationObserved&&(me.relatedNode=this,n.dispatchEvent(me)),n},t.prototype.insertBefore=function(n,r){if(!r)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(n):this.appendChild(n,i)}return n},t.prototype.replaceChild=function(n,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(n,i),r},t.prototype.removeChild=function(n){var r;return Le.relatedNode=this,n.dispatchEvent(Le),!((r=n.ownerDocument)===null||r===void 0)&&r.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),g.sceneGraphService.detach(n),n},t.prototype.removeChildren=function(){for(var n=this.childNodes.length-1;n>=0;n--){var r=this.childNodes[n];this.removeChild(r)}},t.prototype.destroyChildren=function(){for(var n=this.childNodes.length-1;n>=0;n--){var r=this.childNodes[n];r.childNodes.length&&r.destroyChildren(),r.destroy()}},t.prototype.matches=function(n){return g.sceneGraphService.matches(n,this)},t.prototype.getElementById=function(n){return g.sceneGraphService.querySelector("#".concat(n),this)},t.prototype.getElementsByName=function(n){return g.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)},t.prototype.getElementsByClassName=function(n){return g.sceneGraphService.querySelectorAll(".".concat(n),this)},t.prototype.getElementsByTagName=function(n){return g.sceneGraphService.querySelectorAll(n,this)},t.prototype.querySelector=function(n){return g.sceneGraphService.querySelector(n,this)},t.prototype.querySelectorAll=function(n){return g.sceneGraphService.querySelectorAll(n,this)},t.prototype.closest=function(n){var r=this;do{if(g.sceneGraphService.matches(n,r))return r;r=r.parentElement}while(r!==null);return null},t.prototype.find=function(n){var r=this,i=null;return this.forEach(function(s){return s!==r&&n(s)?(i=s,!0):!1}),i},t.prototype.findAll=function(n){var r=this,i=[];return this.forEach(function(s){s!==r&&n(s)&&i.push(s)}),i},t.prototype.after=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this);r.forEach(function(l,u){var h;return(h=n.parentNode)===null||h===void 0?void 0:h.appendChild(l,s+u+1)})}},t.prototype.before=function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this),l=(0,z.CR)(r),u=l[0],h=l.slice(1);this.parentNode.appendChild(u,s),(n=u).after.apply(n,(0,z.ev)([],(0,z.CR)(h),!1))}},t.prototype.replaceWith=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this.after.apply(this,(0,z.ev)([],(0,z.CR)(n),!1)),this.remove()},t.prototype.append=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(s){return n.appendChild(s)})},t.prototype.prepend=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(s,l){return n.appendChild(s,l)})},t.prototype.replaceChildren=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,(0,z.ev)([],(0,z.CR)(n),!1))},t.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},t.prototype.destroy=function(){this.dispatchEvent(We),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},t.prototype.getGeometryBounds=function(){return g.sceneGraphService.getGeometryBounds(this)},t.prototype.getRenderBounds=function(){return g.sceneGraphService.getBounds(this,!0)},t.prototype.getBounds=function(){return g.sceneGraphService.getBounds(this)},t.prototype.getLocalBounds=function(){return g.sceneGraphService.getLocalBounds(this)},t.prototype.getBoundingClientRect=function(){return g.sceneGraphService.getBoundingClientRect(this)},t.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},t.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},t.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},t.prototype.getAttribute=function(n){if(Sh(n))return g.enableCSSParsing?null:void 0;var r=this.attributes[n];if(r===void 0){if(g.enableAttributeDashCased){var i=bf(n);r=this.attributes[i]}return g.enableCSSParsing&&(0,sr.Z)(r)?null:r}else return r},t.prototype.hasAttribute=function(n){return this.getAttributeNames().includes(n)},t.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},t.prototype.removeAttribute=function(n){this.setAttribute(n,null),delete this.attributes[n]},t.prototype.setAttribute=function(n,r,i,s){this.attributes[n]=r},t.prototype.getAttributeNS=function(n,r){throw new Error(dr)},t.prototype.getAttributeNode=function(n){throw new Error(dr)},t.prototype.getAttributeNodeNS=function(n,r){throw new Error(dr)},t.prototype.hasAttributeNS=function(n,r){throw new Error(dr)},t.prototype.removeAttributeNS=function(n,r){throw new Error(dr)},t.prototype.removeAttributeNode=function(n){throw new Error(dr)},t.prototype.setAttributeNS=function(n,r,i){throw new Error(dr)},t.prototype.setAttributeNode=function(n){throw new Error(dr)},t.prototype.setAttributeNodeNS=function(n){throw new Error(dr)},t.prototype.toggleAttribute=function(n,r){throw new Error(dr)},t}(Xa);function ut(e){return!!(e!=null&&e.nodeName)}var Nt=g.globalThis.Proxy?g.globalThis.Proxy:function(){},cn=new Gu(wa.ATTR_MODIFIED,null,null,null,null,Gu.MODIFICATION,null,null),vn={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},Zn={fill:lf,stroke:lf,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},Nn=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],fr=(0,z.ev)((0,z.ev)([],(0,z.CR)(Nn),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),yr="data-",Sr=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=n,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||Gr.GROUP,g.enableCSSParsing?(Object.assign(r.attributes,vn),Object.assign(r.parsedStyle,Zn,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),g.enableDataset&&(r.dataset=new Nt({},{get:function(i,s){var l="".concat(yr).concat(Vu(s));return i[l]!==void 0?i[l]:r.getAttribute(l)},set:function(i,s,l){return r.setAttribute("".concat(yr).concat(Vu(s)),l),!0}})),g.enableStyleSyntax&&(r.style=new Nt({setProperty:function(i,s){r.setAttribute(i,s)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,s){return i[s]!==void 0?i[s]:r.getAttribute(s)},set:function(i,s,l){return r.setAttribute(s,l),!0}})),r}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.getAnimations().forEach(function(n){n.cancel()})},t.prototype.cloneNode=function(n,r){var i=(0,z.pi)({},this.attributes);for(var s in i){var l=i[s];ut(l)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(i[s]=l.cloneNode(n)),r&&(i[s]=r(s,l))}var u=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return u.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(h){if(!h.style.isMarker){var p=h.cloneNode(n);u.appendChild(p)}}),u},t.prototype.initAttributes=function(n){n===void 0&&(n={});var r=this.renderable,i={forceUpdateGeometry:!0};g.enableCSSParsing&&(i.usedAttributes=fr);var s=n;if(g.enableAttributeDashCased){s={};for(var l in n){var u=bf(l);s[u]=n[l]}}g.styleValueRegistry.processProperties(this,s,i),r.dirty=!0},t.prototype.setAttribute=function(n,r,i,s){i===void 0&&(i=!1),s===void 0&&(s=!0),g.enableAttributeDashCased&&(n=bf(n)),!ti(r)&&(i||r!==this.attributes[n])&&(this.internalSetAttribute(n,r,{memoize:s}),e.prototype.setAttribute.call(this,n,r))},t.prototype.internalSetAttribute=function(n,r,i){var s;i===void 0&&(i={});var l=this.renderable,u=this.attributes[n],h=this.parsedStyle[n];g.styleValueRegistry.processProperties(this,(s={},s[n]=r,s),i),l.dirty=!0;var p=this.parsedStyle[n];this.isConnected&&(cn.relatedNode=this,cn.prevValue=u,cn.newValue=r,cn.attrName=n,cn.prevParsedValue=h,cn.newParsedValue=p,this.isMutationObserved?this.dispatchEvent(cn):(cn.target=this,this.ownerDocument.defaultView.dispatchEvent(cn,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(n,u,r,h,p)},t.prototype.getBBox=function(){var n=this.getBounds(),r=(0,z.CR)(n.getMin(),2),i=r[0],s=r[1],l=(0,z.CR)(n.getMax(),2),u=l[0],h=l[1];return new Cr(i,s,u-i,h-s)},t.prototype.setOrigin=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.setOrigin(this,Al(n,r,i)),this},t.prototype.getOrigin=function(){return g.sceneGraphService.getOrigin(this)},t.prototype.setPosition=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.setPosition(this,Al(n,r,i)),this},t.prototype.setLocalPosition=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.setLocalPosition(this,Al(n,r,i)),this},t.prototype.translate=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.translate(this,Al(n,r,i)),this},t.prototype.translateLocal=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),g.sceneGraphService.translateLocal(this,Al(n,r,i)),this},t.prototype.getPosition=function(){return g.sceneGraphService.getPosition(this)},t.prototype.getLocalPosition=function(){return g.sceneGraphService.getLocalPosition(this)},t.prototype.scale=function(n,r,i){return this.scaleLocal(n,r,i)},t.prototype.scaleLocal=function(n,r,i){return typeof n=="number"&&(r=r||n,i=i||n,n=Al(n,r,i)),g.sceneGraphService.scaleLocal(this,n),this},t.prototype.setLocalScale=function(n,r,i){return typeof n=="number"&&(r=r||n,i=i||n,n=Al(n,r,i)),g.sceneGraphService.setLocalScale(this,n),this},t.prototype.getLocalScale=function(){return g.sceneGraphService.getLocalScale(this)},t.prototype.getScale=function(){return g.sceneGraphService.getScale(this)},t.prototype.getEulerAngles=function(){var n=(0,z.CR)(x(nt.Ue(),g.sceneGraphService.getWorldTransform(this)),3),r=n[2];return ju(r)},t.prototype.getLocalEulerAngles=function(){var n=(0,z.CR)(x(nt.Ue(),g.sceneGraphService.getLocalRotation(this)),3),r=n[2];return ju(r)},t.prototype.setEulerAngles=function(n){return g.sceneGraphService.setEulerAngles(this,0,0,n),this},t.prototype.setLocalEulerAngles=function(n){return g.sceneGraphService.setLocalEulerAngles(this,0,0,n),this},t.prototype.rotateLocal=function(n,r,i){return(0,sr.Z)(r)&&(0,sr.Z)(i)?g.sceneGraphService.rotateLocal(this,0,0,n):g.sceneGraphService.rotateLocal(this,n,r,i),this},t.prototype.rotate=function(n,r,i){return(0,sr.Z)(r)&&(0,sr.Z)(i)?g.sceneGraphService.rotate(this,0,0,n):g.sceneGraphService.rotate(this,n,r,i),this},t.prototype.setRotation=function(n,r,i,s){return g.sceneGraphService.setRotation(this,n,r,i,s),this},t.prototype.setLocalRotation=function(n,r,i,s){return g.sceneGraphService.setLocalRotation(this,n,r,i,s),this},t.prototype.setLocalSkew=function(n,r){return g.sceneGraphService.setLocalSkew(this,n,r),this},t.prototype.getRotation=function(){return g.sceneGraphService.getRotation(this)},t.prototype.getLocalRotation=function(){return g.sceneGraphService.getLocalRotation(this)},t.prototype.getLocalSkew=function(){return g.sceneGraphService.getLocalSkew(this)},t.prototype.getLocalTransform=function(){return g.sceneGraphService.getLocalTransform(this)},t.prototype.getWorldTransform=function(){return g.sceneGraphService.getWorldTransform(this)},t.prototype.setLocalTransform=function(n){return g.sceneGraphService.setLocalTransform(this,n),this},t.prototype.resetLocalTransform=function(){g.sceneGraphService.resetLocalTransform(this)},t.prototype.getAnimations=function(){return this.activeAnimations},t.prototype.animate=function(n,r){var i,s=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return s?s.play(this,n,r):null},t.prototype.isVisible=function(){var n,r;return g.enableCSSParsing?((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(t.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"},enumerable:!1,configurable:!0}),t.prototype.isInteractive=function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"},t.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},t.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})),!1))+1),this},t.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})),!1))-1),this},t.prototype.getConfig=function(){return this.config},t.prototype.attr=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=(0,z.CR)(r,2),l=s[0],u=s[1];return l?ca(l)?(Object.keys(l).forEach(function(h){n.setAttribute(h,l[h])}),this):r.length===2?(this.setAttribute(l,u),this):this.attributes[l]:this.attributes},t.prototype.getMatrix=function(n){var r=n||this.getWorldTransform(),i=(0,z.CR)(St.getTranslation(nt.Ue(),r),2),s=i[0],l=i[1],u=(0,z.CR)(St.getScaling(nt.Ue(),r),2),h=u[0],p=u[1],m=St.getRotation(qr(),r),y=(0,z.CR)(x(nt.Ue(),m),3),b=y[0],w=y[2];return C(b||w,s,l,h,p)},t.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},t.prototype.setMatrix=function(n){var r=(0,z.CR)(G(n),5),i=r[0],s=r[1],l=r[2],u=r[3],h=r[4];this.setEulerAngles(h).setPosition(i,s).setLocalScale(l,u)},t.prototype.setLocalMatrix=function(n){var r=(0,z.CR)(G(n),5),i=r[0],s=r[1],l=r[2],u=r[3],h=r[4];this.setLocalEulerAngles(h).setLocalPosition(i,s).setLocalScale(l,u)},t.prototype.show=function(){g.enableCSSParsing?this.style.visibility="visible":this.forEach(function(n){n.style.visibility="visible"})},t.prototype.hide=function(){g.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(n){n.style.visibility="hidden"})},t.prototype.getCount=function(){return this.childElementCount},t.prototype.getParent=function(){return this.parentElement},t.prototype.getChildren=function(){return this.children},t.prototype.getFirst=function(){return this.firstElementChild},t.prototype.getLast=function(){return this.lastElementChild},t.prototype.getChildByIndex=function(n){return this.children[n]||null},t.prototype.add=function(n,r){return this.appendChild(n,r)},t.prototype.set=function(n,r){this.config[n]=r},t.prototype.get=function(n){return this.config[n]},t.prototype.moveTo=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(n,r,i),this},t.prototype.move=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(n,r,i),this},t.prototype.setZIndex=function(n){return this.style.zIndex=n,this},t}(rt),Ir=function(e){(0,z.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,z.pi)({type:Gr.CIRCLE},n))||this}return t}(Sr),Xr=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,z._T)(n,["style"]);return r=e.call(this,(0,z.pi)({style:g.enableCSSParsing?(0,z.pi)({},i):(0,z.pi)({},i)},s))||this,r.isCustomElement=!0,r}return t}(Sr),Pi=function(e){(0,z.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,z.pi)({type:Gr.ELLIPSE},n))||this}return t}(Sr),Ci=function(e){(0,z.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,z.pi)({type:Gr.GROUP},n))||this}return t}(Sr),Ao=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,z._T)(n,["style"]);return r=e.call(this,(0,z.pi)({type:Gr.HTML,style:g.enableCSSParsing?(0,z.pi)({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):(0,z.pi)({},i)},s))||this,r.cullable.enable=!1,r}return t.prototype.getDomElement=function(){return this.parsedStyle.$el},t.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var n=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return Cr.applyTransform(r,St.invert(St.create(),n))}else{var i=this.parsedStyle,s=i.x,l=i.y,u=i.width,h=i.height;return new Cr(s,l,u,h)}},t.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},t.prototype.getBounds=function(){var n,r,i=this.getBoundingClientRect(),s=(r=(n=this.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),l=new Cn,u=i.left-((s==null?void 0:s.left)||0),h=i.top-((s==null?void 0:s.top)||0);return l.setMinMax([u,h,0],[u+i.width,h+i.height,0]),l},t.prototype.getLocalBounds=function(){if(this.parentNode){var n=St.invert(St.create(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!Cn.isEmpty(r)){var i=new Cn;return i.setFromTransformedAABB(r,n),i}}return this.getBounds()},t}(Sr),ao=function(e){(0,z.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,z.pi)({type:Gr.IMAGE},n))||this}return t}(Sr),Po=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,z._T)(n,["style"]);r=e.call(this,(0,z.pi)({type:Gr.LINE,style:(0,z.pi)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},s))||this,r.markerStartAngle=0,r.markerEndAngle=0;var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd;return u&&ut(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),h&&ut(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return t.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&ut(s)&&(this.markerStartAngle=0,s.remove()),l&&ut(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"&&(s&&ut(s)&&(this.markerEndAngle=0,s.remove()),l&&ut(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1)))},t.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.x1,p=r.x2,m=r.y1,y=r.y2,b=n?i:s;if(!(!b||!ut(b))){var w=0,R,M,I,N,U,Z;n?(I=h,N=m,R=p-h,M=y-m,U=l||0,Z=this.markerStartAngle):(I=p,N=y,R=h-p,M=m-y,U=u||0,Z=this.markerEndAngle),w=Math.atan2(M,R),b.setLocalEulerAngles(w*180/Math.PI+Z),b.setLocalPosition(I+Math.cos(w)*U,N+Math.sin(w)*U)}},t.prototype.getPoint=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle,s=i.x1,l=i.y1,u=i.x2,h=i.y2,p=Ii(s,l,u,h,n),m=p.x,y=p.y,b=nt.fF(nt.Ue(),nt.al(m,y,0),r?this.getWorldTransform():this.getLocalTransform());return new ur(b[0],b[1])},t.prototype.getPointAtLength=function(n,r){return r===void 0&&(r=!1),this.getPoint(n/this.getTotalLength(),r)},t.prototype.getTotalLength=function(){var n=this.parsedStyle,r=n.x1,i=n.y1,s=n.x2,l=n.y2;return yp(r,i,s,l)},t}(Sr),Wi=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,z._T)(n,["style"]);r=e.call(this,(0,z.pi)({type:Gr.PATH,style:g.enableCSSParsing?(0,z.pi)({d:"",miterLimit:""},i):(0,z.pi)({},i),initialParsedStyle:g.enableCSSParsing?null:{miterLimit:4,d:(0,z.pi)({},D0)}},s))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd,p=l.markerMid;return u&&ut(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),p&&ut(p)&&r.placeMarkerMid(p),h&&ut(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return t.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&ut(s)&&(this.markerStartAngle=0,s.remove()),l&&ut(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"?(s&&ut(s)&&(this.markerEndAngle=0,s.remove()),l&&ut(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(l)},t.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=n?i:s;if(!(!h||!ut(h))){var p=0,m,y,b,w,R,M;if(n){var I=(0,z.CR)(this.getStartTangent(),2),N=I[0],U=I[1];b=U[0],w=U[1],m=N[0]-U[0],y=N[1]-U[1],R=l||0,M=this.markerStartAngle}else{var Z=(0,z.CR)(this.getEndTangent(),2),N=Z[0],U=Z[1];b=U[0],w=U[1],m=N[0]-U[0],y=N[1]-U[1],R=u||0,M=this.markerEndAngle}p=Math.atan2(y,m),h.setLocalEulerAngles(p*180/Math.PI+M),h.setLocalPosition(b+Math.cos(p)*R,w+Math.sin(p)*R)}},t.prototype.placeMarkerMid=function(n){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(p){p.remove()}),n&&ut(n))for(var i=1;i<r.length-1;i++){var s=(0,z.CR)(r[i].currentPoint,2),l=s[0],u=s[1],h=i===1?n:n.cloneNode(!0);this.markerMidList.push(h),this.appendChild(h),h.setLocalPosition(l,u)}},t.prototype.getTotalLength=function(){return Sf(this)},t.prototype.getPointAtLength=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,s=Io(i,n),l=s.x,u=s.y,h=nt.fF(nt.Ue(),nt.al(l,u,0),r?this.getWorldTransform():this.getLocalTransform());return new ur(h[0],h[1])},t.prototype.getPoint=function(n,r){return r===void 0&&(r=!1),this.getPointAtLength(n*Sf(this),r)},t.prototype.getStartTangent=function(){var n=this.parsedStyle.d.segments,r=[];if(n.length>1){var i=n[0].currentPoint,s=n[1].currentPoint,l=n[1].startTangent;r=[],l?(r.push([i[0]-l[0],i[1]-l[1]]),r.push([i[0],i[1]])):(r.push([s[0],s[1]]),r.push([i[0],i[1]]))}return r},t.prototype.getEndTangent=function(){var n=this.parsedStyle.d.segments,r=n.length,i=[];if(r>1){var s=n[r-2].currentPoint,l=n[r-1].currentPoint,u=n[r-1].endTangent;i=[],u?(i.push([l[0]-u[0],l[1]-u[1]]),i.push([l[0],l[1]])):(i.push([s[0],s[1]]),i.push([l[0],l[1]]))}return i},t}(Sr),Aa=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,z._T)(n,["style"]);r=e.call(this,(0,z.pi)({type:Gr.POLYGON,style:g.enableCSSParsing?(0,z.pi)({points:"",miterLimit:"",isClosed:!0},i):(0,z.pi)({},i),initialParsedStyle:g.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},s))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd,p=l.markerMid;return u&&ut(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),p&&ut(p)&&r.placeMarkerMid(p),h&&ut(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return t.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&ut(s)&&(this.markerStartAngle=0,s.remove()),l&&ut(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"?(s&&ut(s)&&(this.markerEndAngle=0,s.remove()),l&&ut(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(l)},t.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.points,p=(h||{}).points,m=n?i:s;if(!(!m||!ut(m)||!p)){var y=0,b,w,R,M,I,N;if(R=p[0][0],M=p[0][1],n)b=p[1][0]-p[0][0],w=p[1][1]-p[0][1],I=l||0,N=this.markerStartAngle;else{var U=p.length;this.parsedStyle.isClosed?(b=p[U-1][0]-p[0][0],w=p[U-1][1]-p[0][1]):(R=p[U-1][0],M=p[U-1][1],b=p[U-2][0]-p[U-1][0],w=p[U-2][1]-p[U-1][1]),I=u||0,N=this.markerEndAngle}y=Math.atan2(w,b),m.setLocalEulerAngles(y*180/Math.PI+N),m.setLocalPosition(R+Math.cos(y)*I,M+Math.sin(y)*I)}},t.prototype.placeMarkerMid=function(n){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(p){p.remove()}),this.markerMidList=[],n&&ut(n)&&i)for(var s=1;s<(this.parsedStyle.isClosed?i.length:i.length-1);s++){var l=i[s][0],u=i[s][1],h=s===1?n:n.cloneNode(!0);this.markerMidList.push(h),this.appendChild(h),h.setLocalPosition(l,u)}},t}(Sr),ea=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=(0,z._T)(n,["style"]);return e.call(this,(0,z.pi)({type:Gr.POLYLINE,style:g.enableCSSParsing?(0,z.pi)({points:"",miterLimit:"",isClosed:!1},r):(0,z.pi)({},r),initialParsedStyle:g.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return t.prototype.getTotalLength=function(){return Cd(this)},t.prototype.getPointAtLength=function(n,r){return r===void 0&&(r=!1),this.getPoint(n/this.getTotalLength(),r)},t.prototype.getPoint=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],l=0,u,h,p=this.getTotalLength();i.forEach(function(I,N){i[N+1]&&(u=[0,0],u[0]=l/p,h=yp(I[0],I[1],i[N+1][0],i[N+1][1]),l+=h,u[1]=l/p,s.push(u))}),this.parsedStyle.points.segments=s}var m=0,y=0;this.parsedStyle.points.segments.forEach(function(I,N){n>=I[0]&&n<=I[1]&&(m=(n-I[0])/(I[1]-I[0]),y=N)});var b=Ii(i[y][0],i[y][1],i[y+1][0],i[y+1][1],m),w=b.x,R=b.y,M=nt.fF(nt.Ue(),nt.al(w,R,0),r?this.getWorldTransform():this.getLocalTransform());return new ur(M[0],M[1])},t.prototype.getStartTangent=function(){var n=this.parsedStyle.points.points,r=[];return r.push([n[1][0],n[1][1]]),r.push([n[0][0],n[0][1]]),r},t.prototype.getEndTangent=function(){var n=this.parsedStyle.points.points,r=n.length-1,i=[];return i.push([n[r-1][0],n[r-1][1]]),i.push([n[r][0],n[r][1]]),i},t}(Aa),yo=function(e){(0,z.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,z.pi)({type:Gr.RECT},n))||this}return t}(Sr),ma=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=(0,z._T)(n,["style"]);return e.call(this,(0,z.pi)({type:Gr.TEXT,style:g.enableCSSParsing?(0,z.pi)({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):(0,z.pi)({fill:"black"},r)},i))||this}return t.prototype.getComputedTextLength=function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0},t.prototype.getLineBoundingRects=function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]},t.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},t}(Sr),Ma=function(){function e(){this.registry={},this.define(Gr.CIRCLE,Ir),this.define(Gr.ELLIPSE,Pi),this.define(Gr.RECT,yo),this.define(Gr.IMAGE,ao),this.define(Gr.LINE,Po),this.define(Gr.GROUP,Ci),this.define(Gr.PATH,Wi),this.define(Gr.POLYGON,Aa),this.define(Gr.POLYLINE,ea),this.define(Gr.TEXT,ma),this.define(Gr.HTML,Ao)}return e.prototype.define=function(t,n){this.registry[t]=n},e.prototype.get=function(t){return this.registry[t]},e}(),ns={number:function(e){return new ba(e)},percent:function(e){return new ba(e,"%")},px:function(e){return new ba(e,"px")},em:function(e){return new ba(e,"em")},rem:function(e){return new ba(e,"rem")},deg:function(e){return new ba(e,"deg")},grad:function(e){return new ba(e,"grad")},rad:function(e){return new ba(e,"rad")},turn:function(e){return new ba(e,"turn")},s:function(e){return new ba(e,"s")},ms:function(e){return new ba(e,"ms")},registerProperty:function(e){var t=e.name,n=e.inherits,r=e.interpolable,i=e.initialValue,s=e.syntax;g.styleValueRegistry.registerMetadata({n:t,inh:n,int:r,d:i,syntax:s})},registerLayout:function(e,t){g.layoutRegistry.registerLayout(e,t)}},Wo=function(e){(0,z.ZT)(t,e);function t(){var n=e.call(this)||this;n.defaultView=null,n.ownerDocument=null,n.nodeName="document";try{n.timeline=new g.AnimationTimeline(n)}catch(i){}var r={};return Ni.forEach(function(i){var s=i.n,l=i.inh,u=i.d;l&&u&&(r[s]=kf(u)?u(Gr.GROUP):u)}),n.documentElement=new Ci({id:"g-root",style:r}),n.documentElement.ownerDocument=n,n.documentElement.parentNode=n,n.childNodes=[n.documentElement],n}return Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),t.prototype.createElement=function(n,r){if(n==="svg")return this.documentElement;var i=this.defaultView.customElements.get(n);i||(console.warn("Unsupported tagName: ",n),i=n==="tspan"?ma:Ci);var s=new i(r);return s.ownerDocument=this,s},t.prototype.createElementNS=function(n,r,i){return this.createElement(r,i)},t.prototype.cloneNode=function(n){throw new Error(dr)},t.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(n){}},t.prototype.elementsFromBBox=function(n,r,i,s){var l=this.defaultView.context.rBushRoot,u=l.search({minX:n,minY:r,maxX:i,maxY:s}),h=[];return u.forEach(function(p){var m=p.displayObject,y=m.parsedStyle.pointerEvents,b=y===void 0?"auto":y,w=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(b);(!w||w&&m.isVisible())&&!m.isCulled()&&m.isInteractive()&&h.push(m)}),h.sort(function(p,m){return m.sortable.renderOrder-p.sortable.renderOrder}),h},t.prototype.elementFromPointSync=function(n,r){var i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height;if(s<0||l<0||s>h||l>p)return null;var m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,w=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]}).picked;return w&&w[0]||this.documentElement},t.prototype.elementFromPoint=function(n,r){return(0,z.mG)(this,void 0,void 0,function(){var i,s,l,u,h,p,m,y,b,w;return(0,z.Jh)(this,function(R){switch(R.label){case 0:return i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height,s<0||l<0||s>h||l>p?[2,null]:(m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]})]);case 1:return w=R.sent().picked,[2,w&&w[0]||this.documentElement]}})})},t.prototype.elementsFromPointSync=function(n,r){var i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height;if(s<0||l<0||s>h||l>p)return[];var m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,w=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]}).picked;return w[w.length-1]!==this.documentElement&&w.push(this.documentElement),w},t.prototype.elementsFromPoint=function(n,r){return(0,z.mG)(this,void 0,void 0,function(){var i,s,l,u,h,p,m,y,b,w;return(0,z.Jh)(this,function(R){switch(R.label){case 0:return i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height,s<0||l<0||s>h||l>p?[2,[]]:(m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]})]);case 1:return w=R.sent().picked,w[w.length-1]!==this.documentElement&&w.push(this.documentElement),[2,w]}})})},t.prototype.appendChild=function(n,r){throw new Error(Br)},t.prototype.insertBefore=function(n,r){throw new Error(Br)},t.prototype.removeChild=function(n,r){throw new Error(Br)},t.prototype.replaceChild=function(n,r,i){throw new Error(Br)},t.prototype.append=function(){throw new Error(Br)},t.prototype.prepend=function(){throw new Error(Br)},t.prototype.getElementById=function(n){return this.documentElement.getElementById(n)},t.prototype.getElementsByName=function(n){return this.documentElement.getElementsByName(n)},t.prototype.getElementsByTagName=function(n){return this.documentElement.getElementsByTagName(n)},t.prototype.getElementsByClassName=function(n){return this.documentElement.getElementsByClassName(n)},t.prototype.querySelector=function(n){return this.documentElement.querySelector(n)},t.prototype.querySelectorAll=function(n){return this.documentElement.querySelectorAll(n)},t.prototype.find=function(n){return this.documentElement.find(n)},t.prototype.findAll=function(n){return this.documentElement.findAll(n)},t}(Xa),Cs=function(){function e(t){this.strategies=t}return e.prototype.apply=function(t){var n=t.camera,r=t.renderingService,i=t.renderingContext,s=this.strategies;r.hooks.cull.tap(e.tag,function(l){if(l){var u=l.cullable;return s.length===0?u.visible=i.unculledEntities.indexOf(l.entity)>-1:u.visible=s.every(function(h){return h.isVisible(n,l)}),!l.isCulled()&&l.isVisible()?l:(l.dispatchEvent(new tl(wa.CULLED)),null)}return l}),r.hooks.afterRender.tap(e.tag,function(l){l.cullable.visibilityPlaneMask=-1})},e.tag="Culling",e}(),bl=function(){function e(){var t=this;this.autoPreventDefault=!1,this.rootPointerEvent=new s0(null),this.rootWheelEvent=new eg(null),this.onPointerMove=function(n){var r,i,s,l,u=(l=(s=t.context.renderingContext.root)===null||s===void 0?void 0:s.ownerDocument)===null||l===void 0?void 0:l.defaultView;if(!(u.supportsTouchEvents&&n.pointerType==="touch")){var h=t.normalizeToPointerEvent(n,u);try{for(var p=(0,z.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,b=t.bootstrapEvent(t.rootPointerEvent,y,u,n);t.context.eventService.mapEvent(b)}}catch(w){r={error:w}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}t.setCursor(t.context.eventService.cursor)}},this.onClick=function(n){var r,i,s,l,u=(l=(s=t.context.renderingContext.root)===null||s===void 0?void 0:s.ownerDocument)===null||l===void 0?void 0:l.defaultView,h=t.normalizeToPointerEvent(n,u);try{for(var p=(0,z.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,b=t.bootstrapEvent(t.rootPointerEvent,y,u,n);t.context.eventService.mapEvent(b)}}catch(w){r={error:w}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}t.setCursor(t.context.eventService.cursor)}}return e.prototype.apply=function(t){var n=this;this.context=t;var r=t.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var l=n.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}).picked;return l[0]||null}),r.hooks.pointerWheel.tap(e.tag,function(s){var l=n.normalizeWheelEvent(s);n.context.eventService.mapEvent(l)}),r.hooks.pointerDown.tap(e.tag,function(s){var l,u;if(!(i.supportsTouchEvents&&s.pointerType==="touch")){var h=n.normalizeToPointerEvent(s,i);if(n.autoPreventDefault&&h[0].isNormalized){var p=s.cancelable||!("cancelable"in s);p&&s.preventDefault()}try{for(var m=(0,z.XA)(h),y=m.next();!y.done;y=m.next()){var b=y.value,w=n.bootstrapEvent(n.rootPointerEvent,b,i,s);n.context.eventService.mapEvent(w)}}catch(R){l={error:R}}finally{try{y&&!y.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerUp.tap(e.tag,function(s){var l,u;if(!(i.supportsTouchEvents&&s.pointerType==="touch")){var h=n.context.contextService.getDomElement(),p=n.context.eventService.isNativeEventFromCanvas(h,s),m=p?"":"outside",y=n.normalizeToPointerEvent(s,i);try{for(var b=(0,z.XA)(y),w=b.next();!w.done;w=b.next()){var R=w.value,M=n.bootstrapEvent(n.rootPointerEvent,R,i,s);M.type+=m,n.context.eventService.mapEvent(M)}}catch(I){l={error:I}}finally{try{w&&!w.done&&(u=b.return)&&u.call(b)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerMove.tap(e.tag,this.onPointerMove),r.hooks.pointerOver.tap(e.tag,this.onPointerMove),r.hooks.pointerOut.tap(e.tag,this.onPointerMove),r.hooks.click.tap(e.tag,this.onClick),r.hooks.pointerCancel.tap(e.tag,function(s){var l,u,h=n.normalizeToPointerEvent(s,i);try{for(var p=(0,z.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,b=n.bootstrapEvent(n.rootPointerEvent,y,i,s);n.context.eventService.mapEvent(b)}}catch(w){l={error:w}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)})},e.prototype.bootstrapEvent=function(t,n,r,i){t.view=r,t.originalEvent=null,t.nativeEvent=i,t.pointerId=n.pointerId,t.width=n.width,t.height=n.height,t.isPrimary=n.isPrimary,t.pointerType=n.pointerType,t.pressure=n.pressure,t.tangentialPressure=n.tangentialPressure,t.tiltX=n.tiltX,t.tiltY=n.tiltY,t.twist=n.twist,this.transferMouseData(t,n);var s=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),l=s.x,u=s.y;t.viewport.x=l,t.viewport.y=u;var h=this.context.eventService.viewport2Canvas(t.viewport),p=h.x,m=h.y;return t.canvas.x=p,t.canvas.y=m,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Zo[t.type]||t.type),t},e.prototype.normalizeWheelEvent=function(t){var n=this.rootWheelEvent;this.transferMouseData(n,t),n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ;var r=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),i=r.x,s=r.y;n.viewport.x=i,n.viewport.y=s;var l=this.context.eventService.viewport2Canvas(n.viewport),u=l.x,h=l.y;return n.canvas.x=u,n.canvas.y=h,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=t,n.type=t.type,n},e.prototype.transferMouseData=function(t,n){t.isTrusted=n.isTrusted,t.srcElement=n.srcElement,t.timeStamp=Ta.now(),t.type=n.type,t.altKey=n.altKey,t.metaKey=n.metaKey,t.shiftKey=n.shiftKey,t.ctrlKey=n.ctrlKey,t.button=n.button,t.buttons=n.buttons,t.client.x=n.clientX,t.client.y=n.clientY,t.movement.x=n.movementX,t.movement.y=n.movementY,t.page.x=n.pageX,t.page.y=n.pageY,t.screen.x=n.screenX,t.screen.y=n.screenY,t.relatedTarget=null},e.prototype.setCursor=function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")},e.prototype.normalizeToPointerEvent=function(t,n){var r=[];if(n.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var s=t.changedTouches[i];ti(s.button)&&(s.button=0),ti(s.buttons)&&(s.buttons=1),ti(s.isPrimary)&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),ti(s.width)&&(s.width=s.radiusX||1),ti(s.height)&&(s.height=s.radiusY||1),ti(s.tiltX)&&(s.tiltX=0),ti(s.tiltY)&&(s.tiltY=0),ti(s.pointerType)&&(s.pointerType="touch"),ti(s.pointerId)&&(s.pointerId=s.identifier||0),ti(s.pressure)&&(s.pressure=s.force||.5),ti(s.twist)&&(s.twist=0),ti(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=t.type,r.push(s)}else if(n.isMouseEvent(t)){var l=t;ti(l.isPrimary)&&(l.isPrimary=!0),ti(l.width)&&(l.width=1),ti(l.height)&&(l.height=1),ti(l.tiltX)&&(l.tiltX=0),ti(l.tiltY)&&(l.tiltY=0),ti(l.pointerType)&&(l.pointerType="mouse"),ti(l.pointerId)&&(l.pointerId=Rs),ti(l.pressure)&&(l.pressure=.5),ti(l.twist)&&(l.twist=0),ti(l.tangentialPressure)&&(l.tangentialPressure=0),l.isNormalized=!0,r.push(l)}else r.push(t);return r},e.tag="Event",e}(),Ul=[Gr.CIRCLE,Gr.ELLIPSE,Gr.IMAGE,Gr.RECT,Gr.LINE,Gr.POLYLINE,Gr.POLYGON,Gr.TEXT,Gr.PATH,Gr.HTML],jl=function(){function e(){}return e.prototype.isVisible=function(t,n){var r,i,s=n.cullable;if(!s.enable)return!0;var l=n.getRenderBounds();if(Cn.isEmpty(l))return!1;var u=t.getFrustum(),h=(i=(r=n.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return s.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,l,h||kn.INDETERMINATE,u.planes),s.visible=s.visibilityPlaneMask!==kn.OUTSIDE,s.visible},e.prototype.computeVisibilityWithPlaneMask=function(t,n,r,i){if(r===kn.OUTSIDE||r===kn.INSIDE)return r;for(var s=kn.INSIDE,l=Ul.indexOf(t.nodeName)>-1,u=0,h=i.length;u<h;++u){var p=1<<u;if(r&p&&!(l&&(u===4||u===5))){var m=i[u],y=m.normal,b=m.distance;if(nt.AK(y,n.getPositiveFarPoint(i[u]))+b<0)return kn.OUTSIDE;nt.AK(y,n.getNegativeFarPoint(i[u]))+b<0&&(s|=p)}}return s},e}(),xl=function(){function e(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return e.prototype.apply=function(t){var n=this,r,i=t.renderingService,s=t.renderingContext,l=t.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var h=function(w){var R=w.target;R.renderable.dirty=!0,i.dirtify()},p=function(w){var R=w.detail.affectChildren,M=w.target;R&&M.forEach(function(N){n.toSync.add(N)});for(var I=M;I;)I.renderable&&n.toSync.add(I),I=I.parentElement;i.dirtify()},m=function(w){var R=w.target;g.enableSizeAttenuation&&g.styleValueRegistry.updateSizeAttenuation(R,u.getCamera().getZoom()),g.enableCSSParsing&&g.styleValueRegistry.recalc(R),g.sceneGraphService.dirtifyToRoot(R),i.dirtify()},y=function(w){var R=w.target,M=R.rBushNode;M.aabb&&n.rBush.remove(M.aabb),n.toSync.delete(R),g.sceneGraphService.dirtifyToRoot(R),i.dirtify()};i.hooks.init.tap(e.tag,function(){u.addEventListener(wa.MOUNTED,m),u.addEventListener(wa.UNMOUNTED,y),u.addEventListener(wa.ATTR_MODIFIED,h),u.addEventListener(wa.BOUNDS_CHANGED,p)}),i.hooks.destroy.tap(e.tag,function(){u.removeEventListener(wa.MOUNTED,m),u.removeEventListener(wa.UNMOUNTED,y),u.removeEventListener(wa.ATTR_MODIFIED,h),u.removeEventListener(wa.BOUNDS_CHANGED,p),n.toSync.clear()});var b=(r=g.globalThis.requestIdleCallback)!==null&&r!==void 0?r:Kn.bind(g.globalThis);i.hooks.endFrame.tap(e.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,b(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})},e.prototype.syncRTree=function(t){var n=this;if(t===void 0&&(t=!1),!(!t&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var s=i.rBushNode;s&&s.aabb&&n.rBush.remove(s.aabb);var l=i.getRenderBounds();if(l){var u=i.renderable;t&&(u.dirtyRenderBounds||(u.dirtyRenderBounds=new Cn),u.dirtyRenderBounds.update(l.center,l.halfExtents));var h=(0,z.CR)(l.getMin(),2),p=h[0],m=h[1],y=(0,z.CR)(l.getMax(),2),b=y[0],w=y[1];s.aabb||(s.aabb={}),s.aabb.displayObject=i,s.aabb.minX=p,s.aabb.minY=m,s.aabb.maxX=b,s.aabb.maxY=w}s.aabb&&!isNaN(s.aabb.maxX)&&!isNaN(s.aabb.maxX)&&!isNaN(s.aabb.minX)&&!isNaN(s.aabb.minY)&&r.push(s.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},e.tag="Prepare",e}();function nc(e){return!!e.document}var Hs;(function(e){e.READY="ready",e.BEFORE_RENDER="beforerender",e.RERENDER="rerender",e.AFTER_RENDER="afterrender",e.BEFORE_DESTROY="beforedestroy",e.AFTER_DESTROY="afterdestroy",e.RESIZE="resize",e.DIRTY_RECTANGLE="dirtyrectangle",e.RENDERER_CHANGED="rendererchanged"})(Hs||(Hs={}));var wc=500,Xu=.1,zc=1e3,uu=new tl(wa.MOUNTED),Vl=new tl(wa.UNMOUNTED),Uc=new tl(Hs.BEFORE_RENDER),es=new tl(Hs.RERENDER),Ys=new tl(Hs.AFTER_RENDER),zs=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this)||this;r.Element=Sr,r.inited=!1,r.context={},r.document=new Wo,r.document.defaultView=r,r.customElements=new Ma;var i=n.container,s=n.canvas,l=n.offscreenCanvas,u=n.width,h=n.height,p=n.devicePixelRatio,m=n.renderer,y=n.background,b=n.cursor,w=n.document,R=n.requestAnimationFrame,M=n.cancelAnimationFrame,I=n.createImage,N=n.supportsPointerEvents,U=n.supportsTouchEvents,Z=n.supportsCSSTransform,Y=n.supportsMutipleCanvasesInOneContainer,$=n.useNativeClickEvent,J=n.alwaysTriggerPointerEventOnCanvas,se=n.isTouchEvent,pe=n.isMouseEvent,Ce=n.dblClickSpeed;Y||Ga(i,r);var Ue=u,Je=h,lt=p;return s&&(lt=p||dl&&window.devicePixelRatio||1,lt=lt>=1?Math.ceil(lt):1,Ue=u||Ra(s)||s.width/lt,Je=h||Kc(s)||s.height/lt),l&&(g.offscreenCanvas=l),r.devicePixelRatio=lt,r.requestAnimationFrame=R!=null?R:Kn.bind(g.globalThis),r.cancelAnimationFrame=M!=null?M:ir.bind(g.globalThis),r.supportsTouchEvents=U!=null?U:"ontouchstart"in g.globalThis,r.supportsPointerEvents=N!=null?N:!!g.globalThis.PointerEvent,r.isTouchEvent=se!=null?se:function(Ge){return r.supportsTouchEvents&&Ge instanceof g.globalThis.TouchEvent},r.isMouseEvent=pe!=null?pe:function(Ge){return!g.globalThis.MouseEvent||Ge instanceof g.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(Ge instanceof g.globalThis.PointerEvent))},r.dblClickSpeed=Ce!=null?Ce:200,r.initRenderingContext({container:i,canvas:s,width:Ue,height:Je,renderer:m,offscreenCanvas:l,devicePixelRatio:lt,cursor:b||"default",background:y||"transparent",createImage:I,document:w,supportsCSSTransform:Z,useNativeClickEvent:$,alwaysTriggerPointerEventOnCanvas:J}),r.initDefaultCamera(Ue,Je,m.clipSpaceNearZ),r.initRenderer(m,!0),r}return t.prototype.initRenderingContext=function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},t.prototype.initDefaultCamera=function(n,r,i){var s=this,l=new g.CameraContribution;l.clipSpaceNearZ=i,l.setType(Yr.EXPLORING,wi.DEFAULT).setPosition(n/2,r/2,wc).setFocalPoint(n/2,r/2,0).setOrthographic(n/-2,n/2,r/2,r/-2,Xu,zc),l.canvas=this,l.eventEmitter.on(Lo.UPDATED,function(){s.context.renderingContext.renderReasons.add(Oh.CAMERA_CHANGED),g.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=l},t.prototype.updateSizeAttenuation=function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){g.styleValueRegistry.updateSizeAttenuation(r,n)})},t.prototype.getConfig=function(){return this.context.config},t.prototype.getRoot=function(){return this.document.documentElement},t.prototype.getCamera=function(){return this.context.camera},t.prototype.getContextService=function(){return this.context.contextService},t.prototype.getEventService=function(){return this.context.eventService},t.prototype.getRenderingService=function(){return this.context.renderingService},t.prototype.getRenderingContext=function(){return this.context.renderingContext},t.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(t.prototype,"ready",{get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){n.resolveReadyPromise=function(){r(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),t.prototype.destroy=function(n,r){if(n===void 0&&(n=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new tl(Hs.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var s=this.getRoot();this.unmountChildren(s),n&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),n&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new tl(Hs.AFTER_DESTROY))},t.prototype.changeSize=function(n,r){this.resize(n,r)},t.prototype.resize=function(n,r){var i=this.context.config;i.width=n,i.height=r,this.getContextService().resize(n,r);var s=this.context.camera,l=s.getProjectionMode();s.setPosition(n/2,r/2,wc).setFocalPoint(n/2,r/2,0),l===Hi.ORTHOGRAPHIC?s.setOrthographic(n/-2,n/2,r/2,r/-2,s.getNear(),s.getFar()):s.setAspect(n/r),this.dispatchEvent(new tl(Hs.RESIZE,{width:n,height:r}))},t.prototype.appendChild=function(n,r){return this.document.documentElement.appendChild(n,r)},t.prototype.insertBefore=function(n,r){return this.document.documentElement.insertBefore(n,r)},t.prototype.removeChild=function(n){return this.document.documentElement.removeChild(n)},t.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},t.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},t.prototype.render=function(n){var r=this;n&&(Uc.detail=n,Ys.detail=n),this.dispatchEvent(Uc);var i=this.getRenderingService();i.render(this.getConfig(),n,function(){r.dispatchEvent(es)}),this.dispatchEvent(Ys)},t.prototype.run=function(){var n=this,r=function(i,s){n.render(s),n.frameId=n.requestAnimationFrame(r)};r()},t.prototype.initRenderer=function(n,r){var i=this;if(r===void 0&&(r=!1),!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new Ud,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new bl,new xl,new Cs([new jl])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService((0,z.pi)((0,z.pi)({},g),this.context)),this.context.renderingService=new sb(g,this.context),this.context.eventService=new ab(g,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,r)})},t.prototype.initRenderingService=function(n,r,i){var s=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){s.inited=!0,r?i?s.requestAnimationFrame(function(){s.dispatchEvent(new tl(Hs.READY))}):s.dispatchEvent(new tl(Hs.READY)):s.dispatchEvent(new tl(Hs.RENDERER_CHANGED)),s.readyPromise&&s.resolveReadyPromise(),r||s.getRoot().forEach(function(l){var u=l.renderable;u&&(u.renderBoundsDirty=!0,u.boundsDirty=!0,u.dirty=!0)}),s.mountChildren(s.getRoot()),n.getConfig().enableAutoRendering&&s.run()})},t.prototype.loadRendererContainerModule=function(n){var r=this,i=n.getPlugins();i.forEach(function(s){s.context=r.context,s.init(g)})},t.prototype.setRenderer=function(n){var r=this.getConfig();if(r.renderer!==n){var i=r.renderer;r.renderer=n,this.destroy(!1,!0),(0,z.ev)([],(0,z.CR)(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(s){s.destroy(g)}),this.initRenderer(n)}},t.prototype.setCursor=function(n){var r=this.getConfig();r.cursor=n,this.getContextService().applyCursorStyle(n)},t.prototype.unmountChildren=function(n){var r=this;n.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(n.isMutationObserved?n.dispatchEvent(Vl):(Vl.target=n,this.dispatchEvent(Vl,!0)),n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1),n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()},t.prototype.mountChildren=function(n){var r=this;this.inited?n.isConnected||(n.ownerDocument=this.document,n.isConnected=!0,n.isMutationObserved?n.dispatchEvent(uu):(uu.target=n,this.dispatchEvent(uu,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName),n.childNodes.forEach(function(i){r.mountChildren(i)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()},t.prototype.client2Viewport=function(n){return this.getEventService().client2Viewport(n)},t.prototype.viewport2Client=function(n){return this.getEventService().viewport2Client(n)},t.prototype.viewport2Canvas=function(n){return this.getEventService().viewport2Canvas(n)},t.prototype.canvas2Viewport=function(n){return this.getEventService().canvas2Viewport(n)},t.prototype.getPointByClient=function(n,r){return this.client2Viewport({x:n,y:r})},t.prototype.getClientByPoint=function(n,r){return this.viewport2Client({x:n,y:r})},t}(Tc),gs=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.landmarks=[],n}return t.prototype.rotate=function(n,r,i){if(this.relElevation=Eh(r),this.relAzimuth=Eh(n),this.relRoll=Eh(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Yr.EXPLORING){var s=fi(qr(),[1,0,0],ts((this.rotateWorld?1:-1)*this.relElevation)),l=fi(qr(),[0,1,0],ts((this.rotateWorld?1:-1)*this.relAzimuth)),u=fi(qr(),[0,0,1],ts(this.relRoll)),h=vo(qr(),l,s);h=vo(qr(),h,u);var p=St.fromQuat(St.create(),h);St.translate(this.matrix,this.matrix,[0,0,-this.distance]),St.multiply(this.matrix,this.matrix,p),St.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getPosition():this.type===Yr.TRACKING&&this._getFocalPoint(),this._update(),this},t.prototype.pan=function(n,r){var i=Al(n,r,0),s=nt.d9(this.position);return nt.IH(s,s,nt.bA(nt.Ue(),this.right,i[0])),nt.IH(s,s,nt.bA(nt.Ue(),this.up,i[1])),this._setPosition(s),this.triggerUpdate(),this},t.prototype.dolly=function(n){var r=this.forward,i=nt.d9(this.position),s=n*this.dollyingStep,l=this.distance+n*this.dollyingStep;return s=Math.max(Math.min(l,this.maxDistance),this.minDistance)-this.distance,i[0]+=s*r[0],i[1]+=s*r[1],i[2]+=s*r[2],this._setPosition(i),this.type===Yr.ORBITING||this.type===Yr.EXPLORING?this._getDistance():this.type===Yr.TRACKING&&nt.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},t.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},t.prototype.createLandmark=function(n,r){var i,s,l,u;r===void 0&&(r={});var h=r.position,p=h===void 0?this.position:h,m=r.focalPoint,y=m===void 0?this.focalPoint:m,b=r.roll,w=r.zoom,R=new g.CameraContribution;R.setType(this.type,void 0),R.setPosition(p[0],(i=p[1])!==null&&i!==void 0?i:this.position[1],(s=p[2])!==null&&s!==void 0?s:this.position[2]),R.setFocalPoint(y[0],(l=y[1])!==null&&l!==void 0?l:this.focalPoint[1],(u=y[2])!==null&&u!==void 0?u:this.focalPoint[2]),R.setRoll(b!=null?b:this.roll),R.setZoom(w!=null?w:this.zoom);var M={name:n,matrix:St.clone(R.getWorldTransform()),right:nt.d9(R.right),up:nt.d9(R.up),forward:nt.d9(R.forward),position:nt.d9(R.getPosition()),focalPoint:nt.d9(R.getFocalPoint()),distanceVector:nt.d9(R.getDistanceVector()),distance:R.getDistance(),dollyingStep:R.getDollyingStep(),azimuth:R.getAzimuth(),elevation:R.getElevation(),roll:R.getRoll(),relAzimuth:R.relAzimuth,relElevation:R.relElevation,relRoll:R.relRoll,zoom:R.getZoom()};return this.landmarks.push(M),M},t.prototype.gotoLandmark=function(n,r){var i=this;r===void 0&&(r={});var s=bi(n)?this.landmarks.find(function(Ue){return Ue.name===n}):n;if(s){var l=(0,Ft.Z)(r)?{duration:r}:r,u=l.easing,h=u===void 0?"linear":u,p=l.duration,m=p===void 0?100:p,y=l.easingFunction,b=y===void 0?void 0:y,w=l.onfinish,R=w===void 0?void 0:w,M=l.onframe,I=M===void 0?void 0:M,N=.01;this.cancelLandmarkAnimation();var U=s.position,Z=s.focalPoint,Y=s.zoom,$=s.roll,J=b||g.EasingFunction(h),se,pe=function(){i.setFocalPoint(Z),i.setPosition(U),i.setRoll($),i.setZoom(Y),i.computeMatrix(),i.triggerUpdate(),R==null||R()};if(m===0)return pe();var Ce=function(Ue){se===void 0&&(se=Ue);var Je=Ue-se;if(Je>=m){pe();return}var lt=J(Je/m),Ge=nt.Ue(),at=nt.Ue(),st=1,ft=0;nt.t7(Ge,i.focalPoint,Z,lt),nt.t7(at,i.position,U,lt),ft=i.roll*(1-lt)+$*lt,st=i.zoom*(1-lt)+Y*lt,i.setFocalPoint(Ge),i.setPosition(at),i.setRoll(ft),i.setZoom(st);var Vt=nt.TK(Ge,Z)+nt.TK(at,U);if(Vt<=N&&Y==null&&$==null)return pe();i.computeMatrix(),i.triggerUpdate(),Je<m&&(I==null||I(lt),i.landmarkAnimationID=i.canvas.requestAnimationFrame(Ce))};this.canvas.requestAnimationFrame(Ce)}},t}(ko);g.CameraContribution=gs;var Yu=function(){function e(t,n){this.type=t,this.target=n,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return e.copy=function(t){var n=new e(t.type,t.target);return n.addedNodes=t.addedNodes.slice(),n.removedNodes=t.removedNodes.slice(),n.previousSibling=t.previousSibling,n.nextSibling=t.nextSibling,n.attributeName=t.attributeName,n.attributeNamespace=t.attributeNamespace,n.oldValue=t.oldValue,n},e}(),fu=0,Us=new WeakMap,rc=function(){function e(t,n,r){this.observer=t,this.target=n,this.options=r,this.transientObservedNodes=[]}return e.prototype.enqueue=function(t){var n=this.observer.records,r=n.length;if(n.length>0){var i=n[r-1],s=Tf(i,t);if(s){n[r-1]=s;return}}else u0(this.observer);n[r]=t},e.prototype.addListeners=function(){this.addListeners_(this.target)},e.prototype.addListeners_=function(t){var n=this.options;n.attributes&&t.addEventListener(wa.ATTR_MODIFIED,this,!0),n.childList&&t.addEventListener(wa.INSERTED,this,!0),(n.childList||n.subtree)&&t.addEventListener(wa.REMOVED,this,!0)},e.prototype.removeListeners=function(){this.removeListeners_(this.target)},e.prototype.removeListeners_=function(t){var n=this.options;n.attributes&&t.removeEventListener(wa.ATTR_MODIFIED,this,!0),n.childList&&t.removeEventListener(wa.INSERTED,this,!0),(n.childList||n.subtree)&&t.removeEventListener(wa.REMOVED,this,!0)},e.prototype.removeTransientObservers=function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(n){this.removeListeners_(n);for(var r=Us.get(n),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},e.prototype.handleEvent=function(t){t.stopImmediatePropagation();var n,r;switch(t.type){case wa.ATTR_MODIFIED:var i=t.attrName,s=t.relatedNode.namespaceURI;r=t.target,n=Uf("attributes",r),n.attributeName=i,n.attributeNamespace=s;var l=t.attrChange===Gu.ADDITION?null:t.prevValue;ed(r,function(b){if(b.attributes&&!(b.attributeFilter&&b.attributeFilter.length&&b.attributeFilter.indexOf(i)===-1&&b.attributeFilter.indexOf(s)===-1))return b.attributeOldValue?Jd(l):n});break;case wa.REMOVED:case wa.INSERTED:r=t.relatedNode;var u=t.target,h=void 0,p=void 0;t.type===wa.INSERTED?(h=[u],p=[]):(h=[],p=[u]);var m=u.previousSibling,y=u.nextSibling;n=Uf("childList",r),n.addedNodes=h,n.removedNodes=p,n.previousSibling=m,n.nextSibling=y,ed(r,function(b){if(b.childList)return n})}ic()},e}(),Ac=function(){function e(t){this.callback=t,this.nodes=[],this.records=[],this.uid=fu++}return e.prototype.observe=function(t,n){if(!n.childList&&!n.attributes&&!n.characterData||n.attributeOldValue&&!n.attributes||n.attributeFilter&&n.attributeFilter.length&&!n.attributes||n.characterDataOldValue&&!n.characterData)throw new SyntaxError;var r=Us.get(t);r||Us.set(t,r=[]);for(var i,s=0;s<r.length;s++)if(r[s].observer===this){i=r[s],i.removeListeners(),i.options=n;break}i||(i=new rc(this,t,n),r.push(i),this.nodes.push(t)),i.addListeners()},e.prototype.disconnect=function(){var t=this;this.nodes.forEach(function(n){for(var r=Us.get(n),i=0;i<r.length;i++){var s=r[i];if(s.observer===t){s.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},e.prototype.takeRecords=function(){var t=this.records;return this.records=[],t},e}(),ss,$u;function Uf(e,t){return ss=new Yu(e,t)}function Jd(e){return $u||($u=Yu.copy(ss),$u.oldValue=e,$u)}function ic(){ss=$u=void 0}function uh(e){return e===$u||e===ss}function Tf(e,t){return e===t?e:$u&&uh(e)?$u:null}function ep(e){e.nodes.forEach(function(t){var n=Us.get(t);n&&n.forEach(function(r){r.observer===e&&r.removeTransientObservers()})})}function ed(e,t){for(var n=e;n;n=n.parentNode){var r=Us.get(n);if(r)for(var i=0;i<r.length;i++){var s=r[i],l=s.options;if(!(n!==e&&!l.subtree)){var u=t(l);u&&s.enqueue(u)}}}}var c0=!1,td=[];function u0(e){td.push(e),c0||(c0=!0,typeof g.globalThis!="undefined"?g.globalThis.setTimeout(vm):vm())}function vm(){c0=!1;var e=td;td=[],e.sort(function(n,r){return n.uid-r.uid});var t=!1;e.forEach(function(n){var r=n.takeRecords();ep(n),r.length&&(n.callback(r,n),t=!0)}),t&&vm()}var f0=function(e){(0,z.ZT)(t,e);function t(n,r,i,s){var l=e.call(this,n)||this;return l.currentTime=i,l.timelineTime=s,l.target=r,l.type="finish",l.bubbles=!1,l.currentTarget=r,l.defaultPrevented=!1,l.eventPhase=l.AT_TARGET,l.timeStamp=Date.now(),l.currentTime=i,l.timelineTime=s,l}return t}(Qv),gm=0,ng=function(){function e(t,n){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=n,this.id="".concat(gm++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(e.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,r){t.resolveReadyPromise=function(){n(t)},t.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finished",{get:function(){var t=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,r){t.resolveFinishedPromise=function(){n(t)},t.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var n;t=Number(t),!isNaN(t)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},set:function(t){if(t!==null){if(this.updatePromises(),t=Number(t),isNaN(t)||this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=t,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),e.prototype.updatePromises=function(){var t=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==t&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):t==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():t==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise},e.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},e.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},e.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},e.prototype.cancel=function(){var t=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new f0(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(n)})}},e.prototype.reverse=function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),t!==null&&(this.currentTime=t),this.updatePromises()},e.prototype.updatePlaybackRate=function(t){this.playbackRate=t},e.prototype.targetAnimations=function(){var t,n=(t=this.effect)===null||t===void 0?void 0:t.target;return n.getAnimations()},e.prototype.markTarget=function(){var t=this.targetAnimations();t.indexOf(this)===-1&&t.push(this)},e.prototype.unmarkTarget=function(){var t=this.targetAnimations(),n=t.indexOf(this);n!==-1&&t.splice(n,1)},e.prototype.tick=function(t,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(t))},e.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},e.prototype.persist=function(){throw new Error(dr)},e.prototype.addEventListener=function(t,n,r){throw new Error(dr)},e.prototype.removeEventListener=function(t,n,r){throw new Error(dr)},e.prototype.dispatchEvent=function(t){throw new Error(dr)},e.prototype.commitStyles=function(){throw new Error(dr)},e.prototype.ensureAlive=function(){var t,n;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(-1)):this._inEffect=!!(!((n=this.effect)===null||n===void 0)&&n.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},e.prototype.tickCurrentTime=function(t,n){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},e.prototype.fireEvents=function(t){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new f0(null,this,this.currentTime,t);setTimeout(function(){n.onfinish&&n.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new f0(null,this,this.currentTime,t);this.onframe(i)}this._finishedFlag=!1}},e}(),uy=4,nd=.001,Dp=1e-7,j0=10,rd=11,Np=1/(rd-1),lv=typeof Float32Array=="function",rg=function(e,t){return 1-3*t+3*e},ym=function(e,t){return 3*t-6*e},Bp=function(e){return 3*e},h0=function(e,t,n){return((rg(t,n)*e+ym(t,n))*e+Bp(t))*e},_m=function(e,t,n){return 3*rg(t,n)*e*e+2*ym(t,n)*e+Bp(t)},cv=function(e,t,n,r,i){var s,l,u=0;do l=t+(n-t)/2,s=h0(l,r,i)-e,s>0?n=l:t=l;while(Math.abs(s)>Dp&&++u<j0);return l},bm=function(e,t,n,r){for(var i=0;i<uy;++i){var s=_m(t,n,r);if(s===0)return t;var l=h0(t,n,r)-e;t-=l/s}return t},uv=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return function(u){return u};for(var i=lv?new Float32Array(rd):new Array(rd),s=0;s<rd;++s)i[s]=h0(s*Np,e,n);var l=function(u){for(var h=0,p=1,m=rd-1;p!==m&&i[p]<=u;++p)h+=Np;--p;var y=(u-i[p])/(i[p+1]-i[p]),b=h+y*Np,w=_m(b,e,n);return w>=nd?bm(u,b,e,n):w===0?b:cv(u,h,h+Np,e,n)};return function(u){return u===0||u===1?u:h0(l(u),t,r)}},V0=function(e){return e=e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())}),e.charAt(0)==="-"?e.substring(1):e},Fp=function(e){return Math.pow(e,2)},kp=function(e){return Math.pow(e,3)},d0=function(e){return Math.pow(e,4)},tp=function(e){return Math.pow(e,5)},p0=function(e){return Math.pow(e,6)},zp=function(e){return 1-Math.cos(e*Math.PI/2)},xm=function(e){return 1-Math.sqrt(1-e*e)},fv=function(e){return e*e*(3*e-2)},Em=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)},hv=function(e,t){t===void 0&&(t=[]);var n=(0,z.CR)(t,2),r=n[0],i=r===void 0?1:r,s=n[1],l=s===void 0?.5:s,u=(0,so.Z)(Number(i),1,10),h=(0,so.Z)(Number(l),.1,2);return e===0||e===1?e:-u*Math.pow(2,10*(e-1))*Math.sin((e-1-h/(Math.PI*2)*Math.asin(1/u))*(Math.PI*2)/h)},H0=function(e,t,n){t===void 0&&(t=[]);var r=(0,z.CR)(t,4),i=r[0],s=i===void 0?1:i,l=r[1],u=l===void 0?100:l,h=r[2],p=h===void 0?10:h,m=r[3],y=m===void 0?0:m;s=(0,so.Z)(s,.1,1e3),u=(0,so.Z)(u,.1,1e3),p=(0,so.Z)(p,.1,1e3),y=(0,so.Z)(y,.1,1e3);var b=Math.sqrt(u/s),w=p/(2*Math.sqrt(u*s)),R=w<1?b*Math.sqrt(1-w*w):0,M=1,I=w<1?(w*b+-y)/R:-y+b,N=n?n*e/1e3:e;return w<1?N=Math.exp(-N*w*b)*(M*Math.cos(R*N)+I*Math.sin(R*N)):N=(M+I*N)*Math.exp(-N*b),e===0||e===1?e:1-N},ig=function(e,t){t===void 0&&(t=[]);var n=(0,z.CR)(t,2),r=n[0],i=r===void 0?10:r,s=n[1],l=s=="start"?Math.ceil:Math.floor;return l((0,so.Z)(e,0,1)*i)/i},Sm=function(e,t){t===void 0&&(t=[]);var n=(0,z.CR)(t,4),r=n[0],i=n[1],s=n[2],l=n[3];return uv(r,i,s,l)(e)},Ol=uv(.42,0,1,1),jc=function(e){return function(t,n,r){return n===void 0&&(n=[]),1-e(1-t,n,r)}},id=function(e){return function(t,n,r){return n===void 0&&(n=[]),t<.5?e(t*2,n,r)/2:1-e(t*-2+2,n,r)/2}},Eu=function(e){return function(t,n,r){return n===void 0&&(n=[]),t<.5?(1-e(1-t*2,n,r))/2:(e(t*2-1,n,r)+1)/2}},dv={steps:ig,"step-start":function(e){return ig(e,[1,"start"])},"step-end":function(e){return ig(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":Sm,ease:function(e){return Sm(e,[.25,.1,.25,1])},in:Ol,out:jc(Ol),"in-out":id(Ol),"out-in":Eu(Ol),"in-quad":Fp,"out-quad":jc(Fp),"in-out-quad":id(Fp),"out-in-quad":Eu(Fp),"in-cubic":kp,"out-cubic":jc(kp),"in-out-cubic":id(kp),"out-in-cubic":Eu(kp),"in-quart":d0,"out-quart":jc(d0),"in-out-quart":id(d0),"out-in-quart":Eu(d0),"in-quint":tp,"out-quint":jc(tp),"in-out-quint":id(tp),"out-in-quint":Eu(tp),"in-expo":p0,"out-expo":jc(p0),"in-out-expo":id(p0),"out-in-expo":Eu(p0),"in-sine":zp,"out-sine":jc(zp),"in-out-sine":id(zp),"out-in-sine":Eu(zp),"in-circ":xm,"out-circ":jc(xm),"in-out-circ":id(xm),"out-in-circ":Eu(xm),"in-back":fv,"out-back":jc(fv),"in-out-back":id(fv),"out-in-back":Eu(fv),"in-bounce":Em,"out-bounce":jc(Em),"in-out-bounce":id(Em),"out-in-bounce":Eu(Em),"in-elastic":hv,"out-elastic":jc(hv),"in-out-elastic":id(hv),"out-in-elastic":Eu(hv),spring:H0,"spring-in":H0,"spring-out":jc(H0),"spring-in-out":id(H0),"spring-out-in":Eu(H0)},fy=function(e){return V0(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},og=function(e){return dv[fy(e)]||dv.linear},ff=function(e){return e},ag=1,pv=.5,np=0;function mv(e,t){return function(n){if(n>=1)return 1;var r=1/e;return n+=t*r,n-n%r}}var Tm="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",I1=new RegExp("cubic-bezier\\("+Tm+","+Tm+","+Tm+","+Tm+"\\)"),vv=/steps\(\s*(\d+)\s*\)/,L1=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function sg(e){var t=I1.exec(e);if(t)return uv.apply(void 0,(0,z.ev)([],(0,z.CR)(t.slice(1).map(Number)),!1));var n=vv.exec(e);if(n)return mv(Number(n[1]),np);var r=L1.exec(e);return r?mv(Number(r[1]),{start:ag,middle:pv,end:np}[r[2]]):og(e)}function D1(e){return Math.abs(N1(e)/(e.playbackRate||1))}function N1(e){var t;return e.duration===0||e.iterations===0?0:(e.duration==="auto"?0:Number(e.duration))*((t=e.iterations)!==null&&t!==void 0?t:1)}var lg=0,wf=1,Z0=2,hy=3;function rp(e,t,n){if(t===null)return lg;var r=n.endTime;return t<Math.min(n.delay,r)?wf:t>=Math.min(n.delay+e+n.endDelay,r)?Z0:hy}function dy(e,t,n,r,i){switch(r){case wf:return t==="backwards"||t==="both"?0:null;case hy:return n-i;case Z0:return t==="forwards"||t==="both"?e:null;case lg:return null}}function py(e,t,n,r,i){var s=i;return e===0?t!==wf&&(s+=n):s+=r/e,s}function m0(e,t,n,r,i,s){var l=e===1/0?t%1:e%1;return l===0&&n===Z0&&r!==0&&(i!==0||s===0)&&(l=1),l}function Vc(e,t,n,r){return e===Z0&&t===1/0?1/0:n===1?Math.floor(r)-1:Math.floor(r)}function wm(e,t,n){var r=e;if(e!=="normal"&&e!=="reverse"){var i=t;e==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?n:1-n}function Am(e,t,n){var r=rp(e,t,n),i=dy(e,n.fill,t,r,n.delay);if(i===null)return null;var s=n.duration==="auto"?0:n.duration,l=py(s,r,n.iterations,i,n.iterationStart),u=m0(l,n.iterationStart,r,n.iterations,i,s),h=Vc(r,n.iterations,u,l),p=wm(n.direction,h,u);return n.currentIteration=h,n.progress=p,n.easingFunction(p)}function W0(e,t,n){var r=B1(e,t),i=vy(r,n);return function(s,l){if(l!==null)i.filter(function(h){return l>=h.applyFrom&&l<h.applyTo}).forEach(function(h){var p=l-h.startOffset,m=h.endOffset-h.startOffset,y=m===0?0:p/m;s.setAttribute(h.property,h.interpolation(y),!1,!1)});else for(var u in r)v0(u)&&s.setAttribute(u,null)}}function v0(e){return e!=="offset"&&e!=="easing"&&e!=="composite"&&e!=="computedOffset"}function B1(e,t){for(var n={},r=0;r<e.length;r++)for(var i in e[r])if(v0(i)){var s={offset:e[r].offset,computedOffset:e[r].computedOffset,easing:e[r].easing,easingFunction:sg(e[r].easing)||t.easingFunction,value:e[r][i]};n[i]=n[i]||[],n[i].push(s)}return n}function vy(e,t){var n=[];for(var r in e)for(var i=e[r],s=0;s<i.length-1;s++){var l=s,u=s+1,h=i[l].computedOffset,p=i[u].computedOffset,m=h,y=p;s===0&&(m=-1/0,p===0&&(u=l)),s===i.length-2&&(y=1/0,h===1&&(l=u)),n.push({applyFrom:m,applyTo:y,startOffset:i[l].computedOffset,endOffset:i[u].computedOffset,easingFunction:i[l].easingFunction,property:r,interpolation:Cm(r,i[l].value,i[u].value,t)})}return n.sort(function(b,w){return b.startOffset-w.startOffset}),n}var gy=function(e,t,n){return function(r){var i=cg(e,t,r);return!g.enableCSSParsing&&(0,Ft.Z)(i)?i:n(i)}};function Cm(e,t,n,r){var i=Lr[e];if(i&&i.syntax&&i.int){var s=g.styleValueRegistry.getPropertySyntax(i.syntax);if(s){var l=void 0,u=void 0;if(g.enableCSSParsing){var h=g.styleValueRegistry.parseProperty(e,t,r,!1),p=g.styleValueRegistry.parseProperty(e,n,r,!1);l=g.styleValueRegistry.computeProperty(e,h,r,!1),u=g.styleValueRegistry.computeProperty(e,p,r,!1)}else{var m=s.parserWithCSSDisabled;l=m?m(t,r):t,u=m?m(n,r):n}var y=s.mixer(l,u,r);if(y){var b=gy.apply(void 0,(0,z.ev)([],(0,z.CR)(y),!1));return function(w){return w===0?t:w===1?n:b(w)}}}}return gy(!1,!0,function(w){return w?n:t})}function cg(e,t,n){if(typeof e=="number"&&typeof t=="number")return e*(1-n)+t*n;if(typeof e=="boolean"&&typeof t=="boolean"||typeof e=="string"&&typeof t=="string")return n<.5?e:t;if(Array.isArray(e)&&Array.isArray(t)){for(var r=e.length,i=t.length,s=Math.max(r,i),l=[],u=0;u<s;u++)l.push(cg(e[u<r?u:r-1],t[u<i?u:i-1],n));return l}throw new Error("Mismatched interpolation arguments "+e+":"+t)}var Mh=function(){function e(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=ff,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(e.prototype,"easing",{get:function(){return this._easing},set:function(t){this.easingFunction=sg(t),this._easing=t},enumerable:!1,configurable:!0}),e}();function yy(e){var t=[];for(var n in e)if(!(n in["easing","offset","composite"])){var r=e[n];Array.isArray(r)||(r=[r]);for(var i=r.length,s=0;s<i;s++){if(!t[s]){var l={};"offset"in e&&(l.offset=Number(e.offset)),"easing"in e&&(l.easing=e.easing),"composite"in e&&(l.composite=e.composite),t[s]=l}r[s]!==void 0&&r[s]!==null&&(t[s][n]=r[s])}}return t.sort(function(u,h){return(u.computedOffset||0)-(h.computedOffset||0)}),t}function gv(e,t){if(e===null)return[];Array.isArray(e)||(e=yy(e));for(var n=e.map(function(h){var p={};t!=null&&t.composite&&(p.composite="auto");for(var m in h){var y=h[m];if(m==="offset"){if(y!==null){if(y=Number(y),!isFinite(y))throw new Error("Keyframe offsets must be numbers.");if(y<0||y>1)throw new Error("Keyframe offsets must be between 0 and 1.");p.computedOffset=y}}else if(m==="composite"&&["replace","add","accumulate","auto"].indexOf(y)===-1)throw new Error("".concat(y," compositing is not supported"));p[m]=y}return p.offset===void 0&&(p.offset=null),p.easing===void 0&&(p.easing=(t==null?void 0:t.easing)||"linear"),p.composite===void 0&&(p.composite="auto"),p}),r=!0,i=-1/0,s=0;s<n.length;s++){var l=n[s].offset;if((0,sr.Z)(l))r=!1;else{if(l<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=l}}n=n.filter(function(h){return Number(h.offset)>=0&&Number(h.offset)<=1});function u(){var h,p,m=n.length;n[m-1].computedOffset=Number((h=n[m-1].offset)!==null&&h!==void 0?h:1),m>1&&(n[0].computedOffset=Number((p=n[0].offset)!==null&&p!==void 0?p:0));for(var y=0,b=Number(n[0].computedOffset),w=1;w<m;w++){var R=n[w].computedOffset;if(!(0,sr.Z)(R)&&!(0,sr.Z)(b)){for(var M=1;M<w-y;M++)n[y+M].computedOffset=b+(Number(R)-b)*M/(w-y);y=w,b=Number(R)}}}return r||u(),n}var ug="backwards|forwards|both|none".split("|"),Rl="reverse|alternate|alternate-reverse".split("|");function _y(e,t){var n=new Mh;return t&&(n.fill="both",n.duration="auto"),typeof e=="number"&&!isNaN(e)?n.duration=e:e!==void 0&&Object.keys(e).forEach(function(r){if(e[r]!==void 0&&e[r]!==null&&e[r]!=="auto"){if((typeof n[r]=="number"||r==="duration")&&(typeof e[r]!="number"||isNaN(e[r]))||r==="fill"&&ug.indexOf(e[r])===-1||r==="direction"&&Rl.indexOf(e[r])===-1)return;n[r]=e[r]}}),n}function by(e,t){return e=cb(e!=null?e:{duration:"auto"}),_y(e,t)}function cb(e){return typeof e=="number"&&(isNaN(e)?e={duration:"auto"}:e={duration:e}),e}var F1=function(){function e(t,n,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=by(r,!1),this.timing.effect=this,this.timing.activeDuration=D1(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=gv(n,this.timing),this.interpolations=W0(this.normalizedKeyframes,this.timing,this.target);var s=g.globalThis.Proxy;this.computedTiming=s?new s(this.timing,{get:function(l,u){return u==="duration"?l.duration==="auto"?0:l.duration:u==="fill"?l.fill==="auto"?"none":l.fill:u==="localTime"?i.animation&&i.animation.currentTime||null:u==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:l.currentIteration||0:u==="progress"?!i.animation||i.animation.playState!=="running"?null:l.progress||0:l[u]},set:function(){return!0}}):this.timing}return e.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},e.prototype.update=function(t){return t===null?!1:(this.timeFraction=Am(this.timing.activeDuration,t,this.timing),this.timeFraction!==null)},e.prototype.getKeyframes=function(){return this.normalizedKeyframes},e.prototype.setKeyframes=function(t){this.normalizedKeyframes=gv(t)},e.prototype.getComputedTiming=function(){return this.computedTiming},e.prototype.getTiming=function(){return this.timing},e.prototype.updateTiming=function(t){var n=this;Object.keys(t||{}).forEach(function(r){n.timing[r]=t[r]})},e}();function fg(e,t){return Number(e.id)-Number(t.id)}var Om=function(){function e(t){var n=this;this.document=t,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){n.currentTime=r,n.discardAnimations(),n.animations.length===0?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=n.rafCallbacks;n.rafCallbacks=[],r<Number(n.currentTime)&&(r=Number(n.currentTime)),n.animations.sort(fg),n.animations=n.tick(r,!0,n.animations)[0],i.forEach(function(s){s[1](r)}),n.applyPendingEffects()}}return e.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},e.prototype.isTicking=function(){return this.inTick},e.prototype.play=function(t,n,r){var i=new F1(t,n,r),s=new ng(i,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s},e.prototype.applyDirtiedAnimation=function(t){var n=this;if(!this.inTick){t.markTarget();var r=t.targetAnimations();r.sort(fg);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(s){var l=n.animations.indexOf(s);l!==-1&&n.animations.splice(l,1)}),this.applyPendingEffects()}},e.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},e.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},e.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(t){t==null||t.applyInterpolations()}),this.pendingEffects=[]},e.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})},e.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return t.playState!=="finished"&&t.playState!=="idle"})},e.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},e.prototype.rAF=function(t){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,t]),n},e.prototype.requestAnimationFrame=function(t){var n=this;return this.rAF(function(r){n.updateAnimationsPromises(),t(r),n.updateAnimationsPromises()})},e.prototype.tick=function(t,n,r){var i,s,l=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var u=[],h=[],p=[],m=[];return r.forEach(function(y){y.tick(t,n),y._inEffect?(h.push(y.effect),y.markTarget()):(u.push(y.effect),y.unmarkTarget()),y._needsTick&&(l.ticking=!0);var b=y._inEffect||y._needsTick;y._inTimeline=b,b?p.push(y):m.push(y)}),(i=this.pendingEffects).push.apply(i,(0,z.ev)([],(0,z.CR)(u),!1)),(s=this.pendingEffects).push.apply(s,(0,z.ev)([],(0,z.CR)(h),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[p,m]},e}();g.EasingFunction=sg,g.AnimationTimeline=Om;var ub=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const ds=(e,t,n)=>[["M",e-n,t],["A",n,n,0,1,0,e+n,t],["A",n,n,0,1,0,e-n,t],["Z"]];ds.style=["fill"];const xy=ds.bind(void 0);xy.style=["stroke","lineWidth"];const hg=(e,t,n)=>[["M",e-n,t-n],["L",e+n,t-n],["L",e+n,t+n],["L",e-n,t+n],["Z"]];hg.style=["fill"];const Ph=hg.bind(void 0);Ph.style=["fill"];const Rm=hg.bind(void 0);Rm.style=["stroke","lineWidth"];const Mm=(e,t,n)=>{const r=n*.618;return[["M",e-r,t],["L",e,t-n],["L",e+r,t],["L",e,t+n],["Z"]]};Mm.style=["fill"];const Ey=Mm.bind(void 0);Ey.style=["stroke","lineWidth"];const G0=(e,t,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t+r],["L",e,t-r],["L",e+n,t+r],["Z"]]};G0.style=["fill"];const yv=G0.bind(void 0);yv.style=["stroke","lineWidth"];const dg=(e,t,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t-r],["L",e+n,t-r],["L",e,t+r],["Z"]]};dg.style=["fill"];const fb=dg.bind(void 0);fb.style=["stroke","lineWidth"];const od=(e,t,n)=>{const r=n/2*Math.sqrt(3);return[["M",e,t-n],["L",e+r,t-n/2],["L",e+r,t+n/2],["L",e,t+n],["L",e-r,t+n/2],["L",e-r,t-n/2],["Z"]]};od.style=["fill"];const Up=od.bind(void 0);Up.style=["stroke","lineWidth"];const g0=(e,t,n)=>{const r=n-1.5;return[["M",e-n,t-r],["L",e+n,t+r],["L",e+n,t-r],["L",e-n,t+r],["Z"]]};g0.style=["fill"];const ip=g0.bind(void 0);ip.style=["stroke","lineWidth"];const _v=(e,t,n)=>[["M",e,t+n],["L",e,t-n]];_v.style=["stroke","lineWidth"];const hb=(e,t,n)=>[["M",e-n,t-n],["L",e+n,t+n],["M",e+n,t-n],["L",e-n,t+n]];hb.style=["stroke","lineWidth"];const db=(e,t,n)=>[["M",e-n/2,t-n],["L",e+n/2,t-n],["M",e,t-n],["L",e,t+n],["M",e-n/2,t+n],["L",e+n/2,t+n]];db.style=["stroke","lineWidth"];const pb=(e,t,n)=>[["M",e-n,t],["L",e+n,t],["M",e,t-n],["L",e,t+n]];pb.style=["stroke","lineWidth"];const mb=(e,t,n)=>[["M",e-n,t],["L",e+n,t]];mb.style=["stroke","lineWidth"];const Sy=(e,t,n)=>[["M",e-n,t],["L",e+n,t]];Sy.style=["stroke","lineWidth"];const ql=Sy.bind(void 0);ql.style=["stroke","lineWidth"];const Aw=(e,t,n)=>[["M",e-n,t],["A",n/2,n/2,0,1,1,e,t],["A",n/2,n/2,0,1,0,e+n,t]];Aw.style=["stroke","lineWidth"];const Cw=(e,t,n)=>[["M",e-n-1,t-2.5],["L",e,t-2.5],["L",e,t+2.5],["L",e+n+1,t+2.5]];Cw.style=["stroke","lineWidth"];const vb=(e,t,n)=>[["M",e-n-1,t+2.5],["L",e,t+2.5],["L",e,t-2.5],["L",e+n+1,t-2.5]];vb.style=["stroke","lineWidth"];const B2=(e,t,n)=>[["M",e-(n+1),t+2.5],["L",e-n/2,t+2.5],["L",e-n/2,t-2.5],["L",e+n/2,t-2.5],["L",e+n/2,t+2.5],["L",e+n+1,t+2.5]];B2.style=["stroke","lineWidth"];const Ty=(e,t,n)=>[["M",e-5,t+2.5],["L",e-5,t],["L",e,t],["L",e,t-3],["L",e,t+3],["L",e+6.5,t+3]];Ty.style=["stroke","lineWidth"];const op=new Map([["bowtie",g0],["cross",hb],["dash",ql],["diamond",Mm],["dot",Sy],["hexagon",od],["hollowBowtie",ip],["hollowDiamond",Ey],["hollowHexagon",Up],["hollowPoint",xy],["hollowSquare",Rm],["hollowTriangle",yv],["hollowTriangleDown",fb],["hv",Cw],["hvh",B2],["hyphen",mb],["line",_v],["plus",pb],["point",ds],["rect",Ph],["smooth",Aw],["square",hg],["tick",db],["triangleDown",dg],["triangle",G0],["vh",vb],["vhv",Ty]]);function F2(e,t){var{d:n,fill:r,lineWidth:i,path:s,stroke:l,color:u}=t,h=ub(t,["d","fill","lineWidth","path","stroke","color"]);const p=op.get(e)||op.get("point");return(...m)=>new Wi({style:Object.assign(Object.assign({},h),{d:p(...m),stroke:p.style.includes("stroke")?u||l:"",fill:p.style.includes("fill")?u||r:"",lineWidth:p.style.includes("lineWidth")?i||i||2:0})})}function k2(e,t){op.set(e,t)}function kM(e){op.delete(e)}const k1={};function Ow(e,t){e.startsWith("symbol.")?k2(e.split(".").pop(),t):Object.assign(k1,{[e]:t})}function Rw(e,t){var n=t.cx,r=n===void 0?0:n,i=t.cy,s=i===void 0?0:i,l=t.r;e.arc(r,s,l,0,Math.PI*2,!1)}function zM(e,t){var n=t.cx,r=n===void 0?0:n,i=t.cy,s=i===void 0?0:i,l=t.rx,u=t.ry;if(e.ellipse)e.ellipse(r,s,l,u,0,0,Math.PI*2,!1);else{var h=l>u?l:u,p=l>u?1:l/u,m=l>u?u/l:1;e.save(),e.scale(p,m),e.arc(r,s,h,0,Math.PI*2)}}function z2(e,t){var n=t.x1,r=t.y1,i=t.x2,s=t.y2,l=t.markerStart,u=t.markerEnd,h=t.markerStartOffset,p=t.markerEndOffset,m=0,y=0,b=0,w=0,R=0,M,I;l&&ut(l)&&h&&(M=i-n,I=s-r,R=Math.atan2(I,M),m=Math.cos(R)*(h||0),y=Math.sin(R)*(h||0)),u&&ut(u)&&p&&(M=n-i,I=r-s,R=Math.atan2(I,M),b=Math.cos(R)*(p||0),w=Math.sin(R)*(p||0)),e.moveTo(n+m,r+y),e.lineTo(i+b,s+w)}function pg(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,s=t.markerEndOffset,l=t.d,u=l.absolutePath,h=l.segments,p=0,m=0,y=0,b=0,w=0,R,M;if(n&&ut(n)&&i){var I=(0,z.CR)(n.parentNode.getStartTangent(),2),N=I[0],U=I[1];R=N[0]-U[0],M=N[1]-U[1],w=Math.atan2(M,R),p=Math.cos(w)*(i||0),m=Math.sin(w)*(i||0)}if(r&&ut(r)&&s){var Z=(0,z.CR)(r.parentNode.getEndTangent(),2),N=Z[0],U=Z[1];R=N[0]-U[0],M=N[1]-U[1],w=Math.atan2(M,R),y=Math.cos(w)*(s||0),b=Math.sin(w)*(s||0)}for(var Y=0;Y<u.length;Y++){var $=u[Y],J=$[0],se=u[Y+1],pe=Y===0&&(p!==0||m!==0),Ce=(Y===u.length-1||se&&(se[0]==="M"||se[0]==="Z"))&&y!==0&&b!==0;switch(J){case"M":pe?(e.moveTo($[1]+p,$[2]+m),e.lineTo($[1],$[2])):e.moveTo($[1],$[2]);break;case"L":Ce?e.lineTo($[1]+y,$[2]+b):e.lineTo($[1],$[2]);break;case"Q":e.quadraticCurveTo($[1],$[2],$[3],$[4]),Ce&&e.lineTo($[3]+y,$[4]+b);break;case"C":e.bezierCurveTo($[1],$[2],$[3],$[4],$[5],$[6]),Ce&&e.lineTo($[5]+y,$[6]+b);break;case"A":{var Ue=h[Y].arcParams,Je=Ue.cx,lt=Ue.cy,Ge=Ue.rx,at=Ue.ry,st=Ue.startAngle,ft=Ue.endAngle,Vt=Ue.xRotation,wt=Ue.sweepFlag;if(e.ellipse)e.ellipse(Je,lt,Ge,at,Vt,st,ft,!!(1-wt));else{var zt=Ge>at?Ge:at,En=Ge>at?1:Ge/at,Vn=Ge>at?at/Ge:1;e.translate(Je,lt),e.rotate(Vt),e.scale(En,Vn),e.arc(0,0,zt,st,ft,!!(1-wt)),e.scale(1/En,1/Vn),e.rotate(-Vt),e.translate(-Je,-lt)}Ce&&e.lineTo($[6]+y,$[7]+b);break}case"Z":e.closePath();break}}}function Mw(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,s=t.markerEndOffset,l=t.points.points,u=l.length,h=l[0][0],p=l[0][1],m=l[u-1][0],y=l[u-1][1],b=0,w=0,R=0,M=0,I=0,N,U;n&&ut(n)&&i&&(N=l[1][0]-l[0][0],U=l[1][1]-l[0][1],I=Math.atan2(U,N),b=Math.cos(I)*(i||0),w=Math.sin(I)*(i||0)),r&&ut(r)&&s&&(N=l[u-1][0]-l[0][0],U=l[u-1][1]-l[0][1],I=Math.atan2(U,N),R=Math.cos(I)*(s||0),M=Math.sin(I)*(s||0)),e.moveTo(h+(b||R),p+(w||M));for(var Z=1;Z<u-1;Z++){var Y=l[Z];e.lineTo(Y[0],Y[1])}e.lineTo(m,y)}function Pw(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,s=t.markerEndOffset,l=t.points.points,u=l.length,h=l[0][0],p=l[0][1],m=l[u-1][0],y=l[u-1][1],b=0,w=0,R=0,M=0,I=0,N,U;n&&ut(n)&&i&&(N=l[1][0]-l[0][0],U=l[1][1]-l[0][1],I=Math.atan2(U,N),b=Math.cos(I)*(i||0),w=Math.sin(I)*(i||0)),r&&ut(r)&&s&&(N=l[u-2][0]-l[u-1][0],U=l[u-2][1]-l[u-1][1],I=Math.atan2(U,N),R=Math.cos(I)*(s||0),M=Math.sin(I)*(s||0)),e.moveTo(h+b,p+w);for(var Z=1;Z<u-1;Z++){var Y=l[Z];e.lineTo(Y[0],Y[1])}e.lineTo(m+R,y+M)}function wy(e,t){var n=t.x,r=n===void 0?0:n,i=t.y,s=i===void 0?0:i,l=t.radius,u=t.width,h=t.height,p=u,m=h,y=l&&l.some(function(Y){return Y!==0});if(!y)e.rect(r,s,p,m);else{var b=u>0?1:-1,w=h>0?1:-1,R=b+w===0,M=(0,z.CR)(l.map(function(Y){return(0,so.Z)(Y,0,Math.min(Math.abs(p)/2,Math.abs(m)/2))}),4),I=M[0],N=M[1],U=M[2],Z=M[3];e.moveTo(b*I+r,s),e.lineTo(p-b*N+r,s),N!==0&&e.arc(p-b*N+r,w*N+s,N,-w*Math.PI/2,b>0?0:Math.PI,R),e.lineTo(p+r,m-w*U+s),U!==0&&e.arc(p-b*U+r,m-w*U+s,U,b>0?0:Math.PI,w>0?Math.PI/2:1.5*Math.PI,R),e.lineTo(b*Z+r,m+s),Z!==0&&e.arc(b*Z+r,m-w*Z+s,Z,w>0?Math.PI/2:-Math.PI/2,b>0?Math.PI:0,R),e.lineTo(r,w*I+s),I!==0&&e.arc(b*I+r,w*I+s,I,b>0?Math.PI:0,w>0?Math.PI*1.5:Math.PI/2,R)}}var Iw=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.name="canvas-path-generator",n}return t.prototype.init=function(){var n,r=(n={},n[Gr.CIRCLE]=Rw,n[Gr.ELLIPSE]=zM,n[Gr.RECT]=wy,n[Gr.LINE]=z2,n[Gr.POLYLINE]=Pw,n[Gr.POLYGON]=Mw,n[Gr.PATH]=pg,n[Gr.TEXT]=void 0,n[Gr.GROUP]=void 0,n[Gr.IMAGE]=void 0,n[Gr.HTML]=void 0,n[Gr.MESH]=void 0,n);this.context.pathGeneratorFactory=r},t.prototype.destroy=function(){delete this.context.pathGeneratorFactory},t}(Xc),Lw=nt.Ue(),U2=nt.Ue(),UM=nt.Ue(),z1=St.create(),gb=function(){function e(){var t=this;this.isHit=function(n,r,i,s){var l=t.context.pointInPathPickerFactory[n.nodeName];if(l){var u=St.invert(z1,i),h=nt.fF(U2,nt.t8(UM,r[0],r[1],0),u);if(l(n,new ur(h[0],h[1]),s,t.isPointInPath,t.context,t.runtime))return!0}return!1},this.isPointInPath=function(n,r){var i=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),s=t.context.pathGeneratorFactory[n.nodeName];return s&&(i.beginPath(),s(i,n.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return e.prototype.apply=function(t,n){var r=this,i,s=t.renderingService,l=t.renderingContext;this.context=t,this.runtime=n;var u=(i=l.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(e.tag,function(h){return(0,z.mG)(r,void 0,void 0,function(){return(0,z.Jh)(this,function(p){return[2,this.pick(u,h)]})})}),s.hooks.pickSync.tap(e.tag,function(h){return r.pick(u,h)})},e.prototype.pick=function(t,n){var r,i,s=n.topmost,l=n.position,u=l.x,h=l.y,p=nt.t8(Lw,u,h,0),m=t.elementsFromBBox(p[0],p[1],p[0],p[1]),y=[];try{for(var b=(0,z.XA)(m),w=b.next();!w.done;w=b.next()){var R=w.value,M=R.getWorldTransform(),I=this.isHit(R,p,M,!1);if(I){var N=as(R);if(N){var U=N.parsedStyle.clipPath,Z=this.isHit(U,p,U.getWorldTransform(),!0);if(Z){if(s)return n.picked=[R],n;y.push(R)}}else{if(s)return n.picked=[R],n;y.push(R)}}}}catch(Y){r={error:Y}}finally{try{w&&!w.done&&(i=b.return)&&i.call(b)}finally{if(r)throw r.error}}return n.picked=y,n},e.tag="CanvasPicker",e}();function jM(e,t,n){var r=e.parsedStyle,i=r.cx,s=i===void 0?0:i,l=r.cy,u=l===void 0?0:l,h=r.r,p=r.fill,m=r.stroke,y=r.lineWidth,b=y===void 0?1:y,w=r.increasedLineWidthForHitTesting,R=w===void 0?0:w,M=r.pointerEvents,I=M===void 0?"auto":M,N=(b+R)/2,U=Pe(s,u,t.x,t.y),Z=(0,z.CR)(Za(I,p,m),2),Y=Z[0],$=Z[1];return Y&&$||n?U<=h+N:Y?U<=h:$?U>=h-N&&U<=h+N:!1}function U1(e,t,n,r){return e/(n*n)+t/(r*r)}function VM(e,t,n){var r=e.parsedStyle,i=r.cx,s=i===void 0?0:i,l=r.cy,u=l===void 0?0:l,h=r.rx,p=r.ry,m=r.fill,y=r.stroke,b=r.lineWidth,w=b===void 0?1:b,R=r.increasedLineWidthForHitTesting,M=R===void 0?0:R,I=r.pointerEvents,N=I===void 0?"auto":I,U=t.x,Z=t.y,Y=(0,z.CR)(Za(N,m,y),2),$=Y[0],J=Y[1],se=(w+M)/2,pe=(U-s)*(U-s),Ce=(Z-u)*(Z-u);return $&&J||n?U1(pe,Ce,h+se,p+se)<=1:$?U1(pe,Ce,h,p)<=1:J?U1(pe,Ce,h-se,p-se)>=1&&U1(pe,Ce,h+se,p+se)<=1:!1}function bv(e,t,n,r,i,s){return i>=e&&i<=e+n&&s>=t&&s<=t+r}function HM(e,t,n,r,i,s,l){var u=i/2;return bv(e-u,t-u,n,i,s,l)||bv(e+n-u,t-u,i,r,s,l)||bv(e+u,t+r-u,n,i,s,l)||bv(e-u,t+u,i,r,s,l)}function j1(e,t,n,r,i,s,l,u){var h=(Math.atan2(u-t,l-e)+Math.PI*2)%(Math.PI*2),p={x:e+n*Math.cos(h),y:t+n*Math.sin(h)};return Pe(p.x,p.y,l,u)<=s/2}function jp(e,t,n,r,i,s,l){var u=Math.min(e,n),h=Math.max(e,n),p=Math.min(t,r),m=Math.max(t,r),y=i/2;return s>=u-y&&s<=h+y&&l>=p-y&&l<=m+y?Sd(e,t,n,r,s,l)<=i/2:!1}function Dw(e,t,n,r,i){var s=e.length;if(s<2)return!1;for(var l=0;l<s-1;l++){var u=e[l][0],h=e[l][1],p=e[l+1][0],m=e[l+1][1];if(jp(u,h,p,m,t,n,r))return!0}if(i){var y=e[0],b=e[s-1];if(jp(y[0],y[1],b[0],b[1],t,n,r))return!0}return!1}var ZM=1e-6;function yb(e){return Math.abs(e)<ZM?0:e<0?-1:1}function Nw(e,t,n){return(n[0]-e[0])*(t[1]-e[1])===(t[0]-e[0])*(n[1]-e[1])&&Math.min(e[0],t[0])<=n[0]&&n[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=n[1]&&n[1]<=Math.max(e[1],t[1])}function j2(e,t,n){var r=!1,i=e.length;if(i<=2)return!1;for(var s=0;s<i;s++){var l=e[s],u=e[(s+1)%i];if(Nw(l,u,[t,n]))return!0;yb(l[1]-n)>0!=yb(u[1]-n)>0&&yb(t-(n-l[1])*(l[0]-u[0])/(l[1]-u[1])-l[0])<0&&(r=!r)}return r}function V2(e,t,n){for(var r=!1,i=0;i<e.length;i++){var s=e[i];if(r=j2(s,t,n),r)break}return r}function Bw(e,t,n){var r=e.parsedStyle,i=r.x1,s=r.y1,l=r.x2,u=r.y2,h=r.lineWidth,p=h===void 0?1:h,m=r.increasedLineWidthForHitTesting,y=m===void 0?0:m,b=r.pointerEvents,w=b===void 0?"auto":b,R=r.fill,M=r.stroke,I=(0,z.CR)(Za(w,R,M),2),N=I[1];return!N&&!n||!p?!1:jp(i,s,l,u,p+y,t.x,t.y)}function Fw(e,t,n,r,i){for(var s=!1,l=t/2,u=0;u<e.length;u++){var h=e[u],p=h.currentPoint,m=h.params,y=h.prePoint,b=h.box;if(!(b&&!bv(b.x-l,b.y-l,b.width+t,b.height+t,n,r)))switch(h.command){case"L":case"Z":if(s=jp(y[0],y[1],p[0],p[1],t,n,r),s)return!0;break;case"Q":var w=qp(y[0],y[1],m[1],m[2],m[3],m[4],n,r);if(s=w<=t/2,s)return!0;break;case"C":var R=bp(y[0],y[1],m[1],m[2],m[3],m[4],m[5],m[6],n,r,i);if(s=R<=t/2,s)return!0;break;case"A":h.cubicParams||(h.cubicParams=Kf(y[0],y[1],m[1],m[2],m[3],m[4],m[5],m[6],m[7],void 0));for(var M=h.cubicParams,I=y,N=0;N<M.length;N+=6){var U=bp(I[0],I[1],M[N],M[N+1],M[N+2],M[N+3],M[N+4],M[N+5],n,r,i);if(I=[M[N+4],M[N+5]],s=U<=t/2,s)return!0}break}}return s}function kw(e,t,n,r,i,s){var l=e.parsedStyle,u=l.lineWidth,h=u===void 0?1:u,p=l.increasedLineWidthForHitTesting,m=p===void 0?0:p,y=l.stroke,b=l.fill,w=l.d,R=l.pointerEvents,M=R===void 0?"auto":R,I=w.segments,N=w.hasArc,U=w.polylines,Z=w.polygons,Y=(0,z.CR)(Za(M,(Z==null?void 0:Z.length)&&b,y),2),$=Y[0],J=Y[1],se=Sf(e),pe=!1;return $||n?(N?pe=r(e,t):pe=V2(Z,t.x,t.y)||V2(U,t.x,t.y),pe):((J||n)&&(pe=Fw(I,h+m,t.x,t.y,se)),pe)}function H2(e,t,n){var r=e.parsedStyle,i=r.stroke,s=r.fill,l=r.lineWidth,u=l===void 0?1:l,h=r.increasedLineWidthForHitTesting,p=h===void 0?0:h,m=r.points,y=r.pointerEvents,b=y===void 0?"auto":y,w=(0,z.CR)(Za(b,s,i),2),R=w[0],M=w[1],I=!1;return(M||n)&&(I=Dw(m.points,u+p,t.x,t.y,!0)),!I&&(R||n)&&(I=j2(m.points,t.x,t.y)),I}function Z2(e,t,n){var r=e.parsedStyle,i=r.lineWidth,s=i===void 0?1:i,l=r.increasedLineWidthForHitTesting,u=l===void 0?0:l,h=r.points,p=r.pointerEvents,m=p===void 0?"auto":p,y=r.fill,b=r.stroke,w=(0,z.CR)(Za(m,y,b),2),R=w[1];return!R&&!n||!s?!1:Dw(h.points,s+u,t.x,t.y,!1)}function ad(e,t,n,r,i){var s=e.parsedStyle,l=s.radius,u=s.fill,h=s.stroke,p=s.lineWidth,m=p===void 0?1:p,y=s.increasedLineWidthForHitTesting,b=y===void 0?0:y,w=s.x,R=w===void 0?0:w,M=s.y,I=M===void 0?0:M,N=s.width,U=s.height,Z=s.pointerEvents,Y=Z===void 0?"auto":Z,$=(0,z.CR)(Za(Y,u,h),2),J=$[0],se=$[1],pe=l&&l.some(function(lt){return lt!==0}),Ce=m+b;if(pe){var Je=!1;return(se||n)&&(Je=zw(R,I,N,U,l.map(function(lt){return(0,so.Z)(lt,0,Math.min(Math.abs(N)/2,Math.abs(U)/2))}),Ce,t.x,t.y)),!Je&&(J||n)&&(Je=r(e,t)),Je}else{var Ue=Ce/2;if(J&&se||n)return bv(R-Ue,I-Ue,N+Ue,U+Ue,t.x,t.y);if(J)return bv(R,I,N,U,t.x,t.y);if(se)return HM(R,I,N,U,Ce,t.x,t.y)}return!1}function zw(e,t,n,r,i,s,l,u){var h=(0,z.CR)(i,4),p=h[0],m=h[1],y=h[2],b=h[3];return jp(e+p,t,e+n-m,t,s,l,u)||jp(e+n,t+m,e+n,t+r-y,s,l,u)||jp(e+n-y,t+r,e+b,t+r,s,l,u)||jp(e,t+r-b,e,t+p,s,l,u)||j1(e+n-m,t+m,m,1.5*Math.PI,2*Math.PI,s,l,u)||j1(e+n-y,t+r-y,y,0,.5*Math.PI,s,l,u)||j1(e+b,t+r-b,b,.5*Math.PI,Math.PI,s,l,u)||j1(e+p,t+p,p,Math.PI,1.5*Math.PI,s,l,u)}function Uw(e,t,n,r,i,s){var l=e.parsedStyle,u=l.pointerEvents,h=u===void 0?"auto":u,p=l.x,m=p===void 0?0:p,y=l.y,b=y===void 0?0:y,w=l.width,R=l.height;if(h==="non-transparent-pixel"){var M=i.config.offscreenCanvas,I=s.offscreenCanvasCreator.getOrCreateCanvas(M),N=s.offscreenCanvasCreator.getOrCreateContext(M,{willReadFrequently:!0});I.width=w,I.height=R,i.defaultStyleRendererFactory[Gr.IMAGE].render(N,(0,z.pi)((0,z.pi)({},e.parsedStyle),{x:0,y:0}),e,void 0,void 0,void 0);var U=N.getImageData(t.x-m,t.y-b,1,1).data;return U.every(function(Z){return Z!==0})}return!0}var jw=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.name="canvas-picker",n}return t.prototype.init=function(){var n,r=function(){return!0},i=(n={},n[Gr.CIRCLE]=jM,n[Gr.ELLIPSE]=VM,n[Gr.RECT]=ad,n[Gr.LINE]=Bw,n[Gr.POLYLINE]=Z2,n[Gr.POLYGON]=H2,n[Gr.PATH]=kw,n[Gr.TEXT]=r,n[Gr.GROUP]=null,n[Gr.IMAGE]=Uw,n[Gr.HTML]=null,n[Gr.MESH]=null,n);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new gb)},t.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},t}(Xc),Vw=function(){function e(t){this.canvasRendererPluginOptions=t,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=St.create(),this.dprMatrix=St.create(),this.tmpMat4=St.create(),this.vec3a=nt.Ue(),this.vec3b=nt.Ue(),this.vec3c=nt.Ue(),this.vec3d=nt.Ue()}return e.prototype.apply=function(t,n){var r=this;this.context=t;var i=t.config,s=t.camera,l=t.renderingService,u=t.renderingContext,h=t.rBushRoot,p=t.pathGeneratorFactory;this.rBush=h,this.pathGeneratorFactory=p;var m=t.contextService,y=u.root.ownerDocument.defaultView,b=function(M){var I=M.target,N=I.rBushNode;N.aabb&&r.removedRBushNodeAABBs.push(N.aabb)},w=function(M){var I=M.target,N=I.rBushNode;N.aabb&&r.removedRBushNodeAABBs.push(N.aabb)};l.hooks.init.tap(e.tag,function(){y.addEventListener(wa.UNMOUNTED,b),y.addEventListener(wa.CULLED,w);var M=m.getDPR(),I=i.width,N=i.height,U=m.getContext();r.clearRect(U,0,0,I*M,N*M,i.background)}),l.hooks.destroy.tap(e.tag,function(){y.removeEventListener(wa.UNMOUNTED,b),y.removeEventListener(wa.CULLED,w),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),l.hooks.beginFrame.tap(e.tag,function(){var M,I=m.getContext(),N=m.getDPR(),U=i.width,Z=i.height,Y=r.canvasRendererPluginOptions,$=Y.dirtyObjectNumThreshold,J=Y.dirtyObjectRatioThreshold,se=l.getStats(),pe=se.total,Ce=se.rendered,Ue=Ce/pe;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((M=y.context.renderingPlugins[1])===null||M===void 0)&&M.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||Ce>$&&Ue>J,I&&(I.resetTransform?I.resetTransform():I.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(I,0,0,U*N,Z*N,i.background))});var R=function(M,I){M.isVisible()&&!M.isCulled()&&r.renderDisplayObject(M,I,r.context,r.restoreStack,n);var N=M.sortable.sorted||M.childNodes;N.forEach(function(U){R(U,I)})};l.hooks.endFrame.tap(e.tag,function(){if(u.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var M=m.getContext(),I=m.getDPR();if(St.fromScaling(r.dprMatrix,[I,I,1]),St.multiply(r.vpMatrix,r.dprMatrix,s.getOrthoMatrix()),r.clearFullScreen)R(u.root,M);else{var N=r.safeMergeAABB.apply(r,(0,z.ev)([r.mergeDirtyAABBs(r.renderQueue)],(0,z.CR)(r.removedRBushNodeAABBs.map(function(Vn){var ar=Vn.minX,lr=Vn.minY,Vr=Vn.maxX,ui=Vn.maxY,qi=new Cn;return qi.setMinMax([ar,lr,0],[Vr,ui,0]),qi})),!1));if(r.removedRBushNodeAABBs=[],Cn.isEmpty(N)){r.renderQueue=[];return}var U=r.convertAABB2Rect(N),Z=U.x,Y=U.y,$=U.width,J=U.height,se=nt.fF(r.vec3a,[Z,Y,0],r.vpMatrix),pe=nt.fF(r.vec3b,[Z+$,Y,0],r.vpMatrix),Ce=nt.fF(r.vec3c,[Z,Y+J,0],r.vpMatrix),Ue=nt.fF(r.vec3d,[Z+$,Y+J,0],r.vpMatrix),Je=Math.min(se[0],pe[0],Ue[0],Ce[0]),lt=Math.min(se[1],pe[1],Ue[1],Ce[1]),Ge=Math.max(se[0],pe[0],Ue[0],Ce[0]),at=Math.max(se[1],pe[1],Ue[1],Ce[1]),st=Math.floor(Je),ft=Math.floor(lt),Vt=Math.ceil(Ge-Je),wt=Math.ceil(at-lt);M.save(),r.clearRect(M,st,ft,Vt,wt,i.background),M.beginPath(),M.rect(st,ft,Vt,wt),M.clip(),M.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var zt=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;zt&&y.dispatchEvent(new tl(Hs.DIRTY_RECTANGLE,{dirtyRect:{x:st,y:ft,width:Vt,height:wt}}));var En=r.searchDirtyObjects(N);En.sort(function(Vn,ar){return Vn.sortable.renderOrder-ar.sortable.renderOrder}).forEach(function(Vn){Vn&&Vn.isVisible()&&!Vn.isCulled()&&r.renderDisplayObject(Vn,M,r.context,r.restoreStack,n)}),M.restore(),r.renderQueue.forEach(function(Vn){r.saveDirtyAABB(Vn)}),r.renderQueue=[]}r.restoreStack.forEach(function(){M.restore()}),r.restoreStack=[]}),l.hooks.render.tap(e.tag,function(M){r.clearFullScreen||r.renderQueue.push(M)})},e.prototype.clearRect=function(t,n,r,i,s,l){t.clearRect(n,r,i,s),l&&(t.fillStyle=l,t.fillRect(n,r,i,s))},e.prototype.renderDisplayObject=function(t,n,r,i,s){var l=t.nodeName,u=i[i.length-1];u&&!(t.compareDocumentPosition(u)&Xa.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),i.pop());var h=this.context.styleRendererFactory[l],p=this.pathGeneratorFactory[l],m=t.parsedStyle.clipPath;if(m){this.applyWorldTransform(n,m);var y=this.pathGeneratorFactory[m.nodeName];y&&(n.save(),i.push(t),n.beginPath(),y(n,m.parsedStyle),n.closePath(),n.clip())}h&&(this.applyWorldTransform(n,t),n.save(),this.applyAttributesToContext(n,t)),p&&(n.beginPath(),p(n,t.parsedStyle),t.nodeName!==Gr.LINE&&t.nodeName!==Gr.PATH&&t.nodeName!==Gr.POLYLINE&&n.closePath()),h&&(h.render(n,t.parsedStyle,t,r,this,s),n.restore()),t.renderable.dirty=!1},e.prototype.convertAABB2Rect=function(t){var n=t.getMin(),r=t.getMax(),i=Math.floor(n[0]),s=Math.floor(n[1]),l=Math.ceil(r[0]),u=Math.ceil(r[1]),h=l-i,p=u-s;return{x:i,y:s,width:h,height:p}},e.prototype.mergeDirtyAABBs=function(t){var n=new Cn;return t.forEach(function(r){var i=r.getRenderBounds();n.add(i);var s=r.renderable.dirtyRenderBounds;s&&n.add(s)}),n},e.prototype.searchDirtyObjects=function(t){var n=(0,z.CR)(t.getMin(),2),r=n[0],i=n[1],s=(0,z.CR)(t.getMax(),2),l=s[0],u=s[1],h=this.rBush.search({minX:r,minY:i,maxX:l,maxY:u});return h.map(function(p){var m=p.displayObject;return m})},e.prototype.saveDirtyAABB=function(t){var n=t.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new Cn);var r=t.getRenderBounds();r&&n.dirtyRenderBounds.update(r.center,r.halfExtents)},e.prototype.applyAttributesToContext=function(t,n){var r=n.parsedStyle,i=r.stroke,s=r.fill,l=r.opacity,u=r.lineDash,h=r.lineDashOffset;u&&t.setLineDash(u),(0,sr.Z)(h)||(t.lineDashOffset=h),(0,sr.Z)(l)||(t.globalAlpha*=l),!(0,sr.Z)(i)&&!Array.isArray(i)&&!i.isNone&&(t.strokeStyle=n.attributes.stroke),!(0,sr.Z)(s)&&!Array.isArray(s)&&!s.isNone&&(t.fillStyle=n.attributes.fill)},e.prototype.applyWorldTransform=function(t,n,r){r?(St.copy(this.tmpMat4,n.getLocalTransform()),St.multiply(this.tmpMat4,r,this.tmpMat4),St.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(St.copy(this.tmpMat4,n.getWorldTransform()),St.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},e.prototype.safeMergeAABB=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=new Cn;return t.forEach(function(i){r.add(i)}),r},e.tag="CanvasRenderer",e}(),Pm=function(){function e(t){this.imagePool=t}return e.prototype.render=function(t,n,r,i,s,l){var u=n.fill,h=n.fillRule,p=n.opacity,m=p===void 0?1:p,y=n.fillOpacity,b=y===void 0?1:y,w=n.stroke,R=n.strokeOpacity,M=R===void 0?1:R,I=n.lineWidth,N=I===void 0?1:I,U=n.lineCap,Z=n.lineJoin,Y=n.shadowType,$=n.shadowColor,J=n.shadowBlur,se=n.filter,pe=n.miterLimit,Ce=u&&!u.isNone,Ue=w&&!w.isNone&&N>0,Je=(u==null?void 0:u.alpha)===0,lt=!!(se&&se.length),Ge=!(0,sr.Z)($)&&J>0,at=r.nodeName,st=Y==="inner",ft=Ue&&Ge&&(at===Gr.PATH||at===Gr.LINE||at===Gr.POLYLINE||Je||st);Ce&&(t.globalAlpha=m*b,ft||V1(r,t,Ge),G2(t,r,u,h,i,s,l,this.imagePool),ft||this.clearShadowAndFilter(t,lt,Ge)),Ue&&(t.globalAlpha=m*M,t.lineWidth=N,(0,sr.Z)(pe)||(t.miterLimit=pe),(0,sr.Z)(U)||(t.lineCap=U),(0,sr.Z)(Z)||(t.lineJoin=Z),ft&&(st&&(t.globalCompositeOperation="source-atop"),V1(r,t,!0),st&&(bb(t,r,w,i,s,l,this.imagePool),t.globalCompositeOperation="source-over",this.clearShadowAndFilter(t,lt,!0))),bb(t,r,w,i,s,l,this.imagePool))},e.prototype.clearShadowAndFilter=function(t,n,r){if(r&&(t.shadowColor="transparent",t.shadowBlur=0),n){var i=t.filter;!(0,sr.Z)(i)&&i.indexOf("drop-shadow")>-1&&(t.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},e}();function V1(e,t,n){var r=e.parsedStyle,i=r.filter,s=r.shadowColor,l=r.shadowBlur,u=r.shadowOffsetX,h=r.shadowOffsetY;i&&i.length&&(t.filter=e.style.filter),n&&(t.shadowColor=s.toString(),t.shadowBlur=l||0,t.shadowOffsetX=u||0,t.shadowOffsetY=h||0)}function W2(e,t,n,r,i,s,l){var u,h;if(e.image.nodeName==="rect"){var p=e.image.parsedStyle,m=p.width,y=p.height;h=r.contextService.getDPR();var b=r.config.offscreenCanvas;u=s.offscreenCanvasCreator.getOrCreateCanvas(b),u.width=m*h,u.height=y*h;var w=s.offscreenCanvasCreator.getOrCreateContext(b),R=[];e.image.forEach(function(I){i.renderDisplayObject(I,w,r,R,s)}),R.forEach(function(){w.restore()})}var M=l.getOrCreatePatternSync(e,n,u,h,t.getGeometryBounds().min,function(){t.renderable.dirty=!0,r.renderingService.dirtify()});return M}function _b(e,t,n,r){var i;if(e.type===gl.LinearGradient||e.type===gl.RadialGradient){var s=t.getGeometryBounds(),l=s&&s.halfExtents[0]*2||1,u=s&&s.halfExtents[1]*2||1,h=s&&s.min||[0,0];i=r.getOrCreateGradient((0,z.pi)((0,z.pi)({type:e.type},e.value),{min:h,width:l,height:u}),n)}return i}function G2(e,t,n,r,i,s,l,u,h){h===void 0&&(h=!1),Array.isArray(n)?n.forEach(function(p){e.fillStyle=_b(p,t,e,u),h||(r?e.fill(r):e.fill())}):(Wd(n)&&(e.fillStyle=W2(n,t,e,i,s,l,u)),h||(r?e.fill(r):e.fill()))}function bb(e,t,n,r,i,s,l,u){u===void 0&&(u=!1),Array.isArray(n)?n.forEach(function(h){e.strokeStyle=_b(h,t,e,l),u||e.stroke()}):(Wd(n)&&(e.strokeStyle=W2(n,t,e,r,i,s,l)),u||e.stroke())}var Hw=function(){function e(t){this.imagePool=t}return e.prototype.render=function(t,n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l,h=n.width,p=n.height,m=n.src,y=n.shadowColor,b=n.shadowBlur,w,R=h,M=p;if(bi(m)?w=this.imagePool.getImageSync(m):(R||(R=m.width),M||(M=m.height),w=m),w){var I=!(0,sr.Z)(y)&&b>0;V1(r,t,I);try{t.drawImage(w,s,u,R,M)}catch(N){}}},e}(),X2=function(){function e(t){this.imagePool=t}return e.prototype.render=function(t,n,r,i,s,l){r.getBounds();var u=n,h=u.lineWidth,p=h===void 0?1:h,m=u.textAlign,y=m===void 0?"start":m,b=u.textBaseline,w=b===void 0?"alphabetic":b,R=u.lineJoin,M=R===void 0?"miter":R,I=u.miterLimit,N=I===void 0?10:I,U=u.letterSpacing,Z=U===void 0?0:U,Y=u.stroke,$=u.fill,J=u.fillRule,se=u.fillOpacity,pe=se===void 0?1:se,Ce=u.strokeOpacity,Ue=Ce===void 0?1:Ce,Je=u.opacity,lt=Je===void 0?1:Je,Ge=u.metrics,at=u.x,st=at===void 0?0:at,ft=u.y,Vt=ft===void 0?0:ft,wt=u.dx,zt=u.dy,En=u.shadowColor,Vn=u.shadowBlur,ar=Ge.font,lr=Ge.lines,Vr=Ge.height,ui=Ge.lineHeight,qi=Ge.lineMetrics;t.font=ar,t.lineWidth=p,t.textAlign=y==="middle"?"center":y;var Jr=w;!l.enableCSSParsing&&Jr==="alphabetic"&&(Jr="bottom"),t.lineJoin=M,(0,sr.Z)(N)||(t.miterLimit=N);var Qr=Vt;w==="middle"?Qr+=-Vr/2-ui/2:w==="bottom"||w==="alphabetic"||w==="ideographic"?Qr+=-Vr:(w==="top"||w==="hanging")&&(Qr+=-ui);var Mo=st+(wt||0);Qr+=zt||0,lr.length===1&&(Jr==="bottom"?(Jr="middle",Qr-=.5*Vr):Jr==="top"&&(Jr="middle",Qr+=.5*Vr)),t.textBaseline=Jr;var Qi=!(0,sr.Z)(En)&&Vn>0;V1(r,t,Qi);for(var Zi=0;Zi<lr.length;Zi++){var Eo=p/2+Mo;Qr+=ui,!(0,sr.Z)(Y)&&!Y.isNone&&p&&this.drawLetterSpacing(t,r,lr[Zi],qi[Zi],y,Eo,Qr,Z,$,J,pe,Y,Ue,lt,!0,i,s,l),(0,sr.Z)($)||this.drawLetterSpacing(t,r,lr[Zi],qi[Zi],y,Eo,Qr,Z,$,J,pe,Y,Ue,lt,!1,i,s,l)}},e.prototype.drawLetterSpacing=function(t,n,r,i,s,l,u,h,p,m,y,b,w,R,M,I,N,U){if(h===0){M?this.strokeText(t,n,r,l,u,b,w,I,N,U):this.fillText(t,n,r,l,u,p,m,y,R,I,N,U);return}var Z=t.textAlign;t.textAlign="left";var Y=l;s==="center"||s==="middle"?Y=l-i.width/2:(s==="right"||s==="end")&&(Y=l-i.width);for(var $=Array.from(r),J=t.measureText(r).width,se=0,pe=0;pe<$.length;++pe){var Ce=$[pe];M?this.strokeText(t,n,Ce,Y,u,b,w,I,N,U):this.fillText(t,n,Ce,Y,u,p,m,y,R,I,N,U),se=t.measureText(r.substring(pe+1)).width,Y+=J-se+h,J=se}t.textAlign=Z},e.prototype.fillText=function(t,n,r,i,s,l,u,h,p,m,y,b){G2(t,n,l,u,m,y,b,this.imagePool,!0);var w,R=!(0,sr.Z)(h)&&h!==1;R&&(w=t.globalAlpha,t.globalAlpha=h*p),t.fillText(r,i,s),R&&(t.globalAlpha=w)},e.prototype.strokeText=function(t,n,r,i,s,l,u,h,p,m){bb(t,n,l,h,p,m,this.imagePool,!0);var y,b=!(0,sr.Z)(u)&&u!==1;b&&(y=t.globalAlpha,t.globalAlpha=u),t.strokeText(r,i,s),b&&(t.globalAlpha=y)},e}(),WM=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),GM=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),XM=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),YM=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),$M=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),KM=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),qM=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Pm),QM=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=e.call(this)||this;return r.options=n,r.name="canvas-renderer",r}return t.prototype.init=function(){var n,r=(0,z.pi)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,s=new Pm(i),l=(n={},n[Gr.CIRCLE]=s,n[Gr.ELLIPSE]=s,n[Gr.RECT]=s,n[Gr.IMAGE]=new Hw(i),n[Gr.TEXT]=new X2(i),n[Gr.LINE]=s,n[Gr.POLYLINE]=s,n[Gr.POLYGON]=s,n[Gr.PATH]=s,n[Gr.GROUP]=void 0,n[Gr.HTML]=void 0,n[Gr.MESH]=void 0,n);this.context.defaultStyleRendererFactory=l,this.context.styleRendererFactory=l,this.addRenderingPlugin(new Vw(r))},t.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},t}(Xc),Y2=function(){function e(){}return e.prototype.apply=function(t,n){var r=this,i=t.renderingService,s=t.renderingContext,l=t.config;this.context=t;var u=s.root.ownerDocument.defaultView,h=function(J){i.hooks.pointerMove.call(J)},p=function(J){i.hooks.pointerUp.call(J)},m=function(J){i.hooks.pointerDown.call(J)},y=function(J){i.hooks.pointerOver.call(J)},b=function(J){i.hooks.pointerOut.call(J)},w=function(J){i.hooks.pointerCancel.call(J)},R=function(J){i.hooks.pointerWheel.call(J)},M=function(J){i.hooks.click.call(J)},I=function(J){n.globalThis.document.addEventListener("pointermove",h,!0),J.addEventListener("pointerdown",m,!0),J.addEventListener("pointerleave",b,!0),J.addEventListener("pointerover",y,!0),n.globalThis.addEventListener("pointerup",p,!0),n.globalThis.addEventListener("pointercancel",w,!0)},N=function(J){J.addEventListener("touchstart",m,!0),J.addEventListener("touchend",p,!0),J.addEventListener("touchmove",h,!0),J.addEventListener("touchcancel",w,!0)},U=function(J){n.globalThis.document.addEventListener("mousemove",h,!0),J.addEventListener("mousedown",m,!0),J.addEventListener("mouseout",b,!0),J.addEventListener("mouseover",y,!0),n.globalThis.addEventListener("mouseup",p,!0)},Z=function(J){n.globalThis.document.removeEventListener("pointermove",h,!0),J.removeEventListener("pointerdown",m,!0),J.removeEventListener("pointerleave",b,!0),J.removeEventListener("pointerover",y,!0),n.globalThis.removeEventListener("pointerup",p,!0)},Y=function(J){J.removeEventListener("touchstart",m,!0),J.removeEventListener("touchend",p,!0),J.removeEventListener("touchmove",h,!0),J.removeEventListener("touchcancel",w,!0)},$=function(J){n.globalThis.document.removeEventListener("mousemove",h,!0),J.removeEventListener("mousedown",m,!0),J.removeEventListener("mouseout",b,!0),J.removeEventListener("mouseover",y,!0),n.globalThis.removeEventListener("mouseup",p,!0)};i.hooks.init.tap(e.tag,function(){var J=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(J.style.msContentZooming="none",J.style.msTouchAction="none"):u.supportsPointerEvents&&(J.style.touchAction="none"),u.supportsPointerEvents?I(J):U(J),u.supportsTouchEvents&&N(J),l.useNativeClickEvent&&J.addEventListener("click",M,!0),J.addEventListener("wheel",R,{passive:!0,capture:!0})}),i.hooks.destroy.tap(e.tag,function(){var J=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(J.style.msContentZooming="",J.style.msTouchAction=""):u.supportsPointerEvents&&(J.style.touchAction=""),u.supportsPointerEvents?Z(J):$(J),u.supportsTouchEvents&&Y(J),l.useNativeClickEvent&&J.removeEventListener("click",M,!0),J.removeEventListener("wheel",R,!0)})},e.tag="DOMInteraction",e}(),Zw=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.name="dom-interaction",n}return t.prototype.init=function(){this.addRenderingPlugin(new Y2)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(Xc),xb="g-canvas-camera",JM=function(){function e(){this.displayObjectHTMLElementMap=new WeakMap}return e.prototype.joinTransformMatrix=function(t){return"matrix(".concat([t[0],t[1],t[4],t[5],t[12],t[13]].join(","),")")},e.prototype.apply=function(t,n){var r=this,i=t.camera,s=t.renderingContext,l=t.renderingService;this.context=t;var u=s.root.ownerDocument.defaultView,h=u.context.eventService.nativeHTMLMap,p=function(M,I){I.style.transform=r.joinTransformMatrix(M.getWorldTransform())},m=function(M){var I=M.target;if(I.nodeName===Gr.HTML){r.$camera||(r.$camera=r.createCamera(i));var N=r.getOrCreateEl(I);if(r.$camera.appendChild(N),n.enableCSSParsing){var U=I.ownerDocument.documentElement.attributes;Object.keys(U).forEach(function(Z){N.style[Z]=U[Z]})}Object.keys(I.attributes).forEach(function(Z){r.updateAttribute(Z,I)}),p(I,N),h.set(N,I)}},y=function(M){var I=M.target;if(I.nodeName===Gr.HTML&&r.$camera){var N=r.getOrCreateEl(I);N&&(N.remove(),h.delete(N))}},b=function(M){var I=M.target;if(I.nodeName===Gr.HTML){var N=M.attrName;r.updateAttribute(N,I)}},w=function(M){var I=M.target;if(I.nodeName===Gr.HTML){var N=r.getOrCreateEl(I);p(I,N)}},R=function(){if(r.$camera){var M=r.context.config,I=M.width,N=M.height;r.$camera.style.width="".concat(I||0,"px"),r.$camera.style.height="".concat(N||0,"px")}};l.hooks.init.tap(e.tag,function(){u.addEventListener(Hs.RESIZE,R),u.addEventListener(wa.MOUNTED,m),u.addEventListener(wa.UNMOUNTED,y),u.addEventListener(wa.ATTR_MODIFIED,b),u.addEventListener(wa.BOUNDS_CHANGED,w)}),l.hooks.endFrame.tap(e.tag,function(){r.$camera&&s.renderReasons.has(Oh.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),l.hooks.destroy.tap(e.tag,function(){r.$camera&&r.$camera.remove(),u.removeEventListener(Hs.RESIZE,R),u.removeEventListener(wa.MOUNTED,m),u.removeEventListener(wa.UNMOUNTED,y),u.removeEventListener(wa.ATTR_MODIFIED,b),u.removeEventListener(wa.BOUNDS_CHANGED,w)})},e.prototype.createCamera=function(t){var n=this.context.config,r=n.document,i=n.width,s=n.height,l=this.context.contextService.getDomElement(),u=l.parentNode;if(u){var h=xb,p=u.querySelector("#"+h);if(!p){var m=(r||document).createElement("div");m.style.overflow="hidden",m.style.pointerEvents="none",m.style.position="absolute",m.style.left="0px",m.style.top="0px",m.style.width="".concat(i||0,"px"),m.style.height="".concat(s||0,"px");var y=(r||document).createElement("div");p=y,y.id=h,y.style.position="absolute",y.style.left="".concat(l.offsetLeft||0,"px"),y.style.top="".concat(l.offsetTop||0,"px"),y.style.transformOrigin="left top",y.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),y.style.pointerEvents="none",y.style.width="100%",y.style.height="100%",m.appendChild(y),u.appendChild(m)}return p}return null},e.prototype.getOrCreateEl=function(t){var n=this.context.config.document,r=this.displayObjectHTMLElementMap.get(t);return r||(r=(n||document).createElement("div"),t.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(t,r),t.id&&(r.id=t.id),t.name&&r.setAttribute("name",t.name),t.className&&(r.className=t.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(t.getWorldTransform())),r},e.prototype.updateAttribute=function(t,n){var r=this.getOrCreateEl(n);switch(t){case"innerHTML":var i=n.parsedStyle.innerHTML;bi(i)?r.innerHTML=i:(r.innerHTML="",r.appendChild(i));break;case"x":r.style.left="".concat(n.parsedStyle.x,"px");break;case"y":r.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var s=n.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(s[0].value," ").concat(s[1].value);break;case"width":if(this.context.enableCSSParsing){var l=n.computedStyleMap().get("width");r.style.width=l.toString()}else{var l=n.parsedStyle.width;r.style.width=(0,Ft.Z)(l)?"".concat(l,"px"):l.toString()}break;case"height":if(this.context.enableCSSParsing){var u=n.computedStyleMap().get("height");r.style.height=u.toString()}else{var u=n.parsedStyle.height;r.style.height=(0,Ft.Z)(u)?"".concat(u,"px"):u.toString()}break;case"zIndex":var h=n.parsedStyle.zIndex;r.style["z-index"]="".concat(h);break;case"visibility":var p=n.parsedStyle.visibility;r.style.visibility=p;break;case"pointerEvents":var m=n.parsedStyle.pointerEvents,y=m===void 0?"auto":m;r.style.pointerEvents=y;break;case"opacity":var b=n.parsedStyle.opacity;r.style.opacity="".concat(b);break;case"fill":var w=n.parsedStyle.fill,R="";t0(w)?w.isNone?R="transparent":R=n.getAttribute("fill"):Array.isArray(w)?R=n.getAttribute("fill"):Wd(w),r.style.background=R;break;case"stroke":var M=n.parsedStyle.stroke,I="";t0(M)?M.isNone?I="transparent":I=n.getAttribute("stroke"):Array.isArray(M)?I=n.getAttribute("stroke"):Wd(M),r.style["border-color"]=I,r.style["border-style"]="solid";break;case"lineWidth":var N=n.parsedStyle.lineWidth;r.style["border-width"]="".concat(N||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var U=n.style.filter;r.style.filter=U;break;default:!(0,sr.Z)(n.style[t])&&n.style[t]!==""&&(r.style[t]=n.style[t])}},e.tag="HTMLRendering",e}(),Ww=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.name="html-renderer",n}return t.prototype.init=function(){this.addRenderingPlugin(new JM)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(Xc),Gw=function(){function e(t){this.canvasConfig=t,this.imageCache={},this.gradientCache={},this.patternCache={}}return e.prototype.getImageSync=function(t,n){return this.imageCache[t]?n&&n(this.imageCache[t]):this.getOrCreateImage(t).then(function(r){n&&n(r)}),this.imageCache[t]},e.prototype.getOrCreateImage=function(t){var n=this;if(this.imageCache[t])return Promise.resolve(this.imageCache[t]);var r=this.canvasConfig.createImage;return new Promise(function(i,s){var l;r?l=r(t):dl&&(l=new window.Image),l&&(l.onload=function(){n.imageCache[t]=l,i(l)},l.onerror=function(u){s(u)},l.crossOrigin="Anonymous",l.src=t)})},e.prototype.getOrCreatePatternSync=function(t,n,r,i,s,l){var u=this.generatePatternKey(t);if(u&&this.patternCache[u])return this.patternCache[u];var h=t.image,p=t.repetition,m=t.transform,y,b=!1;bi(h)?y=this.getImageSync(h,l):r?(y=r,b=!0):y=h;var w=y&&n.createPattern(y,p);if(w){var R=void 0;m?R=xo(av(m),new Sr({})):R=St.identity(St.create()),b&&St.scale(R,R,[1/i,1/i,1]),w.setTransform({a:R[0],b:R[1],c:R[4],d:R[5],e:R[12]+s[0],f:R[13]+s[1]})}return u&&w&&(this.patternCache[u]=w),w},e.prototype.getOrCreateGradient=function(t,n){var r=this.generateGradientKey(t),i=t.type,s=t.steps,l=t.min,u=t.width,h=t.height,p=t.angle,m=t.cx,y=t.cy,b=t.size;if(this.gradientCache[r])return this.gradientCache[r];var w=null;if(i===gl.LinearGradient){var R=lm(l,u,h,p),M=R.x1,I=R.y1,N=R.x2,U=R.y2;w=n.createLinearGradient(M,I,N,U)}else if(i===gl.RadialGradient){var Z=Sp(l,u,h,m,y,b),Y=Z.x,$=Z.y,J=Z.r;w=n.createRadialGradient(Y,$,0,Y,$,J)}return w&&(s.forEach(function(se){var pe=se.offset,Ce=se.color;pe.unit===Bn.kPercentage&&(w==null||w.addColorStop(pe.value/100,Ce.toString()))}),this.gradientCache[r]=w),this.gradientCache[r]},e.prototype.generateGradientKey=function(t){var n=t.type,r=t.min,i=t.width,s=t.height,l=t.steps,u=t.angle,h=t.cx,p=t.cy,m=t.size;return"gradient-".concat(n,"-").concat((u==null?void 0:u.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat((p==null?void 0:p.toString())||0,"-").concat((m==null?void 0:m.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(i,"-").concat(s,"-").concat(l.map(function(y){var b=y.offset,w=y.color;return"".concat(b).concat(w)}).join("-"))},e.prototype.generatePatternKey=function(t){var n=t.image,r=t.repetition;if(bi(n))return"pattern-".concat(n,"-").concat(r);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(r)},e}(),$2=function(){function e(){}return e.prototype.apply=function(t){var n=t.renderingService,r=t.renderingContext,i=t.imagePool,s=r.root.ownerDocument.defaultView,l=function(p,m,y){var b=p.parsedStyle,w=b.width,R=b.height;w&&!R?p.setAttribute("height",y/m*w):!w&&R&&p.setAttribute("width",m/y*R)},u=function(p){var m=p.target,y=m.nodeName,b=m.attributes;if(y===Gr.IMAGE){var w=b.src,R=b.keepAspectRatio;bi(w)&&i.getImageSync(w,function(M){var I=M.width,N=M.height;R&&l(m,I,N),m.renderable.dirty=!0,n.dirtify()})}},h=function(p){var m=p.target,y=p.attrName,b=p.newValue;m.nodeName===Gr.IMAGE&&y==="src"&&bi(b)&&i.getOrCreateImage(b).then(function(w){var R=w.width,M=w.height;m.attributes.keepAspectRatio&&l(m,R,M),m.renderable.dirty=!0,n.dirtify()})};n.hooks.init.tap(e.tag,function(){s.addEventListener(wa.MOUNTED,u),s.addEventListener(wa.ATTR_MODIFIED,h)}),n.hooks.destroy.tap(e.tag,function(){s.removeEventListener(wa.MOUNTED,u),s.removeEventListener(wa.ATTR_MODIFIED,h)})},e.tag="LoadImage",e}(),Xw=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.name="image-loader",n}return t.prototype.init=function(){this.context.imagePool=new Gw(this.context.config),this.addRenderingPlugin(new $2)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(Xc),Yw=function(){function e(t){this.renderingContext=t.renderingContext,this.canvasConfig=t.config}return e.prototype.init=function(){var t=this.canvasConfig,n=t.container,r=t.canvas;if(r)this.$canvas=r,n&&r.parentElement!==n&&n.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=bi(n)?document.getElementById(n):n,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},e.prototype.getContext=function(){return this.context},e.prototype.getDomElement=function(){return this.$canvas},e.prototype.getDPR=function(){return this.dpr},e.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},e.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},e.prototype.resize=function(t,n){var r=this.canvasConfig.devicePixelRatio,i=r||dl&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*n,ec(this.$canvas,t,n)),this.renderingContext.renderReasons.add(Oh.CAMERA_CHANGED)},e.prototype.applyCursorStyle=function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)},e.prototype.toDataURL=function(t){return t===void 0&&(t={}),(0,z.mG)(this,void 0,void 0,function(){var n,r;return(0,z.Jh)(this,function(i){return n=t.type,r=t.encoderOptions,[2,this.context.canvas.toDataURL(n,r)]})})},e}(),$w=function(e){(0,z.ZT)(t,e);function t(){var n=e.apply(this,(0,z.ev)([],(0,z.CR)(arguments),!1))||this;return n.name="canvas-context-register",n}return t.prototype.init=function(){this.context.ContextService=Yw},t.prototype.destroy=function(){delete this.context.ContextService},t}(Xc),K2=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n)||this;return r.registerPlugin(new $w),r.registerPlugin(new Xw),r.registerPlugin(new Iw),r.registerPlugin(new QM),r.registerPlugin(new Zw),r.registerPlugin(new jw),r.registerPlugin(new Ww),r}return t}(jd),Kw=function(){function e(t){this.dragndropPluginOptions=t}return e.prototype.apply=function(t){var n=this,r=t.renderingService,i=t.renderingContext,s=i.root.ownerDocument,l=s.defaultView,u=function(h){var p=h.target,m=p===s,y=m&&n.dragndropPluginOptions.isDocumentDraggable?s:p.closest&&p.closest("[draggable=true]");if(y){var b=!1,w=h.timeStamp,R=[h.clientX,h.clientY],M=null,I=[h.clientX,h.clientY],N=function(Z){return(0,z.mG)(n,void 0,void 0,function(){var Y,$,J,se,pe,Ce;return(0,z.Jh)(this,function(Ue){switch(Ue.label){case 0:if(!b){if(Y=Z.timeStamp-w,$=Dn([Z.clientX,Z.clientY],R),Y<=this.dragndropPluginOptions.dragstartTimeThreshold||$<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];Z.type="dragstart",y.dispatchEvent(Z),b=!0}return Z.type="drag",Z.dx=Z.clientX-I[0],Z.dy=Z.clientY-I[1],y.dispatchEvent(Z),I=[Z.clientX,Z.clientY],m?[3,2]:(J=this.dragndropPluginOptions.overlap==="pointer"?[Z.canvasX,Z.canvasY]:p.getBounds().center,[4,s.elementsFromPoint(J[0],J[1])]);case 1:se=Ue.sent(),pe=se[se.indexOf(p)+1],Ce=(pe==null?void 0:pe.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?s:null),M!==Ce&&(M&&(Z.type="dragleave",Z.target=M,M.dispatchEvent(Z)),Ce&&(Z.type="dragenter",Z.target=Ce,Ce.dispatchEvent(Z)),M=Ce,M&&(Z.type="dragover",Z.target=M,M.dispatchEvent(Z))),Ue.label=2;case 2:return[2]}})})};l.addEventListener("pointermove",N);var U=function(Z){if(b){Z.detail={preventClick:!0};var Y=Z.clone();M&&(Y.type="drop",Y.target=M,M.dispatchEvent(Y)),Y.type="dragend",y.dispatchEvent(Y),b=!1}l.removeEventListener("pointermove",N)};p.addEventListener("pointerup",U,{once:!0}),p.addEventListener("pointerupoutside",U,{once:!0})}};r.hooks.init.tap(e.tag,function(){l.addEventListener("pointerdown",u)}),r.hooks.destroy.tap(e.tag,function(){l.removeEventListener("pointerdown",u)})},e.tag="Dragndrop",e}(),q2=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=e.call(this)||this;return r.options=n,r.name="dragndrop",r}return t.prototype.init=function(){this.addRenderingPlugin(new Kw((0,z.pi)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t.prototype.setOptions=function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)},t}(Xc);function eP(e,t,n){var r;return function(){var i=this,s=arguments,l=function(){r=null,n||e.apply(i,s)},u=n&&!r;clearTimeout(r),r=setTimeout(l,t),u&&e.apply(i,s)}}var Q2=eP,Eb=function(e){return typeof e=="object"&&e!==null},Sb=Eb,qw=function(e){if(!Sb(e)||!(0,_i.Z)(e,"Object"))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},y0=qw,Qw=5;function Jw(e,t){if(Object.hasOwn)return Object.hasOwn(e,t);if(e==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)}function Tb(e,t,n,r){n=n||0,r=r||Qw;for(var i in t)if(Jw(t,i)){var s=t[i];s!==null&&y0(s)?(y0(e[i])||(e[i]={}),n<r?Tb(e[i],s,n+1,r):e[i]=t[i]):Is(s)?(e[i]=[],e[i]=e[i].concat(s)):s!==void 0&&(e[i]=s)}}var eA=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r+=1)Tb(e,t[r]);return e},ni=eA;class J2 extends Map{constructor(t,n=H1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(wb(this,t))}has(t){return super.has(wb(this,t))}set(t,n){return super.set(Ab(this,t),n)}delete(t){return super.delete(Cb(this,t))}}class tP extends null{constructor(t,n=H1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(wb(this,t))}add(t){return super.add(Ab(this,t))}delete(t){return super.delete(Cb(this,t))}}function wb({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Ab({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Cb({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function H1(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Im(e){return e}function vc(e,...t){return xv(e,Im,Im,t)}function Z1(e,...t){return xv(e,Array.from,Im,t)}function eE(e,t){for(let n=1,r=t.length;n<r;++n)e=e.flatMap(i=>i.pop().map(([s,l])=>[...i,s,l]));return e}function tA(e,...t){return eE(Z1(e,...t),t)}function nA(e,t,...n){return eE(G1(e,t,...n),n)}function W1(e,t,...n){return xv(e,Im,t,n)}function G1(e,t,...n){return xv(e,Array.from,t,n)}function nP(e,...t){return xv(e,identity,tE,t)}function rP(e,...t){return xv(e,Array.from,tE,t)}function tE(e){if(e.length!==1)throw new Error("duplicate key");return e[0]}function xv(e,t,n,r){return function i(s,l){if(l>=r.length)return n(s);const u=new J2,h=r[l++];let p=-1;for(const m of s){const y=h(m,++p,s),b=u.get(y);b?b.push(m):u.set(y,[m])}for(const[m,y]of u)u.set(m,i(y,l));return t(u)}(e,0)}var Ob=function(e){return(0,sr.Z)(e)?"":e.toString()},Ay=function(e){var t=Ob(e);return t.charAt(0).toLowerCase()+t.substring(1)},Rb=Ay,nE=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};function Ev(e){return e}function Cy(e){return e.reduce((t,n)=>(r,...i)=>n(t(r,...i),...i),Ev)}function rA(e){return e.reduce((t,n)=>r=>nE(this,void 0,void 0,function*(){const i=yield t(r);return n(i)}),Ev)}function Mb(e){return e.replace(/( |^)[a-z]/g,t=>t.toUpperCase())}function mg(e=""){throw new Error(e)}function Pb(e,t){const{attributes:n}=t,r=new Set(["id","className"]);for(const[i,s]of Object.entries(n))r.has(i)||e.attr(i,s)}function Ql(e){return e!=null&&!Number.isNaN(e)}function iP(e,t){return e+(t-e)*Math.random()}function iA(e){const t=new Map;return n=>{if(t.has(n))return t.get(n);const r=e(n);return t.set(n,r),r}}function oA(e,t){const{transform:n}=e.style,i=(s=>s==="none"||s===void 0)(n)?"":n;e.style.transform=`${i} ${t}`.trimStart()}function po(e,t){return rE(e,t)||{}}function rE(e,t){const n=Object.entries(e||{}).filter(([r])=>r.startsWith(t)).map(([r,i])=>[Rb(r.replace(t,"").trim()),i]).filter(([r])=>!!r);return n.length===0?null:Object.fromEntries(n)}function oP(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[`${t}${upperFirst(n)}`,r]))}function aA(e,t){return Object.fromEntries(Object.entries(e).filter(([n])=>t.find(r=>n.startsWith(r))))}function Ib(e,...t){return Object.fromEntries(Object.entries(e).filter(([n])=>t.every(r=>!n.startsWith(r))))}function iE(e,t){if(e===void 0)return null;if(typeof e=="number")return e;const n=+e.replace("%","");return Number.isNaN(n)?null:n/100*t}function vg(e){return typeof e=="object"&&!(e instanceof Date)&&e!==null&&!Array.isArray(e)}function X0(e){return e===null||e===!1}function oE(e,t,n=5,r=0){if(!(r>=n)){for(const i of Object.keys(t)){const s=t[i];!y0(s)||!y0(e[i])?e[i]=s:oE(e[i],s,n,r+1)}return e}}function Pa(e){return new Su([e],null,e,e.ownerDocument)}class Su{constructor(t=null,n=null,r=null,i=null,s=[null,null,null,null,null],l=[],u=[]){this._elements=Array.from(t),this._data=n,this._parent=r,this._document=i,this._enter=s[0],this._update=s[1],this._exit=s[2],this._merge=s[3],this._split=s[4],this._transitions=l,this._facetElements=u}selectAll(t){const n=typeof t=="string"?this._parent.querySelectorAll(t):t;return new Su(n,null,this._elements[0],this._document)}selectFacetAll(t){const n=typeof t=="string"?this._parent.querySelectorAll(t):t;return new Su(this._elements,null,this._parent,this._document,void 0,void 0,n)}select(t){const n=typeof t=="string"?this._parent.querySelectorAll(t)[0]||null:t;return new Su([n],null,n,this._document)}append(t){const n=typeof t=="function"?t:()=>this.createElement(t),r=[];if(this._data!==null){for(let i=0;i<this._data.length;i++){const s=this._data[i],[l,u]=Array.isArray(s)?s:[s,null],h=n(l,i);h.__data__=l,u!==null&&(h.__fromElements__=u),this._parent.appendChild(h),r.push(h)}return new Su(r,null,this._parent,this._document)}else{for(let i=0;i<this._elements.length;i++){const s=this._elements[i],l=s.__data__,u=n(l,i);s.appendChild(u),r.push(u)}return new Su(r,null,r[0],this._document)}}maybeAppend(t,n,r){const i=this._elements[0],s=i.getElementById(t);if(s)return new Su([s],null,this._parent,this._document);const l=typeof n=="string"?this.createElement(n):n();return l.id=t,r&&(l.className=r),i.appendChild(l),new Su([l],null,this._parent,this._document)}data(t,n=i=>i,r=()=>null){const i=[],s=[],l=new Set(this._elements),u=[],h=new Set,p=new Map(this._elements.map((w,R)=>[n(w.__data__,R),w])),m=new Map(this._facetElements.map((w,R)=>[n(w.__data__,R),w])),y=vc(this._elements,w=>r(w.__data__));for(let w=0;w<t.length;w++){const R=t[w],M=n(R,w),I=r(R,w);if(p.has(M)){const N=p.get(M);N.__data__=R,N.__facet__=!1,s.push(N),l.delete(N),p.delete(M)}else if(m.has(M)){const N=m.get(M);N.__data__=R,N.__facet__=!0,s.push(N),m.delete(M)}else if(y.has(M)){const N=y.get(M);u.push([R,N]);for(const U of N)l.delete(U);y.delete(M)}else if(p.has(I)){const N=p.get(I);N.__toData__?N.__toData__.push(R):N.__toData__=[R],h.add(N),l.delete(N)}else i.push(R)}const b=[new Su([],i,this._parent,this._document),new Su(s,null,this._parent,this._document),new Su(l,null,this._parent,this._document),new Su([],u,this._parent,this._document),new Su(h,null,this._parent,this._document)];return new Su(this._elements,null,this._parent,this._document,b)}merge(t){const n=[...this._elements,...t._elements],r=[...this._transitions,...t._transitions];return new Su(n,null,this._parent,this._document,void 0,r)}createElement(t){if(this._document)return this._document.createElement(t,{});const n=Su.registry[t];return n?new n:mg(`Unknown node type: ${t}`)}join(t=l=>l,n=l=>l,r=l=>l.remove(),i=l=>l,s=l=>l.remove()){const l=t(this._enter),u=n(this._update),h=r(this._exit),p=i(this._merge),m=s(this._split);return u.merge(l).merge(h).merge(p).merge(m)}remove(){for(let t=0;t<this._elements.length;t++){const n=this._transitions[t];if(n){const r=Array.isArray(n)?n:[n];Promise.all(r.map(i=>i.finished)).then(()=>{this._elements[t].remove()})}else this._elements[t].remove()}return new Su([],null,this._parent,this._document,void 0,this._transitions)}each(t){for(let n=0;n<this._elements.length;n++){const r=this._elements[n],i=r.__data__;t(i,n,r)}return this}attr(t,n){const r=typeof n!="function"?()=>n:n;return this.each(function(i,s,l){n!==void 0&&(l[t]=r(i,s,l))})}style(t,n){const r=typeof n!="function"?()=>n:n;return this.each(function(i,s,l){n!==void 0&&(l.style[t]=r(i,s,l))})}transition(t){const n=typeof t!="function"?()=>t:t,{_transitions:r}=this;return this.each(function(i,s,l){r[s]=n(i,s,l)})}on(t,n){return this.each(function(r,i,s){s.addEventListener(t,n)}),this}call(t,...n){return t(this,...n),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}}Su.registry={g:Ci,rect:yo,circle:Ir,path:Wi,text:ma,ellipse:Pi,image:ao,line:Po,polygon:Aa,polyline:ea,html:Ao};const El={BEFORE_RENDER:"beforerender",AFTER_RENDER:"afterrender",BEFORE_PAINT:"beforepaint",AFTER_PAINT:"afterpaint",BEFORE_CHANGE_DATA:"beforechangedata",AFTER_CHANGE_DATA:"afterchangedata",BEFORE_CLEAR:"beforeclear",AFTER_CLEAR:"afterclear",BEFORE_DESTROY:"beforedestroy",AFTER_DESTROY:"afterdestroy",BEFORE_CHANGE_SIZE:"beforechangesize",AFTER_CHANGE_SIZE:"afterchangesize",POINTER_TAP:"pointertap",POINTER_DOWN:"pointerdown",POINTER_UP:"pointerup",POINTER_OVER:"pointerover",POINTER_OUT:"pointerout",POINTER_MOVE:"pointermove",POINTER_ENTER:"pointerenter",POINTER_LEAVE:"pointerleave",POINTER_UPOUTSIDE:"pointerupoutside",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"DROP",CLICK:"click",DBLCLICK:"dblclick"};var sA=function(e){var t=Ob(e);return t.charAt(0).toUpperCase()+t.substring(1)},Sv=sA;function lA(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function gg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function cA(e){return e=gg(Math.abs(e)),e?e[1]:NaN}function uA(e,t){return function(n,r){for(var i=n.length,s=[],l=0,u=e[0],h=0;i>0&&u>0&&(h+u+1>r&&(u=Math.max(1,r-h)),s.push(n.substring(i-=u,i+u)),!((h+=u+1)>r));)u=e[l=(l+1)%e.length];return s.reverse().join(t)}}function fA(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var hA=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Lb(e){if(!(t=hA.exec(e)))throw new Error("invalid format: "+e);var t;return new Tv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Lb.prototype=Tv.prototype;function Tv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Tv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Oy(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var aE;function dA(e,t){var n=gg(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(aE=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+gg(e,Math.max(0,t+s-1))[0]}function sE(e,t){var n=gg(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Db={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:lA,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>sE(e*100,t),r:sE,s:dA,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function lE(e){return e}var cE=Array.prototype.map,uE=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function pA(e){var t=e.grouping===void 0||e.thousands===void 0?lE:uA(cE.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?lE:fA(cE.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"\u2212":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function p(y){y=Lb(y);var b=y.fill,w=y.align,R=y.sign,M=y.symbol,I=y.zero,N=y.width,U=y.comma,Z=y.precision,Y=y.trim,$=y.type;$==="n"?(U=!0,$="g"):Db[$]||(Z===void 0&&(Z=12),Y=!0,$="g"),(I||b==="0"&&w==="=")&&(I=!0,b="0",w="=");var J=M==="$"?n:M==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",se=M==="$"?r:/[%p]/.test($)?l:"",pe=Db[$],Ce=/[defgprs%]/.test($);Z=Z===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z));function Ue(Je){var lt=J,Ge=se,at,st,ft;if($==="c")Ge=pe(Je)+Ge,Je="";else{Je=+Je;var Vt=Je<0||1/Je<0;if(Je=isNaN(Je)?h:pe(Math.abs(Je),Z),Y&&(Je=Oy(Je)),Vt&&+Je==0&&R!=="+"&&(Vt=!1),lt=(Vt?R==="("?R:u:R==="-"||R==="("?"":R)+lt,Ge=($==="s"?uE[8+aE/3]:"")+Ge+(Vt&&R==="("?")":""),Ce){for(at=-1,st=Je.length;++at<st;)if(ft=Je.charCodeAt(at),48>ft||ft>57){Ge=(ft===46?i+Je.slice(at+1):Je.slice(at))+Ge,Je=Je.slice(0,at);break}}}U&&!I&&(Je=t(Je,1/0));var wt=lt.length+Je.length+Ge.length,zt=wt<N?new Array(N-wt+1).join(b):"";switch(U&&I&&(Je=t(zt+Je,zt.length?N-Ge.length:1/0),zt=""),w){case"<":Je=lt+Je+Ge+zt;break;case"=":Je=lt+zt+Je+Ge;break;case"^":Je=zt.slice(0,wt=zt.length>>1)+lt+Je+Ge+zt.slice(wt);break;default:Je=zt+lt+Je+Ge;break}return s(Je)}return Ue.toString=function(){return y+""},Ue}function m(y,b){var w=p((y=Lb(y),y.type="f",y)),R=Math.max(-8,Math.min(8,Math.floor(cA(b)/3)))*3,M=Math.pow(10,-R),I=uE[8+R/3];return function(N){return w(M*N)+I}}return{format:p,formatPrefix:m}}var X1,Lm,mA;vA({thousands:",",grouping:[3],currency:["$",""]});function vA(e){return X1=pA(e),Lm=X1.format,mA=X1.formatPrefix,X1}function _0(e,t){return Object.entries(e).reduce((n,[r,i])=>(n[r]=t(i,r,e),n),{})}function wv(e){return e.map((t,n)=>n)}function aP(e){const t=e.length,n=e[0].length,r=new Array(n).fill(0).map(()=>new Array(t));for(let i=0;i<n;i++)for(let s=0;s<t;s++)r[i][s]=e[s][i];return r}function gA(e){return e[0]}function fE(e){return e[e.length-1]}function sP(e){return!e.some(Array.isArray)}function lP(e){return Array.from(new Set(e))}function hE(e,t){const n=[[],[]];return e.forEach(r=>{n[t(r)?0:1].push(r)}),n}function Y1(e,t=e.length){if(t===1)return e.map(r=>[r]);const n=[];for(let r=0;r<e.length;r++){const i=e.slice(r+1);Y1(i,t-1).forEach(l=>{n.push([e[r],...l])})}return n}function yA(e){if(e.length===1)return[e];const t=[];for(let n=1;n<=e.length;n++)t.push(...Y1(e,n));return t}var _A=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},ap=_A,Nb=function(e,t){if(e===t)return!0;if(!e||!t||bi(e)||bi(t))return!1;if(ap(e)||ap(t)){if(e.length!==t.length)return!1;for(var n=!0,r=0;r<e.length&&(n=Nb(e[r],t[r]),!!n);r++);return n}if(Sb(e)||Sb(t)){var i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(var n=!0,r=0;r<i.length&&(n=Nb(e[i[r]],t[i[r]]),!!n);r++);return n}return!1},dE=Nb;function sp(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Sl(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Tk(e){return e*Math.PI/180}function cP(e){return e*180/Math.PI}function bA(e,t){return e=e%(2*Math.PI),t=t%(2*Math.PI),e<0&&(e=2*Math.PI+e),t<0&&(t=2*Math.PI+t),e>=t&&(t=t+2*Math.PI),{startAngle:e,endAngle:t}}const pE=(e={})=>{const t={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1},n=Object.assign(Object.assign({},t),e);return Object.assign(Object.assign({},n),bA(n.startAngle,n.endAngle))},Ry=e=>{const{startAngle:t,endAngle:n,innerRadius:r,outerRadius:i}=pE(e);return[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",t,n,r,i]]};Ry.props={};const mE=(e={})=>{const t={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},t),e)},Bb=e=>{const{startAngle:t,endAngle:n,innerRadius:r,outerRadius:i}=mE(e);return[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...Ry({startAngle:t,endAngle:n,innerRadius:r,outerRadius:i})]};Bb.props={};function Fb(e,t,n){return Math.max(t,Math.min(e,n))}function $1(e,t=10){return typeof e!="number"||Math.abs(e)<1e-15?e:parseFloat(e.toFixed(t))}const vE=[["legendCategory",[[["color","discrete"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","discrete"]],[["color","discrete"],["opacity","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"]],[["color","discrete"],["opacity","constant"],["size","constant"]],[["color","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"]],[["color","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["shape","discrete"]],[["color","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"]],[["color","discrete"],["opacity","constant"]],[["color","discrete"],["shape","constant"]],[["color","constant"],["shape","discrete"]],[["color","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"]],[["color","discrete"]]]],["legendContinuousSize",[[["color","continuous"],["opacity","continuous"],["size","continuous"]],[["color","constant"],["opacity","continuous"],["size","continuous"]],[["color","continuous"],["size","continuous"]],[["color","constant"],["size","continuous"]],[["size","continuous"],["opacity","continuous"]],[["size","continuous"]]]],["legendContinuousBlockSize",[[["color","distribution"],["opacity","distribution"],["size","distribution"]],[["color","distribution"],["size","distribution"]]]],["legendContinuousBlock",[[["color","distribution"],["opacity","continuous"]],[["color","distribution"]]]],["legendContinuous",[[["color","continuous"],["opacity","continuous"]],[["color","continuous"]],[["opacity","continuous"]]]]];var gE=D(17816);function gc(e){const{transformations:t}=e.getOptions();return t.map(([r])=>r).filter(r=>r==="transpose").length%2!==0}function Ml(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="polar")}function My(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="reflect")&&t.some(([n])=>n.startsWith("transpose"))}function kb(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="helix")}function Py(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="parallel")}function yE(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="fisheye")}function xA(e){return Py(e)&&Ml(e)}function yg(e){return kb(e)||Ml(e)}function _E(e){return Ml(e)&&gc(e)}function uP(e){return Ml(e)||Py(e)||My(e)||_E(e)}function EA(e){if(yg(e)){const[t,n]=e.getSize(),r=e.getOptions().transformations.find(i=>i[0]==="polar");if(r)return Math.max(t,n)/2*r[4]}return 0}function K1(e){const{transformations:t}=e.getOptions(),[,,,n,r]=t.find(i=>i[0]==="polar");return[+n,+r]}function bE(e,t=!0){const{transformations:n}=e.getOptions(),[,r,i]=n.find(s=>s[0]==="polar");return t?[+r*180/Math.PI,+i*180/Math.PI]:[r,i]}function SA(e,t){const{transformations:n}=e.getOptions(),[,...r]=n.find(i=>i[0]===t);return r}function q1(e,t){t(e),e.children&&e.children.forEach(function(n){n&&q1(n,t)})}function Iy(e){Q1(e,!0)}function Dm(e){Q1(e,!1)}function Q1(e,t){var n=t?"visible":"hidden";q1(e,function(r){r.attr("visibility",n)})}function TA(e){return typeof e=="boolean"?!1:"enter"in e&&"update"in e&&"exit"in e}function xE(e){if(!e)return{enter:!1,update:!1,exit:!1};var t=["enter","update","exit"],n=Object.fromEntries(Object.entries(e).filter(function(r){var i=(0,z.CR)(r,1),s=i[0];return!t.includes(s)}));return Object.fromEntries(t.map(function(r){return TA(e)?e[r]===!1?[r,!1]:[r,(0,z.pi)((0,z.pi)({},e[r]),n)]:[r,n]}))}function _g(e,t){e?e.finished.then(t):t()}function J1(e,t){e.length===0?t():Promise.all(e.map(function(n){return n==null?void 0:n.finished})).then(t)}function EE(e,t){"update"in e?e.update(t):e.attr(t)}function SE(e,t,n){if(t.length===0)return null;if(!n){var r=t.slice(-1)[0];return EE(e,{style:r}),null}return e.animate(t,n)}function wA(e,t){return!(e.nodeName!=="text"||t.nodeName!=="text"||e.attributes.text!==t.attributes.text)}function AA(e,t,n,r){if(r===void 0&&(r="destroy"),wA(e,t))return e.remove(),[null];var i=function(){r==="destroy"?e.destroy():r==="hide"&&Dm(e),t.isVisible()&&Iy(t)};if(!n)return i(),[null];var s=n.duration,l=s===void 0?0:s,u=n.delay,h=u===void 0?0:u,p=Math.ceil(+l/2),m=+l/4,y=(0,z.CR)(e.getGeometryBounds().center,2),b=y[0],w=y[1],R=(0,z.CR)(t.getGeometryBounds().center,2),M=R[0],I=R[1],N=(0,z.CR)([(b+M)/2-b,(w+I)/2-w],2),U=N[0],Z=N[1],Y=e.style.opacity,$=Y===void 0?1:Y,J=t.style.opacity,se=J===void 0?1:J,pe=e.style.transform||"",Ce=t.style.transform||"",Ue=e.animate([{opacity:$,transform:"translate(0, 0) ".concat(pe)},{opacity:0,transform:"translate(".concat(U,", ").concat(Z,") ").concat(pe)}],(0,z.pi)((0,z.pi)({fill:"both"},n),{duration:h+p+m})),Je=t.animate([{opacity:0,transform:"translate(".concat(-U,", ").concat(-Z,") ").concat(Ce),offset:.01},{opacity:se,transform:"translate(0, 0) ".concat(Ce)}],(0,z.pi)((0,z.pi)({fill:"both"},n),{duration:p+m,delay:h+p-m}));return _g(Je,i),[Ue,Je]}function b0(e,t,n){var r={},i={};return Object.entries(t).forEach(function(s){var l=(0,z.CR)(s,2),u=l[0],h=l[1];if(!(0,sr.Z)(h)){var p=e.style[u]||e.parsedStyle[u]||0;p!==h&&(r[u]=p,i[u]=h)}}),n?SE(e,[r,i],(0,z.pi)({fill:"both"},n)):(EE(e,i),null)}var fP=5,TE=function(e,t,n,r){n===void 0&&(n=0),r===void 0&&(r=fP),Object.entries(t).forEach(function(i){var s=(0,z.CR)(i,2),l=s[0],u=s[1],h=e;Object.prototype.hasOwnProperty.call(t,l)&&(u?y0(u)?(y0(e[l])||(h[l]={}),n<r?TE(e[l],u,n+1,r):h[l]=t[l]):Is(u)?(h[l]=[],h[l]=h[l].concat(u)):h[l]=u:h[l]=u)})},Y0=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r+=1)TE(e,t[r]);return e},hP=function(e){(0,z.ZT)(t,e);function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.apply(this,(0,z.ev)([],(0,z.CR)(n),!1))||this;return i.isMutationObserved=!0,i.addEventListener(wa.INSERTED,function(){Dm(i)}),i}return t}(Ci);function wE(e){var t=e.appendChild(new hP({class:"offscreen"}));return Dm(t),t}function CA(e){for(var t=e;t;){if(t.className==="offscreen")return!0;t=t.parent}return!1}function OA(){Q1(this,this.attributes.visibility!=="hidden")}var Af=function(e){(0,z.ZT)(t,e);function t(n,r){r===void 0&&(r={});var i=e.call(this,Y0({},{style:r},n))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=wE(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},t.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},t.prototype.attributeChangedCallback=function(n){n==="visibility"&&OA.call(this)},t.prototype.update=function(n,r){var i;return this.attr(Y0({},this.attributes,n||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},t.prototype.clear=function(){this.removeChildren()},t.prototype.bindEvents=function(n,r){},t.prototype.getSubShapeStyle=function(n){var r=n.x,i=n.y,s=n.transform,l=n.transformOrigin,u=n.class,h=n.className,p=n.zIndex,m=(0,z._T)(n,["x","y","transform","transformOrigin","class","className","zIndex"]);return m},t}(Xr);function sd(e,t,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(s){s.node().removeChildren()}),e?n(t):(r&&i(t),null)}function AE(e,t){if(e.length<=t)return e;for(var n=Math.floor(e.length/t),r=[],i=0;i<e.length;i+=n)r.push(e[i]);return r}var Ly=function(e){(0,z.ZT)(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=(0,z._T)(n,["style"]);return e.call(this,(0,z.pi)({style:(0,z.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=wE(this)),this._offscreen},enumerable:!1,configurable:!0}),t.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},t}(ma);function RA(e,t){var n=new Map;return e.forEach(function(r){var i=t(r);n.has(i)||n.set(i,[]),n.get(i).push(r)}),n}function MA(e){throw new Error(e)}var CE=function(){function e(i,s,l,u,h,p,m){i===void 0&&(i=null),s===void 0&&(s=null),l===void 0&&(l=null),u===void 0&&(u=null),h===void 0&&(h=[null,null,null,null,null]),p===void 0&&(p=[]),m===void 0&&(m=[]),t.add(this),this._elements=Array.from(i),this._data=s,this._parent=l,this._document=u,this._enter=h[0],this._update=h[1],this._exit=h[2],this._merge=h[3],this._split=h[4],this._transitions=p,this._facetElements=m}e.prototype.selectAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new n(s,null,this._elements[0],this._document)},e.prototype.selectFacetAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new n(this._elements,null,this._parent,this._document,void 0,void 0,s)},e.prototype.select=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new n([s],null,s,this._document)},e.prototype.append=function(i){var s=this,l=typeof i=="function"?i:function(){return s.createElement(i)},u=[];if(this._data!==null){for(var h=0;h<this._data.length;h++){var p=this._data[h],m=(0,z.CR)(Array.isArray(p)?p:[p,null],2),y=m[0],b=m[1],w=l(y,h);w.__data__=y,b!==null&&(w.__fromElements__=b),this._parent.appendChild(w),u.push(w)}return new n(u,null,this._parent,this._document)}for(var h=0;h<this._elements.length;h++){var R=this._elements[h],y=R.__data__,w=l(y,h);R.appendChild(w),u.push(w)}return new n(u,null,u[0],this._document)},e.prototype.maybeAppend=function(i,s){var l=(0,z.Q_)(this,t,"m",r).call(this,i[0]==="#"?i:"#".concat(i),s);return l.attr("id",i),l},e.prototype.maybeAppendByClassName=function(i,s){var l=i.toString(),u=(0,z.Q_)(this,t,"m",r).call(this,l[0]==="."?l:".".concat(l),s);return u.attr("className",l),u},e.prototype.maybeAppendByName=function(i,s){var l=(0,z.Q_)(this,t,"m",r).call(this,'[name="'.concat(i,'"]'),s);return l.attr("name",i),l},e.prototype.data=function(i,s,l){var u,h;s===void 0&&(s=function(Ue){return Ue}),l===void 0&&(l=function(){return null});for(var p=[],m=[],y=new Set(this._elements),b=[],w=new Set,R=new Map(this._elements.map(function(Ue,Je){return[s(Ue.__data__,Je),Ue]})),M=new Map(this._facetElements.map(function(Ue,Je){return[s(Ue.__data__,Je),Ue]})),I=RA(this._elements,function(Ue){return l(Ue.__data__)}),N=0;N<i.length;N++){var U=i[N],Z=s(U,N),Y=l(U,N);if(R.has(Z)){var $=R.get(Z);$.__data__=U,$.__facet__=!1,m.push($),y.delete($),R.delete(Z)}else if(M.has(Z)){var $=M.get(Z);$.__data__=U,$.__facet__=!0,m.push($),M.delete(Z)}else if(I.has(Z)){var J=I.get(Z);b.push([U,J]);try{for(var se=(u=void 0,(0,z.XA)(J)),pe=se.next();!pe.done;pe=se.next()){var $=pe.value;y.delete($)}}catch(Ue){u={error:Ue}}finally{try{pe&&!pe.done&&(h=se.return)&&h.call(se)}finally{if(u)throw u.error}}I.delete(Z)}else if(R.has(Y)){var $=R.get(Y);$.__toData__?$.__toData__.push(U):$.__toData__=[U],w.add($),y.delete($)}else p.push(U)}var Ce=[new n([],p,this._parent,this._document),new n(m,null,this._parent,this._document),new n(y,null,this._parent,this._document),new n([],b,this._parent,this._document),new n(w,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,Ce)},e.prototype.merge=function(i){var s=(0,z.ev)((0,z.ev)([],(0,z.CR)(this._elements),!1),(0,z.CR)(i._elements),!1),l=(0,z.ev)((0,z.ev)([],(0,z.CR)(this._transitions),!1),(0,z.CR)(i._transitions),!1);return new n(s,null,this._parent,this._document,void 0,l)},e.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var s=n.registry[i];return s?new s:MA("Unknown node type: ".concat(i))},e.prototype.join=function(i,s,l,u,h){i===void 0&&(i=function(R){return R}),s===void 0&&(s=function(R){return R}),l===void 0&&(l=function(R){return R.remove()}),u===void 0&&(u=function(R){return R}),h===void 0&&(h=function(R){return R.remove()});var p=i(this._enter),m=s(this._update),y=l(this._exit),b=u(this._merge),w=h(this._split);return m.merge(p).merge(y).merge(b).merge(w)},e.prototype.remove=function(){for(var i=function(u){var h=s._elements[u],p=s._transitions[u];p?p.then(function(){return h.remove()}):h.remove()},s=this,l=0;l<this._elements.length;l++)i(l);return new n([],null,this._parent,this._document,void 0,this._transitions)},e.prototype.each=function(i){for(var s=0;s<this._elements.length;s++){var l=this._elements[s],u=l.__data__;i.call(l,u,s)}return this},e.prototype.attr=function(i,s){var l=typeof s!="function"?function(){return s}:s;return this.each(function(u,h){s!==void 0&&(this[i]=l.call(this,u,h))})},e.prototype.style=function(i,s,l){l===void 0&&(l=!0);var u=typeof s!="function"||!l?function(){return s}:s;return this.each(function(h,p){s!==void 0&&(this.style[i]=u.call(this,h,p))})},e.prototype.styles=function(i,s){return i===void 0&&(i={}),s===void 0&&(s=!0),this.each(function(l,u){var h=this;Object.entries(i).forEach(function(p){var m=(0,z.CR)(p,2),y=m[0],b=m[1],w=typeof b!="function"||!s?function(){return b}:b;b!==void 0&&h.attr(y,w.call(h,l,u))})})},e.prototype.update=function(i,s){s===void 0&&(s=!0);var l=typeof i!="function"||!s?function(){return i}:i;return this.each(function(u,h){i&&this.update&&this.update(l.call(this,u,h))})},e.prototype.maybeUpdate=function(i,s){s===void 0&&(s=!0);var l=typeof i!="function"||!s?function(){return i}:i;return this.each(function(u,h){i&&this.update&&this.update(l.call(this,u,h))})},e.prototype.transition=function(i){var s=this._transitions;return this.each(function(l,u){s[u]=i.call(this,l,u)})},e.prototype.on=function(i,s){return this.each(function(){this.addEventListener(i,s)}),this},e.prototype.call=function(i){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return i.call.apply(i,(0,z.ev)([this._parent,this],(0,z.CR)(s),!1)),this},e.prototype.node=function(){return this._elements[0]},e.prototype.nodes=function(){return this._elements},e.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},e.prototype.parent=function(){return this._parent};var t,n,r;return n=e,t=new WeakSet,r=function(s,l){var u=this._elements[0],h=u.querySelector(s);if(h)return new n([h],null,this._parent,this._document);var p=typeof l=="string"?this.createElement(l):l();return u.appendChild(p),new n([p],null,this._parent,this._document)},e.registry={g:Ci,rect:yo,circle:Ir,path:Wi,text:Ly,ellipse:Pi,image:ao,line:Po,polygon:Aa,polyline:ea,html:Ao},e}();function $a(e){return new CE([e],null,e,e.ownerDocument)}function PA(e,t,n){return e.querySelector(t)?$a(e).select(t):$a(e).append(n)}var lp=function(e,t){var n=function(i){return"".concat(t,"-").concat(i)},r=Object.fromEntries(Object.entries(e).map(function(i){var s=(0,z.CR)(i,2),l=s[0],u=s[1],h=n(u);return[l,{name:h,class:".".concat(h),id:"#".concat(h),toString:function(){return h}}]}));return Object.assign(r,{prefix:n}),r},e_={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Wi({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},zb=ni({},e_,{style:{type:"arc"}}),dP=ni({},e_,{style:{}}),nl=lp({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),Ih=function(e){return typeof e=="function"};function $0(e,t){return[e[0]*t,e[1]*t]}function Dy(e,t){return[e[0]+t[0],e[1]+t[1]]}function Ub(e,t){return[e[0]-t[0],e[1]-t[1]]}function Cf(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]}function cp(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}function Ny(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function _o(e){if(e[0]===0&&e[1]===0)return[0,0];var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return[e[0]/t,e[1]/t]}function pP(e,t,n){var r=__read(e,2),i=r[0],s=r[1],l=__read(t,2),u=l[0],h=l[1],p=i-u,m=s-h,y=Math.sin(n),b=Math.cos(n);return[p*b-m*y+u,p*y+m*b+h]}function OE(e,t){return t?[e[1],-e[0]]:[-e[1],e[0]]}function Tn(e){return e*Math.PI/180}function Ds(e){return Number((e*180/Math.PI).toPrecision(5))}function Ya(e){return e.toString().charAt(0).toUpperCase()+e.toString().slice(1)}function By(e){return e.toString().charAt(0).toLowerCase()+e.toString().slice(1)}function ld(e,t){return"".concat(t).concat(Ya(e))}function ls(e,t,n){var r;n===void 0&&(n=!0);var i=t||((r=e.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",s=e.replace(new RegExp("^(".concat(i,")")),"");return n?By(s):s}function hf(e,t){Object.entries(t).forEach(function(n){var r=(0,z.CR)(n,2),i=r[0],s=r[1];(0,z.ev)([e],(0,z.CR)(e.querySelectorAll(i)),!1).filter(function(l){return l.matches(i)}).forEach(function(l){if(l){var u=l;u.style.cssText+=Object.entries(s).reduce(function(h,p){return"".concat(h).concat(p.join(":"),";")},"")}})})}var Of=function(e,t){if(!(e!=null&&e.startsWith(t)))return!1;var n=e[t.length];return n>="A"&&n<="Z"};function sa(e,t,n){n===void 0&&(n=!1);var r={};return Object.entries(e).forEach(function(i){var s=(0,z.CR)(i,2),l=s[0],u=s[1];if(!(l==="className"||l==="class")){if(Of(l,"show")&&Of(ls(l,"show"),t)!==n)l===ld(t,"show")?r[l]=u:r[l.replace(new RegExp(Ya(t)),"")]=u;else if(!Of(l,"show")&&Of(l,t)!==n){var h=ls(l,t);h==="filter"&&typeof u=="function"||(r[h]=u)}}}),r}function Hl(e,t){return Object.entries(e).reduce(function(n,r){var i=(0,z.CR)(r,2),s=i[0],l=i[1];return s.startsWith("show")?n["show".concat(t).concat(s.slice(4))]=l:n["".concat(t).concat(Ya(s))]=l,n},{})}function Pl(e,t){t===void 0&&(t=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(e).forEach(function(s){var l=(0,z.CR)(s,2),u=l[0],h=l[1];t.includes(u)||(n.indexOf(u)!==-1?i[u]=h:r[u]=h)}),[r,i]}function Ss(e,t){return Ih(e)?e.apply(void 0,(0,z.ev)([],(0,z.CR)(t),!1)):e}function cd(e,t){return e.style.opacity||(e.style.opacity=1),b0(e,{opacity:0},t)}var Av=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function RE(e){return Av.includes(e)}function rs(e){var t={};for(var n in e)RE(n)&&(t[n]=e[n]);return t}var hu=lp({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function Ku(e){return e.reduce(function(t,n,r){return t.push((0,z.ev)([r===0?"M":"L"],(0,z.CR)(n),!1)),t},[])}function Cc(e,t,n){var r=t.connect,i=r===void 0?"line":r,s=t.center;if(i==="line")return Ku(e);if(!s)return[];var l=Ny(e[0],s),u=n?0:1;return e.reduce(function(h,p,m){return m===0?h.push((0,z.ev)(["M"],(0,z.CR)(p),!1)):h.push((0,z.ev)(["A",l,l,0,0,u],(0,z.CR)(p),!1)),h},[])}function ME(e,t,n){return t.type==="surround"?Cc(e,t,n):Ku(e)}function Oc(e,t,n){var r=n.type,i=n.connect,s=n.center,l=n.closed,u=l?[["Z"]]:[],h=(0,z.CR)([ME(e,n),ME(t.slice().reverse(),n,!0)],2),p=h[0],m=h[1],y=(0,z.CR)([e[0],t.slice(-1)[0]],2),b=y[0],w=y[1],R=function(U,Z){return[p,U,m,Z,u].flat()};if(i==="line"||r==="surround")return R([(0,z.ev)(["L"],(0,z.CR)(w),!1)],[(0,z.ev)(["L"],(0,z.CR)(b),!1)]);if(!s)throw new Error("Arc grid need to specified center");var M=(0,z.CR)([Ny(w,s),Ny(b,s)],2),I=M[0],N=M[1];return R([(0,z.ev)(["A",I,I,0,0,1],(0,z.CR)(w),!1),(0,z.ev)(["L"],(0,z.CR)(w),!1)],[(0,z.ev)(["A",N,N,0,0,0],(0,z.CR)(b),!1),(0,z.ev)(["L"],(0,z.CR)(b),!1)])}function Vp(e,t,n,r){var i=n.animate,s=n.isBillboard,l=t.map(function(u,h){return{id:u.id||"grid-line-".concat(h),d:ME(u.points,n)}});return e.selectAll(hu.line.class).data(l,function(u){return u.id}).join(function(u){return u.append("path").each(function(h,p){var m=Ss(rs((0,z.pi)({d:h.d},r)),[h,p,l]);this.attr((0,z.pi)({class:hu.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:s},m))})},function(u){return u.transition(function(h,p){var m=Ss(rs((0,z.pi)({d:h.d},r)),[h,p,l]);return b0(this,m,i.update)})},function(u){return u.transition(function(){var h=this,p=cd(this,i.exit);return _g(p,function(){return h.remove()}),p})}).transitions()}function bg(e,t,n){var r=n.animate,i=n.connect,s=n.areaFill;if(t.length<2||!s||!i)return[];for(var l=Array.isArray(s)?s:[s,"transparent"],u=function(R){return l[R%l.length]},h=[],p=0;p<t.length-1;p++){var m=(0,z.CR)([t[p].points,t[p+1].points],2),y=m[0],b=m[1],w=Oc(y,b,n);h.push({d:w,fill:u(p)})}return e.selectAll(hu.region.class).data(h,function(R,M){return M}).join(function(R){return R.append("path").each(function(M,I){var N=Ss(M,[M,I,h]);this.attr(N)}).attr("className",hu.region.name)},function(R){return R.transition(function(M,I){var N=Ss(M,[M,I,h]);return b0(this,N,r.update)})},function(R){return R.transition(function(){var M=this,I=cd(this,r.exit);return _g(I,function(){return M.remove()}),I})}).transitions()}function t_(e){var t=e.data,n=t===void 0?[]:t,r=e.closed;return r?n.map(function(i){var s=i.points,l=(0,z.CR)(s,1),u=l[0];return(0,z.pi)((0,z.pi)({},i),{points:(0,z.ev)((0,z.ev)([],(0,z.CR)(s),!1),[u],!1)})}):n}var oi=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(n,r){var i=n.type,s=n.center,l=n.areaFill,u=n.closed,h=(0,z._T)(n,["type","center","areaFill","closed"]),p=t_(n),m=$a(r).maybeAppendByClassName(hu.lineGroup,"g"),y=$a(r).maybeAppendByClassName(hu.regionGroup,"g"),b=Vp(m,p,n,h),w=bg(y,p,n);return(0,z.ev)((0,z.ev)([],(0,z.CR)(b),!1),(0,z.CR)(w),!1)},t}(Af),Bi=function(e,t,n){for(var r=0,i=bi(t)?t.split("."):t;e&&r<i.length;)e=e[i[r++]];return e===void 0||r<i.length?n:e},mP=function(e,t){return function(n){return e*(1-n)+t*n}};function mo(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0;return function(i){var s=new Array(r),l=new Array(n),u=0;for(u=0;u<r;++u)s[u]=or(e[u],t[u]);for(;u<n;++u)l[u]=t[u];for(u=0;u<r;++u)l[u]=s[u](i);return l}}function Qo(e,t){e===void 0&&(e={}),t===void 0&&(t={});var n={},r={};return Object.entries(t).forEach(function(i){var s=(0,z.CR)(i,2),l=s[0],u=s[1];l in e?n[l]=or(e[l],u):r[l]=u}),function(i){return Object.entries(n).forEach(function(s){var l=(0,z.CR)(s,2),u=l[0],h=l[1];return r[u]=h(i)}),r}}function or(e,t){return typeof e=="number"&&typeof t=="number"?mP(e,t):Array.isArray(e)&&Array.isArray(t)?mo(e,t):typeof e=="object"&&typeof t=="object"?Qo(e,t):function(n){return e}}function n_(e,t,n,r){if(!r)return e.attr("__keyframe_data__",n),null;var i=r.duration,s=i===void 0?0:i,l=or(t,n),u=Math.ceil(+s/16),h=new Array(u).fill(0).map(function(p,m,y){return{__keyframe_data__:l(m/(y.length-1))}});return e.animate(h,(0,z.pi)({fill:"both"},r))}function fh(e){return typeof e=="function"?e():bi(e)||(0,Ft.Z)(e)?new Ly({style:{text:String(e)}}):e}function Nm(e,t,n){n===void 0&&(n=!1);var r=e.getBBox(),i=r.width,s=r.height,l=t/Math.max(i,s);return n&&(e.style.transform="scale(".concat(l,")")),l}function jb(e,t){var n={},r=Array.isArray(t)?t:[t];for(var i in e)r.includes(i)||(n[i]=e[i]);return n}function Vb(e,t){return Object.fromEntries(Object.entries(e).map(function(n){var r=(0,z.CR)(n,2),i=r[0],s=r[1];return[i,Ss(s,t)]}))}function wk(e){if(e.type==="linear"){var t=e.startPos,n=e.endPos;return __spreadArray(__spreadArray([],__read(t),!1),__read(n),!1)}var r=e.startAngle,i=e.endAngle,s=e.center,l=e.radius;return __spreadArray(__spreadArray([r,i],__read(s),!1),[l],!1)}function Hb(e,t){return t&&Ih(t)?e.filter(t):e}function IA(e,t){var n=t.startAngle,r=t.endAngle;return(r-n)*e+n}function Zb(e,t){if(t.type==="linear"){var n=(0,z.CR)(t.startPos,2),r=n[0],i=n[1],s=(0,z.CR)(t.endPos,2),l=s[0],u=s[1],h=(0,z.CR)([l-r,u-i],2),p=h[0],m=h[1];return _o([p,m])}var y=Tn(IA(e,t));return[-Math.sin(y),Math.cos(y)]}function r_(e,t,n){var r=Zb(e,n);return OE(r,t!=="positive")}function Ia(e,t){return r_(e,t.labelDirection,t)}function Cv(e,t){var n=(0,z.CR)(t.startPos,2),r=n[0],i=n[1],s=(0,z.CR)(t.endPos,2),l=s[0],u=s[1],h=(0,z.CR)([l-r,u-i],2),p=h[0],m=h[1];return[r+p*e,i+m*e]}function PE(e,t){var n=t.radius,r=(0,z.CR)(t.center,2),i=r[0],s=r[1],l=Tn(IA(e,t));return[i+n*Math.cos(l),s+n*Math.sin(l)]}function Fy(e,t){return t.type==="linear"?Cv(e,t):PE(e,t)}function Wb(e){return Zb(0,e)[1]===0}function xg(e){return Zb(0,e)[0]===0}function ky(e,t){return t-e===360}function LA(e,t,n,r,i){var s=t-e,l=(0,z.CR)([i,i],2),u=l[0],h=l[1],p=(0,z.CR)([Tn(e),Tn(t)],2),m=p[0],y=p[1],b=function(Ue){return[n+i*Math.cos(Ue),r+i*Math.sin(Ue)]},w=(0,z.CR)(b(m),2),R=w[0],M=w[1],I=(0,z.CR)(b(y),2),N=I[0],U=I[1];if(ky(e,t)){var Z=(y+m)/2,Y=(0,z.CR)(b(Z),2),$=Y[0],J=Y[1];return[["M",R,M],["A",u,h,0,1,0,$,J],["A",u,h,0,1,0,N,U]]}var se=s>180?1:0,pe=e>t?0:1,Ce=!1;return Ce?"M".concat(n,",").concat(r,",L").concat(R,",").concat(M,",A").concat(u,",").concat(h,",0,").concat(se,",").concat(pe,",").concat(N,",").concat(U,",L").concat(n,",").concat(r):"M".concat(R,",").concat(M,",A").concat(u,",").concat(h,",0,").concat(se,",").concat(pe,",").concat(N,",").concat(U)}function DA(e){var t=e.attributes,n=t.startAngle,r=t.endAngle,i=t.center,s=t.radius;return(0,z.ev)((0,z.ev)([n,r],(0,z.CR)(i),!1),[s],!1)}function vP(e,t,n,r){var i=t.startAngle,s=t.endAngle,l=t.center,u=t.radius;return e.selectAll(nl.line.class).data([{d:LA.apply(void 0,(0,z.ev)((0,z.ev)([i,s],(0,z.CR)(l),!1),[u],!1))}],function(h,p){return p}).join(function(h){return h.append("path").attr("className",nl.line.name).styles(t).styles({d:function(p){return p.d}})},function(h){return h.transition(function(){var p=this,m=n_(this,DA(this),(0,z.ev)((0,z.ev)([i,s],(0,z.CR)(l),!1),[u],!1),r.update);if(m){var y=function(){var b=Bi(p.attributes,"__keyframe_data__");p.style.d=LA.apply(void 0,(0,z.ev)([],(0,z.CR)(b),!1))};m.onframe=y,m.onfinish=y}return m}).styles(t)},function(h){return h.remove()}).styles(n).transitions()}function Eg(e,t){var n=t.truncRange,r=t.truncShape,i=t.lineExtension}function gP(e,t,n){n===void 0&&(n=[0,0]);var r=(0,z.CR)([e,t,n],3),i=(0,z.CR)(r[0],2),s=i[0],l=i[1],u=(0,z.CR)(r[1],2),h=u[0],p=u[1],m=(0,z.CR)(r[2],2),y=m[0],b=m[1],w=(0,z.CR)([h-s,p-l],2),R=w[0],M=w[1],I=Math.sqrt(Math.pow(R,2)+Math.pow(M,2)),N=(0,z.CR)([-y/I,b/I],2),U=N[0],Z=N[1];return[U*R,U*M,Z*R,Z*M]}function NA(e){var t=(0,z.CR)(e,2),n=(0,z.CR)(t[0],2),r=n[0],i=n[1],s=(0,z.CR)(t[1],2),l=s[0],u=s[1];return{x1:r,y1:i,x2:l,y2:u}}function BA(e,t,n,r){var i=t.showTrunc,s=t.startPos,l=t.endPos,u=t.truncRange,h=t.lineExtension,p=(0,z.CR)([s,l],2),m=(0,z.CR)(p[0],2),y=m[0],b=m[1],w=(0,z.CR)(p[1],2),R=w[0],M=w[1],I=(0,z.CR)(h?gP(s,l,h):new Array(4).fill(0),4),N=I[0],U=I[1],Z=I[2],Y=I[3],$=function(wt){return e.selectAll(nl.line.class).data(wt,function(zt,En){return En}).join(function(zt){return zt.append("line").attr("className",function(En){return"".concat(nl.line.name," ").concat(En.className)}).styles(n).transition(function(En){return b0(this,NA(En.line),!1)})},function(zt){return zt.styles(n).transition(function(En){var Vn=En.line;return b0(this,NA(Vn),r.update)})},function(zt){return zt.remove()}).transitions()};if(!i||!u)return $([{line:[[y+N,b+U],[R+Z,M+Y]],className:nl.line.name}]);var J=(0,z.CR)(u,2),se=J[0],pe=J[1],Ce=R-y,Ue=M-b,Je=(0,z.CR)([y+Ce*se,b+Ue*se],2),lt=Je[0],Ge=Je[1],at=(0,z.CR)([y+Ce*pe,b+Ue*pe],2),st=at[0],ft=at[1],Vt=$([{line:[[y+N,b+U],[lt,Ge]],className:nl.lineFirst.name},{line:[[st,ft],[R+Z,M+Y]],className:nl.lineSecond.name}]);return Eg(e,t),Vt}function yP(e,t,n,r){var i=n.showArrow,s=n.showTrunc,l=n.lineArrow,u=n.lineArrowOffset,h=n.lineArrowSize,p;if(t==="arc"?p=e.select(nl.line.class):s?p=e.select(nl.lineSecond.class):p=e.select(nl.line.class),!i||!l||n.type==="arc"&&ky(n.startAngle,n.endAngle)){var m=p.node();m&&(m.style.markerEnd=void 0);return}var y=fh(l);y.attr(r),Nm(y,h,!0),p.style("markerEnd",y).style("markerEndOffset",-u)}function _P(e,t,n){var r=t.type,i,s=sa(t,"line");return r==="linear"?i=BA(e,t,jb(s,"arrow"),n):i=vP(e,t,jb(s,"arrow"),n),yP(e,r,t,s),i}function bP(e,t){return r_(e,t.gridDirection,t)}function zy(e){var t=e.type,n=e.gridCenter;return t==="linear"?n:n||e.center}function Bm(e,t){var n=t.gridLength;return e.map(function(r,i){var s=r.value,l=(0,z.CR)(Fy(s,t),2),u=l[0],h=l[1],p=(0,z.CR)($0(bP(s,t),n),2),m=p[0],y=p[1];return{id:i,points:[[u,h],[u+m,h+y]]}})}function FA(e,t){var n=t.gridControlAngles,r=zy(t);if(!r)throw new Error("grid center is not provide");if(e.length<2)throw new Error("Invalid grid data");if(!n||n.length===0)throw new Error("Invalid gridControlAngles");var i=(0,z.CR)(r,2),s=i[0],l=i[1];return e.map(function(u,h){var p=u.value,m=(0,z.CR)(Fy(p,t),2),y=m[0],b=m[1],w=(0,z.CR)([y-s,b-l],2),R=w[0],M=w[1],I=[];return n.forEach(function(N){var U=Tn(N),Z=(0,z.CR)([Math.cos(U),Math.sin(U)],2),Y=Z[0],$=Z[1],J=R*Y-M*$+s,se=R*$+M*Y+l;I.push([J,se])}),{points:I,id:h}})}function xP(e,t,n,r){var i=sa(n,"grid"),s=i.type,l=i.areaFill,u=zy(n),h=Hb(t,n.gridFilter),p=s==="segment"?Bm(h,n):FA(h,n),m=(0,z.pi)((0,z.pi)({},i),{center:u,areaFill:Ih(l)?h.map(function(y,b){return Ss(l,[y,b,h])}):l,animate:r,data:p});return e.selectAll(nl.grid.class).data([1]).join(function(y){return y.append(function(){return new oi({style:m})}).attr("className",nl.grid.name)},function(y){return y.transition(function(){return this.update(m)})},function(y){return y.remove()}).transitions()}function qu(e,t,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&e===t||i&&e===n?!0:e>t&&e<n}function EP(e){var t,n,r,i=e||1;function s(u,h){++t>i&&(r=n,l(1),++t),n[u]=h}function l(u){t=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var h=n[u];if(h!==void 0)return h;if((h=r[u])!==void 0)return s(u,h),h},set:function(u,h){n[u]!==void 0?n[u]=h:s(u,h)}}}var kA=function(e,t,n){if(n===void 0&&(n=128),!Ih(e))throw new TypeError("Expected a function");var r=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var l=t?t.apply(this,i):i[0],u=r.cache;if(u.has(l))return u.get(l);var h=e.apply(this,i);return u.set(l,h),h};return r.cache=EP(n),r},Gb,IE;function SP(e){IE=e}var zA=kA(function(e,t){var n=t.fontSize,r=t.fontFamily,i=t.fontWeight,s=t.fontStyle,l=t.fontVariant;return IE?IE(e,n):(Gb||(Gb=g.offscreenCanvasCreator.getOrCreateContext(void 0)),Gb.font=[s,l,i,"".concat(n,"px"),r].join(" "),Gb.measureText(e).width)},function(e,t){return[e,Object.values(t||LE(e)).join()].join("")},4096),LE=function(e){var t=e.style.fontFamily||"sans-serif",n=e.style.fontWeight||"normal",r=e.style.fontStyle||"normal",i=e.style.fontVariant,s=e.style.fontSize;return s=typeof s=="object"?s.value:s,{fontSize:s,fontFamily:t,fontWeight:n,fontStyle:r,fontVariant:i}};function UA(e){return e.nodeName==="text"?e:e.nodeName==="g"&&e.children.length===1&&e.children[0].nodeName==="text"?e.children[0]:null}function Xb(e,t){var n=UA(e);n&&n.attr(t)}function Sg(e,t,n){n===void 0&&(n="..."),Xb(e,{wordWrap:!0,wordWrapWidth:t,maxLines:1,textOverflow:n})}function DE(e,t,n,r){n===void 0&&(n=2),r===void 0&&(r="top"),Xb(e,{wordWrap:!0,wordWrapWidth:t,maxLines:n,textBaseline:r})}function Yb(e,t,n){var r=e.getBBox(),i=r.width,s=r.height,l=(0,z.CR)([t,n].map(function(p,m){var y;return p.includes("%")?parseFloat(((y=p.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||y===void 0?void 0:y[0])||"0")/100*(m===0?i:s):p}),2),u=l[0],h=l[1];return[u,h]}function NE(e,t){if(t)try{var n=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=t.replace(n,function(i,s,l){return"translate(".concat(Yb(e,s,l),")")});e.attr("transform",r)}catch(i){}}var Ov=function(e){return e!==void 0&&e!=null&&!Number.isNaN(e)};function jf(e){if((0,Ft.Z)(e))return[e,e,e,e];if(Is(e)){var t=e.length;if(t===1)return[e[0],e[0],e[0],e[0]];if(t===2)return[e[0],e[1],e[0],e[1]];if(t===3)return[e[0],e[1],e[2],e[1]];if(t===4)return e}return[0,0,0,0]}var i_=function(){function e(t,n,r,i){this.set(t,n,r,i)}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),e.prototype.rotatedPoints=function(t,n,r){var i=this,s=i.x1,l=i.y1,u=i.x2,h=i.y2,p=Math.cos(t),m=Math.sin(t),y=n-n*p+r*m,b=r-n*m-r*p,w=[[p*s-m*h+y,m*s+p*h+b],[p*u-m*h+y,m*u+p*h+b],[p*s-m*l+y,m*s+p*l+b],[p*u-m*l+y,m*u+p*l+b]];return w},e.prototype.set=function(t,n,r,i){return r<t?(this.x2=t,this.x1=r):(this.x1=t,this.x2=r),i<n?(this.y2=n,this.y1=i):(this.y1=n,this.y2=i),this},e.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},e}();function x0(e,t){var n=e.getEulerAngles()||0;e.setEulerAngles(0);var r=e.getBounds(),i=(0,z.CR)(r.min,2),s=i[0],l=i[1],u=(0,z.CR)(r.max,2),h=u[0],p=u[1],m=e.getBBox(),y=m.width,b=m.height,w=b,R=0,M=0,I=s,N=l,U=UA(e);if(U){w-=1.5;var Z=U.style.textAlign,Y=U.style.textBaseline;Z==="center"?I=(s+h)/2:(Z==="right"||Z==="end")&&(I=h),Y==="middle"?N=(l+p)/2:Y==="bottom"&&(N=p)}var $=(0,z.CR)(jf(t),4),J=$[0],se=J===void 0?0:J,pe=$[1],Ce=pe===void 0?0:pe,Ue=$[2],Je=Ue===void 0?se:Ue,lt=$[3],Ge=lt===void 0?Ce:lt,at=new i_((R+=s)-Ge,(M+=l)-se,R+y+Ce,M+w+Je);return e.setEulerAngles(n),at.rotatedPoints(Tn(n),I,N)}function Uy(e,t){return t[0]<=Math.max(e[0][0],e[1][0])&&t[0]<=Math.min(e[0][0],e[1][0])&&t[1]<=Math.max(e[0][1],e[1][1])&&t[1]<=Math.min(e[0][1],e[1][1])}function o_(e,t,n){var r=(t[1]-e[1])*(n[0]-t[0])-(t[0]-e[0])*(n[1]-t[1]);return r===0?0:r<0?2:1}function TP(e,t){var n=o_(e[0],e[1],t[0]),r=o_(e[0],e[1],t[1]),i=o_(t[0],t[1],e[0]),s=o_(t[0],t[1],e[1]);return!!(n!==r&&i!==s||n===0&&Uy(e,t[0])||r===0&&Uy(e,t[1])||i===0&&Uy(t,e[0])||s===0&&Uy(t,e[1]))}function BE(e,t){var n=e.length;if(n<3)return!1;var r=[t,[9999,t[1]]],i=0,s=0;do{var l=[e[s],e[(s+1)%n]];if(TP(l,r)){if(o_(l[0],t,l[1])===0)return Uy(l,t);i++}s=(s+1)%n}while(s!==0);return!!(i&1)}function Fm(e,t){return t.every(function(n){return BE(e,n)})}function Tg(e,t,n){var r=e.x1,i=e.x2,s=e.y1,l=e.y2,u=[[r,s],[i,s],[i,l],[r,l]],h=x0(t,n);return Fm(u,h)}function FE(e,t){var n=(0,z.CR)(e,4),r=n[0],i=n[1],s=n[2],l=n[3],u=(0,z.CR)(t,4),h=u[0],p=u[1],m=u[2],y=u[3],b=s-r,w=l-i,R=m-h,M=y-p,I=b*M-R*w;if(I===0)return!1;var N=I>0,U=r-h,Z=i-p,Y=b*Z-w*U;if(Y<0===N)return!1;var $=R*Z-M*U;return!($<0===N||Y>I===N||$>I===N)}function $b(e,t){var n=[[e[0],e[1],e[2],e[3]],[e[2],e[3],e[4],e[5]],[e[4],e[5],e[6],e[7]],[e[6],e[7],e[0],e[1]]];return n.some(function(r){return FE(t,r)})}var wP={lineToLine:FE,intersectBoxLine:$b,getBounds:x0};function jA(e,t,n){var r,i,s=x0(e,n).flat(1),l=x0(t,n).flat(1),u=[[s[0],s[1],s[2],s[3]],[s[0],s[1],s[4],s[5]],[s[4],s[5],s[6],s[7]],[s[2],s[3],s[6],s[7]]];try{for(var h=(0,z.XA)(u),p=h.next();!p.done;p=h.next()){var m=p.value;if($b(l,m))return!0}}catch(y){r={error:y}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return!1}function kE(e,t){var n=e.type,r=e.labelDirection,i=e.crossSize;if(!i)return!1;if(n==="arc"){var s=e.center,l=e.radius,u=(0,z.CR)(s,2),h=u[0],p=u[1],m=r==="negative"?0:i,y=-l-m,b=l+m,w=(0,z.CR)(jf(t),4),R=w[0],M=w[1],I=w[2],N=w[3];return new i_(h+y-N,p+y-R,h+b+M,p+b+I)}var U=(0,z.CR)(e.startPos,2),Z=U[0],Y=U[1],$=(0,z.CR)(e.endPos,2),J=$[0],se=$[1],pe=(0,z.CR)(xg(e)?[-t,0,t,0]:[0,t,0,-t],4),Ce=pe[0],Ue=pe[1],Je=pe[2],lt=pe[3],Ge=Ia(0,e),at=$0(Ge,i),st=new i_(Z,Y,J,se);return st.x1+=lt,st.y1+=Ce,st.x2+=Ue+at[0],st.y2+=Je+at[1],st}function a_(e,t,n){var r,i,s=t.crossPadding,l=new Set,u=null,h=kE(t,s),p=function(R){return h?Tg(h,R):!0},m=function(R,M){return!R||!R.firstChild?!0:!jA(R.firstChild,M.firstChild,jf(n))};try{for(var y=(0,z.XA)(e),b=y.next();!b.done;b=y.next()){var w=b.value;p(w)?!u||m(u,w)?u=w:(l.add(u),l.add(w)):l.add(w)}}catch(R){r={error:R}}finally{try{b&&!b.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}return Array.from(l)}function wg(e,t){return t===void 0&&(t={}),(0,sr.Z)(e)?0:typeof e=="number"?e:Math.floor(zA(e,t))}function VA(e,t,n,r){if(!(e.length<=1)){var i=t.suffix,s=i===void 0?"...":i,l=t.minLength,u=t.maxLength,h=u===void 0?1/0:u,p=t.step,m=p===void 0?" ":p,y=t.margin,b=y===void 0?[0,0,0,0]:y,w=LE(r.getTextShape(e[0])),R=wg(m,w),M=l?wg(l,w):R,I=wg(h,w);((0,sr.Z)(I)||I===1/0)&&(I=Math.max.apply(null,e.map(function(at){return at.getBBox().width})));for(var N=e.slice(),U=(0,z.CR)(b,4),Z=U[0],Y=Z===void 0?0:Z,$=U[1],J=$===void 0?0:$,se=U[2],pe=se===void 0?Y:se,Ce=U[3],Ue=Ce===void 0?J:Ce,Je=function(at){if(N.forEach(function(st){r.ellipsis(r.getTextShape(st),at,s)}),N=a_(e,n,b),N.length<1)return{value:void 0}},lt=I;lt>M+R;lt-=R){var Ge=Je(lt);if(typeof Ge=="object")return Ge.value}}}function HA(e){var t=e&&e.getRenderBounds();if(!t)return{width:0,height:0};var n=t.getMax(),r=t.getMin();return{width:n[0]-r[0],height:n[1]-r[1]}}function zE(e){var t=e.getLocalBounds(),n=t.min,r=t.max,i=(0,z.CR)([n,r],2),s=(0,z.CR)(i[0],2),l=s[0],u=s[1],h=(0,z.CR)(i[1],2),p=h[0],m=h[1];return{x:l,y:u,width:p-l,height:m-u,left:l,bottom:m,top:u,right:p}}function AP(e,t){var n=select(e).append("text").node();return n.attr(__assign(__assign({},t),{visibility:"hidden"})),n}function ZA(e,t){var n=(0,z.CR)(e,2),r=n[0],i=n[1],s=(0,z.CR)(t,2),l=s[0],u=s[1];return r!==l&&i===u}function CP(e,t){var n=__read(e,2),r=n[0],i=n[1],s=__read(t,2),l=s[0],u=s[1];return r===l&&i!==u}function WA(e,t){var n,r,i=t.attributes;try{for(var s=(0,z.XA)(Object.entries(i)),l=s.next();!l.done;l=s.next()){var u=(0,z.CR)(l.value,2),h=u[0],p=u[1];h!=="id"&&h!=="className"&&e.attr(h,p)}}catch(m){n={error:m}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}var OP={parity:function(e,t){var n=t.seq,r=n===void 0?2:n;return e.filter(function(i,s){return s%r?(Dm(i),!1):!0})}},GA=function(e){return e.filter(Ov)};function UE(e,t,n,r){var i=e.length,s=t.keepHeader,l=t.keepTail;if(!(i<=1||i===2&&s&&l)){var u=OP.parity,h=function(Z){return Z.forEach(r.show),Z},p=2,m=e.slice(),y=e.slice(),b=Math.min.apply(Math,(0,z.ev)([1],(0,z.CR)(e.map(function(Z){return Z.getBBox().width})),!1));if(n.type==="linear"&&(Wb(n)||xg(n))){var w=zE(e[0]).left,R=zE(e[i-1]).right,M=Math.abs(R-w)||1;p=Math.max(Math.floor(i*b/M),p)}var I,N;for(s&&(I=m.splice(0,1)[0]),l&&(N=m.splice(-1,1)[0],m.reverse()),h(m);p<e.length&&a_(GA(N?(0,z.ev)((0,z.ev)([N],(0,z.CR)(y),!1),[I],!1):(0,z.ev)([I],(0,z.CR)(y),!1)),n,t==null?void 0:t.margin).length;){if(N&&!I&&p%2===0){var U=m.splice(0,1);U.forEach(r.hide)}else if(N&&I){var U=m.splice(0,1);U.forEach(r.hide)}y=u(h(m),{seq:p}),p++}}}function XA(e,t,n,r){var i,s,l=t.optionalAngles,u=l===void 0?[0,45,90]:l,h=t.margin,p=t.recoverWhenFailed,m=p===void 0?!0:p,y=e.map(function(N){return N.getLocalEulerAngles()}),b=function(){return a_(e,n,h).length<1},w=function(N){return e.forEach(function(U,Z){var Y=Array.isArray(N)?N[Z]:N;r.rotate(U,+Y)})};try{for(var R=(0,z.XA)(u),M=R.next();!M.done;M=R.next()){var I=M.value;if(w(I),b())return}}catch(N){i={error:N}}finally{try{M&&!M.done&&(s=R.return)&&s.call(R)}finally{if(i)throw i.error}}m&&w(y)}function YA(e){var t=e.type,n=e.labelDirection;return t==="linear"&&Wb(e)?n==="negative"?"bottom":"top":"middle"}function $A(e,t,n,r){var i=t.wordWrapWidth,s=i===void 0?50:i,l=t.maxLines,u=l===void 0?3:l,h=t.recoverWhenFailed,p=h===void 0?!0:h,m=t.margin,y=m===void 0?[0,0,0,0]:m,b=e.map(function(U){return U.attr("maxLines")||1}),w=Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(b),!1)),R=function(){return a_(e,n,y).length<1},M=YA(n),I=function(U){return e.forEach(function(Z,Y){var $=Array.isArray(U)?U[Y]:U;r.wrap(Z,s,$,M)})};if(!(w>u)){for(var N=w;N<=u;N++)if(I(N),R())return;p&&I(b)}}var KA=new Map([["hide",UE],["rotate",XA],["ellipsis",VA],["wrap",$A]]);function qA(e,t,n){return t.labelOverlap.length<1?!1:n==="hide"?!CA(e[0]):n==="rotate"?!e.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):n==="ellipsis"||n==="wrap"?e.filter(function(r){return r.querySelector("text")}).length>1:!0}function QA(e,t,n){var r=t.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(s){var l=s.type,u=KA.get(l);qA(e,t,l)&&(u==null||u(e,s,t,n))})}function Ts(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(r){return r==="positive"?-1:1};return e.reduce(function(r,i){return r*n(i)},1)}function jE(e){for(var t=e;t<0;)t+=360;return Math.round(t%360)}function Kb(e,t){var n=(0,z.CR)(e,2),r=n[0],i=n[1],s=(0,z.CR)(t,2),l=s[0],u=s[1],h=(0,z.CR)([r*l+i*u,r*u-i*l],2),p=h[0],m=h[1];return Math.atan2(m,p)}function Lh(e){var t=(e+360)%180;return qu(t,-90,90)||(t+=180),t}function Rc(e,t,n){var r,i=n.labelAlign,s=(r=t.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(s)return t.getLocalEulerAngles();var l=0,u=Ia(e.value,n),h=Zb(e.value,n);return i==="horizontal"?0:(i==="perpendicular"?l=Kb([1,0],u):l=Kb([h[0]<0?-1:1,0],h),Lh(Ds(l)))}function Vf(e,t,n){var r=n.type,i=n.labelAlign,s=Ia(e,n),l=jE(t),u=jE(Ds(Kb([1,0],s))),h="center",p="middle";return r==="linear"?[90,270].includes(u)&&l===0?(h="center",p=s[1]===1?"top":"bottom"):!(u%180)&&[90,270].includes(l)?h="center":u===0?(qu(l,0,90,!1,!0)||qu(l,0,90)||qu(l,270,360))&&(h="start"):u===90?qu(l,0,90,!1,!0)?h="start":(qu(l,90,180)||qu(l,270,360))&&(h="end"):u===270?qu(l,0,90,!1,!0)?h="end":(qu(l,90,180)||qu(l,270,360))&&(h="start"):u===180&&(l===90?h="start":(qu(l,0,90)||qu(l,270,360))&&(h="end")):i==="parallel"?qu(u,0,180,!0)?p="top":p="bottom":i==="horizontal"?qu(u,90,270,!1)?h="end":(qu(u,270,360,!1)||qu(u,0,90))&&(h="start"):i==="perpendicular"&&(qu(u,90,270)?h="end":h="start"),{textAlign:h,textBaseline:p}}function K0(e,t,n){t.setLocalEulerAngles(e);var r=t.__data__.value,i=Vf(r,e,n),s=t.querySelector(nl.labelItem.class);s&&HE(s,i)}function VE(e,t,n){var r=n.showTick,i=n.tickLength,s=n.tickDirection,l=n.labelDirection,u=n.labelSpacing,h=t.indexOf(e),p=Ss(u,[e,h,t]),m=(0,z.CR)([Ia(e.value,n),Ts(l,s)],2),y=m[0],b=m[1],w=b===1?Ss(r?i:0,[e,h,t]):0,R=(0,z.CR)(Dy($0(y,p+w),Fy(e.value,n)),2),M=R[0],I=R[1];return{x:M,y:I}}function JA(e,t,n,r){var i=r.labelFormatter,s=Ih(i)?function(){return fh(Ss(i,[e,t,n,Ia(e.value,r)]))}:function(){return fh(e.label||"")};return s}function HE(e,t){e.nodeName==="text"&&e.attr(t)}function qb(e){QA(this.node().childNodes,e,{hide:Dm,show:Iy,rotate:function(t,n){K0(+n,t,e)},ellipsis:function(t,n,r){t&&Sg(t,n||1/0,r)},wrap:function(t,n,r){t&&DE(t,n,r)},getTextShape:function(t){return t.querySelector("text")}})}function s_(e,t,n,r,i){var s=n.indexOf(t),l=$a(e).append(JA(t,s,n,i)).attr("className",nl.labelItem.name).node(),u=(0,z.CR)(Pl(Vb(r,[t,s,n])),2),h=u[0],p=u[1],m=p.transform,y=(0,z._T)(p,["transform"]);NE(l,m);var b=Rc(t,l,i);return l.getLocalEulerAngles()||l.setLocalEulerAngles(b),HE(l,(0,z.pi)((0,z.pi)({},Vf(t.value,b,i)),h)),e.attr(y),l}function Rd(e,t,n,r){var i=Hb(t,n.labelFilter),s=sa(n,"label");return e.selectAll(nl.label.class).data(i,function(l,u){return u}).join(function(l){return l.append("g").attr("className",nl.label.name).transition(function(u){s_(this,u,t,s,n);var h=VE(u,t,n),p=h.x,m=h.y;return this.style.transform="translate(".concat(p,", ").concat(m,")"),null}).call(function(){qb.call(e,n)})},function(l){return l.transition(function(u){var h=this.querySelector(nl.labelItem.class),p=s_(this,u,t,s,n),m=AA(h,p,r.update),y=VE(u,t,n),b=y.x,w=y.y,R=b0(this,{transform:"translate(".concat(b,", ").concat(w,")")},r.update);return(0,z.ev)((0,z.ev)([],(0,z.CR)(m),!1),[R],!1)}).call(function(u){var h=Bi(u,"_transitions").flat().filter(Ov);J1(h,function(){qb.call(e,n)})})},function(l){return l.transition(function(){var u=this,h=cd(this.childNodes[0],r.exit);return _g(h,function(){return $a(u).remove()}),h})}).transitions()}function q0(e,t){return r_(e,t.tickDirection,t)}function l_(e,t){var n=(0,z.CR)(e,2),r=n[0],i=n[1];return[[0,0],[r*t,i*t]]}function eC(e,t,n,r,i){var s=i.tickLength,l=(0,z.CR)(l_(r,Ss(s,[e,t,n])),2),u=(0,z.CR)(l[0],2),h=u[0],p=u[1],m=(0,z.CR)(l[1],2),y=m[0],b=m[1];return{x1:h,x2:y,y1:p,y2:b}}function ZE(e,t,n,r,i){var s=i.tickFormatter,l=q0(t.value,i),u="line";return Ih(s)&&(u=function(){return Ss(s,[t,n,r,l])}),e.append(u).attr("className",nl.tickItem.name)}function tC(e,t,n,r,i,s,l){var u=q0(e.value,s),h=eC(e,t,n,u,s),p=h.x1,m=h.x2,y=h.y1,b=h.y2,w=(0,z.CR)(Pl(Vb(l,[e,t,n,u])),2),R=w[0],M=w[1];r.node().nodeName==="line"&&r.styles((0,z.pi)({x1:p,x2:m,y1:y,y2:b},R)),i.attr(M),r.styles(R)}function WE(e,t,n,r,i,s){var l=ZE($a(this),e,t,n,r);tC(e,t,n,l,this,r,i);var u=(0,z.CR)(Fy(e.value,r),2),h=u[0],p=u[1];return b0(this,{transform:"translate(".concat(h,", ").concat(p,")")},s)}function jy(e,t,n,r){var i=Hb(t,n.tickFilter),s=sa(n,"tick");return e.selectAll(nl.tick.class).data(i,function(l){return l.id||l.label}).join(function(l){return l.append("g").attr("className",nl.tick.name).transition(function(u,h){return WE.call(this,u,h,i,n,s,!1)})},function(l){return l.transition(function(u,h){return this.removeChildren(),WE.call(this,u,h,i,n,s,r.update)})},function(l){return l.transition(function(){var u=this,h=cd(this.childNodes[0],r.exit);return _g(h,function(){return u.remove()}),h})}).transitions()}var yc=function(){function e(t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=n,this.width=r,this.height=i}return Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},e.prototype.isPointIn=function(t,n){return t>=this.left&&t<=this.right&&n>=this.top&&n<=this.bottom},e}();function RP(e){var t=e.getRenderBounds(),n=__read(t.min,2),r=n[0],i=n[1],s=__read(t.max,2),l=s[0],u=s[1],h=l-r,p=u-i;return new yc(r,i,h,p)}var nC=lp({text:"text"},"title");function Vy(e){return/\S+-\S+/g.test(e)?e.split("-").map(function(t){return t[0]}):e.length>2?[e[0]]:e.split("")}function GE(e,t){var n=e.attributes,r=n.position,i=n.spacing,s=n.inset,l=n.text,u=e.getBBox(),h=t.getBBox(),p=Vy(r),m=(0,z.CR)(jf(l?i:0),4),y=m[0],b=m[1],w=m[2],R=m[3],M=(0,z.CR)(jf(s),4),I=M[0],N=M[1],U=M[2],Z=M[3],Y=(0,z.CR)([R+b,y+w],2),$=Y[0],J=Y[1],se=(0,z.CR)([Z+N,I+U],2),pe=se[0],Ce=se[1];if(p[0]==="l")return new yc(u.x,u.y,h.width+u.width+$+pe,Math.max(h.height+Ce,u.height));if(p[0]==="t")return new yc(u.x,u.y,Math.max(h.width+pe,u.width),h.height+u.height+J+Ce);var Ue=(0,z.CR)([t.attributes.width||h.width,t.attributes.height||h.height],2),Je=Ue[0],lt=Ue[1];return new yc(h.x,h.y,Je+u.width+$+pe,lt+u.height+J+Ce)}function km(e,t){var n=Object.entries(t).reduce(function(r,i){var s=(0,z.CR)(i,2),l=s[0],u=s[1],h=e.node().attr(l);return h||(r[l]=u),r},{});e.styles(n)}function MP(e){var t,n,r,i,s=e,l=s.width,u=s.height,h=s.position,p=(0,z.CR)([+l/2,+u/2],2),m=p[0],y=p[1],b=(0,z.CR)([+m,+y,"center","middle"],4),w=b[0],R=b[1],M=b[2],I=b[3],N=Vy(h);return N.includes("l")&&(t=(0,z.CR)([0,"start"],2),w=t[0],M=t[1]),N.includes("r")&&(n=(0,z.CR)([+l,"end"],2),w=n[0],M=n[1]),N.includes("t")&&(r=(0,z.CR)([0,"top"],2),R=r[0],I=r[1]),N.includes("b")&&(i=(0,z.CR)([+u,"bottom"],2),R=i[0],I=i[1]),{x:w,y:R,textAlign:M,textBaseline:I}}var Md=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return t.prototype.getAvailableSpace=function(){var n=this,r=this.attributes,i=r.width,s=r.height,l=r.position,u=r.spacing,h=r.inset,p=n.querySelector(nC.text.class);if(!p)return new yc(0,0,+i,+s);var m=p.getBBox(),y=m.width,b=m.height,w=(0,z.CR)(jf(u),4),R=w[0],M=w[1],I=w[2],N=w[3],U=(0,z.CR)([0,0,+i,+s],4),Z=U[0],Y=U[1],$=U[2],J=U[3],se=Vy(l);if(se.includes("i"))return new yc(Z,Y,$,J);se.forEach(function(ft,Vt){var wt,zt,En,Vn;ft==="t"&&(wt=(0,z.CR)(Vt===0?[b+I,+s-b-I]:[0,+s],2),Y=wt[0],J=wt[1]),ft==="r"&&(zt=(0,z.CR)([+i-y-N],1),$=zt[0]),ft==="b"&&(En=(0,z.CR)([+s-b-R],1),J=En[0]),ft==="l"&&(Vn=(0,z.CR)(Vt===0?[y+M,+i-y-M]:[0,+i],2),Z=Vn[0],$=Vn[1])});var pe=(0,z.CR)(jf(h),4),Ce=pe[0],Ue=pe[1],Je=pe[2],lt=pe[3],Ge=(0,z.CR)([lt+Ue,Ce+Je],2),at=Ge[0],st=Ge[1];return new yc(Z+lt,Y+Ce,$-at,J-st)},t.prototype.getBBox=function(){return this.title?this.title.getBBox():new yc(0,0,0,0)},t.prototype.render=function(n,r){var i=this,s=n.width,l=n.height,u=n.position,h=n.spacing,p=(0,z._T)(n,["width","height","position","spacing"]),m=(0,z.CR)(Pl(p),1),y=m[0],b=MP(n),w=b.x,R=b.y,M=b.textAlign,I=b.textBaseline;sd(!!p.text,$a(r),function(N){i.title=N.maybeAppendByClassName(nC.text,"text").styles(y).call(km,{x:w,y:R,textAlign:M,textBaseline:I}).node()})},t}(Af);function rC(e,t,n){var r=n.titlePosition,i=r===void 0?"lb":r,s=n.titleSpacing,l=Vy(i),u=e.node().getLocalBounds(),h=(0,z.CR)(u.min,2),p=h[0],m=h[1],y=(0,z.CR)(u.halfExtents,2),b=y[0],w=y[1],R=(0,z.CR)(t.node().getLocalBounds().halfExtents,2),M=R[0],I=R[1],N=(0,z.CR)([p+b,m+w],2),U=N[0],Z=N[1],Y=(0,z.CR)(jf(s),4),$=Y[0],J=Y[1],se=Y[2],pe=Y[3];if(["start","end"].includes(i)&&n.type==="linear"){var Ce=n.startPos,Ue=n.endPos,Je=(0,z.CR)(i==="start"?[Ce,Ue]:[Ue,Ce],2),lt=Je[0],Ge=Je[1],at=_o([-Ge[0]+lt[0],-Ge[1]+lt[1]]),st=(0,z.CR)($0(at,$),2),ft=st[0],Vt=st[1];return{x:lt[0]+ft,y:lt[1]+Vt}}return l.includes("t")&&(Z-=w+I+$),l.includes("r")&&(U+=b+M+J),l.includes("l")&&(U-=b+M+pe),l.includes("b")&&(Z+=w+I+se),{x:U,y:Z}}function Uo(e,t,n){var r=e.getGeometryBounds().halfExtents,i=r[1]*2;if(t==="vertical"){if(n==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(n==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function Qb(e,t,n,r,i){var s=sa(r,"title"),l=(0,z.CR)(Pl(s),2),u=l[0],h=l[1],p=h.transform,m=h.transformOrigin,y=(0,z._T)(h,["transform","transformOrigin"]);t.styles(y);var b=p||Uo(e.node(),u.direction,u.position);e.styles((0,z.pi)((0,z.pi)({},u),{transformOrigin:m})),NE(e.node(),b);var w=rC($a(n._offscreen||n.querySelector(nl.mainGroup.class)),t,r),R=w.x,M=w.y,I=b0(t.node(),{transform:"translate(".concat(R,", ").concat(M,")")},i);return I}function XE(e,t,n,r){var i=n.titleText;return e.selectAll(nl.title.class).data([{title:i}].filter(function(s){return!!s.title}),function(s,l){return s.title}).join(function(s){return s.append(function(){return fh(i)}).attr("className",nl.title.name).transition(function(){return Qb($a(this),e,t,n,r.enter)})},function(s){return s.transition(function(){return Qb($a(this),e,t,n,r.update)})},function(s){return s.remove()}).transitions()}function YE(e,t,n,r){var i=e.showLine,s=e.showTick,l=e.showLabel,u=t.maybeAppendByClassName(nl.lineGroup,"g"),h=sd(i,u,function(w){return _P(w,e,r)})||[],p=t.maybeAppendByClassName(nl.tickGroup,"g"),m=sd(s,p,function(w){return jy(w,n,e,r)})||[],y=t.maybeAppendByClassName(nl.labelGroup,"g"),b=sd(l,y,function(w){return Rd(w,n,e,r)})||[];return(0,z.ev)((0,z.ev)((0,z.ev)([],(0,z.CR)(h),!1),(0,z.CR)(m),!1),(0,z.CR)(b),!1).filter(function(w){return!!w})}var c_=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,e_)||this}return t.prototype.render=function(n,r,i){var s=this,l=n.titleText,u=n.data,h=n.animate,p=n.showTitle,m=n.showGrid,y=n.dataThreshold,b=n.truncRange,w=AE(u,y).filter(function($){var J=$.value;return!(b&&J>b[0]&&J<b[1])}),R=xE(i===void 0?h:i),M=$a(r).maybeAppendByClassName(nl.gridGroup,"g"),I=sd(m,M,function($){return xP($,w,n,R)})||[],N=$a(r).maybeAppendByClassName(nl.mainGroup,"g");l&&(!this.initialized&&R.enter||this.initialized&&R.update)&&YE(n,$a(this.offscreenGroup),w,xE(!1));var U=YE(n,$a(N.node()),w,R),Z=$a(r).maybeAppendByClassName(nl.titleGroup,"g"),Y=sd(p,Z,function($){return XE($,s,n,R)})||[];return(0,z.ev)((0,z.ev)((0,z.ev)([],(0,z.CR)(I),!1),(0,z.CR)(U),!1),(0,z.CR)(Y),!1).flat().filter(function($){return!!$})},t}(Af),Rv=function(e){return e};class Hy{constructor(t){this.options=ni({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=ni({},this.options,t),this.rescale(t)}rescale(t){}}function u_(e,t){return t-e?n=>(n-e)/(t-e):n=>.5}function Ag(e,...t){return t.reduce((n,r)=>i=>n(r(i)),e)}function Jb(e,t,n,r,i){let s=n||0,l=r||e.length;const u=i||(h=>h);for(;s<l;){const h=Math.floor((s+l)/2);u(e[h])>t?l=h:s=h+1}return s}var Zy=D(19818),f_=D.n(Zy);function zm(e,t,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Cg(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100,i=e[3];if(n===0)return[r*255,r*255,r*255,i];const s=r<.5?r*(1+n):r+n-r*n,l=2*r-s,u=zm(l,s,t+1/3),h=zm(l,s,t),p=zm(l,s,t-1/3);return[u*255,h*255,p*255,i]}function h_(e){const t=f_().get(e);if(!t)return null;const{model:n,value:r}=t;return n==="rgb"?r:n==="hsl"?Cg(r):null}const E0=(e,t)=>n=>e*(1-n)+t*n,$E=(e,t)=>{const n=h_(e),r=h_(t);return n===null||r===null?n?()=>e:()=>t:i=>{const s=new Array(4);for(let m=0;m<4;m+=1){const y=n[m],b=r[m];s[m]=y*(1-i)+b*i}const[l,u,h,p]=s;return`rgba(${Math.round(l)}, ${Math.round(u)}, ${Math.round(h)}, ${p})`}},up=(e,t)=>typeof e=="number"&&typeof t=="number"?E0(e,t):typeof e=="string"&&typeof t=="string"?$E(e,t):()=>e,iC=(e,t)=>{const n=E0(e,t);return r=>Math.round(n(r))};var oC=function(e){return e===null},ex=oC;function d_(e){return!ti(e)&&!ex(e)&&!Number.isNaN(e)}const tx=Math.sqrt(50),Wy=Math.sqrt(10),nx=Math.sqrt(2);function Hf(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/vf(10,i);return i>=0?(s>=tx?10:s>=Wy?5:s>=nx?2:1)*vf(10,i):-vf(10,-i)/(s>=tx?10:s>=Wy?5:s>=nx?2:1)}function KE(e,t,n){const r=Math.abs(t-e)/Math.max(0,n);let i=vf(10,Math.floor(Math.log(r)/Math.LN10));const s=r/i;return s>=tx?i*=10:s>=Wy?i*=5:s>=nx&&(i*=2),t<e?-i:i}const qE=(e,t,n=5)=>{const r=[e,t];let i=0,s=r.length-1,l=r[i],u=r[s],h;return u<l&&([l,u]=[u,l],[i,s]=[s,i]),h=Hf(l,u,n),h>0?(l=Math.floor(l/h)*h,u=Math.ceil(u/h)*h,h=Hf(l,u,n)):h<0&&(l=Math.ceil(l*h)/h,u=Math.floor(u*h)/h,h=Hf(l,u,n)),h>0?(r[i]=Math.floor(l/h)*h,r[s]=Math.ceil(u/h)*h):h<0&&(r[i]=Math.ceil(l*h)/h,r[s]=Math.floor(u*h)/h),r};function aC(e,t){const n=t<e?t:e,r=e>t?e:t;return i=>Math.min(Math.max(n,i),r)}const sC=(e,t,n)=>{const[r,i]=e,[s,l]=t;let u,h;return r<i?(u=u_(r,i),h=n(s,l)):(u=u_(i,r),h=n(l,s)),Ag(h,u)},lC=(e,t,n)=>{const r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),l=e[0]>e[r],u=l?[...e].reverse():e,h=l?[...t].reverse():t;for(let p=0;p<r;p+=1)i[p]=u_(u[p],u[p+1]),s[p]=n(h[p],h[p+1]);return p=>{const m=Jb(e,p,1,r)-1,y=i[m],b=s[m];return Ag(b,y)(p)}},QE=(e,t,n,r)=>(Math.min(e.length,t.length)>2?lC:sC)(e,t,r?iC:n);class p_ extends Hy{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:E0,tickCount:5}}map(t){return d_(t)?this.output(t):this.options.unknown}invert(t){return d_(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,n,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,n,r,...i)}getTicks(){const{tickMethod:t}=this.options,[n,r,i,...s]=this.getTickMethodOptions();return t(n,r,i,...s)}getTickMethodOptions(){const{domain:t,tickCount:n}=this.options,r=t[0],i=t[t.length-1];return[r,i,n]}chooseNice(){return qE}rescale(){this.nice();const[t,n]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,n,this.chooseClamp(n))}chooseClamp(t){const{clamp:n,range:r}=this.options,i=this.options.domain.map(t),s=Math.min(i.length,r.length);return n?aC(i[0],i[s-1]):Rv}composeOutput(t,n){const{domain:r,range:i,round:s,interpolate:l}=this.options,u=QE(r.map(t),i,l,s);this.output=Ag(u,n,t)}composeInput(t,n,r){const{domain:i,range:s}=this.options,l=QE(s,i.map(t),E0);this.input=Ag(n,r,l)}}const Mv=(e,t,n)=>{let r,i,s=e,l=t;if(s===l&&n>0)return[s];let u=Hf(s,l,n);if(u===0||!Number.isFinite(u))return[];if(u>0){s=Math.ceil(s/u),l=Math.floor(l/u),i=new Array(r=Math.ceil(l-s+1));for(let h=0;h<r;h+=1)i[h]=(s+h)*u}else{u=-u,s=Math.ceil(s*u),l=Math.floor(l*u),i=new Array(r=Math.ceil(l-s+1));for(let h=0;h<r;h+=1)i[h]=(s+h)/u}return i};class hh extends p_{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:up,tickMethod:Mv,tickCount:5}}chooseTransforms(){return[Rv,Rv]}clone(){return new hh(this.options)}}function JE(e,t){if(e){var n;if(Is(e))for(var r=0,i=e.length;r<i&&(n=t(e[r],r),n!==!1);r++);else if(ca(e)){for(var s in e)if(e.hasOwnProperty(s)&&(n=t(e[s],s),n===!1))break}}}var rx=JE,cC=function(e,t,n){if(!Is(e)&&!y0(e))return e;var r=n;return rx(e,function(i,s){r=t(r,i,s)}),r},eS=cC,oc=function(e,t){return eS(e,function(n,r,i){return t.includes(i)||(n[i]=r),n},{})};function S0(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}function Og(e){for(var t=1/0,n=1/0,r=-1/0,i=-1/0,s=0;s<e.length;s++){var l=e[s],u=l.x,h=l.y,p=l.width,m=l.height,y=(0,z.CR)([u+p,h+m],2),b=y[0],w=y[1];u<t&&(t=u),h<n&&(n=h),b>r&&(r=b),w>i&&(i=w)}return new yc(t,n,r-t,i-n)}var m_=function(e,t,n){var r=e.width,i=e.height,s=n.flexDirection,l=s===void 0?"row":s,u=n.flexWrap,h=u===void 0?"nowrap":u,p=n.justifyContent,m=p===void 0?"flex-start":p,y=n.alignContent,b=y===void 0?"flex-start":y,w=n.alignItems,R=w===void 0?"flex-start":w,M=l==="row",I=l==="row"||l==="column",N=M?I?[1,0]:[-1,0]:I?[0,1]:[0,-1],U=(0,z.CR)([0,0],2),Z=U[0],Y=U[1],$=t.map(function(Ge){var at,st=Ge.width,ft=Ge.height,Vt=(0,z.CR)([Z,Y],2),wt=Vt[0],zt=Vt[1];return at=(0,z.CR)([Z+st*N[0],Y+ft*N[1]],2),Z=at[0],Y=at[1],new yc(wt,zt,st,ft)}),J=Og($),se={"flex-start":0,"flex-end":M?r-J.width:i-J.height,center:M?(r-J.width)/2:(i-J.height)/2},pe=$.map(function(Ge){var at=Ge.x,st=Ge.y,ft=yc.fromRect(Ge);return ft.x=M?at+se[m]:at,ft.y=M?st:st+se[m],ft}),Ce=Og(pe),Ue=function(Ge){var at=(0,z.CR)(M?["height",i]:["width",r],2),st=at[0],ft=at[1];switch(R){case"flex-start":return 0;case"flex-end":return ft-Ge[st];case"center":return ft/2-Ge[st]/2;default:return 0}},Je=pe.map(function(Ge){var at=Ge.x,st=Ge.y,ft=yc.fromRect(Ge);return ft.x=M?at:at+Ue(ft),ft.y=M?st+Ue(ft):st,ft}),lt=Je.map(function(Ge){var at,st,ft=yc.fromRect(Ge);return ft.x+=(at=e.x)!==null&&at!==void 0?at:0,ft.y+=(st=e.y)!==null&&st!==void 0?st:0,ft});return lt},v_=function(e,t,n){return[]},Q0=function(e,t,n){if(t.length===0)return[];var r={flex:m_,grid:v_},i=n.display in r?r[n.display]:null;return(i==null?void 0:i.call(null,e,t,n))||[]},Gy=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n)||this;r.layoutEvents=[wa.BOUNDS_CHANGED,wa.INSERTED,wa.REMOVED],r.$margin=jf(0),r.$padding=jf(0);var i=n.style||{},s=i.margin,l=s===void 0?0:s,u=i.padding,h=u===void 0?0:u;return r.margin=l,r.padding=h,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(t.prototype,"margin",{get:function(){return this.$margin},set:function(n){this.$margin=jf(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.$padding},set:function(n){this.$padding=jf(n)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n=this.attributes,r=n.x,i=r===void 0?0:r,s=n.y,l=s===void 0?0:s,u=n.width,h=n.height,p=(0,z.CR)(this.$margin,4),m=p[0],y=p[1],b=p[2],w=p[3];return new yc(i-w,l-m,u+w+y,h+m+b)},t.prototype.appendChild=function(n,r){return n.isMutationObserved=!0,e.prototype.appendChild.call(this,n,r),n},t.prototype.getAvailableSpace=function(){var n=this.attributes,r=n.width,i=n.height,s=(0,z.CR)(this.$padding,4),l=s[0],u=s[1],h=s[2],p=s[3],m=(0,z.CR)(this.$margin,4),y=m[0],b=m[3];return new yc(p+b,l+y,r-p-u,i-l-h)},t.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(l){return!l.isConnected}))try{var n=this.attributes,r=n.x,i=n.y;this.style.transform="translate(".concat(r,", ").concat(i,")");var s=Q0(this.getAvailableSpace(),this.children.map(function(l){return l.getBBox()}),this.attributes);this.children.forEach(function(l,u){var h=s[u],p=h.x,m=h.y;l.style.transform="translate(".concat(p,", ").concat(m,")")})}catch(l){}},t.prototype.bindEvents=function(){var n=this;this.layoutEvents.forEach(function(r){n.addEventListener(r,function(i){i.target.isMutationObserved=!0,n.layout()})})},t.prototype.attributeChangedCallback=function(n,r,i){n==="margin"?this.margin=i:n==="padding"&&(this.padding=i),this.layout()},t}(Ci),uC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function g_(e){return class extends Xr{constructor(t){super(t),this.descriptor=e}connectedCallback(){var t,n;(n=(t=this.descriptor).render)===null||n===void 0||n.call(t,this.attributes,this)}update(t={}){var n,r;this.attr(ni({},this.attributes,t)),(r=(n=this.descriptor).render)===null||r===void 0||r.call(n,this.attributes,this)}}}function tS(e,t,n){return e.querySelector(t)?Pa(e).select(t):Pa(e).append(n)}function y_(e){return Array.isArray(e)?e.join(", "):`${e||""}`}function Pv(e,t){const n={display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"};let{flexDirection:r,justifyContent:i,alignItems:s}=n;const l={top:["row","flex-start","center"],bottom:["row","flex-start","center"],left:["column","flex-start","center"],right:["column","flex-start","center"],center:["column","center","center"]};return e in l&&([r,i,s]=l[e]),Object.assign({display:"flex",flexDirection:r,justifyContent:i,alignItems:s},t)}class Xy extends Gy{get child(){var t;return(t=this.children)===null||t===void 0?void 0:t[0]}update(t){var n;this.attr(t);const{subOptions:r}=t;(n=this.child)===null||n===void 0||n.update(r)}}class fC extends Xy{update(t){var n;const{subOptions:r}=t;this.attr(t),(n=this.child)===null||n===void 0||n.update(r)}}function Pd(e,t){var n;return(n=e.filter(r=>r.getOptions().name===t))===null||n===void 0?void 0:n[0]}function Yy(e){return e==="horizontal"||e===0}function __(e){return e==="vertical"||e===-Math.PI/2}function nS(e,t,n){const{bbox:r}=e,{position:i="top",size:s,length:l}=t,u=["top","bottom","center"].includes(i),[h,p]=u?[r.height,r.width]:[r.width,r.height],{defaultSize:m,defaultLength:y}=n.props,b=s||m||h,w=l||y||p,R=u?"horizontal":"vertical",[M,I]=u?[w,b]:[b,w];return{orientation:R,width:M,height:I,size:b,length:w}}function $y(e){return e.find(t=>t.getOptions().domain.length>0).getOptions().domain}function b_(e){const t=["arrow","crosshairs","grid","handle","handleLabel","indicator","label","line","tick","tip","title","trunc"],{style:n}=e,r=uC(e,["style"]),i={};return Object.entries(r).forEach(([s,l])=>{t.includes(s)?i[`show${Sv(s)}`]=l:i[s]=l}),Object.assign(Object.assign({},i),n)}var rS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function iS(e,t){const{eulerAngles:n,origin:r}=t;r&&e.setOrigin(r),n&&e.rotate(n[0],n[1],n[2])}function ix(e){const{innerWidth:t,innerHeight:n,depth:r}=e.getOptions();return[t,n,r]}function Qu(e,t){const{width:n,height:r}=t.getOptions();return i=>{if(!yE(t))return i;const s=e==="bottom"?[i,1]:[0,i],l=t.map(s);if(e==="bottom"){const u=l[0];return new hh({domain:[0,n],range:[0,1]}).map(u)}else if(e==="left"){const u=l[1];return new hh({domain:[0,r],range:[0,1]}).map(u)}return i}}function ox(e,t,n){if(e.getTicks)return e.getTicks();if(!n)return t;const[r,i]=S0(t,l=>+l),{tickCount:s}=e.getOptions();return n(r,i,s)}function hC(e,t){if(Ml(t))return w=>w;const n=t.getOptions(),{innerWidth:r,innerHeight:i,insetTop:s,insetBottom:l,insetLeft:u,insetRight:h}=n,[p,m,y]=e==="left"||e==="right"?[s,l,i]:[u,h,r],b=new hh({domain:[0,1],range:[p/y,1-m/y]});return w=>b.map(w)}function x_(e,t,n,r,i,s,l,u){var h;(n!==void 0||s!==void 0)&&e.update(Object.assign(Object.assign({},n&&{tickCount:n}),s&&{tickMethod:s}));const p=ox(e,t,s),m=i?p.filter(i):p,y=N=>N instanceof Date?String(N):typeof N=="object"&&N?N:String(N),b=r||((h=e.getFormatter)===null||h===void 0?void 0:h.call(e))||y,w=hC(l,u),R=Qu(l,u),M=N=>["top","bottom","center","outer"].includes(N),I=N=>["left","right"].includes(N);return Ml(u)||gc(u)?m.map((N,U,Z)=>{var Y,$;const J=((Y=e.getBandWidth)===null||Y===void 0?void 0:Y.call(e,N))/2||0,se=w(e.map(N)+J);return{value:My(u)&&l==="center"||gc(u)&&(($=e.getTicks)===null||$===void 0?void 0:$.call(e))&&M(l)||gc(u)&&I(l)?1-se:se,label:y(b($1(N),U,Z)),id:String(U)}}):m.map((N,U,Z)=>{var Y;const $=((Y=e.getBandWidth)===null||Y===void 0?void 0:Y.call(e,N))/2||0,J=R(w(e.map(N)+$));return{value:I(l)?1-J:J,label:y(b($1(N),U,Z)),id:String(U)}})}function dC(e,t,n="xy"){const[r,i,s]=ix(t);return n==="xy"?e.includes("bottom")||e.includes("top")?i:r:n==="xz"?e.includes("bottom")||e.includes("top")?s:r:e.includes("bottom")||e.includes("top")?i:s}function pC(e=[],t){if(e.length>0)return e;const{labelAutoRotate:n,labelAutoHide:r,labelAutoEllipsis:i,labelAutoWrap:s}=t,l=[],u=(h,p)=>{p&&l.push(Object.assign(Object.assign({},h),p))};return u({type:"rotate",optionalAngles:[0,15,30,45,60,90]},n),u({type:"ellipsis",minLength:20},i),u({type:"hide"},r),u({type:"wrap",wordWrapWidth:100,maxLines:3,recoveryWhenFail:!0},s),l}function mC(e,t,n,r,i){const{x:s,y:l,width:u,height:h}=t,p=[s+u/2,l+h/2],m=Math.min(u,h)/2,[y,b]=bE(i),[w,R]=ix(i),M=Math.min(w,R)/2,I={center:p,radius:m,startAngle:y,endAngle:b,gridLength:(r-n)*M};if(e==="inner"){const{insetLeft:N,insetTop:U}=i.getOptions();return Object.assign(Object.assign({},I),{center:[p[0]-N,p[1]-U],labelAlign:"perpendicular",labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"})}return Object.assign(Object.assign({},I),{labelAlign:"parallel",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"})}function ax(e,t,n){return _E(t)||Py(t)?!1:e===void 0?!!n.getTicks:e}function oS(e){const{depth:t}=e.getOptions();return t?{tickIsBillboard:!0,lineIsBillboard:!0,labelIsBillboard:!0,titleIsBillboard:!0,gridIsBillboard:!0}:{}}function vC(e,t,n,r,i){const{x:s,y:l,width:u,height:h}=n;if(e==="bottom")return{startPos:[s,l],endPos:[s+u,l]};if(e==="left")return{startPos:[s+u,l+h],endPos:[s+u,l]};if(e==="right")return{startPos:[s,l+h],endPos:[s,l]};if(e==="top")return{startPos:[s,l+h],endPos:[s+u,l+h]};if(e==="center"){if(t==="vertical")return{startPos:[s,l],endPos:[s,l+h]};if(t==="horizontal")return{startPos:[s,l],endPos:[s+u,l]};if(typeof t=="number"){const[p,m]=r.getCenter(),[y,b]=K1(r),[w,R]=bE(r),M=Math.min(u,h)/2,{insetLeft:I,insetTop:N}=r.getOptions(),U=y*M,Z=b*M,[Y,$]=[p+s-I,m+l-N],[J,se]=[Math.cos(t),Math.sin(t)],pe=[Y+Z*J,$+Z*se],Ce=[Y+U*J,$+U*se],Ue=()=>{const{domain:lt}=i.getOptions();return lt.length},Je=Ml(r)&&i?Ue():3;return{startPos:pe,endPos:Ce,gridClosed:Math.abs(R-w-360)<1e-6,gridCenter:[Y,$],gridControlAngles:new Array(Je).fill(0).map((lt,Ge,at)=>(R-w)/Je*Ge)}}}return{}}const Rg=e=>{const{order:t,size:n,position:r,orientation:i,labelFormatter:s,tickFilter:l,tickCount:u,tickMethod:h,important:p={},style:m={},indexBBox:y,title:b,grid:w=!1}=e,R=rS(e,["order","size","position","orientation","labelFormatter","tickFilter","tickCount","tickMethod","important","style","indexBBox","title","grid"]);return({scales:[M],value:I,coordinate:N,theme:U})=>{const{bbox:Z}=I,{domain:Y}=M.getOptions(),$=x_(M,Y,u,s,l,h,r,N),J=y?$.map((Ge,at)=>{const st=y.get(at);return!st||st[0]!==Ge.label?Ge:Object.assign(Object.assign({},Ge),{bbox:st[1]})}):$,[se,pe]=K1(N),Ce=mC(r,Z,se,pe,N),{axis:Ue,axisArc:Je={}}=U,lt=b_(ni({},Ue,Je,Ce,Object.assign(Object.assign({type:"arc",data:J,titleText:y_(b),grid:w},R),p)));return new c_({style:oc(lt,["transform"])})}};function gC(e,t,n,r,i,s){const l=n.axis,u=["top","right","bottom","left"].includes(i)?n[`axis${Mb(i)}`]:n.axisLinear,h=e.getOptions().name,p=n[`axis${Sv(h)}`]||{};return Object.assign({},l,u,p)}function yC(e,t,n,r,i,s){const l=gC(e,t,n,r,i,s);return i==="center"?Object.assign(Object.assign(Object.assign(Object.assign({},l),{labelDirection:r==="right"?"negative":"positive"}),r==="center"?{labelTransform:"translate(50%,0)"}:null),{tickDirection:r==="right"?"negative":"positive",labelSpacing:r==="center"?0:4,titleSpacing:__(s)?10:0,tick:r==="center"?!1:void 0}):l}const _C=e=>{const{direction:t="left",important:n={},labelFormatter:r,order:i,orientation:s,actualPosition:l,position:u,size:h,style:p={},title:m,tickCount:y,tickFilter:b,tickMethod:w,transform:R,indexBBox:M}=e,I=rS(e,["direction","important","labelFormatter","order","orientation","actualPosition","position","size","style","title","tickCount","tickFilter","tickMethod","transform","indexBBox"]);return({scales:N,value:U,coordinate:Z,theme:Y})=>{const{bbox:$}=U,[J]=N,{domain:se,xScale:pe}=J.getOptions(),Ce=yC(J,Z,Y,t,u,s),Ue=Object.assign(Object.assign(Object.assign({},Ce),p),I),Je=dC(l||u,Z,e.plane),lt=vC(u,s,$,Z,pe),Ge=oS(Z),at=x_(J,se,y,r,b,w,u,Z),st=M?at.map((wt,zt)=>{const En=M.get(zt);return!En||En[0]!==wt.label?wt:Object.assign(Object.assign({},wt),{bbox:En[1]})}):at,ft=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ue),{type:"linear",data:st,crossSize:h,titleText:y_(m),labelOverlap:pC(R,Ue),grid:ax(Ue.grid,Z,J),gridLength:Je,line:!0,indexBBox:M}),Ue.line?null:{lineOpacity:0}),lt),Ge),n);return ft.labelOverlap.find(wt=>wt.type==="hide")&&(ft.crossSize=!1),new c_({className:"axis",style:b_(ft)})}},aS=e=>t=>{const{labelFormatter:n,labelFilter:r=()=>!0}=t;return i=>{var s;const{scales:[l]}=i,u=((s=l.getTicks)===null||s===void 0?void 0:s.call(l))||l.getOptions().domain,h=typeof n=="string"?Lm(n):n,p=(y,b,w)=>r(u[b],b,u),m=Object.assign(Object.assign({},t),{labelFormatter:h,labelFilter:p,scale:l});return e(m)(i)}},Um=aS(_C),sS=aS(Rg);Um.props={defaultPosition:"center",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]},sS.props={defaultPosition:"outer",defaultOrientation:"vertical",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]};var bC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function lS(e){const t=e%(Math.PI*2);return t===Math.PI/2?{titleTransform:"translate(0, 50%)"}:t>-Math.PI/2&&t<Math.PI/2?{titleTransform:"translate(50%, 0)"}:t>Math.PI/2&&t<Math.PI*3/2?{titleTransform:"translate(-50%, 0)"}:{}}function xC(e,t,n,r){const{radar:i}=e,[s]=r,l=s.getOptions().name,[u,h]=bE(n),{axisRadar:p={}}=t;return Object.assign(Object.assign({},p),{grid:l==="position",gridConnect:"line",gridControlAngles:new Array(i.count).fill(0).map((m,y)=>(h-u)/i.count*y)})}const sx=e=>{const{important:t={}}=e,n=bC(e,["important"]);return r=>{const{theme:i,coordinate:s,scales:l}=r;return Um(Object.assign(Object.assign(Object.assign({},n),lS(e.orientation)),{important:Object.assign(Object.assign({},xC(e,i,s,l)),t)}))(r)}};sx.props=Object.assign(Object.assign({},Um.props),{defaultPosition:"center"});function Ky(e,t){return+e.toPrecision(t)}function PP(e){return e.toLocaleString()}function IP(e){return e.toExponential()}function LP(e,t){return t===void 0&&(t=0),Math.abs(e)<1e3?String(e):"".concat(Ky(e/1e3,t).toLocaleString(),"K")}var lx=function(e,t,n){return e<0&&Number.isFinite(e)?t:n},qy=function(e,t,n){return e>0&&Number.isFinite(e)?t:n},DP=function(e,t){return e*t},NP=function(e,t){return e/2+(t||0)/2};function E_(e){var t=e.canvas,n=e.touches,r=e.offsetX,i=e.offsetY;if(t){var s=t.x,l=t.y;return[s,l]}if(n){var u=n[0],h=u.clientX,p=u.clientY;return[h,p]}return r&&i?[r,i]:[0,0]}var EC={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(e){return e.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},cx=lp({background:"background",labelGroup:"label-group",label:"label"},"indicator"),SC=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n,EC)||this;return r.point=[0,0],r.group=r.appendChild(new Ci({})),r.isMutationObserved=!0,r}return t.prototype.renderBackground=function(){if(this.label){var n=this.attributes,r=n.position,i=n.padding,s=(0,z.CR)(jf(i),4),l=s[0],u=s[1],h=s[2],p=s[3],m=this.label.node().getLocalBounds(),y=m.min,b=m.max,w=new yc(y[0]-p,y[1]-l,b[0]+u-y[0]+p,b[1]+h-y[1]+l),R=this.getPath(r,w),M=sa(this.attributes,"background");this.background=$a(this.group).maybeAppendByClassName(cx.background,"path").styles((0,z.pi)((0,z.pi)({},M),{d:R})),this.group.appendChild(this.label.node())}},t.prototype.renderLabel=function(){var n=this.attributes,r=n.formatter,i=n.labelText,s=sa(this.attributes,"label"),l=(0,z.CR)(Pl(s),2),u=l[0],h=l[1],p=u.text,m=(0,z._T)(u,["text"]);if(this.label=$a(this.group).maybeAppendByClassName(cx.labelGroup,"g").styles(h),!!i){var y=this.label.maybeAppendByClassName(cx.label,function(){return fh(r(i))}).style("text",r(i).toString());y.selectAll("text").styles(m)}},t.prototype.adjustLayout=function(){var n=(0,z.CR)(this.point,2),r=n[0],i=n[1],s=this.attributes,l=s.x,u=s.y;this.group.attr("transform","translate(".concat(l-r,", ").concat(u-i,")"))},t.prototype.getPath=function(n,r){var i=this.attributes.radius,s=r.x,l=r.y,u=r.width,h=r.height,p=[["M",s+i,l],["L",s+u-i,l],["A",i,i,0,0,1,s+u,l+i],["L",s+u,l+h-i],["A",i,i,0,0,1,s+u-i,l+h],["L",s+i,l+h],["A",i,i,0,0,1,s,l+h-i],["L",s,l+i],["A",i,i,0,0,1,s+i,l],["Z"]],m={top:4,right:6,bottom:0,left:2},y=m[n],b=this.createCorner([p[y].slice(-2),p[y+1].slice(-2)]);return p.splice.apply(p,(0,z.ev)([y+1,1],(0,z.CR)(b),!1)),p[0][0]="M",p},t.prototype.createCorner=function(n,r){r===void 0&&(r=10);var i=.8,s=ZA.apply(void 0,(0,z.ev)([],(0,z.CR)(n),!1)),l=(0,z.CR)(n,2),u=(0,z.CR)(l[0],2),h=u[0],p=u[1],m=(0,z.CR)(l[1],2),y=m[0],b=m[1],w=(0,z.CR)(s?[y-h,[h,y]]:[b-p,[p,b]],2),R=w[0],M=(0,z.CR)(w[1],2),I=M[0],N=M[1],U=R/2,Z=R/Math.abs(R),Y=r*Z,$=Y/2,J=Y*Math.sqrt(3)/2*i,se=(0,z.CR)([I,I+U-$,I+U,I+U+$,N],5),pe=se[0],Ce=se[1],Ue=se[2],Je=se[3],lt=se[4];return s?(this.point=[Ue,p-J],[["L",pe,p],["L",Ce,p],["L",Ue,p-J],["L",Je,p],["L",lt,p]]):(this.point=[h+J,Ue],[["L",h,pe],["L",h,Ce],["L",h+J,Ue],["L",h,Je],["L",h,lt]])},t.prototype.applyVisibility=function(){var n=this.attributes.visibility;n==="hidden"?Dm(this):Iy(this)},t.prototype.bindEvents=function(){this.label.on(wa.BOUNDS_CHANGED,this.renderBackground)},t.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},t}(Af),ux={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},cS={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},fx={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Ju=lp({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),jm=lp({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),TC=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(n,r){var i=n.x,s=n.y,l=n.size,u=l===void 0?10:l,h=n.radius,p=h===void 0?u/4:h,m=n.orientation,y=(0,z._T)(n,["x","y","size","radius","orientation"]),b=u,w=b*2.4,R=$a(r).maybeAppendByClassName(jm.iconRect,"rect").styles((0,z.pi)((0,z.pi)({},y),{width:b,height:w,radius:p,x:i-b/2,y:s-w/2,transformOrigin:"center"})),M=i+1/3*b-b/2,I=i+2/3*b-b/2,N=s+1/4*w-w/2,U=s+3/4*w-w/2;R.maybeAppendByClassName("".concat(jm.iconLine,"-1"),"line").styles((0,z.pi)({x1:M,x2:M,y1:N,y2:U},y)),R.maybeAppendByClassName("".concat(jm.iconLine,"-2"),"line").styles((0,z.pi)({x1:I,x2:I,y1:N,y2:U},y)),m==="vertical"&&(R.node().style.transform="rotate(90)")},t}(Af),hx=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,fx)||this}return t.prototype.renderLabel=function(n){var r=this,i=this.attributes,s=i.x,l=i.y,u=i.showLabel,h=sa(this.attributes,"label"),p=h.x,m=p===void 0?0:p,y=h.y,b=y===void 0?0:y,w=h.transform,R=h.transformOrigin,M=(0,z._T)(h,["x","y","transform","transformOrigin"]),I=(0,z.CR)(Pl(M,[]),2),N=I[0],U=I[1],Z=$a(n).maybeAppendByClassName(jm.labelGroup,"g").styles(U),Y=(0,z.pi)((0,z.pi)({},cS),N),$=Y.text,J=(0,z._T)(Y,["text"]);sd(!!u,Z,function(se){r.label=se.maybeAppendByClassName(jm.label,"text").styles((0,z.pi)((0,z.pi)({},J),{x:s+m,y:l+b,transform:w,transformOrigin:R,text:"".concat($)})),r.label.on("mousedown",function(pe){pe.stopPropagation()}),r.label.on("touchstart",function(pe){pe.stopPropagation()})})},t.prototype.renderIcon=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.orientation,u=r.type,h=(0,z.pi)((0,z.pi)({x:i,y:s,orientation:l},ux),sa(this.attributes,"icon")),p=this.attributes.iconShape,m=p===void 0?function(){return new TC({style:h})}:p,y=$a(n).maybeAppendByClassName(jm.iconGroup,"g");y.selectAll(jm.icon.class).data([m]).join(function(b){return b.append(typeof m=="string"?m:function(){return m(u)}).attr("className",jm.icon.name)},function(b){return b.update(h)},function(b){return b.remove()})},t.prototype.render=function(n,r){this.renderIcon(r),this.renderLabel(r)},t}(Af),uS=function(e,t,n){return[["M",e-n,t],["A",n,n,0,1,0,e+n,t],["A",n,n,0,1,0,e-n,t],["Z"]]},wC=uS,fS=function(e,t,n){return[["M",e-n,t-n],["L",e+n,t-n],["L",e+n,t+n],["L",e-n,t+n],["Z"]]},AC=function(e,t,n){return[["M",e-n,t],["L",e,t-n],["L",e+n,t],["L",e,t+n],["Z"]]},CC=function(e,t,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t+r],["L",e,t-r],["L",e+n,t+r],["Z"]]},hS=function(e,t,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t-r],["L",e+n,t-r],["L",e,t+r],["Z"]]},OC=function(e,t,n){var r=n/2*Math.sqrt(3);return[["M",e,t-n],["L",e+r,t-n/2],["L",e+r,t+n/2],["L",e,t+n],["L",e-r,t+n/2],["L",e-r,t-n/2],["Z"]]},RC=function(e,t,n){var r=n-1.5;return[["M",e-n,t-r],["L",e+n,t+r],["L",e+n,t-r],["L",e-n,t+r],["Z"]]},Qy=function(e,t,n){return[["M",e,t+n],["L",e,t-n]]},MC=function(e,t,n){return[["M",e-n,t-n],["L",e+n,t+n],["M",e+n,t-n],["L",e-n,t+n]]},PC=function(e,t,n){return[["M",e-n/2,t-n],["L",e+n/2,t-n],["M",e,t-n],["L",e,t+n],["M",e-n/2,t+n],["L",e+n/2,t+n]]},IC=function(e,t,n){return[["M",e-n,t],["L",e+n,t],["M",e,t-n],["L",e,t+n]]},LC=function(e,t,n){return[["M",e-n,t],["L",e+n,t]]},dS=function(e,t,n){return[["M",e-n,t],["L",e+n,t]]},DC=dS,pS=function(e,t,n){return[["M",e-n,t],["A",n/2,n/2,0,1,1,e,t],["A",n/2,n/2,0,1,0,e+n,t]]},NC=function(e,t,n){return[["M",e-n-1,t-2.5],["L",e,t-2.5],["L",e,t+2.5],["L",e+n+1,t+2.5]]},BC=function(e,t,n){return[["M",e-n-1,t+2.5],["L",e,t+2.5],["L",e,t-2.5],["L",e+n+1,t-2.5]]},mS=function(e,t,n){return[["M",e-(n+1),t+2.5],["L",e-n/2,t+2.5],["L",e-n/2,t-2.5],["L",e+n/2,t-2.5],["L",e+n/2,t+2.5],["L",e+n+1,t+2.5]]};function Jy(e,t){return[["M",e-5,t+2.5],["L",e-5,t],["L",e,t],["L",e,t-3],["L",e,t+3],["L",e+6.5,t+3]]}var FC=function(e,t,n){return[["M",e-n,t-n],["L",e+n,t],["L",e-n,t+n],["Z"]]};function kC(e){var t="default";if(ca(e)&&e instanceof Image)t="image";else if(Ih(e))t="symbol";else if(bi(e)){var n=new RegExp("data:(image|text)");e.match(n)?t="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)?t="url":t="symbol"}return t}function zC(e){var t=kC(e);return["base64","url","image"].includes(t)?"image":e&&t==="symbol"?"path":null}var pl=function(e){(0,z.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l,h=this.getSubShapeStyle(n),p=h.symbol,m=h.size,y=m===void 0?16:m,b=(0,z._T)(h,["symbol","size"]),w=zC(p);sd(!!w,$a(r),function(R){R.maybeAppendByClassName("marker",w).attr("className","marker ".concat(w,"-marker")).call(function(M){if(w==="image"){var I=y*2;M.styles({img:p,width:I,height:I,x:s-y,y:u-y})}else{var I=y/2,N=Ih(p)?p:t.getSymbol(p);M.styles((0,z.pi)({d:N==null?void 0:N(s,u,I)},b))}})})},t.MARKER_SYMBOL_MAP=new Map,t.registerSymbol=function(n,r){t.MARKER_SYMBOL_MAP.set(n,r)},t.getSymbol=function(n){return t.MARKER_SYMBOL_MAP.get(n)},t.getSymbols=function(){return Array.from(t.MARKER_SYMBOL_MAP.keys())},t}(Af);pl.registerSymbol("cross",MC),pl.registerSymbol("hyphen",LC),pl.registerSymbol("line",Qy),pl.registerSymbol("plus",IC),pl.registerSymbol("tick",PC),pl.registerSymbol("circle",uS),pl.registerSymbol("point",wC),pl.registerSymbol("bowtie",RC),pl.registerSymbol("hexagon",OC),pl.registerSymbol("square",fS),pl.registerSymbol("diamond",AC),pl.registerSymbol("triangle",CC),pl.registerSymbol("triangle-down",hS),pl.registerSymbol("line",Qy),pl.registerSymbol("dot",dS),pl.registerSymbol("dash",DC),pl.registerSymbol("smooth",pS),pl.registerSymbol("hv",NC),pl.registerSymbol("vh",BC),pl.registerSymbol("hvh",mS),pl.registerSymbol("vhv",Jy);function UC(e,t,n){var r=Math.round((e-n)/t);return n+r*t}function dx(e,t,n){var r=1.4,i=r*n;return[["M",e-n,t-i],["L",e+n,t-i],["L",e+n,t+i],["L",e-n,t+i],["Z"]]}var vS=1.4,gS=.4;function S_(e,t,n){var r=n,i=r*vS,s=r/2,l=r/6,u=e+i*gS;return[["M",e,t],["L",u,t+s],["L",e+i,t+s],["L",e+i,t-s],["L",u,t-s],["Z"],["M",u,t+l],["L",e+i-2,t+l],["M",u,t-l],["L",e+i-2,t-l]]}function jC(e,t,n){var r=n,i=r*vS,s=r/2,l=r/6,u=t+i*gS;return[["M",e,t],["L",e-s,u],["L",e-s,t+i],["L",e+s,t+i],["L",e+s,u],["Z"],["M",e-l,u],["L",e-l,t+i-2],["M",e+l,u],["L",e+l,t+i-2]]}pl.registerSymbol("hiddenHandle",dx),pl.registerSymbol("verticalHandle",S_),pl.registerSymbol("horizontalHandle",jC);var BP=function(e,t,n){return e===void 0&&(e="horizontal"),e==="horizontal"?t:n};function VC(e,t,n,r){var i;r===void 0&&(r=4);var s=(0,z.CR)(e,2),l=s[0],u=s[1],h=(0,z.CR)(t,2),p=h[0],m=h[1],y=(0,z.CR)(n,2),b=y[0],w=y[1],R=(0,z.CR)([p,m],2),M=R[0],I=R[1],N=I-M;return M>I&&(i=(0,z.CR)([I,M],2),M=i[0],I=i[1]),N>u-l?[l,u]:M<l?b===l&&w===I?[l,I]:[l,N+l]:I>u?w===u&&b===M?[M,u]:[u-N,u]:[M,I]}function Hp(e,t,n){return e===void 0&&(e="horizontal"),e==="horizontal"?t:n}var e1=lp({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),yS={showLabel:!0,formatter:function(e){return e.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},_S=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,yS)||this}return t.prototype.render=function(n,r){var i=$a(r).maybeAppendByClassName(e1.markerGroup,"g");this.renderMarker(i);var s=$a(r).maybeAppendByClassName(e1.labelGroup,"g");this.renderLabel(s)},t.prototype.renderMarker=function(n){var r=this,i=this.attributes,s=i.orientation,l=i.markerSymbol,u=l===void 0?Hp(s,"horizontalHandle","verticalHandle"):l;sd(!!u,n,function(h){var p=sa(r.attributes,"marker"),m=(0,z.pi)({symbol:u},p);r.marker=h.maybeAppendByClassName(e1.marker,function(){return new pl({style:m})}).update(m)})},t.prototype.renderLabel=function(n){var r=this,i=this.attributes,s=i.showLabel,l=i.orientation,u=i.spacing,h=u===void 0?0:u,p=i.formatter;sd(s,n,function(m){var y,b=sa(r.attributes,"label"),w=b.text,R=(0,z._T)(b,["text"]),M=((y=m.select(e1.marker.class))===null||y===void 0?void 0:y.node().getBBox())||{},I=M.width,N=I===void 0?0:I,U=M.height,Z=U===void 0?0:U,Y=(0,z.CR)(Hp(l,[0,Z+h,"center","top"],[N+h,0,"start","middle"]),4),$=Y[0],J=Y[1],se=Y[2],pe=Y[3];m.maybeAppendByClassName(e1.label,"text").styles((0,z.pi)((0,z.pi)({},R),{x:$,y:J,text:p(w).toString(),textAlign:se,textBaseline:pe}))})},t}(Af),t1={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},Mg=Y0({},t1,{}),HC=Y0({},t1,Hl(yS,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),ZC=.01,px=.5,Zf=lp({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend");function WC(e,t){for(var n=1;n<e.length;n+=1){var r=e[n-1],i=e[n];if(t>=r&&t<=i)return[r,i]}return[t,t]}function sl(e,t,n){var r=Array.from(t),i=e.length;return new Array(i).fill(0).reduce(function(s,l,u){var h=r[u%r.length];return s+=" ".concat(e[u],":").concat(h).concat(u<i-1?" ".concat(e[u+1],":").concat(h):"")},"l(".concat(n==="horizontal"?"0":"270",")"))}function mx(e,t){var n=(0,z.CR)(WC(e,t),2),r=n[0],i=n[1];return{tick:t>(r+i)/2?i:r,range:[r,i]}}var Pg=lp({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function bS(e){var t=e.orientation,n=e.size,r=e.length;return Hp(t,[r,n],[n,r])}function n1(e){var t=e.type,n=(0,z.CR)(bS(e),2),r=n[0],i=n[1];return t==="size"?[["M",0,i],["L",0+r,0],["L",0+r,i],["Z"]]:[["M",0,i],["L",0,0],["L",0+r,0],["L",0+r,i],["Z"]]}function xS(e){return n1(e)}function GC(e){var t=e.orientation,n=e.color,r=e.block,i=e.partition,s;if(Ih(n)){var l=20;s=new Array(l).fill(0).map(function(p,m,y){return n(m/(y.length-1))})}else s=n;var u=s.length,h=s.map(function(p){return Kh(p).toString()});return u?u===1?h[0]:r?sl(i,h,t):h.reduce(function(p,m,y){return p+=" ".concat(y/(u-1),":").concat(m)},"l(".concat(Hp(t,"0","270"),")")):""}function XC(e){var t=e.orientation,n=e.range;if(!n)return[];var r=(0,z.CR)(bS(e),2),i=r[0],s=r[1],l=(0,z.CR)(n,2),u=l[0],h=l[1],p=Hp(t,u*i,0),m=Hp(t,0,u*s),y=Hp(t,h*i,i),b=Hp(t,s,h*s);return[["M",p,m],["L",p,b],["L",y,b],["L",y,m],["Z"]]}function YC(e,t){var n=sa(t,"track");e.maybeAppendByClassName(Pg.track,"path").styles((0,z.pi)({d:n1(t)},n))}function $C(e,t){var n=sa(t,"selection"),r=GC(t),i=e.maybeAppendByClassName(Pg.selection,"path").styles((0,z.pi)({d:xS(t),fill:r},n)),s=i.maybeAppendByClassName(Pg.clipPath,"path").styles({d:XC(t)}).node();i.style("clipPath",s)}var KC=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return t.prototype.render=function(n,r){var i=$a(r).maybeAppendByClassName(Pg.trackGroup,"g");YC(i,n);var s=$a(r).maybeAppendByClassName(Pg.selectionGroup,"g");$C(s,n)},t}(Af);function qC(e){return{min:Math.min.apply(Math,(0,z.ev)([],(0,z.CR)(e.map(function(t){return t.value})),!1)),max:Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(e.map(function(t){return t.value})),!1))}}var QC=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n,HC)||this;return r.eventToOffsetScale=new hh({}),r.innerRibbonScale=new hh({}),r.cacheLabelBBox=null,r.cacheHandleBBox=null,r.onHovering=function(i){var s=r.attributes,l=s.data,u=s.block;i.stopPropagation();var h=r.getValueByCanvasPoint(i);if(u){var p=mx(l.map(function(b){var w=b.value;return w}),h).range,m=r.getRealSelection(p);r.showIndicator((p[0]+p[1])/2,"".concat(m[0],"-").concat(m[1])),r.dispatchIndicated(h,p)}else{var y=r.getTickValue(h);r.showIndicator(y,"".concat(r.getRealValue(y))),r.dispatchIndicated(y)}},r.onDragStart=function(i){return function(s){s.stopPropagation(),r.attributes.slidable&&(r.target=i,r.prevValue=r.getTickValue(r.getValueByCanvasPoint(s)),document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseleave",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd))}},r.onDragging=function(i){var s=r.target;r.updateMouse();var l=(0,z.CR)(r.selection,2),u=l[0],h=l[1],p=r.getTickValue(r.getValueByCanvasPoint(i)),m=p-r.prevValue;s==="start"?u!==p&&r.updateSelection(p,h):s==="end"?h!==p&&r.updateSelection(u,p):s==="ribbon"&&m!==0&&(r.prevValue=p,r.updateSelection(m,m,!0))},r.onDragEnd=function(){r.style.cursor="pointer",document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("touchmove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r}return Object.defineProperty(t.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n=this.attributes,r=n.width,i=n.height;return new yc(0,0,r,i)},t.prototype.render=function(n,r){var i=this,s=n.showLabel;this.renderTitle($a(r));var l=this.availableSpace,u=l.x,h=l.y,p=$a(r).maybeAppendByClassName(Zf.contentGroup,"g").styles({transform:"translate(".concat(u,", ").concat(h,")")}),m=p.maybeAppendByClassName(Zf.labelGroup,"g").styles({zIndex:1});sd(!!s,m,function(b){i.renderLabel(b)});var y=p.maybeAppendByClassName(Zf.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=p.maybeAppendByClassName(Zf.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(y),this.renderIndicator(p),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(t.prototype,"range",{get:function(){var n=this.attributes,r=n.data,i=n.domain;return i?{min:i[0],max:i[1]}:qC(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonScale",{get:function(){var n=this.range,r=n.min,i=n.max;return this.innerRibbonScale.update({domain:[r,i],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonRange",{get:function(){var n=(0,z.CR)(this.selection,2),r=n[0],i=n[1],s=this.ribbonScale;return[s.map(r),s.map(i)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){var n=this.range,r=n.min,i=n.max,s=this.attributes.defaultValue,l=s===void 0?[r,i]:s,u=(0,z.CR)(l,2),h=u[0],p=u[1];return[h,p]},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(n,r){return Hp(this.attributes.orientation,typeof n=="function"?n():n,typeof r=="function"?r():r)},t.prototype.renderTitle=function(n){var r=this.attributes,i=r.showTitle,s=r.titleText,l=r.width,u=r.height,h=sa(this.attributes,"title"),p=(0,z.pi)((0,z.pi)({},h),{width:l,height:u,text:s}),m=this;n.selectAll(Zf.title.class).data(i?[s]:[]).join(function(y){return y.append(function(){return new Md({style:p})}).attr("className",Zf.title.name).each(function(){m.title=this})},function(y){return y.update(p)},function(y){return y.each(function(){m.title=void 0}).remove()})},Object.defineProperty(t.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var n=this.attributes,r=n.width,i=n.height;return new yc(0,0,r,i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelFixedSpacing",{get:function(){var n=this.attributes.showTick;return n?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelPosition",{get:function(){var n=this.attributes,r=n.orientation,i=n.labelDirection,s={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return s[r][i]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelBBox",{get:function(){var n,r=this.attributes.showLabel;if(!r)return new yc(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var i=((n=this.label.querySelector(nl.labelGroup.class))===null||n===void 0?void 0:n.children.slice(-1)[0]).getBBox(),s=i.width,l=i.height;return this.cacheLabelBBox=new yc(0,0,s,l),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelShape",{get:function(){var n=this.attributes,r=n.showLabel,i=n.labelSpacing,s=i===void 0?0:i;if(!r)return{width:0,height:0,size:0,length:0};var l=this.labelBBox,u=l.width,h=l.height,p=this.ifHorizontal(h,u)+s+this.labelFixedSpacing,m=this.ifHorizontal(u,h);return{width:u,height:h,size:p,length:m}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonBBox",{get:function(){var n=this.attributes,r=n.showHandle,i=n.ribbonSize,s=this.availableSpace,l=s.width,u=s.height,h=this.labelShape,p=h.size,m=h.length,y=(0,z.CR)(this.ifHorizontal([u,l],[l,u]),2),b=y[0],w=y[1],R=r?this.handleShape:{size:0,length:0},M=R.size,I=R.length,N=this.handleOffsetRatio,U=0,Z=this.labelPosition;i?U=i:["bottom","right"].includes(Z)?U=Math.min(b-p,(b-M)/N):b*(1-N)>M?U=Math.max(b-p,0):U=Math.max((b-p-M)/N,0);var Y=Math.max(I,m),$=w-Y,J=(0,z.CR)(this.ifHorizontal([$,U],[U,$]),2),se=J[0],pe=J[1],Ce=["top","left"].includes(Z)?p:0,Ue=(0,z.CR)(this.ifHorizontal([Y/2,Ce],[Ce,Y/2]),2),Je=Ue[0],lt=Ue[1];return new yc(Je,lt,se,pe)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonShape",{get:function(){var n=this.ribbonBBox,r=n.width,i=n.height;return this.ifHorizontal({size:i,length:r},{size:r,length:i})},enumerable:!1,configurable:!0}),t.prototype.renderRibbon=function(n){var r=this.attributes,i=r.data,s=r.type,l=r.orientation,u=r.color,h=r.block,p=sa(this.attributes,"ribbon"),m=this.range,y=m.min,b=m.max,w=this.ribbonBBox,R=w.x,M=w.y,I=this.ribbonShape,N=I.length,U=I.size,Z=Y0({transform:"translate(".concat(R,", ").concat(M,")"),length:N,size:U,type:s,orientation:l,color:u,block:h,partition:i.map(function(Y){return(Y.value-y)/(b-y)}),range:this.ribbonRange},p);this.ribbon=n.maybeAppendByClassName(Zf.ribbon,function(){return new KC({style:Z})}).update(Z)},t.prototype.getHandleClassName=function(n){return"".concat(Zf.prefix("".concat(n,"-handle")))},t.prototype.renderHandles=function(){var n=this.attributes,r=n.showHandle,i=n.orientation,s=sa(this.attributes,"handle"),l=(0,z.CR)(this.selection,2),u=l[0],h=l[1],p=(0,z.pi)((0,z.pi)({},s),{orientation:i}),m=s.shape,y=m===void 0?"slider":m,b=y==="basic"?_S:hx,w=this;this.handlesGroup.selectAll(Zf.handle.class).data(r?[{value:u,type:"start"},{value:h,type:"end"}]:[],function(R){return R.type}).join(function(R){return R.append(function(){return new b({style:p})}).attr("className",function(M){var I=M.type;return"".concat(Zf.handle," ").concat(w.getHandleClassName(I))}).each(function(M){var I=M.type,N=M.value;this.update({labelText:N});var U="".concat(I,"Handle");w[U]=this,this.addEventListener("pointerdown",w.onDragStart(I))})},function(R){return R.update(p).each(function(M){var I=M.value;this.update({labelText:I})})},function(R){return R.each(function(M){var I=M.type,N="".concat(I,"Handle");w[N]=void 0}).remove()})},t.prototype.adjustHandles=function(){var n=(0,z.CR)(this.selection,2),r=n[0],i=n[1];this.setHandlePosition("start",r),this.setHandlePosition("end",i)},Object.defineProperty(t.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new yc(0,0,0,0);var n=this.startHandle.getBBox(),r=n.width,i=n.height,s=this.endHandle.getBBox(),l=s.width,u=s.height,h=(0,z.CR)([Math.max(r,l),Math.max(i,u)],2),p=h[0],m=h[1];return this.cacheHandleBBox=new yc(0,0,p,m),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"handleShape",{get:function(){var n=this.handleBBox,r=n.width,i=n.height,s=(0,z.CR)(this.ifHorizontal([i,r],[r,i]),2),l=s[0],u=s[1];return{width:r,height:i,size:l,length:u}},enumerable:!1,configurable:!0}),t.prototype.setHandlePosition=function(n,r){var i=this.attributes.handleFormatter,s=this.ribbonBBox,l=s.x,u=s.y,h=this.ribbonShape.size,p=this.getOffset(r),m=(0,z.CR)(this.ifHorizontal([l+p,u+h*this.handleOffsetRatio],[l+h*this.handleOffsetRatio,u+p]),2),y=m[0],b=m[1],w=this.handlesGroup.select(".".concat(this.getHandleClassName(n))).node();w==null||w.update({transform:"translate(".concat(y,", ").concat(b,")"),formatter:i})},t.prototype.renderIndicator=function(n){var r=sa(this.attributes,"indicator");this.indicator=n.maybeAppendByClassName(Zf.indicator,function(){return new SC({})}).update(r)},Object.defineProperty(t.prototype,"labelData",{get:function(){var n=this,r=this.attributes.data;return r.reduce(function(i,s,l,u){var h,p,m=(h=s==null?void 0:s.id)!==null&&h!==void 0?h:l.toString();if(i.push((0,z.pi)((0,z.pi)({},s),{id:m,index:l,type:"value",label:(p=s==null?void 0:s.label)!==null&&p!==void 0?p:s.value.toString(),value:n.ribbonScale.map(s.value)})),l<u.length-1){var y=u[l+1],b=(0,z.CR)([s.value,y.value],2),w=b[0],R=b[1],M=(w+R)/2;i.push((0,z.pi)((0,z.pi)({},s),{id:m,index:l,type:"range",range:[w,R],label:[w,R].join("~"),value:n.ribbonScale.map(M)}))}return i},[])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelStyle",{get:function(){var n=(0,z.CR)(["center","middle"],2),r=n[0],i=n[1],s=this.labelPosition;return s==="top"?i="bottom":s==="bottom"?i="top":s==="left"?r="end":s==="right"&&(r="start"),{labelTextAlign:r,labelTextBaseline:i}},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(n){var r=this.attributes,i=r.showTick,s=i===void 0?!1:i,l=r.labelFilter,u=r.labelFormatter,h=sa(this.attributes,"tick"),p=sa(this.attributes,"label"),m=p.align,y=Y0((0,z.pi)({showLine:!1,showGrid:!1,showTick:s,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),Hl(h,"tick"),Hl(p,"label"),{data:this.labelData}),b={tickFilter:function(R,M,I){return(R==null?void 0:R.type)!=="value"?!1:l?l(R,R.index,I.filter(function(N){return N.type!=="value"})):!0},labelFilter:function(R,M,I){return(R==null?void 0:R.type)!==m?!1:l?l(R,R.index,I.filter(function(N){return N.type===m})):!0},labelFormatter:u},w=(0,z.pi)((0,z.pi)((0,z.pi)({},y),b),{labelOverlap:[{type:"hide"}]});this.label=n.maybeAppendByClassName(Zf.label,function(){return new c_({style:w})}).node(),this.label.update(w,!1)},Object.defineProperty(t.prototype,"labelAxisStyle",{get:function(){var n=this.attributes,r=n.showTick,i=n.labelDirection,s=n.labelSpacing,l=n.tickLength,u=this.ribbonShape.size,h=this.labelPosition,p=this.labelFixedSpacing,m=(0,z.CR)([0,0,0],3),y=m[0],b=m[1],w=m[2],R=l!=null?l:u;return r?(w=R,b=p,i==="positive"?h==="right"?(y=R,w=R):h==="bottom"&&(y=w):i==="negative"&&(h==="top"||h==="left")&&(y=u)):i==="positive"?h==="right"?b=R:h==="bottom"&&(y=u+p,b=s):i==="negative"&&(h==="left"||h==="top")&&(b=s),{offset:y,spacing:b,tickLength:w}},enumerable:!1,configurable:!0}),t.prototype.adjustLabel=function(){var n=this.attributes.showLabel;if(n){var r=this.ribbonBBox,i=r.x,s=r.y,l=r.width,u=r.height,h=this.labelAxisStyle,p=h.offset,m=h.spacing,y=h.tickLength,b=(0,z.CR)(this.ifHorizontal([[i,s+p],[i+l,s+p]],[[i+p,s+u],[i+p,s]]),2),w=b[0],R=b[1];this.label.update({startPos:w,endPos:R,tickLength:y,labelSpacing:m},!1)}},t.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},t.prototype.showIndicator=function(n,r){r===void 0&&(r="".concat(n));var i=this.attributes.showIndicator;if(!i||typeof n!="number"){this.hideIndicator();return}var s=this.range,l=s.min,u=s.max,h=this.ribbonBBox,p=h.x,m=h.y,y=(0,so.Z)(n,l,u),b=this.getOffset(y),w=this.ifHorizontal([b+p,m],[p,b+m]);this.indicator.update({x:w[0],y:w[1],position:this.ifHorizontal("top","left"),labelText:r}),Iy(this.indicator.node())},t.prototype.hideIndicator=function(){Dm(this.indicator.node())},t.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},t.prototype.setSelection=function(n,r){this.updateSelection(n,r)},t.prototype.updateSelection=function(n,r,i){var s;i===void 0&&(i=!1);var l=(0,z.CR)(this.selection,2),u=l[0],h=l[1],p=(0,z.CR)([n,r],2),m=p[0],y=p[1];i&&(m+=u,y+=h);var b=this.range,w=b.min,R=b.max;s=(0,z.CR)(VC([w,R],[m,y],this.selection),2),m=s[0],y=s[1],this.update({defaultValue:[m,y]}),this.dispatchSelection()},Object.defineProperty(t.prototype,"step",{get:function(){var n=this.attributes.step,r=n===void 0?1:n,i=this.range,s=i.min,l=i.max;return ti(r)?Ky((l-s)*ZC,0):r},enumerable:!1,configurable:!0}),t.prototype.getTickValue=function(n){var r=this.attributes,i=r.data,s=r.block,l=this.range.min;return s?mx(i.map(function(u){var h=u.value;return h}),n).tick:UC(n,this.step,l)},t.prototype.getValueByCanvasPoint=function(n){var r=this.range,i=r.min,s=r.max,l=(0,z.CR)(this.ribbon.node().getPosition(),2),u=l[0],h=l[1],p=this.ifHorizontal(u,h),m=this.ifHorizontal.apply(this,(0,z.ev)([],(0,z.CR)(E_(n)),!1)),y=m-p,b=(0,so.Z)(this.getOffset(y,!0),i,s);return b},t.prototype.getOffset=function(n,r){r===void 0&&(r=!1);var i=this.range,s=i.min,l=i.max,u=this.ribbonShape.length,h=this.eventToOffsetScale;return h.update({domain:[s,l],range:[0,u]}),r?h.invert(n):h.map(n)},t.prototype.getRealSelection=function(n){var r=this.range.max,i=(0,z.CR)(n,2),s=i[0],l=i[1];return this.ifHorizontal([s,l],[r-l,r-s])},t.prototype.getRealValue=function(n){var r=this.range.max;return this.ifHorizontal(n,r-n)},t.prototype.dispatchSelection=function(){var n=this.getRealSelection(this.selection),r=new tl("valuechange",{detail:{value:n}});this.dispatchEvent(r)},t.prototype.dispatchIndicated=function(n,r){var i=this,s=this.range.max,l=this.ifHorizontal(function(){return{value:n,range:r}},function(){return{value:s-n,range:r?i.getRealSelection(r):void 0}}),u=new tl("indicate",{detail:l});this.dispatchEvent(u)},t}(Af);class r1 extends Hy{getDefaultOptions(){return{range:[0],domain:[0,1],unknown:void 0,tickCount:5,tickMethod:Mv}}map(t){const[n]=this.options.range;return n!==void 0?n:this.options.unknown}invert(t){const[n]=this.options.range;return t===n&&n!==void 0?this.options.domain:[]}getTicks(){const{tickMethod:t,domain:n,tickCount:r}=this.options,[i,s]=n;return!(0,Ft.Z)(i)||!(0,Ft.Z)(s)?[]:t(i,s,r)}clone(){return new r1(this.options)}}class Ig extends Hy{getDefaultOptions(){return{domain:[.5],range:[0,1]}}constructor(t){super(t)}map(t){if(!d_(t))return this.options.unknown;const n=Jb(this.thresholds,t,0,this.n);return this.options.range[n]}invert(t){const{range:n}=this.options,r=n.indexOf(t),i=this.thresholds;return[i[r-1],i[r]]}clone(){return new Ig(this.options)}rescale(){const{domain:t,range:n}=this.options;this.n=Math.min(t.length,n.length-1),this.thresholds=t}}function Lg(e){return(0,sr.Z)(e)?0:ap(e)?e.length:Object.keys(e).length}var ES=function(e,t){if(!ap(e))return-1;var n=Array.prototype.indexOf;if(n)return n.call(e,t);for(var r=-1,i=0;i<e.length;i++)if(e[i]===t){r=i;break}return r},vx=ES;function i1(e){return Math.abs(e)<1e-14?e:parseFloat(e.toFixed(14))}const JC=[1,5,2,2.5,4,3],FP=null,gx=Number.EPSILON*100;function eO(e,t){return(e%t+t)%t}function tO(e){return Math.round(e*1e12)/1e12}function SS(e,t,n,r,i,s){const l=Lg(t),u=vx(t,e);let h=0;const p=eO(r,s);return(p<gx||s-p<gx)&&r<=0&&i>=0&&(h=1),1-u/(l-1)-n+h}function Iv(e,t,n){const r=Lg(t);return 1-vx(t,e)/(r-1)-n+1}function nO(e,t,n,r,i,s){const l=(e-1)/(s-i),u=(t-1)/(Math.max(s,r)-Math.min(n,i));return 2-Math.max(l/u,u/l)}function rO(e,t){return e>=t?2-(e-1)/(t-1):1}function iO(e,t,n,r){const i=t-e;return 1-.5*(vf(t-r,2)+vf(e-n,2))/vf(.1*i,2)}function TS(e,t,n){const r=t-e;if(n>r){const i=(n-r)/2;return 1-vf(i,2)/vf(.1*r,2)}return 1}function oO(){return 1}const yx=(e,t,n=5,r=!0,i=JC,s=[.25,.2,.5,.05])=>{const l=n<0?0:Math.round(n);if(Number.isNaN(e)||Number.isNaN(t)||typeof e!="number"||typeof t!="number"||!l)return[];if(t-e<1e-15||l===1)return[e];const u={score:-2,lmin:0,lmax:0,lstep:0};let h=1;for(;h<1/0;){for(let R=0;R<i.length;R+=1){const M=i[R],I=Iv(M,i,h);if(s[0]*I+s[1]+s[2]+s[3]<u.score){h=1/0;break}let N=2;for(;N<1/0;){const U=rO(N,l);if(s[0]*I+s[1]+s[2]*U+s[3]<u.score)break;const Z=(t-e)/(N+1)/h/M;let Y=Math.ceil(Math.log10(Z));for(;Y<1/0;){const $=h*M*vf(10,Y),J=TS(e,t,$*(N-1));if(s[0]*I+s[1]*J+s[2]*U+s[3]<u.score)break;const se=Math.floor(t/$)*h-(N-1)*h,pe=Math.ceil(e/$)*h;if(se<=pe){const Ce=pe-se;for(let Ue=0;Ue<=Ce;Ue+=1){const lt=(se+Ue)*($/h),Ge=lt+$*(N-1),at=$,st=SS(M,i,h,lt,Ge,at),ft=iO(e,t,lt,Ge),Vt=nO(N,l,e,t,lt,Ge),wt=oO(),zt=s[0]*st+s[1]*ft+s[2]*Vt+s[3]*wt;zt>u.score&&(!r||lt<=e&&Ge>=t)&&(u.lmin=lt,u.lmax=Ge,u.lstep=at,u.score=zt)}}Y+=1}N+=1}}h+=1}const p=i1(u.lmax),m=i1(u.lmin),y=i1(u.lstep),b=Math.floor(tO((p-m)/y))+1,w=new Array(b);w[0]=i1(m);for(let R=1;R<b;R+=1)w[R]=i1(w[R-1]+y);return w};class Dg extends Ig{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:yx}}constructor(t){super(t)}nice(){const{nice:t}=this.options;if(t){const[n,r,i]=this.getTickMethodOptions();this.options.domain=qE(n,r,i)}}getTicks(){const{tickMethod:t}=this.options,[n,r,i]=this.getTickMethodOptions();return t(n,r,i)}getTickMethodOptions(){const{domain:t,tickCount:n}=this.options,r=t[0],i=t[t.length-1];return[r,i,n]}rescale(){this.nice();const{range:t,domain:n}=this.options,[r,i]=n;this.n=t.length-1,this.thresholds=new Array(this.n);for(let s=0;s<this.n;s+=1)this.thresholds[s]=((s+1)*i-(s-this.n)*r)/(this.n+1)}invert(t){const[n,r]=super.invert(t),[i,s]=this.options.domain;return n===void 0&&r===void 0?[n,r]:[n||i,r||s]}getThresholds(){return this.thresholds}clone(){return new Dg(this.options)}}function T_(e,t){const n=e.length;if(!n)return;if(n<2)return e[n-1];const r=(n-1)*t,i=Math.floor(r),s=e[i],l=e[i+1];return s+(l-s)*(r-i)}function aO(e,t,n=!1){const r=e;n||r.sort((s,l)=>s-l);const i=[];for(let s=1;s<t;s+=1)i.push(T_(r,s/t));return i}class Ng extends Ig{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:yx}}constructor(t){super(t)}rescale(){const{domain:t,range:n}=this.options;this.n=n.length-1,this.thresholds=aO(t,this.n+1,!1)}invert(t){const[n,r]=super.invert(t),{domain:i}=this.options,s=i[0],l=i[i.length-1];return n===void 0&&r===void 0?[n,r]:[n||s,r||l]}getThresholds(){return this.thresholds}clone(){return new Ng(this.options)}getTicks(){const{tickCount:t,domain:n,tickMethod:r}=this.options,i=n.length-1,s=n[0],l=n[i];return r(s,l,t)}}var sO=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function lO(e,t,n){return e.size=t,Yy(n)?e.height=t:e.width=t,e}function cO(e,t,n){const{size:r}=t,i=nS(e,t,n);return lO(i,r,i.orientation)}function uO(e){return t=>({value:t/e,label:String(t)})}function wS(e,t,n,r,i){const s=t.thresholds,l=uO(r);return Object.assign(Object.assign({},e),{color:i,data:[n,...s,r].map(l)})}function fO(e,t,n){const i=[-1/0,...t.thresholds,1/0].map((s,l)=>({value:l,label:s}));return Object.assign(Object.assign({},e),{data:i,color:n,labelFilter:(s,l)=>l>0&&l<i.length-1})}function _x(e){const{domain:t}=e.getOptions(),[n,r]=[t[0],fE(t)];return[n,r]}function AS(e,t){const n=e.getOptions(),r=e.clone();return r.update(Object.assign(Object.assign({},n),{range:[Kh(t).toString()]})),r}function hO(e,t,n,r,i,s){const{length:l}=e,u=n||r,h=i.color?s.legendContinuous.ribbonFill||"black":s.color,p=t||AS(u,h),[m,y]=_x(p),[b,w]=_x([t,n,r].filter(R=>R!==void 0).find(R=>!(R instanceof r1)));return Object.assign(Object.assign({},e),{domain:[b,w],data:p.getTicks().map(R=>({value:R})),color:new Array(Math.floor(l)).fill(0).map((R,M)=>{const I=(y-m)/(l-1)*M+m,N=p.map(I)||h,U=r?r.map(I):1;return N.replace(/rgb[a]*\(([\d]{1,3}) *, *([\d]{1,3}) *, *([\d]{1,3})[\S\s]*\)/,(Z,Y,$,J)=>`rgba(${Y}, ${$}, ${J}, ${U})`)})})}function dO(e,t,n,r,i,s){const l=Pd(e,"color"),u=cO(n,r,i);if(l instanceof Ig){const{range:m}=l.getOptions(),[y,b]=_x(l);return l instanceof Dg||l instanceof Ng?wS(u,l,y,b,m):fO(u,l,m)}const h=Pd(e,"size"),p=Pd(e,"opacity");return hO(u,l,h,p,t,s)}const fp=e=>{const{labelFormatter:t,layout:n,order:r,orientation:i,position:s,size:l,title:u,style:h,crossPadding:p,padding:m}=e,y=sO(e,["labelFormatter","layout","order","orientation","position","size","title","style","crossPadding","padding"]);return({scales:b,value:w,theme:R,scale:M})=>{const{bbox:I}=w,{x:N,y:U,width:Z,height:Y}=I,$=Pv(s,n),{legendContinuous:J={}}=R,se=b_(Object.assign({},J,Object.assign(Object.assign({titleText:y_(u),labelAlign:"value",labelFormatter:typeof t=="string"?Ce=>Lm(t)(Ce.label):t},dO(b,M,w,e,fp,R)),h),y)),pe=new Xy({style:Object.assign(Object.assign({x:N,y:U,width:Z,height:Y},$),{subOptions:se})});return pe.appendChild(new QC({className:"legend-continuous",style:se})),pe}};fp.props={defaultPosition:"top",defaultOrientation:"vertical",defaultOrder:1,defaultSize:60,defaultLength:200,defaultLegendSize:60,defaultPadding:[20,10],defaultCrossPadding:[12,12]};const CS=e=>(...t)=>fp(Object.assign({},{block:!0},e))(...t);CS.props=Object.assign(Object.assign({},fp.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const OS=e=>t=>{const{scales:n}=t,r=Pd(n,"size");return fp(Object.assign({},{type:"size",data:r.getTicks().map((i,s)=>({value:i,label:String(i)}))},e))(t)};OS.props=Object.assign(Object.assign({},fp.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const a=e=>OS(Object.assign({},{block:!0},e));a.props=Object.assign(Object.assign({},fp.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const f=({static:e=!1}={})=>t=>{const{width:n,height:r,depth:i,paddingLeft:s,paddingRight:l,paddingTop:u,paddingBottom:h,padding:p,inset:m,insetLeft:y,insetTop:b,insetRight:w,insetBottom:R,margin:M,marginLeft:I,marginBottom:N,marginTop:U,marginRight:Z,data:Y,coordinate:$,theme:J,component:se,interaction:pe,x:Ce,y:Ue,z:Je,key:lt,frame:Ge,labelTransform:at,parentKey:st,clip:ft,viewStyle:Vt,title:wt}=t,zt=o(t,["width","height","depth","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinate","theme","component","interaction","x","y","z","key","frame","labelTransform","parentKey","clip","viewStyle","title"]);return[Object.assign(Object.assign({type:"standardView",x:Ce,y:Ue,z:Je,key:lt,width:n,height:r,depth:i,padding:p,paddingLeft:s,paddingRight:l,paddingTop:u,inset:m,insetLeft:y,insetTop:b,insetRight:w,insetBottom:R,paddingBottom:h,theme:J,coordinate:$,component:se,interaction:pe,frame:Ge,labelTransform:at,margin:M,marginLeft:I,marginBottom:N,marginTop:U,marginRight:Z,parentKey:st,clip:ft,style:Vt},!e&&{title:wt}),{marks:[Object.assign(Object.assign(Object.assign({},zt),{key:`${lt}-0`,data:Y}),e&&{title:wt})]})]};f.props={};var v=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function T(e){return(t,...n)=>ni({},e(t,...n),t)}function O(e){return(t,...n)=>ni({},t,e(t,...n))}function L(e){return e instanceof Date?!1:typeof e=="object"}function F(e,t){if(!e)return t;if(Array.isArray(e))return e;if(L(e)){const{value:n=t}=e,r=v(e,["value"]);return Object.assign(Object.assign({},r),{value:n})}return e}var H=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const ie=()=>e=>{const{children:t}=e,n=H(e,["children"]);if(!Array.isArray(t))return[];const{data:r,scale:i={},axis:s={},legend:l={},encode:u={},transform:h=[]}=n,p=H(n,["data","scale","axis","legend","encode","transform"]),m=t.map(y=>{var{data:b,scale:w={},axis:R={},legend:M={},encode:I={},transform:N=[]}=y,U=H(y,["data","scale","axis","legend","encode","transform"]);return Object.assign({data:F(b,r),scale:ni({},i,w),encode:ni({},u,I),transform:[...h,...N],axis:R&&s?ni({},s,R):!1,legend:M&&l?ni({},l,M):!1},U)});return[Object.assign(Object.assign({},p),{marks:m,type:"standardView"})]};ie.props={};function ge([e,t],[n,r]){return[e-n,t-r]}function Te([e,t],[n,r]){return[e+n,t+r]}function Ve([e,t],[n,r]){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}function Mt([e,t]){return Math.atan2(t,e)}function rn([e,t]){return Mt([e,t])+Math.PI/2}function Rn(e,t){const n=Mt(e),r=Mt(t);return n<r?r-n:Math.PI*2-(n-r)}function hr(e){let t=1/0,n=-1/0,r=1/0,i=-1/0;for(const[u,h]of e)t=Math.min(u,t),n=Math.max(u,n),r=Math.min(h,r),i=Math.max(h,i);const s=n-t,l=i-r;return[t,r,s,l]}function Nr([e,t],[n,r]){return[(e+n)/2,(t+r)/2]}function jn(e,t){for(const[n,r]of Object.entries(t))e.style(n,r)}function ci(e,t){return t.forEach((n,r)=>r===0?e.moveTo(n[0],n[1]):e.lineTo(n[0],n[1])),e.closePath(),e}function ji(e,t,n){const{arrowSize:r}=n,i=typeof r=="string"?+parseFloat(r)/100*Ve(e,t):r,s=Math.PI/6,l=Math.atan2(t[1]-e[1],t[0]-e[0]),u=Math.PI/2-l-s,h=[t[0]-i*Math.sin(u),t[1]-i*Math.cos(u)],p=l-s,m=[t[0]-i*Math.cos(p),t[1]-i*Math.sin(p)];return[h,m]}function To(e,t,n,r,i){const s=Mt(ge(r,t))+Math.PI,l=Mt(ge(r,n))+Math.PI;return e.arc(r[0],r[1],i,s,l,l-s<0),e}function Ji(e,t,n,r="y",i="between",s=!1){const l=(I,N)=>I==="y"||I===!0?N?180:90:N?90:0,u=r==="y"||r===!0?n:t,h=l(r,s),p=wv(u),[m,y]=S0(p,I=>u[I]),b=new hh({domain:[m,y],range:[0,100]}),w=I=>(0,Ft.Z)(u[I])&&!Number.isNaN(u[I])?b.map(u[I]):0,R={between:I=>`${e[I]} ${w(I)}%`,start:I=>I===0?`${e[I]} ${w(I)}%`:`${e[I-1]} ${w(I)}%, ${e[I]} ${w(I)}%`,end:I=>I===e.length-1?`${e[I]} ${w(I)}%`:`${e[I]} ${w(I)}%, ${e[I+1]} ${w(I)}%`},M=p.sort((I,N)=>w(I)-w(N)).map(R[i]||R.between).join(",");return`linear-gradient(${h}deg, ${M})`}function Hr(e){const[t,n,r,i]=e;return[i,t,n,r]}function Gi(e,t,n){const[r,i,,s]=gc(e)?Hr(t):t,[l,u]=n,h=e.getCenter(),p=rn(ge(r,h)),m=rn(ge(i,h)),y=m===p&&l!==u?m+Math.PI*2:m;return{startAngle:p,endAngle:y-p>=0?y:Math.PI*2+y,innerRadius:Ve(s,h),outerRadius:Ve(r,h)}}function ja(e){const t="connect";return Object.fromEntries(Object.entries(e).filter(([n])=>n.startsWith(t)).map(([n,r])=>[lowerFirst(n.replace(t,"").trim()),r]).filter(([n])=>n!==void 0))}function ys(e){const{colorAttribute:t,opacityAttribute:n=t}=e;return`${n}Opacity`}function $o(e,t){if(!Ml(e))return"";const n=e.getCenter(),{transform:r}=t;return`translate(${n[0]}, ${n[1]}) ${r||""}`}function cs(e){if(e.length===1)return e[0];const[[t,n,r=0],[i,s,l=0]]=e;return[(t+i)/2,(n+s)/2,(r+l)/2]}function Zs(e){return e.replace(/-(\w)/g,function(t,n){return n.toUpperCase()})}function Dh(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}var Id=Array.prototype.slice;function Nh(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cl(e){return function(){return e}}function J0(e){this._context=e}J0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Wf(e){return new J0(e)}const Lv=Math.PI,bx=2*Lv,Dv=1e-6,pO=bx-Dv;function RS(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function mO(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return RS;const n=vf(10,t);return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class w_{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?RS:mO(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,l){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+l}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let l=this._x1,u=this._y1,h=r-t,p=i-n,m=l-t,y=u-n,b=m*m+y*y;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(b>Dv)if(!(Math.abs(y*h-p*m)>Dv)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let w=r-l,R=i-u,M=h*h+p*p,I=w*w+R*R,N=Math.sqrt(M),U=Math.sqrt(b),Z=s*Math.tan((Lv-Math.acos((M+b-I)/(2*N*U)))/2),Y=Z/U,$=Z/N;Math.abs(Y-1)>Dv&&this._append`L${t+Y*m},${n+Y*y}`,this._append`A${s},${s},0,0,${+(y*w>m*R)},${this._x1=t+$*h},${this._y1=n+$*p}`}}arc(t,n,r,i,s,l){if(t=+t,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(i),h=r*Math.sin(i),p=t+u,m=n+h,y=1^l,b=l?i-s:s-i;this._x1===null?this._append`M${p},${m}`:(Math.abs(this._x1-p)>Dv||Math.abs(this._y1-m)>Dv)&&this._append`L${p},${m}`,r&&(b<0&&(b=b%bx+bx),b>pO?this._append`A${r},${r},0,1,${y},${t-u},${n-h}A${r},${r},0,1,${y},${this._x1=p},${this._y1=m}`:b>Dv&&this._append`A${r},${r},0,${+(b>=Lv)},${y},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function hp(){return new w_}hp.prototype=w_.prototype;function kP(e=3){return new w_(+e)}function la(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new w_(t)}function Ws(e){return e[0]}function ul(e){return e[1]}function ro(e,t){var n=cl(!0),r=null,i=Wf,s=null,l=la(u);e=typeof e=="function"?e:e===void 0?Ws:cl(e),t=typeof t=="function"?t:t===void 0?ul:cl(t);function u(h){var p,m=(h=Nh(h)).length,y,b=!1,w;for(r==null&&(s=i(w=l())),p=0;p<=m;++p)!(p<m&&n(y=h[p],p,h))===b&&((b=!b)?s.lineStart():s.lineEnd()),b&&s.point(+e(y,p,h),+t(y,p,h));if(w)return s=null,w+""||null}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:cl(+h),u):e},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:cl(+h),u):t},u.defined=function(h){return arguments.length?(n=typeof h=="function"?h:cl(!!h),u):n},u.curve=function(h){return arguments.length?(i=h,r!=null&&(s=i(r)),u):i},u.context=function(h){return arguments.length?(h==null?r=s=null:s=i(r=h),u):r},u}function df(e){const t=typeof e=="function"?e:e.render;return class extends Xr{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){t(this)}}}var Jl=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Ld(e){const{min:[t,n],max:[r,i]}=e.getLocalBounds();let s=0,l=0;return t>0&&(s=t),r<0&&(s=r),n>0&&(l=n),i<0&&(l=i),[s,l]}function Dd(e,t=[]){const[n=0,r=0,i=n,s=r]=t,l=e.parentNode,u=l.getEulerAngles();l.setEulerAngles(0);const{min:h,halfExtents:p}=e.getLocalBounds(),[m,y]=h,[b,w]=p;return l.setEulerAngles(u),{x:m-s,y:y-n,width:b*2+s+r,height:w*2+n+i}}const Bg=(e,t,n)=>{const r=dist(e,t),i=dist(t,n),s=dist(n,e);return(Math.pow(r,2)+Math.pow(i,2)-Math.pow(s,2))/(2*r*i)};function MS(e,t,n,r,i=!0,s=!0){const l=y=>ro()(y);if(!t[0]&&!t[1])return l([Ld(e),t]);if(!n.length)return l([[0,0],t]);const[u,h]=n,p=[...h],m=[...u];if(h[0]!==u[0]){const y=i?-4:4;p[1]=h[1],s&&!i&&(p[0]=Math.max(u[0],h[0]-y),h[1]<u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.max(m[0],p[0]-y))),!s&&!i&&(p[0]=Math.max(u[0],h[0]-y),h[1]>u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.max(m[0],p[0]-y))),!s&&i&&(p[0]=Math.min(u[0],h[0]-y),h[1]>u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.min(m[0],p[0]-y))),s&&i&&(p[0]=Math.min(u[0],h[0]-y),h[1]<u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.min(m[0],p[0]-y)))}return l([h,p,m,u,t])}const zP=df(e=>{const t=e.attributes,{className:n,class:r,transform:i,rotate:s,labelTransform:l,labelTransformOrigin:u,x:h,y:p,x0:m=h,y0:y=p,text:b,background:w,connector:R,startMarker:M,endMarker:I,coordCenter:N,innerHTML:U}=t,Z=Jl(t,["className","class","transform","rotate","labelTransform","labelTransformOrigin","x","y","x0","y0","text","background","connector","startMarker","endMarker","coordCenter","innerHTML"]);if(e.style.transform=`translate(${h}, ${p})`,[h,p,m,y].some(wt=>!(0,Ft.Z)(wt))){e.children.forEach(wt=>wt.remove());return}const Y=po(Z,"background"),{padding:$}=Y,J=Jl(Y,["padding"]),se=po(Z,"connector"),{points:pe=[]}=se,Ce=Jl(se,["points"]);let Ue;U?Ue=Pa(e).maybeAppend("html","html",n).style("zIndex",0).style("innerHTML",U).call(jn,Object.assign({transform:l,transformOrigin:u},Z)).node():Ue=Pa(e).maybeAppend("text","text").style("zIndex",0).style("text",b).call(jn,Object.assign({textBaseline:"middle",transform:l,transformOrigin:u},Z)).node();const Je=Pa(e).maybeAppend("background","rect").style("zIndex",-1).call(jn,Dd(Ue,$)).call(jn,w?J:{}).node(),lt=+m<N[0],Ge=+y<N[1],at=[+m-+h,+y-+p],st=MS(Je,at,pe,N,lt,Ge),ft=M&&new pl({id:"startMarker",style:Object.assign({x:0,y:0},po(Z,"startMarker"))}),Vt=I&&new pl({id:"endMarker",style:Object.assign({x:0,y:0},po(Z,"endMarker"))});Pa(e).maybeAppend("connector","path").style("zIndex",0).style("d",st).style("markerStart",ft).style("markerEnd",Vt).call(jn,R?Ce:{})});function A_(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);return r}function Ak(e,t,n,r){const i=t.length/2,s=t.slice(0,i),l=t.slice(i);let u=A_(s,(w,R)=>Math.abs(w[1]-l[R][1]));u=Math.max(Math.min(u,i-2),1);const h=w=>[s[w][0],(s[w][1]+l[w][1])/2],p=h(u),m=h(u-1),y=h(u+1),b=Mt(ge(y,m))/Math.PI*180;return{x:p[0],y:p[1],transform:`rotate(${b})`,textAlign:"center",textBaseline:"middle"}}function UP(e,t,n,r){const{bounds:i}=n,[[s,l],[u,h]]=i,p=u-s,m=h-l,y=b=>{const{x:w,y:R}=b,M=iE(n.x,p),I=iE(n.y,m);return Object.assign(Object.assign({},b),{x:(M||w)+s,y:(I||R)+l})};return y(e==="left"?{x:0,y:m/2,textAlign:"start",textBaseline:"middle"}:e==="right"?{x:p,y:m/2,textAlign:"end",textBaseline:"middle"}:e==="top"?{x:p/2,y:0,textAlign:"center",textBaseline:"top"}:e==="bottom"?{x:p/2,y:m,textAlign:"center",textBaseline:"bottom"}:e==="top-left"?{x:0,y:0,textAlign:"start",textBaseline:"top"}:e==="top-right"?{x:p,y:0,textAlign:"end",textBaseline:"top"}:e==="bottom-left"?{x:0,y:m,textAlign:"start",textBaseline:"bottom"}:e==="bottom-right"?{x:p,y:m,textAlign:"end",textBaseline:"bottom"}:{x:p/2,y:m/2,textAlign:"center",textBaseline:"middle"})}function jP(e,t,n,r){const{y:i,y1:s,autoRotate:l,rotateToAlignArc:u}=n,h=r.getCenter(),p=Gi(r,t,[i,s]),{innerRadius:m,outerRadius:y,startAngle:b,endAngle:w}=p,R=e==="inside"?(b+w)/2:w,M=vO(R,l,u),I=(()=>{const[N,U]=t,Z=m+(y-m)*.5,[Y,$]=e==="inside"?xx(h,R,Z):Nr(N,U);return{x:Y,y:$}})();return Object.assign(Object.assign({},I),{textAlign:e==="inside"?"center":"start",textBaseline:"middle",rotate:M})}function xx(e,t,n){return[e[0]+Math.sin(t)*n,e[1]-Math.cos(t)*n]}function vO(e,t,n){if(!t)return 0;const r=n?0:Math.sin(e)<0?90:-90;return e/Math.PI*180+r}function Ck(e,t,n,r){const{y:i,y1:s,autoRotate:l,rotateToAlignArc:u,radius:h=.5,offset:p=0}=n,m=Gi(r,t,[i,s]),{startAngle:y,endAngle:b}=m,w=r.getCenter(),R=(y+b)/2,I={textAlign:"center",textBaseline:"middle",rotate:vO(R,l,u)},{innerRadius:N,outerRadius:U}=m,Y=N+(U-N)*h+p,[$,J]=xx(w,R,Y);return Object.assign({x:$,y:J},I)}function VP(e){return e===void 0?null:e}function HP(e,t,n,r){const{bounds:i}=n,[s]=i;return{x:VP(s[0]),y:VP(s[1])}}function Nv(e,t,n,r){const{bounds:i}=n;return i.length===1?HP(e,t,n,r):(My(r)?jP:yg(r)?Ck:UP)(e,t,n,r)}function Ok(e,t,n,r,i){const[s,l]=xx(e,t,n),[u,h]=xx(e,t,r),p=Math.sin(t)>0?1:-1;return[[s,l],[u,h],[u+p*i,h]]}function ZP(e,t,n){const r=Gi(n,e,[t.y,t.y1]),{innerRadius:i,outerRadius:s}=r;return i+(s-i)}function WP(e,t,n){const r=Gi(n,e,[t.y,t.y1]),{startAngle:i,endAngle:s}=r;return(i+s)/2}function gO(e,t,n,r){const{autoRotate:i,rotateToAlignArc:s,offset:l=0,connector:u=!0,connectorLength:h=l,connectorLength2:p=0,connectorDistance:m=0}=n,y=r.getCenter(),b=WP(t,n,r),w=Math.sin(b)>0?1:-1,R=vO(b,i,s),M={textAlign:w>0||My(r)?"start":"end",textBaseline:"middle",rotate:R},I=ZP(t,n,r),N=I+(u?h:l),[[U,Z],[Y,$],[J,se]]=Ok(y,b,I,N,u?p:0),pe=u?+m*w:0,Ce=J+pe,Ue=se,Je={connector:u,connectorPoints:[[Y-Ce,$-Ue],[J-Ce,se-Ue]]};return Object.assign(Object.assign({x0:U,y0:Z,x:J+pe,y:se},M),Je)}function Rk(e,t,n,r){const{bounds:i}=n;return i.length===1?HP(e,t,n,r):(My(r)?jP:yg(r)?gO:UP)(e,t,n,r)}function Tu(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Mk(e,t){return Array.from(t,n=>e[n])}function em(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,s)=>s);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,s)=>{for(const l of t){const u=Ex(l[i],l[s]);if(u)return u}})):(n=e.map(n),r.sort((i,s)=>Ex(n[i],n[s]))),Mk(e,r)}return e.sort(GP(n))}function GP(e=Tu){if(e===Tu)return Ex;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function Ex(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function XP(e,t={}){const{labelHeight:n=14,height:r}=t,i=em(e,p=>p.y),s=i.length,l=new Array(s);for(let p=0;p<s;p++){const m=i[p],{y}=m;l[p]={y,y1:y+n,labels:[y]}}let u=!0;for(;u;){u=!1;for(let p=l.length-1;p>0;p--){const m=l[p],y=l[p-1];if(y.y1>m.y){u=!0,y.labels.push(...m.labels),l.splice(p,1),y.y1+=m.y1-m.y;const b=y.y1-y.y;y.y1=Math.max(Math.min(y.y1,r),b),y.y=y.y1-b}}}let h=0;for(const p of l){const{y:m,labels:y}=p;let b=m-n;for(const w of y){const R=i[h++],I=b+n-w;R.connectorPoints[0][1]-=I,R.y=b+n,b+=n}}}function YP(e,t){const n=em(e,u=>u.y),{height:r,labelHeight:i=14}=t,s=Math.ceil(r/i);if(n.length<=s)return XP(n,t);const l=[];for(let u=0;u<n.length;u++)u<n.length-s?(n[u].opacity=0,n[u].connector=!1):l.push(n[u]);XP(l,t)}var Pk=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const PS=new WeakMap;function Ik(e,t,n){const{connectorLength:r,connectorLength2:i,connectorDistance:s}=t,l=Pk(gO("outside",e,t,n),[]),u=n.getCenter(),h=ZP(e,t,n),p=WP(e,t,n),m=h+r+i,y=Math.sin(p)>0?1:-1,b=u[0]+(m+ +s)*y,{x:w}=l,R=b-w;return l.x+=R,l.connectorPoints[0][0]-=R,l}function Lk(e,t,n,r,i,s){if(!yg(r))return{};if(PS.has(t))return PS.get(t);const l=s.map(b=>Ik(b,n,r)),{width:u,height:h}=r.getOptions(),p=l.filter(b=>b.x<u/2),m=l.filter(b=>b.x>=u/2),y=Object.assign(Object.assign({},i),{height:h});return YP(p,y),YP(m,y),l.forEach((b,w)=>PS.set(s[w],b)),PS.get(t)}var Dk=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Nk(e,t,n,r){if(!yg(r))return{};const{connectorLength:i,connectorLength2:s,connectorDistance:l}=n,u=Dk(gO("outside",t,n,r),[]),{x0:h,y0:p}=u,m=r.getCenter(),b=EA(r)+i,w=rn([h-m[0],p-m[1]]),R=Math.sin(w)>0?1:-1,[M,I]=xx(m,w,b);return u.x=M+(s+l)*R,u.y=I,u}var $P=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Bk(e,t){return e!==void 0?e:yg(t)?"inside":gc(t)?"right":"top"}function Fk(e,t,n,r,i,s){const{position:l}=t,{render:u}=i,h=Bk(l,n),m=r[u?"htmlLabel":h==="inside"?"innerLabel":"label"],y=Object.assign({},m,t),b=ee[Zs(h)];if(!b)throw new Error(`Unknown position: ${h}`);return Object.assign(Object.assign({},m),b(h,e,y,n,i,s))}const KP=(e,t)=>{const{coordinate:n,theme:r}=t,{render:i}=e;return(s,l,u,h)=>{const{text:p,x:m,y,transform:b="",transformOrigin:w,className:R=""}=l,M=$P(l,["text","x","y","transform","transformOrigin","className"]),I=Fk(s,l,n,r,e,h),{rotate:N=0,transform:U=""}=I,Z=$P(I,["rotate","transform"]);return Pa(new zP).call(jn,Z).style("text",`${p}`).style("className",`${R} g2-label`).style("innerHTML",i?i(p,l.datum,l.index):void 0).style("labelTransform",`${U} rotate(${+N}) ${b}`.trim()).style("labelTransformOrigin",w).style("coordCenter",n.getCenter()).call(jn,M).node()}};KP.props={defaultMarker:"point"};var kk=function(e,t){if(!ap(e))return e;for(var n=[],r=0;r<e.length;r++){var i=e[r];t(i,r)&&n.push(i)}return n},qP=kk;function zk(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Fg(e){let t,n,r;e.length!==2?(t=Tu,n=(u,h)=>Tu(e(u),h),r=(u,h)=>e(u)-h):(t=e===Tu||e===zk?e:Uk,n=e,r=e);function i(u,h,p=0,m=u.length){if(p<m){if(t(h,h)!==0)return m;do{const y=p+m>>>1;n(u[y],h)<0?p=y+1:m=y}while(p<m)}return p}function s(u,h,p=0,m=u.length){if(p<m){if(t(h,h)!==0)return m;do{const y=p+m>>>1;n(u[y],h)<=0?p=y+1:m=y}while(p<m)}return p}function l(u,h,p=0,m=u.length){const y=i(u,h,p,m-1);return y>p&&r(u[y-1],h)>-r(u[y],h)?y-1:y}return{left:i,center:l,right:s}}function Uk(){return 0}function yO(e){return e===null?NaN:+e}function*jk(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const QP=Fg(Tu),Vk=QP.right,Hk=QP.left,Zk=Fg(yO).center;var Wk=Vk;function Gk(e,t,n){return Math.min(n,Math.max(t,e))}function Sx(e){return!!e.getBandWidth}function C_(e,t,n){if(!Sx(e))return e.invert(t);const{adjustedRange:r}=e,{domain:i}=e.getOptions(),s=n?-1:0,l=e.getStep(),u=n?r:r.map(m=>m+l),h=Hk(u,t),p=Gk(h+s,0,i.length-1);return i[p]}function kg(e,t,n){if(!t)return e.getOptions().domain;if(!Sx(e)){const h=em(t);if(!n)return h;const[p]=h,{range:m}=e.getOptions(),[y,b]=m,w=y>b?-1:1,R=e.invert(e.map(p)+w*n);return[p,R]}const{domain:r}=e.getOptions(),i=t[0],s=r.indexOf(i);if(n){const h=s+Math.round(r.length*n);return r.slice(s,h)}const l=t[t.length-1],u=r.indexOf(l);return r.slice(s,u+1)}function IS(e,t,n,r,i,s){const{x:l,y:u}=i,h=(w,R)=>{const[M,I]=s.invert(w);return[C_(l,M,R),C_(u,I,R)]},p=h([e,t],!0),m=h([n,r],!1),y=kg(l,[p[0],m[0]]),b=kg(u,[p[1],m[1]]);return[y,b]}function LS(e,t){const[n,r]=e,i=s=>s.getStep?s.getStep():0;return[t.map(n),t.map(r)+i(t)]}function Xk(e,t,n){const{x:r,y:i}=t,[s,l]=e,u=LS(s,r),h=LS(l,i),p=[u[0],h[0]],m=[u[1],h[1]],[y,b]=n.map(p),[w,R]=n.map(m);return[y,b,w,R]}const JP=Math.abs,ud=Math.atan2,o1=Math.cos,Yk=Math.max,_O=Math.min,Vm=Math.sin,O_=Math.sqrt,fd=1e-12,Tx=Math.PI,DS=Tx/2,$k=2*Tx;function Kk(e){return e>1?0:e<-1?Tx:Math.acos(e)}function eI(e){return e>=1?DS:e<=-1?-DS:Math.asin(e)}function qk(e){return e.innerRadius}function Qk(e){return e.outerRadius}function Jk(e){return e.startAngle}function e7(e){return e.endAngle}function t7(e){return e&&e.padAngle}function n7(e,t,n,r,i,s,l,u){var h=n-e,p=r-t,m=l-i,y=u-s,b=y*h-m*p;if(!(b*b<fd))return b=(m*(t-s)-y*(e-i))/b,[e+b*h,t+b*p]}function NS(e,t,n,r,i,s,l){var u=e-n,h=t-r,p=(l?s:-s)/O_(u*u+h*h),m=p*h,y=-p*u,b=e+m,w=t+y,R=n+m,M=r+y,I=(b+R)/2,N=(w+M)/2,U=R-b,Z=M-w,Y=U*U+Z*Z,$=i-s,J=b*M-R*w,se=(Z<0?-1:1)*O_(Yk(0,$*$*Y-J*J)),pe=(J*Z-U*se)/Y,Ce=(-J*U-Z*se)/Y,Ue=(J*Z+U*se)/Y,Je=(-J*U+Z*se)/Y,lt=pe-I,Ge=Ce-N,at=Ue-I,st=Je-N;return lt*lt+Ge*Ge>at*at+st*st&&(pe=Ue,Ce=Je),{cx:pe,cy:Ce,x01:-m,y01:-y,x11:pe*(i/$-1),y11:Ce*(i/$-1)}}function BS(){var e=qk,t=Qk,n=cl(0),r=null,i=Jk,s=e7,l=t7,u=null,h=la(p);function p(){var m,y,b=+e.apply(this,arguments),w=+t.apply(this,arguments),R=i.apply(this,arguments)-DS,M=s.apply(this,arguments)-DS,I=JP(M-R),N=M>R;if(u||(u=m=h()),w<b&&(y=w,w=b,b=y),!(w>fd))u.moveTo(0,0);else if(I>$k-fd)u.moveTo(w*o1(R),w*Vm(R)),u.arc(0,0,w,R,M,!N),b>fd&&(u.moveTo(b*o1(M),b*Vm(M)),u.arc(0,0,b,M,R,N));else{var U=R,Z=M,Y=R,$=M,J=I,se=I,pe=l.apply(this,arguments)/2,Ce=pe>fd&&(r?+r.apply(this,arguments):O_(b*b+w*w)),Ue=_O(JP(w-b)/2,+n.apply(this,arguments)),Je=Ue,lt=Ue,Ge,at;if(Ce>fd){var st=eI(Ce/b*Vm(pe)),ft=eI(Ce/w*Vm(pe));(J-=st*2)>fd?(st*=N?1:-1,Y+=st,$-=st):(J=0,Y=$=(R+M)/2),(se-=ft*2)>fd?(ft*=N?1:-1,U+=ft,Z-=ft):(se=0,U=Z=(R+M)/2)}var Vt=w*o1(U),wt=w*Vm(U),zt=b*o1($),En=b*Vm($);if(Ue>fd){var Vn=w*o1(Z),ar=w*Vm(Z),lr=b*o1(Y),Vr=b*Vm(Y),ui;if(I<Tx)if(ui=n7(Vt,wt,lr,Vr,Vn,ar,zt,En)){var qi=Vt-ui[0],Jr=wt-ui[1],Qr=Vn-ui[0],Mo=ar-ui[1],Qi=1/Vm(Kk((qi*Qr+Jr*Mo)/(O_(qi*qi+Jr*Jr)*O_(Qr*Qr+Mo*Mo)))/2),Zi=O_(ui[0]*ui[0]+ui[1]*ui[1]);Je=_O(Ue,(b-Zi)/(Qi-1)),lt=_O(Ue,(w-Zi)/(Qi+1))}else Je=lt=0}se>fd?lt>fd?(Ge=NS(lr,Vr,Vt,wt,w,lt,N),at=NS(Vn,ar,zt,En,w,lt,N),u.moveTo(Ge.cx+Ge.x01,Ge.cy+Ge.y01),lt<Ue?u.arc(Ge.cx,Ge.cy,lt,ud(Ge.y01,Ge.x01),ud(at.y01,at.x01),!N):(u.arc(Ge.cx,Ge.cy,lt,ud(Ge.y01,Ge.x01),ud(Ge.y11,Ge.x11),!N),u.arc(0,0,w,ud(Ge.cy+Ge.y11,Ge.cx+Ge.x11),ud(at.cy+at.y11,at.cx+at.x11),!N),u.arc(at.cx,at.cy,lt,ud(at.y11,at.x11),ud(at.y01,at.x01),!N))):(u.moveTo(Vt,wt),u.arc(0,0,w,U,Z,!N)):u.moveTo(Vt,wt),!(b>fd)||!(J>fd)?u.lineTo(zt,En):Je>fd?(Ge=NS(zt,En,Vn,ar,b,-Je,N),at=NS(Vt,wt,lr,Vr,b,-Je,N),u.lineTo(Ge.cx+Ge.x01,Ge.cy+Ge.y01),Je<Ue?u.arc(Ge.cx,Ge.cy,Je,ud(Ge.y01,Ge.x01),ud(at.y01,at.x01),!N):(u.arc(Ge.cx,Ge.cy,Je,ud(Ge.y01,Ge.x01),ud(Ge.y11,Ge.x11),!N),u.arc(0,0,b,ud(Ge.cy+Ge.y11,Ge.cx+Ge.x11),ud(at.cy+at.y11,at.cx+at.x11),N),u.arc(at.cx,at.cy,Je,ud(at.y11,at.x11),ud(at.y01,at.x01),!N))):u.arc(0,0,b,$,Y,N)}if(u.closePath(),m)return u=null,m+""||null}return p.centroid=function(){var m=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,y=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Tx/2;return[o1(y)*m,Vm(y)*m]},p.innerRadius=function(m){return arguments.length?(e=typeof m=="function"?m:cl(+m),p):e},p.outerRadius=function(m){return arguments.length?(t=typeof m=="function"?m:cl(+m),p):t},p.cornerRadius=function(m){return arguments.length?(n=typeof m=="function"?m:cl(+m),p):n},p.padRadius=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:cl(+m),p):r},p.startAngle=function(m){return arguments.length?(i=typeof m=="function"?m:cl(+m),p):i},p.endAngle=function(m){return arguments.length?(s=typeof m=="function"?m:cl(+m),p):s},p.padAngle=function(m){return arguments.length?(l=typeof m=="function"?m:cl(+m),p):l},p.context=function(m){return arguments.length?(u=m==null?null:m,p):u},p}var FS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function tI(e,t,n,r,i={}){const{inset:s=0,radius:l=0,insetLeft:u=s,insetTop:h=s,insetRight:p=s,insetBottom:m=s,radiusBottomLeft:y=l,radiusBottomRight:b=l,radiusTopLeft:w=l,radiusTopRight:R=l,minWidth:M=-1/0,maxWidth:I=1/0,minHeight:N=-1/0}=i,U=FS(i,["inset","radius","insetLeft","insetTop","insetRight","insetBottom","radiusBottomLeft","radiusBottomRight","radiusTopLeft","radiusTopRight","minWidth","maxWidth","minHeight"]);if(!Ml(r)&&!kb(r)){const pe=!!gc(r),[Ce,,Ue]=pe?Hr(t):t,[Je,lt]=Ce,[Ge,at]=ge(Ue,Ce),st=Ge>0?Je:Je+Ge,ft=at>0?lt:lt+at,Vt=Math.abs(Ge),wt=Math.abs(at),zt=st+u,En=ft+h,Vn=Vt-(u+p),ar=wt-(h+m),lr=pe?Fb(Vn,N,1/0):Fb(Vn,M,I),Vr=pe?Fb(ar,M,I):Fb(ar,N,1/0),ui=pe?zt:zt-(lr-Vn)/2,qi=pe?En-(Vr-ar)/2:En-(Vr-ar);return Pa(e.createElement("rect",{})).style("x",ui).style("y",qi).style("width",lr).style("height",Vr).style("radius",[w,R,b,y]).call(jn,U).node()}const{y:Z,y1:Y}=n,$=r.getCenter(),J=Gi(r,t,[Z,Y]),se=BS().cornerRadius(l).padAngle(s*Math.PI/180);return Pa(e.createElement("path",{})).style("d",se(J)).style("transform",`translate(${$[0]}, ${$[1]})`).style("radius",l).style("inset",s).call(jn,U).node()}const Ax=(e,t)=>{const{colorAttribute:n,opacityAttribute:r="fill",first:i=!0,last:s=!0}=e,l=FS(e,["colorAttribute","opacityAttribute","first","last"]),{coordinate:u,document:h}=t;return(p,m,y)=>{const{color:b,radius:w=0}=y,R=FS(y,["color","radius"]),M=R.lineWidth||1,{stroke:I,radius:N=w,radiusTopLeft:U=N,radiusTopRight:Z=N,radiusBottomRight:Y=N,radiusBottomLeft:$=N,innerRadius:J=0,innerRadiusTopLeft:se=J,innerRadiusTopRight:pe=J,innerRadiusBottomRight:Ce=J,innerRadiusBottomLeft:Ue=J,lineWidth:Je=n==="stroke"||I?M:0,inset:lt=0,insetLeft:Ge=lt,insetRight:at=lt,insetBottom:st=lt,insetTop:ft=lt,minWidth:Vt,maxWidth:wt,minHeight:zt}=l,En=FS(l,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","lineWidth","inset","insetLeft","insetRight","insetBottom","insetTop","minWidth","maxWidth","minHeight"]),{color:Vn=b,opacity:ar}=m,lr=[i?U:se,i?Z:pe,s?Y:Ce,s?$:Ue],Vr=["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"];gc(u)&&Vr.push(Vr.shift());const ui=Object.assign(Object.assign({radius:N},Object.fromEntries(Vr.map((qi,Jr)=>[qi,lr[Jr]]))),{inset:lt,insetLeft:Ge,insetRight:at,insetBottom:st,insetTop:ft,minWidth:Vt,maxWidth:wt,minHeight:zt});return Pa(tI(h,p,m,u,ui)).call(jn,R).style("fill","transparent").style(n,Vn).style(ys(e),ar).style("lineWidth",Je).style("stroke",I===void 0?Vn:I).call(jn,En).node()}};Ax.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const r7={visibility:"visible",opacity:1,fillOpacity:1,strokeOpacity:1};function i7(e,t){var n;return(n=e.style[t])!==null&&n!==void 0?n:r7[t]}function bO(e,t,n,r){e.style[t]=n,r&&e.children.forEach(i=>bO(i,t,n,r))}function xO(e){bO(e,"visibility","hidden",!0)}function kS(e){bO(e,"visibility","visible",!0)}var Cx=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function zg(e){return Pa(e).selectAll(`.${Ut}`).nodes().filter(t=>!t.__removed__)}function nI(e,t){return EO(e,t).flatMap(({container:n})=>zg(n))}function EO(e,t){return t.filter(n=>n!==e&&n.options.parentKey===e.options.key)}function Hm(e){return Pa(e).select(`.${Ie}`).node()}function rI(e){if(e.tagName==="g")return e.getRenderBounds();const t=e.getGeometryBounds(),n=new Cn;return n.setFromTransformedAABB(t,e.getWorldTransform()),n}function Ox(e,t){const{offsetX:n,offsetY:r}=t,i=rI(e),{min:[s,l],max:[u,h]}=i,p=n<s||n>u,m=r<l||r>h;return p||m?null:[n-s,r-l]}function SO(e,t){const{offsetX:n,offsetY:r}=t,[i,s,l,u]=o7(e);return[Math.min(l,Math.max(i,n))-i,Math.min(u,Math.max(s,r))-s]}function o7(e){const t=e.getRenderBounds(),{min:[n,r],max:[i,s]}=t;return[n,r,i,s]}function iI(e){return t=>t.__data__.color}function TO(e){return t=>t.__data__.x}function a1(e){const t=Array.isArray(e)?e:[e],n=new Map(t.flatMap(r=>Array.from(r.markState.keys()).map(s=>[zS(r.key,s.key),s.data])));return r=>{const{index:i,markKey:s,viewKey:l}=r.__data__;return n.get(zS(l,s))[i]}}function Bv(e,t=(r,i)=>r,n=(r,i,s)=>r.setAttribute(i,s)){const r="__states__",i="__ordinal__",s=m=>{const{[r]:y=[],[i]:b={}}=m,w=y.reduce((R,M)=>Object.assign(Object.assign({},R),e[M]),b);if(Object.keys(w).length!==0){for(const[R,M]of Object.entries(w)){const I=i7(m,R),N=t(M,m);n(m,R,N),R in b||(b[R]=I)}m[i]=b}},l=m=>{m[r]||(m[r]=[])};return{setState:(m,...y)=>{l(m),m[r]=[...y],s(m)},removeState:(m,...y)=>{l(m);for(const b of y){const w=m[r].indexOf(b);w!==-1&&m[r].splice(w,1)}s(m)},hasState:(m,y)=>(l(m),m[r].indexOf(y)!==-1)}}function a7(e){return e===void 0?!0:typeof e!="object"?!1:Object.keys(e).length===0}function zS(e,t){return`${e},${t}`}function R_(e,t){const r=(Array.isArray(e)?e:[e]).flatMap(s=>s.marks.map(l=>[zS(s.key,l.key),l.state])),i={};for(const s of t){const[l,u]=Array.isArray(s)?s:[s,{}];i[l]=r.reduce((h,p)=>{const[m,y={}]=p,b=a7(y[l])?u:y[l];for(const[w,R]of Object.entries(b)){const M=h[w],I=(N,U,Z,Y)=>{const $=zS(Y.__data__.viewKey,Y.__data__.markKey);return m!==$?M==null?void 0:M(N,U,Z,Y):typeof R!="function"?R:R(N,U,Z,Y)};h[w]=I}return h},{})}return i}function Rx(e,t){const n=new Map(e.map((i,s)=>[i,s])),r=t?e.map(t):e;return(i,s)=>{if(typeof i!="function")return i;const l=n.get(s),u=t?t(s):s;return i(u,l,r,s)}}function oI(e){var{link:t=!1,valueof:n=(m,y)=>m,coordinate:r}=e,i=Cx(e,["link","valueof","coordinate"]);const s="element-link";if(!t)return[()=>{},()=>{}];const l=m=>m.__data__.points,u=(m,y)=>{const[,b,w]=m,[R,,,M]=y;return[b,R,M,w]};return[m=>{var y;if(m.length<=1)return;const b=em(m,(w,R)=>{const{x:M}=w.__data__,{x:I}=R.__data__;return M-I});for(let w=1;w<b.length;w++){const R=hp(),M=b[w-1],I=b[w],[N,U,Z,Y]=u(l(M),l(I));R.moveTo(...N),R.lineTo(...U),R.lineTo(...Z),R.lineTo(...Y),R.closePath();const $=_0(i,Ce=>n(Ce,M)),{fill:J=M.getAttribute("fill")}=$,se=Cx($,["fill"]),pe=new Wi({className:s,style:Object.assign({d:R.toString(),fill:J,zIndex:-2},se)});(y=M.link)===null||y===void 0||y.remove(),M.parentNode.appendChild(pe),M.link=pe}},m=>{var y;(y=m.link)===null||y===void 0||y.remove(),m.link=null}]}function aI(e,t,n){const r=i=>{const{transform:s}=e.style;return s?`${s} ${i}`:i};if(Ml(n)){const{points:i}=e.__data__,[s,l]=gc(n)?Hr(i):i,u=n.getCenter(),h=ge(s,u),p=ge(l,u),m=Mt(h),y=Rn(h,p),b=m+y/2,w=t*Math.cos(b),R=t*Math.sin(b);return r(`translate(${w}, ${R})`)}return gc(n)?r(`translate(${t}, 0)`):r(`translate(0, ${-t})`)}function sI(e){var{document:t,background:n,scale:r,coordinate:i,valueof:s}=e,l=Cx(e,["document","background","scale","coordinate","valueof"]);const u="element-background";if(!n)return[()=>{},()=>{}];const h=(N,U,Z)=>{const Y=N.invert(U),$=U+N.getBandWidth(Y)/2,J=N.getStep(Y)/2,se=J*Z;return[$-J+se,$+J-se]},p=(N,U)=>{const{x:Z}=r;if(!Sx(Z))return[0,1];const{__data__:Y}=N,{x:$}=Y,[J,se]=h(Z,$,U);return[J,se]},m=(N,U)=>{const{y:Z}=r;if(!Sx(Z))return[0,1];const{__data__:Y}=N,{y:$}=Y,[J,se]=h(Z,$,U);return[J,se]},y=(N,U)=>{const{padding:Z}=U,[Y,$]=p(N,Z),[J,se]=m(N,Z),pe=[[Y,J],[$,J],[$,se],[Y,se]].map(lt=>i.map(lt)),{__data__:Ce}=N,{y:Ue,y1:Je}=Ce;return tI(t,pe,{y:Ue,y1:Je},i,U)},b=(N,U)=>{const{transform:Z="scale(1.2, 1.2)",transformOrigin:Y="center center",stroke:$=""}=U,J=Cx(U,["transform","transformOrigin","stroke"]),se=Object.assign({transform:Z,transformOrigin:Y,stroke:$},J),pe=N.cloneNode(!0);for(const[Ce,Ue]of Object.entries(se))pe.style[Ce]=Ue;return pe},w=()=>{const{x:N,y:U}=r;return[N,U].some(Sx)};return[N=>{N.background&&N.background.remove();const U=_0(l,lt=>s(lt,N)),{fill:Z="#CCD6EC",fillOpacity:Y=.3,zIndex:$=-2,padding:J=.001,lineWidth:se=0}=U,pe=Cx(U,["fill","fillOpacity","zIndex","padding","lineWidth"]),Ce=Object.assign(Object.assign({},pe),{fill:Z,fillOpacity:Y,zIndex:$,padding:J,lineWidth:se}),Je=(w()?y:b)(N,Ce);Je.className=u,N.parentNode.parentNode.appendChild(Je),N.background=Je},N=>{var U;(U=N.background)===null||U===void 0||U.remove(),N.background=null},N=>N.className===u]}function Ug(e,t){const r=e.getRootNode().defaultView.getContextService().getDomElement();r!=null&&r.style&&(e.cursor=r.style.cursor,r.style.cursor=t)}function s7(e){Ug(e,e.cursor)}function wO(e,t,n){return e.find(r=>Object.entries(t).every(([i,s])=>n(r)[i]===s))}function US(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Mx(e,t=!1){const n=qP(e,r=>!!r).map((r,i)=>[i===0?"M":"L",...r]);return t&&n.push(["Z"]),n}function lI(e){return e.querySelectorAll(".element")}function l7(e,t,n=0){const r=[["M",...t[1]]],i=US(e,t[1]),s=US(e,t[0]);return i===0?r.push(["L",...t[3]],["A",s,s,0,n,1,...t[0]],["Z"]):r.push(["A",i,i,0,n,0,...t[2]],["L",...t[3]],["A",s,s,0,n,1,...t[0]],["Z"]),r}function jS(e,t){if(t(e))return e;let n=e.parent;for(;n&&!t(n);)n=n.parent;return n}function cI(e,t){const{__data__:n}=e,{markKey:r,index:i,seriesIndex:s}=n,{markState:l}=t,u=Array.from(l.keys()).find(h=>h.key===r);if(u)return s?s.map(h=>u.data[h]):u.data[i]}function c7(e){return jS(e,t=>t.className==="component")}function u7(e){return jS(e,t=>t.className==="element")}function f7(e){return jS(e,t=>t.className==="label")}function dh(e,t,n,r=i=>!0){return i=>{if(!r(i))return;n.emit(`plot:${e}`,i);const{target:s}=i;if(!s)return;const{className:l}=s;if(l==="plot")return;const u=u7(s),h=c7(s),p=f7(s),m=u||h||p;if(!m)return;const{className:y,markType:b}=m,w=Object.assign(Object.assign({},i),{nativeEvent:!0});y==="element"?(w.data={data:cI(m,t)},n.emit(`element:${e}`,w),n.emit(`${b}:${e}`,w)):y==="label"?(w.data={data:m.attributes.datum},n.emit(`label:${e}`,w),n.emit(`${l}:${e}`,w)):(n.emit(`component:${e}`,w),n.emit(`${l}:${e}`,w))}}function uI(){return(e,t,n)=>{const{container:r,view:i}=e,s=dh(El.CLICK,i,n,se=>se.detail===1),l=dh(El.DBLCLICK,i,n,se=>se.detail===2),u=dh(El.POINTER_TAP,i,n),h=dh(El.POINTER_DOWN,i,n),p=dh(El.POINTER_UP,i,n),m=dh(El.POINTER_OVER,i,n),y=dh(El.POINTER_OUT,i,n),b=dh(El.POINTER_MOVE,i,n),w=dh(El.POINTER_ENTER,i,n),R=dh(El.POINTER_LEAVE,i,n),M=dh(El.POINTER_UPOUTSIDE,i,n),I=dh(El.DRAG_START,i,n),N=dh(El.DRAG,i,n),U=dh(El.DRAG_END,i,n),Z=dh(El.DRAG_ENTER,i,n),Y=dh(El.DRAG_LEAVE,i,n),$=dh(El.DRAG_OVER,i,n),J=dh(El.DROP,i,n);return r.addEventListener("click",s),r.addEventListener("click",l),r.addEventListener("pointertap",u),r.addEventListener("pointerdown",h),r.addEventListener("pointerup",p),r.addEventListener("pointerover",m),r.addEventListener("pointerout",y),r.addEventListener("pointermove",b),r.addEventListener("pointerenter",w),r.addEventListener("pointerleave",R),r.addEventListener("pointerupoutside",M),r.addEventListener("dragstart",I),r.addEventListener("drag",N),r.addEventListener("dragend",U),r.addEventListener("dragenter",Z),r.addEventListener("dragleave",Y),r.addEventListener("dragover",$),r.addEventListener("drop",J),()=>{r.removeEventListener("click",s),r.removeEventListener("click",l),r.removeEventListener("pointertap",u),r.removeEventListener("pointerdown",h),r.removeEventListener("pointerup",p),r.removeEventListener("pointerover",m),r.removeEventListener("pointerout",y),r.removeEventListener("pointermove",b),r.removeEventListener("pointerenter",w),r.removeEventListener("pointerleave",R),r.removeEventListener("pointerupoutside",M),r.removeEventListener("dragstart",I),r.removeEventListener("drag",N),r.removeEventListener("dragend",U),r.removeEventListener("dragenter",Z),r.removeEventListener("dragleave",Y),r.removeEventListener("dragover",$),r.removeEventListener("drop",J)}}}uI.props={reapplyWhenUpdate:!0};function h7(){return{"component.axisRadar":sx,"component.axisLinear":Um,"component.axisArc":sS,"component.legendContinuousBlock":CS,"component.legendContinuousBlockSize":a,"component.legendContinuousSize":OS,"interaction.event":uI,"composition.mark":f,"composition.view":ie,"shape.label.label":KP}}var d7=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Hc(e,t){const n=Object.assign(Object.assign({},h7()),t),r=s=>{if(typeof s!="string")return s;const l=`${e}.${s}`;return n[l]||mg(`Unknown Component: ${l}`)};return[(s,l)=>{const{type:u}=s,h=d7(s,["type"]);u||mg("Plot type is required!");const p=r(u);return p==null?void 0:p(h,l)},r]}function fI(e){const{canvas:t,group:n}=e;return(t==null?void 0:t.document)||(n==null?void 0:n.ownerDocument)||mg("Cannot find library document")}var hI=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function p7(e,t,n){const[r]=Hc("coordinate",n),{innerHeight:i,innerWidth:s,insetLeft:l,insetTop:u,insetRight:h,insetBottom:p}=e,{coordinates:m=[]}=t,y=b7(m),b=y[0].type==="cartesian3D",w=Object.assign(Object.assign({},e),{x:l,y:u,width:s-l-h,height:i-p-u,transformations:y.flatMap(r)});return b?new gE.Coordinate3D(w):new gE.Coordinate(w)}function dI(e,t){const{coordinate:n={},coordinates:r}=e,i=hI(e,["coordinate","coordinates"]);if(r)return e;const{type:s,transform:l=[]}=n,u=hI(n,["type","transform"]);if(!s)return Object.assign(Object.assign({},i),{coordinates:l});const[,h]=Hc("coordinate",t),{transform:p=!1}=h(s).props||{};if(p)throw new Error(`Unknown coordinate: ${s}.`);return Object.assign(Object.assign({},i),{coordinates:[Object.assign({type:s},u),...l]})}function tm(e,t){return e.filter(n=>n.type===t)}function s1(e){return tm(e,"polar").length>0}function m7(e){return tm(e,"helix").length>0}function M_(e){return tm(e,"transpose").length%2===1}function v7(e){return tm(e,"parallel").length>0}function pI(e){return tm(e,"theta").length>0}function g7(e){return tm(e,"reflect").length>0}function Px(e){return tm(e,"radial").length>0}function y7(e){return tm(e,"radar").length>0}function _7(e){return tm(e,"reflectY").length>0}function b7(e){return e.find(t=>t.type==="cartesian"||t.type==="cartesian3D")?e:[...e,{type:"cartesian"}]}function Ms(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}var x7=Ms("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),E7=Ms("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),S7=Ms("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),T7=Ms("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),w7=Ms("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),A7=Ms("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),C7=Ms("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),O7=Ms("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),R7=Ms("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),M7=Ms("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),P7=Ms("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function VS(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function AO(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function P_(){}var l1=.7,I_=1/l1,L_="\\s*([+-]?\\d+)\\s*",Ix="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",I7=/^#([0-9a-f]{3,8})$/,L7=new RegExp("^rgb\\(".concat(L_,",").concat(L_,",").concat(L_,"\\)$")),D7=new RegExp("^rgb\\(".concat(Zm,",").concat(Zm,",").concat(Zm,"\\)$")),N7=new RegExp("^rgba\\(".concat(L_,",").concat(L_,",").concat(L_,",").concat(Ix,"\\)$")),B7=new RegExp("^rgba\\(".concat(Zm,",").concat(Zm,",").concat(Zm,",").concat(Ix,"\\)$")),F7=new RegExp("^hsl\\(".concat(Ix,",").concat(Zm,",").concat(Zm,"\\)$")),k7=new RegExp("^hsla\\(".concat(Ix,",").concat(Zm,",").concat(Zm,",").concat(Ix,"\\)$")),mI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VS(P_,CO,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:vI,formatHex:vI,formatHex8:z7,formatHsl:U7,formatRgb:gI,toString:gI});function vI(){return this.rgb().formatHex()}function z7(){return this.rgb().formatHex8()}function U7(){return SI(this).formatHsl()}function gI(){return this.rgb().formatRgb()}function CO(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=I7.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?yI(t):n===3?new hd(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?HS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?HS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=L7.exec(e))?new hd(t[1],t[2],t[3],1):(t=D7.exec(e))?new hd(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=N7.exec(e))?HS(t[1],t[2],t[3],t[4]):(t=B7.exec(e))?HS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=F7.exec(e))?EI(t[1],t[2]/100,t[3]/100,1):(t=k7.exec(e))?EI(t[1],t[2]/100,t[3]/100,t[4]):mI.hasOwnProperty(e)?yI(mI[e]):e==="transparent"?new hd(NaN,NaN,NaN,0):null}function yI(e){return new hd(e>>16&255,e>>8&255,e&255,1)}function HS(e,t,n,r){return r<=0&&(e=t=n=NaN),new hd(e,t,n,r)}function _I(e){return e instanceof P_||(e=CO(e)),e?(e=e.rgb(),new hd(e.r,e.g,e.b,e.opacity)):new hd}function Lx(e,t,n,r){return arguments.length===1?_I(e):new hd(e,t,n,r==null?1:r)}function hd(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}VS(hd,Lx,AO(P_,{brighter:function(t){return t=t==null?I_:Math.pow(I_,t),new hd(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?l1:Math.pow(l1,t),new hd(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new hd(c1(this.r),c1(this.g),c1(this.b),ZS(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bI,formatHex:bI,formatHex8:j7,formatRgb:xI,toString:xI}));function bI(){return"#".concat(u1(this.r)).concat(u1(this.g)).concat(u1(this.b))}function j7(){return"#".concat(u1(this.r)).concat(u1(this.g)).concat(u1(this.b)).concat(u1((isNaN(this.opacity)?1:this.opacity)*255))}function xI(){var e=ZS(this.opacity);return"".concat(e===1?"rgb(":"rgba(").concat(c1(this.r),", ").concat(c1(this.g),", ").concat(c1(this.b)).concat(e===1?")":", ".concat(e,")"))}function ZS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function c1(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function u1(e){return e=c1(e),(e<16?"0":"")+e.toString(16)}function EI(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new nm(e,t,n,r)}function SI(e){if(e instanceof nm)return new nm(e.h,e.s,e.l,e.opacity);if(e instanceof P_||(e=CO(e)),!e)return new nm;if(e instanceof nm)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),l=NaN,u=s-i,h=(s+i)/2;return u?(t===s?l=(n-r)/u+(n<r)*6:n===s?l=(r-t)/u+2:l=(t-n)/u+4,u/=h<.5?s+i:2-s-i,l*=60):u=h>0&&h<1?0:l,new nm(l,u,h,e.opacity)}function V7(e,t,n,r){return arguments.length===1?SI(e):new nm(e,t,n,r==null?1:r)}function nm(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}VS(nm,V7,AO(P_,{brighter:function(t){return t=t==null?I_:Math.pow(I_,t),new nm(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?l1:Math.pow(l1,t),new nm(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new hd(OO(t>=240?t-240:t+120,s,i),OO(t,s,i),OO(t<120?t+240:t-120,s,i),this.opacity)},clamp:function(){return new nm(TI(this.h),WS(this.s),WS(this.l),ZS(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=ZS(this.opacity);return"".concat(t===1?"hsl(":"hsla(").concat(TI(this.h),", ").concat(WS(this.s)*100,"%, ").concat(WS(this.l)*100,"%").concat(t===1?")":", ".concat(t,")"))}}));function TI(e){return e=(e||0)%360,e<0?e+360:e}function WS(e){return Math.max(0,Math.min(1,e||0))}function OO(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function wI(e,t,n,r,i){var s=e*e,l=s*e;return((1-3*e+3*s-l)*t+(4-6*s+3*l)*n+(1+3*e+3*s-3*l)*r+l*i)/6}function H7(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],l=r>0?e[r-1]:2*i-s,u=r<t-1?e[r+2]:2*s-i;return wI((n-r/t)*t,l,i,s,u)}}function Z7(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],l=e[(r+1)%t],u=e[(r+2)%t];return wI((n-r/t)*t,i,s,l,u)}}var RO=function(e){return function(){return e}};function AI(e,t){return function(n){return e+n*t}}function W7(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function G7(e,t){var n=t-e;return n?AI(e,n>180||n<-180?n-360*Math.round(n/360):n):RO(isNaN(e)?t:e)}function X7(e){return(e=+e)==1?D_:function(t,n){return n-t?W7(t,n,e):RO(isNaN(t)?n:t)}}function D_(e,t){var n=t-e;return n?AI(e,n):RO(isNaN(e)?t:e)}var Ete=function e(t){var n=X7(t);function r(i,s){var l=n((i=Lx(i)).r,(s=Lx(s)).r),u=n(i.g,s.g),h=n(i.b,s.b),p=D_(i.opacity,s.opacity);return function(m){return i.r=l(m),i.g=u(m),i.b=h(m),i.opacity=p(m),i+""}}return r.gamma=e,r}(1);function CI(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),l,u;for(l=0;l<n;++l)u=Lx(t[l]),r[l]=u.r||0,i[l]=u.g||0,s[l]=u.b||0;return r=e(r),i=e(i),s=e(s),u.opacity=1,function(h){return u.r=r(h),u.g=i(h),u.b=s(h),u+""}}}var Y7=CI(H7),Ste=CI(Z7),Mc=e=>Y7(e[e.length-1]),OI=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ms),$7=Mc(OI),RI=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ms),K7=Mc(RI),MI=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ms),q7=Mc(MI),PI=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ms),Q7=Mc(PI),II=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ms),J7=Mc(II),LI=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ms),e9=Mc(LI),DI=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ms),t9=Mc(DI),NI=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ms),n9=Mc(NI),BI=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ms),r9=Mc(BI),FI=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ms),i9=Mc(FI),kI=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ms),o9=Mc(kI),zI=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ms),a9=Mc(zI),UI=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ms),s9=Mc(UI),jI=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ms),l9=Mc(jI),VI=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ms),c9=Mc(VI),HI=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ms),u9=Mc(HI),ZI=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ms),f9=Mc(ZI),WI=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ms),h9=Mc(WI),GI=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ms),d9=Mc(GI),XI=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ms),p9=Mc(XI),YI=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ms),m9=Mc(YI),$I=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ms),v9=Mc($I),KI=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ms),g9=Mc(KI),qI=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ms),y9=Mc(qI),QI=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ms),_9=Mc(QI),JI=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ms),b9=Mc(JI),e5=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ms),x9=Mc(e5);function E9(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}var S9=Math.PI/180,T9=180/Math.PI,t5=-.14861,MO=1.78277,PO=-.29227,GS=-.90649,Dx=1.97294,n5=Dx*GS,r5=Dx*MO,i5=MO*PO-GS*t5;function w9(e){if(e instanceof f1)return new f1(e.h,e.s,e.l,e.opacity);e instanceof hd||(e=_I(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(i5*r+n5*t-r5*n)/(i5+n5-r5),s=r-i,l=(Dx*(n-i)-PO*s)/GS,u=Math.sqrt(l*l+s*s)/(Dx*i*(1-i)),h=u?Math.atan2(l,s)*T9-120:NaN;return new f1(h<0?h+360:h,u,i,e.opacity)}function Wm(e,t,n,r){return arguments.length===1?w9(e):new f1(e,t,n,r==null?1:r)}function f1(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}VS(f1,Wm,AO(P_,{brighter:function(t){return t=t==null?I_:Math.pow(I_,t),new f1(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?l1:Math.pow(l1,t),new f1(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*S9,n=+this.l,r=isNaN(this.s)?0:this.s*n*(1-n),i=Math.cos(t),s=Math.sin(t);return new hd(255*(n+r*(t5*i+MO*s)),255*(n+r*(PO*i+GS*s)),255*(n+r*(Dx*i)),this.opacity)}}));function o5(e){return function t(n){n=+n;function r(i,s){var l=e((i=Wm(i)).h,(s=Wm(s)).h),u=D_(i.s,s.s),h=D_(i.l,s.l),p=D_(i.opacity,s.opacity);return function(m){return i.h=l(m),i.s=u(m),i.l=h(Math.pow(m,n)),i.opacity=p(m),i+""}}return r.gamma=t,r}(1)}var Tte=o5(G7),IO=o5(D_),A9=IO(Wm(300,.5,0),Wm(-240,.5,1)),C9=IO(Wm(-100,.75,.35),Wm(80,1.5,.8)),O9=IO(Wm(260,.75,.35),Wm(80,1.5,.8)),XS=Wm();function R9(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return XS.h=360*e-100,XS.s=1.5-1.5*t,XS.l=.8-.9*t,XS+""}var YS=Lx(),M9=Math.PI/3,P9=Math.PI*2/3;function I9(e){var t;return e=(.5-e)*Math.PI,YS.r=255*(t=Math.sin(e))*t,YS.g=255*(t=Math.sin(e+M9))*t,YS.b=255*(t=Math.sin(e+P9))*t,YS+""}function L9(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function $S(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var D9=$S(Ms("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),N9=$S(Ms("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),B9=$S(Ms("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),F9=$S(Ms("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function k9(e,t,n,r,i,s){const{guide:l={}}=n,u=Y9(e,t,n);if(typeof u!="string")return n;const h=$9(u,e,t,n),p=W9(u,h,n);return Object.assign(Object.assign(Object.assign({},n),q9(u,e,t,n,r)),{domain:p,range:K9(u,e,t,n,p,i,s),expectedDomain:h,guide:l,name:e,type:u})}function z9(e,t){const n={};for(const r of e){const{values:i,name:s}=r,l=t[s];for(const u of i){const{name:h,value:p}=u;n[h]=p.map(m=>l.map(m))}}return n}function U9(e,t){const n=Array.from(e.values()).flatMap(i=>i.channels);G1(n,i=>i.map(s=>t.get(s.scale.uid)),i=>i.name).filter(([,i])=>i.some(s=>typeof s.getOptions().groupTransform=="function")&&i.every(s=>s.getTicks)).map(i=>i[1]).forEach(i=>{const s=i.map(l=>l.getOptions().groupTransform)[0];s(i)})}function j9(e,t){var n;const{components:r=[]}=t,i=["scale","encode","axis","legend","data","transform"],s=Array.from(new Set(e.flatMap(u=>u.channels.map(h=>h.scale)))),l=new Map(s.map(u=>[u.name,u]));for(const u of r){const h=Z9(u);for(const p of h){const m=l.get(p),y=((n=u.scale)===null||n===void 0?void 0:n[p])||{},{independent:b=!1}=y;if(m&&!b){const{guide:w}=m,R=typeof w=="boolean"?{}:w;m.guide=ni({},R,u),Object.assign(m,y)}else{const w=Object.assign(Object.assign({},y),{expectedDomain:y.domain,name:p,guide:oc(u,i)});s.push(w)}}}return s}function V9(e){if(!e||!Array.isArray(e))return[Ev,Ev];let t,n;return[s=>{var l;t=s.map.bind(s),n=(l=s.invert)===null||l===void 0?void 0:l.bind(s);const u=e.filter(([b])=>typeof b=="function"),h=e.filter(([b])=>typeof b!="function"),p=new Map(h);if(s.map=b=>{for(const[w,R]of u)if(w(b))return R;return p.has(b)?p.get(b):t(b)},!n)return s;const m=new Map(h.map(([b,w])=>[w,b])),y=new Map(u.map(([b,w])=>[w,b]));return s.invert=b=>y.has(b)?b:m.has(b)?m.get(b):n(b),s},s=>(t!==null&&(s.map=t),n!==null&&(s.invert=n),s)]}function a5(e,t){const n=Object.keys(e);for(const r of Object.values(t)){const{name:i}=r.getOptions();if(!(i in e))e[i]=r;else{const s=n.filter(h=>h.startsWith(i)).map(h=>+(h.replace(i,"")||0)),l=Sl(s)+1,u=`${i}${l}`;e[u]=r,r.getOptions().key=u}}return e}function s5(e,t){const[n]=Hc("scale",t),{relations:r}=e,[i]=V9(r),s=n(e);return i(s)}function H9(e){const t=e.flatMap(n=>Array.from(n.values())).flatMap(n=>n.channels.map(r=>r.scale));l5(t,"x"),l5(t,"y")}function Z9(e){const{channels:t=[],type:n,scale:r={}}=e,i=["shape","color","opacity","size"];return t.length!==0?t:n==="axisX"?["x"]:n==="axisY"?["y"]:n==="legends"?Object.keys(r).filter(s=>i.includes(s)):[]}function l5(e,t){const n=e.filter(({name:s,facet:l=!0})=>l&&s===t),r=n.flatMap(s=>s.domain),i=n.every(c5)?S0(r):n.every(u5)?Array.from(new Set(r)):null;if(i!==null)for(const s of n)s.domain=i}function W9(e,t,n){const{ratio:r}=n;return r==null?t:c5({type:e})?G9(t,r,e):u5({type:e})?X9(t,r):t}function G9(e,t,n){const r=e.map(Number),i=new hh({domain:r,range:[r[0],r[0]+(r[r.length-1]-r[0])*t]});return n==="time"?e.map(s=>new Date(i.map(s))):e.map(s=>i.map(s))}function X9(e,t){const n=Math.round(e.length*t);return e.slice(0,n)}function c5(e){const{type:t}=e;return typeof t!="string"?!1:["linear","log","pow","time"].includes(t)}function u5(e){const{type:t}=e;return typeof t!="string"?!1:["band","point","ordinal"].includes(t)}function Y9(e,t,n){const{type:r,domain:i,range:s,quantitative:l,ordinal:u}=n;return r!==void 0?r:cz(t)?"identity":typeof s=="string"?"linear":(i||s||[]).length>2?LO(e,u):i!==void 0?p5([i])?LO(e,u):m5(t)?"time":h5(e,s,l):p5(t)?LO(e,u):m5(t)?"time":h5(e,s,l)}function $9(e,t,n,r){const{domain:i}=r;if(i!==void 0)return i;switch(e){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":return d5(iz(n,r),r);case"band":case"ordinal":case"point":return oz(n);case"quantile":return az(n);case"sequential":return d5(sz(n),r);default:return[]}}function K9(e,t,n,r,i,s,l){const{range:u}=r;if(typeof u=="string")return Q9(u);if(u!==void 0)return u;const{rangeMin:h,rangeMax:p}=r;switch(e){case"linear":case"time":case"log":case"pow":case"sqrt":{const m=f5(n,r,i,s,l),[y,b]=lz(t,m);return[h!=null?h:y,p!=null?p:b]}case"band":case"point":{const m=t==="size"?5:0,y=t==="size"?10:1;return[h!=null?h:m,p!=null?p:y]}case"ordinal":return f5(n,r,i,s,l);case"sequential":return;case"constant":return[n[0][0]];default:return[]}}function q9(e,t,n,r,i){switch(e){case"linear":case"time":case"log":case"pow":case"sqrt":return tz(i,r);case"band":case"point":return nz(e,t,i,r);case"sequential":return ez(r);default:return r}}function f5(e,t,n,r,i){const[s]=Hc("palette",i),{category10:l,category20:u}=r,h=lP(n).length<=l.length?l:u,{palette:p=h,offset:m}=t;if(Array.isArray(p))return p;try{return s({type:p})}catch(y){const b=J9(p,n,m);if(b)return b;throw new Error(`Unknown Component: ${p} `)}}function Q9(e){return e.split("-")}function J9(e,t,n=r=>r){if(!e)return null;const r=Sv(e),i=X[`scheme${r}`],s=X[`interpolate${r}`];if(!i&&!s)return null;if(i){if(!i.some(Array.isArray))return i;const l=i[t.length];if(l)return l}return t.map((l,u)=>s(n(u/t.length)))}function ez(e){const{palette:t="ylGnBu",offset:n}=e,r=Sv(t),i=X[`interpolate${r}`];if(!i)throw new Error(`Unknown palette: ${r}`);return{interpolator:n?s=>i(n(s)):i}}function tz(e,t){const{interpolate:n=up,nice:r=!1,tickCount:i=5}=t;return Object.assign(Object.assign({},t),{interpolate:n,nice:r,tickCount:i})}function nz(e,t,n,r){if(r.padding!==void 0||r.paddingInner!==void 0||r.paddingOuter!==void 0)return Object.assign(Object.assign({},r),{unknown:NaN});const i=rz(e,t,n),{paddingInner:s=i,paddingOuter:l=i}=r;return Object.assign(Object.assign({},r),{paddingInner:s,paddingOuter:l,padding:i,unknown:NaN})}function rz(e,t,n){return t==="enterDelay"||t==="enterDuration"||t==="size"?0:e==="band"?pI(n)?0:.1:e==="point"?.5:0}function LO(e,t){return t||(uz(e)?"point":"ordinal")}function h5(e,t,n){return n||(e!=="color"||t?"linear":"sequential")}function d5(e,t){if(e.length===0)return e;const{domainMin:n,domainMax:r}=t,[i,s]=e;return[n!=null?n:i,r!=null?r:s]}function iz(e,t){const{zero:n=!1}=t;let r=1/0,i=-1/0;for(const s of e)for(const l of s)Ql(l)&&(r=Math.min(r,+l),i=Math.max(i,+l));return r===1/0?[]:n?[Math.min(0,r),i]:[r,i]}function oz(e){return Array.from(new Set(e.flat()))}function az(e){return e.flat().sort()}function sz(e){let t=1/0,n=-1/0;for(const r of e)for(const i of r)Ql(i)&&(t=Math.min(t,+i),n=Math.max(n,+i));return t===1/0?[]:[t<0?-n:t,n]}function lz(e,t){return e==="enterDelay"?[0,1e3]:e=="enterDuration"?[300,1e3]:e.startsWith("y")||e.startsWith("position")?[1,0]:e==="color"?[gA(t),fE(t)]:e==="opacity"?[0,1]:e==="size"?[1,10]:[0,1]}function p5(e){return DO(e,t=>{const n=typeof t;return n==="string"||n==="boolean"})}function m5(e){return DO(e,t=>t instanceof Date)}function cz(e){return DO(e,vg)}function DO(e,t){for(const n of e)if(n.some(t))return!0;return!1}function uz(e){return e.startsWith("x")||e.startsWith("y")||e.startsWith("position")||e.startsWith("size")}function fz(e){return e.startsWith("x")||e.startsWith("y")||e.startsWith("position")||e==="enterDelay"||e==="enterDuration"||e==="updateDelay"||e==="updateDuration"||e==="exitDelay"||e==="exitDuration"}function hz(e){if(!e||!e.type)return!1;if(typeof e.type=="function")return!0;const{type:t,domain:n,range:r,interpolator:i}=e,s=n&&n.length>0,l=r&&r.length>0;return!!(["linear","sqrt","log","time","pow","threshold","quantize","quantile","ordinal","band","point"].includes(t)&&s&&l||["sequential"].includes(t)&&s&&(l||i)||["constant","identity"].includes(t)&&l)}const dz={linear:"linear",identity:"identity",log:"log",pow:"pow",sqrt:"sqrt",sequential:"sequential"},pz={threshold:"threshold",quantize:"quantize",quantile:"quantile"},mz={ordinal:"ordinal",band:"band",point:"point"},vz={constant:"constant"};var jg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function gz(e,t,n){const{coordinates:r=[],title:i}=t,[,s]=Hc("component",n),l=e.filter(({guide:m})=>m!==null),u=[],h=Cz(t,e,n);if(u.push(...h),i){const{props:m}=s("title"),{defaultPosition:y,defaultOrientation:b,defaultOrder:w,defaultSize:R,defaultCrossPadding:M}=m,I=typeof i=="string"?{title:i}:i;u.push(Object.assign({type:"title",position:y,orientation:b,order:w,crossPadding:M[0],defaultSize:R},I))}return Ez(l,r).forEach(([m,y])=>{const{props:b}=s(m),{defaultPosition:w,defaultPlane:R="xy",defaultOrientation:M,defaultSize:I,defaultOrder:N,defaultLength:U,defaultPadding:Z=[0,0],defaultCrossPadding:Y=[0,0]}=b,$=ni({},...y),{guide:J,field:se}=$,pe=Array.isArray(J)?J:[J];for(const Ce of pe){const[Ue,Je]=wz(m,w,M,Ce,y,l,r);if(!Ue&&!Je)continue;const lt=Ue==="left"||Ue==="right",Ge=lt?Z[1]:Z[0],at=lt?Y[1]:Y[0],{size:st,order:ft=N,length:Vt=U,padding:wt=Ge,crossPadding:zt=at}=Ce;u.push(Object.assign(Object.assign({title:se},Ce),{defaultSize:I,length:Vt,position:Ue,plane:R,orientation:Je,padding:wt,order:ft,crossPadding:zt,size:st,type:m,scales:y}))}}),u}function v5(e,t,n,r,i){const[s]=Hc("component",r),{scaleInstances:l,scale:u,bbox:h}=e,p=jg(e,["scaleInstances","scale","bbox"]),m={bbox:h,library:r};return s(p)({coordinate:t,library:r,markState:i,scales:l,theme:n,value:m,scale:u})}function yz(e){return e.map(t=>{const n=ni(t,t.style);return delete n.style,n})}function wte(e){return e.flatMap(t=>t.type=="group"?t.children:t)}function g5(e,t){const n=["left","right","bottom","top"];return Z1(e,({type:s,position:l,group:u})=>n.includes(l)?u===void 0?s.startsWith("legend")?`legend-${l}`:Symbol("independent"):u==="independent"?Symbol("independent"):u:Symbol("independent")).flatMap(([,s])=>{if(s.length===1)return s[0];if(t!==void 0){const m=s.filter(M=>M.length!==void 0).map(M=>M.length),y=sp(m);if(y>t)return s.forEach(M=>M.group=Symbol("independent")),s;const b=t-y,w=s.length-m.length,R=b/w;s.forEach(M=>{M.length===void 0&&(M.length=R)})}const l=Sl(s,m=>m.size),u=Sl(s,m=>m.order),h=Sl(s,m=>m.crossPadding),p=s[0].position;return{type:"group",size:l,order:u,position:p,children:s,crossPadding:h}})}function _z(e,t){const n=["shape","size","color","opacity"],r=(b,w)=>b==="constant"&&w==="size",i=e.filter(({type:b,name:w})=>typeof b=="string"&&n.includes(w)&&!r(b,w)),s=i.filter(({type:b})=>b==="constant"),l=i.filter(({type:b})=>b!=="constant"),h=Z1(l,b=>b.field?b.field:Symbol("independent")).map(([b,w])=>[b,[...w,...s]]).filter(([,b])=>b.some(w=>w.type!=="constant")),p=new Map(h);if(p.size===0)return[];const m=b=>b.sort(([w],[R])=>w.localeCompare(R));return Array.from(p).map(([,b])=>{const R=yA(b).sort((M,I)=>I.length-M.length).map(M=>({combination:M,option:M.map(I=>[I.name,bz(I)])}));for(const{option:M,combination:I}of R)if(!M.every(N=>N[1]==="constant")&&M.every(N=>N[1]==="discrete"||N[1]==="constant"))return["legendCategory",I];for(const[M,I]of vE)for(const{option:N,combination:U}of R)if(I.some(Z=>dE(m(Z),m(N))))return[M,U];return null}).filter(Ql)}function bz(e){const{type:t}=e;return typeof t!="string"?null:t in dz?"continuous":t in mz?"discrete":t in pz?"distribution":t in vz?"constant":null}function xz(e,t){return e.map(n=>{const{name:r}=n;if(m7(t)||pI(t)||M_(t)&&(s1(t)||Px(t)))return null;if(r.startsWith("x"))return s1(t)?["axisArc",[n]]:Px(t)?["axisLinear",[n]]:[M_(t)?"axisY":"axisX",[n]];if(r.startsWith("y"))return s1(t)?["axisLinear",[n]]:Px(t)?["axisArc",[n]]:[M_(t)?"axisX":"axisY",[n]];if(r.startsWith("z"))return["axisZ",[n]];if(r.startsWith("position")){if(y7(t))return["axisRadar",[n]];if(!s1(t))return["axisY",[n]]}return null}).filter(Ql)}function Ez(e,t){const n=e.filter(r=>hz(r));return[..._z(n,t),...xz(n,t)]}function NO(e){const t=tm(e,"polar");if(t.length){const r=t[t.length-1],{startAngle:i,endAngle:s}=pE(r);return[i,s]}const n=tm(e,"radial");if(n.length){const r=n[n.length-1],{startAngle:i,endAngle:s}=mE(r);return[i,s]}return[-Math.PI/2,Math.PI/2*3]}function Sz(e){const t=/position(\d*)/g.exec(e);return t?+t[1]:null}function Tz(e,t,n,r,i){const{name:s}=n[0];if(e==="axisRadar"){const l=r.filter(y=>y.name.startsWith("position")),u=Sz(s);if(s===l.slice(-1)[0].name||u===null)return[null,null];const[h,p]=NO(i);return["center",(p-h)/(l.length-1)*u+h]}if(e==="axisY"&&v7(i))return M_(i)?["center","horizontal"]:["center","vertical"];if(e==="axisLinear"){const[l]=NO(i);return["center",l]}return e==="axisArc"?t[0]==="inner"?["inner",null]:["outer",null]:s1(i)?["center",null]:Px(i)?["center",null]:e==="axisX"&&g7(i)||e==="axisX"&&_7(i)?["top",null]:t}function wz(e,t,n,r,i,s,l){const[u]=NO(l),h=[r.position||t,u!=null?u:n];return typeof e=="string"&&e.startsWith("axis")?Tz(e,h,i,s,l):typeof e=="string"&&e.startsWith("legend")&&s1(l)&&r.position==="center"?["center","vertical"]:h}function Az(e,t,n=[]){return e==="x"?M_(n)?`${t}Y`:`${t}X`:e==="y"?M_(n)?`${t}X`:`${t}Y`:null}function Cz(e,t,n){const[,r]=Hc("component",n),{coordinates:i}=e;function s(l,u,h,p){const m=Az(u,l,i);if(!p||!m)return;const{props:y}=r(m),{defaultPosition:b,defaultSize:w,defaultOrder:R,defaultCrossPadding:[M]}=y;return Object.assign(Object.assign({position:b,defaultSize:w,order:R,type:m,crossPadding:M},p),{scales:[h]})}return t.filter(l=>l.slider||l.scrollbar).flatMap(l=>{const{slider:u,scrollbar:h,name:p}=l;return[s("slider",p,l,u),s("scrollbar",p,l,h)]}).filter(l=>!!l)}function y5(e,t,n,r,i,s){const{type:l}=e;if(!["left","right","bottom","top"].includes(r)||typeof l!="string")return;const h=l;return(h.startsWith("axis")?Iz:h.startsWith("group")?Oz:h.startsWith("legendContinuous")?Lz:h==="legendCategory"?Dz:h.startsWith("slider")?Pz:h==="title"?Mz:h.startsWith("scrollbar")?Rz:()=>{})(e,t,n,r,i,s)}function Oz(e,t,n,r,i,s){const{children:l}=e,u=Sl(l,p=>p.crossPadding);l.forEach(p=>p.crossPadding=u),l.forEach(p=>y5(p,t,n,r,i,s));const h=Sl(l,p=>p.size);e.size=h,l.forEach(p=>p.size=h)}function Rz(e,t,n,r,i,s){const{trackSize:l=6}=ni({},i.scrollbar,e);e.size=l}function Mz(e,t,n,r,i,s){const l=ni({},i.title,e),{title:u,subtitle:h,spacing:p=0}=l,m=jg(l,["title","subtitle","spacing"]);if(u){const y=po(m,"title"),b=JS(u,y);e.size=b.height}if(h){const y=po(m,"subtitle"),b=JS(h,y);e.size+=p+b.height}}function Pz(e,t,n,r,i,s){const l=()=>{const{slider:m}=i;return ni({},m,e)},{trackSize:u,handleIconSize:h}=l(),p=Math.max(u,h*2.4);e.size=p}function Iz(e,t,n,r,i,s){var l;e.transform=e.transform||[{type:"hide"}];const u=r==="left"||r==="right",h=_5(e,r,i),{tickLength:p=0,labelSpacing:m=0,titleSpacing:y=0,labelAutoRotate:b}=h,w=jg(h,["tickLength","labelSpacing","titleSpacing","labelAutoRotate"]),R=KS(e,s),M=qS(w,R),I=p+m;if(M&&M.length){const U=Sl(M,Y=>Y.width),Z=Sl(M,Y=>Y.height);if(u)e.size=U+I;else{const{tickFilter:Y,labelTransform:$}=e;Fz(R,M,t,n,Y)&&!$&&b!==!1&&b!==null?(e.labelTransform="rotate(90)",e.size=U+I):(e.labelTransform=(l=e.labelTransform)!==null&&l!==void 0?l:"rotate(0)",e.size=Z+I)}}else e.size=p;const N=QS(w);N&&(u?e.size+=y+N.width:e.size+=y+N.height)}function Lz(e,t,n,r,i,s){const u=(()=>{const{legendContinuous:Y}=i;return ni({},Y,e)})(),{labelSpacing:h=0,titleSpacing:p=0}=u,m=jg(u,["labelSpacing","titleSpacing"]),y=r==="left"||r==="right",b=po(m,"ribbon"),{size:w}=b,R=po(m,"handleIcon"),{size:M}=R,I=Math.max(w,M*2.4);e.size=I;const N=KS(e,s),U=qS(m,N);if(U){const Y=y?"width":"height",$=Sl(U,J=>J[Y]);e.size+=$+h}const Z=QS(m);Z&&(y?e.size=Math.max(e.size,Z.width):e.size+=p+Z.height)}function Dz(e,t,n,r,i,s){const u=(()=>{const{legendCategory:at}=i,{title:st}=e,[ft,Vt]=Array.isArray(st)?[st,void 0]:[void 0,st];return ni({title:ft},at,Object.assign(Object.assign({},e),{title:Vt}))})(),{itemSpacing:h,itemMarkerSize:p,titleSpacing:m,rowPadding:y,colPadding:b,maxCols:w=1/0,maxRows:R=1/0}=u,M=jg(u,["itemSpacing","itemMarkerSize","titleSpacing","rowPadding","colPadding","maxCols","maxRows"]),{cols:I,length:N}=e,U=at=>Math.min(at,R),Z=at=>Math.min(at,w),Y=r==="left"||r==="right",$=N===void 0?t+(Y?0:n[0]+n[1]):N,J=QS(M),se=KS(e,s),pe=qS(M,se,"itemLabel"),Ce=Math.max(pe[0].height,p)+y,Ue=(at,st=0)=>p+at+h[0]+st;Y?(()=>{let at=-1/0,st=0,ft=1,Vt=0,wt=-1/0,zt=-1/0;const En=J?J.height:0,Vn=$-En;for(const{width:ar}of pe){const lr=Ue(ar,b);at=Math.max(at,lr),st+Ce>Vn?(ft++,wt=Math.max(wt,Vt),zt=Math.max(zt,st),Vt=1,st=Ce):(st+=Ce,Vt++)}ft<=1&&(wt=Vt,zt=st),e.size=at*Z(ft),e.length=zt+En,ni(e,{cols:Z(ft),gridRow:wt})})():typeof I=="number"?(()=>{const at=Math.ceil(pe.length/I),st=Sl(pe,ft=>Ue(ft.width))*I;e.size=Ce*U(at)-y,e.length=Math.min(st,$)})():(()=>{let at=1,st=0,ft=-1/0;for(const{width:Vt}of pe){const wt=Ue(Vt,b);st+wt>$?(ft=Math.max(ft,st),st=wt,at++):st+=wt}at===1&&(ft=st),e.size=Ce*U(at)-y,e.length=ft})(),J&&(Y?e.size=Math.max(e.size,J.width):e.size+=m+J.height)}function KS(e,t){const[n]=Hc("scale",t),{scales:r,tickCount:i,tickMethod:s}=e,l=r.find(u=>u.type!=="constant"&&u.type!=="identity");return i!==void 0&&(l.tickCount=i),s!==void 0&&(l.tickMethod=s),n(l)}function qS(e,t,n="label"){const{labelFormatter:r,tickFilter:i,label:s=!0}=e,l=jg(e,["labelFormatter","tickFilter","label"]);if(!s)return null;const u=Nz(t,r,i),h=po(l,n),p=u.map((b,w)=>Object.fromEntries(Object.entries(h).map(([R,M])=>[R,typeof M=="function"?M(b,w):M]))),m=u.map((b,w)=>{const R=p[w];return JS(b,R)});if(!p.some(b=>b.transform)){const b=u.map((w,R)=>R);e.indexBBox=new Map(b.map(w=>[w,[u[w],m[w]]]))}return m}function QS(e){const t=p=>p===!1||p===null,{title:n}=e,r=jg(e,["title"]);if(t(n)||n===void 0)return null;const i=po(r,"title"),{direction:s,transform:l}=i,u=Array.isArray(n)?n.join(","):n;return typeof u!="string"?null:JS(u,Object.assign(Object.assign({},i),{transform:l||(s==="vertical"?"rotate(-90)":"")}))}function _5(e,t,n){const{title:r}=e,[i,s]=Array.isArray(r)?[r,void 0]:[void 0,r],{axis:l,[`axis${Mb(t)}`]:u}=n;return ni({title:i},l,u,Object.assign(Object.assign({},e),{title:s}))}function b5(e,t){const n=e.getTicks?e.getTicks():e.getOptions().domain;return t?n.filter(t):n}function Nz(e,t,n){const i=b5(e,n).map(l=>typeof l=="number"?$1(l):l),s=t?typeof t=="string"?Lm(t):t:e.getFormatter?e.getFormatter():l=>`${l}`;return i.map(s)}function Bz(e,t){return e.getBandWidth?e.getBandWidth(t)/2:0}function Fz(e,t,n,r,i){if(sp(t,w=>w.width)>n)return!0;const l=e.clone();l.update({range:[0,n]});const u=b5(e,i),h=u.map(w=>l.map(w)+Bz(l,w)),p=u.map((w,R)=>R),m=-r[0],y=n+r[1],b=(w,R)=>{const{width:M}=R;return[w-M/2,w+M/2]};for(let w=0;w<p.length;w++){const R=h[w],[M,I]=b(R,t[w]);if(M<m||I>y)return!0;const N=h[w+1];if(N){const[U]=b(N,t[w+1]);if(I>U)return!0}}return!1}function JS(e,t){const n=kz(e),{filter:r}=t,i=jg(t,["filter"]);return n.attr(Object.assign(Object.assign({},i),{visibility:"none"})),n.getBBox()}function kz(e){return e instanceof Sr?e:new ma({style:{text:`${e}`}})}function Zp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function zz(e){const t=e.find(({type:i})=>i==="axisX"),n=e.find(({type:i})=>i==="axisY"),r=e.find(({type:i})=>i==="axisZ");t&&n&&r&&(t.plane="xy",n.plane="xy",r.plane="yz",r.origin=[t.bbox.x,t.bbox.y,0],r.eulerAngles=[0,-90,0],r.bbox.x=t.bbox.x,r.bbox.y=t.bbox.y,e.push(Object.assign(Object.assign({},t),{plane:"xz",showLabel:!1,showTitle:!1,origin:[t.bbox.x,t.bbox.y,0],eulerAngles:[-90,0,0]})),e.push(Object.assign(Object.assign({},n),{plane:"yz",showLabel:!1,showTitle:!1,origin:[n.bbox.x+n.bbox.width,n.bbox.y,0],eulerAngles:[0,-90,0]})),e.push(Object.assign(Object.assign({},r),{plane:"xz",actualPosition:"left",showLabel:!1,showTitle:!1,eulerAngles:[90,-90,0]})))}function Uz(e,t,n,r){var i,s;const{width:l,height:u,depth:h,x:p=0,y:m=0,z:y=0,inset:b=(i=n.inset)!==null&&i!==void 0?i:0,insetLeft:w=b,insetTop:R=b,insetBottom:M=b,insetRight:I=b,margin:N=(s=n.margin)!==null&&s!==void 0?s:0,marginLeft:U=N,marginBottom:Z=N,marginTop:Y=N,marginRight:$=N,padding:J=n.padding,paddingBottom:se=J,paddingLeft:pe=J,paddingRight:Ce=J,paddingTop:Ue=J}=Vz(e,t,n,r),Je=1/4,lt=(Qi,Zi,Eo,Go,oa)=>{const{marks:Ca}=t;if(Ca.length===0)return[Go,oa];if(Qi-Go-oa-Qi*Je>0)return[Go,oa];const us=Qi*(1-Je);return[Zi==="auto"?us*Go/(Go+oa):Go,Eo==="auto"?us*oa/(Go+oa):oa]},Ge=Qi=>Qi==="auto"?20:Qi!=null?Qi:20,at=Ge(Ue),st=Ge(se),ft=x5(e,u-at-st,[at+Y,st+Z],["left","right"],t,n,r),{paddingLeft:Vt,paddingRight:wt}=ft,zt=l-U-$,[En,Vn]=lt(zt,pe,Ce,Vt,wt),ar=zt-En-Vn,lr=x5(e,ar,[En+U,Vn+$],["bottom","top"],t,n,r),{paddingTop:Vr,paddingBottom:ui}=lr,qi=u-Z-Y,[Jr,Qr]=lt(qi,se,Ue,ui,Vr),Mo=qi-Jr-Qr;return{width:l,height:u,depth:h,insetLeft:w,insetTop:R,insetBottom:M,insetRight:I,innerWidth:ar,innerHeight:Mo,paddingLeft:En,paddingRight:Vn,paddingTop:Qr,paddingBottom:Jr,marginLeft:U,marginBottom:Z,marginTop:Y,marginRight:$,x:p,y:m,z:y}}function jz(e){const{height:t,width:n,padding:r=0,paddingLeft:i=r,paddingRight:s=r,paddingTop:l=r,paddingBottom:u=r,margin:h=16,marginLeft:p=h,marginRight:m=h,marginTop:y=h,marginBottom:b=h,inset:w=0,insetLeft:R=w,insetRight:M=w,insetTop:I=w,insetBottom:N=w}=e,U=$=>$==="auto"?20:$,Z=n-U(i)-U(s)-p-m-R-M,Y=t-U(l)-U(u)-y-b-I-N;return{width:Z,height:Y}}function Vz(e,t,n,r){const{coordinates:i}=t;if(!s1(i)&&!Px(i))return t;const s=e.filter(N=>typeof N.type=="string"&&N.type.startsWith("axis"));if(s.length===0)return t;const l=s.map(N=>{const U=N.type==="axisArc"?"arc":"linear";return _5(N,U,n)}),u=Sl(l,N=>{var U;return(U=N.labelSpacing)!==null&&U!==void 0?U:0}),h=s.flatMap((N,U)=>{const Z=l[U],Y=KS(N,r);return qS(Z,Y)}).filter(Ql),p=Sl(h,N=>N.height)+u,m=s.flatMap((N,U)=>{const Z=l[U];return QS(Z)}).filter(N=>N!==null),y=m.length===0?0:Sl(m,N=>N.height),{inset:b=p,insetLeft:w=b,insetBottom:R=b,insetTop:M=b+y,insetRight:I=b}=t;return Object.assign(Object.assign({},t),{insetLeft:w,insetBottom:R,insetTop:M,insetRight:I})}function x5(e,t,n,r,i,s,l){const u=vc(e,R=>R.position),{padding:h=s.padding,paddingLeft:p=h,paddingRight:m=h,paddingBottom:y=h,paddingTop:b=h}=i,w={paddingBottom:y,paddingLeft:p,paddingTop:b,paddingRight:m};for(const R of r){const M=`padding${Mb(Zs(R))}`,I=u.get(R)||[],N=w[M],U=Ce=>{Ce.size===void 0&&(Ce.size=Ce.defaultSize)},Z=Ce=>{Ce.type==="group"?(Ce.children.forEach(U),Ce.size=Sl(Ce.children,Ue=>Ue.size)):Ce.size=Ce.defaultSize},Y=Ce=>{Ce.size||(N!=="auto"?Z(Ce):(y5(Ce,t,n,R,s,l),U(Ce)))},$=Ce=>{Ce.type.startsWith("axis")&&Ce.labelAutoHide===void 0&&(Ce.labelAutoHide=!0)},J=R==="bottom"||R==="top",se=Zp(I,Ce=>Ce.order),pe=I.filter(Ce=>Ce.type.startsWith("axis")&&Ce.order==se);if(pe.length&&(pe[0].crossPadding=0),typeof N=="number")I.forEach(U),I.forEach($);else if(I.length===0)w[M]=0;else{const Ce=J?t+n[0]+n[1]:t,Ue=g5(I,Ce);Ue.forEach(Y);const Je=Ue.reduce((lt,{size:Ge,crossPadding:at=12})=>lt+Ge+at,0);w[M]=Je}}return w}function Hz(e,t,n){const r=vc(e,J=>`${J.plane||"xy"}-${J.position}`),{paddingLeft:i,paddingRight:s,paddingTop:l,paddingBottom:u,marginLeft:h,marginTop:p,marginBottom:m,marginRight:y,innerHeight:b,innerWidth:w,insetBottom:R,insetLeft:M,insetRight:I,insetTop:N,height:U,width:Z,depth:Y}=n,$={xy:BO({width:Z,height:U,paddingLeft:i,paddingRight:s,paddingTop:l,paddingBottom:u,marginLeft:h,marginTop:p,marginBottom:m,marginRight:y,innerHeight:b,innerWidth:w,insetBottom:R,insetLeft:M,insetRight:I,insetTop:N}),yz:BO({width:Y,height:U,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:Y,innerHeight:U,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0}),xz:BO({width:Z,height:Y,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:Z,innerHeight:Y,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0})};for(const[J,se]of r.entries()){const[pe,Ce]=J.split("-"),Ue=$[pe][Ce],[Je,lt]=hE(se,Ge=>typeof Ge.type!="string"?!1:!!(Ce==="center"||Ge.type.startsWith("axis")&&["inner","outer"].includes(Ce)));Je.length&&Zz(Je,t,Ue,Ce),lt.length&&Jz(se,t,Ue)}}function BO({width:e,height:t,paddingLeft:n,paddingRight:r,paddingTop:i,paddingBottom:s,marginLeft:l,marginTop:u,marginBottom:h,marginRight:p,innerHeight:m,innerWidth:y,insetBottom:b,insetLeft:w,insetRight:R,insetTop:M}){const I=n+l,N=i+u,U=r+p,Z=s+h,Y=e-l-p,$=[I+w,N+M,y-w-R,m-M-b,"center",null,null];return{top:[I,0,y,N,"vertical",!0,Tu,l,Y],right:[e-U,N,U,m,"horizontal",!1,Tu],bottom:[I,t-Z,y,Z,"vertical",!1,Tu,l,Y],left:[0,N,I,m,"horizontal",!0,Tu],"top-left":[I,0,y,N,"vertical",!0,Tu],"top-right":[I,0,y,N,"vertical",!0,Tu],"bottom-left":[I,t-Z,y,Z,"vertical",!1,Tu],"bottom-right":[I,t-Z,y,Z,"vertical",!1,Tu],center:$,inner:$,outer:$}}function Zz(e,t,n,r){const[i,s]=hE(e,l=>!!(typeof l.type=="string"&&l.type.startsWith("axis")));Wz(i,t,n,r),eU(s,t,n)}function Wz(e,t,n,r){r==="center"?xA(t)?Qz(e,t,n,r):Ml(t)?Yz(e,t,n):Py(t)&&$z(e,t,n,e[0].orientation):r==="inner"?Gz(e,t,n):r==="outer"&&Xz(e,t,n)}function Gz(e,t,n){const[r,i,,s]=n,[l,u]=t.getCenter(),[h]=K1(t),p=s/2,m=h*p,y=l-m,b=u-m;for(let w=0;w<e.length;w++){const R=e[w];R.bbox={x:r+y,y:i+b,width:m*2,height:m*2}}}function Xz(e,t,n){const[r,i,s,l]=n;for(const u of e)u.bbox={x:r,y:i,width:s,height:l}}function Yz(e,t,n){const[r,i,s,l]=n;for(const u of e)u.bbox={x:r,y:i,width:s,height:l}}function $z(e,t,n,r){r==="horizontal"?qz(e,t,n):r==="vertical"&&Kz(e,t,n)}function Kz(e,t,n){const[r,i,,s]=n,l=new Array(e.length).fill(0),h=t.map(l).filter((p,m)=>m%2===0).map(p=>p+r);for(let p=0;p<e.length;p++){const m=e[p],y=h[p],b=h[p+1]-y;m.bbox={x:y,y:i,width:b,height:s}}}function qz(e,t,n){const[r,i,s]=n,l=new Array(e.length).fill(0),h=t.map(l).filter((p,m)=>m%2===1).map(p=>p+i);for(let p=0;p<e.length;p++){const m=e[p],y=h[p],b=h[p+1]-y;m.bbox={x:r,y,width:s,height:b}}}function Qz(e,t,n,r){const[i,s,l,u]=n;for(const h of e)h.bbox={x:i,y:s,width:l,height:u},h.radar={index:e.indexOf(h),count:e.length}}function Jz(e,t,n){const[r,i,s,l,u,h,p,m,y]=n,[b,w,R,M,I,N,U,Z]=u==="vertical"?["y",i,"x",r,"height",l,"width",s]:["x",r,"y",i,"width",s,"height",l];e.sort((Ce,Ue)=>p==null?void 0:p(Ce.order,Ue.order));const Y=Ce=>Ce==="title"||Ce==="group"||Ce.startsWith("legend"),$=(Ce,Ue,Je)=>Je===void 0?Ue:Y(Ce)?Je:Ue,J=(Ce,Ue,Je)=>Je===void 0?Ue:Y(Ce)?Je:Ue,se=h?w+N:w;for(let Ce=0,Ue=se;Ce<e.length;Ce++){const Je=e[Ce],{crossPadding:lt=0,type:Ge}=Je,{size:at}=Je;Je.bbox={[b]:h?Ue-at-lt:Ue+lt,[R]:J(Ge,M,m),[I]:at,[U]:$(Ge,Z,y)},Ue+=(at+lt)*(h?-1:1)}const pe=e.filter(Ce=>Ce.type==="group");for(const Ce of pe){const{bbox:Ue,children:Je}=Ce,lt=Ue[U],Ge=lt/Je.length,at=Je.reduce((zt,En)=>{var Vn;const ar=(Vn=En.layout)===null||Vn===void 0?void 0:Vn.justifyContent;return ar||zt},"flex-start"),st=Je.map((zt,En)=>{const{length:Vn=Ge,padding:ar=0}=zt;return Vn+(En===Je.length-1?0:ar)}),ft=sp(st),Vt=lt-ft,wt=at==="flex-start"?0:at==="center"?Vt/2:Vt;for(let zt=0,En=Ue[R]+wt;zt<Je.length;zt++){const Vn=Je[zt],{padding:ar=0}=Vn,lr=zt===Je.length-1?0:ar;Vn.bbox={[I]:Ue[I],[b]:Ue[b],[R]:En,[U]:st[zt]-lr},ni(Vn,{layout:{justifyContent:at}}),En+=st[zt]}}}function eU(e,t,n){if(e.length===0)return;const[r,i,s,l]=n,[u]=K1(t),h=l/2*u/Math.sqrt(2),p=r+s/2,m=i+l/2;for(let y=0;y<e.length;y++){const b=e[y];b.bbox={x:p-h,y:m-h,width:h*2,height:h*2}}}function Gm(e,t,n={},r=!1){if(X0(e)||Array.isArray(e)&&r)return e;const i=po(e,t);return ni(n,i)}function eT(e,t={}){return X0(e)||Array.isArray(e)||!E5(e)?e:ni(t,e)}function E5(e){if(Object.keys(e).length===0)return!0;const{title:t,items:n}=e;return t!==void 0||n!==void 0}function Xm(e,t){return typeof e=="object"?po(e,t):e}var tU=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},N_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function nU(e,t,n){const{encode:r={},scale:i={},transform:s=[]}=t,l=N_(t,["encode","scale","transform"]);return[e,Object.assign(Object.assign({},l),{encode:r,scale:i,transform:s})]}function S5(e,t,n){return tU(this,void 0,void 0,function*(){const{library:r}=n,{data:i}=t,[s]=Hc("data",r),l=mU(i),{transform:u=[]}=l,m=[N_(l,["transform"]),...u].map(w=>s(w,n)),y=yield rA(m)(i),b=i&&!Array.isArray(i)&&!Array.isArray(y)?{value:y}:y;return[Array.isArray(y)?wv(y):[],Object.assign(Object.assign({},t),{data:b})]})}function rU(e,t,n){const{encode:r}=t;if(!r)return[e,t];const i={};for(const[s,l]of Object.entries(r))if(Array.isArray(l))for(let u=0;u<l.length;u++){const h=`${s}${u===0?"":u}`;i[h]=l[u]}else i[s]=l;return[e,Object.assign(Object.assign({},t),{encode:i})]}function iU(e,t,n){const{encode:r,data:i}=t;if(!r)return[e,t];const s=_0(r,l=>hU(l)?l:{type:dU(i,l),value:l});return[e,Object.assign(Object.assign({},t),{encode:s})]}function oU(e,t,n){const{encode:r}=t;if(!r)return[e,t];const i=_0(r,(s,l)=>{const{type:u}=s;return u!=="constant"||fz(l)?s:Object.assign(Object.assign({},s),{constant:!0})});return[e,Object.assign(Object.assign({},t),{encode:i})]}function aU(e,t,n){const{encode:r,data:i}=t;if(!r)return[e,t];const{library:s}=n,l=yU(s),u=_0(r,h=>l(i,h));return[e,Object.assign(Object.assign({},t),{encode:u})]}function sU(e,t,n){const{tooltip:r={}}=t;return X0(r)?[e,t]:Array.isArray(r)?[e,Object.assign(Object.assign({},t),{tooltip:{items:r}})]:vg(r)&&E5(r)?[e,Object.assign(Object.assign({},t),{tooltip:r})]:[e,Object.assign(Object.assign({},t),{tooltip:{items:[r]}})]}function lU(e,t,n){const{data:r,encode:i,tooltip:s={}}=t;if(X0(s))return[e,t];const l=y=>{if(!y)return y;if(typeof y=="string")return e.map(b=>({name:y,value:r[b][y]}));if(vg(y)){const{field:b,channel:w,color:R,name:M=b,valueFormatter:I=J=>J}=y,N=typeof I=="string"?Lm(I):I,U=w&&i[w],Z=U&&i[w].field,Y=M||Z||w,$=[];for(const J of e){const se=b?r[J][b]:U?i[w].value[J]:null;$[J]={name:Y,color:R,value:N(se)}}return $}if(typeof y=="function"){const b=[];for(const w of e){const R=y(r[w],w,r,i);vg(R)?b[w]=R:b[w]={value:R}}return b}return y},{title:u,items:h=[]}=s,p=N_(s,["title","items"]),m=Object.assign({title:l(u),items:Array.isArray(h)?h.map(l):[]},p);return[e,Object.assign(Object.assign({},t),{tooltip:m})]}function cU(e,t,n){const{encode:r}=t,i=N_(t,["encode"]);if(!r)return[e,t];const s=Object.entries(r),l=s.filter(([,h])=>{const{value:p}=h;return Array.isArray(p[0])}).flatMap(([h,p])=>{const m=[[h,new Array(e.length).fill(void 0)]],{value:y}=p,b=N_(p,["value"]);for(let w=0;w<y.length;w++){const R=y[w];if(Array.isArray(R))for(let M=0;M<R.length;M++){const I=m[M]||[`${h}${M}`,new Array(e).fill(void 0)];I[1][w]=R[M],m[M]=I}}return m.map(([w,R])=>[w,Object.assign({type:"column",value:R},b)])}),u=Object.fromEntries([...s,...l]);return[e,Object.assign(Object.assign({},i),{encode:u})]}function uU(e,t,n){const{axis:r={},legend:i={},slider:s={},scrollbar:l={}}=t,u=(p,m)=>{if(typeof p=="boolean")return p?{}:null;const y=p[m];return y===void 0||y?y:null},h=typeof r=="object"?Array.from(new Set(["x","y","z",...Object.keys(r)])):["x","y","z"];return ni(t,{scale:Object.assign(Object.assign({},Object.fromEntries(h.map(p=>{const m=u(l,p);return[p,Object.assign({guide:u(r,p),slider:u(s,p),scrollbar:m},m&&{ratio:m.ratio===void 0?.5:m.ratio})]}))),{color:{guide:u(i,"color")},size:{guide:u(i,"size")},shape:{guide:u(i,"shape")},opacity:{guide:u(i,"opacity")}})}),[e,t]}function fU(e,t,n){const{animate:r}=t;return r||r===void 0?[e,t]:(ni(t,{animate:{enter:{type:null},exit:{type:null},update:{type:null}}}),[e,t])}function hU(e){if(typeof e!="object"||e instanceof Date||e===null)return!1;const{type:t}=e;return Ql(t)}function dU(e,t){return typeof t=="function"?"transform":typeof t=="string"&&pU(e,t)?"field":"constant"}function pU(e,t){return Array.isArray(e)?e.some(n=>n[t]!==void 0):!1}function mU(e){if((0,Ft.Z)(e))return{type:"inline",value:e};if(!e)return{type:"inline",value:null};if(Array.isArray(e))return{type:"inline",value:e};const{type:t="inline"}=e,n=N_(e,["type"]);return Object.assign(Object.assign({},n),{type:t})}var T5=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},vU=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function gU(e,t,n){return T5(this,void 0,void 0,function*(){const[r,i]=yield _U(e,t,n),{encode:s,scale:l,data:u,tooltip:h}=i;if(Array.isArray(u)===!1)return null;const{channels:p}=t,m=G1(Object.entries(s).filter(([,b])=>Ql(b)),b=>b.map(([w,R])=>Object.assign({name:w},R)),([b])=>{var w;const R=(w=/([^\d]+)\d*$/.exec(b))===null||w===void 0?void 0:w[1],M=p.find(I=>I.name===R);return M!=null&&M.independent?b:R}),y=p.filter(b=>{const{name:w,required:R}=b;if(m.find(([M])=>M===w))return!0;if(R)throw new Error(`Missing encoding for channel: ${w}.`);return!1}).flatMap(b=>{const{name:w,scale:R,scaleKey:M,range:I,quantitative:N,ordinal:U}=b;return m.filter(([Y])=>Y.startsWith(w)).map(([Y,$],J)=>{const se=$.some(ft=>ft.visual),pe=$.some(ft=>ft.constant),Ce=l[Y]||{},{independent:Ue=!1,key:Je=M||Y,type:lt=pe?"constant":se?"identity":R}=Ce,Ge=vU(Ce,["independent","key","type"]),at=lt==="constant",st=at?void 0:I;return{name:Y,values:$,scaleKey:Ue||at?Symbol("independent"):Je,scale:Object.assign(Object.assign({type:lt,range:st},Ge),{quantitative:N,ordinal:U})}})});return[i,Object.assign(Object.assign({},t),{index:r,channels:y,tooltip:h})]})}function yU(e){const[t]=Hc("encode",e);return(n,r)=>r===void 0||n===void 0?null:Object.assign(Object.assign({},r),{type:"column",value:t(r)(n),field:bU(r)})}function _U(e,t,n){return T5(this,void 0,void 0,function*(){const{library:r}=n,[i]=Hc("transform",r),{preInference:s=[],postInference:l=[]}=t,{transform:u=[]}=e,h=[nU,S5,rU,iU,oU,aU,cU,fU,uU,sU,...s.map(i),...u.map(i),...l.map(i),lU];let p=[],m=e;for(const y of h)[p,m]=yield y(p,m,n);return[p,m]})}function bU(e){const{type:t,value:n}=e;return t==="field"&&typeof n=="string"?n:null}var Fv=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},Vg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function FO(e,t,n){var r;return Fv(this,void 0,void 0,function*(){const{library:i}=n,[s]=Hc("composition",i),[l]=Hc("interaction",i),u=new Set(Object.keys(i).map(Ge=>{var at;return(at=/mark\.(.*)/.exec(Ge))===null||at===void 0?void 0:at[1]}).filter(Ql)),h=new Set(Object.keys(i).map(Ge=>{var at;return(at=/component\.(.*)/.exec(Ge))===null||at===void 0?void 0:at[1]}).filter(Ql)),p=Ge=>{const{type:at}=Ge;if(typeof at=="function"){const{props:st={}}=at,{composite:ft=!0}=st;if(ft)return"mark"}return typeof at!="string"?at:u.has(at)||h.has(at)?"mark":at},m=Ge=>p(Ge)==="mark",y=Ge=>p(Ge)==="standardView",b=Ge=>{const{type:at}=Ge;return typeof at!="string"?!1:!!h.has(at)},w=Ge=>{if(y(Ge))return[Ge];const at=p(Ge);return s({type:at,static:b(Ge)})(Ge)},R=[],M=new Map,I=new Map,N=[e],U=[];for(;N.length;){const Ge=N.shift();if(y(Ge)){const at=I.get(Ge),[st,ft]=at?O5(at,Ge,i):yield A5(Ge,n);M.set(st,Ge),R.push(st);const Vt=ft.flatMap(w).map(wt=>dI(wt,i));if(N.push(...Vt),Vt.every(y)){const wt=yield Promise.all(Vt.map(zt=>C5(zt,n)));H9(wt);for(let zt=0;zt<Vt.length;zt++){const En=Vt[zt],Vn=wt[zt];I.set(En,Vn)}}}else{const at=m(Ge)?Ge:yield I5(Ge,n),st=w(at);Array.isArray(st)?N.push(...st):typeof st=="function"&&U.push(st())}}n.emitter.emit(El.BEFORE_PAINT);const Z=new Map,Y=new Map,$=[];t.selectAll(Ym(Dt)).data(R,Ge=>Ge.key).join(Ge=>Ge.append("g").attr("className",Dt).attr("id",at=>at.key).call(w5).each(function(at,st,ft){zO(at,Pa(ft),$,n),Z.set(at,ft)}),Ge=>Ge.call(w5).each(function(at,st,ft){zO(at,Pa(ft),$,n),Y.set(at,ft)}),Ge=>Ge.each(function(at,st,ft){const Vt=ft.nameInteraction.values();for(const wt of Vt)wt.destroy()}).remove());const J=(Ge,at,st)=>Array.from(Ge.entries()).map(([ft,Vt])=>{const wt=st||new Map,zt=(ar,lr=Vr=>Vr)=>wt.set(ar,lr),En=M.get(ft),Vn=EU(Pa(Vt),En,n);return{view:ft,container:Vt,options:En,setState:zt,update:(ar,lr)=>Fv(this,void 0,void 0,function*(){const ui=Cy(Array.from(wt.values()))(En);return yield Vn(ui,ar,()=>{Is(lr)&&at(Ge,lr,wt)})})}}),se=(Ge=Y,at,st)=>{var ft;const Vt=J(Ge,se,st);for(const wt of Vt){const{options:zt,container:En}=wt,Vn=En.nameInteraction;let ar=tT(zt);at&&(ar=ar.filter(lr=>at.includes(lr[0])));for(const lr of ar){const[Vr,ui]=lr,qi=Vn.get(Vr);if(qi&&((ft=qi.destroy)===null||ft===void 0||ft.call(qi)),ui){const Qr=kO(wt.view,Vr,ui,l)(wt,Vt,n.emitter);Vn.set(Vr,{destroy:Qr})}}}},pe=J(Z,se);for(const Ge of pe){const{options:at}=Ge,st=new Map;Ge.container.nameInteraction=st;for(const ft of tT(at)){const[Vt,wt]=ft;if(wt){const En=kO(Ge.view,Vt,wt,l)(Ge,pe,n.emitter);st.set(Vt,{destroy:En})}}}se();const{width:Ce,height:Ue}=e,Je=[];for(const Ge of U){const at=new Promise(st=>Fv(this,void 0,void 0,function*(){for(const ft of Ge){const Vt=Object.assign({width:Ce,height:Ue},ft);yield FO(Vt,t,n)}st()}));Je.push(at)}n.views=R,(r=n.animations)===null||r===void 0||r.forEach(Ge=>Ge==null?void 0:Ge.cancel()),n.animations=$,n.emitter.emit(El.AFTER_PAINT);const lt=$.filter(Ql).map(FU).map(Ge=>Ge.finished);return Promise.all([...lt,...Je])})}function w5(e){e.style("transform",t=>`translate(${t.layout.x}, ${t.layout.y})`)}function xU(e){const[,t]=Hc("interaction",e);return n=>{const[r,i]=n;try{return[r,t(r)]}catch(s){return[r,i.type]}}}function EU(e,t,n){const{library:r}=n,i=xU(r),s=h=>h[1]&&h[1].props&&h[1].props.reapplyWhenUpdate,u=tT(t).map(i).filter(s).map(h=>h[0]);return(h,p,m)=>Fv(this,void 0,void 0,function*(){const y=[],[b,w]=yield A5(h,n);zO(b,e,y,n);for(const R of u.filter(M=>M!==p))SU(R,e,h,b,n);for(const R of w)FO(R,e,n);return m(),{options:h,view:b}})}function SU(e,t,n,r,i){var s;const{library:l}=i,[u]=Hc("interaction",l),p=t.node().nameInteraction,m=tT(n).find(([M])=>M===e),y=p.get(e);if(!y||((s=y.destroy)===null||s===void 0||s.call(y),!m[1]))return;const b=kO(r,e,m[1],u),w={options:n,view:r,container:t.node(),update:M=>Promise.resolve(M)},R=b(w,[],i.emitter);p.set(e,{destroy:R})}function A5(e,t){return Fv(this,void 0,void 0,function*(){const{library:n}=t,r=yield wU(e,t),i=TU(r);e.interaction=i.interaction,e.coordinate=i.coordinate,e.marks=[...i.marks,...i.components];const s=dI(i,n),l=yield C5(s,t);return O5(l,s,n)})}function TU(e){const{coordinate:t={},interaction:n={},style:r={},marks:i}=e,s=Vg(e,["coordinate","interaction","style","marks"]),l=i.map(b=>b.coordinate||{}),u=i.map(b=>b.interaction||{}),h=i.map(b=>b.viewStyle||{}),p=[...l,t].reduceRight((b,w)=>ni(b,w),{}),m=[n,...u].reduce((b,w)=>ni(b,w),{}),y=[...h,r].reduce((b,w)=>ni(b,w),{});return Object.assign(Object.assign({},s),{marks:i,coordinate:p,interaction:m,style:y})}function wU(e,t){return Fv(this,void 0,void 0,function*(){const{library:n}=t,[r,i]=Hc("mark",n),s=new Set(Object.keys(n).map(w=>{var R;return(R=/component\.(.*)/.exec(w))===null||R===void 0?void 0:R[1]}).filter(Ql)),{marks:l}=e,u=[],h=[],p=[...l],{width:m,height:y}=jz(e),b={options:e,width:m,height:y};for(;p.length;){const[w]=p.splice(0,1),R=yield I5(w,t),{type:M=mg("G2Mark type is required."),key:I}=R;if(s.has(M))h.push(R);else{const{props:N={}}=i(M),{composite:U=!0}=N;if(!U)u.push(R);else{const{data:Z}=R,Y=Object.assign(Object.assign({},R),{data:Z&&(Array.isArray(Z)?Z:Z.value)}),$=yield r(Y,b),J=Array.isArray($)?$:[$];p.unshift(...J.map((se,pe)=>Object.assign(Object.assign({},se),{key:`${I}-${pe}`})))}}}return Object.assign(Object.assign({},e),{marks:u,components:h})})}function C5(e,t){return Fv(this,void 0,void 0,function*(){const{library:n}=t,[r]=Hc("theme",n),[,i]=Hc("mark",n),{theme:s,marks:l,coordinates:u=[]}=e,h=r(P5(s)),p=new Map;for(const y of l){const{type:b}=y,{props:w={}}=i(b),R=yield gU(y,w,t);if(R){const[M,I]=R;p.set(M,I)}}const m=vc(Array.from(p.values()).flatMap(y=>y.channels),({scaleKey:y})=>y);for(const y of m.values()){const b=y.reduce((Y,{scale:$})=>ni(Y,$),{}),{scaleKey:w}=y[0],{values:R}=y[0],M=Array.from(new Set(R.map(Y=>Y.field).filter(Ql))),I=ni({guide:{title:M.length===0?void 0:M},field:M[0]},b),{name:N}=y[0],U=y.flatMap(({values:Y})=>Y.map($=>$.value)),Z=Object.assign(Object.assign({},k9(N,U,I,u,h,n)),{uid:Symbol("scale"),key:w});y.forEach(Y=>Y.scale=Z)}return p})}function kO(e,t,n,r){const i=e.theme,s=typeof t=="string"?i[t]||{}:{};return r(ni(s,Object.assign({type:t},n)))}function O5(e,t,n){var r;const[i]=Hc("mark",n),[s]=Hc("theme",n),[l]=Hc("labelTransform",n),{key:u,frame:h=!1,theme:p,clip:m,style:y={},labelTransform:b=[]}=t,w=s(P5(p)),R=Array.from(e.values()),M=j9(R,t),I=yz(gz(jU(Array.from(M),R,e),t,n)),N=Uz(I,t,w,n),U=p7(N,t,n),Z=h?ni({mainLineWidth:1,mainStroke:"#000"},y):y;Hz(g5(I),U,N),zz(I);const Y=new Map(Array.from(e.values()).flatMap(pe=>{const{channels:Ce}=pe;return Ce.map(({scale:Ue})=>[Ue.uid,s5(Ue,n)])}));U9(e,Y);const $={};for(const pe of I){const{scales:Ce=[]}=pe,Ue=[];for(const Je of Ce){const{name:lt,uid:Ge}=Je,at=(r=Y.get(Ge))!==null&&r!==void 0?r:s5(Je,n);Ue.push(at),lt==="y"&&at.update(Object.assign(Object.assign({},at.getOptions()),{xScale:$.x})),a5($,{[lt]:at})}pe.scaleInstances=Ue}const J=[];for(const[pe,Ce]of e.entries()){const{children:Ue,dataDomain:Je,modifier:lt,key:Ge}=pe,{index:at,channels:st,tooltip:ft}=Ce,Vt=Object.fromEntries(st.map(({name:Qi,scale:Zi})=>[Qi,Zi])),wt=_0(Vt,({uid:Qi})=>Y.get(Qi));a5($,wt);const zt=z9(st,wt),En=i(pe),[Vn,ar,lr]=OU(En(at,wt,zt,U)),Vr=Je||Vn.length,ui=lt?lt(ar,Vr,N):[],qi=Qi=>{var Zi,Eo;return(Eo=(Zi=ft.title)===null||Zi===void 0?void 0:Zi[Qi])===null||Eo===void 0?void 0:Eo.value},Jr=Qi=>ft.items.map(Zi=>Zi[Qi]),Qr=Vn.map((Qi,Zi)=>{const Eo=Object.assign({points:ar[Zi],transform:ui[Zi],index:Qi,markKey:Ge,viewKey:u},ft&&{title:qi(Qi),items:Jr(Qi)});for(const[Go,oa]of Object.entries(zt))Eo[Go]=oa[Qi],lr&&(Eo[`series${Sv(Go)}`]=lr[Zi].map(Ca=>oa[Ca]));return lr&&(Eo.seriesIndex=lr[Zi]),lr&&ft&&(Eo.seriesItems=lr[Zi].map(Go=>Jr(Go)),Eo.seriesTitle=lr[Zi].map(Go=>qi(Go))),Eo});Ce.data=Qr,Ce.index=Vn;const Mo=Ue==null?void 0:Ue(Qr,wt,N);J.push(...Mo||[])}return[{layout:N,theme:w,coordinate:U,markState:e,key:u,clip:m,scale:$,style:Z,components:I,labelTransform:Cy(b.map(l))},J]}function zO(e,t,n,r){return Fv(this,void 0,void 0,function*(){const{library:i}=r,{components:s,theme:l,layout:u,markState:h,coordinate:p,key:m,style:y,clip:b,scale:w}=e,{x:R,y:M,width:I,height:N}=u,U=Vg(u,["x","y","width","height"]),Z=["view","plot","main","content"],Y=Z.map((wt,zt)=>zt),$=["a","margin","padding","inset"],J=Z.map(wt=>rE(Object.assign({},l.view,y),wt)),se=$.map(wt=>po(U,wt)),pe=wt=>wt.style("x",zt=>Ge[zt].x).style("y",zt=>Ge[zt].y).style("width",zt=>Ge[zt].width).style("height",zt=>Ge[zt].height).each(function(zt,En,Vn){VU(Pa(Vn),J[zt])});let Ce=0,Ue=0,Je=I,lt=N;const Ge=Y.map(wt=>{const zt=se[wt],{left:En=0,top:Vn=0,bottom:ar=0,right:lr=0}=zt;return Ce+=En,Ue+=Vn,Je-=En+lr,lt-=Vn+ar,{x:Ce,y:Ue,width:Je,height:lt}});t.selectAll(Ym(j)).data(Y.filter(wt=>Ql(J[wt])),wt=>Z[wt]).join(wt=>wt.append("rect").attr("className",j).style("zIndex",-2).call(pe),wt=>wt.call(pe),wt=>wt.remove());const at=IU(h),st=at?{duration:at[1]}:!1;for(const[,wt]of Z1(s,zt=>`${zt.type}-${zt.position}`))wt.forEach((zt,En)=>zt.index=En);const ft=t.selectAll(Ym(qe)).data(s,wt=>`${wt.type}-${wt.position}-${wt.index}`).join(wt=>wt.append("g").style("zIndex",({zIndex:zt})=>zt||-1).attr("className",qe).append(zt=>v5(ni({animate:st,scale:w},zt),p,l,i,h)),wt=>wt.transition(function(zt,En,Vn){const{preserve:ar=!1}=zt;if(ar)return;const lr=v5(ni({animate:st,scale:w},zt),p,l,i,h),{attributes:Vr}=lr,[ui]=Vn.childNodes;return ui.update(Vr,!1)})).transitions();n.push(...ft.flat().filter(Ql));const Vt=t.selectAll(Ym(Ie)).data([u],()=>m).join(wt=>wt.append("rect").style("zIndex",0).style("fill","transparent").attr("className",Ie).call(L5).call(N5,Array.from(h.keys())).call(B5,b),wt=>wt.call(N5,Array.from(h.keys())).call(zt=>at?UU(zt,at):L5(zt)).call(B5,b)).transitions();n.push(...Vt.flat());for(const[wt,zt]of h.entries()){const{data:En}=zt,{key:Vn,class:ar,type:lr}=wt,Vr=t.select(`#${Vn}`),ui=NU(wt,zt,e,r),qi=BU(wt,zt,e,i),Jr=kU(wt,zt,e,i),Qr=zU(wt,zt,e,i),Mo=LU(t,Vr,ar,"element"),Qi=Vr.selectAll(Ym(Ut)).selectFacetAll(Mo).data(En,Zi=>Zi.key,Zi=>Zi.groupKey).join(Zi=>Zi.append(ui).attr("className",Ut).attr("markType",lr).transition(function(Eo,Go,oa){return qi(Eo,[oa])}),Zi=>Zi.call(Eo=>{const Go=Eo.parent(),oa=iA(Ca=>{const[Vs,Sa]=Ca.getBounds().min;return[Vs,Sa]});Eo.transition(function(Ca,Vs,Sa){DU(Sa,Go,oa);const us=ui(Ca,Vs),wl=Jr(Ca,[Sa],[us]);return wl!==null||(Sa.nodeName===us.nodeName&&us.nodeName!=="g"?Pb(Sa,us):(Sa.parentNode.replaceChild(us,Sa),us.className=Ut,us.markType=lr,us.__data__=Sa.__data__)),wl}).attr("markType",lr).attr("className",Ut)}),Zi=>Zi.each(function(Eo,Go,oa){oa.__removed__=!0}).transition(function(Eo,Go,oa){return Qr(Eo,[oa])}).remove(),Zi=>Zi.append(ui).attr("className",Ut).attr("markType",lr).transition(function(Eo,Go,oa){const{__fromElements__:Ca}=oa,Vs=Jr(Eo,Ca,[oa]);return new Su(Ca,null,oa.parentNode).transition(Vs).remove(),Vs}),Zi=>Zi.transition(function(Eo,Go,oa){const Vs=new Su([],oa.__toData__,oa.parentNode).append(ui).attr("className",Ut).attr("markType",lr).nodes();return Jr(Eo,[oa],Vs)}).remove()).transitions();n.push(...Qi.flat())}AU(e,t,n,i,r)})}function AU(e,t,n,r,i){const[s]=Hc("labelTransform",r),{markState:l,labelTransform:u}=e,h=t.select(Ym(an)).node(),p=new Map,m=new Map,y=Array.from(l.entries()).flatMap(([I,N])=>{const{labels:U=[],key:Z}=I,Y=PU(I,N,e,r,i),$=t.select(`#${Z}`).selectAll(Ym(Ut)).nodes().filter(J=>!J.__removed__);return U.flatMap((J,se)=>{const{transform:pe=[]}=J,Ce=Vg(J,["transform"]);return $.flatMap(Ue=>{const Je=CU(Ce,se,Ue);return Je.forEach(lt=>{p.set(lt,Y),m.set(lt,J)}),Je})})}),b=Pa(h).selectAll(Ym(Bt)).data(y,I=>I.key).join(I=>I.append(N=>p.get(N)(N)).attr("className",Bt),I=>I.each(function(N,U,Z){const $=p.get(N)(N);Pb(Z,$)}),I=>I.remove()).nodes(),w=vc(b,I=>m.get(I.__data__)),{coordinate:R}=e,M={canvas:i.canvas,coordinate:R};for(const[I,N]of w){const{transform:U=[]}=I;Cy(U.map(s))(N,M)}u&&u(b,M)}function CU(e,t,n){const{seriesIndex:r,seriesKey:i,points:s,key:l,index:u}=n.__data__,h=MU(n);if(!r)return[Object.assign(Object.assign({},e),{key:`${l}-${t}`,bounds:h,index:u,points:s,dependentElement:n})];const p=RU(e),m=r.map((y,b)=>Object.assign(Object.assign({},e),{key:`${i[b]}-${t}`,bounds:[s[b]],index:y,points:s,dependentElement:n}));return p?p(m):m}function OU([e,t,n]){if(n)return[e,t,n];const r=[],i=[];for(let s=0;s<e.length;s++){const l=e[s],u=t[s];u.every(([h,p])=>Ql(h)&&Ql(p))&&(r.push(l),i.push(u))}return[r,i]}function RU(e){const{selector:t}=e;if(!t)return null;if(typeof t=="function")return t;if(t==="first")return n=>[n[0]];if(t==="last")return n=>[n[n.length-1]];throw new Error(`Unknown selector: ${t}`)}function MU(e){const t=e.cloneNode(),n=e.getAnimations();t.style.visibility="hidden",n.forEach(l=>{const u=l.effect.getKeyframes();t.attr(u[u.length-1])}),e.parentNode.appendChild(t);const r=t.getLocalBounds();t.destroy();const{min:i,max:s}=r;return[i,s]}function PU(e,t,n,r,i){const[s]=Hc("shape",r),{data:l,encode:u}=e,{data:h,defaultLabelShape:p}=t,m=h.map(M=>M.points),y=_0(u,M=>M.value),{theme:b,coordinate:w}=n,R=Object.assign(Object.assign({},i),{document:fI(i),theme:b,coordinate:w});return M=>{const{index:I,points:N}=M,U=l[I],{formatter:Z=Vt=>`${Vt}`,transform:Y,style:$,render:J}=M,se=Vg(M,["formatter","transform","style","render"]),pe=_0(Object.assign(Object.assign({},se),$),Vt=>R5(Vt,U,I,l,{channel:y})),{shape:Ce=p,text:Ue}=pe,Je=Vg(pe,["shape","text"]),lt=typeof Z=="string"?Lm(Z):Z,Ge=Object.assign(Object.assign({},Je),{text:lt(Ue,U,I,l),datum:U}),at=Object.assign({type:`label.${Ce}`,render:J},Je),st=s(at,R),ft=M5(b,"label",Ce,"label");return st(N,Ge,ft,m)}}function R5(e,t,n,r,i){return typeof e=="function"?e(t,n,r,i):typeof e!="string"?e:vg(t)&&t[e]!==void 0?t[e]:e}function IU(e){let t=-1/0,n=1/0;for(const[r,i]of e){const{animate:s={}}=r,{data:l}=i,{enter:u={},update:h={},exit:p={}}=s,{type:m,duration:y=300,delay:b=0}=h,{type:w,duration:R=300,delay:M=0}=u,{type:I,duration:N=300,delay:U=0}=p;for(const Z of l){const{updateType:Y=m,updateDuration:$=y,updateDelay:J=b,enterType:se=w,enterDuration:pe=R,enterDelay:Ce=M,exitDuration:Ue=N,exitDelay:Je=U,exitType:lt=I}=Z;(Y===void 0||Y)&&(t=Math.max(t,$+J),n=Math.min(n,J)),(lt===void 0||lt)&&(t=Math.max(t,Ue+Je),n=Math.min(n,Je)),(se===void 0||se)&&(t=Math.max(t,pe+Ce),n=Math.min(n,Ce))}}return t===-1/0?null:[n,t-n]}function LU(e,t,n,r){return e.node().parentElement.findAll(s=>s.style.facet!==void 0&&s.style.facet===n&&s!==t.node()).flatMap(s=>s.getElementsByClassName(r))}function DU(e,t,n){if(!e.__facet__)return;const r=e.parentNode.parentNode,i=t.parentNode,[s,l]=n(r),[u,h]=n(i),p=`translate(${s-u}, ${l-h})`;oA(e,p),t.append(e)}function NU(e,t,n,r){const{library:i}=r,[s]=Hc("shape",i),{data:l,encode:u}=e,{defaultShape:h,data:p,shape:m}=t,y=_0(u,U=>U.value),b=p.map(U=>U.points),{theme:w,coordinate:R}=n,{type:M,style:I={}}=e,N=Object.assign(Object.assign({},r),{document:fI(r),coordinate:R,theme:w});return U=>{const{shape:Z=h}=I,{shape:Y=Z,points:$,seriesIndex:J,index:se}=U,pe=Vg(U,["shape","points","seriesIndex","index"]),Ce=Object.assign(Object.assign({},pe),{index:se}),Ue=J?J.map(st=>l[st]):l[se],Je=J||se,lt=_0(I,st=>R5(st,Ue,Je,l,{channel:y})),Ge=m[Y]?m[Y](lt,N):s(Object.assign(Object.assign({},lt),{type:D5(e,Y)}),N),at=M5(w,M,Y,h);return Ge($,Ce,at,b)}}function M5(e,t,n,r){if(typeof t!="string")return;const{color:i}=e,s=e[t]||{},l=s[n]||s[r];return Object.assign({color:i},l)}function UO(e,t,n,r,i){var s,l;const[,u]=Hc("shape",i),[h]=Hc("animation",i),{defaultShape:p,shape:m}=n,{theme:y,coordinate:b}=r,R=`default${Sv(e)}Animation`,{[R]:M}=((s=m[p])===null||s===void 0?void 0:s.props)||u(D5(t,p)).props,{[e]:I={}}=y,N=((l=t.animate)===null||l===void 0?void 0:l[e])||{},U={coordinate:b};return(Z,Y,$)=>{const{[`${e}Type`]:J,[`${e}Delay`]:se,[`${e}Duration`]:pe,[`${e}Easing`]:Ce}=Z,Ue=Object.assign({type:J||M},N);if(!Ue.type)return null;const Ge=h(Ue,U)(Y,$,ni(I,{delay:se,duration:pe,easing:Ce}));return Array.isArray(Ge)?Ge:[Ge]}}function BU(e,t,n,r){return UO("enter",e,t,n,r)}function FU(e){return e.finished.then(()=>{e.cancel()}),e}function kU(e,t,n,r){return UO("update",e,t,n,r)}function zU(e,t,n,r){return UO("exit",e,t,n,r)}function P5(e={}){if(typeof e=="string")return{type:e};const{type:t="light"}=e,n=Vg(e,["type"]);return Object.assign(Object.assign({},n),{type:t})}function tT(e){const t={event:!0,tooltip:!0,sliderFilter:!0,legendFilter:!0,scrollbarFilter:!0},{interaction:n={}}=e;return Object.entries(ni(t,n)).reverse()}function I5(e,t){return Fv(this,void 0,void 0,function*(){const{data:n}=e,r=Vg(e,["data"]);if(n==null)return e;const[,{data:i}]=yield S5([],{data:n},t);return Object.assign({data:i},r)})}function L5(e){e.style("transform",t=>`translate(${t.paddingLeft+t.marginLeft}, ${t.paddingTop+t.marginTop})`).style("width",t=>t.innerWidth).style("height",t=>t.innerHeight)}function UU(e,t){const[n,r]=t;e.transition(function(i,s,l){const{transform:u,width:h,height:p}=l.style,{paddingLeft:m,paddingTop:y,innerWidth:b,innerHeight:w,marginLeft:R,marginTop:M}=i,I=[{transform:u,width:h,height:p},{transform:`translate(${m+R}, ${y+M})`,width:b,height:w}];return l.animate(I,{delay:n,duration:r,fill:"both"})})}function D5(e,t){const{type:n}=e;return typeof t=="string"?`${n}.${t}`:t}function N5(e,t){const n=s=>s.class!==void 0?`${s.class}`:"";e.nodes().length===0||(e.selectAll(Ym(tr)).data(t,s=>s.key).join(s=>s.append("g").attr("className",tr).attr("id",l=>l.key).style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),s=>s.style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),s=>s.remove()),e.select(Ym(an)).node())||e.append("g").attr("className",an).style("zIndex",0)}function Ym(...e){return e.map(t=>`.${t}`).join("")}function B5(e,t){e.node()&&e.style("clipPath",n=>{if(!t)return null;const{paddingTop:r,paddingLeft:i,marginLeft:s,marginTop:l,innerWidth:u,innerHeight:h}=n;return new yo({style:{x:i+s,y:r+l,width:u,height:h}})})}function jU(e,t,n){var r;for(const[p]of n.entries())if(p.type==="cell")return e.filter(m=>m.name!=="shape");if(t.length!==1||e.some(p=>p.name==="shape"))return e;const{defaultShape:i}=t[0];if(!["point","line","rect","hollow"].includes(i))return e;const l={point:"point",line:"hyphen",rect:"square",hollow:"hollow"},h={field:((r=e.find(p=>p.name==="color"))===null||r===void 0?void 0:r.field)||null,name:"shape",type:"constant",domain:[],range:[l[i]]};return[...e,h]}function VU(e,t){for(const[n,r]of Object.entries(t))e.style(n,r)}function F5(e){const t=ni({},e),n=new Map([[t,null]]),r=new Map([[null,-1]]),i=[t];for(;i.length;){const s=i.shift();if(s.key===void 0){const u=n.get(s),h=r.get(s),p=u===null?"0":`${u.key}-${h}`;s.key=p}const{children:l=[]}=s;if(Array.isArray(l))for(let u=0;u<l.length;u++){const h=ni({},l[u]);l[u]=h,n.set(h,s),r.set(h,u),i.push(h)}}return t}function HU(e,t){const n=new K2;return n.registerPlugin(new q2),new zs({width:e,height:t,container:document.createElement("div"),renderer:n})}function ZU(e,t={},n=()=>{},r=i=>{throw i}){const{width:i=640,height:s=480,depth:l=0}=e,u=F5(e),{canvas:h=HU(i,s),emitter:p=new _n,library:m}=t;t.canvas=h,t.emitter=p;const{width:y,height:b}=h.getConfig();(y!==i||b!==s)&&h.resize(i,s),p.emit(El.BEFORE_RENDER);const w=Pa(h.document.documentElement);return h.ready.then(()=>FO(Object.assign(Object.assign({},u),{width:i,height:s,depth:l}),w,t)).then(()=>{if(l){const[R,M]=h.document.documentElement.getPosition();h.document.documentElement.setPosition(R,M,-l/2)}h.requestAnimationFrame(()=>{p.emit(El.AFTER_RENDER),n==null||n()})}).catch(R=>{r==null||r(R)}),GU(h.getConfig().container)}function Ate(e,t={},n=()=>{},r=i=>{throw i}){var i;const{width:s=640,height:l=480}=e,u=F5(e),{group:h=new Group,emitter:p=new EventEmitter,library:m}=t;h!=null&&h.parentElement||error("renderToMountedElement can't render chart to unmounted group.");const y=select(h);return t.group=h,t.emitter=p,t.canvas=t.canvas||((i=h==null?void 0:h.ownerDocument)===null||i===void 0?void 0:i.defaultView),p.emit(ChartEvent.BEFORE_RENDER),plot(Object.assign(Object.assign({},u),{width:s,height:l}),y,t).then(()=>{var b;(b=t.canvas)===null||b===void 0||b.requestAnimationFrame(()=>{p.emit(ChartEvent.AFTER_RENDER),n==null||n()})}).catch(b=>{r==null||r(b)}),h}function k5(e,t={},n=!1){const{canvas:r,emitter:i}=t;r&&(WU(r),n?r.destroy():r.destroyChildren()),i.off()}function WU(e){const t=e.getRoot().querySelectorAll(`.${Dt}`);t==null||t.forEach(n=>{const{nameInteraction:r=new Map}=n;(r==null?void 0:r.size)>0&&Array.from(r==null?void 0:r.values()).forEach(i=>{i==null||i.destroy()})})}function GU(e){return typeof e=="string"?document.getElementById(e):e}const B_=e=>e?parseInt(e):0;function XU(e){const t=getComputedStyle(e),n=e.clientWidth||B_(t.width),r=e.clientHeight||B_(t.height),i=B_(t.paddingLeft)+B_(t.paddingRight),s=B_(t.paddingTop)+B_(t.paddingBottom);return{width:n-i,height:r-s}}function Cte(e){const{height:t,width:n,padding:r=0,paddingLeft:i=r,paddingRight:s=r,paddingTop:l=r,paddingBottom:u=r,margin:h=0,marginLeft:p=h,marginRight:m=h,marginTop:y=h,marginBottom:b=h,inset:w=0,insetLeft:R=w,insetRight:M=w,insetTop:I=w,insetBottom:N=w}=e,U=$=>$==="auto"?20:$,Z=n-U(i)-U(s)-p-m-R-M,Y=t-U(l)-U(u)-y-b-I-N;return{width:Z,height:Y}}function jO(e,t){const n=[e];for(;n.length;){const r=n.shift();t&&t(r);const i=r.children||[];for(const s of i)n.push(s)}}class VO{constructor(t={},n){this.parentNode=null,this.children=[],this.index=0,this.type=n,this.value=t}map(t=n=>n){const n=t(this.value);return this.value=n,this}attr(t,n){return arguments.length===1?this.value[t]:this.map(r=>(r[t]=n,r))}append(t){const n=new t({});return n.children=[],this.push(n),n}push(t){return t.parentNode=this,t.index=this.children.length,this.children.push(t),this}remove(){const t=this.parentNode;if(t){const{children:n}=t,r=n.findIndex(i=>i===this);n.splice(r,1)}return this}getNodeByKey(t){let n=null;return jO(this,i=>{t===i.attr("key")&&(n=i)}),n}getNodesByType(t){const n=[];return jO(this,i=>{t===i.type&&n.push(i)}),n}getNodeByType(t){let n=null;return jO(this,r=>{n||t===r.type&&(n=r)}),n}call(t,...n){return t(this.map(),...n),this}getRoot(){let t=this;for(;t&&t.parentNode;)t=t.parentNode;return t}}var z5=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const HO=["width","height","depth","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","inset","insetLeft","insetRight","insetTop","insetBottom","margin","marginLeft","marginRight","marginTop","marginBottom","autoFit","theme","title"],U5="__remove__",j5="__callback__",V5=1,H5=1;function YU(e){if(e===void 0){const t=document.createElement("div");return t[U5]=!0,t}return typeof e=="string"?document.getElementById(e):e}function $U(e){const t=e.parentNode;t&&t.removeChild(e)}function KU(e){if(e.type!==null)return e;const t=e.children[e.children.length-1];for(const n of HO)t.attr(n,e.attr(n));return t}function Z5(e){return Object.assign(Object.assign({},e.value),{type:e.type})}function ZO(e,t){const{width:n,height:r,autoFit:i,depth:s=0}=e;let l=640,u=480;if(i){const{width:h,height:p}=XU(t);l=h||l,u=p||u}return l=n||l,u=r||u,{width:Math.max((0,Ft.Z)(l)?l:V5,V5),height:Math.max((0,Ft.Z)(u)?u:H5,H5),depth:s}}function qU(e){const t=KU(e),n=[t],r=new Map;for(r.set(t,Z5(t));n.length;){const i=n.pop(),s=r.get(i),{children:l=[]}=i;for(const u of l)if(u.type===j5)s.children=u.value;else{const h=Z5(u),{children:p=[]}=s;p.push(h),n.push(u),r.set(u,h),s.children=p}}return r.get(t)}function QU(e,t){return typeof e=="function"?!0:new Set(Object.keys(t)).has(e)}function JU(e,t){return typeof e!="function"&&new Set(Object.keys(t)).has(e)}function ej(e,t,n,r,i){const{type:s}=e,{type:l=n||s}=t;if(JU(l,i)){for(const u of HO)e.attr(u)!==void 0&&t[u]===void 0&&(t[u]=e.attr(u));return t}if(QU(l,r)){const u={type:"view"},h=Object.assign({},t);for(const p of HO)h[p]!==void 0&&(u[p]=h[p],delete h[p]);return Object.assign(Object.assign({},u),{children:[h]})}return t}function tj(e,t,n){if(typeof e=="function")return t.mark;const i=Object.assign(Object.assign({},t),n)[e];if(!i)throw new Error(`Unknown mark: ${e}.`);return i}function nj(e,t,n){if(typeof e=="function"){const h=new VO;return h.value=e,h.type=j5,h}const{type:r,children:i}=e,s=z5(e,["type","children"]),l=tj(r,t,n),u=new l;return u.value=s,u.type=r,u}function rj(e,t){const{type:n,children:r}=t,i=z5(t,["type","children"]);e.type===n||n===void 0?oE(e.value,i):typeof n=="string"&&(e.type=n,e.value=i)}function ij(e,t,n,r){if(!e)return;const i=[[e,t]];for(;i.length;){const[s,l]=i.shift(),u=nj(l,n,r);Array.isArray(s.children)&&s.push(u);const{children:h}=l;if(Array.isArray(h))for(const p of h)i.push([u,p]);else typeof h=="function"&&i.push([u,h])}}function oj(e,t,n,r,i){const s=ej(e,t,n,r,i),l=[[null,e,s]];for(;l.length;){const[u,h,p]=l.shift();if(!h)ij(u,p,r,i);else if(!p)h.remove();else{rj(h,p);const{children:m}=p,{children:y}=h;if(Array.isArray(m)&&Array.isArray(y)){const b=Math.max(m.length,y.length);for(let w=0;w<b;w++){const R=m[w],M=y[w];l.push([h,M,R])}}else typeof m=="function"&&l.push([h,null,m])}}}function aj(){let e,t;return[new Promise((r,i)=>{t=r,e=i}),t,e]}function sj(e,t,{key:n=t}){e.prototype[t]=function(r){return arguments.length===0?this.attr(n):this.attr(n,r)}}function lj(e,t,{key:n=t}){e.prototype[t]=function(r){if(arguments.length===0)return this.attr(n);if(Array.isArray(r))return this.attr(n,r);const i=[...this.attr(n)||[],r];return this.attr(n,i)}}function cj(e,t,{key:n=t}){e.prototype[t]=function(r,i){if(arguments.length===0)return this.attr(n);if(arguments.length===1&&typeof r!="string")return this.attr(n,r);const s=this.attr(n)||{};return s[r]=arguments.length===1?!0:i,this.attr(n,s)}}function uj(e,t,n){e.prototype[t]=function(r){if(arguments.length===0)return this.attr(t);if(Array.isArray(r))return this.attr(t,{items:r});if(vg(r)&&(r.title!==void 0||r.items!==void 0))return this.attr(t,r);if(r===null||r===!1)return this.attr(t,r);const i=this.attr(t)||{},{items:s=[]}=i;return s.push(r),i.items=s,this.attr(t,i)}}function fj(e,t,{ctor:n}){e.prototype[t]=function(r){const i=this.append(n);return t==="mark"&&(i.type=r),i}}function hj(e,t,{ctor:n}){e.prototype[t]=function(){return this.type=null,this.append(n)}}function nT(e){return t=>{for(const[n,r]of Object.entries(e)){const{type:i}=r;i==="value"?sj(t,n,r):i==="array"?lj(t,n,r):i==="object"?cj(t,n,r):i==="node"?fj(t,n,r):i==="container"?hj(t,n,r):i==="mix"&&uj(t,n,r)}return t}}function W5(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,{type:"node",ctor:n}]))}const G5={encode:{type:"object"},scale:{type:"object"},data:{type:"value"},transform:{type:"array"},style:{type:"object"},animate:{type:"object"},coordinate:{type:"object"},interaction:{type:"object"},label:{type:"array",key:"labels"},axis:{type:"object"},legend:{type:"object"},slider:{type:"object"},scrollbar:{type:"object"},state:{type:"object"},layout:{type:"object"},theme:{type:"object"},title:{type:"value"}},dj=Object.assign(Object.assign({},G5),{tooltip:{type:"mix"},viewStyle:{type:"object"}}),pj=Object.assign(Object.assign({},G5),{labelTransform:{type:"array"}});var mj=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let rT=class extends VO{changeData(t){var n;const r=this.getRoot();if(r)return this.attr("data",t),!((n=this.children)===null||n===void 0)&&n.length&&this.children.forEach(i=>{i.attr("data",t)}),r==null?void 0:r.render()}getView(){const t=this.getRoot(),{views:n}=t.getContext();if(n!=null&&n.length)return n.find(r=>r.key===this._key)}getScale(){var t;return(t=this.getView())===null||t===void 0?void 0:t.scale}getScaleByChannel(t){const n=this.getScale();if(n)return n[t]}getCoordinate(){var t;return(t=this.getView())===null||t===void 0?void 0:t.coordinate}getTheme(){var t;return(t=this.getView())===null||t===void 0?void 0:t.theme}getGroup(){const t=this._key;return t?this.getRoot().getContext().canvas.getRoot().getElementById(t):void 0}show(){const t=this.getGroup();t&&!t.isVisible()&&kS(t)}hide(){const t=this.getGroup();t&&t.isVisible()&&xO(t)}};rT=mj([nT(pj)],rT);var vj=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let WO=class extends VO{changeData(t){const n=this.getRoot();if(n)return this.attr("data",t),n==null?void 0:n.render()}getMark(){var t;const n=(t=this.getRoot())===null||t===void 0?void 0:t.getView();if(!n)return;const{markState:r}=n,i=Array.from(r.keys()).find(s=>s.key===this.attr("key"));return r.get(i)}getScale(){var t;const n=(t=this.getRoot())===null||t===void 0?void 0:t.getView();if(n)return n==null?void 0:n.scale}getScaleByChannel(t){var n,r;const i=(n=this.getRoot())===null||n===void 0?void 0:n.getView();if(i)return(r=i==null?void 0:i.scale)===null||r===void 0?void 0:r[t]}getGroup(){const t=this.attr("key");return t?this.getRoot().getContext().canvas.getRoot().getElementById(t):void 0}};WO=vj([nT(dj)],WO);var gj=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},yj=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const _j="G2_CHART_KEY";class bj extends rT{constructor(t){const{container:n,canvas:r,renderer:i,plugins:s,lib:l,createCanvas:u}=t,h=yj(t,["container","canvas","renderer","plugins","lib","createCanvas"]);super(h,"view"),this._hasBindAutoFit=!1,this._rendering=!1,this._trailing=!1,this._trailingResolve=null,this._trailingReject=null,this._previousDefinedType=null,this._onResize=Q2(()=>{this.forceFit()},300),this._renderer=i||new K2,this._plugins=s||[],this._container=YU(n),this._emitter=new _n,this._context={library:Object.assign(Object.assign({},l),k1),emitter:this._emitter,canvas:r,createCanvas:u},this._create()}render(){if(this._rendering)return this._addToTrailing();this._context.canvas||this._createCanvas(),this._context.canvas.getConfig().supportsCSSTransform=!0,this._bindAutoFit(),this._rendering=!0;const t=new Promise((s,l)=>ZU(this._computedOptions(),this._context,this._createResolve(s),this._createReject(l))),[n,r,i]=aj();return t.then(r).catch(i).then(()=>this._renderTrailing()),n}options(t){if(arguments.length===0)return qU(this);const{type:n}=t;return n&&(this._previousDefinedType=n),oj(this,t,this._previousDefinedType,this._marks,this._compositions),this}getContainer(){return this._container}getContext(){return this._context}on(t,n,r){return this._emitter.on(t,n,r),this}once(t,n){return this._emitter.once(t,n),this}emit(t,...n){return this._emitter.emit(t,...n),this}off(t,n){return this._emitter.off(t,n),this}clear(){const t=this.options();this.emit(El.BEFORE_CLEAR),this._reset(),k5(t,this._context,!1),this.emit(El.AFTER_CLEAR)}destroy(){const t=this.options();this.emit(El.BEFORE_DESTROY),this._unbindAutoFit(),this._reset(),k5(t,this._context,!0),this._container[U5]&&$U(this._container),this.emit(El.AFTER_DESTROY)}forceFit(){this.options.autoFit=!0;const{width:t,height:n}=ZO(this.options(),this._container);if(t===this._width&&n===this._height)return Promise.resolve(this);this.emit(El.BEFORE_CHANGE_SIZE);const r=this.render();return r.then(()=>{this.emit(El.AFTER_CHANGE_SIZE)}),r}changeSize(t,n){if(t===this._width&&n===this._height)return Promise.resolve(this);this.emit(El.BEFORE_CHANGE_SIZE),this.attr("width",t),this.attr("height",n);const r=this.render();return r.then(()=>{this.emit(El.AFTER_CHANGE_SIZE)}),r}_create(){const{library:t}=this._context,n=s=>s.startsWith("mark.")||s==="component.axisX"||s==="component.axisY"||s==="component.legends",r=["mark.mark",...Object.keys(t).filter(n)];this._marks={};for(const s of r){const l=s.split(".").pop();class u extends WO{constructor(){super({},l)}}this._marks[l]=u,this[l]=function(h){const p=this.append(u);return l==="mark"&&(p.type=h),p}}const i=["composition.view",...Object.keys(t).filter(s=>s.startsWith("composition.")&&s!=="composition.mark")];this._compositions=Object.fromEntries(i.map(s=>{const l=s.split(".").pop();let u=class extends rT{constructor(){super({},l)}};return u=gj([nT(W5(this._marks))],u),[l,u]}));for(const s of Object.values(this._compositions))nT(W5(this._compositions))(s);for(const s of i){const l=s.split(".").pop();this[l]=function(){const u=this._compositions[l];return this.type=null,this.append(u)}}}_reset(){const t=["theme","type","width","height","autoFit"];this.type="view",this.value=Object.fromEntries(Object.entries(this.value).filter(([n])=>n.startsWith("margin")||n.startsWith("padding")||n.startsWith("inset")||t.includes(n))),this.children=[]}_renderTrailing(){this._trailing&&(this._trailing=!1,this.render().then(()=>{const t=this._trailingResolve.bind(this);this._trailingResolve=null,t(this)}).catch(t=>{const n=this._trailingReject.bind(this);this._trailingReject=null,n(t)}))}_createResolve(t){return()=>{this._rendering=!1,t(this)}}_createReject(t){return n=>{this._rendering=!1,t(n)}}_computedOptions(){const t=this.options(),{key:n=_j}=t,{width:r,height:i,depth:s}=ZO(t,this._container);return this._width=r,this._height=i,this._key=n,Object.assign(Object.assign({key:this._key},t),{width:r,height:i,depth:s})}_createCanvas(){const{width:t,height:n}=ZO(this.options(),this._container);this._plugins.push(new q2),this._plugins.forEach(r=>this._renderer.registerPlugin(r)),this._context.canvas=new zs({container:this._container,width:t,height:n,renderer:this._renderer})}_addToTrailing(){var t;return(t=this._trailingResolve)===null||t===void 0||t.call(this,this),this._trailing=!0,new Promise((r,i)=>{this._trailingResolve=r,this._trailingReject=i})}_bindAutoFit(){const t=this.options(),{autoFit:n}=t;if(this._hasBindAutoFit){n||this._unbindAutoFit();return}n&&(this._hasBindAutoFit=!0,window.addEventListener("resize",this._onResize))}_unbindAutoFit(){this._hasBindAutoFit&&(this._hasBindAutoFit=!1,window.removeEventListener("resize",this._onResize))}}function xj(e,t){class n extends e{constructor(i){super(Object.assign(Object.assign({},i),{lib:t}))}}return n}var Ej=Object.prototype.hasOwnProperty,GO=function(e,t){if(e===null||!y0(e))return{};var n={};return rx(t,function(r){Ej.call(e,r)&&(n[r]=e[r])}),n};function X5(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Nx(e,t,n,r,i){for(var s=e.children,l,u=-1,h=s.length,p=e.value&&(r-t)/e.value;++u<h;)l=s[u],l.y0=n,l.y1=i,l.x0=t,l.x1=t+=l.value*p}function Sj(){var e=1,t=1,n=0,r=!1;function i(l){var u=l.height+1;return l.x0=l.y0=n,l.x1=e,l.y1=t/u,l.eachBefore(s(t,u)),r&&l.eachBefore(X5),l}function s(l,u){return function(h){h.children&&Nx(h,h.x0,l*(h.depth+1)/u,h.x1,l*(h.depth+2)/u);var p=h.x0,m=h.y0,y=h.x1-n,b=h.y1-n;y<p&&(p=y=(p+y)/2),b<m&&(m=b=(m+b)/2),h.x0=p,h.y0=m,h.x1=y,h.y1=b}}return i.round=function(l){return arguments.length?(r=!!l,i):r},i.size=function(l){return arguments.length?(e=+l[0],t=+l[1],i):[e,t]},i.padding=function(l){return arguments.length?(n=+l,i):n},i}var Tj=D(9783);function wj(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Aj(){return this.eachAfter(wj)}var XO=D(64599);function Cj(e,t){var n=-1,r=XO(this),i;try{for(r.s();!(i=r.n()).done;){var s=i.value;e.call(t,s,++n,this)}}catch(l){r.e(l)}finally{r.f()}return this}function Oj(e,t){for(var n=this,r=[n],i,s,l=-1;n=r.pop();)if(e.call(t,n,++l,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function Rj(e,t){for(var n=this,r=[n],i=[],s,l,u,h=-1;n=r.pop();)if(i.push(n),s=n.children)for(l=0,u=s.length;l<u;++l)r.push(s[l]);for(;n=i.pop();)e.call(t,n,++h,this);return this}function Mj(e,t){var n=-1,r=XO(this),i;try{for(r.s();!(i=r.n()).done;){var s=i.value;if(e.call(t,s,++n,this))return s}}catch(l){r.e(l)}finally{r.f()}}function Pj(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Ij(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Lj(e){for(var t=this,n=Dj(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Dj(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Nj(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Bj(){return Array.from(this)}function Fj(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function kj(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}var Y5=D(15009),zj=Y5().mark($5);function $5(){var e,t,n,r,i,s;return Y5().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:e=this,n=[e];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){u.next=8;break}return u.next=5,e;case 5:if(r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);u.next=2;break;case 8:if(n.length){u.next=1;break}case 9:case"end":return u.stop()}},zj,this)}function F_(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Vj)):t===void 0&&(t=jj);for(var n=new k_(e),r,i=[n],s,l,u,h;r=i.pop();)if((l=t(r.data))&&(h=(l=Array.from(l)).length))for(r.children=l,u=h-1;u>=0;--u)i.push(s=l[u]=new k_(l[u])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(K5)}function Uj(){return F_(this).eachBefore(Hj)}function jj(e){return e.children}function Vj(e){return Array.isArray(e)?e[1]:null}function Hj(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function K5(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function k_(e){this.data=e,this.depth=this.height=0,this.parent=null}k_.prototype=F_.prototype=Tj({constructor:k_,count:Aj,each:Cj,eachAfter:Rj,eachBefore:Oj,find:Mj,sum:Pj,sort:Ij,path:Lj,ancestors:Nj,descendants:Bj,leaves:Fj,links:kj,copy:Uj},Symbol.iterator,$5);function YO(e,t){for(var n in t)t.hasOwnProperty(n)&&n!=="constructor"&&t[n]!==void 0&&(e[n]=t[n])}function Zj(e,t,n,r){return t&&YO(e,t),n&&YO(e,n),r&&YO(e,r),e}const Wj={field:"value",size:[1,1],round:!1,padding:0,sort:(e,t)=>t.value-e.value,as:["x","y"],ignoreParentValue:!0},Gj="nodeIndex",Bx="childNodeCount",Xj="nodeAncestor",$O="Invalid field: it must be a string!";function Yj(e,t){const{field:n,fields:r}=e;if(bi(n))return n;if(Is(n))return console.warn($O),n[0];if(console.warn(`${$O} will try to get fields instead.`),bi(r))return r;if(Is(r)&&r.length)return r[0];if(t)return t;throw new TypeError($O)}function $j(e){const t=[];if(e&&e.each){let n,r;e.each(i=>{var s,l;i.parent!==n?(n=i.parent,r=0):r+=1;const u=qP((((s=i.ancestors)===null||s===void 0?void 0:s.call(i))||[]).map(h=>t.find(p=>p.name===h.name)||h),({depth:h})=>h>0&&h<i.depth);i[Xj]=u,i[Bx]=((l=i.children)===null||l===void 0?void 0:l.length)||0,i[Gj]=r,t.push(i)})}else e&&e.eachNode&&e.eachNode(n=>{t.push(n)});return t}function Kj(e,t){t=Zj({},Wj,t);const n=t.as;if(!Is(n)||n.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');let r;try{r=Yj(t)}catch(h){console.warn(h)}const s=(h=>Sj().size(t.size).round(t.round).padding(t.padding)(F_(h).sum(p=>Lg(p.children)?t.ignoreParentValue?0:p[r]-eS(p.children,(m,y)=>m+y[r],0):p[r]).sort(t.sort)))(e),l=n[0],u=n[1];return s.each(h=>{var p,m;h[l]=[h.x0,h.x1,h.x1,h.x0],h[u]=[h.y1,h.y1,h.y0,h.y0],h.name=h.name||((p=h.data)===null||p===void 0?void 0:p.name)||((m=h.data)===null||m===void 0?void 0:m.label),h.data.name=h.name,["x0","x1","y0","y1"].forEach(y=>{n.indexOf(y)===-1&&delete h[y]})}),$j(s)}var qj=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const z_="sunburst",KO="markType",Ote="value",q5="path",iT="ancestor-node";function Qj(e){const{data:t,encode:n}=e,{color:r,value:i}=n,l=Kj(t,{field:i,type:"hierarchy.partition",as:["x","y"]}),u=[];return l.forEach(h=>{var p,m,y,b;if(h.depth===0)return null;let w=h.data.name;const R=[w];let M=Object.assign({},h);for(;M.depth>1;)w=`${(p=M.parent.data)===null||p===void 0?void 0:p.name} / ${w}`,R.unshift((m=M.parent.data)===null||m===void 0?void 0:m.name),M=M.parent;const I=Object.assign(Object.assign(Object.assign({},GO(h.data,[i])),{[q5]:w,[iT]:M.data.name}),h);r&&r!==iT&&(I[r]=h.data[r]||((b=(y=h.parent)===null||y===void 0?void 0:y.data)===null||b===void 0?void 0:b[r])),u.push(I)}),u.map(h=>{const p=h.x.slice(0,2),m=[h.y[2],h.y[0]];return p[0]===p[1]&&(m[0]=m[1]=(h.y[2]+h.y[0])/2),Object.assign(Object.assign({},h),{x:p,y:m,fillOpacity:Math.pow(.85,h.depth)})})}const Q5={id:z_,encode:{x:"x",y:"y",key:q5,color:iT,value:"value"},axis:{x:!1,y:!1},style:{[KO]:z_,stroke:"#fff",lineWidth:.5,fillOpacity:"fillOpacity",[Bx]:Bx,depth:"depth"},state:{active:{zIndex:2,stroke:"#000"},inactive:{zIndex:1,stroke:"#fff"}},legend:!1,interaction:{drillDown:!0},coordinate:{type:"polar",innerRadius:.2}},J5=e=>{const{encode:t,data:n=[],legend:r}=e,i=qj(e,["encode","data","legend"]),s=Object.assign(Object.assign({},i.coordinate),{innerRadius:Math.max(Bi(i,["coordinate","innerRadius"],.2),1e-5)}),l=Object.assign(Object.assign({},Q5.encode),t),{value:u}=l,h=Qj({encode:l,data:n});return console.log(h,"rectData"),[ni({},Q5,Object.assign(Object.assign({type:"rect",data:h,encode:l,tooltip:{title:"path",items:[p=>({name:u,value:p[u]})]}},i),{coordinate:s}))]};J5.props={};var Jj=Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];return rx(e,function(n,r){Ih(e)&&r==="prototype"||t.push(r)}),t},qO=Jj,eV=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const tV=e=>e.querySelectorAll(".element").filter(t=>Bi(t,["style",KO])===z_);function nV(e){return Pa(e).select(`.${Ie}`).node()}const rV={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.85)",fontSize:12,y:1},active:{fill:"rgba(0, 0, 0, 0.5)"}};function iV(e={}){const{breadCrumb:t={},isFixedColor:n=!1}=e,r=ni({},rV,t);return i=>{const{update:s,setState:l,container:u,view:h,options:p}=i,m=u.ownerDocument,y=nV(u),b=p.marks.find(({id:Z})=>Z===z_),{state:w}=b,R=m.createElement("g");y.appendChild(R);const M=(Z,Y)=>eV(this,void 0,void 0,function*(){if(R.removeChildren(),Z){const $=m.createElement("text",{style:Object.assign({x:0,text:r.rootText,depth:0},r.style)});R.appendChild($);let J="";const se=Z==null?void 0:Z.split(" / ");let pe=r.style.y,Ce=R.getBBox().width;const Ue=y.getBBox().width,Je=se.map((lt,Ge)=>{const at=m.createElement("text",{style:Object.assign(Object.assign({x:Ce,text:" / "},r.style),{y:pe})});R.appendChild(at),Ce+=at.getBBox().width,J=`${J}${lt} / `;const st=m.createElement("text",{name:J.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:lt,x:Ce,depth:Ge+1},r.style),{y:pe})});return R.appendChild(st),Ce+=st.getBBox().width,Ce>Ue&&(pe=R.getBBox().height,Ce=0,at.attr({x:Ce,y:pe}),Ce+=at.getBBox().width,st.attr({x:Ce,y:pe}),Ce+=st.getBBox().width),st});[$,...Je].forEach((lt,Ge)=>{if(Ge===Je.length)return;const at=Object.assign({},lt.attributes);lt.attr("cursor","pointer"),lt.addEventListener("mouseenter",()=>{lt.attr(r.active)}),lt.addEventListener("mouseleave",()=>{lt.attr(at)}),lt.addEventListener("click",()=>{M(lt.name,Bi(lt,["style","depth"]))})})}l("drillDown",$=>{const{marks:J}=$,se=J.map(pe=>{if(pe.id!==z_&&pe.type!=="rect")return pe;const{data:Ce}=pe,Ue=Object.fromEntries(["color"].map(lt=>[lt,{domain:h.scale[lt].getOptions().domain}])),Je=Ce.filter(lt=>{const Ge=lt.path;return n||(lt[iT]=Ge.split(" / ")[Y]),Z?new RegExp(`^${Z}.+`).test(Ge):!0});return ni({},pe,n?{data:Je,scale:Ue}:{data:Je})});return Object.assign(Object.assign({},$),{marks:se})}),yield s()}),I=Z=>{const Y=Z.target;if(Bi(Y,["style",KO])!==z_||Bi(Y,["markType"])!=="rect"||!Bi(Y,["style",Bx]))return;const $=Bi(Y,["__data__","key"]),J=Bi(Y,["style","depth"]);Y.style.cursor="pointer",M($,J)};y.addEventListener("click",I);const N=qO(Object.assign(Object.assign({},w.active),w.inactive)),U=()=>{tV(y).forEach(Y=>{const $=Bi(Y,["style",Bx]);if(Bi(Y,["style","cursor"])!=="pointer"&&$){Y.style.cursor="pointer";const se=GO(Y.attributes,N);Y.addEventListener("mouseenter",()=>{Y.attr(w.active)}),Y.addEventListener("mouseleave",()=>{Y.attr(ni(se,w.inactive))})}})};return y.addEventListener("mousemove",U),()=>{R.remove(),y.removeEventListener("click",I),y.removeEventListener("mousemove",U)}}}function oV(){return{"interaction.drillDown":iV,"mark.sunburst":J5}}const e4=()=>[["cartesian"]];e4.props={};const QO=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];QO.props={transform:!0};const aV=(e={})=>{const t={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},t),e)},t4=e=>{const{startAngle:t,endAngle:n,innerRadius:r,outerRadius:i}=aV(e);return[...QO(),...Ry({startAngle:t,endAngle:n,innerRadius:r,outerRadius:i})]};t4.props={};const JO=()=>[["parallel",0,1,0,1]];JO.props={};const n4=({focusX:e=0,focusY:t=0,distortionX:n=2,distortionY:r=2,visual:i=!1})=>[["fisheye",e,t,n,r,i]];n4.props={transform:!0};const r4=e=>{const{startAngle:t=-Math.PI/2,endAngle:n=Math.PI*3/2,innerRadius:r=0,outerRadius:i=1}=e;return[...JO(),...Ry({startAngle:t,endAngle:n,innerRadius:r,outerRadius:i})]};r4.props={};const i4=({value:e})=>t=>t.map(()=>e);i4.props={};const o4=({value:e})=>t=>t.map(n=>n[e]);o4.props={};const a4=({value:e})=>t=>t.map(e);a4.props={};const s4=({value:e})=>()=>e;s4.props={};function _c(e,t){if(e!==null)return{type:"column",value:e,field:t}}function oT(e,t){const n=_c(e,t);return Object.assign(Object.assign({},n),{inferred:!0})}function aT(e,t){if(e!==null)return{type:"column",value:e,field:t,visual:!0}}function sV(e,t){const n=_c(e,t);return Object.assign(Object.assign({},n),{constant:!1})}function Hg(e,t){const n=[];for(const r of e)n[r]=t;return n}function rl(e,t){const n=e[t];if(!n)return[null,null];const{value:r,field:i=null}=n;return[r,i]}function Fx(e,...t){for(const n of t)if(typeof n=="string"){const[r,i]=rl(e,n);if(r!==null)return[r,i]}else return[n,null];return[null,null]}function kx(e){return e instanceof Date?!1:typeof e=="object"}const zx=()=>(e,t)=>{const{encode:n}=t,{y1:r}=n;return r!==void 0?[e,t]:[e,ni({},t,{encode:{y1:oT(Hg(e,0))}})]};zx.props={};const h1=()=>(e,t)=>{const{encode:n}=t,{x:r}=n;return r!==void 0?[e,t]:[e,ni({},t,{encode:{x:oT(Hg(e,0))},scale:{x:{guide:null}}})]};h1.props={};const d1=(e,t)=>Ax(Object.assign({colorAttribute:"fill"},e),t);d1.props=Object.assign(Object.assign({},Ax.props),{defaultMarker:"square"});const sT=(e,t)=>Ax(Object.assign({colorAttribute:"stroke"},e),t);sT.props=Object.assign(Object.assign({},Ax.props),{defaultMarker:"hollowSquare"});function U_(){}function l4(e){this._context=e}l4.prototype={areaStart:U_,areaEnd:U_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function e3(e){return new l4(e)}var c4=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function lV(e,t,n){const[r,i,s,l]=e;if(gc(n)){const p=[t?t[0][0]:i[0],i[1]],m=[t?t[3][0]:s[0],s[1]];return[r,p,m,l]}const u=[i[0],t?t[0][1]:i[1]],h=[s[0],t?t[3][1]:s[1]];return[r,u,h,l]}const t3=(e,t)=>{const{adjustPoints:n=lV}=e,r=c4(e,["adjustPoints"]),{coordinate:i,document:s}=t;return(l,u,h,p)=>{const{index:m}=u,{color:y}=h,b=c4(h,["color"]),w=p[m+1],R=n(l,w,i),M=!!gc(i),[I,N,U,Z]=M?Hr(R):R,{color:Y=y,opacity:$}=u,J=ro().curve(e3)([I,N,U,Z]);return Pa(s.createElement("path",{})).call(jn,b).style("d",J).style("fill",Y).style("fillOpacity",$).call(jn,r).node()}};t3.props={defaultMarker:"square"};function cV(e,t,n){const[r,i,s,l]=e;if(gc(n)){const p=[t?t[0][0]:(i[0]+s[0])/2,i[1]],m=[t?t[3][0]:(i[0]+s[0])/2,s[1]];return[r,p,m,l]}const u=[i[0],t?t[0][1]:(i[1]+s[1])/2],h=[s[0],t?t[3][1]:(i[1]+s[1])/2];return[r,u,h,l]}const u4=(e,t)=>t3(Object.assign({adjustPoints:cV},e),t);u4.props={defaultMarker:"square"};function Ux(e){return Math.abs(e)>10?String(e):e.toString().padStart(2,"0")}function uV(e){const t=e.getFullYear(),n=Ux(e.getMonth()+1),r=Ux(e.getDate()),i=`${t}-${n}-${r}`,s=e.getHours(),l=e.getMinutes(),u=e.getSeconds();return s||l||u?`${i} ${Ux(s)}:${Ux(l)}:${Ux(u)}`:i}const lT=(e={})=>{const{channel:t="x"}=e;return(n,r)=>{const{encode:i}=r,{tooltip:s}=r;if(X0(s))return[n,r];const{title:l}=s;if(l!==void 0)return[n,r];const u=Object.keys(i).filter(p=>p.startsWith(t)).filter(p=>!i[p].inferred).map(p=>rl(i,p)).filter(([p])=>p).map(p=>p[0]);if(u.length===0)return[n,r];const h=[];for(const p of n)h[p]={value:u.map(m=>m[p]instanceof Date?uV(m[p]):m[p]).join(", ")};return[n,ni({},r,{tooltip:{title:h}})]}};lT.props={};const cT=e=>{const{channel:t}=e;return(n,r)=>{const{encode:i,tooltip:s}=r;if(X0(s))return[n,r];const{items:l=[]}=s;if(!l||l.length>0)return[n,r];const h=(Array.isArray(t)?t:[t]).flatMap(p=>Object.keys(i).filter(m=>m.startsWith(p)).map(m=>{const{field:y,value:b,inferred:w=!1,aggregate:R}=i[m];return w?null:R&&b?{channel:m}:y?{field:y}:b?{channel:m}:null}).filter(m=>m!==null));return[n,ni({},r,{tooltip:{items:h}})]}};cT.props={};var fV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const f4=()=>(e,t)=>{const{encode:n}=t,{key:r}=n,i=fV(n,["key"]);if(r!==void 0)return[e,t];const s=Object.values(i).map(({value:u})=>u),l=e.map(u=>s.filter(Array.isArray).map(h=>h[u]).join("-"));return[e,ni({},t,{encode:{key:_c(l)}})]};f4.props={};function h4(e={}){const{shapes:t}=e;return[{name:"color"},{name:"opacity"},{name:"shape",range:t},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function Nd(e={}){return[...h4(e),{name:"title",scale:"identity"}]}function Rte(){return[{type:MaybeTitle,channel:"color"},{type:MaybeTooltip,channel:["x","y","z"]}]}function Zg(){return[{type:lT,channel:"color"},{type:cT,channel:["x","y"]}]}function j_(){return[{type:lT,channel:"x"},{type:cT,channel:["y"]}]}function hV(){return[{type:lT,channel:"color"},{type:cT,channel:["position"]}]}function V_(e={}){return h4(e)}function ef(){return[{type:f4}]}function pf(){return[]}function n3(e,t){return e.getBandWidth(e.invert(t))}function p1(e,t,n={}){const{x:r,y:i,series:s}=t,{x:l,y:u,series:h}=e,{style:{bandOffset:p=h?0:.5,bandOffsetX:m=p,bandOffsetY:y=p}={}}=n,b=!!(l!=null&&l.getBandWidth),w=!!(u!=null&&u.getBandWidth),R=!!(h!=null&&h.getBandWidth);return!b&&!w?M=>M:(M,I)=>{const N=b?n3(l,r[I]):0,U=w?n3(u,i[I]):0,Y=R&&s?(n3(h,s[I])/2+ +s[I])*N:0,[$,J]=M;return[$+m*N+Y,J+y*U]}}function uT(e){return parseFloat(e)/100}function r3(e,t,n,r){const{x:i,y:s}=n,{innerWidth:l,innerHeight:u}=r.getOptions(),h=Array.from(e,p=>{const m=i[p],y=s[p],b=typeof m=="string"?uT(m)*l:+m,w=typeof y=="string"?uT(y)*u:+y;return[[b,w]]});return[e,h]}function $m(e){return typeof e=="function"?e:t=>t[e]}function i3(e,t){return Array.from(e,$m(t))}function o3(e,t){const{source:n=m=>m.source,target:r=m=>m.target,value:i=m=>m.value}=t,{links:s,nodes:l}=e,u=i3(s,n),h=i3(s,r),p=i3(s,i);return{links:s.map((m,y)=>({target:h[y],source:u[y],value:p[y]})),nodes:l||Array.from(new Set([...u,...h]),m=>({key:m}))}}function d4(e,t){return e.getBandWidth(e.invert(t))}const p4={rect:d1,hollow:sT,funnel:t3,pyramid:u4},m4=()=>(e,t,n,r)=>{const{x:i,y:s,y1:l,series:u,size:h}=n,p=t.x,m=t.series,[y]=r.getSize(),b=h?h.map(M=>+M/y):null,w=h?(M,I,N)=>{const U=M+I/2,Z=b[N];return[U-Z/2,U+Z/2]}:(M,I,N)=>[M,M+I],R=Array.from(e,M=>{const I=d4(p,i[M]),N=m?d4(m,u==null?void 0:u[M]):1,U=I*N,Z=(+(u==null?void 0:u[M])||0)*I,Y=+i[M]+Z,[$,J]=w(Y,U,M),se=+s[M],pe=+l[M];return[[$,se],[J,se],[J,pe],[$,pe]].map(Ge=>r.map(Ge))});return[e,R]};m4.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:p4,channels:[...Nd({shapes:Object.keys(p4)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[...ef(),{type:zx},{type:h1}],postInference:[...pf(),...j_()],interaction:{shareTooltip:!0}};const v4={rect:d1,hollow:sT},g4=()=>(e,t,n,r)=>{const{x:i,x1:s,y:l,y1:u}=n,h=Array.from(e,p=>{const m=[+i[p],+l[p]],y=[+s[p],+l[p]],b=[+s[p],+u[p]],w=[+i[p],+u[p]];return[m,y,b,w].map(R=>r.map(R))});return[e,h]};g4.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:v4,channels:[...Nd({shapes:Object.keys(v4)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...ef(),{type:zx}],postInference:[...pf(),...j_()],interaction:{shareTooltip:!0}};var y4=a3(Wf);function _4(e){this._curve=e}_4.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function a3(e){function t(n){return new _4(e(n))}return t._curve=e,t}function jx(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(n){return arguments.length?t(a3(n)):t()._curve},e}function dV(){return jx(ro().curve(y4))}var b4=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const pV=df(e=>{const{d1:t,d2:n,style1:r,style2:i}=e.attributes,s=e.ownerDocument;Pa(e).maybeAppend("line",()=>s.createElement("path",{})).style("d",t).call(jn,r),Pa(e).maybeAppend("line1",()=>s.createElement("path",{})).style("d",n).call(jn,i)});function mV(e,t){const n=[],r=[];let i=!1,s=null;for(const l of e)!t(l[0])||!t(l[1])?i=!0:(n.push(l),i&&(i=!1,r.push([s,l])),s=l);return[n,r]}const T0=(e,t)=>{const{curve:n,gradient:r=!1,gradientColor:i="between",defined:s=m=>!Number.isNaN(m)&&m!==void 0&&m!==null,connect:l=!1}=e,u=b4(e,["curve","gradient","gradientColor","defined","connect"]),{coordinate:h,document:p}=t;return(m,y,b)=>{const{color:w,lineWidth:R}=b,M=b4(b,["color","lineWidth"]),{color:I=w,size:N=R,seriesColor:U,seriesX:Z,seriesY:Y}=y,$=$o(h,y),J=gc(h),se=r&&U?Ji(U,Z,Y,r,i,J):I,pe=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},M),se&&{stroke:se}),N&&{lineWidth:N}),$&&{transform:$}),u);let Ce;if(Ml(h)){const st=h.getCenter();Ce=ft=>dV().angle((Vt,wt)=>rn(ge(ft[wt],st))).radius((Vt,wt)=>Ve(ft[wt],st)).defined(([Vt,wt])=>s(Vt)&&s(wt)).curve(n)(ft)}else Ce=ro().x(st=>st[0]).y(st=>st[1]).defined(([st,ft])=>s(st)&&s(ft)).curve(n);const[Ue,Je]=mV(m,s),lt=po(pe,"connect"),Ge=!!Je.length;if(!Ge||l&&!Object.keys(lt).length)return Pa(p.createElement("path",{})).style("d",Ce(Ue)||[]).call(jn,pe).node();if(Ge&&!l)return Pa(p.createElement("path",{})).style("d",Ce(m)).call(jn,pe).node();const at=st=>st.map(Ce).join(",");return Pa(new pV).style("style1",Object.assign(Object.assign({},pe),lt)).style("style2",pe).style("d1",at(Je)).style("d2",Ce(m)).node()}};T0.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const x4=(e,t)=>{const{coordinate:n}=t;return(...r)=>{const i=Ml(n)?e3:Wf;return T0(Object.assign({curve:i},e),t)(...r)}};x4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"line"});function s3(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function l3(e,t){this._context=e,this._k=(1-t)/6}l3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:s3(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:s3(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Mte=function e(t){function n(r){return new l3(r,t)}return n.tension=function(r){return e(+r)},n}(0);function c3(e,t){this._context=e,this._k=(1-t)/6}c3.prototype={areaStart:U_,areaEnd:U_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:s3(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Pte=function e(t){function n(r){return new c3(r,t)}return n.tension=function(r){return e(+r)},n}(0);function E4(e,t,n){var r=e._x1,i=e._y1,s=e._x2,l=e._y2;if(e._l01_a>fd){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,h=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/h,i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/h}if(e._l23_a>fd){var p=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,m=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*p+e._x1*e._l23_2a-t*e._l12_2a)/m,l=(l*p+e._y1*e._l23_2a-n*e._l12_2a)/m}e._context.bezierCurveTo(r,i,s,l,e._x2,e._y2)}function S4(e,t){this._context=e,this._alpha=t}S4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:E4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ite=function e(t){function n(r){return t?new S4(r,t):new l3(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function T4(e,t){this._context=e,this._alpha=t}T4.prototype={areaStart:U_,areaEnd:U_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:E4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var w4=function e(t){function n(r){return t?new T4(r,t):new c3(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function A4(e){return e<0?-1:1}function C4(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),l=(n-e._y1)/(i||r<0&&-0),u=(s*i+l*r)/(r+i);return(A4(s)+A4(l))*Math.min(Math.abs(s),Math.abs(l),.5*Math.abs(u))||0}function O4(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function u3(e,t,n){var r=e._x0,i=e._y0,s=e._x1,l=e._y1,u=(s-r)/3;e._context.bezierCurveTo(r+u,i+u*t,s-u,l-u*n,s,l)}function fT(e){this._context=e}fT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:u3(this,this._t0,O4(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,u3(this,O4(this,n=C4(this,e,t)),n);break;default:u3(this,this._t0,n=C4(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function R4(e){this._context=new M4(e)}(R4.prototype=Object.create(fT.prototype)).point=function(e,t){fT.prototype.point.call(this,t,e)};function M4(e){this._context=e}M4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function P4(e){return new fT(e)}function I4(e){return new R4(e)}var vV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const L4=(e,t)=>{const n=vV(e,[]),{coordinate:r}=t;return(...i)=>{const s=Ml(r)?w4:gc(r)?I4:P4;return T0(Object.assign({curve:s},n),t)(...i)}};L4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"smooth"});function hT(e,t){this._context=e,this._t=t}hT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function D4(e){return new hT(e,.5)}function N4(e){return new hT(e,0)}function B4(e){return new hT(e,1)}const F4=(e,t)=>T0(Object.assign({curve:B4},e),t);F4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"hv"});const k4=(e,t)=>T0(Object.assign({curve:N4},e),t);k4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"vh"});const z4=(e,t)=>T0(Object.assign({curve:D4},e),t);z4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"hvh"});var gV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function yV(e,t,n,r,i){const s=ge(n,t),l=Mt(s),u=l+Math.PI/2,h=[r/2*Math.cos(u),r/2*Math.sin(u)],p=[i/2*Math.cos(u),i/2*Math.sin(u)],m=[i/2*Math.cos(l),i/2*Math.sin(l)],y=[r/2*Math.cos(l),r/2*Math.sin(l)],b=Te(t,h),w=Te(n,p),R=Te(w,m),M=Te(n,m),I=ge(M,p),N=ge(n,p),U=ge(t,h),Z=ge(U,y),Y=ge(t,y),$=ge(b,y);e.moveTo(...b),e.lineTo(...w),e.arcTo(...R,...M,i/2),e.arcTo(...I,...N,i/2),e.lineTo(...U),e.arcTo(...Z,...Y,r/2),e.arcTo(...$,...b,r/2),e.closePath()}const U4=(e,t)=>{const{document:n}=t;return(r,i,s)=>{const{seriesSize:l,color:u}=i,{color:h}=s,p=gV(s,["color"]),m=hp();for(let y=0;y<r.length-1;y++){const b=r[y],w=r[y+1],R=l[y],M=l[y+1];[...b,...w].every(Ql)&&yV(m,b,w,R,M)}return Pa(n.createElement("path",{})).call(jn,p).style("fill",u||h).style("d",m.toString()).call(jn,e).node()}};U4.props=Object.assign(Object.assign({},T0.props),{defaultMarker:"line"});const j4=()=>(e,t)=>{const{style:n={},encode:r}=t,{series:i}=r,{gradient:s}=n;return!s||i?[e,t]:[e,ni({},t,{encode:{series:aT(Hg(e,void 0))}})]};j4.props={};const f3=()=>(e,t)=>{const{encode:n}=t,{series:r,color:i}=n;if(r!==void 0||i===void 0)return[e,t];const[s,l]=rl(n,"color");return[e,ni({},t,{encode:{series:_c(s,l)}})]};f3.props={};const V4={line:x4,smooth:L4,hv:F4,vh:k4,hvh:z4,trail:U4},_V=(e,t,n,r)=>{var i,s;const{series:l,x:u,y:h}=n,{x:p,y:m}=t;if(u===void 0||h===void 0)throw new Error("Missing encode for x or y channel.");const y=l?Array.from(vc(e,I=>l[I]).values()):[e],b=y.map(I=>I[0]).filter(I=>I!==void 0),w=(((i=p==null?void 0:p.getBandWidth)===null||i===void 0?void 0:i.call(p))||0)/2,R=(((s=m==null?void 0:m.getBandWidth)===null||s===void 0?void 0:s.call(m))||0)/2,M=Array.from(y,I=>I.map(N=>r.map([+u[N]+w,+h[N]+R])));return[b,M,y]},bV=(e,t,n,r)=>{const i=Object.entries(n).filter(([l])=>l.startsWith("position")).map(([,l])=>l);if(i.length===0)throw new Error("Missing encode for position channel.");const s=Array.from(e,l=>{const u=i.map(m=>+m[l]),h=r.map(u),p=[];for(let m=0;m<h.length;m+=2)p.push([h[m],h[m+1]]);return p});return[e,s]},H4=()=>(e,t,n,r)=>(Py(r)?bV:_V)(e,t,n,r);H4.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:V4,channels:[...Nd({shapes:Object.keys(V4)}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...ef(),{type:j4},{type:f3}],postInference:[...pf(),...j_(),...hV()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};var xV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Z4(e,t,n,r){if(t.length===1)return;const{size:i}=n;if(e==="fixed")return i;if(e==="normal"||yE(r)){const[[s,l],[u,h]]=t,p=Math.abs((u-s)/2),m=Math.abs((h-l)/2);return Math.max(0,(p+m)/2)}return i}const Gs=(e,t)=>{const{colorAttribute:n,symbol:r,mode:i="auto"}=e,s=xV(e,["colorAttribute","symbol","mode"]),l=op.get(r)||op.get("point"),{coordinate:u,document:h}=t;return(p,m,y)=>{const{lineWidth:b,color:w}=y,R=s.stroke?b||1:b,{color:M=w,transform:I,opacity:N}=m,[U,Z]=cs(p),$=Z4(i,p,m,u)||s.r||y.r;return Pa(h.createElement("path",{})).call(jn,y).style("fill","transparent").style("d",l(U,Z,$)).style("lineWidth",R).style("transform",I).style("transformOrigin",`${U-$} ${Z-$}`).style("stroke",M).style(ys(e),N).style(n,M).call(jn,s).node()}};Gs.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const W4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"point"},e),t);W4.props=Object.assign({defaultMarker:"hollowPoint"},Gs.props);const G4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"diamond"},e),t);G4.props=Object.assign({defaultMarker:"hollowDiamond"},Gs.props);const X4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},e),t);X4.props=Object.assign({defaultMarker:"hollowHexagon"},Gs.props);const Y4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"square"},e),t);Y4.props=Object.assign({defaultMarker:"hollowSquare"},Gs.props);const $4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},e),t);$4.props=Object.assign({defaultMarker:"hollowTriangleDown"},Gs.props);const K4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"triangle"},e),t);K4.props=Object.assign({defaultMarker:"hollowTriangle"},Gs.props);const q4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},e),t);q4.props=Object.assign({defaultMarker:"hollowBowtie"},Gs.props);var EV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Q4=(e,t)=>{const{colorAttribute:n,mode:r="auto"}=e,i=EV(e,["colorAttribute","mode"]),{coordinate:s,document:l}=t;return(u,h,p)=>{const{lineWidth:m,color:y}=p,b=i.stroke?m||1:m,{color:w=y,transform:R,opacity:M}=h,[I,N]=cs(u),Z=Z4(r,u,h,s)||i.r||p.r;return Pa(l.createElement("circle",{})).call(jn,p).style("fill","transparent").style("cx",I).style("cy",N).style("r",Z).style("lineWidth",b).style("transform",R).style("transformOrigin",`${I} ${N}`).style("stroke",w).style(ys(e),M).style(n,w).call(jn,i).node()}},h3=(e,t)=>Q4(Object.assign({colorAttribute:"fill"},e),t);h3.props={defaultMarker:"circle",defaultEnterAnimation:"fadeIn",defaultExitAnimation:"fadeOut"};const J4=(e,t)=>Q4(Object.assign({colorAttribute:"stroke"},e),t);J4.props=Object.assign({defaultMarker:"hollowPoint"},h3.props);const eL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"point"},e),t);eL.props=Object.assign({defaultMarker:"point"},Gs.props);const tL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"plus"},e),t);tL.props=Object.assign({defaultMarker:"plus"},Gs.props);const nL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"diamond"},e),t);nL.props=Object.assign({defaultMarker:"diamond"},Gs.props);const rL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"square"},e),t);rL.props=Object.assign({defaultMarker:"square"},Gs.props);const iL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"triangle"},e),t);iL.props=Object.assign({defaultMarker:"triangle"},Gs.props);const oL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"hexagon"},e),t);oL.props=Object.assign({defaultMarker:"hexagon"},Gs.props);const aL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"cross"},e),t);aL.props=Object.assign({defaultMarker:"cross"},Gs.props);const sL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"bowtie"},e),t);sL.props=Object.assign({defaultMarker:"bowtie"},Gs.props);const lL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},e),t);lL.props=Object.assign({defaultMarker:"hyphen"},Gs.props);const cL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"line"},e),t);cL.props=Object.assign({defaultMarker:"line"},Gs.props);const uL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"tick"},e),t);uL.props=Object.assign({defaultMarker:"tick"},Gs.props);const fL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},e),t);fL.props=Object.assign({defaultMarker:"triangleDown"},Gs.props);const dT=()=>(e,t)=>{const{encode:n}=t,{y:r}=n;return r!==void 0?[e,t]:[e,ni({},t,{encode:{y:oT(Hg(e,0))},scale:{y:{guide:null}}})]};dT.props={};const hL=()=>(e,t)=>{const{encode:n}=t,{size:r}=n;return r!==void 0?[e,t]:[e,ni({},t,{encode:{size:aT(Hg(e,3))}})]};hL.props={};const dL={hollow:W4,hollowDiamond:G4,hollowHexagon:X4,hollowSquare:Y4,hollowTriangleDown:$4,hollowTriangle:K4,hollowBowtie:q4,hollowCircle:J4,point:eL,plus:tL,diamond:nL,square:rL,triangle:iL,hexagon:oL,cross:aL,bowtie:sL,hyphen:lL,line:cL,tick:uL,triangleDown:fL,circle:h3},pL=e=>(t,n,r,i)=>{const{x:s,y:l,x1:u,y1:h,size:p,dx:m,dy:y}=r,[b,w]=i.getSize(),R=p1(n,r,e),M=N=>{const U=+((m==null?void 0:m[N])||0),Z=+((y==null?void 0:y[N])||0),Y=u?(+s[N]+ +u[N])/2:+s[N],$=h?(+l[N]+ +h[N])/2:+l[N],J=Y+U,se=$+Z;return[J,se]},I=p?Array.from(t,N=>{const[U,Z]=M(N),Y=+p[N],$=Y/b,J=Y/w,se=[U-$,Z-J],pe=[U+$,Z+J];return[i.map(R(se,N)),i.map(R(pe,N))]}):Array.from(t,N=>[i.map(R(M(N),N))]);return[t,I]};pL.props={defaultShape:"hollow",defaultLabelShape:"label",composite:!1,shape:dL,channels:[...Nd({shapes:Object.keys(dL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...ef(),{type:h1},{type:dT}],postInference:[...pf(),{type:hL},...Zg()]};const mL=(e,t)=>{const{coordinate:n}=t;return(r,i,s)=>{const{color:l,text:u="",fontSize:h,rotate:p=0,transform:m=""}=i,y={text:String(u),stroke:l,fill:l,fontSize:h},[[b,w]]=r;return Pa(new zP).style("x",b).style("y",w).call(jn,s).style("transform",`${m}rotate(${+p})`).style("coordCenter",n.getCenter()).call(jn,y).call(jn,e).node()}};mL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var p3=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function SV(e){const t=e/Math.sqrt(2),n=e*Math.sqrt(2),[r,i]=[-t,t-n],[s,l]=[0,0],[u,h]=[t,t-n];return[["M",r,i],["A",e,e,0,1,1,u,h],["L",s,l],["Z"]]}function TV(e){const{min:t,max:n}=e.getLocalBounds();return[(t[0]+n[0])*.5,(t[1]+n[1])*.5]}const wV=df(e=>{const t=e.attributes,{class:n,x:r,y:i,transform:s}=t,l=p3(t,["class","x","y","transform"]),u=po(l,"marker"),{size:h=24}=u,p=()=>SV(h/2),m=Pa(e).maybeAppend("marker",()=>new pl({})).call(w=>w.node().update(Object.assign({symbol:p},u))).node(),[y,b]=TV(m);Pa(e).maybeAppend("text","text").style("x",y).style("y",b).call(jn,l)}),vL=(e,t)=>{const n=p3(e,[]);return(r,i,s)=>{const{color:l}=s,u=p3(s,["color"]),{color:h=l,text:p=""}=i,m={text:String(p),stroke:h,fill:h},[[y,b]]=r;return Pa(new wV).call(jn,u).style("transform",`translate(${y},${b})`).call(jn,m).call(jn,n).node()}};vL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const gL=(e,t)=>{const{coordinate:n}=t;return(r,i,s)=>{const{color:l,text:u="",fontSize:h,rotate:p=0,transform:m=""}=i,y={text:String(u),stroke:l,fill:l,fontSize:h,textAlign:"center",textBaseline:"middle"},[[b,w]]=r;return Pa(new ma).style("x",b).style("y",w).call(jn,s).style("transformOrigin","center center").style("transform",`${m}rotate(${p}deg)`).style("coordCenter",n.getCenter()).call(jn,y).call(jn,e).node()}};gL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const pT=()=>(e,t)=>{const{data:n}=t;if(!Array.isArray(n)||n.some(kx))return[e,t];const r=Array.isArray(n[0])?n:[n],i=r.map(l=>l[0]),s=r.map(l=>l[1]);return[e,ni({},t,{encode:{x:_c(i),y:_c(s)}})]};pT.props={};var yL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const mT=()=>(e,t)=>{const{data:n,style:r={}}=t,i=yL(t,["data","style"]),{x:s,y:l}=r,u=yL(r,["x","y"]);if(s==null||l==null)return[e,t];const h=s||0,p=l||0;return[[0],ni({},i,{data:[0],cartesian:!0,encode:{x:_c([h]),y:_c([p])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:u})]};mT.props={};const _L={text:mL,badge:vL,tag:gL},bL=e=>{const{cartesian:t=!1}=e;return t?r3:(n,r,i,s)=>{const{x:l,y:u}=i,h=p1(r,i,e),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};bL.props={defaultShape:"text",defaultLabelShape:"label",composite:!1,shape:_L,channels:[...Nd({shapes:Object.keys(_L)}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize",scale:"identity"},{name:"rotate",scale:"identity"}],preInference:[...ef(),{type:pT},{type:mT}],postInference:[...pf(),...Zg()]};const m3=()=>(e,t)=>[e,ni({scale:{x:{padding:0},y:{padding:0}}},t)];m3.props={};const xL={cell:d1,hollow:sT},EL=()=>(e,t,n,r)=>{const{x:i,y:s}=n,l=t.x,u=t.y,h=Array.from(e,p=>{const m=l.getBandWidth(l.invert(+i[p])),y=u.getBandWidth(u.invert(+s[p])),b=+i[p],w=+s[p],R=[b,w],M=[b+m,w],I=[b+m,w+y],N=[b,w+y];return[R,M,I,N].map(U=>r.map(U))});return[e,h]};EL.props={defaultShape:"cell",defaultLabelShape:"label",shape:xL,composite:!1,channels:[...Nd({shapes:Object.keys(xL)}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...ef(),{type:h1},{type:dT},{type:m3}],postInference:[...pf(),...Zg()]};function v3(e,t,n){var r=null,i=cl(!0),s=null,l=Wf,u=null,h=la(p);e=typeof e=="function"?e:e===void 0?Ws:cl(+e),t=typeof t=="function"?t:cl(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?ul:cl(+n);function p(y){var b,w,R,M=(y=Nh(y)).length,I,N=!1,U,Z=new Array(M),Y=new Array(M);for(s==null&&(u=l(U=h())),b=0;b<=M;++b){if(!(b<M&&i(I=y[b],b,y))===N)if(N=!N)w=b,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),R=b-1;R>=w;--R)u.point(Z[R],Y[R]);u.lineEnd(),u.areaEnd()}N&&(Z[b]=+e(I,b,y),Y[b]=+t(I,b,y),u.point(r?+r(I,b,y):Z[b],n?+n(I,b,y):Y[b]))}if(U)return u=null,U+""||null}function m(){return ro().defined(i).curve(l).context(s)}return p.x=function(y){return arguments.length?(e=typeof y=="function"?y:cl(+y),r=null,p):e},p.x0=function(y){return arguments.length?(e=typeof y=="function"?y:cl(+y),p):e},p.x1=function(y){return arguments.length?(r=y==null?null:typeof y=="function"?y:cl(+y),p):r},p.y=function(y){return arguments.length?(t=typeof y=="function"?y:cl(+y),n=null,p):t},p.y0=function(y){return arguments.length?(t=typeof y=="function"?y:cl(+y),p):t},p.y1=function(y){return arguments.length?(n=y==null?null:typeof y=="function"?y:cl(+y),p):n},p.lineX0=p.lineY0=function(){return m().x(e).y(t)},p.lineY1=function(){return m().x(e).y(n)},p.lineX1=function(){return m().x(r).y(t)},p.defined=function(y){return arguments.length?(i=typeof y=="function"?y:cl(!!y),p):i},p.curve=function(y){return arguments.length?(l=y,s!=null&&(u=l(s)),p):l},p.context=function(y){return arguments.length?(y==null?s=u=null:u=l(s=y),p):s},p}function AV(){var e=v3().curve(y4),t=e.curve,n=e.lineX0,r=e.lineX1,i=e.lineY0,s=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return jx(n())},delete e.lineX0,e.lineEndAngle=function(){return jx(r())},delete e.lineX1,e.lineInnerRadius=function(){return jx(i())},delete e.lineY0,e.lineOuterRadius=function(){return jx(s())},delete e.lineY1,e.curve=function(l){return arguments.length?t(a3(l)):t()._curve},e}var CV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function OV(e,t){const n=[],r=[],i=[];let s=!1,l=null;const u=e.length/2;for(let h=0;h<u;h++){const p=e[h],m=e[h+u];if([...p,...m].some(y=>!t(y)))s=!0;else{if(n.push(p),r.push(m),s&&l){s=!1;const[y,b]=l;i.push([y,p,b,m])}l=[p,m]}}return[n.concat(r),i]}const SL=df(e=>{const{areaPath:t,connectPath:n,areaStyle:r,connectStyle:i}=e.attributes,s=e.ownerDocument;Pa(e).maybeAppend("connect-path",()=>s.createElement("path",{})).style("d",n).call(jn,i),Pa(e).maybeAppend("area-path",()=>s.createElement("path",{})).style("d",t).call(jn,r)}),rm=(e,t)=>{const{curve:n,gradient:r=!1,defined:i=p=>!Number.isNaN(p)&&p!==void 0&&p!==null,connect:s=!1}=e,l=CV(e,["curve","gradient","defined","connect"]),{coordinate:u,document:h}=t;return(p,m,y)=>{const{color:b}=y,{color:w=b,seriesColor:R,seriesX:M,seriesY:I}=m,N=gc(u),U=$o(u,m),Z=r&&R?Ji(R,M,I,r,void 0,N):w,Y=Object.assign(Object.assign(Object.assign(Object.assign({},y),{stroke:Z,fill:Z}),U&&{transform:U}),l),[$,J]=OV(p,i),se=po(Y,"connect"),pe=!!J.length,Ce=Ue=>Pa(h.createElement("path",{})).style("d",Ue||"").call(jn,Y).node();if(Ml(u)){const Ue=Je=>{const lt=u.getCenter(),Ge=Je.slice(0,Je.length/2),at=Je.slice(Je.length/2);return AV().angle((st,ft)=>rn(ge(Ge[ft],lt))).outerRadius((st,ft)=>Ve(Ge[ft],lt)).innerRadius((st,ft)=>Ve(at[ft],lt)).defined((st,ft)=>[...Ge[ft],...at[ft]].every(i)).curve(n)(at)};return!pe||s&&!Object.keys(se).length?Ce(Ue($)):pe&&!s?Ce(Ue(p)):Pa(new SL).style("areaStyle",Y).style("connectStyle",Object.assign(Object.assign({},se),l)).style("areaPath",Ue(p)).style("connectPath",J.map(Ue).join("")).node()}else{const Ue=Je=>{const lt=Je.slice(0,Je.length/2),Ge=Je.slice(Je.length/2);return N?v3().y((at,st)=>lt[st][1]).x1((at,st)=>lt[st][0]).x0((at,st)=>Ge[st][0]).defined((at,st)=>[...lt[st],...Ge[st]].every(i)).curve(n)(lt):v3().x((at,st)=>lt[st][0]).y1((at,st)=>lt[st][1]).y0((at,st)=>Ge[st][1]).defined((at,st)=>[...lt[st],...Ge[st]].every(i)).curve(n)(lt)};return!pe||s&&!Object.keys(se).length?Ce(Ue($)):pe&&!s?Ce(Ue(p)):Pa(new SL).style("areaStyle",Y).style("connectStyle",Object.assign(Object.assign({},se),l)).style("areaPath",Ue(p)).style("connectPath",J.map(Ue).join("")).node()}}};rm.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const TL=(e,t)=>{const{coordinate:n}=t;return(...r)=>{const i=Ml(n)?e3:Wf;return rm(Object.assign({curve:i},e),t)(...r)}};TL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"square"});var RV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const wL=(e,t)=>{const n=RV(e,[]),{coordinate:r}=t;return(...i)=>{const s=Ml(r)?w4:gc(r)?I4:P4;return rm(Object.assign({curve:s},n),t)(...i)}};wL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"smooth"});const AL=(e,t)=>(...n)=>rm(Object.assign({curve:D4},e),t)(...n);AL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"hvh"});const CL=(e,t)=>(...n)=>rm(Object.assign({curve:N4},e),t)(...n);CL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"vh"});const OL=(e,t)=>(...n)=>rm(Object.assign({curve:B4},e),t)(...n);OL.props=Object.assign(Object.assign({},rm.props),{defaultMarker:"hv"});const RL={area:TL,smooth:wL,hvh:AL,vh:CL,hv:OL},ML=()=>(e,t,n,r)=>{var i,s;const{x:l,y:u,y1:h,series:p}=n,{x:m,y}=t,b=p?Array.from(vc(e,N=>p[N]).values()):[e],w=b.map(N=>N[0]).filter(N=>N!==void 0),R=(((i=m==null?void 0:m.getBandWidth)===null||i===void 0?void 0:i.call(m))||0)/2,M=(((s=y==null?void 0:y.getBandWidth)===null||s===void 0?void 0:s.call(y))||0)/2,I=Array.from(b,N=>{const U=N.length,Z=new Array(U*2);for(let Y=0;Y<N.length;Y++){const $=N[Y];Z[Y]=r.map([+l[$]+R,+u[$]+M]),Z[U+Y]=r.map([+l[$]+R,+h[$]+M])}return Z});return[w,I,b]};ML.props={defaultShape:"area",defaultLabelShape:"label",composite:!1,shape:RL,channels:[...Nd({shapes:Object.keys(RL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...ef(),{type:f3},{type:zx},{type:m3}],postInference:[...pf(),...j_()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const PL=()=>(e,t)=>{const{encode:n}=t,{y1:r}=n;if(r)return[e,t];const[i]=rl(n,"y");return[e,ni({},t,{encode:{y1:_c([...i])}})]};PL.props={};const IL=()=>(e,t)=>{const{encode:n}=t,{x1:r}=n;if(r)return[e,t];const[i]=rl(n,"x");return[e,ni({},t,{encode:{x1:_c([...i])}})]};IL.props={};var LL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const g3=(e,t)=>{const{arrow:n=!0,arrowSize:r="40%"}=e,i=LL(e,["arrow","arrowSize"]),{document:s}=t;return(l,u,h)=>{const{defaultColor:p}=h,m=LL(h,["defaultColor"]),{color:y=p,transform:b}=u,[w,R]=l,M=hp();if(M.moveTo(...w),M.lineTo(...R),n){const[I,N]=ji(w,R,{arrowSize:r});M.moveTo(...I),M.lineTo(...R),M.lineTo(...N)}return Pa(s.createElement("path",{})).call(jn,m).style("d",M.toString()).style("stroke",y).style("transform",b).call(jn,i).node()}};g3.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const DL=(e,t)=>{const{arrow:n=!1}=e;return(...r)=>g3(Object.assign(Object.assign({},e),{arrow:n}),t)(...r)};DL.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var NL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const BL=(e,t)=>{const n=NL(e,[]),{coordinate:r,document:i}=t;return(s,l,u)=>{const{color:h}=u,p=NL(u,["color"]),{color:m=h,transform:y}=l,[b,w]=s,R=hp();if(R.moveTo(b[0],b[1]),Ml(r)){const M=r.getCenter();R.quadraticCurveTo(M[0],M[1],w[0],w[1])}else{const M=Nr(b,w),I=Ve(b,w)/2;To(R,b,w,M,I)}return Pa(i.createElement("path",{})).call(jn,p).style("d",R.toString()).style("stroke",m).style("transform",y).call(jn,n).node()}};BL.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var FL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const kL=(e,t)=>{const n=FL(e,[]),{document:r}=t;return(i,s,l)=>{const{color:u}=l,h=FL(l,["color"]),{color:p=u,transform:m}=s,[y,b]=i,w=hp();return w.moveTo(y[0],y[1]),w.bezierCurveTo(y[0]/2+b[0]/2,y[1],y[0]/2+b[0]/2,b[1],b[0],b[1]),Pa(r.createElement("path",{})).call(jn,h).style("d",w.toString()).style("stroke",p).style("transform",m).call(jn,n).node()}};kL.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var zL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function MV(e,t,n,r){const i=hp();if(Ml(n)){const s=n.getCenter(),l=Ve(e,s),h=(Ve(t,s)-l)*r+l;return i.moveTo(e[0],e[1]),To(i,e,t,s,h),i.lineTo(t[0],t[1]),i}return gc(n)?(i.moveTo(e[0],e[1]),i.lineTo(e[0]+(t[0]-e[0])*r,e[1]),i.lineTo(e[0]+(t[0]-e[0])*r,t[1]),i.lineTo(t[0],t[1]),i):(i.moveTo(e[0],e[1]),i.lineTo(e[0],e[1]+(t[1]-e[1])*r),i.lineTo(t[0],e[1]+(t[1]-e[1])*r),i.lineTo(t[0],t[1]),i)}const UL=(e,t)=>{const{cornerRatio:n=1/3}=e,r=zL(e,["cornerRatio"]),{coordinate:i,document:s}=t;return(l,u,h)=>{const{defaultColor:p}=h,m=zL(h,["defaultColor"]),{color:y=p,transform:b}=u,[w,R]=l,M=MV(w,R,i,n);return Pa(s.createElement("path",{})).call(jn,m).style("d",M.toString()).style("stroke",y).style("transform",b).call(jn,r).node()}};UL.props={defaultMarker:"vhv",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const jL={link:DL,arc:BL,smooth:kL,vhv:UL},y3=e=>(t,n,r,i)=>{const{x:s,y:l,x1:u=s,y1:h=l}=r,p=p1(n,r,e),m=t.map(y=>[i.map(p([+s[y],+l[y]],y)),i.map(p([+u[y],+h[y]],y))]);return[t,m]};y3.props={defaultShape:"link",defaultLabelShape:"label",composite:!1,shape:jL,channels:[...Nd({shapes:Object.keys(jL)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...ef(),{type:PL},{type:IL}],postInference:[...pf(),...Zg()]};var PV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const VL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u}=l,h=PV(l,["color"]),{color:p=u,src:m="",size:y=32,transform:b=""}=s;let{width:w=y,height:R=y}=e;const[[M,I]]=i,[N,U]=n.getSize();w=typeof w=="string"?uT(w)*N:w,R=typeof R=="string"?uT(R)*U:R;const Z=M-Number(w)/2,Y=I-Number(R)/2;return Pa(r.createElement("image",{})).call(jn,h).style("x",Z).style("y",Y).style("src",m).style("stroke",p).style("transform",b).call(jn,e).style("width",w).style("height",R).node()}};VL.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const HL={image:VL},ZL=e=>{const{cartesian:t}=e;return t?r3:(n,r,i,s)=>{const{x:l,y:u}=i,h=p1(r,i,e),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};ZL.props={defaultShape:"image",defaultLabelShape:"label",composite:!1,shape:HL,channels:[...Nd({shapes:Object.keys(HL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[...ef(),{type:pT},{type:mT}],postInference:[...pf(),...Zg()]};var IV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function LV(e,t){const n=hp();if(Ml(t)){const r=t.getCenter(),i=[...e,e[0]],s=i.map(l=>Ve(l,r));return i.forEach((l,u)=>{if(u===0){n.moveTo(l[0],l[1]);return}const h=s[u],p=e[u-1],m=s[u-1];m!==void 0&&Math.abs(h-m)<1e-10?To(n,p,l,r,h):n.lineTo(l[0],l[1])}),n.closePath(),n}return ci(n,e)}const WL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u}=l,h=IV(l,["color"]),{color:p=u,transform:m}=s,y=LV(i,n);return Pa(r.createElement("path",{})).call(jn,h).style("d",y.toString()).style("stroke",p).style("fill",p).style("transform",m).call(jn,e).node()}};WL.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var GL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function DV(e,t){const[n,r,i,s]=e,l=hp();if(Ml(t)){const u=t.getCenter(),h=Ve(u,n);return l.moveTo(n[0],n[1]),l.quadraticCurveTo(u[0],u[1],i[0],i[1]),To(l,i,s,u,h),l.quadraticCurveTo(u[0],u[1],r[0],r[1]),To(l,r,n,u,h),l.closePath(),l}return l.moveTo(n[0],n[1]),l.bezierCurveTo(n[0]/2+i[0]/2,n[1],n[0]/2+i[0]/2,i[1],i[0],i[1]),l.lineTo(s[0],s[1]),l.bezierCurveTo(s[0]/2+r[0]/2,s[1],s[0]/2+r[0]/2,r[1],r[0],r[1]),l.lineTo(n[0],n[1]),l.closePath(),l}const XL=(e,t)=>{const n=GL(e,[]),{coordinate:r,document:i}=t;return(s,l,u)=>{const{color:h}=u,p=GL(u,["color"]),{color:m=h,transform:y}=l,b=DV(s,r);return Pa(i.createElement("path",{})).call(jn,p).style("d",b.toString()).style("fill",m||h).style("stroke",m||h).style("transform",y).call(jn,n).node()}};XL.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const YL={polygon:WL,ribbon:XL},$L=()=>(e,t,n,r)=>{const i=Object.entries(n).filter(([u])=>u.startsWith("x")).map(([,u])=>u),s=Object.entries(n).filter(([u])=>u.startsWith("y")).map(([,u])=>u),l=e.map(u=>{const h=[];for(let p=0;p<i.length;p++){const m=i[p][u];if(m===void 0)break;const y=s[p][u];h.push(r.map([+m,+y]))}return h});return[e,l]};$L.props={defaultShape:"polygon",defaultLabelShape:"label",composite:!1,shape:YL,channels:[...Nd({shapes:Object.keys(YL)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...ef()],postInference:[...pf(),...Zg()]};var NV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function BV(e,t){const n=hp();if(!Ml(t))n.moveTo(...e[0]),n.lineTo(...e[1]),n.moveTo(...e[2]),n.lineTo(...e[3]),n.moveTo(...e[4]),n.lineTo(...e[5]),n.lineTo(...e[6]),n.lineTo(...e[7]),n.closePath(),n.moveTo(...e[8]),n.lineTo(...e[9]),n.moveTo(...e[10]),n.lineTo(...e[11]),n.moveTo(...e[12]),n.lineTo(...e[13]);else{const r=t.getCenter(),[i,s]=r,l=Mt(ge(e[0],r)),u=Mt(ge(e[1],r)),h=Ve(r,e[2]),p=Ve(r,e[3]),m=Ve(r,e[8]),y=Ve(r,e[10]),b=Ve(r,e[11]);n.moveTo(...e[0]),n.arc(i,s,h,l,u),n.arc(i,s,h,u,l,!0),n.moveTo(...e[2]),n.lineTo(...e[3]),n.moveTo(...e[4]),n.arc(i,s,p,l,u),n.lineTo(...e[6]),n.arc(i,s,y,u,l,!0),n.closePath(),n.moveTo(...e[8]),n.arc(i,s,m,l,u),n.arc(i,s,m,u,l,!0),n.moveTo(...e[10]),n.lineTo(...e[11]),n.moveTo(...e[12]),n.arc(i,s,b,l,u),n.arc(i,s,b,u,l,!0)}return n}const KL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u,transform:h}=s,{color:p,fill:m=p,stroke:y=p}=l,b=NV(l,["color","fill","stroke"]),w=BV(i,n);return Pa(r.createElement("path",{})).call(jn,b).style("d",w.toString()).style("stroke",y).style("fill",u||m).style("transform",h).call(jn,e).node()}};KL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var FV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function kV(e,t,n=4){const r=hp();if(!Ml(t))return r.moveTo(...e[2]),r.lineTo(...e[3]),r.lineTo(e[3][0]-n,e[3][1]),r.lineTo(e[10][0]-n,e[10][1]),r.lineTo(e[10][0]+n,e[10][1]),r.lineTo(e[3][0]+n,e[3][1]),r.lineTo(...e[3]),r.closePath(),r.moveTo(...e[10]),r.lineTo(...e[11]),r.moveTo(e[3][0]+n/2,e[8][1]),r.arc(e[3][0],e[8][1],n/2,0,Math.PI*2),r.closePath(),r;const i=t.getCenter(),[s,l]=i,u=Ve(i,e[3]),h=Ve(i,e[8]),p=Ve(i,e[10]),m=Mt(ge(e[2],i)),y=Math.asin(n/h),b=m-y,w=m+y;r.moveTo(...e[2]),r.lineTo(...e[3]),r.moveTo(Math.cos(b)*u+s,Math.sin(b)*u+l),r.arc(s,l,u,b,w),r.lineTo(Math.cos(w)*p+s,Math.sin(w)*p+l),r.arc(s,l,p,w,b,!0),r.lineTo(Math.cos(b)*u+s,Math.sin(b)*u+l),r.closePath(),r.moveTo(...e[10]),r.lineTo(...e[11]);const R=(b+w)/2;return r.moveTo(Math.cos(R)*(h+n/2)+s,Math.sin(R)*(h+n/2)+l),r.arc(Math.cos(R)*h+s,Math.sin(R)*h+l,n/2,R,Math.PI*2+R),r.closePath(),r}const qL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u,transform:h}=s,p=4,{color:m,fill:y=m,stroke:b=m}=l,w=FV(l,["color","fill","stroke"]),R=kV(i,n,p);return Pa(r.createElement("path",{})).call(jn,w).style("d",R.toString()).style("stroke",b).style("fill",u||y).style("transform",h).call(jn,e).node()}};qL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const QL={box:KL,violin:qL},JL=()=>(e,t,n,r)=>{const{x:i,y:s,y1:l,y2:u,y3:h,y4:p,series:m}=n,y=t.x,b=t.series,w=Array.from(e,R=>{const M=y.getBandWidth(y.invert(+i[R])),I=b?b.getBandWidth(b.invert(+(m==null?void 0:m[R]))):1,N=M*I,U=(+(m==null?void 0:m[R])||0)*M,Z=+i[R]+U+N/2,[Y,$,J,se,pe]=[+s[R],+l[R],+u[R],+h[R],+p[R]];return[[Z-N/2,pe],[Z+N/2,pe],[Z,pe],[Z,se],[Z-N/2,se],[Z+N/2,se],[Z+N/2,$],[Z-N/2,$],[Z-N/2,J],[Z+N/2,J],[Z,$],[Z,Y],[Z-N/2,Y],[Z+N/2,Y]].map(Ue=>r.map(Ue))});return[e,w]};JL.props={defaultShape:"box",defaultLabelShape:"label",composite:!1,shape:QL,channels:[...Nd({shapes:Object.keys(QL)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...ef(),{type:h1}],postInference:[...pf(),...j_()],interaction:{shareTooltip:!0}};const e6={vector:g3},t6=()=>(e,t,n,r)=>{const{x:i,y:s,size:l,rotate:u}=n,[h,p]=r.getSize(),m=e.map(y=>{const b=+u[y]/180*Math.PI,w=+l[y],R=w/h,M=w/p,I=R*Math.cos(b),N=-M*Math.sin(b);return[r.map([+i[y]-I/2,+s[y]-N/2]),r.map([+i[y]+I/2,+s[y]+N/2])]});return[e,m]};t6.props={defaultShape:"vector",defaultLabelShape:"label",composite:!1,shape:e6,channels:[...Nd({shapes:Object.keys(e6)}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[...ef()],postInference:[...pf(),...Zg()]};var n6=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function zV(e,t,n){return e.createElement("path",{style:Object.assign({d:`M ${t},${t} L -${t},0 L ${t},-${t} L 0,0 Z`,transformOrigin:"center"},n)})}function UV(e,t){if(!Ml(t))return ro().x(r=>r[0]).y(r=>r[1])(e);const n=t.getCenter();return BS()({startAngle:0,endAngle:Math.PI*2,outerRadius:Ve(e[0],n),innerRadius:Ve(e[1],n)})}function jV(e,t){if(!Ml(e))return t;const[n,r]=e.getCenter();return`translate(${n}, ${r}) ${t||""}`}const _3=(e,t)=>{const{arrow:n,arrowSize:r=4}=e,i=n6(e,["arrow","arrowSize"]),{coordinate:s,document:l}=t;return(u,h,p)=>{const{color:m,lineWidth:y}=p,b=n6(p,["color","lineWidth"]),{color:w=m,size:R=y}=h,M=n?zV(l,r,Object.assign({fill:i.stroke||w,stroke:i.stroke||w},po(i,"arrow"))):null,I=UV(u,s),N=jV(s,h.transform);return Pa(l.createElement("path",{})).call(jn,b).style("d",I).style("stroke",w).style("lineWidth",R).style("transform",N).style("markerEnd",M).call(jn,i).node()}};_3.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const r6=()=>(e,t)=>{const{data:n}=t;return!Array.isArray(n)||n.some(kx)?[e,t]:[e,ni({},t,{encode:{x:_c(n)}})]};r6.props={};const i6={line:_3},o6=e=>(t,n,r,i)=>{const{x:s}=r,l=p1(n,r,ni({style:{bandOffset:0}},e)),u=Array.from(t,h=>{const p=[s[h],1],m=[s[h],0];return[p,m].map(y=>i.map(l(y,h)))});return[t,u]};o6.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:i6,channels:[...V_({shapes:Object.keys(i6)}),{name:"x",required:!0}],preInference:[...ef(),{type:r6}],postInference:[...pf()]};const a6=()=>(e,t)=>{const{data:n}=t;return!Array.isArray(n)||n.some(kx)?[e,t]:[e,ni({},t,{encode:{y:_c(n)}})]};a6.props={};const s6={line:_3},l6=e=>(t,n,r,i)=>{const{y:s}=r,l=p1(n,r,ni({style:{bandOffset:0}},e)),u=Array.from(t,h=>{const p=[0,s[h]],m=[1,s[h]];return[p,m].map(y=>i.map(l(y,h)))});return[t,u]};l6.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:s6,channels:[...V_({shapes:Object.keys(s6)}),{name:"y",required:!0}],preInference:[...ef(),{type:a6}],postInference:[...pf()]};var c6=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function VV(e,t,n){return[["M",e,t],["L",e+2*n,t-n],["L",e+2*n,t+n],["Z"]]}function HV(e){return ro().x(t=>t[0]).y(t=>t[1])(e)}function ZV(e,t,n,r,i=0){const[[s,l],[u,h]]=t;if(gc(e)){const b=s+n,w=u+r,R=b+i;return[[b,l],[R,l],[R,h],[w,h]]}const p=l-n,m=h-r,y=p-i;return[[s,p],[s,y],[u,y],[u,m]]}const u6=(e,t)=>{const{offset:n=0,offset1:r=n,offset2:i=n,connectLength1:s,endMarker:l=!0}=e,u=c6(e,["offset","offset1","offset2","connectLength1","endMarker"]),{coordinate:h}=t;return(p,m,y)=>{const{color:b,connectLength1:w}=y,R=c6(y,["color","connectLength1"]),{color:M,transform:I}=m,N=ZV(h,p,r,i,s!=null?s:w),U=po(Object.assign(Object.assign({},u),y),"endMarker");return Pa(new Wi).call(jn,R).style("d",HV(N)).style("stroke",M||b).style("transform",I).style("markerEnd",l?new pl({className:"marker",style:Object.assign(Object.assign({},U),{symbol:VV})}):null).call(jn,u).node()}};u6.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const f6={connector:u6},h6=(...e)=>y3(...e);h6.props={defaultShape:"connector",defaultLabelShape:"label",composite:!1,shape:f6,channels:[...V_({shapes:Object.keys(f6)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...ef()],postInference:[...pf()]};function d6(e,t,n,r){if(t)return()=>[0,1];const{[e]:i,[`${e}1`]:s}=n;return l=>{var u;const h=((u=r.getBandWidth)===null||u===void 0?void 0:u.call(r,r.invert(+s[l])))||0;return[i[l],s[l]+h]}}function b3(e={}){const{extendX:t=!1,extendY:n=!1}=e;return(r,i,s,l)=>{const u=d6("x",t,s,i.x),h=d6("y",n,s,i.y),p=Array.from(r,m=>{const[y,b]=u(m),[w,R]=h(m);return[[y,w],[b,w],[b,R],[y,R]].map(Z=>l.map(Z))});return[r,p]}}const p6={range:d1},m6=()=>b3();m6.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:p6,channels:[...V_({shapes:Object.keys(p6)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...ef()],postInference:[...pf()]};const v6=()=>(e,t)=>{const{data:n}=t;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(kx))){const r=(i,s)=>Array.isArray(i[0])?i.map(l=>l[s]):[i[s]];return[e,ni({},t,{encode:{x:_c(r(n,0)),x1:_c(r(n,1))}})]}return[e,t]};v6.props={};const g6={range:d1},y6=()=>b3({extendY:!0});y6.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:g6,channels:[...V_({shapes:Object.keys(g6)}),{name:"x",required:!0}],preInference:[...ef(),{type:v6}],postInference:[...pf()]};const _6=()=>(e,t)=>{const{data:n}=t;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(kx))){const r=(i,s)=>Array.isArray(i[0])?i.map(l=>l[s]):[i[s]];return[e,ni({},t,{encode:{y:_c(r(n,0)),y1:_c(r(n,1))}})]}return[e,t]};_6.props={};const b6={range:d1},x6=()=>b3({extendX:!0});x6.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:b6,channels:[...V_({shapes:Object.keys(b6)}),{name:"y",required:!0}],preInference:[...ef(),{type:_6}],postInference:[...pf()]};var E6=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const x3=(e,t)=>{const{arrow:n,colorAttribute:r}=e,i=E6(e,["arrow","colorAttribute"]),{coordinate:s,document:l}=t;return(u,h,p)=>{const{color:m,stroke:y}=p,b=E6(p,["color","stroke"]),{d:w,color:R=m}=h,[M,I]=s.getSize();return Pa(l.createElement("path",{})).call(jn,b).style("d",typeof w=="function"?w({width:M,height:I}):w).style(r,R).call(jn,i).node()}};x3.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const S6=(e,t)=>x3(Object.assign({colorAttribute:"fill"},e),t);S6.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const T6=(e,t)=>x3(Object.assign({fill:"none",colorAttribute:"stroke"},e),t);T6.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const w6={path:S6,hollow:T6},A6=e=>(t,n,r,i)=>[t,t.map(()=>[[0,0]])];A6.props={defaultShape:"path",defaultLabelShape:"label",shape:w6,composite:!1,channels:[...Nd({shapes:Object.keys(w6)}),{name:"d",scale:"identity"}],preInference:[...ef()],postInference:[...pf()]};var WV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const C6=(e,t)=>{const{render:n}=e,r=WV(e,["render"]);return i=>{const[[s,l]]=i;return n(Object.assign(Object.assign({},r),{x:s,y:l}),t)}};C6.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const O6=()=>(e,t)=>{const{style:n={}}=t;return[e,ni({},t,{style:Object.assign(Object.assign({},n),Object.fromEntries(Object.entries(n).filter(([,r])=>typeof r=="function").map(([r,i])=>[r,()=>i])))})]};O6.props={};const GV={shape:C6},R6=e=>{const{cartesian:t}=e;return t?r3:(n,r,i,s)=>{const{x:l,y:u}=i,h=p1(r,i,e),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};R6.props={defaultShape:"shape",defaultLabelShape:"label",composite:!1,shape:GV,channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[...ef(),{type:pT},{type:mT},{type:O6}]};var XV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const M6=(e,t)=>{const{document:n}=t;return(r,i,s)=>{const{transform:l}=i,{color:u}=s,h=XV(s,["color"]),{color:p=u}=i,[m,...y]=r,b=hp();return b.moveTo(...m),y.forEach(([w,R])=>{b.lineTo(w,R)}),b.closePath(),Pa(n.createElement("path",{})).call(jn,h).style("d",b.toString()).style("stroke",p||u).style("fill",p||u).style("fillOpacity",.4).style("transform",l).call(jn,e).node()}};M6.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const P6={density:M6},I6=()=>(e,t,n,r)=>{const{x:i,series:s}=n,l=Object.entries(n).filter(([y])=>y.startsWith("y")).map(([,y])=>y),u=Object.entries(n).filter(([y])=>y.startsWith("size")).map(([,y])=>y);if(i===void 0||l===void 0||u===void 0)throw new Error("Missing encode for x or y or size channel.");const h=t.x,p=t.series,m=Array.from(e,y=>{const b=h.getBandWidth(h.invert(+i[y])),w=p?p.getBandWidth(p.invert(+(s==null?void 0:s[y]))):1,R=b*w,M=(+(s==null?void 0:s[y])||0)*b,I=+i[y]+M+R/2;return[...l.map((U,Z)=>[I+ +u[Z][y]/e.length,+l[Z][y]]),...l.map((U,Z)=>[I-+u[Z][y]/e.length,+l[Z][y]]).reverse()].map(U=>r.map(U))});return[e,m]};I6.props={defaultShape:"density",defaultLabelShape:"label",composite:!1,shape:P6,channels:[...Nd({shapes:Object.keys(P6)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"series",scale:"band"},{name:"size",required:!0,scale:"identity"}],preInference:[...ef(),{type:zx},{type:h1}],postInference:[...pf(),...j_()],interaction:{shareTooltip:!0}};function L6(e){var t,n,r,i=e||1;function s(u,h){++t>i&&(r=n,l(1),++t),n[u]=h}function l(u){t=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var h=n[u];if(h!==void 0)return h;if((h=r[u])!==void 0)return s(u,h),h},set:function(u,h){n[u]!==void 0?n[u]=h:s(u,h)}}}const Lte=L6(3);function YV(e,t=(...r)=>`${r[0]}`,n=16){const r=L6(n);return(...i)=>{const s=t(...i);let l=r.get(s);return r.has(s)?r.get(s):(l=e(...i),r.set(s,l),l)}}function $V(e){return typeof e=="string"?e.split(" ").map(t=>{const[n,r]=t.split(":");return[+n,r]}):e}function vT(e,t,n){const r=e?e():document.createElement("canvas");return r.width=t,r.height=n,r}const KV=YV((e,t,n)=>{const r=vT(n,e*2,e*2),i=r.getContext("2d"),s=e,l=e;if(t===1)i.beginPath(),i.arc(s,l,e,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{const u=i.createRadialGradient(s,l,e*t,s,l,e);u.addColorStop(0,"rgba(0,0,0,1)"),u.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=u,i.fillRect(0,0,2*e,2*e)}return r},e=>`${e}`);function qV(e,t){const r=vT(t,256,1).getContext("2d"),i=r.createLinearGradient(0,0,256,1);return $V(e).forEach(([s,l])=>{i.addColorStop(s,l)}),r.fillStyle=i,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data}function QV(e,t,n,r,i,s){const{blur:l}=i;let u=r.length;for(;u--;){const{x:h,y:p,value:m,radius:y}=r[u],b=Math.min(m,n),w=h-y,R=p-y,M=KV(y,1-l,s),I=(b-t)/(n-t);e.globalAlpha=Math.max(I,.001),e.drawImage(M,w,R)}return e}function JV(e,t,n,r,i){const{minOpacity:s,opacity:l,maxOpacity:u,useGradientOpacity:h}=i,p=0,m=0,y=t,b=n,w=e.getImageData(p,m,y,b),R=w.data,M=R.length;for(let I=3;I<M;I+=4){const N=R[I],U=N*4;if(!U)continue;const Z=l||Math.max(0,Math.min(u,Math.max(s,N)));R[I-3]=r[U],R[I-2]=r[U+1],R[I-1]=r[U+2],R[I]=h?r[U+3]:Z}return w}function eH(e,t,n,r,i,s,l){const u=Object.assign({blur:.85,minOpacity:0,opacity:.6,maxOpacity:1,gradient:[[.25,"rgb(0,0,255)"],[.55,"rgb(0,255,0)"],[.85,"yellow"],[1,"rgb(255,0,0)"]]},s);u.minOpacity*=255,u.opacity*=255,u.maxOpacity*=255;const p=vT(l,e,t).getContext("2d"),m=qV(u.gradient,l);p.clearRect(0,0,e,t),QV(p,n,r,i,u,l);const y=JV(p,e,t,m,u),w=vT(l,e,t).getContext("2d");return w.putImageData(y,0,0),w}var tH=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function nH(e,t){return Object.keys(e).reduce((n,r)=>{const i=e[r];return t(i,r)||(n[r]=i),n},{})}const D6=(e,t)=>{const{gradient:n,opacity:r,maxOpacity:i,minOpacity:s,blur:l,useGradientOpacity:u}=e,h=tH(e,["gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity"]),{coordinate:p,createCanvas:m,document:y}=t;return(b,w,R)=>{const{transform:M}=w,[I,N]=p.getSize(),U=b.map(se=>({x:se[0],y:se[1],value:se[2],radius:se[3]})),Z=Zp(b,se=>se[2]),Y=Sl(b,se=>se[2]),J=I&&N?eH(I,N,Z,Y,U,nH({gradient:n,opacity:r,minOpacity:s,maxOpacity:i,blur:l,useGradientOpacity:u},se=>se===void 0),m):{canvas:null};return Pa(y.createElement("image",{})).call(jn,R).style("x",0).style("y",0).style("width",I).style("height",N).style("src",J.canvas).style("transform",M).call(jn,h).node()}};D6.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const N6={heatmap:D6},B6=e=>(t,n,r,i)=>{const{x:s,y:l,size:u,color:h}=r,p=Array.from(t,m=>{const y=u?+u[m]:40;return[...i.map([+s[m],+l[m]]),h[m],y]});return[[0],[p]]};B6.props={defaultShape:"heatmap",defaultLabelShape:"label",composite:!1,shape:N6,channels:[...Nd({shapes:Object.keys(N6)}),{name:"x",required:!0},{name:"y",required:!0},{name:"color",scale:"identity",required:!0},{name:"size"}],preInference:[...ef(),{type:h1},{type:dT}],postInference:[...pf(),...Zg()]};var rH=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},iH=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function oH(e,t){const{text:n="text",value:r="value"}=t;return e.map(i=>Object.assign(Object.assign({},i),{text:i[n],value:i[r]}))}const aH=()=>({axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size",shape:"tag"},scale:{x:{range:[0,1]},y:{range:[0,1]}},style:{fontFamily:e=>e.fontFamily}}),E3=(e,t)=>rH(void 0,void 0,void 0,function*(){const{width:n,height:r}=t,{data:i,encode:s={},scale:l,style:u={},layout:h={}}=e,p=iH(e,["data","encode","scale","style","layout"]),m=oH(i,s);return ni({},aH(),Object.assign(Object.assign({data:{value:m,transform:[Object.assign({type:"wordCloud",size:[n,r]},h)]},encode:s,scale:l,style:u},p),{axis:!1}))});E3.props={};const F6=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];F6.props={};const k6=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];k6.props={};const z6=e=>new hh(e);z6.props={};const gT=Symbol("defaultUnknown");function U6(e,t,n){for(let r=0;r<t.length;r+=1)e.has(t[r])||e.set(n(t[r]),r)}function j6(e){const{value:t,from:n,to:r,mapper:i,notFoundReturn:s}=e;let l=i.get(t);if(l===void 0){if(s!==gT)return s;l=n.push(t)-1,i.set(t,l)}return r[l%r.length]}function V6(e){return e instanceof Date?t=>`${t}`:typeof e=="object"?t=>JSON.stringify(t):t=>t}class yT extends Hy{getDefaultOptions(){return{domain:[],range:[],unknown:gT}}constructor(t){super(t)}map(t){return this.domainIndexMap.size===0&&U6(this.domainIndexMap,this.getDomain(),this.domainKey),j6({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return this.rangeIndexMap.size===0&&U6(this.rangeIndexMap,this.getRange(),this.rangeKey),j6({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[n]=this.options.domain,[r]=this.options.range;if(this.domainKey=V6(n),this.rangeKey=V6(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!t||t.range)&&this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new yT(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:n}=this.options;return this.sortedDomain=n?[...t].sort(n):t,this.sortedDomain}}const H6=e=>new yT(e);H6.props={};function Z6({map:e,initKey:t},n){const r=t(n);return e.has(r)?e.get(r):n}function sH({map:e,initKey:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function lH({map:e,initKey:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function cH(e){return typeof e=="object"?e.valueOf():e}class W6 extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=cH,t!==null)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Z6({map:this.map,initKey:this.initKey},t))}has(t){return super.has(Z6({map:this.map,initKey:this.initKey},t))}set(t,n){return super.set(sH({map:this.map,initKey:this.initKey},t),n)}delete(t){return super.delete(lH({map:this.map,initKey:this.initKey},t))}}function uH(e){const t=Math.min(...e);return e.map(n=>n/t)}function fH(e,t){const n=e.length,r=t-n;return r>0?[...e,...new Array(r).fill(1)]:r<0?e.slice(0,t):e}function hH(e){return Math.round(e*1e12)/1e12}function dH(e){const{domain:t,range:n,paddingOuter:r,paddingInner:i,flex:s,round:l,align:u}=e,h=t.length,p=fH(s,h),[m,y]=n,b=y-m,w=2/h*r+1-1/h*i,R=b/w,M=R*i/h,I=R-h*M,N=uH(p),U=N.reduce((lt,Ge)=>lt+Ge),Z=I/U,Y=new W6(t.map((lt,Ge)=>{const at=N[Ge]*Z;return[lt,l?Math.floor(at):at]})),$=new W6(t.map((lt,Ge)=>{const st=N[Ge]*Z+M;return[lt,l?Math.floor(st):st]})),J=Array.from($.values()).reduce((lt,Ge)=>lt+Ge),pe=(b-(J-J/h*i))*u,Ce=m+pe;let Ue=l?Math.round(Ce):Ce;const Je=new Array(h);for(let lt=0;lt<h;lt+=1){Je[lt]=hH(Ue);const Ge=t[lt];Ue+=$.get(Ge)}return{valueBandWidth:Y,valueStep:$,adjustedRange:Je}}function pH(e){var t;const{domain:n}=e,r=n.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((t=e.flex)===null||t===void 0)&&t.length))return dH(e);const{range:s,paddingOuter:l,paddingInner:u,round:h,align:p}=e;let m,y,b=s[0];const R=s[1]-b,M=l*2,I=r-u;m=R/Math.max(1,M+I),h&&(m=Math.floor(m)),b+=(R-m*(r-u))*p,y=m*(1-u),h&&(b=Math.round(b),y=Math.round(y));const N=new Array(r).fill(0).map((U,Z)=>b+Z*m);return{valueStep:m,valueBandWidth:y,adjustedRange:N}}class Wg extends yT{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:gT,flex:[]}}constructor(t){super(t)}clone(){return new Wg(this.options)}getStep(t){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:t===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:t===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:n}=this.options;return t>0?t:n}getPaddingOuter(){const{padding:t,paddingOuter:n}=this.options;return t>0?t:n}rescale(){super.rescale();const{align:t,domain:n,range:r,round:i,flex:s}=this.options,{adjustedRange:l,valueBandWidth:u,valueStep:h}=pH({align:t,range:r,round:i,flex:s,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:n});this.valueStep=h,this.valueBandWidth=u,this.adjustedRange=l}}const G6=e=>new Wg(e);G6.props={};class _T extends Hy{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:yx}}map(t){return d_(t)?t:this.options.unknown}invert(t){return this.map(t)}clone(){return new _T(this.options)}getTicks(){const{domain:t,tickCount:n,tickMethod:r}=this.options,[i,s]=t;return!(0,Ft.Z)(i)||!(0,Ft.Z)(s)?[]:r(i,s,n)}}const X6=e=>new _T(e);X6.props={};class S3 extends Wg{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:gT,paddingInner:1,paddingOuter:0}}constructor(t){super(t)}getPaddingInner(){return 1}clone(){return new S3(this.options)}update(t){super.update(t)}getPaddingOuter(){return this.options.padding}}const Y6=e=>new S3(e);Y6.props={};var $6=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Gg="\\d\\d?",Xg="\\d\\d",mH="\\d{3}",vH="\\d{4}",Vx="[^\\s]+",K6=/\[([^]*?)\]/gm;function q6(e,t){for(var n=[],r=0,i=e.length;r<i;r++)n.push(e[r].substr(0,t));return n}var Q6=function(e){return function(t,n){var r=n[e].map(function(s){return s.toLowerCase()}),i=r.indexOf(t.toLowerCase());return i>-1?i:null}};function m1(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var s=i[r];for(var l in s)e[l]=s[l]}return e}var J6=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],eD=["January","February","March","April","May","June","July","August","September","October","November","December"],gH=q6(eD,3),yH=q6(J6,3),tD={dayNamesShort:yH,dayNames:J6,monthNamesShort:gH,monthNames:eD,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!==10?1:0)*e%10]}},bT=m1({},tD),_H=function(e){return bT=m1(bT,e)},nD=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},dp=function(e,t){for(t===void 0&&(t=2),e=String(e);e.length<t;)e="0"+e;return e},bH={D:function(e){return String(e.getDate())},DD:function(e){return dp(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return dp(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return dp(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return dp(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return dp(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return dp(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return dp(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return dp(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return dp(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return dp(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return dp(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+dp(Math.floor(Math.abs(t)/60)*100+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+dp(Math.floor(Math.abs(t)/60),2)+":"+dp(Math.abs(t)%60,2)}},rD=function(e){return+e-1},iD=[null,Gg],oD=[null,Vx],aD=["isPm",Vx,function(e,t){var n=e.toLowerCase();return n===t.amPm[0]?0:n===t.amPm[1]?1:null}],sD=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var n=+t[1]*60+parseInt(t[2],10);return t[0]==="+"?n:-n}return 0}],xH={D:["day",Gg],DD:["day",Xg],Do:["day",Gg+Vx,function(e){return parseInt(e,10)}],M:["month",Gg,rD],MM:["month",Xg,rD],YY:["year",Xg,function(e){var t=new Date,n=+(""+t.getFullYear()).substr(0,2);return+(""+(+e>68?n-1:n)+e)}],h:["hour",Gg,void 0,"isPm"],hh:["hour",Xg,void 0,"isPm"],H:["hour",Gg],HH:["hour",Xg],m:["minute",Gg],mm:["minute",Xg],s:["second",Gg],ss:["second",Xg],YYYY:["year",vH],S:["millisecond","\\d",function(e){return+e*100}],SS:["millisecond",Xg,function(e){return+e*10}],SSS:["millisecond",mH],d:iD,dd:iD,ddd:oD,dddd:oD,MMM:["month",Vx,Q6("monthNamesShort")],MMMM:["month",Vx,Q6("monthNames")],a:aD,A:aD,ZZ:sD,Z:sD},xT={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},EH=function(e){return m1(xT,e)},lD=function(e,t,n){if(t===void 0&&(t=xT.default),n===void 0&&(n={}),typeof e=="number"&&(e=new Date(e)),Object.prototype.toString.call(e)!=="[object Date]"||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");t=xT[t]||t;var r=[];t=t.replace(K6,function(s,l){return r.push(l),"@@@"});var i=m1(m1({},bT),n);return t=t.replace($6,function(s){return bH[s](e,i)}),t.replace(/@@@/g,function(){return r.shift()})};function SH(e,t,n){if(n===void 0&&(n={}),typeof t!="string")throw new Error("Invalid format in fecha parse");if(t=xT[t]||t,e.length>1e3)return null;var r=new Date,i={year:r.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},s=[],l=[],u=t.replace(K6,function(Y,$){return l.push(nD($)),"@@@"}),h={},p={};u=nD(u).replace($6,function(Y){var $=xH[Y],J=$[0],se=$[1],pe=$[3];if(h[J])throw new Error("Invalid format. "+J+" specified twice in format");return h[J]=!0,pe&&(p[pe]=!0),s.push($),"("+se+")"}),Object.keys(p).forEach(function(Y){if(!h[Y])throw new Error("Invalid format. "+Y+" is required in specified format")}),u=u.replace(/@@@/g,function(){return l.shift()});var m=e.match(new RegExp(u,"i"));if(!m)return null;for(var y=m1(m1({},bT),n),b=1;b<m.length;b++){var w=s[b-1],R=w[0],M=w[2],I=M?M(m[b],y):+m[b];if(I==null)return null;i[R]=I}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);var N;if(i.timezoneOffset==null){N=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var U=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],b=0,Z=U.length;b<Z;b++)if(h[U[b][0]]&&i[U[b][0]]!==N[U[b][1]]())return null}else if(N=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return N}var Dte={format:lD,parse:SH,defaultI18n:tD,setGlobalDateI18n:_H,setGlobalDateMasks:EH},Nte=null;const Hx=1e3,Zx=Hx*60,Wx=Zx*60,v1=Wx*24,Gx=v1*7,cD=v1*30,uD=v1*365;function dd(e,t,n,r){const i=(p,m)=>{const y=w=>r(w)%m===0;let b=m;for(;b&&!y(p);)n(p,-1),b-=1;return p},s=(p,m)=>{m&&i(p,m),t(p)},l=(p,m)=>{const y=new Date(+p);return s(y,m),y},u=(p,m)=>{const y=new Date(+p-1);return s(y,m),n(y,m),s(y),y};return{ceil:u,floor:l,range:(p,m,y,b)=>{const w=[],R=Math.floor(y),M=b?u(p,y):u(p);for(let I=M;I<m;n(I,R),s(I))w.push(new Date(+I));return w},duration:e}}const TH=dd(1,e=>e,(e,t=1)=>{e.setTime(+e+t)},e=>e.getTime()),wH=dd(Hx,e=>{e.setMilliseconds(0)},(e,t=1)=>{e.setTime(+e+Hx*t)},e=>e.getSeconds()),AH=dd(Zx,e=>{e.setSeconds(0,0)},(e,t=1)=>{e.setTime(+e+Zx*t)},e=>e.getMinutes()),CH=dd(Wx,e=>{e.setMinutes(0,0,0)},(e,t=1)=>{e.setTime(+e+Wx*t)},e=>e.getHours()),OH=dd(v1,e=>{e.setHours(0,0,0,0)},(e,t=1)=>{e.setTime(+e+v1*t)},e=>e.getDate()-1),fD=dd(cD,e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t=1)=>{const n=e.getMonth();e.setMonth(n+t)},e=>e.getMonth()),RH=dd(Gx,e=>{e.setDate(e.getDate()-e.getDay()%7),e.setHours(0,0,0,0)},(e,t=1)=>{e.setDate(e.getDate()+7*t)},e=>{const t=fD.floor(e),n=new Date(+e);return Math.floor((+n-+t)/Gx)}),MH=dd(uD,e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t=1)=>{const n=e.getFullYear();e.setFullYear(n+t)},e=>e.getFullYear()),hD={millisecond:TH,second:wH,minute:AH,hour:CH,day:OH,week:RH,month:fD,year:MH},PH=dd(1,e=>e,(e,t=1)=>{e.setTime(+e+t)},e=>e.getTime()),IH=dd(Hx,e=>{e.setUTCMilliseconds(0)},(e,t=1)=>{e.setTime(+e+Hx*t)},e=>e.getUTCSeconds()),LH=dd(Zx,e=>{e.setUTCSeconds(0,0)},(e,t=1)=>{e.setTime(+e+Zx*t)},e=>e.getUTCMinutes()),DH=dd(Wx,e=>{e.setUTCMinutes(0,0,0)},(e,t=1)=>{e.setTime(+e+Wx*t)},e=>e.getUTCHours()),NH=dd(v1,e=>{e.setUTCHours(0,0,0,0)},(e,t=1)=>{e.setTime(+e+v1*t)},e=>e.getUTCDate()-1),dD=dd(cD,e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t=1)=>{const n=e.getUTCMonth();e.setUTCMonth(n+t)},e=>e.getUTCMonth()),BH=dd(Gx,e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7)%7),e.setUTCHours(0,0,0,0)},(e,t=1)=>{e.setTime(+e+Gx*t)},e=>{const t=dD.floor(e),n=new Date(+e);return Math.floor((+n-+t)/Gx)}),FH=dd(uD,e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t=1)=>{const n=e.getUTCFullYear();e.setUTCFullYear(n+t)},e=>e.getUTCFullYear()),pD={millisecond:PH,second:IH,minute:LH,hour:DH,day:NH,week:BH,month:dD,year:FH};function kH(e){const t=e?pD:hD,{year:n,month:r,week:i,day:s,hour:l,minute:u,second:h,millisecond:p}=t;return{tickIntervals:[[h,1],[h,5],[h,15],[h,30],[u,1],[u,5],[u,15],[u,30],[l,1],[l,3],[l,6],[l,12],[s,1],[s,2],[i,1],[r,1],[r,3],[n,1]],year:n,millisecond:p}}function mD(e,t,n,r,i){const s=+e,l=+t,{tickIntervals:u,year:h,millisecond:p}=kH(i),m=([I,N])=>I.duration*N,y=r?(l-s)/r:n||5,b=r||(l-s)/y,w=u.length,R=Jb(u,b,0,w,m);let M;if(R===w){const I=KE(s/h.duration,l/h.duration,y);M=[h,I]}else if(R){const I=b/m(u[R-1])<m(u[R])/b,[N,U]=I?u[R-1]:u[R],Z=r?Math.ceil(r/N.duration):U;M=[N,Z]}else{const I=Math.max(KE(s,l,y),1);M=[p,I]}return M}const zH=(e,t,n,r,i)=>{const s=e>t,l=s?t:e,u=s?e:t,[h,p]=mD(l,u,n,r,i),m=h.range(l,new Date(+u+1),p,!0);return s?m.reverse():m},UH=(e,t,n,r,i)=>{const s=e>t,l=s?t:e,u=s?e:t,[h,p]=mD(l,u,n,r,i),m=[h.floor(l,p),h.ceil(u,p)];return s?m.reverse():m};function jH(e,t){const{second:n,minute:r,hour:i,day:s,week:l,month:u,year:h}=t;return n.floor(e)<e?".SSS":r.floor(e)<e?":ss":i.floor(e)<e?"hh:mm":s.floor(e)<e?"hh A":u.floor(e)<e?l.floor(e)<e?"MMM DD":"ddd DD":h.floor(e)<e?"MMMM":"YYYY"}function VH(e){const t=e.getTimezoneOffset(),n=new Date(e);return n.setMinutes(n.getMinutes()+t,n.getSeconds(),n.getMilliseconds()),n}class T3 extends p_{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:zH,interpolate:E0,mask:void 0,utc:!1}}chooseTransforms(){return[r=>+r,r=>new Date(r)]}chooseNice(){return UH}getTickMethodOptions(){const{domain:t,tickCount:n,tickInterval:r,utc:i}=this.options,s=t[0],l=t[t.length-1];return[s,l,n,r,i]}getFormatter(){const{mask:t,utc:n}=this.options,r=n?pD:hD,i=n?VH:Rv;return s=>lD(i(s),t||jH(s,r))}clone(){return new T3(this.options)}}const vD=e=>new T3(e);vD.props={};const gD=e=>t=>-e(-t),w3=(e,t)=>{const n=Math.log(e),r=e===Math.E?Math.log:e===10?Math.log10:e===2?Math.log2:i=>Math.log(i)/n;return t?gD(r):r},A3=(e,t)=>{const n=e===Math.E?Math.exp:r=>vf(e,r);return t?gD(n):n},HH=(e,t,n,r=10)=>{const i=e<0,s=A3(r,i),l=w3(r,i),u=t<e,h=u?t:e,p=u?e:t;let m=l(h),y=l(p),b=[];if(!(r%1)&&y-m<n){if(m=Math.floor(m),y=Math.ceil(y),i)for(;m<=y;m+=1){const w=s(m);for(let R=r-1;R>=1;R-=1){const M=w*R;if(M>p)break;M>=h&&b.push(M)}}else for(;m<=y;m+=1){const w=s(m);for(let R=1;R<r;R+=1){const M=w*R;if(M>p)break;M>=h&&b.push(M)}}b.length*2<n&&(b=Mv(h,p,n))}else{const w=n===-1?y-m:Math.min(y-m,n);b=Mv(m,y,w).map(s)}return u?b.reverse():b},ZH=(e,t,n,r)=>{const i=e<0,s=w3(r,i),l=A3(r,i),u=e>t,h=u?t:e,p=u?e:t,m=[l(Math.floor(s(h))),l(Math.ceil(s(p)))];return u?m.reverse():m};class C3 extends p_{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:up,tickMethod:HH,tickCount:5}}chooseNice(){return ZH}getTickMethodOptions(){const{domain:t,tickCount:n,base:r}=this.options,i=t[0],s=t[t.length-1];return[i,s,n,r]}chooseTransforms(){const{base:t,domain:n}=this.options,r=n[0]<0;return[w3(t,r),A3(t,r)]}clone(){return new C3(this.options)}}const yD=e=>new C3(e);yD.props={};const WH=e=>t=>t<0?-vf(-t,e):vf(t,e),GH=e=>t=>t<0?-vf(-t,1/e):vf(t,1/e),XH=e=>e<0?-Math.sqrt(-e):Math.sqrt(e);class ET extends p_{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:up,tickMethod:Mv,tickCount:5}}constructor(t){super(t)}chooseTransforms(){const{exponent:t}=this.options;if(t===1)return[Rv,Rv];const n=t===.5?XH:WH(t),r=GH(t);return[n,r]}clone(){return new ET(this.options)}}const _D=e=>new ET(e);_D.props={};class O3 extends ET{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:up,tickMethod:Mv,tickCount:5,exponent:.5}}constructor(t){super(t)}update(t){super.update(t)}clone(){return new O3(this.options)}}const bD=e=>new O3(e);bD.props={};const xD=e=>new Ig(e);xD.props={};const ED=e=>new Ng(e);ED.props={};const SD=e=>new Dg(e);SD.props={};const YH=e=>t=>{const n=e(t);return(0,Ft.Z)(n)?Math.round(n):n};function $H(e,t){return n=>{n.prototype.rescale=function(){this.initRange(),this.nice();const[r]=this.chooseTransforms();this.composeOutput(r,this.chooseClamp(r))},n.prototype.initRange=function(){const{interpolator:r}=this.options;this.options.range=e(r)},n.prototype.composeOutput=function(r,i){const{domain:s,interpolator:l,round:u}=this.getOptions(),h=t(s.map(r)),p=u?YH(l):l;this.output=Ag(p,h,i,r)},n.prototype.invert=void 0}}var KH=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},R3;function qH(e){return[e(0),e(1)]}const QH=e=>{const[t,n]=e;return Ag(E0(0,1),u_(t,n))};let M3=R3=class extends hh{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Rv,tickMethod:Mv,tickCount:5}}constructor(t){super(t)}clone(){return new R3(this.options)}};M3=R3=KH([$H(qH,QH)],M3);const TD=e=>new M3(e);TD.props={};const wD=e=>new r1(e);wD.props={};function P3({colorDefault:e,colorBlack:t,colorWhite:n,colorStroke:r,colorBackground:i,padding1:s,padding2:l,padding3:u,alpha90:h,alpha65:p,alpha45:m,alpha25:y,alpha10:b,category10:w,category20:R,sizeDefault:M=1,padding:I="auto",margin:N=16}){return{padding:I,margin:N,size:M,color:e,category10:w,category20:R,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},view:{viewFill:i,plotFill:"transparent",mainFill:"transparent",contentFill:"transparent"},line:{line:{fill:"",strokeOpacity:1,lineWidth:1,lineCap:"round"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,strokeOpacity:.95,lineWidth:1},plus:{r:3,strokeOpacity:.95,lineWidth:3},diamond:{r:3,strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:t,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,lineWidth:0,connectorStroke:r,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:r,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,lineWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:r,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:r,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:r,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:r,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:r,endMarkerFillOpacity:.95}},axis:{arrow:!1,gridLineDash:[3,4],gridLineWidth:.5,gridStroke:t,gridStrokeOpacity:b,labelAlign:"horizontal",labelFill:t,labelOpacity:m,labelFontSize:12,labelFontWeight:"normal",labelSpacing:s,line:!1,lineLineWidth:.5,lineStroke:t,lineStrokeOpacity:m,tickLength:4,tickLineWidth:1,tickStroke:t,tickOpacity:m,titleFill:t,titleOpacity:h,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,titleTransformOrigin:"center",lineArrowOffset:6,lineArrowSize:6},axisTop:{gridDirection:"positive",labelDirection:"negative",tickDirection:"negative",titlePosition:"top",titleSpacing:12,labelSpacing:4,titleTextBaseline:"middle"},axisBottom:{gridDirection:"negative",labelDirection:"positive",tickDirection:"positive",titlePosition:"bottom",titleSpacing:12,labelSpacing:4,titleTextBaseline:"bottom",titleTransform:"translate(0, 8)"},axisLeft:{gridDirection:"positive",labelDirection:"negative",labelSpacing:4,tickDirection:"negative",titlePosition:"left",titleSpacing:12,titleTextBaseline:"middle",titleDirection:"vertical",titleTransform:"rotate(-90) translate(0, -8)",titleTransformOrigin:"center"},axisRight:{gridDirection:"negative",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",titlePosition:"right",titleSpacing:12,titleTextBaseline:"top",titleDirection:"vertical",titleTransformOrigin:"center"},axisLinear:{girdClosed:!0,gridConnect:"arc",gridDirection:"negative",gridType:"surround",titlePosition:"top",titleSpacing:0},axisArc:{title:!1,titlePosition:"inner",line:!1,tick:!0,labelSpacing:4},axisRadar:{girdClosed:!0,gridStrokeOpacity:.3,gridType:"surround",label:!1,tick:!1,titlePosition:"start"},legendCategory:{backgroundFill:"transparent",itemBackgroundFill:"transparent",itemLabelFill:t,itemLabelFillOpacity:h,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[s,s],itemValueFill:t,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",navButtonFill:t,navButtonFillOpacity:.65,navPageNumFill:t,navPageNumFillOpacity:.45,navPageNumFontSize:12,padding:8,title:!1,titleFill:t,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,tickStroke:t,tickStrokeOpacity:.25,rowPadding:s,colPadding:l,maxRows:3,maxCols:3},legendContinuous:{handleHeight:12,handleLabelFill:t,handleLabelFillOpacity:m,handleLabelFontSize:12,handleLabelFontWeight:"normal",handleMarkerFill:t,handleMarkerFillOpacity:.6,handleMarkerLineWidth:1,handleMarkerStroke:t,handleMarkerStrokeOpacity:.25,handleWidth:10,labelFill:t,labelFillOpacity:m,labelFontSize:12,labelFontWeight:"normal",labelSpacing:3,tick:!0,tickLength:12,ribbonSize:12,ribbonFill:"#aaa",handle:!0,handleLabel:!1,handleShape:"slider",handleIconSize:12/1.8,indicator:!1,titleFontSize:12,titleSpacing:4,titleFontWeight:"normal",titleFillOpacity:h,tickStroke:t,tickStrokeOpacity:m},label:{fill:t,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:void 0,offset:12,connectorStroke:t,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength:12,connectorLength2:8,connectorDistance:4},innerLabel:{fill:n,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:void 0,offset:0},htmlLabel:{fontSize:12,opacity:.65,color:t,fontWeight:"normal"},slider:{trackSize:16,trackFill:r,trackFillOpacity:1,selectionFill:e,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:t,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:t,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{padding:[0,0,0,0],trackSize:6,isRound:!0,slidable:!0,scrollable:!0,trackFill:"#e5e5e5",trackFillOpacity:0,thumbFill:"#000",thumbFillOpacity:.15,thumbHighlightedFillOpacity:.2},title:{spacing:8,titleFill:t,titleFillOpacity:h,titleFontSize:16,titleFontWeight:"bold",titleTextBaseline:"top",subtitleFill:t,subtitleFillOpacity:p,subtitleFontSize:12,subtitleFontWeight:"normal",subtitleTextBaseline:"top"},tooltip:{css:{".g2-tooltip":{"font-family":"sans-serif"}}}}}const JH=P3({colorBlack:"#1D2129",colorWhite:"#ffffff",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),I3=e=>ni({},JH,e);I3.props={};const AD=e=>ni({},I3(),{category10:"category10",category20:"category20"},e);AD.props={};const eZ=P3({colorBlack:"#fff",colorWhite:"#000",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.25}),CD=e=>ni({},eZ,{tooltip:{crosshairsStroke:"#fff",crosshairsLineWidth:1,crosshairsStrokeOpacity:.25,css:{".g2-tooltip":{background:"#1f1f1f",opacity:.95},".g2-tooltip-title":{color:"#A6A6A6"},".g2-tooltip-list-item-name-label":{color:"#A6A6A6"},".g2-tooltip-list-item-value":{color:"#A6A6A6"}}}},e),OD=e=>Object.assign({},CD(),{category10:"category10",category20:"category20"},e);OD.props={};const tZ=P3({colorBlack:"#000",colorWhite:"#fff",colorStroke:"#888",colorDefault:"#4e79a7",colorBackground:"transparent",category10:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],category20:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),RD=e=>ni({},tZ,{text:{text:{fontSize:10}},axis:{gridLineDash:[0,0],gridLineWidth:1,gridStroke:"#ddd",gridStrokeOpacity:1,labelOpacity:1,labelStrokeOpacity:1,labelFontSize:10,line:!0,lineLineWidth:1,lineStroke:"#888",lineStrokeOpacity:1,tickLength:5,tickStrokeOpacity:1,titleOpacity:1,titleStrokeOpacity:1,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},axisLeft:{gridFilter:(t,n)=>n!==0},axisRight:{gridFilter:(t,n)=>n!==0},legendCategory:{itemLabelFillOpacity:1,itemLabelFontSize:10,itemValueFillOpacity:1,itemValueFontSize:10,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},legendContinuous:{handleLabelFontSize:10,labelFillOpacity:.45,labelFontSize:10},label:{fontSize:10},innerLabel:{fontSize:10},htmlLabel:{fontSize:10},slider:{handleLabelFontSize:10,trackFillOpacity:.05}},e);RD.props={};const MD=e=>(...t)=>{const n=Um(Object.assign({},{crossPadding:50},e))(...t);return iS(n,e),n};MD.props=Object.assign(Object.assign({},Um.props),{defaultPosition:"bottom"});function zte(){}const PD=e=>(...t)=>{const n=Um(Object.assign({},{crossPadding:10},e))(...t);return iS(n,e),n};PD.props=Object.assign(Object.assign({},Um.props),{defaultPosition:"left"});var L3=function(){},nZ=function(e,t,n){var r=e,i=bi(t)?t.split("."):t;return i.forEach(function(s,l){l<i.length-1?(ca(r[s])||(r[s]=(0,Ft.Z)(i[l+1])?[]:{}),r=r[s]):r[s]=n}),e};function rZ(e,t){return e.reduce(function(n,r){return(n[r[t]]=n[r[t]]||[]).push(r),n},{})}function iZ(e){var t;return((t=e[0])===null||t===void 0?void 0:t.map(function(n,r){return e.map(function(i){return i[r]})}))||[]}var w0=lp({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),oZ=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:FC(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,s){return"".concat(i,"/").concat(s)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new Ci({class:w0.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new Ci({class:w0.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(t.prototype,"defaultPage",{get:function(){var n=this.attributes.defaultPage;return(0,so.Z)(n,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageShape",{get:function(){var n=this.pageViews,r=(0,z.CR)(iZ(n.map(function(y){var b=y.getBBox(),w=b.width,R=b.height;return[w,R]})).map(function(y){return Math.max.apply(Math,(0,z.ev)([],(0,z.CR)(y),!1))}),2),i=r[0],s=r[1],l=this.attributes,u=l.pageWidth,h=u===void 0?i:u,p=l.pageHeight,m=p===void 0?s:p;return{pageWidth:h,pageHeight:m}},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(t.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n=e.prototype.getBBox.call(this),r=n.x,i=n.y,s=this.controllerShape,l=this.pageShape,u=l.pageWidth,h=l.pageHeight;return new yc(r,i,u+s.width,h)},t.prototype.goTo=function(n){var r=this,i=this.attributes.animate,s=this,l=s.currPage,u=s.playState,h=s.playWindow,p=s.pageViews;if(u!=="idle"||n<0||p.length<=0||n>=p.length)return null;p[l].setLocalPosition(0,0),this.prepareFollowingPage(n);var m=(0,z.CR)(this.getFollowingPageDiff(n),2),y=m[0],b=m[1];this.playState="running";var w=SE(h,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-y,", ").concat(-b,")")}],i);return _g(w,function(){r.innerCurrPage=n,r.playState="idle",r.setVisiblePages([n]),r.updatePageInfo()}),w},t.prototype.prev=function(){var n=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!n&&i<=0)return null;var s=n?(i-1+r)%r:(0,so.Z)(i-1,0,r);return this.goTo(s)},t.prototype.next=function(){var n=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!n&&i>=r-1)return null;var s=n?(i+1)%r:(0,so.Z)(i+1,0,r);return this.goTo(s)},t.prototype.renderClipPath=function(n){var r=this.pageShape,i=r.pageWidth,s=r.pageHeight;if(!i||!s){this.contentGroup.style.clipPath=void 0;return}this.clipPath=n.maybeAppendByClassName(w0.clipPath,"rect").styles({width:i,height:s}),this.contentGroup.attr("clipPath",this.clipPath.node())},t.prototype.setVisiblePages=function(n){this.playWindow.children.forEach(function(r,i){n.includes(i)?Iy(r):Dm(r)})},t.prototype.adjustControllerLayout=function(){var n=this,r=n.prevBtnGroup,i=n.nextBtnGroup,s=n.pageInfoGroup,l=this.attributes,u=l.orientation,h=l.controllerPadding,p=s.getBBox(),m=p.width,y=p.height,b=(0,z.CR)(u==="horizontal"?[-180,0]:[-90,90],2),w=b[0],R=b[1];r.setLocalEulerAngles(w),i.setLocalEulerAngles(R);var M=r.getBBox(),I=M.width,N=M.height,U=i.getBBox(),Z=U.width,Y=U.height,$=Math.max(I,m,Z),J=u==="horizontal"?{offset:[[0,0],[I/2+h,0],[I+m+h*2,0]],textAlign:"start"}:{offset:[[$/2,-N-h],[$/2,0],[$/2,Y+h]],textAlign:"center"},se=(0,z.CR)(J.offset,3),pe=(0,z.CR)(se[0],2),Ce=pe[0],Ue=pe[1],Je=(0,z.CR)(se[1],2),lt=Je[0],Ge=Je[1],at=(0,z.CR)(se[2],2),st=at[0],ft=at[1],Vt=J.textAlign,wt=s.querySelector("text");wt&&(wt.style.textAlign=Vt),r.setLocalPosition(Ce,Ue),s.setLocalPosition(lt,Ge),i.setLocalPosition(st,ft)},t.prototype.updatePageInfo=function(){var n,r=this,i=r.currPage,s=r.pageViews,l=r.attributes.formatter;s.length<2||((n=this.pageInfoGroup.querySelector(w0.pageInfo.class))===null||n===void 0||n.attr("text",l(i+1,s.length)),this.adjustControllerLayout())},t.prototype.getFollowingPageDiff=function(n){var r=this.currPage;if(r===n)return[0,0];var i=this.attributes.orientation,s=this.pageShape,l=s.pageWidth,u=s.pageHeight,h=n<r?-1:1;return i==="horizontal"?[h*l,0]:[0,h*u]},t.prototype.prepareFollowingPage=function(n){var r=this,i=r.currPage,s=r.pageViews;if(this.setVisiblePages([n,i]),n!==i){var l=(0,z.CR)(this.getFollowingPageDiff(n),2),u=l[0],h=l[1];s[n].setLocalPosition(u,h)}},t.prototype.renderController=function(n){var r=this,i=this.attributes.controllerSpacing,s=this.pageShape,l=s.pageWidth,u=s.pageHeight,h=this.pageViews.length>=2,p=n.maybeAppendByClassName(w0.controller,"g");if(Q1(p.node(),h),!!h){var m=sa(this.attributes,"button"),y=sa(this.attributes,"pageNum"),b=(0,z.CR)(Pl(m),2),w=b[0],R=b[1],M=w.size,I=(0,z._T)(w,["size"]),N=!p.select(w0.prevBtnGroup.class).node(),U=p.maybeAppendByClassName(w0.prevBtnGroup,"g").styles(R);this.prevBtnGroup=U.node();var Z=U.maybeAppendByClassName(w0.prevBtn,"path"),Y=p.maybeAppendByClassName(w0.nextBtnGroup,"g").styles(R);this.nextBtnGroup=Y.node();var $=Y.maybeAppendByClassName(w0.nextBtn,"path");[Z,$].forEach(function(se){se.styles((0,z.pi)((0,z.pi)({},I),{transformOrigin:"center"})),Nm(se.node(),M,!0)});var J=p.maybeAppendByClassName(w0.pageInfoGroup,"g");this.pageInfoGroup=J.node(),J.maybeAppendByClassName(w0.pageInfo,"text").styles(y),this.updatePageInfo(),p.node().setLocalPosition(l+i,u/2),N&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},t.prototype.render=function(n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l;this.attr("transform","translate(".concat(s,", ").concat(u,")"));var h=$a(r);this.renderClipPath(h),this.renderController(h),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},t.prototype.bindEvents=function(){var n=this,r=Q2(function(){return n.render(n.attributes,n)},50);this.playWindow.addEventListener(wa.INSERTED,r),this.playWindow.addEventListener(wa.REMOVED,r)},t}(Af),Wp=lp({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function aZ(e){var t=e.querySelector(Wp.marker.class);return t?t.style:{}}var sZ=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,{span:[1,1],marker:function(){return new Ir({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(t.prototype,"showValue",{get:function(){var n=this.attributes.valueText;return n?typeof n=="string"||typeof n=="number"?n!=="":typeof n=="function"?!0:n.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualSpace",{get:function(){var n=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,s=n.node().getBBox(),l=s.width,u=s.height,h=r.node().getBBox(),p=h.width,m=h.height;return{markerWidth:i,labelWidth:l,valueWidth:p,height:Math.max(i,u,m)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"span",{get:function(){var n=this.attributes.span;if(!n)return[1,1];var r=(0,z.CR)(jf(n),2),i=r[0],s=r[1],l=this.showValue?s:0,u=i+l;return[i/u,l/u]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var n,r=this.attributes,i=r.markerSize,s=r.width,l=this.actualSpace,u=l.markerWidth,h=l.height,p=this.actualSpace,m=p.labelWidth,y=p.valueWidth,b=(0,z.CR)(this.spacing,2),w=b[0],R=b[1];if(s){var M=s-i-w-R,I=(0,z.CR)(this.span,2),N=I[0],U=I[1];n=(0,z.CR)([N*M,U*M],2),m=n[0],y=n[1]}var Z=u+m+y+w+R;return{width:Z,height:h,markerWidth:u,labelWidth:m,valueWidth:y}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){var n=this.attributes.spacing;if(!n)return[0,0];var r=(0,z.CR)(jf(n),2),i=r[0],s=r[1];return this.showValue?[i,s]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){var n=this.shape,r=n.markerWidth,i=n.labelWidth,s=n.valueWidth,l=n.width,u=n.height,h=(0,z.CR)(this.spacing,2),p=h[0],m=h[1];return{height:u,width:l,markerWidth:r,labelWidth:i,valueWidth:s,position:[r/2,r+p,r+i+p+m]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleSize",{get:function(){var n=aZ(this.markerGroup.node()),r=this.attributes,i=r.markerSize,s=r.markerStrokeWidth,l=s===void 0?n.strokeWidth:s,u=r.markerLineWidth,h=u===void 0?n.lineWidth:u,p=r.markerStroke,m=p===void 0?n.stroke:p,y=+(l||h||(m?1:0))*Math.sqrt(2),b=this.markerGroup.node().getBBox(),w=b.width,R=b.height;return(1-y/Math.max(w,R))*i},enumerable:!1,configurable:!0}),t.prototype.renderMarker=function(n){var r=this,i=this.attributes.marker,s=sa(this.attributes,"marker");this.markerGroup=n.maybeAppendByClassName(Wp.markerGroup,"g").style("zIndex",0),sd(!!i,this.markerGroup,function(){var l,u=r.markerGroup.node(),h=(l=u.childNodes)===null||l===void 0?void 0:l[0],p=typeof i=="string"?new pl({style:{symbol:i},className:Wp.marker.name}):i();h?p.nodeName===h.nodeName?h instanceof pl?h.update((0,z.pi)((0,z.pi)({},s),{symbol:i})):(WA(h,p),$a(h).styles(s)):(h.remove(),$a(p).attr("className",Wp.marker.name).styles(s),u.appendChild(p)):(p instanceof pl||$a(p).attr("className",Wp.marker.name).styles(s),u.appendChild(p)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var m=Nm(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(m,")")})},t.prototype.renderLabel=function(n){var r=sa(this.attributes,"label"),i=r.text,s=(0,z._T)(r,["text"]);this.labelGroup=n.maybeAppendByClassName(Wp.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Wp.label,function(){return fh(i)}).styles(s)},t.prototype.renderValue=function(n){var r=this,i=sa(this.attributes,"value"),s=i.text,l=(0,z._T)(i,["text"]);this.valueGroup=n.maybeAppendByClassName(Wp.valueGroup,"g").style("zIndex",0),sd(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(Wp.value,function(){return fh(s)}).styles(l)})},t.prototype.renderBackground=function(n){var r=this.shape,i=r.width,s=r.height,l=sa(this.attributes,"background");this.background=n.maybeAppendByClassName(Wp.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Wp.background,"rect").styles((0,z.pi)({width:i,height:s},l))},t.prototype.adjustLayout=function(){var n=this.layout,r=n.labelWidth,i=n.valueWidth,s=n.height,l=(0,z.CR)(n.position,3),u=l[0],h=l[1],p=l[2],m=s/2;this.markerGroup.styles({transform:"translate(".concat(u,", ").concat(m,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(h,", ").concat(m,")")}),Sg(this.labelGroup.select(Wp.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(p,", ").concat(m,")")}),Sg(this.valueGroup.select(Wp.value.class).node(),Math.ceil(i)))},t.prototype.render=function(n,r){var i=$a(r),s=n.x,l=s===void 0?0:s,u=n.y,h=u===void 0?0:u;i.styles({transform:"translate(".concat(l,", ").concat(h,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},t}(Af),g1=lp({page:"item-page",navigator:"navigator",item:"item"},"items"),ID=function(e,t,n){return n===void 0&&(n=!0),e?t(e):n},lZ=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:L3,mouseenter:L3,mouseleave:L3})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){var n=this.attributes,r=n.gridRow,i=n.gridCol,s=n.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,s.length]:[s.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderData",{get:function(){var n=this.attributes,r=n.data,i=n.layout,s=sa(this.attributes,"item"),l=r.map(function(u,h){var p=u.id,m=p===void 0?h:p,y=u.label,b=u.value;return{id:"".concat(m),index:h,style:(0,z.pi)({layout:i,labelText:y,valueText:b},Object.fromEntries(Object.entries(s).map(function(w){var R=(0,z.CR)(w,2),M=R[0],I=R[1];return[M,Ss(I,[u,h,r])]})))}});return l},enumerable:!1,configurable:!0}),t.prototype.getGridLayout=function(){var n=this,r=this.attributes,i=r.orientation,s=r.width,l=r.rowPadding,u=r.colPadding,h=(0,z.CR)(this.navigatorShape,1),p=h[0],m=(0,z.CR)(this.grid,2),y=m[0],b=m[1],w=b*y,R=0;return this.pageViews.children.map(function(M,I){var N,U,Z=Math.floor(I/w),Y=I%w,$=n.ifHorizontal(b,y),J=[Math.floor(Y/$),Y%$];i==="vertical"&&J.reverse();var se=(0,z.CR)(J,2),pe=se[0],Ce=se[1],Ue=(s-p-(b-1)*u)/b,Je=M.getBBox().height,lt=(0,z.CR)([0,0],2),Ge=lt[0],at=lt[1];return i==="horizontal"?(N=(0,z.CR)([R,pe*(Je+l)],2),Ge=N[0],at=N[1],R=Ce===b-1?0:R+Ue+u):(U=(0,z.CR)([Ce*(Ue+u),R],2),Ge=U[0],at=U[1],R=pe===y-1?0:R+Je+l),{page:Z,index:I,row:pe,col:Ce,pageIndex:Y,width:Ue,height:Je,x:Ge,y:at}})},t.prototype.getFlexLayout=function(){var n=this.attributes,r=n.width,i=n.height,s=n.rowPadding,l=n.colPadding,u=(0,z.CR)(this.navigatorShape,1),h=u[0],p=(0,z.CR)(this.grid,2),m=p[0],y=p[1],b=(0,z.CR)([r-h,i],2),w=b[0],R=b[1],M=(0,z.CR)([0,0,0,0,0,0,0,0],8),I=M[0],N=M[1],U=M[2],Z=M[3],Y=M[4],$=M[5],J=M[6],se=M[7];return this.pageViews.children.map(function(pe,Ce){var Ue,Je,lt,Ge,at=pe.getBBox(),st=at.width,ft=at.height,Vt=J===0?0:l,wt=J+Vt+st;if(wt<=w&&ID(Y,function(En){return En<y}))return Ue=(0,z.CR)([J+Vt,se,wt],3),I=Ue[0],N=Ue[1],J=Ue[2],{width:st,height:ft,x:I,y:N,page:U,index:Ce,pageIndex:Z++,row:$,col:Y++};Je=(0,z.CR)([$+1,0,0,se+ft+s],4),$=Je[0],Y=Je[1],J=Je[2],se=Je[3];var zt=se+ft;return zt<=R&&ID($,function(En){return En<m})?(lt=(0,z.CR)([J,se,st],3),I=lt[0],N=lt[1],J=lt[2],{width:st,height:ft,x:I,y:N,page:U,index:Ce,pageIndex:Z++,row:$,col:Y++}):(Ge=(0,z.CR)([0,0,st,0,U+1,0,0,0],8),I=Ge[0],N=Ge[1],J=Ge[2],se=Ge[3],U=Ge[4],Z=Ge[5],$=Ge[6],Y=Ge[7],{width:st,height:ft,x:I,y:N,page:U,index:Ce,pageIndex:Z++,row:$,col:Y++})})},Object.defineProperty(t.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var n=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=n.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],n.call(this)):r},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(n,r){var i=this.attributes.orientation;return Hp(i,n,r)},t.prototype.flattenPage=function(n){n.querySelectorAll(g1.item.class).forEach(function(r){n.appendChild(r)}),n.querySelectorAll(g1.page.class).forEach(function(r){var i=n.removeChild(r);i.destroy()})},t.prototype.renderItems=function(n){var r=this.attributes,i=r.click,s=r.mouseenter,l=r.mouseleave;this.flattenPage(n);var u=this.dispatchCustomEvent.bind(this);$a(n).selectAll(g1.item.class).data(this.renderData,function(h){return h.id}).join(function(h){return h.append(function(p){var m=p.style;return new sZ({style:m})}).attr("className",g1.item.name).on("click",function(){i==null||i(this),u("itemClick",{item:this})}).on("pointerenter",function(){s==null||s(this),u("itemMouseenter",{item:this})}).on("pointerleave",function(){l==null||l(this),u("itemMouseleave",{item:this})})},function(h){return h.each(function(p){var m=p.style;this.update(m)})},function(h){return h.remove()})},t.prototype.relayoutNavigator=function(){var n,r=this.attributes,i=r.layout,s=r.width,l=((n=this.pageViews.children[0])===null||n===void 0?void 0:n.getBBox().height)||0,u=(0,z.CR)(this.navigatorShape,2),h=u[0],p=u[1];this.navigator.update(i==="grid"?{pageWidth:s-h,pageHeight:l-p}:{})},t.prototype.adjustLayout=function(){var n=this,r=Object.entries(rZ(this.itemsLayout,"page")).map(function(s){var l=(0,z.CR)(s,2),u=l[0],h=l[1];return{page:u,layouts:h}}),i=(0,z.ev)([],(0,z.CR)(this.navigator.getContainer().children),!1);r.forEach(function(s){var l=s.layouts,u=n.pageViews.appendChild(new Ci({className:g1.page.name}));l.forEach(function(h){var p=h.x,m=h.y,y=h.index,b=h.width,w=h.height,R=i[y];u.appendChild(R),nZ(R,"__layout__",h),R.update({x:p,y:m,width:b,height:w})})}),this.relayoutNavigator()},t.prototype.renderNavigator=function(n){var r=this.attributes.orientation,i=sa(this.attributes,"nav"),s=Y0({orientation:r},i),l=this;return n.selectAll(g1.navigator.class).data(["nav"]).join(function(u){return u.append(function(){return new oZ({style:s})}).attr("className",g1.navigator.name).each(function(){l.navigator=this})},function(u){return u.each(function(){this.update(s)})},function(u){return u.remove()}),this.navigator},t.prototype.getBBox=function(){return this.navigator.getBBox()},t.prototype.render=function(n,r){var i=this.attributes.data;if(!(!i||i.length===0)){var s=this.renderNavigator($a(r));this.renderItems(s.getContainer()),this.adjustLayout()}},t.prototype.dispatchCustomEvent=function(n,r){var i=new tl(n,{detail:r});this.dispatchEvent(i)},t}(Af),cZ=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,Mg)||this}return t.prototype.renderTitle=function(n,r,i){var s=this.attributes,l=s.showTitle,u=s.titleText,h=sa(this.attributes,"title"),p=(0,z.CR)(Pl(h),2),m=p[0],y=p[1];this.titleGroup=n.maybeAppendByClassName(Zf.titleGroup,"g").styles(y);var b=(0,z.pi)((0,z.pi)({width:r,height:i},m),{text:l?u:""});this.title=this.titleGroup.maybeAppendByClassName(Zf.title,function(){return new Md({style:b})}).update(b)},t.prototype.renderItems=function(n,r){var i=r.x,s=r.y,l=r.width,u=r.height,h=sa(this.attributes,"title",!0),p=(0,z.CR)(Pl(h),2),m=p[0],y=p[1],b=(0,z.pi)((0,z.pi)({},m),{width:l,height:u,x:0,y:0});this.itemsGroup=n.maybeAppendByClassName(Zf.itemsGroup,"g").styles((0,z.pi)((0,z.pi)({},y),{transform:"translate(".concat(i,", ").concat(s,")")}));var w=this;this.itemsGroup.selectAll(Zf.items.class).data(["items"]).join(function(R){return R.append(function(){return new lZ({style:b})}).attr("className",Zf.items.name).each(function(){w.items=$a(this)})},function(R){return R.update(b)},function(R){return R.remove()})},t.prototype.adjustLayout=function(){var n=this.attributes.showTitle;if(n){var r=this.title.node().getAvailableSpace(),i=r.x,s=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(s,")")}},Object.defineProperty(t.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.showTitle,i=n.width,s=n.height;return r?this.title.node().getAvailableSpace():new yc(0,0,i,s)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n,r,i=(n=this.title)===null||n===void 0?void 0:n.node(),s=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!s?e.prototype.getBBox.call(this):GE(i,s)},t.prototype.render=function(n,r){var i=this.attributes,s=i.width,l=i.height,u=i.x,h=u===void 0?0:u,p=i.y,m=p===void 0?0:p,y=$a(r);r.style.transform="translate(".concat(h,", ").concat(m,")"),this.renderTitle(y,s,l),this.renderItems(y,this.availableSpace),this.adjustLayout()},t}(Af);function Xx(e){if(ap(e)){var t=e;return t[t.length-1]}}var uZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function fZ(e,t){const n=Pd(e,"shape"),r=Pd(e,"color"),i=n?n.clone():null,s=[];for(const[u,h]of t){const p=u.type,y=((r==null?void 0:r.getOptions().domain.length)>0?r==null?void 0:r.getOptions().domain:h.data).map((b,w)=>{var R;return i?i.map(b||"point"):((R=u==null?void 0:u.style)===null||R===void 0?void 0:R.shape)||h.defaultShape||"point"});typeof p=="string"&&s.push([p,y])}if(s.length===0)return["point",["point"]];if(s.length===1||!n)return s[0];const{range:l}=n.getOptions();return s.map(([u,h])=>{let p=0;for(let m=0;m<s.length;m++){const y=l[m%l.length];h[m]===y&&p++}return[p/h.length,[u,h]]}).sort((u,h)=>h[0]-u[0])[0][1]}function hZ(e,t){const{scales:n,library:r,markState:i}=t,[s,l]=fZ(n,i),{itemMarker:u,itemMarkerSize:h}=e,p=(b,w)=>{var R,M,I;const N=((I=(M=(R=r[`mark.${s}`])===null||R===void 0?void 0:R.props)===null||M===void 0?void 0:M.shape[b])===null||I===void 0?void 0:I.props.defaultMarker)||Xx(b.split(".")),U=typeof h=="function"?h(w):h;return()=>F2(N,{color:w.color})(0,0,U)},m=b=>`${l[b]}`;return Pd(n,"shape")&&!u?(b,w)=>p(m(w),b):typeof u=="function"?(b,w)=>{const R=u(b.id,w);return typeof R=="string"?p(R,b):R}:(b,w)=>p(u||m(w),b)}function dZ(e){const t=Pd(e,"opacity");if(t){const{range:n}=t.getOptions();return(r,i)=>n[i]}}function pZ(e,t){const n=Pd(e,"size");return n instanceof _T?n.map(NaN)*2:t}function mZ(e,t){const{labelFormatter:n=b=>`${b}`}=e,{scales:r,theme:i}=t,s=i.legendCategory.itemMarkerSize,l=pZ(r,s),u={itemMarker:hZ(Object.assign(Object.assign({},e),{itemMarkerSize:l}),t),itemMarkerSize:l,itemMarkerOpacity:dZ(r)},h=typeof n=="string"?Lm(n):n,p=Pd(r,"color"),m=$y(r),y=p?b=>p.map(b):()=>t.theme.color;return Object.assign(Object.assign({},u),{data:m.map(b=>({id:b,label:h(b),color:y(b)}))})}function vZ(e,t,n){const{position:r}=t;if(r==="center"){const{bbox:l}=e,{width:u,height:h}=l;return{width:u,height:h}}const{width:i,height:s}=nS(e,t,n);return{width:i,height:s}}const D3=e=>{const{labelFormatter:t,layout:n,order:r,orientation:i,position:s,size:l,title:u,cols:h,itemMarker:p}=e,m=uZ(e,["labelFormatter","layout","order","orientation","position","size","title","cols","itemMarker"]),{gridRow:y}=m;return b=>{const{value:w,theme:R}=b,{bbox:M}=w,{width:I,height:N}=vZ(w,e,D3),U=Pv(s,n),Z=Object.assign(Object.assign(Object.assign(Object.assign({orientation:["right","left","center"].includes(s)?"vertical":"horizontal",width:I,height:N,layout:h!==void 0?"grid":"flex"},h!==void 0&&{gridCol:h}),y!==void 0&&{gridRow:y}),{titleText:y_(u)}),mZ(e,b)),{legendCategory:Y={}}=R,$=b_(Object.assign({},Y,Z,m)),J=new fC({style:Object.assign(Object.assign({x:M.x,y:M.y,width:M.width,height:M.height},U),{subOptions:$})});return J.appendChild(new cZ({className:"legend-category",style:$})),J}};D3.props={defaultPosition:"top",defaultOrder:1,defaultSize:40,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const LD=e=>()=>new Ci;LD.props={};var gZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function DD(e,t,n,r){switch(r){case"center":return{x:e+n/2,y:t,textAlign:"middle"};case"right":return{x:e+n,y:t,textAlign:"right"};default:return{x:e,y:t,textAlign:"left"}}}const yZ=g_({render(e,t){const{width:n,title:r,subtitle:i,spacing:s=2,align:l="left",x:u,y:h}=e,p=gZ(e,["width","title","subtitle","spacing","align","x","y"]);t.style.transform=`translate(${u}, ${h})`;const m=po(p,"title"),y=po(p,"subtitle"),w=tS(t,".title","text").attr("className","title").call(jn,Object.assign(Object.assign(Object.assign({},DD(0,0,n,l)),{fontSize:14,textBaseline:"top",text:r}),m)).node().getLocalBounds();tS(t,".sub-title","text").attr("className","sub-title").call(R=>{if(!i)return R.node().remove();R.node().attr(Object.assign(Object.assign(Object.assign({},DD(0,w.max[1]+s,n,l)),{fontSize:12,textBaseline:"top",text:i}),y))})}}),ND=e=>({value:t,theme:n})=>{const{x:r,y:i,width:s,height:l}=t.bbox;return new yZ({style:ni({},n.title,Object.assign({x:r,y:i,width:s,height:l},e))})};ND.props={defaultPosition:"top",defaultOrder:2,defaultSize:36,defaultCrossPadding:[20,20],defaultPadding:[12,12]};var N3=function(e){if(typeof e!="object"||e===null)return e;var t;if(Is(e)){t=[];for(var n=0,r=e.length;n<r;n++)typeof e[n]=="object"&&e[n]!=null?t[n]=N3(e[n]):t[n]=e[n]}else{t={};for(var i in e)typeof e[i]=="object"&&e[i]!=null?t[i]=N3(e[i]):t[i]=e[i]}return t},B3=N3,_Z=function(e){(0,z.ZT)(t,e);function t(n){var r=this,i=n.style,s=(0,z._T)(n,["style"]);return r=e.call(this,ni({},{type:"column"},(0,z.pi)({style:i},s)))||this,r.columnsGroup=new Ci({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return t.prototype.render=function(){var n=this.attributes,r=n.columns,i=n.x,s=n.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(s,")"),$a(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(l){return l.append("rect").attr("className","column").each(function(u){this.attr(u)})},function(l){return l.each(function(u){this.attr(u)})},function(l){return l.remove()})},t.prototype.update=function(n){this.attr(Y0({},this.attributes,n)),this.render()},t.prototype.clear=function(){this.removeChildren()},t}(Sr),bZ=function(e){(0,z.ZT)(t,e);function t(n){var r=this,i=n.style,s=(0,z._T)(n,["style"]);return r=e.call(this,ni({},{type:"lines"},(0,z.pi)({style:i},s)))||this,r.linesGroup=r.appendChild(new Ci),r.areasGroup=r.appendChild(new Ci),r.render(),r}return t.prototype.render=function(){var n=this.attributes,r=n.lines,i=n.areas,s=n.x,l=n.y;this.style.transform="translate(".concat(s,", ").concat(l,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},t.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},t.prototype.update=function(n){this.attr(Y0({},this.attributes,n)),this.render()},t.prototype.renderLines=function(n){$a(this.linesGroup).selectAll(".line").data(n).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},t.prototype.renderAreas=function(n){$a(this.linesGroup).selectAll(".area").data(n).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},t}(Sr);function xZ(e,t,n,r){var i,s=[],l=!!r,u,h,p=[1/0,1/0],m=[-1/0,-1/0],y,b,w;if(l){i=(0,z.CR)(r,2),p=i[0],m=i[1];for(var R=0,M=e.length;R<M;R+=1){var I=e[R];p=Cf(p,I),m=cp(m,I)}}for(var R=0,N=e.length;R<N;R+=1){var I=e[R];if(R===0&&!n)w=I;else if(R===N-1&&!n)b=I,s.push(w),s.push(b);else{var U=[R?R-1:N-1,R-1][n?0:1];u=e[U],h=e[n?(R+1)%N:R+1];var Z=[0,0];Z=Ub(h,u),Z=$0(Z,t);var Y=Ny(I,u),$=Ny(I,h),J=Y+$;J!==0&&(Y/=J,$/=J);var se=$0(Z,-Y),pe=$0(Z,$);b=Dy(I,se),y=Dy(I,pe),y=Cf(y,cp(h,I)),y=cp(y,Cf(h,I)),se=Ub(y,I),se=$0(se,-Y/$),b=Dy(I,se),b=Cf(b,cp(u,I)),b=cp(b,Cf(u,I)),pe=Ub(I,b),pe=$0(pe,$/Y),y=Dy(I,pe),l&&(b=cp(b,p),b=Cf(b,m),y=cp(y,p),y=Cf(y,m)),s.push(w),s.push(b),w=y}}return n&&s.push(s.shift()),s}function EZ(e,t,n){var r;t===void 0&&(t=!1),n===void 0&&(n=[[0,0],[1,1]]);for(var i=!!t,s=[],l=0,u=e.length;l<u;l+=2)s.push([e[l],e[l+1]]);for(var h=xZ(s,.4,i,n),p=s.length,m=[],y,b,w,l=0;l<p-1;l+=1)y=h[l*2],b=h[l*2+1],w=s[l+1],m.push(["C",y[0],y[1],b[0],b[1],w[0],w[1]]);return i&&(y=h[p],b=h[p+1],r=(0,z.CR)(s,1),w=r[0],m.push(["C",y[0],y[1],b[0],b[1],w[0],w[1]])),m}function SZ(e,t){var n,r=t.x,i=t.y,s=(0,z.CR)(i.getOptions().range||[0,0],2),l=s[0],u=s[1];return u>l&&(n=(0,z.CR)([l,u],2),u=n[0],l=n[1]),e.map(function(h){var p=h.map(function(m,y){return[r.map(y),(0,so.Z)(i.map(m),u,l)]});return p})}function Yx(e,t){t===void 0&&(t=!1);var n=t?e.length-1:0,r=e.map(function(i,s){return(0,z.ev)([s===n?"M":"L"],(0,z.CR)(i),!1)});return t?r.reverse():r}function ST(e,t){if(t===void 0&&(t=!1),e.length<=2)return Yx(e);for(var n=[],r=e.length,i=0;i<r;i+=1){var s=t?e[r-i-1]:e[i];dE(s,n.slice(-2))||n.push.apply(n,(0,z.ev)([],(0,z.CR)(s),!1))}var l=EZ(n,!1);return t?l.unshift((0,z.ev)(["M"],(0,z.CR)(e[r-1]),!1)):l.unshift((0,z.ev)(["M"],(0,z.CR)(e[0]),!1)),l}function F3(e,t,n){var r=B3(e);return r.push(["L",t,n],["L",0,n],["Z"]),r}function TZ(e,t,n,r){return e.map(function(i){return F3(t?ST(i):Yx(i),n,r)})}function wZ(e,t,n){for(var r=[],i=e.length-1;i>=0;i-=1){var s=e[i],l=Yx(s),u=void 0;if(i===0)u=F3(l,t,n);else{var h=e[i-1],p=Yx(h,!0);p[0][0]="L",u=(0,z.ev)((0,z.ev)((0,z.ev)([],(0,z.CR)(l),!1),(0,z.CR)(p),!1),[["Z"]],!1)}r.push(u)}return r}function AZ(e,t,n){for(var r=[],i=e.length-1;i>=0;i-=1){var s=e[i],l=ST(s),u=void 0;if(i===0)u=F3(l,t,n);else{var h=e[i-1],p=ST(h,!0),m=s[0];p[0][0]="L",u=(0,z.ev)((0,z.ev)((0,z.ev)([],(0,z.CR)(l),!1),(0,z.CR)(p),!1),[(0,z.ev)(["M"],(0,z.CR)(m),!1),["Z"]],!1)}r.push(u)}return r}var CZ=function(e,t){if(Is(e)){for(var n,r=1/0,i=0;i<e.length;i++){var s=e[i],l=Ih(t)?t(s):s[t];l<r&&(n=s,r=l)}return n}},OZ=function(e,t){if(Is(e)){for(var n,r=-1/0,i=0;i<e.length;i++){var s=e[i],l=Ih(t)?t(s):s[t];l>r&&(n=s,r=l)}return n}};function BD(e){return e.length===0?[0,0]:[nu(CZ(e,function(t){return nu(t)||0})),sc(OZ(e,function(t){return sc(t)||0}))]}function FD(e){for(var t=B3(e),n=t[0].length,r=(0,z.CR)([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],s=r[1],l=0;l<t.length;l+=1)for(var u=t[l],h=0;h<n;h+=1)u[h]>=0?(u[h]+=i[h],i[h]=u[h]):(u[h]+=s[h],s[h]=u[h]);return t}var RZ=function(e){(0,z.ZT)(t,e);function t(n){return e.call(this,n,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(t.prototype,"rawData",{get:function(){var n=this.attributes.data;if(!n||(n==null?void 0:n.length)===0)return[[]];var r=B3(n);return(0,Ft.Z)(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.attributes.isStack?FD(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseline",{get:function(){var n=this.scales.y,r=(0,z.CR)(n.getOptions().domain||[0,0],2),i=r[0],s=r[1];return s<0?n.map(s):n.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"containerShape",{get:function(){var n=this.attributes,r=n.width,i=n.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linesStyle",{get:function(){var n=this,r=this.attributes,i=r.type,s=r.isStack,l=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var u=sa(this.attributes,"area"),h=sa(this.attributes,"line"),p=this.containerShape.width,m=this.data;if(m[0].length===0)return{lines:[],areas:[]};var y=this.scales,b=y.x,w=y.y,R=SZ(m,{type:"line",x:b,y:w}),M=[];if(u){var I=this.baseline;s?M=l?AZ(R,p,I):wZ(R,p,I):M=TZ(R,l,p,I)}return{lines:R.map(function(N,U){return(0,z.pi)({stroke:n.getColor(U),d:l?ST(N):Yx(N)},h)}),areas:M.map(function(N,U){return(0,z.pi)({d:N,fill:n.getColor(U)},u)})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnsStyle",{get:function(){var n=this,r=sa(this.attributes,"column"),i=this.attributes,s=i.isStack,l=i.type,u=i.scale;if(l!=="column")throw new Error("columnsStyle can only be used in column type");var h=this.containerShape.height,p=this.rawData;if(!p)return{columns:[]};s&&(p=FD(p));var m=this.createScales(p),y=m.x,b=m.y,w=(0,z.CR)(BD(p),2),R=w[0],M=w[1],I=new hh({domain:[0,M-(R>0?0:R)],range:[0,h*u]}),N=y.getBandWidth(),U=this.rawData;return{columns:p.map(function(Z,Y){return Z.map(function($,J){var se=N/p.length,pe=function(){return{x:y.map(J)+se*Y,y:$>=0?b.map($):b.map(0),width:se,height:I.map(Math.abs($))}},Ce=function(){return{x:y.map(J),y:b.map($),width:N,height:I.map(U[Y][J])}};return(0,z.pi)((0,z.pi)({fill:n.getColor(Y)},r),s?Ce():pe())})})}},enumerable:!1,configurable:!0}),t.prototype.render=function(n,r){PA(r,".container","rect").attr("className","container").node();var i=n.type,s=n.x,l=n.y,u="spark".concat(i),h=(0,z.pi)({x:s,y:l},i==="line"?this.linesStyle:this.columnsStyle);$a(r).selectAll(".spark").data([i]).join(function(p){return p.append(function(m){return m==="line"?new bZ({className:u,style:h}):new _Z({className:u,style:h})}).attr("className","spark ".concat(u))},function(p){return p.update(h)},function(p){return p.remove()})},t.prototype.getColor=function(n){var r=this.attributes.color;return Is(r)?r[n%r.length]:Ih(r)?r.call(null,n):r},t.prototype.createScales=function(n){var r,i,s=this.attributes,l=s.type,u=s.scale,h=s.range,p=h===void 0?[]:h,m=s.spacing,y=this.containerShape,b=y.width,w=y.height,R=(0,z.CR)(BD(n),2),M=R[0],I=R[1],N=new hh({domain:[(r=p[0])!==null&&r!==void 0?r:M,(i=p[1])!==null&&i!==void 0?i:I],range:[w,w*(1-u)]});return l==="line"?{type:l,x:new hh({domain:[0,n[0].length-1],range:[0,b]}),y:N}:{type:l,x:new Wg({domain:n[0].map(function(U,Z){return Z}),range:[0,b],paddingInner:m,paddingOuter:m/2,align:.5}),y:N}},t.tag="sparkline",t}(Af),kD=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n,(0,z.pi)((0,z.pi)((0,z.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Hl(fx,"handle")),Hl(ux,"handleIcon")),Hl(cS,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(s){s.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal(E_(s));var l=r.availableSpace,u=l.x,h=l.y,p=r.getBBox(),m=p.x,y=p.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([u,h])-r.getOrientVal([+m,+y])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var s=r.attributes,l=s.slidable,u=s.brushable,h=s.type;i.stopPropagation();var p=r.getOrientVal(E_(i)),m=p-r.prevPos;if(m){var y=r.getRatio(m);switch(r.target){case"start":l&&r.setValuesOffset(y);break;case"end":l&&r.setValuesOffset(0,y);break;case"selection":l&&r.setValuesOffset(y,y);break;case"track":if(!u)return;r.selectionWidth+=y,h==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=p}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var s=r.attributes,l=s.onChange,u=s.type,h=u==="range"?i:i[1],p=u==="range"?r.getValues():r.getValues()[1],m=new tl("valuechange",{detail:{oldValue:h,value:p}});r.dispatchEvent(m),l==null||l(p)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(t.prototype,"values",{get:function(){return this.attributes.values},set:function(n){this.attributes.values=this.clampValues(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sparklineStyle",{get:function(){var n=this.attributes.orientation;if(n!=="horizontal")return null;var r=sa(this.attributes,"sparkline");return(0,z.pi)((0,z.pi)({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var n=this.attributes,r=n.trackLength,i=n.trackSize,s=(0,z.CR)(this.getOrientVal([[r,i],[i,r]]),2),l=s[0],u=s[1];return{width:l,height:u}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.x,i=n.y,s=n.padding,l=(0,z.CR)(jf(s),4),u=l[0],h=l[1],p=l[2],m=l[3],y=this.shape,b=y.width,w=y.height;return{x:m,y:u,width:b-(m+h),height:w-(u+p)}},enumerable:!1,configurable:!0}),t.prototype.getValues=function(){return this.values},t.prototype.setValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1),this.attributes.values=n;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},t.prototype.updateSelectionArea=function(n){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(Ju.selection.class).each(function(i,s){b0(this,r[s],n)})},t.prototype.updateHandlesPosition=function(n){this.attributes.showHandle&&(this.startHandle&&b0(this.startHandle,this.getHandleStyle("start"),n),this.endHandle&&b0(this.endHandle,this.getHandleStyle("end"),n))},t.prototype.innerSetValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1);var i=this.values,s=this.clampValues(n);this.attributes.values=s,this.setValues(s),r&&this.onValueChange(i)},t.prototype.renderTrack=function(n){var r=this.attributes,i=r.x,s=r.y,l=sa(this.attributes,"track");this.trackShape=$a(n).maybeAppendByClassName(Ju.track,"rect").styles((0,z.pi)((0,z.pi)({x:i,y:s},this.shape),l))},t.prototype.renderBrushArea=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.brushable;this.brushArea=$a(n).maybeAppendByClassName(Ju.brushArea,"rect").styles((0,z.pi)({x:i,y:s,fill:"transparent",cursor:l?"crosshair":"default"},this.shape))},t.prototype.renderSparkline=function(n){var r=this,i=this.attributes,s=i.x,l=i.y,u=i.orientation,h=$a(n).maybeAppendByClassName(Ju.sparklineGroup,"g");sd(u==="horizontal",h,function(p){var m=(0,z.pi)((0,z.pi)({},r.sparklineStyle),{x:s,y:l});p.maybeAppendByClassName(Ju.sparkline,function(){return new RZ({style:m})}).update(m)})},t.prototype.renderHandles=function(){var n=this,r,i=this.attributes,s=i.showHandle,l=i.type,u=l==="range"?["start","end"]:["end"],h=s?u:[],p=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(Ju.handle.class).data(h.map(function(m){return{type:m}}),function(m){return m.type}).join(function(m){return m.append(function(y){var b=y.type;return new hx({style:n.getHandleStyle(b)})}).each(function(y){var b=y.type;this.attr("class","".concat(Ju.handle.name," ").concat(b,"-handle"));var w="".concat(b,"Handle");p[w]=this,this.addEventListener("pointerdown",p.onDragStart(b))})},function(m){return m.each(function(y){var b=y.type;this.update(p.getHandleStyle(b))})},function(m){return m.each(function(y){var b=y.type,w="".concat(b,"Handle");p[w]=void 0}).remove()})},t.prototype.renderSelection=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.type,u=r.selectionType;this.foregroundGroup=$a(n).maybeAppendByClassName(Ju.foreground,"g");var h=sa(this.attributes,"selection"),p=function(y){return y.style("visibility",function(b){return b.show?"visible":"hidden"}).style("cursor",function(b){return u==="select"?"grab":u==="invert"?"crosshair":"default"}).styles((0,z.pi)((0,z.pi)({},h),{transform:"translate(".concat(i,", ").concat(s,")")}))},m=this;this.foregroundGroup.selectAll(Ju.selection.class).data(l==="value"?[]:this.calcSelectionArea().map(function(y,b){return{style:(0,z.pi)({},y),index:b,show:u==="select"?b===1:b!==1}}),function(y){return y.index}).join(function(y){return y.append("rect").attr("className",Ju.selection.name).call(p).each(function(b,w){var R=this;w===1?(m.selectionShape=$a(this),this.on("pointerdown",function(M){R.attr("cursor","grabbing"),m.onDragStart("selection")(M)}),m.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),m.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),m.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){R.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){R.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){R.attr("cursor","pointer")})):this.on("pointerdown",m.onDragStart("track"))})},function(y){return y.call(p)},function(y){return y.remove()}),this.updateSelectionArea(!1),this.renderHandles()},t.prototype.render=function(n,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},t.prototype.clampValues=function(n,r){var i;r===void 0&&(r=4);var s=(0,z.CR)(this.range,2),l=s[0],u=s[1],h=(0,z.CR)(this.getValues().map(function(I){return Ky(I,r)}),2),p=h[0],m=h[1],y=Array.isArray(n)?n:[p,n!=null?n:m],b=(0,z.CR)((y||[p,m]).map(function(I){return Ky(I,r)}),2),w=b[0],R=b[1];if(this.attributes.type==="value")return[0,(0,so.Z)(R,l,u)];w>R&&(i=(0,z.CR)([R,w],2),w=i[0],R=i[1]);var M=R-w;return M>u-l?[l,u]:w<l?p===l&&m===R?[l,R]:[l,M+l]:R>u?m===u&&p===w?[w,u]:[u-M,u]:[w,R]},t.prototype.calcSelectionArea=function(n){var r=(0,z.CR)(this.clampValues(n),2),i=r[0],s=r[1],l=this.availableSpace,u=l.x,h=l.y,p=l.width,m=l.height;return this.getOrientVal([[{y:h,height:m,x:u,width:i*p},{y:h,height:m,x:i*p+u,width:(s-i)*p},{y:h,height:m,x:s*p,width:(1-s)*p}],[{x:u,width:p,y:h,height:i*m},{x:u,width:p,y:i*m+h,height:(s-i)*m},{x:u,width:p,y:s*m,height:(1-s)*m}]])},t.prototype.calcHandlePosition=function(n){var r=this.attributes.handleIconOffset,i=this.availableSpace,s=i.x,l=i.y,u=i.width,h=i.height,p=(0,z.CR)(this.clampValues(),2),m=p[0],y=p[1],b=n==="start"?-r:r,w=(n==="start"?m:y)*this.getOrientVal([u,h])+b;return{x:s+this.getOrientVal([w,u/2]),y:l+this.getOrientVal([h/2,w])}},t.prototype.inferTextStyle=function(n){var r=this.attributes.orientation;return r==="horizontal"?{}:n==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:n==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},t.prototype.calcHandleText=function(n){var r,i=this.attributes,s=i.type,l=i.orientation,u=i.formatter,h=i.autoFitLabel,p=sa(this.attributes,"handle"),m=sa(p,"label"),y=p.spacing,b=this.getHandleSize(),w=this.clampValues(),R=n==="start"?w[0]:w[1],M=u(R),I=new Ly({style:(0,z.pi)((0,z.pi)((0,z.pi)({},m),this.inferTextStyle(n)),{text:M})}),N=I.getBBox(),U=N.width,Z=N.height;if(I.destroy(),!h){if(s==="value")return{text:M,x:0,y:-Z-y};var Y=y+b+(l==="horizontal"?U/2:0);return r={text:M},r[l==="horizontal"?"x":"y"]=n==="start"?-Y:Y,r}var $=0,J=0,se=this.availableSpace,pe=se.width,Ce=se.height,Ue=this.calcSelectionArea()[1],Je=Ue.x,lt=Ue.y,Ge=Ue.width,at=Ue.height,st=y+b;if(l==="horizontal"){var ft=st+U/2;if(n==="start"){var Vt=Je-st-U;$=Vt>0?-ft:ft}else{var wt=pe-Je-Ge-st>U;$=wt?ft:-ft}}else{var zt=st,En=Z+st;n==="start"?J=lt-b>Z?-En:zt:J=Ce-(lt+at)-b>Z?En:-zt}return{x:$,y:J,text:M}},t.prototype.getHandleLabelStyle=function(n){var r=sa(this.attributes,"handleLabel");return(0,z.pi)((0,z.pi)((0,z.pi)({},r),this.calcHandleText(n)),this.inferTextStyle(n))},t.prototype.getHandleIconStyle=function(){var n=this.attributes.handleIconShape,r=sa(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),s=this.getHandleSize();return(0,z.pi)({cursor:i,shape:n,size:s},r)},t.prototype.getHandleStyle=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.showLabel,u=r.showLabelOnInteraction,h=r.orientation,p=this.calcHandlePosition(n),m=p.x,y=p.y,b=this.calcHandleText(n),w=l;return!l&&u&&(this.target?w=!0:w=!1),(0,z.pi)((0,z.pi)((0,z.pi)({},Hl(this.getHandleIconStyle(),"icon")),Hl((0,z.pi)((0,z.pi)({},this.getHandleLabelStyle(n)),b),"label")),{transform:"translate(".concat(m+i,", ").concat(y+s,")"),orientation:h,showLabel:w,type:n,zIndex:3})},t.prototype.getHandleSize=function(){var n=this.attributes,r=n.handleIconSize,i=n.width,s=n.height;return r||Math.floor((this.getOrientVal([+s,+i])+4)/2.4)},t.prototype.getOrientVal=function(n){var r=(0,z.CR)(n,2),i=r[0],s=r[1],l=this.attributes.orientation;return l==="horizontal"?i:s},t.prototype.setValuesOffset=function(n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=this.attributes.type,l=(0,z.CR)(this.getValues(),2),u=l[0],h=l[1],p=s==="range"?n:0,m=[u+p,h+r].sort();i?this.setValues(m):this.innerSetValues(m,!0)},t.prototype.getRatio=function(n){var r=this.availableSpace,i=r.width,s=r.height;return n/this.getOrientVal([i,s])},t.prototype.dispatchCustomEvent=function(n,r,i){var s=this;n.on(r,function(l){l.stopPropagation(),s.dispatchEvent(new tl(i,{detail:l}))})},t.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var n=this.brushArea;this.dispatchCustomEvent(n,"click","trackClick"),this.dispatchCustomEvent(n,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(n,"pointerleave","trackMouseleave"),n.on("pointerdown",this.onDragStart("track"))},t.prototype.onScroll=function(n){var r=this.attributes.scrollable;if(r){var i=n.deltaX,s=n.deltaY,l=s||i,u=this.getRatio(l);this.setValuesOffset(u,u,!0)}},t.tag="slider",t}(Af),MZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function PZ(e,t,n){const{x:r,y:i,width:s,height:l}=e;if(t==="left")return[r+s-n,i];if(t==="right")return[r,i];if(t==="bottom")return[r,i];if(t==="top")return[r,i+l-n]}const $x=e=>{const{orientation:t,labelFormatter:n,size:r,style:i={},position:s}=e,l=MZ(e,["orientation","labelFormatter","size","style","position"]);return u=>{var h;const{scales:[p],value:m,theme:y,coordinate:b}=u,{bbox:w}=m,{width:R,height:M}=w,{slider:I={}}=y,N=((h=p.getFormatter)===null||h===void 0?void 0:h.call(p))||(pe=>pe+""),U=typeof n=="string"?Lm(n):n,Z=t==="horizontal",Y=gc(b)&&Z,{trackSize:$=I.trackSize}=i,[J,se]=PZ(w,s,$);return new kD({className:"slider",style:Object.assign({},I,Object.assign(Object.assign({x:J,y:se,trackLength:Z?R:M,orientation:t,formatter:pe=>{const Ce=U||N,Ue=Y?1-pe:pe,Je=C_(p,Ue,!0);return Ce(Je)},sparklineData:LZ(e,u)},i),l))})}};function IZ(e,t){const[n]=Array.from(e.entries()).filter(([i])=>i.type==="line"||i.type==="area").filter(([i])=>i.slider).map(([i])=>{const{encode:s,slider:l}=i;if(l!=null&&l.x){const u=h=>{const p=s[h];return[h,p?p.value:void 0]};return Object.fromEntries(t.map(u))}});if(!(n!=null&&n.series))return n==null?void 0:n.y;const r=n.series.reduce((i,s,l)=>(i[s]=i[s]||[],i[s].push(n.y[l]),i),{});return Object.values(r)}function LZ(e,t){const{markState:n}=t;return Is(e.sparklineData)?e.sparklineData:IZ(n,["y","series"])}$x.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const zD=e=>$x(Object.assign(Object.assign({},e),{orientation:"horizontal"}));zD.props=Object.assign(Object.assign({},$x.props),{defaultPosition:"bottom"});const UD=e=>$x(Object.assign(Object.assign({},e),{orientation:"vertical"}));UD.props=Object.assign(Object.assign({},$x.props),{defaultPosition:"left"});var DZ=function(e){(0,z.ZT)(t,e);function t(n){var r=e.call(this,n,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return r.range=[0,1],r.onValueChange=function(i){var s=r.attributes.value;if(i!==s){var l={detail:{oldValue:i,value:s}};r.dispatchEvent(new tl("scroll",l)),r.dispatchEvent(new tl("valuechange",l))}},r.onTrackClick=function(i){var s=r.attributes.slidable;if(s){var l=(0,z.CR)(r.getLocalPosition(),2),u=l[0],h=l[1],p=(0,z.CR)(r.padding,4),m=p[0],y=p[3],b=r.getOrientVal([u+y,h+m]),w=r.getOrientVal(E_(i)),R=(w-b)/r.trackLength;r.setValue(R,!0)}},r.onThumbMouseenter=function(i){r.dispatchEvent(new tl("thumbMouseenter",{detail:i.detail}))},r.onTrackMouseenter=function(i){r.dispatchEvent(new tl("trackMouseenter",{detail:i.detail}))},r.onThumbMouseleave=function(i){r.dispatchEvent(new tl("thumbMouseleave",{detail:i.detail}))},r.onTrackMouseleave=function(i){r.dispatchEvent(new tl("trackMouseleave",{detail:i.detail}))},r}return Object.defineProperty(t.prototype,"padding",{get:function(){var n=this.attributes.padding;return jf(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var n=this.attributes.value,r=(0,z.CR)(this.range,2),i=r[0],s=r[1];return(0,so.Z)(n,i,s)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trackLength",{get:function(){var n=this.attributes,r=n.viewportLength,i=n.trackLength,s=i===void 0?r:i;return s},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableSpace",{get:function(){var n=this.attributes.trackSize,r=this.trackLength,i=(0,z.CR)(this.padding,4),s=i[0],l=i[1],u=i[2],h=i[3],p=(0,z.CR)(this.getOrientVal([[r,n],[n,r]]),2),m=p[0],y=p[1];return{x:h,y:s,width:+m-(h+l),height:+y-(s+u)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trackRadius",{get:function(){var n=this.attributes,r=n.isRound,i=n.trackSize;return r?i/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbRadius",{get:function(){var n=this.attributes,r=n.isRound,i=n.thumbRadius;if(!r)return 0;var s=this.availableSpace,l=s.width,u=s.height;return i||this.getOrientVal([u,l])/2},enumerable:!1,configurable:!0}),t.prototype.getValues=function(n){n===void 0&&(n=this.value);var r=this.attributes,i=r.viewportLength,s=r.contentLength,l=i/s,u=(0,z.CR)(this.range,2),h=u[0],p=u[1],m=n*(p-h-l);return[m,m+l]},t.prototype.getValue=function(){return this.value},t.prototype.renderSlider=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.orientation,u=r.trackSize,h=r.padding,p=r.slidable,m=sa(this.attributes,"track"),y=sa(this.attributes,"thumb"),b=(0,z.pi)((0,z.pi)({x:i,y:s,brushable:!1,orientation:l,padding:h,selectionRadius:this.thumbRadius,showHandle:!1,slidable:p,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:u,values:this.getValues()},Hl(m,"track")),Hl(y,"selection"));this.slider=$a(n).maybeAppendByClassName("scrollbar",function(){return new kD({style:b})}).update(b).node()},t.prototype.render=function(n,r){this.renderSlider(r)},t.prototype.setValue=function(n,r){r===void 0&&(r=!1);var i=this.attributes.value,s=(0,z.CR)(this.range,2),l=s[0],u=s[1];this.slider.setValues(this.getValues((0,so.Z)(n,l,u)),r),this.onValueChange(i)},t.prototype.bindEvents=function(){var n=this;this.slider.addEventListener("trackClick",function(r){r.stopPropagation(),n.onTrackClick(r.detail)}),this.onHover()},t.prototype.getOrientVal=function(n){var r=this.attributes.orientation;return r==="horizontal"?n[0]:n[1]},t.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},t.tag="scrollbar",t}(Af),NZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Kx=e=>{const{orientation:t,labelFormatter:n,style:r}=e,i=NZ(e,["orientation","labelFormatter","style"]);return({scales:[s],value:l,theme:u})=>{const{bbox:h}=l,{x:p,y:m,width:y,height:b}=h,{scrollbar:w={}}=u,{ratio:R,range:M}=s.getOptions(),I=t==="horizontal"?y:b,N=I/R,[U,Z]=M,Y=Z>U?0:1;return new DZ({className:"g2-scrollbar",style:Object.assign({},w,Object.assign(Object.assign(Object.assign(Object.assign({},r),{x:p,y:m,trackLength:I,value:Y}),i),{orientation:t,contentLength:N,viewportLength:I}))})}};Kx.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const jD=e=>Kx(Object.assign(Object.assign({},e),{orientation:"horizontal"}));jD.props=Object.assign(Object.assign({},Kx.props),{defaultPosition:"bottom"});const VD=e=>Kx(Object.assign(Object.assign({},e),{orientation:"vertical"}));VD.props=Object.assign(Object.assign({},Kx.props),{defaultPosition:"left"});const k3=(e,t)=>{const{coordinate:r}=t;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[b,w]=gc(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],R=[{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.01},{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y}];return u.animate(R,Object.assign(Object.assign({},l),e))}},BZ=(e,t)=>{const{coordinate:r}=t;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[b,w]=gc(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],R=[{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:b},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.99},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(R,Object.assign(Object.assign({},l),e))}},HD=(e,t)=>{const{coordinate:r}=t;return ns.registerProperty({name:"scaleInYRadius",inherits:!1,initialValue:"",interpolable:!0,syntax:io.NUMBER}),(i,s,l)=>{const[u]=i,h=m=>{const{__data__:y,style:b}=m,{radius:w=0,inset:R=0,fillOpacity:M=1,strokeOpacity:I=1,opacity:N=1}=b,{points:U,y:Z,y1:Y}=y,$=Gi(r,U,[Z,Y]),{innerRadius:J,outerRadius:se}=$,pe=BS().cornerRadius(w).padAngle(R*Math.PI/180),Ce=new Wi({}),Ue=Ge=>(Ce.attr({d:pe(Ge)}),dm(Ce)),Je=[{scaleInYRadius:J+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{scaleInYRadius:J+1e-4,fillOpacity:M,strokeOpacity:I,opacity:N,offset:.01},{scaleInYRadius:se,fillOpacity:M,strokeOpacity:I,opacity:N}],lt=m.animate(Je,Object.assign(Object.assign({},l),e));return lt.onframe=function(){m.style.d=Ue(Object.assign(Object.assign({},$),{outerRadius:Number(m.style.scaleInYRadius)}))},lt.onfinish=function(){m.style.d=Ue(Object.assign(Object.assign({},$),{outerRadius:se}))},lt},p=m=>{const{style:y}=m,{transform:b="",fillOpacity:w=1,strokeOpacity:R=1,opacity:M=1}=y,[I,N]=gc(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],U=[{transform:`${b} ${N}`.trimStart(),transformOrigin:I,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${b} ${N}`.trimStart(),transformOrigin:I,fillOpacity:w,strokeOpacity:R,opacity:M,offset:.01},{transform:`${b} scale(1, 1)`.trimStart(),transformOrigin:I,fillOpacity:w,strokeOpacity:R,opacity:M}];return m.animate(U,Object.assign(Object.assign({},l),e))};return Ml(r)?h(u):p(u)}},FZ=(e,t)=>{const{coordinate:r}=t;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[b,w]=gc(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],R=[{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:b},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.99},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(R,Object.assign(Object.assign({},l),e))}},ZD=(e,t)=>{ns.registerProperty({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:io.NUMBER});const{coordinate:r}=t;return(i,s,l)=>{const[u]=i;if(!Ml(r))return k3(e,t)(i,s,l);const{__data__:h,style:p}=u,{radius:m=0,inset:y=0,fillOpacity:b=1,strokeOpacity:w=1,opacity:R=1}=p,{points:M,y:I,y1:N}=h,U=BS().cornerRadius(m).padAngle(y*Math.PI/180),Z=Gi(r,M,[I,N]),{startAngle:Y,endAngle:$}=Z,J=[{waveInArcAngle:Y+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:Y+1e-4,fillOpacity:b,strokeOpacity:w,opacity:R,offset:.01},{waveInArcAngle:$,fillOpacity:b,strokeOpacity:w,opacity:R}],se=u.animate(J,Object.assign(Object.assign({},l),e));return se.onframe=function(){u.style.d=U(Object.assign(Object.assign({},Z),{endAngle:Number(u.style.waveInArcAngle)}))},se.onfinish=function(){u.style.d=U(Object.assign(Object.assign({},Z),{endAngle:$}))},se}};ZD.props={};const WD=e=>(t,n,r)=>{const[i]=t,{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=i.style,h=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:s,strokeOpacity:l,opacity:u}];return i.animate(h,Object.assign(Object.assign({},r),e))};WD.props={};const GD=e=>(t,n,r)=>{const[i]=t,{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=i.style,h=[{fillOpacity:s,strokeOpacity:l,opacity:u},{fillOpacity:0,strokeOpacity:0,opacity:0}];return i.animate(h,Object.assign(Object.assign({},r),e))};GD.props={};const kZ=e=>(n,r,i)=>{const[s]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:h=1,opacity:p=1}=s.style,m="center center",y=[{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p,offset:.01},{transform:`${l} scale(1)`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p}];return s.animate(y,Object.assign(Object.assign({},i),e))},zZ=e=>(n,r,i)=>{const[s]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:h=1,opacity:p=1}=s.style,m="center center",y=[{transform:`${l} scale(1)`.trimStart(),transformOrigin:m},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p,offset:.99},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return s.animate(y,Object.assign(Object.assign({},i),e))},XD=e=>(t,n,r)=>{var i,s;const[l]=t,u=((s=(i=l).getTotalLength)===null||s===void 0?void 0:s.call(i))||0,h=[{lineDash:[0,u]},{lineDash:[u,0]}];return l.animate(h,Object.assign(Object.assign({},r),e))};XD.props={};const UZ={opacity:1,strokeOpacity:1,fillOpacity:1,lineWidth:0,x:0,y:0,cx:0,cy:0,r:0,rx:0,ry:0,width:0,height:0},jZ={[Gr.CIRCLE]:["cx","cy","r"],[Gr.ELLIPSE]:["cx","cy","rx","ry"],[Gr.RECT]:["x","y","width","height"],[Gr.IMAGE]:["x","y","width","height"],[Gr.LINE]:["x1","y1","x2","y2"],[Gr.POLYLINE]:["points"],[Gr.POLYGON]:["points"]};function H_(e,t,n=!1){const r={};for(const i of t){const s=e.style[i];s?r[i]=s:n&&(r[i]=UZ[i])}return r}const qx=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"];function z3(e){const{min:t,max:n}=e.getLocalBounds(),[r,i]=t,[s,l]=n,u=l-i,h=s-r;return[r,i,h,u]}function VZ(e){const[t,n,r,i]=e;return`
    M ${t} ${n}
    L ${t+r} ${n}
    L ${t+r} ${n+i}
    L ${t} ${n+i}
    Z
  `}function HZ(e,t){const[n,r,i,s]=z3(e),l=s/i,u=Math.ceil(Math.sqrt(t/l)),h=Math.ceil(t/u),p=[],m=s/h;let y=0,b=t;for(;b>0;){const w=Math.min(b,u),R=i/w;for(let M=0;M<w;M++){const I=n+M*R,N=r+y*m;p.push(VZ([I,N,R,m]))}b-=w,y+=1}return p}function ZZ(e="pack"){return typeof e=="function"?e:HZ}function WZ(e,t,n){let{transform:r}=e.style;const{transform:i}=t.style;YD(t,e);let s=qx;if(e.nodeName===Gr.GROUP){const[h,p,m,y]=z3(e),[b,w,R,M]=z3(t),I=h-b,N=p-w,U=m/R,Z=y/M;r=`translate(${I}, ${N}) scale(${U}, ${Z})`}else s=s.concat(jZ[e.nodeName]||[]);const l=[Object.assign({transform:r!=null?r:"none"},H_(e,s,!0)),Object.assign({transform:i!=null?i:"none"},H_(t,s,!0))];return t.animate(l,n)}function YD(e,t){e.__data__=t.__data__,e.className=t.className,e.markType=t.markType,t.parentNode.replaceChild(e,t)}function GZ(e,t){const{nodeName:n}=e;if(n==="path")return e;const r=new Wi({style:Object.assign(Object.assign({},H_(e,qx)),{d:t})});return YD(r,e),r}function $D(e,t){const n=e.indexOf(t),r=e.lastIndexOf(t);return n===r}function XZ(e){return!$D(e,"m")||!$D(e,"M")}function KD(e){const t=dm(e);if(t&&!XZ(t))return t}function U3(e,t,n,r){const{nodeName:i}=t,{nodeName:s}=n,l=KD(t),u=KD(n);if(i===s&&i!=="path"||(l===void 0||u===void 0))return WZ(t,n,r);const m=GZ(e,l),y=[Object.assign({},H_(t,qx)),Object.assign({},H_(n,qx))];if(l!==u){y[0].d=l,y[1].d=u;const b=m.animate(y,r);return b.onfinish=()=>{const w=m.style.d;Pb(m,n),m.style.d=w,m.style.transform="none"},m.style.transform="none",b}return null}function YZ(e,t,n,r){e.style.visibility="hidden";const i=r(e,t.length);return t.map((s,l)=>{const u=new Wi({style:Object.assign({d:i[l]},H_(e,qx))});return U3(s,u,s,n)})}function $Z(e,t,n,r){const i=r(t,e.length),{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=t.style,h=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:s,strokeOpacity:l,opacity:u}],p=t.animate(h,n);return[...e.map((y,b)=>{const w=new Wi({style:{d:i[b],fill:t.style.fill}});return U3(y,y,w,n)}),p]}const qD=e=>(t,n,r)=>{const i=ZZ(e.split),s=Object.assign(Object.assign({},r),e),{length:l}=t,{length:u}=n;if(l===1&&u===1||l>1&&u>1){const[h]=t,[p]=n;return U3(h,h,p,s)}if(l===1&&u>1){const[h]=t;return YZ(h,n,s,i)}if(l>1&&u===1){const[h]=n;return $Z(t,h,s,i)}return null};qD.props={};const QD=(e,t)=>(n,r,i)=>{const[s]=n,{min:[l,u],halfExtents:h}=s.getLocalBounds(),p=h[0]*2,m=h[1]*2,y=new Wi({style:{d:`M${l},${u}L${l+p},${u}L${l+p},${u+m}L${l},${u+m}Z`}});return s.appendChild(y),s.style.clipPath=y,k3(e,t)([y],r,i)};QD.props={};const JD=(e,t)=>(n,r,i)=>{const[s]=n,{min:[l,u],halfExtents:h}=s.getLocalBounds(),p=h[0]*2,m=h[1]*2,y=new Wi({style:{d:`M${l},${u}L${l+p},${u}L${l+p},${u+m}L${l},${u+m}Z`}});return s.appendChild(y),s.style.clipPath=y,HD(e,t)([y],r,i)};JD.props={};var KZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function qZ(e,{elements:t,datum:n,groupKey:r=y=>y,link:i=!1,background:s=!1,delay:l=60,scale:u,coordinate:h,emitter:p,state:m={}}){var y;const b=t(e),w=new Set(b),R=vc(b,r),M=Rx(b,n),[I,N]=oI(Object.assign({elements:b,valueof:M,link:i,coordinate:h},po(m.active,"link"))),[U,Z,Y]=sI(Object.assign({document:e.ownerDocument,scale:u,coordinate:h,background:s,valueof:M},po(m.active,"background"))),$=ni(m,{active:Object.assign({},((y=m.active)===null||y===void 0?void 0:y.offset)&&{transform:(...Vt)=>{const wt=m.active.offset(...Vt),[,zt]=Vt;return aI(b[zt],wt,h)}})}),{setState:J,removeState:se,hasState:pe}=Bv($,M);let Ce;const Ue=Vt=>{const{target:wt,nativeEvent:zt=!0}=Vt;if(!w.has(wt))return;Ce&&clearTimeout(Ce);const En=r(wt),Vn=R.get(En),ar=new Set(Vn);for(const lr of b)ar.has(lr)?pe(lr,"active")||J(lr,"active"):(J(lr,"inactive"),N(lr)),lr!==wt&&Z(lr);U(wt),I(Vn),zt&&p.emit("element:highlight",{nativeEvent:zt,data:{data:n(wt),group:Vn.map(n)}})},Je=()=>{Ce&&clearTimeout(Ce),Ce=setTimeout(()=>{lt(),Ce=null},l)},lt=(Vt=!0)=>{for(const wt of b)se(wt,"active","inactive"),Z(wt),N(wt);Vt&&p.emit("element:unhighlight",{nativeEvent:Vt})},Ge=Vt=>{const{target:wt}=Vt;s&&!Y(wt)||!s&&!w.has(wt)||(l>0?Je():lt())},at=()=>{lt()};e.addEventListener("pointerover",Ue),e.addEventListener("pointerout",Ge),e.addEventListener("pointerleave",at);const st=Vt=>{const{nativeEvent:wt}=Vt;wt||lt(!1)},ft=Vt=>{const{nativeEvent:wt}=Vt;if(wt)return;const{data:zt}=Vt.data,En=wO(b,zt,n);En&&Ue({target:En,nativeEvent:!1})};return p.on("element:highlight",ft),p.on("element:unhighlight",st),()=>{e.removeEventListener("pointerover",Ue),e.removeEventListener("pointerout",Ge),e.removeEventListener("pointerleave",at),p.off("element:highlight",ft),p.off("element:unhighlight",st);for(const Vt of b)Z(Vt),N(Vt)}}function TT(e){var{delay:t,createGroup:n,background:r=!1,link:i=!1}=e,s=KZ(e,["delay","createGroup","background","link"]);return(l,u,h)=>{const{container:p,view:m,options:y}=l,{scale:b,coordinate:w}=m,R=Hm(p);return qZ(R,Object.assign({elements:zg,datum:a1(m),groupKey:n?n(m):void 0,coordinate:w,scale:b,state:R_(y,[["active",r?{}:{lineWidth:"1",stroke:"#000"}],"inactive"]),background:r,link:i,delay:t,emitter:h},s))}}TT.props={reapplyWhenUpdate:!0};function eN(e){return TT(Object.assign(Object.assign({},e),{createGroup:TO}))}eN.props={reapplyWhenUpdate:!0};function tN(e){return TT(Object.assign(Object.assign({},e),{createGroup:iI}))}tN.props={reapplyWhenUpdate:!0};var QZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function JZ(e,{elements:t,datum:n,groupKey:r=y=>y,link:i=!1,single:s=!1,coordinate:l,background:u=!1,scale:h,emitter:p,state:m={}}){var y;const b=t(e),w=new Set(b),R=vc(b,r),M=Rx(b,n),[I,N]=oI(Object.assign({link:i,elements:b,valueof:M,coordinate:l},po(m.selected,"link"))),[U,Z]=sI(Object.assign({document:e.ownerDocument,background:u,coordinate:l,scale:h,valueof:M},po(m.selected,"background"))),Y=ni(m,{selected:Object.assign({},((y=m.selected)===null||y===void 0?void 0:y.offset)&&{transform:(...at)=>{const st=m.selected.offset(...at),[,ft]=at;return aI(b[ft],st,l)}})}),{setState:$,removeState:J,hasState:se}=Bv(Y,M),pe=(at=!0)=>{for(const st of b)J(st,"selected","unselected"),N(st),Z(st);at&&p.emit("element:unselect",{nativeEvent:!0})},Ce=(at,st,ft=!0)=>{if(se(st,"selected"))pe();else{const Vt=r(st),wt=R.get(Vt),zt=new Set(wt);for(const En of b)zt.has(En)?$(En,"selected"):($(En,"unselected"),N(En)),En!==st&&Z(En);if(I(wt),U(st),!ft)return;p.emit("element:select",Object.assign(Object.assign({},at),{nativeEvent:ft,data:{data:[n(st),...wt.map(n)]}}))}},Ue=(at,st,ft=!0)=>{const Vt=r(st),wt=R.get(Vt),zt=new Set(wt);if(se(st,"selected")){if(!b.some(Vn=>!zt.has(Vn)&&se(Vn,"selected")))return pe();for(const Vn of wt)$(Vn,"unselected"),N(Vn),Z(Vn)}else{const En=wt.some(Vn=>se(Vn,"selected"));for(const Vn of b)zt.has(Vn)?$(Vn,"selected"):se(Vn,"selected")||$(Vn,"unselected");!En&&i&&I(wt),U(st)}ft&&p.emit("element:select",Object.assign(Object.assign({},at),{nativeEvent:ft,data:{data:b.filter(En=>se(En,"selected")).map(n)}}))},Je=at=>{const{target:st,nativeEvent:ft=!0}=at;return w.has(st)?s?Ce(at,st,ft):Ue(at,st,ft):pe()};e.addEventListener("click",Je);const lt=at=>{const{nativeEvent:st,data:ft}=at;if(st)return;const Vt=s?ft.data.slice(0,1):ft.data;for(const wt of Vt){const zt=wO(b,wt,n);Je({target:zt,nativeEvent:!1})}},Ge=()=>{pe(!1)};return p.on("element:select",lt),p.on("element:unselect",Ge),()=>{for(const at of b)N(at);e.removeEventListener("click",Je),p.off("element:select",lt),p.off("element:unselect",Ge)}}function wT(e){var{createGroup:t,background:n=!1,link:r=!1}=e,i=QZ(e,["createGroup","background","link"]);return(s,l,u)=>{const{container:h,view:p,options:m}=s,{coordinate:y,scale:b}=p,w=Hm(h);return JZ(w,Object.assign({elements:zg,datum:a1(p),groupKey:t?t(p):void 0,coordinate:y,scale:b,state:R_(m,[["selected",n?{}:{lineWidth:"1",stroke:"#000"}],"unselected"]),background:n,link:r,emitter:u},i))}}wT.props={reapplyWhenUpdate:!0};function nN(e){return wT(Object.assign(Object.assign({},e),{createGroup:TO}))}nN.props={reapplyWhenUpdate:!0};function rN(e){return wT(Object.assign(Object.assign({},e),{createGroup:iI}))}rN.props={reapplyWhenUpdate:!0};var y1=function(e,t,n){var r,i,s,l,u=0;n||(n={});var h=function(){u=n.leading===!1?0:Date.now(),r=null,l=e.apply(i,s),r||(i=s=null)},p=function(){var m=Date.now();!u&&n.leading===!1&&(u=m);var y=t-(m-u);return i=this,s=arguments,y<=0||y>t?(r&&(clearTimeout(r),r=null),u=m,l=e.apply(i,s),r||(i=s=null)):!r&&n.trailing!==!1&&(r=setTimeout(h,y)),l};return p.cancel=function(){clearTimeout(r),u=0,r=i=s=null},p};function eW(e){const{coordinate:t={}}=e,{transform:n=[]}=t,r=n.find(s=>s.type==="fisheye");if(r)return r;const i={type:"fisheye"};return n.push(i),t.transform=n,e.coordinate=t,i}function tW({wait:e=30,leading:t,trailing:n=!1}){return r=>{const{options:i,update:s,setState:l,container:u}=r,h=Hm(u),p=y1(m=>{const y=Ox(h,m);if(!y){l("fisheye"),s();return}l("fisheye",b=>{const w=ni({},b,{interaction:{tooltip:{preserve:!0}}});for(const N of w.marks)N.animate=!1;const[R,M]=y,I=eW(w);return I.focusX=R,I.focusY=M,I.visual=!0,w}),s()},e,{leading:t,trailing:n});return h.addEventListener("pointerenter",p),h.addEventListener("pointermove",p),h.addEventListener("pointerleave",p),()=>{h.removeEventListener("pointerenter",p),h.removeEventListener("pointermove",p),h.removeEventListener("pointerleave",p)}}}var nW=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},rW=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function iW(e){const{transform:t=[]}=e,n=t.find(i=>i.type==="normalizeY");if(n)return n;const r={type:"normalizeY"};return t.push(r),e.transform=t,r}function oW(e,t,n){const[r]=Array.from(e.entries()).filter(([i])=>i.type===t).map(([i])=>{const{encode:s}=i,l=u=>{const h=s[u];return[u,h?h.value:void 0]};return Object.fromEntries(n.map(l))});return r}function iN(e){var{wait:t=20,leading:n,trailing:r=!1,labelFormatter:i=l=>`${l}`}=e,s=rW(e,["wait","leading","trailing","labelFormatter"]);return l=>{const{view:u,container:h,update:p,setState:m}=l,{markState:y,scale:b,coordinate:w}=u,R=oW(y,"line",["x","y","series"]);if(!R)return;const{y:M,x:I,series:N=[]}=R,U=M.map((Vt,wt)=>wt),Z=em(U.map(Vt=>I[Vt])),Y=Hm(h),$=h.getElementsByClassName(Ut),J=h.getElementsByClassName(Bt),pe=vc(J,Vt=>Vt.__data__.key.split("-")[0]),Ce=new Po({style:Object.assign({x1:0,y1:0,x2:0,y2:Y.getAttribute("height"),stroke:"black",lineWidth:1},po(s,"rule"))}),Ue=new ma({style:Object.assign({x:0,y:Y.getAttribute("height"),text:"",fontSize:10},po(s,"label"))});Ce.append(Ue),Y.appendChild(Ce);const Je=(Vt,wt,zt)=>{const[En]=Vt.invert(zt),Vn=wt.invert(En);return Z[Zk(Z,Vn)]},lt=(Vt,wt)=>{Ce.setAttribute("x1",Vt[0]),Ce.setAttribute("x2",Vt[0]),Ue.setAttribute("text",i(wt))};let Ge;const at=Vt=>nW(this,void 0,void 0,function*(){const{x:wt}=b,zt=Je(w,wt,Vt);lt(Vt,zt),m("chartIndex",Vn=>{const ar=ni({},Vn),lr=ar.marks.find(Qr=>Qr.type==="line"),ui=Sl(W1(U,Qr=>Sl(Qr,Mo=>+M[Mo])/Zp(Qr,Mo=>+M[Mo]),Qr=>N[Qr]).values()),qi=[1/ui,ui];ni(lr,{scale:{y:{domain:qi}}});const Jr=iW(lr);Jr.groupBy="color",Jr.basis=(Qr,Mo)=>{const Qi=Qr[Fg(Zi=>I[+Zi]).center(Qr,zt)];return Mo[Qi]};for(const Qr of ar.marks)Qr.animate=!1;return ar}),Ge=(yield p("chartIndex")).view}),st=Vt=>{const{scale:wt,coordinate:zt}=Ge,{x:En,y:Vn}=wt,ar=Je(zt,En,Vt);lt(Vt,ar);for(const lr of $){const{seriesIndex:Vr,key:ui}=lr.__data__,qi=Vr[Fg(Go=>I[+Go]).center(Vr,ar)],Jr=[0,Vn.map(1)],Qr=[0,Vn.map(M[qi]/M[Vr[0]])],[,Mo]=zt.map(Jr),[,Qi]=zt.map(Qr),Zi=Mo-Qi;lr.setAttribute("transform",`translate(0, ${Zi})`);const Eo=pe.get(ui)||[];for(const Go of Eo)Go.setAttribute("dy",Zi)}},ft=y1(Vt=>{const wt=Ox(Y,Vt);wt&&st(wt)},t,{leading:n,trailing:r});return at([0,0]),Y.addEventListener("pointerenter",ft),Y.addEventListener("pointermove",ft),Y.addEventListener("pointerleave",ft),()=>{Ce.remove(),Y.removeEventListener("pointerenter",ft),Y.removeEventListener("pointermove",ft),Y.removeEventListener("pointerleave",ft)}}}iN.props={reapplyWhenUpdate:!0};function Qx(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);return r}function Jx(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function oN(e){var t=document.createElement("div");t.innerHTML=e;var n=t.childNodes[0];return n&&t.contains(n)&&t.removeChild(n),n}function aW(e,t){return!e||!t?e:e.replace(/\\?\{([^{}]+)\}/g,function(n,r){return n.charAt(0)==="\\"?n.slice(1):t[r]===void 0?"":t[r]})}var sW=aW,aN=function(e,t){if(t==null){e.innerHTML="";return}e.replaceChildren?Array.isArray(t)?e.replaceChildren.apply(e,(0,z.ev)([],(0,z.CR)(t),!1)):e.replaceChildren(t):(e.innerHTML="",Array.isArray(t)?t.forEach(function(n){return e.appendChild(n)}):e.appendChild(t))};function j3(e){return e===void 0&&(e=""),{CONTAINER:"".concat(e,"tooltip"),TITLE:"".concat(e,"tooltip-title"),LIST:"".concat(e,"tooltip-list"),LIST_ITEM:"".concat(e,"tooltip-list-item"),NAME:"".concat(e,"tooltip-list-item-name"),MARKER:"".concat(e,"tooltip-list-item-marker"),NAME_LABEL:"".concat(e,"tooltip-list-item-name-label"),VALUE:"".concat(e,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(e,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(e,"tooltip-crosshair-y")}}var sN={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function lW(e){var t;e===void 0&&(e="");var n=j3(e);return t={},t[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},t[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},t[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},t[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},t[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},t[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},t[".".concat(n.NAME_LABEL)]=(0,z.pi)({flex:1},sN),t[".".concat(n.VALUE)]=(0,z.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},sN),t[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t}var cW=function(e){(0,z.ZT)(t,e);function t(n){var r=this,i,s,l=(s=(i=n.style)===null||i===void 0?void 0:i.template)===null||s===void 0?void 0:s.prefixCls,u=j3(l);return r=e.call(this,n,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(u.CONTAINER,'"></div>'),title:'<div class="'.concat(u.TITLE,'"></div>'),item:'<li class="'.concat(u.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(u.NAME,`">
          <span class="`).concat(u.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(u.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(u.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:lW(l)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(t.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.element},Object.defineProperty(t.prototype,"elementSize",{get:function(){var n=this.element.offsetWidth,r=this.element.offsetHeight;return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HTMLTooltipItemsElements",{get:function(){var n=this.attributes,r=n.data,i=n.template;return r.map(function(s,l){var u=s.name,h=u===void 0?"":u,p=s.color,m=p===void 0?"black":p,y=s.index,b=(0,z._T)(s,["name","color","index"]),w=(0,z.pi)({name:h,color:m,index:y!=null?y:l},b);return oN(sW(i.item,w))})},enumerable:!1,configurable:!0}),t.prototype.render=function(n,r){this.renderHTMLTooltipElement(),this.updatePosition()},t.prototype.destroy=function(){var n;(n=this.element)===null||n===void 0||n.remove(),e.prototype.destroy.call(this)},t.prototype.show=function(n,r){var i=this;if(n!==void 0&&r!==void 0){var s=this.element.style.visibility==="hidden",l=function(){i.attributes.x=n!=null?n:i.attributes.x,i.attributes.y=r!=null?r:i.attributes.y,i.updatePosition()};s?this.closeTransition(l):l()}this.element.style.visibility="visible"},t.prototype.hide=function(n,r){n===void 0&&(n=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(n,r)||(this.element.style.visibility="hidden")},t.prototype.initShape=function(){var n=this.attributes.template;this.element=oN(n.container),this.id&&this.element.setAttribute("id",this.id)},t.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var n=this.attributes.content;n&&(typeof n=="string"?this.element.innerHTML=n:aN(this.element,n))}},t.prototype.renderHTMLTooltipElement=function(){var n,r,i=this.attributes,s=i.template,l=i.title,u=i.enterable,h=i.style,p=i.content,m=j3(s.prefixCls),y=this.element;if(this.element.style.pointerEvents=u?"auto":"none",p)this.renderCustomContent();else{l?(y.innerHTML=s.title,y.getElementsByClassName(m.TITLE)[0].innerHTML=l):(r=(n=y.getElementsByClassName(m.TITLE))===null||n===void 0?void 0:n[0])===null||r===void 0||r.remove();var b=this.HTMLTooltipItemsElements,w=document.createElement("ul");w.className=m.LIST,aN(w,b);var R=this.element.querySelector(".".concat(m.LIST));R?R.replaceWith(w):y.appendChild(w)}hf(y,h)},t.prototype.getRelativeOffsetFromCursor=function(n){var r=this.attributes,i=r.position,s=r.offset,l=n||i,u=l.split("-"),h={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},p=this.elementSize,m=p.width,y=p.height,b=[-m/2,-y/2];return u.forEach(function(w){var R=(0,z.CR)(b,2),M=R[0],I=R[1],N=(0,z.CR)(h[w],2),U=N[0],Z=N[1];b=[M+(m/2+s[0])*U,I+(y/2+s[1])*Z]}),b},t.prototype.setOffsetPosition=function(n){var r=(0,z.CR)(n,2),i=r[0],s=r[1],l=this.attributes,u=l.x,h=u===void 0?0:u,p=l.y,m=p===void 0?0:p,y=l.container,b=y.x,w=y.y;this.element.style.left="".concat(+h+b+i,"px"),this.element.style.top="".concat(+m+w+s,"px")},t.prototype.updatePosition=function(){var n=this.attributes.showDelay,r=n===void 0?60:n,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},t.prototype.autoPosition=function(n){var r=(0,z.CR)(n,2),i=r[0],s=r[1],l=this.attributes,u=l.x,h=l.y,p=l.bounding,m=l.position;if(!p)return[i,s];var y=this.element,b=y.offsetWidth,w=y.offsetHeight,R=(0,z.CR)([+u+i,+h+s],2),M=R[0],I=R[1],N={left:"right",right:"left",top:"bottom",bottom:"top"},U=p.x,Z=p.y,Y=p.width,$=p.height,J={left:M<U,right:M+b>U+Y,top:I<Z,bottom:I+w>Z+$},se=[];m.split("-").forEach(function(Ce){J[Ce]?se.push(N[Ce]):se.push(Ce)});var pe=se.join("-");return this.getRelativeOffsetFromCursor(pe)},t.prototype.isCursorEntered=function(n,r){if(this.element){var i=this.element.getBoundingClientRect(),s=i.x,l=i.y,u=i.width,h=i.height;return new yc(s,l,u,h).isPointIn(n,r)}return!1},t.prototype.closeTransition=function(n){var r=this,i=this.element.style.transition;this.element.style.transition="none",n(),setTimeout(function(){r.element.style.transition=i},10)},t.tag="tooltip",t}(Af),_1=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function AT(e,t){return t?typeof t=="string"?document.querySelector(t):t:e.ownerDocument.defaultView.getContextService().getDomElement().parentElement}function uW(e){const t=e.getRenderBounds(),{min:[n,r],max:[i,s]}=t;return{x:n,y:r,width:i-n,height:s-r}}function fW(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:n.x-r.x,y:n.y-r.y}}function hW(e,t,n,r,i,s,l,u={},h=[10,10]){const p={".g2-tooltip":{},".g2-tooltip-title":{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},m=new cW({className:"tooltip",style:{x:t,y:n,container:l,data:[],bounding:s,position:r,enterable:i,title:"",offset:h,template:{prefixCls:"g2-"},style:ni(p,u)}});return e.appendChild(m.HTMLTooltipElement),m}function lN({root:e,data:t,x:n,y:r,render:i,event:s,single:l,position:u="right-bottom",enterable:h=!1,css:p,mount:m,bounding:y,offset:b}){const w=AT(e,m),R=AT(e),M=l?R:e,I=y||uW(e),N=fW(R,w),{tooltipElement:U=hW(w,n,r,u,h,I,N,p,b)}=M,{items:Z,title:Y=""}=t;U.update(Object.assign({x:n,y:r,data:Z,title:Y,position:u,enterable:h},i!==void 0&&{content:i(s,{items:Z,title:Y})})),M.tooltipElement=U}function Yg({root:e,single:t,emitter:n,nativeEvent:r=!0,event:i=null}){r&&n.emit("tooltip:hide",{nativeEvent:r});const s=AT(e),l=t?s:e,{tooltipElement:u}=l;u&&u.hide(i==null?void 0:i.clientX,i==null?void 0:i.clientY),dN(e),pN(e),mN(e)}function V3({root:e,single:t}){const n=AT(e),r=t?n:e;if(!r)return;const{tooltipElement:i}=r;i&&(i.destroy(),r.tooltipElement=void 0),dN(e),pN(e),mN(e)}function cN(e){const{value:t}=e;return Object.assign(Object.assign({},e),{value:t===void 0?"undefined":t})}function dW(e){const{__data__:t}=e,{title:n,items:r=[]}=t,i=r.filter(Ql).map(s=>{var{color:l=uN(e)}=s,u=_1(s,["color"]);return Object.assign(Object.assign({},u),{color:l})}).map(cN);return Object.assign(Object.assign({},n&&{title:n}),{items:i})}function pW(e,t){const{color:n,series:r,facet:i=!1}=e,{color:s,series:l}=t,u=h=>h&&h.invert&&!(h instanceof Wg)&&!(h instanceof r1);if(u(r))return r.clone().invert(l);if(l&&r instanceof Wg&&r.invert(l)!==s&&!i)return r.invert(l);if(u(n)){const h=n.invert(s);return Array.isArray(h)?null:h}return null}function uN(e){const t=e.getAttribute("fill"),n=e.getAttribute("stroke"),{__data__:r}=e,{color:i=t&&t!=="transparent"?t:n}=r;return i}function fN(e,t=n=>n){const n=new Map(e.map(r=>[t(r),r]));return Array.from(n.values())}function hN(e,t,n,r=e.map(s=>s.__data__),i={}){const s=h=>h instanceof Date?+h:h,l=fN(r.map(h=>h.title),s).filter(Ql),u=r.flatMap((h,p)=>{const m=e[p],{items:y=[],title:b}=h,w=y.filter(Ql),R=n!==void 0?n:y.length<=1;return w.map(M=>{var{color:I=uN(m)||i.color,name:N}=M,U=_1(M,["color","name"]);const Z=pW(t,h),Y=R?Z||N:N||Z;return Object.assign(Object.assign({},U),{color:I,name:Y||b})})}).map(cN);return Object.assign(Object.assign({},l.length>0&&{title:l.join(",")}),{items:fN(u,h=>`(${s(h.name)}, ${s(h.value)}, ${s(h.color)})`)})}function mW(e,t,n,r){var{plotWidth:i,plotHeight:s,mainWidth:l,mainHeight:u,startX:h,startY:p,transposed:m,polar:y,insetLeft:b,insetTop:w}=r,R=_1(r,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const M=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},R),I=(J,se,pe)=>{const Ce=new Ir({style:Object.assign({cx:J,cy:se,r:pe},M)});return e.appendChild(Ce),Ce},N=(J,se,pe,Ce)=>{const Ue=new Po({style:Object.assign({x1:J,x2:se,y1:pe,y2:Ce},M)});return e.appendChild(Ue),Ue},Z=((J,se)=>{if(se.length===1)return se[0];const pe=se.map(Ue=>Ve(Ue,J)),Ce=Qx(pe,Ue=>Ue);return se[Ce]})(n,t),Y=()=>m?[h+Z[0],h+Z[0],p,p+s]:[h,h+i,Z[1]+p,Z[1]+p],$=()=>{const J=h+b+l/2,se=p+w+u/2,pe=Ve([J,se],Z);return[J,se,pe]};if(y){const[J,se,pe]=$(),Ce=e.ruleX||I(J,se,pe);Ce.style.cx=J,Ce.style.cy=se,Ce.style.r=pe,e.ruleX=Ce}else{const[J,se,pe,Ce]=Y(),Ue=e.ruleX||N(J,se,pe,Ce);Ue.style.x1=J,Ue.style.x2=se,Ue.style.y1=pe,Ue.style.y2=Ce,e.ruleX=Ue}}function vW(e,t,n){var{plotWidth:r,plotHeight:i,mainWidth:s,mainHeight:l,startX:u,startY:h,transposed:p,polar:m,insetLeft:y,insetTop:b}=n,w=_1(n,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const R=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},w),M=t.map(Ce=>Ce[1]),I=t.map(Ce=>Ce[0]),N=Jx(M),U=Jx(I),Z=()=>{if(m){const Ce=Math.min(s,l)/2,Ue=u+y+s/2,Je=h+b+l/2,lt=Mt(ge([U,N],[Ue,Je])),Ge=Ue+Ce*Math.cos(lt),at=Je+Ce*Math.sin(lt);return[Ue,Ge,Je,at]}return p?[u,u+r,N+h,N+h]:[U+u,U+u,h,h+i]},[Y,$,J,se]=Z(),pe=()=>{const Ce=new Po({style:Object.assign({x1:Y,x2:$,y1:J,y2:se},R)});return e.appendChild(Ce),Ce};if(I.length>0){const Ce=e.ruleY||pe();Ce.style.x1=Y,Ce.style.x2=$,Ce.style.y1=J,Ce.style.y2=se,e.ruleY=Ce}}function dN(e){e.ruleY&&(e.ruleY.remove(),e.ruleY=void 0)}function pN(e){e.ruleX&&(e.ruleX.remove(),e.ruleX=void 0)}function gW(e,{data:t,style:n,theme:r}){e.markers&&e.markers.forEach(l=>l.remove());const{type:i=""}=n,s=t.filter(l=>{const[{x:u,y:h}]=l;return Ql(u)&&Ql(h)}).map(l=>{const[{color:u,element:h},p]=l,m=u||h.style.fill||h.style.stroke||r.color,y=i==="hollow"?"transparent":m,b=i==="hollow"?m:"#fff";return new Ir({className:"g2-tooltip-marker",style:Object.assign({cx:p[0],cy:p[1],fill:y,r:4,stroke:b,lineWidth:2},n)})});for(const l of s)e.appendChild(l);e.markers=s}function mN(e){e.markers&&(e.markers.forEach(t=>t.remove()),e.markers=[])}function vN(e,t){return Array.from(e.values()).some(n=>{var r;return(r=n.interaction)===null||r===void 0?void 0:r[t]})}function kv(e,t){return e===void 0?t:e}function gN(e){const{title:t,items:n}=e;return n.length===0&&t===void 0}function yW(e){return Array.from(e.values()).some(t=>{var n;return((n=t.interaction)===null||n===void 0?void 0:n.seriesTooltip)&&t.tooltip})}function yN(e,t){var{elements:n,sort:r,filter:i,scale:s,coordinate:l,crosshairs:u,crosshairsX:h,crosshairsY:p,render:m,groupName:y,emitter:b,wait:w=50,leading:R=!0,trailing:M=!1,startX:I=0,startY:N=0,body:U=!0,single:Z=!0,position:Y,enterable:$,mount:J,bounding:se,theme:pe,offset:Ce,disableNative:Ue=!1,marker:Je=!0,preserve:lt=!1,style:Ge={},css:at={}}=t,st=_1(t,["elements","sort","filter","scale","coordinate","crosshairs","crosshairsX","crosshairsY","render","groupName","emitter","wait","leading","trailing","startX","startY","body","single","position","enterable","mount","bounding","theme","offset","disableNative","marker","preserve","style","css"]);const ft=n(e),Vt=gc(l),wt=Ml(l),zt=ni(Ge,st),{innerWidth:En,innerHeight:Vn,width:ar,height:lr,insetLeft:Vr,insetTop:ui}=l.getOptions(),qi=[],Jr=[];for(const ta of ft){const{__data__:qa}=ta,{seriesX:Ps,title:Ns,items:xc}=qa;Ps?qi.push(ta):(Ns||xc)&&Jr.push(ta)}const Qr=ta=>ta.markType==="interval",Mo=Jr.length&&Jr.every(Qr)&&!Ml(l),Qi=ta=>ta.__data__.x,Eo=!!s.x.getBandWidth&&Jr.length>0;qi.sort((ta,qa)=>{const Ps=Vt?0:1,Ns=xc=>xc.getBounds().min[Ps];return Vt?Ns(qa)-Ns(ta):Ns(ta)-Ns(qa)});const Go=ta=>{const qa=Vt?1:0,{min:Ps,max:Ns}=ta.getLocalBounds();return em([Ps[qa],Ns[qa]])};Mo?ft.sort((ta,qa)=>Qi(ta)-Qi(qa)):Jr.sort((ta,qa)=>{const[Ps,Ns]=Go(ta),[xc,nf]=Go(qa),rf=(Ps+Ns)/2,Fh=(xc+nf)/2;return Vt?Fh-rf:rf-Fh});const oa=new Map(qi.map(ta=>{const{__data__:qa}=ta,{seriesX:Ps}=qa,Ns=Ps.map((nf,rf)=>rf),xc=em(Ns,nf=>Ps[+nf]);return[ta,[xc,Ps]]})),{x:Ca}=s,Vs=Ca!=null&&Ca.getBandWidth?Ca.getBandWidth()/2:0,Sa=ta=>{const[qa]=l.invert(ta);return qa-Vs},us=(ta,qa,Ps,Ns)=>{const{_x:xc}=ta,nf=xc!==void 0?Ca.map(xc):Sa(qa),rf=Ns.filter(Ql),[Fh,M0]=em([rf[0],rf[rf.length-1]]),am=Fh===M0;if(!Eo&&(nf<Fh||nf>M0)&&!am)return null;const ob=Fg(Wv=>Ns[+Wv]).center,I2=ob(Ps,nf);return Ps[I2]},wl=Mo?(ta,qa)=>{const Ps=Fg(Qi).center,Ns=Ps(qa,Sa(ta)),xc=qa[Ns];return vc(qa,Qi).get(Qi(xc))}:(ta,qa)=>{const Ns=ta[Vt?1:0],xc=qa.filter(Fh=>{const[M0,am]=Go(Fh);return Ns>=M0&&Ns<=am});if(!Eo||xc.length>0)return xc;const nf=Fg(Fh=>{const[M0,am]=Go(Fh);return(M0+am)/2}).center,rf=nf(qa,Ns);return[qa[rf]].filter(Ql)},Cu=(ta,qa)=>{const{__data__:Ps}=ta;return Object.fromEntries(Object.entries(Ps).filter(([Ns])=>Ns.startsWith("series")&&Ns!=="series").map(([Ns,xc])=>{const nf=xc[qa];return[Rb(Ns.replace("series","")),nf]}))},Gf=y1(ta=>{var qa;const Ps=Ox(e,ta);if(!Ps)return;const Ns=rI(e),xc=Ns.min[0],nf=Ns.min[1],rf=[Ps[0]-I,Ps[1]-N];if(!rf)return;const Fh=wl(rf,Jr),M0=[],am=[];for(const mf of qi){const[D2,NM]=oa.get(mf),N2=us(ta,rf,D2,NM);if(N2!==null){M0.push(mf);const ww=Cu(mf,N2),{x:gte,y:yte}=ww,_te=l.map([(gte||0)+Vs,yte||0]);am.push([Object.assign(Object.assign({},ww),{element:mf}),_te])}}const ob=Array.from(new Set(am.map(mf=>mf[0].x))),I2=ob[Qx(ob,mf=>Math.abs(mf-Sa(rf)))],Wv=am.filter(mf=>mf[0].x===I2),LM=[...Wv.map(mf=>mf[0]),...Fh.map(mf=>mf.__data__)],Tw=[...M0,...Fh],L2=hN(Tw,s,y,LM,pe);if(r&&L2.items.sort((mf,D2)=>r(mf)-r(D2)),i&&(L2.items=L2.items.filter(i)),Tw.length===0||gN(L2)){Zc(ta);return}if(U&&lN({root:e,data:L2,x:Ps[0]+xc,y:Ps[1]+nf,render:m,event:ta,single:Z,position:Y,enterable:$,mount:J,bounding:se,css:at,offset:Ce}),u||h||p){const mf=po(zt,"crosshairs"),D2=Object.assign(Object.assign({},mf),po(zt,"crosshairsX")),NM=Object.assign(Object.assign({},mf),po(zt,"crosshairsY")),N2=Wv.map(ww=>ww[1]);h&&mW(e,N2,Ps,Object.assign(Object.assign({},D2),{plotWidth:En,plotHeight:Vn,mainWidth:ar,mainHeight:lr,insetLeft:Vr,insetTop:ui,startX:I,startY:N,transposed:Vt,polar:wt})),p&&vW(e,N2,Object.assign(Object.assign({},NM),{plotWidth:En,plotHeight:Vn,mainWidth:ar,mainHeight:lr,insetLeft:Vr,insetTop:ui,startX:I,startY:N,transposed:Vt,polar:wt}))}if(Je){const mf=po(zt,"marker");gW(e,{data:Wv,style:mf,theme:pe})}const DM=(qa=Wv[0])===null||qa===void 0?void 0:qa[0].x,vte=DM!=null?DM:Sa(rf);b.emit("tooltip:show",Object.assign(Object.assign({},ta),{nativeEvent:!0,data:{data:{x:C_(s.x,vte,!0)}}}))},w,{leading:R,trailing:M}),Zc=ta=>{Yg({root:e,single:Z,emitter:b,event:ta})},ph=()=>{V3({root:e,single:Z})},Ou=ta=>{var qa,{nativeEvent:Ps,data:Ns,offsetX:xc,offsetY:nf}=ta,rf=_1(ta,["nativeEvent","data","offsetX","offsetY"]);if(Ps)return;const Fh=(qa=Ns==null?void 0:Ns.data)===null||qa===void 0?void 0:qa.x,am=s.x.map(Fh),[ob,I2]=l.map([am,.5]),Wv=e.getRenderBounds(),LM=Wv.min[0],Tw=Wv.min[1];Gf(Object.assign(Object.assign({},rf),{offsetX:xc!==void 0?xc:LM+ob,offsetY:nf!==void 0?nf:Tw+I2,_x:Fh}))},kd=()=>{Yg({root:e,single:Z,emitter:b,nativeEvent:!1})},bc=()=>{Rf(),ph()},Pc=()=>{Bh()},Bh=()=>{Ue||(e.addEventListener("pointerenter",Gf),e.addEventListener("pointermove",Gf),e.addEventListener("pointerleave",ta=>{Ox(e,ta)||Zc(ta)}))},Rf=()=>{Ue||(e.removeEventListener("pointerenter",Gf),e.removeEventListener("pointermove",Gf),e.removeEventListener("pointerleave",Zc))};return Bh(),b.on("tooltip:show",Ou),b.on("tooltip:hide",kd),b.on("tooltip:disable",bc),b.on("tooltip:enable",Pc),()=>{Rf(),b.off("tooltip:show",Ou),b.off("tooltip:hide",kd),b.off("tooltip:disable",bc),b.off("tooltip:enable",Pc),lt?Yg({root:e,single:Z,emitter:b,nativeEvent:!1}):ph()}}function _W(e,{elements:t,coordinate:n,scale:r,render:i,groupName:s,sort:l,filter:u,emitter:h,wait:p=50,leading:m=!0,trailing:y=!1,groupKey:b=Je=>Je,single:w=!0,position:R,enterable:M,datum:I,view:N,mount:U,bounding:Z,theme:Y,offset:$,shared:J=!1,body:se=!0,disableNative:pe=!1,preserve:Ce=!1,css:Ue={}}){var Je,lt;const Ge=t(e),at=vc(Ge,b),st=Zi=>Zi.markType==="interval",ft=Ge.every(st)&&!Ml(n),Vt=r.x,wt=r.series,zt=(lt=(Je=Vt==null?void 0:Vt.getBandWidth)===null||Je===void 0?void 0:Je.call(Vt))!==null&&lt!==void 0?lt:0,En=wt?Zi=>Zi.__data__.x+Zi.__data__.series*zt:Zi=>Zi.__data__.x+zt/2;ft&&Ge.sort((Zi,Eo)=>En(Zi)-En(Eo));const Vn=Zi=>{const{target:Eo}=Zi;return jS(Eo,Go=>Go.classList?Go.classList.includes("element"):!1)},ar=ft?Zi=>{const Eo=Ox(e,Zi);if(!Eo)return;const[Go]=n.invert(Eo),oa=Go,Ca=Fg(En).center,Vs=Ca(Ge,oa),Sa=Ge[Vs];return!J&&Ge.find(wl=>wl!==Sa&&En(wl)===En(Sa))?Vn(Zi):Sa}:Vn,lr=y1(Zi=>{const Eo=ar(Zi);if(!Eo){Yg({root:e,single:w,emitter:h,event:Zi});return}const Go=b(Eo),oa=at.get(Go);if(!oa)return;const Ca=oa.length===1&&!J?dW(oa[0]):hN(oa,r,s,void 0,Y);if(l&&Ca.items.sort((us,wl)=>l(us)-l(wl)),u&&(Ca.items=Ca.items.filter(u)),gN(Ca)){Yg({root:e,single:w,emitter:h,event:Zi});return}const{offsetX:Vs,offsetY:Sa}=Zi;se&&lN({root:e,data:Ca,x:Vs,y:Sa,render:i,event:Zi,single:w,position:R,enterable:M,mount:U,bounding:Z,css:Ue,offset:$}),h.emit("tooltip:show",Object.assign(Object.assign({},Zi),{nativeEvent:!0,data:{data:cI(Eo,N)}}))},p,{leading:m,trailing:y}),Vr=Zi=>{Yg({root:e,single:w,emitter:h,event:Zi})},ui=()=>{pe||(e.addEventListener("pointermove",lr),e.addEventListener("pointerleave",Vr))},qi=()=>{pe||(e.removeEventListener("pointermove",lr),e.removeEventListener("pointerleave",Vr))},Jr=({nativeEvent:Zi,offsetX:Eo,offsetY:Go,data:oa})=>{if(Zi)return;const{data:Ca}=oa,Vs=wO(Ge,Ca,I);if(!Vs)return;const Sa=Vs.getBBox(),{x:us,y:wl,width:Cu,height:Gf}=Sa,Zc=e.getBBox();lr({target:Vs,offsetX:Eo!==void 0?Eo+Zc.x:us+Cu/2,offsetY:Go!==void 0?Go+Zc.y:wl+Gf/2})},Qr=({nativeEvent:Zi}={})=>{Zi||Yg({root:e,single:w,emitter:h,nativeEvent:!1})},Mo=()=>{qi(),V3({root:e,single:w})},Qi=()=>{ui()};return h.on("tooltip:show",Jr),h.on("tooltip:hide",Qr),h.on("tooltip:enable",Qi),h.on("tooltip:disable",Mo),ui(),()=>{qi(),h.off("tooltip:show",Jr),h.off("tooltip:hide",Qr),Ce?Yg({root:e,single:w,emitter:h,nativeEvent:!1}):V3({root:e,single:w})}}function _N(e){const{shared:t,crosshairs:n,crosshairsX:r,crosshairsY:i,series:s,name:l,item:u=()=>({}),facet:h=!1}=e,p=_1(e,["shared","crosshairs","crosshairsX","crosshairsY","series","name","item","facet"]);return(m,y,b)=>{const{container:w,view:R}=m,{scale:M,markState:I,coordinate:N,theme:U}=R,Z=vN(I,"seriesTooltip"),Y=vN(I,"crosshairs"),$=Hm(w),J=kv(s,Z),se=kv(n,Y);if(J&&yW(I)&&!h)return yN($,Object.assign(Object.assign({},p),{theme:U,elements:zg,scale:M,coordinate:N,crosshairs:se,crosshairsX:kv(kv(r,n),!1),crosshairsY:kv(i,se),item:u,emitter:b}));if(J&&h){const pe=y.filter(at=>at!==m&&at.options.parentKey===m.options.key),Ce=nI(m,y),Ue=pe[0].view.scale,Je=$.getBounds(),lt=Je.min[0],Ge=Je.min[1];return Object.assign(Ue,{facet:!0}),yN($.parentNode.parentNode,Object.assign(Object.assign({},p),{theme:U,elements:()=>Ce,scale:Ue,coordinate:N,crosshairs:kv(n,Y),crosshairsX:kv(kv(r,n),!1),crosshairsY:kv(i,se),item:u,startX:lt,startY:Ge,emitter:b}))}return _W($,Object.assign(Object.assign({},p),{datum:a1(R),elements:zg,scale:M,coordinate:N,groupKey:t?TO(R):void 0,item:u,emitter:b,view:R,theme:U,shared:t}))}}_N.props={reapplyWhenUpdate:!0};var CT=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const bN="legend-category",bW="legend-continuous",xW="items-item",EW="legend-category-item-marker",SW="legend-category-item-label";function xN(e){return e.getElementsByClassName(EW)[0]}function EN(e){return e.getElementsByClassName(SW)[0]}function SN(e){return e.getElementsByClassName(xW)}function H3(e){return e.getElementsByClassName(bN)}function TN(e){return e.getElementsByClassName(bW)}function TW(e,t){[...H3(e),...TN(e)].forEach(r=>{t(r,i=>i)})}function Z3(e){let t=e.parentNode;for(;t&&!t.__data__;)t=t.parentNode;return t.__data__}function Ute(e){let t=e;for(;t&&!t.attr("class").startsWith("legend");)t=t.children[0];return t.attributes}function wW(e,{legends:t,marker:n,label:r,datum:i,filter:s,emitter:l,channel:u,state:h={}}){const p=new Map,m=new Map,y=new Map,{unselected:b={markerStroke:"#aaa",markerFill:"#aaa",labelFill:"#aaa"}}=h,w={unselected:po(b,"marker")},R={unselected:po(b,"label")},{setState:M,removeState:I}=Bv(w,void 0),{setState:N,removeState:U}=Bv(R,void 0),Z=Array.from(t(e));let Y=Z.map(i);const $=()=>{for(const pe of Z){const Ce=i(pe),Ue=n(pe),Je=r(pe);Y.includes(Ce)?(I(Ue,"unselected"),U(Je,"unselected")):(M(Ue,"unselected"),N(Je,"unselected"))}};for(const pe of Z){const Ce=()=>{Ug(e,"pointer")},Ue=()=>{s7(e)},Je=lt=>CT(this,void 0,void 0,function*(){const Ge=i(pe),at=Y.indexOf(Ge);at===-1?Y.push(Ge):Y.splice(at,1),yield s(Y),$();const{nativeEvent:st=!0}=lt;st&&(Y.length===Z.length?l.emit("legend:reset",{nativeEvent:st}):l.emit("legend:filter",Object.assign(Object.assign({},lt),{nativeEvent:st,data:{channel:u,values:Y}})))});pe.addEventListener("click",Je),pe.addEventListener("pointerenter",Ce),pe.addEventListener("pointerout",Ue),p.set(pe,Je),m.set(pe,Ce),y.set(pe,Ue)}const J=pe=>CT(this,void 0,void 0,function*(){const{nativeEvent:Ce}=pe;if(Ce)return;const{data:Ue}=pe,{channel:Je,values:lt}=Ue;Je===u&&(Y=lt,yield s(Y),$())}),se=pe=>CT(this,void 0,void 0,function*(){const{nativeEvent:Ce}=pe;Ce||(Y=Z.map(i),yield s(Y),$())});return l.on("legend:filter",J),l.on("legend:reset",se),()=>{for(const pe of Z)pe.removeEventListener("click",p.get(pe)),pe.removeEventListener("pointerenter",m.get(pe)),pe.removeEventListener("pointerout",y.get(pe)),l.off("legend:filter",J),l.off("legend:reset",se)}}function AW(e,{legend:t,filter:n,emitter:r,channel:i}){const s=({detail:{value:l}})=>{n(l),r.emit({nativeEvent:!0,data:{channel:i,values:l}})};return t.addEventListener("valuechange",s),()=>{t.removeEventListener("valuechange",s)}}function wN(e,{legend:t,channel:n,value:r,ordinal:i,channels:s,allChannels:l,facet:u=!1}){return CT(this,void 0,void 0,function*(){const{view:h,update:p,setState:m}=e;m(t,y=>{const{marks:b}=y,w=b.map(R=>{if(R.type==="legends")return R;const{transform:M=[]}=R,I=M.findIndex(({type:Z})=>Z.startsWith("group")||Z.startsWith("bin")),N=[...M];N.splice(I+1,0,{type:"filter",[n]:{value:r,ordinal:i}});const U=Object.fromEntries(s.map(Z=>[Z,{domain:h.scale[Z].getOptions().domain}]));return ni({},R,Object.assign(Object.assign({transform:N,scale:U},!i&&{animate:!1}),{legend:u?!1:Object.fromEntries(l.map(Z=>[Z,{preserve:!0}]))}))});return Object.assign(Object.assign({},y),{marks:w})}),yield p()})}function CW(e,t){for(const n of e)wN(n,Object.assign(Object.assign({},t),{facet:!0}))}function OW(){return(e,t,n)=>{const{container:r}=e,i=t.filter(y=>y!==e),s=i.length>0,l=y=>Z3(y).scales.map(b=>b.name),u=[...H3(r),...TN(r)],h=u.flatMap(l),p=s?y1(CW,50,{trailing:!0}):y1(wN,50,{trailing:!0}),m=u.map(y=>{const{name:b,domain:w}=Z3(y).scales[0],R=l(y),M={legend:y,channel:b,channels:R,allChannels:h};return y.className===bN?wW(r,{legends:SN,marker:xN,label:EN,datum:I=>{const{__data__:N}=I,{index:U}=N;return w[U]},filter:I=>{const N=Object.assign(Object.assign({},M),{value:I,ordinal:!0});p(s?i:e,N)},state:y.attributes.state,channel:b,emitter:n}):AW(r,{legend:y,filter:I=>{const N=Object.assign(Object.assign({},M),{value:I,ordinal:!1});p(s?i:e,N)},emitter:n,channel:b})});return()=>{m.forEach(y=>y())}}}function RW(){return(e,t,n)=>{const{container:r,view:i,options:s}=e,l=H3(r),u=zg(r),h=w=>Z3(w).scales[0].name,p=w=>{const{scale:{[w]:R}}=i;return R},m=R_(s,["active","inactive"]),y=Rx(u,a1(i)),b=[];for(const w of l){const R=En=>{const{data:Vn}=w.attributes,{__data__:ar}=En,{index:lr}=ar;return Vn[lr].label},M=h(w),I=SN(w),N=p(M),U=vc(u,En=>N.invert(En.__data__[M])),{state:Z={}}=w.attributes,{inactive:Y={}}=Z,{setState:$,removeState:J}=Bv(m,y),se={inactive:po(Y,"marker")},pe={inactive:po(Y,"label")},{setState:Ce,removeState:Ue}=Bv(se),{setState:Je,removeState:lt}=Bv(pe),Ge=En=>{for(const Vn of I){const ar=xN(Vn),lr=EN(Vn);Vn===En||En===null?(Ue(ar,"inactive"),lt(lr,"inactive")):(Ce(ar,"inactive"),Je(lr,"inactive"))}},at=(En,Vn)=>{const ar=R(Vn),lr=new Set(U.get(ar));for(const ui of u)lr.has(ui)?$(ui,"active"):$(ui,"inactive");Ge(Vn);const{nativeEvent:Vr=!0}=En;Vr&&n.emit("legend:highlight",Object.assign(Object.assign({},En),{nativeEvent:Vr,data:{channel:M,value:ar}}))},st=new Map;for(const En of I){const Vn=ar=>{at(ar,En)};En.addEventListener("pointerover",Vn),st.set(En,Vn)}const ft=En=>{for(const ar of u)J(ar,"inactive","active");Ge(null);const{nativeEvent:Vn=!0}=En;Vn&&n.emit("legend:unhighlight",{nativeEvent:Vn})},Vt=En=>{const{nativeEvent:Vn,data:ar}=En;if(Vn)return;const{channel:lr,value:Vr}=ar;if(lr!==M)return;const ui=I.find(qi=>R(qi)===Vr);ui&&at({nativeEvent:!1},ui)},wt=En=>{const{nativeEvent:Vn}=En;Vn||ft({nativeEvent:!1})};w.addEventListener("pointerleave",ft),n.on("legend:highlight",Vt),n.on("legend:unhighlight",wt);const zt=()=>{w.removeEventListener(ft),n.off("legend:highlight",Vt),n.off("legend:unhighlight",wt);for(const[En,Vn]of st)En.removeEventListener(Vn)};b.push(zt)}return()=>b.forEach(w=>w())}}var A0=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function MW(e,t){const[n,r,i,s]=e,[l,u,h,p]=t;return!(l>i||h<n||u>s||p<r)}function PW(e,t,n,r,i){const[s,l,u,h]=i;return[Math.max(s,Math.min(e,n)),Math.max(l,Math.min(t,r)),Math.min(u,Math.max(e,n)),Math.min(h,Math.max(t,r))]}function IW(e){const{width:t,height:n}=e.getBBox();return[0,0,t,n]}function zv(e,t){for(const[n,r]of Object.entries(t))e.style(n,r)}const AN=df(e=>{const t=e.attributes,{x:n,y:r,width:i,height:s,class:l,renders:u={},handleSize:h=10,document:p}=t,m=A0(t,["x","y","width","height","class","renders","handleSize","document"]);if(!p||i===void 0||s===void 0||n===void 0||r===void 0)return;const y=h/2,b=(Vr,ui,qi)=>{Vr.handle||(Vr.handle=qi.createElement("rect"),Vr.append(Vr.handle));const{handle:Jr}=Vr;return Jr.attr(ui),Jr},w=po(Ib(m,"handleNW","handleNE"),"handleN"),{render:R=b}=w,M=A0(w,["render"]),I=po(m,"handleE"),{render:N=b}=I,U=A0(I,["render"]),Z=po(Ib(m,"handleSE","handleSW"),"handleS"),{render:Y=b}=Z,$=A0(Z,["render"]),J=po(m,"handleW"),{render:se=b}=J,pe=A0(J,["render"]),Ce=po(m,"handleNW"),{render:Ue=b}=Ce,Je=A0(Ce,["render"]),lt=po(m,"handleNE"),{render:Ge=b}=lt,at=A0(lt,["render"]),st=po(m,"handleSE"),{render:ft=b}=st,Vt=A0(st,["render"]),wt=po(m,"handleSW"),{render:zt=b}=wt,En=A0(wt,["render"]),Vn=(Vr,ui)=>{const{id:qi}=Vr,Jr=ui(Vr,Vr.attributes,p);Jr.id=qi,Jr.style.draggable=!0},ar=Vr=>()=>{const ui=df(qi=>Vn(qi,Vr));return new ui({})},lr=Pa(e).attr("className",l).style("transform",`translate(${n}, ${r})`).style("draggable",!0);lr.maybeAppend("selection","rect").style("draggable",!0).style("fill","transparent").call(zv,Object.assign(Object.assign({width:i,height:s},Ib(m,"handle")),{transform:void 0})),lr.maybeAppend("handle-n",ar(R)).style("x",y).style("y",-y).style("width",i-h).style("height",h).style("fill","transparent").call(zv,M),lr.maybeAppend("handle-e",ar(N)).style("x",i-y).style("y",y).style("width",h).style("height",s-h).style("fill","transparent").call(zv,U),lr.maybeAppend("handle-s",ar(Y)).style("x",y).style("y",s-y).style("width",i-h).style("height",h).style("fill","transparent").call(zv,$),lr.maybeAppend("handle-w",ar(se)).style("x",-y).style("y",y).style("width",h).style("height",s-h).style("fill","transparent").call(zv,pe),lr.maybeAppend("handle-nw",ar(Ue)).style("x",-y).style("y",-y).style("width",h).style("height",h).style("fill","transparent").call(zv,Je),lr.maybeAppend("handle-ne",ar(Ge)).style("x",i-y).style("y",-y).style("width",h).style("height",h).style("fill","transparent").call(zv,at),lr.maybeAppend("handle-se",ar(ft)).style("x",i-y).style("y",s-y).style("width",h).style("height",h).style("fill","transparent").call(zv,Vt),lr.maybeAppend("handle-sw",ar(zt)).style("x",-y).style("y",s-y).style("width",h).style("height",h).style("fill","transparent").call(zv,En)});function W3(e,t){var{brushed:n=()=>{},brushended:r=()=>{},brushcreated:i=()=>{},brushstarted:s=()=>{},brushupdated:l=()=>{},extent:u=IW(e),brushRegion:h=(Jr,Qr,Mo,Qi,Zi)=>[Jr,Qr,Mo,Qi],reverse:p=!1,fill:m="#777",fillOpacity:y="0.3",stroke:b="#fff",selectedHandles:w=["handle-n","handle-e","handle-s","handle-w","handle-nw","handle-ne","handle-se","handle-sw"]}=t,R=A0(t,["brushed","brushended","brushcreated","brushstarted","brushupdated","extent","brushRegion","reverse","fill","fillOpacity","stroke","selectedHandles"]);let M=null,I=null,N=null,U=null,Z=null,Y=!1;const[$,J,se,pe]=u;Ug(e,"crosshair"),e.style.draggable=!0;const Ce=(Jr,Qr,Mo)=>{if(s(Mo),U&&U.remove(),Z&&Z.remove(),M=[Jr,Qr],p)return Ue();Je()},Ue=()=>{Z=new Wi({style:Object.assign(Object.assign({},R),{fill:m,fillOpacity:y,stroke:b,pointerEvents:"none"})}),U=new AN({style:{x:0,y:0,width:0,height:0,draggable:!0,document:e.ownerDocument},className:"mask"}),e.appendChild(Z),e.appendChild(U)},Je=()=>{U=new AN({style:Object.assign(Object.assign({document:e.ownerDocument,x:0,y:0},R),{fill:m,fillOpacity:y,stroke:b,draggable:!0}),className:"mask"}),e.appendChild(U)},lt=(Jr=!0)=>{U&&U.remove(),Z&&Z.remove(),M=null,I=null,N=null,Y=!1,U=null,Z=null,r(Jr)},Ge=(Jr,Qr,Mo=!0)=>{const[Qi,Zi,Eo,Go]=PW(Jr[0],Jr[1],Qr[0],Qr[1],u),[oa,Ca,Vs,Sa]=h(Qi,Zi,Eo,Go,u);return p?st(oa,Ca,Vs,Sa):at(oa,Ca,Vs,Sa),n(oa,Ca,Vs,Sa,Mo),[oa,Ca,Vs,Sa]},at=(Jr,Qr,Mo,Qi)=>{U.style.x=Jr,U.style.y=Qr,U.style.width=Mo-Jr,U.style.height=Qi-Qr},st=(Jr,Qr,Mo,Qi)=>{Z.style.d=`
      M${$},${J}L${se},${J}L${se},${pe}L${$},${pe}Z
      M${Jr},${Qr}L${Jr},${Qi}L${Mo},${Qi}L${Mo},${Qr}Z
    `,U.style.x=Jr,U.style.y=Qr,U.style.width=Mo-Jr,U.style.height=Qi-Qr},ft=Jr=>{const Qr=(Ca,Vs,Sa,us,wl)=>Ca+Vs<us?us-Vs:Ca+Sa>wl?wl-Sa:Ca,Mo=Jr[0]-N[0],Qi=Jr[1]-N[1],Zi=Qr(Mo,M[0],I[0],$,se),Eo=Qr(Qi,M[1],I[1],J,pe),Go=[M[0]+Zi,M[1]+Eo],oa=[I[0]+Zi,I[1]+Eo];Ge(Go,oa)},Vt={"handle-n":{vector:[0,1,0,0],cursor:"ns-resize"},"handle-e":{vector:[0,0,1,0],cursor:"ew-resize"},"handle-s":{vector:[0,0,0,1],cursor:"ns-resize"},"handle-w":{vector:[1,0,0,0],cursor:"ew-resize"},"handle-nw":{vector:[1,1,0,0],cursor:"nwse-resize"},"handle-ne":{vector:[0,1,1,0],cursor:"nesw-resize"},"handle-se":{vector:[0,0,1,1],cursor:"nwse-resize"},"handle-sw":{vector:[1,0,0,1],cursor:"nesw-resize"}},wt=Jr=>En(Jr)||zt(Jr),zt=Jr=>{const{id:Qr}=Jr;return w.indexOf(Qr)===-1?!1:new Set(Object.keys(Vt)).has(Qr)},En=Jr=>Jr===U.getElementById("selection"),Vn=Jr=>{const{target:Qr}=Jr,[Mo,Qi]=SO(e,Jr);if(!U||!wt(Qr)){Ce(Mo,Qi,Jr),Y=!0;return}wt(Qr)&&(N=[Mo,Qi])},ar=Jr=>{const{target:Qr}=Jr,Mo=SO(e,Jr);if(!M)return;if(!N)return Ge(M,Mo);if(En(Qr))return ft(Mo);const[Qi,Zi]=[Mo[0]-N[0],Mo[1]-N[1]],{id:Eo}=Qr;if(Vt[Eo]){const[Go,oa,Ca,Vs]=Vt[Eo].vector;return Ge([M[0]+Qi*Go,M[1]+Zi*oa],[I[0]+Qi*Ca,I[1]+Zi*Vs])}},lr=Jr=>{if(N){N=null;const{x:Eo,y:Go,width:oa,height:Ca}=U.style;M=[Eo,Go],I=[Eo+oa,Go+Ca],l(Eo,Go,Eo+oa,Go+Ca,Jr);return}I=SO(e,Jr);const[Qr,Mo,Qi,Zi]=Ge(M,I);Y=!1,i(Qr,Mo,Qi,Zi,Jr)},Vr=Jr=>{const{target:Qr}=Jr;U&&!wt(Qr)&&lt()},ui=Jr=>{const{target:Qr}=Jr;!U||!wt(Qr)||Y?Ug(e,"crosshair"):En(Qr)?Ug(e,"move"):zt(Qr)&&Ug(e,Vt[Qr.id].cursor)},qi=()=>{Ug(e,"default")};return e.addEventListener("dragstart",Vn),e.addEventListener("drag",ar),e.addEventListener("dragend",lr),e.addEventListener("click",Vr),e.addEventListener("pointermove",ui),e.addEventListener("pointerleave",qi),{mask:U,move(Jr,Qr,Mo,Qi,Zi=!0){U||Ce(Jr,Qr,{}),M=[Jr,Qr],I=[Mo,Qi],Ge([Jr,Qr],[Mo,Qi],Zi)},remove(Jr=!0){U&&lt(Jr)},destroy(){U&&lt(!1),Ug(e,"default"),e.removeEventListener("dragstart",Vn),e.removeEventListener("drag",ar),e.removeEventListener("dragend",lr),e.removeEventListener("click",Vr),e.removeEventListener("pointermove",ui),e.removeEventListener("pointerleave",qi)}}}function G3(e,t,n){return t.filter(r=>{if(r===e)return!1;const{interaction:i={}}=r.options;return Object.values(i).find(s=>s.brushKey===n)})}function LW(e,t,n){return G3(e,t,n).map(r=>Hm(r.container))}function DW(e,t,n){return G3(e,t,n).map(r=>r.options)}function CN(e,t){var{elements:n,selectedHandles:r,siblings:i=ar=>[],datum:s,brushRegion:l,extent:u,reverse:h,scale:p,coordinate:m,series:y=!1,key:b=ar=>ar,bboxOf:w=ar=>{const{x:lr,y:Vr,width:ui,height:qi}=ar.style;return{x:lr,y:Vr,width:ui,height:qi}},state:R={},emitter:M}=t,I=A0(t,["elements","selectedHandles","siblings","datum","brushRegion","extent","reverse","scale","coordinate","series","key","bboxOf","state","emitter"]);const N=n(e),U=i(e),Z=U.flatMap(n),Y=Rx(N,s),$=po(I,"mask"),{setState:J,removeState:se}=Bv(R,Y),pe=new Map,{width:Ce,height:Ue,x:Je=0,y:lt=0}=w(e),Ge=u||[0,0,Ce,Ue],at=()=>{for(const ar of[...N,...Z])se(ar,"active","inactive")},st=(ar,lr,Vr,ui)=>{var qi;for(const Qr of U)(qi=Qr.brush)===null||qi===void 0||qi.remove();const Jr=new Set;for(const Qr of N){const{min:Mo,max:Qi}=Qr.getLocalBounds(),[Zi,Eo]=Mo,[Go,oa]=Qi;MW([Zi,Eo,Go,oa],[ar,lr,Vr,ui])?(J(Qr,"active"),Jr.add(b(Qr))):J(Qr,"inactive")}for(const Qr of Z)Jr.has(b(Qr))?J(Qr,"active"):J(Qr,"inactive")},ft=()=>{for(const ar of N)se(ar,"inactive");for(const ar of pe.values())ar.remove();pe.clear()},Vt=(ar,lr,Vr,ui)=>{const qi=Qr=>{const Mo=Qr.cloneNode();return Mo.__data__=Qr.__data__,Qr.parentNode.appendChild(Mo),pe.set(Qr,Mo),Mo},Jr=new yo({style:{x:ar+Je,y:lr+lt,width:Vr-ar,height:ui-lr}});e.appendChild(Jr);for(const Qr of N){const Mo=pe.get(Qr)||qi(Qr);Mo.style.clipPath=Jr,J(Qr,"inactive"),J(Mo,"active")}},wt=W3(e,Object.assign(Object.assign({},$),{extent:Ge,brushRegion:l,reverse:h,selectedHandles:r,brushended:ar=>{const lr=y?ft:at;ar&&M.emit("brush:remove",{nativeEvent:!0}),lr()},brushed:(ar,lr,Vr,ui,qi)=>{const Jr=IS(ar,lr,Vr,ui,p,m);qi&&M.emit("brush:highlight",{nativeEvent:!0,data:{selection:Jr}}),(y?Vt:st)(ar,lr,Vr,ui)},brushcreated:(ar,lr,Vr,ui,qi)=>{const Jr=IS(ar,lr,Vr,ui,p,m);M.emit("brush:end",Object.assign(Object.assign({},qi),{nativeEvent:!0,data:{selection:Jr}}))},brushupdated:(ar,lr,Vr,ui,qi)=>{const Jr=IS(ar,lr,Vr,ui,p,m);M.emit("brush:end",Object.assign(Object.assign({},qi),{nativeEvent:!0,data:{selection:Jr}}))},brushstarted:ar=>{M.emit("brush:start",ar)}})),zt=({nativeEvent:ar,data:lr})=>{if(ar)return;const{selection:Vr}=lr,[ui,qi,Jr,Qr]=Xk(Vr,p,m);wt.move(ui,qi,Jr,Qr,!1)};M.on("brush:highlight",zt);const En=({nativeEvent:ar}={})=>{ar||wt.remove(!1)};M.on("brush:remove",En);const Vn=wt.destroy.bind(wt);return wt.destroy=()=>{M.off("brush:highlight",zt),M.off("brush:remove",En),Vn()},wt}function X3(e){var{facet:t,brushKey:n}=e,r=A0(e,["facet","brushKey"]);return(i,s,l)=>{const{container:u,view:h,options:p}=i,m=Hm(u),y={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",reverse:!1},b=["active",["inactive",{opacity:.5}]],{scale:w,coordinate:R}=h;if(t){const I=m.getBounds(),N=I.min[0],U=I.min[1],Z=I.max[0],Y=I.max[1];return CN(m.parentNode.parentNode,Object.assign(Object.assign({elements:()=>nI(i,s),datum:a1(EO(i,s).map($=>$.view)),brushRegion:($,J,se,pe)=>[$,J,se,pe],extent:[N,U,Z,Y],state:R_(EO(i,s).map($=>$.options),b),emitter:l,scale:w,coordinate:R,selectedHandles:void 0},y),r))}const M=CN(m,Object.assign(Object.assign({elements:zg,key:I=>I.__data__.key,siblings:()=>LW(i,s,n),datum:a1([h,...G3(i,s,n).map(I=>I.view)]),brushRegion:(I,N,U,Z)=>[I,N,U,Z],extent:void 0,state:R_([p,...DW(i,s,n)],b),emitter:l,scale:w,coordinate:R,selectedHandles:void 0},y),r));return m.brush=M,()=>M.destroy()}}function Y3(e,t,n,r,i){const[,s,,l]=i;return[e,s,n,l]}function NW(e){return X3(Object.assign(Object.assign({},e),{brushRegion:Y3,selectedHandles:["handle-e","handle-w"]}))}function $3(e,t,n,r,i){const[s,,l]=i;return[s,t,l,r]}function BW(e){return X3(Object.assign(Object.assign({},e),{brushRegion:$3,selectedHandles:["handle-n","handle-s"]}))}var K3=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const FW="axis",kW="axis-line",zW="axis-main-group",ON="axis-hot-area";function UW(e){return e.getElementsByClassName(FW)}function RN(e){return e.getElementsByClassName(kW)[0]}function jW(e){return e.getElementsByClassName(zW)[0]}function MN(e){return jW(e).getLocalBounds()}function VW(e,t){var{cross:n,offsetX:r,offsetY:i}=t,s=K3(t,["cross","offsetX","offsetY"]);const l=MN(e),u=RN(e),[h]=u.getLocalBounds().min,[p,m]=l.min,[y,b]=l.max,w=(y-p)*2;return{brushRegion:$3,hotZone:new yo({className:ON,style:Object.assign({width:n?w/2:w,transform:`translate(${(n?p:h-w/2).toFixed(2)}, ${m})`,height:b-m},s)}),extent:n?(R,M,I,N)=>[-1/0,M,1/0,N]:(R,M,I,N)=>[Math.floor(p-r),M,Math.ceil(y-r),N]}}function HW(e,t){var{offsetY:n,offsetX:r,cross:i=!1}=t,s=K3(t,["offsetY","offsetX","cross"]);const l=MN(e),u=RN(e),[,h]=u.getLocalBounds().min,[p,m]=l.min,[y,b]=l.max,w=b-m;return{brushRegion:Y3,hotZone:new yo({className:ON,style:Object.assign({width:y-p,height:i?w:w*2,transform:`translate(${p}, ${i?m:h-w})`},s)}),extent:i?(R,M,I,N)=>[R,-1/0,I,1/0]:(R,M,I,N)=>[R,Math.floor(m-n),I,Math.ceil(b-n)]}}function ZW(e,t){var{axes:n,elements:r,points:i,horizontal:s,datum:l,offsetY:u,offsetX:h,reverse:p=!1,state:m={},emitter:y,coordinate:b}=t,w=K3(t,["axes","elements","points","horizontal","datum","offsetY","offsetX","reverse","state","emitter","coordinate"]);const R=r(e),M=n(e),I=Rx(R,l),{setState:N,removeState:U}=Bv(m,I),Z=new Map,Y=po(w,"mask"),$=zt=>Array.from(Z.values()).every(([En,Vn,ar,lr])=>zt.some(([Vr,ui])=>Vr>=En&&Vr<=ar&&ui>=Vn&&ui<=lr)),J=M.map(zt=>zt.attributes.scale),se=zt=>zt.length>2?[zt[0],zt[zt.length-1]]:zt,pe=new Map,Ce=()=>{pe.clear();for(let zt=0;zt<M.length;zt++){const En=J[zt],{domain:Vn}=En.getOptions();pe.set(zt,se(Vn))}};Ce();const Ue=(zt,En)=>{const Vn=[];for(const lr of R){const Vr=i(lr);$(Vr)?(N(lr,"active"),Vn.push(lr)):N(lr,"inactive")}if(pe.set(zt,lt(Vn,zt)),!En)return;const ar=()=>{if(!Ge)return Array.from(pe.values());const lr=[];for(const[Vr,ui]of pe){const qi=J[Vr],{name:Jr}=qi.getOptions();Jr==="x"?lr[0]=ui:lr[1]=ui}return lr};y.emit("brushAxis:highlight",{nativeEvent:!0,data:{selection:ar()}})},Je=zt=>{for(const En of R)U(En,"active","inactive");Ce(),zt&&y.emit("brushAxis:remove",{nativeEvent:!0})},lt=(zt,En)=>{const Vn=J[En],{name:ar}=Vn.getOptions(),lr=zt.map(Vr=>{const ui=Vr.__data__;return Vn.invert(ui[ar])});return se(kg(Vn,lr))},Ge=M.some(s)&&M.some(zt=>!s(zt)),at=[];for(let zt=0;zt<M.length;zt++){const En=M[zt],Vn=s(En)?HW:VW,{hotZone:ar,brushRegion:lr,extent:Vr}=Vn(En,{offsetY:u,offsetX:h,cross:Ge,zIndex:999,fill:"transparent"});En.parentNode.appendChild(ar);const ui=W3(ar,Object.assign(Object.assign({},Y),{reverse:p,brushRegion:lr,brushended(qi){Z.delete(En),Array.from(Z.entries()).length===0?Je(qi):Ue(zt,qi)},brushed(qi,Jr,Qr,Mo,Qi){Z.set(En,Vr(qi,Jr,Qr,Mo)),Ue(zt,Qi)}}));at.push(ui)}const st=(zt={})=>{const{nativeEvent:En}=zt;En||at.forEach(Vn=>Vn.remove(!1))},ft=(zt,En,Vn)=>{const[ar,lr]=zt,Vr=Jr=>Jr.getStep?Jr.getStep():0,ui=Vt(ar,En,Vn),qi=Vt(lr,En,Vn)+Vr(En);return s(Vn)?[ui,-1/0,qi,1/0]:[-1/0,ui,1/0,qi]},Vt=(zt,En,Vn)=>{const{height:ar,width:lr}=b.getOptions(),Vr=En.clone();return s(Vn)?Vr.update({range:[0,lr]}):Vr.update({range:[ar,0]}),Vr.map(zt)},wt=zt=>{const{nativeEvent:En}=zt;if(En)return;const{selection:Vn}=zt.data;for(let ar=0;ar<at.length;ar++){const lr=Vn[ar],Vr=at[ar],ui=M[ar];if(lr){const qi=J[ar];Vr.move(...ft(lr,qi,ui),!1)}else Vr.remove(!1)}};return y.on("brushAxis:remove",st),y.on("brushAxis:highlight",wt),()=>{at.forEach(zt=>zt.destroy()),y.off("brushAxis:remove",st),y.off("brushAxis:highlight",wt)}}function WW(e){return(t,n,r)=>{const{container:i,view:s,options:l}=t,u=Hm(i),{x:h,y:p}=u.getBBox(),{coordinate:m}=s;return ZW(i,Object.assign({elements:zg,axes:UW,offsetY:p,offsetX:h,points:y=>y.__data__.points,horizontal:y=>{const{startPos:[b,w],endPos:[R,M]}=y.attributes;return b!==R&&w===M},datum:a1(s),state:R_(l,["active",["inactive",{opacity:.5}]]),coordinate:m,emitter:r},e))}}var GW=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},PN=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function XW(e=300){let t=null;return n=>{const{timeStamp:r}=n;return t!==null&&r-t<e?(t=r,!0):(t=r,!1)}}function YW(e,t){var{filter:n,reset:r,brushRegion:i,extent:s,reverse:l,emitter:u,scale:h,coordinate:p,selection:m,series:y=!1}=t,b=PN(t,["filter","reset","brushRegion","extent","reverse","emitter","scale","coordinate","selection","series"]);const w=po(b,"mask"),{width:R,height:M}=e.getBBox(),I=s||[0,0,R,M],N=XW(),U=W3(e,Object.assign(Object.assign({},w),{extent:I,brushRegion:i,reverse:l,brushcreated:Z}));e.addEventListener("click",Y);function Z(J,se,pe,Ce,Ue){Ue.nativeEvent=!0,n(m(J,se,pe,Ce),Ue),U.remove()}function Y(J){N(J)&&(J.nativeEvent=!0,r(J))}const $=({nativeEvent:J,data:se})=>{if(J)return;const{selection:pe}=se;n(pe,{nativeEvent:!1})};return u.on("brush:filter",$),()=>{U.destroy(),u.off("brush:filter",$),e.removeEventListener("click",Y)}}function q3(e){var{hideX:t=!0,hideY:n=!0}=e,r=PN(e,["hideX","hideY"]);return(i,s,l)=>{const{container:u,view:h,options:p,update:m,setState:y}=i,b=Hm(u),w={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};let R=!1,M=!1,I=h;const{scale:N,coordinate:U}=h;return YW(b,Object.assign(Object.assign({brushRegion:(Z,Y,$,J)=>[Z,Y,$,J],selection:(Z,Y,$,J)=>{const{scale:se,coordinate:pe}=I;return IS(Z,Y,$,J,se,pe)},filter:(Z,Y)=>GW(this,void 0,void 0,function*(){if(M)return;M=!0;const[$,J]=Z;y("brushFilter",pe=>{const{marks:Ce}=pe,Ue=Ce.map(Je=>ni({axis:Object.assign(Object.assign({},t&&{x:{transform:[{type:"hide"}]}}),n&&{y:{transform:[{type:"hide"}]}})},Je,{scale:{x:{domain:$,nice:!1},y:{domain:J,nice:!1}}}));return Object.assign(Object.assign({},p),{marks:Ue,clip:!0})}),l.emit("brush:filter",Object.assign(Object.assign({},Y),{data:{selection:[$,J]}})),I=(yield m()).view,M=!1,R=!0}),reset:Z=>{if(M||!R)return;const{scale:Y}=h,{x:$,y:J}=Y,se=$.getOptions().domain,pe=J.getOptions().domain;l.emit("brush:filter",Object.assign(Object.assign({},Z),{data:{selection:[se,pe]}})),R=!1,I=h,y("brushFilter"),m()},extent:void 0,emitter:l,scale:N,coordinate:U},w),r))}}function $W(e){return q3(Object.assign(Object.assign({hideX:!0},e),{brushRegion:Y3}))}function KW(e){return q3(Object.assign(Object.assign({hideY:!0},e),{brushRegion:$3}))}var qW=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const QW="slider";function JW(e,t,n,r=!1,i="x",s="y"){const{marks:l}=e,u=l.map(h=>{var p,m;return ni({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},h,{scale:t,[n]:Object.assign(Object.assign({},((p=h[n])===null||p===void 0?void 0:p[i])&&{[i]:Object.assign({preserve:!0},r&&{ratio:null})}),((m=h[n])===null||m===void 0?void 0:m[s])&&{[s]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},e),{marks:u,clip:!0,animate:!1})}function eG(e,t,n){const[r,i]=e,s=n?h=>1-h:h=>h,l=C_(t,s(r),!0),u=C_(t,s(i),!1);return kg(t,[l,u])}function OT(e){return[e[0],e[e.length-1]]}function IN({initDomain:e={},className:t=QW,prefix:n="slider",setValue:r=(p,m)=>p.setValues(m),hasState:i=!1,wait:s=50,leading:l=!0,trailing:u=!1,getInitValues:h=p=>{var m;const y=(m=p==null?void 0:p.attributes)===null||m===void 0?void 0:m.values;if(y[0]!==0||y[1]!==1)return y}}){return(p,m,y)=>{const{container:b,view:w,update:R,setState:M}=p,I=b.getElementsByClassName(t);if(!I.length)return()=>{};let N=!1;const{scale:U,coordinate:Z,layout:Y}=w,{paddingLeft:$,paddingTop:J,paddingBottom:se,paddingRight:pe}=Y,{x:Ce,y:Ue}=U,Je=gc(Z),lt=ft=>{const Vt=ft==="vertical"?"y":"x",wt=ft==="vertical"?"x":"y";return Je?[wt,Vt]:[Vt,wt]},Ge=new Map,at=new Set,st={x:e.x||Ce.getOptions().domain,y:e.y||Ue.getOptions().domain};for(const ft of I){const{orientation:Vt}=ft.attributes,[wt,zt]=lt(Vt),En=`${n}${Sv(wt)}:filter`,Vn=wt==="x",{ratio:ar}=Ce.getOptions(),{ratio:lr}=Ue.getOptions(),Vr=Qr=>{if(Qr.data){const{selection:Go}=Qr.data,[oa=OT(st.x),Ca=OT(st.y)]=Go;return Vn?[kg(Ce,oa,ar),kg(Ue,Ca,lr)]:[kg(Ue,Ca,lr),kg(Ce,oa,ar)]}const{value:Mo}=Qr.detail,Qi=U[wt],Zi=eG(Mo,Qi,Je&&Vt==="horizontal"),Eo=st[zt];return[Zi,Eo]},ui=y1(Qr=>qW(this,void 0,void 0,function*(){const{initValue:Mo=!1}=Qr;if(N&&!Mo)return;N=!0;const{nativeEvent:Qi=!0}=Qr,[Zi,Eo]=Vr(Qr);if(st[wt]=Zi,st[zt]=Eo,Qi){const Go=Vn?Zi:Eo,oa=Vn?Eo:Zi;y.emit(En,Object.assign(Object.assign({},Qr),{nativeEvent:Qi,data:{selection:[OT(Go),OT(oa)]}}))}M(ft,Go=>Object.assign(Object.assign({},JW(Go,{[wt]:{domain:Zi,nice:!1}},n,i,wt,zt)),{paddingLeft:$,paddingTop:J,paddingBottom:se,paddingRight:pe})),yield R(),N=!1}),s,{leading:l,trailing:u}),qi=Qr=>{const{nativeEvent:Mo}=Qr;if(Mo)return;const{data:Qi}=Qr,{selection:Zi}=Qi,[Eo,Go]=Zi;ft.dispatchEvent(new tl("valuechange",{data:Qi,nativeEvent:!1}));const oa=Vn?LS(Eo,Ce):LS(Go,Ue);r(ft,oa)};y.on(En,qi),ft.addEventListener("valuechange",ui),Ge.set(ft,ui),at.add([En,qi]);const Jr=h(ft);Jr&&ft.dispatchEvent(new tl("valuechange",{detail:{value:Jr},nativeEvent:!1,initValue:!0}))}return()=>{for(const[ft,Vt]of Ge)ft.removeEventListener("valuechange",Vt);for(const[ft,Vt]of at)y.off(ft,Vt)}}}const LN="g2-scrollbar";function tG(e={}){return(t,n,r)=>{const{view:i,container:s}=t;if(!s.getElementsByClassName(LN).length)return()=>{};const{scale:u}=i,{x:h,y:p}=u,m={x:[...h.getOptions().domain],y:[...p.getOptions().domain]};return h.update({domain:h.getOptions().expectedDomain}),p.update({domain:p.getOptions().expectedDomain}),IN(Object.assign(Object.assign({},e),{initDomain:m,className:LN,prefix:"scrollbar",hasState:!0,setValue:(b,w)=>b.setValue(w[0]),getInitValues:b=>{const w=b.slider.attributes.values;if(w[0]!==0)return w}}))(t,n,r)}}var nG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function rG(e,t,n){return`<${e} style="${Object.entries(n).map(([r,i])=>`${Dh(r)}:${i}`).join(";")}">${t}</${e}>`}const iG={backgroundColor:"rgba(0,0,0,0.75)",color:"#fff",width:"max-content",padding:"1px 4px",fontSize:"12px",borderRadius:"2.5px",boxShadow:"0 3px 6px -4px rgba(0,0,0,0.12), 0 6px 16px 0 rgba(0,0,0,0.08), 0 9px 28px 8px rgba(0,0,0,0.05)"};function DN(e){return e.nodeName!=="text"?!1:!!e.isOverflowing()}function NN(e){var{offsetX:t=8,offsetY:n=8}=e,r=nG(e,["offsetX","offsetY"]);return i=>{const{container:s}=i,[l,u]=s.getBounds().min,h=po(r,"tip"),p=new Set,m=b=>{const{target:w}=b;if(!DN(w)){b.stopPropagation();return}const{offsetX:R,offsetY:M}=b,I=R+t-l,N=M+n-u;if(w.tip){w.tip.style.x=I,w.tip.style.y=N;return}const{text:U}=w.style,Z=new Ao({className:"poptip",style:{innerHTML:rG("div",U,Object.assign(Object.assign({},iG),h)),x:I,y:N}});s.appendChild(Z),w.tip=Z,p.add(Z)},y=b=>{const{target:w}=b;if(!DN(w)){b.stopPropagation();return}w.tip&&(w.tip.remove(),w.tip=null,p.delete(w.tip))};return s.addEventListener("pointerover",m),s.addEventListener("pointerout",y),()=>{s.removeEventListener("pointerover",m),s.removeEventListener("pointerout",y),p.forEach(b=>b.remove())}}}NN.props={reapplyWhenUpdate:!0};function oG(e,t){var n=qO(t),r=n.length;if((0,sr.Z)(e))return!r;for(var i=0;i<r;i+=1){var s=n[i];if(t[s]!==e[s]||!(s in e))return!1}return!0}var aG=oG;function sG(e,t){if(!Is(e))return null;var n;if(Ih(t)&&(n=t),y0(t)&&(n=function(i){return aG(i,t)}),n){for(var r=0;r<e.length;r+=1)if(n(e[r]))return e[r]}return null}var Z_=sG;function RT(e){return e==null?null:BN(e)}function BN(e){if(typeof e!="function")throw new Error;return e}var lG={depth:-1},FN={},Q3={};function cG(e){return e.id}function uG(e){return e.parentId}function J3(){var e=cG,t=uG,n;function r(i){var s=Array.from(i),l=e,u=t,h,p,m,y,b,w,R,M,I=new Map;if(n!=null){var N=s.map(function(pe,Ce){return fG(n(pe,Ce,i))}),U=N.map(kN),Z=new Set(N).add(""),Y=XO(U),$;try{for(Y.s();!($=Y.n()).done;){var J=$.value;Z.has(J)||(Z.add(J),N.push(J),U.push(kN(J)),s.push(Q3))}}catch(pe){Y.e(pe)}finally{Y.f()}l=function(Ce,Ue){return N[Ue]},u=function(Ce,Ue){return U[Ue]}}for(m=0,h=s.length;m<h;++m)p=s[m],w=s[m]=new k_(p),(R=l(p,m,i))!=null&&(R+="")&&(M=w.id=R,I.set(M,I.has(M)?FN:w)),(R=u(p,m,i))!=null&&(R+="")&&(w.parent=R);for(m=0;m<h;++m)if(w=s[m],R=w.parent){if(b=I.get(R),!b)throw new Error("missing: "+R);if(b===FN)throw new Error("ambiguous: "+R);b.children?b.children.push(w):b.children=[w],w.parent=b}else{if(y)throw new Error("multiple roots");y=w}if(!y)throw new Error("no root");if(n!=null){for(;y.data===Q3&&y.children.length===1;)y=y.children[0],--h;for(var se=s.length-1;se>=0&&(w=s[se],w.data===Q3);--se)w.data=null}if(y.parent=lG,y.eachBefore(function(pe){pe.depth=pe.parent.depth+1,--h}).eachBefore(K5),y.parent=null,h>0)throw new Error("cycle");return y}return r.id=function(i){return arguments.length?(e=RT(i),r):e},r.parentId=function(i){return arguments.length?(t=RT(i),r):t},r.path=function(i){return arguments.length?(n=RT(i),r):n},r}function fG(e){e="".concat(e);var t=e.length;return eR(e,t-1)&&!eR(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:"/".concat(e)}function kN(e){var t=e.length;if(t<2)return"";for(;--t>1&&!eR(e,t););return e.slice(0,t)}function eR(e,t){if(e[t]==="/"){for(var n=0;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function hG(e,t,n,r,i){var s=e.children,l,u=s.length,h,p=new Array(u+1);for(p[0]=h=l=0;l<u;++l)p[l+1]=h+=s[l].value;m(0,u,e.value,t,n,r,i);function m(y,b,w,R,M,I,N){if(y>=b-1){var U=s[y];U.x0=R,U.y0=M,U.x1=I,U.y1=N;return}for(var Z=p[y],Y=w/2+Z,$=y+1,J=b-1;$<J;){var se=$+J>>>1;p[se]<Y?$=se+1:J=se}Y-p[$-1]<p[$]-Y&&y+1<$&&--$;var pe=p[$]-Z,Ce=w-pe;if(I-R>N-M){var Ue=w?(R*Ce+I*pe)/w:I;m(y,$,pe,R,M,Ue,N),m($,b,Ce,Ue,M,I,N)}else{var Je=w?(M*Ce+N*pe)/w:N;m(y,$,pe,R,M,I,Je),m($,b,Ce,R,Je,I,N)}}}function MT(e,t,n,r,i){for(var s=e.children,l,u=-1,h=s.length,p=e.value&&(i-n)/e.value;++u<h;)l=s[u],l.x0=t,l.x1=r,l.y0=n,l.y1=n+=l.value*p}function dG(e,t,n,r,i){(e.depth&1?MT:Nx)(e,t,n,r,i)}var zN=(1+Math.sqrt(5))/2;function UN(e,t,n,r,i,s){for(var l=[],u=t.children,h,p,m=0,y=0,b=u.length,w,R,M=t.value,I,N,U,Z,Y,$,J;m<b;){w=i-n,R=s-r;do I=u[y++].value;while(!I&&y<b);for(N=U=I,$=Math.max(R/w,w/R)/(M*e),J=I*I*$,Y=Math.max(U/J,J/N);y<b;++y){if(I+=p=u[y].value,p<N&&(N=p),p>U&&(U=p),J=I*I*$,Z=Math.max(U/J,J/N),Z>Y){I-=p;break}Y=Z}l.push(h={value:I,dice:w<R,children:u.slice(m,y)}),h.dice?Nx(h,n,r,i,M?r+=R*I/M:s):MT(h,n,r,M?n+=w*I/M:i,s),M-=I,m=y}return l}var jN=function e(t){function n(r,i,s,l,u){UN(t,r,i,s,l,u)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(zN),pG=function e(t){function n(r,i,s,l,u){if((h=r._squarify)&&h.ratio===t)for(var h,p,m,y,b=-1,w,R=h.length,M=r.value;++b<R;){for(p=h[b],m=p.children,y=p.value=0,w=m.length;y<w;++y)p.value+=m[y].value;p.dice?Nx(p,i,s,l,M?s+=(u-s)*p.value/M:u):MT(p,i,s,M?i+=(l-i)*p.value/M:l,u),M-=p.value}else r._squarify=h=UN(t,r,i,s,l,u),h.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(zN);function b1(){return 0}function W_(e){return function(){return e}}function mG(){var e=jN,t=!1,n=1,r=1,i=[0],s=b1,l=b1,u=b1,h=b1,p=b1;function m(b){return b.x0=b.y0=0,b.x1=n,b.y1=r,b.eachBefore(y),i=[0],t&&b.eachBefore(X5),b}function y(b){var w=i[b.depth],R=b.x0+w,M=b.y0+w,I=b.x1-w,N=b.y1-w;I<R&&(R=I=(R+I)/2),N<M&&(M=N=(M+N)/2),b.x0=R,b.y0=M,b.x1=I,b.y1=N,b.children&&(w=i[b.depth+1]=s(b)/2,R+=p(b)-w,M+=l(b)-w,I-=u(b)-w,N-=h(b)-w,I<R&&(R=I=(R+I)/2),N<M&&(M=N=(M+N)/2),e(b,R,M,I,N))}return m.round=function(b){return arguments.length?(t=!!b,m):t},m.size=function(b){return arguments.length?(n=+b[0],r=+b[1],m):[n,r]},m.tile=function(b){return arguments.length?(e=BN(b),m):e},m.padding=function(b){return arguments.length?m.paddingInner(b).paddingOuter(b):m.paddingInner()},m.paddingInner=function(b){return arguments.length?(s=typeof b=="function"?b:W_(+b),m):s},m.paddingOuter=function(b){return arguments.length?m.paddingTop(b).paddingRight(b).paddingBottom(b).paddingLeft(b):m.paddingTop()},m.paddingTop=function(b){return arguments.length?(l=typeof b=="function"?b:W_(+b),m):l},m.paddingRight=function(b){return arguments.length?(u=typeof b=="function"?b:W_(+b),m):u},m.paddingBottom=function(b){return arguments.length?(h=typeof b=="function"?b:W_(+b),m):h},m.paddingLeft=function(b){return arguments.length?(p=typeof b=="function"?b:W_(+b),m):p},m}function vG(e,t){return Array.isArray(e)?typeof t=="function"?J3().path(t)(e):J3()(e):F_(e)}function VN(e,t=[e.data.name]){e.id=e.id||e.data.name,e.path=t,e.children&&e.children.forEach(n=>{n.id=`${e.id}/${n.data.name}`,n.path=[...t,n.data.name],VN(n,n.path)})}function HN(e){const t=Bi(e,["data","name"]);t.replaceAll&&(e.path=t.replaceAll(".","/").split("/")),e.children&&e.children.forEach(n=>{HN(n)})}function gG(e,t){const n={treemapBinary:hG,treemapDice:Nx,treemapSlice:MT,treemapSliceDice:dG,treemapSquarify:jN,treemapResquarify:pG},r=e==="treemapSquarify"?n[e].ratio(t):n[e];if(!r)throw new TypeError("Invalid tile method!");return r}function ZN(e,t,n){const{value:r}=n,i=gG(t.tile,t.ratio),s=vG(e,t.path);Is(e)?HN(s):VN(s),r?s.sum(h=>t.ignoreParentValue&&h.children?0:$m(r)(h)).sort(t.sort):s.count(),mG().tile(i).size(t.size).round(t.round).paddingInner(t.paddingInner).paddingOuter(t.paddingOuter).paddingTop(t.paddingTop).paddingRight(t.paddingRight).paddingBottom(t.paddingBottom).paddingLeft(t.paddingLeft)(s);const l=s.descendants().map(h=>Object.assign(h,{id:h.id.replace(/^\//,""),x:[h.x0,h.x1],y:[h.y0,h.y1]}));return[l.filter(typeof t.layer=="function"?t.layer:h=>h.height===t.layer),l]}var yG=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},_G=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function bG(e){return Pa(e).select(`.${Ie}`).node()}const xG={breadCrumbFill:"rgba(0, 0, 0, 0.85)",breadCrumbFontSize:12,breadCrumbY:12,activeFill:"rgba(0, 0, 0, 0.5)"};function EG(e={}){const{originData:t=[],layout:n}=e,r=_G(e,["originData","layout"]),i=ni({},xG,r),s=po(i,"breadCrumb"),l=po(i,"active");return u=>{const{update:h,setState:p,container:m,options:y}=u,b=bG(m),w=y.marks[0],{state:R}=w,M=new Ci;b.appendChild(M);const I=(Y,$)=>yG(this,void 0,void 0,function*(){if(M.removeChildren(),$){let J="",se=s.y,pe=0;const Ce=[],Ue=b.getBBox().width,Je=Y.map((lt,Ge)=>{J=`${J}${lt}/`,Ce.push(lt);const at=new ma({name:J.replace(/\/$/,""),style:Object.assign(Object.assign({text:lt,x:pe,path:[...Ce],depth:Ge},s),{y:se})});M.appendChild(at),pe+=at.getBBox().width;const st=new ma({style:Object.assign(Object.assign({x:pe,text:" / "},s),{y:se})});return M.appendChild(st),pe+=st.getBBox().width,pe>Ue&&(se=M.getBBox().height+s.y,pe=0,at.attr({x:pe,y:se}),pe+=at.getBBox().width,st.attr({x:pe,y:se}),pe+=st.getBBox().width),Ge===Lg(Y)-1&&st.remove(),at});Je.forEach((lt,Ge)=>{if(Ge===Lg(Je)-1)return;const at=Object.assign({},lt.attributes);lt.attr("cursor","pointer"),lt.addEventListener("mouseenter",()=>{lt.attr(l)}),lt.addEventListener("mouseleave",()=>{lt.attr(at)}),lt.addEventListener("click",()=>{I(Bi(lt,["style","path"]),Bi(lt,["style","depth"]))})})}TW(m,p),p("treemapDrillDown",J=>{const{marks:se}=J,pe=Y.join("/"),Ce=se.map(Ue=>{if(Ue.type!=="rect")return Ue;let Je=t;if($){const Ge=t.filter(wt=>{const zt=Bi(wt,["id"]);return zt&&(zt.match(`${pe}/`)||pe.match(zt))}).map(wt=>({value:wt.height===0?Bi(wt,["value"]):void 0,name:Bi(wt,["id"])})),{paddingLeft:at,paddingBottom:st,paddingRight:ft}=n,Vt=Object.assign(Object.assign({},n),{paddingTop:(n.paddingTop||M.getBBox().height+10)/($+1),paddingLeft:at/($+1),paddingBottom:st/($+1),paddingRight:ft/($+1),path:wt=>wt.name,layer:wt=>wt.depth===$+1});Je=ZN(Ge,Vt,{value:"value"})[0]}else Je=t.filter(Ge=>Ge.depth===1);const lt=[];return Je.forEach(({path:Ge})=>{lt.push(Xx(Ge))}),ni({},Ue,{data:Je,scale:{color:{domain:lt}}})});return Object.assign(Object.assign({},J),{marks:Ce})}),yield h(void 0,["legendFilter"])}),N=Y=>{const $=Y.target;if(Bi($,["markType"])!=="rect")return;const J=Bi($,["__data__","key"]),se=Z_(t,pe=>pe.id===J);Bi(se,"height")&&I(Bi(se,"path"),Bi(se,"depth"))};b.addEventListener("click",N);const U=qO(Object.assign(Object.assign({},R.active),R.inactive)),Z=()=>{lI(b).forEach($=>{const J=Bi($,["style","cursor"]),se=Z_(t,pe=>pe.id===Bi($,["__data__","key"]));if(J!=="pointer"&&(se!=null&&se.height)){$.style.cursor="pointer";const pe=GO($.attributes,U);$.addEventListener("mouseenter",()=>{$.attr(R.active)}),$.addEventListener("mouseleave",()=>{$.attr(ni(pe,R.inactive))})}})};return Z(),b.addEventListener("mousemove",Z),()=>{M.remove(),b.removeEventListener("click",N),b.removeEventListener("mousemove",Z)}}}var tR=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},SG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const TG={pointR:6,pointStrokeWidth:1,pointStroke:"#888",pointActiveStroke:"#f5f5f5",pathStroke:"#888",pathLineDash:[3,4],labelFontSize:12,labelFill:"#888",labelStroke:"#fff",labelLineWidth:1,labelY:-6,labelX:2},nR="movePoint",WN=e=>{const t=e.target,{markType:n}=t;n==="line"&&(t.attr("_lineWidth",t.attr("lineWidth")||1),t.attr("lineWidth",t.attr("_lineWidth")+3)),n==="interval"&&(t.attr("_opacity",t.attr("opacity")||1),t.attr("opacity",.7*t.attr("_opacity")))},GN=e=>{const t=e.target,{markType:n}=t;n==="line"&&t.attr("lineWidth",t.attr("_lineWidth")),n==="interval"&&t.attr("opacity",t.attr("_opacity"))},wG=(e,t,n)=>t.map(r=>["x","color"].reduce((s,l)=>{const u=n[l];return u&&r[u]!==e[u]?!1:s},!0)?Object.assign(Object.assign({},r),e):r),AG=e=>{const t=Bi(e,["__data__","y"]),r=Bi(e,["__data__","y1"])-t,{__data__:{data:i,encode:s,transform:l},childNodes:u}=e.parentNode,h=Z_(l,({type:y})=>y==="normalizeY"),p=Bi(s,["y","field"]),m=i[u.indexOf(e)][p];return(y,b=!1)=>h||b?y/(1-y)/(r/(1-r))*m:y},CG=(e,t)=>{const n=Bi(e,["__data__","seriesItems",t,"0","value"]),r=Bi(e,["__data__","seriesIndex",t]),{__data__:{data:i,encode:s,transform:l}}=e.parentNode,u=Z_(l,({type:m})=>m==="normalizeY"),h=Bi(s,["y","field"]),p=i[r][h];return m=>u?n===1?m:m/(1-m)/(n/(1-n))*p:m},XN=(e,t,n)=>{e.forEach((r,i)=>{r.attr("stroke",t[1]===i?n.activeStroke:n.stroke)})},YN=(e,t,n,r)=>{const i=new Wi({style:n}),s=new ma({style:r});return t.appendChild(s),e.appendChild(i),[i,s]},$N=(e,t)=>{if(!Bi(e,["options","range","indexOf"]))return;const r=e.options.range.indexOf(t);return e.sortedDomain[r]},rR=(e,t,n)=>{const r=US(e,t),s=US(e,n)/r,l=e[0]+(t[0]-e[0])*s,u=e[1]+(t[1]-e[1])*s;return[l,u]};function OG(e={}){const{selection:t=[],precision:n=2}=e,r=SG(e,["selection","precision"]),i=Object.assign(Object.assign({},TG),r||{}),s=po(i,"path"),l=po(i,"label"),u=po(i,"point");return(h,p,m)=>{const{update:y,setState:b,container:w,view:R,options:{marks:M,coordinate:I}}=h,N=Hm(w);let U=lI(N),Z,Y=t;const{transform:$=[],type:J}=I,se=!!Z_($,({type:wt})=>wt==="transpose"),pe=J==="polar",Ce=J==="theta",Ue=!!Z_(U,({markType:wt})=>wt==="area");Ue&&(U=U.filter(({markType:wt})=>wt==="area"));const Je=new Ci({style:{zIndex:2}});N.appendChild(Je);const lt=()=>{m.emit("element-point:select",{nativeEvent:!0,data:{selection:Y}})},Ge=(wt,zt)=>{m.emit("element-point:moved",{nativeEvent:!0,data:{changeData:wt,data:zt}})},at=wt=>{const zt=wt.target;Y=[zt.parentNode.childNodes.indexOf(zt)],lt(),ft(zt)},st=wt=>{const{data:{selection:zt},nativeEvent:En}=wt;if(En)return;Y=zt;const Vn=Bi(U,[Y==null?void 0:Y[0]]);Vn&&ft(Vn)},ft=wt=>{const{attributes:zt,markType:En,__data__:Vn}=wt,{stroke:ar}=zt,{points:lr,seriesTitle:Vr,color:ui,title:qi,seriesX:Jr,y1:Qr}=Vn;if(se&&En!=="interval")return;const{scale:Mo,coordinate:Qi}=(Z==null?void 0:Z.view)||R,{color:Zi,y:Eo,x:Go}=Mo,oa=Qi.getCenter();Je.removeChildren();let Ca;const Vs=(Sa,us,wl,Cu)=>tR(this,void 0,void 0,function*(){return b("elementPointMove",Gf=>{var Zc;const ph=(((Zc=Z==null?void 0:Z.options)===null||Zc===void 0?void 0:Zc.marks)||M).map(Ou=>{if(!Cu.includes(Ou.type))return Ou;const{data:kd,encode:bc}=Ou,Bh=Object.keys(bc).reduce((ta,qa)=>{const Ps=bc[qa];return qa==="x"&&(ta[Ps]=Sa),qa==="y"&&(ta[Ps]=us),qa==="color"&&(ta[Ps]=wl),ta},{}),Rf=wG(Bh,kd,bc);return Ge(Bh,Rf),ni({},Ou,{data:Rf,animate:!1})});return Object.assign(Object.assign({},Gf),{marks:ph})}),yield y("elementPointMove")});if(["line","area"].includes(En))lr.forEach((Sa,us)=>{const wl=Go.invert(Jr[us]);if(!wl)return;const Cu=new Ir({name:nR,style:Object.assign({cx:Sa[0],cy:Sa[1],fill:ar},u)}),Gf=CG(wt,us);Cu.addEventListener("mousedown",Zc=>{const ph=Qi.output([Jr[us],0]),Ou=Vr==null?void 0:Vr.length;w.attr("cursor","move"),Y[1]!==us&&(Y[1]=us,lt()),XN(Je.childNodes,Y,u);const[kd,bc]=YN(Je,Cu,s,l),Pc=Rf=>{const ta=Sa[1]+Rf.clientY-Ca[1];if(Ue)if(pe){const qa=Sa[0]+Rf.clientX-Ca[0],[Ps,Ns]=rR(oa,ph,[qa,ta]),[,xc]=Qi.output([1,Eo.output(0)]),[,nf]=Qi.invert([Ps,xc-(lr[us+Ou][1]-Ns)]),rf=(us+1)%Ou,Fh=(us-1+Ou)%Ou,M0=Mx([lr[Fh],[Ps,Ns],Vr[rf]&&lr[rf]]);bc.attr("text",Gf(Eo.invert(nf)).toFixed(n)),kd.attr("d",M0),Cu.attr("cx",Ps),Cu.attr("cy",Ns)}else{const[,qa]=Qi.output([1,Eo.output(0)]),[,Ps]=Qi.invert([Sa[0],qa-(lr[us+Ou][1]-ta)]),Ns=Mx([lr[us-1],[Sa[0],ta],Vr[us+1]&&lr[us+1]]);bc.attr("text",Gf(Eo.invert(Ps)).toFixed(n)),kd.attr("d",Ns),Cu.attr("cy",ta)}else{const[,qa]=Qi.invert([Sa[0],ta]),Ps=Mx([lr[us-1],[Sa[0],ta],lr[us+1]]);bc.attr("text",Eo.invert(qa).toFixed(n)),kd.attr("d",Ps),Cu.attr("cy",ta)}};Ca=[Zc.clientX,Zc.clientY],window.addEventListener("mousemove",Pc);const Bh=()=>tR(this,void 0,void 0,function*(){if(w.attr("cursor","default"),window.removeEventListener("mousemove",Pc),w.removeEventListener("mouseup",Bh),ti(bc.attr("text")))return;const Rf=Number(bc.attr("text")),ta=$N(Zi,ui);Z=yield Vs(wl,Rf,ta,["line","area"]),bc.remove(),kd.remove(),ft(wt)});w.addEventListener("mouseup",Bh)}),Je.appendChild(Cu)}),XN(Je.childNodes,Y,u);else if(En==="interval"){let Sa=[(lr[0][0]+lr[1][0])/2,lr[0][1]];se?Sa=[lr[0][0],(lr[0][1]+lr[1][1])/2]:Ce&&(Sa=lr[0]);const us=AG(wt),wl=new Ir({name:nR,style:Object.assign(Object.assign({cx:Sa[0],cy:Sa[1],fill:ar},u),{stroke:u.activeStroke})});wl.addEventListener("mousedown",Cu=>{w.attr("cursor","move");const Gf=$N(Zi,ui),[Zc,ph]=YN(Je,wl,s,l),Ou=bc=>{if(se){const Pc=Sa[0]+bc.clientX-Ca[0],[Bh]=Qi.output([Eo.output(0),Eo.output(0)]),[,Rf]=Qi.invert([Bh+(Pc-lr[2][0]),Sa[1]]),ta=Mx([[Pc,lr[0][1]],[Pc,lr[1][1]],lr[2],lr[3]],!0);ph.attr("text",us(Eo.invert(Rf)).toFixed(n)),Zc.attr("d",ta),wl.attr("cx",Pc)}else if(Ce){const Pc=Sa[1]+bc.clientY-Ca[1],Bh=Sa[0]+bc.clientX-Ca[0],[Rf,ta]=rR(oa,[Bh,Pc],Sa),[qa,Ps]=rR(oa,[Bh,Pc],lr[1]),Ns=Qi.invert([Rf,ta])[1],xc=Qr-Ns;if(xc<0)return;const nf=l7(oa,[[Rf,ta],[qa,Ps],lr[2],lr[3]],xc>.5?1:0);ph.attr("text",us(xc,!0).toFixed(n)),Zc.attr("d",nf),wl.attr("cx",Rf),wl.attr("cy",ta)}else{const Pc=Sa[1]+bc.clientY-Ca[1],[,Bh]=Qi.output([1,Eo.output(0)]),[,Rf]=Qi.invert([Sa[0],Bh-(lr[2][1]-Pc)]),ta=Mx([[lr[0][0],Pc],[lr[1][0],Pc],lr[2],lr[3]],!0);ph.attr("text",us(Eo.invert(Rf)).toFixed(n)),Zc.attr("d",ta),wl.attr("cy",Pc)}};Ca=[Cu.clientX,Cu.clientY],window.addEventListener("mousemove",Ou);const kd=()=>tR(this,void 0,void 0,function*(){if(w.attr("cursor","default"),w.removeEventListener("mouseup",kd),window.removeEventListener("mousemove",Ou),ti(ph.attr("text")))return;const bc=Number(ph.attr("text"));Z=yield Vs(qi,bc,Gf,[En]),ph.remove(),Zc.remove(),ft(wt)});w.addEventListener("mouseup",kd)}),Je.appendChild(wl)}};U.forEach((wt,zt)=>{Y[0]===zt&&ft(wt),wt.addEventListener("click",at),wt.addEventListener("mouseenter",WN),wt.addEventListener("mouseleave",GN)});const Vt=wt=>{const zt=wt==null?void 0:wt.target;(!zt||zt.name!==nR&&!U.includes(zt))&&(Y=[],lt(),Je.removeChildren())};return m.on("element-point:select",st),m.on("element-point:unselect",Vt),w.addEventListener("mousedown",Vt),()=>{Je.remove(),m.off("element-point:select",st),m.off("element-point:unselect",Vt),w.removeEventListener("mousedown",Vt),U.forEach(wt=>{wt.removeEventListener("click",at),wt.removeEventListener("mouseenter",WN),wt.removeEventListener("mouseleave",GN)})}}}var RG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const KN=()=>e=>{const{children:t}=e;if(!Array.isArray(t))return[];const{x:n=0,y:r=0,width:i,height:s,data:l}=e;return t.map(u=>{var{data:h,x:p,y:m,width:y,height:b}=u,w=RG(u,["data","x","y","width","height"]);return Object.assign(Object.assign({},w),{data:F(h,l),x:p!=null?p:n,y:m!=null?m:r,width:y!=null?y:i,height:b!=null?b:s})})};KN.props={};var MG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const qN=()=>e=>{const{children:t}=e;if(!Array.isArray(t))return[];const{direction:n="row",ratio:r=t.map(()=>1),padding:i=0,data:s}=e,[l,u,h,p]=n==="col"?["y","height","width","x"]:["x","width","height","y"],m=r.reduce((M,I)=>M+I),y=e[u]-i*(t.length-1),b=r.map(M=>y*(M/m)),w=[];let R=e[l]||0;for(let M=0;M<b.length;M+=1){const I=t[M],{data:N}=I,U=MG(I,["data"]),Z=F(N,s);w.push(Object.assign({[l]:R,[u]:b[M],[p]:e[p]||0,[h]:e[h],data:Z},U)),R+=b[M]+i}return w};qN.props={};class e2{constructor(t){this.$value=t}static of(t){return new e2(t)}call(t,...n){return this.$value=t(this.$value,...n),this}value(){return this.$value}}var PG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const IG=T(e=>{const{encode:t,data:n,scale:r,shareSize:i=!1}=e,{x:s,y:l}=t,u=(h,p)=>{var m;if(h===void 0||!i)return{};const y=vc(n,R=>R[h]),b=((m=r==null?void 0:r[p])===null||m===void 0?void 0:m.domain)||Array.from(y.keys()),w=b.map(R=>y.has(R)?y.get(R).length:1);return{domain:b,flex:w}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:s===void 0?null:{position:"top"}},s===void 0&&{paddingInner:0}),u(s,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:l===void 0?null:{position:"right"}},l===void 0&&{paddingInner:0}),u(l,"y"))}}}),iR=O(e=>{const{data:t,scale:n,legend:r}=e,i=[e];let s,l,u;for(;i.length;){const b=i.shift(),{children:w,encode:R={},scale:M={},legend:I={}}=b,{color:N}=R,{color:U}=M,{color:Z}=I;N!==void 0&&(s=N),U!==void 0&&(l=U),Z!==void 0&&(u=Z),Array.isArray(w)&&i.push(...w)}const h=()=>{var b;const w=(b=n==null?void 0:n.color)===null||b===void 0?void 0:b.domain;if(w!==void 0)return[w];if(s===void 0)return[void 0];const R=typeof s=="function"?s:I=>I[s],M=t.map(R);return M.some(I=>typeof I=="number")?[S0(M)]:[Array.from(new Set(M)),"ordinal"]},p=typeof s=="string"?s:"",[m,y]=h();return Object.assign({encode:{color:{type:"column",value:m!=null?m:[]}},scale:{color:ni({},l,{domain:m,type:y})}},r===void 0&&{legend:{color:ni({title:p},u)}})}),oR=T(()=>({animate:{enterType:"fadeIn"}})),aR=O(()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}})),sR=O(()=>({type:"cell"})),QN=O(e=>{const{data:t}=e;return{data:{type:"inline",value:t,transform:[{type:"custom",callback:()=>{const{data:r,encode:i}=e,{x:s,y:l}=i,u=s?Array.from(new Set(r.map(m=>m[s]))):[],h=l?Array.from(new Set(r.map(m=>m[l]))):[];return(()=>{if(u.length&&h.length){const m=[];for(const y of u)for(const b of h)m.push({[s]:y,[l]:b});return m}if(u.length)return u.map(m=>({[s]:m}));if(h.length)return h.map(m=>({[l]:m}))})()}}]}}}),JN=O((e,t=LG,n=DG,r=NG,i={})=>{const{data:s,encode:l,children:u,scale:h,x:p=0,y:m=0,shareData:y=!1,key:b}=e,{value:w}=s,{x:R,y:M}=l,{color:I}=h,{domain:N}=I;return{children:(Z,Y,$)=>{const{x:J,y:se}=Y,{paddingLeft:pe,paddingTop:Ce,marginLeft:Ue,marginTop:Je}=$,{domain:lt}=J.getOptions(),{domain:Ge}=se.getOptions(),at=wv(Z),st=Z.map(t),ft=Z.map(({x:ar,y:lr})=>[J.invert(ar),se.invert(lr)]),wt=ft.map(([ar,lr])=>Vr=>{const{[R]:ui,[M]:qi}=Vr;return(R!==void 0?ui===ar:!0)&&(M!==void 0?qi===lr:!0)}).map(ar=>w.filter(ar)),zt=y?Sl(wt,ar=>ar.length):void 0,En=ft.map(([ar,lr])=>({columnField:R,columnIndex:lt.indexOf(ar),columnValue:ar,columnValuesLength:lt.length,rowField:M,rowIndex:Ge.indexOf(lr),rowValue:lr,rowValuesLength:Ge.length})),Vn=En.map(ar=>Array.isArray(u)?u:[u(ar)].flat(1));return at.flatMap(ar=>{const[lr,Vr,ui,qi]=st[ar],Jr=En[ar],Qr=wt[ar];return Vn[ar].map(Qi=>{var Zi,Eo,{scale:Go,key:oa,facet:Ca=!0,axis:Vs={},legend:Sa={}}=Qi,us=PG(Qi,["scale","key","facet","axis","legend"]);const wl=((Zi=Go==null?void 0:Go.y)===null||Zi===void 0?void 0:Zi.guide)||Vs.y,Cu=((Eo=Go==null?void 0:Go.x)===null||Eo===void 0?void 0:Eo.guide)||Vs.x,Gf={x:{tickCount:R?5:void 0},y:{tickCount:M?5:void 0}},Zc=Ca?Qr:Qr.length===0?[]:w,ph={color:{domain:N}},Ou={x:eB(Cu,n)(Jr,Zc),y:eB(wl,r)(Jr,Zc)};return Object.assign(Object.assign({key:`${oa}-${ar}`,data:Zc,margin:0,x:lr+pe+p+Ue,y:Vr+Ce+m+Je,parentKey:b,width:ui,height:qi,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!Zc.length,dataDomain:zt,scale:ni(Gf,Go,ph),axis:ni({},Vs,Ou),legend:!1},us),i)})})}}});function LG(e){const{points:t}=e;return hr(t)}function PT(e,t){return t.length?ni({title:!1,tick:null,label:null},e):ni({title:!1,tick:null,label:null,grid:null},e)}function DG(e){return(t,n)=>{const{rowIndex:r,rowValuesLength:i,columnIndex:s,columnValuesLength:l}=t;if(r!==i-1)return PT(e,n);const u=s!==l-1?!1:void 0,h=n.length?void 0:null;return ni({title:u,grid:h},e)}}function NG(e){return(t,n)=>{const{rowIndex:r,columnIndex:i}=t;if(i!==0)return PT(e,n);const s=r!==0?!1:void 0,l=n.length?void 0:null;return ni({title:s,grid:l},e)}}function eB(e,t){return typeof e=="function"?e:e===null||e===!1?()=>null:t(e)}const tB=()=>e=>[e2.of(e).call(sR).call(iR).call(oR).call(IG).call(aR).call(QN).call(JN).value()];tB.props={};var lR=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const BG=T(e=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),FG=O(e=>{const{data:t,children:n,x:r=0,y:i=0,key:s}=e;return{children:(u,h,p)=>{const{x:m,y}=h,{paddingLeft:b,paddingTop:w,marginLeft:R,marginTop:M}=p,{domain:I}=m.getOptions(),{domain:N}=y.getOptions(),U=wv(u),Z=u.map(({points:se})=>hr(se)),Y=u.map(({x:se,y:pe})=>[m.invert(se),y.invert(pe)]),$=Y.map(([se,pe])=>({columnField:se,columnIndex:I.indexOf(se),columnValue:se,columnValuesLength:I.length,rowField:pe,rowIndex:N.indexOf(pe),rowValue:pe,rowValuesLength:N.length})),J=$.map(se=>Array.isArray(n)?n:[n(se)].flat(1));return U.flatMap(se=>{const[pe,Ce,Ue,Je]=Z[se],[lt,Ge]=Y[se],at=$[se];return J[se].map(ft=>{var Vt,wt;const{scale:zt,key:En,encode:Vn,axis:ar,interaction:lr}=ft,Vr=lR(ft,["scale","key","encode","axis","interaction"]),ui=(Vt=zt==null?void 0:zt.y)===null||Vt===void 0?void 0:Vt.guide,qi=(wt=zt==null?void 0:zt.x)===null||wt===void 0?void 0:wt.guide,Jr={x:{facet:!1},y:{facet:!1}},Qr={x:zG(qi)(at,t),y:UG(ui)(at,t)},Mo={x:{tickCount:5},y:{tickCount:5}};return Object.assign({data:t,parentKey:s,key:`${En}-${se}`,x:pe+b+r+R,y:Ce+w+i+M,width:Ue,height:Je,margin:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:ni(Jr,zt),axis:ni(Mo,ar,Qr),legend:!1,encode:ni({},Vn,{x:lt,y:Ge}),interaction:ni({},lr,{legendFilter:!1})},Vr)})})}}}),kG=O(e=>{const{encode:t}=e,n=lR(e,["encode"]),{position:r=[],x:i=r,y:s=[...r].reverse()}=t,l=lR(t,["position","x","y"]),u=[];for(const h of[i].flat(1))for(const p of[s].flat(1))u.push({$x:h,$y:p});return Object.assign(Object.assign({},n),{data:u,encode:Object.assign(Object.assign({},l),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},[i].flat(1).length===1&&{x:{paddingInner:0}}),[s].flat(1).length===1&&{y:{paddingInner:0}})})});function zG(e){return typeof e=="function"?e:e===null?()=>null:(t,n)=>{const{rowIndex:r,rowValuesLength:i}=t;if(r!==i-1)return PT(e,n)}}function UG(e){return typeof e=="function"?e:e===null?()=>null:(t,n)=>{const{columnIndex:r}=t;if(r!==0)return PT(e,n)}}const jG=()=>e=>[e2.of(e).call(sR).call(iR).call(FG).call(kG).call(oR).call(aR).call(BG).value()];var VG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const HG=T(e=>({scale:{x:{guide:{type:"axisArc"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),ZG=T(e=>({coordinate:{type:"polar"}})),WG=e=>{const{encode:t}=e,n=VG(e,["encode"]),{position:r}=t;return Object.assign(Object.assign({},n),{encode:{x:r}})};function nB(e){return t=>null}function GG(e){const{points:t}=e,[n,r,i,s]=t,l=Ve(n,s),u=ge(n,s),h=ge(r,i),p=Rn(u,h),m=1/Math.sin(p/2),y=l/(1+m),b=y*Math.sqrt(2),[w,R]=i,I=rn(u)+p/2,N=y*m,U=w+N*Math.sin(I),Z=R-N*Math.cos(I);return[U-b/2,Z-b/2,b,b]}const XG=()=>e=>[e2.of(e).call(sR).call(WG).call(iR).call(ZG).call(QN).call(JN,GG,nB,nB,{frame:!1}).call(oR).call(aR).call(HG).value()];function YG(e,t,n){const i=n,s=[0,i],l=[-i+1,1];if(e==="normal")return s;if(e==="reverse")return l;if(e==="alternate")return t%2===0?s:l;if(e==="reverse-alternate")return t%2===0?l:s}function $G(e,t,n){const r=[e];for(;r.length;){const i=r.pop();i.animate=ni({enter:{duration:t},update:{duration:t,easing:n,type:"morphing",fill:"both"},exit:{type:"fadeOut",duration:t}},i.animate||{});const{children:s}=i;Array.isArray(s)&&r.push(...s)}return e}const rB=()=>e=>{const{children:t=[],duration:n=1e3,iterationCount:r=1,direction:i="normal",easing:s="ease-in-out-sine"}=e,l=t.length;if(!Array.isArray(t)||l===0)return[];const{key:u}=t[0],h=t.map(p=>Object.assign(Object.assign({},p),{key:u})).map(p=>$G(p,n,s));return function*(){let p=0,m;for(;r==="infinite"||p<r;){const[y,b]=YG(i,p,l);for(let w=y;w<b;w+=1){const R=Math.abs(w);m!==R&&(yield h[R]),m=R}p++}}};rB.props={};function $g(e,t,n){const{encode:r}=n;if(e===null)return[t];const i=KG(e).map(l=>{var u;return[l,(u=rl(r,l))===null||u===void 0?void 0:u[0]]}).filter(([,l])=>Ql(l)),s=l=>i.map(([,u])=>u[l]).join("-");return Array.from(vc(t,s).values())}function iB(e){return Array.isArray(e)?JG(e):typeof e=="function"?QG(e):e==="series"?qG:e==="value"?eX:e==="sum"?tX:e==="maxIndex"?nX:null}function oB(e,t){for(const n of e)n.sort(t)}function aB(e,t){return(t==null?void 0:t.domain)||Array.from(new Set(e))}function KG(e){return Array.isArray(e)?e:[e]}function qG(e,t,n){return t2(r=>n[r])}function QG(e){return(t,n,r)=>t2(i=>e(t[i]))}function JG(e){return(t,n,r)=>(i,s)=>e.reduce((l,u)=>l!==0?l:Tu(t[i][u],t[s][u]),0)}function eX(e,t,n){return t2(r=>t[r])}function tX(e,t,n){const r=wv(e),i=Array.from(vc(r,l=>n[+l]).entries()),s=new Map(i.map(([l,u])=>[l,u.reduce((h,p)=>h+ +t[p])]));return t2(l=>s.get(n[l]))}function nX(e,t,n){const r=wv(e),i=Array.from(vc(r,l=>n[+l]).entries()),s=new Map(i.map(([l,u])=>[l,A_(u,h=>t[h])]));return t2(l=>s.get(n[l]))}function t2(e){return(t,n)=>Tu(e(t),e(n))}const sB=(e={})=>{const{groupBy:t="x",orderBy:n=null,reverse:r=!1,y:i="y",y1:s="y1",series:l=!0}=e;return(u,h)=>{var p;const{data:m,encode:y,style:b={}}=h,[w,R]=rl(y,"y"),[M,I]=rl(y,"y1"),[N]=l?Fx(y,"series","color"):rl(y,"color"),U=$g(t,u,h),Y=((p=iB(n))!==null&&p!==void 0?p:()=>null)(m,w,N);Y&&oB(U,Y);const $=new Array(u.length),J=new Array(u.length),se=new Array(u.length),pe=[],Ce=[];for(const at of U){r&&at.reverse();const st=M?+M[at[0]]:0,ft=[],Vt=[];for(const Vr of at){const ui=se[Vr]=+w[Vr]-st;ui<0?Vt.push(Vr):ui>=0&&ft.push(Vr)}const wt=ft.length>0?ft:Vt,zt=Vt.length>0?Vt:ft;let En=ft.length-1,Vn=0;for(;En>0&&w[wt[En]]===0;)En--;for(;Vn<zt.length-1&&w[zt[Vn]]===0;)Vn++;pe.push(wt[En]),Ce.push(zt[Vn]);let ar=st;for(const Vr of Vt.reverse()){const ui=se[Vr];ar=$[Vr]=(J[Vr]=ar)+ui}let lr=st;for(const Vr of ft){const ui=se[Vr];ui>0?lr=$[Vr]=(J[Vr]=lr)+ui:$[Vr]=J[Vr]=lr}}const Ue=new Set(pe),Je=new Set(Ce),lt=i==="y"?$:J,Ge=s==="y"?$:J;return[u,ni({},h,{encode:{y0:oT(w,R),y:_c(lt,R),y1:_c(Ge,I)},style:Object.assign({first:(at,st)=>Ue.has(st),last:(at,st)=>Je.has(st)},b)})]}};sB.props={};function lB(e,t){let n=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(i=+i)>=i&&++n}return n}function rX(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let l of e)l!=null&&(l=+l)>=l&&(r=l-i,i+=r/++n,s+=r*(l-i));else{let l=-1;for(let u of e)(u=t(u,++l,e))!=null&&(u=+u)>=u&&(r=u-i,i+=r/++n,s+=r*(u-i))}if(n>1)return s/(n-1)}function cB(e,t){const n=rX(e,t);return n&&Math.sqrt(n)}function iX(e,t,n){const r=lB(e),i=cB(e);return r&&i?Math.ceil((n-t)*Math.cbrt(r)/(3.49*i)):1}var uB=Array.prototype,oX=uB.slice,jte=uB.map;function cR(e){return()=>e}const aX=Math.sqrt(50),sX=Math.sqrt(10),lX=Math.sqrt(2);function IT(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),l=s>=aX?10:s>=sX?5:s>=lX?2:1;let u,h,p;return i<0?(p=Math.pow(10,-i)/l,u=Math.round(e*p),h=Math.round(t*p),u/p<e&&++u,h/p>t&&--h,p=-p):(p=Math.pow(10,i)*l,u=Math.round(e/p),h=Math.round(t/p),u*p<e&&++u,h*p>t&&--h),h<u&&.5<=n&&n<2?IT(e,t,n*2):[u,h,p]}function cX(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,l]=r?IT(t,e,n):IT(e,t,n);if(!(s>=i))return[];const u=s-i+1,h=new Array(u);if(r)if(l<0)for(let p=0;p<u;++p)h[p]=(s-p)/-l;else for(let p=0;p<u;++p)h[p]=(s-p)*l;else if(l<0)for(let p=0;p<u;++p)h[p]=(i+p)/-l;else for(let p=0;p<u;++p)h[p]=(i+p)*l;return h}function n2(e,t,n){return t=+t,e=+e,n=+n,IT(e,t,n)[2]}function Vte(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?n2(t,e,n):n2(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function uX(e,t,n){let r;for(;;){const i=n2(e,t,n);if(i===r||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function fX(e){return Math.max(1,Math.ceil(Math.log(lB(e))/Math.LN2)+1)}function hX(){var e=Im,t=S0,n=fX;function r(i){Array.isArray(i)||(i=Array.from(i));var s,l=i.length,u,h,p=new Array(l);for(s=0;s<l;++s)p[s]=e(i[s],s,i);var m=t(p),y=m[0],b=m[1],w=n(p,y,b);if(!Array.isArray(w)){const Z=b,Y=+w;if(t===S0&&([y,b]=uX(y,b,Y)),w=cX(y,b,Y),w[0]<=y&&(h=n2(y,b,Y)),w[w.length-1]>=b)if(Z>=b&&t===S0){const $=n2(y,b,Y);isFinite($)&&($>0?b=(Math.floor(b/$)+1)*$:$<0&&(b=(Math.ceil(b*-$)+1)/-$))}else w.pop()}for(var R=w.length,M=0,I=R;w[M]<=y;)++M;for(;w[I-1]>b;)--I;(M||I<R)&&(w=w.slice(M,I),R=I-M);var N=new Array(R+1),U;for(s=0;s<=R;++s)U=N[s]=[],U.x0=s>0?w[s-1]:y,U.x1=s<R?w[s]:b;if(isFinite(h)){if(h>0)for(s=0;s<l;++s)(u=p[s])!=null&&y<=u&&u<=b&&N[Math.min(R,Math.floor((u-y)/h))].push(i[s]);else if(h<0){for(s=0;s<l;++s)if((u=p[s])!=null&&y<=u&&u<=b){const Z=Math.floor((y-u)*h);N[Math.min(R,Z+(w[Z]<=u))].push(i[s])}}}else for(s=0;s<l;++s)(u=p[s])!=null&&y<=u&&u<=b&&N[Wk(w,u,0,R)].push(i[s]);return N}return r.value=function(i){return arguments.length?(e=typeof i=="function"?i:cR(i),r):e},r.domain=function(i){return arguments.length?(t=typeof i=="function"?i:cR([i[0],i[1]]),r):t},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:cR(Array.isArray(i)?oX.call(i):i),r):n},r}function uR(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?Ex:GP(i);r>n;){if(r-n>600){const h=r-n+1,p=t-n+1,m=Math.log(h),y=.5*Math.exp(2*m/3),b=.5*Math.sqrt(m*y*(h-y)/h)*(p-h/2<0?-1:1),w=Math.max(n,Math.floor(t-p*y/h+b)),R=Math.min(r,Math.floor(t+(h-p)*y/h+b));uR(e,t,w,R,i)}const s=e[t];let l=n,u=r;for(r2(e,n,t),i(e[r],s)>0&&r2(e,n,r);l<u;){for(r2(e,l,u),++l,--u;i(e[l],s)<0;)++l;for(;i(e[u],s)>0;)--u}i(e[n],s)===0?r2(e,n,u):(++u,r2(e,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}return e}function r2(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function dX(e,t=Tu){let n,r=!1;if(t.length===1){let i;for(const s of e){const l=t(s);(r?Tu(l,i)>0:Tu(l,l)===0)&&(n=s,i=l,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function LT(e,t,n){if(e=Float64Array.from(jk(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Zp(e);if(t>=1)return Sl(e);var r,i=(r-1)*t,s=Math.floor(i),l=Sl(uR(e,s).subarray(0,s+1)),u=Zp(e.subarray(s+1));return l+(u-l)*(i-s)}}function Hte(e,t,n=number){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),l=+n(e[s],s,e),u=+n(e[s+1],s+1,e);return l+(u-l)*(i-s)}}function pX(e,t,n=yO){if(!isNaN(t=+t)){if(r=Float64Array.from(e,(u,h)=>yO(n(e[h],h,e))),t<=0)return Qx(r);if(t>=1)return A_(r);var r,i=Uint32Array.from(e,(u,h)=>h),s=r.length-1,l=Math.floor(s*t);return uR(i,l,0,s,(u,h)=>Ex(r[u],r[h])),l=dX(i.subarray(0,l+1),u=>r[u]),l>=0?l:-1}}function fR(e,t){return LT(e,.5,t)}function mX(e,t){return pX(e,.5,t)}var vX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Kg(e){return t=>t===null?e:`${e} of ${t}`}function gX(e){if(typeof e=="function")return[e,null];const n={mean:yX,max:bX,count:EX,first:TX,last:wX,sum:SX,min:xX,median:_X}[e];if(!n)throw new Error(`Unknown reducer: ${e}.`);return n()}function yX(){const e=(n,r)=>Jx(n,i=>+r[i]),t=Kg("mean");return[e,t]}function _X(){const e=(n,r)=>fR(n,i=>+r[i]),t=Kg("median");return[e,t]}function bX(){const e=(n,r)=>Sl(n,i=>+r[i]),t=Kg("max");return[e,t]}function xX(){const e=(n,r)=>Zp(n,i=>+r[i]),t=Kg("min");return[e,t]}function EX(){const e=(n,r)=>n.length,t=Kg("count");return[e,t]}function SX(){const e=(n,r)=>sp(n,i=>+r[i]),t=Kg("sum");return[e,t]}function TX(){const e=(n,r)=>r[n[0]],t=Kg("first");return[e,t]}function wX(){const e=(n,r)=>r[n[n.length-1]],t=Kg("last");return[e,t]}const hR=(e={})=>{const{groupBy:t}=e,n=vX(e,["groupBy"]);return(r,i)=>{const{data:s,encode:l}=i,u=t(r,i);if(!u)return[r,i];const h=(w,R)=>{if(w)return w;const{from:M}=R;if(!M)return w;const[,I]=rl(l,M);return I},p=Object.entries(n).map(([w,R])=>{const[M,I]=gX(R),[N,U]=rl(l,w),Z=h(U,R),Y=u.map($=>M($,N!=null?N:s));return[w,Object.assign(Object.assign({},sV(Y,(I==null?void 0:I(Z))||Z)),{aggregate:!0})]}),m=Object.keys(l).map(w=>{const[R,M]=rl(l,w),I=u.map(N=>R[N[0]]);return[w,_c(I,M)]}),y=u.map(w=>s[w[0]]);return[wv(u),ni({},i,{data:y,encode:Object.fromEntries([...m,...p])})]}};hR.props={};var AX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const fB="thresholds";function CX(e){const[t,n]=S0(e);return Math.min(200,iX(e,t,n))}const dR=(e={})=>{const{groupChannels:t=["color"],binChannels:n=["x","y"]}=e,r=AX(e,["groupChannels","binChannels"]),i={},s=(l,u)=>{const{encode:h}=u,p=n.map(R=>{const[M]=rl(h,R);return M}),m=po(r,fB),y=l.filter(R=>p.every(M=>Ql(M[R]))),b=[...t.map(R=>{const[M]=rl(h,R);return M}).filter(Ql).map(R=>M=>R[M]),...n.map((R,M)=>{const I=p[M],N=m[R]||CX(I),U=hX().thresholds(N).value(Y=>+I[Y])(y),Z=new Map(U.flatMap(Y=>{const{x0:$,x1:J}=Y,se=`${$},${J}`;return Y.map(pe=>[pe,se])}));return i[R]=Z,Y=>Z.get(Y)})],w=R=>b.map(M=>M(R)).join("-");return Array.from(vc(y,w).values())};return hR(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(r).filter(([l])=>!l.startsWith(fB)))),Object.fromEntries(n.flatMap(l=>{const u=([p])=>+i[l].get(p).split(",")[0],h=([p])=>+i[l].get(p).split(",")[1];return h.from=l,[[l,u],[`${l}1`,h]]}))),{groupBy:s}))};dR.props={};const hB=(e={})=>{const{thresholds:t}=e;return dR(Object.assign(Object.assign({},e),{thresholdsX:t,groupChannels:["color"],binChannels:["x"]}))};hB.props={};var OX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const dB=(e={})=>{const{groupBy:t="x",reverse:n=!1,orderBy:r,padding:i}=e,s=OX(e,["groupBy","reverse","orderBy","padding"]);return(l,u)=>{const{data:h,encode:p,scale:m}=u,{series:y}=m,[b]=rl(p,"y"),[w]=Fx(p,"series","color"),R=aB(w,y),M=ni({},u,{scale:{series:{domain:R,paddingInner:i}}}),I=$g(t,l,u),N=iB(r);if(!N)return[l,ni(M,{encode:{series:_c(w)}})];const U=N(h,b,w);U&&oB(I,U);const Z=new Array(l.length);for(const Y of I){n&&Y.reverse();for(let $=0;$<Y.length;$++)Z[Y[$]]=R[$]}return[l,ni(M,{encode:{series:_c(r?Z:w)}})]}};dB.props={};function DT(e,t,n){if(e===null)return[-.5,.5];const r=aB(e,t),s=new Wg({domain:r,range:[0,1],padding:n}).getBandWidth();return[-s/2,s/2]}function NT(e,t,n){return t*(1-e)+n*e}const pB=(e={})=>{const{padding:t=0,paddingX:n=t,paddingY:r=t,random:i=Math.random}=e;return(s,l)=>{const{encode:u,scale:h}=l,{x:p,y:m}=h,[y]=rl(u,"x"),[b]=rl(u,"y"),w=DT(y,p,n),R=DT(b,m,r),M=s.map(()=>NT(i(),...R)),I=s.map(()=>NT(i(),...w));return[s,ni({scale:{x:{padding:.5},y:{padding:.5}}},l,{encode:{dy:_c(M),dx:_c(I)}})]}};pB.props={};const mB=(e={})=>{const{padding:t=0,random:n=Math.random}=e;return(r,i)=>{const{encode:s,scale:l}=i,{x:u}=l,[h]=rl(s,"x"),p=DT(h,u,t),m=r.map(()=>NT(n(),...p));return[r,ni({scale:{x:{padding:.5}}},i,{encode:{dx:_c(m)}})]}};mB.props={};const vB=(e={})=>{const{padding:t=0,random:n=Math.random}=e;return(r,i)=>{const{encode:s,scale:l}=i,{y:u}=l,[h]=rl(s,"y"),p=DT(h,u,t),m=r.map(()=>NT(n(),...p));return[r,ni({scale:{y:{padding:.5}}},i,{encode:{dy:_c(m)}})]}};vB.props={};var RX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const gB=(e={})=>{const{groupBy:t="x"}=e;return(n,r)=>{const{encode:i}=r,{x:s}=i,l=RX(i,["x"]),u=Object.entries(l).filter(([b])=>b.startsWith("y")).map(([b])=>[b,rl(i,b)[0]]),h=u.map(([b])=>[b,new Array(n.length)]),p=$g(t,n,r),m=new Array(p.length);for(let b=0;b<p.length;b++){const R=p[b].flatMap(N=>u.map(([,U])=>+U[N])),[M,I]=S0(R);m[b]=(M+I)/2}const y=Math.max(...m);for(let b=0;b<p.length;b++){const w=y-m[b],R=p[b];for(const M of R)for(let I=0;I<u.length;I++){const[,N]=u[I],[,U]=h[I];U[M]=+N[M]+w}}return[n,ni({},r,{encode:Object.fromEntries(h.map(([b,w])=>[b,_c(w,rl(i,b)[1])]))})]}};gB.props={};const yB=(e={})=>{const{groupBy:t="x",series:n=!0}=e;return(r,i)=>{const{encode:s}=i,[l]=rl(s,"y"),[u,h]=rl(s,"y1"),[p]=n?Fx(s,"series","color"):rl(s,"color"),m=$g(t,r,i),y=new Array(r.length);for(const b of m){const w=b.map(R=>+l[R]);for(let R=0;R<b.length;R++){const M=b[R],I=Math.max(...w.filter((N,U)=>U!==R));y[M]=+l[M]>I?I:l[M]}}return[r,ni({},i,{encode:{y1:_c(y,h)}})]}};yB.props={};const _B=e=>{const{groupBy:t=["x"],reducer:n=(l,u)=>u[l[0]],orderBy:r=null,reverse:i=!1,duration:s}=e;return(l,u)=>{const{encode:h}=u,m=(Array.isArray(t)?t:[t]).map(I=>[I,rl(h,I)[0]]);if(m.length===0)return[l,u];let y=[l];for(const[,I]of m){const N=[];for(const U of y){const Z=Array.from(vc(U,Y=>I[Y]).values());N.push(...Z)}y=N}if(r){const[I]=rl(h,r);I&&y.sort((N,U)=>n(N,I)-n(U,I)),i&&y.reverse()}const b=(s||3e3)/y.length,[w]=s?[Hg(l,b)]:Fx(h,"enterDuration",Hg(l,b)),[R]=Fx(h,"enterDelay",Hg(l,0)),M=new Array(l.length);for(let I=0,N=0;I<y.length;I++){const U=y[I],Z=Sl(U,Y=>+w[Y]);for(const Y of U)M[Y]=+R[Y]+N;N+=Z}return[l,ni({},u,{encode:{enterDuration:aT(w),enterDelay:aT(M)}})]}};_B.props={};var MX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function PX(e){return typeof e=="function"?e:{min:(n,r)=>Zp(n,i=>r[+i]),max:(n,r)=>Sl(n,i=>r[+i]),first:(n,r)=>r[n[0]],last:(n,r)=>r[n[n.length-1]],mean:(n,r)=>Jx(n,i=>r[+i]),median:(n,r)=>fR(n,i=>r[+i]),sum:(n,r)=>sp(n,i=>r[+i]),deviation:(n,r)=>cB(n,i=>r[+i])}[e]||Sl}const bB=(e={})=>{const{groupBy:t="x",basis:n="max"}=e;return(r,i)=>{const{encode:s,tooltip:l}=i,{x:u}=s,h=MX(s,["x"]),p=Object.entries(h).filter(([M])=>M.startsWith("y")).map(([M])=>[M,rl(s,M)[0]]),[,m]=p.find(([M])=>M==="y"),y=p.map(([M])=>[M,new Array(r.length)]),b=$g(t,r,i),w=PX(n);for(const M of b){const I=w(M,m);for(const N of M)for(let U=0;U<p.length;U++){const[,Z]=p[U],[,Y]=y[U];Y[N]=+Z[N]/I}}const R=X0(l)||(l==null?void 0:l.items)&&(l==null?void 0:l.items.length)!==0;return[r,ni({},i,Object.assign({encode:Object.fromEntries(y.map(([M,I])=>[M,_c(I,rl(s,M)[1])]))},!R&&s.y0&&{tooltip:{items:[{channel:"y0"}]}}))]}};bB.props={};function xB(e,t){return[e[0]]}function IX(e,t){const n=e.length-1;return[e[n]]}function LX(e,t){const n=A_(e,r=>t[r]);return[e[n]]}function DX(e,t){const n=Qx(e,r=>t[r]);return[e[n]]}function NX(e){return typeof e=="function"?e:{first:xB,last:IX,max:LX,min:DX}[e]||xB}const BT=(e={})=>{const{groupBy:t="series",channel:n,selector:r}=e;return(i,s)=>{const{encode:l}=s,u=$g(t,i,s),[h]=rl(l,n),p=NX(r);return[u.flatMap(m=>p(m,h)),s]}};BT.props={};var BX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const EB=(e={})=>{const{selector:t}=e,n=BX(e,["selector"]);return BT(Object.assign({channel:"x",selector:t},n))};EB.props={};var FX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const SB=(e={})=>{const{selector:t}=e,n=FX(e,["selector"]);return BT(Object.assign({channel:"y",selector:t},n))};SB.props={};var kX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const i2=(e={})=>{const{channels:t=["x","y"]}=e,n=kX(e,["channels"]),r=(i,s)=>$g(t,i,s);return hR(Object.assign(Object.assign({},n),{groupBy:r}))};i2.props={};const TB=(e={})=>i2(Object.assign(Object.assign({},e),{channels:["x","color","series"]}));TB.props={};const wB=(e={})=>i2(Object.assign(Object.assign({},e),{channels:["y","color","series"]}));wB.props={};const AB=(e={})=>i2(Object.assign(Object.assign({},e),{channels:["color"]}));AB.props={};function zX(e,t,n){return(t.length!==2?em(W1(e,t,n),([r,i],[s,l])=>Tu(i,l)||Tu(r,s)):em(vc(e,n),([r,i],[s,l])=>t(i,l)||Tu(r,s))).map(([r])=>r)}var CB=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function UX(e,t,n){const{by:r=e,reducer:i="max"}=t,[s]=rl(n,r);if(typeof i=="function")return l=>i(l,s);if(i==="max")return l=>Sl(l,u=>+s[u]);if(i==="min")return l=>Zp(l,u=>+s[u]);if(i==="sum")return l=>sp(l,u=>+s[u]);if(i==="median")return l=>fR(l,u=>+s[u]);if(i==="mean")return l=>Jx(l,u=>+s[u]);if(i==="first")return l=>s[l[0]];if(i==="last")return l=>s[l[l.length-1]];throw new Error(`Unknown reducer: ${i}`)}function jX(e,t,n){const{reverse:r,channel:i}=n,{encode:s}=t,[l]=rl(s,i),u=em(e,h=>l[h]);return r&&u.reverse(),[u,t]}function VX(e,t,n){if(!Array.isArray(n))return e;const r=new Set(n);return e.filter(i=>r.has(t[i]))}function HX(e,t,n){var r;const{reverse:i,slice:s,channel:l}=n,u=CB(n,["reverse","slice","channel"]),{encode:h,scale:p={}}=t,m=(r=p[l])===null||r===void 0?void 0:r.domain,[y]=rl(h,l),b=UX(l,u,h),w=VX(e,y,m),R=zX(w,b,N=>y[N]);i&&R.reverse();const M=typeof s=="number"?[0,s]:s,I=s?R.slice(...M):R;return[e,ni(t,{scale:{[l]:{domain:I}}})]}const FT=(e={})=>{const{reverse:t=!1,slice:n,channel:r,ordinal:i=!0}=e,s=CB(e,["reverse","slice","channel","ordinal"]);return(l,u)=>i?HX(l,u,Object.assign({reverse:t,slice:n,channel:r},s)):jX(l,u,Object.assign({reverse:t,slice:n,channel:r},s))};FT.props={};const OB=(e={})=>FT(Object.assign(Object.assign({},e),{channel:"x"}));OB.props={};const RB=(e={})=>FT(Object.assign(Object.assign({},e),{channel:"y"}));RB.props={};const MB=(e={})=>FT(Object.assign(Object.assign({},e),{channel:"color"}));MB.props={};function ZX(e,t){return typeof t=="string"?e.map(n=>n[t]):e.map(t)}function WX(e,t){if(typeof e=="function")return n=>e(n,t);if(e==="sum")return n=>sp(n,r=>+t[r]);throw new Error(`Unknown reducer: ${e}`)}const PB=(e={})=>{const{field:t,channel:n="y",reducer:r="sum"}=e;return(i,s)=>{const{data:l,encode:u}=s,[h]=rl(u,"x"),p=t?ZX(l,t):rl(u,n)[0],m=WX(r,p),y=G1(i,m,b=>h[b]).map(b=>b[1]);return[i,ni({},s,{scale:{x:{flex:y}}})]}};PB.props={};function GX(e){const{padding:t=0,direction:n="col"}=e;return(r,i,s)=>{const l=r.length;if(l===0)return[];const{innerWidth:u,innerHeight:h}=s,p=h/u;let m=Math.ceil(Math.sqrt(i/p)),y=u/m,b=Math.ceil(i/m),w=b*y;for(;w>h;)m=m+1,y=u/m,b=Math.ceil(i/m),w=b*y;const R=h-b*y,M=b<=1?0:R/(b-1),[I,N]=b<=1?[(u-l*y)/(l-1),(h-y)/2]:[0,0];return r.map((U,Z)=>{const[Y,$,J,se]=hr(U),pe=n==="col"?Z%m:Math.floor(Z/b),Ce=n==="col"?Math.floor(Z/m):Z%b,Ue=pe*y,Je=(b-Ce-1)*y+R,lt=(y-t)/J,Ge=(y-t)/se,at=Ue-Y+I*pe+1/2*t,st=Je-$-M*Ce-N+1/2*t;return`translate(${at}, ${st}) scale(${lt}, ${Ge})`})}}const IB=e=>(t,n)=>[t,ni({},n,{modifier:GX(e),axis:!1})];IB.props={};function XX(e,t,n,r){const i=e.length;if(r>=i||r===0)return e;const s=w=>t[e[w]]*1,l=w=>n[e[w]]*1,u=[],h=(i-2)/(r-2);let p=0,m,y,b;u.push(p);for(let w=0;w<r-2;w++){let R=0,M=0,I=Math.floor((w+1)*h)+1,N=Math.floor((w+2)*h)+1;N=Math.min(N,i);const U=N-I;for(;I<N;I++)R+=s(I),M+=l(I);R/=U,M/=U;let Z=Math.floor((w+0)*h)+1;const Y=Math.floor((w+1)*h)+1,$=[s(p),l(p)];for(m=y=-1;Z<Y;Z++)y=Math.abs(($[0]-R)*(s(Z)-$[1])-($[0]-l(Z))*(M-$[0]))*.5,y>m&&(m=y,b=Z);u.push(b),p=b}return u.push(i-1),u.map(w=>e[w])}function YX(e){if(typeof e=="function")return e;if(e==="lttb")return XX;const t={first:r=>[r[0]],last:r=>[r[r.length-1]],min:(r,i,s)=>[r[Qx(r,l=>s[l])]],max:(r,i,s)=>[r[A_(r,l=>s[l])]],median:(r,i,s)=>[r[mX(r,l=>s[l])]]},n=t[e]||t.median;return(r,i,s,l)=>{const u=Math.max(1,Math.floor(r.length/l));return $X(r,u).flatMap(p=>n(p,i,s))}}function $X(e,t){const n=e.length,r=[];let i=0;for(;i<n;)r.push(e.slice(i,i+=t));return r}const LB=(e={})=>{const{strategy:t="median",thresholds:n=2e3,groupBy:r=["series","color"]}=e,i=YX(t);return(s,l)=>{const{encode:u}=l,h=$g(r,s,l),[p]=rl(u,"x"),[m]=rl(u,"y");return[h.flatMap(y=>i(y,p,m,n)),l]}};LB.props={};function KX(e){return typeof e=="object"?[e.value,e.ordinal]:[e,!0]}function qX(e){var t;const{encode:n}=e,r=Object.assign(Object.assign({},e),{encode:Object.assign(Object.assign({},e.encode),{y:Object.assign(Object.assign({},e.encode.y),{value:[]})})}),i=(t=n==null?void 0:n.color)===null||t===void 0?void 0:t.field;if(!n||!i)return r;let s;for(const[l,u]of Object.entries(n))(l==="x"||l==="y")&&u.field===i&&(s=Object.assign(Object.assign({},s),{[l]:Object.assign(Object.assign({},u),{value:[]})}));return s?Object.assign(Object.assign({},e),{encode:Object.assign(Object.assign({},e.encode),s)}):r}const DB=(e={})=>(t,n)=>{const{encode:r,data:i}=n,s=Object.entries(e).map(([m,y])=>{const[b]=rl(r,m);if(!b)return null;const[w,R=!0]=KX(y);if(typeof w=="function")return M=>w(b[M]);if(R){const M=Array.isArray(w)?w:[w];return M.length===0?null:I=>M.includes(b[I])}else{const[M,I]=w;return N=>b[N]>=M&&b[N]<=I}}).filter(Ql),l=m=>s.every(y=>y(m)),u=t.filter(l),h=u.map((m,y)=>y);if(s.length===0){const m=qX(n);return[t,m]}const p=Object.entries(r).map(([m,y])=>[m,Object.assign(Object.assign({},y),{value:h.map(b=>y.value[u[b]]).filter(b=>b!==void 0)})]);return[h,ni({},n,{encode:Object.fromEntries(p),data:u.map(m=>i[m])})]};DB.props={};var NB={},pR={},mR=34,o2=10,vR=13;function BB(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function QX(e,t){var n=BB(e);return function(r,i){return t(n(r),i,e)}}function FB(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function pp(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function JX(e){return e<0?"-"+pp(-e,6):e>9999?"+"+pp(e,6):pp(e,4)}function eY(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":JX(e.getUTCFullYear(),4)+"-"+pp(e.getUTCMonth()+1,2)+"-"+pp(e.getUTCDate(),2)+(i?"T"+pp(t,2)+":"+pp(n,2)+":"+pp(r,2)+"."+pp(i,3)+"Z":r?"T"+pp(t,2)+":"+pp(n,2)+":"+pp(r,2)+"Z":n||t?"T"+pp(t,2)+":"+pp(n,2)+"Z":"")}function tY(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(y,b){var w,R,M=i(y,function(I,N){if(w)return w(I,N-1);R=I,w=b?QX(I,b):BB(I)});return M.columns=R||[],M}function i(y,b){var w=[],R=y.length,M=0,I=0,N,U=R<=0,Z=!1;y.charCodeAt(R-1)===o2&&--R,y.charCodeAt(R-1)===vR&&--R;function Y(){if(U)return pR;if(Z)return Z=!1,NB;var J,se=M,pe;if(y.charCodeAt(se)===mR){for(;M++<R&&y.charCodeAt(M)!==mR||y.charCodeAt(++M)===mR;);return(J=M)>=R?U=!0:(pe=y.charCodeAt(M++))===o2?Z=!0:pe===vR&&(Z=!0,y.charCodeAt(M)===o2&&++M),y.slice(se+1,J-1).replace(/""/g,'"')}for(;M<R;){if((pe=y.charCodeAt(J=M++))===o2)Z=!0;else if(pe===vR)Z=!0,y.charCodeAt(M)===o2&&++M;else if(pe!==n)continue;return y.slice(se,J)}return U=!0,y.slice(se,R)}for(;(N=Y())!==pR;){for(var $=[];N!==NB&&N!==pR;)$.push(N),N=Y();b&&($=b($,I++))==null||w.push($)}return w}function s(y,b){return y.map(function(w){return b.map(function(R){return m(w[R])}).join(e)})}function l(y,b){return b==null&&(b=FB(y)),[b.map(m).join(e)].concat(s(y,b)).join(`
`)}function u(y,b){return b==null&&(b=FB(y)),s(y,b).join(`
`)}function h(y){return y.map(p).join(`
`)}function p(y){return y.map(m).join(e)}function m(y){return y==null?"":y instanceof Date?eY(y):t.test(y+="")?'"'+y.replace(/"/g,'""')+'"':y}return{parse:r,parseRows:i,format:l,formatBody:u,formatRows:h,formatRow:p,formatValue:m}}function nY(e){for(var t in e){var n=e[t].trim(),r,i;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(i=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))rY&&i[4]&&!i[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;e[t]=n}return e}const rY=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var iY=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const kB=e=>{const{value:t,format:n=t.split(".").pop(),delimiter:r=",",autoType:i=!0}=e;return()=>iY(void 0,void 0,void 0,function*(){const s=yield fetch(t);if(n==="csv"){const l=yield s.text();return tY(r).parse(l,i?nY:Ev)}else if(n==="json")return yield s.json();throw new Error(`Unknown format: ${n}.`)})};kB.props={};const zB=e=>{const{value:t}=e;return()=>t};zB.props={};function oY(e,t){return e.map(n=>{if(Array.isArray(n)){const[r,i=t]=n;return[r,i]}return[n,t]})}const UB=e=>{const{fields:t=[]}=e,n=oY(t,!0);return r=>{const i=(s,l)=>n.reduce((u,[h,p=!0])=>u!==0?u:p?s[h]<l[h]?-1:+(s[h]!==l[h]):s[h]>l[h]?-1:+(s[h]!==l[h]),0);return[...r].sort(i)}};UB.props={};function Zte(e){return e!=null&&!Number.isNaN(e)}const jB=e=>{const{callback:t}=e;return n=>Array.isArray(n)?[...n].sort(t):n};jB.props={};function aY(e){return e!=null&&!Number.isNaN(e)}const VB=e=>{const{callback:t=aY}=e;return n=>n.filter(t)};VB.props={};function sY(e,t=[]){return t.reduce((n,r)=>(r in e&&(n[r]=e[r]),n),{})}const HB=e=>{const{fields:t}=e;return n=>n.map(r=>sY(r,t))};HB.props={};function lY(e){return Object.keys(e).length===0}const ZB=e=>t=>{if(!e||lY(e))return t;const n=r=>Object.entries(r).reduce((i,[s,l])=>(i[e[s]||s]=l,i),{});return t.map(n)};ZB.props={};function cY(e){return!e||Object.keys(e).length===0}const WB=e=>{const{fields:t,key:n="key",value:r="value"}=e;return i=>cY(t)?i:i.flatMap(s=>t.map(l=>Object.assign(Object.assign({},s),{[n]:l,[r]:s[l]})))};WB.props={};const GB=e=>{const{start:t,end:n}=e;return r=>r.slice(t,n)};GB.props={};const XB=e=>{const{callback:t=Ev}=e;return n=>t(n)};XB.props={};const YB=e=>{const{callback:t=Ev}=e;return n=>Array.isArray(n)?n.map(t):n};YB.props={};function $B(e){return typeof e=="string"?t=>t[e]:e}const KB=e=>{const{join:t,on:n,select:r=[],as:i=r,unknown:s=NaN}=e,[l,u]=n,h=$B(u),p=$B(l),m=W1(t,([y])=>y,y=>h(y));return y=>y.map(b=>{const w=m.get(p(b));return Object.assign(Object.assign({},b),r.reduce((R,M,I)=>(R[i[I]]=w?w[M]:s,R),{}))})};KB.props={};var uY=D(53843),fY=D.n(uY);function Wte(e){return e!=null&&!Number.isNaN(e)}const qB=e=>{const{field:t,groupBy:n,as:r=["y","size"],min:i,max:s,size:l=10,width:u}=e,[h,p]=r;return m=>Array.from(vc(m,b=>n.map(w=>b[w]).join("-")).values()).map(b=>{const w=fY().create(b.map(I=>I[t]),{min:i,max:s,size:l,width:u}),R=w.map(I=>I.x),M=w.map(I=>I.y);return Object.assign(Object.assign({},b[0]),{[h]:R,[p]:M})})};qB.props={};const QB=()=>e=>(console.log("G2 data section:",e),e);QB.props={};var hY=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};function dY(e,t){return{set(n,r,i){if(t[n]===void 0)return this;const s=r?r.call(null,t[n]):t[n];return i?i.call(null,s):typeof e[n]=="function"?e[n](s):e[n]=s,this},setAsync(n,r,i){return hY(this,void 0,void 0,function*(){if(t[n]===void 0)return this;const s=r?yield r.call(null,t[n]):t[n];return i?i.call(null,s):typeof e[n]=="function"?e[n](s):e[n]=s,this})}}}const gR=Math.PI/180,a2=64,kT=2048;function pY(e){return e.text}function mY(){return"serif"}function JB(){return"normal"}function vY(e){return e.value}function gY(){return~~(Math.random()*2)*90}function yY(){return 1}function _Y(){}function bY(e,t,n,r){if(t.sprite)return;const i=e.context,s=e.ratio;i.clearRect(0,0,(a2<<5)/s,kT/s);let l=0,u=0,h=0;const p=n.length;for(--r;++r<p;){t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font;let b=i.measureText(t.text+"m").width*s,w=t.size<<1;if(t.rotate){const R=Math.sin(t.rotate*gR),M=Math.cos(t.rotate*gR),I=b*M,N=b*R,U=w*M,Z=w*R;b=Math.max(Math.abs(I+Z),Math.abs(I-Z))+31>>5<<5,w=~~Math.max(Math.abs(N+U),Math.abs(N-U))}else b=b+31>>5<<5;if(w>h&&(h=w),l+b>=a2<<5&&(l=0,u+=h,h=0),u+w>=kT)break;i.translate((l+(b>>1))/s,(u+(w>>1))/s),t.rotate&&i.rotate(t.rotate*gR),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=b,t.height=w,t.xoff=l,t.yoff=u,t.x1=b>>1,t.y1=w>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,l+=b}const m=i.getImageData(0,0,(a2<<5)/s,kT/s).data,y=[];for(;--r>=0;){if(t=n[r],!t.hasText)continue;const b=t.width,w=b>>5;let R=t.y1-t.y0;for(let N=0;N<R*w;N++)y[N]=0;if(l=t.xoff,l==null)return;u=t.yoff;let M=0,I=-1;for(let N=0;N<R;N++){for(let U=0;U<b;U++){const Z=w*N+(U>>5),Y=m[(u+N)*(a2<<5)+(l+U)<<2]?1<<31-U%32:0;y[Z]|=Y,M|=Y}M?I=N:(t.y0++,R--,N--,u++)}t.y1=t.y0+I,t.sprite=y.slice(0,(t.y1-t.y0)*w)}}function xY(e,t,n){n>>=5;const r=e.sprite,i=e.width>>5,s=e.x-(i<<4),l=s&127,u=32-l,h=e.y1-e.y0;let p=(e.y+e.y0)*n+(s>>5),m;for(let y=0;y<h;y++){m=0;for(let b=0;b<=i;b++)if((m<<u|(b<i?(m=r[y*i+b])>>>l:0))&t[p+b])return!0;p+=n}return!1}function EY(e,t){const n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function SY(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function eF(e){const t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function TY(e){const n=4*e[0]/e[1];let r=0,i=0;return function(s){const l=s<0?-1:1;switch(Math.sqrt(1+4*l*s)-l&3){case 0:r+=n;break;case 1:i+=4;break;case 2:r-=n;break;default:i-=4;break}return[r,i]}}function tF(e){const t=[];let n=-1;for(;++n<e;)t[n]=0;return t}function wY(){return document.createElement("canvas")}function Uv(e){return typeof e=="function"?e:function(){return e}}const AY={archimedean:eF,rectangular:TY};function CY(){let e=[256,256],t=pY,n=mY,r=vY,i=JB,s=gY,l=yY,u=eF,h=Math.random,p=_Y,m=[],y=null,b=1/0,w=wY;const R=JB,M={};M.start=function(){const[U,Z]=e,Y=I(w()),$=M.board?M.board:tF((e[0]>>5)*e[1]),J=m.length,se=[],pe=m.map(function(lt,Ge,at){return lt.text=t.call(this,lt,Ge,at),lt.font=n.call(this,lt,Ge,at),lt.style=R.call(this,lt,Ge,at),lt.weight=i.call(this,lt,Ge,at),lt.rotate=s.call(this,lt,Ge,at),lt.size=~~r.call(this,lt,Ge,at),lt.padding=l.call(this,lt,Ge,at),lt}).sort(function(lt,Ge){return Ge.size-lt.size});let Ce=-1,Ue=M.board?[{x:0,y:0},{x:U,y:Z}]:void 0;y&&clearInterval(y),y=setInterval(Je,0),Je();function Je(){const lt=Date.now();for(;Date.now()-lt<b&&++Ce<J;){const Ge=pe[Ce];Ge.x=U*(h()+.5)>>1,Ge.y=Z*(h()+.5)>>1,bY(Y,Ge,pe,Ce),Ge.hasText&&N($,Ge,Ue)&&(p.call(null,"word",{cloud:M,word:Ge}),se.push(Ge),Ue?M.hasImage||EY(Ue,Ge):Ue=[{x:Ge.x+Ge.x0,y:Ge.y+Ge.y0},{x:Ge.x+Ge.x1,y:Ge.y+Ge.y1}],Ge.x-=e[0]>>1,Ge.y-=e[1]>>1)}M._tags=se,M._bounds=Ue,Ce>=J&&(M.stop(),p.call(null,"end",{cloud:M,words:se,bounds:Ue}))}return M},M.stop=function(){return y&&(clearInterval(y),y=null),M};function I(U){U.width=U.height=1;const Z=Math.sqrt(U.getContext("2d").getImageData(0,0,1,1).data.length>>2);U.width=(a2<<5)/Z,U.height=kT/Z;const Y=U.getContext("2d");return Y.fillStyle=Y.strokeStyle="red",Y.textAlign="center",Y.textBaseline="middle",{context:Y,ratio:Z}}function N(U,Z,Y){const $=Z.x,J=Z.y,se=Math.sqrt(e[0]*e[0]+e[1]*e[1]),pe=u(e),Ce=h()<.5?1:-1;let Ue,Je=-Ce,lt,Ge;for(;(Ue=pe(Je+=Ce))&&(lt=~~Ue[0],Ge=~~Ue[1],!(Math.min(Math.abs(lt),Math.abs(Ge))>=se));)if(Z.x=$+lt,Z.y=J+Ge,!(Z.x+Z.x0<0||Z.y+Z.y0<0||Z.x+Z.x1>e[0]||Z.y+Z.y1>e[1])&&(!Y||!xY(Z,U,e[0]))&&(!Y||SY(Z,Y))){const at=Z.sprite,st=Z.width>>5,ft=e[0]>>5,Vt=Z.x-(st<<4),wt=Vt&127,zt=32-wt,En=Z.y1-Z.y0;let Vn,ar=(Z.y+Z.y0)*ft+(Vt>>5);for(let lr=0;lr<En;lr++){Vn=0;for(let Vr=0;Vr<=st;Vr++)U[ar+Vr]|=Vn<<zt|(Vr<st?(Vn=at[lr*st+Vr])>>>wt:0);ar+=ft}return delete Z.sprite,!0}return!1}return M.createMask=U=>{const Z=document.createElement("canvas"),[Y,$]=e;if(!Y||!$)return;const J=Y>>5,se=tF((Y>>5)*$);Z.width=Y,Z.height=$;const pe=Z.getContext("2d");pe.drawImage(U,0,0,U.width,U.height,0,0,Y,$);const Ce=pe.getImageData(0,0,Y,$).data;for(let Ue=0;Ue<$;Ue++)for(let Je=0;Je<Y;Je++){const lt=J*Ue+(Je>>5),Ge=Ue*Y+Je<<2,st=Ce[Ge]>=250&&Ce[Ge+1]>=250&&Ce[Ge+2]>=250?1<<31-Je%32:0;se[lt]|=st}M.board=se,M.hasImage=!0},M.timeInterval=function(U){b=U==null?1/0:U},M.words=function(U){m=U},M.size=function(U=[]){e=[+U[0],+U[1]]},M.text=function(U){t=Uv(U)},M.font=function(U){n=Uv(U)},M.fontWeight=function(U){i=Uv(U)},M.rotate=function(U){s=Uv(U)},M.canvas=function(U){w=Uv(U)},M.spiral=function(U){u=AY[U]||U},M.fontSize=function(U){r=Uv(U)},M.padding=function(U){l=Uv(U)},M.random=function(U){h=Uv(U)},M.on=function(U){p=Uv(U)},M}var OY=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},RY=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const MY={fontSize:[20,60],font:"Impact",padding:2,rotate:function(){return(~~(Math.random()*6)-3)*30}};function PY(e){return new Promise((t,n)=>{if(e instanceof HTMLImageElement){t(e);return}if(typeof e=="string"){const r=new Image;r.crossOrigin="anonymous",r.src=e,r.onload=()=>t(r),r.onerror=()=>{console.error(`'image ${e} load failed !!!'`),n()};return}n()})}function IY(e,t){if(typeof e=="function")return e;if(Array.isArray(e)){const[n,r]=e;if(!t)return()=>(r+n)/2;const[i,s]=t;return s===i?()=>(r+n)/2:({value:l})=>(r-n)/(s-i)*(l-i)+n}return()=>e}const nF=(e,t)=>n=>OY(void 0,void 0,void 0,function*(){const r=Object.assign({},MY,e,{canvas:t.createCanvas}),i=CY();yield dY(i,r).set("fontSize",U=>{const Z=n.map(Y=>Y.value);return IY(U,[Zp(Z),Sl(Z)])}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").set("canvas").setAsync("imageMask",PY,i.createMask),i.words([...n]);const s=i.start(),[l,u]=r.size,h=[{x:0,y:0},{x:l,y:u}],{_bounds:p=h,_tags:m,hasImage:y}=s,b=m.map(U=>{var{x:Z,y:Y,font:$}=U,J=RY(U,["x","y","font"]);return Object.assign(Object.assign({},J),{x:Z+l/2,y:Y+u/2,fontFamily:$})}),[{x:w,y:R},{x:M,y:I}]=p,N={text:"",value:0,opacity:0,fontSize:0};return b.push(Object.assign(Object.assign({},N),{x:y?0:w,y:y?0:R}),Object.assign(Object.assign({},N),{x:y?l:M,y:y?u:I})),b});nF.props={};function yR(e){const{min:t,max:n}=e;return[[t[0],t[1]],[n[0],n[1]]]}function rF(e,t){const[n,r]=e,[i,s]=t;return n>=i[0]&&n<=s[0]&&r>=i[1]&&r<=s[1]}function LY(e,t){const[n,r]=e;return!(rF(n,t)&&rF(r,t))}function DY(e,t){const[n,r]=e,[i,s]=t;return n[0]<s[0]&&r[0]>i[0]&&n[1]<s[1]&&r[1]>i[1]}const NY=e=>{const{priority:t}=e;return n=>{const r=[];return t&&n.sort(t),n.forEach(i=>{kS(i);const s=i.getLocalBounds();r.some(u=>DY(yR(s),yR(u.getLocalBounds())))?xO(i):r.push(i)}),n}};function BY([e,t],[n,r]){return r>e&&t>n}function zT(){const e=new Map;return[r=>e.get(r),(r,i)=>e.set(r,i)]}function FY(e){const t=e.cloneNode(!0),n=t.getElementById("connector");n&&t.removeChild(n);const{min:r,max:i}=t.getRenderBounds();return t.destroy(),{min:r,max:i}}const kY=e=>{const{maxIterations:t=10,maxError:n=.1,padding:r=1}=e;return i=>{const s=i.length;if(s<=1)return i;const[l,u]=zT(),[h,p]=zT(),[m,y]=zT(),[b,w]=zT();for(const R of i){const{min:M,max:I}=FY(R),[N,U]=M,[Z,Y]=I;u(R,U),p(R,U),y(R,Y-U),w(R,[N,Z])}for(let R=0;R<t;R++){i.sort((I,N)=>Tu(h(I),h(N)));let M=0;for(let I=0;I<s-1;I++){const N=i[I];let U=I+1,Z;for(;(Z=i[U])&&!BY(b(N),b(Z));)U+=1;if(Z){const Y=h(N),$=m(N),J=h(Z),se=J-(Y+$);if(se<r){const pe=(r-se)/2;M=Math.max(M,pe),p(N,Y-pe),p(Z,J+pe)}}}if(M<n)break}for(const R of i)R.style.y+=h(R)-l(R);return i}},zY=()=>e=>(e.forEach(t=>{kS(t);const n=t.attr("bounds"),r=t.getLocalBounds();LY(yR(r),n)&&xO(t)}),e);function UY(e){return typeof e=="object"?e:Kh(e)}function _R(e){let t=e/255;return t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),t}function iF(e,t,n){return .2126*_R(e)+.7152*_R(t)+.0722*_R(n)}function oF(e,t){const{r:n,g:r,b:i}=e,{r:s,g:l,b:u}=t,h=iF(n,r,i),p=iF(s,l,u);return(Math.max(h,p)+.05)/(Math.min(h,p)+.05)}function jY(e,t){const n=A_(t,r=>oF(e,UY(r)));return t[n]}const VY=e=>{const{threshold:t=4.5,palette:n=["#000","#fff"]}=e;return r=>(r.forEach(i=>{const s=i.attr("dependentElement").parsedStyle.fill,l=i.parsedStyle.fill;oF(l,s)<t&&i.attr("fill",jY(s,n))}),r)},HY=(e,t)=>{const[[n,r],[i,s]]=t,[[l,u],[h,p]]=e;let m=0,y=0;return l<n?m=n-l:h>i&&(m=i-h),u<r?y=r-u:p>s&&(y=s-p),[m,y]},ZY=()=>(e,{canvas:t})=>{const{width:n,height:r}=t.getConfig();return e.forEach(i=>{kS(i);const{max:s,min:l}=i.getRenderBounds(),[u,h]=s,[p,m]=l,y=HY([[p,m],[u,h]],[[0,0],[n,r]]);i.style.connector&&i.style.connectorPoints&&(i.style.connectorPoints[0][0]-=y[0],i.style.connectorPoints[0][1]-=y[1]),i.style.x+=y[0],i.style.y+=y[1]}),e};function WY(){return{"data.fetch":kB,"data.inline":zB,"data.sortBy":UB,"data.sort":jB,"data.filter":VB,"data.pick":HB,"data.rename":ZB,"data.fold":WB,"data.slice":GB,"data.custom":XB,"data.map":YB,"data.join":KB,"data.kde":qB,"data.log":QB,"data.wordCloud":nF,"transform.stackY":sB,"transform.binX":hB,"transform.bin":dR,"transform.dodgeX":dB,"transform.jitter":pB,"transform.jitterX":mB,"transform.jitterY":vB,"transform.symmetryY":gB,"transform.diffY":yB,"transform.stackEnter":_B,"transform.normalizeY":bB,"transform.select":BT,"transform.selectX":EB,"transform.selectY":SB,"transform.groupX":TB,"transform.groupY":wB,"transform.groupColor":AB,"transform.group":i2,"transform.sortX":OB,"transform.sortY":RB,"transform.sortColor":MB,"transform.flexX":PB,"transform.pack":IB,"transform.sample":LB,"transform.filter":DB,"coordinate.cartesian":e4,"coordinate.polar":Ry,"coordinate.transpose":QO,"coordinate.theta":t4,"coordinate.parallel":JO,"coordinate.fisheye":n4,"coordinate.radial":Bb,"coordinate.radar":r4,"encode.constant":i4,"encode.field":o4,"encode.transform":a4,"encode.column":s4,"mark.interval":m4,"mark.rect":g4,"mark.line":H4,"mark.point":pL,"mark.text":bL,"mark.cell":EL,"mark.area":ML,"mark.link":y3,"mark.image":ZL,"mark.polygon":$L,"mark.box":JL,"mark.vector":t6,"mark.lineX":o6,"mark.lineY":l6,"mark.connector":h6,"mark.range":m6,"mark.rangeX":y6,"mark.rangeY":x6,"mark.path":A6,"mark.shape":R6,"mark.density":I6,"mark.heatmap":B6,"mark.wordCloud":E3,"palette.category10":F6,"palette.category20":k6,"scale.linear":z6,"scale.ordinal":H6,"scale.band":G6,"scale.identity":X6,"scale.point":Y6,"scale.time":vD,"scale.log":yD,"scale.pow":_D,"scale.sqrt":bD,"scale.threshold":xD,"scale.quantile":ED,"scale.quantize":SD,"scale.sequential":TD,"scale.constant":wD,"theme.classic":AD,"theme.classicDark":OD,"theme.academy":RD,"theme.light":I3,"theme.dark":CD,"component.axisX":MD,"component.axisY":PD,"component.legendCategory":D3,"component.legendContinuous":fp,"component.legends":LD,"component.title":ND,"component.sliderX":zD,"component.sliderY":UD,"component.scrollbarX":jD,"component.scrollbarY":VD,"animation.scaleInX":k3,"animation.scaleOutX":BZ,"animation.scaleInY":HD,"animation.scaleOutY":FZ,"animation.waveIn":ZD,"animation.fadeIn":WD,"animation.fadeOut":GD,"animation.zoomIn":kZ,"animation.zoomOut":zZ,"animation.pathIn":XD,"animation.morphing":qD,"animation.growInX":QD,"animation.growInY":JD,"interaction.elementHighlight":TT,"interaction.elementHighlightByX":eN,"interaction.elementHighlightByColor":tN,"interaction.elementSelect":wT,"interaction.elementSelectByX":nN,"interaction.elementSelectByColor":rN,"interaction.fisheye":tW,"interaction.chartIndex":iN,"interaction.tooltip":_N,"interaction.legendFilter":OW,"interaction.legendHighlight":RW,"interaction.brushHighlight":X3,"interaction.brushXHighlight":NW,"interaction.brushYHighlight":BW,"interaction.brushAxisHighlight":WW,"interaction.brushFilter":q3,"interaction.brushXFilter":$W,"interaction.brushYFilter":KW,"interaction.sliderFilter":IN,"interaction.scrollbarFilter":tG,"interaction.poptip":NN,"interaction.treemapDrillDown":EG,"interaction.elementPointMove":OG,"composition.spaceLayer":KN,"composition.spaceFlex":qN,"composition.facetRect":tB,"composition.repeatMatrix":jG,"composition.facetCircle":XG,"composition.timingKeyframe":rB,"labelTransform.overlapHide":NY,"labelTransform.overlapDodgeY":kY,"labelTransform.overflowHide":zY,"labelTransform.contrastReverse":VY,"labelTransform.exceedAdjust":ZY}}var s2=e=>e;function UT(e,t){e&&sF.hasOwnProperty(e.type)&&sF[e.type](e,t)}var aF={Feature:function(e,t){UT(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)UT(n[r].geometry,t)}},sF={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){bR(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)bR(n[r],t,0)},Polygon:function(e,t){lF(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)lF(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)UT(n[r],t)}};function bR(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function lF(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)bR(e[n],t,1);t.polygonEnd()}function G_(e,t){e&&aF.hasOwnProperty(e.type)?aF[e.type](e,t):UT(e,t)}class jv{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],l=t+s,u=Math.abs(t)<Math.abs(s)?t-(l-s):s-(l-t);u&&(n[r++]=u),t=l}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,l=0;if(n>0){for(l=t[--n];n>0&&(r=l,i=t[--n],l=r+i,s=i-(l-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=l+i,i==r-l&&(l=r))}return l}}function Gte(e,t){const n=new jv;if(t===void 0)for(let r of e)(r=+r)&&n.add(r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&n.add(i)}return+n}function Xte(e,t){const n=new jv;let r=-1;return Float64Array.from(e,t===void 0?i=>n.add(+i||0):i=>n.add(+t(i,++r,e)||0))}var Ka=1e-6,cF=1e-12,$s=Math.PI,tf=$s/2,uF=$s/4,Gp=$s*2,pd=180/$s,wu=$s/180,Il=Math.abs,X_=Math.atan,Vv=Math.atan2,js=Math.cos,jT=Math.ceil,fF=Math.exp,Yte=Math.floor,$te=Math.hypot,VT=Math.log,xR=Math.pow,ws=Math.sin,C0=Math.sign||function(e){return e>0?1:e<0?-1:0},mp=Math.sqrt,ER=Math.tan;function hF(e){return e>1?0:e<-1?$s:Math.acos(e)}function O0(e){return e>1?tf:e<-1?-tf:Math.asin(e)}function Kte(e){return(e=ws(e/2))*e}function R0(){}var SR=new jv,TR=new jv,dF,pF,wR,AR,qg={point:R0,lineStart:R0,lineEnd:R0,polygonStart:function(){qg.lineStart=GY,qg.lineEnd=YY},polygonEnd:function(){qg.lineStart=qg.lineEnd=qg.point=R0,SR.add(Il(TR)),TR=new jv},result:function(){var e=SR/2;return SR=new jv,e}};function GY(){qg.point=XY}function XY(e,t){qg.point=mF,dF=wR=e,pF=AR=t}function mF(e,t){TR.add(AR*e-wR*t),wR=e,AR=t}function YY(){mF(dF,pF)}var vF=qg,Y_=1/0,HT=Y_,l2=-Y_,ZT=l2,$Y={point:KY,lineStart:R0,lineEnd:R0,polygonStart:R0,polygonEnd:R0,result:function(){var e=[[Y_,HT],[l2,ZT]];return l2=ZT=-(HT=Y_=1/0),e}};function KY(e,t){e<Y_&&(Y_=e),e>l2&&(l2=e),t<HT&&(HT=t),t>ZT&&(ZT=t)}var WT=$Y,CR=0,OR=0,c2=0,GT=0,XT=0,$_=0,RR=0,MR=0,u2=0,gF,yF,Km,qm,im={point:x1,lineStart:_F,lineEnd:bF,polygonStart:function(){im.lineStart=JY,im.lineEnd=e$},polygonEnd:function(){im.point=x1,im.lineStart=_F,im.lineEnd=bF},result:function(){var e=u2?[RR/u2,MR/u2]:$_?[GT/$_,XT/$_]:c2?[CR/c2,OR/c2]:[NaN,NaN];return CR=OR=c2=GT=XT=$_=RR=MR=u2=0,e}};function x1(e,t){CR+=e,OR+=t,++c2}function _F(){im.point=qY}function qY(e,t){im.point=QY,x1(Km=e,qm=t)}function QY(e,t){var n=e-Km,r=t-qm,i=mp(n*n+r*r);GT+=i*(Km+e)/2,XT+=i*(qm+t)/2,$_+=i,x1(Km=e,qm=t)}function bF(){im.point=x1}function JY(){im.point=t$}function e$(){xF(gF,yF)}function t$(e,t){im.point=xF,x1(gF=Km=e,yF=qm=t)}function xF(e,t){var n=e-Km,r=t-qm,i=mp(n*n+r*r);GT+=i*(Km+e)/2,XT+=i*(qm+t)/2,$_+=i,i=qm*e-Km*t,RR+=i*(Km+e),MR+=i*(qm+t),u2+=i*3,x1(Km=e,qm=t)}var EF=im;function SF(e){this._context=e}SF.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Gp);break}}},result:R0};var PR=new jv,IR,TF,wF,f2,h2,YT={point:R0,lineStart:function(){YT.point=n$},lineEnd:function(){IR&&AF(TF,wF),YT.point=R0},polygonStart:function(){IR=!0},polygonEnd:function(){IR=null},result:function(){var e=+PR;return PR=new jv,e}};function n$(e,t){YT.point=AF,TF=f2=e,wF=h2=t}function AF(e,t){f2-=e,h2-=t,PR.add(mp(f2*f2+h2*h2)),f2=e,h2=t}var CF=YT;let OF,$T,RF,MF;class PF{constructor(t){this._append=t==null?IF:r$(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==RF||this._append!==$T){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,RF=r,$T=this._append,MF=this._,this._=i}this._+=MF;break}}}result(){const t=this._;return this._="",t.length?t:null}}function IF(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function r$(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return IF;if(t!==OF){const n=vf(10,t);OF=t,$T=function(i){let s=1;this._+=i[0];for(const l=i.length;s<l;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return $T}function LF(e,t){let n=3,r=4.5,i,s;function l(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),G_(u,i(s))),s.result()}return l.area=function(u){return G_(u,i(vF)),vF.result()},l.measure=function(u){return G_(u,i(CF)),CF.result()},l.bounds=function(u){return G_(u,i(WT)),WT.result()},l.centroid=function(u){return G_(u,i(EF)),EF.result()},l.projection=function(u){return arguments.length?(i=u==null?(e=null,s2):(e=u).stream,l):e},l.context=function(u){return arguments.length?(s=u==null?(t=null,new PF(n)):new SF(t=u),typeof r!="function"&&s.pointRadius(r),l):t},l.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),l):r},l.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const h=Math.floor(u);if(!(h>=0))throw new RangeError(`invalid digits: ${u}`);n=h}return t===null&&(s=new PF(n)),l},l.projection(e).digits(n).context(t)}function K_(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function DF(e,t,n){var r=K_(e,t-Ka,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function NF(e,t,n){var r=K_(e,t-Ka,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function i$(){var e,t,n,r,i,s,l,u,h=10,p=h,m=90,y=360,b,w,R,M,I=2.5;function N(){return{type:"MultiLineString",coordinates:U()}}function U(){return K_(jT(r/m)*m,n,m).map(R).concat(K_(jT(u/y)*y,l,y).map(M)).concat(K_(jT(t/h)*h,e,h).filter(function(Z){return Il(Z%m)>Ka}).map(b)).concat(K_(jT(s/p)*p,i,p).filter(function(Z){return Il(Z%y)>Ka}).map(w))}return N.lines=function(){return U().map(function(Z){return{type:"LineString",coordinates:Z}})},N.outline=function(){return{type:"Polygon",coordinates:[R(r).concat(M(l).slice(1),R(n).reverse().slice(1),M(u).reverse().slice(1))]}},N.extent=function(Z){return arguments.length?N.extentMajor(Z).extentMinor(Z):N.extentMinor()},N.extentMajor=function(Z){return arguments.length?(r=+Z[0][0],n=+Z[1][0],u=+Z[0][1],l=+Z[1][1],r>n&&(Z=r,r=n,n=Z),u>l&&(Z=u,u=l,l=Z),N.precision(I)):[[r,u],[n,l]]},N.extentMinor=function(Z){return arguments.length?(t=+Z[0][0],e=+Z[1][0],s=+Z[0][1],i=+Z[1][1],t>e&&(Z=t,t=e,e=Z),s>i&&(Z=s,s=i,i=Z),N.precision(I)):[[t,s],[e,i]]},N.step=function(Z){return arguments.length?N.stepMajor(Z).stepMinor(Z):N.stepMinor()},N.stepMajor=function(Z){return arguments.length?(m=+Z[0],y=+Z[1],N):[m,y]},N.stepMinor=function(Z){return arguments.length?(h=+Z[0],p=+Z[1],N):[h,p]},N.precision=function(Z){return arguments.length?(I=+Z,b=DF(s,i,90),w=NF(t,e,I),R=DF(u,l,90),M=NF(r,n,I),N):I},N.extentMajor([[-180,-90+Ka],[180,90-Ka]]).extentMinor([[-180,-80-Ka],[180,80+Ka]])}function o$(){return i$()()}function BF(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:R0,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function KT(e,t){return Il(e[0]-t[0])<Ka&&Il(e[1]-t[1])<Ka}function qT(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function FF(e,t,n,r,i){var s=[],l=[],u,h;if(e.forEach(function(R){if(!((M=R.length-1)<=0)){var M,I=R[0],N=R[M],U;if(KT(I,N)){if(!I[2]&&!N[2]){for(i.lineStart(),u=0;u<M;++u)i.point((I=R[u])[0],I[1]);i.lineEnd();return}N[0]+=2*Ka}s.push(U=new qT(I,R,null,!0)),l.push(U.o=new qT(I,null,U,!1)),s.push(U=new qT(N,R,null,!1)),l.push(U.o=new qT(N,null,U,!0))}}),!!s.length){for(l.sort(t),kF(s),kF(l),u=0,h=l.length;u<h;++u)l[u].e=n=!n;for(var p=s[0],m,y;;){for(var b=p,w=!0;b.v;)if((b=b.n)===p)return;m=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(w)for(u=0,h=m.length;u<h;++u)i.point((y=m[u])[0],y[1]);else r(b.x,b.n.x,1,i);b=b.n}else{if(w)for(m=b.p.z,u=m.length-1;u>=0;--u)i.point((y=m[u])[0],y[1]);else r(b.x,b.p.x,-1,i);b=b.p}b=b.o,m=b.z,w=!w}while(!b.v);i.lineEnd()}}}function kF(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function LR(e){return[Vv(e[1],e[0]),O0(e[2])]}function q_(e){var t=e[0],n=e[1],r=js(n);return[r*js(t),r*ws(t),ws(n)]}function QT(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function JT(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function DR(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ew(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function NR(e){var t=mp(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function BR(e){return Il(e[0])<=$s?e[0]:C0(e[0])*((Il(e[0])+$s)%Gp-$s)}function a$(e,t){var n=BR(t),r=t[1],i=ws(r),s=[ws(n),-js(n),0],l=0,u=0,h=new jv;i===1?r=tf+Ka:i===-1&&(r=-tf-Ka);for(var p=0,m=e.length;p<m;++p)if(b=(y=e[p]).length)for(var y,b,w=y[b-1],R=BR(w),M=w[1]/2+uF,I=ws(M),N=js(M),U=0;U<b;++U,R=Y,I=J,N=se,w=Z){var Z=y[U],Y=BR(Z),$=Z[1]/2+uF,J=ws($),se=js($),pe=Y-R,Ce=pe>=0?1:-1,Ue=Ce*pe,Je=Ue>$s,lt=I*J;if(h.add(Vv(lt*Ce*ws(Ue),N*se+lt*js(Ue))),l+=Je?pe+Ce*Gp:pe,Je^R>=n^Y>=n){var Ge=JT(q_(w),q_(Z));NR(Ge);var at=JT(s,Ge);NR(at);var st=(Je^pe>=0?-1:1)*O0(at[2]);(r>st||r===st&&(Ge[0]||Ge[1]))&&(u+=Je^pe>=0?1:-1)}}return(l<-Ka||l<Ka&&h<-cF)^u&1}function*s$(e){for(const t of e)yield*Sk(t)}function zF(e){return Array.from(s$(e))}function UF(e,t,n,r){return function(i){var s=t(i),l=BF(),u=t(l),h=!1,p,m,y,b={point:w,lineStart:M,lineEnd:I,polygonStart:function(){b.point=N,b.lineStart=U,b.lineEnd=Z,m=[],p=[]},polygonEnd:function(){b.point=w,b.lineStart=M,b.lineEnd=I,m=zF(m);var Y=a$(p,r);m.length?(h||(i.polygonStart(),h=!0),FF(m,c$,Y,n,i)):Y&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),m=p=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function w(Y,$){e(Y,$)&&i.point(Y,$)}function R(Y,$){s.point(Y,$)}function M(){b.point=R,s.lineStart()}function I(){b.point=w,s.lineEnd()}function N(Y,$){y.push([Y,$]),u.point(Y,$)}function U(){u.lineStart(),y=[]}function Z(){N(y[0][0],y[0][1]),u.lineEnd();var Y=u.clean(),$=l.result(),J,se=$.length,pe,Ce,Ue;if(y.pop(),p.push(y),y=null,!!se){if(Y&1){if(Ce=$[0],(pe=Ce.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),J=0;J<pe;++J)i.point((Ue=Ce[J])[0],Ue[1]);i.lineEnd()}return}se>1&&Y&2&&$.push($.pop().concat($.shift())),m.push($.filter(l$))}}return b}}function l$(e){return e.length>1}function c$(e,t){return((e=e.x)[0]<0?e[1]-tf-Ka:tf-e[1])-((t=t.x)[0]<0?t[1]-tf-Ka:tf-t[1])}var jF=UF(function(){return!0},u$,h$,[-$s,-tf]);function u$(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,l){var u=s>0?$s:-$s,h=Il(s-t);Il(h-$s)<Ka?(e.point(t,n=(n+l)/2>0?tf:-tf),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&h>=$s&&(Il(t-r)<Ka&&(t-=r*Ka),Il(s-u)<Ka&&(s-=u*Ka),n=f$(t,n,s,l),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=l),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function f$(e,t,n,r){var i,s,l=ws(e-n);return Il(l)>Ka?X_((ws(t)*(s=js(r))*ws(n)-ws(r)*(i=js(t))*ws(e))/(i*s*l)):(t+r)/2}function h$(e,t,n,r){var i;if(e==null)i=n*tf,r.point(-$s,i),r.point(0,i),r.point($s,i),r.point($s,0),r.point($s,-i),r.point(0,-i),r.point(-$s,-i),r.point(-$s,0),r.point(-$s,i);else if(Il(e[0]-t[0])>Ka){var s=e[0]<t[0]?$s:-$s;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function VF(e,t,n,r,i,s){if(n){var l=js(t),u=ws(t),h=r*n;i==null?(i=t+r*Gp,s=t-h/2):(i=HF(l,i),s=HF(l,s),(r>0?i<s:i>s)&&(i+=r*Gp));for(var p,m=i;r>0?m>s:m<s;m-=h)p=LR([l,-u*js(m),-u*ws(m)]),e.point(p[0],p[1])}}function HF(e,t){t=q_(t),t[0]-=e,NR(t);var n=hF(-t[1]);return((-t[2]<0?-n:n)+Gp-Ka)%Gp}function qte(){var e=constant([0,0]),t=constant(90),n=constant(2),r,i,s={point:l};function l(h,p){r.push(h=i(h,p)),h[0]*=degrees,h[1]*=degrees}function u(){var h=e.apply(this,arguments),p=t.apply(this,arguments)*radians,m=n.apply(this,arguments)*radians;return r=[],i=rotateRadians(-h[0]*radians,-h[1]*radians,0).invert,VF(s,p,m,1),h={type:"Polygon",coordinates:[r]},r=i=null,h}return u.center=function(h){return arguments.length?(e=typeof h=="function"?h:constant([+h[0],+h[1]]),u):e},u.radius=function(h){return arguments.length?(t=typeof h=="function"?h:constant(+h),u):t},u.precision=function(h){return arguments.length?(n=typeof h=="function"?h:constant(+h),u):n},u}function d$(e){var t=js(e),n=2*wu,r=t>0,i=Il(t)>Ka;function s(m,y,b,w){VF(w,e,n,b,m,y)}function l(m,y){return js(m)*js(y)>t}function u(m){var y,b,w,R,M;return{lineStart:function(){R=w=!1,M=1},point:function(I,N){var U=[I,N],Z,Y=l(I,N),$=r?Y?0:p(I,N):Y?p(I+(I<0?$s:-$s),N):0;if(!y&&(R=w=Y)&&m.lineStart(),Y!==w&&(Z=h(y,U),(!Z||KT(y,Z)||KT(U,Z))&&(U[2]=1)),Y!==w)M=0,Y?(m.lineStart(),Z=h(U,y),m.point(Z[0],Z[1])):(Z=h(y,U),m.point(Z[0],Z[1],2),m.lineEnd()),y=Z;else if(i&&y&&r^Y){var J;!($&b)&&(J=h(U,y,!0))&&(M=0,r?(m.lineStart(),m.point(J[0][0],J[0][1]),m.point(J[1][0],J[1][1]),m.lineEnd()):(m.point(J[1][0],J[1][1]),m.lineEnd(),m.lineStart(),m.point(J[0][0],J[0][1],3)))}Y&&(!y||!KT(y,U))&&m.point(U[0],U[1]),y=U,w=Y,b=$},lineEnd:function(){w&&m.lineEnd(),y=null},clean:function(){return M|(R&&w)<<1}}}function h(m,y,b){var w=q_(m),R=q_(y),M=[1,0,0],I=JT(w,R),N=QT(I,I),U=I[0],Z=N-U*U;if(!Z)return!b&&m;var Y=t*N/Z,$=-t*U/Z,J=JT(M,I),se=ew(M,Y),pe=ew(I,$);DR(se,pe);var Ce=J,Ue=QT(se,Ce),Je=QT(Ce,Ce),lt=Ue*Ue-Je*(QT(se,se)-1);if(!(lt<0)){var Ge=mp(lt),at=ew(Ce,(-Ue-Ge)/Je);if(DR(at,se),at=LR(at),!b)return at;var st=m[0],ft=y[0],Vt=m[1],wt=y[1],zt;ft<st&&(zt=st,st=ft,ft=zt);var En=ft-st,Vn=Il(En-$s)<Ka,ar=Vn||En<Ka;if(!Vn&&wt<Vt&&(zt=Vt,Vt=wt,wt=zt),ar?Vn?Vt+wt>0^at[1]<(Il(at[0]-st)<Ka?Vt:wt):Vt<=at[1]&&at[1]<=wt:En>$s^(st<=at[0]&&at[0]<=ft)){var lr=ew(Ce,(-Ue+Ge)/Je);return DR(lr,se),[at,LR(lr)]}}}function p(m,y){var b=r?e:$s-e,w=0;return m<-b?w|=1:m>b&&(w|=2),y<-b?w|=4:y>b&&(w|=8),w}return UF(l,u,s,r?[0,-e]:[-$s,e-$s])}function p$(e,t,n,r,i,s){var l=e[0],u=e[1],h=t[0],p=t[1],m=0,y=1,b=h-l,w=p-u,R;if(R=n-l,!(!b&&R>0)){if(R/=b,b<0){if(R<m)return;R<y&&(y=R)}else if(b>0){if(R>y)return;R>m&&(m=R)}if(R=i-l,!(!b&&R<0)){if(R/=b,b<0){if(R>y)return;R>m&&(m=R)}else if(b>0){if(R<m)return;R<y&&(y=R)}if(R=r-u,!(!w&&R>0)){if(R/=w,w<0){if(R<m)return;R<y&&(y=R)}else if(w>0){if(R>y)return;R>m&&(m=R)}if(R=s-u,!(!w&&R<0)){if(R/=w,w<0){if(R>y)return;R>m&&(m=R)}else if(w>0){if(R<m)return;R<y&&(y=R)}return m>0&&(e[0]=l+m*b,e[1]=u+m*w),y<1&&(t[0]=l+y*b,t[1]=u+y*w),!0}}}}}var d2=1e9,tw=-d2;function ZF(e,t,n,r){function i(p,m){return e<=p&&p<=n&&t<=m&&m<=r}function s(p,m,y,b){var w=0,R=0;if(p==null||(w=l(p,y))!==(R=l(m,y))||h(p,m)<0^y>0)do b.point(w===0||w===3?e:n,w>1?r:t);while((w=(w+y+4)%4)!==R);else b.point(m[0],m[1])}function l(p,m){return Il(p[0]-e)<Ka?m>0?0:3:Il(p[0]-n)<Ka?m>0?2:1:Il(p[1]-t)<Ka?m>0?1:0:m>0?3:2}function u(p,m){return h(p.x,m.x)}function h(p,m){var y=l(p,1),b=l(m,1);return y!==b?y-b:y===0?m[1]-p[1]:y===1?p[0]-m[0]:y===2?p[1]-m[1]:m[0]-p[0]}return function(p){var m=p,y=BF(),b,w,R,M,I,N,U,Z,Y,$,J,se={point:pe,lineStart:lt,lineEnd:Ge,polygonStart:Ue,polygonEnd:Je};function pe(st,ft){i(st,ft)&&m.point(st,ft)}function Ce(){for(var st=0,ft=0,Vt=w.length;ft<Vt;++ft)for(var wt=w[ft],zt=1,En=wt.length,Vn=wt[0],ar,lr,Vr=Vn[0],ui=Vn[1];zt<En;++zt)ar=Vr,lr=ui,Vn=wt[zt],Vr=Vn[0],ui=Vn[1],lr<=r?ui>r&&(Vr-ar)*(r-lr)>(ui-lr)*(e-ar)&&++st:ui<=r&&(Vr-ar)*(r-lr)<(ui-lr)*(e-ar)&&--st;return st}function Ue(){m=y,b=[],w=[],J=!0}function Je(){var st=Ce(),ft=J&&st,Vt=(b=zF(b)).length;(ft||Vt)&&(p.polygonStart(),ft&&(p.lineStart(),s(null,null,1,p),p.lineEnd()),Vt&&FF(b,u,st,s,p),p.polygonEnd()),m=p,b=w=R=null}function lt(){se.point=at,w&&w.push(R=[]),$=!0,Y=!1,U=Z=NaN}function Ge(){b&&(at(M,I),N&&Y&&y.rejoin(),b.push(y.result())),se.point=pe,Y&&m.lineEnd()}function at(st,ft){var Vt=i(st,ft);if(w&&R.push([st,ft]),$)M=st,I=ft,N=Vt,$=!1,Vt&&(m.lineStart(),m.point(st,ft));else if(Vt&&Y)m.point(st,ft);else{var wt=[U=Math.max(tw,Math.min(d2,U)),Z=Math.max(tw,Math.min(d2,Z))],zt=[st=Math.max(tw,Math.min(d2,st)),ft=Math.max(tw,Math.min(d2,ft))];p$(wt,zt,e,t,n,r)?(Y||(m.lineStart(),m.point(wt[0],wt[1])),m.point(zt[0],zt[1]),Vt||m.lineEnd(),J=!1):Vt&&(m.lineStart(),m.point(st,ft),J=!1)}U=st,Z=ft,Y=Vt}return se}}function FR(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function kR(e,t){return Il(e)>$s&&(e-=Math.round(e/Gp)*Gp),[e,t]}kR.invert=kR;function WF(e,t,n){return(e%=Gp)?t||n?FR(XF(e),YF(t,n)):XF(e):t||n?YF(t,n):kR}function GF(e){return function(t,n){return t+=e,Il(t)>$s&&(t-=Math.round(t/Gp)*Gp),[t,n]}}function XF(e){var t=GF(e);return t.invert=GF(-e),t}function YF(e,t){var n=js(e),r=ws(e),i=js(t),s=ws(t);function l(u,h){var p=js(h),m=js(u)*p,y=ws(u)*p,b=ws(h),w=b*n+m*r;return[Vv(y*i-w*s,m*n-b*r),O0(w*i+y*s)]}return l.invert=function(u,h){var p=js(h),m=js(u)*p,y=ws(u)*p,b=ws(h),w=b*i-y*s;return[Vv(y*i+b*s,m*n+w*r),O0(w*n-m*r)]},l}function m$(e){e=WF(e[0]*wu,e[1]*wu,e.length>2?e[2]*wu:0);function t(n){return n=e(n[0]*wu,n[1]*wu),n[0]*=pd,n[1]*=pd,n}return t.invert=function(n){return n=e.invert(n[0]*wu,n[1]*wu),n[0]*=pd,n[1]*=pd,n},t}function Qte(e){return{stream:p2(e)}}function p2(e){return function(t){var n=new zR;for(var r in e)n[r]=e[r];return n.stream=t,n}}function zR(){}zR.prototype={constructor:zR,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function UR(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),G_(n,e.stream(WT)),t(WT.result()),r!=null&&e.clipExtent(r),e}function nw(e,t,n){return UR(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],l=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-l*(r[1][0]+r[0][0]))/2,h=+t[0][1]+(s-l*(r[1][1]+r[0][1]))/2;e.scale(150*l).translate([u,h])},n)}function jR(e,t,n){return nw(e,[[0,0],t],n)}function VR(e,t,n){return UR(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),l=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([l,u])},n)}function HR(e,t,n){return UR(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),l=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([l,u])},n)}var $F=16,v$=js(30*wu);function KF(e,t){return+t?y$(e,t):g$(e)}function g$(e){return p2({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function y$(e,t){function n(r,i,s,l,u,h,p,m,y,b,w,R,M,I){var N=p-r,U=m-i,Z=N*N+U*U;if(Z>4*t&&M--){var Y=l+b,$=u+w,J=h+R,se=mp(Y*Y+$*$+J*J),pe=O0(J/=se),Ce=Il(Il(J)-1)<Ka||Il(s-y)<Ka?(s+y)/2:Vv($,Y),Ue=e(Ce,pe),Je=Ue[0],lt=Ue[1],Ge=Je-r,at=lt-i,st=U*Ge-N*at;(st*st/Z>t||Il((N*Ge+U*at)/Z-.5)>.3||l*b+u*w+h*R<v$)&&(n(r,i,s,l,u,h,Je,lt,Ce,Y/=se,$/=se,J,M,I),I.point(Je,lt),n(Je,lt,Ce,Y,$,J,p,m,y,b,w,R,M,I))}}return function(r){var i,s,l,u,h,p,m,y,b,w,R,M,I={point:N,lineStart:U,lineEnd:Y,polygonStart:function(){r.polygonStart(),I.lineStart=$},polygonEnd:function(){r.polygonEnd(),I.lineStart=U}};function N(pe,Ce){pe=e(pe,Ce),r.point(pe[0],pe[1])}function U(){y=NaN,I.point=Z,r.lineStart()}function Z(pe,Ce){var Ue=q_([pe,Ce]),Je=e(pe,Ce);n(y,b,m,w,R,M,y=Je[0],b=Je[1],m=pe,w=Ue[0],R=Ue[1],M=Ue[2],$F,r),r.point(y,b)}function Y(){I.point=N,r.lineEnd()}function $(){U(),I.point=J,I.lineEnd=se}function J(pe,Ce){Z(i=pe,Ce),s=y,l=b,u=w,h=R,p=M,I.point=Z}function se(){n(y,b,m,w,R,M,s,l,i,u,h,p,$F,r),I.lineEnd=Y,Y()}return I}}var _$=p2({point:function(e,t){this.stream.point(e*wu,t*wu)}});function b$(e){return p2({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function x$(e,t,n,r,i){function s(l,u){return l*=r,u*=i,[t+e*l,n-e*u]}return s.invert=function(l,u){return[(l-t)/e*r,(n-u)/e*i]},s}function qF(e,t,n,r,i,s){if(!s)return x$(e,t,n,r,i);var l=js(s),u=ws(s),h=l*e,p=u*e,m=l/e,y=u/e,b=(u*n-l*t)/e,w=(u*t+l*n)/e;function R(M,I){return M*=r,I*=i,[h*M-p*I+t,n-p*M-h*I]}return R.invert=function(M,I){return[r*(m*M-y*I+b),i*(w-y*M-m*I)]},R}function Qm(e){return ZR(function(){return e})()}function ZR(e){var t,n=150,r=480,i=250,s=0,l=0,u=0,h=0,p=0,m,y=0,b=1,w=1,R=null,M=jF,I=null,N,U,Z,Y=s2,$=.5,J,se,pe,Ce,Ue;function Je(st){return pe(st[0]*wu,st[1]*wu)}function lt(st){return st=pe.invert(st[0],st[1]),st&&[st[0]*pd,st[1]*pd]}Je.stream=function(st){return Ce&&Ue===st?Ce:Ce=_$(b$(m)(M(J(Y(Ue=st)))))},Je.preclip=function(st){return arguments.length?(M=st,R=void 0,at()):M},Je.postclip=function(st){return arguments.length?(Y=st,I=N=U=Z=null,at()):Y},Je.clipAngle=function(st){return arguments.length?(M=+st?d$(R=st*wu):(R=null,jF),at()):R*pd},Je.clipExtent=function(st){return arguments.length?(Y=st==null?(I=N=U=Z=null,s2):ZF(I=+st[0][0],N=+st[0][1],U=+st[1][0],Z=+st[1][1]),at()):I==null?null:[[I,N],[U,Z]]},Je.scale=function(st){return arguments.length?(n=+st,Ge()):n},Je.translate=function(st){return arguments.length?(r=+st[0],i=+st[1],Ge()):[r,i]},Je.center=function(st){return arguments.length?(s=st[0]%360*wu,l=st[1]%360*wu,Ge()):[s*pd,l*pd]},Je.rotate=function(st){return arguments.length?(u=st[0]%360*wu,h=st[1]%360*wu,p=st.length>2?st[2]%360*wu:0,Ge()):[u*pd,h*pd,p*pd]},Je.angle=function(st){return arguments.length?(y=st%360*wu,Ge()):y*pd},Je.reflectX=function(st){return arguments.length?(b=st?-1:1,Ge()):b<0},Je.reflectY=function(st){return arguments.length?(w=st?-1:1,Ge()):w<0},Je.precision=function(st){return arguments.length?(J=KF(se,$=st*st),at()):mp($)},Je.fitExtent=function(st,ft){return nw(Je,st,ft)},Je.fitSize=function(st,ft){return jR(Je,st,ft)},Je.fitWidth=function(st,ft){return VR(Je,st,ft)},Je.fitHeight=function(st,ft){return HR(Je,st,ft)};function Ge(){var st=qF(n,0,0,b,w,y).apply(null,t(s,l)),ft=qF(n,r-st[0],i-st[1],b,w,y);return m=WF(u,h,p),se=FR(t,ft),pe=FR(m,se),J=KF(se,$),at()}function at(){return Ce=Ue=null,Je}return function(){return t=e.apply(this,arguments),Je.invert=t.invert&&lt,Ge()}}function WR(e){var t=0,n=$s/3,r=ZR(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*wu,n=s[1]*wu):[t*pd,n*pd]},i}function E$(e){var t=js(e);function n(r,i){return[r*t,ws(i)/t]}return n.invert=function(r,i){return[r/t,O0(i*t)]},n}function QF(e,t){var n=ws(e),r=(n+ws(t))/2;if(Il(r)<Ka)return E$(e);var i=1+n*(2*r-n),s=mp(i)/r;function l(u,h){var p=mp(i-2*r*ws(h))/r;return[p*ws(u*=r),s-p*js(u)]}return l.invert=function(u,h){var p=s-h,m=Vv(u,Il(p))*C0(p);return p*r<0&&(m-=$s*C0(u)*C0(p)),[m/r,O0((i-(u*u+p*p)*r*r)/(2*r))]},l}function rw(){return WR(QF).scale(155.424).center([0,33.6442])}function JF(){return rw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function S$(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function T$(){var e,t,n=JF(),r,i=rw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,l=rw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,h,p={point:function(b,w){h=[b,w]}};function m(b){var w=b[0],R=b[1];return h=null,r.point(w,R),h||(s.point(w,R),h)||(u.point(w,R),h)}m.invert=function(b){var w=n.scale(),R=n.translate(),M=(b[0]-R[0])/w,I=(b[1]-R[1])/w;return(I>=.12&&I<.234&&M>=-.425&&M<-.214?i:I>=.166&&I<.234&&M>=-.214&&M<-.115?l:n).invert(b)},m.stream=function(b){return e&&t===b?e:e=S$([n.stream(t=b),i.stream(b),l.stream(b)])},m.precision=function(b){return arguments.length?(n.precision(b),i.precision(b),l.precision(b),y()):n.precision()},m.scale=function(b){return arguments.length?(n.scale(b),i.scale(b*.35),l.scale(b),m.translate(n.translate())):n.scale()},m.translate=function(b){if(!arguments.length)return n.translate();var w=n.scale(),R=+b[0],M=+b[1];return r=n.translate(b).clipExtent([[R-.455*w,M-.238*w],[R+.455*w,M+.238*w]]).stream(p),s=i.translate([R-.307*w,M+.201*w]).clipExtent([[R-.425*w+Ka,M+.12*w+Ka],[R-.214*w-Ka,M+.234*w-Ka]]).stream(p),u=l.translate([R-.205*w,M+.212*w]).clipExtent([[R-.214*w+Ka,M+.166*w+Ka],[R-.115*w-Ka,M+.234*w-Ka]]).stream(p),y()},m.fitExtent=function(b,w){return nw(m,b,w)},m.fitSize=function(b,w){return jR(m,b,w)},m.fitWidth=function(b,w){return VR(m,b,w)},m.fitHeight=function(b,w){return HR(m,b,w)};function y(){return e=t=null,m}return m.scale(1070)}function e8(e){return function(t,n){var r=js(t),i=js(n),s=e(r*i);return s===1/0?[2,0]:[s*i*ws(t),s*ws(n)]}}function m2(e){return function(t,n){var r=mp(t*t+n*n),i=e(r),s=ws(i),l=js(i);return[Vv(t*s,r*l),O0(r&&n*s/r)]}}var GR=e8(function(e){return mp(2/(1+e))});GR.invert=m2(function(e){return 2*O0(e/2)});function w$(){return Qm(GR).scale(124.75).clipAngle(180-.001)}var XR=e8(function(e){return(e=hF(e))&&e/ws(e)});XR.invert=m2(function(e){return e});function A$(){return Qm(XR).scale(79.4188).clipAngle(180-.001)}function v2(e,t){return[e,VT(ER((tf+t)/2))]}v2.invert=function(e,t){return[e,2*X_(fF(t))-tf]};function C$(){return t8(v2).scale(961/Gp)}function t8(e){var t=Qm(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,l=null,u,h,p;t.scale=function(y){return arguments.length?(r(y),m()):r()},t.translate=function(y){return arguments.length?(i(y),m()):i()},t.center=function(y){return arguments.length?(n(y),m()):n()},t.clipExtent=function(y){return arguments.length?(y==null?l=u=h=p=null:(l=+y[0][0],u=+y[0][1],h=+y[1][0],p=+y[1][1]),m()):l==null?null:[[l,u],[h,p]]};function m(){var y=$s*r(),b=t(m$(t.rotate()).invert([0,0]));return s(l==null?[[b[0]-y,b[1]-y],[b[0]+y,b[1]+y]]:e===v2?[[Math.max(b[0]-y,l),u],[Math.min(b[0]+y,h),p]]:[[l,Math.max(b[1]-y,u)],[h,Math.min(b[1]+y,p)]])}return m()}function iw(e){return ER((tf+e)/2)}function n8(e,t){var n=js(e),r=e===t?ws(e):VT(n/js(t))/VT(iw(t)/iw(e)),i=n*xR(iw(e),r)/r;if(!r)return v2;function s(l,u){i>0?u<-tf+Ka&&(u=-tf+Ka):u>tf-Ka&&(u=tf-Ka);var h=i/xR(iw(u),r);return[h*ws(r*l),i-h*js(r*l)]}return s.invert=function(l,u){var h=i-u,p=C0(r)*mp(l*l+h*h),m=Vv(l,Il(h))*C0(h);return h*r<0&&(m-=$s*C0(l)*C0(h)),[m/r,2*X_(xR(i/p,1/r))-tf]},s}function O$(){return WR(n8).scale(109.5).parallels([30,30])}function g2(e,t){return[e,t]}g2.invert=g2;function R$(){return Qm(g2).scale(152.63)}function r8(e,t){var n=js(e),r=e===t?ws(e):(n-js(t))/(t-e),i=n/r+e;if(Il(r)<Ka)return g2;function s(l,u){var h=i-u,p=r*l;return[h*ws(p),i-h*js(p)]}return s.invert=function(l,u){var h=i-u,p=Vv(l,Il(h))*C0(h);return h*r<0&&(p-=$s*C0(l)*C0(h)),[p/r,i-C0(r)*mp(l*l+h*h)]},s}function M$(){return WR(r8).scale(131.154).center([0,13.9389])}var y2=1.340264,_2=-.081106,b2=893e-6,x2=.003796,ow=mp(3)/2,P$=12;function YR(e,t){var n=O0(ow*ws(t)),r=n*n,i=r*r*r;return[e*js(n)/(ow*(y2+3*_2*r+i*(7*b2+9*x2*r))),n*(y2+_2*r+i*(b2+x2*r))]}YR.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,l,u,h;s<P$&&(u=n*(y2+_2*r+i*(b2+x2*r))-t,h=y2+3*_2*r+i*(7*b2+9*x2*r),n-=l=u/h,r=n*n,i=r*r*r,!(Il(l)<cF));++s);return[ow*e*(y2+3*_2*r+i*(7*b2+9*x2*r))/js(n),O0(ws(n)/ow)]};function I$(){return Qm(YR).scale(177.158)}function $R(e,t){var n=js(t),r=js(e)*n;return[n*ws(e)/r,ws(t)/r]}$R.invert=m2(X_);function L$(){return Qm($R).scale(144.049).clipAngle(60)}function D$(){var e=1,t=0,n=0,r=1,i=1,s=0,l,u,h=null,p,m,y,b=1,w=1,R=p2({point:function(Y,$){var J=Z([Y,$]);this.stream.point(J[0],J[1])}}),M=s2,I,N;function U(){return b=e*r,w=e*i,I=N=null,Z}function Z(Y){var $=Y[0]*b,J=Y[1]*w;if(s){var se=J*l-$*u;$=$*l+J*u,J=se}return[$+t,J+n]}return Z.invert=function(Y){var $=Y[0]-t,J=Y[1]-n;if(s){var se=J*l+$*u;$=$*l-J*u,J=se}return[$/b,J/w]},Z.stream=function(Y){return I&&N===Y?I:I=R(M(N=Y))},Z.postclip=function(Y){return arguments.length?(M=Y,h=p=m=y=null,U()):M},Z.clipExtent=function(Y){return arguments.length?(M=Y==null?(h=p=m=y=null,s2):ZF(h=+Y[0][0],p=+Y[0][1],m=+Y[1][0],y=+Y[1][1]),U()):h==null?null:[[h,p],[m,y]]},Z.scale=function(Y){return arguments.length?(e=+Y,U()):e},Z.translate=function(Y){return arguments.length?(t=+Y[0],n=+Y[1],U()):[t,n]},Z.angle=function(Y){return arguments.length?(s=Y%360*wu,u=ws(s),l=js(s),U()):s*pd},Z.reflectX=function(Y){return arguments.length?(r=Y?-1:1,U()):r<0},Z.reflectY=function(Y){return arguments.length?(i=Y?-1:1,U()):i<0},Z.fitExtent=function(Y,$){return nw(Z,Y,$)},Z.fitSize=function(Y,$){return jR(Z,Y,$)},Z.fitWidth=function(Y,$){return VR(Z,Y,$)},Z.fitHeight=function(Y,$){return HR(Z,Y,$)},Z}function KR(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}KR.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,l=s*s;n-=i=(n*(1.007226+s*(.015085+l*(-.044475+.028874*s-.005916*l)))-t)/(1.007226+s*(.015085*3+l*(-.044475*7+.028874*9*s-.005916*11*l)))}while(Il(i)>Ka&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function N$(){return Qm(KR).scale(175.295)}function qR(e,t){return[js(t)*ws(e),ws(t)]}qR.invert=m2(O0);function B$(){return Qm(qR).scale(249.5).clipAngle(90+Ka)}function QR(e,t){var n=js(t),r=1+js(e)*n;return[n*ws(e)/r,ws(t)/r]}QR.invert=m2(function(e){return 2*X_(e)});function F$(){return Qm(QR).scale(250).clipAngle(142)}function JR(e,t){return[VT(ER((tf+t)/2)),-e]}JR.invert=function(e,t){return[-t,2*X_(fF(e))-tf]};function k$(){var e=t8(JR),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var z$=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function U$(e){if(typeof e=="function")return e;const t=`geo${Sv(e)}`,n=E[t];if(!n)throw new Error(`Unknown coordinate: ${e}`);return n}function j$(e){return{type:"FeatureCollection",features:e.flatMap(t=>V$(t).features)}}function V$(e){const t={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!e||!e.type)return null;const n=t[e.type];if(!n)return null;if(n==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(n==="feature")return{type:"FeatureCollection",features:[e]};if(n==="featureCollection")return e}function H$(e,t){var n;for(const[r,i]of Object.entries(t))(n=e[r])===null||n===void 0||n.call(e,i)}function Z$(e,t,n,r){const i=()=>{const u=t.filter(i8);return u.find(p=>p.sphere)?{type:"Sphere"}:j$(u.filter(p=>!p.sphere).flatMap(p=>p.data.value))},{outline:s=i()}=r,{size:l="fitExtent"}=r;if(l==="fitExtent")return W$(e,s,n);if(l==="fitWidth")return G$(e,s,n)}function W$(e,t,n){const{x:r,y:i,width:s,height:l}=n;e.fitExtent([[r,i],[s,l]],t)}function G$(e,t,n){const{width:r,height:i}=n,[[s,l],[u,h]]=LF(e.fitWidth(r,t)).bounds(t),p=Math.ceil(h-l),m=Math.min(Math.ceil(u-s),p),y=e.scale()*(m-1)/m,[b,w]=e.translate(),R=w+(i-p)/2;e.scale(y).translate([b,R]).precision(.2)}function X$(e){const{data:t}=e;if(Array.isArray(t))return Object.assign(Object.assign({},e),{data:{value:t}});const{type:n}=t;return n==="graticule10"?Object.assign(Object.assign({},e),{data:{value:[o$()]}}):n==="sphere"?Object.assign(Object.assign({},e),{sphere:!0,data:{value:[{type:"Sphere"}]}}):e}function i8(e){return e.type==="geoPath"}const o8=()=>e=>{const{children:t,coordinate:n={}}=e;if(!Array.isArray(t))return[];const{type:r="equalEarth"}=n,i=z$(n,["type"]),s=U$(r),l=t.map(X$);let u;function h(){return[["custom",(y,b,w,R)=>{const M=s();Z$(M,l,{x:y,y:b,width:w,height:R},i),H$(M,i),u=LF(M);const N=new hh({domain:[y,y+w]}),U=new hh({domain:[b,b+R]}),Z=$=>{const J=M($);if(!J)return[null,null];const[se,pe]=J;return[N.map(se),U.map(pe)]},Y=$=>{if(!$)return null;const[J,se]=$,pe=[N.invert(J),U.invert(se)];return M.invert(pe)};return{transform:$=>Z($),untransform:$=>Y($)}}]]}function p(y){const{style:b,tooltip:w={}}=y;return Object.assign(Object.assign({},y),{type:"path",tooltip:eT(w,{title:"id",items:[{channel:"color"}]}),style:Object.assign(Object.assign({},b),{d:R=>u(R)||[]})})}const m=y=>i8(y)?p(y):y;return[Object.assign(Object.assign({},e),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinate:{type:h},children:l.flatMap(m)})]};o8.props={};var Y$=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const a8=()=>e=>{const{type:t,data:n,scale:r,encode:i,style:s,animate:l,key:u,state:h}=e,p=Y$(e,["type","data","scale","encode","style","animate","key","state"]);return[Object.assign(Object.assign({type:"geoView"},p),{children:[{type:"geoPath",key:`${u}-0`,data:{value:n},scale:r,encode:i,style:s,animate:l,state:h}]})]};a8.props={};function $$(){return{"composition.geoView":o8,"composition.geoPath":a8}}function K$(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return s8(this.cover(t,n),t,n,e)}function s8(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,l={data:r},u=e._x0,h=e._y0,p=e._x1,m=e._y1,y,b,w,R,M,I,N,U;if(!s)return e._root=l,e;for(;s.length;)if((M=t>=(y=(u+p)/2))?u=y:p=y,(I=n>=(b=(h+m)/2))?h=b:m=b,i=s,!(s=s[N=I<<1|M]))return i[N]=l,e;if(w=+e._x.call(null,s.data),R=+e._y.call(null,s.data),t===w&&n===R)return l.next=s,i?i[N]=l:e._root=l,e;do i=i?i[N]=new Array(4):e._root=new Array(4),(M=t>=(y=(u+p)/2))?u=y:p=y,(I=n>=(b=(h+m)/2))?h=b:m=b;while((N=I<<1|M)===(U=(R>=b)<<1|w>=y));return i[U]=s,i[N]=l,e}function q$(e){var t,n,r=e.length,i,s,l=new Array(r),u=new Array(r),h=1/0,p=1/0,m=-1/0,y=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(l[n]=i,u[n]=s,i<h&&(h=i),i>m&&(m=i),s<p&&(p=s),s>y&&(y=s));if(h>m||p>y)return this;for(this.cover(h,p).cover(m,y),n=0;n<r;++n)s8(this,l[n],u[n],e[n]);return this}function Q$(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var l=i-n||1,u=this._root,h,p;n>e||e>=i||r>t||t>=s;)switch(p=(t<r)<<1|e<n,h=new Array(4),h[p]=u,u=h,l*=2,p){case 0:i=n+l,s=r+l;break;case 1:n=i-l,s=r+l;break;case 2:i=n+l,r=s-l;break;case 3:n=i-l,r=s-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function J$(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function eK(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Bd(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function tK(e,t,n){var r,i=this._x0,s=this._y0,l,u,h,p,m=this._x1,y=this._y1,b=[],w=this._root,R,M;for(w&&b.push(new Bd(w,i,s,m,y)),n==null?n=1/0:(i=e-n,s=t-n,m=e+n,y=t+n,n*=n);R=b.pop();)if(!(!(w=R.node)||(l=R.x0)>m||(u=R.y0)>y||(h=R.x1)<i||(p=R.y1)<s))if(w.length){var I=(l+h)/2,N=(u+p)/2;b.push(new Bd(w[3],I,N,h,p),new Bd(w[2],l,N,I,p),new Bd(w[1],I,u,h,N),new Bd(w[0],l,u,I,N)),(M=(t>=N)<<1|e>=I)&&(R=b[b.length-1],b[b.length-1]=b[b.length-1-M],b[b.length-1-M]=R)}else{var U=e-+this._x.call(null,w.data),Z=t-+this._y.call(null,w.data),Y=U*U+Z*Z;if(Y<n){var $=Math.sqrt(n=Y);i=e-$,s=t-$,m=e+$,y=t+$,r=w.data}}return r}function nK(e){if(isNaN(m=+this._x.call(null,e))||isNaN(y=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,l=this._x0,u=this._y0,h=this._x1,p=this._y1,m,y,b,w,R,M,I,N;if(!n)return this;if(n.length)for(;;){if((R=m>=(b=(l+h)/2))?l=b:h=b,(M=y>=(w=(u+p)/2))?u=w:p=w,t=n,!(n=n[I=M<<1|R]))return this;if(!n.length)break;(t[I+1&3]||t[I+2&3]||t[I+3&3])&&(r=t,N=I)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[I]=s:delete t[I],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[N]=n:this._root=n),this):(this._root=s,this)}function rK(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function iK(){return this._root}function oK(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function aK(e){var t=[],n,r=this._root,i,s,l,u,h;for(r&&t.push(new Bd(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,l=n.y0,u=n.x1,h=n.y1)&&r.length){var p=(s+u)/2,m=(l+h)/2;(i=r[3])&&t.push(new Bd(i,p,m,u,h)),(i=r[2])&&t.push(new Bd(i,s,m,p,h)),(i=r[1])&&t.push(new Bd(i,p,l,u,m)),(i=r[0])&&t.push(new Bd(i,s,l,p,m))}return this}function sK(e){var t=[],n=[],r;for(this._root&&t.push(new Bd(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,l=r.x0,u=r.y0,h=r.x1,p=r.y1,m=(l+h)/2,y=(u+p)/2;(s=i[0])&&t.push(new Bd(s,l,u,m,y)),(s=i[1])&&t.push(new Bd(s,m,u,h,y)),(s=i[2])&&t.push(new Bd(s,l,y,m,p)),(s=i[3])&&t.push(new Bd(s,m,y,h,p))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function lK(e){return e[0]}function cK(e){return arguments.length?(this._x=e,this):this._x}function uK(e){return e[1]}function fK(e){return arguments.length?(this._y=e,this):this._y}function l8(e,t,n){var r=new eM(t==null?lK:t,n==null?uK:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function eM(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function c8(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Fd=l8.prototype=eM.prototype;Fd.copy=function(){var e=new eM(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=c8(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=c8(r));return e},Fd.add=K$,Fd.addAll=q$,Fd.cover=Q$,Fd.data=J$,Fd.extent=eK,Fd.find=tK,Fd.remove=nK,Fd.removeAll=rK,Fd.root=iK,Fd.size=oK,Fd.visit=aK,Fd.visitAfter=sK,Fd.x=cK,Fd.y=fK;function Xp(e){return function(){return e}}function Q_(e){return(e()-.5)*1e-6}var hK={value:function(){}};function u8(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new aw(n)}function aw(e){this._=e}function dK(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}aw.prototype=u8.prototype={constructor:aw,on:function(t,n){var r=this._,i=dK(t+"",r),s,l=-1,u=i.length;if(arguments.length<2){for(;++l<u;)if((s=(t=i[l]).type)&&(s=pK(r[s],t.name)))return s;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++l<u;)if(s=(t=i[l]).type)r[s]=f8(r[s],t.name,n);else if(n==null)for(s in r)r[s]=f8(r[s],t.name,null);return this},copy:function(){var t={},n=this._;for(var r in n)t[r]=n[r].slice();return new aw(t)},call:function(t,n){if((s=arguments.length-2)>0)for(var r=new Array(s),i=0,s,l;i<s;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],i=0,s=l.length;i<s;++i)l[i].value.apply(n,r)},apply:function(t,n,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],s=0,l=i.length;s<l;++s)i[s].value.apply(n,r)}};function pK(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function f8(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=hK,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var mK=u8,J_=0,E2=0,S2=0,h8=1e3,sw,T2,lw=0,E1=0,cw=0,w2=typeof performance=="object"&&performance.now?performance:Date,d8=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function p8(){return E1||(d8(vK),E1=w2.now()+cw)}function vK(){E1=0}function tM(){this._call=this._time=this._next=null}tM.prototype=m8.prototype={constructor:tM,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?p8():+n)+(t==null?0:+t),!this._next&&T2!==this&&(T2?T2._next=this:sw=this,T2=this),this._call=e,this._time=n,nM()},stop:function(){this._call&&(this._call=null,this._time=1/0,nM())}};function m8(e,t,n){var r=new tM;return r.restart(e,t,n),r}function gK(){p8(),++J_;for(var e=sw,t;e;)(t=E1-e._time)>=0&&e._call.call(void 0,t),e=e._next;--J_}function v8(){E1=(lw=w2.now())+cw,J_=E2=0;try{gK()}finally{J_=0,_K(),E1=0}}function yK(){var e=w2.now(),t=e-lw;t>h8&&(cw-=t,lw=e)}function _K(){for(var e,t=sw,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:sw=n);T2=e,nM(r)}function nM(e){if(!J_){E2&&(E2=clearTimeout(E2));var t=e-E1;t>24?(e<1/0&&(E2=setTimeout(v8,e-w2.now()-cw)),S2&&(S2=clearInterval(S2))):(S2||(lw=w2.now(),S2=setInterval(yK,h8)),J_=1,d8(v8))}}const bK=1664525,xK=1013904223,g8=4294967296;function EK(){let e=1;return()=>(e=(bK*e+xK)%g8)/g8}function SK(e){return e.x}function TK(e){return e.y}var wK=10,AK=Math.PI*(3-Math.sqrt(5));function CK(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,l=.6,u=new Map,h=m8(y),p=mK("tick","end"),m=EK();e==null&&(e=[]);function y(){b(),p.call("tick",t),n<r&&(h.stop(),p.call("end",t))}function b(M){var I,N=e.length,U;M===void 0&&(M=1);for(var Z=0;Z<M;++Z)for(n+=(s-n)*i,u.forEach(function(Y){Y(n)}),I=0;I<N;++I)U=e[I],U.fx==null?U.x+=U.vx*=l:(U.x=U.fx,U.vx=0),U.fy==null?U.y+=U.vy*=l:(U.y=U.fy,U.vy=0);return t}function w(){for(var M=0,I=e.length,N;M<I;++M){if(N=e[M],N.index=M,N.fx!=null&&(N.x=N.fx),N.fy!=null&&(N.y=N.fy),isNaN(N.x)||isNaN(N.y)){var U=wK*Math.sqrt(.5+M),Z=M*AK;N.x=U*Math.cos(Z),N.y=U*Math.sin(Z)}(isNaN(N.vx)||isNaN(N.vy))&&(N.vx=N.vy=0)}}function R(M){return M.initialize&&M.initialize(e,m),M}return w(),t={tick:b,restart:function(){return h.restart(y),t},stop:function(){return h.stop(),t},nodes:function(M){return arguments.length?(e=M,w(),u.forEach(R),t):e},alpha:function(M){return arguments.length?(n=+M,t):n},alphaMin:function(M){return arguments.length?(r=+M,t):r},alphaDecay:function(M){return arguments.length?(i=+M,t):+i},alphaTarget:function(M){return arguments.length?(s=+M,t):s},velocityDecay:function(M){return arguments.length?(l=1-M,t):1-l},randomSource:function(M){return arguments.length?(m=M,u.forEach(R),t):m},force:function(M,I){return arguments.length>1?(I==null?u.delete(M):u.set(M,R(I)),t):u.get(M)},find:function(M,I,N){var U=0,Z=e.length,Y,$,J,se,pe;for(N==null?N=1/0:N*=N,U=0;U<Z;++U)se=e[U],Y=M-se.x,$=I-se.y,J=Y*Y+$*$,J<N&&(pe=se,N=J);return pe},on:function(M,I){return arguments.length>1?(p.on(M,I),t):p.on(M)}}}function OK(){var e,t,n,r,i=Xp(-30),s,l=1,u=1/0,h=.81;function p(w){var R,M=e.length,I=l8(e,SK,TK).visitAfter(y);for(r=w,R=0;R<M;++R)t=e[R],I.visit(b)}function m(){if(e){var w,R=e.length,M;for(s=new Array(R),w=0;w<R;++w)M=e[w],s[M.index]=+i(M,w,e)}}function y(w){var R=0,M,I,N=0,U,Z,Y;if(w.length){for(U=Z=Y=0;Y<4;++Y)(M=w[Y])&&(I=Math.abs(M.value))&&(R+=M.value,N+=I,U+=I*M.x,Z+=I*M.y);w.x=U/N,w.y=Z/N}else{M=w,M.x=M.data.x,M.y=M.data.y;do R+=s[M.data.index];while(M=M.next)}w.value=R}function b(w,R,M,I){if(!w.value)return!0;var N=w.x-t.x,U=w.y-t.y,Z=I-R,Y=N*N+U*U;if(Z*Z/h<Y)return Y<u&&(N===0&&(N=Q_(n),Y+=N*N),U===0&&(U=Q_(n),Y+=U*U),Y<l&&(Y=Math.sqrt(l*Y)),t.vx+=N*w.value*r/Y,t.vy+=U*w.value*r/Y),!0;if(w.length||Y>=u)return;(w.data!==t||w.next)&&(N===0&&(N=Q_(n),Y+=N*N),U===0&&(U=Q_(n),Y+=U*U),Y<l&&(Y=Math.sqrt(l*Y)));do w.data!==t&&(Z=s[w.data.index]*r/Y,t.vx+=N*Z,t.vy+=U*Z);while(w=w.next)}return p.initialize=function(w,R){e=w,n=R,m()},p.strength=function(w){return arguments.length?(i=typeof w=="function"?w:Xp(+w),m(),p):i},p.distanceMin=function(w){return arguments.length?(l=w*w,p):Math.sqrt(l)},p.distanceMax=function(w){return arguments.length?(u=w*w,p):Math.sqrt(u)},p.theta=function(w){return arguments.length?(h=w*w,p):Math.sqrt(h)},p}function RK(e){return e.index}function y8(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function MK(e){var t=RK,n=y,r,i=Xp(30),s,l,u,h,p,m=1;e==null&&(e=[]);function y(I){return 1/Math.min(u[I.source.index],u[I.target.index])}function b(I){for(var N=0,U=e.length;N<m;++N)for(var Z=0,Y,$,J,se,pe,Ce,Ue;Z<U;++Z)Y=e[Z],$=Y.source,J=Y.target,se=J.x+J.vx-$.x-$.vx||Q_(p),pe=J.y+J.vy-$.y-$.vy||Q_(p),Ce=Math.sqrt(se*se+pe*pe),Ce=(Ce-s[Z])/Ce*I*r[Z],se*=Ce,pe*=Ce,J.vx-=se*(Ue=h[Z]),J.vy-=pe*Ue,$.vx+=se*(Ue=1-Ue),$.vy+=pe*Ue}function w(){if(l){var I,N=l.length,U=e.length,Z=new Map(l.map(($,J)=>[t($,J,l),$])),Y;for(I=0,u=new Array(N);I<U;++I)Y=e[I],Y.index=I,typeof Y.source!="object"&&(Y.source=y8(Z,Y.source)),typeof Y.target!="object"&&(Y.target=y8(Z,Y.target)),u[Y.source.index]=(u[Y.source.index]||0)+1,u[Y.target.index]=(u[Y.target.index]||0)+1;for(I=0,h=new Array(U);I<U;++I)Y=e[I],h[I]=u[Y.source.index]/(u[Y.source.index]+u[Y.target.index]);r=new Array(U),R(),s=new Array(U),M()}}function R(){if(l)for(var I=0,N=e.length;I<N;++I)r[I]=+n(e[I],I,e)}function M(){if(l)for(var I=0,N=e.length;I<N;++I)s[I]=+i(e[I],I,e)}return b.initialize=function(I,N){l=I,p=N,w()},b.links=function(I){return arguments.length?(e=I,w(),b):e},b.id=function(I){return arguments.length?(t=I,b):t},b.iterations=function(I){return arguments.length?(m=+I,b):m},b.strength=function(I){return arguments.length?(n=typeof I=="function"?I:Xp(+I),R(),b):n},b.distance=function(I){return arguments.length?(i=typeof I=="function"?I:Xp(+I),M(),b):i},b}function PK(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,l=n.length,u,h=0,p=0;for(s=0;s<l;++s)u=n[s],h+=u.x,p+=u.y;for(h=(h/l-e)*r,p=(p/l-t)*r,s=0;s<l;++s)u=n[s],u.x-=h,u.y-=p}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function IK(e){var t=Xp(.1),n,r,i;typeof e!="function"&&(e=Xp(e==null?0:+e));function s(u){for(var h=0,p=n.length,m;h<p;++h)m=n[h],m.vx+=(i[h]-m.x)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+e(n[u],u,n))?0:+t(n[u],u,n)}}return s.initialize=function(u){n=u,l()},s.strength=function(u){return arguments.length?(t=typeof u=="function"?u:Xp(+u),l(),s):t},s.x=function(u){return arguments.length?(e=typeof u=="function"?u:Xp(+u),l(),s):e},s}function LK(e){var t=Xp(.1),n,r,i;typeof e!="function"&&(e=Xp(e==null?0:+e));function s(u){for(var h=0,p=n.length,m;h<p;++h)m=n[h],m.vy+=(i[h]-m.y)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+e(n[u],u,n))?0:+t(n[u],u,n)}}return s.initialize=function(u){n=u,l()},s.strength=function(u){return arguments.length?(t=typeof u=="function"?u:Xp(+u),l(),s):t},s.y=function(u){return arguments.length?(e=typeof u=="function"?u:Xp(+u),l(),s):e},s}var DK=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const NK={joint:!0},BK={type:"link",axis:!1,legend:!1,encode:{x:[e=>e.source.x,e=>e.target.x],y:[e=>e.source.y,e=>e.target.y]},style:{stroke:"#999",strokeOpacity:.6}},FK={type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},style:{stroke:"#fff"}},kK={text:""};function zK(e,t,n){const{nodes:r,links:i}=e,{joint:s,nodeStrength:l,linkStrength:u}=t,{nodeKey:h=R=>R.id,linkKey:p=R=>R.id}=n,m=OK(),y=MK(i).id($m(p));typeof l=="function"&&m.strength(l),typeof u=="function"&&y.strength(u);const b=CK(r).force("link",y).force("charge",m);s?b.force("center",PK()):b.force("x",IK()).force("y",LK()),b.stop();const w=Math.ceil(Math.log(b.alphaMin())/Math.log(1-b.alphaDecay()));for(let R=0;R<w;R++)b.tick();return{nodesData:r,linksData:i}}const _8=e=>{const{data:t,encode:n={},scale:r,style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=e,{nodeKey:m=J=>J.id,linkKey:y=J=>J.id}=n,b=DK(n,["nodeKey","linkKey"]),w=Object.assign({nodeKey:m,linkKey:y},b),R=po(w,"node"),M=po(w,"link"),{links:I,nodes:N}=o3(t,w),{nodesData:U,linksData:Z}=zK({links:I,nodes:N},ni({},NK,s),w),Y=Gm(p,"link",{items:[J=>({name:"source",value:$m(y)(J.source)}),J=>({name:"target",value:$m(y)(J.target)})]}),$=Gm(p,"node",{items:[J=>({name:"key",value:$m(m)(J)})]},!0);return[ni({},BK,{data:Z,encode:M,labels:u,style:po(i,"link"),tooltip:Y,animate:Xm(h,"link")}),ni({},FK,{data:U,encode:Object.assign({},R),scale:r,style:po(i,"node"),tooltip:$,labels:[Object.assign(Object.assign({},kK),po(i,"label")),...l],animate:Xm(h,"link")})]};_8.props={};function UK(e,t){return e.parent===t.parent?1:2}function rM(e){var t=e.children;return t?t[0]:e.t}function iM(e){var t=e.children;return t?t[t.length-1]:e.t}function jK(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function VK(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function HK(e,t,n){return e.a.parent===t.parent?e.a:n}function uw(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}uw.prototype=Object.create(k_.prototype);function ZK(e){for(var t=new uw(e,0),n,r=[t],i,s,l,u;n=r.pop();)if(s=n._.children)for(n.children=new Array(u=s.length),l=u-1;l>=0;--l)r.push(i=n.children[l]=new uw(s[l],l)),i.parent=n;return(t.parent=new uw(null,0)).children=[t],t}function WK(){var e=UK,t=1,n=1,r=null;function i(p){var m=ZK(p);if(m.eachAfter(s),m.parent.m=-m.z,m.eachBefore(l),r)p.eachBefore(h);else{var y=p,b=p,w=p;p.eachBefore(function(U){U.x<y.x&&(y=U),U.x>b.x&&(b=U),U.depth>w.depth&&(w=U)});var R=y===b?1:e(y,b)/2,M=R-y.x,I=t/(b.x+R+M),N=n/(w.depth||1);p.eachBefore(function(U){U.x=(U.x+M)*I,U.y=U.depth*N})}return p}function s(p){var m=p.children,y=p.parent.children,b=p.i?y[p.i-1]:null;if(m){VK(p);var w=(m[0].z+m[m.length-1].z)/2;b?(p.z=b.z+e(p._,b._),p.m=p.z-w):p.z=w}else b&&(p.z=b.z+e(p._,b._));p.parent.A=u(p,b,p.parent.A||y[0])}function l(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function u(p,m,y){if(m){for(var b=p,w=p,R=m,M=b.parent.children[0],I=b.m,N=w.m,U=R.m,Z=M.m,Y;R=iM(R),b=rM(b),R&&b;)M=rM(M),w=iM(w),w.a=p,Y=R.z+U-b.z-I+e(R._,b._),Y>0&&(jK(HK(R,p,y),p,Y),I+=Y,N+=Y),U+=R.m,I+=b.m,Z+=M.m,N+=w.m;R&&!iM(w)&&(w.t=R,w.m+=U-N),b&&!rM(M)&&(M.t=b,M.m+=I-Z,y=p)}return y}function h(p){p.x*=t,p.y=p.depth*n}return i.separation=function(p){return arguments.length?(e=p,i):e},i.size=function(p){return arguments.length?(r=!1,t=+p[0],n=+p[1],i):r?null:[t,n]},i.nodeSize=function(p){return arguments.length?(r=!0,t=+p[0],n=+p[1],i):r?[t,n]:null},i}function GK(e,t){return e.parent===t.parent?1:2}function XK(e){return e.reduce(YK,0)/e.length}function YK(e,t){return e+t.x}function $K(e){return 1+e.reduce(KK,0)}function KK(e,t){return Math.max(e,t.y)}function qK(e){for(var t;t=e.children;)e=t[0];return e}function QK(e){for(var t;t=e.children;)e=t[t.length-1];return e}function JK(){var e=GK,t=1,n=1,r=!1;function i(s){var l,u=0;s.eachAfter(function(b){var w=b.children;w?(b.x=XK(w),b.y=$K(w)):(b.x=l?u+=e(b,l):0,b.y=0,l=b)});var h=qK(s),p=QK(s),m=h.x-e(h,p)/2,y=p.x+e(p,h)/2;return s.eachAfter(r?function(b){b.x=(b.x-s.x)*t,b.y=(s.y-b.y)*n}:function(b){b.x=(b.x-m)/(y-m)*t,b.y=(1-(s.y?b.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}const b8=e=>t=>n=>{const{field:r="value",nodeSize:i,separation:s,sortBy:l,as:u=["x","y"]}=t,[h,p]=u,m=F_(n,R=>R.children).sum(R=>R[r]).sort(l),y=e();y.size([1,1]),i&&y.nodeSize(i),s&&y.separation(s),y(m);const b=[];m.each(R=>{R[h]=R.x,R[p]=R.y,R.name=R.data.name,b.push(R)});const w=m.links();return w.forEach(R=>{R[h]=[R.source[h],R.target[h]],R[p]=[R.source[p],R.target[p]]}),{nodes:b,edges:w}},x8=e=>b8(JK)(e);x8.props={};const E8=e=>b8(WK)(e);E8.props={};const eq={sortBy:(e,t)=>t.value-e.value},tq={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},nq={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},rq={text:"",fontSize:10},S8=e=>{const{data:t,encode:n={},scale:r={},style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=e,m=n==null?void 0:n.value,{nodes:y,edges:b}=E8(Object.assign(Object.assign(Object.assign({},eq),s),{field:m}))(t),w=Gm(p,"node",{title:"name",items:["value"]},!0),R=Gm(p,"link",{title:"",items:[M=>({name:"source",value:M.source.name}),M=>({name:"target",value:M.target.name})]});return[ni({},nq,{data:b,encode:po(n,"link"),scale:po(r,"link"),labels:u,style:Object.assign({stroke:"#999"},po(i,"link")),tooltip:R,animate:Xm(h,"link")}),ni({},tq,{data:y,scale:po(r,"node"),encode:po(n,"node"),labels:[Object.assign(Object.assign({},rq),po(i,"label")),...l],style:Object.assign({},po(i,"node")),tooltip:w,animate:Xm(h,"node")})]};S8.props={};var iq=1664525,oq=1013904223,T8=4294967296;function aq(){var e=1;return function(){return(e=(iq*e+oq)%T8)/T8}}var sq=D(52677);function lq(e){return sq(e)==="object"&&"length"in e?e:Array.from(e)}function cq(e,t){for(var n=e.length,r,i;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function Jte(e){return w8(e,lcg())}function w8(e,t){for(var n=0,r=(e=cq(Array.from(e),t)).length,i=[],s,l;n<r;)s=e[n],l&&A8(l,s)?++n:(l=fq(i=uq(i,s)),n=0);return l}function uq(e,t){var n,r;if(oM(t,e))return[t];for(n=0;n<e.length;++n)if(fw(t,e[n])&&oM(A2(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(fw(A2(e[n],e[r]),t)&&fw(A2(e[n],t),e[r])&&fw(A2(e[r],t),e[n])&&oM(C8(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function fw(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function A8(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function oM(e,t){for(var n=0;n<t.length;++n)if(!A8(e,t[n]))return!1;return!0}function fq(e){switch(e.length){case 1:return hq(e[0]);case 2:return A2(e[0],e[1]);case 3:return C8(e[0],e[1],e[2])}}function hq(e){return{x:e.x,y:e.y,r:e.r}}function A2(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,l=t.y,u=t.r,h=s-n,p=l-r,m=u-i,y=Math.sqrt(h*h+p*p);return{x:(n+s+h/y*m)/2,y:(r+l+p/y*m)/2,r:(y+i+u)/2}}function C8(e,t,n){var r=e.x,i=e.y,s=e.r,l=t.x,u=t.y,h=t.r,p=n.x,m=n.y,y=n.r,b=r-l,w=r-p,R=i-u,M=i-m,I=h-s,N=y-s,U=r*r+i*i-s*s,Z=U-l*l-u*u+h*h,Y=U-p*p-m*m+y*y,$=w*R-b*M,J=(R*Y-M*Z)/($*2)-r,se=(M*I-R*N)/$,pe=(w*Z-b*Y)/($*2)-i,Ce=(b*N-w*I)/$,Ue=se*se+Ce*Ce-1,Je=2*(s+J*se+pe*Ce),lt=J*J+pe*pe-s*s,Ge=-(Math.abs(Ue)>1e-6?(Je+Math.sqrt(Je*Je-4*Ue*lt))/(2*Ue):lt/Je);return{x:r+J+se*Ge,y:i+pe+Ce*Ge,r:Ge}}function O8(e,t,n){var r=e.x-t.x,i,s,l=e.y-t.y,u,h,p=r*r+l*l;p?(s=t.r+n.r,s*=s,h=e.r+n.r,h*=h,s>h?(i=(p+h-s)/(2*p),u=Math.sqrt(Math.max(0,h/p-i*i)),n.x=e.x-i*r-u*l,n.y=e.y-i*l+u*r):(i=(p+s-h)/(2*p),u=Math.sqrt(Math.max(0,s/p-i*i)),n.x=t.x+i*r-u*l,n.y=t.y+i*l+u*r)):(n.x=t.x+n.r,n.y=t.y)}function R8(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function M8(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function hw(e){this._=e,this.next=null,this.previous=null}function P8(e,t){if(!(s=(e=lq(e)).length))return 0;var n,r,i,s,l,u,h,p,m,y,b;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(s>2))return n.r+r.r;O8(r,n,i=e[2]),n=new hw(n),r=new hw(r),i=new hw(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(h=3;h<s;++h){O8(n._,r._,i=e[h]),i=new hw(i),p=r.next,m=n.previous,y=r._.r,b=n._.r;do if(y<=b){if(R8(p._,i._)){r=p,n.next=r,r.previous=n,--h;continue e}y+=p._.r,p=p.next}else{if(R8(m._,i._)){n=m,n.next=r,r.previous=n,--h;continue e}b+=m._.r,m=m.previous}while(p!==m.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,l=M8(n);(i=i.next)!==r;)(u=M8(i))<l&&(n=i,l=u);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=w8(n,t),h=0;h<s;++h)n=e[h],n.x-=i.x,n.y-=i.y;return i.r}function ene(e){return P8(e,lcg()),e}function dq(e){return Math.sqrt(e.value)}function pq(){var e=null,t=1,n=1,r=b1;function i(s){var l=aq();return s.x=t/2,s.y=n/2,e?s.eachBefore(I8(e)).eachAfter(aM(r,.5,l)).eachBefore(L8(1)):s.eachBefore(I8(dq)).eachAfter(aM(b1,1,l)).eachAfter(aM(r,s.r/Math.min(t,n),l)).eachBefore(L8(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=RT(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:W_(+s),i):r},i}function I8(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function aM(e,t,n){return function(r){if(i=r.children){var i,s,l=i.length,u=e(r)*t||0,h;if(u)for(s=0;s<l;++s)i[s].r+=u;if(h=P8(i,n),u)for(s=0;s<l;++s)i[s].r-=u;r.r=h+u}}}function L8(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var mq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const vq=(e,t)=>({size:[e,t],padding:0,sort:(n,r)=>r.value-n.value}),gq=(e,t,n)=>({type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,e]},y:{domain:[0,t]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:n.color?void 0:r=>r.height===0?"#ddd":"#fff",stroke:n.color?void 0:r=>r.height===0?"":"#000"}}),yq={text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:e=>e.r*2},_q={title:e=>e.data.name,items:[{field:"value"}]},bq=(e,t,n)=>{const{value:r}=n,i=Is(e)?J3().path(t.path)(e):F_(e);return r?i.sum(s=>$m(r)(s)).sort(t.sort):i.count(),pq().size(t.size).padding(t.padding)(i),i.descendants()},D8=(e,t)=>{const{width:n,height:r}=t,{data:i,encode:s={},scale:l={},style:u={},layout:h={},labels:p=[],tooltip:m={}}=e,y=mq(e,["data","encode","scale","style","layout","labels","tooltip"]),b=gq(n,r,s),w=bq(i,ni({},vq(n,r),h),ni({},b.encode,s)),R=po(u,"label");return ni({},b,Object.assign(Object.assign({data:w,encode:s,scale:l,style:u,labels:[Object.assign(Object.assign({},yq),R),...p]},y),{tooltip:eT(m,_q),axis:!1}))};D8.props={};function xq(e){return e.target.depth}function Eq(e){return e.depth}function Sq(e,t){return t-1-e.height}function dw(e,t){return e.sourceLinks.length?e.depth:t-1}function Tq(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?Zp(e.sourceLinks,xq)-1:0}function pw(e){return function(){return e}}function N8(e,t){return mw(e.source,t.source)||e.index-t.index}function B8(e,t){return mw(e.target,t.target)||e.index-t.index}function mw(e,t){return e.y0-t.y0}function sM(e){return e.value}function wq(e){return e.index}function Aq(e){return e.nodes}function Cq(e){return e.links}function F8(e,t){const n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function k8({nodes:e}){for(const t of e){let n=t.y0,r=n;for(const i of t.sourceLinks)i.y0=n+i.width/2,n+=i.width;for(const i of t.targetLinks)i.y1=r+i.width/2,r+=i.width}}function Oq(){let e=0,t=0,n=1,r=1,i=24,s=8,l,u=wq,h=dw,p,m,y,b=Aq,w=Cq,R=6;function M(ft){const Vt={nodes:b(ft),links:w(ft)};return I(Vt),N(Vt),U(Vt),Z(Vt),J(Vt),k8(Vt),Vt}M.update=function(ft){return k8(ft),ft},M.nodeId=function(ft){return arguments.length?(u=typeof ft=="function"?ft:pw(ft),M):u},M.nodeAlign=function(ft){return arguments.length?(h=typeof ft=="function"?ft:pw(ft),M):h},M.nodeDepth=function(ft){return arguments.length?(p=ft,M):p},M.nodeSort=function(ft){return arguments.length?(m=ft,M):m},M.nodeWidth=function(ft){return arguments.length?(i=+ft,M):i},M.nodePadding=function(ft){return arguments.length?(s=l=+ft,M):s},M.nodes=function(ft){return arguments.length?(b=typeof ft=="function"?ft:pw(ft),M):b},M.links=function(ft){return arguments.length?(w=typeof ft=="function"?ft:pw(ft),M):w},M.linkSort=function(ft){return arguments.length?(y=ft,M):y},M.size=function(ft){return arguments.length?(e=t=0,n=+ft[0],r=+ft[1],M):[n-e,r-t]},M.extent=function(ft){return arguments.length?(e=+ft[0][0],n=+ft[1][0],t=+ft[0][1],r=+ft[1][1],M):[[e,t],[n,r]]},M.iterations=function(ft){return arguments.length?(R=+ft,M):R};function I({nodes:ft,links:Vt}){ft.forEach((zt,En)=>{zt.index=En,zt.sourceLinks=[],zt.targetLinks=[]});const wt=new Map(ft.map(zt=>[u(zt),zt]));if(Vt.forEach((zt,En)=>{zt.index=En;let{source:Vn,target:ar}=zt;typeof Vn!="object"&&(Vn=zt.source=F8(wt,Vn)),typeof ar!="object"&&(ar=zt.target=F8(wt,ar)),Vn.sourceLinks.push(zt),ar.targetLinks.push(zt)}),y!=null)for(const{sourceLinks:zt,targetLinks:En}of ft)zt.sort(y),En.sort(y)}function N({nodes:ft}){for(const Vt of ft)Vt.value=Vt.fixedValue===void 0?Math.max(sp(Vt.sourceLinks,sM),sp(Vt.targetLinks,sM)):Vt.fixedValue}function U({nodes:ft}){const Vt=ft.length;let wt=new Set(ft),zt=new Set,En=0;for(;wt.size;){if(wt.forEach(Vn=>{Vn.depth=En;for(const{target:ar}of Vn.sourceLinks)zt.add(ar)}),++En>Vt)throw new Error("circular link");wt=zt,zt=new Set}if(p){const Vn=Math.max(Sl(ft,lr=>lr.depth)+1,0);let ar;for(let lr=0;lr<ft.length;lr++)ar=ft[lr],ar.depth=p.call(null,ar,Vn)}}function Z({nodes:ft}){const Vt=ft.length;let wt=new Set(ft),zt=new Set,En=0;for(;wt.size;){if(wt.forEach(Vn=>{Vn.height=En;for(const{source:ar}of Vn.targetLinks)zt.add(ar)}),++En>Vt)throw new Error("circular link");wt=zt,zt=new Set}}function Y({nodes:ft}){const Vt=Math.max(Sl(ft,En=>En.depth)+1,0),wt=(n-e-i)/(Vt-1),zt=new Array(Vt).fill(0).map(()=>[]);for(const En of ft){const Vn=Math.max(0,Math.min(Vt-1,Math.floor(h.call(null,En,Vt))));En.layer=Vn,En.x0=e+Vn*wt,En.x1=En.x0+i,zt[Vn]?zt[Vn].push(En):zt[Vn]=[En]}if(m)for(const En of zt)En.sort(m);return zt}function $(ft){const Vt=Zp(ft,wt=>(r-t-(wt.length-1)*l)/sp(wt,sM));for(const wt of ft){let zt=t;for(const En of wt){En.y0=zt,En.y1=zt+En.value*Vt,zt=En.y1+l;for(const Vn of En.sourceLinks)Vn.width=Vn.value*Vt}zt=(r-zt+l)/(wt.length+1);for(let En=0;En<wt.length;++En){const Vn=wt[En];Vn.y0+=zt*(En+1),Vn.y1+=zt*(En+1)}Ge(wt)}}function J(ft){const Vt=Y(ft);l=Math.min(s,(r-t)/(Sl(Vt,wt=>wt.length)-1)),$(Vt);for(let wt=0;wt<R;++wt){const zt=Math.pow(.99,wt),En=Math.max(1-zt,(wt+1)/R);pe(Vt,zt,En),se(Vt,zt,En)}}function se(ft,Vt,wt){for(let zt=1,En=ft.length;zt<En;++zt){const Vn=ft[zt];for(const ar of Vn){let lr=0,Vr=0;for(const{source:qi,value:Jr}of ar.targetLinks){const Qr=Jr*(ar.layer-qi.layer);lr+=at(qi,ar)*Qr,Vr+=Qr}if(!(Vr>0))continue;const ui=(lr/Vr-ar.y0)*Vt;ar.y0+=ui,ar.y1+=ui,lt(ar)}m===void 0&&Vn.sort(mw),Vn.length&&Ce(Vn,wt)}}function pe(ft,Vt,wt){for(let zt=ft.length,En=zt-2;En>=0;--En){const Vn=ft[En];for(const ar of Vn){let lr=0,Vr=0;for(const{target:qi,value:Jr}of ar.sourceLinks){const Qr=Jr*(qi.layer-ar.layer);lr+=st(ar,qi)*Qr,Vr+=Qr}if(!(Vr>0))continue;const ui=(lr/Vr-ar.y0)*Vt;ar.y0+=ui,ar.y1+=ui,lt(ar)}m===void 0&&Vn.sort(mw),Vn.length&&Ce(Vn,wt)}}function Ce(ft,Vt){const wt=ft.length>>1,zt=ft[wt];Je(ft,zt.y0-l,wt-1,Vt),Ue(ft,zt.y1+l,wt+1,Vt),Je(ft,r,ft.length-1,Vt),Ue(ft,t,0,Vt)}function Ue(ft,Vt,wt,zt){for(;wt<ft.length;++wt){const En=ft[wt],Vn=(Vt-En.y0)*zt;Vn>1e-6&&(En.y0+=Vn,En.y1+=Vn),Vt=En.y1+l}}function Je(ft,Vt,wt,zt){for(;wt>=0;--wt){const En=ft[wt],Vn=(En.y1-Vt)*zt;Vn>1e-6&&(En.y0-=Vn,En.y1-=Vn),Vt=En.y0-l}}function lt({sourceLinks:ft,targetLinks:Vt}){if(y===void 0){for(const{source:{sourceLinks:wt}}of Vt)wt.sort(B8);for(const{target:{targetLinks:wt}}of ft)wt.sort(N8)}}function Ge(ft){if(y===void 0)for(const{sourceLinks:Vt,targetLinks:wt}of ft)Vt.sort(B8),wt.sort(N8)}function at(ft,Vt){let wt=ft.y0-(ft.sourceLinks.length-1)*l/2;for(const{target:zt,width:En}of ft.sourceLinks){if(zt===Vt)break;wt+=En+l}for(const{source:zt,width:En}of Vt.targetLinks){if(zt===ft)break;wt-=En}return wt}function st(ft,Vt){let wt=Vt.y0-(Vt.targetLinks.length-1)*l/2;for(const{source:zt,width:En}of Vt.targetLinks){if(zt===ft)break;wt+=En+l}for(const{target:zt,width:En}of ft.sourceLinks){if(zt===Vt)break;wt-=En}return wt}return M}const Rq={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:e=>e.nodes,links:e=>e.links,nodeSort:void 0,linkSort:void 0,iterations:6},Mq={left:Eq,right:Sq,center:Tq,justify:dw};function Pq(e){const t=typeof e;return t==="string"?Mq[e]||dw:t==="function"?e:dw}const z8=e=>t=>{const{nodeId:n,nodeSort:r,nodeAlign:i,nodeWidth:s,nodePadding:l,nodeDepth:u,nodes:h,links:p,linkSort:m,iterations:y}=Object.assign({},Rq,e),b=Oq().nodeSort(r).linkSort(m).links(p).nodes(h).nodeWidth(s).nodePadding(l).nodeDepth(u).nodeAlign(Pq(i)).iterations(y).extent([[0,0],[1,1]]);typeof n=="function"&&b.nodeId(n);const w=b(t),{nodes:R,links:M}=w,I=R.map(U=>{const{x0:Z,x1:Y,y0:$,y1:J}=U;return Object.assign(Object.assign({},U),{x:[Z,Y,Y,Z],y:[$,$,J,J]})}),N=M.map(U=>{const{source:Z,target:Y}=U,$=Z.x1,J=Y.x0,se=U.width/2;return Object.assign(Object.assign({},U),{x:[$,$,J,J],y:[U.y0+se,U.y0-se,U.y1+se,U.y1-se]})});return{nodes:I,links:N}};z8.props={};var Iq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Lq={nodeId:e=>e.key,nodeWidth:.02,nodePadding:.02},Dq={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},Nq={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:void 0}},Bq={textAlign:e=>e.x[0]<.5?"start":"end",position:e=>e.x[0]<.5?"right":"left",fontSize:10},U8=e=>{const{data:t,encode:n={},scale:r,style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=e,{links:m,nodes:y}=o3(t,n),b=po(n,"node"),w=po(n,"link"),{key:R=Ce=>Ce.key,color:M=R}=b,{links:I,nodes:N}=z8(Object.assign(Object.assign(Object.assign({},Lq),{nodeId:$m(R)}),s))({links:m,nodes:y}),U=po(i,"label"),{text:Z=R,spacing:Y=5}=U,$=Iq(U,["text","spacing"]),J=$m(R),se=Gm(p,"node",{title:J,items:[{field:"value"}]},!0),pe=Gm(p,"link",{title:"",items:[Ce=>({name:"source",value:J(Ce.source)}),Ce=>({name:"target",value:J(Ce.target)})]});return[ni({},Dq,{data:N,encode:Object.assign(Object.assign({},b),{color:M}),scale:r,style:po(i,"node"),labels:[Object.assign(Object.assign(Object.assign({},Bq),{text:Z,dx:Ce=>Ce.x[0]<.5?Y:-Y}),$),...l],tooltip:se,animate:Xm(h,"node"),axis:!1}),ni({},Nq,{data:I,encode:w,labels:u,style:Object.assign({fill:w.color?void 0:"#aaa",lineWidth:0},po(i,"link")),tooltip:pe,animate:Xm(h,"link")})]};U8.props={};function Fq(e,t){return t.value-e.value}function kq(e,t){return t.frequency-e.frequency}function zq(e,t){return`${e.id}`.localeCompare(`${t.id}`)}function Uq(e,t){return`${e.name}`.localeCompare(`${t.name}`)}const jq={y:0,thickness:.05,weight:!1,marginRatio:.1,id:e=>e.id,source:e=>e.source,target:e=>e.target,sourceWeight:e=>e.value||1,targetWeight:e=>e.value||1,sortBy:null};function Vq(e){const{y:t,thickness:n,weight:r,marginRatio:i,id:s,source:l,target:u,sourceWeight:h,targetWeight:p,sortBy:m}=Object.assign(Object.assign({},jq),e);function y(I){const N=I.nodes.map(Z=>Object.assign({},Z)),U=I.edges.map(Z=>Object.assign({},Z));return b(N,U),w(N,U),R(N,U),M(N,U),{nodes:N,edges:U}}function b(I,N){N.forEach(Y=>{Y.source=l(Y),Y.target=u(Y),Y.sourceWeight=h(Y),Y.targetWeight=p(Y)});const U=vc(N,Y=>Y.source),Z=vc(N,Y=>Y.target);return I.forEach(Y=>{Y.id=s(Y);const $=U.has(Y.id)?U.get(Y.id):[],J=Z.has(Y.id)?Z.get(Y.id):[];Y.frequency=$.length+J.length,Y.value=sp($,se=>se.sourceWeight)+sp(J,se=>se.targetWeight)}),{nodes:I,edges:N}}function w(I,N){const U=typeof m=="function"?m:ve[m];U&&I.sort(U)}function R(I,N){const U=I.length;if(!U)throw mg("Invalid nodes: it's empty!");if(!r){const $=1/U;return I.forEach((J,se)=>{J.x=(se+.5)*$,J.y=t}),{nodes:I,edges:N}}const Z=i/(2*U),Y=I.reduce(($,J)=>$+=J.value,0);return I.reduce(($,J)=>{J.weight=J.value/Y,J.width=J.weight*(1-i),J.height=n;const se=Z+$,pe=se+J.width,Ce=t-n/2,Ue=Ce+n;return J.x=[se,pe,pe,se],J.y=[Ce,Ce,Ue,Ue],$+J.width+2*Z},0),{nodes:I,edges:N}}function M(I,N){const U=new Map(I.map($=>[$.id,$]));if(!r)return N.forEach($=>{const J=l($),se=u($),pe=U.get(J),Ce=U.get(se);pe&&Ce&&($.x=[pe.x,Ce.x],$.y=[pe.y,Ce.y])}),{nodes:I,edges:N};N.forEach($=>{$.x=[0,0,0,0],$.y=[t,t,t,t]});const Z=vc(N,$=>$.source),Y=vc(N,$=>$.target);I.forEach($=>{const{edges:J,width:se,x:pe,y:Ce,value:Ue,id:Je}=$,lt=Z.get(Je)||[],Ge=Y.get(Je)||[];let at=0;lt.map(st=>{const ft=st.sourceWeight/Ue*se;st.x[0]=pe[0]+at,st.x[1]=pe[0]+at+ft,at+=ft}),Ge.forEach(st=>{const ft=st.targetWeight/Ue*se;st.x[3]=pe[0]+at,st.x[2]=pe[0]+at+ft,at+=ft})})}return y}const lM=e=>t=>Vq(e)(t);lM.props={};var j8=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const cM={y:0,thickness:.05,marginRatio:.1,id:e=>e.key,source:e=>e.source,target:e=>e.target,sourceWeight:e=>e.value||1,targetWeight:e=>e.value||1,sortBy:null},Hq={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{opacity:1,fillOpacity:1,lineWidth:1}},Zq={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{opacity:.5,lineWidth:1}},Wq={position:"outside",fontSize:10},V8=(e,t)=>{const{data:n,encode:r={},scale:i,style:s={},layout:l={},nodeLabels:u=[],linkLabels:h=[],animate:p={},tooltip:m={}}=e,{nodes:y,links:b}=o3(n,r),w=po(r,"node"),R=po(r,"link"),{key:M=st=>st.key,color:I=M}=w,{linkEncodeColor:N=st=>st.source}=R,{nodeWidthRatio:U=cM.thickness,nodePaddingRatio:Z=cM.marginRatio}=l,Y=j8(l,["nodeWidthRatio","nodePaddingRatio"]),{nodes:$,edges:J}=lM(Object.assign(Object.assign(Object.assign(Object.assign({},cM),{id:$m(M),thickness:U,marginRatio:Z}),Y),{weight:!0}))({nodes:y,edges:b}),se=po(s,"label"),{text:pe=M}=se,Ce=j8(se,["text"]),Ue=Gm(m,"node",{title:"",items:[st=>({name:st.key,value:st.value})]},!0),Je=Gm(m,"link",{title:"",items:[st=>({name:`${st.source} -> ${st.target}`,value:st.value})]}),{height:lt,width:Ge}=t,at=Math.min(lt,Ge);return[ni({},Zq,{data:J,encode:Object.assign(Object.assign({},R),{color:N}),labels:h,style:Object.assign({fill:N?void 0:"#aaa"},po(s,"link")),tooltip:Je,animate:Xm(p,"link")}),ni({},Hq,{data:$,encode:Object.assign(Object.assign({},w),{color:I}),scale:i,style:po(s,"node"),coordinate:{type:"polar",outerRadius:(at-20)/at,startAngle:-Math.PI*2,endAngle:0},labels:[Object.assign(Object.assign(Object.assign({},Wq),{text:pe}),Ce),...u],tooltip:Ue,animate:Xm(p,"node"),axis:!1})]};V8.props={};var Gq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Xq=(e,t)=>({tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[e,t],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(n,r)=>r.value-n.value,layer:0}),Yq=(e,t)=>({type:"rect",axis:!1,encode:{x:"x",y:"y",key:"id",color:n=>n.path[1]},scale:{x:{domain:[0,e],range:[0,1]},y:{domain:[0,t],range:[0,1]}},style:{stroke:"#fff"},state:{active:{opacity:.6},inactive:{opacity:1}}}),$q={fontSize:10,text:e=>Xx(e.path),position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:e=>e.x1-e.x0},Kq={title:e=>{var t,n;return(n=(t=e.path)===null||t===void 0?void 0:t.join)===null||n===void 0?void 0:n.call(t,".")},items:[{field:"value"}]},qq={title:e=>Xx(e.path),items:[{field:"value"}]},H8=(e,t)=>{const{width:n,height:r,options:i}=t,{data:s,encode:l={},scale:u,style:h={},layout:p={},labels:m=[],tooltip:y={}}=e,b=Gq(e,["data","encode","scale","style","layout","labels","tooltip"]),w=Bi(i,["interaction","treemapDrillDown"]),R=ni({},Xq(n,r),p,{layer:w?U=>U.depth===1:p.layer}),[M,I]=ZN(s,R,l),N=po(h,"label");return ni({},Yq(n,r),Object.assign(Object.assign({data:M,scale:u,style:h,labels:[Object.assign(Object.assign({},$q),N),...m]},b),{encode:l,tooltip:eT(y,Kq),axis:!1}),w?{interaction:Object.assign(Object.assign({},b.interaction),{treemapDrillDown:w?Object.assign(Object.assign({},w),{originData:I,layout:R}):void 0}),encode:Object.assign({color:U=>Xx(U.path)},l),tooltip:eT(y,qq)}:{})};H8.props={};function Qq(){return{"data.arc":lM,"data.cluster":x8,"mark.forceGraph":_8,"mark.tree":S8,"mark.pack":D8,"mark.sankey":U8,"mark.chord":V8,"mark.treemap":H8}}var Z8=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Jq(e,t){return Zp(e,n=>t[n])}function eQ(e,t){return Sl(e,n=>t[n])}function W8(e,t){const n=uM(e,t)*2.5-fM(e,t)*1.5;return Zp(e,r=>t[r]>=n?t[r]:NaN)}function uM(e,t){return LT(e,.25,n=>t[n])}function tQ(e,t){return LT(e,.5,n=>t[n])}function fM(e,t){return LT(e,.75,n=>t[n])}function G8(e,t){const n=fM(e,t)*2.5-uM(e,t)*1.5;return Sl(e,r=>t[r]<=n?t[r]:NaN)}function nQ(){return(e,t)=>{const{encode:n}=t,{y:r,x:i}=n,{value:s}=r,{value:l}=i;return[Array.from(vc(e,p=>l[+p]).values()).flatMap(p=>{const m=W8(p,s),y=G8(p,s);return p.filter(b=>s[b]<m||s[b]>y)}),t]}}const X8=e=>{const{data:t,encode:n,style:r={},tooltip:i={},transform:s,animate:l}=e,u=Z8(e,["data","encode","style","tooltip","transform","animate"]),{point:h=!0}=r,p=Z8(r,["point"]),{y:m}=n,y={y:m,y1:m,y2:m,y3:m,y4:m},b={y1:uM,y2:tQ,y3:fM},w=Gm(i,"box",{items:[{channel:"y",name:"min"},{channel:"y1",name:"q1"},{channel:"y2",name:"q2"},{channel:"y3",name:"q3"},{channel:"y4",name:"max"}]},!0),R=Gm(i,"point",{title:{channel:"x"},items:[{name:"outlier",channel:"y"}]});if(!h)return Object.assign({type:"box",data:t,transform:[Object.assign(Object.assign({type:"groupX",y:Jq},b),{y4:eQ})],encode:Object.assign(Object.assign({},n),y),style:p,tooltip:w},u);const M=po(p,"box"),I=po(p,"point");return[Object.assign({type:"box",data:t,transform:[Object.assign(Object.assign({type:"groupX",y:W8},b),{y4:G8})],encode:Object.assign(Object.assign({},n),y),style:M,tooltip:w,animate:Xm(l,"box")},u),{type:"point",data:t,transform:[{type:nQ}],encode:n,style:Object.assign({},I),tooltip:R,animate:Xm(l,"point")}]};X8.props={};const Y8=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))/2,rQ=(e,t)=>{if(!t)return;const{coordinate:n}=t;if(!(n!=null&&n.getCenter))return;const r=n.getCenter();return(i,s,l)=>{const{document:u}=t.canvas,{color:h,index:p}=s,m=u.createElement("g",{}),y=Y8(i[0],i[1]),b=Y8(i[0],r)*2,w=u.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:[["M",...i[0]],["A",y,y,0,1,0,...i[1]],["A",b+y*2,b+y*2,0,0,0,...i[2]],["A",y,y,0,1,p===0?0:1,...i[3]],["A",b,b,0,0,1,...i[0]],["Z"]]},l),oc(e,["shape","last","first"])),{fill:h||l.color})});return m.appendChild(w),m}};var vw=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const iQ=(e,t)=>{const{shape:n,radius:r}=e,i=vw(e,["shape","radius"]),s=po(i,"pointer"),l=po(i,"pin"),{shape:u}=s,h=vw(s,["shape"]),{shape:p}=l,m=vw(l,["shape"]),{coordinate:y,theme:b}=t;return(w,R)=>{const M=w.map(at=>y.invert(at)),[I,N,U]=SA(y,"polar"),Z=y.clone(),{color:Y}=R,$=Bb({startAngle:I,endAngle:N,innerRadius:U,outerRadius:r});$.push(["cartesian"]),Z.update({transformations:$});const J=M.map(at=>Z.map(at)),[se,pe]=cs(J),[Ce,Ue]=y.getCenter(),Je=Object.assign(Object.assign({x1:se,y1:pe,x2:Ce,y2:Ue,stroke:Y},h),i),lt=Object.assign(Object.assign({cx:Ce,cy:Ue,stroke:Y},m),i),Ge=Pa(new Ci);return X0(u)||(typeof u=="function"?Ge.append(()=>u(J,R,Z,b)):Ge.append("line").call(jn,Je).node()),X0(p)||(typeof p=="function"?Ge.append(()=>p(J,R,Z,b)):Ge.append("circle").call(jn,lt).node()),Ge.node()}},$8={coordinate:{type:"radial",innerRadius:.9,outerRadius:1,startAngle:-11/10*Math.PI,endAngle:1/10*Math.PI},axis:{x:!1},legend:!1,tooltip:!1,encode:{x:"x",y:"y",color:"color"},scale:{color:{range:["#30BF78","#D0D0D0"]}}},oQ={style:{shape:iQ,lineWidth:4,pointerLineCap:"round",pinR:10,pinFill:"#fff",radius:.6}},aQ={type:"text",style:{x:"50%",y:"60%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"}};function sQ(e){if((0,Ft.Z)(e)){const t=Math.max(0,Math.min(e,1));return{percent:t,target:t,total:1}}return e}function lQ(e,t){const{name:n="score",target:r,total:i,percent:s,thresholds:l=[]}=sQ(e),u=s||r,h=s?1:i,p=Object.assign({y:{domain:[0,h]}},t);return l.length?{targetData:[{x:n,y:u,color:"target"}],totalData:l.map((m,y)=>({x:n,y:y>=1?m-l[y-1]:m,color:y})),target:u,total:h,scale:p}:{targetData:[{x:n,y:u,color:"target"}],totalData:[{x:n,y:u,color:"target"},{x:n,y:h-u,color:"total"}],target:u,total:h,scale:p}}function cQ(e,{target:t,total:n}){const{content:r}=e;return r?r(t,n):t.toString()}const K8=e=>{const{data:t={},scale:n={},style:r={},animate:i={},transform:s=[]}=e,l=vw(e,["data","scale","style","animate","transform"]),{targetData:u,totalData:h,target:p,total:m,scale:y}=lQ(t,n),b=po(r,"text"),w=aA(r,["pointer","pin"]),R=po(r,"arc"),M=R.shape;return[ni({},$8,Object.assign({type:"interval",transform:[{type:"stackY"}],data:h,scale:y,style:M==="round"?Object.assign(Object.assign({},R),{shape:rQ}):R,animate:typeof i=="object"?po(i,"arc"):i},l)),ni({},$8,oQ,Object.assign({type:"point",data:u,scale:y,style:w,animate:typeof i=="object"?po(i,"indicator"):i},l)),ni({},aQ,{style:Object.assign({text:cQ(b,{target:p,total:m})},b),animate:typeof i=="object"?po(i,"text"):i})]};K8.props={};const q8=5e3;function Q8(e,t,n){return e+(t-e)*n}function uQ(e,t,n,r){return t===0?[[e+1/2*n/Math.PI/2,r/2],[e+1/2*n/Math.PI,r],[e+n/4,r]]:t===1?[[e+1/2*n/Math.PI/2*(Math.PI-2),r],[e+1/2*n/Math.PI/2*(Math.PI-1),r/2],[e+n/4,0]]:t===2?[[e+1/2*n/Math.PI/2,-r/2],[e+1/2*n/Math.PI,-r],[e+n/4,-r]]:[[e+1/2*n/Math.PI/2*(Math.PI-2),-r],[e+1/2*n/Math.PI/2*(Math.PI-1),-r/2],[e+n/4,0]]}function fQ(e,t,n,r,i,s,l){const u=Math.ceil(2*e/n*4)*4,h=[];let p=r;for(;p<-Math.PI*2;)p+=Math.PI*2;for(;p>0;)p-=Math.PI*2;p=p/Math.PI/2*n;const m=s-e+p-e*2;h.push(["M",m,t]);let y=0;for(let b=0;b<u;++b){const w=b%4,R=uQ(b*n/4,w,n,i);h.push(["C",R[0][0]+m,-R[0][1]+t,R[1][0]+m,-R[1][1]+t,R[2][0]+m,-R[2][1]+t]),b===u-1&&(y=R[2][0])}return h.push(["L",y+m,l+e]),h.push(["L",m,l+e]),h.push(["Z"]),h}function hQ(e,t,n,r,i,s,l,u,h,p,m){const{fill:y,fillOpacity:b,opacity:w}=i;for(let R=0;R<r;R++){const M=r<=1?1:R/(r-1),I=fQ(u,l+u*n,h,0,u/40,e,t),N=m.createElement("path",{style:{d:I,fill:y,opacity:Q8(.2,.9,M)*Number(w||b)}});s.appendChild(N);try{if(p===!1)return;const U=[{transform:"translate(0, 0)"},{transform:`translate(${h*2}, 0)`}];N.animate(U,{duration:Q8(.5*q8,q8,M)*2,iterations:1/0})}catch(U){console.warn("off-screen group animate error!")}}}function dQ(e,t,n){return`
      M ${e} ${t-n} 
      a ${n} ${n} 0 1 0 0 ${n*2}
      a ${n} ${n} 0 1 0 0 ${-n*2}
      Z
    `}function pQ(e,t,n){const i=n*.618;return`
      M ${e-i} ${t-n}
      L ${e+i} ${t-n}
      L ${e+i} ${t+n}
      L ${e-i} ${t+n}
      Z
    `}function mQ(e,t,n){return`
      M ${e} ${t-n}
      L ${e+n} ${t}
      L ${e} ${t+n}
      L ${e-n} ${t}
      Z
    `}function vQ(e,t,n){return`
      M ${e} ${t-n}
      L ${e+n} ${t+n}
      L ${e-n} ${t+n}
      Z
    `}function gQ(e,t,n){const r=n*4/3,i=Math.max(r,n*2),s=r/2,l=e,u=s+t-i/2,h=Math.asin(s/((i-s)*.85)),p=Math.sin(h)*s,m=Math.cos(h)*s,y=l-m,b=u+p,w=e,R=u+s/Math.sin(h);return`
      M ${y} ${b}
      A ${s} ${s} 0 1 1 ${y+m*2} ${b}
      Q ${w} ${R} ${e} ${t+i/2}
      Q ${w} ${R} ${y} ${b}
      Z 
    `}const J8={pin:gQ,rect:pQ,circle:dQ,diamond:mQ,triangle:vQ};var ek=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const yQ=(e="circle")=>J8[e]||J8.circle,tk=(e,t)=>{if(!t)return;const{coordinate:n}=t,{liquidOptions:r,styleOptions:i}=e,{liquidShape:s,percent:l}=r,{background:u,outline:h={},wave:p={}}=i,m=ek(i,["background","outline","wave"]),{border:y=2,distance:b=0}=h,w=ek(h,["border","distance"]),{length:R=192,count:M=3}=p;return(I,N,U)=>{const{document:Z}=t.canvas,{color:Y,fillOpacity:$}=U,J=Object.assign(Object.assign({fill:Y},U),m),se=Z.createElement("g",{}),[pe,Ce]=n.getCenter(),Ue=n.getSize(),Je=Math.min(...Ue)/2,Ge=(Ih(s)?s:yQ(s))(pe,Ce,Je,...Ue);if(Object.keys(u).length){const ft=Z.createElement("path",{style:Object.assign({d:Ge,fill:"#fff"},u)});se.appendChild(ft)}if(l>0){const ft=Z.createElement("path",{style:{d:Ge}});se.appendChild(ft),se.style.clipPath=ft,hQ(pe,Ce,1-l,M,J,se,ft.getBBox().y,Je*2,R,!0,Z)}const at=Z.createElement("path",{style:{d:Ge,fill:"transparent",lineWidth:y+2*b,stroke:"#fff"}}),st=Z.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:Ge,stroke:Y,strokeOpacity:$,lineWidth:y},J),w),{fill:"transparent"})});return se.appendChild(at),se.appendChild(st),se}};tk.props={};var _Q=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const bQ={axis:{x:!1,y:!1},legend:!1,tooltip:!1,encode:{x:"type",y:"percent"},scale:{y:{domain:[0,1]}},style:{shape:tk},animate:{enter:{type:"fadeIn"}}},xQ={type:"text",style:{x:"50%",y:"50%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},animate:{enter:{type:"fadeIn"}}},nk=e=>{const{data:t={},style:n={},animate:r}=e,i=_Q(e,["data","style","animate"]),s=Math.max(0,(0,Ft.Z)(t)?t:t==null?void 0:t.percent),l=[{percent:s,type:"liquid"}],u=Object.assign(Object.assign({},po(n,"text")),po(n,"content")),h=po(n,"outline"),p=po(n,"wave"),m=po(n,"background");return[ni({},bQ,Object.assign({type:"interval",data:l,style:{liquidOptions:{percent:s,liquidShape:n==null?void 0:n.shape},styleOptions:Object.assign(Object.assign({},n),{outline:h,wave:p,background:m})},animate:r},i)),ni({},xQ,{style:Object.assign({text:`${$1(s*100)} %`},u),animate:r})]};nk.props={};var Hv=D(69916);const rk=1e-10;function ik(e,t){const n=SQ(e),r=n.filter(function(h){return EQ(h,e)});let i=0,s=0,l;const u=[];if(r.length>1){const h=TQ(r);for(l=0;l<r.length;++l){const m=r[l];m.angle=Math.atan2(m.x-h.x,m.y-h.y)}r.sort(function(m,y){return y.angle-m.angle});let p=r[r.length-1];for(l=0;l<r.length;++l){const m=r[l];s+=(p.x+m.x)*(m.y-p.y);const y={x:(m.x+p.x)/2,y:(m.y+p.y)/2};let b=null;for(let w=0;w<m.parentIndex.length;++w)if(p.parentIndex.indexOf(m.parentIndex[w])>-1){const R=e[m.parentIndex[w]],M=Math.atan2(m.x-R.x,m.y-R.y),I=Math.atan2(p.x-R.x,p.y-R.y);let N=I-M;N<0&&(N+=2*Math.PI);const U=I-N/2;let Z=C2(y,{x:R.x+R.radius*Math.sin(U),y:R.y+R.radius*Math.cos(U)});Z>R.radius*2&&(Z=R.radius*2),(b===null||b.width>Z)&&(b={circle:R,width:Z,p1:m,p2:p})}b!==null&&(u.push(b),i+=hM(b.circle.radius,b.width),p=m)}}else{let h=e[0];for(l=1;l<e.length;++l)e[l].radius<h.radius&&(h=e[l]);let p=!1;for(l=0;l<e.length;++l)if(C2(e[l],h)>Math.abs(h.radius-e[l].radius)){p=!0;break}p?i=s=0:(i=h.radius*h.radius*Math.PI,u.push({circle:h,p1:{x:h.x,y:h.y+h.radius},p2:{x:h.x-rk,y:h.y+h.radius},width:h.radius*2}))}return s/=2,t&&(t.area=i+s,t.arcArea=i,t.polygonArea=s,t.arcs=u,t.innerPoints=r,t.intersectionPoints=n),i+s}function EQ(e,t){for(let n=0;n<t.length;++n)if(C2(e,t[n])>t[n].radius+rk)return!1;return!0}function SQ(e){const t=[];for(let n=0;n<e.length;++n)for(let r=n+1;r<e.length;++r){const i=ak(e[n],e[r]);for(let s=0;s<i.length;++s){const l=i[s];l.parentIndex=[n,r],t.push(l)}}return t}function hM(e,t){return e*e*Math.acos(1-t/e)-(e-t)*Math.sqrt(t*(2*e-t))}function C2(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function ok(e,t,n){if(n>=e+t)return 0;if(n<=Math.abs(e-t))return Math.PI*Math.min(e,t)*Math.min(e,t);const r=e-(n*n-t*t+e*e)/(2*n),i=t-(n*n-e*e+t*t)/(2*n);return hM(e,r)+hM(t,i)}function ak(e,t){const n=C2(e,t),r=e.radius,i=t.radius;if(n>=r+i||n<=Math.abs(r-i))return[];const s=(r*r-i*i+n*n)/(2*n),l=Math.sqrt(r*r-s*s),u=e.x+s*(t.x-e.x)/n,h=e.y+s*(t.y-e.y)/n,p=-(t.y-e.y)*(l/n),m=-(t.x-e.x)*(l/n);return[{x:u+p,y:h-m},{x:u-p,y:h+m}]}function TQ(e){const t={x:0,y:0};for(let n=0;n<e.length;++n)t.x+=e[n].x,t.y+=e[n].y;return t.x/=e.length,t.y/=e.length,t}function wQ(e,t){t=t||{},t.maxIterations=t.maxIterations||500;const n=t.initialLayout||RQ,r=t.lossFunction||pM;e=AQ(e);const i=n(e,t),s=[],l=[];let u;for(u in i)i.hasOwnProperty(u)&&(s.push(i[u].x),s.push(i[u].y),l.push(u));const p=(0,Hv.nelderMead)(function(m){const y={};for(let b=0;b<l.length;++b){const w=l[b];y[w]={x:m[2*b],y:m[2*b+1],radius:i[w].radius}}return r(y,e)},s,t).x;for(let m=0;m<l.length;++m)u=l[m],i[u].x=p[2*m],i[u].y=p[2*m+1];return i}const sk=1e-10;function dM(e,t,n){return Math.min(e,t)*Math.min(e,t)*Math.PI<=n+sk?Math.abs(e-t):(0,Hv.bisect)(function(r){return ok(e,t,r)-n},0,e+t)}function AQ(e){e=e.slice();const t=[],n={};let r,i,s,l;for(r=0;r<e.length;++r){const u=e[r];u.sets.length==1?t.push(u.sets[0]):u.sets.length==2&&(s=u.sets[0],l=u.sets[1],n[[s,l]]=!0,n[[l,s]]=!0)}for(t.sort((u,h)=>u>h?1:-1),r=0;r<t.length;++r)for(s=t[r],i=r+1;i<t.length;++i)l=t[i],[s,l]in n||e.push({sets:[s,l],size:0});return e}function CQ(e,t,n){const r=(0,Hv.zerosM)(t.length,t.length),i=(0,Hv.zerosM)(t.length,t.length);return e.filter(function(s){return s.sets.length==2}).map(function(s){const l=n[s.sets[0]],u=n[s.sets[1]],h=Math.sqrt(t[l].size/Math.PI),p=Math.sqrt(t[u].size/Math.PI),m=dM(h,p,s.size);r[l][u]=r[u][l]=m;let y=0;s.size+1e-10>=Math.min(t[l].size,t[u].size)?y=1:s.size<=1e-10&&(y=-1),i[l][u]=i[u][l]=y}),{distances:r,constraints:i}}function OQ(e,t,n,r){let i=0,s;for(s=0;s<t.length;++s)t[s]=0;for(s=0;s<n.length;++s){const l=e[2*s],u=e[2*s+1];for(let h=s+1;h<n.length;++h){const p=e[2*h],m=e[2*h+1],y=n[s][h],b=r[s][h],w=(p-l)*(p-l)+(m-u)*(m-u),R=Math.sqrt(w),M=w-y*y;b>0&&R<=y||b<0&&R>=y||(i+=2*M*M,t[2*s]+=4*M*(l-p),t[2*s+1]+=4*M*(u-m),t[2*h]+=4*M*(p-l),t[2*h+1]+=4*M*(m-u))}}return i}function RQ(e,t){let n=PQ(e,t);const r=t.lossFunction||pM;if(e.length>=8){const i=MQ(e,t),s=r(i,e),l=r(n,e);s+1e-8<l&&(n=i)}return n}function MQ(e,t){t=t||{};const n=t.restarts||10,r=[],i={};let s;for(s=0;s<e.length;++s){const M=e[s];M.sets.length==1&&(i[M.sets[0]]=r.length,r.push(M))}const l=CQ(e,r,i);let u=l.distances;const h=l.constraints,p=(0,Hv.norm2)(u.map(Hv.norm2))/u.length;u=u.map(function(M){return M.map(function(I){return I/p})});const m=function(M,I){return OQ(M,I,u,h)};let y,b;for(s=0;s<n;++s){const M=(0,Hv.zeros)(u.length*2).map(Math.random);b=(0,Hv.conjugateGradient)(m,M,t),(!y||b.fx<y.fx)&&(y=b)}const w=y.x,R={};for(s=0;s<r.length;++s){const M=r[s];R[M.sets[0]]={x:w[2*s]*p,y:w[2*s+1]*p,radius:Math.sqrt(M.size/Math.PI)}}if(t.history)for(s=0;s<t.history.length;++s)(0,Hv.scale)(t.history[s].x,p);return R}function PQ(e,t){const n=t&&t.lossFunction?t.lossFunction:pM,r={},i={};let s;for(let y=0;y<e.length;++y){const b=e[y];b.sets.length==1&&(s=b.sets[0],r[s]={x:1e10,y:1e10,rowid:Object.keys(r).length,size:b.size,radius:Math.sqrt(b.size/Math.PI)},i[s]=[])}e=e.filter(function(y){return y.sets.length==2});for(let y=0;y<e.length;++y){const b=e[y];let w=b.hasOwnProperty("weight")?b.weight:1;const R=b.sets[0],M=b.sets[1];b.size+sk>=Math.min(r[R].size,r[M].size)&&(w=0),i[R].push({set:M,size:b.size,weight:w}),i[M].push({set:R,size:b.size,weight:w})}const l=[];for(s in i)if(i.hasOwnProperty(s)){let y=0;for(let b=0;b<i[s].length;++b)y+=i[s][b].size*i[s][b].weight;l.push({set:s,size:y})}function u(y,b){return b.size-y.size}l.sort(u);const h={};function p(y){return y.set in h}function m(y,b){r[b].x=y.x,r[b].y=y.y,h[b]=!0}m({x:0,y:0},l[0].set);for(let y=1;y<l.length;++y){const b=l[y].set,w=i[b].filter(p);if(s=r[b],w.sort(u),w.length===0)throw"ERROR: missing pairwise overlap information";const R=[];for(let N=0;N<w.length;++N){const U=r[w[N].set],Z=dM(s.radius,U.radius,w[N].size);R.push({x:U.x+Z,y:U.y}),R.push({x:U.x-Z,y:U.y}),R.push({y:U.y+Z,x:U.x}),R.push({y:U.y-Z,x:U.x});for(let Y=N+1;Y<w.length;++Y){const $=r[w[Y].set],J=dM(s.radius,$.radius,w[Y].size),se=ak({x:U.x,y:U.y,radius:Z},{x:$.x,y:$.y,radius:J});for(let pe=0;pe<se.length;++pe)R.push(se[pe])}}let M=1e50,I=R[0];for(let N=0;N<R.length;++N){r[b].x=R[N].x,r[b].y=R[N].y;const U=n(r,e);U<M&&(M=U,I=R[N])}m(I,b)}return r}function pM(e,t){let n=0;function r(i){return i.map(function(s){return e[s]})}for(let i=0;i<t.length;++i){const s=t[i];let l;if(s.sets.length==1)continue;if(s.sets.length==2){const h=e[s.sets[0]],p=e[s.sets[1]];l=ok(h.radius,p.radius,C2(h,p))}else l=ik(r(s.sets));const u=s.hasOwnProperty("weight")?s.weight:1;n+=u*(l-s.size)*(l-s.size)}return n}function IQ(e,t,n){n===null?e.sort(function(i,s){return s.radius-i.radius}):e.sort(n);let r;if(e.length>0){const i=e[0].x,s=e[0].y;for(r=0;r<e.length;++r)e[r].x-=i,e[r].y-=s}if(e.length==2&&distance(e[0],e[1])<Math.abs(e[1].radius-e[0].radius)&&(e[1].x=e[0].x+e[0].radius-e[1].radius-1e-10,e[1].y=e[0].y),e.length>1){const i=Math.atan2(e[1].x,e[1].y)-t;let s,l;const u=Math.cos(i),h=Math.sin(i);for(r=0;r<e.length;++r)s=e[r].x,l=e[r].y,e[r].x=u*s-h*l,e[r].y=h*s+u*l}if(e.length>2){let i=Math.atan2(e[2].x,e[2].y)-t;for(;i<0;)i+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI;if(i>Math.PI){const s=e[1].y/(1e-10+e[1].x);for(r=0;r<e.length;++r){const l=(e[r].x+s*e[r].y)/(1+s*s);e[r].x=2*l-e[r].x,e[r].y=2*l*s-e[r].y}}}}function LQ(e){e.map(function(l){l.parent=l});function t(l){return l.parent!==l&&(l.parent=t(l.parent)),l.parent}function n(l,u){const h=t(l),p=t(u);h.parent=p}for(let l=0;l<e.length;++l)for(let u=l+1;u<e.length;++u){const h=e[l].radius+e[u].radius;distance(e[l],e[u])+1e-10<h&&n(e[u],e[l])}const r={};let i;for(let l=0;l<e.length;++l)i=t(e[l]).parent.setid,i in r||(r[i]=[]),r[i].push(e[l]);e.map(function(l){delete l.parent});const s=[];for(i in r)r.hasOwnProperty(i)&&s.push(r[i]);return s}function mM(e){const t=function(n){const r=Math.max.apply(null,e.map(function(s){return s[n]+s.radius})),i=Math.min.apply(null,e.map(function(s){return s[n]-s.radius}));return{max:r,min:i}};return{xRange:t("x"),yRange:t("y")}}function tne(e,t,n){t===null&&(t=Math.PI/2);let r=[],i,s;for(s in e)if(e.hasOwnProperty(s)){const b=e[s];r.push({x:b.x,y:b.y,radius:b.radius,setid:s})}const l=LQ(r);for(i=0;i<l.length;++i){IQ(l[i],t,n);const b=mM(l[i]);l[i].size=(b.xRange.max-b.xRange.min)*(b.yRange.max-b.yRange.min),l[i].bounds=b}l.sort(function(b,w){return w.size-b.size}),r=l[0];let u=r.bounds;const h=(u.xRange.max-u.xRange.min)/50;function p(b,w,R){if(!b)return;const M=b.bounds;let I,N,U;w?I=u.xRange.max-M.xRange.min+h:(I=u.xRange.max-M.xRange.max,U=(M.xRange.max-M.xRange.min)/2-(u.xRange.max-u.xRange.min)/2,U<0&&(I+=U)),R?N=u.yRange.max-M.yRange.min+h:(N=u.yRange.max-M.yRange.max,U=(M.yRange.max-M.yRange.min)/2-(u.yRange.max-u.yRange.min)/2,U<0&&(N+=U));for(let Z=0;Z<b.length;++Z)b[Z].x+=I,b[Z].y+=N,r.push(b[Z])}let m=1;for(;m<l.length;)p(l[m],!0,!1),p(l[m+1],!1,!0),p(l[m+2],!0,!0),m+=3,u=mM(r);const y={};for(i=0;i<r.length;++i)y[r[i].setid]=r[i];return y}function DQ(e,t,n,r){const i=[],s=[];for(const M in e)e.hasOwnProperty(M)&&(s.push(M),i.push(e[M]));t-=2*r,n-=2*r;const l=mM(i),u=l.xRange,h=l.yRange;if(u.max==u.min||h.max==h.min)return console.log("not scaling solution: zero size detected"),e;const p=t/(u.max-u.min),m=n/(h.max-h.min),y=Math.min(m,p),b=(t-(u.max-u.min)*y)/2,w=(n-(h.max-h.min)*y)/2,R={};for(let M=0;M<i.length;++M){const I=i[M];R[s[M]]={radius:y*I.radius,x:r+b+(I.x-u.min)*y,y:r+w+(I.y-h.min)*y}}return R}function NQ(e,t,n){const r=[],i=e-n,s=t;return r.push("M",i,s),r.push("A",n,n,0,1,0,i+2*n,s),r.push("A",n,n,0,1,0,i,s),r.join(" ")}function BQ(e){const t={};ik(e,t);const n=t.arcs;if(n.length===0)return"M 0 0";if(n.length==1){const r=n[0].circle;return NQ(r.x,r.y,r.radius)}else{const r=[`
M`,n[0].p2.x,n[0].p2.y];for(let i=0;i<n.length;++i){const s=n[i],l=s.circle.radius,u=s.width>l;r.push(`
A`,l,l,0,u?1:0,1,s.p1.x,s.p1.y)}return r.join(" ")}}const lk=e=>{const{sets:t="sets",size:n="size",as:r=["key","path"],padding:i=0}=e,[s,l]=r;return u=>{const h=u.map(y=>Object.assign(Object.assign({},y),{sets:y[t],size:y[n],[s]:y.sets.join("&")}));h.sort((y,b)=>y.sets.length-b.sets.length);const p=wQ(h);let m;return h.map(y=>{const b=y[t],w=({width:R,height:M})=>{m=m||DQ(p,R,M,i);const I=b.map(U=>m[U]);let N=BQ(I);return/[zZ]$/.test(N)||(N+=" Z"),N};return Object.assign(Object.assign({},y),{[l]:w})})}};lk.props={};function FQ(){return{"data.venn":lk,"mark.boxplot":X8,"mark.gauge":K8,"mark.wordCloud":E3,"mark.liquid":nk}}function kQ(){return Object.assign(Object.assign(Object.assign(Object.assign({},$$()),Qq()),FQ()),WY())}var gw=function(){return gw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},gw.apply(this,arguments)},zQ=xj(bj,gw(gw({},kQ()),oV())),vM=D(73505),O2=function(){return O2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},O2.apply(this,arguments)},UQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},jQ=["renderer"],ck=["width","height","autoFit","theme","inset","insetLeft","insetRight","insetTop","insetBottom","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","depth","title","clip","children","type","data","direction"],gM="__transform__",VQ="__skipDelCustomKeys__",S1=function(e,t){return(0,vM.Z)(t)?{type:e,available:t}:O2({type:e},t)},yM={xField:"encode.x",yField:"encode.y",colorField:"encode.color",angleField:"encode.y",keyField:"encode.key",sizeField:"encode.size",shapeField:"encode.shape",seriesField:"encode.series",positionField:"encode.position",textField:"encode.text",valueField:"encode.value",binField:"encode.x",srcField:"encode.src",linkColorField:"encode.linkColor",fontSizeField:"encode.fontSize",radius:"coordinate.outerRadius",innerRadius:"coordinate.innerRadius",startAngle:"coordinate.startAngle",endAngle:"coordinate.endAngle",focusX:"coordinate.focusX",focusY:"coordinate.focusY",distortionX:"coordinate.distortionX",distortionY:"coordinate.distortionY",visual:"coordinate.visual",stack:{target:"transform",value:function(e){return S1("stackY",e)}},normalize:{target:"transform",value:function(e){return S1("normalizeY",e)}},percent:{target:"transform",value:function(e){return S1("normalizeY",e)}},group:{target:"transform",value:function(e){return S1("dodgeX",e)}},sort:{target:"transform",value:function(e){return S1("sortX",e)}},symmetry:{target:"transform",value:function(e){return S1("symmetryY",e)}},diff:{target:"transform",value:function(e){return S1("diffY",e)}},meta:{target:"scale",value:function(e){return e}},label:{target:"labels",value:function(e){return e}},shape:"style.shape",connectNulls:{target:"style",value:function(e){return(0,vM.Z)(e)?{connect:e}:e}}},_M=["xField","yField","seriesField","colorField","keyField","positionField","meta","tooltip","animate","stack","normalize","percent","group","sort","symmetry","diff"],yw=[{key:"annotations",extend_keys:[]},{key:"line",type:"line",extend_keys:_M},{key:"point",type:"point",extend_keys:_M},{key:"area",type:"area",extend_keys:_M}],HQ=[{key:"transform",callback:function(e,t,n){var r;e[t]=e[t]||[];var i=n.available,s=i===void 0?!0:i,l=UQ(n,["available"]);if(s)e[t].push(O2((r={},r[gM]=!0,r),l));else{var u=e[t].indexOf(function(h){return h.type===n.type});u!==-1&&e[t].splice(u,1)}}},{key:"labels",callback:function(e,t,n){var r;if(!n||(0,Ot.Z)(n)){e[t]=n||[];return}n.text||(n.text=e.yField),e[t]=e[t]||[],e[t].push(O2((r={},r[gM]=!0,r),n))}}],bM=[{key:"conversionTag",shape:"ConversionTag"},{key:"axisText",shape:"BidirectionalBarAxisText"}],ZQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_w=function(){return _w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},_w.apply(this,arguments)},WQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},GQ=function(e){ZQ(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=WQ(n,["style"]);return e.call(this,_w({style:_w({fill:"#eee"},r)},i))||this}return t}(Aa),XQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),bw=function(){return bw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},bw.apply(this,arguments)},YQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},uk=function(e){XQ(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=YQ(n,["style"]);return e.call(this,bw({style:bw({text:"",fontSize:12,textBaseline:"middle",textAlign:"center",fill:"#000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1},r)},i))||this}return t}(ma),$Q=D(19177),fk=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},KQ=function(e,t){if((0,Ot.Z)(t))return t},Qg=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return $Q.Z.apply(void 0,fk(fk([],e,!1),[KQ],!1))},qQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hk=function(e){qQ(t,e);function t(n,r,i){var s=e.call(this,{style:Qg(i,r)})||this;return s.chart=n,s}return t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this)},t.prototype.disconnectedCallback=function(){},t.prototype.attributeChangedCallback=function(n){},t.prototype.update=function(n,r){var i;return this.attr(Qg({},this.attributes,n||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},t.prototype.clear=function(){this.removeChildren()},t.prototype.getElementsLayout=function(){var n=this.chart.getContext().canvas,r=n.document.getElementsByClassName("element"),i=[];return r.forEach(function(s){var l=s.getBBox(),u=l.x,h=l.y,p=l.width,m=l.height,y=s.__data__;i.push({bbox:l,x:u,y:h,width:p,height:m,key:y.key,data:y})}),i},t.prototype.bindEvents=function(n,r){},t}(Xr),QQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),xw=function(){return xw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},xw.apply(this,arguments)},JQ=function(e){QQ(t,e);function t(n,r){return e.call(this,n,r,{type:t.tag})||this}return t.prototype.getConversionTagLayout=function(){var n=this.direction==="vertical",r=this.getElementsLayout(),i=r[0],s=i.x,l=i.y,u=i.height,h=i.width,p=i.data,m=["items",0,"value"],y=(0,on.Z)(p,m),b=n?r[1].y-l-u:r[1].x-s-h,w=[],R=this.attributes,M=R.size,I=M===void 0?40:M,N=R.arrowSize,U=N===void 0?20:N,Z=R.spacing,Y=Z===void 0?4:Z;return r.forEach(function($,J){if(J>0){var se=$.x,pe=$.y,Ce=$.height,Ue=$.width,Je=$.data,lt=$.key,Ge=(0,on.Z)(Je,m),at=I/2;if(n){var st=se+Ue/2,ft=pe;w.push({points:[[st+at,ft-b+Y],[st+at,ft-U-Y],[st,ft-Y],[st-at,ft-U-Y],[st-at,ft-b+Y]],center:[st,ft-b/2-Y],width:b,value:[y,Ge],key:lt})}else{var st=se,ft=pe+Ce/2;w.push({points:[[se-b+Y,ft-at],[se-U-Y,ft-at],[st-Y,ft],[se-U-Y,ft+at],[se-b+Y,ft+at]],center:[st-b/2-Y,ft],width:b,value:[y,Ge],key:lt})}y=Ge}}),w},t.prototype.render=function(){this.setDirection(),this.drawConversionTag()},t.prototype.setDirection=function(){var n=this.chart.getCoordinate(),r=(0,on.Z)(n,"options.transformations"),i="horizontal";r.forEach(function(s){s.includes("transpose")&&(i="vertical")}),this.direction=i},t.prototype.drawConversionTag=function(){var n=this,r=this.getConversionTagLayout(),i=this.attributes,s=i.style,l=i.text,u=l.style,h=l.formatter;r.forEach(function(p){var m=p.points,y=p.center,b=p.value,w=p.key,R=b[0],M=b[1],I=y[0],N=y[1],U=new GQ({style:xw({points:m,fill:"#eee"},s),id:"polygon-".concat(w)}),Z=new uk({style:xw({x:I,y:N,text:(0,Qe.Z)(h)?h(R,M):(M/R*100).toFixed(2)+"%"},u),id:"text-".concat(w)});n.appendChild(U),n.appendChild(Z)})},t.prototype.update=function(){var n=this,r=this.getConversionTagLayout();r.forEach(function(i){var s=i.points,l=i.center,u=i.key,h=l[0],p=l[1],m=n.getElementById("polygon-".concat(u)),y=n.getElementById("text-".concat(u));m.setAttribute("points",s),y.setAttribute("x",h),y.setAttribute("y",p)})},t.tag="ConversionTag",t}(hk),xM=D(87783),dk=D(15643),EM=32,pk=16,mk=48,eJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),R2=function(){return R2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},R2.apply(this,arguments)},tJ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},nJ=function(e){eJ(t,e);function t(n,r){return e.call(this,n,r,{type:t.tag})||this}return t.prototype.render=function(){this.drawText()},t.prototype.getBidirectionalBarAxisTextLayout=function(){var n=this.attributes.layout,r=n==="vertical",i=this.getElementsLayout(),s=r?(0,xM.Z)(i,"x"):(0,xM.Z)(i,"y"),l=["title"],u=[],h=this.chart.getContext().views,p=(0,on.Z)(h,[0,"layout"]),m=p.width,y=p.height;return s.forEach(function(b){var w=b.x,R=b.y,M=b.height,I=b.width,N=b.data,U=b.key,Z=(0,on.Z)(N,l);r?u.push({x:w+I/2,y,text:Z,key:U}):u.push({x:m,y:R+M/2,text:Z,key:U})}),(0,xM.Z)(u,"text").length!==u.length&&(u=Object.values((0,dk.Z)(u,"text")).map(function(b){var w,R=b.reduce(function(M,I){return M+(r?I.x:I.y)},0);return R2(R2({},b[0]),(w={},w[r?"x":"y"]=R/b.length,w))})),u},t.prototype.transformLabelStyle=function(n){var r={},i=/^label[A-Z]/;return Object.keys(n).forEach(function(s){i.test(s)&&(r[s.replace("label","").replace(/^[A-Z]/,function(l){return l.toLowerCase()})]=n[s])}),r},t.prototype.drawText=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout(),i=this.attributes,s=i.layout,l=i.labelFormatter,u=tJ(i,["layout","labelFormatter"]);r.forEach(function(h){var p=h.x,m=h.y,y=h.text,b=h.key,w=new uk({style:R2({x:p,y:m,text:(0,Qe.Z)(l)?l(y):y,wordWrap:!0,wordWrapWidth:s==="horizontal"?EM*2:120,maxLines:2,textOverflow:"ellipsis"},n.transformLabelStyle(u)),id:"text-".concat(b)});n.appendChild(w)})},t.prototype.update=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout();r.forEach(function(i){var s=i.x,l=i.y,u=i.key,h=n.getElementById("text-".concat(u));h.setAttribute("x",s),h.setAttribute("y",l)})},t.tag="BidirectionalBarAxisText",t}(hk),rJ={ConversionTag:JQ,BidirectionalBarAxisText:nJ},iJ=function(){function e(t,n){this.container=new Map,this.chart=t,this.config=n,this.init()}return e.prototype.init=function(){var t=this;bM.forEach(function(n){var r,i=n.key,s=n.shape,l=t.config[i];if(l){var u=new rJ[s](t.chart,l),h=t.chart.getContext().canvas;h.appendChild(u),t.container.set(i,u)}else(r=t.container.get(i))===null||r===void 0||r.clear()})},e.prototype.update=function(){var t=this;this.container.size&&bM.forEach(function(n){var r=n.key,i=t.container.get(r);i==null||i.update()})},e}(),vk=D(69441),oJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),eb=function(){return eb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},eb.apply(this,arguments)},gk="data-chart-source-type",Tl=function(e){oJ(t,e);function t(n,r){var i=e.call(this)||this;return i.container=typeof n=="string"?document.getElementById(n):n,i.options=i.mergeOption(r),i.createG2(),i.bindEvents(),i}return t.prototype.getChartOptions=function(){return eb(eb({},(0,vk.Z)(this.options,jQ)),{container:this.container})},t.prototype.getSpecOptions=function(){return this.type==="base"||this[VQ]?eb(eb({},this.options),this.getChartOptions()):this.options},t.prototype.createG2=function(){if(!this.container)throw Error("The container is not initialized!");this.chart=new zQ(this.getChartOptions()),this.container.setAttribute(gk,"Ant Design Charts")},t.prototype.bindEvents=function(){var n=this;this.chart&&this.chart.on("*",function(r){r!=null&&r.type&&n.emit(r.type,r)})},t.prototype.getBaseOptions=function(){return{type:"view",autoFit:!0}},t.prototype.getDefaultOptions=function(){},t.prototype.render=function(){var n=this;this.type!=="base"&&this.execAdaptor(),this.chart.options(this.getSpecOptions()),this.chart.render().then(function(){n.annotation=new iJ(n.chart,n.options)}),this.bindSizeSensor()},t.prototype.update=function(n){this.options=this.mergeOption(n)},t.prototype.mergeOption=function(n){return Qg({},this.getBaseOptions(),this.getDefaultOptions(),n)},t.prototype.changeData=function(n){this.chart.changeData(n)},t.prototype.changeSize=function(n,r){this.chart.changeSize(n,r)},t.prototype.destroy=function(){this.chart.destroy(),this.off(),this.container.removeAttribute(gk)},t.prototype.execAdaptor=function(){var n=this.getSchemaAdaptor();n({chart:this.chart,options:this.options})},t.prototype.triggerResize=function(){this.chart.forceFit()},t.prototype.bindSizeSensor=function(){var n=this,r=this.options.autoFit,i=r===void 0?!0:r;i&&this.chart.on(El.AFTER_CHANGE_SIZE,function(){n.annotation.update()})},t}(_n),aJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sJ=function(e){aJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="base",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"line"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return function(n){return n}},t}(Tl),Ll=D(99503),lJ=function(e){var t=e.options,n=t.children,r=n===void 0?[]:n;return r.forEach(function(i){Object.keys(i).forEach(function(s){(0,Ot.Z)(i[s])&&s!=="data"&&(i[s]=i[s].filter(function(l){return!l[gM]}))})}),t},SM=D(32180),cJ=D(49360),Ba=D(48707),yk=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},uJ=function(e){var t=e.children,n=t===void 0?[]:t,r=Object.keys(yM).concat(yw.map(function(i){return i.key}));return r.forEach(function(i){delete e[i]}),n.forEach(function(i){Object.keys(i).forEach(function(s){r.includes(s)&&delete i[s]})}),Object.keys(e).forEach(function(i){yk(yk([],ck,!0),bM.map(function(s){return s.key}),!0).includes(i)||delete e[i]}),e},Zl=function(e){var t=lJ(e),n=t.children,r=n===void 0?[]:n,i=(0,SM.Z)(t,[].concat(ck,yw.map(function(p){return p.key}))),s=function(p){var m;return(m=HQ.find(function(y){return y.key===p}))===null||m===void 0?void 0:m.callback},l=function(p,m,y){var b=s(m);b?b(p,m,y):p[m]=Qg({},p[m],y)},u=function(p){Object.keys(p).forEach(function(m){if(p[m]){var y=yw.find(function(R){return R.key===m});if(y){var b=y.type,w=y.extend_keys;b?r.push(h(Qg({},(0,vk.Z)(p,w),{type:b},p[m]))):(0,Ot.Z)(p[m])&&p[m].forEach(function(R){r.push(h(R))})}}})},h=function(p){return u(p),Object.keys(yM).forEach(function(m){var y=yM[m];if(!(0,cJ.Z)(p[m]))if((0,vt.Z)(y)){var b=y.value,w=y.target,R=b(p[m]);l(p,w,R)}else(0,Ba.Z)(p,y,p[m])}),p};return r.forEach(function(p){var m=Qg({},i,p);h(Qg(p,m))}),u(t),uJ(t),e},TM=function(){return TM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},TM.apply(this,arguments)};function fJ(e){var t=e.options,n=t.stack,r=t.tooltip,i=t.xField;if(!n)return e;var s=yw.map(function(u){return u.type}).filter(function(u){return!!u}),l=!1;return s.forEach(function(u){t[u]&&(l=!0,(0,Ba.Z)(t,[u,"stack"],TM({y1:"y"},typeof n=="object"?n:{})))}),l&&!(0,vM.Z)(r)&&!r&&(0,Ba.Z)(t,"tooltip",{title:i,items:[{channel:"y"}]}),e}function Au(e){return(0,Ll.Z)(fJ)(e)}function hJ(e){return(0,Ll.Z)(Au,Zl)(e)}var dJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pJ=function(e){dJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="area",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"area"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return hJ},t}(Tl),tb=function(){return tb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},tb.apply(this,arguments)};function _k(e){var t=function(n){var r=n.options;(0,on.Z)(r,"children.length")>1&&(0,Ba.Z)(r,"children",[{type:"interval"}]);var i=r.scale,s=r.markBackground,l=r.data,u=r.children,h=r.yField,p=(0,on.Z)(i,"y.domain",[]);if(s&&p.length&&(0,Ot.Z)(l)){var m="domainMax",y=l.map(function(b){var w;return tb(tb({originData:tb({},b)},(0,SM.Z)(b,h)),(w={},w[m]=p[p.length-1],w))});u.unshift(tb({type:"interval",data:y,yField:m,tooltip:!1,style:{fill:"#eee"},label:!1},s))}return n};return(0,Ll.Z)(t,Au,Zl)(e)}var mJ=function(){var e=function(t,n){return function(r){var i=t.fill,s=i===void 0?"#2888FF":i,l=t.stroke,u=t.fillOpacity,h=u===void 0?1:u,p=t.strokeOpacity,m=p===void 0?.2:p,y=t.pitch,b=y===void 0?8:y,w=r[0],R=r[1],M=r[2],I=r[3],N=(R[1]-w[1])/2,U=n.document,Z=U.createElement("g",{}),Y=U.createElement("polygon",{style:{points:[w,[w[0]-b,w[1]+N],[M[0]-b,w[1]+N],I],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m,inset:30}}),$=U.createElement("polygon",{style:{points:[[w[0]-b,w[1]+N],R,M,[M[0]-b,w[1]+N]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m}}),J=U.createElement("polygon",{style:{points:[w,[w[0]-b,w[1]+N],R,[w[0]+b,w[1]+N]],fill:s,fillOpacity:h-.2}});return Z.appendChild(Y),Z.appendChild($),Z.appendChild(J),Z}};Ow("shape.interval.bar25D",e)},vJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();mJ();var gJ=function(e){vJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Bar",n}return t.getDefaultOptions=function(){return{type:"view",coordinate:{transform:[{type:"transpose"}]},children:[{type:"interval"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return _k},t}(Tl),yJ=function(){var e=function(t,n){return function(r){var i=t.fill,s=i===void 0?"#2888FF":i,l=t.stroke,u=t.fillOpacity,h=u===void 0?1:u,p=t.strokeOpacity,m=p===void 0?.2:p,y=t.pitch,b=y===void 0?8:y,w=r[1][0]-r[0][0],R=w/2+r[0][0],M=n.document,I=M.createElement("g",{}),N=M.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[R,r[1][1]+b],[R,r[3][1]+b],[r[3][0],r[3][1]]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m,inset:30}}),U=M.createElement("polygon",{style:{points:[[R,r[1][1]+b],[r[1][0],r[1][1]],[r[2][0],r[2][1]],[R,r[2][1]+b]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m}}),Z=M.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[R,r[1][1]-b],[r[1][0],r[1][1]],[R,r[1][1]+b]],fill:s,fillOpacity:h-.2}});return I.appendChild(U),I.appendChild(N),I.appendChild(Z),I}};Ow("shape.interval.column25D",e)},_J=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();yJ();var bJ=function(e){_J(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="column",n}return t.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return _k},t}(Tl);function xJ(e){var t=function(r){var i=r.options,s=i.children,l=s===void 0?[]:s,u=i.legend;return u&&l.forEach(function(h){if(!(0,on.Z)(h,"colorField")){var p=(0,on.Z)(h,"yField");(0,Ba.Z)(h,"colorField",function(){return p})}}),r},n=function(r){var i=r.options,s=i.annotations,l=s===void 0?[]:s,u=i.children,h=u===void 0?[]:u,p=i.scale,m=!1;return(0,on.Z)(p,"y.key")||h.forEach(function(y,b){if(!(0,on.Z)(y,"scale.y.key")){var w="child".concat(b,"Scale");(0,Ba.Z)(y,"scale.y.key",w);var R=y.annotations,M=R===void 0?[]:R;M.length>0&&((0,Ba.Z)(y,"scale.y.independent",!1),M.forEach(function(I){(0,Ba.Z)(I,"scale.y.key",w)})),!m&&l.length>0&&(0,on.Z)(y,"scale.y.independent")===void 0&&(m=!0,(0,Ba.Z)(y,"scale.y.independent",!1),l.forEach(function(I){(0,Ba.Z)(I,"scale.y.key",w)}))}}),r};return(0,Ll.Z)(t,n,Au,Zl)(e)}var EJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),bk=function(e){EJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="DualAxes",n}return t.getDefaultOptions=function(){return{type:"view",axis:{y:{title:!1,tick:!1},x:{title:!1}},scale:{y:{independent:!0,nice:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return xJ},t}(Tl);function SJ(e){var t=function(s){var l=s.options,u=l.xField,h=l.colorField;return h||(0,Ba.Z)(l,"colorField",u),s},n=function(s){var l=s.options,u=l.compareField,h=l.transform,p=l.isTransposed,m=p===void 0?!0:p,y=l.coordinate;return h||(u?(0,Ba.Z)(l,"transform",[]):(0,Ba.Z)(l,"transform",[{type:"symmetryY"}])),!y&&m&&(0,Ba.Z)(l,"coordinate",{transform:[{type:"transpose"}]}),s},r=function(s){var l=s.options,u=l.compareField,h=l.seriesField,p=l.data,m=l.children,y=l.yField,b=l.isTransposed,w=b===void 0?!0:b;if(u||h){var R=Object.values((0,dk.Z)(p,function(M){return M[u||h]}));m[0].data=R[0],m.push({type:"interval",data:R[1],yField:function(M){return-M[y]}}),delete l.compareField,delete l.data}return h&&((0,Ba.Z)(l,"type","spaceFlex"),(0,Ba.Z)(l,"ratio",[1,1]),(0,Ba.Z)(l,"direction",w?"row":"col"),delete l.seriesField),s},i=function(s){var l=s.options,u=l.tooltip,h=l.xField,p=l.yField;return u||(0,Ba.Z)(l,"tooltip",{title:!1,items:[function(m){return{name:m[h],value:m[p]}}]}),s};return(0,Ll.Z)(t,n,r,i,Au,Zl)(e)}var TJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),wJ=function(e){TJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="column",n}return t.getDefaultOptions=function(){return{type:"view",scale:{x:{padding:0}},animate:{enter:{type:"fadeIn"}},axis:!1,shapeField:"funnel",label:{position:"inside",transform:[{type:"contrastReverse"}]},children:[{type:"interval"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return SJ},t}(Tl);function AJ(e){return(0,Ll.Z)(Au,Zl)(e)}var CJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),OJ=function(e){CJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="line",n}return t.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"line"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return AJ},t}(Tl);function M2(e){switch(typeof e){case"function":return e;case"string":return function(t){return(0,on.Z)(t,[e])};default:return function(){return e}}}var Jg=function(){return Jg=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Jg.apply(this,arguments)};function RJ(e){var t=function(n){var r=n.options,i=r.angleField,s=r.data,l=r.label,u=r.tooltip,h=r.colorField,p=M2(h);if((0,Ot.Z)(s)){var m=s.reduce(function(b,w){return b+w[i]},0);if(m===0){var y=s.map(function(b){var w;return Jg(Jg({},b),(w={},w[i]=1,w))});(0,Ba.Z)(r,"data",y),l&&(0,Ba.Z)(r,"label",Jg(Jg({},l),{formatter:function(){return 0}})),u!==!1&&(0,Ba.Z)(r,"tooltip",Jg(Jg({},u),{items:[function(b,w,R){return{name:p(b,w,R),value:0}}]}))}}return n};return(0,Ll.Z)(t,Zl)(e)}var MJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),PJ=function(e){MJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="pie",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"theta"},transform:[{type:"stackY",reverse:!0}],animate:{enter:{type:"waveIn"}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return RJ},t}(Tl);function IJ(e){return(0,Ll.Z)(Au,Zl)(e)}var LJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),DJ=function(e){LJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="scatter",n}return t.getDefaultOptions=function(){return{axis:{y:{title:!1},x:{title:!1}},legend:{size:!1},children:[{type:"point"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return IJ},t}(Tl);function NJ(e){var t=function(n){return(0,Ba.Z)(n,"options.coordinate",{type:(0,on.Z)(n,"options.coordinateType","polar")}),n};return(0,Ll.Z)(t,Zl)(e)}var BJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),FJ=function(e){BJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="radar",n}return t.getDefaultOptions=function(){return{axis:{x:{grid:!0,line:!0},y:{zIndex:1,title:!1,line:!0,nice:!0}},meta:{x:{padding:.5,align:0}},interaction:{tooltip:{style:{crosshairsLineDash:[4,4]}}},children:[{type:"line"}],coordinateType:"polar"}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return NJ},t}(Tl),nb=D(43836),Zv=function(){return Zv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Zv.apply(this,arguments)},kJ="__stock-range__",zJ="trend",UJ="up",jJ="down";function VJ(e){var t=function(r){var i=r.options,s=i.data,l=i.yField;return r.options.data=(0,nb.Z)(s,function(u){var h=u&&Zv({},u);if(Array.isArray(l)&&h){var p=l[0],m=l[1],y=l[2],b=l[3];h[zJ]=h[p]<=h[m]?UJ:jJ,h[kJ]=[h[p],h[m],h[y],h[b]]}return h}),r},n=function(r){var i=r.options,s=i.xField,l=i.yField,u=i.fallingFill,h=i.risingFill,p=l[0],m=l[1],y=l[2],b=l[3],w=M2(s);return r.options.children=(0,nb.Z)(r.options.children,function(R,M){var I=M===0;return Zv(Zv({},R),{tooltip:{title:function(N,U,Z){var Y=w(N,U,Z);return Y instanceof Date?Y.toLocaleString():Y},items:[{field:y},{field:b},{field:p},{field:m}]},encode:Zv(Zv({},R.encode||{}),{y:I?[y,b]:[p,m],color:function(N){return Math.sign(N[m]-N[p])}}),style:Zv(Zv({},R.style||{}),{lineWidth:I?1:10})})}),delete i.yField,r.options.legend={color:!1},u&&(0,Ba.Z)(r,"options.scale.color.range[0]",u),h&&(0,Ba.Z)(r,"options.scale.color.range[2]",h),r};return(0,Ll.Z)(t,n,Zl)(e)}var HJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ZJ=["#26a69a","#999999","#ef5350"],WJ=function(e){HJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="stock",n}return t.getDefaultOptions=function(){return{type:"view",scale:{color:{domain:[-1,0,1],range:ZJ},y:{nice:!0}},children:[{type:"link"},{type:"link"}],axis:{x:{title:!1,grid:!1},y:{title:!1,grid:!0,gridLineDash:null}},animate:{enter:{type:"scaleInY"}},interaction:{tooltip:{shared:!0,marker:!1,groupName:!1,crosshairs:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return VJ},t}(Tl);function GJ(e){return(0,Ll.Z)(Au,Zl)(e)}var XJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),YJ=function(e){XJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyLine",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"line",axis:!1}],animate:{enter:{type:"growInX",duration:500}},padding:0,margin:0,tooltip:!1}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return GJ},t}(Tl);function $J(e){return(0,Ll.Z)(Au,Zl)(e)}var KJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),qJ=function(e){KJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyArea",n}return t.getDefaultOptions=function(){return{type:"view",animate:{enter:{type:"growInX",duration:500}},children:[{type:"area",axis:!1}],padding:0,margin:0,tooltip:!1}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return $J},t}(Tl);function QJ(e){return(0,Ll.Z)(Au,Zl)(e)}var JJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),eee=function(e){JJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyColumn",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval",axis:!1}],padding:0,margin:0,tooltip:!1}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return QJ},t}(Tl),wM=function(){return wM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},wM.apply(this,arguments)};function tee(e){var t=function(n){var r=n.options,i=r.percent,s=r.color,l=s===void 0?[]:s;if(!i)return n;var u={scale:{color:{range:l.length?l:[]}},data:[1,i]};return Object.assign(r,wM({},u)),n};return(0,Ll.Z)(t,Au,Zl)(e)}var nee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ree=function(e){nee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyProgress",n}return t.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,tooltip:!1,children:[{interaction:{tooltip:!1},coordinate:{transform:[{type:"transpose"}]},type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return tee},t}(Tl),AM=function(){return AM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},AM.apply(this,arguments)};function iee(e){var t=function(r){var i=r.options,s=i.radius,l=s===void 0?.8:s;return(0,Ba.Z)(r,"options.coordinate.innerRadius",l),r},n=function(r){var i=r.options,s=i.percent,l=i.color,u=l===void 0?[]:l;if(!s)return r;var h={scale:{color:{range:u.length?u:[]}},data:[1,s]};return Object.assign(i,AM({},h)),r};return(0,Ll.Z)(t,n,Au,Zl)(e)}var oee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),aee=function(e){oee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyRing",n}return t.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,coordinate:{type:"theta"},animate:{enter:{type:"waveIn"}},interaction:{tooltip:!1},tooltip:!1,children:[{type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return iee},t}(Tl);function see(e){return(0,Ll.Z)(Zl)(e)}var lee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),cee=function(e){lee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="rose",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"polar"},animate:{enter:{type:"waveIn"}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return see},t}(Tl),CM="__start__",rb="__end__",OM="__waterfall_value__",RM=function(){return RM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},RM.apply(this,arguments)},uee=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))};function fee(e){var t=function(r){var i=r.options,s=i.data,l=s===void 0?[]:s,u=i.yField;return l.length&&(l.reduce(function(h,p,m){var y,b=M2(u),w=b(p,m,l);if(m===0||p.isTotal)p[CM]=0,p[rb]=w,p[OM]=w;else{var R=(y=h[rb])!==null&&y!==void 0?y:b(h,m,l);p[CM]=R,p[rb]=R+w,p[OM]=h[rb]}return p},[]),Object.assign(i,{yField:[CM,rb]})),r},n=function(r){var i=r.options,s=i.data,l=s===void 0?[]:s,u=i.xField,h=i.children,p=i.linkStyle,m=uee([],l,!0);return m.reduce(function(y,b,w){return w>0&&(b.x1=y[u],b.x2=b[u],b.y1=y[rb]),b},[]),m.shift(),h.push({type:"link",xField:["x1","x2"],yField:"y1",zIndex:-1,data:m,style:RM({stroke:"#697474"},p),label:!1,tooltip:!1}),r};return(0,Ll.Z)(t,n,Au,Zl)(e)}var hee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dee=function(e){hee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="waterfall",n}return t.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{field:OM,valueFormatter:"~s",name:"value"},axis:{y:{title:null,labelFormatter:"~s"},x:{title:null}},children:[{type:"interval",interaction:{elementHighlight:{background:!0}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return fee},t}(Tl),ib=D(290),xk=D(79432),pee=D(20956),mee=D(20544);function vee(e){var t=function(n){var r=n.options,i=r.data,s=r.binNumber,l=r.binWidth,u=r.children,h=r.channel,p=h===void 0?"count":h,m=(0,on.Z)(u,"[0].transform[0]",{});return(0,ib.Z)(l)?((0,xk.Z)(m,{thresholds:(0,pee.Z)((0,mee.Z)(i.length,l)),y:p}),n):((0,ib.Z)(s)&&(0,xk.Z)(m,{thresholds:s,y:p}),n)};return(0,Ll.Z)(t,Au,Zl)(e)}var gee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),yee=function(e){gee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Histogram",n}return t.getDefaultOptions=function(){return{type:"view",autoFit:!0,axis:{y:{title:!1},x:{title:!1}},children:[{type:"rect",transform:[{type:"binX",y:"count"}],interaction:{elementHighlight:{background:!0}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return vee},t}(Tl);function _ee(e){var t=function(r){var i=r.options,s=i.tooltip,l=s===void 0?{}:s,u=i.colorField,h=i.sizeField;return l&&!l.field&&(l.field=u||h),r},n=function(r){var i=r.options,s=i.mark,l=i.children;return s&&(l[0].type=s),r};return(0,Ll.Z)(t,n,Au,Zl)(e)}var bee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),xee=function(e){bee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="heatmap",n}return t.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{valueFormatter:"~s"},axis:{y:{title:null,grid:!0},x:{title:null,grid:!0}},children:[{type:"point",interaction:{elementHighlight:{background:!0}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return _ee},t}(Tl);function Eee(e){var t=function(n){var r=n.options.boxType,i=r===void 0?"box":r;return n.options.children[0].type=i,n};return(0,Ll.Z)(t,Au,Zl)(e)}var See=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tee=function(e){See(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="box",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"box"}],axis:{y:{title:!1},x:{title:!1}},tooltip:{items:[{name:"min",channel:"y"},{name:"q1",channel:"y1"},{name:"q2",channel:"y2"},{name:"q3",channel:"y3"},{name:"max",channel:"y4"}]}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Eee},t}(Tl);function wee(e){var t=function(n){var r=n.options,i=r.data,s=[{type:"custom",callback:function(u){return{links:u}}}];if((0,Ot.Z)(i))i.length>0?(0,Ba.Z)(r,"data",{value:i,transform:s}):delete r.children;else if((0,on.Z)(i,"type")==="fetch"&&(0,on.Z)(i,"value")){var l=(0,on.Z)(i,"transform");(0,Ot.Z)(l)?(0,Ba.Z)(i,"transform",l.concat(s)):(0,Ba.Z)(i,"transform",s)}return n};return(0,Ll.Z)(t,Au,Zl)(e)}var Aee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Cee=function(e){Aee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="sankey",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"sankey"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return wee},t}(Tl);function Oee(e){var t=e.options.layout,n=t===void 0?"horizontal":t;return e.options.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}],e}function Ree(e){Oee(e);var t=e.options.layout,n=t===void 0?"horizontal":t;return e.options.children.forEach(function(r){var i;!((i=r==null?void 0:r.coordinate)===null||i===void 0)&&i.transform&&(r.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}])}),e}var Mee=D(27601),Pee=D(36378),Iee=D(90096),om=function(){return om=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},om.apply(this,arguments)},Ew=["#f0efff","#5B8FF9","#3D76DD"];function MM(e,t,n,r){r===void 0&&(r=!0);var i=0,s=!1,l=(0,nb.Z)(e,function(u){var h,p,m=(0,on.Z)(u,[t]);if((0,Mee.Z)(m))return[];if((0,Pee.Z)(m)){var y=Number(m);return isNaN(y)?[]:(h={},h[n]=u[n],h[t]=y,h)}return(0,Ot.Z)(m)?(s=!0,i=Math.max(i,m.length),(0,nb.Z)(r?m.sort(function(b,w){return w-b}):m,function(b,w){var R;return R={},R[n]=u[n],R[t]=b,R.index=w,R})):(i=Math.max(1,i),p={},p[n]=u[n],p[t]=m,p)}).flat();return s?[l.map(function(u){return om({index:0},u)}),i]:[l,i]}function PM(e,t){return new Array(e).fill("").map(function(n,r){return(0,Ot.Z)(t)?t[r%t.length]:t})}function Lee(e){var t=function(i){var s=i.options,l=s.color,u=s.rangeField,h=u===void 0?"ranges":u,p=s.measureField,m=p===void 0?"measures":p,y=s.targetField,b=y===void 0?"targets":y,w=s.xField,R=w===void 0?"title":w,M=s.mapField,I=s.data,N=MM(I,h,R),U=N[0],Z=N[1],Y=MM(I,m,R,!1),$=Y[0],J=Y[1],se=MM(I,b,R,!1),pe=se[0],Ce=se[1],Ue=(0,on.Z)(l,[h],Ew[0]),Je=(0,on.Z)(l,[m],Ew[1]),lt=(0,on.Z)(l,[b],Ew[2]),Ge=[PM(Z,Ue),PM(J,Je),PM(Ce,lt)].flat();return i.options.children=(0,nb.Z)(i.options.children,function(at,st){var ft=[U,$,pe][st],Vt=[h,m,b][st];return om(om({},at),{data:ft,encode:om(om({},at.encode||{}),{x:R,y:Vt,color:function(wt){var zt=wt.index,En=(0,ib.Z)(zt)?"".concat(Vt,"_").concat(zt):Vt;return M?(0,on.Z)(M,[Vt,zt],En):En}}),style:om(om({},at.style||{}),{zIndex:function(wt){return-wt[Vt]}}),labels:st!==0?(0,nb.Z)(at.labels,function(wt){return om(om({},wt),{text:Vt})}):void 0})}),i.options.scale.color.range=Ge,i.options.legend.color.itemMarker=function(at){return M&&(0,Iee.Z)(M==null?void 0:M[b],at)||(at==null?void 0:at.replace(/\_\d$/,""))===b?"line":"square"},i},n=function(i){var s=i.options.layout,l=s===void 0?"horizontal":s;return l!=="horizontal"&&(0,Ba.Z)(i,"options.children[2].shapeField","hyphen"),i},r=function(i){var s=i.options,l=s.range,u=l===void 0?{}:l,h=s.measure,p=h===void 0?{}:h,m=s.target,y=m===void 0?{}:m,b=s.children;return i.options.children=[u,p,y].map(function(w,R){return Qg(b[R],w)}),i};return(0,Ll.Z)(t,n,r,Ree,Zl)(e)}var Dee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nee=function(e){Dee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="bullet",n}return t.getDefaultOptions=function(){return{type:"view",scale:{color:{range:Ew}},legend:{color:{itemMarker:function(n){return n==="target"?"line":"square"}}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval",style:{maxWidth:30},axis:{y:{grid:!0,gridLineWidth:2}}},{type:"interval",style:{maxWidth:20},transform:[{type:"stackY"}]},{type:"point",encode:{size:8,shape:"line"}}],interaction:{tooltip:{shared:!0}},coordinate:{transform:[{type:"transpose"}]}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Lee},t}(Tl);function Bee(e){var t=function(n){var r=n.options.data;return n.options.data={value:r},n};return(0,Ll.Z)(t,Au,Zl)(e)}var Fee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),kee=function(e){Fee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Gauge",n}return t.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"gauge"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Bee},t}(Tl);function zee(e){var t=function(n){var r=n.options.percent;return(0,ib.Z)(r)&&((0,Ba.Z)(n,"options.data",r),delete n.options.percent),n};return(0,Ll.Z)(t,Au,Zl)(e)}var Uee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),jee=function(e){Uee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Liquid",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"liquid"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return zee},t}(Tl);function Vee(e){return(0,Ll.Z)(Au,Zl)(e)}var Hee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zee=function(e){Hee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="WordCloud",n}return t.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"wordCloud"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Vee},t}(Tl);function Wee(e){var t=function(n){var r=n.options,i=r.data;return i&&(0,Ba.Z)(r,"data",{value:i}),n};return(0,Ll.Z)(t,Au,Zl)(e)}var Gee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xee=function(e){Gee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="treemap",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"treemap"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Wee},t}(Tl),T1=function(){return T1=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},T1.apply(this,arguments)};function Yee(e){var t=function(i){var s=i.options,l=s.startAngle,u=s.maxAngle,h=s.coordinate,p=(0,ib.Z)(l)?l/(2*Math.PI)*360:-90,m=(0,ib.Z)(u)?(Number(u)+p)/180*Math.PI:Math.PI;return(0,Ba.Z)(i,["options","coordinate"],T1(T1({},h),{endAngle:m,startAngle:l!=null?l:-Math.PI/2})),i},n=function(i){var s=i.options,l=s.tooltip,u=s.xField,h=s.yField,p=M2(u),m=M2(h);return l||(0,Ba.Z)(s,"tooltip",{title:!1,items:[function(y,b,w){return{name:p(y,b,w),value:m(y,b,w)}}]}),i},r=function(i){var s=i.options,l=s.markBackground,u=s.children,h=s.scale,p=s.coordinate,m=s.xField,y=(0,on.Z)(h,"y.domain",[]);return l&&u.unshift(T1({type:"interval",xField:m,yField:y[y.length-1],colorField:l.color,scale:{color:{type:"identity"}},style:{fillOpacity:l.opacity,fill:l.color?void 0:"#e0e4ee"},coordinate:T1(T1({},p),{startAngle:-Math.PI/2,endAngle:1.5*Math.PI}),animate:!1},l)),i};return(0,Ll.Z)(t,n,r,Au,Zl)(e)}var $ee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kee=function(e){$ee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="radial",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"radial",innerRadius:.1,outerRadius:1,endAngle:Math.PI},animate:{enter:{type:"waveIn",duration:800}},axis:{y:{nice:!0,labelAutoHide:!0,labelAutoRotate:!1},x:{title:!1,nice:!0,labelAutoRotate:!1,labelAutoHide:{type:"equidistance",cfg:{minGap:6}}}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Yee},t}(Tl);function qee(e){return(0,Ll.Z)(Zl)(e)}var Qee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jee=function(e){Qee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="CirclePacking",n}return t.getDefaultOptions=function(){return{legend:!1,type:"view",children:[{type:"pack"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return qee},t}(Tl),Sw=function(){return Sw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Sw.apply(this,arguments)};function ete(e){var t=function(n){var r=n.options,i=r.xField,s=r.yField,l=r.seriesField,u=r.children,h=u==null?void 0:u.map(function(p){return Sw(Sw({},p),{xField:i,yField:s,seriesField:l,colorField:l,data:p.type==="density"?{transform:[{type:"kde",field:s,groupBy:[i,l]}]}:p.data})}).filter(function(p){return r.violinType!=="density"||p.type==="density"});return(0,Ba.Z)(r,"children",h),r.violinType==="polar"&&(0,Ba.Z)(r,"coordinate",{type:"polar"}),(0,Ba.Z)(r,"violinType",void 0),n};return(0,Ll.Z)(t,Au,Zl)(e)}var tte=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),nte=function(e){tte(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="violin",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"density",sizeField:"size",tooltip:!1},{type:"boxplot",shapeField:"violin",style:{opacity:.5,point:!1}}],animate:{enter:{type:"fadeIn"}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return ete},t}(Tl),rte=D(37514),P2=function(){return P2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},P2.apply(this,arguments)},ite=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))};function ote(e){var t=function(s){var l=s.options,u=l.yField,h=l.children;return h.forEach(function(p,m){(0,Ba.Z)(p,"yField",u[m])}),s},n=function(s){var l=s.options,u=l.yField,h=l.children,p=l.data;if((0,rte.Z)(p))return s;var m=(0,Ot.Z)((0,on.Z)(p,[0]))?p:[p,p];return h.forEach(function(y,b){(0,Ba.Z)(y,"data",ite([],m[b].map(function(w){return P2({groupKey:u[b]},w)}),!0))}),s},r=function(s){var l=s.options,u=l.yField,h=u[0],p=u[1],m=l.tooltip;return m||(0,Ba.Z)(l,"tooltip",{items:[{field:h,value:h},{field:p,value:p}]}),s},i=function(s){var l=s.options,u=l.children,h=l.layout,p=l.coordinate.transform,m=l.paddingBottom,y=m===void 0?mk:m,b=l.paddingLeft,w=b===void 0?mk:b,R=l.axis;(0,Ba.Z)(l,"axisText",P2(P2({},(R==null?void 0:R.x)||{}),{layout:h}));var M=u[0],I=u[1];if(h==="vertical")(0,Ba.Z)(l,"direction","col"),(0,Ba.Z)(l,"paddingLeft",w),(0,Ba.Z)(l,"coordinate.transform",p.filter(function($){return $.type!=="transpose"})),(0,Ba.Z)(M,"paddingBottom",pk),(0,Ba.Z)(I,"paddingTop",pk),(0,Ba.Z)(I,"axis",{x:{position:"top"}}),(0,Ba.Z)(I,"scale",{y:{range:[0,1]}});else{(0,Ba.Z)(l,"paddingBottom",y),(0,Ba.Z)(M,"scale",{y:{range:[0,1]}});var N=M.paddingRight,U=N===void 0?EM:N,Z=I.paddingLeft,Y=Z===void 0?EM:Z;(0,Ba.Z)(M,"paddingRight",U),(0,Ba.Z)(M,"axis",{x:{position:"right"}}),(0,Ba.Z)(I,"paddingLeft",Y)}return s};return(0,Ll.Z)(t,n,r,i,Au,Zl)(e)}var ate=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ste=function(e){ate(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="BidirectionalBar",n}return t.getDefaultOptions=function(){return{type:"spaceFlex",coordinate:{transform:[{type:"transpose"}]},scale:{y:{nice:!0}},direction:"row",layout:"horizontal",legend:!1,axis:{y:{title:!1},x:{title:!1,label:!1}},children:[{type:"interval"},{type:"interval"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return ote},t}(Tl),w1;(function(e){e.color="key",e.d="path"})(w1||(w1={}));function lte(e){var t=function(n){var r=n.options,i=r.data,s=r.setsField,l=r.sizeField;return(0,Ot.Z)(i)&&((0,Ba.Z)(r,"data",{type:"inline",value:i,transform:[{type:"venn",sets:s,size:l,as:[w1.color,w1.d]}]}),(0,Ba.Z)(r,"colorField",s),(0,Ba.Z)(r,["children","0","encode","d"],w1.d)),(0,Ba.Z)(n,"options",(0,SM.Z)(r,["sizeField","setsField"])),n};return(0,Ll.Z)(t,Zl)(e)}var cte=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ute=function(e){cte(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="venn",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"path"}],legend:{color:{itemMarker:"circle"}},encode:{color:w1.color,d:w1.d}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return lte},t}(Tl);function fte(e){var t=function(n){return n};return(0,Ll.Z)(t,Zl)(e)}var hte=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),dte=function(e){hte(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Sunburst",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"sunburst"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return fte},t}(Tl),pte={Base:sJ,Line:OJ,Column:bJ,Pie:PJ,Area:pJ,Bar:gJ,DualAxes:bk,Funnel:wJ,Scatter:DJ,Radar:FJ,Rose:cee,Stock:WJ,TinyLine:YJ,TinyArea:qJ,TinyColumn:eee,TinyProgress:ree,TinyRing:aee,Waterfall:dee,Histogram:yee,Heatmap:xee,Box:Tee,Sankey:Cee,Bullet:Nee,Gauge:kee,Liquid:jee,WordCloud:Zee,Treemap:Xee,RadialBar:Kee,CirclePacking:Jee,Violin:nte,BidirectionalBar:ste,Venn:ute,Mix:bk,Sunburst:dte},IM=function(){return IM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},IM.apply(this,arguments)},Ek=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},mte=(0,re.forwardRef)(function(e,t){var n=e.chartType,r=n===void 0?"Base":n,i=Ek(e,["chartType"]),s=i.containerStyle,l=s===void 0?{height:"inherit",flex:1}:s,u=i.containerAttributes,h=u===void 0?{}:u,p=i.className,m=i.loading,y=i.loadingTemplate,b=i.errorTemplate,w=Ek(i,["containerStyle","containerAttributes","className","loading","loadingTemplate","errorTemplate"]),R=nr(pte[r],w),M=R.chart,I=R.container;return(0,re.useImperativeHandle)(t,function(){return M.current}),re.createElement(it,{errorTemplate:b},m&&re.createElement(Rt,{loadingTemplate:y}),re.createElement("div",IM({className:p,style:l,ref:I},h)))})},78677:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var fe,ae=1,Ee=arguments.length;ae<Ee;ae++){fe=arguments[ae];for(var oe in fe)Object.prototype.hasOwnProperty.call(fe,oe)&&(re[oe]=fe[oe])}return re},E.apply(this,arguments)},ve=(0,ee.forwardRef)(function(re,fe){return ee.createElement(X.P,E({},re,{chartType:"Column",ref:fe}))});W.Z=ve},80652:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var fe,ae=1,Ee=arguments.length;ae<Ee;ae++){fe=arguments[ae];for(var oe in fe)Object.prototype.hasOwnProperty.call(fe,oe)&&(re[oe]=fe[oe])}return re},E.apply(this,arguments)},ve=(0,ee.forwardRef)(function(re,fe){return ee.createElement(X.P,E({},re,{chartType:"Line",ref:fe}))});W.Z=ve},63430:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var fe,ae=1,Ee=arguments.length;ae<Ee;ae++){fe=arguments[ae];for(var oe in fe)Object.prototype.hasOwnProperty.call(fe,oe)&&(re[oe]=fe[oe])}return re},E.apply(this,arguments)},ve=(0,ee.forwardRef)(function(re,fe){return ee.createElement(X.P,E({},re,{chartType:"Pie",ref:fe}))});W.Z=ve},6466:function($t,W,D){"use strict";D.d(W,{Z:function(){return gt}});var ee=D(4942),X=D(1413),E=D(45987),ve=D(28459),re=D(93967),fe=D.n(re),ae=D(67294),Ee=D(53911),oe=D(44962),ze=D(98082),te=function(Re){return(0,ee.Z)({},Re.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:Re.marginLG,marginInline:0,color:Re.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function ye(Be){return(0,ze.Xj)("ProCardOperation",function(Re){var bt=(0,X.Z)((0,X.Z)({},Re),{},{componentCls:".".concat(Be)});return[te(bt)]})}var De=D(85893),Se=function(Re){var bt=Re.className,yt=Re.style,At=yt===void 0?{}:yt,bn=Re.children,He=(0,ae.useContext)(ve.ZP.ConfigContext),Rt=He.getPrefixCls,Oe=Rt("pro-card-operation"),it=ye(Oe),Qe=it.wrapSSR,$e=it.hashId,Ot=fe()(Oe,bt,$e);return Qe((0,De.jsx)("div",{className:Ot,style:At,children:bn}))},we=Se,ce=D(96604),Ze=function(Re){return(0,ee.Z)({},Re.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,ee.Z)({flexDirection:"row"},"".concat(Re.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(Re.colorBorder)}})};function xt(Be){return(0,ze.Xj)("StatisticCard",function(Re){var bt=(0,X.Z)((0,X.Z)({},Re),{},{componentCls:".".concat(Be)});return[Ze(bt)]})}var ht=["children","statistic","className","chart","chartPlacement","footer"],Gt=function(Re){var bt=Re.children,yt=Re.statistic,At=Re.className,bn=Re.chart,He=Re.chartPlacement,Rt=Re.footer,Oe=(0,E.Z)(Re,ht),it=(0,ae.useContext)(ve.ZP.ConfigContext),Qe=it.getPrefixCls,$e=Qe("pro-statistic-card"),Ot=xt($e),vt=Ot.wrapSSR,Me=Ot.hashId,Xt=fe()($e,At,Me),on=yt&&(0,De.jsx)(ce.Z,(0,X.Z)({layout:"vertical"},yt)),Fn=fe()("".concat($e,"-chart"),Me,(0,ee.Z)((0,ee.Z)({},"".concat($e,"-chart-left"),He==="left"&&bn&&yt),"".concat($e,"-chart-right"),He==="right"&&bn&&yt)),$n=bn&&(0,De.jsx)("div",{className:Fn,children:bn}),nr=fe()("".concat($e,"-content "),Me,(0,ee.Z)({},"".concat($e,"-content-horizontal"),He==="left"||He==="right")),Ht=($n||on)&&(He==="left"?(0,De.jsxs)("div",{className:nr,children:[$n,on]}):(0,De.jsxs)("div",{className:nr,children:[on,$n]})),Jt=Rt&&(0,De.jsx)("div",{className:"".concat($e,"-footer ").concat(Me).trim(),children:Rt});return vt((0,De.jsxs)(Ee.Z,(0,X.Z)((0,X.Z)({className:Xt},Oe),{},{children:[Ht,bt,Jt]})))},mt=function(Re){return(0,De.jsx)(Gt,(0,X.Z)({bodyStyle:{padding:0}},Re))};Gt.Statistic=ce.Z,Gt.Divider=oe.Z,Gt.Operation=we,Gt.isProCard=!0,Gt.Group=mt;var gt=Gt},96604:function($t,W,D){"use strict";D.d(W,{Z:function(){return an}});var ee=D(1413),X=D(4942),E=D(45987),ve=D(87462),re=D(67294),fe=D(36688),ae=D(55304),Ee=function(Dt,Ie){return re.createElement(ae.Z,(0,ve.Z)({},Dt,{ref:Ie,icon:fe.Z}))},oe=re.forwardRef(Ee),ze=oe,te=D(28459),ye=D(83062),De=D(40411),Se=D(57838),we=D(96159),ce=D(93967),Ze=D.n(ce),xt=D(64217),ht=D(53124),Gt=D(87564),gt=Ut=>{const{value:Dt,formatter:Ie,precision:qe,decimalSeparator:Bt,groupSeparator:j="",prefixCls:le}=Ut;let z;if(typeof Ie=="function")z=Ie(Dt);else{const de=String(Dt),Zt=de.match(/^(-?)(\d*)(\.(\d+))?$/);if(!Zt||de==="-")z=de;else{const nt=Zt[1];let St=Zt[2]||"0",In=Zt[4]||"";St=St.replace(/\B(?=(\d{3})+(?!\d))/g,j),typeof qe=="number"&&(In=In.padEnd(qe,"0").slice(0,qe>0?qe:0)),In&&(In=`${Bt}${In}`),z=[re.createElement("span",{key:"int",className:`${le}-content-value-int`},nt,St),In&&re.createElement("span",{key:"decimal",className:`${le}-content-value-decimal`},In)]}}return re.createElement("span",{className:`${le}-content-value`},z)},Be=D(14747),Re=D(83559),bt=D(83262);const yt=Ut=>{const{componentCls:Dt,marginXXS:Ie,padding:qe,colorTextDescription:Bt,titleFontSize:j,colorTextHeading:le,contentFontSize:z,fontFamily:de}=Ut;return{[Dt]:Object.assign(Object.assign({},(0,Be.Wf)(Ut)),{[`${Dt}-title`]:{marginBottom:Ie,color:Bt,fontSize:j},[`${Dt}-skeleton`]:{paddingTop:qe},[`${Dt}-content`]:{color:le,fontSize:z,fontFamily:de,[`${Dt}-content-value`]:{display:"inline-block",direction:"ltr"},[`${Dt}-content-prefix, ${Dt}-content-suffix`]:{display:"inline-block"},[`${Dt}-content-prefix`]:{marginInlineEnd:Ie},[`${Dt}-content-suffix`]:{marginInlineStart:Ie}}})}},At=Ut=>{const{fontSizeHeading3:Dt,fontSize:Ie}=Ut;return{titleFontSize:Ie,contentFontSize:Dt}};var bn=(0,Re.I$)("Statistic",Ut=>{const Dt=(0,bt.mergeToken)(Ut,{});return[yt(Dt)]},At),He=function(Ut,Dt){var Ie={};for(var qe in Ut)Object.prototype.hasOwnProperty.call(Ut,qe)&&Dt.indexOf(qe)<0&&(Ie[qe]=Ut[qe]);if(Ut!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Bt=0,qe=Object.getOwnPropertySymbols(Ut);Bt<qe.length;Bt++)Dt.indexOf(qe[Bt])<0&&Object.prototype.propertyIsEnumerable.call(Ut,qe[Bt])&&(Ie[qe[Bt]]=Ut[qe[Bt]]);return Ie},Oe=Ut=>{const{prefixCls:Dt,className:Ie,rootClassName:qe,style:Bt,valueStyle:j,value:le=0,title:z,valueRender:de,prefix:Zt,suffix:nt,loading:St=!1,formatter:In,precision:Wn,decimalSeparator:qn=".",groupSeparator:hn=",",onMouseEnter:pt,onMouseLeave:Wt}=Ut,An=He(Ut,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:Pn,direction:Xn,statistic:dt}=re.useContext(ht.E_),be=Pn("statistic",Dt),[Ne,ot,Pt]=bn(be),It=re.createElement(gt,{decimalSeparator:qn,groupSeparator:hn,prefixCls:be,formatter:In,precision:Wn,value:le}),xn=Ze()(be,{[`${be}-rtl`]:Xn==="rtl"},dt==null?void 0:dt.className,Ie,qe,ot,Pt),Qn=(0,xt.Z)(An,{aria:!0,data:!0});return Ne(re.createElement("div",Object.assign({},Qn,{className:xn,style:Object.assign(Object.assign({},dt==null?void 0:dt.style),Bt),onMouseEnter:pt,onMouseLeave:Wt}),z&&re.createElement("div",{className:`${be}-title`},z),re.createElement(Gt.Z,{paragraph:!1,loading:St,className:`${be}-skeleton`},re.createElement("div",{style:j,className:`${be}-content`},Zt&&re.createElement("span",{className:`${be}-content-prefix`},Zt),de?de(It):It,nt&&re.createElement("span",{className:`${be}-content-suffix`},nt)))))};const it=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Qe(Ut,Dt){let Ie=Ut;const qe=/\[[^\]]*]/g,Bt=(Dt.match(qe)||[]).map(de=>de.slice(1,-1)),j=Dt.replace(qe,"[]"),le=it.reduce((de,Zt)=>{let[nt,St]=Zt;if(de.includes(nt)){const In=Math.floor(Ie/St);return Ie-=In*St,de.replace(new RegExp(`${nt}+`,"g"),Wn=>{const qn=Wn.length;return In.toString().padStart(qn,"0")})}return de},j);let z=0;return le.replace(qe,()=>{const de=Bt[z];return z+=1,de})}function $e(Ut,Dt){const{format:Ie=""}=Dt,qe=new Date(Ut).getTime(),Bt=Date.now(),j=Math.max(qe-Bt,0);return Qe(j,Ie)}var Ot=function(Ut,Dt){var Ie={};for(var qe in Ut)Object.prototype.hasOwnProperty.call(Ut,qe)&&Dt.indexOf(qe)<0&&(Ie[qe]=Ut[qe]);if(Ut!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Bt=0,qe=Object.getOwnPropertySymbols(Ut);Bt<qe.length;Bt++)Dt.indexOf(qe[Bt])<0&&Object.prototype.propertyIsEnumerable.call(Ut,qe[Bt])&&(Ie[qe[Bt]]=Ut[qe[Bt]]);return Ie};const vt=1e3/30;function Me(Ut){return new Date(Ut).getTime()}const Xt=Ut=>{const{value:Dt,format:Ie="HH:mm:ss",onChange:qe,onFinish:Bt}=Ut,j=Ot(Ut,["value","format","onChange","onFinish"]),le=(0,Se.Z)(),z=re.useRef(null),de=()=>{Bt==null||Bt(),z.current&&(clearInterval(z.current),z.current=null)},Zt=()=>{const In=Me(Dt);In>=Date.now()&&(z.current=setInterval(()=>{le(),qe==null||qe(In-Date.now()),In<Date.now()&&de()},vt))};re.useEffect(()=>(Zt(),()=>{z.current&&(clearInterval(z.current),z.current=null)}),[Dt]);const nt=(In,Wn)=>$e(In,Object.assign(Object.assign({},Wn),{format:Ie})),St=In=>(0,we.Tm)(In,{title:void 0});return re.createElement(Oe,Object.assign({},j,{value:Dt,valueRender:St,formatter:nt}))};var on=re.memo(Xt);Oe.Countdown=on;var Fn=Oe,$n=D(98082),nr=function(Dt){return(0,X.Z)({},Dt.componentCls,(0,X.Z)((0,X.Z)((0,X.Z)((0,X.Z)((0,X.Z)({display:"flex",fontSize:Dt.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,X.Z)({display:"flex",width:"100%"},"".concat(Dt.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,X.Z)({width:"100%"},"".concat(Dt.antCls,"-statistic-content"),{"&-value-int":{fontSize:Dt.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat(Dt.antCls,"-statistic-title"),{color:Dt.colorText}),"&-trend-up",(0,X.Z)({},"".concat(Dt.antCls,"-statistic-content"),(0,X.Z)({color:"#f5222d"},"".concat(Dt.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,X.Z)({},"".concat(Dt.antCls,"-statistic-content"),(0,X.Z)({color:"#389e0d"},"".concat(Dt.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,X.Z)((0,X.Z)((0,X.Z)({display:"flex",justifyContent:"space-between"},"".concat(Dt.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(Dt.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(Dt.antCls,"-statistic-title,").concat(Dt.antCls,"-statistic-content,").concat(Dt.antCls,"-statistic-content-suffix,").concat(Dt.antCls,"-statistic-content-prefix,").concat(Dt.antCls,"-statistic-content-value-decimal"),{fontSize:Dt.fontSize})),"& &-layout-inline",(0,X.Z)((0,X.Z)((0,X.Z)({display:"inline-flex",color:Dt.colorTextSecondary},"".concat(Dt.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(Dt.antCls,"-statistic-content"),{color:Dt.colorTextSecondary}),"".concat(Dt.antCls,"-statistic-title,").concat(Dt.antCls,"-statistic-content,").concat(Dt.antCls,"-statistic-content-suffix,").concat(Dt.antCls,"-statistic-content-prefix,").concat(Dt.antCls,"-statistic-content-value-decimal"),{fontSize:Dt.fontSizeSM})))};function Ht(Ut){return(0,$n.Xj)("Statistic",function(Dt){var Ie=(0,ee.Z)((0,ee.Z)({},Dt),{},{componentCls:".".concat(Ut)});return[nr(Ie)]})}var Jt=D(85893),_n=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],tr=function(Dt){var Ie=Dt.className,qe=Dt.layout,Bt=qe===void 0?"inline":qe,j=Dt.style,le=Dt.description,z=Dt.children,de=Dt.title,Zt=Dt.tip,nt=Dt.status,St=Dt.trend,In=Dt.prefix,Wn=Dt.icon,qn=(0,E.Z)(Dt,_n),hn=(0,re.useContext)(te.ZP.ConfigContext),pt=hn.getPrefixCls,Wt=pt("pro-card-statistic"),An=Ht(Wt),Pn=An.wrapSSR,Xn=An.hashId,dt=Ze()(Wt,Ie,Xn),be=Ze()("".concat(Wt,"-status"),Xn),Ne=Ze()("".concat(Wt,"-icon"),Xn),ot=Ze()("".concat(Wt,"-wrapper"),Xn),Pt=Ze()("".concat(Wt,"-content"),Xn),It=Ze()(Xn,(0,X.Z)((0,X.Z)({},"".concat(Wt,"-layout-").concat(Bt),Bt),"".concat(Wt,"-trend-").concat(St),St)),xn=Zt&&(0,Jt.jsx)(ye.Z,{title:Zt,children:(0,Jt.jsx)(ze,{className:"".concat(Wt,"-tip ").concat(Xn).trim()})}),Qn=Ze()("".concat(Wt,"-trend-icon"),Xn,(0,X.Z)({},"".concat(Wt,"-trend-icon-").concat(St),St)),br=St&&(0,Jt.jsx)("div",{className:Qn}),Jn=nt&&(0,Jt.jsx)("div",{className:be,children:(0,Jt.jsx)(De.Z,{status:nt,text:null})}),Ae=Wn&&(0,Jt.jsx)("div",{className:Ne,children:Wn});return Pn((0,Jt.jsxs)("div",{className:dt,style:j,children:[Ae,(0,Jt.jsxs)("div",{className:ot,children:[Jn,(0,Jt.jsxs)("div",{className:Pt,children:[(0,Jt.jsx)(Fn,(0,ee.Z)({title:(de||xn)&&(0,Jt.jsxs)(Jt.Fragment,{children:[de,xn]}),prefix:(br||In)&&(0,Jt.jsxs)(Jt.Fragment,{children:[br,In]}),className:It},qn)),le&&(0,Jt.jsx)("div",{className:"".concat(Wt,"-description ").concat(Xn).trim(),children:le})]})]})]}))},an=tr},46343:function($t,W,D){"use strict";D.d(W,{S$:function(){return Ut},bf:function(){return Dt},ni:function(){return Xt},oI:function(){return tr},sX:function(){return an}});var ee=D(34155);function X(Ie,qe,Bt,j){function le(z){return z instanceof Bt?z:new Bt(function(de){de(z)})}return new(Bt||(Bt=Promise))(function(z,de){function Zt(In){try{St(j.next(In))}catch(Wn){de(Wn)}}function nt(In){try{St(j.throw(In))}catch(Wn){de(Wn)}}function St(In){In.done?z(In.value):le(In.value).then(Zt,nt)}St((j=j.apply(Ie,qe||[])).next())})}function E(Ie,qe){var Bt={label:0,sent:function(){if(z[0]&1)throw z[1];return z[1]},trys:[],ops:[]},j,le,z,de;return de={next:Zt(0),throw:Zt(1),return:Zt(2)},typeof Symbol=="function"&&(de[Symbol.iterator]=function(){return this}),de;function Zt(St){return function(In){return nt([St,In])}}function nt(St){if(j)throw new TypeError("Generator is already executing.");for(;Bt;)try{if(j=1,le&&(z=St[0]&2?le.return:St[0]?le.throw||((z=le.return)&&z.call(le),0):le.next)&&!(z=z.call(le,St[1])).done)return z;switch(le=0,z&&(St=[St[0]&2,z.value]),St[0]){case 0:case 1:z=St;break;case 4:return Bt.label++,{value:St[1],done:!1};case 5:Bt.label++,le=St[1],St=[0];continue;case 7:St=Bt.ops.pop(),Bt.trys.pop();continue;default:if(z=Bt.trys,!(z=z.length>0&&z[z.length-1])&&(St[0]===6||St[0]===2)){Bt=0;continue}if(St[0]===3&&(!z||St[1]>z[0]&&St[1]<z[3])){Bt.label=St[1];break}if(St[0]===6&&Bt.label<z[1]){Bt.label=z[1],z=St;break}if(z&&Bt.label<z[2]){Bt.label=z[2],Bt.ops.push(St);break}z[2]&&Bt.ops.pop(),Bt.trys.pop();continue}St=qe.call(Ie,Bt)}catch(In){St=[6,In],le=0}finally{j=z=0}if(St[0]&5)throw St[1];return{value:St[0]?St[1]:void 0,done:!0}}}function ve(Ie,qe){var Bt=typeof Symbol=="function"&&Ie[Symbol.iterator];if(!Bt)return Ie;var j=Bt.call(Ie),le,z=[],de;try{for(;(qe===void 0||qe-- >0)&&!(le=j.next()).done;)z.push(le.value)}catch(Zt){de={error:Zt}}finally{try{le&&!le.done&&(Bt=j.return)&&Bt.call(j)}finally{if(de)throw de.error}}return z}function re(Ie,qe,Bt){if(Bt||arguments.length===2)for(var j=0,le=qe.length,z;j<le;j++)(z||!(j in qe))&&(z||(z=Array.prototype.slice.call(qe,0,j)),z[j]=qe[j]);return Ie.concat(z||Array.prototype.slice.call(qe))}function fe(Ie){return Ie&&Ie.__esModule&&Object.prototype.hasOwnProperty.call(Ie,"default")?Ie.default:Ie}var ae={exports:{}},Ee={exports:{}},oe={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Bt;function Bt(j){return j&&typeof j.length=="number"&&j.length>=0&&j.length%1===0}Ie.exports=qe.default})(oe,oe.exports);var ze={},te={exports:{}},ye={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=function(Bt){return function(){for(var j=[],le=arguments.length;le--;)j[le]=arguments[le];var z=j.pop();return Bt.call(this,j,z)}},Ie.exports=qe.default})(ye,ye.exports);var De={};Object.defineProperty(De,"__esModule",{value:!0}),De.fallback=Ze,De.wrap=xt;var Se=De.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,we=De.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,ce=De.hasNextTick=typeof ee=="object"&&typeof ee.nextTick=="function";function Ze(Ie){setTimeout(Ie,0)}function xt(Ie){return function(qe){for(var Bt=[],j=arguments.length-1;j-- >0;)Bt[j]=arguments[j+1];return Ie(function(){return qe.apply(void 0,Bt)})}}var ht;Se?ht=queueMicrotask:we?ht=setImmediate:ce?ht=ee.nextTick:ht=Ze,De.default=xt(ht),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=nt;var Bt=ye.exports,j=Zt(Bt),le=De,z=Zt(le),de=ze;function Zt(Wn){return Wn&&Wn.__esModule?Wn:{default:Wn}}function nt(Wn){return(0,de.isAsync)(Wn)?function(){for(var qn=[],hn=arguments.length;hn--;)qn[hn]=arguments[hn];var pt=qn.pop(),Wt=Wn.apply(this,qn);return St(Wt,pt)}:(0,j.default)(function(qn,hn){var pt;try{pt=Wn.apply(this,qn)}catch(Wt){return hn(Wt)}if(pt&&typeof pt.then=="function")return St(pt,hn);hn(null,pt)})}function St(Wn,qn){return Wn.then(function(hn){In(qn,null,hn)},function(hn){In(qn,hn&&hn.message?hn:new Error(hn))})}function In(Wn,qn,hn){try{Wn(qn,hn)}catch(pt){(0,z.default)(function(Wt){throw Wt},pt)}}Ie.exports=qe.default}(te,te.exports),Object.defineProperty(ze,"__esModule",{value:!0}),ze.isAsyncIterable=ze.isAsyncGenerator=ze.isAsync=void 0;var Gt=te.exports,mt=gt(Gt);function gt(Ie){return Ie&&Ie.__esModule?Ie:{default:Ie}}function Be(Ie){return Ie[Symbol.toStringTag]==="AsyncFunction"}function Re(Ie){return Ie[Symbol.toStringTag]==="AsyncGenerator"}function bt(Ie){return typeof Ie[Symbol.asyncIterator]=="function"}function yt(Ie){if(typeof Ie!="function")throw new Error("expected a function");return Be(Ie)?(0,mt.default)(Ie):Ie}ze.default=yt,ze.isAsync=Be,ze.isAsyncGenerator=Re,ze.isAsyncIterable=bt;var At={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Bt;function Bt(j,le){if(le===void 0&&(le=j.length),!le)throw new Error("arity is undefined");function z(){for(var de=this,Zt=[],nt=arguments.length;nt--;)Zt[nt]=arguments[nt];return typeof Zt[le-1]=="function"?j.apply(this,Zt):new Promise(function(St,In){Zt[le-1]=function(Wn){for(var qn=[],hn=arguments.length-1;hn-- >0;)qn[hn]=arguments[hn+1];if(Wn)return In(Wn);St(qn.length>1?qn:qn[0])},j.apply(de,Zt)})}return z}Ie.exports=qe.default})(At,At.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt=oe.exports,j=nt(Bt),le=ze,z=nt(le),de=At.exports,Zt=nt(de);function nt(St){return St&&St.__esModule?St:{default:St}}qe.default=(0,Zt.default)(function(St,In,Wn){var qn=(0,j.default)(In)?[]:{};St(In,function(hn,pt,Wt){(0,z.default)(hn)(function(An){for(var Pn,Xn=[],dt=arguments.length-1;dt-- >0;)Xn[dt]=arguments[dt+1];Xn.length<2&&(Pn=Xn,Xn=Pn[0]),qn[pt]=Xn,Wt(An)})},function(hn){return Wn(hn,qn)})},3),Ie.exports=qe.default}(Ee,Ee.exports);var bn={exports:{}},He={exports:{}},Rt={exports:{}},Oe={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Bt;function Bt(j){function le(){for(var z=[],de=arguments.length;de--;)z[de]=arguments[de];if(j!==null){var Zt=j;j=null,Zt.apply(this,z)}}return Object.assign(le,j),le}Ie.exports=qe.default})(Oe,Oe.exports);var it={exports:{}},Qe={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=function(Bt){return Bt[Symbol.iterator]&&Bt[Symbol.iterator]()},Ie.exports=qe.default})(Qe,Qe.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=In;var Bt=oe.exports,j=de(Bt),le=Qe.exports,z=de(le);function de(Wn){return Wn&&Wn.__esModule?Wn:{default:Wn}}function Zt(Wn){var qn=-1,hn=Wn.length;return function(){return++qn<hn?{value:Wn[qn],key:qn}:null}}function nt(Wn){var qn=-1;return function(){var pt=Wn.next();return pt.done?null:(qn++,{value:pt.value,key:qn})}}function St(Wn){var qn=Wn?Object.keys(Wn):[],hn=-1,pt=qn.length;return function Wt(){var An=qn[++hn];return An==="__proto__"?Wt():hn<pt?{value:Wn[An],key:An}:null}}function In(Wn){if((0,j.default)(Wn))return Zt(Wn);var qn=(0,z.default)(Wn);return qn?nt(qn):St(Wn)}Ie.exports=qe.default}(it,it.exports);var $e={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Bt;function Bt(j){return function(){for(var le=[],z=arguments.length;z--;)le[z]=arguments[z];if(j===null)throw new Error("Callback was already called.");var de=j;j=null,de.apply(this,le)}}Ie.exports=qe.default})($e,$e.exports);var Ot={exports:{}},vt={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt={};qe.default=Bt,Ie.exports=qe.default})(vt,vt.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=z;var Bt=vt.exports,j=le(Bt);function le(de){return de&&de.__esModule?de:{default:de}}function z(de,Zt,nt,St){var In=!1,Wn=!1,qn=!1,hn=0,pt=0;function Wt(){hn>=Zt||qn||In||(qn=!0,de.next().then(function(Xn){var dt=Xn.value,be=Xn.done;if(!(Wn||In)){if(qn=!1,be){In=!0,hn<=0&&St(null);return}hn++,nt(dt,pt,An),pt++,Wt()}}).catch(Pn))}function An(Xn,dt){if(hn-=1,!Wn){if(Xn)return Pn(Xn);if(Xn===!1){In=!0,Wn=!0;return}if(dt===j.default||In&&hn<=0)return In=!0,St(null);Wt()}}function Pn(Xn){Wn||(qn=!1,In=!0,St(Xn))}Wt()}Ie.exports=qe.default}(Ot,Ot.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt=Oe.exports,j=hn(Bt),le=it.exports,z=hn(le),de=$e.exports,Zt=hn(de),nt=ze,St=Ot.exports,In=hn(St),Wn=vt.exports,qn=hn(Wn);function hn(pt){return pt&&pt.__esModule?pt:{default:pt}}qe.default=function(pt){return function(Wt,An,Pn){if(Pn=(0,j.default)(Pn),pt<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Wt)return Pn(null);if((0,nt.isAsyncGenerator)(Wt))return(0,In.default)(Wt,pt,An,Pn);if((0,nt.isAsyncIterable)(Wt))return(0,In.default)(Wt[Symbol.asyncIterator](),pt,An,Pn);var Xn=(0,z.default)(Wt),dt=!1,be=!1,Ne=0,ot=!1;function Pt(xn,Qn){if(!be)if(Ne-=1,xn)dt=!0,Pn(xn);else if(xn===!1)dt=!0,be=!0;else{if(Qn===qn.default||dt&&Ne<=0)return dt=!0,Pn(null);ot||It()}}function It(){for(ot=!0;Ne<pt&&!dt;){var xn=Xn();if(xn===null){dt=!0,Ne<=0&&Pn(null);return}Ne+=1,An(xn.value,xn.key,(0,Zt.default)(Pt))}ot=!1}It()}},Ie.exports=qe.default}(Rt,Rt.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt=Rt.exports,j=nt(Bt),le=ze,z=nt(le),de=At.exports,Zt=nt(de);function nt(In){return In&&In.__esModule?In:{default:In}}function St(In,Wn,qn,hn){return(0,j.default)(Wn)(In,(0,z.default)(qn),hn)}qe.default=(0,Zt.default)(St,4),Ie.exports=qe.default}(He,He.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt=He.exports,j=de(Bt),le=At.exports,z=de(le);function de(nt){return nt&&nt.__esModule?nt:{default:nt}}function Zt(nt,St,In){return(0,j.default)(nt,1,St,In)}qe.default=(0,z.default)(Zt,3),Ie.exports=qe.default}(bn,bn.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Zt;var Bt=Ee.exports,j=de(Bt),le=bn.exports,z=de(le);function de(nt){return nt&&nt.__esModule?nt:{default:nt}}function Zt(nt,St){return(0,j.default)(z.default,nt,St)}Ie.exports=qe.default}(ae,ae.exports);var Me=fe(ae.exports),Xt=function(){function Ie(){this.args=[],this.tasks=[]}return Ie.prototype.call=function(){for(var qe=arguments,Bt=[],j=0;j<arguments.length;j++)Bt[j]=qe[j];return this.args=Bt,Me(this.tasks)},Ie.prototype.tap=function(qe,Bt){var j=this;this.tasks.push(function(le){Bt.apply(void 0,re([],ve(j.args),!1)),le(null,qe)})},Ie}(),on={exports:{}},Fn={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt=oe.exports,j=An(Bt),le=vt.exports,z=An(le),de=He.exports,Zt=An(de),nt=Oe.exports,St=An(nt),In=$e.exports,Wn=An(In),qn=ze,hn=An(qn),pt=At.exports,Wt=An(pt);function An(be){return be&&be.__esModule?be:{default:be}}function Pn(be,Ne,ot){ot=(0,St.default)(ot);var Pt=0,It=0,xn=be.length,Qn=!1;xn===0&&ot(null);function br(Jn,Ae){Jn===!1&&(Qn=!0),Qn!==!0&&(Jn?ot(Jn):(++It===xn||Ae===z.default)&&ot(null))}for(;Pt<xn;Pt++)Ne(be[Pt],Pt,(0,Wn.default)(br))}function Xn(be,Ne,ot){return(0,Zt.default)(be,1/0,Ne,ot)}function dt(be,Ne,ot){var Pt=(0,j.default)(be)?Pn:Xn;return Pt(be,(0,hn.default)(Ne),ot)}qe.default=(0,Wt.default)(dt,3),Ie.exports=qe.default})(Fn,Fn.exports),function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=Zt;var Bt=Fn.exports,j=de(Bt),le=Ee.exports,z=de(le);function de(nt){return nt&&nt.__esModule?nt:{default:nt}}function Zt(nt,St){return(0,z.default)(j.default,nt,St)}Ie.exports=qe.default}(on,on.exports);var $n=fe(on.exports),nr=function(){function Ie(){this.tasks=[]}return Ie.prototype.promise=function(){return $n(this.tasks)},Ie.prototype.tapPromise=function(qe,Bt){var j=this;this.tasks.push(function(le){return X(j,void 0,void 0,function(){return E(this,function(z){switch(z.label){case 0:return[4,Bt()];case 1:return z.sent(),le(null,qe),[2]}})})})},Ie}(),Ht={exports:{}};(function(Ie,qe){Object.defineProperty(qe,"__esModule",{value:!0});var Bt=Oe.exports,j=In(Bt),le=$e.exports,z=In(le),de=ze,Zt=In(de),nt=At.exports,St=In(nt);function In(qn){return qn&&qn.__esModule?qn:{default:qn}}function Wn(qn,hn){if(hn=(0,j.default)(hn),!Array.isArray(qn))return hn(new Error("First argument to waterfall must be an array of functions"));if(!qn.length)return hn();var pt=0;function Wt(Pn){var Xn=(0,Zt.default)(qn[pt++]);Xn.apply(void 0,Pn.concat([(0,z.default)(An)]))}function An(Pn){for(var Xn=[],dt=arguments.length-1;dt-- >0;)Xn[dt]=arguments[dt+1];if(Pn!==!1){if(Pn||pt===qn.length)return hn.apply(void 0,[Pn].concat(Xn));Wt(Xn)}}Wt([])}qe.default=(0,St.default)(Wn),Ie.exports=qe.default})(Ht,Ht.exports);var Jt=fe(Ht.exports),_n=function(){function Ie(){this.tasks=[]}return Ie.prototype.call=function(){return Jt(this.tasks)},Ie.prototype.tap=function(qe,Bt){this.tasks.length===0?this.tasks.push(function(j){var le=Bt();j(le?null:!1,le)}):this.tasks.push(function(j,le){var z=Bt.apply(void 0,re([],ve(j),!1));le(z?null:!1,qe)})},Ie}(),tr=function(){function Ie(){this.tasks=[]}return Ie.prototype.call=function(){return Me(this.tasks)},Ie.prototype.tap=function(qe,Bt){this.tasks.push(function(j){var le=Bt();j(le,qe)})},Ie}(),an=function(){function Ie(){this.args=[],this.tasks=[]}return Ie.prototype.promise=function(){for(var qe=arguments,Bt=[],j=0;j<arguments.length;j++)Bt[j]=qe[j];return this.args=Bt,Me(this.tasks)},Ie.prototype.tapPromise=function(qe,Bt){var j=this;this.tasks.push(function(le){return X(j,void 0,void 0,function(){return E(this,function(z){switch(z.label){case 0:return[4,Bt.apply(void 0,re([],ve(this.args),!1))];case 1:return z.sent(),le(null,qe),[2]}})})})},Ie}(),Ut=function(){function Ie(){this.args=[],this.tasks=[]}return Ie.prototype.promise=function(){for(var qe=arguments,Bt=[],j=0;j<arguments.length;j++)Bt[j]=qe[j];return this.args=Bt,Me(this.tasks)},Ie.prototype.tapPromise=function(qe,Bt){var j=this;this.tasks.push(function(le){return X(j,void 0,void 0,function(){var z;return E(this,function(de){switch(de.label){case 0:return[4,Bt.apply(void 0,re([],ve(this.args),!1))];case 1:return z=de.sent(),le(z,qe),[2]}})})})},Ie}(),Dt=function(){function Ie(){this.tasks=[]}return Ie.prototype.promise=function(){return Jt(this.tasks)},Ie.prototype.tapPromise=function(qe,Bt){this.tasks.length===0?this.tasks.push(function(j){Bt().then(function(le){j(null,le)})}):this.tasks.push(function(j,le){Bt(j).then(function(z){le(null,z)})})},Ie}()},17816:function($t,W){(function(D,ee){ee(W)})(this,function(D){"use strict";function ee(Ye){var Ke=typeof Symbol=="function"&&Symbol.iterator,Ct=Ke&&Ye[Ke],sn=0;if(Ct)return Ct.call(Ye);if(Ye&&typeof Ye.length=="number")return{next:function(){return{value:(Ye=Ye&&sn>=Ye.length?void 0:Ye)&&Ye[sn++],done:!Ye}}};throw new TypeError(Ke?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(Ye,Ke){var Ct=typeof Symbol=="function"&&Ye[Symbol.iterator];if(!Ct)return Ye;var sn,Ln,zn=Ct.call(Ye),mn=[];try{for(;(Ke===void 0||0<Ke--)&&!(sn=zn.next()).done;)mn.push(sn.value)}catch(wn){Ln={error:wn}}finally{try{sn&&!sn.done&&(Ct=zn.return)&&Ct.call(zn)}finally{if(Ln)throw Ln.error}}return mn}function E(Ye,Ke,Ct){if(Ct||arguments.length===2)for(var sn,Ln=0,zn=Ke.length;Ln<zn;Ln++)!sn&&Ln in Ke||((sn=sn||Array.prototype.slice.call(Ke,0,Ln))[Ln]=Ke[Ln]);return Ye.concat(sn||Array.prototype.slice.call(Ke))}function ve(Ye){return fe(Ye,"Function")}var re={}.toString,fe=function(Ye,Ke){return re.call(Ye)==="[object "+Ke+"]"},ae=function(Ye){return Array.isArray?Array.isArray(Ye):fe(Ye,"Array")},Ee=function(Ye){if(typeof(Ke=Ye)!="object"||Ke===null||!fe(Ye,"Object"))return!1;var Ke;if(Object.getPrototypeOf(Ye)===null)return!0;for(var Ct=Ye;Object.getPrototypeOf(Ct)!==null;)Ct=Object.getPrototypeOf(Ct);return Object.getPrototypeOf(Ye)===Ct},oe=function(Ye){return fe(Ye,"Number")},ze=Object.values?function(Ye){return Object.values(Ye)}:function(Ye){var Ke,Ct=[],sn=Ye,Ln=function(gr,mr){ve(Ye)&&mr==="prototype"||Ct.push(gr)};if(sn){if(ae(sn))for(var zn=0,mn=sn.length;zn<mn&&Ln(sn[zn],zn)!==!1;zn++);else if(Ke=typeof sn,sn!==null&&Ke=="object"||Ke=="function"){for(var wn in sn)if(sn.hasOwnProperty(wn)&&Ln(sn[wn],wn)===!1)break}}return Ct},te=5;function ye(Ye){for(var Ke=[],Ct=1;Ct<arguments.length;Ct++)Ke[Ct-1]=arguments[Ct];for(var sn=0;sn<Ke.length;sn+=1)(function Ln(zn,mn,wn,gr){for(var mr in wn=wn||0,gr=gr||te,mn){var ai;mn.hasOwnProperty(mr)&&((ai=mn[mr])!==null&&Ee(ai)?(Ee(zn[mr])||(zn[mr]={}),wn<gr?Ln(zn[mr],ai,wn+1,gr):zn[mr]=mn[mr]):ae(ai)?(zn[mr]=[],zn[mr]=zn[mr].concat(ai)):ai!==void 0&&(zn[mr]=ai))}})(Ye,Ke[sn]);return Ye}function De(Ye){return Ye}(function(Ye,Ke){var Ct;if(ve(Ye))return(Ct=function(){for(var sn=[],Ln=0;Ln<arguments.length;Ln++)sn[Ln]=arguments[Ln];var zn,mn=Ke?Ke.apply(this,sn):sn[0],wn=Ct.cache;return wn.has(mn)?wn.get(mn):(zn=Ye.apply(this,sn),wn.set(mn,zn),zn)}).cache=new Map;throw new TypeError("Expected a function")})(function(Ye,mn){var Ct=(mn=mn===void 0?{}:mn).fontSize,sn=mn.fontFamily,Ln=mn.fontWeight,zn=mn.fontStyle,mn=mn.fontVariant;return(Se=Se||document.createElement("canvas").getContext("2d")).font=[zn,mn,Ln,Ct+"px",sn].join(" "),Se.measureText(fe(Ye,"String")?Ye:"").width},function(Ye,Ke){return function(){for(var Ct=0,sn=0,Ln=arguments.length;sn<Ln;sn++)Ct+=arguments[sn].length;for(var zn=Array(Ct),mn=0,sn=0;sn<Ln;sn++)for(var wn=arguments[sn],gr=0,mr=wn.length;gr<mr;gr++,mn++)zn[mn]=wn[gr];return zn}([Ye],ze(Ke=Ke===void 0?{}:Ke)).join("")});var Se,we=typeof Float32Array!="undefined"?Float32Array:Array;function ce(){var Ye=new we(9);return we!=Float32Array&&(Ye[1]=0,Ye[2]=0,Ye[3]=0,Ye[5]=0,Ye[6]=0,Ye[7]=0),Ye[0]=1,Ye[4]=1,Ye[8]=1,Ye}Math.hypot||(Math.hypot=function(){for(var Ye=0,Ke=arguments.length;Ke--;)Ye+=arguments[Ke]*arguments[Ke];return Math.sqrt(Ye)});var Ze=function(Ye,Vi,Si){var sn=Vi[0],Ln=Vi[1],zn=Vi[2],mn=Vi[3],wn=Vi[4],gr=Vi[5],mr=Vi[6],ai=Vi[7],Vi=Vi[8],fo=Si[0],ei=Si[1],zi=Si[2],Li=Si[3],Zr=Si[4],go=Si[5],Mi=Si[6],bo=Si[7],Si=Si[8];return Ye[0]=fo*sn+ei*mn+zi*mr,Ye[1]=fo*Ln+ei*wn+zi*ai,Ye[2]=fo*zn+ei*gr+zi*Vi,Ye[3]=Li*sn+Zr*mn+go*mr,Ye[4]=Li*Ln+Zr*wn+go*ai,Ye[5]=Li*zn+Zr*gr+go*Vi,Ye[6]=Mi*sn+bo*mn+Si*mr,Ye[7]=Mi*Ln+bo*wn+Si*ai,Ye[8]=Mi*zn+bo*gr+Si*Vi,Ye};function xt(){var Ye=new we(16);return we!=Float32Array&&(Ye[1]=0,Ye[2]=0,Ye[3]=0,Ye[4]=0,Ye[6]=0,Ye[7]=0,Ye[8]=0,Ye[9]=0,Ye[11]=0,Ye[12]=0,Ye[13]=0,Ye[14]=0),Ye[0]=1,Ye[5]=1,Ye[10]=1,Ye[15]=1,Ye}var ht=function(Ye,Mi,Ct){var sn=Mi[0],Ln=Mi[1],zn=Mi[2],mn=Mi[3],wn=Mi[4],gr=Mi[5],mr=Mi[6],ai=Mi[7],Vi=Mi[8],fo=Mi[9],ei=Mi[10],zi=Mi[11],Li=Mi[12],Zr=Mi[13],go=Mi[14],Mi=Mi[15],bo=Ct[0],Si=Ct[1],wo=Ct[2],Yo=Ct[3];return Ye[0]=bo*sn+Si*wn+wo*Vi+Yo*Li,Ye[1]=bo*Ln+Si*gr+wo*fo+Yo*Zr,Ye[2]=bo*zn+Si*mr+wo*ei+Yo*go,Ye[3]=bo*mn+Si*ai+wo*zi+Yo*Mi,bo=Ct[4],Si=Ct[5],wo=Ct[6],Yo=Ct[7],Ye[4]=bo*sn+Si*wn+wo*Vi+Yo*Li,Ye[5]=bo*Ln+Si*gr+wo*fo+Yo*Zr,Ye[6]=bo*zn+Si*mr+wo*ei+Yo*go,Ye[7]=bo*mn+Si*ai+wo*zi+Yo*Mi,bo=Ct[8],Si=Ct[9],wo=Ct[10],Yo=Ct[11],Ye[8]=bo*sn+Si*wn+wo*Vi+Yo*Li,Ye[9]=bo*Ln+Si*gr+wo*fo+Yo*Zr,Ye[10]=bo*zn+Si*mr+wo*ei+Yo*go,Ye[11]=bo*mn+Si*ai+wo*zi+Yo*Mi,bo=Ct[12],Si=Ct[13],wo=Ct[14],Yo=Ct[15],Ye[12]=bo*sn+Si*wn+wo*Vi+Yo*Li,Ye[13]=bo*Ln+Si*gr+wo*fo+Yo*Zr,Ye[14]=bo*zn+Si*mr+wo*ei+Yo*go,Ye[15]=bo*mn+Si*ai+wo*zi+Yo*Mi,Ye};function Gt(Ye){for(var Ke=[],Ct=1;Ct<arguments.length;Ct++)Ke[Ct-1]=arguments[Ct];return Ye?Ke.reduce(function(sn,Ln){return function(zn){return Ln(sn(zn))}},Ye):De}function mt(Ye){return Ye instanceof Float32Array||Ye instanceof Array}function gt(Ye,Ke,Ct){for(;Ye<Ke;)Ye+=2*Math.PI;for(;Ct<Ye;)Ye-=2*Math.PI;return Ye}ot=new we(3),we!=Float32Array&&(ot[0]=0,ot[1]=0,ot[2]=0),ot=new we(4),we!=Float32Array&&(ot[0]=0,ot[1]=0,ot[2]=0,ot[3]=0);function Be(mn,Ke,Ct,sn,Ln){var zn=(mn=X(mn,2))[0],mn=mn[1],wn=ce();return zn=[zn,mn],(mn=wn)[0]=1,mn[1]=0,mn[2]=0,mn[3]=0,mn[4]=1,mn[5]=0,mn[6]=zn[0],mn[7]=zn[1],mn[8]=1,mn}function Re(Ye,...Ke){return Ke.reduce((Ct,sn)=>Ln=>Ct(sn(Ln)),Ye)}function bt(Ye,Ke){return Ke-Ye?Ct=>(Ct-Ye)/(Ke-Ye):Ct=>.5}const yt=Math.sqrt(50),At=Math.sqrt(10),bn=Math.sqrt(2);function He(Ye,Ke,Ct){return Ke=(Ke-Ye)/Math.max(0,Ct),Ye=Math.floor(Math.log(Ke)/Math.LN10),Ct=Ke/vf(10,Ye),0<=Ye?(Ct>=yt?10:Ct>=At?5:Ct>=bn?2:1)*vf(10,Ye):-vf(10,-Ye)/(Ct>=yt?10:Ct>=At?5:Ct>=bn?2:1)}const Rt=(Ye,Ke,Ct=5)=>{Ye=[Ye,Ke];let sn=0,Ln=Ye.length-1,zn=Ye[sn],mn=Ye[Ln],wn;return mn<zn&&([zn,mn]=[mn,zn],[sn,Ln]=[Ln,sn]),0<(wn=He(zn,mn,Ct))?(zn=Math.floor(zn/wn)*wn,mn=Math.ceil(mn/wn)*wn,wn=He(zn,mn,Ct)):wn<0&&(zn=Math.ceil(zn*wn)/wn,mn=Math.floor(mn*wn)/wn,wn=He(zn,mn,Ct)),0<wn?(Ye[sn]=Math.floor(zn/wn)*wn,Ye[Ln]=Math.ceil(mn/wn)*wn):wn<0&&(Ye[sn]=Math.ceil(zn*wn)/wn,Ye[Ln]=Math.floor(mn*wn)/wn),Ye};function Oe(Ye){return Ye!=null&&!Number.isNaN(Ye)}function it(Ye,Ke){return Ct=>{Ct.prototype.rescale=function(){this.initRange(),this.nice();var[sn]=this.chooseTransforms();this.composeOutput(sn,this.chooseClamp(sn))},Ct.prototype.initRange=function(){var sn=this.options.interpolator;this.options.range=Ye(sn)},Ct.prototype.composeOutput=function(sn,Ln){var zn,{domain:wn,interpolator:mn,round:gr}=this.getOptions(),wn=Ke(wn.map(sn)),gr=gr?(zn=mn,mr=>(mr=zn(mr),oe(mr)?Math.round(mr):mr)):mn;this.output=Re(gr,wn,Ln,sn)},Ct.prototype.invert=void 0}}var Qe,ot={exports:{}},Ne={exports:{}},$e=function(Ye){return!(!Ye||typeof Ye=="string")&&(Ye instanceof Array||Array.isArray(Ye)||0<=Ye.length&&(Ye.splice instanceof Function||Object.getOwnPropertyDescriptor(Ye,Ye.length-1)&&Ye.constructor.name!=="String"))},Ot=Array.prototype.concat,vt=Array.prototype.slice,Me=Ne.exports=function(Ye){for(var Ke=[],Ct=0,sn=Ye.length;Ct<sn;Ct++){var Ln=Ye[Ct];$e(Ln)?Ke=Ot.call(Ke,vt.call(Ln)):Ke.push(Ln)}return Ke},Xt=(Me.wrap=function(Ye){return function(){return Ye(Me(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),on=Ne.exports,Fn=Object.hasOwnProperty,$n=Object.create(null);for(Qe in Xt)Fn.call(Xt,Qe)&&($n[Xt[Qe]]=Qe);var nr=ot.exports={to:{},get:{}};function Ht(Ye,Ke,Ct){return Math.min(Math.max(Ke,Ye),Ct)}function Jt(Ye){return Ye=Math.round(Ye).toString(16).toUpperCase(),Ye.length<2?"0"+Ye:Ye}nr.get=function(Ye){var Ke,Ct;switch(Ye.substring(0,3).toLowerCase()){case"hsl":Ke=nr.get.hsl(Ye),Ct="hsl";break;case"hwb":Ke=nr.get.hwb(Ye),Ct="hwb";break;default:Ke=nr.get.rgb(Ye),Ct="rgb"}return Ke?{model:Ct,value:Ke}:null},nr.get.rgb=function(Ye){if(!Ye)return null;var Ke,Ct,sn,Ln=[0,0,0,1];if(Ke=Ye.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(sn=Ke[2],Ke=Ke[1],Ct=0;Ct<3;Ct++){var zn=2*Ct;Ln[Ct]=parseInt(Ke.slice(zn,2+zn),16)}sn&&(Ln[3]=parseInt(sn,16)/255)}else if(Ke=Ye.match(/^#([a-f0-9]{3,4})$/i)){for(sn=(Ke=Ke[1])[3],Ct=0;Ct<3;Ct++)Ln[Ct]=parseInt(Ke[Ct]+Ke[Ct],16);sn&&(Ln[3]=parseInt(sn+sn,16)/255)}else{if(Ke=Ye.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/))for(Ct=0;Ct<3;Ct++)Ln[Ct]=parseInt(Ke[Ct+1],0);else{if(!(Ke=Ye.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(Ke=Ye.match(/^(\w+)$/))?Ke[1]==="transparent"?[0,0,0,0]:Fn.call(Xt,Ke[1])?((Ln=Xt[Ke[1]])[3]=1,Ln):null:null;for(Ct=0;Ct<3;Ct++)Ln[Ct]=Math.round(2.55*parseFloat(Ke[Ct+1]))}Ke[4]&&(Ke[5]?Ln[3]=.01*parseFloat(Ke[4]):Ln[3]=parseFloat(Ke[4]))}for(Ct=0;Ct<3;Ct++)Ln[Ct]=Ht(Ln[Ct],0,255);return Ln[3]=Ht(Ln[3],0,1),Ln},nr.get.hsl=function(Ye){var Ke;return(Ye=Ye&&Ye.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(Ke=parseFloat(Ye[4]),[(parseFloat(Ye[1])%360+360)%360,Ht(parseFloat(Ye[2]),0,100),Ht(parseFloat(Ye[3]),0,100),Ht(isNaN(Ke)?1:Ke,0,1)]):null},nr.get.hwb=function(Ye){var Ke;return(Ye=Ye&&Ye.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(Ke=parseFloat(Ye[4]),[(parseFloat(Ye[1])%360+360)%360,Ht(parseFloat(Ye[2]),0,100),Ht(parseFloat(Ye[3]),0,100),Ht(isNaN(Ke)?1:Ke,0,1)]):null},nr.to.hex=function(){var Ye=on(arguments);return"#"+Jt(Ye[0])+Jt(Ye[1])+Jt(Ye[2])+(Ye[3]<1?Jt(Math.round(255*Ye[3])):"")},nr.to.rgb=function(){var Ye=on(arguments);return Ye.length<4||Ye[3]===1?"rgb("+Math.round(Ye[0])+", "+Math.round(Ye[1])+", "+Math.round(Ye[2])+")":"rgba("+Math.round(Ye[0])+", "+Math.round(Ye[1])+", "+Math.round(Ye[2])+", "+Ye[3]+")"},nr.to.rgb.percent=function(){var Ye=on(arguments),Ke=Math.round(Ye[0]/255*100),Ct=Math.round(Ye[1]/255*100),sn=Math.round(Ye[2]/255*100);return Ye.length<4||Ye[3]===1?"rgb("+Ke+"%, "+Ct+"%, "+sn+"%)":"rgba("+Ke+"%, "+Ct+"%, "+sn+"%, "+Ye[3]+")"},nr.to.hsl=function(){var Ye=on(arguments);return Ye.length<4||Ye[3]===1?"hsl("+Ye[0]+", "+Ye[1]+"%, "+Ye[2]+"%)":"hsla("+Ye[0]+", "+Ye[1]+"%, "+Ye[2]+"%, "+Ye[3]+")"},nr.to.hwb=function(){var Ye=on(arguments),Ke="";return 4<=Ye.length&&Ye[3]!==1&&(Ke=", "+Ye[3]),"hwb("+Ye[0]+", "+Ye[1]+"%, "+Ye[2]+"%"+Ke+")"},nr.to.keyword=function(Ye){return $n[Ye.slice(0,3)]};var _n=ot.exports;function tr(Ye,Ke,Ct){let sn=Ct;return sn<0&&(sn+=1),1<sn&&--sn,sn<1/6?Ye+6*(Ke-Ye)*sn:sn<.5?Ke:sn<2/3?Ye+(Ke-Ye)*(2/3-sn)*6:Ye}function an(Ln){var Ke,Ct,sn,Ln=_n.get(Ln);return Ln?({model:Ln,value:Ke}=Ln,Ln==="rgb"?Ke:Ln==="hsl"?(Ke=(Ln=Ke)[0]/360,Ct=Ln[1]/100,sn=Ln[2]/100,Ln=Ln[3],Ct==0?[255*sn,255*sn,255*sn,Ln]:[255*tr(Ct=2*sn-(sn=sn<.5?sn*(1+Ct):sn+Ct-sn*Ct),sn,Ke+1/3),255*tr(Ct,sn,Ke),255*tr(Ct,sn,Ke-1/3),Ln]):null):null}const Ut=(Ye,Ke)=>Ct=>Ye*(1-Ct)+Ke*Ct,Dt=(Ye,Ke)=>{if(typeof Ye=="number"&&typeof Ke=="number")return Ut(Ye,Ke);if(typeof Ye!="string"||typeof Ke!="string")return()=>Ye;{var Ct=Ye,sn=Ke;const Ln=an(Ct),zn=an(sn);return Ln===null||zn===null?Ln?()=>Ct:()=>sn:mn=>{var wn=new Array(4);for(let zi=0;zi<4;zi+=1){var gr=Ln[zi],mr=zn[zi];wn[zi]=gr*(1-mn)+mr*mn}var[ai,Vi,fo,ei]=wn;return`rgba(${Math.round(ai)}, ${Math.round(Vi)}, ${Math.round(fo)}, ${ei})`}}},Ie=(Ye,Ke)=>{const Ct=Ut(Ye,Ke);return sn=>Math.round(Ct(sn))};function qe({map:Ye,initKey:Ke},Ct){return Ke=Ke(Ct),Ye.has(Ke)?Ye.get(Ke):Ct}function Bt(Ye){return typeof Ye=="object"?Ye.valueOf():Ye}class j extends Map{constructor(Ke){if(super(),this.map=new Map,this.initKey=Bt,Ke!==null)for(var[Ct,sn]of Ke)this.set(Ct,sn)}get(Ke){return super.get(qe({map:this.map,initKey:this.initKey},Ke))}has(Ke){return super.has(qe({map:this.map,initKey:this.initKey},Ke))}set(Ke,Ct){return super.set(([{map:Ke,initKey:sn},Ln]=[{map:this.map,initKey:this.initKey},Ke],sn=sn(Ln),Ke.has(sn)?Ke.get(sn):(Ke.set(sn,Ln),Ln)),Ct);var sn,Ln}delete(Ke){return super.delete(([{map:Ke,initKey:Ct},sn]=[{map:this.map,initKey:this.initKey},Ke],Ct=Ct(sn),Ke.has(Ct)&&(sn=Ke.get(Ct),Ke.delete(Ct)),sn));var Ct,sn}}class le{constructor(Ke){this.options=ye({},this.getDefaultOptions()),this.update(Ke)}getOptions(){return this.options}update(Ke={}){this.options=ye({},this.options,Ke),this.rescale(Ke)}rescale(Ke){}}const z=Symbol("defaultUnknown");function de(Ye,Ke,Ct){for(let sn=0;sn<Ke.length;sn+=1)Ye.has(Ke[sn])||Ye.set(Ct(Ke[sn]),sn)}function Zt(Ke){var{value:Ke,from:Ct,to:sn,mapper:Ln,notFoundReturn:zn}=Ke;let mn=Ln.get(Ke);if(mn===void 0){if(zn!==z)return zn;mn=Ct.push(Ke)-1,Ln.set(Ke,mn)}return sn[mn%sn.length]}function nt(Ye){return Ye instanceof Date?Ke=>""+Ke:typeof Ye=="object"?Ke=>JSON.stringify(Ke):Ke=>Ke}class St extends le{getDefaultOptions(){return{domain:[],range:[],unknown:z}}constructor(Ke){super(Ke)}map(Ke){return this.domainIndexMap.size===0&&de(this.domainIndexMap,this.getDomain(),this.domainKey),Zt({value:this.domainKey(Ke),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(Ke){return this.rangeIndexMap.size===0&&de(this.rangeIndexMap,this.getRange(),this.rangeKey),Zt({value:this.rangeKey(Ke),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(Ke){var[Ct]=this.options.domain,[sn]=this.options.range;this.domainKey=nt(Ct),this.rangeKey=nt(sn),this.rangeIndexMap?(Ke&&!Ke.range||this.rangeIndexMap.clear(),Ke&&!Ke.domain&&!Ke.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)):(this.rangeIndexMap=new Map,this.domainIndexMap=new Map)}clone(){return new St(this.options)}getRange(){return this.options.range}getDomain(){var Ke,Ct;return this.sortedDomain||({domain:Ke,compare:Ct}=this.options,this.sortedDomain=Ct?[...Ke].sort(Ct):Ke),this.sortedDomain}}function In(Zr){const{domain:Ke,range:Ct,paddingOuter:sn,paddingInner:Ln,flex:zn,round:mn,align:wn}=Zr;var gr=Ke.length,ei=0<(ei=(Zr=gr)-(mr=zn).length)?[...mr,...new Array(ei).fill(1)]:ei<0?mr.slice(0,Zr):mr,[Zr,mr]=Ct,mr=mr-Zr,Li=mr/(2/gr*sn+1-1/gr*Ln);const ai=Li*Ln/gr;Li-=gr*ai;const Vi=function(Si){const wo=Math.min(...Si);return Si.map(Yo=>Yo/wo)}(ei),fo=Li/Vi.reduce((Si,wo)=>Si+wo);var ei=new j(Ke.map((Si,wo)=>(wo=Vi[wo]*fo,[Si,mn?Math.floor(wo):wo]))),zi=new j(Ke.map((Si,wo)=>(wo=Vi[wo]*fo+ai,[Si,mn?Math.floor(wo):wo]))),Li=Array.from(zi.values()).reduce((Si,wo)=>Si+wo),Zr=Zr+(mr-(Li-Li/gr*Ln))*wn;let go=mn?Math.round(Zr):Zr;var Mi=new Array(gr);for(let Si=0;Si<gr;Si+=1){Mi[Si]=(bo=go,Math.round(1e12*bo)/1e12);var bo=Ke[Si];go+=zi.get(bo)}return{valueBandWidth:ei,valueStep:zi,adjustedRange:Mi}}class Wn extends St{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:z,flex:[]}}constructor(Ke){super(Ke)}clone(){return new Wn(this.options)}getStep(Ke){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:Ke===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(Ke)}getBandWidth(Ke){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:Ke===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(Ke)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:Ke,paddingInner:Ct}=this.options;return 0<Ke?Ke:Ct}getPaddingOuter(){var{padding:Ke,paddingOuter:Ct}=this.options;return 0<Ke?Ke:Ct}rescale(){super.rescale();var{align:sn,domain:Ke,range:Ln,round:zn,flex:Ct}=this.options,{adjustedRange:sn,valueBandWidth:Ln,valueStep:zn}=function(mr){var wn=mr.domain;if((wn=wn.length)===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!((gr=mr.flex)==null||!gr.length))return In(mr);var{range:gr,paddingOuter:mr,paddingInner:ai,round:Vi,align:fo}=mr;let ei,zi,Li=gr[0];return gr=gr[1]-Li,ei=gr/Math.max(1,2*mr+(wn-ai)),Vi&&(ei=Math.floor(ei)),Li+=(gr-ei*(wn-ai))*fo,zi=ei*(1-ai),Vi&&(Li=Math.round(Li),zi=Math.round(zi)),mr=new Array(wn).fill(0).map((Zr,go)=>Li+go*ei),{valueStep:ei,valueBandWidth:zi,adjustedRange:mr}}({align:sn,range:Ln,round:zn,flex:Ct,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:Ke});this.valueStep=zn,this.valueBandWidth=Ln,this.adjustedRange=sn}}const qn=(Ye,Ke,Ct)=>{let sn,Ln,zn=Ye,mn=Ke;if(zn===mn&&0<Ct)return[zn];let wn=He(zn,mn,Ct);if(wn===0||!Number.isFinite(wn))return[];if(0<wn){zn=Math.ceil(zn/wn),mn=Math.floor(mn/wn),Ln=new Array(sn=Math.ceil(mn-zn+1));for(let gr=0;gr<sn;gr+=1)Ln[gr]=(zn+gr)*wn}else{wn=-wn,zn=Math.ceil(zn*wn),mn=Math.floor(mn*wn),Ln=new Array(sn=Math.ceil(mn-zn+1));for(let gr=0;gr<sn;gr+=1)Ln[gr]=(zn+gr)/wn}return Ln},hn=(sn,zn,Ct)=>{var[sn,Ln]=sn,[zn,mn]=zn;let wn,gr;return Re(gr=sn<Ln?(wn=bt(sn,Ln),Ct(zn,mn)):(wn=bt(Ln,sn),Ct(mn,zn)),wn)},pt=(Ye,Ke,Ct)=>{const sn=Math.min(Ye.length,Ke.length)-1,Ln=new Array(sn),zn=new Array(sn);var mn=Ye[0]>Ye[sn],wn=mn?[...Ye].reverse():Ye,gr=mn?[...Ke].reverse():Ke;for(let mr=0;mr<sn;mr+=1)Ln[mr]=bt(wn[mr],wn[mr+1]),zn[mr]=Ct(gr[mr],gr[mr+1]);return mr=>{var ai=function(fo,ei,zi,Li,Zr){let go=zi||0,Mi=Li||fo.length;for(var bo=Zr||(wo=>wo);go<Mi;){var Si=Math.floor((go+Mi)/2);bo(fo[Si])>ei?Mi=Si:go=Si+1}return go}(Ye,mr,1,sn)-1,Vi=Ln[ai];return Re(zn[ai],Vi)(mr)}},Wt=(Ye,Ke,Ct,sn)=>(2<Math.min(Ye.length,Ke.length)?pt:hn)(Ye,Ke,sn?Ie:Ct);class An extends le{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Ut,tickCount:5}}map(Ke){return Oe(Ke)?this.output(Ke):this.options.unknown}invert(Ke){return Oe(Ke)?this.input(Ke):this.options.unknown}nice(){var Ke,Ct,sn,Ln;this.options.nice&&([Ke,Ct,sn,...Ln]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(Ke,Ct,sn,...Ln))}getTicks(){var Ke=this.options.tickMethod,[Ct,sn,Ln,...zn]=this.getTickMethodOptions();return Ke(Ct,sn,Ln,...zn)}getTickMethodOptions(){var{domain:Ke,tickCount:Ct}=this.options;return[Ke[0],Ke[Ke.length-1],Ct]}chooseNice(){return Rt}rescale(){this.nice();var[Ke,Ct]=this.chooseTransforms();this.composeOutput(Ke,this.chooseClamp(Ke)),this.composeInput(Ke,Ct,this.chooseClamp(Ct))}chooseClamp(sn){var{clamp:Ct,range:Ln}=this.options,sn=this.options.domain.map(sn),Ln=Math.min(sn.length,Ln.length);if(Ct){Ct=sn[0],sn=sn[Ln-1];const zn=sn<Ct?sn:Ct,mn=sn<Ct?Ct:sn;return wn=>Math.min(Math.max(zn,wn),mn)}return De}composeOutput(Ke,Ct){var{domain:mn,range:sn,round:Ln,interpolate:zn}=this.options,mn=Wt(mn.map(Ke),sn,zn,Ln);this.output=Re(mn,Ct,Ke)}composeInput(Ke,Ct,sn){var{domain:Ln,range:zn}=this.options,zn=Wt(zn,Ln.map(Ke),Ut);this.input=Re(Ct,sn,zn)}}class Pn extends An{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Dt,tickMethod:qn,tickCount:5}}chooseTransforms(){return[De,De]}clone(){return new Pn(this.options)}}class Xn extends Wn{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:z,paddingInner:1,paddingOuter:0}}constructor(Ke){super(Ke)}getPaddingInner(){return 1}clone(){return new Xn(this.options)}update(Ke){super.update(Ke)}getPaddingOuter(){return this.options.padding}}function dt(Ye,Ke){for(var Ct=[],sn=0,Ln=Ye.length;sn<Ln;sn++)Ct.push(Ye[sn].substr(0,Ke));return Ct}var be,Ne=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ot=["January","February","March","April","May","June","July","August","September","October","November","December"],Pt=dt(ot,3);(function(Ye){for(var Ke=[],Ct=1;Ct<arguments.length;Ct++)Ke[Ct-1]=arguments[Ct];for(var sn=0,Ln=Ke;sn<Ln.length;sn++){var zn,mn=Ln[sn];for(zn in mn)Ye[zn]=mn[zn]}})({},{dayNamesShort:dt(Ne,3),dayNames:Ne,monthNamesShort:Pt,monthNames:ot,amPm:["am","pm"],DoFn:function(Ye){return Ye+["th","st","nd","rd"][3<Ye%10?0:(Ye-Ye%10!=10?1:0)*Ye%10]}});var It;let xn=be=class extends Pn{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:De,tickMethod:qn,tickCount:5}}constructor(Ye){super(Ye)}clone(){return new be(this.options)}};xn=be=function(Ye,Ke,Ct,sn){var Ln,zn=arguments.length,mn=zn<3?Ke:sn===null?sn=Object.getOwnPropertyDescriptor(Ke,Ct):sn;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")mn=Reflect.decorate(Ye,Ke,Ct,sn);else for(var wn=Ye.length-1;0<=wn;wn--)(Ln=Ye[wn])&&(mn=(zn<3?Ln(mn):3<zn?Ln(Ke,Ct,mn):Ln(Ke,Ct))||mn);return 3<zn&&mn&&Object.defineProperty(Ke,Ct,mn),mn}([it(function(Ye){return[Ye(0),Ye(1)]},Ke=>{var[Ke,Ct]=Ke;return Re(Ut(0,1),bt(Ke,Ct))})],xn);let Qn=It=class extends Pn{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:De,tickMethod:qn,tickCount:5}}constructor(Ye){super(Ye)}clone(){return new It(this.options)}};Qn=It=function(Ye,Ke,Ct,sn){var Ln,zn=arguments.length,mn=zn<3?Ke:sn===null?sn=Object.getOwnPropertyDescriptor(Ke,Ct):sn;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")mn=Reflect.decorate(Ye,Ke,Ct,sn);else for(var wn=Ye.length-1;0<=wn;wn--)(Ln=Ye[wn])&&(mn=(zn<3?Ln(mn):3<zn?Ln(Ke,Ct,mn):Ln(Ke,Ct))||mn);return 3<zn&&mn&&Object.defineProperty(Ke,Ct,mn),mn}([it(function(Ye){return[Ye(0),Ye(.5),Ye(1)]},Ye=>{const[Ke,Ct,sn]=Ye,Ln=Re(Ut(0,.5),bt(Ke,Ct)),zn=Re(Ut(.5,1),bt(Ct,sn));return mn=>(Ke>sn?mn<Ct?zn:Ln:mn<Ct?Ln:zn)(mn)})],Qn);function br(Ye,Ke,Ct,sn,Ln){var zn=new Pn({range:[Ke,Ke+sn]}),mn=new Pn({range:[Ct,Ct+Ln]});return{transform:function(mr){var mr=X(mr,2),gr=mr[0],mr=mr[1];return[zn.map(gr),mn.map(mr)]},untransform:function(mr){var mr=X(mr,2),gr=mr[0],mr=mr[1];return[zn.invert(gr),mn.invert(mr)]}}}function Jn(Ye,Ke,Ct,sn,Ln){return(0,X(Ye,1)[0])(Ke,Ct,sn,Ln)}function Ae(Ye,Ke,Ct,sn,Ln){return X(Ye,1)[0]}function xe(gr,Ke,Ct,sn,Ln){var zn=(gr=X(gr,4))[0],mn=gr[1],wn=gr[2],gr=gr[3],mr=new Pn({range:[wn,gr]}),ai=new Pn({range:[zn,mn]}),Vi=1<(wn=Ln/sn)?1:wn,fo=1<wn?1/wn:1;return{transform:function(Li){var Li=X(Li,2),zi=Li[0],Li=Li[1],zi=ai.map(zi),Li=mr.map(Li);return[.5*(Li*Math.cos(zi)*Vi)+.5,.5*(Li*Math.sin(zi)*fo)+.5]},untransform:function(Zr){var Zr=X(Zr,2),zi=Zr[0],Zr=Zr[1],zi=2*(zi-.5)/Vi,Zr=2*(Zr-.5)/fo,Li=Math.sqrt(Math.pow(zi,2)+Math.pow(Zr,2)),Zr=gt(Math.atan2(Zr,zi),zn,mn);return[ai.invert(Zr),mr.invert(Li)]}}}function ke(Ye,Ke,Ct,sn,Ln){return{transform:function(mn){var mn=X(mn,2),wn=mn[0];return[mn[1],wn]},untransform:function(mn){var mn=X(mn,2),wn=mn[0];return[mn[1],wn]}}}function tt(Ye){for(var Ke=[],Ct=1;Ct<arguments.length;Ct++)Ke[Ct-1]=arguments[Ct];return Gn.apply(void 0,E([[-1,-1]],X(Ke),!1))}function Et(Ye){for(var Ke=[],Ct=1;Ct<arguments.length;Ct++)Ke[Ct-1]=arguments[Ct];return Gn.apply(void 0,E([[-1,1]],X(Ke),!1))}function tn(Ye){for(var Ke=[],Ct=1;Ct<arguments.length;Ct++)Ke[Ct-1]=arguments[Ct];return Gn.apply(void 0,E([[1,-1]],X(Ke),!1))}function fn(mn,Ke,Ct,sn,Ln){var zn,mn=X(mn,1)[0],wn=ce();return wn=wn,mn=mn,zn=Math.sin(mn),mn=Math.cos(mn),wn[0]=mn,wn[1]=zn,wn[2]=0,wn[3]=-zn,wn[4]=mn,wn[5]=0,wn[6]=0,wn[7]=0,wn[8]=1,wn}function _t(Ye,Ke,Ct,sn,Ln){var zn=(Ye=X(Ye,4))[0],mn=Ye[1],wn=Ye[2],gr=(Ye[3]-wn)/(+mn/(2*Math.PI)+1),mr=gr/(2*Math.PI),ai=new Pn({range:[wn,wn+.99*gr]}),Vi=new Pn({range:[zn,mn]}),fo=1<(Ye=Ln/sn)?1:Ye,ei=1<Ye?1/Ye:1;return{transform:function(Zr){var Zr=X(Zr,2),Li=Zr[0],Zr=Zr[1],Li=Vi.map(Li),Zr=ai.map(Zr);return[.5*(Math.cos(Li)*(mr*Li+Zr)*fo)+.5,.5*(Math.sin(Li)*(mr*Li+Zr)*ei)+.5]},untransform:function(Zr){var Zr=X(Zr,2),go=Zr[0],Zr=Zr[1],go=2*(go-.5)/fo,Zr=2*(Zr-.5)/ei,Li=Math.sqrt(Math.pow(go,2)+Math.pow(Zr,2)),Zr=gt(Math.atan2(Zr,go)+Math.floor(Li/gr)*Math.PI*2,zn,mn),go=Li-mr*Zr;return[Vi.invert(Zr),ai.invert(go)]}}}function en(gr,Ke,Ct,sn,Ln){var zn=(gr=X(gr,4))[0],mn=gr[1],wn=gr[2],gr=gr[3],mr=new Pn({range:[wn,gr]});return{transform:function(ai){for(var Vi=[],fo=ai.length,ei=new Xn({domain:new Array(fo).fill(0).map(function(go,Mi){return Mi}),range:[zn,mn]}),zi=0;zi<fo;zi++){var Zr=ai[zi],Li=ei.map(zi),Zr=mr.map(Zr);Vi.push(Li,Zr)}return Vi},untransform:function(ai){for(var Vi=[],fo=0;fo<ai.length;fo+=2){var ei=ai[fo+1];Vi.push(mr.invert(ei))}return Vi}}}var Gn=function(mn,Ke,Ct,sn,Ln){var mn=X(mn,2),zn=mn[0],mn=mn[1],wn=ce();return zn=[zn,mn],(mn=wn)[0]=zn[0],mn[1]=0,mn[2]=0,mn[3]=0,mn[4]=zn[1],mn[5]=0,mn[6]=0,mn[7]=0,mn[8]=1,mn};function Tr(Ye){return 1/Math.tan(Ye)}function jr(Ye,Ke,Ct,sn,Ln){var zn=Tr(X(Ye,1)[0]);return{transform:function(gr){var gr=X(gr,2),wn=gr[0],gr=gr[1];return[wn+gr*zn,gr]},untransform:function(gr){var gr=X(gr,2),wn=gr[0],gr=gr[1];return[wn-gr*zn,gr]}}}function vr(Ye,Ke,Ct,sn,Ln){var zn=Tr(X(Ye,1)[0]);return{transform:function(wn){var wn=X(wn,2),gr=wn[0];return[gr,wn[1]+gr*zn]},untransform:function(wn){var wn=X(wn,2),gr=wn[0];return[gr,wn[1]-gr*zn]}}}function Ur(Ye,Ke,Ct,wn,mn){var zn=Ye<Ke,mn=(zn?Ke-wn:mn-Ke)||mn-wn,wn=zn?-1:1;return wn*mn*(Ct+1)/(Ct+mn/((Ye-Ke)*wn))+Ke}function Fr(Ye,Ke,Ct,sn,mn){var zn=Ye<Ke,mn=(zn?Ke-sn:mn-Ke)||mn-sn;return mn/(mn*(Ct+1)/(Ye-Ke)-Ct*(zn?-1:1))+Ke}function qr(Ye,Ke,Ct){return Ct?new Pn({range:[0,1],domain:[0,Ke]}).map(Ye):Ye}function wr(wn,Ke,Ct,sn,Ln){var zn=(wn=X(wn,3))[0],mn=wn[1],wn=wn[2],gr=qr(zn,sn,wn!==void 0&&wn);return{transform:function(Vi){var Vi=X(Vi,2),ai=Vi[0],Vi=Vi[1];return[Ur(ai,gr,mn,0,1),Vi]},untransform:function(Vi){var Vi=X(Vi,2),ai=Vi[0],Vi=Vi[1];return[Fr(ai,gr,mn,0,1),Vi]}}}function fi(wn,Ke,Ct,sn,Ln){var zn=(wn=X(wn,3))[0],mn=wn[1],wn=wn[2],gr=qr(zn,Ln,wn!==void 0&&wn);return{transform:function(mr){return mr=X(mr,2),[mr[0],Ur(mr[1],gr,mn,0,1)]},untransform:function(mr){return mr=X(mr,2),[mr[0],Fr(mr[1],gr,mn,0,1)]}}}function di(mr,Ke,Ct,sn,Ln){var zn=(mr=X(mr,5))[0],mn=mr[1],wn=mr[2],gr=mr[3],mr=mr[4],ai=qr(zn,sn,mr=mr!==void 0&&mr),Vi=qr(mn,Ln,mr);return{transform:function(zi){var zi=X(zi,2),ei=zi[0],zi=zi[1];return[Ur(ei,ai,wn,0,1),Ur(zi,Vi,gr,0,1)]},untransform:function(zi){var zi=X(zi,2),ei=zi[0],zi=zi[1];return[Fr(ei,ai,wn,0,1),Fr(zi,Vi,gr,0,1)]}}}function vi(mr,Ke,Ct,sn,Ln){var zn=(mr=X(mr,5))[0],mn=mr[1],wn=mr[2],gr=mr[3],mr=(mr=mr[4])!==void 0&&mr,ai=new Pn({range:[0,sn]}),Vi=new Pn({range:[0,Ln]}),fo=mr?zn:ai.map(zn),ei=mr?mn:Vi.map(mn);return{transform:function(Zr){var Zr=X(Zr,2),Li=Zr[0],Zr=Zr[1],go=ai.map(Li)-fo,Mi=Vi.map(Zr)-ei,bo=Math.sqrt(go*go+Mi*Mi);return wn<bo?[Li,Zr]:(Li=Ur(bo,0,gr,0,wn),Zr=Math.atan2(Mi,go),bo=fo+Li*Math.cos(Zr),Mi=ei+Li*Math.sin(Zr),[ai.invert(bo),Vi.invert(Mi)])},untransform:function(Zr){var Zr=X(Zr,2),Li=Zr[0],Zr=Zr[1],go=ai.map(Li)-fo,Mi=Vi.map(Zr)-ei,bo=Math.sqrt(go*go+Mi*Mi);return wn<bo?[Li,Zr]:(Li=Fr(bo,0,gr,0,wn),Zr=Math.atan2(Mi,go),bo=fo+Li*Math.cos(Zr),Mi=ei+Li*Math.sin(Zr),[ai.invert(bo),Vi.invert(Mi)])}}}function vo(Ye,Ke,Ct,sn,Ln,zn,mn){var wn=new Pn({range:[Ke,Ke+Ln]}),gr=new Pn({range:[Ct,Ct+zn]}),mr=new Pn({range:[sn,sn+mn]});return{transform:function(ei){var ei=X(ei,3),Vi=ei[0],fo=ei[1],ei=ei[2];return[wn.map(Vi),gr.map(fo),mr.map(ei)]},untransform:function(ei){var ei=X(ei,3),Vi=ei[0],fo=ei[1],ei=ei[2];return[wn.invert(Vi),gr.invert(fo),mr.invert(ei)]}}}function Oi(ai,Ke,Ct,sn,Ln,zn,mn){var wn,gr=(ai=X(ai,3))[0],mr=ai[1],ai=ai[2];return wn=xt(),gr=[gr,mr,ai],wn[0]=1,wn[1]=0,wn[2]=0,wn[3]=0,wn[4]=0,wn[5]=1,wn[6]=0,wn[7]=0,wn[8]=0,wn[9]=0,wn[10]=1,wn[11]=0,wn[12]=gr[0],wn[13]=gr[1],wn[14]=gr[2],wn[15]=1,wn}function Ko(Ye,Ke,Ct,sn,Ln,zn,mn){return{transform:function(gr){var gr=X(gr,3),mr=gr[0];return[gr[1],mr,gr[2]]},untransform:function(gr){var gr=X(gr,3),mr=gr[0];return[gr[1],mr,gr[2]]}}}function va(ai,Ke,Ct,sn,Ln,zn,mn){var wn,gr=(ai=X(ai,3))[0],mr=ai[1],ai=ai[2];return wn=xt(),gr=[gr,mr,ai],wn[0]=gr[0],wn[1]=0,wn[2]=0,wn[3]=0,wn[4]=0,wn[5]=gr[1],wn[6]=0,wn[7]=0,wn[8]=0,wn[9]=0,wn[10]=gr[2],wn[11]=0,wn[12]=0,wn[13]=0,wn[14]=0,wn[15]=1,wn}Co.prototype.update=function(Ye){this.options=ye({},this.options,Ye),this.recoordinate()},Co.prototype.clone=function(){return new Co(this.options)},Co.prototype.getOptions=function(){return this.options},Co.prototype.clear=function(){this.update({transformations:[]})},Co.prototype.getSize=function(){var Ye=this.options;return[Ye.width,Ye.height]},Co.prototype.getCenter=function(){var Ye=this.options,Ke=Ye.x,Ct=Ye.y;return[(2*Ke+Ye.width)/2,(2*Ct+Ye.height)/2]},Co.prototype.transform=function(){for(var Ye=[],Ke=0;Ke<arguments.length;Ke++)Ye[Ke]=arguments[Ke];var Ct=this.options.transformations;return this.update({transformations:E(E([],X(Ct),!1),[E([],X(Ye),!1)],!1)}),this},Co.prototype.map=function(Ye){return this.output(Ye)},Co.prototype.invert=function(Ye){return this.input(Ye)},Co.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Co.prototype.compose=function(Ye){function Ke(Si,wo){var Yo;wn.push((wo=wo===void 0?!0:wo)?(Yo=Si,function(Wa){for(var na=[],jo=0;jo<Wa.length-1;jo+=2){var Va=[Wa[jo],Wa[jo+1]],Va=Yo(Va);na.push.apply(na,E([],X(Va),!1))}return na}):Si)}var Ct,sn,Ln=(Ye=Ye===void 0?!1:Ye)?E([],X(this.options.transformations),!1).reverse():this.options.transformations,zn=Ye?function(Si){return Si.untransform}:function(Si){return Si.transform},mn=[],wn=[];try{for(var gr=ee(Ln),mr=gr.next();!mr.done;mr=gr.next()){var ai,Vi,fo,ei,zi,Li,Zr=X(mr.value),go=Zr[0],Mi=Zr.slice(1),bo=this.transformers[go];bo&&(Vi=(ai=this.options).x,fo=ai.y,ei=ai.width,zi=ai.height,mt(Li=bo(E([],X(Mi),!1),Vi,fo,ei,zi))?mn.push(Li):(mn.length&&(Ke(this.createMatrixTransform(mn,Ye)),mn.splice(0,mn.length)),Ke(zn(Li)||De,go!=="parallel")))}}catch(Si){Ct={error:Si}}finally{try{mr&&!mr.done&&(sn=gr.return)&&sn.call(gr)}finally{if(Ct)throw Ct.error}}return mn.length&&Ke(this.createMatrixTransform(mn,Ye)),Gt.apply(void 0,E([],X(wn),!1))},Co.prototype.createMatrixTransform=function(Ye,Ke){var Ct,sn,Ln,zn,mn,wn,gr,mr,ai,Vi,fo,ei,zi=ce();return Ke&&Ye.reverse(),Ye.forEach(function(Li){return Ze(zi,zi,Li)}),Ke&&(Ke=Ye=zi,(ei=new we(9))[0]=Ke[0],ei[1]=Ke[1],ei[2]=Ke[2],ei[3]=Ke[3],ei[4]=Ke[4],ei[5]=Ke[5],ei[6]=Ke[6],ei[7]=Ke[7],ei[8]=Ke[8],ei=(Ke=ei)[0],Ct=Ke[1],sn=Ke[2],Ln=Ke[3],zn=Ke[4],mn=Ke[5],wn=Ke[6],gr=Ke[7],mr=(Ke=Ke[8])*zn-mn*gr,fo=ei*mr+Ct*(ai=-Ke*Ln+mn*wn)+sn*(Vi=gr*Ln-zn*wn))&&(Ye[0]=mr*(fo=1/fo),Ye[1]=(-Ke*Ct+sn*gr)*fo,Ye[2]=(mn*Ct-sn*zn)*fo,Ye[3]=ai*fo,Ye[4]=(Ke*ei-sn*wn)*fo,Ye[5]=(-mn*ei+sn*Ln)*fo,Ye[6]=Vi*fo,Ye[7]=(-gr*ei+Ct*wn)*fo,Ye[8]=(zn*ei-Ct*Ln)*fo),function(wo){var Zr,go,Mi,bo,Si,wo=[wo[0],wo[1],1];return Mi=zi,bo=(go=Zr=wo)[0],Si=go[1],go=go[2],Zr[0]=bo*Mi[0]+Si*Mi[3]+go*Mi[6],Zr[1]=bo*Mi[1]+Si*Mi[4]+go*Mi[7],Zr[2]=bo*Mi[2]+Si*Mi[5]+go*Mi[8],[wo[0],wo[1]]}},Ne=Co;function Co(Ye){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:br,translate:Be,custom:Jn,matrix:Ae,polar:xe,transpose:ke,scale:Gn,"shear.x":jr,"shear.y":vr,reflect:tt,"reflect.x":Et,"reflect.y":tn,rotate:fn,helix:_t,parallel:en,fisheye:di,"fisheye.x":wr,"fisheye.y":fi,"fisheye.circular":vi},this.update(Ye)}Xo.prototype.update=function(Ye){this.options=ye({},this.options,Ye),this.recoordinate()},Xo.prototype.clone=function(){return new Xo(this.options)},Xo.prototype.getOptions=function(){return this.options},Xo.prototype.clear=function(){this.update({transformations:[]})},Xo.prototype.getSize=function(){var Ye=this.options;return[Ye.width,Ye.height,Ye.depth]},Xo.prototype.getCenter=function(){var Ye=this.options,Ke=Ye.x,Ct=Ye.y,sn=Ye.z;return[(2*Ke+Ye.width)/2,(2*Ct+Ye.height)/2,(2*sn+Ye.depth)/2]},Xo.prototype.transform=function(){for(var Ye=[],Ke=0;Ke<arguments.length;Ke++)Ye[Ke]=arguments[Ke];var Ct=this.options.transformations;return this.update({transformations:E(E([],X(Ct),!1),[E([],X(Ye),!1)],!1)}),this},Xo.prototype.map=function(Ye){return this.output(Ye)},Xo.prototype.invert=function(Ye){return this.input(Ye)},Xo.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Xo.prototype.compose=function(Ye){function Ke(Yo,Wa){var na;wn.push((Wa=Wa===void 0?!0:Wa)?(na=Yo,function(jo){for(var Va=[],fs=0;fs<jo.length-1;fs+=3){var Tt=[jo[fs],jo[fs+1],jo[fs+2]],Tt=na(Tt);Va.push.apply(Va,E([],X(Tt),!1))}return Va}):Yo)}var Ct,sn,Ln=(Ye=Ye===void 0?!1:Ye)?E([],X(this.options.transformations),!1).reverse():this.options.transformations,zn=Ye?function(Yo){return Yo.untransform}:function(Yo){return Yo.transform},mn=[],wn=[];try{for(var gr=ee(Ln),mr=gr.next();!mr.done;mr=gr.next()){var ai,Vi,fo,ei,zi,Li,Zr,go,Mi=X(mr.value),bo=Mi[0],Si=Mi.slice(1),wo=this.transformers[bo];wo&&(Vi=(ai=this.options).x,fo=ai.y,ei=ai.z,zi=ai.width,Li=ai.height,Zr=ai.depth,mt(go=wo(E([],X(Si),!1),Vi,fo,ei,zi,Li,Zr))?mn.push(go):(mn.length&&(Ke(this.createMatrixTransform(mn,Ye)),mn.splice(0,mn.length)),Ke(zn(go)||De,!0)))}}catch(Yo){Ct={error:Yo}}finally{try{mr&&!mr.done&&(sn=gr.return)&&sn.call(gr)}finally{if(Ct)throw Ct.error}}return mn.length&&Ke(this.createMatrixTransform(mn,Ye)),Gt.apply(void 0,E([],X(wn),!1))},Xo.prototype.createMatrixTransform=function(Ye,Ke){var Ct,sn,Ln,zn,mn,wn,gr,mr,ai,Vi,fo,ei,zi,Li,Zr,go,Mi,bo,Si,wo,Yo,Wa,na,jo,Va,fs,Tt,Ft,Dn=xt();return Ke&&Ye.reverse(),Ye.forEach(function(sr){return ht(Dn,Dn,sr)}),Ke&&(Ke=Ye=Dn,(Ft=new we(16))[0]=Ke[0],Ft[1]=Ke[1],Ft[2]=Ke[2],Ft[3]=Ke[3],Ft[4]=Ke[4],Ft[5]=Ke[5],Ft[6]=Ke[6],Ft[7]=Ke[7],Ft[8]=Ke[8],Ft[9]=Ke[9],Ft[10]=Ke[10],Ft[11]=Ke[11],Ft[12]=Ke[12],Ft[13]=Ke[13],Ft[14]=Ke[14],Ft[15]=Ke[15],Ft=(Ke=Ft)[0],Ct=Ke[1],sn=Ke[2],Ln=Ke[3],zn=Ke[4],mn=Ke[5],wn=Ke[6],gr=Ke[7],mr=Ke[8],ai=Ke[9],Vi=Ke[10],fo=Ke[11],ei=Ke[12],zi=Ke[13],Li=Ke[14],Ke=Ke[15],Tt=(Zr=Ft*mn-Ct*zn)*(fs=Vi*Ke-fo*Li)-(go=Ft*wn-sn*zn)*(Va=ai*Ke-fo*zi)+(Mi=Ft*gr-Ln*zn)*(jo=ai*Li-Vi*zi)+(bo=Ct*wn-sn*mn)*(na=mr*Ke-fo*ei)-(Si=Ct*gr-Ln*mn)*(Wa=mr*Li-Vi*ei)+(wo=sn*gr-Ln*wn)*(Yo=mr*zi-ai*ei))&&(Ye[0]=(mn*fs-wn*Va+gr*jo)*(Tt=1/Tt),Ye[1]=(sn*Va-Ct*fs-Ln*jo)*Tt,Ye[2]=(zi*wo-Li*Si+Ke*bo)*Tt,Ye[3]=(Vi*Si-ai*wo-fo*bo)*Tt,Ye[4]=(wn*na-zn*fs-gr*Wa)*Tt,Ye[5]=(Ft*fs-sn*na+Ln*Wa)*Tt,Ye[6]=(Li*Mi-ei*wo-Ke*go)*Tt,Ye[7]=(mr*wo-Vi*Mi+fo*go)*Tt,Ye[8]=(zn*Va-mn*na+gr*Yo)*Tt,Ye[9]=(Ct*na-Ft*Va-Ln*Yo)*Tt,Ye[10]=(ei*Si-zi*Mi+Ke*Zr)*Tt,Ye[11]=(ai*Mi-mr*Si-fo*Zr)*Tt,Ye[12]=(mn*Wa-zn*jo-wn*Yo)*Tt,Ye[13]=(Ft*jo-Ct*Wa+sn*Yo)*Tt,Ye[14]=(zi*go-ei*bo-Li*Zr)*Tt,Ye[15]=(mr*bo-ai*go+Vi*Zr)*Tt),function(il){var _i,bi,so,Ha,Bs,Os,il=[il[0],il[1],il[2],1];return so=Dn,Ha=(bi=_i=il)[0],Bs=bi[1],Os=bi[2],bi=bi[3],_i[0]=so[0]*Ha+so[4]*Bs+so[8]*Os+so[12]*bi,_i[1]=so[1]*Ha+so[5]*Bs+so[9]*Os+so[13]*bi,_i[2]=so[2]*Ha+so[6]*Bs+so[10]*Os+so[14]*bi,_i[3]=so[3]*Ha+so[7]*Bs+so[11]*Os+so[15]*bi,[il[0],il[1],il[2]]}},Pt=Xo;function Xo(Ye){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:vo,translate3D:Oi,scale3D:va,transpose3D:Ko},this.update(Ye)}D.Coordinate=Ne,D.Coordinate3D=Pt,Object.defineProperty(D,"__esModule",{value:!0})})},90857:function($t){"use strict";var W=Object.prototype.hasOwnProperty,D="~";function ee(){}Object.create&&(ee.prototype=Object.create(null),new ee().__proto__||(D=!1));function X(fe,ae,Ee){this.fn=fe,this.context=ae,this.once=Ee||!1}function E(fe,ae,Ee,oe,ze){if(typeof Ee!="function")throw new TypeError("The listener must be a function");var te=new X(Ee,oe||fe,ze),ye=D?D+ae:ae;return fe._events[ye]?fe._events[ye].fn?fe._events[ye]=[fe._events[ye],te]:fe._events[ye].push(te):(fe._events[ye]=te,fe._eventsCount++),fe}function ve(fe,ae){--fe._eventsCount===0?fe._events=new ee:delete fe._events[ae]}function re(){this._events=new ee,this._eventsCount=0}re.prototype.eventNames=function(){var ae=[],Ee,oe;if(this._eventsCount===0)return ae;for(oe in Ee=this._events)W.call(Ee,oe)&&ae.push(D?oe.slice(1):oe);return Object.getOwnPropertySymbols?ae.concat(Object.getOwnPropertySymbols(Ee)):ae},re.prototype.listeners=function(ae){var Ee=D?D+ae:ae,oe=this._events[Ee];if(!oe)return[];if(oe.fn)return[oe.fn];for(var ze=0,te=oe.length,ye=new Array(te);ze<te;ze++)ye[ze]=oe[ze].fn;return ye},re.prototype.listenerCount=function(ae){var Ee=D?D+ae:ae,oe=this._events[Ee];return oe?oe.fn?1:oe.length:0},re.prototype.emit=function(ae,Ee,oe,ze,te,ye){var De=D?D+ae:ae;if(!this._events[De])return!1;var Se=this._events[De],we=arguments.length,ce,Ze;if(Se.fn){switch(Se.once&&this.removeListener(ae,Se.fn,void 0,!0),we){case 1:return Se.fn.call(Se.context),!0;case 2:return Se.fn.call(Se.context,Ee),!0;case 3:return Se.fn.call(Se.context,Ee,oe),!0;case 4:return Se.fn.call(Se.context,Ee,oe,ze),!0;case 5:return Se.fn.call(Se.context,Ee,oe,ze,te),!0;case 6:return Se.fn.call(Se.context,Ee,oe,ze,te,ye),!0}for(Ze=1,ce=new Array(we-1);Ze<we;Ze++)ce[Ze-1]=arguments[Ze];Se.fn.apply(Se.context,ce)}else{var xt=Se.length,ht;for(Ze=0;Ze<xt;Ze++)switch(Se[Ze].once&&this.removeListener(ae,Se[Ze].fn,void 0,!0),we){case 1:Se[Ze].fn.call(Se[Ze].context);break;case 2:Se[Ze].fn.call(Se[Ze].context,Ee);break;case 3:Se[Ze].fn.call(Se[Ze].context,Ee,oe);break;case 4:Se[Ze].fn.call(Se[Ze].context,Ee,oe,ze);break;default:if(!ce)for(ht=1,ce=new Array(we-1);ht<we;ht++)ce[ht-1]=arguments[ht];Se[Ze].fn.apply(Se[Ze].context,ce)}}return!0},re.prototype.on=function(ae,Ee,oe){return E(this,ae,Ee,oe,!1)},re.prototype.once=function(ae,Ee,oe){return E(this,ae,Ee,oe,!0)},re.prototype.removeListener=function(ae,Ee,oe,ze){var te=D?D+ae:ae;if(!this._events[te])return this;if(!Ee)return ve(this,te),this;var ye=this._events[te];if(ye.fn)ye.fn===Ee&&(!ze||ye.once)&&(!oe||ye.context===oe)&&ve(this,te);else{for(var De=0,Se=[],we=ye.length;De<we;De++)(ye[De].fn!==Ee||ze&&!ye[De].once||oe&&ye[De].context!==oe)&&Se.push(ye[De]);Se.length?this._events[te]=Se.length===1?Se[0]:Se:ve(this,te)}return this},re.prototype.removeAllListeners=function(ae){var Ee;return ae?(Ee=D?D+ae:ae,this._events[Ee]&&ve(this,Ee)):(this._events=new ee,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=D,re.EventEmitter=re,$t.exports=re},38554:function($t){"use strict";var W=Object.prototype.hasOwnProperty,D="~";function ee(){}Object.create&&(ee.prototype=Object.create(null),new ee().__proto__||(D=!1));function X(fe,ae,Ee){this.fn=fe,this.context=ae,this.once=Ee||!1}function E(fe,ae,Ee,oe,ze){if(typeof Ee!="function")throw new TypeError("The listener must be a function");var te=new X(Ee,oe||fe,ze),ye=D?D+ae:ae;return fe._events[ye]?fe._events[ye].fn?fe._events[ye]=[fe._events[ye],te]:fe._events[ye].push(te):(fe._events[ye]=te,fe._eventsCount++),fe}function ve(fe,ae){--fe._eventsCount===0?fe._events=new ee:delete fe._events[ae]}function re(){this._events=new ee,this._eventsCount=0}re.prototype.eventNames=function(){var ae=[],Ee,oe;if(this._eventsCount===0)return ae;for(oe in Ee=this._events)W.call(Ee,oe)&&ae.push(D?oe.slice(1):oe);return Object.getOwnPropertySymbols?ae.concat(Object.getOwnPropertySymbols(Ee)):ae},re.prototype.listeners=function(ae){var Ee=D?D+ae:ae,oe=this._events[Ee];if(!oe)return[];if(oe.fn)return[oe.fn];for(var ze=0,te=oe.length,ye=new Array(te);ze<te;ze++)ye[ze]=oe[ze].fn;return ye},re.prototype.listenerCount=function(ae){var Ee=D?D+ae:ae,oe=this._events[Ee];return oe?oe.fn?1:oe.length:0},re.prototype.emit=function(ae,Ee,oe,ze,te,ye){var De=D?D+ae:ae;if(!this._events[De])return!1;var Se=this._events[De],we=arguments.length,ce,Ze;if(Se.fn){switch(Se.once&&this.removeListener(ae,Se.fn,void 0,!0),we){case 1:return Se.fn.call(Se.context),!0;case 2:return Se.fn.call(Se.context,Ee),!0;case 3:return Se.fn.call(Se.context,Ee,oe),!0;case 4:return Se.fn.call(Se.context,Ee,oe,ze),!0;case 5:return Se.fn.call(Se.context,Ee,oe,ze,te),!0;case 6:return Se.fn.call(Se.context,Ee,oe,ze,te,ye),!0}for(Ze=1,ce=new Array(we-1);Ze<we;Ze++)ce[Ze-1]=arguments[Ze];Se.fn.apply(Se.context,ce)}else{var xt=Se.length,ht;for(Ze=0;Ze<xt;Ze++)switch(Se[Ze].once&&this.removeListener(ae,Se[Ze].fn,void 0,!0),we){case 1:Se[Ze].fn.call(Se[Ze].context);break;case 2:Se[Ze].fn.call(Se[Ze].context,Ee);break;case 3:Se[Ze].fn.call(Se[Ze].context,Ee,oe);break;case 4:Se[Ze].fn.call(Se[Ze].context,Ee,oe,ze);break;default:if(!ce)for(ht=1,ce=new Array(we-1);ht<we;ht++)ce[ht-1]=arguments[ht];Se[Ze].fn.apply(Se[Ze].context,ce)}}return!0},re.prototype.on=function(ae,Ee,oe){return E(this,ae,Ee,oe,!1)},re.prototype.once=function(ae,Ee,oe){return E(this,ae,Ee,oe,!0)},re.prototype.removeListener=function(ae,Ee,oe,ze){var te=D?D+ae:ae;if(!this._events[te])return this;if(!Ee)return ve(this,te),this;var ye=this._events[te];if(ye.fn)ye.fn===Ee&&(!ze||ye.once)&&(!oe||ye.context===oe)&&ve(this,te);else{for(var De=0,Se=[],we=ye.length;De<we;De++)(ye[De].fn!==Ee||ze&&!ye[De].once||oe&&ye[De].context!==oe)&&Se.push(ye[De]);Se.length?this._events[te]=Se.length===1?Se[0]:Se:ve(this,te)}return this},re.prototype.removeAllListeners=function(ae){var Ee;return ae?(Ee=D?D+ae:ae,this._events[Ee]&&ve(this,Ee)):(this._events=new ee,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=D,re.EventEmitter=re,$t.exports=re},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function($t){try{let oe=function(){re||(re=!0,E())},ze=function(){try{ve.documentElement.doScroll("left")}catch(te){return void setTimeout(ze,50)}oe()};var ae=oe,Ee=ze,D=(D=document.getElementsByTagName("script"))[D.length-1],W=D.getAttribute("data-injectcss"),D=D.getAttribute("data-disable-injectsvg");if(!D){var ee,X,E,ve,re,fe=function(te,ye){ye.parentNode.insertBefore(te,ye)};if(W&&!$t.__iconfont__svg__cssinject__){$t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(te){console&&console.log(te)}}ee=function(){var te,ye=document.createElement("div");ye.innerHTML=$t._iconfont_svg_string_3580659,(ye=ye.getElementsByTagName("svg")[0])&&(ye.setAttribute("aria-hidden","true"),ye.style.position="absolute",ye.style.width=0,ye.style.height=0,ye.style.overflow="hidden",ye=ye,(te=document.body).firstChild?fe(ye,te.firstChild):te.appendChild(ye))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(ee,0):(X=function(){document.removeEventListener("DOMContentLoaded",X,!1),ee()},document.addEventListener("DOMContentLoaded",X,!1)):document.attachEvent&&(E=ee,ve=$t.document,re=!1,ze(),ve.onreadystatechange=function(){ve.readyState=="complete"&&(ve.onreadystatechange=null,oe())})}}catch(oe){}}(window)},39827:function($t,W,D){"use strict";D.d(W,{GC:function(){return j},h0:function(){return an},lv:function(){return $n},lo:function(){return Ht},kw:function(){return Jt},Or:function(){return _n},KD:function(){return Ie},I9:function(){return le},lE:function(){return Dt},d:function(){return nr},n3:function(){return Qf},vY:function(){return qe},P7:function(){return qf},yn:function(){return Ut},ee:function(){return Bt},v2:function(){return wn},e7:function(){return ol},Hp:function(){return gh},gl:function(){return re},cO:function(){return jh},Vb:function(){return we}});var ee=D(1413),X=D(4942),E=D(8543);let ve=function(ne){return ne.Normal="normal",ne.PostProcessing="post-processing",ne}({}),re=function(ne){return ne[ne.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",ne[ne.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",ne[ne.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",ne[ne.POINTS=0]="POINTS",ne[ne.LINES=1]="LINES",ne[ne.LINE_LOOP=2]="LINE_LOOP",ne[ne.LINE_STRIP=3]="LINE_STRIP",ne[ne.TRIANGLES=4]="TRIANGLES",ne[ne.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",ne[ne.TRIANGLE_FAN=6]="TRIANGLE_FAN",ne[ne.ZERO=0]="ZERO",ne[ne.ONE=1]="ONE",ne[ne.SRC_COLOR=768]="SRC_COLOR",ne[ne.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",ne[ne.SRC_ALPHA=770]="SRC_ALPHA",ne[ne.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",ne[ne.DST_ALPHA=772]="DST_ALPHA",ne[ne.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",ne[ne.DST_COLOR=774]="DST_COLOR",ne[ne.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",ne[ne.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",ne[ne.FUNC_ADD=32774]="FUNC_ADD",ne[ne.BLEND_EQUATION=32777]="BLEND_EQUATION",ne[ne.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",ne[ne.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",ne[ne.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",ne[ne.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",ne[ne.MAX_EXT=32776]="MAX_EXT",ne[ne.MIN_EXT=32775]="MIN_EXT",ne[ne.BLEND_DST_RGB=32968]="BLEND_DST_RGB",ne[ne.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",ne[ne.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",ne[ne.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",ne[ne.CONSTANT_COLOR=32769]="CONSTANT_COLOR",ne[ne.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",ne[ne.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",ne[ne.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",ne[ne.BLEND_COLOR=32773]="BLEND_COLOR",ne[ne.ARRAY_BUFFER=34962]="ARRAY_BUFFER",ne[ne.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",ne[ne.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",ne[ne.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",ne[ne.STREAM_DRAW=35040]="STREAM_DRAW",ne[ne.STATIC_DRAW=35044]="STATIC_DRAW",ne[ne.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",ne[ne.BUFFER_SIZE=34660]="BUFFER_SIZE",ne[ne.BUFFER_USAGE=34661]="BUFFER_USAGE",ne[ne.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",ne[ne.FRONT=1028]="FRONT",ne[ne.BACK=1029]="BACK",ne[ne.FRONT_AND_BACK=1032]="FRONT_AND_BACK",ne[ne.CULL_FACE=2884]="CULL_FACE",ne[ne.BLEND=3042]="BLEND",ne[ne.DITHER=3024]="DITHER",ne[ne.STENCIL_TEST=2960]="STENCIL_TEST",ne[ne.DEPTH_TEST=2929]="DEPTH_TEST",ne[ne.SCISSOR_TEST=3089]="SCISSOR_TEST",ne[ne.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",ne[ne.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",ne[ne.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",ne[ne.NO_ERROR=0]="NO_ERROR",ne[ne.INVALID_ENUM=1280]="INVALID_ENUM",ne[ne.INVALID_VALUE=1281]="INVALID_VALUE",ne[ne.INVALID_OPERATION=1282]="INVALID_OPERATION",ne[ne.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",ne[ne.CW=2304]="CW",ne[ne.CCW=2305]="CCW",ne[ne.LINE_WIDTH=2849]="LINE_WIDTH",ne[ne.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",ne[ne.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",ne[ne.CULL_FACE_MODE=2885]="CULL_FACE_MODE",ne[ne.FRONT_FACE=2886]="FRONT_FACE",ne[ne.DEPTH_RANGE=2928]="DEPTH_RANGE",ne[ne.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",ne[ne.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",ne[ne.DEPTH_FUNC=2932]="DEPTH_FUNC",ne[ne.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",ne[ne.STENCIL_FUNC=2962]="STENCIL_FUNC",ne[ne.STENCIL_FAIL=2964]="STENCIL_FAIL",ne[ne.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",ne[ne.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",ne[ne.STENCIL_REF=2967]="STENCIL_REF",ne[ne.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",ne[ne.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",ne[ne.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",ne[ne.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",ne[ne.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",ne[ne.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",ne[ne.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",ne[ne.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",ne[ne.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",ne[ne.VIEWPORT=2978]="VIEWPORT",ne[ne.SCISSOR_BOX=3088]="SCISSOR_BOX",ne[ne.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",ne[ne.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",ne[ne.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",ne[ne.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",ne[ne.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",ne[ne.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",ne[ne.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",ne[ne.RED_BITS=3410]="RED_BITS",ne[ne.GREEN_BITS=3411]="GREEN_BITS",ne[ne.BLUE_BITS=3412]="BLUE_BITS",ne[ne.ALPHA_BITS=3413]="ALPHA_BITS",ne[ne.DEPTH_BITS=3414]="DEPTH_BITS",ne[ne.STENCIL_BITS=3415]="STENCIL_BITS",ne[ne.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",ne[ne.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",ne[ne.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",ne[ne.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",ne[ne.SAMPLES=32937]="SAMPLES",ne[ne.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",ne[ne.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",ne[ne.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",ne[ne.DONT_CARE=4352]="DONT_CARE",ne[ne.FASTEST=4353]="FASTEST",ne[ne.NICEST=4354]="NICEST",ne[ne.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",ne[ne.BYTE=5120]="BYTE",ne[ne.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",ne[ne.SHORT=5122]="SHORT",ne[ne.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",ne[ne.INT=5124]="INT",ne[ne.UNSIGNED_INT=5125]="UNSIGNED_INT",ne[ne.FLOAT=5126]="FLOAT",ne[ne.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",ne[ne.ALPHA=6406]="ALPHA",ne[ne.RGB=6407]="RGB",ne[ne.RGBA=6408]="RGBA",ne[ne.LUMINANCE=6409]="LUMINANCE",ne[ne.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",ne[ne.RED=6403]="RED",ne[ne.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",ne[ne.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",ne[ne.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",ne[ne.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",ne[ne.VERTEX_SHADER=35633]="VERTEX_SHADER",ne[ne.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",ne[ne.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",ne[ne.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",ne[ne.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",ne[ne.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",ne[ne.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",ne[ne.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",ne[ne.SHADER_TYPE=35663]="SHADER_TYPE",ne[ne.DELETE_STATUS=35712]="DELETE_STATUS",ne[ne.LINK_STATUS=35714]="LINK_STATUS",ne[ne.VALIDATE_STATUS=35715]="VALIDATE_STATUS",ne[ne.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",ne[ne.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",ne[ne.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",ne[ne.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",ne[ne.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",ne[ne.NEVER=512]="NEVER",ne[ne.LESS=513]="LESS",ne[ne.EQUAL=514]="EQUAL",ne[ne.LEQUAL=515]="LEQUAL",ne[ne.GREATER=516]="GREATER",ne[ne.NOTEQUAL=517]="NOTEQUAL",ne[ne.GEQUAL=518]="GEQUAL",ne[ne.ALWAYS=519]="ALWAYS",ne[ne.KEEP=7680]="KEEP",ne[ne.REPLACE=7681]="REPLACE",ne[ne.INCR=7682]="INCR",ne[ne.DECR=7683]="DECR",ne[ne.INVERT=5386]="INVERT",ne[ne.INCR_WRAP=34055]="INCR_WRAP",ne[ne.DECR_WRAP=34056]="DECR_WRAP",ne[ne.VENDOR=7936]="VENDOR",ne[ne.RENDERER=7937]="RENDERER",ne[ne.VERSION=7938]="VERSION",ne[ne.NEAREST=9728]="NEAREST",ne[ne.LINEAR=9729]="LINEAR",ne[ne.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",ne[ne.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",ne[ne.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",ne[ne.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",ne[ne.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",ne[ne.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",ne[ne.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",ne[ne.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",ne[ne.TEXTURE_2D=3553]="TEXTURE_2D",ne[ne.TEXTURE=5890]="TEXTURE",ne[ne.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",ne[ne.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",ne[ne.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",ne[ne.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",ne[ne.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",ne[ne.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",ne[ne.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",ne[ne.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",ne[ne.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",ne[ne.TEXTURE0=33984]="TEXTURE0",ne[ne.TEXTURE1=33985]="TEXTURE1",ne[ne.TEXTURE2=33986]="TEXTURE2",ne[ne.TEXTURE3=33987]="TEXTURE3",ne[ne.TEXTURE4=33988]="TEXTURE4",ne[ne.TEXTURE5=33989]="TEXTURE5",ne[ne.TEXTURE6=33990]="TEXTURE6",ne[ne.TEXTURE7=33991]="TEXTURE7",ne[ne.TEXTURE8=33992]="TEXTURE8",ne[ne.TEXTURE9=33993]="TEXTURE9",ne[ne.TEXTURE10=33994]="TEXTURE10",ne[ne.TEXTURE11=33995]="TEXTURE11",ne[ne.TEXTURE12=33996]="TEXTURE12",ne[ne.TEXTURE13=33997]="TEXTURE13",ne[ne.TEXTURE14=33998]="TEXTURE14",ne[ne.TEXTURE15=33999]="TEXTURE15",ne[ne.TEXTURE16=34e3]="TEXTURE16",ne[ne.TEXTURE17=34001]="TEXTURE17",ne[ne.TEXTURE18=34002]="TEXTURE18",ne[ne.TEXTURE19=34003]="TEXTURE19",ne[ne.TEXTURE20=34004]="TEXTURE20",ne[ne.TEXTURE21=34005]="TEXTURE21",ne[ne.TEXTURE22=34006]="TEXTURE22",ne[ne.TEXTURE23=34007]="TEXTURE23",ne[ne.TEXTURE24=34008]="TEXTURE24",ne[ne.TEXTURE25=34009]="TEXTURE25",ne[ne.TEXTURE26=34010]="TEXTURE26",ne[ne.TEXTURE27=34011]="TEXTURE27",ne[ne.TEXTURE28=34012]="TEXTURE28",ne[ne.TEXTURE29=34013]="TEXTURE29",ne[ne.TEXTURE30=34014]="TEXTURE30",ne[ne.TEXTURE31=34015]="TEXTURE31",ne[ne.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",ne[ne.REPEAT=10497]="REPEAT",ne[ne.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",ne[ne.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",ne[ne.FLOAT_VEC2=35664]="FLOAT_VEC2",ne[ne.FLOAT_VEC3=35665]="FLOAT_VEC3",ne[ne.FLOAT_VEC4=35666]="FLOAT_VEC4",ne[ne.INT_VEC2=35667]="INT_VEC2",ne[ne.INT_VEC3=35668]="INT_VEC3",ne[ne.INT_VEC4=35669]="INT_VEC4",ne[ne.BOOL=35670]="BOOL",ne[ne.BOOL_VEC2=35671]="BOOL_VEC2",ne[ne.BOOL_VEC3=35672]="BOOL_VEC3",ne[ne.BOOL_VEC4=35673]="BOOL_VEC4",ne[ne.FLOAT_MAT2=35674]="FLOAT_MAT2",ne[ne.FLOAT_MAT3=35675]="FLOAT_MAT3",ne[ne.FLOAT_MAT4=35676]="FLOAT_MAT4",ne[ne.SAMPLER_2D=35678]="SAMPLER_2D",ne[ne.SAMPLER_CUBE=35680]="SAMPLER_CUBE",ne[ne.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",ne[ne.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",ne[ne.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",ne[ne.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",ne[ne.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",ne[ne.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",ne[ne.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",ne[ne.COMPILE_STATUS=35713]="COMPILE_STATUS",ne[ne.LOW_FLOAT=36336]="LOW_FLOAT",ne[ne.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",ne[ne.HIGH_FLOAT=36338]="HIGH_FLOAT",ne[ne.LOW_INT=36339]="LOW_INT",ne[ne.MEDIUM_INT=36340]="MEDIUM_INT",ne[ne.HIGH_INT=36341]="HIGH_INT",ne[ne.FRAMEBUFFER=36160]="FRAMEBUFFER",ne[ne.RENDERBUFFER=36161]="RENDERBUFFER",ne[ne.RGBA4=32854]="RGBA4",ne[ne.RGB5_A1=32855]="RGB5_A1",ne[ne.RGB565=36194]="RGB565",ne[ne.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",ne[ne.STENCIL_INDEX=6401]="STENCIL_INDEX",ne[ne.STENCIL_INDEX8=36168]="STENCIL_INDEX8",ne[ne.DEPTH_STENCIL=34041]="DEPTH_STENCIL",ne[ne.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",ne[ne.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",ne[ne.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",ne[ne.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",ne[ne.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",ne[ne.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",ne[ne.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",ne[ne.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",ne[ne.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",ne[ne.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",ne[ne.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",ne[ne.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",ne[ne.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",ne[ne.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",ne[ne.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",ne[ne.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",ne[ne.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",ne[ne.NONE=0]="NONE",ne[ne.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",ne[ne.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",ne[ne.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",ne[ne.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",ne[ne.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",ne[ne.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",ne[ne.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",ne[ne.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",ne[ne.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",ne[ne.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",ne[ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",ne[ne.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",ne[ne.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",ne[ne.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",ne}({});const fe=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:ae,isNil:Ee,upperFirst:oe}=E.lodashUtil;class ze{constructor(){(0,X.Z)(this,"shaderModuleService",void 0),(0,X.Z)(this,"rendererService",void 0),(0,X.Z)(this,"config",void 0),(0,X.Z)(this,"quad",fe),(0,X.Z)(this,"enabled",!0),(0,X.Z)(this,"renderToScreen",!1),(0,X.Z)(this,"model",void 0),(0,X.Z)(this,"name",void 0),(0,X.Z)(this,"optionsToUpdate",{})}getName(){return this.name}setName(_e){this.name=_e}getType(){return ve.PostProcessing}init(_e,et){this.config=et,this.rendererService=_e.getContainer().rendererService,this.shaderModuleService=_e.getContainer().shaderModuleService;const{createAttribute:dn,createBuffer:K,createModel:rr}=this.rendererService,{vs:Mr,fs:ki,uniforms:ti}=this.setupShaders();this.model=rr({vs:Mr,fs:ki,attributes:{a_Position:dn({buffer:K({data:[-4,-4,4,-4,0,4],type:re.FLOAT}),size:2})},uniforms:(0,ee.Z)((0,ee.Z)({u_Texture:null},ti),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(_e,et){const dn=_e.multiPassRenderer.getPostProcessor(),{useFramebuffer:K,getViewportSize:rr,clear:Mr}=this.rendererService,{width:ki,height:ti}=rr();K(this.renderToScreen?null:dn.getWriteFBO(),()=>{Mr({framebuffer:dn.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const uo=(0,ee.Z)({u_BloomFinal:0,u_Texture:dn.getReadFBO(),u_ViewportSize:[ki,ti]},this.convertOptionsToUniforms(this.optionsToUpdate));et&&(uo.u_BloomFinal=1,uo.u_Texture2=et),this.model.draw({uniforms:uo})})}isEnabled(){return this.enabled}setEnabled(_e){this.enabled=_e}setRenderToScreen(_e){this.renderToScreen=_e}updateOptions(_e){this.optionsToUpdate=(0,ee.Z)((0,ee.Z)({},this.optionsToUpdate),_e)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(_e){const et={};return Object.keys(_e).forEach(dn=>{Ee(_e[dn])||(et[`u_${oe(ae(dn))}`]=_e[dn])}),et}}function te(ne){let _e=0;switch(ne){case"vec2":case"ivec2":_e=2;break;case"vec3":case"ivec3":_e=3;break;case"vec4":case"ivec4":case"mat2":_e=4;break;case"mat3":_e=9;break;case"mat4":_e=16;break;default:}return _e}const ye=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function De(ne,_e=!1){const et={};return ne=ne.replace(ye,(dn,K,rr)=>{const Mr=rr.split(":"),ki=Mr[0].trim();let ti="";switch(Mr.length>1&&(ti=Mr[1].trim()),K){case"bool":ti=ti==="true";break;case"float":case"int":ti=Number(ti);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":ti?ti=ti.replace("[","").replace("]","").split(",").reduce((uo,lo)=>(uo.push(Number(lo.trim())),uo),[]):ti=new Array(te(K)).fill(0);break;default:}return et[ki]=ti,`${_e?"uniform ":""}${K} ${ki};
`}),{content:ne,uniforms:et}}function Se(ne){let{content:_e,uniforms:et}=De(ne,!0);return _e=_e.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(dn,K,rr)=>{rr=rr.trim().replace(/^.*$/gm,ti=>`uniform ${ti}`);const{content:Mr,uniforms:ki}=De(rr);return Object.assign(et,ki),`${K}{
${Mr}
};`}),{content:_e,uniforms:et}}function we(ne){const _e={};return ne.replace(ye,(et,dn,K)=>{const rr=K.trim();return _e[rr]?"":(_e[rr]=!0,`uniform ${dn} ${rr};
`)})}const ce=null;function Ze(ne){return ce.indexOf(ne)}const{clamp:xt}=E.lodashUtil,ht=2,Gt=4,mt=64,gt=128,Be=256,Re=512,bt=8192,yt=16384,At=32768,bn=null,He=131072,Rt=262144,Oe=524288,it=1048576,Qe=2097152,$e=4194304,Ot=8388608,vt=16777216,Me=null;function Xt(ne,_e){return ne=xt(Math.floor(ne),0,255),_e=xt(Math.floor(_e),0,255),256*ne+_e}function on(ne){const{color:_e,radius:et,tileX:dn,tileY:K,shape:rr,opacity:Mr,stroke:ki,strokeWidth:ti,strokeOpacity:uo}=ne,lo=[],ca=[],Io=[],xa=[Xt(_e[0],_e[1]),Xt(_e[2],_e[3])],Qa=[Xt(ki[0],ki[1]),Xt(ki[2],ki[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(([aa,ga])=>{lo.push([...xa,(aa+1)*Ot+(ga+1)*Qe+getShapeIndex(rr)*He+et,(dn+512)*Oe+(K+512)*mt]),ca.push([...Qa,ti,uo]),Io.push([Mr,0,0,0])}),{packedBuffer:lo,packedBuffer2:ca,packedBuffer3:Io}}function Fn(ne,_e){if(ne===0&&!_e)return 0;if(ne===1&&_e)return 4294967295;const et=_e?1:0,dn=Math.floor(ne*127);return dn*Me+et*vt+dn*He+et*bn+dn*Re+et*Be+dn*ht+et}const $n={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let nr=function(ne){return ne.TOPRIGHT="topright",ne.TOPLEFT="topleft",ne.BOTTOMRIGHT="bottomright",ne.BOTTOMLEFT="bottomleft",ne.TOPCENTER="topcenter",ne.BOTTOMCENTER="bottomcenter",ne.LEFTCENTER="leftcenter",ne.RIGHTCENTER="rightcenter",ne.LEFTTOP="lefttop",ne.RIGHTTOP="righttop",ne.LEFTBOTTOM="leftbottom",ne.RIGHTBOTTOM="rightbottom",ne}({}),Ht=function(ne){return ne[ne.LNGLAT=1]="LNGLAT",ne[ne.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",ne[ne.VECTOR_TILE=3]="VECTOR_TILE",ne[ne.IDENTITY=4]="IDENTITY",ne[ne.METER_OFFSET=5]="METER_OFFSET",ne}({});const Jt={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var _n={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let tr=function(ne){return ne.Hover="hover",ne.Click="click",ne.Select="select",ne.Active="active",ne.Drag="drag",ne}({}),an=function(ne){return ne.normal="normal",ne.additive="additive",ne.subtractive="subtractive",ne.min="min",ne.max="max",ne.none="none",ne}({}),Ut=function(ne){return ne.MULTIPLE="MULTIPLE",ne.SINGLE="SINGLE",ne}({}),Dt=function(ne){return ne.AND="and",ne.OR="or",ne}({}),Ie=function(ne){return ne.INIT="init",ne.UPDATE="update",ne}({}),qe=function(ne){return ne.LINEAR="linear",ne.SEQUENTIAL="sequential",ne.POWER="power",ne.LOG="log",ne.IDENTITY="identity",ne.TIME="time",ne.QUANTILE="quantile",ne.QUANTIZE="quantize",ne.THRESHOLD="threshold",ne.CAT="cat",ne.DIVERGING="diverging",ne.CUSTOM="threshold",ne}({}),Bt=function(ne){return ne.CONSTANT="constant",ne.VARIABLE="variable",ne}({}),j=function(ne){return ne[ne.Attribute=0]="Attribute",ne[ne.InstancedAttribute=1]="InstancedAttribute",ne[ne.Uniform=2]="Uniform",ne}({});const le=["mapload","mapchange","mapAfterFrameChange"];var z=D(49296),de=D.n(z),Zt=D(26729),nt=D.n(Zt);const St=30;function In({characterSet:ne,getFontWidth:_e,fontHeight:et,buffer:dn,maxCanvasWidth:K,mapping:rr={},xOffset:Mr=0,yOffset:ki=0}){let ti=0,uo=Mr;Array.from(ne).forEach((ca,Io)=>{if(!rr[ca]){const xa=_e(ca,Io);uo+St>K&&(uo=0,ti++),rr[ca]={x:uo,y:ki+ti*St,width:St,height:St,advance:xa},uo+=St}});const lo=et+dn*2;return{mapping:rr,xOffset:uo,yOffset:ki+ti*lo,canvasHeight:hn(ki+(ti+1)*lo)}}function Wn(ne,_e,et){let dn=0,K=0,rr=0,Mr=[];const ki={};for(const uo of ne)if(!ki[uo.id]){const{size:lo}=uo;dn+lo+_e>et&&(qn(ki,Mr,K),dn=0,K=rr+K+_e,rr=0,Mr=[]),Mr.push({icon:uo,xOffset:dn}),dn=dn+lo+_e,rr=Math.max(rr,lo)}Mr.length>0&&qn(ki,Mr,K);const ti=hn(rr+K+_e);return{mapping:ki,canvasHeight:ti}}function qn(ne,_e,et){for(const dn of _e){const{icon:K,xOffset:rr}=dn;ne[K.id]=(0,ee.Z)((0,ee.Z)({},K),{},{x:rr,y:et,image:K.image,width:K.width,height:K.height})}}function hn(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}const pt=Qn(),Wt="sans-serif",An="normal",Pn=24,Xn=3,dt=.25,be=8,Ne=1024,ot=1,Pt=1,It=3,xn=null;function Qn(){const ne=[];for(let _e=32;_e<128;_e++)ne.push(String.fromCharCode(_e));return ne}function br(ne,_e,et,dn){ne.font=`${dn} ${et}px ${_e}`,ne.fillStyle="black",ne.textBaseline="middle"}function Jn(ne,_e){for(let et=0;et<ne.length;et++)_e.data[4*et+3]=ne[et]}class Ae extends Zt.EventEmitter{constructor(..._e){super(..._e),(0,X.Z)(this,"fontAtlas",void 0),(0,X.Z)(this,"iconFontMap",void 0),(0,X.Z)(this,"iconFontGlyphs",{}),(0,X.Z)(this,"fontOptions",void 0),(0,X.Z)(this,"key",void 0),(0,X.Z)(this,"cache",new E.z6(It))}get scale(){return Pt}get canvas(){const _e=this.cache.get(this.key);return _e&&_e.data}get mapping(){const _e=this.cache.get(this.key);return _e&&_e.mapping||{}}getCanvasByKey(_e){const et=this.cache.get(_e);return et&&et.data}getMappingByKey(_e){const et=this.cache.get(_e);return et&&et.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:Wt,fontWeight:An,characterSet:pt,fontSize:Pn,buffer:Xn,sdf:!0,cutoff:dt,radius:be,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(_e){_e.forEach(et=>{this.iconFontGlyphs[et.name]=et.unicode})}addIconFont(_e,et){this.iconFontMap.set(_e,et)}getIconFontKey(_e){return this.iconFontMap.get(_e)||_e}getGlyph(_e){return this.iconFontGlyphs[_e]?String.fromCharCode(parseInt(this.iconFontGlyphs[_e],16)):""}setFontOptions(_e){this.fontOptions=(0,ee.Z)((0,ee.Z)({},this.fontOptions),_e),this.key=this.getKey();const et=this.getNewChars(this.key,this.fontOptions.characterSet),dn=this.cache.get(this.key);if(dn&&et.length===0)return;const K=this.generateFontAtlas(this.key,et,dn);this.fontAtlas=K,this.cache.set(this.key,K)}addFontFace(_e,et){const dn=document.createElement("style");dn.type="text/css",dn.innerText=`
        @font-face{
            font-family: '${_e}';
            src: url('${et}') format('woff2'),
            url('${et}') format('woff'),
            url('${et}') format('truetype');
        }`,dn.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${_e}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:_e})})}catch(K){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(K)}},document.getElementsByTagName("head")[0].appendChild(dn)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(_e,et,dn){const{fontFamily:K,fontWeight:rr,fontSize:Mr,buffer:ki,sdf:ti,radius:uo,cutoff:lo,iconfont:ca}=this.fontOptions;let Io=dn&&dn.data;Io||(Io=window.document.createElement("canvas"),Io.width=Ne);const xa=Io.getContext("2d",{willReadFrequently:!0});br(xa,K,Mr,rr);const{mapping:Qa,canvasHeight:aa,xOffset:ga,yOffset:hs}=In((0,ee.Z)({getFontWidth:La=>xa.measureText(La).width,fontHeight:Mr*Pt,buffer:ki,characterSet:et,maxCanvasWidth:Ne},dn&&{mapping:dn.mapping,xOffset:dn.xOffset,yOffset:dn.yOffset})),Oa=xa.getImageData(0,0,Io.width,Io.height);if(Io.height=aa,xa.putImageData(Oa,0,0),br(xa,K,Mr,rr),ti){const La=new(de())(Mr,ki,uo,lo,K,rr),Fa=xa.getImageData(0,0,La.size,La.size);for(const Ks of et){if(ca){const Fs=String.fromCharCode(parseInt(Ks.replace("&#x","").replace(";",""),16)),Ec=La.draw(Fs);Jn(Ec,Fa)}else Jn(La.draw(Ks),Fa);xa.putImageData(Fa,Qa[Ks].x,Qa[Ks].y)}}else for(const La of et)xa.fillText(La,Qa[La].x,Qa[La].y+Mr*ot);return{xOffset:ga,yOffset:hs,mapping:Qa,data:Io,width:Io.width,height:Io.height}}getKey(){const{fontFamily:_e,fontWeight:et}=this.fontOptions;return`${_e}_${et}`}getNewChars(_e,et){const dn=this.cache.get(_e);if(!dn)return et;const K=[],rr=dn.mapping,Mr=new Set(Object.keys(rr));return new Set(et).forEach(ti=>{Mr.has(ti)||K.push(ti)}),K}}var xe=D(15861);const ke=3,tt=1024,Et=64;class tn extends Zt.EventEmitter{constructor(..._e){super(..._e),(0,X.Z)(this,"canvasHeight",128),(0,X.Z)(this,"texture",void 0),(0,X.Z)(this,"canvas",void 0),(0,X.Z)(this,"iconData",void 0),(0,X.Z)(this,"iconMap",void 0),(0,X.Z)(this,"ctx",void 0),(0,X.Z)(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(_e,et){var dn=this;return(0,xe.Z)(function*(){let K=new Image;dn.loadingImageCount++,dn.hasImage(_e)?console.warn("Image Id already exists"):dn.iconData.push({id:_e,size:Et}),dn.updateIconMap(),K=yield dn.loadImage(et);const rr=dn.iconData.find(Mr=>Mr.id===_e);rr&&(rr.image=K,rr.width=K.width,rr.height=K.height),dn.update()})()}addImageMini(_e,et,dn){const K=dn.getSceneConfig().canvas;let rr=K.createImage();if(this.loadingImageCount++,this.hasImage(_e))throw new Error("Image Id already exists");this.iconData.push({id:_e,size:Et}),this.updateIconMap(),this.loadImageMini(et,K).then(Mr=>{rr=Mr;const ki=this.iconData.find(ti=>ti.id===_e);ki&&(ki.image=rr,ki.width=rr.width,ki.height=rr.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(_e){return this.iconMap.hasOwnProperty(_e)}removeImage(_e){this.hasImage(_e)&&(this.iconData=this.iconData.filter(et=>et.id!==_e),delete this.iconMap[_e],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(_e){return new Promise((et,dn)=>{if(_e instanceof HTMLImageElement){et(_e);return}const K=new Image;K.crossOrigin="anonymous",K.onload=()=>{et(K)},K.onerror=()=>{dn(new Error("Could not load image at "+_e))},K.src=_e instanceof File?URL.createObjectURL(_e):_e})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=tt,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(_e=>{const{x:et,y:dn,image:K,width:rr=64,height:Mr=64}=this.iconMap[_e],ti=Math.max(rr,Mr)/Et,uo=Mr/ti,lo=rr/ti;K&&this.ctx.drawImage(K,et+(Et-lo)/2,dn+(Et-uo)/2,lo,uo)})}updateIconMap(){const{mapping:_e,canvasHeight:et}=Wn(this.iconData,ke,tt);this.iconMap=_e,this.canvasHeight=et}loadImageMini(_e,et){return new Promise((dn,K)=>{const rr=et.createImage();rr.crossOrigin="anonymous",rr.onload=()=>{dn(rr)},rr.onerror=()=>{K(new Error("Could not load image at "+_e))},rr.src=_e})}}var fn=D(85975);class _t{constructor(){(0,X.Z)(this,"viewport",void 0),(0,X.Z)(this,"overridedViewProjectionMatrix",void 0),(0,X.Z)(this,"viewMatrixInverse",void 0),(0,X.Z)(this,"cameraPosition",void 0)}init(){}update(_e){this.viewport=_e,this.viewMatrixInverse=fn.create(),fn.invert(this.viewMatrixInverse,_e.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[_e,et]=this.viewport.getCenter();return[_e,et]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(_e,et){return this.viewport.projectFlat(_e,et)}setViewProjectionMatrix(_e){this.overridedViewProjectionMatrix=_e}}const en={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class Gn{constructor(){(0,X.Z)(this,"container",void 0),(0,X.Z)(this,"controlCorners",void 0),(0,X.Z)(this,"controlContainer",void 0),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"controls",[]),(0,X.Z)(this,"unAddControls",[])}init(_e,et){this.container=_e.container,this.scene=et,this.mapsService=et.mapService,this.initControlPos()}addControl(_e,et){et.mapService.map?(_e.addTo(this.scene),this.controls.push(_e)):this.unAddControls.push(_e)}getControlByName(_e){return this.controls.find(et=>et.controlOption.name===_e)}removeControl(_e){const et=this.controls.indexOf(_e);return et>-1&&this.controls.splice(et,1),_e.remove(),this}addControls(){this.unAddControls.forEach(_e=>{_e.addTo(this.scene),this.controls.push(_e)}),this.unAddControls=[]}destroy(){for(const _e of this.controls)_e.remove();this.controls=[],this.clearControlPos()}initControlPos(){const _e=this.controlCorners={},et="l7-",dn=this.controlContainer=E.SO.create("div",et+"control-container",this.container);function K(Mr=[]){const ki=Mr.map(ti=>et+ti).join(" ");_e[Mr.filter(ti=>!["row","column"].includes(ti)).join("")]=E.SO.create("div",ki,dn)}function rr(Mr){return[...Mr.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),en[Mr]]}Object.values(nr).forEach(Mr=>{K(rr(Mr))}),this.checkCornerOverlap()}clearControlPos(){for(const _e in this.controlCorners)this.controlCorners[_e]&&E.SO.remove(this.controlCorners[_e]);this.controlContainer&&E.SO.remove(this.controlContainer)}checkCornerOverlap(){const _e=window.MutationObserver;if(_e)for(const et of Object.keys(this.controlCorners)){const dn=et.match(/^(top|bottom)(left|right)$/);if(dn){const[,K,rr]=dn,Mr=this.controlCorners[`${K}${rr}`];new _e(([{target:ti}])=>{Mr&&(Mr.style[K]=ti.clientHeight+"px")}).observe(this.controlCorners[`${rr}${K}`],{childList:!0,attributes:!0})}}}}class Tr{constructor(){(0,X.Z)(this,"container",void 0),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"markers",[]),(0,X.Z)(this,"markerLayers",[]),(0,X.Z)(this,"unAddMarkers",[]),(0,X.Z)(this,"unAddMarkerLayers",[])}addMarkerLayer(_e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(_e),_e.addTo(this.scene)):this.unAddMarkerLayers.push(_e)}removeMarkerLayer(_e){_e.destroy(),this.markerLayers.indexOf(_e);const et=this.markerLayers.indexOf(_e);et>-1&&this.markerLayers.splice(et,1)}addMarker(_e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(_e),_e.addTo(this.scene)):this.unAddMarkers.push(_e)}addMarkers(){this.unAddMarkers.forEach(_e=>{_e.addTo(this.scene),this.markers.push(_e)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(_e=>{this.markerLayers.push(_e),_e.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(_e){_e.remove(),this.markers.indexOf(_e);const et=this.markers.indexOf(_e);et>-1&&this.markers.splice(et,1)}removeAllMarkers(){this.destroy()}init(_e){this.scene=_e,this.mapsService=_e.mapService}destroy(){this.markers.forEach(_e=>{_e.remove()}),this.markers=[],this.markerLayers.forEach(_e=>{_e.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(_e){_e.destroy()}}class jr{constructor(){(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"popups",[]),(0,X.Z)(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(_e){_e!=null&&_e.isOpen()&&_e.remove();const et=this.popups.indexOf(_e);et>-1&&this.popups.splice(et,1);const dn=this.unAddPopups.indexOf(_e);dn>-1&&this.unAddPopups.splice(dn,1)}destroy(){this.popups.forEach(_e=>_e.remove())}addPopup(_e){_e&&_e.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(et=>{et.getOptions().autoClose&&this.removePopup(et)}),this.isMarkerReady?(_e.addTo(this.scene),this.popups.push(_e)):this.unAddPopups.push(_e),_e.on("close",()=>{this.removePopup(_e)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(_e=>{this.addPopup(_e),this.unAddPopups=[]})}init(_e){this.scene=_e,this.mapsService=_e.mapService}}var Ur={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"};const{merge:Fr}=E.lodashUtil,qr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},wr={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Dt.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class fi{constructor(){(0,X.Z)(this,"sceneConfigCache",{}),(0,X.Z)(this,"layerConfigCache",{}),(0,X.Z)(this,"layerAttributeConfigCache",{})}getSceneConfig(_e){return this.sceneConfigCache[_e]}getSceneWarninfo(_e){return Ur[_e]}setSceneConfig(_e,et){this.sceneConfigCache[_e]=(0,ee.Z)((0,ee.Z)({},qr),et)}getLayerConfig(_e){return this.layerConfigCache[_e]}setLayerConfig(_e,et,dn){this.layerConfigCache[et]=(0,ee.Z)({},Fr({},this.sceneConfigCache[_e],wr,dn))}getAttributeConfig(_e){return this.layerAttributeConfigCache[_e]}setAttributeConfig(_e,et){this.layerAttributeConfigCache[_e]=(0,ee.Z)((0,ee.Z)({},this.layerAttributeConfigCache[_e]),et)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}var di=D(98333);const vi=Math.PI/180,vo=512,Oi=4003e4;function Ko({latitude:ne=0,zoom:_e=0,scale:et,highPrecision:dn=!1,flipY:K=!1}){et=et!==void 0?et:Math.pow(2,_e);const rr={},Mr=vo*et,ki=Math.cos(ne*vi),ti=Mr/360,uo=ti/ki,lo=Mr/Oi/ki;if(rr.pixelsPerMeter=[lo,-lo,lo],rr.metersPerPixel=[1/lo,-1/lo,1/lo],rr.pixelsPerDegree=[ti,-uo,lo],rr.degreesPerPixel=[1/ti,-1/uo,1/lo],dn){const ca=vi*Math.tan(ne*vi)/ki,Io=ti*ca/2,xa=Mr/Oi*ca,Qa=xa/uo*lo;rr.pixelsPerDegree2=[0,-Io,xa],rr.pixelsPerMeter2=[Qa,0,Qa],K&&(rr.pixelsPerDegree2[1]=-rr.pixelsPerDegree2[1],rr.pixelsPerMeter2[1]=-rr.pixelsPerMeter2[1])}return K&&(rr.pixelsPerMeter[1]=-rr.pixelsPerMeter[1],rr.metersPerPixel[1]=-rr.metersPerPixel[1],rr.pixelsPerDegree[1]=-rr.pixelsPerDegree[1],rr.degreesPerPixel[1]=-rr.degreesPerPixel[1]),rr}const va=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class Co{constructor(_e){(0,X.Z)(this,"needRefresh",!0),(0,X.Z)(this,"coordinateSystem",void 0),(0,X.Z)(this,"viewportCenter",void 0),(0,X.Z)(this,"viewportCenterProjection",void 0),(0,X.Z)(this,"pixelsPerDegree",void 0),(0,X.Z)(this,"pixelsPerDegree2",void 0),(0,X.Z)(this,"pixelsPerMeter",void 0),this.cameraService=_e}refresh(_e){const et=this.cameraService.getZoom(),dn=_e||this.cameraService.getCenter(),{pixelsPerMeter:K,pixelsPerDegree:rr}=Ko({latitude:dn[1],zoom:et});this.viewportCenter=dn,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=K,this.pixelsPerDegree=rr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Ht.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Ht.LNGLAT_OFFSET&&this.calculateLnglatOffset(dn,et),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(_e){this.coordinateSystem=_e}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(_e,et,dn,K){const{pixelsPerMeter:rr,pixelsPerDegree:Mr,pixelsPerDegree2:ki}=Ko({latitude:_e[1],zoom:et,scale:dn,flipY:K,highPrecision:!0});let ti=this.cameraService.getViewMatrix();const uo=this.cameraService.getProjectionMatrix();let lo=fn.multiply([],uo,ti);const ca=this.cameraService.projectFlat([Math.fround(_e[0]),Math.fround(_e[1])],Math.pow(2,et));this.viewportCenterProjection=di.fF([],[ca[0],ca[1],0,1],lo),ti=this.cameraService.getViewMatrixUncentered()||ti,lo=fn.multiply([],uo,ti),lo=fn.multiply([],lo,va),this.cameraService.setViewProjectionMatrix(lo),this.pixelsPerMeter=rr,this.pixelsPerDegree=Mr,this.pixelsPerDegree2=ki}}class Xo extends Zt.EventEmitter{constructor(..._e){super(..._e),(0,X.Z)(this,"renderMap",new Map),(0,X.Z)(this,"enable",!1),(0,X.Z)(this,"renderEnable",!1),(0,X.Z)(this,"cacheLogs",{})}setEnable(_e){this.enable=!!_e}log(_e,et){if(!this.enable)return;const dn=_e.split(".");let K=null;dn.forEach((rr,Mr)=>{K!==null?(K[rr]||(K[rr]={}),Mr!==dn.length-1&&(K=K[rr])):(this.cacheLogs[rr]||(this.cacheLogs[rr]={}),Mr!==dn.length-1&&(K=this.cacheLogs[rr])),Mr===dn.length-1&&(K[rr]=(0,ee.Z)((0,ee.Z)({time:Date.now()},K[rr]),et))})}getLog(_e){switch(typeof _e){case"string":return this.cacheLogs[_e];case"object":return _e.map(et=>this.cacheLogs[et]).filter(et=>et!==void 0);case"undefined":return this.cacheLogs}}removeLog(_e){delete this.cacheLogs[_e]}generateRenderUid(){return this.renderEnable?(0,E.M8)():""}renderDebug(_e){this.renderEnable=_e}renderStart(_e){if(!this.renderEnable||!this.enable)return;const et=this.renderMap.get(_e)||{};this.renderMap.set(_e,(0,ee.Z)((0,ee.Z)({},et),{},{renderUid:_e,renderStart:Date.now()}))}renderEnd(_e){if(!this.renderEnable||!this.enable)return;const et=this.renderMap.get(_e);if(et){const dn=et.renderStart,K=Date.now();this.emit("renderEnd",(0,ee.Z)((0,ee.Z)({},et),{},{renderEnd:K,renderDuration:K-dn})),this.renderMap.delete(_e)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var Ye=D(50840),Ke=D.n(Ye);const Ct={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class sn extends nt(){get mapService(){return this.container.mapService}constructor(_e){super(),(0,X.Z)(this,"indragging",!1),(0,X.Z)(this,"hammertime",void 0),(0,X.Z)(this,"lastClickTime",0),(0,X.Z)(this,"lastClickXY",[-1,-1]),(0,X.Z)(this,"clickTimer",void 0),(0,X.Z)(this,"$containter",void 0),(0,X.Z)(this,"onDrag",et=>{const dn=this.interactionEvent(et);dn.type=Ct[dn.type],dn.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(tr.Drag,dn)}),(0,X.Z)(this,"onHammer",et=>{et.srcEvent.stopPropagation();const dn=this.interactionEvent(et);this.emit(tr.Hover,dn)}),(0,X.Z)(this,"onTouch",et=>{const dn=et.touches[0];this.onHover({clientX:dn.clientX,clientY:dn.clientY,type:"touchstart"})}),(0,X.Z)(this,"onTouchEnd",et=>{if(et.changedTouches.length>0){const dn=et.changedTouches[0];this.onHover({clientX:dn.clientX,clientY:dn.clientY,type:"touchend"})}}),(0,X.Z)(this,"onTouchMove",et=>{const dn=et.changedTouches[0];this.onHover({clientX:dn.clientX,clientY:dn.clientY,type:"touchmove"})}),(0,X.Z)(this,"onHover",et=>{const{clientX:dn,clientY:K}=et;let rr=dn,Mr=K;const ki=et.type,ti=this.mapService.getMapContainer();if(ti){const{top:lo,left:ca}=ti.getBoundingClientRect();rr=rr-ca-ti.clientLeft,Mr=Mr-lo-ti.clientTop}const uo=this.mapService.containerToLngLat([rr,Mr]);if(ki==="click"){this.isDoubleTap(rr,Mr,uo);return}if(ki==="touch"){this.isDoubleTap(rr,Mr,uo);return}ki!=="click"&&ki!=="dblclick"&&this.emit(tr.Hover,{x:rr,y:Mr,lngLat:uo,type:ki,target:et})}),this.container=_e}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(tr.Hover)}triggerHover({x:_e,y:et}){this.emit(tr.Hover,{x:_e,y:et})}triggerSelect(_e){this.emit(tr.Select,{featureId:_e})}triggerActive(_e){this.emit(tr.Active,{featureId:_e})}addEventListenerOnMap(){const _e=this.mapService.getMapContainer();if(_e){const et=new(Ke()).Manager(_e);et.add(new(Ke()).Tap({event:"dblclick",taps:2})),et.add(new(Ke()).Tap({event:"click"})),et.add(new(Ke()).Pan({threshold:0,pointers:0})),et.add(new(Ke()).Press({})),et.on("dblclick click",this.onHammer),et.on("panstart panmove panend pancancel",this.onDrag),_e.addEventListener("touchstart",this.onTouch),_e.addEventListener("touchend",this.onTouchEnd),_e.addEventListener("mousemove",this.onHover),_e.addEventListener("touchmove",this.onTouchMove),_e.addEventListener("mousedown",this.onHover,!0),_e.addEventListener("mouseup",this.onHover),_e.addEventListener("contextmenu",this.onHover),this.hammertime=et}}removeEventListenerOnMap(){const _e=this.mapService.getMapContainer();_e&&(_e.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),_e.removeEventListener("touchstart",this.onTouch),_e.removeEventListener("touchend",this.onTouchEnd),_e.removeEventListener("mousedown",this.onHover),_e.removeEventListener("mouseup",this.onHover),_e.removeEventListener("contextmenu",this.onHover))}interactionEvent(_e){const{type:et,pointerType:dn}=_e;let K,rr;dn==="touch"?(rr=Math.floor(_e.pointers[0].clientY),K=Math.floor(_e.pointers[0].clientX)):(rr=Math.floor(_e.srcEvent.y),K=Math.floor(_e.srcEvent.x));const Mr=this.mapService.getMapContainer();if(Mr){const{top:ti,left:uo}=Mr.getBoundingClientRect();K-=uo,rr-=ti}const ki=this.mapService.containerToLngLat([K,rr]);return{x:K,y:rr,lngLat:ki,type:et,target:_e.srcEvent}}isDoubleTap(_e,et,dn){const K=new Date().getTime();let rr="click";K-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-_e)<10&&Math.abs(this.lastClickXY[1]-et)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),rr="dblclick",this.emit(tr.Hover,{x:_e,y:et,lngLat:dn,type:rr})):(this.lastClickTime=K,this.lastClickXY=[_e,et],this.clickTimer=setTimeout(()=>{rr="click",this.emit(tr.Hover,{x:_e,y:et,lngLat:dn,type:rr})},400))}}let Ln=0;function zn(ne){let _e=ne;if(typeof ne=="string"&&(_e=document.getElementById(ne)),_e){const et=document.createElement("div");return et.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,et.id=`l7-scene-${Ln++}`,et.classList.add("l7-scene"),_e.appendChild(et),et}return null}function mn(ne){var _e;let et=!0;if((ne==null||(_e=ne.target)===null||_e===void 0?void 0:_e.target)instanceof HTMLElement){var dn;let rr=ne==null||(dn=ne.target)===null||dn===void 0?void 0:dn.target;for(;rr;){var K;const Mr=Array.from(rr.classList);if(Mr.includes("l7-marker")||Mr.includes("l7-popup")){et=!1;break}rr=(K=rr)===null||K===void 0?void 0:K.parentElement}}return et}let wn=function(ne){return ne[ne.SAMPLED=0]="SAMPLED",ne[ne.RENDER_TARGET=1]="RENDER_TARGET",ne}({});class gr{constructor(_e){var et=this;(0,X.Z)(this,"pickedColors",void 0),(0,X.Z)(this,"pickedTileLayers",[]),(0,X.Z)(this,"pickingFBO",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),(0,X.Z)(this,"alreadyInPicking",!1),(0,X.Z)(this,"pickBufferScale",1),(0,X.Z)(this,"pickFromPickingFBO",function(){var dn=(0,xe.Z)(function*(K,{x:rr,y:Mr,lngLat:ki,type:ti,target:uo}){var lo;let ca=!1;const{readPixels:Io,readPixelsAsync:xa,getViewportSize:Qa,queryVerdorInfo:aa}=et.rendererService,{width:ga,height:hs}=Qa(),{enableHighlight:Oa,enableSelect:La}=K.getLayerConfig(),Fa=rr*E.SO.DPR,Ks=Mr*E.SO.DPR;if(Fa>ga-1*E.SO.DPR||Fa<0||Ks>hs-1*E.SO.DPR||Ks<0)return!1;let Fs;if(aa()==="WebGPU"?Fs=yield xa({x:Math.floor(Fa/et.pickBufferScale),y:Math.floor((hs-(Mr+1)*E.SO.DPR)/et.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:et.pickingFBO}):Fs=Io({x:Math.floor(Fa/et.pickBufferScale),y:Math.floor((hs-(Mr+1)*E.SO.DPR)/et.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:et.pickingFBO}),et.pickedColors=Fs,Fs[0]!==0||Fs[1]!==0||Fs[2]!==0){const is=(0,E.W0)(Fs),Iu=K.layerPickService.getFeatureById(is);is!==K.getCurrentPickId()&&ti==="mousemove"&&(ti="mouseenter");const du={x:rr,y:Mr,type:ti,lngLat:ki,featureId:is,feature:Iu,target:uo};Iu&&(ca=!0,K.setCurrentPickId(is),et.triggerHoverOnLayer(K,du))}else{const is={x:rr,y:Mr,lngLat:ki,type:K.getCurrentPickId()!==null&&ti==="mousemove"?"mouseout":"un"+ti,featureId:null,target:uo,feature:null};et.triggerHoverOnLayer(K,(0,ee.Z)((0,ee.Z)({},is),{},{type:"unpick"})),et.triggerHoverOnLayer(K,is),K.setCurrentPickId(null)}if(Oa&&K.layerPickService.highlightPickedFeature(Fs),La&&ti==="click"&&((lo=Fs)===null||lo===void 0?void 0:lo.toString())!==[0,0,0,0].toString()){const is=(0,E.W0)(Fs);K.getCurrentSelectedId()===null||is!==K.getCurrentSelectedId()?(K.layerPickService.selectFeature(Fs),K.setCurrentSelectedId(is)):(K.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),K.setCurrentSelectedId(null))}return ca});return function(K,rr){return dn.apply(this,arguments)}}()),this.container=_e}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(_e){const{createTexture2D:et,createFramebuffer:dn,getViewportSize:K}=this.rendererService;let{width:rr,height:Mr}=K();this.pickBufferScale=this.configService.getSceneConfig(_e).pickBufferScale||1,rr=Math.round(rr/this.pickBufferScale),Mr=Math.round(Mr/this.pickBufferScale);const ki=et({width:rr,height:Mr,usage:wn.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=dn({color:ki,depth:!0,width:rr,height:Mr}),this.interactionService.on(tr.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(_e,et,dn){var K=this;return(0,xe.Z)(function*(){const{useFramebufferAsync:rr,clear:Mr}=K.rendererService;K.resizePickingFBO(),_e.hooks.beforePickingEncode.call(),yield rr(K.pickingFBO,(0,xe.Z)(function*(){Mr({framebuffer:K.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),_e.renderModels({ispick:!0})})),_e.hooks.afterPickingEncode.call();const ki=yield K.pickBox(_e,et);dn(ki)})()}pickBox(_e,et){var dn=this;return(0,xe.Z)(function*(){const[K,rr,Mr,ki]=et.map(hs=>{const Oa=hs<0?0:hs;return Math.floor(Oa*E.SO.DPR/dn.pickBufferScale)}),{readPixelsAsync:ti,getViewportSize:uo}=dn.rendererService,{width:lo,height:ca}=uo();if(K>(lo-1)*E.SO.DPR/dn.pickBufferScale||Mr<0||rr>(ca-1)*E.SO.DPR/dn.pickBufferScale||ki<0)return[];const Io=Math.min(lo/dn.pickBufferScale,Mr)-K,xa=Math.min(ca/dn.pickBufferScale,ki)-rr,Qa=yield ti({x:K,y:Math.floor(ca/dn.pickBufferScale-(ki+1)),width:Io,height:xa,data:new Uint8Array(Io*xa*4),framebuffer:dn.pickingFBO}),aa=[],ga={};for(let hs=0;hs<Qa.length/4;hs=hs+1){const Oa=Qa.slice(hs*4,hs*4+4),La=(0,E.W0)(Oa);if(La!==-1&&!ga[La]){const Fa=_e.layerPickService.getFeatureById(La);aa.push((0,ee.Z)((0,ee.Z)({},Fa),{},{pickedFeatureIdx:La})),ga[La]=!0}}return aa})()}handleCursor(_e,et){const{cursor:dn="",cursorEnabled:K}=_e.getLayerConfig();if(K){const Mr=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),ki=Mr==null?void 0:Mr.style.getPropertyValue("cursor");et==="unmousemove"&&ki!==""?Mr==null||Mr.style.setProperty("cursor",""):et==="mousemove"&&(Mr==null||Mr.style.setProperty("cursor",dn))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(_e){var et=this;return(0,xe.Z)(function*(){!et.layerService.needPick(_e.type)||!et.isPickingAllLayer()||(et.alreadyInPicking=!0,yield et.pickingLayers(_e),et.layerService.renderLayers(),et.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:_e}=this.rendererService,{width:et,height:dn}=_e();(this.width!==et||this.height!==dn)&&(this.pickingFBO.resize({width:Math.round(et/this.pickBufferScale),height:Math.round(dn/this.pickBufferScale)}),this.width=et,this.height=dn)}pickingLayers(_e){var et=this;return(0,xe.Z)(function*(){const{clear:dn,useFramebufferAsync:K}=et.rendererService;et.resizePickingFBO();const rr=et.layerService.getRenderList();for(const Mr of rr.filter(ki=>ki.needPick(_e.type)).reverse()){yield K(et.pickingFBO,(0,xe.Z)(function*(){dn({framebuffer:et.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Mr.layerPickService.pickRender(_e)}));const ki=yield et.pickFromPickingFBO(Mr,_e);if(et.layerService.pickedLayerId=ki?+Mr.id:-1,ki&&!Mr.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(_e,et){mn(et)&&(this.handleCursor(_e,et.type),_e.emit(et.type,et))}}class mr{constructor(_e=!0){(0,X.Z)(this,"autoStart",void 0),(0,X.Z)(this,"startTime",0),(0,X.Z)(this,"oldTime",0),(0,X.Z)(this,"running",!1),(0,X.Z)(this,"elapsedTime",0),this.autoStart=_e}start(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const et=(typeof performance=="undefined"?Date:performance).now();_e=(et-this.oldTime)/1e3,this.oldTime=et,this.elapsedTime+=_e}return _e}}const{throttle:ai}=E.lodashUtil;class Vi extends Zt.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(_e){super(),(0,X.Z)(this,"pickedLayerId",-1),(0,X.Z)(this,"clock",new mr),(0,X.Z)(this,"alreadyInRendering",!1),(0,X.Z)(this,"layers",[]),(0,X.Z)(this,"layerList",[]),(0,X.Z)(this,"layerRenderID",void 0),(0,X.Z)(this,"sceneInited",!1),(0,X.Z)(this,"animateInstanceCount",0),(0,X.Z)(this,"shaderPicking",!0),(0,X.Z)(this,"enableRender",!0),(0,X.Z)(this,"reRender",ai(()=>{this.renderLayers()},32)),(0,X.Z)(this,"throttleRenderLayers",ai(()=>{this.renderLayers()},16)),this.container=_e}needPick(_e){return this.updateLayerRenderList(),this.layerList.some(et=>et.needPick(_e))}add(_e){this.layers.push(_e),this.sceneInited&&_e.init().then(()=>{this.renderLayers()})}addMask(_e){this.sceneInited&&_e.init().then(()=>{this.renderLayers()})}initLayers(){var _e=this;return(0,xe.Z)(function*(){_e.sceneInited=!0,_e.layers.forEach(function(){var et=(0,xe.Z)(function*(dn){dn.startInit||(yield dn.init(),_e.updateLayerRenderList())});return function(dn){return et.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(_e){return this.layers.find(et=>et.id===_e)}getLayerByName(_e){return this.layers.find(et=>et.name===_e)}remove(_e,et){var dn=this;return(0,xe.Z)(function*(){et?et.layerChildren=et.layerChildren.filter(K=>K!==_e):dn.layers=dn.layers.filter(K=>K!==_e),_e.destroy(),dn.reRender(),dn.emit("layerChange",dn.layers)})()}removeAllLayers(){var _e=this;return(0,xe.Z)(function*(){_e.destroy(),_e.reRender()})()}setEnableRender(_e){this.enableRender=_e}renderLayers(){var _e=this;return(0,xe.Z)(function*(){if(_e.alreadyInRendering||!_e.enableRender)return;_e.updateLayerRenderList();const et=_e.debugService.generateRenderUid();_e.debugService.renderStart(et),_e.alreadyInRendering=!0,_e.clear();for(const dn of _e.layerList)dn.prerender();_e.renderService.beginFrame();for(const dn of _e.layerList){const{enableMask:K}=dn.getLayerConfig();dn.masks.filter(rr=>rr.inited).length>0&&K&&_e.renderMask(dn.masks),dn.getLayerConfig().enableMultiPassRenderer?yield dn.renderMultiPass():dn.render()}_e.renderService.endFrame(),_e.debugService.renderEnd(et),_e.alreadyInRendering=!1})()}renderMask(_e){let et=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const dn=_e.length>1?Ut.MULTIPLE:Ut.SINGLE;for(const K of _e)K.render({isStencil:!0,stencilType:dn,stencilIndex:et++})}beforeRenderData(_e){var et=this;return(0,xe.Z)(function*(){(yield _e.hooks.beforeRenderData.promise())&&et.renderLayers()})()}renderTileLayerMask(_e){let et=0;const{enableMask:dn=!0}=_e.getLayerConfig();let K=_e.tileMask?1:0;const rr=_e.masks.filter(ki=>ki.inited);K=K+(dn?rr.length:1);const Mr=K>1?Ut.MULTIPLE:Ut.SINGLE;if((_e.tileMask||rr.length&&dn)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),rr.length&&dn)for(const ki of rr)ki.render({isStencil:!0,stencilType:Mr,stencilIndex:et++});_e.tileMask&&_e.tileMask.render({isStencil:!0,stencilType:Mr,stencilIndex:et++,stencilOperation:Dt.OR})}renderTileLayer(_e){var et=this;return(0,xe.Z)(function*(){et.renderTileLayerMask(_e),_e.getLayerConfig().enableMultiPassRenderer?yield _e.renderMultiPass():yield _e.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(_e=>_e.inited).filter(_e=>_e.isVisible()).sort((_e,et)=>_e.zIndex-et.zIndex).forEach(_e=>{this.layerList.push(_e)})}destroy(){this.layers.forEach(_e=>{_e.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const _e=(0,E.CI)(this.mapService.bgColor);this.renderService.clear({color:_e,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}var fo=D(45987);const{isNil:ei}=E.lodashUtil;class zi{constructor(_e){(0,X.Z)(this,"name",void 0),(0,X.Z)(this,"type",void 0),(0,X.Z)(this,"scale",void 0),(0,X.Z)(this,"descriptor",void 0),(0,X.Z)(this,"featureBufferLayout",[]),(0,X.Z)(this,"needRescale",!1),(0,X.Z)(this,"needRemapping",!1),(0,X.Z)(this,"needRegenerateVertices",!1),(0,X.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,X.Z)(this,"vertexAttribute",void 0),(0,X.Z)(this,"defaultCallback",et=>{if(et.length===0){var dn;return((dn=this.scale)===null||dn===void 0?void 0:dn.defaultValues)||[]}return et.map((K,rr)=>{var Mr;return((Mr=this.scale)===null||Mr===void 0?void 0:Mr.scalers[rr].func)(K)})}),this.setProps(_e)}setProps(_e){Object.assign(this,_e)}mapping(_e){var et;if((et=this.scale)!==null&&et!==void 0&&et.callback){var dn;const K=(dn=this.scale)===null||dn===void 0?void 0:dn.callback(..._e);if(!ei(K))return[K]}return this.defaultCallback(_e)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const Li=["buffer","update","name"],Zr=["buffer","update","name"],go={[re.FLOAT]:4,[re.UNSIGNED_BYTE]:1,[re.UNSIGNED_SHORT]:2};class Mi{constructor(_e){(0,X.Z)(this,"attributesAndIndices",void 0),(0,X.Z)(this,"attributes",[]),(0,X.Z)(this,"triangulation",void 0),(0,X.Z)(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=_e}registerStyleAttribute(_e){let et=this.getLayerStyleAttribute(_e.name||"");return et?et.setProps(_e):(et=new zi(_e),this.attributes.push(et)),et}unRegisterStyleAttribute(_e){const et=this.attributes.findIndex(dn=>dn.name===_e);et>-1&&this.attributes.splice(et,1)}updateScaleAttribute(_e){this.attributes.forEach(et=>{var dn;const K=et.name,rr=(dn=et.scale)===null||dn===void 0?void 0:dn.field;(_e[K]||rr&&_e[rr])&&(et.needRescale=!0,et.needRemapping=!0,et.needRegenerateVertices=!0)})}updateStyleAttribute(_e,et,dn){let K=this.getLayerStyleAttribute(_e);K||(K=this.registerStyleAttribute((0,ee.Z)((0,ee.Z)({},et),{},{name:_e})));const{scale:rr}=et;rr&&K&&(K.scale=rr,K.needRescale=!0,K.needRemapping=!0,K.needRegenerateVertices=!0,dn&&dn.featureRange&&(K.featureRange=dn.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(_e){return this.attributes.find(et=>et.name===_e)}getLayerAttributeScale(_e){var et;const dn=this.getLayerStyleAttribute(_e),K=dn==null||(et=dn.scale)===null||et===void 0?void 0:et.scalers;return K&&K[0]?K[0].func:null}updateAttributeByFeatureRange(_e,et,dn=0,K,rr){const Mr=this.attributes.find(ki=>ki.name===_e);if(Mr&&Mr.descriptor){const{descriptor:ki}=Mr,{update:ti,buffer:uo,size:lo=0}=ki,ca=go[uo.type||re.FLOAT];if(ti){const{elements:Io,sizePerElement:xa}=this.featureLayout,Qa=Io.slice(dn,K);if(!Qa.length)return;const{offset:aa}=Qa[0],ga=aa*lo*ca,hs=Qa.map(({featureIdx:Oa,vertices:La,normals:Fa},Ks)=>{const Fs=La.length/xa,Ec=[];for(let is=0;is<Fs;is++){const Iu=Fa?Fa.slice(is*3,is*3+3):[];Ec.push(...ti(et[Oa],Oa,La.slice(is*xa,is*xa+xa),Ks,Iu))}return Ec}).flat();Mr.vertexAttribute.updateBuffer({data:hs,offset:ga}),rr==null||rr.emit(`legend:${_e}`,rr.getLegend(_e))}}}createAttributesAndIndices(_e,et,dn,K){this.featureLayout={sizePerElement:0,elements:[]},et&&(this.triangulation=et);const rr=this.attributes.map(aa=>(aa.resetDescriptor(),aa.descriptor));let Mr=0,ki=0;const ti=[];let uo=3;_e.forEach((aa,ga)=>{const{indices:hs,vertices:Oa,normals:La,size:Fa,indexes:Ks,count:Fs}=this.triangulation(aa,dn);typeof Fs=="number"&&(ki+=Fs),hs.forEach(is=>{ti.push(is+Mr)}),uo=Fa;const Ec=Oa.length/Fa;this.featureLayout.sizePerElement=uo,this.featureLayout.elements.push({featureIdx:ga,vertices:Oa,normals:La,offset:Mr}),Mr+=Ec;for(let is=0;is<Ec;is++){const Iu=(La==null?void 0:La.slice(is*3,is*3+3))||[],du=Oa.slice(is*Fa,is*Fa+Fa);let Lc=0;Ks&&Ks[is]!==void 0&&(Lc=Ks[is]),rr.forEach((Pf,Hh)=>{Pf&&Pf.update&&Pf.buffer.data.push(...Pf.update(aa,ga,du,is,Iu,Lc))})}});const{createAttribute:lo,createBuffer:ca,createElements:Io}=this.rendererService,xa={};rr.forEach((aa,ga)=>{if(aa){const{buffer:hs,update:Oa,name:La}=aa,Fa=(0,fo.Z)(aa,Li),Ks=lo((0,ee.Z)({buffer:ca(hs)},Fa));xa[aa.name||""]=Ks,this.attributes[ga].vertexAttribute=Ks}});const Qa=Io({data:ti,type:re.UNSIGNED_INT,count:ti.length});return this.attributesAndIndices={attributes:xa,elements:Qa,count:ki},Object.values(this.attributes).filter(aa=>aa.scale).forEach(aa=>{const ga=aa.name;K==null||K.emit(`legend:${ga}`,K.getLegend(ga))}),this.attributesAndIndices}createAttributes(_e,et){this.featureLayout={sizePerElement:0,elements:[]},et&&(this.triangulation=et);const dn=this.attributes.map(lo=>(lo.resetDescriptor(),lo.descriptor));let K=0;const rr=[];let Mr=3;_e.forEach((lo,ca)=>{const{indices:Io,vertices:xa,normals:Qa,size:aa,indexes:ga}=this.triangulation(lo);Io.forEach(Oa=>{rr.push(Oa+K)}),Mr=aa;const hs=xa.length/aa;this.featureLayout.sizePerElement=Mr,this.featureLayout.elements.push({featureIdx:ca,vertices:xa,normals:Qa,offset:K}),K+=hs;for(let Oa=0;Oa<hs;Oa++){const La=(Qa==null?void 0:Qa.slice(Oa*3,Oa*3+3))||[],Fa=xa.slice(Oa*aa,Oa*aa+aa);let Ks=0;ga&&ga[Oa]!==void 0&&(Ks=ga[Oa]),dn.forEach((Fs,Ec)=>{Fs&&Fs.update&&Fs.buffer.data.push(...Fs.update(lo,ca,Fa,Oa,La,Ks))})}});const{createAttribute:ki,createBuffer:ti}=this.rendererService,uo={};return dn.forEach((lo,ca)=>{if(lo){const{buffer:Io,update:xa,name:Qa}=lo,aa=(0,fo.Z)(lo,Zr),ga=ki((0,ee.Z)({buffer:ti(Io)},aa));uo[lo.name||""]=ga,this.attributes[ca].vertexAttribute=ga}}),{attributes:uo}}clearAllAttributes(){var _e;this.attributes.forEach(et=>{et.vertexAttribute&&et.vertexAttribute.destroy()}),(_e=this.attributesAndIndices)===null||_e===void 0||_e.elements.destroy(),this.attributes=[]}}var bo=D(46343),Si=D(63844),wo=D.n(Si);class Yo extends Zt.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(_e){super(),(0,X.Z)(this,"destroyed",!1),(0,X.Z)(this,"loaded",!1),(0,X.Z)(this,"id",void 0),(0,X.Z)(this,"inited",!1),(0,X.Z)(this,"rendering",!1),(0,X.Z)(this,"$container",void 0),(0,X.Z)(this,"canvas",void 0),(0,X.Z)(this,"markerContainer",void 0),(0,X.Z)(this,"resizeDetector",void 0),(0,X.Z)(this,"hooks",void 0),(0,X.Z)(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),(0,X.Z)(this,"handleMapCameraChanged",et=>{this.cameraService.update(et),this.render()}),this.container=_e,this.hooks={init:new bo.sX},this.id=_e.id}init(_e){var et=this;this.configService.setSceneConfig(this.id,_e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,xe.Z)(function*(){et.debugService.log("map.mapInitStart",{type:et.map.version}),yield new Promise(dn=>{et.map.onCameraChanged(K=>{et.cameraService.init(),et.cameraService.update(K),dn()}),et.map.init()}),et.map.onCameraChanged(et.handleMapCameraChanged),et.map.addMarkerContainer(),et.markerService.addMarkers(),et.markerService.addMarkerLayers(),et.popupService.initPopup(),et.interactionService.init(),et.interactionService.on(tr.Drag,et.addSceneEvent.bind(et))})),this.hooks.init.tapPromise("initRenderer",(0,xe.Z)(function*(){var dn;const K=((dn=et.map)===null||dn===void 0?void 0:dn.getOverlayContainer())||void 0;if(K?et.$container=K:et.$container=zn(et.configService.getSceneConfig(et.id).id||""),et.$container){const{canvas:Mr}=_e;if(et.canvas=Mr||E.SO.create("canvas","",et.$container),et.setCanvas(),yield et.rendererService.init(et.canvas,et.configService.getSceneConfig(et.id),_e.gl),et.registerContextLost(),et.initContainer(),et.resizeDetector=wo()({strategy:"scroll"}),et.resizeDetector.listenTo(et.$container,et.handleWindowResized),window.matchMedia){var rr;(rr=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||rr===void 0||rr.addListener(et.handleWindowResized.bind("screen"))}}else console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");et.pickingService.init(et.id)})),this.render()}registerContextLost(){const _e=this.rendererService.getCanvas();_e&&_e.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(_e){this.layerService.sceneService=this,this.layerService.add(_e)}addMask(_e){this.layerService.sceneService=this,this.layerService.addMask(_e)}render(){var _e=this;return(0,xe.Z)(function*(){_e.rendering||_e.destroyed||(_e.rendering=!0,_e.inited?(yield _e.layerService.initLayers(),yield _e.layerService.renderLayers()):(yield _e.hooks.init.promise(),_e.destroyed&&_e.destroy(),yield _e.layerService.initLayers(),_e.layerService.renderLayers(),_e.controlService.addControls(),_e.loaded=!0,_e.emit("loaded"),_e.inited=!0),_e.rendering=!1)})()}addFontFace(_e,et){this.fontService.addFontFace(_e,et)}getSceneContainer(){return this.$container}exportPng(_e){var et=this;return(0,xe.Z)(function*(){var dn;const K=(dn=et.$container)===null||dn===void 0?void 0:dn.getElementsByTagName("canvas")[0];return yield et.render(),_e==="jpg"?K==null?void 0:K.toDataURL("image/jpeg"):K==null?void 0:K.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const _e=this.$container.parentElement;_e!==null&&(this.markerContainer=E.SO.create("div","l7-marker-container",_e))}getMarkerContainer(){return this.markerContainer}destroy(){var _e;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var et;(et=this.$container)===null||et===void 0||et.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(_e=this.$container)===null||_e===void 0||(_e=_e.parentNode)===null||_e===void 0||_e.removeChild(this.$container),this.emit("destroy")}initContainer(){var _e,et;const dn=E.SO.DPR,K=((_e=this.$container)===null||_e===void 0?void 0:_e.clientWidth)||400,rr=((et=this.$container)===null||et===void 0?void 0:et.clientHeight)||300,Mr=this.canvas;Mr&&(Mr.width=K*dn,Mr.height=rr*dn),this.rendererService.viewport({x:0,y:0,width:dn*K,height:dn*rr})}setCanvas(){var _e,et;const dn=E.SO.DPR,K=((_e=this.$container)===null||_e===void 0?void 0:_e.clientWidth)||400,rr=((et=this.$container)===null||et===void 0?void 0:et.clientHeight)||300,Mr=this.canvas;Mr.width=K*dn,Mr.height=rr*dn,Mr.style.width="100%",Mr.style.height="100%"}addSceneEvent(_e){this.emit(_e.type,_e)}}const{uniq:Wa}=E.lodashUtil,na="#define PI 3.14159265359",jo=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Va=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,fs=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,Tt=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Ft=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Dn=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,sr=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,_i=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,bi=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,so=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,Ha=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Bs=/precision\s+(high|low|medium)p\s+float/,Os=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,il=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,Xf=/void\s+main\s*\([^)]*\)\s*\{\n?/;class zd{constructor(){(0,X.Z)(this,"moduleCache",{}),(0,X.Z)(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:na,fs:na}),this.registerModule("decode",{vs:Va,fs:""}),this.registerModule("scene_uniforms",{vs:so,fs:so}),this.registerModule("picking_uniforms",{vs:Dn,fs:Dn}),this.registerModule("projection",{vs:_i,fs:_i}),this.registerModule("project",{vs:sr,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Ha}),this.registerModule("lighting",{vs:fs,fs:""}),this.registerModule("light",{vs:jo,fs:""}),this.registerModule("picking",{vs:Ft,fs:Tt}),this.registerModule("rotation_2d",{vs:bi,fs:""})}registerModule(_e,et){et.vs=et.vs.replace(/\r\n/g,`
`),et.fs=et.fs.replace(/\r\n/g,`
`);const{vs:dn,fs:K,uniforms:rr,defines:Mr,inject:ki}=et,{content:ti,uniforms:uo}=Se(dn),{content:lo,uniforms:ca}=Se(K);this.rawContentCache[_e]={fs:lo,defines:Mr,inject:ki,uniforms:(0,ee.Z)((0,ee.Z)((0,ee.Z)({},uo),ca),rr),vs:ti}}getModule(_e){let et=this.rawContentCache[_e].vs,dn=this.rawContentCache[_e].fs;const{defines:K={},inject:rr={}}=this.rawContentCache[_e];let Mr={};rr["vs:#decl"]&&(et=rr["vs:#decl"]+et,Mr=Se(rr["vs:#decl"]).uniforms),rr["vs:#main-start"]&&(et=et.replace(Xf,aa=>aa+rr["vs:#main-start"])),rr["fs:#decl"]&&(dn=rr["fs:#decl"]+dn),et=md(K)+et;const{content:ti,includeList:uo}=this.processModule(et,[],"vs"),{content:lo,includeList:ca}=this.processModule(dn,[],"fs"),Io=Wa(uo.concat(ca).concat(_e)).reduce((aa,ga)=>(0,ee.Z)((0,ee.Z)({},aa),this.rawContentCache[ga].uniforms),(0,ee.Z)({},Mr)),xa=(Bs.test(lo)?"":Os)+ti,Qa=(Bs.test(lo)?"":Os)+lo;return this.moduleCache[_e]={vs:xa.trim(),fs:Qa.trim(),uniforms:Io},this.moduleCache[_e]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(_e,et,dn){return{content:_e.replace(il,(rr,Mr)=>{const ti=Mr.split(" ")[0].replace(/"/g,"");if(et.indexOf(ti)>-1)return"";const uo=this.rawContentCache[ti][dn];et.push(ti);const{content:lo}=this.processModule(uo,et,dn);return lo}),includeList:et}}}function md(ne){return Object.keys(ne).reduce((et,dn)=>et+`#define ${dn.toUpperCase()} ${ne[dn]}
`,`
`)}class Dl{constructor(){(0,X.Z)(this,"shaderModuleService",void 0),(0,X.Z)(this,"rendererService",void 0),(0,X.Z)(this,"cameraService",void 0),(0,X.Z)(this,"mapService",void 0),(0,X.Z)(this,"interactionService",void 0),(0,X.Z)(this,"layerService",void 0),(0,X.Z)(this,"config",void 0)}getName(){return""}getType(){return ve.Normal}init(_e,et){this.config=et,this.rendererService=_e.getContainer().rendererService,this.cameraService=_e.getContainer().cameraService,this.mapService=_e.getContainer().mapService,this.interactionService=_e.getContainer().interactionService,this.layerService=_e.getContainer().layerService,this.shaderModuleService=_e.getContainer().shaderModuleService}render(_e){}}class Qc extends Dl{getName(){return"clear"}init(_e,et){super.init(_e,et)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class Mf{constructor(_e){(0,X.Z)(this,"passes",[]),(0,X.Z)(this,"layer",void 0),(0,X.Z)(this,"renderFlag",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),this.postProcessor=_e}setLayer(_e){this.layer=_e}setRenderFlag(_e){this.renderFlag=_e}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var _e=this;return(0,xe.Z)(function*(){for(const et of _e.passes)yield et.render(_e.layer);yield _e.postProcessor.render(_e.layer)})()}resize(_e,et){(this.width!==_e||this.height!==et)&&(this.postProcessor.resize(_e,et),this.width=_e,this.height=et)}add(_e,et){_e.getType()===ve.PostProcessing?this.postProcessor.add(_e,this.layer,et):(_e.init(this.layer,et),this.passes.push(_e))}insert(_e,et,dn){_e.init(this.layer,et),this.passes.splice(dn,0,_e)}destroy(){this.passes.length=0}}class Jc extends Dl{constructor(..._e){var et;super(..._e),et=this,(0,X.Z)(this,"pickingFBO",void 0),(0,X.Z)(this,"layer",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),(0,X.Z)(this,"alreadyInRendering",!1),(0,X.Z)(this,"pickFromPickingFBO",({x:dn,y:K,lngLat:rr,type:Mr})=>{if(!this.layer.isVisible()||!this.layer.needPick(Mr))return;const{getViewportSize:ki,readPixelsAsync:ti,useFramebuffer:uo}=this.rendererService,{width:lo,height:ca}=ki(),{enableHighlight:Io,enableSelect:xa}=this.layer.getLayerConfig(),Qa=dn*E.SO.DPR,aa=K*E.SO.DPR;if(Qa>lo||Qa<0||aa>ca||aa<0)return;let ga;uo(this.pickingFBO,(0,xe.Z)(function*(){var hs;if(ga=yield ti({x:Math.round(Qa),y:Math.round(ca-(K+1)*E.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:et.pickingFBO}),ga[0]!==0||ga[1]!==0||ga[2]!==0){const Oa=(0,E.W0)(ga),La=et.layer.getSource().getFeatureById(Oa),Fa={x:dn,y:K,type:Mr,lngLat:rr,featureId:Oa,feature:La};La&&(et.layer.setCurrentPickId(Oa),et.triggerHoverOnLayer(Fa))}else{const Oa={x:dn,y:K,lngLat:rr,type:et.layer.getCurrentPickId()===null?"un"+Mr:"mouseout",featureId:null,feature:null};et.triggerHoverOnLayer((0,ee.Z)((0,ee.Z)({},Oa),{},{type:"unpick"})),et.triggerHoverOnLayer(Oa),et.layer.setCurrentPickId(null)}Io&&et.highlightPickedFeature(ga),xa&&Mr==="click"&&((hs=ga)===null||hs===void 0?void 0:hs.toString())!==[0,0,0,0].toString()&&et.selectFeature(ga)}))})}getType(){return ve.Normal}getName(){return"pixelPicking"}init(_e,et){super.init(_e,et),this.layer=_e;const{createTexture2D:dn,createFramebuffer:K,getViewportSize:rr}=this.rendererService,{width:Mr,height:ki}=rr(),ti=dn({width:Mr,height:ki,wrapS:re.CLAMP_TO_EDGE,wrapT:re.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=K({color:ti}),this.interactionService.on(tr.Hover,this.pickFromPickingFBO),this.interactionService.on(tr.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(tr.Active,this.highlightFeatureHandle.bind(this))}render(_e){if(this.alreadyInRendering)return;const{getViewportSize:et,useFramebuffer:dn,clear:K}=this.rendererService,{width:rr,height:Mr}=et();this.alreadyInRendering=!0,(this.width!==rr||this.height!==Mr)&&(this.pickingFBO.resize({width:rr,height:Mr}),this.width=rr,this.height=Mr),dn(this.pickingFBO,()=>{K({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const ki=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),_e.hooks.beforePickingEncode.call(),_e.render(),_e.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(ki),this.alreadyInRendering=!1})}triggerHoverOnLayer(_e){this.layer.emit(_e.type,_e)}highlightPickedFeature(_e){const[et,dn,K]=_e;this.layer.hooks.beforeHighlight.call([et,dn,K]),this.layerService.renderLayers()}selectFeature(_e){const[et,dn,K]=_e;this.layer.hooks.beforeSelect.call([et,dn,K]),this.layerService.renderLayers()}selectFeatureHandle({featureId:_e}){const et=(0,E.Z6)(_e);this.selectFeature(new Uint8Array(et))}highlightFeatureHandle({featureId:_e}){const et=(0,E.Z6)(_e);this.highlightPickedFeature(new Uint8Array(et))}}class Ic{constructor(_e){(0,X.Z)(this,"passes",[]),(0,X.Z)(this,"readFBO",void 0),(0,X.Z)(this,"writeFBO",void 0),this.rendererService=_e,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:_e,createTexture2D:et}=this.rendererService,{width:dn,height:K}=_e();return et({x:0,y:0,width:dn,height:K,copy:!0})}getReadFBOTex(){var _e=this;const{useFramebuffer:et}=this.rendererService;return new Promise(dn=>{et(this.readFBO,(0,xe.Z)(function*(){dn(_e.getCurrentFBOTex())}))})}renderBloomPass(_e,et){var dn=this;return(0,xe.Z)(function*(){const K=yield dn.getReadFBOTex();let rr=0;for(;rr<4;)yield et.render(_e,K),dn.swap(),rr++})()}render(_e){var et=this;return(0,xe.Z)(function*(){for(let dn=0;dn<et.passes.length;dn++){const K=et.passes[dn];K.setRenderToScreen(et.isLastEnabledPass(dn)),K.getName()==="bloom"?yield et.renderBloomPass(_e,K):(yield K.render(_e),dn!==et.passes.length-1&&et.swap())}})()}resize(_e,et){this.readFBO.resize({width:_e,height:et}),this.writeFBO.resize({width:_e,height:et})}add(_e,et,dn){_e.init(et,dn),this.passes.push(_e)}insert(_e,et,dn,K){_e.init(dn,K),this.passes.splice(et,0,_e)}getPostProcessingPassByName(_e){return this.passes.find(et=>et.getName()===_e)}init(){const{createFramebuffer:_e,createTexture2D:et}=this.rendererService;this.readFBO=_e({color:et({width:1,height:1,wrapS:re.CLAMP_TO_EDGE,wrapT:re.CLAMP_TO_EDGE,usage:wn.RENDER_TARGET})}),this.writeFBO=_e({color:et({width:1,height:1,wrapS:re.CLAMP_TO_EDGE,wrapT:re.CLAMP_TO_EDGE,usage:wn.RENDER_TARGET})})}isLastEnabledPass(_e){for(let et=_e+1;et<this.passes.length;et++)if(this.passes[et].isEnabled())return!1;return!0}swap(){const _e=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=_e}}class eu extends Dl{getType(){return ve.Normal}getName(){return"render"}init(_e,et){super.init(_e,et)}render(_e){const{useFramebuffer:et,clear:dn}=this.rendererService,K=_e.multiPassRenderer.getPostProcessor().getReadFBO();et(K,()=>{dn({color:[0,0,0,0],depth:1,stencil:0,framebuffer:K}),_e.multiPassRenderer.setRenderFlag(!1),_e.models.forEach(rr=>{rr.draw({uniforms:_e.layerModel.getUninforms()})}),_e.multiPassRenderer.setRenderFlag(!0)})}}const Yf=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,ac=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Xs}=E.lodashUtil;class Ru extends ze{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:ac,fs:Yf});const{vs:_e,fs:et,uniforms:dn}=this.shaderModuleService.getModule("blur-pass"),{width:K,height:rr}=this.rendererService.getViewportSize();return{vs:_e,fs:et,uniforms:(0,ee.Z)((0,ee.Z)({},dn),{},{u_ViewportSize:[K,rr]})}}convertOptionsToUniforms(_e){const et={};return Xs(_e.bloomRadius)||(et.u_radius=_e.bloomRadius),Xs(_e.bloomIntensity)||(et.u_intensity=_e.bloomIntensity),Xs(_e.bloomBaseRadio)||(et.u_baseRadio=_e.bloomBaseRadio),et}}const gf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,kh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:zh}=E.lodashUtil;class tu extends ze{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:kh,fs:gf});const{vs:_e,fs:et,uniforms:dn}=this.shaderModuleService.getModule("blur-pass"),{width:K,height:rr}=this.rendererService.getViewportSize();return{vs:_e,fs:et,uniforms:(0,ee.Z)((0,ee.Z)({},dn),{},{u_ViewportSize:[K,rr]})}}convertOptionsToUniforms(_e){const et={};return zh(_e.blurRadius)||(et.u_BlurDir=[_e.blurRadius,0]),et}}const mh=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Uh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:vd}=E.lodashUtil;class gd extends ze{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:Uh,fs:mh});const{vs:_e,fs:et,uniforms:dn}=this.shaderModuleService.getModule("blur-pass"),{width:K,height:rr}=this.rendererService.getViewportSize();return{vs:_e,fs:et,uniforms:(0,ee.Z)((0,ee.Z)({},dn),{},{u_ViewportSize:[K,rr]})}}convertOptionsToUniforms(_e){const et={};return vd(_e.blurRadius)||(et.u_BlurDir=[0,_e.blurRadius]),et}}const yd=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,vp=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class $f extends ze{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:vp,fs:yd});const{vs:_e,fs:et,uniforms:dn}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:K,height:rr}=this.rendererService.getViewportSize();return{vs:_e,fs:et,uniforms:(0,ee.Z)((0,ee.Z)({},dn),{},{u_ViewportSize:[K,rr]})}}}const Mu=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,_d=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Nl extends ze{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:_d,fs:Mu}),this.shaderModuleService.getModule("copy-pass")}}const Is=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,nu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class sc extends ze{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:nu,fs:Is});const{vs:_e,fs:et,uniforms:dn}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:K,height:rr}=this.rendererService.getViewportSize();return{vs:_e,fs:et,uniforms:(0,ee.Z)((0,ee.Z)({},dn),{},{u_ViewportSize:[K,rr]})}}}const of=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,lc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class af extends ze{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:lc,fs:of});const{vs:_e,fs:et,uniforms:dn}=this.shaderModuleService.getModule("ink-pass"),{width:K,height:rr}=this.rendererService.getViewportSize();return{vs:_e,fs:et,uniforms:(0,ee.Z)((0,ee.Z)({},dn),{},{u_ViewportSize:[K,rr]})}}}const Bl=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Pu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class yf extends ze{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:Pu,fs:Bl}),this.shaderModuleService.getModule("noise-pass")}}const vh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Kf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class ps extends ze{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:vh,fs:Kf}),this.shaderModuleService.getModule("sepia-pass")}}const jh=new fi;let Vh=0;function gh(){const ne=new zd,_e=new Xo,et=new _t,dn=new Co(et),K=new Ae,rr=new tn,Mr=new Tr,ki=new jr,ti=new Gn,uo={id:`${Vh++}`,globalConfigService:jh,shaderModuleService:ne,debugService:_e,cameraService:et,coordinateSystemService:dn,fontService:K,iconService:rr,markerService:Mr,popupService:ki,controlService:ti,customRenderService:{}},lo=new Vi(uo);uo.layerService=lo;const ca=new Yo(uo);uo.sceneService=ca;const Io=new sn(uo);uo.interactionService=Io;const xa=new gr(uo);uo.pickingService=xa;const Qa={clear:new Qc,pixelPicking:new Jc,render:new eu};uo.normalPassFactory=ga=>Qa[ga];const aa={copy:new Nl,bloom:new Ru,blurH:new tu,blurV:new gd,noise:new yf,sepia:new ps,colorHalftone:new $f,hexagonalPixelate:new sc,ink:new af};return uo.postProcessingPass=aa,uo.postProcessingPassFactory=ga=>aa[ga],uo}function ol(ne){const _e=(0,ee.Z)({},ne);return _e.postProcessor=new Ic(_e.rendererService),_e.multiPassRenderer=new Mf(_e.postProcessor),_e.styleAttributeService=new Mi(_e.rendererService),_e}const qf=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let Qf=function(ne){return ne.IMAGE="image",ne.CUSTOMIMAGE="customImage",ne.ARRAYBUFFER="arraybuffer",ne.RGB="rgb",ne.TERRAINRGB="terrainRGB",ne.CUSTOMRGB="customRGB",ne.CUSTOMARRAYBUFFER="customArrayBuffer",ne.CUSTOMTERRAINRGB="customTerrainRGB",ne}({})},35914:function($t,W,D){"use strict";D.d(W,{Z:function(){return qn}});var ee=D(1413),X=D(4942);class E{constructor(pt){(0,X.Z)(this,"configService",void 0),(0,X.Z)(this,"config",void 0),this.config=pt}setContainer(pt,Wt){this.configService=pt.globalConfigService,pt.mapConfig=(0,ee.Z)((0,ee.Z)({},this.config),{},{id:Wt}),pt.mapService=new(this.getServiceConstructor())(pt)}getServiceConstructor(){throw new Error("Method not implemented.")}}var ve=D(45987),re=D(15861),fe=D(85975),ae=D(77160),Ee=D(6158),oe=D.n(Ee),ze=D(15671),te=D(43144),ye=D(82963),De=D(61120),Se=D(60136),we=D(97326),ce=D(97685),Ze=D(98333);function xt(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ht(hn,pt){var Wt=Ze.fF([],pt,hn);return Ze.bA(Wt,Wt,1/Wt[3]),Wt}function Gt(hn,pt){var Wt=hn%pt;return Wt<0?pt+Wt:Wt}function mt(hn,pt,Wt){return Wt*pt+(1-Wt)*hn}var gt=D(31437);function Be(hn,pt){if(!hn)throw new Error(pt||"viewport-mercator-project: assertion failed.")}var Re=Math.PI,bt=Re/4,yt=Re/180,At=180/Re,bn=512,He=4003e4,Rt=1.5;function Oe(hn){return Math.pow(2,hn)}function it(hn){return Math.log2(hn)}function Qe(hn,pt){var Wt=(0,ce.Z)(hn,2),An=Wt[0],Pn=Wt[1];Be(Number.isFinite(An)&&Number.isFinite(pt)),Be(Number.isFinite(Pn)&&Pn>=-90&&Pn<=90,"invalid latitude"),pt*=bn;var Xn=An*yt,dt=Pn*yt,be=pt*(Xn+Re)/(2*Re),Ne=pt*(Re-Math.log(Math.tan(bt+dt*.5)))/(2*Re);return[be,Ne]}function $e(hn,pt){var Wt=(0,ce.Z)(hn,2),An=Wt[0],Pn=Wt[1];pt*=bn;var Xn=An/pt*(2*Re)-Re,dt=2*(Math.atan(Math.exp(Re-Pn/pt*(2*Re)))-bt);return[Xn*At,dt*At]}function Ot(hn){var pt=hn.latitude;assert(Number.isFinite(pt));var Wt=Math.cos(pt*yt);return it(He*Wt)-9}function vt(hn){var pt=hn.latitude,Wt=hn.longitude,An=hn.zoom,Pn=hn.scale,Xn=hn.highPrecision,dt=Xn===void 0?!1:Xn;Pn=Pn!==void 0?Pn:Oe(An),Be(Number.isFinite(pt)&&Number.isFinite(Wt)&&Number.isFinite(Pn));var be={},Ne=bn*Pn,ot=Math.cos(pt*yt),Pt=Ne/360,It=Pt/ot,xn=Ne/He/ot;if(be.pixelsPerMeter=[xn,-xn,xn],be.metersPerPixel=[1/xn,-1/xn,1/xn],be.pixelsPerDegree=[Pt,-It,xn],be.degreesPerPixel=[1/Pt,-1/It,1/xn],dt){var Qn=yt*Math.tan(pt*yt)/ot,br=Pt*Qn/2,Jn=Ne/He*Qn,Ae=Jn/It*xn;be.pixelsPerDegree2=[0,-br,Jn],be.pixelsPerMeter2=[Ae,0,Ae]}return be}function Me(hn,pt){var Wt=_slicedToArray(hn,3),An=Wt[0],Pn=Wt[1],Xn=Wt[2],dt=_slicedToArray(pt,3),be=dt[0],Ne=dt[1],ot=dt[2],Pt=1,It=vt({longitude:An,latitude:Pn,scale:Pt,highPrecision:!0}),xn=It.pixelsPerMeter,Qn=It.pixelsPerMeter2,br=Qe(hn,Pt);br[0]+=be*(xn[0]+Qn[0]*Ne),br[1]+=Ne*(xn[1]+Qn[1]*Ne);var Jn=$e(br,Pt),Ae=(Xn||0)+(ot||0);return Number.isFinite(Xn)||Number.isFinite(ot)?[Jn[0],Jn[1],Ae]:Jn}function Xt(hn){var pt=hn.height,Wt=hn.pitch,An=hn.bearing,Pn=hn.altitude,Xn=hn.center,dt=Xn===void 0?null:Xn,be=hn.flipY,Ne=be===void 0?!1:be,ot=xt();return fe.translate(ot,ot,[0,0,-Pn]),fe.scale(ot,ot,[1,1,1/pt]),fe.rotateX(ot,ot,-Wt*yt),fe.rotateZ(ot,ot,An*yt),Ne&&fe.scale(ot,ot,[1,-1,1]),dt&&fe.translate(ot,ot,ae.tk([],dt)),ot}function on(hn){var pt=hn.width,Wt=hn.height,An=hn.altitude,Pn=An===void 0?Rt:An,Xn=hn.pitch,dt=Xn===void 0?0:Xn,be=hn.nearZMultiplier,Ne=be===void 0?1:be,ot=hn.farZMultiplier,Pt=ot===void 0?1:ot,It=dt*yt,xn=Math.atan(.5/Pn),Qn=Math.sin(xn)*Pn/Math.sin(Math.PI/2-It-xn),br=Math.cos(Math.PI/2-It)*Qn+Pn;return{fov:2*Math.atan(Wt/2/Pn),aspect:pt/Wt,focalDistance:Pn,near:Ne,far:br*Pt}}function Fn(hn){var pt=hn.width,Wt=hn.height,An=hn.pitch,Pn=hn.altitude,Xn=hn.nearZMultiplier,dt=hn.farZMultiplier,be=on({width:pt,height:Wt,altitude:Pn,pitch:An,nearZMultiplier:Xn,farZMultiplier:dt}),Ne=be.fov,ot=be.aspect,Pt=be.near,It=be.far,xn=fe.perspective([],Ne,ot,Pt,It);return xn}function $n(hn,pt){var Wt=(0,ce.Z)(hn,3),An=Wt[0],Pn=Wt[1],Xn=Wt[2],dt=Xn===void 0?0:Xn;return Be(Number.isFinite(An)&&Number.isFinite(Pn)&&Number.isFinite(dt)),ht(pt,[An,Pn,dt,1])}function nr(hn,pt){var Wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,An=(0,ce.Z)(hn,3),Pn=An[0],Xn=An[1],dt=An[2];if(Be(Number.isFinite(Pn)&&Number.isFinite(Xn),"invalid pixel coordinate"),Number.isFinite(dt)){var be=ht(pt,[Pn,Xn,dt,1]);return be}var Ne=ht(pt,[Pn,Xn,0,1]),ot=ht(pt,[Pn,Xn,1,1]),Pt=Ne[2],It=ot[2],xn=Pt===It?0:((Wt||0)-Pt)/(It-Pt);return gt.t7([],Ne,ot,xn)}var Ht=xt(),Jt=function(){function hn(){var pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Wt=pt.width,An=pt.height,Pn=pt.viewMatrix,Xn=Pn===void 0?Ht:Pn,dt=pt.projectionMatrix,be=dt===void 0?Ht:dt;(0,ze.Z)(this,hn),this.width=Wt||1,this.height=An||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=Xn,this.projectionMatrix=be;var Ne=xt();fe.multiply(Ne,Ne,this.projectionMatrix),fe.multiply(Ne,Ne,this.viewMatrix),this.viewProjectionMatrix=Ne;var ot=xt();fe.scale(ot,ot,[this.width/2,-this.height/2,1]),fe.translate(ot,ot,[1,-1,0]),fe.multiply(ot,ot,this.viewProjectionMatrix);var Pt=fe.invert(xt(),ot);if(!Pt)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=ot,this.pixelUnprojectionMatrix=Pt,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,te.Z)(hn,[{key:"equals",value:function(Wt){return Wt instanceof hn?Wt.width===this.width&&Wt.height===this.height&&fe.equals(Wt.projectionMatrix,this.projectionMatrix)&&fe.equals(Wt.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(Wt){var An=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Pn=An.topLeft,Xn=Pn===void 0?!0:Pn,dt=this.projectPosition(Wt),be=$n(dt,this.pixelProjectionMatrix),Ne=(0,ce.Z)(be,2),ot=Ne[0],Pt=Ne[1],It=Xn?Pt:this.height-Pt;return Wt.length===2?[ot,It]:[ot,It,be[2]]}},{key:"unproject",value:function(Wt){var An=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Pn=An.topLeft,Xn=Pn===void 0?!0:Pn,dt=An.targetZ,be=(0,ce.Z)(Wt,3),Ne=be[0],ot=be[1],Pt=be[2],It=Xn?ot:this.height-ot,xn=dt&&dt*this.pixelsPerMeter,Qn=nr([Ne,It,Pt],this.pixelUnprojectionMatrix,xn),br=this.unprojectPosition(Qn),Jn=(0,ce.Z)(br,3),Ae=Jn[0],xe=Jn[1],ke=Jn[2];return Number.isFinite(Pt)?[Ae,xe,ke]:Number.isFinite(dt)?[Ae,xe,dt]:[Ae,xe]}},{key:"projectPosition",value:function(Wt){var An=this.projectFlat(Wt),Pn=(0,ce.Z)(An,2),Xn=Pn[0],dt=Pn[1],be=(Wt[2]||0)*this.pixelsPerMeter;return[Xn,dt,be]}},{key:"unprojectPosition",value:function(Wt){var An=this.unprojectFlat(Wt),Pn=(0,ce.Z)(An,2),Xn=Pn[0],dt=Pn[1],be=(Wt[2]||0)/this.pixelsPerMeter;return[Xn,dt,be]}},{key:"projectFlat",value:function(Wt){var An=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Wt}},{key:"unprojectFlat",value:function(Wt){var An=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Wt}}]),hn}();function _n(hn){var pt=hn.width,Wt=hn.height,An=hn.bounds,Pn=hn.minExtent,Xn=Pn===void 0?0:Pn,dt=hn.maxZoom,be=dt===void 0?24:dt,Ne=hn.padding,ot=Ne===void 0?0:Ne,Pt=hn.offset,It=Pt===void 0?[0,0]:Pt,xn=(0,ce.Z)(An,2),Qn=(0,ce.Z)(xn[0],2),br=Qn[0],Jn=Qn[1],Ae=(0,ce.Z)(xn[1],2),xe=Ae[0],ke=Ae[1];if(Number.isFinite(ot)){var tt=ot;ot={top:tt,bottom:tt,left:tt,right:tt}}else Be(Number.isFinite(ot.top)&&Number.isFinite(ot.bottom)&&Number.isFinite(ot.left)&&Number.isFinite(ot.right));var Et=new tr({width:pt,height:Wt,longitude:0,latitude:0,zoom:0}),tn=Et.project([br,ke]),fn=Et.project([xe,Jn]),_t=[Math.max(Math.abs(fn[0]-tn[0]),Xn),Math.max(Math.abs(fn[1]-tn[1]),Xn)],en=[pt-ot.left-ot.right-Math.abs(It[0])*2,Wt-ot.top-ot.bottom-Math.abs(It[1])*2];Be(en[0]>0&&en[1]>0);var Gn=en[0]/_t[0],Tr=en[1]/_t[1],jr=(ot.right-ot.left)/2/Gn,vr=(ot.bottom-ot.top)/2/Tr,Ur=[(fn[0]+tn[0])/2+jr,(fn[1]+tn[1])/2+vr],Fr=Et.unproject(Ur),qr=Et.zoom+Math.log2(Math.abs(Math.min(Gn,Tr)));return{longitude:Fr[0],latitude:Fr[1],zoom:Math.min(qr,be)}}var tr=function(hn){(0,Se.Z)(pt,hn);function pt(){var Wt,An=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Pn=An.width,Xn=An.height,dt=An.latitude,be=dt===void 0?0:dt,Ne=An.longitude,ot=Ne===void 0?0:Ne,Pt=An.zoom,It=Pt===void 0?0:Pt,xn=An.pitch,Qn=xn===void 0?0:xn,br=An.bearing,Jn=br===void 0?0:br,Ae=An.altitude,xe=Ae===void 0?1.5:Ae,ke=An.nearZMultiplier,tt=An.farZMultiplier;(0,ze.Z)(this,pt),Pn=Pn||1,Xn=Xn||1;var Et=Oe(It);xe=Math.max(.75,xe);var tn=Qe([ot,be],Et);tn[2]=0;var fn=Fn({width:Pn,height:Xn,pitch:Qn,bearing:Jn,altitude:xe,nearZMultiplier:ke||1/Xn,farZMultiplier:tt||1.01}),_t=Xt({height:Xn,center:tn,pitch:Qn,bearing:Jn,altitude:xe,flipY:!0});return Wt=(0,ye.Z)(this,(0,De.Z)(pt).call(this,{width:Pn,height:Xn,viewMatrix:_t,projectionMatrix:fn})),Wt.latitude=be,Wt.longitude=ot,Wt.zoom=It,Wt.pitch=Qn,Wt.bearing=Jn,Wt.altitude=xe,Wt.scale=Et,Wt.center=tn,Wt.pixelsPerMeter=vt((0,we.Z)((0,we.Z)(Wt))).pixelsPerMeter[2],Object.freeze((0,we.Z)((0,we.Z)(Wt))),Wt}return(0,te.Z)(pt,[{key:"projectFlat",value:function(An){var Pn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Qe(An,Pn)}},{key:"unprojectFlat",value:function(An){var Pn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return $e(An,Pn)}},{key:"getMapCenterByLngLatPosition",value:function(An){var Pn=An.lngLat,Xn=An.pos,dt=nr(Xn,this.pixelUnprojectionMatrix),be=Qe(Pn,this.scale),Ne=gt.IH([],be,gt.tk([],dt)),ot=gt.IH([],this.center,Ne);return $e(ot,this.scale)}},{key:"getLocationAtPoint",value:function(An){var Pn=An.lngLat,Xn=An.pos;return this.getMapCenterByLngLatPosition({lngLat:Pn,pos:Xn})}},{key:"fitBounds",value:function(An){var Pn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Xn=this.width,dt=this.height,be=_n(Object.assign({width:Xn,height:dt,bounds:An},Pn)),Ne=be.longitude,ot=be.latitude,Pt=be.zoom;return new pt({width:Xn,height:dt,longitude:Ne,latitude:ot,zoom:Pt})}}]),pt}(Jt);class an{constructor(){(0,X.Z)(this,"viewport",new tr)}syncWithMapCamera(pt){const{center:Wt,zoom:An,pitch:Pn,bearing:Xn,viewportHeight:dt,viewportWidth:be}=pt,Ne={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new tr((0,ee.Z)((0,ee.Z)({},Ne),{},{width:be,height:dt,longitude:Wt&&Wt[0],latitude:Wt&&Wt[1],zoom:An,pitch:Pn,bearing:Xn}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(pt,Wt){return this.viewport.projectFlat(pt,Wt)}}var Ut=D(39827),Dt=D(8543),Ie=D(26729);class qe{constructor(pt){(0,X.Z)(this,"size",1e4),this.size=pt||1e4}setSize(pt){this.size=pt}getSize(){return[this.size,this.size]}mercatorXfromLng(pt){return(180+pt)/360*this.size}mercatorYfromLat(pt){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+pt*Math.PI/360)))/360)*this.size}lngFromMercatorX(pt){return pt/this.size*360-180}latFromMercatorY(pt){const Wt=180-(1-pt/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(Wt*Math.PI/180))-90}project(pt){const Wt=this.mercatorXfromLng(pt[0]),An=this.mercatorYfromLat(pt[1]);return[Wt,An]}unproject(pt){const Wt=this.lngFromMercatorX(pt[0]),An=this.latFromMercatorY(pt[1]);return[Wt,An]}}const Bt={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},j={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},le=12;class z{constructor(pt){(0,X.Z)(this,"version","DEFAUlTMAP"),(0,X.Z)(this,"map",void 0),(0,X.Z)(this,"simpleMapCoord",new qe),(0,X.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,X.Z)(this,"config",void 0),(0,X.Z)(this,"configService",void 0),(0,X.Z)(this,"coordinateSystemService",void 0),(0,X.Z)(this,"eventEmitter",void 0),(0,X.Z)(this,"markerContainer",void 0),(0,X.Z)(this,"cameraChangedCallback",void 0),(0,X.Z)(this,"$mapContainer",void 0),(0,X.Z)(this,"handleCameraChanged",Wt=>{const{lat:An,lng:Pn}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[Pn,An],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=pt.mapConfig,this.configService=pt.globalConfigService,this.coordinateSystemService=pt.coordinateSystemService,this.eventEmitter=new Ie.EventEmitter}setBgColor(pt){this.bgColor=pt}addMarkerContainer(){const pt=this.map.getCanvasContainer();this.markerContainer=Dt.SO.create("div","l7-marker-container",pt),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(pt,Wt){Ut.I9.indexOf(pt)!==-1?this.eventEmitter.on(pt,Wt):this.map.on(j[pt]||pt,Wt)}off(pt,Wt){this.map.off(j[pt]||pt,Wt),this.eventEmitter.off(pt,Wt)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();const pt=this.map.transform;return[pt.width,pt.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(pt){return this.map.setZoom(pt)}getCenter(){return this.map.getCenter()}setCenter(pt){this.map.setCenter(pt)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(pt){this.map.setBearing(pt)}zoomIn(pt,Wt){this.map.zoomIn(pt,Wt)}zoomOut(pt,Wt){this.map.zoomOut(pt,Wt)}setPitch(pt){return this.map.setPitch(pt)}panTo(pt){this.map.panTo(pt)}panBy(pt=0,Wt=0){this.map.panBy([pt,Wt])}fitBounds(pt,Wt){this.map.fitBounds(pt,Wt)}setMaxZoom(pt){this.map.setMaxZoom(pt)}setMinZoom(pt){this.map.setMinZoom(pt)}setMapStatus(pt){pt.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),pt.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),pt.dragEnable===!1&&this.map.dragPan.disable(),pt.dragEnable===!0&&this.map.dragPan.enable(),pt.rotateEnable===!1&&this.map.dragRotate.disable(),pt.dragEnable===!0&&this.map.dragRotate.enable(),pt.keyboardEnable===!1&&this.map.keyboard.disable(),pt.keyboardEnable===!0&&this.map.keyboard.enable(),pt.zoomEnable===!1&&this.map.scrollZoom.disable(),pt.zoomEnable===!0&&this.map.scrollZoom.enable()}setZoomAndCenter(pt,Wt){this.map.flyTo({zoom:pt,center:Wt})}setMapStyle(pt){var Wt;(Wt=this.map)===null||Wt===void 0||Wt.setStyle(this.getMapStyleValue(pt))}meterToCoord(pt,Wt){return 1}pixelToLngLat(pt){return this.map.unproject(pt)}lngLatToPixel(pt){return this.map.project(pt)}containerToLngLat(pt){return this.map.unproject(pt)}lngLatToContainer(pt){return this.map.project(pt)}getMapStyle(){try{var pt;const Wt=(pt=this.map.getStyle().sprite)!==null&&pt!==void 0?pt:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(Wt)?Wt==null?void 0:Wt.replace(/\/\w+$/,"").replace(/sprites/,"styles"):Wt}catch(Wt){return""}}getMapStyleConfig(){return Bt}getMapStyleValue(pt){var Wt;return(Wt=this.getMapStyleConfig()[pt])!==null&&Wt!==void 0?Wt:pt}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(pt,...Wt){this.eventEmitter.emit(pt,...Wt)}once(pt,...Wt){this.eventEmitter.once(pt,...Wt)}getMapContainer(){return this.$mapContainer}exportMap(pt){var Wt;const An=(Wt=this.map)===null||Wt===void 0?void 0:Wt.getCanvas();return pt==="jpg"?An==null?void 0:An.toDataURL("image/jpeg"):An==null?void 0:An.toDataURL("image/png")}onCameraChanged(pt){this.cameraChangedCallback=pt}creatMapContainer(pt){let Wt=pt;return typeof pt=="string"&&(Wt=document.getElementById(pt)),Wt}updateView(pt){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:pt.bearing,center:pt.center,viewportHeight:pt.viewportHeight,pitch:pt.pitch,viewportWidth:pt.viewportWidth,zoom:pt.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:pt=!0}=this.config;this.viewport.getZoom()>le&&pt?this.coordinateSystemService.setCoordinateSystem(Ut.lo.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Ut.lo.LNGLAT)}}const de=["id","attributionControl","style","token","rotation","mapInstance"];function Zt(hn,pt){var Wt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,An=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(Wt||An)&&(pt||(pt=document),!!pt)){var Pn=pt.head||pt.getElementsByTagName("head")[0];if(!Pn){Pn=pt.createElement("head");var Xn=pt.body||pt.getElementsByTagName("body")[0];Xn?Xn.parentNode.insertBefore(Pn,Xn):pt.documentElement.appendChild(Pn)}var dt=pt.createElement("style");return dt.type="text/css",dt.styleSheet?dt.styleSheet.cssText=hn:dt.appendChild(pt.createTextNode(hn)),Pn.appendChild(dt),dt}}Zt(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=oe();let nt=0;const St="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class In extends z{constructor(...pt){super(...pt),(0,X.Z)(this,"version","MAPBOX"),(0,X.Z)(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(pt,Wt={x:0,y:0,z:0}){const{x:An,y:Pn}=this.lngLatToMercator(pt,0);return[An-Wt.x,Pn-Wt.y]}lngLatToMercator(pt,Wt){const{x:An=0,y:Pn=0,z:Xn=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(pt,Wt);return{x:An,y:Pn,z:Xn}}getModelMatrix(pt,Wt,An,Pn=[1,1,1],Xn={x:0,y:0,z:0}){const dt=window.mapboxgl.MercatorCoordinate.fromLngLat(pt,Wt),be=dt.meterInMercatorCoordinateUnits(),Ne=fe.create();return fe.translate(Ne,Ne,ae.al(dt.x-Xn.x,dt.y-Xn.y,dt.z||0-Xn.z)),fe.scale(Ne,Ne,ae.al(be*Pn[0],-be*Pn[1],be*Pn[2])),fe.rotateX(Ne,Ne,An[0]),fe.rotateY(Ne,Ne,An[1]),fe.rotateZ(Ne,Ne,An[2]),Ne}init(){var pt=this;return(0,re.Z)(function*(){const Wt=pt.config,{id:An="map",attributionControl:Pn=!1,style:Xn="light",token:dt=St,rotation:be=0,mapInstance:Ne}=Wt,ot=(0,ve.Z)(Wt,de);pt.viewport=new an,!Ne&&!window.mapboxgl&&console.error(pt.configService.getSceneWarninfo("SDK")),dt===St&&Xn!=="blank"&&!window.mapboxgl.accessToken&&!Ne&&console.warn(pt.configService.getSceneWarninfo("MapToken")),!Ne&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=dt),Ne?(pt.map=Ne,pt.$mapContainer=pt.map.getContainer()):(pt.$mapContainer=pt.creatMapContainer(An),pt.map=new window.mapboxgl.Map((0,ee.Z)({container:pt.$mapContainer,style:pt.getMapStyleValue(Xn),attributionControl:Pn,bearing:be},ot))),pt.map.on("load",()=>{pt.handleCameraChanged()}),pt.map.on("move",pt.handleCameraChanged),pt.handleCameraChanged()})()}destroy(){var pt;(pt=this.$mapContainer)===null||pt===void 0||(pt=pt.parentNode)===null||pt===void 0||pt.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(pt,...Wt){this.eventEmitter.emit(pt,...Wt)}once(pt,...Wt){this.eventEmitter.once(pt,...Wt)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var pt;return(pt=this.getMapContainer())===null||pt===void 0?void 0:pt.querySelector(".mapboxgl-canvas-container")}meterToCoord(pt,Wt){const An=new(oe()).LngLat(pt[0],pt[1]),Pn=new(oe()).LngLat(Wt[0],Wt[1]),Xn=An.distanceTo(Pn),dt=oe().MercatorCoordinate.fromLngLat({lng:pt[0],lat:pt[1]}),be=oe().MercatorCoordinate.fromLngLat({lng:Wt[0],lat:Wt[1]}),{x:Ne,y:ot}=dt,{x:Pt,y:It}=be;return Math.sqrt(Math.pow(Ne-Pt,2)+Math.pow(ot-It,2))*4194304*2/Xn}exportMap(pt){const Wt=this.map.getCanvas();return pt==="jpg"?Wt==null?void 0:Wt.toDataURL("image/jpeg"):Wt==null?void 0:Wt.toDataURL("image/png")}creatMapContainer(pt){let Wt=pt;typeof pt=="string"&&(Wt=document.getElementById(pt));const An=document.createElement("div");return An.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,An.id="l7_mapbox_div"+nt++,Wt.appendChild(An),An}}function Wn(hn,pt){var Wt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,An=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(Wt||An)&&(pt||(pt=document),!!pt)){var Pn=pt.head||pt.getElementsByTagName("head")[0];if(!Pn){Pn=pt.createElement("head");var Xn=pt.body||pt.getElementsByTagName("body")[0];Xn?Xn.parentNode.insertBefore(Pn,Xn):pt.documentElement.appendChild(Pn)}var dt=pt.createElement("style");return dt.type="text/css",dt.styleSheet?dt.styleSheet.cssText=hn:dt.appendChild(pt.createTextNode(hn)),Pn.appendChild(dt),dt}}Wn(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class qn extends E{getServiceConstructor(){return In}}},4771:function(){},8543:function($t,W,D){"use strict";D.d(W,{SO:function(){return ee},z6:function(){return ol},a5:function(){return X},SA:function(){return E},nx:function(){return Jf},Z:function(){return Xf},rQ:function(){return He},bV:function(){return bn},zi:function(){return Rt},ds:function(){return eu},oO:function(){return Ic},SI:function(){return tu},Rx:function(){return mh},W0:function(){return $e},LS:function(){return pu},Z6:function(){return Ot},We:function(){return Dn},Co:function(){return At},Ks:function(){return fs},hj:function(){return Xt},Cl:function(){return vt},Oc:function(){return Fn},M4:function(){return Me},NJ:function(){return on},ks:function(){return ht},Ol:function(){return Uh},Yu:function(){return mt},ZB:function(){return nr},gJ:function(){return yt},z0:function(){return Ja},jG:function(){return xd},M8:function(){return yd},fg:function(){return ei},if:function(){return Ft},vP:function(){return so},lodashUtil:function(){return en},LF:function(){return ce},Fv:function(){return Yf},yA:function(){return Jc},CI:function(){return Qe}});var ee={};D.r(ee),D.d(ee,{DPR:function(){return Ct},addClass:function(){return wr},addStyle:function(){return sn},appendElementType:function(){return Vi},clearChildren:function(){return mr},create:function(){return Fr},css2Style:function(){return mn},empty:function(){return Ko},findParentElement:function(){return fo},getClass:function(){return Oi},getContainer:function(){return Tr},getDiffRect:function(){return wn},getStyleList:function(){return Ln},getViewPortScale:function(){return Ke},hasClass:function(){return di},printCanvas:function(){return Ye},remove:function(){return qr},removeClass:function(){return fi},removeStyle:function(){return zn},setChecked:function(){return gr},setClass:function(){return vi},setTransform:function(){return Co},setUnDraggable:function(){return ai},splitWords:function(){return vr},toggleClass:function(){return vo},triggerResize:function(){return Xo},trim:function(){return jr}});var X={};D.r(X),D.d(X,{getColumn:function(){return K},getSatByColumn:function(){return rr},max:function(){return qf},mean:function(){return _e},min:function(){return Qf},mode:function(){return et},statMap:function(){return dn},sum:function(){return ne}});var E={REGISTERED_PROTOCOLS:{}},ve=Object.defineProperty,re=Object.defineProperties,fe=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertySymbols,Ee=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,ze=(ue,Pe,ct)=>Pe in ue?ve(ue,Pe,{enumerable:!0,configurable:!0,writable:!0,value:ct}):ue[Pe]=ct,te=(ue,Pe)=>{for(var ct in Pe||(Pe={}))Ee.call(Pe,ct)&&ze(ue,ct,Pe[ct]);if(ae)for(var ct of ae(Pe))oe.call(Pe,ct)&&ze(ue,ct,Pe[ct]);return ue},ye=(ue,Pe)=>re(ue,fe(Pe)),De=ue=>E.REGISTERED_PROTOCOLS[ue.substring(0,ue.indexOf("://"))],Se=class extends Error{constructor(ue,Pe,ct,Sn){super(`AJAXError: ${Pe} (${ue}): ${ct}`),this.status=ue,this.statusText=Pe,this.url=ct,this.body=Sn}};function we(ue,Pe){const ct=new XMLHttpRequest,Sn=Array.isArray(ue.url)?ue.url[0]:ue.url;ct.open(ue.method||"GET",Sn,!0),ue.type==="arrayBuffer"&&(ct.responseType="arraybuffer");for(const cr in ue.headers)ue.headers.hasOwnProperty(cr)&&ct.setRequestHeader(cr,ue.headers[cr]);return ue.type==="json"&&(ct.responseType="text",ct.setRequestHeader("Accept","application/json")),ct.withCredentials=ue.credentials==="include",ct.onerror=()=>{Pe(new Error(ct.statusText))},ct.onload=()=>{if((ct.status>=200&&ct.status<300||ct.status===0)&&ct.response!==null){let cr=ct.response;if(ue.type==="json")try{cr=JSON.parse(ct.response)}catch(kr){return Pe(kr)}Pe(null,cr,ct.getResponseHeader("Cache-Control"),ct.getResponseHeader("Expires"),ct)}else{const cr=new Blob([ct.response],{type:ct.getResponseHeader("Content-Type")});Pe(new Se(ct.status,ct.statusText,Sn.toString(),cr))}},ct.cancel=ct.abort,ct.send(ue.body),ct}function ce(ue){return new Promise((Pe,ct)=>{we(ue,(Sn,cr,kr,gi,$i)=>{Sn?ct({err:Sn,data:null,xhr:$i}):Pe({err:null,data:cr,cacheControl:kr,expires:gi,xhr:$i})})})}function Ze(ue,Pe){return we(ue,Pe)}var xt=(ue,Pe)=>(De(ue.url)||Ze)(ye(te({},ue),{type:"json"}),Pe),ht=(ue,Pe)=>(De(ue.url)||Ze)(ye(te({},ue),{type:"arrayBuffer"}),Pe),Gt=(ue,Pe)=>Ze(ye(te({},ue),{method:"POST"}),Pe),mt=(ue,Pe)=>Ze(ye(te({},ue),{method:"GET"}),Pe);function gt(ue){const Pe=window.document.createElement("a");return Pe.href=ue,Pe.protocol===window.document.location.protocol&&Pe.host===window.document.location.host}var Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Re(ue,Pe){const ct=new window.Image,Sn=window.URL||window.webkitURL;ct.crossOrigin="anonymous",ct.onload=()=>{Pe(null,ct),Sn.revokeObjectURL(ct.src),ct.onload=null,window.requestAnimationFrame(()=>{ct.src=Be})},ct.onerror=()=>Pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const cr=new Blob([new Uint8Array(ue)],{type:"image/png"});ct.src=ue.byteLength?Sn.createObjectURL(cr):Be}function bt(ue,Pe){const ct=new Blob([new Uint8Array(ue)],{type:"image/png"});createImageBitmap(ct).then(Sn=>{Pe(null,Sn)}).catch(Sn=>{Pe(new Error(`Could not load image because of ${Sn.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var yt=(ue,Pe,ct)=>{const Sn=(cr,kr)=>{if(cr)Pe(cr);else if(kr){const gi=typeof createImageBitmap=="function",$i=ct?ct(kr):kr;gi?bt($i,Pe):Re($i,Pe)}};return ue.type==="json"?xt(ue,Sn):ht(ue,Sn)},At=(ue,Pe)=>{typeof createImageBitmap=="function"?bt(ue,Pe):Re(ue,Pe)},bn=(ue=>(ue.CENTER="center",ue.TOP="top",ue["TOP-LEFT"]="top-left",ue["TOP-RIGHT"]="top-right",ue.BOTTOM="bottom",ue["BOTTOM-LEFT"]="bottom-left",ue["BOTTOM-RIGHT"]="bottom-right",ue.LEFT="left",ue.RIGHT="right",ue))(bn||{}),He={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Rt(ue,Pe,ct){const Sn=ue.classList;for(const cr in He)He.hasOwnProperty(cr)&&Sn.remove(`l7-${ct}-anchor-${cr}`);Sn.add(`l7-${ct}-anchor-${Pe}`)}var Oe=D(37620);function it(ue){return typeof ue=="string"?!!d3.color(ue):!1}function Qe(ue){const Pe=Oe.ZP(ue),ct=[0,0,0,0];return Pe!=null&&(ct[0]=Pe.r/255,ct[1]=Pe.g/255,ct[2]=Pe.b/255,ct[3]=Pe.opacity),ct}function $e(ue){const Pe=ue&&ue[0],ct=ue&&ue[1],Sn=ue&&ue[2];return Pe+ct*256+Sn*65536-1}function Ot(ue){return[ue+1&255,ue+1>>8&255,ue+1>>8>>8&255]}function vt(ue){let Pe=window.document.createElement("canvas"),ct=Pe.getContext("2d");Pe.width=256,Pe.height=1;let Sn=null;const cr=ct.createLinearGradient(0,0,256,1),kr=ue.positions[0],gi=ue.positions[ue.positions.length-1];for(let $i=0;$i<ue.colors.length;++$i){const pa=(ue.positions[$i]-kr)/(gi-kr);cr.addColorStop(pa,ue.colors[$i])}return ct.fillStyle=cr,ct.fillRect(0,0,256,1),Sn=new Uint8ClampedArray(ct.getImageData(0,0,256,1).data),Pe=null,ct=null,{data:Sn,width:256,height:1}}function Me(ue,Pe){let ct=window.document.createElement("canvas"),Sn=ct.getContext("2d");ct.width=256,ct.height=1;const cr=Sn.createLinearGradient(0,0,256,1),kr=Pe[1]-Pe[0];for(let pa=0;pa<ue.colors.length;++pa){const Ea=Math.max((ue.positions[pa]-Pe[0])/kr,0);cr.addColorStop(Ea,ue.colors[pa])}Sn.fillStyle=cr,Sn.fillRect(0,0,256,1);const gi=Sn.getImageData(0,0,256,1).data,$i=$n(Sn,gi);return ct=null,Sn=null,$i}function Xt(ue){let Pe=window.document.createElement("canvas"),ct=Pe.getContext("2d");Pe.width=256,Pe.height=1;const Sn=ct.createImageData(256,1);return Sn.data.fill(0),ue.positions.forEach((cr,kr)=>{const gi=Qe(ue.colors[kr]);Sn.data[cr*4+0]=gi[0]*255,Sn.data[cr*4+1]=gi[1]*255,Sn.data[cr*4+2]=gi[2]*255,Sn.data[cr*4+3]=gi[3]*255}),Pe=null,ct=null,Sn}function on(ue){let Pe=window.document.createElement("canvas"),ct=Pe.getContext("2d");ct.globalAlpha=1,Pe.width=256,Pe.height=1;const Sn=256/ue.colors.length;for(let gi=0;gi<ue.colors.length;gi++)ct.beginPath(),ct.lineWidth=2,ct.strokeStyle=ue.colors[gi],ct.moveTo(gi*Sn,0),ct.lineTo((gi+1)*Sn,0),ct.stroke();const cr=ct.getImageData(0,0,256,1).data,kr=$n(ct,cr);return Pe=null,ct=null,kr}function Fn(ue,Pe){let ct=window.document.createElement("canvas"),Sn=ct.getContext("2d");Sn.globalAlpha=1,ct.width=256,ct.height=1;const cr=Pe[1]-Pe[0];ue.positions.length-ue.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(let $i=0;$i<ue.colors.length;$i++)Sn.beginPath(),Sn.lineWidth=2,Sn.strokeStyle=ue.colors[$i],Sn.moveTo((ue.positions[$i]-Pe[0])/cr*255,0),Sn.lineTo((ue.positions[$i+1]-Pe[0])/cr*255,0),Sn.stroke();const kr=Sn.getImageData(0,0,256,1).data,gi=$n(Sn,kr);return ct=null,Sn=null,gi}function $n(ue,Pe){const ct=ue.createImageData(256,1);for(let Sn=0;Sn<ct.data.length;Sn+=4)ct.data[Sn+0]=Pe[Sn+0],ct.data[Sn+1]=Pe[Sn+1],ct.data[Sn+2]=Pe[Sn+2],ct.data[Sn+3]=Pe[Sn+3];return ct}function nr(ue){switch(ue==null?void 0:ue.type){case"cat":return[0,255];default:return[0,1]}}var Ht=D(74691),Jt=D.n(Ht),_n=D(50361),tr=D.n(_n),an=D(23279),Ut=D.n(an),Dt=D(27361),Ie=D.n(Dt),qe=D(51584),Bt=D.n(qe),j=D(18446),le=D.n(j),z=D(14293),de=D.n(z),Zt=D(81763),nt=D.n(Zt),St=D(68630),In=D.n(St),Wn=D(47037),qn=D.n(Wn),hn=D(36719),pt=D.n(hn),Wt=D(82492),An=D.n(Wt),Pn=D(30236),Xn=D.n(Pn),dt=D(97019),be=D.n(dt),Ne=D(23493),ot=D.n(Ne),Pt=D(44908),It=D.n(Pt),xn=D(11700),Qn=D.n(xn),br=D(23560),Jn=D.n(br),Ae=D(13218),xe=D.n(Ae),ke=D(52353),tt=D.n(ke),Et=D(68929),tn=D.n(Et),fn=D(73955),_t=D.n(fn),en={isNil:de(),merge:An(),throttle:ot(),isString:qn(),debounce:Ut(),pull:be(),isTypedArray:pt(),isPlainObject:In(),isNumber:nt(),isBoolean:Bt(),isEqual:le(),cloneDeep:tr(),uniq:It(),clamp:Jt(),upperFirst:Qn(),get:Ie(),mergeWith:Xn(),isFunction:Jn(),isObject:xe(),isUndefined:tt(),camelCase:tn(),uniqueId:_t()},{pull:Gn}=en;function Tr(ue){let Pe=ue;return typeof ue=="string"&&(Pe=window.document.getElementById(ue)),Pe}function jr(ue){return ue.trim?ue.trim():ue.replace(/^\s+|\s+$/g,"")}function vr(ue){return jr(ue).split(/\s+/)}function Ur(ue){var Pe;const ct=(Pe=document==null?void 0:document.documentElement)==null?void 0:Pe.style;if(!ct)return ue[0];for(const Sn in ue)if(ue[Sn]&&ue[Sn]in ct)return ue[Sn];return ue[0]}function Fr(ue,Pe,ct){const Sn=window.document.createElement(ue);return Pe&&(Sn.className=Pe||""),ct&&ct.appendChild(Sn),Sn}function qr(ue){const Pe=ue.parentNode;Pe&&Pe.removeChild(ue)}function wr(ue,Pe){if(ue.classList!==void 0){const ct=vr(Pe);for(let Sn=0,cr=ct.length;Sn<cr;Sn++)ue.classList.add(ct[Sn])}else if(!di(ue,Pe)){const ct=Oi(ue);vi(ue,(ct?ct+" ":"")+Pe)}}function fi(ue,Pe){ue.classList!==void 0?vr(Pe).forEach(Sn=>{ue.classList.remove(Sn)}):vi(ue,jr((" "+Oi(ue)+" ").replace(" "+Pe+" "," ")))}function di(ue,Pe){if(ue.classList!==void 0)return ue.classList.contains(Pe);const ct=Oi(ue);return ct.length>0&&new RegExp("(^|\\s)"+Pe+"(\\s|$)").test(ct)}function vi(ue,Pe){ue instanceof HTMLElement?ue.className=Pe:ue.className.baseVal=Pe}function vo(ue,Pe,ct){ct===void 0?di(ue,Pe)?fi(ue,Pe):wr(ue,Pe):ct?wr(ue,Pe):fi(ue,Pe)}function Oi(ue){return ue instanceof SVGElement&&(ue=ue.correspondingElement),ue.className.baseVal===void 0?ue.className:ue.className.baseVal}function Ko(ue){for(;ue&&ue.firstChild;)ue.removeChild(ue.firstChild)}var va=Ur(["transform","WebkitTransform"]);function Co(ue,Pe){ue.style[va]=Pe}function Xo(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{const ue=window.document.createEvent("UIEvents");ue.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(ue)}}function Ye(ue){const Pe=["padding: "+(ue.height/2-8)+"px "+ue.width/2+"px;","line-height: "+ue.height+"px;","background-image: url("+ue.toDataURL()+");"];console.log(`%c
`,Pe.join(""))}function Ke(){var ue;const Pe=window.document.querySelector('meta[name="viewport"]');if(!Pe)return 1;const Sn=((ue=Pe.content)==null?void 0:ue.split(",")).find(cr=>{const[kr]=cr.split("=");return kr==="initial-scale"});return Sn?Sn.split("=")[1]*1:1}var Ct=Ke()<1?1:window.devicePixelRatio;function sn(ue,Pe){ue.setAttribute("style",`${ue.style.cssText}${Pe}`)}function Ln(ue){return ue.split(";").map(Pe=>Pe.trim()).filter(Pe=>Pe)}function zn(ue,Pe){var ct;const Sn=Ln((ct=ue.getAttribute("style"))!=null?ct:""),cr=Ln(Pe),kr=Gn(Sn,...cr);ue.setAttribute("style",kr.join(";"))}function mn(ue){return Object.entries(ue).map(([Pe,ct])=>`${Pe}: ${ct}`).join(";")}function wn(ue,Pe){return{left:ue.left-Pe.left,top:ue.top-Pe.top,right:Pe.left+Pe.width-ue.left-ue.width,bottom:Pe.top+Pe.height-ue.top-ue.height}}function gr(ue,Pe){ue.checked=Pe,Pe?ue.setAttribute("checked","true"):ue.removeAttribute("checked")}function mr(ue){ue.innerHTML=""}function ai(ue){ue.setAttribute("draggable","false")}function Vi(ue,Pe){if(typeof Pe=="string"){const ct=document.createElement("div");for(ct.innerHTML=Pe;ct.firstChild;)ue.append(ct.firstChild)}else Array.isArray(Pe)?ue.append(...Pe):ue.append(Pe)}function fo(ue,Pe){var ct;const Sn=Array.isArray(Pe)?Pe:[Pe];let cr=ue;for(;cr instanceof Element&&cr!==window.document.body;){if(Sn.find(kr=>cr==null?void 0:cr.matches(kr)))return cr;cr=(ct=cr==null?void 0:cr.parentElement)!=null?ct:null}}function ei(ue){return typeof ImageBitmap!="undefined"&&ue instanceof ImageBitmap}function zi(){return typeof importScripts=="function"}var Li=zi()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Zr=navigator==null?void 0:navigator.userAgent,go=!!Zr.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Mi=Zr.indexOf("Android")>-1||Zr.indexOf("Adr")>-1;function bo(){const ue=Zr,Pe=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let ct=!0;for(const Sn of Pe)if(ue.indexOf(Sn)>0){ct=!1;break}return ct}function Si(ue,Pe){ue.forEach(ct=>{Pe[ct]&&(Pe[ct]=Pe[ct].bind(Pe))})}var wo=class{constructor(ue=16){this.duration=16,this.timestamp=new Date().getTime(),this.duration=ue}run(ue){const Pe=new Date().getTime(),ct=Pe-this.timestamp;this.timestamp=Pe,ct>=this.duration&&ue()}},Yo=D(39034);function Wa(ue){var Pe=[1/0,1/0,-1/0,-1/0];return(0,Yo.pZ)(ue,function(ct){Pe[0]>ct[0]&&(Pe[0]=ct[0]),Pe[1]>ct[1]&&(Pe[1]=ct[1]),Pe[2]<ct[0]&&(Pe[2]=ct[0]),Pe[3]<ct[1]&&(Pe[3]=ct[1])}),Pe}Wa.default=Wa;var na=Wa,jo=D(1449);function Va(ue){return typeof ue=="number"}function fs(ue){return ue-Math.fround(ue)}var Tt=2*Math.PI*6378137/2;function Ft(ue,Pe){const[ct,Sn,cr,kr]=Pe;return ue.lng>ct&&ue.lng<=cr&&ue.lat>Sn&&ue.lat<=kr}function Dn(ue){const Pe=[1/0,1/0,-1/0,-1/0];return ue.forEach(ct=>{const{coordinates:Sn}=ct;sr(Pe,Sn)}),Pe}function sr(ue,Pe){return Array.isArray(Pe[0])?Pe.forEach(ct=>{sr(ue,ct)}):(ue[0]>Pe[0]&&(ue[0]=Pe[0]),ue[1]>Pe[1]&&(ue[1]=Pe[1]),ue[2]<Pe[0]&&(ue[2]=Pe[0]),ue[3]<Pe[1]&&(ue[3]=Pe[1])),ue}function _i(ue,Pe){return bi(ue,Pe)}function bi(ue,Pe){return Array.isArray(ue[0])?ue.map(ct=>bi(ct,Pe)):Pe(ue)}function so(ue,Pe=!0,ct={enable:!0,decimal:1}){ue=il(ue,Pe);const Sn=ue[0],cr=ue[1];let kr=Sn*Tt/180,gi=Math.log(Math.tan((90+cr)*Math.PI/360))/(Math.PI/180);return gi=gi*Tt/180,ct.enable&&(kr=Number(kr.toFixed(ct.decimal)),gi=Number(gi.toFixed(ct.decimal))),ue.length===3?[kr,gi,ue[2]]:[kr,gi]}function Ha(ue,Pe=6){const ct=ue[0],Sn=ue[1];let cr=ct/Tt*180,kr=Sn/Tt*180;return kr=180/Math.PI*(2*Math.atan(Math.exp(kr*Math.PI/180))-Math.PI/2),Pe!=null&&(cr=Number(cr.toFixed(Pe)),kr=Number(kr.toFixed(Pe))),ue.length===3?[cr,kr,ue[2]]:[cr,kr]}function Bs(ue){if(ue==null)throw new Error("lng is required");return(ue>180||ue<-180)&&(ue=ue%360,ue>180&&(ue=-360+ue),ue<-180&&(ue=360+ue),ue===0&&(ue=0)),ue}function Os(ue){if(ue==null)throw new Error("lat is required");return(ue>90||ue<-90)&&(ue=ue%180,ue>90&&(ue=-180+ue),ue<-90&&(ue=180+ue),ue===0&&(ue=0)),ue}function il(ue,Pe){if(Pe===!1)return ue;const ct=Bs(ue[0]);let Sn=Os(ue[1]);return Sn>85&&(Sn=85),Sn<-85&&(Sn=-85),ue.length===3?[ct,Sn,ue[2]]:[ct,Sn]}function Xf(ue){const Pe=85.0511287798,ct=Math.max(Math.min(Pe,ue[1]),-Pe),Sn=256<<20;let cr=Math.PI/180,kr=ue[0]*cr,gi=ct*cr;gi=Math.log(Math.tan(Math.PI/4+gi/2));const $i=.5/Math.PI,pa=.5,Ea=-.5/Math.PI;return cr=.5,kr=Sn*($i*kr+pa),gi=Sn*(Ea*gi+cr),[Math.floor(kr),Math.floor(gi)]}function zd(ue){const Pe=.5/Math.PI,ct=.5,Sn=-.5/Math.PI;let cr=.5;const kr=256<<20;let[gi,$i]=ue;gi=(gi/kr-ct)/Pe,$i=($i/kr-cr)/Sn,$i=(Math.atan(Math.pow(Math.E,$i))-Math.PI/4)*2,cr=Math.PI/180;const pa=$i/cr;return[gi/cr,pa]}function md(ue,Pe){const ct=85.0511287798,Sn=Math.PI/180,cr=6378137;return Pe=Math.max(Math.min(ct,Pe),-ct),ue*=Sn,Pe*=Sn,Pe=Math.log(Math.tan(Math.PI/4+Pe/2)),[ue*cr,Pe*cr]}function Dl(ue,Pe){const ct=Math.PI/180,Sn=6378137,cr=ue/Sn/ct,kr=2*(Math.atan(Math.exp(Pe/Sn))-Math.PI/4)/ct;return[cr,kr]}function Qc(ue,Pe,ct){const Sn=degreesToRadians(Pe[1]-ue[1]),cr=degreesToRadians(Pe[0]-ue[0]),kr=degreesToRadians(ue[1]),gi=degreesToRadians(Pe[1]),$i=Math.pow(Math.sin(Sn/2),2)+Math.pow(Math.sin(cr/2),2)*Math.cos(kr)*Math.cos(gi);return radiansToLength(2*Math.atan2(Math.sqrt($i),Math.sqrt(1-$i)),ct="meters")}function Mf(ue){const Pe=Math.PI/180,ct=85.0511287798,Sn=6378137,cr=Math.max(Math.min(ct,ue[1]),-ct),kr=Math.sin(cr*Pe),gi=Sn*ue[0]*Pe,$i=Sn*Math.log((1+kr)/(1-kr))/2;return[gi,$i]}function Jc(ue,Pe){const ct=Math.abs(ue[1][1]-ue[0][1])*Pe,Sn=Math.abs(ue[1][0]-ue[0][0])*Pe;return[[ue[0][0]-Sn,ue[0][1]-ct],[ue[1][0]+Sn,ue[1][1]+ct]]}function Ic(ue,Pe){return ue[0][0]<=Pe[0][0]&&ue[0][1]<=Pe[0][1]&&ue[1][0]>=Pe[1][0]&&ue[1][1]>=Pe[1][1]}function eu(ue){return[[ue[0],ue[1]],[ue[2],ue[3]]]}function Yf(ue){const Pe=ac(ue,[0,0]);return[ue[0]/Pe,ue[1]/Pe]}function ac(ue,Pe){return Math.sqrt(Math.pow(ue[0]-Pe[0],2)+Math.pow(ue[1]-Pe[1],2))}function Xs(ue,Pe){return ue[0]*Pe[0]+ue[1]*Pe[1]}function Ru(ue){return Math.sqrt(ue[0]*ue[0]+ue[1]*ue[1])}function gf(ue,Pe){return Math.acos(Xs(ue,Pe)/(Ru(ue)*Ru(Pe)))*180/Math.PI}function kh(ue,Pe){return Pe[0]>0?Pe[1]>0?90-Math.atan(Pe[1]/Pe[0])*180/Math.PI:90+Math.atan(-Pe[1]/Pe[0])*180/Math.PI:Pe[1]<0?180+(90-Math.atan(Pe[1]/Pe[0])*180/Math.PI):270+Math.atan(Pe[1]/-Pe[0])*180/Math.PI}function zh(ue,Pe=100){if(!ue||ue.length<2)return;const ct=[0,1];let Sn=0;const cr=[];for(let kr=0;kr<ue.length-1;kr++){const gi=ue[kr],$i=ue[kr+1],pa=ac(gi,$i);Sn+=pa;const Ea=[gi[0]-$i[0],gi[1]-$i[1]];let _s=kh(ct,Ea);if(kr>0){const za=cr[kr-1].rotation;za-_s>360-za+_s&&(_s=_s+360)}cr.push({start:gi,end:$i,dis:pa,rotation:_s,duration:0})}return cr.map(kr=>{kr.duration=Pe*(kr.dis/Sn)}),cr}function tu(ue){if(Va(ue[0]))return ue;if(Va(ue[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Va(ue[0][0][0])){const Pe=ue;let ct=0,Sn=0,cr=0;return Pe.forEach(kr=>{kr.forEach(gi=>{ct+=gi[0],Sn+=gi[1],cr++})}),[ct/cr,Sn/cr,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function mh(ue){let Pe=ue[0],ct=ue[1],Sn=ue[0],cr=ue[1],kr=0,gi=0,$i=0;for(let pa=0;pa<ue.length;pa+=2){const Ea=ue[pa],_s=ue[pa+1];Ea&&_s&&(Pe=Math.max(Ea,Pe),ct=Math.max(_s,ct),Sn=Math.min(Ea,Sn),cr=Math.min(_s,cr),kr+=Ea,gi+=_s,$i++)}return{center:[kr/$i,gi/$i],radius:Math.sqrt(Math.pow(Pe-Sn,2)+Math.pow(ct-cr,2))/2}}function Uh(ue){return na((0,jo.uf)([(0,jo.Tu)(ue)]))}function vd(ue){let Sn=0;ue+="x";const cr=Math.floor(9007199254740991/137);for(let kr=0;kr<ue.length;kr++)Sn>cr&&(Sn=Math.floor(Sn/137)),Sn=Sn*131+ue.charCodeAt(kr);return Sn}function gd(ue){ue=ue.toString();let Pe=5381,ct=ue.length;for(;ct;)Pe=Pe*33^ue.charCodeAt(--ct);return Pe>>>0}function yd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,ue=>{const Pe=Math.random()*16|0;return(ue==="x"?Pe:Pe&3|8).toString(16)})}function vp(ue,Pe,ct,Sn,cr=30,kr){let gi=ct;return kr&&(gi=Math.round(ct*(cr-1))/(cr-1)),Sn?Nl(ue,Pe,gi,Sn):Nl(ue,Pe,gi,.314)}function $f(ue,Pe){const ct=1-Pe;return(ue[0]*ct+ue[1]*Pe)*ct+(ue[1]*ct+ue[2]*Pe)*Pe}function Mu(ue,Pe){return Math.sqrt(Math.pow(ue[0]-Pe[0],2)+Math.pow(ue[1]-Pe[1],2))}function _d(ue,Pe,ct){const Sn=[Pe[0]-ue[0],Pe[1]-ue[1]],cr=Mu(Sn,[0,0]),kr=Math.atan2(Sn[1],Sn[0]),gi=cr/2/Math.cos(ct),$i=kr+ct;return[gi*Math.cos($i)+ue[0],gi*Math.sin($i)+ue[1]]}function Nl(ue,Pe,ct,Sn){const cr=_d(ue,Pe,Sn),kr=[ue[0],cr[0],Pe[0]],gi=[ue[1],cr[1],Pe[1]];return[$f(kr,ct),$f(gi,ct),0]}function Is(ue,Pe,ct,Sn,cr=30,kr){let gi=ct;return kr&&(gi=Math.round(ct*29)/29),sc(ue,Pe,gi)}function nu(ue,Pe){const ct=[ue[0]-Pe[0],ue[1]-Pe[1]],Sn=[Math.sin(ct[0]/2),Math.sin(ct[1]/2)],cr=Sn[1]*Sn[1]+Math.cos(ue[1])*Math.cos(Pe[1])*Sn[0]*Sn[0];return 2*Math.atan2(Math.sqrt(cr),Math.sqrt(1-cr))}function sc(ue,Pe,ct){const Sn=[degreesToRadians(ue[0]),degreesToRadians(ue[1])],cr=[degreesToRadians(Pe[0]),degreesToRadians(Pe[1])],kr=nu(Sn,cr);if(Math.abs(kr-Math.PI)<.001)return[(1-ct)*Sn[0]+ct*cr[0],(1-ct)*Sn[1]+ct*cr[1]];const gi=Math.sin((1-ct)*kr)/Math.sin(kr),$i=Math.sin(ct*kr)/Math.sin(kr),pa=[Math.sin(Sn[0]),Math.sin(Sn[1])],Ea=[Math.cos(Sn[0]),Math.cos(Sn[1])],_s=[Math.sin(cr[0]),Math.sin(cr[1])],za=[Math.cos(cr[0]),Math.cos(cr[1])],ka=gi*Ea[1]*Ea[0]+$i*za[1]*za[0],cc=gi*Ea[1]*pa[0]+$i*za[1]*_s[0],Bu=gi*pa[1]+$i*_s[1];return[radiansToDegrees(Math.atan2(cc,ka)),radiansToDegrees(Math.atan2(Bu,Math.sqrt(ka*ka+cc*cc)))]}function of(ue,Pe){let ct=0;const Sn=[];for(let $i=0;$i<ue.length-1;$i++){const pa=ue[$i],Ea=ue[$i+1],_s=af(pa,Ea),za=ct;ct+=_s,Sn.push({p1:pa,p2:Ea,totalDistance:ct,distance:_s,lastTotalDistance:za})}const cr=ct*Pe;let kr,gi;for(const $i of Sn)if($i.totalDistance>cr){const Ea=$i.p1,_s=$i.p2,za=(cr-$i.lastTotalDistance)/$i.distance,ka=lc(_s,Ea,za);kr=ka[0],gi=ka[1];break}return{lng:kr,lat:gi,height:0}}function lc(ue,Pe,ct){return[ue[0]*ct+Pe[0]*(1-ct),ue[1]*ct+Pe[1]*(1-ct)]}function af(ue,Pe){return Math.sqrt(Math.pow(ue[0]-Pe[0],2)+Math.pow(ue[1]-Pe[1],2))}var Bl=Object.defineProperty,Pu=Object.getOwnPropertySymbols,yf=Object.prototype.hasOwnProperty,vh=Object.prototype.propertyIsEnumerable,Kf=(ue,Pe,ct)=>Pe in ue?Bl(ue,Pe,{enumerable:!0,configurable:!0,writable:!0,value:ct}):ue[Pe]=ct,ps=(ue,Pe)=>{for(var ct in Pe||(Pe={}))yf.call(Pe,ct)&&Kf(ue,ct,Pe[ct]);if(Pu)for(var ct of Pu(Pe))vh.call(Pe,ct)&&Kf(ue,ct,Pe[ct]);return ue};function jh(ue,Pe){const{featureId:ct}=Pe;let Sn=ue.data.dataArray;return typeof ct=="number"&&(Sn=Sn.filter(({id:cr})=>cr===ct)),Sn.map(cr=>{const kr=gh(cr,Pe);return ps(ps({},cr),kr)})}function Vh(ue,Pe){return new Promise(ct=>{ue.inited?ct(jh(ue,Pe)):ue.once("update",()=>{ct(jh(ue,Pe))})})}function gh(ue,Pe){const{offset:ct,shape:Sn,thetaOffset:cr,segmentNumber:kr=30,autoFit:gi=!0}=Pe,{coordinates:$i}=ue;if(Sn==="line")return pathLineAtOffset($i,ct);const pa=$i[0],Ea=$i[1],_s=typeof cr=="string"?ue[cr]||0:cr;let za;switch(Sn){case"arc":za=arcLineAtOffset;break;case"greatcircle":za=greatCircleLineAtOffset;break;default:za=arcLineAtOffset}const[ka,cc,Bu]=za(pa,Ea,ct,_s,kr,gi);return{lng:ka,lat:cc,height:Bu}}var ol=class{constructor(ue=50,Pe){this.limit=ue,this.destroy=Pe||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(ue=>{this.delete(ue)}),this.cache={},this.order=[]}get(ue){const Pe=this.cache[ue];return Pe&&(this.deleteOrder(ue),this.appendOrder(ue)),Pe}set(ue,Pe){this.cache[ue]?(this.delete(ue),this.cache[ue]=Pe,this.appendOrder(ue)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[ue]=Pe,this.appendOrder(ue))}delete(ue){const Pe=this.cache[ue];Pe&&(this.deleteCache(ue),this.deleteOrder(ue),this.destroy(Pe,ue))}deleteCache(ue){delete this.cache[ue]}deleteOrder(ue){const Pe=this.order.findIndex(ct=>ct===ue);Pe>=0&&this.order.splice(Pe,1)}appendOrder(ue){this.order.push(ue)}defaultDestroy(ue,Pe){return null}};function qf(ue){if(ue.length===0)throw new Error("max requires at least one data point");let Pe=ue[0];for(let ct=1;ct<ue.length;ct++)ue[ct]>Pe&&(Pe=ue[ct]);return Pe*1}function Qf(ue){if(ue.length===0)throw new Error("min requires at least one data point");let Pe=ue[0];for(let ct=1;ct<ue.length;ct++)ue[ct]<Pe&&(Pe=ue[ct]);return Pe*1}function ne(ue){if(ue.length===0)return 0;let Pe=ue[0]*1;for(let ct=1;ct<ue.length;ct++)Pe+=ue[ct]*1;return Pe}function _e(ue){if(ue.length===0)throw new Error("mean requires at least one data point");return ne(ue)/ue.length}function et(ue){if(ue.length===0)throw new Error("mean requires at least one data point");if(ue.length<3)return ue[0];ue.sort();let Pe=ue[0],ct=NaN,Sn=0,cr=1;for(let kr=1;kr<ue.length+1;kr++)ue[kr]!==Pe?(cr>Sn&&(Sn=cr,ct=Pe),cr=1,Pe=ue[kr]):cr++;return ct*1}var dn={min:Qf,max:qf,mean:_e,sum:ne,mode:et};function K(ue,Pe){return ue.map(ct=>ct[Pe])}function rr(ue,Pe){return dn[ue](Pe)}function Mr(ue,Pe){Pe===void 0&&(Pe={});var ct=Number(ue[0]),Sn=Number(ue[1]),cr=Number(ue[2]),kr=Number(ue[3]);if(ue.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var gi=[ct,Sn],$i=[ct,kr],pa=[cr,kr],Ea=[cr,Sn];return(0,jo.yu)([[gi,Ea,pa,$i,gi]],Pe.properties,{bbox:ue,id:Pe.id})}var ki=D(26729),ti=D.n(ki),uo=(ue=>(ue.Realtime="realtime",ue.Overlap="overlap",ue.Replace="replace",ue))(uo||{}),lo=(ue=>(ue.Loading="Loading",ue.Loaded="Loaded",ue.Failure="Failure",ue.Cancelled="Cancelled",ue))(lo||{}),ca=0,Io=1,xa=2;function Qa(ue){ue.forEach(Pe=>{Pe.isCurrent&&(Pe.isVisible=Pe.isLoaded)})}function aa(ue){ue.forEach(Pe=>{Pe.properties.state=ca}),ue.forEach(Pe=>{Pe.isCurrent&&!hs(Pe)&&Oa(Pe)}),ue.forEach(Pe=>{Pe.isVisible=!!(Pe.properties.state&xa)})}function ga(ue){ue.forEach(ct=>{ct.properties.state=ca}),ue.forEach(ct=>{ct.isCurrent&&hs(ct)}),ue.slice().sort((ct,Sn)=>ct.z-Sn.z).forEach(ct=>{ct.isVisible=!!(ct.properties.state&xa),ct.children.length&&(ct.isVisible||ct.properties.state&Io)?ct.children.forEach(Sn=>{Sn.properties.state=Io}):ct.isCurrent&&Oa(ct)})}function hs(ue){for(;ue;){if(ue.isLoaded)return ue.properties.state|=xa,!0;ue=ue.parent}return!1}function Oa(ue){ue.children.forEach(Pe=>{Pe.isLoaded?Pe.properties.state|=xa:Oa(Pe)})}var La=256,Fa=[-1/0,-1/0,1/0,1/0],Ks=.2,Fs=5,Ec={[uo.Realtime]:Qa,[uo.Overlap]:aa,[uo.Replace]:ga},is=()=>{};function Iu(ue,Pe,ct){const Sn=Math.floor((ue+180)/360*Math.pow(2,ct)),cr=Math.floor((1-Math.log(Math.tan(Pe*Math.PI/180)+1/Math.cos(Pe*Math.PI/180))/Math.PI)/2*Math.pow(2,ct));return[Sn,cr]}function du(ue,Pe,ct){const Sn=ue/Math.pow(2,ct)*360-180,cr=Math.PI-2*Math.PI*Pe/Math.pow(2,ct),kr=180/Math.PI*Math.atan(.5*(Math.exp(cr)-Math.exp(-cr)));return[Sn,kr]}var Lc=(ue,Pe,ct)=>{const[Sn,cr]=du(ue,Pe,ct),[kr,gi]=du(ue+1,Pe+1,ct);return[Sn,gi,kr,cr]};function Pf({zoom:ue,latLonBounds:Pe,maxZoom:ct=1/0,minZoom:Sn=0,zoomOffset:cr=0,extent:kr=Fa}){let gi=Math.ceil(ue)+cr;if(Number.isFinite(Sn)&&gi<Sn)return[];Number.isFinite(ct)&&gi>ct&&(gi=ct);const[$i,pa,Ea,_s]=Pe,za=[Math.max($i,kr[0]),Math.max(pa,kr[1]),Math.min(Ea,kr[2]),Math.min(_s,kr[3])],ka=[],[cc,Bu]=Iu(za[0],za[1],gi),[qs,ho]=Iu(za[2],za[3],gi);for(let ml=cc;ml<=qs;ml++)for(let os=ho;os<=Bu;os++)ka.push({x:ml,y:os,z:gi});const ru=(qs+cc)/2,Ed=(Bu+ho)/2,eh=(ml,os)=>Math.abs(ml-ru)+Math.abs(os-Ed);return ka.sort((ml,os)=>eh(ml.x,ml.y)-eh(os.x,os.y)),ka}var Hh=(ue,Pe,ct,Sn=!0)=>{const cr=Math.pow(2,ct),kr=cr-1,gi=cr;let $i=ue;const pa=Pe;return Sn&&($i<0?$i=$i+gi:$i>kr&&($i=$i%gi)),{warpX:$i,warpY:pa}},Zh=(ue,Pe,ct)=>new Promise((Sn,cr)=>{var kr=pa=>{try{$i(ct.next(pa))}catch(Ea){cr(Ea)}},gi=pa=>{try{$i(ct.throw(pa))}catch(Ea){cr(Ea)}},$i=pa=>pa.done?Sn(pa.value):Promise.resolve(pa.value).then(kr,gi);$i((ct=ct.apply(ue,Pe)).next())}),If=class extends ki.EventEmitter{constructor(ue){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:Pe,y:ct,z:Sn,tileSize:cr,warp:kr=!0}=ue;this.x=Pe,this.y=ct,this.z=Sn,this.warp=kr||!0,this.tileSize=cr}get isLoading(){return this.loadStatus===lo.Loading}get isLoaded(){return this.loadStatus===lo.Loaded}get isFailure(){return this.loadStatus===lo.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===lo.Cancelled}get isDone(){return[lo.Loaded,lo.Cancelled,lo.Failure].includes(this.loadStatus)}get bounds(){return Lc(this.x,this.y,this.z)}get bboxPolygon(){const[ue,Pe,ct,Sn]=this.bounds,cr=[(ct-ue)/2,(Sn-Pe)/2];return Mr(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:cr,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(ue){return Zh(this,arguments,function*({getData:Pe,onLoad:ct,onError:Sn}){this.loadDataId++;const cr=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=lo.Loading;let kr=null,gi;try{const{x:$i,y:pa,z:Ea,bounds:_s,tileSize:za,warp:ka}=this,{warpX:cc,warpY:Bu}=Hh($i,pa,Ea,ka),{signal:qs}=this.abortController;kr=yield Pe({x:cc,y:Bu,z:Ea,bounds:_s,tileSize:za,signal:qs,warp:ka},this)}catch($i){gi=$i}if(cr===this.loadDataId&&!(this.isCancelled&&!kr)){if(gi||!kr){this.loadStatus=lo.Failure,Sn(gi,this);return}this.loadStatus=lo.Loaded,this.data=kr,ct(this)}})}reloadData(ue){this.isLoading&&this.abortLoad(),this.loadData(ue)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=lo.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},Lu=(ue,Pe)=>{const ct=eu(ue),Sn=Jc(ct,Pe),cr=360*3-180,kr=85.0511287798065;return[Math.max(Sn[0][0],-cr),Math.max(Sn[0][1],-kr),Math.min(Sn[1][0],cr),Math.min(Sn[1][1],kr)]},Lf=(ue,Pe)=>{const ct=eu(ue),Sn=eu(Pe);return Ic(ct,Sn)},yh=Object.defineProperty,Du=Object.defineProperties,P0=Object.getOwnPropertyDescriptors,bd=Object.getOwnPropertySymbols,Dc=Object.prototype.hasOwnProperty,Wh=Object.prototype.propertyIsEnumerable,gp=(ue,Pe,ct)=>Pe in ue?yh(ue,Pe,{enumerable:!0,configurable:!0,writable:!0,value:ct}):ue[Pe]=ct,Gh=(ue,Pe)=>{for(var ct in Pe||(Pe={}))Dc.call(Pe,ct)&&gp(ue,ct,Pe[ct]);if(bd)for(var ct of bd(Pe))Wh.call(Pe,ct)&&gp(ue,ct,Pe[ct]);return ue},_h=(ue,Pe)=>Du(ue,P0(Pe)),{throttle:Nu}=en,Df=(ue=>(ue.TilesLoadStart="tiles-load-start",ue.TileLoaded="tile-loaded",ue.TileError="tile-error",ue.TileUnload="tile-unload",ue.TileUpdate="tile-update",ue.TilesLoadFinished="tiles-load-finished",ue))(Df||{}),Jf=class extends ti(){constructor(ue){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=Nu((Pe,ct)=>{this.update(Pe,ct)},16),this.onTileLoad=Pe=>{this.emit("tile-loaded",Pe),this.updateTileVisible(),this.loadFinished()},this.onTileError=(Pe,ct)=>{this.emit("tile-error",{error:Pe,tile:ct}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=Pe=>{this.emit("tile-unload",Pe),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Fa,getTileData:is,warp:!0,updateStrategy:uo.Replace},this.updateOptions(ue)}get isLoaded(){return this.currentTiles.every(ue=>ue.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((Pe,ct)=>Pe.z-ct.z)}updateOptions(ue){const Pe=ue.minZoom===void 0?this.options.minZoom:Math.ceil(ue.minZoom),ct=ue.maxZoom===void 0?this.options.maxZoom:Math.floor(ue.maxZoom);this.options=_h(Gh(Gh({},this.options),ue),{minZoom:Pe,maxZoom:ct})}update(ue,Pe){const ct=Math.max(0,Math.ceil(ue));if(this.lastViewStates&&this.lastViewStates.zoom===ct&&Lf(this.lastViewStates.latLonBoundsBuffer,Pe))return;const Sn=Lu(Pe,Ks);this.lastViewStates={zoom:ct,latLonBounds:Pe,latLonBoundsBuffer:Sn},this.currentZoom=ct;let cr=!1;const kr=this.getTileIndices(ct,Sn).filter(gi=>this.options.warp||gi.x>=0&&gi.x<Math.pow(2,ct));this.emit("tiles-load-start"),this.currentTiles=kr.map(({x:gi,y:$i,z:pa})=>{let Ea=this.getTile(gi,$i,pa);return Ea?(((Ea==null?void 0:Ea.isFailure)||(Ea==null?void 0:Ea.isCancelled))&&Ea.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),Ea):(Ea=this.createTile(gi,$i,pa),cr=!0,Ea)}),cr&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[ue,Pe]of this.cacheTiles){if(!this.currentTiles.includes(Pe)){this.cacheTiles.delete(ue),this.onTileUnload(Pe);return}this.onTileUnload(Pe),Pe.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(ue,Pe,ct){const Sn=this.cacheTiles.get(`${Pe},${ct},${ue}`);Sn&&(this.onTileUnload(Sn),Sn.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(ue,Pe,ct){const Sn=this.getTileByLngLat(ue,Pe,ct);Sn&&this.reloadTileById(Sn.z,Sn.x,Sn.y)}reloadTileByExtent(ue,Pe){this.getTileIndices(Pe,ue).forEach(Sn=>{this.reloadTileById(Sn.z,Sn.x,Sn.y)})}pruneRequests(){const ue=[];for(const Pe of this.cacheTiles.values())Pe.isLoading&&!Pe.isCurrent&&!Pe.isVisible&&ue.push(Pe);for(;ue.length>0;)ue.shift().abortLoad()}getTileByLngLat(ue,Pe,ct){const{zoomOffset:Sn}=this.options,cr=Math.ceil(ct)+Sn,kr=Iu(ue,Pe,cr);return this.tiles.filter($i=>$i.key===`${kr[0]}_${kr[1]}_${cr}`)[0]}getTileExtent(ue,Pe){return this.getTileIndices(Pe,ue)}getTileByZXY(ue,Pe,ct){return this.tiles.filter(cr=>cr.key===`${Pe}_${ct}_${ue}`)[0]}clear(){for(const ue of this.cacheTiles.values())ue.isLoading?ue.abortLoad():this.onTileUnload(ue);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const ue=this.options.updateStrategy,Pe=new Map;for(const cr of this.cacheTiles.values())Pe.set(cr.key,cr.isVisible),cr.isCurrent=!1,cr.isVisible=!1;for(const cr of this.currentTiles)cr.isCurrent=!0,cr.isVisible=!0;const ct=Array.from(this.cacheTiles.values());typeof ue=="function"?ue(ct):Ec[ue](ct);let Sn=!1;Array.from(this.cacheTiles.values()).forEach(cr=>{cr.isVisible!==Pe.get(cr.key)?(cr.isVisibleChange=!0,Sn=!0):cr.isVisibleChange=!1}),Sn&&this.emit("tile-update")}getTileIndices(ue,Pe){const{tileSize:ct,extent:Sn,zoomOffset:cr}=this.options,kr=Math.floor(this.options.maxZoom),gi=Math.ceil(this.options.minZoom);return Pf({maxZoom:kr,minZoom:gi,zoomOffset:cr,tileSize:ct,zoom:ue,latLonBounds:Pe,extent:Sn})}getTileId(ue,Pe,ct){return`${ue},${Pe},${ct}`}loadFinished(){const ue=!this.currentTiles.some(Pe=>!Pe.isDone);return ue&&this.emit("tiles-load-finished"),ue}getTile(ue,Pe,ct){const Sn=this.getTileId(ue,Pe,ct);return this.cacheTiles.get(Sn)}createTile(ue,Pe,ct){const Sn=this.getTileId(ue,Pe,ct),cr=new If({x:ue,y:Pe,z:ct,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(Sn,cr),cr.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),cr}resizeCacheTiles(){const ue=Fs*this.currentTiles.length;if(this.cacheTiles.size>ue){for(const[ct,Sn]of this.cacheTiles)if(!Sn.isVisible&&!this.currentTiles.includes(Sn)&&(this.cacheTiles.delete(ct),this.onTileUnload(Sn)),this.cacheTiles.size<=ue)break}this.rebuildTileTree()}rebuildTileTree(){for(const ue of this.cacheTiles.values())ue.parent=null,ue.children.length=0;for(const ue of this.cacheTiles.values()){const Pe=this.getNearestAncestor(ue.x,ue.y,ue.z);ue.parent=Pe,Pe!=null&&Pe.children&&Pe.children.push(ue)}}getNearestAncestor(ue,Pe,ct){for(;ct>this.options.minZoom;){ue=Math.floor(ue/2),Pe=Math.floor(Pe/2),ct=ct-1;const Sn=this.getTile(ue,Pe,ct);if(Sn)return Sn}return null}};function Yp(ue){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(ue)}function Nf(ue){const Pe=[];let ct=/\{([a-z])-([a-z])\}/.exec(ue);if(ct){const Sn=ct[1].charCodeAt(0),cr=ct[2].charCodeAt(0);let kr;for(kr=Sn;kr<=cr;++kr)Pe.push(ue.replace(ct[0],String.fromCharCode(kr)));return Pe}if(ct=/\{(\d+)-(\d+)\}/.exec(ue),ct){const Sn=parseInt(ct[2],10);for(let cr=parseInt(ct[1],10);cr<=Sn;cr++)Pe.push(ue.replace(ct[0],cr.toString()));return Pe}return Pe.push(ue),Pe}function Ja(ue,Pe){if(!ue||!ue.length)throw new Error("url is not allowed to be empty");const{x:ct,y:Sn,z:cr}=Pe,kr=Nf(ue),gi=Math.abs(ct+Sn)%kr.length;return(De(kr[gi])?`${kr[gi]}/{z}/{x}/{y}`:kr[gi]).replace(/\{x\}/g,ct.toString()).replace(/\{y\}/g,Sn.toString()).replace(/\{z\}/g,cr.toString()).replace(/\{bbox\}/g,Lc(ct,Sn,cr).join(",")).replace(/\{-y\}/g,(Math.pow(2,cr)-Sn-1).toString())}function xd(ue,Pe){const{x:ct,y:Sn,z:cr,layer:kr,version:gi="1.0.0",style:$i="default",format:pa,service:Ea="WMTS",tileMatrixset:_s}=Pe,za=Nf(ue),ka=Math.abs(ct+Sn)%za.length;return`${za[ka]}&SERVICE=${Ea}&REQUEST=GetTile&VERSION=${gi}&LAYER=${kr}&STYLE=${$i}&TILEMATRIXSET=${_s}&FORMAT=${pa}&TILECOL=${ct}&TILEROW=${Sn}&TILEMATRIX=${cr}`}function pu(ue,Pe){return ue==null?Pe:ue}},48271:function($t,W,D){"use strict";D.d(W,{oT:function(){return ua},Ie:function(){return Eb},dW:function(){return gg},GI:function(){return TE},xs:function(){return CS}});var ee={},X={},E=a=>X[a],ve=(a,o)=>{X[a]=o},re=a=>ee[a],fe=(a,o)=>{ee[a]=o},ae={},Ee={},oe=34,ze=10,te=13;function ye(a){return new Function("d","return {"+a.map(function(o,f){return JSON.stringify(o)+": d["+f+'] || ""'}).join(",")+"}")}function De(a,o){var f=ye(a);return function(v,T){return o(f(v),T,a)}}function Se(a){var o=Object.create(null),f=[];return a.forEach(function(v){for(var T in v)T in o||f.push(o[T]=T)}),f}function we(a,o){var f=a+"",v=f.length;return v<o?new Array(o-v+1).join(0)+f:f}function ce(a){return a<0?"-"+we(-a,6):a>9999?"+"+we(a,6):we(a,4)}function Ze(a){var o=a.getUTCHours(),f=a.getUTCMinutes(),v=a.getUTCSeconds(),T=a.getUTCMilliseconds();return isNaN(a)?"Invalid Date":ce(a.getUTCFullYear(),4)+"-"+we(a.getUTCMonth()+1,2)+"-"+we(a.getUTCDate(),2)+(T?"T"+we(o,2)+":"+we(f,2)+":"+we(v,2)+"."+we(T,3)+"Z":v?"T"+we(o,2)+":"+we(f,2)+":"+we(v,2)+"Z":f||o?"T"+we(o,2)+":"+we(f,2)+"Z":"")}function xt(a){var o=new RegExp('["'+a+`
\r]`),f=a.charCodeAt(0);function v(Te,Ve){var Mt,rn,Rn=T(Te,function(hr,Nr){if(Mt)return Mt(hr,Nr-1);rn=hr,Mt=Ve?De(hr,Ve):ye(hr)});return Rn.columns=rn||[],Rn}function T(Te,Ve){var Mt=[],rn=Te.length,Rn=0,hr=0,Nr,jn=rn<=0,ci=!1;Te.charCodeAt(rn-1)===ze&&--rn,Te.charCodeAt(rn-1)===te&&--rn;function ji(){if(jn)return Ee;if(ci)return ci=!1,ae;var Ji,Hr=Rn,Gi;if(Te.charCodeAt(Hr)===oe){for(;Rn++<rn&&Te.charCodeAt(Rn)!==oe||Te.charCodeAt(++Rn)===oe;);return(Ji=Rn)>=rn?jn=!0:(Gi=Te.charCodeAt(Rn++))===ze?ci=!0:Gi===te&&(ci=!0,Te.charCodeAt(Rn)===ze&&++Rn),Te.slice(Hr+1,Ji-1).replace(/""/g,'"')}for(;Rn<rn;){if((Gi=Te.charCodeAt(Ji=Rn++))===ze)ci=!0;else if(Gi===te)ci=!0,Te.charCodeAt(Rn)===ze&&++Rn;else if(Gi!==f)continue;return Te.slice(Hr,Ji)}return jn=!0,Te.slice(Hr,rn)}for(;(Nr=ji())!==Ee;){for(var To=[];Nr!==ae&&Nr!==Ee;)To.push(Nr),Nr=ji();Ve&&(To=Ve(To,hr++))==null||Mt.push(To)}return Mt}function O(Te,Ve){return Te.map(function(Mt){return Ve.map(function(rn){return ge(Mt[rn])}).join(a)})}function L(Te,Ve){return Ve==null&&(Ve=Se(Te)),[Ve.map(ge).join(a)].concat(O(Te,Ve)).join(`
`)}function F(Te,Ve){return Ve==null&&(Ve=Se(Te)),O(Te,Ve).join(`
`)}function H(Te){return Te.map(ie).join(`
`)}function ie(Te){return Te.map(ge).join(a)}function ge(Te){return Te==null?"":Te instanceof Date?Ze(Te):o.test(Te+="")?'"'+Te.replace(/"/g,'""')+'"':Te}return{parse:v,parseRows:T,format:L,formatBody:F,formatRows:H,formatRow:ie,formatValue:ge}}var ht=xt(","),Gt=ht.parse,mt=ht.parseRows,gt=ht.format,Be=ht.formatBody,Re=ht.formatRows,bt=ht.formatRow,yt=ht.formatValue,At=D(1449);function bn(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function He(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Rt(a){if(a.length>1&&isNumber(a[0])&&isNumber(a[1]))return!0;if(Array.isArray(a[0])&&a[0].length)return Rt(a[0]);throw new Error("coordinates must only contain numbers")}function Oe(a,o,f){if(!o||!f)throw new Error("type and name required");if(!a||a.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+a.type)}function it(a,o,f){if(!a)throw new Error("No feature passed");if(!f)throw new Error(".featureOf() requires a name");if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+f+", Feature with geometry required");if(!a.geometry||a.geometry.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+a.geometry.type)}function Qe(a,o,f){if(!a)throw new Error("No featureCollection passed");if(!f)throw new Error(".collectionOf() requires a name");if(!a||a.type!=="FeatureCollection")throw new Error("Invalid input to "+f+", FeatureCollection required");for(var v=0,T=a.features;v<T.length;v++){var O=T[v];if(!O||O.type!=="Feature"||!O.geometry)throw new Error("Invalid input to "+f+", Feature with geometry required");if(!O.geometry||O.geometry.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+O.geometry.type)}}function $e(a){return a.type==="Feature"?a.geometry:a}function Ot(a,o){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}var vt=D(39034),Me=D(8543),Xt=D(38163),on=D.n(Xt);function Fn(a,o){return a.map(f=>f[o]*1)}function $n(a){return a===void 0?!1:!Array.isArray(a)&&a.data!==void 0}function nr(a){return Array.isArray(a)?a.length===0?!1:!!$n(a[0]):!1}function Ht(a){return Array.isArray(a)?a.length===0||typeof a[0]=="number":!1}function Jt(a){const o=Object.isFrozen(a)?Me.lodashUtil.cloneDeep(a):a;return on()(o,!0),o}function _n(a,o){return a||[[o[0],o[3]],[o[2],o[3]],[o[2],o[1]],[o[0],o[1]]]}var tr=Object.defineProperty,an=Object.defineProperties,Ut=Object.getOwnPropertyDescriptors,Dt=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable,Bt=(a,o,f)=>o in a?tr(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,j=(a,o)=>{for(var f in o||(o={}))Ie.call(o,f)&&Bt(a,f,o[f]);if(Dt)for(var f of Dt(o))qe.call(o,f)&&Bt(a,f,o[f]);return a},le=(a,o)=>an(a,Ut(o));function z(a,o){const{x:f,y:v,x1:T,y1:O,coordinates:L,geometry:F}=o,H=[];if(!Array.isArray(a))return{dataArray:[]};if(F)return a.filter(ie=>ie[F]&&ie[F].type&&ie[F].coordinates&&ie[F].coordinates.length>0).forEach((ie,ge)=>{const Te=Jt(ie[F]);(0,vt.nG)(Te,Ve=>{const Mt=He(Ve),rn=le(j({},ie),{_id:ge,coordinates:Mt});H.push(rn)})}),{dataArray:H};for(let ie=0;ie<a.length;ie++){const ge=a[ie];let Te=[];if(L){let Mt="Polygon";Array.isArray(L[0])||(Mt="Point"),Array.isArray(L[0])&&!Array.isArray(L[0][0])&&(Mt="LineString"),Te=Jt({type:Mt,coordinates:ge[L]}).coordinates}else if(f&&v&&T&&O){const Mt=[parseFloat(ge[f]),parseFloat(ge[v])],rn=[parseFloat(ge[T]),parseFloat(ge[O])];Te=[Mt,rn]}else f&&v&&(Te=[parseFloat(ge[f]),parseFloat(ge[v])]);const Ve=le(j({},ge),{_id:ie,coordinates:Te});H.push(Ve)}return{dataArray:H}}function de(a,o){const f=Gt(a);return z(f,o)}var Zt=Object.defineProperty,nt=Object.defineProperties,St=Object.getOwnPropertyDescriptors,In=Object.getOwnPropertySymbols,Wn=Object.prototype.hasOwnProperty,qn=Object.prototype.propertyIsEnumerable,hn=(a,o,f)=>o in a?Zt(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,pt=(a,o)=>{for(var f in o||(o={}))Wn.call(o,f)&&hn(a,f,o[f]);if(In)for(var f of In(o))qn.call(o,f)&&hn(a,f,o[f]);return a},Wt=(a,o)=>nt(a,St(o));function An(a){const o=a.toString();let f=5381,v=o.length;for(;v;)f=f*33^o.charCodeAt(--v);return f>>>0}function Pn(a,o){return o===void 0?null:typeof(a.properties[o]*1)=="number"?a.properties[o]*1:a.properties&&a.properties[o]?An(a.properties[o]+"")%1000019:null}function Xn(a,o){const f=[],v={};return a.features?(a.features=a.features.filter(T=>{const O=T.geometry;return T!=null&&O&&O.type&&O.coordinates&&O.coordinates.length>0}),a=Jt(a),a.features.length===0?{dataArray:[],featureKeys:v}:((0,vt.nG)(a,(T,O)=>{let L=Pn(T,o==null?void 0:o.featureId);L===null&&(L=O);const F=L,H=He(T),ie=Wt(pt({},T.properties),{coordinates:H,_id:F});f.push(ie)}),{dataArray:f,featureKeys:v})):(a.features=[],{dataArray:[]})}function dt(a,o,f,v){for(var T=v,O=f-o>>1,L=f-o,F,H=a[o],ie=a[o+1],ge=a[f],Te=a[f+1],Ve=o+3;Ve<f;Ve+=3){var Mt=be(a[Ve],a[Ve+1],H,ie,ge,Te);if(Mt>T)F=Ve,T=Mt;else if(Mt===T){var rn=Math.abs(Ve-O);rn<L&&(F=Ve,L=rn)}}T>v&&(F-o>3&&dt(a,o,F,v),a[F+2]=T,f-F>3&&dt(a,F,f,v))}function be(a,o,f,v,T,O){var L=T-f,F=O-v;if(L!==0||F!==0){var H=((a-f)*L+(o-v)*F)/(L*L+F*F);H>1?(f=T,v=O):H>0&&(f+=L*H,v+=F*H)}return L=a-f,F=o-v,L*L+F*F}function Ne(a,o,f,v){var T={id:typeof a=="undefined"?null:a,type:o,geometry:f,tags:v,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return ot(T),T}function ot(a){var o=a.geometry,f=a.type;if(f==="Point"||f==="MultiPoint"||f==="LineString")Pt(a,o);else if(f==="Polygon"||f==="MultiLineString")for(var v=0;v<o.length;v++)Pt(a,o[v]);else if(f==="MultiPolygon")for(v=0;v<o.length;v++)for(var T=0;T<o[v].length;T++)Pt(a,o[v][T])}function Pt(a,o){for(var f=0;f<o.length;f+=3)a.minX=Math.min(a.minX,o[f]),a.minY=Math.min(a.minY,o[f+1]),a.maxX=Math.max(a.maxX,o[f]),a.maxY=Math.max(a.maxY,o[f+1])}function It(a,o){var f=[];if(a.type==="FeatureCollection")for(var v=0;v<a.features.length;v++)xn(f,a.features[v],o,v);else a.type==="Feature"?xn(f,a,o):xn(f,{geometry:a},o);return f}function xn(a,o,f,v){if(o.geometry){var T=o.geometry.coordinates,O=o.geometry.type,L=Math.pow(f.tolerance/((1<<f.maxZoom)*f.extent),2),F=[],H=o.id;if(f.promoteId?H=o.properties[f.promoteId]:f.generateId&&(H=v||0),O==="Point")Qn(T,F);else if(O==="MultiPoint")for(var ie=0;ie<T.length;ie++)Qn(T[ie],F);else if(O==="LineString")br(T,F,L,!1);else if(O==="MultiLineString")if(f.lineMetrics){for(ie=0;ie<T.length;ie++)F=[],br(T[ie],F,L,!1),a.push(Ne(H,"LineString",F,o.properties));return}else Jn(T,F,L,!1);else if(O==="Polygon")Jn(T,F,L,!0);else if(O==="MultiPolygon")for(ie=0;ie<T.length;ie++){var ge=[];Jn(T[ie],ge,L,!0),F.push(ge)}else if(O==="GeometryCollection"){for(ie=0;ie<o.geometry.geometries.length;ie++)xn(a,{id:H,geometry:o.geometry.geometries[ie],properties:o.properties},f,v);return}else throw new Error("Input data is not a valid GeoJSON object.");a.push(Ne(H,O,F,o.properties))}}function Qn(a,o){o.push(Ae(a[0])),o.push(xe(a[1])),o.push(0)}function br(a,o,f,v){for(var T,O,L=0,F=0;F<a.length;F++){var H=Ae(a[F][0]),ie=xe(a[F][1]);o.push(H),o.push(ie),o.push(0),F>0&&(v?L+=(T*ie-H*O)/2:L+=Math.sqrt(Math.pow(H-T,2)+Math.pow(ie-O,2))),T=H,O=ie}var ge=o.length-3;o[2]=1,dt(o,0,ge,f),o[ge+2]=1,o.size=Math.abs(L),o.start=0,o.end=o.size}function Jn(a,o,f,v){for(var T=0;T<a.length;T++){var O=[];br(a[T],O,f,v),o.push(O)}}function Ae(a){return a/360+.5}function xe(a){var o=Math.sin(a*Math.PI/180),f=.5-.25*Math.log((1+o)/(1-o))/Math.PI;return f<0?0:f>1?1:f}function ke(a,o,f,v,T,O,L,F){if(f/=o,v/=o,O>=f&&L<v)return a;if(L<f||O>=v)return null;for(var H=[],ie=0;ie<a.length;ie++){var ge=a[ie],Te=ge.geometry,Ve=ge.type,Mt=T===0?ge.minX:ge.minY,rn=T===0?ge.maxX:ge.maxY;if(Mt>=f&&rn<v){H.push(ge);continue}else if(rn<f||Mt>=v)continue;var Rn=[];if(Ve==="Point"||Ve==="MultiPoint")tt(Te,Rn,f,v,T);else if(Ve==="LineString")Et(Te,Rn,f,v,T,!1,F.lineMetrics);else if(Ve==="MultiLineString")fn(Te,Rn,f,v,T,!1);else if(Ve==="Polygon")fn(Te,Rn,f,v,T,!0);else if(Ve==="MultiPolygon")for(var hr=0;hr<Te.length;hr++){var Nr=[];fn(Te[hr],Nr,f,v,T,!0),Nr.length&&Rn.push(Nr)}if(Rn.length){if(F.lineMetrics&&Ve==="LineString"){for(hr=0;hr<Rn.length;hr++)H.push(Ne(ge.id,Ve,Rn[hr],ge.tags));continue}(Ve==="LineString"||Ve==="MultiLineString")&&(Rn.length===1?(Ve="LineString",Rn=Rn[0]):Ve="MultiLineString"),(Ve==="Point"||Ve==="MultiPoint")&&(Ve=Rn.length===3?"Point":"MultiPoint"),H.push(Ne(ge.id,Ve,Rn,ge.tags))}}return H.length?H:null}function tt(a,o,f,v,T){for(var O=0;O<a.length;O+=3){var L=a[O+T];L>=f&&L<=v&&(o.push(a[O]),o.push(a[O+1]),o.push(a[O+2]))}}function Et(a,o,f,v,T,O,L){for(var F=tn(a),H=T===0?en:Gn,ie=a.start,ge,Te,Ve=0;Ve<a.length-3;Ve+=3){var Mt=a[Ve],rn=a[Ve+1],Rn=a[Ve+2],hr=a[Ve+3],Nr=a[Ve+4],jn=T===0?Mt:rn,ci=T===0?hr:Nr,ji=!1;L&&(ge=Math.sqrt(Math.pow(Mt-hr,2)+Math.pow(rn-Nr,2))),jn<f?ci>f&&(Te=H(F,Mt,rn,hr,Nr,f),L&&(F.start=ie+ge*Te)):jn>v?ci<v&&(Te=H(F,Mt,rn,hr,Nr,v),L&&(F.start=ie+ge*Te)):_t(F,Mt,rn,Rn),ci<f&&jn>=f&&(Te=H(F,Mt,rn,hr,Nr,f),ji=!0),ci>v&&jn<=v&&(Te=H(F,Mt,rn,hr,Nr,v),ji=!0),!O&&ji&&(L&&(F.end=ie+ge*Te),o.push(F),F=tn(a)),L&&(ie+=ge)}var To=a.length-3;Mt=a[To],rn=a[To+1],Rn=a[To+2],jn=T===0?Mt:rn,jn>=f&&jn<=v&&_t(F,Mt,rn,Rn),To=F.length-3,O&&To>=3&&(F[To]!==F[0]||F[To+1]!==F[1])&&_t(F,F[0],F[1],F[2]),F.length&&o.push(F)}function tn(a){var o=[];return o.size=a.size,o.start=a.start,o.end=a.end,o}function fn(a,o,f,v,T,O){for(var L=0;L<a.length;L++)Et(a[L],o,f,v,T,O,!1)}function _t(a,o,f,v){a.push(o),a.push(f),a.push(v)}function en(a,o,f,v,T,O){var L=(O-o)/(v-o);return a.push(O),a.push(f+(T-f)*L),a.push(1),L}function Gn(a,o,f,v,T,O){var L=(O-f)/(T-f);return a.push(o+(v-o)*L),a.push(O),a.push(1),L}function Tr(a,o){var f=o.buffer/o.extent,v=a,T=ke(a,1,-1-f,f,0,-1,2,o),O=ke(a,1,1-f,2+f,0,-1,2,o);return(T||O)&&(v=ke(a,1,-f,1+f,0,-1,2,o)||[],T&&(v=jr(T,1).concat(v)),O&&(v=v.concat(jr(O,-1)))),v}function jr(a,o){for(var f=[],v=0;v<a.length;v++){var T=a[v],O=T.type,L;if(O==="Point"||O==="MultiPoint"||O==="LineString")L=vr(T.geometry,o);else if(O==="MultiLineString"||O==="Polygon"){L=[];for(var F=0;F<T.geometry.length;F++)L.push(vr(T.geometry[F],o))}else if(O==="MultiPolygon")for(L=[],F=0;F<T.geometry.length;F++){for(var H=[],ie=0;ie<T.geometry[F].length;ie++)H.push(vr(T.geometry[F][ie],o));L.push(H)}f.push(Ne(T.id,O,L,T.tags))}return f}function vr(a,o){var f=[];f.size=a.size,a.start!==void 0&&(f.start=a.start,f.end=a.end);for(var v=0;v<a.length;v+=3)f.push(a[v]+o,a[v+1],a[v+2]);return f}function Ur(a,o){if(a.transformed)return a;var f=1<<a.z,v=a.x,T=a.y,O,L,F;for(O=0;O<a.features.length;O++){var H=a.features[O],ie=H.geometry,ge=H.type;if(H.geometry=[],ge===1)for(L=0;L<ie.length;L+=2)H.geometry.push(Fr(ie[L],ie[L+1],o,f,v,T));else for(L=0;L<ie.length;L++){var Te=[];for(F=0;F<ie[L].length;F+=2)Te.push(Fr(ie[L][F],ie[L][F+1],o,f,v,T));H.geometry.push(Te)}}return a.transformed=!0,a}function Fr(a,o,f,v,T,O){return[Math.round(f*(a*v-T)),Math.round(f*(o*v-O))]}function qr(a,o,f,v,T){for(var O=o===T.maxZoom?0:T.tolerance/((1<<o)*T.extent),L={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:f,y:v,z:o,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},F=0;F<a.length;F++){L.numFeatures++,wr(L,a[F],O,T);var H=a[F].minX,ie=a[F].minY,ge=a[F].maxX,Te=a[F].maxY;H<L.minX&&(L.minX=H),ie<L.minY&&(L.minY=ie),ge>L.maxX&&(L.maxX=ge),Te>L.maxY&&(L.maxY=Te)}return L}function wr(a,o,f,v){var T=o.geometry,O=o.type,L=[];if(O==="Point"||O==="MultiPoint")for(var F=0;F<T.length;F+=3)L.push(T[F]),L.push(T[F+1]),a.numPoints++,a.numSimplified++;else if(O==="LineString")fi(L,T,a,f,!1,!1);else if(O==="MultiLineString"||O==="Polygon")for(F=0;F<T.length;F++)fi(L,T[F],a,f,O==="Polygon",F===0);else if(O==="MultiPolygon")for(var H=0;H<T.length;H++){var ie=T[H];for(F=0;F<ie.length;F++)fi(L,ie[F],a,f,!0,F===0)}if(L.length){var ge=o.tags||null;if(O==="LineString"&&v.lineMetrics){ge={};for(var Te in o.tags)ge[Te]=o.tags[Te];ge.mapbox_clip_start=T.start/T.size,ge.mapbox_clip_end=T.end/T.size}var Ve={geometry:L,type:O==="Polygon"||O==="MultiPolygon"?3:O==="LineString"||O==="MultiLineString"?2:1,tags:ge};o.id!==null&&(Ve.id=o.id),a.features.push(Ve)}}function fi(a,o,f,v,T,O){var L=v*v;if(v>0&&o.size<(T?L:v)){f.numPoints+=o.length/3;return}for(var F=[],H=0;H<o.length;H+=3)(v===0||o[H+2]>L)&&(f.numSimplified++,F.push(o[H]),F.push(o[H+1])),f.numPoints++;T&&di(F,O),a.push(F)}function di(a,o){for(var f=0,v=0,T=a.length,O=T-2;v<T;O=v,v+=2)f+=(a[v]-a[O])*(a[v+1]+a[O+1]);if(f>0===o)for(v=0,T=a.length;v<T/2;v+=2){var L=a[v],F=a[v+1];a[v]=a[T-2-v],a[v+1]=a[T-1-v],a[T-2-v]=L,a[T-1-v]=F}}function vi(a,o){return new vo(a,o)}function vo(a,o){o=this.options=Ko(Object.create(this.options),o);var f=o.debug;if(f&&console.time("preprocess data"),o.maxZoom<0||o.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(o.promoteId&&o.generateId)throw new Error("promoteId and generateId cannot be used together.");var v=It(a,o);this.tiles={},this.tileCoords=[],f&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",o.indexMaxZoom,o.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),v=Tr(v,o),v.length&&this.splitTile(v,0,0,0),f&&(v.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}vo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vo.prototype.splitTile=function(a,o,f,v,T,O,L){for(var F=[a,o,f,v],H=this.options,ie=H.debug;F.length;){v=F.pop(),f=F.pop(),o=F.pop(),a=F.pop();var ge=1<<o,Te=Oi(o,f,v),Ve=this.tiles[Te];if(!Ve&&(ie>1&&console.time("creation"),Ve=this.tiles[Te]=qr(a,o,f,v,H),this.tileCoords.push({z:o,x:f,y:v}),ie)){ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",o,f,v,Ve.numFeatures,Ve.numPoints,Ve.numSimplified),console.timeEnd("creation"));var Mt="z"+o;this.stats[Mt]=(this.stats[Mt]||0)+1,this.total++}if(Ve.source=a,T){if(o===H.maxZoom||o===T)continue;var rn=1<<T-o;if(f!==Math.floor(O/rn)||v!==Math.floor(L/rn))continue}else if(o===H.indexMaxZoom||Ve.numPoints<=H.indexMaxPoints)continue;if(Ve.source=null,a.length!==0){ie>1&&console.time("clipping");var Rn=.5*H.buffer/H.extent,hr=.5-Rn,Nr=.5+Rn,jn=1+Rn,ci,ji,To,Ji,Hr,Gi;ci=ji=To=Ji=null,Hr=ke(a,ge,f-Rn,f+Nr,0,Ve.minX,Ve.maxX,H),Gi=ke(a,ge,f+hr,f+jn,0,Ve.minX,Ve.maxX,H),a=null,Hr&&(ci=ke(Hr,ge,v-Rn,v+Nr,1,Ve.minY,Ve.maxY,H),ji=ke(Hr,ge,v+hr,v+jn,1,Ve.minY,Ve.maxY,H),Hr=null),Gi&&(To=ke(Gi,ge,v-Rn,v+Nr,1,Ve.minY,Ve.maxY,H),Ji=ke(Gi,ge,v+hr,v+jn,1,Ve.minY,Ve.maxY,H),Gi=null),ie>1&&console.timeEnd("clipping"),F.push(ci||[],o+1,f*2,v*2),F.push(ji||[],o+1,f*2,v*2+1),F.push(To||[],o+1,f*2+1,v*2),F.push(Ji||[],o+1,f*2+1,v*2+1)}}},vo.prototype.getTile=function(a,o,f){var v=this.options,T=v.extent,O=v.debug;if(a<0||a>24)return null;var L=1<<a;o=(o%L+L)%L;var F=Oi(a,o,f);if(this.tiles[F])return Ur(this.tiles[F],T);O>1&&console.log("drilling down to z%d-%d-%d",a,o,f);for(var H=a,ie=o,ge=f,Te;!Te&&H>0;)H--,ie=Math.floor(ie/2),ge=Math.floor(ge/2),Te=this.tiles[Oi(H,ie,ge)];return!Te||!Te.source?null:(O>1&&console.log("found parent tile z%d-%d-%d",H,ie,ge),O>1&&console.time("drilling down"),this.splitTile(Te.source,H,ie,ge,a,o,f),O>1&&console.timeEnd("drilling down"),this.tiles[F]?Ur(this.tiles[F],T):null)};function Oi(a,o,f){return((1<<a)*f+o)*32+a}function Ko(a,o){for(var f in o)a[f]=o[f];return a}var va=class{constructor(a,o,f,v){this.vectorLayerCache={},this.x=o,this.y=f,this.z=v,this.vectorTile=a}getTileData(a){return!a||!this.vectorTile.layers[a]?[]:this.vectorLayerCache[a]?this.vectorLayerCache[a]:this.vectorTile.layers[a].features}getFeatureById(){throw new Error("Method not implemented.")}},Co=Object.defineProperty,Xo=Object.defineProperties,Ye=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,Ct=Object.prototype.hasOwnProperty,sn=Object.prototype.propertyIsEnumerable,Ln=(a,o,f)=>o in a?Co(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,zn=(a,o)=>{for(var f in o||(o={}))Ct.call(o,f)&&Ln(a,f,o[f]);if(Ke)for(var f of Ke(o))sn.call(o,f)&&Ln(a,f,o[f]);return a},mn=(a,o)=>Xo(a,Ye(o)),wn=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),gr={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function mr(a){let o=0;for(let f=0,v=a.length,T=v-1,O,L;f<v;T=f++)O=a[f],L=a[T],o+=(L.x-O.x)*(O.y+L.y);return o}function ai(a){const o=a.length;if(o<=1)return[a];const f=[];let v,T;for(let O=0;O<o;O++){const L=mr(a[O]);L!==0&&(T===void 0&&(T=L<0),T===L<0?(v&&f.push(v),v=[a[O]]):v.push(a[O]))}return v&&f.push(v),f}var Vi=["Unknown","Point","LineString","Polygon"];function fo(a,o,f,v,T){let O=T.geometry;const L=T.type,F=T.tags,H=T.id,ie=a*Math.pow(2,v),ge=a*o,Te=a*f;let Ve=Vi[L],Mt,rn;function Rn(Nr){for(let jn=0;jn<Nr.length;jn++){const ci=Nr[jn];if(ci[3])break;const ji=180-(ci[1]+Te)*360/ie,To=(ci[0]+ge)*360/ie-180,Ji=360/Math.PI*Math.atan(Math.exp(ji*Math.PI/180))-90;Nr[jn]=[To,Ji,0,1]}}switch(L){case 1:const Nr=[];for(Mt=0;Mt<O.length;Mt++)Nr[Mt]=O[Mt][0];O=Nr,Rn(O);break;case 2:for(Mt=0;Mt<O.length;Mt++)Rn(O[Mt]);break;case 3:for(O=ai(O),Mt=0;Mt<O.length;Mt++)for(rn=0;rn<O[Mt].length;rn++)Rn(O[Mt][rn]);break}return O.length===1?O=O[0]:Ve="Multi"+Ve,{type:"Feature",geometry:{type:Ve,coordinates:O},properties:F,id:H,tileOrigin:[0,0],coord:""}}var ei=(a,o,f,v)=>wn(void 0,null,function*(){return new Promise(T=>{const O=o.getTile(a.z,a.x,a.y),F={layers:{defaultLayer:{features:O?O.features.map(ie=>fo(v,f.x,f.y,f.z,ie)):[]}}},H=new va(F,a.x,a.y,a.z);T(H)})});function zi(a){const o={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return a===void 0||typeof a.geojsonvtOptions=="undefined"?o:zn(zn({},o),a.geojsonvtOptions)}function Li(a,o){const f=zi(o),v=f.extent||4096,T=vi(a,f),O=(F,H)=>ei(H,T,F,v),L=mn(zn(zn({},gr),o),{getTileData:O});return{data:a,dataArray:[],tilesetOptions:L,isTile:!0}}var Zr=Object.defineProperty,go=Object.defineProperties,Mi=Object.getOwnPropertyDescriptors,bo=Object.getOwnPropertySymbols,Si=Object.prototype.hasOwnProperty,wo=Object.prototype.propertyIsEnumerable,Yo=(a,o,f)=>o in a?Zr(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Wa=(a,o)=>{for(var f in o||(o={}))Si.call(o,f)&&Yo(a,f,o[f]);if(bo)for(var f of bo(o))wo.call(o,f)&&Yo(a,f,o[f]);return a},na=(a,o)=>go(a,Mi(o));function jo(a,o){const{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:v,requestParameters:T={}}=o,O=new Promise(H=>{a instanceof HTMLImageElement||(0,Me.fg)(a)?H([a]):Va(a,T,ie=>{H(ie)})}),L=_n(v,f);return{originData:a,images:O,_id:1,dataArray:[{_id:0,coordinates:L}]}}function Va(a,o,f){const v=[];if(typeof a=="string")(0,Me.gJ)(na(Wa({},o),{url:a}),(T,O)=>{O&&(v.push(O),f(v))});else{const T=a.length;let O=0;a.forEach(L=>{(0,Me.gJ)(na(Wa({},o),{url:L}),(F,H)=>{O++,H&&v.push(H),O===T&&f(v)})})}return jo}var fs=Object.defineProperty,Tt=Object.defineProperties,Ft=Object.getOwnPropertyDescriptors,Dn=Object.getOwnPropertySymbols,sr=Object.prototype.hasOwnProperty,_i=Object.prototype.propertyIsEnumerable,bi=(a,o,f)=>o in a?fs(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,so=(a,o)=>{for(var f in o||(o={}))sr.call(o,f)&&bi(a,f,o[f]);if(Dn)for(var f of Dn(o))_i.call(o,f)&&bi(a,f,o[f]);return a},Ha=(a,o)=>Tt(a,Ft(o)),Bs=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Os=(a,o,f,v)=>Bs(void 0,null,function*(){const T={x:o.x,y:o.y,z:o.z},O=(0,Me.z0)(a,T);return new Promise(L=>{v?v(T,(F,H)=>{if(F||!H){const ie={layers:{defaultLayer:{features:[]}}},ge=new va(ie,o.x,o.y,o.z);L(ge)}else{const ie={layers:{defaultLayer:{features:H.features}}},ge=new va(ie,o.x,o.y,o.z);L(ge)}}):(0,Me.Yu)(Ha(so({},f),{url:O}),(F,H)=>{if(F||!H){const ie={layers:{defaultLayer:{features:[]}}},ge=new va(ie,o.x,o.y,o.z);L(ge)}else{const ge={layers:{defaultLayer:{features:JSON.parse(H)}}},Te=new va(ge,o.x,o.y,o.z);L(Te)}})})});function il(a,o){const f=(T,O)=>Os(a,O,o==null?void 0:o.requestParameters,o.getCustomData),v=Ha(so({},o),{getTileData:f});return{dataArray:[],tilesetOptions:v,isTile:!0}}var Xf=D(38929),zd=D(3614),md=D.n(zd),Dl=Object.defineProperty,Qc=Object.defineProperties,Mf=Object.getOwnPropertyDescriptors,Jc=Object.getOwnPropertySymbols,Ic=Object.prototype.hasOwnProperty,eu=Object.prototype.propertyIsEnumerable,Yf=(a,o,f)=>o in a?Dl(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,ac=(a,o)=>{for(var f in o||(o={}))Ic.call(o,f)&&Yf(a,f,o[f]);if(Jc)for(var f of Jc(o))eu.call(o,f)&&Yf(a,f,o[f]);return a},Xs=(a,o)=>Qc(a,Mf(o)),Ru=class{constructor(a,o,f,v){this.vectorLayerCache={},this.x=o,this.y=f,this.z=v,this.vectorTile=new Xf.VectorTile(new(md())(a))}getTileData(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];const o=this.vectorTile.layers[a];if(Array.isArray(o.features))return this.vectorLayerCache[a]=o.features,o.features;const f=[];for(let v=0;v<o.length;v++){const O=o.feature(v).toGeoJSON(this.x,this.y,this.z);f.push(Xs(ac({},O),{properties:ac({id:O.id},O.properties)}))}return this.vectorLayerCache[a]=f,f}getFeatureById(){throw new Error("Method not implemented.")}},gf=Object.defineProperty,kh=Object.defineProperties,zh=Object.getOwnPropertyDescriptors,tu=Object.getOwnPropertySymbols,mh=Object.prototype.hasOwnProperty,Uh=Object.prototype.propertyIsEnumerable,vd=(a,o,f)=>o in a?gf(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,gd=(a,o)=>{for(var f in o||(o={}))mh.call(o,f)&&vd(a,f,o[f]);if(tu)for(var f of tu(o))Uh.call(o,f)&&vd(a,f,o[f]);return a},yd=(a,o)=>kh(a,zh(o)),vp=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),$f={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Mu=(a,o,f,v,T)=>vp(void 0,null,function*(){const O=(0,Me.z0)(a,o);return new Promise(L=>{if(T)T({x:f.x,y:f.y,z:f.z},(F,H)=>{if(F||!H)L(void 0);else{const ie=new Ru(H,f.x,f.y,f.z);L(ie)}});else{const F=(0,Me.ks)(yd(gd({},v),{url:O}),(H,ie)=>{if(H||!ie)L(void 0);else{const ge=new Ru(ie,f.x,f.y,f.z);L(ge)}});f.xhrCancel=()=>F.cancel()}})});function _d(a,o){const f=Array.isArray(a)?a[0]:a,v=(O,L)=>Mu(f,O,L,o==null?void 0:o.requestParameters,o==null?void 0:o.getCustomData),T=yd(gd(gd({},$f),o),{getTileData:v});return{data:f,dataArray:[],tilesetOptions:T,isTile:!0}}function Nl(a,o,f){switch(a){case"+":return o+f;case"-":return o-f;case"*":return o*f;case"/":return o/f;case"%":return o%f;case"^":return Math.pow(o,f);case"abs":return Math.abs(o);case"floor":return Math.floor(o);case"round":return Math.round(o);case"ceil":return Math.ceil(o);case"sin":return Math.sin(o);case"cos":return Math.cos(o);case"atan":return f===-1?Math.atan(o):Math.atan2(o,f);case"min":return Math.min(o,f);case"max":return Math.max(o,f);case"log10":return Math.log(o);case"log2":return Math.log2(o);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Is(a,o){const{width:f,height:v}=o[0],T=o.map(H=>H.rasterData),O=f*v,L=[],F=JSON.stringify(a);for(let H=0;H<O;H++){const ie=JSON.parse(F),ge=nu(ie,T,H);if(typeof ge=="number")L.push(ge);else{const Te=of(ie);L.push(Te)}}return L}function nu(a,o,f){if(a.length===2&&a[0]==="band"&&typeof a[1]=="number")try{return o[a[1]][f]}catch(v){return console.warn("Raster Data err!"),0}a.map((v,T)=>{if(Array.isArray(v)&&v.length>0)switch(v[0]){case"band":try{a[T]=o[v[1]][f]}catch(O){console.warn("Raster Data err!"),a[T]=0}break;default:nu(v,o,f)}})}function sc(a){const[o,f=-1,v=-1]=a;return o===void 0?(console.warn("Express err!"),["+",0,0]):[o.replace(/\s+/g,""),f,v]}function of(a){const o=sc(a),f=o[0];let v=o[1],T=o[2];return Array.isArray(v)&&(v=of(a[1])),Array.isArray(T)&&(T=of(a[2])),Nl(f,v,T)}var lc={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:af}};function af(a,o){const f=a[0].rasterData,v=a[1].rasterData,T=a[2].rasterData,O=[],[L,F]=(o==null?void 0:o.countCut)||[2,98],H=(o==null?void 0:o.RMinMax)||Bl(f,L,F),ie=(o==null?void 0:o.GMinMax)||Bl(v,L,F),ge=(o==null?void 0:o.BMinMax)||Bl(T,L,F);for(let Te=0;Te<f.length;Te++)O.push(Math.max(0,f[Te]-H[0])),O.push(Math.max(0,v[Te]-ie[0])),O.push(Math.max(0,T[Te]-ge[0]));return{rasterData:O,rMinMax:H,gMinMax:ie,bMinMax:ge}}function Bl(a,o,f){const v=a.slice().sort((F,H)=>F-H),T=v.length,O=v[Math.ceil(T*o/100)],L=v[Math.ceil(T*f/100)];return[O,L]}var Pu=Object.defineProperty,yf=Object.defineProperties,vh=Object.getOwnPropertyDescriptors,Kf=Object.getOwnPropertySymbols,ps=Object.prototype.hasOwnProperty,jh=Object.prototype.propertyIsEnumerable,Vh=(a,o,f)=>o in a?Pu(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,gh=(a,o)=>{for(var f in o||(o={}))ps.call(o,f)&&Vh(a,f,o[f]);if(Kf)for(var f of Kf(o))jh.call(o,f)&&Vh(a,f,o[f]);return a},ol=(a,o)=>yf(a,vh(o)),qf=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())});function Qf(a,o,f){return qf(this,null,function*(){if(a.length===0)return{rasterData:[0],width:1,heigh:1};const v=yield Promise.all(a.map(({data:H,bands:ie=[0]})=>o(H,ie))),T=[];v.forEach(H=>{Array.isArray(H)?T.push(...H):T.push(H)});const{width:O,height:L}=T[0];let F;switch(typeof f){case"function":F=f(T);break;case"object":Array.isArray(f)?F={rasterData:Is(f,T)}:F=ne(f,T);break;default:F={rasterData:T[0].rasterData}}return ol(gh({},F),{width:O,height:L})})}function ne(a,o){const f=lc[a.type];if(f.type==="function")return f.method(o,a==null?void 0:a.options);if(f.type==="operation")return a.type==="rgb"?_e(f.expression,o):{rasterData:Is(f.expression,o)}}function _e(a,o){a.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),a.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),a.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const f=Is(a.r||["band",0],o),v=Is(a.g||["band",0],o),T=Is(a.b||["band",0],o);return[f,v,T]}function et(a,o,f,v){return qf(this,null,function*(){const T=yield Qf(a,o,f);v(null,{data:T})})}function dn(a,o){const{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:v,width:T,height:O,min:L,max:F,format:H,operation:ie}=o;let ge,Te,Ve;if(H===void 0||Ht(a))ge=Array.from(a),Te=T,Ve=O;else{const Rn=Array.isArray(a)?a:[a];ge=Qf(Rn,H,ie)}const Mt=_n(v,f);return{_id:1,dataArray:[{_id:1,data:ge,width:Te,height:Ve,min:L,max:F,coordinates:Mt}]}}var K=D(39827),rr=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Mr=(a,o,f,v)=>rr(void 0,null,function*(){return new Promise((T,O)=>{o({x:a.x,y:a.y,z:a.z},(L,F)=>{if(L||F.length===0){O(L);return}F&&et([{data:F,bands:[0]}],f,v,(H,ie)=>{H?O(H):ie&&T(ie)})})})}),ki=(a,o)=>rr(void 0,null,function*(){return new Promise((f,v)=>{o({x:a.x,y:a.y,z:a.z},(T,O)=>{if(T||!O){v(T);return}O instanceof ArrayBuffer?(0,Me.Co)(O,(L,F)=>{L&&v(L),f(F)}):O instanceof HTMLImageElement?f(O):v(T)})})});function ti(a,o){return Array.isArray(a)?typeof a[0]=="string"?a.map(f=>(0,Me.z0)(f,o)):a.map(f=>({url:(0,Me.z0)(f.url,o),bands:f.bands||[0]})):(0,Me.z0)(a,o)}function uo(a){return typeof a=="string"?[{url:a,bands:[0]}]:typeof a[0]=="string"?a.map(o=>({url:o,bands:[0]})):a}function lo(a,o){a.xhrCancel=()=>{o.map(f=>{f.abort()})}}var ca=Object.defineProperty,Io=Object.defineProperties,xa=Object.getOwnPropertyDescriptors,Qa=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,ga=Object.prototype.propertyIsEnumerable,hs=(a,o,f)=>o in a?ca(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Oa=(a,o)=>{for(var f in o||(o={}))aa.call(o,f)&&hs(a,f,o[f]);if(Qa)for(var f of Qa(o))ga.call(o,f)&&hs(a,f,o[f]);return a},La=(a,o)=>Io(a,xa(o)),Fa=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Ks=(a,o,f,v,T)=>Fa(void 0,null,function*(){const O=uo(o.url);if(O.length>1){const{rasterFiles:L,xhrList:F,errList:H}=yield Fs(O,o);if(lo(a,F),H.length>0){f(H,null);return}et(L,v,T,f)}else{const L=(0,Me.ks)(o,(F,H)=>{if(F)f(F);else if(H){const ie=[{data:H,bands:O[0].bands}];et(ie,v,T,f)}});lo(a,[L])}});function Fs(a,o){return Fa(this,null,function*(){const f=[],v=[],T=[];for(let O=0;O<a.length;O++){const L=a[O],F=La(Oa({},o),{url:L.url}),H=L.bands,{err:ie,data:ge,xhr:Te}=yield(0,Me.LF)(La(Oa({},F),{type:"arrayBuffer"}));ie&&T.push(ie),v.push(Te),f.push({data:ge,bands:H})}return{rasterFiles:f,xhrList:v,errList:T}})}var Ec=Object.defineProperty,is=Object.defineProperties,Iu=Object.getOwnPropertyDescriptors,du=Object.getOwnPropertySymbols,Lc=Object.prototype.hasOwnProperty,Pf=Object.prototype.propertyIsEnumerable,Hh=(a,o,f)=>o in a?Ec(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Zh=(a,o)=>{for(var f in o||(o={}))Lc.call(o,f)&&Hh(a,f,o[f]);if(du)for(var f of du(o))Pf.call(o,f)&&Hh(a,f,o[f]);return a},If=(a,o)=>is(a,Iu(o)),Lu=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Lf=(a,o,f,v)=>Lu(void 0,null,function*(){const{format:T=Du,operation:O,requestParameters:L={}}=v,F=If(Zh({},L),{url:ti(a,o)});return new Promise((H,ie)=>{Ks(f,F,(ge,Te)=>{ge?ie(ge):Te&&H(Te)},T,O)})}),yh=(a,o,f,v)=>Lu(void 0,null,function*(){let T;const O=Array.isArray(a)?a[0]:a;return v.wmtsOptions?T=((v==null?void 0:v.getURLFromTemplate)||Me.jG)(O,Zh(Zh({},o),v.wmtsOptions)):T=((v==null?void 0:v.getURLFromTemplate)||Me.z0)(O,o),new Promise((L,F)=>{var H;const ie=(0,Me.gJ)(If(Zh({},v==null?void 0:v.requestParameters),{url:T,type:((H=v==null?void 0:v.requestParameters)==null?void 0:H.type)||"arrayBuffer"}),(ge,Te)=>{ge?F(ge):Te&&L(Te)},v.transformResponse);f.xhrCancel=()=>ie.cancel()})}),Du=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),P0=Object.defineProperty,bd=Object.defineProperties,Dc=Object.getOwnPropertyDescriptors,Wh=Object.getOwnPropertySymbols,gp=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable,_h=(a,o,f)=>o in a?P0(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Nu=(a,o)=>{for(var f in o||(o={}))gp.call(o,f)&&_h(a,f,o[f]);if(Wh)for(var f of Wh(o))Gh.call(o,f)&&_h(a,f,o[f]);return a},Df=(a,o)=>bd(a,Dc(o)),Jf={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Yp=[K.n3.ARRAYBUFFER,K.n3.RGB];function Nf(a){return!!(Array.isArray(a)&&a.length===0||!Array.isArray(a)&&typeof a!="string")}function Ja(a,o={}){if(Nf(a))throw new Error("tile server url is error");let f=(o==null?void 0:o.dataType)||K.n3.IMAGE;f===K.n3.RGB&&(f=K.n3.ARRAYBUFFER);const v=(O,L)=>{switch(f){case K.n3.IMAGE:return yh(a,O,L,o);case K.n3.CUSTOMIMAGE:case K.n3.CUSTOMTERRAINRGB:return ki(L,o==null?void 0:o.getCustomData);case K.n3.ARRAYBUFFER:return Lf(a,O,L,o);case K.n3.CUSTOMARRAYBUFFER:case K.n3.CUSTOMRGB:return Mr(L,o==null?void 0:o.getCustomData,(o==null?void 0:o.format)||Du,o==null?void 0:o.operation);default:return yh(a,O,L,o)}},T=Df(Nu(Nu({},Jf),o),{getTileData:v});return{data:a,dataArray:[],tilesetOptions:T,isTile:!0}}var xd=Object.defineProperty,pu=Object.defineProperties,ue=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,ct=Object.prototype.hasOwnProperty,Sn=Object.prototype.propertyIsEnumerable,cr=(a,o,f)=>o in a?xd(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,kr=(a,o)=>{for(var f in o||(o={}))ct.call(o,f)&&cr(a,f,o[f]);if(Pe)for(var f of Pe(o))Sn.call(o,f)&&cr(a,f,o[f]);return a},gi=(a,o)=>pu(a,ue(o)),$i=(a,o)=>{var f={};for(var v in a)ct.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Pe)for(var v of Pe(a))o.indexOf(v)<0&&Sn.call(a,v)&&(f[v]=a[v]);return f};function pa(a,o){const f=o,{extent:v=[121.168,30.2828,121.384,30.4219],coordinates:T,width:O,height:L}=f,F=$i(f,["extent","coordinates","width","height"]);a.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[H,ie]=F.bands||[0,1],ge=[a[H],a[ie]],Te=[];for(let rn=0;rn<ge[0].length;rn++)Te.push((ge[1][rn]-ge[0][rn])/(ge[1][rn]+ge[0][rn]));const Ve=_n(T,v);return{_id:1,dataArray:[gi(kr({_id:1,data:Te,width:O,height:L},F),{coordinates:Ve})]}}var Ea=Object.defineProperty,_s=Object.defineProperties,za=Object.getOwnPropertyDescriptors,ka=Object.getOwnPropertySymbols,cc=Object.prototype.hasOwnProperty,Bu=Object.prototype.propertyIsEnumerable,qs=(a,o,f)=>o in a?Ea(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,ho=(a,o)=>{for(var f in o||(o={}))cc.call(o,f)&&qs(a,f,o[f]);if(ka)for(var f of ka(o))Bu.call(o,f)&&qs(a,f,o[f]);return a},ru=(a,o)=>_s(a,za(o)),Ed=(a,o)=>{var f={};for(var v in a)cc.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&ka)for(var v of ka(a))o.indexOf(v)<0&&Bu.call(a,v)&&(f[v]=a[v]);return f};function eh(a,o){const f=o,{extent:v,coordinates:T,width:O,height:L}=f,F=Ed(f,["extent","coordinates","width","height"]);a.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[H,ie,ge]=F.bands||[0,1,2],Te=[a[H],a[ie],a[ge]],Ve=[],[Mt,rn]=(F==null?void 0:F.countCut)||[2,98],Rn=(F==null?void 0:F.RMinMax)||Bl(Te[0],Mt,rn),hr=(F==null?void 0:F.GMinMax)||Bl(Te[1],Mt,rn),Nr=(F==null?void 0:F.BMinMax)||Bl(Te[2],Mt,rn);for(let ji=0;ji<Te[0].length;ji++)Ve.push(Math.max(0,Te[0][ji]-Rn[0])),Ve.push(Math.max(0,Te[1][ji]-hr[0])),Ve.push(Math.max(0,Te[2][ji]-Nr[0]));const jn=_n(T,v);return{_id:1,dataArray:[ru(ho({_id:1,data:Ve,width:O,height:L,rMinMax:Rn,gMinMax:hr,bMinMax:Nr},F),{coordinates:jn})]}}var ml=Object.defineProperty,os=Object.defineProperties,yp=Object.getOwnPropertyDescriptors,Ii=Object.getOwnPropertySymbols,th=Object.prototype.hasOwnProperty,Sd=Object.prototype.propertyIsEnumerable,$p=(a,o,f)=>o in a?ml(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Nc=(a,o)=>{for(var f in o||(o={}))th.call(o,f)&&$p(a,f,o[f]);if(Ii)for(var f of Ii(o))Sd.call(o,f)&&$p(a,f,o[f]);return a},mu=(a,o)=>os(a,yp(o)),_p=(a,o)=>{var f={};for(var v in a)th.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Ii)for(var v of Ii(a))o.indexOf(v)<0&&Sd.call(a,v)&&(f[v]=a[v]);return f};function Kp(a,o){const f=o,{extent:v,coordinates:T,min:O,max:L,width:F,height:H,format:ie,operation:ge}=f,Te=_p(f,["extent","coordinates","min","max","width","height","format","operation"]);let Ve;if(ie===void 0||Ht(a))Ve=Array.from(a);else{const Rn=Array.isArray(a)?a:[a];Ve=Qf(Rn,ie,ge)}const Mt=_n(T,v);return{_id:1,dataArray:[mu(Nc({_id:1,data:Ve,width:F,height:H},Te),{min:O,max:L,coordinates:Mt})]}}var Bc=Object.defineProperty,nh=Object.defineProperties,Jm=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,bp=Object.prototype.hasOwnProperty,sm=Object.prototype.propertyIsEnumerable,Fu=(a,o,f)=>o in a?Bc(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,vu=(a,o)=>{for(var f in o||(o={}))bp.call(o,f)&&Fu(a,f,o[f]);if(Td)for(var f of Td(o))sm.call(o,f)&&Fu(a,f,o[f]);return a},ya=(a,o)=>nh(a,Jm(o)),ku=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),zu={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},uc=a=>ku(void 0,null,function*(){return new Promise(o=>{const[f,v,T,O]=a.bounds,L={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,x:(f+T)/2,y:(v+O)/2},geometry:{type:"LineString",coordinates:[[T,O],[T,v],[f,v],[f,v]]}}]}}};o(L)})});function Xh(a,o){const f=T=>uc(T),v=ya(vu(vu({},zu),o),{getTileData:f});return{data:a,dataArray:[],tilesetOptions:v,isTile:!0}}var Wl=D(46343),Wc=D(26729),iu=D.n(Wc),xp=D(69848),Oo=D.n(xp),So=Object.defineProperty,Uu=Object.getOwnPropertySymbols,ou=Object.prototype.hasOwnProperty,rh=Object.prototype.propertyIsEnumerable,fl=(a,o,f)=>o in a?So(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Gc=(a,o)=>{for(var f in o||(o={}))ou.call(o,f)&&fl(a,f,o[f]);if(Uu)for(var f of Uu(o))rh.call(o,f)&&fl(a,f,o[f]);return a};function Bf(a,o){const{radius:f=40,maxZoom:v=18,minZoom:T=0,zoom:O=2}=o;if(a.pointIndex){const H=a.pointIndex.getClusters(a.extent,Math.floor(O));return a.dataArray=wd(H),a}const L=new(Oo())({radius:f,minZoom:T,maxZoom:v}),F={type:"FeatureCollection",features:[]};return F.features=a.dataArray.map(H=>({type:"Feature",geometry:{type:"Point",coordinates:H.coordinates},properties:Gc({},H)})),L.load(F.features),L}function wd(a){return a.map((o,f)=>Gc({coordinates:o.geometry.coordinates,_id:f+1},o.properties))}function ms(a){if(a.length===0)throw new Error("max requires at least one data point");let o=a[0];for(let f=1;f<a.length;f++)a[f]>o&&(o=a[f]);return o}function fc(a){if(a.length===0)throw new Error("min requires at least one data point");let o=a[0];for(let f=1;f<a.length;f++)a[f]<o&&(o=a[f]);return o}function I0(a){if(a.length===0)return 0;let o=a[0],f=0,v;for(let T=1;T<a.length;T++)v=o+a[T]*1,Math.abs(o)>=Math.abs(a[T])?f+=o-v+a[T]:f+=a[T]-v+o,o=v;return o+f*1}function Yh(a){if(a.length===0)throw new Error("mean requires at least one data point");return I0(a)/a.length}var qp={min:fc,max:ms,mean:Yh,sum:I0},bh=Object.defineProperty,au=Object.getOwnPropertySymbols,Ud=Object.prototype.hasOwnProperty,Gr=Object.prototype.propertyIsEnumerable,ih=(a,o,f)=>o in a?bh(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Xc=(a,o)=>{for(var f in o||(o={}))Ud.call(o,f)&&ih(a,f,o[f]);if(au)for(var f of au(o))Gr.call(o,f)&&ih(a,f,o[f]);return a},jd=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),{cloneDeep:xh,isFunction:oh,isString:ah,mergeWith:Qp}=Me.lodashUtil;function sh(a,o){if(Array.isArray(o))return o}var Ff=class extends Wc.EventEmitter{constructor(a,o){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new Wl.ni},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=a,this.initCfg(o),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}getClustersLeaves(a){return this.clusterIndex.getLeaves(a,1/0)}getParserType(){return this.parser.type}updateClusterData(a){const{method:o="sum",field:f}=this.clusterOptions;let v=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,v.forEach(T=>{T.id||(T.properties.point_count=1)}),(f||oh(o))&&(v=v.map(T=>{const O=T.id;if(O){const F=this.clusterIndex.getLeaves(O,1/0).map(ie=>ie.properties);let H;if(ah(o)&&f){const ie=Fn(F,f);H=qp[o](ie)}oh(o)&&(H=o(F)),T.properties.stat=H}else T.properties.point_count=1;return T})),this.data=E("geojson")({type:"FeatureCollection",features:v}),this.executeTrans()}getFeatureById(a){const{type:o="geojson",geometry:f}=this.parser;if(o==="geojson"&&!this.cluster){const v=a<this.originData.features.length?this.originData.features[a]:"null",T=xh(v);if(T!=null&&T.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const O=this.data.dataArray.find(L=>L._id===a);T.properties=O}return T}else return o==="json"&&f?this.data.dataArray.find(v=>v._id===a):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}updateFeaturePropertiesById(a,o){this.data.dataArray=this.data.dataArray.map(f=>f._id===a?Xc(Xc({},f),o):f),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(a,o){const f=this.data.dataArray.find(v=>v[a]===o);return f==null?void 0:f._id}setData(a,o){this.originData=a,this.dataArrayChanged=!1,this.initCfg(o),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var a;(a=this.tileset)==null||a.reloadAll()}reloadTilebyId(a,o,f){var v;(v=this.tileset)==null||v.reloadTileById(a,o,f)}reloadTileByLnglat(a,o,f){var v;(v=this.tileset)==null||v.reloadTileByLnglat(a,o,f)}getTileExtent(a,o){var f;return(f=this.tileset)==null?void 0:f.getTileExtent(a,o)}getTileByZXY(a,o,f){var v;return(v=this.tileset)==null?void 0:v.getTileByZXY(a,o,f)}reloadTileByExtent(a,o){var f;(f=this.tileset)==null||f.reloadTileByExtent(a,o)}destroy(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)==null||a.destroy()}processData(){return jd(this,null,function*(){return new Promise((a,o)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),a({})}catch(f){o(f)}})})}initCfg(a){this.cfg=Qp(this.cfg,a,sh);const o=this.cfg;o&&(o.parser&&(this.parser=o.parser),o.transforms&&(this.transforms=o.transforms),this.cluster=o.cluster||!1,o.clusterOptions&&(this.cluster=!0,this.clusterOptions=Xc(Xc({},this.clusterOptions),o.clusterOptions)))}init(){return jd(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const a=this.parser,o=a.type||"geojson",f=E(o);this.data=f(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=(0,Me.We)(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:a}=this.data;return a?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(a),this.tileset):new Me.nx(Xc({},a))):void 0}executeTrans(){this.transforms.forEach(o=>{const{type:f}=o,v=re(f)(this.data,o);Object.assign(this.data,v)})}initCluster(){if(!this.cluster)return;const a=this.clusterOptions||{};this.clusterIndex=Bf(this.data,a)}caculClusterExtent(a){let o=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(o=(0,Me.yA)((0,Me.ds)(this.extent),a)),o[0].concat(o[1])}};function Eh(a,o){const{callback:f}=o;return f&&(a.dataArray=a.dataArray.filter(f)),a}var Al=6378e3;function ts(a,o){const f=a.dataArray,{size:v=10}=o,T=v/(2*Math.PI*Al)*(256<<20)/2,{gridHash:O,gridOffset:L}=ju(f,v),F=_(O,L,o);return{yOffset:T,xOffset:T,radius:T,type:"grid",dataArray:F}}function ju(a,o){let f=1/0,v=-1/0,T;for(const H of a)T=H.coordinates[1],Number.isFinite(T)&&(f=T<f?T:f,v=T>v?T:v);const O=(f+v)/2,L=Jp(o,O);if(L.xOffset<=0||L.yOffset<=0)return{gridHash:{},gridOffset:L};const F={};for(const H of a){const ie=H.coordinates[1],ge=H.coordinates[0];if(Number.isFinite(ie)&&Number.isFinite(ge)){const Te=Math.floor((ie+90)/L.yOffset),Ve=Math.floor((ge+180)/L.xOffset),Mt=`${Te}-${Ve}`;F[Mt]=F[Mt]||{count:0,points:[]},F[Mt].count+=1,F[Mt].points.push(H)}}return{gridHash:F,gridOffset:L}}function Jp(a,o){const f=L0(a),v=e0(o,a);return{yOffset:f,xOffset:v}}function L0(a){return a/Al*(180/Math.PI)}function e0(a,o){return o/Al*(180/Math.PI)/Math.cos(a*Math.PI/180)}function _(a,o,f){return Object.keys(a).reduce((v,T,O)=>{const L=T.split("-"),F=parseInt(L[0],10),H=parseInt(L[1],10),ie={};if(f.field&&f.method){const ge=Me.a5.getColumn(a[T].points,f.field);ie[f.method]=Me.a5.statMap[f.method](ge)}return Object.assign(ie,{_id:O,coordinates:(0,Me.Z)([-180+o.xOffset*(H+.5),-90+o.yOffset*(F+.5)]),rawData:a[T].points,count:a[T].count}),v.push(ie),v},[])}var S=Math.PI/3,x=[0,S,2*S,3*S,4*S,5*S];function C(a){return a[0]}function k(a){return a[1]}function G(){var a=0,o=0,f=1,v=1,T=C,O=k,L,F,H;function ie(Te){var Ve={},Mt=[],rn,Rn=Te.length;for(rn=0;rn<Rn;++rn)if(!(isNaN(Nr=+T.call(null,hr=Te[rn],rn,Te))||isNaN(jn=+O.call(null,hr,rn,Te)))){var hr,Nr,jn,ci=Math.round(jn=jn/H),ji=Math.round(Nr=Nr/F-(ci&1)/2),To=jn-ci;if(Math.abs(To)*3>1){var Ji=Nr-ji,Hr=ji+(Nr<ji?-1:1)/2,Gi=ci+(jn<ci?-1:1),ja=Nr-Hr,ys=jn-Gi;Ji*Ji+To*To>ja*ja+ys*ys&&(ji=Hr+(ci&1?1:-1)/2,ci=Gi)}var $o=ji+"-"+ci,cs=Ve[$o];cs?cs.push(hr):(Mt.push(cs=Ve[$o]=[hr]),cs.x=(ji+(ci&1)/2)*F,cs.y=ci*H)}return Mt}function ge(Te){var Ve=0,Mt=0;return x.map(function(rn){var Rn=Math.sin(rn)*Te,hr=-Math.cos(rn)*Te,Nr=Rn-Ve,jn=hr-Mt;return Ve=Rn,Mt=hr,[Nr,jn]})}return ie.hexagon=function(Te){return"m"+ge(Te==null?L:+Te).join("l")+"z"},ie.centers=function(){for(var Te=[],Ve=Math.round(o/H),Mt=Math.round(a/F),rn=Ve*H;rn<v+L;rn+=H,++Ve)for(var Rn=Mt*F+(Ve&1)*F/2;Rn<f+F/2;Rn+=F)Te.push([Rn,rn]);return Te},ie.mesh=function(){var Te=ge(L).slice(0,4).join("l");return ie.centers().map(function(Ve){return"M"+Ve+"m"+Te}).join("")},ie.x=function(Te){return arguments.length?(T=Te,ie):T},ie.y=function(Te){return arguments.length?(O=Te,ie):O},ie.radius=function(Te){return arguments.length?(L=+Te,F=L*2*Math.sin(S),H=L*1.5,ie):L},ie.size=function(Te){return arguments.length?(a=o=0,f=+Te[0],v=+Te[1],ie):[f-a,v-o]},ie.extent=function(Te){return arguments.length?(a=+Te[0][0],o=+Te[0][1],f=+Te[1][0],v=+Te[1][1],ie):[[a,o],[f,v]]},ie.radius(1)}var q=Object.defineProperty,he=Object.defineProperties,je=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable,Yt=(a,o,f)=>o in a?q(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,gn=(a,o)=>{for(var f in o||(o={}))kt.call(o,f)&&Yt(a,f,o[f]);if(Xe)for(var f of Xe(o))jt.call(o,f)&&Yt(a,f,o[f]);return a},pn=(a,o)=>he(a,je(o)),Cn=6378e3;function un(a,o){const f=a.dataArray,{size:v=10,method:T="sum"}=o,O=v/(2*Math.PI*Cn)*(256<<20)/2,L=f.map(ge=>{const[Te,Ve]=(0,Me.Z)(ge.coordinates);return pn(gn({},ge),{coordinates:[Te,Ve]})});return{dataArray:G().radius(O).x(ge=>ge.coordinates[0]).y(ge=>ge.coordinates[1])(L).map((ge,Te)=>{if(o.field&&T){const Ve=Me.a5.getColumn(ge,o.field);ge[T]=Me.a5.statMap[T](Ve)}return{[o.method]:ge[T],count:ge.length,rawData:ge,coordinates:[ge.x,ge.y],_id:Te}}),radius:O,xOffset:O,yOffset:O,type:"hexagon"}}var kn=Object.defineProperty,er=Object.getOwnPropertySymbols,ur=Object.prototype.hasOwnProperty,Cr=Object.prototype.propertyIsEnumerable,dr=(a,o,f)=>o in a?kn(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Br=(a,o)=>{for(var f in o||(o={}))ur.call(o,f)&&dr(a,f,o[f]);if(er)for(var f of er(o))Cr.call(o,f)&&dr(a,f,o[f]);return a};function ri(a,o){const{sourceField:f,targetField:v,data:T}=o,O={};return T.forEach(L=>{O[L[f]]=L}),a.dataArray=a.dataArray.map(L=>{const F=L[v];return Br(Br({},L),O[F])}),a}function Yr(a,o){const{callback:f}=o;return f&&(a.dataArray=a.dataArray.map(f)),a}var wi=D(4771);ve("rasterTile",Ja),ve("mvt",_d),ve("geojsonvt",Li),ve("testTile",Xh),ve("geojson",Xn),ve("jsonTile",il),ve("image",jo),ve("csv",de),ve("json",z),ve("raster",dn),ve("rasterRgb",Kp),ve("rgb",eh),ve("ndi",pa),fe("cluster",Bf),fe("filter",Eh),fe("join",ri),fe("map",Yr),fe("grid",ts),fe("hexagon",un);var Hi=Ff;class Lo extends null{getMarkerLayerContainerSize(){}constructor(o){super(),_defineProperty(this,"markerOption",void 0),_defineProperty(this,"popup",void 0),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"added",!1),_defineProperty(this,"preLngLat",{lng:0,lat:0}),_defineProperty(this,"onMarkerDragStart",f=>{const v=this.mapsService.getContainer();if(!v)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:T,top:O}=v.getClientRects()[0],{x:L,y:F}=f;this.preLngLat=this.mapsService.containerToLngLat([L-T,F-O]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),_defineProperty(this,"onMarkerDragMove",f=>{const v=f.lngLat||f.lnglat,{lng:T,lat:O}=this.preLngLat,{lng:L,lat:F}=v,H={lng:this.lngLat.lng+L-T,lat:this.lngLat.lat+F-O};this.setLnglat(H),this.preLngLat=v,this.emit("dragging",H)}),_defineProperty(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),_defineProperty(this,"eventHandle",f=>{this.polyfillEvent(f),this.emit(f.type,{target:f,data:this.markerOption.extData,lngLat:this.lngLat})}),_defineProperty(this,"touchStartTime",void 0),this.markerOption=_objectSpread(_objectSpread({},this.getDefault()),o),bindAll(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(o){this.scene=o,this.mapsService=o.mapService;const{element:f}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(f),this.registerMarkerEvent(f),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:o}=this.markerOption;return o&&DOM.remove(o),this.popup&&this.popup.remove(),this}setLnglat(o){return this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(o){if(!this.added)return this.once("added",()=>{this.setElement(o)}),this;const{element:f}=this.markerOption;return f&&DOM.remove(f),this.markerOption.element=o,this.init(),this.mapsService.getMarkerContainer().appendChild(o),this.registerMarkerEvent(o),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const o=this.popup;return o?(o.isOpen()||o.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const o=this.popup;return o&&o.remove(),this}setPopup(o){return this.popup=o,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const o=this.popup;if(o)o.isOpen()?o.remove():o.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(o){this.markerOption.draggable=o,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(o){this.markerOption.extData=o}update(){if(!this.mapsService)return;const{element:o,anchor:f}=this.markerOption;this.updatePosition(),DOM.setTransform(o,`${anchorTranslate[f]}`)}updatePositionWhenZoom(o){if(!this.mapsService)return;const{element:f,offsets:v}=this.markerOption,{lng:T,lat:O}=this.lngLat;if(f){f.style.display="block",f.style.whiteSpace="nowrap";const{containerHeight:L,containerWidth:F,bounds:H}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!H)return;const ie=o.map,ge=o.center,Te=o.zoom,Ve=ie.DE(this.lngLat,Te,ge);if(Ve.x=Math.round(Ve.x+v[0]),Ve.y=Math.round(Ve.y-v[1]),Math.abs(H[0][0])>180||Math.abs(H[1][0])>180){if(Ve.x>F){const Mt=this.mapsService.lngLatToContainer([T-360,O]);Ve.x=Mt.x}if(Ve.x<0){const Mt=this.mapsService.lngLatToContainer([T+360,O]);Ve.x=Mt.x}}(Ve.x>F||Ve.x<0||Ve.y>L||Ve.y<0)&&(f.style.display="none"),f.style.left=Ve.x+"px",f.style.top=Ve.y+"px",f.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(o){const{element:f}=this.markerOption;this.popup&&f&&this.togglePopup()}getCurrentContainerSize(){const o=this.mapsService.getContainer();return{containerHeight:(o==null?void 0:o.scrollHeight)||0,containerWidth:(o==null?void 0:o.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:o}=this.markerOption;o==null||o.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(o==null||o.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:o,offsets:f}=this.markerOption,{lng:v,lat:T}=this.lngLat,O=this.mapsService.lngLatToContainer([v,T]);if(o){o.style.display="block",o.style.whiteSpace="nowrap";const{containerHeight:L,containerWidth:F,bounds:H}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!H)return;if(Math.abs(H[0][0])>180||Math.abs(H[1][0])>180){if(O.x>F){const ie=this.mapsService.lngLatToContainer([v-360,T]);O.x=ie.x}if(O.x<0){const ie=this.mapsService.lngLatToContainer([v+360,T]);O.x=ie.x}}this.markerOption.overflowHide&&(O.x>F||O.x<0||O.y>L||O.y<0)&&(o.style.display="none"),o.style.left=O.x+f[0]+"px",o.style.top=O.y-f[1]+"px"}}init(){let{element:o}=this.markerOption;const{color:f,anchor:v}=this.markerOption;if(!o){o=DOM.create("div"),this.markerOption.element=o;const T=document.createElementNS("http://www.w3.org/2000/svg","svg");T.setAttributeNS(null,"display","block"),T.setAttributeNS(null,"height","48px"),T.setAttributeNS(null,"width","48px"),T.setAttributeNS(null,"viewBox","0 0 1024 1024");const O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),O.setAttributeNS(null,"fill",f),T.appendChild(O),o.appendChild(T)}DOM.addClass(o,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(T=>{var O,L;const F=((O=this.markerOption)===null||O===void 0?void 0:O.style)&&((L=this.markerOption)===null||L===void 0?void 0:L.style[T]);o&&(o.style[T]=F)}),applyAnchorClass(o,v,"marker")}registerMarkerEvent(o){o.addEventListener("click",this.onMapClick),o.addEventListener("mousemove",this.eventHandle),o.addEventListener("click",this.eventHandle),o.addEventListener("mousedown",this.eventHandle),o.addEventListener("mouseup",this.eventHandle),o.addEventListener("dblclick",this.eventHandle),o.addEventListener("contextmenu",this.eventHandle),o.addEventListener("mouseover",this.eventHandle),o.addEventListener("mouseout",this.eventHandle),o.addEventListener("touchstart",this.eventHandle),o.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const o=this.getElement();o.removeEventListener("click",this.onMapClick),o.removeEventListener("mousemove",this.eventHandle),o.removeEventListener("click",this.eventHandle),o.removeEventListener("mousedown",this.eventHandle),o.removeEventListener("mouseup",this.eventHandle),o.removeEventListener("dblclick",this.eventHandle),o.removeEventListener("contextmenu",this.eventHandle),o.removeEventListener("mouseover",this.eventHandle),o.removeEventListener("mouseout",this.eventHandle),o.removeEventListener("touchstart",this.eventHandle),o.removeEventListener("touchend",this.eventHandle)}polyfillEvent(o){!this.mapsService||this.mapsService.getType()!=="amap"||isPC()||(o.type==="touchstart"&&(this.touchStartTime=Date.now()),o.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:o,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(o){return null}onUp(o){throw new Error("Method not implemented.")}}const{merge:Fo}=Me.lodashUtil;class ko extends null{constructor(o){var f;super(),_defineProperty(this,"markers",[]),_defineProperty(this,"markerLayerOption",void 0),_defineProperty(this,"clusterIndex",void 0),_defineProperty(this,"points",[]),_defineProperty(this,"clusterMarkers",[]),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"zoom",void 0),_defineProperty(this,"bbox",void 0),_defineProperty(this,"inited",void 0),_defineProperty(this,"containerSize",void 0),this.markerLayerOption=Fo(this.getDefault(),o),bindAll(["update"],this),this.zoom=((f=this.markerLayerOption.clusterOption)===null||f===void 0?void 0:f.zoom)||-99}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}addTo(o){return this.scene=o,this.mapsService=o.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}setContainerSize(){if(!this.mapsService)return;const o=this.mapsService.getContainer();this.containerSize={containerWidth:(o==null?void 0:o.scrollWidth)||0,containerHeight:(o==null?void 0:o.scrollHeight)||0,bounds:this.mapsService.getBounds()}}getContainerSize(){return this.containerSize}addMarker(o){const f=this.markerLayerOption.cluster;if(o.getMarkerLayerContainerSize=this.getContainerSize.bind(this),f&&(this.addPoint(o,this.markers.length),this.mapsService)){const v=this.mapsService.getZoom(),T=this.mapsService.getBounds();this.bbox=padBounds(T,.5),this.zoom=Math.floor(v),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(o)}removeMarker(o){this.markers.indexOf(o);const f=this.markers.indexOf(o);f>-1&&(this.markers.splice(f,1),this.markerLayerOption.cluster&&(this.removePoint(f),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}hide(){this.markers.map(o=>{o.getElement().style.opacity="0"}),this.clusterMarkers.map(o=>{o.getElement().style.opacity="0"})}show(){this.markers.map(o=>{o.getElement().style.opacity="1"}),this.clusterMarkers.map(o=>{o.getElement().style.opacity="1"})}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}getOriginMarkers(){return this.markers}addMarkers(){this.getMarkers().forEach(o=>{o.addTo(this.scene)})}clear(){this.markers.forEach(o=>{o.remove()}),this.clusterMarkers.forEach(o=>{o.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}addPoint(o,f){const{lng:v,lat:T}=o.getLnglat(),O={geometry:{type:"Point",coordinates:[v,T]},properties:_objectSpread(_objectSpread({},o.getExtData()),{},{marker_id:f})};this.points.push(O),this.clusterIndex&&this.clusterIndex.load(this.points)}removePoint(o){const f=this.points.findIndex(v=>v.properties.marker_id===o);f>-1&&this.points.splice(f,1),this.clusterIndex&&this.clusterIndex.load(this.points)}initCluster(){if(!this.markerLayerOption.cluster)return;const{radius:o,minZoom:f=0,maxZoom:v}=this.markerLayerOption.clusterOption;this.clusterIndex=new Supercluster({radius:o,minZoom:f,maxZoom:v}),this.clusterIndex.load(this.points)}getClusterMarker(o,f){const v=o[0].concat(o[1]),T=this.clusterIndex.getClusters(v,f);this.clusterMarkers.forEach(O=>{O.remove()}),this.clusterMarkers=[],T.forEach(O=>{var L;const{field:F,method:H}=this.markerLayerOption.clusterOption;if((L=O.properties)!==null&&L!==void 0&&L.cluster_id){var ie;const Te=this.getLeaves((ie=O.properties)===null||ie===void 0?void 0:ie.cluster_id);if(O.properties.clusterData=Te,F&&H){const Ve=Te==null?void 0:Te.map(hr=>({[F]:hr.properties[F]})),Mt=Satistics.getColumn(Ve,F),rn=Satistics.getSatByColumn(H,Mt),Rn="point_"+H;O.properties[Rn]=rn.toFixed(2)}}const ge=this.clusterMarker(O);this.clusterMarkers.push(ge),ge.addTo(this.scene)})}getLeaves(o,f=1/0,v=0){return o?this.clusterIndex.getLeaves(o,f,v):null}clusterMarker(o){const f=this.markerLayerOption.clusterOption,{element:v=this.generateElement.bind(this)}=f;return new Marker({element:v(o)}).setLnglat({lng:o.geometry.coordinates[0],lat:o.geometry.coordinates[1]})}normalMarker(o){const f=o.properties.marker_id;return this.markers[f]}update(){if(!this.mapsService||this.markers.length===0)return;const o=this.mapsService.getZoom(),f=this.mapsService.getBounds();(!this.bbox||Math.abs(o-this.zoom)>=1||!boundsContains(this.bbox,f))&&(this.bbox=padBounds(f,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom))}generateElement(o){const f=DOM.create("div","l7-marker-cluster"),v=DOM.create("div","",f),T=DOM.create("span","",v),{field:O,method:L}=this.markerLayerOption.clusterOption;o.properties.point_count=o.properties.point_count||1;const F=O&&L?o.properties["point_"+L]||o.properties[O]:o.properties.point_count;return T.textContent=F,f}}var fa=D(4157),Bn=D(1413),qt=D(4942);class ua extends iu(){constructor(o){super(),(0,qt.Z)(this,"controlOption",void 0),(0,qt.Z)(this,"container",void 0),(0,qt.Z)(this,"isShow",void 0),(0,qt.Z)(this,"sceneContainer",void 0),(0,qt.Z)(this,"scene",void 0),(0,qt.Z)(this,"mapsService",void 0),(0,qt.Z)(this,"renderService",void 0),(0,qt.Z)(this,"layerService",void 0),(0,qt.Z)(this,"controlService",void 0),(0,qt.Z)(this,"configService",void 0),ua.controlCount++,this.controlOption=(0,Bn.Z)((0,Bn.Z)({},this.getDefault(o)),o||{})}getOptions(){return this.controlOption}setOptions(o){const f=this.getDefault(o);Object.entries(o).forEach(([v,T])=>{T===void 0&&(o[v]=f[v])}),"position"in o&&this.setPosition(o.position),"className"in o&&this.setClassName(o.className),"style"in o&&this.setStyle(o.style),this.controlOption=(0,Bn.Z)((0,Bn.Z)({},this.controlOption),o)}addTo(o){this.mapsService=o.mapService,this.renderService=o.rendererService,this.layerService=o.layerService,this.controlService=o.controlService,this.configService=o.globalConfigService,this.scene=o.sceneService,this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd(),Me.SO.addClass(this.container,"l7-control");const{className:f,style:v}=this.controlOption;return f&&this.setClassName(f),v&&this.setStyle(v),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;Me.SO.remove(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return Me.SO.create("div")}onRemove(){}show(){const o=this.container;Me.SO.removeClass(o,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const o=this.container;Me.SO.addClass(o,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(o){return{position:K.d.TOPRIGHT,name:`${ua.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(o){if(this.mapsService&&o&&o.screenX>0&&o.screenY>0){const f=this.mapsService.getContainer();f!==null&&f.focus()}}setPosition(o=K.d.TOPLEFT){const f=this.controlService;return f&&f.removeControl(this),this.controlOption.position=o,f&&f.addControl(this,this.sceneContainer),this}setClassName(o){const f=this.container,{className:v}=this.controlOption;v&&Me.SO.removeClass(f,v),o&&Me.SO.addClass(f,o)}setStyle(o){const f=this.container;o?f.setAttribute("style",o):f.removeAttribute("style")}insertContainer(){const o=this.controlOption.position,f=this.container;if(o instanceof Element)o.appendChild(f);else{const v=this.controlService.controlCorners[o];["bottomleft","bottomright","righttop","rightbottom"].includes(o)?v.insertBefore(f,v.firstChild):v.appendChild(f)}}checkUpdateOption(o,f){return f.some(v=>v in o)}}(0,qt.Z)(ua,"controlCount",0);class ra extends null{constructor(...o){super(...o),_defineProperty(this,"isDisable",!1),_defineProperty(this,"button",void 0),_defineProperty(this,"buttonText",void 0),_defineProperty(this,"buttonIcon",void 0)}setIsDisable(o){if(this.isDisable=o,o){var f;(f=this.button)===null||f===void 0||f.setAttribute("disabled","true")}else{var v;(v=this.button)===null||v===void 0||v.removeAttribute("disabled")}}createButton(o=""){return DOM.create("button",`l7-button-control ${o}`)}onAdd(){this.button=this.createButton(),this.isDisable=!1;const{title:o,btnText:f,btnIcon:v}=this.controlOption;return this.setBtnTitle(o),this.setBtnText(f),this.setBtnIcon(v),this.button}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}setOptions(o){const{title:f,btnText:v,btnIcon:T}=o;this.checkUpdateOption(o,["title"])&&this.setBtnTitle(f),this.checkUpdateOption(o,["btnIcon"])&&this.setBtnIcon(T),this.checkUpdateOption(o,["btnText"])&&this.setBtnText(v),super.setOptions(o)}setBtnTitle(o){var f;(f=this.button)===null||f===void 0||f.setAttribute("title",o!=null?o:"")}setBtnIcon(o){if(this.buttonIcon&&DOM.remove(this.buttonIcon),o){var f;const O=(f=this.button)===null||f===void 0?void 0:f.firstChild;if(O){var v;(v=this.button)===null||v===void 0||v.insertBefore(o,O)}else{var T;(T=this.button)===null||T===void 0||T.appendChild(o)}this.buttonIcon=o}}setBtnText(o){if(this.button)if(DOM.removeClass(this.button,"l7-button-control--row"),DOM.removeClass(this.button,"l7-button-control--column"),o){let v=this.buttonText;if(!v){var f;v=DOM.create("div","l7-button-control__text"),(f=this.button)===null||f===void 0||f.appendChild(v),this.buttonText=v}v.innerText=o,DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!o&&this.buttonText&&(DOM.remove(this.buttonText),this.buttonText=void 0)}}class Ho extends Wc.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(o,f){super(),(0,qt.Z)(this,"popperDOM",void 0),(0,qt.Z)(this,"contentDOM",void 0),(0,qt.Z)(this,"button",void 0),(0,qt.Z)(this,"option",void 0),(0,qt.Z)(this,"isShow",!1),(0,qt.Z)(this,"content",void 0),(0,qt.Z)(this,"timeout",null),(0,qt.Z)(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),Me.SO.removeClass(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&Ho.conflictPopperList.forEach(v=>{v!==this&&v.isShow&&v.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),(0,qt.Z)(this,"hide",()=>this.isShow?(Me.SO.addClass(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),(0,qt.Z)(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),(0,qt.Z)(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),(0,qt.Z)(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),(0,qt.Z)(this,"onPopperUnClick",v=>{Me.SO.findParentElement(v.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),(0,qt.Z)(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),(0,qt.Z)(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=o,this.option=f,this.init(),f.unique&&Ho.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(o){typeof o=="string"?this.contentDOM.innerHTML=o:o instanceof HTMLElement&&(Me.SO.clearChildren(this.contentDOM),this.contentDOM.appendChild(o)),this.content=o}init(){const{trigger:o}=this.option;this.popperDOM=this.createPopper(),o==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Me.SO.remove(this.popperDOM)}resetPopperPosition(){const o={},{container:f,offset:v=[0,0],placement:T}=this.option,[O,L]=v,F=this.button.getBoundingClientRect(),H=f.getBoundingClientRect(),{left:ie,right:ge,top:Te,bottom:Ve}=Me.SO.getDiffRect(F,H);let Mt=!1,rn=!1;/^(left|right)/.test(T)?(T.includes("left")?o.right=`${F.width+ge}px`:T.includes("right")&&(o.left=`${F.width+ie}px`),T.includes("start")?o.top=`${Te}px`:T.includes("end")?o.bottom=`${Ve}px`:(o.top=`${Te+F.height/2}px`,rn=!0,o.transform=`translate(${O}px, calc(${L}px - 50%))`)):/^(top|bottom)/.test(T)&&(T.includes("top")?o.bottom=`${F.height+Ve}px`:T.includes("bottom")&&(o.top=`${F.height+Te}px`),T.includes("start")?o.left=`${ie}px`:T.includes("end")?o.right=`${ge}px`:(o.left=`${ie+F.width/2}px`,Mt=!0,o.transform=`translate(calc(${O}px - 50%), ${L}px)`)),o.transform=`translate(calc(${O}px - ${Mt?"50%":"0%"}), calc(${L}px - ${rn?"50%":"0%"})`;const Rn=T.split("-");Rn.length&&Me.SO.addClass(this.popperDOM,Rn.map(hr=>`l7-popper-${hr}`).join(" ")),Me.SO.addStyle(this.popperDOM,Me.SO.css2Style(o))}createPopper(){const{container:o,className:f="",content:v}=this.option,T=Me.SO.create("div",`l7-popper l7-popper-hide ${f}`),O=Me.SO.create("div","l7-popper-content"),L=Me.SO.create("div","l7-popper-arrow");return T.appendChild(O),T.appendChild(L),o.appendChild(T),this.popperDOM=T,this.contentDOM=O,v&&this.setContent(v),T}}(0,qt.Z)(Ho,"conflictPopperList",[]);const _a={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class Vo extends null{constructor(...o){super(...o),_defineProperty(this,"popper",void 0)}getPopper(){return this.popper}hide(){this.popper.hide(),super.hide()}getDefault(o){var f;const v=super.getDefault(o),T=(f=o==null?void 0:o.position)!==null&&f!==void 0?f:v.position;return _objectSpread(_objectSpread({},super.getDefault(o)),{},{popperPlacement:T instanceof Element?"bottom":_a[T],popperTrigger:"click"})}onAdd(){const o=super.onAdd();return this.initPopper(),o}onRemove(){this.popper.destroy()}initPopper(){const{popperClassName:o,popperPlacement:f,popperTrigger:v}=this.controlOption,T=this.mapsService.getMapContainer();return this.popper=new Popper(this.button,{className:o,placement:f,trigger:v,container:T,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this)}).on("hide",()=>{this.emit("popperHide",this)}),this.popper}setOptions(o){if(super.setOptions(o),this.checkUpdateOption(o,["popperPlacement","popperTrigger","popperClassName"])){const f=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(f)}}}var Do=function(a){return a.ActiveOptionClassName="l7-select-control-item-active",a.OptionValueAttrKey="data-option-value",a.OptionIndexAttrKey="data-option-index",a}(Do||{});class hc extends null{constructor(...o){super(...o),_defineProperty(this,"selectValue",[]),_defineProperty(this,"optionDOMList",void 0),_defineProperty(this,"createNormalOption",f=>{const v=this.selectValue.includes(f.value),T=DOM.create("div",`l7-select-control-item ${v?Do.ActiveOptionClassName:""}`);this.getIsMultiple()?T.appendChild(this.createCheckbox(v)):T.appendChild(this.createRadio(v)),f.icon&&T.appendChild(f.icon);const O=DOM.create("span");return O.innerText=f.text,T.appendChild(O),T}),_defineProperty(this,"onItemClick",f=>{if(this.getIsMultiple()){const v=this.selectValue.findIndex(T=>T===f.value);v>-1?this.selectValue.splice(v,1):this.selectValue=[...this.selectValue,f.value]}else this.selectValue=[f.value];this.setSelectValue(this.selectValue)})}setOptions(o){super.setOptions(o);const{options:f}=o;f&&this.popper.setContent(this.getPopperContent(f))}onAdd(){const o=super.onAdd(),{defaultValue:f}=this.controlOption;return f&&(this.selectValue=this.transSelectValue(f)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),o}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}setSelectValue(o,f=!0){const v=this.transSelectValue(o);this.optionDOMList.forEach(T=>{const O=T.getAttribute(Do.OptionValueAttrKey),L=T.querySelector("input[type=checkbox]"),F=T.querySelector("input[type=radio]"),H=v.includes(O),ie=(ge,Te)=>{DOM.toggleClass(T,Do.ActiveOptionClassName,Te),ge&&DOM.setChecked(ge,Te)};ie(L,H),ie(F,H)}),this.selectValue=v,f&&this.emit("selectChange",this.getIsMultiple()?v:v[0])}getIsMultiple(){return!1}getPopperContent(o){const f=this.isImageOptions(),v=DOM.create("div",f?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&DOM.addClass(v,"l7-select-control--multiple");const T=o.map((O,L)=>{const F=f?this.createImageOption(O):this.createNormalOption(O);return F.setAttribute(Do.OptionValueAttrKey,O.value),F.setAttribute(Do.OptionIndexAttrKey,window.String(L)),F.addEventListener("click",this.onItemClick.bind(this,O)),F});return v.append(...T),this.optionDOMList=T,v}createImageOption(o){const f=this.selectValue.includes(o.value),v=DOM.create("div",`l7-select-control-item ${f?Do.ActiveOptionClassName:""}`),T=DOM.create("img");T.setAttribute("src",o.img),DOM.setUnDraggable(T),v.appendChild(T);const O=DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&v.appendChild(this.createCheckbox(f));const L=DOM.create("span");return L.innerText=o.text,O.appendChild(L),v.appendChild(O),v}createCheckbox(o){const f=DOM.create("input");return f.setAttribute("type","checkbox"),o&&DOM.setChecked(f,!0),f}createRadio(o){const f=DOM.create("input");return f.setAttribute("type","radio"),o&&DOM.setChecked(f,!0),f}isImageOptions(){return!!this.controlOption.options.find(o=>o.img)}transSelectValue(o){return Array.isArray(o)?o:[o]}}const vl=a=>{const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.classList.add("l7-iconfont"),o.setAttribute("aria-hidden","true");const f=document.createElementNS("http://www.w3.org/2000/svg","use");return f.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${a}`),o.appendChild(f),o};class Fc extends null{constructor(...o){var f;super(...o),f=this,_defineProperty(this,"onClick",_asyncToGenerator(function*(){const{onExport:v}=f.controlOption;v==null||v(yield f.getImage())})),_defineProperty(this,"mergeImage",_asyncToGenerator(function*(...v){var T,O;const{imageType:L}=f.controlOption,{width:F=0,height:H=0}=(T=(O=f.mapsService.getContainer())===null||O===void 0?void 0:O.getBoundingClientRect())!==null&&T!==void 0?T:{},ie=document.createElement("canvas");ie.width=F,ie.height=H;const ge=ie.getContext("2d");return(yield Promise.all(v.map(Ve=>new Promise(Mt=>{const rn=new Image;rn.onload=()=>{Mt(rn)},rn.src=Ve})))).forEach(Ve=>{ge==null||ge.drawImage(Ve,0,0,F,H)}),ie.toDataURL(`image/${L}`)}))}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),o}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:createL7Icon("l7-icon-export-picture"),imageType:"png"})}getImage(){var o=this;return _asyncToGenerator(function*(){const f=yield o.mapsService.exportMap("png"),v=yield o.scene.exportPng("png");return o.mergeImage(...[f,v].filter(T=>T))})()}}const Gl=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],bs=(()=>{if(typeof document=="undefined")return!1;const a=Gl[0],o={};for(const f of Gl)if((f==null?void 0:f[1])in document){for(const[T,O]of f.entries())o[a[T]]=O;return o}return!1})(),Qs={change:bs.fullscreenchange,error:bs.fullscreenerror};let ll={request(a=document.documentElement,o){return new Promise((f,v)=>{const T=()=>{ll.off("change",T),f()};ll.on("change",T);const O=a[bs.requestFullscreen](o);O instanceof Promise&&O.then(T).catch(v)})},exit(){return new Promise((a,o)=>{if(!ll.isFullscreen){a();return}const f=()=>{ll.off("change",f),a()};ll.on("change",f);const v=document[bs.exitFullscreen]();v instanceof Promise&&v.then(f).catch(o)})},toggle(a,o){return ll.isFullscreen?ll.exit():ll.request(a,o)},onchange(a){ll.on("change",a)},onerror(a){ll.on("error",a)},on(a,o){const f=Qs[a];f&&document.addEventListener(f,o,!1)},off(a,o){const f=Qs[a];f&&document.removeEventListener(f,o,!1)},raw:bs};Object.defineProperties(ll,{isFullscreen:{get:()=>!!document[bs.fullscreenElement]},element:{enumerable:!0,get:()=>{var a;return(a=document[bs.fullscreenElement])!==null&&a!==void 0?a:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[bs.fullscreenEnabled]}}),bs||(ll={isEnabled:!1});var gl=null;class _f extends null{constructor(o){var f;super(o),f=this,_defineProperty(this,"isFullscreen",!1),_defineProperty(this,"mapContainer",void 0),_defineProperty(this,"toggleFullscreen",_asyncToGenerator(function*(){ScreenFull.isEnabled&&(yield ScreenFull.toggle(f.mapContainer))})),_defineProperty(this,"onClick",()=>{this.toggleFullscreen()}),_defineProperty(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;const{btnText:v,btnIcon:T,title:O,exitBtnText:L,exitBtnIcon:F,exitTitle:H}=this.controlOption;this.isFullscreen?(this.setBtnTitle(H),this.setBtnText(L),this.setBtnIcon(F)):(this.setBtnTitle(O),this.setBtnText(v),this.setBtnIcon(T)),this.emit("fullscreenChange",this.isFullscreen)}),ScreenFull.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316")}setOptions(o){const{exitBtnText:f,exitBtnIcon:v,exitTitle:T}=o;this.isFullscreen&&(this.checkUpdateOption(o,["exitBtnIcon"])&&this.setBtnIcon(v),this.checkUpdateOption(o,["exitBtnText"])&&this.setBtnText(f),this.checkUpdateOption(o,["exitTitle"])&&this.setBtnTitle(T)),super.setOptions(o)}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),this.mapContainer=DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),o}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5168\u5C4F",btnIcon:createL7Icon("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:createL7Icon("l7-icon-exit-fullscreen")})}}class al extends null{constructor(o){var f;super(o),f=this,_defineProperty(this,"getGeoLocation",()=>new Promise((v,T)=>{window.navigator.geolocation.getCurrentPosition(({coords:O})=>{const{longitude:L,latitude:F}=O!=null?O:{};!isNaN(L)&&!isNaN(F)?v([L,F]):T()},O=>{T(O)})})),_defineProperty(this,"onClick",_asyncToGenerator(function*(){if(!window.navigator.geolocation)return;const{transform:v}=f.controlOption,T=yield f.getGeoLocation(),O=f.mapsService.getZoom();f.mapsService.setZoomAndCenter(O>15?O:15,v?yield v(T):T)})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D")}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5B9A\u4F4D",btnIcon:createL7Icon("l7-icon-reposition")})}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),o}}function sf(a){return Object.keys(a!=null?a:{}).every(o=>["layer","name","img"].includes(o))}class Vu extends null{constructor(...o){super(...o),_defineProperty(this,"onLayerChange",()=>{var f;(f=this.controlOption.layers)!==null&&f!==void 0&&f.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}))}),_defineProperty(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible())}),_defineProperty(this,"onSelectChange",()=>{this.layers.forEach(f=>{const v=this.selectValue.includes(f.name),T=f.isVisible();v&&!T&&f.show(),!v&&T&&f.hide()})})}get layers(){const o=this.layerService,{layers:f}=this.controlOption;if(Array.isArray(f)&&f.length){const v=[];return f.forEach(T=>{if(T instanceof Object&&(sf(T)?v.push(T.layer):v.push(T)),typeof T=="string"){const O=o.getLayer(T)||o.getLayerByName(T);O&&v.push(O)}}),v}return o.getLayers()||[]}getDefault(o){var f;return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:createL7Icon("l7-icon-layer"),options:[],multiple:(f=o==null?void 0:o.multiple)!==null&&f!==void 0?f:!0})}getLayerVisible(){return this.layers.filter(o=>o.isVisible()).map(o=>o.name)}getLayerOptions(){const{layers:o}=this.controlOption,f=o==null?void 0:o.every(v=>v.img);return o?o==null?void 0:o.map(v=>{if(sf(v))return{text:v.name||v.layer.name,value:v.layer.name,img:f?v.img:void 0};if(typeof v=="string"){const T=this.layerService.getLayer(v)||this.layerService.getLayerByName(v);return{text:T==null?void 0:T.name,value:T==null?void 0:T.name}}return{text:v.name,value:v.name}}):this.layers.map(v=>({text:v.name,value:v.name}))}setOptions(o){const f=this.checkUpdateOption(o,["layers","multiple"]);super.setOptions(o),f&&(this.controlOption.multiple===!1&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}handleSingleSelection(){this.layers.forEach((o,f)=>{f===0?o.show():o.hide()})}onAdd(){var o;return this.controlOption.multiple===!1&&this.handleSingleSelection(),(o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd()}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}getIsMultiple(){return this.controlOption.multiple}}class Vd extends ua{getDefault(){return{position:K.d.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const o=Me.SO.create("div","l7-control-logo");return this.setLogoContent(o),o}onRemove(){return null}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["img","href"])&&(Me.SO.clearChildren(this.container),this.setLogoContent(this.container))}setLogoContent(o){const{href:f,img:v}=this.controlOption,T=Me.SO.create("img");if(T.setAttribute("src",v),T.setAttribute("aria-label","AntV logo"),Me.SO.setUnDraggable(T),f){const O=Me.SO.create("a","l7-control-logo-link");O.target="_blank",O.href=f,O.rel="noopener nofollow",O.setAttribute("rel","noopener nofollow"),O.appendChild(T),o.appendChild(O)}else o.appendChild(T)}}const kf={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},Sh={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};class Hd extends null{constructor(...o){super(...o),_defineProperty(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0])})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:createL7Icon("l7-icon-color"),options:[]})}getStyleOptions(){const o=this.mapsService.getType()==="mapbox"?MapboxMapStyleConfig:GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([f,v])=>typeof v=="string"&&f!=="blank").map(([f,v])=>{var T;const{text:O,img:L}=(T=o[f])!==null&&T!==void 0?T:{};return{text:O!=null?O:f,value:v,img:L,key:f}})}getMapStyle(){return this.mapsService.getMapStyle()}onAdd(){var o;if((o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var f,v;const T=this.controlOption.defaultValue;this.controlOption.defaultValue=(f=(v=this.controlOption.options.find(O=>O.key===T))===null||v===void 0?void 0:v.value)!==null&&f!==void 0?f:T}else{const T=this.getMapStyle();T?this.controlOption.defaultValue=T:this.mapsService.map.once("styledata",()=>{const O=this.mapsService.getMapStyle();this.controlOption.defaultValue=O,this.setSelectValue(O,!1)})}return this.on("selectChange",this.onMapThemeChange),super.onAdd()}getIsMultiple(){return!1}}class $h extends null{constructor(...o){super(...o),_defineProperty(this,"location",[0,0]),_defineProperty(this,"onMouseMove",f=>{let v=this.location;const T=f.lngLat||f.lnglat,{transform:O}=this.controlOption;T&&(v=[T.lng,T.lat]),this.location=v,O&&(v=O(v)),this.insertLocation2HTML(v),this.emit("locationChange",v)})}getLocation(){return this.location}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{position:PositionType.BOTTOMLEFT,transform:([f,v])=>[+(+f).toFixed(6),+(+v).toFixed(6)]})}onAdd(){const o=DOM.create("div","l7-control-mouse-location");return o.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),o}onRemove(){this.mapsService.off("mousemove",this.onMouseMove)}insertLocation2HTML(o){this.container.innerText=o.join(", ")}}class bf extends null{constructor(...o){super(...o),_defineProperty(this,"mScale",void 0),_defineProperty(this,"iScale",void 0),_defineProperty(this,"update",()=>{const f=this.mapsService,{maxWidth:v}=this.controlOption,T=f.getSize()[1]/2,O=f.containerToLngLat([0,T]),L=f.containerToLngLat([v,T]),F=lnglatDistance([O.lng,O.lat],[L.lng,L.lat]);this.updateScales(F)})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{name:"scale",position:PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const f=DOM.create("div","l7-control-scale");this.resetScaleLines(f);const{updateWhenIdle:v}=this.controlOption;return this.mapsService.on(v?"moveend":"mapmove",this.update),this.mapsService.on(v?"zoomend":"zoomchange",this.update),f}onRemove(){const{updateWhenIdle:o}=this.controlOption;this.mapsService.off(o?"zoomend":"zoomchange",this.update),this.mapsService.off(o?"moveend":"mapmove",this.update)}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(o){const{metric:f,imperial:v}=this.controlOption;f&&o&&this.updateMetric(o),v&&o&&this.updateImperial(o)}resetScaleLines(o){DOM.clearChildren(o);const{metric:f,imperial:v,maxWidth:T,lockWidth:O}=this.controlOption;O&&DOM.addStyle(o,`width: ${T}px`),f&&(this.mScale=DOM.create("div","l7-control-scale-line",o)),v&&(this.iScale=DOM.create("div","l7-control-scale-line",o)),this.update()}updateScale(o,f,v){const{maxWidth:T}=this.controlOption;o.style.width=Math.round(T*v)+"px",o.innerHTML=f}getRoundNum(o){const f=Math.pow(10,(Math.floor(o)+"").length-1);let v=o/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}updateMetric(o){const f=this.getRoundNum(o),v=f<1e3?f+" m":f/1e3+" km";this.updateScale(this.mScale,v,f/o)}updateImperial(o){const f=o*3.2808399;let v,T,O;f>5280?(v=f/5280,T=this.getRoundNum(v),this.updateScale(this.iScale,T+" mi",T/v)):(O=this.getRoundNum(f),this.updateScale(this.iScale,O+" ft",O/f))}}var Ai=D(15861),hl=D(45987);class ba{constructor(){(0,qt.Z)(this,"mapService",void 0),(0,qt.Z)(this,"fontService",void 0)}apply(o,{styleAttributeService:f,mapService:v,fontService:T}){var O=this;this.mapService=v,this.fontService=T,o.hooks.init.tapPromise("DataMappingPlugin",(0,Ai.Z)(function*(){o.log(K.Or.MappingStart,K.KD.INIT),O.generateMaping(o,{styleAttributeService:f}),o.log(K.Or.MappingEnd,K.KD.INIT)})),o.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var L=(0,Ai.Z)(function*(F){if(!F)return F;o.dataState.dataMappingNeedUpdate=!1,o.log(K.Or.MappingStart,K.KD.UPDATE);const H=O.generateMaping(o,{styleAttributeService:f});return o.log(K.Or.MappingEnd,K.KD.UPDATE),H});return function(F){return L.apply(this,arguments)}}()),o.hooks.beforeRender.tap("DataMappingPlugin",()=>{const L=o.getSource();if(o.layerModelNeedUpdate||!L||!L.inited)return;const F=f.getLayerStyleAttributes()||[],H=f.getLayerStyleAttribute("filter"),{dataArray:ie}=L.data;if(Array.isArray(ie)&&ie.length===0)return;const ge=F.filter(Ve=>Ve.needRemapping);let Te=ie;if(H!=null&&H.needRemapping&&H!==null&&H!==void 0&&H.scale&&(Te=ie.filter(Ve=>this.applyAttributeMapping(H,Ve)[0])),ge.length){const Ve=this.mapping(o,ge,Te,o.getEncodedData());o.setEncodedData(Ve)}})}generateMaping(o,{styleAttributeService:f}){const v=f.getLayerStyleAttributes()||[],T=f.getLayerStyleAttribute("filter"),{dataArray:O}=o.getSource().data;let L=O;T!=null&&T.scale&&(L=O.filter(H=>this.applyAttributeMapping(T,H)[0])),L=o.processData(L);const F=this.mapping(o,v,L,void 0);return o.setEncodedData(F),o.emit("dataUpdate",null),!0}mapping(o,f,v,T){const O=f.filter(F=>F.scale!==void 0).filter(F=>F.name!=="filter"),L=v.map((F,H)=>{const ie=T?T[H]:{},ge=(0,Bn.Z)({id:F._id,coordinates:F.coordinates},ie);return O.forEach(Te=>{let Ve=this.applyAttributeMapping(Te,F);(Te.name==="color"||Te.name==="stroke")&&(Ve=Ve.map(Mt=>(0,Me.CI)(Mt))),ge[Te.name]=Array.isArray(Ve)&&Ve.length===1?Ve[0]:Ve,Te.name==="shape"&&(ge.shape=this.fontService.getIconFontKey(ge[Te.name]))}),ge});return f.forEach(F=>{F.needRemapping=!1}),this.adjustData2SimpleCoordinates(L),L}adjustData2SimpleCoordinates(o){o.length>0&&this.mapService.version==="SIMPLE"&&o.map(f=>{f.simpleCoordinate||(f.coordinates=this.unProjectCoordinates(f.coordinates),f.simpleCoordinate=!0)})}unProjectCoordinates(o){if(typeof o[0]=="number")return this.mapService.simpleMapCoord.unproject(o);if(o[0]&&o[0][0]instanceof Array){const f=[];return o.map(v=>{const T=[];v.map(O=>{T.push(this.mapService.simpleMapCoord.unproject(O))}),f.push(T)}),f}else{const f=[];return o.map(v=>{f.push(this.mapService.simpleMapCoord.unproject(v))}),f}}applyAttributeMapping(o,f){var v;if(!o.scale)return[];const T=(o==null||(v=o.scale)===null||v===void 0?void 0:v.scalers)||[],O=[];return T.forEach(({field:F})=>{var H;(f.hasOwnProperty(F)||((H=o.scale)===null||H===void 0?void 0:H.type)==="variable")&&O.push(f[F])}),o.mapping?o.mapping(O):[]}getArrowPoints(o,f){const v=[f[0]-o[0],f[1]-o[1]],T=(0,Me.Fv)(v);return[o[0]+T[0]*1e-4,o[1]+T[1]*1e-4]}}class xs{constructor(){(0,qt.Z)(this,"mapService",void 0)}apply(o){var f=this;this.mapService=o.getContainer().mapService,o.hooks.init.tapPromise("DataSourcePlugin",(0,Ai.Z)(function*(){o.log(K.Or.SourceInitStart,K.KD.INIT);let v=o.getSource();if(!v){const{data:T,options:O}=o.sourceOption||o.defaultSourceConfig;v=new Hi(T,O),o.setSource(v)}v.inited?(f.updateClusterData(o),o.log(K.Or.SourceInitEnd,K.KD.INIT)):yield new Promise(T=>{v.on("update",O=>{O.type==="inited"&&(f.updateClusterData(o),o.log(K.Or.SourceInitEnd,K.KD.INIT)),T(null)})})})),o.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,Ai.Z)(function*(){const v=f.updateClusterData(o),T=o.dataState.dataSourceNeedUpdate;return o.dataState.dataSourceNeedUpdate=!1,v||T}))}updateClusterData(o){if(o.isTileLayer||o.tileLayer||!o.getSource())return!1;const f=o.getSource(),v=f.cluster,{zoom:T=0}=f.clusterOptions,O=this.mapService.getZoom()-1,L=o.dataState.dataSourceNeedUpdate;return v&&L&&f.updateClusterData(Math.floor(O)),v&&Math.abs(o.clusterZoom-O)>=1?(T!==Math.floor(O)&&f.updateClusterData(Math.floor(O)),o.clusterZoom=O,!0):!1}}var Fl=D(64599),Hu=D.n(Fl);function No(a,o){var f,v;if(o===void 0){var T=Hu()(a),O;try{for(T.s();!(O=T.n()).done;){var L=O.value;L!=null&&(f===void 0?L>=L&&(f=v=L):(f>L&&(f=L),v<L&&(v=L)))}}catch(Te){T.e(Te)}finally{T.f()}}else{var F=-1,H=Hu()(a),ie;try{for(H.s();!(ie=H.n()).done;){var ge=ie.value;(ge=o(ge,++F,a))!=null&&(f===void 0?ge>=ge&&(f=v=ge):(f>ge&&(f=ge),v<ge&&(v=ge)))}}catch(Te){H.e(Te)}finally{H.f()}}return[f,v]}var kl=D(37620);function Xl(a,o,f,v,T){var O=a*a,L=O*a;return((1-3*a+3*O-L)*o+(4-6*O+3*L)*f+(1+3*a+3*O-3*L)*v+L*T)/6}function xf(a){var o=a.length-1;return function(f){var v=f<=0?f=0:f>=1?(f=1,o-1):Math.floor(f*o),T=a[v],O=a[v+1],L=v>0?a[v-1]:2*T-O,F=v<o-1?a[v+2]:2*O-T;return Xl((f-v/o)*o,L,T,O,F)}}function Zd(a){var o=a.length;return function(f){var v=Math.floor(((f%=1)<0?++f:f)*o),T=a[(v+o-1)%o],O=a[v%o],L=a[(v+1)%o],F=a[(v+2)%o];return Xl((f-v/o)*o,T,O,L,F)}}function lf(a){return function(){return a}}function Ep(a,o){return function(f){return a+f*o}}function Ad(a,o,f){return a=Math.pow(a,f),o=Math.pow(o,f)-a,f=1/f,function(v){return Math.pow(a+v*o,f)}}function Ls(a,o){var f=o-a;return f?Ep(a,f>180||f<-180?f-360*Math.round(f/360):f):constant(isNaN(a)?o:a)}function cf(a){return(a=+a)==1?lh:function(o,f){return f-o?Ad(o,f,a):lf(isNaN(o)?f:o)}}function lh(a,o){var f=o-a;return f?Ep(a,f):lf(isNaN(a)?o:a)}var D0=function a(o){var f=cf(o);function v(T,O){var L=f((T=(0,kl.B8)(T)).r,(O=(0,kl.B8)(O)).r),F=f(T.g,O.g),H=f(T.b,O.b),ie=lh(T.opacity,O.opacity);return function(ge){return T.r=L(ge),T.g=F(ge),T.b=H(ge),T.opacity=ie(ge),T+""}}return v.gamma=a,v}(1);function io(a){return function(o){var f=o.length,v=new Array(f),T=new Array(f),O=new Array(f),L,F;for(L=0;L<f;++L)F=(0,kl.B8)(o[L]),v[L]=F.r||0,T[L]=F.g||0,O[L]=F.b||0;return v=a(v),T=a(T),O=a(O),F.opacity=1,function(H){return F.r=v(H),F.g=T(H),F.b=O(H),F+""}}}var gu=io(xf),ey=io(Zd);function lm(a,o){return a<o?-1:a>o?1:a>=o?0:NaN}function Sp(a){return a.length===1&&(a=ty(a)),{left:function(o,f,v,T){for(v==null&&(v=0),T==null&&(T=o.length);v<T;){var O=v+T>>>1;a(o[O],f)<0?v=O+1:T=O}return v},right:function(o,f,v,T){for(v==null&&(v=0),T==null&&(T=o.length);v<T;){var O=v+T>>>1;a(o[O],f)>0?T=O:v=O+1}return v}}}function ty(a){return function(o,f){return lm(a(o),f)}}var Gv=Sp(lm),ny=Gv.right,cm=Gv.left,um=ny,N0=Array.prototype,ry=N0.slice,Tp=N0.map,wp=Math.sqrt(50),ev=Math.sqrt(10),tv=Math.sqrt(2);function iy(a,o,f){var v,T=-1,O,L,F;if(o=+o,a=+a,f=+f,a===o&&f>0)return[a];if((v=o<a)&&(O=a,a=o,o=O),(F=Wd(a,o,f))===0||!isFinite(F))return[];if(F>0)for(a=Math.ceil(a/F),o=Math.floor(o/F),L=new Array(O=Math.ceil(o-a+1));++T<O;)L[T]=(a+T)*F;else for(a=Math.floor(a*F),o=Math.ceil(o*F),L=new Array(O=Math.ceil(a-o+1));++T<O;)L[T]=(a-T)/F;return v&&L.reverse(),L}function Wd(a,o,f){var v=(o-a)/Math.max(0,f),T=Math.floor(Math.log(v)/Math.LN10),O=v/Math.pow(10,T);return T>=0?(O>=wp?10:O>=ev?5:O>=tv?2:1)*Math.pow(10,T):-Math.pow(10,-T)/(O>=wp?10:O>=ev?5:O>=tv?2:1)}function t0(a,o,f){var v=Math.abs(o-a)/Math.max(0,f),T=Math.pow(10,Math.floor(Math.log(v)/Math.LN10)),O=v/T;return O>=wp?T*=10:O>=ev?T*=5:O>=tv&&(T*=2),o<a?-T:T}function Kh(){var a=identity,o=extent,f=sturges;function v(T){var O,L=T.length,F,H=new Array(L);for(O=0;O<L;++O)H[O]=a(T[O],O,T);var ie=o(H),ge=ie[0],Te=ie[1],Ve=f(H,ge,Te);Array.isArray(Ve)||(Ve=tickStep(ge,Te,Ve),Ve=range(Math.ceil(ge/Ve)*Ve,Te,Ve));for(var Mt=Ve.length;Ve[0]<=ge;)Ve.shift(),--Mt;for(;Ve[Mt-1]>Te;)Ve.pop(),--Mt;var rn=new Array(Mt+1),Rn;for(O=0;O<=Mt;++O)Rn=rn[O]=[],Rn.x0=O>0?Ve[O-1]:ge,Rn.x1=O<Mt?Ve[O]:Te;for(O=0;O<L;++O)F=H[O],ge<=F&&F<=Te&&rn[bisect(Ve,F,0,Mt)].push(T[O]);return rn}return v.value=function(T){return arguments.length?(a=typeof T=="function"?T:constant(T),v):a},v.domain=function(T){return arguments.length?(o=typeof T=="function"?T:constant([T[0],T[1]]),v):o},v.thresholds=function(T){return arguments.length?(f=typeof T=="function"?T:Array.isArray(T)?constant(slice.call(T)):constant(T),v):f},v}function nv(a,o,f){return a=map.call(a,number).sort(ascending),Math.ceil((f-o)/(2*(quantile(a,.75)-quantile(a,.25))*Math.pow(a.length,-1/3)))}function qh(a){return a===null?NaN:+a}function B0(a,o,f){if(f==null&&(f=qh),!!(v=a.length)){if((o=+o)<=0||v<2)return+f(a[0],0,a);if(o>=1)return+f(a[v-1],v-1,a);var v,T=(v-1)*o,O=Math.floor(T),L=+f(a[O],O,a),F=+f(a[O+1],O+1,a);return L+(F-L)*(T-O)}}var Yc="$";function Ap(){}Ap.prototype=Js.prototype={constructor:Ap,has:function(a){return Yc+a in this},get:function(a){return this[Yc+a]},set:function(a,o){return this[Yc+a]=o,this},remove:function(a){var o=Yc+a;return o in this&&delete this[o]},clear:function(){for(var a in this)a[0]===Yc&&delete this[a]},keys:function(){var a=[];for(var o in this)o[0]===Yc&&a.push(o.slice(1));return a},values:function(){var a=[];for(var o in this)o[0]===Yc&&a.push(this[o]);return a},entries:function(){var a=[];for(var o in this)o[0]===Yc&&a.push({key:o.slice(1),value:this[o]});return a},size:function(){var a=0;for(var o in this)o[0]===Yc&&++a;return a},empty:function(){for(var a in this)if(a[0]===Yc)return!1;return!0},each:function(a){for(var o in this)o[0]===Yc&&a(this[o],o.slice(1),this)}};function Js(a,o){var f=new Ap;if(a instanceof Ap)a.each(function(F,H){f.set(H,F)});else if(Array.isArray(a)){var v=-1,T=a.length,O;if(o==null)for(;++v<T;)f.set(v,a[v]);else for(;++v<T;)f.set(o(O=a[v],v,a),O)}else if(a)for(var L in a)f.set(L,a[L]);return f}var Ef=Js;function F0(){var a=[],o=[],f,v,T;function O(F,H,ie,ge){if(H>=a.length)return f!=null&&F.sort(f),v!=null?v(F):F;for(var Te=-1,Ve=F.length,Mt=a[H++],rn,Rn,hr=map(),Nr,jn=ie();++Te<Ve;)(Nr=hr.get(rn=Mt(Rn=F[Te])+""))?Nr.push(Rn):hr.set(rn,[Rn]);return hr.each(function(ci,ji){ge(jn,ji,O(ci,H,ie,ge))}),jn}function L(F,H){if(++H>a.length)return F;var ie,ge=o[H-1];return v!=null&&H>=a.length?ie=F.entries():(ie=[],F.each(function(Te,Ve){ie.push({key:Ve,values:L(Te,H)})})),ge!=null?ie.sort(function(Te,Ve){return ge(Te.key,Ve.key)}):ie}return T={object:function(F){return O(F,0,Gd,Cp)},map:function(F){return O(F,0,dc,Xd)},entries:function(F){return L(O(F,0,dc,Xd),0)},key:function(F){return a.push(F),T},sortKeys:function(F){return o[a.length-1]=F,T},sortValues:function(F){return f=F,T},rollup:function(F){return v=F,T}}}function Gd(){return{}}function Cp(a,o,f){a[o]=f}function dc(){return map()}function Xd(a,o,f){a.set(o,f)}function Qh(){}var yl=Ef.prototype;Qh.prototype=Op.prototype={constructor:Qh,has:yl.has,add:function(a){return a+="",this[Yc+a]=a,this},remove:yl.remove,clear:yl.clear,values:yl.keys,size:yl.size,empty:yl.empty,each:yl.each};function Op(a,o){var f=new Qh;if(a instanceof Qh)a.each(function(O){f.add(O)});else if(a){var v=-1,T=a.length;if(o==null)for(;++v<T;)f.add(a[v]);else for(;++v<T;)f.add(o(a[v],v,a))}return f}var n0=null,fm=Array.prototype,Th=fm.map,su=fm.slice;function yu(a,o){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(o).domain(a);break}return this}function r0(a,o){switch(arguments.length){case 0:break;case 1:this.interpolator(a);break;default:this.interpolator(o).domain(a);break}return this}var i0={name:"implicit"};function Rp(){var a=Ef(),o=[],f=[],v=i0;function T(O){var L=O+"",F=a.get(L);if(!F){if(v!==i0)return v;a.set(L,F=o.push(O))}return f[(F-1)%f.length]}return T.domain=function(O){if(!arguments.length)return o.slice();o=[],a=Ef();for(var L=-1,F=O.length,H,ie;++L<F;)a.has(ie=(H=O[L])+"")||a.set(ie,o.push(H));return T},T.range=function(O){return arguments.length?(f=su.call(O),T):f.slice()},T.unknown=function(O){return arguments.length?(v=O,T):v},T.copy=function(){return Rp(o,f).unknown(v)},yu.apply(T,arguments),T}function Sf(){var a=ordinal().unknown(void 0),o=a.domain,f=a.range,v=[0,1],T,O,L=!1,F=0,H=0,ie=.5;delete a.unknown;function ge(){var Te=o().length,Ve=v[1]<v[0],Mt=v[Ve-0],rn=v[1-Ve];T=(rn-Mt)/Math.max(1,Te-F+H*2),L&&(T=Math.floor(T)),Mt+=(rn-Mt-T*(Te-F))*ie,O=T*(1-F),L&&(Mt=Math.round(Mt),O=Math.round(O));var Rn=sequence(Te).map(function(hr){return Mt+T*hr});return f(Ve?Rn.reverse():Rn)}return a.domain=function(Te){return arguments.length?(o(Te),ge()):o()},a.range=function(Te){return arguments.length?(v=[+Te[0],+Te[1]],ge()):v.slice()},a.rangeRound=function(Te){return v=[+Te[0],+Te[1]],L=!0,ge()},a.bandwidth=function(){return O},a.step=function(){return T},a.round=function(Te){return arguments.length?(L=!!Te,ge()):L},a.padding=function(Te){return arguments.length?(F=Math.min(1,H=+Te),ge()):F},a.paddingInner=function(Te){return arguments.length?(F=Math.min(1,Te),ge()):F},a.paddingOuter=function(Te){return arguments.length?(H=+Te,ge()):H},a.align=function(Te){return arguments.length?(ie=Math.max(0,Math.min(1,Te)),ge()):ie},a.copy=function(){return Sf(o(),v).round(L).paddingInner(F).paddingOuter(H).align(ie)},initRange.apply(ge(),arguments)}function Cd(a){var o=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return Cd(o())},a}function oy(){return Cd(Sf.apply(null,arguments).paddingInner(1))}function ay(a,o){return(isNumberArray(o)?numberArray:rv)(a,o)}function rv(a,o){var f=o?o.length:0,v=a?Math.min(f,a.length):0,T=new Array(v),O=new Array(f),L;for(L=0;L<v;++L)T[L]=Mp(a[L],o[L]);for(;L<f;++L)O[L]=o[L];return function(F){for(L=0;L<v;++L)O[L]=T[L](F);return O}}function k0(a,o){var f=new Date;return a=+a,o=+o,function(v){return f.setTime(a*(1-v)+o*v),f}}function Jh(a,o){return a=+a,o=+o,function(f){return a*(1-f)+o*f}}function hm(a,o){var f={},v={},T;(a===null||typeof a!="object")&&(a={}),(o===null||typeof o!="object")&&(o={});for(T in o)T in a?f[T]=Mp(a[T],o[T]):v[T]=o[T];return function(O){for(T in f)v[T]=f[T](O);return v}}var zf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,o0=new RegExp(zf.source,"g");function Yd(a){return function(){return a}}function $d(a){return function(o){return a(o)+""}}function iv(a,o){var f=zf.lastIndex=o0.lastIndex=0,v,T,O,L=-1,F=[],H=[];for(a=a+"",o=o+"";(v=zf.exec(a))&&(T=o0.exec(o));)(O=T.index)>f&&(O=o.slice(f,O),F[L]?F[L]+=O:F[++L]=O),(v=v[0])===(T=T[0])?F[L]?F[L]+=T:F[++L]=T:(F[++L]=null,H.push({i:L,x:Jh(v,T)})),f=o0.lastIndex;return f<o.length&&(O=o.slice(f),F[L]?F[L]+=O:F[++L]=O),F.length<2?H[0]?$d(H[0].x):Yd(o):(o=H.length,function(ie){for(var ge=0,Te;ge<o;++ge)F[(Te=H[ge]).i]=Te.x(ie);return F.join("")})}function wh(a,o){o||(o=[]);var f=a?Math.min(o.length,a.length):0,v=o.slice(),T;return function(O){for(T=0;T<f;++T)v[T]=a[T]*(1-O)+o[T]*O;return v}}function a0(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function Mp(a,o){var f=typeof o,v;return o==null||f==="boolean"?lf(o):(f==="number"?Jh:f==="string"?(v=(0,kl.ZP)(o))?(o=v,D0):iv:o instanceof kl.ZP?D0:o instanceof Date?k0:a0(o)?wh:Array.isArray(o)?rv:typeof o.valueOf!="function"&&typeof o.toString!="function"||isNaN(o)?hm:Jh)(a,o)}function _u(a,o){return a=+a,o=+o,function(f){return Math.round(a*(1-f)+o*f)}}function lu(a){return function(){return a}}function pc(a){return+a}var Zu=[0,1];function bu(a){return a}function Pp(a,o){return(o-=a=+a)?function(f){return(f-a)/o}:lu(isNaN(o)?NaN:.5)}function dm(a){var o=a[0],f=a[a.length-1],v;return o>f&&(v=o,o=f,f=v),function(T){return Math.max(o,Math.min(f,T))}}function A1(a,o,f){var v=a[0],T=a[1],O=o[0],L=o[1];return T<v?(v=Pp(T,v),O=f(L,O)):(v=Pp(v,T),O=f(O,L)),function(F){return O(v(F))}}function Xv(a,o,f){var v=Math.min(a.length,o.length)-1,T=new Array(v),O=new Array(v),L=-1;for(a[v]<a[0]&&(a=a.slice().reverse(),o=o.slice().reverse());++L<v;)T[L]=Pp(a[L],a[L+1]),O[L]=f(o[L],o[L+1]);return function(F){var H=um(a,F,1,v)-1;return O[H](T[H](F))}}function z0(a,o){return o.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function U0(){var a=Zu,o=Zu,f=Mp,v,T,O,L=bu,F,H,ie;function ge(){return F=Math.min(a.length,o.length)>2?Xv:A1,H=ie=null,Te}function Te(Ve){return isNaN(Ve=+Ve)?O:(H||(H=F(a.map(v),o,f)))(v(L(Ve)))}return Te.invert=function(Ve){return L(T((ie||(ie=F(o,a.map(v),Jh)))(Ve)))},Te.domain=function(Ve){return arguments.length?(a=Th.call(Ve,pc),L===bu||(L=dm(a)),ge()):a.slice()},Te.range=function(Ve){return arguments.length?(o=su.call(Ve),ge()):o.slice()},Te.rangeRound=function(Ve){return o=su.call(Ve),f=_u,ge()},Te.clamp=function(Ve){return arguments.length?(L=Ve?dm(a):bu,Te):L!==bu},Te.interpolate=function(Ve){return arguments.length?(f=Ve,ge()):f},Te.unknown=function(Ve){return arguments.length?(O=Ve,Te):O},function(Ve,Mt){return v=Ve,T=Mt,ge()}}function ov(a,o){return U0()(a,o)}var cu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pm(a){if(!(o=cu.exec(a)))throw new Error("invalid format: "+a);var o;return new Cl({fill:o[1],align:o[2],sign:o[3],symbol:o[4],zero:o[5],width:o[6],comma:o[7],precision:o[8]&&o[8].slice(1),trim:o[9],type:o[10]})}pm.prototype=Cl.prototype;function Cl(a){this.fill=a.fill===void 0?" ":a.fill+"",this.align=a.align===void 0?">":a.align+"",this.sign=a.sign===void 0?"-":a.sign+"",this.symbol=a.symbol===void 0?"":a.symbol+"",this.zero=!!a.zero,this.width=a.width===void 0?void 0:+a.width,this.comma=!!a.comma,this.precision=a.precision===void 0?void 0:+a.precision,this.trim=!!a.trim,this.type=a.type===void 0?"":a.type+""}Cl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Wu(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)}function Ah(a,o){if((f=(a=o?a.toExponential(o-1):a.toExponential()).indexOf("e"))<0)return null;var f,v=a.slice(0,f);return[v.length>1?v[0]+v.slice(2):v,+a.slice(f+1)]}function Ch(a){return a=Ah(Math.abs(a)),a?a[1]:NaN}function av(a,o){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ch(o)/3)))*3-Ch(Math.abs(a)))}function Yv(a,o){return function(f,v){for(var T=f.length,O=[],L=0,F=a[0],H=0;T>0&&F>0&&(H+F+1>v&&(F=Math.max(1,v-H)),O.push(f.substring(T-=F,T+F)),!((H+=F+1)>v));)F=a[L=(L+1)%a.length];return O.reverse().join(o)}}function $v(a){return function(o){return o.replace(/[0-9]/g,function(f){return a[+f]})}}function Kv(a){e:for(var o=a.length,f=1,v=-1,T;f<o;++f)switch(a[f]){case".":v=T=f;break;case"0":v===0&&(v=f),T=f;break;default:if(!+a[f])break e;v>0&&(v=0);break}return v>0?a.slice(0,v)+a.slice(T+1):a}var Fe;function Qt(a,o){var f=Ah(a,o);if(!f)return a+"";var v=f[0],T=f[1],O=T-(Fe=Math.max(-8,Math.min(8,Math.floor(T/3)))*3)+1,L=v.length;return O===L?v:O>L?v+new Array(O-L+1).join("0"):O>0?v.slice(0,O)+"."+v.slice(O):"0."+new Array(1-O).join("0")+Ah(a,Math.max(0,o+O-1))[0]}function On(a,o){var f=Ah(a,o);if(!f)return a+"";var v=f[0],T=f[1];return T<0?"0."+new Array(-T).join("0")+v:v.length>T+1?v.slice(0,T+1)+"."+v.slice(T+1):v+new Array(T-v.length+2).join("0")}var Or={"%":function(a,o){return(a*100).toFixed(o)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:Wu,e:function(a,o){return a.toExponential(o)},f:function(a,o){return a.toFixed(o)},g:function(a,o){return a.toPrecision(o)},o:function(a){return Math.round(a).toString(8)},p:function(a,o){return On(a*100,o)},r:On,s:Qt,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function Wr(a){return a}var Rr=Array.prototype.map,_r=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Ti(a){var o=a.grouping===void 0||a.thousands===void 0?Wr:Yv(Rr.call(a.grouping,Number),a.thousands+""),f=a.currency===void 0?"":a.currency[0]+"",v=a.currency===void 0?"":a.currency[1]+"",T=a.decimal===void 0?".":a.decimal+"",O=a.numerals===void 0?Wr:$v(Rr.call(a.numerals,String)),L=a.percent===void 0?"%":a.percent+"",F=a.minus===void 0?"-":a.minus+"",H=a.nan===void 0?"NaN":a.nan+"";function ie(Te){Te=pm(Te);var Ve=Te.fill,Mt=Te.align,rn=Te.sign,Rn=Te.symbol,hr=Te.zero,Nr=Te.width,jn=Te.comma,ci=Te.precision,ji=Te.trim,To=Te.type;To==="n"?(jn=!0,To="g"):Or[To]||(ci===void 0&&(ci=12),ji=!0,To="g"),(hr||Ve==="0"&&Mt==="=")&&(hr=!0,Ve="0",Mt="=");var Ji=Rn==="$"?f:Rn==="#"&&/[boxX]/.test(To)?"0"+To.toLowerCase():"",Hr=Rn==="$"?v:/[%p]/.test(To)?L:"",Gi=Or[To],ja=/[defgprs%]/.test(To);ci=ci===void 0?6:/[gprs]/.test(To)?Math.max(1,Math.min(21,ci)):Math.max(0,Math.min(20,ci));function ys($o){var cs=Ji,Zs=Hr,Dh,Id,Nh;if(To==="c")Zs=Gi($o)+Zs,$o="";else{$o=+$o;var cl=$o<0||1/$o<0;if($o=isNaN($o)?H:Gi(Math.abs($o),ci),ji&&($o=Kv($o)),cl&&+$o==0&&rn!=="+"&&(cl=!1),cs=(cl?rn==="("?rn:F:rn==="-"||rn==="("?"":rn)+cs,Zs=(To==="s"?_r[8+Fe/3]:"")+Zs+(cl&&rn==="("?")":""),ja){for(Dh=-1,Id=$o.length;++Dh<Id;)if(Nh=$o.charCodeAt(Dh),48>Nh||Nh>57){Zs=(Nh===46?T+$o.slice(Dh+1):$o.slice(Dh))+Zs,$o=$o.slice(0,Dh);break}}}jn&&!hr&&($o=o($o,1/0));var J0=cs.length+$o.length+Zs.length,Wf=J0<Nr?new Array(Nr-J0+1).join(Ve):"";switch(jn&&hr&&($o=o(Wf+$o,Wf.length?Nr-Zs.length:1/0),Wf=""),Mt){case"<":$o=cs+$o+Zs+Wf;break;case"=":$o=cs+Wf+$o+Zs;break;case"^":$o=Wf.slice(0,J0=Wf.length>>1)+cs+$o+Zs+Wf.slice(J0);break;default:$o=Wf+cs+$o+Zs;break}return O($o)}return ys.toString=function(){return Te+""},ys}function ge(Te,Ve){var Mt=ie((Te=pm(Te),Te.type="f",Te)),rn=Math.max(-8,Math.min(8,Math.floor(Ch(Ve)/3)))*3,Rn=Math.pow(10,-rn),hr=_r[8+rn/3];return function(Nr){return Mt(Rn*Nr)+hr}}return{format:ie,formatPrefix:ge}}var li,Fi,Ri;Di({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Di(a){return li=Ti(a),Fi=li.format,Ri=li.formatPrefix,li}function Xi(a,o){return a=Math.abs(a),o=Math.abs(o)-a,Math.max(0,Ch(o)-Ch(a))+1}function pi(a){return Math.max(0,-Ch(Math.abs(a)))}function Ni(a,o,f,v){var T=t0(a,o,f),O;switch(v=pm(v==null?",f":v),v.type){case"s":{var L=Math.max(Math.abs(a),Math.abs(o));return v.precision==null&&!isNaN(O=av(T,L))&&(v.precision=O),Ri(v,L)}case"":case"e":case"g":case"p":case"r":{v.precision==null&&!isNaN(O=Xi(T,Math.max(Math.abs(a),Math.abs(o))))&&(v.precision=O-(v.type==="e"));break}case"f":case"%":{v.precision==null&&!isNaN(O=pi(T))&&(v.precision=O-(v.type==="%")*2);break}}return Fi(v)}function pr(a){var o=a.domain;return a.ticks=function(f){var v=o();return iy(v[0],v[v.length-1],f==null?10:f)},a.tickFormat=function(f,v){var T=o();return Ni(T[0],T[T.length-1],f==null?10:f,v)},a.nice=function(f){f==null&&(f=10);var v=o(),T=0,O=v.length-1,L=v[T],F=v[O],H;return F<L&&(H=L,L=F,F=H,H=T,T=O,O=H),H=Wd(L,F,f),H>0?(L=Math.floor(L/H)*H,F=Math.ceil(F/H)*H,H=Wd(L,F,f)):H<0&&(L=Math.ceil(L*H)/H,F=Math.floor(F*H)/H,H=Wd(L,F,f)),H>0?(v[T]=Math.floor(L/H)*H,v[O]=Math.ceil(F/H)*H,o(v)):H<0&&(v[T]=Math.ceil(L*H)/H,v[O]=Math.floor(F*H)/H,o(v)),a},a}function Lr(){var a=ov(bu,bu);return a.copy=function(){return z0(a,Lr())},yu.apply(a,arguments),pr(a)}function yi(a){var o;function f(v){return isNaN(v=+v)?o:v}return f.invert=f,f.domain=f.range=function(v){return arguments.length?(a=map.call(v,number),f):a.slice()},f.unknown=function(v){return arguments.length?(o=v,f):o},f.copy=function(){return yi(a).unknown(o)},a=arguments.length?map.call(a,number):[0,1],linearish(f)}function eo(a,o){a=a.slice();var f=0,v=a.length-1,T=a[f],O=a[v],L;return O<T&&(L=f,f=v,v=L,L=T,T=O,O=L),a[f]=o.floor(T),a[v]=o.ceil(O),a}function ii(a){return Math.log(a)}function oo(a){return Math.exp(a)}function xi(a){return-Math.log(-a)}function to(a){return-Math.exp(-a)}function si(a){return isFinite(a)?+("1e"+a):a<0?0:a}function Yi(a){return a===10?si:a===Math.E?Math.exp:function(o){return Math.pow(a,o)}}function Bo(a){return a===Math.E?Math.log:a===10&&Math.log10||a===2&&Math.log2||(a=Math.log(a),function(o){return Math.log(o)/a})}function ha(a){return function(o){return-a(-o)}}function Ki(a){var o=a(ii,oo),f=o.domain,v=10,T,O;function L(){return T=Bo(v),O=Yi(v),f()[0]<0?(T=ha(T),O=ha(O),a(xi,to)):a(ii,oo),o}return o.base=function(F){return arguments.length?(v=+F,L()):v},o.domain=function(F){return arguments.length?(f(F),L()):f()},o.ticks=function(F){var H=f(),ie=H[0],ge=H[H.length-1],Te;(Te=ge<ie)&&(Ve=ie,ie=ge,ge=Ve);var Ve=T(ie),Mt=T(ge),rn,Rn,hr,Nr=F==null?10:+F,jn=[];if(!(v%1)&&Mt-Ve<Nr){if(Ve=Math.round(Ve)-1,Mt=Math.round(Mt)+1,ie>0){for(;Ve<Mt;++Ve)for(Rn=1,rn=O(Ve);Rn<v;++Rn)if(hr=rn*Rn,!(hr<ie)){if(hr>ge)break;jn.push(hr)}}else for(;Ve<Mt;++Ve)for(Rn=v-1,rn=O(Ve);Rn>=1;--Rn)if(hr=rn*Rn,!(hr<ie)){if(hr>ge)break;jn.push(hr)}}else jn=iy(Ve,Mt,Math.min(Mt-Ve,Nr)).map(O);return Te?jn.reverse():jn},o.tickFormat=function(F,H){if(H==null&&(H=v===10?".0e":","),typeof H!="function"&&(H=Fi(H)),F===1/0)return H;F==null&&(F=10);var ie=Math.max(1,v*F/o.ticks().length);return function(ge){var Te=ge/O(Math.round(T(ge)));return Te*v<v-.5&&(Te*=v),Te<=ie?H(ge):""}},o.nice=function(){return f(eo(f(),{floor:function(F){return O(Math.floor(T(F)))},ceil:function(F){return O(Math.ceil(T(F)))}}))},o}function Ei(){var a=Ki(U0()).domain([1,10]);return a.copy=function(){return z0(a,Ei()).base(a.base())},yu.apply(a,arguments),a}function $r(a){return function(o){return Math.sign(o)*Math.log1p(Math.abs(o/a))}}function zo(a){return function(o){return Math.sign(o)*Math.expm1(Math.abs(o))*a}}function Ua(a){var o=1,f=a($r(o),zo(o));return f.constant=function(v){return arguments.length?a($r(o=+v),zo(o)):o},linearish(f)}function co(){var a=Ua(transformer());return a.copy=function(){return copy(a,co()).constant(a.constant())},initRange.apply(a,arguments)}function Da(a){return function(o){return o<0?-Math.pow(-o,a):Math.pow(o,a)}}function da(a){return a<0?-Math.sqrt(-a):Math.sqrt(a)}function Jo(a){return a<0?-a*a:a*a}function vs(a){var o=a(bu,bu),f=1;function v(){return f===1?a(bu,bu):f===.5?a(da,Jo):a(Da(f),Da(1/f))}return o.exponent=function(T){return arguments.length?(f=+T,v()):f},pr(o)}function _l(){var a=vs(U0());return a.copy=function(){return z0(a,_l()).exponent(a.exponent())},yu.apply(a,arguments),a}function $c(){return _l.apply(null,arguments).exponent(.5)}function Ga(){var a=[],o=[],f=[],v;function T(){var L=0,F=Math.max(1,o.length);for(f=new Array(F-1);++L<F;)f[L-1]=B0(a,L/F);return O}function O(L){return isNaN(L=+L)?v:o[um(f,L)]}return O.invertExtent=function(L){var F=o.indexOf(L);return F<0?[NaN,NaN]:[F>0?f[F-1]:a[0],F<f.length?f[F]:a[a.length-1]]},O.domain=function(L){if(!arguments.length)return a.slice();a=[];for(var F=0,H=L.length,ie;F<H;++F)ie=L[F],ie!=null&&!isNaN(ie=+ie)&&a.push(ie);return a.sort(lm),T()},O.range=function(L){return arguments.length?(o=su.call(L),T()):o.slice()},O.unknown=function(L){return arguments.length?(v=L,O):v},O.quantiles=function(){return f.slice()},O.copy=function(){return Ga().domain(a).range(o).unknown(v)},yu.apply(O,arguments)}function dl(){var a=0,o=1,f=1,v=[.5],T=[0,1],O;function L(H){return H<=H?T[um(v,H,0,f)]:O}function F(){var H=-1;for(v=new Array(f);++H<f;)v[H]=((H+1)*o-(H-f)*a)/(f+1);return L}return L.domain=function(H){return arguments.length?(a=+H[0],o=+H[1],F()):[a,o]},L.range=function(H){return arguments.length?(f=(T=su.call(H)).length-1,F()):T.slice()},L.invertExtent=function(H){var ie=T.indexOf(H);return ie<0?[NaN,NaN]:ie<1?[a,v[0]]:ie>=f?[v[f-1],o]:[v[ie-1],v[ie]]},L.unknown=function(H){return arguments.length&&(O=H),L},L.thresholds=function(){return v.slice()},L.copy=function(){return dl().domain([a,o]).range(T).unknown(O)},yu.apply(pr(L),arguments)}function el(){var a=[.5],o=[0,1],f,v=1;function T(O){return O<=O?o[um(a,O,0,v)]:f}return T.domain=function(O){return arguments.length?(a=su.call(O),v=Math.min(a.length,o.length-1),T):a.slice()},T.range=function(O){return arguments.length?(o=su.call(O),v=Math.min(a.length,o.length-1),T):o.slice()},T.invertExtent=function(O){var L=o.indexOf(O);return[a[L-1],a[L]]},T.unknown=function(O){return arguments.length?(f=O,T):f},T.copy=function(){return el().domain(a).range(o).unknown(f)},yu.apply(T,arguments)}var Yl=new Date,zl=new Date;function as(a,o,f,v){function T(O){return a(O=arguments.length===0?new Date:new Date(+O)),O}return T.floor=function(O){return a(O=new Date(+O)),O},T.ceil=function(O){return a(O=new Date(O-1)),o(O,1),a(O),O},T.round=function(O){var L=T(O),F=T.ceil(O);return O-L<F-O?L:F},T.offset=function(O,L){return o(O=new Date(+O),L==null?1:Math.floor(L)),O},T.range=function(O,L,F){var H=[],ie;if(O=T.ceil(O),F=F==null?1:Math.floor(F),!(O<L)||!(F>0))return H;do H.push(ie=new Date(+O)),o(O,F),a(O);while(ie<O&&O<L);return H},T.filter=function(O){return as(function(L){if(L>=L)for(;a(L),!O(L);)L.setTime(L-1)},function(L,F){if(L>=L)if(F<0)for(;++F<=0;)for(;o(L,-1),!O(L););else for(;--F>=0;)for(;o(L,1),!O(L););})},f&&(T.count=function(O,L){return Yl.setTime(+O),zl.setTime(+L),a(Yl),a(zl),Math.floor(f(Yl,zl))},T.every=function(O){return O=Math.floor(O),!isFinite(O)||!(O>0)?null:O>1?T.filter(v?function(L){return v(L)%O===0}:function(L){return T.count(0,L)%O===0}):T}),T}var $l=as(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,o){a.setFullYear(a.getFullYear()+o)},function(a,o){return o.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});$l.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:as(function(o){o.setFullYear(Math.floor(o.getFullYear()/a)*a),o.setMonth(0,1),o.setHours(0,0,0,0)},function(o,f){o.setFullYear(o.getFullYear()+f*a)})};var ec=$l,mc=$l.range,Ra=as(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,o){a.setMonth(a.getMonth()+o)},function(a,o){return o.getMonth()-a.getMonth()+(o.getFullYear()-a.getFullYear())*12},function(a){return a.getMonth()}),Kc=Ra,Rs=Ra.range,Zo=1e3,Ta=6e4,Za=36e5,Kl=864e5,ch=6048e5;function ln(a){return as(function(o){o.setDate(o.getDate()-(o.getDay()+7-a)%7),o.setHours(0,0,0,0)},function(o,f){o.setDate(o.getDate()+f*7)},function(o,f){return(f-o-(f.getTimezoneOffset()-o.getTimezoneOffset())*Ta)/ch})}var Pr=ln(0),Er=ln(1),no=ln(2),Na=ln(3),Es=ln(4),Lt=ln(5),nn=ln(6),Mn=Pr.range,Ar=Er.range,xr=no.range,Un=Na.range,Kn=Es.range,ir=Lt.range,yn=nn.range,Hn=as(function(a){a.setHours(0,0,0,0)},function(a,o){a.setDate(a.getDate()+o)},function(a,o){return(o-a-(o.getTimezoneOffset()-a.getTimezoneOffset())*Ta)/Kl},function(a){return a.getDate()-1}),Kt=Hn,Yn=Hn.range,Dr=as(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Zo-a.getMinutes()*Ta)},function(a,o){a.setTime(+a+o*Za)},function(a,o){return(o-a)/Za},function(a){return a.getHours()}),zr=Dr,mi=Dr.range,Kr=as(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Zo)},function(a,o){a.setTime(+a+o*Ta)},function(a,o){return(o-a)/Ta},function(a){return a.getMinutes()}),hi=Kr,Ro=Kr.range,Ui=as(function(a){a.setTime(a-a.getMilliseconds())},function(a,o){a.setTime(+a+o*Zo)},function(a,o){return(o-a)/Zo},function(a){return a.getUTCSeconds()}),xo=Ui,qo=Ui.range,ia=as(function(){},function(a,o){a.setTime(+a+o)},function(a,o){return o-a});ia.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?as(function(o){o.setTime(Math.floor(o/a)*a)},function(o,f){o.setTime(+o+f*a)},function(o,f){return(f-o)/a}):ia};var As=ia,Sc=ia.range;function xu(a){return as(function(o){o.setUTCDate(o.getUTCDate()-(o.getUTCDay()+7-a)%7),o.setUTCHours(0,0,0,0)},function(o,f){o.setUTCDate(o.getUTCDate()+f*7)},function(o,f){return(f-o)/ch})}var mm=xu(0),uf=xu(1),qv=xu(2),Od=xu(3),Kd=xu(4),C1=xu(5),O1=xu(6),Qv=mm.range,Jv=uf.range,s0=qv.range,eg=Od.range,tl=Kd.range,R1=C1.range,Tc=O1.range,Xa=as(function(a){a.setUTCHours(0,0,0,0)},function(a,o){a.setUTCDate(a.getUTCDate()+o)},function(a,o){return(o-a)/Kl},function(a){return a.getUTCDate()-1}),sy=Xa,ab=Xa.range,tg=as(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,o){a.setUTCFullYear(a.getUTCFullYear()+o)},function(a,o){return o.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});tg.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:as(function(o){o.setUTCFullYear(Math.floor(o.getUTCFullYear()/a)*a),o.setUTCMonth(0,1),o.setUTCHours(0,0,0,0)},function(o,f){o.setUTCFullYear(o.getUTCFullYear()+f*a)})};var Oh=tg,sb=tg.range;function sv(a){if(0<=a.y&&a.y<100){var o=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return o.setFullYear(a.y),o}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function Ip(a){if(0<=a.y&&a.y<100){var o=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return o.setUTCFullYear(a.y),o}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function Gu(a,o,f){return{y:a,m:o,d:f,H:0,M:0,S:0,L:0}}function wa(a){var o=a.dateTime,f=a.date,v=a.time,T=a.periods,O=a.days,L=a.shortDays,F=a.months,H=a.shortMonths,ie=Qd(T),ge=Rh(T),Te=Qd(O),Ve=Rh(O),Mt=Qd(L),rn=Rh(L),Rn=Qd(F),hr=Rh(F),Nr=Qd(H),jn=Rh(H),ci={a:cl,A:J0,b:Wf,B:Lv,c:null,d:cn,e:cn,f:yr,g:ea,G:ma,H:vn,I:Zn,j:Nn,L:fr,m:Sr,M:Ir,p:bx,q:Dv,Q:Us,s:rc,S:Xr,u:Pi,U:Ci,V:ao,w:Po,W:Wi,x:null,X:null,y:Aa,Y:yo,Z:Ma,"%":fu},ji={a:pO,A:RS,b:mO,B:w_,c:null,d:ns,e:ns,f:jl,g:Ys,G:gs,H:Wo,I:Cs,j:bl,L:Ul,m:xl,M:nc,p:hp,q:kP,Q:Us,s:rc,S:Hs,u:wc,U:Xu,V:uu,w:Vl,W:Uc,x:null,X:null,y:es,Y:zs,Z:Yu,"%":fu},To={a:ys,A:$o,b:cs,B:Zs,c:Dh,d:P,e:P,f:We,g:c,G:cy,H:V,I:V,j:B,L:Le,m:A,M:Q,p:ja,q:g,Q:ut,s:Nt,S:me,u:P1,U:lb,V:qc,w:M1,W:l0,x:Id,X:Nh,y:c,Y:cy,Z:d,"%":rt};ci.x=Ji(f,ci),ci.X=Ji(v,ci),ci.c=Ji(o,ci),ji.x=Ji(f,ji),ji.X=Ji(v,ji),ji.c=Ji(o,ji);function Ji(la,Ws){return function(ul){var ro=[],df=-1,Jl=0,Ld=la.length,Dd,Bg,MS;for(ul instanceof Date||(ul=new Date(+ul));++df<Ld;)la.charCodeAt(df)===37&&(ro.push(la.slice(Jl,df)),(Bg=tc[Dd=la.charAt(++df)])!=null?Dd=la.charAt(++df):Bg=Dd==="e"?" ":"0",(MS=Ws[Dd])&&(Dd=MS(ul,Bg)),ro.push(Dd),Jl=df+1);return ro.push(la.slice(Jl,df)),ro.join("")}}function Hr(la,Ws){return function(ul){var ro=Gu(1900,void 0,1),df=Gi(ro,la,ul+="",0),Jl,Ld;if(df!=ul.length)return null;if("Q"in ro)return new Date(ro.Q);if("s"in ro)return new Date(ro.s*1e3+("L"in ro?ro.L:0));if(Ws&&!("Z"in ro)&&(ro.Z=0),"p"in ro&&(ro.H=ro.H%12+ro.p*12),ro.m===void 0&&(ro.m="q"in ro?ro.q:0),"V"in ro){if(ro.V<1||ro.V>53)return null;"w"in ro||(ro.w=1),"Z"in ro?(Jl=Ip(Gu(ro.y,0,1)),Ld=Jl.getUTCDay(),Jl=Ld>4||Ld===0?uf.ceil(Jl):uf(Jl),Jl=sy.offset(Jl,(ro.V-1)*7),ro.y=Jl.getUTCFullYear(),ro.m=Jl.getUTCMonth(),ro.d=Jl.getUTCDate()+(ro.w+6)%7):(Jl=sv(Gu(ro.y,0,1)),Ld=Jl.getDay(),Jl=Ld>4||Ld===0?Er.ceil(Jl):Er(Jl),Jl=Kt.offset(Jl,(ro.V-1)*7),ro.y=Jl.getFullYear(),ro.m=Jl.getMonth(),ro.d=Jl.getDate()+(ro.w+6)%7)}else("W"in ro||"U"in ro)&&("w"in ro||(ro.w="u"in ro?ro.u%7:"W"in ro?1:0),Ld="Z"in ro?Ip(Gu(ro.y,0,1)).getUTCDay():sv(Gu(ro.y,0,1)).getDay(),ro.m=0,ro.d="W"in ro?(ro.w+6)%7+ro.W*7-(Ld+5)%7:ro.w+ro.U*7-(Ld+6)%7);return"Z"in ro?(ro.H+=ro.Z/100|0,ro.M+=ro.Z%100,Ip(ro)):sv(ro)}}function Gi(la,Ws,ul,ro){for(var df=0,Jl=Ws.length,Ld=ul.length,Dd,Bg;df<Jl;){if(ro>=Ld)return-1;if(Dd=Ws.charCodeAt(df++),Dd===37){if(Dd=Ws.charAt(df++),Bg=To[Dd in tc?Ws.charAt(df++):Dd],!Bg||(ro=Bg(la,ul,ro))<0)return-1}else if(Dd!=ul.charCodeAt(ro++))return-1}return ro}function ja(la,Ws,ul){var ro=ie.exec(Ws.slice(ul));return ro?(la.p=ge[ro[0].toLowerCase()],ul+ro[0].length):-1}function ys(la,Ws,ul){var ro=Mt.exec(Ws.slice(ul));return ro?(la.w=rn[ro[0].toLowerCase()],ul+ro[0].length):-1}function $o(la,Ws,ul){var ro=Te.exec(Ws.slice(ul));return ro?(la.w=Ve[ro[0].toLowerCase()],ul+ro[0].length):-1}function cs(la,Ws,ul){var ro=Nr.exec(Ws.slice(ul));return ro?(la.m=jn[ro[0].toLowerCase()],ul+ro[0].length):-1}function Zs(la,Ws,ul){var ro=Rn.exec(Ws.slice(ul));return ro?(la.m=hr[ro[0].toLowerCase()],ul+ro[0].length):-1}function Dh(la,Ws,ul){return Gi(la,o,Ws,ul)}function Id(la,Ws,ul){return Gi(la,f,Ws,ul)}function Nh(la,Ws,ul){return Gi(la,v,Ws,ul)}function cl(la){return L[la.getDay()]}function J0(la){return O[la.getDay()]}function Wf(la){return H[la.getMonth()]}function Lv(la){return F[la.getMonth()]}function bx(la){return T[+(la.getHours()>=12)]}function Dv(la){return 1+~~(la.getMonth()/3)}function pO(la){return L[la.getUTCDay()]}function RS(la){return O[la.getUTCDay()]}function mO(la){return H[la.getUTCMonth()]}function w_(la){return F[la.getUTCMonth()]}function hp(la){return T[+(la.getUTCHours()>=12)]}function kP(la){return 1+~~(la.getUTCMonth()/3)}return{format:function(la){var Ws=Ji(la+="",ci);return Ws.toString=function(){return la},Ws},parse:function(la){var Ws=Hr(la+="",!1);return Ws.toString=function(){return la},Ws},utcFormat:function(la){var Ws=Ji(la+="",ji);return Ws.toString=function(){return la},Ws},utcParse:function(la){var Ws=Hr(la+="",!0);return Ws.toString=function(){return la},Ws}}}var tc={"-":"",_:" ",0:"0"},kc=/^\s*\d+/,Lp=/^%/,qd=/[\\^$*+?|[\]().{}]/g;function ks(a,o,f){var v=a<0?"-":"",T=(v?-a:a)+"",O=T.length;return v+(O<f?new Array(f-O+1).join(o)+T:T)}function ly(a){return a.replace(qd,"\\$&")}function Qd(a){return new RegExp("^(?:"+a.map(ly).join("|")+")","i")}function Rh(a){for(var o={},f=-1,v=a.length;++f<v;)o[a[f].toLowerCase()]=f;return o}function M1(a,o,f){var v=kc.exec(o.slice(f,f+1));return v?(a.w=+v[0],f+v[0].length):-1}function P1(a,o,f){var v=kc.exec(o.slice(f,f+1));return v?(a.u=+v[0],f+v[0].length):-1}function lb(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.U=+v[0],f+v[0].length):-1}function qc(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.V=+v[0],f+v[0].length):-1}function l0(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.W=+v[0],f+v[0].length):-1}function cy(a,o,f){var v=kc.exec(o.slice(f,f+4));return v?(a.y=+v[0],f+v[0].length):-1}function c(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.y=+v[0]+(+v[0]>68?1900:2e3),f+v[0].length):-1}function d(a,o,f){var v=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(o.slice(f,f+6));return v?(a.Z=v[1]?0:-(v[2]+(v[3]||"00")),f+v[0].length):-1}function g(a,o,f){var v=kc.exec(o.slice(f,f+1));return v?(a.q=v[0]*3-3,f+v[0].length):-1}function A(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.m=v[0]-1,f+v[0].length):-1}function P(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.d=+v[0],f+v[0].length):-1}function B(a,o,f){var v=kc.exec(o.slice(f,f+3));return v?(a.m=0,a.d=+v[0],f+v[0].length):-1}function V(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.H=+v[0],f+v[0].length):-1}function Q(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.M=+v[0],f+v[0].length):-1}function me(a,o,f){var v=kc.exec(o.slice(f,f+2));return v?(a.S=+v[0],f+v[0].length):-1}function Le(a,o,f){var v=kc.exec(o.slice(f,f+3));return v?(a.L=+v[0],f+v[0].length):-1}function We(a,o,f){var v=kc.exec(o.slice(f,f+6));return v?(a.L=Math.floor(v[0]/1e3),f+v[0].length):-1}function rt(a,o,f){var v=Lp.exec(o.slice(f,f+1));return v?f+v[0].length:-1}function ut(a,o,f){var v=kc.exec(o.slice(f));return v?(a.Q=+v[0],f+v[0].length):-1}function Nt(a,o,f){var v=kc.exec(o.slice(f));return v?(a.s=+v[0],f+v[0].length):-1}function cn(a,o){return ks(a.getDate(),o,2)}function vn(a,o){return ks(a.getHours(),o,2)}function Zn(a,o){return ks(a.getHours()%12||12,o,2)}function Nn(a,o){return ks(1+Kt.count(ec(a),a),o,3)}function fr(a,o){return ks(a.getMilliseconds(),o,3)}function yr(a,o){return fr(a,o)+"000"}function Sr(a,o){return ks(a.getMonth()+1,o,2)}function Ir(a,o){return ks(a.getMinutes(),o,2)}function Xr(a,o){return ks(a.getSeconds(),o,2)}function Pi(a){var o=a.getDay();return o===0?7:o}function Ci(a,o){return ks(Pr.count(ec(a)-1,a),o,2)}function Ao(a){var o=a.getDay();return o>=4||o===0?Es(a):Es.ceil(a)}function ao(a,o){return a=Ao(a),ks(Es.count(ec(a),a)+(ec(a).getDay()===4),o,2)}function Po(a){return a.getDay()}function Wi(a,o){return ks(Er.count(ec(a)-1,a),o,2)}function Aa(a,o){return ks(a.getFullYear()%100,o,2)}function ea(a,o){return a=Ao(a),ks(a.getFullYear()%100,o,2)}function yo(a,o){return ks(a.getFullYear()%1e4,o,4)}function ma(a,o){var f=a.getDay();return a=f>=4||f===0?Es(a):Es.ceil(a),ks(a.getFullYear()%1e4,o,4)}function Ma(a){var o=a.getTimezoneOffset();return(o>0?"-":(o*=-1,"+"))+ks(o/60|0,"0",2)+ks(o%60,"0",2)}function ns(a,o){return ks(a.getUTCDate(),o,2)}function Wo(a,o){return ks(a.getUTCHours(),o,2)}function Cs(a,o){return ks(a.getUTCHours()%12||12,o,2)}function bl(a,o){return ks(1+sy.count(Oh(a),a),o,3)}function Ul(a,o){return ks(a.getUTCMilliseconds(),o,3)}function jl(a,o){return Ul(a,o)+"000"}function xl(a,o){return ks(a.getUTCMonth()+1,o,2)}function nc(a,o){return ks(a.getUTCMinutes(),o,2)}function Hs(a,o){return ks(a.getUTCSeconds(),o,2)}function wc(a){var o=a.getUTCDay();return o===0?7:o}function Xu(a,o){return ks(mm.count(Oh(a)-1,a),o,2)}function zc(a){var o=a.getUTCDay();return o>=4||o===0?Kd(a):Kd.ceil(a)}function uu(a,o){return a=zc(a),ks(Kd.count(Oh(a),a)+(Oh(a).getUTCDay()===4),o,2)}function Vl(a){return a.getUTCDay()}function Uc(a,o){return ks(uf.count(Oh(a)-1,a),o,2)}function es(a,o){return ks(a.getUTCFullYear()%100,o,2)}function Ys(a,o){return a=zc(a),ks(a.getUTCFullYear()%100,o,2)}function zs(a,o){return ks(a.getUTCFullYear()%1e4,o,4)}function gs(a,o){var f=a.getUTCDay();return a=f>=4||f===0?Kd(a):Kd.ceil(a),ks(a.getUTCFullYear()%1e4,o,4)}function Yu(){return"+0000"}function fu(){return"%"}function Us(a){return+a}function rc(a){return Math.floor(+a/1e3)}var Ac,ss,$u,Uf,Jd;ic({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ic(a){return Ac=wa(a),ss=Ac.format,$u=Ac.parse,Uf=Ac.utcFormat,Jd=Ac.utcParse,Ac}var uh=1e3,Tf=uh*60,ep=Tf*60,ed=ep*24,c0=ed*7,td=ed*30,u0=ed*365;function vm(a){return new Date(a)}function f0(a){return a instanceof Date?+a:+new Date(+a)}function gm(a,o,f,v,T,O,L,F,H){var ie=ov(bu,bu),ge=ie.invert,Te=ie.domain,Ve=H(".%L"),Mt=H(":%S"),rn=H("%I:%M"),Rn=H("%I %p"),hr=H("%a %d"),Nr=H("%b %d"),jn=H("%B"),ci=H("%Y"),ji=[[L,1,uh],[L,5,5*uh],[L,15,15*uh],[L,30,30*uh],[O,1,Tf],[O,5,5*Tf],[O,15,15*Tf],[O,30,30*Tf],[T,1,ep],[T,3,3*ep],[T,6,6*ep],[T,12,12*ep],[v,1,ed],[v,2,2*ed],[f,1,c0],[o,1,td],[o,3,3*td],[a,1,u0]];function To(Hr){return(L(Hr)<Hr?Ve:O(Hr)<Hr?Mt:T(Hr)<Hr?rn:v(Hr)<Hr?Rn:o(Hr)<Hr?f(Hr)<Hr?hr:Nr:a(Hr)<Hr?jn:ci)(Hr)}function Ji(Hr,Gi,ja,ys){if(Hr==null&&(Hr=10),typeof Hr=="number"){var $o=Math.abs(ja-Gi)/Hr,cs=Sp(function(Zs){return Zs[2]}).right(ji,$o);cs===ji.length?(ys=t0(Gi/u0,ja/u0,Hr),Hr=a):cs?(cs=ji[$o/ji[cs-1][2]<ji[cs][2]/$o?cs-1:cs],ys=cs[1],Hr=cs[0]):(ys=Math.max(t0(Gi,ja,Hr),1),Hr=F)}return ys==null?Hr:Hr.every(ys)}return ie.invert=function(Hr){return new Date(ge(Hr))},ie.domain=function(Hr){return arguments.length?Te(Th.call(Hr,f0)):Te().map(vm)},ie.ticks=function(Hr,Gi){var ja=Te(),ys=ja[0],$o=ja[ja.length-1],cs=$o<ys,Zs;return cs&&(Zs=ys,ys=$o,$o=Zs),Zs=Ji(Hr,ys,$o,Gi),Zs=Zs?Zs.range(ys,$o+1):[],cs?Zs.reverse():Zs},ie.tickFormat=function(Hr,Gi){return Gi==null?To:H(Gi)},ie.nice=function(Hr,Gi){var ja=Te();return(Hr=Ji(Hr,ja[0],ja[ja.length-1],Gi))?Te(eo(ja,Hr)):ie},ie.copy=function(){return z0(ie,gm(a,o,f,v,T,O,L,F,H))},ie}function ng(){return yu.apply(gm(ec,Kc,Pr,Kt,zr,hi,xo,As,ss).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uy(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function nd(){var a=0,o=1,f,v,T,O,L=bu,F=!1,H;function ie(ge){return isNaN(ge=+ge)?H:L(T===0?.5:(ge=(O(ge)-f)*T,F?Math.max(0,Math.min(1,ge)):ge))}return ie.domain=function(ge){return arguments.length?(f=O(a=+ge[0]),v=O(o=+ge[1]),T=f===v?0:1/(v-f),ie):[a,o]},ie.clamp=function(ge){return arguments.length?(F=!!ge,ie):F},ie.interpolator=function(ge){return arguments.length?(L=ge,ie):L},ie.unknown=function(ge){return arguments.length?(H=ge,ie):H},function(ge){return O=ge,f=ge(a),v=ge(o),T=f===v?0:1/(v-f),ie}}function Dp(a,o){return o.domain(a.domain()).interpolator(a.interpolator()).clamp(a.clamp()).unknown(a.unknown())}function j0(){var a=pr(nd()(bu));return a.copy=function(){return Dp(a,j0())},r0.apply(a,arguments)}function rd(){var a=loggish(nd()).domain([1,10]);return a.copy=function(){return Dp(a,rd()).base(a.base())},initInterpolator.apply(a,arguments)}function Np(){var a=symlogish(nd());return a.copy=function(){return Dp(a,Np()).constant(a.constant())},initInterpolator.apply(a,arguments)}function lv(){var a=powish(nd());return a.copy=function(){return Dp(a,lv()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function rg(){return lv.apply(null,arguments).exponent(.5)}function ym(){var a=[],o=identity;function f(v){if(!isNaN(v=+v))return o((bisect(a,v)-1)/(a.length-1))}return f.domain=function(v){if(!arguments.length)return a.slice();a=[];for(var T=0,O=v.length,L;T<O;++T)L=v[T],L!=null&&!isNaN(L=+L)&&a.push(L);return a.sort(ascending),f},f.interpolator=function(v){return arguments.length?(o=v,f):o},f.copy=function(){return ym(o).domain(a)},initInterpolator.apply(f,arguments)}function Bp(){var a=0,o=.5,f=1,v,T,O,L,F,H=bu,ie,ge=!1,Te;function Ve(Mt){return isNaN(Mt=+Mt)?Te:(Mt=.5+((Mt=+ie(Mt))-T)*(Mt<T?L:F),H(ge?Math.max(0,Math.min(1,Mt)):Mt))}return Ve.domain=function(Mt){return arguments.length?(v=ie(a=+Mt[0]),T=ie(o=+Mt[1]),O=ie(f=+Mt[2]),L=v===T?0:.5/(T-v),F=T===O?0:.5/(O-T),Ve):[a,o,f]},Ve.clamp=function(Mt){return arguments.length?(ge=!!Mt,Ve):ge},Ve.interpolator=function(Mt){return arguments.length?(H=Mt,Ve):H},Ve.unknown=function(Mt){return arguments.length?(Te=Mt,Ve):Te},function(Mt){return ie=Mt,v=Mt(a),T=Mt(o),O=Mt(f),L=v===T?0:.5/(T-v),F=T===O?0:.5/(O-T),Ve}}function h0(){var a=pr(Bp()(bu));return a.copy=function(){return Dp(a,h0())},r0.apply(a,arguments)}function _m(){var a=loggish(Bp()).domain([.1,1,10]);return a.copy=function(){return copy(a,_m()).base(a.base())},initInterpolator.apply(a,arguments)}function cv(){var a=symlogish(Bp());return a.copy=function(){return copy(a,cv()).constant(a.constant())},initInterpolator.apply(a,arguments)}function bm(){var a=powish(Bp());return a.copy=function(){return copy(a,bm()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function uv(){return bm.apply(null,arguments).exponent(.5)}function V0(a){let o,f=[];function v(T){return T==null?o:T}return v.invert=v,v.domain=v.range=T=>T?(f=T,T):f,v.unknown=T=>T?(o=T,T):o,v.copy=()=>V0(a).unknown(o),v}const{isNil:Fp,isString:kp,uniq:d0}=Me.lodashUtil,tp=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,p0={[K.vY.LINEAR]:Lr,[K.vY.POWER]:_l,[K.vY.LOG]:Ei,[K.vY.IDENTITY]:V0,[K.vY.SEQUENTIAL]:j0,[K.vY.TIME]:ng,[K.vY.QUANTILE]:Ga,[K.vY.QUANTIZE]:dl,[K.vY.THRESHOLD]:el,[K.vY.CAT]:Rp,[K.vY.DIVERGING]:h0};class zp{constructor(){(0,qt.Z)(this,"scaleOptions",{})}apply(o,{styleAttributeService:f}){var v=this;o.hooks.init.tapPromise("FeatureScalePlugin",(0,Ai.Z)(function*(){var T;o.log(K.Or.ScaleInitStart,K.KD.INIT),v.scaleOptions=o.getScaleOptions();const O=f.getLayerStyleAttributes(),L=(T=o.getSource())===null||T===void 0?void 0:T.data.dataArray;Array.isArray(L)&&L.length===0||(v.caculateScalesForAttributes(O||[],L),o.log(K.Or.ScaleInitEnd,K.KD.INIT))})),o.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var T=(0,Ai.Z)(function*(O){if(!O)return O;o.log(K.Or.ScaleInitStart,K.KD.UPDATE),v.scaleOptions=o.getScaleOptions();const L=f.getLayerStyleAttributes(),F=o.getSource().data.dataArray;return Array.isArray(F)&&F.length===0||(v.caculateScalesForAttributes(L||[],F),o.log(K.Or.ScaleInitEnd,K.KD.UPDATE),o.layerModelNeedUpdate=!0),!0});return function(O){return T.apply(this,arguments)}}()),o.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(o.layerModelNeedUpdate)return;this.scaleOptions=o.getScaleOptions();const T=f.getLayerStyleAttributes(),O=o.getSource().data.dataArray;if(!(Array.isArray(O)&&O.length===0)&&T){const L=T.filter(F=>F.needRescale);L.length&&this.caculateScalesForAttributes(L,O)}})}isNumber(o){return!isNaN(parseFloat(o))&&isFinite(o)}caculateScalesForAttributes(o,f){o.forEach(v=>{if(v.scale){const T=v.scale,O=v.scale.field;T.names=this.parseFields(Fp(O)?[]:O);const L=[];T.names.forEach(F=>{var H;L.push(this.createScale(F,v.name,(H=v.scale)===null||H===void 0?void 0:H.values,f))}),L.some(F=>F.type===K.ee.VARIABLE)?(T.type=K.ee.VARIABLE,L.forEach(F=>{if(!T.callback&&T.values!=="text"){var H;switch((H=F.option)===null||H===void 0?void 0:H.type){case K.vY.LOG:case K.vY.LINEAR:case K.vY.POWER:if(T.values&&T.values.length>2){const ge=F.scale.ticks(T.values.length);F.scale.domain(ge)}T.values?F.scale.range(T.values):F.scale.range(F.option.domain);break;case K.vY.QUANTILE:case K.vY.QUANTIZE:case K.vY.THRESHOLD:F.scale.range(T.values);break;case K.vY.IDENTITY:break;case K.vY.CAT:T.values?F.scale.range(T.values):F.scale.range(F.option.domain);break;case K.vY.DIVERGING:case K.vY.SEQUENTIAL:F.scale.interpolator(gu(T.values));break}}if(T.values==="text"){var ie;F.scale.range((ie=F.option)===null||ie===void 0?void 0:ie.domain)}})):(T.type=K.ee.CONSTANT,T.defaultValues=L.map((F,H)=>F.scale(T.names[H]))),T.scalers=L.map(F=>({field:F.field,func:F.scale,option:F.option})),v.needRescale=!1}})}parseFields(o){return Array.isArray(o)?o:kp(o)?o.split("*"):[o]}createScale(o,f,v,T){var O,L;const F=this.scaleOptions[f]&&((O=this.scaleOptions[f])===null||O===void 0?void 0:O.field)===o?this.scaleOptions[f]:this.scaleOptions[o],H={field:o,scale:void 0,type:K.ee.VARIABLE,option:F};if(!T||!T.length)return F&&F.type?H.scale=this.createDefaultScale(F):(H.scale=Rp([o]),H.type=K.ee.CONSTANT),H;const ie=(L=T.find(ge=>!Fp(ge[o])))===null||L===void 0?void 0:L[o];if(this.isNumber(o)||Fp(ie)&&!F)H.scale=Rp([o]),H.type=K.ee.CONSTANT;else{let ge=F&&F.type||this.getDefaultType(ie);v==="text"&&(ge=K.vY.CAT),v===void 0&&(ge=K.vY.IDENTITY);const Te=this.createScaleConfig(ge,o,F,T);H.scale=this.createDefaultScale(Te),H.option=Te}return H}getDefaultType(o){let f=K.vY.LINEAR;return typeof o=="string"&&(f=tp.test(o)?K.vY.TIME:K.vY.CAT),f}createScaleConfig(o,f,v,T){const O={type:o};let L=[];if(o===K.vY.QUANTILE){const F=new Map;T==null||T.forEach(H=>{F.set(H._id,H[f])}),L=Array.from(F.values())}else L=(T==null?void 0:T.map(F=>F[f]))||[];if(v!=null&&v.domain)O.domain=v==null?void 0:v.domain;else if(o===K.vY.CAT||o===K.vY.IDENTITY)O.domain=d0(L);else if(o===K.vY.QUANTILE)O.domain=L;else if(o===K.vY.DIVERGING){const F=No(L),H=(v==null?void 0:v.neutral)!==void 0?v==null?void 0:v.neutral:(F[0]+F[1])/2;O.domain=[F[0],H,F[1]]}else O.domain=No(L);return(0,Bn.Z)((0,Bn.Z)({},O),v)}createDefaultScale({type:o,domain:f,unknown:v,clamp:T,nice:O}){const L=p0[o]();return f&&L.domain&&L.domain(f),v&&L.unknown(v),T!==void 0&&L.clamp&&L.clamp(T),O!==void 0&&L.nice&&L.nice(O),L}}class xm{apply(o){o.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{o.animateStatus&&o.models.forEach(v=>{v.addUniforms((0,Bn.Z)({},o.layerModel.getAnimateUniforms()))})})}}class fv{apply(o){o.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:f,enableMask:v}=o.getLayerConfig();!o.tileLayer&&f&&f.length>0&&o.updateLayerConfig({mask:v})})}}class Em{build(o){return(0,Ai.Z)(function*(){o.prepareBuildModel(),yield o.buildModels()})()}initLayerModel(o){var f=this;return(0,Ai.Z)(function*(){yield f.build(o),o.styleNeedUpdate=!1})()}prepareLayerModel(o){var f=this;return(0,Ai.Z)(function*(){yield f.build(o),o.styleNeedUpdate=!1})()}apply(o){var f=this;o.hooks.init.tapPromise("LayerModelPlugin",(0,Ai.Z)(function*(){if(o.getSource().isTile){o.prepareBuildModel();return}o.log(K.Or.BuildModelStart,K.KD.INIT),yield f.initLayerModel(o),o.log(K.Or.BuildModelEnd,K.KD.INIT)})),o.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var v=(0,Ai.Z)(function*(T){return!T||o.getSource().isTile?!1:(o.log(K.Or.BuildModelStart,K.KD.UPDATE),yield f.prepareLayerModel(o),o.log(K.Or.BuildModelEnd,K.KD.UPDATE),!0)});return function(T){return v.apply(this,arguments)}}())}}class hv{apply(o){o.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:f,fitBoundsOptions:v}=o.getLayerConfig();f&&o.fitBounds(v),o.styleNeedUpdate=!1})}}const H0=["type"],ig={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Sm={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Ol={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},jc={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function id(a){const o={u_DirectionalLights:new Array(3).fill((0,Bn.Z)({},Ol)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,Bn.Z)({},jc)),u_NumOfSpotLights:0};return(!a||!a.length)&&(a=[Sm]),a.forEach(f=>{let{type:v="directional"}=f,T=(0,hl.Z)(f,H0);const O=ig[v].lights,L=ig[v].num,F=o[L];o[O][F]=(0,Bn.Z)((0,Bn.Z)({},o[O][F]),T),o[L]++}),o}class Eu{apply(o){o.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:f}=o.getLayerConfig();f&&o.models.forEach(v=>v.addUniforms((0,Bn.Z)({},id())))})}}function dv(a){return a.map(o=>(typeof o=="string"&&(o=[o,{}]),o))}function fy(a,o,f,v){const T=a.multiPassRenderer;return T.add(v("render")),dv(o).forEach(O=>{const[L,F]=O;T.add(f(L),F)}),T.add(f("copy")),T}class og{constructor(){(0,qt.Z)(this,"enabled",void 0)}apply(o,{rendererService:f,postProcessingPassFactory:v,normalPassFactory:T}){o.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:O,passes:L=[]}=o.getLayerConfig();this.enabled=!!O&&o.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(o.multiPassRenderer=fy(o,L,v,T),o.multiPassRenderer.setRenderFlag(!0))}),o.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:O,height:L}=f.getViewportSize();o.multiPassRenderer.resize(O,L)}})}}const ff={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function ag(a){switch(a){case"rotation":return{name:"Rotation",type:K.GC.Attribute,descriptor:{name:"a_Rotation",shaderLocation:ff.ROTATION,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{rotation:f=0}=o;return Array.isArray(f)?[f[0]]:[f]}}};case"stroke":return{name:"stroke",type:K.GC.Attribute,descriptor:{name:"a_Stroke",shaderLocation:ff.STROKE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:o=>{const{stroke:f=[1,1,1,1]}=o;return f}}};case"opacity":return{name:"opacity",type:K.GC.Attribute,descriptor:{name:"a_Opacity",shaderLocation:ff.OPACITY,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{opacity:f=1}=o;return[f]}}};case"offsets":return{name:"offsets",type:K.GC.Attribute,descriptor:{name:"a_Offsets",shaderLocation:ff.OFFSETS,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{offsets:f}=o;return f}}};default:return}}const{isNumber:pv}=Me.lodashUtil,np={NONE:0,ENCODE:1,HIGHLIGHT:2};class mv{constructor(){(0,qt.Z)(this,"pickingUniformMap",void 0)}pickOption2Array(){const o=[];return this.pickingUniformMap.forEach(f=>{pv(f)?o.push(f):o.push(...f)}),o}updatePickOption(o,f){Object.keys(o).forEach(L=>{this.pickingUniformMap.set(L,o[L])});const v=f.getLayerConfig().pickingBuffer||0,T=Number(f.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",v),this.pickingUniformMap.set("u_shaderPick",T),f.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(o,{styleAttributeService:f}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),o.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();f.registerStyleAttribute({name:"pickingColor",type:K.GC.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:ff.PICKING_COLOR,buffer:{data:[],type:K.gl.FLOAT},size:3,update:T=>{const{id:O}=T;return v?(0,Me.Z6)(O):[0,0,0]}}})}),o.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();v&&o.isVisible()&&(this.updatePickOption({u_PickingStage:np.ENCODE},o),o.models.forEach(T=>T.addUniforms({u_PickingStage:np.ENCODE})))}),o.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();v&&o.isVisible()&&(this.updatePickOption({u_PickingStage:np.HIGHLIGHT},o),o.models.forEach(T=>T.addUniforms({u_PickingStage:np.HIGHLIGHT})))}),o.hooks.beforeHighlight.tap("PixelPickingPlugin",v=>{const{highlightColor:T,activeMix:O=0}=o.getLayerConfig(),L=typeof T=="string"?(0,Me.CI)(T):T||[1,0,0,1];o.updateLayerConfig({pickedFeatureID:(0,Me.W0)(new Uint8Array(v))});const F={u_PickingStage:np.HIGHLIGHT,u_PickingColor:v,u_HighlightColor:L.map(H=>H*255),u_activeMix:O};this.updatePickOption(F,o),o.models.forEach(H=>H.addUniforms(F))}),o.hooks.beforeSelect.tap("PixelPickingPlugin",v=>{const{selectColor:T,selectMix:O=0}=o.getLayerConfig(),L=typeof T=="string"?(0,Me.CI)(T):T||[1,0,0,1];o.updateLayerConfig({pickedFeatureID:(0,Me.W0)(new Uint8Array(v))});const F={u_PickingStage:np.HIGHLIGHT,u_PickingColor:v,u_HighlightColor:L.map(H=>H*255),u_activeMix:O,u_CurrentSelectedId:v,u_SelectColor:L.map(H=>H*255)};this.updatePickOption(F,o),o.models.forEach(H=>H.addUniforms(F))})}}const Tm=["mvt","geojsonvt","testTile"];function I1(a){const o=a.getSource();return Tm.includes(o.parser.type)}class vv{apply(o,{styleAttributeService:f}){o.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{I1(o)||this.registerBuiltinAttributes(f,o)})}registerBuiltinAttributes(o,f){if(f.type==="MaskLayer"){this.registerPositionAttribute(o);return}this.registerPositionAttribute(o),this.registerColorAttribute(o)}registerPositionAttribute(o){o.registerStyleAttribute({name:"position",type:K.GC.Attribute,descriptor:{name:"a_Position",shaderLocation:ff.POSITION,buffer:{data:[],type:K.gl.FLOAT},size:3,update:(f,v,T)=>T.length===2?[T[0],T[1],0]:[T[0],T[1],T[2]]}})}registerColorAttribute(o){o.registerStyleAttribute({name:"color",type:K.GC.Attribute,descriptor:{name:"a_Color",shaderLocation:ff.COLOR,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:f=>{const{color:v}=f;return!v||!v.length?[1,1,1,1]:v}}})}}class L1{constructor(){(0,qt.Z)(this,"cameraService",void 0),(0,qt.Z)(this,"coordinateSystemService",void 0),(0,qt.Z)(this,"rendererService",void 0),(0,qt.Z)(this,"mapService",void 0),(0,qt.Z)(this,"layerService",void 0)}apply(o,{rendererService:f,mapService:v,layerService:T,coordinateSystemService:O,cameraService:L}){this.rendererService=f,this.mapService=v,this.layerService=T,this.coordinateSystemService=O,this.cameraService=L;let F;this.rendererService.uniformBuffers[0]||(F=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=F),o.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const H=o.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(H);const{width:ie,height:ge}=this.rendererService.getViewportSize(),{data:Te,uniforms:Ve}=this.generateUBO(ie,ge);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:Te}),this.rendererService.queryVerdorInfo()==="WebGL1"&&o.models.forEach(rn=>{rn.addUniforms((0,Bn.Z)((0,Bn.Z)({},Ve),{},{u_PickingBuffer:o.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(o.getShaderPickStat())}))})})}generateUBO(o,f){const v=this.cameraService.getProjectionMatrix(),T=this.cameraService.getViewMatrix(),O=this.cameraService.getViewProjectionMatrix(),L=this.cameraService.getModelMatrix(),F=this.coordinateSystemService.getViewportCenterProjection(),H=this.coordinateSystemService.getPixelsPerDegree(),ie=this.cameraService.getZoom(),ge=this.coordinateSystemService.getPixelsPerDegree2(),Te=this.cameraService.getZoomScale(),Ve=this.coordinateSystemService.getPixelsPerMeter(),Mt=this.coordinateSystemService.getCoordinateSystem(),rn=this.cameraService.getCameraPosition(),Rn=window.devicePixelRatio,hr=this.coordinateSystemService.getViewportCenter(),Nr=[o,f],jn=this.cameraService.getFocalDistance();return{data:[...T,...v,...O,...L,...F,...H,ie,...ge,Te,...Ve,Mt,...rn,Rn,...hr,...Nr,jn,0,0,0],uniforms:{[K.lv.ProjectionMatrix]:v,[K.lv.ViewMatrix]:T,[K.lv.ViewProjectionMatrix]:O,[K.lv.Zoom]:ie,[K.lv.ZoomScale]:Te,[K.lv.FocalDistance]:jn,[K.lv.CameraPosition]:rn,[K.kw.CoordinateSystem]:Mt,[K.kw.ViewportCenter]:hr,[K.kw.ViewportCenterProjection]:F,[K.kw.PixelsPerDegree]:H,[K.kw.PixelsPerDegree2]:ge,[K.kw.PixelsPerMeter]:Ve,u_ViewportSize:Nr,u_ModelMatrix:L,u_DevicePixelRatio:Rn}}}}class sg{apply(o){o.hooks.beforeRender.tap("UpdateModelPlugin",()=>{o.layerModel&&o.layerModel.needUpdate().then(f=>{f&&o.renderLayers()})}),o.hooks.afterRender.tap("UpdateModelPlugin",()=>{o.layerModelNeedUpdate=!1})}}class D1{apply(o,{styleAttributeService:f}){o.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(o,{styleAttributeService:f})}),o.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{o.layerModelNeedUpdate||o.inited&&this.updateStyleAttribute(o,{styleAttributeService:f})})}updateStyleAttribute(o,{styleAttributeService:f}){const v=f.getLayerStyleAttributes()||[],T=f.getLayerStyleAttribute("filter");if(T&&T.needRegenerateVertices){o.layerModelNeedUpdate=!0,v.forEach(O=>O.needRegenerateVertices=!1);return}v.filter(O=>O.needRegenerateVertices).forEach(O=>{f.updateAttributeByFeatureRange(O.name,o.getEncodedData(),O.featureRange.startIndex,O.featureRange.endIndex,o),O.needRegenerateVertices=!1})}initStyleAttribute(o,{styleAttributeService:f}){(f.getLayerStyleAttributes()||[]).filter(T=>T.needRegenerateVertices).forEach(T=>{f.updateAttributeByFeatureRange(T.name,o.getEncodedData(),T.featureRange.startIndex,T.featureRange.endIndex),T.needRegenerateVertices=!1})}}function N1(){return[new xs,new vv,new zp,new ba,new hv,new fv,new D1,new sg,new og,new L1,new xm,new Eu,new mv,new Em]}const lg={[K.h0.additive]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE,srcAlpha:1,dstAlpha:1}},[K.h0.none]:{enable:!1},[K.h0.normal]:{enable:!0,func:{srcRGB:K.gl.SRC_ALPHA,dstRGB:K.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[K.h0.subtractive]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE,srcAlpha:K.gl.ZERO,dstAlpha:K.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:K.gl.FUNC_SUBTRACT,alpha:K.gl.FUNC_SUBTRACT}},[K.h0.max]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE},equation:{rgb:K.gl.MAX_EXT}},[K.h0.min]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE},equation:{rgb:K.gl.MIN_EXT}}};class wf{constructor(o){(0,qt.Z)(this,"layer",void 0),this.layer=o}pickRender(o){const v=this.layer.getContainer().layerService,T=this.layer;if(T.tileLayer)return T.tileLayer.pickRender(o);T.hooks.beforePickingEncode.call(),v.renderTileLayerMask(T),T.renderModels({ispick:!0}),T.hooks.afterPickingEncode.call()}pick(o,f){var v=this;return(0,Ai.Z)(function*(){const O=v.layer.getContainer().pickingService;return o.type==="RasterLayer"?v.pickRasterLayer(o,f):(v.pickRender(f),O.pickFromPickingFBO(o,f))})()}pickRasterLayer(o,f,v){const T=this.layer.getContainer(),O=T.pickingService,L=T.mapService,F=this.layer.getSource().extent,H=(0,Me.if)(f.lngLat,F),ie={x:f.x,y:f.y,type:f.type,lngLat:f.lngLat,target:f,rasterValue:null},ge=v||o;if(H){const Te=this.readRasterValue(o,F,L,f.x,f.y);return ie.rasterValue=Te,O.triggerHoverOnLayer(ge,ie),!0}else return ie.type=f.type==="mousemove"?"mouseout":"un"+f.type,O.triggerHoverOnLayer(ge,(0,Bn.Z)((0,Bn.Z)({},ie),{},{type:"unpick"})),O.triggerHoverOnLayer(ge,ie),!1}readRasterValue(o,f,v,T,O){const L=o.getSource().data.dataArray[0],[F=0,H=0,ie=10,ge=-10]=f,Te=v.lngLatToContainer([F,H]),Ve=v.lngLatToContainer([ie,ge]),Mt=Ve.x-Te.x,rn=Te.y-Ve.y,Rn=[(T-Te.x)/Mt,(O-Ve.y)/rn],hr=L.width||1,Nr=L.height||1,jn=Math.floor(Rn[0]*hr),ci=Math.floor(Rn[1]*Nr),ji=Math.max(0,ci-1)*hr+jn;return L.data[ji]}selectFeature(o){const f=this.layer,[v,T,O]=o;f.hooks.beforeSelect.call([v,T,O])}highlightPickedFeature(o){const[f,v,T]=o;this.layer.hooks.beforeHighlight.call([f,v,T])}getFeatureById(o){return this.layer.getSource().getFeatureById(o)}}class Z0{constructor(o){(0,qt.Z)(this,"layer",void 0),(0,qt.Z)(this,"rendererService",void 0),(0,qt.Z)(this,"colorTexture",void 0),(0,qt.Z)(this,"key",void 0),this.layer=o;const f=this.layer.getContainer();this.rendererService=f.rendererService}getColorTexture(o,f){const v=this.getTextureKey(o,f);return this.key===v?this.colorTexture:(this.createColorTexture(o,f),this.key=v,this.colorTexture)}createColorTexture(o,f){const{createTexture2D:v}=this.rendererService,T=this.getColorRampBar(o,f),O=v({data:new Uint8Array(T.data),width:T.width,height:T.height,flipY:!1,unorm:!0});return this.colorTexture=O,O}setColorTexture(o,f,v){this.key=this.getTextureKey(f,v),this.colorTexture=o}destroy(){var o;(o=this.colorTexture)===null||o===void 0||o.destroy()}getColorRampBar(o,f){switch(o.type){case"cat":return(0,Me.hj)(o);case"quantize":return(0,Me.NJ)(o);case"custom":return(0,Me.Oc)(o,f);case"linear":return(0,Me.M4)(o,f);default:return(0,Me.Cl)(o)}}getTextureKey(o,f){var v;return`${o.colors.join("_")}_${o==null||(v=o.positions)===null||v===void 0?void 0:v.join("_")}_${o.type}_${f==null?void 0:f.join("_")}`}}const hy=["passes"],rp=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:dy,isFunction:py,isNumber:m0,isObject:Vc,isPlainObject:wm,isUndefined:Am}=Me.lodashUtil;let W0=0;class v0 extends Wc.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var o;return(o=this.container)===null||o===void 0?void 0:o.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(o={}){super(),(0,qt.Z)(this,"id",`${W0++}`),(0,qt.Z)(this,"name",`${W0}`),(0,qt.Z)(this,"parent",void 0),(0,qt.Z)(this,"coordCenter",void 0),(0,qt.Z)(this,"type",void 0),(0,qt.Z)(this,"visible",!0),(0,qt.Z)(this,"zIndex",0),(0,qt.Z)(this,"minZoom",void 0),(0,qt.Z)(this,"maxZoom",void 0),(0,qt.Z)(this,"inited",!1),(0,qt.Z)(this,"layerModelNeedUpdate",!1),(0,qt.Z)(this,"pickedFeatureID",null),(0,qt.Z)(this,"selectedFeatureID",null),(0,qt.Z)(this,"styleNeedUpdate",!1),(0,qt.Z)(this,"rendering",void 0),(0,qt.Z)(this,"forceRender",!1),(0,qt.Z)(this,"clusterZoom",0),(0,qt.Z)(this,"layerType",void 0),(0,qt.Z)(this,"triangulation",void 0),(0,qt.Z)(this,"layerPickService",void 0),(0,qt.Z)(this,"textureService",void 0),(0,qt.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,qt.Z)(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,qt.Z)(this,"hooks",{init:new Wl.S$,afterInit:new Wl.oI,beforeRender:new Wl.oI,beforeRenderData:new Wl.bf,afterRender:new Wl.ni,beforePickingEncode:new Wl.ni,afterPickingEncode:new Wl.ni,beforeHighlight:new Wl.ni(["pickedColor"]),afterHighlight:new Wl.ni,beforeSelect:new Wl.ni(["pickedColor"]),afterSelect:new Wl.ni,beforeDestroy:new Wl.ni,afterDestroy:new Wl.ni}),(0,qt.Z)(this,"models",[]),(0,qt.Z)(this,"multiPassRenderer",void 0),(0,qt.Z)(this,"plugins",void 0),(0,qt.Z)(this,"startInit",!1),(0,qt.Z)(this,"sourceOption",void 0),(0,qt.Z)(this,"layerModel",void 0),(0,qt.Z)(this,"shapeOption",void 0),(0,qt.Z)(this,"tileLayer",void 0),(0,qt.Z)(this,"layerChildren",[]),(0,qt.Z)(this,"masks",[]),(0,qt.Z)(this,"configService",K.cO),(0,qt.Z)(this,"styleAttributeService",void 0),(0,qt.Z)(this,"layerSource",void 0),(0,qt.Z)(this,"postProcessingPassFactory",void 0),(0,qt.Z)(this,"animateOptions",{enable:!1}),(0,qt.Z)(this,"container",void 0),(0,qt.Z)(this,"encodedData",void 0),(0,qt.Z)(this,"currentPickId",null),(0,qt.Z)(this,"rawConfig",void 0),(0,qt.Z)(this,"needUpdateConfig",void 0),(0,qt.Z)(this,"encodeStyleAttribute",{}),(0,qt.Z)(this,"enableShaderEncodeStyles",[]),(0,qt.Z)(this,"enableDataEncodeStyles",[]),(0,qt.Z)(this,"pendingStyleAttributes",[]),(0,qt.Z)(this,"scaleOptions",{}),(0,qt.Z)(this,"animateStartTime",void 0),(0,qt.Z)(this,"animateStatus",!1),(0,qt.Z)(this,"isDestroyed",!1),(0,qt.Z)(this,"uniformBuffers",[]),(0,qt.Z)(this,"encodeDataLength",0),(0,qt.Z)(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;const f=this.getLayerConfig();f&&f.autoFit&&this.fitBounds(f.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=o.name||this.id,this.zIndex=o.zIndex||0,this.rawConfig=o,this.masks=o.maskLayers||[]}addMask(o){this.masks.push(o),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(o){const f=this.masks.indexOf(o);f>-1&&this.masks.splice(f,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(o){this.masks.push(o)}removeMaskLayer(o){const f=this.masks.indexOf(o);f>-1&&this.masks.splice(f,1),o.destroy()}getAttribute(o){return this.styleAttributeService.getLayerStyleAttribute(o)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(o){if(Object.keys(o).map(f=>{f in this.rawConfig&&(this.rawConfig[f]=o[f])}),!this.startInit)this.needUpdateConfig=(0,Bn.Z)((0,Bn.Z)({},this.needUpdateConfig),o);else{const f=this.container.id;this.configService.setLayerConfig(f,this.id,(0,Bn.Z)((0,Bn.Z)((0,Bn.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),o)),this.needUpdateConfig={}}}setContainer(o){this.container=o}getContainer(){return this.container}addPlugin(o){return this.plugins.push(o),this}init(){var o=this;return(0,Ai.Z)(function*(){const f=o.container.id;o.startInit=!0,o.configService.setLayerConfig(f,o.id,o.rawConfig),o.layerType=o.rawConfig.layerType;const{enableMultiPassRenderer:v,passes:T}=o.getLayerConfig();v&&T!==null&&T!==void 0&&T.length&&T.length>0&&o.mapService.on("mapAfterFrameChange",()=>{o.renderLayers()}),o.postProcessingPassFactory=o.container.postProcessingPassFactory,o.styleAttributeService=o.container.styleAttributeService,v&&(o.multiPassRenderer=o.container.multiPassRenderer,o.multiPassRenderer.setLayer(o)),o.pendingStyleAttributes.forEach(({attributeName:O,attributeField:L,attributeValues:F,updateOptions:H})=>{o.styleAttributeService.updateStyleAttribute(O,{scale:(0,Bn.Z)({field:L},o.splitValuesAndCallbackInAttribute(F,L?void 0:o.getLayerConfig()[O]))},H)}),o.pendingStyleAttributes=[],o.plugins=N1();for(const O of o.plugins)O.apply(o,o.container);o.layerPickService=new wf(o),o.textureService=new Z0(o),o.log(K.Or.LayerInitStart),yield o.hooks.init.promise(),o.log(K.Or.LayerInitEnd),o.inited=!0,o.emit("inited",{target:o,type:"inited"}),o.emit("add",{target:o,type:"add"}),o.hooks.afterInit.call()})()}log(o,f="init"){var v;if(this.tileLayer||this.isTileLayer)return;const T=`${this.id}.${f}.${o}`,O={id:this.id,type:this.type};(v=this.debugService)===null||v===void 0||v.log(T,O)}updateModelData(o){o.attributes&&o.elements?this.models.map(f=>{f.updateAttributesAndElements(o.attributes,o.elements)}):console.warn("data error")}setLayerPickService(o){this.layerPickService=o}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:o}=this.getLayerConfig();o!=null&&o.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(o,f,v){return this.updateStyleAttribute("color",o,f,v),this}texture(o,f,v){return this.updateStyleAttribute("texture",o,f,v),this}rotate(o,f,v){return this.updateStyleAttribute("rotate",o,f,v),this}size(o,f,v){return this.updateStyleAttribute("size",o,f,v),this}filter(o,f,v){const T=this.updateStyleAttribute("filter",o,f,v);return this.dataState.dataSourceNeedUpdate=T&&this.inited,this}shape(o,f,v){this.shapeOption={field:o,values:f};const T=this.updateStyleAttribute("shape",o,f,v);return this.dataState.dataSourceNeedUpdate=T&&this.inited,this}label(o,f,v){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:o,attributeValues:f,updateOptions:v}),this}animate(o){let f={};return Vc(o)?(f.enable=!0,f=(0,Bn.Z)((0,Bn.Z)({},f),o)):f.enable=o,this.updateLayerConfig({animateOption:f}),this}source(o,f){return(o==null?void 0:o.type)==="source"?(this.setSource(o),this):(this.sourceOption={data:o,options:f},this.clusterZoom=0,this)}setData(o,f){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(o,f)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(o,f)}),this}dataUpdatelog(){this.log(K.Or.SourceInitStart,K.KD.UPDATE),this.layerSource.once("update",()=>{this.log(K.Or.SourceInitEnd,K.KD.UPDATE)})}style(o){const{passes:f}=o,v=(0,hl.Z)(o,hy);f&&dv(f).forEach(O=>{const L=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(O[0]);L&&L.updateOptions(O[1])}),v.borderColor&&(v.stroke=v.borderColor),v.borderWidth&&(v.strokeWidth=v.borderWidth);const T=v;return Object.keys(v).forEach(O=>{const L=v[O];Array.isArray(L)&&L.length===2&&!m0(L[0])&&!m0(L[1])&&(T[O]={field:L[0],value:L[1]})}),this.encodeStyle(T),this.updateLayerConfig(T),this}encodeStyle(o){Object.keys(o).forEach(f=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(f)&&wm(o[f])&&(o[f].field||o[f].value)&&!dy(this.encodeStyleAttribute[f],o[f])?(this.encodeStyleAttribute[f]=o[f],this.updateStyleAttribute(f,o[f].field,o[f].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[f]&&(delete this.encodeStyleAttribute[f],this.dataState.dataSourceNeedUpdate=!0)})}scale(o,f){const v=(0,Bn.Z)({},this.scaleOptions);if(Vc(o)?this.scaleOptions=(0,Bn.Z)((0,Bn.Z)({},this.scaleOptions),o):this.scaleOptions[o]=f,this.styleAttributeService&&!dy(v,this.scaleOptions)){const T=Vc(o)?o:{[o]:f};this.styleAttributeService.updateScaleAttribute(T)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(o={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(o),this))}renderMultiPass(){var o=this;return(0,Ai.Z)(function*(){o.encodeDataLength<=0&&!o.forceRender||(o.multiPassRenderer&&o.multiPassRenderer.getRenderFlag()?yield o.multiPassRenderer.render():o.renderModels())})()}active(o){const f={};return f.enableHighlight=Vc(o)?!0:o,Vc(o)?(f.enableHighlight=!0,o.color&&(f.highlightColor=o.color),o.mix&&(f.activeMix=o.mix)):f.enableHighlight=!!o,this.updateLayerConfig(f),this}setActive(o,f){if(Vc(o)){const{x:v=0,y:T=0}=o;this.updateLayerConfig({highlightColor:Vc(f)?f.color:this.getLayerConfig().highlightColor,activeMix:Vc(f)?f.mix:this.getLayerConfig().activeMix}),this.pick({x:v,y:T})}else this.updateLayerConfig({pickedFeatureID:o,highlightColor:Vc(f)?f.color:this.getLayerConfig().highlightColor,activeMix:Vc(f)?f.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,Me.Z6)(o)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(o){const f={};return f.enableSelect=Vc(o)?!0:o,Vc(o)?(f.enableSelect=!0,o.color&&(f.selectColor=o.color),o.mix&&(f.selectMix=o.mix)):f.enableSelect=!!o,this.updateLayerConfig(f),this}setSelect(o,f){if(Vc(o)){const{x:v=0,y:T=0}=o;this.updateLayerConfig({selectColor:Vc(f)?f.color:this.getLayerConfig().selectColor,selectMix:Vc(f)?f.mix:this.getLayerConfig().selectMix}),this.pick({x:v,y:T})}else this.updateLayerConfig({pickedFeatureID:o,selectColor:Vc(f)?f.color:this.getLayerConfig().selectColor,selectMix:Vc(f)?f.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,Me.Z6)(o)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(o){return this.updateLayerConfig({blend:o}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(o){return this.zIndex=o,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(o){this.currentPickId=o}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(o){this.selectedFeatureID=o}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const o=this.mapService.getZoom(),{visible:f,minZoom:v=-1/0,maxZoom:T=1/0}=this.getLayerConfig();return!!f&&o>=v&&o<T}setMultiPass(o,f){if(this.updateLayerConfig({enableMultiPassRenderer:o}),f&&this.updateLayerConfig({passes:f}),o){const{passes:v=[]}=this.getLayerConfig();this.multiPassRenderer=fy(this,v,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:T,height:O}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(T,O)}return this}setMinZoom(o){return this.updateLayerConfig({minZoom:o}),this}getMinZoom(){const{minZoom:o}=this.getLayerConfig();return o}getMaxZoom(){const{maxZoom:o}=this.getLayerConfig();return o}get(o){return this.getLayerConfig()[o]}setMaxZoom(o){return this.updateLayerConfig({maxZoom:o}),this}setAutoFit(o){return this.updateLayerConfig({autoFit:o}),this}fitBounds(o){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const v=this.getSource().extent;return v.some(O=>Math.abs(O)===1/0)?this:(this.mapService.fitBounds([[v[0],v[1]],[v[2],v[3]]],o),this)}destroy(o=!0){var f,v,T,O,L;if(this.isDestroyed)return;(f=this.layerModel)===null||f===void 0||f.uniformBuffers.forEach(H=>{H.destroy()}),this.layerChildren.map(H=>H.destroy(!1)),this.layerChildren=[];const{maskfence:F}=this.getLayerConfig();F&&(this.masks.map(H=>H.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(v=this.multiPassRenderer)===null||v===void 0||v.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(T=this.layerModel)===null||T===void 0||T.clearModels(o),(O=this.tileLayer)===null||O===void 0||O.destroy(),this.models=[],(L=this.debugService)===null||L===void 0||L.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var o;this.models.forEach(f=>f.destroy()),(o=this.layerModel)===null||o===void 0||o.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(o=>o.needRescale||o.needRemapping||o.needRegenerateVertices).length}setSource(o){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=o,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const f=this.mapService.getZoom();this.layerSource.updateClusterData(f)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:f})=>{if(this.coordCenter===void 0){const v=this.layerSource.center;this.coordCenter=v}if(f==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(o){this.encodedData=o,this.encodeDataLength=o.length}getEncodedData(){return this.encodedData}getScale(o){return this.styleAttributeService.getLayerAttributeScale(o)}getLegend(o){var f,v,T;const O=this.styleAttributeService.getLayerStyleAttribute(o);return{type:(v=((O==null||(f=O.scale)===null||f===void 0?void 0:f.scalers)||[])[0])===null||v===void 0||(v=v.option)===null||v===void 0?void 0:v.type,field:O==null||(T=O.scale)===null||T===void 0?void 0:T.field,items:this.getLegendItems(o)}}getLegendItems(o){const f=this.styleAttributeService.getLayerAttributeScale(o);return f?f.invertExtent?f.range().map(T=>({value:f.invertExtent(T),[o]:T})):f.ticks?f.ticks().map(T=>({value:T,[o]:f(T)})):f!=null&&f.domain?f.domain().filter(T=>!Am(T)).map(T=>({value:T,[o]:f(T)})):[]:[]}pick({x:o,y:f}){this.interactionService.triggerHover({x:o,y:f})}boxSelect(o,f){this.pickingService.boxPickLayer(this,o,f)}buildLayerModel(o){var f=this;return(0,Ai.Z)(function*(){const{moduleName:v,vertexShader:T,fragmentShader:O,defines:L,inject:F,triangulation:H,styleOption:ie,pickingEnabled:ge=!0}=o,Te=(0,hl.Z)(o,rp);f.shaderModuleService.registerModule(v,{vs:T,fs:O,defines:L,inject:F});const{vs:Ve,fs:Mt,uniforms:rn}=f.shaderModuleService.getModule(v),{createModel:Rn}=f.rendererService;return new Promise(hr=>{const{attributes:Nr,elements:jn,count:ci}=f.styleAttributeService.createAttributesAndIndices(f.encodedData,H,ie,f),ji=[...f.layerModel.uniformBuffers,...f.rendererService.uniformBuffers];ge&&ji.push(f.getPickingUniformBuffer());const To=(0,Bn.Z)({attributes:Nr,uniforms:rn,fs:Mt,vs:Ve,elements:jn,blend:lg[K.h0.normal],uniformBuffers:ji,textures:f.layerModel.textures},Te);ci&&(To.count=ci);const Ji=Rn(To);hr(Ji)})})()}createAttributes(o){const{triangulation:f}=o,{attributes:v}=this.styleAttributeService.createAttributes(this.encodedData,f);return v}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(o){const{enableHighlight:f=!0,enableSelect:v=!0}=this.getLayerConfig();let T=this.eventNames().indexOf(o)!==-1||this.eventNames().indexOf("un"+o)!==-1;return(o==="click"||o==="dblclick")&&v&&(T=!0),o==="mousemove"&&(f||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(T=!0),this.isVisible()&&T}buildModels(){return(0,Ai.Z)(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var o=this;return(0,Ai.Z)(function*(){yield o.buildModels()})()}renderMulPass(o){return(0,Ai.Z)(function*(){yield o.render()})()}renderModels(o={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(f=>{f.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(o),textures:this.layerModel.textures},(o==null?void 0:o.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(o,f,v,T){const O=this.configService.getAttributeConfig(this.id)||{};return dy(O[o],{field:f,values:v})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(o)!==-1&&this.configService.setAttributeConfig(this.id,{[o]:{field:f,values:v}}),this.startInit?this.styleAttributeService.updateStyleAttribute(o,{scale:(0,Bn.Z)({field:f},this.splitValuesAndCallbackInAttribute(v,this.getLayerConfig()[f]))},T):this.pendingStyleAttributes.push({attributeName:o,attributeField:f,attributeValues:v,updateOptions:T}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(o){console.warn("empty fn")}processData(o){return o}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var o=this;return(0,Ai.Z)(function*(){o.models.forEach(v=>v.destroy()),o.models=[],o.uniformBuffers.forEach(v=>{v.destroy()}),o.uniformBuffers=[];const f=o.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});o.uniformBuffers.push(f),o.models=yield o.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(o){return{values:py(o)?void 0:o,callback:py(o)?o:void 0}}}function B1(a,o){return{enable:a,mask:255,func:{cmp:K.gl.EQUAL,ref:o?1:0,mask:1}}}function vy(a){return a.maskOperation===K.lE.OR?{enable:!0,mask:255,func:{cmp:K.gl.ALWAYS,ref:1,mask:255},opFront:{fail:K.gl.KEEP,zfail:K.gl.REPLACE,zpass:K.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:a.stencilType===K.yn.SINGLE||a.stencilIndex===0?K.gl.ALWAYS:K.gl.LESS,ref:a.stencilType===K.yn.SINGLE?1:a.stencilIndex===0?2:1,mask:255},opFront:{fail:K.gl.KEEP,zfail:K.gl.REPLACE,zpass:K.gl.REPLACE}}}const gy={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Cm={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var cg=D(9187),Mh=D.n(cg);function yy(a){return Math.max(Math.ceil(a/4)*4,4)}function gv(a,o,f,v=!0){const T=f===3;if(v){a=a.slice();const L=[];for(let F=0;F<a.length;F+=f){L[0]=a[F],L[1]=a[F+1],T&&(L[2]=a[F+2]);const H=(0,Me.vP)(L,!0,{enable:!1,decimal:1});a[F]=H[0],a[F+1]=H[1],T&&(a[F+2]=H[2])}}return Mh()(a,o,f)}const ug="ATTRIBUTE_LOCATION_";class Rl{get attributeLocation(){return(0,Bn.Z)({},ff)}constructor(o){(0,qt.Z)(this,"triangulation",void 0),(0,qt.Z)(this,"uniformBuffers",[]),(0,qt.Z)(this,"textures",[]),(0,qt.Z)(this,"createTexture2D",void 0),(0,qt.Z)(this,"preStyleAttribute",{}),(0,qt.Z)(this,"encodeStyleAttribute",{}),(0,qt.Z)(this,"layer",void 0),(0,qt.Z)(this,"dataTexture",void 0),(0,qt.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,qt.Z)(this,"dataTextureTest",void 0),(0,qt.Z)(this,"configService",void 0),(0,qt.Z)(this,"shaderModuleService",void 0),(0,qt.Z)(this,"rendererService",void 0),(0,qt.Z)(this,"iconService",void 0),(0,qt.Z)(this,"fontService",void 0),(0,qt.Z)(this,"styleAttributeService",void 0),(0,qt.Z)(this,"mapService",void 0),(0,qt.Z)(this,"cameraService",void 0),(0,qt.Z)(this,"layerService",void 0),(0,qt.Z)(this,"pickingService",void 0),(0,qt.Z)(this,"attributeUnifoms",void 0),(0,qt.Z)(this,"commonUnifoms",void 0),this.layer=o,this.configService=o.getContainer().globalConfigService,this.rendererService=o.getContainer().rendererService,this.pickingService=o.getContainer().pickingService,this.shaderModuleService=o.getContainer().shaderModuleService,this.styleAttributeService=o.getContainer().styleAttributeService,this.mapService=o.getContainer().mapService,this.iconService=o.getContainer().iconService,this.fontService=o.getContainer().fontService,this.cameraService=o.getContainer().cameraService,this.layerService=o.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:f}=this.rendererService;this.createTexture2D=f}getBlend(){const{blend:o="normal"}=this.layer.getLayerConfig();return lg[K.h0[o]]}getStencil(o){const{mask:f=!1,maskInside:v=!0,enableMask:T,maskOperation:O=K.lE.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return vy({isStencil:!0,stencilType:K.yn.SINGLE});if(o.isStencil)return vy((0,Bn.Z)((0,Bn.Z)({},o),{},{maskOperation:O}));const L=f||T&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return B1(L,v)}getDefaultStyle(){return{}}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const v=(0,Bn.Z)((0,Bn.Z)({},f.uniformsOption),o.uniformsOption);return Object.keys(v).forEach(T=>{typeof v[T]=="boolean"&&(v[T]=v[T]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(v.u_texture=this.textures[0]),v}getAnimateUniforms(){return{}}needUpdate(){return(0,Ai.Z)(function*(){return!1})()}buildModels(){return(0,Ai.Z)(function*(){throw new Error("Method not implemented.")})()}initModels(){return(0,Ai.Z)(function*(){throw new Error("Method not implemented.")})()}clearModels(o=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(o){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(o){return[o.enable?0:1,o.duration||4,o.interval||.2,o.trailLength||.1]}startModelAnimate(){const{animateOption:o}=this.layer.getLayerConfig();o.enable&&this.layer.setAnimateStartTime()}getInject(){return _y(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const o=Object.keys(this.attributeLocation).reduce((f,v)=>{const T=ug+v;return f[T]=this.attributeLocation[v],f},{});return(0,Bn.Z)({},o)}getStyleAttribute(){const o={};return this.layer.enableShaderEncodeStyles.forEach(f=>{if(!this.layer.encodeStyleAttribute[f]){const v=this.layer.getLayerConfig()[f];let T=typeof v=="undefined"?gy[f]:v;f==="stroke"&&(T=(0,Me.CI)(T)),o["u_"+f]=T}}),o}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(o=>{const f=ag(o);f&&this.styleAttributeService.registerStyleAttribute(f)})}registerPosition64LowAttribute(o=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:K.GC.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:K.gl.FLOAT},size:2,update:(f,v,T)=>o?[(0,Me.Ks)(T[0]),(0,Me.Ks)(T[1])]:[0,0]}})}updateEncodeAttribute(o,f){this.encodeStyleAttribute[o]=f}initUniformsBuffer(){const o=this.getUniformsBufferInfo(this.getStyleAttribute()),f=this.getCommonUniformsInfo();o.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(yy(o.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),f.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(yy(f.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(o){let f=0;const v=[];return Object.values(o).forEach(T=>{Array.isArray(T)?(v.push(...T),f+=T.length):typeof T=="number"?(v.push(T),f+=1):typeof T=="boolean"&&(v.push(Number(T)),f+=1)}),{uniformsOption:o,uniformsLength:f,uniformsArray:v}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var o,f;const{uniformsArray:v}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:T}=this.getCommonUniformsInfo();(o=this.attributeUnifoms)===null||o===void 0||o.subData({offset:0,data:new Uint8Array(new Float32Array(v).buffer)}),(f=this.commonUnifoms)===null||f===void 0||f.subData({offset:0,data:new Uint8Array(new Float32Array(T).buffer)})}}function _y(a,o){const f=[];let v="";a.forEach(L=>{const F=L.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),H=ug+F;o[L]?v+=`#define USE_ATTRIBUTE_${F} 0.0 
`:f.push(`  ${Cm[L]} u_${L};`),v+=`
#ifdef USE_ATTRIBUTE_${F}
layout(location = ${H}) in ${Cm[L]} a_${L.charAt(0).toUpperCase()+L.slice(1)};
#endif 
`});const T=f.length?`
layout(std140) uniform AttributeUniforms {
  ${f.join(`
`)}
};
`:"";v+=T;let O="";return a.forEach(L=>{const F=L.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();O+=`
  #ifdef USE_ATTRIBUTE_${F}
    ${Cm[L]} ${L} = a_${L.charAt(0).toUpperCase()+L.slice(1)};
  #else
    ${Cm[L]} ${L} = u_${L};
  #endif
  `}),{"vs:#decl":v,"fs:#decl":T,"vs:#main-start":O}}const by=100,cb=36,F1=40;function fg(a){return a/180*Math.acos(-1)}function Om(a){const o=fg(a[0])+Math.PI/2,f=fg(a[1]),v=by+Math.random()*.4,T=v*Math.cos(f)*Math.cos(o),O=v*Math.cos(f)*Math.sin(o),L=v*Math.sin(f);return[O,L,T]}function ub(a,o){const f=mat4.create(),v=mat4.create(),T=vec3.fromValues(0,1,0),O=vec3.fromValues(0,0,0);o=o||{},a=typeof a!="undefined"?a:1;const F=2+(typeof o.segments!="undefined"?o.segments:32),H=2*F,ie=[],ge=[],Te=[],Ve=[],Mt=[],rn=[];for(let Rn=0;Rn<=F;Rn++){const hr=Rn/F,Nr=hr*Math.PI;for(let jn=0;jn<=H;jn++){const ci=jn/H,ji=ci*Math.PI*2;mat4.identity(v),mat4.rotateZ(v,v,-Nr),mat4.identity(f),mat4.rotateY(f,f,ji),vec3.transformMat4(O,T,v),vec3.transformMat4(O,O,f),vec3.scale(O,O,-a),Te.push(O.slice()),Ve.push(...O.slice()),vec3.normalize(O,O),Mt.push(...O.slice()),rn.push([ci,1-hr]),Ve.push(ci,1-hr)}if(Rn>0){const jn=Te.length;let ci=jn-2*(H+1);for(;ci+H+2<jn;ci++)ie.push([ci,ci+1,ci+H+1]),ge.push(ci,ci+1,ci+H+1),ie.push([ci+H+1,ci+1,ci+H+2]),ge.push(ci+H+1,ci+1,ci+H+2)}}return{cells:ie,positions:Te,uvs:rn,positionsArr:Ve,indicesArr:ge,normalArr:Mt}}var ds=D(31437);const xy=ds.Ue(),hg=ds.Ue(),Ph=ds.Ue(),Rm=ds.Ue(),Mm=ds.Ue();function Ey(a,o,f,v,T){ds.IH(a,f,v),ds.Fv(a,a),o=ds.al(-a[1],a[0]);const O=ds.al(-f[1],f[0]);return[T/ds.AK(o,O),o]}function G0(a,o){return ds.t8(a,-o[1],o[0])}function yv(a,o,f){return ds.lu(a,o,f),ds.Fv(a,a),a}function dg(a,o){return a[0]===o[0]&&a[1]===o[1]}function fb(a){const o=new Map;for(let f=0;f<a.length;f++){const v=a[0].toString()+"-"+a[1].toString();o.get(v)?(a.splice(f,1),f++):o.set(v,v)}return a}class od{constructor(o={}){(0,qt.Z)(this,"complex",void 0),(0,qt.Z)(this,"join",void 0),(0,qt.Z)(this,"cap",void 0),(0,qt.Z)(this,"miterLimit",void 0),(0,qt.Z)(this,"thickness",void 0),(0,qt.Z)(this,"normal",void 0),(0,qt.Z)(this,"lastFlip",-1),(0,qt.Z)(this,"miter",ds.al(0,0)),(0,qt.Z)(this,"started",!1),(0,qt.Z)(this,"dash",!1),(0,qt.Z)(this,"totalDistance",0),(0,qt.Z)(this,"currentIndex",0),this.join=o.join||"miter",this.cap=o.cap||"butt",this.miterLimit=o.miterLimit||10,this.thickness=o.thickness||1,this.dash=o.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(o){const f=this.complex;if(o.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const v=o.length;let T=f.startIndex;for(let O=1;O<v;O++){const L=o[O-1],F=o[O],H=O<o.length-1?o[O+1]:null,ie=this.simpleSegment(f,T,L,F,H);T+=ie}if(this.dash)for(let O=0;O<f.positions.length/6;O++)f.positions[O*6+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}extrude(o){const f=this.complex;if(o.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const v=o.length;let T=f.startIndex;for(let O=1;O<v;O++){const L=o[O-1],F=o[O],H=O<o.length-1?o[O+1]:null,ie=this.segment(f,T,L,F,H);T+=ie}if(this.dash)for(let O=0;O<f.positions.length/6;O++)f.positions[O*6+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}simpleSegment(o,f,v,T,O){let L=0;const F=o.indices,H=o.positions,ie=o.normals,ge=(0,Me.Z)([T[0],T[1]]),Te=(0,Me.Z)([v[0],v[1]]);yv(Ph,ge,Te);let Ve=0;if(this.dash&&(Ve=this.lineSegmentDistance(ge,Te),this.totalDistance+=Ve),this.normal||(this.normal=ds.Ue(),G0(this.normal,Ph)),this.started||(this.started=!0,this.extrusions(H,ie,v,this.normal,this.thickness,this.totalDistance-Ve)),F.push(f+0,f+1,f+2),!O)G0(this.normal,Ph),this.extrusions(H,ie,T,this.normal,this.thickness,this.totalDistance),F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),L+=2;else{const Mt=(0,Me.Z)([O[0],O[1]]);dg(ge,Mt)&&ds.IH(Mt,ge,ds.Fv(Mt,ds.$X(Mt,ge,Te))),yv(Rm,Mt,ge);const[rn,Rn]=Ey(Mm,ds.Ue(),Ph,Rm,this.thickness);let hr=ds.AK(Mm,this.normal)<0?-1:1;this.extrusions(H,ie,T,Rn,rn,this.totalDistance),F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),hr=-1,ds.JG(this.normal,Rn),L+=2,this.lastFlip=hr}return L}segment(o,f,v,T,O){let L=0;const F=o.indices,H=o.positions,ie=o.normals,ge=this.cap==="square",Te=this.join==="bevel",Ve=(0,Me.Z)([T[0],T[1]]),Mt=(0,Me.Z)([v[0],v[1]]);yv(Ph,Ve,Mt);let rn=0;if(this.dash&&(rn=this.lineSegmentDistance(Ve,Mt),this.totalDistance+=rn),this.normal||(this.normal=ds.Ue(),G0(this.normal,Ph)),!this.started)if(this.started=!0,ge){const Rn=ds.Ue(),hr=ds.Ue();ds.IH(Rn,this.normal,Ph),ds.IH(hr,this.normal,Ph),ie.push(hr[0],hr[1],0),ie.push(Rn[0],Rn[1],0),H.push(v[0],v[1],v[2]|0,this.totalDistance-rn,-this.thickness,v[2]|0),this.complex.indexes.push(this.currentIndex),H.push(v[0],v[1],v[2]|0,this.totalDistance-rn,this.thickness,v[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(H,ie,v,this.normal,this.thickness,this.totalDistance-rn);if(F.push(f+0,f+1,f+2),O){const Rn=(0,Me.Z)([O[0],O[1]]);dg(Ve,Rn)&&ds.IH(Rn,Ve,ds.Fv(Rn,ds.$X(Rn,Ve,Mt))),yv(Rm,Rn,Ve);const[hr,Nr]=Ey(Mm,ds.Ue(),Ph,Rm,this.thickness);let jn=ds.AK(Mm,this.normal)<0?-1:1,ci=Te;!ci&&this.join==="miter"&&hr>this.miterLimit&&(ci=!0),ci?(ie.push(this.normal[0],this.normal[1],0),ie.push(Nr[0],Nr[1],0),H.push(T[0],T[1],T[2]|0,this.totalDistance,-this.thickness*jn,T[2]|0),this.complex.indexes.push(this.currentIndex),H.push(T[0],T[1],T[2]|0,this.totalDistance,this.thickness*jn,T[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,F.push(...this.lastFlip!==-jn?[f,f+2,f+3]:[f+2,f+1,f+3]),F.push(f+2,f+3,f+4),G0(xy,Rm),ds.JG(this.normal,xy),ie.push(this.normal[0],this.normal[1],0),H.push(T[0],T[1],T[2]|0,this.totalDistance,-this.thickness*jn,T[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,L+=3):(this.extrusions(H,ie,T,Nr,hr,this.totalDistance),F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),jn=-1,ds.JG(this.normal,Nr),L+=2),this.lastFlip=jn}else{if(G0(this.normal,Ph),ge){const Rn=ds.Ue(),hr=ds.Ue();ds.lu(hr,Ph,this.normal),ds.IH(Rn,Ph,this.normal),ie.push(hr[0],hr[1],0),ie.push(Rn[0],Rn[1],0),H.push(T[0],T[1],T[2]|0,this.totalDistance,this.thickness,T[2]|0),this.complex.indexes.push(this.currentIndex),H.push(T[0],T[1],T[2]|0,this.totalDistance,this.thickness,T[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(H,ie,T,this.normal,this.thickness,this.totalDistance);F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),L+=2}return L}extrusions(o,f,v,T,O,L){f.push(T[0],T[1],0),f.push(T[0],T[1],0),o.push(v[0],v[1],v[2]|0,L,-O,v[2]|0),this.complex.indexes.push(this.currentIndex),o.push(v[0],v[1],v[2]|0,L,O,v[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(o,f){const v=f[0]-o[0],T=f[1]-o[1];return Math.sqrt(v*v+T*T)}}let Up=function(a){return a.CYLINDER="cylinder",a.SQUARECOLUMN="squareColumn",a.TRIANGLECOLUMN="triangleColumn",a.HEXAGONCOLUMN="hexagonColumn",a.PENTAGONCOLUMN="pentagonColumn",a}({}),g0=function(a){return a.CIRCLE="circle",a.SQUARE="square",a.TRIANGLE="triangle",a.HEXAGON="hexagon",a.PENTAGON="pentagon",a}({});function ip(a,o=0){const f=Math.PI*2/a,v=[];for(let O=0;O<a;O++)v.push(f*O+o*Math.PI/12);return v.map(O=>{const L=Math.sin(O+Math.PI/4),F=Math.cos(O+Math.PI/4);return[L,F,0]})}function _v(){return ip(30)}function hb(){return ip(4)}function db(){return ip(3)}function pb(){return ip(6,1)}function mb(){return ip(5)}const Sy={[g0.CIRCLE]:_v,[g0.HEXAGON]:pb,[g0.TRIANGLE]:db,[g0.SQUARE]:hb,[g0.PENTAGON]:mb,[Up.CYLINDER]:_v,[Up.HEXAGONCOLUMN]:pb,[Up.TRIANGLECOLUMN]:db,[Up.SQUARECOLUMN]:hb,[Up.PENTAGONCOLUMN]:mb};var ql=D(77160);function Aw(a){const o=a[0][0],f=a[0][a[0].length-1];o[0]===f[0]&&o[1]===f[1]&&(a[0]=a[0].slice(0,a[0].length-1));const v=a[0].length,T=earcut.flatten(a),{vertices:O,dimensions:L}=T,F=[],H=[];for(let ge=0;ge<O.length/L;ge++)L===2?F.push(O[ge*2],O[ge*2+1],1):F.push(O[ge*3],O[ge*3+1],1);const ie=earcut(T.vertices,T.holes,T.dimensions);H.push(...ie);for(let ge=0;ge<v;ge++){const Te=T.vertices.slice(ge*L,(ge+1)*L);let Ve=T.vertices.slice((ge+1)*L,(ge+2)*L);Ve.length===0&&(Ve=T.vertices.slice(0,L));const Mt=F.length/3;F.push(Te[0],Te[1],1,Ve[0],Ve[1],1,Te[0],Te[1],0,Ve[0],Ve[1],0),H.push(...[0,2,1,2,3,1].map(rn=>rn+Mt))}return{positions:F,index:H}}function Cw(a){const o=earcut.flatten(a),f=earcut(o.vertices,o.holes,o.dimensions);return{positions:o.vertices,index:f}}function vb(a,o=!1){const f=a[0][0],v=a[0][a[0].length-1];f[0]===v[0]&&f[1]===v[1]&&(a[0]=a[0].slice(0,a[0].length-1));const T=a[0].length,O=Mh().flatten(a),{vertices:L,dimensions:F,holes:H}=O,ie=[],ge=[],Te=[];for(let Mt=0;Mt<L.length/F;Mt++)ie.push(L[Mt*F],L[Mt*F+1],1,-1,-1),Te.push(0,0,1);const Ve=gv(L,H,F,o);ge.push(...Ve);for(let Mt=0;Mt<T;Mt++){const rn=O.vertices.slice(Mt*F,(Mt+1)*F);let Rn=O.vertices.slice((Mt+1)*F,(Mt+2)*F);Rn.length===0&&(Rn=O.vertices.slice(0,F));const hr=ie.length/5;ie.push(rn[0],rn[1],1,0,0,Rn[0],Rn[1],1,.1,0,rn[0],rn[1],0,0,.8,Rn[0],Rn[1],0,.1,.8);const Nr=B2([Rn[0],Rn[1],1],[rn[0],rn[1],0],[rn[0],rn[1],1],o);Te.push(...Nr,...Nr,...Nr,...Nr),ge.push(...[1,2,0,3,2,1].map(jn=>jn+hr))}return{positions:ie,index:ge,normals:Te}}function B2(a,o,f,v=!1){const T=ql.Ue(),O=ql.Ue(),L=ql.Ue();v&&(a=(0,Me.vP)(a),o=(0,Me.vP)(o),f=(0,Me.vP)(f));const F=ql.al(...a),H=ql.al(...o),ie=ql.al(...f);ql.lu(T,ie,H),ql.lu(O,F,H),ql.kC(L,T,O);const ge=ql.Ue();return ql.Fv(ge,L),ge}const Ty={};function op(a){const o=(0,Me.SI)(a.coordinates);return{vertices:[...o,...o,...o,...o],indices:[0,1,2,2,3,0],size:o.length}}function F2(a){const o=(0,Me.SI)(a.coordinates),f=Om(o);return{vertices:[...f,...f,...f,...f],indices:[0,1,2,2,3,0],size:f.length}}function k2(a){const{shape:o}=a,{positions:f,index:v,normals:T}=U1(o,!1);return{vertices:f,indices:v,normals:T,size:5}}function kM(a){const o=(0,Me.SI)(a.coordinates);return{vertices:[...o],indices:[0],size:o.length}}function k1(a){const{coordinates:o}=a,f=new od({dash:!0,join:"bevel"});let v=o;v[0]&&!Array.isArray(v[0][0])&&(v=[o]),v.forEach(O=>{f.extrude(O)});const T=f.complex;return{vertices:T.positions,indices:T.indices,normals:T.normals,indexes:T.indexes,size:6}}function Ow(a){const o=a.coordinates.flat(),f=1,v=1;return{vertices:[1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o,1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o],normals:[-f,2*v,1,2*v,-v,1,v,-v,1,v,-v,1,-f,-v,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Rw(a){const{coordinates:o}=a,f=[];if(!Array.isArray(o[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:v,totalDistance:T}=Mw(o);return v.map(O=>{f.push(O[0],O[1],O[2],O[3],0,T)}),{vertices:f,indices:[],normals:[],size:6,count:v.length}}function zM(a){const{coordinates:o}=a,f=[];if(!Array.isArray(o[0]))return{vertices:[],indices:[],size:4,count:0};const{results:v}=Pw(o);return v.map(T=>{f.push(T[0],T[1],T[2],T[3])}),{vertices:f,indices:[],size:4,count:v.length}}function z2(a,o){const f=o[0]-a[0],v=o[1]-a[1];return Math.sqrt(f*f+v*v)}function pg(a,o){return a.length<3&&a.push(0),o!==void 0&&a.push(o),a}function Mw(a){let o=a;Array.isArray(o)&&Array.isArray(o[0])&&Array.isArray(o[0][0])&&(o=a.flat());let f=0;if(o.length<2)return{results:o,totalDistance:0};{const v=[],T=pg(o[0],f);v.push(T);for(let L=1;L<o.length-1;L++){const F=z2((0,Me.Z)(o[L-1]),(0,Me.Z)(o[L]));f+=F;const H=pg(o[L],f);v.push(H),v.push(H)}const O=z2((0,Me.Z)(o[o.length-2]),(0,Me.Z)(o[o.length-1]));return f+=O,v.push(pg(o[o.length-1],f)),{results:v,totalDistance:f}}}function Pw(a){if(a.length<2)return{results:a};{const o=[],f=pg(a[0]);o.push(f);for(let v=1;v<a.length-1;v++){const T=pg(a[v]);o.push(T),o.push(T)}return o.push(pg(a[a.length-1])),{results:o}}}function wy(a){const{coordinates:o}=a,f=Mh().flatten(o),{vertices:v,dimensions:T,holes:O}=f;return{indices:gv(v,O,T),vertices:v,size:T}}function Iw(a){const{indices:o,vertices:f,size:v}=wy(a);return{indices:o,vertices:Lw(f),size:v+4}}function Lw(a){const o=[],{center:f,radius:v}=(0,Me.Rx)(a);for(let T=0;T<a.length;T+=2){const O=a[T],L=a[T+1];o.push(O,L,0,...f,v)}return o}function U2(a){const o=a.coordinates,{positions:f,index:v,normals:T}=vb(o,!0);return{vertices:f,indices:v,normals:T,size:5}}function UM(a){const{shape:o}=a,{positions:f,index:v}=j1(o);return{vertices:f,indices:v,size:3}}function z1(a){const o=a.coordinates;return{vertices:[...o[0],0,0,0,...o[1],0,1,0,...o[2],0,1,1,...o[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function gb(a,o){const{segmentNumber:f=30}=o,v=a.coordinates,T=[],O=[];for(let L=0;L<f;L++)T.push(L,1,L,v[0][0],v[0][1],v[1][0],v[1][1],L,-1,L,v[0][0],v[0][1],v[1][0],v[1][1]),L!==f-1&&O.push(...[0,1,2,1,3,2].map(F=>L*2+F));return{vertices:T,indices:O,size:7}}function jM(a){const o=a.coordinates;o.length===2&&o.push(0);const f=jp(-1,1),v=jp(1,1),T=jp(-1,-1),O=jp(1,-1);return{vertices:[...o,...f,...o,...T,...o,...O,...o,...v],indices:[0,1,2,3,0,2],size:5}}function U1(a,o=!1){if(Ty&&Ty[a])return Ty[a];const f=Sy[a]?Sy[a]():Sy.cylinder(),v=vb([f],o);return Ty[a]=v,v}function VM(a,o,f=3,v=!1){const T=new Float32Array(a.length/f*3);let O,L,F;const H=vec3.create(),ie=vec3.create(),ge=vec3.create();for(let Te=0,Ve=o.length;Te<Ve;Te+=3){O=o[Te+0]*3,L=o[Te+1]*3,F=o[Te+2]*3;let Mt=[a[O],a[O+1]],rn=[a[L],a[L+1]],Rn=[a[F],a[F+1]];v&&(Mt=lngLatToMeters(Mt),rn=lngLatToMeters(rn),Rn=lngLatToMeters(Rn));const[hr,Nr]=Mt,jn=vec3.fromValues(hr,Nr,a[O+2]),[ci,ji]=rn,To=vec3.fromValues(ci,ji,a[L+2]),[Ji,Hr]=Rn,Gi=vec3.fromValues(Ji,Hr,a[F+2]);vec3.sub(H,Gi,To),vec3.sub(ie,jn,To),vec3.cross(ge,H,ie),T[O]+=H[0],T[O+1]+=H[1],T[O+2]+=H[2],T[L]+=H[0],T[L+1]+=H[1],T[L+2]+=H[2],T[F]+=H[0],T[F+1]+=H[1],T[F+2]+=H[2]}return bv(T),T}function bv(a){for(let o=0,f=a.length;o<f;o+=3){const v=vec3.fromValues(a[o],a[o+1],a[o+2]),T=vec3.create();vec3.normalize(T,v),a.set(T,o)}}function HM(a){const o=a[0][0],f=a[0][a[0].length-1];return o[0]===f[0]&&o[1]===f[1]}function j1(a){const o=["cylinder","triangleColumn","hexagonColumn","squareColumn"],f=geometryShape[a]?geometryShape[a]():geometryShape.circle();return o.indexOf(a)===-1?fillPolygon([f]):extrudePolygon([f])}function jp(a,o){const f=(a+1)/2,v=(o+1)/2;return[f,v]}function Dw(){const a=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),{positionsArr:o,indicesArr:f,normalArr:v}=a;return{vertices:o,indices:f,size:5,normals:v}}function ZM(){const a=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),{positionsArr:o,indicesArr:f,normalArr:v}=a;return{vertices:o,indices:f,size:5,normals:v}}const yb=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,Nw=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // \u6B63\u5411
    return mid;
  } else {
    // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F
    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,j2={solid:0,dash:1};class V2 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5],forward:L=!0,lineTexture:F=!1,iconStep:H=100,segmentNumber:ie=30}=this.layer.getLayerConfig(),{animateOption:ge}=this.layer.getLayerConfig();let Te=O;T!=="dash"&&(Te=[0,0]),Te.length===2&&Te.push(0,0);let Ve=0,Mt=[0,0,0,0],rn=[0,0,0,0];if(o&&f&&(Mt=(0,Me.CI)(o),rn=(0,Me.CI)(f),Ve=1),this.rendererService.getDirty()){var Rn;(Rn=this.texture)===null||Rn===void 0||Rn.bind()}const hr={u_animate:this.animateOption2Array(ge),u_dash_array:Te,u_sourceColor:Mt,u_targetColor:rn,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:ie,u_lineDir:L?1:-1,u_icon_step:H,u_line_texture:F?1:0,u_textureBlend:v==="normal"?0:1,u_blur:.9,u_line_type:j2[T||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Ve};return this.getUniformsBufferInfo(hr)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:yb,vert:Nw,type:""}}buildModels(){var o=this;return(0,Ai.Z)(function*(){o.initUniformsBuffer();const{segmentNumber:f=30}=o.layer.getLayerConfig(),{frag:v,vert:T,type:O}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:"lineArc2d"+O,vertexShader:T,fragmentShader:v,defines:o.getDefines(),inject:o.getInject(),triangulation:gb,depth:{enable:!1},styleOption:{segmentNumber:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Me.Ks)(v[3]),(0,Me.Ks)(v[4]),(0,Me.Ks)(v[5]),(0,Me.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:K.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{thetaOffset:f=1}=o;return[f]}}})}}const Bw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Fw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,kw={solid:0,dash:1};class H2 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5],lineTexture:L=!1,iconStep:F=100,segmentNumber:H=30,globalArcHeight:ie=10}=this.layer.getLayerConfig(),{animateOption:ge}=this.layer.getLayerConfig();O.length===2&&O.push(0,0);let Te=0,Ve=[0,0,0,0],Mt=[0,0,0,0];if(o&&f&&(Ve=(0,Me.CI)(o),Mt=(0,Me.CI)(f),Te=1),this.rendererService.getDirty()){var rn;(rn=this.texture)===null||rn===void 0||rn.bind()}const Rn={u_animate:this.animateOption2Array(ge),u_dash_array:O,u_sourceColor:Ve,u_targetColor:Mt,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:by,u_global_height:ie,segmentNumber:H,u_line_type:kw[T]||0,u_icon_step:F,u_line_texture:L?1:0,u_textureBlend:v==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Te};return this.getUniformsBufferInfo(Rn)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:Bw,vert:Fw,type:""}}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{segmentNumber:f=30}=o.layer.getLayerConfig(),{frag:v,vert:T,type:O}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:"lineArc3d"+O,vertexShader:T,fragmentShader:v,defines:o.getDefines(),inject:o.getInject(),triangulation:gb,styleOption:{segmentNumber:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Me.Ks)(v[3]),(0,Me.Ks)(v[4]),(0,Me.Ks)(v[5]),(0,Me.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:K.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{thetaOffset:f=1}=o;return[f]}}})}}const Z2={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},ad=1/2;function zw(a,o){const{width:f=2,height:v=1}=o;return{vertices:[0,ad*a,1*a*f,-(v+ad)*a,1*a*f,(v-ad)*a,0,ad*a,1*a*f,-(v+ad)*a,1*a*f,(v-ad)*a],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*a,-2*a,1,-2*a,1.5*a,1,1*a,1.5*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function Uw(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,1*a*f,1*v,1*a*f,-1*v,0,0,1*a*f,1*v,1*a*f,-1*v],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*a,1,2,1*a,1,-2,1*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function jw(a,o){const{width:f=2,height:v=2}=o;return{vertices:[0,v/2,a*f*1,v/2,a*f*1,-v/2,0,-v/2,0,v/2,a*f*1,v/2,a*f*1,-v/2,0,-v/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Vw(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,1*f*a,.5*v,2*f*a,0,1*f*a,-.5*v,0,0,1*f*a,.5*v,2*f*a,0,1*f*a,-.5*v],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Pm(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,2*a*f,1*v,1.5*a*f,0,2*a*f,-1*v,0,0,2*a*f,1*v,1.5*a*f,0,2*a*f,-1*v],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function V1(a,o){const{width:f=2,height:v=2}=o,T=_v(),O=Mh().flatten([T]),L=Mh()(O.vertices,O.holes,O.dimensions),F=T.map(H=>[H[0]*f*a,H[1]*v]).flat();return{vertices:[...F,...F],dimensions:2,indices:L.map(H=>H+T.length),outLineIndices:L,normals:[...T.map(H=>[H[1]*v,H[0]*f*a,1]).flat(),...new Array(T.length*3).fill(0)]}}function W2(a,o=0,f){const v=typeof f.source=="object"?f.source.type:f.source,T=typeof f.target=="object"?f.target.type:f.target,{width:O=v?Z2[v]:0}=typeof f.source=="object"?f.source:{},{width:L=T?Z2[T]:0}=typeof f.target=="object"?f.target:{};return{vertices:[0,ad,1*O,...a,1,ad,-1*L,...a,1,-ad,-1*L,...a,0,-ad,1*O,...a,0,ad,1*O,...a,1,ad,-1*L,...a,1,-ad,-1*L,...a,0,-ad,1*O,...a],outLineIndices:[0,1,2,0,2,3].map(F=>F+o),indices:[4,5,6,4,6,7].map(F=>F+o),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function _b(a,o){const f=typeof a=="object"?a.type:a,v=o==="source"?1:-1,T=typeof a=="object"?a:{};switch(f){case"circle":return V1(v,T);case"triangle":return Uw(v,T);case"diamond":return Vw(v,T);case"rect":return jw(v,T);case"classic":return Pm(v,T);case"halfTriangle":return zw(v,T);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function G2(a){const o=a.coordinates.flat(),f=1,v=1;return{vertices:[1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o,1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o],normals:[-f,2*v,1,2*v,-v,1,v,-v,1,v,-v,1,-f,-v,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function bb(a,o){return o?Hw(a,o):G2(a)}function Hw(a,o){const f=a.coordinates.flat(),{target:v="classic",source:T="circle"}=o,O=X2(_b(T,"source"),f,0,0),L=W2(f,O.vertices.length/7,o),F=X2(_b(v,"target"),f,1,O.vertices.length/7+L.vertices.length/7);return{vertices:[...O.vertices,...L.vertices,...F.vertices],indices:[...O.outLineIndices,...L.outLineIndices,...F.outLineIndices,...O.indices,...L.indices,...F.indices],normals:[...O.normals,...L.normals,...F.normals],size:7}}function X2(a,o,f=1,v=0){const T=[],{vertices:O,indices:L,dimensions:F,outLineIndices:H}=a;for(let ie=0;ie<O.length;ie+=F)T.push(f,O[ie+1],O[ie],...o);return(0,Bn.Z)((0,Bn.Z)({},a),{},{vertices:T,indices:L.map(ie=>ie+v),outLineIndices:H.map(ie=>ie+v)})}const WM=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,GM=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source_world = a_Instance.rg; // \u8D77\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class XM extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:o=2,strokeWidth:f=1,strokeOpacity:v=1}=this.layer.getLayerConfig(),T={u_gap_width:o,u_stroke_width:f,u_stroke_opacity:v};return this.getUniformsBufferInfo(T)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return[yield o.layer.buildLayerModel({moduleName:"flow_line",vertexShader:GM,fragmentShader:WM,defines:o.getDefines(),inject:o.getInject(),triangulation:bb,styleOption:o.layer.getLayerConfig().symbol,primitive:K.gl.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Me.Ks)(v[3]),(0,Me.Ks)(v[4]),(0,Me.Ks)(v[5]),(0,Me.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}})}}const YM=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,$M=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,KM={solid:0,dash:1};class qM extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5],lineTexture:L=!1,iconStep:F=100,segmentNumber:H=30}=this.layer.getLayerConfig(),{animateOption:ie}=this.layer.getLayerConfig();if(O.length===2&&O.push(0,0),this.rendererService.getDirty()){var ge;(ge=this.texture)===null||ge===void 0||ge.bind()}let Te=0,Ve=[0,0,0,0],Mt=[0,0,0,0];o&&f&&(Ve=(0,Me.CI)(o),Mt=(0,Me.CI)(f),Te=1);let rn=this.layer.getLayerAnimateTime();isNaN(rn)&&(rn=0);const Rn={u_animate:this.animateOption2Array(ie),u_dash_array:O,u_sourceColor:Ve,u_targetColor:Mt,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:H,u_line_type:KM[T]||0,u_icon_step:F,u_line_texture:L?1:0,u_textureBlend:v==="normal"?0:1,u_time:rn,u_linearColor:Te};return this.getUniformsBufferInfo(Rn)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{segmentNumber:f=30}=o.layer.getLayerConfig();return[yield o.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:$M,fragmentShader:YM,triangulation:gb,styleOption:{segmentNumber:f},defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Me.Ks)(v[3]),(0,Me.Ks)(v[4]),(0,Me.Ks)(v[5]),(0,Me.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}})}}let QM=function(a){return a[a.solid=0]="solid",a[a.dash=1]="dash",a}({}),Y2=function(a){return a.VERTICAL="vertical",a.HORIZONTAL="horizontal",a}({}),Zw=function(a){return a.NORMAL="normal",a.REPLACE="replace",a}({}),xb=function(a){return a[a.pixel=0]="pixel",a[a.meter=1]="meter",a}({}),JM=function(a){return a.ALWAYS="always",a.DRAGEND="dragend",a}({});const Ww=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,Gw=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class $2 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"textureEventFlag",!1),(0,qt.Z)(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5,0,0],lineTexture:L=!1,iconStep:F=100,vertexHeightScale:H=20,strokeWidth:ie=0,raisingHeight:ge=0,heightfixed:Te=!1,linearDir:Ve=Y2.VERTICAL,blur:Mt=[1,1,1,0]}=this.layer.getLayerConfig();let rn=O;if(T!=="dash"&&(rn=[0,0,0,0]),rn.length===2&&rn.push(0,0),this.rendererService.getDirty()&&this.texture){var Rn;(Rn=this.texture)===null||Rn===void 0||Rn.bind()}const{animateOption:hr}=this.layer.getLayerConfig();let Nr=0,jn=[0,0,0,0],ci=[0,0,0,0];o&&f&&(jn=(0,Me.CI)(o),ci=(0,Me.CI)(f),Nr=1);const ji={u_animate:this.animateOption2Array(hr),u_dash_array:rn,u_blur:Mt,u_sourceColor:jn,u_targetColor:ci,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:F,u_heightfixed:Number(Te),u_vertexScale:H,u_raisingHeight:Number(ge),u_strokeWidth:ie,u_textureBlend:v===Zw.NORMAL?0:1,u_line_texture:L?1:0,u_linearDir:Ve===Y2.VERTICAL?1:0,u_linearColor:Nr,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(ji)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.textureEventFlag||(o.textureEventFlag=!0,o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture)),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{depth:f=!1}=o.layer.getLayerConfig(),{frag:v,vert:T,type:O}=o.getShaders();return o.layer.triangulation=k1,[yield o.layer.buildLayerModel({moduleName:"line"+O,vertexShader:T,fragmentShader:v,triangulation:k1,defines:o.getDefines(),inject:o.getInject(),depth:{enable:f}})]})()}getShaders(){return{frag:Ww,vert:Gw,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:K.GC.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O,L)=>L===void 0?[v[3],10,v[4]]:[v[3],L,v[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:K.GC.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v,T,O)=>[...O,v[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}})}}const Xw=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,Yw=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class $w extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,lineType:v="solid",dashArray:T=[10,5,0,0],vertexHeightScale:O=20}=this.layer.getLayerConfig();let L=T;v!=="dash"&&(L=[0,0,0,0]),L.length===2&&L.push(0,0);let F=0,H=[0,0,0,0],ie=[0,0,0,0];o&&f&&(H=(0,Me.CI)(o),ie=(0,Me.CI)(f),F=1);const ge={u_sourceColor:H,u_targetColor:ie,u_dash_array:L,u_vertexScale:O,u_linearColor:F};return this.getUniformsBufferInfo(ge)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}getShaders(){return{frag:Xw,vert:Yw,type:"lineSimpleNormal"}}buildModels(){var o=this;return(0,Ai.Z)(function*(){o.initUniformsBuffer();const{frag:f,vert:v,type:T}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,triangulation:Rw,defines:o.getDefines(),inject:o.getInject(),primitive:K.gl.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:K.GC.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>{const{size:T=1}=o,O=Array.isArray(T)?[T[0],T[1]]:[T,0];return[O[0],O[1],v[3],v[5]]}}})}}const K2=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,Kw=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class q2 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",heightfixed:T=!1,lineTexture:O=!1,iconStep:L=100,iconStepCount:F=1}=this.layer.getLayerConfig(),{animateOption:H}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var ie;(ie=this.texture)===null||ie===void 0||ie.bind()}let ge=0,Te=[0,0,0,0],Ve=[0,0,0,0];o&&f&&(Te=(0,Me.CI)(o),Ve=(0,Me.CI)(f),ge=1);const Mt={u_animate:this.animateOption2Array(H),u_sourceColor:Te,u_targetColor:Ve,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:L,u_heightfixed:Number(T),u_linearColor:ge,u_line_texture:O?1:0,u_textureBlend:v==="normal"?0:1,u_iconStepCount:F,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Mt)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ai.Z)(function*(){return[yield o.layer.buildLayerModel({moduleName:"lineWall",vertexShader:Kw,fragmentShader:K2,triangulation:k1,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},blend:o.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:K.GC.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v)=>[v[3],v[4],v[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}})}}var Q2={arc:V2,arc3d:H2,greatcircle:qM,wall:q2,line:$2,simple:$w,flowline:XM,earthArc3d:H2};class Eb extends v0{constructor(...o){super(...o),(0,qt.Z)(this,"type","LineLayer"),(0,qt.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,qt.Z)(this,"arrowInsertCount",0),(0,qt.Z)(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var o=this;return(0,Ai.Z)(function*(){const f=o.getModelType();o.layerModel=new Q2[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[o]}getModelType(){var o;if(this.layerType)return this.layerType;const f=this.styleAttributeService.getLayerStyleAttribute("shape");return(f==null||(o=f.scale)===null||o===void 0?void 0:o.field)||"line"}processData(o){if(this.getModelType()!=="simple")return o;const f=[];return o.map(v=>{if(Array.isArray(v.coordinates)&&Array.isArray(v.coordinates[0])&&Array.isArray(v.coordinates[0][0])){const T=(0,Bn.Z)({},v);v.coordinates.map(O=>{f.push((0,Bn.Z)((0,Bn.Z)({},T),{},{coordinates:O}))})}else f.push(v)}),f}}const Sb=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,qw=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if (u_heightfixed < 1.0) {
    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
  } else {
    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if (u_linearColor == 1.0) {
    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;class y0 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"raiseCount",0),(0,qt.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:o={enable:!1,speed:.01,repeat:!1},sourceColor:f,targetColor:v,pickLight:T=!1,heightfixed:O=!1,opacityLinear:L={enable:!1,dir:"up"},lightEnable:F=!0}=this.layer.getLayerConfig();let H=0,ie=[0,0,0,0],ge=[0,0,0,0];if(f&&v&&(ie=(0,Me.CI)(f),ge=(0,Me.CI)(v),H=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){const{speed:Mt=.01}=o;this.raiseCount+=Mt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const Te={u_pickLight:Number(T),u_heightfixed:Number(O),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:H,u_sourceColor:ie,u_targetColor:ge,u_opacitylinear:Number(L.enable),u_opacitylinear_dir:L.dir==="up"?1:0,u_lightEnable:Number(F)};return this.getUniformsBufferInfo(Te)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{depth:f=!0,animateOption:{repeat:v=1}}=o.layer.getLayerConfig();return o.raiseRepeat=v,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:qw,fragmentShader:Sb,triangulation:k2,defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:K.gl.FRONT},depth:{enable:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:o=>{const{size:f}=o;if(f){let v=[];return Array.isArray(f)&&(v=f.length===2?[f[0],f[0],f[1]]:f),Array.isArray(f)||(v=[f,f,f]),v}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:o=>{const f=(0,Me.SI)(o.coordinates);return[f[0],f[1],(0,Me.Ks)(f[0]),(0,Me.Ks)(f[1])]}}})}}const Qw=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,Jw=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Tb extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:o=1,strokeWidth:f=0,blend:v,blur:T=0,raisingHeight:O=0,heightfixed:L=!1,unit:F="pixel"}=this.layer.getLayerConfig();let H=this.getAnimateUniforms().u_time;isNaN(H)&&(H=-1);const ie={u_blur_height_fixed:[T,Number(O),Number(L)],u_stroke_width:f,u_additive:v==="additive"?1:0,u_stroke_opacity:o,u_size_unit:xb[F],u_time:H,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(ie)}getAnimateUniforms(){const{animateOption:o={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),op)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{frag:f,vert:v,type:T}=o.getShaders();return o.layer.triangulation=op,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:op,depth:{enable:!1}})]})()}getShaders(){return{frag:Qw,vert:Jw,type:"pointFill"}}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){const o=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(f,v,T,O)=>{const L=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],F=O%4*3;return[L[F],L[F+1],L[F+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:f=>{const{size:v=5}=f;return Array.isArray(v)?[v[0]]:[v]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:K.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:f=>{const{shape:v=2}=f;return[o.indexOf(v)]}}})}}const eA=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,ni=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class J2 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.LINEAR,min:K.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var o;(o=this.texture)===null||o===void 0||o.bind()}const f=this.getCommonUniformsInfo(),v=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},f.uniformsOption),v.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:o=0,heightfixed:f=!1}=this.layer.getLayerConfig(),v={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(o),u_heightfixed:Number(f),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.iconService.on("imageUpdate",o.updateTexture),o.updateTexture(),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointImage",vertexShader:ni,fragmentShader:eA,triangulation:kM,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},primitive:K.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{shape:v}=o,{x:T,y:O}=f[v]||{x:-64,y:-64};return[T,O]}}})}}const tP=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,wb=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function Ab(a){const o=a.coordinates;return{vertices:[...o],indices:[0],size:o.length}}class Cb extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const o={u_size_scale:.5};return this.getUniformsBufferInfo(o)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.layer.triangulation=Ab,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:wb,fragmentShader:tP,triangulation:Ab,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},primitive:K.gl.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}var H1=D(98333),Im=D(85975);class vc{constructor(o,f,v){(0,qt.Z)(this,"boxCells",[]),(0,qt.Z)(this,"xCellCount",void 0),(0,qt.Z)(this,"yCellCount",void 0),(0,qt.Z)(this,"boxKeys",void 0),(0,qt.Z)(this,"bboxes",void 0),(0,qt.Z)(this,"width",void 0),(0,qt.Z)(this,"height",void 0),(0,qt.Z)(this,"xScale",void 0),(0,qt.Z)(this,"yScale",void 0),(0,qt.Z)(this,"boxUid",void 0);const T=this.boxCells;this.xCellCount=Math.ceil(o/v),this.yCellCount=Math.ceil(f/v);for(let O=0;O<this.xCellCount*this.yCellCount;O++)T.push([]);this.boxKeys=[],this.bboxes=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0}insert(o,f,v,T,O){this.forEachCell(f,v,T,O,this.insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(T),this.bboxes.push(O)}query(o,f,v,T,O){return this.queryHitTest(o,f,v,T,!1,O)}hitTest(o,f,v,T,O){return this.queryHitTest(o,f,v,T,!0,O)}insertBoxCell(o,f,v,T,O,L){this.boxCells[O].push(L)}queryHitTest(o,f,v,T,O,L){if(v<0||o>this.width||T<0||f>this.height)return O?!1:[];const F=[];if(o<=0&&f<=0&&this.width<=v&&this.height<=T){if(O)return!0;for(let ie=0;ie<this.boxKeys.length;ie++)F.push({key:this.boxKeys[ie],x1:this.bboxes[ie*4],y1:this.bboxes[ie*4+1],x2:this.bboxes[ie*4+2],y2:this.bboxes[ie*4+3]});return L?F.filter(L):F}const H={hitTest:O,seenUids:{box:{},circle:{}}};return this.forEachCell(o,f,v,T,this.queryCell,F,H,L),O?F.length>0:F}queryCell(o,f,v,T,O,L,F,H){const ie=F.seenUids,ge=this.boxCells[O];if(ge!==null){const Te=this.bboxes;for(const Ve of ge)if(!ie.box[Ve]){ie.box[Ve]=!0;const Mt=Ve*4;if(o<=Te[Mt+2]&&f<=Te[Mt+3]&&v>=Te[Mt+0]&&T>=Te[Mt+1]&&(!H||H(this.boxKeys[Ve]))){if(F.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[Ve],x1:Te[Mt],y1:Te[Mt+1],x2:Te[Mt+2],y2:Te[Mt+3]})}}}return!1}forEachCell(o,f,v,T,O,L,F,H){const ie=this.convertToXCellCoord(o),ge=this.convertToYCellCoord(f),Te=this.convertToXCellCoord(v),Ve=this.convertToYCellCoord(T);for(let Mt=ie;Mt<=Te;Mt++)for(let rn=ge;rn<=Ve;rn++){const Rn=this.xCellCount*rn+Mt;if(O.call(this,o,f,v,T,Rn,L,F,H))return}}convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}}var Z1=vc;class eE{constructor(o,f){(0,qt.Z)(this,"width",void 0),(0,qt.Z)(this,"height",void 0),(0,qt.Z)(this,"grid",void 0),(0,qt.Z)(this,"viewportPadding",100),(0,qt.Z)(this,"screenRightBoundary",void 0),(0,qt.Z)(this,"screenBottomBoundary",void 0),(0,qt.Z)(this,"gridRightBoundary",void 0),(0,qt.Z)(this,"gridBottomBoundary",void 0),this.width=o,this.height=f,this.viewportPadding=Math.max(o,f),this.grid=new Z1(o+this.viewportPadding,f+this.viewportPadding,25),this.screenRightBoundary=o+this.viewportPadding,this.screenBottomBoundary=f+this.viewportPadding,this.gridRightBoundary=o+2*this.viewportPadding,this.gridBottomBoundary=f+2*this.viewportPadding}placeCollisionBox(o){const f=o.x1+o.anchorPointX+this.viewportPadding,v=o.y1+o.anchorPointY+this.viewportPadding,T=o.x2+o.anchorPointX+this.viewportPadding,O=o.y2+o.anchorPointY+this.viewportPadding;return!this.isInsideGrid(f,v,T,O)||this.grid.hitTest(f,v,T,O)?{box:[]}:{box:[f,v,T,O]}}insertCollisionBox(o,f){const v={featureIndex:f};this.grid.insert(v,o[0],o[1],o[2],o[3])}project(o,f,v){const T=H1.al(f,v,0,1),O=H1.Ue(),L=Im.fromValues(...o);return H1.fF(O,T,L),{x:(O[0]/O[3]+1)/2*this.width+this.viewportPadding,y:(-O[1]/O[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(o,f,v,T){return v>=0&&o<this.gridRightBoundary&&T>=0&&f<this.gridBottomBoundary}}function tA(a){let o=.5,f=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0;break;default:o=.5}switch(a){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0;break;default:f=.5}return{horizontalAlign:o,verticalAlign:f}}function nA(a,o,f,v,T){if(!T)return;const O=a[v],L=O.glyph;if(L){const F=o[L].advance*O.scale,H=(a[v].x+F)*T;for(let ie=f;ie<=v;ie++)a[ie].x-=H}}function W1(a,o,f,v,T,O,L){const F=(o-f)*T,H=(-v*L+.5)*O;for(const ie of a)ie.x+=F,ie.y+=H}function G1(a,o,f,v,T,O,L){let H=0,ie=-8,ge=0;const Te=a.positionedGlyphs,Ve=O==="right"?1:O==="left"?0:.5,Mt=Te.length;f.forEach(Nr=>{if(Nr.split("").forEach(jn=>{const ci=o[jn];ci&&(Te.push({glyph:jn,x:H,y:ie+0,vertical:!1,scale:1,metrics:ci}),H+=ci.advance+L)}),Te.length!==Mt){const jn=H-L;ge=Math.max(jn,ge),nA(Te,o,Mt,Te.length-1,Ve)}H=0,ie-=v+5});const{horizontalAlign:rn,verticalAlign:Rn}=tA(T);W1(Te,Ve,rn,Rn,ge,v,f.length);const hr=ie- -8;a.top+=-Rn*hr,a.bottom=a.top-hr,a.left+=-rn*ge,a.right=a.left+ge}function nP(a,o,f,v,T,O,L){let H=0,ie=-8,ge=0;const Te=a.positionedGlyphs,Ve=O==="right"?1:O==="left"?0:.5,Mt=Te.length;f.forEach(Nr=>{const jn=o[Nr];if(jn&&(Te.push({glyph:Nr,x:jn.advance/2,y:ie+0,vertical:!1,scale:1,metrics:jn}),H+=jn.advance+L),Te.length!==Mt){const ji=H-L;ge=Math.max(ji,ge),nA(Te,o,Mt,Te.length-1,Ve)}H=0,ie-=v+5});const{horizontalAlign:rn,verticalAlign:Rn}=tA(T);W1(Te,Ve,rn,Rn,ge,v,f.length);const hr=ie- -8;a.top+=-Rn*hr,a.bottom=a.top-hr,a.left+=-rn*ge,a.right=a.left+ge}function rP(a,o,f,v,T,O,L=[0,0],F){const H=a.split(`
`),ie=[],ge={positionedGlyphs:ie,top:L[1],bottom:L[1],left:L[0],right:L[0],lineCount:H.length,text:a};return F?nP(ge,o,H,f,v,T,O):G1(ge,o,H,f,v,T,O),ie.length?ge:!1}function tE(a,o=[0,0],f){const{positionedGlyphs:v=[]}=a,T=[];for(const O of v){const L=O.metrics,F=4,H=L.advance*O.scale/2,ie=f?[O.x+H,O.y]:[0,0],ge=f?[0,0]:[O.x+H+o[0],O.y+o[1]],Te=(0-F)*O.scale-H+ge[0],Ve=(0-F)*O.scale+ge[1],Mt=Te+L.width*O.scale,rn=Ve+L.height*O.scale,Rn={x:Te,y:Ve},hr={x:Mt,y:Ve},Nr={x:Te,y:rn},jn={x:Mt,y:rn};T.push({tl:Rn,tr:hr,bl:Nr,br:jn,tex:L,glyphOffset:ie})}return T}const xv=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,Ob=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:Ay}=Me.lodashUtil;function Rb(a){const o=this,f=a.id,v=[],T=[];if(!o.glyphInfoMap||!o.glyphInfoMap[f])return{vertices:[],indices:[],size:7};const O=o.glyphInfoMap[f].centroid,L=O.length===2?[O[0],O[1],0]:O;return o.glyphInfoMap[f].glyphQuads.forEach((F,H)=>{v.push(...L,F.tex.x,F.tex.y+F.tex.height,F.tl.x,F.tl.y,...L,F.tex.x+F.tex.width,F.tex.y+F.tex.height,F.tr.x,F.tr.y,...L,F.tex.x+F.tex.width,F.tex.y,F.br.x,F.br.y,...L,F.tex.x,F.tex.y,F.bl.x,F.bl.y),T.push(0+H*4,1+H*4,2+H*4,2+H*4,3+H*4,0+H*4)}),{vertices:v,indices:T,size:7}}class nE extends Rl{constructor(...o){var f;super(...o),f=this,(0,qt.Z)(this,"glyphInfo",void 0),(0,qt.Z)(this,"glyphInfoMap",{}),(0,qt.Z)(this,"rawEncodeData",void 0),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"currentZoom",-1),(0,qt.Z)(this,"extent",void 0),(0,qt.Z)(this,"textureHeight",0),(0,qt.Z)(this,"textCount",0),(0,qt.Z)(this,"preTextStyle",{}),(0,qt.Z)(this,"mapping",(0,Ai.Z)(function*(){f.initGlyph(),f.updateTexture(),yield f.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:o="#fff",strokeWidth:f=0,halo:v=.5,gamma:T=2,raisingHeight:O=0}=this.layer.getLayerConfig(),L=this.getFontServiceMapping(),F=this.getFontServiceCanvas();L&&Object.keys(L).length!==this.textCount&&F&&(this.updateTexture(),this.textCount=Object.keys(L).length),this.preTextStyle=this.getTextStyle();const H={u_stroke_color:(0,Me.CI)(o),u_sdf_map_size:[(F==null?void 0:F.width)||1,(F==null?void 0:F.height)||1],u_raisingHeight:Number(O),u_stroke_width:f,u_gamma_scale:T,u_halo_blur:v};return this.getUniformsBufferInfo(H)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.bindEvent(),o.extent=o.textExtent(),o.rawEncodeData=o.layer.getEncodedData(),o.preTextStyle=o.getTextStyle(),o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{textAllowOverlap:f=!1}=o.layer.getLayerConfig();return o.initGlyph(),o.updateTexture(),f||o.filterGlyphs(),[yield o.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ob,fragmentShader:xv,defines:o.getDefines(),inject:o.getInject(),triangulation:Rb.bind(o),depth:{enable:!1}})]})()}needUpdate(){var o=this;return(0,Ai.Z)(function*(){const{textAllowOverlap:f=!1,textAnchor:v="center",textOffset:T,padding:O,fontFamily:L,fontWeight:F}=o.getTextStyle();if(!Ay(O,o.preTextStyle.padding)||!Ay(T,o.preTextStyle.textOffset)||!Ay(v,o.preTextStyle.textAnchor)||!Ay(L,o.preTextStyle.fontFamily)||!Ay(F,o.preTextStyle.fontWeight))return yield o.mapping(),!0;if(f)return!1;const H=o.mapService.getZoom(),ie=o.mapService.getBounds(),ge=(0,Me.oO)(o.extent,ie);return Math.abs(o.currentZoom-H)>.5||!ge||f!==o.preTextStyle.textAllowOverlap?(yield o.reBuildModel(),!0):!1})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:K.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:K.GC.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=12}=o;return Array.isArray(f)?[f[0]]:[f]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const o=this.mapService.getBounds();return(0,Me.yA)(o,.5)}initTextFont(){const{fontWeight:o,fontFamily:f}=this.getTextStyle(),v=this.rawEncodeData,T=[];v.forEach(O=>{let{shape:L=""}=O;L=L.toString();for(const F of L)T.indexOf(F)===-1&&T.push(F)}),this.fontService.setFontOptions({characterSet:T,fontWeight:o,fontFamily:f,iconfont:!1})}initIconFontTex(){const{fontWeight:o,fontFamily:f}=this.getTextStyle(),v=this.rawEncodeData,T=[];v.forEach(O=>{let{shape:L=""}=O;L=`${L}`,T.indexOf(L)===-1&&T.push(L)}),this.fontService.setFontOptions({characterSet:T,fontWeight:o,fontFamily:f,iconfont:!0})}getTextStyle(){const{fontWeight:o="400",fontFamily:f="sans-serif",textAllowOverlap:v=!1,padding:T=[0,0],textAnchor:O="center",textOffset:L=[0,0],opacity:F=1,strokeOpacity:H=1,strokeWidth:ie=0,stroke:ge="#000"}=this.layer.getLayerConfig();return{fontWeight:o,fontFamily:f,textAllowOverlap:v,padding:T,textAnchor:O,textOffset:L,opacity:F,strokeOpacity:H,strokeWidth:ie,stroke:ge}}generateGlyphLayout(o){const f=this.getFontServiceMapping(),{spacing:v=2,textAnchor:T="center",textOffset:O}=this.layer.getLayerConfig(),L=this.rawEncodeData;this.glyphInfo=L.map(F=>{const{shape:H="",id:ie,size:ge=1}=F,Te=F.textOffset?F.textOffset:O||[0,0],Ve=F.textAnchor?F.textAnchor:T||"center",Mt=rP(H.toString(),f,ge,Ve,"left",v,Te,o),rn=tE(Mt,Te,!1);return F.shaping=Mt,F.glyphQuads=rn,F.centroid=(0,Me.SI)(F.coordinates),this.glyphInfoMap[ie]={shaping:Mt,glyphQuads:rn,centroid:(0,Me.SI)(F.coordinates)},F})}getFontServiceMapping(){const{fontWeight:o="400",fontFamily:f="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${f}_${o}`)}getFontServiceCanvas(){const{fontWeight:o="400",fontFamily:f="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${f}_${o}`)}filterGlyphs(){const{padding:o=[0,0],textAllowOverlap:f=!1}=this.layer.getLayerConfig();if(f)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:v,height:T}=this.rendererService.getViewportSize(),O=new eE(v,T);this.glyphInfo.filter(F=>{const{shaping:H,id:ie=0}=F,ge=F.centroid,Ve=F.size/16,Mt=this.mapService.lngLatToContainer(ge),{box:rn}=O.placeCollisionBox({x1:H.left*Ve-o[0],x2:H.right*Ve+o[0],y1:H.top*Ve-o[1],y2:H.bottom*Ve+o[1],anchorPointX:Mt.x,anchorPointY:Mt.y});return rn&&rn.length?(O.insertCollisionBox(rn,ie),!0):!1}).forEach(F=>{this.glyphInfoMap[F.id]=F})}initGlyph(){const{iconfont:o=!1}=this.layer.getLayerConfig();o?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(o)}updateTexture(){const{createTexture2D:o}=this.rendererService,f=this.getFontServiceCanvas();this.textureHeight=f.height,this.texture&&this.texture.destroy(),this.texture=o({data:f,mag:K.gl.LINEAR,min:K.gl.LINEAR,width:f.width,height:f.height}),this.textures=[this.texture]}reBuildModel(){var o=this;return(0,Ai.Z)(function*(){o.filterGlyphs();const f=yield o.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ob,fragmentShader:xv,triangulation:Rb.bind(o),defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}});o.layer.models=[f]})()}}function Ev(a){return Cy.apply(this,arguments)}function Cy(){return Cy=(0,Ai.Z)(function*(a){if(window.createImageBitmap){const o=yield fetch(a);return yield createImageBitmap(yield o.blob())}else{const o=new window.Image;return new Promise(f=>{o.onload=()=>f(o),o.src=a,o.crossOrigin="Anonymous"})}}),Cy.apply(this,arguments)}const rA=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,Mb=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,mg=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Pb=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Ql=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,iP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class iA extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:o,heightfixed:f=!1,raisingHeight:v=0,topsurface:T=!0,sidesurface:O=!0,sourceColor:L,targetColor:F}=this.layer.getLayerConfig();let H=0,ie=[1,1,1,1],ge=[1,1,1,1];L&&F&&(ie=(0,Me.CI)(L),ge=(0,Me.CI)(F),H=1);const Te={u_sourceColor:ie,u_targetColor:ge,u_linearColor:H,u_topsurface:Number(T),u_sidesurface:Number(O),u_heightfixed:Number(f),u_raisingHeight:Number(v)};return o&&this.texture&&(Te.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(Te)}initModels(){var o=this;return(0,Ai.Z)(function*(){return yield o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{frag:f,vert:v,type:T}=o.getShaders();return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,depth:{enable:!0},defines:o.getDefines(),inject:o.getInject(),triangulation:U2})]})()}getShaders(){const{pickLight:o,mapTexture:f}=this.layer.getLayerConfig();return f?{frag:Ql,vert:iP,type:"polygonExtrudeTexture"}:o?{frag:Mb,vert:mg,type:"polygonExtrudePickLight"}:{frag:rA,vert:Pb,type:"polygonExtrude"}}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.textures=[]}registerBuiltinAttributes(){const o=this.layer.getSource().extent,f=o[2]-o[0],v=o[3]-o[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:K.GC.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(T,O,L)=>{const F=L[0],H=L[1];return[(F-o[0])/f,(H-o[1])/v,L[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(T,O,L,F,H)=>H}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:T=>{const{size:O=10}=T;return Array.isArray(O)?[O[0]]:[O]}}})}loadTexture(){var o=this;return(0,Ai.Z)(function*(){const{mapTexture:f}=o.layer.getLayerConfig(),{createTexture2D:v}=o.rendererService;if(o.texture=v({height:1,width:1}),f){const T=yield Ev(f);o.texture=v({data:T,width:T.width,height:T.height,wrapS:K.gl.CLAMP_TO_EDGE,wrapT:K.gl.CLAMP_TO_EDGE,min:K.gl.LINEAR,mag:K.gl.LINEAR})}})()}}const oA=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,po=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class rE extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const o={};return this.getUniformsBufferInfo(o)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{frag:f,vert:v,type:T}=o.getShaders();return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:U2,depth:{enable:!0}})]})()}getShaders(){return{frag:oA,vert:po,type:"polygonExtrude"}}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=10}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:K.GC.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{extrusionBase:f=0}=o;return[f]}}})}}const oP=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,aA=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,Ib=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,iE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class vg extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:o=0,opacityLinear:f={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),v={u_raisingHeight:Number(o),u_opacitylinear:Number(f.enable),u_dir:f.dir==="in"?1:0};return this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{frag:f,vert:v,triangulation:T,type:O}=o.getModelParams();return o.initUniformsBuffer(),o.layer.triangulation=T,[yield o.layer.buildLayerModel({moduleName:O,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:T,primitive:K.gl.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:o={enable:!1,dir:"in"}}=this.layer.getLayerConfig();o.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:K.GC.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(f,v,T)=>[T[3],T[4],T[5]]}})}getModelParams(){const{opacityLinear:o={enable:!1}}=this.layer.getLayerConfig();return o.enable?{frag:aA,vert:Ib,type:"polygonLinear",triangulation:Iw}:{frag:oP,vert:iE,type:"polygonFill",triangulation:wy}}}const X0=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,oE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Pa extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture1",void 0),(0,qt.Z)(this,"texture2",void 0),(0,qt.Z)(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{watercolor:o="#6D99A8",watercolor2:f="#0F121C"}=this.layer.getLayerConfig(),v={u_watercolor:(0,Me.CI)(o),u_watercolor2:(0,Me.CI)(f),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(v)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:oE,fragmentShader:X0,defines:o.getDefines(),inject:o.getInject(),triangulation:wy,primitive:K.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var o,f,v;(o=this.texture1)===null||o===void 0||o.destroy(),(f=this.texture2)===null||f===void 0||f.destroy(),(v=this.texture3)===null||v===void 0||v.destroy()}registerBuiltinAttributes(){const o=this.layer.getSource().extent,[f,v,T,O]=o,L=T-f,F=O-v;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:K.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(H,ie,ge)=>{const[Te,Ve]=ge;return[(Te-f)/L,(Ve-v)/F]}}})}loadTexture(){const{createTexture2D:o}=this.rendererService,f={height:0,width:0};this.texture1=o(f),this.texture2=o(f),this.texture3=o(f),v(O=>{this.texture1=T(O[0]),this.texture2=T(O[1]),this.texture3=T(O[2]),this.layerService.reRender()});function v(O){let L=0;const F=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(ie=>{const ge=new Image;ge.crossOrigin="",ge.src=ie,F.push(ge),ge.onload=()=>{L++,L===3&&O(F)}})}function T(O){return o({data:O,width:O.width,height:O.height,wrapS:K.gl.MIRRORED_REPEAT,wrapT:K.gl.MIRRORED_REPEAT,min:K.gl.LINEAR,mag:K.gl.LINEAR})}}}const Su=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,El=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class sA extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{speed:o=.5}=this.layer.getLayerConfig(),f={u_speed:o,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(f)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:El,fragmentShader:Su,triangulation:wy,defines:o.getDefines(),inject:o.getInject(),primitive:K.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){const o=this.layer.getSource().extent,[f,v,T,O]=o,L=T-f,F=O-v;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:K.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(H,ie,ge)=>{const[Te,Ve]=ge;return[(Te-f)/L,(Ve-v)/F]}}})}loadTexture(){const{waterTexture:o}=this.layer.getLayerConfig(),{createTexture2D:f}=this.rendererService;this.texture=f({height:1,width:1});const v=new Image;v.crossOrigin="",o?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),v.src=o):v.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",v.onload=()=>{this.texture=f({data:v,width:v.width,height:v.height,wrapS:K.gl.MIRRORED_REPEAT,wrapT:K.gl.MIRRORED_REPEAT,min:K.gl.LINEAR,mag:K.gl.LINEAR}),this.layerService.reRender()}}}var lA={fill:vg,line:$2,extrude:iA,text:nE,point_fill:Tb,point_image:J2,point_normal:Cb,point_extrude:y0,water:sA,ocean:Pa,extrusion:rE};class gg extends v0{constructor(...o){super(...o),(0,qt.Z)(this,"type","PolygonLayer"),(0,qt.Z)(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var o=this;return(0,Ai.Z)(function*(){const f=o.getModelType();o.layerModel=new lA[f](o),yield o.initLayerModels()})()}getModelType(){var o;const f=this.styleAttributeService.getLayerStyleAttribute("shape"),v=f==null||(o=f.scale)===null||o===void 0?void 0:o.field;return v==="fill"||!v?"fill":v==="extrude"?"extrude":v==="extrusion"?"extrusion":v==="water"?"water":v==="ocean"?"ocean":v==="line"?"line":this.getPointModelType()}getPointModelType(){const o=this.getEncodedData(),{shape2d:f,shape3d:v}=this.getLayerConfig(),T=this.iconService.getIconMap(),O=o.find(L=>L.hasOwnProperty("shape"));if(O){const L=O.shape;return L==="dot"?"point_normal":(f==null?void 0:f.indexOf(L))!==-1?"point_fill":(v==null?void 0:v.indexOf(L))!==-1?"point_extrude":T.hasOwnProperty(L)?"point_image":"text"}else return"fill"}}class cA{constructor({rendererService:o,layerService:f,parent:v}){(0,qt.Z)(this,"tileResource",new Map),(0,qt.Z)(this,"rendererService",void 0),(0,qt.Z)(this,"layerService",void 0),(0,qt.Z)(this,"parent",void 0),(0,qt.Z)(this,"layerTiles",[]),this.rendererService=o,this.layerService=f,this.parent=v}get tiles(){return this.layerTiles}hasTile(o){return this.layerTiles.some(f=>f.key===o)}addTile(o){this.layerTiles.push(o)}getTile(o){return this.layerTiles.find(f=>f.key===o)}getVisibleTileBylngLat(o){return this.layerTiles.find(f=>f.isLoaded&&f.visible&&f.lnglatInBounds(o))}removeTile(o){const f=this.layerTiles.findIndex(T=>T.key===o),v=this.layerTiles.splice(f,1);v[0]&&v[0].destroy()}updateTileVisible(o){const f=this.getTile(o.key);if(o.isVisible)if(o.parent){const v=this.isChildrenLoaded(o.parent);f==null||f.updateVisible(v)}else f==null||f.updateVisible(!0);else if(o.parent){const v=this.isChildrenLoaded(o.parent);f==null||f.updateVisible(!v)}else f==null||f.updateVisible(!1)}isParentLoaded(o){const f=o.parent;if(!f)return!0;const v=this.getTile(f==null?void 0:f.key);return!!(v!=null&&v.isLoaded)}isChildrenLoaded(o){const f=o==null?void 0:o.children;return f.length===0?!0:f.every(v=>{const T=this.getTile(v==null?void 0:v.key);return T?(T==null?void 0:T.isLoaded)===!0:!0})}render(){var o=this;return(0,Ai.Z)(function*(){const v=o.getRenderLayers().map(function(){var T=(0,Ai.Z)(function*(O){yield o.layerService.renderTileLayer(O)});return function(O){return T.apply(this,arguments)}}());yield Promise.all(v)})()}getRenderLayers(){const o=this.layerTiles.filter(v=>v.visible&&v.isLoaded),f=[];return o.map(v=>f.push(...v.getLayers())),f}getLayers(){const o=this.layerTiles.filter(v=>v.isLoaded),f=[];return o.map(v=>f.push(...v.getLayers())),f}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(o=>o.destroy()),this.tileResource.clear()}}var uA=D(32676);function fA(a,o,f){f===void 0&&(f={});var v=$e(a),T=$e(o),O=uA.union(v.coordinates,T.coordinates);return O.length===0?null:O.length===1?(0,At.yu)(O[0],f.properties):(0,At.tw)(O,f.properties)}var hA=fA;class Lb{getCombineFeature(o){let f=null;const v=o[0];return o.map(T=>{const O=At.yu(T.coordinates);f===null?f=O:f=hA(f,O)}),v&&(f.properties=(0,Bn.Z)({},v)),f}}const Tv="select",Oy="active";class aE{constructor({layerService:o,tileLayerService:f,parent:v}){(0,qt.Z)(this,"layerService",void 0),(0,qt.Z)(this,"tileLayerService",void 0),(0,qt.Z)(this,"tileSourceService",void 0),(0,qt.Z)(this,"parent",void 0),(0,qt.Z)(this,"tilePickID",new Map),this.layerService=o,this.tileLayerService=f,this.parent=v,this.tileSourceService=new Lb}pickRender(o){const f=this.tileLayerService.getVisibleTileBylngLat(o.lngLat);if(f){const v=f.getMainLayer();v==null||v.layerPickService.pickRender(o)}}pick(o,f){var v=this;return(0,Ai.Z)(function*(){const O=v.parent.getContainer().pickingService;if(o.type==="RasterLayer"){const L=v.tileLayerService.getVisibleTileBylngLat(f.lngLat);if(L&&L.getMainLayer()!==void 0){const F=L.getMainLayer();return F.layerPickService.pickRasterLayer(F,f,v.parent)}return!1}return v.pickRender(f),O.pickFromPickingFBO(o,f)})()}selectFeature(o){const[f,v,T]=o,O=this.color2PickId(f,v,T);this.tilePickID.set(Tv,O),this.updateHighLight(f,v,T,Tv)}highlightPickedFeature(o){const[f,v,T]=o,O=this.color2PickId(f,v,T);this.tilePickID.set(Oy,O),this.updateHighLight(f,v,T,Oy)}updateHighLight(o,f,v,T){this.tileLayerService.tiles.map(O=>{const L=O.getMainLayer();switch(T){case Tv:L==null||L.hooks.beforeSelect.call([o,f,v]);break;case Oy:L==null||L.hooks.beforeHighlight.call([o,f,v]);break}})}setPickState(){const o=this.tilePickID.get(Tv),f=this.tilePickID.get(Oy);if(o){const[v,T,O]=this.pickId2Color(o);this.updateHighLight(v,T,O,Tv);return}if(f){const[v,T,O]=this.pickId2Color(f);this.updateHighLight(v,T,O,Oy);return}}color2PickId(o,f,v){return(0,Me.W0)(new Uint8Array([o,f,v]))}pickId2Color(o){return(0,Me.Z6)(o)}getFeatureById(o){const f=this.tileLayerService.getTiles().filter(T=>T.visible),v=[];return f.forEach(T=>{v.push(...T.getFeatureById(o))}),v}pickRasterLayer(){return!1}}const dA=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,sE=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Db(a){const o=a.coordinates;return{vertices:[...o],indices:[0],size:o.length}}class lE extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:o,strokeOpacity:f=1,strokeWidth:v=0,stroke:T="#fff"}=this.layer.getLayerConfig(),O={u_stroke_color:(0,Me.CI)(T),u_additive:o==="additive"?1:0,u_stroke_opacity:f,u_stroke_width:v};return this.getUniformsBufferInfo(O)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.layer.triangulation=Db,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:sE,fragmentShader:dA,defines:o.getDefines(),inject:o.getInject(),triangulation:Db,depth:{enable:!1},primitive:K.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}const cE=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,uE=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    //
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:pA}=Me.lodashUtil;class X1 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"raiseCount",0),(0,qt.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:o={enable:!1,speed:.01,repeat:!1},opacity:f=1,sourceColor:v,targetColor:T,pickLight:O=!1,heightfixed:L=!0,opacityLinear:F={enable:!1,dir:"up"},lightEnable:H=!0}=this.layer.getLayerConfig();let ie=0,ge=[0,0,0,0],Te=[0,0,0,0];if(v&&T&&(ge=(0,Me.CI)(v),Te=(0,Me.CI)(T),ie=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){const{speed:rn=.01}=o;this.raiseCount+=rn,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const Ve={u_sourceColor:ge,u_targetColor:Te,u_linearColor:ie,u_pickLight:Number(O),u_heightfixed:Number(L),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:pA(f)?f:1,u_opacitylinear:Number(F.enable),u_opacitylinear_dir:F.dir==="up"?1:0,u_lightEnable:Number(H)};return this.getUniformsBufferInfo(Ve)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){const{animateOption:{repeat:f=1}}=o.layer.getLayerConfig();return o.raiseRepeat=f,[yield o.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:uE,fragmentShader:cE,triangulation:k2,depth:{enable:!0},defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:K.gl.FRONT},blend:o.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:o=>{const{size:f}=o;if(f){let v=[];return Array.isArray(f)&&(v=f.length===2?[f[0],f[0],f[1]]:f),Array.isArray(f)||(v=[f,f,f]),v}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:K.GC.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:o=>{const f=(0,Me.SI)(o.coordinates);return Om([f[0],f[1]])}}})}}const Lm=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,mA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;class vA extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:o=1,strokeWidth:f=0,blend:v,blur:T=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const O={u_additive:v==="additive"?1:0,u_stroke_opacity:o,u_stroke_width:f,u_blur:T};return this.getUniformsBufferInfo(O)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.layer.triangulation=F2,[yield o.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:mA,fragmentShader:Lm,triangulation:F2,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!0},blend:o.getBlend()})]})()}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T)=>{const[O,L,F]=v,H=ql.al(0,0,1),ie=ql.al(O,0,F),ge=O>=0?ql.EU(H,ie):Math.PI*2-ql.EU(H,ie),Te=Math.PI*2-Math.asin(L/100),Ve=Im.create();Im.rotateY(Ve,Ve,ge),Im.rotateX(Ve,Ve,Te);const Mt=ql.al(1,1,0);ql.fF(Mt,Mt,Ve),ql.Fv(Mt,Mt);const rn=ql.al(-1,1,0);ql.fF(rn,rn,Ve),ql.Fv(rn,rn);const Rn=ql.al(-1,-1,0);ql.fF(Rn,Rn,Ve),ql.Fv(Rn,Rn);const hr=ql.al(1,-1,0);ql.fF(hr,hr,Ve),ql.Fv(hr,hr);const Nr=[...Mt,...rn,...Rn,...hr],jn=T%4*3;return[Nr[jn],Nr[jn+1],Nr[jn+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:K.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{shape:f=2}=o;return[this.layer.getLayerConfig().shape2d.indexOf(f)]}}})}}const _0=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,wv=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class aP extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"meter2coord",1),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"isMeter",!1),(0,qt.Z)(this,"radian",0),(0,qt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.LINEAR,min:K.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:o=0,heightfixed:f=!1,unit:v="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var T;(T=this.texture)===null||T===void 0||T.bind()}const O={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(f),u_raisingHeight:Number(o),u_size_unit:xb[v]};return this.getUniformsBufferInfo(O)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),op)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.iconService.on("imageUpdate",o.updateTexture),o.updateTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:wv,fragmentShader:_0,triangulation:op,depth:{enable:!1},defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:K.gl.FRONT}})]})()}clearModels(){var o;this.iconService.off("imageUpdate",this.updateTexture),(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{shape:v}=o,{x:T,y:O}=f[v]||{x:-64,y:-64};return[T,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T)=>{const O=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],L=T%4*3;return[O[L],O[L+1],O[L+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}const gA=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,fE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class sP extends Rl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:o,speed:f=1,unit:v="pixel"}=this.layer.getLayerConfig(),T={u_additive:o==="additive"?1:0,u_size_unit:xb[v],u_speed:f,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(T)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),op)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:fE,fragmentShader:gA,triangulation:op,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}})]})()}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T)=>{const O=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],L=T%4*3;return[O[L],O[L+1],O[L+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}var hE={fillImage:aP,fill:Tb,radar:sP,image:J2,normal:Cb,simplePoint:lE,extrude:y0,text:nE,earthFill:vA,earthExtrude:X1};class Y1 extends v0{constructor(...o){super(...o),(0,qt.Z)(this,"type","PointLayer"),(0,qt.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,qt.Z)(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,qt.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var o=this;return(0,Ai.Z)(function*(){const f=o.getModelType();o.layerModel&&o.layerModel.clearModels(),o.layerModel=new hE[f](o),yield o.initLayerModels()})()}rebuildModels(){var o=this;return(0,Ai.Z)(function*(){yield o.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:o,values:f}=this.shapeOption,{shape2d:v}=this.getLayerConfig(),T=this.iconService.getIconMap();if(o&&(v==null?void 0:v.indexOf(o))!==-1)return"fill";if(f==="text")return"text";if(f&&f instanceof Array){for(const O of f)if(typeof O=="string"&&T.hasOwnProperty(O))return"image"}}return"normal"}getDefaultConfig(){const o=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[o]}getModelType(){const o=this.getEncodedData(),{shape2d:f,shape3d:v,billboard:T=!0}=this.getLayerConfig(),O=this.iconService.getIconMap(),L=o.find(F=>F.hasOwnProperty("shape"));if(L){const F=L.shape;return F==="dot"?"normal":F==="simple"?"simplePoint":F==="radar"?"radar":this.layerType==="fillImage"||T===!1?"fillImage":(f==null?void 0:f.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(v==null?void 0:v.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":O.hasOwnProperty(F)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function yA(a){return a==="PolygonLayer"?gg:a==="LineLayer"?Eb:Y1}function _A(a){return["PolygonLayer","LineLayer"].indexOf(a)!==-1}class ap extends Wc.EventEmitter{constructor(o,f){super(),(0,qt.Z)(this,"x",void 0),(0,qt.Z)(this,"y",void 0),(0,qt.Z)(this,"z",void 0),(0,qt.Z)(this,"key",void 0),(0,qt.Z)(this,"parent",void 0),(0,qt.Z)(this,"sourceTile",void 0),(0,qt.Z)(this,"visible",!0),(0,qt.Z)(this,"layers",[]),(0,qt.Z)(this,"isLoaded",!1),(0,qt.Z)(this,"tileMaskLayers",[]),(0,qt.Z)(this,"tileMask",void 0),this.parent=f,this.sourceTile=o,this.x=o.x,this.y=o.y,this.z=o.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...o){}lnglatInBounds(o){const[f,v,T,O]=this.sourceTile.bounds,{lng:L,lat:F}=o;return L>=f&&L<=T&&F>=v&&F<=O}getLayerOptions(){var o;const f=this.parent.getLayerConfig();return(0,Bn.Z)((0,Bn.Z)({},f),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:_A(this.parent.type),mask:f.mask||((o=f.maskLayers)===null||o===void 0?void 0:o.length)!==0&&f.enableMask})}getMaskLayer(){const{maskLayers:o}=this.parent.getLayerConfig(),f=[];return o==null||o.forEach(v=>{if(!v.tileLayer)return f.push(v),v;const O=v.tileLayer.getTile(this.sourceTile.key),L=O==null?void 0:O.getLayers()[0];L&&f.push(L)}),f}addTileMask(){var o=this;return(0,Ai.Z)(function*(){const f=new gg({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[o.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),v=(0,K.e7)(o.parent.container);f.setContainer(v),yield f.init(),o.tileMask=f;const T=o.getMainLayer();return T!==void 0&&(T.tileMask=f),f})()}addMask(o,f){var v=this;return(0,Ai.Z)(function*(){const T=(0,K.e7)(v.parent.container);f.setContainer(T),yield f.init(),o.addMask(f),v.tileMaskLayers.push(f)})()}addLayer(o){var f=this;return(0,Ai.Z)(function*(){o.isTileLayer=!0;const v=(0,K.e7)(f.parent.container);o.setContainer(v),f.layers.push(o),yield o.init()})()}updateVisible(o){this.visible=o,this.updateOptions("visible",o)}updateOptions(o,f){this.layers.forEach(v=>{v.updateLayerConfig({[o]:f})})}getMainLayer(){return this.layers[0]}getFeatures(o){return[]}getFeatureById(o){return[]}destroy(){var o;(o=this.tileMask)===null||o===void 0||o.destroy(),this.layers.forEach(f=>f.destroy())}}class Nb extends ap{initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.getSourceOption(),v=f.data.features[0].properties,T=new Eb().source(f.data,f.options).size(1).shape("line").color("red"),O=new Y1({minZoom:o.z-1,maxZoom:o.z+1,textAllowOverlap:!0}).source([v],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(o.key).style({stroke:"#fff",strokeWidth:2});yield o.addLayer(T),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:o.transforms}}}}const dE=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,sp=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Sl extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:o,brightness:f,contrast:v,saturation:T,gamma:O}=this.layer.getLayerConfig(),L={u_opacity:(0,Me.LS)(o,1),u_brightness:(0,Me.LS)(f,1),u_contrast:(0,Me.LS)(v,1),u_saturation:(0,Me.LS)(T,1),u_gamma:(0,Me.LS)(O,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(L)}initModels(){var o=this;return(0,Ai.Z)(function*(){return yield o.loadTexture(),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}loadTexture(){var o=this;return(0,Ai.Z)(function*(){const{createTexture2D:f}=o.rendererService,T=yield o.layer.getSource().data.images;o.texture=f({data:T[0],width:T[0].width,height:T[0].height,mag:K.gl.LINEAR,min:K.gl.LINEAR})})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:sp,fragmentShader:dE,defines:o.getDefines(),triangulation:z1,primitive:K.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}var cP={image:Sl};class bA extends v0{constructor(...o){super(...o),(0,qt.Z)(this,"type","ImageLayer")}buildModels(){var o=this;return(0,Ai.Z)(function*(){const f=o.getModelType();o.layerModel=new cP[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{image:{}}[o]}getModelType(){return"image"}}class pE extends ap{initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new bA((0,Bn.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}const Ry=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,mE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Bb extends Rl{getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,color:f="#000"}=this.layer.getLayerConfig(),v={u_color:(0,Me.CI)(f),u_opacity:o||1};return this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"mask",vertexShader:mE,fragmentShader:Ry,defines:o.getDefines(),triangulation:wy,depth:{enable:!1},pick:!1})]})()}clearModels(o=!0){o&&this.layerService.clear()}registerBuiltinAttributes(){return""}}var $1={fill:Bb};class vE extends v0{constructor(...o){super(...o),(0,qt.Z)(this,"type","MaskLayer")}buildModels(){var o=this;return(0,Ai.Z)(function*(){const f=o.getModelType();o.layerModel=new $1[f](o),yield o.initLayerModels()})()}getModelType(){return"fill"}}class gE extends ap{initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new vE((0,Bn.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getFeatures(o){return o?this.sourceTile.data.getTileData(o):[]}getSourceOption(){const o=this.parent.getSource(),{sourceLayer:f,featureId:v}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(f)},options:{parser:{type:"geojson",featureId:v},transforms:o.transforms}}}}function gc(a,o){return{type:a.type,field:"value",items:a.positions.map((f,v)=>({[o]:v>=a.colors.length?null:a.colors[v],value:f}))}}const Ml=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,My=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class kb extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,clampLow:f=!0,clampHigh:v=!0,noDataValue:T=-9999999,domain:O,rampColors:L}=this.layer.getLayerConfig(),F=O||(0,Me.ZB)(L);this.colorTexture=this.layer.textureService.getColorTexture(L,F);const H={u_domain:F,u_opacity:o||1,u_noDataValue:T,u_clampLow:f?1:0,u_clampHigh:(typeof v!="undefined"?v:f)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(H)}getRasterData(o){return(0,Ai.Z)(function*(){if(Array.isArray(o.data))return{data:o.data,width:o.width,height:o.height};{const{rasterData:f,width:v,height:T}=yield o.data;return{data:Array.from(f),width:v,height:T}}})()}initModels(){var o=this;return(0,Ai.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v,queryVerdorInfo:T}=o.rendererService,O=f.data.dataArray[0],{data:L,width:F,height:H}=yield o.getRasterData(O);return o.texture=v({data:new Float32Array(L),width:F,height:H,format:T()==="WebGL1"?K.gl.LUMINANCE:K.gl.RED,type:K.gl.FLOAT,alignment:1}),[yield o.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:My,fragmentShader:Ml,defines:o.getDefines(),triangulation:z1,primitive:K.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var o,f;(o=this.texture)===null||o===void 0||o.destroy(),(f=this.colorTexture)===null||f===void 0||f.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}const Py=["data"],yE=["rasterData"],xA=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,yg=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class _E extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0),(0,qt.Z)(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Bn.Z)((0,Bn.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,noDataValue:f=0}=this.layer.getLayerConfig(),{rMinMax:v=[0,255],gMinMax:T=[0,255],bMinMax:O=[0,255]}=this.dataOption,L={u_rminmax:v,u_gminmax:T,u_bminmax:O,u_opacity:o||1,u_noDataValue:f,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(L)}getRasterData(o){var f=this;return(0,Ai.Z)(function*(){if(Array.isArray(o.data)){const{data:L}=o,F=(0,hl.Z)(o,Py);return f.dataOption=F,(0,Bn.Z)({data:L},F)}const v=yield o.data,{rasterData:T}=v,O=(0,hl.Z)(v,yE);return f.dataOption=O,Array.isArray(T)?(0,Bn.Z)({data:T},O):(0,Bn.Z)({data:Array.from(T)},O)})()}initModels(){var o=this;return(0,Ai.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v}=o.rendererService,T=f.data.dataArray[0],{data:O,width:L,height:F}=yield o.getRasterData(T);return o.texture=v({data:new Float32Array(O),width:L,height:F,format:K.gl.RGB,type:K.gl.FLOAT}),[yield o.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:yg,fragmentShader:xA,defines:o.getDefines(),triangulation:z1,primitive:K.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}const uP=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,EA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class K1 extends Rl{constructor(...o){super(...o),(0,qt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:o,clampLow:f=!0,clampHigh:v=!0,noDataValue:T=-9999999,domain:O,rampColors:L,colorTexture:F,rScaler:H=6553.6,gScaler:ie=25.6,bScaler:ge=.1,offset:Te=1e4}=this.layer.getLayerConfig(),Ve=O||(0,Me.ZB)(L);let Mt=F;F?this.layer.textureService.setColorTexture(F,L,Ve):Mt=this.layer.textureService.getColorTexture(L,Ve);const rn={u_unpack:[H,ie,ge,Te],u_domain:Ve,u_opacity:o||1,u_noDataValue:T,u_clampLow:f,u_clampHigh:typeof v!="undefined"?v:f,u_texture:this.texture,u_colorTexture:Mt};return this.textures=[this.texture,Mt],this.getUniformsBufferInfo(rn)}initModels(){var o=this;return(0,Ai.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v}=o.rendererService,T=yield f.data.images;return o.texture=v({data:T[0],width:T[0].width,height:T[0].height,min:K.gl.LINEAR,mag:K.gl.LINEAR}),[yield o.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:EA,fragmentShader:uP,defines:o.getDefines(),triangulation:z1,primitive:K.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}buildModels(){var o=this;return(0,Ai.Z)(function*(){return o.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}var SA={raster:kb,rasterRgb:_E,raster3d:kb,rasterTerrainRgb:K1};class q1 extends v0{constructor(...o){super(...o),(0,qt.Z)(this,"type","RasterLayer")}buildModels(){var o=this;return(0,Ai.Z)(function*(){const f=o.getModelType();o.layerModel=new SA[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[o]}getModelType(){switch(this.layerSource.getParserType()){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(o){if(o!=="color")return{type:void 0,field:void 0,items:[]};const f=this.getLayerConfig().rampColors;return gc(f,o)}}const Iy=["rasterData"];class Dm extends ap{initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new q1((0,Bn.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource(),f=this.sourceTile.data.data,{rasterData:v}=f,T=(0,hl.Z)(f,Iy);return{data:v,options:{parser:(0,Bn.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},T),transforms:o.transforms}}}}class Q1 extends ap{initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new q1((0,Bn.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}const TA=["rasterData"],xE={positions:[0,1],colors:["#000","#fff"]};class _g extends ap{constructor(...o){super(...o),(0,qt.Z)(this,"colorTexture",void 0)}initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),{rampColors:O,domain:L}=o.getLayerOptions();o.colorTexture=o.parent.textureService.getColorTexture(O,L);const F=new q1((0,Bn.Z)((0,Bn.Z)({},v),{},{colorTexture:o.colorTexture})).source(T.data,T.options);f&&Object.keys(f).forEach(H=>{var ie,ge;const Te=H;F[Te]((ie=f[Te])===null||ie===void 0?void 0:ie.field,(ge=f[Te])===null||ge===void 0?void 0:ge.values)}),yield o.addLayer(F),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource(),f=this.sourceTile.data.data,{rasterData:v}=f,T=(0,hl.Z)(f,TA);return{data:v,options:{parser:(0,Bn.Z)({type:"raster",extent:this.sourceTile.bounds},T),transforms:o.transforms}}}styleUpdate(...o){const{rampColors:f=xE,domain:v}=o;this.colorTexture=this.parent.textureService.getColorTexture(f,v||(0,Me.ZB)(f)),this.layers.forEach(T=>T.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(o=>o.destroy())}}class J1 extends ap{initTileLayer(){var o=this;return(0,Ai.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=yA(o.parent.type),O=o.getSourceOption();if(!O){o.isLoaded=!0,o.emit("loaded");return}const L=new T((0,Bn.Z)({},v)).source(O.data,O.options);Object.keys(f).forEach(F=>{var H,ie;const ge=F;L[ge]((H=f[ge])===null||H===void 0?void 0:H.field,(ie=f[ge])===null||ie===void 0?void 0:ie.values)}),yield o.addLayer(L),v.tileMask&&(yield o.addTileMask()),o.setLayerMinMaxZoom(L),o.isLoaded=!0,o.emit("loaded")})()}getSourceOption(){const o=this.parent.getSource(),{sourceLayer:f="defaultLayer",featureId:v="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(f)},options:{parser:{type:"geojson",featureId:v},transforms:o.transforms}}}setLayerMinMaxZoom(o){o.getModelType()==="text"&&o.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(o){return this.sourceTile.data.getTileData(o)}getFeatureById(o){const f=this.getMainLayer();return f?f.getSource().data.dataArray.filter(T=>T._id===o):[]}}function EE(a){switch(a.type){case"PolygonLayer":return J1;case"LineLayer":return J1;case"PointLayer":return J1;case"TileDebugLayer":return Nb;case"MaskLayer":return gE;case"RasterLayer":const{dataType:f}=a.getSource().parser;switch(f){case K.n3.RGB:case K.n3.CUSTOMRGB:return Dm;case K.n3.ARRAYBUFFER:case K.n3.CUSTOMARRAYBUFFER:return _g;case K.n3.TERRAINRGB:case K.n3.CUSTOMTERRAINRGB:return Q1;default:return pE}default:return J1}}const SE=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:wA}=Me.lodashUtil;class AA{constructor(o){(0,qt.Z)(this,"parent",void 0),(0,qt.Z)(this,"tileLayerService",void 0),(0,qt.Z)(this,"mapService",void 0),(0,qt.Z)(this,"layerService",void 0),(0,qt.Z)(this,"rendererService",void 0),(0,qt.Z)(this,"pickingService",void 0),(0,qt.Z)(this,"tilePickService",void 0),(0,qt.Z)(this,"tilesetManager",void 0),(0,qt.Z)(this,"initedTileset",!1),(0,qt.Z)(this,"lastViewStates",void 0),(0,qt.Z)(this,"mapchange",()=>{var v;if(this.parent.isVisible()===!1)return;const{latLonBounds:T,zoom:O}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===O&&this.lastViewStates.latLonBounds.toString()===T.toString()||(this.lastViewStates={zoom:O,latLonBounds:T},(v=this.tilesetManager)===null||v===void 0||v.throttleUpdate(O,T))}),(0,qt.Z)(this,"viewchange",wA(this.mapchange,24)),this.parent=o;const f=this.parent.getContainer();this.rendererService=f.rendererService,this.layerService=f.layerService,this.mapService=f.mapService,this.pickingService=f.pickingService,this.tileLayerService=new cA({rendererService:this.rendererService,layerService:this.layerService,parent:o}),this.tilePickService=new aE({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:o}),this.parent.setLayerPickService(this.tilePickService),this.proxy(o),this.initTileSetManager()}initTileSetManager(){var o;const f=this.parent.getSource();if(this.tilesetManager=f.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:v,zoom:T}=this.getCurrentView();(o=this.tilesetManager)===null||o===void 0||o.update(T,v)}getCurrentView(){const o=this.mapService.getBounds(),f=[o[0][0],o[0][1],o[1][0],o[1][1]],v=this.mapService.getZoom();return{latLonBounds:f,zoom:v}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",o=>{}),this.tilesetManager.on("tile-unload",o=>{this.tileUnLoad(o)}),this.tilesetManager.on("tile-error",(o,f)=>{this.tileError(o)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(o){return this.tileLayerService.getTile(o)}tileLoaded(o){}tileError(o){console.warn("error:",o)}destroy(){var o;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(o=this.tilesetManager)===null||o===void 0||o.destroy(),this.tileLayerService.destroy()}reload(){var o;this.tilesetManager.clear();const{latLonBounds:f,zoom:v}=this.getCurrentView();(o=this.tilesetManager)===null||o===void 0||o.update(v,f)}tileUnLoad(o){this.tileLayerService.removeTile(o.key)}tileUpdate(){var o=this;return(0,Ai.Z)(function*(){if(!o.tilesetManager)return;const f=o.parent.getMinZoom(),v=o.parent.getMaxZoom(),T=o.tilesetManager.tiles.filter(O=>O.isLoaded).filter(O=>O.isVisibleChange).filter(O=>O.data).filter(O=>O.z>=f&&O.z<v);yield Promise.all(T.map(function(){var O=(0,Ai.Z)(function*(L){if(o.tileLayerService.hasTile(L.key))o.tileLayerService.updateTileVisible(L),o.tilePickService.setPickState(),o.layerService.reRender();else{const F=EE(o.parent),H=new F(L,o.parent);yield H.initTileLayer(),o.tilePickService.setPickState(),H.getLayers().length!==0&&(o.tileLayerService.addTile(H),o.tileLayerService.updateTileVisible(L),o.layerService.reRender())}});return function(L){return O.apply(this,arguments)}}())),o.tilesetManager.isLoaded&&o.parent.emit("tiles-loaded",o.tilesetManager.currentTiles)})()}setPickState(o){}pickRender(o){this.tilePickService.pickRender(o)}selectFeature(o){this.tilePickService.selectFeature(o)}highlightPickedFeature(o){this.tilePickService.highlightPickedFeature(o)}proxy(o){SE.forEach(f=>{const v=o[f].bind(o);o[f]=(...T)=>(v(...T),this.getLayers().map(O=>{O[f](...T)}),f==="style"&&this.getTiles().forEach(O=>O.styleUpdate(...T)),o)})}}class b0 extends null{constructor(...o){super(...o),_defineProperty(this,"isMoving",!1),_defineProperty(this,"maskLayer",void 0),_defineProperty(this,"move",f=>{switch(f.stopPropagation(),f.type){case"touchcancel":case"touchend":case"mouseup":{var v;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(T=>{document.removeEventListener(T,this.move)}),(v=this.scene)===null||v===void 0||v.render();break}case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(T=>{document.addEventListener(T,this.move)});case"mousemove":case"touchmove":{if(this.isMoving)if(this.controlOption.orientation==="vertical"){let T;if("pageX"in f?T=f.pageX:f.touches&&f.touches.length&&f.touches[0].pageX?T=f.touches[0].pageX:f.changedTouches&&f.changedTouches.length&&(T=f.changedTouches[0].pageX),!T)break;const O=this.getContainerDOMRect(),L=this.getContainerSize(),F=L[0],H=(O==null?void 0:O.left)||0,ie=T-H+window.scrollX-document.documentElement.clientLeft,ge=F-Math.min(Math.max(0,F-ie),F),Te=ge/F;this.setOptions({ratio:Te}),this.emit("moving",{size:[ge,L[1]],ratio:[Te,0]})}else{let T;if("pageY"in f?T=f.pageY:f.touches&&f.touches.length&&f.touches[0].pageY?T=f.touches[0].pageY:f.changedTouches&&f.changedTouches.length&&(T=f.changedTouches[0].pageY),!T)break;const O=this.getContainerDOMRect(),L=this.getContainerSize(),F=L[1],H=(O==null?void 0:O.top)||0,ie=T-H+window.scrollY-document.documentElement.clientTop,ge=F-Math.min(Math.max(0,F-ie),F),Te=ge/F;this.setOptions({ratio:Te}),this.emit("moving",{size:[L[0],ge],ratio:[0,Te]})}break}default:break}}),_defineProperty(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),_defineProperty(this,"updateMask",()=>{var f;if(!this.mapsService)return;const v=this.getMaskGeoData();(f=this.maskLayer)===null||f===void 0||f.setData(v)})}getDefault(){return _objectSpread(_objectSpread({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"})}onAdd(){const o=DOM.create("div","l7-control-swipe");DOM.create("button","l7-control-swipe__button",o);const{orientation:f="vertical",ratio:v=.5}=this.controlOption;return f==="horizontal"?(o.style.top=v*100+"%",o.style.left=""):(o.style.left=v*100+"%",o.style.top=""),o.classList.add(f),o}addTo(o){this.mapsService=o.mapService,this.renderService=o.rendererService,this.layerService=o.layerService,this.controlService=o.controlService,this.configService=o.globalConfigService,this.scene=o.sceneService,this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd();const{className:f,style:v,layers:T,rightLayers:O}=this.controlOption;f&&this.setClassName(f),v&&this.setStyle(v),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();const L=createLayerContainer(o);return this.maskLayer.setContainer(L),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(T,!1),this.addMaskToLayers(O,!0),this.emit("add",this),this}onRemove(){if(this.maskLayer){var o;const{layers:f,rightLayers:v}=this.controlOption;this.removeMaskFromLayers(f),this.removeMaskFromLayers(v),(o=this.layerService)===null||o===void 0||o.remove(this.maskLayer)}this.unRegisterEvent(),this.removeAllListeners()}show(){var o;const f=this.container;DOM.removeClass(f,"l7-control-swipe_hide");const{layers:v,rightLayers:T}=this.controlOption;v.forEach(O=>O.enableMask()),T.forEach(O=>O.enableMask()),(o=this.scene)===null||o===void 0||o.render(),this.isShow=!0,this.emit("show",this)}hide(){var o;const f=this.container;DOM.addClass(f,"l7-control-swipe_hide");const{layers:v,rightLayers:T}=this.controlOption;v.forEach(O=>O.disableMask()),T.forEach(O=>O.disableMask()),(o=this.scene)===null||o===void 0||o.render(),this.isShow=!1,this.emit("hide",this)}setOptions(o){const f=_objectSpread(_objectSpread({},this.controlOption),o);if(o.className&&this.setClassName(o.className),o.style&&this.setStyle(o.style),(o.orientation||o.ratio!==void 0)&&this.setOrientationAndRatio(f.orientation,f.ratio),o.layers){const v=o.layers,T=this.controlOption.layers;this.setLayers(v,T,!1)}if(o.rightLayers){const v=o.rightLayers,T=this.controlOption.rightLayers;this.setLayers(v,T,!0)}this.controlOption=f,this.updateMask()}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask)}unRegisterEvent(){var o;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),(o=this.mapsService)===null||o===void 0||o.off("camerachange",this.updateMask)}setOrientationAndRatio(o="vertical",f=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(o),o==="horizontal"?(this.container.style.top=f*100+"%",this.container.style.left=""):(this.container.style.left=f*100+"%",this.container.style.top="")}setLayers(o,f,v=!1){const T=o.filter(L=>f.includes(L)===!1),O=f.filter(L=>o.includes(L)===!1);this.addMaskToLayers(T,v),this.removeMaskFromLayers(O)}addMaskToLayers(o,f){o.forEach(v=>{v.updateLayerConfig({maskInside:!f}),v.addMask(this.maskLayer)})}removeMaskFromLayers(o){o.forEach(f=>{f.updateLayerConfig({maskInside:!0}),f.removeMask(this.maskLayer)})}getMaskGeoData(){const{ratio:o=.5,orientation:f="vertical"}=this.controlOption,v=f==="vertical",[T,O]=this.getBounds(),[L,F]=T,[H,ie]=O;let ge;if(v){const Ve=L+(H-L)*o;ge=[[L,ie],[Ve,ie],[Ve,F],T,[L,ie]]}else{const Ve=this.getContainerSize(),rn=this.mapsService.containerToLngLat([Ve[0],Ve[1]*o]).lat;ge=[[L,ie],O,[H,rn],[L,rn],[L,ie]]}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[ge]}}]}}getContainerDOMRect(){var o;return(o=this.mapsService.getContainer())===null||o===void 0?void 0:o.getBoundingClientRect()}getContainerSize(){return this.mapsService.getSize()}getBounds(){return this.mapsService.getBounds()}addLayer(o,f=!1){const v=Array.isArray(o)?o:[o];if(f){const T=this.controlOption.rightLayers.concat(...v);this.setOptions({rightLayers:T})}else{const T=this.controlOption.layers.concat(...v);this.setOptions({layers:T})}}removeLayer(o){const f=Array.isArray(o)?o:[o],v=this.controlOption.layers.filter(O=>f.includes(O)),T=this.controlOption.rightLayers.filter(O=>f.includes(O));this.setOptions({layers:v,rightLayers:T})}removeLayers(){this.setOptions({layers:[],rightLayers:[]})}}class fP extends null{constructor(...o){super(...o),_defineProperty(this,"disabled",void 0),_defineProperty(this,"zoomInButton",void 0),_defineProperty(this,"zoomOutButton",void 0),_defineProperty(this,"zoomNumDiv",void 0),_defineProperty(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),_defineProperty(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),_defineProperty(this,"updateDisabled",()=>{const f=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||f.getZoom()<=f.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(f.getZoom()))),(this.disabled||f.getZoom()>=f.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{position:PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:createL7Icon("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:createL7Icon("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const o=DOM.create("div","l7-control-zoom");return this.resetButtonGroup(o),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),o}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(o){DOM.clearChildren(o),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",o,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",o)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",o,this.zoomOut),this.updateDisabled()}createButton(o,f,v,T,O){const L=DOM.create("button",v,T);return typeof o=="string"?L.innerHTML=o:L.append(o),L.title=f,O&&L.addEventListener("click",O),L}}class TE extends Wc.EventEmitter{get lngLat(){var o;return(o=this.popupOption.lngLat)!==null&&o!==void 0?o:{lng:0,lat:0}}set lngLat(o){this.popupOption.lngLat=o}constructor(o){super(),(0,qt.Z)(this,"popupOption",void 0),(0,qt.Z)(this,"mapsService",void 0),(0,qt.Z)(this,"sceneService",void 0),(0,qt.Z)(this,"layerService",void 0),(0,qt.Z)(this,"scene",void 0),(0,qt.Z)(this,"closeButton",void 0),(0,qt.Z)(this,"container",void 0),(0,qt.Z)(this,"content",void 0),(0,qt.Z)(this,"contentTitle",void 0),(0,qt.Z)(this,"contentPanel",void 0),(0,qt.Z)(this,"tip",void 0),(0,qt.Z)(this,"isShow",!0),(0,qt.Z)(this,"onMouseMove",v=>{var T;const O=this.mapsService.getMapContainer(),{left:L=0,top:F=0}=(T=O==null?void 0:O.getBoundingClientRect())!==null&&T!==void 0?T:{};this.setPopupPosition(v.clientX-L,v.clientY-F)}),(0,qt.Z)(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:v,lat:T}=this.lngLat,{x:O,y:L}=this.mapsService.lngLatToContainer([v,T]);this.setPopupPosition(O,L)}),(0,qt.Z)(this,"updateLngLatPositionWhenZoom",v=>{if(!this.mapsService||this.popupOption.followCursor)return;const T=v.map,O=T.getSize();O.x=O.x/2,O.y=O.y/2;const L=v.center,F=v.zoom,H=T.DE(this.lngLat,F,L);H.x=Math.round(H.x),H.y=Math.round(H.y),this.setPopupPosition(H.x,H.y,!0)}),(0,qt.Z)(this,"onKeyDown",v=>{v.keyCode===27&&this.remove()}),(0,qt.Z)(this,"onCloseButtonClick",v=>{v.stopPropagation&&v.stopPropagation(),this.hide()}),(0,qt.Z)(this,"updatePosition",(v,T=!0)=>{const O=!!this.lngLat,{className:L,style:F,maxWidth:H,anchor:ie,stopPropagation:ge}=this.popupOption;if(!this.mapsService||!O||!this.content)return;const Te=this.mapsService.getMarkerContainer();if(!this.container&&Te&&(this.container=Me.SO.create("div",`l7-popup ${L!=null?L:""} ${this.isShow?"":"l7-popup-hide"}`,Te),F&&this.container.setAttribute("style",F),this.tip=Me.SO.create("div","l7-popup-tip",this.container),this.container.appendChild(this.content),ge&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(Ve=>{this.container.addEventListener(Ve,Mt=>{Mt.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),T?this.updateLngLatPositionWhenZoom(v):this.updateLngLatPosition(),Me.SO.setTransform(this.container,`${Me.rQ[ie]}`),(0,Me.zi)(this.container,ie,"popup"),H){const{width:Ve}=this.container.getBoundingClientRect();Ve>parseFloat(H)&&(this.container.style.width=H)}else this.container.style.removeProperty("width")}),(0,qt.Z)(this,"updateWhenZoom",v=>{this.updatePosition(v,!0)}),(0,qt.Z)(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=(0,Bn.Z)((0,Bn.Z)({},this.getDefault(o!=null?o:{})),o);const{lngLat:f}=this.popupOption;f&&(this.lngLat=f)}getIsShow(){return this.isShow}addTo(o){this.mapsService=o.mapService,this.sceneService=o.sceneService,this.layerService=o.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=o,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:f,text:v,title:T}=this.popupOption;return f?this.setHTML(f):v&&this.setText(v),T&&this.setTitle(T),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&Me.SO.remove(this.content),this.container&&(Me.SO.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(o){this.show();const{className:f}=this.popupOption;if(this.popupOption=(0,Bn.Z)((0,Bn.Z)({},this.popupOption),o),this.checkUpdateOption(o,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(Me.SO.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(o,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(o,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(o,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(o,["html"])&&o.html?this.setHTML(o.html):this.checkUpdateOption(o,["text"])&&o.text&&this.setText(o.text),this.checkUpdateOption(o,["className"])){var v;f&&this.container.classList.remove(f!=null?f:""),this.container.classList.add((v=o.className)!==null&&v!==void 0?v:"")}if(this.checkUpdateOption(o,["style"])){var T;Me.SO.addStyle(this.container,(T=o.style)!==null&&T!==void 0?T:"")}return this.checkUpdateOption(o,["lngLat"])&&o.lngLat&&this.setLnglat(o.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&Me.SO.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&Me.SO.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(o){return this.popupOption.html=o,this.setDOMContent(o)}setText(o){return this.popupOption.text=o,this.setDOMContent(window.document.createTextNode(o))}setTitle(o){this.show(),this.popupOption.title=o,o?(this.contentTitle||(this.contentTitle=Me.SO.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),Me.SO.clearChildren(this.contentTitle),Me.SO.appendElementType(this.contentTitle,o)):this.contentTitle&&(Me.SO.remove(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:o,lat:f}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([o,f]),this}setLngLat(o){return this.setLnglat(o)}setLnglat(o){return this.show(),this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(o){return this.popupOption.maxWidth=o,this.update(),this}isOpen(){return!!this.mapsService}getDefault(o){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:Me.bV.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(o){return this.show(),this.createContent(),Me.SO.appendElementType(this.contentPanel,o),this.update(),this}updateCloseOnClick(o){const f=this.mapsService;f&&(f==null||f.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!o&&requestAnimationFrame(()=>{f==null||f.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(o){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!o&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(o){var f;const v=(f=this.mapsService)===null||f===void 0?void 0:f.getContainer();v&&(v==null||v.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!o&&(v==null||v.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&Me.SO.remove(this.content),this.contentTitle=void 0,this.content=Me.SO.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const o=vl("l7-icon-guanbi");Me.SO.addClass(o,"l7-popup-close-button"),this.content.appendChild(o),this.popupOption.closeButtonOffsets&&(o.style.right=this.popupOption.closeButtonOffsets[0]+"px",o.style.top=this.popupOption.closeButtonOffsets[1]+"px"),o.setAttribute("aria-label","Close popup"),o.addEventListener("click",()=>{this.hide()}),o.addEventListener("pointerup",f=>{f.stopPropagation()}),o.addEventListener("pointerdown",f=>{f.stopPropagation()}),this.closeButton=o}else this.closeButton=void 0;this.contentPanel=Me.SO.create("div","l7-popup-content__panel",this.content)}setPopupPosition(o,f,v=!1){if(this.container){const{offsets:T}=this.popupOption;this.container.style.left=o+T[0]+"px",this.container.style.top=f-T[1]+"px",v?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(o,f){return f.some(v=>v in o)}}const{get:Y0}=Me.lodashUtil;class hP extends null{constructor(...o){super(...o),_defineProperty(this,"layerClickCountByFrame",0),_defineProperty(this,"layerConfigMap",new WeakMap),_defineProperty(this,"displayFeatureInfo",void 0),_defineProperty(this,"onLayerClick",(f,v)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(f,v.featureId))this.hide();else{const{title:T,content:O}=this.getLayerInfoFrag(f,v);this.setDOMContent(O),this.setLnglat(v.lngLat),this.setTitle(T),this.setDisplayFeatureInfo({layer:f,featureId:v.featureId}),this.show()}})}),_defineProperty(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),_defineProperty(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),_defineProperty(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var o;const{config:f,items:v}=this.popupOption;return(o=f!=null?f:v)!==null&&o!==void 0?o:[]}addTo(o){return super.addTo(o),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(o){this.unbindLayerEvent();const f=_objectSpread({},o),v=f.trigger||this.popupOption.trigger,T=f.items||this.popupOption.items,O=(T==null?void 0:T.length)===0;f.followCursor=v==="hover"&&!O;const L=this.isShow;return super.setOptions(f),this.bindLayerEvent(),(O||!L)&&this.hide(),this}getDefault(o){const f=o.trigger!=="click";return _objectSpread(_objectSpread({},super.getDefault(o)),{},{trigger:"hover",followCursor:f,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:o,closeOnClick:f}=this.popupOption;this.layerConfigItems.forEach(v=>{var T;const O=this.getLayerByConfig(v);if(!O)return;const L=_objectSpread({},v);if(o==="hover"){const ge=this.onLayerMouseMove.bind(this,O),Te=this.onLayerMouseOut.bind(this,O);L.onMouseMove=ge,L.onMouseOut=Te,O==null||O.on("mousemove",ge),O==null||O.on("mouseout",Te)}else{var F;const ge=this.onLayerClick.bind(this,O);L.onClick=ge,O==null||O.on("click",ge);const Te=(F=this.mapsService)===null||F===void 0?void 0:F.getMapContainer();Te&&f&&Te.addEventListener("click",this.onSceneClick)}const H=O==null||(T=O.getSource)===null||T===void 0?void 0:T.call(O),ie=this.onSourceUpdate.bind(this);H==null||H.on("update",ie),L.onSourceUpdate=ie,this.layerConfigMap.set(O,L)})}unbindLayerEvent(){this.layerConfigItems.forEach(o=>{var f;const v=this.getLayerByConfig(o),T=v&&this.layerConfigMap.get(v);if(!T)return;const{onMouseMove:O,onMouseOut:L,onClick:F,onSourceUpdate:H}=T;if(O&&v.off("mousemove",O),L&&v.off("mouseout",L),F&&v.off("click",F),H){var ie;v==null||(ie=v.getSource())===null||ie===void 0||ie.off("update",H)}const ge=(f=this.mapsService)===null||f===void 0?void 0:f.getMapContainer();ge&&ge.removeEventListener("click",this.onSceneClick)})}onLayerMouseMove(o,f){if(!this.isSameFeature(o,f.featureId)){const{title:v,content:T}=this.getLayerInfoFrag(o,f);this.setDOMContent(T),this.setTitle(v),this.setDisplayFeatureInfo({layer:o,featureId:f.featureId}),this.show()}}onLayerMouseOut(o,f){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(o,f){const v=this.layerConfigMap.get(o);let T;const O=document.createDocumentFragment();if(v){let L=f.feature;L.type==="Feature"&&"properties"in L&&"geometry"in L&&(L=L.properties);const{title:F,fields:H,customContent:ie}=v;if(F){T=document.createDocumentFragment();const ge=F instanceof Function?F(L):F;DOM.appendElementType(T,ge)}if(ie){const ge=ie instanceof Function?ie(L):ie;DOM.appendElementType(O,ge)}else H!=null&&H.length&&(H==null||H.forEach(ge=>{var Te,Ve;const{field:Mt,formatField:rn,formatValue:Rn,getValue:hr}=typeof ge=="string"?{field:ge}:ge,Nr=DOM.create("div","l7-layer-popup__row"),jn=hr?hr(f.feature):Y0(L,Mt),ci=(Te=rn instanceof Function?rn(Mt,L):rn)!==null&&Te!==void 0?Te:Mt;let ji=(Ve=Rn instanceof Function?Rn(jn,L):Rn)!==null&&Ve!==void 0?Ve:jn;const To=DOM.create("span","l7-layer-popup__key",Nr);DOM.appendElementType(To,ci),DOM.appendElementType(To,document.createTextNode("\uFF1A"));const Ji=DOM.create("span","l7-layer-popup__value",Nr);Array.isArray(ji)&&ji.every(Hr=>!(Hr instanceof Object))&&(ji=ji.map(Hr=>String(Hr)).join(",")),DOM.appendElementType(Ji,ji),O.appendChild(Nr)}))}return{title:T,content:O}}getLayerByConfig(o){const f=o.layer;if(f instanceof Object)return f;if(typeof f=="string")return this.layerService.getLayer(f)||this.layerService.getLayerByName(f)}isSameFeature(o,f){const v=this.displayFeatureInfo;return v&&o===v.layer&&f===v.featureId}setDisplayFeatureInfo(o){const f=this.displayFeatureInfo;f&&f.layer.off("hide",this.onLayerHide),o&&o.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=o}}function wE(a,o){var f=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,v=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(f||v)&&(o||(o=document),!!o)){var T=o.head||o.getElementsByTagName("head")[0];if(!T){T=o.createElement("head");var O=o.body||o.getElementsByTagName("body")[0];O?O.parentNode.insertBefore(T,O):o.documentElement.appendChild(T)}var L=o.createElement("style");return L.type="text/css",L.styleSheet?L.styleSheet.cssText=a:L.appendChild(o.createTextNode(a)),T.appendChild(L),L}}wE(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var CA=D(81550),OA=D.n(CA),Af=class{constructor(a,o){const{buffer:f,offset:v,stride:T,normalized:O,size:L,divisor:F}=o;this.buffer=f,this.attribute={buffer:f.get(),offset:v||0,stride:T||0,normalized:O||!1,divisor:F||0},L&&(this.attribute.size=L)}get(){return this.attribute}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},sd={[K.gl.POINTS]:"points",[K.gl.LINES]:"lines",[K.gl.LINE_LOOP]:"line loop",[K.gl.LINE_STRIP]:"line strip",[K.gl.TRIANGLES]:"triangles",[K.gl.TRIANGLE_FAN]:"triangle fan",[K.gl.TRIANGLE_STRIP]:"triangle strip"},AE={[K.gl.STATIC_DRAW]:"static",[K.gl.DYNAMIC_DRAW]:"dynamic",[K.gl.STREAM_DRAW]:"stream"},Ly={[K.gl.BYTE]:"int8",[K.gl.INT]:"int32",[K.gl.UNSIGNED_BYTE]:"uint8",[K.gl.UNSIGNED_SHORT]:"uint16",[K.gl.UNSIGNED_INT]:"uint32",[K.gl.FLOAT]:"float"},RA={[K.gl.ALPHA]:"alpha",[K.gl.LUMINANCE]:"luminance",[K.gl.LUMINANCE_ALPHA]:"luminance alpha",[K.gl.RGB]:"rgb",[K.gl.RGBA]:"rgba",[K.gl.RGBA4]:"rgba4",[K.gl.RGB5_A1]:"rgb5 a1",[K.gl.RGB565]:"rgb565",[K.gl.DEPTH_COMPONENT]:"depth",[K.gl.DEPTH_STENCIL]:"depth stencil"},MA={[K.gl.DONT_CARE]:"dont care",[K.gl.NICEST]:"nice",[K.gl.FASTEST]:"fast"},CE={[K.gl.NEAREST]:"nearest",[K.gl.LINEAR]:"linear",[K.gl.LINEAR_MIPMAP_LINEAR]:"mipmap",[K.gl.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[K.gl.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[K.gl.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},$a={[K.gl.REPEAT]:"repeat",[K.gl.CLAMP_TO_EDGE]:"clamp",[K.gl.MIRRORED_REPEAT]:"mirror"},PA={[K.gl.NONE]:"none",[K.gl.BROWSER_DEFAULT_WEBGL]:"browser"},lp={[K.gl.NEVER]:"never",[K.gl.ALWAYS]:"always",[K.gl.LESS]:"less",[K.gl.LEQUAL]:"lequal",[K.gl.GREATER]:"greater",[K.gl.GEQUAL]:"gequal",[K.gl.EQUAL]:"equal",[K.gl.NOTEQUAL]:"notequal"},e_={[K.gl.FUNC_ADD]:"add",[K.gl.MIN_EXT]:"min",[K.gl.MAX_EXT]:"max",[K.gl.FUNC_SUBTRACT]:"subtract",[K.gl.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},zb={[K.gl.ZERO]:"zero",[K.gl.ONE]:"one",[K.gl.SRC_COLOR]:"src color",[K.gl.ONE_MINUS_SRC_COLOR]:"one minus src color",[K.gl.SRC_ALPHA]:"src alpha",[K.gl.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[K.gl.DST_COLOR]:"dst color",[K.gl.ONE_MINUS_DST_COLOR]:"one minus dst color",[K.gl.DST_ALPHA]:"dst alpha",[K.gl.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[K.gl.CONSTANT_COLOR]:"constant color",[K.gl.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[K.gl.CONSTANT_ALPHA]:"constant alpha",[K.gl.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[K.gl.SRC_ALPHA_SATURATE]:"src alpha saturate"},dP={[K.gl.NEVER]:"never",[K.gl.ALWAYS]:"always",[K.gl.LESS]:"less",[K.gl.LEQUAL]:"lequal",[K.gl.GREATER]:"greater",[K.gl.GEQUAL]:"gequal",[K.gl.EQUAL]:"equal",[K.gl.NOTEQUAL]:"notequal"},nl={[K.gl.ZERO]:"zero",[K.gl.KEEP]:"keep",[K.gl.REPLACE]:"replace",[K.gl.INVERT]:"invert",[K.gl.INCR]:"increment",[K.gl.DECR]:"decrement",[K.gl.INCR_WRAP]:"increment wrap",[K.gl.DECR_WRAP]:"decrement wrap"},Ih={[K.gl.FRONT]:"front",[K.gl.BACK]:"back"},$0=class{constructor(a,o){this.isDestroyed=!1;const{data:f,usage:v,type:T}=o;this.buffer=a.buffer({data:f,usage:AE[v||K.gl.STATIC_DRAW],type:Ly[T||K.gl.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:o}){this.buffer.subdata(a,o)}},Dy=class{constructor(a,o){const{data:f,usage:v,type:T,count:O}=o;this.elements=a.elements({data:f,usage:AE[v||K.gl.STATIC_DRAW],type:Ly[T||K.gl.UNSIGNED_BYTE],count:O})}get(){return this.elements}subData({data:a}){this.elements.subdata(a)}destroy(){}},Ub=class{constructor(a,o){const{width:f,height:v,color:T,colors:O}=o,L={width:f,height:v};Array.isArray(O)&&(L.colors=O.map(F=>F.get())),T&&typeof T!="boolean"&&(L.color=T.get()),this.framebuffer=a.framebuffer(L)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:a,height:o}){this.framebuffer.resize(a,o)}},Cf=D(95147),cp=D(25897),Ny=D(81957),_o=D(97582),pP=D(90857),OE=pP,Tn;(function(a){a[a.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",a[a.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",a[a.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN",a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC_COLOR=768]="SRC_COLOR",a[a.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.DST_COLOR=774]="DST_COLOR",a[a.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",a[a.CONSTANT_COLOR=32769]="CONSTANT_COLOR",a[a.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",a[a.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",a[a.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",a[a.FUNC_ADD=32774]="FUNC_ADD",a[a.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",a[a.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",a[a.BLEND_EQUATION=32777]="BLEND_EQUATION",a[a.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",a[a.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",a[a.BLEND_DST_RGB=32968]="BLEND_DST_RGB",a[a.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",a[a.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",a[a.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",a[a.BLEND_COLOR=32773]="BLEND_COLOR",a[a.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",a[a.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",a[a.LINE_WIDTH=2849]="LINE_WIDTH",a[a.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",a[a.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",a[a.CULL_FACE_MODE=2885]="CULL_FACE_MODE",a[a.FRONT_FACE=2886]="FRONT_FACE",a[a.DEPTH_RANGE=2928]="DEPTH_RANGE",a[a.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",a[a.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",a[a.DEPTH_FUNC=2932]="DEPTH_FUNC",a[a.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",a[a.STENCIL_FUNC=2962]="STENCIL_FUNC",a[a.STENCIL_FAIL=2964]="STENCIL_FAIL",a[a.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",a[a.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",a[a.STENCIL_REF=2967]="STENCIL_REF",a[a.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",a[a.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",a[a.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",a[a.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",a[a.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",a[a.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",a[a.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",a[a.VIEWPORT=2978]="VIEWPORT",a[a.SCISSOR_BOX=3088]="SCISSOR_BOX",a[a.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",a[a.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",a[a.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",a[a.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",a[a.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",a[a.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",a[a.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",a[a.RED_BITS=3410]="RED_BITS",a[a.GREEN_BITS=3411]="GREEN_BITS",a[a.BLUE_BITS=3412]="BLUE_BITS",a[a.ALPHA_BITS=3413]="ALPHA_BITS",a[a.DEPTH_BITS=3414]="DEPTH_BITS",a[a.STENCIL_BITS=3415]="STENCIL_BITS",a[a.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",a[a.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",a[a.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",a[a.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",a[a.SAMPLES=32937]="SAMPLES",a[a.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",a[a.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",a[a.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",a[a.VENDOR=7936]="VENDOR",a[a.RENDERER=7937]="RENDERER",a[a.VERSION=7938]="VERSION",a[a.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",a[a.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",a[a.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",a[a.STATIC_DRAW=35044]="STATIC_DRAW",a[a.STREAM_DRAW=35040]="STREAM_DRAW",a[a.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.BUFFER_SIZE=34660]="BUFFER_SIZE",a[a.BUFFER_USAGE=34661]="BUFFER_USAGE",a[a.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",a[a.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",a[a.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",a[a.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",a[a.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",a[a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",a[a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",a[a.CULL_FACE=2884]="CULL_FACE",a[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",a[a.BLEND=3042]="BLEND",a[a.DEPTH_TEST=2929]="DEPTH_TEST",a[a.DITHER=3024]="DITHER",a[a.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",a[a.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",a[a.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",a[a.SCISSOR_TEST=3089]="SCISSOR_TEST",a[a.STENCIL_TEST=2960]="STENCIL_TEST",a[a.NO_ERROR=0]="NO_ERROR",a[a.INVALID_ENUM=1280]="INVALID_ENUM",a[a.INVALID_VALUE=1281]="INVALID_VALUE",a[a.INVALID_OPERATION=1282]="INVALID_OPERATION",a[a.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",a[a.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",a[a.CW=2304]="CW",a[a.CCW=2305]="CCW",a[a.DONT_CARE=4352]="DONT_CARE",a[a.FASTEST=4353]="FASTEST",a[a.NICEST=4354]="NICEST",a[a.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",a[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.DOUBLE=5130]="DOUBLE",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.ALPHA=6406]="ALPHA",a[a.RGB=6407]="RGB",a[a.RGBA=6408]="RGBA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",a[a.VERTEX_SHADER=35633]="VERTEX_SHADER",a[a.COMPILE_STATUS=35713]="COMPILE_STATUS",a[a.DELETE_STATUS=35712]="DELETE_STATUS",a[a.LINK_STATUS=35714]="LINK_STATUS",a[a.VALIDATE_STATUS=35715]="VALIDATE_STATUS",a[a.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",a[a.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",a[a.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",a[a.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",a[a.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",a[a.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",a[a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",a[a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",a[a.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",a[a.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",a[a.SHADER_TYPE=35663]="SHADER_TYPE",a[a.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",a[a.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",a[a.NEVER=512]="NEVER",a[a.ALWAYS=519]="ALWAYS",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.GEQUAL=518]="GEQUAL",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.KEEP=7680]="KEEP",a[a.REPLACE=7681]="REPLACE",a[a.INCR=7682]="INCR",a[a.DECR=7683]="DECR",a[a.INVERT=5386]="INVERT",a[a.INCR_WRAP=34055]="INCR_WRAP",a[a.DECR_WRAP=34056]="DECR_WRAP",a[a.NEAREST=9728]="NEAREST",a[a.LINEAR=9729]="LINEAR",a[a.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",a[a.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",a[a.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",a[a.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",a[a.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",a[a.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",a[a.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",a[a.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE=5890]="TEXTURE",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",a[a.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",a[a.TEXTURE0=33984]="TEXTURE0",a[a.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",a[a.REPEAT=10497]="REPEAT",a[a.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",a[a.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",a[a.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",a[a.SAMPLER_CUBE=35680]="SAMPLER_CUBE",a[a.LOW_FLOAT=36336]="LOW_FLOAT",a[a.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",a[a.HIGH_FLOAT=36338]="HIGH_FLOAT",a[a.LOW_INT=36339]="LOW_INT",a[a.MEDIUM_INT=36340]="MEDIUM_INT",a[a.HIGH_INT=36341]="HIGH_INT",a[a.FRAMEBUFFER=36160]="FRAMEBUFFER",a[a.RENDERBUFFER=36161]="RENDERBUFFER",a[a.RGBA4=32854]="RGBA4",a[a.RGB5_A1=32855]="RGB5_A1",a[a.RGB565=36194]="RGB565",a[a.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",a[a.STENCIL_INDEX=6401]="STENCIL_INDEX",a[a.STENCIL_INDEX8=36168]="STENCIL_INDEX8",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",a[a.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",a[a.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",a[a.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",a[a.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",a[a.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",a[a.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",a[a.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",a[a.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",a[a.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",a[a.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",a[a.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",a[a.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",a[a.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",a[a.NONE=0]="NONE",a[a.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",a[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",a[a.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",a[a.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",a[a.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",a[a.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",a[a.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",a[a.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",a[a.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",a[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",a[a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",a[a.READ_BUFFER=3074]="READ_BUFFER",a[a.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",a[a.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",a[a.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",a[a.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",a[a.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",a[a.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",a[a.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",a[a.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",a[a.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",a[a.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",a[a.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",a[a.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",a[a.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",a[a.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",a[a.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",a[a.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",a[a.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",a[a.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",a[a.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",a[a.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",a[a.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",a[a.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",a[a.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",a[a.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",a[a.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",a[a.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",a[a.RED=6403]="RED",a[a.RGB8=32849]="RGB8",a[a.RGBA8=32856]="RGBA8",a[a.RGB10_A2=32857]="RGB10_A2",a[a.TEXTURE_3D=32879]="TEXTURE_3D",a[a.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",a[a.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",a[a.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",a[a.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",a[a.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",a[a.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",a[a.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",a[a.SRGB=35904]="SRGB",a[a.SRGB8=35905]="SRGB8",a[a.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",a[a.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",a[a.RGBA32F=34836]="RGBA32F",a[a.RGB32F=34837]="RGB32F",a[a.RGBA16F=34842]="RGBA16F",a[a.RGB16F=34843]="RGB16F",a[a.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",a[a.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",a[a.R11F_G11F_B10F=35898]="R11F_G11F_B10F",a[a.RGB9_E5=35901]="RGB9_E5",a[a.RGBA32UI=36208]="RGBA32UI",a[a.RGB32UI=36209]="RGB32UI",a[a.RGBA16UI=36214]="RGBA16UI",a[a.RGB16UI=36215]="RGB16UI",a[a.RGBA8UI=36220]="RGBA8UI",a[a.RGB8UI=36221]="RGB8UI",a[a.RGBA32I=36226]="RGBA32I",a[a.RGB32I=36227]="RGB32I",a[a.RGBA16I=36232]="RGBA16I",a[a.RGB16I=36233]="RGB16I",a[a.RGBA8I=36238]="RGBA8I",a[a.RGB8I=36239]="RGB8I",a[a.RED_INTEGER=36244]="RED_INTEGER",a[a.RGB_INTEGER=36248]="RGB_INTEGER",a[a.RGBA_INTEGER=36249]="RGBA_INTEGER",a[a.R8=33321]="R8",a[a.RG8=33323]="RG8",a[a.R16F=33325]="R16F",a[a.R32F=33326]="R32F",a[a.RG16F=33327]="RG16F",a[a.RG32F=33328]="RG32F",a[a.R8I=33329]="R8I",a[a.R8UI=33330]="R8UI",a[a.R16I=33331]="R16I",a[a.R16UI=33332]="R16UI",a[a.R32I=33333]="R32I",a[a.R32UI=33334]="R32UI",a[a.RG8I=33335]="RG8I",a[a.RG8UI=33336]="RG8UI",a[a.RG16I=33337]="RG16I",a[a.RG16UI=33338]="RG16UI",a[a.RG32I=33339]="RG32I",a[a.RG32UI=33340]="RG32UI",a[a.R8_SNORM=36756]="R8_SNORM",a[a.RG8_SNORM=36757]="RG8_SNORM",a[a.RGB8_SNORM=36758]="RGB8_SNORM",a[a.RGBA8_SNORM=36759]="RGBA8_SNORM",a[a.RGB10_A2UI=36975]="RGB10_A2UI",a[a.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",a[a.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",a[a.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",a[a.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",a[a.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",a[a.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",a[a.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",a[a.HALF_FLOAT=5131]="HALF_FLOAT",a[a.RG=33319]="RG",a[a.RG_INTEGER=33320]="RG_INTEGER",a[a.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",a[a.CURRENT_QUERY=34917]="CURRENT_QUERY",a[a.QUERY_RESULT=34918]="QUERY_RESULT",a[a.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",a[a.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",a[a.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",a[a.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",a[a.DRAW_BUFFER0=34853]="DRAW_BUFFER0",a[a.DRAW_BUFFER1=34854]="DRAW_BUFFER1",a[a.DRAW_BUFFER2=34855]="DRAW_BUFFER2",a[a.DRAW_BUFFER3=34856]="DRAW_BUFFER3",a[a.DRAW_BUFFER4=34857]="DRAW_BUFFER4",a[a.DRAW_BUFFER5=34858]="DRAW_BUFFER5",a[a.DRAW_BUFFER6=34859]="DRAW_BUFFER6",a[a.DRAW_BUFFER7=34860]="DRAW_BUFFER7",a[a.DRAW_BUFFER8=34861]="DRAW_BUFFER8",a[a.DRAW_BUFFER9=34862]="DRAW_BUFFER9",a[a.DRAW_BUFFER10=34863]="DRAW_BUFFER10",a[a.DRAW_BUFFER11=34864]="DRAW_BUFFER11",a[a.DRAW_BUFFER12=34865]="DRAW_BUFFER12",a[a.DRAW_BUFFER13=34866]="DRAW_BUFFER13",a[a.DRAW_BUFFER14=34867]="DRAW_BUFFER14",a[a.DRAW_BUFFER15=34868]="DRAW_BUFFER15",a[a.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",a[a.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",a[a.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",a[a.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",a[a.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",a[a.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",a[a.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",a[a.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",a[a.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",a[a.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",a[a.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",a[a.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",a[a.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",a[a.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",a[a.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",a[a.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",a[a.SAMPLER_3D=35679]="SAMPLER_3D",a[a.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",a[a.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",a[a.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",a[a.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",a[a.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",a[a.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",a[a.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",a[a.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",a[a.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",a[a.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",a[a.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",a[a.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",a[a.MAX_SAMPLES=36183]="MAX_SAMPLES",a[a.SAMPLER_BINDING=35097]="SAMPLER_BINDING",a[a.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",a[a.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",a[a.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",a[a.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",a[a.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",a[a.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",a[a.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",a[a.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",a[a.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",a[a.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",a[a.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",a[a.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",a[a.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",a[a.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",a[a.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",a[a.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",a[a.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",a[a.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",a[a.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",a[a.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",a[a.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",a[a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",a[a.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",a[a.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",a[a.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",a[a.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",a[a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",a[a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",a[a.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",a[a.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",a[a.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",a[a.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",a[a.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",a[a.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",a[a.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",a[a.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",a[a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",a[a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",a[a.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",a[a.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",a[a.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",a[a.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",a[a.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",a[a.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",a[a.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",a[a.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",a[a.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",a[a.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",a[a.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",a[a.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",a[a.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",a[a.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",a[a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",a[a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",a[a.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",a[a.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",a[a.UNIFORM_TYPE=35383]="UNIFORM_TYPE",a[a.UNIFORM_SIZE=35384]="UNIFORM_SIZE",a[a.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",a[a.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",a[a.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",a[a.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",a[a.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",a[a.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",a[a.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",a[a.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",a[a.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",a[a.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",a[a.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",a[a.OBJECT_TYPE=37138]="OBJECT_TYPE",a[a.SYNC_CONDITION=37139]="SYNC_CONDITION",a[a.SYNC_STATUS=37140]="SYNC_STATUS",a[a.SYNC_FLAGS=37141]="SYNC_FLAGS",a[a.SYNC_FENCE=37142]="SYNC_FENCE",a[a.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",a[a.UNSIGNALED=37144]="UNSIGNALED",a[a.SIGNALED=37145]="SIGNALED",a[a.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",a[a.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",a[a.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",a[a.WAIT_FAILED=37149]="WAIT_FAILED",a[a.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",a[a.COLOR=6144]="COLOR",a[a.DEPTH=6145]="DEPTH",a[a.STENCIL=6146]="STENCIL",a[a.MIN=32775]="MIN",a[a.MAX=32776]="MAX",a[a.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",a[a.STREAM_READ=35041]="STREAM_READ",a[a.STREAM_COPY=35042]="STREAM_COPY",a[a.STATIC_READ=35045]="STATIC_READ",a[a.STATIC_COPY=35046]="STATIC_COPY",a[a.DYNAMIC_READ=35049]="DYNAMIC_READ",a[a.DYNAMIC_COPY=35050]="DYNAMIC_COPY",a[a.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",a[a.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",a[a.INVALID_INDEX=4294967295]="INVALID_INDEX",a[a.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",a[a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",a[a.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",a[a.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",a[a.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",a[a.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",a[a.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",a[a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",a[a.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",a[a.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",a[a.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",a[a.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",a[a.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",a[a.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",a[a.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",a[a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",a[a.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",a[a.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",a[a.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",a[a.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",a[a.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",a[a.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",a[a.RGBA32F_EXT=34836]="RGBA32F_EXT",a[a.RGB32F_EXT=34837]="RGB32F_EXT",a[a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",a[a.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",a[a.MIN_EXT=32775]="MIN_EXT",a[a.MAX_EXT=32776]="MAX_EXT",a[a.SRGB_EXT=35904]="SRGB_EXT",a[a.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",a[a.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",a[a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",a[a.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",a[a.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",a[a.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",a[a.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",a[a.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",a[a.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",a[a.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",a[a.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",a[a.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",a[a.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",a[a.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",a[a.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",a[a.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",a[a.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",a[a.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",a[a.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",a[a.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",a[a.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",a[a.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",a[a.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",a[a.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",a[a.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",a[a.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",a[a.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",a[a.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",a[a.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",a[a.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",a[a.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",a[a.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",a[a.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",a[a.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",a[a.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",a[a.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",a[a.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",a[a.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",a[a.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",a[a.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",a[a.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",a[a.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",a[a.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",a[a.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",a[a.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",a[a.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(Tn||(Tn={}));var Ds;(function(a){a[a.Buffer=0]="Buffer",a[a.Texture=1]="Texture",a[a.RenderTarget=2]="RenderTarget",a[a.Sampler=3]="Sampler",a[a.Program=4]="Program",a[a.Bindings=5]="Bindings",a[a.InputLayout=6]="InputLayout",a[a.RenderPipeline=7]="RenderPipeline",a[a.ComputePipeline=8]="ComputePipeline",a[a.Readback=9]="Readback",a[a.QueryPool=10]="QueryPool",a[a.RenderBundle=11]="RenderBundle"})(Ds||(Ds={}));var Ya;(function(a){a[a.NEVER=512]="NEVER",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.GEQUAL=518]="GEQUAL",a[a.ALWAYS=519]="ALWAYS"})(Ya||(Ya={}));var By;(function(a){a[a.CCW=2305]="CCW",a[a.CW=2304]="CW"})(By||(By={}));var ld;(function(a){a[a.NONE=0]="NONE",a[a.FRONT=1]="FRONT",a[a.BACK=2]="BACK",a[a.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(ld||(ld={}));var ls;(function(a){a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC=768]="SRC",a[a.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",a[a.DST=774]="DST",a[a.ONE_MINUS_DST=775]="ONE_MINUS_DST",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.CONST=32769]="CONST",a[a.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(ls||(ls={}));var hf;(function(a){a[a.ADD=32774]="ADD",a[a.SUBSTRACT=32778]="SUBSTRACT",a[a.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",a[a.MIN=32775]="MIN",a[a.MAX=32776]="MAX"})(hf||(hf={}));var Of;(function(a){a[a.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",a[a.REPEAT=1]="REPEAT",a[a.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(Of||(Of={}));var sa;(function(a){a[a.POINT=0]="POINT",a[a.BILINEAR=1]="BILINEAR"})(sa||(sa={}));var Hl;(function(a){a[a.NO_MIP=0]="NO_MIP",a[a.NEAREST=1]="NEAREST",a[a.LINEAR=2]="LINEAR"})(Hl||(Hl={}));var Pl;(function(a){a[a.POINTS=0]="POINTS",a[a.TRIANGLES=1]="TRIANGLES",a[a.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",a[a.LINES=3]="LINES",a[a.LINE_STRIP=4]="LINE_STRIP"})(Pl||(Pl={}));var Ss;(function(a){a[a.MAP_READ=1]="MAP_READ",a[a.MAP_WRITE=2]="MAP_WRITE",a[a.COPY_SRC=4]="COPY_SRC",a[a.COPY_DST=8]="COPY_DST",a[a.INDEX=16]="INDEX",a[a.VERTEX=32]="VERTEX",a[a.UNIFORM=64]="UNIFORM",a[a.STORAGE=128]="STORAGE",a[a.INDIRECT=256]="INDIRECT",a[a.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(Ss||(Ss={}));var cd;(function(a){a[a.STATIC=1]="STATIC",a[a.DYNAMIC=2]="DYNAMIC"})(cd||(cd={}));var Av;(function(a){a[a.VERTEX=1]="VERTEX",a[a.INSTANCE=2]="INSTANCE"})(Av||(Av={}));var RE;(function(a){a.LOADED="loaded"})(RE||(RE={}));var rs;(function(a){a[a.TEXTURE_2D=0]="TEXTURE_2D",a[a.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",a[a.TEXTURE_3D=2]="TEXTURE_3D",a[a.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(rs||(rs={}));var hu;(function(a){a[a.SAMPLED=1]="SAMPLED",a[a.RENDER_TARGET=2]="RENDER_TARGET",a[a.STORAGE=4]="STORAGE"})(hu||(hu={}));var Ku;(function(a){a[a.NONE=0]="NONE",a[a.RED=1]="RED",a[a.GREEN=2]="GREEN",a[a.BLUE=4]="BLUE",a[a.ALPHA=8]="ALPHA",a[a.RGB=7]="RGB",a[a.ALL=15]="ALL"})(Ku||(Ku={}));var Cc;(function(a){a[a.KEEP=7680]="KEEP",a[a.ZERO=0]="ZERO",a[a.REPLACE=7681]="REPLACE",a[a.INVERT=5386]="INVERT",a[a.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",a[a.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",a[a.INCREMENT_WRAP=34055]="INCREMENT_WRAP",a[a.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(Cc||(Cc={}));function ME(a,o,f,v){var T=rs.TEXTURE_2D,O=1,L=hu.SAMPLED;return{dimension:T,format:a,width:o,height:f,depthOrArrayLayers:O,mipLevelCount:v,usage:L}}var Oc;(function(a){a[a.Float=0]="Float",a[a.UnfilterableFloat=1]="UnfilterableFloat",a[a.Uint=2]="Uint",a[a.Sint=3]="Sint",a[a.Depth=4]="Depth"})(Oc||(Oc={}));var Vp;(function(a){a[a.LOWER_LEFT=0]="LOWER_LEFT",a[a.UPPER_LEFT=1]="UPPER_LEFT"})(Vp||(Vp={}));var bg;(function(a){a[a.NEGATIVE_ONE=0]="NEGATIVE_ONE",a[a.ZERO=1]="ZERO"})(bg||(bg={}));var t_;(function(a){a[a.OcclusionConservative=0]="OcclusionConservative"})(t_||(t_={}));var oi;(function(a){a[a.U8=1]="U8",a[a.U16=2]="U16",a[a.U32=3]="U32",a[a.S8=4]="S8",a[a.S16=5]="S16",a[a.S32=6]="S32",a[a.F16=7]="F16",a[a.F32=8]="F32",a[a.BC1=65]="BC1",a[a.BC2=66]="BC2",a[a.BC3=67]="BC3",a[a.BC4_UNORM=68]="BC4_UNORM",a[a.BC4_SNORM=69]="BC4_SNORM",a[a.BC5_UNORM=70]="BC5_UNORM",a[a.BC5_SNORM=71]="BC5_SNORM",a[a.U16_PACKED_5551=97]="U16_PACKED_5551",a[a.U16_PACKED_565=98]="U16_PACKED_565",a[a.D24=129]="D24",a[a.D32F=130]="D32F",a[a.D24S8=131]="D24S8",a[a.D32FS8=132]="D32FS8"})(oi||(oi={}));var Bi;(function(a){a[a.R=1]="R",a[a.RG=2]="RG",a[a.RGB=3]="RGB",a[a.RGBA=4]="RGBA",a[a.A=5]="A"})(Bi||(Bi={}));function mP(a){return a}var mo;(function(a){a[a.None=0]="None",a[a.Normalized=1]="Normalized",a[a.sRGB=2]="sRGB",a[a.Depth=4]="Depth",a[a.Stencil=8]="Stencil",a[a.RenderTarget=16]="RenderTarget",a[a.Luminance=32]="Luminance"})(mo||(mo={}));function Qo(a,o,f){return a<<16|o<<8|f}var or;(function(a){a[a.ALPHA=Qo(oi.U8,Bi.A,mo.None)]="ALPHA",a[a.U8_LUMINANCE=Qo(oi.U8,Bi.A,mo.Luminance)]="U8_LUMINANCE",a[a.F16_LUMINANCE=Qo(oi.F16,Bi.A,mo.Luminance)]="F16_LUMINANCE",a[a.F32_LUMINANCE=Qo(oi.F32,Bi.A,mo.Luminance)]="F32_LUMINANCE",a[a.F16_R=Qo(oi.F16,Bi.R,mo.None)]="F16_R",a[a.F16_RG=Qo(oi.F16,Bi.RG,mo.None)]="F16_RG",a[a.F16_RGB=Qo(oi.F16,Bi.RGB,mo.None)]="F16_RGB",a[a.F16_RGBA=Qo(oi.F16,Bi.RGBA,mo.None)]="F16_RGBA",a[a.F32_R=Qo(oi.F32,Bi.R,mo.None)]="F32_R",a[a.F32_RG=Qo(oi.F32,Bi.RG,mo.None)]="F32_RG",a[a.F32_RGB=Qo(oi.F32,Bi.RGB,mo.None)]="F32_RGB",a[a.F32_RGBA=Qo(oi.F32,Bi.RGBA,mo.None)]="F32_RGBA",a[a.U8_R=Qo(oi.U8,Bi.R,mo.None)]="U8_R",a[a.U8_R_NORM=Qo(oi.U8,Bi.R,mo.Normalized)]="U8_R_NORM",a[a.U8_RG=Qo(oi.U8,Bi.RG,mo.None)]="U8_RG",a[a.U8_RG_NORM=Qo(oi.U8,Bi.RG,mo.Normalized)]="U8_RG_NORM",a[a.U8_RGB=Qo(oi.U8,Bi.RGB,mo.None)]="U8_RGB",a[a.U8_RGB_NORM=Qo(oi.U8,Bi.RGB,mo.Normalized)]="U8_RGB_NORM",a[a.U8_RGB_SRGB=Qo(oi.U8,Bi.RGB,mo.sRGB|mo.Normalized)]="U8_RGB_SRGB",a[a.U8_RGBA=Qo(oi.U8,Bi.RGBA,mo.None)]="U8_RGBA",a[a.U8_RGBA_NORM=Qo(oi.U8,Bi.RGBA,mo.Normalized)]="U8_RGBA_NORM",a[a.U8_RGBA_SRGB=Qo(oi.U8,Bi.RGBA,mo.sRGB|mo.Normalized)]="U8_RGBA_SRGB",a[a.U16_R=Qo(oi.U16,Bi.R,mo.None)]="U16_R",a[a.U16_R_NORM=Qo(oi.U16,Bi.R,mo.Normalized)]="U16_R_NORM",a[a.U16_RG_NORM=Qo(oi.U16,Bi.RG,mo.Normalized)]="U16_RG_NORM",a[a.U16_RGBA_NORM=Qo(oi.U16,Bi.RGBA,mo.Normalized)]="U16_RGBA_NORM",a[a.U16_RGBA=Qo(oi.U16,Bi.RGBA,mo.None)]="U16_RGBA",a[a.U16_RGB=Qo(oi.U16,Bi.RGB,mo.None)]="U16_RGB",a[a.U16_RG=Qo(oi.U16,Bi.RG,mo.None)]="U16_RG",a[a.U32_R=Qo(oi.U32,Bi.R,mo.None)]="U32_R",a[a.U32_RG=Qo(oi.U32,Bi.RG,mo.None)]="U32_RG",a[a.U32_RGB=Qo(oi.U32,Bi.RGB,mo.None)]="U32_RGB",a[a.U32_RGBA=Qo(oi.U32,Bi.RGBA,mo.None)]="U32_RGBA",a[a.S8_R=Qo(oi.S8,Bi.R,mo.None)]="S8_R",a[a.S8_R_NORM=Qo(oi.S8,Bi.R,mo.Normalized)]="S8_R_NORM",a[a.S8_RG_NORM=Qo(oi.S8,Bi.RG,mo.Normalized)]="S8_RG_NORM",a[a.S8_RGB_NORM=Qo(oi.S8,Bi.RGB,mo.Normalized)]="S8_RGB_NORM",a[a.S8_RGBA_NORM=Qo(oi.S8,Bi.RGBA,mo.Normalized)]="S8_RGBA_NORM",a[a.S16_R=Qo(oi.S16,Bi.R,mo.None)]="S16_R",a[a.S16_RG=Qo(oi.S16,Bi.RG,mo.None)]="S16_RG",a[a.S16_RG_NORM=Qo(oi.S16,Bi.RG,mo.Normalized)]="S16_RG_NORM",a[a.S16_RGB_NORM=Qo(oi.S16,Bi.RGB,mo.Normalized)]="S16_RGB_NORM",a[a.S16_RGBA=Qo(oi.S16,Bi.RGBA,mo.None)]="S16_RGBA",a[a.S16_RGBA_NORM=Qo(oi.S16,Bi.RGBA,mo.Normalized)]="S16_RGBA_NORM",a[a.S32_R=Qo(oi.S32,Bi.R,mo.None)]="S32_R",a[a.S32_RG=Qo(oi.S32,Bi.RG,mo.None)]="S32_RG",a[a.S32_RGB=Qo(oi.S32,Bi.RGB,mo.None)]="S32_RGB",a[a.S32_RGBA=Qo(oi.S32,Bi.RGBA,mo.None)]="S32_RGBA",a[a.U16_RGBA_5551=Qo(oi.U16_PACKED_5551,Bi.RGBA,mo.Normalized)]="U16_RGBA_5551",a[a.U16_RGB_565=Qo(oi.U16_PACKED_565,Bi.RGB,mo.Normalized)]="U16_RGB_565",a[a.BC1=Qo(oi.BC1,Bi.RGBA,mo.Normalized)]="BC1",a[a.BC1_SRGB=Qo(oi.BC1,Bi.RGBA,mo.Normalized|mo.sRGB)]="BC1_SRGB",a[a.BC2=Qo(oi.BC2,Bi.RGBA,mo.Normalized)]="BC2",a[a.BC2_SRGB=Qo(oi.BC2,Bi.RGBA,mo.Normalized|mo.sRGB)]="BC2_SRGB",a[a.BC3=Qo(oi.BC3,Bi.RGBA,mo.Normalized)]="BC3",a[a.BC3_SRGB=Qo(oi.BC3,Bi.RGBA,mo.Normalized|mo.sRGB)]="BC3_SRGB",a[a.BC4_UNORM=Qo(oi.BC4_UNORM,Bi.R,mo.Normalized)]="BC4_UNORM",a[a.BC4_SNORM=Qo(oi.BC4_SNORM,Bi.R,mo.Normalized)]="BC4_SNORM",a[a.BC5_UNORM=Qo(oi.BC5_UNORM,Bi.RG,mo.Normalized)]="BC5_UNORM",a[a.BC5_SNORM=Qo(oi.BC5_SNORM,Bi.RG,mo.Normalized)]="BC5_SNORM",a[a.D24=Qo(oi.D24,Bi.R,mo.Depth)]="D24",a[a.D24_S8=Qo(oi.D24S8,Bi.RG,mo.Depth|mo.Stencil)]="D24_S8",a[a.D32F=Qo(oi.D32F,Bi.R,mo.Depth)]="D32F",a[a.D32F_S8=Qo(oi.D32FS8,Bi.RG,mo.Depth|mo.Stencil)]="D32F_S8",a[a.U8_RGB_RT=Qo(oi.U8,Bi.RGB,mo.RenderTarget|mo.Normalized)]="U8_RGB_RT",a[a.U8_RGBA_RT=Qo(oi.U8,Bi.RGBA,mo.RenderTarget|mo.Normalized)]="U8_RGBA_RT",a[a.U8_RGBA_RT_SRGB=Qo(oi.U8,Bi.RGBA,mo.RenderTarget|mo.Normalized|mo.sRGB)]="U8_RGBA_RT_SRGB"})(or||(or={}));function n_(a){return a>>>8&255}function fh(a){return a>>>16&255}function Nm(a){return a&255}function jb(a){switch(a){case oi.F32:case oi.U32:case oi.S32:return 4;case oi.U16:case oi.S16:case oi.F16:return 2;case oi.U8:case oi.S8:return 1;default:throw new Error("whoops")}}function Vb(a){return jb(fh(a))}function wk(a){return n_(a)}function Hb(a){var o=jb(fh(a)),f=n_(a);return o*f}function IA(a,o){return a&4294967040|o}function Zb(a,o){return a&4294902015|o<<8}function r_(a){var o=Nm(a);if(o&mo.Depth)return Oc.Depth;if(o&mo.Normalized)return Oc.Float;var f=fh(a);if(f===oi.F16||f===oi.F32)return Oc.Float;if(f===oi.U8||f===oi.U16||f===oi.U32)return Oc.Uint;if(f===oi.S8||f===oi.S16||f===oi.S32)return Oc.Sint;throw new Error("whoops")}function Ia(a,o){if(o===void 0&&(o=""),!a)throw new Error("Assert fail: ".concat(o))}function Cv(a){if(a!=null)return a;throw new Error("Missing object")}function PE(a,o){return a.r===o.r&&a.g===o.g&&a.b===o.b&&a.a===o.a}function Fy(a,o){a.r=o.r,a.g=o.g,a.b=o.b,a.a=o.a}function Wb(a){var o=a.r,f=a.g,v=a.b,T=a.a;return{r:o,g:f,b:v,a:T}}function xg(a,o,f,v){return v===void 0&&(v=1),{r:a,g:o,b:f,a:v}}var ky=xg(0,0,0,0),LA=xg(0,0,0,1),DA=xg(1,1,1,0),vP=xg(1,1,1,1),Eg=!0;function gP(a,o){o===void 0&&(o=Eg),o&&(a[10]=-a[10],a[14]=-a[14])}function NA(a,o){o===void 0&&(o=Eg),o&&(a[10]=-a[10],a[14]=-a[14]+1)}function BA(a,o){if(o===void 0&&(o=Eg),o)switch(a){case Ya.LESS:return Ya.GREATER;case Ya.LEQUAL:return Ya.GEQUAL;case Ya.GEQUAL:return Ya.LEQUAL;case Ya.GREATER:return Ya.LESS;default:return a}else return a}function yP(a,o){return o===void 0&&(o=Eg),o?1-a:a}function _P(a,o){return o===void 0&&(o=Eg),o?-a:a}function bP(a,o,f,v){if(v===void 0&&(v=Eg),f=BA(f,v),f===Ya.LESS)return a<o;if(f===Ya.LEQUAL)return a<=o;if(f===Ya.GREATER)return a>o;if(f===Ya.GEQUAL)return a>=o;throw new Error("whoops")}function zy(a){return!!(a&&!(a&a-1))}function Bm(a,o){return a!=null?a:o}function FA(a){return a===void 0?null:a}function xP(a,o,f){a.length=o,a.fill(f)}function qu(a,o){var f=o-1;return a+f&~f}function EP(a,o){return((a+o-1)/o|0)*o}function kA(a,o,f){for(var v=0,T=a.length;v<T;){var O=v+(T-v>>>1),L=f(o,a[O]);L<0?T=O:v=O+1}return v}function Gb(a,o,f){var v=kA(a,o,f);a.splice(v,0,o)}function IE(a,o,f){return f?a|=o:a&=~o,a}function SP(a,o){for(var f=new Array(a),v=0;v<a;v++)f[v]=o();return f}function zA(a,o){o===void 0&&(o=1);var f=a.split(`
`);return f.map(function(v,T){return"".concat(LE(""+(o+T),4," "),"  ").concat(v)}).join(`
`)}function LE(a,o,f){for(f===void 0&&(f="0");a.length<o;)a="".concat(f).concat(a);return a}function UA(a,o){for(var f=[],v=a;v<a+o;v++)f.push(v);return f}function Xb(a,o){a.blendDstFactor=o.blendDstFactor,a.blendSrcFactor=o.blendSrcFactor,a.blendMode=o.blendMode}function Sg(a,o){return a===void 0&&(a={}),a.compare=o.compare,a.depthFailOp=o.depthFailOp,a.passOp=o.passOp,a.failOp=o.failOp,a.mask=o.mask,a}function DE(a,o){return a===void 0&&(a={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),Xb(a.rgbBlendState,o.rgbBlendState),Xb(a.alphaBlendState,o.alphaBlendState),a.channelWriteMask=o.channelWriteMask,a}function Yb(a,o){a.length!==o.length&&(a.length=o.length);for(var f=0;f<o.length;f++)a[f]=DE(a[f],o[f])}function NE(a,o){o.attachmentsState!==void 0&&Yb(a.attachmentsState,o.attachmentsState),a.blendConstant&&o.blendConstant&&Fy(a.blendConstant,o.blendConstant),a.depthCompare=Bm(o.depthCompare,a.depthCompare),a.depthWrite=Bm(o.depthWrite,a.depthWrite),a.stencilWrite=Bm(o.stencilWrite,a.stencilWrite),a.stencilFront&&o.stencilFront&&Sg(a.stencilFront,o.stencilFront),a.stencilBack&&o.stencilBack&&Sg(a.stencilBack,o.stencilBack),a.cullMode=Bm(o.cullMode,a.cullMode),a.frontFace=Bm(o.frontFace,a.frontFace),a.polygonOffset=Bm(o.polygonOffset,a.polygonOffset),a.polygonOffsetFactor=Bm(o.polygonOffsetFactor,a.polygonOffsetFactor),a.polygonOffsetUnits=Bm(o.polygonOffsetUnits,a.polygonOffsetUnits)}function Ov(a){var o=Object.assign({},a);return o.attachmentsState=[],Yb(o.attachmentsState,a.attachmentsState),o.blendConstant=o.blendConstant&&Wb(o.blendConstant),o.stencilFront=Sg(void 0,a.stencilFront),o.stencilBack=Sg(void 0,a.stencilBack),o}function jf(a,o){o.channelWriteMask!==void 0&&(a.channelWriteMask=o.channelWriteMask),o.rgbBlendMode!==void 0&&(a.rgbBlendState.blendMode=o.rgbBlendMode),o.alphaBlendMode!==void 0&&(a.alphaBlendState.blendMode=o.alphaBlendMode),o.rgbBlendSrcFactor!==void 0&&(a.rgbBlendState.blendSrcFactor=o.rgbBlendSrcFactor),o.alphaBlendSrcFactor!==void 0&&(a.alphaBlendState.blendSrcFactor=o.alphaBlendSrcFactor),o.rgbBlendDstFactor!==void 0&&(a.rgbBlendState.blendDstFactor=o.rgbBlendDstFactor),o.alphaBlendDstFactor!==void 0&&(a.alphaBlendState.blendDstFactor=o.alphaBlendDstFactor)}var i_={blendMode:hf.ADD,blendSrcFactor:ls.ONE,blendDstFactor:ls.ZERO},x0={attachmentsState:[{channelWriteMask:Ku.ALL,rgbBlendState:i_,alphaBlendState:i_}],blendConstant:Wb(ky),depthWrite:!0,depthCompare:Ya.LEQUAL,stencilWrite:!1,stencilFront:{compare:Ya.ALWAYS,passOp:Cc.KEEP,depthFailOp:Cc.KEEP,failOp:Cc.KEEP},stencilBack:{compare:Ya.ALWAYS,passOp:Cc.KEEP,depthFailOp:Cc.KEEP,failOp:Cc.KEEP},cullMode:ld.NONE,frontFace:By.CCW,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0};function Uy(a,o){a===void 0&&(a=null),o===void 0&&(o=x0);var f=Ov(o);return a!==null&&NE(f,a),f}var o_=Uy({depthCompare:Ya.ALWAYS,depthWrite:!1},x0);function TP(a,o){return a.attachmentsState===void 0&&(a.attachmentsState=[],Yb(a.attachmentsState,x0.attachmentsState)),jf(a.attachmentsState[0],o),a}var BE={texture:null,sampler:null,formatKind:Oc.Float,dimension:rs.TEXTURE_2D};function Fm(a,o,f){if(a.length!==o.length)return!1;for(var v=0;v<a.length;v++)if(!f(a[v],o[v]))return!1;return!0}function Tg(a,o){for(var f=Array(a.length),v=0;v<a.length;v++)f[v]=o(a[v]);return f}function FE(a,o){return a.texture===o.texture&&a.binding===o.binding}function $b(a,o){return a.buffer===o.buffer&&a.size===o.size&&a.binding===o.binding&&a.offset===o.offset}function wP(a,o){return a===null?o===null:o===null?!1:a.sampler===o.sampler&&a.texture===o.texture&&a.dimension===o.dimension&&a.formatKind===o.formatKind&&a.comparison===o.comparison}function jA(a,o){return a.samplerBindings=a.samplerBindings||[],a.uniformBufferBindings=a.uniformBufferBindings||[],a.storageBufferBindings=a.storageBufferBindings||[],a.storageTextureBindings=a.storageTextureBindings||[],o.samplerBindings=o.samplerBindings||[],o.uniformBufferBindings=o.uniformBufferBindings||[],o.storageBufferBindings=o.storageBufferBindings||[],o.storageTextureBindings=o.storageTextureBindings||[],!(a.samplerBindings.length!==o.samplerBindings.length||!Fm(a.samplerBindings,o.samplerBindings,wP)||!Fm(a.uniformBufferBindings,o.uniformBufferBindings,$b)||!Fm(a.storageBufferBindings,o.storageBufferBindings,$b)||!Fm(a.storageTextureBindings,o.storageTextureBindings,FE))}function kE(a,o){return a.blendMode==o.blendMode&&a.blendSrcFactor===o.blendSrcFactor&&a.blendDstFactor===o.blendDstFactor}function a_(a,o){return!(!kE(a.rgbBlendState,o.rgbBlendState)||!kE(a.alphaBlendState,o.alphaBlendState)||a.channelWriteMask!==o.channelWriteMask)}function wg(a,o){return a.compare==o.compare&&a.depthFailOp===o.depthFailOp&&a.failOp===o.failOp&&a.passOp===o.passOp&&a.mask===o.mask}function VA(a,o){return!Fm(a.attachmentsState,o.attachmentsState,a_)||a.blendConstant&&o.blendConstant&&!PE(a.blendConstant,o.blendConstant)||a.stencilFront&&o.stencilFront&&!wg(a.stencilFront,o.stencilFront)||a.stencilBack&&o.stencilBack&&!wg(a.stencilBack,o.stencilBack)?!1:a.depthCompare===o.depthCompare&&a.depthWrite===o.depthWrite&&a.stencilWrite===o.stencilWrite&&a.cullMode===o.cullMode&&a.frontFace===o.frontFace&&a.polygonOffset===o.polygonOffset&&a.polygonOffsetFactor===o.polygonOffsetFactor&&a.polygonOffsetUnits===o.polygonOffsetUnits}function HA(a,o){return a.id===o.id}function zE(a,o){return a===o}function AP(a,o){return!(a.topology!==o.topology||a.inputLayout!==o.inputLayout||a.sampleCount!==o.sampleCount||a.megaStateDescriptor&&o.megaStateDescriptor&&!VA(a.megaStateDescriptor,o.megaStateDescriptor)||!HA(a.program,o.program)||!Fm(a.colorAttachmentFormats,o.colorAttachmentFormats,zE)||a.depthStencilAttachmentFormat!==o.depthStencilAttachmentFormat)}function ZA(a,o){return a.offset===o.offset&&a.shaderLocation===o.shaderLocation&&a.format===o.format&&a.divisor===o.divisor}function CP(a,o){return(0,Cf.Z)(a)?(0,Cf.Z)(o):(0,Cf.Z)(o)?!1:a.arrayStride===o.arrayStride&&a.stepMode===o.stepMode&&Fm(a.attributes,o.attributes,ZA)}function WA(a,o){return!(a.indexBufferFormat!==o.indexBufferFormat||!Fm(a.vertexBufferDescriptors,o.vertexBufferDescriptors,CP)||!HA(a.program,o.program))}function OP(a,o){return a.addressModeU===o.addressModeU&&a.addressModeV===o.addressModeV&&a.minFilter===o.minFilter&&a.magFilter===o.magFilter&&a.mipmapFilter===o.mipmapFilter&&a.lodMinClamp===o.lodMinClamp&&a.lodMaxClamp===o.lodMaxClamp&&a.maxAnisotropy===o.maxAnisotropy&&a.compareFunction===o.compareFunction}function GA(a){var o=a.sampler,f=a.texture,v=a.dimension,T=a.formatKind,O=a.comparison;return{sampler:o,texture:f,dimension:v,formatKind:T,comparison:O}}function UE(a){var o=a.buffer,f=a.size,v=a.binding,T=a.offset;return{binding:v,buffer:o,offset:T,size:f}}function XA(a){var o=a.binding,f=a.texture;return{binding:o,texture:f}}function YA(a){var o=a.samplerBindings&&Tg(a.samplerBindings,GA),f=a.uniformBufferBindings&&Tg(a.uniformBufferBindings,UE),v=a.storageBufferBindings&&Tg(a.storageBufferBindings,UE),T=a.storageTextureBindings&&Tg(a.storageTextureBindings,XA);return{samplerBindings:o,uniformBufferBindings:f,storageBufferBindings:v,storageTextureBindings:T,pipeline:a.pipeline}}function $A(a){var o=a.inputLayout,f=a.program,v=a.topology,T=a.megaStateDescriptor&&Ov(a.megaStateDescriptor),O=a.colorAttachmentFormats.slice(),L=a.depthStencilAttachmentFormat,F=a.sampleCount;return{inputLayout:o,megaStateDescriptor:T,program:f,topology:v,colorAttachmentFormats:O,depthStencilAttachmentFormat:L,sampleCount:F}}function KA(a){var o=a.shaderLocation,f=a.format,v=a.offset,T=a.divisor;return{shaderLocation:o,format:f,offset:v,divisor:T}}function qA(a){if((0,Cf.Z)(a))return a;var o=a.arrayStride,f=a.stepMode,v=Tg(a.attributes,KA);return{arrayStride:o,stepMode:f,attributes:v}}function QA(a){var o=Tg(a.vertexBufferDescriptors,qA),f=a.indexBufferFormat,v=a.program;return{vertexBufferDescriptors:o,indexBufferFormat:f,program:v}}var Ts,jE=/([^[]*)(\[[0-9]+\])?/;function Kb(a){if(a[a.length-1]!=="]")return{name:a,length:1,isArray:!1};var o=a.match(jE);if(!o||o.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(a));return{name:o[1],length:Number(o[2])||1,isArray:!!o[2]}}function Lh(){var a=null;return function(o,f,v){var T=a!==v;return T&&(o.uniform1i(f,v),a=v),T}}function Rc(a,o,f,v){var T=null,O=null;return function(L,F,H){var ie=o(H,f),ge=ie.length,Te=!1;if(T===null)T=new Float32Array(ge),O=ge,Te=!0;else{Ia(O===ge,"Uniform length cannot change.");for(var Ve=0;Ve<ge;++Ve)if(ie[Ve]!==T[Ve]){Te=!0;break}}return Te&&(v(L,a,F,ie),T.set(ie)),Te}}function Vf(a,o,f,v){a[o](f,v)}function K0(a,o,f,v){a[o](f,!1,v)}var VE={},JA={},HE={},qb=[0];function s_(a,o,f,v){o===1&&typeof a=="boolean"&&(a=a?1:0),Number.isFinite(a)&&(qb[0]=a,a=qb);var T=a.length;if(a instanceof f)return a;var O=v[T];O||(O=new f(T),v[T]=O);for(var L=0;L<T;L++)O[L]=a[L];return O}function Rd(a,o){return s_(a,o,Float32Array,VE)}function q0(a,o){return s_(a,o,Int32Array,JA)}function l_(a,o){return s_(a,o,Uint32Array,HE)}var eC=(Ts={},Ts[Tn.FLOAT]=Rc.bind(null,"uniform1fv",Rd,1,Vf),Ts[Tn.FLOAT_VEC2]=Rc.bind(null,"uniform2fv",Rd,2,Vf),Ts[Tn.FLOAT_VEC3]=Rc.bind(null,"uniform3fv",Rd,3,Vf),Ts[Tn.FLOAT_VEC4]=Rc.bind(null,"uniform4fv",Rd,4,Vf),Ts[Tn.INT]=Rc.bind(null,"uniform1iv",q0,1,Vf),Ts[Tn.INT_VEC2]=Rc.bind(null,"uniform2iv",q0,2,Vf),Ts[Tn.INT_VEC3]=Rc.bind(null,"uniform3iv",q0,3,Vf),Ts[Tn.INT_VEC4]=Rc.bind(null,"uniform4iv",q0,4,Vf),Ts[Tn.BOOL]=Rc.bind(null,"uniform1iv",q0,1,Vf),Ts[Tn.BOOL_VEC2]=Rc.bind(null,"uniform2iv",q0,2,Vf),Ts[Tn.BOOL_VEC3]=Rc.bind(null,"uniform3iv",q0,3,Vf),Ts[Tn.BOOL_VEC4]=Rc.bind(null,"uniform4iv",q0,4,Vf),Ts[Tn.FLOAT_MAT2]=Rc.bind(null,"uniformMatrix2fv",Rd,4,K0),Ts[Tn.FLOAT_MAT3]=Rc.bind(null,"uniformMatrix3fv",Rd,9,K0),Ts[Tn.FLOAT_MAT4]=Rc.bind(null,"uniformMatrix4fv",Rd,16,K0),Ts[Tn.UNSIGNED_INT]=Rc.bind(null,"uniform1uiv",l_,1,Vf),Ts[Tn.UNSIGNED_INT_VEC2]=Rc.bind(null,"uniform2uiv",l_,2,Vf),Ts[Tn.UNSIGNED_INT_VEC3]=Rc.bind(null,"uniform3uiv",l_,3,Vf),Ts[Tn.UNSIGNED_INT_VEC4]=Rc.bind(null,"uniform4uiv",l_,4,Vf),Ts[Tn.FLOAT_MAT2x3]=Rc.bind(null,"uniformMatrix2x3fv",Rd,6,K0),Ts[Tn.FLOAT_MAT2x4]=Rc.bind(null,"uniformMatrix2x4fv",Rd,8,K0),Ts[Tn.FLOAT_MAT3x2]=Rc.bind(null,"uniformMatrix3x2fv",Rd,6,K0),Ts[Tn.FLOAT_MAT3x4]=Rc.bind(null,"uniformMatrix3x4fv",Rd,12,K0),Ts[Tn.FLOAT_MAT4x2]=Rc.bind(null,"uniformMatrix4x2fv",Rd,8,K0),Ts[Tn.FLOAT_MAT4x3]=Rc.bind(null,"uniformMatrix4x3fv",Rd,12,K0),Ts[Tn.SAMPLER_2D]=Lh,Ts[Tn.SAMPLER_CUBE]=Lh,Ts[Tn.SAMPLER_3D]=Lh,Ts[Tn.SAMPLER_2D_SHADOW]=Lh,Ts[Tn.SAMPLER_2D_ARRAY]=Lh,Ts[Tn.SAMPLER_2D_ARRAY_SHADOW]=Lh,Ts[Tn.SAMPLER_CUBE_SHADOW]=Lh,Ts[Tn.INT_SAMPLER_2D]=Lh,Ts[Tn.INT_SAMPLER_3D]=Lh,Ts[Tn.INT_SAMPLER_CUBE]=Lh,Ts[Tn.INT_SAMPLER_2D_ARRAY]=Lh,Ts[Tn.UNSIGNED_INT_SAMPLER_2D]=Lh,Ts[Tn.UNSIGNED_INT_SAMPLER_3D]=Lh,Ts[Tn.UNSIGNED_INT_SAMPLER_CUBE]=Lh,Ts[Tn.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Lh,Ts);function ZE(a,o,f){var v=eC[f.type];if(!v)throw new Error("Unknown GLSL uniform type ".concat(f.type));return v().bind(null,a,o)}var tC={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function WE(a){return Object.prototype.toString.call(a)in tC}function jy(a,o){return"#define ".concat(a," ").concat(o)}function yc(a){var o={};return a.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(f,v,T){var O=Number(T);return o[v]=isNaN(O)?T:O,""}),o}function RP(a,o){var f=[];return a.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(v,T,O){var L=Number(T);return f.push({location:isNaN(L)?o[T]:L,name:O}),""}),f}function nC(a){var o=[],f=[];return a.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(v,T,O){var L=[];return O.trim().replace(`\r
`,`
`).split(`
`).forEach(function(F){var H=__read(F.trim().split(/\s+/),2),ie=H[0],ge=H[1];L.push({type:ie.trim(),name:ge.replace(";","").trim()})}),f.push({type:T.trim(),uniforms:L}),""}),a.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,function(v,T){return T.trim().replace(`\r
`,`
`).split(`
`).forEach(function(O){var L=O.trim().split(" "),F=L[0]||"",H=L[1]||"",ie=H.indexOf("[")>-1;if(H=H.replace(";","").replace("[","").trim(),!F.startsWith("#")){if(F){var ge=f.find(function(Mt){return F===Mt.type});if(ge)if(ie)for(var Te=function(Mt){ge.uniforms.forEach(function(rn){o.push("".concat(H,"[").concat(Mt,"].").concat(rn.name))})},Ve=0;Ve<5;Ve++)Te(Ve);else ge.uniforms.forEach(function(Mt){o.push("".concat(H,".").concat(Mt.name))})}H&&o.push(H)}}),""}),o}function Vy(a){if(a===void 0)return null;var o=/binding\s*=\s*(\d+)/.exec(a);if(o!==null){var f=parseInt(o[1],10);if(!Number.isNaN(f))return f}return null}function GE(a){var o="",f=a;return[f,o]}function km(a,o,f,v,T){var O;v===void 0&&(v=null),T===void 0&&(T=!0);var L=a.glslVersion==="#version 100",F=o==="frag"&&((O=f.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||O===void 0?void 0:O.length)>1,H=f.replace(`\r
`,`
`).split(`
`).map(function(Ji){return Ji.replace(/[/][/].*$/,"")}).filter(function(Ji){var Hr=!Ji||/^\s+$/.test(Ji);return!Hr}),ie="";v!==null&&(ie=Object.keys(v).map(function(Ji){return jy(Ji,v[Ji])}).join(`
`));var ge=H.find(function(Ji){return Ji.startsWith("precision")})||"precision mediump float;",Te=T?H.filter(function(Ji){return!Ji.startsWith("precision")}).join(`
`):H.join(`
`),Ve="";if(a.viewportOrigin===Vp.UPPER_LEFT&&(Ve+="".concat(jy("VIEWPORT_ORIGIN_TL","1"),`
`)),a.clipSpaceNearZ===bg.ZERO&&(Ve+="".concat(jy("CLIPSPACE_NEAR_ZERO","1"),`
`)),a.explicitBindingLocations){var Mt=0,rn=0,Rn=0;Te=Te.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(Ji,Hr,Gi,ja){var ys=Gi?"".concat(Gi,", "):"";return"layout(".concat(ys,"set = ").concat(Mt,", binding = ").concat(rn++,") uniform ").concat(ja)}),Mt++,rn=0,Ia(a.separateSamplerTextures),Te=Te.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(Ji,Hr,Gi,ja,ys){var $o=Vy(Gi);$o===null&&($o=rn++);var cs=(0,_o.CR)(GE(ja),2),Zs=cs[0],Dh=cs[1];return o==="frag"?`
layout(set = `.concat(Mt,", binding = ").concat($o*2+0,") uniform texture").concat(Zs," T_").concat(ys,`;
layout(set = `).concat(Mt,", binding = ").concat($o*2+1,") uniform sampler").concat(Dh," S_").concat(ys,";").trim():""}),Te=Te.replace(o==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(Ji,Hr){return"layout(location = ".concat(Rn++,") ").concat(Hr)}),Ve+="".concat(jy("gl_VertexID","gl_VertexIndex"),`
`),Ve+="".concat(jy("gl_InstanceID","gl_InstanceIndex"),`
`),ge=ge.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var hr=0;Te=Te.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(Ji,Hr,Gi,ja,ys){var $o=Vy(Gi);return $o===null&&($o=hr++),"uniform sampler".concat(ja," ").concat(ys,"; // BINDING=").concat($o)})}if(Te=Te.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return"SAMPLER_".concat(Hr,"(P_").concat(Gi,")")}),Te=Te.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return"PP_SAMPLER_".concat(Hr,"(P_").concat(Gi,")")}),Te=Te.replace(/\bPU_TEXTURE\((.*?)\)/g,function(Ji,Hr){return"TEXTURE(P_".concat(Hr,")")}),a.separateSamplerTextures)Te=Te.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){var ja=(0,_o.CR)(GE(Hr),2),ys=ja[0],$o=ja[1];return"texture".concat(ys," T_P_").concat(Gi,", sampler").concat($o," S_P_").concat(Gi)}),Te=Te.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return"T_".concat(Gi,", S_").concat(Gi)}),Te=Te.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return"sampler".concat(Hr,"(T_").concat(Gi,", S_").concat(Gi,")")}),Te=Te.replace(/\bTEXTURE\((.*?)\)/g,function(Ji,Hr){return"T_".concat(Hr)});else{var Nr=[];Te=Te.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return"sampler".concat(Hr," P_").concat(Gi)}),Te=Te.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return Gi}),Te=Te.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(Ji,Hr,Gi){return Nr.push([Gi,Hr]),Gi}),L&&Nr.forEach(function(Ji){var Hr=(0,_o.CR)(Ji,2),Gi=Hr[0],ja=Hr[1];Te=Te.replace(new RegExp("texture\\(".concat(Gi),"g"),function(){return"texture".concat(ja,"(").concat(Gi)})}),Te=Te.replace(/\bTEXTURE\((.*?)\)/g,function(Ji,Hr){return Hr})}var jn="".concat(L?"":a.glslVersion,`
`).concat(L&&F?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(L&&o==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(T?ge:"",`
`).concat(Ve||"").concat(ie?ie+`
`:"",`
`).concat(Te,`
`).trim();if(a.explicitBindingLocations&&o==="frag"&&(jn=jn.replace(/^\b(out)\b/g,function(Ji,Hr){return"layout(location = 0) ".concat(Hr)})),L){if(o==="frag"&&(jn=jn.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(Ji,Hr,Gi){return"varying ".concat(Hr," ").concat(Gi,`;
`)})),o==="vert"&&(jn=jn.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(Ji,Hr,Gi){return"varying ".concat(Hr," ").concat(Gi,`;
`)}),jn=jn.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(Ji,Hr,Gi){return"attribute ".concat(Hr," ").concat(Gi,`;
`)})),jn=jn.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(Ji,Hr){return Hr.trim().replace(/^.*$/gm,function(Gi){var ja=Gi.trim();return ja.startsWith("#")?ja:Gi?"uniform ".concat(ja):""})}),o==="frag")if(F){var ci=[];jn=jn.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(Ji,Hr){return ci.push(Hr),"vec4 ".concat(Hr,`;
`)});var ji=jn.lastIndexOf("}");jn=jn.substring(0,ji)+`
    `.concat(ci.map(function(Ji,Hr){return"gl_FragData[".concat(Hr,"] = ").concat(Ji,`;
    `)}).join(`
`))+jn.substring(ji)}else{var To;if(jn=jn.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(Ji,Hr,Gi){return To=Gi,"".concat(Hr," ").concat(Gi,`;
`)}),To){var ji=jn.lastIndexOf("}");jn=jn.substring(0,ji)+`
  gl_FragColor = vec4(`.concat(To,`);
`)+jn.substring(ji)}}jn=jn.replace(/^\s*layout\((.*)\)/gm,"")}return jn}function MP(a,o,f,v){v===void 0&&(v=null);var T=km(a,"vert",o,v),O=km(a,"frag",f,v);return{vert:o,frag:f,preprocessedVert:T,preprocessedFrag:O}}var Md=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this)||this;return O.id=v,O.device=T,O.device.resourceCreationTracker!==null&&O.device.resourceCreationTracker.trackResourceCreated(O),O}return o.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},o}(OE),rC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.Bindings;var F=O.uniformBufferBindings,H=O.samplerBindings;return L.uniformBufferBindings=F||[],L.samplerBindings=H||[],L.bindingLayouts=L.createBindingLayouts(),L}return o.prototype.createBindingLayouts=function(){var f=0,v=0,T=[],O=this.uniformBufferBindings.length,L=this.samplerBindings.length;return T.push({firstUniformBuffer:f,numUniformBuffers:O,firstSampler:v,numSamplers:L}),f+=O,v+=L,{numUniformBuffers:f,numSamplers:v,bindingLayoutTables:T}},o}(Md);function Uo(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}function Qb(a){var o=fh(a);switch(o){case oi.BC1:case oi.BC2:case oi.BC3:case oi.BC4_UNORM:case oi.BC4_SNORM:case oi.BC5_UNORM:case oi.BC5_SNORM:return!0;default:return!1}}function XE(a){var o=Nm(a);if(o&mo.Normalized)return!1;var f=fh(a);return f===oi.S8||f===oi.S16||f===oi.S32||f===oi.U8||f===oi.U16||f===oi.U32}function YE(a){switch(a){case cd.STATIC:return Tn.STATIC_DRAW;case cd.DYNAMIC:return Tn.DYNAMIC_DRAW}}function c_(a){if(a&Ss.INDEX)return Tn.ELEMENT_ARRAY_BUFFER;if(a&Ss.VERTEX)return Tn.ARRAY_BUFFER;if(a&Ss.UNIFORM)return Tn.UNIFORM_BUFFER}function Rv(a){switch(a){case Pl.TRIANGLES:return Tn.TRIANGLES;case Pl.POINTS:return Tn.POINTS;case Pl.TRIANGLE_STRIP:return Tn.TRIANGLE_STRIP;case Pl.LINES:return Tn.LINES;case Pl.LINE_STRIP:return Tn.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function Hy(a){switch(a){case oi.U8:return Tn.UNSIGNED_BYTE;case oi.U16:return Tn.UNSIGNED_SHORT;case oi.U32:return Tn.UNSIGNED_INT;case oi.S8:return Tn.BYTE;case oi.S16:return Tn.SHORT;case oi.S32:return Tn.INT;case oi.F16:return Tn.HALF_FLOAT;case oi.F32:return Tn.FLOAT;default:throw new Error("whoops")}}function u_(a){switch(a){case Bi.R:return 1;case Bi.RG:return 2;case Bi.RGB:return 3;case Bi.RGBA:return 4;default:return 1}}function Ag(a){var o=fh(a),f=n_(a),v=Nm(a),T=Hy(o),O=u_(f),L=!!(v&mo.Normalized);return{size:O,type:T,normalized:L}}function Jb(a){switch(a){case or.U8_R:return Tn.UNSIGNED_BYTE;case or.U16_R:return Tn.UNSIGNED_SHORT;case or.U32_R:return Tn.UNSIGNED_INT;default:throw new Error("whoops")}}function Zy(a){switch(a){case Of.CLAMP_TO_EDGE:return Tn.CLAMP_TO_EDGE;case Of.REPEAT:return Tn.REPEAT;case Of.MIRRORED_REPEAT:return Tn.MIRRORED_REPEAT;default:throw new Error("whoops")}}function f_(a,o){if(o===Hl.LINEAR&&a===sa.BILINEAR)return Tn.LINEAR_MIPMAP_LINEAR;if(o===Hl.LINEAR&&a===sa.POINT)return Tn.NEAREST_MIPMAP_LINEAR;if(o===Hl.NEAREST&&a===sa.BILINEAR)return Tn.LINEAR_MIPMAP_NEAREST;if(o===Hl.NEAREST&&a===sa.POINT)return Tn.NEAREST_MIPMAP_NEAREST;if(o===Hl.NO_MIP&&a===sa.BILINEAR)return Tn.LINEAR;if(o===Hl.NO_MIP&&a===sa.POINT)return Tn.NEAREST;throw new Error("Unknown texture filter mode")}function zm(a,o){o===void 0&&(o=0);var f=a;return f.gl_buffer_pages[o/f.pageByteSize|0]}function Cg(a){var o=a;return o.gl_texture}function h_(a){var o=a;return o.gl_sampler}function E0(a,o){a.name=o,a.__SPECTOR_Metadata={name:o}}function $E(a,o){for(var f=[];;){var v=o.exec(a);if(!v)break;f.push(v)}return f}function up(a){return a.blendMode==hf.ADD&&a.blendSrcFactor==ls.ONE&&a.blendDstFactor===ls.ZERO}function iC(a){switch(a){case t_.OcclusionConservative:return Tn.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function oC(a){if(a===rs.TEXTURE_2D)return Tn.TEXTURE_2D;if(a===rs.TEXTURE_2D_ARRAY)return Tn.TEXTURE_2D_ARRAY;if(a===rs.TEXTURE_CUBE_MAP)return Tn.TEXTURE_CUBE_MAP;if(a===rs.TEXTURE_3D)return Tn.TEXTURE_3D;throw new Error("whoops")}function ex(a,o,f,v){return!(a%f!==0||o%v!==0)}var d_=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.Buffer;var F=O.viewOrSize,H=O.usage,ie=O.hint,ge=ie===void 0?cd.STATIC:ie,Te=T.uniformBufferMaxPageByteSize,Ve=T.gl,Mt=H&Ss.UNIFORM;Mt||(Uo(Ve)?Ve.bindVertexArray(null):T.OES_vertex_array_object.bindVertexArrayOES(null));var rn=(0,cp.Z)(F)?qu(F,4):qu(F.byteLength,4);L.gl_buffer_pages=[];var Rn;if(Mt){for(var hr=rn;hr>0;)L.gl_buffer_pages.push(L.createBufferPage(Math.min(hr,Te),H,ge)),hr-=Te;Rn=Te}else L.gl_buffer_pages.push(L.createBufferPage(rn,H,ge)),Rn=rn;return L.pageByteSize=Rn,L.byteSize=rn,L.usage=H,L.gl_target=c_(H),(0,cp.Z)(F)||L.setSubData(0,new Uint8Array(F.buffer)),Mt||(Uo(Ve)?Ve.bindVertexArray(L.device.currentBoundVAO):T.OES_vertex_array_object.bindVertexArrayOES(L.device.currentBoundVAO)),L}return o.prototype.setSubData=function(f,v,T,O){T===void 0&&(T=0),O===void 0&&(O=v.byteLength-T);for(var L=this.device.gl,F=this.pageByteSize,H=f+O,ie=f,ge=f%F;ie<H;){var Te=Uo(L)?L.COPY_WRITE_BUFFER:this.gl_target,Ve=zm(this,ie);if(Ve.ubo)return;L.bindBuffer(Te,Ve),Uo(L)?L.bufferSubData(Te,ge,v,T,Math.min(H-ie,F)):L.bufferSubData(Te,ge,v),ie+=F,ge=0,T+=F,this.device.debugGroupStatisticsBufferUpload()}},o.prototype.destroy=function(){a.prototype.destroy.call(this);for(var f=0;f<this.gl_buffer_pages.length;f++)this.gl_buffer_pages[f].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[f]);this.gl_buffer_pages=[]},o.prototype.createBufferPage=function(f,v,T){var O=this.device.gl,L=v&Ss.UNIFORM;if(!Uo(O)&&L)return{ubo:!0};var F=this.device.ensureResourceExists(O.createBuffer()),H=c_(v),ie=YE(T);return O.bindBuffer(H,F),O.bufferData(H,f,ie),F},o}(Md),tx=function(a){(0,_o.ZT)(o,a);function o(f){var v,T,O,L,F=f.id,H=f.device,ie=f.descriptor,ge,Te=a.call(this,{id:F,device:H})||this;Te.type=Ds.InputLayout;var Ve=ie.vertexBufferDescriptors,Mt=ie.indexBufferFormat,rn=ie.program;Ia(Mt===or.U16_R||Mt===or.U32_R||Mt===null);var Rn=Mt!==null?Jb(Mt):null,hr=Mt!==null?Vb(Mt):null,Nr=Te.device.gl,jn=Te.device.ensureResourceExists(Uo(Nr)?Nr.createVertexArray():H.OES_vertex_array_object.createVertexArrayOES());Uo(Nr)?Nr.bindVertexArray(jn):H.OES_vertex_array_object.bindVertexArrayOES(jn),Nr.bindBuffer(Nr.ARRAY_BUFFER,zm(Te.device.fallbackVertexBuffer));try{for(var ci=(0,_o.XA)(ie.vertexBufferDescriptors),ji=ci.next();!ji.done;ji=ci.next()){var To=ji.value,Ji=To.stepMode,Hr=To.attributes;try{for(var Gi=(O=void 0,(0,_o.XA)(Hr)),ja=Gi.next();!ja.done;ja=Gi.next()){var ys=ja.value,$o=ys.shaderLocation,cs=ys.format,Zs=ys.divisor,Dh=Zs===void 0?1:Zs,Id=Uo(Nr)?$o:(ge=rn.attributes[$o])===null||ge===void 0?void 0:ge.location,Nh=Ag(cs);if(ys.vertexFormat=Nh,!(0,Cf.Z)(Id)){XE(cs);var cl=Nh.size,J0=Nh.type,Wf=Nh.normalized;Nr.vertexAttribPointer(Id,cl,J0,Wf,0,0),Ji===Av.INSTANCE&&(Uo(Nr)?Nr.vertexAttribDivisor(Id,Dh):H.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(Id,Dh)),Nr.enableVertexAttribArray(Id)}}}catch(Lv){O={error:Lv}}finally{try{ja&&!ja.done&&(L=Gi.return)&&L.call(Gi)}finally{if(O)throw O.error}}}}catch(Lv){v={error:Lv}}finally{try{ji&&!ji.done&&(T=ci.return)&&T.call(ci)}finally{if(v)throw v.error}}return Uo(Nr)?Nr.bindVertexArray(null):H.OES_vertex_array_object.bindVertexArrayOES(null),Te.vertexBufferDescriptors=Ve,Te.vao=jn,Te.indexBufferFormat=Mt,Te.indexBufferType=Rn,Te.indexBufferCompByteSize=hr,Te.program=rn,Te}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Uo(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},o}(Md),Wy=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=f.fake,F=a.call(this,{id:v,device:T})||this;F.type=Ds.Texture,O=(0,_o.pi)({dimension:rs.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},O);var H=F.device.gl,ie,ge,Te=F.clampmipLevelCount(O);if(F.immutable=O.usage===hu.RENDER_TARGET,F.pixelStore=O.pixelStore,F.format=O.format,F.dimension=O.dimension,F.formatKind=r_(O.format),F.width=O.width,F.height=O.height,F.depthOrArrayLayers=O.depthOrArrayLayers,F.mipmaps=Te>=1,!L){ge=F.device.ensureResourceExists(H.createTexture());var Ve=F.device.translateTextureType(O.format),Mt=F.device.translateTextureInternalFormat(O.format);if(F.device.setActiveTexture(H.TEXTURE0),F.device.currentTextures[0]=null,F.preprocessImage(),O.dimension===rs.TEXTURE_2D){if(ie=Tn.TEXTURE_2D,H.bindTexture(ie,ge),F.immutable)if(Uo(H))H.texStorage2D(ie,Te,Mt,O.width,O.height);else{var rn=(Mt===Tn.DEPTH_COMPONENT||F.isNPOT(),0);(F.format===or.D32F||F.format===or.D24_S8)&&!Uo(H)&&!T.WEBGL_depth_texture||(H.texImage2D(ie,rn,Mt,O.width,O.height,0,Mt,Ve,null),F.mipmaps&&(F.mipmaps=!1,H.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_MIN_FILTER,Tn.LINEAR),H.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_WRAP_S,Tn.CLAMP_TO_EDGE),H.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_WRAP_T,Tn.CLAMP_TO_EDGE)))}Ia(O.depthOrArrayLayers===1)}else if(O.dimension===rs.TEXTURE_2D_ARRAY)ie=Tn.TEXTURE_2D_ARRAY,H.bindTexture(ie,ge),F.immutable&&Uo(H)&&H.texStorage3D(ie,Te,Mt,O.width,O.height,O.depthOrArrayLayers);else if(O.dimension===rs.TEXTURE_3D)ie=Tn.TEXTURE_3D,H.bindTexture(ie,ge),F.immutable&&Uo(H)&&H.texStorage3D(ie,Te,Mt,O.width,O.height,O.depthOrArrayLayers);else if(O.dimension===rs.TEXTURE_CUBE_MAP)ie=Tn.TEXTURE_CUBE_MAP,H.bindTexture(ie,ge),F.immutable&&Uo(H)&&H.texStorage2D(ie,Te,Mt,O.width,O.height),Ia(O.depthOrArrayLayers===6);else throw new Error("whoops")}return F.gl_texture=ge,F.gl_target=ie,F.mipLevelCount=Te,F}return o.prototype.setImageData=function(f,v){v===void 0&&(v=0);var T=this.device.gl;Qb(this.format);var O=this.gl_target===Tn.TEXTURE_3D||this.gl_target===Tn.TEXTURE_2D_ARRAY,L=this.gl_target===Tn.TEXTURE_CUBE_MAP,F=WE(f[0]);this.device.setActiveTexture(T.TEXTURE0),this.device.currentTextures[0]=null;var H=f[0],ie,ge;F?(ie=this.width,ge=this.height):(ie=H.width,ge=H.height,this.width=ie,this.height=ge),T.bindTexture(this.gl_target,this.gl_texture);var Te=this.device.translateTextureFormat(this.format),Ve=Uo(T)?this.device.translateInternalTextureFormat(this.format):Te,Mt=this.device.translateTextureType(this.format);this.preprocessImage();for(var rn=0;rn<this.depthOrArrayLayers;rn++){var Rn=f[rn],hr=this.gl_target;L&&(hr=Tn.TEXTURE_CUBE_MAP_POSITIVE_X+rn%6),this.immutable?T.texSubImage2D(hr,v,0,0,ie,ge,Te,Mt,Rn):Uo(T)?O?T.texImage3D(hr,v,Ve,ie,ge,this.depthOrArrayLayers,0,Te,Mt,Rn):T.texImage2D(hr,v,Ve,ie,ge,0,Te,Mt,Rn):F?T.texImage2D(hr,v,Te,ie,ge,0,Te,Mt,Rn):T.texImage2D(hr,v,Te,Te,Mt,Rn)}this.mipmaps&&this.generateMipmap(O)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.gl.deleteTexture(Cg(this))},o.prototype.clampmipLevelCount=function(f){if(f.dimension===rs.TEXTURE_2D_ARRAY&&f.depthOrArrayLayers>1){var v=fh(f.format);if(v===oi.BC1)for(var T=f.width,O=f.height,L=0;L<f.mipLevelCount;L++){if(T<=2||O<=2)return L-1;T=Math.max(T/2|0,1),O=Math.max(O/2|0,1)}}return f.mipLevelCount},o.prototype.preprocessImage=function(){var f=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&f.pixelStorei(Tn.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&f.pixelStorei(Tn.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&f.pixelStorei(Tn.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},o.prototype.generateMipmap=function(f){f===void 0&&(f=!1);var v=this.device.gl;return!Uo(v)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(v.bindTexture(this.gl_target,this.gl_texture),f?(v.texParameteri(this.gl_target,Tn.TEXTURE_BASE_LEVEL,0),v.texParameteri(this.gl_target,Tn.TEXTURE_MAX_LEVEL,Math.log2(this.width)),v.texParameteri(this.gl_target,Tn.TEXTURE_MIN_FILTER,Tn.LINEAR_MIPMAP_LINEAR),v.texParameteri(this.gl_target,Tn.TEXTURE_MAG_FILTER,Tn.LINEAR)):v.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_MIN_FILTER,Tn.NEAREST_MIPMAP_LINEAR),v.generateMipmap(this.gl_target),v.bindTexture(this.gl_target,null)),this)},o.prototype.isNPOT=function(){var f=this.device.gl;return Uo(f)?!1:!zy(this.width)||!zy(this.height)},o}(Md),nx=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.RenderTarget,L.gl_renderbuffer=null,L.texture=null;var F=L.device.gl,H=O.format,ie=O.width,ge=O.height,Te=O.sampleCount,Ve=Te===void 0?1:Te,Mt=O.texture,rn=!1;if((H===or.D32F||H===or.D24_S8)&&Mt&&!Uo(F)&&!T.WEBGL_depth_texture&&(Mt.destroy(),L.texture=null,rn=!0),!rn&&Mt)L.texture=Mt;else{L.gl_renderbuffer=L.device.ensureResourceExists(F.createRenderbuffer()),F.bindRenderbuffer(F.RENDERBUFFER,L.gl_renderbuffer);var Rn=L.device.translateTextureInternalFormat(H,!0);Uo(F)&&Ve>1?F.renderbufferStorageMultisample(Tn.RENDERBUFFER,Ve,Rn,ie,ge):F.renderbufferStorage(Tn.RENDERBUFFER,Rn,ie,ge)}return L.format=H,L.width=ie,L.height=ge,L.sampleCount=Ve,L}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},o}(Md),Hf;(function(a){a[a.NeedsCompile=0]="NeedsCompile",a[a.Compiling=1]="Compiling",a[a.NeedsBind=2]="NeedsBind",a[a.ReadyToUse=3]="ReadyToUse"})(Hf||(Hf={}));var KE=function(a){(0,_o.ZT)(o,a);function o(f,v){var T=f.id,O=f.device,L=f.descriptor,F=a.call(this,{id:T,device:O})||this;F.rawVertexGLSL=v,F.type=Ds.Program,F.uniformSetters={},F.attributes=[];var H=F.device.gl;return F.descriptor=L,F.gl_program=F.device.ensureResourceExists(H.createProgram()),F.gl_shader_vert=null,F.gl_shader_frag=null,F.compileState=Hf.NeedsCompile,F.tryCompileProgram(),F}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},o.prototype.tryCompileProgram=function(){Ia(this.compileState===Hf.NeedsCompile);var f=this.descriptor,v=f.vertex,T=f.fragment,O=this.device.gl;v!=null&&v.glsl&&(T!=null&&T.glsl)&&(this.gl_shader_vert=this.compileShader(v.postprocess?v.postprocess(v.glsl):v.glsl,O.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(T.postprocess?T.postprocess(T.glsl):T.glsl,O.FRAGMENT_SHADER),O.attachShader(this.gl_program,this.gl_shader_vert),O.attachShader(this.gl_program,this.gl_shader_frag),O.linkProgram(this.gl_program),this.compileState=Hf.Compiling,Uo(O)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},o.prototype.readAttributesFromLinkedProgram=function(){for(var f,v=this.device.gl,T=v.getProgramParameter(this.gl_program,v.ACTIVE_ATTRIBUTES),O=yc(this.descriptor.vertex.glsl),L=RP(this.rawVertexGLSL,O),F=function(ge){var Te=v.getActiveAttrib(H.gl_program,ge),Ve=Te.name,Mt=Te.type,rn=Te.size,Rn=v.getAttribLocation(H.gl_program,Ve),hr=(f=L.find(function(Nr){return Nr.name===Ve}))===null||f===void 0?void 0:f.location;Rn>=0&&!(0,Cf.Z)(hr)&&(H.attributes[hr]={name:Ve,location:Rn,type:Mt,size:rn})},H=this,ie=0;ie<T;ie++)F(ie)},o.prototype.readUniformLocationsFromLinkedProgram=function(){for(var f=this.device.gl,v=f.getProgramParameter(this.gl_program,f.ACTIVE_UNIFORMS),T=0;T<v;T++){var O=f.getActiveUniform(this.gl_program,T),L=Kb(O.name).name,F=f.getUniformLocation(this.gl_program,L);if(this.uniformSetters[L]=ZE(f,F,O),O&&O.size>1)for(var H=0;H<O.size;H++)F=f.getUniformLocation(this.gl_program,"".concat(L,"[").concat(H,"]")),this.uniformSetters["".concat(L,"[").concat(H,"]")]=ZE(f,F,O)}},o.prototype.compileShader=function(f,v){var T=this.device.gl,O=this.device.ensureResourceExists(T.createShader(v));return T.shaderSource(O,f),T.compileShader(O),O},o.prototype.setUniformsLegacy=function(f){f===void 0&&(f={});var v=this.device.gl;if(!Uo(v)){var T=!1;for(var O in f){T||(v.useProgram(this.gl_program),T=!0);var L=f[O],F=this.uniformSetters[O];if(F){var H=L;H instanceof Wy&&(H=H.textureIndex),F(H)}}}return this},o}(Md),qE=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.QueryPool;var F=L.device.gl;if(Uo(F)){var H=O.elemCount,ie=O.type;L.gl_query=SP(H,function(){return L.device.ensureResourceExists(F.createQuery())}),L.gl_query_type=iC(ie)}return L}return o.prototype.queryResultOcclusion=function(f){var v=this.device.gl;if(Uo(v)){var T=this.gl_query[f];return v.getQueryParameter(T,v.QUERY_RESULT_AVAILABLE)?!!v.getQueryParameter(T,v.QUERY_RESULT):null}return null},o.prototype.destroy=function(){a.prototype.destroy.call(this);var f=this.device.gl;if(Uo(f))for(var v=0;v<this.gl_query.length;v++)f.deleteQuery(this.gl_query[v])},o}(Md),aC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this,{id:v,device:T})||this;return O.type=Ds.Readback,O.gl_pbo=null,O.gl_sync=null,O}return o.prototype.clientWaitAsync=function(f,v,T){v===void 0&&(v=0),T===void 0&&(T=10);var O=this.device.gl;return new Promise(function(L,F){function H(){var ie=O.clientWaitSync(f,v,0);if(ie==O.WAIT_FAILED){F();return}if(ie==O.TIMEOUT_EXPIRED){setTimeout(H,(0,Ny.Z)(T,0,O.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}L()}H()})},o.prototype.getBufferSubDataAsync=function(f,v,T,O,L,F){return(0,_o.mG)(this,void 0,void 0,function(){var H;return(0,_o.Jh)(this,function(ie){switch(ie.label){case 0:return H=this.device.gl,Uo(H)?(this.gl_sync=H.fenceSync(H.SYNC_GPU_COMMANDS_COMPLETE,0),H.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return ie.sent(),H.bindBuffer(f,v),H.getBufferSubData(f,T,O,L,F),H.bindBuffer(f,null),[2,O];case 2:return[2]}})})},o.prototype.readTexture=function(f,v,T,O,L,F,H,ie){return H===void 0&&(H=0),ie===void 0&&(ie=F.byteLength||0),(0,_o.mG)(this,void 0,void 0,function(){var ge,Te,Ve,Mt,rn;return(0,_o.Jh)(this,function(Rn){return ge=this.device.gl,Te=f,Ve=this.device.translateTextureFormat(Te.format),Mt=this.device.translateTextureType(Te.format),rn=Hb(Te.format),Uo(ge)?(this.gl_pbo=this.device.ensureResourceExists(ge.createBuffer()),ge.bindBuffer(ge.PIXEL_PACK_BUFFER,this.gl_pbo),ge.bufferData(ge.PIXEL_PACK_BUFFER,ie,ge.STREAM_READ),ge.bindBuffer(ge.PIXEL_PACK_BUFFER,null),ge.bindFramebuffer(Tn.READ_FRAMEBUFFER,this.device.readbackFramebuffer),ge.framebufferTexture2D(Tn.READ_FRAMEBUFFER,Tn.COLOR_ATTACHMENT0,Tn.TEXTURE_2D,Te.gl_texture,0),ge.bindBuffer(ge.PIXEL_PACK_BUFFER,this.gl_pbo),ge.readPixels(v,T,O,L,Ve,Mt,H*rn),ge.bindBuffer(ge.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(ge.PIXEL_PACK_BUFFER,this.gl_pbo,0,F,H,0)]):[2,this.readTextureSync(f,v,T,O,L,F,H,ie)]})})},o.prototype.readTextureSync=function(f,v,T,O,L,F,H,ie){ie===void 0&&(ie=F.byteLength||0);var ge=this.device.gl,Te=f,Ve=this.device.translateTextureType(Te.format);return ge.bindFramebuffer(Tn.FRAMEBUFFER,this.device.readbackFramebuffer),ge.framebufferTexture2D(Tn.FRAMEBUFFER,Tn.COLOR_ATTACHMENT0,Tn.TEXTURE_2D,Te.gl_texture,0),ge.pixelStorei(ge.PACK_ALIGNMENT,4),ge.readPixels(v,T,O,L,ge.RGBA,Ve,F),F},o.prototype.readBuffer=function(f,v,T,O,L){return(0,_o.mG)(this,void 0,void 0,function(){var F;return(0,_o.Jh)(this,function(H){return F=this.device.gl,Uo(F)?[2,this.getBufferSubDataAsync(F.ARRAY_BUFFER,zm(f,v),v,T,O,L)]:[2,Promise.reject()]})})},o.prototype.destroy=function(){a.prototype.destroy.call(this),Uo(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},o}(Md),sC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;return H.type=Ds.RenderPipeline,H.drawMode=Rv((L=O.topology)!==null&&L!==void 0?L:Pl.TRIANGLES),H.program=O.program,H.inputLayout=O.inputLayout,H.megaState=(0,_o.pi)((0,_o.pi)({},Ov(x0)),O.megaStateDescriptor),H.colorAttachmentFormats=O.colorAttachmentFormats.slice(),H.depthStencilAttachmentFormat=O.depthStencilAttachmentFormat,H.sampleCount=(F=O.sampleCount)!==null&&F!==void 0?F:1,H}return o}(Md),lC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;return L.type=Ds.ComputePipeline,L.descriptor=O,L}return o}(Md),QE=function(){function a(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return a.prototype.trackResourceCreated=function(o){this.creationStacks.set(o,new Error().stack),this.liveObjects.add(o)},a.prototype.trackResourceDestroyed=function(o){this.deletionStacks.has(o)&&console.warn("Object double freed:",o,`

Creation stack: `,this.creationStacks.get(o),`

Deletion stack: `,this.deletionStacks.get(o),`

This stack: `,new Error().stack),this.deletionStacks.set(o,new Error().stack),this.liveObjects.delete(o)},a.prototype.checkForLeaks=function(){var o,f;try{for(var v=(0,_o.XA)(this.liveObjects.values()),T=v.next();!T.done;T=v.next()){var O=T.value;console.warn("Object leaked:",O,"Creation stack:",this.creationStacks.get(O))}}catch(L){o={error:L}}finally{try{T&&!T.done&&(f=v.return)&&f.call(v)}finally{if(o)throw o.error}}},a.prototype.setResourceLeakCheck=function(o,f){f?this.liveObjects.add(o):this.liveObjects.delete(o)},a}(),p_=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;H.type=Ds.Sampler;var ie=H.device.gl;if(Uo(ie)){var ge=H.device.ensureResourceExists(ie.createSampler());ie.samplerParameteri(ge,Tn.TEXTURE_WRAP_S,Zy(O.addressModeU)),ie.samplerParameteri(ge,Tn.TEXTURE_WRAP_T,Zy(O.addressModeV)),ie.samplerParameteri(ge,Tn.TEXTURE_WRAP_R,Zy((L=O.addressModeW)!==null&&L!==void 0?L:O.addressModeU)),ie.samplerParameteri(ge,Tn.TEXTURE_MIN_FILTER,f_(O.minFilter,O.mipmapFilter)),ie.samplerParameteri(ge,Tn.TEXTURE_MAG_FILTER,f_(O.magFilter,Hl.NO_MIP)),O.lodMinClamp!==void 0&&ie.samplerParameterf(ge,Tn.TEXTURE_MIN_LOD,O.lodMinClamp),O.lodMaxClamp!==void 0&&ie.samplerParameterf(ge,Tn.TEXTURE_MAX_LOD,O.lodMaxClamp),O.compareFunction!==void 0&&(ie.samplerParameteri(ge,ie.TEXTURE_COMPARE_MODE,ie.COMPARE_REF_TO_TEXTURE),ie.samplerParameteri(ge,ie.TEXTURE_COMPARE_FUNC,O.compareFunction));var Te=(F=O.maxAnisotropy)!==null&&F!==void 0?F:1;Te>1&&H.device.EXT_texture_filter_anisotropic!==null&&(Ia(O.minFilter===sa.BILINEAR&&O.magFilter===sa.BILINEAR&&O.mipmapFilter===Hl.LINEAR),ie.samplerParameterf(ge,H.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Te)),H.gl_sampler=ge}else H.descriptor=O;return H}return o.prototype.setTextureParameters=function(f,v,T){var O,L=this.device.gl,F=this.descriptor;this.isNPOT(v,T)?L.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_MIN_FILTER,Tn.LINEAR):L.texParameteri(f,Tn.TEXTURE_MIN_FILTER,f_(F.minFilter,F.mipmapFilter)),L.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_WRAP_S,Zy(F.addressModeU)),L.texParameteri(Tn.TEXTURE_2D,Tn.TEXTURE_WRAP_T,Zy(F.addressModeV)),L.texParameteri(f,Tn.TEXTURE_MAG_FILTER,f_(F.magFilter,Hl.NO_MIP));var H=(O=F.maxAnisotropy)!==null&&O!==void 0?O:1;H>1&&this.device.EXT_texture_filter_anisotropic!==null&&(Ia(F.minFilter===sa.BILINEAR&&F.magFilter===sa.BILINEAR&&F.mipmapFilter===Hl.LINEAR),L.texParameteri(f,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H))},o.prototype.destroy=function(){a.prototype.destroy.call(this),Uo(this.device.gl)&&this.device.gl.deleteSampler(h_(this))},o.prototype.isNPOT=function(f,v){return!zy(f)||!zy(v)},o}(Md),Mv=function(){function a(){}return a.prototype.dispatchWorkgroups=function(o,f,v){},a.prototype.dispatchWorkgroupsIndirect=function(o,f){},a.prototype.setPipeline=function(o){},a.prototype.setBindings=function(o){},a.prototype.pushDebugGroup=function(o){},a.prototype.popDebugGroup=function(){},a.prototype.insertDebugMarker=function(o){},a}(),hh=function(a){(0,_o.ZT)(o,a);function o(){var f=a!==null&&a.apply(this,arguments)||this;return f.type=Ds.RenderBundle,f.commands=[],f}return o.prototype.push=function(f){this.commands.push(f)},o.prototype.replay=function(){this.commands.forEach(function(f){return f()})},o}(Md),JE=65536,rx=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,cC=function(){function a(o,f){f===void 0&&(f={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=Ov(x0),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Vp.LOWER_LEFT,this.clipSpaceNearZ=bg.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=o,this.contextAttributes=Cv(o.getContextAttributes()),Uo(o)?(this.EXT_texture_norm16=o.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=o.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=o.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=o.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=o.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=o.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=o.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=o.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=o.getExtension("EXT_color_buffer_half_float"),o.getExtension("EXT_frag_depth"),o.getExtension("OES_element_index_uint"),o.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=o.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=o.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=o.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=o.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=o.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=o.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=o.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=o.getExtension("KHR_parallel_shader_compile"),Uo(o)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new Wy({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:rs.TEXTURE_2D,mipLevelCount:1,usage:hu.RENDER_TARGET,format:this.contextAttributes.alpha===!1?or.U8_RGB_RT:or.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Oc.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(rs.TEXTURE_2D,Oc.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(rs.TEXTURE_2D,Oc.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:Ss.VERTEX,hint:cd.STATIC}),Uo(o)&&(this.fallbackTexture2DArray=this.createFallbackTexture(rs.TEXTURE_2D_ARRAY,Oc.Float),this.fallbackTexture3D=this.createFallbackTexture(rs.TEXTURE_3D,Oc.Float),this.fallbackTextureCube=this.createFallbackTexture(rs.TEXTURE_CUBE_MAP,Oc.Float)),this.currentMegaState.depthCompare=Ya.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=Ku.ALL,o.enable(o.DEPTH_TEST),o.enable(o.STENCIL_TEST),this.checkLimits(),f.shaderDebug&&(this.shaderDebug=!0),f.trackResources&&(this.resourceCreationTracker=new QE)}return a.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},a.prototype.createFallbackTexture=function(o,f){var v=o===rs.TEXTURE_CUBE_MAP?6:1,T=f===Oc.Depth?or.D32F:or.U8_RGBA_NORM,O=this.createTexture({dimension:o,format:T,usage:hu.SAMPLED,width:1,height:1,depthOrArrayLayers:v,mipLevelCount:1});return f===Oc.Float&&O.setImageData([new Uint8Array(4*v)]),Cg(O)},a.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},a.prototype.checkLimits=function(){var o=this.gl;if(this.maxVertexAttribs=o.getParameter(Tn.MAX_VERTEX_ATTRIBS),Uo(o)){this.uniformBufferMaxPageByteSize=Math.min(o.getParameter(Tn.MAX_UNIFORM_BLOCK_SIZE),JE),this.uniformBufferWordAlignment=o.getParameter(o.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var f=o.getInternalformatParameter(o.RENDERBUFFER,o.DEPTH32F_STENCIL8,o.SAMPLES);this.supportedSampleCounts=f?(0,_o.ev)([],(0,_o.CR)(f),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=JE;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(v,T){return v-T})},a.prototype.configureSwapChain=function(o,f,v){var T=this.scTexture;T.width=o,T.height=f,this.scPlatformFramebuffer=FA(v)},a.prototype.getDevice=function(){return this},a.prototype.getCanvas=function(){return this.gl.canvas},a.prototype.getOnscreenTexture=function(){return this.scTexture},a.prototype.beginFrame=function(){},a.prototype.endFrame=function(){},a.prototype.translateTextureInternalFormat=function(o,f){switch(f===void 0&&(f=!1),o){case or.ALPHA:return Tn.ALPHA;case or.U8_LUMINANCE:case or.F16_LUMINANCE:case or.F32_LUMINANCE:return Tn.LUMINANCE;case or.F16_R:return Tn.R16F;case or.F16_RG:return Tn.RG16F;case or.F16_RGB:return Tn.RGB16F;case or.F16_RGBA:return Tn.RGBA16F;case or.F32_R:return Tn.R32F;case or.F32_RG:return Tn.RG32F;case or.F32_RGB:return Tn.RGB32F;case or.F32_RGBA:return Uo(this.gl)?Tn.RGBA32F:f?this.WEBGL_color_buffer_float.RGBA32F_EXT:Tn.RGBA;case or.U8_R_NORM:return Tn.R8;case or.U8_RG_NORM:return Tn.RG8;case or.U8_RGB_NORM:case or.U8_RGB_RT:return Tn.RGB8;case or.U8_RGB_SRGB:return Tn.SRGB8;case or.U8_RGBA_NORM:case or.U8_RGBA_RT:return Uo(this.gl)?Tn.RGBA8:f?Tn.RGBA4:Tn.RGBA;case or.U8_RGBA:return Tn.RGBA;case or.U8_RGBA_SRGB:case or.U8_RGBA_RT_SRGB:return Tn.SRGB8_ALPHA8;case or.U16_R:return Tn.R16UI;case or.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case or.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case or.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case or.U16_RGBA_5551:return Tn.RGB5_A1;case or.U16_RGB_565:return Tn.RGB565;case or.U32_R:return Tn.R32UI;case or.S8_RGBA_NORM:return Tn.RGBA8_SNORM;case or.S8_RG_NORM:return Tn.RG8_SNORM;case or.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case or.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case or.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case or.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case or.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case or.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case or.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case or.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case or.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case or.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case or.D32F_S8:return Uo(this.gl)?Tn.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?Tn.DEPTH_STENCIL:Tn.DEPTH_COMPONENT16;case or.D24_S8:return Uo(this.gl)?Tn.DEPTH24_STENCIL8:this.WEBGL_depth_texture?Tn.DEPTH_STENCIL:Tn.DEPTH_COMPONENT16;case or.D32F:return Uo(this.gl)?Tn.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?Tn.DEPTH_COMPONENT:Tn.DEPTH_COMPONENT16;case or.D24:return Uo(this.gl)?Tn.DEPTH_COMPONENT24:this.WEBGL_depth_texture?Tn.DEPTH_COMPONENT:Tn.DEPTH_COMPONENT16;default:throw new Error("whoops")}},a.prototype.translateTextureType=function(o){var f=fh(o);switch(f){case oi.U8:return Tn.UNSIGNED_BYTE;case oi.U16:return Tn.UNSIGNED_SHORT;case oi.U32:return Tn.UNSIGNED_INT;case oi.S8:return Tn.BYTE;case oi.F16:return Tn.HALF_FLOAT;case oi.F32:return Tn.FLOAT;case oi.U16_PACKED_5551:return Tn.UNSIGNED_SHORT_5_5_5_1;case oi.D32F:return Uo(this.gl)?Tn.FLOAT:this.WEBGL_depth_texture?Tn.UNSIGNED_INT:Tn.UNSIGNED_BYTE;case oi.D24:return Uo(this.gl)?Tn.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Tn.UNSIGNED_SHORT:Tn.UNSIGNED_BYTE;case oi.D24S8:return Uo(this.gl)?Tn.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Tn.UNSIGNED_INT_24_8_WEBGL:Tn.UNSIGNED_BYTE;case oi.D32FS8:return Tn.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},a.prototype.translateInternalTextureFormat=function(o){switch(o){case or.F32_R:return Tn.R32F;case or.F32_RG:return Tn.RG32F;case or.F32_RGB:return Tn.RGB32F;case or.F32_RGBA:return Tn.RGBA32F;case or.F16_R:return Tn.R16F;case or.F16_RG:return Tn.RG16F;case or.F16_RGB:return Tn.RGB16F;case or.F16_RGBA:return Tn.RGBA16F}return this.translateTextureFormat(o)},a.prototype.translateTextureFormat=function(o){if(Qb(o)||o===or.F32_LUMINANCE||o===or.U8_LUMINANCE)return this.translateTextureInternalFormat(o);var f=Uo(this.gl)||!Uo(this.gl)&&!!this.WEBGL_depth_texture;switch(o){case or.D24_S8:case or.D32F_S8:return f?Tn.DEPTH_STENCIL:Tn.RGBA;case or.D24:case or.D32F:return f?Tn.DEPTH_COMPONENT:Tn.RGBA}var v=XE(o),T=n_(o);switch(T){case Bi.A:return Tn.ALPHA;case Bi.R:return v?Tn.RED_INTEGER:Tn.RED;case Bi.RG:return v?Tn.RG_INTEGER:Tn.RG;case Bi.RGB:return v?Tn.RGB_INTEGER:Tn.RGB;case Bi.RGBA:return Tn.RGBA}},a.prototype.setActiveTexture=function(o){this.currentActiveTexture!==o&&(this.gl.activeTexture(o),this.currentActiveTexture=o)},a.prototype.bindVAO=function(o){this.currentBoundVAO!==o&&(Uo(this.gl)?this.gl.bindVertexArray(o):this.OES_vertex_array_object.bindVertexArrayOES(o),this.currentBoundVAO=o)},a.prototype.programCompiled=function(o){Ia(o.compileState!==Hf.NeedsCompile),o.compileState===Hf.Compiling&&(o.compileState=Hf.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(o))},a.prototype.useProgram=function(o){this.currentProgram!==o&&(this.programCompiled(o),this.gl.useProgram(o.gl_program),this.currentProgram=o)},a.prototype.ensureResourceExists=function(o){if(o===null){var f=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(f))}else return o},a.prototype.createBuffer=function(o){return new d_({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTexture=function(o){return new Wy({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createSampler=function(o){return new p_({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTarget=function(o){return new nx({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTargetFromTexture=function(o){var f=o,v=f.format,T=f.width,O=f.height,L=f.mipLevelCount;return Ia(L===1),this.createRenderTarget({format:v,width:T,height:O,sampleCount:1,texture:o})},a.prototype.createProgram=function(o){var f,v,T,O=(f=o.vertex)===null||f===void 0?void 0:f.glsl;return!((v=o.vertex)===null||v===void 0)&&v.glsl&&(o.vertex.glsl=km(this.queryVendorInfo(),"vert",o.vertex.glsl)),!((T=o.fragment)===null||T===void 0)&&T.glsl&&(o.fragment.glsl=km(this.queryVendorInfo(),"frag",o.fragment.glsl)),this.createProgramSimple(o,O)},a.prototype.createProgramSimple=function(o,f){var v=new KE({id:this.getNextUniqueId(),device:this,descriptor:o},f);return v},a.prototype.createBindings=function(o){return new rC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createInputLayout=function(o){return new tx({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderPipeline=function(o){return new sC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createComputePass=function(){return new Mv},a.prototype.createComputePipeline=function(o){return new lC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createReadback=function(){return new aC({id:this.getNextUniqueId(),device:this})},a.prototype.createQueryPool=function(o,f){return new qE({id:this.getNextUniqueId(),device:this,descriptor:{type:o,elemCount:f}})},a.prototype.formatRenderPassDescriptor=function(o){var f,v,T,O,L,F,H=o.colorAttachment;o.depthClearValue=(f=o.depthClearValue)!==null&&f!==void 0?f:"load",o.stencilClearValue=(v=o.stencilClearValue)!==null&&v!==void 0?v:"load";for(var ie=0;ie<H.length;ie++)o.colorAttachmentLevel||(o.colorAttachmentLevel=[]),o.colorAttachmentLevel[ie]=(T=o.colorAttachmentLevel[ie])!==null&&T!==void 0?T:0,o.colorResolveToLevel||(o.colorResolveToLevel=[]),o.colorResolveToLevel[ie]=(O=o.colorResolveToLevel[ie])!==null&&O!==void 0?O:0,o.colorClearColor||(o.colorClearColor=[]),o.colorClearColor[ie]=(L=o.colorClearColor[ie])!==null&&L!==void 0?L:"load",o.colorStore||(o.colorStore=[]),o.colorStore[ie]=(F=o.colorStore[ie])!==null&&F!==void 0?F:!1},a.prototype.createRenderBundle=function(){return new hh({id:this.getNextUniqueId(),device:this})},a.prototype.beginBundle=function(o){this.renderBundle=o},a.prototype.endBundle=function(){this.renderBundle=void 0},a.prototype.executeBundles=function(o){o.forEach(function(f){f.replay()})},a.prototype.createRenderPass=function(o){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=o,this.formatRenderPassDescriptor(o);var f=o.colorAttachment,v=o.colorAttachmentLevel,T=o.colorClearColor,O=o.colorResolveTo,L=o.colorResolveToLevel,F=o.depthStencilAttachment,H=o.depthClearValue,ie=o.stencilClearValue,ge=o.depthStencilResolveTo,Te=O&&O.length===1&&O[0]===this.scTexture;this.setRenderPassParametersBegin(f.length,Te);for(var Ve=0;Ve<f.length;Ve++)this.setRenderPassParametersColor(Ve,f[Ve],v[Ve],O[Ve],L[Ve],Te);this.setRenderPassParametersDepthStencil(F,ge,Te),this.validateCurrentAttachments();for(var Ve=0;Ve<f.length;Ve++){var Mt=T[Ve];Mt!=="load"&&this.setRenderPassParametersClearColor(Ve,Mt.r,Mt.g,Mt.b,Mt.a)}return this.setRenderPassParametersClearDepthStencil(H,ie),this},a.prototype.submitPass=function(o){Ia(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},a.prototype.copySubTexture2D=function(o,f,v,T,O,L){var F=this.gl,H=o,ie=T;if(Ia(ie.mipLevelCount===1),Ia(H.mipLevelCount===1),Uo(F))H===this.scTexture?F.bindFramebuffer(F.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(F.bindFramebuffer(F.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(F.DRAW_FRAMEBUFFER,F.COLOR_ATTACHMENT0,H,0)),F.bindFramebuffer(F.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(F.READ_FRAMEBUFFER,F.COLOR_ATTACHMENT0,ie,0),F.blitFramebuffer(O,L,O+ie.width,L+ie.height,f,v,f+ie.width,v+ie.height,F.COLOR_BUFFER_BIT,F.LINEAR),F.bindFramebuffer(F.READ_FRAMEBUFFER,null),F.bindFramebuffer(F.DRAW_FRAMEBUFFER,null);else if(H===this.scTexture){var ge=this.createRenderTargetFromTexture(T);this.submitBlitRenderPass(ge,H)}},a.prototype.queryLimits=function(){return this},a.prototype.queryTextureFormatSupported=function(o,f,v){switch(o){case or.BC1_SRGB:case or.BC2_SRGB:case or.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?ex(f,v,4,4):!1;case or.BC1:case or.BC2:case or.BC3:return this.WEBGL_compressed_texture_s3tc!==null?ex(f,v,4,4):!1;case or.BC4_UNORM:case or.BC4_SNORM:case or.BC5_UNORM:case or.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?ex(f,v,4,4):!1;case or.U16_R_NORM:case or.U16_RG_NORM:case or.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case or.F32_R:case or.F32_RG:case or.F32_RGB:case or.F32_RGBA:return this.OES_texture_float_linear!==null;case or.F16_R:case or.F16_RG:case or.F16_RGB:case or.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},a.prototype.queryProgramReady=function(o){var f=this.gl;if(o.compileState===Hf.NeedsCompile)throw new Error("whoops");if(o.compileState===Hf.Compiling){var v=void 0;return this.KHR_parallel_shader_compile!==null?v=f.getProgramParameter(o.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):v=!0,v&&this.programCompiled(o),v}return o.compileState===Hf.NeedsBind||o.compileState===Hf.ReadyToUse},a.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},a.prototype.queryVendorInfo=function(){return this},a.prototype.queryRenderPass=function(o){return this.currentRenderPassDescriptor},a.prototype.queryRenderTarget=function(o){var f=o;return f},a.prototype.setResourceName=function(o,f){if(o.name=f,o.type===Ds.Buffer)for(var v=o.gl_buffer_pages,T=0;T<v.length;T++)E0(v[T],"".concat(f," Page ").concat(T));else if(o.type===Ds.Texture)E0(Cg(o),f);else if(o.type===Ds.Sampler)E0(h_(o),f);else if(o.type===Ds.RenderTarget){var O=o.gl_renderbuffer;O!==null&&E0(O,f)}else o.type===Ds.InputLayout&&E0(o.vao,f)},a.prototype.setResourceLeakCheck=function(o,f){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(o,f)},a.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},a.prototype.pushDebugGroup=function(o){},a.prototype.popDebugGroup=function(){},a.prototype.insertDebugMarker=function(o){},a.prototype.programPatched=function(o,f){Ia(this.shaderDebug)},a.prototype.getBufferData=function(o,f,v){v===void 0&&(v=0);var T=this.gl;Uo(T)&&(T.bindBuffer(T.COPY_READ_BUFFER,zm(o,v*4)),T.getBufferSubData(T.COPY_READ_BUFFER,v*4,f))},a.prototype.debugGroupStatisticsDrawCall=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].drawCallCount+=o},a.prototype.debugGroupStatisticsBufferUpload=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].bufferUploadCount+=o},a.prototype.debugGroupStatisticsTextureBind=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].textureBindCount+=o},a.prototype.debugGroupStatisticsTriangles=function(o){for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].triangleCount+=o},a.prototype.reportShaderError=function(o,f){var v=this.gl,T=v.getShaderParameter(o,v.COMPILE_STATUS);if(!T){console.error(zA(f));var O=v.getExtension("WEBGL_debug_shaders");O&&console.error(O.getTranslatedShaderSource(o)),console.error(v.getShaderInfoLog(o))}return T},a.prototype.checkProgramCompilationForErrors=function(o){var f=this.gl,v=o.gl_program;if(!f.getProgramParameter(v,f.LINK_STATUS)){var T=o.descriptor;if(!this.reportShaderError(o.gl_shader_vert,T.vertex.glsl)||!this.reportShaderError(o.gl_shader_frag,T.fragment.glsl))return;console.error(f.getProgramInfoLog(o.gl_program))}},a.prototype.bindFramebufferAttachment=function(o,f,v,T){var O=this.gl;if((0,Cf.Z)(v))O.framebufferRenderbuffer(o,f,O.RENDERBUFFER,null);else if(v.type===Ds.RenderTarget)v.gl_renderbuffer!==null?O.framebufferRenderbuffer(o,f,O.RENDERBUFFER,v.gl_renderbuffer):v.texture!==null&&O.framebufferTexture2D(o,f,Tn.TEXTURE_2D,Cg(v.texture),T);else if(v.type===Ds.Texture){var L=Cg(v);v.dimension===rs.TEXTURE_2D?O.framebufferTexture2D(o,f,Tn.TEXTURE_2D,L,T):Uo(O)&&(v.dimension,rs.TEXTURE_2D_ARRAY)}},a.prototype.bindFramebufferDepthStencilAttachment=function(o,f){var v=this.gl,T=(0,Cf.Z)(f)?mo.Depth|mo.Stencil:Nm(f.format),O=!!(T&mo.Depth),L=!!(T&mo.Stencil);if(O&&L){var F=Uo(this.gl)||!Uo(this.gl)&&!!this.WEBGL_depth_texture;F?this.bindFramebufferAttachment(o,v.DEPTH_STENCIL_ATTACHMENT,f,0):this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,f,0)}else O?(this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,f,0),this.bindFramebufferAttachment(o,v.STENCIL_ATTACHMENT,null,0)):L&&(this.bindFramebufferAttachment(o,v.STENCIL_ATTACHMENT,f,0),this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,null,0))},a.prototype.validateCurrentAttachments=function(){for(var o=-1,f=-1,v=-1,T=0;T<this.currentColorAttachments.length;T++){var O=this.currentColorAttachments[T];O!==null&&(o===-1?(o=O.sampleCount,f=O.width,v=O.height):(Ia(o===O.sampleCount),Ia(f===O.width),Ia(v===O.height)))}this.currentDepthStencilAttachment&&(o===-1?o=this.currentDepthStencilAttachment.sampleCount:(Ia(o===this.currentDepthStencilAttachment.sampleCount),Ia(f===this.currentDepthStencilAttachment.width),Ia(v===this.currentDepthStencilAttachment.height))),this.currentSampleCount=o},a.prototype.setRenderPassParametersBegin=function(o,f){f===void 0&&(f=!1);var v=this.gl;if(f)v.bindFramebuffer(Tn.FRAMEBUFFER,null);else if(Uo(v)?v.bindFramebuffer(Tn.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||v.bindFramebuffer(Tn.FRAMEBUFFER,this.renderPassDrawFramebuffer),Uo(v)?v.drawBuffers([Tn.COLOR_ATTACHMENT0,Tn.COLOR_ATTACHMENT1,Tn.COLOR_ATTACHMENT2,Tn.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([Tn.COLOR_ATTACHMENT0_WEBGL,Tn.COLOR_ATTACHMENT1_WEBGL,Tn.COLOR_ATTACHMENT2_WEBGL,Tn.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var T=o;T<this.currentColorAttachments.length;T++){var O=Uo(v)?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,L=Uo(v)?Tn.COLOR_ATTACHMENT0:Tn.COLOR_ATTACHMENT0_WEBGL;v.framebufferRenderbuffer(O,L+T,Tn.RENDERBUFFER,null),v.framebufferTexture2D(O,L+T,Tn.TEXTURE_2D,null,0)}this.currentColorAttachments.length=o},a.prototype.setRenderPassParametersColor=function(o,f,v,T,O,L){L===void 0&&(L=!1);var F=this.gl,H=Uo(F);(this.currentColorAttachments[o]!==f||this.currentColorAttachmentLevels[o]!==v)&&(this.currentColorAttachments[o]=f,this.currentColorAttachmentLevels[o]=v,!L&&(H||!H&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(H?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,(H?Tn.COLOR_ATTACHMENT0:Tn.COLOR_ATTACHMENT0_WEBGL)+o,f,v),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[o]!==T||this.currentColorResolveToLevels[o]!==O)&&(this.currentColorResolveTos[o]=T,this.currentColorResolveToLevels[o]=O,T!==null&&(this.resolveColorAttachmentsChanged=!0))},a.prototype.setRenderPassParametersDepthStencil=function(o,f,v){v===void 0&&(v=!1);var T=this.gl;this.currentDepthStencilAttachment!==o&&(this.currentDepthStencilAttachment=o,!v&&!this.inBlitRenderPass&&this.bindFramebufferDepthStencilAttachment(Uo(T)?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==f&&(this.currentDepthStencilResolveTo=f,f&&(this.resolveDepthStencilAttachmentsChanged=!0))},a.prototype.setRenderPassParametersClearColor=function(o,f,v,T,O){var L=this.gl;if(this.OES_draw_buffers_indexed!==null){var F=this.currentMegaState.attachmentsState[o];F&&F.channelWriteMask!==Ku.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(o,!0,!0,!0,!0),F.channelWriteMask=Ku.ALL)}else{var F=this.currentMegaState.attachmentsState[0];F&&F.channelWriteMask!==Ku.ALL&&(L.colorMask(!0,!0,!0,!0),F.channelWriteMask=Ku.ALL)}this.setScissorRectEnabled(!1),Uo(L)?L.clearBufferfv(L.COLOR,o,[f,v,T,O]):(L.clearColor(f,v,T,O),L.clear(L.COLOR_BUFFER_BIT))},a.prototype.setRenderPassParametersClearDepthStencil=function(o,f){o===void 0&&(o="load"),f===void 0&&(f="load");var v=this.gl;o!=="load"&&(Ia(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(v.depthMask(!0),this.currentMegaState.depthWrite=!0),Uo(v)?v.clearBufferfv(v.DEPTH,0,[o]):(v.clearDepth(o),v.clear(v.DEPTH_BUFFER_BIT))),f!=="load"&&(Ia(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(v.enable(v.STENCIL_TEST),v.stencilMask(255),this.currentMegaState.stencilWrite=!0),Uo(v)?v.clearBufferiv(v.STENCIL,0,[f]):(v.clearStencil(f),v.clear(v.STENCIL_BUFFER_BIT)))},a.prototype.setBindings=function(o){var f=this,v;if(this.renderBundle){this.renderBundle.push(function(){return f.setBindings(o)});return}var T=this.gl,O=o,L=O.uniformBufferBindings,F=O.samplerBindings,H=O.bindingLayouts;Ia(0<H.bindingLayoutTables.length);var ie=H.bindingLayoutTables[0];Ia(L.length>=ie.numUniformBuffers),Ia(F.length>=ie.numSamplers);for(var ge=0;ge<L.length;ge++){var Te=L[ge];if(Te.size!==0){var Ve=ie.firstUniformBuffer+ge,Mt=Te.buffer,rn=Te.offset||0,Rn=Te.size||Mt.byteSize;if(Mt!==this.currentUniformBuffers[Ve]||rn!==this.currentUniformBufferByteOffsets[Ve]||Rn!==this.currentUniformBufferByteSizes[Ve]){var hr=rn%Mt.pageByteSize,Nr=Mt.gl_buffer_pages[rn/Mt.pageByteSize|0];Ia(hr+Rn<=Mt.pageByteSize),Uo(T)&&T.bindBufferRange(T.UNIFORM_BUFFER,Ve,Nr,hr,Rn),this.currentUniformBuffers[Ve]=Mt,this.currentUniformBufferByteOffsets[Ve]=rn,this.currentUniformBufferByteSizes[Ve]=Rn}}}for(var ge=0;ge<ie.numSamplers;ge++){var Te=F[ge],jn=ie.firstSampler+ge,ci=Te!==null&&Te.sampler!==null?h_(Te.sampler):null,ji=Te!==null&&Te.texture!==null?Cg(Te.texture):null;if(this.currentSamplers[jn]!==ci&&(Uo(T)&&T.bindSampler(jn,ci),this.currentSamplers[jn]=ci),this.currentTextures[jn]!==ji){if(this.setActiveTexture(T.TEXTURE0+jn),ji!==null){var To=Cv(Te).texture,Ji=To.gl_target,Hr=To.width,Gi=To.height;Te.texture.textureIndex=jn,T.bindTexture(Ji,ji),Uo(T)||(v=Te.sampler)===null||v===void 0||v.setTextureParameters(Ji,Hr,Gi),this.debugGroupStatisticsTextureBind()}else{var ja=(0,_o.pi)((0,_o.pi)({},Te),BE),ys=ja.dimension,$o=ja.formatKind,Ji=oC(ys);T.bindTexture(Ji,this.getFallbackTexture((0,_o.pi)({gl_target:Ji,formatKind:$o},ja)))}this.currentTextures[jn]=ji}}},a.prototype.setViewport=function(o,f,v,T){var O=this.gl;O.viewport(o,f,v,T)},a.prototype.setScissorRect=function(o,f,v,T){var O=this.gl;this.setScissorRectEnabled(!0),O.scissor(o,f,v,T)},a.prototype.applyAttachmentStateIndexed=function(o,f,v){var T=this.gl,O=this.OES_draw_buffers_indexed;f.channelWriteMask!==v.channelWriteMask&&(O.colorMaskiOES(o,!!(v.channelWriteMask&Ku.RED),!!(v.channelWriteMask&Ku.GREEN),!!(v.channelWriteMask&Ku.BLUE),!!(v.channelWriteMask&Ku.ALPHA)),f.channelWriteMask=v.channelWriteMask);var L=f.rgbBlendState.blendMode!==v.rgbBlendState.blendMode||f.alphaBlendState.blendMode!==v.alphaBlendState.blendMode,F=f.rgbBlendState.blendSrcFactor!==v.rgbBlendState.blendSrcFactor||f.alphaBlendState.blendSrcFactor!==v.alphaBlendState.blendSrcFactor||f.rgbBlendState.blendDstFactor!==v.rgbBlendState.blendDstFactor||f.alphaBlendState.blendDstFactor!==v.alphaBlendState.blendDstFactor;(F||L)&&(up(f.rgbBlendState)&&up(f.alphaBlendState)?O.enableiOES(o,T.BLEND):up(v.rgbBlendState)&&up(v.alphaBlendState)&&O.disableiOES(o,T.BLEND)),L&&(O.blendEquationSeparateiOES(o,v.rgbBlendState.blendMode,v.alphaBlendState.blendMode),f.rgbBlendState.blendMode=v.rgbBlendState.blendMode,f.alphaBlendState.blendMode=v.alphaBlendState.blendMode),F&&(O.blendFuncSeparateiOES(o,v.rgbBlendState.blendSrcFactor,v.rgbBlendState.blendDstFactor,v.alphaBlendState.blendSrcFactor,v.alphaBlendState.blendDstFactor),f.rgbBlendState.blendSrcFactor=v.rgbBlendState.blendSrcFactor,f.alphaBlendState.blendSrcFactor=v.alphaBlendState.blendSrcFactor,f.rgbBlendState.blendDstFactor=v.rgbBlendState.blendDstFactor,f.alphaBlendState.blendDstFactor=v.alphaBlendState.blendDstFactor)},a.prototype.applyAttachmentState=function(o,f){var v=this.gl;o.channelWriteMask!==f.channelWriteMask&&(v.colorMask(!!(f.channelWriteMask&Ku.RED),!!(f.channelWriteMask&Ku.GREEN),!!(f.channelWriteMask&Ku.BLUE),!!(f.channelWriteMask&Ku.ALPHA)),o.channelWriteMask=f.channelWriteMask);var T=o.rgbBlendState.blendMode!==f.rgbBlendState.blendMode||o.alphaBlendState.blendMode!==f.alphaBlendState.blendMode,O=o.rgbBlendState.blendSrcFactor!==f.rgbBlendState.blendSrcFactor||o.alphaBlendState.blendSrcFactor!==f.alphaBlendState.blendSrcFactor||o.rgbBlendState.blendDstFactor!==f.rgbBlendState.blendDstFactor||o.alphaBlendState.blendDstFactor!==f.alphaBlendState.blendDstFactor;(O||T)&&(up(o.rgbBlendState)&&up(o.alphaBlendState)?v.enable(v.BLEND):up(f.rgbBlendState)&&up(f.alphaBlendState)&&v.disable(v.BLEND)),T&&(v.blendEquationSeparate(f.rgbBlendState.blendMode,f.alphaBlendState.blendMode),o.rgbBlendState.blendMode=f.rgbBlendState.blendMode,o.alphaBlendState.blendMode=f.alphaBlendState.blendMode),O&&(v.blendFuncSeparate(f.rgbBlendState.blendSrcFactor,f.rgbBlendState.blendDstFactor,f.alphaBlendState.blendSrcFactor,f.alphaBlendState.blendDstFactor),o.rgbBlendState.blendSrcFactor=f.rgbBlendState.blendSrcFactor,o.alphaBlendState.blendSrcFactor=f.alphaBlendState.blendSrcFactor,o.rgbBlendState.blendDstFactor=f.rgbBlendState.blendDstFactor,o.alphaBlendState.blendDstFactor=f.alphaBlendState.blendDstFactor)},a.prototype.setMegaState=function(o){var f=this.gl,v=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var T=0;T<o.attachmentsState.length;T++)this.applyAttachmentStateIndexed(T,v.attachmentsState[0],o.attachmentsState[0]);else Ia(o.attachmentsState.length===1),this.applyAttachmentState(v.attachmentsState[0],o.attachmentsState[0]);PE(v.blendConstant,o.blendConstant)||(f.blendColor(o.blendConstant.r,o.blendConstant.g,o.blendConstant.b,o.blendConstant.a),Fy(v.blendConstant,o.blendConstant)),v.depthCompare!==o.depthCompare&&(f.depthFunc(o.depthCompare),v.depthCompare=o.depthCompare),!!v.depthWrite!=!!o.depthWrite&&(f.depthMask(o.depthWrite),v.depthWrite=o.depthWrite),!!v.stencilWrite!=!!o.stencilWrite&&(f.stencilMask(o.stencilWrite?255:0),v.stencilWrite=o.stencilWrite);var O=!1;if(!wg(v.stencilFront,o.stencilFront)){O=!0;var L=o.stencilFront,F=L.passOp,H=L.failOp,ie=L.depthFailOp,ge=L.compare;(v.stencilFront.passOp!==F||v.stencilFront.failOp!==H||v.stencilFront.depthFailOp!==ie)&&(f.stencilOpSeparate(f.FRONT,H,ie,F),v.stencilFront.passOp=F,v.stencilFront.failOp=H,v.stencilFront.depthFailOp=ie),v.stencilFront.compare!==ge&&(this.setStencilReference(0),v.stencilFront.compare=ge)}if(!wg(v.stencilBack,o.stencilBack)){O=!0;var Te=o.stencilBack,F=Te.passOp,H=Te.failOp,ie=Te.depthFailOp,ge=Te.compare;(v.stencilBack.passOp!==F||v.stencilBack.failOp!==H||v.stencilBack.depthFailOp!==ie)&&(f.stencilOpSeparate(f.BACK,H,ie,F),v.stencilBack.passOp=F,v.stencilBack.failOp=H,v.stencilBack.depthFailOp=ie),v.stencilBack.compare!==ge&&(this.setStencilReference(0),v.stencilBack.compare=ge)}(v.stencilFront.mask!==o.stencilFront.mask||v.stencilBack.mask!==o.stencilBack.mask)&&(O=!0,v.stencilFront.mask=o.stencilFront.mask,v.stencilBack.mask=o.stencilBack.mask),O&&this.applyStencil(),v.cullMode!==o.cullMode&&(v.cullMode===ld.NONE?f.enable(f.CULL_FACE):o.cullMode===ld.NONE&&f.disable(f.CULL_FACE),o.cullMode===ld.BACK?f.cullFace(f.BACK):o.cullMode===ld.FRONT?f.cullFace(f.FRONT):o.cullMode===ld.FRONT_AND_BACK&&f.cullFace(f.FRONT_AND_BACK),v.cullMode=o.cullMode),v.frontFace!==o.frontFace&&(f.frontFace(o.frontFace),v.frontFace=o.frontFace),v.polygonOffset!==o.polygonOffset&&(o.polygonOffset?f.enable(f.POLYGON_OFFSET_FILL):f.disable(f.POLYGON_OFFSET_FILL),v.polygonOffset=o.polygonOffset),(v.polygonOffsetFactor!==o.polygonOffsetFactor||v.polygonOffsetUnits!==o.polygonOffsetUnits)&&(f.polygonOffset(o.polygonOffsetFactor,o.polygonOffsetUnits),v.polygonOffsetFactor=o.polygonOffsetFactor,v.polygonOffsetUnits=o.polygonOffsetUnits)},a.prototype.validatePipelineFormats=function(o){for(var f=0;f<this.currentColorAttachments.length;f++)var v=this.currentColorAttachments[f];this.currentDepthStencilAttachment&&Ia(this.currentDepthStencilAttachment.format===o.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&Ia(this.currentSampleCount===o.sampleCount)},a.prototype.setPipeline=function(o){var f=this;if(this.renderBundle){this.renderBundle.push(function(){return f.setPipeline(o)});return}this.currentPipeline=o,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var v=this.currentPipeline.program;if(this.useProgram(v),v.compileState===Hf.NeedsBind){var T=this.gl,O=v.gl_program,L=v.descriptor,F=$E(L.vertex.glsl,rx);if(Uo(T))for(var H=0;H<F.length;H++){var ie=(0,_o.CR)(F[H],2),ge=ie[1],Te=T.getUniformBlockIndex(O,ge);Te!==-1&&Te!==4294967295&&T.uniformBlockBinding(O,Te,H)}for(var Ve=$E(L.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),H=0;H<Ve.length;H++){var Mt=(0,_o.CR)(Ve[H],3),rn=Mt[1],Rn=Mt[2],hr=T.getUniformLocation(O,rn);T.uniform1i(hr,parseInt(Rn))}v.compileState=Hf.ReadyToUse}},a.prototype.setVertexInput=function(o,f,v){var T,O,L=this,F;if(this.renderBundle){this.renderBundle.push(function(){return L.setVertexInput(o,f,v)});return}if(o!==null){Ia(this.currentPipeline.inputLayout===o);var H=o;this.bindVAO(H.vao);for(var ie=this.gl,ge=0;ge<H.vertexBufferDescriptors.length;ge++){var Te=H.vertexBufferDescriptors[ge],Ve=Te.arrayStride,Mt=Te.attributes;try{for(var rn=(T=void 0,(0,_o.XA)(Mt)),Rn=rn.next();!Rn.done;Rn=rn.next()){var hr=Rn.value,Nr=hr.shaderLocation,jn=hr.offset,ci=Uo(ie)?Nr:(F=H.program.attributes[Nr])===null||F===void 0?void 0:F.location;if(!(0,Cf.Z)(ci)){var ji=f[ge];if(ji===null)continue;var To=hr.vertexFormat;ie.bindBuffer(ie.ARRAY_BUFFER,zm(ji.buffer));var Ji=(ji.offset||0)+jn;ie.vertexAttribPointer(ci,To.size,To.type,To.normalized,Ve,Ji)}}}catch(Gi){T={error:Gi}}finally{try{Rn&&!Rn.done&&(O=rn.return)&&O.call(rn)}finally{if(T)throw T.error}}}if(Ia(v!==null==(H.indexBufferFormat!==null)),v!==null){var Hr=v.buffer;Ia(Hr.usage===Ss.INDEX),ie.bindBuffer(ie.ELEMENT_ARRAY_BUFFER,zm(Hr)),this.currentIndexBufferByteOffset=v.offset||0}else this.currentIndexBufferByteOffset=null}else Ia(this.currentPipeline.inputLayout===null),Ia(v===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},a.prototype.setStencilReference=function(o){this.currentStencilRef!==o&&(this.currentStencilRef=o,this.applyStencil())},a.prototype.draw=function(o,f,v,T){var O,L=this;if(this.renderBundle){this.renderBundle.push(function(){return L.draw(o,f,v,T)});return}var F=this.gl,H=this.currentPipeline;if(f){var ie=[H.drawMode,v||0,o,f];Uo(F)?F.drawArraysInstanced.apply(F,(0,_o.ev)([],(0,_o.CR)(ie),!1)):(O=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(O,(0,_o.ev)([],(0,_o.CR)(ie),!1))}else F.drawArrays(H.drawMode,v,o);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(o/3*Math.max(f,1))},a.prototype.drawIndexed=function(o,f,v,T,O){var L,F=this;if(this.renderBundle){this.renderBundle.push(function(){return F.drawIndexed(o,f,v,T,O)});return}var H=this.gl,ie=this.currentPipeline,ge=Cv(ie.inputLayout),Te=Cv(this.currentIndexBufferByteOffset)+v*ge.indexBufferCompByteSize;if(f){var Ve=[ie.drawMode,o,ge.indexBufferType,Te,f];Uo(H)?H.drawElementsInstanced.apply(H,(0,_o.ev)([],(0,_o.CR)(Ve),!1)):(L=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(L,(0,_o.ev)([],(0,_o.CR)(Ve),!1))}else H.drawElements(ie.drawMode,o,ge.indexBufferType,Te);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(o/3*Math.max(f,1))},a.prototype.drawIndirect=function(o,f){},a.prototype.drawIndexedIndirect=function(o,f){},a.prototype.beginOcclusionQuery=function(o){var f=this.gl;if(Uo(f)){var v=this.currentRenderPassDescriptor.occlusionQueryPool;f.beginQuery(v.gl_query_type,v.gl_query[o])}},a.prototype.endOcclusionQuery=function(){var o=this.gl;if(Uo(o)){var f=this.currentRenderPassDescriptor.occlusionQueryPool;o.endQuery(f.gl_query_type)}},a.prototype.pipelineQueryReady=function(o){var f=o;return this.queryProgramReady(f.program)},a.prototype.pipelineForceReady=function(o){},a.prototype.endPass=function(){for(var o=this.gl,f=Uo(o),v=this.currentColorResolveTos.length===1&&this.currentColorResolveTos[0]===this.scTexture,T=!1,O=0;O<this.currentColorAttachments.length;O++){var L=this.currentColorAttachments[O];if(L!==null){var F=this.currentColorResolveTos[O],H=!1;F!==null&&(Ia(L.width===F.width&&L.height===F.height),this.setScissorRectEnabled(!1),v||(f&&o.bindFramebuffer(o.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&f&&this.bindFramebufferAttachment(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,L,this.currentColorAttachmentLevels[O])),H=!0,v||(F===this.scTexture?o.bindFramebuffer(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,this.scPlatformFramebuffer):(o.bindFramebuffer(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&o.framebufferTexture2D(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,F.gl_texture,this.currentColorResolveToLevels[O]))),v||(f?(o.blitFramebuffer(0,0,L.width,L.height,0,0,F.width,F.height,o.COLOR_BUFFER_BIT,o.LINEAR),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(L,F)),T=!0),this.currentRenderPassDescriptor.colorStore[O]||!v&&!H&&(o.bindFramebuffer(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,o.COLOR_ATTACHMENT0,L,this.currentColorAttachmentLevels[O])),v||o.bindFramebuffer(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var ie=this.currentDepthStencilAttachment;if(ie){var ge=this.currentDepthStencilResolveTo,H=!1;ge&&(Ia(ie.width===ge.width&&ie.height===ge.height),this.setScissorRectEnabled(!1),v||(o.bindFramebuffer(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),o.bindFramebuffer(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,ie),this.bindFramebufferDepthStencilAttachment(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,ge))),H=!0,v||(f&&o.blitFramebuffer(0,0,ie.width,ie.height,0,0,ge.width,ge.height,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,null)),T=!0),!v&&!this.currentRenderPassDescriptor.depthStencilStore&&(H||(o.bindFramebuffer(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,ie),H=!0),f&&o.invalidateFramebuffer(o.READ_FRAMEBUFFER,[o.DEPTH_STENCIL_ATTACHMENT])),!v&&H&&o.bindFramebuffer(f?Tn.READ_FRAMEBUFFER:Tn.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}!v&&!T&&o.bindFramebuffer(f?Tn.DRAW_FRAMEBUFFER:Tn.FRAMEBUFFER,null)},a.prototype.setScissorRectEnabled=function(o){if(this.currentScissorEnabled!==o){var f=this.gl;o?f.enable(f.SCISSOR_TEST):f.disable(f.SCISSOR_TEST),this.currentScissorEnabled=o}},a.prototype.applyStencil=function(){(0,Cf.Z)(this.currentStencilRef)||(this.gl.stencilFuncSeparate(Tn.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(Tn.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},a.prototype.getFallbackTexture=function(o){var f=o.gl_target,v=o.formatKind;if(f===Tn.TEXTURE_2D)return v===Oc.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(f===Tn.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(f===Tn.TEXTURE_3D)return this.fallbackTexture3D;if(f===Tn.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},a.prototype.submitBlitRenderPass=function(o,f){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:Ss.VERTEX|Ss.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:Av.VERTEX,attributes:[{format:or.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:Pl.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[or.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:Ov(x0)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:o.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:o}));var v=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var T=this.createRenderPass({colorAttachment:[o],colorResolveTo:[f],colorClearColor:[DA]}),O=this.getCanvas(),L=O.width,F=O.height;T.setPipeline(this.blitRenderPipeline),T.setBindings(this.blitBindings),T.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),T.setViewport(0,0,L,F),this.gl.disable(this.gl.BLEND),T.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=v,this.inBlitRenderPass=!1},a}(),eS=function(){function a(o){this.pluginOptions=o}return a.prototype.createSwapChain=function(o){return(0,_o.mG)(this,void 0,void 0,function(){var f,v,T,O,L,F,H,ie,ge,Te,Ve,Mt,rn;return(0,_o.Jh)(this,function(Rn){return f=this.pluginOptions,v=f.targets,T=f.xrCompatible,O=f.antialias,L=O===void 0?!1:O,F=f.preserveDrawingBuffer,H=F===void 0?!1:F,ie=f.premultipliedAlpha,ge=ie===void 0?!0:ie,Te=f.shaderDebug,Ve=f.trackResources,Mt={antialias:L,preserveDrawingBuffer:H,stencil:!0,premultipliedAlpha:ge,xrCompatible:T},this.handleContextEvents(o),v.includes("webgl2")&&(rn=o.getContext("webgl2",Mt)||o.getContext("experimental-webgl2",Mt)),!rn&&v.includes("webgl1")&&(rn=o.getContext("webgl",Mt)||o.getContext("experimental-webgl",Mt)),[2,new cC(rn,{shaderDebug:Te,trackResources:Ve})]})})},a.prototype.handleContextEvents=function(o){var f=this.pluginOptions,v=f.onContextLost,T=f.onContextRestored,O=f.onContextCreationError;O&&o.addEventListener("webglcontextcreationerror",O,!1),v&&o.addEventListener("webglcontextlost",v,!1),T&&o.addEventListener("webglcontextrestored",T,!1)},a}();let oc;const S0=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&S0.decode();let Og=null;function m_(){return(Og===null||Og.byteLength===0)&&(Og=new Uint8Array(oc.memory.buffer)),Og}function v_(a,o){return a=a>>>0,S0.decode(m_().subarray(a,a+o))}const Q0=new Array(128).fill(void 0);Q0.push(void 0,null,!0,!1);let Gy=Q0.length;function uC(a){Gy===Q0.length&&Q0.push(Q0.length+1);const o=Gy;return Gy=Q0[o],Q0[o]=a,o}function g_(a){return Q0[a]}function tS(a){a<132||(Q0[a]=Gy,Gy=a)}function y_(a){const o=g_(a);return tS(a),o}let Pv=0;const Xy=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},fC=typeof Xy.encodeInto=="function"?function(a,o){return Xy.encodeInto(a,o)}:function(a,o){const f=Xy.encode(a);return o.set(f),{read:a.length,written:f.length}};function Pd(a,o,f){if(f===void 0){const F=Xy.encode(a),H=o(F.length,1)>>>0;return m_().subarray(H,H+F.length).set(F),Pv=F.length,H}let v=a.length,T=o(v,1)>>>0;const O=m_();let L=0;for(;L<v;L++){const F=a.charCodeAt(L);if(F>127)break;O[T+L]=F}if(L!==v){L!==0&&(a=a.slice(L)),T=f(T,v,v=L+a.length*3,1)>>>0;const F=m_().subarray(T+L,T+v),H=fC(a,F);L+=H.written}return Pv=L,T}let Yy=null;function __(){return(Yy===null||Yy.byteLength===0)&&(Yy=new Int32Array(oc.memory.buffer)),Yy}function nS(a,o,f){let v,T;try{const F=oc.__wbindgen_add_to_stack_pointer(-16),H=Pd(a,oc.__wbindgen_malloc,oc.__wbindgen_realloc),ie=Pv,ge=Pd(o,oc.__wbindgen_malloc,oc.__wbindgen_realloc),Te=Pv;oc.glsl_compile(F,H,ie,ge,Te,f);var O=__()[F/4+0],L=__()[F/4+1];return v=O,T=L,v_(O,L)}finally{oc.__wbindgen_add_to_stack_pointer(16),oc.__wbindgen_free(v,T,1)}}class $y{static __wrap(o){o=o>>>0;const f=Object.create($y.prototype);return f.__wbg_ptr=o,f}__destroy_into_raw(){const o=this.__wbg_ptr;return this.__wbg_ptr=0,o}free(){const o=this.__destroy_into_raw();oc.__wbg_wgslcomposer_free(o)}constructor(){const o=oc.wgslcomposer_new();return $y.__wrap(o)}load_composable(o){const f=Pd(o,oc.__wbindgen_malloc,oc.__wbindgen_realloc),v=Pv;oc.wgslcomposer_load_composable(this.__wbg_ptr,f,v)}wgsl_compile(o){let f,v;try{const L=oc.__wbindgen_add_to_stack_pointer(-16),F=Pd(o,oc.__wbindgen_malloc,oc.__wbindgen_realloc),H=Pv;oc.wgslcomposer_wgsl_compile(L,this.__wbg_ptr,F,H);var T=__()[L/4+0],O=__()[L/4+1];return f=T,v=O,v_(T,O)}finally{oc.__wbindgen_add_to_stack_pointer(16),oc.__wbindgen_free(f,v,1)}}}function b_(a,o){return FM(this,null,function*(){if(typeof Response=="function"&&a instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(a,o)}catch(v){if(a.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",v);else throw v}const f=yield a.arrayBuffer();return yield WebAssembly.instantiate(f,o)}else{const f=yield WebAssembly.instantiate(a,o);return f instanceof WebAssembly.Instance?{instance:f,module:a}:f}})}function rS(){const a={};return a.wbg={},a.wbg.__wbindgen_string_new=function(o,f){const v=v_(o,f);return uC(v)},a.wbg.__wbindgen_object_drop_ref=function(o){y_(o)},a.wbg.__wbg_log_1d3ae0273d8f4f8a=function(o){console.log(g_(o))},a.wbg.__wbg_log_576ca876af0d4a77=function(o,f){console.log(g_(o),g_(f))},a.wbg.__wbindgen_throw=function(o,f){throw new Error(v_(o,f))},a}function iS(a,o){return oc=a.exports,ix.__wbindgen_wasm_module=o,Yy=null,Og=null,oc}function ix(a){return FM(this,null,function*(){if(oc!==void 0)return oc;const o=rS();(typeof a=="string"||typeof Request=="function"&&a instanceof Request||typeof URL=="function"&&a instanceof URL)&&(a=fetch(a));const{instance:f,module:v}=yield b_(yield a,o);return iS(f,v)})}var Qu;(function(a){a[a.COPY_SRC=1]="COPY_SRC",a[a.COPY_DST=2]="COPY_DST",a[a.TEXTURE_BINDING=4]="TEXTURE_BINDING",a[a.STORAGE_BINDING=8]="STORAGE_BINDING",a[a.STORAGE=8]="STORAGE",a[a.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Qu||(Qu={}));var ox;(function(a){a[a.READ=1]="READ",a[a.WRITE=2]="WRITE"})(ox||(ox={}));function hC(a){var o=0;return a&hu.SAMPLED&&(o|=Qu.TEXTURE_BINDING|Qu.COPY_DST|Qu.COPY_SRC),a&hu.STORAGE&&(o|=Qu.TEXTURE_BINDING|Qu.STORAGE_BINDING|Qu.COPY_SRC|Qu.COPY_DST),a&hu.RENDER_TARGET&&(o|=Qu.RENDER_ATTACHMENT|Qu.TEXTURE_BINDING|Qu.COPY_SRC|Qu.COPY_DST),o}function x_(a){if(a===or.U8_R_NORM)return"r8unorm";if(a===or.S8_R_NORM)return"r8snorm";if(a===or.U8_RG_NORM)return"rg8unorm";if(a===or.S8_RG_NORM)return"rg8snorm";if(a===or.U32_R)return"r32uint";if(a===or.S32_R)return"r32sint";if(a===or.F32_R)return"r32float";if(a===or.U16_RG)return"rg16uint";if(a===or.S16_RG)return"rg16sint";if(a===or.F16_RG)return"rg16float";if(a===or.U8_RGBA_RT)return"bgra8unorm";if(a===or.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(a===or.U8_RGBA_NORM)return"rgba8unorm";if(a===or.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(a===or.S8_RGBA_NORM)return"rgba8snorm";if(a===or.U32_RG)return"rg32uint";if(a===or.S32_RG)return"rg32sint";if(a===or.F32_RG)return"rg32float";if(a===or.U16_RGBA)return"rgba16uint";if(a===or.S16_RGBA)return"rgba16sint";if(a===or.F16_RGBA)return"rgba16float";if(a===or.F32_RGBA)return"rgba32float";if(a===or.U32_RGBA)return"rgba32uint";if(a===or.S32_RGBA)return"rgba32sint";if(a===or.D24)return"depth24plus";if(a===or.D24_S8)return"depth24plus-stencil8";if(a===or.D32F)return"depth32float";if(a===or.D32F_S8)return"depth32float-stencil8";if(a===or.BC1)return"bc1-rgba-unorm";if(a===or.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(a===or.BC2)return"bc2-rgba-unorm";if(a===or.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(a===or.BC3)return"bc3-rgba-unorm";if(a===or.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(a===or.BC4_SNORM)return"bc4-r-snorm";if(a===or.BC4_UNORM)return"bc4-r-unorm";if(a===or.BC5_SNORM)return"bc5-rg-snorm";if(a===or.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function dC(a){if(a===rs.TEXTURE_2D)return"2d";if(a===rs.TEXTURE_CUBE_MAP)return"2d";if(a===rs.TEXTURE_2D_ARRAY)return"2d";if(a===rs.TEXTURE_3D)return"3d";throw new Error("whoops")}function pC(a){if(a===rs.TEXTURE_2D)return"2d";if(a===rs.TEXTURE_CUBE_MAP)return"cube";if(a===rs.TEXTURE_2D_ARRAY)return"2d-array";if(a===rs.TEXTURE_3D)return"3d";throw new Error("whoops")}function mC(a){var o=0;return a&Ss.INDEX&&(o|=GPUBufferUsage.INDEX),a&Ss.VERTEX&&(o|=GPUBufferUsage.VERTEX),a&Ss.UNIFORM&&(o|=GPUBufferUsage.UNIFORM),a&Ss.STORAGE&&(o|=GPUBufferUsage.STORAGE),a&Ss.COPY_SRC&&(o|=GPUBufferUsage.COPY_SRC),a&Ss.INDIRECT&&(o|=GPUBufferUsage.INDIRECT),o|=GPUBufferUsage.COPY_DST,o}function ax(a){if(a===Of.CLAMP_TO_EDGE)return"clamp-to-edge";if(a===Of.REPEAT)return"repeat";if(a===Of.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function oS(a){if(a===sa.BILINEAR)return"linear";if(a===sa.POINT)return"nearest";throw new Error("whoops")}function vC(a){if(a===Hl.LINEAR)return"linear";if(a===Hl.NEAREST)return"nearest";if(a===Hl.NO_MIP)return"nearest";throw new Error("whoops")}function Rg(a){var o=a;return o.gpuBuffer}function gC(a){var o=a;return o.gpuSampler}function yC(a){var o=a;return o.querySet}function _C(a){if(a===t_.OcclusionConservative)return"occlusion";throw new Error("whoops")}function aS(a){switch(a){case Pl.TRIANGLES:return"triangle-list";case Pl.POINTS:return"point-list";case Pl.TRIANGLE_STRIP:return"triangle-strip";case Pl.LINES:return"line-list";case Pl.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function Um(a){if(a===ld.NONE)return"none";if(a===ld.FRONT)return"front";if(a===ld.BACK)return"back";throw new Error("whoops")}function sS(a){if(a===By.CCW)return"ccw";if(a===By.CW)return"cw";throw new Error("whoops")}function bC(a,o){return{topology:aS(a),cullMode:Um(o.cullMode),frontFace:sS(o.frontFace)}}function lS(a){if(a===ls.ZERO)return"zero";if(a===ls.ONE)return"one";if(a===ls.SRC)return"src";if(a===ls.ONE_MINUS_SRC)return"one-minus-src";if(a===ls.DST)return"dst";if(a===ls.ONE_MINUS_DST)return"one-minus-dst";if(a===ls.SRC_ALPHA)return"src-alpha";if(a===ls.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(a===ls.DST_ALPHA)return"dst-alpha";if(a===ls.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(a===ls.CONST)return"constant";if(a===ls.ONE_MINUS_CONSTANT)return"one-minus-constant";if(a===ls.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function xC(a){if(a===hf.ADD)return"add";if(a===hf.SUBSTRACT)return"subtract";if(a===hf.REVERSE_SUBSTRACT)return"reverse-subtract";if(a===hf.MIN)return"min";if(a===hf.MAX)return"max";throw new Error("whoops")}function sx(a){return{operation:xC(a.blendMode),srcFactor:lS(a.blendSrcFactor),dstFactor:lS(a.blendDstFactor)}}function Ky(a){return a.blendMode===hf.ADD&&a.blendSrcFactor===ls.ONE&&a.blendDstFactor===ls.ZERO}function PP(a){if(!(Ky(a.rgbBlendState)&&Ky(a.alphaBlendState)))return{color:sx(a.rgbBlendState),alpha:sx(a.alphaBlendState)}}function IP(a,o){return{format:x_(o),blend:PP(a),writeMask:a.channelWriteMask}}function LP(a,o){return o.attachmentsState.map(function(f,v){return IP(f,a[v])})}function lx(a){if(a===Ya.NEVER)return"never";if(a===Ya.LESS)return"less";if(a===Ya.EQUAL)return"equal";if(a===Ya.LEQUAL)return"less-equal";if(a===Ya.GREATER)return"greater";if(a===Ya.NOTEQUAL)return"not-equal";if(a===Ya.GEQUAL)return"greater-equal";if(a===Ya.ALWAYS)return"always";throw new Error("whoops")}function qy(a){if(a===Cc.KEEP)return"keep";if(a===Cc.REPLACE)return"replace";if(a===Cc.ZERO)return"zero";if(a===Cc.DECREMENT_CLAMP)return"decrement-clamp";if(a===Cc.DECREMENT_WRAP)return"decrement-wrap";if(a===Cc.INCREMENT_CLAMP)return"increment-clamp";if(a===Cc.INCREMENT_WRAP)return"increment-wrap";if(a===Cc.INVERT)return"invert";throw new Error("whoops")}function DP(a,o){if(!(0,Cf.Z)(a))return{format:x_(a),depthWriteEnabled:!!o.depthWrite,depthCompare:lx(o.depthCompare),depthBias:o.polygonOffset?o.polygonOffsetUnits:0,depthBiasSlopeScale:o.polygonOffset?o.polygonOffsetFactor:0,stencilFront:{compare:lx(o.stencilFront.compare),passOp:qy(o.stencilFront.passOp),failOp:qy(o.stencilFront.failOp),depthFailOp:qy(o.stencilFront.depthFailOp)},stencilBack:{compare:lx(o.stencilBack.compare),passOp:qy(o.stencilBack.passOp),failOp:qy(o.stencilBack.failOp),depthFailOp:qy(o.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function NP(a){if(a!==null){if(a===or.U16_R)return"uint16";if(a===or.U32_R)return"uint32";throw new Error("whoops")}}function E_(a){if(a===Av.VERTEX)return"vertex";if(a===Av.INSTANCE)return"instance";throw new Error("whoops")}function EC(a){if(a===or.U8_R)return"uint8x2";if(a===or.U8_RG)return"uint8x2";if(a===or.U8_RGB)return"uint8x4";if(a===or.U8_RGBA)return"uint8x4";if(a===or.U8_RG_NORM)return"unorm8x2";if(a===or.U8_RGBA_NORM)return"unorm8x4";if(a===or.S8_RGB_NORM)return"snorm8x4";if(a===or.S8_RGBA_NORM)return"snorm8x4";if(a===or.U16_RG_NORM)return"unorm16x2";if(a===or.U16_RGBA_NORM)return"unorm16x4";if(a===or.S16_RG_NORM)return"snorm16x2";if(a===or.S16_RGBA_NORM)return"snorm16x4";if(a===or.S16_RG)return"uint16x2";if(a===or.F16_RG)return"float16x2";if(a===or.F16_RGBA)return"float16x4";if(a===or.F32_R)return"float32";if(a===or.F32_RG)return"float32x2";if(a===or.F32_RGB)return"float32x3";if(a===or.F32_RGBA)return"float32x4";throw"whoops"}function cx(a){var o=fh(a);switch(o){case oi.BC1:case oi.BC2:case oi.BC3:case oi.BC4_SNORM:case oi.BC4_UNORM:case oi.BC5_SNORM:case oi.BC5_UNORM:return!0;default:return!1}}function SC(a){var o=fh(a);switch(o){case oi.BC1:case oi.BC2:case oi.BC3:case oi.BC4_SNORM:case oi.BC4_UNORM:case oi.BC5_SNORM:case oi.BC5_UNORM:return 4;default:return 1}}function ux(a,o,f,v){switch(f===void 0&&(f=!1),a){case or.S8_R:case or.S8_R_NORM:case or.S8_RG_NORM:case or.S8_RGB_NORM:case or.S8_RGBA_NORM:{var T=o instanceof ArrayBuffer?new Int8Array(o):new Int8Array(o);return v&&T.set(new Int8Array(v)),T}case or.U8_R:case or.U8_R_NORM:case or.U8_RG:case or.U8_RG_NORM:case or.U8_RGB:case or.U8_RGB_NORM:case or.U8_RGB_SRGB:case or.U8_RGBA:case or.U8_RGBA_NORM:case or.U8_RGBA_SRGB:{var O=o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o);return v&&O.set(new Uint8Array(v)),O}case or.S16_R:case or.S16_RG:case or.S16_RG_NORM:case or.S16_RGB_NORM:case or.S16_RGBA:case or.S16_RGBA_NORM:{var L=o instanceof ArrayBuffer?new Int16Array(o):new Int16Array(f?o/2:o);return v&&L.set(new Int16Array(v)),L}case or.U16_R:case or.U16_RGB:case or.U16_RGBA_5551:case or.U16_RGBA_NORM:case or.U16_RG_NORM:case or.U16_R_NORM:{var F=o instanceof ArrayBuffer?new Uint16Array(o):new Uint16Array(f?o/2:o);return v&&F.set(new Uint16Array(v)),F}case or.S32_R:{var H=o instanceof ArrayBuffer?new Int32Array(o):new Int32Array(f?o/4:o);return v&&H.set(new Int32Array(v)),H}case or.U32_R:case or.U32_RG:{var ie=o instanceof ArrayBuffer?new Uint32Array(o):new Uint32Array(f?o/4:o);return v&&ie.set(new Uint32Array(v)),ie}case or.F32_R:case or.F32_RG:case or.F32_RGB:case or.F32_RGBA:{var ge=o instanceof ArrayBuffer?new Float32Array(o):new Float32Array(f?o/4:o);return v&&ge.set(new Float32Array(v)),ge}}var Te=o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o);return v&&Te.set(new Uint8Array(v)),Te}function cS(a){var o=(a&32768)>>15,f=(a&31744)>>10,v=a&1023;return f===0?(o?-1:1)*Math.pow(2,-14)*(v/Math.pow(2,10)):f==31?v?NaN:(o?-1:1)*(1/0):(o?-1:1)*Math.pow(2,f-15)*(1+v/Math.pow(2,10))}function fx(a){switch(a){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var Ju=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this)||this;return O.id=v,O.device=T,O}return o.prototype.destroy=function(){},o}(OE),jm=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;H.type=Ds.Bindings;var ie=O.pipeline;Ia(!!ie);var ge=O.uniformBufferBindings,Te=O.storageBufferBindings,Ve=O.samplerBindings,Mt=O.storageTextureBindings;H.numUniformBuffers=(ge==null?void 0:ge.length)||0;var rn=[[],[],[],[]],Rn=0;if(ge&&ge.length)for(var hr=0;hr<ge.length;hr++){var Nr=O.uniformBufferBindings[hr],jn=Nr.binding,ci=Nr.size,ji=Nr.offset,To=Nr.buffer,Ji={buffer:Rg(To),offset:ji!=null?ji:0,size:ci};rn[0].push({binding:jn!=null?jn:Rn++,resource:Ji})}if(Ve&&Ve.length){Rn=0;for(var hr=0;hr<Ve.length;hr++){var Hr=(0,_o.pi)((0,_o.pi)({},Ve[hr]),BE),jn=O.samplerBindings[hr],Gi=jn.texture!==null?jn.texture:H.device.getFallbackTexture(Hr);Hr.dimension=Gi.dimension,Hr.formatKind=r_(Gi.format);var ja=Gi.gpuTextureView;if(rn[1].push({binding:(L=jn.textureBinding)!==null&&L!==void 0?L:Rn++,resource:ja}),jn.samplerBinding!==-1){var ys=jn.sampler!==null?jn.sampler:H.device.getFallbackSampler(Hr),$o=gC(ys);rn[1].push({binding:(F=jn.samplerBinding)!==null&&F!==void 0?F:Rn++,resource:$o})}}}if(Te&&Te.length){Rn=0;for(var hr=0;hr<Te.length;hr++){var cs=O.storageBufferBindings[hr],jn=cs.binding,ci=cs.size,ji=cs.offset,To=cs.buffer,Ji={buffer:Rg(To),offset:ji!=null?ji:0,size:ci};rn[2].push({binding:jn!=null?jn:Rn++,resource:Ji})}}if(Mt&&Mt.length){Rn=0;for(var hr=0;hr<Mt.length;hr++){var Zs=O.storageTextureBindings[hr],jn=Zs.binding,Gi=Zs.texture,ja=Gi.gpuTextureView;rn[3].push({binding:jn!=null?jn:Rn++,resource:ja})}}var Dh=rn.findLastIndex(function(Id){return!!Id.length});return H.gpuBindGroup=rn.map(function(Id,Nh){return Nh<=Dh&&H.device.device.createBindGroup({layout:ie.getBindGroupLayout(Nh),entries:Id})}),H}return o}(Ju),TC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.Buffer;var F=O.usage,H=O.viewOrSize,ie=!!(F&Ss.MAP_READ);L.usage=mC(F),ie&&(L.usage=Ss.MAP_READ|Ss.COPY_DST);var ge=!(0,cp.Z)(H);if(L.view=(0,cp.Z)(H)?null:H,L.size=(0,cp.Z)(H)?qu(H,4):qu(H.byteLength,4),(0,cp.Z)(H))L.gpuBuffer=L.device.device.createBuffer({usage:L.usage,size:L.size,mappedAtCreation:ie?ge:!1});else{L.gpuBuffer=L.device.device.createBuffer({usage:L.usage,size:L.size,mappedAtCreation:!0});var Te=H&&H.constructor||Float32Array;new Te(L.gpuBuffer.getMappedRange()).set(H),L.gpuBuffer.unmap()}return L}return o.prototype.setSubData=function(f,v,T,O){T===void 0&&(T=0),O===void 0&&(O=0);var L=this.gpuBuffer;O=O||v.byteLength,O=Math.min(O,this.size-f);var F=v.byteOffset+T,H=F+O,ie=O+3&-4;if(ie!==O){var ge=new Uint8Array(v.buffer.slice(F,H));v=new Uint8Array(ie),v.set(ge),T=0,F=0,H=ie,O=ie}for(var Te=1024*1024*15,Ve=0;H-(F+Ve)>Te;)this.device.device.queue.writeBuffer(L,f+Ve,v.buffer,F+Ve,Te),Ve+=Te;this.device.device.queue.writeBuffer(L,f+Ve,v.buffer,F+Ve,O-Ve)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gpuBuffer.destroy()},o}(Ju),hx=function(){function a(){this.gpuComputePassEncoder=null}return a.prototype.dispatchWorkgroups=function(o,f,v){this.gpuComputePassEncoder.dispatchWorkgroups(o,f,v)},a.prototype.dispatchWorkgroupsIndirect=function(o,f){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(o.gpuBuffer,f)},a.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},a.prototype.beginComputePass=function(o){Ia(this.gpuComputePassEncoder===null),this.frameCommandEncoder=o,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},a.prototype.setPipeline=function(o){var f=o,v=Cv(f.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(v)},a.prototype.setBindings=function(o){var f=this,v=o;v.gpuBindGroup.forEach(function(T,O){T&&f.gpuComputePassEncoder.setBindGroup(O,v.gpuBindGroup[O])})},a.prototype.pushDebugGroup=function(o){this.gpuComputePassEncoder.pushDebugGroup(o)},a.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},a.prototype.insertDebugMarker=function(o){this.gpuComputePassEncoder.insertDebugMarker(o)},a}(),uS=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.ComputePipeline,L.gpuComputePipeline=null,L.descriptor=O;var F=O.program,H=F.computeStage;if(H===null)return L;var ie={layout:"auto",compute:(0,_o.pi)({},H)};return L.gpuComputePipeline=L.device.device.createComputePipeline(ie),L.name!==void 0&&(L.gpuComputePipeline.label=L.name),L}return o.prototype.getBindGroupLayout=function(f){return this.gpuComputePipeline.getBindGroupLayout(f)},o}(Ju),wC=function(a){(0,_o.ZT)(o,a);function o(f){var v,T,O,L,F=f.id,H=f.device,ie=f.descriptor,ge=a.call(this,{id:F,device:H})||this;ge.type=Ds.InputLayout;var Te=[];try{for(var Ve=(0,_o.XA)(ie.vertexBufferDescriptors),Mt=Ve.next();!Mt.done;Mt=Ve.next()){var rn=Mt.value,Rn=rn.arrayStride,hr=rn.stepMode,Nr=rn.attributes;Te.push({arrayStride:Rn,stepMode:E_(hr),attributes:[]});try{for(var jn=(O=void 0,(0,_o.XA)(Nr)),ci=jn.next();!ci.done;ci=jn.next()){var ji=ci.value,To=ji.shaderLocation,Ji=ji.format,Hr=ji.offset;Te[Te.length-1].attributes.push({shaderLocation:To,format:EC(Ji),offset:Hr})}}catch(Gi){O={error:Gi}}finally{try{ci&&!ci.done&&(L=jn.return)&&L.call(jn)}finally{if(O)throw O.error}}}}catch(Gi){v={error:Gi}}finally{try{Mt&&!Mt.done&&(T=Ve.return)&&T.call(Ve)}finally{if(v)throw v.error}}return ge.indexFormat=NP(ie.indexBufferFormat),ge.buffers=Te,ge}return o}(Ju),fS=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;return L.type=Ds.Program,L.vertexStage=null,L.fragmentStage=null,L.computeStage=null,L.descriptor=O,O.vertex&&(L.vertexStage=L.createShaderStage(O.vertex,"vertex")),O.fragment&&(L.fragmentStage=L.createShaderStage(O.fragment,"fragment")),O.compute&&(L.computeStage=L.createShaderStage(O.compute,"compute")),L}return o.prototype.setUniformsLegacy=function(f){},o.prototype.createShaderStage=function(f,v){var T,O,L=f.glsl,F=f.wgsl,H=f.entryPoint,ie=f.postprocess,ge=!1,Te=F;if(!Te)try{Te=this.device.glsl_compile(L,v,ge)}catch(Nr){throw console.error(Nr,L),new Error("whoops")}var Ve=function(Nr){if(!Te.includes(Nr))return"continue";Te=Te.replace("var T_".concat(Nr,": texture_2d<f32>;"),"var T_".concat(Nr,": texture_depth_2d;")),Te=Te.replace(new RegExp("textureSample\\(T_".concat(Nr,"(.*)\\);$"),"gm"),function(jn,ci){return"vec4<f32>(textureSample(T_".concat(Nr).concat(ci,"), 0.0, 0.0, 0.0);")})};try{for(var Mt=(0,_o.XA)(["u_TextureFramebufferDepth"]),rn=Mt.next();!rn.done;rn=Mt.next()){var Rn=rn.value;Ve(Rn)}}catch(Nr){T={error:Nr}}finally{try{rn&&!rn.done&&(O=Mt.return)&&O.call(Mt)}finally{if(T)throw T.error}}ie&&(Te=ie(Te));var hr=this.device.device.createShaderModule({code:Te});return{module:hr,entryPoint:H||"main"}},o}(Ju),AC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Ds.QueryPool;var F=O.elemCount,H=O.type;return L.querySet=L.device.device.createQuerySet({type:_C(H),count:F}),L.resolveBuffer=L.device.device.createBuffer({size:F*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),L.cpuBuffer=L.device.device.createBuffer({size:F*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),L.results=null,L}return o.prototype.queryResultOcclusion=function(f){return this.results===null?null:this.results[f]!==BigInt(0)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},o}(Ju),CC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this,{id:v,device:T})||this;return O.type=Ds.Readback,O}return o.prototype.readTexture=function(f,v,T,O,L,F,H,ie){return H===void 0&&(H=0),(0,_o.mG)(this,void 0,void 0,function(){var ge,Te,Ve,Mt,rn,Rn,hr,Nr;return(0,_o.Jh)(this,function(jn){return ge=f,Te=0,Ve=fx(ge.gpuTextureformat),Mt=Math.ceil(O/Ve.width)*Ve.length,rn=Math.ceil(Mt/256)*256,Rn=rn*L,hr=this.device.createBuffer({usage:Ss.STORAGE|Ss.MAP_READ|Ss.COPY_DST,hint:cd.STATIC,viewOrSize:Rn}),Nr=this.device.device.createCommandEncoder(),Nr.copyTextureToBuffer({texture:ge.gpuTexture,mipLevel:0,origin:{x:v,y:T,z:Math.max(Te,0)}},{buffer:hr.gpuBuffer,offset:0,bytesPerRow:rn},{width:O,height:L,depthOrArrayLayers:1}),this.device.device.queue.submit([Nr.finish()]),[2,this.readBuffer(hr,0,F.byteLength===Rn?F:null,H,Rn,ge.format,!0,!1,Mt,rn,L)]})})},o.prototype.readTextureSync=function(f,v,T,O,L,F,H,ie){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},o.prototype.readBuffer=function(f,v,T,O,L,F,H,ie,ge,Te,Ve){var Mt=this;v===void 0&&(v=0),T===void 0&&(T=null),L===void 0&&(L=0),F===void 0&&(F=or.U8_RGB),H===void 0&&(H=!1),ge===void 0&&(ge=0),Te===void 0&&(Te=0),Ve===void 0&&(Ve=0);var rn=f,Rn=L||rn.size,hr=T||rn.view,Nr=hr&&hr.constructor&&hr.constructor.BYTES_PER_ELEMENT||Vb(F),jn=rn;if(!(rn.usage&Ss.MAP_READ&&rn.usage&Ss.COPY_DST)){var ci=this.device.device.createCommandEncoder();jn=this.device.createBuffer({usage:Ss.STORAGE|Ss.MAP_READ|Ss.COPY_DST,hint:cd.STATIC,viewOrSize:Rn}),ci.copyBufferToBuffer(rn.gpuBuffer,v,jn.gpuBuffer,0,Rn),this.device.device.queue.submit([ci.finish()])}return new Promise(function(ji,To){jn.gpuBuffer.mapAsync(ox.READ,v,Rn).then(function(){var Ji=jn.gpuBuffer.getMappedRange(v,Rn),Hr=hr;if(H)Hr===null?Hr=ux(F,Rn,!0,Ji):Hr=ux(F,Hr.buffer,void 0,Ji);else if(Hr===null)switch(Nr){case 1:Hr=new Uint8Array(Rn),Hr.set(new Uint8Array(Ji));break;case 2:Hr=Mt.getHalfFloatAsFloatRGBAArrayBuffer(Rn/2,Ji);break;case 4:Hr=new Float32Array(Rn/4),Hr.set(new Float32Array(Ji));break}else switch(Nr){case 1:Hr=new Uint8Array(Hr.buffer),Hr.set(new Uint8Array(Ji));break;case 2:Hr=Mt.getHalfFloatAsFloatRGBAArrayBuffer(Rn/2,Ji,hr);break;case 4:var Gi=hr&&hr.constructor||Float32Array;Hr=new Gi(Hr.buffer),Hr.set(new Gi(Ji));break}if(ge!==Te){Nr===1&&!H&&(ge*=2,Te*=2);for(var ja=new Uint8Array(Hr.buffer),ys=ge,$o=0,cs=1;cs<Ve;++cs){$o=cs*Te;for(var Zs=0;Zs<ge;++Zs)ja[ys++]=ja[$o++]}Nr!==0&&!H?Hr=new Float32Array(ja.buffer,0,ys/4):Hr=new Uint8Array(ja.buffer,0,ys)}jn.gpuBuffer.unmap(),ji(Hr)},function(Ji){return To(Ji)})})},o.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(f,v,T){T||(T=new Float32Array(f));for(var O=new Uint16Array(v);f--;)T[f]=cS(O[f]);return T},o}(Ju),hS=function(){function a(o){this.device=o,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return a.prototype.getEncoder=function(){var o;return((o=this.renderBundle)===null||o===void 0?void 0:o.renderBundleEncoder)||this.gpuRenderPassEncoder},a.prototype.getTextureView=function(o,f){return Ia(f<o.mipLevelCount),o.mipLevelCount===1?o.gpuTextureView:o.gpuTexture.createView({baseMipLevel:f,mipLevelCount:1})},a.prototype.setRenderPassDescriptor=function(o){var f,v,T,O,L,F;this.descriptor=o,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var H=o.colorAttachment.length;this.gfxColorAttachment.length=H,this.gfxColorResolveTo.length=H;for(var ie=0;ie<o.colorAttachment.length;ie++){var ge=o.colorAttachment[ie],Te=o.colorResolveTo[ie];if(ge===null&&Te!==null&&(ge=Te,Te=null),this.gfxColorAttachment[ie]=ge,this.gfxColorResolveTo[ie]=Te,this.gfxColorAttachmentLevel[ie]=((f=o.colorAttachmentLevel)===null||f===void 0?void 0:f[ie])||0,this.gfxColorResolveToLevel[ie]=((v=o.colorResolveToLevel)===null||v===void 0?void 0:v[ie])||0,ge!==null){this.gpuColorAttachments[ie]===void 0&&(this.gpuColorAttachments[ie]={});var Ve=this.gpuColorAttachments[ie];Ve.view=this.getTextureView(ge,((T=this.gfxColorAttachmentLevel)===null||T===void 0?void 0:T[ie])||0);var Mt=(L=(O=o.colorClearColor)===null||O===void 0?void 0:O[ie])!==null&&L!==void 0?L:"load";Mt==="load"?Ve.loadOp="load":(Ve.loadOp="clear",Ve.clearValue=Mt),Ve.storeOp=!((F=o.colorStore)===null||F===void 0)&&F[ie]?"store":"discard",Ve.resolveTarget=void 0,Te!==null&&(ge.sampleCount>1?Ve.resolveTarget=this.getTextureView(Te,this.gfxColorResolveToLevel[ie]):Ve.storeOp="store")}else{this.gpuColorAttachments.length=ie,this.gfxColorAttachment.length=ie,this.gfxColorResolveTo.length=ie;break}}if(this.gfxDepthStencilAttachment=o.depthStencilAttachment,this.gfxDepthStencilResolveTo=o.depthStencilResolveTo,o.depthStencilAttachment){var rn=o.depthStencilAttachment,Ve=this.gpuDepthStencilAttachment;Ve.view=rn.gpuTextureView;var Rn=!!(Nm(rn.format)&mo.Depth);Rn?(o.depthClearValue==="load"?Ve.depthLoadOp="load":(Ve.depthLoadOp="clear",Ve.depthClearValue=o.depthClearValue),o.depthStencilStore||this.gfxDepthStencilResolveTo!==null?Ve.depthStoreOp="store":Ve.depthStoreOp="discard"):(Ve.depthLoadOp=void 0,Ve.depthStoreOp=void 0);var hr=!!(Nm(rn.format)&mo.Stencil);hr?(o.stencilClearValue==="load"?Ve.stencilLoadOp="load":(Ve.stencilLoadOp="clear",Ve.stencilClearValue=o.stencilClearValue),o.depthStencilStore||this.gfxDepthStencilResolveTo!==null?Ve.stencilStoreOp="store":Ve.stencilStoreOp="discard"):(Ve.stencilLoadOp=void 0,Ve.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=(0,Cf.Z)(o.occlusionQueryPool)?void 0:yC(o.occlusionQueryPool)},a.prototype.beginRenderPass=function(o,f){Ia(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(f),this.frameCommandEncoder=o,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},a.prototype.flipY=function(o,f){var v=this.device.swapChainHeight;return v-o-f},a.prototype.setViewport=function(o,f,v,T,O,L){O===void 0&&(O=0),L===void 0&&(L=1),this.gpuRenderPassEncoder.setViewport(o,this.flipY(f,T),v,T,O,L)},a.prototype.setScissorRect=function(o,f,v,T){this.gpuRenderPassEncoder.setScissorRect(o,this.flipY(f,T),v,T)},a.prototype.setPipeline=function(o){var f=o,v=Cv(f.gpuRenderPipeline);this.getEncoder().setPipeline(v)},a.prototype.setVertexInput=function(o,f,v){if(o!==null){var T=this.getEncoder(),O=o;v!==null&&T.setIndexBuffer(Rg(v.buffer),Cv(O.indexFormat),v.offset);for(var L=0;L<f.length;L++){var F=f[L];F!==null&&T.setVertexBuffer(L,Rg(F.buffer),F.offset)}}},a.prototype.setBindings=function(o){var f=o,v=this.getEncoder();f.gpuBindGroup.forEach(function(T,O){T&&v.setBindGroup(O,f.gpuBindGroup[O])})},a.prototype.setStencilReference=function(o){this.gpuRenderPassEncoder.setStencilReference(o)},a.prototype.draw=function(o,f,v,T){this.getEncoder().draw(o,f,v,T)},a.prototype.drawIndexed=function(o,f,v,T,O){this.getEncoder().drawIndexed(o,f,v,T,O)},a.prototype.drawIndirect=function(o,f){this.getEncoder().drawIndirect(Rg(o),f)},a.prototype.drawIndexedIndirect=function(o,f){this.getEncoder().drawIndexedIndirect(Rg(o),f)},a.prototype.beginOcclusionQuery=function(o){this.gpuRenderPassEncoder.beginOcclusionQuery(o)},a.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},a.prototype.pushDebugGroup=function(o){this.gpuRenderPassEncoder.pushDebugGroup(o)},a.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},a.prototype.insertDebugMarker=function(o){this.gpuRenderPassEncoder.insertDebugMarker(o)},a.prototype.beginBundle=function(o){this.renderBundle=o},a.prototype.endBundle=function(){this.renderBundle.finish()},a.prototype.executeBundles=function(o){this.gpuRenderPassEncoder.executeBundles(o.map(function(f){return f.renderBundle}))},a.prototype.finish=function(){var o;(o=this.gpuRenderPassEncoder)===null||o===void 0||o.end(),this.gpuRenderPassEncoder=null;for(var f=0;f<this.gfxColorAttachment.length;f++){var v=this.gfxColorAttachment[f],T=this.gfxColorResolveTo[f];v!==null&&T!==null&&v.sampleCount===1&&this.copyAttachment(T,this.gfxColorAttachmentLevel[f],v,this.gfxColorResolveToLevel[f])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},a.prototype.copyAttachment=function(o,f,v,T){Ia(v.sampleCount===1);var O={texture:v.gpuTexture,mipLevel:T},L={texture:o.gpuTexture,mipLevel:f};Ia(v.width>>>T===o.width>>>f),Ia(v.height>>>T===o.height>>>f),Ia(!!(v.usage&Qu.COPY_SRC)),Ia(!!(o.usage&Qu.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(O,L,[o.width,o.height,1])},a}(),OC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;return L.type=Ds.RenderPipeline,L.isCreatingAsync=!1,L.gpuRenderPipeline=null,L.descriptor=O,L.device.createRenderPipelineInternal(L,!1),L}return o.prototype.getBindGroupLayout=function(f){return this.gpuRenderPipeline.getBindGroupLayout(f)},o}(Ju),RC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;H.type=Ds.Sampler;var ie=O.lodMinClamp,ge=O.mipmapFilter===Hl.NO_MIP?O.lodMinClamp:O.lodMaxClamp,Te=(L=O.maxAnisotropy)!==null&&L!==void 0?L:1;return Te>1&&Ia(O.minFilter===sa.BILINEAR&&O.magFilter===sa.BILINEAR&&O.mipmapFilter===Hl.LINEAR),H.gpuSampler=H.device.device.createSampler({addressModeU:ax(O.addressModeU),addressModeV:ax(O.addressModeV),addressModeW:ax((F=O.addressModeW)!==null&&F!==void 0?F:O.addressModeU),lodMinClamp:ie,lodMaxClamp:ge,minFilter:oS(O.minFilter),magFilter:oS(O.magFilter),mipmapFilter:vC(O.mipmapFilter),compare:O.compareFunction!==void 0?lx(O.compareFunction):void 0,maxAnisotropy:Te}),H}return o}(Ju),Qy=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=f.skipCreate,F=f.sampleCount,H=a.call(this,{id:v,device:T})||this;H.type=Ds.Texture,H.flipY=!1;var ie=O.format,ge=O.dimension,Te=O.width,Ve=O.height,Mt=O.depthOrArrayLayers,rn=O.mipLevelCount,Rn=O.usage,hr=O.pixelStore;return H.flipY=!!(hr!=null&&hr.unpackFlipY),H.device.createTextureShared({format:ie,dimension:ge!=null?ge:rs.TEXTURE_2D,width:Te,height:Ve,depthOrArrayLayers:Mt!=null?Mt:1,mipLevelCount:rn!=null?rn:1,usage:Rn,sampleCount:F!=null?F:1},H,L),H}return o.prototype.textureFromImageBitmapOrCanvas=function(f,v,T){for(var O=v[0].width,L=v[0].height,F={size:{width:O,height:L,depthOrArrayLayers:T},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},H=f.createTexture(F),ie=0;ie<v.length;ie++)f.queue.copyExternalImageToTexture({source:v[ie],flipY:this.flipY},{texture:H,origin:[0,0,ie]},[O,L]);return[H,O,L]},o.prototype.isImageBitmapOrCanvases=function(f){var v=f[0];return v instanceof ImageBitmap||v instanceof HTMLCanvasElement||v instanceof OffscreenCanvas},o.prototype.isVideo=function(f){var v=f[0];return v instanceof HTMLVideoElement},o.prototype.setImageData=function(f,v){var T,O=this,L=this.device.device,F,H,ie;if(this.isImageBitmapOrCanvases(f))T=(0,_o.CR)(this.textureFromImageBitmapOrCanvas(L,f,this.depthOrArrayLayers),3),F=T[0],H=T[1],ie=T[2];else if(this.isVideo(f))F=L.importExternalTexture({source:f[0]});else{var ge=fx(this.gpuTextureformat),Te=Math.ceil(this.width/ge.width)*ge.length;f.forEach(function(Ve){L.queue.writeTexture({texture:O.gpuTexture},Ve,{bytesPerRow:Te},{width:O.width,height:O.height})})}this.width=H,this.height=ie,F&&(this.gpuTexture=F),this.gpuTextureView=this.gpuTexture.createView({dimension:pC(this.dimension)})},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gpuTexture.destroy()},o}(Ju),MC=function(a){(0,_o.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this,{id:v,device:T})||this;return O.type=Ds.RenderBundle,O.renderBundleEncoder=O.device.device.createRenderBundleEncoder({colorFormats:[O.device.swapChainFormat]}),O}return o.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},o}(Ju),PC=function(){function a(o,f,v,T,O,L){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Qu.RENDER_ATTACHMENT|Qu.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Vp.UPPER_LEFT,this.clipSpaceNearZ=bg.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=f,this.canvas=v,this.canvasContext=T,this.glsl_compile=O,this.WGSLComposer=L,this.fallbackTexture2D=this.createFallbackTexture(rs.TEXTURE_2D,Oc.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(rs.TEXTURE_2D,Oc.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(rs.TEXTURE_2D_ARRAY,Oc.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(rs.TEXTURE_3D,Oc.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(rs.TEXTURE_CUBE_MAP,Oc.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:Of.REPEAT,addressModeV:Of.REPEAT,minFilter:sa.POINT,magFilter:sa.POINT,mipmapFilter:Hl.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:Of.REPEAT,addressModeV:Of.REPEAT,minFilter:sa.POINT,magFilter:sa.POINT,mipmapFilter:Hl.NEAREST,compareFunction:Ya.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(F){console.error(F.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return a.prototype.destroy=function(){},a.prototype.configureSwapChain=function(o,f){this.swapChainWidth===o&&this.swapChainHeight===f||(this.swapChainWidth=o,this.swapChainHeight=f)},a.prototype.getOnscreenTexture=function(){var o=this.canvasContext.getCurrentTexture(),f=o.createView(),v=new Qy({id:0,device:this,descriptor:{format:or.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:rs.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return v.depthOrArrayLayers=1,v.sampleCount=1,v.gpuTexture=o,v.gpuTextureView=f,v.name="Onscreen",this.setResourceName(v,"Onscreen Texture"),v},a.prototype.getDevice=function(){return this},a.prototype.getCanvas=function(){return this.canvas},a.prototype.beginFrame=function(){Ia(this.frameCommandEncoderPool.length===0)},a.prototype.endFrame=function(){Ia(this.frameCommandEncoderPool.every(function(o){return o!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(o){return o.finish()})),this.frameCommandEncoderPool=[]},a.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},a.prototype.createBuffer=function(o){return new TC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTexture=function(o){return new Qy({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createSampler=function(o){return new RC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTarget=function(o){var f=new Qy({id:this.getNextUniqueId(),device:this,descriptor:(0,_o.pi)((0,_o.pi)({},o),{dimension:rs.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:hu.RENDER_TARGET}),sampleCount:o.sampleCount});return f.depthOrArrayLayers=1,f.type=Ds.RenderTarget,f},a.prototype.createRenderTargetFromTexture=function(o){var f=o,v=f.format,T=f.width,O=f.height,L=f.depthOrArrayLayers,F=f.sampleCount,H=f.mipLevelCount,ie=f.gpuTexture,ge=f.gpuTextureView,Te=f.usage;Ia(!!(Te&Qu.RENDER_ATTACHMENT));var Ve=new Qy({id:this.getNextUniqueId(),device:this,descriptor:{format:v,width:T,height:O,depthOrArrayLayers:L,dimension:rs.TEXTURE_2D,mipLevelCount:H,usage:Te},skipCreate:!0});return Ve.depthOrArrayLayers=L,Ve.sampleCount=F,Ve.gpuTexture=ie,Ve.gpuTextureView=ge,Ve},a.prototype.createProgram=function(o){var f,v;return!((f=o.vertex)===null||f===void 0)&&f.glsl&&(o.vertex.glsl=km(this.queryVendorInfo(),"vert",o.vertex.glsl)),!((v=o.fragment)===null||v===void 0)&&v.glsl&&(o.fragment.glsl=km(this.queryVendorInfo(),"frag",o.fragment.glsl)),new fS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createProgramSimple=function(o){return new fS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTextureShared=function(o,f,v){var T={width:o.width,height:o.height,depthOrArrayLayers:o.depthOrArrayLayers},O=o.mipLevelCount,L=x_(o.format),F=dC(o.dimension),H=hC(o.usage);if(f.gpuTextureformat=L,f.dimension=o.dimension,f.format=o.format,f.width=o.width,f.height=o.height,f.depthOrArrayLayers=o.depthOrArrayLayers,f.mipLevelCount=O,f.usage=H,f.sampleCount=o.sampleCount,!v){var ie=this.device.createTexture({size:T,mipLevelCount:O,format:L,dimension:F,sampleCount:o.sampleCount,usage:H}),ge=ie.createView();f.gpuTexture=ie,f.gpuTextureView=ge}},a.prototype.getFallbackSampler=function(o){var f=o.formatKind;return f===Oc.Depth&&o.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},a.prototype.getFallbackTexture=function(o){var f=o.dimension,v=o.formatKind;if(f===rs.TEXTURE_2D)return v===Oc.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(f===rs.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(f===rs.TEXTURE_3D)return this.fallbackTexture3D;if(f===rs.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},a.prototype.createFallbackTexture=function(o,f){var v=o===rs.TEXTURE_CUBE_MAP?6:1,T=f===Oc.Float?or.U8_RGBA_NORM:or.D24;return this.createTexture({dimension:o,format:T,usage:hu.SAMPLED,width:1,height:1,depthOrArrayLayers:v,mipLevelCount:1})},a.prototype.createBindings=function(o){return new jm({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createInputLayout=function(o){return new wC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createComputePipeline=function(o){return new uS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderPipeline=function(o){return new OC({id:this.getNextUniqueId(),device:this,descriptor:(0,_o.pi)({},o)})},a.prototype.createQueryPool=function(o,f){return new AC({id:this.getNextUniqueId(),device:this,descriptor:{type:o,elemCount:f}})},a.prototype.createRenderPipelineInternal=function(o,f){var v;if(o.gpuRenderPipeline===null){var T=o.descriptor,O=T.program,L=O.vertexStage,F=O.fragmentStage;if(!(L===null||F===null)){var H=T.megaStateDescriptor||{},ie=H.stencilBack,ge=H.stencilFront,Te=(0,_o._T)(H,["stencilBack","stencilFront"]),Ve=Ov(x0);T.megaStateDescriptor=(0,_o.pi)((0,_o.pi)((0,_o.pi)({},Ve),{stencilBack:(0,_o.pi)((0,_o.pi)({},Ve.stencilBack),ie),stencilFront:(0,_o.pi)((0,_o.pi)({},Ve.stencilFront),ge)}),Te);var Mt=T.megaStateDescriptor.attachmentsState[0];T.colorAttachmentFormats.forEach(function(ji,To){T.megaStateDescriptor.attachmentsState[To]||(T.megaStateDescriptor.attachmentsState[To]=DE(void 0,Mt))});var rn=bC((v=T.topology)!==null&&v!==void 0?v:Pl.TRIANGLES,T.megaStateDescriptor),Rn=LP(T.colorAttachmentFormats,T.megaStateDescriptor),hr=DP(T.depthStencilAttachmentFormat,T.megaStateDescriptor),Nr=void 0;T.inputLayout!==null&&(Nr=T.inputLayout.buffers);var jn=T.sampleCount,ci={layout:"auto",vertex:(0,_o.pi)((0,_o.pi)({},L),{buffers:Nr}),primitive:rn,depthStencil:hr,multisample:{count:jn},fragment:(0,_o.pi)((0,_o.pi)({},F),{targets:Rn})};o.gpuRenderPipeline=this.device.createRenderPipeline(ci)}}},a.prototype.createReadback=function(){return new CC({id:this.getNextUniqueId(),device:this})},a.prototype.createRenderBundle=function(){return new MC({id:this.getNextUniqueId(),device:this})},a.prototype.createRenderPass=function(o){var f=this.renderPassPool.pop();f===void 0&&(f=new hS(this));var v=this.frameCommandEncoderPool.pop();return v===void 0&&(v=this.device.createCommandEncoder()),f.beginRenderPass(v,o),f},a.prototype.createComputePass=function(){var o=this.computePassPool.pop();o===void 0&&(o=new hx);var f=this.frameCommandEncoderPool.pop();return f===void 0&&(f=this.device.createCommandEncoder()),o.beginComputePass(f),o},a.prototype.submitPass=function(o){var f=o;f instanceof hS?(this.frameCommandEncoderPool.push(f.frameCommandEncoder),f.finish(),this.renderPassPool.push(f)):f instanceof hx&&(this.frameCommandEncoderPool.push(f.frameCommandEncoder),f.finish(),this.computePassPool.push(f))},a.prototype.copySubTexture2D=function(o,f,v,T,O,L,F){var H=this.device.createCommandEncoder(),ie=o,ge=T,Te={texture:ge.gpuTexture,origin:[O,L,0],mipLevel:0,aspect:"all"},Ve={texture:ie.gpuTexture,origin:[f,v,0],mipLevel:0,aspect:"all"};Ia(!!(ge.usage&Qu.COPY_SRC)),Ia(!!(ie.usage&Qu.COPY_DST)),H.copyTextureToTexture(Te,Ve,[ge.width,ge.height,F||1]),this.device.queue.submit([H.finish()])},a.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},a.prototype.queryTextureFormatSupported=function(o,f,v){if(cx(o)){if(!this.featureTextureCompressionBC)return!1;var T=SC(o);return f%T!==0||v%T!==0?!1:this.featureTextureCompressionBC}switch(o){case or.U16_RGBA_NORM:return!1;case or.F32_RGBA:return!1}return!0},a.prototype.queryPlatformAvailable=function(){return!0},a.prototype.queryVendorInfo=function(){return this},a.prototype.queryRenderPass=function(o){var f=o;return f.descriptor},a.prototype.queryRenderTarget=function(o){var f=o;return f},a.prototype.setResourceName=function(o,f){if(o.name=f,o.type===Ds.Buffer){var v=o;v.gpuBuffer.label=f}else if(o.type===Ds.Texture){var v=o;v.gpuTexture.label=f,v.gpuTextureView.label=f}else if(o.type===Ds.RenderTarget){var v=o;v.gpuTexture.label=f,v.gpuTextureView.label=f}else if(o.type===Ds.Sampler){var v=o;v.gpuSampler.label=f}else if(o.type===Ds.RenderPipeline){var v=o;v.gpuRenderPipeline!==null&&(v.gpuRenderPipeline.label=f)}},a.prototype.setResourceLeakCheck=function(o,f){},a.prototype.checkForLeaks=function(){},a.prototype.programPatched=function(o){},a.prototype.pipelineQueryReady=function(o){var f=o;return f.gpuRenderPipeline!==null},a.prototype.pipelineForceReady=function(o){var f=o;this.createRenderPipelineInternal(f,!1)},a}(),IC=function(){function a(o){this.pluginOptions=o}return a.prototype.createSwapChain=function(o){return(0,_o.mG)(this,void 0,void 0,function(){var f,v,T,O,L,F,H,ie;return(0,_o.Jh)(this,function(ge){switch(ge.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];f=null,ge.label=1;case 1:return ge.trys.push([1,3,,4]),v=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:v})];case 2:return f=ge.sent(),[3,4];case 3:return T=ge.sent(),console.log(T),[3,4];case 4:return f===null?[2,null]:(O=["depth32float-stencil8","texture-compression-bc","float32-filterable"],L=O.filter(function(Te){return f.features.has(Te)}),[4,f.requestDevice({requiredFeatures:L})]);case 5:if(F=ge.sent(),F&&(H=this.pluginOptions.onContextLost,F.lost.then(function(){H&&H()})),F===null)return[2,null];if(ie=o.getContext("webgpu"),!ie)return[2,null];ge.label=6;case 6:return ge.trys.push([6,8,,9]),[4,ix(this.pluginOptions.shaderCompilerPath)];case 7:return ge.sent(),[3,9];case 8:return ge.sent(),[3,9];case 9:return[2,new PC(f,F,o,ie,nS,$y&&new $y)]}})})},a}(),LC=Object.defineProperty,dS=Object.defineProperties,DC=Object.getOwnPropertyDescriptors,pS=Object.getOwnPropertySymbols,NC=Object.prototype.hasOwnProperty,BC=Object.prototype.propertyIsEnumerable,mS=(a,o,f)=>o in a?LC(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Jy=(a,o)=>{for(var f in o||(o={}))NC.call(o,f)&&mS(a,f,o[f]);if(pS)for(var f of pS(o))BC.call(o,f)&&mS(a,f,o[f]);return a},FC=(a,o)=>dS(a,DC(o)),{isPlainObject:kC,isTypedArray:zC}=Me.lodashUtil,pl=class{constructor(a,o){this.destroyed=!1,this.uniforms={},this.reGl=a;const{vs:f,fs:v,attributes:T,uniforms:O,primitive:L,count:F,elements:H,depth:ie,cull:ge,instances:Te}=o,Ve={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Vp.LOWER_LEFT,clipSpaceNearZ:bg.NEGATIVE_ONE,supportMRT:!1},Mt={};this.options=o,O&&(this.uniforms=this.extractUniforms(O),Object.keys(O).forEach(jn=>{Mt[jn]=a.prop(jn)}));const rn={};Object.keys(T).forEach(jn=>{rn[jn]=T[jn].get()});const Rn=(0,K.Vb)(km(Ve,"frag",v,null,!1)),hr=(0,K.Vb)(km(Ve,"vert",f,null,!1)),Nr={attributes:rn,frag:Rn,uniforms:Mt,vert:hr,colorMask:a.prop("colorMask"),lineWidth:1,blend:{enable:a.prop("blend.enable"),func:a.prop("blend.func"),equation:a.prop("blend.equation"),color:a.prop("blend.color")},stencil:{enable:a.prop("stencil.enable"),mask:a.prop("stencil.mask"),func:a.prop("stencil.func"),opFront:a.prop("stencil.opFront"),opBack:a.prop("stencil.opBack")},primitive:sd[L===void 0?K.gl.TRIANGLES:L]};Te&&(Nr.instances=Te),F?Nr.count=F:H&&(Nr.elements=H.get()),this.initDepthDrawParams({depth:ie},Nr),this.initCullDrawParams({cull:ge},Nr),this.drawCommand=a(Nr),this.drawParams=Nr}updateAttributesAndElements(a,o){const f={};Object.keys(a).forEach(v=>{f[v]=a[v].get()}),this.drawParams.attributes=f,this.drawParams.elements=o.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(a){const o={};Object.keys(a).forEach(f=>{o[f]=a[f].get()}),this.drawParams.attributes=o,this.drawCommand=this.reGl(this.drawParams)}addUniforms(a){this.uniforms=Jy(Jy({},this.uniforms),this.extractUniforms(a))}draw(a,o){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const f=Jy(Jy({},this.uniforms),this.extractUniforms(a.uniforms||{})),v={};Object.keys(f).forEach(T=>{const O=typeof f[T];O==="boolean"||O==="number"||Array.isArray(f[T])||f[T].BYTES_PER_ELEMENT?v[T]=f[T]:v[T]=f[T].get()}),v.blend=o?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(a),v.stencil=this.getStencilDrawParams(a),v.colorMask=this.getColorMaskDrawParams(a,o),this.drawCommand(v)}destroy(){var a,o;(o=(a=this.drawParams)==null?void 0:a.elements)==null||o.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(f=>{f==null||f.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:a},o){a&&(o.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:lp[a.func||K.gl.LESS],range:a.range||[0,1]})}getBlendDrawParams({blend:a}){const{enable:o,func:f,equation:v,color:T=[0,0,0,0]}=a||{};return{enable:!!o,func:{srcRGB:zb[f&&f.srcRGB||K.gl.SRC_ALPHA],srcAlpha:zb[f&&f.srcAlpha||K.gl.SRC_ALPHA],dstRGB:zb[f&&f.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:zb[f&&f.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:e_[v&&v.rgb||K.gl.FUNC_ADD],alpha:e_[v&&v.alpha||K.gl.FUNC_ADD]},color:T}}getStencilDrawParams({stencil:a}){const{enable:o,mask:f=-1,func:v={cmp:K.gl.ALWAYS,ref:0,mask:-1},opFront:T={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP},opBack:O={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}}=a||{};return{enable:!!o,mask:f,func:FC(Jy({},v),{cmp:dP[v.cmp]}),opFront:{fail:nl[T.fail],zfail:nl[T.zfail],zpass:nl[T.zpass]},opBack:{fail:nl[O.fail],zfail:nl[O.zfail],zpass:nl[O.zpass]}}}getColorMaskDrawParams({stencil:a},o){return a!=null&&a.enable&&a.opFront&&!o?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:a},o){if(a){const{enable:f,face:v=K.gl.BACK}=a;o.cull={enable:!!f,face:Ih[v]}}}extractUniforms(a){const o={};return Object.keys(a).forEach(f=>{this.extractUniformsRecursively(f,a[f],o,"")}),o}extractUniformsRecursively(a,o,f,v){if(o===null||typeof o=="number"||typeof o=="boolean"||Array.isArray(o)&&typeof o[0]=="number"||zC(o)||o===""||"resize"in o){f[`${v&&v+"."}${a}`]=o;return}kC(o)&&Object.keys(o).forEach(T=>{this.extractUniformsRecursively(T,o[T],f,`${v&&v+"."}${a}`)}),Array.isArray(o)&&o.forEach((T,O)=>{Object.keys(T).forEach(L=>{this.extractUniformsRecursively(L,T[L],f,`${v&&v+"."}${a}[${O}]`)})})}},UC=class{constructor(a,o){this.isDestroy=!1;const{data:f,type:v=K.gl.UNSIGNED_BYTE,width:T,height:O,flipY:L=!1,format:F=K.gl.RGBA,mipmap:H=!1,wrapS:ie=K.gl.CLAMP_TO_EDGE,wrapT:ge=K.gl.CLAMP_TO_EDGE,aniso:Te=0,alignment:Ve=1,premultiplyAlpha:Mt=!1,mag:rn=K.gl.NEAREST,min:Rn=K.gl.NEAREST,colorSpace:hr=K.gl.BROWSER_DEFAULT_WEBGL,x:Nr=0,y:jn=0,copy:ci=!1}=o;this.width=T,this.height=O;const ji={width:T,height:O,type:Ly[v],format:RA[F],wrapS:$a[ie],wrapT:$a[ge],mag:CE[rn],min:CE[Rn],alignment:Ve,flipY:L,colorSpace:PA[hr],premultiplyAlpha:Mt,aniso:Te,x:Nr,y:jn,copy:ci};f&&(ji.data=f),typeof H=="number"?ji.mipmap=MA[H]:typeof H=="boolean"&&(ji.mipmap=H),this.texture=a.texture(ji)}get(){return this.texture}update(a={}){this.texture(a)}bind(){this.texture._texture.bind()}resize({width:a,height:o}){this.texture.resize(a,o),this.width=a,this.height=o}getSize(){return[this.width,this.height]}destroy(){var a;this.isDestroy||(a=this.texture)==null||a.destroy(),this.isDestroy=!0}},dx=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),vS=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=a=>new pl(this.gl,a),this.createAttribute=a=>new Af(this.gl,a),this.createBuffer=a=>new $0(this.gl,a),this.createElements=a=>new Dy(this.gl,a),this.createTexture2D=a=>new UC(this.gl,a),this.createFramebuffer=a=>new Ub(this.gl,a),this.useFramebuffer=(a,o)=>{this.gl({framebuffer:a?a.get():null})(o)},this.useFramebufferAsync=(a,o)=>dx(this,null,function*(){this.gl({framebuffer:a?a.get():null})(o)}),this.clear=a=>{var o;const{color:f,depth:v,stencil:T,framebuffer:O=null}=a,L={color:f,depth:v,stencil:T};L.framebuffer=O===null?O:O.get(),(o=this.gl)==null||o.clear(L)},this.viewport=({x:a,y:o,width:f,height:v})=>{this.gl._gl.viewport(a,o,f,v),this.width=f,this.height=v,this.gl._refresh()},this.readPixels=a=>{const{framebuffer:o,x:f,y:v,width:T,height:O}=a,L={x:f,y:v,width:T,height:O};return o&&(L.framebuffer=o.get()),this.gl.read(L)},this.readPixelsAsync=a=>dx(this,null,function*(){return this.readPixels(a)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var a,o,f;this.canvas=null,(f=(o=(a=this.gl)==null?void 0:a._gl)==null?void 0:o.getExtension("WEBGL_lose_context"))==null||f.loseContext(),this.gl.destroy(),this.gl=null}}init(a,o,f){return dx(this,null,function*(){this.canvas=a,f?this.gl=f:this.gl=yield new Promise((v,T)=>{OA()({canvas:this.canvas,attributes:{alpha:!0,antialias:o.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:o.preserveDrawingBuffer,stencil:o.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(O,L)=>{(O||!L)&&T(O),v(L)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const a=this.getGLContext();a.disable(a.CULL_FACE)}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},gS=class{constructor(a,o){const{buffer:f,offset:v,stride:T,normalized:O,size:L,divisor:F,shaderLocation:H}=o;this.buffer=f,this.attribute={shaderLocation:H,buffer:f.get(),offset:v||0,stride:T||0,normalized:O||!1,divisor:F||0},L&&(this.attribute.size=L)}get(){return this.buffer}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},S_={[K.gl.FLOAT]:Float32Array,[K.gl.UNSIGNED_BYTE]:Uint8Array,[K.gl.SHORT]:Int16Array,[K.gl.UNSIGNED_SHORT]:Uint16Array,[K.gl.INT]:Int32Array,[K.gl.UNSIGNED_INT]:Uint32Array},jC={[K.gl.POINTS]:Pl.POINTS,[K.gl.LINES]:Pl.LINES,[K.gl.LINE_LOOP]:Pl.LINES,[K.gl.LINE_STRIP]:Pl.LINE_STRIP,[K.gl.TRIANGLES]:Pl.TRIANGLES,[K.gl.TRIANGLE_FAN]:Pl.TRIANGLES,[K.gl.TRIANGLE_STRIP]:Pl.TRIANGLE_STRIP},BP={1:or.F32_R,2:or.F32_RG,3:or.F32_RGB,4:or.F32_RGBA},VC={[K.gl.STATIC_DRAW]:cd.STATIC,[K.gl.DYNAMIC_DRAW]:cd.DYNAMIC,[K.gl.STREAM_DRAW]:cd.DYNAMIC},Hp={[K.gl.REPEAT]:Of.REPEAT,[K.gl.CLAMP_TO_EDGE]:Of.CLAMP_TO_EDGE,[K.gl.MIRRORED_REPEAT]:Of.MIRRORED_REPEAT},e1={[K.gl.NEVER]:Ya.NEVER,[K.gl.ALWAYS]:Ya.ALWAYS,[K.gl.LESS]:Ya.LESS,[K.gl.LEQUAL]:Ya.LEQUAL,[K.gl.GREATER]:Ya.GREATER,[K.gl.GEQUAL]:Ya.GEQUAL,[K.gl.EQUAL]:Ya.EQUAL,[K.gl.NOTEQUAL]:Ya.NOTEQUAL},yS={[K.gl.FRONT]:ld.FRONT,[K.gl.BACK]:ld.BACK},_S={[K.gl.FUNC_ADD]:hf.ADD,[K.gl.MIN_EXT]:hf.MIN,[K.gl.MAX_EXT]:hf.MAX,[K.gl.FUNC_SUBTRACT]:hf.SUBSTRACT,[K.gl.FUNC_REVERSE_SUBTRACT]:hf.REVERSE_SUBSTRACT},t1={[K.gl.ZERO]:ls.ZERO,[K.gl.ONE]:ls.ONE,[K.gl.SRC_COLOR]:ls.SRC,[K.gl.ONE_MINUS_SRC_COLOR]:ls.ONE_MINUS_SRC,[K.gl.SRC_ALPHA]:ls.SRC_ALPHA,[K.gl.ONE_MINUS_SRC_ALPHA]:ls.ONE_MINUS_SRC_ALPHA,[K.gl.DST_COLOR]:ls.DST,[K.gl.ONE_MINUS_DST_COLOR]:ls.ONE_MINUS_DST,[K.gl.DST_ALPHA]:ls.DST_ALPHA,[K.gl.ONE_MINUS_DST_ALPHA]:ls.ONE_MINUS_DST_ALPHA,[K.gl.CONSTANT_COLOR]:ls.CONST,[K.gl.ONE_MINUS_CONSTANT_COLOR]:ls.ONE_MINUS_CONSTANT,[K.gl.CONSTANT_ALPHA]:ls.CONST,[K.gl.ONE_MINUS_CONSTANT_ALPHA]:ls.ONE_MINUS_CONSTANT,[K.gl.SRC_ALPHA_SATURATE]:ls.SRC_ALPHA_SATURATE},Mg={[K.gl.REPLACE]:Cc.REPLACE,[K.gl.KEEP]:Cc.KEEP,[K.gl.ZERO]:Cc.ZERO,[K.gl.INVERT]:Cc.INVERT,[K.gl.INCR]:Cc.INCREMENT_CLAMP,[K.gl.DECR]:Cc.DECREMENT_CLAMP,[K.gl.INCR_WRAP]:Cc.INCREMENT_WRAP,[K.gl.DECR_WRAP]:Cc.DECREMENT_WRAP},HC={[K.gl.ALWAYS]:Ya.ALWAYS,[K.gl.EQUAL]:Ya.EQUAL,[K.gl.GEQUAL]:Ya.GEQUAL,[K.gl.GREATER]:Ya.GREATER,[K.gl.LEQUAL]:Ya.LEQUAL,[K.gl.LESS]:Ya.LESS,[K.gl.NEVER]:Ya.NEVER,[K.gl.NOTEQUAL]:Ya.NOTEQUAL},ZC={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function px(a){return Object.prototype.toString.call(a)in ZC}function Zf(a,o){const f=a.length,v=Math.ceil(f/3),T=f+v,O=new Float32Array(T);for(let L=0;L<T;L+=4)O[L]=a[L/4*3],O[L+1]=a[L/4*3+1],O[L+2]=a[L/4*3+2],O[L+3]=o;return O}var WC=class{constructor(a,o){this.isDestroyed=!1;const{data:f,usage:v,type:T,isUBO:O,label:L}=o;let F;px(f)?F=f:F=new S_[this.type||K.gl.FLOAT](f),this.type=T,this.size=F.byteLength,this.buffer=a.createBuffer({viewOrSize:F,usage:O?Ss.UNIFORM:Ss.VERTEX,hint:VC[v||K.gl.STATIC_DRAW]}),L&&a.setResourceName(this.buffer,L)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:o}){let f;px(a)?f=a:f=new S_[this.type||K.gl.FLOAT](a),this.buffer.setSubData(o,new Uint8Array(f.buffer))}};function sl(a,o=0){return a+=o,a+=a<<10,a+=a>>>6,a>>>0}function mx(a){return a+=a<<3,a^=a>>>11,a+=a<<15,a>>>0}function Pg(){return 0}var bS=class{constructor(){this.keys=[],this.values=[]}},n1=class{constructor(a,o){this.keyEqualFunc=a,this.keyHashFunc=o,this.buckets=new Map}findBucketIndex(a,o){for(let f=0;f<a.keys.length;f++)if(this.keyEqualFunc(o,a.keys[f]))return f;return-1}findBucket(a){const o=this.keyHashFunc(a);return this.buckets.get(o)}get(a){const o=this.findBucket(a);if(o===void 0)return null;const f=this.findBucketIndex(o,a);return f<0?null:o.values[f]}add(a,o){const f=this.keyHashFunc(a);this.buckets.get(f)===void 0&&this.buckets.set(f,new bS);const v=this.buckets.get(f);v.keys.push(a),v.values.push(o)}delete(a){const o=this.findBucket(a);if(o===void 0)return;const f=this.findBucketIndex(o,a);f!==-1&&(o.keys.splice(f,1),o.values.splice(f,1))}clear(){this.buckets.clear()}size(){let a=0;for(const o of this.buckets.values())a+=o.values.length;return a}*values(){for(const a of this.buckets.values())for(let o=a.values.length-1;o>=0;o--)yield a.values[o]}};function xS(a,o){return a=sl(a,o.blendMode),a=sl(a,o.blendSrcFactor),a=sl(a,o.blendDstFactor),a}function GC(a,o){return a=xS(a,o.rgbBlendState),a=xS(a,o.alphaBlendState),a=sl(a,o.channelWriteMask),a}function XC(a,o){return a=sl(a,o.r<<24|o.g<<16|o.b<<8|o.a),a}function YC(a,o){var f,v,T,O,L,F,H,ie;for(let ge=0;ge<o.attachmentsState.length;ge++)a=GC(a,o.attachmentsState[ge]);return a=XC(a,o.blendConstant||ky),a=sl(a,o.depthCompare),a=sl(a,o.depthWrite?1:0),a=sl(a,(f=o.stencilFront)==null?void 0:f.compare),a=sl(a,(v=o.stencilFront)==null?void 0:v.passOp),a=sl(a,(T=o.stencilFront)==null?void 0:T.failOp),a=sl(a,(O=o.stencilFront)==null?void 0:O.depthFailOp),a=sl(a,(L=o.stencilBack)==null?void 0:L.compare),a=sl(a,(F=o.stencilBack)==null?void 0:F.passOp),a=sl(a,(H=o.stencilBack)==null?void 0:H.failOp),a=sl(a,(ie=o.stencilBack)==null?void 0:ie.depthFailOp),a=sl(a,o.stencilWrite?1:0),a=sl(a,o.cullMode),a=sl(a,o.frontFace?1:0),a=sl(a,o.polygonOffset?1:0),a}function $C(a){let o=0;o=sl(o,a.program.id),a.inputLayout!==null&&(o=sl(o,a.inputLayout.id)),o=YC(o,a.megaStateDescriptor);for(let f=0;f<a.colorAttachmentFormats.length;f++)o=sl(o,a.colorAttachmentFormats[f]||0);return o=sl(o,a.depthStencilAttachmentFormat||0),mx(o)}function KC(a){let o=0;if(a.samplerBindings)for(let f=0;f<a.samplerBindings.length;f++){const v=a.samplerBindings[f];v!==null&&v.texture!==null&&(o=sl(o,v.texture.id))}if(a.uniformBufferBindings)for(let f=0;f<a.uniformBufferBindings.length;f++){const v=a.uniformBufferBindings[f];v!==null&&v.buffer!==null&&(o=sl(o,v.buffer.id),o=sl(o,v.binding),o=sl(o,v.offset),o=sl(o,v.size))}if(a.storageBufferBindings)for(let f=0;f<a.storageBufferBindings.length;f++){const v=a.storageBufferBindings[f];v!==null&&v.buffer!==null&&(o=sl(o,v.buffer.id),o=sl(o,v.binding),o=sl(o,v.offset),o=sl(o,v.size))}if(a.storageTextureBindings)for(let f=0;f<a.storageTextureBindings.length;f++){const v=a.storageTextureBindings[f];v!==null&&v.texture!==null&&(o=sl(o,v.texture.id),o=sl(o,v.binding))}return mx(o)}function qC(a,o){var f,v,T,O;return((f=a.vertex)==null?void 0:f.glsl)===((v=o.vertex)==null?void 0:v.glsl)&&((T=a.fragment)==null?void 0:T.glsl)===((O=o.fragment)==null?void 0:O.glsl)}function QC(a){var o,f;return{vertex:{glsl:(o=a.vertex)==null?void 0:o.glsl},fragment:{glsl:(f=a.fragment)==null?void 0:f.glsl}}}var r1=class{constructor(a){this.device=a,this.bindingsCache=new n1(jA,KC),this.renderPipelinesCache=new n1(AP,$C),this.inputLayoutsCache=new n1(WA,Pg),this.programCache=new n1(qC,Pg)}createBindings(a){var o;let f=this.bindingsCache.get(a);if(f===null){const v=YA(a);v.uniformBufferBindings=(o=v.uniformBufferBindings)==null?void 0:o.filter(({size:T})=>T&&T>0),f=this.device.createBindings(v),this.bindingsCache.add(v,f)}return f}createRenderPipeline(a){let o=this.renderPipelinesCache.get(a);if(o===null){const f=$A(a);f.colorAttachmentFormats=f.colorAttachmentFormats.filter(v=>v),o=this.device.createRenderPipeline(f),this.renderPipelinesCache.add(f,o)}return o}createInputLayout(a){a.vertexBufferDescriptors=a.vertexBufferDescriptors.filter(f=>!!f);let o=this.inputLayoutsCache.get(a);if(o===null){const f=QA(a);o=this.device.createInputLayout(f),this.inputLayoutsCache.add(f,o)}return o}createProgram(a){let o=this.programCache.get(a);if(o===null){const f=QC(a);o=this.device.createProgram(a),this.programCache.add(f,o)}return o}destroy(){for(const a of this.bindingsCache.values())a.destroy();for(const a of this.renderPipelinesCache.values())a.destroy();for(const a of this.inputLayoutsCache.values())a.destroy();for(const a of this.programCache.values())a.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},Ig=class{constructor(a,o){const{data:f,type:v,count:T=0}=o;let O;px(f)?O=f:O=new S_[this.type||K.gl.UNSIGNED_INT](f),this.type=v,this.count=T,this.indexBuffer=a.createBuffer({viewOrSize:O,usage:Ss.INDEX})}get(){return this.indexBuffer}subData({data:a}){let o;px(a)?o=a:o=new S_[this.type||K.gl.UNSIGNED_INT](a),this.indexBuffer.setSubData(0,new Uint8Array(o.buffer))}destroy(){this.indexBuffer.destroy()}};function Lg(a){return!!(a&&a.texture)}var ES=class{constructor(a,o){this.device=a,this.options=o,this.isDestroy=!1;const{wrapS:f=K.gl.CLAMP_TO_EDGE,wrapT:v=K.gl.CLAMP_TO_EDGE,aniso:T,mag:O=K.gl.NEAREST,min:L=K.gl.NEAREST}=o;this.createTexture(o),this.sampler=a.createSampler({addressModeU:Hp[f],addressModeV:Hp[v],minFilter:L===K.gl.NEAREST?sa.POINT:sa.BILINEAR,magFilter:O===K.gl.NEAREST?sa.POINT:sa.BILINEAR,mipmapFilter:Hl.NO_MIP,maxAnisotropy:T})}createTexture(a){const{type:o=K.gl.UNSIGNED_BYTE,width:f,height:v,flipY:T=!1,format:O=K.gl.RGBA,alignment:L=1,usage:F=K.v2.SAMPLED,unorm:H=!1,label:ie}=a;let{data:ge}=a;this.width=f,this.height=v;let Te=or.U8_RGBA_RT;if(o===K.gl.UNSIGNED_BYTE&&O===K.gl.RGBA)Te=H?or.U8_RGBA_NORM:or.U8_RGBA_RT;else if(o===K.gl.UNSIGNED_BYTE&&O===K.gl.LUMINANCE)Te=or.U8_LUMINANCE;else if(o===K.gl.FLOAT&&O===K.gl.LUMINANCE)Te=or.F32_LUMINANCE;else if(o===K.gl.FLOAT&&O===K.gl.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(ge&&(ge=Zf(ge,0)),Te=or.F32_RGBA):Te=or.F32_RGB;else if(o===K.gl.FLOAT&&O===K.gl.RGBA)Te=or.F32_RGBA;else if(o===K.gl.FLOAT&&O===K.gl.RED)Te=or.F32_R;else throw new Error(`create texture error, type: ${o}, format: ${O}`);this.texture=this.device.createTexture({format:Te,width:f,height:v,usage:F===K.v2.SAMPLED?hu.SAMPLED:hu.RENDER_TARGET,pixelStore:{unpackFlipY:T,packAlignment:L},mipLevelCount:1}),ie&&this.device.setResourceName(this.texture,ie),ge&&this.texture.setImageData([ge])}get(){return this.texture}update(a){const{data:o}=a;this.texture.setImageData([o])}bind(){}resize({width:a,height:o}){(this.width!==a||this.height!==o)&&this.destroy(),this.options.width=a,this.options.height=o,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var a;!this.isDestroy&&!this.texture.destroyed&&((a=this.texture)==null||a.destroy()),this.isDestroy=!0}},vx=class{constructor(a,o){this.device=a,this.options=o,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(a=!1){const{width:o,height:f,color:v}=this.options;v&&(Lg(v)?(a&&v.resize({width:o,height:f}),this.colorTexture=v.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=v.width,this.height=v.height):o&&f&&(this.colorTexture=this.device.createTexture({format:or.U8_RGBA_RT,usage:hu.RENDER_TARGET,width:o,height:f}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=o,this.height=f))}createDepthRenderTarget(a=!1){const{width:o,height:f,depth:v}=this.options;v&&(Lg(v)?(a&&v.resize({width:o,height:f}),this.depthTexture=v.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=v.width,this.height=v.height):o&&f&&(this.depthTexture=this.device.createTexture({format:or.D24_S8,usage:hu.RENDER_TARGET,width:o,height:f}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=o,this.height=f))}get(){return this.colorRenderTarget}destroy(){var a,o;(a=this.colorRenderTarget)==null||a.destroy(),(o=this.depthRenderTarget)==null||o.destroy()}resize({width:a,height:o}){(this.width!==a||this.height!==o)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=a,this.options.height=o,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},i1=Object.defineProperty,JC=Object.defineProperties,FP=Object.getOwnPropertyDescriptors,gx=Object.getOwnPropertySymbols,eO=Object.prototype.hasOwnProperty,tO=Object.prototype.propertyIsEnumerable,SS=(a,o,f)=>o in a?i1(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Iv=(a,o)=>{for(var f in o||(o={}))eO.call(o,f)&&SS(a,f,o[f]);if(gx)for(var f of gx(o))tO.call(o,f)&&SS(a,f,o[f]);return a},nO=(a,o)=>JC(a,FP(o)),{isPlainObject:rO,isTypedArray:iO,isNil:TS}=Me.lodashUtil,oO=class{constructor(a,o,f){this.device=a,this.options=o,this.service=f,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:v,fs:T,attributes:O,uniforms:L,count:F,elements:H,diagnosticDerivativeUniformityEnabled:ie}=o;this.options=o;const ge=ie?"":this.service.viewportOrigin===Vp.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=f.renderCache.createProgram({vertex:{glsl:v},fragment:{glsl:T,postprocess:rn=>ge+rn}}),L&&(this.uniforms=this.extractUniforms(L));const Te=[];let Ve=0;Object.keys(O).forEach(rn=>{const Rn=O[rn],hr=Rn.get();this.vertexBuffers.push(hr.get());const{offset:Nr=0,stride:jn=0,size:ci=1,divisor:ji=0,shaderLocation:To=0}=Rn.attribute;Te.push({arrayStride:jn||ci*4,stepMode:Av.VERTEX,attributes:[{format:BP[ci],shaderLocation:To,offset:Nr,divisor:ji}]}),Ve=hr.size/ci}),F||(this.options.count=Ve),H&&(this.indexBuffer=H.get());const Mt=f.renderCache.createInputLayout({vertexBufferDescriptors:Te,indexBufferFormat:H?or.U32_R:null,program:this.program});this.inputLayout=Mt,this.pipeline=this.createPipeline(o)}createPipeline(a,o){var f;const{primitive:v=K.gl.TRIANGLES,depth:T,cull:O,blend:L,stencil:F}=a,H=this.initDepthDrawParams({depth:T}),ie=!!(H&&H.enable),ge=this.initCullDrawParams({cull:O}),Te=!!(ge&&ge.enable),Ve=this.getBlendDrawParams({blend:L}),Mt=!!(Ve&&Ve.enable),rn=this.getStencilDrawParams({stencil:F}),Rn=!!(rn&&rn.enable),hr=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:jC[v],colorAttachmentFormats:[or.U8_RGBA_RT],depthStencilAttachmentFormat:or.D24_S8,megaStateDescriptor:{attachmentsState:[o?{channelWriteMask:Ku.ALL,rgbBlendState:{blendMode:hf.ADD,blendSrcFactor:ls.ONE,blendDstFactor:ls.ZERO},alphaBlendState:{blendMode:hf.ADD,blendSrcFactor:ls.ONE,blendDstFactor:ls.ZERO}}:{channelWriteMask:Rn&&rn.opFront.zpass===Cc.REPLACE?Ku.NONE:Ku.ALL,rgbBlendState:{blendMode:Mt&&Ve.equation.rgb||hf.ADD,blendSrcFactor:Mt&&Ve.func.srcRGB||ls.SRC_ALPHA,blendDstFactor:Mt&&Ve.func.dstRGB||ls.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:Mt&&Ve.equation.alpha||hf.ADD,blendSrcFactor:Mt&&Ve.func.srcAlpha||ls.ONE,blendDstFactor:Mt&&Ve.func.dstAlpha||ls.ONE}}],blendConstant:Mt?ky:void 0,depthWrite:ie,depthCompare:ie&&H.func||Ya.LESS,cullMode:Te&&ge.face||ld.NONE,stencilWrite:Rn,stencilFront:{compare:Rn?rn.func.cmp:Ya.ALWAYS,passOp:rn.opFront.zpass,failOp:rn.opFront.fail,depthFailOp:rn.opFront.zfail,mask:rn.opFront.mask},stencilBack:{compare:Rn?rn.func.cmp:Ya.ALWAYS,passOp:rn.opBack.zpass,failOp:rn.opBack.fail,depthFailOp:rn.opBack.zfail,mask:rn.opBack.mask}}});return Rn&&!TS((f=F==null?void 0:F.func)==null?void 0:f.ref)&&(hr.stencilFuncReference=F.func.ref),hr}updateAttributesAndElements(){}updateAttributes(){}addUniforms(a){this.uniforms=Iv(Iv({},this.uniforms),this.extractUniforms(a))}draw(a,o){const f=Iv(Iv({},this.options),a),{count:v=0,instances:T,elements:O,uniforms:L={},uniformBuffers:F,textures:H}=f;this.uniforms=Iv(Iv({},this.uniforms),this.extractUniforms(L));const{renderPass:ie,currentFramebuffer:ge,width:Te,height:Ve}=this.service;this.pipeline=this.createPipeline(f,o);const Mt=this.service.device,rn=Mt.swapChainHeight;if(Mt.swapChainHeight=(ge==null?void 0:ge.height)||Ve,ie.setViewport(0,0,(ge==null?void 0:ge.width)||Te,(ge==null?void 0:ge.height)||Ve),Mt.swapChainHeight=rn,ie.setPipeline(this.pipeline),TS(this.pipeline.stencilFuncReference)||ie.setStencilReference(this.pipeline.stencilFuncReference),ie.setVertexInput(this.inputLayout,this.vertexBuffers.map(Rn=>({buffer:Rn})),O?{buffer:this.indexBuffer,offset:0}:null),F&&(this.bindings=Mt.createBindings({pipeline:this.pipeline,uniformBufferBindings:F.map((Rn,hr)=>{const Nr=Rn;return{binding:hr,buffer:Nr.get(),size:Nr.size}}),samplerBindings:H==null?void 0:H.map(Rn=>({texture:Rn.texture,sampler:Rn.sampler}))})),this.bindings&&(ie.setBindings(this.bindings),Object.keys(this.uniforms).forEach(Rn=>{const hr=this.uniforms[Rn];hr instanceof ES?this.uniforms[Rn]=hr.get():hr instanceof vx&&(this.uniforms[Rn]=hr.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),O){const Rn=O.count;Rn===0?ie.draw(v,T):ie.drawIndexed(Rn,T)}else ie.draw(v,T)}destroy(){var a,o,f;(a=this.vertexBuffers)==null||a.forEach(v=>v.destroy()),(o=this.indexBuffer)==null||o.destroy(),(f=this.bindings)==null||f.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:a}){if(a)return{enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:e1[a.func||K.gl.LESS],range:a.range||[0,1]}}getBlendDrawParams({blend:a}){const{enable:o,func:f,equation:v,color:T=[0,0,0,0]}=a||{};return{enable:!!o,func:{srcRGB:t1[f&&f.srcRGB||K.gl.SRC_ALPHA],srcAlpha:t1[f&&f.srcAlpha||K.gl.SRC_ALPHA],dstRGB:t1[f&&f.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:t1[f&&f.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:_S[v&&v.rgb||K.gl.FUNC_ADD],alpha:_S[v&&v.alpha||K.gl.FUNC_ADD]},color:T}}getStencilDrawParams({stencil:a}){const{enable:o,mask:f=4294967295,func:v={cmp:K.gl.ALWAYS,ref:0,mask:4294967295},opFront:T={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP},opBack:O={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}}=a||{};return{enable:!!o,mask:f,func:nO(Iv({},v),{cmp:HC[v.cmp]}),opFront:{fail:Mg[T.fail],zfail:Mg[T.zfail],zpass:Mg[T.zpass],mask:v.mask},opBack:{fail:Mg[O.fail],zfail:Mg[O.zfail],zpass:Mg[O.zpass],mask:v.mask}}}initCullDrawParams({cull:a}){if(a){const{enable:o,face:f=K.gl.BACK}=a;return{enable:!!o,face:yS[f]}}}extractUniforms(a){const o={};return Object.keys(a).forEach(f=>{this.extractUniformsRecursively(f,a[f],o,"")}),o}extractUniformsRecursively(a,o,f,v){if(o===null||typeof o=="number"||typeof o=="boolean"||Array.isArray(o)&&typeof o[0]=="number"||iO(o)||o===""||"resize"in o){f[`${v&&v+"."}${a}`]=o;return}rO(o)&&Object.keys(o).forEach(T=>{this.extractUniformsRecursively(T,o[T],f,`${v&&v+"."}${a}`)}),Array.isArray(o)&&o.forEach((T,O)=>{Object.keys(T).forEach(L=>{this.extractUniformsRecursively(L,T[L],f,`${v&&v+"."}${a}[${O}]`)})})}};function yx(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}var Dg=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),{isUndefined:T_}=Me.lodashUtil,aO=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=a=>new oO(this.device,a,this),this.createAttribute=a=>new gS(this.device,a),this.createBuffer=a=>new WC(this.device,a),this.createElements=a=>new Ig(this.device,a),this.createTexture2D=a=>new ES(this.device,a),this.createFramebuffer=a=>new vx(this.device,a),this.useFramebuffer=(a,o)=>{this.currentFramebuffer=a,this.beginFrame(),o(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(a,o)=>Dg(this,null,function*(){this.currentFramebuffer=a,this.preRenderPass=this.renderPass,this.beginFrame(),yield o(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=a=>{const{color:o,depth:f,stencil:v,framebuffer:T=null}=a;if(T)T.clearOptions={color:o,depth:f,stencil:v};else{const O=this.queryVerdorInfo();if(O==="WebGL1"){const L=this.getGLContext();T_(v)?T_(f)||(L.clearDepth(f),L.clear(L.DEPTH_BUFFER_BIT)):(L.clearStencil(v),L.clear(L.STENCIL_BUFFER_BIT))}else if(O==="WebGL2"){const L=this.getGLContext();T_(v)?T_(f)||L.clearBufferfv(L.DEPTH,0,[f]):L.clearBufferiv(L.STENCIL,0,[v])}}},this.viewport=({width:a,height:o})=>{this.swapChain.configureSwapChain(a,o),this.createMainColorDepthRT(a,o),this.width=a,this.height=o},this.readPixels=a=>{const{framebuffer:o,x:f,y:v,width:T,height:O}=a,L=this.device.createReadback(),F=o.colorTexture,H=L.readTextureSync(F,f,this.viewportOrigin===Vp.LOWER_LEFT?v:this.height-v,T,O,new Uint8Array(T*O*4));if(this.viewportOrigin!==Vp.LOWER_LEFT)for(let ie=0;ie<H.length;ie+=4){const ge=H[ie];H[ie]=H[ie+2],H[ie+2]=ge}return L.destroy(),H},this.readPixelsAsync=a=>Dg(this,null,function*(){const{framebuffer:o,x:f,y:v,width:T,height:O}=a,L=this.device.createReadback(),F=o.colorTexture,H=yield L.readTexture(F,f,this.viewportOrigin===Vp.LOWER_LEFT?v:this.height-v,T,O,new Uint8Array(T*O*4));if(this.viewportOrigin!==Vp.LOWER_LEFT)for(let ie=0;ie<H.length;ie+=4){const ge=H[ie];H[ie]=H[ie+2],H[ie+2]=ge}return L.destroy(),H}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var a;this.canvas=null,(a=this.uniformBuffers)==null||a.forEach(o=>{o.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(a,o){return Dg(this,null,function*(){const{enableWebGPU:f,shaderCompilerPath:v,antialias:T}=o;this.canvas=a;const L=yield(f?new IC({shaderCompilerPath:v}):new eS({targets:["webgl2","webgl1"],antialias:T,onContextLost(H){console.warn("context lost",H)},onContextCreationError(H){console.warn("context creation error",H)},onContextRestored(H){console.warn("context restored",H)}})).createSwapChain(a);L.configureSwapChain(a.width,a.height),this.device=L.getDevice(),this.swapChain=L,this.renderCache=new r1(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const F=this.device.gl;this.extensionObject={OES_texture_float:!yx(F)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height)})}createMainColorDepthRT(a,o){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:or.U8_RGBA_RT,width:a,height:o,usage:hu.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:or.D24_S8,width:a,height:o,usage:hu.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:a,swapChain:o,mainColorRT:f,mainDepthRT:v}=this,T=a?a.colorRenderTarget:f,O=a?null:o.getOnscreenTexture(),L=a?a.depthRenderTarget:v,{color:F=[0,0,0,0],depth:H=1,stencil:ie=0}=(a==null?void 0:a.clearOptions)||{},ge=T?xg(F[0]*255,F[1]*255,F[2]*255,F[3]):ky,Te=L?H:void 0,Ve=L?ie:void 0,Mt=this.device.createRenderPass({colorAttachment:[T],colorResolveTo:[O],colorClearColor:[ge],colorStore:[!0],depthStencilAttachment:L,depthClearValue:Te,stencilClearValue:Ve});this.renderPass=Mt}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const a=this.device.gl;return a.getParameter(a.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}},Ng=["selectstart","selecting","selectend"],sO=class extends Wc.EventEmitter{constructor(a,o={}){super(),this.isEnable=!1,this.onDragStart=f=>{this.box.style.display="block",this.startEvent=this.endEvent=f,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=f=>{this.endEvent=f,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=f=>{this.endEvent=f,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=a,this.options=o}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:a}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const o=Me.SO.create("div",void 0,this.container);o.classList.add("l7-select-box"),a&&o.classList.add(a),o.style.display="none",this.box=o}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:a,y:o}=this.startEvent,{x:f,y:v}=this.endEvent,T=Math.min(a,f),O=Math.min(o,v),L=Math.abs(a-f),F=Math.abs(o-v);this.box.style.top=`${O}px`,this.box.style.left=`${T}px`,this.box.style.width=`${L}px`,this.box.style.height=`${F}px`}getLngLatBox(){const{lngLat:{lng:a,lat:o}}=this.startEvent,{lngLat:{lng:f,lat:v}}=this.endEvent;return(0,Me.Ol)([[a,o],[f,v]])}},lO=Object.defineProperty,cO=Object.defineProperties,uO=Object.getOwnPropertyDescriptors,wS=Object.getOwnPropertySymbols,fO=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,AS=(a,o,f)=>o in a?lO(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,hO=(a,o)=>{for(var f in o||(o={}))fO.call(o,f)&&AS(a,f,o[f]);if(wS)for(var f of wS(o))_x.call(o,f)&&AS(a,f,o[f]);return a},dO=(a,o)=>cO(a,uO(o)),fp=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),CS=class{constructor(a){const{id:o,map:f,renderer:v="device"}=a,T=(0,K.Hp)();this.container=T,f.setContainer(T,o),v==="regl"?T.rendererService=new vS:T.rendererService=new aO,this.sceneService=T.sceneService,this.mapService=T.mapService,this.iconService=T.iconService,this.fontService=T.fontService,this.controlService=T.controlService,this.layerService=T.layerService,this.debugService=T.debugService,this.debugService.setEnable(a.debug),this.markerService=T.markerService,this.interactionService=T.interactionService,this.popupService=T.popupService,this.boxSelect=new sO(this,{}),this.initComponent(o),this.sceneService.init(a),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(a){return fp(this,null,function*(){return this.sceneService.exportPng(a)})}exportMap(a){return fp(this,null,function*(){return this.sceneService.exportPng(a)})}registerRenderService(a){this.sceneService.loaded?new a(this).init():this.on("loaded",()=>{new a(this).init()})}setBgColor(a){this.mapService.setBgColor(a)}addLayer(a){this.loaded?this.preAddLayer(a):this.once("loaded",()=>{this.preAddLayer(a)})}preAddLayer(a){const o=(0,K.e7)(this.container);if(a.setContainer(o),this.sceneService.addLayer(a),a.inited){this.initTileLayer(a);const f=this.initMask(a);this.addMask(f,a.id)}else a.on("inited",()=>{this.initTileLayer(a);const f=this.initMask(a);this.addMask(f,a.id)})}initMask(a){const{mask:o,maskfence:f,maskColor:v="#000",maskOpacity:T=0}=a.getLayerConfig();return!o||!f?void 0:new vE().source(f).shape("fill").style({color:v,opacity:T})}addMask(a,o){if(!a)return;const f=this.getLayer(o);if(f){const v=(0,K.e7)(this.container);a.setContainer(v),f.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(a){return this.layerService.getLayer(a)}getLayerByName(a){return this.layerService.getLayerByName(a)}removeLayer(a,o){return fp(this,null,function*(){yield this.layerService.remove(a,o)})}removeAllLayer(){return fp(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(a){this.layerService.setEnableRender(a)}addIconFont(a,o){this.fontService.addIconFont(a,o)}addIconFonts(a){a.forEach(([o,f])=>{this.fontService.addIconFont(o,f)})}addFontFace(a,o){this.fontService.once("fontloaded",f=>{this.emit("fontloaded",f)}),this.fontService.addFontFace(a,o)}addImage(a,o){return fp(this,null,function*(){yield this.iconService.addImage(a,o)})}hasImage(a){return this.iconService.hasImage(a)}removeImage(a){this.iconService.removeImage(a)}addIconFontGlyphs(a,o){this.fontService.addIconGlyphs(o)}addControl(a){this.controlService.addControl(a,this.container)}removeControl(a){this.controlService.removeControl(a)}getControlByName(a){return this.controlService.getControlByName(a)}addMarker(a){this.markerService.addMarker(a)}addMarkerLayer(a){this.markerService.addMarkerLayer(a)}removeMarkerLayer(a){this.markerService.removeMarkerLayer(a)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(a){this.popupService.addPopup(a)}removePopup(a){this.popupService.removePopup(a)}on(a,o){var f;Ng.includes(a)?(f=this.boxSelect)==null||f.on(a,o):K.P7.includes(a)?this.sceneService.on(a,o):this.mapService.on(a,o)}once(a,o){var f;Ng.includes(a)?(f=this.boxSelect)==null||f.once(a,o):K.P7.includes(a)?this.sceneService.once(a,o):this.mapService.once(a,o)}emit(a,o){K.P7.indexOf(a)===-1?this.mapService.on(a,o):this.sceneService.emit(a,o)}off(a,o){var f;Ng.includes(a)?(f=this.boxSelect)==null||f.off(a,o):K.P7.includes(a)?this.sceneService.off(a,o):this.mapService.off(a,o)}getZoom(){return this.mapService.getZoom()}getCenter(a){return this.mapService.getCenter(a)}setCenter(a,o){return this.mapService.setCenter(a,o)}getPitch(){return this.mapService.getPitch()}setPitch(a){return this.mapService.setPitch(a)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(a){this.mapService.setRotation(a)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(a){this.mapService.panTo(a)}panBy(a,o){this.mapService.panBy(a,o)}getContainer(){return this.mapService.getContainer()}setZoom(a){this.mapService.setZoom(a)}fitBounds(a,o){const{fitBoundsOptions:f,animate:v}=this.sceneService.getSceneConfig();this.mapService.fitBounds(a,o||dO(hO({},f),{animate:v}))}setZoomAndCenter(a,o){this.mapService.setZoomAndCenter(a,o)}setMapStyle(a){this.mapService.setMapStyle(a)}setMapStatus(a){this.mapService.setMapStatus(a)}pixelToLngLat(a){return this.mapService.pixelToLngLat(a)}lngLatToPixel(a){return this.mapService.lngLatToPixel(a)}containerToLngLat(a){return this.mapService.containerToLngLat(a)}lngLatToContainer(a){return this.mapService.lngLatToContainer(a)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(a){this.container.postProcessingPass.name=new a}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(a=!0){this.boxSelect.enable(),a&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(a,o){Me.SA.REGISTERED_PROTOCOLS[a]=o}static removeProtocol(a){delete Me.SA.REGISTERED_PROTOCOLS[a]}getProtocol(a){return Me.SA.REGISTERED_PROTOCOLS[a]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(a){this.controlService.init({container:Me.SO.getContainer(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:a,logoPosition:o}=this.sceneService.getSceneConfig();a&&this.addControl(new Vd({position:o}))}initTileLayer(a){a.getSource().isTile&&(a.tileLayer=new AA(a))}},OS="2.22.1"},81957:function($t,W){"use strict";var D=function(ee,X,E){return ee<X?X:ee>E?E:ee};W.Z=D},95147:function($t,W){"use strict";var D=function(ee){return ee==null};W.Z=D},25897:function($t,W,D){"use strict";var ee=D(95456),X=function(E){return(0,ee.Z)(E,"Number")};W.Z=X},95456:function($t,W){"use strict";var D={}.toString,ee=function(X,E){return D.call(X)==="[object "+E+"]"};W.Z=ee},131:function($t,W,D){"use strict";D.r(W),D.d(W,{TinyColor:function(){return ee.C},bounds:function(){return mt},convertDecimalToHex:function(){return fe.Wl},convertHexToDecimal:function(){return fe.T6},default:function(){return gt},fromRatio:function(){return oe},hslToRgb:function(){return fe.ve},hsvToRgb:function(){return fe.WE},inputToRGB:function(){return te.uA},isReadable:function(){return ve},isValidCSSUnit:function(){return te.ky},legacyRandom:function(){return ze},mostReadable:function(){return re},names:function(){return X.R},numberInputToObject:function(){return fe.Yt},parseIntFromHex:function(){return fe.VD},random:function(){return ye},readability:function(){return E},rgbToHex:function(){return fe.vq},rgbToHsl:function(){return fe.lC},rgbToHsv:function(){return fe.py},rgbToRgb:function(){return fe.rW},rgbaToArgbHex:function(){return fe.GC},rgbaToHex:function(){return fe.s},stringInputToObject:function(){return te.uz},tinycolor:function(){return ee.H},toMsFilter:function(){return ae}});var ee=D(10274),X=D(48701);function E(Be,Re){var bt=new ee.C(Be),yt=new ee.C(Re);return(Math.max(bt.getLuminance(),yt.getLuminance())+.05)/(Math.min(bt.getLuminance(),yt.getLuminance())+.05)}function ve(Be,Re,bt){var yt,At;bt===void 0&&(bt={level:"AA",size:"small"});var bn=E(Be,Re);switch(((yt=bt.level)!==null&&yt!==void 0?yt:"AA")+((At=bt.size)!==null&&At!==void 0?At:"small")){case"AAsmall":case"AAAlarge":return bn>=4.5;case"AAlarge":return bn>=3;case"AAAsmall":return bn>=7;default:return!1}}function re(Be,Re,bt){bt===void 0&&(bt={includeFallbackColors:!1,level:"AA",size:"small"});for(var yt=null,At=0,bn=bt.includeFallbackColors,He=bt.level,Rt=bt.size,Oe=0,it=Re;Oe<it.length;Oe++){var Qe=it[Oe],$e=E(Be,Qe);$e>At&&(At=$e,yt=new ee.C(Qe))}return ve(Be,yt,{level:He,size:Rt})||!bn?yt:(bt.includeFallbackColors=!1,re(Be,["#fff","#000"],bt))}var fe=D(86500);function ae(Be,Re){var bt=new ee.C(Be),yt="#"+(0,fe.GC)(bt.r,bt.g,bt.b,bt.a),At=yt,bn=bt.gradientType?"GradientType = 1, ":"";if(Re){var He=new ee.C(Re);At="#"+(0,fe.GC)(He.r,He.g,He.b,He.a)}return"progid:DXImageTransform.Microsoft.gradient(".concat(bn,"startColorstr=").concat(yt,",endColorstr=").concat(At,")")}var Ee=D(90279);function oe(Be,Re){var bt={r:(0,Ee.JX)(Be.r),g:(0,Ee.JX)(Be.g),b:(0,Ee.JX)(Be.b)};return Be.a!==void 0&&(bt.a=Number(Be.a)),new ee.C(bt,Re)}function ze(){return new ee.C({r:Math.random(),g:Math.random(),b:Math.random()})}var te=D(1350);function ye(Be){if(Be===void 0&&(Be={}),Be.count!==void 0&&Be.count!==null){var Re=Be.count,bt=[];for(Be.count=void 0;Re>bt.length;)Be.count=null,Be.seed&&(Be.seed+=1),bt.push(ye(Be));return Be.count=Re,bt}var yt=De(Be.hue,Be.seed),At=Se(yt,Be),bn=we(yt,At,Be),He={h:yt,s:At,v:bn};return Be.alpha!==void 0&&(He.a=Be.alpha),new ee.C(He)}function De(Be,Re){var bt=Ze(Be),yt=ht(bt,Re);return yt<0&&(yt=360+yt),yt}function Se(Be,Re){if(Re.hue==="monochrome")return 0;if(Re.luminosity==="random")return ht([0,100],Re.seed);var bt=xt(Be).saturationRange,yt=bt[0],At=bt[1];switch(Re.luminosity){case"bright":yt=55;break;case"dark":yt=At-10;break;case"light":At=55;break;default:break}return ht([yt,At],Re.seed)}function we(Be,Re,bt){var yt=ce(Be,Re),At=100;switch(bt.luminosity){case"dark":At=yt+20;break;case"light":yt=(At+yt)/2;break;case"random":yt=0,At=100;break;default:break}return ht([yt,At],bt.seed)}function ce(Be,Re){for(var bt=xt(Be).lowerBounds,yt=0;yt<bt.length-1;yt++){var At=bt[yt][0],bn=bt[yt][1],He=bt[yt+1][0],Rt=bt[yt+1][1];if(Re>=At&&Re<=He){var Oe=(Rt-bn)/(He-At),it=bn-Oe*At;return Oe*Re+it}}return 0}function Ze(Be){var Re=parseInt(Be,10);if(!Number.isNaN(Re)&&Re<360&&Re>0)return[Re,Re];if(typeof Be=="string"){var bt=mt.find(function(He){return He.name===Be});if(bt){var yt=Gt(bt);if(yt.hueRange)return yt.hueRange}var At=new ee.C(Be);if(At.isValid){var bn=At.toHsv().h;return[bn,bn]}}return[0,360]}function xt(Be){Be>=334&&Be<=360&&(Be-=360);for(var Re=0,bt=mt;Re<bt.length;Re++){var yt=bt[Re],At=Gt(yt);if(At.hueRange&&Be>=At.hueRange[0]&&Be<=At.hueRange[1])return At}throw Error("Color not found")}function ht(Be,Re){if(Re===void 0)return Math.floor(Be[0]+Math.random()*(Be[1]+1-Be[0]));var bt=Be[1]||1,yt=Be[0]||0;Re=(Re*9301+49297)%233280;var At=Re/233280;return Math.floor(yt+At*(bt-yt))}function Gt(Be){var Re=Be.lowerBounds[0][0],bt=Be.lowerBounds[Be.lowerBounds.length-1][0],yt=Be.lowerBounds[Be.lowerBounds.length-1][1],At=Be.lowerBounds[0][1];return{name:Be.name,hueRange:Be.hueRange,lowerBounds:Be.lowerBounds,saturationRange:[Re,bt],brightnessRange:[yt,At]}}var mt=[{name:"monochrome",hueRange:null,lowerBounds:[[0,0],[100,0]]},{name:"red",hueRange:[-26,18],lowerBounds:[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]},{name:"orange",hueRange:[19,46],lowerBounds:[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]},{name:"yellow",hueRange:[47,62],lowerBounds:[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]},{name:"green",hueRange:[63,178],lowerBounds:[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]},{name:"blue",hueRange:[179,257],lowerBounds:[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]},{name:"purple",hueRange:[258,282],lowerBounds:[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]},{name:"pink",hueRange:[283,334],lowerBounds:[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]}],gt=ee.H},38163:function($t){$t.exports=W;function W(X,E){var ve=X&&X.type,re;if(ve==="FeatureCollection")for(re=0;re<X.features.length;re++)W(X.features[re],E);else if(ve==="GeometryCollection")for(re=0;re<X.geometries.length;re++)W(X.geometries[re],E);else if(ve==="Feature")W(X.geometry,E);else if(ve==="Polygon")D(X.coordinates,E);else if(ve==="MultiPolygon")for(re=0;re<X.coordinates.length;re++)D(X.coordinates[re],E);return X}function D(X,E){if(X.length!==0){ee(X[0],E);for(var ve=1;ve<X.length;ve++)ee(X[ve],!E)}}function ee(X,E){for(var ve=0,re=0,fe=0,ae=X.length,Ee=ae-1;fe<ae;Ee=fe++){var oe=(X[fe][0]-X[Ee][0])*(X[Ee][1]+X[fe][1]),ze=ve+oe;re+=Math.abs(ve)>=Math.abs(oe)?ve-ze+oe:oe-ze+ve,ve=ze}ve+re>=0!=!!E&&X.reverse()}},75550:function($t){"use strict";$t.exports=W;function W(D,ee){this.x=D,this.y=ee}W.prototype={clone:function(){return new W(this.x,this.y)},add:function(D){return this.clone()._add(D)},sub:function(D){return this.clone()._sub(D)},multByPoint:function(D){return this.clone()._multByPoint(D)},divByPoint:function(D){return this.clone()._divByPoint(D)},mult:function(D){return this.clone()._mult(D)},div:function(D){return this.clone()._div(D)},rotate:function(D){return this.clone()._rotate(D)},rotateAround:function(D,ee){return this.clone()._rotateAround(D,ee)},matMult:function(D){return this.clone()._matMult(D)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(D){return this.x===D.x&&this.y===D.y},dist:function(D){return Math.sqrt(this.distSqr(D))},distSqr:function(D){var ee=D.x-this.x,X=D.y-this.y;return ee*ee+X*X},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(D){return Math.atan2(this.y-D.y,this.x-D.x)},angleWith:function(D){return this.angleWithSep(D.x,D.y)},angleWithSep:function(D,ee){return Math.atan2(this.x*ee-this.y*D,this.x*D+this.y*ee)},_matMult:function(D){var ee=D[0]*this.x+D[1]*this.y,X=D[2]*this.x+D[3]*this.y;return this.x=ee,this.y=X,this},_add:function(D){return this.x+=D.x,this.y+=D.y,this},_sub:function(D){return this.x-=D.x,this.y-=D.y,this},_mult:function(D){return this.x*=D,this.y*=D,this},_div:function(D){return this.x/=D,this.y/=D,this},_multByPoint:function(D){return this.x*=D.x,this.y*=D.y,this},_divByPoint:function(D){return this.x/=D.x,this.y/=D.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var D=this.y;return this.y=this.x,this.x=-D,this},_rotate:function(D){var ee=Math.cos(D),X=Math.sin(D),E=ee*this.x-X*this.y,ve=X*this.x+ee*this.y;return this.x=E,this.y=ve,this},_rotateAround:function(D,ee){var X=Math.cos(D),E=Math.sin(D),ve=ee.x+X*(this.x-ee.x)-E*(this.y-ee.y),re=ee.y+E*(this.x-ee.x)+X*(this.y-ee.y);return this.x=ve,this.y=re,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},W.convert=function(D){return D instanceof W?D:Array.isArray(D)?new W(D[0],D[1]):D}},49296:function($t){"use strict";$t.exports=D,$t.exports.default=D;var W=1e20;function D(re,fe,ae,Ee,oe,ze){this.fontSize=re||24,this.buffer=fe===void 0?3:fe,this.cutoff=Ee||.25,this.fontFamily=oe||"sans-serif",this.fontWeight=ze||"normal",this.radius=ae||8;var te=this.size=this.fontSize+this.buffer*2,ye=te+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=te,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ye*ye),this.gridInner=new Float64Array(ye*ye),this.f=new Float64Array(ye),this.z=new Float64Array(ye+1),this.v=new Uint16Array(ye),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(te/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ee(re,fe,ae,Ee,oe,ze,te){ze.fill(W,0,fe*ae),te.fill(0,0,fe*ae);for(var ye=(fe-Ee)/2,De=0;De<oe;De++)for(var Se=0;Se<Ee;Se++){var we=(De+ye)*fe+Se+ye,ce=re.data[4*(De*Ee+Se)+3]/255;if(ce===1)ze[we]=0,te[we]=W;else if(ce===0)ze[we]=W,te[we]=0;else{var Ze=Math.max(0,.5-ce),xt=Math.max(0,ce-.5);ze[we]=Ze*Ze,te[we]=xt*xt}}}function X(re,fe,ae,Ee,oe,ze,te){for(var ye=0;ye<fe*ae;ye++){var De=Math.sqrt(Ee[ye])-Math.sqrt(oe[ye]);re[ye]=Math.round(255-255*(De/ze+te))}}D.prototype._draw=function(re,fe){var ae=this.ctx.measureText(re),Ee=ae.width,oe=2*this.buffer,ze,te,ye,De,Se,we,ce,Ze;fe&&this.useMetrics?(Se=Math.floor(ae.actualBoundingBoxAscent),Ze=this.buffer+Math.ceil(ae.actualBoundingBoxAscent),we=this.buffer,ce=this.buffer,te=Math.min(this.size,Math.ceil(ae.actualBoundingBoxRight-ae.actualBoundingBoxLeft)),De=Math.min(this.size-we,Math.ceil(ae.actualBoundingBoxAscent+ae.actualBoundingBoxDescent)),ze=te+oe,ye=De+oe,this.ctx.textBaseline="alphabetic"):(ze=te=this.size,ye=De=this.size,Se=19*this.fontSize/24,we=ce=0,Ze=this.middle,this.ctx.textBaseline="middle");var xt;te&&De&&(this.ctx.clearRect(ce,we,te,De),this.ctx.fillText(re,this.buffer,Ze),xt=this.ctx.getImageData(ce,we,te,De));var ht=new Uint8ClampedArray(ze*ye);return ee(xt,ze,ye,te,De,this.gridOuter,this.gridInner),E(this.gridOuter,ze,ye,this.f,this.v,this.z),E(this.gridInner,ze,ye,this.f,this.v,this.z),X(ht,ze,ye,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ht,metrics:{width:te,height:De,sdfWidth:ze,sdfHeight:ye,top:Se,left:0,advance:Ee}}},D.prototype.draw=function(re){return this._draw(re,!1).data},D.prototype.drawWithMetrics=function(re){return this._draw(re,!0)};function E(re,fe,ae,Ee,oe,ze){for(var te=0;te<fe;te++)ve(re,te,fe,ae,Ee,oe,ze);for(var ye=0;ye<ae;ye++)ve(re,ye*fe,1,fe,Ee,oe,ze)}function ve(re,fe,ae,Ee,oe,ze,te){var ye,De,Se,we;for(ze[0]=0,te[0]=-W,te[1]=W,ye=0;ye<Ee;ye++)oe[ye]=re[fe+ye*ae];for(ye=1,De=0,Se=0;ye<Ee;ye++){do we=ze[De],Se=(oe[ye]-oe[we]+ye*ye-we*we)/(ye-we)/2;while(Se<=te[De]&&--De>-1);De++,ze[De]=ye,te[De]=Se,te[De+1]=W}for(ye=0,De=0;ye<Ee;ye++){for(;te[De+1]<ye;)De++;we=ze[De],re[fe+ye*ae]=oe[we]+(ye-we)*(ye-we)}}},38929:function($t,W,D){$t.exports.VectorTile=D(22779),D(66024),D(59701)},22779:function($t,W,D){"use strict";var ee=D(59701);$t.exports=X;function X(ve,re){this.layers=ve.readFields(E,{},re)}function E(ve,re,fe){if(ve===3){var ae=new ee(fe,fe.readVarint()+fe.pos);ae.length&&(re[ae.name]=ae)}}},66024:function($t,W,D){"use strict";var ee=D(75550);$t.exports=X;function X(ae,Ee,oe,ze,te){this.properties={},this.extent=oe,this.type=0,this._pbf=ae,this._geometry=-1,this._keys=ze,this._values=te,ae.readFields(E,this,Ee)}function E(ae,Ee,oe){ae==1?Ee.id=oe.readVarint():ae==2?ve(oe,Ee):ae==3?Ee.type=oe.readVarint():ae==4&&(Ee._geometry=oe.pos)}function ve(ae,Ee){for(var oe=ae.readVarint()+ae.pos;ae.pos<oe;){var ze=Ee._keys[ae.readVarint()],te=Ee._values[ae.readVarint()];Ee.properties[ze]=te}}X.types=["Unknown","Point","LineString","Polygon"],X.prototype.loadGeometry=function(){var ae=this._pbf;ae.pos=this._geometry;for(var Ee=ae.readVarint()+ae.pos,oe=1,ze=0,te=0,ye=0,De=[],Se;ae.pos<Ee;){if(ze<=0){var we=ae.readVarint();oe=we&7,ze=we>>3}if(ze--,oe===1||oe===2)te+=ae.readSVarint(),ye+=ae.readSVarint(),oe===1&&(Se&&De.push(Se),Se=[]),Se.push(new ee(te,ye));else if(oe===7)Se&&Se.push(Se[0].clone());else throw new Error("unknown command "+oe)}return Se&&De.push(Se),De},X.prototype.bbox=function(){var ae=this._pbf;ae.pos=this._geometry;for(var Ee=ae.readVarint()+ae.pos,oe=1,ze=0,te=0,ye=0,De=1/0,Se=-1/0,we=1/0,ce=-1/0;ae.pos<Ee;){if(ze<=0){var Ze=ae.readVarint();oe=Ze&7,ze=Ze>>3}if(ze--,oe===1||oe===2)te+=ae.readSVarint(),ye+=ae.readSVarint(),te<De&&(De=te),te>Se&&(Se=te),ye<we&&(we=ye),ye>ce&&(ce=ye);else if(oe!==7)throw new Error("unknown command "+oe)}return[De,we,Se,ce]},X.prototype.toGeoJSON=function(ae,Ee,oe){var ze=this.extent*Math.pow(2,oe),te=this.extent*ae,ye=this.extent*Ee,De=this.loadGeometry(),Se=X.types[this.type],we,ce;function Ze(Gt){for(var mt=0;mt<Gt.length;mt++){var gt=Gt[mt],Be=180-(gt.y+ye)*360/ze;Gt[mt]=[(gt.x+te)*360/ze-180,360/Math.PI*Math.atan(Math.exp(Be*Math.PI/180))-90]}}switch(this.type){case 1:var xt=[];for(we=0;we<De.length;we++)xt[we]=De[we][0];De=xt,Ze(De);break;case 2:for(we=0;we<De.length;we++)Ze(De[we]);break;case 3:for(De=re(De),we=0;we<De.length;we++)for(ce=0;ce<De[we].length;ce++)Ze(De[we][ce]);break}De.length===1?De=De[0]:Se="Multi"+Se;var ht={type:"Feature",geometry:{type:Se,coordinates:De},properties:this.properties};return"id"in this&&(ht.id=this.id),ht};function re(ae){var Ee=ae.length;if(Ee<=1)return[ae];for(var oe=[],ze,te,ye=0;ye<Ee;ye++){var De=fe(ae[ye]);De!==0&&(te===void 0&&(te=De<0),te===De<0?(ze&&oe.push(ze),ze=[ae[ye]]):ze.push(ae[ye]))}return ze&&oe.push(ze),oe}function fe(ae){for(var Ee=0,oe=0,ze=ae.length,te=ze-1,ye,De;oe<ze;te=oe++)ye=ae[oe],De=ae[te],Ee+=(De.x-ye.x)*(ye.y+De.y);return Ee}},59701:function($t,W,D){"use strict";var ee=D(66024);$t.exports=X;function X(re,fe){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=re,this._keys=[],this._values=[],this._features=[],re.readFields(E,this,fe),this.length=this._features.length}function E(re,fe,ae){re===15?fe.version=ae.readVarint():re===1?fe.name=ae.readString():re===5?fe.extent=ae.readVarint():re===2?fe._features.push(ae.pos):re===3?fe._keys.push(ae.readString()):re===4&&fe._values.push(ve(ae))}function ve(re){for(var fe=null,ae=re.readVarint()+re.pos;re.pos<ae;){var Ee=re.readVarint()>>3;fe=Ee===1?re.readString():Ee===2?re.readFloat():Ee===3?re.readDouble():Ee===4?re.readVarint64():Ee===5?re.readVarint():Ee===6?re.readSVarint():Ee===7?re.readBoolean():null}return fe}X.prototype.feature=function(re){if(re<0||re>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[re];var fe=this._pbf.readVarint()+this._pbf.pos;return new ee(this._pbf,fe,this.extent,this._keys,this._values)}},85549:function($t,W,D){"use strict";"use client";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=D(51130),ve=D(46549);const re=ae=>{const{space:Ee,form:oe,children:ze}=ae;if(ze==null)return null;let te=ze;return oe&&(te=X.default.createElement(E.NoFormStyle,{override:!0,status:!0},te)),Ee&&(te=X.default.createElement(ve.NoCompactStyle,null,te)),te};var fe=W.default=re},45471:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.PresetStatusColorTypes=void 0,W.isPresetColor=fe,W.isPresetStatusColor=ae;var X=ee(D(861)),E=D(36496);const ve=E.PresetColors.map(Ee=>`${Ee}-inverse`),re=W.PresetStatusColorTypes=["success","processing","error","default","warning"];function fe(Ee){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat((0,X.default)(ve),(0,X.default)(E.PresetColors)).includes(Ee):E.PresetColors.includes(Ee)}function ae(Ee){return re.includes(Ee)}},49314:function($t,W,D){"use strict";"use client";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=ee(D(43273));const ve=fe=>{let ae;return typeof fe=="object"&&(fe!=null&&fe.clearIcon)?ae=fe:fe&&(ae={clearIcon:X.default.createElement(E.default,null)}),ae};var re=W.default=ve},56333:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.containerBaseZIndexOffset=W.consumerBaseZIndexOffset=W.CONTAINER_MAX_OFFSET=void 0,W.useZIndex=ye;var X=ee(D(67294)),E=ee(D(41401)),ve=D(13594),re=ee(D(96877));const fe=100,ae=10,Ee=W.CONTAINER_MAX_OFFSET=fe*ae,oe=W.containerBaseZIndexOffset={Modal:fe,Drawer:fe,Popover:fe,Popconfirm:fe,Tooltip:fe,Tour:fe},ze=W.consumerBaseZIndexOffset={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function te(De){return De in oe}function ye(De,Se){const[,we]=(0,E.default)(),ce=X.default.useContext(re.default),Ze=te(De);let xt;if(Se!==void 0)xt=[Se,Se];else{let ht=ce!=null?ce:0;Ze?ht+=(ce?0:we.zIndexPopupBase)+oe[De]:ht+=ze[De],xt=[ce===void 0?Se:ht,ht]}return xt}},53683:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getTransitionName=W.default=void 0;var ee=D(31929);const X=()=>({height:0,opacity:0}),E=ze=>{const{scrollHeight:te}=ze;return{height:te,opacity:1}},ve=ze=>({height:ze?ze.offsetHeight:0}),re=(ze,te)=>(te==null?void 0:te.deadline)===!0||te.propertyName==="height",fe=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:ee.defaultPrefixCls}-motion-collapse`,onAppearStart:X,onEnterStart:X,onAppearActive:E,onEnterActive:E,onLeaveStart:ve,onLeaveActive:X,onAppearEnd:re,onEnterEnd:re,onLeaveEnd:re,motionDeadline:500}},ae=null,Ee=(ze,te,ye)=>ye!==void 0?ye:`${ze}-${te}`;W.getTransitionName=Ee;var oe=W.default=fe},74132:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=fe,W.getOverflowOptions=X;var ee=D(9064);function X(ae,Ee,oe,ze){if(ze===!1)return{adjustX:!1,adjustY:!1};const te=ze&&typeof ze=="object"?ze:{},ye={};switch(ae){case"top":case"bottom":ye.shiftX=Ee.arrowOffsetHorizontal*2+oe,ye.shiftY=!0,ye.adjustY=!0;break;case"left":case"right":ye.shiftY=Ee.arrowOffsetVertical*2+oe,ye.shiftX=!0,ye.adjustX=!0;break}const De=Object.assign(Object.assign({},ye),te);return De.shiftX||(De.adjustX=!0),De.shiftY||(De.adjustY=!0),De}const E={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},ve={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},re=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function fe(ae){const{arrowWidth:Ee,autoAdjustOverflow:oe,arrowPointAtCenter:ze,offset:te,borderRadius:ye,visibleFirst:De}=ae,Se=Ee/2,we={};return Object.keys(E).forEach(ce=>{const Ze=ze&&ve[ce]||E[ce],xt=Object.assign(Object.assign({},Ze),{offset:[0,0],dynamicInset:!0});switch(we[ce]=xt,re.has(ce)&&(xt.autoArrow=!1),ce){case"top":case"topLeft":case"topRight":xt.offset[1]=-Se-te;break;case"bottom":case"bottomLeft":case"bottomRight":xt.offset[1]=Se+te;break;case"left":case"leftTop":case"leftBottom":xt.offset[0]=-Se-te;break;case"right":case"rightTop":case"rightBottom":xt.offset[0]=Se+te;break}const ht=(0,ee.getArrowOffsetToken)({contentRadius:ye,limitVerticalRadius:!0});if(ze)switch(ce){case"topLeft":case"bottomLeft":xt.offset[0]=-ht.arrowOffsetHorizontal-Se;break;case"topRight":case"bottomRight":xt.offset[0]=ht.arrowOffsetHorizontal+Se;break;case"leftTop":case"rightTop":xt.offset[1]=-ht.arrowOffsetHorizontal-Se;break;case"leftBottom":case"rightBottom":xt.offset[1]=ht.arrowOffsetHorizontal+Se;break}xt.overflow=X(ce,ht,Ee,oe),De&&(xt.htmlRegion="visibleFirst")}),we}},47419:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.cloneElement=re,W.isFragment=E,W.replaceElement=void 0;var X=ee(D(67294));function E(fe){return fe&&X.default.isValidElement(fe)&&fe.type===X.default.Fragment}const ve=(fe,ae,Ee)=>X.default.isValidElement(fe)?X.default.cloneElement(fe,typeof Ee=="function"?Ee(fe.props||{}):Ee):ae;W.replaceElement=ve;function re(fe,ae){return ve(fe,fe,ae)}},71434:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.getMergedStatus=void 0,W.getStatusClassNames=ve;var X=ee(D(93967));const E=null;function ve(fe,ae,Ee){return(0,X.default)({[`${fe}-status-success`]:ae==="success",[`${fe}-status-warning`]:ae==="warning",[`${fe}-status-error`]:ae==="error",[`${fe}-status-validating`]:ae==="validating",[`${fe}-has-feedback`]:Ee})}const re=(fe,ae)=>ae||fe;W.getMergedStatus=re},38882:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.canUseDocElement=void 0,Object.defineProperty(W,"isStyleSupport",{enumerable:!0,get:function(){return E.isStyleSupport}});var X=ee(D(19158)),E=D(3481);const ve=()=>(0,X.default)()&&window.document.documentElement;W.canUseDocElement=ve},60938:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(27712)),re=function(oe,ze){var te={};for(var ye in oe)Object.prototype.hasOwnProperty.call(oe,ye)&&ze.indexOf(ye)<0&&(te[ye]=oe[ye]);if(oe!=null&&typeof Object.getOwnPropertySymbols=="function")for(var De=0,ye=Object.getOwnPropertySymbols(oe);De<ye.length;De++)ze.indexOf(ye[De])<0&&Object.prototype.propertyIsEnumerable.call(oe,ye[De])&&(te[ye[De]]=oe[ye[De]]);return te};const fe={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-flex"},ae=E.forwardRef((oe,ze)=>{const te=ht=>{const{keyCode:Gt}=ht;Gt===ve.default.ENTER&&ht.preventDefault()},ye=ht=>{const{keyCode:Gt}=ht,{onClick:mt}=oe;Gt===ve.default.ENTER&&mt&&mt()},{style:De,noStyle:Se,disabled:we,tabIndex:ce=0}=oe,Ze=re(oe,["style","noStyle","disabled","tabIndex"]);let xt={};return Se||(xt=Object.assign({},fe)),we&&(xt.pointerEvents="none"),xt=Object.assign(Object.assign({},xt),De),E.createElement("div",Object.assign({role:"button",tabIndex:ce,ref:ze},Ze,{onKeyDown:te,onKeyUp:ye,style:xt}))});var Ee=W.default=ae},13594:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.devUseWarning=W.default=W.WarningContext=void 0,W.noop=ve,W.resetWarned=fe;var X=ee(D(67294)),E=ee(D(45520));function ve(){}let re=null;function fe(){re=null,(0,E.resetWarned)()}let ae=ve;const Ee=W.WarningContext=X.createContext({}),oe=W.devUseWarning=()=>{const te=()=>{};return te.deprecated=ve,te};var ze=W.default=ae},96877:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294));const E=X.default.createContext(void 0);var ve=W.default=E},93319:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=W.DisabledContextProvider=void 0;var X=ee(D(67294));const E=X.createContext(!1),ve=fe=>{let{children:ae,disabled:Ee}=fe;const oe=X.useContext(E);return X.createElement(E.Provider,{value:Ee!=null?Ee:oe},ae)};W.DisabledContextProvider=ve;var re=W.default=E},16722:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=re;var X=ee(D(67294)),E=D(29372),ve=D(3184);function re(fe){const{children:ae}=fe,[,Ee]=(0,ve.useToken)(),{motion:oe}=Ee,ze=X.useRef(!1);return ze.current=ze.current||oe===!1,ze.current?X.createElement(E.Provider,{motion:oe},ae):ae}},11380:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=D(13594);const ve=null;var re=W.default=()=>null},3236:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=W.SizeContextProvider=void 0;var X=ee(D(67294));const E=X.createContext(void 0),ve=fe=>{let{children:ae,size:Ee}=fe;const oe=X.useContext(E);return X.createElement(E.Provider,{value:Ee||oe},ae)};W.SizeContextProvider=ve;var re=W.default=E},7177:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.defaultPrefixCls=W.defaultIconPrefixCls=W.Variants=W.ConfigContext=W.ConfigConsumer=void 0;var X=ee(D(67294));const E=W.defaultPrefixCls="ant",ve=W.defaultIconPrefixCls="anticon",re=W.Variants=["outlined","borderless","filled"],fe=(oe,ze)=>ze||(oe?`${E}-${oe}`:E),ae=W.ConfigContext=X.createContext({getPrefixCls:fe,iconPrefixCls:ve}),{Consumer:Ee}=ae;W.ConfigConsumer=Ee},56301:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.getStyle=Ee,W.registerTheme=oe;var X=D(65409),E=D(131),ve=ee(D(19158)),re=D(93399),fe=ee(D(13594));const ae=`-ant-${Date.now()}-${Math.random()}`;function Ee(ze,te){const ye={},De=(ce,Ze)=>{let xt=ce.clone();return xt=(Ze==null?void 0:Ze(xt))||xt,xt.toRgbString()},Se=(ce,Ze)=>{const xt=new E.TinyColor(ce),ht=(0,X.generate)(xt.toRgbString());ye[`${Ze}-color`]=De(xt),ye[`${Ze}-color-disabled`]=ht[1],ye[`${Ze}-color-hover`]=ht[4],ye[`${Ze}-color-active`]=ht[6],ye[`${Ze}-color-outline`]=xt.clone().setAlpha(.2).toRgbString(),ye[`${Ze}-color-deprecated-bg`]=ht[0],ye[`${Ze}-color-deprecated-border`]=ht[2]};if(te.primaryColor){Se(te.primaryColor,"primary");const ce=new E.TinyColor(te.primaryColor),Ze=(0,X.generate)(ce.toRgbString());Ze.forEach((ht,Gt)=>{ye[`primary-${Gt+1}`]=ht}),ye["primary-color-deprecated-l-35"]=De(ce,ht=>ht.lighten(35)),ye["primary-color-deprecated-l-20"]=De(ce,ht=>ht.lighten(20)),ye["primary-color-deprecated-t-20"]=De(ce,ht=>ht.tint(20)),ye["primary-color-deprecated-t-50"]=De(ce,ht=>ht.tint(50)),ye["primary-color-deprecated-f-12"]=De(ce,ht=>ht.setAlpha(ht.getAlpha()*.12));const xt=new E.TinyColor(Ze[0]);ye["primary-color-active-deprecated-f-30"]=De(xt,ht=>ht.setAlpha(ht.getAlpha()*.3)),ye["primary-color-active-deprecated-d-02"]=De(xt,ht=>ht.darken(2))}return te.successColor&&Se(te.successColor,"success"),te.warningColor&&Se(te.warningColor,"warning"),te.errorColor&&Se(te.errorColor,"error"),te.infoColor&&Se(te.infoColor,"info"),`
  :root {
    ${Object.keys(ye).map(ce=>`--${ze}-${ce}: ${ye[ce]};`).join(`
`)}
  }
  `.trim()}function oe(ze,te){const ye=Ee(ze,te);(0,ve.default)()&&(0,re.updateCSS)(ye,`${ae}-dynamic-theme`)}},14893:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(3184);const X=ve=>{const[,,,,re]=(0,ee.useToken)();return re?`${ve}-css-var`:""};var E=W.default=X},5819:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=D(67294),E=ee(D(93319)),ve=ee(D(3236));function re(){const ae=(0,X.useContext)(E.default),Ee=(0,X.useContext)(ve.default);return{componentDisabled:ae,componentSize:Ee}}var fe=W.default=re},65693:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=ee(D(3236));const ve=fe=>{const ae=X.default.useContext(E.default);return X.default.useMemo(()=>fe?typeof fe=="string"?fe!=null?fe:ae:fe instanceof Function?fe(ae):ae:ae,[fe,ae])};var re=W.default=ve},25494:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=ae;var X=ee(D(67265)),E=ee(D(11102)),ve=D(13594),re=D(3184),fe=ee(D(78459));function ae(Ee,oe,ze){var te,ye;const De=(0,ve.devUseWarning)("ConfigProvider"),Se=Ee||{},we=Se.inherit===!1||!oe?Object.assign(Object.assign({},re.defaultConfig),{hashed:(te=oe==null?void 0:oe.hashed)!==null&&te!==void 0?te:re.defaultConfig.hashed,cssVar:oe==null?void 0:oe.cssVar}):oe,ce=(0,fe.default)();return(0,X.default)(()=>{var Ze,xt;if(!Ee)return oe;const ht=Object.assign({},we.components);Object.keys(Ee.components||{}).forEach(gt=>{ht[gt]=Object.assign(Object.assign({},ht[gt]),Ee.components[gt])});const Gt=`css-var-${ce.replace(/:/g,"")}`,mt=((Ze=Se.cssVar)!==null&&Ze!==void 0?Ze:we.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:ze==null?void 0:ze.prefixCls},typeof we.cssVar=="object"?we.cssVar:{}),typeof Se.cssVar=="object"?Se.cssVar:{}),{key:typeof Se.cssVar=="object"&&((xt=Se.cssVar)===null||xt===void 0?void 0:xt.key)||Gt});return Object.assign(Object.assign(Object.assign({},we),Se),{token:Object.assign(Object.assign({},we.token),Se.token),components:ht,cssVar:mt})},[Se,we],(Ze,xt)=>Ze.some((ht,Gt)=>{const mt=xt[Gt];return!(0,E.default)(ht,mt,!0)}))}},78459:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294));const E=Object.assign({},X),{useId:ve}=E,fe=typeof ve=="undefined"?()=>"":ve;var ae=W.default=fe},31929:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"ConfigConsumer",{enumerable:!0,get:function(){return we.ConfigConsumer}}),Object.defineProperty(W,"ConfigContext",{enumerable:!0,get:function(){return we.ConfigContext}}),Object.defineProperty(W,"Variants",{enumerable:!0,get:function(){return we.Variants}}),W.default=W.configConsumerProps=void 0,Object.defineProperty(W,"defaultIconPrefixCls",{enumerable:!0,get:function(){return we.defaultIconPrefixCls}}),Object.defineProperty(W,"defaultPrefixCls",{enumerable:!0,get:function(){return we.defaultPrefixCls}}),W.warnContext=W.globalConfig=void 0;var E=X(D(67294)),ve=D(85982),re=ee(D(13357)),fe=ee(D(67265)),ae=D(20059),Ee=X(D(13594)),oe=ee(D(2197)),ze=X(D(64050)),te=ee(D(44805)),ye=ee(D(18253)),De=D(89329),Se=ee(D(98411)),we=D(7177),ce=D(56301),Ze=D(93319),xt=ee(D(5819)),ht=ee(D(25494)),Gt=ee(D(16722)),mt=ee(D(11380)),gt=X(D(3236)),Be=ee(D(82932)),Re=function($n,nr){var Ht={};for(var Jt in $n)Object.prototype.hasOwnProperty.call($n,Jt)&&nr.indexOf(Jt)<0&&(Ht[Jt]=$n[Jt]);if($n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _n=0,Jt=Object.getOwnPropertySymbols($n);_n<Jt.length;_n++)nr.indexOf(Jt[_n])<0&&Object.prototype.propertyIsEnumerable.call($n,Jt[_n])&&(Ht[Jt[_n]]=$n[Jt[_n]]);return Ht};let bt=!1;const yt=W.warnContext=null,At=W.configConsumerProps=["getTargetContainer","getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale"],bn=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let He,Rt,Oe,it;function Qe(){return He||we.defaultPrefixCls}function $e(){return Rt||we.defaultIconPrefixCls}function Ot($n){return Object.keys($n).some(nr=>nr.endsWith("Color"))}const vt=$n=>{const{prefixCls:nr,iconPrefixCls:Ht,theme:Jt,holderRender:_n}=$n;nr!==void 0&&(He=nr),Ht!==void 0&&(Rt=Ht),"holderRender"in $n&&(it=_n),Jt&&(Ot(Jt)?(0,ce.registerTheme)(Qe(),Jt):Oe=Jt)},Me=()=>({getPrefixCls:($n,nr)=>nr||($n?`${Qe()}-${$n}`:Qe()),getIconPrefixCls:$e,getRootPrefixCls:()=>He||Qe(),getTheme:()=>Oe,holderRender:it});W.globalConfig=Me;const Xt=$n=>{const{children:nr,csp:Ht,autoInsertSpaceInButton:Jt,alert:_n,anchor:tr,form:an,locale:Ut,componentSize:Dt,direction:Ie,space:qe,virtual:Bt,dropdownMatchSelectWidth:j,popupMatchSelectWidth:le,popupOverflow:z,legacyLocale:de,parentContext:Zt,iconPrefixCls:nt,theme:St,componentDisabled:In,segmented:Wn,statistic:qn,spin:hn,calendar:pt,carousel:Wt,cascader:An,collapse:Pn,typography:Xn,checkbox:dt,descriptions:be,divider:Ne,drawer:ot,skeleton:Pt,steps:It,image:xn,layout:Qn,list:br,mentions:Jn,modal:Ae,progress:xe,result:ke,slider:tt,breadcrumb:Et,menu:tn,pagination:fn,input:_t,textArea:en,empty:Gn,badge:Tr,radio:jr,rate:vr,switch:Ur,transfer:Fr,avatar:qr,message:wr,tag:fi,table:di,card:vi,tabs:vo,timeline:Oi,timePicker:Ko,upload:va,notification:Co,tree:Xo,colorPicker:Ye,datePicker:Ke,rangePicker:Ct,flex:sn,wave:Ln,dropdown:zn,warning:mn,tour:wn,floatButtonGroup:gr,variant:mr,inputNumber:ai,treeSelect:Vi}=$n,fo=E.useCallback((Wa,na)=>{const{prefixCls:jo}=$n;if(na)return na;const Va=jo||Zt.getPrefixCls("");return Wa?`${Va}-${Wa}`:Va},[Zt.getPrefixCls,$n.prefixCls]),ei=nt||Zt.iconPrefixCls||we.defaultIconPrefixCls,zi=Ht||Zt.csp;(0,Be.default)(ei,zi);const Li=(0,ht.default)(St,Zt.theme,{prefixCls:fo("")}),Zr={csp:zi,autoInsertSpaceInButton:Jt,alert:_n,anchor:tr,locale:Ut||de,direction:Ie,space:qe,virtual:Bt,popupMatchSelectWidth:le!=null?le:j,popupOverflow:z,getPrefixCls:fo,iconPrefixCls:ei,theme:Li,segmented:Wn,statistic:qn,spin:hn,calendar:pt,carousel:Wt,cascader:An,collapse:Pn,typography:Xn,checkbox:dt,descriptions:be,divider:Ne,drawer:ot,skeleton:Pt,steps:It,image:xn,input:_t,textArea:en,layout:Qn,list:br,mentions:Jn,modal:Ae,progress:xe,result:ke,slider:tt,breadcrumb:Et,menu:tn,pagination:fn,empty:Gn,badge:Tr,radio:jr,rate:vr,switch:Ur,transfer:Fr,avatar:qr,message:wr,tag:fi,table:di,card:vi,tabs:vo,timeline:Oi,timePicker:Ko,upload:va,notification:Co,tree:Xo,colorPicker:Ye,datePicker:Ke,rangePicker:Ct,flex:sn,wave:Ln,dropdown:zn,warning:mn,tour:wn,floatButtonGroup:gr,variant:mr,inputNumber:ai,treeSelect:Vi},go=Object.assign({},Zt);Object.keys(Zr).forEach(Wa=>{Zr[Wa]!==void 0&&(go[Wa]=Zr[Wa])}),bn.forEach(Wa=>{const na=$n[Wa];na&&(go[Wa]=na)}),typeof Jt!="undefined"&&(go.button=Object.assign({autoInsertSpace:Jt},go.button));const Mi=(0,fe.default)(()=>go,go,(Wa,na)=>{const jo=Object.keys(Wa),Va=Object.keys(na);return jo.length!==Va.length||jo.some(fs=>Wa[fs]!==na[fs])}),bo=E.useMemo(()=>({prefixCls:ei,csp:zi}),[ei,zi]);let Si=E.createElement(E.Fragment,null,E.createElement(mt.default,{dropdownMatchSelectWidth:j}),nr);const wo=E.useMemo(()=>{var Wa,na,jo,Va;return(0,ae.merge)(((Wa=ye.default.Form)===null||Wa===void 0?void 0:Wa.defaultValidateMessages)||{},((jo=(na=Mi.locale)===null||na===void 0?void 0:na.Form)===null||jo===void 0?void 0:jo.defaultValidateMessages)||{},((Va=Mi.form)===null||Va===void 0?void 0:Va.validateMessages)||{},(an==null?void 0:an.validateMessages)||{})},[Mi,an==null?void 0:an.validateMessages]);Object.keys(wo).length>0&&(Si=E.createElement(oe.default.Provider,{value:wo},Si)),Ut&&(Si=E.createElement(ze.default,{locale:Ut,_ANT_MARK__:ze.ANT_MARK},Si)),(ei||zi)&&(Si=E.createElement(re.default.Provider,{value:bo},Si)),Dt&&(Si=E.createElement(gt.SizeContextProvider,{size:Dt},Si)),Si=E.createElement(Gt.default,null,Si);const Yo=E.useMemo(()=>{const Wa=Li||{},{algorithm:na,token:jo,components:Va,cssVar:fs}=Wa,Tt=Re(Wa,["algorithm","token","components","cssVar"]),Ft=na&&(!Array.isArray(na)||na.length>0)?(0,ve.createTheme)(na):De.defaultTheme,Dn={};Object.entries(Va||{}).forEach(_i=>{let[bi,so]=_i;const Ha=Object.assign({},so);"algorithm"in Ha&&(Ha.algorithm===!0?Ha.theme=Ft:(Array.isArray(Ha.algorithm)||typeof Ha.algorithm=="function")&&(Ha.theme=(0,ve.createTheme)(Ha.algorithm)),delete Ha.algorithm),Dn[bi]=Ha});const sr=Object.assign(Object.assign({},Se.default),jo);return Object.assign(Object.assign({},Tt),{theme:Ft,token:sr,components:Dn,override:Object.assign({override:sr},Dn),cssVar:fs})},[Li]);return St&&(Si=E.createElement(De.DesignTokenContext.Provider,{value:Yo},Si)),Mi.warning&&(Si=E.createElement(Ee.WarningContext.Provider,{value:Mi.warning},Si)),In!==void 0&&(Si=E.createElement(Ze.DisabledContextProvider,{disabled:In},Si)),E.createElement(we.ConfigContext.Provider,{value:Mi},Si)},on=$n=>{const nr=E.useContext(we.ConfigContext),Ht=E.useContext(te.default);return E.createElement(Xt,Object.assign({parentContext:nr,legacyLocale:Ht},$n))};on.ConfigContext=we.ConfigContext,on.SizeContext=gt.default,on.config=vt,on.useConfig=xt.default,Object.defineProperty(on,"SizeContext",{get:()=>gt.default});var Fn=W.default=on},82932:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"default",{enumerable:!0,get:function(){return ee.useResetIconStyle}});var ee=D(3184)},51130:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.VariantContext=W.NoStyleItemContext=W.NoFormStyle=W.FormProvider=W.FormItemPrefixContext=W.FormItemInputContext=W.FormContext=void 0;var E=X(D(67294)),ve=E,re=D(88692),fe=ee(D(18475));const ae=W.FormContext=ve.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),Ee=W.NoStyleItemContext=ve.createContext(null),oe=Se=>{const we=(0,fe.default)(Se,["prefixCls"]);return ve.createElement(re.FormProvider,Object.assign({},we))};W.FormProvider=oe;const ze=W.FormItemPrefixContext=ve.createContext({prefixCls:""}),te=W.FormItemInputContext=ve.createContext({}),ye=Se=>{let{children:we,status:ce,override:Ze}=Se;const xt=(0,E.useContext)(te),ht=(0,E.useMemo)(()=>{const Gt=Object.assign({},xt);return Ze&&delete Gt.isFormItemInput,ce&&(delete Gt.status,delete Gt.hasFeedback,delete Gt.feedbackIcon),Gt},[ce,Ze,xt]);return ve.createElement(te.Provider,{value:ht},we)};W.NoFormStyle=ye;const De=W.VariantContext=(0,E.createContext)(void 0)},96424:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294),X=D(51130),E=D(31929);const ve=function(fe,ae){let Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;var oe,ze;const{variant:te,[fe]:ye}=(0,ee.useContext)(E.ConfigContext),De=(0,ee.useContext)(X.VariantContext),Se=ye==null?void 0:ye.variant;let we;typeof ae!="undefined"?we=ae:Ee===!1?we="borderless":we=(ze=(oe=De!=null?De:Se)!==null&&oe!==void 0?oe:te)!==null&&ze!==void 0?ze:"outlined";const ce=E.Variants.includes(we);return[we,ce]};var re=W.default=ve},2197:function($t,W,D){"use strict";"use client";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294),X=W.default=(0,ee.createContext)(void 0)},10815:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0,W.triggerFocus=gt;var E=X(D(67294)),ve=ee(D(93967)),re=ee(D(67656)),fe=D(75531),ae=ee(D(85549)),Ee=ee(D(49314)),oe=D(71434),ze=D(13594),te=D(31929),ye=ee(D(93319)),De=ee(D(14893)),Se=ee(D(65693)),we=D(51130),ce=ee(D(96424)),Ze=D(46549),xt=ee(D(81722)),ht=ee(D(89858)),Gt=D(36714),mt=function(bt,yt){var At={};for(var bn in bt)Object.prototype.hasOwnProperty.call(bt,bn)&&yt.indexOf(bn)<0&&(At[bn]=bt[bn]);if(bt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var He=0,bn=Object.getOwnPropertySymbols(bt);He<bn.length;He++)yt.indexOf(bn[He])<0&&Object.prototype.propertyIsEnumerable.call(bt,bn[He])&&(At[bn[He]]=bt[bn[He]]);return At};function gt(bt,yt){if(!bt)return;bt.focus(yt);const{cursor:At}=yt||{};if(At){const bn=bt.value.length;switch(At){case"start":bt.setSelectionRange(0,0);break;case"end":bt.setSelectionRange(bn,bn);break;default:bt.setSelectionRange(0,bn)}}}const Be=(0,E.forwardRef)((bt,yt)=>{var At;const{prefixCls:bn,bordered:He=!0,status:Rt,size:Oe,disabled:it,onBlur:Qe,onFocus:$e,suffix:Ot,allowClear:vt,addonAfter:Me,addonBefore:Xt,className:on,style:Fn,styles:$n,rootClassName:nr,onChange:Ht,classNames:Jt,variant:_n}=bt,tr=mt(bt,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:an,direction:Ut,input:Dt}=E.default.useContext(te.ConfigContext),Ie=an("input",bn),qe=(0,E.useRef)(null),Bt=(0,De.default)(Ie),[j,le,z]=(0,ht.default)(Ie,Bt),{compactSize:de,compactItemClassnames:Zt}=(0,Ze.useCompactItemContext)(Ie,Ut),nt=(0,Se.default)(xn=>{var Qn;return(Qn=Oe!=null?Oe:de)!==null&&Qn!==void 0?Qn:xn}),St=E.default.useContext(ye.default),In=it!=null?it:St,{status:Wn,hasFeedback:qn,feedbackIcon:hn}=(0,E.useContext)(we.FormItemInputContext),pt=(0,oe.getMergedStatus)(Wn,Rt),Wt=(0,Gt.hasPrefixSuffix)(bt)||!!qn,An=(0,E.useRef)(Wt),Pn=(0,xt.default)(qe,!0),Xn=xn=>{Pn(),Qe==null||Qe(xn)},dt=xn=>{Pn(),$e==null||$e(xn)},be=xn=>{Pn(),Ht==null||Ht(xn)},Ne=(qn||Ot)&&E.default.createElement(E.default.Fragment,null,Ot,qn&&hn),ot=(0,Ee.default)(vt!=null?vt:Dt==null?void 0:Dt.allowClear),[Pt,It]=(0,ce.default)("input",_n,He);return j(E.default.createElement(re.default,Object.assign({ref:(0,fe.composeRef)(yt,qe),prefixCls:Ie,autoComplete:Dt==null?void 0:Dt.autoComplete},tr,{disabled:In,onBlur:Xn,onFocus:dt,style:Object.assign(Object.assign({},Dt==null?void 0:Dt.style),Fn),styles:Object.assign(Object.assign({},Dt==null?void 0:Dt.styles),$n),suffix:Ne,allowClear:ot,className:(0,ve.default)(on,nr,z,Bt,Zt,Dt==null?void 0:Dt.className),onChange:be,addonBefore:Xt&&E.default.createElement(ae.default,{form:!0,space:!0},Xt),addonAfter:Me&&E.default.createElement(ae.default,{form:!0,space:!0},Me),classNames:Object.assign(Object.assign(Object.assign({},Jt),Dt==null?void 0:Dt.classNames),{input:(0,ve.default)({[`${Ie}-sm`]:nt==="small",[`${Ie}-lg`]:nt==="large",[`${Ie}-rtl`]:Ut==="rtl"},Jt==null?void 0:Jt.input,(At=Dt==null?void 0:Dt.classNames)===null||At===void 0?void 0:At.input,le),variant:(0,ve.default)({[`${Ie}-${Pt}`]:It},(0,oe.getStatusClassNames)(Ie,pt)),affixWrapper:(0,ve.default)({[`${Ie}-affix-wrapper-sm`]:nt==="small",[`${Ie}-affix-wrapper-lg`]:nt==="large",[`${Ie}-affix-wrapper-rtl`]:Ut==="rtl"},le),wrapper:(0,ve.default)({[`${Ie}-group-rtl`]:Ut==="rtl"},le),groupWrapper:(0,ve.default)({[`${Ie}-group-wrapper-sm`]:nt==="small",[`${Ie}-group-wrapper-lg`]:nt==="large",[`${Ie}-group-wrapper-rtl`]:Ut==="rtl",[`${Ie}-group-wrapper-${Pt}`]:It},(0,oe.getStatusClassNames)(`${Ie}-group-wrapper`,pt,qn),le)})})))});var Re=W.default=Be},14104:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=E,re=ee(D(93967)),fe=ee(D(43961)),ae=ee(D(49314)),Ee=D(71434),oe=D(13594),ze=D(31929),te=ee(D(93319)),ye=ee(D(14893)),De=ee(D(65693)),Se=D(51130),we=ee(D(96424)),ce=D(10815),Ze=ee(D(89858)),xt=function(mt,gt){var Be={};for(var Re in mt)Object.prototype.hasOwnProperty.call(mt,Re)&&gt.indexOf(Re)<0&&(Be[Re]=mt[Re]);if(mt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var bt=0,Re=Object.getOwnPropertySymbols(mt);bt<Re.length;bt++)gt.indexOf(Re[bt])<0&&Object.prototype.propertyIsEnumerable.call(mt,Re[bt])&&(Be[Re[bt]]=mt[Re[bt]]);return Be};const ht=(0,E.forwardRef)((mt,gt)=>{var Be,Re;const{prefixCls:bt,bordered:yt=!0,size:At,disabled:bn,status:He,allowClear:Rt,classNames:Oe,rootClassName:it,className:Qe,style:$e,styles:Ot,variant:vt}=mt,Me=xt(mt,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant"]),{getPrefixCls:Xt,direction:on,textArea:Fn}=ve.useContext(ze.ConfigContext),$n=(0,De.default)(At),nr=ve.useContext(te.default),Ht=bn!=null?bn:nr,{status:Jt,hasFeedback:_n,feedbackIcon:tr}=ve.useContext(Se.FormItemInputContext),an=(0,Ee.getMergedStatus)(Jt,He),Ut=ve.useRef(null);ve.useImperativeHandle(gt,()=>{var Zt;return{resizableTextArea:(Zt=Ut.current)===null||Zt===void 0?void 0:Zt.resizableTextArea,focus:nt=>{var St,In;(0,ce.triggerFocus)((In=(St=Ut.current)===null||St===void 0?void 0:St.resizableTextArea)===null||In===void 0?void 0:In.textArea,nt)},blur:()=>{var nt;return(nt=Ut.current)===null||nt===void 0?void 0:nt.blur()}}});const Dt=Xt("input",bt),Ie=(0,ye.default)(Dt),[qe,Bt,j]=(0,Ze.default)(Dt,Ie),[le,z]=(0,we.default)("textArea",vt,yt),de=(0,ae.default)(Rt!=null?Rt:Fn==null?void 0:Fn.allowClear);return qe(ve.createElement(fe.default,Object.assign({autoComplete:Fn==null?void 0:Fn.autoComplete},Me,{style:Object.assign(Object.assign({},Fn==null?void 0:Fn.style),$e),styles:Object.assign(Object.assign({},Fn==null?void 0:Fn.styles),Ot),disabled:Ht,allowClear:de,className:(0,re.default)(j,Ie,Qe,it,Fn==null?void 0:Fn.className),classNames:Object.assign(Object.assign(Object.assign({},Oe),Fn==null?void 0:Fn.classNames),{textarea:(0,re.default)({[`${Dt}-sm`]:$n==="small",[`${Dt}-lg`]:$n==="large"},Bt,Oe==null?void 0:Oe.textarea,(Be=Fn==null?void 0:Fn.classNames)===null||Be===void 0?void 0:Be.textarea),variant:(0,re.default)({[`${Dt}-${le}`]:z},(0,Ee.getStatusClassNames)(Dt,an)),affixWrapper:(0,re.default)(`${Dt}-textarea-affix-wrapper`,{[`${Dt}-affix-wrapper-rtl`]:on==="rtl",[`${Dt}-affix-wrapper-sm`]:$n==="small",[`${Dt}-affix-wrapper-lg`]:$n==="large",[`${Dt}-textarea-show-count`]:mt.showCount||((Re=mt.count)===null||Re===void 0?void 0:Re.show)},Bt)}),prefixCls:Dt,suffix:_n&&ve.createElement("span",{className:`${Dt}-textarea-suffix`},tr),ref:Ut})))});var Gt=W.default=ht},81722:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=X;var ee=D(67294);function X(E,ve){const re=(0,ee.useRef)([]),fe=()=>{re.current.push(setTimeout(()=>{var ae,Ee,oe,ze;!((ae=E.current)===null||ae===void 0)&&ae.input&&((Ee=E.current)===null||Ee===void 0?void 0:Ee.input.getAttribute("type"))==="password"&&(!((oe=E.current)===null||oe===void 0)&&oe.input.hasAttribute("value"))&&((ze=E.current)===null||ze===void 0||ze.input.removeAttribute("value"))}))};return(0,ee.useEffect)(()=>(ve&&fe(),()=>re.current.forEach(ae=>{ae&&clearTimeout(ae)})),[]),fe}},89858:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genPlaceholderStyle=W.genInputSmallStyle=W.genInputGroupStyle=W.genBasicInputStyle=W.genActiveStyle=W.default=void 0,Object.defineProperty(W,"initComponentToken",{enumerable:!0,get:function(){return re.initComponentToken}}),Object.defineProperty(W,"initInputToken",{enumerable:!0,get:function(){return re.initInputToken}});var ee=D(85982),X=D(98078),E=D(78793),ve=D(3184),re=D(25735),fe=D(58594);const ae=mt=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:mt,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}});W.genPlaceholderStyle=ae;const Ee=mt=>({borderColor:mt.activeBorderColor,boxShadow:mt.activeShadow,outline:0,backgroundColor:mt.activeBg});W.genActiveStyle=Ee;const oe=mt=>{const{paddingBlockLG:gt,lineHeightLG:Be,borderRadiusLG:Re,paddingInlineLG:bt}=mt;return{padding:`${(0,ee.unit)(gt)} ${(0,ee.unit)(bt)}`,fontSize:mt.inputFontSizeLG,lineHeight:Be,borderRadius:Re}},ze=mt=>({padding:`${(0,ee.unit)(mt.paddingBlockSM)} ${(0,ee.unit)(mt.paddingInlineSM)}`,fontSize:mt.inputFontSizeSM,borderRadius:mt.borderRadiusSM});W.genInputSmallStyle=ze;const te=mt=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${(0,ee.unit)(mt.paddingBlock)} ${(0,ee.unit)(mt.paddingInline)}`,color:mt.colorText,fontSize:mt.inputFontSize,lineHeight:mt.lineHeight,borderRadius:mt.borderRadius,transition:`all ${mt.motionDurationMid}`},ae(mt.colorTextPlaceholder)),{"textarea&":{maxWidth:"100%",height:"auto",minHeight:mt.controlHeight,lineHeight:mt.lineHeight,verticalAlign:"bottom",transition:`all ${mt.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},oe(mt)),"&-sm":Object.assign({},ze(mt)),"&-rtl, &-textarea-rtl":{direction:"rtl"}});W.genBasicInputStyle=te;const ye=mt=>{const{componentCls:gt,antCls:Be}=mt;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:mt.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${gt}, &-lg > ${gt}-group-addon`]:Object.assign({},oe(mt)),[`&-sm ${gt}, &-sm > ${gt}-group-addon`]:Object.assign({},ze(mt)),[`&-lg ${Be}-select-single ${Be}-select-selector`]:{height:mt.controlHeightLG},[`&-sm ${Be}-select-single ${Be}-select-selector`]:{height:mt.controlHeightSM},[`> ${gt}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${gt}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${(0,ee.unit)(mt.paddingInline)}`,color:mt.colorText,fontWeight:"normal",fontSize:mt.inputFontSize,textAlign:"center",borderRadius:mt.borderRadius,transition:`all ${mt.motionDurationSlow}`,lineHeight:1,[`${Be}-select`]:{margin:`${(0,ee.unit)(mt.calc(mt.paddingBlock).add(1).mul(-1).equal())} ${(0,ee.unit)(mt.calc(mt.paddingInline).mul(-1).equal())}`,[`&${Be}-select-single:not(${Be}-select-customize-input):not(${Be}-pagination-size-changer)`]:{[`${Be}-select-selector`]:{backgroundColor:"inherit",border:`${(0,ee.unit)(mt.lineWidth)} ${mt.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${Be}-select-selector`]:{color:mt.colorPrimary}}},[`${Be}-cascader-picker`]:{margin:`-9px ${(0,ee.unit)(mt.calc(mt.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${Be}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[gt]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${gt}-search-with-button &`]:{zIndex:0}}},[`> ${gt}:first-child, ${gt}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${Be}-select ${Be}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${gt}-affix-wrapper`]:{[`&:not(:first-child) ${gt}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${gt}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${gt}:last-child, ${gt}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${Be}-select ${Be}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${gt}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${gt}-search &`]:{borderStartStartRadius:mt.borderRadius,borderEndStartRadius:mt.borderRadius}},[`&:not(:first-child), ${gt}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${gt}-group-compact`]:Object.assign(Object.assign({display:"block"},(0,X.clearFix)()),{[`${gt}-group-addon, ${gt}-group-wrap, > ${gt}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:mt.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${gt}-affix-wrapper,
        & > ${gt}-number-affix-wrapper,
        & > ${Be}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:mt.calc(mt.lineWidth).mul(-1).equal(),borderInlineEndWidth:mt.lineWidth},[gt]:{float:"none"},[`& > ${Be}-select > ${Be}-select-selector,
      & > ${Be}-select-auto-complete ${gt},
      & > ${Be}-cascader-picker ${gt},
      & > ${gt}-group-wrapper ${gt}`]:{borderInlineEndWidth:mt.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${Be}-select-focused`]:{zIndex:1},[`& > ${Be}-select > ${Be}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${Be}-select:first-child > ${Be}-select-selector,
      & > ${Be}-select-auto-complete:first-child ${gt},
      & > ${Be}-cascader-picker:first-child ${gt}`]:{borderStartStartRadius:mt.borderRadius,borderEndStartRadius:mt.borderRadius},[`& > *:last-child,
      & > ${Be}-select:last-child > ${Be}-select-selector,
      & > ${Be}-cascader-picker:last-child ${gt},
      & > ${Be}-cascader-picker-focused:last-child ${gt}`]:{borderInlineEndWidth:mt.lineWidth,borderStartEndRadius:mt.borderRadius,borderEndEndRadius:mt.borderRadius},[`& > ${Be}-select-auto-complete ${gt}`]:{verticalAlign:"top"},[`${gt}-group-wrapper + ${gt}-group-wrapper`]:{marginInlineStart:mt.calc(mt.lineWidth).mul(-1).equal(),[`${gt}-affix-wrapper`]:{borderRadius:0}},[`${gt}-group-wrapper:not(:last-child)`]:{[`&${gt}-search > ${gt}-group`]:{[`& > ${gt}-group-addon > ${gt}-search-button`]:{borderRadius:0},[`& > ${gt}`]:{borderStartStartRadius:mt.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:mt.borderRadius}}}})}};W.genInputGroupStyle=ye;const De=mt=>{const{componentCls:gt,controlHeightSM:Be,lineWidth:Re,calc:bt}=mt,At=bt(Be).sub(bt(Re).mul(2)).sub(16).div(2).equal();return{[gt]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,X.resetComponent)(mt)),te(mt)),(0,fe.genOutlinedStyle)(mt)),(0,fe.genFilledStyle)(mt)),(0,fe.genBorderlessStyle)(mt)),{'&[type="color"]':{height:mt.controlHeight,[`&${gt}-lg`]:{height:mt.controlHeightLG},[`&${gt}-sm`]:{height:Be,paddingTop:At,paddingBottom:At}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},Se=mt=>{const{componentCls:gt}=mt;return{[`${gt}-clear-icon`]:{margin:0,color:mt.colorTextQuaternary,fontSize:mt.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${mt.motionDurationSlow}`,"&:hover":{color:mt.colorTextTertiary},"&:active":{color:mt.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${(0,ee.unit)(mt.inputAffixPadding)}`}}}},we=mt=>{const{componentCls:gt,inputAffixPadding:Be,colorTextDescription:Re,motionDurationSlow:bt,colorIcon:yt,colorIconHover:At,iconCls:bn}=mt;return{[`${gt}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign({},te(mt)),{display:"inline-flex",[`&:not(${gt}-disabled):hover`]:{zIndex:1,[`${gt}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${gt}`]:{padding:0},[`> input${gt}, > textarea${gt}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[gt]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:mt.paddingXS}},"&-show-count-suffix":{color:Re},"&-show-count-has-suffix":{marginInlineEnd:mt.paddingXXS},"&-prefix":{marginInlineEnd:Be},"&-suffix":{marginInlineStart:Be}}}),Se(mt)),{[`${bn}${gt}-password-icon`]:{color:yt,cursor:"pointer",transition:`all ${bt}`,"&:hover":{color:At}}})}},ce=mt=>{const{componentCls:gt,borderRadiusLG:Be,borderRadiusSM:Re}=mt;return{[`${gt}-group`]:Object.assign(Object.assign(Object.assign({},(0,X.resetComponent)(mt)),ye(mt)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${gt}-group-addon`]:{borderRadius:Be,fontSize:mt.inputFontSizeLG}},"&-sm":{[`${gt}-group-addon`]:{borderRadius:Re}}},(0,fe.genOutlinedGroupStyle)(mt)),(0,fe.genFilledGroupStyle)(mt)),{[`&:not(${gt}-compact-first-item):not(${gt}-compact-last-item)${gt}-compact-item`]:{[`${gt}, ${gt}-group-addon`]:{borderRadius:0}},[`&:not(${gt}-compact-last-item)${gt}-compact-first-item`]:{[`${gt}, ${gt}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${gt}-compact-first-item)${gt}-compact-last-item`]:{[`${gt}, ${gt}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${gt}-compact-last-item)${gt}-compact-item`]:{[`${gt}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}}})})}},Ze=mt=>{const{componentCls:gt,antCls:Be}=mt,Re=`${gt}-search`;return{[Re]:{[gt]:{"&:hover, &:focus":{borderColor:mt.colorPrimaryHover,[`+ ${gt}-group-addon ${Re}-button:not(${Be}-btn-primary)`]:{borderInlineStartColor:mt.colorPrimaryHover}}},[`${gt}-affix-wrapper`]:{borderRadius:0},[`${gt}-lg`]:{lineHeight:mt.calc(mt.lineHeightLG).sub(2e-4).equal()},[`> ${gt}-group`]:{[`> ${gt}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${Re}-button`]:{marginInlineEnd:-1,paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:mt.borderRadius,borderEndEndRadius:mt.borderRadius,borderEndStartRadius:0,boxShadow:"none"},[`${Re}-button:not(${Be}-btn-primary)`]:{color:mt.colorTextDescription,"&:hover":{color:mt.colorPrimaryHover},"&:active":{color:mt.colorPrimaryActive},[`&${Be}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${Re}-button`]:{height:mt.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${Re}-button`]:{height:mt.controlHeightLG},[`&-small ${Re}-button`]:{height:mt.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${gt}-compact-item`]:{[`&:not(${gt}-compact-last-item)`]:{[`${gt}-group-addon`]:{[`${gt}-search-button`]:{marginInlineEnd:mt.calc(mt.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${gt}-compact-first-item)`]:{[`${gt},${gt}-affix-wrapper`]:{borderRadius:0}},[`> ${gt}-group-addon ${gt}-search-button,
        > ${gt},
        ${gt}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${gt}-affix-wrapper-focused`]:{zIndex:2}}}}},xt=mt=>{const{componentCls:gt,paddingLG:Be}=mt,Re=`${gt}-textarea`;return{[Re]:{position:"relative","&-show-count":{[`> ${gt}`]:{height:"100%"},[`${gt}-data-count`]:{position:"absolute",bottom:mt.calc(mt.fontSize).mul(mt.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:mt.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${gt},
        &-affix-wrapper${Re}-has-feedback ${gt}
      `]:{paddingInlineEnd:Be},[`&-affix-wrapper${gt}-affix-wrapper`]:{padding:0,[`> textarea${gt}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent","&:focus":{boxShadow:"none !important"}},[`${gt}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${gt}-clear-icon`]:{position:"absolute",insetInlineEnd:mt.paddingInline,insetBlockStart:mt.paddingXS},[`${Re}-suffix`]:{position:"absolute",top:0,insetInlineEnd:mt.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${gt}-affix-wrapper-sm`]:{[`${gt}-suffix`]:{[`${gt}-clear-icon`]:{insetInlineEnd:mt.paddingInlineSM}}}}}},ht=mt=>{const{componentCls:gt}=mt;return{[`${gt}-out-of-range`]:{[`&, & input, & textarea, ${gt}-show-count-suffix, ${gt}-data-count`]:{color:mt.colorError}}}};var Gt=W.default=(0,ve.genStyleHooks)("Input",mt=>{const gt=(0,ve.mergeToken)(mt,(0,re.initInputToken)(mt));return[De(gt),xt(gt),we(gt),ce(gt),Ze(gt),ht(gt),(0,E.genCompactItemStyle)(gt)]},re.initComponentToken,{resetFont:!1})},25735:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.initComponentToken=void 0,W.initInputToken=X;var ee=D(3184);function X(ve){return(0,ee.mergeToken)(ve,{inputAffixPadding:ve.paddingXXS})}const E=ve=>{const{controlHeight:re,fontSize:fe,lineHeight:ae,lineWidth:Ee,controlHeightSM:oe,controlHeightLG:ze,fontSizeLG:te,lineHeightLG:ye,paddingSM:De,controlPaddingHorizontalSM:Se,controlPaddingHorizontal:we,colorFillAlter:ce,colorPrimaryHover:Ze,colorPrimary:xt,controlOutlineWidth:ht,controlOutline:Gt,colorErrorOutline:mt,colorWarningOutline:gt,colorBgContainer:Be}=ve;return{paddingBlock:Math.max(Math.round((re-fe*ae)/2*10)/10-Ee,0),paddingBlockSM:Math.max(Math.round((oe-fe*ae)/2*10)/10-Ee,0),paddingBlockLG:Math.ceil((ze-te*ye)/2*10)/10-Ee,paddingInline:De-Ee,paddingInlineSM:Se-Ee,paddingInlineLG:we-Ee,addonBg:ce,activeBorderColor:xt,hoverBorderColor:Ze,activeShadow:`0 0 0 ${ht}px ${Gt}`,errorActiveShadow:`0 0 0 ${ht}px ${mt}`,warningActiveShadow:`0 0 0 ${ht}px ${gt}`,hoverBg:Be,activeBg:Be,inputFontSize:fe,inputFontSizeLG:te,inputFontSizeSM:fe}};W.initComponentToken=E},58594:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genOutlinedStyle=W.genOutlinedGroupStyle=W.genHoverStyle=W.genFilledStyle=W.genFilledGroupStyle=W.genDisabledStyle=W.genBorderlessStyle=W.genBaseOutlinedStyle=void 0;var ee=D(85982),X=D(3184);const E=ce=>({borderColor:ce.hoverBorderColor,backgroundColor:ce.hoverBg});W.genHoverStyle=E;const ve=ce=>({color:ce.colorTextDisabled,backgroundColor:ce.colorBgContainerDisabled,borderColor:ce.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},E((0,X.mergeToken)(ce,{hoverBorderColor:ce.colorBorder,hoverBg:ce.colorBgContainerDisabled})))});W.genDisabledStyle=ve;const re=(ce,Ze)=>({background:ce.colorBgContainer,borderWidth:ce.lineWidth,borderStyle:ce.lineType,borderColor:Ze.borderColor,"&:hover":{borderColor:Ze.hoverBorderColor,backgroundColor:ce.hoverBg},"&:focus, &:focus-within":{borderColor:Ze.activeBorderColor,boxShadow:Ze.activeShadow,outline:0,backgroundColor:ce.activeBg}});W.genBaseOutlinedStyle=re;const fe=(ce,Ze)=>({[`&${ce.componentCls}-status-${Ze.status}:not(${ce.componentCls}-disabled)`]:Object.assign(Object.assign({},re(ce,Ze)),{[`${ce.componentCls}-prefix, ${ce.componentCls}-suffix`]:{color:Ze.affixColor}}),[`&${ce.componentCls}-status-${Ze.status}${ce.componentCls}-disabled`]:{borderColor:Ze.borderColor}}),ae=(ce,Ze)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},re(ce,{borderColor:ce.colorBorder,hoverBorderColor:ce.hoverBorderColor,activeBorderColor:ce.activeBorderColor,activeShadow:ce.activeShadow})),{[`&${ce.componentCls}-disabled, &[disabled]`]:Object.assign({},ve(ce))}),fe(ce,{status:"error",borderColor:ce.colorError,hoverBorderColor:ce.colorErrorBorderHover,activeBorderColor:ce.colorError,activeShadow:ce.errorActiveShadow,affixColor:ce.colorError})),fe(ce,{status:"warning",borderColor:ce.colorWarning,hoverBorderColor:ce.colorWarningBorderHover,activeBorderColor:ce.colorWarning,activeShadow:ce.warningActiveShadow,affixColor:ce.colorWarning})),Ze)});W.genOutlinedStyle=ae;const Ee=(ce,Ze)=>({[`&${ce.componentCls}-group-wrapper-status-${Ze.status}`]:{[`${ce.componentCls}-group-addon`]:{borderColor:Ze.addonBorderColor,color:Ze.addonColor}}}),oe=ce=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${ce.componentCls}-group`]:{"&-addon":{background:ce.addonBg,border:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},Ee(ce,{status:"error",addonBorderColor:ce.colorError,addonColor:ce.colorErrorText})),Ee(ce,{status:"warning",addonBorderColor:ce.colorWarning,addonColor:ce.colorWarningText})),{[`&${ce.componentCls}-group-wrapper-disabled`]:{[`${ce.componentCls}-group-addon`]:Object.assign({},ve(ce))}})});W.genOutlinedGroupStyle=oe;const ze=(ce,Ze)=>{const{componentCls:xt}=ce;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${xt}-disabled, &[disabled]`]:{color:ce.colorTextDisabled},[`&${xt}-status-error`]:{"&, & input, & textarea":{color:ce.colorError}},[`&${xt}-status-warning`]:{"&, & input, & textarea":{color:ce.colorWarning}}},Ze)}};W.genBorderlessStyle=ze;const te=(ce,Ze)=>({background:Ze.bg,borderWidth:ce.lineWidth,borderStyle:ce.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:Ze==null?void 0:Ze.inputColor},"&:hover":{background:Ze.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:Ze.activeBorderColor,backgroundColor:ce.activeBg}}),ye=(ce,Ze)=>({[`&${ce.componentCls}-status-${Ze.status}:not(${ce.componentCls}-disabled)`]:Object.assign(Object.assign({},te(ce,Ze)),{[`${ce.componentCls}-prefix, ${ce.componentCls}-suffix`]:{color:Ze.affixColor}})}),De=(ce,Ze)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},te(ce,{bg:ce.colorFillTertiary,hoverBg:ce.colorFillSecondary,activeBorderColor:ce.activeBorderColor})),{[`&${ce.componentCls}-disabled, &[disabled]`]:Object.assign({},ve(ce))}),ye(ce,{status:"error",bg:ce.colorErrorBg,hoverBg:ce.colorErrorBgHover,activeBorderColor:ce.colorError,inputColor:ce.colorErrorText,affixColor:ce.colorError})),ye(ce,{status:"warning",bg:ce.colorWarningBg,hoverBg:ce.colorWarningBgHover,activeBorderColor:ce.colorWarning,inputColor:ce.colorWarningText,affixColor:ce.colorWarning})),Ze)});W.genFilledStyle=De;const Se=(ce,Ze)=>({[`&${ce.componentCls}-group-wrapper-status-${Ze.status}`]:{[`${ce.componentCls}-group-addon`]:{background:Ze.addonBg,color:Ze.addonColor}}}),we=ce=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${ce.componentCls}-group`]:{"&-addon":{background:ce.colorFillTertiary},[`${ce.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorSplit}`}}}},Se(ce,{status:"error",addonBg:ce.colorErrorBg,addonColor:ce.colorErrorText})),Se(ce,{status:"warning",addonBg:ce.colorWarningBg,addonColor:ce.colorWarningText})),{[`&${ce.componentCls}-group-wrapper-disabled`]:{[`${ce.componentCls}-group`]:{"&-addon":{background:ce.colorFillTertiary,color:ce.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`,borderTop:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`,borderBottom:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`,borderTop:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`,borderBottom:`${(0,ee.unit)(ce.lineWidth)} ${ce.lineType} ${ce.colorBorder}`}}}})});W.genFilledGroupStyle=we},36714:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.hasPrefixSuffix=D;function D(ee){return!!(ee.prefix||ee.suffix||ee.allowClear||ee.showCount)}},44805:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294);const X=(0,ee.createContext)(void 0);var E=W.default=X},64050:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=W.ANT_MARK=void 0,Object.defineProperty(W,"useLocale",{enumerable:!0,get:function(){return ae.default}});var E=X(D(67294)),ve=D(13594),re=D(10625),fe=ee(D(44805)),ae=ee(D(76647));const Ee=W.ANT_MARK="internalMark",oe=te=>{const{locale:ye={},children:De,_ANT_MARK__:Se}=te;E.useEffect(()=>(0,re.changeConfirmLocale)(ye==null?void 0:ye.Modal),[ye]);const we=E.useMemo(()=>Object.assign(Object.assign({},ye),{exist:!0}),[ye]);return E.createElement(fe.default.Provider,{value:we},De)};var ze=W.default=oe},76647:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(44805)),re=ee(D(18253));const fe=(Ee,oe)=>{const ze=E.useContext(ve.default),te=E.useMemo(()=>{var De;const Se=oe||re.default[Ee],we=(De=ze==null?void 0:ze[Ee])!==null&&De!==void 0?De:{};return Object.assign(Object.assign({},typeof Se=="function"?Se():Se),we||{})},[Ee,oe,ze]),ye=E.useMemo(()=>{const De=ze==null?void 0:ze.locale;return ze!=null&&ze.exist&&!De?re.default.locale:De},[ze]);return[te,ye]};var ae=W.default=fe},10625:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.changeConfirmLocale=fe,W.getConfirmLocale=ae;var X=ee(D(18253));let E=Object.assign({},X.default.Modal),ve=[];const re=()=>ve.reduce((Ee,oe)=>Object.assign(Object.assign({},Ee),oe),X.default.Modal);function fe(Ee){if(Ee){const oe=Object.assign({},Ee);return ve.push(oe),E=re(),()=>{ve=ve.filter(ze=>ze!==oe),E=re()}}E=Object.assign({},X.default.Modal)}function ae(){return E}},46549:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.useCompactItemContext=W.default=W.SpaceCompactItemContext=W.NoCompactStyle=void 0;var E=X(D(67294)),ve=ee(D(93967)),re=ee(D(45598)),fe=D(31929),ae=ee(D(65693)),Ee=ee(D(54277)),oe=function(ce,Ze){var xt={};for(var ht in ce)Object.prototype.hasOwnProperty.call(ce,ht)&&Ze.indexOf(ht)<0&&(xt[ht]=ce[ht]);if(ce!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Gt=0,ht=Object.getOwnPropertySymbols(ce);Gt<ht.length;Gt++)Ze.indexOf(ht[Gt])<0&&Object.prototype.propertyIsEnumerable.call(ce,ht[Gt])&&(xt[ht[Gt]]=ce[ht[Gt]]);return xt};const ze=W.SpaceCompactItemContext=E.createContext(null),te=(ce,Ze)=>{const xt=E.useContext(ze),ht=E.useMemo(()=>{if(!xt)return"";const{compactDirection:Gt,isFirstItem:mt,isLastItem:gt}=xt,Be=Gt==="vertical"?"-vertical-":"-";return(0,ve.default)(`${ce}-compact${Be}item`,{[`${ce}-compact${Be}first-item`]:mt,[`${ce}-compact${Be}last-item`]:gt,[`${ce}-compact${Be}item-rtl`]:Ze==="rtl"})},[ce,Ze,xt]);return{compactSize:xt==null?void 0:xt.compactSize,compactDirection:xt==null?void 0:xt.compactDirection,compactItemClassnames:ht}};W.useCompactItemContext=te;const ye=ce=>{let{children:Ze}=ce;return E.createElement(ze.Provider,{value:null},Ze)};W.NoCompactStyle=ye;const De=ce=>{var{children:Ze}=ce,xt=oe(ce,["children"]);return E.createElement(ze.Provider,{value:xt},Ze)},Se=ce=>{const{getPrefixCls:Ze,direction:xt}=E.useContext(fe.ConfigContext),{size:ht,direction:Gt,block:mt,prefixCls:gt,className:Be,rootClassName:Re,children:bt}=ce,yt=oe(ce,["size","direction","block","prefixCls","className","rootClassName","children"]),At=(0,ae.default)(Ot=>ht!=null?ht:Ot),bn=Ze("space-compact",gt),[He,Rt]=(0,Ee.default)(bn),Oe=(0,ve.default)(bn,Rt,{[`${bn}-rtl`]:xt==="rtl",[`${bn}-block`]:mt,[`${bn}-vertical`]:Gt==="vertical"},Be,Re),it=E.useContext(ze),Qe=(0,re.default)(bt),$e=E.useMemo(()=>Qe.map((Ot,vt)=>{const Me=(Ot==null?void 0:Ot.key)||`${bn}-item-${vt}`;return E.createElement(De,{key:Me,compactSize:At,compactDirection:Gt,isFirstItem:vt===0&&(!it||(it==null?void 0:it.isFirstItem)),isLastItem:vt===Qe.length-1&&(!it||(it==null?void 0:it.isLastItem))},Ot)}),[ht,Qe,it]);return Qe.length===0?null:He(E.createElement("div",Object.assign({className:Oe},yt),$e))};var we=W.default=Se},35969:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>{const{componentCls:E}=X;return{[E]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}};var ee=W.default=D},54277:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.prepareComponentToken=W.default=void 0;var X=D(3184),E=ee(D(35969));const ve=Ee=>{const{componentCls:oe,antCls:ze}=Ee;return{[oe]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${oe}-item:empty`]:{display:"none"},[`${oe}-item > ${ze}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},re=Ee=>{const{componentCls:oe}=Ee;return{[oe]:{"&-gap-row-small":{rowGap:Ee.spaceGapSmallSize},"&-gap-row-middle":{rowGap:Ee.spaceGapMiddleSize},"&-gap-row-large":{rowGap:Ee.spaceGapLargeSize},"&-gap-col-small":{columnGap:Ee.spaceGapSmallSize},"&-gap-col-middle":{columnGap:Ee.spaceGapMiddleSize},"&-gap-col-large":{columnGap:Ee.spaceGapLargeSize}}}},fe=()=>({});W.prepareComponentToken=fe;var ae=W.default=(0,X.genStyleHooks)("Space",Ee=>{const oe=(0,X.mergeToken)(Ee,{spaceGapSmallSize:Ee.paddingXS,spaceGapMiddleSize:Ee.padding,spaceGapLargeSize:Ee.paddingLG});return[ve(oe),re(oe),(0,E.default)(oe)]},()=>({}),{resetStyle:!1})},78793:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genCompactItemStyle=X;function D(E,ve,re){const{focusElCls:fe,focus:ae,borderElCls:Ee}=re,oe=Ee?"> *":"",ze=["hover",ae?"focus":null,"active"].filter(Boolean).map(te=>`&:${te} ${oe}`).join(",");return{[`&-item:not(${ve}-last-item)`]:{marginInlineEnd:E.calc(E.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[ze]:{zIndex:2}},fe?{[`&${fe}`]:{zIndex:2}}:{}),{[`&[disabled] ${oe}`]:{zIndex:0}})}}function ee(E,ve,re){const{borderElCls:fe}=re,ae=fe?`> ${fe}`:"";return{[`&-item:not(${ve}-first-item):not(${ve}-last-item) ${ae}`]:{borderRadius:0},[`&-item:not(${ve}-last-item)${ve}-first-item`]:{[`& ${ae}, &${E}-sm ${ae}, &${E}-lg ${ae}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${ve}-first-item)${ve}-last-item`]:{[`& ${ae}, &${E}-sm ${ae}, &${E}-lg ${ae}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function X(E){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:re}=E,fe=`${re}-compact`;return{[fe]:Object.assign(Object.assign({},D(E,fe,ve)),ee(re,fe,ve))}}},98078:function($t,W,D){"use strict";"use client";Object.defineProperty(W,"__esModule",{value:!0}),W.genLinkStyle=W.genFocusStyle=W.genFocusOutline=W.genCommonStyle=W.clearFix=void 0,Object.defineProperty(W,"operationUnit",{enumerable:!0,get:function(){return X.operationUnit}}),W.textEllipsis=W.resetIcon=W.resetComponent=void 0;var ee=D(85982),X=D(22548);const E=W.textEllipsis={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},ve=function(te){let ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:te.colorText,fontSize:te.fontSize,lineHeight:te.lineHeight,listStyle:"none",fontFamily:ye?"inherit":te.fontFamily}};W.resetComponent=ve;const re=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}});W.resetIcon=re;const fe=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}});W.clearFix=fe;const ae=te=>({a:{color:te.colorLink,textDecoration:te.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${te.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:te.colorLinkHover},"&:active":{color:te.colorLinkActive},"&:active, &:hover":{textDecoration:te.linkHoverDecoration,outline:0},"&:focus":{textDecoration:te.linkFocusDecoration,outline:0},"&[disabled]":{color:te.colorTextDisabled,cursor:"not-allowed"}}});W.genLinkStyle=ae;const Ee=(te,ye,De,Se)=>{const we=`[class^="${ye}"], [class*=" ${ye}"]`,ce=De?`.${De}`:we,Ze={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let xt={};return Se!==!1&&(xt={fontFamily:te.fontFamily,fontSize:te.fontSize}),{[ce]:Object.assign(Object.assign(Object.assign({},xt),Ze),{[we]:Ze})}};W.genCommonStyle=Ee;const oe=te=>({outline:`${(0,ee.unit)(te.lineWidthFocus)} solid ${te.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"});W.genFocusOutline=oe;const ze=te=>({"&:focus-visible":Object.assign({},oe(te))});W.genFocusStyle=ze},57253:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>({[X.componentCls]:{[`${X.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${X.motionDurationMid} ${X.motionEaseInOut},
        opacity ${X.motionDurationMid} ${X.motionEaseInOut} !important`}},[`${X.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${X.motionDurationMid} ${X.motionEaseInOut},
        opacity ${X.motionDurationMid} ${X.motionEaseInOut} !important`}}});var ee=W.default=D},84460:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.initFadeMotion=W.fadeOut=W.fadeIn=void 0;var ee=D(85982),X=D(94631);const E=W.fadeIn=new ee.Keyframes("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),ve=W.fadeOut=new ee.Keyframes("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),re=function(fe){let ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:Ee}=fe,oe=`${Ee}-fade`,ze=ae?"&":"";return[(0,X.initMotion)(oe,E,ve,fe.motionDurationMid,ae),{[`
        ${ze}${oe}-enter,
        ${ze}${oe}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${ze}${oe}-leave`]:{animationTimingFunction:"linear"}}]};W.initFadeMotion=re},42836:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"fadeIn",{enumerable:!0,get:function(){return E.fadeIn}}),Object.defineProperty(W,"fadeOut",{enumerable:!0,get:function(){return E.fadeOut}}),Object.defineProperty(W,"genCollapseMotion",{enumerable:!0,get:function(){return X.default}}),Object.defineProperty(W,"initFadeMotion",{enumerable:!0,get:function(){return E.initFadeMotion}}),Object.defineProperty(W,"initMoveMotion",{enumerable:!0,get:function(){return ve.initMoveMotion}}),Object.defineProperty(W,"initSlideMotion",{enumerable:!0,get:function(){return re.initSlideMotion}}),Object.defineProperty(W,"initZoomMotion",{enumerable:!0,get:function(){return fe.initZoomMotion}}),Object.defineProperty(W,"moveDownIn",{enumerable:!0,get:function(){return ve.moveDownIn}}),Object.defineProperty(W,"moveDownOut",{enumerable:!0,get:function(){return ve.moveDownOut}}),Object.defineProperty(W,"moveLeftIn",{enumerable:!0,get:function(){return ve.moveLeftIn}}),Object.defineProperty(W,"moveLeftOut",{enumerable:!0,get:function(){return ve.moveLeftOut}}),Object.defineProperty(W,"moveRightIn",{enumerable:!0,get:function(){return ve.moveRightIn}}),Object.defineProperty(W,"moveRightOut",{enumerable:!0,get:function(){return ve.moveRightOut}}),Object.defineProperty(W,"moveUpIn",{enumerable:!0,get:function(){return ve.moveUpIn}}),Object.defineProperty(W,"moveUpOut",{enumerable:!0,get:function(){return ve.moveUpOut}}),Object.defineProperty(W,"slideDownIn",{enumerable:!0,get:function(){return re.slideDownIn}}),Object.defineProperty(W,"slideDownOut",{enumerable:!0,get:function(){return re.slideDownOut}}),Object.defineProperty(W,"slideLeftIn",{enumerable:!0,get:function(){return re.slideLeftIn}}),Object.defineProperty(W,"slideLeftOut",{enumerable:!0,get:function(){return re.slideLeftOut}}),Object.defineProperty(W,"slideRightIn",{enumerable:!0,get:function(){return re.slideRightIn}}),Object.defineProperty(W,"slideRightOut",{enumerable:!0,get:function(){return re.slideRightOut}}),Object.defineProperty(W,"slideUpIn",{enumerable:!0,get:function(){return re.slideUpIn}}),Object.defineProperty(W,"slideUpOut",{enumerable:!0,get:function(){return re.slideUpOut}}),Object.defineProperty(W,"zoomBigIn",{enumerable:!0,get:function(){return fe.zoomBigIn}}),Object.defineProperty(W,"zoomBigOut",{enumerable:!0,get:function(){return fe.zoomBigOut}}),Object.defineProperty(W,"zoomDownIn",{enumerable:!0,get:function(){return fe.zoomDownIn}}),Object.defineProperty(W,"zoomDownOut",{enumerable:!0,get:function(){return fe.zoomDownOut}}),Object.defineProperty(W,"zoomIn",{enumerable:!0,get:function(){return fe.zoomIn}}),Object.defineProperty(W,"zoomLeftIn",{enumerable:!0,get:function(){return fe.zoomLeftIn}}),Object.defineProperty(W,"zoomLeftOut",{enumerable:!0,get:function(){return fe.zoomLeftOut}}),Object.defineProperty(W,"zoomOut",{enumerable:!0,get:function(){return fe.zoomOut}}),Object.defineProperty(W,"zoomRightIn",{enumerable:!0,get:function(){return fe.zoomRightIn}}),Object.defineProperty(W,"zoomRightOut",{enumerable:!0,get:function(){return fe.zoomRightOut}}),Object.defineProperty(W,"zoomUpIn",{enumerable:!0,get:function(){return fe.zoomUpIn}}),Object.defineProperty(W,"zoomUpOut",{enumerable:!0,get:function(){return fe.zoomUpOut}});var X=ee(D(57253)),E=D(84460),ve=D(17060),re=D(17581),fe=D(99269)},94631:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.initMotion=void 0;const D=E=>({animationDuration:E,animationFillMode:"both"}),ee=E=>({animationDuration:E,animationFillMode:"both"}),X=function(E,ve,re,fe){const Ee=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${Ee}${E}-enter,
      ${Ee}${E}-appear
    `]:Object.assign(Object.assign({},D(fe)),{animationPlayState:"paused"}),[`${Ee}${E}-leave`]:Object.assign(Object.assign({},ee(fe)),{animationPlayState:"paused"}),[`
      ${Ee}${E}-enter${E}-enter-active,
      ${Ee}${E}-appear${E}-appear-active
    `]:{animationName:ve,animationPlayState:"running"},[`${Ee}${E}-leave${E}-leave-active`]:{animationName:re,animationPlayState:"running",pointerEvents:"none"}}};W.initMotion=X},17060:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.moveUpOut=W.moveUpIn=W.moveRightOut=W.moveRightIn=W.moveLeftOut=W.moveLeftIn=W.moveDownOut=W.moveDownIn=W.initMoveMotion=void 0;var ee=D(85982),X=D(94631);const E=W.moveDownIn=new ee.Keyframes("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),ve=W.moveDownOut=new ee.Keyframes("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),re=W.moveLeftIn=new ee.Keyframes("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),fe=W.moveLeftOut=new ee.Keyframes("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),ae=W.moveRightIn=new ee.Keyframes("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Ee=W.moveRightOut=new ee.Keyframes("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),oe=W.moveUpIn=new ee.Keyframes("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),ze=W.moveUpOut=new ee.Keyframes("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),te={"move-up":{inKeyframes:oe,outKeyframes:ze},"move-down":{inKeyframes:E,outKeyframes:ve},"move-left":{inKeyframes:re,outKeyframes:fe},"move-right":{inKeyframes:ae,outKeyframes:Ee}},ye=(De,Se)=>{const{antCls:we}=De,ce=`${we}-${Se}`,{inKeyframes:Ze,outKeyframes:xt}=te[Se];return[(0,X.initMotion)(ce,Ze,xt,De.motionDurationMid),{[`
        ${ce}-enter,
        ${ce}-appear
      `]:{opacity:0,animationTimingFunction:De.motionEaseOutCirc},[`${ce}-leave`]:{animationTimingFunction:De.motionEaseInOutCirc}}]};W.initMoveMotion=ye},17581:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.slideUpOut=W.slideUpIn=W.slideRightOut=W.slideRightIn=W.slideLeftOut=W.slideLeftIn=W.slideDownOut=W.slideDownIn=W.initSlideMotion=void 0;var ee=D(85982),X=D(94631);const E=W.slideUpIn=new ee.Keyframes("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),ve=W.slideUpOut=new ee.Keyframes("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),re=W.slideDownIn=new ee.Keyframes("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),fe=W.slideDownOut=new ee.Keyframes("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),ae=W.slideLeftIn=new ee.Keyframes("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),Ee=W.slideLeftOut=new ee.Keyframes("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),oe=W.slideRightIn=new ee.Keyframes("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),ze=W.slideRightOut=new ee.Keyframes("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),te={"slide-up":{inKeyframes:E,outKeyframes:ve},"slide-down":{inKeyframes:re,outKeyframes:fe},"slide-left":{inKeyframes:ae,outKeyframes:Ee},"slide-right":{inKeyframes:oe,outKeyframes:ze}},ye=(De,Se)=>{const{antCls:we}=De,ce=`${we}-${Se}`,{inKeyframes:Ze,outKeyframes:xt}=te[Se];return[(0,X.initMotion)(ce,Ze,xt,De.motionDurationMid),{[`
      ${ce}-enter,
      ${ce}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:De.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${ce}-leave`]:{animationTimingFunction:De.motionEaseInQuint}}]};W.initSlideMotion=ye},99269:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.zoomUpOut=W.zoomUpIn=W.zoomRightOut=W.zoomRightIn=W.zoomOut=W.zoomLeftOut=W.zoomLeftIn=W.zoomIn=W.zoomDownOut=W.zoomDownIn=W.zoomBigOut=W.zoomBigIn=W.initZoomMotion=void 0;var ee=D(85982),X=D(94631);const E=W.zoomIn=new ee.Keyframes("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),ve=W.zoomOut=new ee.Keyframes("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),re=W.zoomBigIn=new ee.Keyframes("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),fe=W.zoomBigOut=new ee.Keyframes("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),ae=W.zoomUpIn=new ee.Keyframes("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Ee=W.zoomUpOut=new ee.Keyframes("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),oe=W.zoomLeftIn=new ee.Keyframes("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),ze=W.zoomLeftOut=new ee.Keyframes("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),te=W.zoomRightIn=new ee.Keyframes("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),ye=W.zoomRightOut=new ee.Keyframes("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),De=W.zoomDownIn=new ee.Keyframes("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),Se=W.zoomDownOut=new ee.Keyframes("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),we={zoom:{inKeyframes:E,outKeyframes:ve},"zoom-big":{inKeyframes:re,outKeyframes:fe},"zoom-big-fast":{inKeyframes:re,outKeyframes:fe},"zoom-left":{inKeyframes:oe,outKeyframes:ze},"zoom-right":{inKeyframes:te,outKeyframes:ye},"zoom-up":{inKeyframes:ae,outKeyframes:Ee},"zoom-down":{inKeyframes:De,outKeyframes:Se}},ce=(Ze,xt)=>{const{antCls:ht}=Ze,Gt=`${ht}-${xt}`,{inKeyframes:mt,outKeyframes:gt}=we[xt];return[(0,X.initMotion)(Gt,mt,gt,xt==="zoom-big-fast"?Ze.motionDurationFast:Ze.motionDurationMid),{[`
        ${Gt}-enter,
        ${Gt}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:Ze.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${Gt}-leave`]:{animationTimingFunction:Ze.motionEaseInOutCirc}}]};W.initZoomMotion=ce},22548:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.operationUnit=void 0;const D=ee=>({color:ee.colorLink,textDecoration:"none",outline:"none",cursor:"pointer",transition:`color ${ee.motionDurationSlow}`,"&:focus, &:hover":{color:ee.colorLinkHover},"&:active":{color:ee.colorLinkActive}});W.operationUnit=D},9064:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.MAX_VERTICAL_CONTENT_RADIUS=void 0,W.default=fe,W.getArrowOffsetToken=ve;var ee=D(85982),X=D(51337);const E=W.MAX_VERTICAL_CONTENT_RADIUS=8;function ve(ae){const{contentRadius:Ee,limitVerticalRadius:oe}=ae,ze=Ee>12?Ee+2:12;return{arrowOffsetHorizontal:ze,arrowOffsetVertical:oe?E:ze}}function re(ae,Ee){return ae?Ee:{}}function fe(ae,Ee,oe){const{componentCls:ze,boxShadowPopoverArrow:te,arrowOffsetVertical:ye,arrowOffsetHorizontal:De}=ae,{arrowDistance:Se=0,arrowPlacement:we={left:!0,right:!0,top:!0,bottom:!0}}=oe||{};return{[ze]:Object.assign(Object.assign(Object.assign(Object.assign({[`${ze}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},(0,X.genRoundedArrow)(ae,Ee,te)),{"&:before":{background:Ee}})]},re(!!we.top,{[[`&-placement-top > ${ze}-arrow`,`&-placement-topLeft > ${ze}-arrow`,`&-placement-topRight > ${ze}-arrow`].join(",")]:{bottom:Se,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${ze}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":De,[`> ${ze}-arrow`]:{left:{_skip_check_:!0,value:De}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,ee.unit)(De)})`,[`> ${ze}-arrow`]:{right:{_skip_check_:!0,value:De}}}})),re(!!we.bottom,{[[`&-placement-bottom > ${ze}-arrow`,`&-placement-bottomLeft > ${ze}-arrow`,`&-placement-bottomRight > ${ze}-arrow`].join(",")]:{top:Se,transform:"translateY(-100%)"},[`&-placement-bottom > ${ze}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":De,[`> ${ze}-arrow`]:{left:{_skip_check_:!0,value:De}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,ee.unit)(De)})`,[`> ${ze}-arrow`]:{right:{_skip_check_:!0,value:De}}}})),re(!!we.left,{[[`&-placement-left > ${ze}-arrow`,`&-placement-leftTop > ${ze}-arrow`,`&-placement-leftBottom > ${ze}-arrow`].join(",")]:{right:{_skip_check_:!0,value:Se},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${ze}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${ze}-arrow`]:{top:ye},[`&-placement-leftBottom > ${ze}-arrow`]:{bottom:ye}})),re(!!we.right,{[[`&-placement-right > ${ze}-arrow`,`&-placement-rightTop > ${ze}-arrow`,`&-placement-rightBottom > ${ze}-arrow`].join(",")]:{left:{_skip_check_:!0,value:Se},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${ze}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${ze}-arrow`]:{top:ye},[`&-placement-rightBottom > ${ze}-arrow`]:{bottom:ye}}))}}},51337:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genRoundedArrow=void 0,W.getArrowToken=X;var ee=D(85982);function X(ve){const{sizePopupArrow:re,borderRadiusXS:fe,borderRadiusOuter:ae}=ve,Ee=re/2,oe=0,ze=Ee,te=ae*1/Math.sqrt(2),ye=Ee-ae*(1-1/Math.sqrt(2)),De=Ee-fe*(1/Math.sqrt(2)),Se=ae*(Math.sqrt(2)-1)+fe*(1/Math.sqrt(2)),we=2*Ee-De,ce=Se,Ze=2*Ee-te,xt=ye,ht=2*Ee-oe,Gt=ze,mt=Ee*Math.sqrt(2)+ae*(Math.sqrt(2)-2),gt=ae*(Math.sqrt(2)-1),Be=`polygon(${gt}px 100%, 50% ${gt}px, ${2*Ee-gt}px 100%, ${gt}px 100%)`,Re=`path('M ${oe} ${ze} A ${ae} ${ae} 0 0 0 ${te} ${ye} L ${De} ${Se} A ${fe} ${fe} 0 0 1 ${we} ${ce} L ${Ze} ${xt} A ${ae} ${ae} 0 0 0 ${ht} ${Gt} Z')`;return{arrowShadowWidth:mt,arrowPath:Re,arrowPolygon:Be}}const E=(ve,re,fe)=>{const{sizePopupArrow:ae,arrowPolygon:Ee,arrowPath:oe,arrowShadowWidth:ze,borderRadiusXS:te,calc:ye}=ve;return{pointerEvents:"none",width:ae,height:ae,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:ae,height:ye(ae).div(2).equal(),background:re,clipPath:{_multi_value_:!0,value:[Ee,oe]},content:'""'},"&::after":{content:'""',position:"absolute",width:ze,height:ze,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${(0,ee.unit)(te)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:fe,zIndex:0,background:"transparent"}}};W.genRoundedArrow=E},89329:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.defaultTheme=W.defaultConfig=W.DesignTokenContext=void 0;var X=ee(D(67294)),E=D(85982),ve=ee(D(9924)),re=ee(D(98411));const fe=W.defaultTheme=(0,E.createTheme)(ve.default),ae=W.defaultConfig={token:re.default,override:{override:re.default},hashed:!0},Ee=W.DesignTokenContext=X.default.createContext(ae)},36496:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"PresetColors",{enumerable:!0,get:function(){return ee.PresetColors}});var ee=D(81342)},81342:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.PresetColors=void 0;const D=W.PresetColors=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"]},3184:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"DesignTokenContext",{enumerable:!0,get:function(){return ze.DesignTokenContext}}),Object.defineProperty(W,"PresetColors",{enumerable:!0,get:function(){return ve.PresetColors}}),Object.defineProperty(W,"calc",{enumerable:!0,get:function(){return E.genCalc}}),Object.defineProperty(W,"defaultConfig",{enumerable:!0,get:function(){return ze.defaultConfig}}),Object.defineProperty(W,"genComponentStyleHook",{enumerable:!0,get:function(){return ae.genComponentStyleHook}}),Object.defineProperty(W,"genPresetColor",{enumerable:!0,get:function(){return Ee.default}}),Object.defineProperty(W,"genStyleHooks",{enumerable:!0,get:function(){return ae.genStyleHooks}}),Object.defineProperty(W,"genSubStyleComponent",{enumerable:!0,get:function(){return ae.genSubStyleComponent}}),Object.defineProperty(W,"getLineHeight",{enumerable:!0,get:function(){return re.getLineHeight}}),Object.defineProperty(W,"mergeToken",{enumerable:!0,get:function(){return E.mergeToken}}),Object.defineProperty(W,"statistic",{enumerable:!0,get:function(){return E.statistic}}),Object.defineProperty(W,"statisticToken",{enumerable:!0,get:function(){return E.statisticToken}}),Object.defineProperty(W,"useResetIconStyle",{enumerable:!0,get:function(){return oe.default}}),Object.defineProperty(W,"useStyleRegister",{enumerable:!0,get:function(){return X.useStyleRegister}}),Object.defineProperty(W,"useToken",{enumerable:!0,get:function(){return fe.default}});var X=D(85982),E=D(83262),ve=D(36496),re=D(62231),fe=ee(D(41401)),ae=D(24225),Ee=ee(D(36219)),oe=ee(D(54894)),ze=D(89329)},26162:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getSolidColor=W.getAlphaColor=void 0;var ee=D(131);const X=(ve,re)=>new ee.TinyColor(ve).setAlpha(re).toRgbString();W.getAlphaColor=X;const E=(ve,re)=>new ee.TinyColor(ve).darken(re).toHexString();W.getSolidColor=E},80373:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.generateNeutralColorPalettes=W.generateColorPalettes=void 0;var ee=D(65409),X=D(26162);const E=re=>{const fe=(0,ee.generate)(re);return{1:fe[0],2:fe[1],3:fe[2],4:fe[3],5:fe[4],6:fe[5],7:fe[6],8:fe[4],9:fe[5],10:fe[6]}};W.generateColorPalettes=E;const ve=(re,fe)=>{const ae=re||"#fff",Ee=fe||"#000";return{colorBgBase:ae,colorTextBase:Ee,colorText:(0,X.getAlphaColor)(Ee,.88),colorTextSecondary:(0,X.getAlphaColor)(Ee,.65),colorTextTertiary:(0,X.getAlphaColor)(Ee,.45),colorTextQuaternary:(0,X.getAlphaColor)(Ee,.25),colorFill:(0,X.getAlphaColor)(Ee,.15),colorFillSecondary:(0,X.getAlphaColor)(Ee,.06),colorFillTertiary:(0,X.getAlphaColor)(Ee,.04),colorFillQuaternary:(0,X.getAlphaColor)(Ee,.02),colorBgLayout:(0,X.getSolidColor)(ae,4),colorBgContainer:(0,X.getSolidColor)(ae,0),colorBgElevated:(0,X.getSolidColor)(ae,0),colorBgSpotlight:(0,X.getAlphaColor)(Ee,.85),colorBgBlur:"transparent",colorBorder:(0,X.getSolidColor)(ae,15),colorBorderSecondary:(0,X.getSolidColor)(ae,6)}};W.generateNeutralColorPalettes=ve},9924:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=ze;var X=D(65409),E=D(98411),ve=ee(D(10805)),re=ee(D(81594)),fe=ee(D(54730)),ae=ee(D(69853)),Ee=ee(D(19216)),oe=D(80373);function ze(te){X.presetPrimaryColors.pink=X.presetPrimaryColors.magenta,X.presetPalettes.pink=X.presetPalettes.magenta;const ye=Object.keys(E.defaultPresetColors).map(De=>{const Se=te[De]===X.presetPrimaryColors[De]?X.presetPalettes[De]:(0,X.generate)(te[De]);return new Array(10).fill(1).reduce((we,ce,Ze)=>(we[`${De}-${Ze+1}`]=Se[Ze],we[`${De}${Ze+1}`]=Se[Ze],we),{})}).reduce((De,Se)=>(De=Object.assign(Object.assign({},De),Se),De),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},te),ye),(0,ve.default)(te,{generateColorPalettes:oe.generateColorPalettes,generateNeutralColorPalettes:oe.generateNeutralColorPalettes})),(0,ae.default)(te.fontSize)),(0,Ee.default)(te)),(0,fe.default)(te)),(0,re.default)(te))}},98411:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.defaultPresetColors=W.default=void 0;const D=W.defaultPresetColors={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},ee=Object.assign(Object.assign({},D),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});var X=W.default=ee},10805:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=X;var ee=D(131);function X(E,ve){let{generateColorPalettes:re,generateNeutralColorPalettes:fe}=ve;const{colorSuccess:ae,colorWarning:Ee,colorError:oe,colorInfo:ze,colorPrimary:te,colorBgBase:ye,colorTextBase:De}=E,Se=re(te),we=re(ae),ce=re(Ee),Ze=re(oe),xt=re(ze),ht=fe(ye,De),Gt=E.colorLink||E.colorInfo,mt=re(Gt);return Object.assign(Object.assign({},ht),{colorPrimaryBg:Se[1],colorPrimaryBgHover:Se[2],colorPrimaryBorder:Se[3],colorPrimaryBorderHover:Se[4],colorPrimaryHover:Se[5],colorPrimary:Se[6],colorPrimaryActive:Se[7],colorPrimaryTextHover:Se[8],colorPrimaryText:Se[9],colorPrimaryTextActive:Se[10],colorSuccessBg:we[1],colorSuccessBgHover:we[2],colorSuccessBorder:we[3],colorSuccessBorderHover:we[4],colorSuccessHover:we[4],colorSuccess:we[6],colorSuccessActive:we[7],colorSuccessTextHover:we[8],colorSuccessText:we[9],colorSuccessTextActive:we[10],colorErrorBg:Ze[1],colorErrorBgHover:Ze[2],colorErrorBgActive:Ze[3],colorErrorBorder:Ze[3],colorErrorBorderHover:Ze[4],colorErrorHover:Ze[5],colorError:Ze[6],colorErrorActive:Ze[7],colorErrorTextHover:Ze[8],colorErrorText:Ze[9],colorErrorTextActive:Ze[10],colorWarningBg:ce[1],colorWarningBgHover:ce[2],colorWarningBorder:ce[3],colorWarningBorderHover:ce[4],colorWarningHover:ce[4],colorWarning:ce[6],colorWarningActive:ce[7],colorWarningTextHover:ce[8],colorWarningText:ce[9],colorWarningTextActive:ce[10],colorInfoBg:xt[1],colorInfoBgHover:xt[2],colorInfoBorder:xt[3],colorInfoBorderHover:xt[4],colorInfoHover:xt[4],colorInfo:xt[6],colorInfoActive:xt[7],colorInfoTextHover:xt[8],colorInfoText:xt[9],colorInfoTextActive:xt[10],colorLinkHover:mt[4],colorLink:mt[6],colorLinkActive:mt[7],colorBgMask:new ee.TinyColor("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},81594:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(78117));function E(ve){const{motionUnit:re,motionBase:fe,borderRadius:ae,lineWidth:Ee}=ve;return Object.assign({motionDurationFast:`${(fe+re).toFixed(1)}s`,motionDurationMid:`${(fe+re*2).toFixed(1)}s`,motionDurationSlow:`${(fe+re*3).toFixed(1)}s`,lineWidthBold:Ee+1},(0,X.default)(ae))}},54730:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>{const{controlHeight:E}=X;return{controlHeightSM:E*.75,controlHeightXS:E*.5,controlHeightLG:E*1.25}};var ee=W.default=D},69853:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(62231));const E=re=>{const fe=(0,X.default)(re),ae=fe.map(we=>we.size),Ee=fe.map(we=>we.lineHeight),oe=ae[1],ze=ae[0],te=ae[2],ye=Ee[1],De=Ee[0],Se=Ee[2];return{fontSizeSM:ze,fontSize:oe,fontSizeLG:te,fontSizeXL:ae[3],fontSizeHeading1:ae[6],fontSizeHeading2:ae[5],fontSizeHeading3:ae[4],fontSizeHeading4:ae[3],fontSizeHeading5:ae[2],lineHeight:ye,lineHeightLG:Se,lineHeightSM:De,fontHeight:Math.round(ye*oe),fontHeightLG:Math.round(Se*te),fontHeightSM:Math.round(De*ze),lineHeightHeading1:Ee[6],lineHeightHeading2:Ee[5],lineHeightHeading3:Ee[4],lineHeightHeading4:Ee[3],lineHeightHeading5:Ee[2]}};var ve=W.default=E},62231:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=ee,W.getLineHeight=D;function D(X){return(X+8)/X}function ee(X){const E=new Array(10).fill(null).map((ve,re)=>{const fe=re-1,ae=X*Math.pow(Math.E,fe/5),Ee=re>1?Math.floor(ae):Math.ceil(ae);return Math.floor(Ee/2)*2});return E[1]=X,E.map(ve=>({size:ve,lineHeight:D(ve)}))}},78117:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>{let E=X,ve=X,re=X,fe=X;return X<6&&X>=5?E=X+1:X<16&&X>=6?E=X+2:X>=16&&(E=16),X<7&&X>=5?ve=4:X<8&&X>=7?ve=5:X<14&&X>=8?ve=6:X<16&&X>=14?ve=7:X>=16&&(ve=8),X<6&&X>=2?re=1:X>=6&&(re=2),X>4&&X<8?fe=4:X>=8&&(fe=6),{borderRadius:X,borderRadiusXS:re,borderRadiusSM:ve,borderRadiusLG:E,borderRadiusOuter:fe}};var ee=W.default=D},19216:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=D;function D(ee){const{sizeUnit:X,sizeStep:E}=ee;return{sizeXXL:X*(E+8),sizeXL:X*(E+4),sizeLG:X*(E+2),sizeMD:X*(E+1),sizeMS:X*E,size:X*E,sizeSM:X*(E-1),sizeXS:X*(E-2),sizeXXS:X*(E-3)}}},41401:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=De,W.unitless=W.ignore=W.getComputedToken=void 0;var X=ee(D(67294)),E=D(85982),ve=ee(D(87629)),re=D(89329),fe=ee(D(98411)),ae=ee(D(27722)),Ee=function(Se,we){var ce={};for(var Ze in Se)Object.prototype.hasOwnProperty.call(Se,Ze)&&we.indexOf(Ze)<0&&(ce[Ze]=Se[Ze]);if(Se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var xt=0,Ze=Object.getOwnPropertySymbols(Se);xt<Ze.length;xt++)we.indexOf(Ze[xt])<0&&Object.prototype.propertyIsEnumerable.call(Se,Ze[xt])&&(ce[Ze[xt]]=Se[Ze[xt]]);return ce};const oe=W.unitless={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},ze=W.ignore={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},te={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},ye=(Se,we,ce)=>{const Ze=ce.getDerivativeToken(Se),{override:xt}=we,ht=Ee(we,["override"]);let Gt=Object.assign(Object.assign({},Ze),{override:xt});return Gt=(0,ae.default)(Gt),ht&&Object.entries(ht).forEach(mt=>{let[gt,Be]=mt;const{theme:Re}=Be,bt=Ee(Be,["theme"]);let yt=bt;Re&&(yt=ye(Object.assign(Object.assign({},Gt),bt),{override:bt},Re)),Gt[gt]=yt}),Gt};W.getComputedToken=ye;function De(){const{token:Se,hashed:we,theme:ce,override:Ze,cssVar:xt}=X.default.useContext(re.DesignTokenContext),ht=`${ve.default}-${we||""}`,Gt=ce||re.defaultTheme,[mt,gt,Be]=(0,E.useCacheToken)(Gt,[fe.default,Se],{salt:ht,override:Ze,getComputedToken:ye,formatToken:ae.default,cssVar:xt&&{prefix:xt.prefix,key:xt.key,unitless:oe,ignore:ze,preserve:te}});return[Gt,Be,we?gt:"",mt,xt]}},27722:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=fe;var X=D(131),E=ee(D(98411)),ve=ee(D(83609)),re=function(ae,Ee){var oe={};for(var ze in ae)Object.prototype.hasOwnProperty.call(ae,ze)&&Ee.indexOf(ze)<0&&(oe[ze]=ae[ze]);if(ae!=null&&typeof Object.getOwnPropertySymbols=="function")for(var te=0,ze=Object.getOwnPropertySymbols(ae);te<ze.length;te++)Ee.indexOf(ze[te])<0&&Object.prototype.propertyIsEnumerable.call(ae,ze[te])&&(oe[ze[te]]=ae[ze[te]]);return oe};function fe(ae){const{override:Ee}=ae,oe=re(ae,["override"]),ze=Object.assign({},Ee);Object.keys(E.default).forEach(ht=>{delete ze[ht]});const te=Object.assign(Object.assign({},oe),ze),ye=480,De=576,Se=768,we=992,ce=1200,Ze=1600;if(te.motion===!1){const ht="0s";te.motionDurationFast=ht,te.motionDurationMid=ht,te.motionDurationSlow=ht}return Object.assign(Object.assign(Object.assign({},te),{colorFillContent:te.colorFillSecondary,colorFillContentHover:te.colorFill,colorFillAlter:te.colorFillQuaternary,colorBgContainerDisabled:te.colorFillTertiary,colorBorderBg:te.colorBgContainer,colorSplit:(0,ve.default)(te.colorBorderSecondary,te.colorBgContainer),colorTextPlaceholder:te.colorTextQuaternary,colorTextDisabled:te.colorTextQuaternary,colorTextHeading:te.colorText,colorTextLabel:te.colorTextSecondary,colorTextDescription:te.colorTextTertiary,colorTextLightSolid:te.colorWhite,colorHighlight:te.colorError,colorBgTextHover:te.colorFillSecondary,colorBgTextActive:te.colorFill,colorIcon:te.colorTextTertiary,colorIconHover:te.colorText,colorErrorOutline:(0,ve.default)(te.colorErrorBg,te.colorBgContainer),colorWarningOutline:(0,ve.default)(te.colorWarningBg,te.colorBgContainer),fontSizeIcon:te.fontSizeSM,lineWidthFocus:te.lineWidth*4,lineWidth:te.lineWidth,controlOutlineWidth:te.lineWidth*2,controlInteractiveSize:te.controlHeight/2,controlItemBgHover:te.colorFillTertiary,controlItemBgActive:te.colorPrimaryBg,controlItemBgActiveHover:te.colorPrimaryBgHover,controlItemBgActiveDisabled:te.colorFill,controlTmpOutline:te.colorFillQuaternary,controlOutline:(0,ve.default)(te.colorPrimaryBg,te.colorBgContainer),lineType:te.lineType,borderRadius:te.borderRadius,borderRadiusXS:te.borderRadiusXS,borderRadiusSM:te.borderRadiusSM,borderRadiusLG:te.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:te.sizeXXS,paddingXS:te.sizeXS,paddingSM:te.sizeSM,padding:te.size,paddingMD:te.sizeMD,paddingLG:te.sizeLG,paddingXL:te.sizeXL,paddingContentHorizontalLG:te.sizeLG,paddingContentVerticalLG:te.sizeMS,paddingContentHorizontal:te.sizeMS,paddingContentVertical:te.sizeSM,paddingContentHorizontalSM:te.size,paddingContentVerticalSM:te.sizeXS,marginXXS:te.sizeXXS,marginXS:te.sizeXS,marginSM:te.sizeSM,margin:te.size,marginMD:te.sizeMD,marginLG:te.sizeLG,marginXL:te.sizeXL,marginXXL:te.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:ye,screenXSMin:ye,screenXSMax:De-1,screenSM:De,screenSMMin:De,screenSMMax:Se-1,screenMD:Se,screenMDMin:Se,screenMDMax:we-1,screenLG:we,screenLGMin:we,screenLGMax:ce-1,screenXL:ce,screenXLMin:ce,screenXLMax:Ze-1,screenXXL:Ze,screenXXLMin:Ze,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new X.TinyColor("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new X.TinyColor("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new X.TinyColor("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),ze)}},36219:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=X;var ee=D(36496);function X(E,ve){return ee.PresetColors.reduce((re,fe)=>{const ae=E[`${fe}1`],Ee=E[`${fe}3`],oe=E[`${fe}6`],ze=E[`${fe}7`];return Object.assign(Object.assign({},re),ve(fe,{lightColor:ae,lightBorderColor:Ee,darkColor:oe,textColor:ze}))},{})}},24225:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.genSubStyleComponent=W.genStyleHooks=W.genComponentStyleHook=void 0;var E=D(67294),ve=D(83262),re=D(7177),fe=D(98078),ae=X(D(41401)),Ee=ee(D(54894));const{genStyleHooks:oe,genComponentStyleHook:ze,genSubStyleComponent:te}=(0,ve.genStyleUtils)({usePrefix:()=>{const{getPrefixCls:ye,iconPrefixCls:De}=(0,E.useContext)(re.ConfigContext);return{rootPrefixCls:ye(),iconPrefixCls:De}},useToken:()=>{const[ye,De,Se,we,ce]=(0,ae.default)();return{theme:ye,realToken:De,hashId:Se,token:we,cssVar:ce}},useCSP:()=>{const{csp:ye,iconPrefixCls:De}=(0,E.useContext)(re.ConfigContext);return(0,Ee.default)(De,ye),ye!=null?ye:{}},getResetStyles:ye=>[{"&":(0,fe.genLinkStyle)(ye)}],getCommonStyle:fe.genCommonStyle,getCompUnitless:()=>ae.unitless});W.genSubStyleComponent=te,W.genComponentStyleHook=ze,W.genStyleHooks=oe},83609:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(131);function X(re){return re>=0&&re<=255}function E(re,fe){const{r:ae,g:Ee,b:oe,a:ze}=new ee.TinyColor(re).toRgb();if(ze<1)return re;const{r:te,g:ye,b:De}=new ee.TinyColor(fe).toRgb();for(let Se=.01;Se<=1;Se+=.01){const we=Math.round((ae-te*(1-Se))/Se),ce=Math.round((Ee-ye*(1-Se))/Se),Ze=Math.round((oe-De*(1-Se))/Se);if(X(we)&&X(ce)&&X(Ze))return new ee.TinyColor({r:we,g:ce,b:Ze,a:Math.round(Se*100)/100}).toRgbString()}return new ee.TinyColor({r:ae,g:Ee,b:oe,a:1}).toRgbString()}var ve=W.default=E},54894:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=D(85982),E=D(98078),ve=ee(D(41401));const re=(ae,Ee)=>{const[oe,ze]=(0,ve.default)();return(0,X.useStyleRegister)({theme:oe,token:ze,hashId:"",path:["ant-design-icons",ae],nonce:()=>Ee==null?void 0:Ee.nonce,layer:{name:"antd"}},()=>[{[`.${ae}`]:Object.assign(Object.assign({},(0,E.resetIcon)()),{[`.${ae} .${ae}-icon`]:{display:"block"}})}])};var fe=W.default=re},92125:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(93967)),re=D(92419),fe=D(31929),ae=ee(D(15086)),Ee=D(48125);const oe=te=>{const{prefixCls:ye,className:De,placement:Se="top",title:we,color:ce,overlayInnerStyle:Ze}=te,{getPrefixCls:xt}=E.useContext(fe.ConfigContext),ht=xt("tooltip",ye),[Gt,mt,gt]=(0,ae.default)(ht),Be=(0,Ee.parseColor)(ht,ce),Re=Be.arrowStyle,bt=Object.assign(Object.assign({},Ze),Be.overlayStyle),yt=(0,ve.default)(mt,gt,ht,`${ht}-pure`,`${ht}-placement-${Se}`,De,Be.className);return Gt(E.createElement("div",{className:yt,style:Re},E.createElement("div",{className:`${ht}-arrow`}),E.createElement(re.Popup,Object.assign({},te,{className:mt,prefixCls:ht,overlayInnerStyle:bt}),we)))};var ze=W.default=oe},94055:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(93967)),re=ee(D(92419)),fe=ee(D(60869)),ae=ee(D(85549)),Ee=D(56333),oe=D(53683),ze=ee(D(74132)),te=D(47419),ye=D(13594),De=ee(D(96877)),Se=D(31929),we=D(3184),ce=ee(D(92125)),Ze=ee(D(15086)),xt=D(48125),ht=function(Be,Re){var bt={};for(var yt in Be)Object.prototype.hasOwnProperty.call(Be,yt)&&Re.indexOf(yt)<0&&(bt[yt]=Be[yt]);if(Be!=null&&typeof Object.getOwnPropertySymbols=="function")for(var At=0,yt=Object.getOwnPropertySymbols(Be);At<yt.length;At++)Re.indexOf(yt[At])<0&&Object.prototype.propertyIsEnumerable.call(Be,yt[At])&&(bt[yt[At]]=Be[yt[At]]);return bt};const mt=E.forwardRef((Be,Re)=>{var bt,yt;const{prefixCls:At,openClassName:bn,getTooltipContainer:He,overlayClassName:Rt,color:Oe,overlayInnerStyle:it,children:Qe,afterOpenChange:$e,afterVisibleChange:Ot,destroyTooltipOnHide:vt,arrow:Me=!0,title:Xt,overlay:on,builtinPlacements:Fn,arrowPointAtCenter:$n=!1,autoAdjustOverflow:nr=!0}=Be,Ht=!!Me,[,Jt]=(0,we.useToken)(),{getPopupContainer:_n,getPrefixCls:tr,direction:an}=E.useContext(Se.ConfigContext),Ut=(0,ye.devUseWarning)("Tooltip"),Dt=E.useRef(null),Ie=()=>{var tt;(tt=Dt.current)===null||tt===void 0||tt.forceAlign()};E.useImperativeHandle(Re,()=>{var tt;return{forceAlign:Ie,forcePopupAlign:()=>{Ut.deprecated(!1,"forcePopupAlign","forceAlign"),Ie()},nativeElement:(tt=Dt.current)===null||tt===void 0?void 0:tt.nativeElement}});const[qe,Bt]=(0,fe.default)(!1,{value:(bt=Be.open)!==null&&bt!==void 0?bt:Be.visible,defaultValue:(yt=Be.defaultOpen)!==null&&yt!==void 0?yt:Be.defaultVisible}),j=!Xt&&!on&&Xt!==0,le=tt=>{var Et,tn;Bt(j?!1:tt),j||((Et=Be.onOpenChange)===null||Et===void 0||Et.call(Be,tt),(tn=Be.onVisibleChange)===null||tn===void 0||tn.call(Be,tt))},z=E.useMemo(()=>{var tt,Et;let tn=$n;return typeof Me=="object"&&(tn=(Et=(tt=Me.pointAtCenter)!==null&&tt!==void 0?tt:Me.arrowPointAtCenter)!==null&&Et!==void 0?Et:$n),Fn||(0,ze.default)({arrowPointAtCenter:tn,autoAdjustOverflow:nr,arrowWidth:Ht?Jt.sizePopupArrow:0,borderRadius:Jt.borderRadius,offset:Jt.marginXXS,visibleFirst:!0})},[$n,Me,Fn,Jt]),de=E.useMemo(()=>Xt===0?Xt:on||Xt||"",[on,Xt]),Zt=E.createElement(ae.default,{space:!0},typeof de=="function"?de():de),{getPopupContainer:nt,placement:St="top",mouseEnterDelay:In=.1,mouseLeaveDelay:Wn=.1,overlayStyle:qn,rootClassName:hn}=Be,pt=ht(Be,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),Wt=tr("tooltip",At),An=tr(),Pn=Be["data-popover-inject"];let Xn=qe;!("open"in Be)&&!("visible"in Be)&&j&&(Xn=!1);const dt=E.isValidElement(Qe)&&!(0,te.isFragment)(Qe)?Qe:E.createElement("span",null,Qe),be=dt.props,Ne=!be.className||typeof be.className=="string"?(0,ve.default)(be.className,bn||`${Wt}-open`):be.className,[ot,Pt,It]=(0,Ze.default)(Wt,!Pn),xn=(0,xt.parseColor)(Wt,Oe),Qn=xn.arrowStyle,br=Object.assign(Object.assign({},it),xn.overlayStyle),Jn=(0,ve.default)(Rt,{[`${Wt}-rtl`]:an==="rtl"},xn.className,hn,Pt,It),[Ae,xe]=(0,Ee.useZIndex)("Tooltip",pt.zIndex),ke=E.createElement(re.default,Object.assign({},pt,{zIndex:Ae,showArrow:Ht,placement:St,mouseEnterDelay:In,mouseLeaveDelay:Wn,prefixCls:Wt,overlayClassName:Jn,overlayStyle:Object.assign(Object.assign({},Qn),qn),getTooltipContainer:nt||He||_n,ref:Dt,builtinPlacements:z,overlay:Zt,visible:Xn,onVisibleChange:le,afterVisibleChange:$e!=null?$e:Ot,overlayInnerStyle:br,arrowContent:E.createElement("span",{className:`${Wt}-arrow-content`}),motion:{motionName:(0,oe.getTransitionName)(An,"zoom-big-fast",Be.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!vt}),Xn?(0,te.cloneElement)(dt,{className:Ne}):dt);return ot(E.createElement(De.default.Provider,{value:xe},ke))});mt._InternalPanelDoNotUseOrYouWillBeFired=ce.default;var gt=W.default=mt},15086:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.prepareComponentToken=W.default=void 0;var X=D(85982),E=D(98078),ve=D(42836),re=ee(D(9064)),fe=D(51337),ae=D(3184);const Ee=te=>{const{componentCls:ye,tooltipMaxWidth:De,tooltipColor:Se,tooltipBg:we,tooltipBorderRadius:ce,zIndexPopup:Ze,controlHeight:xt,boxShadowSecondary:ht,paddingSM:Gt,paddingXS:mt}=te;return[{[ye]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,E.resetComponent)(te)),{position:"absolute",zIndex:Ze,display:"block",width:"max-content",maxWidth:De,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":we,[`${ye}-inner`]:{minWidth:"1em",minHeight:xt,padding:`${(0,X.unit)(te.calc(Gt).div(2).equal())} ${(0,X.unit)(mt)}`,color:Se,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:we,borderRadius:ce,boxShadow:ht,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${ye}-inner`]:{borderRadius:te.min(ce,re.MAX_VERTICAL_CONTENT_RADIUS)}},[`${ye}-content`]:{position:"relative"}}),(0,ae.genPresetColor)(te,(gt,Be)=>{let{darkColor:Re}=Be;return{[`&${ye}-${gt}`]:{[`${ye}-inner`]:{backgroundColor:Re},[`${ye}-arrow`]:{"--antd-arrow-background-color":Re}}}})),{"&-rtl":{direction:"rtl"}})},(0,re.default)(te,"var(--antd-arrow-background-color)"),{[`${ye}-pure`]:{position:"relative",maxWidth:"none",margin:te.sizePopupArrow}}]},oe=te=>Object.assign(Object.assign({zIndexPopup:te.zIndexPopupBase+70},(0,re.getArrowOffsetToken)({contentRadius:te.borderRadius,limitVerticalRadius:!0})),(0,fe.getArrowToken)((0,ae.mergeToken)(te,{borderRadiusOuter:Math.min(te.borderRadiusOuter,4)})));W.prepareComponentToken=oe;var ze=W.default=function(ye){let De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(0,ae.genStyleHooks)("Tooltip",we=>{const{borderRadius:ce,colorTextLightSolid:Ze,colorBgSpotlight:xt}=we,ht=(0,ae.mergeToken)(we,{tooltipMaxWidth:250,tooltipColor:Ze,tooltipBorderRadius:ce,tooltipBg:xt});return[Ee(ht),(0,ve.initZoomMotion)(we,"zoom-big-fast")]},oe,{resetStyle:!1,injectStyle:De})(ye)}},48125:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.parseColor=ve;var X=ee(D(93967)),E=D(45471);function ve(re,fe){const ae=(0,E.isPresetColor)(fe),Ee=(0,X.default)({[`${re}-${fe}`]:fe&&ae}),oe={},ze={};return fe&&!ae&&(oe.background=fe,ze["--antd-arrow-background-color"]=fe),{className:Ee,overlayStyle:oe,arrowStyle:ze}}},6847:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(83874)),re=ee(D(90091)),fe=ee(D(4121)),ae=ee(D(93967)),Ee=ee(D(60938)),oe=ee(D(94055)),ze=D(81410);const te=De=>{const{prefixCls:Se,copied:we,locale:ce,iconOnly:Ze,tooltips:xt,icon:ht,loading:Gt,tabIndex:mt,onCopy:gt}=De,Be=(0,ze.toList)(xt),Re=(0,ze.toList)(ht),{copied:bt,copy:yt}=ce!=null?ce:{},At=we?(0,ze.getNode)(Be[1],bt):(0,ze.getNode)(Be[0],yt),He=typeof At=="string"?At:we?bt:yt;return E.createElement(oe.default,{key:"copy",title:At},E.createElement(Ee.default,{className:(0,ae.default)(`${Se}-copy`,{[`${Se}-copy-success`]:we,[`${Se}-copy-icon-only`]:Ze}),onClick:gt,"aria-label":He,tabIndex:mt},we?(0,ze.getNode)(Re[1],E.createElement(ve.default,null),!0):(0,ze.getNode)(Re[0],Gt?E.createElement(fe.default,null):E.createElement(re.default,null),!0)))};var ye=W.default=te},12385:function($t,W,D){"use strict";"use client";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=Ze;var E=X(D(861)),ve=ee(D(67294)),re=X(D(45598)),fe=X(D(82546));const ae=ve.forwardRef((xt,ht)=>{let{style:Gt,children:mt}=xt;const gt=ve.useRef(null);return ve.useImperativeHandle(ht,()=>({isExceed:()=>{const Be=gt.current;return Be.scrollHeight>Be.clientHeight},getHeight:()=>gt.current.clientHeight})),ve.createElement("span",{"aria-hidden":!0,ref:gt,style:Object.assign({position:"fixed",display:"block",left:0,top:0,pointerEvents:"none",backgroundColor:"rgba(255, 0, 0, 0.65)"},Gt)},mt)});function Ee(xt){const ht=typeof xt;return ht==="string"||ht==="number"}function oe(xt){let ht=0;return xt.forEach(Gt=>{Ee(Gt)?ht+=String(Gt).length:ht+=1}),ht}function ze(xt,ht){let Gt=0;const mt=[];for(let gt=0;gt<xt.length;gt+=1){if(Gt===ht)return mt;const Be=xt[gt],bt=Ee(Be)?String(Be).length:1,yt=Gt+bt;if(yt>ht){const At=ht-Gt;return mt.push(String(Be).slice(0,At)),mt}mt.push(Be),Gt=yt}return xt}const te=0,ye=1,De=2,Se=3,we=4,ce={display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical"};function Ze(xt){const{enableMeasure:ht,width:Gt,text:mt,children:gt,rows:Be,expanded:Re,miscDeps:bt,onEllipsis:yt}=xt,At=ve.useMemo(()=>(0,re.default)(mt),[mt]),bn=ve.useMemo(()=>oe(At),[mt]),He=ve.useMemo(()=>gt(At,!1),[mt]),[Rt,Oe]=ve.useState(null),it=ve.useRef(null),Qe=ve.useRef(null),$e=ve.useRef(null),Ot=ve.useRef(null),vt=ve.useRef(null),[Me,Xt]=ve.useState(!1),[on,Fn]=ve.useState(te),[$n,nr]=ve.useState(0),[Ht,Jt]=ve.useState(null);(0,fe.default)(()=>{Fn(ht&&Gt&&bn?ye:te)},[Gt,mt,Be,ht,At]),(0,fe.default)(()=>{var Ut,Dt,Ie,qe;if(on===ye){Fn(De);const Bt=Qe.current&&getComputedStyle(Qe.current).whiteSpace;Jt(Bt)}else if(on===De){const Bt=!!(!((Ut=$e.current)===null||Ut===void 0)&&Ut.isExceed());Fn(Bt?Se:we),Oe(Bt?[0,bn]:null),Xt(Bt);const j=((Dt=$e.current)===null||Dt===void 0?void 0:Dt.getHeight())||0,le=Be===1?0:((Ie=Ot.current)===null||Ie===void 0?void 0:Ie.getHeight())||0,z=((qe=vt.current)===null||qe===void 0?void 0:qe.getHeight())||0,de=le+z,Zt=Math.max(j,de);nr(Zt+1),yt(Bt)}},[on]);const _n=Rt?Math.ceil((Rt[0]+Rt[1])/2):0;(0,fe.default)(()=>{var Ut;const[Dt,Ie]=Rt||[0,0];if(Dt!==Ie){const Bt=(((Ut=it.current)===null||Ut===void 0?void 0:Ut.getHeight())||0)>$n;let j=_n;Ie-Dt===1&&(j=Bt?Dt:Ie),Oe(Bt?[Dt,j]:[j,Ie])}},[Rt,_n]);const tr=ve.useMemo(()=>{if(on!==Se||!Rt||Rt[0]!==Rt[1]){const Ut=gt(At,!1);return on!==we&&on!==te?ve.createElement("span",{style:Object.assign(Object.assign({},ce),{WebkitLineClamp:Be})},Ut):Ut}return gt(Re?At:ze(At,Rt[0]),Me)},[Re,on,Rt,At].concat((0,E.default)(bt))),an={width:Gt,margin:0,padding:0,whiteSpace:Ht==="nowrap"?"normal":"inherit"};return ve.createElement(ve.Fragment,null,tr,on===De&&ve.createElement(ve.Fragment,null,ve.createElement(ae,{style:Object.assign(Object.assign(Object.assign({},an),ce),{WebkitLineClamp:Be}),ref:$e},He),ve.createElement(ae,{style:Object.assign(Object.assign(Object.assign({},an),ce),{WebkitLineClamp:Be-1}),ref:Ot},He),ve.createElement(ae,{style:Object.assign(Object.assign(Object.assign({},an),ce),{WebkitLineClamp:1}),ref:vt},gt([],!0))),on===Se&&Rt&&Rt[0]!==Rt[1]&&ve.createElement(ae,{style:Object.assign(Object.assign({},an),{top:400}),ref:it},gt(ze(At,_n),!0)),on===ye&&ve.createElement("span",{style:{whiteSpace:"inherit"},ref:Qe}))}},69274:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(94055));const re=ae=>{let{enableEllipsis:Ee,isEllipsis:oe,children:ze,tooltipProps:te}=ae;return!(te!=null&&te.title)||!Ee?ze:E.createElement(ve.default,Object.assign({open:oe?void 0:!1},te),ze)};var fe=W.default=re},28460:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(10875)),re=ee(D(93967)),fe=ee(D(9220)),ae=ee(D(45598)),Ee=ee(D(82546)),oe=ee(D(60869)),ze=ee(D(18475)),te=D(75531),ye=D(38882),De=ee(D(60938)),Se=D(31929),we=ee(D(76647)),ce=ee(D(94055)),Ze=ee(D(69425)),xt=ee(D(63985)),ht=ee(D(92759)),Gt=ee(D(28991)),mt=ee(D(67312)),gt=ee(D(89652)),Be=ee(D(6847)),Re=ee(D(12385)),bt=ee(D(69274)),yt=D(81410),At=function(it,Qe){var $e={};for(var Ot in it)Object.prototype.hasOwnProperty.call(it,Ot)&&Qe.indexOf(Ot)<0&&($e[Ot]=it[Ot]);if(it!=null&&typeof Object.getOwnPropertySymbols=="function")for(var vt=0,Ot=Object.getOwnPropertySymbols(it);vt<Ot.length;vt++)Qe.indexOf(Ot[vt])<0&&Object.prototype.propertyIsEnumerable.call(it,Ot[vt])&&($e[Ot[vt]]=it[Ot[vt]]);return $e};function bn(it,Qe){let{mark:$e,code:Ot,underline:vt,delete:Me,strong:Xt,keyboard:on,italic:Fn}=it,$n=Qe;function nr(Ht,Jt){Jt&&($n=E.createElement(Ht,{},$n))}return nr("strong",Xt),nr("u",vt),nr("del",Me),nr("code",Ot),nr("mark",$e),nr("kbd",on),nr("i",Fn),$n}const He="...",Rt=E.forwardRef((it,Qe)=>{var $e,Ot,vt;const{prefixCls:Me,className:Xt,style:on,type:Fn,disabled:$n,children:nr,ellipsis:Ht,editable:Jt,copyable:_n,component:tr,title:an}=it,Ut=At(it,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:Dt,direction:Ie}=E.useContext(Se.ConfigContext),[qe]=(0,we.default)("Text"),Bt=E.useRef(null),j=E.useRef(null),le=Dt("typography",Me),z=(0,ze.default)(Ut,["mark","code","delete","underline","strong","keyboard","italic"]),[de,Zt]=(0,ht.default)(Jt),[nt,St]=(0,oe.default)(!1,{value:Zt.editing}),{triggerType:In=["icon"]}=Zt,Wn=Ke=>{var Ct;Ke&&((Ct=Zt.onStart)===null||Ct===void 0||Ct.call(Zt)),St(Ke)},qn=(0,Gt.default)(nt);(0,mt.default)(()=>{var Ke;!nt&&qn&&((Ke=j.current)===null||Ke===void 0||Ke.focus())},[nt]);const hn=Ke=>{Ke==null||Ke.preventDefault(),Wn(!0)},pt=Ke=>{var Ct;(Ct=Zt.onChange)===null||Ct===void 0||Ct.call(Zt,Ke),Wn(!1)},Wt=()=>{var Ke;(Ke=Zt.onCancel)===null||Ke===void 0||Ke.call(Zt),Wn(!1)},[An,Pn]=(0,ht.default)(_n),{copied:Xn,copyLoading:dt,onClick:be}=(0,xt.default)({copyConfig:Pn,children:nr}),[Ne,ot]=E.useState(!1),[Pt,It]=E.useState(!1),[xn,Qn]=E.useState(!1),[br,Jn]=E.useState(!1),[Ae,xe]=E.useState(!0),[ke,tt]=(0,ht.default)(Ht,{expandable:!1,symbol:Ke=>Ke?qe==null?void 0:qe.collapse:qe==null?void 0:qe.expand}),[Et,tn]=(0,oe.default)(tt.defaultExpanded||!1,{value:tt.expanded}),fn=ke&&(!Et||tt.expandable==="collapsible"),{rows:_t=1}=tt,en=E.useMemo(()=>fn&&(tt.suffix!==void 0||tt.onEllipsis||tt.expandable||de||An),[fn,tt,de,An]);(0,Ee.default)(()=>{ke&&!en&&(ot((0,ye.isStyleSupport)("webkitLineClamp")),It((0,ye.isStyleSupport)("textOverflow")))},[en,ke]);const[Gn,Tr]=E.useState(fn),jr=E.useMemo(()=>en?!1:_t===1?Pt:Ne,[en,Pt,Ne]);(0,Ee.default)(()=>{Tr(jr&&fn)},[jr,fn]);const vr=fn&&(Gn?br:xn),Ur=fn&&_t===1&&Gn,Fr=fn&&_t>1&&Gn,qr=(Ke,Ct)=>{var sn;tn(Ct.expanded),(sn=tt.onExpand)===null||sn===void 0||sn.call(tt,Ke,Ct)},[wr,fi]=E.useState(0),di=Ke=>{let{offsetWidth:Ct}=Ke;fi(Ct)},vi=Ke=>{var Ct;Qn(Ke),xn!==Ke&&((Ct=tt.onEllipsis)===null||Ct===void 0||Ct.call(tt,Ke))};E.useEffect(()=>{const Ke=Bt.current;if(ke&&Gn&&Ke){const[Ct,sn]=(0,yt.getEleSize)(Ke),Ln=Fr?sn<Ke.scrollHeight:Ct<Ke.scrollWidth;br!==Ln&&Jn(Ln)}},[ke,Gn,nr,Fr,Ae,wr]),E.useEffect(()=>{const Ke=Bt.current;if(typeof IntersectionObserver=="undefined"||!Ke||!Gn||!fn)return;const Ct=new IntersectionObserver(()=>{xe(!!Ke.offsetParent)});return Ct.observe(Ke),()=>{Ct.disconnect()}},[Gn,fn]);let vo={};tt.tooltip===!0?vo={title:($e=Zt.text)!==null&&$e!==void 0?$e:nr}:E.isValidElement(tt.tooltip)?vo={title:tt.tooltip}:typeof tt.tooltip=="object"?vo=Object.assign({title:(Ot=Zt.text)!==null&&Ot!==void 0?Ot:nr},tt.tooltip):vo={title:tt.tooltip};const Oi=E.useMemo(()=>{const Ke=Ct=>["string","number"].includes(typeof Ct);if(!(!ke||Gn)){if(Ke(Zt.text))return Zt.text;if(Ke(nr))return nr;if(Ke(an))return an;if(Ke(vo.title))return vo.title}},[ke,Gn,an,vo.title,vr]);if(nt)return E.createElement(Ze.default,{value:(vt=Zt.text)!==null&&vt!==void 0?vt:typeof nr=="string"?nr:"",onSave:pt,onCancel:Wt,onEnd:Zt.onEnd,prefixCls:le,className:Xt,style:on,direction:Ie,component:tr,maxLength:Zt.maxLength,autoSize:Zt.autoSize,enterIcon:Zt.enterIcon});const Ko=()=>{const{expandable:Ke,symbol:Ct}=tt;return!Ke||Et&&Ke!=="collapsible"?null:E.createElement(De.default,{key:"expand",className:`${le}-${Et?"collapse":"expand"}`,onClick:sn=>qr(sn,{expanded:!Et}),"aria-label":Et?qe.collapse:qe==null?void 0:qe.expand},typeof Ct=="function"?Ct(Et):Ct)},va=()=>{if(!de)return;const{icon:Ke,tooltip:Ct,tabIndex:sn}=Zt,Ln=(0,ae.default)(Ct)[0]||(qe==null?void 0:qe.edit),zn=typeof Ln=="string"?Ln:"";return In.includes("icon")?E.createElement(ce.default,{key:"edit",title:Ct===!1?"":Ln},E.createElement(De.default,{ref:j,className:`${le}-edit`,onClick:hn,"aria-label":zn,tabIndex:sn},Ke||E.createElement(ve.default,{role:"button"}))):null},Co=()=>An?E.createElement(Be.default,Object.assign({key:"copy"},Pn,{prefixCls:le,copied:Xn,locale:qe,onCopy:be,loading:dt,iconOnly:nr==null})):null,Xo=Ke=>[Ke&&Ko(),va(),Co()],Ye=Ke=>[Ke&&!Et&&E.createElement("span",{"aria-hidden":!0,key:"ellipsis"},He),tt.suffix,Xo(Ke)];return E.createElement(fe.default,{onResize:di,disabled:!fn},Ke=>E.createElement(bt.default,{tooltipProps:vo,enableEllipsis:fn,isEllipsis:vr},E.createElement(gt.default,Object.assign({className:(0,re.default)({[`${le}-${Fn}`]:Fn,[`${le}-disabled`]:$n,[`${le}-ellipsis`]:ke,[`${le}-ellipsis-single-line`]:Ur,[`${le}-ellipsis-multiple-line`]:Fr},Xt),prefixCls:Me,style:Object.assign(Object.assign({},on),{WebkitLineClamp:Fr?_t:void 0}),component:tr,ref:(0,te.composeRef)(Ke,Bt,Qe),direction:Ie,onClick:In.includes("text")?hn:void 0,"aria-label":Oi==null?void 0:Oi.toString(),title:an},z),E.createElement(Re.default,{enableMeasure:fn&&!Gn,text:nr,rows:_t,width:wr,onEllipsis:vi,expanded:Et,miscDeps:[Xn,Et,dt,de,An]},(Ct,sn)=>bn(it,E.createElement(E.Fragment,null,Ct.length>0&&sn&&!Et&&Oi?E.createElement("span",{key:"show-content","aria-hidden":!0},Ct):Ct,Ye(sn)))))))});var Oe=W.default=Rt},81410:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getEleSize=X,W.getNode=ee,W.toList=D;function D(E){return E===!1?[!1,!1]:Array.isArray(E)?E:[E]}function ee(E,ve,re){return E===!0||E===void 0?ve:E||re&&ve}function X(E){const ve=E.getBoundingClientRect(),{offsetWidth:re,offsetHeight:fe}=E;let ae=re,Ee=fe;return Math.abs(re-ve.width)<1&&Math.abs(fe-ve.height)<1&&(ae=ve.width,Ee=ve.height),[ae,Ee]}},69425:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(7224)),re=ee(D(93967)),fe=ee(D(27712)),ae=D(47419),Ee=ee(D(14104)),oe=ee(D(23461));const ze=ye=>{const{prefixCls:De,"aria-label":Se,className:we,style:ce,direction:Ze,maxLength:xt,autoSize:ht=!0,value:Gt,onSave:mt,onCancel:gt,onEnd:Be,component:Re,enterIcon:bt=E.createElement(ve.default,null)}=ye,yt=E.useRef(null),At=E.useRef(!1),bn=E.useRef(),[He,Rt]=E.useState(Gt);E.useEffect(()=>{Rt(Gt)},[Gt]),E.useEffect(()=>{var Ht;if(!((Ht=yt.current)===null||Ht===void 0)&&Ht.resizableTextArea){const{textArea:Jt}=yt.current.resizableTextArea;Jt.focus();const{length:_n}=Jt.value;Jt.setSelectionRange(_n,_n)}},[]);const Oe=Ht=>{let{target:Jt}=Ht;Rt(Jt.value.replace(/[\n\r]/g,""))},it=()=>{At.current=!0},Qe=()=>{At.current=!1},$e=Ht=>{let{keyCode:Jt}=Ht;At.current||(bn.current=Jt)},Ot=()=>{mt(He.trim())},vt=Ht=>{let{keyCode:Jt,ctrlKey:_n,altKey:tr,metaKey:an,shiftKey:Ut}=Ht;bn.current===Jt&&!At.current&&!_n&&!tr&&!an&&!Ut&&(Jt===fe.default.ENTER?(Ot(),Be==null||Be()):Jt===fe.default.ESC&&gt())},Me=()=>{Ot()},Xt=Re?`${De}-${Re}`:"",[on,Fn,$n]=(0,oe.default)(De),nr=(0,re.default)(De,`${De}-edit-content`,{[`${De}-rtl`]:Ze==="rtl"},we,Xt,Fn,$n);return on(E.createElement("div",{className:nr,style:ce},E.createElement(Ee.default,{ref:yt,maxLength:xt,value:He,onChange:Oe,onKeyDown:$e,onKeyUp:vt,onCompositionStart:it,onCompositionEnd:Qe,onBlur:Me,"aria-label":Se,rows:1,autoSize:ht}),bt!==null?(0,ae.cloneElement)(bt,{className:`${De}-edit-content-confirm`}):null))};var te=W.default=ze},34528:function($t,W,D){"use strict";var ee,X=D(64836).default,E=D(75263).default;ee={value:!0},W.Z=void 0;var ve=E(D(67294)),re=D(13594),fe=X(D(28460)),ae=function(te,ye){var De={};for(var Se in te)Object.prototype.hasOwnProperty.call(te,Se)&&ye.indexOf(Se)<0&&(De[Se]=te[Se]);if(te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var we=0,Se=Object.getOwnPropertySymbols(te);we<Se.length;we++)ye.indexOf(Se[we])<0&&Object.prototype.propertyIsEnumerable.call(te,Se[we])&&(De[Se[we]]=te[Se[we]]);return De};const Ee=[1,2,3,4,5],oe=ve.forwardRef((te,ye)=>{const{level:De=1}=te,Se=ae(te,["level"]);let we;return Ee.includes(De)?we=`h${De}`:we="h1",ve.createElement(fe.default,Object.assign({ref:ye},Se,{component:we}))});var ze=W.Z=oe},89652:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(93967)),re=D(75531),fe=D(13594),ae=D(31929),Ee=ee(D(23461)),oe=function(ye,De){var Se={};for(var we in ye)Object.prototype.hasOwnProperty.call(ye,we)&&De.indexOf(we)<0&&(Se[we]=ye[we]);if(ye!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ce=0,we=Object.getOwnPropertySymbols(ye);ce<we.length;ce++)De.indexOf(we[ce])<0&&Object.prototype.propertyIsEnumerable.call(ye,we[ce])&&(Se[we[ce]]=ye[we[ce]]);return Se};const ze=E.forwardRef((ye,De)=>{const{prefixCls:Se,component:we="article",className:ce,rootClassName:Ze,setContentRef:xt,children:ht,direction:Gt,style:mt}=ye,gt=oe(ye,["prefixCls","component","className","rootClassName","setContentRef","children","direction","style"]),{getPrefixCls:Be,direction:Re,typography:bt}=E.useContext(ae.ConfigContext),yt=Gt!=null?Gt:Re;let At=De;xt&&(At=(0,re.composeRef)(De,xt));const bn=Be("typography",Se),[He,Rt,Oe]=(0,Ee.default)(bn),it=(0,ve.default)(bn,bt==null?void 0:bt.className,{[`${bn}-rtl`]:yt==="rtl"},ce,Ze,Rt,Oe),Qe=Object.assign(Object.assign({},bt==null?void 0:bt.style),mt);return He(E.createElement(we,Object.assign({className:it,style:Qe,ref:At},gt),ht))});var te=W.default=ze},63985:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),ve=ee(D(20640)),re=D(56790),fe=function(oe,ze,te,ye){function De(Se){return Se instanceof te?Se:new te(function(we){we(Se)})}return new(te||(te=Promise))(function(Se,we){function ce(ht){try{xt(ye.next(ht))}catch(Gt){we(Gt)}}function Ze(ht){try{xt(ye.throw(ht))}catch(Gt){we(Gt)}}function xt(ht){ht.done?Se(ht.value):De(ht.value).then(ce,Ze)}xt((ye=ye.apply(oe,ze||[])).next())})};const ae=oe=>{let{copyConfig:ze,children:te}=oe;const[ye,De]=E.useState(!1),[Se,we]=E.useState(!1),ce=E.useRef(null),Ze=()=>{ce.current&&clearTimeout(ce.current)},xt={};ze.format&&(xt.format=ze.format),E.useEffect(()=>Ze,[]);const ht=(0,re.useEvent)(Gt=>fe(void 0,void 0,void 0,function*(){var mt;Gt==null||Gt.preventDefault(),Gt==null||Gt.stopPropagation(),we(!0);try{const gt=typeof ze.text=="function"?yield ze.text():ze.text;(0,ve.default)(gt||String(te)||"",xt),we(!1),De(!0),Ze(),ce.current=setTimeout(()=>{De(!1)},3e3),(mt=ze.onCopy)===null||mt===void 0||mt.call(ze,Gt)}catch(gt){throw we(!1),gt}}));return{copied:ye,copyLoading:Se,onClick:ht}};var Ee=W.default=ae},92759:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(67294));function E(ve,re){return X.useMemo(()=>{const fe=!!ve;return[fe,Object.assign(Object.assign({},re),fe&&typeof ve=="object"?ve:null)]},[ve])}},28991:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294);const X=ve=>{const re=(0,ee.useRef)();return(0,ee.useEffect)(()=>{re.current=ve}),re.current};var E=W.default=X},67312:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294));const E=(re,fe)=>{const ae=X.useRef(!1);X.useEffect(()=>{ae.current?re():ae.current=!0},fe)};var ve=W.default=E},23461:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.prepareComponentToken=W.default=void 0;var ee=D(98078),X=D(3184),E=D(48385);const ve=ae=>{const{componentCls:Ee,titleMarginTop:oe}=ae;return{[Ee]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:ae.colorText,wordBreak:"break-word",lineHeight:ae.lineHeight,[`&${Ee}-secondary`]:{color:ae.colorTextDescription},[`&${Ee}-success`]:{color:ae.colorSuccess},[`&${Ee}-warning`]:{color:ae.colorWarning},[`&${Ee}-danger`]:{color:ae.colorError,"a&:active, a&:focus":{color:ae.colorErrorActive},"a&:hover":{color:ae.colorErrorHover}},[`&${Ee}-disabled`]:{color:ae.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},"\n        div&,\n        p\n      ":{marginBottom:"1em"}},(0,E.getTitleStyles)(ae)),{[`
      & + h1${Ee},
      & + h2${Ee},
      & + h3${Ee},
      & + h4${Ee},
      & + h5${Ee}
      `]:{marginTop:oe},"\n      div,\n      ul,\n      li,\n      p,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5":{"\n        + h1,\n        + h2,\n        + h3,\n        + h4,\n        + h5\n        ":{marginTop:oe}}}),(0,E.getResetStyles)(ae)),(0,E.getLinkStyles)(ae)),{[`
        ${Ee}-expand,
        ${Ee}-collapse,
        ${Ee}-edit,
        ${Ee}-copy
      `]:Object.assign(Object.assign({},(0,ee.operationUnit)(ae)),{marginInlineStart:ae.marginXXS})}),(0,E.getEditableStyles)(ae)),(0,E.getCopyableStyles)(ae)),(0,E.getEllipsisStyles)()),{"&-rtl":{direction:"rtl"}})}},re=()=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em"});W.prepareComponentToken=re;var fe=W.default=(0,X.genStyleHooks)("Typography",ae=>[ve(ae)],re)},48385:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getTitleStyles=W.getResetStyles=W.getLinkStyles=W.getEllipsisStyles=W.getEditableStyles=W.getCopyableStyles=void 0;var ee=D(65409),X=D(85982),E=D(98078);const ve=(te,ye,De,Se)=>{const{titleMarginBottom:we,fontWeightStrong:ce}=Se;return{marginBottom:we,color:De,fontWeight:ce,fontSize:te,lineHeight:ye}},re=te=>{const ye=[1,2,3,4,5],De={};return ye.forEach(Se=>{De[`
      h${Se}&,
      div&-h${Se},
      div&-h${Se} > textarea,
      h${Se}
    `]=ve(te[`fontSizeHeading${Se}`],te[`lineHeightHeading${Se}`],te.colorTextHeading,te)}),De};W.getTitleStyles=re;const fe=te=>{const{componentCls:ye}=te;return{"a&, a":Object.assign(Object.assign({},(0,E.operationUnit)(te)),{textDecoration:te.linkDecoration,"&:active, &:hover":{textDecoration:te.linkHoverDecoration},[`&[disabled], &${ye}-disabled`]:{color:te.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:te.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}};W.getLinkStyles=fe;const ae=te=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:te.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:te.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:ee.gold[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:te.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}});W.getResetStyles=ae;const Ee=te=>{const{componentCls:ye,paddingSM:De}=te,Se=De;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:te.calc(te.paddingSM).mul(-1).equal(),marginTop:te.calc(Se).mul(-1).equal(),marginBottom:`calc(1em - ${(0,X.unit)(Se)})`},[`${ye}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:te.calc(te.marginXS).add(2).equal(),insetBlockEnd:te.marginXS,color:te.colorTextDescription,fontWeight:"normal",fontSize:te.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}};W.getEditableStyles=Ee;const oe=te=>({[`${te.componentCls}-copy-success`]:{"\n    &,\n    &:hover,\n    &:focus":{color:te.colorSuccess}},[`${te.componentCls}-copy-icon-only`]:{marginInlineStart:0}});W.getCopyableStyles=oe;const ze=()=>({"\n  a&-ellipsis,\n  span&-ellipsis\n  ":{display:"inline-block",maxWidth:"100%"},"&-ellipsis-single-line":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"},"> code":{paddingBlock:0,maxWidth:"calc(100% - 1.2em)",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"bottom",boxSizing:"content-box"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}});W.getEllipsisStyles=ze},87629:function($t,W,D){"use strict";"use client";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(36245)),E=W.default=X.default},36245:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var D=W.default="5.20.1"},83874:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(71079));function X(ve){return ve&&ve.__esModule?ve:{default:ve}}const E=ee;W.default=E,$t.exports=E},43273:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(72225));function X(ve){return ve&&ve.__esModule?ve:{default:ve}}const E=ee;W.default=E,$t.exports=E},90091:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(29539));function X(ve){return ve&&ve.__esModule?ve:{default:ve}}const E=ee;W.default=E,$t.exports=E},10875:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(54825));function X(ve){return ve&&ve.__esModule?ve:{default:ve}}const E=ee;W.default=E,$t.exports=E},7224:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(43552));function X(ve){return ve&&ve.__esModule?ve:{default:ve}}const E=ee;W.default=E,$t.exports=E},4121:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(61929));function X(ve){return ve&&ve.__esModule?ve:{default:ve}}const E=ee;W.default=E,$t.exports=E},26545:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=ee(D(10434)),ve=ee(D(27424)),re=ee(D(38416)),fe=ee(D(70215)),ae=X(D(67294)),Ee=ee(D(93967)),oe=D(65409),ze=ee(D(13357)),te=ee(D(46648)),ye=D(46338),De=D(49458),Se=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];(0,ye.setTwoToneColor)(oe.blue.primary);var we=ae.forwardRef(function(Ze,xt){var ht=Ze.className,Gt=Ze.icon,mt=Ze.spin,gt=Ze.rotate,Be=Ze.tabIndex,Re=Ze.onClick,bt=Ze.twoToneColor,yt=(0,fe.default)(Ze,Se),At=ae.useContext(ze.default),bn=At.prefixCls,He=bn===void 0?"anticon":bn,Rt=At.rootClassName,Oe=(0,Ee.default)(Rt,He,(0,re.default)((0,re.default)({},"".concat(He,"-").concat(Gt.name),!!Gt.name),"".concat(He,"-spin"),!!mt||Gt.name==="loading"),ht),it=Be;it===void 0&&Re&&(it=-1);var Qe=gt?{msTransform:"rotate(".concat(gt,"deg)"),transform:"rotate(".concat(gt,"deg)")}:void 0,$e=(0,De.normalizeTwoToneColors)(bt),Ot=(0,ve.default)($e,2),vt=Ot[0],Me=Ot[1];return ae.createElement("span",(0,E.default)({role:"img","aria-label":Gt.name},yt,{ref:xt,tabIndex:it,onClick:Re,className:Oe}),ae.createElement(te.default,{icon:Gt,primaryColor:vt,secondaryColor:Me,style:Qe}))});we.displayName="AntdIcon",we.getTwoToneColor=ye.getTwoToneColor,we.setTwoToneColor=ye.setTwoToneColor;var ce=W.default=we},13357:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294),X=(0,ee.createContext)({}),E=W.default=X},46648:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=ee(D(70215)),ve=ee(D(42122)),re=X(D(67294)),fe=D(49458),ae=["icon","className","onClick","style","primaryColor","secondaryColor"],Ee={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function oe(De){var Se=De.primaryColor,we=De.secondaryColor;Ee.primaryColor=Se,Ee.secondaryColor=we||(0,fe.getSecondaryColor)(Se),Ee.calculated=!!we}function ze(){return(0,ve.default)({},Ee)}var te=function(Se){var we=Se.icon,ce=Se.className,Ze=Se.onClick,xt=Se.style,ht=Se.primaryColor,Gt=Se.secondaryColor,mt=(0,E.default)(Se,ae),gt=re.useRef(),Be=Ee;if(ht&&(Be={primaryColor:ht,secondaryColor:Gt||(0,fe.getSecondaryColor)(ht)}),(0,fe.useInsertStyles)(gt),(0,fe.warning)((0,fe.isIconDefinition)(we),"icon should be icon definiton, but got ".concat(we)),!(0,fe.isIconDefinition)(we))return null;var Re=we;return Re&&typeof Re.icon=="function"&&(Re=(0,ve.default)((0,ve.default)({},Re),{},{icon:Re.icon(Be.primaryColor,Be.secondaryColor)})),(0,fe.generate)(Re.icon,"svg-".concat(Re.name),(0,ve.default)((0,ve.default)({className:ce,onClick:Ze,style:xt,"data-icon":Re.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},mt),{},{ref:gt}))};te.displayName="IconReact",te.getTwoToneColors=ze,te.setTwoToneColors=oe;var ye=W.default=te},46338:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.getTwoToneColor=fe,W.setTwoToneColor=re;var X=ee(D(27424)),E=ee(D(46648)),ve=D(49458);function re(ae){var Ee=(0,ve.normalizeTwoToneColors)(ae),oe=(0,X.default)(Ee,2),ze=oe[0],te=oe[1];return E.default.setTwoToneColors({primaryColor:ze,secondaryColor:te})}function fe(){var ae=E.default.getTwoToneColors();return ae.calculated?[ae.primaryColor,ae.secondaryColor]:ae.primaryColor}},71079:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),ve=ee(D(67294)),re=X(D(25330)),fe=X(D(26545)),ae=function(te,ye){return ve.createElement(fe.default,(0,E.default)({},te,{ref:ye,icon:re.default}))},Ee=ve.forwardRef(ae),oe=W.default=Ee},72225:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),ve=ee(D(67294)),re=X(D(67303)),fe=X(D(26545)),ae=function(te,ye){return ve.createElement(fe.default,(0,E.default)({},te,{ref:ye,icon:re.default}))},Ee=ve.forwardRef(ae),oe=W.default=Ee},29539:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),ve=ee(D(67294)),re=X(D(83647)),fe=X(D(26545)),ae=function(te,ye){return ve.createElement(fe.default,(0,E.default)({},te,{ref:ye,icon:re.default}))},Ee=ve.forwardRef(ae),oe=W.default=Ee},54825:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),ve=ee(D(67294)),re=X(D(57583)),fe=X(D(26545)),ae=function(te,ye){return ve.createElement(fe.default,(0,E.default)({},te,{ref:ye,icon:re.default}))},Ee=ve.forwardRef(ae),oe=W.default=Ee},43552:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),ve=ee(D(67294)),re=X(D(29260)),fe=X(D(26545)),ae=function(te,ye){return ve.createElement(fe.default,(0,E.default)({},te,{ref:ye,icon:re.default}))},Ee=ve.forwardRef(ae),oe=W.default=Ee},61929:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),ve=ee(D(67294)),re=X(D(25828)),fe=X(D(26545)),ae=function(te,ye){return ve.createElement(fe.default,(0,E.default)({},te,{ref:ye,icon:re.default}))},Ee=ve.forwardRef(ae),oe=W.default=Ee},49458:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.generate=we,W.getSecondaryColor=ce,W.iconStyles=void 0,W.isIconDefinition=De,W.normalizeAttrs=Se,W.normalizeTwoToneColors=Ze,W.useInsertStyles=W.svgBaseProps=void 0,W.warning=ye;var E=X(D(42122)),ve=X(D(18698)),re=D(65409),fe=D(93399),ae=D(63298),Ee=X(D(45520)),oe=ee(D(67294)),ze=X(D(13357));function te(mt){return mt.replace(/-(.)/g,function(gt,Be){return Be.toUpperCase()})}function ye(mt,gt){(0,Ee.default)(mt,"[@ant-design/icons] ".concat(gt))}function De(mt){return(0,ve.default)(mt)==="object"&&typeof mt.name=="string"&&typeof mt.theme=="string"&&((0,ve.default)(mt.icon)==="object"||typeof mt.icon=="function")}function Se(){var mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(mt).reduce(function(gt,Be){var Re=mt[Be];switch(Be){case"class":gt.className=Re,delete gt.class;break;default:delete gt[Be],gt[te(Be)]=Re}return gt},{})}function we(mt,gt,Be){return Be?oe.default.createElement(mt.tag,(0,E.default)((0,E.default)({key:gt},Se(mt.attrs)),Be),(mt.children||[]).map(function(Re,bt){return we(Re,"".concat(gt,"-").concat(mt.tag,"-").concat(bt))})):oe.default.createElement(mt.tag,(0,E.default)({key:gt},Se(mt.attrs)),(mt.children||[]).map(function(Re,bt){return we(Re,"".concat(gt,"-").concat(mt.tag,"-").concat(bt))}))}function ce(mt){return(0,re.generate)(mt)[0]}function Ze(mt){return mt?Array.isArray(mt)?mt:[mt]:[]}var xt=W.svgBaseProps={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},ht=W.iconStyles=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Gt=W.useInsertStyles=function(gt){var Be=(0,oe.useContext)(ze.default),Re=Be.csp,bt=Be.prefixCls,yt=ht;bt&&(yt=yt.replace(/anticon/g,bt)),(0,oe.useEffect)(function(){var At=gt.current,bn=(0,ae.getShadowRoot)(At);(0,fe.updateCSS)(yt,"@ant-design-icons",{prepend:!0,csp:Re,attachTo:bn})},[])}},98129:function($t,W,D){"use strict";var ee=D(60690);$t.exports=function(ve){ve=ve||{};var re=ve.reporter,fe=ee.getOption(ve,"async",!0),ae=ee.getOption(ve,"auto",!0);ae&&!fe&&(re&&re.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),fe=!0);var Ee=X(),oe,ze=!1;function te(xt,ht){!ze&&ae&&fe&&Ee.size()===0&&Se(),Ee.add(xt,ht)}function ye(){for(ze=!0;Ee.size();){var xt=Ee;Ee=X(),xt.process()}ze=!1}function De(xt){ze||(xt===void 0&&(xt=fe),oe&&(ce(oe),oe=null),xt?Se():ye())}function Se(){oe=Ze(ye)}function we(){Ee={},batchSize=0,topLevel=0,bottomLevel=0}function ce(xt){var ht=clearTimeout;return ht(xt)}function Ze(xt){var ht=function(Gt){return setTimeout(Gt,0)};return ht(xt)}return{add:te,force:De}};function X(){var E={},ve=0,re=0,fe=0;function ae(ze,te){te||(te=ze,ze=0),ze>re?re=ze:ze<fe&&(fe=ze),E[ze]||(E[ze]=[]),E[ze].push(te),ve++}function Ee(){for(var ze=fe;ze<=re;ze++)for(var te=E[ze],ye=0;ye<te.length;ye++){var De=te[ye];De()}}function oe(){return ve}return{add:ae,process:Ee,size:oe}}},60690:function($t){"use strict";var W=$t.exports={};W.getOption=D;function D(ee,X,E){var ve=ee[X];return ve==null&&E!==void 0?E:ve}},8874:function($t){"use strict";$t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function($t,W,D){var ee=D(8874),X=D(86851),E=Object.hasOwnProperty,ve=Object.create(null);for(var re in ee)E.call(ee,re)&&(ve[ee[re]]=re);var fe=$t.exports={to:{},get:{}};fe.get=function(oe){var ze=oe.substring(0,3).toLowerCase(),te,ye;switch(ze){case"hsl":te=fe.get.hsl(oe),ye="hsl";break;case"hwb":te=fe.get.hwb(oe),ye="hwb";break;default:te=fe.get.rgb(oe),ye="rgb";break}return te?{model:ye,value:te}:null},fe.get.rgb=function(oe){if(!oe)return null;var ze=/^#([a-f0-9]{3,4})$/i,te=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,ye=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,De=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Se=/^(\w+)$/,we=[0,0,0,1],ce,Ze,xt;if(ce=oe.match(te)){for(xt=ce[2],ce=ce[1],Ze=0;Ze<3;Ze++){var ht=Ze*2;we[Ze]=parseInt(ce.slice(ht,ht+2),16)}xt&&(we[3]=parseInt(xt,16)/255)}else if(ce=oe.match(ze)){for(ce=ce[1],xt=ce[3],Ze=0;Ze<3;Ze++)we[Ze]=parseInt(ce[Ze]+ce[Ze],16);xt&&(we[3]=parseInt(xt+xt,16)/255)}else if(ce=oe.match(ye)){for(Ze=0;Ze<3;Ze++)we[Ze]=parseInt(ce[Ze+1],0);ce[4]&&(ce[5]?we[3]=parseFloat(ce[4])*.01:we[3]=parseFloat(ce[4]))}else if(ce=oe.match(De)){for(Ze=0;Ze<3;Ze++)we[Ze]=Math.round(parseFloat(ce[Ze+1])*2.55);ce[4]&&(ce[5]?we[3]=parseFloat(ce[4])*.01:we[3]=parseFloat(ce[4]))}else return(ce=oe.match(Se))?ce[1]==="transparent"?[0,0,0,0]:E.call(ee,ce[1])?(we=ee[ce[1]],we[3]=1,we):null:null;for(Ze=0;Ze<3;Ze++)we[Ze]=ae(we[Ze],0,255);return we[3]=ae(we[3],0,1),we},fe.get.hsl=function(oe){if(!oe)return null;var ze=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,te=oe.match(ze);if(te){var ye=parseFloat(te[4]),De=(parseFloat(te[1])%360+360)%360,Se=ae(parseFloat(te[2]),0,100),we=ae(parseFloat(te[3]),0,100),ce=ae(isNaN(ye)?1:ye,0,1);return[De,Se,we,ce]}return null},fe.get.hwb=function(oe){if(!oe)return null;var ze=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,te=oe.match(ze);if(te){var ye=parseFloat(te[4]),De=(parseFloat(te[1])%360+360)%360,Se=ae(parseFloat(te[2]),0,100),we=ae(parseFloat(te[3]),0,100),ce=ae(isNaN(ye)?1:ye,0,1);return[De,Se,we,ce]}return null},fe.to.hex=function(){var oe=X(arguments);return"#"+Ee(oe[0])+Ee(oe[1])+Ee(oe[2])+(oe[3]<1?Ee(Math.round(oe[3]*255)):"")},fe.to.rgb=function(){var oe=X(arguments);return oe.length<4||oe[3]===1?"rgb("+Math.round(oe[0])+", "+Math.round(oe[1])+", "+Math.round(oe[2])+")":"rgba("+Math.round(oe[0])+", "+Math.round(oe[1])+", "+Math.round(oe[2])+", "+oe[3]+")"},fe.to.rgb.percent=function(){var oe=X(arguments),ze=Math.round(oe[0]/255*100),te=Math.round(oe[1]/255*100),ye=Math.round(oe[2]/255*100);return oe.length<4||oe[3]===1?"rgb("+ze+"%, "+te+"%, "+ye+"%)":"rgba("+ze+"%, "+te+"%, "+ye+"%, "+oe[3]+")"},fe.to.hsl=function(){var oe=X(arguments);return oe.length<4||oe[3]===1?"hsl("+oe[0]+", "+oe[1]+"%, "+oe[2]+"%)":"hsla("+oe[0]+", "+oe[1]+"%, "+oe[2]+"%, "+oe[3]+")"},fe.to.hwb=function(){var oe=X(arguments),ze="";return oe.length>=4&&oe[3]!==1&&(ze=", "+oe[3]),"hwb("+oe[0]+", "+oe[1]+"%, "+oe[2]+"%"+ze+")"},fe.to.keyword=function(oe){return ve[oe.slice(0,3)]};function ae(oe,ze,te){return Math.min(Math.max(ze,oe),te)}function Ee(oe){var ze=Math.round(oe).toString(16).toUpperCase();return ze.length<2?"0"+ze:ze}},37620:function($t,W,D){"use strict";D.d(W,{ZP:function(){return Gt},B8:function(){return Re}});function ee($e,Ot,vt){$e.prototype=Ot.prototype=vt,vt.constructor=$e}function X($e,Ot){var vt=Object.create($e.prototype);for(var Me in Ot)vt[Me]=Ot[Me];return vt}function E(){}var ve=.7,re=1/ve,fe="\\s*([+-]?\\d+)\\s*",ae="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ee="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oe=/^#([0-9a-f]{3,8})$/,ze=new RegExp("^rgb\\("+[fe,fe,fe]+"\\)$"),te=new RegExp("^rgb\\("+[Ee,Ee,Ee]+"\\)$"),ye=new RegExp("^rgba\\("+[fe,fe,fe,ae]+"\\)$"),De=new RegExp("^rgba\\("+[Ee,Ee,Ee,ae]+"\\)$"),Se=new RegExp("^hsl\\("+[ae,Ee,Ee]+"\\)$"),we=new RegExp("^hsla\\("+[ae,Ee,Ee,ae]+"\\)$"),ce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ee(E,Gt,{copy:function($e){return Object.assign(new this.constructor,this,$e)},displayable:function(){return this.rgb().displayable()},hex:Ze,formatHex:Ze,formatHsl:xt,formatRgb:ht,toString:ht});function Ze(){return this.rgb().formatHex()}function xt(){return Rt(this).formatHsl()}function ht(){return this.rgb().formatRgb()}function Gt($e){var Ot,vt;return $e=($e+"").trim().toLowerCase(),(Ot=oe.exec($e))?(vt=Ot[1].length,Ot=parseInt(Ot[1],16),vt===6?mt(Ot):vt===3?new bt(Ot>>8&15|Ot>>4&240,Ot>>4&15|Ot&240,(Ot&15)<<4|Ot&15,1):vt===8?gt(Ot>>24&255,Ot>>16&255,Ot>>8&255,(Ot&255)/255):vt===4?gt(Ot>>12&15|Ot>>8&240,Ot>>8&15|Ot>>4&240,Ot>>4&15|Ot&240,((Ot&15)<<4|Ot&15)/255):null):(Ot=ze.exec($e))?new bt(Ot[1],Ot[2],Ot[3],1):(Ot=te.exec($e))?new bt(Ot[1]*255/100,Ot[2]*255/100,Ot[3]*255/100,1):(Ot=ye.exec($e))?gt(Ot[1],Ot[2],Ot[3],Ot[4]):(Ot=De.exec($e))?gt(Ot[1]*255/100,Ot[2]*255/100,Ot[3]*255/100,Ot[4]):(Ot=Se.exec($e))?He(Ot[1],Ot[2]/100,Ot[3]/100,1):(Ot=we.exec($e))?He(Ot[1],Ot[2]/100,Ot[3]/100,Ot[4]):ce.hasOwnProperty($e)?mt(ce[$e]):$e==="transparent"?new bt(NaN,NaN,NaN,0):null}function mt($e){return new bt($e>>16&255,$e>>8&255,$e&255,1)}function gt($e,Ot,vt,Me){return Me<=0&&($e=Ot=vt=NaN),new bt($e,Ot,vt,Me)}function Be($e){return $e instanceof E||($e=Gt($e)),$e?($e=$e.rgb(),new bt($e.r,$e.g,$e.b,$e.opacity)):new bt}function Re($e,Ot,vt,Me){return arguments.length===1?Be($e):new bt($e,Ot,vt,Me==null?1:Me)}function bt($e,Ot,vt,Me){this.r=+$e,this.g=+Ot,this.b=+vt,this.opacity=+Me}ee(bt,Re,X(E,{brighter:function($e){return $e=$e==null?re:Math.pow(re,$e),new bt(this.r*$e,this.g*$e,this.b*$e,this.opacity)},darker:function($e){return $e=$e==null?ve:Math.pow(ve,$e),new bt(this.r*$e,this.g*$e,this.b*$e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yt,formatHex:yt,formatRgb:At,toString:At}));function yt(){return"#"+bn(this.r)+bn(this.g)+bn(this.b)}function At(){var $e=this.opacity;return $e=isNaN($e)?1:Math.max(0,Math.min(1,$e)),($e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+($e===1?")":", "+$e+")")}function bn($e){return $e=Math.max(0,Math.min(255,Math.round($e)||0)),($e<16?"0":"")+$e.toString(16)}function He($e,Ot,vt,Me){return Me<=0?$e=Ot=vt=NaN:vt<=0||vt>=1?$e=Ot=NaN:Ot<=0&&($e=NaN),new it($e,Ot,vt,Me)}function Rt($e){if($e instanceof it)return new it($e.h,$e.s,$e.l,$e.opacity);if($e instanceof E||($e=Gt($e)),!$e)return new it;if($e instanceof it)return $e;$e=$e.rgb();var Ot=$e.r/255,vt=$e.g/255,Me=$e.b/255,Xt=Math.min(Ot,vt,Me),on=Math.max(Ot,vt,Me),Fn=NaN,$n=on-Xt,nr=(on+Xt)/2;return $n?(Ot===on?Fn=(vt-Me)/$n+(vt<Me)*6:vt===on?Fn=(Me-Ot)/$n+2:Fn=(Ot-vt)/$n+4,$n/=nr<.5?on+Xt:2-on-Xt,Fn*=60):$n=nr>0&&nr<1?0:Fn,new it(Fn,$n,nr,$e.opacity)}function Oe($e,Ot,vt,Me){return arguments.length===1?Rt($e):new it($e,Ot,vt,Me==null?1:Me)}function it($e,Ot,vt,Me){this.h=+$e,this.s=+Ot,this.l=+vt,this.opacity=+Me}ee(it,Oe,X(E,{brighter:function($e){return $e=$e==null?re:Math.pow(re,$e),new it(this.h,this.s,this.l*$e,this.opacity)},darker:function($e){return $e=$e==null?ve:Math.pow(ve,$e),new it(this.h,this.s,this.l*$e,this.opacity)},rgb:function(){var $e=this.h%360+(this.h<0)*360,Ot=isNaN($e)||isNaN(this.s)?0:this.s,vt=this.l,Me=vt+(vt<.5?vt:1-vt)*Ot,Xt=2*vt-Me;return new bt(Qe($e>=240?$e-240:$e+120,Xt,Me),Qe($e,Xt,Me),Qe($e<120?$e+240:$e-120,Xt,Me),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var $e=this.opacity;return $e=isNaN($e)?1:Math.max(0,Math.min(1,$e)),($e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+($e===1?")":", "+$e+")")}}));function Qe($e,Ot,vt){return($e<60?Ot+(vt-Ot)*$e/60:$e<180?vt:$e<240?Ot+(vt-Ot)*(240-$e)/60:Ot)*255}},9187:function($t){"use strict";$t.exports=W,$t.exports.default=W;function W(Oe,it,Qe){Qe=Qe||2;var $e=it&&it.length,Ot=$e?it[0]*Qe:Oe.length,vt=D(Oe,0,Ot,Qe,!0),Me=[];if(!vt||vt.next===vt.prev)return Me;var Xt,on,Fn,$n,nr,Ht,Jt;if($e&&(vt=ae(Oe,it,vt,Qe)),Oe.length>80*Qe){Xt=Fn=Oe[0],on=$n=Oe[1];for(var _n=Qe;_n<Ot;_n+=Qe)nr=Oe[_n],Ht=Oe[_n+1],nr<Xt&&(Xt=nr),Ht<on&&(on=Ht),nr>Fn&&(Fn=nr),Ht>$n&&($n=Ht);Jt=Math.max(Fn-Xt,$n-on),Jt=Jt!==0?32767/Jt:0}return X(vt,Me,Qe,Xt,on,Jt,0),Me}function D(Oe,it,Qe,$e,Ot){var vt,Me;if(Ot===Rt(Oe,it,Qe,$e)>0)for(vt=it;vt<Qe;vt+=$e)Me=At(vt,Oe[vt],Oe[vt+1],Me);else for(vt=Qe-$e;vt>=it;vt-=$e)Me=At(vt,Oe[vt],Oe[vt+1],Me);return Me&&ht(Me,Me.next)&&(bn(Me),Me=Me.next),Me}function ee(Oe,it){if(!Oe)return Oe;it||(it=Oe);var Qe=Oe,$e;do if($e=!1,!Qe.steiner&&(ht(Qe,Qe.next)||xt(Qe.prev,Qe,Qe.next)===0)){if(bn(Qe),Qe=it=Qe.prev,Qe===Qe.next)break;$e=!0}else Qe=Qe.next;while($e||Qe!==it);return it}function X(Oe,it,Qe,$e,Ot,vt,Me){if(Oe){!Me&&vt&&ye(Oe,$e,Ot,vt);for(var Xt=Oe,on,Fn;Oe.prev!==Oe.next;){if(on=Oe.prev,Fn=Oe.next,vt?ve(Oe,$e,Ot,vt):E(Oe)){it.push(on.i/Qe|0),it.push(Oe.i/Qe|0),it.push(Fn.i/Qe|0),bn(Oe),Oe=Fn.next,Xt=Fn.next;continue}if(Oe=Fn,Oe===Xt){Me?Me===1?(Oe=re(ee(Oe),it,Qe),X(Oe,it,Qe,$e,Ot,vt,2)):Me===2&&fe(Oe,it,Qe,$e,Ot,vt):X(ee(Oe),it,Qe,$e,Ot,vt,1);break}}}}function E(Oe){var it=Oe.prev,Qe=Oe,$e=Oe.next;if(xt(it,Qe,$e)>=0)return!1;for(var Ot=it.x,vt=Qe.x,Me=$e.x,Xt=it.y,on=Qe.y,Fn=$e.y,$n=Ot<vt?Ot<Me?Ot:Me:vt<Me?vt:Me,nr=Xt<on?Xt<Fn?Xt:Fn:on<Fn?on:Fn,Ht=Ot>vt?Ot>Me?Ot:Me:vt>Me?vt:Me,Jt=Xt>on?Xt>Fn?Xt:Fn:on>Fn?on:Fn,_n=$e.next;_n!==it;){if(_n.x>=$n&&_n.x<=Ht&&_n.y>=nr&&_n.y<=Jt&&ce(Ot,Xt,vt,on,Me,Fn,_n.x,_n.y)&&xt(_n.prev,_n,_n.next)>=0)return!1;_n=_n.next}return!0}function ve(Oe,it,Qe,$e){var Ot=Oe.prev,vt=Oe,Me=Oe.next;if(xt(Ot,vt,Me)>=0)return!1;for(var Xt=Ot.x,on=vt.x,Fn=Me.x,$n=Ot.y,nr=vt.y,Ht=Me.y,Jt=Xt<on?Xt<Fn?Xt:Fn:on<Fn?on:Fn,_n=$n<nr?$n<Ht?$n:Ht:nr<Ht?nr:Ht,tr=Xt>on?Xt>Fn?Xt:Fn:on>Fn?on:Fn,an=$n>nr?$n>Ht?$n:Ht:nr>Ht?nr:Ht,Ut=Se(Jt,_n,it,Qe,$e),Dt=Se(tr,an,it,Qe,$e),Ie=Oe.prevZ,qe=Oe.nextZ;Ie&&Ie.z>=Ut&&qe&&qe.z<=Dt;){if(Ie.x>=Jt&&Ie.x<=tr&&Ie.y>=_n&&Ie.y<=an&&Ie!==Ot&&Ie!==Me&&ce(Xt,$n,on,nr,Fn,Ht,Ie.x,Ie.y)&&xt(Ie.prev,Ie,Ie.next)>=0||(Ie=Ie.prevZ,qe.x>=Jt&&qe.x<=tr&&qe.y>=_n&&qe.y<=an&&qe!==Ot&&qe!==Me&&ce(Xt,$n,on,nr,Fn,Ht,qe.x,qe.y)&&xt(qe.prev,qe,qe.next)>=0))return!1;qe=qe.nextZ}for(;Ie&&Ie.z>=Ut;){if(Ie.x>=Jt&&Ie.x<=tr&&Ie.y>=_n&&Ie.y<=an&&Ie!==Ot&&Ie!==Me&&ce(Xt,$n,on,nr,Fn,Ht,Ie.x,Ie.y)&&xt(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.prevZ}for(;qe&&qe.z<=Dt;){if(qe.x>=Jt&&qe.x<=tr&&qe.y>=_n&&qe.y<=an&&qe!==Ot&&qe!==Me&&ce(Xt,$n,on,nr,Fn,Ht,qe.x,qe.y)&&xt(qe.prev,qe,qe.next)>=0)return!1;qe=qe.nextZ}return!0}function re(Oe,it,Qe){var $e=Oe;do{var Ot=$e.prev,vt=$e.next.next;!ht(Ot,vt)&&Gt(Ot,$e,$e.next,vt)&&Re(Ot,vt)&&Re(vt,Ot)&&(it.push(Ot.i/Qe|0),it.push($e.i/Qe|0),it.push(vt.i/Qe|0),bn($e),bn($e.next),$e=Oe=vt),$e=$e.next}while($e!==Oe);return ee($e)}function fe(Oe,it,Qe,$e,Ot,vt){var Me=Oe;do{for(var Xt=Me.next.next;Xt!==Me.prev;){if(Me.i!==Xt.i&&Ze(Me,Xt)){var on=yt(Me,Xt);Me=ee(Me,Me.next),on=ee(on,on.next),X(Me,it,Qe,$e,Ot,vt,0),X(on,it,Qe,$e,Ot,vt,0);return}Xt=Xt.next}Me=Me.next}while(Me!==Oe)}function ae(Oe,it,Qe,$e){var Ot=[],vt,Me,Xt,on,Fn;for(vt=0,Me=it.length;vt<Me;vt++)Xt=it[vt]*$e,on=vt<Me-1?it[vt+1]*$e:Oe.length,Fn=D(Oe,Xt,on,$e,!1),Fn===Fn.next&&(Fn.steiner=!0),Ot.push(we(Fn));for(Ot.sort(Ee),vt=0;vt<Ot.length;vt++)Qe=oe(Ot[vt],Qe);return Qe}function Ee(Oe,it){return Oe.x-it.x}function oe(Oe,it){var Qe=ze(Oe,it);if(!Qe)return it;var $e=yt(Qe,Oe);return ee($e,$e.next),ee(Qe,Qe.next)}function ze(Oe,it){var Qe=it,$e=Oe.x,Ot=Oe.y,vt=-1/0,Me;do{if(Ot<=Qe.y&&Ot>=Qe.next.y&&Qe.next.y!==Qe.y){var Xt=Qe.x+(Ot-Qe.y)*(Qe.next.x-Qe.x)/(Qe.next.y-Qe.y);if(Xt<=$e&&Xt>vt&&(vt=Xt,Me=Qe.x<Qe.next.x?Qe:Qe.next,Xt===$e))return Me}Qe=Qe.next}while(Qe!==it);if(!Me)return null;var on=Me,Fn=Me.x,$n=Me.y,nr=1/0,Ht;Qe=Me;do $e>=Qe.x&&Qe.x>=Fn&&$e!==Qe.x&&ce(Ot<$n?$e:vt,Ot,Fn,$n,Ot<$n?vt:$e,Ot,Qe.x,Qe.y)&&(Ht=Math.abs(Ot-Qe.y)/($e-Qe.x),Re(Qe,Oe)&&(Ht<nr||Ht===nr&&(Qe.x>Me.x||Qe.x===Me.x&&te(Me,Qe)))&&(Me=Qe,nr=Ht)),Qe=Qe.next;while(Qe!==on);return Me}function te(Oe,it){return xt(Oe.prev,Oe,it.prev)<0&&xt(it.next,Oe,Oe.next)<0}function ye(Oe,it,Qe,$e){var Ot=Oe;do Ot.z===0&&(Ot.z=Se(Ot.x,Ot.y,it,Qe,$e)),Ot.prevZ=Ot.prev,Ot.nextZ=Ot.next,Ot=Ot.next;while(Ot!==Oe);Ot.prevZ.nextZ=null,Ot.prevZ=null,De(Ot)}function De(Oe){var it,Qe,$e,Ot,vt,Me,Xt,on,Fn=1;do{for(Qe=Oe,Oe=null,vt=null,Me=0;Qe;){for(Me++,$e=Qe,Xt=0,it=0;it<Fn&&(Xt++,$e=$e.nextZ,!!$e);it++);for(on=Fn;Xt>0||on>0&&$e;)Xt!==0&&(on===0||!$e||Qe.z<=$e.z)?(Ot=Qe,Qe=Qe.nextZ,Xt--):(Ot=$e,$e=$e.nextZ,on--),vt?vt.nextZ=Ot:Oe=Ot,Ot.prevZ=vt,vt=Ot;Qe=$e}vt.nextZ=null,Fn*=2}while(Me>1);return Oe}function Se(Oe,it,Qe,$e,Ot){return Oe=(Oe-Qe)*Ot|0,it=(it-$e)*Ot|0,Oe=(Oe|Oe<<8)&16711935,Oe=(Oe|Oe<<4)&252645135,Oe=(Oe|Oe<<2)&858993459,Oe=(Oe|Oe<<1)&1431655765,it=(it|it<<8)&16711935,it=(it|it<<4)&252645135,it=(it|it<<2)&858993459,it=(it|it<<1)&1431655765,Oe|it<<1}function we(Oe){var it=Oe,Qe=Oe;do(it.x<Qe.x||it.x===Qe.x&&it.y<Qe.y)&&(Qe=it),it=it.next;while(it!==Oe);return Qe}function ce(Oe,it,Qe,$e,Ot,vt,Me,Xt){return(Ot-Me)*(it-Xt)>=(Oe-Me)*(vt-Xt)&&(Oe-Me)*($e-Xt)>=(Qe-Me)*(it-Xt)&&(Qe-Me)*(vt-Xt)>=(Ot-Me)*($e-Xt)}function Ze(Oe,it){return Oe.next.i!==it.i&&Oe.prev.i!==it.i&&!Be(Oe,it)&&(Re(Oe,it)&&Re(it,Oe)&&bt(Oe,it)&&(xt(Oe.prev,Oe,it.prev)||xt(Oe,it.prev,it))||ht(Oe,it)&&xt(Oe.prev,Oe,Oe.next)>0&&xt(it.prev,it,it.next)>0)}function xt(Oe,it,Qe){return(it.y-Oe.y)*(Qe.x-it.x)-(it.x-Oe.x)*(Qe.y-it.y)}function ht(Oe,it){return Oe.x===it.x&&Oe.y===it.y}function Gt(Oe,it,Qe,$e){var Ot=gt(xt(Oe,it,Qe)),vt=gt(xt(Oe,it,$e)),Me=gt(xt(Qe,$e,Oe)),Xt=gt(xt(Qe,$e,it));return!!(Ot!==vt&&Me!==Xt||Ot===0&&mt(Oe,Qe,it)||vt===0&&mt(Oe,$e,it)||Me===0&&mt(Qe,Oe,$e)||Xt===0&&mt(Qe,it,$e))}function mt(Oe,it,Qe){return it.x<=Math.max(Oe.x,Qe.x)&&it.x>=Math.min(Oe.x,Qe.x)&&it.y<=Math.max(Oe.y,Qe.y)&&it.y>=Math.min(Oe.y,Qe.y)}function gt(Oe){return Oe>0?1:Oe<0?-1:0}function Be(Oe,it){var Qe=Oe;do{if(Qe.i!==Oe.i&&Qe.next.i!==Oe.i&&Qe.i!==it.i&&Qe.next.i!==it.i&&Gt(Qe,Qe.next,Oe,it))return!0;Qe=Qe.next}while(Qe!==Oe);return!1}function Re(Oe,it){return xt(Oe.prev,Oe,Oe.next)<0?xt(Oe,it,Oe.next)>=0&&xt(Oe,Oe.prev,it)>=0:xt(Oe,it,Oe.prev)<0||xt(Oe,Oe.next,it)<0}function bt(Oe,it){var Qe=Oe,$e=!1,Ot=(Oe.x+it.x)/2,vt=(Oe.y+it.y)/2;do Qe.y>vt!=Qe.next.y>vt&&Qe.next.y!==Qe.y&&Ot<(Qe.next.x-Qe.x)*(vt-Qe.y)/(Qe.next.y-Qe.y)+Qe.x&&($e=!$e),Qe=Qe.next;while(Qe!==Oe);return $e}function yt(Oe,it){var Qe=new He(Oe.i,Oe.x,Oe.y),$e=new He(it.i,it.x,it.y),Ot=Oe.next,vt=it.prev;return Oe.next=it,it.prev=Oe,Qe.next=Ot,Ot.prev=Qe,$e.next=Qe,Qe.prev=$e,vt.next=$e,$e.prev=vt,$e}function At(Oe,it,Qe,$e){var Ot=new He(Oe,it,Qe);return $e?(Ot.next=$e.next,Ot.prev=$e,$e.next.prev=Ot,$e.next=Ot):(Ot.prev=Ot,Ot.next=Ot),Ot}function bn(Oe){Oe.next.prev=Oe.prev,Oe.prev.next=Oe.next,Oe.prevZ&&(Oe.prevZ.nextZ=Oe.nextZ),Oe.nextZ&&(Oe.nextZ.prevZ=Oe.prevZ)}function He(Oe,it,Qe){this.i=Oe,this.x=it,this.y=Qe,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}W.deviation=function(Oe,it,Qe,$e){var Ot=it&&it.length,vt=Ot?it[0]*Qe:Oe.length,Me=Math.abs(Rt(Oe,0,vt,Qe));if(Ot)for(var Xt=0,on=it.length;Xt<on;Xt++){var Fn=it[Xt]*Qe,$n=Xt<on-1?it[Xt+1]*Qe:Oe.length;Me-=Math.abs(Rt(Oe,Fn,$n,Qe))}var nr=0;for(Xt=0;Xt<$e.length;Xt+=3){var Ht=$e[Xt]*Qe,Jt=$e[Xt+1]*Qe,_n=$e[Xt+2]*Qe;nr+=Math.abs((Oe[Ht]-Oe[_n])*(Oe[Jt+1]-Oe[Ht+1])-(Oe[Ht]-Oe[Jt])*(Oe[_n+1]-Oe[Ht+1]))}return Me===0&&nr===0?0:Math.abs((nr-Me)/Me)};function Rt(Oe,it,Qe,$e){for(var Ot=0,vt=it,Me=Qe-$e;vt<Qe;vt+=$e)Ot+=(Oe[Me]-Oe[vt])*(Oe[vt+1]+Oe[Me+1]),Me=vt;return Ot}W.flatten=function(Oe){for(var it=Oe[0][0].length,Qe={vertices:[],holes:[],dimensions:it},$e=0,Ot=0;Ot<Oe.length;Ot++){for(var vt=0;vt<Oe[Ot].length;vt++)for(var Me=0;Me<it;Me++)Qe.vertices.push(Oe[Ot][vt][Me]);Ot>0&&($e+=Oe[Ot-1].length,Qe.holes.push($e))}return Qe}},2268:function($t){"use strict";var W=$t.exports={};W.isIE=function(D){function ee(){var E=navigator.userAgent.toLowerCase();return E.indexOf("msie")!==-1||E.indexOf("trident")!==-1||E.indexOf(" edge/")!==-1}if(!ee())return!1;if(!D)return!0;var X=function(){var E,ve=3,re=document.createElement("div"),fe=re.getElementsByTagName("i");do re.innerHTML="<!--[if gt IE "+ ++ve+"]><i></i><![endif]-->";while(fe[0]);return ve>4?ve:E}();return D===X},W.isLegacyOpera=function(){return!!window.opera}},17900:function($t){"use strict";var W=$t.exports={};W.forEach=function(D,ee){for(var X=0;X<D.length;X++){var E=ee(D[X]);if(E)return E}}},58229:function($t,W,D){"use strict";var ee=D(2268);$t.exports=function(X){X=X||{};var E=X.reporter,ve=X.batchProcessor,re=X.stateHandler.getState;if(!E)throw new Error("Missing required dependency: reporter.");function fe(te,ye){function De(){ye(te)}if(ee.isIE(8))re(te).object={proxy:De},te.attachEvent("onresize",De);else{var Se=oe(te);if(!Se)throw new Error("Element is not detectable by this strategy.");Se.contentDocument.defaultView.addEventListener("resize",De)}}function ae(te){var ye=X.important?" !important; ":"; ";return(te.join(ye)+ye).trim()}function Ee(te,ye,De){De||(De=ye,ye=te,te=null),te=te||{};var Se=te.debug;function we(ce,Ze){var xt=ae(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),ht=!1,Gt=window.getComputedStyle(ce),mt=ce.offsetWidth,gt=ce.offsetHeight;re(ce).startSize={width:mt,height:gt};function Be(){function Re(){if(Gt.position==="static"){ce.style.setProperty("position","relative",te.important?"important":"");var At=function(bn,He,Rt,Oe){function it($e){return $e.replace(/[^-\d\.]/g,"")}var Qe=Rt[Oe];Qe!=="auto"&&it(Qe)!=="0"&&(bn.warn("An element that is positioned static has style."+Oe+"="+Qe+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Oe+" will be set to 0. Element: ",He),He.style.setProperty(Oe,"0",te.important?"important":""))};At(E,ce,Gt,"top"),At(E,ce,Gt,"right"),At(E,ce,Gt,"bottom"),At(E,ce,Gt,"left")}}function bt(){ht||Re();function At(He,Rt){if(!He.contentDocument){var Oe=re(He);Oe.checkForObjectDocumentTimeoutId&&window.clearTimeout(Oe.checkForObjectDocumentTimeoutId),Oe.checkForObjectDocumentTimeoutId=setTimeout(function(){Oe.checkForObjectDocumentTimeoutId=0,At(He,Rt)},100);return}Rt(He.contentDocument)}var bn=this;At(bn,function(Rt){Ze(ce)})}Gt.position!==""&&(Re(Gt),ht=!0);var yt=document.createElement("object");yt.style.cssText=xt,yt.tabIndex=-1,yt.type="text/html",yt.setAttribute("aria-hidden","true"),yt.onload=bt,ee.isIE()||(yt.data="about:blank"),re(ce)&&(ce.appendChild(yt),re(ce).object=yt,ee.isIE()&&(yt.data="about:blank"))}ve?ve.add(Be):Be()}ee.isIE(8)?De(ye):we(ye,De)}function oe(te){return re(te).object}function ze(te){if(re(te)){var ye=oe(te);ye&&(ee.isIE(8)?te.detachEvent("onresize",ye.proxy):te.removeChild(ye),re(te).checkForObjectDocumentTimeoutId&&window.clearTimeout(re(te).checkForObjectDocumentTimeoutId),delete re(te).object)}}return{makeDetectable:Ee,addListener:fe,uninstall:ze}}},60787:function($t,W,D){"use strict";var ee=D(17900).forEach;$t.exports=function(X){X=X||{};var E=X.reporter,ve=X.batchProcessor,re=X.stateHandler.getState,fe=X.stateHandler.hasState,ae=X.idHandler;if(!ve)throw new Error("Missing required dependency: batchProcessor");if(!E)throw new Error("Missing required dependency: reporter.");var Ee=De(),oe="erd_scroll_detection_scrollbar_style",ze="erd_scroll_detection_container";function te(Be){Se(Be,oe,ze)}te(window.document);function ye(Be){var Re=X.important?" !important; ":"; ";return(Be.join(Re)+Re).trim()}function De(){var Be=500,Re=500,bt=document.createElement("div");bt.style.cssText=ye(["position: absolute","width: "+Be*2+"px","height: "+Re*2+"px","visibility: hidden","margin: 0","padding: 0"]);var yt=document.createElement("div");yt.style.cssText=ye(["position: absolute","width: "+Be+"px","height: "+Re+"px","overflow: scroll","visibility: none","top: "+-Be*3+"px","left: "+-Re*3+"px","visibility: hidden","margin: 0","padding: 0"]),yt.appendChild(bt),document.body.insertBefore(yt,document.body.firstChild);var At=Be-yt.clientWidth,bn=Re-yt.clientHeight;return document.body.removeChild(yt),{width:At,height:bn}}function Se(Be,Re,bt){function yt(Rt,Oe){Oe=Oe||function(Qe){Be.head.appendChild(Qe)};var it=Be.createElement("style");return it.innerHTML=Rt,it.id=Re,Oe(it),it}if(!Be.getElementById(Re)){var At=bt+"_animation",bn=bt+"_animation_active",He=`/* Created by the element-resize-detector library. */
`;He+="."+bt+" > div::-webkit-scrollbar { "+ye(["display: none"])+` }

`,He+="."+bn+" { "+ye(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+At,"animation-name: "+At])+` }
`,He+="@-webkit-keyframes "+At+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,He+="@keyframes "+At+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",yt(He)}}function we(Be){Be.className+=" "+ze+"_animation_active"}function ce(Be,Re,bt){if(Be.addEventListener)Be.addEventListener(Re,bt);else if(Be.attachEvent)Be.attachEvent("on"+Re,bt);else return E.error("[scroll] Don't know how to add event listeners.")}function Ze(Be,Re,bt){if(Be.removeEventListener)Be.removeEventListener(Re,bt);else if(Be.detachEvent)Be.detachEvent("on"+Re,bt);else return E.error("[scroll] Don't know how to remove event listeners.")}function xt(Be){return re(Be).container.childNodes[0].childNodes[0].childNodes[0]}function ht(Be){return re(Be).container.childNodes[0].childNodes[0].childNodes[1]}function Gt(Be,Re){var bt=re(Be).listeners;if(!bt.push)throw new Error("Cannot add listener to an element that is not detectable.");re(Be).listeners.push(Re)}function mt(Be,Re,bt){bt||(bt=Re,Re=Be,Be=null),Be=Be||{};function yt(){if(Be.debug){var Ut=Array.prototype.slice.call(arguments);if(Ut.unshift(ae.get(Re),"Scroll: "),E.log.apply)E.log.apply(null,Ut);else for(var Dt=0;Dt<Ut.length;Dt++)E.log(Ut[Dt])}}function At(Ut){function Dt(Ie){var qe=Ie.getRootNode&&Ie.getRootNode().contains(Ie);return Ie===Ie.ownerDocument.body||Ie.ownerDocument.body.contains(Ie)||qe}return!Dt(Ut)||window.getComputedStyle(Ut)===null}function bn(Ut){var Dt=re(Ut).container.childNodes[0],Ie=window.getComputedStyle(Dt);return!Ie.width||Ie.width.indexOf("px")===-1}function He(){var Ut=window.getComputedStyle(Re),Dt={};return Dt.position=Ut.position,Dt.width=Re.offsetWidth,Dt.height=Re.offsetHeight,Dt.top=Ut.top,Dt.right=Ut.right,Dt.bottom=Ut.bottom,Dt.left=Ut.left,Dt.widthCSS=Ut.width,Dt.heightCSS=Ut.height,Dt}function Rt(){var Ut=He();re(Re).startSize={width:Ut.width,height:Ut.height},yt("Element start size",re(Re).startSize)}function Oe(){re(Re).listeners=[]}function it(){if(yt("storeStyle invoked."),!re(Re)){yt("Aborting because element has been uninstalled");return}var Ut=He();re(Re).style=Ut}function Qe(Ut,Dt,Ie){re(Ut).lastWidth=Dt,re(Ut).lastHeight=Ie}function $e(Ut){return xt(Ut).childNodes[0]}function Ot(){return 2*Ee.width+1}function vt(){return 2*Ee.height+1}function Me(Ut){return Ut+10+Ot()}function Xt(Ut){return Ut+10+vt()}function on(Ut){return Ut*2+Ot()}function Fn(Ut){return Ut*2+vt()}function $n(Ut,Dt,Ie){var qe=xt(Ut),Bt=ht(Ut),j=Me(Dt),le=Xt(Ie),z=on(Dt),de=Fn(Ie);qe.scrollLeft=j,qe.scrollTop=le,Bt.scrollLeft=z,Bt.scrollTop=de}function nr(){var Ut=re(Re).container;if(!Ut){Ut=document.createElement("div"),Ut.className=ze,Ut.style.cssText=ye(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),re(Re).container=Ut,we(Ut),Re.appendChild(Ut);var Dt=function(){re(Re).onRendered&&re(Re).onRendered()};ce(Ut,"animationstart",Dt),re(Re).onAnimationStart=Dt}return Ut}function Ht(){function Ut(){var Pn=re(Re).style;if(Pn.position==="static"){Re.style.setProperty("position","relative",Be.important?"important":"");var Xn=function(dt,be,Ne,ot){function Pt(xn){return xn.replace(/[^-\d\.]/g,"")}var It=Ne[ot];It!=="auto"&&Pt(It)!=="0"&&(dt.warn("An element that is positioned static has style."+ot+"="+It+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+ot+" will be set to 0. Element: ",be),be.style[ot]=0)};Xn(E,Re,Pn,"top"),Xn(E,Re,Pn,"right"),Xn(E,Re,Pn,"bottom"),Xn(E,Re,Pn,"left")}}function Dt(Pn,Xn,dt,be){return Pn=Pn?Pn+"px":"0",Xn=Xn?Xn+"px":"0",dt=dt?dt+"px":"0",be=be?be+"px":"0",["left: "+Pn,"top: "+Xn,"right: "+be,"bottom: "+dt]}if(yt("Injecting elements"),!re(Re)){yt("Aborting because element has been uninstalled");return}Ut();var Ie=re(Re).container;Ie||(Ie=nr());var qe=Ee.width,Bt=Ee.height,j=ye(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),le=ye(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(Dt(-(1+qe),-(1+Bt),-Bt,-qe))),z=ye(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),de=ye(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Zt=ye(["position: absolute","left: 0","top: 0"]),nt=ye(["position: absolute","width: 200%","height: 200%"]),St=document.createElement("div"),In=document.createElement("div"),Wn=document.createElement("div"),qn=document.createElement("div"),hn=document.createElement("div"),pt=document.createElement("div");St.dir="ltr",St.style.cssText=j,St.className=ze,In.className=ze,In.style.cssText=le,Wn.style.cssText=z,qn.style.cssText=Zt,hn.style.cssText=de,pt.style.cssText=nt,Wn.appendChild(qn),hn.appendChild(pt),In.appendChild(Wn),In.appendChild(hn),St.appendChild(In),Ie.appendChild(St);function Wt(){var Pn=re(Re);Pn&&Pn.onExpand?Pn.onExpand():yt("Aborting expand scroll handler: element has been uninstalled")}function An(){var Pn=re(Re);Pn&&Pn.onShrink?Pn.onShrink():yt("Aborting shrink scroll handler: element has been uninstalled")}ce(Wn,"scroll",Wt),ce(hn,"scroll",An),re(Re).onExpandScroll=Wt,re(Re).onShrinkScroll=An}function Jt(){function Ut(z,de,Zt){var nt=$e(z),St=Me(de),In=Xt(Zt);nt.style.setProperty("width",St+"px",Be.important?"important":""),nt.style.setProperty("height",In+"px",Be.important?"important":"")}function Dt(z){var de=Re.offsetWidth,Zt=Re.offsetHeight,nt=de!==re(Re).lastWidth||Zt!==re(Re).lastHeight;yt("Storing current size",de,Zt),Qe(Re,de,Zt),ve.add(0,function(){if(nt){if(!re(Re)){yt("Aborting because element has been uninstalled");return}if(!Ie()){yt("Aborting because element container has not been initialized");return}if(Be.debug){var In=Re.offsetWidth,Wn=Re.offsetHeight;(In!==de||Wn!==Zt)&&E.warn(ae.get(Re),"Scroll: Size changed before updating detector elements.")}Ut(Re,de,Zt)}}),ve.add(1,function(){if(!re(Re)){yt("Aborting because element has been uninstalled");return}if(!Ie()){yt("Aborting because element container has not been initialized");return}$n(Re,de,Zt)}),nt&&z&&ve.add(2,function(){if(!re(Re)){yt("Aborting because element has been uninstalled");return}if(!Ie()){yt("Aborting because element container has not been initialized");return}z()})}function Ie(){return!!re(Re).container}function qe(){function z(){return re(Re).lastNotifiedWidth===void 0}yt("notifyListenersIfNeeded invoked");var de=re(Re);if(z()&&de.lastWidth===de.startSize.width&&de.lastHeight===de.startSize.height)return yt("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(de.lastWidth===de.lastNotifiedWidth&&de.lastHeight===de.lastNotifiedHeight)return yt("Not notifying: Size already notified");yt("Current size not notified, notifying..."),de.lastNotifiedWidth=de.lastWidth,de.lastNotifiedHeight=de.lastHeight,ee(re(Re).listeners,function(Zt){Zt(Re)})}function Bt(){if(yt("startanimation triggered."),bn(Re)){yt("Ignoring since element is still unrendered...");return}yt("Element rendered.");var z=xt(Re),de=ht(Re);(z.scrollLeft===0||z.scrollTop===0||de.scrollLeft===0||de.scrollTop===0)&&(yt("Scrollbars out of sync. Updating detector elements..."),Dt(qe))}function j(){if(yt("Scroll detected."),bn(Re)){yt("Scroll event fired while unrendered. Ignoring...");return}Dt(qe)}if(yt("registerListenersAndPositionElements invoked."),!re(Re)){yt("Aborting because element has been uninstalled");return}re(Re).onRendered=Bt,re(Re).onExpand=j,re(Re).onShrink=j;var le=re(Re).style;Ut(Re,le.width,le.height)}function _n(){if(yt("finalizeDomMutation invoked."),!re(Re)){yt("Aborting because element has been uninstalled");return}var Ut=re(Re).style;Qe(Re,Ut.width,Ut.height),$n(Re,Ut.width,Ut.height)}function tr(){bt(Re)}function an(){yt("Installing..."),Oe(),Rt(),ve.add(0,it),ve.add(1,Ht),ve.add(2,Jt),ve.add(3,_n),ve.add(4,tr)}yt("Making detectable..."),At(Re)?(yt("Element is detached"),nr(),yt("Waiting until element is attached..."),re(Re).onRendered=function(){yt("Element is now attached"),an()}):an()}function gt(Be){var Re=re(Be);Re&&(Re.onExpandScroll&&Ze(xt(Be),"scroll",Re.onExpandScroll),Re.onShrinkScroll&&Ze(ht(Be),"scroll",Re.onShrinkScroll),Re.onAnimationStart&&Ze(Re.container,"animationstart",Re.onAnimationStart),Re.container&&Be.removeChild(Re.container))}return{makeDetectable:mt,addListener:Gt,uninstall:gt,initDocument:te}}},63844:function($t,W,D){"use strict";var ee=D(17900).forEach,X=D(68452),E=D(96199),ve=D(75805),re=D(79799),fe=D(71724),ae=D(2268),Ee=D(98129),oe=D(21931),ze=D(58229),te=D(60787);function ye(ce){return Array.isArray(ce)||ce.length!==void 0}function De(ce){if(Array.isArray(ce))return ce;var Ze=[];return ee(ce,function(xt){Ze.push(xt)}),Ze}function Se(ce){return ce&&ce.nodeType===1}$t.exports=function(ce){ce=ce||{};var Ze;if(ce.idHandler)Ze={get:function($e){return ce.idHandler.get($e,!0)},set:ce.idHandler.set};else{var xt=ve(),ht=re({idGenerator:xt,stateHandler:oe});Ze=ht}var Gt=ce.reporter;if(!Gt){var mt=Gt===!1;Gt=fe(mt)}var gt=we(ce,"batchProcessor",Ee({reporter:Gt})),Be={};Be.callOnAdd=!!we(ce,"callOnAdd",!0),Be.debug=!!we(ce,"debug",!1);var Re=E(Ze),bt=X({stateHandler:oe}),yt,At=we(ce,"strategy","object"),bn=we(ce,"important",!1),He={reporter:Gt,batchProcessor:gt,stateHandler:oe,idHandler:Ze,important:bn};if(At==="scroll"&&(ae.isLegacyOpera()?(Gt.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),At="object"):ae.isIE(9)&&(Gt.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),At="object")),At==="scroll")yt=te(He);else if(At==="object")yt=ze(He);else throw new Error("Invalid strategy name: "+At);var Rt={};function Oe($e,Ot,vt){function Me(Ht){var Jt=Re.get(Ht);ee(Jt,function(tr){tr(Ht)})}function Xt(Ht,Jt,_n){Re.add(Jt,_n),Ht&&_n(Jt)}if(vt||(vt=Ot,Ot=$e,$e={}),!Ot)throw new Error("At least one element required.");if(!vt)throw new Error("Listener required.");if(Se(Ot))Ot=[Ot];else if(ye(Ot))Ot=De(Ot);else return Gt.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var on=0,Fn=we($e,"callOnAdd",Be.callOnAdd),$n=we($e,"onReady",function(){}),nr=we($e,"debug",Be.debug);ee(Ot,function(Jt){oe.getState(Jt)||(oe.initState(Jt),Ze.set(Jt));var _n=Ze.get(Jt);if(nr&&Gt.log("Attaching listener to element",_n,Jt),!bt.isDetectable(Jt)){if(nr&&Gt.log(_n,"Not detectable."),bt.isBusy(Jt)){nr&&Gt.log(_n,"System busy making it detectable"),Xt(Fn,Jt,vt),Rt[_n]=Rt[_n]||[],Rt[_n].push(function(){on++,on===Ot.length&&$n()});return}return nr&&Gt.log(_n,"Making detectable..."),bt.markBusy(Jt,!0),yt.makeDetectable({debug:nr,important:bn},Jt,function(an){if(nr&&Gt.log(_n,"onElementDetectable"),oe.getState(an)){bt.markAsDetectable(an),bt.markBusy(an,!1),yt.addListener(an,Me),Xt(Fn,an,vt);var Ut=oe.getState(an);if(Ut&&Ut.startSize){var Dt=an.offsetWidth,Ie=an.offsetHeight;(Ut.startSize.width!==Dt||Ut.startSize.height!==Ie)&&Me(an)}Rt[_n]&&ee(Rt[_n],function(qe){qe()})}else nr&&Gt.log(_n,"Element uninstalled before being detectable.");delete Rt[_n],on++,on===Ot.length&&$n()})}nr&&Gt.log(_n,"Already detecable, adding listener."),Xt(Fn,Jt,vt),on++}),on===Ot.length&&$n()}function it($e){if(!$e)return Gt.error("At least one element is required.");if(Se($e))$e=[$e];else if(ye($e))$e=De($e);else return Gt.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");ee($e,function(Ot){Re.removeAllListeners(Ot),yt.uninstall(Ot),oe.cleanState(Ot)})}function Qe($e){yt.initDocument&&yt.initDocument($e)}return{listenTo:Oe,removeListener:Re.removeListener,removeAllListeners:Re.removeAllListeners,uninstall:it,initDocument:Qe}};function we(ce,Ze,xt){var ht=ce[Ze];return ht==null&&xt!==void 0?xt:ht}},68452:function($t){"use strict";$t.exports=function(W){var D=W.stateHandler.getState;function ee(re){var fe=D(re);return fe&&!!fe.isDetectable}function X(re){D(re).isDetectable=!0}function E(re){return!!D(re).busy}function ve(re,fe){D(re).busy=!!fe}return{isDetectable:ee,markAsDetectable:X,isBusy:E,markBusy:ve}}},75805:function($t){"use strict";$t.exports=function(){var W=1;function D(){return W++}return{generate:D}}},79799:function($t){"use strict";$t.exports=function(W){var D=W.idGenerator,ee=W.stateHandler.getState;function X(ve){var re=ee(ve);return re&&re.id!==void 0?re.id:null}function E(ve){var re=ee(ve);if(!re)throw new Error("setId required the element to have a resize detection state.");var fe=D.generate();return re.id=fe,fe}return{get:X,set:E}}},96199:function($t){"use strict";$t.exports=function(W){var D={};function ee(re){var fe=W.get(re);return fe===void 0?[]:D[fe]||[]}function X(re,fe){var ae=W.get(re);D[ae]||(D[ae]=[]),D[ae].push(fe)}function E(re,fe){for(var ae=ee(re),Ee=0,oe=ae.length;Ee<oe;++Ee)if(ae[Ee]===fe){ae.splice(Ee,1);break}}function ve(re){var fe=ee(re);fe&&(fe.length=0)}return{get:ee,add:X,removeListener:E,removeAllListeners:ve}}},71724:function($t){"use strict";$t.exports=function(W){function D(){}var ee={log:D,warn:D,error:D};if(!W&&window.console){var X=function(E,ve){E[ve]=function(){var fe=console[ve];if(fe.apply)fe.apply(console,arguments);else for(var ae=0;ae<arguments.length;ae++)fe(arguments[ae])}};X(ee,"log"),X(ee,"warn"),X(ee,"error")}return ee}},21931:function($t){"use strict";var W="_erd";function D(E){return E[W]={},ee(E)}function ee(E){return E[W]}function X(E){delete E[W]}$t.exports={initState:D,getState:ee,cleanState:X}},26729:function($t){"use strict";var W=Object.prototype.hasOwnProperty,D="~";function ee(){}Object.create&&(ee.prototype=Object.create(null),new ee().__proto__||(D=!1));function X(fe,ae,Ee){this.fn=fe,this.context=ae,this.once=Ee||!1}function E(fe,ae,Ee,oe,ze){if(typeof Ee!="function")throw new TypeError("The listener must be a function");var te=new X(Ee,oe||fe,ze),ye=D?D+ae:ae;return fe._events[ye]?fe._events[ye].fn?fe._events[ye]=[fe._events[ye],te]:fe._events[ye].push(te):(fe._events[ye]=te,fe._eventsCount++),fe}function ve(fe,ae){--fe._eventsCount===0?fe._events=new ee:delete fe._events[ae]}function re(){this._events=new ee,this._eventsCount=0}re.prototype.eventNames=function(){var ae=[],Ee,oe;if(this._eventsCount===0)return ae;for(oe in Ee=this._events)W.call(Ee,oe)&&ae.push(D?oe.slice(1):oe);return Object.getOwnPropertySymbols?ae.concat(Object.getOwnPropertySymbols(Ee)):ae},re.prototype.listeners=function(ae){var Ee=D?D+ae:ae,oe=this._events[Ee];if(!oe)return[];if(oe.fn)return[oe.fn];for(var ze=0,te=oe.length,ye=new Array(te);ze<te;ze++)ye[ze]=oe[ze].fn;return ye},re.prototype.listenerCount=function(ae){var Ee=D?D+ae:ae,oe=this._events[Ee];return oe?oe.fn?1:oe.length:0},re.prototype.emit=function(ae,Ee,oe,ze,te,ye){var De=D?D+ae:ae;if(!this._events[De])return!1;var Se=this._events[De],we=arguments.length,ce,Ze;if(Se.fn){switch(Se.once&&this.removeListener(ae,Se.fn,void 0,!0),we){case 1:return Se.fn.call(Se.context),!0;case 2:return Se.fn.call(Se.context,Ee),!0;case 3:return Se.fn.call(Se.context,Ee,oe),!0;case 4:return Se.fn.call(Se.context,Ee,oe,ze),!0;case 5:return Se.fn.call(Se.context,Ee,oe,ze,te),!0;case 6:return Se.fn.call(Se.context,Ee,oe,ze,te,ye),!0}for(Ze=1,ce=new Array(we-1);Ze<we;Ze++)ce[Ze-1]=arguments[Ze];Se.fn.apply(Se.context,ce)}else{var xt=Se.length,ht;for(Ze=0;Ze<xt;Ze++)switch(Se[Ze].once&&this.removeListener(ae,Se[Ze].fn,void 0,!0),we){case 1:Se[Ze].fn.call(Se[Ze].context);break;case 2:Se[Ze].fn.call(Se[Ze].context,Ee);break;case 3:Se[Ze].fn.call(Se[Ze].context,Ee,oe);break;case 4:Se[Ze].fn.call(Se[Ze].context,Ee,oe,ze);break;default:if(!ce)for(ht=1,ce=new Array(we-1);ht<we;ht++)ce[ht-1]=arguments[ht];Se[Ze].fn.apply(Se[Ze].context,ce)}}return!0},re.prototype.on=function(ae,Ee,oe){return E(this,ae,Ee,oe,!1)},re.prototype.once=function(ae,Ee,oe){return E(this,ae,Ee,oe,!0)},re.prototype.removeListener=function(ae,Ee,oe,ze){var te=D?D+ae:ae;if(!this._events[te])return this;if(!Ee)return ve(this,te),this;var ye=this._events[te];if(ye.fn)ye.fn===Ee&&(!ze||ye.once)&&(!oe||ye.context===oe)&&ve(this,te);else{for(var De=0,Se=[],we=ye.length;De<we;De++)(ye[De].fn!==Ee||ze&&!ye[De].once||oe&&ye[De].context!==oe)&&Se.push(ye[De]);Se.length?this._events[te]=Se.length===1?Se[0]:Se:ve(this,te)}return this},re.prototype.removeAllListeners=function(ae){var Ee;return ae?(Ee=D?D+ae:ae,this._events[Ee]&&ve(this,Ee)):(this._events=new ee,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=D,re.EventEmitter=re,$t.exports=re},69916:function($t,W){(function(D,ee){ee(W)})(this,function(D){"use strict";function ee(De,Se,we,ce){ce=ce||{};var Ze=ce.maxIterations||100,xt=ce.tolerance||1e-10,ht=De(Se),Gt=De(we),mt=we-Se;if(ht*Gt>0)throw"Initial bisect points must have opposite signs";if(ht===0)return Se;if(Gt===0)return we;for(var gt=0;gt<Ze;++gt){mt/=2;var Be=Se+mt,Re=De(Be);if(Re*ht>=0&&(Se=Be),Math.abs(mt)<xt||Re===0)return Be}return Se+mt}function X(De){for(var Se=new Array(De),we=0;we<De;++we)Se[we]=0;return Se}function E(De,Se){return X(De).map(function(){return X(Se)})}function ve(De,Se){for(var we=0,ce=0;ce<De.length;++ce)we+=De[ce]*Se[ce];return we}function re(De){return Math.sqrt(ve(De,De))}function fe(De,Se,we){for(var ce=0;ce<Se.length;++ce)De[ce]=Se[ce]*we}function ae(De,Se,we,ce,Ze){for(var xt=0;xt<De.length;++xt)De[xt]=Se*we[xt]+ce*Ze[xt]}function Ee(De,Se,we){we=we||{};var ce=we.maxIterations||Se.length*200,Ze=we.nonZeroDelta||1.05,xt=we.zeroDelta||.001,ht=we.minErrorDelta||1e-6,Gt=we.minErrorDelta||1e-5,mt=we.rho!==void 0?we.rho:1,gt=we.chi!==void 0?we.chi:2,Be=we.psi!==void 0?we.psi:-.5,Re=we.sigma!==void 0?we.sigma:.5,bt,yt=Se.length,At=new Array(yt+1);At[0]=Se,At[0].fx=De(Se),At[0].id=0;for(var bn=0;bn<yt;++bn){var He=Se.slice();He[bn]=He[bn]?He[bn]*Ze:xt,At[bn+1]=He,At[bn+1].fx=De(He),At[bn+1].id=bn+1}function Rt($n){for(var nr=0;nr<$n.length;nr++)At[yt][nr]=$n[nr];At[yt].fx=$n.fx}for(var Oe=function($n,nr){return $n.fx-nr.fx},it=Se.slice(),Qe=Se.slice(),$e=Se.slice(),Ot=Se.slice(),vt=0;vt<ce;++vt){if(At.sort(Oe),we.history){var Me=At.map(function($n){var nr=$n.slice();return nr.fx=$n.fx,nr.id=$n.id,nr});Me.sort(function($n,nr){return $n.id-nr.id}),we.history.push({x:At[0].slice(),fx:At[0].fx,simplex:Me})}for(bt=0,bn=0;bn<yt;++bn)bt=Math.max(bt,Math.abs(At[0][bn]-At[1][bn]));if(Math.abs(At[0].fx-At[yt].fx)<ht&&bt<Gt)break;for(bn=0;bn<yt;++bn){it[bn]=0;for(var Xt=0;Xt<yt;++Xt)it[bn]+=At[Xt][bn];it[bn]/=yt}var on=At[yt];if(ae(Qe,1+mt,it,-mt,on),Qe.fx=De(Qe),Qe.fx<At[0].fx)ae(Ot,1+gt,it,-gt,on),Ot.fx=De(Ot),Ot.fx<Qe.fx?Rt(Ot):Rt(Qe);else if(Qe.fx>=At[yt-1].fx){var Fn=!1;if(Qe.fx>on.fx?(ae($e,1+Be,it,-Be,on),$e.fx=De($e),$e.fx<on.fx?Rt($e):Fn=!0):(ae($e,1-Be*mt,it,Be*mt,on),$e.fx=De($e),$e.fx<Qe.fx?Rt($e):Fn=!0),Fn){if(Re>=1)break;for(bn=1;bn<At.length;++bn)ae(At[bn],1-Re,At[0],Re,At[bn]),At[bn].fx=De(At[bn])}}else Rt(Qe)}return At.sort(Oe),{fx:At[0].fx,x:At[0]}}function oe(De,Se,we,ce,Ze,xt,ht){var Gt=we.fx,mt=ve(we.fxprime,Se),gt=Gt,Be=Gt,Re=mt,bt=0;Ze=Ze||1,xt=xt||1e-6,ht=ht||.1;function yt(bn,He,Rt){for(var Oe=0;Oe<16;++Oe)if(Ze=(bn+He)/2,ae(ce.x,1,we.x,Ze,Se),gt=ce.fx=De(ce.x,ce.fxprime),Re=ve(ce.fxprime,Se),gt>Gt+xt*Ze*mt||gt>=Rt)He=Ze;else{if(Math.abs(Re)<=-ht*mt)return Ze;Re*(He-bn)>=0&&(He=bn),bn=Ze,Rt=gt}return 0}for(var At=0;At<10;++At){if(ae(ce.x,1,we.x,Ze,Se),gt=ce.fx=De(ce.x,ce.fxprime),Re=ve(ce.fxprime,Se),gt>Gt+xt*Ze*mt||At&&gt>=Be)return yt(bt,Ze,Be);if(Math.abs(Re)<=-ht*mt)return Ze;if(Re>=0)return yt(Ze,bt,gt);Be=gt,bt=Ze,Ze*=2}return Ze}function ze(De,Se,we){var ce={x:Se.slice(),fx:0,fxprime:Se.slice()},Ze={x:Se.slice(),fx:0,fxprime:Se.slice()},xt=Se.slice(),ht,Gt,mt=1,gt;we=we||{},gt=we.maxIterations||Se.length*20,ce.fx=De(ce.x,ce.fxprime),ht=ce.fxprime.slice(),fe(ht,ce.fxprime,-1);for(var Be=0;Be<gt;++Be){if(mt=oe(De,ht,ce,Ze,mt),we.history&&we.history.push({x:ce.x.slice(),fx:ce.fx,fxprime:ce.fxprime.slice(),alpha:mt}),!mt)fe(ht,ce.fxprime,-1);else{ae(xt,1,Ze.fxprime,-1,ce.fxprime);var Re=ve(ce.fxprime,ce.fxprime),bt=Math.max(0,ve(xt,Ze.fxprime)/Re);ae(ht,bt,ht,-1,Ze.fxprime),Gt=ce,ce=Ze,Ze=Gt}if(re(ce.fxprime)<=1e-5)break}return we.history&&we.history.push({x:ce.x.slice(),fx:ce.fx,fxprime:ce.fxprime.slice(),alpha:mt}),ce}function te(De,Se,we){we=we||{};for(var ce=we.maxIterations||Se.length*100,Ze=we.learnRate||.001,xt={x:Se.slice(),fx:0,fxprime:Se.slice()},ht=0;ht<ce&&(xt.fx=De(xt.x,xt.fxprime),we.history&&we.history.push({x:xt.x.slice(),fx:xt.fx,fxprime:xt.fxprime.slice()}),ae(xt.x,1,xt.x,-Ze,xt.fxprime),!(re(xt.fxprime)<=1e-5));++ht);return xt}function ye(De,Se,we){we=we||{};var ce={x:Se.slice(),fx:0,fxprime:Se.slice()},Ze={x:Se.slice(),fx:0,fxprime:Se.slice()},xt=we.maxIterations||Se.length*100,ht=we.learnRate||1,Gt=Se.slice(),mt=we.c1||.001,gt=we.c2||.1,Be,Re=[];if(we.history){var bt=De;De=function(At,bn){return Re.push(At.slice()),bt(At,bn)}}ce.fx=De(ce.x,ce.fxprime);for(var yt=0;yt<xt&&(fe(Gt,ce.fxprime,-1),ht=oe(De,Gt,ce,Ze,ht,mt,gt),we.history&&(we.history.push({x:ce.x.slice(),fx:ce.fx,fxprime:ce.fxprime.slice(),functionCalls:Re,learnRate:ht,alpha:ht}),Re=[]),Be=ce,ce=Ze,Ze=Be,!(ht===0||re(ce.fxprime)<1e-5));++yt);return ce}D.bisect=ee,D.nelderMead=Ee,D.conjugateGradient=ze,D.gradientDescent=te,D.gradientDescentLineSearch=ye,D.zeros=X,D.zerosM=E,D.norm2=re,D.weightedSum=ae,D.scale=fe})},49685:function($t,W,D){"use strict";D.d(W,{Ib:function(){return ee},WT:function(){return X}});var ee=1e-6,X=typeof Float32Array!="undefined"?Float32Array:Array,E=Math.random;function ve(Ee){X=Ee}var re=Math.PI/180;function fe(Ee){return Ee*re}function ae(Ee,oe){return Math.abs(Ee-oe)<=ee*Math.max(1,Math.abs(Ee),Math.abs(oe))}Math.hypot||(Math.hypot=function(){for(var Ee=0,oe=arguments.length;oe--;)Ee+=arguments[oe]*arguments[oe];return Math.sqrt(Ee)})},85975:function($t,W,D){"use strict";D.r(W),D.d(W,{add:function(){return _n},adjoint:function(){return ze},clone:function(){return E},copy:function(){return ve},create:function(){return X},determinant:function(){return te},equals:function(){return Ie},exactEquals:function(){return Dt},frob:function(){return Jt},fromQuat:function(){return it},fromQuat2:function(){return yt},fromRotation:function(){return mt},fromRotationTranslation:function(){return bt},fromRotationTranslationScale:function(){return Rt},fromRotationTranslationScaleOrigin:function(){return Oe},fromScaling:function(){return Gt},fromTranslation:function(){return ht},fromValues:function(){return re},fromXRotation:function(){return gt},fromYRotation:function(){return Be},fromZRotation:function(){return Re},frustum:function(){return Qe},getRotation:function(){return He},getScaling:function(){return bn},getTranslation:function(){return At},identity:function(){return ae},invert:function(){return oe},lookAt:function(){return $n},mul:function(){return qe},multiply:function(){return ye},multiplyScalar:function(){return an},multiplyScalarAndAdd:function(){return Ut},ortho:function(){return on},orthoNO:function(){return Xt},orthoZO:function(){return Fn},perspective:function(){return Ot},perspectiveFromFieldOfView:function(){return Me},perspectiveNO:function(){return $e},perspectiveZO:function(){return vt},rotate:function(){return we},rotateX:function(){return ce},rotateY:function(){return Ze},rotateZ:function(){return xt},scale:function(){return Se},set:function(){return fe},str:function(){return Ht},sub:function(){return Bt},subtract:function(){return tr},targetTo:function(){return nr},translate:function(){return De},transpose:function(){return Ee}});var ee=D(49685);function X(){var j=new ee.WT(16);return ee.WT!=Float32Array&&(j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[11]=0,j[12]=0,j[13]=0,j[14]=0),j[0]=1,j[5]=1,j[10]=1,j[15]=1,j}function E(j){var le=new ee.WT(16);return le[0]=j[0],le[1]=j[1],le[2]=j[2],le[3]=j[3],le[4]=j[4],le[5]=j[5],le[6]=j[6],le[7]=j[7],le[8]=j[8],le[9]=j[9],le[10]=j[10],le[11]=j[11],le[12]=j[12],le[13]=j[13],le[14]=j[14],le[15]=j[15],le}function ve(j,le){return j[0]=le[0],j[1]=le[1],j[2]=le[2],j[3]=le[3],j[4]=le[4],j[5]=le[5],j[6]=le[6],j[7]=le[7],j[8]=le[8],j[9]=le[9],j[10]=le[10],j[11]=le[11],j[12]=le[12],j[13]=le[13],j[14]=le[14],j[15]=le[15],j}function re(j,le,z,de,Zt,nt,St,In,Wn,qn,hn,pt,Wt,An,Pn,Xn){var dt=new ee.WT(16);return dt[0]=j,dt[1]=le,dt[2]=z,dt[3]=de,dt[4]=Zt,dt[5]=nt,dt[6]=St,dt[7]=In,dt[8]=Wn,dt[9]=qn,dt[10]=hn,dt[11]=pt,dt[12]=Wt,dt[13]=An,dt[14]=Pn,dt[15]=Xn,dt}function fe(j,le,z,de,Zt,nt,St,In,Wn,qn,hn,pt,Wt,An,Pn,Xn,dt){return j[0]=le,j[1]=z,j[2]=de,j[3]=Zt,j[4]=nt,j[5]=St,j[6]=In,j[7]=Wn,j[8]=qn,j[9]=hn,j[10]=pt,j[11]=Wt,j[12]=An,j[13]=Pn,j[14]=Xn,j[15]=dt,j}function ae(j){return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function Ee(j,le){if(j===le){var z=le[1],de=le[2],Zt=le[3],nt=le[6],St=le[7],In=le[11];j[1]=le[4],j[2]=le[8],j[3]=le[12],j[4]=z,j[6]=le[9],j[7]=le[13],j[8]=de,j[9]=nt,j[11]=le[14],j[12]=Zt,j[13]=St,j[14]=In}else j[0]=le[0],j[1]=le[4],j[2]=le[8],j[3]=le[12],j[4]=le[1],j[5]=le[5],j[6]=le[9],j[7]=le[13],j[8]=le[2],j[9]=le[6],j[10]=le[10],j[11]=le[14],j[12]=le[3],j[13]=le[7],j[14]=le[11],j[15]=le[15];return j}function oe(j,le){var z=le[0],de=le[1],Zt=le[2],nt=le[3],St=le[4],In=le[5],Wn=le[6],qn=le[7],hn=le[8],pt=le[9],Wt=le[10],An=le[11],Pn=le[12],Xn=le[13],dt=le[14],be=le[15],Ne=z*In-de*St,ot=z*Wn-Zt*St,Pt=z*qn-nt*St,It=de*Wn-Zt*In,xn=de*qn-nt*In,Qn=Zt*qn-nt*Wn,br=hn*Xn-pt*Pn,Jn=hn*dt-Wt*Pn,Ae=hn*be-An*Pn,xe=pt*dt-Wt*Xn,ke=pt*be-An*Xn,tt=Wt*be-An*dt,Et=Ne*tt-ot*ke+Pt*xe+It*Ae-xn*Jn+Qn*br;return Et?(Et=1/Et,j[0]=(In*tt-Wn*ke+qn*xe)*Et,j[1]=(Zt*ke-de*tt-nt*xe)*Et,j[2]=(Xn*Qn-dt*xn+be*It)*Et,j[3]=(Wt*xn-pt*Qn-An*It)*Et,j[4]=(Wn*Ae-St*tt-qn*Jn)*Et,j[5]=(z*tt-Zt*Ae+nt*Jn)*Et,j[6]=(dt*Pt-Pn*Qn-be*ot)*Et,j[7]=(hn*Qn-Wt*Pt+An*ot)*Et,j[8]=(St*ke-In*Ae+qn*br)*Et,j[9]=(de*Ae-z*ke-nt*br)*Et,j[10]=(Pn*xn-Xn*Pt+be*Ne)*Et,j[11]=(pt*Pt-hn*xn-An*Ne)*Et,j[12]=(In*Jn-St*xe-Wn*br)*Et,j[13]=(z*xe-de*Jn+Zt*br)*Et,j[14]=(Xn*ot-Pn*It-dt*Ne)*Et,j[15]=(hn*It-pt*ot+Wt*Ne)*Et,j):null}function ze(j,le){var z=le[0],de=le[1],Zt=le[2],nt=le[3],St=le[4],In=le[5],Wn=le[6],qn=le[7],hn=le[8],pt=le[9],Wt=le[10],An=le[11],Pn=le[12],Xn=le[13],dt=le[14],be=le[15];return j[0]=In*(Wt*be-An*dt)-pt*(Wn*be-qn*dt)+Xn*(Wn*An-qn*Wt),j[1]=-(de*(Wt*be-An*dt)-pt*(Zt*be-nt*dt)+Xn*(Zt*An-nt*Wt)),j[2]=de*(Wn*be-qn*dt)-In*(Zt*be-nt*dt)+Xn*(Zt*qn-nt*Wn),j[3]=-(de*(Wn*An-qn*Wt)-In*(Zt*An-nt*Wt)+pt*(Zt*qn-nt*Wn)),j[4]=-(St*(Wt*be-An*dt)-hn*(Wn*be-qn*dt)+Pn*(Wn*An-qn*Wt)),j[5]=z*(Wt*be-An*dt)-hn*(Zt*be-nt*dt)+Pn*(Zt*An-nt*Wt),j[6]=-(z*(Wn*be-qn*dt)-St*(Zt*be-nt*dt)+Pn*(Zt*qn-nt*Wn)),j[7]=z*(Wn*An-qn*Wt)-St*(Zt*An-nt*Wt)+hn*(Zt*qn-nt*Wn),j[8]=St*(pt*be-An*Xn)-hn*(In*be-qn*Xn)+Pn*(In*An-qn*pt),j[9]=-(z*(pt*be-An*Xn)-hn*(de*be-nt*Xn)+Pn*(de*An-nt*pt)),j[10]=z*(In*be-qn*Xn)-St*(de*be-nt*Xn)+Pn*(de*qn-nt*In),j[11]=-(z*(In*An-qn*pt)-St*(de*An-nt*pt)+hn*(de*qn-nt*In)),j[12]=-(St*(pt*dt-Wt*Xn)-hn*(In*dt-Wn*Xn)+Pn*(In*Wt-Wn*pt)),j[13]=z*(pt*dt-Wt*Xn)-hn*(de*dt-Zt*Xn)+Pn*(de*Wt-Zt*pt),j[14]=-(z*(In*dt-Wn*Xn)-St*(de*dt-Zt*Xn)+Pn*(de*Wn-Zt*In)),j[15]=z*(In*Wt-Wn*pt)-St*(de*Wt-Zt*pt)+hn*(de*Wn-Zt*In),j}function te(j){var le=j[0],z=j[1],de=j[2],Zt=j[3],nt=j[4],St=j[5],In=j[6],Wn=j[7],qn=j[8],hn=j[9],pt=j[10],Wt=j[11],An=j[12],Pn=j[13],Xn=j[14],dt=j[15],be=le*St-z*nt,Ne=le*In-de*nt,ot=le*Wn-Zt*nt,Pt=z*In-de*St,It=z*Wn-Zt*St,xn=de*Wn-Zt*In,Qn=qn*Pn-hn*An,br=qn*Xn-pt*An,Jn=qn*dt-Wt*An,Ae=hn*Xn-pt*Pn,xe=hn*dt-Wt*Pn,ke=pt*dt-Wt*Xn;return be*ke-Ne*xe+ot*Ae+Pt*Jn-It*br+xn*Qn}function ye(j,le,z){var de=le[0],Zt=le[1],nt=le[2],St=le[3],In=le[4],Wn=le[5],qn=le[6],hn=le[7],pt=le[8],Wt=le[9],An=le[10],Pn=le[11],Xn=le[12],dt=le[13],be=le[14],Ne=le[15],ot=z[0],Pt=z[1],It=z[2],xn=z[3];return j[0]=ot*de+Pt*In+It*pt+xn*Xn,j[1]=ot*Zt+Pt*Wn+It*Wt+xn*dt,j[2]=ot*nt+Pt*qn+It*An+xn*be,j[3]=ot*St+Pt*hn+It*Pn+xn*Ne,ot=z[4],Pt=z[5],It=z[6],xn=z[7],j[4]=ot*de+Pt*In+It*pt+xn*Xn,j[5]=ot*Zt+Pt*Wn+It*Wt+xn*dt,j[6]=ot*nt+Pt*qn+It*An+xn*be,j[7]=ot*St+Pt*hn+It*Pn+xn*Ne,ot=z[8],Pt=z[9],It=z[10],xn=z[11],j[8]=ot*de+Pt*In+It*pt+xn*Xn,j[9]=ot*Zt+Pt*Wn+It*Wt+xn*dt,j[10]=ot*nt+Pt*qn+It*An+xn*be,j[11]=ot*St+Pt*hn+It*Pn+xn*Ne,ot=z[12],Pt=z[13],It=z[14],xn=z[15],j[12]=ot*de+Pt*In+It*pt+xn*Xn,j[13]=ot*Zt+Pt*Wn+It*Wt+xn*dt,j[14]=ot*nt+Pt*qn+It*An+xn*be,j[15]=ot*St+Pt*hn+It*Pn+xn*Ne,j}function De(j,le,z){var de=z[0],Zt=z[1],nt=z[2],St,In,Wn,qn,hn,pt,Wt,An,Pn,Xn,dt,be;return le===j?(j[12]=le[0]*de+le[4]*Zt+le[8]*nt+le[12],j[13]=le[1]*de+le[5]*Zt+le[9]*nt+le[13],j[14]=le[2]*de+le[6]*Zt+le[10]*nt+le[14],j[15]=le[3]*de+le[7]*Zt+le[11]*nt+le[15]):(St=le[0],In=le[1],Wn=le[2],qn=le[3],hn=le[4],pt=le[5],Wt=le[6],An=le[7],Pn=le[8],Xn=le[9],dt=le[10],be=le[11],j[0]=St,j[1]=In,j[2]=Wn,j[3]=qn,j[4]=hn,j[5]=pt,j[6]=Wt,j[7]=An,j[8]=Pn,j[9]=Xn,j[10]=dt,j[11]=be,j[12]=St*de+hn*Zt+Pn*nt+le[12],j[13]=In*de+pt*Zt+Xn*nt+le[13],j[14]=Wn*de+Wt*Zt+dt*nt+le[14],j[15]=qn*de+An*Zt+be*nt+le[15]),j}function Se(j,le,z){var de=z[0],Zt=z[1],nt=z[2];return j[0]=le[0]*de,j[1]=le[1]*de,j[2]=le[2]*de,j[3]=le[3]*de,j[4]=le[4]*Zt,j[5]=le[5]*Zt,j[6]=le[6]*Zt,j[7]=le[7]*Zt,j[8]=le[8]*nt,j[9]=le[9]*nt,j[10]=le[10]*nt,j[11]=le[11]*nt,j[12]=le[12],j[13]=le[13],j[14]=le[14],j[15]=le[15],j}function we(j,le,z,de){var Zt=de[0],nt=de[1],St=de[2],In=Math.hypot(Zt,nt,St),Wn,qn,hn,pt,Wt,An,Pn,Xn,dt,be,Ne,ot,Pt,It,xn,Qn,br,Jn,Ae,xe,ke,tt,Et,tn;return In<ee.Ib?null:(In=1/In,Zt*=In,nt*=In,St*=In,Wn=Math.sin(z),qn=Math.cos(z),hn=1-qn,pt=le[0],Wt=le[1],An=le[2],Pn=le[3],Xn=le[4],dt=le[5],be=le[6],Ne=le[7],ot=le[8],Pt=le[9],It=le[10],xn=le[11],Qn=Zt*Zt*hn+qn,br=nt*Zt*hn+St*Wn,Jn=St*Zt*hn-nt*Wn,Ae=Zt*nt*hn-St*Wn,xe=nt*nt*hn+qn,ke=St*nt*hn+Zt*Wn,tt=Zt*St*hn+nt*Wn,Et=nt*St*hn-Zt*Wn,tn=St*St*hn+qn,j[0]=pt*Qn+Xn*br+ot*Jn,j[1]=Wt*Qn+dt*br+Pt*Jn,j[2]=An*Qn+be*br+It*Jn,j[3]=Pn*Qn+Ne*br+xn*Jn,j[4]=pt*Ae+Xn*xe+ot*ke,j[5]=Wt*Ae+dt*xe+Pt*ke,j[6]=An*Ae+be*xe+It*ke,j[7]=Pn*Ae+Ne*xe+xn*ke,j[8]=pt*tt+Xn*Et+ot*tn,j[9]=Wt*tt+dt*Et+Pt*tn,j[10]=An*tt+be*Et+It*tn,j[11]=Pn*tt+Ne*Et+xn*tn,le!==j&&(j[12]=le[12],j[13]=le[13],j[14]=le[14],j[15]=le[15]),j)}function ce(j,le,z){var de=Math.sin(z),Zt=Math.cos(z),nt=le[4],St=le[5],In=le[6],Wn=le[7],qn=le[8],hn=le[9],pt=le[10],Wt=le[11];return le!==j&&(j[0]=le[0],j[1]=le[1],j[2]=le[2],j[3]=le[3],j[12]=le[12],j[13]=le[13],j[14]=le[14],j[15]=le[15]),j[4]=nt*Zt+qn*de,j[5]=St*Zt+hn*de,j[6]=In*Zt+pt*de,j[7]=Wn*Zt+Wt*de,j[8]=qn*Zt-nt*de,j[9]=hn*Zt-St*de,j[10]=pt*Zt-In*de,j[11]=Wt*Zt-Wn*de,j}function Ze(j,le,z){var de=Math.sin(z),Zt=Math.cos(z),nt=le[0],St=le[1],In=le[2],Wn=le[3],qn=le[8],hn=le[9],pt=le[10],Wt=le[11];return le!==j&&(j[4]=le[4],j[5]=le[5],j[6]=le[6],j[7]=le[7],j[12]=le[12],j[13]=le[13],j[14]=le[14],j[15]=le[15]),j[0]=nt*Zt-qn*de,j[1]=St*Zt-hn*de,j[2]=In*Zt-pt*de,j[3]=Wn*Zt-Wt*de,j[8]=nt*de+qn*Zt,j[9]=St*de+hn*Zt,j[10]=In*de+pt*Zt,j[11]=Wn*de+Wt*Zt,j}function xt(j,le,z){var de=Math.sin(z),Zt=Math.cos(z),nt=le[0],St=le[1],In=le[2],Wn=le[3],qn=le[4],hn=le[5],pt=le[6],Wt=le[7];return le!==j&&(j[8]=le[8],j[9]=le[9],j[10]=le[10],j[11]=le[11],j[12]=le[12],j[13]=le[13],j[14]=le[14],j[15]=le[15]),j[0]=nt*Zt+qn*de,j[1]=St*Zt+hn*de,j[2]=In*Zt+pt*de,j[3]=Wn*Zt+Wt*de,j[4]=qn*Zt-nt*de,j[5]=hn*Zt-St*de,j[6]=pt*Zt-In*de,j[7]=Wt*Zt-Wn*de,j}function ht(j,le){return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=le[0],j[13]=le[1],j[14]=le[2],j[15]=1,j}function Gt(j,le){return j[0]=le[0],j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=le[1],j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=le[2],j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function mt(j,le,z){var de=z[0],Zt=z[1],nt=z[2],St=Math.hypot(de,Zt,nt),In,Wn,qn;return St<ee.Ib?null:(St=1/St,de*=St,Zt*=St,nt*=St,In=Math.sin(le),Wn=Math.cos(le),qn=1-Wn,j[0]=de*de*qn+Wn,j[1]=Zt*de*qn+nt*In,j[2]=nt*de*qn-Zt*In,j[3]=0,j[4]=de*Zt*qn-nt*In,j[5]=Zt*Zt*qn+Wn,j[6]=nt*Zt*qn+de*In,j[7]=0,j[8]=de*nt*qn+Zt*In,j[9]=Zt*nt*qn-de*In,j[10]=nt*nt*qn+Wn,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j)}function gt(j,le){var z=Math.sin(le),de=Math.cos(le);return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=de,j[6]=z,j[7]=0,j[8]=0,j[9]=-z,j[10]=de,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function Be(j,le){var z=Math.sin(le),de=Math.cos(le);return j[0]=de,j[1]=0,j[2]=-z,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=z,j[9]=0,j[10]=de,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function Re(j,le){var z=Math.sin(le),de=Math.cos(le);return j[0]=de,j[1]=z,j[2]=0,j[3]=0,j[4]=-z,j[5]=de,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function bt(j,le,z){var de=le[0],Zt=le[1],nt=le[2],St=le[3],In=de+de,Wn=Zt+Zt,qn=nt+nt,hn=de*In,pt=de*Wn,Wt=de*qn,An=Zt*Wn,Pn=Zt*qn,Xn=nt*qn,dt=St*In,be=St*Wn,Ne=St*qn;return j[0]=1-(An+Xn),j[1]=pt+Ne,j[2]=Wt-be,j[3]=0,j[4]=pt-Ne,j[5]=1-(hn+Xn),j[6]=Pn+dt,j[7]=0,j[8]=Wt+be,j[9]=Pn-dt,j[10]=1-(hn+An),j[11]=0,j[12]=z[0],j[13]=z[1],j[14]=z[2],j[15]=1,j}function yt(j,le){var z=new ee.WT(3),de=-le[0],Zt=-le[1],nt=-le[2],St=le[3],In=le[4],Wn=le[5],qn=le[6],hn=le[7],pt=de*de+Zt*Zt+nt*nt+St*St;return pt>0?(z[0]=(In*St+hn*de+Wn*nt-qn*Zt)*2/pt,z[1]=(Wn*St+hn*Zt+qn*de-In*nt)*2/pt,z[2]=(qn*St+hn*nt+In*Zt-Wn*de)*2/pt):(z[0]=(In*St+hn*de+Wn*nt-qn*Zt)*2,z[1]=(Wn*St+hn*Zt+qn*de-In*nt)*2,z[2]=(qn*St+hn*nt+In*Zt-Wn*de)*2),bt(j,le,z),j}function At(j,le){return j[0]=le[12],j[1]=le[13],j[2]=le[14],j}function bn(j,le){var z=le[0],de=le[1],Zt=le[2],nt=le[4],St=le[5],In=le[6],Wn=le[8],qn=le[9],hn=le[10];return j[0]=Math.hypot(z,de,Zt),j[1]=Math.hypot(nt,St,In),j[2]=Math.hypot(Wn,qn,hn),j}function He(j,le){var z=new ee.WT(3);bn(z,le);var de=1/z[0],Zt=1/z[1],nt=1/z[2],St=le[0]*de,In=le[1]*Zt,Wn=le[2]*nt,qn=le[4]*de,hn=le[5]*Zt,pt=le[6]*nt,Wt=le[8]*de,An=le[9]*Zt,Pn=le[10]*nt,Xn=St+hn+Pn,dt=0;return Xn>0?(dt=Math.sqrt(Xn+1)*2,j[3]=.25*dt,j[0]=(pt-An)/dt,j[1]=(Wt-Wn)/dt,j[2]=(In-qn)/dt):St>hn&&St>Pn?(dt=Math.sqrt(1+St-hn-Pn)*2,j[3]=(pt-An)/dt,j[0]=.25*dt,j[1]=(In+qn)/dt,j[2]=(Wt+Wn)/dt):hn>Pn?(dt=Math.sqrt(1+hn-St-Pn)*2,j[3]=(Wt-Wn)/dt,j[0]=(In+qn)/dt,j[1]=.25*dt,j[2]=(pt+An)/dt):(dt=Math.sqrt(1+Pn-St-hn)*2,j[3]=(In-qn)/dt,j[0]=(Wt+Wn)/dt,j[1]=(pt+An)/dt,j[2]=.25*dt),j}function Rt(j,le,z,de){var Zt=le[0],nt=le[1],St=le[2],In=le[3],Wn=Zt+Zt,qn=nt+nt,hn=St+St,pt=Zt*Wn,Wt=Zt*qn,An=Zt*hn,Pn=nt*qn,Xn=nt*hn,dt=St*hn,be=In*Wn,Ne=In*qn,ot=In*hn,Pt=de[0],It=de[1],xn=de[2];return j[0]=(1-(Pn+dt))*Pt,j[1]=(Wt+ot)*Pt,j[2]=(An-Ne)*Pt,j[3]=0,j[4]=(Wt-ot)*It,j[5]=(1-(pt+dt))*It,j[6]=(Xn+be)*It,j[7]=0,j[8]=(An+Ne)*xn,j[9]=(Xn-be)*xn,j[10]=(1-(pt+Pn))*xn,j[11]=0,j[12]=z[0],j[13]=z[1],j[14]=z[2],j[15]=1,j}function Oe(j,le,z,de,Zt){var nt=le[0],St=le[1],In=le[2],Wn=le[3],qn=nt+nt,hn=St+St,pt=In+In,Wt=nt*qn,An=nt*hn,Pn=nt*pt,Xn=St*hn,dt=St*pt,be=In*pt,Ne=Wn*qn,ot=Wn*hn,Pt=Wn*pt,It=de[0],xn=de[1],Qn=de[2],br=Zt[0],Jn=Zt[1],Ae=Zt[2],xe=(1-(Xn+be))*It,ke=(An+Pt)*It,tt=(Pn-ot)*It,Et=(An-Pt)*xn,tn=(1-(Wt+be))*xn,fn=(dt+Ne)*xn,_t=(Pn+ot)*Qn,en=(dt-Ne)*Qn,Gn=(1-(Wt+Xn))*Qn;return j[0]=xe,j[1]=ke,j[2]=tt,j[3]=0,j[4]=Et,j[5]=tn,j[6]=fn,j[7]=0,j[8]=_t,j[9]=en,j[10]=Gn,j[11]=0,j[12]=z[0]+br-(xe*br+Et*Jn+_t*Ae),j[13]=z[1]+Jn-(ke*br+tn*Jn+en*Ae),j[14]=z[2]+Ae-(tt*br+fn*Jn+Gn*Ae),j[15]=1,j}function it(j,le){var z=le[0],de=le[1],Zt=le[2],nt=le[3],St=z+z,In=de+de,Wn=Zt+Zt,qn=z*St,hn=de*St,pt=de*In,Wt=Zt*St,An=Zt*In,Pn=Zt*Wn,Xn=nt*St,dt=nt*In,be=nt*Wn;return j[0]=1-pt-Pn,j[1]=hn+be,j[2]=Wt-dt,j[3]=0,j[4]=hn-be,j[5]=1-qn-Pn,j[6]=An+Xn,j[7]=0,j[8]=Wt+dt,j[9]=An-Xn,j[10]=1-qn-pt,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function Qe(j,le,z,de,Zt,nt,St){var In=1/(z-le),Wn=1/(Zt-de),qn=1/(nt-St);return j[0]=nt*2*In,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=nt*2*Wn,j[6]=0,j[7]=0,j[8]=(z+le)*In,j[9]=(Zt+de)*Wn,j[10]=(St+nt)*qn,j[11]=-1,j[12]=0,j[13]=0,j[14]=St*nt*2*qn,j[15]=0,j}function $e(j,le,z,de,Zt){var nt=1/Math.tan(le/2),St;return j[0]=nt/z,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=nt,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[11]=-1,j[12]=0,j[13]=0,j[15]=0,Zt!=null&&Zt!==1/0?(St=1/(de-Zt),j[10]=(Zt+de)*St,j[14]=2*Zt*de*St):(j[10]=-1,j[14]=-2*de),j}var Ot=$e;function vt(j,le,z,de,Zt){var nt=1/Math.tan(le/2),St;return j[0]=nt/z,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=nt,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[11]=-1,j[12]=0,j[13]=0,j[15]=0,Zt!=null&&Zt!==1/0?(St=1/(de-Zt),j[10]=Zt*St,j[14]=Zt*de*St):(j[10]=-1,j[14]=-de),j}function Me(j,le,z,de){var Zt=Math.tan(le.upDegrees*Math.PI/180),nt=Math.tan(le.downDegrees*Math.PI/180),St=Math.tan(le.leftDegrees*Math.PI/180),In=Math.tan(le.rightDegrees*Math.PI/180),Wn=2/(St+In),qn=2/(Zt+nt);return j[0]=Wn,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=qn,j[6]=0,j[7]=0,j[8]=-((St-In)*Wn*.5),j[9]=(Zt-nt)*qn*.5,j[10]=de/(z-de),j[11]=-1,j[12]=0,j[13]=0,j[14]=de*z/(z-de),j[15]=0,j}function Xt(j,le,z,de,Zt,nt,St){var In=1/(le-z),Wn=1/(de-Zt),qn=1/(nt-St);return j[0]=-2*In,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=-2*Wn,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=2*qn,j[11]=0,j[12]=(le+z)*In,j[13]=(Zt+de)*Wn,j[14]=(St+nt)*qn,j[15]=1,j}var on=Xt;function Fn(j,le,z,de,Zt,nt,St){var In=1/(le-z),Wn=1/(de-Zt),qn=1/(nt-St);return j[0]=-2*In,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=-2*Wn,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=qn,j[11]=0,j[12]=(le+z)*In,j[13]=(Zt+de)*Wn,j[14]=nt*qn,j[15]=1,j}function $n(j,le,z,de){var Zt,nt,St,In,Wn,qn,hn,pt,Wt,An,Pn=le[0],Xn=le[1],dt=le[2],be=de[0],Ne=de[1],ot=de[2],Pt=z[0],It=z[1],xn=z[2];return Math.abs(Pn-Pt)<ee.Ib&&Math.abs(Xn-It)<ee.Ib&&Math.abs(dt-xn)<ee.Ib?ae(j):(hn=Pn-Pt,pt=Xn-It,Wt=dt-xn,An=1/Math.hypot(hn,pt,Wt),hn*=An,pt*=An,Wt*=An,Zt=Ne*Wt-ot*pt,nt=ot*hn-be*Wt,St=be*pt-Ne*hn,An=Math.hypot(Zt,nt,St),An?(An=1/An,Zt*=An,nt*=An,St*=An):(Zt=0,nt=0,St=0),In=pt*St-Wt*nt,Wn=Wt*Zt-hn*St,qn=hn*nt-pt*Zt,An=Math.hypot(In,Wn,qn),An?(An=1/An,In*=An,Wn*=An,qn*=An):(In=0,Wn=0,qn=0),j[0]=Zt,j[1]=In,j[2]=hn,j[3]=0,j[4]=nt,j[5]=Wn,j[6]=pt,j[7]=0,j[8]=St,j[9]=qn,j[10]=Wt,j[11]=0,j[12]=-(Zt*Pn+nt*Xn+St*dt),j[13]=-(In*Pn+Wn*Xn+qn*dt),j[14]=-(hn*Pn+pt*Xn+Wt*dt),j[15]=1,j)}function nr(j,le,z,de){var Zt=le[0],nt=le[1],St=le[2],In=de[0],Wn=de[1],qn=de[2],hn=Zt-z[0],pt=nt-z[1],Wt=St-z[2],An=hn*hn+pt*pt+Wt*Wt;An>0&&(An=1/Math.sqrt(An),hn*=An,pt*=An,Wt*=An);var Pn=Wn*Wt-qn*pt,Xn=qn*hn-In*Wt,dt=In*pt-Wn*hn;return An=Pn*Pn+Xn*Xn+dt*dt,An>0&&(An=1/Math.sqrt(An),Pn*=An,Xn*=An,dt*=An),j[0]=Pn,j[1]=Xn,j[2]=dt,j[3]=0,j[4]=pt*dt-Wt*Xn,j[5]=Wt*Pn-hn*dt,j[6]=hn*Xn-pt*Pn,j[7]=0,j[8]=hn,j[9]=pt,j[10]=Wt,j[11]=0,j[12]=Zt,j[13]=nt,j[14]=St,j[15]=1,j}function Ht(j){return"mat4("+j[0]+", "+j[1]+", "+j[2]+", "+j[3]+", "+j[4]+", "+j[5]+", "+j[6]+", "+j[7]+", "+j[8]+", "+j[9]+", "+j[10]+", "+j[11]+", "+j[12]+", "+j[13]+", "+j[14]+", "+j[15]+")"}function Jt(j){return Math.hypot(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],j[8],j[9],j[10],j[11],j[12],j[13],j[14],j[15])}function _n(j,le,z){return j[0]=le[0]+z[0],j[1]=le[1]+z[1],j[2]=le[2]+z[2],j[3]=le[3]+z[3],j[4]=le[4]+z[4],j[5]=le[5]+z[5],j[6]=le[6]+z[6],j[7]=le[7]+z[7],j[8]=le[8]+z[8],j[9]=le[9]+z[9],j[10]=le[10]+z[10],j[11]=le[11]+z[11],j[12]=le[12]+z[12],j[13]=le[13]+z[13],j[14]=le[14]+z[14],j[15]=le[15]+z[15],j}function tr(j,le,z){return j[0]=le[0]-z[0],j[1]=le[1]-z[1],j[2]=le[2]-z[2],j[3]=le[3]-z[3],j[4]=le[4]-z[4],j[5]=le[5]-z[5],j[6]=le[6]-z[6],j[7]=le[7]-z[7],j[8]=le[8]-z[8],j[9]=le[9]-z[9],j[10]=le[10]-z[10],j[11]=le[11]-z[11],j[12]=le[12]-z[12],j[13]=le[13]-z[13],j[14]=le[14]-z[14],j[15]=le[15]-z[15],j}function an(j,le,z){return j[0]=le[0]*z,j[1]=le[1]*z,j[2]=le[2]*z,j[3]=le[3]*z,j[4]=le[4]*z,j[5]=le[5]*z,j[6]=le[6]*z,j[7]=le[7]*z,j[8]=le[8]*z,j[9]=le[9]*z,j[10]=le[10]*z,j[11]=le[11]*z,j[12]=le[12]*z,j[13]=le[13]*z,j[14]=le[14]*z,j[15]=le[15]*z,j}function Ut(j,le,z,de){return j[0]=le[0]+z[0]*de,j[1]=le[1]+z[1]*de,j[2]=le[2]+z[2]*de,j[3]=le[3]+z[3]*de,j[4]=le[4]+z[4]*de,j[5]=le[5]+z[5]*de,j[6]=le[6]+z[6]*de,j[7]=le[7]+z[7]*de,j[8]=le[8]+z[8]*de,j[9]=le[9]+z[9]*de,j[10]=le[10]+z[10]*de,j[11]=le[11]+z[11]*de,j[12]=le[12]+z[12]*de,j[13]=le[13]+z[13]*de,j[14]=le[14]+z[14]*de,j[15]=le[15]+z[15]*de,j}function Dt(j,le){return j[0]===le[0]&&j[1]===le[1]&&j[2]===le[2]&&j[3]===le[3]&&j[4]===le[4]&&j[5]===le[5]&&j[6]===le[6]&&j[7]===le[7]&&j[8]===le[8]&&j[9]===le[9]&&j[10]===le[10]&&j[11]===le[11]&&j[12]===le[12]&&j[13]===le[13]&&j[14]===le[14]&&j[15]===le[15]}function Ie(j,le){var z=j[0],de=j[1],Zt=j[2],nt=j[3],St=j[4],In=j[5],Wn=j[6],qn=j[7],hn=j[8],pt=j[9],Wt=j[10],An=j[11],Pn=j[12],Xn=j[13],dt=j[14],be=j[15],Ne=le[0],ot=le[1],Pt=le[2],It=le[3],xn=le[4],Qn=le[5],br=le[6],Jn=le[7],Ae=le[8],xe=le[9],ke=le[10],tt=le[11],Et=le[12],tn=le[13],fn=le[14],_t=le[15];return Math.abs(z-Ne)<=ee.Ib*Math.max(1,Math.abs(z),Math.abs(Ne))&&Math.abs(de-ot)<=ee.Ib*Math.max(1,Math.abs(de),Math.abs(ot))&&Math.abs(Zt-Pt)<=ee.Ib*Math.max(1,Math.abs(Zt),Math.abs(Pt))&&Math.abs(nt-It)<=ee.Ib*Math.max(1,Math.abs(nt),Math.abs(It))&&Math.abs(St-xn)<=ee.Ib*Math.max(1,Math.abs(St),Math.abs(xn))&&Math.abs(In-Qn)<=ee.Ib*Math.max(1,Math.abs(In),Math.abs(Qn))&&Math.abs(Wn-br)<=ee.Ib*Math.max(1,Math.abs(Wn),Math.abs(br))&&Math.abs(qn-Jn)<=ee.Ib*Math.max(1,Math.abs(qn),Math.abs(Jn))&&Math.abs(hn-Ae)<=ee.Ib*Math.max(1,Math.abs(hn),Math.abs(Ae))&&Math.abs(pt-xe)<=ee.Ib*Math.max(1,Math.abs(pt),Math.abs(xe))&&Math.abs(Wt-ke)<=ee.Ib*Math.max(1,Math.abs(Wt),Math.abs(ke))&&Math.abs(An-tt)<=ee.Ib*Math.max(1,Math.abs(An),Math.abs(tt))&&Math.abs(Pn-Et)<=ee.Ib*Math.max(1,Math.abs(Pn),Math.abs(Et))&&Math.abs(Xn-tn)<=ee.Ib*Math.max(1,Math.abs(Xn),Math.abs(tn))&&Math.abs(dt-fn)<=ee.Ib*Math.max(1,Math.abs(dt),Math.abs(fn))&&Math.abs(be-_t)<=ee.Ib*Math.max(1,Math.abs(be),Math.abs(_t))}var qe=ye,Bt=tr},31437:function($t,W,D){"use strict";D.d(W,{$X:function(){return Ee},AK:function(){return bt},Fv:function(){return Re},I6:function(){return Me},IH:function(){return ae},JG:function(){return re},Ue:function(){return X},al:function(){return ve},lu:function(){return Fn},t7:function(){return At},t8:function(){return fe},tk:function(){return gt}});var ee=D(49685);function X(){var an=new ee.WT(2);return ee.WT!=Float32Array&&(an[0]=0,an[1]=0),an}function E(an){var Ut=new glMatrix.ARRAY_TYPE(2);return Ut[0]=an[0],Ut[1]=an[1],Ut}function ve(an,Ut){var Dt=new ee.WT(2);return Dt[0]=an,Dt[1]=Ut,Dt}function re(an,Ut){return an[0]=Ut[0],an[1]=Ut[1],an}function fe(an,Ut,Dt){return an[0]=Ut,an[1]=Dt,an}function ae(an,Ut,Dt){return an[0]=Ut[0]+Dt[0],an[1]=Ut[1]+Dt[1],an}function Ee(an,Ut,Dt){return an[0]=Ut[0]-Dt[0],an[1]=Ut[1]-Dt[1],an}function oe(an,Ut,Dt){return an[0]=Ut[0]*Dt[0],an[1]=Ut[1]*Dt[1],an}function ze(an,Ut,Dt){return an[0]=Ut[0]/Dt[0],an[1]=Ut[1]/Dt[1],an}function te(an,Ut){return an[0]=Math.ceil(Ut[0]),an[1]=Math.ceil(Ut[1]),an}function ye(an,Ut){return an[0]=Math.floor(Ut[0]),an[1]=Math.floor(Ut[1]),an}function De(an,Ut,Dt){return an[0]=Math.min(Ut[0],Dt[0]),an[1]=Math.min(Ut[1],Dt[1]),an}function Se(an,Ut,Dt){return an[0]=Math.max(Ut[0],Dt[0]),an[1]=Math.max(Ut[1],Dt[1]),an}function we(an,Ut){return an[0]=Math.round(Ut[0]),an[1]=Math.round(Ut[1]),an}function ce(an,Ut,Dt){return an[0]=Ut[0]*Dt,an[1]=Ut[1]*Dt,an}function Ze(an,Ut,Dt,Ie){return an[0]=Ut[0]+Dt[0]*Ie,an[1]=Ut[1]+Dt[1]*Ie,an}function xt(an,Ut){var Dt=Ut[0]-an[0],Ie=Ut[1]-an[1];return Math.hypot(Dt,Ie)}function ht(an,Ut){var Dt=Ut[0]-an[0],Ie=Ut[1]-an[1];return Dt*Dt+Ie*Ie}function Gt(an){var Ut=an[0],Dt=an[1];return Math.hypot(Ut,Dt)}function mt(an){var Ut=an[0],Dt=an[1];return Ut*Ut+Dt*Dt}function gt(an,Ut){return an[0]=-Ut[0],an[1]=-Ut[1],an}function Be(an,Ut){return an[0]=1/Ut[0],an[1]=1/Ut[1],an}function Re(an,Ut){var Dt=Ut[0],Ie=Ut[1],qe=Dt*Dt+Ie*Ie;return qe>0&&(qe=1/Math.sqrt(qe)),an[0]=Ut[0]*qe,an[1]=Ut[1]*qe,an}function bt(an,Ut){return an[0]*Ut[0]+an[1]*Ut[1]}function yt(an,Ut,Dt){var Ie=Ut[0]*Dt[1]-Ut[1]*Dt[0];return an[0]=an[1]=0,an[2]=Ie,an}function At(an,Ut,Dt,Ie){var qe=Ut[0],Bt=Ut[1];return an[0]=qe+Ie*(Dt[0]-qe),an[1]=Bt+Ie*(Dt[1]-Bt),an}function bn(an,Ut){Ut=Ut||1;var Dt=glMatrix.RANDOM()*2*Math.PI;return an[0]=Math.cos(Dt)*Ut,an[1]=Math.sin(Dt)*Ut,an}function He(an,Ut,Dt){var Ie=Ut[0],qe=Ut[1];return an[0]=Dt[0]*Ie+Dt[2]*qe,an[1]=Dt[1]*Ie+Dt[3]*qe,an}function Rt(an,Ut,Dt){var Ie=Ut[0],qe=Ut[1];return an[0]=Dt[0]*Ie+Dt[2]*qe+Dt[4],an[1]=Dt[1]*Ie+Dt[3]*qe+Dt[5],an}function Oe(an,Ut,Dt){var Ie=Ut[0],qe=Ut[1];return an[0]=Dt[0]*Ie+Dt[3]*qe+Dt[6],an[1]=Dt[1]*Ie+Dt[4]*qe+Dt[7],an}function it(an,Ut,Dt){var Ie=Ut[0],qe=Ut[1];return an[0]=Dt[0]*Ie+Dt[4]*qe+Dt[12],an[1]=Dt[1]*Ie+Dt[5]*qe+Dt[13],an}function Qe(an,Ut,Dt,Ie){var qe=Ut[0]-Dt[0],Bt=Ut[1]-Dt[1],j=Math.sin(Ie),le=Math.cos(Ie);return an[0]=qe*le-Bt*j+Dt[0],an[1]=qe*j+Bt*le+Dt[1],an}function $e(an,Ut){var Dt=an[0],Ie=an[1],qe=Ut[0],Bt=Ut[1],j=Math.sqrt(Dt*Dt+Ie*Ie)*Math.sqrt(qe*qe+Bt*Bt),le=j&&(Dt*qe+Ie*Bt)/j;return Math.acos(Math.min(Math.max(le,-1),1))}function Ot(an){return an[0]=0,an[1]=0,an}function vt(an){return"vec2("+an[0]+", "+an[1]+")"}function Me(an,Ut){return an[0]===Ut[0]&&an[1]===Ut[1]}function Xt(an,Ut){var Dt=an[0],Ie=an[1],qe=Ut[0],Bt=Ut[1];return Math.abs(Dt-qe)<=glMatrix.EPSILON*Math.max(1,Math.abs(Dt),Math.abs(qe))&&Math.abs(Ie-Bt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ie),Math.abs(Bt))}var on=null,Fn=Ee,$n=null,nr=null,Ht=null,Jt=null,_n=null,tr=function(){var an=X();return function(Ut,Dt,Ie,qe,Bt,j){var le,z;for(Dt||(Dt=2),Ie||(Ie=0),qe?z=Math.min(qe*Dt+Ie,Ut.length):z=Ut.length,le=Ie;le<z;le+=Dt)an[0]=Ut[le],an[1]=Ut[le+1],Bt(an,an,j),Ut[le]=an[0],Ut[le+1]=an[1];return Ut}}()},77160:function($t,W,D){"use strict";D.d(W,{$X:function(){return oe},AK:function(){return bt},EU:function(){return Me},Fv:function(){return Re},IH:function(){return Ee},JG:function(){return fe},Jp:function(){return ze},TK:function(){return _n},Ue:function(){return X},VC:function(){return Qe},Zh:function(){return an},al:function(){return re},bA:function(){return Ze},d9:function(){return E},fF:function(){return Oe},fS:function(){return $n},kC:function(){return yt},kE:function(){return ve},kK:function(){return it},lu:function(){return nr},t7:function(){return At},t8:function(){return ae},tk:function(){return gt}});var ee=D(49685);function X(){var Ie=new ee.WT(3);return ee.WT!=Float32Array&&(Ie[0]=0,Ie[1]=0,Ie[2]=0),Ie}function E(Ie){var qe=new ee.WT(3);return qe[0]=Ie[0],qe[1]=Ie[1],qe[2]=Ie[2],qe}function ve(Ie){var qe=Ie[0],Bt=Ie[1],j=Ie[2];return Math.hypot(qe,Bt,j)}function re(Ie,qe,Bt){var j=new ee.WT(3);return j[0]=Ie,j[1]=qe,j[2]=Bt,j}function fe(Ie,qe){return Ie[0]=qe[0],Ie[1]=qe[1],Ie[2]=qe[2],Ie}function ae(Ie,qe,Bt,j){return Ie[0]=qe,Ie[1]=Bt,Ie[2]=j,Ie}function Ee(Ie,qe,Bt){return Ie[0]=qe[0]+Bt[0],Ie[1]=qe[1]+Bt[1],Ie[2]=qe[2]+Bt[2],Ie}function oe(Ie,qe,Bt){return Ie[0]=qe[0]-Bt[0],Ie[1]=qe[1]-Bt[1],Ie[2]=qe[2]-Bt[2],Ie}function ze(Ie,qe,Bt){return Ie[0]=qe[0]*Bt[0],Ie[1]=qe[1]*Bt[1],Ie[2]=qe[2]*Bt[2],Ie}function te(Ie,qe,Bt){return Ie[0]=qe[0]/Bt[0],Ie[1]=qe[1]/Bt[1],Ie[2]=qe[2]/Bt[2],Ie}function ye(Ie,qe){return Ie[0]=Math.ceil(qe[0]),Ie[1]=Math.ceil(qe[1]),Ie[2]=Math.ceil(qe[2]),Ie}function De(Ie,qe){return Ie[0]=Math.floor(qe[0]),Ie[1]=Math.floor(qe[1]),Ie[2]=Math.floor(qe[2]),Ie}function Se(Ie,qe,Bt){return Ie[0]=Math.min(qe[0],Bt[0]),Ie[1]=Math.min(qe[1],Bt[1]),Ie[2]=Math.min(qe[2],Bt[2]),Ie}function we(Ie,qe,Bt){return Ie[0]=Math.max(qe[0],Bt[0]),Ie[1]=Math.max(qe[1],Bt[1]),Ie[2]=Math.max(qe[2],Bt[2]),Ie}function ce(Ie,qe){return Ie[0]=Math.round(qe[0]),Ie[1]=Math.round(qe[1]),Ie[2]=Math.round(qe[2]),Ie}function Ze(Ie,qe,Bt){return Ie[0]=qe[0]*Bt,Ie[1]=qe[1]*Bt,Ie[2]=qe[2]*Bt,Ie}function xt(Ie,qe,Bt,j){return Ie[0]=qe[0]+Bt[0]*j,Ie[1]=qe[1]+Bt[1]*j,Ie[2]=qe[2]+Bt[2]*j,Ie}function ht(Ie,qe){var Bt=qe[0]-Ie[0],j=qe[1]-Ie[1],le=qe[2]-Ie[2];return Math.hypot(Bt,j,le)}function Gt(Ie,qe){var Bt=qe[0]-Ie[0],j=qe[1]-Ie[1],le=qe[2]-Ie[2];return Bt*Bt+j*j+le*le}function mt(Ie){var qe=Ie[0],Bt=Ie[1],j=Ie[2];return qe*qe+Bt*Bt+j*j}function gt(Ie,qe){return Ie[0]=-qe[0],Ie[1]=-qe[1],Ie[2]=-qe[2],Ie}function Be(Ie,qe){return Ie[0]=1/qe[0],Ie[1]=1/qe[1],Ie[2]=1/qe[2],Ie}function Re(Ie,qe){var Bt=qe[0],j=qe[1],le=qe[2],z=Bt*Bt+j*j+le*le;return z>0&&(z=1/Math.sqrt(z)),Ie[0]=qe[0]*z,Ie[1]=qe[1]*z,Ie[2]=qe[2]*z,Ie}function bt(Ie,qe){return Ie[0]*qe[0]+Ie[1]*qe[1]+Ie[2]*qe[2]}function yt(Ie,qe,Bt){var j=qe[0],le=qe[1],z=qe[2],de=Bt[0],Zt=Bt[1],nt=Bt[2];return Ie[0]=le*nt-z*Zt,Ie[1]=z*de-j*nt,Ie[2]=j*Zt-le*de,Ie}function At(Ie,qe,Bt,j){var le=qe[0],z=qe[1],de=qe[2];return Ie[0]=le+j*(Bt[0]-le),Ie[1]=z+j*(Bt[1]-z),Ie[2]=de+j*(Bt[2]-de),Ie}function bn(Ie,qe,Bt,j,le,z){var de=z*z,Zt=de*(2*z-3)+1,nt=de*(z-2)+z,St=de*(z-1),In=de*(3-2*z);return Ie[0]=qe[0]*Zt+Bt[0]*nt+j[0]*St+le[0]*In,Ie[1]=qe[1]*Zt+Bt[1]*nt+j[1]*St+le[1]*In,Ie[2]=qe[2]*Zt+Bt[2]*nt+j[2]*St+le[2]*In,Ie}function He(Ie,qe,Bt,j,le,z){var de=1-z,Zt=de*de,nt=z*z,St=Zt*de,In=3*z*Zt,Wn=3*nt*de,qn=nt*z;return Ie[0]=qe[0]*St+Bt[0]*In+j[0]*Wn+le[0]*qn,Ie[1]=qe[1]*St+Bt[1]*In+j[1]*Wn+le[1]*qn,Ie[2]=qe[2]*St+Bt[2]*In+j[2]*Wn+le[2]*qn,Ie}function Rt(Ie,qe){qe=qe||1;var Bt=glMatrix.RANDOM()*2*Math.PI,j=glMatrix.RANDOM()*2-1,le=Math.sqrt(1-j*j)*qe;return Ie[0]=Math.cos(Bt)*le,Ie[1]=Math.sin(Bt)*le,Ie[2]=j*qe,Ie}function Oe(Ie,qe,Bt){var j=qe[0],le=qe[1],z=qe[2],de=Bt[3]*j+Bt[7]*le+Bt[11]*z+Bt[15];return de=de||1,Ie[0]=(Bt[0]*j+Bt[4]*le+Bt[8]*z+Bt[12])/de,Ie[1]=(Bt[1]*j+Bt[5]*le+Bt[9]*z+Bt[13])/de,Ie[2]=(Bt[2]*j+Bt[6]*le+Bt[10]*z+Bt[14])/de,Ie}function it(Ie,qe,Bt){var j=qe[0],le=qe[1],z=qe[2];return Ie[0]=j*Bt[0]+le*Bt[3]+z*Bt[6],Ie[1]=j*Bt[1]+le*Bt[4]+z*Bt[7],Ie[2]=j*Bt[2]+le*Bt[5]+z*Bt[8],Ie}function Qe(Ie,qe,Bt){var j=Bt[0],le=Bt[1],z=Bt[2],de=Bt[3],Zt=qe[0],nt=qe[1],St=qe[2],In=le*St-z*nt,Wn=z*Zt-j*St,qn=j*nt-le*Zt,hn=le*qn-z*Wn,pt=z*In-j*qn,Wt=j*Wn-le*In,An=de*2;return In*=An,Wn*=An,qn*=An,hn*=2,pt*=2,Wt*=2,Ie[0]=Zt+In+hn,Ie[1]=nt+Wn+pt,Ie[2]=St+qn+Wt,Ie}function $e(Ie,qe,Bt,j){var le=[],z=[];return le[0]=qe[0]-Bt[0],le[1]=qe[1]-Bt[1],le[2]=qe[2]-Bt[2],z[0]=le[0],z[1]=le[1]*Math.cos(j)-le[2]*Math.sin(j),z[2]=le[1]*Math.sin(j)+le[2]*Math.cos(j),Ie[0]=z[0]+Bt[0],Ie[1]=z[1]+Bt[1],Ie[2]=z[2]+Bt[2],Ie}function Ot(Ie,qe,Bt,j){var le=[],z=[];return le[0]=qe[0]-Bt[0],le[1]=qe[1]-Bt[1],le[2]=qe[2]-Bt[2],z[0]=le[2]*Math.sin(j)+le[0]*Math.cos(j),z[1]=le[1],z[2]=le[2]*Math.cos(j)-le[0]*Math.sin(j),Ie[0]=z[0]+Bt[0],Ie[1]=z[1]+Bt[1],Ie[2]=z[2]+Bt[2],Ie}function vt(Ie,qe,Bt,j){var le=[],z=[];return le[0]=qe[0]-Bt[0],le[1]=qe[1]-Bt[1],le[2]=qe[2]-Bt[2],z[0]=le[0]*Math.cos(j)-le[1]*Math.sin(j),z[1]=le[0]*Math.sin(j)+le[1]*Math.cos(j),z[2]=le[2],Ie[0]=z[0]+Bt[0],Ie[1]=z[1]+Bt[1],Ie[2]=z[2]+Bt[2],Ie}function Me(Ie,qe){var Bt=Ie[0],j=Ie[1],le=Ie[2],z=qe[0],de=qe[1],Zt=qe[2],nt=Math.sqrt(Bt*Bt+j*j+le*le),St=Math.sqrt(z*z+de*de+Zt*Zt),In=nt*St,Wn=In&&bt(Ie,qe)/In;return Math.acos(Math.min(Math.max(Wn,-1),1))}function Xt(Ie){return Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie}function on(Ie){return"vec3("+Ie[0]+", "+Ie[1]+", "+Ie[2]+")"}function Fn(Ie,qe){return Ie[0]===qe[0]&&Ie[1]===qe[1]&&Ie[2]===qe[2]}function $n(Ie,qe){var Bt=Ie[0],j=Ie[1],le=Ie[2],z=qe[0],de=qe[1],Zt=qe[2];return Math.abs(Bt-z)<=ee.Ib*Math.max(1,Math.abs(Bt),Math.abs(z))&&Math.abs(j-de)<=ee.Ib*Math.max(1,Math.abs(j),Math.abs(de))&&Math.abs(le-Zt)<=ee.Ib*Math.max(1,Math.abs(le),Math.abs(Zt))}var nr=oe,Ht=null,Jt=null,_n=ht,tr=null,an=ve,Ut=null,Dt=function(){var Ie=X();return function(qe,Bt,j,le,z,de){var Zt,nt;for(Bt||(Bt=3),j||(j=0),le?nt=Math.min(le*Bt+j,qe.length):nt=qe.length,Zt=j;Zt<nt;Zt+=Bt)Ie[0]=qe[Zt],Ie[1]=qe[Zt+1],Ie[2]=qe[Zt+2],z(Ie,Ie,de),qe[Zt]=Ie[0],qe[Zt+1]=Ie[1],qe[Zt+2]=Ie[2];return qe}}()},98333:function($t,W,D){"use strict";D.d(W,{AK:function(){return bt},Fv:function(){return Re},I6:function(){return Qe},IH:function(){return ae},JG:function(){return re},Ue:function(){return X},al:function(){return ve},bA:function(){return ce},d9:function(){return E},fF:function(){return He},fS:function(){return $e},kE:function(){return Gt},t7:function(){return At},t8:function(){return fe},we:function(){return mt}});var ee=D(49685);function X(){var Ht=new ee.WT(4);return ee.WT!=Float32Array&&(Ht[0]=0,Ht[1]=0,Ht[2]=0,Ht[3]=0),Ht}function E(Ht){var Jt=new ee.WT(4);return Jt[0]=Ht[0],Jt[1]=Ht[1],Jt[2]=Ht[2],Jt[3]=Ht[3],Jt}function ve(Ht,Jt,_n,tr){var an=new ee.WT(4);return an[0]=Ht,an[1]=Jt,an[2]=_n,an[3]=tr,an}function re(Ht,Jt){return Ht[0]=Jt[0],Ht[1]=Jt[1],Ht[2]=Jt[2],Ht[3]=Jt[3],Ht}function fe(Ht,Jt,_n,tr,an){return Ht[0]=Jt,Ht[1]=_n,Ht[2]=tr,Ht[3]=an,Ht}function ae(Ht,Jt,_n){return Ht[0]=Jt[0]+_n[0],Ht[1]=Jt[1]+_n[1],Ht[2]=Jt[2]+_n[2],Ht[3]=Jt[3]+_n[3],Ht}function Ee(Ht,Jt,_n){return Ht[0]=Jt[0]-_n[0],Ht[1]=Jt[1]-_n[1],Ht[2]=Jt[2]-_n[2],Ht[3]=Jt[3]-_n[3],Ht}function oe(Ht,Jt,_n){return Ht[0]=Jt[0]*_n[0],Ht[1]=Jt[1]*_n[1],Ht[2]=Jt[2]*_n[2],Ht[3]=Jt[3]*_n[3],Ht}function ze(Ht,Jt,_n){return Ht[0]=Jt[0]/_n[0],Ht[1]=Jt[1]/_n[1],Ht[2]=Jt[2]/_n[2],Ht[3]=Jt[3]/_n[3],Ht}function te(Ht,Jt){return Ht[0]=Math.ceil(Jt[0]),Ht[1]=Math.ceil(Jt[1]),Ht[2]=Math.ceil(Jt[2]),Ht[3]=Math.ceil(Jt[3]),Ht}function ye(Ht,Jt){return Ht[0]=Math.floor(Jt[0]),Ht[1]=Math.floor(Jt[1]),Ht[2]=Math.floor(Jt[2]),Ht[3]=Math.floor(Jt[3]),Ht}function De(Ht,Jt,_n){return Ht[0]=Math.min(Jt[0],_n[0]),Ht[1]=Math.min(Jt[1],_n[1]),Ht[2]=Math.min(Jt[2],_n[2]),Ht[3]=Math.min(Jt[3],_n[3]),Ht}function Se(Ht,Jt,_n){return Ht[0]=Math.max(Jt[0],_n[0]),Ht[1]=Math.max(Jt[1],_n[1]),Ht[2]=Math.max(Jt[2],_n[2]),Ht[3]=Math.max(Jt[3],_n[3]),Ht}function we(Ht,Jt){return Ht[0]=Math.round(Jt[0]),Ht[1]=Math.round(Jt[1]),Ht[2]=Math.round(Jt[2]),Ht[3]=Math.round(Jt[3]),Ht}function ce(Ht,Jt,_n){return Ht[0]=Jt[0]*_n,Ht[1]=Jt[1]*_n,Ht[2]=Jt[2]*_n,Ht[3]=Jt[3]*_n,Ht}function Ze(Ht,Jt,_n,tr){return Ht[0]=Jt[0]+_n[0]*tr,Ht[1]=Jt[1]+_n[1]*tr,Ht[2]=Jt[2]+_n[2]*tr,Ht[3]=Jt[3]+_n[3]*tr,Ht}function xt(Ht,Jt){var _n=Jt[0]-Ht[0],tr=Jt[1]-Ht[1],an=Jt[2]-Ht[2],Ut=Jt[3]-Ht[3];return Math.hypot(_n,tr,an,Ut)}function ht(Ht,Jt){var _n=Jt[0]-Ht[0],tr=Jt[1]-Ht[1],an=Jt[2]-Ht[2],Ut=Jt[3]-Ht[3];return _n*_n+tr*tr+an*an+Ut*Ut}function Gt(Ht){var Jt=Ht[0],_n=Ht[1],tr=Ht[2],an=Ht[3];return Math.hypot(Jt,_n,tr,an)}function mt(Ht){var Jt=Ht[0],_n=Ht[1],tr=Ht[2],an=Ht[3];return Jt*Jt+_n*_n+tr*tr+an*an}function gt(Ht,Jt){return Ht[0]=-Jt[0],Ht[1]=-Jt[1],Ht[2]=-Jt[2],Ht[3]=-Jt[3],Ht}function Be(Ht,Jt){return Ht[0]=1/Jt[0],Ht[1]=1/Jt[1],Ht[2]=1/Jt[2],Ht[3]=1/Jt[3],Ht}function Re(Ht,Jt){var _n=Jt[0],tr=Jt[1],an=Jt[2],Ut=Jt[3],Dt=_n*_n+tr*tr+an*an+Ut*Ut;return Dt>0&&(Dt=1/Math.sqrt(Dt)),Ht[0]=_n*Dt,Ht[1]=tr*Dt,Ht[2]=an*Dt,Ht[3]=Ut*Dt,Ht}function bt(Ht,Jt){return Ht[0]*Jt[0]+Ht[1]*Jt[1]+Ht[2]*Jt[2]+Ht[3]*Jt[3]}function yt(Ht,Jt,_n,tr){var an=_n[0]*tr[1]-_n[1]*tr[0],Ut=_n[0]*tr[2]-_n[2]*tr[0],Dt=_n[0]*tr[3]-_n[3]*tr[0],Ie=_n[1]*tr[2]-_n[2]*tr[1],qe=_n[1]*tr[3]-_n[3]*tr[1],Bt=_n[2]*tr[3]-_n[3]*tr[2],j=Jt[0],le=Jt[1],z=Jt[2],de=Jt[3];return Ht[0]=le*Bt-z*qe+de*Ie,Ht[1]=-(j*Bt)+z*Dt-de*Ut,Ht[2]=j*qe-le*Dt+de*an,Ht[3]=-(j*Ie)+le*Ut-z*an,Ht}function At(Ht,Jt,_n,tr){var an=Jt[0],Ut=Jt[1],Dt=Jt[2],Ie=Jt[3];return Ht[0]=an+tr*(_n[0]-an),Ht[1]=Ut+tr*(_n[1]-Ut),Ht[2]=Dt+tr*(_n[2]-Dt),Ht[3]=Ie+tr*(_n[3]-Ie),Ht}function bn(Ht,Jt){Jt=Jt||1;var _n,tr,an,Ut,Dt,Ie;do _n=glMatrix.RANDOM()*2-1,tr=glMatrix.RANDOM()*2-1,Dt=_n*_n+tr*tr;while(Dt>=1);do an=glMatrix.RANDOM()*2-1,Ut=glMatrix.RANDOM()*2-1,Ie=an*an+Ut*Ut;while(Ie>=1);var qe=Math.sqrt((1-Dt)/Ie);return Ht[0]=Jt*_n,Ht[1]=Jt*tr,Ht[2]=Jt*an*qe,Ht[3]=Jt*Ut*qe,Ht}function He(Ht,Jt,_n){var tr=Jt[0],an=Jt[1],Ut=Jt[2],Dt=Jt[3];return Ht[0]=_n[0]*tr+_n[4]*an+_n[8]*Ut+_n[12]*Dt,Ht[1]=_n[1]*tr+_n[5]*an+_n[9]*Ut+_n[13]*Dt,Ht[2]=_n[2]*tr+_n[6]*an+_n[10]*Ut+_n[14]*Dt,Ht[3]=_n[3]*tr+_n[7]*an+_n[11]*Ut+_n[15]*Dt,Ht}function Rt(Ht,Jt,_n){var tr=Jt[0],an=Jt[1],Ut=Jt[2],Dt=_n[0],Ie=_n[1],qe=_n[2],Bt=_n[3],j=Bt*tr+Ie*Ut-qe*an,le=Bt*an+qe*tr-Dt*Ut,z=Bt*Ut+Dt*an-Ie*tr,de=-Dt*tr-Ie*an-qe*Ut;return Ht[0]=j*Bt+de*-Dt+le*-qe-z*-Ie,Ht[1]=le*Bt+de*-Ie+z*-Dt-j*-qe,Ht[2]=z*Bt+de*-qe+j*-Ie-le*-Dt,Ht[3]=Jt[3],Ht}function Oe(Ht){return Ht[0]=0,Ht[1]=0,Ht[2]=0,Ht[3]=0,Ht}function it(Ht){return"vec4("+Ht[0]+", "+Ht[1]+", "+Ht[2]+", "+Ht[3]+")"}function Qe(Ht,Jt){return Ht[0]===Jt[0]&&Ht[1]===Jt[1]&&Ht[2]===Jt[2]&&Ht[3]===Jt[3]}function $e(Ht,Jt){var _n=Ht[0],tr=Ht[1],an=Ht[2],Ut=Ht[3],Dt=Jt[0],Ie=Jt[1],qe=Jt[2],Bt=Jt[3];return Math.abs(_n-Dt)<=ee.Ib*Math.max(1,Math.abs(_n),Math.abs(Dt))&&Math.abs(tr-Ie)<=ee.Ib*Math.max(1,Math.abs(tr),Math.abs(Ie))&&Math.abs(an-qe)<=ee.Ib*Math.max(1,Math.abs(an),Math.abs(qe))&&Math.abs(Ut-Bt)<=ee.Ib*Math.max(1,Math.abs(Ut),Math.abs(Bt))}var Ot=null,vt=null,Me=null,Xt=null,on=null,Fn=null,$n=null,nr=function(){var Ht=X();return function(Jt,_n,tr,an,Ut,Dt){var Ie,qe;for(_n||(_n=4),tr||(tr=0),an?qe=Math.min(an*_n+tr,Jt.length):qe=Jt.length,Ie=tr;Ie<qe;Ie+=_n)Ht[0]=Jt[Ie],Ht[1]=Jt[Ie+1],Ht[2]=Jt[Ie+2],Ht[3]=Jt[Ie+3],Ut(Ht,Ht,Dt),Jt[Ie]=Ht[0],Jt[Ie+1]=Ht[1],Jt[Ie+2]=Ht[2],Jt[Ie+3]=Ht[3];return Jt}}()},50840:function($t,W,D){var ee;(function(X,E,ve,re){"use strict";var fe=["","webkit","Moz","MS","ms","o"],ae=E.createElement("div"),Ee="function",oe=Math.round,ze=Math.abs,te=Date.now;function ye(Tt,Ft,Dn){return setTimeout(Gt(Tt,Dn),Ft)}function De(Tt,Ft,Dn){return Array.isArray(Tt)?(Se(Tt,Dn[Ft],Dn),!0):!1}function Se(Tt,Ft,Dn){var sr;if(Tt)if(Tt.forEach)Tt.forEach(Ft,Dn);else if(Tt.length!==re)for(sr=0;sr<Tt.length;)Ft.call(Dn,Tt[sr],sr,Tt),sr++;else for(sr in Tt)Tt.hasOwnProperty(sr)&&Ft.call(Dn,Tt[sr],sr,Tt)}function we(Tt,Ft,Dn){var sr="DEPRECATED METHOD: "+Ft+`
`+Dn+` AT 
`;return function(){var _i=new Error("get-stack-trace"),bi=_i&&_i.stack?_i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",so=X.console&&(X.console.warn||X.console.log);return so&&so.call(X.console,sr,bi),Tt.apply(this,arguments)}}var ce;typeof Object.assign!="function"?ce=function(Ft){if(Ft===re||Ft===null)throw new TypeError("Cannot convert undefined or null to object");for(var Dn=Object(Ft),sr=1;sr<arguments.length;sr++){var _i=arguments[sr];if(_i!==re&&_i!==null)for(var bi in _i)_i.hasOwnProperty(bi)&&(Dn[bi]=_i[bi])}return Dn}:ce=Object.assign;var Ze=we(function(Ft,Dn,sr){for(var _i=Object.keys(Dn),bi=0;bi<_i.length;)(!sr||sr&&Ft[_i[bi]]===re)&&(Ft[_i[bi]]=Dn[_i[bi]]),bi++;return Ft},"extend","Use `assign`."),xt=we(function(Ft,Dn){return Ze(Ft,Dn,!0)},"merge","Use `assign`.");function ht(Tt,Ft,Dn){var sr=Ft.prototype,_i;_i=Tt.prototype=Object.create(sr),_i.constructor=Tt,_i._super=sr,Dn&&ce(_i,Dn)}function Gt(Tt,Ft){return function(){return Tt.apply(Ft,arguments)}}function mt(Tt,Ft){return typeof Tt==Ee?Tt.apply(Ft&&Ft[0]||re,Ft):Tt}function gt(Tt,Ft){return Tt===re?Ft:Tt}function Be(Tt,Ft,Dn){Se(At(Ft),function(sr){Tt.addEventListener(sr,Dn,!1)})}function Re(Tt,Ft,Dn){Se(At(Ft),function(sr){Tt.removeEventListener(sr,Dn,!1)})}function bt(Tt,Ft){for(;Tt;){if(Tt==Ft)return!0;Tt=Tt.parentNode}return!1}function yt(Tt,Ft){return Tt.indexOf(Ft)>-1}function At(Tt){return Tt.trim().split(/\s+/g)}function bn(Tt,Ft,Dn){if(Tt.indexOf&&!Dn)return Tt.indexOf(Ft);for(var sr=0;sr<Tt.length;){if(Dn&&Tt[sr][Dn]==Ft||!Dn&&Tt[sr]===Ft)return sr;sr++}return-1}function He(Tt){return Array.prototype.slice.call(Tt,0)}function Rt(Tt,Ft,Dn){for(var sr=[],_i=[],bi=0;bi<Tt.length;){var so=Ft?Tt[bi][Ft]:Tt[bi];bn(_i,so)<0&&sr.push(Tt[bi]),_i[bi]=so,bi++}return Dn&&(Ft?sr=sr.sort(function(Bs,Os){return Bs[Ft]>Os[Ft]}):sr=sr.sort()),sr}function Oe(Tt,Ft){for(var Dn,sr,_i=Ft[0].toUpperCase()+Ft.slice(1),bi=0;bi<fe.length;){if(Dn=fe[bi],sr=Dn?Dn+_i:Ft,sr in Tt)return sr;bi++}return re}var it=1;function Qe(){return it++}function $e(Tt){var Ft=Tt.ownerDocument||Tt;return Ft.defaultView||Ft.parentWindow||X}var Ot=/mobile|tablet|ip(ad|hone|od)|android/i,vt="ontouchstart"in X,Me=Oe(X,"PointerEvent")!==re,Xt=vt&&Ot.test(navigator.userAgent),on="touch",Fn="pen",$n="mouse",nr="kinect",Ht=25,Jt=1,_n=2,tr=4,an=8,Ut=1,Dt=2,Ie=4,qe=8,Bt=16,j=Dt|Ie,le=qe|Bt,z=j|le,de=["x","y"],Zt=["clientX","clientY"];function nt(Tt,Ft){var Dn=this;this.manager=Tt,this.callback=Ft,this.element=Tt.element,this.target=Tt.options.inputTarget,this.domHandler=function(sr){mt(Tt.options.enable,[Tt])&&Dn.handler(sr)},this.init()}nt.prototype={handler:function(){},init:function(){this.evEl&&Be(this.element,this.evEl,this.domHandler),this.evTarget&&Be(this.target,this.evTarget,this.domHandler),this.evWin&&Be($e(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Re(this.element,this.evEl,this.domHandler),this.evTarget&&Re(this.target,this.evTarget,this.domHandler),this.evWin&&Re($e(this.element),this.evWin,this.domHandler)}};function St(Tt){var Ft,Dn=Tt.options.inputClass;return Dn?Ft=Dn:Me?Ft=xe:Xt?Ft=Gn:vt?Ft=Ur:Ft=xn,new Ft(Tt,In)}function In(Tt,Ft,Dn){var sr=Dn.pointers.length,_i=Dn.changedPointers.length,bi=Ft&Jt&&sr-_i===0,so=Ft&(tr|an)&&sr-_i===0;Dn.isFirst=!!bi,Dn.isFinal=!!so,bi&&(Tt.session={}),Dn.eventType=Ft,Wn(Tt,Dn),Tt.emit("hammer.input",Dn),Tt.recognize(Dn),Tt.session.prevInput=Dn}function Wn(Tt,Ft){var Dn=Tt.session,sr=Ft.pointers,_i=sr.length;Dn.firstInput||(Dn.firstInput=pt(Ft)),_i>1&&!Dn.firstMultiple?Dn.firstMultiple=pt(Ft):_i===1&&(Dn.firstMultiple=!1);var bi=Dn.firstInput,so=Dn.firstMultiple,Ha=so?so.center:bi.center,Bs=Ft.center=Wt(sr);Ft.timeStamp=te(),Ft.deltaTime=Ft.timeStamp-bi.timeStamp,Ft.angle=dt(Ha,Bs),Ft.distance=Xn(Ha,Bs),qn(Dn,Ft),Ft.offsetDirection=Pn(Ft.deltaX,Ft.deltaY);var Os=An(Ft.deltaTime,Ft.deltaX,Ft.deltaY);Ft.overallVelocityX=Os.x,Ft.overallVelocityY=Os.y,Ft.overallVelocity=ze(Os.x)>ze(Os.y)?Os.x:Os.y,Ft.scale=so?Ne(so.pointers,sr):1,Ft.rotation=so?be(so.pointers,sr):0,Ft.maxPointers=Dn.prevInput?Ft.pointers.length>Dn.prevInput.maxPointers?Ft.pointers.length:Dn.prevInput.maxPointers:Ft.pointers.length,hn(Dn,Ft);var il=Tt.element;bt(Ft.srcEvent.target,il)&&(il=Ft.srcEvent.target),Ft.target=il}function qn(Tt,Ft){var Dn=Ft.center,sr=Tt.offsetDelta||{},_i=Tt.prevDelta||{},bi=Tt.prevInput||{};(Ft.eventType===Jt||bi.eventType===tr)&&(_i=Tt.prevDelta={x:bi.deltaX||0,y:bi.deltaY||0},sr=Tt.offsetDelta={x:Dn.x,y:Dn.y}),Ft.deltaX=_i.x+(Dn.x-sr.x),Ft.deltaY=_i.y+(Dn.y-sr.y)}function hn(Tt,Ft){var Dn=Tt.lastInterval||Ft,sr=Ft.timeStamp-Dn.timeStamp,_i,bi,so,Ha;if(Ft.eventType!=an&&(sr>Ht||Dn.velocity===re)){var Bs=Ft.deltaX-Dn.deltaX,Os=Ft.deltaY-Dn.deltaY,il=An(sr,Bs,Os);bi=il.x,so=il.y,_i=ze(il.x)>ze(il.y)?il.x:il.y,Ha=Pn(Bs,Os),Tt.lastInterval=Ft}else _i=Dn.velocity,bi=Dn.velocityX,so=Dn.velocityY,Ha=Dn.direction;Ft.velocity=_i,Ft.velocityX=bi,Ft.velocityY=so,Ft.direction=Ha}function pt(Tt){for(var Ft=[],Dn=0;Dn<Tt.pointers.length;)Ft[Dn]={clientX:oe(Tt.pointers[Dn].clientX),clientY:oe(Tt.pointers[Dn].clientY)},Dn++;return{timeStamp:te(),pointers:Ft,center:Wt(Ft),deltaX:Tt.deltaX,deltaY:Tt.deltaY}}function Wt(Tt){var Ft=Tt.length;if(Ft===1)return{x:oe(Tt[0].clientX),y:oe(Tt[0].clientY)};for(var Dn=0,sr=0,_i=0;_i<Ft;)Dn+=Tt[_i].clientX,sr+=Tt[_i].clientY,_i++;return{x:oe(Dn/Ft),y:oe(sr/Ft)}}function An(Tt,Ft,Dn){return{x:Ft/Tt||0,y:Dn/Tt||0}}function Pn(Tt,Ft){return Tt===Ft?Ut:ze(Tt)>=ze(Ft)?Tt<0?Dt:Ie:Ft<0?qe:Bt}function Xn(Tt,Ft,Dn){Dn||(Dn=de);var sr=Ft[Dn[0]]-Tt[Dn[0]],_i=Ft[Dn[1]]-Tt[Dn[1]];return Math.sqrt(sr*sr+_i*_i)}function dt(Tt,Ft,Dn){Dn||(Dn=de);var sr=Ft[Dn[0]]-Tt[Dn[0]],_i=Ft[Dn[1]]-Tt[Dn[1]];return Math.atan2(_i,sr)*180/Math.PI}function be(Tt,Ft){return dt(Ft[1],Ft[0],Zt)+dt(Tt[1],Tt[0],Zt)}function Ne(Tt,Ft){return Xn(Ft[0],Ft[1],Zt)/Xn(Tt[0],Tt[1],Zt)}var ot={mousedown:Jt,mousemove:_n,mouseup:tr},Pt="mousedown",It="mousemove mouseup";function xn(){this.evEl=Pt,this.evWin=It,this.pressed=!1,nt.apply(this,arguments)}ht(xn,nt,{handler:function(Ft){var Dn=ot[Ft.type];Dn&Jt&&Ft.button===0&&(this.pressed=!0),Dn&_n&&Ft.which!==1&&(Dn=tr),this.pressed&&(Dn&tr&&(this.pressed=!1),this.callback(this.manager,Dn,{pointers:[Ft],changedPointers:[Ft],pointerType:$n,srcEvent:Ft}))}});var Qn={pointerdown:Jt,pointermove:_n,pointerup:tr,pointercancel:an,pointerout:an},br={2:on,3:Fn,4:$n,5:nr},Jn="pointerdown",Ae="pointermove pointerup pointercancel";X.MSPointerEvent&&!X.PointerEvent&&(Jn="MSPointerDown",Ae="MSPointerMove MSPointerUp MSPointerCancel");function xe(){this.evEl=Jn,this.evWin=Ae,nt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ht(xe,nt,{handler:function(Ft){var Dn=this.store,sr=!1,_i=Ft.type.toLowerCase().replace("ms",""),bi=Qn[_i],so=br[Ft.pointerType]||Ft.pointerType,Ha=so==on,Bs=bn(Dn,Ft.pointerId,"pointerId");bi&Jt&&(Ft.button===0||Ha)?Bs<0&&(Dn.push(Ft),Bs=Dn.length-1):bi&(tr|an)&&(sr=!0),!(Bs<0)&&(Dn[Bs]=Ft,this.callback(this.manager,bi,{pointers:Dn,changedPointers:[Ft],pointerType:so,srcEvent:Ft}),sr&&Dn.splice(Bs,1))}});var ke={touchstart:Jt,touchmove:_n,touchend:tr,touchcancel:an},tt="touchstart",Et="touchstart touchmove touchend touchcancel";function tn(){this.evTarget=tt,this.evWin=Et,this.started=!1,nt.apply(this,arguments)}ht(tn,nt,{handler:function(Ft){var Dn=ke[Ft.type];if(Dn===Jt&&(this.started=!0),!!this.started){var sr=fn.call(this,Ft,Dn);Dn&(tr|an)&&sr[0].length-sr[1].length===0&&(this.started=!1),this.callback(this.manager,Dn,{pointers:sr[0],changedPointers:sr[1],pointerType:on,srcEvent:Ft})}}});function fn(Tt,Ft){var Dn=He(Tt.touches),sr=He(Tt.changedTouches);return Ft&(tr|an)&&(Dn=Rt(Dn.concat(sr),"identifier",!0)),[Dn,sr]}var _t={touchstart:Jt,touchmove:_n,touchend:tr,touchcancel:an},en="touchstart touchmove touchend touchcancel";function Gn(){this.evTarget=en,this.targetIds={},nt.apply(this,arguments)}ht(Gn,nt,{handler:function(Ft){var Dn=_t[Ft.type],sr=Tr.call(this,Ft,Dn);sr&&this.callback(this.manager,Dn,{pointers:sr[0],changedPointers:sr[1],pointerType:on,srcEvent:Ft})}});function Tr(Tt,Ft){var Dn=He(Tt.touches),sr=this.targetIds;if(Ft&(Jt|_n)&&Dn.length===1)return sr[Dn[0].identifier]=!0,[Dn,Dn];var _i,bi,so=He(Tt.changedTouches),Ha=[],Bs=this.target;if(bi=Dn.filter(function(Os){return bt(Os.target,Bs)}),Ft===Jt)for(_i=0;_i<bi.length;)sr[bi[_i].identifier]=!0,_i++;for(_i=0;_i<so.length;)sr[so[_i].identifier]&&Ha.push(so[_i]),Ft&(tr|an)&&delete sr[so[_i].identifier],_i++;if(Ha.length)return[Rt(bi.concat(Ha),"identifier",!0),Ha]}var jr=2500,vr=25;function Ur(){nt.apply(this,arguments);var Tt=Gt(this.handler,this);this.touch=new Gn(this.manager,Tt),this.mouse=new xn(this.manager,Tt),this.primaryTouch=null,this.lastTouches=[]}ht(Ur,nt,{handler:function(Ft,Dn,sr){var _i=sr.pointerType==on,bi=sr.pointerType==$n;if(!(bi&&sr.sourceCapabilities&&sr.sourceCapabilities.firesTouchEvents)){if(_i)Fr.call(this,Dn,sr);else if(bi&&wr.call(this,sr))return;this.callback(Ft,Dn,sr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Fr(Tt,Ft){Tt&Jt?(this.primaryTouch=Ft.changedPointers[0].identifier,qr.call(this,Ft)):Tt&(tr|an)&&qr.call(this,Ft)}function qr(Tt){var Ft=Tt.changedPointers[0];if(Ft.identifier===this.primaryTouch){var Dn={x:Ft.clientX,y:Ft.clientY};this.lastTouches.push(Dn);var sr=this.lastTouches,_i=function(){var bi=sr.indexOf(Dn);bi>-1&&sr.splice(bi,1)};setTimeout(_i,jr)}}function wr(Tt){for(var Ft=Tt.srcEvent.clientX,Dn=Tt.srcEvent.clientY,sr=0;sr<this.lastTouches.length;sr++){var _i=this.lastTouches[sr],bi=Math.abs(Ft-_i.x),so=Math.abs(Dn-_i.y);if(bi<=vr&&so<=vr)return!0}return!1}var fi=Oe(ae.style,"touchAction"),di=fi!==re,vi="compute",vo="auto",Oi="manipulation",Ko="none",va="pan-x",Co="pan-y",Xo=Ct();function Ye(Tt,Ft){this.manager=Tt,this.set(Ft)}Ye.prototype={set:function(Tt){Tt==vi&&(Tt=this.compute()),di&&this.manager.element.style&&Xo[Tt]&&(this.manager.element.style[fi]=Tt),this.actions=Tt.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Tt=[];return Se(this.manager.recognizers,function(Ft){mt(Ft.options.enable,[Ft])&&(Tt=Tt.concat(Ft.getTouchAction()))}),Ke(Tt.join(" "))},preventDefaults:function(Tt){var Ft=Tt.srcEvent,Dn=Tt.offsetDirection;if(this.manager.session.prevented){Ft.preventDefault();return}var sr=this.actions,_i=yt(sr,Ko)&&!Xo[Ko],bi=yt(sr,Co)&&!Xo[Co],so=yt(sr,va)&&!Xo[va];if(_i){var Ha=Tt.pointers.length===1,Bs=Tt.distance<2,Os=Tt.deltaTime<250;if(Ha&&Bs&&Os)return}if(!(so&&bi)&&(_i||bi&&Dn&j||so&&Dn&le))return this.preventSrc(Ft)},preventSrc:function(Tt){this.manager.session.prevented=!0,Tt.preventDefault()}};function Ke(Tt){if(yt(Tt,Ko))return Ko;var Ft=yt(Tt,va),Dn=yt(Tt,Co);return Ft&&Dn?Ko:Ft||Dn?Ft?va:Co:yt(Tt,Oi)?Oi:vo}function Ct(){if(!di)return!1;var Tt={},Ft=X.CSS&&X.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Dn){Tt[Dn]=Ft?X.CSS.supports("touch-action",Dn):!0}),Tt}var sn=1,Ln=2,zn=4,mn=8,wn=mn,gr=16,mr=32;function ai(Tt){this.options=ce({},this.defaults,Tt||{}),this.id=Qe(),this.manager=null,this.options.enable=gt(this.options.enable,!0),this.state=sn,this.simultaneous={},this.requireFail=[]}ai.prototype={defaults:{},set:function(Tt){return ce(this.options,Tt),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Tt){if(De(Tt,"recognizeWith",this))return this;var Ft=this.simultaneous;return Tt=ei(Tt,this),Ft[Tt.id]||(Ft[Tt.id]=Tt,Tt.recognizeWith(this)),this},dropRecognizeWith:function(Tt){return De(Tt,"dropRecognizeWith",this)?this:(Tt=ei(Tt,this),delete this.simultaneous[Tt.id],this)},requireFailure:function(Tt){if(De(Tt,"requireFailure",this))return this;var Ft=this.requireFail;return Tt=ei(Tt,this),bn(Ft,Tt)===-1&&(Ft.push(Tt),Tt.requireFailure(this)),this},dropRequireFailure:function(Tt){if(De(Tt,"dropRequireFailure",this))return this;Tt=ei(Tt,this);var Ft=bn(this.requireFail,Tt);return Ft>-1&&this.requireFail.splice(Ft,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Tt){return!!this.simultaneous[Tt.id]},emit:function(Tt){var Ft=this,Dn=this.state;function sr(_i){Ft.manager.emit(_i,Tt)}Dn<mn&&sr(Ft.options.event+Vi(Dn)),sr(Ft.options.event),Tt.additionalEvent&&sr(Tt.additionalEvent),Dn>=mn&&sr(Ft.options.event+Vi(Dn))},tryEmit:function(Tt){if(this.canEmit())return this.emit(Tt);this.state=mr},canEmit:function(){for(var Tt=0;Tt<this.requireFail.length;){if(!(this.requireFail[Tt].state&(mr|sn)))return!1;Tt++}return!0},recognize:function(Tt){var Ft=ce({},Tt);if(!mt(this.options.enable,[this,Ft])){this.reset(),this.state=mr;return}this.state&(wn|gr|mr)&&(this.state=sn),this.state=this.process(Ft),this.state&(Ln|zn|mn|gr)&&this.tryEmit(Ft)},process:function(Tt){},getTouchAction:function(){},reset:function(){}};function Vi(Tt){return Tt&gr?"cancel":Tt&mn?"end":Tt&zn?"move":Tt&Ln?"start":""}function fo(Tt){return Tt==Bt?"down":Tt==qe?"up":Tt==Dt?"left":Tt==Ie?"right":""}function ei(Tt,Ft){var Dn=Ft.manager;return Dn?Dn.get(Tt):Tt}function zi(){ai.apply(this,arguments)}ht(zi,ai,{defaults:{pointers:1},attrTest:function(Tt){var Ft=this.options.pointers;return Ft===0||Tt.pointers.length===Ft},process:function(Tt){var Ft=this.state,Dn=Tt.eventType,sr=Ft&(Ln|zn),_i=this.attrTest(Tt);return sr&&(Dn&an||!_i)?Ft|gr:sr||_i?Dn&tr?Ft|mn:Ft&Ln?Ft|zn:Ln:mr}});function Li(){zi.apply(this,arguments),this.pX=null,this.pY=null}ht(Li,zi,{defaults:{event:"pan",threshold:10,pointers:1,direction:z},getTouchAction:function(){var Tt=this.options.direction,Ft=[];return Tt&j&&Ft.push(Co),Tt&le&&Ft.push(va),Ft},directionTest:function(Tt){var Ft=this.options,Dn=!0,sr=Tt.distance,_i=Tt.direction,bi=Tt.deltaX,so=Tt.deltaY;return _i&Ft.direction||(Ft.direction&j?(_i=bi===0?Ut:bi<0?Dt:Ie,Dn=bi!=this.pX,sr=Math.abs(Tt.deltaX)):(_i=so===0?Ut:so<0?qe:Bt,Dn=so!=this.pY,sr=Math.abs(Tt.deltaY))),Tt.direction=_i,Dn&&sr>Ft.threshold&&_i&Ft.direction},attrTest:function(Tt){return zi.prototype.attrTest.call(this,Tt)&&(this.state&Ln||!(this.state&Ln)&&this.directionTest(Tt))},emit:function(Tt){this.pX=Tt.deltaX,this.pY=Tt.deltaY;var Ft=fo(Tt.direction);Ft&&(Tt.additionalEvent=this.options.event+Ft),this._super.emit.call(this,Tt)}});function Zr(){zi.apply(this,arguments)}ht(Zr,zi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ko]},attrTest:function(Tt){return this._super.attrTest.call(this,Tt)&&(Math.abs(Tt.scale-1)>this.options.threshold||this.state&Ln)},emit:function(Tt){if(Tt.scale!==1){var Ft=Tt.scale<1?"in":"out";Tt.additionalEvent=this.options.event+Ft}this._super.emit.call(this,Tt)}});function go(){ai.apply(this,arguments),this._timer=null,this._input=null}ht(go,ai,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[vo]},process:function(Tt){var Ft=this.options,Dn=Tt.pointers.length===Ft.pointers,sr=Tt.distance<Ft.threshold,_i=Tt.deltaTime>Ft.time;if(this._input=Tt,!sr||!Dn||Tt.eventType&(tr|an)&&!_i)this.reset();else if(Tt.eventType&Jt)this.reset(),this._timer=ye(function(){this.state=wn,this.tryEmit()},Ft.time,this);else if(Tt.eventType&tr)return wn;return mr},reset:function(){clearTimeout(this._timer)},emit:function(Tt){this.state===wn&&(Tt&&Tt.eventType&tr?this.manager.emit(this.options.event+"up",Tt):(this._input.timeStamp=te(),this.manager.emit(this.options.event,this._input)))}});function Mi(){zi.apply(this,arguments)}ht(Mi,zi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ko]},attrTest:function(Tt){return this._super.attrTest.call(this,Tt)&&(Math.abs(Tt.rotation)>this.options.threshold||this.state&Ln)}});function bo(){zi.apply(this,arguments)}ht(bo,zi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:j|le,pointers:1},getTouchAction:function(){return Li.prototype.getTouchAction.call(this)},attrTest:function(Tt){var Ft=this.options.direction,Dn;return Ft&(j|le)?Dn=Tt.overallVelocity:Ft&j?Dn=Tt.overallVelocityX:Ft&le&&(Dn=Tt.overallVelocityY),this._super.attrTest.call(this,Tt)&&Ft&Tt.offsetDirection&&Tt.distance>this.options.threshold&&Tt.maxPointers==this.options.pointers&&ze(Dn)>this.options.velocity&&Tt.eventType&tr},emit:function(Tt){var Ft=fo(Tt.offsetDirection);Ft&&this.manager.emit(this.options.event+Ft,Tt),this.manager.emit(this.options.event,Tt)}});function Si(){ai.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ht(Si,ai,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Oi]},process:function(Tt){var Ft=this.options,Dn=Tt.pointers.length===Ft.pointers,sr=Tt.distance<Ft.threshold,_i=Tt.deltaTime<Ft.time;if(this.reset(),Tt.eventType&Jt&&this.count===0)return this.failTimeout();if(sr&&_i&&Dn){if(Tt.eventType!=tr)return this.failTimeout();var bi=this.pTime?Tt.timeStamp-this.pTime<Ft.interval:!0,so=!this.pCenter||Xn(this.pCenter,Tt.center)<Ft.posThreshold;this.pTime=Tt.timeStamp,this.pCenter=Tt.center,!so||!bi?this.count=1:this.count+=1,this._input=Tt;var Ha=this.count%Ft.taps;if(Ha===0)return this.hasRequireFailures()?(this._timer=ye(function(){this.state=wn,this.tryEmit()},Ft.interval,this),Ln):wn}return mr},failTimeout:function(){return this._timer=ye(function(){this.state=mr},this.options.interval,this),mr},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==wn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function wo(Tt,Ft){return Ft=Ft||{},Ft.recognizers=gt(Ft.recognizers,wo.defaults.preset),new na(Tt,Ft)}wo.VERSION="2.0.7",wo.defaults={domEvents:!1,touchAction:vi,enable:!0,inputTarget:null,inputClass:null,preset:[[Mi,{enable:!1}],[Zr,{enable:!1},["rotate"]],[bo,{direction:j}],[Li,{direction:j},["swipe"]],[Si],[Si,{event:"doubletap",taps:2},["tap"]],[go]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Yo=1,Wa=2;function na(Tt,Ft){this.options=ce({},wo.defaults,Ft||{}),this.options.inputTarget=this.options.inputTarget||Tt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Tt,this.input=St(this),this.touchAction=new Ye(this,this.options.touchAction),jo(this,!0),Se(this.options.recognizers,function(Dn){var sr=this.add(new Dn[0](Dn[1]));Dn[2]&&sr.recognizeWith(Dn[2]),Dn[3]&&sr.requireFailure(Dn[3])},this)}na.prototype={set:function(Tt){return ce(this.options,Tt),Tt.touchAction&&this.touchAction.update(),Tt.inputTarget&&(this.input.destroy(),this.input.target=Tt.inputTarget,this.input.init()),this},stop:function(Tt){this.session.stopped=Tt?Wa:Yo},recognize:function(Tt){var Ft=this.session;if(!Ft.stopped){this.touchAction.preventDefaults(Tt);var Dn,sr=this.recognizers,_i=Ft.curRecognizer;(!_i||_i&&_i.state&wn)&&(_i=Ft.curRecognizer=null);for(var bi=0;bi<sr.length;)Dn=sr[bi],Ft.stopped!==Wa&&(!_i||Dn==_i||Dn.canRecognizeWith(_i))?Dn.recognize(Tt):Dn.reset(),!_i&&Dn.state&(Ln|zn|mn)&&(_i=Ft.curRecognizer=Dn),bi++}},get:function(Tt){if(Tt instanceof ai)return Tt;for(var Ft=this.recognizers,Dn=0;Dn<Ft.length;Dn++)if(Ft[Dn].options.event==Tt)return Ft[Dn];return null},add:function(Tt){if(De(Tt,"add",this))return this;var Ft=this.get(Tt.options.event);return Ft&&this.remove(Ft),this.recognizers.push(Tt),Tt.manager=this,this.touchAction.update(),Tt},remove:function(Tt){if(De(Tt,"remove",this))return this;if(Tt=this.get(Tt),Tt){var Ft=this.recognizers,Dn=bn(Ft,Tt);Dn!==-1&&(Ft.splice(Dn,1),this.touchAction.update())}return this},on:function(Tt,Ft){if(Tt!==re&&Ft!==re){var Dn=this.handlers;return Se(At(Tt),function(sr){Dn[sr]=Dn[sr]||[],Dn[sr].push(Ft)}),this}},off:function(Tt,Ft){if(Tt!==re){var Dn=this.handlers;return Se(At(Tt),function(sr){Ft?Dn[sr]&&Dn[sr].splice(bn(Dn[sr],Ft),1):delete Dn[sr]}),this}},emit:function(Tt,Ft){this.options.domEvents&&Va(Tt,Ft);var Dn=this.handlers[Tt]&&this.handlers[Tt].slice();if(!(!Dn||!Dn.length)){Ft.type=Tt,Ft.preventDefault=function(){Ft.srcEvent.preventDefault()};for(var sr=0;sr<Dn.length;)Dn[sr](Ft),sr++}},destroy:function(){this.element&&jo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function jo(Tt,Ft){var Dn=Tt.element;if(Dn.style){var sr;Se(Tt.options.cssProps,function(_i,bi){sr=Oe(Dn.style,bi),Ft?(Tt.oldCssProps[sr]=Dn.style[sr],Dn.style[sr]=_i):Dn.style[sr]=Tt.oldCssProps[sr]||""}),Ft||(Tt.oldCssProps={})}}function Va(Tt,Ft){var Dn=E.createEvent("Event");Dn.initEvent(Tt,!0,!0),Dn.gesture=Ft,Ft.target.dispatchEvent(Dn)}ce(wo,{INPUT_START:Jt,INPUT_MOVE:_n,INPUT_END:tr,INPUT_CANCEL:an,STATE_POSSIBLE:sn,STATE_BEGAN:Ln,STATE_CHANGED:zn,STATE_ENDED:mn,STATE_RECOGNIZED:wn,STATE_CANCELLED:gr,STATE_FAILED:mr,DIRECTION_NONE:Ut,DIRECTION_LEFT:Dt,DIRECTION_RIGHT:Ie,DIRECTION_UP:qe,DIRECTION_DOWN:Bt,DIRECTION_HORIZONTAL:j,DIRECTION_VERTICAL:le,DIRECTION_ALL:z,Manager:na,Input:nt,TouchAction:Ye,TouchInput:Gn,MouseInput:xn,PointerEventInput:xe,TouchMouseInput:Ur,SingleTouchInput:tn,Recognizer:ai,AttrRecognizer:zi,Tap:Si,Pan:Li,Swipe:bo,Pinch:Zr,Rotate:Mi,Press:go,on:Be,off:Re,each:Se,merge:xt,extend:Ze,assign:ce,inherit:ht,bindFn:Gt,prefixed:Oe});var fs=typeof X!="undefined"?X:typeof self!="undefined"?self:{};fs.Hammer=wo,ee=function(){return wo}.call(W,D,W,$t),ee!==re&&($t.exports=ee)})(window,document,"Hammer")},47443:function($t,W,D){var ee=D(42118);function X(E,ve){var re=E==null?0:E.length;return!!re&&ee(E,ve,0)>-1}$t.exports=X},1196:function($t){function W(D,ee,X){for(var E=-1,ve=D==null?0:D.length;++E<ve;)if(X(ee,D[E]))return!0;return!1}$t.exports=W},29750:function($t){function W(D,ee,X){return D===D&&(X!==void 0&&(D=D<=X?D:X),ee!==void 0&&(D=D>=ee?D:ee)),D}$t.exports=W},41848:function($t){function W(D,ee,X,E){for(var ve=D.length,re=X+(E?1:-1);E?re--:++re<ve;)if(ee(D[re],re,D))return re;return-1}$t.exports=W},42118:function($t,W,D){var ee=D(41848),X=D(62722),E=D(39375);function ve(re,fe,ae){return fe===fe?E(re,fe,ae):ee(re,X,ae)}$t.exports=ve},74221:function($t){function W(D,ee,X,E){for(var ve=X-1,re=D.length;++ve<re;)if(E(D[ve],ee))return ve;return-1}$t.exports=W},62722:function($t){function W(D){return D!==D}$t.exports=W},65464:function($t,W,D){var ee=D(29932),X=D(42118),E=D(74221),ve=D(51717),re=D(6450),fe=Array.prototype,ae=fe.splice;function Ee(oe,ze,te,ye){var De=ye?E:X,Se=-1,we=ze.length,ce=oe;for(oe===ze&&(ze=re(ze)),te&&(ce=ee(oe,ve(te)));++Se<we;)for(var Ze=0,xt=ze[Se],ht=te?te(xt):xt;(Ze=De(ce,ht,Ze,ye))>-1;)ce!==oe&&ae.call(ce,Ze,1),ae.call(oe,Ze,1);return oe}$t.exports=Ee},45652:function($t,W,D){var ee=D(88668),X=D(47443),E=D(1196),ve=D(74757),re=D(23593),fe=D(21814),ae=200;function Ee(oe,ze,te){var ye=-1,De=X,Se=oe.length,we=!0,ce=[],Ze=ce;if(te)we=!1,De=E;else if(Se>=ae){var xt=ze?null:re(oe);if(xt)return fe(xt);we=!1,De=ve,Ze=new ee}else Ze=ze?[]:ce;e:for(;++ye<Se;){var ht=oe[ye],Gt=ze?ze(ht):ht;if(ht=te||ht!==0?ht:0,we&&Gt===Gt){for(var mt=Ze.length;mt--;)if(Ze[mt]===Gt)continue e;ze&&Ze.push(Gt),ce.push(ht)}else De(Ze,Gt,te)||(Ze!==ce&&Ze.push(Gt),ce.push(ht))}return ce}$t.exports=Ee},23593:function($t,W,D){var ee=D(58525),X=D(28117),E=D(21814),ve=1/0,re=ee&&1/E(new ee([,-0]))[1]==ve?function(fe){return new ee(fe)}:X;$t.exports=re},39375:function($t){function W(D,ee,X){for(var E=X-1,ve=D.length;++E<ve;)if(D[E]===ee)return E;return-1}$t.exports=W},74691:function($t,W,D){var ee=D(29750),X=D(14841);function E(ve,re,fe){return fe===void 0&&(fe=re,re=void 0),fe!==void 0&&(fe=X(fe),fe=fe===fe?fe:0),re!==void 0&&(re=X(re),re=re===re?re:0),ee(X(ve),re,fe)}$t.exports=E},51584:function($t,W,D){var ee=D(44239),X=D(37005),E="[object Boolean]";function ve(re){return re===!0||re===!1||X(re)&&ee(re)==E}$t.exports=ve},18446:function($t,W,D){var ee=D(90939);function X(E,ve){return ee(E,ve)}$t.exports=X},14293:function($t){function W(D){return D==null}$t.exports=W},81763:function($t,W,D){var ee=D(44239),X=D(37005),E="[object Number]";function ve(re){return typeof re=="number"||X(re)&&ee(re)==E}$t.exports=ve},52353:function($t){function W(D){return D===void 0}$t.exports=W},30236:function($t,W,D){var ee=D(42980),X=D(21463),E=X(function(ve,re,fe,ae){ee(ve,re,fe,ae)});$t.exports=E},28117:function($t){function W(){}$t.exports=W},97019:function($t,W,D){var ee=D(5976),X=D(45604),E=ee(X);$t.exports=E},45604:function($t,W,D){var ee=D(65464);function X(E,ve){return E&&E.length&&ve&&ve.length?ee(E,ve):E}$t.exports=X},44908:function($t,W,D){var ee=D(45652);function X(E){return E&&E.length?ee(E):[]}$t.exports=X},73955:function($t,W,D){var ee=D(79833),X=0;function E(ve){var re=++X;return ee(ve)+re}$t.exports=E},6158:function($t){(function(W,D){$t.exports=D()})(this,function(){"use strict";var W,D,ee;function X(E,ve){if(!W)W=ve;else if(!D)D=ve;else{var re="var sharedChunk = {}; ("+W+")(sharedChunk); ("+D+")(sharedChunk);",fe={};W(fe),ee=ve(fe),typeof window!="undefined"&&(ee.workerUrl=window.URL.createObjectURL(new Blob([re],{type:"text/javascript"})))}}return X(["exports"],function(E){"use strict";function ve(c,d){return c(d={exports:{}},d.exports),d.exports}var re=fe;function fe(c,d,g,A){this.cx=3*c,this.bx=3*(g-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(A-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=A,this.p2x=g,this.p2y=A}fe.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c},fe.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c},fe.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},fe.prototype.solveCurveX=function(c,d){var g,A,P,B,V;for(d===void 0&&(d=1e-6),P=c,V=0;V<8;V++){if(B=this.sampleCurveX(P)-c,Math.abs(B)<d)return P;var Q=this.sampleCurveDerivativeX(P);if(Math.abs(Q)<1e-6)break;P-=B/Q}if((P=c)<(g=0))return g;if(P>(A=1))return A;for(;g<A;){if(B=this.sampleCurveX(P),Math.abs(B-c)<d)return P;c>B?g=P:A=P,P=.5*(A-g)+g}return P},fe.prototype.solve=function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))};var ae=Ee;function Ee(c,d){this.x=c,this.y=d}Ee.prototype={clone:function(){return new Ee(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,d){return this.clone()._rotateAround(c,d)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var d=c.x-this.x,g=c.y-this.y;return d*d+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)},_matMult:function(c){var d=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=d,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var d=Math.cos(c),g=Math.sin(c),A=g*this.x+d*this.y;return this.x=d*this.x-g*this.y,this.y=A,this},_rotateAround:function(c,d){var g=Math.cos(c),A=Math.sin(c),P=d.y+A*(this.x-d.x)+g*(this.y-d.y);return this.x=d.x+g*(this.x-d.x)-A*(this.y-d.y),this.y=P,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ee.convert=function(c){return c instanceof Ee?c:Array.isArray(c)?new Ee(c[0],c[1]):c};var oe=typeof self!="undefined"?self:{},ze=Math.pow(2,53)-1;function te(c,d,g,A){var P=new re(c,d,g,A);return function(B){return P.solve(B)}}var ye=te(.25,.1,.25,1);function De(c,d,g){return Math.min(g,Math.max(d,c))}function Se(c,d,g){var A=g-d,P=((c-d)%A+A)%A+d;return P===d?g:P}function we(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var A=0,P=d;A<P.length;A+=1){var B=P[A];for(var V in B)c[V]=B[V]}return c}var ce=1;function Ze(){return ce++}function xt(){return function c(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function ht(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Gt(c,d){c.forEach(function(g){d[g]&&(d[g]=d[g].bind(d))})}function mt(c,d){return c.indexOf(d,c.length-d.length)!==-1}function gt(c,d,g){var A={};for(var P in c)A[P]=d.call(g||this,c[P],P,c);return A}function Be(c,d,g){var A={};for(var P in c)d.call(g||this,c[P],P,c)&&(A[P]=c[P]);return A}function Re(c){return Array.isArray(c)?c.map(Re):typeof c=="object"&&c?gt(c,Re):c}var bt={};function yt(c){bt[c]||(typeof console!="undefined"&&console.warn(c),bt[c]=!0)}function At(c,d,g){return(g.y-c.y)*(d.x-c.x)>(d.y-c.y)*(g.x-c.x)}function bn(c){for(var d=0,g=0,A=c.length,P=A-1,B=void 0,V=void 0;g<A;P=g++)d+=((V=c[P]).x-(B=c[g]).x)*(B.y+V.y);return d}function He(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Rt(c){var d={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(A,P,B,V){var Q=B||V;return d[P]=!Q||Q.toLowerCase(),""}),d["max-age"]){var g=parseInt(d["max-age"],10);isNaN(g)?delete d["max-age"]:d["max-age"]=g}return d}var Oe=null;function it(c){if(Oe==null){var d=c.navigator?c.navigator.userAgent:null;Oe=!!c.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Oe}function Qe(c){try{var d=oe[c];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch(g){return!1}}var $e,Ot,vt,Me,Xt=oe.performance&&oe.performance.now?oe.performance.now.bind(oe.performance):Date.now.bind(Date),on=oe.requestAnimationFrame||oe.mozRequestAnimationFrame||oe.webkitRequestAnimationFrame||oe.msRequestAnimationFrame,Fn=oe.cancelAnimationFrame||oe.mozCancelAnimationFrame||oe.webkitCancelAnimationFrame||oe.msCancelAnimationFrame,$n={now:Xt,frame:function(c){var d=on(c);return{cancel:function(){return Fn(d)}}},getImageData:function(c,d){d===void 0&&(d=0);var g=oe.document.createElement("canvas"),A=g.getContext("2d");if(!A)throw new Error("failed to create canvas 2d context");return g.width=c.width,g.height=c.height,A.drawImage(c,0,0,c.width,c.height),A.getImageData(-d,-d,c.width+2*d,c.height+2*d)},resolveURL:function(c){return $e||($e=oe.document.createElement("a")),$e.href=c,$e.href},hardwareConcurrency:oe.navigator&&oe.navigator.hardwareConcurrency||4,get devicePixelRatio(){return oe.devicePixelRatio},get prefersReducedMotion(){return!!oe.matchMedia&&(Ot==null&&(Ot=oe.matchMedia("(prefers-reduced-motion: reduce)")),Ot.matches)}},nr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ht={supported:!1,testSupport:function(c){!Jt&&Me&&(_n?tr(c):vt=c)}},Jt=!1,_n=!1;function tr(c){var d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Me),c.isContextLost())return;Ht.supported=!0}catch(g){}c.deleteTexture(d),Jt=!0}oe.document&&((Me=oe.document.createElement("img")).onload=function(){vt&&tr(vt),vt=null,_n=!0},Me.onerror=function(){Jt=!0,vt=null},Me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var an="01",Ut=function(c,d){this._transformRequestFn=c,this._customAccessToken=d,this._createSkuToken()};function Dt(c){return c.indexOf("mapbox:")===0}Ut.prototype._createSkuToken=function(){var c=function(){for(var d="",g=0;g<10;g++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",an,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt},Ut.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ut.prototype.transformRequest=function(c,d){return this._transformRequestFn&&this._transformRequestFn(c,d)||{url:c}},Ut.prototype.normalizeStyleURL=function(c,d){if(!Dt(c))return c;var g=j(c);return g.path="/styles/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},Ut.prototype.normalizeGlyphsURL=function(c,d){if(!Dt(c))return c;var g=j(c);return g.path="/fonts/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},Ut.prototype.normalizeSourceURL=function(c,d){if(!Dt(c))return c;var g=j(c);return g.path="/v4/"+g.authority+".json",g.params.push("secure"),this._makeAPIURL(g,this._customAccessToken||d)},Ut.prototype.normalizeSpriteURL=function(c,d,g,A){var P=j(c);return Dt(c)?(P.path="/styles/v1"+P.path+"/sprite"+d+g,this._makeAPIURL(P,this._customAccessToken||A)):(P.path+=""+d+g,le(P))},Ut.prototype.normalizeTileURL=function(c,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Dt(c))return c;var g=j(c);g.path=g.path.replace(/(\.(png|jpg)\d*)(?=$)/,($n.devicePixelRatio>=2||d===512?"@2x":"")+(Ht.supported?".webp":"$1")),g.path=g.path.replace(/^.+\/v4\//,"/"),g.path="/v4"+g.path;var A=this._customAccessToken||function(P){for(var B=0,V=P;B<V.length;B+=1){var Q=V[B].match(/^access_token=(.*)$/);if(Q)return Q[1]}return null}(g.params)||nr.ACCESS_TOKEN;return nr.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&g.params.push("sku="+this._skuToken),this._makeAPIURL(g,A)},Ut.prototype.canonicalizeTileURL=function(c,d){var g=j(c);if(!g.path.match(/(^\/v4\/)/)||!g.path.match(/\.[\w]+$/))return c;var A="mapbox://tiles/";A+=g.path.replace("/v4/","");var P=g.params;return d&&(P=P.filter(function(B){return!B.match(/^access_token=/)})),P.length&&(A+="?"+P.join("&")),A},Ut.prototype.canonicalizeTileset=function(c,d){for(var g=!!d&&Dt(d),A=[],P=0,B=c.tiles||[];P<B.length;P+=1){var V=B[P];qe(V)?A.push(this.canonicalizeTileURL(V,g)):A.push(V)}return A},Ut.prototype._makeAPIURL=function(c,d){var g="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",A=j(nr.API_URL);if(c.protocol=A.protocol,c.authority=A.authority,c.protocol==="http"){var P=c.params.indexOf("secure");P>=0&&c.params.splice(P,1)}if(A.path!=="/"&&(c.path=""+A.path+c.path),!nr.REQUIRE_ACCESS_TOKEN)return le(c);if(!(d=d||nr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+g);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+g);return c.params=c.params.filter(function(B){return B.indexOf("access_token")===-1}),c.params.push("access_token="+d),le(c)};var Ie=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function qe(c){return Ie.test(c)}var Bt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function j(c){var d=c.match(Bt);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function le(c){var d=c.params.length?"?"+c.params.join("&"):"";return c.protocol+"://"+c.authority+c.path+d}function z(c){if(!c)return null;var d=c.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(oe.atob(d[1]).split("").map(function(g){return"%"+("00"+g.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(g){return null}}var de=function(c){this.type=c,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};de.prototype.getStorageKey=function(c){var d,g=z(nr.ACCESS_TOKEN);return d=g&&g.u?oe.btoa(encodeURIComponent(g.u).replace(/%([0-9A-F]{2})/g,function(A,P){return String.fromCharCode(+("0x"+P))})):nr.ACCESS_TOKEN||"",c?"mapbox.eventData."+c+":"+d:"mapbox.eventData:"+d},de.prototype.fetchEventData=function(){var c=Qe("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{var A=oe.localStorage.getItem(d);A&&(this.eventData=JSON.parse(A));var P=oe.localStorage.getItem(g);P&&(this.anonId=P)}catch(B){yt("Unable to read from LocalStorage")}},de.prototype.saveEventData=function(){var c=Qe("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{oe.localStorage.setItem(g,this.anonId),Object.keys(this.eventData).length>=1&&oe.localStorage.setItem(d,JSON.stringify(this.eventData))}catch(A){yt("Unable to write to LocalStorage")}},de.prototype.processRequests=function(c){},de.prototype.postEvent=function(c,d,g,A){var P=this;if(nr.EVENTS_URL){var B=j(nr.EVENTS_URL);B.params.push("access_token="+(A||nr.ACCESS_TOKEN||""));var V={event:this.type,created:new Date(c).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:an,userId:this.anonId},Q=d?we(V,d):V,me={url:le(B),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Q])};this.pendingRequest=Jn(me,function(Le){P.pendingRequest=null,g(Le),P.saveEventData(),P.processRequests(A)})}},de.prototype.queueRequest=function(c,d){this.queue.push(c),this.processRequests(d)};var Zt,nt,St=function(c){function d(){c.call(this,"map.load"),this.success={},this.skuToken=""}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(g,A,P,B){this.skuToken=P;var V=!(!B&&!nr.ACCESS_TOKEN),Q=Array.isArray(g)&&g.some(function(me){return Dt(me)||qe(me)});nr.EVENTS_URL&&V&&Q&&this.queueRequest({id:A,timestamp:Date.now()},B)},d.prototype.processRequests=function(g){var A=this;if(!this.pendingRequest&&this.queue.length!==0){var P=this.queue.shift(),B=P.id,V=P.timestamp;B&&this.success[B]||(this.anonId||this.fetchEventData(),ht(this.anonId)||(this.anonId=xt()),this.postEvent(V,{skuToken:this.skuToken},function(Q){Q||B&&(A.success[B]=!0)},g))}},d}(de),In=new(function(c){function d(g){c.call(this,"appUserTurnstile"),this._customAccessToken=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(g,A){nr.EVENTS_URL&&nr.ACCESS_TOKEN&&Array.isArray(g)&&g.some(function(P){return Dt(P)||qe(P)})&&this.queueRequest(Date.now(),A)},d.prototype.processRequests=function(g){var A=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var P=z(nr.ACCESS_TOKEN),B=P?P.u:nr.ACCESS_TOKEN,V=B!==this.eventData.tokenU;ht(this.anonId)||(this.anonId=xt(),V=!0);var Q=this.queue.shift();if(this.eventData.lastSuccess){var me=new Date(this.eventData.lastSuccess),Le=new Date(Q),We=(Q-this.eventData.lastSuccess)/864e5;V=V||We>=1||We<-1||me.getDate()!==Le.getDate()}else V=!0;if(!V)return this.processRequests();this.postEvent(Q,{"enabled.telemetry":!1},function(rt){rt||(A.eventData.lastSuccess=Q,A.eventData.tokenU=B)},g)}},d}(de)),Wn=In.postTurnstileEvent.bind(In),qn=new St,hn=qn.postMapLoadEvent.bind(qn),pt=500,Wt=50;function An(){oe.caches&&!Zt&&(Zt=oe.caches.open("mapbox-tiles"))}function Pn(c){var d=c.indexOf("?");return d<0?c:c.slice(0,d)}var Xn,dt=1/0;function be(){return Xn==null&&(Xn=oe.OffscreenCanvas&&new oe.OffscreenCanvas(1,1).getContext("2d")&&typeof oe.createImageBitmap=="function"),Xn}var Ne={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ne);var ot=function(c){function d(g,A,P){A===401&&qe(P)&&(g+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),c.call(this,g),this.status=A,this.url=P,this.name=this.constructor.name,this.message=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),Pt=He()?function(){return self.worker&&self.worker.referrer}:function(){return(oe.location.protocol==="blob:"?oe.parent:oe).location.href},It,xn,Qn=function(c,d){if(!(/^file:/.test(g=c.url)||/^file:/.test(Pt())&&!/^\w+:/.test(g))){if(oe.fetch&&oe.Request&&oe.AbortController&&oe.Request.prototype.hasOwnProperty("signal"))return function(A,P){var B,V=new oe.AbortController,Q=new oe.Request(A.url,{method:A.method||"GET",body:A.body,credentials:A.credentials,headers:A.headers,referrer:Pt(),signal:V.signal}),me=!1,Le=!1,We=(B=Q.url).indexOf("sku=")>0&&qe(B);A.type==="json"&&Q.headers.set("Accept","application/json");var rt=function(Nt,cn,vn){if(!Le){if(Nt&&Nt.message!=="SecurityError"&&yt(Nt),cn&&vn)return ut(cn);var Zn=Date.now();oe.fetch(Q).then(function(Nn){if(Nn.ok){var fr=We?Nn.clone():null;return ut(Nn,fr,Zn)}return P(new ot(Nn.statusText,Nn.status,A.url))}).catch(function(Nn){Nn.code!==20&&P(new Error(Nn.message))})}},ut=function(Nt,cn,vn){(A.type==="arrayBuffer"?Nt.arrayBuffer():A.type==="json"?Nt.json():Nt.text()).then(function(Zn){Le||(cn&&vn&&function(Nn,fr,yr){if(An(),Zt){var Sr={status:fr.status,statusText:fr.statusText,headers:new oe.Headers};fr.headers.forEach(function(Xr,Pi){return Sr.headers.set(Pi,Xr)});var Ir=Rt(fr.headers.get("Cache-Control")||"");Ir["no-store"]||(Ir["max-age"]&&Sr.headers.set("Expires",new Date(yr+1e3*Ir["max-age"]).toUTCString()),new Date(Sr.headers.get("Expires")).getTime()-yr<42e4||function(Xr,Pi){if(nt===void 0)try{new Response(new ReadableStream),nt=!0}catch(Ci){nt=!1}nt?Pi(Xr.body):Xr.blob().then(Pi)}(fr,function(Xr){var Pi=new oe.Response(Xr,Sr);An(),Zt&&Zt.then(function(Ci){return Ci.put(Pn(Nn.url),Pi)}).catch(function(Ci){return yt(Ci.message)})}))}}(Q,cn,vn),me=!0,P(null,Zn,Nt.headers.get("Cache-Control"),Nt.headers.get("Expires")))}).catch(function(Zn){Le||P(new Error(Zn.message))})};return We?function(Nt,cn){if(An(),!Zt)return cn(null);var vn=Pn(Nt.url);Zt.then(function(Zn){Zn.match(vn).then(function(Nn){var fr=function(yr){if(!yr)return!1;var Sr=new Date(yr.headers.get("Expires")||0),Ir=Rt(yr.headers.get("Cache-Control")||"");return Sr>Date.now()&&!Ir["no-cache"]}(Nn);Zn.delete(vn),fr&&Zn.put(vn,Nn.clone()),cn(null,Nn,fr)}).catch(cn)}).catch(cn)}(Q,rt):rt(null,null),{cancel:function(){Le=!0,me||V.abort()}}}(c,d);if(He()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,d,void 0,!0)}var g;return function(A,P){var B=new oe.XMLHttpRequest;for(var V in B.open(A.method||"GET",A.url,!0),A.type==="arrayBuffer"&&(B.responseType="arraybuffer"),A.headers)B.setRequestHeader(V,A.headers[V]);return A.type==="json"&&(B.responseType="text",B.setRequestHeader("Accept","application/json")),B.withCredentials=A.credentials==="include",B.onerror=function(){P(new Error(B.statusText))},B.onload=function(){if((B.status>=200&&B.status<300||B.status===0)&&B.response!==null){var Q=B.response;if(A.type==="json")try{Q=JSON.parse(B.response)}catch(me){return P(me)}P(null,Q,B.getResponseHeader("Cache-Control"),B.getResponseHeader("Expires"))}else P(new ot(B.statusText,B.status,A.url))},B.send(A.body),{cancel:function(){return B.abort()}}}(c,d)},br=function(c,d){return Qn(we(c,{type:"arrayBuffer"}),d)},Jn=function(c,d){return Qn(we(c,{method:"POST"}),d)},Ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";It=[],xn=0;var xe=function(c,d){if(Ht.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),xn>=nr.MAX_PARALLEL_IMAGE_REQUESTS){var g={requestParameters:c,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return It.push(g),g}xn++;var A=!1,P=function(){if(!A)for(A=!0,xn--;It.length&&xn<nr.MAX_PARALLEL_IMAGE_REQUESTS;){var V=It.shift();V.cancelled||(V.cancel=xe(V.requestParameters,V.callback).cancel)}},B=br(c,function(V,Q,me,Le){P(),V?d(V):Q&&(be()?function(We,rt){var ut=new oe.Blob([new Uint8Array(We)],{type:"image/png"});oe.createImageBitmap(ut).then(function(Nt){rt(null,Nt)}).catch(function(Nt){rt(new Error("Could not load image because of "+Nt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(Q,d):function(We,rt,ut,Nt){var cn=new oe.Image,vn=oe.URL;cn.onload=function(){rt(null,cn),vn.revokeObjectURL(cn.src),cn.onload=null,oe.requestAnimationFrame(function(){cn.src=Ae})},cn.onerror=function(){return rt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Zn=new oe.Blob([new Uint8Array(We)],{type:"image/png"});cn.cacheControl=ut,cn.expires=Nt,cn.src=We.byteLength?vn.createObjectURL(Zn):Ae}(Q,d,me,Le))});return{cancel:function(){B.cancel(),P()}}};function ke(c,d,g){g[c]&&g[c].indexOf(d)!==-1||(g[c]=g[c]||[],g[c].push(d))}function tt(c,d,g){if(g&&g[c]){var A=g[c].indexOf(d);A!==-1&&g[c].splice(A,1)}}var Et=function(c,d){d===void 0&&(d={}),we(this,d),this.type=c},tn=function(c){function d(g,A){A===void 0&&(A={}),c.call(this,"error",we({error:g},A))}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Et),fn=function(){};fn.prototype.on=function(c,d){return this._listeners=this._listeners||{},ke(c,d,this._listeners),this},fn.prototype.off=function(c,d){return tt(c,d,this._listeners),tt(c,d,this._oneTimeListeners),this},fn.prototype.once=function(c,d){return this._oneTimeListeners=this._oneTimeListeners||{},ke(c,d,this._oneTimeListeners),this},fn.prototype.fire=function(c,d){typeof c=="string"&&(c=new Et(c,d||{}));var g=c.type;if(this.listens(g)){c.target=this;for(var A=0,P=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];A<P.length;A+=1)P[A].call(this,c);for(var B=0,V=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];B<V.length;B+=1){var Q=V[B];tt(g,Q,this._oneTimeListeners),Q.call(this,c)}var me=this._eventedParent;me&&(we(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),me.fire(c))}else c instanceof tn&&console.error(c.error);return this},fn.prototype.listens=function(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)},fn.prototype.setEventedParent=function(c,d){return this._eventedParent=c,this._eventedParentData=d,this};var _t={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},en=function(c,d,g,A){this.message=(c?c+": ":"")+g,A&&(this.identifier=A),d!=null&&d.__line__&&(this.line=d.__line__)};function Gn(c){var d=c.value;return d?[new en(c.key,d,"constants have been deprecated as of v8")]:[]}function Tr(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var A=0,P=d;A<P.length;A+=1){var B=P[A];for(var V in B)c[V]=B[V]}return c}function jr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function vr(c){if(Array.isArray(c))return c.map(vr);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){var d={};for(var g in c)d[g]=vr(c[g]);return d}return jr(c)}var Ur=function(c){function d(g,A){c.call(this,A),this.message=A,this.key=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Error),Fr=function(c,d){d===void 0&&(d=[]),this.parent=c,this.bindings={};for(var g=0,A=d;g<A.length;g+=1){var P=A[g];this.bindings[P[0]]=P[1]}};Fr.prototype.concat=function(c){return new Fr(this,c)},Fr.prototype.get=function(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(c+" not found in scope.")},Fr.prototype.has=function(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)};var qr={kind:"null"},wr={kind:"number"},fi={kind:"string"},di={kind:"boolean"},vi={kind:"color"},vo={kind:"object"},Oi={kind:"value"},Ko={kind:"collator"},va={kind:"formatted"},Co={kind:"resolvedImage"};function Xo(c,d){return{kind:"array",itemType:c,N:d}}function Ye(c){if(c.kind==="array"){var d=Ye(c.itemType);return typeof c.N=="number"?"array<"+d+", "+c.N+">":c.itemType.kind==="value"?"array":"array<"+d+">"}return c.kind}var Ke=[qr,wr,fi,di,vi,va,vo,Xo(Oi),Co];function Ct(c,d){if(d.kind==="error")return null;if(c.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!Ct(c.itemType,d.itemType))&&(typeof c.N!="number"||c.N===d.N))return null}else{if(c.kind===d.kind)return null;if(c.kind==="value"){for(var g=0,A=Ke;g<A.length;g+=1)if(!Ct(A[g],d))return null}}return"Expected "+Ye(c)+" but found "+Ye(d)+" instead."}function sn(c,d){return d.some(function(g){return g.kind===c.kind})}function Ln(c,d){return d.some(function(g){return g==="null"?c===null:g==="array"?Array.isArray(c):g==="object"?c&&!Array.isArray(c)&&typeof c=="object":g===typeof c})}var zn=ve(function(c,d){var g={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function A(Q){return(Q=Math.round(Q))<0?0:Q>255?255:Q}function P(Q){return A(Q[Q.length-1]==="%"?parseFloat(Q)/100*255:parseInt(Q))}function B(Q){return(me=Q[Q.length-1]==="%"?parseFloat(Q)/100:parseFloat(Q))<0?0:me>1?1:me;var me}function V(Q,me,Le){return Le<0?Le+=1:Le>1&&(Le-=1),6*Le<1?Q+(me-Q)*Le*6:2*Le<1?me:3*Le<2?Q+(me-Q)*(2/3-Le)*6:Q}try{d.parseCSSColor=function(Q){var me,Le=Q.replace(/ /g,"").toLowerCase();if(Le in g)return g[Le].slice();if(Le[0]==="#")return Le.length===4?(me=parseInt(Le.substr(1),16))>=0&&me<=4095?[(3840&me)>>4|(3840&me)>>8,240&me|(240&me)>>4,15&me|(15&me)<<4,1]:null:Le.length===7&&(me=parseInt(Le.substr(1),16))>=0&&me<=16777215?[(16711680&me)>>16,(65280&me)>>8,255&me,1]:null;var We=Le.indexOf("("),rt=Le.indexOf(")");if(We!==-1&&rt+1===Le.length){var ut=Le.substr(0,We),Nt=Le.substr(We+1,rt-(We+1)).split(","),cn=1;switch(ut){case"rgba":if(Nt.length!==4)return null;cn=B(Nt.pop());case"rgb":return Nt.length!==3?null:[P(Nt[0]),P(Nt[1]),P(Nt[2]),cn];case"hsla":if(Nt.length!==4)return null;cn=B(Nt.pop());case"hsl":if(Nt.length!==3)return null;var vn=(parseFloat(Nt[0])%360+360)%360/360,Zn=B(Nt[1]),Nn=B(Nt[2]),fr=Nn<=.5?Nn*(Zn+1):Nn+Zn-Nn*Zn,yr=2*Nn-fr;return[A(255*V(yr,fr,vn+1/3)),A(255*V(yr,fr,vn)),A(255*V(yr,fr,vn-1/3)),cn];default:return null}}return null}}catch(Q){}}).parseCSSColor,mn=function(c,d,g,A){A===void 0&&(A=1),this.r=c,this.g=d,this.b=g,this.a=A};mn.parse=function(c){if(c){if(c instanceof mn)return c;if(typeof c=="string"){var d=zn(c);if(d)return new mn(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},mn.prototype.toString=function(){var c=this.toArray(),d=c[1],g=c[2],A=c[3];return"rgba("+Math.round(c[0])+","+Math.round(d)+","+Math.round(g)+","+A+")"},mn.prototype.toArray=function(){var c=this.a;return c===0?[0,0,0,0]:[255*this.r/c,255*this.g/c,255*this.b/c,c]},mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);var wn=function(c,d,g){this.sensitivity=c?d?"variant":"case":d?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};wn.prototype.compare=function(c,d){return this.collator.compare(c,d)},wn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var gr=function(c,d,g,A,P){this.text=c,this.image=d,this.scale=g,this.fontStack=A,this.textColor=P},mr=function(c){this.sections=c};mr.fromString=function(c){return new mr([new gr(c,null,null,null,null)])},mr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(c){return c.text.length!==0||c.image&&c.image.name.length!==0})},mr.factory=function(c){return c instanceof mr?c:mr.fromString(c)},mr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(c){return c.text}).join("")},mr.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var A=g[d];if(A.image)c.push(["image",A.image.name]);else{c.push(A.text);var P={};A.fontStack&&(P["text-font"]=["literal",A.fontStack.split(",")]),A.scale&&(P["font-scale"]=A.scale),A.textColor&&(P["text-color"]=["rgba"].concat(A.textColor.toArray())),c.push(P)}}return c};var ai=function(c){this.name=c.name,this.available=c.available};function Vi(c,d,g,A){return typeof c=="number"&&c>=0&&c<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof g=="number"&&g>=0&&g<=255?A===void 0||typeof A=="number"&&A>=0&&A<=1?null:"Invalid rgba value ["+[c,d,g,A].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof A=="number"?[c,d,g,A]:[c,d,g]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function fo(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof mn||c instanceof wn||c instanceof mr||c instanceof ai)return!0;if(Array.isArray(c)){for(var d=0,g=c;d<g.length;d+=1)if(!fo(g[d]))return!1;return!0}if(typeof c=="object"){for(var A in c)if(!fo(c[A]))return!1;return!0}return!1}function ei(c){if(c===null)return qr;if(typeof c=="string")return fi;if(typeof c=="boolean")return di;if(typeof c=="number")return wr;if(c instanceof mn)return vi;if(c instanceof wn)return Ko;if(c instanceof mr)return va;if(c instanceof ai)return Co;if(Array.isArray(c)){for(var d,g=c.length,A=0,P=c;A<P.length;A+=1){var B=ei(P[A]);if(d){if(d===B)continue;d=Oi;break}d=B}return Xo(d||Oi,g)}return vo}function zi(c){var d=typeof c;return c===null?"":d==="string"||d==="number"||d==="boolean"?String(c):c instanceof mn||c instanceof mr||c instanceof ai?c.toString():JSON.stringify(c)}ai.prototype.toString=function(){return this.name},ai.fromString=function(c){return c?new ai({name:c,available:!1}):null},ai.prototype.serialize=function(){return["image",this.name]};var Li=function(c,d){this.type=c,this.value=d};Li.parse=function(c,d){if(c.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(!fo(c[1]))return d.error("invalid value");var g=c[1],A=ei(g),P=d.expectedType;return A.kind!=="array"||A.N!==0||!P||P.kind!=="array"||typeof P.N=="number"&&P.N!==0||(A=P),new Li(A,g)},Li.prototype.evaluate=function(){return this.value},Li.prototype.eachChild=function(){},Li.prototype.outputDefined=function(){return!0},Li.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof mn?["rgba"].concat(this.value.toArray()):this.value instanceof mr?this.value.serialize():this.value};var Zr=function(c){this.name="ExpressionEvaluationError",this.message=c};Zr.prototype.toJSON=function(){return this.message};var go={string:fi,number:wr,boolean:di,object:vo},Mi=function(c,d){this.type=c,this.args=d};Mi.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g,A=1,P=c[0];if(P==="array"){var B,V;if(c.length>2){var Q=c[1];if(typeof Q!="string"||!(Q in go)||Q==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);B=go[Q],A++}else B=Oi;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return d.error('The length argument to "array" must be a positive integer literal',2);V=c[2],A++}g=Xo(B,V)}else g=go[P];for(var me=[];A<c.length;A++){var Le=d.parse(c[A],A,Oi);if(!Le)return null;me.push(Le)}return new Mi(g,me)},Mi.prototype.evaluate=function(c){for(var d=0;d<this.args.length;d++){var g=this.args[d].evaluate(c);if(!Ct(this.type,ei(g)))return g;if(d===this.args.length-1)throw new Zr("Expected value to be of type "+Ye(this.type)+", but found "+Ye(ei(g))+" instead.")}return null},Mi.prototype.eachChild=function(c){this.args.forEach(c)},Mi.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Mi.prototype.serialize=function(){var c=this.type,d=[c.kind];if(c.kind==="array"){var g=c.itemType;if(g.kind==="string"||g.kind==="number"||g.kind==="boolean"){d.push(g.kind);var A=c.N;(typeof A=="number"||this.args.length>1)&&d.push(A)}}return d.concat(this.args.map(function(P){return P.serialize()}))};var bo=function(c){this.type=va,this.sections=c};bo.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[1];if(!Array.isArray(g)&&typeof g=="object")return d.error("First argument must be an image or text section.");for(var A=[],P=!1,B=1;B<=c.length-1;++B){var V=c[B];if(P&&typeof V=="object"&&!Array.isArray(V)){P=!1;var Q=null;if(V["font-scale"]&&!(Q=d.parse(V["font-scale"],1,wr)))return null;var me=null;if(V["text-font"]&&!(me=d.parse(V["text-font"],1,Xo(fi))))return null;var Le=null;if(V["text-color"]&&!(Le=d.parse(V["text-color"],1,vi)))return null;var We=A[A.length-1];We.scale=Q,We.font=me,We.textColor=Le}else{var rt=d.parse(c[B],1,Oi);if(!rt)return null;var ut=rt.type.kind;if(ut!=="string"&&ut!=="value"&&ut!=="null"&&ut!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");P=!0,A.push({content:rt,scale:null,font:null,textColor:null})}}return new bo(A)},bo.prototype.evaluate=function(c){return new mr(this.sections.map(function(d){var g=d.content.evaluate(c);return ei(g)===Co?new gr("",g,null,null,null):new gr(zi(g),null,d.scale?d.scale.evaluate(c):null,d.font?d.font.evaluate(c).join(","):null,d.textColor?d.textColor.evaluate(c):null)}))},bo.prototype.eachChild=function(c){for(var d=0,g=this.sections;d<g.length;d+=1){var A=g[d];c(A.content),A.scale&&c(A.scale),A.font&&c(A.font),A.textColor&&c(A.textColor)}},bo.prototype.outputDefined=function(){return!1},bo.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var A=g[d];c.push(A.content.serialize());var P={};A.scale&&(P["font-scale"]=A.scale.serialize()),A.font&&(P["text-font"]=A.font.serialize()),A.textColor&&(P["text-color"]=A.textColor.serialize()),c.push(P)}return c};var Si=function(c){this.type=Co,this.input=c};Si.parse=function(c,d){if(c.length!==2)return d.error("Expected two arguments.");var g=d.parse(c[1],1,fi);return g?new Si(g):d.error("No image name provided.")},Si.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=ai.fromString(d);return g&&c.availableImages&&(g.available=c.availableImages.indexOf(d)>-1),g},Si.prototype.eachChild=function(c){c(this.input)},Si.prototype.outputDefined=function(){return!1},Si.prototype.serialize=function(){return["image",this.input.serialize()]};var wo={"to-boolean":di,"to-color":vi,"to-number":wr,"to-string":fi},Yo=function(c,d){this.type=c,this.args=d};Yo.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[0];if((g==="to-boolean"||g==="to-string")&&c.length!==2)return d.error("Expected one argument.");for(var A=wo[g],P=[],B=1;B<c.length;B++){var V=d.parse(c[B],B,Oi);if(!V)return null;P.push(V)}return new Yo(A,P)},Yo.prototype.evaluate=function(c){if(this.type.kind==="boolean")return!!this.args[0].evaluate(c);if(this.type.kind==="color"){for(var d,g,A=0,P=this.args;A<P.length;A+=1){if(g=null,(d=P[A].evaluate(c))instanceof mn)return d;if(typeof d=="string"){var B=c.parseColor(d);if(B)return B}else if(Array.isArray(d)&&!(g=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":Vi(d[0],d[1],d[2],d[3])))return new mn(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Zr(g||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var V=null,Q=0,me=this.args;Q<me.length;Q+=1){if((V=me[Q].evaluate(c))===null)return 0;var Le=Number(V);if(!isNaN(Le))return Le}throw new Zr("Could not convert "+JSON.stringify(V)+" to number.")}return this.type.kind==="formatted"?mr.fromString(zi(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?ai.fromString(zi(this.args[0].evaluate(c))):zi(this.args[0].evaluate(c))},Yo.prototype.eachChild=function(c){this.args.forEach(c)},Yo.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Yo.prototype.serialize=function(){if(this.type.kind==="formatted")return new bo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Si(this.args[0]).serialize();var c=["to-"+this.type.kind];return this.eachChild(function(d){c.push(d.serialize())}),c};var Wa=["Unknown","Point","LineString","Polygon"],na=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};na.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},na.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Wa[this.feature.type]:this.feature.type:null},na.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},na.prototype.canonicalID=function(){return this.canonical},na.prototype.properties=function(){return this.feature&&this.feature.properties||{}},na.prototype.parseColor=function(c){var d=this._parseColorCache[c];return d||(d=this._parseColorCache[c]=mn.parse(c)),d};var jo=function(c,d,g,A){this.name=c,this.type=d,this._evaluate=g,this.args=A};jo.prototype.evaluate=function(c){return this._evaluate(c,this.args)},jo.prototype.eachChild=function(c){this.args.forEach(c)},jo.prototype.outputDefined=function(){return!1},jo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(c){return c.serialize()}))},jo.parse=function(c,d){var g,A=c[0],P=jo.definitions[A];if(!P)return d.error('Unknown expression "'+A+'". If you wanted a literal array, use ["literal", [...]].',0);for(var B=Array.isArray(P)?P[0]:P.type,V=Array.isArray(P)?[[P[1],P[2]]]:P.overloads,Q=V.filter(function(Po){var Wi=Po[0];return!Array.isArray(Wi)||Wi.length===c.length-1}),me=null,Le=0,We=Q;Le<We.length;Le+=1){var rt=We[Le],ut=rt[0],Nt=rt[1];me=new eu(d.registry,d.path,null,d.scope);for(var cn=[],vn=!1,Zn=1;Zn<c.length;Zn++){var Nn=c[Zn],fr=Array.isArray(ut)?ut[Zn-1]:ut.type,yr=me.parse(Nn,1+cn.length,fr);if(!yr){vn=!0;break}cn.push(yr)}if(!vn)if(Array.isArray(ut)&&ut.length!==cn.length)me.error("Expected "+ut.length+" arguments, but found "+cn.length+" instead.");else{for(var Sr=0;Sr<cn.length;Sr++){var Ir=Array.isArray(ut)?ut[Sr]:ut.type,Xr=cn[Sr];me.concat(Sr+1).checkSubtype(Ir,Xr.type)}if(me.errors.length===0)return new jo(A,B,Nt,cn)}}if(Q.length===1)(g=d.errors).push.apply(g,me.errors);else{for(var Pi=(Q.length?Q:V).map(function(Po){var Wi;return Wi=Po[0],Array.isArray(Wi)?"("+Wi.map(Ye).join(", ")+")":"("+Ye(Wi.type)+"...)"}).join(" | "),Ci=[],Ao=1;Ao<c.length;Ao++){var ao=d.parse(c[Ao],1+Ci.length);if(!ao)return null;Ci.push(Ye(ao.type))}d.error("Expected arguments of type "+Pi+", but found ("+Ci.join(", ")+") instead.")}return null},jo.register=function(c,d){for(var g in jo.definitions=d,d)c[g]=jo};var Va=function(c,d,g){this.type=Ko,this.locale=g,this.caseSensitive=c,this.diacriticSensitive=d};function fs(c,d){c[0]=Math.min(c[0],d[0]),c[1]=Math.min(c[1],d[1]),c[2]=Math.max(c[2],d[0]),c[3]=Math.max(c[3],d[1])}function Tt(c,d){return!(c[0]<=d[0]||c[2]>=d[2]||c[1]<=d[1]||c[3]>=d[3])}function Ft(c,d){var g=(180+c[0])/360,A=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,P=Math.pow(2,d.z);return[Math.round(g*P*8192),Math.round(A*P*8192)]}function Dn(c,d,g){return d[1]>c[1]!=g[1]>c[1]&&c[0]<(g[0]-d[0])*(c[1]-d[1])/(g[1]-d[1])+d[0]}function sr(c,d){for(var g,A,P,B,V,Q,me,Le=!1,We=0,rt=d.length;We<rt;We++)for(var ut=d[We],Nt=0,cn=ut.length;Nt<cn-1;Nt++){if((B=(g=c)[0]-(A=ut[Nt])[0])*(me=g[1]-(P=ut[Nt+1])[1])-(Q=g[0]-P[0])*(V=g[1]-A[1])==0&&B*Q<=0&&V*me<=0)return!1;Dn(c,ut[Nt],ut[Nt+1])&&(Le=!Le)}return Le}function _i(c,d){for(var g=0;g<d.length;g++)if(sr(c,d[g]))return!0;return!1}function bi(c,d,g,A){var P=A[0]-g[0],B=A[1]-g[1],V=(c[0]-g[0])*B-P*(c[1]-g[1]),Q=(d[0]-g[0])*B-P*(d[1]-g[1]);return V>0&&Q<0||V<0&&Q>0}function so(c,d,g){for(var A=0,P=g;A<P.length;A+=1)for(var B=P[A],V=0;V<B.length-1;++V)if((rt=[(We=B[V+1])[0]-(Le=B[V])[0],We[1]-Le[1]])[0]*(ut=[(me=d)[0]-(Q=c)[0],me[1]-Q[1]])[1]-rt[1]*ut[0]!=0&&bi(Q,me,Le,We)&&bi(Le,We,Q,me))return!0;var Q,me,Le,We,rt,ut;return!1}function Ha(c,d){for(var g=0;g<c.length;++g)if(!sr(c[g],d))return!1;for(var A=0;A<c.length-1;++A)if(so(c[A],c[A+1],d))return!1;return!0}function Bs(c,d){for(var g=0;g<d.length;g++)if(Ha(c,d[g]))return!0;return!1}function Os(c,d,g){for(var A=[],P=0;P<c.length;P++){for(var B=[],V=0;V<c[P].length;V++){var Q=Ft(c[P][V],g);fs(d,Q),B.push(Q)}A.push(B)}return A}function il(c,d,g){for(var A=[],P=0;P<c.length;P++){var B=Os(c[P],d,g);A.push(B)}return A}function Xf(c,d,g,A){if(c[0]<g[0]||c[0]>g[2]){var P=.5*A,B=c[0]-g[0]>P?-A:g[0]-c[0]>P?A:0;B===0&&(B=c[0]-g[2]>P?-A:g[2]-c[0]>P?A:0),c[0]+=B}fs(d,c)}function zd(c,d,g,A){for(var P=8192*Math.pow(2,A.z),B=[8192*A.x,8192*A.y],V=[],Q=0,me=c;Q<me.length;Q+=1)for(var Le=0,We=me[Q];Le<We.length;Le+=1){var rt=We[Le],ut=[rt.x+B[0],rt.y+B[1]];Xf(ut,d,g,P),V.push(ut)}return V}function md(c,d,g,A){for(var P,B=8192*Math.pow(2,A.z),V=[8192*A.x,8192*A.y],Q=[],me=0,Le=c;me<Le.length;me+=1){for(var We=[],rt=0,ut=Le[me];rt<ut.length;rt+=1){var Nt=ut[rt],cn=[Nt.x+V[0],Nt.y+V[1]];fs(d,cn),We.push(cn)}Q.push(We)}if(d[2]-d[0]<=B/2){(P=d)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(var vn=0,Zn=Q;vn<Zn.length;vn+=1)for(var Nn=0,fr=Zn[vn];Nn<fr.length;Nn+=1)Xf(fr[Nn],d,g,B)}return Q}Va.parse=function(c,d){if(c.length!==2)return d.error("Expected one argument.");var g=c[1];if(typeof g!="object"||Array.isArray(g))return d.error("Collator options argument must be an object.");var A=d.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,di);if(!A)return null;var P=d.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,di);if(!P)return null;var B=null;return g.locale&&!(B=d.parse(g.locale,1,fi))?null:new Va(A,P,B)},Va.prototype.evaluate=function(c){return new wn(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)},Va.prototype.eachChild=function(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)},Va.prototype.outputDefined=function(){return!1},Va.prototype.serialize=function(){var c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]};var Dl=function(c,d){this.type=di,this.geojson=c,this.geometries=d};function Qc(c){if(c instanceof jo&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Dl)return!1;var d=!0;return c.eachChild(function(g){d&&!Qc(g)&&(d=!1)}),d}function Mf(c){if(c instanceof jo&&c.name==="feature-state")return!1;var d=!0;return c.eachChild(function(g){d&&!Mf(g)&&(d=!1)}),d}function Jc(c,d){if(c instanceof jo&&d.indexOf(c.name)>=0)return!1;var g=!0;return c.eachChild(function(A){g&&!Jc(A,d)&&(g=!1)}),g}Dl.parse=function(c,d){if(c.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(fo(c[1])){var g=c[1];if(g.type==="FeatureCollection")for(var A=0;A<g.features.length;++A){var P=g.features[A].geometry.type;if(P==="Polygon"||P==="MultiPolygon")return new Dl(g,g.features[A].geometry)}else if(g.type==="Feature"){var B=g.geometry.type;if(B==="Polygon"||B==="MultiPolygon")return new Dl(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Dl(g,g)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Dl.prototype.evaluate=function(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(d,g){var A=[1/0,1/0,-1/0,-1/0],P=[1/0,1/0,-1/0,-1/0],B=d.canonicalID();if(g.type==="Polygon"){var V=Os(g.coordinates,P,B),Q=zd(d.geometry(),A,P,B);if(!Tt(A,P))return!1;for(var me=0,Le=Q;me<Le.length;me+=1)if(!sr(Le[me],V))return!1}if(g.type==="MultiPolygon"){var We=il(g.coordinates,P,B),rt=zd(d.geometry(),A,P,B);if(!Tt(A,P))return!1;for(var ut=0,Nt=rt;ut<Nt.length;ut+=1)if(!_i(Nt[ut],We))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(d,g){var A=[1/0,1/0,-1/0,-1/0],P=[1/0,1/0,-1/0,-1/0],B=d.canonicalID();if(g.type==="Polygon"){var V=Os(g.coordinates,P,B),Q=md(d.geometry(),A,P,B);if(!Tt(A,P))return!1;for(var me=0,Le=Q;me<Le.length;me+=1)if(!Ha(Le[me],V))return!1}if(g.type==="MultiPolygon"){var We=il(g.coordinates,P,B),rt=md(d.geometry(),A,P,B);if(!Tt(A,P))return!1;for(var ut=0,Nt=rt;ut<Nt.length;ut+=1)if(!Bs(Nt[ut],We))return!1}return!0}(c,this.geometries)}return!1},Dl.prototype.eachChild=function(){},Dl.prototype.outputDefined=function(){return!0},Dl.prototype.serialize=function(){return["within",this.geojson]};var Ic=function(c,d){this.type=d.type,this.name=c,this.boundExpression=d};Ic.parse=function(c,d){if(c.length!==2||typeof c[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var g=c[1];return d.scope.has(g)?new Ic(g,d.scope.get(g)):d.error('Unknown variable "'+g+'". Make sure "'+g+'" has been bound in an enclosing "let" expression before using it.',1)},Ic.prototype.evaluate=function(c){return this.boundExpression.evaluate(c)},Ic.prototype.eachChild=function(){},Ic.prototype.outputDefined=function(){return!1},Ic.prototype.serialize=function(){return["var",this.name]};var eu=function(c,d,g,A,P){d===void 0&&(d=[]),A===void 0&&(A=new Fr),P===void 0&&(P=[]),this.registry=c,this.path=d,this.key=d.map(function(B){return"["+B+"]"}).join(""),this.scope=A,this.errors=P,this.expectedType=g};function Yf(c,d){for(var g,A=c.length-1,P=0,B=A,V=0;P<=B;)if((g=c[V=Math.floor((P+B)/2)])<=d){if(V===A||d<c[V+1])return V;P=V+1}else{if(!(g>d))throw new Zr("Input is not a number.");B=V-1}return 0}eu.prototype.parse=function(c,d,g,A,P){return P===void 0&&(P={}),d?this.concat(d,g,A)._parse(c,P):this._parse(c,P)},eu.prototype._parse=function(c,d){function g(Le,We,rt){return rt==="assert"?new Mi(We,[Le]):rt==="coerce"?new Yo(We,[Le]):Le}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var A=c[0];if(typeof A!="string")return this.error("Expression name must be a string, but found "+typeof A+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var P=this.registry[A];if(P){var B=P.parse(c,this);if(!B)return null;if(this.expectedType){var V=this.expectedType,Q=B.type;if(V.kind!=="string"&&V.kind!=="number"&&V.kind!=="boolean"&&V.kind!=="object"&&V.kind!=="array"||Q.kind!=="value")if(V.kind!=="color"&&V.kind!=="formatted"&&V.kind!=="resolvedImage"||Q.kind!=="value"&&Q.kind!=="string"){if(this.checkSubtype(V,Q))return null}else B=g(B,V,d.typeAnnotation||"coerce");else B=g(B,V,d.typeAnnotation||"assert")}if(!(B instanceof Li)&&B.type.kind!=="resolvedImage"&&function Le(We){if(We instanceof Ic)return Le(We.boundExpression);if(We instanceof jo&&We.name==="error"||We instanceof Va||We instanceof Dl)return!1;var rt=We instanceof Yo||We instanceof Mi,ut=!0;return We.eachChild(function(Nt){ut=rt?ut&&Le(Nt):ut&&Nt instanceof Li}),!!ut&&Qc(We)&&Jc(We,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(B)){var me=new na;try{B=new Li(B.type,B.evaluate(me))}catch(Le){return this.error(Le.message),null}}return B}return this.error('Unknown expression "'+A+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof c+" instead.")},eu.prototype.concat=function(c,d,g){var A=typeof c=="number"?this.path.concat(c):this.path,P=g?this.scope.concat(g):this.scope;return new eu(this.registry,A,d||null,P,this.errors)},eu.prototype.error=function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];var A=""+this.key+d.map(function(P){return"["+P+"]"}).join("");this.errors.push(new Ur(A,c))},eu.prototype.checkSubtype=function(c,d){var g=Ct(c,d);return g&&this.error(g),g};var ac=function(c,d,g){this.type=c,this.input=d,this.labels=[],this.outputs=[];for(var A=0,P=g;A<P.length;A+=1){var B=P[A],V=B[1];this.labels.push(B[0]),this.outputs.push(V)}};function Xs(c,d,g){return c*(1-g)+d*g}ac.parse=function(c,d){if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");var g=d.parse(c[1],1,wr);if(!g)return null;var A=[],P=null;d.expectedType&&d.expectedType.kind!=="value"&&(P=d.expectedType);for(var B=1;B<c.length;B+=2){var V=B===1?-1/0:c[B],Q=c[B+1],me=B,Le=B+1;if(typeof V!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',me);if(A.length&&A[A.length-1][0]>=V)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',me);var We=d.parse(Q,Le,P);if(!We)return null;P=P||We.type,A.push([V,We])}return new ac(P,g,A)},ac.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var A=this.input.evaluate(c);if(A<=d[0])return g[0].evaluate(c);var P=d.length;return A>=d[P-1]?g[P-1].evaluate(c):g[Yf(d,A)].evaluate(c)},ac.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},ac.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},ac.prototype.serialize=function(){for(var c=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&c.push(this.labels[d]),c.push(this.outputs[d].serialize());return c};var Ru=Object.freeze({__proto__:null,number:Xs,color:function(c,d,g){return new mn(Xs(c.r,d.r,g),Xs(c.g,d.g,g),Xs(c.b,d.b,g),Xs(c.a,d.a,g))},array:function(c,d,g){return c.map(function(A,P){return Xs(A,d[P],g)})}}),gf=6/29*3*(6/29),kh=Math.PI/180,zh=180/Math.PI;function tu(c){return c>.008856451679035631?Math.pow(c,1/3):c/gf+4/29}function mh(c){return c>6/29?c*c*c:gf*(c-4/29)}function Uh(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function vd(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function gd(c){var d=vd(c.r),g=vd(c.g),A=vd(c.b),P=tu((.4124564*d+.3575761*g+.1804375*A)/.95047),B=tu((.2126729*d+.7151522*g+.072175*A)/1);return{l:116*B-16,a:500*(P-B),b:200*(B-tu((.0193339*d+.119192*g+.9503041*A)/1.08883)),alpha:c.a}}function yd(c){var d=(c.l+16)/116,g=isNaN(c.a)?d:d+c.a/500,A=isNaN(c.b)?d:d-c.b/200;return d=1*mh(d),g=.95047*mh(g),A=1.08883*mh(A),new mn(Uh(3.2404542*g-1.5371385*d-.4985314*A),Uh(-.969266*g+1.8760108*d+.041556*A),Uh(.0556434*g-.2040259*d+1.0572252*A),c.alpha)}function vp(c,d,g){var A=d-c;return c+g*(A>180||A<-180?A-360*Math.round(A/360):A)}var $f={forward:gd,reverse:yd,interpolate:function(c,d,g){return{l:Xs(c.l,d.l,g),a:Xs(c.a,d.a,g),b:Xs(c.b,d.b,g),alpha:Xs(c.alpha,d.alpha,g)}}},Mu={forward:function(c){var d=gd(c),g=d.l,A=d.a,P=d.b,B=Math.atan2(P,A)*zh;return{h:B<0?B+360:B,c:Math.sqrt(A*A+P*P),l:g,alpha:c.a}},reverse:function(c){var d=c.h*kh,g=c.c;return yd({l:c.l,a:Math.cos(d)*g,b:Math.sin(d)*g,alpha:c.alpha})},interpolate:function(c,d,g){return{h:vp(c.h,d.h,g),c:Xs(c.c,d.c,g),l:Xs(c.l,d.l,g),alpha:Xs(c.alpha,d.alpha,g)}}},_d=Object.freeze({__proto__:null,lab:$f,hcl:Mu}),Nl=function(c,d,g,A,P){this.type=c,this.operator=d,this.interpolation=g,this.input=A,this.labels=[],this.outputs=[];for(var B=0,V=P;B<V.length;B+=1){var Q=V[B],me=Q[1];this.labels.push(Q[0]),this.outputs.push(me)}};function Is(c,d,g,A){var P=A-g,B=c-g;return P===0?0:d===1?B/P:(Math.pow(d,B)-1)/(Math.pow(d,P)-1)}Nl.interpolationFactor=function(c,d,g,A){var P=0;if(c.name==="exponential")P=Is(d,c.base,g,A);else if(c.name==="linear")P=Is(d,1,g,A);else if(c.name==="cubic-bezier"){var B=c.controlPoints;P=new re(B[0],B[1],B[2],B[3]).solve(Is(d,1,g,A))}return P},Nl.parse=function(c,d){var g=c[0],A=c[1],P=c[2],B=c.slice(3);if(!Array.isArray(A)||A.length===0)return d.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){var V=A[1];if(typeof V!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:V}}else{if(A[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(A[0]),1,0);var Q=A.slice(1);if(Q.length!==4||Q.some(function(Zn){return typeof Zn!="number"||Zn<0||Zn>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:Q}}if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(P=d.parse(P,2,wr)))return null;var me=[],Le=null;g==="interpolate-hcl"||g==="interpolate-lab"?Le=vi:d.expectedType&&d.expectedType.kind!=="value"&&(Le=d.expectedType);for(var We=0;We<B.length;We+=2){var rt=B[We],ut=B[We+1],Nt=We+3,cn=We+4;if(typeof rt!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Nt);if(me.length&&me[me.length-1][0]>=rt)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Nt);var vn=d.parse(ut,cn,Le);if(!vn)return null;Le=Le||vn.type,me.push([rt,vn])}return Le.kind==="number"||Le.kind==="color"||Le.kind==="array"&&Le.itemType.kind==="number"&&typeof Le.N=="number"?new Nl(Le,g,A,P,me):d.error("Type "+Ye(Le)+" is not interpolatable.")},Nl.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var A=this.input.evaluate(c);if(A<=d[0])return g[0].evaluate(c);var P=d.length;if(A>=d[P-1])return g[P-1].evaluate(c);var B=Yf(d,A),V=Nl.interpolationFactor(this.interpolation,A,d[B],d[B+1]),Q=g[B].evaluate(c),me=g[B+1].evaluate(c);return this.operator==="interpolate"?Ru[this.type.kind.toLowerCase()](Q,me,V):this.operator==="interpolate-hcl"?Mu.reverse(Mu.interpolate(Mu.forward(Q),Mu.forward(me),V)):$f.reverse($f.interpolate($f.forward(Q),$f.forward(me),V))},Nl.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},Nl.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},Nl.prototype.serialize=function(){var c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,c,this.input.serialize()],g=0;g<this.labels.length;g++)d.push(this.labels[g],this.outputs[g].serialize());return d};var nu=function(c,d){this.type=c,this.args=d};nu.parse=function(c,d){if(c.length<2)return d.error("Expectected at least one argument.");var g=null,A=d.expectedType;A&&A.kind!=="value"&&(g=A);for(var P=[],B=0,V=c.slice(1);B<V.length;B+=1){var Q=d.parse(V[B],1+P.length,g,void 0,{typeAnnotation:"omit"});if(!Q)return null;g=g||Q.type,P.push(Q)}var me=A&&P.some(function(Le){return Ct(A,Le.type)});return new nu(me?Oi:g,P)},nu.prototype.evaluate=function(c){for(var d,g=null,A=0,P=0,B=this.args;P<B.length&&(A++,(g=B[P].evaluate(c))&&g instanceof ai&&!g.available&&(d||(d=g.name),g=null,A===this.args.length&&(g=d)),g===null);P+=1);return g},nu.prototype.eachChild=function(c){this.args.forEach(c)},nu.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},nu.prototype.serialize=function(){var c=["coalesce"];return this.eachChild(function(d){c.push(d.serialize())}),c};var sc=function(c,d){this.type=d.type,this.bindings=[].concat(c),this.result=d};sc.prototype.evaluate=function(c){return this.result.evaluate(c)},sc.prototype.eachChild=function(c){for(var d=0,g=this.bindings;d<g.length;d+=1)c(g[d][1]);c(this.result)},sc.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found "+(c.length-1)+" instead.");for(var g=[],A=1;A<c.length-1;A+=2){var P=c[A];if(typeof P!="string")return d.error("Expected string, but found "+typeof P+" instead.",A);if(/[^a-zA-Z0-9_]/.test(P))return d.error("Variable names must contain only alphanumeric characters or '_'.",A);var B=d.parse(c[A+1],A+1);if(!B)return null;g.push([P,B])}var V=d.parse(c[c.length-1],c.length-1,d.expectedType,g);return V?new sc(g,V):null},sc.prototype.outputDefined=function(){return this.result.outputDefined()},sc.prototype.serialize=function(){for(var c=["let"],d=0,g=this.bindings;d<g.length;d+=1){var A=g[d];c.push(A[0],A[1].serialize())}return c.push(this.result.serialize()),c};var of=function(c,d,g){this.type=c,this.index=d,this.input=g};of.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,wr),A=d.parse(c[2],2,Xo(d.expectedType||Oi));return g&&A?new of(A.type.itemType,g,A):null},of.prototype.evaluate=function(c){var d=this.index.evaluate(c),g=this.input.evaluate(c);if(d<0)throw new Zr("Array index out of bounds: "+d+" < 0.");if(d>=g.length)throw new Zr("Array index out of bounds: "+d+" > "+(g.length-1)+".");if(d!==Math.floor(d))throw new Zr("Array index must be an integer, but found "+d+" instead.");return g[d]},of.prototype.eachChild=function(c){c(this.index),c(this.input)},of.prototype.outputDefined=function(){return!1},of.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var lc=function(c,d){this.type=di,this.needle=c,this.haystack=d};lc.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Oi),A=d.parse(c[2],2,Oi);return g&&A?sn(g.type,[di,fi,wr,qr,Oi])?new lc(g,A):d.error("Expected first argument to be of type boolean, string, number or null, but found "+Ye(g.type)+" instead"):null},lc.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!g)return!1;if(!Ln(d,["boolean","string","number","null"]))throw new Zr("Expected first argument to be of type boolean, string, number or null, but found "+Ye(ei(d))+" instead.");if(!Ln(g,["string","array"]))throw new Zr("Expected second argument to be of type array or string, but found "+Ye(ei(g))+" instead.");return g.indexOf(d)>=0},lc.prototype.eachChild=function(c){c(this.needle),c(this.haystack)},lc.prototype.outputDefined=function(){return!0},lc.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var af=function(c,d,g){this.type=wr,this.needle=c,this.haystack=d,this.fromIndex=g};af.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Oi),A=d.parse(c[2],2,Oi);if(!g||!A)return null;if(!sn(g.type,[di,fi,wr,qr,Oi]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+Ye(g.type)+" instead");if(c.length===4){var P=d.parse(c[3],3,wr);return P?new af(g,A,P):null}return new af(g,A)},af.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!Ln(d,["boolean","string","number","null"]))throw new Zr("Expected first argument to be of type boolean, string, number or null, but found "+Ye(ei(d))+" instead.");if(!Ln(g,["string","array"]))throw new Zr("Expected second argument to be of type array or string, but found "+Ye(ei(g))+" instead.");if(this.fromIndex){var A=this.fromIndex.evaluate(c);return g.indexOf(d,A)}return g.indexOf(d)},af.prototype.eachChild=function(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)},af.prototype.outputDefined=function(){return!1},af.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Bl=function(c,d,g,A,P,B){this.inputType=c,this.type=d,this.input=g,this.cases=A,this.outputs=P,this.otherwise=B};Bl.parse=function(c,d){if(c.length<5)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if(c.length%2!=1)return d.error("Expected an even number of arguments.");var g,A;d.expectedType&&d.expectedType.kind!=="value"&&(A=d.expectedType);for(var P={},B=[],V=2;V<c.length-1;V+=2){var Q=c[V],me=c[V+1];Array.isArray(Q)||(Q=[Q]);var Le=d.concat(V);if(Q.length===0)return Le.error("Expected at least one branch label.");for(var We=0,rt=Q;We<rt.length;We+=1){var ut=rt[We];if(typeof ut!="number"&&typeof ut!="string")return Le.error("Branch labels must be numbers or strings.");if(typeof ut=="number"&&Math.abs(ut)>Number.MAX_SAFE_INTEGER)return Le.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof ut=="number"&&Math.floor(ut)!==ut)return Le.error("Numeric branch labels must be integer values.");if(g){if(Le.checkSubtype(g,ei(ut)))return null}else g=ei(ut);if(P[String(ut)]!==void 0)return Le.error("Branch labels must be unique.");P[String(ut)]=B.length}var Nt=d.parse(me,V,A);if(!Nt)return null;A=A||Nt.type,B.push(Nt)}var cn=d.parse(c[1],1,Oi);if(!cn)return null;var vn=d.parse(c[c.length-1],c.length-1,A);return vn?cn.type.kind!=="value"&&d.concat(1).checkSubtype(g,cn.type)?null:new Bl(g,A,cn,P,B,vn):null},Bl.prototype.evaluate=function(c){var d=this.input.evaluate(c);return(ei(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(c)},Bl.prototype.eachChild=function(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)},Bl.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})&&this.otherwise.outputDefined()},Bl.prototype.serialize=function(){for(var c=this,d=["match",this.input.serialize()],g=[],A={},P=0,B=Object.keys(this.cases).sort();P<B.length;P+=1){var V=B[P];(rt=A[this.cases[V]])===void 0?(A[this.cases[V]]=g.length,g.push([this.cases[V],[V]])):g[rt][1].push(V)}for(var Q=function(Nt){return c.inputType.kind==="number"?Number(Nt):Nt},me=0,Le=g;me<Le.length;me+=1){var We=Le[me],rt=We[0],ut=We[1];d.push(ut.length===1?Q(ut[0]):ut.map(Q)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var Pu=function(c,d,g){this.type=c,this.branches=d,this.otherwise=g};Pu.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found only "+(c.length-1)+".");if(c.length%2!=0)return d.error("Expected an odd number of arguments.");var g;d.expectedType&&d.expectedType.kind!=="value"&&(g=d.expectedType);for(var A=[],P=1;P<c.length-1;P+=2){var B=d.parse(c[P],P,di);if(!B)return null;var V=d.parse(c[P+1],P+1,g);if(!V)return null;A.push([B,V]),g=g||V.type}var Q=d.parse(c[c.length-1],c.length-1,g);return Q?new Pu(g,A,Q):null},Pu.prototype.evaluate=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var A=g[d],P=A[1];if(A[0].evaluate(c))return P.evaluate(c)}return this.otherwise.evaluate(c)},Pu.prototype.eachChild=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var A=g[d],P=A[1];c(A[0]),c(P)}c(this.otherwise)},Pu.prototype.outputDefined=function(){return this.branches.every(function(c){return c[1].outputDefined()})&&this.otherwise.outputDefined()},Pu.prototype.serialize=function(){var c=["case"];return this.eachChild(function(d){c.push(d.serialize())}),c};var yf=function(c,d,g,A){this.type=c,this.input=d,this.beginIndex=g,this.endIndex=A};function vh(c,d){return c==="=="||c==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function Kf(c,d,g,A){return A.compare(d,g)===0}function ps(c,d,g){var A=c!=="=="&&c!=="!=";return function(){function P(B,V,Q){this.type=di,this.lhs=B,this.rhs=V,this.collator=Q,this.hasUntypedArgument=B.type.kind==="value"||V.type.kind==="value"}return P.parse=function(B,V){if(B.length!==3&&B.length!==4)return V.error("Expected two or three arguments.");var Q=B[0],me=V.parse(B[1],1,Oi);if(!me)return null;if(!vh(Q,me.type))return V.concat(1).error('"'+Q+`" comparisons are not supported for type '`+Ye(me.type)+"'.");var Le=V.parse(B[2],2,Oi);if(!Le)return null;if(!vh(Q,Le.type))return V.concat(2).error('"'+Q+`" comparisons are not supported for type '`+Ye(Le.type)+"'.");if(me.type.kind!==Le.type.kind&&me.type.kind!=="value"&&Le.type.kind!=="value")return V.error("Cannot compare types '"+Ye(me.type)+"' and '"+Ye(Le.type)+"'.");A&&(me.type.kind==="value"&&Le.type.kind!=="value"?me=new Mi(Le.type,[me]):me.type.kind!=="value"&&Le.type.kind==="value"&&(Le=new Mi(me.type,[Le])));var We=null;if(B.length===4){if(me.type.kind!=="string"&&Le.type.kind!=="string"&&me.type.kind!=="value"&&Le.type.kind!=="value")return V.error("Cannot use collator to compare non-string types.");if(!(We=V.parse(B[3],3,Ko)))return null}return new P(me,Le,We)},P.prototype.evaluate=function(B){var V=this.lhs.evaluate(B),Q=this.rhs.evaluate(B);if(A&&this.hasUntypedArgument){var me=ei(V),Le=ei(Q);if(me.kind!==Le.kind||me.kind!=="string"&&me.kind!=="number")throw new Zr('Expected arguments for "'+c+'" to be (string, string) or (number, number), but found ('+me.kind+", "+Le.kind+") instead.")}if(this.collator&&!A&&this.hasUntypedArgument){var We=ei(V),rt=ei(Q);if(We.kind!=="string"||rt.kind!=="string")return d(B,V,Q)}return this.collator?g(B,V,Q,this.collator.evaluate(B)):d(B,V,Q)},P.prototype.eachChild=function(B){B(this.lhs),B(this.rhs),this.collator&&B(this.collator)},P.prototype.outputDefined=function(){return!0},P.prototype.serialize=function(){var B=[c];return this.eachChild(function(V){B.push(V.serialize())}),B},P}()}yf.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Oi),A=d.parse(c[2],2,wr);if(!g||!A)return null;if(!sn(g.type,[Xo(Oi),fi,Oi]))return d.error("Expected first argument to be of type array or string, but found "+Ye(g.type)+" instead");if(c.length===4){var P=d.parse(c[3],3,wr);return P?new yf(g.type,g,A,P):null}return new yf(g.type,g,A)},yf.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=this.beginIndex.evaluate(c);if(!Ln(d,["string","array"]))throw new Zr("Expected first argument to be of type array or string, but found "+Ye(ei(d))+" instead.");if(this.endIndex){var A=this.endIndex.evaluate(c);return d.slice(g,A)}return d.slice(g)},yf.prototype.eachChild=function(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)},yf.prototype.outputDefined=function(){return!1},yf.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var jh=ps("==",function(c,d,g){return d===g},Kf),Vh=ps("!=",function(c,d,g){return d!==g},function(c,d,g,A){return!Kf(0,d,g,A)}),gh=ps("<",function(c,d,g){return d<g},function(c,d,g,A){return A.compare(d,g)<0}),ol=ps(">",function(c,d,g){return d>g},function(c,d,g,A){return A.compare(d,g)>0}),qf=ps("<=",function(c,d,g){return d<=g},function(c,d,g,A){return A.compare(d,g)<=0}),Qf=ps(">=",function(c,d,g){return d>=g},function(c,d,g,A){return A.compare(d,g)>=0}),ne=function(c,d,g,A,P){this.type=fi,this.number=c,this.locale=d,this.currency=g,this.minFractionDigits=A,this.maxFractionDigits=P};ne.parse=function(c,d){if(c.length!==3)return d.error("Expected two arguments.");var g=d.parse(c[1],1,wr);if(!g)return null;var A=c[2];if(typeof A!="object"||Array.isArray(A))return d.error("NumberFormat options argument must be an object.");var P=null;if(A.locale&&!(P=d.parse(A.locale,1,fi)))return null;var B=null;if(A.currency&&!(B=d.parse(A.currency,1,fi)))return null;var V=null;if(A["min-fraction-digits"]&&!(V=d.parse(A["min-fraction-digits"],1,wr)))return null;var Q=null;return A["max-fraction-digits"]&&!(Q=d.parse(A["max-fraction-digits"],1,wr))?null:new ne(g,P,B,V,Q)},ne.prototype.evaluate=function(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))},ne.prototype.eachChild=function(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)},ne.prototype.outputDefined=function(){return!1},ne.prototype.serialize=function(){var c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]};var _e=function(c){this.type=wr,this.input=c};_e.parse=function(c,d){if(c.length!==2)return d.error("Expected 1 argument, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+Ye(g.type)+" instead."):new _e(g):null},_e.prototype.evaluate=function(c){var d=this.input.evaluate(c);if(typeof d=="string"||Array.isArray(d))return d.length;throw new Zr("Expected value to be of type string or array, but found "+Ye(ei(d))+" instead.")},_e.prototype.eachChild=function(c){c(this.input)},_e.prototype.outputDefined=function(){return!1},_e.prototype.serialize=function(){var c=["length"];return this.eachChild(function(d){c.push(d.serialize())}),c};var et={"==":jh,"!=":Vh,">":ol,"<":gh,">=":Qf,"<=":qf,array:Mi,at:of,boolean:Mi,case:Pu,coalesce:nu,collator:Va,format:bo,image:Si,in:lc,"index-of":af,interpolate:Nl,"interpolate-hcl":Nl,"interpolate-lab":Nl,length:_e,let:sc,literal:Li,match:Bl,number:Mi,"number-format":ne,object:Mi,slice:yf,step:ac,string:Mi,"to-boolean":Yo,"to-color":Yo,"to-number":Yo,"to-string":Yo,var:Ic,within:Dl};function dn(c,d){var g=d[0],A=d[1],P=d[2],B=d[3];g=g.evaluate(c),A=A.evaluate(c),P=P.evaluate(c);var V=B?B.evaluate(c):1,Q=Vi(g,A,P,V);if(Q)throw new Zr(Q);return new mn(g/255*V,A/255*V,P/255*V,V)}function K(c,d){return c in d}function rr(c,d){var g=d[c];return g===void 0?null:g}function Mr(c){return{type:c}}function ki(c){return{result:"success",value:c}}function ti(c){return{result:"error",value:c}}function uo(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function lo(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function ca(c){return!!c.expression&&c.expression.interpolated}function Io(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function xa(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Qa(c){return c}function aa(c,d,g){return c!==void 0?c:d!==void 0?d:g!==void 0?g:void 0}function ga(c,d,g,A,P){return aa(typeof g===P?A[g]:void 0,c.default,d.default)}function hs(c,d,g){if(Io(g)!=="number")return aa(c.default,d.default);var A=c.stops.length;if(A===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[A-1][0])return c.stops[A-1][1];var P=Yf(c.stops.map(function(B){return B[0]}),g);return c.stops[P][1]}function Oa(c,d,g){var A=c.base!==void 0?c.base:1;if(Io(g)!=="number")return aa(c.default,d.default);var P=c.stops.length;if(P===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[P-1][0])return c.stops[P-1][1];var B=Yf(c.stops.map(function(rt){return rt[0]}),g),V=function(rt,ut,Nt,cn){var vn=cn-Nt,Zn=rt-Nt;return vn===0?0:ut===1?Zn/vn:(Math.pow(ut,Zn)-1)/(Math.pow(ut,vn)-1)}(g,A,c.stops[B][0],c.stops[B+1][0]),Q=c.stops[B][1],me=c.stops[B+1][1],Le=Ru[d.type]||Qa;if(c.colorSpace&&c.colorSpace!=="rgb"){var We=_d[c.colorSpace];Le=function(rt,ut){return We.reverse(We.interpolate(We.forward(rt),We.forward(ut),V))}}return typeof Q.evaluate=="function"?{evaluate:function(){for(var rt=[],ut=arguments.length;ut--;)rt[ut]=arguments[ut];var Nt=Q.evaluate.apply(void 0,rt),cn=me.evaluate.apply(void 0,rt);if(Nt!==void 0&&cn!==void 0)return Le(Nt,cn,V)}}:Le(Q,me,V)}function La(c,d,g){return d.type==="color"?g=mn.parse(g):d.type==="formatted"?g=mr.fromString(g.toString()):d.type==="resolvedImage"?g=ai.fromString(g.toString()):Io(g)===d.type||d.type==="enum"&&d.values[g]||(g=void 0),aa(g,c.default,d.default)}jo.register(et,{error:[{kind:"error"},[fi],function(c,d){throw new Zr(d[0].evaluate(c))}],typeof:[fi,[Oi],function(c,d){return Ye(ei(d[0].evaluate(c)))}],"to-rgba":[Xo(wr,4),[vi],function(c,d){return d[0].evaluate(c).toArray()}],rgb:[vi,[wr,wr,wr],dn],rgba:[vi,[wr,wr,wr,wr],dn],has:{type:di,overloads:[[[fi],function(c,d){return K(d[0].evaluate(c),c.properties())}],[[fi,vo],function(c,d){var g=d[1];return K(d[0].evaluate(c),g.evaluate(c))}]]},get:{type:Oi,overloads:[[[fi],function(c,d){return rr(d[0].evaluate(c),c.properties())}],[[fi,vo],function(c,d){var g=d[1];return rr(d[0].evaluate(c),g.evaluate(c))}]]},"feature-state":[Oi,[fi],function(c,d){return rr(d[0].evaluate(c),c.featureState||{})}],properties:[vo,[],function(c){return c.properties()}],"geometry-type":[fi,[],function(c){return c.geometryType()}],id:[Oi,[],function(c){return c.id()}],zoom:[wr,[],function(c){return c.globals.zoom}],"heatmap-density":[wr,[],function(c){return c.globals.heatmapDensity||0}],"line-progress":[wr,[],function(c){return c.globals.lineProgress||0}],accumulated:[Oi,[],function(c){return c.globals.accumulated===void 0?null:c.globals.accumulated}],"+":[wr,Mr(wr),function(c,d){for(var g=0,A=0,P=d;A<P.length;A+=1)g+=P[A].evaluate(c);return g}],"*":[wr,Mr(wr),function(c,d){for(var g=1,A=0,P=d;A<P.length;A+=1)g*=P[A].evaluate(c);return g}],"-":{type:wr,overloads:[[[wr,wr],function(c,d){var g=d[1];return d[0].evaluate(c)-g.evaluate(c)}],[[wr],function(c,d){return-d[0].evaluate(c)}]]},"/":[wr,[wr,wr],function(c,d){var g=d[1];return d[0].evaluate(c)/g.evaluate(c)}],"%":[wr,[wr,wr],function(c,d){var g=d[1];return d[0].evaluate(c)%g.evaluate(c)}],ln2:[wr,[],function(){return Math.LN2}],pi:[wr,[],function(){return Math.PI}],e:[wr,[],function(){return Math.E}],"^":[wr,[wr,wr],function(c,d){var g=d[1];return Math.pow(d[0].evaluate(c),g.evaluate(c))}],sqrt:[wr,[wr],function(c,d){return Math.sqrt(d[0].evaluate(c))}],log10:[wr,[wr],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN10}],ln:[wr,[wr],function(c,d){return Math.log(d[0].evaluate(c))}],log2:[wr,[wr],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN2}],sin:[wr,[wr],function(c,d){return Math.sin(d[0].evaluate(c))}],cos:[wr,[wr],function(c,d){return Math.cos(d[0].evaluate(c))}],tan:[wr,[wr],function(c,d){return Math.tan(d[0].evaluate(c))}],asin:[wr,[wr],function(c,d){return Math.asin(d[0].evaluate(c))}],acos:[wr,[wr],function(c,d){return Math.acos(d[0].evaluate(c))}],atan:[wr,[wr],function(c,d){return Math.atan(d[0].evaluate(c))}],min:[wr,Mr(wr),function(c,d){return Math.min.apply(Math,d.map(function(g){return g.evaluate(c)}))}],max:[wr,Mr(wr),function(c,d){return Math.max.apply(Math,d.map(function(g){return g.evaluate(c)}))}],abs:[wr,[wr],function(c,d){return Math.abs(d[0].evaluate(c))}],round:[wr,[wr],function(c,d){var g=d[0].evaluate(c);return g<0?-Math.round(-g):Math.round(g)}],floor:[wr,[wr],function(c,d){return Math.floor(d[0].evaluate(c))}],ceil:[wr,[wr],function(c,d){return Math.ceil(d[0].evaluate(c))}],"filter-==":[di,[fi,Oi],function(c,d){var g=d[0],A=d[1];return c.properties()[g.value]===A.value}],"filter-id-==":[di,[Oi],function(c,d){var g=d[0];return c.id()===g.value}],"filter-type-==":[di,[fi],function(c,d){var g=d[0];return c.geometryType()===g.value}],"filter-<":[di,[fi,Oi],function(c,d){var g=d[0],A=d[1],P=c.properties()[g.value],B=A.value;return typeof P==typeof B&&P<B}],"filter-id-<":[di,[Oi],function(c,d){var g=d[0],A=c.id(),P=g.value;return typeof A==typeof P&&A<P}],"filter->":[di,[fi,Oi],function(c,d){var g=d[0],A=d[1],P=c.properties()[g.value],B=A.value;return typeof P==typeof B&&P>B}],"filter-id->":[di,[Oi],function(c,d){var g=d[0],A=c.id(),P=g.value;return typeof A==typeof P&&A>P}],"filter-<=":[di,[fi,Oi],function(c,d){var g=d[0],A=d[1],P=c.properties()[g.value],B=A.value;return typeof P==typeof B&&P<=B}],"filter-id-<=":[di,[Oi],function(c,d){var g=d[0],A=c.id(),P=g.value;return typeof A==typeof P&&A<=P}],"filter->=":[di,[fi,Oi],function(c,d){var g=d[0],A=d[1],P=c.properties()[g.value],B=A.value;return typeof P==typeof B&&P>=B}],"filter-id->=":[di,[Oi],function(c,d){var g=d[0],A=c.id(),P=g.value;return typeof A==typeof P&&A>=P}],"filter-has":[di,[Oi],function(c,d){return d[0].value in c.properties()}],"filter-has-id":[di,[],function(c){return c.id()!==null&&c.id()!==void 0}],"filter-type-in":[di,[Xo(fi)],function(c,d){return d[0].value.indexOf(c.geometryType())>=0}],"filter-id-in":[di,[Xo(Oi)],function(c,d){return d[0].value.indexOf(c.id())>=0}],"filter-in-small":[di,[fi,Xo(Oi)],function(c,d){var g=d[0];return d[1].value.indexOf(c.properties()[g.value])>=0}],"filter-in-large":[di,[fi,Xo(Oi)],function(c,d){var g=d[0],A=d[1];return function(P,B,V,Q){for(;V<=Q;){var me=V+Q>>1;if(B[me]===P)return!0;B[me]>P?Q=me-1:V=me+1}return!1}(c.properties()[g.value],A.value,0,A.value.length-1)}],all:{type:di,overloads:[[[di,di],function(c,d){var g=d[1];return d[0].evaluate(c)&&g.evaluate(c)}],[Mr(di),function(c,d){for(var g=0,A=d;g<A.length;g+=1)if(!A[g].evaluate(c))return!1;return!0}]]},any:{type:di,overloads:[[[di,di],function(c,d){var g=d[1];return d[0].evaluate(c)||g.evaluate(c)}],[Mr(di),function(c,d){for(var g=0,A=d;g<A.length;g+=1)if(A[g].evaluate(c))return!0;return!1}]]},"!":[di,[di],function(c,d){return!d[0].evaluate(c)}],"is-supported-script":[di,[fi],function(c,d){var g=c.globals&&c.globals.isSupportedScript;return!g||g(d[0].evaluate(c))}],upcase:[fi,[fi],function(c,d){return d[0].evaluate(c).toUpperCase()}],downcase:[fi,[fi],function(c,d){return d[0].evaluate(c).toLowerCase()}],concat:[fi,Mr(Oi),function(c,d){return d.map(function(g){return zi(g.evaluate(c))}).join("")}],"resolved-locale":[fi,[Ko],function(c,d){return d[0].evaluate(c).resolvedLocale()}]});var Fa=function(c,d){this.expression=c,this._warningHistory={},this._evaluator=new na,this._defaultValue=d?function(g){return g.type==="color"&&xa(g.default)?new mn(0,0,0,0):g.type==="color"?mn.parse(g.default)||null:g.default===void 0?null:g.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function Ks(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in et}function Fs(c,d){var g=new eu(et,[],d?function(P){var B={color:vi,string:fi,number:wr,enum:fi,boolean:di,formatted:va,resolvedImage:Co};return P.type==="array"?Xo(B[P.value]||Oi,P.length):B[P.type]}(d):void 0),A=g.parse(c,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return A?ki(new Fa(A,d)):ti(g.errors)}Fa.prototype.evaluateWithoutErrorHandling=function(c,d,g,A,P,B){return this._evaluator.globals=c,this._evaluator.feature=d,this._evaluator.featureState=g,this._evaluator.canonical=A,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=B,this.expression.evaluate(this._evaluator)},Fa.prototype.evaluate=function(c,d,g,A,P,B){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=g||null,this._evaluator.canonical=A,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=B||null;try{var V=this.expression.evaluate(this._evaluator);if(V==null||typeof V=="number"&&V!=V)return this._defaultValue;if(this._enumValues&&!(V in this._enumValues))throw new Zr("Expected value to be one of "+Object.keys(this._enumValues).map(function(Q){return JSON.stringify(Q)}).join(", ")+", but found "+JSON.stringify(V)+" instead.");return V}catch(Q){return this._warningHistory[Q.message]||(this._warningHistory[Q.message]=!0,typeof console!="undefined"&&console.warn(Q.message)),this._defaultValue}};var Ec=function(c,d){this.kind=c,this._styleExpression=d,this.isStateDependent=c!=="constant"&&!Mf(d.expression)};Ec.prototype.evaluateWithoutErrorHandling=function(c,d,g,A,P,B){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,A,P,B)},Ec.prototype.evaluate=function(c,d,g,A,P,B){return this._styleExpression.evaluate(c,d,g,A,P,B)};var is=function(c,d,g,A){this.kind=c,this.zoomStops=g,this._styleExpression=d,this.isStateDependent=c!=="camera"&&!Mf(d.expression),this.interpolationType=A};function Iu(c,d){if((c=Fs(c,d)).result==="error")return c;var g=c.value.expression,A=Qc(g);if(!A&&!uo(d))return ti([new Ur("","data expressions not supported")]);var P=Jc(g,["zoom"]);if(!P&&!lo(d))return ti([new Ur("","zoom expressions not supported")]);var B=function V(Q){var me=null;if(Q instanceof sc)me=V(Q.result);else if(Q instanceof nu)for(var Le=0,We=Q.args;Le<We.length&&!(me=V(We[Le]));Le+=1);else(Q instanceof ac||Q instanceof Nl)&&Q.input instanceof jo&&Q.input.name==="zoom"&&(me=Q);return me instanceof Ur||Q.eachChild(function(rt){var ut=V(rt);ut instanceof Ur?me=ut:!me&&ut?me=new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):me&&ut&&me!==ut&&(me=new Ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),me}(g);return B||P?B instanceof Ur?ti([B]):B instanceof Nl&&!ca(d)?ti([new Ur("",'"interpolate" expressions cannot be used with this property')]):ki(B?new is(A?"camera":"composite",c.value,B.labels,B instanceof Nl?B.interpolation:void 0):new Ec(A?"constant":"source",c.value)):ti([new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}is.prototype.evaluateWithoutErrorHandling=function(c,d,g,A,P,B){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,A,P,B)},is.prototype.evaluate=function(c,d,g,A,P,B){return this._styleExpression.evaluate(c,d,g,A,P,B)},is.prototype.interpolationFactor=function(c,d,g){return this.interpolationType?Nl.interpolationFactor(this.interpolationType,c,d,g):0};var du=function(c,d){this._parameters=c,this._specification=d,Tr(this,function g(A,P){var B,V,Q,me=P.type==="color",Le=A.stops&&typeof A.stops[0][0]=="object",We=Le||!(Le||A.property!==void 0),rt=A.type||(ca(P)?"exponential":"interval");if(me&&((A=Tr({},A)).stops&&(A.stops=A.stops.map(function(ao){return[ao[0],mn.parse(ao[1])]})),A.default=mn.parse(A.default?A.default:P.default)),A.colorSpace&&A.colorSpace!=="rgb"&&!_d[A.colorSpace])throw new Error("Unknown color space: "+A.colorSpace);if(rt==="exponential")B=Oa;else if(rt==="interval")B=hs;else if(rt==="categorical"){B=ga,V=Object.create(null);for(var ut=0,Nt=A.stops;ut<Nt.length;ut+=1){var cn=Nt[ut];V[cn[0]]=cn[1]}Q=typeof A.stops[0][0]}else{if(rt!=="identity")throw new Error('Unknown function type "'+rt+'"');B=La}if(Le){for(var vn={},Zn=[],Nn=0;Nn<A.stops.length;Nn++){var fr=A.stops[Nn],yr=fr[0].zoom;vn[yr]===void 0&&(vn[yr]={zoom:yr,type:A.type,property:A.property,default:A.default,stops:[]},Zn.push(yr)),vn[yr].stops.push([fr[0].value,fr[1]])}for(var Sr=[],Ir=0,Xr=Zn;Ir<Xr.length;Ir+=1){var Pi=Xr[Ir];Sr.push([vn[Pi].zoom,g(vn[Pi],P)])}var Ci={name:"linear"};return{kind:"composite",interpolationType:Ci,interpolationFactor:Nl.interpolationFactor.bind(void 0,Ci),zoomStops:Sr.map(function(ao){return ao[0]}),evaluate:function(ao,Po){var Wi=ao.zoom;return Oa({stops:Sr,base:A.base},P,Wi).evaluate(Wi,Po)}}}if(We){var Ao=rt==="exponential"?{name:"exponential",base:A.base!==void 0?A.base:1}:null;return{kind:"camera",interpolationType:Ao,interpolationFactor:Nl.interpolationFactor.bind(void 0,Ao),zoomStops:A.stops.map(function(ao){return ao[0]}),evaluate:function(ao){return B(A,P,ao.zoom,V,Q)}}}return{kind:"source",evaluate:function(ao,Po){var Wi=Po&&Po.properties?Po.properties[A.property]:void 0;return Wi===void 0?aa(A.default,P.default):B(A,P,Wi,V,Q)}}}(this._parameters,this._specification))};function Lc(c){var d=c.key,g=c.value,A=c.valueSpec||{},P=c.objectElementValidators||{},B=c.style,V=c.styleSpec,Q=[],me=Io(g);if(me!=="object")return[new en(d,g,"object expected, "+me+" found")];for(var Le in g){var We=Le.split(".")[0],rt=A[We]||A["*"],ut=void 0;if(P[We])ut=P[We];else if(A[We])ut=Pe;else if(P["*"])ut=P["*"];else{if(!A["*"]){Q.push(new en(d,g[Le],'unknown property "'+Le+'"'));continue}ut=Pe}Q=Q.concat(ut({key:(d&&d+".")+Le,value:g[Le],valueSpec:rt,style:B,styleSpec:V,object:g,objectKey:Le},g))}for(var Nt in A)P[Nt]||A[Nt].required&&A[Nt].default===void 0&&g[Nt]===void 0&&Q.push(new en(d,g,'missing required property "'+Nt+'"'));return Q}function Pf(c){var d=c.value,g=c.valueSpec,A=c.style,P=c.styleSpec,B=c.key,V=c.arrayElementValidator||Pe;if(Io(d)!=="array")return[new en(B,d,"array expected, "+Io(d)+" found")];if(g.length&&d.length!==g.length)return[new en(B,d,"array length "+g.length+" expected, length "+d.length+" found")];if(g["min-length"]&&d.length<g["min-length"])return[new en(B,d,"array length at least "+g["min-length"]+" expected, length "+d.length+" found")];var Q={type:g.value,values:g.values};P.$version<7&&(Q.function=g.function),Io(g.value)==="object"&&(Q=g.value);for(var me=[],Le=0;Le<d.length;Le++)me=me.concat(V({array:d,arrayIndex:Le,value:d[Le],valueSpec:Q,style:A,styleSpec:P,key:B+"["+Le+"]"}));return me}function Hh(c){var d=c.key,g=c.value,A=c.valueSpec,P=Io(g);return P==="number"&&g!=g&&(P="NaN"),P!=="number"?[new en(d,g,"number expected, "+P+" found")]:"minimum"in A&&g<A.minimum?[new en(d,g,g+" is less than the minimum value "+A.minimum)]:"maximum"in A&&g>A.maximum?[new en(d,g,g+" is greater than the maximum value "+A.maximum)]:[]}function Zh(c){var d,g,A,P=c.valueSpec,B=jr(c.value.type),V={},Q=B!=="categorical"&&c.value.property===void 0,me=!Q,Le=Io(c.value.stops)==="array"&&Io(c.value.stops[0])==="array"&&Io(c.value.stops[0][0])==="object",We=Lc({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Nt){if(B==="identity")return[new en(Nt.key,Nt.value,'identity function may not have a "stops" property')];var cn=[],vn=Nt.value;return cn=cn.concat(Pf({key:Nt.key,value:vn,valueSpec:Nt.valueSpec,style:Nt.style,styleSpec:Nt.styleSpec,arrayElementValidator:rt})),Io(vn)==="array"&&vn.length===0&&cn.push(new en(Nt.key,vn,"array must have at least one stop")),cn},default:function(Nt){return Pe({key:Nt.key,value:Nt.value,valueSpec:P,style:Nt.style,styleSpec:Nt.styleSpec})}}});return B==="identity"&&Q&&We.push(new en(c.key,c.value,'missing required property "property"')),B==="identity"||c.value.stops||We.push(new en(c.key,c.value,'missing required property "stops"')),B==="exponential"&&c.valueSpec.expression&&!ca(c.valueSpec)&&We.push(new en(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(me&&!uo(c.valueSpec)?We.push(new en(c.key,c.value,"property functions not supported")):Q&&!lo(c.valueSpec)&&We.push(new en(c.key,c.value,"zoom functions not supported"))),B!=="categorical"&&!Le||c.value.property!==void 0||We.push(new en(c.key,c.value,'"property" property is required')),We;function rt(Nt){var cn=[],vn=Nt.value,Zn=Nt.key;if(Io(vn)!=="array")return[new en(Zn,vn,"array expected, "+Io(vn)+" found")];if(vn.length!==2)return[new en(Zn,vn,"array length 2 expected, length "+vn.length+" found")];if(Le){if(Io(vn[0])!=="object")return[new en(Zn,vn,"object expected, "+Io(vn[0])+" found")];if(vn[0].zoom===void 0)return[new en(Zn,vn,"object stop key must have zoom")];if(vn[0].value===void 0)return[new en(Zn,vn,"object stop key must have value")];if(A&&A>jr(vn[0].zoom))return[new en(Zn,vn[0].zoom,"stop zoom values must appear in ascending order")];jr(vn[0].zoom)!==A&&(A=jr(vn[0].zoom),g=void 0,V={}),cn=cn.concat(Lc({key:Zn+"[0]",value:vn[0],valueSpec:{zoom:{}},style:Nt.style,styleSpec:Nt.styleSpec,objectElementValidators:{zoom:Hh,value:ut}}))}else cn=cn.concat(ut({key:Zn+"[0]",value:vn[0],valueSpec:{},style:Nt.style,styleSpec:Nt.styleSpec},vn));return Ks(vr(vn[1]))?cn.concat([new en(Zn+"[1]",vn[1],"expressions are not allowed in function stops.")]):cn.concat(Pe({key:Zn+"[1]",value:vn[1],valueSpec:P,style:Nt.style,styleSpec:Nt.styleSpec}))}function ut(Nt,cn){var vn=Io(Nt.value),Zn=jr(Nt.value),Nn=Nt.value!==null?Nt.value:cn;if(d){if(vn!==d)return[new en(Nt.key,Nn,vn+" stop domain type must match previous stop domain type "+d)]}else d=vn;if(vn!=="number"&&vn!=="string"&&vn!=="boolean")return[new en(Nt.key,Nn,"stop domain value must be a number, string, or boolean")];if(vn!=="number"&&B!=="categorical"){var fr="number expected, "+vn+" found";return uo(P)&&B===void 0&&(fr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new en(Nt.key,Nn,fr)]}return B!=="categorical"||vn!=="number"||isFinite(Zn)&&Math.floor(Zn)===Zn?B!=="categorical"&&vn==="number"&&g!==void 0&&Zn<g?[new en(Nt.key,Nn,"stop domain values must appear in ascending order")]:(g=Zn,B==="categorical"&&Zn in V?[new en(Nt.key,Nn,"stop domain values must be unique")]:(V[Zn]=!0,[])):[new en(Nt.key,Nn,"integer expected, found "+Zn)]}}function If(c){var d=(c.expressionContext==="property"?Iu:Fs)(vr(c.value),c.valueSpec);if(d.result==="error")return d.value.map(function(A){return new en(""+c.key+A.key,c.value,A.message)});var g=d.value.expression||d.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!g.outputDefined())return[new en(c.key,c.value,'Invalid data expression for "'+c.propertyKey+'". Output values must be contained as literals within the expression.')];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Mf(g))return[new en(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Mf(g))return[new en(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Jc(g,["zoom","feature-state"]))return[new en(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Qc(g))return[new en(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Lu(c){var d=c.key,g=c.value,A=c.valueSpec,P=[];return Array.isArray(A.values)?A.values.indexOf(jr(g))===-1&&P.push(new en(d,g,"expected one of ["+A.values.join(", ")+"], "+JSON.stringify(g)+" found")):Object.keys(A.values).indexOf(jr(g))===-1&&P.push(new en(d,g,"expected one of ["+Object.keys(A.values).join(", ")+"], "+JSON.stringify(g)+" found")),P}function Lf(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(var d=0,g=c.slice(1);d<g.length;d+=1){var A=g[d];if(!Lf(A)&&typeof A!="boolean")return!1}return!0;default:return!0}}du.deserialize=function(c){return new du(c._parameters,c._specification)},du.serialize=function(c){return{_parameters:c._parameters,_specification:c._specification}};var yh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Du(c){if(c==null)return{filter:function(){return!0},needGeometry:!1};Lf(c)||(c=bd(c));var d=Fs(c,yh);if(d.result==="error")throw new Error(d.value.map(function(g){return g.key+": "+g.message}).join(", "));return{filter:function(g,A,P){return d.value.evaluate(g,A,{},P)},needGeometry:function g(A){if(!Array.isArray(A))return!1;if(A[0]==="within")return!0;for(var P=1;P<A.length;P++)if(g(A[P]))return!0;return!1}(c)}}function P0(c,d){return c<d?-1:c>d?1:0}function bd(c){if(!c)return!0;var d,g=c[0];return c.length<=1?g!=="any":g==="=="?Dc(c[1],c[2],"=="):g==="!="?Gh(Dc(c[1],c[2],"==")):g==="<"||g===">"||g==="<="||g===">="?Dc(c[1],c[2],g):g==="any"?(d=c.slice(1),["any"].concat(d.map(bd))):g==="all"?["all"].concat(c.slice(1).map(bd)):g==="none"?["all"].concat(c.slice(1).map(bd).map(Gh)):g==="in"?Wh(c[1],c.slice(2)):g==="!in"?Gh(Wh(c[1],c.slice(2))):g==="has"?gp(c[1]):g==="!has"?Gh(gp(c[1])):g!=="within"||c}function Dc(c,d,g){switch(c){case"$type":return["filter-type-"+g,d];case"$id":return["filter-id-"+g,d];default:return["filter-"+g,c,d]}}function Wh(c,d){if(d.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(g){return typeof g!=typeof d[0]})?["filter-in-large",c,["literal",d.sort(P0)]]:["filter-in-small",c,["literal",d]]}}function gp(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Gh(c){return["!",c]}function _h(c){return Lf(vr(c.value))?If(Tr({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(g){var A=g.value,P=g.key;if(Io(A)!=="array")return[new en(P,A,"array expected, "+Io(A)+" found")];var B,V=g.styleSpec,Q=[];if(A.length<1)return[new en(P,A,"filter array must have at least 1 element")];switch(Q=Q.concat(Lu({key:P+"[0]",value:A[0],valueSpec:V.filter_operator,style:g.style,styleSpec:g.styleSpec})),jr(A[0])){case"<":case"<=":case">":case">=":A.length>=2&&jr(A[1])==="$type"&&Q.push(new en(P,A,'"$type" cannot be use with operator "'+A[0]+'"'));case"==":case"!=":A.length!==3&&Q.push(new en(P,A,'filter array for operator "'+A[0]+'" must have 3 elements'));case"in":case"!in":A.length>=2&&(B=Io(A[1]))!=="string"&&Q.push(new en(P+"[1]",A[1],"string expected, "+B+" found"));for(var me=2;me<A.length;me++)B=Io(A[me]),jr(A[1])==="$type"?Q=Q.concat(Lu({key:P+"["+me+"]",value:A[me],valueSpec:V.geometry_type,style:g.style,styleSpec:g.styleSpec})):B!=="string"&&B!=="number"&&B!=="boolean"&&Q.push(new en(P+"["+me+"]",A[me],"string, number, or boolean expected, "+B+" found"));break;case"any":case"all":case"none":for(var Le=1;Le<A.length;Le++)Q=Q.concat(d({key:P+"["+Le+"]",value:A[Le],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":B=Io(A[1]),A.length!==2?Q.push(new en(P,A,'filter array for "'+A[0]+'" operator must have 2 elements')):B!=="string"&&Q.push(new en(P+"[1]",A[1],"string expected, "+B+" found"));break;case"within":B=Io(A[1]),A.length!==2?Q.push(new en(P,A,'filter array for "'+A[0]+'" operator must have 2 elements')):B!=="object"&&Q.push(new en(P+"[1]",A[1],"object expected, "+B+" found"))}return Q}(c)}function Nu(c,d){var g=c.key,A=c.style,P=c.styleSpec,B=c.value,V=c.objectKey,Q=P[d+"_"+c.layerType];if(!Q)return[];var me=V.match(/^(.*)-transition$/);if(d==="paint"&&me&&Q[me[1]]&&Q[me[1]].transition)return Pe({key:g,value:B,valueSpec:P.transition,style:A,styleSpec:P});var Le,We=c.valueSpec||Q[V];if(!We)return[new en(g,B,'unknown property "'+V+'"')];if(Io(B)==="string"&&uo(We)&&!We.tokens&&(Le=/^{([^}]+)}$/.exec(B)))return[new en(g,B,'"'+V+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Le[1])+" }`.")];var rt=[];return c.layerType==="symbol"&&(V==="text-field"&&A&&!A.glyphs&&rt.push(new en(g,B,'use of "text-field" requires a style "glyphs" property')),V==="text-font"&&xa(vr(B))&&jr(B.type)==="identity"&&rt.push(new en(g,B,'"text-font" does not support identity functions'))),rt.concat(Pe({key:c.key,value:B,valueSpec:We,style:A,styleSpec:P,expressionContext:"property",propertyType:d,propertyKey:V}))}function Df(c){return Nu(c,"paint")}function Jf(c){return Nu(c,"layout")}function Yp(c){var d=[],g=c.value,A=c.key,P=c.style,B=c.styleSpec;g.type||g.ref||d.push(new en(A,g,'either "type" or "ref" is required'));var V,Q=jr(g.type),me=jr(g.ref);if(g.id)for(var Le=jr(g.id),We=0;We<c.arrayIndex;We++){var rt=P.layers[We];jr(rt.id)===Le&&d.push(new en(A,g.id,'duplicate layer id "'+g.id+'", previously used at line '+rt.id.__line__))}if("ref"in g)["type","source","source-layer","filter","layout"].forEach(function(cn){cn in g&&d.push(new en(A,g[cn],'"'+cn+'" is prohibited for ref layers'))}),P.layers.forEach(function(cn){jr(cn.id)===me&&(V=cn)}),V?V.ref?d.push(new en(A,g.ref,"ref cannot reference another ref layer")):Q=jr(V.type):d.push(new en(A,g.ref,'ref layer "'+me+'" not found'));else if(Q!=="background")if(g.source){var ut=P.sources&&P.sources[g.source],Nt=ut&&jr(ut.type);ut?Nt==="vector"&&Q==="raster"?d.push(new en(A,g.source,'layer "'+g.id+'" requires a raster source')):Nt==="raster"&&Q!=="raster"?d.push(new en(A,g.source,'layer "'+g.id+'" requires a vector source')):Nt!=="vector"||g["source-layer"]?Nt==="raster-dem"&&Q!=="hillshade"?d.push(new en(A,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!g.paint||!g.paint["line-gradient"]||Nt==="geojson"&&ut.lineMetrics||d.push(new en(A,g,'layer "'+g.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new en(A,g,'layer "'+g.id+'" must specify a "source-layer"')):d.push(new en(A,g.source,'source "'+g.source+'" not found'))}else d.push(new en(A,g,'missing required property "source"'));return d=d.concat(Lc({key:A,value:g,valueSpec:B.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Pe({key:A+".type",value:g.type,valueSpec:B.layer.type,style:c.style,styleSpec:c.styleSpec,object:g,objectKey:"type"})},filter:_h,layout:function(cn){return Lc({layer:g,key:cn.key,value:cn.value,style:cn.style,styleSpec:cn.styleSpec,objectElementValidators:{"*":function(vn){return Jf(Tr({layerType:Q},vn))}}})},paint:function(cn){return Lc({layer:g,key:cn.key,value:cn.value,style:cn.style,styleSpec:cn.styleSpec,objectElementValidators:{"*":function(vn){return Df(Tr({layerType:Q},vn))}}})}}}))}function Nf(c){var d=c.value,g=c.key,A=Io(d);return A!=="string"?[new en(g,d,"string expected, "+A+" found")]:[]}var Ja={promoteId:function(c){var d=c.key,g=c.value;if(Io(g)==="string")return Nf({key:d,value:g});var A=[];for(var P in g)A.push.apply(A,Nf({key:d+"."+P,value:g[P]}));return A}};function xd(c){var d=c.value,g=c.key,A=c.styleSpec,P=c.style;if(!d.type)return[new en(g,d,'"type" is required')];var B,V=jr(d.type);switch(V){case"vector":case"raster":case"raster-dem":return Lc({key:g,value:d,valueSpec:A["source_"+V.replace("-","_")],style:c.style,styleSpec:A,objectElementValidators:Ja});case"geojson":if(B=Lc({key:g,value:d,valueSpec:A.source_geojson,style:P,styleSpec:A,objectElementValidators:Ja}),d.cluster)for(var Q in d.clusterProperties){var me=d.clusterProperties[Q],Le=me[0],We=typeof Le=="string"?[Le,["accumulated"],["get",Q]]:Le;B.push.apply(B,If({key:g+"."+Q+".map",value:me[1],expressionContext:"cluster-map"})),B.push.apply(B,If({key:g+"."+Q+".reduce",value:We,expressionContext:"cluster-reduce"}))}return B;case"video":return Lc({key:g,value:d,valueSpec:A.source_video,style:P,styleSpec:A});case"image":return Lc({key:g,value:d,valueSpec:A.source_image,style:P,styleSpec:A});case"canvas":return[new en(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lu({key:g+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:P,styleSpec:A})}}function pu(c){var d=c.value,g=c.styleSpec,A=g.light,P=c.style,B=[],V=Io(d);if(d===void 0)return B;if(V!=="object")return B.concat([new en("light",d,"object expected, "+V+" found")]);for(var Q in d){var me=Q.match(/^(.*)-transition$/);B=B.concat(me&&A[me[1]]&&A[me[1]].transition?Pe({key:Q,value:d[Q],valueSpec:g.transition,style:P,styleSpec:g}):A[Q]?Pe({key:Q,value:d[Q],valueSpec:A[Q],style:P,styleSpec:g}):[new en(Q,d[Q],'unknown property "'+Q+'"')])}return B}var ue={"*":function(){return[]},array:Pf,boolean:function(c){var d=c.value,g=c.key,A=Io(d);return A!=="boolean"?[new en(g,d,"boolean expected, "+A+" found")]:[]},number:Hh,color:function(c){var d=c.key,g=c.value,A=Io(g);return A!=="string"?[new en(d,g,"color expected, "+A+" found")]:zn(g)===null?[new en(d,g,'color expected, "'+g+'" found')]:[]},constants:Gn,enum:Lu,filter:_h,function:Zh,layer:Yp,object:Lc,source:xd,light:pu,string:Nf,formatted:function(c){return Nf(c).length===0?[]:If(c)},resolvedImage:function(c){return Nf(c).length===0?[]:If(c)}};function Pe(c){var d=c.value,g=c.valueSpec,A=c.styleSpec;return g.expression&&xa(jr(d))?Zh(c):g.expression&&Ks(vr(d))?If(c):g.type&&ue[g.type]?ue[g.type](c):Lc(Tr({},c,{valueSpec:g.type?A[g.type]:g}))}function ct(c){var d=c.value,g=c.key,A=Nf(c);return A.length||(d.indexOf("{fontstack}")===-1&&A.push(new en(g,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&A.push(new en(g,d,'"glyphs" url must include a "{range}" token'))),A}function Sn(c,d){d===void 0&&(d=_t);var g=[];return g=g.concat(Pe({key:"",value:c,valueSpec:d.$root,styleSpec:d,style:c,objectElementValidators:{glyphs:ct,"*":function(){return[]}}})),c.constants&&(g=g.concat(Gn({key:"constants",value:c.constants,style:c,styleSpec:d}))),cr(g)}function cr(c){return[].concat(c).sort(function(d,g){return d.line-g.line})}function kr(c){return function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];return cr(c.apply(this,d))}}Sn.source=kr(xd),Sn.light=kr(pu),Sn.layer=kr(Yp),Sn.filter=kr(_h),Sn.paintProperty=kr(Df),Sn.layoutProperty=kr(Jf);var gi=Sn,$i=gi.light,pa=gi.paintProperty,Ea=gi.layoutProperty;function _s(c,d){var g=!1;if(d&&d.length)for(var A=0,P=d;A<P.length;A+=1)c.fire(new tn(new Error(P[A].message))),g=!0;return g}var za=ka;function ka(c,d,g){var A=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var P=new Int32Array(this.arrayBuffer);c=P[0],this.d=(d=P[1])+2*(g=P[2]);for(var B=0;B<this.d*this.d;B++){var V=P[3+B],Q=P[3+B+1];A.push(V===Q?null:P.subarray(V,Q))}var me=P[3+A.length+1];this.keys=P.subarray(P[3+A.length],me),this.bboxes=P.subarray(me),this.insert=this._insertReadonly}else{this.d=d+2*g;for(var Le=0;Le<this.d*this.d;Le++)A.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=c,this.padding=g,this.scale=d/c,this.uid=0;var We=g/d*c;this.min=-We,this.max=c+We}ka.prototype.insert=function(c,d,g,A,P){this._forEachCell(d,g,A,P,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(A),this.bboxes.push(P)},ka.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ka.prototype._insertCell=function(c,d,g,A,P,B){this.cells[P].push(B)},ka.prototype.query=function(c,d,g,A,P){var B=this.min,V=this.max;if(c<=B&&d<=B&&V<=g&&V<=A&&!P)return Array.prototype.slice.call(this.keys);var Q=[];return this._forEachCell(c,d,g,A,this._queryCell,Q,{},P),Q},ka.prototype._queryCell=function(c,d,g,A,P,B,V,Q){var me=this.cells[P];if(me!==null)for(var Le=this.keys,We=this.bboxes,rt=0;rt<me.length;rt++){var ut=me[rt];if(V[ut]===void 0){var Nt=4*ut;(Q?Q(We[Nt+0],We[Nt+1],We[Nt+2],We[Nt+3]):c<=We[Nt+2]&&d<=We[Nt+3]&&g>=We[Nt+0]&&A>=We[Nt+1])?(V[ut]=!0,B.push(Le[ut])):V[ut]=!1}}},ka.prototype._forEachCell=function(c,d,g,A,P,B,V,Q){for(var me=this._convertToCellCoord(c),Le=this._convertToCellCoord(d),We=this._convertToCellCoord(g),rt=this._convertToCellCoord(A),ut=me;ut<=We;ut++)for(var Nt=Le;Nt<=rt;Nt++){var cn=this.d*Nt+ut;if((!Q||Q(this._convertFromCellCoord(ut),this._convertFromCellCoord(Nt),this._convertFromCellCoord(ut+1),this._convertFromCellCoord(Nt+1)))&&P.call(this,c,d,g,A,cn,B,V,Q))return}},ka.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},ka.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},ka.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,d=3+this.cells.length+1+1,g=0,A=0;A<this.cells.length;A++)g+=this.cells[A].length;var P=new Int32Array(d+g+this.keys.length+this.bboxes.length);P[0]=this.extent,P[1]=this.n,P[2]=this.padding;for(var B=d,V=0;V<c.length;V++){var Q=c[V];P[3+V]=B,P.set(Q,B),B+=Q.length}return P[3+c.length]=B,P.set(this.keys,B),P[3+c.length+1]=B+=this.keys.length,P.set(this.bboxes,B),B+=this.bboxes.length,P.buffer};var cc=oe.ImageData,Bu=oe.ImageBitmap,qs={};function ho(c,d,g){g===void 0&&(g={}),Object.defineProperty(d,"_classRegistryKey",{value:c,writeable:!1}),qs[c]={klass:d,omit:g.omit||[],shallow:g.shallow||[]}}for(var ru in ho("Object",Object),za.serialize=function(c,d){var g=c.toArrayBuffer();return d&&d.push(g),{buffer:g}},za.deserialize=function(c){return new za(c.buffer)},ho("Grid",za),ho("Color",mn),ho("Error",Error),ho("ResolvedImage",ai),ho("StylePropertyFunction",du),ho("StyleExpression",Fa,{omit:["_evaluator"]}),ho("ZoomDependentExpression",is),ho("ZoomConstantExpression",Ec),ho("CompoundExpression",jo,{omit:["_evaluate"]}),et)et[ru]._classRegistryKey||ho("Expression_"+ru,et[ru]);function Ed(c){return c&&typeof ArrayBuffer!="undefined"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function eh(c){return Bu&&c instanceof Bu}function ml(c,d){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Ed(c)||eh(c))return d&&d.push(c),c;if(ArrayBuffer.isView(c)){var g=c;return d&&d.push(g.buffer),g}if(c instanceof cc)return d&&d.push(c.data.buffer),c;if(Array.isArray(c)){for(var A=[],P=0,B=c;P<B.length;P+=1)A.push(ml(B[P],d));return A}if(typeof c=="object"){var V=c.constructor,Q=V._classRegistryKey;if(!Q)throw new Error("can't serialize object of unregistered class");var me=V.serialize?V.serialize(c,d):{};if(!V.serialize){for(var Le in c)if(c.hasOwnProperty(Le)&&!(qs[Q].omit.indexOf(Le)>=0)){var We=c[Le];me[Le]=qs[Q].shallow.indexOf(Le)>=0?We:ml(We,d)}c instanceof Error&&(me.message=c.message)}if(me.$name)throw new Error("$name property is reserved for worker serialization logic.");return Q!=="Object"&&(me.$name=Q),me}throw new Error("can't serialize object of type "+typeof c)}function os(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Ed(c)||eh(c)||ArrayBuffer.isView(c)||c instanceof cc)return c;if(Array.isArray(c))return c.map(os);if(typeof c=="object"){var d=c.$name||"Object",g=qs[d].klass;if(!g)throw new Error("can't deserialize unregistered class "+d);if(g.deserialize)return g.deserialize(c);for(var A=Object.create(g.prototype),P=0,B=Object.keys(c);P<B.length;P+=1){var V=B[P];if(V!=="$name"){var Q=c[V];A[V]=qs[d].shallow.indexOf(V)>=0?Q:os(Q)}}return A}throw new Error("can't deserialize object of type "+typeof c)}var yp=function(){this.first=!0};yp.prototype.update=function(c,d){var g=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=d),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=g,!0))};var Ii={"Latin-1 Supplement":function(c){return c>=128&&c<=255},Arabic:function(c){return c>=1536&&c<=1791},"Arabic Supplement":function(c){return c>=1872&&c<=1919},"Arabic Extended-A":function(c){return c>=2208&&c<=2303},"Hangul Jamo":function(c){return c>=4352&&c<=4607},"Unified Canadian Aboriginal Syllabics":function(c){return c>=5120&&c<=5759},Khmer:function(c){return c>=6016&&c<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(c){return c>=6320&&c<=6399},"General Punctuation":function(c){return c>=8192&&c<=8303},"Letterlike Symbols":function(c){return c>=8448&&c<=8527},"Number Forms":function(c){return c>=8528&&c<=8591},"Miscellaneous Technical":function(c){return c>=8960&&c<=9215},"Control Pictures":function(c){return c>=9216&&c<=9279},"Optical Character Recognition":function(c){return c>=9280&&c<=9311},"Enclosed Alphanumerics":function(c){return c>=9312&&c<=9471},"Geometric Shapes":function(c){return c>=9632&&c<=9727},"Miscellaneous Symbols":function(c){return c>=9728&&c<=9983},"Miscellaneous Symbols and Arrows":function(c){return c>=11008&&c<=11263},"CJK Radicals Supplement":function(c){return c>=11904&&c<=12031},"Kangxi Radicals":function(c){return c>=12032&&c<=12255},"Ideographic Description Characters":function(c){return c>=12272&&c<=12287},"CJK Symbols and Punctuation":function(c){return c>=12288&&c<=12351},Hiragana:function(c){return c>=12352&&c<=12447},Katakana:function(c){return c>=12448&&c<=12543},Bopomofo:function(c){return c>=12544&&c<=12591},"Hangul Compatibility Jamo":function(c){return c>=12592&&c<=12687},Kanbun:function(c){return c>=12688&&c<=12703},"Bopomofo Extended":function(c){return c>=12704&&c<=12735},"CJK Strokes":function(c){return c>=12736&&c<=12783},"Katakana Phonetic Extensions":function(c){return c>=12784&&c<=12799},"Enclosed CJK Letters and Months":function(c){return c>=12800&&c<=13055},"CJK Compatibility":function(c){return c>=13056&&c<=13311},"CJK Unified Ideographs Extension A":function(c){return c>=13312&&c<=19903},"Yijing Hexagram Symbols":function(c){return c>=19904&&c<=19967},"CJK Unified Ideographs":function(c){return c>=19968&&c<=40959},"Yi Syllables":function(c){return c>=40960&&c<=42127},"Yi Radicals":function(c){return c>=42128&&c<=42191},"Hangul Jamo Extended-A":function(c){return c>=43360&&c<=43391},"Hangul Syllables":function(c){return c>=44032&&c<=55215},"Hangul Jamo Extended-B":function(c){return c>=55216&&c<=55295},"Private Use Area":function(c){return c>=57344&&c<=63743},"CJK Compatibility Ideographs":function(c){return c>=63744&&c<=64255},"Arabic Presentation Forms-A":function(c){return c>=64336&&c<=65023},"Vertical Forms":function(c){return c>=65040&&c<=65055},"CJK Compatibility Forms":function(c){return c>=65072&&c<=65103},"Small Form Variants":function(c){return c>=65104&&c<=65135},"Arabic Presentation Forms-B":function(c){return c>=65136&&c<=65279},"Halfwidth and Fullwidth Forms":function(c){return c>=65280&&c<=65519}};function th(c){for(var d=0,g=c;d<g.length;d+=1)if(Sd(g[d].charCodeAt(0)))return!0;return!1}function Sd(c){return!(c!==746&&c!==747&&(c<4352||!(Ii["Bopomofo Extended"](c)||Ii.Bopomofo(c)||Ii["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Ii["CJK Compatibility Ideographs"](c)||Ii["CJK Compatibility"](c)||Ii["CJK Radicals Supplement"](c)||Ii["CJK Strokes"](c)||!(!Ii["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Ii["CJK Unified Ideographs Extension A"](c)||Ii["CJK Unified Ideographs"](c)||Ii["Enclosed CJK Letters and Months"](c)||Ii["Hangul Compatibility Jamo"](c)||Ii["Hangul Jamo Extended-A"](c)||Ii["Hangul Jamo Extended-B"](c)||Ii["Hangul Jamo"](c)||Ii["Hangul Syllables"](c)||Ii.Hiragana(c)||Ii["Ideographic Description Characters"](c)||Ii.Kanbun(c)||Ii["Kangxi Radicals"](c)||Ii["Katakana Phonetic Extensions"](c)||Ii.Katakana(c)&&c!==12540||!(!Ii["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Ii["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Ii["Unified Canadian Aboriginal Syllabics"](c)||Ii["Unified Canadian Aboriginal Syllabics Extended"](c)||Ii["Vertical Forms"](c)||Ii["Yijing Hexagram Symbols"](c)||Ii["Yi Syllables"](c)||Ii["Yi Radicals"](c))))}function $p(c){return!(Sd(c)||function(d){return!!(Ii["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Ii["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Ii["Letterlike Symbols"](d)||Ii["Number Forms"](d)||Ii["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Ii["Control Pictures"](d)&&d!==9251||Ii["Optical Character Recognition"](d)||Ii["Enclosed Alphanumerics"](d)||Ii["Geometric Shapes"](d)||Ii["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Ii["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Ii["CJK Symbols and Punctuation"](d)||Ii.Katakana(d)||Ii["Private Use Area"](d)||Ii["CJK Compatibility Forms"](d)||Ii["Small Form Variants"](d)||Ii["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(c))}function Nc(c){return c>=1424&&c<=2303||Ii["Arabic Presentation Forms-A"](c)||Ii["Arabic Presentation Forms-B"](c)}function mu(c,d){return!(!d&&Nc(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Ii.Khmer(c))}function _p(c){for(var d=0,g=c;d<g.length;d+=1)if(Nc(g[d].charCodeAt(0)))return!0;return!1}var Kp=null,Bc="unavailable",nh=null,Jm=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Bc="error"),Kp&&Kp(c)};function Td(){bp.fire(new Et("pluginStateChange",{pluginStatus:Bc,pluginURL:nh}))}var bp=new fn,sm=function(){return Bc},Fu=function(){if(Bc!=="deferred"||!nh)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bc="loading",Td(),nh&&br({url:nh},function(c){c?Jm(c):(Bc="loaded",Td())})},vu={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Bc==="loaded"||vu.applyArabicShaping!=null},isLoading:function(){return Bc==="loading"},setState:function(c){Bc=c.pluginStatus,nh=c.pluginURL},isParsed:function(){return vu.applyArabicShaping!=null&&vu.processBidirectionalText!=null&&vu.processStyledBidirectionalText!=null},getPluginURL:function(){return nh}},ya=function(c,d){this.zoom=c,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yp,this.transition={})};ya.prototype.isSupportedScript=function(c){return function(d,g){for(var A=0,P=d;A<P.length;A+=1)if(!mu(P[A].charCodeAt(0),g))return!1;return!0}(c,vu.isLoaded())},ya.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ya.prototype.getCrossfadeParameters=function(){var c=this.zoom,d=c-Math.floor(c),g=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*d}};var ku=function(c,d){this.property=c,this.value=d,this.expression=function(g,A){if(xa(g))return new du(g,A);if(Ks(g)){var P=Iu(g,A);if(P.result==="error")throw new Error(P.value.map(function(V){return V.key+": "+V.message}).join(", "));return P.value}var B=g;return typeof g=="string"&&A.type==="color"&&(B=mn.parse(g)),{kind:"constant",evaluate:function(){return B}}}(d===void 0?c.specification.default:d,c.specification)};ku.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ku.prototype.possiblyEvaluate=function(c,d,g){return this.property.possiblyEvaluate(this,c,d,g)};var zu=function(c){this.property=c,this.value=new ku(c,void 0)};zu.prototype.transitioned=function(c,d){return new Xh(this.property,this.value,d,we({},c.transition,this.transition),c.now)},zu.prototype.untransitioned=function(){return new Xh(this.property,this.value,null,{},0)};var uc=function(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)};uc.prototype.getValue=function(c){return Re(this._values[c].value.value)},uc.prototype.setValue=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new zu(this._values[c].property)),this._values[c].value=new ku(this._values[c].property,d===null?void 0:Re(d))},uc.prototype.getTransition=function(c){return Re(this._values[c].transition)},uc.prototype.setTransition=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new zu(this._values[c].property)),this._values[c].transition=Re(d)||void 0},uc.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var A=g[d],P=this.getValue(A);P!==void 0&&(c[A]=P);var B=this.getTransition(A);B!==void 0&&(c[A+"-transition"]=B)}return c},uc.prototype.transitioned=function(c,d){for(var g=new Wl(this._properties),A=0,P=Object.keys(this._values);A<P.length;A+=1){var B=P[A];g._values[B]=this._values[B].transitioned(c,d._values[B])}return g},uc.prototype.untransitioned=function(){for(var c=new Wl(this._properties),d=0,g=Object.keys(this._values);d<g.length;d+=1){var A=g[d];c._values[A]=this._values[A].untransitioned()}return c};var Xh=function(c,d,g,A,P){this.property=c,this.value=d,this.begin=P+A.delay||0,this.end=this.begin+A.duration||0,c.specification.transition&&(A.delay||A.duration)&&(this.prior=g)};Xh.prototype.possiblyEvaluate=function(c,d,g){var A=c.now||0,P=this.value.possiblyEvaluate(c,d,g),B=this.prior;if(B){if(A>this.end)return this.prior=null,P;if(this.value.isDataDriven())return this.prior=null,P;if(A<this.begin)return B.possiblyEvaluate(c,d,g);var V=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(B.possiblyEvaluate(c,d,g),P,function(Q){if(Q<=0)return 0;if(Q>=1)return 1;var me=Q*Q,Le=me*Q;return 4*(Q<.5?Le:3*(Q-me)+Le-.75)}(V))}return P};var Wl=function(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)};Wl.prototype.possiblyEvaluate=function(c,d,g){for(var A=new xp(this._properties),P=0,B=Object.keys(this._values);P<B.length;P+=1){var V=B[P];A._values[V]=this._values[V].possiblyEvaluate(c,d,g)}return A},Wl.prototype.hasTransition=function(){for(var c=0,d=Object.keys(this._values);c<d.length;c+=1)if(this._values[d[c]].prior)return!0;return!1};var Wc=function(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)};Wc.prototype.getValue=function(c){return Re(this._values[c].value)},Wc.prototype.setValue=function(c,d){this._values[c]=new ku(this._values[c].property,d===null?void 0:Re(d))},Wc.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var A=g[d],P=this.getValue(A);P!==void 0&&(c[A]=P)}return c},Wc.prototype.possiblyEvaluate=function(c,d,g){for(var A=new xp(this._properties),P=0,B=Object.keys(this._values);P<B.length;P+=1){var V=B[P];A._values[V]=this._values[V].possiblyEvaluate(c,d,g)}return A};var iu=function(c,d,g){this.property=c,this.value=d,this.parameters=g};iu.prototype.isConstant=function(){return this.value.kind==="constant"},iu.prototype.constantOr=function(c){return this.value.kind==="constant"?this.value.value:c},iu.prototype.evaluate=function(c,d,g,A){return this.property.evaluate(this.value,this.parameters,c,d,g,A)};var xp=function(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)};xp.prototype.get=function(c){return this._values[c]};var Oo=function(c){this.specification=c};Oo.prototype.possiblyEvaluate=function(c,d){return c.expression.evaluate(d)},Oo.prototype.interpolate=function(c,d,g){var A=Ru[this.specification.type];return A?A(c,d,g):c};var So=function(c,d){this.specification=c,this.overrides=d};So.prototype.possiblyEvaluate=function(c,d,g,A){return new iu(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(d,null,{},g,A)}:c.expression,d)},So.prototype.interpolate=function(c,d,g){if(c.value.kind!=="constant"||d.value.kind!=="constant")return c;if(c.value.value===void 0||d.value.value===void 0)return new iu(this,{kind:"constant",value:void 0},c.parameters);var A=Ru[this.specification.type];return A?new iu(this,{kind:"constant",value:A(c.value.value,d.value.value,g)},c.parameters):c},So.prototype.evaluate=function(c,d,g,A,P,B){return c.kind==="constant"?c.value:c.evaluate(d,g,A,P,B)};var Uu=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,A,P,B){if(g.value===void 0)return new iu(this,{kind:"constant",value:void 0},A);if(g.expression.kind==="constant"){var V=g.expression.evaluate(A,null,{},P,B),Q=g.property.specification.type==="resolvedImage"&&typeof V!="string"?V.name:V,me=this._calculate(Q,Q,Q,A);return new iu(this,{kind:"constant",value:me},A)}if(g.expression.kind==="camera"){var Le=this._calculate(g.expression.evaluate({zoom:A.zoom-1}),g.expression.evaluate({zoom:A.zoom}),g.expression.evaluate({zoom:A.zoom+1}),A);return new iu(this,{kind:"constant",value:Le},A)}return new iu(this,g.expression,A)},d.prototype.evaluate=function(g,A,P,B,V,Q){if(g.kind==="source"){var me=g.evaluate(A,P,B,V,Q);return this._calculate(me,me,me,A)}return g.kind==="composite"?this._calculate(g.evaluate({zoom:Math.floor(A.zoom)-1},P,B),g.evaluate({zoom:Math.floor(A.zoom)},P,B),g.evaluate({zoom:Math.floor(A.zoom)+1},P,B),A):g.value},d.prototype._calculate=function(g,A,P,B){return B.zoom>B.zoomHistory.lastIntegerZoom?{from:g,to:A}:{from:P,to:A}},d.prototype.interpolate=function(g){return g},d}(So),ou=function(c){this.specification=c};ou.prototype.possiblyEvaluate=function(c,d,g,A){if(c.value!==void 0){if(c.expression.kind==="constant"){var P=c.expression.evaluate(d,null,{},g,A);return this._calculate(P,P,P,d)}return this._calculate(c.expression.evaluate(new ya(Math.floor(d.zoom-1),d)),c.expression.evaluate(new ya(Math.floor(d.zoom),d)),c.expression.evaluate(new ya(Math.floor(d.zoom+1),d)),d)}},ou.prototype._calculate=function(c,d,g,A){return A.zoom>A.zoomHistory.lastIntegerZoom?{from:c,to:d}:{from:g,to:d}},ou.prototype.interpolate=function(c){return c};var rh=function(c){this.specification=c};rh.prototype.possiblyEvaluate=function(c,d,g,A){return!!c.expression.evaluate(d,null,{},g,A)},rh.prototype.interpolate=function(){return!1};var fl=function(c){for(var d in this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],c){var g=c[d];g.specification.overridable&&this.overridableProperties.push(d);var A=this.defaultPropertyValues[d]=new ku(g,void 0),P=this.defaultTransitionablePropertyValues[d]=new zu(g);this.defaultTransitioningPropertyValues[d]=P.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=A.possiblyEvaluate({})}};ho("DataDrivenProperty",So),ho("DataConstantProperty",Oo),ho("CrossFadedDataDrivenProperty",Uu),ho("CrossFadedProperty",ou),ho("ColorRampProperty",rh);var Gc=function(c){function d(g,A){if(c.call(this),this.id=g.id,this.type=g.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},g.type!=="custom"&&(this.metadata=(g=g).metadata,this.minzoom=g.minzoom,this.maxzoom=g.maxzoom,g.type!=="background"&&(this.source=g.source,this.sourceLayer=g["source-layer"],this.filter=g.filter),A.layout&&(this._unevaluatedLayout=new Wc(A.layout)),A.paint)){for(var P in this._transitionablePaint=new uc(A.paint),g.paint)this.setPaintProperty(P,g.paint[P],{validate:!1});for(var B in g.layout)this.setLayoutProperty(B,g.layout[B],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xp(A.paint)}}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(g){return g==="visibility"?this.visibility:this._unevaluatedLayout.getValue(g)},d.prototype.setLayoutProperty=function(g,A,P){P===void 0&&(P={}),A!=null&&this._validate(Ea,"layers."+this.id+".layout."+g,g,A,P)||(g!=="visibility"?this._unevaluatedLayout.setValue(g,A):this.visibility=A)},d.prototype.getPaintProperty=function(g){return mt(g,"-transition")?this._transitionablePaint.getTransition(g.slice(0,-11)):this._transitionablePaint.getValue(g)},d.prototype.setPaintProperty=function(g,A,P){if(P===void 0&&(P={}),A!=null&&this._validate(pa,"layers."+this.id+".paint."+g,g,A,P))return!1;if(mt(g,"-transition"))return this._transitionablePaint.setTransition(g.slice(0,-11),A||void 0),!1;var B=this._transitionablePaint._values[g],V=B.property.specification["property-type"]==="cross-faded-data-driven",Q=B.value.isDataDriven(),me=B.value;this._transitionablePaint.setValue(g,A),this._handleSpecialPaintPropertyUpdate(g);var Le=this._transitionablePaint._values[g].value;return Le.isDataDriven()||Q||V||this._handleOverridablePaintPropertyUpdate(g,me,Le)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){},d.prototype._handleOverridablePaintPropertyUpdate=function(g,A,P){return!1},d.prototype.isHidden=function(g){return!!(this.minzoom&&g<this.minzoom)||!!(this.maxzoom&&g>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(g){this._transitioningPaint=this._transitionablePaint.transitioned(g,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(g,A){g.getCrossfadeParameters&&(this._crossfadeParameters=g.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(g,void 0,A)),this.paint=this._transitioningPaint.possiblyEvaluate(g,void 0,A)},d.prototype.serialize=function(){var g={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(g.layout=g.layout||{},g.layout.visibility=this.visibility),Be(g,function(A,P){return!(A===void 0||P==="layout"&&!Object.keys(A).length||P==="paint"&&!Object.keys(A).length)})},d.prototype._validate=function(g,A,P,B,V){return V===void 0&&(V={}),(!V||V.validate!==!1)&&_s(this,g.call(gi,{key:A,layerType:this.type,objectKey:P,value:B,styleSpec:_t,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var g in this.paint._values){var A=this.paint.get(g);if(A instanceof iu&&uo(A.property.specification)&&(A.value.kind==="source"||A.value.kind==="composite")&&A.value.isStateDependent)return!0}return!1},d}(fn),Bf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},wd=function(c,d){this._structArray=c,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ms=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function fc(c,d){d===void 0&&(d=1);var g=0,A=0;return{members:c.map(function(P){var B=Bf[P.type].BYTES_PER_ELEMENT,V=g=I0(g,Math.max(d,B)),Q=P.components||1;return A=Math.max(A,B),g+=B*Q,{name:P.name,type:P.type,components:Q,offset:V}}),size:I0(g,Math.max(A,d)),alignment:d}}function I0(c,d){return Math.ceil(c/d)*d}ms.serialize=function(c,d){return c._trim(),d&&(c.isTransferred=!0,d.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}},ms.deserialize=function(c){var d=Object.create(this.prototype);return d.arrayBuffer=c.arrayBuffer,d.length=c.length,d.capacity=c.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},ms.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ms.prototype.clear=function(){this.length=0},ms.prototype.resize=function(c){this.reserve(c),this.length=c},ms.prototype.reserve=function(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},ms.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Yh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A){var P=this.length;return this.resize(P+1),this.emplace(P,g,A)},d.prototype.emplace=function(g,A,P){var B=2*g;return this.int16[B+0]=A,this.int16[B+1]=P,g},d}(ms);Yh.prototype.bytesPerElement=4,ho("StructArrayLayout2i4",Yh);var qp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B){var V=this.length;return this.resize(V+1),this.emplace(V,g,A,P,B)},d.prototype.emplace=function(g,A,P,B,V){var Q=4*g;return this.int16[Q+0]=A,this.int16[Q+1]=P,this.int16[Q+2]=B,this.int16[Q+3]=V,g},d}(ms);qp.prototype.bytesPerElement=8,ho("StructArrayLayout4i8",qp);var bh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q){var me=this.length;return this.resize(me+1),this.emplace(me,g,A,P,B,V,Q)},d.prototype.emplace=function(g,A,P,B,V,Q,me){var Le=6*g;return this.int16[Le+0]=A,this.int16[Le+1]=P,this.int16[Le+2]=B,this.int16[Le+3]=V,this.int16[Le+4]=Q,this.int16[Le+5]=me,g},d}(ms);bh.prototype.bytesPerElement=12,ho("StructArrayLayout2i4i12",bh);var au=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q){var me=this.length;return this.resize(me+1),this.emplace(me,g,A,P,B,V,Q)},d.prototype.emplace=function(g,A,P,B,V,Q,me){var Le=4*g,We=8*g;return this.int16[Le+0]=A,this.int16[Le+1]=P,this.uint8[We+4]=B,this.uint8[We+5]=V,this.uint8[We+6]=Q,this.uint8[We+7]=me,g},d}(ms);au.prototype.bytesPerElement=8,ho("StructArrayLayout2i4ub8",au);var Ud=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A){var P=this.length;return this.resize(P+1),this.emplace(P,g,A)},d.prototype.emplace=function(g,A,P){var B=2*g;return this.float32[B+0]=A,this.float32[B+1]=P,g},d}(ms);Ud.prototype.bytesPerElement=8,ho("StructArrayLayout2f8",Ud);var Gr=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q,me,Le,We,rt){var ut=this.length;return this.resize(ut+1),this.emplace(ut,g,A,P,B,V,Q,me,Le,We,rt)},d.prototype.emplace=function(g,A,P,B,V,Q,me,Le,We,rt,ut){var Nt=10*g;return this.uint16[Nt+0]=A,this.uint16[Nt+1]=P,this.uint16[Nt+2]=B,this.uint16[Nt+3]=V,this.uint16[Nt+4]=Q,this.uint16[Nt+5]=me,this.uint16[Nt+6]=Le,this.uint16[Nt+7]=We,this.uint16[Nt+8]=rt,this.uint16[Nt+9]=ut,g},d}(ms);Gr.prototype.bytesPerElement=20,ho("StructArrayLayout10ui20",Gr);var ih=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q,me,Le,We,rt,ut,Nt){var cn=this.length;return this.resize(cn+1),this.emplace(cn,g,A,P,B,V,Q,me,Le,We,rt,ut,Nt)},d.prototype.emplace=function(g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn){var vn=12*g;return this.int16[vn+0]=A,this.int16[vn+1]=P,this.int16[vn+2]=B,this.int16[vn+3]=V,this.uint16[vn+4]=Q,this.uint16[vn+5]=me,this.uint16[vn+6]=Le,this.uint16[vn+7]=We,this.int16[vn+8]=rt,this.int16[vn+9]=ut,this.int16[vn+10]=Nt,this.int16[vn+11]=cn,g},d}(ms);ih.prototype.bytesPerElement=24,ho("StructArrayLayout4i4ui4i24",ih);var Xc=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,P)},d.prototype.emplace=function(g,A,P,B){var V=3*g;return this.float32[V+0]=A,this.float32[V+1]=P,this.float32[V+2]=B,g},d}(ms);Xc.prototype.bytesPerElement=12,ho("StructArrayLayout3f12",Xc);var jd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var A=this.length;return this.resize(A+1),this.emplace(A,g)},d.prototype.emplace=function(g,A){return this.uint32[1*g+0]=A,g},d}(ms);jd.prototype.bytesPerElement=4,ho("StructArrayLayout1ul4",jd);var xh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q,me,Le,We){var rt=this.length;return this.resize(rt+1),this.emplace(rt,g,A,P,B,V,Q,me,Le,We)},d.prototype.emplace=function(g,A,P,B,V,Q,me,Le,We,rt){var ut=10*g,Nt=5*g;return this.int16[ut+0]=A,this.int16[ut+1]=P,this.int16[ut+2]=B,this.int16[ut+3]=V,this.int16[ut+4]=Q,this.int16[ut+5]=me,this.uint32[Nt+3]=Le,this.uint16[ut+8]=We,this.uint16[ut+9]=rt,g},d}(ms);xh.prototype.bytesPerElement=20,ho("StructArrayLayout6i1ul2ui20",xh);var oh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q){var me=this.length;return this.resize(me+1),this.emplace(me,g,A,P,B,V,Q)},d.prototype.emplace=function(g,A,P,B,V,Q,me){var Le=6*g;return this.int16[Le+0]=A,this.int16[Le+1]=P,this.int16[Le+2]=B,this.int16[Le+3]=V,this.int16[Le+4]=Q,this.int16[Le+5]=me,g},d}(ms);oh.prototype.bytesPerElement=12,ho("StructArrayLayout2i2i2i12",oh);var ah=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V){var Q=this.length;return this.resize(Q+1),this.emplace(Q,g,A,P,B,V)},d.prototype.emplace=function(g,A,P,B,V,Q){var me=4*g,Le=8*g;return this.float32[me+0]=A,this.float32[me+1]=P,this.float32[me+2]=B,this.int16[Le+6]=V,this.int16[Le+7]=Q,g},d}(ms);ah.prototype.bytesPerElement=16,ho("StructArrayLayout2f1f2i16",ah);var Qp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B){var V=this.length;return this.resize(V+1),this.emplace(V,g,A,P,B)},d.prototype.emplace=function(g,A,P,B,V){var Q=12*g,me=3*g;return this.uint8[Q+0]=A,this.uint8[Q+1]=P,this.float32[me+1]=B,this.float32[me+2]=V,g},d}(ms);Qp.prototype.bytesPerElement=12,ho("StructArrayLayout2ub2f12",Qp);var sh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,P)},d.prototype.emplace=function(g,A,P,B){var V=3*g;return this.uint16[V+0]=A,this.uint16[V+1]=P,this.uint16[V+2]=B,g},d}(ms);sh.prototype.bytesPerElement=6,ho("StructArrayLayout3ui6",sh);var Ff=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn,Zn,Nn,fr){var yr=this.length;return this.resize(yr+1),this.emplace(yr,g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn,Zn,Nn,fr)},d.prototype.emplace=function(g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn,Zn,Nn,fr,yr){var Sr=24*g,Ir=12*g,Xr=48*g;return this.int16[Sr+0]=A,this.int16[Sr+1]=P,this.uint16[Sr+2]=B,this.uint16[Sr+3]=V,this.uint32[Ir+2]=Q,this.uint32[Ir+3]=me,this.uint32[Ir+4]=Le,this.uint16[Sr+10]=We,this.uint16[Sr+11]=rt,this.uint16[Sr+12]=ut,this.float32[Ir+7]=Nt,this.float32[Ir+8]=cn,this.uint8[Xr+36]=vn,this.uint8[Xr+37]=Zn,this.uint8[Xr+38]=Nn,this.uint32[Ir+10]=fr,this.int16[Sr+22]=yr,g},d}(ms);Ff.prototype.bytesPerElement=48,ho("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ff);var Eh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn,Zn,Nn,fr,yr,Sr,Ir,Xr,Pi,Ci,Ao,ao,Po,Wi,Aa){var ea=this.length;return this.resize(ea+1),this.emplace(ea,g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn,Zn,Nn,fr,yr,Sr,Ir,Xr,Pi,Ci,Ao,ao,Po,Wi,Aa)},d.prototype.emplace=function(g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn,Zn,Nn,fr,yr,Sr,Ir,Xr,Pi,Ci,Ao,ao,Po,Wi,Aa,ea){var yo=34*g,ma=17*g;return this.int16[yo+0]=A,this.int16[yo+1]=P,this.int16[yo+2]=B,this.int16[yo+3]=V,this.int16[yo+4]=Q,this.int16[yo+5]=me,this.int16[yo+6]=Le,this.int16[yo+7]=We,this.uint16[yo+8]=rt,this.uint16[yo+9]=ut,this.uint16[yo+10]=Nt,this.uint16[yo+11]=cn,this.uint16[yo+12]=vn,this.uint16[yo+13]=Zn,this.uint16[yo+14]=Nn,this.uint16[yo+15]=fr,this.uint16[yo+16]=yr,this.uint16[yo+17]=Sr,this.uint16[yo+18]=Ir,this.uint16[yo+19]=Xr,this.uint16[yo+20]=Pi,this.uint16[yo+21]=Ci,this.uint16[yo+22]=Ao,this.uint32[ma+12]=ao,this.float32[ma+13]=Po,this.float32[ma+14]=Wi,this.float32[ma+15]=Aa,this.float32[ma+16]=ea,g},d}(ms);Eh.prototype.bytesPerElement=68,ho("StructArrayLayout8i15ui1ul4f68",Eh);var Al=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var A=this.length;return this.resize(A+1),this.emplace(A,g)},d.prototype.emplace=function(g,A){return this.float32[1*g+0]=A,g},d}(ms);Al.prototype.bytesPerElement=4,ho("StructArrayLayout1f4",Al);var ts=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,P)},d.prototype.emplace=function(g,A,P,B){var V=3*g;return this.int16[V+0]=A,this.int16[V+1]=P,this.int16[V+2]=B,g},d}(ms);ts.prototype.bytesPerElement=6,ho("StructArrayLayout3i6",ts);var ju=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,P)},d.prototype.emplace=function(g,A,P,B){var V=4*g;return this.uint32[2*g+0]=A,this.uint16[V+2]=P,this.uint16[V+3]=B,g},d}(ms);ju.prototype.bytesPerElement=8,ho("StructArrayLayout1ul2ui8",ju);var Jp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A){var P=this.length;return this.resize(P+1),this.emplace(P,g,A)},d.prototype.emplace=function(g,A,P){var B=2*g;return this.uint16[B+0]=A,this.uint16[B+1]=P,g},d}(ms);Jp.prototype.bytesPerElement=4,ho("StructArrayLayout2ui4",Jp);var L0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var A=this.length;return this.resize(A+1),this.emplace(A,g)},d.prototype.emplace=function(g,A){return this.uint16[1*g+0]=A,g},d}(ms);L0.prototype.bytesPerElement=2,ho("StructArrayLayout1ui2",L0);var e0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,P,B){var V=this.length;return this.resize(V+1),this.emplace(V,g,A,P,B)},d.prototype.emplace=function(g,A,P,B,V){var Q=4*g;return this.float32[Q+0]=A,this.float32[Q+1]=P,this.float32[Q+2]=B,this.float32[Q+3]=V,g},d}(ms);e0.prototype.bytesPerElement=16,ho("StructArrayLayout4f16",e0);var _=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return g.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},g.x1.get=function(){return this._structArray.int16[this._pos2+2]},g.y1.get=function(){return this._structArray.int16[this._pos2+3]},g.x2.get=function(){return this._structArray.int16[this._pos2+4]},g.y2.get=function(){return this._structArray.int16[this._pos2+5]},g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.anchorPoint.get=function(){return new ae(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,g),d}(wd);_.prototype.size=20;var S=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new _(this,g)},d}(xh);ho("CollisionBoxArray",S);var x=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},g.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},g.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},g.segment.get=function(){return this._structArray.uint16[this._pos2+10]},g.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},g.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},g.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},g.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},g.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},g.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},g.placedOrientation.set=function(A){this._structArray.uint8[this._pos1+37]=A},g.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},g.hidden.set=function(A){this._structArray.uint8[this._pos1+38]=A},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},g.crossTileID.set=function(A){this._structArray.uint32[this._pos4+10]=A},g.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,g),d}(wd);x.prototype.size=48;var C=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new x(this,g)},d}(Ff);ho("PlacedSymbolArray",C);var k=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},g.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},g.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},g.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},g.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},g.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},g.key.get=function(){return this._structArray.uint16[this._pos2+8]},g.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},g.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},g.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},g.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},g.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},g.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},g.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},g.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},g.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},g.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},g.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},g.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},g.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},g.crossTileID.set=function(A){this._structArray.uint32[this._pos4+12]=A},g.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},g.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},g.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},g.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,g),d}(wd);k.prototype.size=68;var G=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new k(this,g)},d}(Eh);ho("SymbolInstanceArray",G);var q=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getoffsetX=function(g){return this.float32[1*g+0]},d}(Al);ho("GlyphOffsetArray",q);var he=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getx=function(g){return this.int16[3*g+0]},d.prototype.gety=function(g){return this.int16[3*g+1]},d.prototype.gettileUnitDistanceFromAnchor=function(g){return this.int16[3*g+2]},d}(ts);ho("SymbolLineVertexArray",he);var je=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,g),d}(wd);je.prototype.size=8;var Xe=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new je(this,g)},d}(ju);ho("FeatureIndexArray",Xe);var kt=fc([{name:"a_pos",components:2,type:"Int16"}],4).members,jt=function(c){c===void 0&&(c=[]),this.segments=c};function Yt(c,d){return 256*(c=De(Math.floor(c),0,255))+De(Math.floor(d),0,255)}jt.prototype.prepareSegment=function(c,d,g,A){var P=this.segments[this.segments.length-1];return c>jt.MAX_VERTEX_ARRAY_LENGTH&&yt("Max vertices per segment is "+jt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+c),(!P||P.vertexLength+c>jt.MAX_VERTEX_ARRAY_LENGTH||P.sortKey!==A)&&(P={vertexOffset:d.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},A!==void 0&&(P.sortKey=A),this.segments.push(P)),P},jt.prototype.get=function(){return this.segments},jt.prototype.destroy=function(){for(var c=0,d=this.segments;c<d.length;c+=1){var g=d[c];for(var A in g.vaos)g.vaos[A].destroy()}},jt.simpleSegment=function(c,d,g,A){return new jt([{vertexOffset:c,primitiveOffset:d,vertexLength:g,primitiveLength:A,vaos:{},sortKey:0}])},jt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ho("SegmentVector",jt);var gn=fc([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),pn=ve(function(c){c.exports=function(d,g){var A,P,B,V,Q,me,Le,We;for(P=d.length-(A=3&d.length),B=g,Q=3432918353,me=461845907,We=0;We<P;)Le=255&d.charCodeAt(We)|(255&d.charCodeAt(++We))<<8|(255&d.charCodeAt(++We))<<16|(255&d.charCodeAt(++We))<<24,++We,B=27492+(65535&(V=5*(65535&(B=(B^=Le=(65535&(Le=(Le=(65535&Le)*Q+(((Le>>>16)*Q&65535)<<16)&4294967295)<<15|Le>>>17))*me+(((Le>>>16)*me&65535)<<16)&4294967295)<<13|B>>>19))+((5*(B>>>16)&65535)<<16)&4294967295))+((58964+(V>>>16)&65535)<<16);switch(Le=0,A){case 3:Le^=(255&d.charCodeAt(We+2))<<16;case 2:Le^=(255&d.charCodeAt(We+1))<<8;case 1:B^=Le=(65535&(Le=(Le=(65535&(Le^=255&d.charCodeAt(We)))*Q+(((Le>>>16)*Q&65535)<<16)&4294967295)<<15|Le>>>17))*me+(((Le>>>16)*me&65535)<<16)&4294967295}return B^=d.length,B=2246822507*(65535&(B^=B>>>16))+((2246822507*(B>>>16)&65535)<<16)&4294967295,B=3266489909*(65535&(B^=B>>>13))+((3266489909*(B>>>16)&65535)<<16)&4294967295,(B^=B>>>16)>>>0}}),Cn=ve(function(c){c.exports=function(d,g){for(var A,P=d.length,B=g^P,V=0;P>=4;)A=1540483477*(65535&(A=255&d.charCodeAt(V)|(255&d.charCodeAt(++V))<<8|(255&d.charCodeAt(++V))<<16|(255&d.charCodeAt(++V))<<24))+((1540483477*(A>>>16)&65535)<<16),B=1540483477*(65535&B)+((1540483477*(B>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),P-=4,++V;switch(P){case 3:B^=(255&d.charCodeAt(V+2))<<16;case 2:B^=(255&d.charCodeAt(V+1))<<8;case 1:B=1540483477*(65535&(B^=255&d.charCodeAt(V)))+((1540483477*(B>>>16)&65535)<<16)}return B=1540483477*(65535&(B^=B>>>13))+((1540483477*(B>>>16)&65535)<<16),(B^=B>>>15)>>>0}}),un=pn,kn=Cn;un.murmur3=pn,un.murmur2=kn;var er=function(){this.ids=[],this.positions=[],this.indexed=!1};er.prototype.add=function(c,d,g,A){this.ids.push(Cr(c)),this.positions.push(d,g,A)},er.prototype.getPositions=function(c){for(var d=Cr(c),g=0,A=this.ids.length-1;g<A;){var P=g+A>>1;this.ids[P]>=d?A=P:g=P+1}for(var B=[];this.ids[g]===d;)B.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return B},er.serialize=function(c,d){var g=new Float64Array(c.ids),A=new Uint32Array(c.positions);return function P(B,V,Q,me){for(;Q<me;){for(var Le=B[Q+me>>1],We=Q-1,rt=me+1;;){do We++;while(B[We]<Le);do rt--;while(B[rt]>Le);if(We>=rt)break;dr(B,We,rt),dr(V,3*We,3*rt),dr(V,3*We+1,3*rt+1),dr(V,3*We+2,3*rt+2)}rt-Q<me-rt?(P(B,V,Q,rt),Q=rt+1):(P(B,V,rt+1,me),me=rt)}}(g,A,0,g.length-1),d&&d.push(g.buffer,A.buffer),{ids:g,positions:A}},er.deserialize=function(c){var d=new er;return d.ids=c.ids,d.positions=c.positions,d.indexed=!0,d};var ur=Math.pow(2,53)-1;function Cr(c){var d=+c;return!isNaN(d)&&d<=ur?d:un(String(c))}function dr(c,d,g){var A=c[d];c[d]=c[g],c[g]=A}ho("FeaturePositionMap",er);var Br=function(c,d){this.gl=c.gl,this.location=d},ri=function(c){function d(g,A){c.call(this,g,A),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1i(this.location,g))},d}(Br),Yr=function(c){function d(g,A){c.call(this,g,A),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1f(this.location,g))},d}(Br),wi=function(c){function d(g,A){c.call(this,g,A),this.current=[0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]||(this.current=g,this.gl.uniform2f(this.location,g[0],g[1]))},d}(Br),Hi=function(c){function d(g,A){c.call(this,g,A),this.current=[0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]||(this.current=g,this.gl.uniform3f(this.location,g[0],g[1],g[2]))},d}(Br),Lo=function(c){function d(g,A){c.call(this,g,A),this.current=[0,0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]&&g[3]===this.current[3]||(this.current=g,this.gl.uniform4f(this.location,g[0],g[1],g[2],g[3]))},d}(Br),Fo=function(c){function d(g,A){c.call(this,g,A),this.current=mn.transparent}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g.r===this.current.r&&g.g===this.current.g&&g.b===this.current.b&&g.a===this.current.a||(this.current=g,this.gl.uniform4f(this.location,g.r,g.g,g.b,g.a))},d}(Br),ko=new Float32Array(16),fa=function(c){function d(g,A){c.call(this,g,A),this.current=ko}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){if(g[12]!==this.current[12]||g[0]!==this.current[0])return this.current=g,void this.gl.uniformMatrix4fv(this.location,!1,g);for(var A=1;A<16;A++)if(g[A]!==this.current[A]){this.current=g,this.gl.uniformMatrix4fv(this.location,!1,g);break}},d}(Br);function Bn(c){return[Yt(255*c.r,255*c.g),Yt(255*c.b,255*c.a)]}var qt=function(c,d,g){this.value=c,this.uniformNames=d.map(function(A){return"u_"+A}),this.type=g};qt.prototype.setUniform=function(c,d,g){c.set(g.constantOr(this.value))},qt.prototype.getBinding=function(c,d,g){return this.type==="color"?new Fo(c,d):new Yr(c,d)};var ua=function(c,d){this.uniformNames=d.map(function(g){return"u_"+g}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ua.prototype.setConstantPatternPositions=function(c,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=c.tlbr},ua.prototype.setUniform=function(c,d,g,A){var P=A==="u_pattern_to"?this.patternTo:A==="u_pattern_from"?this.patternFrom:A==="u_pixel_ratio_to"?this.pixelRatioTo:A==="u_pixel_ratio_from"?this.pixelRatioFrom:null;P&&c.set(P)},ua.prototype.getBinding=function(c,d,g){return g.substr(0,9)==="u_pattern"?new Lo(c,d):new Yr(c,d)};var ra=function(c,d,g,A){this.expression=c,this.type=g,this.maxValue=0,this.paintVertexAttributes=d.map(function(P){return{name:"a_"+P,type:"Float32",components:g==="color"?2:1,offset:0}}),this.paintVertexArray=new A};ra.prototype.populatePaintArray=function(c,d,g,A,P){var B=this.paintVertexArray.length,V=this.expression.evaluate(new ya(0),d,{},A,[],P);this.paintVertexArray.resize(c),this._setPaintValue(B,c,V)},ra.prototype.updatePaintArray=function(c,d,g,A){var P=this.expression.evaluate({zoom:0},g,A);this._setPaintValue(c,d,P)},ra.prototype._setPaintValue=function(c,d,g){if(this.type==="color")for(var A=Bn(g),P=c;P<d;P++)this.paintVertexArray.emplace(P,A[0],A[1]);else{for(var B=c;B<d;B++)this.paintVertexArray.emplace(B,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}},ra.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ra.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ho=function(c,d,g,A,P,B){this.expression=c,this.uniformNames=d.map(function(V){return"u_"+V+"_t"}),this.type=g,this.useIntegerZoom=A,this.zoom=P,this.maxValue=0,this.paintVertexAttributes=d.map(function(V){return{name:"a_"+V,type:"Float32",components:g==="color"?4:2,offset:0}}),this.paintVertexArray=new B};Ho.prototype.populatePaintArray=function(c,d,g,A,P){var B=this.expression.evaluate(new ya(this.zoom),d,{},A,[],P),V=this.expression.evaluate(new ya(this.zoom+1),d,{},A,[],P),Q=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(Q,c,B,V)},Ho.prototype.updatePaintArray=function(c,d,g,A){var P=this.expression.evaluate({zoom:this.zoom},g,A),B=this.expression.evaluate({zoom:this.zoom+1},g,A);this._setPaintValue(c,d,P,B)},Ho.prototype._setPaintValue=function(c,d,g,A){if(this.type==="color")for(var P=Bn(g),B=Bn(A),V=c;V<d;V++)this.paintVertexArray.emplace(V,P[0],P[1],B[0],B[1]);else{for(var Q=c;Q<d;Q++)this.paintVertexArray.emplace(Q,g,A);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(A))}},Ho.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ho.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ho.prototype.setUniform=function(c,d){var g=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,A=De(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);c.set(A)},Ho.prototype.getBinding=function(c,d,g){return new Yr(c,d)};var _a=function(c,d,g,A,P,B){this.expression=c,this.type=d,this.useIntegerZoom=g,this.zoom=A,this.layerId=B,this.zoomInPaintVertexArray=new P,this.zoomOutPaintVertexArray=new P};_a.prototype.populatePaintArray=function(c,d,g){var A=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(A,c,d.patterns&&d.patterns[this.layerId],g)},_a.prototype.updatePaintArray=function(c,d,g,A,P){this._setPaintValues(c,d,g.patterns&&g.patterns[this.layerId],P)},_a.prototype._setPaintValues=function(c,d,g,A){if(A&&g){var P=A[g.min],B=A[g.mid],V=A[g.max];if(P&&B&&V)for(var Q=c;Q<d;Q++)this.zoomInPaintVertexArray.emplace(Q,B.tl[0],B.tl[1],B.br[0],B.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],B.pixelRatio,P.pixelRatio),this.zoomOutPaintVertexArray.emplace(Q,B.tl[0],B.tl[1],B.br[0],B.br[1],V.tl[0],V.tl[1],V.br[0],V.br[1],B.pixelRatio,V.pixelRatio)}},_a.prototype.upload=function(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,gn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,gn.members,this.expression.isStateDependent))},_a.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Vo=function(c,d,g){this.binders={},this._buffers=[];var A=[];for(var P in c.paint._values)if(g(P)){var B=c.paint.get(P);if(B instanceof iu&&uo(B.property.specification)){var V=hc(P,c.type),Q=B.value,me=B.property.specification.type,Le=B.property.useIntegerZoom,We=B.property.specification["property-type"],rt=We==="cross-faded"||We==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[P]=rt?new ua(Q.value,V):new qt(Q.value,V,me),A.push("/u_"+P);else if(Q.kind==="source"||rt){var ut=vl(P,me,"source");this.binders[P]=rt?new _a(Q,me,Le,d,ut,c.id):new ra(Q,V,me,ut),A.push("/a_"+P)}else{var Nt=vl(P,me,"composite");this.binders[P]=new Ho(Q,V,me,Le,d,Nt),A.push("/z_"+P)}}}this.cacheKey=A.sort().join("")};Vo.prototype.getMaxValue=function(c){var d=this.binders[c];return d instanceof ra||d instanceof Ho?d.maxValue:0},Vo.prototype.populatePaintArrays=function(c,d,g,A,P){for(var B in this.binders){var V=this.binders[B];(V instanceof ra||V instanceof Ho||V instanceof _a)&&V.populatePaintArray(c,d,g,A,P)}},Vo.prototype.setConstantPatternPositions=function(c,d){for(var g in this.binders){var A=this.binders[g];A instanceof ua&&A.setConstantPatternPositions(c,d)}},Vo.prototype.updatePaintArrays=function(c,d,g,A,P){var B=!1;for(var V in c)for(var Q=0,me=d.getPositions(V);Q<me.length;Q+=1){var Le=me[Q],We=g.feature(Le.index);for(var rt in this.binders){var ut=this.binders[rt];if((ut instanceof ra||ut instanceof Ho||ut instanceof _a)&&ut.expression.isStateDependent===!0){var Nt=A.paint.get(rt);ut.expression=Nt.value,ut.updatePaintArray(Le.start,Le.end,We,c[V],P),B=!0}}}return B},Vo.prototype.defines=function(){var c=[];for(var d in this.binders){var g=this.binders[d];(g instanceof qt||g instanceof ua)&&c.push.apply(c,g.uniformNames.map(function(A){return"#define HAS_UNIFORM_"+A}))}return c},Vo.prototype.getBinderAttributes=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof ra||g instanceof Ho)for(var A=0;A<g.paintVertexAttributes.length;A++)c.push(g.paintVertexAttributes[A].name);else if(g instanceof _a)for(var P=0;P<gn.members.length;P++)c.push(gn.members[P].name)}return c},Vo.prototype.getBinderUniforms=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof qt||g instanceof ua||g instanceof Ho)for(var A=0,P=g.uniformNames;A<P.length;A+=1)c.push(P[A])}return c},Vo.prototype.getPaintVertexBuffers=function(){return this._buffers},Vo.prototype.getUniforms=function(c,d){var g=[];for(var A in this.binders){var P=this.binders[A];if(P instanceof qt||P instanceof ua||P instanceof Ho)for(var B=0,V=P.uniformNames;B<V.length;B+=1){var Q=V[B];if(d[Q]){var me=P.getBinding(c,d[Q],Q);g.push({name:Q,property:A,binding:me})}}}return g},Vo.prototype.setUniforms=function(c,d,g,A){for(var P=0,B=d;P<B.length;P+=1){var V=B[P],Q=V.name,me=V.property;this.binders[me].setUniform(V.binding,A,g.get(me),Q)}},Vo.prototype.updatePaintBuffers=function(c){for(var d in this._buffers=[],this.binders){var g=this.binders[d];if(c&&g instanceof _a){var A=c.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;A&&this._buffers.push(A)}else(g instanceof ra||g instanceof Ho)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}},Vo.prototype.upload=function(c){for(var d in this.binders){var g=this.binders[d];(g instanceof ra||g instanceof Ho||g instanceof _a)&&g.upload(c)}this.updatePaintBuffers()},Vo.prototype.destroy=function(){for(var c in this.binders){var d=this.binders[c];(d instanceof ra||d instanceof Ho||d instanceof _a)&&d.destroy()}};var Do=function(c,d,g){g===void 0&&(g=function(){return!0}),this.programConfigurations={};for(var A=0,P=c;A<P.length;A+=1){var B=P[A];this.programConfigurations[B.id]=new Vo(B,d,g)}this.needsUpload=!1,this._featureMap=new er,this._bufferOffset=0};function hc(c,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(d+"-","").replace(/-/g,"_")]}function vl(c,d,g){var A={color:{source:Ud,composite:e0},number:{source:Al,composite:Ud}},P=function(B){return{"line-pattern":{source:Gr,composite:Gr},"fill-pattern":{source:Gr,composite:Gr},"fill-extrusion-pattern":{source:Gr,composite:Gr}}[B]}(c);return P&&P[g]||A[d][g]}Do.prototype.populatePaintArrays=function(c,d,g,A,P,B){for(var V in this.programConfigurations)this.programConfigurations[V].populatePaintArrays(c,d,A,P,B);d.id!==void 0&&this._featureMap.add(d.id,g,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0},Do.prototype.updatePaintArrays=function(c,d,g,A){for(var P=0,B=g;P<B.length;P+=1){var V=B[P];this.needsUpload=this.programConfigurations[V.id].updatePaintArrays(c,this._featureMap,d,V,A)||this.needsUpload}},Do.prototype.get=function(c){return this.programConfigurations[c]},Do.prototype.upload=function(c){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(c);this.needsUpload=!1}},Do.prototype.destroy=function(){for(var c in this.programConfigurations)this.programConfigurations[c].destroy()},ho("ConstantBinder",qt),ho("CrossFadedConstantBinder",ua),ho("SourceExpressionBinder",ra),ho("CrossFadedCompositeBinder",_a),ho("CompositeExpressionBinder",Ho),ho("ProgramConfiguration",Vo,{omit:["_buffers"]}),ho("ProgramConfigurationSet",Do);var Fc=Math.pow(2,14)-1,Gl=-Fc-1;function bs(c){for(var d=8192/c.extent,g=c.loadGeometry(),A=0;A<g.length;A++)for(var P=g[A],B=0;B<P.length;B++){var V=P[B],Q=Math.round(V.x*d),me=Math.round(V.y*d);V.x=De(Q,Gl,Fc),V.y=De(me,Gl,Fc),(Q<V.x||Q>V.x+1||me<V.y||me>V.y+1)&&yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return g}function Qs(c,d){return{type:c.type,id:c.id,properties:c.properties,geometry:d?bs(c):[]}}function ll(c,d,g,A,P){c.emplaceBack(2*d+(A+1)/2,2*g+(P+1)/2)}var gl=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Yh,this.indexArray=new sh,this.segments=new jt,this.programConfigurations=new Do(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function _f(c,d){for(var g=0;g<c.length;g++)if(bf(d,c[g]))return!0;for(var A=0;A<d.length;A++)if(bf(c,d[A]))return!0;return!!Vd(c,d)}function al(c,d,g){return!!bf(c,d)||!!Sh(d,c,g)}function sf(c,d){if(c.length===1)return $h(d,c[0]);for(var g=0;g<d.length;g++)for(var A=d[g],P=0;P<A.length;P++)if(bf(c,A[P]))return!0;for(var B=0;B<c.length;B++)if($h(d,c[B]))return!0;for(var V=0;V<d.length;V++)if(Vd(c,d[V]))return!0;return!1}function Vu(c,d,g){if(c.length>1){if(Vd(c,d))return!0;for(var A=0;A<d.length;A++)if(Sh(d[A],c,g))return!0}for(var P=0;P<c.length;P++)if(Sh(c[P],d,g))return!0;return!1}function Vd(c,d){if(c.length===0||d.length===0)return!1;for(var g=0;g<c.length-1;g++)for(var A=c[g],P=c[g+1],B=0;B<d.length-1;B++)if(kf(A,P,d[B],d[B+1]))return!0;return!1}function kf(c,d,g,A){return At(c,g,A)!==At(d,g,A)&&At(c,d,g)!==At(c,d,A)}function Sh(c,d,g){var A=g*g;if(d.length===1)return c.distSqr(d[0])<A;for(var P=1;P<d.length;P++)if(Hd(c,d[P-1],d[P])<A)return!0;return!1}function Hd(c,d,g){var A=d.distSqr(g);if(A===0)return c.distSqr(d);var P=((c.x-d.x)*(g.x-d.x)+(c.y-d.y)*(g.y-d.y))/A;return c.distSqr(P<0?d:P>1?g:g.sub(d)._mult(P)._add(d))}function $h(c,d){for(var g,A,P,B=!1,V=0;V<c.length;V++)for(var Q=0,me=(g=c[V]).length-1;Q<g.length;me=Q++)(A=g[Q]).y>d.y!=(P=g[me]).y>d.y&&d.x<(P.x-A.x)*(d.y-A.y)/(P.y-A.y)+A.x&&(B=!B);return B}function bf(c,d){for(var g=!1,A=0,P=c.length-1;A<c.length;P=A++){var B=c[A],V=c[P];B.y>d.y!=V.y>d.y&&d.x<(V.x-B.x)*(d.y-B.y)/(V.y-B.y)+B.x&&(g=!g)}return g}function Ai(c,d,g){var A=g[0],P=g[2];if(c.x<A.x&&d.x<A.x||c.x>P.x&&d.x>P.x||c.y<A.y&&d.y<A.y||c.y>P.y&&d.y>P.y)return!1;var B=At(c,d,g[0]);return B!==At(c,d,g[1])||B!==At(c,d,g[2])||B!==At(c,d,g[3])}function hl(c,d,g){var A=d.paint.get(c).value;return A.kind==="constant"?A.value:g.programConfigurations.get(d.id).getMaxValue(c)}function ba(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function xs(c,d,g,A,P){if(!d[0]&&!d[1])return c;var B=ae.convert(d)._mult(P);g==="viewport"&&B._rotate(-A);for(var V=[],Q=0;Q<c.length;Q++)V.push(c[Q].sub(B));return V}gl.prototype.populate=function(c,d,g){var A=this.layers[0],P=[],B=null;A.type==="circle"&&(B=A.layout.get("circle-sort-key"));for(var V=0,Q=c;V<Q.length;V+=1){var me=Q[V],Le=me.feature,We=me.id,rt=me.index,ut=me.sourceLayerIndex,Nt=this.layers[0]._featureFilter.needGeometry,cn=Qs(Le,Nt);if(this.layers[0]._featureFilter.filter(new ya(this.zoom),cn,g)){var vn=B?B.evaluate(cn,{},g):void 0,Zn={id:We,properties:Le.properties,type:Le.type,sourceLayerIndex:ut,index:rt,geometry:Nt?cn.geometry:bs(Le),patterns:{},sortKey:vn};P.push(Zn)}}B&&P.sort(function(Ci,Ao){return Ci.sortKey-Ao.sortKey});for(var Nn=0,fr=P;Nn<fr.length;Nn+=1){var yr=fr[Nn],Sr=yr.geometry,Ir=yr.index,Xr=yr.sourceLayerIndex,Pi=c[Ir].feature;this.addFeature(yr,Sr,Ir,g),d.featureIndex.insert(Pi,Sr,Ir,Xr,this.index)}},gl.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},gl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},gl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},gl.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,kt),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},gl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},gl.prototype.addFeature=function(c,d,g,A){for(var P=0,B=d;P<B.length;P+=1)for(var V=0,Q=B[P];V<Q.length;V+=1){var me=Q[V],Le=me.x,We=me.y;if(!(Le<0||Le>=8192||We<0||We>=8192)){var rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),ut=rt.vertexLength;ll(this.layoutVertexArray,Le,We,-1,-1),ll(this.layoutVertexArray,Le,We,1,-1),ll(this.layoutVertexArray,Le,We,1,1),ll(this.layoutVertexArray,Le,We,-1,1),this.indexArray.emplaceBack(ut,ut+1,ut+2),this.indexArray.emplaceBack(ut,ut+3,ut+2),rt.vertexLength+=4,rt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,{},A)},ho("CircleBucket",gl,{omit:["layers"]});var Fl=new fl({"circle-sort-key":new So(_t.layout_circle["circle-sort-key"])}),Hu={paint:new fl({"circle-radius":new So(_t.paint_circle["circle-radius"]),"circle-color":new So(_t.paint_circle["circle-color"]),"circle-blur":new So(_t.paint_circle["circle-blur"]),"circle-opacity":new So(_t.paint_circle["circle-opacity"]),"circle-translate":new Oo(_t.paint_circle["circle-translate"]),"circle-translate-anchor":new Oo(_t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Oo(_t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Oo(_t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new So(_t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new So(_t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new So(_t.paint_circle["circle-stroke-opacity"])}),layout:Fl},No=typeof Float32Array!="undefined"?Float32Array:Array;function kl(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Xl(c,d,g){var A=d[0],P=d[1],B=d[2],V=d[3],Q=d[4],me=d[5],Le=d[6],We=d[7],rt=d[8],ut=d[9],Nt=d[10],cn=d[11],vn=d[12],Zn=d[13],Nn=d[14],fr=d[15],yr=g[0],Sr=g[1],Ir=g[2],Xr=g[3];return c[0]=yr*A+Sr*Q+Ir*rt+Xr*vn,c[1]=yr*P+Sr*me+Ir*ut+Xr*Zn,c[2]=yr*B+Sr*Le+Ir*Nt+Xr*Nn,c[3]=yr*V+Sr*We+Ir*cn+Xr*fr,c[4]=(yr=g[4])*A+(Sr=g[5])*Q+(Ir=g[6])*rt+(Xr=g[7])*vn,c[5]=yr*P+Sr*me+Ir*ut+Xr*Zn,c[6]=yr*B+Sr*Le+Ir*Nt+Xr*Nn,c[7]=yr*V+Sr*We+Ir*cn+Xr*fr,c[8]=(yr=g[8])*A+(Sr=g[9])*Q+(Ir=g[10])*rt+(Xr=g[11])*vn,c[9]=yr*P+Sr*me+Ir*ut+Xr*Zn,c[10]=yr*B+Sr*Le+Ir*Nt+Xr*Nn,c[11]=yr*V+Sr*We+Ir*cn+Xr*fr,c[12]=(yr=g[12])*A+(Sr=g[13])*Q+(Ir=g[14])*rt+(Xr=g[15])*vn,c[13]=yr*P+Sr*me+Ir*ut+Xr*Zn,c[14]=yr*B+Sr*Le+Ir*Nt+Xr*Nn,c[15]=yr*V+Sr*We+Ir*cn+Xr*fr,c}Math.hypot||(Math.hypot=function(){for(var c=arguments,d=0,g=arguments.length;g--;)d+=c[g]*c[g];return Math.sqrt(d)});var xf,Zd=Xl;function lf(c,d,g){var A=d[0],P=d[1],B=d[2],V=d[3];return c[0]=g[0]*A+g[4]*P+g[8]*B+g[12]*V,c[1]=g[1]*A+g[5]*P+g[9]*B+g[13]*V,c[2]=g[2]*A+g[6]*P+g[10]*B+g[14]*V,c[3]=g[3]*A+g[7]*P+g[11]*B+g[15]*V,c}xf=new No(3),No!=Float32Array&&(xf[0]=0,xf[1]=0,xf[2]=0),function(){var c=new No(4);No!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0)}();var Ep=(function(){var c=new No(2);No!=Float32Array&&(c[0]=0,c[1]=0)}(),function(c){function d(g){c.call(this,g,Hu)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new gl(g)},d.prototype.queryRadius=function(g){var A=g;return hl("circle-radius",this,A)+hl("circle-stroke-width",this,A)+ba(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(g,A,P,B,V,Q,me,Le){for(var We=xs(g,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,me),rt=this.paint.get("circle-radius").evaluate(A,P)+this.paint.get("circle-stroke-width").evaluate(A,P),ut=this.paint.get("circle-pitch-alignment")==="map",Nt=ut?We:function(Pi,Ci){return Pi.map(function(Ao){return Ad(Ao,Ci)})}(We,Le),cn=ut?rt*me:rt,vn=0,Zn=B;vn<Zn.length;vn+=1)for(var Nn=0,fr=Zn[vn];Nn<fr.length;Nn+=1){var yr=fr[Nn],Sr=ut?yr:Ad(yr,Le),Ir=cn,Xr=lf([],[yr.x,yr.y,0,1],Le);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ir*=Xr[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ir*=Q.cameraToCenterDistance/Xr[3]),al(Nt,Sr,Ir))return!0}return!1},d}(Gc));function Ad(c,d){var g=lf([],[c.x,c.y,0,1],d);return new ae(g[0]/g[3],g[1]/g[3])}var Ls=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(gl);function cf(c,d,g,A){var P=d.width,B=d.height;if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==P*B*g)throw new RangeError("mismatched image size")}else A=new Uint8Array(P*B*g);return c.width=P,c.height=B,c.data=A,c}function lh(c,d,g){var A=d.width,P=d.height;if(A!==c.width||P!==c.height){var B=cf({},{width:A,height:P},g);D0(c,B,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,A),height:Math.min(c.height,P)},g),c.width=A,c.height=P,c.data=B.data}}function D0(c,d,g,A,P,B){if(P.width===0||P.height===0)return d;if(P.width>c.width||P.height>c.height||g.x>c.width-P.width||g.y>c.height-P.height)throw new RangeError("out of range source coordinates for image copy");if(P.width>d.width||P.height>d.height||A.x>d.width-P.width||A.y>d.height-P.height)throw new RangeError("out of range destination coordinates for image copy");for(var V=c.data,Q=d.data,me=0;me<P.height;me++)for(var Le=((g.y+me)*c.width+g.x)*B,We=((A.y+me)*d.width+A.x)*B,rt=0;rt<P.width*B;rt++)Q[We+rt]=V[Le+rt];return d}ho("HeatmapBucket",Ls,{omit:["layers"]});var io=function(c,d){cf(this,c,1,d)};io.prototype.resize=function(c){lh(this,c,1)},io.prototype.clone=function(){return new io({width:this.width,height:this.height},new Uint8Array(this.data))},io.copy=function(c,d,g,A,P){D0(c,d,g,A,P,1)};var gu=function(c,d){cf(this,c,4,d)};gu.prototype.resize=function(c){lh(this,c,4)},gu.prototype.replace=function(c,d){d?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c},gu.prototype.clone=function(){return new gu({width:this.width,height:this.height},new Uint8Array(this.data))},gu.copy=function(c,d,g,A,P){D0(c,d,g,A,P,4)},ho("AlphaImage",io),ho("RGBAImage",gu);var ey={paint:new fl({"heatmap-radius":new So(_t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new So(_t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Oo(_t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new rh(_t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Oo(_t.paint_heatmap["heatmap-opacity"])})};function lm(c){var d={},g=c.resolution||256,A=c.clips?c.clips.length:1,P=c.image||new gu({width:g,height:A}),B=function(cn,vn,Zn){d[c.evaluationKey]=Zn;var Nn=c.expression.evaluate(d);P.data[cn+vn+0]=Math.floor(255*Nn.r/Nn.a),P.data[cn+vn+1]=Math.floor(255*Nn.g/Nn.a),P.data[cn+vn+2]=Math.floor(255*Nn.b/Nn.a),P.data[cn+vn+3]=Math.floor(255*Nn.a)};if(c.clips)for(var V=0,Q=0;V<A;++V,Q+=4*g)for(var me=0,Le=0;me<g;me++,Le+=4){var We=me/(g-1),rt=c.clips[V];B(Q,Le,rt.start*(1-We)+rt.end*We)}else for(var ut=0,Nt=0;ut<g;ut++,Nt+=4)B(0,Nt,ut/(g-1));return P}var Sp=function(c){function d(g){c.call(this,g,ey),this._updateColorRamp()}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new Ls(g)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=lm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(Gc),ty={paint:new fl({"hillshade-illumination-direction":new Oo(_t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Oo(_t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Oo(_t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Oo(_t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Oo(_t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Oo(_t.paint_hillshade["hillshade-accent-color"])})},Gv=function(c){function d(g){c.call(this,g,ty)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(Gc),ny=fc([{name:"a_pos",components:2,type:"Int16"}],4).members,cm=N0,um=N0;function N0(c,d,g){g=g||2;var A,P,B,V,Q,me,Le,We=d&&d.length,rt=We?d[0]*g:c.length,ut=ry(c,0,rt,g,!0),Nt=[];if(!ut||ut.next===ut.prev)return Nt;if(We&&(ut=function(vn,Zn,Nn,fr){var yr,Sr,Ir,Xr=[];for(yr=0,Sr=Zn.length;yr<Sr;yr++)(Ir=ry(vn,Zn[yr]*fr,yr<Sr-1?Zn[yr+1]*fr:vn.length,fr,!1))===Ir.next&&(Ir.steiner=!0),Xr.push(B0(Ir));for(Xr.sort(t0),yr=0;yr<Xr.length;yr++)Kh(Xr[yr],Nn),Nn=Tp(Nn,Nn.next);return Nn}(c,d,ut,g)),c.length>80*g){A=B=c[0],P=V=c[1];for(var cn=g;cn<rt;cn+=g)(Q=c[cn])<A&&(A=Q),(me=c[cn+1])<P&&(P=me),Q>B&&(B=Q),me>V&&(V=me);Le=(Le=Math.max(B-A,V-P))!==0?1/Le:0}return wp(ut,Nt,g,A,P,Le),Nt}function ry(c,d,g,A,P){var B,V;if(P===n0(c,d,g,A)>0)for(B=d;B<g;B+=A)V=Qh(B,c[B],c[B+1],V);else for(B=g-A;B>=d;B-=A)V=Qh(B,c[B],c[B+1],V);return V&&Ef(V,V.next)&&(yl(V),V=V.next),V}function Tp(c,d){if(!c)return c;d||(d=c);var g,A=c;do if(g=!1,A.steiner||!Ef(A,A.next)&&Js(A.prev,A,A.next)!==0)A=A.next;else{if(yl(A),(A=d=A.prev)===A.next)break;g=!0}while(g||A!==d);return d}function wp(c,d,g,A,P,B,V){if(c){!V&&B&&function(We,rt,ut,Nt){var cn=We;do cn.z===null&&(cn.z=qh(cn.x,cn.y,rt,ut,Nt)),cn.prevZ=cn.prev,cn.nextZ=cn.next,cn=cn.next;while(cn!==We);cn.prevZ.nextZ=null,cn.prevZ=null,function(vn){var Zn,Nn,fr,yr,Sr,Ir,Xr,Pi,Ci=1;do{for(Nn=vn,vn=null,Sr=null,Ir=0;Nn;){for(Ir++,fr=Nn,Xr=0,Zn=0;Zn<Ci&&(Xr++,fr=fr.nextZ);Zn++);for(Pi=Ci;Xr>0||Pi>0&&fr;)Xr!==0&&(Pi===0||!fr||Nn.z<=fr.z)?(yr=Nn,Nn=Nn.nextZ,Xr--):(yr=fr,fr=fr.nextZ,Pi--),Sr?Sr.nextZ=yr:vn=yr,yr.prevZ=Sr,Sr=yr;Nn=fr}Sr.nextZ=null,Ci*=2}while(Ir>1)}(cn)}(c,A,P,B);for(var Q,me,Le=c;c.prev!==c.next;)if(Q=c.prev,me=c.next,B?tv(c,A,P,B):ev(c))d.push(Q.i/g),d.push(c.i/g),d.push(me.i/g),yl(c),c=me.next,Le=me.next;else if((c=me)===Le){V?V===1?wp(c=iy(Tp(c),d,g),d,g,A,P,B,2):V===2&&Wd(c,d,g,A,P,B):wp(Tp(c),d,g,A,P,B,1);break}}}function ev(c){var d=c.prev,g=c,A=c.next;if(Js(d,g,A)>=0)return!1;for(var P=c.next.next;P!==c.prev;){if(Yc(d.x,d.y,g.x,g.y,A.x,A.y,P.x,P.y)&&Js(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function tv(c,d,g,A){var P=c.prev,B=c,V=c.next;if(Js(P,B,V)>=0)return!1;for(var Q=P.x>B.x?P.x>V.x?P.x:V.x:B.x>V.x?B.x:V.x,me=P.y>B.y?P.y>V.y?P.y:V.y:B.y>V.y?B.y:V.y,Le=qh(P.x<B.x?P.x<V.x?P.x:V.x:B.x<V.x?B.x:V.x,P.y<B.y?P.y<V.y?P.y:V.y:B.y<V.y?B.y:V.y,d,g,A),We=qh(Q,me,d,g,A),rt=c.prevZ,ut=c.nextZ;rt&&rt.z>=Le&&ut&&ut.z<=We;){if(rt!==c.prev&&rt!==c.next&&Yc(P.x,P.y,B.x,B.y,V.x,V.y,rt.x,rt.y)&&Js(rt.prev,rt,rt.next)>=0||(rt=rt.prevZ,ut!==c.prev&&ut!==c.next&&Yc(P.x,P.y,B.x,B.y,V.x,V.y,ut.x,ut.y)&&Js(ut.prev,ut,ut.next)>=0))return!1;ut=ut.nextZ}for(;rt&&rt.z>=Le;){if(rt!==c.prev&&rt!==c.next&&Yc(P.x,P.y,B.x,B.y,V.x,V.y,rt.x,rt.y)&&Js(rt.prev,rt,rt.next)>=0)return!1;rt=rt.prevZ}for(;ut&&ut.z<=We;){if(ut!==c.prev&&ut!==c.next&&Yc(P.x,P.y,B.x,B.y,V.x,V.y,ut.x,ut.y)&&Js(ut.prev,ut,ut.next)>=0)return!1;ut=ut.nextZ}return!0}function iy(c,d,g){var A=c;do{var P=A.prev,B=A.next.next;!Ef(P,B)&&F0(P,A,A.next,B)&&dc(P,B)&&dc(B,P)&&(d.push(P.i/g),d.push(A.i/g),d.push(B.i/g),yl(A),yl(A.next),A=c=B),A=A.next}while(A!==c);return Tp(A)}function Wd(c,d,g,A,P,B){var V=c;do{for(var Q=V.next.next;Q!==V.prev;){if(V.i!==Q.i&&Ap(V,Q)){var me=Xd(V,Q);return V=Tp(V,V.next),me=Tp(me,me.next),wp(V,d,g,A,P,B),void wp(me,d,g,A,P,B)}Q=Q.next}V=V.next}while(V!==c)}function t0(c,d){return c.x-d.x}function Kh(c,d){if(d=function(A,P){var B,V=P,Q=A.x,me=A.y,Le=-1/0;do{if(me<=V.y&&me>=V.next.y&&V.next.y!==V.y){var We=V.x+(me-V.y)*(V.next.x-V.x)/(V.next.y-V.y);if(We<=Q&&We>Le){if(Le=We,We===Q){if(me===V.y)return V;if(me===V.next.y)return V.next}B=V.x<V.next.x?V:V.next}}V=V.next}while(V!==P);if(!B)return null;if(Q===Le)return B;var rt,ut=B,Nt=B.x,cn=B.y,vn=1/0;V=B;do Q>=V.x&&V.x>=Nt&&Q!==V.x&&Yc(me<cn?Q:Le,me,Nt,cn,me<cn?Le:Q,me,V.x,V.y)&&(rt=Math.abs(me-V.y)/(Q-V.x),dc(V,A)&&(rt<vn||rt===vn&&(V.x>B.x||V.x===B.x&&nv(B,V)))&&(B=V,vn=rt)),V=V.next;while(V!==ut);return B}(c,d)){var g=Xd(d,c);Tp(d,d.next),Tp(g,g.next)}}function nv(c,d){return Js(c.prev,c,d.prev)<0&&Js(d.next,c,c.next)<0}function qh(c,d,g,A,P){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-g)*P)|c<<8))|c<<4))|c<<2))|c<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-A)*P)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function B0(c){var d=c,g=c;do(d.x<g.x||d.x===g.x&&d.y<g.y)&&(g=d),d=d.next;while(d!==c);return g}function Yc(c,d,g,A,P,B,V,Q){return(P-V)*(d-Q)-(c-V)*(B-Q)>=0&&(c-V)*(A-Q)-(g-V)*(d-Q)>=0&&(g-V)*(B-Q)-(P-V)*(A-Q)>=0}function Ap(c,d){return c.next.i!==d.i&&c.prev.i!==d.i&&!function(g,A){var P=g;do{if(P.i!==g.i&&P.next.i!==g.i&&P.i!==A.i&&P.next.i!==A.i&&F0(P,P.next,g,A))return!0;P=P.next}while(P!==g);return!1}(c,d)&&(dc(c,d)&&dc(d,c)&&function(g,A){var P=g,B=!1,V=(g.x+A.x)/2,Q=(g.y+A.y)/2;do P.y>Q!=P.next.y>Q&&P.next.y!==P.y&&V<(P.next.x-P.x)*(Q-P.y)/(P.next.y-P.y)+P.x&&(B=!B),P=P.next;while(P!==g);return B}(c,d)&&(Js(c.prev,c,d.prev)||Js(c,d.prev,d))||Ef(c,d)&&Js(c.prev,c,c.next)>0&&Js(d.prev,d,d.next)>0)}function Js(c,d,g){return(d.y-c.y)*(g.x-d.x)-(d.x-c.x)*(g.y-d.y)}function Ef(c,d){return c.x===d.x&&c.y===d.y}function F0(c,d,g,A){var P=Cp(Js(c,d,g)),B=Cp(Js(c,d,A)),V=Cp(Js(g,A,c)),Q=Cp(Js(g,A,d));return P!==B&&V!==Q||!(P!==0||!Gd(c,g,d))||!(B!==0||!Gd(c,A,d))||!(V!==0||!Gd(g,c,A))||!(Q!==0||!Gd(g,d,A))}function Gd(c,d,g){return d.x<=Math.max(c.x,g.x)&&d.x>=Math.min(c.x,g.x)&&d.y<=Math.max(c.y,g.y)&&d.y>=Math.min(c.y,g.y)}function Cp(c){return c>0?1:c<0?-1:0}function dc(c,d){return Js(c.prev,c,c.next)<0?Js(c,d,c.next)>=0&&Js(c,c.prev,d)>=0:Js(c,d,c.prev)<0||Js(c,c.next,d)<0}function Xd(c,d){var g=new Op(c.i,c.x,c.y),A=new Op(d.i,d.x,d.y),P=c.next,B=d.prev;return c.next=d,d.prev=c,g.next=P,P.prev=g,A.next=g,g.prev=A,B.next=A,A.prev=B,A}function Qh(c,d,g,A){var P=new Op(c,d,g);return A?(P.next=A.next,P.prev=A,A.next.prev=P,A.next=P):(P.prev=P,P.next=P),P}function yl(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Op(c,d,g){this.i=c,this.x=d,this.y=g,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function n0(c,d,g,A){for(var P=0,B=d,V=g-A;B<g;B+=A)P+=(c[V]-c[B])*(c[B+1]+c[V+1]),V=B;return P}function fm(c,d,g,A,P){(function B(V,Q,me,Le,We){for(;Le>me;){if(Le-me>600){var rt=Le-me+1,ut=Q-me+1,Nt=Math.log(rt),cn=.5*Math.exp(2*Nt/3),vn=.5*Math.sqrt(Nt*cn*(rt-cn)/rt)*(ut-rt/2<0?-1:1);B(V,Q,Math.max(me,Math.floor(Q-ut*cn/rt+vn)),Math.min(Le,Math.floor(Q+(rt-ut)*cn/rt+vn)),We)}var Zn=V[Q],Nn=me,fr=Le;for(Th(V,me,Q),We(V[Le],Zn)>0&&Th(V,me,Le);Nn<fr;){for(Th(V,Nn,fr),Nn++,fr--;We(V[Nn],Zn)<0;)Nn++;for(;We(V[fr],Zn)>0;)fr--}We(V[me],Zn)===0?Th(V,me,fr):Th(V,++fr,Le),fr<=Q&&(me=fr+1),Q<=fr&&(Le=fr-1)}})(c,d,g||0,A||c.length-1,P||su)}function Th(c,d,g){var A=c[d];c[d]=c[g],c[g]=A}function su(c,d){return c<d?-1:c>d?1:0}function yu(c,d){var g=c.length;if(g<=1)return[c];for(var A,P,B=[],V=0;V<g;V++){var Q=bn(c[V]);Q!==0&&(c[V].area=Math.abs(Q),P===void 0&&(P=Q<0),P===Q<0?(A&&B.push(A),A=[c[V]]):A.push(c[V]))}if(A&&B.push(A),d>1)for(var me=0;me<B.length;me++)B[me].length<=d||(fm(B[me],d,1,B[me].length-1,r0),B[me]=B[me].slice(0,d));return B}function r0(c,d){return d.area-c.area}function i0(c,d,g){for(var A=g.patternDependencies,P=!1,B=0,V=d;B<V.length;B+=1){var Q=V[B].paint.get(c+"-pattern");Q.isConstant()||(P=!0);var me=Q.constantOr(null);me&&(P=!0,A[me.to]=!0,A[me.from]=!0)}return P}function Rp(c,d,g,A,P){for(var B=P.patternDependencies,V=0,Q=d;V<Q.length;V+=1){var me=Q[V],Le=me.paint.get(c+"-pattern").value;if(Le.kind!=="constant"){var We=Le.evaluate({zoom:A-1},g,{},P.availableImages),rt=Le.evaluate({zoom:A},g,{},P.availableImages),ut=Le.evaluate({zoom:A+1},g,{},P.availableImages);rt=rt&&rt.name?rt.name:rt,ut=ut&&ut.name?ut.name:ut,B[We=We&&We.name?We.name:We]=!0,B[rt]=!0,B[ut]=!0,g.patterns[me.id]={min:We,mid:rt,max:ut}}}return g}N0.deviation=function(c,d,g,A){var P=d&&d.length,B=Math.abs(n0(c,0,P?d[0]*g:c.length,g));if(P)for(var V=0,Q=d.length;V<Q;V++)B-=Math.abs(n0(c,d[V]*g,V<Q-1?d[V+1]*g:c.length,g));var me=0;for(V=0;V<A.length;V+=3){var Le=A[V]*g,We=A[V+1]*g,rt=A[V+2]*g;me+=Math.abs((c[Le]-c[rt])*(c[We+1]-c[Le+1])-(c[Le]-c[We])*(c[rt+1]-c[Le+1]))}return B===0&&me===0?0:Math.abs((me-B)/B)},N0.flatten=function(c){for(var d=c[0][0].length,g={vertices:[],holes:[],dimensions:d},A=0,P=0;P<c.length;P++){for(var B=0;B<c[P].length;B++)for(var V=0;V<d;V++)g.vertices.push(c[P][B][V]);P>0&&g.holes.push(A+=c[P-1].length)}return g},cm.default=um;var Sf=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yh,this.indexArray=new sh,this.indexArray2=new Jp,this.programConfigurations=new Do(c.layers,c.zoom),this.segments=new jt,this.segments2=new jt,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};Sf.prototype.populate=function(c,d,g){this.hasPattern=i0("fill",this.layers,d);for(var A=this.layers[0].layout.get("fill-sort-key"),P=[],B=0,V=c;B<V.length;B+=1){var Q=V[B],me=Q.feature,Le=Q.id,We=Q.index,rt=Q.sourceLayerIndex,ut=this.layers[0]._featureFilter.needGeometry,Nt=Qs(me,ut);if(this.layers[0]._featureFilter.filter(new ya(this.zoom),Nt,g)){var cn=A?A.evaluate(Nt,{},g,d.availableImages):void 0,vn={id:Le,properties:me.properties,type:me.type,sourceLayerIndex:rt,index:We,geometry:ut?Nt.geometry:bs(me),patterns:{},sortKey:cn};P.push(vn)}}A&&P.sort(function(Pi,Ci){return Pi.sortKey-Ci.sortKey});for(var Zn=0,Nn=P;Zn<Nn.length;Zn+=1){var fr=Nn[Zn],yr=fr.geometry,Sr=fr.index,Ir=fr.sourceLayerIndex;if(this.hasPattern){var Xr=Rp("fill",this.layers,fr,this.zoom,d);this.patternFeatures.push(Xr)}else this.addFeature(fr,yr,Sr,g,{});d.featureIndex.insert(c[Sr].feature,yr,Sr,Ir,this.index)}},Sf.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Sf.prototype.addFeatures=function(c,d,g){for(var A=0,P=this.patternFeatures;A<P.length;A+=1){var B=P[A];this.addFeature(B,B.geometry,B.index,d,g)}},Sf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Sf.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Sf.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ny),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0},Sf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Sf.prototype.addFeature=function(c,d,g,A,P){for(var B=0,V=yu(d,500);B<V.length;B+=1){for(var Q=V[B],me=0,Le=0,We=Q;Le<We.length;Le+=1)me+=We[Le].length;for(var rt=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray),ut=rt.vertexLength,Nt=[],cn=[],vn=0,Zn=Q;vn<Zn.length;vn+=1){var Nn=Zn[vn];if(Nn.length!==0){Nn!==Q[0]&&cn.push(Nt.length/2);var fr=this.segments2.prepareSegment(Nn.length,this.layoutVertexArray,this.indexArray2),yr=fr.vertexLength;this.layoutVertexArray.emplaceBack(Nn[0].x,Nn[0].y),this.indexArray2.emplaceBack(yr+Nn.length-1,yr),Nt.push(Nn[0].x),Nt.push(Nn[0].y);for(var Sr=1;Sr<Nn.length;Sr++)this.layoutVertexArray.emplaceBack(Nn[Sr].x,Nn[Sr].y),this.indexArray2.emplaceBack(yr+Sr-1,yr+Sr),Nt.push(Nn[Sr].x),Nt.push(Nn[Sr].y);fr.vertexLength+=Nn.length,fr.primitiveLength+=Nn.length}}for(var Ir=cm(Nt,cn),Xr=0;Xr<Ir.length;Xr+=3)this.indexArray.emplaceBack(ut+Ir[Xr],ut+Ir[Xr+1],ut+Ir[Xr+2]);rt.vertexLength+=me,rt.primitiveLength+=Ir.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,P,A)},ho("FillBucket",Sf,{omit:["layers","patternFeatures"]});var Cd=new fl({"fill-sort-key":new So(_t.layout_fill["fill-sort-key"])}),oy={paint:new fl({"fill-antialias":new Oo(_t.paint_fill["fill-antialias"]),"fill-opacity":new So(_t.paint_fill["fill-opacity"]),"fill-color":new So(_t.paint_fill["fill-color"]),"fill-outline-color":new So(_t.paint_fill["fill-outline-color"]),"fill-translate":new Oo(_t.paint_fill["fill-translate"]),"fill-translate-anchor":new Oo(_t.paint_fill["fill-translate-anchor"]),"fill-pattern":new Uu(_t.paint_fill["fill-pattern"])}),layout:Cd},ay=function(c){function d(g){c.call(this,g,oy)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,A){c.prototype.recalculate.call(this,g,A);var P=this.paint._values["fill-outline-color"];P.value.kind==="constant"&&P.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(g){return new Sf(g)},d.prototype.queryRadius=function(){return ba(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(g,A,P,B,V,Q,me){return sf(xs(g,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,me),B)},d.prototype.isTileClipped=function(){return!0},d}(Gc),rv=fc([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,k0=Jh;function Jh(c,d,g,A,P){this.properties={},this.extent=g,this.type=0,this._pbf=c,this._geometry=-1,this._keys=A,this._values=P,c.readFields(hm,this,d)}function hm(c,d,g){c==1?d.id=g.readVarint():c==2?function(A,P){for(var B=A.readVarint()+A.pos;A.pos<B;){var V=P._keys[A.readVarint()],Q=P._values[A.readVarint()];P.properties[V]=Q}}(g,d):c==3?d.type=g.readVarint():c==4&&(d._geometry=g.pos)}function zf(c){for(var d,g,A=0,P=0,B=c.length,V=B-1;P<B;V=P++)A+=((g=c[V]).x-(d=c[P]).x)*(d.y+g.y);return A}Jh.types=["Unknown","Point","LineString","Polygon"],Jh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d,g=c.readVarint()+c.pos,A=1,P=0,B=0,V=0,Q=[];c.pos<g;){if(P<=0){var me=c.readVarint();A=7&me,P=me>>3}if(P--,A===1||A===2)B+=c.readSVarint(),V+=c.readSVarint(),A===1&&(d&&Q.push(d),d=[]),d.push(new ae(B,V));else{if(A!==7)throw new Error("unknown command "+A);d&&d.push(d[0].clone())}}return d&&Q.push(d),Q},Jh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,g=1,A=0,P=0,B=0,V=1/0,Q=-1/0,me=1/0,Le=-1/0;c.pos<d;){if(A<=0){var We=c.readVarint();g=7&We,A=We>>3}if(A--,g===1||g===2)(P+=c.readSVarint())<V&&(V=P),P>Q&&(Q=P),(B+=c.readSVarint())<me&&(me=B),B>Le&&(Le=B);else if(g!==7)throw new Error("unknown command "+g)}return[V,me,Q,Le]},Jh.prototype.toGeoJSON=function(c,d,g){var A,P,B=this.extent*Math.pow(2,g),V=this.extent*c,Q=this.extent*d,me=this.loadGeometry(),Le=Jh.types[this.type];function We(Nt){for(var cn=0;cn<Nt.length;cn++){var vn=Nt[cn];Nt[cn]=[360*(vn.x+V)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(vn.y+Q)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var rt=[];for(A=0;A<me.length;A++)rt[A]=me[A][0];We(me=rt);break;case 2:for(A=0;A<me.length;A++)We(me[A]);break;case 3:for(me=function(Nt){var cn=Nt.length;if(cn<=1)return[Nt];for(var vn,Zn,Nn=[],fr=0;fr<cn;fr++){var yr=zf(Nt[fr]);yr!==0&&(Zn===void 0&&(Zn=yr<0),Zn===yr<0?(vn&&Nn.push(vn),vn=[Nt[fr]]):vn.push(Nt[fr]))}return vn&&Nn.push(vn),Nn}(me),A=0;A<me.length;A++)for(P=0;P<me[A].length;P++)We(me[A][P])}me.length===1?me=me[0]:Le="Multi"+Le;var ut={type:"Feature",geometry:{type:Le,coordinates:me},properties:this.properties};return"id"in this&&(ut.id=this.id),ut};var o0=Yd;function Yd(c,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields($d,this,d),this.length=this._features.length}function $d(c,d,g){c===15?d.version=g.readVarint():c===1?d.name=g.readString():c===5?d.extent=g.readVarint():c===2?d._features.push(g.pos):c===3?d._keys.push(g.readString()):c===4&&d._values.push(function(A){for(var P=null,B=A.readVarint()+A.pos;A.pos<B;){var V=A.readVarint()>>3;P=V===1?A.readString():V===2?A.readFloat():V===3?A.readDouble():V===4?A.readVarint64():V===5?A.readVarint():V===6?A.readSVarint():V===7?A.readBoolean():null}return P}(g))}function iv(c,d,g){if(c===3){var A=new o0(g,g.readVarint()+g.pos);A.length&&(d[A.name]=A)}}Yd.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var d=this._pbf.readVarint()+this._pbf.pos;return new k0(this._pbf,d,this.extent,this._keys,this._values)};var wh={VectorTile:function(c,d){this.layers=c.readFields(iv,{},d)},VectorTileFeature:k0,VectorTileLayer:o0},a0=wh.VectorTileFeature.types,Mp=Math.pow(2,13);function _u(c,d,g,A,P,B,V,Q){c.emplaceBack(d,g,2*Math.floor(A*Mp)+V,P*Mp*2,B*Mp*2,Math.round(Q))}var lu=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new bh,this.indexArray=new sh,this.programConfigurations=new Do(c.layers,c.zoom),this.segments=new jt,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function pc(c,d){return c.x===d.x&&(c.x<0||c.x>8192)||c.y===d.y&&(c.y<0||c.y>8192)}lu.prototype.populate=function(c,d,g){this.features=[],this.hasPattern=i0("fill-extrusion",this.layers,d);for(var A=0,P=c;A<P.length;A+=1){var B=P[A],V=B.feature,Q=B.id,me=B.index,Le=B.sourceLayerIndex,We=this.layers[0]._featureFilter.needGeometry,rt=Qs(V,We);if(this.layers[0]._featureFilter.filter(new ya(this.zoom),rt,g)){var ut={id:Q,sourceLayerIndex:Le,index:me,geometry:We?rt.geometry:bs(V),properties:V.properties,type:V.type,patterns:{}};this.hasPattern?this.features.push(Rp("fill-extrusion",this.layers,ut,this.zoom,d)):this.addFeature(ut,ut.geometry,me,g,{}),d.featureIndex.insert(V,ut.geometry,me,Le,this.index,!0)}}},lu.prototype.addFeatures=function(c,d,g){for(var A=0,P=this.features;A<P.length;A+=1){var B=P[A];this.addFeature(B,B.geometry,B.index,d,g)}},lu.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},lu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},lu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},lu.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,rv),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},lu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},lu.prototype.addFeature=function(c,d,g,A,P){for(var B=0,V=yu(d,500);B<V.length;B+=1){for(var Q=V[B],me=0,Le=0,We=Q;Le<We.length;Le+=1)me+=We[Le].length;for(var rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ut=0,Nt=Q;ut<Nt.length;ut+=1){var cn=Nt[ut];if(cn.length!==0&&!((ma=cn).every(function(Ma){return Ma.x<0})||ma.every(function(Ma){return Ma.x>8192})||ma.every(function(Ma){return Ma.y<0})||ma.every(function(Ma){return Ma.y>8192})))for(var vn=0,Zn=0;Zn<cn.length;Zn++){var Nn=cn[Zn];if(Zn>=1){var fr=cn[Zn-1];if(!pc(Nn,fr)){rt.vertexLength+4>jt.MAX_VERTEX_ARRAY_LENGTH&&(rt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var yr=Nn.sub(fr)._perp()._unit(),Sr=fr.dist(Nn);vn+Sr>32768&&(vn=0),_u(this.layoutVertexArray,Nn.x,Nn.y,yr.x,yr.y,0,0,vn),_u(this.layoutVertexArray,Nn.x,Nn.y,yr.x,yr.y,0,1,vn),_u(this.layoutVertexArray,fr.x,fr.y,yr.x,yr.y,0,0,vn+=Sr),_u(this.layoutVertexArray,fr.x,fr.y,yr.x,yr.y,0,1,vn);var Ir=rt.vertexLength;this.indexArray.emplaceBack(Ir,Ir+2,Ir+1),this.indexArray.emplaceBack(Ir+1,Ir+2,Ir+3),rt.vertexLength+=4,rt.primitiveLength+=2}}}}if(rt.vertexLength+me>jt.MAX_VERTEX_ARRAY_LENGTH&&(rt=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray)),a0[c.type]==="Polygon"){for(var Xr=[],Pi=[],Ci=rt.vertexLength,Ao=0,ao=Q;Ao<ao.length;Ao+=1){var Po=ao[Ao];if(Po.length!==0){Po!==Q[0]&&Pi.push(Xr.length/2);for(var Wi=0;Wi<Po.length;Wi++){var Aa=Po[Wi];_u(this.layoutVertexArray,Aa.x,Aa.y,0,0,1,1,0),Xr.push(Aa.x),Xr.push(Aa.y)}}}for(var ea=cm(Xr,Pi),yo=0;yo<ea.length;yo+=3)this.indexArray.emplaceBack(Ci+ea[yo],Ci+ea[yo+2],Ci+ea[yo+1]);rt.primitiveLength+=ea.length/3,rt.vertexLength+=me}}var ma;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,P,A)},ho("FillExtrusionBucket",lu,{omit:["layers","features"]});var Zu={paint:new fl({"fill-extrusion-opacity":new Oo(_t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new So(_t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Oo(_t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Oo(_t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Uu(_t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new So(_t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new So(_t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Oo(_t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},bu=function(c){function d(g){c.call(this,g,Zu)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new lu(g)},d.prototype.queryRadius=function(){return ba(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(g,A,P,B,V,Q,me,Le){var We=xs(g,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,me),rt=this.paint.get("fill-extrusion-height").evaluate(A,P),ut=this.paint.get("fill-extrusion-base").evaluate(A,P),Nt=function(vn,Zn,Nn,fr){for(var yr=[],Sr=0,Ir=vn;Sr<Ir.length;Sr+=1){var Xr=Ir[Sr],Pi=[Xr.x,Xr.y,0,1];lf(Pi,Pi,Zn),yr.push(new ae(Pi[0]/Pi[3],Pi[1]/Pi[3]))}return yr}(We,Le),cn=function(vn,Zn,Nn,fr){for(var yr=[],Sr=[],Ir=fr[8]*Zn,Xr=fr[9]*Zn,Pi=fr[10]*Zn,Ci=fr[11]*Zn,Ao=fr[8]*Nn,ao=fr[9]*Nn,Po=fr[10]*Nn,Wi=fr[11]*Nn,Aa=0,ea=vn;Aa<ea.length;Aa+=1){for(var yo=[],ma=[],Ma=0,ns=ea[Aa];Ma<ns.length;Ma+=1){var Wo=ns[Ma],Cs=Wo.x,bl=Wo.y,Ul=fr[0]*Cs+fr[4]*bl+fr[12],jl=fr[1]*Cs+fr[5]*bl+fr[13],xl=fr[2]*Cs+fr[6]*bl+fr[14],nc=fr[3]*Cs+fr[7]*bl+fr[15],Hs=xl+Pi,wc=nc+Ci,Xu=Ul+Ao,zc=jl+ao,uu=xl+Po,Vl=nc+Wi,Uc=new ae((Ul+Ir)/wc,(jl+Xr)/wc);Uc.z=Hs/wc,yo.push(Uc);var es=new ae(Xu/Vl,zc/Vl);es.z=uu/Vl,ma.push(es)}yr.push(yo),Sr.push(ma)}return[yr,Sr]}(B,ut,rt,Le);return function(vn,Zn,Nn){var fr=1/0;sf(Nn,Zn)&&(fr=dm(Nn,Zn[0]));for(var yr=0;yr<Zn.length;yr++)for(var Sr=Zn[yr],Ir=vn[yr],Xr=0;Xr<Sr.length-1;Xr++){var Pi=Sr[Xr],Ci=[Pi,Sr[Xr+1],Ir[Xr+1],Ir[Xr],Pi];_f(Nn,Ci)&&(fr=Math.min(fr,dm(Nn,Ci)))}return fr!==1/0&&fr}(cn[0],cn[1],Nt)},d}(Gc);function Pp(c,d){return c.x*d.x+c.y*d.y}function dm(c,d){if(c.length===1){for(var g,A=0,P=d[A++];!g||P.equals(g);)if(!(g=d[A++]))return 1/0;for(;A<d.length;A++){var B=d[A],V=c[0],Q=g.sub(P),me=B.sub(P),Le=V.sub(P),We=Pp(Q,Q),rt=Pp(Q,me),ut=Pp(me,me),Nt=Pp(Le,Q),cn=Pp(Le,me),vn=We*ut-rt*rt,Zn=(ut*Nt-rt*cn)/vn,Nn=(We*cn-rt*Nt)/vn,fr=P.z*(1-Zn-Nn)+g.z*Zn+B.z*Nn;if(isFinite(fr))return fr}return 1/0}for(var yr=1/0,Sr=0,Ir=d;Sr<Ir.length;Sr+=1)yr=Math.min(yr,Ir[Sr].z);return yr}var A1=fc([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Xv=fc([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,z0=wh.VectorTileFeature.types,U0=Math.cos(Math.PI/180*37.5),ov=Math.pow(2,14)/.5,cu=function(c){var d=this;this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(g){return g.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(g){d.gradients[g.id]={}}),this.layoutVertexArray=new au,this.layoutVertexArray2=new Ud,this.indexArray=new sh,this.programConfigurations=new Do(c.layers,c.zoom),this.segments=new jt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(g){return g.isStateDependent()}).map(function(g){return g.id})};cu.prototype.populate=function(c,d,g){this.hasPattern=i0("line",this.layers,d);for(var A=this.layers[0].layout.get("line-sort-key"),P=[],B=0,V=c;B<V.length;B+=1){var Q=V[B],me=Q.feature,Le=Q.id,We=Q.index,rt=Q.sourceLayerIndex,ut=this.layers[0]._featureFilter.needGeometry,Nt=Qs(me,ut);if(this.layers[0]._featureFilter.filter(new ya(this.zoom),Nt,g)){var cn=A?A.evaluate(Nt,{},g):void 0,vn={id:Le,properties:me.properties,type:me.type,sourceLayerIndex:rt,index:We,geometry:ut?Nt.geometry:bs(me),patterns:{},sortKey:cn};P.push(vn)}}A&&P.sort(function(Pi,Ci){return Pi.sortKey-Ci.sortKey});for(var Zn=0,Nn=P;Zn<Nn.length;Zn+=1){var fr=Nn[Zn],yr=fr.geometry,Sr=fr.index,Ir=fr.sourceLayerIndex;if(this.hasPattern){var Xr=Rp("line",this.layers,fr,this.zoom,d);this.patternFeatures.push(Xr)}else this.addFeature(fr,yr,Sr,g,{});d.featureIndex.insert(c[Sr].feature,yr,Sr,Ir,this.index)}},cu.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},cu.prototype.addFeatures=function(c,d,g){for(var A=0,P=this.patternFeatures;A<P.length;A+=1){var B=P[A];this.addFeature(B,B.geometry,B.index,d,g)}},cu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},cu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},cu.prototype.upload=function(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,Xv)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,A1),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},cu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},cu.prototype.lineFeatureClips=function(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}},cu.prototype.addFeature=function(c,d,g,A,P){var B=this.layers[0].layout,V=B.get("line-join").evaluate(c,{}),Q=B.get("line-cap"),me=B.get("line-miter-limit"),Le=B.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(var We=0,rt=d;We<rt.length;We+=1)this.addLine(rt[We],c,V,Q,me,Le);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,P,A)},cu.prototype.addLine=function(c,d,g,A,P,B){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var V=0;V<c.length-1;V++)this.totalDistance+=c[V].dist(c[V+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var Q=z0[d.type]==="Polygon",me=c.length;me>=2&&c[me-1].equals(c[me-2]);)me--;for(var Le=0;Le<me-1&&c[Le].equals(c[Le+1]);)Le++;if(!(me<(Q?3:2))){g==="bevel"&&(P=1.05);var We,rt=this.overscaling<=16?122880/(512*this.overscaling):0,ut=this.segments.prepareSegment(10*me,this.layoutVertexArray,this.indexArray),Nt=void 0,cn=void 0,vn=void 0,Zn=void 0;this.e1=this.e2=-1,Q&&(Zn=c[Le].sub(We=c[me-2])._unit()._perp());for(var Nn=Le;Nn<me;Nn++)if(!(cn=Nn===me-1?Q?c[Le+1]:void 0:c[Nn+1])||!c[Nn].equals(cn)){Zn&&(vn=Zn),We&&(Nt=We),We=c[Nn],Zn=cn?cn.sub(We)._unit()._perp():vn;var fr=(vn=vn||Zn).add(Zn);fr.x===0&&fr.y===0||fr._unit();var yr=vn.x*Zn.x+vn.y*Zn.y,Sr=fr.x*Zn.x+fr.y*Zn.y,Ir=Sr!==0?1/Sr:1/0,Xr=2*Math.sqrt(2-2*Sr),Pi=Sr<U0&&Nt&&cn,Ci=vn.x*Zn.y-vn.y*Zn.x>0;if(Pi&&Nn>Le){var Ao=We.dist(Nt);if(Ao>2*rt){var ao=We.sub(We.sub(Nt)._mult(rt/Ao)._round());this.updateDistance(Nt,ao),this.addCurrentVertex(ao,vn,0,0,ut),Nt=ao}}var Po=Nt&&cn,Wi=Po?g:Q?"butt":A;if(Po&&Wi==="round"&&(Ir<B?Wi="miter":Ir<=2&&(Wi="fakeround")),Wi==="miter"&&Ir>P&&(Wi="bevel"),Wi==="bevel"&&(Ir>2&&(Wi="flipbevel"),Ir<P&&(Wi="miter")),Nt&&this.updateDistance(Nt,We),Wi==="miter")fr._mult(Ir),this.addCurrentVertex(We,fr,0,0,ut);else if(Wi==="flipbevel"){if(Ir>100)fr=Zn.mult(-1);else{var Aa=Ir*vn.add(Zn).mag()/vn.sub(Zn).mag();fr._perp()._mult(Aa*(Ci?-1:1))}this.addCurrentVertex(We,fr,0,0,ut),this.addCurrentVertex(We,fr.mult(-1),0,0,ut)}else if(Wi==="bevel"||Wi==="fakeround"){var ea=-Math.sqrt(Ir*Ir-1),yo=Ci?ea:0,ma=Ci?0:ea;if(Nt&&this.addCurrentVertex(We,vn,yo,ma,ut),Wi==="fakeround")for(var Ma=Math.round(180*Xr/Math.PI/20),ns=1;ns<Ma;ns++){var Wo=ns/Ma;if(Wo!==.5){var Cs=Wo-.5;Wo+=Wo*Cs*(Wo-1)*((1.0904+yr*(yr*(3.55645-1.43519*yr)-3.2452))*Cs*Cs+(.848013+yr*(.215638*yr-1.06021)))}var bl=Zn.sub(vn)._mult(Wo)._add(vn)._unit()._mult(Ci?-1:1);this.addHalfVertex(We,bl.x,bl.y,!1,Ci,0,ut)}cn&&this.addCurrentVertex(We,Zn,-yo,-ma,ut)}else if(Wi==="butt")this.addCurrentVertex(We,fr,0,0,ut);else if(Wi==="square"){var Ul=Nt?1:-1;this.addCurrentVertex(We,fr,Ul,Ul,ut)}else Wi==="round"&&(Nt&&(this.addCurrentVertex(We,vn,0,0,ut),this.addCurrentVertex(We,vn,1,1,ut,!0)),cn&&(this.addCurrentVertex(We,Zn,-1,-1,ut,!0),this.addCurrentVertex(We,Zn,0,0,ut)));if(Pi&&Nn<me-1){var jl=We.dist(cn);if(jl>2*rt){var xl=We.add(cn.sub(We)._mult(rt/jl)._round());this.updateDistance(We,xl),this.addCurrentVertex(xl,Zn,0,0,ut),We=xl}}}}},cu.prototype.addCurrentVertex=function(c,d,g,A,P,B){B===void 0&&(B=!1);var V=d.y*A-d.x,Q=-d.y-d.x*A;this.addHalfVertex(c,d.x+d.y*g,d.y-d.x*g,B,!1,g,P),this.addHalfVertex(c,V,Q,B,!0,-A,P),this.distance>ov/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(c,d,g,A,P,B))},cu.prototype.addHalfVertex=function(c,d,g,A,P,B,V){var Q=.5*(this.lineClips?this.scaledDistance*(ov-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c.x<<1)+(A?1:0),(c.y<<1)+(P?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(B===0?0:B<0?-1:1)|(63&Q)<<2,Q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var me=V.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,me),V.primitiveLength++),P?this.e2=me:this.e1=me},cu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},cu.prototype.updateDistance=function(c,d){this.distance+=c.dist(d),this.updateScaledDistance()},ho("LineBucket",cu,{omit:["layers","patternFeatures"]});var pm=new fl({"line-cap":new Oo(_t.layout_line["line-cap"]),"line-join":new So(_t.layout_line["line-join"]),"line-miter-limit":new Oo(_t.layout_line["line-miter-limit"]),"line-round-limit":new Oo(_t.layout_line["line-round-limit"]),"line-sort-key":new So(_t.layout_line["line-sort-key"])}),Cl={paint:new fl({"line-opacity":new So(_t.paint_line["line-opacity"]),"line-color":new So(_t.paint_line["line-color"]),"line-translate":new Oo(_t.paint_line["line-translate"]),"line-translate-anchor":new Oo(_t.paint_line["line-translate-anchor"]),"line-width":new So(_t.paint_line["line-width"]),"line-gap-width":new So(_t.paint_line["line-gap-width"]),"line-offset":new So(_t.paint_line["line-offset"]),"line-blur":new So(_t.paint_line["line-blur"]),"line-dasharray":new ou(_t.paint_line["line-dasharray"]),"line-pattern":new Uu(_t.paint_line["line-pattern"]),"line-gradient":new rh(_t.paint_line["line-gradient"])}),layout:pm},Wu=new(function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,A){return A=new ya(Math.floor(A.zoom),{now:A.now,fadeDuration:A.fadeDuration,zoomHistory:A.zoomHistory,transition:A.transition}),c.prototype.possiblyEvaluate.call(this,g,A)},d.prototype.evaluate=function(g,A,P,B){return A=we({},A,{zoom:Math.floor(A.zoom)}),c.prototype.evaluate.call(this,g,A,P,B)},d}(So))(Cl.paint.properties["line-width"].specification);Wu.useIntegerZoom=!0;var Ah=function(c){function d(g){c.call(this,g,Cl),this.gradientVersion=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ac,this.gradientVersion=(this.gradientVersion+1)%ze)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(g,A){c.prototype.recalculate.call(this,g,A),this.paint._values["line-floorwidth"]=Wu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)},d.prototype.createBucket=function(g){return new cu(g)},d.prototype.queryRadius=function(g){var A=g,P=Ch(hl("line-width",this,A),hl("line-gap-width",this,A)),B=hl("line-offset",this,A);return P/2+Math.abs(B)+ba(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(g,A,P,B,V,Q,me){var Le=xs(g,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,me),We=me/2*Ch(this.paint.get("line-width").evaluate(A,P),this.paint.get("line-gap-width").evaluate(A,P)),rt=this.paint.get("line-offset").evaluate(A,P);return rt&&(B=function(ut,Nt){for(var cn=[],vn=new ae(0,0),Zn=0;Zn<ut.length;Zn++){for(var Nn=ut[Zn],fr=[],yr=0;yr<Nn.length;yr++){var Sr=Nn[yr],Ir=Nn[yr+1],Xr=yr===0?vn:Sr.sub(Nn[yr-1])._unit()._perp(),Pi=yr===Nn.length-1?vn:Ir.sub(Sr)._unit()._perp(),Ci=Xr._add(Pi)._unit();Ci._mult(1/(Ci.x*Pi.x+Ci.y*Pi.y)),fr.push(Ci._mult(Nt)._add(Sr))}cn.push(fr)}return cn}(B,rt*me)),function(ut,Nt,cn){for(var vn=0;vn<Nt.length;vn++){var Zn=Nt[vn];if(ut.length>=3){for(var Nn=0;Nn<Zn.length;Nn++)if(bf(ut,Zn[Nn]))return!0}if(Vu(ut,Zn,cn))return!0}return!1}(Le,B,We)},d.prototype.isTileClipped=function(){return!0},d}(Gc);function Ch(c,d){return d>0?d+2*c:c}var av=fc([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yv=fc([{name:"a_projected_pos",components:3,type:"Float32"}],4),$v=(fc([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),fc([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Kv=(fc([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),fc([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fe=fc([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Qt(c,d,g){return c.sections.forEach(function(A){A.text=function(P,B,V){var Q=B.layout.get("text-transform").evaluate(V,{});return Q==="uppercase"?P=P.toLocaleUpperCase():Q==="lowercase"&&(P=P.toLocaleLowerCase()),vu.applyArabicShaping&&(P=vu.applyArabicShaping(P)),P}(A.text,d,g)}),c}fc([{name:"triangle",components:3,type:"Uint16"}]),fc([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),fc([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),fc([{type:"Float32",name:"offsetX"}]),fc([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var On={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Or=function(c,d,g,A,P){var B,V,Q=8*P-A-1,me=(1<<Q)-1,Le=me>>1,We=-7,rt=g?P-1:0,ut=g?-1:1,Nt=c[d+rt];for(rt+=ut,B=Nt&(1<<-We)-1,Nt>>=-We,We+=Q;We>0;B=256*B+c[d+rt],rt+=ut,We-=8);for(V=B&(1<<-We)-1,B>>=-We,We+=A;We>0;V=256*V+c[d+rt],rt+=ut,We-=8);if(B===0)B=1-Le;else{if(B===me)return V?NaN:1/0*(Nt?-1:1);V+=Math.pow(2,A),B-=Le}return(Nt?-1:1)*V*Math.pow(2,B-A)},Wr=function(c,d,g,A,P,B){var V,Q,me,Le=8*B-P-1,We=(1<<Le)-1,rt=We>>1,ut=P===23?Math.pow(2,-24)-Math.pow(2,-77):0,Nt=A?0:B-1,cn=A?1:-1,vn=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(Q=isNaN(d)?1:0,V=We):(V=Math.floor(Math.log(d)/Math.LN2),d*(me=Math.pow(2,-V))<1&&(V--,me*=2),(d+=V+rt>=1?ut/me:ut*Math.pow(2,1-rt))*me>=2&&(V++,me/=2),V+rt>=We?(Q=0,V=We):V+rt>=1?(Q=(d*me-1)*Math.pow(2,P),V+=rt):(Q=d*Math.pow(2,rt-1)*Math.pow(2,P),V=0));P>=8;c[g+Nt]=255&Q,Nt+=cn,Q/=256,P-=8);for(V=V<<P|Q,Le+=P;Le>0;c[g+Nt]=255&V,Nt+=cn,V/=256,Le-=8);c[g+Nt-cn]|=128*vn},Rr=_r;function _r(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}_r.Varint=0,_r.Fixed64=1,_r.Bytes=2,_r.Fixed32=5;var Ti=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function li(c){return c.type===_r.Bytes?c.readVarint()+c.pos:c.pos+1}function Fi(c,d,g){return g?4294967296*d+(c>>>0):4294967296*(d>>>0)+(c>>>0)}function Ri(c,d,g){var A=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));g.realloc(A);for(var P=g.pos-1;P>=c;P--)g.buf[P+A]=g.buf[P]}function Di(c,d){for(var g=0;g<c.length;g++)d.writeVarint(c[g])}function Xi(c,d){for(var g=0;g<c.length;g++)d.writeSVarint(c[g])}function pi(c,d){for(var g=0;g<c.length;g++)d.writeFloat(c[g])}function Ni(c,d){for(var g=0;g<c.length;g++)d.writeDouble(c[g])}function pr(c,d){for(var g=0;g<c.length;g++)d.writeBoolean(c[g])}function Lr(c,d){for(var g=0;g<c.length;g++)d.writeFixed32(c[g])}function yi(c,d){for(var g=0;g<c.length;g++)d.writeSFixed32(c[g])}function eo(c,d){for(var g=0;g<c.length;g++)d.writeFixed64(c[g])}function ii(c,d){for(var g=0;g<c.length;g++)d.writeSFixed64(c[g])}function oo(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+16777216*c[d+3]}function xi(c,d,g){c[g]=d,c[g+1]=d>>>8,c[g+2]=d>>>16,c[g+3]=d>>>24}function to(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+(c[d+3]<<24)}function si(c,d,g){c===1&&g.readMessage(Yi,d)}function Yi(c,d,g){if(c===3){var A=g.readMessage(Bo,{}),P=A.width,B=A.height,V=A.left,Q=A.top,me=A.advance;d.push({id:A.id,bitmap:new io({width:P+6,height:B+6},A.bitmap),metrics:{width:P,height:B,left:V,top:Q,advance:me}})}}function Bo(c,d,g){c===1?d.id=g.readVarint():c===2?d.bitmap=g.readBytes():c===3?d.width=g.readVarint():c===4?d.height=g.readVarint():c===5?d.left=g.readSVarint():c===6?d.top=g.readSVarint():c===7&&(d.advance=g.readVarint())}function ha(c){for(var d=0,g=0,A=0,P=c;A<P.length;A+=1){var B=P[A];d+=B.w*B.h,g=Math.max(g,B.w)}c.sort(function(vn,Zn){return Zn.h-vn.h});for(var V=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),g),h:1/0}],Q=0,me=0,Le=0,We=c;Le<We.length;Le+=1)for(var rt=We[Le],ut=V.length-1;ut>=0;ut--){var Nt=V[ut];if(!(rt.w>Nt.w||rt.h>Nt.h)){if(rt.x=Nt.x,rt.y=Nt.y,me=Math.max(me,rt.y+rt.h),Q=Math.max(Q,rt.x+rt.w),rt.w===Nt.w&&rt.h===Nt.h){var cn=V.pop();ut<V.length&&(V[ut]=cn)}else rt.h===Nt.h?(Nt.x+=rt.w,Nt.w-=rt.w):rt.w===Nt.w?(Nt.y+=rt.h,Nt.h-=rt.h):(V.push({x:Nt.x+rt.w,y:Nt.y,w:Nt.w-rt.w,h:rt.h}),Nt.y+=rt.h,Nt.h-=rt.h);break}}return{w:Q,h:me,fill:d/(Q*me)||0}}_r.prototype={destroy:function(){this.buf=null},readFields:function(c,d,g){for(g=g||this.length;this.pos<g;){var A=this.readVarint(),P=A>>3,B=this.pos;this.type=7&A,c(P,d,this),this.pos===B&&this.skip(A)}return d},readMessage:function(c,d){return this.readFields(c,d,this.readVarint()+this.pos)},readFixed32:function(){var c=oo(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=to(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=oo(this.buf,this.pos)+4294967296*oo(this.buf,this.pos+4);return this.pos+=8,c},readSFixed64:function(){var c=oo(this.buf,this.pos)+4294967296*to(this.buf,this.pos+4);return this.pos+=8,c},readFloat:function(){var c=Or(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=Or(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var d,g,A=this.buf;return d=127&(g=A[this.pos++]),g<128?d:(d|=(127&(g=A[this.pos++]))<<7,g<128?d:(d|=(127&(g=A[this.pos++]))<<14,g<128?d:(d|=(127&(g=A[this.pos++]))<<21,g<128?d:function(P,B,V){var Q,me,Le=V.buf;if(Q=(112&(me=Le[V.pos++]))>>4,me<128||(Q|=(127&(me=Le[V.pos++]))<<3,me<128)||(Q|=(127&(me=Le[V.pos++]))<<10,me<128)||(Q|=(127&(me=Le[V.pos++]))<<17,me<128)||(Q|=(127&(me=Le[V.pos++]))<<24,me<128)||(Q|=(1&(me=Le[V.pos++]))<<31,me<128))return Fi(P,Q,B);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(g=A[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,d=this.pos;return this.pos=c,c-d>=12&&Ti?function(g,A,P){return Ti.decode(g.subarray(A,P))}(this.buf,d,c):function(g,A,P){for(var B="",V=A;V<P;){var Q,me,Le,We=g[V],rt=null,ut=We>239?4:We>223?3:We>191?2:1;if(V+ut>P)break;ut===1?We<128&&(rt=We):ut===2?(192&(Q=g[V+1]))==128&&(rt=(31&We)<<6|63&Q)<=127&&(rt=null):ut===3?(me=g[V+2],(192&(Q=g[V+1]))==128&&(192&me)==128&&((rt=(15&We)<<12|(63&Q)<<6|63&me)<=2047||rt>=55296&&rt<=57343)&&(rt=null)):ut===4&&(me=g[V+2],Le=g[V+3],(192&(Q=g[V+1]))==128&&(192&me)==128&&(192&Le)==128&&((rt=(15&We)<<18|(63&Q)<<12|(63&me)<<6|63&Le)<=65535||rt>=1114112)&&(rt=null)),rt===null?(rt=65533,ut=1):rt>65535&&(rt-=65536,B+=String.fromCharCode(rt>>>10&1023|55296),rt=56320|1023&rt),B+=String.fromCharCode(rt),V+=ut}return B}(this.buf,d,c)},readBytes:function(){var c=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,c);return this.pos=c,d},readPackedVarint:function(c,d){if(this.type!==_r.Bytes)return c.push(this.readVarint(d));var g=li(this);for(c=c||[];this.pos<g;)c.push(this.readVarint(d));return c},readPackedSVarint:function(c){if(this.type!==_r.Bytes)return c.push(this.readSVarint());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==_r.Bytes)return c.push(this.readBoolean());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==_r.Bytes)return c.push(this.readFloat());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==_r.Bytes)return c.push(this.readDouble());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==_r.Bytes)return c.push(this.readFixed32());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==_r.Bytes)return c.push(this.readSFixed32());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==_r.Bytes)return c.push(this.readFixed64());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==_r.Bytes)return c.push(this.readSFixed64());var d=li(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed64());return c},skip:function(c){var d=7&c;if(d===_r.Varint)for(;this.buf[this.pos++]>127;);else if(d===_r.Bytes)this.pos=this.readVarint()+this.pos;else if(d===_r.Fixed32)this.pos+=4;else{if(d!==_r.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(c,d){this.writeVarint(c<<3|d)},realloc:function(c){for(var d=this.length||16;d<this.pos+c;)d*=2;if(d!==this.length){var g=new Uint8Array(d);g.set(this.buf),this.buf=g,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),xi(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),xi(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),xi(this.buf,-1&c,this.pos),xi(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),xi(this.buf,-1&c,this.pos),xi(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(d,g){var A,P;if(d>=0?(A=d%4294967296|0,P=d/4294967296|0):(P=~(-d/4294967296),4294967295^(A=~(-d%4294967296))?A=A+1|0:(A=0,P=P+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(B,V,Q){Q.buf[Q.pos++]=127&B|128,B>>>=7,Q.buf[Q.pos++]=127&B|128,B>>>=7,Q.buf[Q.pos++]=127&B|128,B>>>=7,Q.buf[Q.pos++]=127&B|128,Q.buf[Q.pos]=127&(B>>>=7)}(A,0,g),function(B,V){var Q=(7&B)<<4;V.buf[V.pos++]|=Q|((B>>>=3)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B)))))}(P,g)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var d=this.pos;this.pos=function(A,P,B){for(var V,Q,me=0;me<P.length;me++){if((V=P.charCodeAt(me))>55295&&V<57344){if(!Q){V>56319||me+1===P.length?(A[B++]=239,A[B++]=191,A[B++]=189):Q=V;continue}if(V<56320){A[B++]=239,A[B++]=191,A[B++]=189,Q=V;continue}V=Q-55296<<10|V-56320|65536,Q=null}else Q&&(A[B++]=239,A[B++]=191,A[B++]=189,Q=null);V<128?A[B++]=V:(V<2048?A[B++]=V>>6|192:(V<65536?A[B++]=V>>12|224:(A[B++]=V>>18|240,A[B++]=V>>12&63|128),A[B++]=V>>6&63|128),A[B++]=63&V|128)}return B}(this.buf,c,this.pos);var g=this.pos-d;g>=128&&Ri(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g},writeFloat:function(c){this.realloc(4),Wr(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),Wr(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var d=c.length;this.writeVarint(d),this.realloc(d);for(var g=0;g<d;g++)this.buf[this.pos++]=c[g]},writeRawMessage:function(c,d){this.pos++;var g=this.pos;c(d,this);var A=this.pos-g;A>=128&&Ri(g,A,this),this.pos=g-1,this.writeVarint(A),this.pos+=A},writeMessage:function(c,d,g){this.writeTag(c,_r.Bytes),this.writeRawMessage(d,g)},writePackedVarint:function(c,d){d.length&&this.writeMessage(c,Di,d)},writePackedSVarint:function(c,d){d.length&&this.writeMessage(c,Xi,d)},writePackedBoolean:function(c,d){d.length&&this.writeMessage(c,pr,d)},writePackedFloat:function(c,d){d.length&&this.writeMessage(c,pi,d)},writePackedDouble:function(c,d){d.length&&this.writeMessage(c,Ni,d)},writePackedFixed32:function(c,d){d.length&&this.writeMessage(c,Lr,d)},writePackedSFixed32:function(c,d){d.length&&this.writeMessage(c,yi,d)},writePackedFixed64:function(c,d){d.length&&this.writeMessage(c,eo,d)},writePackedSFixed64:function(c,d){d.length&&this.writeMessage(c,ii,d)},writeBytesField:function(c,d){this.writeTag(c,_r.Bytes),this.writeBytes(d)},writeFixed32Field:function(c,d){this.writeTag(c,_r.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(c,d){this.writeTag(c,_r.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(c,d){this.writeTag(c,_r.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(c,d){this.writeTag(c,_r.Fixed64),this.writeSFixed64(d)},writeVarintField:function(c,d){this.writeTag(c,_r.Varint),this.writeVarint(d)},writeSVarintField:function(c,d){this.writeTag(c,_r.Varint),this.writeSVarint(d)},writeStringField:function(c,d){this.writeTag(c,_r.Bytes),this.writeString(d)},writeFloatField:function(c,d){this.writeTag(c,_r.Fixed32),this.writeFloat(d)},writeDoubleField:function(c,d){this.writeTag(c,_r.Fixed64),this.writeDouble(d)},writeBooleanField:function(c,d){this.writeVarintField(c,!!d)}};var Ki=function(c,d){var g=d.pixelRatio,A=d.version,P=d.stretchX,B=d.stretchY,V=d.content;this.paddedRect=c,this.pixelRatio=g,this.stretchX=P,this.stretchY=B,this.content=V,this.version=A},Ei={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Ei.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Ei.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Ei.tlbr.get=function(){return this.tl.concat(this.br)},Ei.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ki.prototype,Ei);var $r=function(c,d){var g={},A={};this.haveRenderCallbacks=[];var P=[];this.addImages(c,g,P),this.addImages(d,A,P);var B=ha(P),V=new gu({width:B.w||1,height:B.h||1});for(var Q in c){var me=c[Q],Le=g[Q].paddedRect;gu.copy(me.data,V,{x:0,y:0},{x:Le.x+1,y:Le.y+1},me.data)}for(var We in d){var rt=d[We],ut=A[We].paddedRect,Nt=ut.x+1,cn=ut.y+1,vn=rt.data.width,Zn=rt.data.height;gu.copy(rt.data,V,{x:0,y:0},{x:Nt,y:cn},rt.data),gu.copy(rt.data,V,{x:0,y:Zn-1},{x:Nt,y:cn-1},{width:vn,height:1}),gu.copy(rt.data,V,{x:0,y:0},{x:Nt,y:cn+Zn},{width:vn,height:1}),gu.copy(rt.data,V,{x:vn-1,y:0},{x:Nt-1,y:cn},{width:1,height:Zn}),gu.copy(rt.data,V,{x:0,y:0},{x:Nt+vn,y:cn},{width:1,height:Zn})}this.image=V,this.iconPositions=g,this.patternPositions=A};$r.prototype.addImages=function(c,d,g){for(var A in c){var P=c[A],B={x:0,y:0,w:P.data.width+2,h:P.data.height+2};g.push(B),d[A]=new Ki(B,P),P.hasRenderCallback&&this.haveRenderCallbacks.push(A)}},$r.prototype.patchUpdatedImages=function(c,d){for(var g in c.dispatchRenderCallbacks(this.haveRenderCallbacks),c.updatedImages)this.patchUpdatedImage(this.iconPositions[g],c.getImage(g),d),this.patchUpdatedImage(this.patternPositions[g],c.getImage(g),d)},$r.prototype.patchUpdatedImage=function(c,d,g){if(c&&d&&c.version!==d.version){c.version=d.version;var A=c.tl;g.update(d.data,void 0,{x:A[0],y:A[1]})}},ho("ImagePosition",Ki),ho("ImageAtlas",$r);var zo={horizontal:1,vertical:2,horizontalOnly:3},Ua=function(){this.scale=1,this.fontStack="",this.imageName=null};Ua.forText=function(c,d){var g=new Ua;return g.scale=c||1,g.fontStack=d,g},Ua.forImage=function(c){var d=new Ua;return d.imageName=c,d};var co=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Da(c,d,g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn){var Zn,Nn=co.fromFeature(c,P);rt===zo.vertical&&Nn.verticalizePunctuation();var fr=vu.processBidirectionalText,yr=vu.processStyledBidirectionalText;if(fr&&Nn.sections.length===1){Zn=[];for(var Sr=0,Ir=fr(Nn.toString(),dl(Nn,Le,B,d,A,Nt,cn));Sr<Ir.length;Sr+=1){var Xr=Ir[Sr],Pi=new co;Pi.text=Xr,Pi.sections=Nn.sections;for(var Ci=0;Ci<Xr.length;Ci++)Pi.sectionIndex.push(0);Zn.push(Pi)}}else if(yr){Zn=[];for(var Ao=0,ao=yr(Nn.text,Nn.sectionIndex,dl(Nn,Le,B,d,A,Nt,cn));Ao<ao.length;Ao+=1){var Po=ao[Ao],Wi=new co;Wi.text=Po[0],Wi.sectionIndex=Po[1],Wi.sections=Nn.sections,Zn.push(Wi)}}else Zn=function(yo,ma){for(var Ma=[],ns=yo.text,Wo=0,Cs=0,bl=ma;Cs<bl.length;Cs+=1){var Ul=bl[Cs];Ma.push(yo.substring(Wo,Ul)),Wo=Ul}return Wo<ns.length&&Ma.push(yo.substring(Wo,ns.length)),Ma}(Nn,dl(Nn,Le,B,d,A,Nt,cn));var Aa=[],ea={positionedLines:Aa,text:Nn.toString(),top:We[1],bottom:We[1],left:We[0],right:We[0],writingMode:rt,iconsInText:!1,verticalizable:!1};return function(yo,ma,Ma,ns,Wo,Cs,bl,Ul,jl,xl,nc,Hs){for(var wc=0,Xu=-17,zc=0,uu=0,Vl=Ul==="right"?1:Ul==="left"?0:.5,Uc=0,es=0,Ys=Wo;es<Ys.length;es+=1){var zs=Ys[es];zs.trim();var gs=zs.getMaxScale(),Yu=24*(gs-1),fu={positionedGlyphs:[],lineOffset:0};yo.positionedLines[Uc]=fu;var Us=fu.positionedGlyphs,rc=0;if(zs.length()){for(var Ac=0;Ac<zs.length();Ac++){var ss=zs.getSection(Ac),$u=zs.getSectionIndex(Ac),Uf=zs.getCharCode(Ac),Jd=0,ic=null,uh=null,Tf=null,ep=24,ed=!(jl===zo.horizontal||!nc&&!Sd(Uf)||nc&&(da[Uf]||(nd=Uf,Ii.Arabic(nd)||Ii["Arabic Supplement"](nd)||Ii["Arabic Extended-A"](nd)||Ii["Arabic Presentation Forms-A"](nd)||Ii["Arabic Presentation Forms-B"](nd))));if(ss.imageName){var c0=ns[ss.imageName];if(!c0)continue;Tf=ss.imageName,yo.iconsInText=yo.iconsInText||!0,uh=c0.paddedRect;var td=c0.displaySize;ss.scale=24*ss.scale/Hs,Jd=Yu+(24-td[1]*ss.scale),ep=(ic={width:td[0],height:td[1],left:1,top:-3,advance:ed?td[1]:td[0]}).advance;var u0=ed?td[0]*ss.scale-24*gs:td[1]*ss.scale-24*gs;u0>0&&u0>rc&&(rc=u0)}else{var vm=Ma[ss.fontStack],f0=vm&&vm[Uf];if(f0&&f0.rect)uh=f0.rect,ic=f0.metrics;else{var gm=ma[ss.fontStack],ng=gm&&gm[Uf];if(!ng)continue;ic=ng.metrics}Jd=24*(gs-ss.scale)}ed?(yo.verticalizable=!0,Us.push({glyph:Uf,imageName:Tf,x:wc,y:Xu+Jd,vertical:ed,scale:ss.scale,fontStack:ss.fontStack,sectionIndex:$u,metrics:ic,rect:uh}),wc+=ep*ss.scale+xl):(Us.push({glyph:Uf,imageName:Tf,x:wc,y:Xu+Jd,vertical:ed,scale:ss.scale,fontStack:ss.fontStack,sectionIndex:$u,metrics:ic,rect:uh}),wc+=ic.advance*ss.scale+xl)}Us.length!==0&&(zc=Math.max(wc-xl,zc),Yl(Us,0,Us.length-1,Vl,rc)),wc=0;var uy=Cs*gs+rc;fu.lineOffset=Math.max(rc,Yu),Xu+=uy,uu=Math.max(uy,uu),++Uc}else Xu+=Cs,++Uc}var nd,Dp=Xu- -17,j0=el(bl),rd=j0.horizontalAlign,Np=j0.verticalAlign;(function(lv,rg,ym,Bp,h0,_m,cv,bm,uv){var V0,Fp=(rg-ym)*h0;V0=_m!==cv?-bm*Bp- -17:(-Bp*uv+.5)*cv;for(var kp=0,d0=lv;kp<d0.length;kp+=1)for(var tp=0,p0=d0[kp].positionedGlyphs;tp<p0.length;tp+=1){var zp=p0[tp];zp.x+=Fp,zp.y+=V0}})(yo.positionedLines,Vl,rd,Np,zc,uu,Cs,Dp,Wo.length),yo.top+=-Np*Dp,yo.bottom=yo.top+Dp,yo.left+=-rd*zc,yo.right=yo.left+zc}(ea,d,g,A,Zn,V,Q,me,rt,Le,ut,vn),!function(yo){for(var ma=0,Ma=yo;ma<Ma.length;ma+=1)if(Ma[ma].positionedGlyphs.length!==0)return!1;return!0}(Aa)&&ea}co.fromFeature=function(c,d){for(var g=new co,A=0;A<c.sections.length;A++){var P=c.sections[A];P.image?g.addImageSection(P):g.addTextSection(P,d)}return g},co.prototype.length=function(){return this.text.length},co.prototype.getSection=function(c){return this.sections[this.sectionIndex[c]]},co.prototype.getSectionIndex=function(c){return this.sectionIndex[c]},co.prototype.getCharCode=function(c){return this.text.charCodeAt(c)},co.prototype.verticalizePunctuation=function(){this.text=function(c){for(var d="",g=0;g<c.length;g++){var A=c.charCodeAt(g+1)||null,P=c.charCodeAt(g-1)||null;d+=A&&$p(A)&&!On[c[g+1]]||P&&$p(P)&&!On[c[g-1]]||!On[c[g]]?c[g]:On[c[g]]}return d}(this.text)},co.prototype.trim=function(){for(var c=0,d=0;d<this.text.length&&da[this.text.charCodeAt(d)];d++)c++;for(var g=this.text.length,A=this.text.length-1;A>=0&&A>=c&&da[this.text.charCodeAt(A)];A--)g--;this.text=this.text.substring(c,g),this.sectionIndex=this.sectionIndex.slice(c,g)},co.prototype.substring=function(c,d){var g=new co;return g.text=this.text.substring(c,d),g.sectionIndex=this.sectionIndex.slice(c,d),g.sections=this.sections,g},co.prototype.toString=function(){return this.text},co.prototype.getMaxScale=function(){var c=this;return this.sectionIndex.reduce(function(d,g){return Math.max(d,c.sections[g].scale)},0)},co.prototype.addTextSection=function(c,d){this.text+=c.text,this.sections.push(Ua.forText(c.scale,c.fontStack||d));for(var g=this.sections.length-1,A=0;A<c.text.length;++A)this.sectionIndex.push(g)},co.prototype.addImageSection=function(c){var d=c.image?c.image.name:"";if(d.length!==0){var g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Ua.forImage(d)),this.sectionIndex.push(this.sections.length-1)):yt("Reached maximum number of images 6401")}else yt("Can't add FormattedSection with an empty image.")},co.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var da={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Jo={};function vs(c,d,g,A,P,B){if(d.imageName){var V=A[d.imageName];return V?V.displaySize[0]*d.scale*24/B+P:0}var Q=g[d.fontStack],me=Q&&Q[c];return me?me.metrics.advance*d.scale+P:0}function _l(c,d,g,A){var P=Math.pow(c-d,2);return A?c<d?P/2:2*P:P+Math.abs(g)*g}function $c(c,d,g){var A=0;return c===10&&(A-=1e4),g&&(A+=150),c!==40&&c!==65288||(A+=50),d!==41&&d!==65289||(A+=50),A}function Ga(c,d,g,A,P,B){for(var V=null,Q=_l(d,g,P,B),me=0,Le=A;me<Le.length;me+=1){var We=Le[me],rt=_l(d-We.x,g,P,B)+We.badness;rt<=Q&&(V=We,Q=rt)}return{index:c,x:d,priorBreak:V,badness:Q}}function dl(c,d,g,A,P,B,V){if(B!=="point")return[];if(!c)return[];for(var Q,me=[],Le=function(Zn,Nn,fr,yr,Sr,Ir){for(var Xr=0,Pi=0;Pi<Zn.length();Pi++){var Ci=Zn.getSection(Pi);Xr+=vs(Zn.getCharCode(Pi),Ci,yr,Sr,Nn,Ir)}return Xr/Math.max(1,Math.ceil(Xr/fr))}(c,d,g,A,P,V),We=c.text.indexOf("\u200B")>=0,rt=0,ut=0;ut<c.length();ut++){var Nt=c.getSection(ut),cn=c.getCharCode(ut);if(da[cn]||(rt+=vs(cn,Nt,A,P,d,V)),ut<c.length()-1){var vn=!((Q=cn)<11904||!(Ii["Bopomofo Extended"](Q)||Ii.Bopomofo(Q)||Ii["CJK Compatibility Forms"](Q)||Ii["CJK Compatibility Ideographs"](Q)||Ii["CJK Compatibility"](Q)||Ii["CJK Radicals Supplement"](Q)||Ii["CJK Strokes"](Q)||Ii["CJK Symbols and Punctuation"](Q)||Ii["CJK Unified Ideographs Extension A"](Q)||Ii["CJK Unified Ideographs"](Q)||Ii["Enclosed CJK Letters and Months"](Q)||Ii["Halfwidth and Fullwidth Forms"](Q)||Ii.Hiragana(Q)||Ii["Ideographic Description Characters"](Q)||Ii["Kangxi Radicals"](Q)||Ii["Katakana Phonetic Extensions"](Q)||Ii.Katakana(Q)||Ii["Vertical Forms"](Q)||Ii["Yi Radicals"](Q)||Ii["Yi Syllables"](Q)));(Jo[cn]||vn||Nt.imageName)&&me.push(Ga(ut+1,rt,Le,me,$c(cn,c.getCharCode(ut+1),vn&&We),!1))}}return function Zn(Nn){return Nn?Zn(Nn.priorBreak).concat(Nn.index):[]}(Ga(c.length(),rt,Le,me,0,!0))}function el(c){var d=.5,g=.5;switch(c){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:d,verticalAlign:g}}function Yl(c,d,g,A,P){if(A||P)for(var B=c[g],V=(c[g].x+B.metrics.advance*B.scale)*A,Q=d;Q<=g;Q++)c[Q].x-=V,c[Q].y+=P}function zl(c,d,g,A,P,B){var V,Q=c.image;if(Q.content){var me=Q.content,Le=Q.pixelRatio||1;V=[me[0]/Le,me[1]/Le,Q.displaySize[0]-me[2]/Le,Q.displaySize[1]-me[3]/Le]}var We,rt,ut,Nt,cn=d.left*B,vn=d.right*B;g==="width"||g==="both"?(Nt=P[0]+cn-A[3],rt=P[0]+vn+A[1]):rt=(Nt=P[0]+(cn+vn-Q.displaySize[0])/2)+Q.displaySize[0];var Zn=d.top*B,Nn=d.bottom*B;return g==="height"||g==="both"?(We=P[1]+Zn-A[0],ut=P[1]+Nn+A[2]):ut=(We=P[1]+(Zn+Nn-Q.displaySize[1])/2)+Q.displaySize[1],{image:Q,top:We,right:rt,bottom:ut,left:Nt,collisionPadding:V}}Jo[10]=!0,Jo[32]=!0,Jo[38]=!0,Jo[40]=!0,Jo[41]=!0,Jo[43]=!0,Jo[45]=!0,Jo[47]=!0,Jo[173]=!0,Jo[183]=!0,Jo[8203]=!0,Jo[8208]=!0,Jo[8211]=!0,Jo[8231]=!0;var as=function(c){function d(g,A,P,B){c.call(this,g,A),this.angle=P,B!==void 0&&(this.segment=B)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(ae);function $l(c,d){var g=d.expression;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new ya(c+1))};if(g.kind==="source")return{kind:"source"};for(var A=g.zoomStops,P=g.interpolationType,B=0;B<A.length&&A[B]<=c;)B++;for(var V=B=Math.max(0,B-1);V<A.length&&A[V]<c+1;)V++;V=Math.min(A.length-1,V);var Q=A[B],me=A[V];return g.kind==="composite"?{kind:"composite",minZoom:Q,maxZoom:me,interpolationType:P}:{kind:"camera",minZoom:Q,maxZoom:me,minSize:g.evaluate(new ya(Q)),maxSize:g.evaluate(new ya(me)),interpolationType:P}}function ec(c,d,g){var A=d.uSize,P=g.lowerSize;return c.kind==="source"?P/128:c.kind==="composite"?Xs(P/128,g.upperSize/128,d.uSizeT):A}function mc(c,d){var g=0,A=0;if(c.kind==="constant")A=c.layoutSize;else if(c.kind!=="source"){var P=c.interpolationType,B=P?De(Nl.interpolationFactor(P,d,c.minZoom,c.maxZoom),0,1):0;c.kind==="camera"?A=Xs(c.minSize,c.maxSize,B):g=B}return{uSizeT:g,uSize:A}}ho("Anchor",as);var Ra=Object.freeze({__proto__:null,getSizeData:$l,evaluateSizeForFeature:ec,evaluateSizeForZoom:mc,SIZE_PACK_FACTOR:128});function Kc(c,d,g,A,P){if(d.segment===void 0)return!0;for(var B=d,V=d.segment+1,Q=0;Q>-g/2;){if(--V<0)return!1;Q-=c[V].dist(B),B=c[V]}Q+=c[V].dist(c[V+1]),V++;for(var me=[],Le=0;Q<g/2;){var We=c[V],rt=c[V+1];if(!rt)return!1;var ut=c[V-1].angleTo(We)-We.angleTo(rt);for(ut=Math.abs((ut+3*Math.PI)%(2*Math.PI)-Math.PI),me.push({distance:Q,angleDelta:ut}),Le+=ut;Q-me[0].distance>A;)Le-=me.shift().angleDelta;if(Le>P)return!1;V++,Q+=We.dist(rt)}return!0}function Rs(c){for(var d=0,g=0;g<c.length-1;g++)d+=c[g].dist(c[g+1]);return d}function Zo(c,d,g){return c?.6*d*g:0}function Ta(c,d){return Math.max(c?c.right-c.left:0,d?d.right-d.left:0)}function Za(c,d,g,A,P,B){for(var V=Zo(g,P,B),Q=Ta(g,A)*B,me=0,Le=Rs(c)/2,We=0;We<c.length-1;We++){var rt=c[We],ut=c[We+1],Nt=rt.dist(ut);if(me+Nt>Le){var cn=(Le-me)/Nt,vn=Xs(rt.x,ut.x,cn),Zn=Xs(rt.y,ut.y,cn),Nn=new as(vn,Zn,ut.angleTo(rt),We);return Nn._round(),!V||Kc(c,Nn,Q,V,d)?Nn:void 0}me+=Nt}}function Kl(c,d,g,A,P,B,V,Q,me){var Le=Zo(A,B,V),We=Ta(A,P),rt=We*V,ut=c[0].x===0||c[0].x===me||c[0].y===0||c[0].y===me;return d-rt<d/4&&(d=rt+d/4),function Nt(cn,vn,Zn,Nn,fr,yr,Sr,Ir,Xr){for(var Pi=yr/2,Ci=Rs(cn),Ao=0,ao=vn-Zn,Po=[],Wi=0;Wi<cn.length-1;Wi++){for(var Aa=cn[Wi],ea=cn[Wi+1],yo=Aa.dist(ea),ma=ea.angleTo(Aa);ao+Zn<Ao+yo;){var Ma=((ao+=Zn)-Ao)/yo,ns=Xs(Aa.x,ea.x,Ma),Wo=Xs(Aa.y,ea.y,Ma);if(ns>=0&&ns<Xr&&Wo>=0&&Wo<Xr&&ao-Pi>=0&&ao+Pi<=Ci){var Cs=new as(ns,Wo,ma,Wi);Cs._round(),Nn&&!Kc(cn,Cs,yr,Nn,fr)||Po.push(Cs)}}Ao+=yo}return Ir||Po.length||Sr||(Po=Nt(cn,Ao/2,Zn,Nn,fr,yr,Sr,!0,Xr)),Po}(c,ut?d/2*Q%d:(We/2+2*B)*V*Q%d,d,Le,g,rt,ut,!1,me)}function ch(c,d,g,A,P){for(var B=[],V=0;V<c.length;V++)for(var Q=c[V],me=void 0,Le=0;Le<Q.length-1;Le++){var We=Q[Le],rt=Q[Le+1];We.x<d&&rt.x<d||(We.x<d?We=new ae(d,We.y+(d-We.x)/(rt.x-We.x)*(rt.y-We.y))._round():rt.x<d&&(rt=new ae(d,We.y+(d-We.x)/(rt.x-We.x)*(rt.y-We.y))._round()),We.y<g&&rt.y<g||(We.y<g?We=new ae(We.x+(g-We.y)/(rt.y-We.y)*(rt.x-We.x),g)._round():rt.y<g&&(rt=new ae(We.x+(g-We.y)/(rt.y-We.y)*(rt.x-We.x),g)._round()),We.x>=A&&rt.x>=A||(We.x>=A?We=new ae(A,We.y+(A-We.x)/(rt.x-We.x)*(rt.y-We.y))._round():rt.x>=A&&(rt=new ae(A,We.y+(A-We.x)/(rt.x-We.x)*(rt.y-We.y))._round()),We.y>=P&&rt.y>=P||(We.y>=P?We=new ae(We.x+(P-We.y)/(rt.y-We.y)*(rt.x-We.x),P)._round():rt.y>=P&&(rt=new ae(We.x+(P-We.y)/(rt.y-We.y)*(rt.x-We.x),P)._round()),me&&We.equals(me[me.length-1])||B.push(me=[We]),me.push(rt)))))}return B}function ln(c,d,g,A){var P=[],B=c.image,V=B.pixelRatio,Q=B.paddedRect.w-2,me=B.paddedRect.h-2,Le=c.right-c.left,We=c.bottom-c.top,rt=B.stretchX||[[0,Q]],ut=B.stretchY||[[0,me]],Nt=function(ns,Wo){return ns+Wo[1]-Wo[0]},cn=rt.reduce(Nt,0),vn=ut.reduce(Nt,0),Zn=Q-cn,Nn=me-vn,fr=0,yr=cn,Sr=0,Ir=vn,Xr=0,Pi=Zn,Ci=0,Ao=Nn;if(B.content&&A){var ao=B.content;fr=Pr(rt,0,ao[0]),Sr=Pr(ut,0,ao[1]),yr=Pr(rt,ao[0],ao[2]),Ir=Pr(ut,ao[1],ao[3]),Xr=ao[0]-fr,Ci=ao[1]-Sr,Pi=ao[2]-ao[0]-yr,Ao=ao[3]-ao[1]-Ir}var Po=function(ns,Wo,Cs,bl){var Ul=no(ns.stretch-fr,yr,Le,c.left),jl=Na(ns.fixed-Xr,Pi,ns.stretch,cn),xl=no(Wo.stretch-Sr,Ir,We,c.top),nc=Na(Wo.fixed-Ci,Ao,Wo.stretch,vn),Hs=no(Cs.stretch-fr,yr,Le,c.left),wc=Na(Cs.fixed-Xr,Pi,Cs.stretch,cn),Xu=no(bl.stretch-Sr,Ir,We,c.top),zc=Na(bl.fixed-Ci,Ao,bl.stretch,vn),uu=new ae(Ul,xl),Vl=new ae(Hs,xl),Uc=new ae(Hs,Xu),es=new ae(Ul,Xu),Ys=new ae(jl/V,nc/V),zs=new ae(wc/V,zc/V),gs=d*Math.PI/180;if(gs){var Yu=Math.sin(gs),fu=Math.cos(gs),Us=[fu,-Yu,Yu,fu];uu._matMult(Us),Vl._matMult(Us),es._matMult(Us),Uc._matMult(Us)}var rc=ns.stretch+ns.fixed,Ac=Wo.stretch+Wo.fixed;return{tl:uu,tr:Vl,bl:es,br:Uc,tex:{x:B.paddedRect.x+1+rc,y:B.paddedRect.y+1+Ac,w:Cs.stretch+Cs.fixed-rc,h:bl.stretch+bl.fixed-Ac},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ys,pixelOffsetBR:zs,minFontScaleX:Pi/V/Le,minFontScaleY:Ao/V/We,isSDF:g}};if(A&&(B.stretchX||B.stretchY))for(var Wi=Er(rt,Zn,cn),Aa=Er(ut,Nn,vn),ea=0;ea<Wi.length-1;ea++)for(var yo=Wi[ea],ma=Wi[ea+1],Ma=0;Ma<Aa.length-1;Ma++)P.push(Po(yo,Aa[Ma],ma,Aa[Ma+1]));else P.push(Po({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Q+1},{fixed:0,stretch:me+1}));return P}function Pr(c,d,g){for(var A=0,P=0,B=c;P<B.length;P+=1){var V=B[P];A+=Math.max(d,Math.min(g,V[1]))-Math.max(d,Math.min(g,V[0]))}return A}function Er(c,d,g){for(var A=[{fixed:-1,stretch:0}],P=0,B=c;P<B.length;P+=1){var V=B[P],Q=V[0],me=V[1],Le=A[A.length-1];A.push({fixed:Q-Le.stretch,stretch:Le.stretch}),A.push({fixed:Q-Le.stretch,stretch:Le.stretch+(me-Q)})}return A.push({fixed:d+1,stretch:g}),A}function no(c,d,g,A){return c/d*g+A}function Na(c,d,g,A){return c-d*g/A}var Es=function(c,d,g,A,P,B,V,Q,me,Le){if(this.boxStartIndex=c.length,me){var We=B.top,rt=B.bottom,ut=B.collisionPadding;ut&&(We-=ut[1],rt+=ut[3]);var Nt=rt-We;Nt>0&&(Nt=Math.max(10,Nt),this.circleDiameter=Nt)}else{var cn=B.top*V-Q,vn=B.bottom*V+Q,Zn=B.left*V-Q,Nn=B.right*V+Q,fr=B.collisionPadding;if(fr&&(Zn-=fr[0]*V,cn-=fr[1]*V,Nn+=fr[2]*V,vn+=fr[3]*V),Le){var yr=new ae(Zn,cn),Sr=new ae(Nn,cn),Ir=new ae(Zn,vn),Xr=new ae(Nn,vn),Pi=Le*Math.PI/180;yr._rotate(Pi),Sr._rotate(Pi),Ir._rotate(Pi),Xr._rotate(Pi),Zn=Math.min(yr.x,Sr.x,Ir.x,Xr.x),Nn=Math.max(yr.x,Sr.x,Ir.x,Xr.x),cn=Math.min(yr.y,Sr.y,Ir.y,Xr.y),vn=Math.max(yr.y,Sr.y,Ir.y,Xr.y)}c.emplaceBack(d.x,d.y,Zn,cn,Nn,vn,g,A,P)}this.boxEndIndex=c.length},Lt=function(c,d){if(c===void 0&&(c=[]),d===void 0&&(d=nn),this.data=c,this.length=this.data.length,this.compare=d,this.length>0)for(var g=(this.length>>1)-1;g>=0;g--)this._down(g)};function nn(c,d){return c<d?-1:c>d?1:0}function Mn(c,d,g){d===void 0&&(d=1),g===void 0&&(g=!1);for(var A=1/0,P=1/0,B=-1/0,V=-1/0,Q=c[0],me=0;me<Q.length;me++){var Le=Q[me];(!me||Le.x<A)&&(A=Le.x),(!me||Le.y<P)&&(P=Le.y),(!me||Le.x>B)&&(B=Le.x),(!me||Le.y>V)&&(V=Le.y)}var We=Math.min(B-A,V-P),rt=We/2,ut=new Lt([],Ar);if(We===0)return new ae(A,P);for(var Nt=A;Nt<B;Nt+=We)for(var cn=P;cn<V;cn+=We)ut.push(new xr(Nt+rt,cn+rt,rt,c));for(var vn=function(fr){for(var yr=0,Sr=0,Ir=0,Xr=fr[0],Pi=0,Ci=Xr.length,Ao=Ci-1;Pi<Ci;Ao=Pi++){var ao=Xr[Pi],Po=Xr[Ao],Wi=ao.x*Po.y-Po.x*ao.y;Sr+=(ao.x+Po.x)*Wi,Ir+=(ao.y+Po.y)*Wi,yr+=3*Wi}return new xr(Sr/yr,Ir/yr,0,fr)}(c),Zn=ut.length;ut.length;){var Nn=ut.pop();(Nn.d>vn.d||!vn.d)&&(vn=Nn,g&&console.log("found best %d after %d probes",Math.round(1e4*Nn.d)/1e4,Zn)),Nn.max-vn.d<=d||(ut.push(new xr(Nn.p.x-(rt=Nn.h/2),Nn.p.y-rt,rt,c)),ut.push(new xr(Nn.p.x+rt,Nn.p.y-rt,rt,c)),ut.push(new xr(Nn.p.x-rt,Nn.p.y+rt,rt,c)),ut.push(new xr(Nn.p.x+rt,Nn.p.y+rt,rt,c)),Zn+=4)}return g&&(console.log("num probes: "+Zn),console.log("best distance: "+vn.d)),vn.p}function Ar(c,d){return d.max-c.max}function xr(c,d,g,A){this.p=new ae(c,d),this.h=g,this.d=function(P,B){for(var V=!1,Q=1/0,me=0;me<B.length;me++)for(var Le=B[me],We=0,rt=Le.length,ut=rt-1;We<rt;ut=We++){var Nt=Le[We],cn=Le[ut];Nt.y>P.y!=cn.y>P.y&&P.x<(cn.x-Nt.x)*(P.y-Nt.y)/(cn.y-Nt.y)+Nt.x&&(V=!V),Q=Math.min(Q,Hd(P,Nt,cn))}return(V?1:-1)*Math.sqrt(Q)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}Lt.prototype.push=function(c){this.data.push(c),this.length++,this._up(this.length-1)},Lt.prototype.pop=function(){if(this.length!==0){var c=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),c}},Lt.prototype.peek=function(){return this.data[0]},Lt.prototype._up=function(c){for(var d=this.data,g=this.compare,A=d[c];c>0;){var P=c-1>>1,B=d[P];if(g(A,B)>=0)break;d[c]=B,c=P}d[c]=A},Lt.prototype._down=function(c){for(var d=this.data,g=this.compare,A=this.length>>1,P=d[c];c<A;){var B=1+(c<<1),V=d[B],Q=B+1;if(Q<this.length&&g(d[Q],V)<0&&(B=Q,V=d[Q]),g(V,P)>=0)break;d[c]=V,c=B}d[c]=P};var Un=Number.POSITIVE_INFINITY;function Kn(c,d){return d[1]!==Un?function(g,A,P){var B=0,V=0;switch(A=Math.abs(A),P=Math.abs(P),g){case"top-right":case"top-left":case"top":V=P-7;break;case"bottom-right":case"bottom-left":case"bottom":V=7-P}switch(g){case"top-right":case"bottom-right":case"right":B=-A;break;case"top-left":case"bottom-left":case"left":B=A}return[B,V]}(c,d[0],d[1]):function(g,A){var P=0,B=0;A<0&&(A=0);var V=A/Math.sqrt(2);switch(g){case"top-right":case"top-left":B=V-7;break;case"bottom-right":case"bottom-left":B=7-V;break;case"bottom":B=7-A;break;case"top":B=A-7}switch(g){case"top-right":case"bottom-right":P=-V;break;case"top-left":case"bottom-left":P=V;break;case"left":P=A;break;case"right":P=-A}return[P,B]}(c,d[0])}function ir(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function yn(c,d,g,A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn){var vn=function(Sr,Ir,Xr,Pi,Ci,Ao,ao,Po){for(var Wi=Pi.layout.get("text-rotate").evaluate(Ao,{})*Math.PI/180,Aa=[],ea=0,yo=Ir.positionedLines;ea<yo.length;ea+=1)for(var ma=yo[ea],Ma=0,ns=ma.positionedGlyphs;Ma<ns.length;Ma+=1){var Wo=ns[Ma];if(Wo.rect){var Cs=Wo.rect||{},bl=4,Ul=!0,jl=1,xl=0,nc=(Ci||Po)&&Wo.vertical,Hs=Wo.metrics.advance*Wo.scale/2;if(Po&&Ir.verticalizable&&(xl=ma.lineOffset/2-(Wo.imageName?-(24-Wo.metrics.width*Wo.scale)/2:24*(Wo.scale-1))),Wo.imageName){var wc=ao[Wo.imageName];Ul=wc.sdf,bl=1/(jl=wc.pixelRatio)}var Xu=Ci?[Wo.x+Hs,Wo.y]:[0,0],zc=Ci?[0,0]:[Wo.x+Hs+Xr[0],Wo.y+Xr[1]-xl],uu=[0,0];nc&&(uu=zc,zc=[0,0]);var Vl=(Wo.metrics.left-bl)*Wo.scale-Hs+zc[0],Uc=(-Wo.metrics.top-bl)*Wo.scale+zc[1],es=Vl+Cs.w*Wo.scale/jl,Ys=Uc+Cs.h*Wo.scale/jl,zs=new ae(Vl,Uc),gs=new ae(es,Uc),Yu=new ae(Vl,Ys),fu=new ae(es,Ys);if(nc){var Us=new ae(-Hs,Hs- -17),rc=-Math.PI/2,Ac=12-Hs,ss=new ae(22-Ac,-(Wo.imageName?Ac:0)),$u=new(Function.prototype.bind.apply(ae,[null].concat(uu)));zs._rotateAround(rc,Us)._add(ss)._add($u),gs._rotateAround(rc,Us)._add(ss)._add($u),Yu._rotateAround(rc,Us)._add(ss)._add($u),fu._rotateAround(rc,Us)._add(ss)._add($u)}if(Wi){var Uf=Math.sin(Wi),Jd=Math.cos(Wi),ic=[Jd,-Uf,Uf,Jd];zs._matMult(ic),gs._matMult(ic),Yu._matMult(ic),fu._matMult(ic)}var uh=new ae(0,0),Tf=new ae(0,0);Aa.push({tl:zs,tr:gs,bl:Yu,br:fu,tex:Cs,writingMode:Ir.writingMode,glyphOffset:Xu,sectionIndex:Wo.sectionIndex,isSDF:Ul,pixelOffsetTL:uh,pixelOffsetBR:Tf,minFontScaleX:0,minFontScaleY:0})}}return Aa}(0,g,Q,P,B,V,A,c.allowVerticalPlacement),Zn=c.textSizeData,Nn=null;Zn.kind==="source"?(Nn=[128*P.layout.get("text-size").evaluate(V,{})])[0]>32640&&yt(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Zn.kind==="composite"&&((Nn=[128*Nt.compositeTextSizes[0].evaluate(V,{},cn),128*Nt.compositeTextSizes[1].evaluate(V,{},cn)])[0]>32640||Nn[1]>32640)&&yt(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),c.addSymbols(c.text,vn,Nn,Q,B,V,Le,d,me.lineStartIndex,me.lineLength,ut,cn);for(var fr=0,yr=We;fr<yr.length;fr+=1)rt[yr[fr]]=c.text.placedSymbolArray.length-1;return 4*vn.length}function Hn(c){for(var d in c)return c[d];return null}function Kt(c,d,g,A){var P=c.compareText;if(d in P){for(var B=P[d],V=B.length-1;V>=0;V--)if(A.dist(B[V])<g)return!0}else P[d]=[];return P[d].push(A),!1}var Yn=wh.VectorTileFeature.types,Dr=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zr(c,d,g,A,P,B,V,Q,me,Le,We,rt,ut){var Nt=Q?Math.min(32640,Math.round(Q[0])):0,cn=Q?Math.min(32640,Math.round(Q[1])):0;c.emplaceBack(d,g,Math.round(32*A),Math.round(32*P),B,V,(Nt<<1)+(me?1:0),cn,16*Le,16*We,256*rt,256*ut)}function mi(c,d,g){c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g)}function Kr(c){for(var d=0,g=c.sections;d<g.length;d+=1)if(_p(g[d].text))return!0;return!1}var hi=function(c){this.layoutVertexArray=new ih,this.indexArray=new sh,this.programConfigurations=c,this.segments=new jt,this.dynamicLayoutVertexArray=new Xc,this.opacityVertexArray=new jd,this.placedSymbolArray=new C};hi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},hi.prototype.upload=function(c,d,g,A){this.isEmpty()||(g&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,av.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,Yv.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Dr,!0),this.opacityVertexBuffer.itemSize=1),(g||A)&&this.programConfigurations.upload(c))},hi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ho("SymbolBuffers",hi);var Ro=function(c,d,g){this.layoutVertexArray=new c,this.layoutAttributes=d,this.indexArray=new g,this.segments=new jt,this.collisionVertexArray=new Qp};Ro.prototype.upload=function(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,$v.members,!0)},Ro.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ho("CollisionBuffers",Ro);var Ui=function(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=kl([]),this.placementViewportMatrix=kl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$l(this.zoom,d["text-size"]),this.iconSizeData=$l(this.zoom,d["icon-size"]);var g=this.layers[0].layout,A=g.get("symbol-sort-key"),P=g.get("symbol-z-order");this.canOverlap=g.get("text-allow-overlap")||g.get("icon-allow-overlap")||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=P!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(P==="viewport-y"||P==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(function(B){return zo[B]})),this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id}),this.sourceID=c.sourceID};Ui.prototype.createArrays=function(){this.text=new hi(new Do(this.layers,this.zoom,function(c){return/^text/.test(c)})),this.icon=new hi(new Do(this.layers,this.zoom,function(c){return/^icon/.test(c)})),this.glyphOffsetArray=new q,this.lineVertexArray=new he,this.symbolInstances=new G},Ui.prototype.calculateGlyphDependencies=function(c,d,g,A,P){for(var B=0;B<c.length;B++)if(d[c.charCodeAt(B)]=!0,(g||A)&&P){var V=On[c.charAt(B)];V&&(d[V.charCodeAt(0)]=!0)}},Ui.prototype.populate=function(c,d,g){var A=this.layers[0],P=A.layout,B=P.get("text-font"),V=P.get("text-field"),Q=P.get("icon-image"),me=(V.value.kind!=="constant"||V.value.value instanceof mr&&!V.value.value.isEmpty()||V.value.value.toString().length>0)&&(B.value.kind!=="constant"||B.value.value.length>0),Le=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,We=P.get("symbol-sort-key");if(this.features=[],me||Le){for(var rt=d.iconDependencies,ut=d.glyphDependencies,Nt=d.availableImages,cn=new ya(this.zoom),vn=0,Zn=c;vn<Zn.length;vn+=1){var Nn=Zn[vn],fr=Nn.feature,yr=Nn.id,Sr=Nn.index,Ir=Nn.sourceLayerIndex,Xr=A._featureFilter.needGeometry,Pi=Qs(fr,Xr);if(A._featureFilter.filter(cn,Pi,g)){Xr||(Pi.geometry=bs(fr));var Ci=void 0;if(me){var Ao=A.getValueAndResolveTokens("text-field",Pi,g,Nt),ao=mr.factory(Ao);Kr(ao)&&(this.hasRTLText=!0),(!this.hasRTLText||sm()==="unavailable"||this.hasRTLText&&vu.isParsed())&&(Ci=Qt(ao,A,Pi))}var Po=void 0;if(Le){var Wi=A.getValueAndResolveTokens("icon-image",Pi,g,Nt);Po=Wi instanceof ai?Wi:ai.fromString(Wi)}if(Ci||Po){var Aa=this.sortFeaturesByKey?We.evaluate(Pi,{},g):void 0;if(this.features.push({id:yr,text:Ci,icon:Po,index:Sr,sourceLayerIndex:Ir,geometry:Pi.geometry,properties:fr.properties,type:Yn[fr.type],sortKey:Aa}),Po&&(rt[Po.name]=!0),Ci){var ea=B.evaluate(Pi,{},g).join(","),yo=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(zo.vertical)>=0;for(var ma=0,Ma=Ci.sections;ma<Ma.length;ma+=1){var ns=Ma[ma];if(ns.image)rt[ns.image.name]=!0;else{var Wo=th(Ci.toString()),Cs=ns.fontStack||ea,bl=ut[Cs]=ut[Cs]||{};this.calculateGlyphDependencies(ns.text,bl,yo,this.allowVerticalPlacement,Wo)}}}}}}P.get("symbol-placement")==="line"&&(this.features=function(Ul){var jl={},xl={},nc=[],Hs=0;function wc(Us){nc.push(Ul[Us]),Hs++}function Xu(Us,rc,Ac){var ss=xl[Us];return delete xl[Us],xl[rc]=ss,nc[ss].geometry[0].pop(),nc[ss].geometry[0]=nc[ss].geometry[0].concat(Ac[0]),ss}function zc(Us,rc,Ac){var ss=jl[rc];return delete jl[rc],jl[Us]=ss,nc[ss].geometry[0].shift(),nc[ss].geometry[0]=Ac[0].concat(nc[ss].geometry[0]),ss}function uu(Us,rc,Ac){var ss=Ac?rc[0][rc[0].length-1]:rc[0][0];return Us+":"+ss.x+":"+ss.y}for(var Vl=0;Vl<Ul.length;Vl++){var Uc=Ul[Vl],es=Uc.geometry,Ys=Uc.text?Uc.text.toString():null;if(Ys){var zs=uu(Ys,es),gs=uu(Ys,es,!0);if(zs in xl&&gs in jl&&xl[zs]!==jl[gs]){var Yu=zc(zs,gs,es),fu=Xu(zs,gs,nc[Yu].geometry);delete jl[zs],delete xl[gs],xl[uu(Ys,nc[fu].geometry,!0)]=fu,nc[Yu].geometry=null}else zs in xl?Xu(zs,gs,es):gs in jl?zc(zs,gs,es):(wc(Vl),jl[zs]=Hs-1,xl[gs]=Hs-1)}else wc(Vl)}return nc.filter(function(Us){return Us.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ul,jl){return Ul.sortKey-jl.sortKey})}},Ui.prototype.update=function(c,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,d,this.layers,g),this.icon.programConfigurations.updatePaintArrays(c,d,this.layers,g))},Ui.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Ui.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Ui.prototype.upload=function(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Ui.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Ui.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Ui.prototype.addToLineVertexArray=function(c,d){var g=this.lineVertexArray.length;if(c.segment!==void 0){for(var A=c.dist(d[c.segment+1]),P=c.dist(d[c.segment]),B={},V=c.segment+1;V<d.length;V++)B[V]={x:d[V].x,y:d[V].y,tileUnitDistanceFromAnchor:A},V<d.length-1&&(A+=d[V+1].dist(d[V]));for(var Q=c.segment||0;Q>=0;Q--)B[Q]={x:d[Q].x,y:d[Q].y,tileUnitDistanceFromAnchor:P},Q>0&&(P+=d[Q-1].dist(d[Q]));for(var me=0;me<d.length;me++){var Le=B[me];this.lineVertexArray.emplaceBack(Le.x,Le.y,Le.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}},Ui.prototype.addSymbols=function(c,d,g,A,P,B,V,Q,me,Le,We,rt){for(var ut=c.indexArray,Nt=c.layoutVertexArray,cn=c.segments.prepareSegment(4*d.length,Nt,ut,this.canOverlap?B.sortKey:void 0),vn=this.glyphOffsetArray.length,Zn=cn.vertexLength,Nn=this.allowVerticalPlacement&&V===zo.vertical?Math.PI/2:0,fr=B.text&&B.text.sections,yr=0;yr<d.length;yr++){var Sr=d[yr],Ir=Sr.tl,Xr=Sr.tr,Pi=Sr.bl,Ci=Sr.br,Ao=Sr.tex,ao=Sr.pixelOffsetTL,Po=Sr.pixelOffsetBR,Wi=Sr.minFontScaleX,Aa=Sr.minFontScaleY,ea=Sr.glyphOffset,yo=Sr.isSDF,ma=Sr.sectionIndex,Ma=cn.vertexLength,ns=ea[1];zr(Nt,Q.x,Q.y,Ir.x,ns+Ir.y,Ao.x,Ao.y,g,yo,ao.x,ao.y,Wi,Aa),zr(Nt,Q.x,Q.y,Xr.x,ns+Xr.y,Ao.x+Ao.w,Ao.y,g,yo,Po.x,ao.y,Wi,Aa),zr(Nt,Q.x,Q.y,Pi.x,ns+Pi.y,Ao.x,Ao.y+Ao.h,g,yo,ao.x,Po.y,Wi,Aa),zr(Nt,Q.x,Q.y,Ci.x,ns+Ci.y,Ao.x+Ao.w,Ao.y+Ao.h,g,yo,Po.x,Po.y,Wi,Aa),mi(c.dynamicLayoutVertexArray,Q,Nn),ut.emplaceBack(Ma,Ma+1,Ma+2),ut.emplaceBack(Ma+1,Ma+2,Ma+3),cn.vertexLength+=4,cn.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ea[0]),yr!==d.length-1&&ma===d[yr+1].sectionIndex||c.programConfigurations.populatePaintArrays(Nt.length,B,B.index,{},rt,fr&&fr[ma])}c.placedSymbolArray.emplaceBack(Q.x,Q.y,vn,this.glyphOffsetArray.length-vn,Zn,me,Le,Q.segment,g?g[0]:0,g?g[1]:0,A[0],A[1],V,0,!1,0,We)},Ui.prototype._addCollisionDebugVertex=function(c,d,g,A,P,B){return d.emplaceBack(0,0),c.emplaceBack(g.x,g.y,A,P,Math.round(B.x),Math.round(B.y))},Ui.prototype.addCollisionDebugVertices=function(c,d,g,A,P,B,V){var Q=P.segments.prepareSegment(4,P.layoutVertexArray,P.indexArray),me=Q.vertexLength,Le=P.layoutVertexArray,We=P.collisionVertexArray,rt=V.anchorX,ut=V.anchorY;this._addCollisionDebugVertex(Le,We,B,rt,ut,new ae(c,d)),this._addCollisionDebugVertex(Le,We,B,rt,ut,new ae(g,d)),this._addCollisionDebugVertex(Le,We,B,rt,ut,new ae(g,A)),this._addCollisionDebugVertex(Le,We,B,rt,ut,new ae(c,A)),Q.vertexLength+=4;var Nt=P.indexArray;Nt.emplaceBack(me,me+1),Nt.emplaceBack(me+1,me+2),Nt.emplaceBack(me+2,me+3),Nt.emplaceBack(me+3,me),Q.primitiveLength+=4},Ui.prototype.addDebugCollisionBoxes=function(c,d,g,A){for(var P=c;P<d;P++){var B=this.collisionBoxArray.get(P);this.addCollisionDebugVertices(B.x1,B.y1,B.x2,B.y2,A?this.textCollisionBox:this.iconCollisionBox,B.anchorPoint,g)}},Ui.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ro(oh,Kv.members,Jp),this.iconCollisionBox=new Ro(oh,Kv.members,Jp);for(var c=0;c<this.symbolInstances.length;c++){var d=this.symbolInstances.get(c);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},Ui.prototype._deserializeCollisionBoxesForSymbol=function(c,d,g,A,P,B,V,Q,me){for(var Le={},We=d;We<g;We++){var rt=c.get(We);Le.textBox={x1:rt.x1,y1:rt.y1,x2:rt.x2,y2:rt.y2,anchorPointX:rt.anchorPointX,anchorPointY:rt.anchorPointY},Le.textFeatureIndex=rt.featureIndex;break}for(var ut=A;ut<P;ut++){var Nt=c.get(ut);Le.verticalTextBox={x1:Nt.x1,y1:Nt.y1,x2:Nt.x2,y2:Nt.y2,anchorPointX:Nt.anchorPointX,anchorPointY:Nt.anchorPointY},Le.verticalTextFeatureIndex=Nt.featureIndex;break}for(var cn=B;cn<V;cn++){var vn=c.get(cn);Le.iconBox={x1:vn.x1,y1:vn.y1,x2:vn.x2,y2:vn.y2,anchorPointX:vn.anchorPointX,anchorPointY:vn.anchorPointY},Le.iconFeatureIndex=vn.featureIndex;break}for(var Zn=Q;Zn<me;Zn++){var Nn=c.get(Zn);Le.verticalIconBox={x1:Nn.x1,y1:Nn.y1,x2:Nn.x2,y2:Nn.y2,anchorPointX:Nn.anchorPointX,anchorPointY:Nn.anchorPointY},Le.verticalIconFeatureIndex=Nn.featureIndex;break}return Le},Ui.prototype.deserializeCollisionBoxes=function(c){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var g=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}},Ui.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ui.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ui.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Ui.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Ui.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Ui.prototype.addIndicesForPlacedSymbol=function(c,d){for(var g=c.placedSymbolArray.get(d),A=g.vertexStartIndex+4*g.numGlyphs,P=g.vertexStartIndex;P<A;P+=4)c.indexArray.emplaceBack(P,P+1,P+2),c.indexArray.emplaceBack(P+1,P+2,P+3)},Ui.prototype.getSortedSymbolIndexes=function(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(c),g=Math.cos(c),A=[],P=[],B=[],V=0;V<this.symbolInstances.length;++V){B.push(V);var Q=this.symbolInstances.get(V);A.push(0|Math.round(d*Q.anchorX+g*Q.anchorY)),P.push(Q.featureIndex)}return B.sort(function(me,Le){return A[me]-A[Le]||P[Le]-P[me]}),B},Ui.prototype.addToSortKeyRanges=function(c,d){var g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===d?g.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:c,symbolInstanceEnd:c+1})},Ui.prototype.sortFeatures=function(c){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var g=0,A=this.symbolInstanceIndexes;g<A.length;g+=1){var P=this.symbolInstances.get(A[g]);this.featureSortOrder.push(P.featureIndex),[P.rightJustifiedTextSymbolIndex,P.centerJustifiedTextSymbolIndex,P.leftJustifiedTextSymbolIndex].forEach(function(B,V,Q){B>=0&&Q.indexOf(B)===V&&d.addIndicesForPlacedSymbol(d.text,B)}),P.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,P.verticalPlacedTextSymbolIndex),P.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,P.placedIconSymbolIndex),P.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,P.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ho("SymbolBucket",Ui,{omit:["layers","collisionBoxArray","features","compareText"]}),Ui.MAX_GLYPHS=65535,Ui.addDynamicAttributes=mi;var xo=new fl({"symbol-placement":new Oo(_t.layout_symbol["symbol-placement"]),"symbol-spacing":new Oo(_t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Oo(_t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new So(_t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Oo(_t.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Oo(_t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Oo(_t.layout_symbol["icon-ignore-placement"]),"icon-optional":new Oo(_t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Oo(_t.layout_symbol["icon-rotation-alignment"]),"icon-size":new So(_t.layout_symbol["icon-size"]),"icon-text-fit":new Oo(_t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Oo(_t.layout_symbol["icon-text-fit-padding"]),"icon-image":new So(_t.layout_symbol["icon-image"]),"icon-rotate":new So(_t.layout_symbol["icon-rotate"]),"icon-padding":new Oo(_t.layout_symbol["icon-padding"]),"icon-keep-upright":new Oo(_t.layout_symbol["icon-keep-upright"]),"icon-offset":new So(_t.layout_symbol["icon-offset"]),"icon-anchor":new So(_t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Oo(_t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Oo(_t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Oo(_t.layout_symbol["text-rotation-alignment"]),"text-field":new So(_t.layout_symbol["text-field"]),"text-font":new So(_t.layout_symbol["text-font"]),"text-size":new So(_t.layout_symbol["text-size"]),"text-max-width":new So(_t.layout_symbol["text-max-width"]),"text-line-height":new Oo(_t.layout_symbol["text-line-height"]),"text-letter-spacing":new So(_t.layout_symbol["text-letter-spacing"]),"text-justify":new So(_t.layout_symbol["text-justify"]),"text-radial-offset":new So(_t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Oo(_t.layout_symbol["text-variable-anchor"]),"text-anchor":new So(_t.layout_symbol["text-anchor"]),"text-max-angle":new Oo(_t.layout_symbol["text-max-angle"]),"text-writing-mode":new Oo(_t.layout_symbol["text-writing-mode"]),"text-rotate":new So(_t.layout_symbol["text-rotate"]),"text-padding":new Oo(_t.layout_symbol["text-padding"]),"text-keep-upright":new Oo(_t.layout_symbol["text-keep-upright"]),"text-transform":new So(_t.layout_symbol["text-transform"]),"text-offset":new So(_t.layout_symbol["text-offset"]),"text-allow-overlap":new Oo(_t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Oo(_t.layout_symbol["text-ignore-placement"]),"text-optional":new Oo(_t.layout_symbol["text-optional"])}),qo={paint:new fl({"icon-opacity":new So(_t.paint_symbol["icon-opacity"]),"icon-color":new So(_t.paint_symbol["icon-color"]),"icon-halo-color":new So(_t.paint_symbol["icon-halo-color"]),"icon-halo-width":new So(_t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new So(_t.paint_symbol["icon-halo-blur"]),"icon-translate":new Oo(_t.paint_symbol["icon-translate"]),"icon-translate-anchor":new Oo(_t.paint_symbol["icon-translate-anchor"]),"text-opacity":new So(_t.paint_symbol["text-opacity"]),"text-color":new So(_t.paint_symbol["text-color"],{runtimeType:vi,getOverride:function(c){return c.textColor},hasOverride:function(c){return!!c.textColor}}),"text-halo-color":new So(_t.paint_symbol["text-halo-color"]),"text-halo-width":new So(_t.paint_symbol["text-halo-width"]),"text-halo-blur":new So(_t.paint_symbol["text-halo-blur"]),"text-translate":new Oo(_t.paint_symbol["text-translate"]),"text-translate-anchor":new Oo(_t.paint_symbol["text-translate-anchor"])}),layout:xo},ia=function(c){this.type=c.property.overrides?c.property.overrides.runtimeType:qr,this.defaultValue=c};ia.prototype.evaluate=function(c){if(c.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(c.formattedSection))return d.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default},ia.prototype.eachChild=function(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)},ia.prototype.outputDefined=function(){return!1},ia.prototype.serialize=function(){return null},ho("FormatSectionOverride",ia,{omit:["defaultValue"]});var As=function(c){function d(g){c.call(this,g,qo)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,A){if(c.prototype.recalculate.call(this,g,A),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var P=this.layout.get("text-writing-mode");if(P){for(var B=[],V=0,Q=P;V<Q.length;V+=1){var me=Q[V];B.indexOf(me)<0&&B.push(me)}this.layout._values["text-writing-mode"]=B}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(g,A,P,B){var V=this.layout.get(g).evaluate(A,{},P,B),Q=this._unevaluatedLayout._values[g];return Q.isDataDriven()||Ks(Q.value)||!V?V:function(me,Le){return Le.replace(/{([^{}]+)}/g,function(We,rt){return rt in me?String(me[rt]):""})}(A.properties,V)},d.prototype.createBucket=function(g){return new Ui(g)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var g=0,A=qo.paint.overridableProperties;g<A.length;g+=1){var P=A[g];if(d.hasPaintOverride(this.layout,P)){var B,V=this.paint.get(P),Q=new ia(V),me=new Fa(Q,V.property.specification);B=V.value.kind==="constant"||V.value.kind==="source"?new Ec("source",me):new is("composite",me,V.value.zoomStops,V.value._interpolationType),this.paint._values[P]=new iu(V.property,B,V.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(g,A,P){return!(!this.layout||A.isDataDriven()||P.isDataDriven())&&d.hasPaintOverride(this.layout,g)},d.hasPaintOverride=function(g,A){var P=g.get("text-field"),B=qo.paint.properties[A],V=!1,Q=function(We){for(var rt=0,ut=We;rt<ut.length;rt+=1)if(B.overrides&&B.overrides.hasOverride(ut[rt]))return void(V=!0)};if(P.value.kind==="constant"&&P.value.value instanceof mr)Q(P.value.value.sections);else if(P.value.kind==="source"){var me=function(We){V||(We instanceof Li&&ei(We.value)===va?Q(We.value.sections):We instanceof bo?Q(We.sections):We.eachChild(me))},Le=P.value;Le._styleExpression&&me(Le._styleExpression.expression)}return V},d}(Gc),Sc={paint:new fl({"background-color":new Oo(_t.paint_background["background-color"]),"background-pattern":new ou(_t.paint_background["background-pattern"]),"background-opacity":new Oo(_t.paint_background["background-opacity"])})},xu=function(c){function d(g){c.call(this,g,Sc)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Gc),mm={paint:new fl({"raster-opacity":new Oo(_t.paint_raster["raster-opacity"]),"raster-hue-rotate":new Oo(_t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Oo(_t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Oo(_t.paint_raster["raster-brightness-max"]),"raster-saturation":new Oo(_t.paint_raster["raster-saturation"]),"raster-contrast":new Oo(_t.paint_raster["raster-contrast"]),"raster-resampling":new Oo(_t.paint_raster["raster-resampling"]),"raster-fade-duration":new Oo(_t.paint_raster["raster-fade-duration"])})},uf=function(c){function d(g){c.call(this,g,mm)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Gc),qv=function(c){function d(g){c.call(this,g,{}),this.implementation=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(g){this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},d.prototype.onRemove=function(g){this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},d}(Gc),Od={circle:Ep,heatmap:Sp,hillshade:Gv,fill:ay,"fill-extrusion":bu,line:Ah,symbol:As,background:xu,raster:uf},Kd=oe.HTMLImageElement,C1=oe.HTMLCanvasElement,O1=oe.HTMLVideoElement,Qv=oe.ImageData,Jv=oe.ImageBitmap,s0=function(c,d,g,A){this.context=c,this.format=g,this.texture=c.gl.createTexture(),this.update(d,A)};s0.prototype.update=function(c,d,g){var A=c.width,P=c.height,B=!(this.size&&this.size[0]===A&&this.size[1]===P||g),V=this.context,Q=V.gl;if(this.useMipmap=!!(d&&d.useMipmap),Q.bindTexture(Q.TEXTURE_2D,this.texture),V.pixelStoreUnpackFlipY.set(!1),V.pixelStoreUnpack.set(1),V.pixelStoreUnpackPremultiplyAlpha.set(this.format===Q.RGBA&&(!d||d.premultiply!==!1)),B)this.size=[A,P],c instanceof Kd||c instanceof C1||c instanceof O1||c instanceof Qv||Jv&&c instanceof Jv?Q.texImage2D(Q.TEXTURE_2D,0,this.format,this.format,Q.UNSIGNED_BYTE,c):Q.texImage2D(Q.TEXTURE_2D,0,this.format,A,P,0,this.format,Q.UNSIGNED_BYTE,c.data);else{var me=g||{x:0,y:0},Le=me.x,We=me.y;c instanceof Kd||c instanceof C1||c instanceof O1||c instanceof Qv||Jv&&c instanceof Jv?Q.texSubImage2D(Q.TEXTURE_2D,0,Le,We,Q.RGBA,Q.UNSIGNED_BYTE,c):Q.texSubImage2D(Q.TEXTURE_2D,0,Le,We,A,P,Q.RGBA,Q.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Q.generateMipmap(Q.TEXTURE_2D)},s0.prototype.bind=function(c,d,g){var A=this.context.gl;A.bindTexture(A.TEXTURE_2D,this.texture),g!==A.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=A.LINEAR),c!==this.filter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,c),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,g||c),this.filter=c),d!==this.wrap&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,d),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,d),this.wrap=d)},s0.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},s0.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var eg=function(c){var d=this;this._callback=c,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};eg.prototype.trigger=function(){var c=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){c._triggered=!1,c._callback()},0))},eg.prototype.remove=function(){delete this._channel,this._callback=function(){}};var tl=function(c,d,g){this.target=c,this.parent=d,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Gt(["receive","process"],this),this.invoker=new eg(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=He()?c:oe};function R1(c,d,g){var A=2*Math.PI*6378137/256/Math.pow(2,g);return[c*A-2*Math.PI*6378137/2,d*A-2*Math.PI*6378137/2]}tl.prototype.send=function(c,d,g,A,P){var B=this;P===void 0&&(P=!1);var V=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[V]=g);var Q=it(this.globalScope)?void 0:[];return this.target.postMessage({id:V,type:c,hasCallback:!!g,targetMapId:A,mustQueue:P,sourceMapId:this.mapId,data:ml(d,Q)},Q),{cancel:function(){g&&delete B.callbacks[V],B.target.postMessage({id:V,type:"<cancel>",targetMapId:A,sourceMapId:B.mapId})}}},tl.prototype.receive=function(c){var d=c.data,g=d.id;if(g&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[g];var A=this.cancelCallbacks[g];delete this.cancelCallbacks[g],A&&A()}else He()||d.mustQueue?(this.tasks[g]=d,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,d)},tl.prototype.process=function(){if(this.taskQueue.length){var c=this.taskQueue.shift(),d=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(c,d)}},tl.prototype.processTask=function(c,d){var g=this;if(d.type==="<response>"){var A=this.callbacks[c];delete this.callbacks[c],A&&(d.error?A(os(d.error)):A(null,os(d.data)))}else{var P=!1,B=it(this.globalScope)?void 0:[],V=d.hasCallback?function(We,rt){P=!0,delete g.cancelCallbacks[c],g.target.postMessage({id:c,type:"<response>",sourceMapId:g.mapId,error:We?ml(We):null,data:ml(rt,B)},B)}:function(We){P=!0},Q=null,me=os(d.data);if(this.parent[d.type])Q=this.parent[d.type](d.sourceMapId,me,V);else if(this.parent.getWorkerSource){var Le=d.type.split(".");Q=this.parent.getWorkerSource(d.sourceMapId,Le[0],me.source)[Le[1]](me,V)}else V(new Error("Could not find function "+d.type));!P&&Q&&Q.cancel&&(this.cancelCallbacks[c]=Q.cancel)}},tl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Tc=function(c,d){c&&(d?this.setSouthWest(c).setNorthEast(d):c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1]))};Tc.prototype.setNorthEast=function(c){return this._ne=c instanceof Xa?new Xa(c.lng,c.lat):Xa.convert(c),this},Tc.prototype.setSouthWest=function(c){return this._sw=c instanceof Xa?new Xa(c.lng,c.lat):Xa.convert(c),this},Tc.prototype.extend=function(c){var d,g,A=this._sw,P=this._ne;if(c instanceof Xa)d=c,g=c;else{if(!(c instanceof Tc))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(Tc.convert(c)):this.extend(Xa.convert(c)):this;if(g=c._ne,!(d=c._sw)||!g)return this}return A||P?(A.lng=Math.min(d.lng,A.lng),A.lat=Math.min(d.lat,A.lat),P.lng=Math.max(g.lng,P.lng),P.lat=Math.max(g.lat,P.lat)):(this._sw=new Xa(d.lng,d.lat),this._ne=new Xa(g.lng,g.lat)),this},Tc.prototype.getCenter=function(){return new Xa((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Tc.prototype.getSouthWest=function(){return this._sw},Tc.prototype.getNorthEast=function(){return this._ne},Tc.prototype.getNorthWest=function(){return new Xa(this.getWest(),this.getNorth())},Tc.prototype.getSouthEast=function(){return new Xa(this.getEast(),this.getSouth())},Tc.prototype.getWest=function(){return this._sw.lng},Tc.prototype.getSouth=function(){return this._sw.lat},Tc.prototype.getEast=function(){return this._ne.lng},Tc.prototype.getNorth=function(){return this._ne.lat},Tc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Tc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Tc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Tc.prototype.contains=function(c){var d=Xa.convert(c),g=d.lng,A=d.lat,P=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(P=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=A&&A<=this._ne.lat&&P},Tc.convert=function(c){return!c||c instanceof Tc?c:new Tc(c)};var Xa=function(c,d){if(isNaN(c)||isNaN(d))throw new Error("Invalid LngLat object: ("+c+", "+d+")");if(this.lng=+c,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Xa.prototype.wrap=function(){return new Xa(Se(this.lng,-180,180),this.lat)},Xa.prototype.toArray=function(){return[this.lng,this.lat]},Xa.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Xa.prototype.distanceTo=function(c){var d=Math.PI/180,g=this.lat*d,A=c.lat*d,P=Math.sin(g)*Math.sin(A)+Math.cos(g)*Math.cos(A)*Math.cos((c.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(P,1))},Xa.prototype.toBounds=function(c){c===void 0&&(c=0);var d=360*c/40075017,g=d/Math.cos(Math.PI/180*this.lat);return new Tc(new Xa(this.lng-g,this.lat-d),new Xa(this.lng+g,this.lat+d))},Xa.convert=function(c){if(c instanceof Xa)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new Xa(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new Xa(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var sy=2*Math.PI*63710088e-1;function ab(c){return sy*Math.cos(c*Math.PI/180)}function tg(c){return(180+c)/360}function Oh(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function sb(c,d){return c/ab(d)}function sv(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}var Ip=function(c,d,g){g===void 0&&(g=0),this.x=+c,this.y=+d,this.z=+g};Ip.fromLngLat=function(c,d){d===void 0&&(d=0);var g=Xa.convert(c);return new Ip(tg(g.lng),Oh(g.lat),sb(d,g.lat))},Ip.prototype.toLngLat=function(){return new Xa(360*this.x-180,sv(this.y))},Ip.prototype.toAltitude=function(){return this.z*ab(sv(this.y))},Ip.prototype.meterInMercatorCoordinateUnits=function(){return 1/sy*(c=sv(this.y),1/Math.cos(c*Math.PI/180));var c};var Gu=function(c,d,g){this.z=c,this.x=d,this.y=g,this.key=kc(0,c,c,d,g)};Gu.prototype.equals=function(c){return this.z===c.z&&this.x===c.x&&this.y===c.y},Gu.prototype.url=function(c,d){var g,A,P,B,V,Q=(A=this.y,P=this.z,B=R1(256*(g=this.x),256*(A=Math.pow(2,P)-A-1),P),V=R1(256*(g+1),256*(A+1),P),B[0]+","+B[1]+","+V[0]+","+V[1]),me=function(Le,We,rt){for(var ut,Nt="",cn=Le;cn>0;cn--)Nt+=(We&(ut=1<<cn-1)?1:0)+(rt&ut?2:0);return Nt}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",me).replace("{bbox-epsg-3857}",Q)},Gu.prototype.getTilePoint=function(c){var d=Math.pow(2,this.z);return new ae(8192*(c.x*d-this.x),8192*(c.y*d-this.y))},Gu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var wa=function(c,d){this.wrap=c,this.canonical=d,this.key=kc(c,d.z,d.z,d.x,d.y)},tc=function(c,d,g,A,P){this.overscaledZ=c,this.wrap=d,this.canonical=new Gu(g,+A,+P),this.key=kc(d,c,g,A,P)};function kc(c,d,g,A,P){(c*=2)<0&&(c=-1*c-1);var B=1<<g;return(B*B*c+B*P+A).toString(36)+g.toString(36)+d.toString(36)}tc.prototype.equals=function(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)},tc.prototype.scaledTo=function(c){var d=this.canonical.z-c;return c>this.canonical.z?new tc(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new tc(c,this.wrap,c,this.canonical.x>>d,this.canonical.y>>d)},tc.prototype.calculateScaledKey=function(c,d){var g=this.canonical.z-c;return c>this.canonical.z?kc(this.wrap*+d,c,this.canonical.z,this.canonical.x,this.canonical.y):kc(this.wrap*+d,c,c,this.canonical.x>>g,this.canonical.y>>g)},tc.prototype.isChildOf=function(c){if(c.wrap!==this.wrap)return!1;var d=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>d&&c.canonical.y===this.canonical.y>>d},tc.prototype.children=function(c){if(this.overscaledZ>=c)return[new tc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,g=2*this.canonical.x,A=2*this.canonical.y;return[new tc(d,this.wrap,d,g,A),new tc(d,this.wrap,d,g+1,A),new tc(d,this.wrap,d,g,A+1),new tc(d,this.wrap,d,g+1,A+1)]},tc.prototype.isLessThan=function(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))},tc.prototype.wrapped=function(){return new tc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},tc.prototype.unwrapTo=function(c){return new tc(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)},tc.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},tc.prototype.toUnwrapped=function(){return new wa(this.wrap,this.canonical)},tc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},tc.prototype.getTilePoint=function(c){return this.canonical.getTilePoint(new Ip(c.x-this.wrap,c.y))},ho("CanonicalTileID",Gu),ho("OverscaledTileID",tc,{omit:["posMatrix"]});var Lp=function(c,d,g){if(this.uid=c,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return yt('"'+g+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var A=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=g||"mapbox";for(var P=0;P<A;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(A,P)]=this.data[this._idx(A-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,A)]=this.data[this._idx(P,A-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(A,-1)]=this.data[this._idx(A-1,0)],this.data[this._idx(-1,A)]=this.data[this._idx(0,A-1)],this.data[this._idx(A,A)]=this.data[this._idx(A-1,A-1)]};Lp.prototype.get=function(c,d){var g=new Uint8Array(this.data.buffer),A=4*this._idx(c,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[A],g[A+1],g[A+2])},Lp.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Lp.prototype._idx=function(c,d){if(c<-1||c>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(c+1)},Lp.prototype._unpackMapbox=function(c,d,g){return(256*c*256+256*d+g)/10-1e4},Lp.prototype._unpackTerrarium=function(c,d,g){return 256*c+d+g/256-32768},Lp.prototype.getPixels=function(){return new gu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Lp.prototype.backfillBorder=function(c,d,g){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");var A=d*this.dim,P=d*this.dim+this.dim,B=g*this.dim,V=g*this.dim+this.dim;switch(d){case-1:A=P-1;break;case 1:P=A+1}switch(g){case-1:B=V-1;break;case 1:V=B+1}for(var Q=-d*this.dim,me=-g*this.dim,Le=B;Le<V;Le++)for(var We=A;We<P;We++)this.data[this._idx(We,Le)]=c.data[this._idx(We+Q,Le+me)]},ho("DEMData",Lp);var qd=function(c){this._stringToNumber={},this._numberToString=[];for(var d=0;d<c.length;d++){var g=c[d];this._stringToNumber[g]=d,this._numberToString[d]=g}};qd.prototype.encode=function(c){return this._stringToNumber[c]},qd.prototype.decode=function(c){return this._numberToString[c]};var ks=function(c,d,g,A,P){this.type="Feature",this._vectorTileFeature=c,c._z=d,c._x=g,c._y=A,this.properties=c.properties,this.id=P},ly={geometry:{configurable:!0}};ly.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ly.geometry.set=function(c){this._geometry=c},ks.prototype.toJSON=function(){var c={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(c[d]=this[d]);return c},Object.defineProperties(ks.prototype,ly);var Qd=function(){this.state={},this.stateChanges={},this.deletedStates={}};Qd.prototype.updateState=function(c,d,g){var A=String(d);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][A]=this.stateChanges[c][A]||{},we(this.stateChanges[c][A],g),this.deletedStates[c]===null)for(var P in this.deletedStates[c]={},this.state[c])P!==A&&(this.deletedStates[c][P]=null);else if(this.deletedStates[c]&&this.deletedStates[c][A]===null)for(var B in this.deletedStates[c][A]={},this.state[c][A])g[B]||(this.deletedStates[c][A][B]=null);else for(var V in g)this.deletedStates[c]&&this.deletedStates[c][A]&&this.deletedStates[c][A][V]===null&&delete this.deletedStates[c][A][V]},Qd.prototype.removeFeatureState=function(c,d,g){if(this.deletedStates[c]!==null){var A=String(d);if(this.deletedStates[c]=this.deletedStates[c]||{},g&&d!==void 0)this.deletedStates[c][A]!==null&&(this.deletedStates[c][A]=this.deletedStates[c][A]||{},this.deletedStates[c][A][g]=null);else if(d!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][A])for(g in this.deletedStates[c][A]={},this.stateChanges[c][A])this.deletedStates[c][A][g]=null;else this.deletedStates[c][A]=null;else this.deletedStates[c]=null}},Qd.prototype.getState=function(c,d){var g=String(d),A=we({},(this.state[c]||{})[g],(this.stateChanges[c]||{})[g]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){var P=this.deletedStates[c][d];if(P===null)return{};for(var B in P)delete A[B]}return A},Qd.prototype.initializeTileState=function(c,d){c.setFeatureState(this.state,d)},Qd.prototype.coalesceChanges=function(c,d){var g={};for(var A in this.stateChanges){this.state[A]=this.state[A]||{};var P={};for(var B in this.stateChanges[A])this.state[A][B]||(this.state[A][B]={}),we(this.state[A][B],this.stateChanges[A][B]),P[B]=this.state[A][B];g[A]=P}for(var V in this.deletedStates){this.state[V]=this.state[V]||{};var Q={};if(this.deletedStates[V]===null)for(var me in this.state[V])Q[me]={},this.state[V][me]={};else for(var Le in this.deletedStates[V]){if(this.deletedStates[V][Le]===null)this.state[V][Le]={};else for(var We=0,rt=Object.keys(this.deletedStates[V][Le]);We<rt.length;We+=1)delete this.state[V][Le][rt[We]];Q[Le]=this.state[V][Le]}g[V]=g[V]||{},we(g[V],Q)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(var ut in c)c[ut].setFeatureState(g,d)};var Rh=function(c,d){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new za(8192,16,0),this.grid3D=new za(8192,16,0),this.featureIndexArray=new Xe,this.promoteId=d};function M1(c,d,g,A,P){return gt(c,function(B,V){var Q=d instanceof xp?d.get(V):null;return Q&&Q.evaluate?Q.evaluate(g,A,P):Q})}function P1(c){for(var d=1/0,g=1/0,A=-1/0,P=-1/0,B=0,V=c;B<V.length;B+=1){var Q=V[B];d=Math.min(d,Q.x),g=Math.min(g,Q.y),A=Math.max(A,Q.x),P=Math.max(P,Q.y)}return{minX:d,minY:g,maxX:A,maxY:P}}function lb(c,d){return d-c}Rh.prototype.insert=function(c,d,g,A,P,B){var V=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,A,P);for(var Q=B?this.grid3D:this.grid,me=0;me<d.length;me++){for(var Le=d[me],We=[1/0,1/0,-1/0,-1/0],rt=0;rt<Le.length;rt++){var ut=Le[rt];We[0]=Math.min(We[0],ut.x),We[1]=Math.min(We[1],ut.y),We[2]=Math.max(We[2],ut.x),We[3]=Math.max(We[3],ut.y)}We[0]<8192&&We[1]<8192&&We[2]>=0&&We[3]>=0&&Q.insert(V,We[0],We[1],We[2],We[3])}},Rh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new wh.VectorTile(new Rr(this.rawTileData)).layers,this.sourceLayerCoder=new qd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Rh.prototype.query=function(c,d,g,A){var P=this;this.loadVTLayers();for(var B=c.params||{},V=8192/c.tileSize/c.scale,Q=Du(B.filter),me=c.queryGeometry,Le=c.queryPadding*V,We=P1(me),rt=this.grid.query(We.minX-Le,We.minY-Le,We.maxX+Le,We.maxY+Le),ut=P1(c.cameraQueryGeometry),Nt=this.grid3D.query(ut.minX-Le,ut.minY-Le,ut.maxX+Le,ut.maxY+Le,function(Sr,Ir,Xr,Pi){return function(Ci,Ao,ao,Po,Wi){for(var Aa=0,ea=Ci;Aa<ea.length;Aa+=1){var yo=ea[Aa];if(Ao<=yo.x&&ao<=yo.y&&Po>=yo.x&&Wi>=yo.y)return!0}var ma=[new ae(Ao,ao),new ae(Ao,Wi),new ae(Po,Wi),new ae(Po,ao)];if(Ci.length>2){for(var Ma=0,ns=ma;Ma<ns.length;Ma+=1)if(bf(Ci,ns[Ma]))return!0}for(var Wo=0;Wo<Ci.length-1;Wo++)if(Ai(Ci[Wo],Ci[Wo+1],ma))return!0;return!1}(c.cameraQueryGeometry,Sr-Le,Ir-Le,Xr+Le,Pi+Le)}),cn=0,vn=Nt;cn<vn.length;cn+=1)rt.push(vn[cn]);rt.sort(lb);for(var Zn,Nn={},fr=function(Sr){var Ir=rt[Sr];if(Ir!==Zn){Zn=Ir;var Xr=P.featureIndexArray.get(Ir),Pi=null;P.loadMatchingFeature(Nn,Xr.bucketIndex,Xr.sourceLayerIndex,Xr.featureIndex,Q,B.layers,B.availableImages,d,g,A,function(Ci,Ao,ao){return Pi||(Pi=bs(Ci)),Ao.queryIntersectsFeature(me,Ci,ao,Pi,P.z,c.transform,V,c.pixelPosMatrix)})}},yr=0;yr<rt.length;yr++)fr(yr);return Nn},Rh.prototype.loadMatchingFeature=function(c,d,g,A,P,B,V,Q,me,Le,We){var rt=this.bucketLayerIDs[d];if(!B||function(Ci,Ao){for(var ao=0;ao<Ci.length;ao++)if(Ao.indexOf(Ci[ao])>=0)return!0;return!1}(B,rt)){var ut=this.sourceLayerCoder.decode(g),Nt=this.vtLayers[ut].feature(A);if(P.needGeometry){var cn=Qs(Nt,!0);if(!P.filter(new ya(this.tileID.overscaledZ),cn,this.tileID.canonical))return}else if(!P.filter(new ya(this.tileID.overscaledZ),Nt))return;for(var vn=this.getId(Nt,ut),Zn=0;Zn<rt.length;Zn++){var Nn=rt[Zn];if(!(B&&B.indexOf(Nn)<0)){var fr=Q[Nn];if(fr){var yr={};vn!==void 0&&Le&&(yr=Le.getState(fr.sourceLayer||"_geojsonTileLayer",vn));var Sr=we({},me[Nn]);Sr.paint=M1(Sr.paint,fr.paint,Nt,yr,V),Sr.layout=M1(Sr.layout,fr.layout,Nt,yr,V);var Ir=!We||We(Nt,fr,yr);if(Ir){var Xr=new ks(Nt,this.z,this.x,this.y,vn);Xr.layer=Sr;var Pi=c[Nn];Pi===void 0&&(Pi=c[Nn]=[]),Pi.push({featureIndex:A,feature:Xr,intersectionZ:Ir})}}}}}},Rh.prototype.lookupSymbolFeatures=function(c,d,g,A,P,B,V,Q){var me={};this.loadVTLayers();for(var Le=Du(P),We=0,rt=c;We<rt.length;We+=1)this.loadMatchingFeature(me,g,A,rt[We],Le,B,V,Q,d);return me},Rh.prototype.hasLayer=function(c){for(var d=0,g=this.bucketLayerIDs;d<g.length;d+=1)for(var A=0,P=g[d];A<P.length;A+=1)if(c===P[A])return!0;return!1},Rh.prototype.getId=function(c,d){var g=c.id;return this.promoteId&&typeof(g=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(g=Number(g)),g},ho("FeatureIndex",Rh,{omit:["rawTileData","sourceLayerCoder"]});var qc=function(c,d){this.tileID=c,this.uid=Ze(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};qc.prototype.registerFadeDuration=function(c){var d=c+this.timeAdded;d<$n.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},qc.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},qc.prototype.loadVectorData=function(c,d,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){for(var A in c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(Le,We){var rt={};if(!We)return rt;for(var ut=function(){var vn=cn[Nt],Zn=vn.layerIds.map(function(yr){return We.getLayer(yr)}).filter(Boolean);if(Zn.length!==0){vn.layers=Zn,vn.stateDependentLayerIds&&(vn.stateDependentLayers=vn.stateDependentLayerIds.map(function(yr){return Zn.filter(function(Sr){return Sr.id===yr})[0]}));for(var Nn=0,fr=Zn;Nn<fr.length;Nn+=1)rt[fr[Nn].id]=vn}},Nt=0,cn=Le;Nt<cn.length;Nt+=1)ut();return rt}(c.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var P=this.buckets[A];if(P instanceof Ui){if(this.hasSymbolBuckets=!0,!g)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var B in this.buckets){var V=this.buckets[B];if(V instanceof Ui&&V.hasRTLText){this.hasRTLText=!0,vu.isLoading()||vu.isLoaded()||sm()!=="deferred"||Fu();break}}for(var Q in this.queryPadding=0,this.buckets){var me=this.buckets[Q];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(Q).queryRadius(me))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new S},qc.prototype.unloadVectorData=function(){for(var c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},qc.prototype.getBucket=function(c){return this.buckets[c.id]},qc.prototype.upload=function(c){for(var d in this.buckets){var g=this.buckets[d];g.uploadPending()&&g.upload(c)}var A=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s0(c,this.imageAtlas.image,A.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s0(c,this.glyphAtlasImage,A.ALPHA),this.glyphAtlasImage=null)},qc.prototype.prepare=function(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)},qc.prototype.queryRenderedFeatures=function(c,d,g,A,P,B,V,Q,me,Le){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:A,cameraQueryGeometry:P,scale:B,tileSize:this.tileSize,pixelPosMatrix:Le,transform:Q,params:V,queryPadding:this.queryPadding*me},c,d,g):{}},qc.prototype.querySourceFeatures=function(c,d){var g=this.latestFeatureIndex;if(g&&g.rawTileData){var A=g.loadVTLayers(),P=d?d.sourceLayer:"",B=A._geojsonTileLayer||A[P];if(B)for(var V=Du(d&&d.filter),Q=this.tileID.canonical,me=Q.z,Le=Q.x,We=Q.y,rt={z:me,x:Le,y:We},ut=0;ut<B.length;ut++){var Nt=B.feature(ut);if(V.needGeometry){var cn=Qs(Nt,!0);if(!V.filter(new ya(this.tileID.overscaledZ),cn,this.tileID.canonical))continue}else if(!V.filter(new ya(this.tileID.overscaledZ),Nt))continue;var vn=g.getId(Nt,P),Zn=new ks(Nt,me,Le,We,vn);Zn.tile=rt,c.push(Zn)}}},qc.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},qc.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},qc.prototype.setExpiryData=function(c){var d=this.expirationTime;if(c.cacheControl){var g=Rt(c.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){var A=Date.now(),P=!1;if(this.expirationTime>A)P=!1;else if(d)if(this.expirationTime<d)P=!0;else{var B=this.expirationTime-d;B?this.expirationTime=A+Math.max(B,3e4):P=!0}else P=!0;P?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},qc.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},qc.prototype.setFeatureState=function(c,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(c).length!==0){var g=this.latestFeatureIndex.loadVTLayers();for(var A in this.buckets)if(d.style.hasLayer(A)){var P=this.buckets[A],B=P.layers[0].sourceLayer||"_geojsonTileLayer",V=g[B],Q=c[B];if(V&&Q&&Object.keys(Q).length!==0){P.update(Q,V,this.imageAtlas&&this.imageAtlas.patternPositions||{});var me=d&&d.style&&d.style.getLayer(A);me&&(this.queryPadding=Math.max(this.queryPadding,me.queryRadius(P)))}}}},qc.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},qc.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<$n.now()},qc.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},qc.prototype.setHoldDuration=function(c){this.symbolFadeHoldUntil=$n.now()+c},qc.prototype.setDependencies=function(c,d){for(var g={},A=0,P=d;A<P.length;A+=1)g[P[A]]=!0;this.dependencies[c]=g},qc.prototype.hasDependency=function(c,d){for(var g=0,A=c;g<A.length;g+=1){var P=this.dependencies[A[g]];if(P){for(var B=0,V=d;B<V.length;B+=1)if(P[V[B]])return!0}}return!1};var l0=oe.performance,cy=function(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},l0.mark(this._marks.start)};cy.prototype.finish=function(){l0.mark(this._marks.end);var c=l0.getEntriesByName(this._marks.measure);return c.length===0&&(l0.measure(this._marks.measure,this._marks.start,this._marks.end),c=l0.getEntriesByName(this._marks.measure),l0.clearMarks(this._marks.start),l0.clearMarks(this._marks.end),l0.clearMeasures(this._marks.measure)),c},E.Actor=tl,E.AlphaImage=io,E.CanonicalTileID=Gu,E.CollisionBoxArray=S,E.Color=mn,E.DEMData=Lp,E.DataConstantProperty=Oo,E.DictionaryCoder=qd,E.EXTENT=8192,E.ErrorEvent=tn,E.EvaluationParameters=ya,E.Event=Et,E.Evented=fn,E.FeatureIndex=Rh,E.FillBucket=Sf,E.FillExtrusionBucket=lu,E.ImageAtlas=$r,E.ImagePosition=Ki,E.LineBucket=cu,E.LngLat=Xa,E.LngLatBounds=Tc,E.MercatorCoordinate=Ip,E.ONE_EM=24,E.OverscaledTileID=tc,E.Point=ae,E.Point$1=ae,E.Properties=fl,E.Protobuf=Rr,E.RGBAImage=gu,E.RequestManager=Ut,E.RequestPerformance=cy,E.ResourceType=Ne,E.SegmentVector=jt,E.SourceFeatureState=Qd,E.StructArrayLayout1ui2=L0,E.StructArrayLayout2f1f2i16=ah,E.StructArrayLayout2i4=Yh,E.StructArrayLayout3ui6=sh,E.StructArrayLayout4i8=qp,E.SymbolBucket=Ui,E.Texture=s0,E.Tile=qc,E.Transitionable=uc,E.Uniform1f=Yr,E.Uniform1i=ri,E.Uniform2f=wi,E.Uniform3f=Hi,E.Uniform4f=Lo,E.UniformColor=Fo,E.UniformMatrix4f=fa,E.UnwrappedTileID=wa,E.ValidationError=en,E.WritingMode=zo,E.ZoomHistory=yp,E.add=function(c,d,g){return c[0]=d[0]+g[0],c[1]=d[1]+g[1],c[2]=d[2]+g[2],c},E.addDynamicAttributes=mi,E.asyncAll=function(c,d,g){if(!c.length)return g(null,[]);var A=c.length,P=new Array(c.length),B=null;c.forEach(function(V,Q){d(V,function(me,Le){me&&(B=me),P[Q]=Le,--A==0&&g(B,P)})})},E.bezier=te,E.bindAll=Gt,E.browser=$n,E.cacheEntryPossiblyAdded=function(c){++dt>Wt&&(c.getActor().send("enforceCacheSizeLimit",pt),dt=0)},E.clamp=De,E.clearTileCache=function(c){var d=oe.caches.delete("mapbox-tiles");c&&d.catch(c).then(function(){return c()})},E.clipLine=ch,E.clone=function(c){var d=new No(16);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15],d},E.clone$1=Re,E.clone$2=function(c){var d=new No(3);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d},E.collisionCircleLayout=Fe,E.config=nr,E.create=function(){var c=new No(16);return No!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},E.create$1=function(){var c=new No(9);return No!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},E.create$2=function(){var c=new No(4);return No!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},E.createCommonjsModule=ve,E.createExpression=Fs,E.createLayout=fc,E.createStyleLayer=function(c){return c.type==="custom"?new qv(c):new Od[c.type](c)},E.cross=function(c,d,g){var A=d[0],P=d[1],B=d[2],V=g[0],Q=g[1],me=g[2];return c[0]=P*me-B*Q,c[1]=B*V-A*me,c[2]=A*Q-P*V,c},E.deepEqual=function c(d,g){if(Array.isArray(d)){if(!Array.isArray(g)||d.length!==g.length)return!1;for(var A=0;A<d.length;A++)if(!c(d[A],g[A]))return!1;return!0}if(typeof d=="object"&&d!==null&&g!==null){if(typeof g!="object"||Object.keys(d).length!==Object.keys(g).length)return!1;for(var P in d)if(!c(d[P],g[P]))return!1;return!0}return d===g},E.dot=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]},E.dot$1=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3]},E.ease=ye,E.emitValidationErrors=_s,E.endsWith=mt,E.enforceCacheSizeLimit=function(c){An(),Zt&&Zt.then(function(d){d.keys().then(function(g){for(var A=0;A<g.length-c;A++)d.delete(g[A])})})},E.evaluateSizeForFeature=ec,E.evaluateSizeForZoom=mc,E.evaluateVariableOffset=Kn,E.evented=bp,E.extend=we,E.featureFilter=Du,E.filterObject=Be,E.fromRotation=function(c,d){var g=Math.sin(d),A=Math.cos(d);return c[0]=A,c[1]=g,c[2]=0,c[3]=-g,c[4]=A,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},E.getAnchorAlignment=el,E.getAnchorJustification=ir,E.getArrayBuffer=br,E.getImage=xe,E.getJSON=function(c,d){return Qn(we(c,{type:"json"}),d)},E.getRTLTextPluginStatus=sm,E.getReferrer=Pt,E.getVideo=function(c,d){var g,A,P=oe.document.createElement("video");P.muted=!0,P.onloadstart=function(){d(null,P)};for(var B=0;B<c.length;B++){var V=oe.document.createElement("source");g=c[B],A=void 0,(A=oe.document.createElement("a")).href=g,(A.protocol!==oe.document.location.protocol||A.host!==oe.document.location.host)&&(P.crossOrigin="Anonymous"),V.src=c[B],P.appendChild(V)}return{cancel:function(){}}},E.identity=kl,E.invert=function(c,d){var g=d[0],A=d[1],P=d[2],B=d[3],V=d[4],Q=d[5],me=d[6],Le=d[7],We=d[8],rt=d[9],ut=d[10],Nt=d[11],cn=d[12],vn=d[13],Zn=d[14],Nn=d[15],fr=g*Q-A*V,yr=g*me-P*V,Sr=g*Le-B*V,Ir=A*me-P*Q,Xr=A*Le-B*Q,Pi=P*Le-B*me,Ci=We*vn-rt*cn,Ao=We*Zn-ut*cn,ao=We*Nn-Nt*cn,Po=rt*Zn-ut*vn,Wi=rt*Nn-Nt*vn,Aa=ut*Nn-Nt*Zn,ea=fr*Aa-yr*Wi+Sr*Po+Ir*ao-Xr*Ao+Pi*Ci;return ea?(c[0]=(Q*Aa-me*Wi+Le*Po)*(ea=1/ea),c[1]=(P*Wi-A*Aa-B*Po)*ea,c[2]=(vn*Pi-Zn*Xr+Nn*Ir)*ea,c[3]=(ut*Xr-rt*Pi-Nt*Ir)*ea,c[4]=(me*ao-V*Aa-Le*Ao)*ea,c[5]=(g*Aa-P*ao+B*Ao)*ea,c[6]=(Zn*Sr-cn*Pi-Nn*yr)*ea,c[7]=(We*Pi-ut*Sr+Nt*yr)*ea,c[8]=(V*Wi-Q*ao+Le*Ci)*ea,c[9]=(A*ao-g*Wi-B*Ci)*ea,c[10]=(cn*Xr-vn*Sr+Nn*fr)*ea,c[11]=(rt*Sr-We*Xr-Nt*fr)*ea,c[12]=(Q*Ao-V*Po-me*Ci)*ea,c[13]=(g*Po-A*Ao+P*Ci)*ea,c[14]=(vn*yr-cn*Ir-Zn*fr)*ea,c[15]=(We*Ir-rt*yr+ut*fr)*ea,c):null},E.isChar=Ii,E.isMapboxURL=Dt,E.keysDifference=function(c,d){var g=[];for(var A in c)A in d||g.push(A);return g},E.makeRequest=Qn,E.mapObject=gt,E.mercatorXfromLng=tg,E.mercatorYfromLat=Oh,E.mercatorZfromAltitude=sb,E.mul=Zd,E.multiply=Xl,E.mvt=wh,E.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},E.normalize=function(c,d){var g=d[0],A=d[1],P=d[2],B=g*g+A*A+P*P;return B>0&&(B=1/Math.sqrt(B)),c[0]=d[0]*B,c[1]=d[1]*B,c[2]=d[2]*B,c},E.number=Xs,E.offscreenCanvasSupported=be,E.ortho=function(c,d,g,A,P,B,V){var Q=1/(d-g),me=1/(A-P),Le=1/(B-V);return c[0]=-2*Q,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*me,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*Le,c[11]=0,c[12]=(d+g)*Q,c[13]=(P+A)*me,c[14]=(V+B)*Le,c[15]=1,c},E.parseGlyphPBF=function(c){return new Rr(c).readFields(si,[])},E.pbf=Rr,E.performSymbolLayout=function(c,d,g,A,P,B,V){c.createArrays(),c.tilePixelRatio=8192/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;var Q=c.layers[0].layout,me=c.layers[0]._unevaluatedLayout._values,Le={};if(c.textSizeData.kind==="composite"){var We=c.textSizeData,rt=We.maxZoom;Le.compositeTextSizes=[me["text-size"].possiblyEvaluate(new ya(We.minZoom),V),me["text-size"].possiblyEvaluate(new ya(rt),V)]}if(c.iconSizeData.kind==="composite"){var ut=c.iconSizeData,Nt=ut.maxZoom;Le.compositeIconSizes=[me["icon-size"].possiblyEvaluate(new ya(ut.minZoom),V),me["icon-size"].possiblyEvaluate(new ya(Nt),V)]}Le.layoutTextSize=me["text-size"].possiblyEvaluate(new ya(c.zoom+1),V),Le.layoutIconSize=me["icon-size"].possiblyEvaluate(new ya(c.zoom+1),V),Le.textMaxSize=me["text-size"].possiblyEvaluate(new ya(18));for(var cn=24*Q.get("text-line-height"),vn=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",Zn=Q.get("text-keep-upright"),Nn=Q.get("text-size"),fr=function(){var Ir=Sr[yr],Xr=Q.get("text-font").evaluate(Ir,{},V).join(","),Pi=Nn.evaluate(Ir,{},V),Ci=Le.layoutTextSize.evaluate(Ir,{},V),Ao=Le.layoutIconSize.evaluate(Ir,{},V),ao={horizontal:{},vertical:void 0},Po=Ir.text,Wi=[0,0];if(Po){var Aa=Po.toString(),ea=24*Q.get("text-letter-spacing").evaluate(Ir,{},V),yo=function(es){for(var Ys=0,zs=es;Ys<zs.length;Ys+=1)if(gs=zs[Ys].charCodeAt(0),Ii.Arabic(gs)||Ii["Arabic Supplement"](gs)||Ii["Arabic Extended-A"](gs)||Ii["Arabic Presentation Forms-A"](gs)||Ii["Arabic Presentation Forms-B"](gs))return!1;var gs;return!0}(Aa)?ea:0,ma=Q.get("text-anchor").evaluate(Ir,{},V),Ma=Q.get("text-variable-anchor");if(!Ma){var ns=Q.get("text-radial-offset").evaluate(Ir,{},V);Wi=ns?Kn(ma,[24*ns,Un]):Q.get("text-offset").evaluate(Ir,{},V).map(function(es){return 24*es})}var Wo=vn?"center":Q.get("text-justify").evaluate(Ir,{},V),Cs=Q.get("symbol-placement"),bl=Cs==="point"?24*Q.get("text-max-width").evaluate(Ir,{},V):0,Ul=function(){c.allowVerticalPlacement&&th(Aa)&&(ao.vertical=Da(Po,d,g,P,Xr,bl,cn,ma,"left",yo,Wi,zo.vertical,!0,Cs,Ci,Pi))};if(!vn&&Ma){for(var jl=Wo==="auto"?Ma.map(function(es){return ir(es)}):[Wo],xl=!1,nc=0;nc<jl.length;nc++){var Hs=jl[nc];if(!ao.horizontal[Hs])if(xl)ao.horizontal[Hs]=ao.horizontal[0];else{var wc=Da(Po,d,g,P,Xr,bl,cn,"center",Hs,yo,Wi,zo.horizontal,!1,Cs,Ci,Pi);wc&&(ao.horizontal[Hs]=wc,xl=wc.positionedLines.length===1)}}Ul()}else{Wo==="auto"&&(Wo=ir(ma));var Xu=Da(Po,d,g,P,Xr,bl,cn,ma,Wo,yo,Wi,zo.horizontal,!1,Cs,Ci,Pi);Xu&&(ao.horizontal[Wo]=Xu),Ul(),th(Aa)&&vn&&Zn&&(ao.vertical=Da(Po,d,g,P,Xr,bl,cn,ma,Wo,yo,Wi,zo.vertical,!1,Cs,Ci,Pi))}}var zc=void 0,uu=!1;if(Ir.icon&&Ir.icon.name){var Vl=A[Ir.icon.name];Vl&&(zc=function(es,Ys,zs){var gs=el(zs),Yu=Ys[0]-es.displaySize[0]*gs.horizontalAlign,fu=Ys[1]-es.displaySize[1]*gs.verticalAlign;return{image:es,top:fu,bottom:fu+es.displaySize[1],left:Yu,right:Yu+es.displaySize[0]}}(P[Ir.icon.name],Q.get("icon-offset").evaluate(Ir,{},V),Q.get("icon-anchor").evaluate(Ir,{},V)),uu=Vl.sdf,c.sdfIcons===void 0?c.sdfIcons=Vl.sdf:c.sdfIcons!==Vl.sdf&&yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Vl.pixelRatio!==c.pixelRatio||Q.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}var Uc=Hn(ao.horizontal)||ao.vertical;c.iconsInText=!!Uc&&Uc.iconsInText,(Uc||zc)&&function(es,Ys,zs,gs,Yu,fu,Us,rc,Ac,ss,$u){var Uf=fu.textMaxSize.evaluate(Ys,{});Uf===void 0&&(Uf=Us);var Jd,ic=es.layers[0].layout,uh=ic.get("icon-offset").evaluate(Ys,{},$u),Tf=Hn(zs.horizontal),ep=Us/24,ed=es.tilePixelRatio*ep,c0=es.tilePixelRatio*Uf/24,td=es.tilePixelRatio*rc,u0=es.tilePixelRatio*ic.get("symbol-spacing"),vm=ic.get("text-padding")*es.tilePixelRatio,f0=ic.get("icon-padding")*es.tilePixelRatio,gm=ic.get("text-max-angle")/180*Math.PI,ng=ic.get("text-rotation-alignment")==="map"&&ic.get("symbol-placement")!=="point",uy=ic.get("icon-rotation-alignment")==="map"&&ic.get("symbol-placement")!=="point",nd=ic.get("symbol-placement"),Dp=u0/2,j0=ic.get("icon-text-fit");gs&&j0!=="none"&&(es.allowVerticalPlacement&&zs.vertical&&(Jd=zl(gs,zs.vertical,j0,ic.get("icon-text-fit-padding"),uh,ep)),Tf&&(gs=zl(gs,Tf,j0,ic.get("icon-text-fit-padding"),uh,ep)));var rd=function(ig,Sm){Sm.x<0||Sm.x>=8192||Sm.y<0||Sm.y>=8192||function(Ol,jc,id,Eu,dv,fy,og,ff,ag,pv,np,mv,Tm,I1,vv,L1,sg,D1,N1,lg,wf,Z0,hy,rp,dy){var py,m0,Vc,wm,Am,W0=Ol.addToLineVertexArray(jc,id),v0=0,B1=0,vy=0,gy=0,Cm=-1,cg=-1,Mh={},yy=un(""),gv=0,ug=0;if(ff._unevaluatedLayout.getValue("text-radial-offset")===void 0?(gv=(py=ff.layout.get("text-offset").evaluate(wf,{},rp).map(function(ip){return 24*ip}))[0],ug=py[1]):(gv=24*ff.layout.get("text-radial-offset").evaluate(wf,{},rp),ug=Un),Ol.allowVerticalPlacement&&Eu.vertical){var Rl=ff.layout.get("text-rotate").evaluate(wf,{},rp)+90;wm=new Es(ag,jc,pv,np,mv,Eu.vertical,Tm,I1,vv,Rl),og&&(Am=new Es(ag,jc,pv,np,mv,og,sg,D1,vv,Rl))}if(dv){var _y=ff.layout.get("icon-rotate").evaluate(wf,{}),by=ff.layout.get("icon-text-fit")!=="none",cb=ln(dv,_y,hy,by),F1=og?ln(og,_y,hy,by):void 0;Vc=new Es(ag,jc,pv,np,mv,dv,sg,D1,!1,_y),v0=4*cb.length;var fg=Ol.iconSizeData,Om=null;fg.kind==="source"?(Om=[128*ff.layout.get("icon-size").evaluate(wf,{})])[0]>32640&&yt(Ol.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):fg.kind==="composite"&&((Om=[128*Z0.compositeIconSizes[0].evaluate(wf,{},rp),128*Z0.compositeIconSizes[1].evaluate(wf,{},rp)])[0]>32640||Om[1]>32640)&&yt(Ol.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ol.addSymbols(Ol.icon,cb,Om,lg,N1,wf,!1,jc,W0.lineStartIndex,W0.lineLength,-1,rp),Cm=Ol.icon.placedSymbolArray.length-1,F1&&(B1=4*F1.length,Ol.addSymbols(Ol.icon,F1,Om,lg,N1,wf,zo.vertical,jc,W0.lineStartIndex,W0.lineLength,-1,rp),cg=Ol.icon.placedSymbolArray.length-1)}for(var ub in Eu.horizontal){var ds=Eu.horizontal[ub];if(!m0){yy=un(ds.text);var xy=ff.layout.get("text-rotate").evaluate(wf,{},rp);m0=new Es(ag,jc,pv,np,mv,ds,Tm,I1,vv,xy)}var hg=ds.positionedLines.length===1;if(vy+=yn(Ol,jc,ds,fy,ff,vv,wf,L1,W0,Eu.vertical?zo.horizontal:zo.horizontalOnly,hg?Object.keys(Eu.horizontal):[ub],Mh,Cm,Z0,rp),hg)break}Eu.vertical&&(gy+=yn(Ol,jc,Eu.vertical,fy,ff,vv,wf,L1,W0,zo.vertical,["vertical"],Mh,cg,Z0,rp));var Ph=m0?m0.boxStartIndex:Ol.collisionBoxArray.length,Rm=m0?m0.boxEndIndex:Ol.collisionBoxArray.length,Mm=wm?wm.boxStartIndex:Ol.collisionBoxArray.length,Ey=wm?wm.boxEndIndex:Ol.collisionBoxArray.length,G0=Vc?Vc.boxStartIndex:Ol.collisionBoxArray.length,yv=Vc?Vc.boxEndIndex:Ol.collisionBoxArray.length,dg=Am?Am.boxStartIndex:Ol.collisionBoxArray.length,fb=Am?Am.boxEndIndex:Ol.collisionBoxArray.length,od=-1,Up=function(ip,_v){return ip&&ip.circleDiameter?Math.max(ip.circleDiameter,_v):_v};od=Up(m0,od),od=Up(wm,od),od=Up(Vc,od);var g0=(od=Up(Am,od))>-1?1:0;g0&&(od*=dy/24),Ol.glyphOffsetArray.length>=Ui.MAX_GLYPHS&&yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wf.sortKey!==void 0&&Ol.addToSortKeyRanges(Ol.symbolInstances.length,wf.sortKey),Ol.symbolInstances.emplaceBack(jc.x,jc.y,Mh.right>=0?Mh.right:-1,Mh.center>=0?Mh.center:-1,Mh.left>=0?Mh.left:-1,Mh.vertical||-1,Cm,cg,yy,Ph,Rm,Mm,Ey,G0,yv,dg,fb,pv,vy,gy,v0,B1,g0,0,Tm,gv,ug,od)}(es,Sm,ig,zs,gs,Yu,Jd,es.layers[0],es.collisionBoxArray,Ys.index,Ys.sourceLayerIndex,es.index,ed,vm,ng,Ac,td,f0,uy,uh,Ys,fu,ss,$u,Us)};if(nd==="line")for(var Np=0,lv=ch(Ys.geometry,0,0,8192,8192);Np<lv.length;Np+=1)for(var rg=lv[Np],ym=0,Bp=Kl(rg,u0,gm,zs.vertical||Tf,gs,24,c0,es.overscaling,8192);ym<Bp.length;ym+=1){var h0=Bp[ym];Tf&&Kt(es,Tf.text,Dp,h0)||rd(rg,h0)}else if(nd==="line-center")for(var _m=0,cv=Ys.geometry;_m<cv.length;_m+=1){var bm=cv[_m];if(bm.length>1){var uv=Za(bm,gm,zs.vertical||Tf,gs,24,c0);uv&&rd(bm,uv)}}else if(Ys.type==="Polygon")for(var V0=0,Fp=yu(Ys.geometry,0);V0<Fp.length;V0+=1){var kp=Fp[V0],d0=Mn(kp,16);rd(kp[0],new as(d0.x,d0.y,0))}else if(Ys.type==="LineString")for(var tp=0,p0=Ys.geometry;tp<p0.length;tp+=1){var zp=p0[tp];rd(zp,new as(zp[0].x,zp[0].y,0))}else if(Ys.type==="Point")for(var xm=0,fv=Ys.geometry;xm<fv.length;xm+=1)for(var Em=0,hv=fv[xm];Em<hv.length;Em+=1){var H0=hv[Em];rd([H0],new as(H0.x,H0.y,0))}}(c,Ir,ao,zc,A,Le,Ci,Ao,Wi,uu,V)},yr=0,Sr=c.features;yr<Sr.length;yr+=1)fr();B&&c.generateCollisionDebugBuffers()},E.perspective=function(c,d,g,A,P){var B,V=1/Math.tan(d/2);return c[0]=V/g,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=V,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,P!=null&&P!==1/0?(c[10]=(P+A)*(B=1/(A-P)),c[14]=2*P*A*B):(c[10]=-1,c[14]=-2*A),c},E.pick=function(c,d){for(var g={},A=0;A<d.length;A++){var P=d[A];P in c&&(g[P]=c[P])}return g},E.plugin=vu,E.polygonIntersectsPolygon=_f,E.postMapLoadEvent=hn,E.postTurnstileEvent=Wn,E.potpack=ha,E.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],E.register=ho,E.registerForPluginStateChange=function(c){return c({pluginStatus:Bc,pluginURL:nh}),bp.on("pluginStateChange",c),c},E.renderColorRamp=lm,E.rotate=function(c,d,g){var A=d[0],P=d[1],B=d[2],V=d[3],Q=Math.sin(g),me=Math.cos(g);return c[0]=A*me+B*Q,c[1]=P*me+V*Q,c[2]=A*-Q+B*me,c[3]=P*-Q+V*me,c},E.rotateX=function(c,d,g){var A=Math.sin(g),P=Math.cos(g),B=d[4],V=d[5],Q=d[6],me=d[7],Le=d[8],We=d[9],rt=d[10],ut=d[11];return d!==c&&(c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[4]=B*P+Le*A,c[5]=V*P+We*A,c[6]=Q*P+rt*A,c[7]=me*P+ut*A,c[8]=Le*P-B*A,c[9]=We*P-V*A,c[10]=rt*P-Q*A,c[11]=ut*P-me*A,c},E.rotateZ=function(c,d,g){var A=Math.sin(g),P=Math.cos(g),B=d[0],V=d[1],Q=d[2],me=d[3],Le=d[4],We=d[5],rt=d[6],ut=d[7];return d!==c&&(c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[0]=B*P+Le*A,c[1]=V*P+We*A,c[2]=Q*P+rt*A,c[3]=me*P+ut*A,c[4]=Le*P-B*A,c[5]=We*P-V*A,c[6]=rt*P-Q*A,c[7]=ut*P-me*A,c},E.scale=function(c,d,g){var A=g[0],P=g[1],B=g[2];return c[0]=d[0]*A,c[1]=d[1]*A,c[2]=d[2]*A,c[3]=d[3]*A,c[4]=d[4]*P,c[5]=d[5]*P,c[6]=d[6]*P,c[7]=d[7]*P,c[8]=d[8]*B,c[9]=d[9]*B,c[10]=d[10]*B,c[11]=d[11]*B,c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],c},E.scale$1=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c[3]=d[3]*g,c},E.scale$2=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c},E.setCacheLimits=function(c,d){pt=c,Wt=d},E.setRTLTextPlugin=function(c,d,g){if(g===void 0&&(g=!1),Bc==="deferred"||Bc==="loading"||Bc==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");nh=$n.resolveURL(c),Bc="deferred",Kp=d,Td(),g||Fu()},E.sphericalToCartesian=function(c){var d=c[0],g=c[1],A=c[2];return g+=90,g*=Math.PI/180,A*=Math.PI/180,{x:d*Math.cos(g)*Math.sin(A),y:d*Math.sin(g)*Math.sin(A),z:d*Math.cos(A)}},E.sqrLen=function(c){var d=c[0],g=c[1];return d*d+g*g},E.styleSpec=_t,E.sub=function(c,d,g){return c[0]=d[0]-g[0],c[1]=d[1]-g[1],c[2]=d[2]-g[2],c},E.symbolSize=Ra,E.transformMat3=function(c,d,g){var A=d[0],P=d[1],B=d[2];return c[0]=A*g[0]+P*g[3]+B*g[6],c[1]=A*g[1]+P*g[4]+B*g[7],c[2]=A*g[2]+P*g[5]+B*g[8],c},E.transformMat4=lf,E.translate=function(c,d,g){var A,P,B,V,Q,me,Le,We,rt,ut,Nt,cn,vn=g[0],Zn=g[1],Nn=g[2];return d===c?(c[12]=d[0]*vn+d[4]*Zn+d[8]*Nn+d[12],c[13]=d[1]*vn+d[5]*Zn+d[9]*Nn+d[13],c[14]=d[2]*vn+d[6]*Zn+d[10]*Nn+d[14],c[15]=d[3]*vn+d[7]*Zn+d[11]*Nn+d[15]):(P=d[1],B=d[2],V=d[3],Q=d[4],me=d[5],Le=d[6],We=d[7],rt=d[8],ut=d[9],Nt=d[10],cn=d[11],c[0]=A=d[0],c[1]=P,c[2]=B,c[3]=V,c[4]=Q,c[5]=me,c[6]=Le,c[7]=We,c[8]=rt,c[9]=ut,c[10]=Nt,c[11]=cn,c[12]=A*vn+Q*Zn+rt*Nn+d[12],c[13]=P*vn+me*Zn+ut*Nn+d[13],c[14]=B*vn+Le*Zn+Nt*Nn+d[14],c[15]=V*vn+We*Zn+cn*Nn+d[15]),c},E.triggerPluginCompletionEvent=Jm,E.uniqueId=Ze,E.validateCustomStyleLayer=function(c){var d=[],g=c.id;return g===void 0&&d.push({message:"layers."+g+': missing required property "id"'}),c.render===void 0&&d.push({message:"layers."+g+': missing required method "render"'}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&d.push({message:"layers."+g+': property "renderingMode" must be either "2d" or "3d"'}),d},E.validateLight=$i,E.validateStyle=gi,E.values=function(c){var d=[];for(var g in c)d.push(c[g]);return d},E.vectorTile=wh,E.version="1.13.3",E.warnOnce=yt,E.webpSupported=Ht,E.window=oe,E.wrap=Se}),X(["./shared"],function(E){"use strict";function ve(Ae){var xe=typeof Ae;if(xe==="number"||xe==="boolean"||xe==="string"||Ae==null)return JSON.stringify(Ae);if(Array.isArray(Ae)){for(var ke="[",tt=0,Et=Ae;tt<Et.length;tt+=1)ke+=ve(Et[tt])+",";return ke+"]"}for(var tn=Object.keys(Ae).sort(),fn="{",_t=0;_t<tn.length;_t++)fn+=JSON.stringify(tn[_t])+":"+ve(Ae[tn[_t]])+",";return fn+"}"}function re(Ae){for(var xe="",ke=0,tt=E.refProperties;ke<tt.length;ke+=1)xe+="/"+ve(Ae[tt[ke]]);return xe}var fe=function(Ae){this.keyCache={},Ae&&this.replace(Ae)};fe.prototype.replace=function(Ae){this._layerConfigs={},this._layers={},this.update(Ae,[])},fe.prototype.update=function(Ae,xe){for(var ke=this,tt=0,Et=Ae;tt<Et.length;tt+=1){var tn=Et[tt];this._layerConfigs[tn.id]=tn;var fn=this._layers[tn.id]=E.createStyleLayer(tn);fn._featureFilter=E.featureFilter(fn.filter),this.keyCache[tn.id]&&delete this.keyCache[tn.id]}for(var _t=0,en=xe;_t<en.length;_t+=1){var Gn=en[_t];delete this.keyCache[Gn],delete this._layerConfigs[Gn],delete this._layers[Gn]}this.familiesBySource={};for(var Tr=0,jr=function(di,vi){for(var vo={},Oi=0;Oi<di.length;Oi++){var Ko=vi&&vi[di[Oi].id]||re(di[Oi]);vi&&(vi[di[Oi].id]=Ko);var va=vo[Ko];va||(va=vo[Ko]=[]),va.push(di[Oi])}var Co=[];for(var Xo in vo)Co.push(vo[Xo]);return Co}(E.values(this._layerConfigs),this.keyCache);Tr<jr.length;Tr+=1){var vr=jr[Tr].map(function(di){return ke._layers[di.id]}),Ur=vr[0];if(Ur.visibility!=="none"){var Fr=Ur.source||"",qr=this.familiesBySource[Fr];qr||(qr=this.familiesBySource[Fr]={});var wr=Ur.sourceLayer||"_geojsonTileLayer",fi=qr[wr];fi||(fi=qr[wr]=[]),fi.push(vr)}}};var ae=function(Ae){var xe={},ke=[];for(var tt in Ae){var Et=Ae[tt],tn=xe[tt]={};for(var fn in Et){var _t=Et[+fn];if(_t&&_t.bitmap.width!==0&&_t.bitmap.height!==0){var en={x:0,y:0,w:_t.bitmap.width+2,h:_t.bitmap.height+2};ke.push(en),tn[fn]={rect:en,metrics:_t.metrics}}}}var Gn=E.potpack(ke),Tr=new E.AlphaImage({width:Gn.w||1,height:Gn.h||1});for(var jr in Ae){var vr=Ae[jr];for(var Ur in vr){var Fr=vr[+Ur];if(Fr&&Fr.bitmap.width!==0&&Fr.bitmap.height!==0){var qr=xe[jr][Ur].rect;E.AlphaImage.copy(Fr.bitmap,Tr,{x:0,y:0},{x:qr.x+1,y:qr.y+1},Fr.bitmap)}}}this.image=Tr,this.positions=xe};E.register("GlyphAtlas",ae);var Ee=function(Ae){this.tileID=new E.OverscaledTileID(Ae.tileID.overscaledZ,Ae.tileID.wrap,Ae.tileID.canonical.z,Ae.tileID.canonical.x,Ae.tileID.canonical.y),this.uid=Ae.uid,this.zoom=Ae.zoom,this.pixelRatio=Ae.pixelRatio,this.tileSize=Ae.tileSize,this.source=Ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ae.showCollisionBoxes,this.collectResourceTiming=!!Ae.collectResourceTiming,this.returnDependencies=!!Ae.returnDependencies,this.promoteId=Ae.promoteId};function oe(Ae,xe,ke){for(var tt=new E.EvaluationParameters(xe),Et=0,tn=Ae;Et<tn.length;Et+=1)tn[Et].recalculate(tt,ke)}function ze(Ae,xe){var ke=E.getArrayBuffer(Ae.request,function(tt,Et,tn,fn){tt?xe(tt):Et&&xe(null,{vectorTile:new E.vectorTile.VectorTile(new E.pbf(Et)),rawData:Et,cacheControl:tn,expires:fn})});return function(){ke.cancel(),xe()}}Ee.prototype.parse=function(Ae,xe,ke,tt,Et){var tn=this;this.status="parsing",this.data=Ae,this.collisionBoxArray=new E.CollisionBoxArray;var fn=new E.DictionaryCoder(Object.keys(Ae.layers).sort()),_t=new E.FeatureIndex(this.tileID,this.promoteId);_t.bucketLayerIDs=[];var en,Gn,Tr,jr,vr={},Ur={featureIndex:_t,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ke},Fr=xe.familiesBySource[this.source];for(var qr in Fr){var wr=Ae.layers[qr];if(wr){wr.version===1&&E.warnOnce('Vector tile source "'+this.source+'" layer "'+qr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var fi=fn.encode(qr),di=[],vi=0;vi<wr.length;vi++){var vo=wr.feature(vi),Oi=_t.getId(vo,qr);di.push({feature:vo,id:Oi,index:vi,sourceLayerIndex:fi})}for(var Ko=0,va=Fr[qr];Ko<va.length;Ko+=1){var Co=va[Ko],Xo=Co[0];Xo.minzoom&&this.zoom<Math.floor(Xo.minzoom)||Xo.maxzoom&&this.zoom>=Xo.maxzoom||Xo.visibility!=="none"&&(oe(Co,this.zoom,ke),(vr[Xo.id]=Xo.createBucket({index:_t.bucketLayerIDs.length,layers:Co,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fi,sourceID:this.source})).populate(di,Ur,this.tileID.canonical),_t.bucketLayerIDs.push(Co.map(function(Ln){return Ln.id})))}}}var Ye=E.mapObject(Ur.glyphDependencies,function(Ln){return Object.keys(Ln).map(Number)});Object.keys(Ye).length?tt.send("getGlyphs",{uid:this.uid,stacks:Ye},function(Ln,zn){en||(en=Ln,Gn=zn,sn.call(tn))}):Gn={};var Ke=Object.keys(Ur.iconDependencies);Ke.length?tt.send("getImages",{icons:Ke,source:this.source,tileID:this.tileID,type:"icons"},function(Ln,zn){en||(en=Ln,Tr=zn,sn.call(tn))}):Tr={};var Ct=Object.keys(Ur.patternDependencies);function sn(){if(en)return Et(en);if(Gn&&Tr&&jr){var Ln=new ae(Gn),zn=new E.ImageAtlas(Tr,jr);for(var mn in vr){var wn=vr[mn];wn instanceof E.SymbolBucket?(oe(wn.layers,this.zoom,ke),E.performSymbolLayout(wn,Gn,Ln.positions,Tr,zn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):wn.hasPattern&&(wn instanceof E.LineBucket||wn instanceof E.FillBucket||wn instanceof E.FillExtrusionBucket)&&(oe(wn.layers,this.zoom,ke),wn.addFeatures(Ur,this.tileID.canonical,zn.patternPositions))}this.status="done",Et(null,{buckets:E.values(vr).filter(function(gr){return!gr.isEmpty()}),featureIndex:_t,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ln.image,imageAtlas:zn,glyphMap:this.returnDependencies?Gn:null,iconMap:this.returnDependencies?Tr:null,glyphPositions:this.returnDependencies?Ln.positions:null})}}Ct.length?tt.send("getImages",{icons:Ct,source:this.source,tileID:this.tileID,type:"patterns"},function(Ln,zn){en||(en=Ln,jr=zn,sn.call(tn))}):jr={},sn.call(this)};var te=function(Ae,xe,ke,tt){this.actor=Ae,this.layerIndex=xe,this.availableImages=ke,this.loadVectorData=tt||ze,this.loading={},this.loaded={}};te.prototype.loadTile=function(Ae,xe){var ke=this,tt=Ae.uid;this.loading||(this.loading={});var Et=!!(Ae&&Ae.request&&Ae.request.collectResourceTiming)&&new E.RequestPerformance(Ae.request),tn=this.loading[tt]=new Ee(Ae);tn.abort=this.loadVectorData(Ae,function(fn,_t){if(delete ke.loading[tt],fn||!_t)return tn.status="done",ke.loaded[tt]=tn,xe(fn);var en=_t.rawData,Gn={};_t.expires&&(Gn.expires=_t.expires),_t.cacheControl&&(Gn.cacheControl=_t.cacheControl);var Tr={};if(Et){var jr=Et.finish();jr&&(Tr.resourceTiming=JSON.parse(JSON.stringify(jr)))}tn.vectorTile=_t.vectorTile,tn.parse(_t.vectorTile,ke.layerIndex,ke.availableImages,ke.actor,function(vr,Ur){if(vr||!Ur)return xe(vr);xe(null,E.extend({rawTileData:en.slice(0)},Ur,Gn,Tr))}),ke.loaded=ke.loaded||{},ke.loaded[tt]=tn})},te.prototype.reloadTile=function(Ae,xe){var ke=this,tt=this.loaded,Et=Ae.uid,tn=this;if(tt&&tt[Et]){var fn=tt[Et];fn.showCollisionBoxes=Ae.showCollisionBoxes;var _t=function(en,Gn){var Tr=fn.reloadCallback;Tr&&(delete fn.reloadCallback,fn.parse(fn.vectorTile,tn.layerIndex,ke.availableImages,tn.actor,Tr)),xe(en,Gn)};fn.status==="parsing"?fn.reloadCallback=_t:fn.status==="done"&&(fn.vectorTile?fn.parse(fn.vectorTile,this.layerIndex,this.availableImages,this.actor,_t):_t())}},te.prototype.abortTile=function(Ae,xe){var ke=this.loading,tt=Ae.uid;ke&&ke[tt]&&ke[tt].abort&&(ke[tt].abort(),delete ke[tt]),xe()},te.prototype.removeTile=function(Ae,xe){var ke=this.loaded,tt=Ae.uid;ke&&ke[tt]&&delete ke[tt],xe()};var ye=E.window.ImageBitmap,De=function(){this.loaded={}};function Se(Ae,xe){if(Ae.length!==0){we(Ae[0],xe);for(var ke=1;ke<Ae.length;ke++)we(Ae[ke],!xe)}}function we(Ae,xe){for(var ke=0,tt=0,Et=0,tn=Ae.length,fn=tn-1;Et<tn;fn=Et++){var _t=(Ae[Et][0]-Ae[fn][0])*(Ae[fn][1]+Ae[Et][1]),en=ke+_t;tt+=Math.abs(ke)>=Math.abs(_t)?ke-en+_t:_t-en+ke,ke=en}ke+tt>=0!=!!xe&&Ae.reverse()}De.prototype.loadTile=function(Ae,xe){var ke=Ae.uid,tt=Ae.encoding,Et=Ae.rawImageData,tn=ye&&Et instanceof ye?this.getImageData(Et):Et,fn=new E.DEMData(ke,tn,tt);this.loaded=this.loaded||{},this.loaded[ke]=fn,xe(null,fn)},De.prototype.getImageData=function(Ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ae.width,Ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ae.width,this.offscreenCanvas.height=Ae.height,this.offscreenCanvasContext.drawImage(Ae,0,0,Ae.width,Ae.height);var xe=this.offscreenCanvasContext.getImageData(-1,-1,Ae.width+2,Ae.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new E.RGBAImage({width:xe.width,height:xe.height},xe.data)},De.prototype.removeTile=function(Ae){var xe=this.loaded,ke=Ae.uid;xe&&xe[ke]&&delete xe[ke]};var ce=E.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ze=function(Ae){this._feature=Ae,this.extent=E.EXTENT,this.type=Ae.type,this.properties=Ae.tags,"id"in Ae&&!isNaN(Ae.id)&&(this.id=parseInt(Ae.id,10))};Ze.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ae=[],xe=0,ke=this._feature.geometry;xe<ke.length;xe+=1){var tt=ke[xe];Ae.push([new E.Point$1(tt[0],tt[1])])}return Ae}for(var Et=[],tn=0,fn=this._feature.geometry;tn<fn.length;tn+=1){for(var _t=[],en=0,Gn=fn[tn];en<Gn.length;en+=1){var Tr=Gn[en];_t.push(new E.Point$1(Tr[0],Tr[1]))}Et.push(_t)}return Et},Ze.prototype.toGeoJSON=function(Ae,xe,ke){return ce.call(this,Ae,xe,ke)};var xt=function(Ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.EXTENT,this.length=Ae.length,this._features=Ae};xt.prototype.feature=function(Ae){return new Ze(this._features[Ae])};var ht=E.vectorTile.VectorTileFeature,Gt=mt;function mt(Ae,xe){this.options=xe||{},this.features=Ae,this.length=Ae.length}function gt(Ae,xe){this.id=typeof Ae.id=="number"?Ae.id:void 0,this.type=Ae.type,this.rawGeometry=Ae.type===1?[Ae.geometry]:Ae.geometry,this.properties=Ae.tags,this.extent=xe||4096}mt.prototype.feature=function(Ae){return new gt(this.features[Ae],this.options.extent)},gt.prototype.loadGeometry=function(){var Ae=this.rawGeometry;this.geometry=[];for(var xe=0;xe<Ae.length;xe++){for(var ke=Ae[xe],tt=[],Et=0;Et<ke.length;Et++)tt.push(new E.Point$1(ke[Et][0],ke[Et][1]));this.geometry.push(tt)}return this.geometry},gt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ae=this.geometry,xe=1/0,ke=-1/0,tt=1/0,Et=-1/0,tn=0;tn<Ae.length;tn++)for(var fn=Ae[tn],_t=0;_t<fn.length;_t++){var en=fn[_t];xe=Math.min(xe,en.x),ke=Math.max(ke,en.x),tt=Math.min(tt,en.y),Et=Math.max(Et,en.y)}return[xe,tt,ke,Et]},gt.prototype.toGeoJSON=ht.prototype.toGeoJSON;var Be=bt,Re=Gt;function bt(Ae){var xe=new E.pbf;return function(ke,tt){for(var Et in ke.layers)tt.writeMessage(3,yt,ke.layers[Et])}(Ae,xe),xe.finish()}function yt(Ae,xe){var ke;xe.writeVarintField(15,Ae.version||1),xe.writeStringField(1,Ae.name||""),xe.writeVarintField(5,Ae.extent||4096);var tt={keys:[],values:[],keycache:{},valuecache:{}};for(ke=0;ke<Ae.length;ke++)tt.feature=Ae.feature(ke),xe.writeMessage(2,At,tt);var Et=tt.keys;for(ke=0;ke<Et.length;ke++)xe.writeStringField(3,Et[ke]);var tn=tt.values;for(ke=0;ke<tn.length;ke++)xe.writeMessage(4,it,tn[ke])}function At(Ae,xe){var ke=Ae.feature;ke.id!==void 0&&xe.writeVarintField(1,ke.id),xe.writeMessage(2,bn,Ae),xe.writeVarintField(3,ke.type),xe.writeMessage(4,Oe,ke)}function bn(Ae,xe){var ke=Ae.feature,tt=Ae.keys,Et=Ae.values,tn=Ae.keycache,fn=Ae.valuecache;for(var _t in ke.properties){var en=tn[_t];en===void 0&&(tt.push(_t),tn[_t]=en=tt.length-1),xe.writeVarint(en);var Gn=ke.properties[_t],Tr=typeof Gn;Tr!=="string"&&Tr!=="boolean"&&Tr!=="number"&&(Gn=JSON.stringify(Gn));var jr=Tr+":"+Gn,vr=fn[jr];vr===void 0&&(Et.push(Gn),fn[jr]=vr=Et.length-1),xe.writeVarint(vr)}}function He(Ae,xe){return(xe<<3)+(7&Ae)}function Rt(Ae){return Ae<<1^Ae>>31}function Oe(Ae,xe){for(var ke=Ae.loadGeometry(),tt=Ae.type,Et=0,tn=0,fn=ke.length,_t=0;_t<fn;_t++){var en=ke[_t],Gn=1;tt===1&&(Gn=en.length),xe.writeVarint(He(1,Gn));for(var Tr=tt===3?en.length-1:en.length,jr=0;jr<Tr;jr++){jr===1&&tt!==1&&xe.writeVarint(He(2,Tr-1));var vr=en[jr].x-Et,Ur=en[jr].y-tn;xe.writeVarint(Rt(vr)),xe.writeVarint(Rt(Ur)),Et+=vr,tn+=Ur}tt===3&&xe.writeVarint(He(7,1))}}function it(Ae,xe){var ke=typeof Ae;ke==="string"?xe.writeStringField(1,Ae):ke==="boolean"?xe.writeBooleanField(7,Ae):ke==="number"&&(Ae%1!=0?xe.writeDoubleField(3,Ae):Ae<0?xe.writeSVarintField(6,Ae):xe.writeVarintField(5,Ae))}function Qe(Ae,xe,ke,tt){$e(Ae,ke,tt),$e(xe,2*ke,2*tt),$e(xe,2*ke+1,2*tt+1)}function $e(Ae,xe,ke){var tt=Ae[xe];Ae[xe]=Ae[ke],Ae[ke]=tt}function Ot(Ae,xe,ke,tt){var Et=Ae-ke,tn=xe-tt;return Et*Et+tn*tn}Be.fromVectorTileJs=bt,Be.fromGeojsonVt=function(Ae,xe){xe=xe||{};var ke={};for(var tt in Ae)ke[tt]=new Gt(Ae[tt].features,xe),ke[tt].name=tt,ke[tt].version=xe.version,ke[tt].extent=xe.extent;return bt({layers:ke})},Be.GeoJSONWrapper=Re;var vt=function(Ae){return Ae[0]},Me=function(Ae){return Ae[1]},Xt=function(Ae,xe,ke,tt,Et){xe===void 0&&(xe=vt),ke===void 0&&(ke=Me),tt===void 0&&(tt=64),Et===void 0&&(Et=Float64Array),this.nodeSize=tt,this.points=Ae;for(var tn=Ae.length<65536?Uint16Array:Uint32Array,fn=this.ids=new tn(Ae.length),_t=this.coords=new Et(2*Ae.length),en=0;en<Ae.length;en++)fn[en]=en,_t[2*en]=xe(Ae[en]),_t[2*en+1]=ke(Ae[en]);(function Gn(Tr,jr,vr,Ur,Fr,qr){if(!(Fr-Ur<=vr)){var wr=Ur+Fr>>1;(function fi(di,vi,vo,Oi,Ko,va){for(;Ko>Oi;){if(Ko-Oi>600){var Co=Ko-Oi+1,Xo=vo-Oi+1,Ye=Math.log(Co),Ke=.5*Math.exp(2*Ye/3),Ct=.5*Math.sqrt(Ye*Ke*(Co-Ke)/Co)*(Xo-Co/2<0?-1:1);fi(di,vi,vo,Math.max(Oi,Math.floor(vo-Xo*Ke/Co+Ct)),Math.min(Ko,Math.floor(vo+(Co-Xo)*Ke/Co+Ct)),va)}var sn=vi[2*vo+va],Ln=Oi,zn=Ko;for(Qe(di,vi,Oi,vo),vi[2*Ko+va]>sn&&Qe(di,vi,Oi,Ko);Ln<zn;){for(Qe(di,vi,Ln,zn),Ln++,zn--;vi[2*Ln+va]<sn;)Ln++;for(;vi[2*zn+va]>sn;)zn--}vi[2*Oi+va]===sn?Qe(di,vi,Oi,zn):Qe(di,vi,++zn,Ko),zn<=vo&&(Oi=zn+1),vo<=zn&&(Ko=zn-1)}})(Tr,jr,wr,Ur,Fr,qr%2),Gn(Tr,jr,vr,Ur,wr-1,qr+1),Gn(Tr,jr,vr,wr+1,Fr,qr+1)}})(fn,_t,tt,0,fn.length-1,0)};Xt.prototype.range=function(Ae,xe,ke,tt){return function(Et,tn,fn,_t,en,Gn,Tr){for(var jr,vr,Ur=[0,Et.length-1,0],Fr=[];Ur.length;){var qr=Ur.pop(),wr=Ur.pop(),fi=Ur.pop();if(wr-fi<=Tr)for(var di=fi;di<=wr;di++)vr=tn[2*di+1],(jr=tn[2*di])>=fn&&jr<=en&&vr>=_t&&vr<=Gn&&Fr.push(Et[di]);else{var vi=Math.floor((fi+wr)/2);vr=tn[2*vi+1],(jr=tn[2*vi])>=fn&&jr<=en&&vr>=_t&&vr<=Gn&&Fr.push(Et[vi]);var vo=(qr+1)%2;(qr===0?fn<=jr:_t<=vr)&&(Ur.push(fi),Ur.push(vi-1),Ur.push(vo)),(qr===0?en>=jr:Gn>=vr)&&(Ur.push(vi+1),Ur.push(wr),Ur.push(vo))}}return Fr}(this.ids,this.coords,Ae,xe,ke,tt,this.nodeSize)},Xt.prototype.within=function(Ae,xe,ke){return function(tt,Et,tn,fn,_t,en){for(var Gn=[0,tt.length-1,0],Tr=[],jr=_t*_t;Gn.length;){var vr=Gn.pop(),Ur=Gn.pop(),Fr=Gn.pop();if(Ur-Fr<=en)for(var qr=Fr;qr<=Ur;qr++)Ot(Et[2*qr],Et[2*qr+1],tn,fn)<=jr&&Tr.push(tt[qr]);else{var wr=Math.floor((Fr+Ur)/2),fi=Et[2*wr],di=Et[2*wr+1];Ot(fi,di,tn,fn)<=jr&&Tr.push(tt[wr]);var vi=(vr+1)%2;(vr===0?tn-_t<=fi:fn-_t<=di)&&(Gn.push(Fr),Gn.push(wr-1),Gn.push(vi)),(vr===0?tn+_t>=fi:fn+_t>=di)&&(Gn.push(wr+1),Gn.push(Ur),Gn.push(vi))}}return Tr}(this.ids,this.coords,Ae,xe,ke,this.nodeSize)};var on={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ae){return Ae}},Fn=function(Ae){this.options=an(Object.create(on),Ae),this.trees=new Array(this.options.maxZoom+1)};function $n(Ae,xe,ke,tt,Et){return{x:Ae,y:xe,zoom:1/0,id:ke,parentId:-1,numPoints:tt,properties:Et}}function nr(Ae,xe){var ke=Ae.geometry.coordinates,tt=ke[1];return{x:_n(ke[0]),y:tr(tt),zoom:1/0,index:xe,parentId:-1}}function Ht(Ae){return{type:"Feature",id:Ae.id,properties:Jt(Ae),geometry:{type:"Point",coordinates:[(tt=Ae.x,360*(tt-.5)),(xe=Ae.y,ke=(180-360*xe)*Math.PI/180,360*Math.atan(Math.exp(ke))/Math.PI-90)]}};var xe,ke,tt}function Jt(Ae){var xe=Ae.numPoints,ke=xe>=1e4?Math.round(xe/1e3)+"k":xe>=1e3?Math.round(xe/100)/10+"k":xe;return an(an({},Ae.properties),{cluster:!0,cluster_id:Ae.id,point_count:xe,point_count_abbreviated:ke})}function _n(Ae){return Ae/360+.5}function tr(Ae){var xe=Math.sin(Ae*Math.PI/180),ke=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return ke<0?0:ke>1?1:ke}function an(Ae,xe){for(var ke in xe)Ae[ke]=xe[ke];return Ae}function Ut(Ae){return Ae.x}function Dt(Ae){return Ae.y}function Ie(Ae,xe,ke,tt,Et,tn){var fn=Et-ke,_t=tn-tt;if(fn!==0||_t!==0){var en=((Ae-ke)*fn+(xe-tt)*_t)/(fn*fn+_t*_t);en>1?(ke=Et,tt=tn):en>0&&(ke+=fn*en,tt+=_t*en)}return(fn=Ae-ke)*fn+(_t=xe-tt)*_t}function qe(Ae,xe,ke,tt){var Et={id:Ae===void 0?null:Ae,type:xe,geometry:ke,tags:tt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(tn){var fn=tn.geometry,_t=tn.type;if(_t==="Point"||_t==="MultiPoint"||_t==="LineString")Bt(tn,fn);else if(_t==="Polygon"||_t==="MultiLineString")for(var en=0;en<fn.length;en++)Bt(tn,fn[en]);else if(_t==="MultiPolygon")for(en=0;en<fn.length;en++)for(var Gn=0;Gn<fn[en].length;Gn++)Bt(tn,fn[en][Gn])}(Et),Et}function Bt(Ae,xe){for(var ke=0;ke<xe.length;ke+=3)Ae.minX=Math.min(Ae.minX,xe[ke]),Ae.minY=Math.min(Ae.minY,xe[ke+1]),Ae.maxX=Math.max(Ae.maxX,xe[ke]),Ae.maxY=Math.max(Ae.maxY,xe[ke+1])}function j(Ae,xe,ke,tt){if(xe.geometry){var Et=xe.geometry.coordinates,tn=xe.geometry.type,fn=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2),_t=[],en=xe.id;if(ke.promoteId?en=xe.properties[ke.promoteId]:ke.generateId&&(en=tt||0),tn==="Point")le(Et,_t);else if(tn==="MultiPoint")for(var Gn=0;Gn<Et.length;Gn++)le(Et[Gn],_t);else if(tn==="LineString")z(Et,_t,fn,!1);else if(tn==="MultiLineString"){if(ke.lineMetrics){for(Gn=0;Gn<Et.length;Gn++)z(Et[Gn],_t=[],fn,!1),Ae.push(qe(en,"LineString",_t,xe.properties));return}de(Et,_t,fn,!1)}else if(tn==="Polygon")de(Et,_t,fn,!0);else{if(tn!=="MultiPolygon"){if(tn==="GeometryCollection"){for(Gn=0;Gn<xe.geometry.geometries.length;Gn++)j(Ae,{id:en,geometry:xe.geometry.geometries[Gn],properties:xe.properties},ke,tt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Gn=0;Gn<Et.length;Gn++){var Tr=[];de(Et[Gn],Tr,fn,!0),_t.push(Tr)}}Ae.push(qe(en,tn,_t,xe.properties))}}function le(Ae,xe){xe.push(Zt(Ae[0])),xe.push(nt(Ae[1])),xe.push(0)}function z(Ae,xe,ke,tt){for(var Et,tn,fn=0,_t=0;_t<Ae.length;_t++){var en=Zt(Ae[_t][0]),Gn=nt(Ae[_t][1]);xe.push(en),xe.push(Gn),xe.push(0),_t>0&&(fn+=tt?(Et*Gn-en*tn)/2:Math.sqrt(Math.pow(en-Et,2)+Math.pow(Gn-tn,2))),Et=en,tn=Gn}var Tr=xe.length-3;xe[2]=1,function jr(vr,Ur,Fr,qr){for(var wr,fi=qr,di=Fr-Ur>>1,vi=Fr-Ur,vo=vr[Ur],Oi=vr[Ur+1],Ko=vr[Fr],va=vr[Fr+1],Co=Ur+3;Co<Fr;Co+=3){var Xo=Ie(vr[Co],vr[Co+1],vo,Oi,Ko,va);if(Xo>fi)wr=Co,fi=Xo;else if(Xo===fi){var Ye=Math.abs(Co-di);Ye<vi&&(wr=Co,vi=Ye)}}fi>qr&&(wr-Ur>3&&jr(vr,Ur,wr,qr),vr[wr+2]=fi,Fr-wr>3&&jr(vr,wr,Fr,qr))}(xe,0,Tr,ke),xe[Tr+2]=1,xe.size=Math.abs(fn),xe.start=0,xe.end=xe.size}function de(Ae,xe,ke,tt){for(var Et=0;Et<Ae.length;Et++){var tn=[];z(Ae[Et],tn,ke,tt),xe.push(tn)}}function Zt(Ae){return Ae/360+.5}function nt(Ae){var xe=Math.sin(Ae*Math.PI/180),ke=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return ke<0?0:ke>1?1:ke}function St(Ae,xe,ke,tt,Et,tn,fn,_t){if(tt/=xe,tn>=(ke/=xe)&&fn<tt)return Ae;if(fn<ke||tn>=tt)return null;for(var en=[],Gn=0;Gn<Ae.length;Gn++){var Tr=Ae[Gn],jr=Tr.geometry,vr=Tr.type,Ur=Et===0?Tr.minX:Tr.minY,Fr=Et===0?Tr.maxX:Tr.maxY;if(Ur>=ke&&Fr<tt)en.push(Tr);else if(!(Fr<ke||Ur>=tt)){var qr=[];if(vr==="Point"||vr==="MultiPoint")In(jr,qr,ke,tt,Et);else if(vr==="LineString")Wn(jr,qr,ke,tt,Et,!1,_t.lineMetrics);else if(vr==="MultiLineString")hn(jr,qr,ke,tt,Et,!1);else if(vr==="Polygon")hn(jr,qr,ke,tt,Et,!0);else if(vr==="MultiPolygon")for(var wr=0;wr<jr.length;wr++){var fi=[];hn(jr[wr],fi,ke,tt,Et,!0),fi.length&&qr.push(fi)}if(qr.length){if(_t.lineMetrics&&vr==="LineString"){for(wr=0;wr<qr.length;wr++)en.push(qe(Tr.id,vr,qr[wr],Tr.tags));continue}vr!=="LineString"&&vr!=="MultiLineString"||(qr.length===1?(vr="LineString",qr=qr[0]):vr="MultiLineString"),vr!=="Point"&&vr!=="MultiPoint"||(vr=qr.length===3?"Point":"MultiPoint"),en.push(qe(Tr.id,vr,qr,Tr.tags))}}}return en.length?en:null}function In(Ae,xe,ke,tt,Et){for(var tn=0;tn<Ae.length;tn+=3){var fn=Ae[tn+Et];fn>=ke&&fn<=tt&&(xe.push(Ae[tn]),xe.push(Ae[tn+1]),xe.push(Ae[tn+2]))}}function Wn(Ae,xe,ke,tt,Et,tn,fn){for(var _t,en,Gn=qn(Ae),Tr=Et===0?Wt:An,jr=Ae.start,vr=0;vr<Ae.length-3;vr+=3){var Ur=Ae[vr],Fr=Ae[vr+1],qr=Ae[vr+2],wr=Ae[vr+3],fi=Ae[vr+4],di=Et===0?Ur:Fr,vi=Et===0?wr:fi,vo=!1;fn&&(_t=Math.sqrt(Math.pow(Ur-wr,2)+Math.pow(Fr-fi,2))),di<ke?vi>ke&&(en=Tr(Gn,Ur,Fr,wr,fi,ke),fn&&(Gn.start=jr+_t*en)):di>tt?vi<tt&&(en=Tr(Gn,Ur,Fr,wr,fi,tt),fn&&(Gn.start=jr+_t*en)):pt(Gn,Ur,Fr,qr),vi<ke&&di>=ke&&(en=Tr(Gn,Ur,Fr,wr,fi,ke),vo=!0),vi>tt&&di<=tt&&(en=Tr(Gn,Ur,Fr,wr,fi,tt),vo=!0),!tn&&vo&&(fn&&(Gn.end=jr+_t*en),xe.push(Gn),Gn=qn(Ae)),fn&&(jr+=_t)}var Oi=Ae.length-3;Ur=Ae[Oi],Fr=Ae[Oi+1],qr=Ae[Oi+2],(di=Et===0?Ur:Fr)>=ke&&di<=tt&&pt(Gn,Ur,Fr,qr),Oi=Gn.length-3,tn&&Oi>=3&&(Gn[Oi]!==Gn[0]||Gn[Oi+1]!==Gn[1])&&pt(Gn,Gn[0],Gn[1],Gn[2]),Gn.length&&xe.push(Gn)}function qn(Ae){var xe=[];return xe.size=Ae.size,xe.start=Ae.start,xe.end=Ae.end,xe}function hn(Ae,xe,ke,tt,Et,tn){for(var fn=0;fn<Ae.length;fn++)Wn(Ae[fn],xe,ke,tt,Et,tn,!1)}function pt(Ae,xe,ke,tt){Ae.push(xe),Ae.push(ke),Ae.push(tt)}function Wt(Ae,xe,ke,tt,Et,tn){var fn=(tn-xe)/(tt-xe);return Ae.push(tn),Ae.push(ke+(Et-ke)*fn),Ae.push(1),fn}function An(Ae,xe,ke,tt,Et,tn){var fn=(tn-ke)/(Et-ke);return Ae.push(xe+(tt-xe)*fn),Ae.push(tn),Ae.push(1),fn}function Pn(Ae,xe){for(var ke=[],tt=0;tt<Ae.length;tt++){var Et,tn=Ae[tt],fn=tn.type;if(fn==="Point"||fn==="MultiPoint"||fn==="LineString")Et=Xn(tn.geometry,xe);else if(fn==="MultiLineString"||fn==="Polygon"){Et=[];for(var _t=0;_t<tn.geometry.length;_t++)Et.push(Xn(tn.geometry[_t],xe))}else if(fn==="MultiPolygon")for(Et=[],_t=0;_t<tn.geometry.length;_t++){for(var en=[],Gn=0;Gn<tn.geometry[_t].length;Gn++)en.push(Xn(tn.geometry[_t][Gn],xe));Et.push(en)}ke.push(qe(tn.id,fn,Et,tn.tags))}return ke}function Xn(Ae,xe){var ke=[];ke.size=Ae.size,Ae.start!==void 0&&(ke.start=Ae.start,ke.end=Ae.end);for(var tt=0;tt<Ae.length;tt+=3)ke.push(Ae[tt]+xe,Ae[tt+1],Ae[tt+2]);return ke}function dt(Ae,xe){if(Ae.transformed)return Ae;var ke,tt,Et,tn=1<<Ae.z,fn=Ae.x,_t=Ae.y;for(ke=0;ke<Ae.features.length;ke++){var en=Ae.features[ke],Gn=en.geometry,Tr=en.type;if(en.geometry=[],Tr===1)for(tt=0;tt<Gn.length;tt+=2)en.geometry.push(be(Gn[tt],Gn[tt+1],xe,tn,fn,_t));else for(tt=0;tt<Gn.length;tt++){var jr=[];for(Et=0;Et<Gn[tt].length;Et+=2)jr.push(be(Gn[tt][Et],Gn[tt][Et+1],xe,tn,fn,_t));en.geometry.push(jr)}}return Ae.transformed=!0,Ae}function be(Ae,xe,ke,tt,Et,tn){return[Math.round(ke*(Ae*tt-Et)),Math.round(ke*(xe*tt-tn))]}function Ne(Ae,xe,ke,tt,Et){for(var tn=xe===Et.maxZoom?0:Et.tolerance/((1<<xe)*Et.extent),fn={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ke,y:tt,z:xe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},_t=0;_t<Ae.length;_t++){fn.numFeatures++,ot(fn,Ae[_t],tn,Et);var en=Ae[_t].minX,Gn=Ae[_t].minY,Tr=Ae[_t].maxX,jr=Ae[_t].maxY;en<fn.minX&&(fn.minX=en),Gn<fn.minY&&(fn.minY=Gn),Tr>fn.maxX&&(fn.maxX=Tr),jr>fn.maxY&&(fn.maxY=jr)}return fn}function ot(Ae,xe,ke,tt){var Et=xe.geometry,tn=xe.type,fn=[];if(tn==="Point"||tn==="MultiPoint")for(var _t=0;_t<Et.length;_t+=3)fn.push(Et[_t]),fn.push(Et[_t+1]),Ae.numPoints++,Ae.numSimplified++;else if(tn==="LineString")Pt(fn,Et,Ae,ke,!1,!1);else if(tn==="MultiLineString"||tn==="Polygon")for(_t=0;_t<Et.length;_t++)Pt(fn,Et[_t],Ae,ke,tn==="Polygon",_t===0);else if(tn==="MultiPolygon")for(var en=0;en<Et.length;en++){var Gn=Et[en];for(_t=0;_t<Gn.length;_t++)Pt(fn,Gn[_t],Ae,ke,!0,_t===0)}if(fn.length){var Tr=xe.tags||null;if(tn==="LineString"&&tt.lineMetrics){for(var jr in Tr={},xe.tags)Tr[jr]=xe.tags[jr];Tr.mapbox_clip_start=Et.start/Et.size,Tr.mapbox_clip_end=Et.end/Et.size}var vr={geometry:fn,type:tn==="Polygon"||tn==="MultiPolygon"?3:tn==="LineString"||tn==="MultiLineString"?2:1,tags:Tr};xe.id!==null&&(vr.id=xe.id),Ae.features.push(vr)}}function Pt(Ae,xe,ke,tt,Et,tn){var fn=tt*tt;if(tt>0&&xe.size<(Et?fn:tt))ke.numPoints+=xe.length/3;else{for(var _t=[],en=0;en<xe.length;en+=3)(tt===0||xe[en+2]>fn)&&(ke.numSimplified++,_t.push(xe[en]),_t.push(xe[en+1])),ke.numPoints++;Et&&function(Gn,Tr){for(var jr=0,vr=0,Ur=Gn.length,Fr=Ur-2;vr<Ur;Fr=vr,vr+=2)jr+=(Gn[vr]-Gn[Fr])*(Gn[vr+1]+Gn[Fr+1]);if(jr>0===Tr)for(vr=0,Ur=Gn.length;vr<Ur/2;vr+=2){var qr=Gn[vr],wr=Gn[vr+1];Gn[vr]=Gn[Ur-2-vr],Gn[vr+1]=Gn[Ur-1-vr],Gn[Ur-2-vr]=qr,Gn[Ur-1-vr]=wr}}(_t,tn),Ae.push(_t)}}function It(Ae,xe){var ke=(xe=this.options=function(Et,tn){for(var fn in tn)Et[fn]=tn[fn];return Et}(Object.create(this.options),xe)).debug;if(ke&&console.time("preprocess data"),xe.maxZoom<0||xe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(xe.promoteId&&xe.generateId)throw new Error("promoteId and generateId cannot be used together.");var tt=function(Et,tn){var fn=[];if(Et.type==="FeatureCollection")for(var _t=0;_t<Et.features.length;_t++)j(fn,Et.features[_t],tn,_t);else j(fn,Et.type==="Feature"?Et:{geometry:Et},tn);return fn}(Ae,xe);this.tiles={},this.tileCoords=[],ke&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",xe.indexMaxZoom,xe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(tt=function(Et,tn){var fn=tn.buffer/tn.extent,_t=Et,en=St(Et,1,-1-fn,fn,0,-1,2,tn),Gn=St(Et,1,1-fn,2+fn,0,-1,2,tn);return(en||Gn)&&(_t=St(Et,1,-fn,1+fn,0,-1,2,tn)||[],en&&(_t=Pn(en,1).concat(_t)),Gn&&(_t=_t.concat(Pn(Gn,-1)))),_t}(tt,xe)).length&&this.splitTile(tt,0,0,0),ke&&(tt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xn(Ae,xe,ke){return 32*((1<<Ae)*ke+xe)+Ae}function Qn(Ae,xe){var ke=Ae.tileID.canonical;if(!this._geoJSONIndex)return xe(null,null);var tt=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!tt)return xe(null,null);var Et=new xt(tt.features),tn=Be(Et);tn.byteOffset===0&&tn.byteLength===tn.buffer.byteLength||(tn=new Uint8Array(tn)),xe(null,{vectorTile:Et,rawData:tn.buffer})}Fn.prototype.load=function(Ae){var xe=this.options,ke=xe.log,tt=xe.minZoom,Et=xe.maxZoom,tn=xe.nodeSize;ke&&console.time("total time");var fn="prepare "+Ae.length+" points";ke&&console.time(fn),this.points=Ae;for(var _t=[],en=0;en<Ae.length;en++)Ae[en].geometry&&_t.push(nr(Ae[en],en));this.trees[Et+1]=new Xt(_t,Ut,Dt,tn,Float32Array),ke&&console.timeEnd(fn);for(var Gn=Et;Gn>=tt;Gn--){var Tr=+Date.now();_t=this._cluster(_t,Gn),this.trees[Gn]=new Xt(_t,Ut,Dt,tn,Float32Array),ke&&console.log("z%d: %d clusters in %dms",Gn,_t.length,+Date.now()-Tr)}return ke&&console.timeEnd("total time"),this},Fn.prototype.getClusters=function(Ae,xe){var ke=((Ae[0]+180)%360+360)%360-180,tt=Math.max(-90,Math.min(90,Ae[1])),Et=Ae[2]===180?180:((Ae[2]+180)%360+360)%360-180,tn=Math.max(-90,Math.min(90,Ae[3]));if(Ae[2]-Ae[0]>=360)ke=-180,Et=180;else if(ke>Et){var fn=this.getClusters([ke,tt,180,tn],xe),_t=this.getClusters([-180,tt,Et,tn],xe);return fn.concat(_t)}for(var en=this.trees[this._limitZoom(xe)],Gn=[],Tr=0,jr=en.range(_n(ke),tr(tn),_n(Et),tr(tt));Tr<jr.length;Tr+=1){var vr=en.points[jr[Tr]];Gn.push(vr.numPoints?Ht(vr):this.points[vr.index])}return Gn},Fn.prototype.getChildren=function(Ae){var xe=this._getOriginId(Ae),ke=this._getOriginZoom(Ae),tt="No cluster with the specified id.",Et=this.trees[ke];if(!Et)throw new Error(tt);var tn=Et.points[xe];if(!tn)throw new Error(tt);for(var fn=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),_t=[],en=0,Gn=Et.within(tn.x,tn.y,fn);en<Gn.length;en+=1){var Tr=Et.points[Gn[en]];Tr.parentId===Ae&&_t.push(Tr.numPoints?Ht(Tr):this.points[Tr.index])}if(_t.length===0)throw new Error(tt);return _t},Fn.prototype.getLeaves=function(Ae,xe,ke){var tt=[];return this._appendLeaves(tt,Ae,xe=xe||10,ke=ke||0,0),tt},Fn.prototype.getTile=function(Ae,xe,ke){var tt=this.trees[this._limitZoom(Ae)],Et=Math.pow(2,Ae),tn=this.options,fn=tn.radius/tn.extent,_t=(ke-fn)/Et,en=(ke+1+fn)/Et,Gn={features:[]};return this._addTileFeatures(tt.range((xe-fn)/Et,_t,(xe+1+fn)/Et,en),tt.points,xe,ke,Et,Gn),xe===0&&this._addTileFeatures(tt.range(1-fn/Et,_t,1,en),tt.points,Et,ke,Et,Gn),xe===Et-1&&this._addTileFeatures(tt.range(0,_t,fn/Et,en),tt.points,-1,ke,Et,Gn),Gn.features.length?Gn:null},Fn.prototype.getClusterExpansionZoom=function(Ae){for(var xe=this._getOriginZoom(Ae)-1;xe<=this.options.maxZoom;){var ke=this.getChildren(Ae);if(xe++,ke.length!==1)break;Ae=ke[0].properties.cluster_id}return xe},Fn.prototype._appendLeaves=function(Ae,xe,ke,tt,Et){for(var tn=0,fn=this.getChildren(xe);tn<fn.length;tn+=1){var _t=fn[tn],en=_t.properties;if(en&&en.cluster?Et+en.point_count<=tt?Et+=en.point_count:Et=this._appendLeaves(Ae,en.cluster_id,ke,tt,Et):Et<tt?Et++:Ae.push(_t),Ae.length===ke)break}return Et},Fn.prototype._addTileFeatures=function(Ae,xe,ke,tt,Et,tn){for(var fn=0,_t=Ae;fn<_t.length;fn+=1){var en=xe[_t[fn]],Gn=en.numPoints,Tr={type:1,geometry:[[Math.round(this.options.extent*(en.x*Et-ke)),Math.round(this.options.extent*(en.y*Et-tt))]],tags:Gn?Jt(en):this.points[en.index].properties},jr=void 0;Gn?jr=en.id:this.options.generateId?jr=en.index:this.points[en.index].id&&(jr=this.points[en.index].id),jr!==void 0&&(Tr.id=jr),tn.features.push(Tr)}},Fn.prototype._limitZoom=function(Ae){return Math.max(this.options.minZoom,Math.min(+Ae,this.options.maxZoom+1))},Fn.prototype._cluster=function(Ae,xe){for(var ke=[],tt=this.options,Et=tt.reduce,tn=tt.minPoints,fn=tt.radius/(tt.extent*Math.pow(2,xe)),_t=0;_t<Ae.length;_t++){var en=Ae[_t];if(!(en.zoom<=xe)){en.zoom=xe;for(var Gn=this.trees[xe+1],Tr=Gn.within(en.x,en.y,fn),jr=en.numPoints||1,vr=jr,Ur=0,Fr=Tr;Ur<Fr.length;Ur+=1){var qr=Gn.points[Fr[Ur]];qr.zoom>xe&&(vr+=qr.numPoints||1)}if(vr>=tn){for(var wr=en.x*jr,fi=en.y*jr,di=Et&&jr>1?this._map(en,!0):null,vi=(_t<<5)+(xe+1)+this.points.length,vo=0,Oi=Tr;vo<Oi.length;vo+=1){var Ko=Gn.points[Oi[vo]];if(!(Ko.zoom<=xe)){Ko.zoom=xe;var va=Ko.numPoints||1;wr+=Ko.x*va,fi+=Ko.y*va,Ko.parentId=vi,Et&&(di||(di=this._map(en,!0)),Et(di,this._map(Ko)))}}en.parentId=vi,ke.push($n(wr/vr,fi/vr,vi,vr,di))}else if(ke.push(en),vr>1)for(var Co=0,Xo=Tr;Co<Xo.length;Co+=1){var Ye=Gn.points[Xo[Co]];Ye.zoom<=xe||(Ye.zoom=xe,ke.push(Ye))}}}return ke},Fn.prototype._getOriginId=function(Ae){return Ae-this.points.length>>5},Fn.prototype._getOriginZoom=function(Ae){return(Ae-this.points.length)%32},Fn.prototype._map=function(Ae,xe){if(Ae.numPoints)return xe?an({},Ae.properties):Ae.properties;var ke=this.points[Ae.index].properties,tt=this.options.map(ke);return xe&&tt===ke?an({},tt):tt},It.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},It.prototype.splitTile=function(Ae,xe,ke,tt,Et,tn,fn){for(var _t=[Ae,xe,ke,tt],en=this.options,Gn=en.debug;_t.length;){tt=_t.pop(),ke=_t.pop(),xe=_t.pop(),Ae=_t.pop();var Tr=1<<xe,jr=xn(xe,ke,tt),vr=this.tiles[jr];if(!vr&&(Gn>1&&console.time("creation"),vr=this.tiles[jr]=Ne(Ae,xe,ke,tt,en),this.tileCoords.push({z:xe,x:ke,y:tt}),Gn)){Gn>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",xe,ke,tt,vr.numFeatures,vr.numPoints,vr.numSimplified),console.timeEnd("creation"));var Ur="z"+xe;this.stats[Ur]=(this.stats[Ur]||0)+1,this.total++}if(vr.source=Ae,Et){if(xe===en.maxZoom||xe===Et)continue;var Fr=1<<Et-xe;if(ke!==Math.floor(tn/Fr)||tt!==Math.floor(fn/Fr))continue}else if(xe===en.indexMaxZoom||vr.numPoints<=en.indexMaxPoints)continue;if(vr.source=null,Ae.length!==0){Gn>1&&console.time("clipping");var qr,wr,fi,di,vi,vo,Oi=.5*en.buffer/en.extent,Ko=.5-Oi,va=.5+Oi,Co=1+Oi;qr=wr=fi=di=null,vi=St(Ae,Tr,ke-Oi,ke+va,0,vr.minX,vr.maxX,en),vo=St(Ae,Tr,ke+Ko,ke+Co,0,vr.minX,vr.maxX,en),Ae=null,vi&&(qr=St(vi,Tr,tt-Oi,tt+va,1,vr.minY,vr.maxY,en),wr=St(vi,Tr,tt+Ko,tt+Co,1,vr.minY,vr.maxY,en),vi=null),vo&&(fi=St(vo,Tr,tt-Oi,tt+va,1,vr.minY,vr.maxY,en),di=St(vo,Tr,tt+Ko,tt+Co,1,vr.minY,vr.maxY,en),vo=null),Gn>1&&console.timeEnd("clipping"),_t.push(qr||[],xe+1,2*ke,2*tt),_t.push(wr||[],xe+1,2*ke,2*tt+1),_t.push(fi||[],xe+1,2*ke+1,2*tt),_t.push(di||[],xe+1,2*ke+1,2*tt+1)}}},It.prototype.getTile=function(Ae,xe,ke){var tt=this.options,Et=tt.extent,tn=tt.debug;if(Ae<0||Ae>24)return null;var fn=1<<Ae,_t=xn(Ae,xe=(xe%fn+fn)%fn,ke);if(this.tiles[_t])return dt(this.tiles[_t],Et);tn>1&&console.log("drilling down to z%d-%d-%d",Ae,xe,ke);for(var en,Gn=Ae,Tr=xe,jr=ke;!en&&Gn>0;)Gn--,Tr=Math.floor(Tr/2),jr=Math.floor(jr/2),en=this.tiles[xn(Gn,Tr,jr)];return en&&en.source?(tn>1&&console.log("found parent tile z%d-%d-%d",Gn,Tr,jr),tn>1&&console.time("drilling down"),this.splitTile(en.source,Gn,Tr,jr,Ae,xe,ke),tn>1&&console.timeEnd("drilling down"),this.tiles[_t]?dt(this.tiles[_t],Et):null):null};var br=function(Ae){function xe(ke,tt,Et,tn){Ae.call(this,ke,tt,Et,Qn),tn&&(this.loadGeoJSON=tn)}return Ae&&(xe.__proto__=Ae),(xe.prototype=Object.create(Ae&&Ae.prototype)).constructor=xe,xe.prototype.loadData=function(ke,tt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=tt,this._pendingLoadDataParams=ke,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},xe.prototype._loadData=function(){var ke=this;if(this._pendingCallback&&this._pendingLoadDataParams){var tt=this._pendingCallback,Et=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var tn=!!(Et&&Et.request&&Et.request.collectResourceTiming)&&new E.RequestPerformance(Et.request);this.loadGeoJSON(Et,function(fn,_t){if(fn||!_t)return tt(fn);if(typeof _t!="object")return tt(new Error("Input data given to '"+Et.source+"' is not a valid GeoJSON object."));(function vr(Ur,Fr){var qr,wr=Ur&&Ur.type;if(wr==="FeatureCollection")for(qr=0;qr<Ur.features.length;qr++)vr(Ur.features[qr],Fr);else if(wr==="GeometryCollection")for(qr=0;qr<Ur.geometries.length;qr++)vr(Ur.geometries[qr],Fr);else if(wr==="Feature")vr(Ur.geometry,Fr);else if(wr==="Polygon")Se(Ur.coordinates,Fr);else if(wr==="MultiPolygon")for(qr=0;qr<Ur.coordinates.length;qr++)Se(Ur.coordinates[qr],Fr);return Ur})(_t,!0);try{if(Et.filter){var en=E.createExpression(Et.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(en.result==="error")throw new Error(en.value.map(function(vr){return vr.key+": "+vr.message}).join(", "));var Gn=_t.features.filter(function(vr){return en.value.evaluate({zoom:0},vr)});_t={type:"FeatureCollection",features:Gn}}ke._geoJSONIndex=Et.cluster?new Fn(function(vr){var Ur=vr.superclusterOptions,Fr=vr.clusterProperties;if(!Fr||!Ur)return Ur;for(var qr={},wr={},fi={accumulated:null,zoom:0},di={properties:null},vi=Object.keys(Fr),vo=0,Oi=vi;vo<Oi.length;vo+=1){var Ko=Oi[vo],va=Fr[Ko],Co=va[0],Xo=E.createExpression(va[1]),Ye=E.createExpression(typeof Co=="string"?[Co,["accumulated"],["get",Ko]]:Co);qr[Ko]=Xo.value,wr[Ko]=Ye.value}return Ur.map=function(Ke){di.properties=Ke;for(var Ct={},sn=0,Ln=vi;sn<Ln.length;sn+=1){var zn=Ln[sn];Ct[zn]=qr[zn].evaluate(fi,di)}return Ct},Ur.reduce=function(Ke,Ct){di.properties=Ct;for(var sn=0,Ln=vi;sn<Ln.length;sn+=1){var zn=Ln[sn];fi.accumulated=Ke[zn],Ke[zn]=wr[zn].evaluate(fi,di)}},Ur}(Et)).load(_t.features):function(vr,Ur){return new It(vr,Ur)}(_t,Et.geojsonVtOptions)}catch(vr){return tt(vr)}ke.loaded={};var Tr={};if(tn){var jr=tn.finish();jr&&(Tr.resourceTiming={},Tr.resourceTiming[Et.source]=JSON.parse(JSON.stringify(jr)))}tt(null,Tr)})}},xe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},xe.prototype.reloadTile=function(ke,tt){var Et=this.loaded;return Et&&Et[ke.uid]?Ae.prototype.reloadTile.call(this,ke,tt):this.loadTile(ke,tt)},xe.prototype.loadGeoJSON=function(ke,tt){if(ke.request)E.getJSON(ke.request,tt);else{if(typeof ke.data!="string")return tt(new Error("Input data given to '"+ke.source+"' is not a valid GeoJSON object."));try{return tt(null,JSON.parse(ke.data))}catch(Et){return tt(new Error("Input data given to '"+ke.source+"' is not a valid GeoJSON object."))}}},xe.prototype.removeSource=function(ke,tt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),tt()},xe.prototype.getClusterExpansionZoom=function(ke,tt){try{tt(null,this._geoJSONIndex.getClusterExpansionZoom(ke.clusterId))}catch(Et){tt(Et)}},xe.prototype.getClusterChildren=function(ke,tt){try{tt(null,this._geoJSONIndex.getChildren(ke.clusterId))}catch(Et){tt(Et)}},xe.prototype.getClusterLeaves=function(ke,tt){try{tt(null,this._geoJSONIndex.getLeaves(ke.clusterId,ke.limit,ke.offset))}catch(Et){tt(Et)}},xe}(te),Jn=function(Ae){var xe=this;this.self=Ae,this.actor=new E.Actor(Ae,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:te,geojson:br},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ke,tt){if(xe.workerSourceTypes[ke])throw new Error('Worker source with name "'+ke+'" already registered.');xe.workerSourceTypes[ke]=tt},this.self.registerRTLTextPlugin=function(ke){if(E.plugin.isParsed())throw new Error("RTL text plugin already registered.");E.plugin.applyArabicShaping=ke.applyArabicShaping,E.plugin.processBidirectionalText=ke.processBidirectionalText,E.plugin.processStyledBidirectionalText=ke.processStyledBidirectionalText}};return Jn.prototype.setReferrer=function(Ae,xe){this.referrer=xe},Jn.prototype.setImages=function(Ae,xe,ke){for(var tt in this.availableImages[Ae]=xe,this.workerSources[Ae]){var Et=this.workerSources[Ae][tt];for(var tn in Et)Et[tn].availableImages=xe}ke()},Jn.prototype.setLayers=function(Ae,xe,ke){this.getLayerIndex(Ae).replace(xe),ke()},Jn.prototype.updateLayers=function(Ae,xe,ke){this.getLayerIndex(Ae).update(xe.layers,xe.removedIds),ke()},Jn.prototype.loadTile=function(Ae,xe,ke){this.getWorkerSource(Ae,xe.type,xe.source).loadTile(xe,ke)},Jn.prototype.loadDEMTile=function(Ae,xe,ke){this.getDEMWorkerSource(Ae,xe.source).loadTile(xe,ke)},Jn.prototype.reloadTile=function(Ae,xe,ke){this.getWorkerSource(Ae,xe.type,xe.source).reloadTile(xe,ke)},Jn.prototype.abortTile=function(Ae,xe,ke){this.getWorkerSource(Ae,xe.type,xe.source).abortTile(xe,ke)},Jn.prototype.removeTile=function(Ae,xe,ke){this.getWorkerSource(Ae,xe.type,xe.source).removeTile(xe,ke)},Jn.prototype.removeDEMTile=function(Ae,xe){this.getDEMWorkerSource(Ae,xe.source).removeTile(xe)},Jn.prototype.removeSource=function(Ae,xe,ke){if(this.workerSources[Ae]&&this.workerSources[Ae][xe.type]&&this.workerSources[Ae][xe.type][xe.source]){var tt=this.workerSources[Ae][xe.type][xe.source];delete this.workerSources[Ae][xe.type][xe.source],tt.removeSource!==void 0?tt.removeSource(xe,ke):ke()}},Jn.prototype.loadWorkerSource=function(Ae,xe,ke){try{this.self.importScripts(xe.url),ke()}catch(tt){ke(tt.toString())}},Jn.prototype.syncRTLPluginState=function(Ae,xe,ke){try{E.plugin.setState(xe);var tt=E.plugin.getPluginURL();if(E.plugin.isLoaded()&&!E.plugin.isParsed()&&tt!=null){this.self.importScripts(tt);var Et=E.plugin.isParsed();ke(Et?void 0:new Error("RTL Text Plugin failed to import scripts from "+tt),Et)}}catch(tn){ke(tn.toString())}},Jn.prototype.getAvailableImages=function(Ae){var xe=this.availableImages[Ae];return xe||(xe=[]),xe},Jn.prototype.getLayerIndex=function(Ae){var xe=this.layerIndexes[Ae];return xe||(xe=this.layerIndexes[Ae]=new fe),xe},Jn.prototype.getWorkerSource=function(Ae,xe,ke){var tt=this;return this.workerSources[Ae]||(this.workerSources[Ae]={}),this.workerSources[Ae][xe]||(this.workerSources[Ae][xe]={}),this.workerSources[Ae][xe][ke]||(this.workerSources[Ae][xe][ke]=new this.workerSourceTypes[xe]({send:function(Et,tn,fn){tt.actor.send(Et,tn,fn,Ae)}},this.getLayerIndex(Ae),this.getAvailableImages(Ae))),this.workerSources[Ae][xe][ke]},Jn.prototype.getDEMWorkerSource=function(Ae,xe){return this.demWorkerSources[Ae]||(this.demWorkerSources[Ae]={}),this.demWorkerSources[Ae][xe]||(this.demWorkerSources[Ae][xe]=new De),this.demWorkerSources[Ae][xe]},Jn.prototype.enforceCacheSizeLimit=function(Ae,xe){E.enforceCacheSizeLimit(xe)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Jn(self)),Jn}),X(["./shared"],function(E){"use strict";var ve=E.createCommonjsModule(function(_){function S(k){return!x(k)}function x(k){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var q,he,je=new Blob([""],{type:"text/javascript"}),Xe=URL.createObjectURL(je);try{he=new Worker(Xe),q=!0}catch(kt){q=!1}return he&&he.terminate(),URL.revokeObjectURL(Xe),q}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var q=document.createElement("canvas");q.width=q.height=1;var he=q.getContext("2d");if(!he)return!1;var je=he.getImageData(0,0,1,1);return je&&je.width===q.width}()?(C[G=k&&k.failIfMajorPerformanceCaveat]===void 0&&(C[G]=function(q){var he=function(Xe){var kt=document.createElement("canvas"),jt=Object.create(S.webGLContextAttributes);return jt.failIfMajorPerformanceCaveat=Xe,kt.probablySupportsContext?kt.probablySupportsContext("webgl",jt)||kt.probablySupportsContext("experimental-webgl",jt):kt.supportsContext?kt.supportsContext("webgl",jt)||kt.supportsContext("experimental-webgl",jt):kt.getContext("webgl",jt)||kt.getContext("experimental-webgl",jt)}(q);if(!he)return!1;var je=he.createShader(he.VERTEX_SHADER);return!(!je||he.isContextLost())&&(he.shaderSource(je,"void main() {}"),he.compileShader(je),he.getShaderParameter(je,he.COMPILE_STATUS)===!0)}(G)),C[G]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var G}_.exports?_.exports=S:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=S,window.mapboxgl.notSupportedReason=x);var C={};S.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),re={create:function(_,S,x){var C=E.window.document.createElement(_);return S!==void 0&&(C.className=S),x&&x.appendChild(C),C},createNS:function(_,S){return E.window.document.createElementNS(_,S)}},fe=E.window.document&&E.window.document.documentElement.style;function ae(_){if(!fe)return _[0];for(var S=0;S<_.length;S++)if(_[S]in fe)return _[S];return _[0]}var Ee,oe=ae(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);re.disableDrag=function(){fe&&oe&&(Ee=fe[oe],fe[oe]="none")},re.enableDrag=function(){fe&&oe&&(fe[oe]=Ee)};var ze=ae(["transform","WebkitTransform"]);re.setTransform=function(_,S){_.style[ze]=S};var te=!1;try{var ye=Object.defineProperty({},"passive",{get:function(){te=!0}});E.window.addEventListener("test",ye,ye),E.window.removeEventListener("test",ye,ye)}catch(_){te=!1}re.addEventListener=function(_,S,x,C){C===void 0&&(C={}),_.addEventListener(S,x,"passive"in C&&te?C:C.capture)},re.removeEventListener=function(_,S,x,C){C===void 0&&(C={}),_.removeEventListener(S,x,"passive"in C&&te?C:C.capture)};var De=function(_){_.preventDefault(),_.stopPropagation(),E.window.removeEventListener("click",De,!0)};function Se(_){var S=_.userImage;return!!(S&&S.render&&S.render())&&(_.data.replace(new Uint8Array(S.data.buffer)),!0)}re.suppressClick=function(){E.window.addEventListener("click",De,!0),E.window.setTimeout(function(){E.window.removeEventListener("click",De,!0)},0)},re.mousePos=function(_,S){var x=_.getBoundingClientRect();return new E.Point(S.clientX-x.left-_.clientLeft,S.clientY-x.top-_.clientTop)},re.touchPos=function(_,S){for(var x=_.getBoundingClientRect(),C=[],k=0;k<S.length;k++)C.push(new E.Point(S[k].clientX-x.left-_.clientLeft,S[k].clientY-x.top-_.clientTop));return C},re.mouseButton=function(_){return E.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&E.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button},re.remove=function(_){_.parentNode&&_.parentNode.removeChild(_)};var we=function(_){function S(){_.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new E.RGBAImage({width:1,height:1}),this.dirty=!0}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.isLoaded=function(){return this.loaded},S.prototype.setLoaded=function(x){if(this.loaded!==x&&(this.loaded=x,x)){for(var C=0,k=this.requestors;C<k.length;C+=1){var G=k[C];this._notify(G.ids,G.callback)}this.requestors=[]}},S.prototype.getImage=function(x){return this.images[x]},S.prototype.addImage=function(x,C){this._validate(x,C)&&(this.images[x]=C)},S.prototype._validate=function(x,C){var k=!0;return this._validateStretch(C.stretchX,C.data&&C.data.width)||(this.fire(new E.ErrorEvent(new Error('Image "'+x+'" has invalid "stretchX" value'))),k=!1),this._validateStretch(C.stretchY,C.data&&C.data.height)||(this.fire(new E.ErrorEvent(new Error('Image "'+x+'" has invalid "stretchY" value'))),k=!1),this._validateContent(C.content,C)||(this.fire(new E.ErrorEvent(new Error('Image "'+x+'" has invalid "content" value'))),k=!1),k},S.prototype._validateStretch=function(x,C){if(!x)return!0;for(var k=0,G=0,q=x;G<q.length;G+=1){var he=q[G];if(he[0]<k||he[1]<he[0]||C<he[1])return!1;k=he[1]}return!0},S.prototype._validateContent=function(x,C){return!(x&&(x.length!==4||x[0]<0||C.data.width<x[0]||x[1]<0||C.data.height<x[1]||x[2]<0||C.data.width<x[2]||x[3]<0||C.data.height<x[3]||x[2]<x[0]||x[3]<x[1]))},S.prototype.updateImage=function(x,C){C.version=this.images[x].version+1,this.images[x]=C,this.updatedImages[x]=!0},S.prototype.removeImage=function(x){var C=this.images[x];delete this.images[x],delete this.patterns[x],C.userImage&&C.userImage.onRemove&&C.userImage.onRemove()},S.prototype.listImages=function(){return Object.keys(this.images)},S.prototype.getImages=function(x,C){var k=!0;if(!this.isLoaded())for(var G=0,q=x;G<q.length;G+=1)this.images[q[G]]||(k=!1);this.isLoaded()||k?this._notify(x,C):this.requestors.push({ids:x,callback:C})},S.prototype._notify=function(x,C){for(var k={},G=0,q=x;G<q.length;G+=1){var he=q[G];this.images[he]||this.fire(new E.Event("styleimagemissing",{id:he}));var je=this.images[he];je?k[he]={data:je.data.clone(),pixelRatio:je.pixelRatio,sdf:je.sdf,version:je.version,stretchX:je.stretchX,stretchY:je.stretchY,content:je.content,hasRenderCallback:!!(je.userImage&&je.userImage.render)}:E.warnOnce('Image "'+he+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}C(null,k)},S.prototype.getPixelSize=function(){var x=this.atlasImage;return{width:x.width,height:x.height}},S.prototype.getPattern=function(x){var C=this.patterns[x],k=this.getImage(x);if(!k)return null;if(C&&C.position.version===k.version)return C.position;if(C)C.position.version=k.version;else{var G={w:k.data.width+2,h:k.data.height+2,x:0,y:0},q=new E.ImagePosition(G,k);this.patterns[x]={bin:G,position:q}}return this._updatePatternAtlas(),this.patterns[x].position},S.prototype.bind=function(x){var C=x.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new E.Texture(x,this.atlasImage,C.RGBA),this.atlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE)},S.prototype._updatePatternAtlas=function(){var x=[];for(var C in this.patterns)x.push(this.patterns[C].bin);var k=E.potpack(x),G=k.w,q=k.h,he=this.atlasImage;for(var je in he.resize({width:G||1,height:q||1}),this.patterns){var Xe=this.patterns[je].bin,kt=Xe.x+1,jt=Xe.y+1,Yt=this.images[je].data,gn=Yt.width,pn=Yt.height;E.RGBAImage.copy(Yt,he,{x:0,y:0},{x:kt,y:jt},{width:gn,height:pn}),E.RGBAImage.copy(Yt,he,{x:0,y:pn-1},{x:kt,y:jt-1},{width:gn,height:1}),E.RGBAImage.copy(Yt,he,{x:0,y:0},{x:kt,y:jt+pn},{width:gn,height:1}),E.RGBAImage.copy(Yt,he,{x:gn-1,y:0},{x:kt-1,y:jt},{width:1,height:pn}),E.RGBAImage.copy(Yt,he,{x:0,y:0},{x:kt+gn,y:jt},{width:1,height:pn})}this.dirty=!0},S.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},S.prototype.dispatchRenderCallbacks=function(x){for(var C=0,k=x;C<k.length;C+=1){var G=k[C];if(!this.callbackDispatchedThisFrame[G]){this.callbackDispatchedThisFrame[G]=!0;var q=this.images[G];Se(q)&&this.updateImage(G,q)}}},S}(E.Evented),ce=ht,Ze=ht,xt=1e20;function ht(_,S,x,C,k,G){this.fontSize=_||24,this.buffer=S===void 0?3:S,this.cutoff=C||.25,this.fontFamily=k||"sans-serif",this.fontWeight=G||"normal",this.radius=x||8;var q=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(q*q),this.gridInner=new Float64Array(q*q),this.f=new Float64Array(q),this.d=new Float64Array(q),this.z=new Float64Array(q+1),this.v=new Int16Array(q),this.middle=Math.round(q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Gt(_,S,x,C,k,G,q){for(var he=0;he<S;he++){for(var je=0;je<x;je++)C[je]=_[je*S+he];for(mt(C,k,G,q,x),je=0;je<x;je++)_[je*S+he]=k[je]}for(je=0;je<x;je++){for(he=0;he<S;he++)C[he]=_[je*S+he];for(mt(C,k,G,q,S),he=0;he<S;he++)_[je*S+he]=Math.sqrt(k[he])}}function mt(_,S,x,C,k){x[0]=0,C[0]=-xt,C[1]=+xt;for(var G=1,q=0;G<k;G++){for(var he=(_[G]+G*G-(_[x[q]]+x[q]*x[q]))/(2*G-2*x[q]);he<=C[q];)q--,he=(_[G]+G*G-(_[x[q]]+x[q]*x[q]))/(2*G-2*x[q]);x[++q]=G,C[q]=he,C[q+1]=+xt}for(G=0,q=0;G<k;G++){for(;C[q+1]<G;)q++;S[G]=(G-x[q])*(G-x[q])+_[x[q]]}}ht.prototype.draw=function(_){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(_,this.buffer,this.middle);for(var S=this.ctx.getImageData(0,0,this.size,this.size),x=new Uint8ClampedArray(this.size*this.size),C=0;C<this.size*this.size;C++){var k=S.data[4*C+3]/255;this.gridOuter[C]=k===1?0:k===0?xt:Math.pow(Math.max(0,.5-k),2),this.gridInner[C]=k===1?xt:k===0?0:Math.pow(Math.max(0,k-.5),2)}for(Gt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Gt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),C=0;C<this.size*this.size;C++)x[C]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[C]-this.gridInner[C])/this.radius+this.cutoff))));return x},ce.default=Ze;var gt=function(_,S){this.requestManager=_,this.localIdeographFontFamily=S,this.entries={}};gt.prototype.setURL=function(_){this.url=_},gt.prototype.getGlyphs=function(_,S){var x=this,C=[];for(var k in _)for(var G=0,q=_[k];G<q.length;G+=1)C.push({stack:k,id:q[G]});E.asyncAll(C,function(he,je){var Xe=he.stack,kt=he.id,jt=x.entries[Xe];jt||(jt=x.entries[Xe]={glyphs:{},requests:{},ranges:{}});var Yt=jt.glyphs[kt];if(Yt===void 0){if(Yt=x._tinySDF(jt,Xe,kt))return jt.glyphs[kt]=Yt,void je(null,{stack:Xe,id:kt,glyph:Yt});var gn=Math.floor(kt/256);if(256*gn>65535)je(new Error("glyphs > 65535 not supported"));else if(jt.ranges[gn])je(null,{stack:Xe,id:kt,glyph:Yt});else{var pn=jt.requests[gn];pn||(pn=jt.requests[gn]=[],gt.loadGlyphRange(Xe,gn,x.url,x.requestManager,function(Cn,un){if(un){for(var kn in un)x._doesCharSupportLocalGlyph(+kn)||(jt.glyphs[+kn]=un[+kn]);jt.ranges[gn]=!0}for(var er=0,ur=pn;er<ur.length;er+=1)(0,ur[er])(Cn,un);delete jt.requests[gn]})),pn.push(function(Cn,un){Cn?je(Cn):un&&je(null,{stack:Xe,id:kt,glyph:un[kt]||null})})}}else je(null,{stack:Xe,id:kt,glyph:Yt})},function(he,je){if(he)S(he);else if(je){for(var Xe={},kt=0,jt=je;kt<jt.length;kt+=1){var Yt=jt[kt],gn=Yt.stack,pn=Yt.id,Cn=Yt.glyph;(Xe[gn]||(Xe[gn]={}))[pn]=Cn&&{id:Cn.id,bitmap:Cn.bitmap.clone(),metrics:Cn.metrics}}S(null,Xe)}})},gt.prototype._doesCharSupportLocalGlyph=function(_){return!!this.localIdeographFontFamily&&(E.isChar["CJK Unified Ideographs"](_)||E.isChar["Hangul Syllables"](_)||E.isChar.Hiragana(_)||E.isChar.Katakana(_))},gt.prototype._tinySDF=function(_,S,x){var C=this.localIdeographFontFamily;if(C&&this._doesCharSupportLocalGlyph(x)){var k=_.tinySDF;if(!k){var G="400";/bold/i.test(S)?G="900":/medium/i.test(S)?G="500":/light/i.test(S)&&(G="200"),k=_.tinySDF=new gt.TinySDF(24,3,8,.25,C,G)}return{id:x,bitmap:new E.AlphaImage({width:30,height:30},k.draw(String.fromCharCode(x))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},gt.loadGlyphRange=function(_,S,x,C,k){var G=256*S,q=G+255,he=C.transformRequest(C.normalizeGlyphsURL(x).replace("{fontstack}",_).replace("{range}",G+"-"+q),E.ResourceType.Glyphs);E.getArrayBuffer(he,function(je,Xe){if(je)k(je);else if(Xe){for(var kt={},jt=0,Yt=E.parseGlyphPBF(Xe);jt<Yt.length;jt+=1){var gn=Yt[jt];kt[gn.id]=gn}k(null,kt)}})},gt.TinySDF=ce;var Be=function(){this.specification=E.styleSpec.light.position};Be.prototype.possiblyEvaluate=function(_,S){return E.sphericalToCartesian(_.expression.evaluate(S))},Be.prototype.interpolate=function(_,S,x){return{x:E.number(_.x,S.x,x),y:E.number(_.y,S.y,x),z:E.number(_.z,S.z,x)}};var Re=new E.Properties({anchor:new E.DataConstantProperty(E.styleSpec.light.anchor),position:new Be,color:new E.DataConstantProperty(E.styleSpec.light.color),intensity:new E.DataConstantProperty(E.styleSpec.light.intensity)}),bt=function(_){function S(x){_.call(this),this._transitionable=new E.Transitionable(Re),this.setLight(x),this._transitioning=this._transitionable.untransitioned()}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getLight=function(){return this._transitionable.serialize()},S.prototype.setLight=function(x,C){if(C===void 0&&(C={}),!this._validate(E.validateLight,x,C))for(var k in x){var G=x[k];E.endsWith(k,"-transition")?this._transitionable.setTransition(k.slice(0,-11),G):this._transitionable.setValue(k,G)}},S.prototype.updateTransitions=function(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)},S.prototype.hasTransition=function(){return this._transitioning.hasTransition()},S.prototype.recalculate=function(x){this.properties=this._transitioning.possiblyEvaluate(x)},S.prototype._validate=function(x,C,k){return(!k||k.validate!==!1)&&E.emitValidationErrors(this,x.call(E.validateStyle,E.extend({value:C,style:{glyphs:!0,sprite:!0},styleSpec:E.styleSpec})))},S}(E.Evented),yt=function(_,S){this.width=_,this.height=S,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};yt.prototype.getDash=function(_,S){var x=_.join(",")+String(S);return this.dashEntry[x]||(this.dashEntry[x]=this.addDash(_,S)),this.dashEntry[x]},yt.prototype.getDashRanges=function(_,S,x){var C=[],k=_.length%2==1?-_[_.length-1]*x:0,G=_[0]*x,q=!0;C.push({left:k,right:G,isDash:q,zeroLength:_[0]===0});for(var he=_[0],je=1;je<_.length;je++){var Xe=_[je];C.push({left:k=he*x,right:G=(he+=Xe)*x,isDash:q=!q,zeroLength:Xe===0})}return C},yt.prototype.addRoundDash=function(_,S,x){for(var C=S/2,k=-x;k<=x;k++)for(var G=this.width*(this.nextRow+x+k),q=0,he=_[q],je=0;je<this.width;je++){je/he.right>1&&(he=_[++q]);var Xe=Math.abs(je-he.left),kt=Math.abs(je-he.right),jt=Math.min(Xe,kt),Yt=void 0,gn=k/x*(C+1);if(he.isDash){var pn=C-Math.abs(gn);Yt=Math.sqrt(jt*jt+pn*pn)}else Yt=C-Math.sqrt(jt*jt+gn*gn);this.data[G+je]=Math.max(0,Math.min(255,Yt+128))}},yt.prototype.addRegularDash=function(_){for(var S=_.length-1;S>=0;--S){var x=_[S],C=_[S+1];x.zeroLength?_.splice(S,1):C&&C.isDash===x.isDash&&(C.left=x.left,_.splice(S,1))}var k=_[0],G=_[_.length-1];k.isDash===G.isDash&&(k.left=G.left-this.width,G.right=k.right+this.width);for(var q=this.width*this.nextRow,he=0,je=_[he],Xe=0;Xe<this.width;Xe++){Xe/je.right>1&&(je=_[++he]);var kt=Math.abs(Xe-je.left),jt=Math.abs(Xe-je.right),Yt=Math.min(kt,jt);this.data[q+Xe]=Math.max(0,Math.min(255,(je.isDash?Yt:-Yt)+128))}},yt.prototype.addDash=function(_,S){var x=S?7:0,C=2*x+1;if(this.nextRow+C>this.height)return E.warnOnce("LineAtlas out of space"),null;for(var k=0,G=0;G<_.length;G++)k+=_[G];if(k!==0){var q=this.width/k,he=this.getDashRanges(_,this.width,q);S?this.addRoundDash(he,q,x):this.addRegularDash(he)}var je={y:(this.nextRow+x+.5)/this.height,height:2*x/this.height,width:k};return this.nextRow+=C,this.dirty=!0,je},yt.prototype.bind=function(_){var S=_.gl;this.texture?(S.bindTexture(S.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,S.texSubImage2D(S.TEXTURE_2D,0,0,0,this.width,this.height,S.ALPHA,S.UNSIGNED_BYTE,this.data))):(this.texture=S.createTexture(),S.bindTexture(S.TEXTURE_2D,this.texture),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.REPEAT),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.REPEAT),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR),S.texImage2D(S.TEXTURE_2D,0,S.ALPHA,this.width,this.height,0,S.ALPHA,S.UNSIGNED_BYTE,this.data))};var At=function _(S,x){this.workerPool=S,this.actors=[],this.currentActor=0,this.id=E.uniqueId();for(var C=this.workerPool.acquire(this.id),k=0;k<C.length;k++){var G=new _.Actor(C[k],x,this.id);G.name="Worker "+k,this.actors.push(G)}};function bn(_,S,x){var C=function(k,G){if(k)return x(k);if(G){var q=E.pick(E.extend(G,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);G.vector_layers&&(q.vectorLayers=G.vector_layers,q.vectorLayerIds=q.vectorLayers.map(function(he){return he.id})),q.tiles=S.canonicalizeTileset(q,_.url),x(null,q)}};return _.url?E.getJSON(S.transformRequest(S.normalizeSourceURL(_.url),E.ResourceType.Source),C):E.browser.frame(function(){return C(null,_)})}At.prototype.broadcast=function(_,S,x){E.asyncAll(this.actors,function(C,k){C.send(_,S,k)},x=x||function(){})},At.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},At.prototype.remove=function(){this.actors.forEach(function(_){_.remove()}),this.actors=[],this.workerPool.release(this.id)},At.Actor=E.Actor;var He=function(_,S,x){this.bounds=E.LngLatBounds.convert(this.validateBounds(_)),this.minzoom=S||0,this.maxzoom=x||24};He.prototype.validateBounds=function(_){return Array.isArray(_)&&_.length===4?[Math.max(-180,_[0]),Math.max(-90,_[1]),Math.min(180,_[2]),Math.min(90,_[3])]:[-180,-90,180,90]},He.prototype.contains=function(_){var S=Math.pow(2,_.z),x=Math.floor(E.mercatorXfromLng(this.bounds.getWest())*S),C=Math.floor(E.mercatorYfromLat(this.bounds.getNorth())*S),k=Math.ceil(E.mercatorXfromLng(this.bounds.getEast())*S),G=Math.ceil(E.mercatorYfromLat(this.bounds.getSouth())*S);return _.x>=x&&_.x<k&&_.y>=C&&_.y<G};var Rt=function(_){function S(x,C,k,G){if(_.call(this),this.id=x,this.dispatcher=k,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,E.extend(this,E.pick(C,["url","scheme","tileSize","promoteId"])),this._options=E.extend({type:"vector"},C),this._collectResourceTiming=C.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(G)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this._loaded=!1,this.fire(new E.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bn(this._options,this.map._requestManager,function(C,k){x._tileJSONRequest=null,x._loaded=!0,C?x.fire(new E.ErrorEvent(C)):k&&(E.extend(x,k),k.bounds&&(x.tileBounds=new He(k.bounds,x.minzoom,x.maxzoom)),E.postTurnstileEvent(k.tiles,x.map._requestManager._customAccessToken),E.postMapLoadEvent(k.tiles,x.map._getMapId(),x.map._requestManager._skuToken,x.map._requestManager._customAccessToken),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"metadata"})),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"content"})))})},S.prototype.loaded=function(){return this._loaded},S.prototype.hasTile=function(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.setSourceProperty=function(x){this._tileJSONRequest&&this._tileJSONRequest.cancel(),x(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},S.prototype.setTiles=function(x){var C=this;return this.setSourceProperty(function(){C._options.tiles=x}),this},S.prototype.setUrl=function(x){var C=this;return this.setSourceProperty(function(){C.url=x,C._options.url=x}),this},S.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},S.prototype.serialize=function(){return E.extend({},this._options)},S.prototype.loadTile=function(x,C){var k=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme)),G={request:this.map._requestManager.transformRequest(k,E.ResourceType.Tile),uid:x.uid,tileID:x.tileID,zoom:x.tileID.overscaledZ,tileSize:this.tileSize*x.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:E.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function q(he,je){return delete x.request,x.aborted?C(null):he&&he.status!==404?C(he):(je&&je.resourceTiming&&(x.resourceTiming=je.resourceTiming),this.map._refreshExpiredTiles&&je&&x.setExpiryData(je),x.loadVectorData(je,this.map.painter),E.cacheEntryPossiblyAdded(this.dispatcher),C(null),void(x.reloadCallback&&(this.loadTile(x,x.reloadCallback),x.reloadCallback=null)))}G.request.collectResourceTiming=this._collectResourceTiming,x.actor&&x.state!=="expired"?x.state==="loading"?x.reloadCallback=C:x.request=x.actor.send("reloadTile",G,q.bind(this)):(x.actor=this.dispatcher.getActor(),x.request=x.actor.send("loadTile",G,q.bind(this)))},S.prototype.abortTile=function(x){x.request&&(x.request.cancel(),delete x.request),x.actor&&x.actor.send("abortTile",{uid:x.uid,type:this.type,source:this.id},void 0)},S.prototype.unloadTile=function(x){x.unloadVectorData(),x.actor&&x.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id},void 0)},S.prototype.hasTransition=function(){return!1},S}(E.Evented),Oe=function(_){function S(x,C,k,G){_.call(this),this.id=x,this.dispatcher=k,this.setEventedParent(G),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=E.extend({type:"raster"},C),E.extend(this,E.pick(C,["url","scheme","tileSize"]))}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this._loaded=!1,this.fire(new E.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bn(this._options,this.map._requestManager,function(C,k){x._tileJSONRequest=null,x._loaded=!0,C?x.fire(new E.ErrorEvent(C)):k&&(E.extend(x,k),k.bounds&&(x.tileBounds=new He(k.bounds,x.minzoom,x.maxzoom)),E.postTurnstileEvent(k.tiles),E.postMapLoadEvent(k.tiles,x.map._getMapId(),x.map._requestManager._skuToken),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"metadata"})),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"content"})))})},S.prototype.loaded=function(){return this._loaded},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},S.prototype.serialize=function(){return E.extend({},this._options)},S.prototype.hasTile=function(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)},S.prototype.loadTile=function(x,C){var k=this,G=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);x.request=E.getImage(this.map._requestManager.transformRequest(G,E.ResourceType.Tile),function(q,he){if(delete x.request,x.aborted)x.state="unloaded",C(null);else if(q)x.state="errored",C(q);else if(he){k.map._refreshExpiredTiles&&x.setExpiryData(he),delete he.cacheControl,delete he.expires;var je=k.map.painter.context,Xe=je.gl;x.texture=k.map.painter.getTileTexture(he.width),x.texture?x.texture.update(he,{useMipmap:!0}):(x.texture=new E.Texture(je,he,Xe.RGBA,{useMipmap:!0}),x.texture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE,Xe.LINEAR_MIPMAP_NEAREST),je.extTextureFilterAnisotropic&&Xe.texParameterf(Xe.TEXTURE_2D,je.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,je.extTextureFilterAnisotropicMax)),x.state="loaded",E.cacheEntryPossiblyAdded(k.dispatcher),C(null)}})},S.prototype.abortTile=function(x,C){x.request&&(x.request.cancel(),delete x.request),C()},S.prototype.unloadTile=function(x,C){x.texture&&this.map.painter.saveTileTexture(x.texture),C()},S.prototype.hasTransition=function(){return!1},S}(E.Evented),it=function(_){function S(x,C,k,G){_.call(this,x,C,k,G),this.type="raster-dem",this.maxzoom=22,this._options=E.extend({type:"raster-dem"},C),this.encoding=C.encoding||"mapbox"}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},S.prototype.loadTile=function(x,C){var k=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function G(q,he){q&&(x.state="errored",C(q)),he&&(x.dem=he,x.needsHillshadePrepare=!0,x.state="loaded",C(null))}x.request=E.getImage(this.map._requestManager.transformRequest(k,E.ResourceType.Tile),function(q,he){if(delete x.request,x.aborted)x.state="unloaded",C(null);else if(q)x.state="errored",C(q);else if(he){this.map._refreshExpiredTiles&&x.setExpiryData(he),delete he.cacheControl,delete he.expires;var je=E.window.ImageBitmap&&he instanceof E.window.ImageBitmap&&E.offscreenCanvasSupported()?he:E.browser.getImageData(he,1),Xe={uid:x.uid,coord:x.tileID,source:this.id,rawImageData:je,encoding:this.encoding};x.actor&&x.state!=="expired"||(x.actor=this.dispatcher.getActor(),x.actor.send("loadDEMTile",Xe,G.bind(this)))}}.bind(this)),x.neighboringTiles=this._getNeighboringTiles(x.tileID)},S.prototype._getNeighboringTiles=function(x){var C=x.canonical,k=Math.pow(2,C.z),G=(C.x-1+k)%k,q=C.x===0?x.wrap-1:x.wrap,he=(C.x+1+k)%k,je=C.x+1===k?x.wrap+1:x.wrap,Xe={};return Xe[new E.OverscaledTileID(x.overscaledZ,q,C.z,G,C.y).key]={backfilled:!1},Xe[new E.OverscaledTileID(x.overscaledZ,je,C.z,he,C.y).key]={backfilled:!1},C.y>0&&(Xe[new E.OverscaledTileID(x.overscaledZ,q,C.z,G,C.y-1).key]={backfilled:!1},Xe[new E.OverscaledTileID(x.overscaledZ,x.wrap,C.z,C.x,C.y-1).key]={backfilled:!1},Xe[new E.OverscaledTileID(x.overscaledZ,je,C.z,he,C.y-1).key]={backfilled:!1}),C.y+1<k&&(Xe[new E.OverscaledTileID(x.overscaledZ,q,C.z,G,C.y+1).key]={backfilled:!1},Xe[new E.OverscaledTileID(x.overscaledZ,x.wrap,C.z,C.x,C.y+1).key]={backfilled:!1},Xe[new E.OverscaledTileID(x.overscaledZ,je,C.z,he,C.y+1).key]={backfilled:!1}),Xe},S.prototype.unloadTile=function(x){x.demTexture&&this.map.painter.saveTileTexture(x.demTexture),x.fbo&&(x.fbo.destroy(),delete x.fbo),x.dem&&delete x.dem,delete x.neighboringTiles,x.state="unloaded",x.actor&&x.actor.send("removeDEMTile",{uid:x.uid,source:this.id})},S}(Oe),Qe=function(_){function S(x,C,k,G){_.call(this),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=k.getActor(),this.setEventedParent(G),this._data=C.data,this._options=E.extend({},C),this._collectResourceTiming=C.collectResourceTiming,this._resourceTiming=[],C.maxzoom!==void 0&&(this.maxzoom=C.maxzoom),C.type&&(this.type=C.type),C.attribution&&(this.attribution=C.attribution),this.promoteId=C.promoteId;var q=E.EXTENT/this.tileSize;this.workerOptions=E.extend({source:this.id,cluster:C.cluster||!1,geojsonVtOptions:{buffer:(C.buffer!==void 0?C.buffer:128)*q,tolerance:(C.tolerance!==void 0?C.tolerance:.375)*q,extent:E.EXTENT,maxZoom:this.maxzoom,lineMetrics:C.lineMetrics||!1,generateId:C.generateId||!1},superclusterOptions:{maxZoom:C.clusterMaxZoom!==void 0?Math.min(C.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,C.clusterMinPoints||2),extent:E.EXTENT,radius:(C.clusterRadius||50)*q,log:!1,generateId:C.generateId||!1},clusterProperties:C.clusterProperties,filter:C.filter},C.workerOptions)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this.fire(new E.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(C){if(C)x.fire(new E.ErrorEvent(C));else{var k={dataType:"source",sourceDataType:"metadata"};x._collectResourceTiming&&x._resourceTiming&&x._resourceTiming.length>0&&(k.resourceTiming=x._resourceTiming,x._resourceTiming=[]),x.fire(new E.Event("data",k))}})},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.setData=function(x){var C=this;return this._data=x,this.fire(new E.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(k){if(k)C.fire(new E.ErrorEvent(k));else{var G={dataType:"source",sourceDataType:"content"};C._collectResourceTiming&&C._resourceTiming&&C._resourceTiming.length>0&&(G.resourceTiming=C._resourceTiming,C._resourceTiming=[]),C.fire(new E.Event("data",G))}}),this},S.prototype.getClusterExpansionZoom=function(x,C){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id},C),this},S.prototype.getClusterChildren=function(x,C){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id},C),this},S.prototype.getClusterLeaves=function(x,C,k,G){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:x,limit:C,offset:k},G),this},S.prototype._updateWorkerData=function(x){var C=this;this._loaded=!1;var k=E.extend({},this.workerOptions),G=this._data;typeof G=="string"?(k.request=this.map._requestManager.transformRequest(E.browser.resolveURL(G),E.ResourceType.Source),k.request.collectResourceTiming=this._collectResourceTiming):k.data=JSON.stringify(G),this.actor.send(this.type+".loadData",k,function(q,he){C._removed||he&&he.abandoned||(C._loaded=!0,he&&he.resourceTiming&&he.resourceTiming[C.id]&&(C._resourceTiming=he.resourceTiming[C.id].slice(0)),C.actor.send(C.type+".coalesce",{source:k.source},null),x(q))})},S.prototype.loaded=function(){return this._loaded},S.prototype.loadTile=function(x,C){var k=this,G=x.actor?"reloadTile":"loadTile";x.actor=this.actor,x.request=this.actor.send(G,{type:this.type,uid:x.uid,tileID:x.tileID,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:E.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(q,he){return delete x.request,x.unloadVectorData(),x.aborted?C(null):q?C(q):(x.loadVectorData(he,k.map.painter,G==="reloadTile"),C(null))})},S.prototype.abortTile=function(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0},S.prototype.unloadTile=function(x){x.unloadVectorData(),this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id})},S.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},S.prototype.serialize=function(){return E.extend({},this._options,{type:this.type,data:this._data})},S.prototype.hasTransition=function(){return!1},S}(E.Evented),$e=E.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ot=function(_){function S(x,C,k,G){_.call(this),this.id=x,this.dispatcher=k,this.coordinates=C.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(G),this.options=C}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(x,C){var k=this;this._loaded=!1,this.fire(new E.Event("dataloading",{dataType:"source"})),this.url=this.options.url,E.getImage(this.map._requestManager.transformRequest(this.url,E.ResourceType.Image),function(G,q){k._loaded=!0,G?k.fire(new E.ErrorEvent(G)):q&&(k.image=q,x&&(k.coordinates=x),C&&C(),k._finishLoading())})},S.prototype.loaded=function(){return this._loaded},S.prototype.updateImage=function(x){var C=this;return this.image&&x.url?(this.options.url=x.url,this.load(x.coordinates,function(){C.texture=null}),this):this},S.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new E.Event("data",{dataType:"source",sourceDataType:"metadata"})))},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.setCoordinates=function(x){var C=this;this.coordinates=x;var k=x.map(E.MercatorCoordinate.fromLngLat);this.tileID=function(q){for(var he=1/0,je=1/0,Xe=-1/0,kt=-1/0,jt=0,Yt=q;jt<Yt.length;jt+=1){var gn=Yt[jt];he=Math.min(he,gn.x),je=Math.min(je,gn.y),Xe=Math.max(Xe,gn.x),kt=Math.max(kt,gn.y)}var pn=Math.max(Xe-he,kt-je),Cn=Math.max(0,Math.floor(-Math.log(pn)/Math.LN2)),un=Math.pow(2,Cn);return new E.CanonicalTileID(Cn,Math.floor((he+Xe)/2*un),Math.floor((je+kt)/2*un))}(k),this.minzoom=this.maxzoom=this.tileID.z;var G=k.map(function(q){return C.tileID.getTilePoint(q)._round()});return this._boundsArray=new E.StructArrayLayout4i8,this._boundsArray.emplaceBack(G[0].x,G[0].y,0,0),this._boundsArray.emplaceBack(G[1].x,G[1].y,E.EXTENT,0),this._boundsArray.emplaceBack(G[3].x,G[3].y,0,E.EXTENT),this._boundsArray.emplaceBack(G[2].x,G[2].y,E.EXTENT,E.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new E.Event("data",{dataType:"source",sourceDataType:"content"})),this},S.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var x=this.map.painter.context,C=x.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=E.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new E.Texture(x,this.image,C.RGBA),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE)),this.tiles){var G=this.tiles[k];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}}},S.prototype.loadTile=function(x,C){this.tileID&&this.tileID.equals(x.tileID.canonical)?(this.tiles[String(x.tileID.wrap)]=x,x.buckets={},C(null)):(x.state="errored",C(null))},S.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},S.prototype.hasTransition=function(){return!1},S}(E.Evented),vt=function(_){function S(x,C,k,G){_.call(this,x,C,k,G),this.roundZoom=!0,this.type="video",this.options=C}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this._loaded=!1;var C=this.options;this.urls=[];for(var k=0,G=C.urls;k<G.length;k+=1)this.urls.push(this.map._requestManager.transformRequest(G[k],E.ResourceType.Source).url);E.getVideo(this.urls,function(q,he){x._loaded=!0,q?x.fire(new E.ErrorEvent(q)):he&&(x.video=he,x.video.loop=!0,x.video.setAttribute("playsinline",""),x.video.addEventListener("playing",function(){x.map.triggerRepaint()}),x.map&&x.video.play(),x._finishLoading())})},S.prototype.pause=function(){this.video&&this.video.pause()},S.prototype.play=function(){this.video&&this.video.play()},S.prototype.seek=function(x){if(this.video){var C=this.video.seekable;x<C.start(0)||x>C.end(0)?this.fire(new E.ErrorEvent(new E.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+C.start(0)+" and "+C.end(0)+"-second mark."))):this.video.currentTime=x}},S.prototype.getVideo=function(){return this.video},S.prototype.onAdd=function(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},S.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var x=this.map.painter.context,C=x.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=E.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.texSubImage2D(C.TEXTURE_2D,0,0,0,C.RGBA,C.UNSIGNED_BYTE,this.video)):(this.texture=new E.Texture(x,this.video,C.RGBA),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE)),this.tiles){var G=this.tiles[k];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}}},S.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},S.prototype.hasTransition=function(){return this.video&&!this.video.paused},S}(Ot),Me=function(_){function S(x,C,k,G){_.call(this,x,C,k,G),C.coordinates?Array.isArray(C.coordinates)&&C.coordinates.length===4&&!C.coordinates.some(function(q){return!Array.isArray(q)||q.length!==2||q.some(function(he){return typeof he!="number"})})||this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'missing required property "coordinates"'))),C.animate&&typeof C.animate!="boolean"&&this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'optional "animate" property must be a boolean value'))),C.canvas?typeof C.canvas=="string"||C.canvas instanceof E.window.HTMLCanvasElement||this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'missing required property "canvas"'))),this.options=C,this.animate=C.animate===void 0||C.animate}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof E.window.HTMLCanvasElement?this.options.canvas:E.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new E.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},S.prototype.getCanvas=function(){return this.canvas},S.prototype.onAdd=function(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()},S.prototype.onRemove=function(){this.pause()},S.prototype.prepare=function(){var x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var C=this.map.painter.context,k=C.gl;for(var G in this.boundsBuffer||(this.boundsBuffer=C.createVertexBuffer(this._boundsArray,$e.members)),this.boundsSegments||(this.boundsSegments=E.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new E.Texture(C,this.canvas,k.RGBA,{premultiply:!0}),this.tiles){var q=this.tiles[G];q.state!=="loaded"&&(q.state="loaded",q.texture=this.texture)}}},S.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},S.prototype.hasTransition=function(){return this._playing},S.prototype._hasInvalidDimensions=function(){for(var x=0,C=[this.canvas.width,this.canvas.height];x<C.length;x+=1){var k=C[x];if(isNaN(k)||k<=0)return!0}return!1},S}(Ot),Xt={vector:Rt,raster:Oe,"raster-dem":it,geojson:Qe,video:vt,image:Ot,canvas:Me};function on(_,S){var x=E.identity([]);return E.translate(x,x,[1,1,0]),E.scale(x,x,[.5*_.width,.5*_.height,1]),E.multiply(x,x,_.calculatePosMatrix(S.toUnwrapped()))}function Fn(_,S,x,C,k,G){var q=function(Cn,un,kn){if(Cn)for(var er=0,ur=Cn;er<ur.length;er+=1){var Cr=un[ur[er]];if(Cr&&Cr.source===kn&&Cr.type==="fill-extrusion")return!0}else for(var dr in un){var Br=un[dr];if(Br.source===kn&&Br.type==="fill-extrusion")return!0}return!1}(k&&k.layers,S,_.id),he=G.maxPitchScaleFactor(),je=_.tilesIn(C,he,q);je.sort($n);for(var Xe=[],kt=0,jt=je;kt<jt.length;kt+=1){var Yt=jt[kt];Xe.push({wrappedTileID:Yt.tileID.wrapped().key,queryResults:Yt.tile.queryRenderedFeatures(S,x,_._state,Yt.queryGeometry,Yt.cameraQueryGeometry,Yt.scale,k,G,he,on(_.transform,Yt.tileID))})}var gn=function(Cn){for(var un={},kn={},er=0,ur=Cn;er<ur.length;er+=1){var Cr=ur[er],dr=Cr.queryResults,Br=Cr.wrappedTileID,ri=kn[Br]=kn[Br]||{};for(var Yr in dr)for(var wi=dr[Yr],Hi=ri[Yr]=ri[Yr]||{},Lo=un[Yr]=un[Yr]||[],Fo=0,ko=wi;Fo<ko.length;Fo+=1){var fa=ko[Fo];Hi[fa.featureIndex]||(Hi[fa.featureIndex]=!0,Lo.push(fa))}}return un}(Xe);for(var pn in gn)gn[pn].forEach(function(Cn){var un=Cn.feature,kn=_.getFeatureState(un.layer["source-layer"],un.id);un.source=un.layer.source,un.layer["source-layer"]&&(un.sourceLayer=un.layer["source-layer"]),un.state=kn});return gn}function $n(_,S){var x=_.tileID,C=S.tileID;return x.overscaledZ-C.overscaledZ||x.canonical.y-C.canonical.y||x.wrap-C.wrap||x.canonical.x-C.canonical.x}var nr=function(_,S){this.max=_,this.onRemove=S,this.reset()};nr.prototype.reset=function(){for(var _ in this.data)for(var S=0,x=this.data[_];S<x.length;S+=1){var C=x[S];C.timeout&&clearTimeout(C.timeout),this.onRemove(C.value)}return this.data={},this.order=[],this},nr.prototype.add=function(_,S,x){var C=this,k=_.wrapped().key;this.data[k]===void 0&&(this.data[k]=[]);var G={value:S,timeout:void 0};if(x!==void 0&&(G.timeout=setTimeout(function(){C.remove(_,G)},x)),this.data[k].push(G),this.order.push(k),this.order.length>this.max){var q=this._getAndRemoveByKey(this.order[0]);q&&this.onRemove(q)}return this},nr.prototype.has=function(_){return _.wrapped().key in this.data},nr.prototype.getAndRemove=function(_){return this.has(_)?this._getAndRemoveByKey(_.wrapped().key):null},nr.prototype._getAndRemoveByKey=function(_){var S=this.data[_].shift();return S.timeout&&clearTimeout(S.timeout),this.data[_].length===0&&delete this.data[_],this.order.splice(this.order.indexOf(_),1),S.value},nr.prototype.getByKey=function(_){var S=this.data[_];return S?S[0].value:null},nr.prototype.get=function(_){return this.has(_)?this.data[_.wrapped().key][0].value:null},nr.prototype.remove=function(_,S){if(!this.has(_))return this;var x=_.wrapped().key,C=S===void 0?0:this.data[x].indexOf(S),k=this.data[x][C];return this.data[x].splice(C,1),k.timeout&&clearTimeout(k.timeout),this.data[x].length===0&&delete this.data[x],this.onRemove(k.value),this.order.splice(this.order.indexOf(x),1),this},nr.prototype.setMaxSize=function(_){for(this.max=_;this.order.length>this.max;){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},nr.prototype.filter=function(_){var S=[];for(var x in this.data)for(var C=0,k=this.data[x];C<k.length;C+=1){var G=k[C];_(G.value)||S.push(G)}for(var q=0,he=S;q<he.length;q+=1){var je=he[q];this.remove(je.value.tileID,je)}};var Ht=function(_,S,x){this.context=_;var C=_.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),_.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete S.arrayBuffer};Ht.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ht.prototype.updateData=function(_){var S=this.context.gl;this.context.unbindVAO(),this.bind(),S.bufferSubData(S.ELEMENT_ARRAY_BUFFER,0,_.arrayBuffer)},Ht.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Jt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},_n=function(_,S,x,C){this.length=S.length,this.attributes=x,this.itemSize=S.bytesPerElement,this.dynamicDraw=C,this.context=_;var k=_.gl;this.buffer=k.createBuffer(),_.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||delete S.arrayBuffer};_n.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},_n.prototype.updateData=function(_){var S=this.context.gl;this.bind(),S.bufferSubData(S.ARRAY_BUFFER,0,_.arrayBuffer)},_n.prototype.enableAttributes=function(_,S){for(var x=0;x<this.attributes.length;x++){var C=S.attributes[this.attributes[x].name];C!==void 0&&_.enableVertexAttribArray(C)}},_n.prototype.setVertexAttribPointers=function(_,S,x){for(var C=0;C<this.attributes.length;C++){var k=this.attributes[C],G=S.attributes[k.name];G!==void 0&&_.vertexAttribPointer(G,k.components,_[Jt[k.type]],!1,this.itemSize,k.offset+this.itemSize*(x||0))}},_n.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var tr=function(_){this.gl=_.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};tr.prototype.get=function(){return this.current},tr.prototype.set=function(_){},tr.prototype.getDefault=function(){return this.default},tr.prototype.setDefault=function(){this.set(this.default)};var an=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return E.Color.transparent},S.prototype.set=function(x){var C=this.current;(x.r!==C.r||x.g!==C.g||x.b!==C.b||x.a!==C.a||this.dirty)&&(this.gl.clearColor(x.r,x.g,x.b,x.a),this.current=x,this.dirty=!1)},S}(tr),Ut=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 1},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.clearDepth(x),this.current=x,this.dirty=!1)},S}(tr),Dt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 0},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.clearStencil(x),this.current=x,this.dirty=!1)},S}(tr),Ie=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return[!0,!0,!0,!0]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||x[2]!==C[2]||x[3]!==C[3]||this.dirty)&&(this.gl.colorMask(x[0],x[1],x[2],x[3]),this.current=x,this.dirty=!1)},S}(tr),qe=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!0},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.depthMask(x),this.current=x,this.dirty=!1)},S}(tr),Bt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 255},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.stencilMask(x),this.current=x,this.dirty=!1)},S}(tr),j=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},S.prototype.set=function(x){var C=this.current;(x.func!==C.func||x.ref!==C.ref||x.mask!==C.mask||this.dirty)&&(this.gl.stencilFunc(x.func,x.ref,x.mask),this.current=x,this.dirty=!1)},S}(tr),le=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){var x=this.gl;return[x.KEEP,x.KEEP,x.KEEP]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||x[2]!==C[2]||this.dirty)&&(this.gl.stencilOp(x[0],x[1],x[2]),this.current=x,this.dirty=!1)},S}(tr),z=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.STENCIL_TEST):C.disable(C.STENCIL_TEST),this.current=x,this.dirty=!1}},S}(tr),de=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return[0,1]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||this.dirty)&&(this.gl.depthRange(x[0],x[1]),this.current=x,this.dirty=!1)},S}(tr),Zt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST),this.current=x,this.dirty=!1}},S}(tr),nt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.LESS},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.depthFunc(x),this.current=x,this.dirty=!1)},S}(tr),St=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.BLEND):C.disable(C.BLEND),this.current=x,this.dirty=!1}},S}(tr),In=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){var x=this.gl;return[x.ONE,x.ZERO]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||this.dirty)&&(this.gl.blendFunc(x[0],x[1]),this.current=x,this.dirty=!1)},S}(tr),Wn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return E.Color.transparent},S.prototype.set=function(x){var C=this.current;(x.r!==C.r||x.g!==C.g||x.b!==C.b||x.a!==C.a||this.dirty)&&(this.gl.blendColor(x.r,x.g,x.b,x.a),this.current=x,this.dirty=!1)},S}(tr),qn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.FUNC_ADD},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.blendEquation(x),this.current=x,this.dirty=!1)},S}(tr),hn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),this.current=x,this.dirty=!1}},S}(tr),pt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.BACK},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.cullFace(x),this.current=x,this.dirty=!1)},S}(tr),Wt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.CCW},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.frontFace(x),this.current=x,this.dirty=!1)},S}(tr),An=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.useProgram(x),this.current=x,this.dirty=!1)},S}(tr),Pn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.TEXTURE0},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.activeTexture(x),this.current=x,this.dirty=!1)},S}(tr),Xn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){var x=this.gl;return[0,0,x.drawingBufferWidth,x.drawingBufferHeight]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||x[2]!==C[2]||x[3]!==C[3]||this.dirty)&&(this.gl.viewport(x[0],x[1],x[2],x[3]),this.current=x,this.dirty=!1)},S}(tr),dt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindFramebuffer(C.FRAMEBUFFER,x),this.current=x,this.dirty=!1}},S}(tr),be=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindRenderbuffer(C.RENDERBUFFER,x),this.current=x,this.dirty=!1}},S}(tr),Ne=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindTexture(C.TEXTURE_2D,x),this.current=x,this.dirty=!1}},S}(tr),ot=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindBuffer(C.ARRAY_BUFFER,x),this.current=x,this.dirty=!1}},S}(tr),Pt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){var C=this.gl;C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,x),this.current=x,this.dirty=!1},S}(tr),It=function(_){function S(x){_.call(this,x),this.vao=x.extVertexArrayObject}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){this.vao&&(x!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(x),this.current=x,this.dirty=!1)},S}(tr),xn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 4},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_ALIGNMENT,x),this.current=x,this.dirty=!1}},S}(tr),Qn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,x),this.current=x,this.dirty=!1}},S}(tr),br=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,x),this.current=x,this.dirty=!1}},S}(tr),Jn=function(_){function S(x,C){_.call(this,x),this.context=x,this.parent=C}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S}(tr),Ae=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.setDirty=function(){this.dirty=!0},S.prototype.set=function(x){if(x!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var C=this.gl;C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_2D,x,0),this.current=x,this.dirty=!1}},S}(Jn),xe=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.set=function(x){if(x!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var C=this.gl;C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,x),this.current=x,this.dirty=!1}},S}(Jn),ke=function(_,S,x,C){this.context=_,this.width=S,this.height=x;var k=this.framebuffer=_.gl.createFramebuffer();this.colorAttachment=new Ae(_,k),C&&(this.depthAttachment=new xe(_,k))};ke.prototype.destroy=function(){var _=this.context.gl,S=this.colorAttachment.get();if(S&&_.deleteTexture(S),this.depthAttachment){var x=this.depthAttachment.get();x&&_.deleteRenderbuffer(x)}_.deleteFramebuffer(this.framebuffer)};var tt=function(_,S,x){this.func=_,this.mask=S,this.range=x};tt.ReadOnly=!1,tt.ReadWrite=!0,tt.disabled=new tt(519,tt.ReadOnly,[0,1]);var Et=function(_,S,x,C,k,G){this.test=_,this.ref=S,this.mask=x,this.fail=C,this.depthFail=k,this.pass=G};Et.disabled=new Et({func:519,mask:0},0,0,7680,7680,7680);var tn=function(_,S,x){this.blendFunction=_,this.blendColor=S,this.mask=x};tn.disabled=new tn(tn.Replace=[1,0],E.Color.transparent,[!1,!1,!1,!1]),tn.unblended=new tn(tn.Replace,E.Color.transparent,[!0,!0,!0,!0]),tn.alphaBlended=new tn([1,771],E.Color.transparent,[!0,!0,!0,!0]);var fn=function(_,S,x){this.enable=_,this.mode=S,this.frontFace=x};fn.disabled=new fn(!1,1029,2305),fn.backCCW=new fn(!0,1029,2305);var _t=function(_){this.gl=_,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new an(this),this.clearDepth=new Ut(this),this.clearStencil=new Dt(this),this.colorMask=new Ie(this),this.depthMask=new qe(this),this.stencilMask=new Bt(this),this.stencilFunc=new j(this),this.stencilOp=new le(this),this.stencilTest=new z(this),this.depthRange=new de(this),this.depthTest=new Zt(this),this.depthFunc=new nt(this),this.blend=new St(this),this.blendFunc=new In(this),this.blendColor=new Wn(this),this.blendEquation=new qn(this),this.cullFace=new hn(this),this.cullFaceSide=new pt(this),this.frontFace=new Wt(this),this.program=new An(this),this.activeTexture=new Pn(this),this.viewport=new Xn(this),this.bindFramebuffer=new dt(this),this.bindRenderbuffer=new be(this),this.bindTexture=new Ne(this),this.bindVertexBuffer=new ot(this),this.bindElementBuffer=new Pt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new It(this),this.pixelStoreUnpack=new xn(this),this.pixelStoreUnpackPremultiplyAlpha=new Qn(this),this.pixelStoreUnpackFlipY=new br(this),this.extTextureFilterAnisotropic=_.getExtension("EXT_texture_filter_anisotropic")||_.getExtension("MOZ_EXT_texture_filter_anisotropic")||_.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=_.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=_.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(_.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=_.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=_.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=_.getParameter(_.MAX_TEXTURE_SIZE)};_t.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},_t.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},_t.prototype.createIndexBuffer=function(_,S){return new Ht(this,_,S)},_t.prototype.createVertexBuffer=function(_,S,x){return new _n(this,_,S,x)},_t.prototype.createRenderbuffer=function(_,S,x){var C=this.gl,k=C.createRenderbuffer();return this.bindRenderbuffer.set(k),C.renderbufferStorage(C.RENDERBUFFER,_,S,x),this.bindRenderbuffer.set(null),k},_t.prototype.createFramebuffer=function(_,S,x){return new ke(this,_,S,x)},_t.prototype.clear=function(_){var S=_.color,x=_.depth,C=this.gl,k=0;S&&(k|=C.COLOR_BUFFER_BIT,this.clearColor.set(S),this.colorMask.set([!0,!0,!0,!0])),x!==void 0&&(k|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(x),this.depthMask.set(!0)),C.clear(k)},_t.prototype.setCullFace=function(_){_.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(_.mode),this.frontFace.set(_.frontFace))},_t.prototype.setDepthMode=function(_){_.func!==this.gl.ALWAYS||_.mask?(this.depthTest.set(!0),this.depthFunc.set(_.func),this.depthMask.set(_.mask),this.depthRange.set(_.range)):this.depthTest.set(!1)},_t.prototype.setStencilMode=function(_){_.test.func!==this.gl.ALWAYS||_.mask?(this.stencilTest.set(!0),this.stencilMask.set(_.mask),this.stencilOp.set([_.fail,_.depthFail,_.pass]),this.stencilFunc.set({func:_.test.func,ref:_.ref,mask:_.test.mask})):this.stencilTest.set(!1)},_t.prototype.setColorMode=function(_){E.deepEqual(_.blendFunction,tn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(_.blendFunction),this.blendColor.set(_.blendColor)),this.colorMask.set(_.mask)},_t.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var en=function(_){function S(x,C,k){var G=this;_.call(this),this.id=x,this.dispatcher=k,this.on("data",function(q){q.dataType==="source"&&q.sourceDataType==="metadata"&&(G._sourceLoaded=!0),G._sourceLoaded&&!G._paused&&q.dataType==="source"&&q.sourceDataType==="content"&&(G.reload(),G.transform&&G.update(G.transform))}),this.on("error",function(){G._sourceErrored=!0}),this._source=function(q,he,je,Xe){var kt=new Xt[he.type](q,he,je,Xe);if(kt.id!==q)throw new Error("Expected Source id to be "+q+" instead of "+kt.id);return E.bindAll(["load","abort","unload","serialize","prepare"],kt),kt}(x,C,k,this),this._tiles={},this._cache=new nr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new E.SourceFeatureState}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.onAdd=function(x){this.map=x,this._maxTileCacheSize=x?x._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(x)},S.prototype.onRemove=function(x){this._source&&this._source.onRemove&&this._source.onRemove(x)},S.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var x in this._tiles){var C=this._tiles[x];if(C.state!=="loaded"&&C.state!=="errored")return!1}return!0},S.prototype.getSource=function(){return this._source},S.prototype.pause=function(){this._paused=!0},S.prototype.resume=function(){if(this._paused){var x=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,x&&this.reload(),this.transform&&this.update(this.transform)}},S.prototype._loadTile=function(x,C){return this._source.loadTile(x,C)},S.prototype._unloadTile=function(x){if(this._source.unloadTile)return this._source.unloadTile(x,function(){})},S.prototype._abortTile=function(x){if(this._source.abortTile)return this._source.abortTile(x,function(){})},S.prototype.serialize=function(){return this._source.serialize()},S.prototype.prepare=function(x){for(var C in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var k=this._tiles[C];k.upload(x),k.prepare(this.map.style.imageManager)}},S.prototype.getIds=function(){return E.values(this._tiles).map(function(x){return x.tileID}).sort(Gn).map(function(x){return x.key})},S.prototype.getRenderableIds=function(x){var C=this,k=[];for(var G in this._tiles)this._isIdRenderable(G,x)&&k.push(this._tiles[G]);return x?k.sort(function(q,he){var je=q.tileID,Xe=he.tileID,kt=new E.Point(je.canonical.x,je.canonical.y)._rotate(C.transform.angle),jt=new E.Point(Xe.canonical.x,Xe.canonical.y)._rotate(C.transform.angle);return je.overscaledZ-Xe.overscaledZ||jt.y-kt.y||jt.x-kt.x}).map(function(q){return q.tileID.key}):k.map(function(q){return q.tileID}).sort(Gn).map(function(q){return q.key})},S.prototype.hasRenderableParent=function(x){var C=this.findLoadedParent(x,0);return!!C&&this._isIdRenderable(C.tileID.key)},S.prototype._isIdRenderable=function(x,C){return this._tiles[x]&&this._tiles[x].hasData()&&!this._coveredTiles[x]&&(C||!this._tiles[x].holdingForFade())},S.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var x in this._cache.reset(),this._tiles)this._tiles[x].state!=="errored"&&this._reloadTile(x,"reloading")},S.prototype._reloadTile=function(x,C){var k=this._tiles[x];k&&(k.state!=="loading"&&(k.state=C),this._loadTile(k,this._tileLoaded.bind(this,k,x,C)))},S.prototype._tileLoaded=function(x,C,k,G){if(G)return x.state="errored",void(G.status!==404?this._source.fire(new E.ErrorEvent(G,{tile:x})):this.update(this.transform));x.timeAdded=E.browser.now(),k==="expired"&&(x.refreshedUponExpiration=!0),this._setTileReloadTimer(C,x),this.getSource().type==="raster-dem"&&x.dem&&this._backfillDEM(x),this._state.initializeTileState(x,this.map?this.map.painter:null),this._source.fire(new E.Event("data",{dataType:"source",tile:x,coord:x.tileID}))},S.prototype._backfillDEM=function(x){for(var C=this.getRenderableIds(),k=0;k<C.length;k++){var G=C[k];if(x.neighboringTiles&&x.neighboringTiles[G]){var q=this.getTileByID(G);he(x,q),he(q,x)}}function he(je,Xe){je.needsHillshadePrepare=!0;var kt=Xe.tileID.canonical.x-je.tileID.canonical.x,jt=Xe.tileID.canonical.y-je.tileID.canonical.y,Yt=Math.pow(2,je.tileID.canonical.z),gn=Xe.tileID.key;kt===0&&jt===0||Math.abs(jt)>1||(Math.abs(kt)>1&&(Math.abs(kt+Yt)===1?kt+=Yt:Math.abs(kt-Yt)===1&&(kt-=Yt)),Xe.dem&&je.dem&&(je.dem.backfillBorder(Xe.dem,kt,jt),je.neighboringTiles&&je.neighboringTiles[gn]&&(je.neighboringTiles[gn].backfilled=!0)))}},S.prototype.getTile=function(x){return this.getTileByID(x.key)},S.prototype.getTileByID=function(x){return this._tiles[x]},S.prototype._retainLoadedChildren=function(x,C,k,G){for(var q in this._tiles){var he=this._tiles[q];if(!(G[q]||!he.hasData()||he.tileID.overscaledZ<=C||he.tileID.overscaledZ>k)){for(var je=he.tileID;he&&he.tileID.overscaledZ>C+1;){var Xe=he.tileID.scaledTo(he.tileID.overscaledZ-1);(he=this._tiles[Xe.key])&&he.hasData()&&(je=Xe)}for(var kt=je;kt.overscaledZ>C;)if(x[(kt=kt.scaledTo(kt.overscaledZ-1)).key]){G[je.key]=je;break}}}},S.prototype.findLoadedParent=function(x,C){if(x.key in this._loadedParentTiles){var k=this._loadedParentTiles[x.key];return k&&k.tileID.overscaledZ>=C?k:null}for(var G=x.overscaledZ-1;G>=C;G--){var q=x.scaledTo(G),he=this._getLoadedTile(q);if(he)return he}},S.prototype._getLoadedTile=function(x){var C=this._tiles[x.key];return C&&C.hasData()?C:this._cache.getByKey(x.wrapped().key)},S.prototype.updateCacheSize=function(x){var C=Math.ceil(x.width/this._source.tileSize)+1,k=Math.ceil(x.height/this._source.tileSize)+1,G=Math.floor(C*k*5),q=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,G):G;this._cache.setMaxSize(q)},S.prototype.handleWrapJump=function(x){var C=Math.round((x-(this._prevLng===void 0?x:this._prevLng))/360);if(this._prevLng=x,C){var k={};for(var G in this._tiles){var q=this._tiles[G];q.tileID=q.tileID.unwrapTo(q.tileID.wrap+C),k[q.tileID.key]=q}for(var he in this._tiles=k,this._timers)clearTimeout(this._timers[he]),delete this._timers[he];for(var je in this._tiles)this._setTileReloadTimer(je,this._tiles[je])}},S.prototype.update=function(x){var C=this;if(this.transform=x,this._sourceLoaded&&!this._paused){var k;this.updateCacheSize(x),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?k=x.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ri){return new E.OverscaledTileID(ri.canonical.z,ri.wrap,ri.canonical.z,ri.canonical.x,ri.canonical.y)}):(k=x.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(k=k.filter(function(ri){return C._source.hasTile(ri)}))):k=[];var G=x.coveringZoomLevel(this._source),q=Math.max(G-S.maxOverzooming,this._source.minzoom),he=Math.max(G+S.maxUnderzooming,this._source.minzoom),je=this._updateRetainedTiles(k,G);if(Tr(this._source.type)){for(var Xe={},kt={},jt=0,Yt=Object.keys(je);jt<Yt.length;jt+=1){var gn=Yt[jt],pn=je[gn],Cn=this._tiles[gn];if(Cn&&!(Cn.fadeEndTime&&Cn.fadeEndTime<=E.browser.now())){var un=this.findLoadedParent(pn,q);un&&(this._addTile(un.tileID),Xe[un.tileID.key]=un.tileID),kt[gn]=pn}}for(var kn in this._retainLoadedChildren(kt,G,he,je),Xe)je[kn]||(this._coveredTiles[kn]=!0,je[kn]=Xe[kn])}for(var er in je)this._tiles[er].clearFadeHold();for(var ur=0,Cr=E.keysDifference(this._tiles,je);ur<Cr.length;ur+=1){var dr=Cr[ur],Br=this._tiles[dr];Br.hasSymbolBuckets&&!Br.holdingForFade()?Br.setHoldDuration(this.map._fadeDuration):Br.hasSymbolBuckets&&!Br.symbolFadeFinished()||this._removeTile(dr)}this._updateLoadedParentTileCache()}},S.prototype.releaseSymbolFadeTiles=function(){for(var x in this._tiles)this._tiles[x].holdingForFade()&&this._removeTile(x)},S.prototype._updateRetainedTiles=function(x,C){for(var k={},G={},q=Math.max(C-S.maxOverzooming,this._source.minzoom),he=Math.max(C+S.maxUnderzooming,this._source.minzoom),je={},Xe=0,kt=x;Xe<kt.length;Xe+=1){var jt=kt[Xe],Yt=this._addTile(jt);k[jt.key]=jt,Yt.hasData()||C<this._source.maxzoom&&(je[jt.key]=jt)}this._retainLoadedChildren(je,C,he,k);for(var gn=0,pn=x;gn<pn.length;gn+=1){var Cn=pn[gn],un=this._tiles[Cn.key];if(!un.hasData()){if(C+1>this._source.maxzoom){var kn=Cn.children(this._source.maxzoom)[0],er=this.getTile(kn);if(er&&er.hasData()){k[kn.key]=kn;continue}}else{var ur=Cn.children(this._source.maxzoom);if(k[ur[0].key]&&k[ur[1].key]&&k[ur[2].key]&&k[ur[3].key])continue}for(var Cr=un.wasRequested(),dr=Cn.overscaledZ-1;dr>=q;--dr){var Br=Cn.scaledTo(dr);if(G[Br.key]||(G[Br.key]=!0,!(un=this.getTile(Br))&&Cr&&(un=this._addTile(Br)),un&&(k[Br.key]=Br,Cr=un.wasRequested(),un.hasData())))break}}}return k},S.prototype._updateLoadedParentTileCache=function(){for(var x in this._loadedParentTiles={},this._tiles){for(var C=[],k=void 0,G=this._tiles[x].tileID;G.overscaledZ>0;){if(G.key in this._loadedParentTiles){k=this._loadedParentTiles[G.key];break}C.push(G.key);var q=G.scaledTo(G.overscaledZ-1);if(k=this._getLoadedTile(q))break;G=q}for(var he=0,je=C;he<je.length;he+=1)this._loadedParentTiles[je[he]]=k}},S.prototype._addTile=function(x){var C=this._tiles[x.key];if(C)return C;(C=this._cache.getAndRemove(x))&&(this._setTileReloadTimer(x.key,C),C.tileID=x,this._state.initializeTileState(C,this.map?this.map.painter:null),this._cacheTimers[x.key]&&(clearTimeout(this._cacheTimers[x.key]),delete this._cacheTimers[x.key],this._setTileReloadTimer(x.key,C)));var k=!!C;return k||(C=new E.Tile(x,this._source.tileSize*x.overscaleFactor()),this._loadTile(C,this._tileLoaded.bind(this,C,x.key,C.state))),C?(C.uses++,this._tiles[x.key]=C,k||this._source.fire(new E.Event("dataloading",{tile:C,coord:C.tileID,dataType:"source"})),C):null},S.prototype._setTileReloadTimer=function(x,C){var k=this;x in this._timers&&(clearTimeout(this._timers[x]),delete this._timers[x]);var G=C.getExpiryTimeout();G&&(this._timers[x]=setTimeout(function(){k._reloadTile(x,"expired"),delete k._timers[x]},G))},S.prototype._removeTile=function(x){var C=this._tiles[x];C&&(C.uses--,delete this._tiles[x],this._timers[x]&&(clearTimeout(this._timers[x]),delete this._timers[x]),C.uses>0||(C.hasData()&&C.state!=="reloading"?this._cache.add(C.tileID,C,C.getExpiryTimeout()):(C.aborted=!0,this._abortTile(C),this._unloadTile(C))))},S.prototype.clearTiles=function(){for(var x in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(x);this._cache.reset()},S.prototype.tilesIn=function(x,C,k){var G=this,q=[],he=this.transform;if(!he)return q;for(var je=k?he.getCameraQueryGeometry(x):x,Xe=x.map(function(dr){return he.pointCoordinate(dr)}),kt=je.map(function(dr){return he.pointCoordinate(dr)}),jt=this.getIds(),Yt=1/0,gn=1/0,pn=-1/0,Cn=-1/0,un=0,kn=kt;un<kn.length;un+=1){var er=kn[un];Yt=Math.min(Yt,er.x),gn=Math.min(gn,er.y),pn=Math.max(pn,er.x),Cn=Math.max(Cn,er.y)}for(var ur=function(dr){var Br=G._tiles[jt[dr]];if(!Br.holdingForFade()){var ri=Br.tileID,Yr=Math.pow(2,he.zoom-Br.tileID.overscaledZ),wi=C*Br.queryPadding*E.EXTENT/Br.tileSize/Yr,Hi=[ri.getTilePoint(new E.MercatorCoordinate(Yt,gn)),ri.getTilePoint(new E.MercatorCoordinate(pn,Cn))];if(Hi[0].x-wi<E.EXTENT&&Hi[0].y-wi<E.EXTENT&&Hi[1].x+wi>=0&&Hi[1].y+wi>=0){var Lo=Xe.map(function(ko){return ri.getTilePoint(ko)}),Fo=kt.map(function(ko){return ri.getTilePoint(ko)});q.push({tile:Br,tileID:ri,queryGeometry:Lo,cameraQueryGeometry:Fo,scale:Yr})}}},Cr=0;Cr<jt.length;Cr++)ur(Cr);return q},S.prototype.getVisibleCoordinates=function(x){for(var C=this,k=this.getRenderableIds(x).map(function(je){return C._tiles[je].tileID}),G=0,q=k;G<q.length;G+=1){var he=q[G];he.posMatrix=this.transform.calculatePosMatrix(he.toUnwrapped())}return k},S.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Tr(this._source.type))for(var x in this._tiles){var C=this._tiles[x];if(C.fadeEndTime!==void 0&&C.fadeEndTime>=E.browser.now())return!0}return!1},S.prototype.setFeatureState=function(x,C,k){this._state.updateState(x=x||"_geojsonTileLayer",C,k)},S.prototype.removeFeatureState=function(x,C,k){this._state.removeFeatureState(x=x||"_geojsonTileLayer",C,k)},S.prototype.getFeatureState=function(x,C){return this._state.getState(x=x||"_geojsonTileLayer",C)},S.prototype.setDependencies=function(x,C,k){var G=this._tiles[x];G&&G.setDependencies(C,k)},S.prototype.reloadTilesForDependencies=function(x,C){for(var k in this._tiles)this._tiles[k].hasDependency(x,C)&&this._reloadTile(k,"reloading");this._cache.filter(function(G){return!G.hasDependency(x,C)})},S}(E.Evented);function Gn(_,S){var x=Math.abs(2*_.wrap)-+(_.wrap<0),C=Math.abs(2*S.wrap)-+(S.wrap<0);return _.overscaledZ-S.overscaledZ||C-x||S.canonical.y-_.canonical.y||S.canonical.x-_.canonical.x}function Tr(_){return _==="raster"||_==="image"||_==="video"}function jr(){return new E.window.Worker(e0.workerUrl)}en.maxOverzooming=10,en.maxUnderzooming=3;var vr="mapboxgl_preloaded_worker_pool",Ur=function(){this.active={}};Ur.prototype.acquire=function(_){if(!this.workers)for(this.workers=[];this.workers.length<Ur.workerCount;)this.workers.push(new jr);return this.active[_]=!0,this.workers.slice()},Ur.prototype.release=function(_){delete this.active[_],this.numActive()===0&&(this.workers.forEach(function(S){S.terminate()}),this.workers=null)},Ur.prototype.isPreloaded=function(){return!!this.active[vr]},Ur.prototype.numActive=function(){return Object.keys(this.active).length};var Fr,qr=Math.floor(E.browser.hardwareConcurrency/2);function wr(){return Fr||(Fr=new Ur),Fr}function fi(_,S){var x={};for(var C in _)C!=="ref"&&(x[C]=_[C]);return E.refProperties.forEach(function(k){k in S&&(x[k]=S[k])}),x}function di(_){_=_.slice();for(var S=Object.create(null),x=0;x<_.length;x++)S[_[x].id]=_[x];for(var C=0;C<_.length;C++)"ref"in _[C]&&(_[C]=fi(_[C],S[_[C].ref]));return _}Ur.workerCount=Math.max(Math.min(qr,6),1);var vi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function vo(_,S,x){x.push({command:vi.addSource,args:[_,S[_]]})}function Oi(_,S,x){S.push({command:vi.removeSource,args:[_]}),x[_]=!0}function Ko(_,S,x,C){Oi(_,x,C),vo(_,S,x)}function va(_,S,x){var C;for(C in _[x])if(_[x].hasOwnProperty(C)&&C!=="data"&&!E.deepEqual(_[x][C],S[x][C]))return!1;for(C in S[x])if(S[x].hasOwnProperty(C)&&C!=="data"&&!E.deepEqual(_[x][C],S[x][C]))return!1;return!0}function Co(_,S,x,C,k,G){var q;for(q in S=S||{},_=_||{})_.hasOwnProperty(q)&&(E.deepEqual(_[q],S[q])||x.push({command:G,args:[C,q,S[q],k]}));for(q in S)S.hasOwnProperty(q)&&!_.hasOwnProperty(q)&&(E.deepEqual(_[q],S[q])||x.push({command:G,args:[C,q,S[q],k]}))}function Xo(_){return _.id}function Ye(_,S){return _[S.id]=S,_}var Ke=function(_,S){this.reset(_,S)};Ke.prototype.reset=function(_,S){this.points=_||[],this._distances=[0];for(var x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(S||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ke.prototype.lerp=function(_){if(this.points.length===1)return this.points[0];_=E.clamp(_,0,1);for(var S=1,x=this._distances[S],C=_*this.paddedLength+this.padding;x<C&&S<this._distances.length;)x=this._distances[++S];var k=S-1,G=this._distances[k],q=x-G,he=q>0?(C-G)/q:0;return this.points[k].mult(1-he).add(this.points[S].mult(he))};var Ct=function(_,S,x){var C=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(_/x),this.yCellCount=Math.ceil(S/x);for(var G=0;G<this.xCellCount*this.yCellCount;G++)C.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=_,this.height=S,this.xScale=this.xCellCount/_,this.yScale=this.yCellCount/S,this.boxUid=0,this.circleUid=0};function sn(_,S,x,C,k){var G=E.create();return S?(E.scale(G,G,[1/k,1/k,1]),x||E.rotateZ(G,G,C.angle)):E.multiply(G,C.labelPlaneMatrix,_),G}function Ln(_,S,x,C,k){if(S){var G=E.clone(_);return E.scale(G,G,[k,k,1]),x||E.rotateZ(G,G,-C.angle),G}return C.glCoordMatrix}function zn(_,S){var x=[_.x,_.y,0,1];Zr(x,x,S);var C=x[3];return{point:new E.Point(x[0]/C,x[1]/C),signedDistanceFromCamera:C}}function mn(_,S){return .5+_/S*.5}function wn(_,S){var x=_[0]/_[3],C=_[1]/_[3];return x>=-S[0]&&x<=S[0]&&C>=-S[1]&&C<=S[1]}function gr(_,S,x,C,k,G,q,he){var je=C?_.textSizeData:_.iconSizeData,Xe=E.evaluateSizeForZoom(je,x.transform.zoom),kt=[256/x.width*2+1,256/x.height*2+1],jt=C?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;jt.clear();for(var Yt=_.lineVertexArray,gn=C?_.text.placedSymbolArray:_.icon.placedSymbolArray,pn=x.transform.width/x.transform.height,Cn=!1,un=0;un<gn.length;un++){var kn=gn.get(un);if(kn.hidden||kn.writingMode===E.WritingMode.vertical&&!Cn)Li(kn.numGlyphs,jt);else{Cn=!1;var er=[kn.anchorX,kn.anchorY,0,1];if(E.transformMat4(er,er,S),wn(er,kt)){var ur=mn(x.transform.cameraToCenterDistance,er[3]),Cr=E.evaluateSizeForFeature(je,Xe,kn),dr=q?Cr/ur:Cr*ur,Br=new E.Point(kn.anchorX,kn.anchorY),ri=zn(Br,k).point,Yr={},wi=Vi(kn,dr,!1,he,S,k,G,_.glyphOffsetArray,Yt,jt,ri,Br,Yr,pn);Cn=wi.useVertical,(wi.notEnoughRoom||Cn||wi.needsFlipping&&Vi(kn,dr,!0,he,S,k,G,_.glyphOffsetArray,Yt,jt,ri,Br,Yr,pn).notEnoughRoom)&&Li(kn.numGlyphs,jt)}else Li(kn.numGlyphs,jt)}}C?_.text.dynamicLayoutVertexBuffer.updateData(jt):_.icon.dynamicLayoutVertexBuffer.updateData(jt)}function mr(_,S,x,C,k,G,q,he,je,Xe,kt){var jt=he.glyphStartIndex+he.numGlyphs,Yt=he.lineStartIndex,gn=he.lineStartIndex+he.lineLength,pn=S.getoffsetX(he.glyphStartIndex),Cn=S.getoffsetX(jt-1),un=ei(_*pn,x,C,k,G,q,he.segment,Yt,gn,je,Xe,kt);if(!un)return null;var kn=ei(_*Cn,x,C,k,G,q,he.segment,Yt,gn,je,Xe,kt);return kn?{first:un,last:kn}:null}function ai(_,S,x,C){return _===E.WritingMode.horizontal&&Math.abs(x.y-S.y)>Math.abs(x.x-S.x)*C?{useVertical:!0}:(_===E.WritingMode.vertical?S.y<x.y:S.x>x.x)?{needsFlipping:!0}:null}function Vi(_,S,x,C,k,G,q,he,je,Xe,kt,jt,Yt,gn){var pn,Cn=S/24,un=_.lineOffsetX*Cn,kn=_.lineOffsetY*Cn;if(_.numGlyphs>1){var er=_.glyphStartIndex+_.numGlyphs,ur=_.lineStartIndex,Cr=_.lineStartIndex+_.lineLength,dr=mr(Cn,he,un,kn,x,kt,jt,_,je,G,Yt);if(!dr)return{notEnoughRoom:!0};var Br=zn(dr.first.point,q).point,ri=zn(dr.last.point,q).point;if(C&&!x){var Yr=ai(_.writingMode,Br,ri,gn);if(Yr)return Yr}pn=[dr.first];for(var wi=_.glyphStartIndex+1;wi<er-1;wi++)pn.push(ei(Cn*he.getoffsetX(wi),un,kn,x,kt,jt,_.segment,ur,Cr,je,G,Yt));pn.push(dr.last)}else{if(C&&!x){var Hi=zn(jt,k).point,Lo=_.lineStartIndex+_.segment+1,Fo=new E.Point(je.getx(Lo),je.gety(Lo)),ko=zn(Fo,k),fa=ko.signedDistanceFromCamera>0?ko.point:fo(jt,Fo,Hi,1,k),Bn=ai(_.writingMode,Hi,fa,gn);if(Bn)return Bn}var qt=ei(Cn*he.getoffsetX(_.glyphStartIndex),un,kn,x,kt,jt,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,je,G,Yt);if(!qt)return{notEnoughRoom:!0};pn=[qt]}for(var ua=0,ra=pn;ua<ra.length;ua+=1){var Ho=ra[ua];E.addDynamicAttributes(Xe,Ho.point,Ho.angle)}return{}}function fo(_,S,x,C,k){var G=zn(_.add(_.sub(S)._unit()),k).point,q=x.sub(G);return x.add(q._mult(C/q.mag()))}function ei(_,S,x,C,k,G,q,he,je,Xe,kt,jt){var Yt=C?_-S:_+S,gn=Yt>0?1:-1,pn=0;C&&(gn*=-1,pn=Math.PI),gn<0&&(pn+=Math.PI);for(var Cn=gn>0?he+q:he+q+1,un=k,kn=k,er=0,ur=0,Cr=Math.abs(Yt),dr=[];er+ur<=Cr;){if((Cn+=gn)<he||Cn>=je)return null;if(kn=un,dr.push(un),(un=jt[Cn])===void 0){var Br=new E.Point(Xe.getx(Cn),Xe.gety(Cn)),ri=zn(Br,kt);if(ri.signedDistanceFromCamera>0)un=jt[Cn]=ri.point;else{var Yr=Cn-gn;un=fo(er===0?G:new E.Point(Xe.getx(Yr),Xe.gety(Yr)),Br,kn,Cr-er+1,kt)}}er+=ur,ur=kn.dist(un)}var wi=(Cr-er)/ur,Hi=un.sub(kn),Lo=Hi.mult(wi)._add(kn);Lo._add(Hi._unit()._perp()._mult(x*gn));var Fo=pn+Math.atan2(un.y-kn.y,un.x-kn.x);return dr.push(Lo),{point:Lo,angle:Fo,path:dr}}Ct.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ct.prototype.insert=function(_,S,x,C,k){this._forEachCell(S,x,C,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(_),this.bboxes.push(S),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(k)},Ct.prototype.insertCircle=function(_,S,x,C){this._forEachCell(S-C,x-C,S+C,x+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(_),this.circles.push(S),this.circles.push(x),this.circles.push(C)},Ct.prototype._insertBoxCell=function(_,S,x,C,k,G){this.boxCells[k].push(G)},Ct.prototype._insertCircleCell=function(_,S,x,C,k,G){this.circleCells[k].push(G)},Ct.prototype._query=function(_,S,x,C,k,G){if(x<0||_>this.width||C<0||S>this.height)return!k&&[];var q=[];if(_<=0&&S<=0&&this.width<=x&&this.height<=C){if(k)return!0;for(var he=0;he<this.boxKeys.length;he++)q.push({key:this.boxKeys[he],x1:this.bboxes[4*he],y1:this.bboxes[4*he+1],x2:this.bboxes[4*he+2],y2:this.bboxes[4*he+3]});for(var je=0;je<this.circleKeys.length;je++){var Xe=this.circles[3*je],kt=this.circles[3*je+1],jt=this.circles[3*je+2];q.push({key:this.circleKeys[je],x1:Xe-jt,y1:kt-jt,x2:Xe+jt,y2:kt+jt})}return G?q.filter(G):q}return this._forEachCell(_,S,x,C,this._queryCell,q,{hitTest:k,seenUids:{box:{},circle:{}}},G),k?q.length>0:q},Ct.prototype._queryCircle=function(_,S,x,C,k){var G=_-x,q=_+x,he=S-x,je=S+x;if(q<0||G>this.width||je<0||he>this.height)return!C&&[];var Xe=[];return this._forEachCell(G,he,q,je,this._queryCellCircle,Xe,{hitTest:C,circle:{x:_,y:S,radius:x},seenUids:{box:{},circle:{}}},k),C?Xe.length>0:Xe},Ct.prototype.query=function(_,S,x,C,k){return this._query(_,S,x,C,!1,k)},Ct.prototype.hitTest=function(_,S,x,C,k){return this._query(_,S,x,C,!0,k)},Ct.prototype.hitTestCircle=function(_,S,x,C){return this._queryCircle(_,S,x,!0,C)},Ct.prototype._queryCell=function(_,S,x,C,k,G,q,he){var je=q.seenUids,Xe=this.boxCells[k];if(Xe!==null)for(var kt=this.bboxes,jt=0,Yt=Xe;jt<Yt.length;jt+=1){var gn=Yt[jt];if(!je.box[gn]){je.box[gn]=!0;var pn=4*gn;if(_<=kt[pn+2]&&S<=kt[pn+3]&&x>=kt[pn+0]&&C>=kt[pn+1]&&(!he||he(this.boxKeys[gn]))){if(q.hitTest)return G.push(!0),!0;G.push({key:this.boxKeys[gn],x1:kt[pn],y1:kt[pn+1],x2:kt[pn+2],y2:kt[pn+3]})}}}var Cn=this.circleCells[k];if(Cn!==null)for(var un=this.circles,kn=0,er=Cn;kn<er.length;kn+=1){var ur=er[kn];if(!je.circle[ur]){je.circle[ur]=!0;var Cr=3*ur;if(this._circleAndRectCollide(un[Cr],un[Cr+1],un[Cr+2],_,S,x,C)&&(!he||he(this.circleKeys[ur]))){if(q.hitTest)return G.push(!0),!0;var dr=un[Cr],Br=un[Cr+1],ri=un[Cr+2];G.push({key:this.circleKeys[ur],x1:dr-ri,y1:Br-ri,x2:dr+ri,y2:Br+ri})}}}},Ct.prototype._queryCellCircle=function(_,S,x,C,k,G,q,he){var je=q.circle,Xe=q.seenUids,kt=this.boxCells[k];if(kt!==null)for(var jt=this.bboxes,Yt=0,gn=kt;Yt<gn.length;Yt+=1){var pn=gn[Yt];if(!Xe.box[pn]){Xe.box[pn]=!0;var Cn=4*pn;if(this._circleAndRectCollide(je.x,je.y,je.radius,jt[Cn+0],jt[Cn+1],jt[Cn+2],jt[Cn+3])&&(!he||he(this.boxKeys[pn])))return G.push(!0),!0}}var un=this.circleCells[k];if(un!==null)for(var kn=this.circles,er=0,ur=un;er<ur.length;er+=1){var Cr=ur[er];if(!Xe.circle[Cr]){Xe.circle[Cr]=!0;var dr=3*Cr;if(this._circlesCollide(kn[dr],kn[dr+1],kn[dr+2],je.x,je.y,je.radius)&&(!he||he(this.circleKeys[Cr])))return G.push(!0),!0}}},Ct.prototype._forEachCell=function(_,S,x,C,k,G,q,he){for(var je=this._convertToXCellCoord(_),Xe=this._convertToYCellCoord(S),kt=this._convertToXCellCoord(x),jt=this._convertToYCellCoord(C),Yt=je;Yt<=kt;Yt++)for(var gn=Xe;gn<=jt;gn++)if(k.call(this,_,S,x,C,this.xCellCount*gn+Yt,G,q,he))return},Ct.prototype._convertToXCellCoord=function(_){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(_*this.xScale)))},Ct.prototype._convertToYCellCoord=function(_){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(_*this.yScale)))},Ct.prototype._circlesCollide=function(_,S,x,C,k,G){var q=C-_,he=k-S,je=x+G;return je*je>q*q+he*he},Ct.prototype._circleAndRectCollide=function(_,S,x,C,k,G,q){var he=(G-C)/2,je=Math.abs(_-(C+he));if(je>he+x)return!1;var Xe=(q-k)/2,kt=Math.abs(S-(k+Xe));if(kt>Xe+x)return!1;if(je<=he||kt<=Xe)return!0;var jt=je-he,Yt=kt-Xe;return jt*jt+Yt*Yt<=x*x};var zi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Li(_,S){for(var x=0;x<_;x++){var C=S.length;S.resize(C+4),S.float32.set(zi,3*C)}}function Zr(_,S,x){var C=S[0],k=S[1];return _[0]=x[0]*C+x[4]*k+x[12],_[1]=x[1]*C+x[5]*k+x[13],_[3]=x[3]*C+x[7]*k+x[15],_}var go=function(_,S,x){S===void 0&&(S=new Ct(_.width+200,_.height+200,25)),x===void 0&&(x=new Ct(_.width+200,_.height+200,25)),this.transform=_,this.grid=S,this.ignoredGrid=x,this.pitchfactor=Math.cos(_._pitch)*_.cameraToCenterDistance,this.screenRightBoundary=_.width+100,this.screenBottomBoundary=_.height+100,this.gridRightBoundary=_.width+200,this.gridBottomBoundary=_.height+200};function Mi(_,S,x){return S*(E.EXTENT/(_.tileSize*Math.pow(2,x-_.tileID.overscaledZ)))}go.prototype.placeCollisionBox=function(_,S,x,C,k){var G=this.projectAndGetPerspectiveRatio(C,_.anchorPointX,_.anchorPointY),q=x*G.perspectiveRatio,he=_.x1*q+G.point.x,je=_.y1*q+G.point.y,Xe=_.x2*q+G.point.x,kt=_.y2*q+G.point.y;return!this.isInsideGrid(he,je,Xe,kt)||!S&&this.grid.hitTest(he,je,Xe,kt,k)?{box:[],offscreen:!1}:{box:[he,je,Xe,kt],offscreen:this.isOffscreen(he,je,Xe,kt)}},go.prototype.placeCollisionCircles=function(_,S,x,C,k,G,q,he,je,Xe,kt,jt,Yt){var gn=[],pn=new E.Point(S.anchorX,S.anchorY),Cn=zn(pn,G),un=mn(this.transform.cameraToCenterDistance,Cn.signedDistanceFromCamera),kn=(Xe?k/un:k*un)/E.ONE_EM,er=zn(pn,q).point,ur=mr(kn,C,S.lineOffsetX*kn,S.lineOffsetY*kn,!1,er,pn,S,x,q,{}),Cr=!1,dr=!1,Br=!0;if(ur){for(var ri=.5*jt*un+Yt,Yr=new E.Point(-100,-100),wi=new E.Point(this.screenRightBoundary,this.screenBottomBoundary),Hi=new Ke,Lo=ur.first,Fo=ur.last,ko=[],fa=Lo.path.length-1;fa>=1;fa--)ko.push(Lo.path[fa]);for(var Bn=1;Bn<Fo.path.length;Bn++)ko.push(Fo.path[Bn]);var qt=2.5*ri;if(he){var ua=ko.map(function(Vu){return zn(Vu,he)});ko=ua.some(function(Vu){return Vu.signedDistanceFromCamera<=0})?[]:ua.map(function(Vu){return Vu.point})}var ra=[];if(ko.length>0){for(var Ho=ko[0].clone(),_a=ko[0].clone(),Vo=1;Vo<ko.length;Vo++)Ho.x=Math.min(Ho.x,ko[Vo].x),Ho.y=Math.min(Ho.y,ko[Vo].y),_a.x=Math.max(_a.x,ko[Vo].x),_a.y=Math.max(_a.y,ko[Vo].y);ra=Ho.x>=Yr.x&&_a.x<=wi.x&&Ho.y>=Yr.y&&_a.y<=wi.y?[ko]:_a.x<Yr.x||Ho.x>wi.x||_a.y<Yr.y||Ho.y>wi.y?[]:E.clipLine([ko],Yr.x,Yr.y,wi.x,wi.y)}for(var Do=0,hc=ra;Do<hc.length;Do+=1){var vl;Hi.reset(hc[Do],.25*ri),vl=Hi.length<=.5*ri?1:Math.ceil(Hi.paddedLength/qt)+1;for(var Fc=0;Fc<vl;Fc++){var Gl=Fc/Math.max(vl-1,1),bs=Hi.lerp(Gl),Qs=bs.x+100,ll=bs.y+100;gn.push(Qs,ll,ri,0);var gl=Qs-ri,_f=ll-ri,al=Qs+ri,sf=ll+ri;if(Br=Br&&this.isOffscreen(gl,_f,al,sf),dr=dr||this.isInsideGrid(gl,_f,al,sf),!_&&this.grid.hitTestCircle(Qs,ll,ri,kt)&&(Cr=!0,!je))return{circles:[],offscreen:!1,collisionDetected:Cr}}}}return{circles:!je&&Cr||!dr?[]:gn,offscreen:Br,collisionDetected:Cr}},go.prototype.queryRenderedSymbols=function(_){if(_.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var S=[],x=1/0,C=1/0,k=-1/0,G=-1/0,q=0,he=_;q<he.length;q+=1){var je=he[q],Xe=new E.Point(je.x+100,je.y+100);x=Math.min(x,Xe.x),C=Math.min(C,Xe.y),k=Math.max(k,Xe.x),G=Math.max(G,Xe.y),S.push(Xe)}for(var kt={},jt={},Yt=0,gn=this.grid.query(x,C,k,G).concat(this.ignoredGrid.query(x,C,k,G));Yt<gn.length;Yt+=1){var pn=gn[Yt],Cn=pn.key;if(kt[Cn.bucketInstanceId]===void 0&&(kt[Cn.bucketInstanceId]={}),!kt[Cn.bucketInstanceId][Cn.featureIndex]){var un=[new E.Point(pn.x1,pn.y1),new E.Point(pn.x2,pn.y1),new E.Point(pn.x2,pn.y2),new E.Point(pn.x1,pn.y2)];E.polygonIntersectsPolygon(S,un)&&(kt[Cn.bucketInstanceId][Cn.featureIndex]=!0,jt[Cn.bucketInstanceId]===void 0&&(jt[Cn.bucketInstanceId]=[]),jt[Cn.bucketInstanceId].push(Cn.featureIndex))}}return jt},go.prototype.insertCollisionBox=function(_,S,x,C,k){(S?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:C,collisionGroupID:k},_[0],_[1],_[2],_[3])},go.prototype.insertCollisionCircles=function(_,S,x,C,k){for(var G=S?this.ignoredGrid:this.grid,q={bucketInstanceId:x,featureIndex:C,collisionGroupID:k},he=0;he<_.length;he+=4)G.insertCircle(q,_[he],_[he+1],_[he+2])},go.prototype.projectAndGetPerspectiveRatio=function(_,S,x){var C=[S,x,0,1];return Zr(C,C,_),{point:new E.Point((C[0]/C[3]+1)/2*this.transform.width+100,(-C[1]/C[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/C[3]*.5}},go.prototype.isOffscreen=function(_,S,x,C){return x<100||_>=this.screenRightBoundary||C<100||S>this.screenBottomBoundary},go.prototype.isInsideGrid=function(_,S,x,C){return x>=0&&_<this.gridRightBoundary&&C>=0&&S<this.gridBottomBoundary},go.prototype.getViewportMatrix=function(){var _=E.identity([]);return E.translate(_,_,[-100,-100,0]),_};var bo=function(_,S,x,C){this.opacity=_?Math.max(0,Math.min(1,_.opacity+(_.placed?S:-S))):C&&x?1:0,this.placed=x};bo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Si=function(_,S,x,C,k){this.text=new bo(_?_.text:null,S,x,k),this.icon=new bo(_?_.icon:null,S,C,k)};Si.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var wo=function(_,S,x){this.text=_,this.icon=S,this.skipFade=x},Yo=function(){this.invProjMatrix=E.create(),this.viewportMatrix=E.create(),this.circles=[]},Wa=function(_,S,x,C,k){this.bucketInstanceId=_,this.featureIndex=S,this.sourceLayerIndex=x,this.bucketIndex=C,this.tileID=k},na=function(_){this.crossSourceCollisions=_,this.maxGroupID=0,this.collisionGroups={}};function jo(_,S,x,C,k){var G=E.getAnchorAlignment(_),q=-(G.horizontalAlign-.5)*S,he=-(G.verticalAlign-.5)*x,je=E.evaluateVariableOffset(_,C);return new E.Point(q+je[0]*k,he+je[1]*k)}function Va(_,S,x,C,k,G){var q=_.x1,he=_.x2,je=_.y1,Xe=_.y2,kt=_.anchorPointX,jt=_.anchorPointY,Yt=new E.Point(S,x);return C&&Yt._rotate(k?G:-G),{x1:q+Yt.x,y1:je+Yt.y,x2:he+Yt.x,y2:Xe+Yt.y,anchorPointX:kt,anchorPointY:jt}}na.prototype.get=function(_){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[_]){var S=++this.maxGroupID;this.collisionGroups[_]={ID:S,predicate:function(x){return x.collisionGroupID===S}}}return this.collisionGroups[_]};var fs=function(_,S,x,C){this.transform=_.clone(),this.collisionIndex=new go(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=S,this.retainedQueryData={},this.collisionGroups=new na(x),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}};function Tt(_,S,x,C,k){_.emplaceBack(S?1:0,x?1:0,C||0,k||0),_.emplaceBack(S?1:0,x?1:0,C||0,k||0),_.emplaceBack(S?1:0,x?1:0,C||0,k||0),_.emplaceBack(S?1:0,x?1:0,C||0,k||0)}fs.prototype.getBucketParts=function(_,S,x,C){var k=x.getBucket(S),G=x.latestFeatureIndex;if(k&&G&&S.id===k.layerIds[0]){var q=x.collisionBoxArray,he=k.layers[0].layout,je=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),Xe=x.tileSize/E.EXTENT,kt=this.transform.calculatePosMatrix(x.tileID.toUnwrapped()),jt=he.get("text-pitch-alignment")==="map",Yt=he.get("text-rotation-alignment")==="map",gn=Mi(x,1,this.transform.zoom),pn=sn(kt,jt,Yt,this.transform,gn),Cn=null;if(jt){var un=Ln(kt,jt,Yt,this.transform,gn);Cn=E.multiply([],this.transform.labelPlaneMatrix,un)}this.retainedQueryData[k.bucketInstanceId]=new Wa(k.bucketInstanceId,G,k.sourceLayerIndex,k.index,x.tileID);var kn={bucket:k,layout:he,posMatrix:kt,textLabelPlaneMatrix:pn,labelToScreenMatrix:Cn,scale:je,textPixelRatio:Xe,holdingForFade:x.holdingForFade(),collisionBoxArray:q,partiallyEvaluatedTextSize:E.evaluateSizeForZoom(k.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(C)for(var er=0,ur=k.sortKeyRanges;er<ur.length;er+=1){var Cr=ur[er];_.push({sortKey:Cr.sortKey,symbolInstanceStart:Cr.symbolInstanceStart,symbolInstanceEnd:Cr.symbolInstanceEnd,parameters:kn})}else _.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:kn})}},fs.prototype.attemptAnchorPlacement=function(_,S,x,C,k,G,q,he,je,Xe,kt,jt,Yt,gn,pn){var Cn,un=[jt.textOffset0,jt.textOffset1],kn=jo(_,x,C,un,k),er=this.collisionIndex.placeCollisionBox(Va(S,kn.x,kn.y,G,q,this.transform.angle),kt,he,je,Xe.predicate);if(!pn||this.collisionIndex.placeCollisionBox(Va(pn,kn.x,kn.y,G,q,this.transform.angle),kt,he,je,Xe.predicate).box.length!==0)return er.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[jt.crossTileID]&&this.prevPlacement.placements[jt.crossTileID]&&this.prevPlacement.placements[jt.crossTileID].text&&(Cn=this.prevPlacement.variableOffsets[jt.crossTileID].anchor),this.variableOffsets[jt.crossTileID]={textOffset:un,width:x,height:C,anchor:_,textBoxScale:k,prevAnchor:Cn},this.markUsedJustification(Yt,_,jt,gn),Yt.allowVerticalPlacement&&(this.markUsedOrientation(Yt,gn,jt),this.placedOrientations[jt.crossTileID]=gn),{shift:kn,placedGlyphBoxes:er}):void 0},fs.prototype.placeLayerBucketPart=function(_,S,x){var C=this,k=_.parameters,G=k.bucket,q=k.layout,he=k.posMatrix,je=k.textLabelPlaneMatrix,Xe=k.labelToScreenMatrix,kt=k.textPixelRatio,jt=k.holdingForFade,Yt=k.collisionBoxArray,gn=k.partiallyEvaluatedTextSize,pn=k.collisionGroup,Cn=q.get("text-optional"),un=q.get("icon-optional"),kn=q.get("text-allow-overlap"),er=q.get("icon-allow-overlap"),ur=q.get("text-rotation-alignment")==="map",Cr=q.get("text-pitch-alignment")==="map",dr=q.get("icon-text-fit")!=="none",Br=q.get("symbol-z-order")==="viewport-y",ri=kn&&(er||!G.hasIconData()||un),Yr=er&&(kn||!G.hasTextData()||Cn);!G.collisionArrays&&Yt&&G.deserializeCollisionBoxes(Yt);var wi=function(Bn,qt){if(!S[Bn.crossTileID])if(jt)C.placements[Bn.crossTileID]=new wo(!1,!1,!1);else{var ua,ra=!1,Ho=!1,_a=!0,Vo=null,Do={box:null,offscreen:null},hc={box:null,offscreen:null},vl=null,Fc=null,Gl=0,bs=0,Qs=0;qt.textFeatureIndex?Gl=qt.textFeatureIndex:Bn.useRuntimeCollisionCircles&&(Gl=Bn.featureIndex),qt.verticalTextFeatureIndex&&(bs=qt.verticalTextFeatureIndex);var ll=qt.textBox;if(ll){var gl=function(No){var kl=E.WritingMode.horizontal;if(G.allowVerticalPlacement&&!No&&C.prevPlacement){var Xl=C.prevPlacement.placedOrientations[Bn.crossTileID];Xl&&(C.placedOrientations[Bn.crossTileID]=Xl,C.markUsedOrientation(G,kl=Xl,Bn))}return kl},_f=function(No,kl){if(G.allowVerticalPlacement&&Bn.numVerticalGlyphVertices>0&&qt.verticalTextBox)for(var Xl=0,xf=G.writingModes;Xl<xf.length&&(xf[Xl]===E.WritingMode.vertical?(Do=kl(),hc=Do):Do=No(),!(Do&&Do.box&&Do.box.length));Xl+=1);else Do=No()};if(q.get("text-variable-anchor")){var al=q.get("text-variable-anchor");if(C.prevPlacement&&C.prevPlacement.variableOffsets[Bn.crossTileID]){var sf=C.prevPlacement.variableOffsets[Bn.crossTileID];al.indexOf(sf.anchor)>0&&(al=al.filter(function(No){return No!==sf.anchor})).unshift(sf.anchor)}var Vu=function(No,kl,Xl){for(var xf=No.x2-No.x1,Zd=No.y2-No.y1,lf=Bn.textBoxScale,Ep=dr&&!er?kl:null,Ad={box:[],offscreen:!1},Ls=kn?2*al.length:al.length,cf=0;cf<Ls;++cf){var lh=C.attemptAnchorPlacement(al[cf%al.length],No,xf,Zd,lf,ur,Cr,kt,he,pn,cf>=al.length,Bn,G,Xl,Ep);if(lh&&(Ad=lh.placedGlyphBoxes)&&Ad.box&&Ad.box.length){ra=!0,Vo=lh.shift;break}}return Ad};_f(function(){return Vu(ll,qt.iconBox,E.WritingMode.horizontal)},function(){var No=qt.verticalTextBox;return G.allowVerticalPlacement&&!(Do&&Do.box&&Do.box.length)&&Bn.numVerticalGlyphVertices>0&&No?Vu(No,qt.verticalIconBox,E.WritingMode.vertical):{box:null,offscreen:null}}),Do&&(ra=Do.box,_a=Do.offscreen);var Vd=gl(Do&&Do.box);if(!ra&&C.prevPlacement){var kf=C.prevPlacement.variableOffsets[Bn.crossTileID];kf&&(C.variableOffsets[Bn.crossTileID]=kf,C.markUsedJustification(G,kf.anchor,Bn,Vd))}}else{var Sh=function(No,kl){var Xl=C.collisionIndex.placeCollisionBox(No,kn,kt,he,pn.predicate);return Xl&&Xl.box&&Xl.box.length&&(C.markUsedOrientation(G,kl,Bn),C.placedOrientations[Bn.crossTileID]=kl),Xl};_f(function(){return Sh(ll,E.WritingMode.horizontal)},function(){var No=qt.verticalTextBox;return G.allowVerticalPlacement&&Bn.numVerticalGlyphVertices>0&&No?Sh(No,E.WritingMode.vertical):{box:null,offscreen:null}}),gl(Do&&Do.box&&Do.box.length)}}if(ra=(ua=Do)&&ua.box&&ua.box.length>0,_a=ua&&ua.offscreen,Bn.useRuntimeCollisionCircles){var Hd=G.text.placedSymbolArray.get(Bn.centerJustifiedTextSymbolIndex),$h=E.evaluateSizeForFeature(G.textSizeData,gn,Hd),bf=q.get("text-padding");vl=C.collisionIndex.placeCollisionCircles(kn,Hd,G.lineVertexArray,G.glyphOffsetArray,$h,he,je,Xe,x,Cr,pn.predicate,Bn.collisionCircleDiameter,bf),ra=kn||vl.circles.length>0&&!vl.collisionDetected,_a=_a&&vl.offscreen}if(qt.iconFeatureIndex&&(Qs=qt.iconFeatureIndex),qt.iconBox){var Ai=function(No){var kl=dr&&Vo?Va(No,Vo.x,Vo.y,ur,Cr,C.transform.angle):No;return C.collisionIndex.placeCollisionBox(kl,er,kt,he,pn.predicate)};Ho=hc&&hc.box&&hc.box.length&&qt.verticalIconBox?(Fc=Ai(qt.verticalIconBox)).box.length>0:(Fc=Ai(qt.iconBox)).box.length>0,_a=_a&&Fc.offscreen}var hl=Cn||Bn.numHorizontalGlyphVertices===0&&Bn.numVerticalGlyphVertices===0,ba=un||Bn.numIconVertices===0;if(hl||ba?ba?hl||(Ho=Ho&&ra):ra=Ho&&ra:Ho=ra=Ho&&ra,ra&&ua&&ua.box&&C.collisionIndex.insertCollisionBox(ua.box,q.get("text-ignore-placement"),G.bucketInstanceId,hc&&hc.box&&bs?bs:Gl,pn.ID),Ho&&Fc&&C.collisionIndex.insertCollisionBox(Fc.box,q.get("icon-ignore-placement"),G.bucketInstanceId,Qs,pn.ID),vl&&(ra&&C.collisionIndex.insertCollisionCircles(vl.circles,q.get("text-ignore-placement"),G.bucketInstanceId,Gl,pn.ID),x)){var xs=G.bucketInstanceId,Fl=C.collisionCircleArrays[xs];Fl===void 0&&(Fl=C.collisionCircleArrays[xs]=new Yo);for(var Hu=0;Hu<vl.circles.length;Hu+=4)Fl.circles.push(vl.circles[Hu+0]),Fl.circles.push(vl.circles[Hu+1]),Fl.circles.push(vl.circles[Hu+2]),Fl.circles.push(vl.collisionDetected?1:0)}C.placements[Bn.crossTileID]=new wo(ra||ri,Ho||Yr,_a||G.justReloaded),S[Bn.crossTileID]=!0}};if(Br)for(var Hi=G.getSortedSymbolIndexes(this.transform.angle),Lo=Hi.length-1;Lo>=0;--Lo){var Fo=Hi[Lo];wi(G.symbolInstances.get(Fo),G.collisionArrays[Fo])}else for(var ko=_.symbolInstanceStart;ko<_.symbolInstanceEnd;ko++)wi(G.symbolInstances.get(ko),G.collisionArrays[ko]);if(x&&G.bucketInstanceId in this.collisionCircleArrays){var fa=this.collisionCircleArrays[G.bucketInstanceId];E.invert(fa.invProjMatrix,he),fa.viewportMatrix=this.collisionIndex.getViewportMatrix()}G.justReloaded=!1},fs.prototype.markUsedJustification=function(_,S,x,C){var k;k=C===E.WritingMode.vertical?x.verticalPlacedTextSymbolIndex:{left:x.leftJustifiedTextSymbolIndex,center:x.centerJustifiedTextSymbolIndex,right:x.rightJustifiedTextSymbolIndex}[E.getAnchorJustification(S)];for(var G=0,q=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex,x.verticalPlacedTextSymbolIndex];G<q.length;G+=1){var he=q[G];he>=0&&(_.text.placedSymbolArray.get(he).crossTileID=k>=0&&he!==k?0:x.crossTileID)}},fs.prototype.markUsedOrientation=function(_,S,x){for(var C=S===E.WritingMode.horizontal||S===E.WritingMode.horizontalOnly?S:0,k=S===E.WritingMode.vertical?S:0,G=0,q=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex];G<q.length;G+=1)_.text.placedSymbolArray.get(q[G]).placedOrientation=C;x.verticalPlacedTextSymbolIndex&&(_.text.placedSymbolArray.get(x.verticalPlacedTextSymbolIndex).placedOrientation=k)},fs.prototype.commit=function(_){this.commitTime=_,this.zoomAtLastRecencyCheck=this.transform.zoom;var S=this.prevPlacement,x=!1;this.prevZoomAdjustment=S?S.zoomAdjustment(this.transform.zoom):0;var C=S?S.symbolFadeChange(_):1,k=S?S.opacities:{},G=S?S.variableOffsets:{},q=S?S.placedOrientations:{};for(var he in this.placements){var je=this.placements[he],Xe=k[he];Xe?(this.opacities[he]=new Si(Xe,C,je.text,je.icon),x=x||je.text!==Xe.text.placed||je.icon!==Xe.icon.placed):(this.opacities[he]=new Si(null,C,je.text,je.icon,je.skipFade),x=x||je.text||je.icon)}for(var kt in k){var jt=k[kt];if(!this.opacities[kt]){var Yt=new Si(jt,C,!1,!1);Yt.isHidden()||(this.opacities[kt]=Yt,x=x||jt.text.placed||jt.icon.placed)}}for(var gn in G)this.variableOffsets[gn]||!this.opacities[gn]||this.opacities[gn].isHidden()||(this.variableOffsets[gn]=G[gn]);for(var pn in q)this.placedOrientations[pn]||!this.opacities[pn]||this.opacities[pn].isHidden()||(this.placedOrientations[pn]=q[pn]);x?this.lastPlacementChangeTime=_:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=S?S.lastPlacementChangeTime:_)},fs.prototype.updateLayerOpacities=function(_,S){for(var x={},C=0,k=S;C<k.length;C+=1){var G=k[C],q=G.getBucket(_);q&&G.latestFeatureIndex&&_.id===q.layerIds[0]&&this.updateBucketOpacities(q,x,G.collisionBoxArray)}},fs.prototype.updateBucketOpacities=function(_,S,x){var C=this;_.hasTextData()&&_.text.opacityVertexArray.clear(),_.hasIconData()&&_.icon.opacityVertexArray.clear(),_.hasIconCollisionBoxData()&&_.iconCollisionBox.collisionVertexArray.clear(),_.hasTextCollisionBoxData()&&_.textCollisionBox.collisionVertexArray.clear();var k=_.layers[0].layout,G=new Si(null,0,!1,!1,!0),q=k.get("text-allow-overlap"),he=k.get("icon-allow-overlap"),je=k.get("text-variable-anchor"),Xe=k.get("text-rotation-alignment")==="map",kt=k.get("text-pitch-alignment")==="map",jt=k.get("icon-text-fit")!=="none",Yt=new Si(null,0,q&&(he||!_.hasIconData()||k.get("icon-optional")),he&&(q||!_.hasTextData()||k.get("text-optional")),!0);!_.collisionArrays&&x&&(_.hasIconCollisionBoxData()||_.hasTextCollisionBoxData())&&_.deserializeCollisionBoxes(x);for(var gn=function(kn,er,ur){for(var Cr=0;Cr<er/4;Cr++)kn.opacityVertexArray.emplaceBack(ur)},pn=function(kn){var er=_.symbolInstances.get(kn),ur=er.numHorizontalGlyphVertices,Cr=er.numVerticalGlyphVertices,dr=er.crossTileID,Br=C.opacities[dr];S[dr]?Br=G:Br||(C.opacities[dr]=Br=Yt),S[dr]=!0;var ri=er.numIconVertices>0,Yr=C.placedOrientations[er.crossTileID],wi=Yr===E.WritingMode.vertical,Hi=Yr===E.WritingMode.horizontal||Yr===E.WritingMode.horizontalOnly;if(ur>0||Cr>0){var Lo=Bs(Br.text);gn(_.text,ur,wi?Os:Lo),gn(_.text,Cr,Hi?Os:Lo);var Fo=Br.text.isHidden();[er.rightJustifiedTextSymbolIndex,er.centerJustifiedTextSymbolIndex,er.leftJustifiedTextSymbolIndex].forEach(function(Do){Do>=0&&(_.text.placedSymbolArray.get(Do).hidden=Fo||wi?1:0)}),er.verticalPlacedTextSymbolIndex>=0&&(_.text.placedSymbolArray.get(er.verticalPlacedTextSymbolIndex).hidden=Fo||Hi?1:0);var ko=C.variableOffsets[er.crossTileID];ko&&C.markUsedJustification(_,ko.anchor,er,Yr);var fa=C.placedOrientations[er.crossTileID];fa&&(C.markUsedJustification(_,"left",er,fa),C.markUsedOrientation(_,fa,er))}if(ri){var Bn=Bs(Br.icon),qt=!(jt&&er.verticalPlacedIconSymbolIndex&&wi);er.placedIconSymbolIndex>=0&&(gn(_.icon,er.numIconVertices,qt?Bn:Os),_.icon.placedSymbolArray.get(er.placedIconSymbolIndex).hidden=Br.icon.isHidden()),er.verticalPlacedIconSymbolIndex>=0&&(gn(_.icon,er.numVerticalIconVertices,qt?Os:Bn),_.icon.placedSymbolArray.get(er.verticalPlacedIconSymbolIndex).hidden=Br.icon.isHidden())}if(_.hasIconCollisionBoxData()||_.hasTextCollisionBoxData()){var ua=_.collisionArrays[kn];if(ua){var ra=new E.Point(0,0);if(ua.textBox||ua.verticalTextBox){var Ho=!0;if(je){var _a=C.variableOffsets[dr];_a?(ra=jo(_a.anchor,_a.width,_a.height,_a.textOffset,_a.textBoxScale),Xe&&ra._rotate(kt?C.transform.angle:-C.transform.angle)):Ho=!1}ua.textBox&&Tt(_.textCollisionBox.collisionVertexArray,Br.text.placed,!Ho||wi,ra.x,ra.y),ua.verticalTextBox&&Tt(_.textCollisionBox.collisionVertexArray,Br.text.placed,!Ho||Hi,ra.x,ra.y)}var Vo=!!(!Hi&&ua.verticalIconBox);ua.iconBox&&Tt(_.iconCollisionBox.collisionVertexArray,Br.icon.placed,Vo,jt?ra.x:0,jt?ra.y:0),ua.verticalIconBox&&Tt(_.iconCollisionBox.collisionVertexArray,Br.icon.placed,!Vo,jt?ra.x:0,jt?ra.y:0)}}},Cn=0;Cn<_.symbolInstances.length;Cn++)pn(Cn);if(_.sortFeatures(this.transform.angle),this.retainedQueryData[_.bucketInstanceId]&&(this.retainedQueryData[_.bucketInstanceId].featureSortOrder=_.featureSortOrder),_.hasTextData()&&_.text.opacityVertexBuffer&&_.text.opacityVertexBuffer.updateData(_.text.opacityVertexArray),_.hasIconData()&&_.icon.opacityVertexBuffer&&_.icon.opacityVertexBuffer.updateData(_.icon.opacityVertexArray),_.hasIconCollisionBoxData()&&_.iconCollisionBox.collisionVertexBuffer&&_.iconCollisionBox.collisionVertexBuffer.updateData(_.iconCollisionBox.collisionVertexArray),_.hasTextCollisionBoxData()&&_.textCollisionBox.collisionVertexBuffer&&_.textCollisionBox.collisionVertexBuffer.updateData(_.textCollisionBox.collisionVertexArray),_.bucketInstanceId in this.collisionCircleArrays){var un=this.collisionCircleArrays[_.bucketInstanceId];_.placementInvProjMatrix=un.invProjMatrix,_.placementViewportMatrix=un.viewportMatrix,_.collisionCircleArray=un.circles,delete this.collisionCircleArrays[_.bucketInstanceId]}},fs.prototype.symbolFadeChange=function(_){return this.fadeDuration===0?1:(_-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},fs.prototype.zoomAdjustment=function(_){return Math.max(0,(this.transform.zoom-_)/1.5)},fs.prototype.hasTransitions=function(_){return this.stale||_-this.lastPlacementChangeTime<this.fadeDuration},fs.prototype.stillRecent=function(_,S){var x=this.zoomAtLastRecencyCheck===S?1-this.zoomAdjustment(S):1;return this.zoomAtLastRecencyCheck=S,this.commitTime+this.fadeDuration*x>_},fs.prototype.setStale=function(){this.stale=!0};var Ft=Math.pow(2,25),Dn=Math.pow(2,24),sr=Math.pow(2,17),_i=Math.pow(2,16),bi=Math.pow(2,9),so=Math.pow(2,8),Ha=Math.pow(2,1);function Bs(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;var S=_.placed?1:0,x=Math.floor(127*_.opacity);return x*Ft+S*Dn+x*sr+S*_i+x*bi+S*so+x*Ha+S}var Os=0,il=function(_){this._sortAcrossTiles=_.layout.get("symbol-z-order")!=="viewport-y"&&_.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};il.prototype.continuePlacement=function(_,S,x,C,k){for(var G=this._bucketParts;this._currentTileIndex<_.length;)if(S.getBucketParts(G,C,_[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,G.sort(function(q,he){return q.sortKey-he.sortKey}));this._currentPartIndex<G.length;)if(S.placeLayerBucketPart(G[this._currentPartIndex],this._seenCrossTileIDs,x),this._currentPartIndex++,k())return!0;return!1};var Xf=function(_,S,x,C,k,G,q){this.placement=new fs(_,k,G,q),this._currentPlacementIndex=S.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=C,this._done=!1};Xf.prototype.isDone=function(){return this._done},Xf.prototype.continuePlacement=function(_,S,x){for(var C=this,k=E.browser.now(),G=function(){var je=E.browser.now()-k;return!C._forceFullPlacement&&je>2};this._currentPlacementIndex>=0;){var q=S[_[this._currentPlacementIndex]],he=this.placement.collisionIndex.transform.zoom;if(q.type==="symbol"&&(!q.minzoom||q.minzoom<=he)&&(!q.maxzoom||q.maxzoom>he)){if(this._inProgressLayer||(this._inProgressLayer=new il(q)),this._inProgressLayer.continuePlacement(x[q.source],this.placement,this._showCollisionBoxes,q,G))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Xf.prototype.commit=function(_){return this.placement.commit(_),this.placement};var zd=512/E.EXTENT/2,md=function(_,S,x){this.tileID=_,this.indexedSymbolInstances={},this.bucketInstanceId=x;for(var C=0;C<S.length;C++){var k=S.get(C),G=k.key;this.indexedSymbolInstances[G]||(this.indexedSymbolInstances[G]=[]),this.indexedSymbolInstances[G].push({crossTileID:k.crossTileID,coord:this.getScaledCoordinates(k,_)})}};md.prototype.getScaledCoordinates=function(_,S){var x=zd/Math.pow(2,S.canonical.z-this.tileID.canonical.z);return{x:Math.floor((S.canonical.x*E.EXTENT+_.anchorX)*x),y:Math.floor((S.canonical.y*E.EXTENT+_.anchorY)*x)}},md.prototype.findMatches=function(_,S,x){for(var C=this.tileID.canonical.z<S.canonical.z?1:Math.pow(2,this.tileID.canonical.z-S.canonical.z),k=0;k<_.length;k++){var G=_.get(k);if(!G.crossTileID){var q=this.indexedSymbolInstances[G.key];if(q)for(var he=this.getScaledCoordinates(G,S),je=0,Xe=q;je<Xe.length;je+=1){var kt=Xe[je];if(Math.abs(kt.coord.x-he.x)<=C&&Math.abs(kt.coord.y-he.y)<=C&&!x[kt.crossTileID]){x[kt.crossTileID]=!0,G.crossTileID=kt.crossTileID;break}}}}};var Dl=function(){this.maxCrossTileID=0};Dl.prototype.generate=function(){return++this.maxCrossTileID};var Qc=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Qc.prototype.handleWrapJump=function(_){var S=Math.round((_-this.lng)/360);if(S!==0)for(var x in this.indexes){var C=this.indexes[x],k={};for(var G in C){var q=C[G];q.tileID=q.tileID.unwrapTo(q.tileID.wrap+S),k[q.tileID.key]=q}this.indexes[x]=k}this.lng=_},Qc.prototype.addBucket=function(_,S,x){if(this.indexes[_.overscaledZ]&&this.indexes[_.overscaledZ][_.key]){if(this.indexes[_.overscaledZ][_.key].bucketInstanceId===S.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(_.overscaledZ,this.indexes[_.overscaledZ][_.key])}for(var C=0;C<S.symbolInstances.length;C++)S.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[_.overscaledZ]||(this.usedCrossTileIDs[_.overscaledZ]={});var k=this.usedCrossTileIDs[_.overscaledZ];for(var G in this.indexes){var q=this.indexes[G];if(Number(G)>_.overscaledZ)for(var he in q){var je=q[he];je.tileID.isChildOf(_)&&je.findMatches(S.symbolInstances,_,k)}else{var Xe=q[_.scaledTo(Number(G)).key];Xe&&Xe.findMatches(S.symbolInstances,_,k)}}for(var kt=0;kt<S.symbolInstances.length;kt++){var jt=S.symbolInstances.get(kt);jt.crossTileID||(jt.crossTileID=x.generate(),k[jt.crossTileID]=!0)}return this.indexes[_.overscaledZ]===void 0&&(this.indexes[_.overscaledZ]={}),this.indexes[_.overscaledZ][_.key]=new md(_,S.symbolInstances,S.bucketInstanceId),!0},Qc.prototype.removeBucketCrossTileIDs=function(_,S){for(var x in S.indexedSymbolInstances)for(var C=0,k=S.indexedSymbolInstances[x];C<k.length;C+=1)delete this.usedCrossTileIDs[_][k[C].crossTileID]},Qc.prototype.removeStaleBuckets=function(_){var S=!1;for(var x in this.indexes){var C=this.indexes[x];for(var k in C)_[C[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,C[k]),delete C[k],S=!0)}return S};var Mf=function(){this.layerIndexes={},this.crossTileIDs=new Dl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Mf.prototype.addLayer=function(_,S,x){var C=this.layerIndexes[_.id];C===void 0&&(C=this.layerIndexes[_.id]=new Qc);var k=!1,G={};C.handleWrapJump(x);for(var q=0,he=S;q<he.length;q+=1){var je=he[q],Xe=je.getBucket(_);Xe&&_.id===Xe.layerIds[0]&&(Xe.bucketInstanceId||(Xe.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(je.tileID,Xe,this.crossTileIDs)&&(k=!0),G[Xe.bucketInstanceId]=!0)}return C.removeStaleBuckets(G)&&(k=!0),k},Mf.prototype.pruneUnusedLayers=function(_){var S={};for(var x in _.forEach(function(C){S[C]=!0}),this.layerIndexes)S[x]||delete this.layerIndexes[x]};var Jc=function(_,S){return E.emitValidationErrors(_,S&&S.filter(function(x){return x.identifier!=="source.canvas"}))},Ic=E.pick(vi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),eu=E.pick(vi,["setCenter","setZoom","setBearing","setPitch"]),Yf=function(){var _={},S=E.styleSpec.$version;for(var x in E.styleSpec.$root){var C,k=E.styleSpec.$root[x];k.required&&(C=x==="version"?S:k.type==="array"?[]:{})!=null&&(_[x]=C)}return _}(),ac=function(_){function S(x,C){var k=this;C===void 0&&(C={}),_.call(this),this.map=x,this.dispatcher=new At(wr(),this),this.imageManager=new we,this.imageManager.setEventedParent(this),this.glyphManager=new gt(x._requestManager,C.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new Mf,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new E.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",E.getReferrer());var G=this;this._rtlTextPluginCallback=S.registerForPluginStateChange(function(q){G.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:q.pluginStatus,pluginURL:q.pluginURL},function(he,je){if(E.triggerPluginCompletionEvent(he),je&&je.every(function(kt){return kt}))for(var Xe in G.sourceCaches)G.sourceCaches[Xe].reload()})}),this.on("data",function(q){if(q.dataType==="source"&&q.sourceDataType==="metadata"){var he=k.sourceCaches[q.sourceId];if(he){var je=he.getSource();if(je&&je.vectorLayerIds)for(var Xe in k._layers){var kt=k._layers[Xe];kt.source===je.id&&k._validateLayer(kt)}}}})}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.loadURL=function(x,C){var k=this;C===void 0&&(C={}),this.fire(new E.Event("dataloading",{dataType:"style"}));var G=typeof C.validate=="boolean"?C.validate:!E.isMapboxURL(x);x=this.map._requestManager.normalizeStyleURL(x,C.accessToken);var q=this.map._requestManager.transformRequest(x,E.ResourceType.Style);this._request=E.getJSON(q,function(he,je){k._request=null,he?k.fire(new E.ErrorEvent(he)):je&&k._load(je,G)})},S.prototype.loadJSON=function(x,C){var k=this;C===void 0&&(C={}),this.fire(new E.Event("dataloading",{dataType:"style"})),this._request=E.browser.frame(function(){k._request=null,k._load(x,C.validate!==!1)})},S.prototype.loadEmpty=function(){this.fire(new E.Event("dataloading",{dataType:"style"})),this._load(Yf,!1)},S.prototype._load=function(x,C){if(!C||!Jc(this,E.validateStyle(x))){for(var k in this._loaded=!0,this.stylesheet=x,x.sources)this.addSource(k,x.sources[k],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs);var G=di(this.stylesheet.layers);this._order=G.map(function(Xe){return Xe.id}),this._layers={},this._serializedLayers={};for(var q=0,he=G;q<he.length;q+=1){var je=he[q];(je=E.createStyleLayer(je)).setEventedParent(this,{layer:{id:je.id}}),this._layers[je.id]=je,this._serializedLayers[je.id]=je.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new bt(this.stylesheet.light),this.fire(new E.Event("data",{dataType:"style"})),this.fire(new E.Event("style.load"))}},S.prototype._loadSprite=function(x){var C=this;this._spriteRequest=function(k,G,q){var he,je,Xe,kt=E.browser.devicePixelRatio>1?"@2x":"",jt=E.getJSON(G.transformRequest(G.normalizeSpriteURL(k,kt,".json"),E.ResourceType.SpriteJSON),function(pn,Cn){jt=null,Xe||(Xe=pn,he=Cn,gn())}),Yt=E.getImage(G.transformRequest(G.normalizeSpriteURL(k,kt,".png"),E.ResourceType.SpriteImage),function(pn,Cn){Yt=null,Xe||(Xe=pn,je=Cn,gn())});function gn(){if(Xe)q(Xe);else if(he&&je){var pn=E.browser.getImageData(je),Cn={};for(var un in he){var kn=he[un],er=kn.width,ur=kn.height,Cr=kn.x,dr=kn.y,Br=kn.sdf,ri=kn.pixelRatio,Yr=kn.stretchX,wi=kn.stretchY,Hi=kn.content,Lo=new E.RGBAImage({width:er,height:ur});E.RGBAImage.copy(pn,Lo,{x:Cr,y:dr},{x:0,y:0},{width:er,height:ur}),Cn[un]={data:Lo,pixelRatio:ri,sdf:Br,stretchX:Yr,stretchY:wi,content:Hi}}q(null,Cn)}}return{cancel:function(){jt&&(jt.cancel(),jt=null),Yt&&(Yt.cancel(),Yt=null)}}}(x,this.map._requestManager,function(k,G){if(C._spriteRequest=null,k)C.fire(new E.ErrorEvent(k));else if(G)for(var q in G)C.imageManager.addImage(q,G[q]);C.imageManager.setLoaded(!0),C._availableImages=C.imageManager.listImages(),C.dispatcher.broadcast("setImages",C._availableImages),C.fire(new E.Event("data",{dataType:"style"}))})},S.prototype._validateLayer=function(x){var C=this.sourceCaches[x.source];if(C){var k=x.sourceLayer;if(k){var G=C.getSource();(G.type==="geojson"||G.vectorLayerIds&&G.vectorLayerIds.indexOf(k)===-1)&&this.fire(new E.ErrorEvent(new Error('Source layer "'+k+'" does not exist on source "'+G.id+'" as specified by style layer "'+x.id+'"')))}}},S.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var x in this.sourceCaches)if(!this.sourceCaches[x].loaded())return!1;return!!this.imageManager.isLoaded()},S.prototype._serializeLayers=function(x){for(var C=[],k=0,G=x;k<G.length;k+=1){var q=this._layers[G[k]];q.type!=="custom"&&C.push(q.serialize())}return C},S.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var x in this.sourceCaches)if(this.sourceCaches[x].hasTransition())return!0;for(var C in this._layers)if(this._layers[C].hasTransition())return!0;return!1},S.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},S.prototype.update=function(x){if(this._loaded){var C=this._changed;if(this._changed){var k=Object.keys(this._updatedLayers),G=Object.keys(this._removedLayers);for(var q in(k.length||G.length)&&this._updateWorkerLayers(k,G),this._updatedSources){var he=this._updatedSources[q];he==="reload"?this._reloadSource(q):he==="clear"&&this._clearSource(q)}for(var je in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[je].updateTransitions(x);this.light.updateTransitions(x),this._resetUpdates()}var Xe={};for(var kt in this.sourceCaches){var jt=this.sourceCaches[kt];Xe[kt]=jt.used,jt.used=!1}for(var Yt=0,gn=this._order;Yt<gn.length;Yt+=1){var pn=this._layers[gn[Yt]];pn.recalculate(x,this._availableImages),!pn.isHidden(x.zoom)&&pn.source&&(this.sourceCaches[pn.source].used=!0)}for(var Cn in Xe){var un=this.sourceCaches[Cn];Xe[Cn]!==un.used&&un.fire(new E.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Cn}))}this.light.recalculate(x),this.z=x.zoom,C&&this.fire(new E.Event("data",{dataType:"style"}))}},S.prototype._updateTilesForChangedImages=function(){var x=Object.keys(this._changedImages);if(x.length){for(var C in this.sourceCaches)this.sourceCaches[C].reloadTilesForDependencies(["icons","patterns"],x);this._changedImages={}}},S.prototype._updateWorkerLayers=function(x,C){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(x),removedIds:C})},S.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},S.prototype.setState=function(x){var C=this;if(this._checkLoaded(),Jc(this,E.validateStyle(x)))return!1;(x=E.clone$1(x)).layers=di(x.layers);var k=function(q,he){if(!q)return[{command:vi.setStyle,args:[he]}];var je=[];try{if(!E.deepEqual(q.version,he.version))return[{command:vi.setStyle,args:[he]}];E.deepEqual(q.center,he.center)||je.push({command:vi.setCenter,args:[he.center]}),E.deepEqual(q.zoom,he.zoom)||je.push({command:vi.setZoom,args:[he.zoom]}),E.deepEqual(q.bearing,he.bearing)||je.push({command:vi.setBearing,args:[he.bearing]}),E.deepEqual(q.pitch,he.pitch)||je.push({command:vi.setPitch,args:[he.pitch]}),E.deepEqual(q.sprite,he.sprite)||je.push({command:vi.setSprite,args:[he.sprite]}),E.deepEqual(q.glyphs,he.glyphs)||je.push({command:vi.setGlyphs,args:[he.glyphs]}),E.deepEqual(q.transition,he.transition)||je.push({command:vi.setTransition,args:[he.transition]}),E.deepEqual(q.light,he.light)||je.push({command:vi.setLight,args:[he.light]});var Xe={},kt=[];(function(Yt,gn,pn,Cn){var un;for(un in gn=gn||{},Yt=Yt||{})Yt.hasOwnProperty(un)&&(gn.hasOwnProperty(un)||Oi(un,pn,Cn));for(un in gn)gn.hasOwnProperty(un)&&(Yt.hasOwnProperty(un)?E.deepEqual(Yt[un],gn[un])||(Yt[un].type==="geojson"&&gn[un].type==="geojson"&&va(Yt,gn,un)?pn.push({command:vi.setGeoJSONSourceData,args:[un,gn[un].data]}):Ko(un,gn,pn,Cn)):vo(un,gn,pn))})(q.sources,he.sources,kt,Xe);var jt=[];q.layers&&q.layers.forEach(function(Yt){Xe[Yt.source]?je.push({command:vi.removeLayer,args:[Yt.id]}):jt.push(Yt)}),je=je.concat(kt),function(Yt,gn,pn){gn=gn||[];var Cn,un,kn,er,ur,Cr,dr,Br=(Yt=Yt||[]).map(Xo),ri=gn.map(Xo),Yr=Yt.reduce(Ye,{}),wi=gn.reduce(Ye,{}),Hi=Br.slice(),Lo=Object.create(null);for(Cn=0,un=0;Cn<Br.length;Cn++)wi.hasOwnProperty(kn=Br[Cn])?un++:(pn.push({command:vi.removeLayer,args:[kn]}),Hi.splice(Hi.indexOf(kn,un),1));for(Cn=0,un=0;Cn<ri.length;Cn++)Hi[Hi.length-1-Cn]!==(kn=ri[ri.length-1-Cn])&&(Yr.hasOwnProperty(kn)?(pn.push({command:vi.removeLayer,args:[kn]}),Hi.splice(Hi.lastIndexOf(kn,Hi.length-un),1)):un++,pn.push({command:vi.addLayer,args:[wi[kn],Cr=Hi[Hi.length-Cn]]}),Hi.splice(Hi.length-Cn,0,kn),Lo[kn]=!0);for(Cn=0;Cn<ri.length;Cn++)if(er=Yr[kn=ri[Cn]],ur=wi[kn],!Lo[kn]&&!E.deepEqual(er,ur))if(E.deepEqual(er.source,ur.source)&&E.deepEqual(er["source-layer"],ur["source-layer"])&&E.deepEqual(er.type,ur.type)){for(dr in Co(er.layout,ur.layout,pn,kn,null,vi.setLayoutProperty),Co(er.paint,ur.paint,pn,kn,null,vi.setPaintProperty),E.deepEqual(er.filter,ur.filter)||pn.push({command:vi.setFilter,args:[kn,ur.filter]}),E.deepEqual(er.minzoom,ur.minzoom)&&E.deepEqual(er.maxzoom,ur.maxzoom)||pn.push({command:vi.setLayerZoomRange,args:[kn,ur.minzoom,ur.maxzoom]}),er)er.hasOwnProperty(dr)&&dr!=="layout"&&dr!=="paint"&&dr!=="filter"&&dr!=="metadata"&&dr!=="minzoom"&&dr!=="maxzoom"&&(dr.indexOf("paint.")===0?Co(er[dr],ur[dr],pn,kn,dr.slice(6),vi.setPaintProperty):E.deepEqual(er[dr],ur[dr])||pn.push({command:vi.setLayerProperty,args:[kn,dr,ur[dr]]}));for(dr in ur)ur.hasOwnProperty(dr)&&!er.hasOwnProperty(dr)&&dr!=="layout"&&dr!=="paint"&&dr!=="filter"&&dr!=="metadata"&&dr!=="minzoom"&&dr!=="maxzoom"&&(dr.indexOf("paint.")===0?Co(er[dr],ur[dr],pn,kn,dr.slice(6),vi.setPaintProperty):E.deepEqual(er[dr],ur[dr])||pn.push({command:vi.setLayerProperty,args:[kn,dr,ur[dr]]}))}else pn.push({command:vi.removeLayer,args:[kn]}),Cr=Hi[Hi.lastIndexOf(kn)+1],pn.push({command:vi.addLayer,args:[ur,Cr]})}(jt,he.layers,je)}catch(Yt){console.warn("Unable to compute style diff:",Yt),je=[{command:vi.setStyle,args:[he]}]}return je}(this.serialize(),x).filter(function(q){return!(q.command in eu)});if(k.length===0)return!1;var G=k.filter(function(q){return!(q.command in Ic)});if(G.length>0)throw new Error("Unimplemented: "+G.map(function(q){return q.command}).join(", ")+".");return k.forEach(function(q){q.command!=="setTransition"&&C[q.command].apply(C,q.args)}),this.stylesheet=x,!0},S.prototype.addImage=function(x,C){if(this.getImage(x))return this.fire(new E.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(x,C),this._afterImageUpdated(x)},S.prototype.updateImage=function(x,C){this.imageManager.updateImage(x,C)},S.prototype.getImage=function(x){return this.imageManager.getImage(x)},S.prototype.removeImage=function(x){if(!this.getImage(x))return this.fire(new E.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(x),this._afterImageUpdated(x)},S.prototype._afterImageUpdated=function(x){this._availableImages=this.imageManager.listImages(),this._changedImages[x]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new E.Event("data",{dataType:"style"}))},S.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},S.prototype.addSource=function(x,C,k){var G=this;if(k===void 0&&(k={}),this._checkLoaded(),this.sourceCaches[x]!==void 0)throw new Error("There is already a source with this ID");if(!C.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(C).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(C.type)>=0&&this._validate(E.validateStyle.source,"sources."+x,C,null,k))){this.map&&this.map._collectResourceTiming&&(C.collectResourceTiming=!0);var q=this.sourceCaches[x]=new en(x,C,this.dispatcher);q.style=this,q.setEventedParent(this,function(){return{isSourceLoaded:G.loaded(),source:q.serialize(),sourceId:x}}),q.onAdd(this.map),this._changed=!0}},S.prototype.removeSource=function(x){if(this._checkLoaded(),this.sourceCaches[x]===void 0)throw new Error("There is no source with this ID");for(var C in this._layers)if(this._layers[C].source===x)return this.fire(new E.ErrorEvent(new Error('Source "'+x+'" cannot be removed while layer "'+C+'" is using it.')));var k=this.sourceCaches[x];delete this.sourceCaches[x],delete this._updatedSources[x],k.fire(new E.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x})),k.setEventedParent(null),k.clearTiles(),k.onRemove&&k.onRemove(this.map),this._changed=!0},S.prototype.setGeoJSONSourceData=function(x,C){this._checkLoaded(),this.sourceCaches[x].getSource().setData(C),this._changed=!0},S.prototype.getSource=function(x){return this.sourceCaches[x]&&this.sourceCaches[x].getSource()},S.prototype.addLayer=function(x,C,k){k===void 0&&(k={}),this._checkLoaded();var G=x.id;if(this.getLayer(G))this.fire(new E.ErrorEvent(new Error('Layer with id "'+G+'" already exists on this map')));else{var q;if(x.type==="custom"){if(Jc(this,E.validateCustomStyleLayer(x)))return;q=E.createStyleLayer(x)}else{if(typeof x.source=="object"&&(this.addSource(G,x.source),x=E.clone$1(x),x=E.extend(x,{source:G})),this._validate(E.validateStyle.layer,"layers."+G,x,{arrayIndex:-1},k))return;q=E.createStyleLayer(x),this._validateLayer(q),q.setEventedParent(this,{layer:{id:G}}),this._serializedLayers[q.id]=q.serialize()}var he=C?this._order.indexOf(C):this._order.length;if(C&&he===-1)this.fire(new E.ErrorEvent(new Error('Layer with id "'+C+'" does not exist on this map.')));else{if(this._order.splice(he,0,G),this._layerOrderChanged=!0,this._layers[G]=q,this._removedLayers[G]&&q.source&&q.type!=="custom"){var je=this._removedLayers[G];delete this._removedLayers[G],je.type!==q.type?this._updatedSources[q.source]="clear":(this._updatedSources[q.source]="reload",this.sourceCaches[q.source].pause())}this._updateLayer(q),q.onAdd&&q.onAdd(this.map)}}},S.prototype.moveLayer=function(x,C){if(this._checkLoaded(),this._changed=!0,this._layers[x]){if(x!==C){var k=this._order.indexOf(x);this._order.splice(k,1);var G=C?this._order.indexOf(C):this._order.length;C&&G===-1?this.fire(new E.ErrorEvent(new Error('Layer with id "'+C+'" does not exist on this map.'))):(this._order.splice(G,0,x),this._layerOrderChanged=!0)}}else this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be moved.")))},S.prototype.removeLayer=function(x){this._checkLoaded();var C=this._layers[x];if(C){C.setEventedParent(null);var k=this._order.indexOf(x);this._order.splice(k,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[x]=C,delete this._layers[x],delete this._serializedLayers[x],delete this._updatedLayers[x],delete this._updatedPaintProps[x],C.onRemove&&C.onRemove(this.map)}else this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be removed.")))},S.prototype.getLayer=function(x){return this._layers[x]},S.prototype.hasLayer=function(x){return x in this._layers},S.prototype.setLayerZoomRange=function(x,C,k){this._checkLoaded();var G=this.getLayer(x);G?G.minzoom===C&&G.maxzoom===k||(C!=null&&(G.minzoom=C),k!=null&&(G.maxzoom=k),this._updateLayer(G)):this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot have zoom extent.")))},S.prototype.setFilter=function(x,C,k){k===void 0&&(k={}),this._checkLoaded();var G=this.getLayer(x);if(G){if(!E.deepEqual(G.filter,C))return C==null?(G.filter=void 0,void this._updateLayer(G)):void(this._validate(E.validateStyle.filter,"layers."+G.id+".filter",C,null,k)||(G.filter=E.clone$1(C),this._updateLayer(G)))}else this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be filtered.")))},S.prototype.getFilter=function(x){return E.clone$1(this.getLayer(x).filter)},S.prototype.setLayoutProperty=function(x,C,k,G){G===void 0&&(G={}),this._checkLoaded();var q=this.getLayer(x);q?E.deepEqual(q.getLayoutProperty(C),k)||(q.setLayoutProperty(C,k,G),this._updateLayer(q)):this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be styled.")))},S.prototype.getLayoutProperty=function(x,C){var k=this.getLayer(x);if(k)return k.getLayoutProperty(C);this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style.")))},S.prototype.setPaintProperty=function(x,C,k,G){G===void 0&&(G={}),this._checkLoaded();var q=this.getLayer(x);q?E.deepEqual(q.getPaintProperty(C),k)||(q.setPaintProperty(C,k,G)&&this._updateLayer(q),this._changed=!0,this._updatedPaintProps[x]=!0):this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be styled.")))},S.prototype.getPaintProperty=function(x,C){return this.getLayer(x).getPaintProperty(C)},S.prototype.setFeatureState=function(x,C){this._checkLoaded();var k=x.source,G=x.sourceLayer,q=this.sourceCaches[k];if(q!==void 0){var he=q.getSource().type;he==="geojson"&&G?this.fire(new E.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):he!=="vector"||G?(x.id===void 0&&this.fire(new E.ErrorEvent(new Error("The feature id parameter must be provided."))),q.setFeatureState(G,x.id,C)):this.fire(new E.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new E.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},S.prototype.removeFeatureState=function(x,C){this._checkLoaded();var k=x.source,G=this.sourceCaches[k];if(G!==void 0){var q=G.getSource().type,he=q==="vector"?x.sourceLayer:void 0;q!=="vector"||he?C&&typeof x.id!="string"&&typeof x.id!="number"?this.fire(new E.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):G.removeFeatureState(he,x.id,C):this.fire(new E.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new E.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},S.prototype.getFeatureState=function(x){this._checkLoaded();var C=x.source,k=x.sourceLayer,G=this.sourceCaches[C];if(G!==void 0){if(G.getSource().type!=="vector"||k)return x.id===void 0&&this.fire(new E.ErrorEvent(new Error("The feature id parameter must be provided."))),G.getFeatureState(k,x.id);this.fire(new E.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new E.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},S.prototype.getTransition=function(){return E.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},S.prototype.serialize=function(){return E.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:E.mapObject(this.sourceCaches,function(x){return x.serialize()}),layers:this._serializeLayers(this._order)},function(x){return x!==void 0})},S.prototype._updateLayer=function(x){this._updatedLayers[x.id]=!0,x.source&&!this._updatedSources[x.source]&&this.sourceCaches[x.source].getSource().type!=="raster"&&(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause()),this._changed=!0},S.prototype._flattenAndSortRenderedFeatures=function(x){for(var C=this,k=function(Yr){return C._layers[Yr].type==="fill-extrusion"},G={},q=[],he=this._order.length-1;he>=0;he--){var je=this._order[he];if(k(je)){G[je]=he;for(var Xe=0,kt=x;Xe<kt.length;Xe+=1){var jt=kt[Xe][je];if(jt)for(var Yt=0,gn=jt;Yt<gn.length;Yt+=1)q.push(gn[Yt])}}}q.sort(function(Yr,wi){return wi.intersectionZ-Yr.intersectionZ});for(var pn=[],Cn=this._order.length-1;Cn>=0;Cn--){var un=this._order[Cn];if(k(un))for(var kn=q.length-1;kn>=0;kn--){var er=q[kn].feature;if(G[er.layer.id]<Cn)break;pn.push(er),q.pop()}else for(var ur=0,Cr=x;ur<Cr.length;ur+=1){var dr=Cr[ur][un];if(dr)for(var Br=0,ri=dr;Br<ri.length;Br+=1)pn.push(ri[Br].feature)}}return pn},S.prototype.queryRenderedFeatures=function(x,C,k){C&&C.filter&&this._validate(E.validateStyle.filter,"queryRenderedFeatures.filter",C.filter,null,C);var G={};if(C&&C.layers){if(!Array.isArray(C.layers))return this.fire(new E.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var q=0,he=C.layers;q<he.length;q+=1){var je=he[q],Xe=this._layers[je];if(!Xe)return this.fire(new E.ErrorEvent(new Error("The layer '"+je+"' does not exist in the map's style and cannot be queried for features."))),[];G[Xe.source]=!0}}var kt=[];for(var jt in C.availableImages=this._availableImages,this.sourceCaches)C.layers&&!G[jt]||kt.push(Fn(this.sourceCaches[jt],this._layers,this._serializedLayers,x,C,k));return this.placement&&kt.push(function(Yt,gn,pn,Cn,un,kn,er){for(var ur={},Cr=kn.queryRenderedSymbols(Cn),dr=[],Br=0,ri=Object.keys(Cr).map(Number);Br<ri.length;Br+=1)dr.push(er[ri[Br]]);dr.sort($n);for(var Yr=function(){var ko=Hi[wi],fa=ko.featureIndex.lookupSymbolFeatures(Cr[ko.bucketInstanceId],gn,ko.bucketIndex,ko.sourceLayerIndex,un.filter,un.layers,un.availableImages,Yt);for(var Bn in fa){var qt=ur[Bn]=ur[Bn]||[],ua=fa[Bn];ua.sort(function(_a,Vo){var Do=ko.featureSortOrder;if(Do){var hc=Do.indexOf(_a.featureIndex);return Do.indexOf(Vo.featureIndex)-hc}return Vo.featureIndex-_a.featureIndex});for(var ra=0,Ho=ua;ra<Ho.length;ra+=1)qt.push(Ho[ra])}},wi=0,Hi=dr;wi<Hi.length;wi+=1)Yr();var Lo=function(ko){ur[ko].forEach(function(fa){var Bn=fa.feature,qt=pn[Yt[ko].source].getFeatureState(Bn.layer["source-layer"],Bn.id);Bn.source=Bn.layer.source,Bn.layer["source-layer"]&&(Bn.sourceLayer=Bn.layer["source-layer"]),Bn.state=qt})};for(var Fo in ur)Lo(Fo);return ur}(this._layers,this._serializedLayers,this.sourceCaches,x,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(kt)},S.prototype.querySourceFeatures=function(x,C){C&&C.filter&&this._validate(E.validateStyle.filter,"querySourceFeatures.filter",C.filter,null,C);var k=this.sourceCaches[x];return k?function(G,q){for(var he=G.getRenderableIds().map(function(gn){return G.getTileByID(gn)}),je=[],Xe={},kt=0;kt<he.length;kt++){var jt=he[kt],Yt=jt.tileID.canonical.key;Xe[Yt]||(Xe[Yt]=!0,jt.querySourceFeatures(je,q))}return je}(k,C):[]},S.prototype.addSourceType=function(x,C,k){return S.getSourceType(x)?k(new Error('A source type called "'+x+'" already exists.')):(S.setSourceType(x,C),C.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:x,url:C.workerSourceURL},k):k(null,null))},S.prototype.getLight=function(){return this.light.getLight()},S.prototype.setLight=function(x,C){C===void 0&&(C={}),this._checkLoaded();var k=this.light.getLight(),G=!1;for(var q in x)if(!E.deepEqual(x[q],k[q])){G=!0;break}if(G){var he={now:E.browser.now(),transition:E.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(x,C),this.light.updateTransitions(he)}},S.prototype._validate=function(x,C,k,G,q){return q===void 0&&(q={}),(!q||q.validate!==!1)&&Jc(this,x.call(E.validateStyle,E.extend({key:C,style:this.serialize(),value:k,styleSpec:E.styleSpec},G)))},S.prototype._remove=function(){for(var x in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),E.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[x].setEventedParent(null);for(var C in this.sourceCaches)this.sourceCaches[C].clearTiles(),this.sourceCaches[C].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},S.prototype._clearSource=function(x){this.sourceCaches[x].clearTiles()},S.prototype._reloadSource=function(x){this.sourceCaches[x].resume(),this.sourceCaches[x].reload()},S.prototype._updateSources=function(x){for(var C in this.sourceCaches)this.sourceCaches[C].update(x)},S.prototype._generateCollisionBoxes=function(){for(var x in this.sourceCaches)this._reloadSource(x)},S.prototype._updatePlacement=function(x,C,k,G,q){q===void 0&&(q=!1);for(var he=!1,je=!1,Xe={},kt=0,jt=this._order;kt<jt.length;kt+=1){var Yt=this._layers[jt[kt]];if(Yt.type==="symbol"){if(!Xe[Yt.source]){var gn=this.sourceCaches[Yt.source];Xe[Yt.source]=gn.getRenderableIds(!0).map(function(er){return gn.getTileByID(er)}).sort(function(er,ur){return ur.tileID.overscaledZ-er.tileID.overscaledZ||(er.tileID.isLessThan(ur.tileID)?-1:1)})}var pn=this.crossTileSymbolIndex.addLayer(Yt,Xe[Yt.source],x.center.lng);he=he||pn}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((q=q||this._layerOrderChanged||k===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(E.browser.now(),x.zoom))&&(this.pauseablePlacement=new Xf(x,this._order,q,C,k,G,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Xe),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(E.browser.now()),je=!0),he&&this.pauseablePlacement.placement.setStale()),je||he)for(var Cn=0,un=this._order;Cn<un.length;Cn+=1){var kn=this._layers[un[Cn]];kn.type==="symbol"&&this.placement.updateLayerOpacities(kn,Xe[kn.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(E.browser.now())},S.prototype._releaseSymbolFadeTiles=function(){for(var x in this.sourceCaches)this.sourceCaches[x].releaseSymbolFadeTiles()},S.prototype.getImages=function(x,C,k){this.imageManager.getImages(C.icons,k),this._updateTilesForChangedImages();var G=this.sourceCaches[C.source];G&&G.setDependencies(C.tileID.key,C.type,C.icons)},S.prototype.getGlyphs=function(x,C,k){this.glyphManager.getGlyphs(C.stacks,k)},S.prototype.getResource=function(x,C,k){return E.makeRequest(C,k)},S}(E.Evented);ac.getSourceType=function(_){return Xt[_]},ac.setSourceType=function(_,S){Xt[_]=S},ac.registerForPluginStateChange=E.registerForPluginStateChange;var Xs=E.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ru=ps(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),gf=ps(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),kh=ps(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),zh=ps(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),tu=ps("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),mh=ps(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Uh=ps(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),vd=ps("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),gd=ps("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),yd=ps("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),vp=ps(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),$f=ps(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Mu=ps(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),_d=ps(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Nl=ps(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Is=ps(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),nu=ps(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),sc=ps(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),of=ps(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),lc=ps(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),af=ps(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Bl=ps(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Pu=ps(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),yf=ps(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),vh=ps(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Kf=ps(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ps(_,S){var x=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,C=S.match(/attribute ([\w]+) ([\w]+)/g),k=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),G=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),q=G?G.concat(k):k,he={};return{fragmentSource:_=_.replace(x,function(je,Xe,kt,jt,Yt){return he[Yt]=!0,Xe==="define"?`
#ifndef HAS_UNIFORM_u_`+Yt+`
varying `+kt+" "+jt+" "+Yt+`;
#else
uniform `+kt+" "+jt+" u_"+Yt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Yt+`
    `+kt+" "+jt+" "+Yt+" = u_"+Yt+`;
#endif
`}),vertexSource:S=S.replace(x,function(je,Xe,kt,jt,Yt){var gn=jt==="float"?"vec2":"vec4",pn=Yt.match(/color/)?"color":gn;return he[Yt]?Xe==="define"?`
#ifndef HAS_UNIFORM_u_`+Yt+`
uniform lowp float u_`+Yt+`_t;
attribute `+kt+" "+gn+" a_"+Yt+`;
varying `+kt+" "+jt+" "+Yt+`;
#else
uniform `+kt+" "+jt+" u_"+Yt+`;
#endif
`:pn==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Yt+`
    `+Yt+" = a_"+Yt+`;
#else
    `+kt+" "+jt+" "+Yt+" = u_"+Yt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Yt+`
    `+Yt+" = unpack_mix_"+pn+"(a_"+Yt+", u_"+Yt+`_t);
#else
    `+kt+" "+jt+" "+Yt+" = u_"+Yt+`;
#endif
`:Xe==="define"?`
#ifndef HAS_UNIFORM_u_`+Yt+`
uniform lowp float u_`+Yt+`_t;
attribute `+kt+" "+gn+" a_"+Yt+`;
#else
uniform `+kt+" "+jt+" u_"+Yt+`;
#endif
`:pn==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Yt+`
    `+kt+" "+jt+" "+Yt+" = a_"+Yt+`;
#else
    `+kt+" "+jt+" "+Yt+" = u_"+Yt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Yt+`
    `+kt+" "+jt+" "+Yt+" = unpack_mix_"+pn+"(a_"+Yt+", u_"+Yt+`_t);
#else
    `+kt+" "+jt+" "+Yt+" = u_"+Yt+`;
#endif
`}),staticAttributes:C,staticUniforms:q}}var jh=Object.freeze({__proto__:null,prelude:Ru,background:gf,backgroundPattern:kh,circle:zh,clippingMask:tu,heatmap:mh,heatmapTexture:Uh,collisionBox:vd,collisionCircle:gd,debug:yd,fill:vp,fillOutline:$f,fillOutlinePattern:Mu,fillPattern:_d,fillExtrusion:Nl,fillExtrusionPattern:Is,hillshadePrepare:nu,hillshade:sc,line:of,lineGradient:lc,linePattern:af,lineSDF:Bl,raster:Pu,symbolIcon:yf,symbolSDF:vh,symbolTextAndIcon:Kf}),Vh=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function gh(_){for(var S=[],x=0;x<_.length;x++)if(_[x]!==null){var C=_[x].split(" ");S.push(C.pop())}return S}Vh.prototype.bind=function(_,S,x,C,k,G,q,he){this.context=_;for(var je=this.boundPaintVertexBuffers.length!==C.length,Xe=0;!je&&Xe<C.length;Xe++)this.boundPaintVertexBuffers[Xe]!==C[Xe]&&(je=!0);_.extVertexArrayObject&&this.vao&&this.boundProgram===S&&this.boundLayoutVertexBuffer===x&&!je&&this.boundIndexBuffer===k&&this.boundVertexOffset===G&&this.boundDynamicVertexBuffer===q&&this.boundDynamicVertexBuffer2===he?(_.bindVertexArrayOES.set(this.vao),q&&q.bind(),k&&k.dynamicDraw&&k.bind(),he&&he.bind()):this.freshBind(S,x,C,k,G,q,he)},Vh.prototype.freshBind=function(_,S,x,C,k,G,q){var he,je=_.numAttributes,Xe=this.context,kt=Xe.gl;if(Xe.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Xe.extVertexArrayObject.createVertexArrayOES(),Xe.bindVertexArrayOES.set(this.vao),he=0,this.boundProgram=_,this.boundLayoutVertexBuffer=S,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=C,this.boundVertexOffset=k,this.boundDynamicVertexBuffer=G,this.boundDynamicVertexBuffer2=q;else{he=Xe.currentNumAttributes||0;for(var jt=je;jt<he;jt++)kt.disableVertexAttribArray(jt)}S.enableAttributes(kt,_);for(var Yt=0,gn=x;Yt<gn.length;Yt+=1)gn[Yt].enableAttributes(kt,_);G&&G.enableAttributes(kt,_),q&&q.enableAttributes(kt,_),S.bind(),S.setVertexAttribPointers(kt,_,k);for(var pn=0,Cn=x;pn<Cn.length;pn+=1){var un=Cn[pn];un.bind(),un.setVertexAttribPointers(kt,_,k)}G&&(G.bind(),G.setVertexAttribPointers(kt,_,k)),C&&C.bind(),q&&(q.bind(),q.setVertexAttribPointers(kt,_,k)),Xe.currentNumAttributes=je},Vh.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ol=function(_,S,x,C,k,G){var q=_.gl;this.program=q.createProgram();for(var he=gh(x.staticAttributes),je=C?C.getBinderAttributes():[],Xe=he.concat(je),kt=x.staticUniforms?gh(x.staticUniforms):[],jt=C?C.getBinderUniforms():[],Yt=[],gn=0,pn=kt.concat(jt);gn<pn.length;gn+=1){var Cn=pn[gn];Yt.indexOf(Cn)<0&&Yt.push(Cn)}var un=C?C.defines():[];G&&un.push("#define OVERDRAW_INSPECTOR;");var kn=un.concat(Ru.fragmentSource,x.fragmentSource).join(`
`),er=un.concat(Ru.vertexSource,x.vertexSource).join(`
`),ur=q.createShader(q.FRAGMENT_SHADER);if(q.isContextLost())this.failedToCreate=!0;else{q.shaderSource(ur,kn),q.compileShader(ur),q.attachShader(this.program,ur);var Cr=q.createShader(q.VERTEX_SHADER);if(q.isContextLost())this.failedToCreate=!0;else{q.shaderSource(Cr,er),q.compileShader(Cr),q.attachShader(this.program,Cr),this.attributes={};var dr={};this.numAttributes=Xe.length;for(var Br=0;Br<this.numAttributes;Br++)Xe[Br]&&(q.bindAttribLocation(this.program,Br,Xe[Br]),this.attributes[Xe[Br]]=Br);q.linkProgram(this.program),q.deleteShader(Cr),q.deleteShader(ur);for(var ri=0;ri<Yt.length;ri++){var Yr=Yt[ri];if(Yr&&!dr[Yr]){var wi=q.getUniformLocation(this.program,Yr);wi&&(dr[Yr]=wi)}}this.fixedUniforms=k(_,dr),this.binderUniforms=C?C.getUniforms(_,dr):[]}}};function qf(_,S,x){var C=1/Mi(x,1,S.transform.tileZoom),k=Math.pow(2,x.tileID.overscaledZ),G=x.tileSize*Math.pow(2,S.transform.tileZoom)/k,q=G*(x.tileID.canonical.x+x.tileID.wrap*k),he=G*x.tileID.canonical.y;return{u_image:0,u_texsize:x.imageAtlasTexture.size,u_scale:[C,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[q>>16,he>>16],u_pixel_coord_lower:[65535&q,65535&he]}}ol.prototype.draw=function(_,S,x,C,k,G,q,he,je,Xe,kt,jt,Yt,gn,pn,Cn){var un,kn=_.gl;if(!this.failedToCreate){for(var er in _.program.set(this.program),_.setDepthMode(x),_.setStencilMode(C),_.setColorMode(k),_.setCullFace(G),this.fixedUniforms)this.fixedUniforms[er].set(q[er]);gn&&gn.setUniforms(_,this.binderUniforms,jt,{zoom:Yt});for(var ur=(un={},un[kn.LINES]=2,un[kn.TRIANGLES]=3,un[kn.LINE_STRIP]=1,un)[S],Cr=0,dr=kt.get();Cr<dr.length;Cr+=1){var Br=dr[Cr],ri=Br.vaos||(Br.vaos={});(ri[he]||(ri[he]=new Vh)).bind(_,this,je,gn?gn.getPaintVertexBuffers():[],Xe,Br.vertexOffset,pn,Cn),kn.drawElements(S,Br.primitiveLength*ur,kn.UNSIGNED_SHORT,Br.primitiveOffset*ur*2)}}};var Qf=function(_,S,x,C){var k=S.style.light,G=k.properties.get("position"),q=[G.x,G.y,G.z],he=E.create$1();k.properties.get("anchor")==="viewport"&&E.fromRotation(he,-S.transform.angle),E.transformMat3(q,q,he);var je=k.properties.get("color");return{u_matrix:_,u_lightpos:q,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[je.r,je.g,je.b],u_vertical_gradient:+x,u_opacity:C}},ne=function(_,S,x,C,k,G,q){return E.extend(Qf(_,S,x,C),qf(G,S,q),{u_height_factor:-Math.pow(2,k.overscaledZ)/q.tileSize/8})},_e=function(_){return{u_matrix:_}},et=function(_,S,x,C){return E.extend(_e(_),qf(x,S,C))},dn=function(_,S){return{u_matrix:_,u_world:S}},K=function(_,S,x,C,k){return E.extend(et(_,S,x,C),{u_world:k})},rr=function(_,S,x,C){var k,G,q=_.transform;if(C.paint.get("circle-pitch-alignment")==="map"){var he=Mi(x,1,q.zoom);k=!0,G=[he,he]}else k=!1,G=q.pixelsToGLUnits;return{u_camera_to_center_distance:q.cameraToCenterDistance,u_scale_with_map:+(C.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(S.posMatrix,x,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_pitch_with_map:+k,u_device_pixel_ratio:E.browser.devicePixelRatio,u_extrude_scale:G}},Mr=function(_,S,x){var C=Mi(x,1,S.zoom),k=Math.pow(2,S.zoom-x.tileID.overscaledZ),G=x.tileID.overscaleFactor();return{u_matrix:_,u_camera_to_center_distance:S.cameraToCenterDistance,u_pixels_to_tile_units:C,u_extrude_scale:[S.pixelsToGLUnits[0]/(C*k),S.pixelsToGLUnits[1]/(C*k)],u_overscale_factor:G}},ki=function(_,S,x){return{u_matrix:_,u_inv_matrix:S,u_camera_to_center_distance:x.cameraToCenterDistance,u_viewport_size:[x.width,x.height]}},ti=function(_,S,x){return x===void 0&&(x=1),{u_matrix:_,u_color:S,u_overlay:0,u_overlay_scale:x}},uo=function(_){return{u_matrix:_}},lo=function(_,S,x,C){return{u_matrix:_,u_extrude_scale:Mi(S,1,x),u_intensity:C}},ca=function(_,S,x){var C=_.transform;return{u_matrix:ga(_,S,x),u_ratio:1/Mi(S,1,C.zoom),u_device_pixel_ratio:E.browser.devicePixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Io=function(_,S,x,C){return E.extend(ca(_,S,x),{u_image:0,u_image_height:C})},xa=function(_,S,x,C){var k=_.transform,G=aa(S,k);return{u_matrix:ga(_,S,x),u_texsize:S.imageAtlasTexture.size,u_ratio:1/Mi(S,1,k.zoom),u_device_pixel_ratio:E.browser.devicePixelRatio,u_image:0,u_scale:[G,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]]}},Qa=function(_,S,x,C,k){var G=_.lineAtlas,q=aa(S,_.transform),he=x.layout.get("line-cap")==="round",je=G.getDash(C.from,he),Xe=G.getDash(C.to,he),kt=je.width*k.fromScale,jt=Xe.width*k.toScale;return E.extend(ca(_,S,x),{u_patternscale_a:[q/kt,-je.height/2],u_patternscale_b:[q/jt,-Xe.height/2],u_sdfgamma:G.width/(256*Math.min(kt,jt)*E.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:je.y,u_tex_y_b:Xe.y,u_mix:k.t})};function aa(_,S){return 1/Mi(_,1,S.tileZoom)}function ga(_,S,x){return _.translatePosMatrix(S.tileID.posMatrix,S,x.paint.get("line-translate"),x.paint.get("line-translate-anchor"))}var hs=function(_,S,x,C,k){return{u_matrix:_,u_tl_parent:S,u_scale_parent:x,u_buffer_scale:1,u_fade_t:C.mix,u_opacity:C.opacity*k.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:k.paint.get("raster-brightness-min"),u_brightness_high:k.paint.get("raster-brightness-max"),u_saturation_factor:(q=k.paint.get("raster-saturation"),q>0?1-1/(1.001-q):-q),u_contrast_factor:(G=k.paint.get("raster-contrast"),G>0?1/(1-G):1+G),u_spin_weights:Oa(k.paint.get("raster-hue-rotate"))};var G,q};function Oa(_){_*=Math.PI/180;var S=Math.sin(_),x=Math.cos(_);return[(2*x+1)/3,(-Math.sqrt(3)*S-x+1)/3,(Math.sqrt(3)*S-x+1)/3]}var La,Fa=function(_,S,x,C,k,G,q,he,je,Xe){var kt=k.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:S?S.uSizeT:0,u_size:S?S.uSize:0,u_camera_to_center_distance:kt.cameraToCenterDistance,u_pitch:kt.pitch/360*2*Math.PI,u_rotate_symbol:+x,u_aspect_ratio:kt.width/kt.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:G,u_label_plane_matrix:q,u_coord_matrix:he,u_is_text:+je,u_pitch_with_map:+C,u_texsize:Xe,u_texture:0}},Ks=function(_,S,x,C,k,G,q,he,je,Xe,kt){var jt=k.transform;return E.extend(Fa(_,S,x,C,k,G,q,he,je,Xe),{u_gamma_scale:C?Math.cos(jt._pitch)*jt.cameraToCenterDistance:1,u_device_pixel_ratio:E.browser.devicePixelRatio,u_is_halo:+kt})},Fs=function(_,S,x,C,k,G,q,he,je,Xe){return E.extend(Ks(_,S,x,C,k,G,q,he,!0,je,!0),{u_texsize_icon:Xe,u_texture_icon:1})},Ec=function(_,S,x){return{u_matrix:_,u_opacity:S,u_color:x}},is=function(_,S,x,C,k,G){return E.extend(function(q,he,je,Xe){var kt=je.imageManager.getPattern(q.from.toString()),jt=je.imageManager.getPattern(q.to.toString()),Yt=je.imageManager.getPixelSize(),gn=Yt.width,pn=Yt.height,Cn=Math.pow(2,Xe.tileID.overscaledZ),un=Xe.tileSize*Math.pow(2,je.transform.tileZoom)/Cn,kn=un*(Xe.tileID.canonical.x+Xe.tileID.wrap*Cn),er=un*Xe.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:kt.tl,u_pattern_br_a:kt.br,u_pattern_tl_b:jt.tl,u_pattern_br_b:jt.br,u_texsize:[gn,pn],u_mix:he.t,u_pattern_size_a:kt.displaySize,u_pattern_size_b:jt.displaySize,u_scale_a:he.fromScale,u_scale_b:he.toScale,u_tile_units_to_pixels:1/Mi(Xe,1,je.transform.tileZoom),u_pixel_coord_upper:[kn>>16,er>>16],u_pixel_coord_lower:[65535&kn,65535&er]}}(C,G,x,k),{u_matrix:_,u_opacity:S})},Iu={fillExtrusion:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_lightpos:new E.Uniform3f(_,S.u_lightpos),u_lightintensity:new E.Uniform1f(_,S.u_lightintensity),u_lightcolor:new E.Uniform3f(_,S.u_lightcolor),u_vertical_gradient:new E.Uniform1f(_,S.u_vertical_gradient),u_opacity:new E.Uniform1f(_,S.u_opacity)}},fillExtrusionPattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_lightpos:new E.Uniform3f(_,S.u_lightpos),u_lightintensity:new E.Uniform1f(_,S.u_lightintensity),u_lightcolor:new E.Uniform3f(_,S.u_lightcolor),u_vertical_gradient:new E.Uniform1f(_,S.u_vertical_gradient),u_height_factor:new E.Uniform1f(_,S.u_height_factor),u_image:new E.Uniform1i(_,S.u_image),u_texsize:new E.Uniform2f(_,S.u_texsize),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade),u_opacity:new E.Uniform1f(_,S.u_opacity)}},fill:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},fillPattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_image:new E.Uniform1i(_,S.u_image),u_texsize:new E.Uniform2f(_,S.u_texsize),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade)}},fillOutline:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_world:new E.Uniform2f(_,S.u_world)}},fillOutlinePattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_world:new E.Uniform2f(_,S.u_world),u_image:new E.Uniform1i(_,S.u_image),u_texsize:new E.Uniform2f(_,S.u_texsize),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade)}},circle:function(_,S){return{u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_scale_with_map:new E.Uniform1i(_,S.u_scale_with_map),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_extrude_scale:new E.Uniform2f(_,S.u_extrude_scale),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},collisionBox:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pixels_to_tile_units:new E.Uniform1f(_,S.u_pixels_to_tile_units),u_extrude_scale:new E.Uniform2f(_,S.u_extrude_scale),u_overscale_factor:new E.Uniform1f(_,S.u_overscale_factor)}},collisionCircle:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_inv_matrix:new E.UniformMatrix4f(_,S.u_inv_matrix),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_viewport_size:new E.Uniform2f(_,S.u_viewport_size)}},debug:function(_,S){return{u_color:new E.UniformColor(_,S.u_color),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_overlay:new E.Uniform1i(_,S.u_overlay),u_overlay_scale:new E.Uniform1f(_,S.u_overlay_scale)}},clippingMask:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},heatmap:function(_,S){return{u_extrude_scale:new E.Uniform1f(_,S.u_extrude_scale),u_intensity:new E.Uniform1f(_,S.u_intensity),u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},heatmapTexture:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_world:new E.Uniform2f(_,S.u_world),u_image:new E.Uniform1i(_,S.u_image),u_color_ramp:new E.Uniform1i(_,S.u_color_ramp),u_opacity:new E.Uniform1f(_,S.u_opacity)}},hillshade:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_image:new E.Uniform1i(_,S.u_image),u_latrange:new E.Uniform2f(_,S.u_latrange),u_light:new E.Uniform2f(_,S.u_light),u_shadow:new E.UniformColor(_,S.u_shadow),u_highlight:new E.UniformColor(_,S.u_highlight),u_accent:new E.UniformColor(_,S.u_accent)}},hillshadePrepare:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_image:new E.Uniform1i(_,S.u_image),u_dimension:new E.Uniform2f(_,S.u_dimension),u_zoom:new E.Uniform1f(_,S.u_zoom),u_unpack:new E.Uniform4f(_,S.u_unpack)}},line:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels)}},lineGradient:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels),u_image:new E.Uniform1i(_,S.u_image),u_image_height:new E.Uniform1f(_,S.u_image_height)}},linePattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_texsize:new E.Uniform2f(_,S.u_texsize),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_image:new E.Uniform1i(_,S.u_image),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade)}},lineSDF:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels),u_patternscale_a:new E.Uniform2f(_,S.u_patternscale_a),u_patternscale_b:new E.Uniform2f(_,S.u_patternscale_b),u_sdfgamma:new E.Uniform1f(_,S.u_sdfgamma),u_image:new E.Uniform1i(_,S.u_image),u_tex_y_a:new E.Uniform1f(_,S.u_tex_y_a),u_tex_y_b:new E.Uniform1f(_,S.u_tex_y_b),u_mix:new E.Uniform1f(_,S.u_mix)}},raster:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_tl_parent:new E.Uniform2f(_,S.u_tl_parent),u_scale_parent:new E.Uniform1f(_,S.u_scale_parent),u_buffer_scale:new E.Uniform1f(_,S.u_buffer_scale),u_fade_t:new E.Uniform1f(_,S.u_fade_t),u_opacity:new E.Uniform1f(_,S.u_opacity),u_image0:new E.Uniform1i(_,S.u_image0),u_image1:new E.Uniform1i(_,S.u_image1),u_brightness_low:new E.Uniform1f(_,S.u_brightness_low),u_brightness_high:new E.Uniform1f(_,S.u_brightness_high),u_saturation_factor:new E.Uniform1f(_,S.u_saturation_factor),u_contrast_factor:new E.Uniform1f(_,S.u_contrast_factor),u_spin_weights:new E.Uniform3f(_,S.u_spin_weights)}},symbolIcon:function(_,S){return{u_is_size_zoom_constant:new E.Uniform1i(_,S.u_is_size_zoom_constant),u_is_size_feature_constant:new E.Uniform1i(_,S.u_is_size_feature_constant),u_size_t:new E.Uniform1f(_,S.u_size_t),u_size:new E.Uniform1f(_,S.u_size),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pitch:new E.Uniform1f(_,S.u_pitch),u_rotate_symbol:new E.Uniform1i(_,S.u_rotate_symbol),u_aspect_ratio:new E.Uniform1f(_,S.u_aspect_ratio),u_fade_change:new E.Uniform1f(_,S.u_fade_change),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_label_plane_matrix:new E.UniformMatrix4f(_,S.u_label_plane_matrix),u_coord_matrix:new E.UniformMatrix4f(_,S.u_coord_matrix),u_is_text:new E.Uniform1i(_,S.u_is_text),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_texsize:new E.Uniform2f(_,S.u_texsize),u_texture:new E.Uniform1i(_,S.u_texture)}},symbolSDF:function(_,S){return{u_is_size_zoom_constant:new E.Uniform1i(_,S.u_is_size_zoom_constant),u_is_size_feature_constant:new E.Uniform1i(_,S.u_is_size_feature_constant),u_size_t:new E.Uniform1f(_,S.u_size_t),u_size:new E.Uniform1f(_,S.u_size),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pitch:new E.Uniform1f(_,S.u_pitch),u_rotate_symbol:new E.Uniform1i(_,S.u_rotate_symbol),u_aspect_ratio:new E.Uniform1f(_,S.u_aspect_ratio),u_fade_change:new E.Uniform1f(_,S.u_fade_change),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_label_plane_matrix:new E.UniformMatrix4f(_,S.u_label_plane_matrix),u_coord_matrix:new E.UniformMatrix4f(_,S.u_coord_matrix),u_is_text:new E.Uniform1i(_,S.u_is_text),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_texsize:new E.Uniform2f(_,S.u_texsize),u_texture:new E.Uniform1i(_,S.u_texture),u_gamma_scale:new E.Uniform1f(_,S.u_gamma_scale),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_is_halo:new E.Uniform1i(_,S.u_is_halo)}},symbolTextAndIcon:function(_,S){return{u_is_size_zoom_constant:new E.Uniform1i(_,S.u_is_size_zoom_constant),u_is_size_feature_constant:new E.Uniform1i(_,S.u_is_size_feature_constant),u_size_t:new E.Uniform1f(_,S.u_size_t),u_size:new E.Uniform1f(_,S.u_size),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pitch:new E.Uniform1f(_,S.u_pitch),u_rotate_symbol:new E.Uniform1i(_,S.u_rotate_symbol),u_aspect_ratio:new E.Uniform1f(_,S.u_aspect_ratio),u_fade_change:new E.Uniform1f(_,S.u_fade_change),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_label_plane_matrix:new E.UniformMatrix4f(_,S.u_label_plane_matrix),u_coord_matrix:new E.UniformMatrix4f(_,S.u_coord_matrix),u_is_text:new E.Uniform1i(_,S.u_is_text),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_texsize:new E.Uniform2f(_,S.u_texsize),u_texsize_icon:new E.Uniform2f(_,S.u_texsize_icon),u_texture:new E.Uniform1i(_,S.u_texture),u_texture_icon:new E.Uniform1i(_,S.u_texture_icon),u_gamma_scale:new E.Uniform1f(_,S.u_gamma_scale),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_is_halo:new E.Uniform1i(_,S.u_is_halo)}},background:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_opacity:new E.Uniform1f(_,S.u_opacity),u_color:new E.UniformColor(_,S.u_color)}},backgroundPattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_opacity:new E.Uniform1f(_,S.u_opacity),u_image:new E.Uniform1i(_,S.u_image),u_pattern_tl_a:new E.Uniform2f(_,S.u_pattern_tl_a),u_pattern_br_a:new E.Uniform2f(_,S.u_pattern_br_a),u_pattern_tl_b:new E.Uniform2f(_,S.u_pattern_tl_b),u_pattern_br_b:new E.Uniform2f(_,S.u_pattern_br_b),u_texsize:new E.Uniform2f(_,S.u_texsize),u_mix:new E.Uniform1f(_,S.u_mix),u_pattern_size_a:new E.Uniform2f(_,S.u_pattern_size_a),u_pattern_size_b:new E.Uniform2f(_,S.u_pattern_size_b),u_scale_a:new E.Uniform1f(_,S.u_scale_a),u_scale_b:new E.Uniform1f(_,S.u_scale_b),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_tile_units_to_pixels:new E.Uniform1f(_,S.u_tile_units_to_pixels)}}};function du(_,S,x,C,k,G,q){for(var he=_.context,je=he.gl,Xe=_.useProgram("collisionBox"),kt=[],jt=0,Yt=0,gn=0;gn<C.length;gn++){var pn=C[gn],Cn=S.getTile(pn),un=Cn.getBucket(x);if(un){var kn=pn.posMatrix;k[0]===0&&k[1]===0||(kn=_.translatePosMatrix(pn.posMatrix,Cn,k,G));var er=q?un.textCollisionBox:un.iconCollisionBox,ur=un.collisionCircleArray;if(ur.length>0){var Cr=E.create(),dr=kn;E.mul(Cr,un.placementInvProjMatrix,_.transform.glCoordMatrix),E.mul(Cr,Cr,un.placementViewportMatrix),kt.push({circleArray:ur,circleOffset:Yt,transform:dr,invTransform:Cr}),Yt=jt+=ur.length/4}er&&Xe.draw(he,je.LINES,tt.disabled,Et.disabled,_.colorModeForRenderPass(),fn.disabled,Mr(kn,_.transform,Cn),x.id,er.layoutVertexBuffer,er.indexBuffer,er.segments,null,_.transform.zoom,null,null,er.collisionVertexBuffer)}}if(q&&kt.length){var Br=_.useProgram("collisionCircle"),ri=new E.StructArrayLayout2f1f2i16;ri.resize(4*jt),ri._trim();for(var Yr=0,wi=0,Hi=kt;wi<Hi.length;wi+=1)for(var Lo=Hi[wi],Fo=0;Fo<Lo.circleArray.length/4;Fo++){var ko=4*Fo,fa=Lo.circleArray[ko+0],Bn=Lo.circleArray[ko+1],qt=Lo.circleArray[ko+2],ua=Lo.circleArray[ko+3];ri.emplace(Yr++,fa,Bn,qt,ua,0),ri.emplace(Yr++,fa,Bn,qt,ua,1),ri.emplace(Yr++,fa,Bn,qt,ua,2),ri.emplace(Yr++,fa,Bn,qt,ua,3)}(!La||La.length<2*jt)&&(La=function(vl){var Fc=2*vl,Gl=new E.StructArrayLayout3ui6;Gl.resize(Fc),Gl._trim();for(var bs=0;bs<Fc;bs++){var Qs=6*bs;Gl.uint16[Qs+0]=4*bs+0,Gl.uint16[Qs+1]=4*bs+1,Gl.uint16[Qs+2]=4*bs+2,Gl.uint16[Qs+3]=4*bs+2,Gl.uint16[Qs+4]=4*bs+3,Gl.uint16[Qs+5]=4*bs+0}return Gl}(jt));for(var ra=he.createIndexBuffer(La,!0),Ho=he.createVertexBuffer(ri,E.collisionCircleLayout.members,!0),_a=0,Vo=kt;_a<Vo.length;_a+=1){var Do=Vo[_a],hc=ki(Do.transform,Do.invTransform,_.transform);Br.draw(he,je.TRIANGLES,tt.disabled,Et.disabled,_.colorModeForRenderPass(),fn.disabled,hc,x.id,Ho,ra,E.SegmentVector.simpleSegment(0,2*Do.circleOffset,Do.circleArray.length,Do.circleArray.length/2),null,_.transform.zoom,null,null,null)}Ho.destroy(),ra.destroy()}}var Lc=E.identity(new Float32Array(16));function Pf(_,S,x,C,k,G){var q=E.getAnchorAlignment(_),he=-(q.horizontalAlign-.5)*S,je=-(q.verticalAlign-.5)*x,Xe=E.evaluateVariableOffset(_,C);return new E.Point((he/k+Xe[0])*G,(je/k+Xe[1])*G)}function Hh(_,S,x,C,k,G,q,he,je,Xe,kt){var jt=_.text.placedSymbolArray,Yt=_.text.dynamicLayoutVertexArray,gn=_.icon.dynamicLayoutVertexArray,pn={};Yt.clear();for(var Cn=0;Cn<jt.length;Cn++){var un=jt.get(Cn),kn=un.hidden||!un.crossTileID||_.allowVerticalPlacement&&!un.placedOrientation?null:C[un.crossTileID];if(kn){var er=new E.Point(un.anchorX,un.anchorY),ur=zn(er,x?he:q),Cr=mn(G.cameraToCenterDistance,ur.signedDistanceFromCamera),dr=k.evaluateSizeForFeature(_.textSizeData,Xe,un)*Cr/E.ONE_EM;x&&(dr*=_.tilePixelRatio/je);for(var Br=Pf(kn.anchor,kn.width,kn.height,kn.textOffset,kn.textBoxScale,dr),ri=x?zn(er.add(Br),q).point:ur.point.add(S?Br.rotate(-G.angle):Br),Yr=_.allowVerticalPlacement&&un.placedOrientation===E.WritingMode.vertical?Math.PI/2:0,wi=0;wi<un.numGlyphs;wi++)E.addDynamicAttributes(Yt,ri,Yr);kt&&un.associatedIconIndex>=0&&(pn[un.associatedIconIndex]={shiftedAnchor:ri,angle:Yr})}else Li(un.numGlyphs,Yt)}if(kt){gn.clear();for(var Hi=_.icon.placedSymbolArray,Lo=0;Lo<Hi.length;Lo++){var Fo=Hi.get(Lo);if(Fo.hidden)Li(Fo.numGlyphs,gn);else{var ko=pn[Lo];if(ko)for(var fa=0;fa<Fo.numGlyphs;fa++)E.addDynamicAttributes(gn,ko.shiftedAnchor,ko.angle);else Li(Fo.numGlyphs,gn)}}_.icon.dynamicLayoutVertexBuffer.updateData(gn)}_.text.dynamicLayoutVertexBuffer.updateData(Yt)}function Zh(_,S,x){return x.iconsInText&&S?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function If(_,S,x,C,k,G,q,he,je,Xe,kt,jt){for(var Yt=_.context,gn=Yt.gl,pn=_.transform,Cn=he==="map",un=je==="map",kn=Cn&&x.layout.get("symbol-placement")!=="point",er=Cn&&!un&&!kn,ur=x.layout.get("symbol-sort-key").constantOr(1)!==void 0,Cr=!1,dr=_.depthModeForSublayer(0,tt.ReadOnly),Br=x.layout.get("text-variable-anchor"),ri=[],Yr=0,wi=C;Yr<wi.length;Yr+=1){var Hi=wi[Yr],Lo=S.getTile(Hi),Fo=Lo.getBucket(x);if(Fo){var ko=k?Fo.text:Fo.icon;if(ko&&ko.segments.get().length){var fa=ko.programConfigurations.get(x.id),Bn=k||Fo.sdfIcons,qt=k?Fo.textSizeData:Fo.iconSizeData,ua=un||pn.pitch!==0,ra=_.useProgram(Zh(Bn,k,Fo),fa),Ho=E.evaluateSizeForZoom(qt,pn.zoom),_a=void 0,Vo=[0,0],Do=void 0,hc=void 0,vl=null,Fc=void 0;if(k)Do=Lo.glyphAtlasTexture,hc=gn.LINEAR,_a=Lo.glyphAtlasTexture.size,Fo.iconsInText&&(Vo=Lo.imageAtlasTexture.size,vl=Lo.imageAtlasTexture,Fc=ua||_.options.rotating||_.options.zooming||qt.kind==="composite"||qt.kind==="camera"?gn.LINEAR:gn.NEAREST);else{var Gl=x.layout.get("icon-size").constantOr(0)!==1||Fo.iconsNeedLinear;Do=Lo.imageAtlasTexture,hc=Bn||_.options.rotating||_.options.zooming||Gl||ua?gn.LINEAR:gn.NEAREST,_a=Lo.imageAtlasTexture.size}var bs=Mi(Lo,1,_.transform.zoom),Qs=sn(Hi.posMatrix,un,Cn,_.transform,bs),ll=Ln(Hi.posMatrix,un,Cn,_.transform,bs),gl=Br&&Fo.hasTextData(),_f=x.layout.get("icon-text-fit")!=="none"&&gl&&Fo.hasIconData();kn&&gr(Fo,Hi.posMatrix,_,k,Qs,ll,un,Xe);var al=_.translatePosMatrix(Hi.posMatrix,Lo,G,q),sf=kn||k&&Br||_f?Lc:Qs,Vu=_.translatePosMatrix(ll,Lo,G,q,!0),Vd=Bn&&x.paint.get(k?"text-halo-width":"icon-halo-width").constantOr(1)!==0,kf={program:ra,buffers:ko,uniformValues:Bn?Fo.iconsInText?Fs(qt.kind,Ho,er,un,_,al,sf,Vu,_a,Vo):Ks(qt.kind,Ho,er,un,_,al,sf,Vu,k,_a,!0):Fa(qt.kind,Ho,er,un,_,al,sf,Vu,k,_a),atlasTexture:Do,atlasTextureIcon:vl,atlasInterpolation:hc,atlasInterpolationIcon:Fc,isSDF:Bn,hasHalo:Vd};if(ur&&Fo.canOverlap){Cr=!0;for(var Sh=0,Hd=ko.segments.get();Sh<Hd.length;Sh+=1){var $h=Hd[Sh];ri.push({segments:new E.SegmentVector([$h]),sortKey:$h.sortKey,state:kf})}}else ri.push({segments:ko.segments,sortKey:0,state:kf})}}}Cr&&ri.sort(function(Fl,Hu){return Fl.sortKey-Hu.sortKey});for(var bf=0,Ai=ri;bf<Ai.length;bf+=1){var hl=Ai[bf],ba=hl.state;if(Yt.activeTexture.set(gn.TEXTURE0),ba.atlasTexture.bind(ba.atlasInterpolation,gn.CLAMP_TO_EDGE),ba.atlasTextureIcon&&(Yt.activeTexture.set(gn.TEXTURE1),ba.atlasTextureIcon&&ba.atlasTextureIcon.bind(ba.atlasInterpolationIcon,gn.CLAMP_TO_EDGE)),ba.isSDF){var xs=ba.uniformValues;ba.hasHalo&&(xs.u_is_halo=1,Lu(ba.buffers,hl.segments,x,_,ba.program,dr,kt,jt,xs)),xs.u_is_halo=0}Lu(ba.buffers,hl.segments,x,_,ba.program,dr,kt,jt,ba.uniformValues)}}function Lu(_,S,x,C,k,G,q,he,je){var Xe=C.context;k.draw(Xe,Xe.gl.TRIANGLES,G,q,he,fn.disabled,je,x.id,_.layoutVertexBuffer,_.indexBuffer,S,x.paint,C.transform.zoom,_.programConfigurations.get(x.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function Lf(_,S,x,C,k,G,q){var he,je,Xe,kt,jt,Yt=_.context.gl,gn=x.paint.get("fill-pattern"),pn=gn&&gn.constantOr(1),Cn=x.getCrossfadeParameters();q?(je=pn&&!x.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",he=Yt.LINES):(je=pn?"fillPattern":"fill",he=Yt.TRIANGLES);for(var un=0,kn=C;un<kn.length;un+=1){var er=kn[un],ur=S.getTile(er);if(!pn||ur.patternsLoaded()){var Cr=ur.getBucket(x);if(Cr){var dr=Cr.programConfigurations.get(x.id),Br=_.useProgram(je,dr);pn&&(_.context.activeTexture.set(Yt.TEXTURE0),ur.imageAtlasTexture.bind(Yt.LINEAR,Yt.CLAMP_TO_EDGE),dr.updatePaintBuffers(Cn));var ri=gn.constantOr(null);if(ri&&ur.imageAtlas){var Yr=ur.imageAtlas,wi=Yr.patternPositions[ri.to.toString()],Hi=Yr.patternPositions[ri.from.toString()];wi&&Hi&&dr.setConstantPatternPositions(wi,Hi)}var Lo=_.translatePosMatrix(er.posMatrix,ur,x.paint.get("fill-translate"),x.paint.get("fill-translate-anchor"));if(q){kt=Cr.indexBuffer2,jt=Cr.segments2;var Fo=[Yt.drawingBufferWidth,Yt.drawingBufferHeight];Xe=je==="fillOutlinePattern"&&pn?K(Lo,_,Cn,ur,Fo):dn(Lo,Fo)}else kt=Cr.indexBuffer,jt=Cr.segments,Xe=pn?et(Lo,_,Cn,ur):_e(Lo);Br.draw(_.context,he,k,_.stencilModeForClipping(er),G,fn.disabled,Xe,x.id,Cr.layoutVertexBuffer,kt,jt,x.paint,_.transform.zoom,dr)}}}}function yh(_,S,x,C,k,G,q){for(var he=_.context,je=he.gl,Xe=x.paint.get("fill-extrusion-pattern"),kt=Xe.constantOr(1),jt=x.getCrossfadeParameters(),Yt=x.paint.get("fill-extrusion-opacity"),gn=0,pn=C;gn<pn.length;gn+=1){var Cn=pn[gn],un=S.getTile(Cn),kn=un.getBucket(x);if(kn){var er=kn.programConfigurations.get(x.id),ur=_.useProgram(kt?"fillExtrusionPattern":"fillExtrusion",er);kt&&(_.context.activeTexture.set(je.TEXTURE0),un.imageAtlasTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE),er.updatePaintBuffers(jt));var Cr=Xe.constantOr(null);if(Cr&&un.imageAtlas){var dr=un.imageAtlas,Br=dr.patternPositions[Cr.to.toString()],ri=dr.patternPositions[Cr.from.toString()];Br&&ri&&er.setConstantPatternPositions(Br,ri)}var Yr=_.translatePosMatrix(Cn.posMatrix,un,x.paint.get("fill-extrusion-translate"),x.paint.get("fill-extrusion-translate-anchor")),wi=x.paint.get("fill-extrusion-vertical-gradient"),Hi=kt?ne(Yr,_,wi,Yt,Cn,jt,un):Qf(Yr,_,wi,Yt);ur.draw(he,he.gl.TRIANGLES,k,G,q,fn.backCCW,Hi,x.id,kn.layoutVertexBuffer,kn.indexBuffer,kn.segments,x.paint,_.transform.zoom,er)}}}function Du(_,S,x,C,k,G){var q=_.context,he=q.gl,je=S.fbo;if(je){var Xe=_.useProgram("hillshade");q.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_2D,je.colorAttachment.get());var kt=function(jt,Yt,gn){var pn=gn.paint.get("hillshade-shadow-color"),Cn=gn.paint.get("hillshade-highlight-color"),un=gn.paint.get("hillshade-accent-color"),kn=gn.paint.get("hillshade-illumination-direction")*(Math.PI/180);gn.paint.get("hillshade-illumination-anchor")==="viewport"&&(kn-=jt.transform.angle);var er,ur,Cr,dr=!jt.options.moving;return{u_matrix:jt.transform.calculatePosMatrix(Yt.tileID.toUnwrapped(),dr),u_image:0,u_latrange:(er=Yt.tileID,ur=Math.pow(2,er.canonical.z),Cr=er.canonical.y,[new E.MercatorCoordinate(0,Cr/ur).toLngLat().lat,new E.MercatorCoordinate(0,(Cr+1)/ur).toLngLat().lat]),u_light:[gn.paint.get("hillshade-exaggeration"),kn],u_shadow:pn,u_highlight:Cn,u_accent:un}}(_,S,x);Xe.draw(q,he.TRIANGLES,C,k,G,fn.disabled,kt,x.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}}function P0(_,S,x,C,k,G){var q=_.context,he=q.gl,je=S.dem;if(je&&je.data){var Xe=je.dim,kt=je.stride,jt=je.getPixels();if(q.activeTexture.set(he.TEXTURE1),q.pixelStoreUnpackPremultiplyAlpha.set(!1),S.demTexture=S.demTexture||_.getTileTexture(kt),S.demTexture){var Yt=S.demTexture;Yt.update(jt,{premultiply:!1}),Yt.bind(he.NEAREST,he.CLAMP_TO_EDGE)}else S.demTexture=new E.Texture(q,jt,he.RGBA,{premultiply:!1}),S.demTexture.bind(he.NEAREST,he.CLAMP_TO_EDGE);q.activeTexture.set(he.TEXTURE0);var gn=S.fbo;if(!gn){var pn=new E.Texture(q,{width:Xe,height:Xe,data:null},he.RGBA);pn.bind(he.LINEAR,he.CLAMP_TO_EDGE),(gn=S.fbo=q.createFramebuffer(Xe,Xe,!0)).colorAttachment.set(pn.texture)}q.bindFramebuffer.set(gn.framebuffer),q.viewport.set([0,0,Xe,Xe]),_.useProgram("hillshadePrepare").draw(q,he.TRIANGLES,C,k,G,fn.disabled,function(Cn,un){var kn=un.stride,er=E.create();return E.ortho(er,0,E.EXTENT,-E.EXTENT,0,0,1),E.translate(er,er,[0,-E.EXTENT,0]),{u_matrix:er,u_image:1,u_dimension:[kn,kn],u_zoom:Cn.overscaledZ,u_unpack:un.getUnpackVector()}}(S.tileID,je),x.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),S.needsHillshadePrepare=!1}}function bd(_,S,x,C,k){var G=C.paint.get("raster-fade-duration");if(G>0){var q=E.browser.now(),he=(q-_.timeAdded)/G,je=S?(q-S.timeAdded)/G:-1,Xe=x.getSource(),kt=k.coveringZoomLevel({tileSize:Xe.tileSize,roundZoom:Xe.roundZoom}),jt=!S||Math.abs(S.tileID.overscaledZ-kt)>Math.abs(_.tileID.overscaledZ-kt),Yt=jt&&_.refreshedUponExpiration?1:E.clamp(jt?he:1-je,0,1);return _.refreshedUponExpiration&&he>=1&&(_.refreshedUponExpiration=!1),S?{opacity:1,mix:1-Yt}:{opacity:Yt,mix:0}}return{opacity:1,mix:0}}var Dc=new E.Color(1,0,0,1),Wh=new E.Color(0,1,0,1),gp=new E.Color(0,0,1,1),Gh=new E.Color(1,0,1,1),_h=new E.Color(0,1,1,1);function Nu(_,S,x,C){Jf(_,0,S+x/2,_.transform.width,x,C)}function Df(_,S,x,C){Jf(_,S-x/2,0,x,_.transform.height,C)}function Jf(_,S,x,C,k,G){var q=_.context,he=q.gl;he.enable(he.SCISSOR_TEST),he.scissor(S*E.browser.devicePixelRatio,x*E.browser.devicePixelRatio,C*E.browser.devicePixelRatio,k*E.browser.devicePixelRatio),q.clear({color:G}),he.disable(he.SCISSOR_TEST)}function Yp(_,S,x){var C=_.context,k=C.gl,G=x.posMatrix,q=_.useProgram("debug"),he=tt.disabled,je=Et.disabled,Xe=_.colorModeForRenderPass();C.activeTexture.set(k.TEXTURE0),_.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),q.draw(C,k.LINE_STRIP,he,je,Xe,fn.disabled,ti(G,E.Color.red),"$debug",_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments);var kt=S.getTileByID(x.key).latestRawTileData,jt=Math.floor((kt&&kt.byteLength||0)/1024),Yt=S.getTile(x).tileSize,gn=512/Math.min(Yt,512)*(x.overscaledZ/_.transform.zoom)*.5,pn=x.canonical.toString();x.overscaledZ!==x.canonical.z&&(pn+=" => "+x.overscaledZ),function(Cn,un){Cn.initDebugOverlayCanvas();var kn=Cn.debugOverlayCanvas,er=Cn.context.gl,ur=Cn.debugOverlayCanvas.getContext("2d");ur.clearRect(0,0,kn.width,kn.height),ur.shadowColor="white",ur.shadowBlur=2,ur.lineWidth=1.5,ur.strokeStyle="white",ur.textBaseline="top",ur.font="bold 36px Open Sans, sans-serif",ur.fillText(un,5,5),ur.strokeText(un,5,5),Cn.debugOverlayTexture.update(kn),Cn.debugOverlayTexture.bind(er.LINEAR,er.CLAMP_TO_EDGE)}(_,pn+" "+jt+"kb"),q.draw(C,k.TRIANGLES,he,je,tn.alphaBlended,fn.disabled,ti(G,E.Color.transparent,gn),"$debug",_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments)}var Nf={symbol:function(_,S,x,C,k){if(_.renderPass==="translucent"){var G=Et.disabled,q=_.colorModeForRenderPass();x.layout.get("text-variable-anchor")&&function(he,je,Xe,kt,jt,Yt,gn){for(var pn=je.transform,Cn=jt==="map",un=Yt==="map",kn=0,er=he;kn<er.length;kn+=1){var ur=er[kn],Cr=kt.getTile(ur),dr=Cr.getBucket(Xe);if(dr&&dr.text&&dr.text.segments.get().length){var Br=E.evaluateSizeForZoom(dr.textSizeData,pn.zoom),ri=Mi(Cr,1,je.transform.zoom),Yr=sn(ur.posMatrix,un,Cn,je.transform,ri),wi=Xe.layout.get("icon-text-fit")!=="none"&&dr.hasIconData();if(Br){var Hi=Math.pow(2,pn.zoom-Cr.tileID.overscaledZ);Hh(dr,Cn,un,gn,E.symbolSize,pn,Yr,ur.posMatrix,Hi,Br,wi)}}}}(C,_,x,S,x.layout.get("text-rotation-alignment"),x.layout.get("text-pitch-alignment"),k),x.paint.get("icon-opacity").constantOr(1)!==0&&If(_,S,x,C,!1,x.paint.get("icon-translate"),x.paint.get("icon-translate-anchor"),x.layout.get("icon-rotation-alignment"),x.layout.get("icon-pitch-alignment"),x.layout.get("icon-keep-upright"),G,q),x.paint.get("text-opacity").constantOr(1)!==0&&If(_,S,x,C,!0,x.paint.get("text-translate"),x.paint.get("text-translate-anchor"),x.layout.get("text-rotation-alignment"),x.layout.get("text-pitch-alignment"),x.layout.get("text-keep-upright"),G,q),S.map.showCollisionBoxes&&(du(_,S,x,C,x.paint.get("text-translate"),x.paint.get("text-translate-anchor"),!0),du(_,S,x,C,x.paint.get("icon-translate"),x.paint.get("icon-translate-anchor"),!1))}},circle:function(_,S,x,C){if(_.renderPass==="translucent"){var k=x.paint.get("circle-opacity"),G=x.paint.get("circle-stroke-width"),q=x.paint.get("circle-stroke-opacity"),he=x.layout.get("circle-sort-key").constantOr(1)!==void 0;if(k.constantOr(1)!==0||G.constantOr(1)!==0&&q.constantOr(1)!==0){for(var je=_.context,Xe=je.gl,kt=_.depthModeForSublayer(0,tt.ReadOnly),jt=Et.disabled,Yt=_.colorModeForRenderPass(),gn=[],pn=0;pn<C.length;pn++){var Cn=C[pn],un=S.getTile(Cn),kn=un.getBucket(x);if(kn){var er=kn.programConfigurations.get(x.id),ur={programConfiguration:er,program:_.useProgram("circle",er),layoutVertexBuffer:kn.layoutVertexBuffer,indexBuffer:kn.indexBuffer,uniformValues:rr(_,Cn,un,x)};if(he)for(var Cr=0,dr=kn.segments.get();Cr<dr.length;Cr+=1){var Br=dr[Cr];gn.push({segments:new E.SegmentVector([Br]),sortKey:Br.sortKey,state:ur})}else gn.push({segments:kn.segments,sortKey:0,state:ur})}}he&&gn.sort(function(Lo,Fo){return Lo.sortKey-Fo.sortKey});for(var ri=0,Yr=gn;ri<Yr.length;ri+=1){var wi=Yr[ri],Hi=wi.state;Hi.program.draw(je,Xe.TRIANGLES,kt,jt,Yt,fn.disabled,Hi.uniformValues,x.id,Hi.layoutVertexBuffer,Hi.indexBuffer,wi.segments,x.paint,_.transform.zoom,Hi.programConfiguration)}}}},heatmap:function(_,S,x,C){if(x.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){var k=_.context,G=k.gl,q=Et.disabled,he=new tn([G.ONE,G.ONE],E.Color.transparent,[!0,!0,!0,!0]);(function(gn,pn,Cn){var un=gn.gl;gn.activeTexture.set(un.TEXTURE1),gn.viewport.set([0,0,pn.width/4,pn.height/4]);var kn=Cn.heatmapFbo;if(kn)un.bindTexture(un.TEXTURE_2D,kn.colorAttachment.get()),gn.bindFramebuffer.set(kn.framebuffer);else{var er=un.createTexture();un.bindTexture(un.TEXTURE_2D,er),un.texParameteri(un.TEXTURE_2D,un.TEXTURE_WRAP_S,un.CLAMP_TO_EDGE),un.texParameteri(un.TEXTURE_2D,un.TEXTURE_WRAP_T,un.CLAMP_TO_EDGE),un.texParameteri(un.TEXTURE_2D,un.TEXTURE_MIN_FILTER,un.LINEAR),un.texParameteri(un.TEXTURE_2D,un.TEXTURE_MAG_FILTER,un.LINEAR),kn=Cn.heatmapFbo=gn.createFramebuffer(pn.width/4,pn.height/4,!1),function(ur,Cr,dr,Br){var ri=ur.gl;ri.texImage2D(ri.TEXTURE_2D,0,ri.RGBA,Cr.width/4,Cr.height/4,0,ri.RGBA,ur.extRenderToTextureHalfFloat?ur.extTextureHalfFloat.HALF_FLOAT_OES:ri.UNSIGNED_BYTE,null),Br.colorAttachment.set(dr)}(gn,pn,er,kn)}})(k,_,x),k.clear({color:E.Color.transparent});for(var je=0;je<C.length;je++){var Xe=C[je];if(!S.hasRenderableParent(Xe)){var kt=S.getTile(Xe),jt=kt.getBucket(x);if(jt){var Yt=jt.programConfigurations.get(x.id);_.useProgram("heatmap",Yt).draw(k,G.TRIANGLES,tt.disabled,q,he,fn.disabled,lo(Xe.posMatrix,kt,_.transform.zoom,x.paint.get("heatmap-intensity")),x.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,x.paint,_.transform.zoom,Yt)}}}k.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(gn,pn){var Cn=gn.context,un=Cn.gl,kn=pn.heatmapFbo;if(kn){Cn.activeTexture.set(un.TEXTURE0),un.bindTexture(un.TEXTURE_2D,kn.colorAttachment.get()),Cn.activeTexture.set(un.TEXTURE1);var er=pn.colorRampTexture;er||(er=pn.colorRampTexture=new E.Texture(Cn,pn.colorRamp,un.RGBA)),er.bind(un.LINEAR,un.CLAMP_TO_EDGE),gn.useProgram("heatmapTexture").draw(Cn,un.TRIANGLES,tt.disabled,Et.disabled,gn.colorModeForRenderPass(),fn.disabled,function(ur,Cr,dr,Br){var ri=E.create();E.ortho(ri,0,ur.width,ur.height,0,0,1);var Yr=ur.context.gl;return{u_matrix:ri,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Cr.paint.get("heatmap-opacity")}}(gn,pn),pn.id,gn.viewportBuffer,gn.quadTriangleIndexBuffer,gn.viewportSegments,pn.paint,gn.transform.zoom)}}(_,x))},line:function(_,S,x,C){if(_.renderPass==="translucent"){var k=x.paint.get("line-opacity"),G=x.paint.get("line-width");if(k.constantOr(1)!==0&&G.constantOr(1)!==0)for(var q=_.depthModeForSublayer(0,tt.ReadOnly),he=_.colorModeForRenderPass(),je=x.paint.get("line-dasharray"),Xe=x.paint.get("line-pattern"),kt=Xe.constantOr(1),jt=x.paint.get("line-gradient"),Yt=x.getCrossfadeParameters(),gn=kt?"linePattern":je?"lineSDF":jt?"lineGradient":"line",pn=_.context,Cn=pn.gl,un=!0,kn=0,er=C;kn<er.length;kn+=1){var ur=er[kn],Cr=S.getTile(ur);if(!kt||Cr.patternsLoaded()){var dr=Cr.getBucket(x);if(dr){var Br=dr.programConfigurations.get(x.id),ri=_.context.program.get(),Yr=_.useProgram(gn,Br),wi=un||Yr.program!==ri,Hi=Xe.constantOr(null);if(Hi&&Cr.imageAtlas){var Lo=Cr.imageAtlas,Fo=Lo.patternPositions[Hi.to.toString()],ko=Lo.patternPositions[Hi.from.toString()];Fo&&ko&&Br.setConstantPatternPositions(Fo,ko)}var fa=kt?xa(_,Cr,x,Yt):je?Qa(_,Cr,x,je,Yt):jt?Io(_,Cr,x,dr.lineClipsArray.length):ca(_,Cr,x);if(kt)pn.activeTexture.set(Cn.TEXTURE0),Cr.imageAtlasTexture.bind(Cn.LINEAR,Cn.CLAMP_TO_EDGE),Br.updatePaintBuffers(Yt);else if(je&&(wi||_.lineAtlas.dirty))pn.activeTexture.set(Cn.TEXTURE0),_.lineAtlas.bind(pn);else if(jt){var Bn=dr.gradients[x.id],qt=Bn.texture;if(x.gradientVersion!==Bn.version){var ua=256;if(x.stepInterpolant){var ra=S.getSource().maxzoom,Ho=ur.canonical.z===ra?Math.ceil(1<<_.transform.maxZoom-ur.canonical.z):1;ua=E.clamp(E.nextPowerOfTwo(dr.maxLineLength/E.EXTENT*1024*Ho),256,pn.maxTextureSize)}Bn.gradient=E.renderColorRamp({expression:x.gradientExpression(),evaluationKey:"lineProgress",resolution:ua,image:Bn.gradient||void 0,clips:dr.lineClipsArray}),Bn.texture?Bn.texture.update(Bn.gradient):Bn.texture=new E.Texture(pn,Bn.gradient,Cn.RGBA),Bn.version=x.gradientVersion,qt=Bn.texture}pn.activeTexture.set(Cn.TEXTURE0),qt.bind(x.stepInterpolant?Cn.NEAREST:Cn.LINEAR,Cn.CLAMP_TO_EDGE)}Yr.draw(pn,Cn.TRIANGLES,q,_.stencilModeForClipping(ur),he,fn.disabled,fa,x.id,dr.layoutVertexBuffer,dr.indexBuffer,dr.segments,x.paint,_.transform.zoom,Br,dr.layoutVertexBuffer2),un=!1}}}}},fill:function(_,S,x,C){var k=x.paint.get("fill-color"),G=x.paint.get("fill-opacity");if(G.constantOr(1)!==0){var q=_.colorModeForRenderPass(),he=x.paint.get("fill-pattern"),je=_.opaquePassEnabledForLayer()&&!he.constantOr(1)&&k.constantOr(E.Color.transparent).a===1&&G.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===je){var Xe=_.depthModeForSublayer(1,_.renderPass==="opaque"?tt.ReadWrite:tt.ReadOnly);Lf(_,S,x,C,Xe,q,!1)}if(_.renderPass==="translucent"&&x.paint.get("fill-antialias")){var kt=_.depthModeForSublayer(x.getPaintProperty("fill-outline-color")?2:0,tt.ReadOnly);Lf(_,S,x,C,kt,q,!0)}}},"fill-extrusion":function(_,S,x,C){var k=x.paint.get("fill-extrusion-opacity");if(k!==0&&_.renderPass==="translucent"){var G=new tt(_.context.gl.LEQUAL,tt.ReadWrite,_.depthRangeFor3D);if(k!==1||x.paint.get("fill-extrusion-pattern").constantOr(1))yh(_,S,x,C,G,Et.disabled,tn.disabled),yh(_,S,x,C,G,_.stencilModeFor3D(),_.colorModeForRenderPass());else{var q=_.colorModeForRenderPass();yh(_,S,x,C,G,Et.disabled,q)}}},hillshade:function(_,S,x,C){if(_.renderPass==="offscreen"||_.renderPass==="translucent"){for(var k=_.context,G=_.depthModeForSublayer(0,tt.ReadOnly),q=_.colorModeForRenderPass(),he=_.renderPass==="translucent"?_.stencilConfigForOverlap(C):[{},C],je=he[0],Xe=0,kt=he[1];Xe<kt.length;Xe+=1){var jt=kt[Xe],Yt=S.getTile(jt);Yt.needsHillshadePrepare&&_.renderPass==="offscreen"?P0(_,Yt,x,G,Et.disabled,q):_.renderPass==="translucent"&&Du(_,Yt,x,G,je[jt.overscaledZ],q)}k.viewport.set([0,0,_.width,_.height])}},raster:function(_,S,x,C){if(_.renderPass==="translucent"&&x.paint.get("raster-opacity")!==0&&C.length)for(var k=_.context,G=k.gl,q=S.getSource(),he=_.useProgram("raster"),je=_.colorModeForRenderPass(),Xe=q instanceof Ot?[{},C]:_.stencilConfigForOverlap(C),kt=Xe[0],jt=Xe[1],Yt=jt[jt.length-1].overscaledZ,gn=!_.options.moving,pn=0,Cn=jt;pn<Cn.length;pn+=1){var un=Cn[pn],kn=_.depthModeForSublayer(un.overscaledZ-Yt,x.paint.get("raster-opacity")===1?tt.ReadWrite:tt.ReadOnly,G.LESS),er=S.getTile(un),ur=_.transform.calculatePosMatrix(un.toUnwrapped(),gn);er.registerFadeDuration(x.paint.get("raster-fade-duration"));var Cr=S.findLoadedParent(un,0),dr=bd(er,Cr,S,x,_.transform),Br=void 0,ri=void 0,Yr=x.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;k.activeTexture.set(G.TEXTURE0),er.texture.bind(Yr,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(G.TEXTURE1),Cr?(Cr.texture.bind(Yr,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),Br=Math.pow(2,Cr.tileID.overscaledZ-er.tileID.overscaledZ),ri=[er.tileID.canonical.x*Br%1,er.tileID.canonical.y*Br%1]):er.texture.bind(Yr,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST);var wi=hs(ur,ri||[0,0],Br||1,dr,x);q instanceof Ot?he.draw(k,G.TRIANGLES,kn,Et.disabled,je,fn.disabled,wi,x.id,q.boundsBuffer,_.quadTriangleIndexBuffer,q.boundsSegments):he.draw(k,G.TRIANGLES,kn,kt[un.overscaledZ],je,fn.disabled,wi,x.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}},background:function(_,S,x){var C=x.paint.get("background-color"),k=x.paint.get("background-opacity");if(k!==0){var G=_.context,q=G.gl,he=_.transform,je=he.tileSize,Xe=x.paint.get("background-pattern");if(!_.isPatternMissing(Xe)){var kt=!Xe&&C.a===1&&k===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass===kt){var jt=Et.disabled,Yt=_.depthModeForSublayer(0,kt==="opaque"?tt.ReadWrite:tt.ReadOnly),gn=_.colorModeForRenderPass(),pn=_.useProgram(Xe?"backgroundPattern":"background"),Cn=he.coveringTiles({tileSize:je});Xe&&(G.activeTexture.set(q.TEXTURE0),_.imageManager.bind(_.context));for(var un=x.getCrossfadeParameters(),kn=0,er=Cn;kn<er.length;kn+=1){var ur=er[kn],Cr=_.transform.calculatePosMatrix(ur.toUnwrapped()),dr=Xe?is(Cr,k,_,Xe,{tileID:ur,tileSize:je},un):Ec(Cr,k,C);pn.draw(G,q.TRIANGLES,Yt,jt,gn,fn.disabled,dr,x.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}}}},debug:function(_,S,x){for(var C=0;C<x.length;C++)Yp(_,S,x[C])},custom:function(_,S,x){var C=_.context,k=x.implementation;if(_.renderPass==="offscreen"){var G=k.prerender;G&&(_.setCustomLayerDefaults(),C.setColorMode(_.colorModeForRenderPass()),G.call(k,C.gl,_.transform.customLayerMatrix()),C.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),C.setColorMode(_.colorModeForRenderPass()),C.setStencilMode(Et.disabled);var q=k.renderingMode==="3d"?new tt(_.context.gl.LEQUAL,tt.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,tt.ReadOnly);C.setDepthMode(q),k.render(C.gl,_.transform.customLayerMatrix()),C.setDirty(),_.setBaseState(),C.bindFramebuffer.set(null)}}},Ja=function(_,S){this.context=new _t(_),this.transform=S,this._tileTextures={},this.setup(),this.numSublayers=en.maxUnderzooming+en.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Mf,this.gpuTimers={}};Ja.prototype.resize=function(_,S){if(this.width=_*E.browser.devicePixelRatio,this.height=S*E.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var x=0,C=this.style._order;x<C.length;x+=1)this.style._layers[C[x]].resize()},Ja.prototype.setup=function(){var _=this.context,S=new E.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(E.EXTENT,0),S.emplaceBack(0,E.EXTENT),S.emplaceBack(E.EXTENT,E.EXTENT),this.tileExtentBuffer=_.createVertexBuffer(S,Xs.members),this.tileExtentSegments=E.SegmentVector.simpleSegment(0,0,4,2);var x=new E.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(E.EXTENT,0),x.emplaceBack(0,E.EXTENT),x.emplaceBack(E.EXTENT,E.EXTENT),this.debugBuffer=_.createVertexBuffer(x,Xs.members),this.debugSegments=E.SegmentVector.simpleSegment(0,0,4,5);var C=new E.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(E.EXTENT,0,E.EXTENT,0),C.emplaceBack(0,E.EXTENT,0,E.EXTENT),C.emplaceBack(E.EXTENT,E.EXTENT,E.EXTENT,E.EXTENT),this.rasterBoundsBuffer=_.createVertexBuffer(C,$e.members),this.rasterBoundsSegments=E.SegmentVector.simpleSegment(0,0,4,2);var k=new E.StructArrayLayout2i4;k.emplaceBack(0,0),k.emplaceBack(1,0),k.emplaceBack(0,1),k.emplaceBack(1,1),this.viewportBuffer=_.createVertexBuffer(k,Xs.members),this.viewportSegments=E.SegmentVector.simpleSegment(0,0,4,2);var G=new E.StructArrayLayout1ui2;G.emplaceBack(0),G.emplaceBack(1),G.emplaceBack(3),G.emplaceBack(2),G.emplaceBack(0),this.tileBorderIndexBuffer=_.createIndexBuffer(G);var q=new E.StructArrayLayout3ui6;q.emplaceBack(0,1,2),q.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=_.createIndexBuffer(q),this.emptyTexture=new E.Texture(_,{width:1,height:1,data:new Uint8Array([0,0,0,0])},_.gl.RGBA);var he=this.context.gl;this.stencilClearMode=new Et({func:he.ALWAYS,mask:0},0,255,he.ZERO,he.ZERO,he.ZERO)},Ja.prototype.clearStencil=function(){var _=this.context,S=_.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var x=E.create();E.ortho(x,0,this.width,this.height,0,0,1),E.scale(x,x,[S.drawingBufferWidth,S.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(_,S.TRIANGLES,tt.disabled,this.stencilClearMode,tn.disabled,fn.disabled,uo(x),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ja.prototype._renderTileClippingMasks=function(_,S){if(this.currentStencilSource!==_.source&&_.isTileClipped()&&S&&S.length){this.currentStencilSource=_.source;var x=this.context,C=x.gl;this.nextStencilID+S.length>256&&this.clearStencil(),x.setColorMode(tn.disabled),x.setDepthMode(tt.disabled);var k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var G=0,q=S;G<q.length;G+=1){var he=q[G],je=this._tileClippingMaskIDs[he.key]=this.nextStencilID++;k.draw(x,C.TRIANGLES,tt.disabled,new Et({func:C.ALWAYS,mask:0},je,255,C.KEEP,C.KEEP,C.REPLACE),tn.disabled,fn.disabled,uo(he.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ja.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var _=this.nextStencilID++,S=this.context.gl;return new Et({func:S.NOTEQUAL,mask:255},_,255,S.KEEP,S.KEEP,S.REPLACE)},Ja.prototype.stencilModeForClipping=function(_){var S=this.context.gl;return new Et({func:S.EQUAL,mask:255},this._tileClippingMaskIDs[_.key],0,S.KEEP,S.KEEP,S.REPLACE)},Ja.prototype.stencilConfigForOverlap=function(_){var S,x=this.context.gl,C=_.sort(function(je,Xe){return Xe.overscaledZ-je.overscaledZ}),k=C[C.length-1].overscaledZ,G=C[0].overscaledZ-k+1;if(G>1){this.currentStencilSource=void 0,this.nextStencilID+G>256&&this.clearStencil();for(var q={},he=0;he<G;he++)q[he+k]=new Et({func:x.GEQUAL,mask:255},he+this.nextStencilID,255,x.KEEP,x.KEEP,x.REPLACE);return this.nextStencilID+=G,[q,C]}return[(S={},S[k]=Et.disabled,S),C]},Ja.prototype.colorModeForRenderPass=function(){var _=this.context.gl;return this._showOverdrawInspector?new tn([_.CONSTANT_COLOR,_.ONE],new E.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?tn.unblended:tn.alphaBlended},Ja.prototype.depthModeForSublayer=function(_,S,x){if(!this.opaquePassEnabledForLayer())return tt.disabled;var C=1-((1+this.currentLayer)*this.numSublayers+_)*this.depthEpsilon;return new tt(x||this.context.gl.LEQUAL,S,[C,C])},Ja.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ja.prototype.render=function(_,S){var x=this;this.style=_,this.options=S,this.lineAtlas=_.lineAtlas,this.imageManager=_.imageManager,this.glyphManager=_.glyphManager,this.symbolFadeChange=_.placement.symbolFadeChange(E.browser.now()),this.imageManager.beginFrame();var C=this.style._order,k=this.style.sourceCaches;for(var G in k){var q=k[G];q.used&&q.prepare(this.context)}var he,je,Xe={},kt={},jt={};for(var Yt in k){var gn=k[Yt];Xe[Yt]=gn.getVisibleCoordinates(),kt[Yt]=Xe[Yt].slice().reverse(),jt[Yt]=gn.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var pn=0;pn<C.length;pn++)if(this.style._layers[C[pn]].is3D()){this.opaquePassCutoff=pn;break}this.renderPass="offscreen";for(var Cn=0,un=C;Cn<un.length;Cn+=1){var kn=this.style._layers[un[Cn]];if(kn.hasOffscreenPass()&&!kn.isHidden(this.transform.zoom)){var er=kt[kn.source];(kn.type==="custom"||er.length)&&this.renderLayer(this,k[kn.source],kn,er)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:S.showOverdrawInspector?E.Color.black:E.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=S.showOverdrawInspector,this.depthRangeFor3D=[0,1-(_._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){var ur=this.style._layers[C[this.currentLayer]],Cr=k[ur.source],dr=Xe[ur.source];this._renderTileClippingMasks(ur,dr),this.renderLayer(this,Cr,ur,dr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){var Br=this.style._layers[C[this.currentLayer]],ri=k[Br.source],Yr=(Br.type==="symbol"?jt:kt)[Br.source];this._renderTileClippingMasks(Br,Xe[Br.source]),this.renderLayer(this,ri,Br,Yr)}this.options.showTileBoundaries&&(E.values(this.style._layers).forEach(function(wi){wi.source&&!wi.isHidden(x.transform.zoom)&&(wi.source!==(je&&je.id)&&(je=x.style.sourceCaches[wi.source]),(!he||he.getSource().maxzoom<je.getSource().maxzoom)&&(he=je))}),he&&Nf.debug(this,he,he.getVisibleCoordinates())),this.options.showPadding&&function(wi){var Hi=wi.transform.padding;Nu(wi,wi.transform.height-(Hi.top||0),3,Dc),Nu(wi,Hi.bottom||0,3,Wh),Df(wi,Hi.left||0,3,gp),Df(wi,wi.transform.width-(Hi.right||0),3,Gh);var Lo=wi.transform.centerPoint;(function(Fo,ko,fa,Bn){Jf(Fo,ko-1,fa-10,2,20,Bn),Jf(Fo,ko-10,fa-1,20,2,Bn)})(wi,Lo.x,wi.transform.height-Lo.y,_h)}(this),this.context.setDefault()},Ja.prototype.renderLayer=function(_,S,x,C){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="custom"||C.length)&&(this.id=x.id,this.gpuTimingStart(x),Nf[x.type](_,S,x,C,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ja.prototype.gpuTimingStart=function(_){if(this.options.gpuTiming){var S=this.context.extTimerQuery,x=this.gpuTimers[_.id];x||(x=this.gpuTimers[_.id]={calls:0,cpuTime:0,query:S.createQueryEXT()}),x.calls++,S.beginQueryEXT(S.TIME_ELAPSED_EXT,x.query)}},Ja.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var _=this.context.extTimerQuery;_.endQueryEXT(_.TIME_ELAPSED_EXT)}},Ja.prototype.collectGpuTimers=function(){var _=this.gpuTimers;return this.gpuTimers={},_},Ja.prototype.queryGpuTimers=function(_){var S={};for(var x in _){var C=_[x],k=this.context.extTimerQuery,G=k.getQueryObjectEXT(C.query,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(C.query),S[x]=G}return S},Ja.prototype.translatePosMatrix=function(_,S,x,C,k){if(!x[0]&&!x[1])return _;var G=k?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(G){var q=Math.sin(G),he=Math.cos(G);x=[x[0]*he-x[1]*q,x[0]*q+x[1]*he]}var je=[k?x[0]:Mi(S,x[0],this.transform.zoom),k?x[1]:Mi(S,x[1],this.transform.zoom),0],Xe=new Float32Array(16);return E.translate(Xe,_,je),Xe},Ja.prototype.saveTileTexture=function(_){var S=this._tileTextures[_.size[0]];S?S.push(_):this._tileTextures[_.size[0]]=[_]},Ja.prototype.getTileTexture=function(_){var S=this._tileTextures[_];return S&&S.length>0?S.pop():null},Ja.prototype.isPatternMissing=function(_){if(!_)return!1;if(!_.from||!_.to)return!0;var S=this.imageManager.getPattern(_.from.toString()),x=this.imageManager.getPattern(_.to.toString());return!S||!x},Ja.prototype.useProgram=function(_,S){this.cache=this.cache||{};var x=""+_+(S?S.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[x]||(this.cache[x]=new ol(this.context,_,jh[_],S,Iu[_],this._showOverdrawInspector)),this.cache[x]},Ja.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ja.prototype.setBaseState=function(){var _=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(_.FUNC_ADD)},Ja.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=E.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new E.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ja.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var xd=function(_,S){this.points=_,this.planes=S};xd.fromInvProjectionMatrix=function(_,S,x){var C=Math.pow(2,x),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(q){return E.transformMat4([],q,_)}).map(function(q){return E.scale$1([],q,1/q[3]/S*C)}),G=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(q){var he=E.sub([],k[q[0]],k[q[1]]),je=E.sub([],k[q[2]],k[q[1]]),Xe=E.normalize([],E.cross([],he,je)),kt=-E.dot(Xe,k[q[1]]);return Xe.concat(kt)});return new xd(k,G)};var pu=function(_,S){this.min=_,this.max=S,this.center=E.scale$2([],E.add([],this.min,this.max),.5)};pu.prototype.quadrant=function(_){for(var S=[_%2==0,_<2],x=E.clone$2(this.min),C=E.clone$2(this.max),k=0;k<S.length;k++)x[k]=S[k]?this.min[k]:this.center[k],C[k]=S[k]?this.center[k]:this.max[k];return C[2]=this.max[2],new pu(x,C)},pu.prototype.distanceX=function(_){return Math.max(Math.min(this.max[0],_[0]),this.min[0])-_[0]},pu.prototype.distanceY=function(_){return Math.max(Math.min(this.max[1],_[1]),this.min[1])-_[1]},pu.prototype.intersects=function(_){for(var S=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],x=!0,C=0;C<_.planes.length;C++){for(var k=_.planes[C],G=0,q=0;q<S.length;q++)G+=E.dot$1(k,S[q])>=0;if(G===0)return 0;G!==S.length&&(x=!1)}if(x)return 2;for(var he=0;he<3;he++){for(var je=Number.MAX_VALUE,Xe=-Number.MAX_VALUE,kt=0;kt<_.points.length;kt++){var jt=_.points[kt][he]-this.min[he];je=Math.min(je,jt),Xe=Math.max(Xe,jt)}if(Xe<0||je>this.max[he]-this.min[he])return 0}return 1};var ue=function(_,S,x,C){if(_===void 0&&(_=0),S===void 0&&(S=0),x===void 0&&(x=0),C===void 0&&(C=0),isNaN(_)||_<0||isNaN(S)||S<0||isNaN(x)||x<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=_,this.bottom=S,this.left=x,this.right=C};ue.prototype.interpolate=function(_,S,x){return S.top!=null&&_.top!=null&&(this.top=E.number(_.top,S.top,x)),S.bottom!=null&&_.bottom!=null&&(this.bottom=E.number(_.bottom,S.bottom,x)),S.left!=null&&_.left!=null&&(this.left=E.number(_.left,S.left,x)),S.right!=null&&_.right!=null&&(this.right=E.number(_.right,S.right,x)),this},ue.prototype.getCenter=function(_,S){var x=E.clamp((this.left+_-this.right)/2,0,_),C=E.clamp((this.top+S-this.bottom)/2,0,S);return new E.Point(x,C)},ue.prototype.equals=function(_){return this.top===_.top&&this.bottom===_.bottom&&this.left===_.left&&this.right===_.right},ue.prototype.clone=function(){return new ue(this.top,this.bottom,this.left,this.right)},ue.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Pe=function(_,S,x,C,k){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=k===void 0||k,this._minZoom=_||0,this._maxZoom=S||22,this._minPitch=x==null?0:x,this._maxPitch=C==null?60:C,this.setMaxBounds(),this.width=0,this.height=0,this._center=new E.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ue,this._posMatrixCache={},this._alignedPosMatrixCache={}},ct={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Pe.prototype.clone=function(){var _=new Pe(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return _.tileSize=this.tileSize,_.latRange=this.latRange,_.width=this.width,_.height=this.height,_._center=this._center,_.zoom=this.zoom,_.angle=this.angle,_._fov=this._fov,_._pitch=this._pitch,_._unmodified=this._unmodified,_._edgeInsets=this._edgeInsets.clone(),_._calcMatrices(),_},ct.minZoom.get=function(){return this._minZoom},ct.minZoom.set=function(_){this._minZoom!==_&&(this._minZoom=_,this.zoom=Math.max(this.zoom,_))},ct.maxZoom.get=function(){return this._maxZoom},ct.maxZoom.set=function(_){this._maxZoom!==_&&(this._maxZoom=_,this.zoom=Math.min(this.zoom,_))},ct.minPitch.get=function(){return this._minPitch},ct.minPitch.set=function(_){this._minPitch!==_&&(this._minPitch=_,this.pitch=Math.max(this.pitch,_))},ct.maxPitch.get=function(){return this._maxPitch},ct.maxPitch.set=function(_){this._maxPitch!==_&&(this._maxPitch=_,this.pitch=Math.min(this.pitch,_))},ct.renderWorldCopies.get=function(){return this._renderWorldCopies},ct.renderWorldCopies.set=function(_){_===void 0?_=!0:_===null&&(_=!1),this._renderWorldCopies=_},ct.worldSize.get=function(){return this.tileSize*this.scale},ct.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ct.size.get=function(){return new E.Point(this.width,this.height)},ct.bearing.get=function(){return-this.angle/Math.PI*180},ct.bearing.set=function(_){var S=-E.wrap(_,-180,180)*Math.PI/180;this.angle!==S&&(this._unmodified=!1,this.angle=S,this._calcMatrices(),this.rotationMatrix=E.create$2(),E.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ct.pitch.get=function(){return this._pitch/Math.PI*180},ct.pitch.set=function(_){var S=E.clamp(_,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==S&&(this._unmodified=!1,this._pitch=S,this._calcMatrices())},ct.fov.get=function(){return this._fov/Math.PI*180},ct.fov.set=function(_){_=Math.max(.01,Math.min(60,_)),this._fov!==_&&(this._unmodified=!1,this._fov=_/180*Math.PI,this._calcMatrices())},ct.zoom.get=function(){return this._zoom},ct.zoom.set=function(_){var S=Math.min(Math.max(_,this.minZoom),this.maxZoom);this._zoom!==S&&(this._unmodified=!1,this._zoom=S,this.scale=this.zoomScale(S),this.tileZoom=Math.floor(S),this.zoomFraction=S-this.tileZoom,this._constrain(),this._calcMatrices())},ct.center.get=function(){return this._center},ct.center.set=function(_){_.lat===this._center.lat&&_.lng===this._center.lng||(this._unmodified=!1,this._center=_,this._constrain(),this._calcMatrices())},ct.padding.get=function(){return this._edgeInsets.toJSON()},ct.padding.set=function(_){this._edgeInsets.equals(_)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,_,1),this._calcMatrices())},ct.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Pe.prototype.isPaddingEqual=function(_){return this._edgeInsets.equals(_)},Pe.prototype.interpolatePadding=function(_,S,x){this._unmodified=!1,this._edgeInsets.interpolate(_,S,x),this._constrain(),this._calcMatrices()},Pe.prototype.coveringZoomLevel=function(_){var S=(_.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/_.tileSize));return Math.max(0,S)},Pe.prototype.getVisibleUnwrappedCoordinates=function(_){var S=[new E.UnwrappedTileID(0,_)];if(this._renderWorldCopies)for(var x=this.pointCoordinate(new E.Point(0,0)),C=this.pointCoordinate(new E.Point(this.width,0)),k=this.pointCoordinate(new E.Point(this.width,this.height)),G=this.pointCoordinate(new E.Point(0,this.height)),q=Math.floor(Math.min(x.x,C.x,k.x,G.x)),he=Math.floor(Math.max(x.x,C.x,k.x,G.x)),je=q-1;je<=he+1;je++)je!==0&&S.push(new E.UnwrappedTileID(je,_));return S},Pe.prototype.coveringTiles=function(_){var S=this.coveringZoomLevel(_),x=S;if(_.minzoom!==void 0&&S<_.minzoom)return[];_.maxzoom!==void 0&&S>_.maxzoom&&(S=_.maxzoom);var C=E.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,S),G=[k*C.x,k*C.y,0],q=xd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,S),he=_.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(he=S);var je=function(wi){return{aabb:new pu([wi*k,0,0],[(wi+1)*k,k,0]),zoom:0,x:0,y:0,wrap:wi,fullyVisible:!1}},Xe=[],kt=[],jt=S,Yt=_.reparseOverscaled?x:S;if(this._renderWorldCopies)for(var gn=1;gn<=3;gn++)Xe.push(je(-gn)),Xe.push(je(gn));for(Xe.push(je(0));Xe.length>0;){var pn=Xe.pop(),Cn=pn.x,un=pn.y,kn=pn.fullyVisible;if(!kn){var er=pn.aabb.intersects(q);if(er===0)continue;kn=er===2}var ur=pn.aabb.distanceX(G),Cr=pn.aabb.distanceY(G),dr=Math.max(Math.abs(ur),Math.abs(Cr));if(pn.zoom===jt||dr>3+(1<<jt-pn.zoom)-2&&pn.zoom>=he)kt.push({tileID:new E.OverscaledTileID(pn.zoom===jt?Yt:pn.zoom,pn.wrap,pn.zoom,Cn,un),distanceSq:E.sqrLen([G[0]-.5-Cn,G[1]-.5-un])});else for(var Br=0;Br<4;Br++){var ri=(Cn<<1)+Br%2,Yr=(un<<1)+(Br>>1);Xe.push({aabb:pn.aabb.quadrant(Br),zoom:pn.zoom+1,x:ri,y:Yr,wrap:pn.wrap,fullyVisible:kn})}}return kt.sort(function(wi,Hi){return wi.distanceSq-Hi.distanceSq}).map(function(wi){return wi.tileID})},Pe.prototype.resize=function(_,S){this.width=_,this.height=S,this.pixelsToGLUnits=[2/_,-2/S],this._constrain(),this._calcMatrices()},ct.unmodified.get=function(){return this._unmodified},Pe.prototype.zoomScale=function(_){return Math.pow(2,_)},Pe.prototype.scaleZoom=function(_){return Math.log(_)/Math.LN2},Pe.prototype.project=function(_){var S=E.clamp(_.lat,-this.maxValidLatitude,this.maxValidLatitude);return new E.Point(E.mercatorXfromLng(_.lng)*this.worldSize,E.mercatorYfromLat(S)*this.worldSize)},Pe.prototype.unproject=function(_){return new E.MercatorCoordinate(_.x/this.worldSize,_.y/this.worldSize).toLngLat()},ct.point.get=function(){return this.project(this.center)},Pe.prototype.setLocationAtPoint=function(_,S){var x=this.pointCoordinate(S),C=this.pointCoordinate(this.centerPoint),k=this.locationCoordinate(_),G=new E.MercatorCoordinate(k.x-(x.x-C.x),k.y-(x.y-C.y));this.center=this.coordinateLocation(G),this._renderWorldCopies&&(this.center=this.center.wrap())},Pe.prototype.locationPoint=function(_){return this.coordinatePoint(this.locationCoordinate(_))},Pe.prototype.pointLocation=function(_){return this.coordinateLocation(this.pointCoordinate(_))},Pe.prototype.locationCoordinate=function(_){return E.MercatorCoordinate.fromLngLat(_)},Pe.prototype.coordinateLocation=function(_){return _.toLngLat()},Pe.prototype.pointCoordinate=function(_){var S=[_.x,_.y,0,1],x=[_.x,_.y,1,1];E.transformMat4(S,S,this.pixelMatrixInverse),E.transformMat4(x,x,this.pixelMatrixInverse);var C=S[3],k=x[3],G=S[1]/C,q=x[1]/k,he=S[2]/C,je=x[2]/k,Xe=he===je?0:(0-he)/(je-he);return new E.MercatorCoordinate(E.number(S[0]/C,x[0]/k,Xe)/this.worldSize,E.number(G,q,Xe)/this.worldSize)},Pe.prototype.coordinatePoint=function(_){var S=[_.x*this.worldSize,_.y*this.worldSize,0,1];return E.transformMat4(S,S,this.pixelMatrix),new E.Point(S[0]/S[3],S[1]/S[3])},Pe.prototype.getBounds=function(){return new E.LngLatBounds().extend(this.pointLocation(new E.Point(0,0))).extend(this.pointLocation(new E.Point(this.width,0))).extend(this.pointLocation(new E.Point(this.width,this.height))).extend(this.pointLocation(new E.Point(0,this.height)))},Pe.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new E.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Pe.prototype.setMaxBounds=function(_){_?(this.lngRange=[_.getWest(),_.getEast()],this.latRange=[_.getSouth(),_.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Pe.prototype.calculatePosMatrix=function(_,S){S===void 0&&(S=!1);var x=_.key,C=S?this._alignedPosMatrixCache:this._posMatrixCache;if(C[x])return C[x];var k=_.canonical,G=this.worldSize/this.zoomScale(k.z),q=k.x+Math.pow(2,k.z)*_.wrap,he=E.identity(new Float64Array(16));return E.translate(he,he,[q*G,k.y*G,0]),E.scale(he,he,[G/E.EXTENT,G/E.EXTENT,1]),E.multiply(he,S?this.alignedProjMatrix:this.projMatrix,he),C[x]=new Float32Array(he),C[x]},Pe.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Pe.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var _,S,x,C,k=-90,G=90,q=-180,he=180,je=this.size,Xe=this._unmodified;if(this.latRange){var kt=this.latRange;k=E.mercatorYfromLat(kt[1])*this.worldSize,_=(G=E.mercatorYfromLat(kt[0])*this.worldSize)-k<je.y?je.y/(G-k):0}if(this.lngRange){var jt=this.lngRange;q=E.mercatorXfromLng(jt[0])*this.worldSize,S=(he=E.mercatorXfromLng(jt[1])*this.worldSize)-q<je.x?je.x/(he-q):0}var Yt=this.point,gn=Math.max(S||0,_||0);if(gn)return this.center=this.unproject(new E.Point(S?(he+q)/2:Yt.x,_?(G+k)/2:Yt.y)),this.zoom+=this.scaleZoom(gn),this._unmodified=Xe,void(this._constraining=!1);if(this.latRange){var pn=Yt.y,Cn=je.y/2;pn-Cn<k&&(C=k+Cn),pn+Cn>G&&(C=G-Cn)}if(this.lngRange){var un=Yt.x,kn=je.x/2;un-kn<q&&(x=q+kn),un+kn>he&&(x=he-kn)}x===void 0&&C===void 0||(this.center=this.unproject(new E.Point(x!==void 0?x:Yt.x,C!==void 0?C:Yt.y))),this._unmodified=Xe,this._constraining=!1}},Pe.prototype._calcMatrices=function(){if(this.height){var _=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var S=Math.PI/2+this._pitch,x=this._fov*(.5+_.y/this.height),C=Math.sin(x)*this.cameraToCenterDistance/Math.sin(E.clamp(Math.PI-S-x,.01,Math.PI-.01)),k=this.point,G=k.x,q=k.y,he=1.01*(Math.cos(Math.PI/2-this._pitch)*C+this.cameraToCenterDistance),je=this.height/50,Xe=new Float64Array(16);E.perspective(Xe,this._fov,this.width/this.height,je,he),Xe[8]=2*-_.x/this.width,Xe[9]=2*_.y/this.height,E.scale(Xe,Xe,[1,-1,1]),E.translate(Xe,Xe,[0,0,-this.cameraToCenterDistance]),E.rotateX(Xe,Xe,this._pitch),E.rotateZ(Xe,Xe,this.angle),E.translate(Xe,Xe,[-G,-q,0]),this.mercatorMatrix=E.scale([],Xe,[this.worldSize,this.worldSize,this.worldSize]),E.scale(Xe,Xe,[1,1,E.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Xe,this.invProjMatrix=E.invert([],this.projMatrix);var kt=this.width%2/2,jt=this.height%2/2,Yt=Math.cos(this.angle),gn=Math.sin(this.angle),pn=G-Math.round(G)+Yt*kt+gn*jt,Cn=q-Math.round(q)+Yt*jt+gn*kt,un=new Float64Array(Xe);if(E.translate(un,un,[pn>.5?pn-1:pn,Cn>.5?Cn-1:Cn,0]),this.alignedProjMatrix=un,Xe=E.create(),E.scale(Xe,Xe,[this.width/2,-this.height/2,1]),E.translate(Xe,Xe,[1,-1,0]),this.labelPlaneMatrix=Xe,Xe=E.create(),E.scale(Xe,Xe,[1,-1,1]),E.translate(Xe,Xe,[-1,-1,0]),E.scale(Xe,Xe,[2/this.width,2/this.height,1]),this.glCoordMatrix=Xe,this.pixelMatrix=E.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Xe=E.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Xe,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Pe.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var _=this.pointCoordinate(new E.Point(0,0)),S=[_.x*this.worldSize,_.y*this.worldSize,0,1];return E.transformMat4(S,S,this.pixelMatrix)[3]/this.cameraToCenterDistance},Pe.prototype.getCameraPoint=function(){var _=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new E.Point(0,_))},Pe.prototype.getCameraQueryGeometry=function(_){var S=this.getCameraPoint();if(_.length===1)return[_[0],S];for(var x=S.x,C=S.y,k=S.x,G=S.y,q=0,he=_;q<he.length;q+=1){var je=he[q];x=Math.min(x,je.x),C=Math.min(C,je.y),k=Math.max(k,je.x),G=Math.max(G,je.y)}return[new E.Point(x,C),new E.Point(k,C),new E.Point(k,G),new E.Point(x,G),new E.Point(x,C)]},Object.defineProperties(Pe.prototype,ct);var Sn=function(_){var S,x,C,k;this._hashName=_&&encodeURIComponent(_),E.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(S=this._updateHashUnthrottled.bind(this),x=!1,C=null,k=function(){C=null,x&&(S(),C=setTimeout(k,300),x=!1)},function(){return x=!0,C||k(),C})};Sn.prototype.addTo=function(_){return this._map=_,E.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Sn.prototype.remove=function(){return E.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Sn.prototype.getHashString=function(_){var S=this._map.getCenter(),x=Math.round(100*this._map.getZoom())/100,C=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,C),G=Math.round(S.lng*k)/k,q=Math.round(S.lat*k)/k,he=this._map.getBearing(),je=this._map.getPitch(),Xe="";if(Xe+=_?"/"+G+"/"+q+"/"+x:x+"/"+q+"/"+G,(he||je)&&(Xe+="/"+Math.round(10*he)/10),je&&(Xe+="/"+Math.round(je)),this._hashName){var kt=this._hashName,jt=!1,Yt=E.window.location.hash.slice(1).split("&").map(function(gn){var pn=gn.split("=")[0];return pn===kt?(jt=!0,pn+"="+Xe):gn}).filter(function(gn){return gn});return jt||Yt.push(kt+"="+Xe),"#"+Yt.join("&")}return"#"+Xe},Sn.prototype._getCurrentHash=function(){var _,S=this,x=E.window.location.hash.replace("#","");return this._hashName?(x.split("&").map(function(C){return C.split("=")}).forEach(function(C){C[0]===S._hashName&&(_=C)}),(_&&_[1]||"").split("/")):x.split("/")},Sn.prototype._onHashChange=function(){var _=this._getCurrentHash();if(_.length>=3&&!_.some(function(x){return isNaN(x)})){var S=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(_[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+_[2],+_[1]],zoom:+_[0],bearing:S,pitch:+(_[4]||0)}),!0}return!1},Sn.prototype._updateHashUnthrottled=function(){var _=E.window.location.href.replace(/(#.+)?$/,this.getHashString());try{E.window.history.replaceState(E.window.history.state,null,_)}catch(S){}};var cr={linearity:.3,easing:E.bezier(0,0,.3,1)},kr=E.extend({deceleration:2500,maxSpeed:1400},cr),gi=E.extend({deceleration:20,maxSpeed:1400},cr),$i=E.extend({deceleration:1e3,maxSpeed:360},cr),pa=E.extend({deceleration:1e3,maxSpeed:90},cr),Ea=function(_){this._map=_,this.clear()};function _s(_,S){(!_.duration||_.duration<S.duration)&&(_.duration=S.duration,_.easing=S.easing)}function za(_,S,x){var C=x.maxSpeed,k=x.linearity,G=x.deceleration,q=E.clamp(_*k/(S/1e3),-C,C),he=Math.abs(q)/(G*k);return{easing:x.easing,duration:1e3*he,amount:q*(he/2)}}Ea.prototype.clear=function(){this._inertiaBuffer=[]},Ea.prototype.record=function(_){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:E.browser.now(),settings:_})},Ea.prototype._drainInertiaBuffer=function(){for(var _=this._inertiaBuffer,S=E.browser.now();_.length>0&&S-_[0].time>160;)_.shift()},Ea.prototype._onMoveEnd=function(_){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var S={zoom:0,bearing:0,pitch:0,pan:new E.Point(0,0),pinchAround:void 0,around:void 0},x=0,C=this._inertiaBuffer;x<C.length;x+=1){var k=C[x].settings;S.zoom+=k.zoomDelta||0,S.bearing+=k.bearingDelta||0,S.pitch+=k.pitchDelta||0,k.panDelta&&S.pan._add(k.panDelta),k.around&&(S.around=k.around),k.pinchAround&&(S.pinchAround=k.pinchAround)}var G=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,q={};if(S.pan.mag()){var he=za(S.pan.mag(),G,E.extend({},kr,_||{}));q.offset=S.pan.mult(he.amount/S.pan.mag()),q.center=this._map.transform.center,_s(q,he)}if(S.zoom){var je=za(S.zoom,G,gi);q.zoom=this._map.transform.zoom+je.amount,_s(q,je)}if(S.bearing){var Xe=za(S.bearing,G,$i);q.bearing=this._map.transform.bearing+E.clamp(Xe.amount,-179,179),_s(q,Xe)}if(S.pitch){var kt=za(S.pitch,G,pa);q.pitch=this._map.transform.pitch+kt.amount,_s(q,kt)}if(q.zoom||q.bearing){var jt=S.pinchAround===void 0?S.around:S.pinchAround;q.around=jt?this._map.unproject(jt):this._map.getCenter()}return this.clear(),E.extend(q,{noMoveStart:!0})}};var ka=function(_){function S(C,k,G,q){q===void 0&&(q={});var he=re.mousePos(k.getCanvasContainer(),G),je=k.unproject(he);_.call(this,C,E.extend({point:he,lngLat:je,originalEvent:G},q)),this._defaultPrevented=!1,this.target=k}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={defaultPrevented:{configurable:!0}};return S.prototype.preventDefault=function(){this._defaultPrevented=!0},x.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(S.prototype,x),S}(E.Event),cc=function(_){function S(C,k,G){var q=C==="touchend"?G.changedTouches:G.touches,he=re.touchPos(k.getCanvasContainer(),q),je=he.map(function(jt){return k.unproject(jt)}),Xe=he.reduce(function(jt,Yt,gn,pn){return jt.add(Yt.div(pn.length))},new E.Point(0,0)),kt=k.unproject(Xe);_.call(this,C,{points:he,point:Xe,lngLats:je,lngLat:kt,originalEvent:G}),this._defaultPrevented=!1}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={defaultPrevented:{configurable:!0}};return S.prototype.preventDefault=function(){this._defaultPrevented=!0},x.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(S.prototype,x),S}(E.Event),Bu=function(_){function S(C,k,G){_.call(this,C,{originalEvent:G}),this._defaultPrevented=!1}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={defaultPrevented:{configurable:!0}};return S.prototype.preventDefault=function(){this._defaultPrevented=!0},x.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(S.prototype,x),S}(E.Event),qs=function(_,S){this._map=_,this._clickTolerance=S.clickTolerance};qs.prototype.reset=function(){delete this._mousedownPos},qs.prototype.wheel=function(_){return this._firePreventable(new Bu(_.type,this._map,_))},qs.prototype.mousedown=function(_,S){return this._mousedownPos=S,this._firePreventable(new ka(_.type,this._map,_))},qs.prototype.mouseup=function(_){this._map.fire(new ka(_.type,this._map,_))},qs.prototype.click=function(_,S){this._mousedownPos&&this._mousedownPos.dist(S)>=this._clickTolerance||this._map.fire(new ka(_.type,this._map,_))},qs.prototype.dblclick=function(_){return this._firePreventable(new ka(_.type,this._map,_))},qs.prototype.mouseover=function(_){this._map.fire(new ka(_.type,this._map,_))},qs.prototype.mouseout=function(_){this._map.fire(new ka(_.type,this._map,_))},qs.prototype.touchstart=function(_){return this._firePreventable(new cc(_.type,this._map,_))},qs.prototype.touchmove=function(_){this._map.fire(new cc(_.type,this._map,_))},qs.prototype.touchend=function(_){this._map.fire(new cc(_.type,this._map,_))},qs.prototype.touchcancel=function(_){this._map.fire(new cc(_.type,this._map,_))},qs.prototype._firePreventable=function(_){if(this._map.fire(_),_.defaultPrevented)return{}},qs.prototype.isEnabled=function(){return!0},qs.prototype.isActive=function(){return!1},qs.prototype.enable=function(){},qs.prototype.disable=function(){};var ho=function(_){this._map=_};ho.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ho.prototype.mousemove=function(_){this._map.fire(new ka(_.type,this._map,_))},ho.prototype.mousedown=function(){this._delayContextMenu=!0},ho.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ka("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ho.prototype.contextmenu=function(_){this._delayContextMenu?this._contextMenuEvent=_:this._map.fire(new ka(_.type,this._map,_)),this._map.listens("contextmenu")&&_.preventDefault()},ho.prototype.isEnabled=function(){return!0},ho.prototype.isActive=function(){return!1},ho.prototype.enable=function(){},ho.prototype.disable=function(){};var ru=function(_,S){this._map=_,this._el=_.getCanvasContainer(),this._container=_.getContainer(),this._clickTolerance=S.clickTolerance||1};function Ed(_,S){for(var x={},C=0;C<_.length;C++)x[_[C].identifier]=S[C];return x}ru.prototype.isEnabled=function(){return!!this._enabled},ru.prototype.isActive=function(){return!!this._active},ru.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ru.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ru.prototype.mousedown=function(_,S){this.isEnabled()&&_.shiftKey&&_.button===0&&(re.disableDrag(),this._startPos=this._lastPos=S,this._active=!0)},ru.prototype.mousemoveWindow=function(_,S){if(this._active){var x=S;if(!(this._lastPos.equals(x)||!this._box&&x.dist(this._startPos)<this._clickTolerance)){var C=this._startPos;this._lastPos=x,this._box||(this._box=re.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",_));var k=Math.min(C.x,x.x),G=Math.max(C.x,x.x),q=Math.min(C.y,x.y),he=Math.max(C.y,x.y);re.setTransform(this._box,"translate("+k+"px,"+q+"px)"),this._box.style.width=G-k+"px",this._box.style.height=he-q+"px"}}},ru.prototype.mouseupWindow=function(_,S){var x=this;if(this._active&&_.button===0){var C=this._startPos,k=S;if(this.reset(),re.suppressClick(),C.x!==k.x||C.y!==k.y)return this._map.fire(new E.Event("boxzoomend",{originalEvent:_})),{cameraAnimation:function(G){return G.fitScreenCoordinates(C,k,x._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",_)}},ru.prototype.keydown=function(_){this._active&&_.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",_))},ru.prototype.blur=function(){this.reset()},ru.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(re.remove(this._box),this._box=null),re.enableDrag(),delete this._startPos,delete this._lastPos},ru.prototype._fireEvent=function(_,S){return this._map.fire(new E.Event(_,{originalEvent:S}))};var eh=function(_){this.reset(),this.numTouches=_.numTouches};eh.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},eh.prototype.touchstart=function(_,S,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=_.timeStamp),x.length===this.numTouches&&(this.centroid=function(C){for(var k=new E.Point(0,0),G=0,q=C;G<q.length;G+=1)k._add(q[G]);return k.div(C.length)}(S),this.touches=Ed(x,S)))},eh.prototype.touchmove=function(_,S,x){if(!this.aborted&&this.centroid){var C=Ed(x,S);for(var k in this.touches){var G=C[k];(!G||G.dist(this.touches[k])>30)&&(this.aborted=!0)}}},eh.prototype.touchend=function(_,S,x){if((!this.centroid||_.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){var C=!this.aborted&&this.centroid;if(this.reset(),C)return C}};var ml=function(_){this.singleTap=new eh(_),this.numTaps=_.numTaps,this.reset()};ml.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ml.prototype.touchstart=function(_,S,x){this.singleTap.touchstart(_,S,x)},ml.prototype.touchmove=function(_,S,x){this.singleTap.touchmove(_,S,x)},ml.prototype.touchend=function(_,S,x){var C=this.singleTap.touchend(_,S,x);if(C){var k=_.timeStamp-this.lastTime<500,G=!this.lastTap||this.lastTap.dist(C)<30;if(k&&G||this.reset(),this.count++,this.lastTime=_.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}};var os=function(){this._zoomIn=new ml({numTouches:1,numTaps:2}),this._zoomOut=new ml({numTouches:2,numTaps:1}),this.reset()};os.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},os.prototype.touchstart=function(_,S,x){this._zoomIn.touchstart(_,S,x),this._zoomOut.touchstart(_,S,x)},os.prototype.touchmove=function(_,S,x){this._zoomIn.touchmove(_,S,x),this._zoomOut.touchmove(_,S,x)},os.prototype.touchend=function(_,S,x){var C=this,k=this._zoomIn.touchend(_,S,x),G=this._zoomOut.touchend(_,S,x);return k?(this._active=!0,_.preventDefault(),setTimeout(function(){return C.reset()},0),{cameraAnimation:function(q){return q.easeTo({duration:300,zoom:q.getZoom()+1,around:q.unproject(k)},{originalEvent:_})}}):G?(this._active=!0,_.preventDefault(),setTimeout(function(){return C.reset()},0),{cameraAnimation:function(q){return q.easeTo({duration:300,zoom:q.getZoom()-1,around:q.unproject(G)},{originalEvent:_})}}):void 0},os.prototype.touchcancel=function(){this.reset()},os.prototype.enable=function(){this._enabled=!0},os.prototype.disable=function(){this._enabled=!1,this.reset()},os.prototype.isEnabled=function(){return this._enabled},os.prototype.isActive=function(){return this._active};var yp={0:1,2:2},Ii=function(_){this.reset(),this._clickTolerance=_.clickTolerance||1};Ii.prototype.blur=function(){this.reset()},Ii.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ii.prototype._correctButton=function(_,S){return!1},Ii.prototype._move=function(_,S){return{}},Ii.prototype.mousedown=function(_,S){if(!this._lastPoint){var x=re.mouseButton(_);this._correctButton(_,x)&&(this._lastPoint=S,this._eventButton=x)}},Ii.prototype.mousemoveWindow=function(_,S){var x=this._lastPoint;if(x){if(_.preventDefault(),function(C,k){var G=yp[k];return C.buttons===void 0||(C.buttons&G)!==G}(_,this._eventButton))this.reset();else if(this._moved||!(S.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=S,this._move(x,S)}},Ii.prototype.mouseupWindow=function(_){this._lastPoint&&re.mouseButton(_)===this._eventButton&&(this._moved&&re.suppressClick(),this.reset())},Ii.prototype.enable=function(){this._enabled=!0},Ii.prototype.disable=function(){this._enabled=!1,this.reset()},Ii.prototype.isEnabled=function(){return this._enabled},Ii.prototype.isActive=function(){return this._active};var th=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.mousedown=function(x,C){_.prototype.mousedown.call(this,x,C),this._lastPoint&&(this._active=!0)},S.prototype._correctButton=function(x,C){return C===0&&!x.ctrlKey},S.prototype._move=function(x,C){return{around:C,panDelta:C.sub(x)}},S}(Ii),Sd=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype._correctButton=function(x,C){return C===0&&x.ctrlKey||C===2},S.prototype._move=function(x,C){var k=.8*(C.x-x.x);if(k)return this._active=!0,{bearingDelta:k}},S.prototype.contextmenu=function(x){x.preventDefault()},S}(Ii),$p=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype._correctButton=function(x,C){return C===0&&x.ctrlKey||C===2},S.prototype._move=function(x,C){var k=-.5*(C.y-x.y);if(k)return this._active=!0,{pitchDelta:k}},S.prototype.contextmenu=function(x){x.preventDefault()},S}(Ii),Nc=function(_){this._minTouches=1,this._clickTolerance=_.clickTolerance||1,this.reset()};Nc.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new E.Point(0,0)},Nc.prototype.touchstart=function(_,S,x){return this._calculateTransform(_,S,x)},Nc.prototype.touchmove=function(_,S,x){if(this._active&&!(x.length<this._minTouches))return _.preventDefault(),this._calculateTransform(_,S,x)},Nc.prototype.touchend=function(_,S,x){this._calculateTransform(_,S,x),this._active&&x.length<this._minTouches&&this.reset()},Nc.prototype.touchcancel=function(){this.reset()},Nc.prototype._calculateTransform=function(_,S,x){x.length>0&&(this._active=!0);var C=Ed(x,S),k=new E.Point(0,0),G=new E.Point(0,0),q=0;for(var he in C){var je=C[he],Xe=this._touches[he];Xe&&(k._add(je),G._add(je.sub(Xe)),q++,C[he]=je)}if(this._touches=C,!(q<this._minTouches)&&G.mag()){var kt=G.div(q);if(this._sum._add(kt),!(this._sum.mag()<this._clickTolerance))return{around:k.div(q),panDelta:kt}}},Nc.prototype.enable=function(){this._enabled=!0},Nc.prototype.disable=function(){this._enabled=!1,this.reset()},Nc.prototype.isEnabled=function(){return this._enabled},Nc.prototype.isActive=function(){return this._active};var mu=function(){this.reset()};function _p(_,S,x){for(var C=0;C<_.length;C++)if(_[C].identifier===x)return S[C]}function Kp(_,S){return Math.log(_/S)/Math.LN2}mu.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},mu.prototype._start=function(_){},mu.prototype._move=function(_,S,x){return{}},mu.prototype.touchstart=function(_,S,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([S[0],S[1]]))},mu.prototype.touchmove=function(_,S,x){if(this._firstTwoTouches){_.preventDefault();var C=this._firstTwoTouches,k=C[1],G=_p(x,S,C[0]),q=_p(x,S,k);if(G&&q){var he=this._aroundCenter?null:G.add(q).div(2);return this._move([G,q],he,_)}}},mu.prototype.touchend=function(_,S,x){if(this._firstTwoTouches){var C=this._firstTwoTouches,k=C[1],G=_p(x,S,C[0]),q=_p(x,S,k);G&&q||(this._active&&re.suppressClick(),this.reset())}},mu.prototype.touchcancel=function(){this.reset()},mu.prototype.enable=function(_){this._enabled=!0,this._aroundCenter=!!_&&_.around==="center"},mu.prototype.disable=function(){this._enabled=!1,this.reset()},mu.prototype.isEnabled=function(){return this._enabled},mu.prototype.isActive=function(){return this._active};var Bc=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.reset=function(){_.prototype.reset.call(this),delete this._distance,delete this._startDistance},S.prototype._start=function(x){this._startDistance=this._distance=x[0].dist(x[1])},S.prototype._move=function(x,C){var k=this._distance;if(this._distance=x[0].dist(x[1]),this._active||!(Math.abs(Kp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Kp(this._distance,k),pinchAround:C}},S}(mu);function nh(_,S){return 180*_.angleWith(S)/Math.PI}var Jm=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.reset=function(){_.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},S.prototype._start=function(x){this._startVector=this._vector=x[0].sub(x[1]),this._minDiameter=x[0].dist(x[1])},S.prototype._move=function(x,C){var k=this._vector;if(this._vector=x[0].sub(x[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:nh(this._vector,k),pinchAround:C}},S.prototype._isBelowThreshold=function(x){this._minDiameter=Math.min(this._minDiameter,x.mag());var C=25/(Math.PI*this._minDiameter)*360,k=nh(x,this._startVector);return Math.abs(k)<C},S}(mu);function Td(_){return Math.abs(_.y)>Math.abs(_.x)}var bp=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.reset=function(){_.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},S.prototype._start=function(x){this._lastPoints=x,Td(x[0].sub(x[1]))&&(this._valid=!1)},S.prototype._move=function(x,C,k){var G=x[0].sub(this._lastPoints[0]),q=x[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(G,q,k.timeStamp),this._valid)return this._lastPoints=x,this._active=!0,{pitchDelta:(G.y+q.y)/2*-.5}},S.prototype.gestureBeginsVertically=function(x,C,k){if(this._valid!==void 0)return this._valid;var G=x.mag()>=2,q=C.mag()>=2;if(G||q){if(!G||!q)return this._firstMove===void 0&&(this._firstMove=k),k-this._firstMove<100&&void 0;var he=x.y>0==C.y>0;return Td(x)&&Td(C)&&he}},S}(mu),sm={panStep:100,bearingStep:15,pitchStep:10},Fu=function(){var _=sm;this._panStep=_.panStep,this._bearingStep=_.bearingStep,this._pitchStep=_.pitchStep,this._rotationDisabled=!1};function vu(_){return _*(2-_)}Fu.prototype.blur=function(){this.reset()},Fu.prototype.reset=function(){this._active=!1},Fu.prototype.keydown=function(_){var S=this;if(!(_.altKey||_.ctrlKey||_.metaKey)){var x=0,C=0,k=0,G=0,q=0;switch(_.keyCode){case 61:case 107:case 171:case 187:x=1;break;case 189:case 109:case 173:x=-1;break;case 37:_.shiftKey?C=-1:(_.preventDefault(),G=-1);break;case 39:_.shiftKey?C=1:(_.preventDefault(),G=1);break;case 38:_.shiftKey?k=1:(_.preventDefault(),q=-1);break;case 40:_.shiftKey?k=-1:(_.preventDefault(),q=1);break;default:return}return this._rotationDisabled&&(C=0,k=0),{cameraAnimation:function(he){var je=he.getZoom();he.easeTo({duration:300,easeId:"keyboardHandler",easing:vu,zoom:x?Math.round(je)+x*(_.shiftKey?2:1):je,bearing:he.getBearing()+C*S._bearingStep,pitch:he.getPitch()+k*S._pitchStep,offset:[-G*S._panStep,-q*S._panStep],center:he.getCenter()},{originalEvent:_})}}}},Fu.prototype.enable=function(){this._enabled=!0},Fu.prototype.disable=function(){this._enabled=!1,this.reset()},Fu.prototype.isEnabled=function(){return this._enabled},Fu.prototype.isActive=function(){return this._active},Fu.prototype.disableRotation=function(){this._rotationDisabled=!0},Fu.prototype.enableRotation=function(){this._rotationDisabled=!1};var ya=function(_,S){this._map=_,this._el=_.getCanvasContainer(),this._handler=S,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,E.bindAll(["_onTimeout"],this)};ya.prototype.setZoomRate=function(_){this._defaultZoomRate=_},ya.prototype.setWheelZoomRate=function(_){this._wheelZoomRate=_},ya.prototype.isEnabled=function(){return!!this._enabled},ya.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ya.prototype.isZooming=function(){return!!this._zooming},ya.prototype.enable=function(_){this.isEnabled()||(this._enabled=!0,this._aroundCenter=_&&_.around==="center")},ya.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ya.prototype.wheel=function(_){if(this.isEnabled()){var S=_.deltaMode===E.window.WheelEvent.DOM_DELTA_LINE?40*_.deltaY:_.deltaY,x=E.browser.now(),C=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,S!==0&&S%4.000244140625==0?this._type="wheel":S!==0&&Math.abs(S)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=S,this._timeout=setTimeout(this._onTimeout,40,_)):this._type||(this._type=Math.abs(C*S)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,S+=this._lastValue)),_.shiftKey&&S&&(S/=4),this._type&&(this._lastWheelEvent=_,this._delta-=S,this._active||this._start(_)),_.preventDefault()}},ya.prototype._onTimeout=function(_){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(_)},ya.prototype._start=function(_){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var S=re.mousePos(this._el,_);this._around=E.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(S)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ya.prototype.renderFrame=function(){var _=this;if(this._frameId&&(this._frameId=null,this.isActive())){var S=this._map.transform;if(this._delta!==0){var x=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,C=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&C!==0&&(C=1/C);var k=typeof this._targetZoom=="number"?S.zoomScale(this._targetZoom):S.scale;this._targetZoom=Math.min(S.maxZoom,Math.max(S.minZoom,S.scaleZoom(k*C))),this._type==="wheel"&&(this._startZoom=S.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var G,q=typeof this._targetZoom=="number"?this._targetZoom:S.zoom,he=this._startZoom,je=this._easing,Xe=!1;if(this._type==="wheel"&&he&&je){var kt=Math.min((E.browser.now()-this._lastWheelEventTime)/200,1),jt=je(kt);G=E.number(he,q,jt),kt<1?this._frameId||(this._frameId=!0):Xe=!0}else G=q,Xe=!0;return this._active=!0,Xe&&(this._active=!1,this._finishTimeout=setTimeout(function(){_._zooming=!1,_._handler._triggerRenderFrame(),delete _._targetZoom,delete _._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Xe,zoomDelta:G-S.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ya.prototype._smoothOutEasing=function(_){var S=E.ease;if(this._prevEase){var x=this._prevEase,C=(E.browser.now()-x.start)/x.duration,k=x.easing(C+.01)-x.easing(C),G=.27/Math.sqrt(k*k+1e-4)*.01,q=Math.sqrt(.0729-G*G);S=E.bezier(G,q,.25,1)}return this._prevEase={start:E.browser.now(),duration:_,easing:S},S},ya.prototype.blur=function(){this.reset()},ya.prototype.reset=function(){this._active=!1};var ku=function(_,S){this._clickZoom=_,this._tapZoom=S};ku.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ku.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ku.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ku.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var zu=function(){this.reset()};zu.prototype.reset=function(){this._active=!1},zu.prototype.blur=function(){this.reset()},zu.prototype.dblclick=function(_,S){return _.preventDefault(),{cameraAnimation:function(x){x.easeTo({duration:300,zoom:x.getZoom()+(_.shiftKey?-1:1),around:x.unproject(S)},{originalEvent:_})}}},zu.prototype.enable=function(){this._enabled=!0},zu.prototype.disable=function(){this._enabled=!1,this.reset()},zu.prototype.isEnabled=function(){return this._enabled},zu.prototype.isActive=function(){return this._active};var uc=function(){this._tap=new ml({numTouches:1,numTaps:1}),this.reset()};uc.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},uc.prototype.touchstart=function(_,S,x){this._swipePoint||(this._tapTime&&_.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=S[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(_,S,x))},uc.prototype.touchmove=function(_,S,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;var C=S[0],k=C.y-this._swipePoint.y;return this._swipePoint=C,_.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(_,S,x)},uc.prototype.touchend=function(_,S,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(_,S,x)&&(this._tapTime=_.timeStamp)},uc.prototype.touchcancel=function(){this.reset()},uc.prototype.enable=function(){this._enabled=!0},uc.prototype.disable=function(){this._enabled=!1,this.reset()},uc.prototype.isEnabled=function(){return this._enabled},uc.prototype.isActive=function(){return this._active};var Xh=function(_,S,x){this._el=_,this._mousePan=S,this._touchPan=x};Xh.prototype.enable=function(_){this._inertiaOptions=_||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Xh.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Xh.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Xh.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Wl=function(_,S,x){this._pitchWithRotate=_.pitchWithRotate,this._mouseRotate=S,this._mousePitch=x};Wl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Wl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Wl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Wl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Wc=function(_,S,x,C){this._el=_,this._touchZoom=S,this._touchRotate=x,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0};Wc.prototype.enable=function(_){this._touchZoom.enable(_),this._rotationDisabled||this._touchRotate.enable(_),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Wc.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Wc.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Wc.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Wc.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Wc.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var iu=function(_){return _.zoom||_.drag||_.pitch||_.rotate},xp=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S}(E.Event);function Oo(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}var So=function(_,S){this._map=_,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ea(_),this._bearingSnap=S.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(S),E.bindAll(["handleEvent","handleWindowEvent"],this);var x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[E.window.document,"mousemove",{capture:!0}],[E.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[E.window,"blur",void 0]];for(var C=0,k=this._listeners;C<k.length;C+=1){var G=k[C],q=G[0];re.addEventListener(q,G[1],q===E.window.document?this.handleWindowEvent:this.handleEvent,G[2])}};So.prototype.destroy=function(){for(var _=0,S=this._listeners;_<S.length;_+=1){var x=S[_],C=x[0];re.removeEventListener(C,x[1],C===E.window.document?this.handleWindowEvent:this.handleEvent,x[2])}},So.prototype._addDefaultHandlers=function(_){var S=this._map,x=S.getCanvasContainer();this._add("mapEvent",new qs(S,_));var C=S.boxZoom=new ru(S,_);this._add("boxZoom",C);var k=new os,G=new zu;S.doubleClickZoom=new ku(G,k),this._add("tapZoom",k),this._add("clickZoom",G);var q=new uc;this._add("tapDragZoom",q);var he=S.touchPitch=new bp;this._add("touchPitch",he);var je=new Sd(_),Xe=new $p(_);S.dragRotate=new Wl(_,je,Xe),this._add("mouseRotate",je,["mousePitch"]),this._add("mousePitch",Xe,["mouseRotate"]);var kt=new th(_),jt=new Nc(_);S.dragPan=new Xh(x,kt,jt),this._add("mousePan",kt),this._add("touchPan",jt,["touchZoom","touchRotate"]);var Yt=new Jm,gn=new Bc;S.touchZoomRotate=new Wc(x,gn,Yt,q),this._add("touchRotate",Yt,["touchPan","touchZoom"]),this._add("touchZoom",gn,["touchPan","touchRotate"]);var pn=S.scrollZoom=new ya(S,this);this._add("scrollZoom",pn,["mousePan"]);var Cn=S.keyboard=new Fu;this._add("keyboard",Cn),this._add("blockableMapEvent",new ho(S));for(var un=0,kn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];un<kn.length;un+=1){var er=kn[un];_.interactive&&_[er]&&S[er].enable(_[er])}},So.prototype._add=function(_,S,x){this._handlers.push({handlerName:_,handler:S,allowed:x}),this._handlersById[_]=S},So.prototype.stop=function(_){if(!this._updatingCamera){for(var S=0,x=this._handlers;S<x.length;S+=1)x[S].handler.reset();this._inertia.clear(),this._fireEvents({},{},_),this._changes=[]}},So.prototype.isActive=function(){for(var _=0,S=this._handlers;_<S.length;_+=1)if(S[_].handler.isActive())return!0;return!1},So.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},So.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},So.prototype.isMoving=function(){return!!iu(this._eventsInProgress)||this.isZooming()},So.prototype._blockedByActive=function(_,S,x){for(var C in _)if(C!==x&&(!S||S.indexOf(C)<0))return!0;return!1},So.prototype.handleWindowEvent=function(_){this.handleEvent(_,_.type+"Window")},So.prototype._getMapTouches=function(_){for(var S=[],x=0,C=_;x<C.length;x+=1){var k=C[x];this._el.contains(k.target)&&S.push(k)}return S},So.prototype.handleEvent=function(_,S){this._updatingCamera=!0;for(var x=_.type==="renderFrame"?void 0:_,C={needsRenderFrame:!1},k={},G={},q=_.touches?this._getMapTouches(_.touches):void 0,he=q?re.touchPos(this._el,q):re.mousePos(this._el,_),je=0,Xe=this._handlers;je<Xe.length;je+=1){var kt=Xe[je],jt=kt.handlerName,Yt=kt.handler,gn=kt.allowed;if(Yt.isEnabled()){var pn=void 0;this._blockedByActive(G,gn,jt)?Yt.reset():Yt[S||_.type]&&(pn=Yt[S||_.type](_,he,q),this.mergeHandlerResult(C,k,pn,jt,x),pn&&pn.needsRenderFrame&&this._triggerRenderFrame()),(pn||Yt.isActive())&&(G[jt]=Yt)}}var Cn={};for(var un in this._previousActiveHandlers)G[un]||(Cn[un]=x);this._previousActiveHandlers=G,(Object.keys(Cn).length||Oo(C))&&(this._changes.push([C,k,Cn]),this._triggerRenderFrame()),(Object.keys(G).length||Oo(C))&&this._map._stop(!0),this._updatingCamera=!1;var kn=C.cameraAnimation;kn&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],kn(this._map))},So.prototype.mergeHandlerResult=function(_,S,x,C,k){if(x){E.extend(_,x);var G={handlerName:C,originalEvent:x.originalEvent||k};x.zoomDelta!==void 0&&(S.zoom=G),x.panDelta!==void 0&&(S.drag=G),x.pitchDelta!==void 0&&(S.pitch=G),x.bearingDelta!==void 0&&(S.rotate=G)}},So.prototype._applyChanges=function(){for(var _={},S={},x={},C=0,k=this._changes;C<k.length;C+=1){var G=k[C],q=G[0],he=G[1],je=G[2];q.panDelta&&(_.panDelta=(_.panDelta||new E.Point(0,0))._add(q.panDelta)),q.zoomDelta&&(_.zoomDelta=(_.zoomDelta||0)+q.zoomDelta),q.bearingDelta&&(_.bearingDelta=(_.bearingDelta||0)+q.bearingDelta),q.pitchDelta&&(_.pitchDelta=(_.pitchDelta||0)+q.pitchDelta),q.around!==void 0&&(_.around=q.around),q.pinchAround!==void 0&&(_.pinchAround=q.pinchAround),q.noInertia&&(_.noInertia=q.noInertia),E.extend(S,he),E.extend(x,je)}this._updateMapTransform(_,S,x),this._changes=[]},So.prototype._updateMapTransform=function(_,S,x){var C=this._map,k=C.transform;if(!Oo(_))return this._fireEvents(S,x,!0);var G=_.panDelta,q=_.zoomDelta,he=_.bearingDelta,je=_.pitchDelta,Xe=_.around,kt=_.pinchAround;kt!==void 0&&(Xe=kt),C._stop(!0),Xe=Xe||C.transform.centerPoint;var jt=k.pointLocation(G?Xe.sub(G):Xe);he&&(k.bearing+=he),je&&(k.pitch+=je),q&&(k.zoom+=q),k.setLocationAtPoint(jt,Xe),this._map._update(),_.noInertia||this._inertia.record(_),this._fireEvents(S,x,!0)},So.prototype._fireEvents=function(_,S,x){var C=this,k=iu(this._eventsInProgress),G=iu(_),q={};for(var he in _)this._eventsInProgress[he]||(q[he+"start"]=_[he].originalEvent),this._eventsInProgress[he]=_[he];for(var je in!k&&G&&this._fireEvent("movestart",G.originalEvent),q)this._fireEvent(je,q[je]);for(var Xe in G&&this._fireEvent("move",G.originalEvent),_)this._fireEvent(Xe,_[Xe].originalEvent);var kt,jt={};for(var Yt in this._eventsInProgress){var gn=this._eventsInProgress[Yt],pn=gn.handlerName,Cn=gn.originalEvent;this._handlersById[pn].isActive()||(delete this._eventsInProgress[Yt],jt[Yt+"end"]=kt=S[pn]||Cn)}for(var un in jt)this._fireEvent(un,jt[un]);var kn=iu(this._eventsInProgress);if(x&&(k||G)&&!kn){this._updatingCamera=!0;var er=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ur=function(Cr){return Cr!==0&&-C._bearingSnap<Cr&&Cr<C._bearingSnap};er?(ur(er.bearing||this._map.getBearing())&&(er.bearing=0),this._map.easeTo(er,{originalEvent:kt})):(this._map.fire(new E.Event("moveend",{originalEvent:kt})),ur(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},So.prototype._fireEvent=function(_,S){this._map.fire(new E.Event(_,S?{originalEvent:S}:{}))},So.prototype._requestFrame=function(){var _=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(S){delete _._frameId,_.handleEvent(new xp("renderFrame",{timeStamp:S})),_._applyChanges()})},So.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Uu=function(_){function S(x,C){_.call(this),this._moving=!1,this._zooming=!1,this.transform=x,this._bearingSnap=C.bearingSnap,E.bindAll(["_renderFrameCallback"],this)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getCenter=function(){return new E.LngLat(this.transform.center.lng,this.transform.center.lat)},S.prototype.setCenter=function(x,C){return this.jumpTo({center:x},C)},S.prototype.panBy=function(x,C,k){return x=E.Point.convert(x).mult(-1),this.panTo(this.transform.center,E.extend({offset:x},C),k)},S.prototype.panTo=function(x,C,k){return this.easeTo(E.extend({center:x},C),k)},S.prototype.getZoom=function(){return this.transform.zoom},S.prototype.setZoom=function(x,C){return this.jumpTo({zoom:x},C),this},S.prototype.zoomTo=function(x,C,k){return this.easeTo(E.extend({zoom:x},C),k)},S.prototype.zoomIn=function(x,C){return this.zoomTo(this.getZoom()+1,x,C),this},S.prototype.zoomOut=function(x,C){return this.zoomTo(this.getZoom()-1,x,C),this},S.prototype.getBearing=function(){return this.transform.bearing},S.prototype.setBearing=function(x,C){return this.jumpTo({bearing:x},C),this},S.prototype.getPadding=function(){return this.transform.padding},S.prototype.setPadding=function(x,C){return this.jumpTo({padding:x},C),this},S.prototype.rotateTo=function(x,C,k){return this.easeTo(E.extend({bearing:x},C),k)},S.prototype.resetNorth=function(x,C){return this.rotateTo(0,E.extend({duration:1e3},x),C),this},S.prototype.resetNorthPitch=function(x,C){return this.easeTo(E.extend({bearing:0,pitch:0,duration:1e3},x),C),this},S.prototype.snapToNorth=function(x,C){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(x,C):this},S.prototype.getPitch=function(){return this.transform.pitch},S.prototype.setPitch=function(x,C){return this.jumpTo({pitch:x},C),this},S.prototype.cameraForBounds=function(x,C){x=E.LngLatBounds.convert(x);var k=C&&C.bearing||0;return this._cameraForBoxAndBearing(x.getNorthWest(),x.getSouthEast(),k,C)},S.prototype._cameraForBoxAndBearing=function(x,C,k,G){var q={top:0,bottom:0,right:0,left:0};if(typeof(G=E.extend({padding:q,offset:[0,0],maxZoom:this.transform.maxZoom},G)).padding=="number"){var he=G.padding;G.padding={top:he,bottom:he,right:he,left:he}}G.padding=E.extend(q,G.padding);var je=this.transform,Xe=je.padding,kt=je.project(E.LngLat.convert(x)),jt=je.project(E.LngLat.convert(C)),Yt=kt.rotate(-k*Math.PI/180),gn=jt.rotate(-k*Math.PI/180),pn=new E.Point(Math.max(Yt.x,gn.x),Math.max(Yt.y,gn.y)),Cn=new E.Point(Math.min(Yt.x,gn.x),Math.min(Yt.y,gn.y)),un=pn.sub(Cn),kn=(je.width-(Xe.left+Xe.right+G.padding.left+G.padding.right))/un.x,er=(je.height-(Xe.top+Xe.bottom+G.padding.top+G.padding.bottom))/un.y;if(!(er<0||kn<0)){var ur=Math.min(je.scaleZoom(je.scale*Math.min(kn,er)),G.maxZoom),Cr=typeof G.offset.x=="number"?new E.Point(G.offset.x,G.offset.y):E.Point.convert(G.offset),dr=new E.Point((G.padding.left-G.padding.right)/2,(G.padding.top-G.padding.bottom)/2).rotate(k*Math.PI/180),Br=Cr.add(dr).mult(je.scale/je.zoomScale(ur));return{center:je.unproject(kt.add(jt).div(2).sub(Br)),zoom:ur,bearing:k}}E.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},S.prototype.fitBounds=function(x,C,k){return this._fitInternal(this.cameraForBounds(x,C),C,k)},S.prototype.fitScreenCoordinates=function(x,C,k,G,q){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(E.Point.convert(x)),this.transform.pointLocation(E.Point.convert(C)),k,G),G,q)},S.prototype._fitInternal=function(x,C,k){return x?(delete(C=E.extend(x,C)).padding,C.linear?this.easeTo(C,k):this.flyTo(C,k)):this},S.prototype.jumpTo=function(x,C){this.stop();var k=this.transform,G=!1,q=!1,he=!1;return"zoom"in x&&k.zoom!==+x.zoom&&(G=!0,k.zoom=+x.zoom),x.center!==void 0&&(k.center=E.LngLat.convert(x.center)),"bearing"in x&&k.bearing!==+x.bearing&&(q=!0,k.bearing=+x.bearing),"pitch"in x&&k.pitch!==+x.pitch&&(he=!0,k.pitch=+x.pitch),x.padding==null||k.isPaddingEqual(x.padding)||(k.padding=x.padding),this.fire(new E.Event("movestart",C)).fire(new E.Event("move",C)),G&&this.fire(new E.Event("zoomstart",C)).fire(new E.Event("zoom",C)).fire(new E.Event("zoomend",C)),q&&this.fire(new E.Event("rotatestart",C)).fire(new E.Event("rotate",C)).fire(new E.Event("rotateend",C)),he&&this.fire(new E.Event("pitchstart",C)).fire(new E.Event("pitch",C)).fire(new E.Event("pitchend",C)),this.fire(new E.Event("moveend",C))},S.prototype.easeTo=function(x,C){var k=this;this._stop(!1,x.easeId),((x=E.extend({offset:[0,0],duration:500,easing:E.ease},x)).animate===!1||!x.essential&&E.browser.prefersReducedMotion)&&(x.duration=0);var G=this.transform,q=this.getZoom(),he=this.getBearing(),je=this.getPitch(),Xe=this.getPadding(),kt="zoom"in x?+x.zoom:q,jt="bearing"in x?this._normalizeBearing(x.bearing,he):he,Yt="pitch"in x?+x.pitch:je,gn="padding"in x?x.padding:G.padding,pn=E.Point.convert(x.offset),Cn=G.centerPoint.add(pn),un=G.pointLocation(Cn),kn=E.LngLat.convert(x.center||un);this._normalizeCenter(kn);var er,ur,Cr=G.project(un),dr=G.project(kn).sub(Cr),Br=G.zoomScale(kt-q);x.around&&(er=E.LngLat.convert(x.around),ur=G.locationPoint(er));var ri={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||kt!==q,this._rotating=this._rotating||he!==jt,this._pitching=this._pitching||Yt!==je,this._padding=!G.isPaddingEqual(gn),this._easeId=x.easeId,this._prepareEase(C,x.noMoveStart,ri),this._ease(function(Yr){if(k._zooming&&(G.zoom=E.number(q,kt,Yr)),k._rotating&&(G.bearing=E.number(he,jt,Yr)),k._pitching&&(G.pitch=E.number(je,Yt,Yr)),k._padding&&(G.interpolatePadding(Xe,gn,Yr),Cn=G.centerPoint.add(pn)),er)G.setLocationAtPoint(er,ur);else{var wi=G.zoomScale(G.zoom-q),Hi=kt>q?Math.min(2,Br):Math.max(.5,Br),Lo=Math.pow(Hi,1-Yr),Fo=G.unproject(Cr.add(dr.mult(Yr*Lo)).mult(wi));G.setLocationAtPoint(G.renderWorldCopies?Fo.wrap():Fo,Cn)}k._fireMoveEvents(C)},function(Yr){k._afterEase(C,Yr)},x),this},S.prototype._prepareEase=function(x,C,k){k===void 0&&(k={}),this._moving=!0,C||k.moving||this.fire(new E.Event("movestart",x)),this._zooming&&!k.zooming&&this.fire(new E.Event("zoomstart",x)),this._rotating&&!k.rotating&&this.fire(new E.Event("rotatestart",x)),this._pitching&&!k.pitching&&this.fire(new E.Event("pitchstart",x))},S.prototype._fireMoveEvents=function(x){this.fire(new E.Event("move",x)),this._zooming&&this.fire(new E.Event("zoom",x)),this._rotating&&this.fire(new E.Event("rotate",x)),this._pitching&&this.fire(new E.Event("pitch",x))},S.prototype._afterEase=function(x,C){if(!this._easeId||!C||this._easeId!==C){delete this._easeId;var k=this._zooming,G=this._rotating,q=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,k&&this.fire(new E.Event("zoomend",x)),G&&this.fire(new E.Event("rotateend",x)),q&&this.fire(new E.Event("pitchend",x)),this.fire(new E.Event("moveend",x))}},S.prototype.flyTo=function(x,C){var k=this;if(!x.essential&&E.browser.prefersReducedMotion){var G=E.pick(x,["center","zoom","bearing","pitch","around"]);return this.jumpTo(G,C)}this.stop(),x=E.extend({offset:[0,0],speed:1.2,curve:1.42,easing:E.ease},x);var q=this.transform,he=this.getZoom(),je=this.getBearing(),Xe=this.getPitch(),kt=this.getPadding(),jt="zoom"in x?E.clamp(+x.zoom,q.minZoom,q.maxZoom):he,Yt="bearing"in x?this._normalizeBearing(x.bearing,je):je,gn="pitch"in x?+x.pitch:Xe,pn="padding"in x?x.padding:q.padding,Cn=q.zoomScale(jt-he),un=E.Point.convert(x.offset),kn=q.centerPoint.add(un),er=q.pointLocation(kn),ur=E.LngLat.convert(x.center||er);this._normalizeCenter(ur);var Cr=q.project(er),dr=q.project(ur).sub(Cr),Br=x.curve,ri=Math.max(q.width,q.height),Yr=ri/Cn,wi=dr.mag();if("minZoom"in x){var Hi=E.clamp(Math.min(x.minZoom,he,jt),q.minZoom,q.maxZoom),Lo=ri/q.zoomScale(Hi-he);Br=Math.sqrt(Lo/wi*2)}var Fo=Br*Br;function ko(Vo){var Do=(Yr*Yr-ri*ri+(Vo?-1:1)*Fo*Fo*wi*wi)/(2*(Vo?Yr:ri)*Fo*wi);return Math.log(Math.sqrt(Do*Do+1)-Do)}function fa(Vo){return(Math.exp(Vo)-Math.exp(-Vo))/2}function Bn(Vo){return(Math.exp(Vo)+Math.exp(-Vo))/2}var qt=ko(0),ua=function(Vo){return Bn(qt)/Bn(qt+Br*Vo)},ra=function(Vo){return ri*((Bn(qt)*(fa(Do=qt+Br*Vo)/Bn(Do))-fa(qt))/Fo)/wi;var Do},Ho=(ko(1)-qt)/Br;if(Math.abs(wi)<1e-6||!isFinite(Ho)){if(Math.abs(ri-Yr)<1e-6)return this.easeTo(x,C);var _a=Yr<ri?-1:1;Ho=Math.abs(Math.log(Yr/ri))/Br,ra=function(){return 0},ua=function(Vo){return Math.exp(_a*Br*Vo)}}return x.duration="duration"in x?+x.duration:1e3*Ho/("screenSpeed"in x?+x.screenSpeed/Br:+x.speed),x.maxDuration&&x.duration>x.maxDuration&&(x.duration=0),this._zooming=!0,this._rotating=je!==Yt,this._pitching=gn!==Xe,this._padding=!q.isPaddingEqual(pn),this._prepareEase(C,!1),this._ease(function(Vo){var Do=Vo*Ho,hc=1/ua(Do);q.zoom=Vo===1?jt:he+q.scaleZoom(hc),k._rotating&&(q.bearing=E.number(je,Yt,Vo)),k._pitching&&(q.pitch=E.number(Xe,gn,Vo)),k._padding&&(q.interpolatePadding(kt,pn,Vo),kn=q.centerPoint.add(un));var vl=Vo===1?ur:q.unproject(Cr.add(dr.mult(ra(Do))).mult(hc));q.setLocationAtPoint(q.renderWorldCopies?vl.wrap():vl,kn),k._fireMoveEvents(C)},function(){return k._afterEase(C)},x),this},S.prototype.isEasing=function(){return!!this._easeFrameId},S.prototype.stop=function(){return this._stop()},S.prototype._stop=function(x,C){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var k=this._onEaseEnd;delete this._onEaseEnd,k.call(this,C)}if(!x){var G=this.handlers;G&&G.stop(!1)}return this},S.prototype._ease=function(x,C,k){k.animate===!1||k.duration===0?(x(1),C()):(this._easeStart=E.browser.now(),this._easeOptions=k,this._onEaseFrame=x,this._onEaseEnd=C,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},S.prototype._renderFrameCallback=function(){var x=Math.min((E.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},S.prototype._normalizeBearing=function(x,C){x=E.wrap(x,-180,180);var k=Math.abs(x-C);return Math.abs(x-360-C)<k&&(x-=360),Math.abs(x+360-C)<k&&(x+=360),x},S.prototype._normalizeCenter=function(x){var C=this.transform;if(C.renderWorldCopies&&!C.lngRange){var k=x.lng-C.center.lng;x.lng+=k>180?-360:k<-180?360:0}},S}(E.Evented),ou=function(_){_===void 0&&(_={}),this.options=_,E.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ou.prototype.getDefaultPosition=function(){return"bottom-right"},ou.prototype.onAdd=function(_){var S=this.options&&this.options.compact;return this._map=_,this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=re.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=re.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),S&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),S===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ou.prototype.onRemove=function(){re.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ou.prototype._setElementTitle=function(_,S){var x=this._map._getUIString("AttributionControl."+S);_.title=x,_.setAttribute("aria-label",x)},ou.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ou.prototype._updateEditLink=function(){var _=this._editLink;_||(_=this._editLink=this._container.querySelector(".mapbox-improve-map"));var S=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||E.config.ACCESS_TOKEN}];if(_){var x=S.reduce(function(C,k,G){return k.value&&(C+=k.key+"="+k.value+(G<S.length-1?"&":"")),C},"?");_.href=E.config.FEEDBACK_URL+"/"+x+(this._map._hash?this._map._hash.getHashString(!0):""),_.rel="noopener nofollow",this._setElementTitle(_,"MapFeedback")}},ou.prototype._updateData=function(_){!_||_.sourceDataType!=="metadata"&&_.sourceDataType!=="visibility"&&_.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ou.prototype._updateAttributions=function(){if(this._map.style){var _=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?_=_.concat(this.options.customAttribution.map(function(he){return typeof he!="string"?"":he})):typeof this.options.customAttribution=="string"&&_.push(this.options.customAttribution)),this._map.style.stylesheet){var S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}var x=this._map.style.sourceCaches;for(var C in x){var k=x[C];if(k.used){var G=k.getSource();G.attribution&&_.indexOf(G.attribution)<0&&_.push(G.attribution)}}_.sort(function(he,je){return he.length-je.length});var q=(_=_.filter(function(he,je){for(var Xe=je+1;Xe<_.length;Xe++)if(_[Xe].indexOf(he)>=0)return!1;return!0})).join(" | ");q!==this._attribHTML&&(this._attribHTML=q,_.length?(this._innerContainer.innerHTML=q,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ou.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var rh=function(){E.bindAll(["_updateLogo"],this),E.bindAll(["_updateCompact"],this)};rh.prototype.onAdd=function(_){this._map=_,this._container=re.create("div","mapboxgl-ctrl");var S=re.create("a","mapboxgl-ctrl-logo");return S.target="_blank",S.rel="noopener nofollow",S.href="https://www.mapbox.com/",S.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),S.setAttribute("rel","noopener nofollow"),this._container.appendChild(S),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},rh.prototype.onRemove=function(){re.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},rh.prototype.getDefaultPosition=function(){return"bottom-left"},rh.prototype._updateLogo=function(_){_&&_.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},rh.prototype._logoRequired=function(){if(this._map.style){var _=this._map.style.sourceCaches;for(var S in _)if(_[S].getSource().mapbox_logo)return!0;return!1}},rh.prototype._updateCompact=function(){var _=this._container.children;if(_.length){var S=_[0];this._map.getCanvasContainer().offsetWidth<250?S.classList.add("mapboxgl-compact"):S.classList.remove("mapboxgl-compact")}};var fl=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};fl.prototype.add=function(_){var S=++this._id;return this._queue.push({callback:_,id:S,cancelled:!1}),S},fl.prototype.remove=function(_){for(var S=this._currentlyRunning,x=0,C=S?this._queue.concat(S):this._queue;x<C.length;x+=1){var k=C[x];if(k.id===_)return void(k.cancelled=!0)}},fl.prototype.run=function(_){_===void 0&&(_=0);var S=this._currentlyRunning=this._queue;this._queue=[];for(var x=0,C=S;x<C.length;x+=1){var k=C[x];if(!k.cancelled&&(k.callback(_),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},fl.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Gc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Bf=E.window.HTMLImageElement,wd=E.window.HTMLElement,ms=E.window.ImageBitmap,fc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},I0=function(_){function S(C){var k=this;if((C=E.extend({},fc,C)).minZoom!=null&&C.maxZoom!=null&&C.minZoom>C.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(C.minPitch!=null&&C.maxPitch!=null&&C.minPitch>C.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(C.minPitch!=null&&C.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(C.maxPitch!=null&&C.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var G=new Pe(C.minZoom,C.maxZoom,C.minPitch,C.maxPitch,C.renderWorldCopies);if(_.call(this,G,C),this._interactive=C.interactive,this._maxTileCacheSize=C.maxTileCacheSize,this._failIfMajorPerformanceCaveat=C.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=C.preserveDrawingBuffer,this._antialias=C.antialias,this._trackResize=C.trackResize,this._bearingSnap=C.bearingSnap,this._refreshExpiredTiles=C.refreshExpiredTiles,this._fadeDuration=C.fadeDuration,this._crossSourceCollisions=C.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=C.collectResourceTiming,this._renderTaskQueue=new fl,this._controls=[],this._mapId=E.uniqueId(),this._locale=E.extend({},Gc,C.locale),this._clickTolerance=C.clickTolerance,this._requestManager=new E.RequestManager(C.transformRequest,C.accessToken),typeof C.container=="string"){if(this._container=E.window.document.getElementById(C.container),!this._container)throw new Error("Container '"+C.container+"' not found.")}else{if(!(C.container instanceof wd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=C.container}if(C.maxBounds&&this.setMaxBounds(C.maxBounds),E.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return k._update(!1)}),this.on("moveend",function(){return k._update(!1)}),this.on("zoom",function(){return k._update(!0)}),E.window!==void 0&&(E.window.addEventListener("online",this._onWindowOnline,!1),E.window.addEventListener("resize",this._onWindowResize,!1),E.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new So(this,C),this._hash=C.hash&&new Sn(typeof C.hash=="string"&&C.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}),C.bounds&&(this.resize(),this.fitBounds(C.bounds,E.extend({},C.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=C.localIdeographFontFamily,C.style&&this.setStyle(C.style,{localIdeographFontFamily:C.localIdeographFontFamily}),C.attributionControl&&this.addControl(new ou({customAttribution:C.customAttribution})),this.addControl(new rh,C.logoPosition),this.on("style.load",function(){k.transform.unmodified&&k.jumpTo(k.style.stylesheet)}),this.on("data",function(q){k._update(q.dataType==="style"),k.fire(new E.Event(q.dataType+"data",q))}),this.on("dataloading",function(q){k.fire(new E.Event(q.dataType+"dataloading",q))})}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return S.prototype._getMapId=function(){return this._mapId},S.prototype.addControl=function(C,k){if(k===void 0&&(k=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new E.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var G=C.onAdd(this);this._controls.push(C);var q=this._controlPositions[k];return k.indexOf("bottom")!==-1?q.insertBefore(G,q.firstChild):q.appendChild(G),this},S.prototype.removeControl=function(C){if(!C||!C.onRemove)return this.fire(new E.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var k=this._controls.indexOf(C);return k>-1&&this._controls.splice(k,1),C.onRemove(this),this},S.prototype.hasControl=function(C){return this._controls.indexOf(C)>-1},S.prototype.resize=function(C){var k=this._containerDimensions(),G=k[0],q=k[1];if(G===this.transform.width&&q===this.transform.height)return this;this._resizeCanvas(G,q),this.transform.resize(G,q),this.painter.resize(G,q);var he=!this._moving;return he&&this.fire(new E.Event("movestart",C)).fire(new E.Event("move",C)),this.fire(new E.Event("resize",C)),he&&this.fire(new E.Event("moveend",C)),this},S.prototype.getBounds=function(){return this.transform.getBounds()},S.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},S.prototype.setMaxBounds=function(C){return this.transform.setMaxBounds(E.LngLatBounds.convert(C)),this._update()},S.prototype.setMinZoom=function(C){if((C=C==null?-2:C)>=-2&&C<=this.transform.maxZoom)return this.transform.minZoom=C,this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},S.prototype.getMinZoom=function(){return this.transform.minZoom},S.prototype.setMaxZoom=function(C){if((C=C==null?22:C)>=this.transform.minZoom)return this.transform.maxZoom=C,this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")},S.prototype.getMaxZoom=function(){return this.transform.maxZoom},S.prototype.setMinPitch=function(C){if((C=C==null?0:C)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.minPitch=C,this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},S.prototype.getMinPitch=function(){return this.transform.minPitch},S.prototype.setMaxPitch=function(C){if((C=C==null?60:C)>60)throw new Error("maxPitch must be less than or equal to 60");if(C>=this.transform.minPitch)return this.transform.maxPitch=C,this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")},S.prototype.getMaxPitch=function(){return this.transform.maxPitch},S.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},S.prototype.setRenderWorldCopies=function(C){return this.transform.renderWorldCopies=C,this._update()},S.prototype.project=function(C){return this.transform.locationPoint(E.LngLat.convert(C))},S.prototype.unproject=function(C){return this.transform.pointLocation(E.Point.convert(C))},S.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},S.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},S.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},S.prototype._createDelegatedListener=function(C,k,G){var q,he=this;if(C==="mouseenter"||C==="mouseover"){var je=!1;return{layer:k,listener:G,delegates:{mousemove:function(kt){var jt=he.getLayer(k)?he.queryRenderedFeatures(kt.point,{layers:[k]}):[];jt.length?je||(je=!0,G.call(he,new ka(C,he,kt.originalEvent,{features:jt}))):je=!1},mouseout:function(){je=!1}}}}if(C==="mouseleave"||C==="mouseout"){var Xe=!1;return{layer:k,listener:G,delegates:{mousemove:function(kt){(he.getLayer(k)?he.queryRenderedFeatures(kt.point,{layers:[k]}):[]).length?Xe=!0:Xe&&(Xe=!1,G.call(he,new ka(C,he,kt.originalEvent)))},mouseout:function(kt){Xe&&(Xe=!1,G.call(he,new ka(C,he,kt.originalEvent)))}}}}return{layer:k,listener:G,delegates:(q={},q[C]=function(kt){var jt=he.getLayer(k)?he.queryRenderedFeatures(kt.point,{layers:[k]}):[];jt.length&&(kt.features=jt,G.call(he,kt),delete kt.features)},q)}},S.prototype.on=function(C,k,G){if(G===void 0)return _.prototype.on.call(this,C,k);var q=this._createDelegatedListener(C,k,G);for(var he in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(q),q.delegates)this.on(he,q.delegates[he]);return this},S.prototype.once=function(C,k,G){if(G===void 0)return _.prototype.once.call(this,C,k);var q=this._createDelegatedListener(C,k,G);for(var he in q.delegates)this.once(he,q.delegates[he]);return this},S.prototype.off=function(C,k,G){var q=this;return G===void 0?_.prototype.off.call(this,C,k):(this._delegatedListeners&&this._delegatedListeners[C]&&function(he){for(var je=he[C],Xe=0;Xe<je.length;Xe++){var kt=je[Xe];if(kt.layer===k&&kt.listener===G){for(var jt in kt.delegates)q.off(jt,kt.delegates[jt]);return je.splice(Xe,1),q}}}(this._delegatedListeners),this)},S.prototype.queryRenderedFeatures=function(C,k){if(!this.style)return[];var G;if(k!==void 0||C===void 0||C instanceof E.Point||Array.isArray(C)||(k=C,C=void 0),k=k||{},(C=C||[[0,0],[this.transform.width,this.transform.height]])instanceof E.Point||typeof C[0]=="number")G=[E.Point.convert(C)];else{var q=E.Point.convert(C[0]),he=E.Point.convert(C[1]);G=[q,new E.Point(he.x,q.y),he,new E.Point(q.x,he.y),q]}return this.style.queryRenderedFeatures(G,k,this.transform)},S.prototype.querySourceFeatures=function(C,k){return this.style.querySourceFeatures(C,k)},S.prototype.setStyle=function(C,k){return(k=E.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},k)).diff!==!1&&k.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&C?(this._diffStyle(C,k),this):(this._localIdeographFontFamily=k.localIdeographFontFamily,this._updateStyle(C,k))},S.prototype._getUIString=function(C){var k=this._locale[C];if(k==null)throw new Error("Missing UI string '"+C+"'");return k},S.prototype._updateStyle=function(C,k){return this.style&&(this.style.setEventedParent(null),this.style._remove()),C?(this.style=new ac(this,k||{}),this.style.setEventedParent(this,{style:this.style}),typeof C=="string"?this.style.loadURL(C):this.style.loadJSON(C),this):(delete this.style,this)},S.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ac(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},S.prototype._diffStyle=function(C,k){var G=this;if(typeof C=="string"){var q=this._requestManager.normalizeStyleURL(C),he=this._requestManager.transformRequest(q,E.ResourceType.Style);E.getJSON(he,function(je,Xe){je?G.fire(new E.ErrorEvent(je)):Xe&&G._updateDiff(Xe,k)})}else typeof C=="object"&&this._updateDiff(C,k)},S.prototype._updateDiff=function(C,k){try{this.style.setState(C)&&this._update(!0)}catch(G){E.warnOnce("Unable to perform style diff: "+(G.message||G.error||G)+".  Rebuilding the style from scratch."),this._updateStyle(C,k)}},S.prototype.getStyle=function(){if(this.style)return this.style.serialize()},S.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():E.warnOnce("There is no style added to the map.")},S.prototype.addSource=function(C,k){return this._lazyInitEmptyStyle(),this.style.addSource(C,k),this._update(!0)},S.prototype.isSourceLoaded=function(C){var k=this.style&&this.style.sourceCaches[C];if(k!==void 0)return k.loaded();this.fire(new E.ErrorEvent(new Error("There is no source with ID '"+C+"'")))},S.prototype.areTilesLoaded=function(){var C=this.style&&this.style.sourceCaches;for(var k in C){var G=C[k]._tiles;for(var q in G){var he=G[q];if(he.state!=="loaded"&&he.state!=="errored")return!1}}return!0},S.prototype.addSourceType=function(C,k,G){return this._lazyInitEmptyStyle(),this.style.addSourceType(C,k,G)},S.prototype.removeSource=function(C){return this.style.removeSource(C),this._update(!0)},S.prototype.getSource=function(C){return this.style.getSource(C)},S.prototype.addImage=function(C,k,G){G===void 0&&(G={});var q=G.pixelRatio;q===void 0&&(q=1);var he=G.sdf;he===void 0&&(he=!1);var je=G.stretchX,Xe=G.stretchY,kt=G.content;if(this._lazyInitEmptyStyle(),k instanceof Bf||ms&&k instanceof ms){var jt=E.browser.getImageData(k);this.style.addImage(C,{data:new E.RGBAImage({width:jt.width,height:jt.height},jt.data),pixelRatio:q,stretchX:je,stretchY:Xe,content:kt,sdf:he,version:0})}else{if(k.width===void 0||k.height===void 0)return this.fire(new E.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Yt=k;this.style.addImage(C,{data:new E.RGBAImage({width:k.width,height:k.height},new Uint8Array(k.data)),pixelRatio:q,stretchX:je,stretchY:Xe,content:kt,sdf:he,version:0,userImage:Yt}),Yt.onAdd&&Yt.onAdd(this,C)}},S.prototype.updateImage=function(C,k){var G=this.style.getImage(C);if(!G)return this.fire(new E.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var q=k instanceof Bf||ms&&k instanceof ms?E.browser.getImageData(k):k,he=q.width,je=q.height,Xe=q.data;return he===void 0||je===void 0?this.fire(new E.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):he!==G.data.width||je!==G.data.height?this.fire(new E.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(G.data.replace(Xe,!(k instanceof Bf||ms&&k instanceof ms)),void this.style.updateImage(C,G))},S.prototype.hasImage=function(C){return C?!!this.style.getImage(C):(this.fire(new E.ErrorEvent(new Error("Missing required image id"))),!1)},S.prototype.removeImage=function(C){this.style.removeImage(C)},S.prototype.loadImage=function(C,k){E.getImage(this._requestManager.transformRequest(C,E.ResourceType.Image),k)},S.prototype.listImages=function(){return this.style.listImages()},S.prototype.addLayer=function(C,k){return this._lazyInitEmptyStyle(),this.style.addLayer(C,k),this._update(!0)},S.prototype.moveLayer=function(C,k){return this.style.moveLayer(C,k),this._update(!0)},S.prototype.removeLayer=function(C){return this.style.removeLayer(C),this._update(!0)},S.prototype.getLayer=function(C){return this.style.getLayer(C)},S.prototype.setLayerZoomRange=function(C,k,G){return this.style.setLayerZoomRange(C,k,G),this._update(!0)},S.prototype.setFilter=function(C,k,G){return G===void 0&&(G={}),this.style.setFilter(C,k,G),this._update(!0)},S.prototype.getFilter=function(C){return this.style.getFilter(C)},S.prototype.setPaintProperty=function(C,k,G,q){return q===void 0&&(q={}),this.style.setPaintProperty(C,k,G,q),this._update(!0)},S.prototype.getPaintProperty=function(C,k){return this.style.getPaintProperty(C,k)},S.prototype.setLayoutProperty=function(C,k,G,q){return q===void 0&&(q={}),this.style.setLayoutProperty(C,k,G,q),this._update(!0)},S.prototype.getLayoutProperty=function(C,k){return this.style.getLayoutProperty(C,k)},S.prototype.setLight=function(C,k){return k===void 0&&(k={}),this._lazyInitEmptyStyle(),this.style.setLight(C,k),this._update(!0)},S.prototype.getLight=function(){return this.style.getLight()},S.prototype.setFeatureState=function(C,k){return this.style.setFeatureState(C,k),this._update()},S.prototype.removeFeatureState=function(C,k){return this.style.removeFeatureState(C,k),this._update()},S.prototype.getFeatureState=function(C){return this.style.getFeatureState(C)},S.prototype.getContainer=function(){return this._container},S.prototype.getCanvasContainer=function(){return this._canvasContainer},S.prototype.getCanvas=function(){return this._canvas},S.prototype._containerDimensions=function(){var C=0,k=0;return this._container&&(C=this._container.clientWidth||400,k=this._container.clientHeight||300),[C,k]},S.prototype._detectMissingCSS=function(){E.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&E.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},S.prototype._setupContainer=function(){var C=this._container;C.classList.add("mapboxgl-map"),(this._missingCSSCanary=re.create("div","mapboxgl-canary",C)).style.visibility="hidden",this._detectMissingCSS();var k=this._canvasContainer=re.create("div","mapboxgl-canvas-container",C);this._interactive&&k.classList.add("mapboxgl-interactive"),this._canvas=re.create("canvas","mapboxgl-canvas",k),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var G=this._containerDimensions();this._resizeCanvas(G[0],G[1]);var q=this._controlContainer=re.create("div","mapboxgl-control-container",C),he=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(je){he[je]=re.create("div","mapboxgl-ctrl-"+je,q)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},S.prototype._resizeCanvas=function(C,k){var G=E.browser.devicePixelRatio||1;this._canvas.width=G*C,this._canvas.height=G*k,this._canvas.style.width=C+"px",this._canvas.style.height=k+"px"},S.prototype._setupPainter=function(){var C=E.extend({},ve.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),k=this._canvas.getContext("webgl",C)||this._canvas.getContext("experimental-webgl",C);k?(this.painter=new Ja(k,this.transform),E.webpSupported.testSupport(k)):this.fire(new E.ErrorEvent(new Error("Failed to initialize WebGL")))},S.prototype._contextLost=function(C){C.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new E.Event("webglcontextlost",{originalEvent:C}))},S.prototype._contextRestored=function(C){this._setupPainter(),this.resize(),this._update(),this.fire(new E.Event("webglcontextrestored",{originalEvent:C}))},S.prototype._onMapScroll=function(C){if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},S.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},S.prototype._update=function(C){return this.style?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this},S.prototype._requestRenderFrame=function(C){return this._update(),this._renderTaskQueue.add(C)},S.prototype._cancelRenderFrame=function(C){this._renderTaskQueue.remove(C)},S.prototype._render=function(C){var k,G=this,q=0,he=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(k=he.createQueryEXT(),he.beginQueryEXT(he.TIME_ELAPSED_EXT,k),q=E.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),!this._removed){var je=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Xe=this.transform.zoom,kt=E.browser.now();this.style.zoomHistory.update(Xe,kt);var jt=new E.EvaluationParameters(Xe,{now:kt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Yt=jt.crossFadingFactor();Yt===1&&Yt===this._crossFadingFactor||(je=!0,this._crossFadingFactor=Yt),this.style.update(jt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new E.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new E.Event("load"))),this.style&&(this.style.hasTransitions()||je)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var gn=E.browser.now()-q;he.endQueryEXT(he.TIME_ELAPSED_EXT,k),setTimeout(function(){var un=he.getQueryObjectEXT(k,he.QUERY_RESULT_EXT)/1e6;he.deleteQueryEXT(k),G.fire(new E.Event("gpu-timing-frame",{cpuTime:gn,gpuTime:un}))},50)}if(this.listens("gpu-timing-layer")){var pn=this.painter.collectGpuTimers();setTimeout(function(){var un=G.painter.queryGpuTimers(pn);G.fire(new E.Event("gpu-timing-layer",{layerTimes:un}))},50)}var Cn=this._sourcesDirty||this._styleDirty||this._placementDirty;return Cn||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new E.Event("idle")),!this._loaded||this._fullyLoaded||Cn||(this._fullyLoaded=!0),this}},S.prototype.remove=function(){this._hash&&this._hash.remove();for(var C=0,k=this._controls;C<k.length;C+=1)k[C].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),E.window!==void 0&&(E.window.removeEventListener("resize",this._onWindowResize,!1),E.window.removeEventListener("orientationchange",this._onWindowResize,!1),E.window.removeEventListener("online",this._onWindowOnline,!1));var G=this.painter.context.gl.getExtension("WEBGL_lose_context");G&&G.loseContext(),Yh(this._canvasContainer),Yh(this._controlContainer),Yh(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new E.Event("remove"))},S.prototype.triggerRepaint=function(){var C=this;this.style&&!this._frame&&(this._frame=E.browser.frame(function(k){C._frame=null,C._render(k)}))},S.prototype._onWindowOnline=function(){this._update()},S.prototype._onWindowResize=function(C){this._trackResize&&this.resize({originalEvent:C})._update()},x.showTileBoundaries.get=function(){return!!this._showTileBoundaries},x.showTileBoundaries.set=function(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())},x.showPadding.get=function(){return!!this._showPadding},x.showPadding.set=function(C){this._showPadding!==C&&(this._showPadding=C,this._update())},x.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},x.showCollisionBoxes.set=function(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())},x.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},x.showOverdrawInspector.set=function(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())},x.repaint.get=function(){return!!this._repaint},x.repaint.set=function(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())},x.vertices.get=function(){return!!this._vertices},x.vertices.set=function(C){this._vertices=C,this._update()},S.prototype._setCacheLimits=function(C,k){E.setCacheLimits(C,k)},x.version.get=function(){return E.version},Object.defineProperties(S.prototype,x),S}(Uu);function Yh(_){_.parentNode&&_.parentNode.removeChild(_)}var qp={showCompass:!0,showZoom:!0,visualizePitch:!1},bh=function(_){var S=this;this.options=E.extend({},qp,_),this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(x){return x.preventDefault()}),this.options.showZoom&&(E.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(x){return S._map.zoomIn({},{originalEvent:x})}),re.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(x){return S._map.zoomOut({},{originalEvent:x})}),re.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(E.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(x){S.options.visualizePitch?S._map.resetNorthPitch({},{originalEvent:x}):S._map.resetNorth({},{originalEvent:x})}),this._compassIcon=re.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};bh.prototype._updateZoomButtons=function(){var _=this._map.getZoom(),S=_===this._map.getMaxZoom(),x=_===this._map.getMinZoom();this._zoomInButton.disabled=S,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",S.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())},bh.prototype._rotateCompassArrow=function(){var _=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=_},bh.prototype.onAdd=function(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new au(this._map,this._compass,this.options.visualizePitch)),this._container},bh.prototype.onRemove=function(){re.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},bh.prototype._createButton=function(_,S){var x=re.create("button",_,this._container);return x.type="button",x.addEventListener("click",S),x},bh.prototype._setButtonTitle=function(_,S){var x=this._map._getUIString("NavigationControl."+S);_.title=x,_.setAttribute("aria-label",x)};var au=function(_,S,x){x===void 0&&(x=!1),this._clickTolerance=10,this.element=S,this.mouseRotate=new Sd({clickTolerance:_.dragRotate._mouseRotate._clickTolerance}),this.map=_,x&&(this.mousePitch=new $p({clickTolerance:_.dragRotate._mousePitch._clickTolerance})),E.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),re.addEventListener(S,"mousedown",this.mousedown),re.addEventListener(S,"touchstart",this.touchstart,{passive:!1}),re.addEventListener(S,"touchmove",this.touchmove),re.addEventListener(S,"touchend",this.touchend),re.addEventListener(S,"touchcancel",this.reset)};function Ud(_,S,x){if(_=new E.LngLat(_.lng,_.lat),S){var C=new E.LngLat(_.lng-360,_.lat),k=new E.LngLat(_.lng+360,_.lat),G=x.locationPoint(_).distSqr(S);x.locationPoint(C).distSqr(S)<G?_=C:x.locationPoint(k).distSqr(S)<G&&(_=k)}for(;Math.abs(_.lng-x.center.lng)>180;){var q=x.locationPoint(_);if(q.x>=0&&q.y>=0&&q.x<=x.width&&q.y<=x.height)break;_.lng>x.center.lng?_.lng-=360:_.lng+=360}return _}au.prototype.down=function(_,S){this.mouseRotate.mousedown(_,S),this.mousePitch&&this.mousePitch.mousedown(_,S),re.disableDrag()},au.prototype.move=function(_,S){var x=this.map,C=this.mouseRotate.mousemoveWindow(_,S);if(C&&C.bearingDelta&&x.setBearing(x.getBearing()+C.bearingDelta),this.mousePitch){var k=this.mousePitch.mousemoveWindow(_,S);k&&k.pitchDelta&&x.setPitch(x.getPitch()+k.pitchDelta)}},au.prototype.off=function(){var _=this.element;re.removeEventListener(_,"mousedown",this.mousedown),re.removeEventListener(_,"touchstart",this.touchstart,{passive:!1}),re.removeEventListener(_,"touchmove",this.touchmove),re.removeEventListener(_,"touchend",this.touchend),re.removeEventListener(_,"touchcancel",this.reset),this.offTemp()},au.prototype.offTemp=function(){re.enableDrag(),re.removeEventListener(E.window,"mousemove",this.mousemove),re.removeEventListener(E.window,"mouseup",this.mouseup)},au.prototype.mousedown=function(_){this.down(E.extend({},_,{ctrlKey:!0,preventDefault:function(){return _.preventDefault()}}),re.mousePos(this.element,_)),re.addEventListener(E.window,"mousemove",this.mousemove),re.addEventListener(E.window,"mouseup",this.mouseup)},au.prototype.mousemove=function(_){this.move(_,re.mousePos(this.element,_))},au.prototype.mouseup=function(_){this.mouseRotate.mouseupWindow(_),this.mousePitch&&this.mousePitch.mouseupWindow(_),this.offTemp()},au.prototype.touchstart=function(_){_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=re.touchPos(this.element,_.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return _.preventDefault()}},this._startPos))},au.prototype.touchmove=function(_){_.targetTouches.length!==1?this.reset():(this._lastPos=re.touchPos(this.element,_.targetTouches)[0],this.move({preventDefault:function(){return _.preventDefault()}},this._lastPos))},au.prototype.touchend=function(_){_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},au.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Gr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ih(_,S,x){var C=_.classList;for(var k in Gr)C.remove("mapboxgl-"+x+"-anchor-"+k);C.add("mapboxgl-"+x+"-anchor-"+S)}var Xc,jd=function(_){function S(x,C){if(_.call(this),(x instanceof E.window.HTMLElement||C)&&(x=E.extend({element:x},C)),E.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=x&&x.anchor||"center",this._color=x&&x.color||"#3FB1CE",this._scale=x&&x.scale||1,this._draggable=x&&x.draggable||!1,this._clickTolerance=x&&x.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=x&&x.rotation||0,this._rotationAlignment=x&&x.rotationAlignment||"auto",this._pitchAlignment=x&&x.pitchAlignment&&x.pitchAlignment!=="auto"?x.pitchAlignment:this._rotationAlignment,x&&x.element)this._element=x.element,this._offset=E.Point.convert(x&&x.offset||[0,0]);else{this._defaultMarker=!0,this._element=re.create("div"),this._element.setAttribute("aria-label","Map marker");var k=re.createNS("http://www.w3.org/2000/svg","svg");k.setAttributeNS(null,"display","block"),k.setAttributeNS(null,"height","41px"),k.setAttributeNS(null,"width","27px"),k.setAttributeNS(null,"viewBox","0 0 27 41");var G=re.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"stroke","none"),G.setAttributeNS(null,"stroke-width","1"),G.setAttributeNS(null,"fill","none"),G.setAttributeNS(null,"fill-rule","evenodd");var q=re.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill-rule","nonzero");var he=re.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(3.0, 29.0)"),he.setAttributeNS(null,"fill","#000000");for(var je=0,Xe=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];je<Xe.length;je+=1){var kt=Xe[je],jt=re.createNS("http://www.w3.org/2000/svg","ellipse");jt.setAttributeNS(null,"opacity","0.04"),jt.setAttributeNS(null,"cx","10.5"),jt.setAttributeNS(null,"cy","5.80029008"),jt.setAttributeNS(null,"rx",kt.rx),jt.setAttributeNS(null,"ry",kt.ry),he.appendChild(jt)}var Yt=re.createNS("http://www.w3.org/2000/svg","g");Yt.setAttributeNS(null,"fill",this._color);var gn=re.createNS("http://www.w3.org/2000/svg","path");gn.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Yt.appendChild(gn);var pn=re.createNS("http://www.w3.org/2000/svg","g");pn.setAttributeNS(null,"opacity","0.25"),pn.setAttributeNS(null,"fill","#000000");var Cn=re.createNS("http://www.w3.org/2000/svg","path");Cn.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),pn.appendChild(Cn);var un=re.createNS("http://www.w3.org/2000/svg","g");un.setAttributeNS(null,"transform","translate(6.0, 7.0)"),un.setAttributeNS(null,"fill","#FFFFFF");var kn=re.createNS("http://www.w3.org/2000/svg","g");kn.setAttributeNS(null,"transform","translate(8.0, 8.0)");var er=re.createNS("http://www.w3.org/2000/svg","circle");er.setAttributeNS(null,"fill","#000000"),er.setAttributeNS(null,"opacity","0.25"),er.setAttributeNS(null,"cx","5.5"),er.setAttributeNS(null,"cy","5.5"),er.setAttributeNS(null,"r","5.4999962");var ur=re.createNS("http://www.w3.org/2000/svg","circle");ur.setAttributeNS(null,"fill","#FFFFFF"),ur.setAttributeNS(null,"cx","5.5"),ur.setAttributeNS(null,"cy","5.5"),ur.setAttributeNS(null,"r","5.4999962"),kn.appendChild(er),kn.appendChild(ur),q.appendChild(he),q.appendChild(Yt),q.appendChild(pn),q.appendChild(un),q.appendChild(kn),k.appendChild(q),k.setAttributeNS(null,"height",41*this._scale+"px"),k.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(k),this._offset=E.Point.convert(x&&x.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Cr){Cr.preventDefault()}),this._element.addEventListener("mousedown",function(Cr){Cr.preventDefault()}),ih(this._element,this._anchor,"marker"),this._popup=null}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.addTo=function(x){return this.remove(),this._map=x,x.getCanvasContainer().appendChild(this._element),x.on("move",this._update),x.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},S.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),re.remove(this._element),this._popup&&this._popup.remove(),this},S.prototype.getLngLat=function(){return this._lngLat},S.prototype.setLngLat=function(x){return this._lngLat=E.LngLat.convert(x),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},S.prototype.getElement=function(){return this._element},S.prototype.setPopup=function(x){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),x){if(!("offset"in x.options)){var C=Math.sqrt(Math.pow(13.5,2)/2);x.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(24.6+C)],"bottom-right":[-C,-1*(24.6+C)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=x,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},S.prototype._onKeyPress=function(x){var C=x.code,k=x.charCode||x.keyCode;C!=="Space"&&C!=="Enter"&&k!==32&&k!==13||this.togglePopup()},S.prototype._onMapClick=function(x){var C=x.originalEvent.target,k=this._element;this._popup&&(C===k||k.contains(C))&&this.togglePopup()},S.prototype.getPopup=function(){return this._popup},S.prototype.togglePopup=function(){var x=this._popup;return x?(x.isOpen()?x.remove():x.addTo(this._map),this):this},S.prototype._update=function(x){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ud(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(C="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k="rotateX("+this._map.getPitch()+"deg)"),x&&x.type!=="moveend"||(this._pos=this._pos.round()),re.setTransform(this._element,Gr[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+k+" "+C)}},S.prototype.getOffset=function(){return this._offset},S.prototype.setOffset=function(x){return this._offset=E.Point.convert(x),this._update(),this},S.prototype._onMove=function(x){if(!this._isDragging){var C=this._clickTolerance||this._map._clickTolerance;this._isDragging=x.point.dist(this._pointerdownPos)>=C}this._isDragging&&(this._pos=x.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new E.Event("dragstart"))),this.fire(new E.Event("drag")))},S.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new E.Event("dragend")),this._state="inactive"},S.prototype._addDragHandler=function(x){this._element.contains(x.originalEvent.target)&&(x.preventDefault(),this._positionDelta=x.point.sub(this._pos).add(this._offset),this._pointerdownPos=x.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},S.prototype.setDraggable=function(x){return this._draggable=!!x,this._map&&(x?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},S.prototype.isDraggable=function(){return this._draggable},S.prototype.setRotation=function(x){return this._rotation=x||0,this._update(),this},S.prototype.getRotation=function(){return this._rotation},S.prototype.setRotationAlignment=function(x){return this._rotationAlignment=x||"auto",this._update(),this},S.prototype.getRotationAlignment=function(){return this._rotationAlignment},S.prototype.setPitchAlignment=function(x){return this._pitchAlignment=x&&x!=="auto"?x:this._rotationAlignment,this._update(),this},S.prototype.getPitchAlignment=function(){return this._pitchAlignment},S}(E.Evented),xh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},oh=0,ah=!1,Qp=function(_){function S(x){_.call(this),this.options=E.extend({},xh,x),E.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.onAdd=function(x){var C;return this._map=x,this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),C=this._setupUI,Xc!==void 0?C(Xc):E.window.navigator.permissions!==void 0?E.window.navigator.permissions.query({name:"geolocation"}).then(function(k){C(Xc=k.state!=="denied")}):C(Xc=!!E.window.navigator.geolocation),this._container},S.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(E.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),re.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,oh=0,ah=!1},S.prototype._isOutOfMapMaxBounds=function(x){var C=this._map.getMaxBounds(),k=x.coords;return C&&(k.longitude<C.getWest()||k.longitude>C.getEast()||k.latitude<C.getSouth()||k.latitude>C.getNorth())},S.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},S.prototype._onSuccess=function(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new E.Event("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(x),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(x),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new E.Event("geolocate",x)),this._finish()}},S.prototype._updateCamera=function(x){var C=new E.LngLat(x.coords.longitude,x.coords.latitude),k=x.coords.accuracy,G=this._map.getBearing(),q=E.extend({bearing:G},this.options.fitBoundsOptions);this._map.fitBounds(C.toBounds(k),q,{geolocateSource:!0})},S.prototype._updateMarker=function(x){if(x){var C=new E.LngLat(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(C).addTo(this._map),this._userLocationDotMarker.setLngLat(C).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},S.prototype._updateCircleRadius=function(){var x=this._map._container.clientHeight/2,C=this._map.unproject([0,x]),k=this._map.unproject([1,x]),G=C.distanceTo(k),q=Math.ceil(2*this._accuracy/G);this._circleElement.style.width=q+"px",this._circleElement.style.height=q+"px"},S.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},S.prototype._onError=function(x){if(this._map){if(this.options.trackUserLocation)if(x.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(x.code===3&&ah)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new E.Event("error",x)),this._finish()}},S.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},S.prototype._setupUI=function(x){var C=this;if(this._container.addEventListener("contextmenu",function(q){return q.preventDefault()}),this._geolocateButton=re.create("button","mapboxgl-ctrl-geolocate",this._container),re.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",x===!1){E.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}else{var G=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=G,this._geolocateButton.setAttribute("aria-label",G)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=re.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new jd(this._dotElement),this._circleElement=re.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jd({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(q){q.geolocateSource||C._watchState!=="ACTIVE_LOCK"||q.originalEvent&&q.originalEvent.type==="resize"||(C._watchState="BACKGROUND",C._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),C._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),C.fire(new E.Event("trackuserlocationend")))})},S.prototype.trigger=function(){if(!this._setup)return E.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new E.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":oh--,ah=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new E.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new E.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var x;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++oh>1?(x={maximumAge:6e5,timeout:0},ah=!0):(x=this.options.positionOptions,ah=!1),this._geolocationWatchID=E.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else E.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},S.prototype._clearWatch=function(){E.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},S}(E.Evented),sh={maxWidth:100,unit:"metric"},Ff=function(_){this.options=E.extend({},sh,_),E.bindAll(["_onMove","setUnit"],this)};function Eh(_,S,x){var C=x&&x.maxWidth||100,k=_._container.clientHeight/2,G=_.unproject([0,k]),q=_.unproject([C,k]),he=G.distanceTo(q);if(x&&x.unit==="imperial"){var je=3.2808*he;je>5280?Al(S,C,je/5280,_._getUIString("ScaleControl.Miles")):Al(S,C,je,_._getUIString("ScaleControl.Feet"))}else x&&x.unit==="nautical"?Al(S,C,he/1852,_._getUIString("ScaleControl.NauticalMiles")):he>=1e3?Al(S,C,he/1e3,_._getUIString("ScaleControl.Kilometers")):Al(S,C,he,_._getUIString("ScaleControl.Meters"))}function Al(_,S,x,C){var k,G,q,he=(k=x,(G=Math.pow(10,(""+Math.floor(k)).length-1))*(q=(q=k/G)>=10?10:q>=5?5:q>=3?3:q>=2?2:q>=1?1:function(je){var Xe=Math.pow(10,Math.ceil(-Math.log(je)/Math.LN10));return Math.round(je*Xe)/Xe}(q)));_.style.width=S*(he/x)+"px",_.innerHTML=he+"&nbsp;"+C}Ff.prototype.getDefaultPosition=function(){return"bottom-left"},Ff.prototype._onMove=function(){Eh(this._map,this._container,this.options)},Ff.prototype.onAdd=function(_){return this._map=_,this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ff.prototype.onRemove=function(){re.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ff.prototype.setUnit=function(_){this.options.unit=_,Eh(this._map,this._container,this.options)};var ts=function(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof E.window.HTMLElement?this._container=_.container:E.warnOnce("Full screen control 'container' must be a DOM element.")),E.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in E.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in E.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in E.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in E.window.document&&(this._fullscreenchange="MSFullscreenChange")};ts.prototype.onAdd=function(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",E.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ts.prototype.onRemove=function(){re.remove(this._controlContainer),this._map=null,E.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ts.prototype._checkFullscreenSupport=function(){return!!(E.window.document.fullscreenEnabled||E.window.document.mozFullScreenEnabled||E.window.document.msFullscreenEnabled||E.window.document.webkitFullscreenEnabled)},ts.prototype._setupUI=function(){var _=this._fullscreenButton=re.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);re.create("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden",!0),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),E.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ts.prototype._updateTitle=function(){var _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_},ts.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ts.prototype._isFullscreen=function(){return this._fullscreen},ts.prototype._changeIcon=function(){(E.window.document.fullscreenElement||E.window.document.mozFullScreenElement||E.window.document.webkitFullscreenElement||E.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ts.prototype._onClickFullscreen=function(){this._isFullscreen()?E.window.document.exitFullscreen?E.window.document.exitFullscreen():E.window.document.mozCancelFullScreen?E.window.document.mozCancelFullScreen():E.window.document.msExitFullscreen?E.window.document.msExitFullscreen():E.window.document.webkitCancelFullScreen&&E.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ju={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Jp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),L0=function(_){function S(x){_.call(this),this.options=E.extend(Object.create(ju),x),E.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.addTo=function(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new E.Event("open")),this},S.prototype.isOpen=function(){return!!this._map},S.prototype.remove=function(){return this._content&&re.remove(this._content),this._container&&(re.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new E.Event("close")),this},S.prototype.getLngLat=function(){return this._lngLat},S.prototype.setLngLat=function(x){return this._lngLat=E.LngLat.convert(x),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},S.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},S.prototype.getElement=function(){return this._container},S.prototype.setText=function(x){return this.setDOMContent(E.window.document.createTextNode(x))},S.prototype.setHTML=function(x){var C,k=E.window.document.createDocumentFragment(),G=E.window.document.createElement("body");for(G.innerHTML=x;C=G.firstChild;)k.appendChild(C);return this.setDOMContent(k)},S.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},S.prototype.setMaxWidth=function(x){return this.options.maxWidth=x,this._update(),this},S.prototype.setDOMContent=function(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=re.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this},S.prototype.addClassName=function(x){this._container&&this._container.classList.add(x)},S.prototype.removeClassName=function(x){this._container&&this._container.classList.remove(x)},S.prototype.setOffset=function(x){return this.options.offset=x,this._update(),this},S.prototype.toggleClassName=function(x){if(this._container)return this._container.classList.toggle(x)},S.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=re.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},S.prototype._onMouseUp=function(x){this._update(x.point)},S.prototype._onMouseMove=function(x){this._update(x.point)},S.prototype._onDrag=function(x){this._update(x.point)},S.prototype._update=function(x){var C=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=re.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=re.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(jt){return C._container.classList.add(jt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ud(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||x)){var k=this._pos=this._trackPointer&&x?x:this._map.project(this._lngLat),G=this.options.anchor,q=function jt(Yt){if(Yt){if(typeof Yt=="number"){var gn=Math.round(Math.sqrt(.5*Math.pow(Yt,2)));return{center:new E.Point(0,0),top:new E.Point(0,Yt),"top-left":new E.Point(gn,gn),"top-right":new E.Point(-gn,gn),bottom:new E.Point(0,-Yt),"bottom-left":new E.Point(gn,-gn),"bottom-right":new E.Point(-gn,-gn),left:new E.Point(Yt,0),right:new E.Point(-Yt,0)}}if(Yt instanceof E.Point||Array.isArray(Yt)){var pn=E.Point.convert(Yt);return{center:pn,top:pn,"top-left":pn,"top-right":pn,bottom:pn,"bottom-left":pn,"bottom-right":pn,left:pn,right:pn}}return{center:E.Point.convert(Yt.center||[0,0]),top:E.Point.convert(Yt.top||[0,0]),"top-left":E.Point.convert(Yt["top-left"]||[0,0]),"top-right":E.Point.convert(Yt["top-right"]||[0,0]),bottom:E.Point.convert(Yt.bottom||[0,0]),"bottom-left":E.Point.convert(Yt["bottom-left"]||[0,0]),"bottom-right":E.Point.convert(Yt["bottom-right"]||[0,0]),left:E.Point.convert(Yt.left||[0,0]),right:E.Point.convert(Yt.right||[0,0])}}return jt(new E.Point(0,0))}(this.options.offset);if(!G){var he,je=this._container.offsetWidth,Xe=this._container.offsetHeight;he=k.y+q.bottom.y<Xe?["top"]:k.y>this._map.transform.height-Xe?["bottom"]:[],k.x<je/2?he.push("left"):k.x>this._map.transform.width-je/2&&he.push("right"),G=he.length===0?"bottom":he.join("-")}var kt=k.add(q[G]).round();re.setTransform(this._container,Gr[G]+" translate("+kt.x+"px,"+kt.y+"px)"),ih(this._container,G,"popup")}},S.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var x=this._container.querySelector(Jp);x&&x.focus()}},S.prototype._onClose=function(){this.remove()},S}(E.Evented),e0={version:E.version,supported:ve,setRTLTextPlugin:E.setRTLTextPlugin,getRTLTextPluginStatus:E.getRTLTextPluginStatus,Map:I0,NavigationControl:bh,GeolocateControl:Qp,AttributionControl:ou,ScaleControl:Ff,FullscreenControl:ts,Popup:L0,Marker:jd,Style:ac,LngLat:E.LngLat,LngLatBounds:E.LngLatBounds,Point:E.Point,MercatorCoordinate:E.MercatorCoordinate,Evented:E.Evented,config:E.config,prewarm:function(){wr().acquire(vr)},clearPrewarmedResources:function(){var _=Fr;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(vr),Fr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return E.config.ACCESS_TOKEN},set accessToken(_){E.config.ACCESS_TOKEN=_},get baseApiUrl(){return E.config.API_URL},set baseApiUrl(_){E.config.API_URL=_},get workerCount(){return Ur.workerCount},set workerCount(_){Ur.workerCount=_},get maxParallelImageRequests(){return E.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){E.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage:function(_){E.clearTileCache(_)},workerUrl:""};return e0}),ee})},92077:function($t,W,D){var ee,X;(function(E,ve){ee=ve,X=typeof ee=="function"?ee.call(W,D,W,$t):ee,X!==void 0&&($t.exports=X)})(this,function(){var E,ve,re="2.0.6",fe={},ae={},Ee={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},oe={currentLocale:Ee.currentLocale,zeroFormat:Ee.zeroFormat,nullFormat:Ee.nullFormat,defaultFormat:Ee.defaultFormat,scalePercentBy100:Ee.scalePercentBy100};function ze(te,ye){this._input=te,this._value=ye}return E=function(te){var ye,De,Se,we;if(E.isNumeral(te))ye=te.value();else if(te===0||typeof te=="undefined")ye=0;else if(te===null||ve.isNaN(te))ye=null;else if(typeof te=="string")if(oe.zeroFormat&&te===oe.zeroFormat)ye=0;else if(oe.nullFormat&&te===oe.nullFormat||!te.replace(/[^0-9]+/g,"").length)ye=null;else{for(De in fe)if(we=typeof fe[De].regexps.unformat=="function"?fe[De].regexps.unformat():fe[De].regexps.unformat,we&&te.match(we)){Se=fe[De].unformat;break}Se=Se||E._.stringToNumber,ye=Se(te)}else ye=Number(te)||null;return new ze(te,ye)},E.version=re,E.isNumeral=function(te){return te instanceof ze},E._=ve={numberToFormat:function(te,ye,De){var Se=ae[E.options.currentLocale],we=!1,ce=!1,Ze=0,xt="",ht=1e12,Gt=1e9,mt=1e6,gt=1e3,Be="",Re=!1,bt,yt,At,bn,He,Rt,Oe,it,Qe,$e;if(te=te||0,yt=Math.abs(te),E._.includes(ye,"(")?(we=!0,ye=ye.replace(/[\(|\)]/g,"")):(E._.includes(ye,"+")||E._.includes(ye,"-"))&&(it=E._.includes(ye,"+")?ye.indexOf("+"):te<0?ye.indexOf("-"):-1,ye=ye.replace(/[\+|\-]/g,"")),E._.includes(ye,"a")&&(bt=ye.match(/a(k|m|b|t)?/),bt=bt?bt[1]:!1,E._.includes(ye," a")&&(xt=" "),ye=ye.replace(new RegExp(xt+"a[kmbt]?"),""),yt>=ht&&!bt||bt==="t"?(xt+=Se.abbreviations.trillion,te=te/ht):yt<ht&&yt>=Gt&&!bt||bt==="b"?(xt+=Se.abbreviations.billion,te=te/Gt):yt<Gt&&yt>=mt&&!bt||bt==="m"?(xt+=Se.abbreviations.million,te=te/mt):(yt<mt&&yt>=gt&&!bt||bt==="k")&&(xt+=Se.abbreviations.thousand,te=te/gt)),E._.includes(ye,"[.]")&&(ce=!0,ye=ye.replace("[.]",".")),Rt=te.toString().split(".")[0],Oe=ye.split(".")[1],Qe=ye.indexOf(","),Ze=(ye.split(".")[0].split(",")[0].match(/0/g)||[]).length,Oe?(E._.includes(Oe,"[")?(Oe=Oe.replace("]",""),Oe=Oe.split("["),Be=E._.toFixed(te,Oe[0].length+Oe[1].length,De,Oe[1].length)):Be=E._.toFixed(te,Oe.length,De),Rt=Be.split(".")[0],E._.includes(Be,".")?Be=Se.delimiters.decimal+Be.split(".")[1]:Be="",ce&&Number(Be.slice(1))===0&&(Be="")):Rt=E._.toFixed(te,0,De),xt&&!bt&&Number(Rt)>=1e3&&xt!==Se.abbreviations.trillion)switch(Rt=String(Number(Rt)/1e3),xt){case Se.abbreviations.thousand:xt=Se.abbreviations.million;break;case Se.abbreviations.million:xt=Se.abbreviations.billion;break;case Se.abbreviations.billion:xt=Se.abbreviations.trillion;break}if(E._.includes(Rt,"-")&&(Rt=Rt.slice(1),Re=!0),Rt.length<Ze)for(var Ot=Ze-Rt.length;Ot>0;Ot--)Rt="0"+Rt;return Qe>-1&&(Rt=Rt.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+Se.delimiters.thousands)),ye.indexOf(".")===0&&(Rt=""),$e=Rt+Be+(xt||""),we?$e=(we&&Re?"(":"")+$e+(we&&Re?")":""):it>=0?$e=it===0?(Re?"-":"+")+$e:$e+(Re?"-":"+"):Re&&($e="-"+$e),$e},stringToNumber:function(te){var ye=ae[oe.currentLocale],De=te,Se={thousand:3,million:6,billion:9,trillion:12},we,ce,Ze,xt;if(oe.zeroFormat&&te===oe.zeroFormat)ce=0;else if(oe.nullFormat&&te===oe.nullFormat||!te.replace(/[^0-9]+/g,"").length)ce=null;else{ce=1,ye.delimiters.decimal!=="."&&(te=te.replace(/\./g,"").replace(ye.delimiters.decimal,"."));for(we in Se)if(xt=new RegExp("[^a-zA-Z]"+ye.abbreviations[we]+"(?:\\)|(\\"+ye.currency.symbol+")?(?:\\))?)?$"),De.match(xt)){ce*=Math.pow(10,Se[we]);break}ce*=(te.split("-").length+Math.min(te.split("(").length-1,te.split(")").length-1))%2?1:-1,te=te.replace(/[^0-9\.]+/g,""),ce*=Number(te)}return ce},isNaN:function(te){return typeof te=="number"&&isNaN(te)},includes:function(te,ye){return te.indexOf(ye)!==-1},insert:function(te,ye,De){return te.slice(0,De)+ye+te.slice(De)},reduce:function(te,ye){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof ye!="function")throw new TypeError(ye+" is not a function");var De=Object(te),Se=De.length>>>0,we=0,ce;if(arguments.length===3)ce=arguments[2];else{for(;we<Se&&!(we in De);)we++;if(we>=Se)throw new TypeError("Reduce of empty array with no initial value");ce=De[we++]}for(;we<Se;we++)we in De&&(ce=ye(ce,De[we],we,De));return ce},multiplier:function(te){var ye=te.toString().split(".");return ye.length<2?1:Math.pow(10,ye[1].length)},correctionFactor:function(){var te=Array.prototype.slice.call(arguments);return te.reduce(function(ye,De){var Se=ve.multiplier(De);return ye>Se?ye:Se},1)},toFixed:function(te,ye,De,Se){var we=te.toString().split("."),ce=ye-(Se||0),Ze,xt,ht,Gt;return we.length===2?Ze=Math.min(Math.max(we[1].length,ce),ye):Ze=ce,ht=Math.pow(10,Ze),Gt=(De(te+"e+"+Ze)/ht).toFixed(Ze),Se>ye-Ze&&(xt=new RegExp("\\.?0{1,"+(Se-(ye-Ze))+"}$"),Gt=Gt.replace(xt,"")),Gt}},E.options=oe,E.formats=fe,E.locales=ae,E.locale=function(te){return te&&(oe.currentLocale=te.toLowerCase()),oe.currentLocale},E.localeData=function(te){if(!te)return ae[oe.currentLocale];if(te=te.toLowerCase(),!ae[te])throw new Error("Unknown locale : "+te);return ae[te]},E.reset=function(){for(var te in Ee)oe[te]=Ee[te]},E.zeroFormat=function(te){oe.zeroFormat=typeof te=="string"?te:null},E.nullFormat=function(te){oe.nullFormat=typeof te=="string"?te:null},E.defaultFormat=function(te){oe.defaultFormat=typeof te=="string"?te:"0.0"},E.register=function(te,ye,De){if(ye=ye.toLowerCase(),this[te+"s"][ye])throw new TypeError(ye+" "+te+" already registered.");return this[te+"s"][ye]=De,De},E.validate=function(te,ye){var De,Se,we,ce,Ze,xt,ht,Gt;if(typeof te!="string"&&(te+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",te)),te=te.trim(),te.match(/^\d+$/))return!0;if(te==="")return!1;try{ht=E.localeData(ye)}catch(mt){ht=E.localeData(E.locale())}return we=ht.currency.symbol,Ze=ht.abbreviations,De=ht.delimiters.decimal,ht.delimiters.thousands==="."?Se="\\.":Se=ht.delimiters.thousands,Gt=te.match(/^[^\d]+/),Gt!==null&&(te=te.substr(1),Gt[0]!==we)||(Gt=te.match(/[^\d]+$/),Gt!==null&&(te=te.slice(0,-1),Gt[0]!==Ze.thousand&&Gt[0]!==Ze.million&&Gt[0]!==Ze.billion&&Gt[0]!==Ze.trillion))?!1:(xt=new RegExp(Se+"{2}"),te.match(/[^\d.,]/g)?!1:(ce=te.split(De),ce.length>2?!1:ce.length<2?!!ce[0].match(/^\d+.*\d$/)&&!ce[0].match(xt):ce[0].length===1?!!ce[0].match(/^\d+$/)&&!ce[0].match(xt)&&!!ce[1].match(/^\d+$/):!!ce[0].match(/^\d+.*\d$/)&&!ce[0].match(xt)&&!!ce[1].match(/^\d+$/)))},E.fn=ze.prototype={clone:function(){return E(this)},format:function(te,ye){var De=this._value,Se=te||oe.defaultFormat,we,ce,Ze;if(ye=ye||Math.round,De===0&&oe.zeroFormat!==null)ce=oe.zeroFormat;else if(De===null&&oe.nullFormat!==null)ce=oe.nullFormat;else{for(we in fe)if(Se.match(fe[we].regexps.format)){Ze=fe[we].format;break}Ze=Ze||E._.numberToFormat,ce=Ze(De,Se,ye)}return ce},value:function(){return this._value},input:function(){return this._input},set:function(te){return this._value=Number(te),this},add:function(te){var ye=ve.correctionFactor.call(null,this._value,te);function De(Se,we,ce,Ze){return Se+Math.round(ye*we)}return this._value=ve.reduce([this._value,te],De,0)/ye,this},subtract:function(te){var ye=ve.correctionFactor.call(null,this._value,te);function De(Se,we,ce,Ze){return Se-Math.round(ye*we)}return this._value=ve.reduce([te],De,Math.round(this._value*ye))/ye,this},multiply:function(te){function ye(De,Se,we,ce){var Ze=ve.correctionFactor(De,Se);return Math.round(De*Ze)*Math.round(Se*Ze)/Math.round(Ze*Ze)}return this._value=ve.reduce([this._value,te],ye,1),this},divide:function(te){function ye(De,Se,we,ce){var Ze=ve.correctionFactor(De,Se);return Math.round(De*Ze)/Math.round(Se*Ze)}return this._value=ve.reduce([this._value,te],ye),this},difference:function(te){return Math.abs(E(this._value).subtract(te).value())}},E.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(te){var ye=te%10;return~~(te%100/10)===1?"th":ye===1?"st":ye===2?"nd":ye===3?"rd":"th"},currency:{symbol:"$"}}),function(){E.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(te,ye,De){var Se=E._.includes(ye," BPS")?" ":"",we;return te=te*1e4,ye=ye.replace(/\s?BPS/,""),we=E._.numberToFormat(te,ye,De),E._.includes(we,")")?(we=we.split(""),we.splice(-1,0,Se+"BPS"),we=we.join("")):we=we+Se+"BPS",we},unformat:function(te){return+(E._.stringToNumber(te)*1e-4).toFixed(15)}})}(),function(){var te={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},ye={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},De=te.suffixes.concat(ye.suffixes.filter(function(we){return te.suffixes.indexOf(we)<0})),Se=De.join("|");Se="("+Se.replace("B","B(?!PS)")+")",E.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(Se)},format:function(we,ce,Ze){var xt,ht=E._.includes(ce,"ib")?ye:te,Gt=E._.includes(ce," b")||E._.includes(ce," ib")?" ":"",mt,gt,Be;for(ce=ce.replace(/\s?i?b/,""),mt=0;mt<=ht.suffixes.length;mt++)if(gt=Math.pow(ht.base,mt),Be=Math.pow(ht.base,mt+1),we===null||we===0||we>=gt&&we<Be){Gt+=ht.suffixes[mt],gt>0&&(we=we/gt);break}return xt=E._.numberToFormat(we,ce,Ze),xt+Gt},unformat:function(we){var ce=E._.stringToNumber(we),Ze,xt;if(ce){for(Ze=te.suffixes.length-1;Ze>=0;Ze--){if(E._.includes(we,te.suffixes[Ze])){xt=Math.pow(te.base,Ze);break}if(E._.includes(we,ye.suffixes[Ze])){xt=Math.pow(ye.base,Ze);break}}ce*=xt||1}return ce}})}(),function(){E.register("format","currency",{regexps:{format:/(\$)/},format:function(te,ye,De){var Se=E.locales[E.options.currentLocale],we={before:ye.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:ye.match(/([\+|\-|\)|\s|\$]*)$/)[0]},ce,Ze,xt;for(ye=ye.replace(/\s?\$\s?/,""),ce=E._.numberToFormat(te,ye,De),te>=0?(we.before=we.before.replace(/[\-\(]/,""),we.after=we.after.replace(/[\-\)]/,"")):te<0&&!E._.includes(we.before,"-")&&!E._.includes(we.before,"(")&&(we.before="-"+we.before),xt=0;xt<we.before.length;xt++)switch(Ze=we.before[xt],Ze){case"$":ce=E._.insert(ce,Se.currency.symbol,xt);break;case" ":ce=E._.insert(ce," ",xt+Se.currency.symbol.length-1);break}for(xt=we.after.length-1;xt>=0;xt--)switch(Ze=we.after[xt],Ze){case"$":ce=xt===we.after.length-1?ce+Se.currency.symbol:E._.insert(ce,Se.currency.symbol,-(we.after.length-(1+xt)));break;case" ":ce=xt===we.after.length-1?ce+" ":E._.insert(ce," ",-(we.after.length-(1+xt)+Se.currency.symbol.length-1));break}return ce}})}(),function(){E.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(te,ye,De){var Se,we=typeof te=="number"&&!E._.isNaN(te)?te.toExponential():"0e+0",ce=we.split("e");return ye=ye.replace(/e[\+|\-]{1}0/,""),Se=E._.numberToFormat(Number(ce[0]),ye,De),Se+"e"+ce[1]},unformat:function(te){var ye=E._.includes(te,"e+")?te.split("e+"):te.split("e-"),De=Number(ye[0]),Se=Number(ye[1]);Se=E._.includes(te,"e-")?Se*=-1:Se;function we(ce,Ze,xt,ht){var Gt=E._.correctionFactor(ce,Ze),mt=ce*Gt*(Ze*Gt)/(Gt*Gt);return mt}return E._.reduce([De,Math.pow(10,Se)],we,1)}})}(),function(){E.register("format","ordinal",{regexps:{format:/(o)/},format:function(te,ye,De){var Se=E.locales[E.options.currentLocale],we,ce=E._.includes(ye," o")?" ":"";return ye=ye.replace(/\s?o/,""),ce+=Se.ordinal(te),we=E._.numberToFormat(te,ye,De),we+ce}})}(),function(){E.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(te,ye,De){var Se=E._.includes(ye," %")?" ":"",we;return E.options.scalePercentBy100&&(te=te*100),ye=ye.replace(/\s?\%/,""),we=E._.numberToFormat(te,ye,De),E._.includes(we,")")?(we=we.split(""),we.splice(-1,0,Se+"%"),we=we.join("")):we=we+Se+"%",we},unformat:function(te){var ye=E._.stringToNumber(te);return E.options.scalePercentBy100?ye*.01:ye}})}(),function(){E.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(te,ye,De){var Se=Math.floor(te/60/60),we=Math.floor((te-Se*60*60)/60),ce=Math.round(te-Se*60*60-we*60);return Se+":"+(we<10?"0"+we:we)+":"+(ce<10?"0"+ce:ce)},unformat:function(te){var ye=te.split(":"),De=0;return ye.length===3?(De=De+Number(ye[0])*60*60,De=De+Number(ye[1])*60,De=De+Number(ye[2])):ye.length===2&&(De=De+Number(ye[0])*60,De=De+Number(ye[1])),Number(De)}})}(),E})},3614:function($t,W,D){"use strict";$t.exports=X;var ee=D(80645);function X(He){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(He)?He:new Uint8Array(He||0),this.pos=0,this.type=0,this.length=this.buf.length}X.Varint=0,X.Fixed64=1,X.Bytes=2,X.Fixed32=5;var E=65536*65536,ve=1/E,re=12,fe=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");X.prototype={destroy:function(){this.buf=null},readFields:function(He,Rt,Oe){for(Oe=Oe||this.length;this.pos<Oe;){var it=this.readVarint(),Qe=it>>3,$e=this.pos;this.type=it&7,He(Qe,Rt,this),this.pos===$e&&this.skip(it)}return Rt},readMessage:function(He,Rt){return this.readFields(He,Rt,this.readVarint()+this.pos)},readFixed32:function(){var He=Be(this.buf,this.pos);return this.pos+=4,He},readSFixed32:function(){var He=bt(this.buf,this.pos);return this.pos+=4,He},readFixed64:function(){var He=Be(this.buf,this.pos)+Be(this.buf,this.pos+4)*E;return this.pos+=8,He},readSFixed64:function(){var He=Be(this.buf,this.pos)+bt(this.buf,this.pos+4)*E;return this.pos+=8,He},readFloat:function(){var He=ee.read(this.buf,this.pos,!0,23,4);return this.pos+=4,He},readDouble:function(){var He=ee.read(this.buf,this.pos,!0,52,8);return this.pos+=8,He},readVarint:function(He){var Rt=this.buf,Oe,it;return it=Rt[this.pos++],Oe=it&127,it<128||(it=Rt[this.pos++],Oe|=(it&127)<<7,it<128)||(it=Rt[this.pos++],Oe|=(it&127)<<14,it<128)||(it=Rt[this.pos++],Oe|=(it&127)<<21,it<128)?Oe:(it=Rt[this.pos],Oe|=(it&15)<<28,ae(Oe,He,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var He=this.readVarint();return He%2===1?(He+1)/-2:He/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var He=this.readVarint()+this.pos,Rt=this.pos;return this.pos=He,He-Rt>=re&&fe?At(this.buf,Rt,He):yt(this.buf,Rt,He)},readBytes:function(){var He=this.readVarint()+this.pos,Rt=this.buf.subarray(this.pos,He);return this.pos=He,Rt},readPackedVarint:function(He,Rt){if(this.type!==X.Bytes)return He.push(this.readVarint(Rt));var Oe=Ee(this);for(He=He||[];this.pos<Oe;)He.push(this.readVarint(Rt));return He},readPackedSVarint:function(He){if(this.type!==X.Bytes)return He.push(this.readSVarint());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readSVarint());return He},readPackedBoolean:function(He){if(this.type!==X.Bytes)return He.push(this.readBoolean());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readBoolean());return He},readPackedFloat:function(He){if(this.type!==X.Bytes)return He.push(this.readFloat());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readFloat());return He},readPackedDouble:function(He){if(this.type!==X.Bytes)return He.push(this.readDouble());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readDouble());return He},readPackedFixed32:function(He){if(this.type!==X.Bytes)return He.push(this.readFixed32());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readFixed32());return He},readPackedSFixed32:function(He){if(this.type!==X.Bytes)return He.push(this.readSFixed32());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readSFixed32());return He},readPackedFixed64:function(He){if(this.type!==X.Bytes)return He.push(this.readFixed64());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readFixed64());return He},readPackedSFixed64:function(He){if(this.type!==X.Bytes)return He.push(this.readSFixed64());var Rt=Ee(this);for(He=He||[];this.pos<Rt;)He.push(this.readSFixed64());return He},skip:function(He){var Rt=He&7;if(Rt===X.Varint)for(;this.buf[this.pos++]>127;);else if(Rt===X.Bytes)this.pos=this.readVarint()+this.pos;else if(Rt===X.Fixed32)this.pos+=4;else if(Rt===X.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Rt)},writeTag:function(He,Rt){this.writeVarint(He<<3|Rt)},realloc:function(He){for(var Rt=this.length||16;Rt<this.pos+He;)Rt*=2;if(Rt!==this.length){var Oe=new Uint8Array(Rt);Oe.set(this.buf),this.buf=Oe,this.length=Rt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(He){this.realloc(4),Re(this.buf,He,this.pos),this.pos+=4},writeSFixed32:function(He){this.realloc(4),Re(this.buf,He,this.pos),this.pos+=4},writeFixed64:function(He){this.realloc(8),Re(this.buf,He&-1,this.pos),Re(this.buf,Math.floor(He*ve),this.pos+4),this.pos+=8},writeSFixed64:function(He){this.realloc(8),Re(this.buf,He&-1,this.pos),Re(this.buf,Math.floor(He*ve),this.pos+4),this.pos+=8},writeVarint:function(He){if(He=+He||0,He>268435455||He<0){ze(He,this);return}this.realloc(4),this.buf[this.pos++]=He&127|(He>127?128:0),!(He<=127)&&(this.buf[this.pos++]=(He>>>=7)&127|(He>127?128:0),!(He<=127)&&(this.buf[this.pos++]=(He>>>=7)&127|(He>127?128:0),!(He<=127)&&(this.buf[this.pos++]=He>>>7&127)))},writeSVarint:function(He){this.writeVarint(He<0?-He*2-1:He*2)},writeBoolean:function(He){this.writeVarint(!!He)},writeString:function(He){He=String(He),this.realloc(He.length*4),this.pos++;var Rt=this.pos;this.pos=bn(this.buf,He,this.pos);var Oe=this.pos-Rt;Oe>=128&&De(Rt,Oe,this),this.pos=Rt-1,this.writeVarint(Oe),this.pos+=Oe},writeFloat:function(He){this.realloc(4),ee.write(this.buf,He,this.pos,!0,23,4),this.pos+=4},writeDouble:function(He){this.realloc(8),ee.write(this.buf,He,this.pos,!0,52,8),this.pos+=8},writeBytes:function(He){var Rt=He.length;this.writeVarint(Rt),this.realloc(Rt);for(var Oe=0;Oe<Rt;Oe++)this.buf[this.pos++]=He[Oe]},writeRawMessage:function(He,Rt){this.pos++;var Oe=this.pos;He(Rt,this);var it=this.pos-Oe;it>=128&&De(Oe,it,this),this.pos=Oe-1,this.writeVarint(it),this.pos+=it},writeMessage:function(He,Rt,Oe){this.writeTag(He,X.Bytes),this.writeRawMessage(Rt,Oe)},writePackedVarint:function(He,Rt){Rt.length&&this.writeMessage(He,Se,Rt)},writePackedSVarint:function(He,Rt){Rt.length&&this.writeMessage(He,we,Rt)},writePackedBoolean:function(He,Rt){Rt.length&&this.writeMessage(He,xt,Rt)},writePackedFloat:function(He,Rt){Rt.length&&this.writeMessage(He,ce,Rt)},writePackedDouble:function(He,Rt){Rt.length&&this.writeMessage(He,Ze,Rt)},writePackedFixed32:function(He,Rt){Rt.length&&this.writeMessage(He,ht,Rt)},writePackedSFixed32:function(He,Rt){Rt.length&&this.writeMessage(He,Gt,Rt)},writePackedFixed64:function(He,Rt){Rt.length&&this.writeMessage(He,mt,Rt)},writePackedSFixed64:function(He,Rt){Rt.length&&this.writeMessage(He,gt,Rt)},writeBytesField:function(He,Rt){this.writeTag(He,X.Bytes),this.writeBytes(Rt)},writeFixed32Field:function(He,Rt){this.writeTag(He,X.Fixed32),this.writeFixed32(Rt)},writeSFixed32Field:function(He,Rt){this.writeTag(He,X.Fixed32),this.writeSFixed32(Rt)},writeFixed64Field:function(He,Rt){this.writeTag(He,X.Fixed64),this.writeFixed64(Rt)},writeSFixed64Field:function(He,Rt){this.writeTag(He,X.Fixed64),this.writeSFixed64(Rt)},writeVarintField:function(He,Rt){this.writeTag(He,X.Varint),this.writeVarint(Rt)},writeSVarintField:function(He,Rt){this.writeTag(He,X.Varint),this.writeSVarint(Rt)},writeStringField:function(He,Rt){this.writeTag(He,X.Bytes),this.writeString(Rt)},writeFloatField:function(He,Rt){this.writeTag(He,X.Fixed32),this.writeFloat(Rt)},writeDoubleField:function(He,Rt){this.writeTag(He,X.Fixed64),this.writeDouble(Rt)},writeBooleanField:function(He,Rt){this.writeVarintField(He,!!Rt)}};function ae(He,Rt,Oe){var it=Oe.buf,Qe,$e;if($e=it[Oe.pos++],Qe=($e&112)>>4,$e<128||($e=it[Oe.pos++],Qe|=($e&127)<<3,$e<128)||($e=it[Oe.pos++],Qe|=($e&127)<<10,$e<128)||($e=it[Oe.pos++],Qe|=($e&127)<<17,$e<128)||($e=it[Oe.pos++],Qe|=($e&127)<<24,$e<128)||($e=it[Oe.pos++],Qe|=($e&1)<<31,$e<128))return oe(He,Qe,Rt);throw new Error("Expected varint not more than 10 bytes")}function Ee(He){return He.type===X.Bytes?He.readVarint()+He.pos:He.pos+1}function oe(He,Rt,Oe){return Oe?Rt*4294967296+(He>>>0):(Rt>>>0)*4294967296+(He>>>0)}function ze(He,Rt){var Oe,it;if(He>=0?(Oe=He%4294967296|0,it=He/4294967296|0):(Oe=~(-He%4294967296),it=~(-He/4294967296),Oe^4294967295?Oe=Oe+1|0:(Oe=0,it=it+1|0)),He>=18446744073709552e3||He<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Rt.realloc(10),te(Oe,it,Rt),ye(it,Rt)}function te(He,Rt,Oe){Oe.buf[Oe.pos++]=He&127|128,He>>>=7,Oe.buf[Oe.pos++]=He&127|128,He>>>=7,Oe.buf[Oe.pos++]=He&127|128,He>>>=7,Oe.buf[Oe.pos++]=He&127|128,He>>>=7,Oe.buf[Oe.pos]=He&127}function ye(He,Rt){var Oe=(He&7)<<4;Rt.buf[Rt.pos++]|=Oe|((He>>>=3)?128:0),He&&(Rt.buf[Rt.pos++]=He&127|((He>>>=7)?128:0),He&&(Rt.buf[Rt.pos++]=He&127|((He>>>=7)?128:0),He&&(Rt.buf[Rt.pos++]=He&127|((He>>>=7)?128:0),He&&(Rt.buf[Rt.pos++]=He&127|((He>>>=7)?128:0),He&&(Rt.buf[Rt.pos++]=He&127)))))}function De(He,Rt,Oe){var it=Rt<=16383?1:Rt<=2097151?2:Rt<=268435455?3:Math.floor(Math.log(Rt)/(Math.LN2*7));Oe.realloc(it);for(var Qe=Oe.pos-1;Qe>=He;Qe--)Oe.buf[Qe+it]=Oe.buf[Qe]}function Se(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeVarint(He[Oe])}function we(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeSVarint(He[Oe])}function ce(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeFloat(He[Oe])}function Ze(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeDouble(He[Oe])}function xt(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeBoolean(He[Oe])}function ht(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeFixed32(He[Oe])}function Gt(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeSFixed32(He[Oe])}function mt(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeFixed64(He[Oe])}function gt(He,Rt){for(var Oe=0;Oe<He.length;Oe++)Rt.writeSFixed64(He[Oe])}function Be(He,Rt){return(He[Rt]|He[Rt+1]<<8|He[Rt+2]<<16)+He[Rt+3]*16777216}function Re(He,Rt,Oe){He[Oe]=Rt,He[Oe+1]=Rt>>>8,He[Oe+2]=Rt>>>16,He[Oe+3]=Rt>>>24}function bt(He,Rt){return(He[Rt]|He[Rt+1]<<8|He[Rt+2]<<16)+(He[Rt+3]<<24)}function yt(He,Rt,Oe){for(var it="",Qe=Rt;Qe<Oe;){var $e=He[Qe],Ot=null,vt=$e>239?4:$e>223?3:$e>191?2:1;if(Qe+vt>Oe)break;var Me,Xt,on;vt===1?$e<128&&(Ot=$e):vt===2?(Me=He[Qe+1],(Me&192)===128&&(Ot=($e&31)<<6|Me&63,Ot<=127&&(Ot=null))):vt===3?(Me=He[Qe+1],Xt=He[Qe+2],(Me&192)===128&&(Xt&192)===128&&(Ot=($e&15)<<12|(Me&63)<<6|Xt&63,(Ot<=2047||Ot>=55296&&Ot<=57343)&&(Ot=null))):vt===4&&(Me=He[Qe+1],Xt=He[Qe+2],on=He[Qe+3],(Me&192)===128&&(Xt&192)===128&&(on&192)===128&&(Ot=($e&15)<<18|(Me&63)<<12|(Xt&63)<<6|on&63,(Ot<=65535||Ot>=1114112)&&(Ot=null))),Ot===null?(Ot=65533,vt=1):Ot>65535&&(Ot-=65536,it+=String.fromCharCode(Ot>>>10&1023|55296),Ot=56320|Ot&1023),it+=String.fromCharCode(Ot),Qe+=vt}return it}function At(He,Rt,Oe){return fe.decode(He.subarray(Rt,Oe))}function bn(He,Rt,Oe){for(var it=0,Qe,$e;it<Rt.length;it++){if(Qe=Rt.charCodeAt(it),Qe>55295&&Qe<57344)if($e)if(Qe<56320){He[Oe++]=239,He[Oe++]=191,He[Oe++]=189,$e=Qe;continue}else Qe=$e-55296<<10|Qe-56320|65536,$e=null;else{Qe>56319||it+1===Rt.length?(He[Oe++]=239,He[Oe++]=191,He[Oe++]=189):$e=Qe;continue}else $e&&(He[Oe++]=239,He[Oe++]=191,He[Oe++]=189,$e=null);Qe<128?He[Oe++]=Qe:(Qe<2048?He[Oe++]=Qe>>6|192:(Qe<65536?He[Oe++]=Qe>>12|224:(He[Oe++]=Qe>>18|240,He[Oe++]=Qe>>12&63|128),He[Oe++]=Qe>>6&63|128),He[Oe++]=Qe&63|128)}return Oe}},73807:function($t){"use strict";var W=$t.exports;$t.exports.isNumber=function(D){return typeof D=="number"},$t.exports.findMin=function(D){if(D.length===0)return 1/0;for(var ee=D[0],X=1;X<D.length;X++)ee=Math.min(ee,D[X]);return ee},$t.exports.findMax=function(D){if(D.length===0)return-1/0;for(var ee=D[0],X=1;X<D.length;X++)ee=Math.max(ee,D[X]);return ee},$t.exports.findMinMulti=function(D){for(var ee=W.findMin(D[0]),X=1;X<D.length;X++)ee=Math.min(ee,W.findMin(D[X]));return ee},$t.exports.findMaxMulti=function(D){for(var ee=W.findMax(D[0]),X=1;X<D.length;X++)ee=Math.max(ee,W.findMax(D[X]));return ee},$t.exports.inside=function(D,ee,X){return D<=X&&X<=ee}},53843:function($t,W,D){"use strict";var ee=50,X=2,E=Math.log(2),ve=$t.exports,re=D(73807);function fe(Ee){return 1-Math.abs(Ee)}$t.exports.getUnifiedMinMax=function(Ee,oe){return ve.getUnifiedMinMaxMulti([Ee],oe)},$t.exports.getUnifiedMinMaxMulti=function(Ee,oe){oe=oe||{};var ze=!1,te=!1,ye=re.isNumber(oe.width)?oe.width:X,De=re.isNumber(oe.size)?oe.size:ee,Se=re.isNumber(oe.min)?oe.min:(ze=!0,re.findMinMulti(Ee)),we=re.isNumber(oe.max)?oe.max:(te=!0,re.findMaxMulti(Ee)),ce=we-Se,Ze=ce/(De-1);return ze&&(Se=Se-2*ye*Ze),te&&(we=we+2*ye*Ze),{min:Se,max:we}},$t.exports.create=function(Ee,oe){if(oe=oe||{},!Ee||Ee.length===0)return[];var ze=re.isNumber(oe.size)?oe.size:ee,te=re.isNumber(oe.width)?oe.width:X,ye=ve.getUnifiedMinMax(Ee,{size:ze,width:te,min:oe.min,max:oe.max}),De=ye.min,Se=ye.max,we=Se-De,ce=we/(ze-1);if(we===0)return[{x:De,y:1}];for(var Ze=[],xt=0;xt<ze;xt++)Ze.push({x:De+xt*ce,y:0});var ht=function(At){return Math.floor((At-De)/ce)},Gt=ae(fe,te),mt=Gt[te],gt=Gt[te-1]-Gt[te-2],Be=0;Ee.forEach(function(At){var bn=ht(At);if(!(bn+te<0||bn-te>=Ze.length)){var He=Math.max(bn-te,0),Rt=bn,Oe=Math.min(bn+te,Ze.length-1),it=He-(bn-te),Qe=bn+te-Oe,$e=Gt[-te-1+it]||0,Ot=Gt[-te-1+Qe]||0,vt=mt/(mt-$e-Ot);it>0&&(Be+=vt*(it-1)*gt);var Me=Math.max(0,bn-te+1);re.inside(0,Ze.length-1,Me)&&(Ze[Me].y+=vt*1*gt),re.inside(0,Ze.length-1,Rt+1)&&(Ze[Rt+1].y-=vt*2*gt),re.inside(0,Ze.length-1,Oe+1)&&(Ze[Oe+1].y+=vt*1*gt)}});var Re=Be,bt=0,yt=0;return Ze.forEach(function(At){bt+=At.y,Re+=bt,At.y=Re,yt+=Re}),yt>0&&Ze.forEach(function(At){At.y/=yt}),Ze};function ae(Ee,oe){for(var ze={},te=0,ye=-oe;ye<=oe;ye++)te+=Ee(ye/oe),ze[ye]=te;return ze}$t.exports.getExpectedValueFromPdf=function(Ee){if(!(!Ee||Ee.length===0)){var oe=0;return Ee.forEach(function(ze){oe+=ze.x*ze.y}),oe}},$t.exports.getXWithLeftTailArea=function(Ee,oe){if(!(!Ee||Ee.length===0)){for(var ze=0,te=0,ye=0;ye<Ee.length&&(te=ye,ze+=Ee[ye].y,!(ze>=oe));ye++);return Ee[te].x}},$t.exports.getPerplexity=function(Ee){if(!(!Ee||Ee.length===0)){var oe=0;return Ee.forEach(function(ze){var te=Math.log(ze.y);isFinite(te)&&(oe+=ze.y*te)}),oe=-oe/E,Math.pow(2,oe)}}},32676:function($t,W,D){var ee=D(34155);(function(X,E){$t.exports=E()})(this,function(){"use strict";function X(dt,be){var Ne={label:0,sent:function(){if(It[0]&1)throw It[1];return It[1]},trys:[],ops:[]},ot,Pt,It,xn;return xn={next:Qn(0),throw:Qn(1),return:Qn(2)},typeof Symbol=="function"&&(xn[Symbol.iterator]=function(){return this}),xn;function Qn(Jn){return function(Ae){return br([Jn,Ae])}}function br(Jn){if(ot)throw new TypeError("Generator is already executing.");for(;Ne;)try{if(ot=1,Pt&&(It=Jn[0]&2?Pt.return:Jn[0]?Pt.throw||((It=Pt.return)&&It.call(Pt),0):Pt.next)&&!(It=It.call(Pt,Jn[1])).done)return It;switch(Pt=0,It&&(Jn=[Jn[0]&2,It.value]),Jn[0]){case 0:case 1:It=Jn;break;case 4:return Ne.label++,{value:Jn[1],done:!1};case 5:Ne.label++,Pt=Jn[1],Jn=[0];continue;case 7:Jn=Ne.ops.pop(),Ne.trys.pop();continue;default:if(It=Ne.trys,!(It=It.length>0&&It[It.length-1])&&(Jn[0]===6||Jn[0]===2)){Ne=0;continue}if(Jn[0]===3&&(!It||Jn[1]>It[0]&&Jn[1]<It[3])){Ne.label=Jn[1];break}if(Jn[0]===6&&Ne.label<It[1]){Ne.label=It[1],It=Jn;break}if(It&&Ne.label<It[2]){Ne.label=It[2],Ne.ops.push(Jn);break}It[2]&&Ne.ops.pop(),Ne.trys.pop();continue}Jn=be.call(dt,Ne)}catch(Ae){Jn=[6,Ae],Pt=0}finally{ot=It=0}if(Jn[0]&5)throw Jn[1];return{value:Jn[0]?Jn[1]:void 0,done:!0}}}var E=function(){function dt(be,Ne){this.next=null,this.key=be,this.data=Ne,this.left=null,this.right=null}return dt}();function ve(dt,be){return dt>be?1:dt<be?-1:0}function re(dt,be,Ne){for(var ot=new E(null,null),Pt=ot,It=ot;;){var xn=Ne(dt,be.key);if(xn<0){if(be.left===null)break;if(Ne(dt,be.left.key)<0){var Qn=be.left;if(be.left=Qn.right,Qn.right=be,be=Qn,be.left===null)break}It.left=be,It=be,be=be.left}else if(xn>0){if(be.right===null)break;if(Ne(dt,be.right.key)>0){var Qn=be.right;if(be.right=Qn.left,Qn.left=be,be=Qn,be.right===null)break}Pt.right=be,Pt=be,be=be.right}else break}return Pt.right=be.left,It.left=be.right,be.left=ot.right,be.right=ot.left,be}function fe(dt,be,Ne,ot){var Pt=new E(dt,be);if(Ne===null)return Pt.left=Pt.right=null,Pt;Ne=re(dt,Ne,ot);var It=ot(dt,Ne.key);return It<0?(Pt.left=Ne.left,Pt.right=Ne,Ne.left=null):It>=0&&(Pt.right=Ne.right,Pt.left=Ne,Ne.right=null),Pt}function ae(dt,be,Ne){var ot=null,Pt=null;if(be){be=re(dt,be,Ne);var It=Ne(be.key,dt);It===0?(ot=be.left,Pt=be.right):It<0?(Pt=be.right,be.right=null,ot=be):(ot=be.left,be.left=null,Pt=be)}return{left:ot,right:Pt}}function Ee(dt,be,Ne){return be===null?dt:(dt===null||(be=re(dt.key,be,Ne),be.left=dt),be)}function oe(dt,be,Ne,ot,Pt){if(dt){ot(""+be+(Ne?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+Pt(dt)+`
`);var It=be+(Ne?"    ":"\u2502   ");dt.left&&oe(dt.left,It,!1,ot,Pt),dt.right&&oe(dt.right,It,!0,ot,Pt)}}var ze=function(){function dt(be){be===void 0&&(be=ve),this._root=null,this._size=0,this._comparator=be}return dt.prototype.insert=function(be,Ne){return this._size++,this._root=fe(be,Ne,this._root,this._comparator)},dt.prototype.add=function(be,Ne){var ot=new E(be,Ne);this._root===null&&(ot.left=ot.right=null,this._size++,this._root=ot);var Pt=this._comparator,It=re(be,this._root,Pt),xn=Pt(be,It.key);return xn===0?this._root=It:(xn<0?(ot.left=It.left,ot.right=It,It.left=null):xn>0&&(ot.right=It.right,ot.left=It,It.right=null),this._size++,this._root=ot),this._root},dt.prototype.remove=function(be){this._root=this._remove(be,this._root,this._comparator)},dt.prototype._remove=function(be,Ne,ot){var Pt;if(Ne===null)return null;Ne=re(be,Ne,ot);var It=ot(be,Ne.key);return It===0?(Ne.left===null?Pt=Ne.right:(Pt=re(be,Ne.left,ot),Pt.right=Ne.right),this._size--,Pt):Ne},dt.prototype.pop=function(){var be=this._root;if(be){for(;be.left;)be=be.left;return this._root=re(be.key,this._root,this._comparator),this._root=this._remove(be.key,this._root,this._comparator),{key:be.key,data:be.data}}return null},dt.prototype.findStatic=function(be){for(var Ne=this._root,ot=this._comparator;Ne;){var Pt=ot(be,Ne.key);if(Pt===0)return Ne;Pt<0?Ne=Ne.left:Ne=Ne.right}return null},dt.prototype.find=function(be){return this._root&&(this._root=re(be,this._root,this._comparator),this._comparator(be,this._root.key)!==0)?null:this._root},dt.prototype.contains=function(be){for(var Ne=this._root,ot=this._comparator;Ne;){var Pt=ot(be,Ne.key);if(Pt===0)return!0;Pt<0?Ne=Ne.left:Ne=Ne.right}return!1},dt.prototype.forEach=function(be,Ne){for(var ot=this._root,Pt=[],It=!1;!It;)ot!==null?(Pt.push(ot),ot=ot.left):Pt.length!==0?(ot=Pt.pop(),be.call(Ne,ot),ot=ot.right):It=!0;return this},dt.prototype.range=function(be,Ne,ot,Pt){for(var It=[],xn=this._comparator,Qn=this._root,br;It.length!==0||Qn;)if(Qn)It.push(Qn),Qn=Qn.left;else{if(Qn=It.pop(),br=xn(Qn.key,Ne),br>0)break;if(xn(Qn.key,be)>=0&&ot.call(Pt,Qn))return this;Qn=Qn.right}return this},dt.prototype.keys=function(){var be=[];return this.forEach(function(Ne){var ot=Ne.key;return be.push(ot)}),be},dt.prototype.values=function(){var be=[];return this.forEach(function(Ne){var ot=Ne.data;return be.push(ot)}),be},dt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},dt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},dt.prototype.minNode=function(be){if(be===void 0&&(be=this._root),be)for(;be.left;)be=be.left;return be},dt.prototype.maxNode=function(be){if(be===void 0&&(be=this._root),be)for(;be.right;)be=be.right;return be},dt.prototype.at=function(be){for(var Ne=this._root,ot=!1,Pt=0,It=[];!ot;)if(Ne)It.push(Ne),Ne=Ne.left;else if(It.length>0){if(Ne=It.pop(),Pt===be)return Ne;Pt++,Ne=Ne.right}else ot=!0;return null},dt.prototype.next=function(be){var Ne=this._root,ot=null;if(be.right){for(ot=be.right;ot.left;)ot=ot.left;return ot}for(var Pt=this._comparator;Ne;){var It=Pt(be.key,Ne.key);if(It===0)break;It<0?(ot=Ne,Ne=Ne.left):Ne=Ne.right}return ot},dt.prototype.prev=function(be){var Ne=this._root,ot=null;if(be.left!==null){for(ot=be.left;ot.right;)ot=ot.right;return ot}for(var Pt=this._comparator;Ne;){var It=Pt(be.key,Ne.key);if(It===0)break;It<0?Ne=Ne.left:(ot=Ne,Ne=Ne.right)}return ot},dt.prototype.clear=function(){return this._root=null,this._size=0,this},dt.prototype.toList=function(){return De(this._root)},dt.prototype.load=function(be,Ne,ot){Ne===void 0&&(Ne=[]),ot===void 0&&(ot=!1);var Pt=be.length,It=this._comparator;if(ot&&ce(be,Ne,0,Pt-1,It),this._root===null)this._root=te(be,Ne,0,Pt),this._size=Pt;else{var xn=we(this.toList(),ye(be,Ne),It);Pt=this._size+Pt,this._root=Se({head:xn},0,Pt)}return this},dt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(dt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(dt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),dt.prototype.toString=function(be){be===void 0&&(be=function(ot){return String(ot.key)});var Ne=[];return oe(this._root,"",!0,function(ot){return Ne.push(ot)},be),Ne.join("")},dt.prototype.update=function(be,Ne,ot){var Pt=this._comparator,It=ae(be,this._root,Pt),xn=It.left,Qn=It.right;Pt(be,Ne)<0?Qn=fe(Ne,ot,Qn,Pt):xn=fe(Ne,ot,xn,Pt),this._root=Ee(xn,Qn,Pt)},dt.prototype.split=function(be){return ae(be,this._root,this._comparator)},dt.prototype[Symbol.iterator]=function(){var be,Ne,ot;return X(this,function(Pt){switch(Pt.label){case 0:be=this._root,Ne=[],ot=!1,Pt.label=1;case 1:return ot?[3,6]:be===null?[3,2]:(Ne.push(be),be=be.left,[3,5]);case 2:return Ne.length===0?[3,4]:(be=Ne.pop(),[4,be]);case 3:return Pt.sent(),be=be.right,[3,5];case 4:ot=!0,Pt.label=5;case 5:return[3,1];case 6:return[2]}})},dt}();function te(dt,be,Ne,ot){var Pt=ot-Ne;if(Pt>0){var It=Ne+Math.floor(Pt/2),xn=dt[It],Qn=be[It],br=new E(xn,Qn);return br.left=te(dt,be,Ne,It),br.right=te(dt,be,It+1,ot),br}return null}function ye(dt,be){for(var Ne=new E(null,null),ot=Ne,Pt=0;Pt<dt.length;Pt++)ot=ot.next=new E(dt[Pt],be[Pt]);return ot.next=null,Ne.next}function De(dt){for(var be=dt,Ne=[],ot=!1,Pt=new E(null,null),It=Pt;!ot;)be?(Ne.push(be),be=be.left):Ne.length>0?(be=It=It.next=Ne.pop(),be=be.right):ot=!0;return It.next=null,Pt.next}function Se(dt,be,Ne){var ot=Ne-be;if(ot>0){var Pt=be+Math.floor(ot/2),It=Se(dt,be,Pt),xn=dt.head;return xn.left=It,dt.head=dt.head.next,xn.right=Se(dt,Pt+1,Ne),xn}return null}function we(dt,be,Ne){for(var ot=new E(null,null),Pt=ot,It=dt,xn=be;It!==null&&xn!==null;)Ne(It.key,xn.key)<0?(Pt.next=It,It=It.next):(Pt.next=xn,xn=xn.next),Pt=Pt.next;return It!==null?Pt.next=It:xn!==null&&(Pt.next=xn),ot.next}function ce(dt,be,Ne,ot,Pt){if(!(Ne>=ot)){for(var It=dt[Ne+ot>>1],xn=Ne-1,Qn=ot+1;;){do xn++;while(Pt(dt[xn],It)<0);do Qn--;while(Pt(dt[Qn],It)>0);if(xn>=Qn)break;var br=dt[xn];dt[xn]=dt[Qn],dt[Qn]=br,br=be[xn],be[xn]=be[Qn],be[Qn]=br}ce(dt,be,Ne,Qn,Pt),ce(dt,be,Qn+1,ot,Pt)}}const Ze=(dt,be)=>dt.ll.x<=be.x&&be.x<=dt.ur.x&&dt.ll.y<=be.y&&be.y<=dt.ur.y,xt=(dt,be)=>{if(be.ur.x<dt.ll.x||dt.ur.x<be.ll.x||be.ur.y<dt.ll.y||dt.ur.y<be.ll.y)return null;const Ne=dt.ll.x<be.ll.x?be.ll.x:dt.ll.x,ot=dt.ur.x<be.ur.x?dt.ur.x:be.ur.x,Pt=dt.ll.y<be.ll.y?be.ll.y:dt.ll.y,It=dt.ur.y<be.ur.y?dt.ur.y:be.ur.y;return{ll:{x:Ne,y:Pt},ur:{x:ot,y:It}}};let ht=Number.EPSILON;ht===void 0&&(ht=Math.pow(2,-52));const Gt=ht*ht,mt=(dt,be)=>{if(-ht<dt&&dt<ht&&-ht<be&&be<ht)return 0;const Ne=dt-be;return Ne*Ne<Gt*dt*be?0:dt<be?-1:1};class gt{constructor(){this.reset()}reset(){this.xRounder=new Be,this.yRounder=new Be}round(be,Ne){return{x:this.xRounder.round(be),y:this.yRounder.round(Ne)}}}class Be{constructor(){this.tree=new ze,this.round(0)}round(be){const Ne=this.tree.add(be),ot=this.tree.prev(Ne);if(ot!==null&&mt(Ne.key,ot.key)===0)return this.tree.remove(be),ot.key;const Pt=this.tree.next(Ne);return Pt!==null&&mt(Ne.key,Pt.key)===0?(this.tree.remove(be),Pt.key):be}}const Re=new gt,bt=11102230246251565e-32,yt=134217729,At=(3+8*bt)*bt;function bn(dt,be,Ne,ot,Pt){let It,xn,Qn,br,Jn=be[0],Ae=ot[0],xe=0,ke=0;Ae>Jn==Ae>-Jn?(It=Jn,Jn=be[++xe]):(It=Ae,Ae=ot[++ke]);let tt=0;if(xe<dt&&ke<Ne)for(Ae>Jn==Ae>-Jn?(xn=Jn+It,Qn=It-(xn-Jn),Jn=be[++xe]):(xn=Ae+It,Qn=It-(xn-Ae),Ae=ot[++ke]),It=xn,Qn!==0&&(Pt[tt++]=Qn);xe<dt&&ke<Ne;)Ae>Jn==Ae>-Jn?(xn=It+Jn,br=xn-It,Qn=It-(xn-br)+(Jn-br),Jn=be[++xe]):(xn=It+Ae,br=xn-It,Qn=It-(xn-br)+(Ae-br),Ae=ot[++ke]),It=xn,Qn!==0&&(Pt[tt++]=Qn);for(;xe<dt;)xn=It+Jn,br=xn-It,Qn=It-(xn-br)+(Jn-br),Jn=be[++xe],It=xn,Qn!==0&&(Pt[tt++]=Qn);for(;ke<Ne;)xn=It+Ae,br=xn-It,Qn=It-(xn-br)+(Ae-br),Ae=ot[++ke],It=xn,Qn!==0&&(Pt[tt++]=Qn);return(It!==0||tt===0)&&(Pt[tt++]=It),tt}function He(dt,be){let Ne=be[0];for(let ot=1;ot<dt;ot++)Ne+=be[ot];return Ne}function Rt(dt){return new Float64Array(dt)}const Oe=(3+16*bt)*bt,it=(2+12*bt)*bt,Qe=(9+64*bt)*bt*bt,$e=Rt(4),Ot=Rt(8),vt=Rt(12),Me=Rt(16),Xt=Rt(4);function on(dt,be,Ne,ot,Pt,It,xn){let Qn,br,Jn,Ae,xe,ke,tt,Et,tn,fn,_t,en,Gn,Tr,jr,vr,Ur,Fr;const qr=dt-Pt,wr=Ne-Pt,fi=be-It,di=ot-It;Tr=qr*di,ke=yt*qr,tt=ke-(ke-qr),Et=qr-tt,ke=yt*di,tn=ke-(ke-di),fn=di-tn,jr=Et*fn-(Tr-tt*tn-Et*tn-tt*fn),vr=fi*wr,ke=yt*fi,tt=ke-(ke-fi),Et=fi-tt,ke=yt*wr,tn=ke-(ke-wr),fn=wr-tn,Ur=Et*fn-(vr-tt*tn-Et*tn-tt*fn),_t=jr-Ur,xe=jr-_t,$e[0]=jr-(_t+xe)+(xe-Ur),en=Tr+_t,xe=en-Tr,Gn=Tr-(en-xe)+(_t-xe),_t=Gn-vr,xe=Gn-_t,$e[1]=Gn-(_t+xe)+(xe-vr),Fr=en+_t,xe=Fr-en,$e[2]=en-(Fr-xe)+(_t-xe),$e[3]=Fr;let vi=He(4,$e),vo=it*xn;if(vi>=vo||-vi>=vo||(xe=dt-qr,Qn=dt-(qr+xe)+(xe-Pt),xe=Ne-wr,Jn=Ne-(wr+xe)+(xe-Pt),xe=be-fi,br=be-(fi+xe)+(xe-It),xe=ot-di,Ae=ot-(di+xe)+(xe-It),Qn===0&&br===0&&Jn===0&&Ae===0)||(vo=Qe*xn+At*Math.abs(vi),vi+=qr*Ae+di*Qn-(fi*Jn+wr*br),vi>=vo||-vi>=vo))return vi;Tr=Qn*di,ke=yt*Qn,tt=ke-(ke-Qn),Et=Qn-tt,ke=yt*di,tn=ke-(ke-di),fn=di-tn,jr=Et*fn-(Tr-tt*tn-Et*tn-tt*fn),vr=br*wr,ke=yt*br,tt=ke-(ke-br),Et=br-tt,ke=yt*wr,tn=ke-(ke-wr),fn=wr-tn,Ur=Et*fn-(vr-tt*tn-Et*tn-tt*fn),_t=jr-Ur,xe=jr-_t,Xt[0]=jr-(_t+xe)+(xe-Ur),en=Tr+_t,xe=en-Tr,Gn=Tr-(en-xe)+(_t-xe),_t=Gn-vr,xe=Gn-_t,Xt[1]=Gn-(_t+xe)+(xe-vr),Fr=en+_t,xe=Fr-en,Xt[2]=en-(Fr-xe)+(_t-xe),Xt[3]=Fr;const Oi=bn(4,$e,4,Xt,Ot);Tr=qr*Ae,ke=yt*qr,tt=ke-(ke-qr),Et=qr-tt,ke=yt*Ae,tn=ke-(ke-Ae),fn=Ae-tn,jr=Et*fn-(Tr-tt*tn-Et*tn-tt*fn),vr=fi*Jn,ke=yt*fi,tt=ke-(ke-fi),Et=fi-tt,ke=yt*Jn,tn=ke-(ke-Jn),fn=Jn-tn,Ur=Et*fn-(vr-tt*tn-Et*tn-tt*fn),_t=jr-Ur,xe=jr-_t,Xt[0]=jr-(_t+xe)+(xe-Ur),en=Tr+_t,xe=en-Tr,Gn=Tr-(en-xe)+(_t-xe),_t=Gn-vr,xe=Gn-_t,Xt[1]=Gn-(_t+xe)+(xe-vr),Fr=en+_t,xe=Fr-en,Xt[2]=en-(Fr-xe)+(_t-xe),Xt[3]=Fr;const Ko=bn(Oi,Ot,4,Xt,vt);Tr=Qn*Ae,ke=yt*Qn,tt=ke-(ke-Qn),Et=Qn-tt,ke=yt*Ae,tn=ke-(ke-Ae),fn=Ae-tn,jr=Et*fn-(Tr-tt*tn-Et*tn-tt*fn),vr=br*Jn,ke=yt*br,tt=ke-(ke-br),Et=br-tt,ke=yt*Jn,tn=ke-(ke-Jn),fn=Jn-tn,Ur=Et*fn-(vr-tt*tn-Et*tn-tt*fn),_t=jr-Ur,xe=jr-_t,Xt[0]=jr-(_t+xe)+(xe-Ur),en=Tr+_t,xe=en-Tr,Gn=Tr-(en-xe)+(_t-xe),_t=Gn-vr,xe=Gn-_t,Xt[1]=Gn-(_t+xe)+(xe-vr),Fr=en+_t,xe=Fr-en,Xt[2]=en-(Fr-xe)+(_t-xe),Xt[3]=Fr;const va=bn(Ko,vt,4,Xt,Me);return Me[va-1]}function Fn(dt,be,Ne,ot,Pt,It){const xn=(be-It)*(Ne-Pt),Qn=(dt-Pt)*(ot-It),br=xn-Qn,Jn=Math.abs(xn+Qn);return Math.abs(br)>=Oe*Jn?br:-on(dt,be,Ne,ot,Pt,It,Jn)}const $n=(dt,be)=>dt.x*be.y-dt.y*be.x,nr=(dt,be)=>dt.x*be.x+dt.y*be.y,Ht=(dt,be,Ne)=>{const ot=Fn(dt.x,dt.y,be.x,be.y,Ne.x,Ne.y);return ot>0?-1:ot<0?1:0},Jt=dt=>Math.sqrt(nr(dt,dt)),_n=(dt,be,Ne)=>{const ot={x:be.x-dt.x,y:be.y-dt.y},Pt={x:Ne.x-dt.x,y:Ne.y-dt.y};return $n(Pt,ot)/Jt(Pt)/Jt(ot)},tr=(dt,be,Ne)=>{const ot={x:be.x-dt.x,y:be.y-dt.y},Pt={x:Ne.x-dt.x,y:Ne.y-dt.y};return nr(Pt,ot)/Jt(Pt)/Jt(ot)},an=(dt,be,Ne)=>be.y===0?null:{x:dt.x+be.x/be.y*(Ne-dt.y),y:Ne},Ut=(dt,be,Ne)=>be.x===0?null:{x:Ne,y:dt.y+be.y/be.x*(Ne-dt.x)},Dt=(dt,be,Ne,ot)=>{if(be.x===0)return Ut(Ne,ot,dt.x);if(ot.x===0)return Ut(dt,be,Ne.x);if(be.y===0)return an(Ne,ot,dt.y);if(ot.y===0)return an(dt,be,Ne.y);const Pt=$n(be,ot);if(Pt==0)return null;const It={x:Ne.x-dt.x,y:Ne.y-dt.y},xn=$n(It,be)/Pt,Qn=$n(It,ot)/Pt,br=dt.x+Qn*be.x,Jn=Ne.x+xn*ot.x,Ae=dt.y+Qn*be.y,xe=Ne.y+xn*ot.y,ke=(br+Jn)/2,tt=(Ae+xe)/2;return{x:ke,y:tt}};class Ie{static compare(be,Ne){const ot=Ie.comparePoints(be.point,Ne.point);return ot!==0?ot:(be.point!==Ne.point&&be.link(Ne),be.isLeft!==Ne.isLeft?be.isLeft?1:-1:Bt.compare(be.segment,Ne.segment))}static comparePoints(be,Ne){return be.x<Ne.x?-1:be.x>Ne.x?1:be.y<Ne.y?-1:be.y>Ne.y?1:0}constructor(be,Ne){be.events===void 0?be.events=[this]:be.events.push(this),this.point=be,this.isLeft=Ne}link(be){if(be.point===this.point)throw new Error("Tried to link already linked events");const Ne=be.point.events;for(let ot=0,Pt=Ne.length;ot<Pt;ot++){const It=Ne[ot];this.point.events.push(It),It.point=this.point}this.checkForConsuming()}checkForConsuming(){const be=this.point.events.length;for(let Ne=0;Ne<be;Ne++){const ot=this.point.events[Ne];if(ot.segment.consumedBy===void 0)for(let Pt=Ne+1;Pt<be;Pt++){const It=this.point.events[Pt];It.consumedBy===void 0&&ot.otherSE.point.events===It.otherSE.point.events&&ot.segment.consume(It.segment)}}}getAvailableLinkedEvents(){const be=[];for(let Ne=0,ot=this.point.events.length;Ne<ot;Ne++){const Pt=this.point.events[Ne];Pt!==this&&!Pt.segment.ringOut&&Pt.segment.isInResult()&&be.push(Pt)}return be}getLeftmostComparator(be){const Ne=new Map,ot=Pt=>{const It=Pt.otherSE;Ne.set(Pt,{sine:_n(this.point,be.point,It.point),cosine:tr(this.point,be.point,It.point)})};return(Pt,It)=>{Ne.has(Pt)||ot(Pt),Ne.has(It)||ot(It);const{sine:xn,cosine:Qn}=Ne.get(Pt),{sine:br,cosine:Jn}=Ne.get(It);return xn>=0&&br>=0?Qn<Jn?1:Qn>Jn?-1:0:xn<0&&br<0?Qn<Jn?-1:Qn>Jn?1:0:br<xn?-1:br>xn?1:0}}}let qe=0;class Bt{static compare(be,Ne){const ot=be.leftSE.point.x,Pt=Ne.leftSE.point.x,It=be.rightSE.point.x,xn=Ne.rightSE.point.x;if(xn<ot)return 1;if(It<Pt)return-1;const Qn=be.leftSE.point.y,br=Ne.leftSE.point.y,Jn=be.rightSE.point.y,Ae=Ne.rightSE.point.y;if(ot<Pt){if(br<Qn&&br<Jn)return 1;if(br>Qn&&br>Jn)return-1;const xe=be.comparePoint(Ne.leftSE.point);if(xe<0)return 1;if(xe>0)return-1;const ke=Ne.comparePoint(be.rightSE.point);return ke!==0?ke:-1}if(ot>Pt){if(Qn<br&&Qn<Ae)return-1;if(Qn>br&&Qn>Ae)return 1;const xe=Ne.comparePoint(be.leftSE.point);if(xe!==0)return xe;const ke=be.comparePoint(Ne.rightSE.point);return ke<0?1:ke>0?-1:1}if(Qn<br)return-1;if(Qn>br)return 1;if(It<xn){const xe=Ne.comparePoint(be.rightSE.point);if(xe!==0)return xe}if(It>xn){const xe=be.comparePoint(Ne.rightSE.point);if(xe<0)return 1;if(xe>0)return-1}if(It!==xn){const xe=Jn-Qn,ke=It-ot,tt=Ae-br,Et=xn-Pt;if(xe>ke&&tt<Et)return 1;if(xe<ke&&tt>Et)return-1}return It>xn?1:It<xn||Jn<Ae?-1:Jn>Ae?1:be.id<Ne.id?-1:be.id>Ne.id?1:0}constructor(be,Ne,ot,Pt){this.id=++qe,this.leftSE=be,be.segment=this,be.otherSE=Ne,this.rightSE=Ne,Ne.segment=this,Ne.otherSE=be,this.rings=ot,this.windings=Pt}static fromRing(be,Ne,ot){let Pt,It,xn;const Qn=Ie.comparePoints(be,Ne);if(Qn<0)Pt=be,It=Ne,xn=1;else if(Qn>0)Pt=Ne,It=be,xn=-1;else throw new Error(`Tried to create degenerate segment at [${be.x}, ${be.y}]`);const br=new Ie(Pt,!0),Jn=new Ie(It,!1);return new Bt(br,Jn,[ot],[xn])}replaceRightSE(be){this.rightSE=be,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const be=this.leftSE.point.y,Ne=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:be<Ne?be:Ne},ur:{x:this.rightSE.point.x,y:be>Ne?be:Ne}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(be){return be.x===this.leftSE.point.x&&be.y===this.leftSE.point.y||be.x===this.rightSE.point.x&&be.y===this.rightSE.point.y}comparePoint(be){if(this.isAnEndpoint(be))return 0;const Ne=this.leftSE.point,ot=this.rightSE.point,Pt=this.vector();if(Ne.x===ot.x)return be.x===Ne.x?0:be.x<Ne.x?1:-1;const It=(be.y-Ne.y)/Pt.y,xn=Ne.x+It*Pt.x;if(be.x===xn)return 0;const Qn=(be.x-Ne.x)/Pt.x,br=Ne.y+Qn*Pt.y;return be.y===br?0:be.y<br?-1:1}getIntersection(be){const Ne=this.bbox(),ot=be.bbox(),Pt=xt(Ne,ot);if(Pt===null)return null;const It=this.leftSE.point,xn=this.rightSE.point,Qn=be.leftSE.point,br=be.rightSE.point,Jn=Ze(Ne,Qn)&&this.comparePoint(Qn)===0,Ae=Ze(ot,It)&&be.comparePoint(It)===0,xe=Ze(Ne,br)&&this.comparePoint(br)===0,ke=Ze(ot,xn)&&be.comparePoint(xn)===0;if(Ae&&Jn)return ke&&!xe?xn:!ke&&xe?br:null;if(Ae)return xe&&It.x===br.x&&It.y===br.y?null:It;if(Jn)return ke&&xn.x===Qn.x&&xn.y===Qn.y?null:Qn;if(ke&&xe)return null;if(ke)return xn;if(xe)return br;const tt=Dt(It,this.vector(),Qn,be.vector());return tt===null||!Ze(Pt,tt)?null:Re.round(tt.x,tt.y)}split(be){const Ne=[],ot=be.events!==void 0,Pt=new Ie(be,!0),It=new Ie(be,!1),xn=this.rightSE;this.replaceRightSE(It),Ne.push(It),Ne.push(Pt);const Qn=new Bt(Pt,xn,this.rings.slice(),this.windings.slice());return Ie.comparePoints(Qn.leftSE.point,Qn.rightSE.point)>0&&Qn.swapEvents(),Ie.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),ot&&(Pt.checkForConsuming(),It.checkForConsuming()),Ne}swapEvents(){const be=this.rightSE;this.rightSE=this.leftSE,this.leftSE=be,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let Ne=0,ot=this.windings.length;Ne<ot;Ne++)this.windings[Ne]*=-1}consume(be){let Ne=this,ot=be;for(;Ne.consumedBy;)Ne=Ne.consumedBy;for(;ot.consumedBy;)ot=ot.consumedBy;const Pt=Bt.compare(Ne,ot);if(Pt!==0){if(Pt>0){const It=Ne;Ne=ot,ot=It}if(Ne.prev===ot){const It=Ne;Ne=ot,ot=It}for(let It=0,xn=ot.rings.length;It<xn;It++){const Qn=ot.rings[It],br=ot.windings[It],Jn=Ne.rings.indexOf(Qn);Jn===-1?(Ne.rings.push(Qn),Ne.windings.push(br)):Ne.windings[Jn]+=br}ot.rings=null,ot.windings=null,ot.consumedBy=Ne,ot.leftSE.consumedBy=Ne.leftSE,ot.rightSE.consumedBy=Ne.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const be=this.prev.consumedBy||this.prev;this._beforeState=be.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const be=this.beforeState();this._afterState={rings:be.rings.slice(0),windings:be.windings.slice(0),multiPolys:[]};const Ne=this._afterState.rings,ot=this._afterState.windings,Pt=this._afterState.multiPolys;for(let Qn=0,br=this.rings.length;Qn<br;Qn++){const Jn=this.rings[Qn],Ae=this.windings[Qn],xe=Ne.indexOf(Jn);xe===-1?(Ne.push(Jn),ot.push(Ae)):ot[xe]+=Ae}const It=[],xn=[];for(let Qn=0,br=Ne.length;Qn<br;Qn++){if(ot[Qn]===0)continue;const Jn=Ne[Qn],Ae=Jn.poly;if(xn.indexOf(Ae)===-1)if(Jn.isExterior)It.push(Ae);else{xn.indexOf(Ae)===-1&&xn.push(Ae);const xe=It.indexOf(Jn.poly);xe!==-1&&It.splice(xe,1)}}for(let Qn=0,br=It.length;Qn<br;Qn++){const Jn=It[Qn].multiPoly;Pt.indexOf(Jn)===-1&&Pt.push(Jn)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const be=this.beforeState().multiPolys,Ne=this.afterState().multiPolys;switch(hn.type){case"union":{const ot=be.length===0,Pt=Ne.length===0;this._isInResult=ot!==Pt;break}case"intersection":{let ot,Pt;be.length<Ne.length?(ot=be.length,Pt=Ne.length):(ot=Ne.length,Pt=be.length),this._isInResult=Pt===hn.numMultiPolys&&ot<Pt;break}case"xor":{const ot=Math.abs(be.length-Ne.length);this._isInResult=ot%2===1;break}case"difference":{const ot=Pt=>Pt.length===1&&Pt[0].isSubject;this._isInResult=ot(be)!==ot(Ne);break}default:throw new Error(`Unrecognized operation type found ${hn.type}`)}return this._isInResult}}class j{constructor(be,Ne,ot){if(!Array.isArray(be)||be.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Ne,this.isExterior=ot,this.segments=[],typeof be[0][0]!="number"||typeof be[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const Pt=Re.round(be[0][0],be[0][1]);this.bbox={ll:{x:Pt.x,y:Pt.y},ur:{x:Pt.x,y:Pt.y}};let It=Pt;for(let xn=1,Qn=be.length;xn<Qn;xn++){if(typeof be[xn][0]!="number"||typeof be[xn][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let br=Re.round(be[xn][0],be[xn][1]);br.x===It.x&&br.y===It.y||(this.segments.push(Bt.fromRing(It,br,this)),br.x<this.bbox.ll.x&&(this.bbox.ll.x=br.x),br.y<this.bbox.ll.y&&(this.bbox.ll.y=br.y),br.x>this.bbox.ur.x&&(this.bbox.ur.x=br.x),br.y>this.bbox.ur.y&&(this.bbox.ur.y=br.y),It=br)}(Pt.x!==It.x||Pt.y!==It.y)&&this.segments.push(Bt.fromRing(It,Pt,this))}getSweepEvents(){const be=[];for(let Ne=0,ot=this.segments.length;Ne<ot;Ne++){const Pt=this.segments[Ne];be.push(Pt.leftSE),be.push(Pt.rightSE)}return be}}class le{constructor(be,Ne){if(!Array.isArray(be))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new j(be[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let ot=1,Pt=be.length;ot<Pt;ot++){const It=new j(be[ot],this,!1);It.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=It.bbox.ll.x),It.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=It.bbox.ll.y),It.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=It.bbox.ur.x),It.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=It.bbox.ur.y),this.interiorRings.push(It)}this.multiPoly=Ne}getSweepEvents(){const be=this.exteriorRing.getSweepEvents();for(let Ne=0,ot=this.interiorRings.length;Ne<ot;Ne++){const Pt=this.interiorRings[Ne].getSweepEvents();for(let It=0,xn=Pt.length;It<xn;It++)be.push(Pt[It])}return be}}class z{constructor(be,Ne){if(!Array.isArray(be))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof be[0][0][0]=="number"&&(be=[be])}catch(ot){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let ot=0,Pt=be.length;ot<Pt;ot++){const It=new le(be[ot],this);It.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=It.bbox.ll.x),It.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=It.bbox.ll.y),It.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=It.bbox.ur.x),It.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=It.bbox.ur.y),this.polys.push(It)}this.isSubject=Ne}getSweepEvents(){const be=[];for(let Ne=0,ot=this.polys.length;Ne<ot;Ne++){const Pt=this.polys[Ne].getSweepEvents();for(let It=0,xn=Pt.length;It<xn;It++)be.push(Pt[It])}return be}}class de{static factory(be){const Ne=[];for(let ot=0,Pt=be.length;ot<Pt;ot++){const It=be[ot];if(!It.isInResult()||It.ringOut)continue;let xn=null,Qn=It.leftSE,br=It.rightSE;const Jn=[Qn],Ae=Qn.point,xe=[];for(;xn=Qn,Qn=br,Jn.push(Qn),Qn.point!==Ae;)for(;;){const ke=Qn.getAvailableLinkedEvents();if(ke.length===0){const tn=Jn[0].point,fn=Jn[Jn.length-1].point;throw new Error(`Unable to complete output ring starting at [${tn.x}, ${tn.y}]. Last matching segment found ends at [${fn.x}, ${fn.y}].`)}if(ke.length===1){br=ke[0].otherSE;break}let tt=null;for(let tn=0,fn=xe.length;tn<fn;tn++)if(xe[tn].point===Qn.point){tt=tn;break}if(tt!==null){const tn=xe.splice(tt)[0],fn=Jn.splice(tn.index);fn.unshift(fn[0].otherSE),Ne.push(new de(fn.reverse()));continue}xe.push({index:Jn.length,point:Qn.point});const Et=Qn.getLeftmostComparator(xn);br=ke.sort(Et)[0].otherSE;break}Ne.push(new de(Jn))}return Ne}constructor(be){this.events=be;for(let Ne=0,ot=be.length;Ne<ot;Ne++)be[Ne].segment.ringOut=this;this.poly=null}getGeom(){let be=this.events[0].point;const Ne=[be];for(let Jn=1,Ae=this.events.length-1;Jn<Ae;Jn++){const xe=this.events[Jn].point,ke=this.events[Jn+1].point;Ht(xe,be,ke)!==0&&(Ne.push(xe),be=xe)}if(Ne.length===1)return null;const ot=Ne[0],Pt=Ne[1];Ht(ot,be,Pt)===0&&Ne.shift(),Ne.push(Ne[0]);const It=this.isExteriorRing()?1:-1,xn=this.isExteriorRing()?0:Ne.length-1,Qn=this.isExteriorRing()?Ne.length:-1,br=[];for(let Jn=xn;Jn!=Qn;Jn+=It)br.push([Ne[Jn].x,Ne[Jn].y]);return br}isExteriorRing(){if(this._isExteriorRing===void 0){const be=this.enclosingRing();this._isExteriorRing=be?!be.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let be=this.events[0];for(let Pt=1,It=this.events.length;Pt<It;Pt++){const xn=this.events[Pt];Ie.compare(be,xn)>0&&(be=xn)}let Ne=be.segment.prevInResult(),ot=Ne?Ne.prevInResult():null;for(;;){if(!Ne)return null;if(!ot)return Ne.ringOut;if(ot.ringOut!==Ne.ringOut)return ot.ringOut.enclosingRing()!==Ne.ringOut?Ne.ringOut:Ne.ringOut.enclosingRing();Ne=ot.prevInResult(),ot=Ne?Ne.prevInResult():null}}}class Zt{constructor(be){this.exteriorRing=be,be.poly=this,this.interiorRings=[]}addInterior(be){this.interiorRings.push(be),be.poly=this}getGeom(){const be=[this.exteriorRing.getGeom()];if(be[0]===null)return null;for(let Ne=0,ot=this.interiorRings.length;Ne<ot;Ne++){const Pt=this.interiorRings[Ne].getGeom();Pt!==null&&be.push(Pt)}return be}}class nt{constructor(be){this.rings=be,this.polys=this._composePolys(be)}getGeom(){const be=[];for(let Ne=0,ot=this.polys.length;Ne<ot;Ne++){const Pt=this.polys[Ne].getGeom();Pt!==null&&be.push(Pt)}return be}_composePolys(be){const Ne=[];for(let ot=0,Pt=be.length;ot<Pt;ot++){const It=be[ot];if(!It.poly)if(It.isExteriorRing())Ne.push(new Zt(It));else{const xn=It.enclosingRing();xn.poly||Ne.push(new Zt(xn)),xn.poly.addInterior(It)}}return Ne}}class St{constructor(be){let Ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bt.compare;this.queue=be,this.tree=new ze(Ne),this.segments=[]}process(be){const Ne=be.segment,ot=[];if(be.consumedBy)return be.isLeft?this.queue.remove(be.otherSE):this.tree.remove(Ne),ot;const Pt=be.isLeft?this.tree.add(Ne):this.tree.find(Ne);if(!Pt)throw new Error(`Unable to find segment #${Ne.id} [${Ne.leftSE.point.x}, ${Ne.leftSE.point.y}] -> [${Ne.rightSE.point.x}, ${Ne.rightSE.point.y}] in SweepLine tree.`);let It=Pt,xn=Pt,Qn,br;for(;Qn===void 0;)It=this.tree.prev(It),It===null?Qn=null:It.key.consumedBy===void 0&&(Qn=It.key);for(;br===void 0;)xn=this.tree.next(xn),xn===null?br=null:xn.key.consumedBy===void 0&&(br=xn.key);if(be.isLeft){let Jn=null;if(Qn){const xe=Qn.getIntersection(Ne);if(xe!==null&&(Ne.isAnEndpoint(xe)||(Jn=xe),!Qn.isAnEndpoint(xe))){const ke=this._splitSafely(Qn,xe);for(let tt=0,Et=ke.length;tt<Et;tt++)ot.push(ke[tt])}}let Ae=null;if(br){const xe=br.getIntersection(Ne);if(xe!==null&&(Ne.isAnEndpoint(xe)||(Ae=xe),!br.isAnEndpoint(xe))){const ke=this._splitSafely(br,xe);for(let tt=0,Et=ke.length;tt<Et;tt++)ot.push(ke[tt])}}if(Jn!==null||Ae!==null){let xe=null;Jn===null?xe=Ae:Ae===null?xe=Jn:xe=Ie.comparePoints(Jn,Ae)<=0?Jn:Ae,this.queue.remove(Ne.rightSE),ot.push(Ne.rightSE);const ke=Ne.split(xe);for(let tt=0,Et=ke.length;tt<Et;tt++)ot.push(ke[tt])}ot.length>0?(this.tree.remove(Ne),ot.push(be)):(this.segments.push(Ne),Ne.prev=Qn)}else{if(Qn&&br){const Jn=Qn.getIntersection(br);if(Jn!==null){if(!Qn.isAnEndpoint(Jn)){const Ae=this._splitSafely(Qn,Jn);for(let xe=0,ke=Ae.length;xe<ke;xe++)ot.push(Ae[xe])}if(!br.isAnEndpoint(Jn)){const Ae=this._splitSafely(br,Jn);for(let xe=0,ke=Ae.length;xe<ke;xe++)ot.push(Ae[xe])}}}this.tree.remove(Ne)}return ot}_splitSafely(be,Ne){this.tree.remove(be);const ot=be.rightSE;this.queue.remove(ot);const Pt=be.split(Ne);return Pt.push(ot),be.consumedBy===void 0&&this.tree.add(be),Pt}}const In=typeof ee!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Wn=typeof ee!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class qn{run(be,Ne,ot){hn.type=be,Re.reset();const Pt=[new z(Ne,!0)];for(let xe=0,ke=ot.length;xe<ke;xe++)Pt.push(new z(ot[xe],!1));if(hn.numMultiPolys=Pt.length,hn.type==="difference"){const xe=Pt[0];let ke=1;for(;ke<Pt.length;)xt(Pt[ke].bbox,xe.bbox)!==null?ke++:Pt.splice(ke,1)}if(hn.type==="intersection")for(let xe=0,ke=Pt.length;xe<ke;xe++){const tt=Pt[xe];for(let Et=xe+1,tn=Pt.length;Et<tn;Et++)if(xt(tt.bbox,Pt[Et].bbox)===null)return[]}const It=new ze(Ie.compare);for(let xe=0,ke=Pt.length;xe<ke;xe++){const tt=Pt[xe].getSweepEvents();for(let Et=0,tn=tt.length;Et<tn;Et++)if(It.insert(tt[Et]),It.size>In)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const xn=new St(It);let Qn=It.size,br=It.pop();for(;br;){const xe=br.key;if(It.size===Qn){const tt=xe.segment;throw new Error(`Unable to pop() ${xe.isLeft?"left":"right"} SweepEvent [${xe.point.x}, ${xe.point.y}] from segment #${tt.id} [${tt.leftSE.point.x}, ${tt.leftSE.point.y}] -> [${tt.rightSE.point.x}, ${tt.rightSE.point.y}] from queue.`)}if(It.size>In)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(xn.segments.length>Wn)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const ke=xn.process(xe);for(let tt=0,Et=ke.length;tt<Et;tt++){const tn=ke[tt];tn.consumedBy===void 0&&It.insert(tn)}Qn=It.size,br=It.pop()}Re.reset();const Jn=de.factory(xn.segments);return new nt(Jn).getGeom()}}const hn=new qn;var Xn={union:function(dt){for(var be=arguments.length,Ne=new Array(be>1?be-1:0),ot=1;ot<be;ot++)Ne[ot-1]=arguments[ot];return hn.run("union",dt,Ne)},intersection:function(dt){for(var be=arguments.length,Ne=new Array(be>1?be-1:0),ot=1;ot<be;ot++)Ne[ot-1]=arguments[ot];return hn.run("intersection",dt,Ne)},xor:function(dt){for(var be=arguments.length,Ne=new Array(be>1?be-1:0),ot=1;ot<be;ot++)Ne[ot-1]=arguments[ot];return hn.run("xor",dt,Ne)},difference:function(dt){for(var be=arguments.length,Ne=new Array(be>1?be-1:0),ot=1;ot<be;ot++)Ne[ot-1]=arguments[ot];return hn.run("difference",dt,Ne)}};return Xn})},45598:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=ve;var X=ee(D(67294)),E=D(11805);function ve(re){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae=[];return X.default.Children.forEach(re,function(Ee){Ee==null&&!fe.keepEmpty||(Array.isArray(Ee)?ae=ae.concat(ve(Ee)):(0,E.isFragment)(Ee)&&Ee.props?ae=ae.concat(ve(Ee.props.children,fe)):ae.push(Ee))}),ae}},3481:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.isStyleSupport=re;var X=ee(D(19158)),E=function(ae){if((0,X.default)()&&window.document.documentElement){var Ee=Array.isArray(ae)?ae:[ae],oe=window.document.documentElement;return Ee.some(function(ze){return ze in oe.style})}return!1},ve=function(ae,Ee){if(!E(ae))return!1;var oe=document.createElement("div"),ze=oe.style[ae];return oe.style[ae]=Ee,oe.style[ae]!==ze};function re(fe,ae){return!Array.isArray(fe)&&ae!==void 0?ve(fe,ae):E(fe)}},27712:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var D={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(E){var ve=E.keyCode;if(E.altKey&&!E.ctrlKey||E.metaKey||ve>=D.F1&&ve<=D.F12)return!1;switch(ve){case D.ALT:case D.CAPS_LOCK:case D.CONTEXT_MENU:case D.CTRL:case D.DOWN:case D.END:case D.ESC:case D.HOME:case D.INSERT:case D.LEFT:case D.MAC_FF_META:case D.META:case D.NUMLOCK:case D.NUM_CENTER:case D.PAGE_DOWN:case D.PAGE_UP:case D.PAUSE:case D.PRINT_SCREEN:case D.RIGHT:case D.SHIFT:case D.UP:case D.WIN_KEY:case D.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(E){if(E>=D.ZERO&&E<=D.NINE||E>=D.NUM_ZERO&&E<=D.NUM_MULTIPLY||E>=D.A&&E<=D.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&E===0)return!0;switch(E){case D.SPACE:case D.QUESTION_MARK:case D.NUM_PLUS:case D.NUM_MINUS:case D.NUM_PERIOD:case D.NUM_DIVISION:case D.SEMICOLON:case D.DASH:case D.EQUALS:case D.COMMA:case D.PERIOD:case D.SLASH:case D.APOSTROPHE:case D.SINGLE_QUOTE:case D.OPEN_SQUARE_BRACKET:case D.BACKSLASH:case D.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},ee=W.default=D},18545:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(67294));function E(ve){var re=X.useRef();re.current=ve;var fe=X.useCallback(function(){for(var ae,Ee=arguments.length,oe=new Array(Ee),ze=0;ze<Ee;ze++)oe[ze]=arguments[ze];return(ae=re.current)===null||ae===void 0?void 0:ae.call.apply(ae,[re].concat(oe))},[]);return fe}},82546:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.useLayoutUpdateEffect=W.default=void 0;var E=X(D(67294)),ve=ee(D(19158)),re=(0,ve.default)()?E.useLayoutEffect:E.useEffect,fe=function(ze,te){var ye=E.useRef(!0);re(function(){return ze(ye.current)},te),re(function(){return ye.current=!1,function(){ye.current=!0}},[])},ae=W.useLayoutUpdateEffect=function(ze,te){fe(function(ye){if(!ye)return ze()},te)},Ee=W.default=fe},67265:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(67294));function E(ve,re,fe){var ae=X.useRef({});return(!("value"in ae.current)||fe(ae.current.condition,re))&&(ae.current.value=ve(),ae.current.condition=re),ae.current.value}},60869:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=ae;var X=ee(D(27424)),E=ee(D(18545)),ve=D(82546),re=ee(D(78423));function fe(Ee){return Ee!==void 0}function ae(Ee,oe){var ze=oe||{},te=ze.defaultValue,ye=ze.value,De=ze.onChange,Se=ze.postState,we=(0,re.default)(function(){return fe(ye)?ye:fe(te)?typeof te=="function"?te():te:typeof Ee=="function"?Ee():Ee}),ce=(0,X.default)(we,2),Ze=ce[0],xt=ce[1],ht=ye!==void 0?ye:Ze,Gt=Se?Se(ht):ht,mt=(0,E.default)(De),gt=(0,re.default)([ht]),Be=(0,X.default)(gt,2),Re=Be[0],bt=Be[1];(0,ve.useLayoutUpdateEffect)(function(){var At=Re[0];Ze!==At&&mt(Ze,At)},[Re]),(0,ve.useLayoutUpdateEffect)(function(){fe(ye)||xt(ye)},[ye]);var yt=(0,E.default)(function(At,bn){xt(At,bn),bt([ht],bn)});return[Gt,yt]}},78423:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=re;var E=X(D(27424)),ve=ee(D(67294));function re(fe){var ae=ve.useRef(!1),Ee=ve.useState(fe),oe=(0,E.default)(Ee,2),ze=oe[0],te=oe[1];ve.useEffect(function(){return ae.current=!1,function(){ae.current=!0}},[]);function ye(De,Se){Se&&ae.current||te(De)}return[ze,ye]}},11102:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(18698)),E=ee(D(45520));function ve(fe,ae){var Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,oe=new Set;function ze(te,ye){var De=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Se=oe.has(te);if((0,E.default)(!Se,"Warning: There may be circular references"),Se)return!1;if(te===ye)return!0;if(Ee&&De>1)return!1;oe.add(te);var we=De+1;if(Array.isArray(te)){if(!Array.isArray(ye)||te.length!==ye.length)return!1;for(var ce=0;ce<te.length;ce++)if(!ze(te[ce],ye[ce],we))return!1;return!0}if(te&&ye&&(0,X.default)(te)==="object"&&(0,X.default)(ye)==="object"){var Ze=Object.keys(te);return Ze.length!==Object.keys(ye).length?!1:Ze.every(function(xt){return ze(te[xt],ye[xt],we)})}return!1}return ze(fe,ae)}var re=W.default=ve},18475:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=D;function D(ee,X){var E=Object.assign({},ee);return Array.isArray(X)&&X.forEach(function(ve){delete E[ve]}),E}},75531:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.useComposeRef=W.supportRef=W.supportNodeRef=W.getNodeRef=W.fillRef=W.composeRef=void 0;var X=ee(D(18698)),E=D(67294),ve=D(11805),re=ee(D(67265)),fe=W.fillRef=function(Se,we){typeof Se=="function"?Se(we):(0,X.default)(Se)==="object"&&Se&&"current"in Se&&(Se.current=we)},ae=W.composeRef=function(){for(var Se=arguments.length,we=new Array(Se),ce=0;ce<Se;ce++)we[ce]=arguments[ce];var Ze=we.filter(Boolean);return Ze.length<=1?Ze[0]:function(xt){we.forEach(function(ht){fe(ht,xt)})}},Ee=W.useComposeRef=function(){for(var Se=arguments.length,we=new Array(Se),ce=0;ce<Se;ce++)we[ce]=arguments[ce];return(0,re.default)(function(){return ae.apply(void 0,we)},we,function(Ze,xt){return Ze.length!==xt.length||Ze.every(function(ht,Gt){return ht!==xt[Gt]})})},oe=W.supportRef=function(Se){var we,ce,Ze=(0,ve.isMemo)(Se)?Se.type.type:Se.type;return!(typeof Ze=="function"&&!((we=Ze.prototype)!==null&&we!==void 0&&we.render)&&Ze.$$typeof!==ve.ForwardRef||typeof Se=="function"&&!((ce=Se.prototype)!==null&&ce!==void 0&&ce.render)&&Se.$$typeof!==ve.ForwardRef)};function ze(De){return(0,E.isValidElement)(De)&&!(0,ve.isFragment)(De)}var te=W.supportNodeRef=function(Se){return ze(Se)&&oe(Se)},ye=W.getNodeRef=Number(E.version.split(".")[0])>=19?function(De){return ze(De)?De.props.ref:null}:function(De){return ze(De)?De.ref:null}},94787:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=D;function D(ee,X){for(var E=ee,ve=0;ve<X.length;ve+=1){if(E==null)return;E=E[X[ve]]}return E}},20059:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=Ee,W.merge=ye;var X=ee(D(18698)),E=ee(D(42122)),ve=ee(D(861)),re=ee(D(51589)),fe=ee(D(94787));function ae(De,Se,we,ce){if(!Se.length)return we;var Ze=(0,re.default)(Se),xt=Ze[0],ht=Ze.slice(1),Gt;return!De&&typeof xt=="number"?Gt=[]:Array.isArray(De)?Gt=(0,ve.default)(De):Gt=(0,E.default)({},De),ce&&we===void 0&&ht.length===1?delete Gt[xt][ht[0]]:Gt[xt]=ae(Gt[xt],ht,we,ce),Gt}function Ee(De,Se,we){var ce=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Se.length&&ce&&we===void 0&&!(0,fe.default)(De,Se.slice(0,-1))?De:ae(De,Se,we,ce)}function oe(De){return(0,X.default)(De)==="object"&&De!==null&&Object.getPrototypeOf(De)===Object.prototype}function ze(De){return Array.isArray(De)?[]:{}}var te=typeof Reflect=="undefined"?Object.keys:Reflect.ownKeys;function ye(){for(var De=arguments.length,Se=new Array(De),we=0;we<De;we++)Se[we]=arguments[we];var ce=ze(Se[0]);return Se.forEach(function(Ze){function xt(ht,Gt){var mt=new Set(Gt),gt=(0,fe.default)(Ze,ht),Be=Array.isArray(gt);if(Be||oe(gt)){if(!mt.has(gt)){mt.add(gt);var Re=(0,fe.default)(ce,ht);Be?ce=Ee(ce,ht,[]):(!Re||(0,X.default)(Re)!=="object")&&(ce=Ee(ce,ht,ze(gt))),te(gt).forEach(function(bt){xt([].concat((0,ve.default)(ht),[bt]),mt)})}}else ce=Ee(ce,ht,gt)}xt([])}),ce}},81550:function($t){(function(W,D){$t.exports=D()})(this,function(){"use strict";var W=function(Fe){return Fe instanceof Uint8Array||Fe instanceof Uint16Array||Fe instanceof Uint32Array||Fe instanceof Int8Array||Fe instanceof Int16Array||Fe instanceof Int32Array||Fe instanceof Float32Array||Fe instanceof Float64Array||Fe instanceof Uint8ClampedArray},D=function(Fe,Qt){for(var On=Object.keys(Qt),Or=0;Or<On.length;++Or)Fe[On[Or]]=Qt[On[Or]];return Fe},ee=`
`;function X(Fe){return typeof atob!="undefined"?atob(Fe):"base64:"+Fe}function E(Fe){var Qt=new Error("(regl) "+Fe);throw console.error(Qt),Qt}function ve(Fe,Qt){Fe||E(Qt)}function re(Fe){return Fe?": "+Fe:""}function fe(Fe,Qt,On){Fe in Qt||E("unknown parameter ("+Fe+")"+re(On)+". possible values: "+Object.keys(Qt).join())}function ae(Fe,Qt){W(Fe)||E("invalid parameter type"+re(Qt)+". must be a typed array")}function Ee(Fe,Qt){switch(Qt){case"number":return typeof Fe=="number";case"object":return typeof Fe=="object";case"string":return typeof Fe=="string";case"boolean":return typeof Fe=="boolean";case"function":return typeof Fe=="function";case"undefined":return typeof Fe=="undefined";case"symbol":return typeof Fe=="symbol"}}function oe(Fe,Qt,On){Ee(Fe,Qt)||E("invalid parameter type"+re(On)+". expected "+Qt+", got "+typeof Fe)}function ze(Fe,Qt){Fe>=0&&(Fe|0)===Fe||E("invalid parameter type, ("+Fe+")"+re(Qt)+". must be a nonnegative integer")}function te(Fe,Qt,On){Qt.indexOf(Fe)<0&&E("invalid value"+re(On)+". must be one of: "+Qt)}var ye=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function De(Fe){Object.keys(Fe).forEach(function(Qt){ye.indexOf(Qt)<0&&E('invalid regl constructor argument "'+Qt+'". must be one of '+ye)})}function Se(Fe,Qt){for(Fe=Fe+"";Fe.length<Qt;)Fe=" "+Fe;return Fe}function we(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function ce(Fe,Qt){this.number=Fe,this.line=Qt,this.errors=[]}function Ze(Fe,Qt,On){this.file=Fe,this.line=Qt,this.message=On}function xt(){var Fe=new Error,Qt=(Fe.stack||Fe).toString(),On=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Qt);if(On)return On[1];var Or=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Qt);return Or?Or[1]:"unknown"}function ht(){var Fe=new Error,Qt=(Fe.stack||Fe).toString(),On=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Qt);if(On)return On[1];var Or=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Qt);return Or?Or[1]:"unknown"}function Gt(Fe,Qt){var On=Fe.split(`
`),Or=1,Wr=0,Rr={unknown:new we,0:new we};Rr.unknown.name=Rr[0].name=Qt||xt(),Rr.unknown.lines.push(new ce(0,""));for(var _r=0;_r<On.length;++_r){var Ti=On[_r],li=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ti);if(li)switch(li[1]){case"line":var Fi=/(\d+)(\s+\d+)?/.exec(li[2]);Fi&&(Or=Fi[1]|0,Fi[2]&&(Wr=Fi[2]|0,Wr in Rr||(Rr[Wr]=new we)));break;case"define":var Ri=/SHADER_NAME(_B64)?\s+(.*)$/.exec(li[2]);Ri&&(Rr[Wr].name=Ri[1]?X(Ri[2]):Ri[2]);break}Rr[Wr].lines.push(new ce(Or++,Ti))}return Object.keys(Rr).forEach(function(Di){var Xi=Rr[Di];Xi.lines.forEach(function(pi){Xi.index[pi.number]=pi})}),Rr}function mt(Fe){var Qt=[];return Fe.split(`
`).forEach(function(On){if(!(On.length<5)){var Or=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(On);Or?Qt.push(new Ze(Or[1]|0,Or[2]|0,Or[3].trim())):On.length>0&&Qt.push(new Ze("unknown",0,On))}}),Qt}function gt(Fe,Qt){Qt.forEach(function(On){var Or=Fe[On.file];if(Or){var Wr=Or.index[On.line];if(Wr){Wr.errors.push(On),Or.hasErrors=!0;return}}Fe.unknown.hasErrors=!0,Fe.unknown.lines[0].errors.push(On)})}function Be(Fe,Qt,On,Or,Wr){if(!Fe.getShaderParameter(Qt,Fe.COMPILE_STATUS)){var Rr=Fe.getShaderInfoLog(Qt),_r=Or===Fe.FRAGMENT_SHADER?"fragment":"vertex";Rt(On,"string",_r+" shader source must be a string",Wr);var Ti=Gt(On,Wr),li=mt(Rr);gt(Ti,li),Object.keys(Ti).forEach(function(Fi){var Ri=Ti[Fi];if(!Ri.hasErrors)return;var Di=[""],Xi=[""];function pi(Ni,pr){Di.push(Ni),Xi.push(pr||"")}pi("file number "+Fi+": "+Ri.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Ri.lines.forEach(function(Ni){if(Ni.errors.length>0){pi(Se(Ni.number,4)+"|  ","background-color:yellow; font-weight:bold"),pi(Ni.line+ee,"color:red; background-color:yellow; font-weight:bold");var pr=0;Ni.errors.forEach(function(Lr){var yi=Lr.message,eo=/^\s*'(.*)'\s*:\s*(.*)$/.exec(yi);if(eo){var ii=eo[1];switch(yi=eo[2],ii){case"assign":ii="=";break}pr=Math.max(Ni.line.indexOf(ii,pr),0)}else pr=0;pi(Se("| ",6)),pi(Se("^^^",pr+3)+ee,"font-weight:bold"),pi(Se("| ",6)),pi(yi+ee,"font-weight:bold")}),pi(Se("| ",6)+ee)}else pi(Se(Ni.number,4)+"|  "),pi(Ni.line+ee,"color:red")}),typeof document!="undefined"&&!window.chrome?(Xi[0]=Di.join("%c"),console.log.apply(console,Xi)):console.log(Di.join(""))}),ve.raise("Error compiling "+_r+" shader, "+Ti[0].name)}}function Re(Fe,Qt,On,Or,Wr){if(!Fe.getProgramParameter(Qt,Fe.LINK_STATUS)){var Rr=Fe.getProgramInfoLog(Qt),_r=Gt(On,Wr),Ti=Gt(Or,Wr),li='Error linking program with vertex shader, "'+Ti[0].name+'", and fragment shader "'+_r[0].name+'"';typeof document!="undefined"?console.log("%c"+li+ee+"%c"+Rr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(li+ee+Rr),ve.raise(li)}}function bt(Fe){Fe._commandRef=xt()}function yt(Fe,Qt,On,Or){bt(Fe);function Wr(li){return li?Or.id(li):0}Fe._fragId=Wr(Fe.static.frag),Fe._vertId=Wr(Fe.static.vert);function Rr(li,Fi){Object.keys(Fi).forEach(function(Ri){li[Or.id(Ri)]=!0})}var _r=Fe._uniformSet={};Rr(_r,Qt.static),Rr(_r,Qt.dynamic);var Ti=Fe._attributeSet={};Rr(Ti,On.static),Rr(Ti,On.dynamic),Fe._hasCount="count"in Fe.static||"count"in Fe.dynamic||"elements"in Fe.static||"elements"in Fe.dynamic}function At(Fe,Qt){var On=ht();E(Fe+" in command "+(Qt||xt())+(On==="unknown"?"":" called from "+On))}function bn(Fe,Qt,On){Fe||At(Qt,On||xt())}function He(Fe,Qt,On,Or){Fe in Qt||At("unknown parameter ("+Fe+")"+re(On)+". possible values: "+Object.keys(Qt).join(),Or||xt())}function Rt(Fe,Qt,On,Or){Ee(Fe,Qt)||At("invalid parameter type"+re(On)+". expected "+Qt+", got "+typeof Fe,Or||xt())}function Oe(Fe){Fe()}function it(Fe,Qt,On){Fe.texture?te(Fe.texture._texture.internalformat,Qt,"unsupported texture format for attachment"):te(Fe.renderbuffer._renderbuffer.format,On,"unsupported renderbuffer format for attachment")}var Qe=33071,$e=9728,Ot=9984,vt=9985,Me=9986,Xt=9987,on=5120,Fn=5121,$n=5122,nr=5123,Ht=5124,Jt=5125,_n=5126,tr=32819,an=32820,Ut=33635,Dt=34042,Ie=36193,qe={};qe[on]=qe[Fn]=1,qe[$n]=qe[nr]=qe[Ie]=qe[Ut]=qe[tr]=qe[an]=2,qe[Ht]=qe[Jt]=qe[_n]=qe[Dt]=4;function Bt(Fe,Qt){return Fe===an||Fe===tr||Fe===Ut?2:Fe===Dt?4:qe[Fe]*Qt}function j(Fe){return!(Fe&Fe-1)&&!!Fe}function le(Fe,Qt,On){var Or,Wr=Qt.width,Rr=Qt.height,_r=Qt.channels;ve(Wr>0&&Wr<=On.maxTextureSize&&Rr>0&&Rr<=On.maxTextureSize,"invalid texture shape"),(Fe.wrapS!==Qe||Fe.wrapT!==Qe)&&ve(j(Wr)&&j(Rr),"incompatible wrap mode for texture, both width and height must be power of 2"),Qt.mipmask===1?Wr!==1&&Rr!==1&&ve(Fe.minFilter!==Ot&&Fe.minFilter!==Me&&Fe.minFilter!==vt&&Fe.minFilter!==Xt,"min filter requires mipmap"):(ve(j(Wr)&&j(Rr),"texture must be a square power of 2 to support mipmapping"),ve(Qt.mipmask===(Wr<<1)-1,"missing or incomplete mipmap data")),Qt.type===_n&&(On.extensions.indexOf("oes_texture_float_linear")<0&&ve(Fe.minFilter===$e&&Fe.magFilter===$e,"filter not supported, must enable oes_texture_float_linear"),ve(!Fe.genMipmaps,"mipmap generation not supported with float textures"));var Ti=Qt.images;for(Or=0;Or<16;++Or)if(Ti[Or]){var li=Wr>>Or,Fi=Rr>>Or;ve(Qt.mipmask&1<<Or,"missing mipmap data");var Ri=Ti[Or];if(ve(Ri.width===li&&Ri.height===Fi,"invalid shape for mip images"),ve(Ri.format===Qt.format&&Ri.internalformat===Qt.internalformat&&Ri.type===Qt.type,"incompatible type for mip image"),!Ri.compressed)if(Ri.data){var Di=Math.ceil(Bt(Ri.type,_r)*li/Ri.unpackAlignment)*Ri.unpackAlignment;ve(Ri.data.byteLength===Di*Fi,"invalid data for image, buffer size is inconsistent with image format")}else Ri.element||Ri.copy}else Fe.genMipmaps||ve((Qt.mipmask&1<<Or)===0,"extra mipmap data");Qt.compressed&&ve(!Fe.genMipmaps,"mipmap generation for compressed images not supported")}function z(Fe,Qt,On,Or){var Wr=Fe.width,Rr=Fe.height,_r=Fe.channels;ve(Wr>0&&Wr<=Or.maxTextureSize&&Rr>0&&Rr<=Or.maxTextureSize,"invalid texture shape"),ve(Wr===Rr,"cube map must be square"),ve(Qt.wrapS===Qe&&Qt.wrapT===Qe,"wrap mode not supported by cube map");for(var Ti=0;Ti<On.length;++Ti){var li=On[Ti];ve(li.width===Wr&&li.height===Rr,"inconsistent cube map face shape"),Qt.genMipmaps&&(ve(!li.compressed,"can not generate mipmap for compressed textures"),ve(li.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Fi=li.images,Ri=0;Ri<16;++Ri){var Di=Fi[Ri];if(Di){var Xi=Wr>>Ri,pi=Rr>>Ri;ve(li.mipmask&1<<Ri,"missing mipmap data"),ve(Di.width===Xi&&Di.height===pi,"invalid shape for mip images"),ve(Di.format===Fe.format&&Di.internalformat===Fe.internalformat&&Di.type===Fe.type,"incompatible type for mip image"),Di.compressed||(Di.data?ve(Di.data.byteLength===Xi*pi*Math.max(Bt(Di.type,_r),Di.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Di.element||Di.copy)}}}}var de=D(ve,{optional:Oe,raise:E,commandRaise:At,command:bn,parameter:fe,commandParameter:He,constructor:De,type:oe,commandType:Rt,isTypedArray:ae,nni:ze,oneOf:te,shaderError:Be,linkError:Re,callSite:ht,saveCommandRef:bt,saveDrawInfo:yt,framebufferFormat:it,guessCommand:xt,texture2D:le,textureCube:z}),Zt=0,nt=0;function St(Fe,Qt){this.id=Zt++,this.type=Fe,this.data=Qt}function In(Fe){return Fe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Wn(Fe){if(Fe.length===0)return[];var Qt=Fe.charAt(0),On=Fe.charAt(Fe.length-1);if(Fe.length>1&&Qt===On&&(Qt==='"'||Qt==="'"))return['"'+In(Fe.substr(1,Fe.length-2))+'"'];var Or=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Fe);if(Or)return Wn(Fe.substr(0,Or.index)).concat(Wn(Or[1])).concat(Wn(Fe.substr(Or.index+Or[0].length)));var Wr=Fe.split(".");if(Wr.length===1)return['"'+In(Fe)+'"'];for(var Rr=[],_r=0;_r<Wr.length;++_r)Rr=Rr.concat(Wn(Wr[_r]));return Rr}function qn(Fe){return"["+Wn(Fe).join("][")+"]"}function hn(Fe,Qt){return new St(Fe,qn(Qt+""))}function pt(Fe){return typeof Fe=="function"&&!Fe._reglType||Fe instanceof St}function Wt(Fe,Qt){return typeof Fe=="function"?new St(nt,Fe):Fe}var An={DynamicVariable:St,define:hn,isDynamic:pt,unbox:Wt,accessor:qn},Pn={next:typeof requestAnimationFrame=="function"?function(Fe){return requestAnimationFrame(Fe)}:function(Fe){return setTimeout(Fe,16)},cancel:typeof cancelAnimationFrame=="function"?function(Fe){return cancelAnimationFrame(Fe)}:clearTimeout},Xn=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function dt(){var Fe={"":0},Qt=[""];return{id:function(On){var Or=Fe[On];return Or||(Or=Fe[On]=Qt.length,Qt.push(On),Or)},str:function(On){return Qt[On]}}}function be(Fe,Qt,On){var Or=document.createElement("canvas");D(Or.style,{border:0,margin:0,padding:0,top:0,left:0}),Fe.appendChild(Or),Fe===document.body&&(Or.style.position="absolute",D(Fe.style,{margin:0,padding:0}));function Wr(){var Ti=window.innerWidth,li=window.innerHeight;if(Fe!==document.body){var Fi=Fe.getBoundingClientRect();Ti=Fi.right-Fi.left,li=Fi.bottom-Fi.top}Or.width=On*Ti,Or.height=On*li,D(Or.style,{width:Ti+"px",height:li+"px"})}var Rr;Fe!==document.body&&typeof ResizeObserver=="function"?(Rr=new ResizeObserver(function(){setTimeout(Wr)}),Rr.observe(Fe)):window.addEventListener("resize",Wr,!1);function _r(){Rr?Rr.disconnect():window.removeEventListener("resize",Wr),Fe.removeChild(Or)}return Wr(),{canvas:Or,onDestroy:_r}}function Ne(Fe,Qt){function On(Or){try{return Fe.getContext(Or,Qt)}catch(Wr){return null}}return On("webgl")||On("experimental-webgl")||On("webgl-experimental")}function ot(Fe){return typeof Fe.nodeName=="string"&&typeof Fe.appendChild=="function"&&typeof Fe.getBoundingClientRect=="function"}function Pt(Fe){return typeof Fe.drawArrays=="function"||typeof Fe.drawElements=="function"}function It(Fe){return typeof Fe=="string"?Fe.split():(de(Array.isArray(Fe),"invalid extension array"),Fe)}function xn(Fe){return typeof Fe=="string"?(de(typeof document!="undefined","not supported outside of DOM"),document.querySelector(Fe)):Fe}function Qn(Fe){var Qt=Fe||{},On,Or,Wr,Rr,_r={},Ti=[],li=[],Fi=typeof window=="undefined"?1:window.devicePixelRatio,Ri=!1,Di=function(Ni){Ni&&de.raise(Ni)},Xi=function(){};if(typeof Qt=="string"?(de(typeof document!="undefined","selector queries only supported in DOM enviroments"),On=document.querySelector(Qt),de(On,"invalid query string for element")):typeof Qt=="object"?ot(Qt)?On=Qt:Pt(Qt)?(Rr=Qt,Wr=Rr.canvas):(de.constructor(Qt),"gl"in Qt?Rr=Qt.gl:"canvas"in Qt?Wr=xn(Qt.canvas):"container"in Qt&&(Or=xn(Qt.container)),"attributes"in Qt&&(_r=Qt.attributes,de.type(_r,"object","invalid context attributes")),"extensions"in Qt&&(Ti=It(Qt.extensions)),"optionalExtensions"in Qt&&(li=It(Qt.optionalExtensions)),"onDone"in Qt&&(de.type(Qt.onDone,"function","invalid or missing onDone callback"),Di=Qt.onDone),"profile"in Qt&&(Ri=!!Qt.profile),"pixelRatio"in Qt&&(Fi=+Qt.pixelRatio,de(Fi>0,"invalid pixel ratio"))):de.raise("invalid arguments to regl"),On&&(On.nodeName.toLowerCase()==="canvas"?Wr=On:Or=On),!Rr){if(!Wr){de(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var pi=be(Or||document.body,Di,Fi);if(!pi)return null;Wr=pi.canvas,Xi=pi.onDestroy}_r.premultipliedAlpha===void 0&&(_r.premultipliedAlpha=!0),Rr=Ne(Wr,_r)}return Rr?{gl:Rr,canvas:Wr,container:Or,extensions:Ti,optionalExtensions:li,pixelRatio:Fi,profile:Ri,onDone:Di,onDestroy:Xi}:(Xi(),Di("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function br(Fe,Qt){var On={};function Or(_r){de.type(_r,"string","extension name must be string");var Ti=_r.toLowerCase(),li;try{li=On[Ti]=Fe.getExtension(Ti)}catch(Fi){}return!!li}for(var Wr=0;Wr<Qt.extensions.length;++Wr){var Rr=Qt.extensions[Wr];if(!Or(Rr))return Qt.onDestroy(),Qt.onDone('"'+Rr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Qt.optionalExtensions.forEach(Or),{extensions:On,restore:function(){Object.keys(On).forEach(function(_r){if(On[_r]&&!Or(_r))throw new Error("(regl): error restoring extension "+_r)})}}}function Jn(Fe,Qt){for(var On=Array(Fe),Or=0;Or<Fe;++Or)On[Or]=Qt(Or);return On}var Ae=5120,xe=5121,ke=5122,tt=5123,Et=5124,tn=5125,fn=5126;function _t(Fe){for(var Qt=16;Qt<=1<<28;Qt*=16)if(Fe<=Qt)return Qt;return 0}function en(Fe){var Qt,On;return Qt=(Fe>65535)<<4,Fe>>>=Qt,On=(Fe>255)<<3,Fe>>>=On,Qt|=On,On=(Fe>15)<<2,Fe>>>=On,Qt|=On,On=(Fe>3)<<1,Fe>>>=On,Qt|=On,Qt|Fe>>1}function Gn(){var Fe=Jn(8,function(){return[]});function Qt(Rr){var _r=_t(Rr),Ti=Fe[en(_r)>>2];return Ti.length>0?Ti.pop():new ArrayBuffer(_r)}function On(Rr){Fe[en(Rr.byteLength)>>2].push(Rr)}function Or(Rr,_r){var Ti=null;switch(Rr){case Ae:Ti=new Int8Array(Qt(_r),0,_r);break;case xe:Ti=new Uint8Array(Qt(_r),0,_r);break;case ke:Ti=new Int16Array(Qt(2*_r),0,_r);break;case tt:Ti=new Uint16Array(Qt(2*_r),0,_r);break;case Et:Ti=new Int32Array(Qt(4*_r),0,_r);break;case tn:Ti=new Uint32Array(Qt(4*_r),0,_r);break;case fn:Ti=new Float32Array(Qt(4*_r),0,_r);break;default:return null}return Ti.length!==_r?Ti.subarray(0,_r):Ti}function Wr(Rr){On(Rr.buffer)}return{alloc:Qt,free:On,allocType:Or,freeType:Wr}}var Tr=Gn();Tr.zero=Gn();var jr=3408,vr=3410,Ur=3411,Fr=3412,qr=3413,wr=3414,fi=3415,di=33901,vi=33902,vo=3379,Oi=3386,Ko=34921,va=36347,Co=36348,Xo=35661,Ye=35660,Ke=34930,Ct=36349,sn=34076,Ln=34024,zn=7936,mn=7937,wn=7938,gr=35724,mr=34047,ai=36063,Vi=34852,fo=3553,ei=34067,zi=34069,Li=33984,Zr=6408,go=5126,Mi=5121,bo=36160,Si=36053,wo=36064,Yo=16384,Wa=function(Fe,Qt){var On=1;Qt.ext_texture_filter_anisotropic&&(On=Fe.getParameter(mr));var Or=1,Wr=1;Qt.webgl_draw_buffers&&(Or=Fe.getParameter(Vi),Wr=Fe.getParameter(ai));var Rr=!!Qt.oes_texture_float;if(Rr){var _r=Fe.createTexture();Fe.bindTexture(fo,_r),Fe.texImage2D(fo,0,Zr,1,1,0,Zr,go,null);var Ti=Fe.createFramebuffer();if(Fe.bindFramebuffer(bo,Ti),Fe.framebufferTexture2D(bo,wo,fo,_r,0),Fe.bindTexture(fo,null),Fe.checkFramebufferStatus(bo)!==Si)Rr=!1;else{Fe.viewport(0,0,1,1),Fe.clearColor(1,0,0,1),Fe.clear(Yo);var li=Tr.allocType(go,4);Fe.readPixels(0,0,1,1,Zr,go,li),Fe.getError()?Rr=!1:(Fe.deleteFramebuffer(Ti),Fe.deleteTexture(_r),Rr=li[0]===1),Tr.freeType(li)}}var Fi=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Ri=!0;if(!Fi){var Di=Fe.createTexture(),Xi=Tr.allocType(Mi,36);Fe.activeTexture(Li),Fe.bindTexture(ei,Di),Fe.texImage2D(zi,0,Zr,3,3,0,Zr,Mi,Xi),Tr.freeType(Xi),Fe.bindTexture(ei,null),Fe.deleteTexture(Di),Ri=!Fe.getError()}return{colorBits:[Fe.getParameter(vr),Fe.getParameter(Ur),Fe.getParameter(Fr),Fe.getParameter(qr)],depthBits:Fe.getParameter(wr),stencilBits:Fe.getParameter(fi),subpixelBits:Fe.getParameter(jr),extensions:Object.keys(Qt).filter(function(pi){return!!Qt[pi]}),maxAnisotropic:On,maxDrawbuffers:Or,maxColorAttachments:Wr,pointSizeDims:Fe.getParameter(di),lineWidthDims:Fe.getParameter(vi),maxViewportDims:Fe.getParameter(Oi),maxCombinedTextureUnits:Fe.getParameter(Xo),maxCubeMapSize:Fe.getParameter(sn),maxRenderbufferSize:Fe.getParameter(Ln),maxTextureUnits:Fe.getParameter(Ke),maxTextureSize:Fe.getParameter(vo),maxAttributes:Fe.getParameter(Ko),maxVertexUniforms:Fe.getParameter(va),maxVertexTextureUnits:Fe.getParameter(Ye),maxVaryingVectors:Fe.getParameter(Co),maxFragmentUniforms:Fe.getParameter(Ct),glsl:Fe.getParameter(gr),renderer:Fe.getParameter(mn),vendor:Fe.getParameter(zn),version:Fe.getParameter(wn),readFloat:Rr,npotTextureCube:Ri}};function na(Fe){return!!Fe&&typeof Fe=="object"&&Array.isArray(Fe.shape)&&Array.isArray(Fe.stride)&&typeof Fe.offset=="number"&&Fe.shape.length===Fe.stride.length&&(Array.isArray(Fe.data)||W(Fe.data))}var jo=function(Fe){return Object.keys(Fe).map(function(Qt){return Fe[Qt]})},Va={shape:_i,flatten:sr};function fs(Fe,Qt,On){for(var Or=0;Or<Qt;++Or)On[Or]=Fe[Or]}function Tt(Fe,Qt,On,Or){for(var Wr=0,Rr=0;Rr<Qt;++Rr)for(var _r=Fe[Rr],Ti=0;Ti<On;++Ti)Or[Wr++]=_r[Ti]}function Ft(Fe,Qt,On,Or,Wr,Rr){for(var _r=Rr,Ti=0;Ti<Qt;++Ti)for(var li=Fe[Ti],Fi=0;Fi<On;++Fi)for(var Ri=li[Fi],Di=0;Di<Or;++Di)Wr[_r++]=Ri[Di]}function Dn(Fe,Qt,On,Or,Wr){for(var Rr=1,_r=On+1;_r<Qt.length;++_r)Rr*=Qt[_r];var Ti=Qt[On];if(Qt.length-On===4){var li=Qt[On+1],Fi=Qt[On+2],Ri=Qt[On+3];for(_r=0;_r<Ti;++_r)Ft(Fe[_r],li,Fi,Ri,Or,Wr),Wr+=Rr}else for(_r=0;_r<Ti;++_r)Dn(Fe[_r],Qt,On+1,Or,Wr),Wr+=Rr}function sr(Fe,Qt,On,Or){var Wr=1;if(Qt.length)for(var Rr=0;Rr<Qt.length;++Rr)Wr*=Qt[Rr];else Wr=0;var _r=Or||Tr.allocType(On,Wr);switch(Qt.length){case 0:break;case 1:fs(Fe,Qt[0],_r);break;case 2:Tt(Fe,Qt[0],Qt[1],_r);break;case 3:Ft(Fe,Qt[0],Qt[1],Qt[2],_r,0);break;default:Dn(Fe,Qt,0,_r,0)}return _r}function _i(Fe){for(var Qt=[],On=Fe;On.length;On=On[0])Qt.push(On.length);return Qt}var bi={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},so=5120,Ha=5122,Bs=5124,Os=5121,il=5123,Xf=5125,zd=5126,md=5126,Dl={int8:so,int16:Ha,int32:Bs,uint8:Os,uint16:il,uint32:Xf,float:zd,float32:md},Qc=35048,Mf=35040,Jc={dynamic:Qc,stream:Mf,static:35044},Ic=Va.flatten,eu=Va.shape,Yf=35044,ac=35040,Xs=5121,Ru=5126,gf=[];gf[5120]=1,gf[5122]=2,gf[5124]=4,gf[5121]=1,gf[5123]=2,gf[5125]=4,gf[5126]=4;function kh(Fe){return bi[Object.prototype.toString.call(Fe)]|0}function zh(Fe,Qt){for(var On=0;On<Qt.length;++On)Fe[On]=Qt[On]}function tu(Fe,Qt,On,Or,Wr,Rr,_r){for(var Ti=0,li=0;li<On;++li)for(var Fi=0;Fi<Or;++Fi)Fe[Ti++]=Qt[Wr*li+Rr*Fi+_r]}function mh(Fe,Qt,On,Or){var Wr=0,Rr={};function _r(pr){this.id=Wr++,this.buffer=Fe.createBuffer(),this.type=pr,this.usage=Yf,this.byteLength=0,this.dimension=1,this.dtype=Xs,this.persistentData=null,On.profile&&(this.stats={size:0})}_r.prototype.bind=function(){Fe.bindBuffer(this.type,this.buffer)},_r.prototype.destroy=function(){Xi(this)};var Ti=[];function li(pr,Lr){var yi=Ti.pop();return yi||(yi=new _r(pr)),yi.bind(),Di(yi,Lr,ac,0,1,!1),yi}function Fi(pr){Ti.push(pr)}function Ri(pr,Lr,yi){pr.byteLength=Lr.byteLength,Fe.bufferData(pr.type,Lr,yi)}function Di(pr,Lr,yi,eo,ii,oo){var xi;if(pr.usage=yi,Array.isArray(Lr)){if(pr.dtype=eo||Ru,Lr.length>0){var to;if(Array.isArray(Lr[0])){xi=eu(Lr);for(var si=1,Yi=1;Yi<xi.length;++Yi)si*=xi[Yi];pr.dimension=si,to=Ic(Lr,xi,pr.dtype),Ri(pr,to,yi),oo?pr.persistentData=to:Tr.freeType(to)}else if(typeof Lr[0]=="number"){pr.dimension=ii;var Bo=Tr.allocType(pr.dtype,Lr.length);zh(Bo,Lr),Ri(pr,Bo,yi),oo?pr.persistentData=Bo:Tr.freeType(Bo)}else W(Lr[0])?(pr.dimension=Lr[0].length,pr.dtype=eo||kh(Lr[0])||Ru,to=Ic(Lr,[Lr.length,Lr[0].length],pr.dtype),Ri(pr,to,yi),oo?pr.persistentData=to:Tr.freeType(to)):de.raise("invalid buffer data")}}else if(W(Lr))pr.dtype=eo||kh(Lr),pr.dimension=ii,Ri(pr,Lr,yi),oo&&(pr.persistentData=new Uint8Array(new Uint8Array(Lr.buffer)));else if(na(Lr)){xi=Lr.shape;var ha=Lr.stride,Ki=Lr.offset,Ei=0,$r=0,zo=0,Ua=0;xi.length===1?(Ei=xi[0],$r=1,zo=ha[0],Ua=0):xi.length===2?(Ei=xi[0],$r=xi[1],zo=ha[0],Ua=ha[1]):de.raise("invalid shape"),pr.dtype=eo||kh(Lr.data)||Ru,pr.dimension=$r;var co=Tr.allocType(pr.dtype,Ei*$r);tu(co,Lr.data,Ei,$r,zo,Ua,Ki),Ri(pr,co,yi),oo?pr.persistentData=co:Tr.freeType(co)}else Lr instanceof ArrayBuffer?(pr.dtype=Xs,pr.dimension=ii,Ri(pr,Lr,yi),oo&&(pr.persistentData=new Uint8Array(new Uint8Array(Lr)))):de.raise("invalid buffer data")}function Xi(pr){Qt.bufferCount--,Or(pr);var Lr=pr.buffer;de(Lr,"buffer must not be deleted already"),Fe.deleteBuffer(Lr),pr.buffer=null,delete Rr[pr.id]}function pi(pr,Lr,yi,eo){Qt.bufferCount++;var ii=new _r(Lr);Rr[ii.id]=ii;function oo(si){var Yi=Yf,Bo=null,ha=0,Ki=0,Ei=1;return Array.isArray(si)||W(si)||na(si)||si instanceof ArrayBuffer?Bo=si:typeof si=="number"?ha=si|0:si&&(de.type(si,"object","buffer arguments must be an object, a number or an array"),"data"in si&&(de(Bo===null||Array.isArray(Bo)||W(Bo)||na(Bo),"invalid data for buffer"),Bo=si.data),"usage"in si&&(de.parameter(si.usage,Jc,"invalid buffer usage"),Yi=Jc[si.usage]),"type"in si&&(de.parameter(si.type,Dl,"invalid buffer type"),Ki=Dl[si.type]),"dimension"in si&&(de.type(si.dimension,"number","invalid dimension"),Ei=si.dimension|0),"length"in si&&(de.nni(ha,"buffer length must be a nonnegative integer"),ha=si.length|0)),ii.bind(),Bo?Di(ii,Bo,Yi,Ki,Ei,eo):(ha&&Fe.bufferData(ii.type,ha,Yi),ii.dtype=Ki||Xs,ii.usage=Yi,ii.dimension=Ei,ii.byteLength=ha),On.profile&&(ii.stats.size=ii.byteLength*gf[ii.dtype]),oo}function xi(si,Yi){de(Yi+si.byteLength<=ii.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+si.byteLength+" starting from offset "+Yi+" to a buffer of size "+ii.byteLength),Fe.bufferSubData(ii.type,Yi,si)}function to(si,Yi){var Bo=(Yi||0)|0,ha;if(ii.bind(),W(si)||si instanceof ArrayBuffer)xi(si,Bo);else if(Array.isArray(si)){if(si.length>0)if(typeof si[0]=="number"){var Ki=Tr.allocType(ii.dtype,si.length);zh(Ki,si),xi(Ki,Bo),Tr.freeType(Ki)}else if(Array.isArray(si[0])||W(si[0])){ha=eu(si);var Ei=Ic(si,ha,ii.dtype);xi(Ei,Bo),Tr.freeType(Ei)}else de.raise("invalid buffer data")}else if(na(si)){ha=si.shape;var $r=si.stride,zo=0,Ua=0,co=0,Da=0;ha.length===1?(zo=ha[0],Ua=1,co=$r[0],Da=0):ha.length===2?(zo=ha[0],Ua=ha[1],co=$r[0],Da=$r[1]):de.raise("invalid shape");var da=Array.isArray(si.data)?ii.dtype:kh(si.data),Jo=Tr.allocType(da,zo*Ua);tu(Jo,si.data,zo,Ua,co,Da,si.offset),xi(Jo,Bo),Tr.freeType(Jo)}else de.raise("invalid data for buffer subdata");return oo}return yi||oo(pr),oo._reglType="buffer",oo._buffer=ii,oo.subdata=to,On.profile&&(oo.stats=ii.stats),oo.destroy=function(){Xi(ii)},oo}function Ni(){jo(Rr).forEach(function(pr){pr.buffer=Fe.createBuffer(),Fe.bindBuffer(pr.type,pr.buffer),Fe.bufferData(pr.type,pr.persistentData||pr.byteLength,pr.usage)})}return On.profile&&(Qt.getTotalBufferSize=function(){var pr=0;return Object.keys(Rr).forEach(function(Lr){pr+=Rr[Lr].stats.size}),pr}),{create:pi,createStream:li,destroyStream:Fi,clear:function(){jo(Rr).forEach(Xi),Ti.forEach(Xi)},getBuffer:function(pr){return pr&&pr._buffer instanceof _r?pr._buffer:null},restore:Ni,_initBuffer:Di}}var Uh=0,vd=0,gd=1,yd=1,vp=4,$f=4,Mu={points:Uh,point:vd,lines:gd,line:yd,triangles:vp,triangle:$f,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},_d=0,Nl=1,Is=4,nu=5120,sc=5121,of=5122,lc=5123,af=5124,Bl=5125,Pu=34963,yf=35040,vh=35044;function Kf(Fe,Qt,On,Or){var Wr={},Rr=0,_r={uint8:sc,uint16:lc};Qt.oes_element_index_uint&&(_r.uint32=Bl);function Ti(Ni){this.id=Rr++,Wr[this.id]=this,this.buffer=Ni,this.primType=Is,this.vertCount=0,this.type=0}Ti.prototype.bind=function(){this.buffer.bind()};var li=[];function Fi(Ni){var pr=li.pop();return pr||(pr=new Ti(On.create(null,Pu,!0,!1)._buffer)),Di(pr,Ni,yf,-1,-1,0,0),pr}function Ri(Ni){li.push(Ni)}function Di(Ni,pr,Lr,yi,eo,ii,oo){Ni.buffer.bind();var xi;if(pr){var to=oo;!oo&&(!W(pr)||na(pr)&&!W(pr.data))&&(to=Qt.oes_element_index_uint?Bl:lc),On._initBuffer(Ni.buffer,pr,Lr,to,3)}else Fe.bufferData(Pu,ii,Lr),Ni.buffer.dtype=xi||sc,Ni.buffer.usage=Lr,Ni.buffer.dimension=3,Ni.buffer.byteLength=ii;if(xi=oo,!oo){switch(Ni.buffer.dtype){case sc:case nu:xi=sc;break;case lc:case of:xi=lc;break;case Bl:case af:xi=Bl;break;default:de.raise("unsupported type for element array")}Ni.buffer.dtype=xi}Ni.type=xi,de(xi!==Bl||!!Qt.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var si=eo;si<0&&(si=Ni.buffer.byteLength,xi===lc?si>>=1:xi===Bl&&(si>>=2)),Ni.vertCount=si;var Yi=yi;if(yi<0){Yi=Is;var Bo=Ni.buffer.dimension;Bo===1&&(Yi=_d),Bo===2&&(Yi=Nl),Bo===3&&(Yi=Is)}Ni.primType=Yi}function Xi(Ni){Or.elementsCount--,de(Ni.buffer!==null,"must not double destroy elements"),delete Wr[Ni.id],Ni.buffer.destroy(),Ni.buffer=null}function pi(Ni,pr){var Lr=On.create(null,Pu,!0),yi=new Ti(Lr._buffer);Or.elementsCount++;function eo(ii){if(!ii)Lr(),yi.primType=Is,yi.vertCount=0,yi.type=sc;else if(typeof ii=="number")Lr(ii),yi.primType=Is,yi.vertCount=ii|0,yi.type=sc;else{var oo=null,xi=vh,to=-1,si=-1,Yi=0,Bo=0;Array.isArray(ii)||W(ii)||na(ii)?oo=ii:(de.type(ii,"object","invalid arguments for elements"),"data"in ii&&(oo=ii.data,de(Array.isArray(oo)||W(oo)||na(oo),"invalid data for element buffer")),"usage"in ii&&(de.parameter(ii.usage,Jc,"invalid element buffer usage"),xi=Jc[ii.usage]),"primitive"in ii&&(de.parameter(ii.primitive,Mu,"invalid element buffer primitive"),to=Mu[ii.primitive]),"count"in ii&&(de(typeof ii.count=="number"&&ii.count>=0,"invalid vertex count for elements"),si=ii.count|0),"type"in ii&&(de.parameter(ii.type,_r,"invalid buffer type"),Bo=_r[ii.type]),"length"in ii?Yi=ii.length|0:(Yi=si,Bo===lc||Bo===of?Yi*=2:(Bo===Bl||Bo===af)&&(Yi*=4))),Di(yi,oo,xi,to,si,Yi,Bo)}return eo}return eo(Ni),eo._reglType="elements",eo._elements=yi,eo.subdata=function(ii,oo){return Lr.subdata(ii,oo),eo},eo.destroy=function(){Xi(yi)},eo}return{create:pi,createStream:Fi,destroyStream:Ri,getElements:function(Ni){return typeof Ni=="function"&&Ni._elements instanceof Ti?Ni._elements:null},clear:function(){jo(Wr).forEach(Xi)}}}var ps=new Float32Array(1),jh=new Uint32Array(ps.buffer),Vh=5123;function gh(Fe){for(var Qt=Tr.allocType(Vh,Fe.length),On=0;On<Fe.length;++On)if(isNaN(Fe[On]))Qt[On]=65535;else if(Fe[On]===1/0)Qt[On]=31744;else if(Fe[On]===-1/0)Qt[On]=64512;else{ps[0]=Fe[On];var Or=jh[0],Wr=Or>>>31<<15,Rr=(Or<<1>>>24)-127,_r=Or>>13&1023;if(Rr<-24)Qt[On]=Wr;else if(Rr<-14){var Ti=-14-Rr;Qt[On]=Wr+(_r+1024>>Ti)}else Rr>15?Qt[On]=Wr+31744:Qt[On]=Wr+(Rr+15<<10)+_r}return Qt}function ol(Fe){return Array.isArray(Fe)||W(Fe)}var qf=function(Fe){return!(Fe&Fe-1)&&!!Fe},Qf=34467,ne=3553,_e=34067,et=34069,dn=6408,K=6406,rr=6407,Mr=6409,ki=6410,ti=32854,uo=32855,lo=36194,ca=32819,Io=32820,xa=33635,Qa=34042,aa=6402,ga=34041,hs=35904,Oa=35906,La=36193,Fa=33776,Ks=33777,Fs=33778,Ec=33779,is=35986,Iu=35987,du=34798,Lc=35840,Pf=35841,Hh=35842,Zh=35843,If=36196,Lu=5121,Lf=5123,yh=5125,Du=5126,P0=10242,bd=10243,Dc=10497,Wh=33071,gp=33648,Gh=10240,_h=10241,Nu=9728,Df=9729,Jf=9984,Yp=9985,Nf=9986,Ja=9987,xd=33170,pu=4352,ue=4353,Pe=4354,ct=34046,Sn=3317,cr=37440,kr=37441,gi=37443,$i=37444,pa=33984,Ea=[Jf,Nf,Yp,Ja],_s=[0,Mr,ki,rr,dn],za={};za[Mr]=za[K]=za[aa]=1,za[ga]=za[ki]=2,za[rr]=za[hs]=3,za[dn]=za[Oa]=4;function ka(Fe){return"[object "+Fe+"]"}var cc=ka("HTMLCanvasElement"),Bu=ka("OffscreenCanvas"),qs=ka("CanvasRenderingContext2D"),ho=ka("ImageBitmap"),ru=ka("HTMLImageElement"),Ed=ka("HTMLVideoElement"),eh=Object.keys(bi).concat([cc,Bu,qs,ho,ru,Ed]),ml=[];ml[Lu]=1,ml[Du]=4,ml[La]=2,ml[Lf]=2,ml[yh]=4;var os=[];os[ti]=2,os[uo]=2,os[lo]=2,os[ga]=4,os[Fa]=.5,os[Ks]=.5,os[Fs]=1,os[Ec]=1,os[is]=.5,os[Iu]=1,os[du]=1,os[Lc]=.5,os[Pf]=.25,os[Hh]=.5,os[Zh]=.25,os[If]=.5;function yp(Fe){return Array.isArray(Fe)&&(Fe.length===0||typeof Fe[0]=="number")}function Ii(Fe){if(!Array.isArray(Fe))return!1;var Qt=Fe.length;return!(Qt===0||!ol(Fe[0]))}function th(Fe){return Object.prototype.toString.call(Fe)}function Sd(Fe){return th(Fe)===cc}function $p(Fe){return th(Fe)===Bu}function Nc(Fe){return th(Fe)===qs}function mu(Fe){return th(Fe)===ho}function _p(Fe){return th(Fe)===ru}function Kp(Fe){return th(Fe)===Ed}function Bc(Fe){if(!Fe)return!1;var Qt=th(Fe);return eh.indexOf(Qt)>=0?!0:yp(Fe)||Ii(Fe)||na(Fe)}function nh(Fe){return bi[Object.prototype.toString.call(Fe)]|0}function Jm(Fe,Qt){var On=Qt.length;switch(Fe.type){case Lu:case Lf:case yh:case Du:var Or=Tr.allocType(Fe.type,On);Or.set(Qt),Fe.data=Or;break;case La:Fe.data=gh(Qt);break;default:de.raise("unsupported texture type, must specify a typed array")}}function Td(Fe,Qt){return Tr.allocType(Fe.type===La?Du:Fe.type,Qt)}function bp(Fe,Qt){Fe.type===La?(Fe.data=gh(Qt),Tr.freeType(Qt)):Fe.data=Qt}function sm(Fe,Qt,On,Or,Wr,Rr){for(var _r=Fe.width,Ti=Fe.height,li=Fe.channels,Fi=_r*Ti*li,Ri=Td(Fe,Fi),Di=0,Xi=0;Xi<Ti;++Xi)for(var pi=0;pi<_r;++pi)for(var Ni=0;Ni<li;++Ni)Ri[Di++]=Qt[On*pi+Or*Xi+Wr*Ni+Rr];bp(Fe,Ri)}function Fu(Fe,Qt,On,Or,Wr,Rr){var _r;if(typeof os[Fe]!="undefined"?_r=os[Fe]:_r=za[Fe]*ml[Qt],Rr&&(_r*=6),Wr){for(var Ti=0,li=On;li>=1;)Ti+=_r*li*li,li/=2;return Ti}else return _r*On*Or}function vu(Fe,Qt,On,Or,Wr,Rr,_r){var Ti={"don't care":pu,"dont care":pu,nice:Pe,fast:ue},li={repeat:Dc,clamp:Wh,mirror:gp},Fi={nearest:Nu,linear:Df},Ri=D({mipmap:Ja,"nearest mipmap nearest":Jf,"linear mipmap nearest":Yp,"nearest mipmap linear":Nf,"linear mipmap linear":Ja},Fi),Di={none:0,browser:$i},Xi={uint8:Lu,rgba4:ca,rgb565:xa,"rgb5 a1":Io},pi={alpha:K,luminance:Mr,"luminance alpha":ki,rgb:rr,rgba:dn,rgba4:ti,"rgb5 a1":uo,rgb565:lo},Ni={};Qt.ext_srgb&&(pi.srgb=hs,pi.srgba=Oa),Qt.oes_texture_float&&(Xi.float32=Xi.float=Du),Qt.oes_texture_half_float&&(Xi.float16=Xi["half float"]=La),Qt.webgl_depth_texture&&(D(pi,{depth:aa,"depth stencil":ga}),D(Xi,{uint16:Lf,uint32:yh,"depth stencil":Qa})),Qt.webgl_compressed_texture_s3tc&&D(Ni,{"rgb s3tc dxt1":Fa,"rgba s3tc dxt1":Ks,"rgba s3tc dxt3":Fs,"rgba s3tc dxt5":Ec}),Qt.webgl_compressed_texture_atc&&D(Ni,{"rgb atc":is,"rgba atc explicit alpha":Iu,"rgba atc interpolated alpha":du}),Qt.webgl_compressed_texture_pvrtc&&D(Ni,{"rgb pvrtc 4bppv1":Lc,"rgb pvrtc 2bppv1":Pf,"rgba pvrtc 4bppv1":Hh,"rgba pvrtc 2bppv1":Zh}),Qt.webgl_compressed_texture_etc1&&(Ni["rgb etc1"]=If);var pr=Array.prototype.slice.call(Fe.getParameter(Qf));Object.keys(Ni).forEach(function(ln){var Pr=Ni[ln];pr.indexOf(Pr)>=0&&(pi[ln]=Pr)});var Lr=Object.keys(pi);On.textureFormats=Lr;var yi=[];Object.keys(pi).forEach(function(ln){var Pr=pi[ln];yi[Pr]=ln});var eo=[];Object.keys(Xi).forEach(function(ln){var Pr=Xi[ln];eo[Pr]=ln});var ii=[];Object.keys(Fi).forEach(function(ln){var Pr=Fi[ln];ii[Pr]=ln});var oo=[];Object.keys(Ri).forEach(function(ln){var Pr=Ri[ln];oo[Pr]=ln});var xi=[];Object.keys(li).forEach(function(ln){var Pr=li[ln];xi[Pr]=ln});var to=Lr.reduce(function(ln,Pr){var Er=pi[Pr];return Er===Mr||Er===K||Er===Mr||Er===ki||Er===aa||Er===ga||Qt.ext_srgb&&(Er===hs||Er===Oa)?ln[Er]=Er:Er===uo||Pr.indexOf("rgba")>=0?ln[Er]=dn:ln[Er]=rr,ln},{});function si(){this.internalformat=dn,this.format=dn,this.type=Lu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=$i,this.width=0,this.height=0,this.channels=0}function Yi(ln,Pr){ln.internalformat=Pr.internalformat,ln.format=Pr.format,ln.type=Pr.type,ln.compressed=Pr.compressed,ln.premultiplyAlpha=Pr.premultiplyAlpha,ln.flipY=Pr.flipY,ln.unpackAlignment=Pr.unpackAlignment,ln.colorSpace=Pr.colorSpace,ln.width=Pr.width,ln.height=Pr.height,ln.channels=Pr.channels}function Bo(ln,Pr){if(!(typeof Pr!="object"||!Pr)){if("premultiplyAlpha"in Pr&&(de.type(Pr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),ln.premultiplyAlpha=Pr.premultiplyAlpha),"flipY"in Pr&&(de.type(Pr.flipY,"boolean","invalid texture flip"),ln.flipY=Pr.flipY),"alignment"in Pr&&(de.oneOf(Pr.alignment,[1,2,4,8],"invalid texture unpack alignment"),ln.unpackAlignment=Pr.alignment),"colorSpace"in Pr&&(de.parameter(Pr.colorSpace,Di,"invalid colorSpace"),ln.colorSpace=Di[Pr.colorSpace]),"type"in Pr){var Er=Pr.type;de(Qt.oes_texture_float||!(Er==="float"||Er==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),de(Qt.oes_texture_half_float||!(Er==="half float"||Er==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),de(Qt.webgl_depth_texture||!(Er==="uint16"||Er==="uint32"||Er==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),de.parameter(Er,Xi,"invalid texture type"),ln.type=Xi[Er]}var no=ln.width,Na=ln.height,Es=ln.channels,Lt=!1;"shape"in Pr?(de(Array.isArray(Pr.shape)&&Pr.shape.length>=2,"shape must be an array"),no=Pr.shape[0],Na=Pr.shape[1],Pr.shape.length===3&&(Es=Pr.shape[2],de(Es>0&&Es<=4,"invalid number of channels"),Lt=!0),de(no>=0&&no<=On.maxTextureSize,"invalid width"),de(Na>=0&&Na<=On.maxTextureSize,"invalid height")):("radius"in Pr&&(no=Na=Pr.radius,de(no>=0&&no<=On.maxTextureSize,"invalid radius")),"width"in Pr&&(no=Pr.width,de(no>=0&&no<=On.maxTextureSize,"invalid width")),"height"in Pr&&(Na=Pr.height,de(Na>=0&&Na<=On.maxTextureSize,"invalid height")),"channels"in Pr&&(Es=Pr.channels,de(Es>0&&Es<=4,"invalid number of channels"),Lt=!0)),ln.width=no|0,ln.height=Na|0,ln.channels=Es|0;var nn=!1;if("format"in Pr){var Mn=Pr.format;de(Qt.webgl_depth_texture||!(Mn==="depth"||Mn==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),de.parameter(Mn,pi,"invalid texture format");var Ar=ln.internalformat=pi[Mn];ln.format=to[Ar],Mn in Xi&&("type"in Pr||(ln.type=Xi[Mn])),Mn in Ni&&(ln.compressed=!0),nn=!0}!Lt&&nn?ln.channels=za[ln.format]:Lt&&!nn?ln.channels!==_s[ln.format]&&(ln.format=ln.internalformat=_s[ln.channels]):nn&&Lt&&de(ln.channels===za[ln.format],"number of channels inconsistent with specified format")}}function ha(ln){Fe.pixelStorei(cr,ln.flipY),Fe.pixelStorei(kr,ln.premultiplyAlpha),Fe.pixelStorei(gi,ln.colorSpace),Fe.pixelStorei(Sn,ln.unpackAlignment)}function Ki(){si.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ei(ln,Pr){var Er=null;if(Bc(Pr)?Er=Pr:Pr&&(de.type(Pr,"object","invalid pixel data type"),Bo(ln,Pr),"x"in Pr&&(ln.xOffset=Pr.x|0),"y"in Pr&&(ln.yOffset=Pr.y|0),Bc(Pr.data)&&(Er=Pr.data)),de(!ln.compressed||Er instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Pr.copy){de(!Er,"can not specify copy and data field for the same texture");var no=Wr.viewportWidth,Na=Wr.viewportHeight;ln.width=ln.width||no-ln.xOffset,ln.height=ln.height||Na-ln.yOffset,ln.needsCopy=!0,de(ln.xOffset>=0&&ln.xOffset<no&&ln.yOffset>=0&&ln.yOffset<Na&&ln.width>0&&ln.width<=no&&ln.height>0&&ln.height<=Na,"copy texture read out of bounds")}else if(!Er)ln.width=ln.width||1,ln.height=ln.height||1,ln.channels=ln.channels||4;else if(W(Er))ln.channels=ln.channels||4,ln.data=Er,!("type"in Pr)&&ln.type===Lu&&(ln.type=nh(Er));else if(yp(Er))ln.channels=ln.channels||4,Jm(ln,Er),ln.alignment=1,ln.needsFree=!0;else if(na(Er)){var Es=Er.data;!Array.isArray(Es)&&ln.type===Lu&&(ln.type=nh(Es));var Lt=Er.shape,nn=Er.stride,Mn,Ar,xr,Un,Kn,ir;Lt.length===3?(xr=Lt[2],ir=nn[2]):(de(Lt.length===2,"invalid ndarray pixel data, must be 2 or 3D"),xr=1,ir=1),Mn=Lt[0],Ar=Lt[1],Un=nn[0],Kn=nn[1],ln.alignment=1,ln.width=Mn,ln.height=Ar,ln.channels=xr,ln.format=ln.internalformat=_s[xr],ln.needsFree=!0,sm(ln,Es,Un,Kn,ir,Er.offset)}else if(Sd(Er)||$p(Er)||Nc(Er))Sd(Er)||$p(Er)?ln.element=Er:ln.element=Er.canvas,ln.width=ln.element.width,ln.height=ln.element.height,ln.channels=4;else if(mu(Er))ln.element=Er,ln.width=Er.width,ln.height=Er.height,ln.channels=4;else if(_p(Er))ln.element=Er,ln.width=Er.naturalWidth,ln.height=Er.naturalHeight,ln.channels=4;else if(Kp(Er))ln.element=Er,ln.width=Er.videoWidth,ln.height=Er.videoHeight,ln.channels=4;else if(Ii(Er)){var yn=ln.width||Er[0].length,Hn=ln.height||Er.length,Kt=ln.channels;ol(Er[0][0])?Kt=Kt||Er[0][0].length:Kt=Kt||1;for(var Yn=Va.shape(Er),Dr=1,zr=0;zr<Yn.length;++zr)Dr*=Yn[zr];var mi=Td(ln,Dr);Va.flatten(Er,Yn,"",mi),bp(ln,mi),ln.alignment=1,ln.width=yn,ln.height=Hn,ln.channels=Kt,ln.format=ln.internalformat=_s[Kt],ln.needsFree=!0}ln.type===Du?de(On.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):ln.type===La&&de(On.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function $r(ln,Pr,Er){var no=ln.element,Na=ln.data,Es=ln.internalformat,Lt=ln.format,nn=ln.type,Mn=ln.width,Ar=ln.height;ha(ln),no?Fe.texImage2D(Pr,Er,Lt,Lt,nn,no):ln.compressed?Fe.compressedTexImage2D(Pr,Er,Es,Mn,Ar,0,Na):ln.needsCopy?(Or(),Fe.copyTexImage2D(Pr,Er,Lt,ln.xOffset,ln.yOffset,Mn,Ar,0)):Fe.texImage2D(Pr,Er,Lt,Mn,Ar,0,Lt,nn,Na||null)}function zo(ln,Pr,Er,no,Na){var Es=ln.element,Lt=ln.data,nn=ln.internalformat,Mn=ln.format,Ar=ln.type,xr=ln.width,Un=ln.height;ha(ln),Es?Fe.texSubImage2D(Pr,Na,Er,no,Mn,Ar,Es):ln.compressed?Fe.compressedTexSubImage2D(Pr,Na,Er,no,nn,xr,Un,Lt):ln.needsCopy?(Or(),Fe.copyTexSubImage2D(Pr,Na,Er,no,ln.xOffset,ln.yOffset,xr,Un)):Fe.texSubImage2D(Pr,Na,Er,no,xr,Un,Mn,Ar,Lt)}var Ua=[];function co(){return Ua.pop()||new Ki}function Da(ln){ln.needsFree&&Tr.freeType(ln.data),Ki.call(ln),Ua.push(ln)}function da(){si.call(this),this.genMipmaps=!1,this.mipmapHint=pu,this.mipmask=0,this.images=Array(16)}function Jo(ln,Pr,Er){var no=ln.images[0]=co();ln.mipmask=1,no.width=ln.width=Pr,no.height=ln.height=Er,no.channels=ln.channels=4}function vs(ln,Pr){var Er=null;if(Bc(Pr))Er=ln.images[0]=co(),Yi(Er,ln),Ei(Er,Pr),ln.mipmask=1;else if(Bo(ln,Pr),Array.isArray(Pr.mipmap))for(var no=Pr.mipmap,Na=0;Na<no.length;++Na)Er=ln.images[Na]=co(),Yi(Er,ln),Er.width>>=Na,Er.height>>=Na,Ei(Er,no[Na]),ln.mipmask|=1<<Na;else Er=ln.images[0]=co(),Yi(Er,ln),Ei(Er,Pr),ln.mipmask=1;Yi(ln,ln.images[0]),ln.compressed&&(ln.internalformat===Fa||ln.internalformat===Ks||ln.internalformat===Fs||ln.internalformat===Ec)&&de(ln.width%4===0&&ln.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function _l(ln,Pr){for(var Er=ln.images,no=0;no<Er.length;++no){if(!Er[no])return;$r(Er[no],Pr,no)}}var $c=[];function Ga(){var ln=$c.pop()||new da;si.call(ln),ln.mipmask=0;for(var Pr=0;Pr<16;++Pr)ln.images[Pr]=null;return ln}function dl(ln){for(var Pr=ln.images,Er=0;Er<Pr.length;++Er)Pr[Er]&&Da(Pr[Er]),Pr[Er]=null;$c.push(ln)}function el(){this.minFilter=Nu,this.magFilter=Nu,this.wrapS=Wh,this.wrapT=Wh,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=pu}function Yl(ln,Pr){if("min"in Pr){var Er=Pr.min;de.parameter(Er,Ri),ln.minFilter=Ri[Er],Ea.indexOf(ln.minFilter)>=0&&!("faces"in Pr)&&(ln.genMipmaps=!0)}if("mag"in Pr){var no=Pr.mag;de.parameter(no,Fi),ln.magFilter=Fi[no]}var Na=ln.wrapS,Es=ln.wrapT;if("wrap"in Pr){var Lt=Pr.wrap;typeof Lt=="string"?(de.parameter(Lt,li),Na=Es=li[Lt]):Array.isArray(Lt)&&(de.parameter(Lt[0],li),de.parameter(Lt[1],li),Na=li[Lt[0]],Es=li[Lt[1]])}else{if("wrapS"in Pr){var nn=Pr.wrapS;de.parameter(nn,li),Na=li[nn]}if("wrapT"in Pr){var Mn=Pr.wrapT;de.parameter(Mn,li),Es=li[Mn]}}if(ln.wrapS=Na,ln.wrapT=Es,"anisotropic"in Pr){var Ar=Pr.anisotropic;de(typeof Ar=="number"&&Ar>=1&&Ar<=On.maxAnisotropic,"aniso samples must be between 1 and "),ln.anisotropic=Pr.anisotropic}if("mipmap"in Pr){var xr=!1;switch(typeof Pr.mipmap){case"string":de.parameter(Pr.mipmap,Ti,"invalid mipmap hint"),ln.mipmapHint=Ti[Pr.mipmap],ln.genMipmaps=!0,xr=!0;break;case"boolean":xr=ln.genMipmaps=Pr.mipmap;break;case"object":de(Array.isArray(Pr.mipmap),"invalid mipmap type"),ln.genMipmaps=!1,xr=!0;break;default:de.raise("invalid mipmap type")}xr&&!("min"in Pr)&&(ln.minFilter=Jf)}}function zl(ln,Pr){Fe.texParameteri(Pr,_h,ln.minFilter),Fe.texParameteri(Pr,Gh,ln.magFilter),Fe.texParameteri(Pr,P0,ln.wrapS),Fe.texParameteri(Pr,bd,ln.wrapT),Qt.ext_texture_filter_anisotropic&&Fe.texParameteri(Pr,ct,ln.anisotropic),ln.genMipmaps&&(Fe.hint(xd,ln.mipmapHint),Fe.generateMipmap(Pr))}var as=0,$l={},ec=On.maxTextureUnits,mc=Array(ec).map(function(){return null});function Ra(ln){si.call(this),this.mipmask=0,this.internalformat=dn,this.id=as++,this.refCount=1,this.target=ln,this.texture=Fe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new el,_r.profile&&(this.stats={size:0})}function Kc(ln){Fe.activeTexture(pa),Fe.bindTexture(ln.target,ln.texture)}function Rs(){var ln=mc[0];ln?Fe.bindTexture(ln.target,ln.texture):Fe.bindTexture(ne,null)}function Zo(ln){var Pr=ln.texture;de(Pr,"must not double destroy texture");var Er=ln.unit,no=ln.target;Er>=0&&(Fe.activeTexture(pa+Er),Fe.bindTexture(no,null),mc[Er]=null),Fe.deleteTexture(Pr),ln.texture=null,ln.params=null,ln.pixels=null,ln.refCount=0,delete $l[ln.id],Rr.textureCount--}D(Ra.prototype,{bind:function(){var ln=this;ln.bindCount+=1;var Pr=ln.unit;if(Pr<0){for(var Er=0;Er<ec;++Er){var no=mc[Er];if(no){if(no.bindCount>0)continue;no.unit=-1}mc[Er]=ln,Pr=Er;break}Pr>=ec&&de.raise("insufficient number of texture units"),_r.profile&&Rr.maxTextureUnits<Pr+1&&(Rr.maxTextureUnits=Pr+1),ln.unit=Pr,Fe.activeTexture(pa+Pr),Fe.bindTexture(ln.target,ln.texture)}return Pr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Zo(this)}});function Ta(ln,Pr){var Er=new Ra(ne);$l[Er.id]=Er,Rr.textureCount++;function no(Lt,nn){var Mn=Er.texInfo;el.call(Mn);var Ar=Ga();return typeof Lt=="number"?typeof nn=="number"?Jo(Ar,Lt|0,nn|0):Jo(Ar,Lt|0,Lt|0):Lt?(de.type(Lt,"object","invalid arguments to regl.texture"),Yl(Mn,Lt),vs(Ar,Lt)):Jo(Ar,1,1),Mn.genMipmaps&&(Ar.mipmask=(Ar.width<<1)-1),Er.mipmask=Ar.mipmask,Yi(Er,Ar),de.texture2D(Mn,Ar,On),Er.internalformat=Ar.internalformat,no.width=Ar.width,no.height=Ar.height,Kc(Er),_l(Ar,ne),zl(Mn,ne),Rs(),dl(Ar),_r.profile&&(Er.stats.size=Fu(Er.internalformat,Er.type,Ar.width,Ar.height,Mn.genMipmaps,!1)),no.format=yi[Er.internalformat],no.type=eo[Er.type],no.mag=ii[Mn.magFilter],no.min=oo[Mn.minFilter],no.wrapS=xi[Mn.wrapS],no.wrapT=xi[Mn.wrapT],no}function Na(Lt,nn,Mn,Ar){de(!!Lt,"must specify image data");var xr=nn|0,Un=Mn|0,Kn=Ar|0,ir=co();return Yi(ir,Er),ir.width=0,ir.height=0,Ei(ir,Lt),ir.width=ir.width||(Er.width>>Kn)-xr,ir.height=ir.height||(Er.height>>Kn)-Un,de(Er.type===ir.type&&Er.format===ir.format&&Er.internalformat===ir.internalformat,"incompatible format for texture.subimage"),de(xr>=0&&Un>=0&&xr+ir.width<=Er.width&&Un+ir.height<=Er.height,"texture.subimage write out of bounds"),de(Er.mipmask&1<<Kn,"missing mipmap data"),de(ir.data||ir.element||ir.needsCopy,"missing image data"),Kc(Er),zo(ir,ne,xr,Un,Kn),Rs(),Da(ir),no}function Es(Lt,nn){var Mn=Lt|0,Ar=nn|0||Mn;if(Mn===Er.width&&Ar===Er.height)return no;no.width=Er.width=Mn,no.height=Er.height=Ar,Kc(Er);for(var xr=0;Er.mipmask>>xr;++xr){var Un=Mn>>xr,Kn=Ar>>xr;if(!Un||!Kn)break;Fe.texImage2D(ne,xr,Er.format,Un,Kn,0,Er.format,Er.type,null)}return Rs(),_r.profile&&(Er.stats.size=Fu(Er.internalformat,Er.type,Mn,Ar,!1,!1)),no}return no(ln,Pr),no.subimage=Na,no.resize=Es,no._reglType="texture2d",no._texture=Er,_r.profile&&(no.stats=Er.stats),no.destroy=function(){Er.decRef()},no}function Za(ln,Pr,Er,no,Na,Es){var Lt=new Ra(_e);$l[Lt.id]=Lt,Rr.cubeCount++;var nn=new Array(6);function Mn(Un,Kn,ir,yn,Hn,Kt){var Yn,Dr=Lt.texInfo;for(el.call(Dr),Yn=0;Yn<6;++Yn)nn[Yn]=Ga();if(typeof Un=="number"||!Un){var zr=Un|0||1;for(Yn=0;Yn<6;++Yn)Jo(nn[Yn],zr,zr)}else if(typeof Un=="object")if(Kn)vs(nn[0],Un),vs(nn[1],Kn),vs(nn[2],ir),vs(nn[3],yn),vs(nn[4],Hn),vs(nn[5],Kt);else if(Yl(Dr,Un),Bo(Lt,Un),"faces"in Un){var mi=Un.faces;for(de(Array.isArray(mi)&&mi.length===6,"cube faces must be a length 6 array"),Yn=0;Yn<6;++Yn)de(typeof mi[Yn]=="object"&&!!mi[Yn],"invalid input for cube map face"),Yi(nn[Yn],Lt),vs(nn[Yn],mi[Yn])}else for(Yn=0;Yn<6;++Yn)vs(nn[Yn],Un);else de.raise("invalid arguments to cube map");for(Yi(Lt,nn[0]),On.npotTextureCube||de(qf(Lt.width)&&qf(Lt.height),"your browser does not support non power or two texture dimensions"),Dr.genMipmaps?Lt.mipmask=(nn[0].width<<1)-1:Lt.mipmask=nn[0].mipmask,de.textureCube(Lt,Dr,nn,On),Lt.internalformat=nn[0].internalformat,Mn.width=nn[0].width,Mn.height=nn[0].height,Kc(Lt),Yn=0;Yn<6;++Yn)_l(nn[Yn],et+Yn);for(zl(Dr,_e),Rs(),_r.profile&&(Lt.stats.size=Fu(Lt.internalformat,Lt.type,Mn.width,Mn.height,Dr.genMipmaps,!0)),Mn.format=yi[Lt.internalformat],Mn.type=eo[Lt.type],Mn.mag=ii[Dr.magFilter],Mn.min=oo[Dr.minFilter],Mn.wrapS=xi[Dr.wrapS],Mn.wrapT=xi[Dr.wrapT],Yn=0;Yn<6;++Yn)dl(nn[Yn]);return Mn}function Ar(Un,Kn,ir,yn,Hn){de(!!Kn,"must specify image data"),de(typeof Un=="number"&&Un===(Un|0)&&Un>=0&&Un<6,"invalid face");var Kt=ir|0,Yn=yn|0,Dr=Hn|0,zr=co();return Yi(zr,Lt),zr.width=0,zr.height=0,Ei(zr,Kn),zr.width=zr.width||(Lt.width>>Dr)-Kt,zr.height=zr.height||(Lt.height>>Dr)-Yn,de(Lt.type===zr.type&&Lt.format===zr.format&&Lt.internalformat===zr.internalformat,"incompatible format for texture.subimage"),de(Kt>=0&&Yn>=0&&Kt+zr.width<=Lt.width&&Yn+zr.height<=Lt.height,"texture.subimage write out of bounds"),de(Lt.mipmask&1<<Dr,"missing mipmap data"),de(zr.data||zr.element||zr.needsCopy,"missing image data"),Kc(Lt),zo(zr,et+Un,Kt,Yn,Dr),Rs(),Da(zr),Mn}function xr(Un){var Kn=Un|0;if(Kn!==Lt.width){Mn.width=Lt.width=Kn,Mn.height=Lt.height=Kn,Kc(Lt);for(var ir=0;ir<6;++ir)for(var yn=0;Lt.mipmask>>yn;++yn)Fe.texImage2D(et+ir,yn,Lt.format,Kn>>yn,Kn>>yn,0,Lt.format,Lt.type,null);return Rs(),_r.profile&&(Lt.stats.size=Fu(Lt.internalformat,Lt.type,Mn.width,Mn.height,!1,!0)),Mn}}return Mn(ln,Pr,Er,no,Na,Es),Mn.subimage=Ar,Mn.resize=xr,Mn._reglType="textureCube",Mn._texture=Lt,_r.profile&&(Mn.stats=Lt.stats),Mn.destroy=function(){Lt.decRef()},Mn}function Kl(){for(var ln=0;ln<ec;++ln)Fe.activeTexture(pa+ln),Fe.bindTexture(ne,null),mc[ln]=null;jo($l).forEach(Zo),Rr.cubeCount=0,Rr.textureCount=0}_r.profile&&(Rr.getTotalTextureSize=function(){var ln=0;return Object.keys($l).forEach(function(Pr){ln+=$l[Pr].stats.size}),ln});function ch(){for(var ln=0;ln<ec;++ln){var Pr=mc[ln];Pr&&(Pr.bindCount=0,Pr.unit=-1,mc[ln]=null)}jo($l).forEach(function(Er){Er.texture=Fe.createTexture(),Fe.bindTexture(Er.target,Er.texture);for(var no=0;no<32;++no)if(Er.mipmask&1<<no)if(Er.target===ne)Fe.texImage2D(ne,no,Er.internalformat,Er.width>>no,Er.height>>no,0,Er.internalformat,Er.type,null);else for(var Na=0;Na<6;++Na)Fe.texImage2D(et+Na,no,Er.internalformat,Er.width>>no,Er.height>>no,0,Er.internalformat,Er.type,null);zl(Er.texInfo,Er.target)})}return{create2D:Ta,createCube:Za,clear:Kl,getTexture:function(ln){return null},restore:ch}}var ya=36161,ku=32854,zu=32855,uc=36194,Xh=33189,Wl=36168,Wc=34041,iu=35907,xp=34836,Oo=34842,So=34843,Uu=[];Uu[ku]=2,Uu[zu]=2,Uu[uc]=2,Uu[Xh]=2,Uu[Wl]=1,Uu[Wc]=4,Uu[iu]=4,Uu[xp]=16,Uu[Oo]=8,Uu[So]=6;function ou(Fe,Qt,On){return Uu[Fe]*Qt*On}var rh=function(Fe,Qt,On,Or,Wr){var Rr={rgba4:ku,rgb565:uc,"rgb5 a1":zu,depth:Xh,stencil:Wl,"depth stencil":Wc};Qt.ext_srgb&&(Rr.srgba=iu),Qt.ext_color_buffer_half_float&&(Rr.rgba16f=Oo,Rr.rgb16f=So),Qt.webgl_color_buffer_float&&(Rr.rgba32f=xp);var _r=[];Object.keys(Rr).forEach(function(pi){var Ni=Rr[pi];_r[Ni]=pi});var Ti=0,li={};function Fi(pi){this.id=Ti++,this.refCount=1,this.renderbuffer=pi,this.format=ku,this.width=0,this.height=0,Wr.profile&&(this.stats={size:0})}Fi.prototype.decRef=function(){--this.refCount<=0&&Ri(this)};function Ri(pi){var Ni=pi.renderbuffer;de(Ni,"must not double destroy renderbuffer"),Fe.bindRenderbuffer(ya,null),Fe.deleteRenderbuffer(Ni),pi.renderbuffer=null,pi.refCount=0,delete li[pi.id],Or.renderbufferCount--}function Di(pi,Ni){var pr=new Fi(Fe.createRenderbuffer());li[pr.id]=pr,Or.renderbufferCount++;function Lr(eo,ii){var oo=0,xi=0,to=ku;if(typeof eo=="object"&&eo){var si=eo;if("shape"in si){var Yi=si.shape;de(Array.isArray(Yi)&&Yi.length>=2,"invalid renderbuffer shape"),oo=Yi[0]|0,xi=Yi[1]|0}else"radius"in si&&(oo=xi=si.radius|0),"width"in si&&(oo=si.width|0),"height"in si&&(xi=si.height|0);"format"in si&&(de.parameter(si.format,Rr,"invalid renderbuffer format"),to=Rr[si.format])}else typeof eo=="number"?(oo=eo|0,typeof ii=="number"?xi=ii|0:xi=oo):eo?de.raise("invalid arguments to renderbuffer constructor"):oo=xi=1;if(de(oo>0&&xi>0&&oo<=On.maxRenderbufferSize&&xi<=On.maxRenderbufferSize,"invalid renderbuffer size"),!(oo===pr.width&&xi===pr.height&&to===pr.format))return Lr.width=pr.width=oo,Lr.height=pr.height=xi,pr.format=to,Fe.bindRenderbuffer(ya,pr.renderbuffer),Fe.renderbufferStorage(ya,to,oo,xi),de(Fe.getError()===0,"invalid render buffer format"),Wr.profile&&(pr.stats.size=ou(pr.format,pr.width,pr.height)),Lr.format=_r[pr.format],Lr}function yi(eo,ii){var oo=eo|0,xi=ii|0||oo;return oo===pr.width&&xi===pr.height||(de(oo>0&&xi>0&&oo<=On.maxRenderbufferSize&&xi<=On.maxRenderbufferSize,"invalid renderbuffer size"),Lr.width=pr.width=oo,Lr.height=pr.height=xi,Fe.bindRenderbuffer(ya,pr.renderbuffer),Fe.renderbufferStorage(ya,pr.format,oo,xi),de(Fe.getError()===0,"invalid render buffer format"),Wr.profile&&(pr.stats.size=ou(pr.format,pr.width,pr.height))),Lr}return Lr(pi,Ni),Lr.resize=yi,Lr._reglType="renderbuffer",Lr._renderbuffer=pr,Wr.profile&&(Lr.stats=pr.stats),Lr.destroy=function(){pr.decRef()},Lr}Wr.profile&&(Or.getTotalRenderbufferSize=function(){var pi=0;return Object.keys(li).forEach(function(Ni){pi+=li[Ni].stats.size}),pi});function Xi(){jo(li).forEach(function(pi){pi.renderbuffer=Fe.createRenderbuffer(),Fe.bindRenderbuffer(ya,pi.renderbuffer),Fe.renderbufferStorage(ya,pi.format,pi.width,pi.height)}),Fe.bindRenderbuffer(ya,null)}return{create:Di,clear:function(){jo(li).forEach(Ri)},restore:Xi}},fl=36160,Gc=36161,Bf=3553,wd=34069,ms=36064,fc=36096,I0=36128,Yh=33306,qp=36053,bh=36054,au=36055,Ud=36057,Gr=36061,ih=36193,Xc=5121,jd=5126,xh=6407,oh=6408,ah=6402,Qp=[xh,oh],sh=[];sh[oh]=4,sh[xh]=3;var Ff=[];Ff[Xc]=1,Ff[jd]=4,Ff[ih]=2;var Eh=32854,Al=32855,ts=36194,ju=33189,Jp=36168,L0=34041,e0=35907,_=34836,S=34842,x=34843,C=[Eh,Al,ts,e0,S,x,_],k={};k[qp]="complete",k[bh]="incomplete attachment",k[Ud]="incomplete dimensions",k[au]="incomplete, missing attachment",k[Gr]="unsupported";function G(Fe,Qt,On,Or,Wr,Rr){var _r={cur:null,next:null,dirty:!1,setFBO:null},Ti=["rgba"],li=["rgba4","rgb565","rgb5 a1"];Qt.ext_srgb&&li.push("srgba"),Qt.ext_color_buffer_half_float&&li.push("rgba16f","rgb16f"),Qt.webgl_color_buffer_float&&li.push("rgba32f");var Fi=["uint8"];Qt.oes_texture_half_float&&Fi.push("half float","float16"),Qt.oes_texture_float&&Fi.push("float","float32");function Ri(Ki,Ei,$r){this.target=Ki,this.texture=Ei,this.renderbuffer=$r;var zo=0,Ua=0;Ei?(zo=Ei.width,Ua=Ei.height):$r&&(zo=$r.width,Ua=$r.height),this.width=zo,this.height=Ua}function Di(Ki){Ki&&(Ki.texture&&Ki.texture._texture.decRef(),Ki.renderbuffer&&Ki.renderbuffer._renderbuffer.decRef())}function Xi(Ki,Ei,$r){if(Ki)if(Ki.texture){var zo=Ki.texture._texture,Ua=Math.max(1,zo.width),co=Math.max(1,zo.height);de(Ua===Ei&&co===$r,"inconsistent width/height for supplied texture"),zo.refCount+=1}else{var Da=Ki.renderbuffer._renderbuffer;de(Da.width===Ei&&Da.height===$r,"inconsistent width/height for renderbuffer"),Da.refCount+=1}}function pi(Ki,Ei){Ei&&(Ei.texture?Fe.framebufferTexture2D(fl,Ki,Ei.target,Ei.texture._texture.texture,0):Fe.framebufferRenderbuffer(fl,Ki,Gc,Ei.renderbuffer._renderbuffer.renderbuffer))}function Ni(Ki){var Ei=Bf,$r=null,zo=null,Ua=Ki;typeof Ki=="object"&&(Ua=Ki.data,"target"in Ki&&(Ei=Ki.target|0)),de.type(Ua,"function","invalid attachment data");var co=Ua._reglType;return co==="texture2d"?($r=Ua,de(Ei===Bf)):co==="textureCube"?($r=Ua,de(Ei>=wd&&Ei<wd+6,"invalid cube map target")):co==="renderbuffer"?(zo=Ua,Ei=Gc):de.raise("invalid regl object for attachment"),new Ri(Ei,$r,zo)}function pr(Ki,Ei,$r,zo,Ua){if($r){var co=Or.create2D({width:Ki,height:Ei,format:zo,type:Ua});return co._texture.refCount=0,new Ri(Bf,co,null)}else{var Da=Wr.create({width:Ki,height:Ei,format:zo});return Da._renderbuffer.refCount=0,new Ri(Gc,null,Da)}}function Lr(Ki){return Ki&&(Ki.texture||Ki.renderbuffer)}function yi(Ki,Ei,$r){Ki&&(Ki.texture?Ki.texture.resize(Ei,$r):Ki.renderbuffer&&Ki.renderbuffer.resize(Ei,$r),Ki.width=Ei,Ki.height=$r)}var eo=0,ii={};function oo(){this.id=eo++,ii[this.id]=this,this.framebuffer=Fe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function xi(Ki){Ki.colorAttachments.forEach(Di),Di(Ki.depthAttachment),Di(Ki.stencilAttachment),Di(Ki.depthStencilAttachment)}function to(Ki){var Ei=Ki.framebuffer;de(Ei,"must not double destroy framebuffer"),Fe.deleteFramebuffer(Ei),Ki.framebuffer=null,Rr.framebufferCount--,delete ii[Ki.id]}function si(Ki){var Ei;Fe.bindFramebuffer(fl,Ki.framebuffer);var $r=Ki.colorAttachments;for(Ei=0;Ei<$r.length;++Ei)pi(ms+Ei,$r[Ei]);for(Ei=$r.length;Ei<On.maxColorAttachments;++Ei)Fe.framebufferTexture2D(fl,ms+Ei,Bf,null,0);Fe.framebufferTexture2D(fl,Yh,Bf,null,0),Fe.framebufferTexture2D(fl,fc,Bf,null,0),Fe.framebufferTexture2D(fl,I0,Bf,null,0),pi(fc,Ki.depthAttachment),pi(I0,Ki.stencilAttachment),pi(Yh,Ki.depthStencilAttachment);var zo=Fe.checkFramebufferStatus(fl);!Fe.isContextLost()&&zo!==qp&&de.raise("framebuffer configuration not supported, status = "+k[zo]),Fe.bindFramebuffer(fl,_r.next?_r.next.framebuffer:null),_r.cur=_r.next,Fe.getError()}function Yi(Ki,Ei){var $r=new oo;Rr.framebufferCount++;function zo(co,Da){var da;de(_r.next!==$r,"can not update framebuffer which is currently in use");var Jo=0,vs=0,_l=!0,$c=!0,Ga=null,dl=!0,el="rgba",Yl="uint8",zl=1,as=null,$l=null,ec=null,mc=!1;if(typeof co=="number")Jo=co|0,vs=Da|0||Jo;else if(!co)Jo=vs=1;else{de.type(co,"object","invalid arguments for framebuffer");var Ra=co;if("shape"in Ra){var Kc=Ra.shape;de(Array.isArray(Kc)&&Kc.length>=2,"invalid shape for framebuffer"),Jo=Kc[0],vs=Kc[1]}else"radius"in Ra&&(Jo=vs=Ra.radius),"width"in Ra&&(Jo=Ra.width),"height"in Ra&&(vs=Ra.height);("color"in Ra||"colors"in Ra)&&(Ga=Ra.color||Ra.colors,Array.isArray(Ga)&&de(Ga.length===1||Qt.webgl_draw_buffers,"multiple render targets not supported")),Ga||("colorCount"in Ra&&(zl=Ra.colorCount|0,de(zl>0,"invalid color buffer count")),"colorTexture"in Ra&&(dl=!!Ra.colorTexture,el="rgba4"),"colorType"in Ra&&(Yl=Ra.colorType,dl?(de(Qt.oes_texture_float||!(Yl==="float"||Yl==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),de(Qt.oes_texture_half_float||!(Yl==="half float"||Yl==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Yl==="half float"||Yl==="float16"?(de(Qt.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),el="rgba16f"):(Yl==="float"||Yl==="float32")&&(de(Qt.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),el="rgba32f"),de.oneOf(Yl,Fi,"invalid color type")),"colorFormat"in Ra&&(el=Ra.colorFormat,Ti.indexOf(el)>=0?dl=!0:li.indexOf(el)>=0?dl=!1:dl?de.oneOf(Ra.colorFormat,Ti,"invalid color format for texture"):de.oneOf(Ra.colorFormat,li,"invalid color format for renderbuffer"))),("depthTexture"in Ra||"depthStencilTexture"in Ra)&&(mc=!!(Ra.depthTexture||Ra.depthStencilTexture),de(!mc||Qt.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ra&&(typeof Ra.depth=="boolean"?_l=Ra.depth:(as=Ra.depth,$c=!1)),"stencil"in Ra&&(typeof Ra.stencil=="boolean"?$c=Ra.stencil:($l=Ra.stencil,_l=!1)),"depthStencil"in Ra&&(typeof Ra.depthStencil=="boolean"?_l=$c=Ra.depthStencil:(ec=Ra.depthStencil,_l=!1,$c=!1))}var Rs=null,Zo=null,Ta=null,Za=null;if(Array.isArray(Ga))Rs=Ga.map(Ni);else if(Ga)Rs=[Ni(Ga)];else for(Rs=new Array(zl),da=0;da<zl;++da)Rs[da]=pr(Jo,vs,dl,el,Yl);de(Qt.webgl_draw_buffers||Rs.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),de(Rs.length<=On.maxColorAttachments,"too many color attachments, not supported"),Jo=Jo||Rs[0].width,vs=vs||Rs[0].height,as?Zo=Ni(as):_l&&!$c&&(Zo=pr(Jo,vs,mc,"depth","uint32")),$l?Ta=Ni($l):$c&&!_l&&(Ta=pr(Jo,vs,!1,"stencil","uint8")),ec?Za=Ni(ec):!as&&!$l&&$c&&_l&&(Za=pr(Jo,vs,mc,"depth stencil","depth stencil")),de(!!as+!!$l+!!ec<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Kl=null;for(da=0;da<Rs.length;++da)if(Xi(Rs[da],Jo,vs),de(!Rs[da]||Rs[da].texture&&Qp.indexOf(Rs[da].texture._texture.format)>=0||Rs[da].renderbuffer&&C.indexOf(Rs[da].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+da+" is invalid"),Rs[da]&&Rs[da].texture){var ch=sh[Rs[da].texture._texture.format]*Ff[Rs[da].texture._texture.type];Kl===null?Kl=ch:de(Kl===ch,"all color attachments much have the same number of bits per pixel.")}return Xi(Zo,Jo,vs),de(!Zo||Zo.texture&&Zo.texture._texture.format===ah||Zo.renderbuffer&&Zo.renderbuffer._renderbuffer.format===ju,"invalid depth attachment for framebuffer object"),Xi(Ta,Jo,vs),de(!Ta||Ta.renderbuffer&&Ta.renderbuffer._renderbuffer.format===Jp,"invalid stencil attachment for framebuffer object"),Xi(Za,Jo,vs),de(!Za||Za.texture&&Za.texture._texture.format===L0||Za.renderbuffer&&Za.renderbuffer._renderbuffer.format===L0,"invalid depth-stencil attachment for framebuffer object"),xi($r),$r.width=Jo,$r.height=vs,$r.colorAttachments=Rs,$r.depthAttachment=Zo,$r.stencilAttachment=Ta,$r.depthStencilAttachment=Za,zo.color=Rs.map(Lr),zo.depth=Lr(Zo),zo.stencil=Lr(Ta),zo.depthStencil=Lr(Za),zo.width=$r.width,zo.height=$r.height,si($r),zo}function Ua(co,Da){de(_r.next!==$r,"can not resize a framebuffer which is currently in use");var da=Math.max(co|0,1),Jo=Math.max(Da|0||da,1);if(da===$r.width&&Jo===$r.height)return zo;for(var vs=$r.colorAttachments,_l=0;_l<vs.length;++_l)yi(vs[_l],da,Jo);return yi($r.depthAttachment,da,Jo),yi($r.stencilAttachment,da,Jo),yi($r.depthStencilAttachment,da,Jo),$r.width=zo.width=da,$r.height=zo.height=Jo,si($r),zo}return zo(Ki,Ei),D(zo,{resize:Ua,_reglType:"framebuffer",_framebuffer:$r,destroy:function(){to($r),xi($r)},use:function(co){_r.setFBO({framebuffer:zo},co)}})}function Bo(Ki){var Ei=Array(6);function $r(Ua){var co;de(Ei.indexOf(_r.next)<0,"can not update framebuffer which is currently in use");var Da={color:null},da=0,Jo=null,vs="rgba",_l="uint8",$c=1;if(typeof Ua=="number")da=Ua|0;else if(!Ua)da=1;else{de.type(Ua,"object","invalid arguments for framebuffer");var Ga=Ua;if("shape"in Ga){var dl=Ga.shape;de(Array.isArray(dl)&&dl.length>=2,"invalid shape for framebuffer"),de(dl[0]===dl[1],"cube framebuffer must be square"),da=dl[0]}else"radius"in Ga&&(da=Ga.radius|0),"width"in Ga?(da=Ga.width|0,"height"in Ga&&de(Ga.height===da,"must be square")):"height"in Ga&&(da=Ga.height|0);("color"in Ga||"colors"in Ga)&&(Jo=Ga.color||Ga.colors,Array.isArray(Jo)&&de(Jo.length===1||Qt.webgl_draw_buffers,"multiple render targets not supported")),Jo||("colorCount"in Ga&&($c=Ga.colorCount|0,de($c>0,"invalid color buffer count")),"colorType"in Ga&&(de.oneOf(Ga.colorType,Fi,"invalid color type"),_l=Ga.colorType),"colorFormat"in Ga&&(vs=Ga.colorFormat,de.oneOf(Ga.colorFormat,Ti,"invalid color format for texture"))),"depth"in Ga&&(Da.depth=Ga.depth),"stencil"in Ga&&(Da.stencil=Ga.stencil),"depthStencil"in Ga&&(Da.depthStencil=Ga.depthStencil)}var el;if(Jo)if(Array.isArray(Jo))for(el=[],co=0;co<Jo.length;++co)el[co]=Jo[co];else el=[Jo];else{el=Array($c);var Yl={radius:da,format:vs,type:_l};for(co=0;co<$c;++co)el[co]=Or.createCube(Yl)}for(Da.color=Array(el.length),co=0;co<el.length;++co){var zl=el[co];de(typeof zl=="function"&&zl._reglType==="textureCube","invalid cube map"),da=da||zl.width,de(zl.width===da&&zl.height===da,"invalid cube map shape"),Da.color[co]={target:wd,data:el[co]}}for(co=0;co<6;++co){for(var as=0;as<el.length;++as)Da.color[as].target=wd+co;co>0&&(Da.depth=Ei[0].depth,Da.stencil=Ei[0].stencil,Da.depthStencil=Ei[0].depthStencil),Ei[co]?Ei[co](Da):Ei[co]=Yi(Da)}return D($r,{width:da,height:da,color:el})}function zo(Ua){var co,Da=Ua|0;if(de(Da>0&&Da<=On.maxCubeMapSize,"invalid radius for cube fbo"),Da===$r.width)return $r;var da=$r.color;for(co=0;co<da.length;++co)da[co].resize(Da);for(co=0;co<6;++co)Ei[co].resize(Da);return $r.width=$r.height=Da,$r}return $r(Ki),D($r,{faces:Ei,resize:zo,_reglType:"framebufferCube",destroy:function(){Ei.forEach(function(Ua){Ua.destroy()})}})}function ha(){_r.cur=null,_r.next=null,_r.dirty=!0,jo(ii).forEach(function(Ki){Ki.framebuffer=Fe.createFramebuffer(),si(Ki)})}return D(_r,{getFramebuffer:function(Ki){if(typeof Ki=="function"&&Ki._reglType==="framebuffer"){var Ei=Ki._framebuffer;if(Ei instanceof oo)return Ei}return null},create:Yi,createCube:Bo,clear:function(){jo(ii).forEach(to)},restore:ha})}var q=5126,he=34962;function je(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=q,this.offset=0,this.stride=0,this.divisor=0}function Xe(Fe,Qt,On,Or,Wr){for(var Rr=On.maxAttributes,_r=new Array(Rr),Ti=0;Ti<Rr;++Ti)_r[Ti]=new je;var li=0,Fi={},Ri={Record:je,scope:{},state:_r,currentVAO:null,targetVAO:null,restore:Xi()?ii:function(){},createVAO:oo,getVAO:Ni,destroyBuffer:Di,setVAO:Xi()?pr:Lr,clear:Xi()?yi:function(){}};function Di(xi){for(var to=0;to<_r.length;++to){var si=_r[to];si.buffer===xi&&(Fe.disableVertexAttribArray(to),si.buffer=null)}}function Xi(){return Qt.oes_vertex_array_object}function pi(){return Qt.angle_instanced_arrays}function Ni(xi){return typeof xi=="function"&&xi._vao?xi._vao:null}function pr(xi){if(xi!==Ri.currentVAO){var to=Xi();xi?to.bindVertexArrayOES(xi.vao):to.bindVertexArrayOES(null),Ri.currentVAO=xi}}function Lr(xi){if(xi!==Ri.currentVAO){if(xi)xi.bindAttrs();else for(var to=pi(),si=0;si<_r.length;++si){var Yi=_r[si];Yi.buffer?(Fe.enableVertexAttribArray(si),Fe.vertexAttribPointer(si,Yi.size,Yi.type,Yi.normalized,Yi.stride,Yi.offfset),to&&to.vertexAttribDivisorANGLE(si,Yi.divisor)):(Fe.disableVertexAttribArray(si),Fe.vertexAttrib4f(si,Yi.x,Yi.y,Yi.z,Yi.w))}Ri.currentVAO=xi}}function yi(){jo(Fi).forEach(function(xi){xi.destroy()})}function eo(){this.id=++li,this.attributes=[];var xi=Xi();xi?this.vao=xi.createVertexArrayOES():this.vao=null,Fi[this.id]=this,this.buffers=[]}eo.prototype.bindAttrs=function(){for(var xi=pi(),to=this.attributes,si=0;si<to.length;++si){var Yi=to[si];Yi.buffer?(Fe.enableVertexAttribArray(si),Fe.bindBuffer(he,Yi.buffer.buffer),Fe.vertexAttribPointer(si,Yi.size,Yi.type,Yi.normalized,Yi.stride,Yi.offset),xi&&xi.vertexAttribDivisorANGLE(si,Yi.divisor)):(Fe.disableVertexAttribArray(si),Fe.vertexAttrib4f(si,Yi.x,Yi.y,Yi.z,Yi.w))}for(var Bo=to.length;Bo<Rr;++Bo)Fe.disableVertexAttribArray(Bo)},eo.prototype.refresh=function(){var xi=Xi();xi&&(xi.bindVertexArrayOES(this.vao),this.bindAttrs(),Ri.currentVAO=this)},eo.prototype.destroy=function(){if(this.vao){var xi=Xi();this===Ri.currentVAO&&(Ri.currentVAO=null,xi.bindVertexArrayOES(null)),xi.deleteVertexArrayOES(this.vao),this.vao=null}Fi[this.id]&&(delete Fi[this.id],Or.vaoCount-=1)};function ii(){var xi=Xi();xi&&jo(Fi).forEach(function(to){to.refresh()})}function oo(xi){var to=new eo;Or.vaoCount+=1;function si(Yi){de(Array.isArray(Yi),"arguments to vertex array constructor must be an array"),de(Yi.length<Rr,"too many attributes"),de(Yi.length>0,"must specify at least one attribute");for(var Bo=0;Bo<to.buffers.length;++Bo)to.buffers[Bo].destroy();to.buffers.length=0;var ha=to.attributes;ha.length=Yi.length;for(var Ki=0;Ki<Yi.length;++Ki){var Ei=Yi[Ki],$r=ha[Ki]=new je;if(Array.isArray(Ei)||W(Ei)||na(Ei)){var zo=Wr.create(Ei,he,!1,!0);$r.buffer=Wr.getBuffer(zo),$r.size=$r.buffer.dimension|0,$r.normalized=!1,$r.type=$r.buffer.dtype,$r.offset=0,$r.stride=0,$r.divisor=0,$r.state=1,to.buffers.push(zo)}else Wr.getBuffer(Ei)?($r.buffer=Wr.getBuffer(Ei),$r.size=$r.buffer.dimension|0,$r.normalized=!1,$r.type=$r.buffer.dtype,$r.offset=0,$r.stride=0,$r.divisor=0,$r.state=1):Wr.getBuffer(Ei.buffer)?($r.buffer=Wr.getBuffer(Ei.buffer),$r.size=(+Ei.size||$r.buffer.dimension)|0,$r.normalized=!!Ei.normalized||!1,"type"in Ei?(de.parameter(Ei.type,Dl,"invalid buffer type"),$r.type=Dl[Ei.type]):$r.type=$r.buffer.dtype,$r.offset=(Ei.offset||0)|0,$r.stride=(Ei.stride||0)|0,$r.divisor=(Ei.divisor||0)|0,$r.state=1,de($r.size>=1&&$r.size<=4,"size must be between 1 and 4"),de($r.offset>=0,"invalid offset"),de($r.stride>=0&&$r.stride<=255,"stride must be between 0 and 255"),de($r.divisor>=0,"divisor must be positive"),de(!$r.divisor||!!Qt.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ei?(de(Ki>0,"first attribute must not be a constant"),$r.x=+Ei.x||0,$r.y=+Ei.y||0,$r.z=+Ei.z||0,$r.w=+Ei.w||0,$r.state=2):de(!1,"invalid attribute spec for location "+Ki)}return to.refresh(),si}return si.destroy=function(){to.destroy()},si._vao=to,si._reglType="vao",si(xi)}return Ri}var kt=35632,jt=35633,Yt=35718,gn=35721;function pn(Fe,Qt,On,Or){var Wr={},Rr={};function _r(pr,Lr,yi,eo){this.name=pr,this.id=Lr,this.location=yi,this.info=eo}function Ti(pr,Lr){for(var yi=0;yi<pr.length;++yi)if(pr[yi].id===Lr.id){pr[yi].location=Lr.location;return}pr.push(Lr)}function li(pr,Lr,yi){var eo=pr===kt?Wr:Rr,ii=eo[Lr];if(!ii){var oo=Qt.str(Lr);ii=Fe.createShader(pr),Fe.shaderSource(ii,oo),Fe.compileShader(ii),de.shaderError(Fe,ii,oo,pr,yi),eo[Lr]=ii}return ii}var Fi={},Ri=[],Di=0;function Xi(pr,Lr){this.id=Di++,this.fragId=pr,this.vertId=Lr,this.program=null,this.uniforms=[],this.attributes=[],Or.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function pi(pr,Lr,yi){var eo,ii,oo=li(kt,pr.fragId),xi=li(jt,pr.vertId),to=pr.program=Fe.createProgram();if(Fe.attachShader(to,oo),Fe.attachShader(to,xi),yi)for(eo=0;eo<yi.length;++eo){var si=yi[eo];Fe.bindAttribLocation(to,si[0],si[1])}Fe.linkProgram(to),de.linkError(Fe,to,Qt.str(pr.fragId),Qt.str(pr.vertId),Lr);var Yi=Fe.getProgramParameter(to,Yt);Or.profile&&(pr.stats.uniformsCount=Yi);var Bo=pr.uniforms;for(eo=0;eo<Yi;++eo)if(ii=Fe.getActiveUniform(to,eo),ii)if(ii.size>1)for(var ha=0;ha<ii.size;++ha){var Ki=ii.name.replace("[0]","["+ha+"]");Ti(Bo,new _r(Ki,Qt.id(Ki),Fe.getUniformLocation(to,Ki),ii))}else Ti(Bo,new _r(ii.name,Qt.id(ii.name),Fe.getUniformLocation(to,ii.name),ii));var Ei=Fe.getProgramParameter(to,gn);Or.profile&&(pr.stats.attributesCount=Ei);var $r=pr.attributes;for(eo=0;eo<Ei;++eo)ii=Fe.getActiveAttrib(to,eo),ii&&Ti($r,new _r(ii.name,Qt.id(ii.name),Fe.getAttribLocation(to,ii.name),ii))}Or.profile&&(On.getMaxUniformsCount=function(){var pr=0;return Ri.forEach(function(Lr){Lr.stats.uniformsCount>pr&&(pr=Lr.stats.uniformsCount)}),pr},On.getMaxAttributesCount=function(){var pr=0;return Ri.forEach(function(Lr){Lr.stats.attributesCount>pr&&(pr=Lr.stats.attributesCount)}),pr});function Ni(){Wr={},Rr={};for(var pr=0;pr<Ri.length;++pr)pi(Ri[pr],null,Ri[pr].attributes.map(function(Lr){return[Lr.location,Lr.name]}))}return{clear:function(){var pr=Fe.deleteShader.bind(Fe);jo(Wr).forEach(pr),Wr={},jo(Rr).forEach(pr),Rr={},Ri.forEach(function(Lr){Fe.deleteProgram(Lr.program)}),Ri.length=0,Fi={},On.shaderCount=0},program:function(pr,Lr,yi,eo){de.command(pr>=0,"missing vertex shader",yi),de.command(Lr>=0,"missing fragment shader",yi);var ii=Fi[Lr];ii||(ii=Fi[Lr]={});var oo=ii[pr];if(oo&&!eo)return oo;var xi=new Xi(Lr,pr);return On.shaderCount++,pi(xi,yi,eo),oo||(ii[pr]=xi),Ri.push(xi),xi},restore:Ni,shader:li,frag:-1,vert:-1}}var Cn=6408,un=5121,kn=3333,er=5126;function ur(Fe,Qt,On,Or,Wr,Rr,_r){function Ti(Ri){var Di;Qt.next===null?(de(Wr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Di=un):(de(Qt.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Di=Qt.next.colorAttachments[0].texture._texture.type,Rr.oes_texture_float?(de(Di===un||Di===er,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Di===er&&de(_r.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):de(Di===un,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Xi=0,pi=0,Ni=Or.framebufferWidth,pr=Or.framebufferHeight,Lr=null;W(Ri)?Lr=Ri:Ri&&(de.type(Ri,"object","invalid arguments to regl.read()"),Xi=Ri.x|0,pi=Ri.y|0,de(Xi>=0&&Xi<Or.framebufferWidth,"invalid x offset for regl.read"),de(pi>=0&&pi<Or.framebufferHeight,"invalid y offset for regl.read"),Ni=(Ri.width||Or.framebufferWidth-Xi)|0,pr=(Ri.height||Or.framebufferHeight-pi)|0,Lr=Ri.data||null),Lr&&(Di===un?de(Lr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Di===er&&de(Lr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),de(Ni>0&&Ni+Xi<=Or.framebufferWidth,"invalid width for read pixels"),de(pr>0&&pr+pi<=Or.framebufferHeight,"invalid height for read pixels"),On();var yi=Ni*pr*4;return Lr||(Di===un?Lr=new Uint8Array(yi):Di===er&&(Lr=Lr||new Float32Array(yi))),de.isTypedArray(Lr,"data buffer for regl.read() must be a typedarray"),de(Lr.byteLength>=yi,"data buffer for regl.read() too small"),Fe.pixelStorei(kn,4),Fe.readPixels(Xi,pi,Ni,pr,Cn,Di,Lr),Lr}function li(Ri){var Di;return Qt.setFBO({framebuffer:Ri.framebuffer},function(){Di=Ti(Ri)}),Di}function Fi(Ri){return!Ri||!("framebuffer"in Ri)?Ti(Ri):li(Ri)}return Fi}function Cr(Fe){return Array.prototype.slice.call(Fe)}function dr(Fe){return Cr(Fe).join("")}function Br(){var Fe=0,Qt=[],On=[];function Or(Di){for(var Xi=0;Xi<On.length;++Xi)if(On[Xi]===Di)return Qt[Xi];var pi="g"+Fe++;return Qt.push(pi),On.push(Di),pi}function Wr(){var Di=[];function Xi(){Di.push.apply(Di,Cr(arguments))}var pi=[];function Ni(){var pr="v"+Fe++;return pi.push(pr),arguments.length>0&&(Di.push(pr,"="),Di.push.apply(Di,Cr(arguments)),Di.push(";")),pr}return D(Xi,{def:Ni,toString:function(){return dr([pi.length>0?"var "+pi.join(",")+";":"",dr(Di)])}})}function Rr(){var Di=Wr(),Xi=Wr(),pi=Di.toString,Ni=Xi.toString;function pr(Lr,yi){Xi(Lr,yi,"=",Di.def(Lr,yi),";")}return D(function(){Di.apply(Di,Cr(arguments))},{def:Di.def,entry:Di,exit:Xi,save:pr,set:function(Lr,yi,eo){pr(Lr,yi),Di(Lr,yi,"=",eo,";")},toString:function(){return pi()+Ni()}})}function _r(){var Di=dr(arguments),Xi=Rr(),pi=Rr(),Ni=Xi.toString,pr=pi.toString;return D(Xi,{then:function(){return Xi.apply(Xi,Cr(arguments)),this},else:function(){return pi.apply(pi,Cr(arguments)),this},toString:function(){var Lr=pr();return Lr&&(Lr="else{"+Lr+"}"),dr(["if(",Di,"){",Ni(),"}",Lr])}})}var Ti=Wr(),li={};function Fi(Di,Xi){var pi=[];function Ni(){var ii="a"+pi.length;return pi.push(ii),ii}Xi=Xi||0;for(var pr=0;pr<Xi;++pr)Ni();var Lr=Rr(),yi=Lr.toString,eo=li[Di]=D(Lr,{arg:Ni,toString:function(){return dr(["function(",pi.join(),"){",yi(),"}"])}});return eo}function Ri(){var Di=['"use strict";',Ti,"return {"];Object.keys(li).forEach(function(Ni){Di.push('"',Ni,'":',li[Ni].toString(),",")}),Di.push("}");var Xi=dr(Di).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),pi=Function.apply(null,Qt.concat(Xi));return pi.apply(null,On)}return{global:Ti,link:Or,block:Wr,proc:Fi,scope:Rr,cond:_r,compile:Ri}}var ri="xyzw".split(""),Yr=5121,wi=1,Hi=2,Lo=0,Fo=1,ko=2,fa=3,Bn=4,qt="dither",ua="blend.enable",ra="blend.color",Ho="blend.equation",_a="blend.func",Vo="depth.enable",Do="depth.func",hc="depth.range",vl="depth.mask",Fc="colorMask",Gl="cull.enable",bs="cull.face",Qs="frontFace",ll="lineWidth",gl="polygonOffset.enable",_f="polygonOffset.offset",al="sample.alpha",sf="sample.enable",Vu="sample.coverage",Vd="stencil.enable",kf="stencil.mask",Sh="stencil.func",Hd="stencil.opFront",$h="stencil.opBack",bf="scissor.enable",Ai="scissor.box",hl="viewport",ba="profile",xs="framebuffer",Fl="vert",Hu="frag",No="elements",kl="primitive",Xl="count",xf="offset",Zd="instances",lf="vao",Ep="Width",Ad="Height",Ls=xs+Ep,cf=xs+Ad,lh=hl+Ep,D0=hl+Ad,io="drawingBuffer",gu=io+Ep,ey=io+Ad,lm=[_a,Ho,Sh,Hd,$h,Vu,hl,Ai,_f],Sp=34962,ty=34963,Gv=35632,ny=35633,cm=3553,um=34067,N0=2884,ry=3042,Tp=3024,wp=2960,ev=2929,tv=3089,iy=32823,Wd=32926,t0=32928,Kh=5126,nv=35664,qh=35665,B0=35666,Yc=5124,Ap=35667,Js=35668,Ef=35669,F0=35670,Gd=35671,Cp=35672,dc=35673,Xd=35674,Qh=35675,yl=35676,Op=35678,n0=35680,fm=4,Th=1028,su=1029,yu=2304,r0=2305,i0=32775,Rp=32776,Sf=519,Cd=7680,oy=0,ay=1,rv=32774,k0=513,Jh=36160,hm=36064,zf={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},o0=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Yd={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},$d={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},iv={frag:Gv,vert:ny},wh={cw:yu,ccw:r0};function a0(Fe){return Array.isArray(Fe)||W(Fe)||na(Fe)}function Mp(Fe){return Fe.sort(function(Qt,On){return Qt===hl?-1:On===hl?1:Qt<On?-1:1})}function _u(Fe,Qt,On,Or){this.thisDep=Fe,this.contextDep=Qt,this.propDep=On,this.append=Or}function lu(Fe){return Fe&&!(Fe.thisDep||Fe.contextDep||Fe.propDep)}function pc(Fe){return new _u(!1,!1,!1,Fe)}function Zu(Fe,Qt){var On=Fe.type;if(On===Lo){var Or=Fe.data.length;return new _u(!0,Or>=1,Or>=2,Qt)}else if(On===Bn){var Wr=Fe.data;return new _u(Wr.thisDep,Wr.contextDep,Wr.propDep,Qt)}else return new _u(On===fa,On===ko,On===Fo,Qt)}var bu=new _u(!1,!1,!1,function(){});function Pp(Fe,Qt,On,Or,Wr,Rr,_r,Ti,li,Fi,Ri,Di,Xi,pi,Ni){var pr=Fi.Record,Lr={add:32774,subtract:32778,"reverse subtract":32779};On.ext_blend_minmax&&(Lr.min=i0,Lr.max=Rp);var yi=On.angle_instanced_arrays,eo=On.webgl_draw_buffers,ii={dirty:!0,profile:Ni.profile},oo={},xi=[],to={},si={};function Yi(Lt){return Lt.replace(".","_")}function Bo(Lt,nn,Mn){var Ar=Yi(Lt);xi.push(Lt),oo[Ar]=ii[Ar]=!!Mn,to[Ar]=nn}function ha(Lt,nn,Mn){var Ar=Yi(Lt);xi.push(Lt),Array.isArray(Mn)?(ii[Ar]=Mn.slice(),oo[Ar]=Mn.slice()):ii[Ar]=oo[Ar]=Mn,si[Ar]=nn}Bo(qt,Tp),Bo(ua,ry),ha(ra,"blendColor",[0,0,0,0]),ha(Ho,"blendEquationSeparate",[rv,rv]),ha(_a,"blendFuncSeparate",[ay,oy,ay,oy]),Bo(Vo,ev,!0),ha(Do,"depthFunc",k0),ha(hc,"depthRange",[0,1]),ha(vl,"depthMask",!0),ha(Fc,Fc,[!0,!0,!0,!0]),Bo(Gl,N0),ha(bs,"cullFace",su),ha(Qs,Qs,r0),ha(ll,ll,1),Bo(gl,iy),ha(_f,"polygonOffset",[0,0]),Bo(al,Wd),Bo(sf,t0),ha(Vu,"sampleCoverage",[1,!1]),Bo(Vd,wp),ha(kf,"stencilMask",-1),ha(Sh,"stencilFunc",[Sf,0,-1]),ha(Hd,"stencilOpSeparate",[Th,Cd,Cd,Cd]),ha($h,"stencilOpSeparate",[su,Cd,Cd,Cd]),Bo(bf,tv),ha(Ai,"scissor",[0,0,Fe.drawingBufferWidth,Fe.drawingBufferHeight]),ha(hl,hl,[0,0,Fe.drawingBufferWidth,Fe.drawingBufferHeight]);var Ki={gl:Fe,context:Xi,strings:Qt,next:oo,current:ii,draw:Di,elements:Rr,buffer:Wr,shader:Ri,attributes:Fi.state,vao:Fi,uniforms:li,framebuffer:Ti,extensions:On,timer:pi,isBufferArgs:a0},Ei={primTypes:Mu,compareFuncs:Yd,blendFuncs:zf,blendEquations:Lr,stencilOps:$d,glTypes:Dl,orientationType:wh};de.optional(function(){Ki.isArrayLike=ol}),eo&&(Ei.backBuffer=[su],Ei.drawBuffer=Jn(Or.maxDrawbuffers,function(Lt){return Lt===0?[0]:Jn(Lt,function(nn){return hm+nn})}));var $r=0;function zo(){var Lt=Br(),nn=Lt.link,Mn=Lt.global;Lt.id=$r++,Lt.batchId="0";var Ar=nn(Ki),xr=Lt.shared={props:"a0"};Object.keys(Ki).forEach(function(Hn){xr[Hn]=Mn.def(Ar,".",Hn)}),de.optional(function(){Lt.CHECK=nn(de),Lt.commandStr=de.guessCommand(),Lt.command=nn(Lt.commandStr),Lt.assert=function(Hn,Kt,Yn){Hn("if(!(",Kt,"))",this.CHECK,".commandRaise(",nn(Yn),",",this.command,");")},Ei.invalidBlendCombinations=o0});var Un=Lt.next={},Kn=Lt.current={};Object.keys(si).forEach(function(Hn){Array.isArray(ii[Hn])&&(Un[Hn]=Mn.def(xr.next,".",Hn),Kn[Hn]=Mn.def(xr.current,".",Hn))});var ir=Lt.constants={};Object.keys(Ei).forEach(function(Hn){ir[Hn]=Mn.def(JSON.stringify(Ei[Hn]))}),Lt.invoke=function(Hn,Kt){switch(Kt.type){case Lo:var Yn=["this",xr.context,xr.props,Lt.batchId];return Hn.def(nn(Kt.data),".call(",Yn.slice(0,Math.max(Kt.data.length+1,4)),")");case Fo:return Hn.def(xr.props,Kt.data);case ko:return Hn.def(xr.context,Kt.data);case fa:return Hn.def("this",Kt.data);case Bn:return Kt.data.append(Lt,Hn),Kt.data.ref}},Lt.attribCache={};var yn={};return Lt.scopeAttrib=function(Hn){var Kt=Qt.id(Hn);if(Kt in yn)return yn[Kt];var Yn=Fi.scope[Kt];Yn||(Yn=Fi.scope[Kt]=new pr);var Dr=yn[Kt]=nn(Yn);return Dr},Lt}function Ua(Lt){var nn=Lt.static,Mn=Lt.dynamic,Ar;if(ba in nn){var xr=!!nn[ba];Ar=pc(function(Kn,ir){return xr}),Ar.enable=xr}else if(ba in Mn){var Un=Mn[ba];Ar=Zu(Un,function(Kn,ir){return Kn.invoke(ir,Un)})}return Ar}function co(Lt,nn){var Mn=Lt.static,Ar=Lt.dynamic;if(xs in Mn){var xr=Mn[xs];return xr?(xr=Ti.getFramebuffer(xr),de.command(xr,"invalid framebuffer object"),pc(function(Kn,ir){var yn=Kn.link(xr),Hn=Kn.shared;ir.set(Hn.framebuffer,".next",yn);var Kt=Hn.context;return ir.set(Kt,"."+Ls,yn+".width"),ir.set(Kt,"."+cf,yn+".height"),yn})):pc(function(Kn,ir){var yn=Kn.shared;ir.set(yn.framebuffer,".next","null");var Hn=yn.context;return ir.set(Hn,"."+Ls,Hn+"."+gu),ir.set(Hn,"."+cf,Hn+"."+ey),"null"})}else if(xs in Ar){var Un=Ar[xs];return Zu(Un,function(Kn,ir){var yn=Kn.invoke(ir,Un),Hn=Kn.shared,Kt=Hn.framebuffer,Yn=ir.def(Kt,".getFramebuffer(",yn,")");de.optional(function(){Kn.assert(ir,"!"+yn+"||"+Yn,"invalid framebuffer object")}),ir.set(Kt,".next",Yn);var Dr=Hn.context;return ir.set(Dr,"."+Ls,Yn+"?"+Yn+".width:"+Dr+"."+gu),ir.set(Dr,"."+cf,Yn+"?"+Yn+".height:"+Dr+"."+ey),Yn})}else return null}function Da(Lt,nn,Mn){var Ar=Lt.static,xr=Lt.dynamic;function Un(yn){if(yn in Ar){var Hn=Ar[yn];de.commandType(Hn,"object","invalid "+yn,Mn.commandStr);var Kt=!0,Yn=Hn.x|0,Dr=Hn.y|0,zr,mi;return"width"in Hn?(zr=Hn.width|0,de.command(zr>=0,"invalid "+yn,Mn.commandStr)):Kt=!1,"height"in Hn?(mi=Hn.height|0,de.command(mi>=0,"invalid "+yn,Mn.commandStr)):Kt=!1,new _u(!Kt&&nn&&nn.thisDep,!Kt&&nn&&nn.contextDep,!Kt&&nn&&nn.propDep,function(Ro,Ui){var xo=Ro.shared.context,qo=zr;"width"in Hn||(qo=Ui.def(xo,".",Ls,"-",Yn));var ia=mi;return"height"in Hn||(ia=Ui.def(xo,".",cf,"-",Dr)),[Yn,Dr,qo,ia]})}else if(yn in xr){var Kr=xr[yn],hi=Zu(Kr,function(Ro,Ui){var xo=Ro.invoke(Ui,Kr);de.optional(function(){Ro.assert(Ui,xo+"&&typeof "+xo+'==="object"',"invalid "+yn)});var qo=Ro.shared.context,ia=Ui.def(xo,".x|0"),As=Ui.def(xo,".y|0"),Sc=Ui.def('"width" in ',xo,"?",xo,".width|0:","(",qo,".",Ls,"-",ia,")"),xu=Ui.def('"height" in ',xo,"?",xo,".height|0:","(",qo,".",cf,"-",As,")");return de.optional(function(){Ro.assert(Ui,Sc+">=0&&"+xu+">=0","invalid "+yn)}),[ia,As,Sc,xu]});return nn&&(hi.thisDep=hi.thisDep||nn.thisDep,hi.contextDep=hi.contextDep||nn.contextDep,hi.propDep=hi.propDep||nn.propDep),hi}else return nn?new _u(nn.thisDep,nn.contextDep,nn.propDep,function(Ro,Ui){var xo=Ro.shared.context;return[0,0,Ui.def(xo,".",Ls),Ui.def(xo,".",cf)]}):null}var Kn=Un(hl);if(Kn){var ir=Kn;Kn=new _u(Kn.thisDep,Kn.contextDep,Kn.propDep,function(yn,Hn){var Kt=ir.append(yn,Hn),Yn=yn.shared.context;return Hn.set(Yn,"."+lh,Kt[2]),Hn.set(Yn,"."+D0,Kt[3]),Kt})}return{viewport:Kn,scissor_box:Un(Ai)}}function da(Lt,nn){var Mn=Lt.static,Ar=typeof Mn[Hu]=="string"&&typeof Mn[Fl]=="string";if(Ar){if(Object.keys(nn.dynamic).length>0)return null;var xr=nn.static,Un=Object.keys(xr);if(Un.length>0&&typeof xr[Un[0]]=="number"){for(var Kn=[],ir=0;ir<Un.length;++ir)de(typeof xr[Un[ir]]=="number","must specify all vertex attribute locations when using vaos"),Kn.push([xr[Un[ir]]|0,Un[ir]]);return Kn}}return null}function Jo(Lt,nn,Mn){var Ar=Lt.static,xr=Lt.dynamic;function Un(Kt){if(Kt in Ar){var Yn=Qt.id(Ar[Kt]);de.optional(function(){Ri.shader(iv[Kt],Yn,de.guessCommand())});var Dr=pc(function(){return Yn});return Dr.id=Yn,Dr}else if(Kt in xr){var zr=xr[Kt];return Zu(zr,function(mi,Kr){var hi=mi.invoke(Kr,zr),Ro=Kr.def(mi.shared.strings,".id(",hi,")");return de.optional(function(){Kr(mi.shared.shader,".shader(",iv[Kt],",",Ro,",",mi.command,");")}),Ro})}return null}var Kn=Un(Hu),ir=Un(Fl),yn=null,Hn;return lu(Kn)&&lu(ir)?(yn=Ri.program(ir.id,Kn.id,null,Mn),Hn=pc(function(Kt,Yn){return Kt.link(yn)})):Hn=new _u(Kn&&Kn.thisDep||ir&&ir.thisDep,Kn&&Kn.contextDep||ir&&ir.contextDep,Kn&&Kn.propDep||ir&&ir.propDep,function(Kt,Yn){var Dr=Kt.shared.shader,zr;Kn?zr=Kn.append(Kt,Yn):zr=Yn.def(Dr,".",Hu);var mi;ir?mi=ir.append(Kt,Yn):mi=Yn.def(Dr,".",Fl);var Kr=Dr+".program("+mi+","+zr;return de.optional(function(){Kr+=","+Kt.command}),Yn.def(Kr+")")}),{frag:Kn,vert:ir,progVar:Hn,program:yn}}function vs(Lt,nn){var Mn=Lt.static,Ar=Lt.dynamic;function xr(){if(No in Mn){var Kt=Mn[No];a0(Kt)?Kt=Rr.getElements(Rr.create(Kt,!0)):Kt&&(Kt=Rr.getElements(Kt),de.command(Kt,"invalid elements",nn.commandStr));var Yn=pc(function(zr,mi){if(Kt){var Kr=zr.link(Kt);return zr.ELEMENTS=Kr,Kr}return zr.ELEMENTS=null,null});return Yn.value=Kt,Yn}else if(No in Ar){var Dr=Ar[No];return Zu(Dr,function(zr,mi){var Kr=zr.shared,hi=Kr.isBufferArgs,Ro=Kr.elements,Ui=zr.invoke(mi,Dr),xo=mi.def("null"),qo=mi.def(hi,"(",Ui,")"),ia=zr.cond(qo).then(xo,"=",Ro,".createStream(",Ui,");").else(xo,"=",Ro,".getElements(",Ui,");");return de.optional(function(){zr.assert(ia.else,"!"+Ui+"||"+xo,"invalid elements")}),mi.entry(ia),mi.exit(zr.cond(qo).then(Ro,".destroyStream(",xo,");")),zr.ELEMENTS=xo,xo})}return null}var Un=xr();function Kn(){if(kl in Mn){var Kt=Mn[kl];return de.commandParameter(Kt,Mu,"invalid primitve",nn.commandStr),pc(function(Dr,zr){return Mu[Kt]})}else if(kl in Ar){var Yn=Ar[kl];return Zu(Yn,function(Dr,zr){var mi=Dr.constants.primTypes,Kr=Dr.invoke(zr,Yn);return de.optional(function(){Dr.assert(zr,Kr+" in "+mi,"invalid primitive, must be one of "+Object.keys(Mu))}),zr.def(mi,"[",Kr,"]")})}else if(Un)return lu(Un)?Un.value?pc(function(Dr,zr){return zr.def(Dr.ELEMENTS,".primType")}):pc(function(){return fm}):new _u(Un.thisDep,Un.contextDep,Un.propDep,function(Dr,zr){var mi=Dr.ELEMENTS;return zr.def(mi,"?",mi,".primType:",fm)});return null}function ir(Kt,Yn){if(Kt in Mn){var Dr=Mn[Kt]|0;return de.command(!Yn||Dr>=0,"invalid "+Kt,nn.commandStr),pc(function(mi,Kr){return Yn&&(mi.OFFSET=Dr),Dr})}else if(Kt in Ar){var zr=Ar[Kt];return Zu(zr,function(mi,Kr){var hi=mi.invoke(Kr,zr);return Yn&&(mi.OFFSET=hi,de.optional(function(){mi.assert(Kr,hi+">=0","invalid "+Kt)})),hi})}else if(Yn&&Un)return pc(function(mi,Kr){return mi.OFFSET="0",0});return null}var yn=ir(xf,!0);function Hn(){if(Xl in Mn){var Kt=Mn[Xl]|0;return de.command(typeof Kt=="number"&&Kt>=0,"invalid vertex count",nn.commandStr),pc(function(){return Kt})}else if(Xl in Ar){var Yn=Ar[Xl];return Zu(Yn,function(mi,Kr){var hi=mi.invoke(Kr,Yn);return de.optional(function(){mi.assert(Kr,"typeof "+hi+'==="number"&&'+hi+">=0&&"+hi+"===("+hi+"|0)","invalid vertex count")}),hi})}else if(Un)if(lu(Un)){if(Un)return yn?new _u(yn.thisDep,yn.contextDep,yn.propDep,function(mi,Kr){var hi=Kr.def(mi.ELEMENTS,".vertCount-",mi.OFFSET);return de.optional(function(){mi.assert(Kr,hi+">=0","invalid vertex offset/element buffer too small")}),hi}):pc(function(mi,Kr){return Kr.def(mi.ELEMENTS,".vertCount")});var Dr=pc(function(){return-1});return de.optional(function(){Dr.MISSING=!0}),Dr}else{var zr=new _u(Un.thisDep||yn.thisDep,Un.contextDep||yn.contextDep,Un.propDep||yn.propDep,function(mi,Kr){var hi=mi.ELEMENTS;return mi.OFFSET?Kr.def(hi,"?",hi,".vertCount-",mi.OFFSET,":-1"):Kr.def(hi,"?",hi,".vertCount:-1")});return de.optional(function(){zr.DYNAMIC=!0}),zr}return null}return{elements:Un,primitive:Kn(),count:Hn(),instances:ir(Zd,!1),offset:yn}}function _l(Lt,nn){var Mn=Lt.static,Ar=Lt.dynamic,xr={};return xi.forEach(function(Un){var Kn=Yi(Un);function ir(yn,Hn){if(Un in Mn){var Kt=yn(Mn[Un]);xr[Kn]=pc(function(){return Kt})}else if(Un in Ar){var Yn=Ar[Un];xr[Kn]=Zu(Yn,function(Dr,zr){return Hn(Dr,zr,Dr.invoke(zr,Yn))})}}switch(Un){case Gl:case ua:case qt:case Vd:case Vo:case bf:case gl:case al:case sf:case vl:return ir(function(yn){return de.commandType(yn,"boolean",Un,nn.commandStr),yn},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,"typeof "+Kt+'==="boolean"',"invalid flag "+Un,yn.commandStr)}),Kt});case Do:return ir(function(yn){return de.commandParameter(yn,Yd,"invalid "+Un,nn.commandStr),Yd[yn]},function(yn,Hn,Kt){var Yn=yn.constants.compareFuncs;return de.optional(function(){yn.assert(Hn,Kt+" in "+Yn,"invalid "+Un+", must be one of "+Object.keys(Yd))}),Hn.def(Yn,"[",Kt,"]")});case hc:return ir(function(yn){return de.command(ol(yn)&&yn.length===2&&typeof yn[0]=="number"&&typeof yn[1]=="number"&&yn[0]<=yn[1],"depth range is 2d array",nn.commandStr),yn},function(yn,Hn,Kt){de.optional(function(){yn.assert(Hn,yn.shared.isArrayLike+"("+Kt+")&&"+Kt+".length===2&&typeof "+Kt+'[0]==="number"&&typeof '+Kt+'[1]==="number"&&'+Kt+"[0]<="+Kt+"[1]","depth range must be a 2d array")});var Yn=Hn.def("+",Kt,"[0]"),Dr=Hn.def("+",Kt,"[1]");return[Yn,Dr]});case _a:return ir(function(yn){de.commandType(yn,"object","blend.func",nn.commandStr);var Hn="srcRGB"in yn?yn.srcRGB:yn.src,Kt="srcAlpha"in yn?yn.srcAlpha:yn.src,Yn="dstRGB"in yn?yn.dstRGB:yn.dst,Dr="dstAlpha"in yn?yn.dstAlpha:yn.dst;return de.commandParameter(Hn,zf,Kn+".srcRGB",nn.commandStr),de.commandParameter(Kt,zf,Kn+".srcAlpha",nn.commandStr),de.commandParameter(Yn,zf,Kn+".dstRGB",nn.commandStr),de.commandParameter(Dr,zf,Kn+".dstAlpha",nn.commandStr),de.command(o0.indexOf(Hn+", "+Yn)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Hn+", "+Yn+")",nn.commandStr),[zf[Hn],zf[Yn],zf[Kt],zf[Dr]]},function(yn,Hn,Kt){var Yn=yn.constants.blendFuncs;de.optional(function(){yn.assert(Hn,Kt+"&&typeof "+Kt+'==="object"',"invalid blend func, must be an object")});function Dr(xo,qo){var ia=Hn.def('"',xo,qo,'" in ',Kt,"?",Kt,".",xo,qo,":",Kt,".",xo);return de.optional(function(){yn.assert(Hn,ia+" in "+Yn,"invalid "+Un+"."+xo+qo+", must be one of "+Object.keys(zf))}),ia}var zr=Dr("src","RGB"),mi=Dr("dst","RGB");de.optional(function(){var xo=yn.constants.invalidBlendCombinations;yn.assert(Hn,xo+".indexOf("+zr+'+", "+'+mi+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Kr=Hn.def(Yn,"[",zr,"]"),hi=Hn.def(Yn,"[",Dr("src","Alpha"),"]"),Ro=Hn.def(Yn,"[",mi,"]"),Ui=Hn.def(Yn,"[",Dr("dst","Alpha"),"]");return[Kr,Ro,hi,Ui]});case Ho:return ir(function(yn){if(typeof yn=="string")return de.commandParameter(yn,Lr,"invalid "+Un,nn.commandStr),[Lr[yn],Lr[yn]];if(typeof yn=="object")return de.commandParameter(yn.rgb,Lr,Un+".rgb",nn.commandStr),de.commandParameter(yn.alpha,Lr,Un+".alpha",nn.commandStr),[Lr[yn.rgb],Lr[yn.alpha]];de.commandRaise("invalid blend.equation",nn.commandStr)},function(yn,Hn,Kt){var Yn=yn.constants.blendEquations,Dr=Hn.def(),zr=Hn.def(),mi=yn.cond("typeof ",Kt,'==="string"');return de.optional(function(){function Kr(hi,Ro,Ui){yn.assert(hi,Ui+" in "+Yn,"invalid "+Ro+", must be one of "+Object.keys(Lr))}Kr(mi.then,Un,Kt),yn.assert(mi.else,Kt+"&&typeof "+Kt+'==="object"',"invalid "+Un),Kr(mi.else,Un+".rgb",Kt+".rgb"),Kr(mi.else,Un+".alpha",Kt+".alpha")}),mi.then(Dr,"=",zr,"=",Yn,"[",Kt,"];"),mi.else(Dr,"=",Yn,"[",Kt,".rgb];",zr,"=",Yn,"[",Kt,".alpha];"),Hn(mi),[Dr,zr]});case ra:return ir(function(yn){return de.command(ol(yn)&&yn.length===4,"blend.color must be a 4d array",nn.commandStr),Jn(4,function(Hn){return+yn[Hn]})},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,yn.shared.isArrayLike+"("+Kt+")&&"+Kt+".length===4","blend.color must be a 4d array")}),Jn(4,function(Yn){return Hn.def("+",Kt,"[",Yn,"]")})});case kf:return ir(function(yn){return de.commandType(yn,"number",Kn,nn.commandStr),yn|0},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,"typeof "+Kt+'==="number"',"invalid stencil.mask")}),Hn.def(Kt,"|0")});case Sh:return ir(function(yn){de.commandType(yn,"object",Kn,nn.commandStr);var Hn=yn.cmp||"keep",Kt=yn.ref||0,Yn="mask"in yn?yn.mask:-1;return de.commandParameter(Hn,Yd,Un+".cmp",nn.commandStr),de.commandType(Kt,"number",Un+".ref",nn.commandStr),de.commandType(Yn,"number",Un+".mask",nn.commandStr),[Yd[Hn],Kt,Yn]},function(yn,Hn,Kt){var Yn=yn.constants.compareFuncs;de.optional(function(){function Kr(){yn.assert(Hn,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Kr(Kt+"&&typeof ",Kt,'==="object"'),Kr('!("cmp" in ',Kt,")||(",Kt,".cmp in ",Yn,")")});var Dr=Hn.def('"cmp" in ',Kt,"?",Yn,"[",Kt,".cmp]",":",Cd),zr=Hn.def(Kt,".ref|0"),mi=Hn.def('"mask" in ',Kt,"?",Kt,".mask|0:-1");return[Dr,zr,mi]});case Hd:case $h:return ir(function(yn){de.commandType(yn,"object",Kn,nn.commandStr);var Hn=yn.fail||"keep",Kt=yn.zfail||"keep",Yn=yn.zpass||"keep";return de.commandParameter(Hn,$d,Un+".fail",nn.commandStr),de.commandParameter(Kt,$d,Un+".zfail",nn.commandStr),de.commandParameter(Yn,$d,Un+".zpass",nn.commandStr),[Un===$h?su:Th,$d[Hn],$d[Kt],$d[Yn]]},function(yn,Hn,Kt){var Yn=yn.constants.stencilOps;de.optional(function(){yn.assert(Hn,Kt+"&&typeof "+Kt+'==="object"',"invalid "+Un)});function Dr(zr){return de.optional(function(){yn.assert(Hn,'!("'+zr+'" in '+Kt+")||("+Kt+"."+zr+" in "+Yn+")","invalid "+Un+"."+zr+", must be one of "+Object.keys($d))}),Hn.def('"',zr,'" in ',Kt,"?",Yn,"[",Kt,".",zr,"]:",Cd)}return[Un===$h?su:Th,Dr("fail"),Dr("zfail"),Dr("zpass")]});case _f:return ir(function(yn){de.commandType(yn,"object",Kn,nn.commandStr);var Hn=yn.factor|0,Kt=yn.units|0;return de.commandType(Hn,"number",Kn+".factor",nn.commandStr),de.commandType(Kt,"number",Kn+".units",nn.commandStr),[Hn,Kt]},function(yn,Hn,Kt){de.optional(function(){yn.assert(Hn,Kt+"&&typeof "+Kt+'==="object"',"invalid "+Un)});var Yn=Hn.def(Kt,".factor|0"),Dr=Hn.def(Kt,".units|0");return[Yn,Dr]});case bs:return ir(function(yn){var Hn=0;return yn==="front"?Hn=Th:yn==="back"&&(Hn=su),de.command(!!Hn,Kn,nn.commandStr),Hn},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,Kt+'==="front"||'+Kt+'==="back"',"invalid cull.face")}),Hn.def(Kt,'==="front"?',Th,":",su)});case ll:return ir(function(yn){return de.command(typeof yn=="number"&&yn>=Or.lineWidthDims[0]&&yn<=Or.lineWidthDims[1],"invalid line width, must be a positive number between "+Or.lineWidthDims[0]+" and "+Or.lineWidthDims[1],nn.commandStr),yn},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,"typeof "+Kt+'==="number"&&'+Kt+">="+Or.lineWidthDims[0]+"&&"+Kt+"<="+Or.lineWidthDims[1],"invalid line width")}),Kt});case Qs:return ir(function(yn){return de.commandParameter(yn,wh,Kn,nn.commandStr),wh[yn]},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,Kt+'==="cw"||'+Kt+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Hn.def(Kt+'==="cw"?'+yu+":"+r0)});case Fc:return ir(function(yn){return de.command(ol(yn)&&yn.length===4,"color.mask must be length 4 array",nn.commandStr),yn.map(function(Hn){return!!Hn})},function(yn,Hn,Kt){return de.optional(function(){yn.assert(Hn,yn.shared.isArrayLike+"("+Kt+")&&"+Kt+".length===4","invalid color.mask")}),Jn(4,function(Yn){return"!!"+Kt+"["+Yn+"]"})});case Vu:return ir(function(yn){de.command(typeof yn=="object"&&yn,Kn,nn.commandStr);var Hn="value"in yn?yn.value:1,Kt=!!yn.invert;return de.command(typeof Hn=="number"&&Hn>=0&&Hn<=1,"sample.coverage.value must be a number between 0 and 1",nn.commandStr),[Hn,Kt]},function(yn,Hn,Kt){de.optional(function(){yn.assert(Hn,Kt+"&&typeof "+Kt+'==="object"',"invalid sample.coverage")});var Yn=Hn.def('"value" in ',Kt,"?+",Kt,".value:1"),Dr=Hn.def("!!",Kt,".invert");return[Yn,Dr]})}}),xr}function $c(Lt,nn){var Mn=Lt.static,Ar=Lt.dynamic,xr={};return Object.keys(Mn).forEach(function(Un){var Kn=Mn[Un],ir;if(typeof Kn=="number"||typeof Kn=="boolean")ir=pc(function(){return Kn});else if(typeof Kn=="function"){var yn=Kn._reglType;yn==="texture2d"||yn==="textureCube"?ir=pc(function(Hn){return Hn.link(Kn)}):yn==="framebuffer"||yn==="framebufferCube"?(de.command(Kn.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Un+'"',nn.commandStr),ir=pc(function(Hn){return Hn.link(Kn.color[0])})):de.commandRaise('invalid data for uniform "'+Un+'"',nn.commandStr)}else ol(Kn)?ir=pc(function(Hn){var Kt=Hn.global.def("[",Jn(Kn.length,function(Yn){return de.command(typeof Kn[Yn]=="number"||typeof Kn[Yn]=="boolean","invalid uniform "+Un,Hn.commandStr),Kn[Yn]}),"]");return Kt}):de.commandRaise('invalid or missing data for uniform "'+Un+'"',nn.commandStr);ir.value=Kn,xr[Un]=ir}),Object.keys(Ar).forEach(function(Un){var Kn=Ar[Un];xr[Un]=Zu(Kn,function(ir,yn){return ir.invoke(yn,Kn)})}),xr}function Ga(Lt,nn){var Mn=Lt.static,Ar=Lt.dynamic,xr={};return Object.keys(Mn).forEach(function(Un){var Kn=Mn[Un],ir=Qt.id(Un),yn=new pr;if(a0(Kn))yn.state=wi,yn.buffer=Wr.getBuffer(Wr.create(Kn,Sp,!1,!0)),yn.type=0;else{var Hn=Wr.getBuffer(Kn);if(Hn)yn.state=wi,yn.buffer=Hn,yn.type=0;else if(de.command(typeof Kn=="object"&&Kn,"invalid data for attribute "+Un,nn.commandStr),"constant"in Kn){var Kt=Kn.constant;yn.buffer="null",yn.state=Hi,typeof Kt=="number"?yn.x=Kt:(de.command(ol(Kt)&&Kt.length>0&&Kt.length<=4,"invalid constant for attribute "+Un,nn.commandStr),ri.forEach(function(Ro,Ui){Ui<Kt.length&&(yn[Ro]=Kt[Ui])}))}else{a0(Kn.buffer)?Hn=Wr.getBuffer(Wr.create(Kn.buffer,Sp,!1,!0)):Hn=Wr.getBuffer(Kn.buffer),de.command(!!Hn,'missing buffer for attribute "'+Un+'"',nn.commandStr);var Yn=Kn.offset|0;de.command(Yn>=0,'invalid offset for attribute "'+Un+'"',nn.commandStr);var Dr=Kn.stride|0;de.command(Dr>=0&&Dr<256,'invalid stride for attribute "'+Un+'", must be integer betweeen [0, 255]',nn.commandStr);var zr=Kn.size|0;de.command(!("size"in Kn)||zr>0&&zr<=4,'invalid size for attribute "'+Un+'", must be 1,2,3,4',nn.commandStr);var mi=!!Kn.normalized,Kr=0;"type"in Kn&&(de.commandParameter(Kn.type,Dl,"invalid type for attribute "+Un,nn.commandStr),Kr=Dl[Kn.type]);var hi=Kn.divisor|0;"divisor"in Kn&&(de.command(hi===0||yi,'cannot specify divisor for attribute "'+Un+'", instancing not supported',nn.commandStr),de.command(hi>=0,'invalid divisor for attribute "'+Un+'"',nn.commandStr)),de.optional(function(){var Ro=nn.commandStr,Ui=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Kn).forEach(function(xo){de.command(Ui.indexOf(xo)>=0,'unknown parameter "'+xo+'" for attribute pointer "'+Un+'" (valid parameters are '+Ui+")",Ro)})}),yn.buffer=Hn,yn.state=wi,yn.size=zr,yn.normalized=mi,yn.type=Kr||Hn.dtype,yn.offset=Yn,yn.stride=Dr,yn.divisor=hi}}xr[Un]=pc(function(Ro,Ui){var xo=Ro.attribCache;if(ir in xo)return xo[ir];var qo={isStream:!1};return Object.keys(yn).forEach(function(ia){qo[ia]=yn[ia]}),yn.buffer&&(qo.buffer=Ro.link(yn.buffer),qo.type=qo.type||qo.buffer+".dtype"),xo[ir]=qo,qo})}),Object.keys(Ar).forEach(function(Un){var Kn=Ar[Un];function ir(yn,Hn){var Kt=yn.invoke(Hn,Kn),Yn=yn.shared,Dr=yn.constants,zr=Yn.isBufferArgs,mi=Yn.buffer;de.optional(function(){yn.assert(Hn,Kt+"&&(typeof "+Kt+'==="object"||typeof '+Kt+'==="function")&&('+zr+"("+Kt+")||"+mi+".getBuffer("+Kt+")||"+mi+".getBuffer("+Kt+".buffer)||"+zr+"("+Kt+'.buffer)||("constant" in '+Kt+"&&(typeof "+Kt+'.constant==="number"||'+Yn.isArrayLike+"("+Kt+".constant))))",'invalid dynamic attribute "'+Un+'"')});var Kr={isStream:Hn.def(!1)},hi=new pr;hi.state=wi,Object.keys(hi).forEach(function(qo){Kr[qo]=Hn.def(""+hi[qo])});var Ro=Kr.buffer,Ui=Kr.type;Hn("if(",zr,"(",Kt,")){",Kr.isStream,"=true;",Ro,"=",mi,".createStream(",Sp,",",Kt,");",Ui,"=",Ro,".dtype;","}else{",Ro,"=",mi,".getBuffer(",Kt,");","if(",Ro,"){",Ui,"=",Ro,".dtype;",'}else if("constant" in ',Kt,"){",Kr.state,"=",Hi,";","if(typeof "+Kt+'.constant === "number"){',Kr[ri[0]],"=",Kt,".constant;",ri.slice(1).map(function(qo){return Kr[qo]}).join("="),"=0;","}else{",ri.map(function(qo,ia){return Kr[qo]+"="+Kt+".constant.length>"+ia+"?"+Kt+".constant["+ia+"]:0;"}).join(""),"}}else{","if(",zr,"(",Kt,".buffer)){",Ro,"=",mi,".createStream(",Sp,",",Kt,".buffer);","}else{",Ro,"=",mi,".getBuffer(",Kt,".buffer);","}",Ui,'="type" in ',Kt,"?",Dr.glTypes,"[",Kt,".type]:",Ro,".dtype;",Kr.normalized,"=!!",Kt,".normalized;");function xo(qo){Hn(Kr[qo],"=",Kt,".",qo,"|0;")}return xo("size"),xo("offset"),xo("stride"),xo("divisor"),Hn("}}"),Hn.exit("if(",Kr.isStream,"){",mi,".destroyStream(",Ro,");","}"),Kr}xr[Un]=Zu(Kn,ir)}),xr}function dl(Lt,nn){var Mn=Lt.static,Ar=Lt.dynamic;if(lf in Mn){var xr=Mn[lf];return xr!==null&&Fi.getVAO(xr)===null&&(xr=Fi.createVAO(xr)),pc(function(Kn){return Kn.link(Fi.getVAO(xr))})}else if(lf in Ar){var Un=Ar[lf];return Zu(Un,function(Kn,ir){var yn=Kn.invoke(ir,Un);return ir.def(Kn.shared.vao+".getVAO("+yn+")")})}return null}function el(Lt){var nn=Lt.static,Mn=Lt.dynamic,Ar={};return Object.keys(nn).forEach(function(xr){var Un=nn[xr];Ar[xr]=pc(function(Kn,ir){return typeof Un=="number"||typeof Un=="boolean"?""+Un:Kn.link(Un)})}),Object.keys(Mn).forEach(function(xr){var Un=Mn[xr];Ar[xr]=Zu(Un,function(Kn,ir){return Kn.invoke(ir,Un)})}),Ar}function Yl(Lt,nn,Mn,Ar,xr){var Un=Lt.static,Kn=Lt.dynamic;de.optional(function(){var xo=[xs,Fl,Hu,No,kl,xf,Xl,Zd,ba,lf].concat(xi);function qo(ia){Object.keys(ia).forEach(function(As){de.command(xo.indexOf(As)>=0,'unknown parameter "'+As+'"',xr.commandStr)})}qo(Un),qo(Kn)});var ir=da(Lt,nn),yn=co(Lt,xr),Hn=Da(Lt,yn,xr),Kt=vs(Lt,xr),Yn=_l(Lt,xr),Dr=Jo(Lt,xr,ir);function zr(xo){var qo=Hn[xo];qo&&(Yn[xo]=qo)}zr(hl),zr(Yi(Ai));var mi=Object.keys(Yn).length>0,Kr={framebuffer:yn,draw:Kt,shader:Dr,state:Yn,dirty:mi,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Kr.profile=Ua(Lt,xr),Kr.uniforms=$c(Mn,xr),Kr.drawVAO=Kr.scopeVAO=dl(Lt,xr),!Kr.drawVAO&&Dr.program&&!ir&&On.angle_instanced_arrays){var hi=!0,Ro=Dr.program.attributes.map(function(xo){var qo=nn.static[xo];return hi=hi&&!!qo,qo});if(hi&&Ro.length>0){var Ui=Fi.getVAO(Fi.createVAO(Ro));Kr.drawVAO=new _u(null,null,null,function(xo,qo){return xo.link(Ui)}),Kr.useVAO=!0}}return ir?Kr.useVAO=!0:Kr.attributes=Ga(nn,xr),Kr.context=el(Ar,xr),Kr}function zl(Lt,nn,Mn){var Ar=Lt.shared,xr=Ar.context,Un=Lt.scope();Object.keys(Mn).forEach(function(Kn){nn.save(xr,"."+Kn);var ir=Mn[Kn];Un(xr,".",Kn,"=",ir.append(Lt,nn),";")}),nn(Un)}function as(Lt,nn,Mn,Ar){var xr=Lt.shared,Un=xr.gl,Kn=xr.framebuffer,ir;eo&&(ir=nn.def(xr.extensions,".webgl_draw_buffers"));var yn=Lt.constants,Hn=yn.drawBuffer,Kt=yn.backBuffer,Yn;Mn?Yn=Mn.append(Lt,nn):Yn=nn.def(Kn,".next"),Ar||nn("if(",Yn,"!==",Kn,".cur){"),nn("if(",Yn,"){",Un,".bindFramebuffer(",Jh,",",Yn,".framebuffer);"),eo&&nn(ir,".drawBuffersWEBGL(",Hn,"[",Yn,".colorAttachments.length]);"),nn("}else{",Un,".bindFramebuffer(",Jh,",null);"),eo&&nn(ir,".drawBuffersWEBGL(",Kt,");"),nn("}",Kn,".cur=",Yn,";"),Ar||nn("}")}function $l(Lt,nn,Mn){var Ar=Lt.shared,xr=Ar.gl,Un=Lt.current,Kn=Lt.next,ir=Ar.current,yn=Ar.next,Hn=Lt.cond(ir,".dirty");xi.forEach(function(Kt){var Yn=Yi(Kt);if(!(Yn in Mn.state)){var Dr,zr;if(Yn in Kn){Dr=Kn[Yn],zr=Un[Yn];var mi=Jn(ii[Yn].length,function(hi){return Hn.def(Dr,"[",hi,"]")});Hn(Lt.cond(mi.map(function(hi,Ro){return hi+"!=="+zr+"["+Ro+"]"}).join("||")).then(xr,".",si[Yn],"(",mi,");",mi.map(function(hi,Ro){return zr+"["+Ro+"]="+hi}).join(";"),";"))}else{Dr=Hn.def(yn,".",Yn);var Kr=Lt.cond(Dr,"!==",ir,".",Yn);Hn(Kr),Yn in to?Kr(Lt.cond(Dr).then(xr,".enable(",to[Yn],");").else(xr,".disable(",to[Yn],");"),ir,".",Yn,"=",Dr,";"):Kr(xr,".",si[Yn],"(",Dr,");",ir,".",Yn,"=",Dr,";")}}}),Object.keys(Mn.state).length===0&&Hn(ir,".dirty=false;"),nn(Hn)}function ec(Lt,nn,Mn,Ar){var xr=Lt.shared,Un=Lt.current,Kn=xr.current,ir=xr.gl;Mp(Object.keys(Mn)).forEach(function(yn){var Hn=Mn[yn];if(!(Ar&&!Ar(Hn))){var Kt=Hn.append(Lt,nn);if(to[yn]){var Yn=to[yn];lu(Hn)?Kt?nn(ir,".enable(",Yn,");"):nn(ir,".disable(",Yn,");"):nn(Lt.cond(Kt).then(ir,".enable(",Yn,");").else(ir,".disable(",Yn,");")),nn(Kn,".",yn,"=",Kt,";")}else if(ol(Kt)){var Dr=Un[yn];nn(ir,".",si[yn],"(",Kt,");",Kt.map(function(zr,mi){return Dr+"["+mi+"]="+zr}).join(";"),";")}else nn(ir,".",si[yn],"(",Kt,");",Kn,".",yn,"=",Kt,";")}})}function mc(Lt,nn){yi&&(Lt.instancing=nn.def(Lt.shared.extensions,".angle_instanced_arrays"))}function Ra(Lt,nn,Mn,Ar,xr){var Un=Lt.shared,Kn=Lt.stats,ir=Un.current,yn=Un.timer,Hn=Mn.profile;function Kt(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Yn,Dr;function zr(xo){Yn=nn.def(),xo(Yn,"=",Kt(),";"),typeof xr=="string"?xo(Kn,".count+=",xr,";"):xo(Kn,".count++;"),pi&&(Ar?(Dr=nn.def(),xo(Dr,"=",yn,".getNumPendingQueries();")):xo(yn,".beginQuery(",Kn,");"))}function mi(xo){xo(Kn,".cpuTime+=",Kt(),"-",Yn,";"),pi&&(Ar?xo(yn,".pushScopeStats(",Dr,",",yn,".getNumPendingQueries(),",Kn,");"):xo(yn,".endQuery();"))}function Kr(xo){var qo=nn.def(ir,".profile");nn(ir,".profile=",xo,";"),nn.exit(ir,".profile=",qo,";")}var hi;if(Hn){if(lu(Hn)){Hn.enable?(zr(nn),mi(nn.exit),Kr("true")):Kr("false");return}hi=Hn.append(Lt,nn),Kr(hi)}else hi=nn.def(ir,".profile");var Ro=Lt.block();zr(Ro),nn("if(",hi,"){",Ro,"}");var Ui=Lt.block();mi(Ui),nn.exit("if(",hi,"){",Ui,"}")}function Kc(Lt,nn,Mn,Ar,xr){var Un=Lt.shared;function Kn(yn){switch(yn){case nv:case Ap:case Gd:return 2;case qh:case Js:case Cp:return 3;case B0:case Ef:case dc:return 4;default:return 1}}function ir(yn,Hn,Kt){var Yn=Un.gl,Dr=nn.def(yn,".location"),zr=nn.def(Un.attributes,"[",Dr,"]"),mi=Kt.state,Kr=Kt.buffer,hi=[Kt.x,Kt.y,Kt.z,Kt.w],Ro=["buffer","normalized","offset","stride"];function Ui(){nn("if(!",zr,".buffer){",Yn,".enableVertexAttribArray(",Dr,");}");var qo=Kt.type,ia;if(Kt.size?ia=nn.def(Kt.size,"||",Hn):ia=Hn,nn("if(",zr,".type!==",qo,"||",zr,".size!==",ia,"||",Ro.map(function(Sc){return zr+"."+Sc+"!=="+Kt[Sc]}).join("||"),"){",Yn,".bindBuffer(",Sp,",",Kr,".buffer);",Yn,".vertexAttribPointer(",[Dr,ia,qo,Kt.normalized,Kt.stride,Kt.offset],");",zr,".type=",qo,";",zr,".size=",ia,";",Ro.map(function(Sc){return zr+"."+Sc+"="+Kt[Sc]+";"}).join(""),"}"),yi){var As=Kt.divisor;nn("if(",zr,".divisor!==",As,"){",Lt.instancing,".vertexAttribDivisorANGLE(",[Dr,As],");",zr,".divisor=",As,";}")}}function xo(){nn("if(",zr,".buffer){",Yn,".disableVertexAttribArray(",Dr,");",zr,".buffer=null;","}if(",ri.map(function(qo,ia){return zr+"."+qo+"!=="+hi[ia]}).join("||"),"){",Yn,".vertexAttrib4f(",Dr,",",hi,");",ri.map(function(qo,ia){return zr+"."+qo+"="+hi[ia]+";"}).join(""),"}")}mi===wi?Ui():mi===Hi?xo():(nn("if(",mi,"===",wi,"){"),Ui(),nn("}else{"),xo(),nn("}"))}Ar.forEach(function(yn){var Hn=yn.name,Kt=Mn.attributes[Hn],Yn;if(Kt){if(!xr(Kt))return;Yn=Kt.append(Lt,nn)}else{if(!xr(bu))return;var Dr=Lt.scopeAttrib(Hn);de.optional(function(){Lt.assert(nn,Dr+".state","missing attribute "+Hn)}),Yn={},Object.keys(new pr).forEach(function(zr){Yn[zr]=nn.def(Dr,".",zr)})}ir(Lt.link(yn),Kn(yn.info.type),Yn)})}function Rs(Lt,nn,Mn,Ar,xr){for(var Un=Lt.shared,Kn=Un.gl,ir,yn=0;yn<Ar.length;++yn){var Hn=Ar[yn],Kt=Hn.name,Yn=Hn.info.type,Dr=Mn.uniforms[Kt],zr=Lt.link(Hn),mi=zr+".location",Kr;if(Dr){if(!xr(Dr))continue;if(lu(Dr)){var hi=Dr.value;if(de.command(hi!==null&&typeof hi!="undefined",'missing uniform "'+Kt+'"',Lt.commandStr),Yn===Op||Yn===n0){de.command(typeof hi=="function"&&(Yn===Op&&(hi._reglType==="texture2d"||hi._reglType==="framebuffer")||Yn===n0&&(hi._reglType==="textureCube"||hi._reglType==="framebufferCube")),"invalid texture for uniform "+Kt,Lt.commandStr);var Ro=Lt.link(hi._texture||hi.color[0]._texture);nn(Kn,".uniform1i(",mi,",",Ro+".bind());"),nn.exit(Ro,".unbind();")}else if(Yn===Xd||Yn===Qh||Yn===yl){de.optional(function(){de.command(ol(hi),"invalid matrix for uniform "+Kt,Lt.commandStr),de.command(Yn===Xd&&hi.length===4||Yn===Qh&&hi.length===9||Yn===yl&&hi.length===16,"invalid length for matrix uniform "+Kt,Lt.commandStr)});var Ui=Lt.global.def("new Float32Array(["+Array.prototype.slice.call(hi)+"])"),xo=2;Yn===Qh?xo=3:Yn===yl&&(xo=4),nn(Kn,".uniformMatrix",xo,"fv(",mi,",false,",Ui,");")}else{switch(Yn){case Kh:de.commandType(hi,"number","uniform "+Kt,Lt.commandStr),ir="1f";break;case nv:de.command(ol(hi)&&hi.length===2,"uniform "+Kt,Lt.commandStr),ir="2f";break;case qh:de.command(ol(hi)&&hi.length===3,"uniform "+Kt,Lt.commandStr),ir="3f";break;case B0:de.command(ol(hi)&&hi.length===4,"uniform "+Kt,Lt.commandStr),ir="4f";break;case F0:de.commandType(hi,"boolean","uniform "+Kt,Lt.commandStr),ir="1i";break;case Yc:de.commandType(hi,"number","uniform "+Kt,Lt.commandStr),ir="1i";break;case Gd:de.command(ol(hi)&&hi.length===2,"uniform "+Kt,Lt.commandStr),ir="2i";break;case Ap:de.command(ol(hi)&&hi.length===2,"uniform "+Kt,Lt.commandStr),ir="2i";break;case Cp:de.command(ol(hi)&&hi.length===3,"uniform "+Kt,Lt.commandStr),ir="3i";break;case Js:de.command(ol(hi)&&hi.length===3,"uniform "+Kt,Lt.commandStr),ir="3i";break;case dc:de.command(ol(hi)&&hi.length===4,"uniform "+Kt,Lt.commandStr),ir="4i";break;case Ef:de.command(ol(hi)&&hi.length===4,"uniform "+Kt,Lt.commandStr),ir="4i";break}nn(Kn,".uniform",ir,"(",mi,",",ol(hi)?Array.prototype.slice.call(hi):hi,");")}continue}else Kr=Dr.append(Lt,nn)}else{if(!xr(bu))continue;Kr=nn.def(Un.uniforms,"[",Qt.id(Kt),"]")}Yn===Op?nn("if(",Kr,"&&",Kr,'._reglType==="framebuffer"){',Kr,"=",Kr,".color[0];","}"):Yn===n0&&nn("if(",Kr,"&&",Kr,'._reglType==="framebufferCube"){',Kr,"=",Kr,".color[0];","}"),de.optional(function(){function xu(Od,Kd){Lt.assert(nn,Od,'bad data or missing for uniform "'+Kt+'".  '+Kd)}function mm(Od){xu("typeof "+Kr+'==="'+Od+'"',"invalid type, expected "+Od)}function uf(Od,Kd){xu(Un.isArrayLike+"("+Kr+")&&"+Kr+".length==="+Od,"invalid vector, should have length "+Od,Lt.commandStr)}function qv(Od){xu("typeof "+Kr+'==="function"&&'+Kr+'._reglType==="texture'+(Od===cm?"2d":"Cube")+'"',"invalid texture type",Lt.commandStr)}switch(Yn){case Yc:mm("number");break;case Ap:uf(2,"number");break;case Js:uf(3,"number");break;case Ef:uf(4,"number");break;case Kh:mm("number");break;case nv:uf(2,"number");break;case qh:uf(3,"number");break;case B0:uf(4,"number");break;case F0:mm("boolean");break;case Gd:uf(2,"boolean");break;case Cp:uf(3,"boolean");break;case dc:uf(4,"boolean");break;case Xd:uf(4,"number");break;case Qh:uf(9,"number");break;case yl:uf(16,"number");break;case Op:qv(cm);break;case n0:qv(um);break}});var qo=1;switch(Yn){case Op:case n0:var ia=nn.def(Kr,"._texture");nn(Kn,".uniform1i(",mi,",",ia,".bind());"),nn.exit(ia,".unbind();");continue;case Yc:case F0:ir="1i";break;case Ap:case Gd:ir="2i",qo=2;break;case Js:case Cp:ir="3i",qo=3;break;case Ef:case dc:ir="4i",qo=4;break;case Kh:ir="1f";break;case nv:ir="2f",qo=2;break;case qh:ir="3f",qo=3;break;case B0:ir="4f",qo=4;break;case Xd:ir="Matrix2fv";break;case Qh:ir="Matrix3fv";break;case yl:ir="Matrix4fv";break}if(nn(Kn,".uniform",ir,"(",mi,","),ir.charAt(0)==="M"){var As=Math.pow(Yn-Xd+2,2),Sc=Lt.global.def("new Float32Array(",As,")");nn("false,(Array.isArray(",Kr,")||",Kr," instanceof Float32Array)?",Kr,":(",Jn(As,function(xu){return Sc+"["+xu+"]="+Kr+"["+xu+"]"}),",",Sc,")")}else qo>1?nn(Jn(qo,function(xu){return Kr+"["+xu+"]"})):nn(Kr);nn(");")}}function Zo(Lt,nn,Mn,Ar){var xr=Lt.shared,Un=xr.gl,Kn=xr.draw,ir=Ar.draw;function yn(){var ia=ir.elements,As,Sc=nn;return ia?((ia.contextDep&&Ar.contextDynamic||ia.propDep)&&(Sc=Mn),As=ia.append(Lt,Sc)):As=Sc.def(Kn,".",No),As&&Sc("if("+As+")"+Un+".bindBuffer("+ty+","+As+".buffer.buffer);"),As}function Hn(){var ia=ir.count,As,Sc=nn;return ia?((ia.contextDep&&Ar.contextDynamic||ia.propDep)&&(Sc=Mn),As=ia.append(Lt,Sc),de.optional(function(){ia.MISSING&&Lt.assert(nn,"false","missing vertex count"),ia.DYNAMIC&&Lt.assert(Sc,As+">=0","missing vertex count")})):(As=Sc.def(Kn,".",Xl),de.optional(function(){Lt.assert(Sc,As+">=0","missing vertex count")})),As}var Kt=yn();function Yn(ia){var As=ir[ia];return As?As.contextDep&&Ar.contextDynamic||As.propDep?As.append(Lt,Mn):As.append(Lt,nn):nn.def(Kn,".",ia)}var Dr=Yn(kl),zr=Yn(xf),mi=Hn();if(typeof mi=="number"){if(mi===0)return}else Mn("if(",mi,"){"),Mn.exit("}");var Kr,hi;yi&&(Kr=Yn(Zd),hi=Lt.instancing);var Ro=Kt+".type",Ui=ir.elements&&lu(ir.elements);function xo(){function ia(){Mn(hi,".drawElementsInstancedANGLE(",[Dr,mi,Ro,zr+"<<(("+Ro+"-"+Yr+")>>1)",Kr],");")}function As(){Mn(hi,".drawArraysInstancedANGLE(",[Dr,zr,mi,Kr],");")}Kt?Ui?ia():(Mn("if(",Kt,"){"),ia(),Mn("}else{"),As(),Mn("}")):As()}function qo(){function ia(){Mn(Un+".drawElements("+[Dr,mi,Ro,zr+"<<(("+Ro+"-"+Yr+")>>1)"]+");")}function As(){Mn(Un+".drawArrays("+[Dr,zr,mi]+");")}Kt?Ui?ia():(Mn("if(",Kt,"){"),ia(),Mn("}else{"),As(),Mn("}")):As()}yi&&(typeof Kr!="number"||Kr>=0)?typeof Kr=="string"?(Mn("if(",Kr,">0){"),xo(),Mn("}else if(",Kr,"<0){"),qo(),Mn("}")):xo():qo()}function Ta(Lt,nn,Mn,Ar,xr){var Un=zo(),Kn=Un.proc("body",xr);return de.optional(function(){Un.commandStr=nn.commandStr,Un.command=Un.link(nn.commandStr)}),yi&&(Un.instancing=Kn.def(Un.shared.extensions,".angle_instanced_arrays")),Lt(Un,Kn,Mn,Ar),Un.compile().body}function Za(Lt,nn,Mn,Ar){mc(Lt,nn),Mn.useVAO?Mn.drawVAO?nn(Lt.shared.vao,".setVAO(",Mn.drawVAO.append(Lt,nn),");"):nn(Lt.shared.vao,".setVAO(",Lt.shared.vao,".targetVAO);"):(nn(Lt.shared.vao,".setVAO(null);"),Kc(Lt,nn,Mn,Ar.attributes,function(){return!0})),Rs(Lt,nn,Mn,Ar.uniforms,function(){return!0}),Zo(Lt,nn,nn,Mn)}function Kl(Lt,nn){var Mn=Lt.proc("draw",1);mc(Lt,Mn),zl(Lt,Mn,nn.context),as(Lt,Mn,nn.framebuffer),$l(Lt,Mn,nn),ec(Lt,Mn,nn.state),Ra(Lt,Mn,nn,!1,!0);var Ar=nn.shader.progVar.append(Lt,Mn);if(Mn(Lt.shared.gl,".useProgram(",Ar,".program);"),nn.shader.program)Za(Lt,Mn,nn,nn.shader.program);else{Mn(Lt.shared.vao,".setVAO(null);");var xr=Lt.global.def("{}"),Un=Mn.def(Ar,".id"),Kn=Mn.def(xr,"[",Un,"]");Mn(Lt.cond(Kn).then(Kn,".call(this,a0);").else(Kn,"=",xr,"[",Un,"]=",Lt.link(function(ir){return Ta(Za,Lt,nn,ir,1)}),"(",Ar,");",Kn,".call(this,a0);"))}Object.keys(nn.state).length>0&&Mn(Lt.shared.current,".dirty=true;")}function ch(Lt,nn,Mn,Ar){Lt.batchId="a1",mc(Lt,nn);function xr(){return!0}Kc(Lt,nn,Mn,Ar.attributes,xr),Rs(Lt,nn,Mn,Ar.uniforms,xr),Zo(Lt,nn,nn,Mn)}function ln(Lt,nn,Mn,Ar){mc(Lt,nn);var xr=Mn.contextDep,Un=nn.def(),Kn="a0",ir="a1",yn=nn.def();Lt.shared.props=yn,Lt.batchId=Un;var Hn=Lt.scope(),Kt=Lt.scope();nn(Hn.entry,"for(",Un,"=0;",Un,"<",ir,";++",Un,"){",yn,"=",Kn,"[",Un,"];",Kt,"}",Hn.exit);function Yn(Ro){return Ro.contextDep&&xr||Ro.propDep}function Dr(Ro){return!Yn(Ro)}if(Mn.needsContext&&zl(Lt,Kt,Mn.context),Mn.needsFramebuffer&&as(Lt,Kt,Mn.framebuffer),ec(Lt,Kt,Mn.state,Yn),Mn.profile&&Yn(Mn.profile)&&Ra(Lt,Kt,Mn,!1,!0),Ar)Mn.useVAO?Mn.drawVAO?Yn(Mn.drawVAO)?Kt(Lt.shared.vao,".setVAO(",Mn.drawVAO.append(Lt,Kt),");"):Hn(Lt.shared.vao,".setVAO(",Mn.drawVAO.append(Lt,Hn),");"):Hn(Lt.shared.vao,".setVAO(",Lt.shared.vao,".targetVAO);"):(Hn(Lt.shared.vao,".setVAO(null);"),Kc(Lt,Hn,Mn,Ar.attributes,Dr),Kc(Lt,Kt,Mn,Ar.attributes,Yn)),Rs(Lt,Hn,Mn,Ar.uniforms,Dr),Rs(Lt,Kt,Mn,Ar.uniforms,Yn),Zo(Lt,Hn,Kt,Mn);else{var zr=Lt.global.def("{}"),mi=Mn.shader.progVar.append(Lt,Kt),Kr=Kt.def(mi,".id"),hi=Kt.def(zr,"[",Kr,"]");Kt(Lt.shared.gl,".useProgram(",mi,".program);","if(!",hi,"){",hi,"=",zr,"[",Kr,"]=",Lt.link(function(Ro){return Ta(ch,Lt,Mn,Ro,2)}),"(",mi,");}",hi,".call(this,a0[",Un,"],",Un,");")}}function Pr(Lt,nn){var Mn=Lt.proc("batch",2);Lt.batchId="0",mc(Lt,Mn);var Ar=!1,xr=!0;Object.keys(nn.context).forEach(function(zr){Ar=Ar||nn.context[zr].propDep}),Ar||(zl(Lt,Mn,nn.context),xr=!1);var Un=nn.framebuffer,Kn=!1;Un?(Un.propDep?Ar=Kn=!0:Un.contextDep&&Ar&&(Kn=!0),Kn||as(Lt,Mn,Un)):as(Lt,Mn,null),nn.state.viewport&&nn.state.viewport.propDep&&(Ar=!0);function ir(zr){return zr.contextDep&&Ar||zr.propDep}$l(Lt,Mn,nn),ec(Lt,Mn,nn.state,function(zr){return!ir(zr)}),(!nn.profile||!ir(nn.profile))&&Ra(Lt,Mn,nn,!1,"a1"),nn.contextDep=Ar,nn.needsContext=xr,nn.needsFramebuffer=Kn;var yn=nn.shader.progVar;if(yn.contextDep&&Ar||yn.propDep)ln(Lt,Mn,nn,null);else{var Hn=yn.append(Lt,Mn);if(Mn(Lt.shared.gl,".useProgram(",Hn,".program);"),nn.shader.program)ln(Lt,Mn,nn,nn.shader.program);else{Mn(Lt.shared.vao,".setVAO(null);");var Kt=Lt.global.def("{}"),Yn=Mn.def(Hn,".id"),Dr=Mn.def(Kt,"[",Yn,"]");Mn(Lt.cond(Dr).then(Dr,".call(this,a0,a1);").else(Dr,"=",Kt,"[",Yn,"]=",Lt.link(function(zr){return Ta(ln,Lt,nn,zr,2)}),"(",Hn,");",Dr,".call(this,a0,a1);"))}}Object.keys(nn.state).length>0&&Mn(Lt.shared.current,".dirty=true;")}function Er(Lt,nn){var Mn=Lt.proc("scope",3);Lt.batchId="a2";var Ar=Lt.shared,xr=Ar.current;zl(Lt,Mn,nn.context),nn.framebuffer&&nn.framebuffer.append(Lt,Mn),Mp(Object.keys(nn.state)).forEach(function(Kn){var ir=nn.state[Kn],yn=ir.append(Lt,Mn);ol(yn)?yn.forEach(function(Hn,Kt){Mn.set(Lt.next[Kn],"["+Kt+"]",Hn)}):Mn.set(Ar.next,"."+Kn,yn)}),Ra(Lt,Mn,nn,!0,!0),[No,xf,Xl,Zd,kl].forEach(function(Kn){var ir=nn.draw[Kn];ir&&Mn.set(Ar.draw,"."+Kn,""+ir.append(Lt,Mn))}),Object.keys(nn.uniforms).forEach(function(Kn){Mn.set(Ar.uniforms,"["+Qt.id(Kn)+"]",nn.uniforms[Kn].append(Lt,Mn))}),Object.keys(nn.attributes).forEach(function(Kn){var ir=nn.attributes[Kn].append(Lt,Mn),yn=Lt.scopeAttrib(Kn);Object.keys(new pr).forEach(function(Hn){Mn.set(yn,"."+Hn,ir[Hn])})}),nn.scopeVAO&&Mn.set(Ar.vao,".targetVAO",nn.scopeVAO.append(Lt,Mn));function Un(Kn){var ir=nn.shader[Kn];ir&&Mn.set(Ar.shader,"."+Kn,ir.append(Lt,Mn))}Un(Fl),Un(Hu),Object.keys(nn.state).length>0&&(Mn(xr,".dirty=true;"),Mn.exit(xr,".dirty=true;")),Mn("a1(",Lt.shared.context,",a0,",Lt.batchId,");")}function no(Lt){if(!(typeof Lt!="object"||ol(Lt))){for(var nn=Object.keys(Lt),Mn=0;Mn<nn.length;++Mn)if(An.isDynamic(Lt[nn[Mn]]))return!0;return!1}}function Na(Lt,nn,Mn){var Ar=nn.static[Mn];if(!Ar||!no(Ar))return;var xr=Lt.global,Un=Object.keys(Ar),Kn=!1,ir=!1,yn=!1,Hn=Lt.global.def("{}");Un.forEach(function(Yn){var Dr=Ar[Yn];if(An.isDynamic(Dr)){typeof Dr=="function"&&(Dr=Ar[Yn]=An.unbox(Dr));var zr=Zu(Dr,null);Kn=Kn||zr.thisDep,yn=yn||zr.propDep,ir=ir||zr.contextDep}else{switch(xr(Hn,".",Yn,"="),typeof Dr){case"number":xr(Dr);break;case"string":xr('"',Dr,'"');break;case"object":Array.isArray(Dr)&&xr("[",Dr.join(),"]");break;default:xr(Lt.link(Dr));break}xr(";")}});function Kt(Yn,Dr){Un.forEach(function(zr){var mi=Ar[zr];if(An.isDynamic(mi)){var Kr=Yn.invoke(Dr,mi);Dr(Hn,".",zr,"=",Kr,";")}})}nn.dynamic[Mn]=new An.DynamicVariable(Bn,{thisDep:Kn,contextDep:ir,propDep:yn,ref:Hn,append:Kt}),delete nn.static[Mn]}function Es(Lt,nn,Mn,Ar,xr){var Un=zo();Un.stats=Un.link(xr),Object.keys(nn.static).forEach(function(ir){Na(Un,nn,ir)}),lm.forEach(function(ir){Na(Un,Lt,ir)});var Kn=Yl(Lt,nn,Mn,Ar,Un);return Kl(Un,Kn),Er(Un,Kn),Pr(Un,Kn),Un.compile()}return{next:oo,current:ii,procs:function(){var Lt=zo(),nn=Lt.proc("poll"),Mn=Lt.proc("refresh"),Ar=Lt.block();nn(Ar),Mn(Ar);var xr=Lt.shared,Un=xr.gl,Kn=xr.next,ir=xr.current;Ar(ir,".dirty=false;"),as(Lt,nn),as(Lt,Mn,null,!0);var yn;yi&&(yn=Lt.link(yi)),On.oes_vertex_array_object&&Mn(Lt.link(On.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Hn=0;Hn<Or.maxAttributes;++Hn){var Kt=Mn.def(xr.attributes,"[",Hn,"]"),Yn=Lt.cond(Kt,".buffer");Yn.then(Un,".enableVertexAttribArray(",Hn,");",Un,".bindBuffer(",Sp,",",Kt,".buffer.buffer);",Un,".vertexAttribPointer(",Hn,",",Kt,".size,",Kt,".type,",Kt,".normalized,",Kt,".stride,",Kt,".offset);").else(Un,".disableVertexAttribArray(",Hn,");",Un,".vertexAttrib4f(",Hn,",",Kt,".x,",Kt,".y,",Kt,".z,",Kt,".w);",Kt,".buffer=null;"),Mn(Yn),yi&&Mn(yn,".vertexAttribDivisorANGLE(",Hn,",",Kt,".divisor);")}return Mn(Lt.shared.vao,".currentVAO=null;",Lt.shared.vao,".setVAO(",Lt.shared.vao,".targetVAO);"),Object.keys(to).forEach(function(Dr){var zr=to[Dr],mi=Ar.def(Kn,".",Dr),Kr=Lt.block();Kr("if(",mi,"){",Un,".enable(",zr,")}else{",Un,".disable(",zr,")}",ir,".",Dr,"=",mi,";"),Mn(Kr),nn("if(",mi,"!==",ir,".",Dr,"){",Kr,"}")}),Object.keys(si).forEach(function(Dr){var zr=si[Dr],mi=ii[Dr],Kr,hi,Ro=Lt.block();if(Ro(Un,".",zr,"("),ol(mi)){var Ui=mi.length;Kr=Lt.global.def(Kn,".",Dr),hi=Lt.global.def(ir,".",Dr),Ro(Jn(Ui,function(xo){return Kr+"["+xo+"]"}),");",Jn(Ui,function(xo){return hi+"["+xo+"]="+Kr+"["+xo+"];"}).join("")),nn("if(",Jn(Ui,function(xo){return Kr+"["+xo+"]!=="+hi+"["+xo+"]"}).join("||"),"){",Ro,"}")}else Kr=Ar.def(Kn,".",Dr),hi=Ar.def(ir,".",Dr),Ro(Kr,");",ir,".",Dr,"=",Kr,";"),nn("if(",Kr,"!==",hi,"){",Ro,"}");Mn(Ro)}),Lt.compile()}(),compile:Es}}function dm(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var A1=34918,Xv=34919,z0=35007,U0=function(Fe,Qt){if(!Qt.ext_disjoint_timer_query)return null;var On=[];function Or(){return On.pop()||Qt.ext_disjoint_timer_query.createQueryEXT()}function Wr(yi){On.push(yi)}var Rr=[];function _r(yi){var eo=Or();Qt.ext_disjoint_timer_query.beginQueryEXT(z0,eo),Rr.push(eo),pi(Rr.length-1,Rr.length,yi)}function Ti(){Qt.ext_disjoint_timer_query.endQueryEXT(z0)}function li(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Fi=[];function Ri(){return Fi.pop()||new li}function Di(yi){Fi.push(yi)}var Xi=[];function pi(yi,eo,ii){var oo=Ri();oo.startQueryIndex=yi,oo.endQueryIndex=eo,oo.sum=0,oo.stats=ii,Xi.push(oo)}var Ni=[],pr=[];function Lr(){var yi,eo,ii=Rr.length;if(ii!==0){pr.length=Math.max(pr.length,ii+1),Ni.length=Math.max(Ni.length,ii+1),Ni[0]=0,pr[0]=0;var oo=0;for(yi=0,eo=0;eo<Rr.length;++eo){var xi=Rr[eo];Qt.ext_disjoint_timer_query.getQueryObjectEXT(xi,Xv)?(oo+=Qt.ext_disjoint_timer_query.getQueryObjectEXT(xi,A1),Wr(xi)):Rr[yi++]=xi,Ni[eo+1]=oo,pr[eo+1]=yi}for(Rr.length=yi,yi=0,eo=0;eo<Xi.length;++eo){var to=Xi[eo],si=to.startQueryIndex,Yi=to.endQueryIndex;to.sum+=Ni[Yi]-Ni[si];var Bo=pr[si],ha=pr[Yi];ha===Bo?(to.stats.gpuTime+=to.sum/1e6,Di(to)):(to.startQueryIndex=Bo,to.endQueryIndex=ha,Xi[yi++]=to)}Xi.length=yi}}return{beginQuery:_r,endQuery:Ti,pushScopeStats:pi,update:Lr,getNumPendingQueries:function(){return Rr.length},clear:function(){On.push.apply(On,Rr);for(var yi=0;yi<On.length;yi++)Qt.ext_disjoint_timer_query.deleteQueryEXT(On[yi]);Rr.length=0,On.length=0},restore:function(){Rr.length=0,On.length=0}}},ov=16384,cu=256,pm=1024,Cl=34962,Wu="webglcontextlost",Ah="webglcontextrestored",Ch=1,av=2,Yv=3;function $v(Fe,Qt){for(var On=0;On<Fe.length;++On)if(Fe[On]===Qt)return On;return-1}function Kv(Fe){var Qt=Qn(Fe);if(!Qt)return null;var On=Qt.gl,Or=On.getContextAttributes(),Wr=On.isContextLost(),Rr=br(On,Qt);if(!Rr)return null;var _r=dt(),Ti=dm(),li=Rr.extensions,Fi=U0(On,li),Ri=Xn(),Di=On.drawingBufferWidth,Xi=On.drawingBufferHeight,pi={tick:0,time:0,viewportWidth:Di,viewportHeight:Xi,framebufferWidth:Di,framebufferHeight:Xi,drawingBufferWidth:Di,drawingBufferHeight:Xi,pixelRatio:Qt.pixelRatio},Ni={},pr={elements:null,primitive:4,count:-1,offset:0,instances:-1},Lr=Wa(On,li),yi=mh(On,Ti,Qt,ii),eo=Xe(On,li,Lr,Ti,yi);function ii(Zo){return eo.destroyBuffer(Zo)}var oo=Kf(On,li,yi,Ti),xi=pn(On,_r,Ti,Qt),to=vu(On,li,Lr,function(){Bo.procs.poll()},pi,Ti,Qt),si=rh(On,li,Lr,Ti,Qt),Yi=G(On,li,Lr,to,si,Ti),Bo=Pp(On,_r,li,Lr,yi,oo,to,Yi,Ni,eo,xi,pr,pi,Fi,Qt),ha=ur(On,Yi,Bo.procs.poll,pi,Or,li,Lr),Ki=Bo.next,Ei=On.canvas,$r=[],zo=[],Ua=[],co=[Qt.onDestroy],Da=null;function da(){if($r.length===0){Fi&&Fi.update(),Da=null;return}Da=Pn.next(da),ec();for(var Zo=$r.length-1;Zo>=0;--Zo){var Ta=$r[Zo];Ta&&Ta(pi,null,0)}On.flush(),Fi&&Fi.update()}function Jo(){!Da&&$r.length>0&&(Da=Pn.next(da))}function vs(){Da&&(Pn.cancel(da),Da=null)}function _l(Zo){Zo.preventDefault(),Wr=!0,vs(),zo.forEach(function(Ta){Ta()})}function $c(Zo){On.getError(),Wr=!1,Rr.restore(),xi.restore(),yi.restore(),to.restore(),si.restore(),Yi.restore(),eo.restore(),Fi&&Fi.restore(),Bo.procs.refresh(),Jo(),Ua.forEach(function(Ta){Ta()})}Ei&&(Ei.addEventListener(Wu,_l,!1),Ei.addEventListener(Ah,$c,!1));function Ga(){$r.length=0,vs(),Ei&&(Ei.removeEventListener(Wu,_l),Ei.removeEventListener(Ah,$c)),xi.clear(),Yi.clear(),si.clear(),to.clear(),oo.clear(),yi.clear(),eo.clear(),Fi&&Fi.clear(),co.forEach(function(Zo){Zo()})}function dl(Zo){de(!!Zo,"invalid args to regl({...})"),de.type(Zo,"object","invalid args to regl({...})");function Ta(xr){var Un=D({},xr);delete Un.uniforms,delete Un.attributes,delete Un.context,delete Un.vao,"stencil"in Un&&Un.stencil.op&&(Un.stencil.opBack=Un.stencil.opFront=Un.stencil.op,delete Un.stencil.op);function Kn(ir){if(ir in Un){var yn=Un[ir];delete Un[ir],Object.keys(yn).forEach(function(Hn){Un[ir+"."+Hn]=yn[Hn]})}}return Kn("blend"),Kn("depth"),Kn("cull"),Kn("stencil"),Kn("polygonOffset"),Kn("scissor"),Kn("sample"),"vao"in xr&&(Un.vao=xr.vao),Un}function Za(xr){var Un={},Kn={};return Object.keys(xr).forEach(function(ir){var yn=xr[ir];An.isDynamic(yn)?Kn[ir]=An.unbox(yn,ir):Un[ir]=yn}),{dynamic:Kn,static:Un}}var Kl=Za(Zo.context||{}),ch=Za(Zo.uniforms||{}),ln=Za(Zo.attributes||{}),Pr=Za(Ta(Zo)),Er={gpuTime:0,cpuTime:0,count:0},no=Bo.compile(Pr,ln,ch,Kl,Er),Na=no.draw,Es=no.batch,Lt=no.scope,nn=[];function Mn(xr){for(;nn.length<xr;)nn.push(null);return nn}function Ar(xr,Un){var Kn;if(Wr&&de.raise("context lost"),typeof xr=="function")return Lt.call(this,null,xr,0);if(typeof Un=="function")if(typeof xr=="number")for(Kn=0;Kn<xr;++Kn)Lt.call(this,null,Un,Kn);else if(Array.isArray(xr))for(Kn=0;Kn<xr.length;++Kn)Lt.call(this,xr[Kn],Un,Kn);else return Lt.call(this,xr,Un,0);else if(typeof xr=="number"){if(xr>0)return Es.call(this,Mn(xr|0),xr|0)}else if(Array.isArray(xr)){if(xr.length)return Es.call(this,xr,xr.length)}else return Na.call(this,xr)}return D(Ar,{stats:Er})}var el=Yi.setFBO=dl({framebuffer:An.define.call(null,Ch,"framebuffer")});function Yl(Zo,Ta){var Za=0;Bo.procs.poll();var Kl=Ta.color;Kl&&(On.clearColor(+Kl[0]||0,+Kl[1]||0,+Kl[2]||0,+Kl[3]||0),Za|=ov),"depth"in Ta&&(On.clearDepth(+Ta.depth),Za|=cu),"stencil"in Ta&&(On.clearStencil(Ta.stencil|0),Za|=pm),de(!!Za,"called regl.clear with no buffer specified"),On.clear(Za)}function zl(Zo){if(de(typeof Zo=="object"&&Zo,"regl.clear() takes an object as input"),"framebuffer"in Zo)if(Zo.framebuffer&&Zo.framebuffer_reglType==="framebufferCube")for(var Ta=0;Ta<6;++Ta)el(D({framebuffer:Zo.framebuffer.faces[Ta]},Zo),Yl);else el(Zo,Yl);else Yl(null,Zo)}function as(Zo){de.type(Zo,"function","regl.frame() callback must be a function"),$r.push(Zo);function Ta(){var Za=$v($r,Zo);de(Za>=0,"cannot cancel a frame twice");function Kl(){var ch=$v($r,Kl);$r[ch]=$r[$r.length-1],$r.length-=1,$r.length<=0&&vs()}$r[Za]=Kl}return Jo(),{cancel:Ta}}function $l(){var Zo=Ki.viewport,Ta=Ki.scissor_box;Zo[0]=Zo[1]=Ta[0]=Ta[1]=0,pi.viewportWidth=pi.framebufferWidth=pi.drawingBufferWidth=Zo[2]=Ta[2]=On.drawingBufferWidth,pi.viewportHeight=pi.framebufferHeight=pi.drawingBufferHeight=Zo[3]=Ta[3]=On.drawingBufferHeight}function ec(){pi.tick+=1,pi.time=Ra(),$l(),Bo.procs.poll()}function mc(){$l(),Bo.procs.refresh(),Fi&&Fi.update()}function Ra(){return(Xn()-Ri)/1e3}mc();function Kc(Zo,Ta){de.type(Ta,"function","listener callback must be a function");var Za;switch(Zo){case"frame":return as(Ta);case"lost":Za=zo;break;case"restore":Za=Ua;break;case"destroy":Za=co;break;default:de.raise("invalid event, must be one of frame,lost,restore,destroy")}return Za.push(Ta),{cancel:function(){for(var Kl=0;Kl<Za.length;++Kl)if(Za[Kl]===Ta){Za[Kl]=Za[Za.length-1],Za.pop();return}}}}var Rs=D(dl,{clear:zl,prop:An.define.bind(null,Ch),context:An.define.bind(null,av),this:An.define.bind(null,Yv),draw:dl({}),buffer:function(Zo){return yi.create(Zo,Cl,!1,!1)},elements:function(Zo){return oo.create(Zo,!1)},texture:to.create2D,cube:to.createCube,renderbuffer:si.create,framebuffer:Yi.create,framebufferCube:Yi.createCube,vao:eo.createVAO,attributes:Or,frame:as,on:Kc,limits:Lr,hasExtension:function(Zo){return Lr.extensions.indexOf(Zo.toLowerCase())>=0},read:ha,destroy:Ga,_gl:On,_refresh:mc,poll:function(){ec(),Fi&&Fi.update()},now:Ra,stats:Ti});return Qt.onDone(null,Rs),Rs}return Kv})},86851:function($t,W,D){"use strict";var ee=D(89594),X=Array.prototype.concat,E=Array.prototype.slice,ve=$t.exports=function(fe){for(var ae=[],Ee=0,oe=fe.length;Ee<oe;Ee++){var ze=fe[Ee];ee(ze)?ae=X.call(ae,E.call(ze)):ae.push(ze)}return ae};ve.wrap=function(re){return function(){return re(ve(arguments))}}},89594:function($t){$t.exports=function(D){return!D||typeof D=="string"?!1:D instanceof Array||Array.isArray(D)||D.length>=0&&(D.splice instanceof Function||Object.getOwnPropertyDescriptor(D,D.length-1)&&D.constructor.name!=="String")}},69848:function($t){(function(W,D){$t.exports=D()})(this,function(){"use strict";function W(Be,Re,bt,yt,At,bn){if(!(At-yt<=bt)){var He=yt+At>>1;D(Be,Re,He,yt,At,bn%2),W(Be,Re,bt,yt,He-1,bn+1),W(Be,Re,bt,He+1,At,bn+1)}}function D(Be,Re,bt,yt,At,bn){for(;At>yt;){if(At-yt>600){var He=At-yt+1,Rt=bt-yt+1,Oe=Math.log(He),it=.5*Math.exp(2*Oe/3),Qe=.5*Math.sqrt(Oe*it*(He-it)/He)*(Rt-He/2<0?-1:1),$e=Math.max(yt,Math.floor(bt-Rt*it/He+Qe)),Ot=Math.min(At,Math.floor(bt+(He-Rt)*it/He+Qe));D(Be,Re,bt,$e,Ot,bn)}var vt=Re[2*bt+bn],Me=yt,Xt=At;for(ee(Be,Re,yt,bt),Re[2*At+bn]>vt&&ee(Be,Re,yt,At);Me<Xt;){for(ee(Be,Re,Me,Xt),Me++,Xt--;Re[2*Me+bn]<vt;)Me++;for(;Re[2*Xt+bn]>vt;)Xt--}Re[2*yt+bn]===vt?ee(Be,Re,yt,Xt):(Xt++,ee(Be,Re,Xt,At)),Xt<=bt&&(yt=Xt+1),bt<=Xt&&(At=Xt-1)}}function ee(Be,Re,bt,yt){X(Be,bt,yt),X(Re,2*bt,2*yt),X(Re,2*bt+1,2*yt+1)}function X(Be,Re,bt){var yt=Be[Re];Be[Re]=Be[bt],Be[bt]=yt}function E(Be,Re,bt,yt,At,bn,He){for(var Rt=[0,Be.length-1,0],Oe=[],it,Qe;Rt.length;){var $e=Rt.pop(),Ot=Rt.pop(),vt=Rt.pop();if(Ot-vt<=He){for(var Me=vt;Me<=Ot;Me++)it=Re[2*Me],Qe=Re[2*Me+1],it>=bt&&it<=At&&Qe>=yt&&Qe<=bn&&Oe.push(Be[Me]);continue}var Xt=Math.floor((vt+Ot)/2);it=Re[2*Xt],Qe=Re[2*Xt+1],it>=bt&&it<=At&&Qe>=yt&&Qe<=bn&&Oe.push(Be[Xt]);var on=($e+1)%2;($e===0?bt<=it:yt<=Qe)&&(Rt.push(vt),Rt.push(Xt-1),Rt.push(on)),($e===0?At>=it:bn>=Qe)&&(Rt.push(Xt+1),Rt.push(Ot),Rt.push(on))}return Oe}function ve(Be,Re,bt,yt,At,bn){for(var He=[0,Be.length-1,0],Rt=[],Oe=At*At;He.length;){var it=He.pop(),Qe=He.pop(),$e=He.pop();if(Qe-$e<=bn){for(var Ot=$e;Ot<=Qe;Ot++)re(Re[2*Ot],Re[2*Ot+1],bt,yt)<=Oe&&Rt.push(Be[Ot]);continue}var vt=Math.floor(($e+Qe)/2),Me=Re[2*vt],Xt=Re[2*vt+1];re(Me,Xt,bt,yt)<=Oe&&Rt.push(Be[vt]);var on=(it+1)%2;(it===0?bt-At<=Me:yt-At<=Xt)&&(He.push($e),He.push(vt-1),He.push(on)),(it===0?bt+At>=Me:yt+At>=Xt)&&(He.push(vt+1),He.push(Qe),He.push(on))}return Rt}function re(Be,Re,bt,yt){var At=Be-bt,bn=Re-yt;return At*At+bn*bn}var fe=function(Be){return Be[0]},ae=function(Be){return Be[1]},Ee=function(Re,bt,yt,At,bn){bt===void 0&&(bt=fe),yt===void 0&&(yt=ae),At===void 0&&(At=64),bn===void 0&&(bn=Float64Array),this.nodeSize=At,this.points=Re;for(var He=Re.length<65536?Uint16Array:Uint32Array,Rt=this.ids=new He(Re.length),Oe=this.coords=new bn(Re.length*2),it=0;it<Re.length;it++)Rt[it]=it,Oe[2*it]=bt(Re[it]),Oe[2*it+1]=yt(Re[it]);W(Rt,Oe,At,0,Rt.length-1,0)};Ee.prototype.range=function(Re,bt,yt,At){return E(this.ids,this.coords,Re,bt,yt,At,this.nodeSize)},Ee.prototype.within=function(Re,bt,yt){return ve(this.ids,this.coords,Re,bt,yt,this.nodeSize)};var oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Be){return Be}},ze=Math.fround||function(Be){return function(Re){return Be[0]=+Re,Be[0]}}(new Float32Array(1)),te=function(Re){this.options=Gt(Object.create(oe),Re),this.trees=new Array(this.options.maxZoom+1)};te.prototype.load=function(Re){var bt=this.options,yt=bt.log,At=bt.minZoom,bn=bt.maxZoom,He=bt.nodeSize;yt&&console.time("total time");var Rt="prepare "+Re.length+" points";yt&&console.time(Rt),this.points=Re;for(var Oe=[],it=0;it<Re.length;it++)Re[it].geometry&&Oe.push(De(Re[it],it));this.trees[bn+1]=new Ee(Oe,mt,gt,He,Float32Array),yt&&console.timeEnd(Rt);for(var Qe=bn;Qe>=At;Qe--){var $e=+Date.now();Oe=this._cluster(Oe,Qe),this.trees[Qe]=new Ee(Oe,mt,gt,He,Float32Array),yt&&console.log("z%d: %d clusters in %dms",Qe,Oe.length,+Date.now()-$e)}return yt&&console.timeEnd("total time"),this},te.prototype.getClusters=function(Re,bt){var yt=((Re[0]+180)%360+360)%360-180,At=Math.max(-90,Math.min(90,Re[1])),bn=Re[2]===180?180:((Re[2]+180)%360+360)%360-180,He=Math.max(-90,Math.min(90,Re[3]));if(Re[2]-Re[0]>=360)yt=-180,bn=180;else if(yt>bn){var Rt=this.getClusters([yt,At,180,He],bt),Oe=this.getClusters([-180,At,bn,He],bt);return Rt.concat(Oe)}for(var it=this.trees[this._limitZoom(bt)],Qe=it.range(ce(yt),Ze(He),ce(bn),Ze(At)),$e=[],Ot=0,vt=Qe;Ot<vt.length;Ot+=1){var Me=vt[Ot],Xt=it.points[Me];$e.push(Xt.numPoints?Se(Xt):this.points[Xt.index])}return $e},te.prototype.getChildren=function(Re){var bt=this._getOriginId(Re),yt=this._getOriginZoom(Re),At="No cluster with the specified id.",bn=this.trees[yt];if(!bn)throw new Error(At);var He=bn.points[bt];if(!He)throw new Error(At);for(var Rt=this.options.radius/(this.options.extent*Math.pow(2,yt-1)),Oe=bn.within(He.x,He.y,Rt),it=[],Qe=0,$e=Oe;Qe<$e.length;Qe+=1){var Ot=$e[Qe],vt=bn.points[Ot];vt.parentId===Re&&it.push(vt.numPoints?Se(vt):this.points[vt.index])}if(it.length===0)throw new Error(At);return it},te.prototype.getLeaves=function(Re,bt,yt){bt=bt||10,yt=yt||0;var At=[];return this._appendLeaves(At,Re,bt,yt,0),At},te.prototype.getTile=function(Re,bt,yt){var At=this.trees[this._limitZoom(Re)],bn=Math.pow(2,Re),He=this.options,Rt=He.extent,Oe=He.radius,it=Oe/Rt,Qe=(yt-it)/bn,$e=(yt+1+it)/bn,Ot={features:[]};return this._addTileFeatures(At.range((bt-it)/bn,Qe,(bt+1+it)/bn,$e),At.points,bt,yt,bn,Ot),bt===0&&this._addTileFeatures(At.range(1-it/bn,Qe,1,$e),At.points,bn,yt,bn,Ot),bt===bn-1&&this._addTileFeatures(At.range(0,Qe,it/bn,$e),At.points,-1,yt,bn,Ot),Ot.features.length?Ot:null},te.prototype.getClusterExpansionZoom=function(Re){for(var bt=this._getOriginZoom(Re)-1;bt<=this.options.maxZoom;){var yt=this.getChildren(Re);if(bt++,yt.length!==1)break;Re=yt[0].properties.cluster_id}return bt},te.prototype._appendLeaves=function(Re,bt,yt,At,bn){for(var He=this.getChildren(bt),Rt=0,Oe=He;Rt<Oe.length;Rt+=1){var it=Oe[Rt],Qe=it.properties;if(Qe&&Qe.cluster?bn+Qe.point_count<=At?bn+=Qe.point_count:bn=this._appendLeaves(Re,Qe.cluster_id,yt,At,bn):bn<At?bn++:Re.push(it),Re.length===yt)break}return bn},te.prototype._addTileFeatures=function(Re,bt,yt,At,bn,He){for(var Rt=0,Oe=Re;Rt<Oe.length;Rt+=1){var it=Oe[Rt],Qe=bt[it],$e=Qe.numPoints,Ot=void 0,vt=void 0,Me=void 0;if($e)Ot=we(Qe),vt=Qe.x,Me=Qe.y;else{var Xt=this.points[Qe.index];Ot=Xt.properties,vt=ce(Xt.geometry.coordinates[0]),Me=Ze(Xt.geometry.coordinates[1])}var on={type:1,geometry:[[Math.round(this.options.extent*(vt*bn-yt)),Math.round(this.options.extent*(Me*bn-At))]],tags:Ot},Fn=void 0;$e?Fn=Qe.id:this.options.generateId?Fn=Qe.index:this.points[Qe.index].id&&(Fn=this.points[Qe.index].id),Fn!==void 0&&(on.id=Fn),He.features.push(on)}},te.prototype._limitZoom=function(Re){return Math.max(this.options.minZoom,Math.min(Math.floor(+Re),this.options.maxZoom+1))},te.prototype._cluster=function(Re,bt){for(var yt=[],At=this.options,bn=At.radius,He=At.extent,Rt=At.reduce,Oe=At.minPoints,it=bn/(He*Math.pow(2,bt)),Qe=0;Qe<Re.length;Qe++){var $e=Re[Qe];if(!($e.zoom<=bt)){$e.zoom=bt;for(var Ot=this.trees[bt+1],vt=Ot.within($e.x,$e.y,it),Me=$e.numPoints||1,Xt=Me,on=0,Fn=vt;on<Fn.length;on+=1){var $n=Fn[on],nr=Ot.points[$n];nr.zoom>bt&&(Xt+=nr.numPoints||1)}if(Xt>Me&&Xt>=Oe){for(var Ht=$e.x*Me,Jt=$e.y*Me,_n=Rt&&Me>1?this._map($e,!0):null,tr=(Qe<<5)+(bt+1)+this.points.length,an=0,Ut=vt;an<Ut.length;an+=1){var Dt=Ut[an],Ie=Ot.points[Dt];if(!(Ie.zoom<=bt)){Ie.zoom=bt;var qe=Ie.numPoints||1;Ht+=Ie.x*qe,Jt+=Ie.y*qe,Ie.parentId=tr,Rt&&(_n||(_n=this._map($e,!0)),Rt(_n,this._map(Ie)))}}$e.parentId=tr,yt.push(ye(Ht/Xt,Jt/Xt,tr,Xt,_n))}else if(yt.push($e),Xt>1)for(var Bt=0,j=vt;Bt<j.length;Bt+=1){var le=j[Bt],z=Ot.points[le];z.zoom<=bt||(z.zoom=bt,yt.push(z))}}}return yt},te.prototype._getOriginId=function(Re){return Re-this.points.length>>5},te.prototype._getOriginZoom=function(Re){return(Re-this.points.length)%32},te.prototype._map=function(Re,bt){if(Re.numPoints)return bt?Gt({},Re.properties):Re.properties;var yt=this.points[Re.index].properties,At=this.options.map(yt);return bt&&At===yt?Gt({},At):At};function ye(Be,Re,bt,yt,At){return{x:ze(Be),y:ze(Re),zoom:1/0,id:bt,parentId:-1,numPoints:yt,properties:At}}function De(Be,Re){var bt=Be.geometry.coordinates,yt=bt[0],At=bt[1];return{x:ze(ce(yt)),y:ze(Ze(At)),zoom:1/0,index:Re,parentId:-1}}function Se(Be){return{type:"Feature",id:Be.id,properties:we(Be),geometry:{type:"Point",coordinates:[xt(Be.x),ht(Be.y)]}}}function we(Be){var Re=Be.numPoints,bt=Re>=1e4?Math.round(Re/1e3)+"k":Re>=1e3?Math.round(Re/100)/10+"k":Re;return Gt(Gt({},Be.properties),{cluster:!0,cluster_id:Be.id,point_count:Re,point_count_abbreviated:bt})}function ce(Be){return Be/360+.5}function Ze(Be){var Re=Math.sin(Be*Math.PI/180),bt=.5-.25*Math.log((1+Re)/(1-Re))/Math.PI;return bt<0?0:bt>1?1:bt}function xt(Be){return(Be-.5)*360}function ht(Be){var Re=(180-Be*360)*Math.PI/180;return 360*Math.atan(Math.exp(Re))/Math.PI-90}function Gt(Be,Re){for(var bt in Re)Be[bt]=Re[bt];return Be}function mt(Be){return Be.x}function gt(Be){return Be.y}return te})},63405:function($t,W,D){var ee=D(73897);function X(E){if(Array.isArray(E))return ee(E)}$t.exports=X,$t.exports.__esModule=!0,$t.exports.default=$t.exports},79498:function($t){function W(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}$t.exports=W,$t.exports.__esModule=!0,$t.exports.default=$t.exports},42281:function($t){function W(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}$t.exports=W,$t.exports.__esModule=!0,$t.exports.default=$t.exports},51589:function($t,W,D){var ee=D(85372),X=D(79498),E=D(86116),ve=D(12218);function re(fe){return ee(fe)||X(fe)||E(fe)||ve()}$t.exports=re,$t.exports.__esModule=!0,$t.exports.default=$t.exports},861:function($t,W,D){var ee=D(63405),X=D(79498),E=D(86116),ve=D(42281);function re(fe){return ee(fe)||X(fe)||E(fe)||ve()}$t.exports=re,$t.exports.__esModule=!0,$t.exports.default=$t.exports},1449:function($t,W,D){"use strict";D.d(W,{Tu:function(){return te},tw:function(){return ce},uf:function(){return De},yu:function(){return oe},zL:function(){return re}});var ee=63710088e-1,X={centimeters:ee*100,centimetres:ee*100,degrees:ee/111325,feet:ee*3.28084,inches:ee*39.37,kilometers:ee/1e3,kilometres:ee/1e3,meters:ee,metres:ee,miles:ee/1609.344,millimeters:ee*1e3,millimetres:ee*1e3,nauticalmiles:ee/1852,radians:1,yards:ee*1.0936},E={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ee,yards:1.0936133},ve={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function re(Oe,it,Qe){Qe===void 0&&(Qe={});var $e={type:"Feature"};return(Qe.id===0||Qe.id)&&($e.id=Qe.id),Qe.bbox&&($e.bbox=Qe.bbox),$e.properties=it||{},$e.geometry=Oe,$e}function fe(Oe,it,Qe){switch(Qe===void 0&&(Qe={}),Oe){case"Point":return ae(it).geometry;case"LineString":return te(it).geometry;case"Polygon":return oe(it).geometry;case"MultiPoint":return we(it).geometry;case"MultiLineString":return Se(it).geometry;case"MultiPolygon":return ce(it).geometry;default:throw new Error(Oe+" is invalid")}}function ae(Oe,it,Qe){if(Qe===void 0&&(Qe={}),!Oe)throw new Error("coordinates is required");if(!Array.isArray(Oe))throw new Error("coordinates must be an Array");if(Oe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!At(Oe[0])||!At(Oe[1]))throw new Error("coordinates must contain numbers");var $e={type:"Point",coordinates:Oe};return re($e,it,Qe)}function Ee(Oe,it,Qe){return Qe===void 0&&(Qe={}),De(Oe.map(function($e){return ae($e,it)}),Qe)}function oe(Oe,it,Qe){Qe===void 0&&(Qe={});for(var $e=0,Ot=Oe;$e<Ot.length;$e++){var vt=Ot[$e];if(vt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Me=0;Me<vt[vt.length-1].length;Me++)if(vt[vt.length-1][Me]!==vt[0][Me])throw new Error("First and last Position are not equivalent.")}var Xt={type:"Polygon",coordinates:Oe};return re(Xt,it,Qe)}function ze(Oe,it,Qe){return Qe===void 0&&(Qe={}),De(Oe.map(function($e){return oe($e,it)}),Qe)}function te(Oe,it,Qe){if(Qe===void 0&&(Qe={}),Oe.length<2)throw new Error("coordinates must be an array of two or more positions");var $e={type:"LineString",coordinates:Oe};return re($e,it,Qe)}function ye(Oe,it,Qe){return Qe===void 0&&(Qe={}),De(Oe.map(function($e){return te($e,it)}),Qe)}function De(Oe,it){it===void 0&&(it={});var Qe={type:"FeatureCollection"};return it.id&&(Qe.id=it.id),it.bbox&&(Qe.bbox=it.bbox),Qe.features=Oe,Qe}function Se(Oe,it,Qe){Qe===void 0&&(Qe={});var $e={type:"MultiLineString",coordinates:Oe};return re($e,it,Qe)}function we(Oe,it,Qe){Qe===void 0&&(Qe={});var $e={type:"MultiPoint",coordinates:Oe};return re($e,it,Qe)}function ce(Oe,it,Qe){Qe===void 0&&(Qe={});var $e={type:"MultiPolygon",coordinates:Oe};return re($e,it,Qe)}function Ze(Oe,it,Qe){Qe===void 0&&(Qe={});var $e={type:"GeometryCollection",geometries:Oe};return re($e,it,Qe)}function xt(Oe,it){if(it===void 0&&(it=0),it&&!(it>=0))throw new Error("precision must be a positive number");var Qe=Math.pow(10,it||0);return Math.round(Oe*Qe)/Qe}function ht(Oe,it){it===void 0&&(it="kilometers");var Qe=X[it];if(!Qe)throw new Error(it+" units is invalid");return Oe*Qe}function Gt(Oe,it){it===void 0&&(it="kilometers");var Qe=X[it];if(!Qe)throw new Error(it+" units is invalid");return Oe/Qe}function mt(Oe,it){return Be(Gt(Oe,it))}function gt(Oe){var it=Oe%360;return it<0&&(it+=360),it}function Be(Oe){var it=Oe%(2*Math.PI);return it*180/Math.PI}function Re(Oe){var it=Oe%360;return it*Math.PI/180}function bt(Oe,it,Qe){if(it===void 0&&(it="kilometers"),Qe===void 0&&(Qe="kilometers"),!(Oe>=0))throw new Error("length must be a positive number");return ht(Gt(Oe,it),Qe)}function yt(Oe,it,Qe){if(it===void 0&&(it="meters"),Qe===void 0&&(Qe="kilometers"),!(Oe>=0))throw new Error("area must be a positive number");var $e=ve[it];if(!$e)throw new Error("invalid original units");var Ot=ve[Qe];if(!Ot)throw new Error("invalid final units");return Oe/$e*Ot}function At(Oe){return!isNaN(Oe)&&Oe!==null&&!Array.isArray(Oe)}function bn(Oe){return!!Oe&&Oe.constructor===Object}function He(Oe){if(!Oe)throw new Error("bbox is required");if(!Array.isArray(Oe))throw new Error("bbox must be an Array");if(Oe.length!==4&&Oe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Oe.forEach(function(it){if(!At(it))throw new Error("bbox must only contain numbers")})}function Rt(Oe){if(!Oe)throw new Error("id is required");if(["string","number"].indexOf(typeof Oe)===-1)throw new Error("id must be a number or a string")}},39034:function($t,W,D){"use strict";D.d(W,{nG:function(){return te},pZ:function(){return X}});var ee=D(1449);function X(ht,Gt,mt){if(ht!==null)for(var gt,Be,Re,bt,yt,At,bn,He=0,Rt=0,Oe,it=ht.type,Qe=it==="FeatureCollection",$e=it==="Feature",Ot=Qe?ht.features.length:1,vt=0;vt<Ot;vt++){bn=Qe?ht.features[vt].geometry:$e?ht.geometry:ht,Oe=bn?bn.type==="GeometryCollection":!1,yt=Oe?bn.geometries.length:1;for(var Me=0;Me<yt;Me++){var Xt=0,on=0;if(bt=Oe?bn.geometries[Me]:bn,bt!==null){At=bt.coordinates;var Fn=bt.type;switch(He=mt&&(Fn==="Polygon"||Fn==="MultiPolygon")?1:0,Fn){case null:break;case"Point":if(Gt(At,Rt,vt,Xt,on)===!1)return!1;Rt++,Xt++;break;case"LineString":case"MultiPoint":for(gt=0;gt<At.length;gt++){if(Gt(At[gt],Rt,vt,Xt,on)===!1)return!1;Rt++,Fn==="MultiPoint"&&Xt++}Fn==="LineString"&&Xt++;break;case"Polygon":case"MultiLineString":for(gt=0;gt<At.length;gt++){for(Be=0;Be<At[gt].length-He;Be++){if(Gt(At[gt][Be],Rt,vt,Xt,on)===!1)return!1;Rt++}Fn==="MultiLineString"&&Xt++,Fn==="Polygon"&&on++}Fn==="Polygon"&&Xt++;break;case"MultiPolygon":for(gt=0;gt<At.length;gt++){for(on=0,Be=0;Be<At[gt].length;Be++){for(Re=0;Re<At[gt][Be].length-He;Re++){if(Gt(At[gt][Be][Re],Rt,vt,Xt,on)===!1)return!1;Rt++}on++}Xt++}break;case"GeometryCollection":for(gt=0;gt<bt.geometries.length;gt++)if(X(bt.geometries[gt],Gt,mt)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function E(ht,Gt,mt,gt){var Be=mt;return X(ht,function(Re,bt,yt,At,bn){bt===0&&mt===void 0?Be=Re:Be=Gt(Be,Re,bt,yt,At,bn)},gt),Be}function ve(ht,Gt){var mt;switch(ht.type){case"FeatureCollection":for(mt=0;mt<ht.features.length&&Gt(ht.features[mt].properties,mt)!==!1;mt++);break;case"Feature":Gt(ht.properties,0);break}}function re(ht,Gt,mt){var gt=mt;return ve(ht,function(Be,Re){Re===0&&mt===void 0?gt=Be:gt=Gt(gt,Be,Re)}),gt}function fe(ht,Gt){if(ht.type==="Feature")Gt(ht,0);else if(ht.type==="FeatureCollection")for(var mt=0;mt<ht.features.length&&Gt(ht.features[mt],mt)!==!1;mt++);}function ae(ht,Gt,mt){var gt=mt;return fe(ht,function(Be,Re){Re===0&&mt===void 0?gt=Be:gt=Gt(gt,Be,Re)}),gt}function Ee(ht){var Gt=[];return X(ht,function(mt){Gt.push(mt)}),Gt}function oe(ht,Gt){var mt,gt,Be,Re,bt,yt,At,bn,He,Rt,Oe=0,it=ht.type==="FeatureCollection",Qe=ht.type==="Feature",$e=it?ht.features.length:1;for(mt=0;mt<$e;mt++){for(yt=it?ht.features[mt].geometry:Qe?ht.geometry:ht,bn=it?ht.features[mt].properties:Qe?ht.properties:{},He=it?ht.features[mt].bbox:Qe?ht.bbox:void 0,Rt=it?ht.features[mt].id:Qe?ht.id:void 0,At=yt?yt.type==="GeometryCollection":!1,bt=At?yt.geometries.length:1,Be=0;Be<bt;Be++){if(Re=At?yt.geometries[Be]:yt,Re===null){if(Gt(null,Oe,bn,He,Rt)===!1)return!1;continue}switch(Re.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Gt(Re,Oe,bn,He,Rt)===!1)return!1;break}case"GeometryCollection":{for(gt=0;gt<Re.geometries.length;gt++)if(Gt(Re.geometries[gt],Oe,bn,He,Rt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Oe++}}function ze(ht,Gt,mt){var gt=mt;return oe(ht,function(Be,Re,bt,yt,At){Re===0&&mt===void 0?gt=Be:gt=Gt(gt,Be,Re,bt,yt,At)}),gt}function te(ht,Gt){oe(ht,function(mt,gt,Be,Re,bt){var yt=mt===null?null:mt.type;switch(yt){case null:case"Point":case"LineString":case"Polygon":return Gt((0,ee.zL)(mt,Be,{bbox:Re,id:bt}),gt,0)===!1?!1:void 0}var At;switch(yt){case"MultiPoint":At="Point";break;case"MultiLineString":At="LineString";break;case"MultiPolygon":At="Polygon";break}for(var bn=0;bn<mt.coordinates.length;bn++){var He=mt.coordinates[bn],Rt={type:At,coordinates:He};if(Gt((0,ee.zL)(Rt,Be),gt,bn)===!1)return!1}})}function ye(ht,Gt,mt){var gt=mt;return te(ht,function(Be,Re,bt){Re===0&&bt===0&&mt===void 0?gt=Be:gt=Gt(gt,Be,Re,bt)}),gt}function De(ht,Gt){te(ht,function(mt,gt,Be){var Re=0;if(mt.geometry){var bt=mt.geometry.type;if(!(bt==="Point"||bt==="MultiPoint")){var yt,At=0,bn=0,He=0;if(X(mt,function(Rt,Oe,it,Qe,$e){if(yt===void 0||gt>At||Qe>bn||$e>He){yt=Rt,At=gt,bn=Qe,He=$e,Re=0;return}var Ot=lineString([yt,Rt],mt.properties);if(Gt(Ot,gt,Be,$e,Re)===!1)return!1;Re++,yt=Rt})===!1)return!1}}})}function Se(ht,Gt,mt){var gt=mt,Be=!1;return De(ht,function(Re,bt,yt,At,bn){Be===!1&&mt===void 0?gt=Re:gt=Gt(gt,Re,bt,yt,At,bn),Be=!0}),gt}function we(ht,Gt){if(!ht)throw new Error("geojson is required");te(ht,function(mt,gt,Be){if(mt.geometry!==null){var Re=mt.geometry.type,bt=mt.geometry.coordinates;switch(Re){case"LineString":if(Gt(mt,gt,Be,0,0)===!1)return!1;break;case"Polygon":for(var yt=0;yt<bt.length;yt++)if(Gt(lineString(bt[yt],mt.properties),gt,Be,yt)===!1)return!1;break}}})}function ce(ht,Gt,mt){var gt=mt;return we(ht,function(Be,Re,bt,yt){Re===0&&mt===void 0?gt=Be:gt=Gt(gt,Be,Re,bt,yt)}),gt}function Ze(ht,Gt){if(Gt=Gt||{},!isObject(Gt))throw new Error("options is invalid");var mt=Gt.featureIndex||0,gt=Gt.multiFeatureIndex||0,Be=Gt.geometryIndex||0,Re=Gt.segmentIndex||0,bt=Gt.properties,yt;switch(ht.type){case"FeatureCollection":mt<0&&(mt=ht.features.length+mt),bt=bt||ht.features[mt].properties,yt=ht.features[mt].geometry;break;case"Feature":bt=bt||ht.properties,yt=ht.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":yt=ht;break;default:throw new Error("geojson is invalid")}if(yt===null)return null;var At=yt.coordinates;switch(yt.type){case"Point":case"MultiPoint":return null;case"LineString":return Re<0&&(Re=At.length+Re-1),lineString([At[Re],At[Re+1]],bt,Gt);case"Polygon":return Be<0&&(Be=At.length+Be),Re<0&&(Re=At[Be].length+Re-1),lineString([At[Be][Re],At[Be][Re+1]],bt,Gt);case"MultiLineString":return gt<0&&(gt=At.length+gt),Re<0&&(Re=At[gt].length+Re-1),lineString([At[gt][Re],At[gt][Re+1]],bt,Gt);case"MultiPolygon":return gt<0&&(gt=At.length+gt),Be<0&&(Be=At[gt].length+Be),Re<0&&(Re=At[gt][Be].length-Re-1),lineString([At[gt][Be][Re],At[gt][Be][Re+1]],bt,Gt)}throw new Error("geojson is invalid")}function xt(ht,Gt){if(Gt=Gt||{},!isObject(Gt))throw new Error("options is invalid");var mt=Gt.featureIndex||0,gt=Gt.multiFeatureIndex||0,Be=Gt.geometryIndex||0,Re=Gt.coordIndex||0,bt=Gt.properties,yt;switch(ht.type){case"FeatureCollection":mt<0&&(mt=ht.features.length+mt),bt=bt||ht.features[mt].properties,yt=ht.features[mt].geometry;break;case"Feature":bt=bt||ht.properties,yt=ht.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":yt=ht;break;default:throw new Error("geojson is invalid")}if(yt===null)return null;var At=yt.coordinates;switch(yt.type){case"Point":return point(At,bt,Gt);case"MultiPoint":return gt<0&&(gt=At.length+gt),point(At[gt],bt,Gt);case"LineString":return Re<0&&(Re=At.length+Re),point(At[Re],bt,Gt);case"Polygon":return Be<0&&(Be=At.length+Be),Re<0&&(Re=At[Be].length+Re),point(At[Be][Re],bt,Gt);case"MultiLineString":return gt<0&&(gt=At.length+gt),Re<0&&(Re=At[gt].length+Re),point(At[gt][Re],bt,Gt);case"MultiPolygon":return gt<0&&(gt=At.length+gt),Be<0&&(Be=At[gt].length+Be),Re<0&&(Re=At[gt][Be].length-Re),point(At[gt][Be][Re],bt,Gt)}throw new Error("geojson is invalid")}},97582:function($t,W,D){"use strict";D.d(W,{CR:function(){return Ze},Jh:function(){return De},Q_:function(){return He},XA:function(){return ce},ZT:function(){return X},_T:function(){return ve},ev:function(){return Gt},mG:function(){return ye},pi:function(){return E}});var ee=function(vt,Me){return ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Xt,on){Xt.__proto__=on}||function(Xt,on){for(var Fn in on)Object.prototype.hasOwnProperty.call(on,Fn)&&(Xt[Fn]=on[Fn])},ee(vt,Me)};function X(vt,Me){if(typeof Me!="function"&&Me!==null)throw new TypeError("Class extends value "+String(Me)+" is not a constructor or null");ee(vt,Me);function Xt(){this.constructor=vt}vt.prototype=Me===null?Object.create(Me):(Xt.prototype=Me.prototype,new Xt)}var E=function(){return E=Object.assign||function(Me){for(var Xt,on=1,Fn=arguments.length;on<Fn;on++){Xt=arguments[on];for(var $n in Xt)Object.prototype.hasOwnProperty.call(Xt,$n)&&(Me[$n]=Xt[$n])}return Me},E.apply(this,arguments)};function ve(vt,Me){var Xt={};for(var on in vt)Object.prototype.hasOwnProperty.call(vt,on)&&Me.indexOf(on)<0&&(Xt[on]=vt[on]);if(vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Fn=0,on=Object.getOwnPropertySymbols(vt);Fn<on.length;Fn++)Me.indexOf(on[Fn])<0&&Object.prototype.propertyIsEnumerable.call(vt,on[Fn])&&(Xt[on[Fn]]=vt[on[Fn]]);return Xt}function re(vt,Me,Xt,on){var Fn=arguments.length,$n=Fn<3?Me:on===null?on=Object.getOwnPropertyDescriptor(Me,Xt):on,nr;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")$n=Reflect.decorate(vt,Me,Xt,on);else for(var Ht=vt.length-1;Ht>=0;Ht--)(nr=vt[Ht])&&($n=(Fn<3?nr($n):Fn>3?nr(Me,Xt,$n):nr(Me,Xt))||$n);return Fn>3&&$n&&Object.defineProperty(Me,Xt,$n),$n}function fe(vt,Me){return function(Xt,on){Me(Xt,on,vt)}}function ae(vt,Me,Xt,on,Fn,$n){function nr(j){if(j!==void 0&&typeof j!="function")throw new TypeError("Function expected");return j}for(var Ht=on.kind,Jt=Ht==="getter"?"get":Ht==="setter"?"set":"value",_n=!Me&&vt?on.static?vt:vt.prototype:null,tr=Me||(_n?Object.getOwnPropertyDescriptor(_n,on.name):{}),an,Ut=!1,Dt=Xt.length-1;Dt>=0;Dt--){var Ie={};for(var qe in on)Ie[qe]=qe==="access"?{}:on[qe];for(var qe in on.access)Ie.access[qe]=on.access[qe];Ie.addInitializer=function(j){if(Ut)throw new TypeError("Cannot add initializers after decoration has completed");$n.push(nr(j||null))};var Bt=(0,Xt[Dt])(Ht==="accessor"?{get:tr.get,set:tr.set}:tr[Jt],Ie);if(Ht==="accessor"){if(Bt===void 0)continue;if(Bt===null||typeof Bt!="object")throw new TypeError("Object expected");(an=nr(Bt.get))&&(tr.get=an),(an=nr(Bt.set))&&(tr.set=an),(an=nr(Bt.init))&&Fn.unshift(an)}else(an=nr(Bt))&&(Ht==="field"?Fn.unshift(an):tr[Jt]=an)}_n&&Object.defineProperty(_n,on.name,tr),Ut=!0}function Ee(vt,Me,Xt){for(var on=arguments.length>2,Fn=0;Fn<Me.length;Fn++)Xt=on?Me[Fn].call(vt,Xt):Me[Fn].call(vt);return on?Xt:void 0}function oe(vt){return typeof vt=="symbol"?vt:"".concat(vt)}function ze(vt,Me,Xt){return typeof Me=="symbol"&&(Me=Me.description?"[".concat(Me.description,"]"):""),Object.defineProperty(vt,"name",{configurable:!0,value:Xt?"".concat(Xt," ",Me):Me})}function te(vt,Me){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(vt,Me)}function ye(vt,Me,Xt,on){function Fn($n){return $n instanceof Xt?$n:new Xt(function(nr){nr($n)})}return new(Xt||(Xt=Promise))(function($n,nr){function Ht(tr){try{_n(on.next(tr))}catch(an){nr(an)}}function Jt(tr){try{_n(on.throw(tr))}catch(an){nr(an)}}function _n(tr){tr.done?$n(tr.value):Fn(tr.value).then(Ht,Jt)}_n((on=on.apply(vt,Me||[])).next())})}function De(vt,Me){var Xt={label:0,sent:function(){if($n[0]&1)throw $n[1];return $n[1]},trys:[],ops:[]},on,Fn,$n,nr;return nr={next:Ht(0),throw:Ht(1),return:Ht(2)},typeof Symbol=="function"&&(nr[Symbol.iterator]=function(){return this}),nr;function Ht(_n){return function(tr){return Jt([_n,tr])}}function Jt(_n){if(on)throw new TypeError("Generator is already executing.");for(;nr&&(nr=0,_n[0]&&(Xt=0)),Xt;)try{if(on=1,Fn&&($n=_n[0]&2?Fn.return:_n[0]?Fn.throw||(($n=Fn.return)&&$n.call(Fn),0):Fn.next)&&!($n=$n.call(Fn,_n[1])).done)return $n;switch(Fn=0,$n&&(_n=[_n[0]&2,$n.value]),_n[0]){case 0:case 1:$n=_n;break;case 4:return Xt.label++,{value:_n[1],done:!1};case 5:Xt.label++,Fn=_n[1],_n=[0];continue;case 7:_n=Xt.ops.pop(),Xt.trys.pop();continue;default:if($n=Xt.trys,!($n=$n.length>0&&$n[$n.length-1])&&(_n[0]===6||_n[0]===2)){Xt=0;continue}if(_n[0]===3&&(!$n||_n[1]>$n[0]&&_n[1]<$n[3])){Xt.label=_n[1];break}if(_n[0]===6&&Xt.label<$n[1]){Xt.label=$n[1],$n=_n;break}if($n&&Xt.label<$n[2]){Xt.label=$n[2],Xt.ops.push(_n);break}$n[2]&&Xt.ops.pop(),Xt.trys.pop();continue}_n=Me.call(vt,Xt)}catch(tr){_n=[6,tr],Fn=0}finally{on=$n=0}if(_n[0]&5)throw _n[1];return{value:_n[0]?_n[1]:void 0,done:!0}}}var Se=Object.create?function(vt,Me,Xt,on){on===void 0&&(on=Xt);var Fn=Object.getOwnPropertyDescriptor(Me,Xt);(!Fn||("get"in Fn?!Me.__esModule:Fn.writable||Fn.configurable))&&(Fn={enumerable:!0,get:function(){return Me[Xt]}}),Object.defineProperty(vt,on,Fn)}:function(vt,Me,Xt,on){on===void 0&&(on=Xt),vt[on]=Me[Xt]};function we(vt,Me){for(var Xt in vt)Xt!=="default"&&!Object.prototype.hasOwnProperty.call(Me,Xt)&&Se(Me,vt,Xt)}function ce(vt){var Me=typeof Symbol=="function"&&Symbol.iterator,Xt=Me&&vt[Me],on=0;if(Xt)return Xt.call(vt);if(vt&&typeof vt.length=="number")return{next:function(){return vt&&on>=vt.length&&(vt=void 0),{value:vt&&vt[on++],done:!vt}}};throw new TypeError(Me?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ze(vt,Me){var Xt=typeof Symbol=="function"&&vt[Symbol.iterator];if(!Xt)return vt;var on=Xt.call(vt),Fn,$n=[],nr;try{for(;(Me===void 0||Me-- >0)&&!(Fn=on.next()).done;)$n.push(Fn.value)}catch(Ht){nr={error:Ht}}finally{try{Fn&&!Fn.done&&(Xt=on.return)&&Xt.call(on)}finally{if(nr)throw nr.error}}return $n}function xt(){for(var vt=[],Me=0;Me<arguments.length;Me++)vt=vt.concat(Ze(arguments[Me]));return vt}function ht(){for(var vt=0,Me=0,Xt=arguments.length;Me<Xt;Me++)vt+=arguments[Me].length;for(var on=Array(vt),Fn=0,Me=0;Me<Xt;Me++)for(var $n=arguments[Me],nr=0,Ht=$n.length;nr<Ht;nr++,Fn++)on[Fn]=$n[nr];return on}function Gt(vt,Me,Xt){if(Xt||arguments.length===2)for(var on=0,Fn=Me.length,$n;on<Fn;on++)($n||!(on in Me))&&($n||($n=Array.prototype.slice.call(Me,0,on)),$n[on]=Me[on]);return vt.concat($n||Array.prototype.slice.call(Me))}function mt(vt){return this instanceof mt?(this.v=vt,this):new mt(vt)}function gt(vt,Me,Xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var on=Xt.apply(vt,Me||[]),Fn,$n=[];return Fn={},Ht("next"),Ht("throw"),Ht("return",nr),Fn[Symbol.asyncIterator]=function(){return this},Fn;function nr(Dt){return function(Ie){return Promise.resolve(Ie).then(Dt,an)}}function Ht(Dt,Ie){on[Dt]&&(Fn[Dt]=function(qe){return new Promise(function(Bt,j){$n.push([Dt,qe,Bt,j])>1||Jt(Dt,qe)})},Ie&&(Fn[Dt]=Ie(Fn[Dt])))}function Jt(Dt,Ie){try{_n(on[Dt](Ie))}catch(qe){Ut($n[0][3],qe)}}function _n(Dt){Dt.value instanceof mt?Promise.resolve(Dt.value.v).then(tr,an):Ut($n[0][2],Dt)}function tr(Dt){Jt("next",Dt)}function an(Dt){Jt("throw",Dt)}function Ut(Dt,Ie){Dt(Ie),$n.shift(),$n.length&&Jt($n[0][0],$n[0][1])}}function Be(vt){var Me,Xt;return Me={},on("next"),on("throw",function(Fn){throw Fn}),on("return"),Me[Symbol.iterator]=function(){return this},Me;function on(Fn,$n){Me[Fn]=vt[Fn]?function(nr){return(Xt=!Xt)?{value:mt(vt[Fn](nr)),done:!1}:$n?$n(nr):nr}:$n}}function Re(vt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Me=vt[Symbol.asyncIterator],Xt;return Me?Me.call(vt):(vt=typeof ce=="function"?ce(vt):vt[Symbol.iterator](),Xt={},on("next"),on("throw"),on("return"),Xt[Symbol.asyncIterator]=function(){return this},Xt);function on($n){Xt[$n]=vt[$n]&&function(nr){return new Promise(function(Ht,Jt){nr=vt[$n](nr),Fn(Ht,Jt,nr.done,nr.value)})}}function Fn($n,nr,Ht,Jt){Promise.resolve(Jt).then(function(_n){$n({value:_n,done:Ht})},nr)}}function bt(vt,Me){return Object.defineProperty?Object.defineProperty(vt,"raw",{value:Me}):vt.raw=Me,vt}var yt=Object.create?function(vt,Me){Object.defineProperty(vt,"default",{enumerable:!0,value:Me})}:function(vt,Me){vt.default=Me};function At(vt){if(vt&&vt.__esModule)return vt;var Me={};if(vt!=null)for(var Xt in vt)Xt!=="default"&&Object.prototype.hasOwnProperty.call(vt,Xt)&&Se(Me,vt,Xt);return yt(Me,vt),Me}function bn(vt){return vt&&vt.__esModule?vt:{default:vt}}function He(vt,Me,Xt,on){if(Xt==="a"&&!on)throw new TypeError("Private accessor was defined without a getter");if(typeof Me=="function"?vt!==Me||!on:!Me.has(vt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Xt==="m"?on:Xt==="a"?on.call(vt):on?on.value:Me.get(vt)}function Rt(vt,Me,Xt,on,Fn){if(on==="m")throw new TypeError("Private method is not writable");if(on==="a"&&!Fn)throw new TypeError("Private accessor was defined without a setter");if(typeof Me=="function"?vt!==Me||!Fn:!Me.has(vt))throw new TypeError("Cannot write private member to an object whose class did not declare it");return on==="a"?Fn.call(vt,Xt):Fn?Fn.value=Xt:Me.set(vt,Xt),Xt}function Oe(vt,Me){if(Me===null||typeof Me!="object"&&typeof Me!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof vt=="function"?Me===vt:vt.has(Me)}function it(vt,Me,Xt){if(Me!=null){if(typeof Me!="object"&&typeof Me!="function")throw new TypeError("Object expected.");var on,Fn;if(Xt){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");on=Me[Symbol.asyncDispose]}if(on===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");on=Me[Symbol.dispose],Xt&&(Fn=on)}if(typeof on!="function")throw new TypeError("Object not disposable.");Fn&&(on=function(){try{Fn.call(this)}catch($n){return Promise.reject($n)}}),vt.stack.push({value:Me,dispose:on,async:Xt})}else Xt&&vt.stack.push({async:!0});return Me}var Qe=typeof SuppressedError=="function"?SuppressedError:function(vt,Me,Xt){var on=new Error(Xt);return on.name="SuppressedError",on.error=vt,on.suppressed=Me,on};function $e(vt){function Me(on){vt.error=vt.hasError?new Qe(on,vt.error,"An error was suppressed during disposal."):on,vt.hasError=!0}function Xt(){for(;vt.stack.length;){var on=vt.stack.pop();try{var Fn=on.dispose&&on.dispose.call(on.value);if(on.async)return Promise.resolve(Fn).then(Xt,function($n){return Me($n),Xt()})}catch($n){Me($n)}}if(vt.hasError)throw vt.error}return Xt()}var Ot={__extends:X,__assign:E,__rest:ve,__decorate:re,__param:fe,__metadata:te,__awaiter:ye,__generator:De,__createBinding:Se,__exportStar:we,__values:ce,__read:Ze,__spread:xt,__spreadArrays:ht,__spreadArray:Gt,__await:mt,__asyncGenerator:gt,__asyncDelegator:Be,__asyncValues:Re,__makeTemplateObject:bt,__importStar:At,__importDefault:bn,__classPrivateFieldGet:He,__classPrivateFieldSet:Rt,__classPrivateFieldIn:Oe,__addDisposableResource:it,__disposeResources:$e}}}]);
}());