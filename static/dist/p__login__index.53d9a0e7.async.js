"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{19034:function(Ot,Ze,t){t.r(Ze),t.d(Ze,{default:function(){return Nt}});var Ke=t(15009),H=t.n(Ke),Ue=t(99289),oe=t.n(Ue),Ve=t(97857),w=t.n(Ve),Oe=t(5574),I=t.n(Oe),Qe=t(56034),ge=t(45360),je=t(42075),Pe=t(55102),Te=t(14726),Xe=t(74330),i=t(67294),ee=t(97584),e=t(85893),Ye=function(r){var o=r.value,L=o===void 0?{}:o,b=r.onChange,S=r.reload,v=S===void 0?0:S,E=r.placeholder,W=E===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":E,B=(0,i.useState)(""),A=I()(B,2),y=A[0],K=A[1],U=(0,i.useState)(""),$=I()(U,2),V=$[0],J=$[1],k=(0,i.useState)(""),h=I()(k,2),C=h[0],z=h[1],O=(0,i.useState)(!1),G=I()(O,2),Q=G[0],N=G[1],x=function(){var q=oe()(H()().mark(function M(){var F;return H()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,P.next=3,(0,ee.xx)({key:V});case 3:if(F=P.sent,F.code!==0){P.next=6;break}return P.abrupt("return",F.data);case 6:P.next=12;break;case 8:return P.prev=8,P.t0=P.catch(0),ge.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),P.abrupt("return",[]);case 12:return ge.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),P.abrupt("return",[]);case 14:case"end":return P.stop()}},M,null,[[0,8]])}));return function(){return q.apply(this,arguments)}}(),f=function(M){b&&b(w()(w()({captchaCode:y,captchaKey:V},L),M))},Z=function(M){N(!0),x().then(function(F){N(!1),J(F.key),z(F.img),M&&f({captchaKey:F.key})})};(0,i.useEffect)(function(){Z(!1)},[]),(0,i.useEffect)(function(){v>0&&Z(!0)},[v]);var d=function(M){var F=M.target.value||"";F&&K(F),f({captchaCode:F})},j=function(){Z(!0)};return(0,e.jsxs)(je.Z,{children:[(0,e.jsx)(Pe.Z,{prefix:(0,e.jsx)(Qe.Z,{}),size:"large",placeholder:W,onChange:d}),(0,e.jsx)(Te.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)(Xe.Z,{spinning:Q,size:"small",children:(0,e.jsx)("img",{src:C,onClick:j})})})]})},ve=Ye,Je=t(99702),qe=t(62871),_e=t(64182),et=t(73406),Ie=t(87547),Ae=t(94149),tt=t(71356),nt=t(84517),he=t(5966),se=t(34994),at=t(97462),l=t(1413),le=t(74165),be=t(15861),fe=t(45987),me=t(97685),rt=t(8232),Fe=t(90789),it=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],ot=i.forwardRef(function(n,r){var o=rt.Z.useFormInstance(),L=(0,i.useState)(n.countDown||60),b=(0,me.Z)(L,2),S=b[0],v=b[1],E=(0,i.useState)(!1),W=(0,me.Z)(E,2),B=W[0],A=W[1],y=(0,i.useState)(),K=(0,me.Z)(y,2),U=K[0],$=K[1],V=n.rules,J=n.name,k=n.phoneName,h=n.fieldProps,C=n.onTiming,z=n.captchaTextRender,O=z===void 0?function(x,f){return x?"".concat(f," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:z,G=n.captchaProps,Q=(0,fe.Z)(n,it),N=function(){var x=(0,be.Z)((0,le.Z)().mark(function f(Z){return(0,le.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,$(!0),j.next=4,Q.onGetCaptcha(Z);case 4:$(!1),A(!0),j.next=13;break;case 8:j.prev=8,j.t0=j.catch(0),A(!1),$(!1),console.log(j.t0);case 13:case"end":return j.stop()}},f,null,[[0,8]])}));return function(Z){return x.apply(this,arguments)}}();return(0,i.useImperativeHandle)(r,function(){return{startTiming:function(){return A(!0)},endTiming:function(){return A(!1)}}}),(0,i.useEffect)(function(){var x=0,f=n.countDown;return B&&(x=window.setInterval(function(){v(function(Z){return Z<=1?(A(!1),clearInterval(x),f||60):Z-1})},1e3)),function(){return clearInterval(x)}},[B]),(0,i.useEffect)(function(){C&&C(S)},[S,C]),(0,e.jsxs)("div",{style:(0,l.Z)((0,l.Z)({},h==null?void 0:h.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[(0,e.jsx)(Pe.Z,(0,l.Z)((0,l.Z)({},h),{},{style:(0,l.Z)({flex:1,transition:"width .3s",marginRight:8},h==null?void 0:h.style)})),(0,e.jsx)(Te.ZP,(0,l.Z)((0,l.Z)({style:{display:"block"},disabled:B,loading:U},G),{},{onClick:(0,be.Z)((0,le.Z)().mark(function x(){var f;return(0,le.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,!k){d.next=9;break}return d.next=4,o.validateFields([k].flat(1));case 4:return f=o.getFieldValue([k].flat(1)),d.next=7,N(f);case 7:d.next=11;break;case 9:return d.next=11,N("");case 11:d.next=16;break;case 13:d.prev=13,d.t0=d.catch(0),console.log(d.t0);case 16:case"end":return d.stop()}},x,null,[[0,13]])})),children:O(B,S)}))]})}),st=(0,Fe.G)(ot),lt=st,ut=t(10915),ct=t(28459),dt=t(93967),gt=t.n(dt),pe=t(4942),vt=t(98082),ht=function(r){return(0,pe.Z)((0,pe.Z)({},r.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:r.colorTextSecondary,fontSize:r.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),"@media (min-width: @screen-md-min)",(0,pe.Z)({},"".concat(r.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}))};function ft(n){return(0,vt.Xj)("LoginForm",function(r){var o=(0,l.Z)((0,l.Z)({},r),{},{componentCls:".".concat(n)});return[ht(o)]})}var mt=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function pt(n){var r,o=n.logo,L=n.message,b=n.contentStyle,S=n.title,v=n.subTitle,E=n.actions,W=n.children,B=n.containerStyle,A=n.otherStyle,y=(0,fe.Z)(n,mt),K=(0,ut.YB)(),U=y.submitter===!1?!1:(0,l.Z)((0,l.Z)({searchConfig:{submitText:K.getMessage("loginForm.submitText","\u767B\u5F55")}},y.submitter),{},{submitButtonProps:(0,l.Z)({size:"large",style:{width:"100%"}},(r=y.submitter)===null||r===void 0?void 0:r.submitButtonProps),render:function(G,Q){var N,x=Q.pop();if(typeof(y==null||(N=y.submitter)===null||N===void 0?void 0:N.render)=="function"){var f,Z;return y==null||(f=y.submitter)===null||f===void 0||(Z=f.render)===null||Z===void 0?void 0:Z.call(f,G,Q)}return x}}),$=(0,i.useContext)(ct.ZP.ConfigContext),V=$.getPrefixCls("pro-form-login"),J=ft(V),k=J.wrapSSR,h=J.hashId,C=function(G){return"".concat(V,"-").concat(G," ").concat(h)},z=(0,i.useMemo)(function(){return o?typeof o=="string"?(0,e.jsx)("img",{src:o}):o:null},[o]);return k((0,e.jsxs)("div",{className:gt()(C("container"),h),style:B,children:[(0,e.jsxs)("div",{className:"".concat(C("top")," ").concat(h).trim(),children:[S||z?(0,e.jsxs)("div",{className:"".concat(C("header")),children:[z?(0,e.jsx)("span",{className:C("logo"),children:z}):null,S?(0,e.jsx)("span",{className:C("title"),children:S}):null]}):null,v?(0,e.jsx)("div",{className:C("desc"),children:v}):null]}),(0,e.jsxs)("div",{className:C("main"),style:(0,l.Z)({width:328},b),children:[(0,e.jsxs)(se.A,(0,l.Z)((0,l.Z)({isKeyPressSubmit:!0},y),{},{submitter:U,children:[L,W]})),E?(0,e.jsx)("div",{className:C("main-other"),style:A,children:E}):null]})]}))}var Re=t(22270),xt=t(84567),Le=t(20677),St=["options","fieldProps","proFieldProps","valueEnum"],yt=i.forwardRef(function(n,r){var o=n.options,L=n.fieldProps,b=n.proFieldProps,S=n.valueEnum,v=(0,fe.Z)(n,St);return(0,e.jsx)(Le.Z,(0,l.Z)({ref:r,valueType:"checkbox",valueEnum:(0,Re.h)(S,void 0),fieldProps:(0,l.Z)({options:o},L),lightProps:(0,l.Z)({labelFormatter:function(){return(0,e.jsx)(Le.Z,(0,l.Z)({ref:r,valueType:"checkbox",mode:"read",valueEnum:(0,Re.h)(S,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,l.Z)({options:o},L),proFieldProps:b},v))}},v.lightProps),proFieldProps:b},v))}),Ct=i.forwardRef(function(n,r){var o=n.fieldProps,L=n.children;return(0,e.jsx)(xt.Z,(0,l.Z)((0,l.Z)({ref:r},o),{},{children:L}))}),Zt=(0,Fe.G)(Ct,{valuePropName:"checked"}),Be=Zt;Be.Group=yt;var jt=Be,te=t(7837),Pt=t(26855),Tt=t(9361),It=t(10397),At=t(48096),Ne=t(73935),xe=t(37233),bt=t(6189),Ft=t(70853),g=t(55886),De=(0,bt.kc)(function(n){var r=n.token,o=n.css;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:r.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:r.borderRadius,":hover":{backgroundColor:r.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),Rt=function(){var r=De(),o=r.styles;return(0,e.jsxs)("div",{className:o.lang,"data-lang":!0,children:[(0,e.jsx)(Ft.pD,{}),","]})},Lt=function(){return(0,e.jsx)(Bt,{})},Bt=function(){var r,o,L=De(),b=L.styles,S=(0,te.useModel)("@@initialState"),v=S.initialState,E=S.setInitialState,W=(0,i.useState)(0),B=I()(W,2),A=B[0],y=B[1],K=(0,i.useState)(0),U=I()(K,2),$=U[0],V=U[1],J=(0,i.useState)(!1),k=I()(J,2),h=k[0],C=k[1],z=(0,i.useState)(!1),O=I()(z,2),G=O[0],Q=O[1],N=(0,te.useSearchParams)(),x=I()(N,1),f=x[0],Z=ge.ZP.useMessage(),d=I()(Z,2),j=d[0],q=d[1],M=Pt.ZP.useNotification(),F=I()(M,2),Ee=F[0],P=F[1],ue=(0,i.useContext)(_e.DN),Dt=ue.clientId,Se=ue.messageData,ye=ue.bind,Qt=ue.setMessageData,Et=(0,i.useState)(),$e=I()(Et,2),a=$e[0],$t=$e[1],kt=(0,i.useState)(),ke=I()(kt,2),ne=ke[0],ze=ke[1];(0,i.useEffect)(function(){(0,et.Zl)().then(function(s){$t(s),ze(s==null?void 0:s.loginTypeDefault)})},[]);var Me=function(u){ye==null||ye(),E(function(p){return w()(w()({},p),{},{currentUser:u.userinfo,settings:w()(w()({},p==null?void 0:p.settings),u.setting)})}).then(function(){var p,X="/",c="/";if(u.userinfo.redirect)c=u.userinfo.redirect;else if(v!=null&&(p=v.settings)!==null&&p!==void 0&&p.baseurl){var D;c=X.replace(v==null||(D=v.settings)===null||D===void 0?void 0:D.baseurl,"/")}te.history.push(c)})};(0,i.useEffect)(function(){if(Se){var s=Se.data;(s==null?void 0:s.action)=="login"&&(xe.Z.set("Sa-Remember",1),(0,ee.MU)(s.access_token).then(function(){j.success({content:s.msg,duration:1,onClose:function(){(0,Ne.flushSync)(function(){Me(s)})}})}))}},[Se]);var zt=function(){var s=oe()(H()().mark(function u(p){return H()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ee.ZP.post("login",{data:w()(w()({},p),{},{loginType:ne}),duration:1,then:function(T){var _=T.code,Y=T.msg,ae=T.data;T.code?(Ee.error({description:Y,message:"\u63D0\u793A"}),ne=="phone"&&T.code==3&&V(A+1),h&&y(A+1),(T.code==3||T.code==2)&&C(!0)):(p.autoLogin?xe.Z.set("Sa-Remember",1):xe.Z.set("Sa-Remember",0),(0,ee.MU)(T.data.access_token).then(function(){j.success({content:Y,duration:1,onClose:function(){(0,Ne.flushSync)(function(){Me(T.data)})}})}))}});case 2:return c.abrupt("return");case 3:case"end":return c.stop()}},u)}));return function(p){return s.apply(this,arguments)}}(),we=(0,i.useRef)(),m=(0,te.useIntl)(),Mt=[{label:(0,g.t)("pages.login.phoneLogin.tab",m),key:"phone",children:ne!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(he.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(Ie.Z,{})},placeholder:(0,g.t)("pages.login.phoneNumber.placeholder",m),rules:[{required:!0,message:(0,g.t)("pages.login.phoneNumber.required",m)},{pattern:/^1\d{10}$/,message:(0,g.t)("pages.login.phoneNumber.invalid",m)}]}),(0,e.jsx)(se.A.Item,{name:"captchaPhone",rules:[{required:!0,message:(0,g.t)("pages.login.captcha.required",m)}],children:(0,e.jsx)(ve,{reload:$,placeholder:(0,g.t)("pages.login.captcha.placeholder",m)})}),(0,e.jsx)(at.Z,{name:["captchaPhone"],children:function(u){var p=u.captchaPhone;return(0,e.jsx)(lt,{fieldProps:{size:"large",prefix:(0,e.jsx)(Ae.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:(0,g.t)("pages.login.captcha.placeholder",m),captchaTextRender:function(c,D){return c?"".concat(D," ").concat((0,g.t)("pages.login.phoneLogin.getVerificationCode",m)):(0,g.t)("pages.login.phoneLogin.getVerificationCode",m)},name:"mobilecode",rules:[{required:!0,message:(0,g.t)("pages.login.captcha.required",m)}],onGetCaptcha:function(){var X=oe()(H()().mark(function c(D){var T,_,Y,ae;return H()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.prev=0,R.next=3,(T=we.current)===null||T===void 0?void 0:T.validateFields(["captcha"]);case 3:R.next=8;break;case 5:throw R.prev=5,R.t0=R.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return R.next=10,ee.ZP.post("sms",{data:{mobile:D,captcha:p}});case 10:if(_=R.sent,Y=_.code,ae=_.msg,!Y){R.next=15;break}throw new Error(ae);case 15:case"end":return R.stop()}},c,null,[[0,5]])}));return function(c){return X.apply(this,arguments)}}()})}}),h&&(0,e.jsx)(se.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ve,{reload:A})})]})},{label:(0,g.t)("pages.login.accountLogin.tab",m),key:"password",children:ne!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(he.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(Ie.Z,{})},placeholder:(0,g.t)("pages.login.username.placeholder",m),rules:[{required:!0,message:(0,g.t)("pages.login.username.required",m)}]}),(0,e.jsx)(he.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(Ae.Z,{})},placeholder:(0,g.t)("pages.login.password.placeholder",m),rules:[{required:!0,message:(0,g.t)("pages.login.password.required",m)}]}),h&&(0,e.jsx)(se.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ve,{reload:A})})]})}],wt=Tt.Z.useToken(),Gt=wt.token,Ce={};(a==null?void 0:a.navTheme)=="light"?a!=null&&a.loginBgImgage&&(Ce.backgroundImage='url("'+a.loginBgImgage+'")'):Ce.background=Gt.colorBgBase;var Ht=function(u){var p=u.type,X=(0,i.useState)(0),c=I()(X,2),D=c[0],T=c[1],_=(0,i.useState)("active"),Y=I()(_,2),ae=Y[0],ce=Y[1],R=3*60,de,Ge=function re(ie){var Vt=Date.now();Vt>ie+R*1e3?ce("expired"):de=setTimeout(function(){return re(ie)},1e3)},Wt=function(){var ie=Date.now();T(ie),ce("active"),de=setTimeout(function(){return Ge(ie)},1e3)};if((0,i.useEffect)(function(){var re=Date.now();return T(re),de=setTimeout(function(){return Ge(re)},1e3),function(){return clearTimeout(de)}},[]),p=="wechat"){var He=a==null?void 0:a.loginWechat,Kt=He.url,Ut=He.desc,We=Kt+"?client_id="+Dt+"&timestamp="+D;return console.log("qrcodeUrl",We),(0,e.jsxs)("div",{style:{textAlign:"center"},children:[D?(0,e.jsx)(It.Z,{style:{margin:"0 auto"},value:We,status:ae,onRefresh:Wt}):null,(0,e.jsx)("div",{style:{marginTop:20},children:Ut})]})}return null};return a?(0,e.jsxs)("div",{className:b.container,style:w()({},Ce),children:[(0,e.jsx)(te.Helmet,{children:(0,e.jsxs)("title",{children:["\u767B\u5F55 - ",a==null?void 0:a.title]})}),q,P,a!=null&&a.lang?(0,e.jsx)(Rt,{}):null,(0,e.jsx)("div",{style:{flex:"1",padding:"48px 0"},children:(0,e.jsx)(nt.ZP,{style:{margin:"0px auto",background:a==null?void 0:a.loginBgCardColor,width:376},bodyStyle:{paddingTop:0,paddingBottom:0},className:b.card,children:(0,e.jsxs)(pt,{contentStyle:{minWidth:280,maxWidth:"75vw"},containerStyle:{paddingInline:0},formRef:we,logo:a==null?void 0:a.logo,title:a==null?void 0:a.title,subTitle:a!=null&&a.subtitle?(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.subtitle}}):null,initialValues:{autoLogin:!0},onFinish:function(){var s=oe()(H()().mark(function u(p){return H()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,zt(p);case 2:case"end":return c.stop()}},u)}));return function(u){return s.apply(this,arguments)}}(),actions:a!=null&&a.loginActions?(0,e.jsxs)(je.Z,{children:[(0,g.t)("pages.login.loginWith",m),(0,e.jsx)(qe.Z,{trigger:(0,e.jsx)(tt.Z,{className:b.action}),width:350,title:"\u626B\u7801\u767B\u5F55",children:a==null||(r=a.loginActions)===null||r===void 0?void 0:r.map(function(s,u){return(0,e.jsx)(Ht,{type:s},u)})})]}):null,children:[(0,e.jsx)(At.Z,{centered:!0,activeKey:ne,onChange:function(u){ze(u),Q(u=="phone")},items:(o=a.loginType)===null||o===void 0?void 0:o.map(function(s){return Mt.find(function(u){return u.key==s})})}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(jt,{noStyle:!0,name:"autoLogin",children:(0,g.t)("pages.login.rememberMe",m)}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){j.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:(0,g.t)("pages.login.forgotPassword",m)})]})]})})}),(0,e.jsx)(Je.Z,{})]}):null},Nt=Lt}}]);
