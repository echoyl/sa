"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[890],{4559:function(Qs,ii,U){U.d(ii,{$6:function(){return be},$p:function(){return ho},Aw:function(){return ge},Cd:function(){return Tn},Cm:function(){return R},Dk:function(){return he},E9:function(){return ve},Ee:function(){return Cn},F6:function(){return mi},G$:function(){return yr},G0:function(){return Lr},GL:function(){return ut},GZ:function(){return C},I8:function(){return yi},L1:function(){return mo},N1:function(){return xr},NB:function(){return ae},O4:function(){return ye},Oi:function(){return Mr},Pj:function(){return Pn},R:function(){return tr},RV:function(){return q},Rr:function(){return ft},Rx:function(){return Qi},UL:function(){return An},V1:function(){return $n},Vl:function(){return j},Xz:function(){return Gs},YR:function(){return wa},ZA:function(){return gt},_O:function(){return kt},aH:function(){return wn},b_:function(){return Ss},bn:function(){return b},gz:function(){return an},h0:function(){return A},iM:function(){return se},jB:function(){return _r},jU:function(){return wt},jf:function(){return ee},k9:function(){return Mn},lu:function(){return nt},mN:function(){return de},mg:function(){return pt},o6:function(){return ji},qA:function(){return qt},s$:function(){return oe},ux:function(){return Is},x1:function(){return Sn},xA:function(){return Rt},xv:function(){return It},y$:function(){return Nn}});var K=U(1413),D=U(15671),I=U(43144),ne=U(74902),J=U(53640),Q=U(60136),re=U(97685),Gt=U(89093),x=U(77160),le=U(98333),w=U(85975),Ut=U(35600),V=U(32945),yt=U(31437),$e=U(25897),_e=U(44078),fe=U(95147),Ge=U(76714),at=U(81957),ai=U(69877),In=U(71523),bn=U(13882),oi=U(80450),_n=U(8614),Zn=U(4848),Bn=U(75839),si=U(99872),Fn=U(92455),ui=U(65850),li=U(28659),ci=U(83555),ie=U(71154),hi=U(5199),Gn=U(90134),ot=U(45607),fi=U(4637),vi=U(84329),H=U(4942),Un=U(71937),di=U(90378),Ze=U(11702),Ke=U(74165),Yt=U(15861),Je=U(37762),Ue=U(45987);var gi=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof U.g!="undefined"?U.g:typeof self!="undefined"?self:{},Yn={exports:{}};(function(r,i){(function(e,t){r.exports=t()})(gi,function(){function e(E,g,p,k,S){t(E,g,p||0,k||E.length-1,S||a)}function t(E,g,p,k,S){for(;k>p;){if(k-p>600){var N=k-p+1,O=g-p+1,L=Math.log(N),B=.5*Math.exp(2*L/3),F=.5*Math.sqrt(L*B*(N-B)/N)*(O-N/2<0?-1:1),G=Math.max(p,Math.floor(g-O*B/N+F)),z=Math.min(k,Math.floor(g+(N-O)*B/N+F));t(E,g,G,z,S)}var _=E[g],W=p,X=k;for(n(E,p,g),S(E[k],_)>0&&n(E,p,k);W<X;){for(n(E,W,X),W++,X--;S(E[W],_)<0;)W++;for(;S(E[X],_)>0;)X--}S(E[p],_)===0?n(E,p,X):(X++,n(E,X,k)),X<=g&&(p=X+1),g<=X&&(k=X-1)}}function n(E,g,p){var k=E[g];E[g]=E[p],E[p]=k}function a(E,g){return E<g?-1:E>g?1:0}var o=function(g){g===void 0&&(g=9),this._maxEntries=Math.max(4,g),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(g){var p=this.data,k=[];if(!M(g,p))return k;for(var S=this.toBBox,N=[];p;){for(var O=0;O<p.children.length;O++){var L=p.children[O],B=p.leaf?S(L):L;M(g,B)&&(p.leaf?k.push(L):T(g,B)?this._all(L,k):N.push(L))}p=N.pop()}return k},o.prototype.collides=function(g){var p=this.data;if(!M(g,p))return!1;for(var k=[];p;){for(var S=0;S<p.children.length;S++){var N=p.children[S],O=p.leaf?this.toBBox(N):N;if(M(g,O)){if(p.leaf||T(g,O))return!0;k.push(N)}}p=k.pop()}return!1},o.prototype.load=function(g){if(!(g&&g.length))return this;if(g.length<this._minEntries){for(var p=0;p<g.length;p++)this.insert(g[p]);return this}var k=this._build(g.slice(),0,g.length-1,0);if(!this.data.children.length)this.data=k;else if(this.data.height===k.height)this._splitRoot(this.data,k);else{if(this.data.height<k.height){var S=this.data;this.data=k,k=S}this._insert(k,this.data.height-k.height-1,!0)}return this},o.prototype.insert=function(g){return g&&this._insert(g,this.data.height-1),this},o.prototype.clear=function(){return this.data=P([]),this},o.prototype.remove=function(g,p){if(!g)return this;for(var k=this.data,S=this.toBBox(g),N=[],O=[],L,B,F;k||N.length;){if(k||(k=N.pop(),B=N[N.length-1],L=O.pop(),F=!0),k.leaf){var G=s(g,k.children,p);if(G!==-1)return k.children.splice(G,1),N.push(k),this._condense(N),this}!F&&!k.leaf&&T(k,S)?(N.push(k),O.push(L),L=0,B=k,k=k.children[0]):B?(L++,k=B.children[L],F=!1):k=null}return this},o.prototype.toBBox=function(g){return g},o.prototype.compareMinX=function(g,p){return g.minX-p.minX},o.prototype.compareMinY=function(g,p){return g.minY-p.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(g){return this.data=g,this},o.prototype._all=function(g,p){for(var k=[];g;)g.leaf?p.push.apply(p,g.children):k.push.apply(k,g.children),g=k.pop();return p},o.prototype._build=function(g,p,k,S){var N=k-p+1,O=this._maxEntries,L;if(N<=O)return L=P(g.slice(p,k+1)),u(L,this.toBBox),L;S||(S=Math.ceil(Math.log(N)/Math.log(O)),O=Math.ceil(N/Math.pow(O,S-1))),L=P([]),L.leaf=!1,L.height=S;var B=Math.ceil(N/O),F=B*Math.ceil(Math.sqrt(O));Z(g,p,k,F,this.compareMinX);for(var G=p;G<=k;G+=F){var z=Math.min(G+F-1,k);Z(g,G,z,B,this.compareMinY);for(var _=G;_<=z;_+=B){var W=Math.min(_+B-1,z);L.children.push(this._build(g,_,W,S-1))}}return u(L,this.toBBox),L},o.prototype._chooseSubtree=function(g,p,k,S){for(;S.push(p),!(p.leaf||S.length-1===k);){for(var N=1/0,O=1/0,L=void 0,B=0;B<p.children.length;B++){var F=p.children[B],G=d(F),z=y(g,F)-G;z<O?(O=z,N=G<N?G:N,L=F):z===O&&G<N&&(N=G,L=F)}p=L||p.children[0]}return p},o.prototype._insert=function(g,p,k){var S=k?g:this.toBBox(g),N=[],O=this._chooseSubtree(S,this.data,p,N);for(O.children.push(g),c(O,S);p>=0&&N[p].children.length>this._maxEntries;)this._split(N,p),p--;this._adjustParentBBoxes(S,N,p)},o.prototype._split=function(g,p){var k=g[p],S=k.children.length,N=this._minEntries;this._chooseSplitAxis(k,N,S);var O=this._chooseSplitIndex(k,N,S),L=P(k.children.splice(O,k.children.length-O));L.height=k.height,L.leaf=k.leaf,u(k,this.toBBox),u(L,this.toBBox),p?g[p-1].children.push(L):this._splitRoot(k,L)},o.prototype._splitRoot=function(g,p){this.data=P([g,p]),this.data.height=g.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(g,p,k){for(var S,N=1/0,O=1/0,L=p;L<=k-p;L++){var B=l(g,0,L,this.toBBox),F=l(g,L,k,this.toBBox),G=m(B,F),z=d(B)+d(F);G<N?(N=G,S=L,O=z<O?z:O):G===N&&z<O&&(O=z,S=L)}return S||k-p},o.prototype._chooseSplitAxis=function(g,p,k){var S=g.leaf?this.compareMinX:h,N=g.leaf?this.compareMinY:f,O=this._allDistMargin(g,p,k,S),L=this._allDistMargin(g,p,k,N);O<L&&g.children.sort(S)},o.prototype._allDistMargin=function(g,p,k,S){g.children.sort(S);for(var N=this.toBBox,O=l(g,0,p,N),L=l(g,k-p,k,N),B=v(O)+v(L),F=p;F<k-p;F++){var G=g.children[F];c(O,g.leaf?N(G):G),B+=v(O)}for(var z=k-p-1;z>=p;z--){var _=g.children[z];c(L,g.leaf?N(_):_),B+=v(L)}return B},o.prototype._adjustParentBBoxes=function(g,p,k){for(var S=k;S>=0;S--)c(p[S],g)},o.prototype._condense=function(g){for(var p=g.length-1,k=void 0;p>=0;p--)g[p].children.length===0?p>0?(k=g[p-1].children,k.splice(k.indexOf(g[p]),1)):this.clear():u(g[p],this.toBBox)};function s(E,g,p){if(!p)return g.indexOf(E);for(var k=0;k<g.length;k++)if(p(E,g[k]))return k;return-1}function u(E,g){l(E,0,E.children.length,g,E)}function l(E,g,p,k,S){S||(S=P(null)),S.minX=1/0,S.minY=1/0,S.maxX=-1/0,S.maxY=-1/0;for(var N=g;N<p;N++){var O=E.children[N];c(S,E.leaf?k(O):O)}return S}function c(E,g){return E.minX=Math.min(E.minX,g.minX),E.minY=Math.min(E.minY,g.minY),E.maxX=Math.max(E.maxX,g.maxX),E.maxY=Math.max(E.maxY,g.maxY),E}function h(E,g){return E.minX-g.minX}function f(E,g){return E.minY-g.minY}function d(E){return(E.maxX-E.minX)*(E.maxY-E.minY)}function v(E){return E.maxX-E.minX+(E.maxY-E.minY)}function y(E,g){return(Math.max(g.maxX,E.maxX)-Math.min(g.minX,E.minX))*(Math.max(g.maxY,E.maxY)-Math.min(g.minY,E.minY))}function m(E,g){var p=Math.max(E.minX,g.minX),k=Math.max(E.minY,g.minY),S=Math.min(E.maxX,g.maxX),N=Math.min(E.maxY,g.maxY);return Math.max(0,S-p)*Math.max(0,N-k)}function T(E,g){return E.minX<=g.minX&&E.minY<=g.minY&&g.maxX<=E.maxX&&g.maxY<=E.maxY}function M(E,g){return g.minX<=E.maxX&&g.minY<=E.maxY&&g.maxX>=E.minX&&g.maxY>=E.minY}function P(E){return{children:E,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Z(E,g,p,k,S){for(var N=[g,p];N.length;)if(p=N.pop(),g=N.pop(),!(p-g<=k)){var O=g+Math.ceil((p-g)/k/2)*k;e(E,O,g,p,S),N.push(g,O,O,p)}}return o})})(Yn);var pi=Yn.exports,b=function(r){return r.GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r}({}),Et=function(r){return r[r.ZERO=0]="ZERO",r[r.NEGATIVE_ONE=1]="NEGATIVE_ONE",r}({}),mi=function(){function r(){(0,D.Z)(this,r),this.plugins=[]}return(0,I.Z)(r,[{key:"addRenderingPlugin",value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)}},{key:"removeAllRenderingPlugins",value:function(){var e=this;this.plugins.forEach(function(t){var n=e.context.renderingPlugins.indexOf(t);n>=0&&e.context.renderingPlugins.splice(n,1)})}}])}(),yi=function(){function r(i){(0,D.Z)(this,r),this.clipSpaceNearZ=Et.NEGATIVE_ONE,this.plugins=[],this.config=(0,K.Z)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},i)}return(0,I.Z)(r,[{key:"registerPlugin",value:function(e){var t=this.plugins.findIndex(function(n){return n===e});t===-1&&this.plugins.push(e)}},{key:"unregisterPlugin",value:function(e){var t=this.plugins.findIndex(function(n){return n===e});t>-1&&this.plugins.splice(t,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(e){return this.plugins.find(function(t){return t.name===e})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){Object.assign(this.config,e)}}])}(),Wt=x.IH,Qe=x.JG,Ei=x.Fp,ki=x.VV,Wn=x.bA,zt=x.lu,de=function(){function r(){(0,D.Z)(this,r),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return(0,I.Z)(r,[{key:"update",value:function(e,t){Qe(this.center,e),Qe(this.halfExtents,t),zt(this.min,this.center,this.halfExtents),Wt(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(e,t){Wt(this.center,t,e),Wn(this.center,this.center,.5),zt(this.halfExtents,t,e),Wn(this.halfExtents,this.halfExtents,.5),Qe(this.min,e),Qe(this.max,t)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!r.isEmpty(e)){if(r.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,n=t[0],a=t[1],o=t[2],s=this.halfExtents,u=s[0],l=s[1],c=s[2],h=n-u,f=n+u,d=a-l,v=a+l,y=o-c,m=o+c,T=e.center,M=T[0],P=T[1],Z=T[2],E=e.halfExtents,g=E[0],p=E[1],k=E[2],S=M-g,N=M+g,O=P-p,L=P+p,B=Z-k,F=Z+k;S<h&&(h=S),N>f&&(f=N),O<d&&(d=O),L>v&&(v=L),B<y&&(y=B),F>m&&(m=F),t[0]=(h+f)*.5,t[1]=(d+v)*.5,t[2]=(y+m)*.5,s[0]=(f-h)*.5,s[1]=(v-d)*.5,s[2]=(m-y)*.5,this.min[0]=h,this.min[1]=d,this.min[2]=y,this.max[0]=f,this.max[1]=v,this.max[2]=m}}},{key:"setFromTransformedAABB",value:function(e,t){var n=this.center,a=this.halfExtents,o=e.center,s=e.halfExtents,u=t[0],l=t[4],c=t[8],h=t[1],f=t[5],d=t[9],v=t[2],y=t[6],m=t[10],T=Math.abs(u),M=Math.abs(l),P=Math.abs(c),Z=Math.abs(h),E=Math.abs(f),g=Math.abs(d),p=Math.abs(v),k=Math.abs(y),S=Math.abs(m);n[0]=t[12]+u*o[0]+l*o[1]+c*o[2],n[1]=t[13]+h*o[0]+f*o[1]+d*o[2],n[2]=t[14]+v*o[0]+y*o[1]+m*o[2],a[0]=T*s[0]+M*s[1]+P*s[2],a[1]=Z*s[0]+E*s[1]+g*s[2],a[2]=p*s[0]+k*s[1]+S*s[2],zt(this.min,n,a),Wt(this.max,n,a)}},{key:"intersects",value:function(e){var t=this.getMax(),n=this.getMin(),a=e.getMax(),o=e.getMin();return n[0]<=a[0]&&t[0]>=o[0]&&n[1]<=a[1]&&t[1]>=o[1]&&n[2]<=a[2]&&t[2]>=o[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var t=new r,n=Ei([0,0,0],this.getMin(),e.getMin()),a=ki([0,0,0],this.getMax(),e.getMax());return t.setMinMax(n,a),t}},{key:"getNegativeFarPoint",value:function(e){return e.pnVertexFlag===273?Qe([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(e){return e.pnVertexFlag===273?Qe([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0}}])}(),xi=function(){function r(i,e){(0,D.Z)(this,r),this.distance=i||0,this.normal=e||x.al(0,1,0),this.updatePNVertexFlag()}return(0,I.Z)(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(e){return x.AK(e,this.normal)-this.distance}},{key:"normalize",value:function(){var e=1/x.Zh(this.normal);x.bA(this.normal,this.normal,e),this.distance*=e}},{key:"intersectsLine",value:function(e,t,n){var a=this.distanceToPoint(e),o=this.distanceToPoint(t),s=a/(a-o),u=s>=0&&s<=1;return u&&n&&x.t7(n,e,t,s),u}}])}(),je=function(r){return r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE",r}({}),Ti=function(){function r(i){if((0,D.Z)(this,r),this.planes=[],i)this.planes=i;else for(var e=0;e<6;e++)this.planes.push(new xi)}return(0,I.Z)(r,[{key:"extractFromVPMatrix",value:function(e){var t=(0,re.Z)(e,16),n=t[0],a=t[1],o=t[2],s=t[3],u=t[4],l=t[5],c=t[6],h=t[7],f=t[8],d=t[9],v=t[10],y=t[11],m=t[12],T=t[13],M=t[14],P=t[15];x.t8(this.planes[0].normal,s-n,h-u,y-f),this.planes[0].distance=P-m,x.t8(this.planes[1].normal,s+n,h+u,y+f),this.planes[1].distance=P+m,x.t8(this.planes[2].normal,s+a,h+l,y+d),this.planes[2].distance=P+T,x.t8(this.planes[3].normal,s-a,h-l,y-d),this.planes[3].distance=P-T,x.t8(this.planes[4].normal,s-o,h-c,y-v),this.planes[4].distance=P-M,x.t8(this.planes[5].normal,s+o,h+c,y+v),this.planes[5].distance=P+M,this.planes.forEach(function(Z){Z.normalize(),Z.updatePNVertexFlag()})}}])}(),ve=function(){function r(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(0,D.Z)(this,r),this.x=0,this.y=0,this.x=i,this.y=e}return(0,I.Z)(r,[{key:"clone",value:function(){return new r(this.x,this.y)}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y}}])}(),qe=function(){function r(i,e,t,n){(0,D.Z)(this,r),this.x=i,this.y=e,this.width=t,this.height=n,this.left=i,this.right=i+t,this.top=e,this.bottom=e+n}return(0,I.Z)(r,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new r(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,t){var n=le.al(e.x,e.y,0,1),a=le.al(e.x+e.width,e.y,0,1),o=le.al(e.x,e.y+e.height,0,1),s=le.al(e.x+e.width,e.y+e.height,0,1),u=le.Ue(),l=le.Ue(),c=le.Ue(),h=le.Ue();le.fF(u,n,t),le.fF(l,a,t),le.fF(c,o,t),le.fF(h,s,t);var f=Math.min(u[0],l[0],c[0],h[0]),d=Math.min(u[1],l[1],c[1],h[1]),v=Math.max(u[0],l[0],c[0],h[0]),y=Math.max(u[1],l[1],c[1],h[1]);return r.fromRect({x:f,y:d,width:v-f,height:y-d})}}])}(),ee="Method not implemented.",et="Use document.documentElement instead.",Pi="Cannot append a destroyed element.";function kt(r){return r===void 0?0:r>360||r<-360?r%360:r}var Xt=x.Ue();function ye(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(r)&&r.length===3?t?x.d9(r):x.JG(Xt,r):(0,$e.Z)(r)?t?x.al(r,i,e):x.t8(Xt,r,i,e):t?x.al(r[0],r[1]||i,r[2]||e):x.t8(Xt,r[0],r[1]||i,r[2]||e)}var Mi=Math.PI/180;function j(r){return r*Mi}var Ci=180/Math.PI;function Me(r){return r*Ci}var Si=.9;function js(r){return r%=400,r<0&&(r+=400),r*Si}function qs(r){return r/360}function Ni(r){return 360*r}var xt=Math.PI/2;function wi(r,i){var e=i[0],t=i[1],n=i[2],a=i[3],o=e*e,s=t*t,u=n*n,l=a*a,c=o+s+u+l,h=e*a-t*n;return h>.499995*c?(r[0]=xt,r[1]=2*Math.atan2(t,e),r[2]=0):h<-.499995*c?(r[0]=-xt,r[1]=2*Math.atan2(t,e),r[2]=0):(r[0]=Math.asin(2*(e*n-a*t)),r[1]=Math.atan2(2*(e*a+t*n),1-2*(u+l)),r[2]=Math.atan2(2*(e*t+n*a),1-2*(s+u))),r}function Ai(r,i){var e,t,n=w.getScaling(x.Ue(),i),a=(0,re.Z)(n,3),o=a[0],s=a[1],u=a[2],l=Math.asin(-i[2]/o);return l<xt?l>-xt?(e=Math.atan2(i[6]/s,i[10]/u),t=Math.atan2(i[1]/o,i[0]/o)):(t=0,e=-Math.atan2(i[4]/s,i[5]/s)):(t=0,e=Math.atan2(i[4]/s,i[5]/s)),r[0]=e,r[1]=l,r[2]=t,r}function Vt(r,i){return i.length===16?Ai(r,i):wi(r,i)}function Ri(r,i,e,t,n){var a=Math.cos(r),o=Math.sin(r);return Ut.al(t*a,n*o,0,-t*o,n*a,0,i,e,1)}function Oi(r,i,e,t,n,a,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,u=2*a,l=e-i,c=t-n,h=u/l,f=u/c,d=(e+i)/l,v=(t+n)/c,y,m,T=o-a,M=o*a;return s?(y=-o/T,m=-M/T):(y=-(o+a)/T,m=-2*M/T),r[0]=h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=d,r[9]=v,r[10]=y,r[11]=-1,r[12]=0,r[13]=0,r[14]=m,r[15]=0,r}function zn(r){var i=r[0],e=r[1],t=r[3],n=r[4],a=Math.sqrt(i*i+e*e),o=Math.sqrt(t*t+n*n),s=i*n-e*t;if(s<0&&(i<n?a=-a:o=-o),a){var u=1/a;i*=u,e*=u}if(o){var l=1/o;t*=l,n*=l}var c=Math.atan2(e,i),h=Me(c);return[r[6],r[7],a,o,h]}var Oe=w.create(),Ne=w.create(),st=le.Ue(),Y=[x.Ue(),x.Ue(),x.Ue()],Xn=x.Ue();function Li(r,i,e,t,n,a){if(!Di(Oe,r)||(w.copy(Ne,Oe),Ne[3]=0,Ne[7]=0,Ne[11]=0,Ne[15]=1,Math.abs(w.determinant(Ne))<1e-8))return!1;var o=Oe[3],s=Oe[7],u=Oe[11],l=Oe[12],c=Oe[13],h=Oe[14],f=Oe[15];if(o!==0||s!==0||u!==0){st[0]=o,st[1]=s,st[2]=u,st[3]=f;var d=w.invert(Ne,Ne);if(!d)return!1;w.transpose(Ne,Ne),le.fF(n,st,Ne)}else n[0]=n[1]=n[2]=0,n[3]=1;if(i[0]=l,i[1]=c,i[2]=h,Ii(Y,Oe),e[0]=x.kE(Y[0]),x.Fv(Y[0],Y[0]),t[0]=x.AK(Y[0],Y[1]),Ht(Y[1],Y[1],Y[0],1,-t[0]),e[1]=x.kE(Y[1]),x.Fv(Y[1],Y[1]),t[0]/=e[1],t[1]=x.AK(Y[0],Y[2]),Ht(Y[2],Y[2],Y[0],1,-t[1]),t[2]=x.AK(Y[1],Y[2]),Ht(Y[2],Y[2],Y[1],1,-t[2]),e[2]=x.kE(Y[2]),x.Fv(Y[2],Y[2]),t[1]/=e[2],t[2]/=e[2],x.kC(Xn,Y[1],Y[2]),x.AK(Y[0],Xn)<0)for(var v=0;v<3;v++)e[v]*=-1,Y[v][0]*=-1,Y[v][1]*=-1,Y[v][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Y[0][0]-Y[1][1]-Y[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Y[0][0]+Y[1][1]-Y[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Y[0][0]-Y[1][1]+Y[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Y[0][0]+Y[1][1]+Y[2][2],0)),Y[2][1]>Y[1][2]&&(a[0]=-a[0]),Y[0][2]>Y[2][0]&&(a[1]=-a[1]),Y[1][0]>Y[0][1]&&(a[2]=-a[2]),!0}function Di(r,i){var e=i[15];if(e===0)return!1;for(var t=1/e,n=0;n<16;n++)r[n]=i[n]*t;return!0}function Ii(r,i){r[0][0]=i[0],r[0][1]=i[1],r[0][2]=i[2],r[1][0]=i[4],r[1][1]=i[5],r[1][2]=i[6],r[2][0]=i[8],r[2][1]=i[9],r[2][2]=i[10]}function Ht(r,i,e,t,n){r[0]=i[0]*t+e[0]*n,r[1]=i[1]*t+e[1]*n,r[2]=i[2]*t+e[2]*n}var se=function(r){return r[r.ORBITING=0]="ORBITING",r[r.EXPLORING=1]="EXPLORING",r[r.TRACKING=2]="TRACKING",r}({}),$t=function(r){return r[r.DEFAULT=0]="DEFAULT",r[r.ROTATIONAL=1]="ROTATIONAL",r[r.TRANSLATIONAL=2]="TRANSLATIONAL",r[r.CINEMATIC=3]="CINEMATIC",r}({}),Ce=function(r){return r[r.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",r[r.PERSPECTIVE=1]="PERSPECTIVE",r}({}),Vn={UPDATED:"updated"},Hn=2e-4,$n=function(){function r(){(0,D.Z)(this,r),this.clipSpaceNearZ=Et.NEGATIVE_ONE,this.eventEmitter=new Gt.Z,this.matrix=w.create(),this.right=x.al(1,0,0),this.up=x.al(0,1,0),this.forward=x.al(0,0,1),this.position=x.al(0,0,1),this.focalPoint=x.al(0,0,0),this.distanceVector=x.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=w.create(),this.projectionMatrixInverse=w.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=se.EXPLORING,this.trackingMode=$t.DEFAULT,this.projectionMode=Ce.PERSPECTIVE,this.frustum=new Ti,this.orthoMatrix=w.create()}return(0,I.Z)(r,[{key:"isOrtho",value:function(){return this.projectionMode===Ce.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e}},{key:"setType",value:function(e,t){return this.type=e,this.type===se.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===se.TRACKING&&t!==void 0&&this.setTrackingMode(t),this}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this}},{key:"setTrackingMode",value:function(e){if(this.type!==se.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this}},{key:"getViewTransform",value:function(){return w.invert(w.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(e,t){var n=w.fromTranslation(w.create(),[e,t,0]);this.jitteredProjectionMatrix=w.multiply(w.create(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:"setNear",value:function(e){return this.projectionMode===Ce.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this}},{key:"setFar",value:function(e){return this.projectionMode===Ce.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this}},{key:"setViewOffset",value:function(e,t,n,a,o,s){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=a,this.view.width=o,this.view.height=s,this.projectionMode===Ce.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ce.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===Ce.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ce.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(e,t){var n=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),a=n.x,o=n.y,s=this.roll;this.rotate(0,0,-s),this.setPosition(a,o),this.setFocalPoint(a,o),this.setZoom(e),this.rotate(0,0,s);var u=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=u.x,c=u.y,h=x.al(l-a,c-o,0),f=x.AK(h,this.right)/x.kE(this.right),d=x.AK(h,this.up)/x.kE(this.up),v=this.getPosition(),y=(0,re.Z)(v,2),m=y[0],T=y[1],M=this.getFocalPoint(),P=(0,re.Z)(M,2),Z=P[0],E=P[1];return this.setPosition(m-f,T-d),this.setFocalPoint(Z-f,E-d),this}},{key:"setPerspective",value:function(e,t,n,a){var o;this.projectionMode=Ce.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=a;var s=this.near*Math.tan(j(.5*this.fov))/this.zoom,u=2*s,l=this.aspect*u,c=-.5*l;if((o=this.view)!==null&&o!==void 0&&o.enabled){var h=this.view.fullWidth,f=this.view.fullHeight;c+=this.view.offsetX*l/h,s-=this.view.offsetY*u/f,l*=this.view.width/h,u*=this.view.height/f}return Oi(this.projectionMatrix,c,c+l,s-u,s,e,this.far,this.clipSpaceNearZ===Et.ZERO),w.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(e,t,n,a,o,s){var u;this.projectionMode=Ce.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=a,this.near=o,this.far=s;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),h=(this.rright+this.left)/2,f=(this.top+this.bottom)/2,d=h-l,v=h+l,y=f+c,m=f-c;if((u=this.view)!==null&&u!==void 0&&u.enabled){var T=(this.rright-this.left)/this.view.fullWidth/this.zoom,M=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=T*this.view.offsetX,v=d+T*this.view.width,y-=M*this.view.offsetY,m=y-M*this.view.height}return this.clipSpaceNearZ===Et.NEGATIVE_ONE?w.ortho(this.projectionMatrix,d,v,y,m,o,s):w.orthoZO(this.projectionMatrix,d,v,y,m,o,s),w.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],a=ye(e,t,n);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],a=x.al(0,1,0);if(this.focalPoint=ye(e,t,n),this.trackingMode===$t.CINEMATIC){var o=x.$X(x.Ue(),this.focalPoint,this.position);e=o[0],t=o[1],n=o[2];var s=x.kE(o),u=Me(Math.asin(t/s)),l=90+Me(Math.atan2(n,e)),c=w.create();w.rotateY(c,c,j(l)),w.rotateX(c,c,j(u)),a=x.fF(x.Ue(),[0,1,0],c)}return w.invert(this.matrix,w.lookAt(w.create(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<Hn&&(this.distance=Hn),this.dollyingStep=this.distance/100;var t=x.Ue();e=this.distance;var n=this.forward,a=this.focalPoint;return t[0]=e*n[0]+a[0],t[1]=e*n[1]+a[1],t[2]=e*n[2]+a[2],this._setPosition(t),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this}},{key:"setAzimuth",value:function(e){return this.azimuth=kt(e),this.computeMatrix(),this._getAxes(),this.type===se.ORBITING||this.type===se.EXPLORING?this._getPosition():this.type===se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(e){return this.elevation=kt(e),this.computeMatrix(),this._getAxes(),this.type===se.ORBITING||this.type===se.EXPLORING?this._getPosition():this.type===se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(e){return this.roll=kt(e),this.computeMatrix(),this._getAxes(),this.type===se.ORBITING||this.type===se.EXPLORING?this._getPosition():this.type===se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var e=V.yY(V.Ue(),[0,0,1],j(this.roll));w.identity(this.matrix);var t=V.yY(V.Ue(),[1,0,0],j((this.rotateWorld&&this.type!==se.TRACKING||this.type===se.TRACKING?1:-1)*this.elevation)),n=V.yY(V.Ue(),[0,1,0],j((this.rotateWorld&&this.type!==se.TRACKING||this.type===se.TRACKING?1:-1)*this.azimuth)),a=V.Jp(V.Ue(),n,t);a=V.Jp(V.Ue(),a,e);var o=w.fromQuat(w.create(),a);this.type===se.ORBITING||this.type===se.EXPLORING?(w.translate(this.matrix,this.matrix,this.focalPoint),w.multiply(this.matrix,this.matrix,o),w.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===se.TRACKING&&(w.translate(this.matrix,this.matrix,this.position),w.multiply(this.matrix,this.matrix,o))}},{key:"_setPosition",value:function(e,t,n){this.position=ye(e,t,n);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){x.JG(this.right,ye(le.fF(le.Ue(),[1,0,0,0],this.matrix))),x.JG(this.up,ye(le.fF(le.Ue(),[0,1,0,0],this.matrix))),x.JG(this.forward,ye(le.fF(le.Ue(),[0,0,1,0],this.matrix))),x.Fv(this.right,this.right),x.Fv(this.up,this.up),x.Fv(this.forward,this.forward)}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],a=x.kE(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===se.TRACKING?(this.elevation=Me(Math.asin(t/a)),this.azimuth=Me(Math.atan2(-e,-n))):this.rotateWorld?(this.elevation=Me(Math.asin(t/a)),this.azimuth=Me(Math.atan2(-e,-n))):(this.elevation=-Me(Math.asin(t/a)),this.azimuth=-Me(Math.atan2(-e,-n)))}},{key:"_getPosition",value:function(){x.JG(this.position,ye(le.fF(le.Ue(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){x.kK(this.distanceVector,[0,0,-this.distance],Ut.xO(Ut.Ue(),this.matrix)),x.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=x.$X(x.Ue(),this.focalPoint,this.position),this.distance=x.kE(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Ce.ORTHOGRAPHIC){var e=this.position,t=V.yY(V.Ue(),[0,0,1],-this.roll*Math.PI/180);w.fromRotationTranslationScaleOrigin(this.orthoMatrix,t,x.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),x.al(this.zoom,this.zoom,1),e)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),t=w.multiply(w.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(Vn.UPDATED)}}},{key:"rotate",value:function(e,t,n){throw new Error(ee)}},{key:"pan",value:function(e,t){throw new Error(ee)}},{key:"dolly",value:function(e){throw new Error(ee)}},{key:"createLandmark",value:function(e,t){throw new Error(ee)}},{key:"gotoLandmark",value:function(e,t){throw new Error(ee)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(ee)}}])}(),bi=function(r){return r[r.Standard=0]="Standard",r}({}),Tt=function(r){return r[r.ADDED=0]="ADDED",r[r.REMOVED=1]="REMOVED",r[r.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",r}({}),Kn={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new qe(0,0,0,0)},A=function(r){return r.COORDINATE="<coordinate>",r.COLOR="<color>",r.PAINT="<paint>",r.NUMBER="<number>",r.ANGLE="<angle>",r.OPACITY_VALUE="<opacity-value>",r.SHADOW_BLUR="<shadow-blur>",r.LENGTH="<length>",r.PERCENTAGE="<percentage>",r.LENGTH_PERCENTAGE="<length> | <percentage>",r.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",r.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",r.LIST_OF_POINTS="<list-of-points>",r.PATH="<path>",r.FILTER="<filter>",r.Z_INDEX="<z-index>",r.OFFSET_DISTANCE="<offset-distance>",r.DEFINED_PATH="<defined-path>",r.MARKER="<marker>",r.TRANSFORM="<transform>",r.TRANSFORM_ORIGIN="<transform-origin>",r.TEXT="<text>",r.TEXT_TRANSFORM="<text-transform>",r}({});function Ee(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError("Expected a function");var e=function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i?i.apply(this,a):a[0],u=e.cache;if(u.has(s))return u.get(s);var l=r.apply(this,a);return e.cache=u.set(s,l)||u,l};return e.cache=new(Ee.Cache||Map),e}Ee.Cache=Map;var R=function(r){return r[r.kUnknown=0]="kUnknown",r[r.kNumber=1]="kNumber",r[r.kPercentage=2]="kPercentage",r[r.kEms=3]="kEms",r[r.kPixels=4]="kPixels",r[r.kRems=5]="kRems",r[r.kDegrees=6]="kDegrees",r[r.kRadians=7]="kRadians",r[r.kGradians=8]="kGradians",r[r.kTurns=9]="kTurns",r[r.kMilliseconds=10]="kMilliseconds",r[r.kSeconds=11]="kSeconds",r[r.kInteger=12]="kInteger",r}({}),we=function(r){return r[r.kUNumber=0]="kUNumber",r[r.kUPercent=1]="kUPercent",r[r.kULength=2]="kULength",r[r.kUAngle=3]="kUAngle",r[r.kUTime=4]="kUTime",r[r.kUOther=5]="kUOther",r}({}),_i=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),Zi=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),Bi=[{name:"em",unit_type:R.kEms},{name:"px",unit_type:R.kPixels},{name:"deg",unit_type:R.kDegrees},{name:"rad",unit_type:R.kRadians},{name:"grad",unit_type:R.kGradians},{name:"ms",unit_type:R.kMilliseconds},{name:"s",unit_type:R.kSeconds},{name:"rem",unit_type:R.kRems},{name:"turn",unit_type:R.kTurns}],tt=function(r){return r[r.kUnknownType=0]="kUnknownType",r[r.kUnparsedType=1]="kUnparsedType",r[r.kKeywordType=2]="kKeywordType",r[r.kUnitType=3]="kUnitType",r[r.kSumType=4]="kSumType",r[r.kProductType=5]="kProductType",r[r.kNegateType=6]="kNegateType",r[r.kInvertType=7]="kInvertType",r[r.kMinType=8]="kMinType",r[r.kMaxType=9]="kMaxType",r[r.kClampType=10]="kClampType",r[r.kTransformType=11]="kTransformType",r[r.kPositionType=12]="kPositionType",r[r.kURLImageType=13]="kURLImageType",r[r.kColorType=14]="kColorType",r[r.kUnsupportedColorType=15]="kUnsupportedColorType",r}({}),Fi=function(i){return Bi.find(function(e){return e.name===i}).unit_type},Gi=function(i){return i?i==="number"?R.kNumber:i==="percent"||i==="%"?R.kPercentage:Fi(i):R.kUnknown},Ui=function(i){switch(i){case R.kNumber:case R.kInteger:return we.kUNumber;case R.kPercentage:return we.kUPercent;case R.kPixels:return we.kULength;case R.kMilliseconds:case R.kSeconds:return we.kUTime;case R.kDegrees:case R.kRadians:case R.kGradians:case R.kTurns:return we.kUAngle;default:return we.kUOther}},Yi=function(i){switch(i){case we.kUNumber:return R.kNumber;case we.kULength:return R.kPixels;case we.kUPercent:return R.kPercentage;case we.kUTime:return R.kSeconds;case we.kUAngle:return R.kDegrees;default:return R.kUnknown}},Jn=function(i){var e=1;switch(i){case R.kPixels:case R.kDegrees:case R.kSeconds:break;case R.kMilliseconds:e=.001;break;case R.kRadians:e=180/Math.PI;break;case R.kGradians:e=.9;break;case R.kTurns:e=360;break}return e},Kt=function(i){switch(i){case R.kNumber:case R.kInteger:return"";case R.kPercentage:return"%";case R.kEms:return"em";case R.kRems:return"rem";case R.kPixels:return"px";case R.kDegrees:return"deg";case R.kRadians:return"rad";case R.kGradians:return"grad";case R.kMilliseconds:return"ms";case R.kSeconds:return"s";case R.kTurns:return"turn"}return""},Pt=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"toString",value:function(){return this.buildCSSText(_i.kNo,Zi.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=tt.kUnitType&&this.getType()<=tt.kClampType}}],[{key:"isAngle",value:function(e){return e===R.kDegrees||e===R.kRadians||e===R.kGradians||e===R.kTurns}},{key:"isLength",value:function(e){return e>=R.kEms&&e<R.kDegrees}},{key:"isRelativeUnit",value:function(e){return e===R.kPercentage||e===R.kEms||e===R.kRems}},{key:"isTime",value:function(e){return e===R.kSeconds||e===R.kMilliseconds}}])}(),Wi=function(r){function i(e){var t;return(0,D.Z)(this,i),t=(0,J.Z)(this,i),t.colorSpace=e,t}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"getType",value:function(){return tt.kColorType}},{key:"to",value:function(t){return this}}])}(Pt),ut=function(r){return r[r.Constant=0]="Constant",r[r.LinearGradient=1]="LinearGradient",r[r.RadialGradient=2]="RadialGradient",r}({}),Mt=function(r){function i(e,t){var n;return(0,D.Z)(this,i),n=(0,J.Z)(this,i),n.type=e,n.value=t,n}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"clone",value:function(){return new i(this.type,this.value)}},{key:"buildCSSText",value:function(t,n,a){return a}},{key:"getType",value:function(){return tt.kColorType}}])}(Pt),Se=function(r){function i(e){var t;return(0,D.Z)(this,i),t=(0,J.Z)(this,i),t.value=e,t}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"clone",value:function(){return new i(this.value)}},{key:"getType",value:function(){return tt.kKeywordType}},{key:"buildCSSText",value:function(t,n,a){return a+this.value}}])}(Pt),zi=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t="";return Number.isFinite(i)?t="NaN":i>0?t="infinity":t="-infinity",t+=e},Jt=function(i){return Yi(Ui(i))},$=function(r){function i(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R.kNumber;(0,D.Z)(this,i),t=(0,J.Z)(this,i);var a;return typeof n=="string"?a=Gi(n):a=n,t.unit=a,t.value=e,t}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"clone",value:function(){return new i(this.value,this.unit)}},{key:"equals",value:function(t){var n=t;return this.value===n.value&&this.unit===n.unit}},{key:"getType",value:function(){return tt.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new i(this.value,this.unit);var n=Jt(this.unit);if(n!==Jt(t)||n===R.kUnknown)return null;var a=Jn(this.unit)/Jn(t);return new i(this.value*a,t)}},{key:"buildCSSText",value:function(t,n,a){var o;switch(this.unit){case R.kUnknown:break;case R.kInteger:o=Number(this.value).toFixed(0);break;case R.kNumber:case R.kPercentage:case R.kEms:case R.kRems:case R.kPixels:case R.kDegrees:case R.kRadians:case R.kGradians:case R.kMilliseconds:case R.kSeconds:case R.kTurns:{var s=-999999,u=999999,l=this.value,c=Kt(this.unit);if(l<s||l>u){var h=Kt(this.unit);!Number.isFinite(l)||Number.isNaN(l)?o=zi(l,h):o=l+(h||"")}else o="".concat(l).concat(c)}}return a+=o,a}}])}(Pt),Ae=new $(0,"px");new $(1,"px");var Ye=new $(0,"deg"),Qt=function(r){function i(e,t,n){var a,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(0,D.Z)(this,i),a=(0,J.Z)(this,i,["rgb"]),a.r=e,a.g=t,a.b=n,a.alpha=o,a.isNone=s,a}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"clone",value:function(){return new i(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,n,a){return"".concat(a,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(Wi),Qn=new Se("unset"),Xi=new Se("initial"),Vi=new Se("inherit"),jt={"":Qn,unset:Qn,initial:Xi,inherit:Vi},Hi=function(i){return jt[i]||(jt[i]=new Se(i)),jt[i]},jn=new Qt(0,0,0,0,!0),qn=new Qt(0,0,0,0),$i=Ee(function(r,i,e,t){return new Qt(r,i,e,t)},function(r,i,e,t){return"rgba(".concat(r,",").concat(i,",").concat(e,",").concat(t,")")}),te=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R.kNumber;return new $(i,e)};new $(50,"%");function Ki(r){var i=r.type,e=r.value;return i==="hex"?"#".concat(e):i==="literal"?e:i==="rgb"?"rgb(".concat(e.join(","),")"):"rgba(".concat(e.join(","),")")}var Ji=function(){var r={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},i="";function e(_){throw new Error("".concat(i,": ").concat(_))}function t(){var _=n();return i.length>0&&e("Invalid input not EOF"),_}function n(){return P(a)}function a(){return o("linear-gradient",r.linearGradient,u)||o("repeating-linear-gradient",r.repeatingLinearGradient,u)||o("radial-gradient",r.radialGradient,h)||o("repeating-radial-gradient",r.repeatingRadialGradient,h)||o("conic-gradient",r.conicGradient,h)}function o(_,W,X){return s(W,function(pe){var me=X();return me&&(G(r.comma)||e("Missing comma before color stops")),{type:_,orientation:me,colorStops:P(Z)}})}function s(_,W){var X=G(_);if(X){G(r.startCall)||e("Missing (");var pe=W(X);return G(r.endCall)||e("Missing )"),pe}}function u(){return l()||c()}function l(){return F("directional",r.sideOrCorner,1)}function c(){return F("angular",r.angleValue,1)}function h(){var _,W=f(),X;return W&&(_=[],_.push(W),X=i,G(r.comma)&&(W=f(),W?_.push(W):i=X)),_}function f(){var _=d()||v();if(_)_.at=m();else{var W=y();if(W){_=W;var X=m();X&&(_.at=X)}else{var pe=T();pe&&(_={type:"default-radial",at:pe})}}return _}function d(){var _=F("shape",/^(circle)/i,0);return _&&(_.style=B()||y()),_}function v(){var _=F("shape",/^(ellipse)/i,0);return _&&(_.style=O()||y()),_}function y(){return F("extent-keyword",r.extentKeywords,1)}function m(){if(F("position",/^at/,0)){var _=T();return _||e("Missing positioning value"),_}}function T(){var _=M();if(_.x||_.y)return{type:"position",value:_}}function M(){return{x:O(),y:O()}}function P(_){var W=_(),X=[];if(W)for(X.push(W);G(r.comma);)W=_(),W?X.push(W):e("One extra comma");return X}function Z(){var _=E();return _||e("Expected color definition"),_.length=O(),_}function E(){return p()||S()||k()||g()}function g(){return F("literal",r.literalColor,0)}function p(){return F("hex",r.hexColor,1)}function k(){return s(r.rgbColor,function(){return{type:"rgb",value:P(N)}})}function S(){return s(r.rgbaColor,function(){return{type:"rgba",value:P(N)}})}function N(){return G(r.number)[1]}function O(){return F("%",r.percentageValue,1)||L()||B()}function L(){return F("position-keyword",r.positionKeywords,1)}function B(){return F("px",r.pixelValue,1)||F("em",r.emValue,1)}function F(_,W,X){var pe=G(W);if(pe)return{type:_,value:pe[X]}}function G(_){var W=/^[\n\r\t\s]+/.exec(i);W&&z(W[0].length);var X=_.exec(i);return X&&z(X[0].length),X}function z(_){i=i.substring(_)}return function(_){return i=_,t()}}();function Qi(r,i,e,t){var n=j(t.value),a=0,o=0,s=a+i/2,u=o+e/2,l=Math.abs(i*Math.cos(n))+Math.abs(e*Math.sin(n)),c=r[0]+s-Math.cos(n)*l/2,h=r[1]+u-Math.sin(n)*l/2,f=r[0]+s+Math.cos(n)*l/2,d=r[1]+u+Math.sin(n)*l/2;return{x1:c,y1:h,x2:f,y2:d}}function ji(r,i,e,t,n,a){var o=t.value,s=n.value;t.unit===R.kPercentage&&(o=t.value/100*i),n.unit===R.kPercentage&&(s=n.value/100*e);var u=Math.max((0,_e.y)([0,0],[o,s]),(0,_e.y)([0,e],[o,s]),(0,_e.y)([i,e],[o,s]),(0,_e.y)([i,0],[o,s]));return a&&(a instanceof $?u=a.value:a instanceof Se&&(a.value==="closest-side"?u=Math.min(o,i-o,s,e-s):a.value==="farthest-side"?u=Math.max(o,i-o,s,e-s):a.value==="closest-corner"&&(u=Math.min((0,_e.y)([0,0],[o,s]),(0,_e.y)([0,e],[o,s]),(0,_e.y)([i,e],[o,s]),(0,_e.y)([i,0],[o,s]))))),{x:o+r[0],y:s+r[1],r:u}}var qi=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,ea=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ta=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,er=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function na(r){var i,e=r.length;if(r[e-1].length=(i=r[e-1].length)!==null&&i!==void 0?i:{type:"%",value:"100"},e>1){var t;r[0].length=(t=r[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"}}for(var n=0,a=Number(r[0].length.value),o=1;o<e;o++){var s,u=(s=r[o].length)===null||s===void 0?void 0:s.value;if(!(0,fe.Z)(u)&&!(0,fe.Z)(a)){for(var l=1;l<o-n;l++)r[n+l].length={type:"%",value:"".concat(a+(Number(u)-a)*l/(o-n))};n=o,a=Number(u)}}}var ra={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},ia=Ee(function(r){var i;return r.type==="angular"?i=Number(r.value):i=ra[r.value]||0,te(i,"deg")}),aa=Ee(function(r){var i=50,e=50,t="%",n="%";if((r==null?void 0:r.type)==="position"){var a=r.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?i=0:o.value==="center"?i=50:o.value==="right"?i=100:o.value==="top"?e=0:o.value==="bottom"&&(e=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?i=0:s.value==="center"?e=50:s.value==="right"?i=100:s.value==="top"?e=0:s.value==="bottom"&&(e=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(t=o==null?void 0:o.type,i=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(n=s==null?void 0:s.type,e=Number(s.value))}return{cx:te(i,t),cy:te(e,n)}}),oa=Ee(function(r){if(r.indexOf("linear")>-1||r.indexOf("radial")>-1){var i=Ji(r);return i.map(function(s){var u=s.type,l=s.orientation,c=s.colorStops;na(c);var h=c.map(function(P){return{offset:te(Number(P.length.value),"%"),color:Ki(P)}});if(u==="linear-gradient")return new Mt(ut.LinearGradient,{angle:l?ia(l):Ye,steps:h});if(u==="radial-gradient"&&(l||(l=[{type:"shape",value:"circle"}]),l[0].type==="shape"&&l[0].value==="circle")){var f=aa(l[0].at),d=f.cx,v=f.cy,y;if(l[0].style){var m=l[0].style,T=m.type,M=m.value;T==="extent-keyword"?y=Hi(M):y=te(M,T)}return new Mt(ut.RadialGradient,{cx:d,cy:v,size:y,steps:h})}})}var e=r[0];if(r[1]==="("||r[2]==="("){if(e==="l"){var t=qi.exec(r);if(t){var n,a=((n=t[2].match(er))===null||n===void 0?void 0:n.map(function(s){return s.split(":")}))||[];return[new Mt(ut.LinearGradient,{angle:te(parseFloat(t[1]),"deg"),steps:a.map(function(s){var u=(0,re.Z)(s,2),l=u[0],c=u[1];return{offset:te(Number(l)*100,"%"),color:c}})})]}}else if(e==="r"){var o=sa(r);if(o)if((0,Ge.Z)(o))r=o;else return[new Mt(ut.RadialGradient,o)]}else if(e==="p")return ua(r)}});function sa(r){var i=ea.exec(r);if(i){var e,t=((e=i[4].match(er))===null||e===void 0?void 0:e.map(function(n){return n.split(":")}))||[];return{cx:te(50,"%"),cy:te(50,"%"),steps:t.map(function(n){var a=(0,re.Z)(n,2),o=a[0],s=a[1];return{offset:te(Number(o)*100,"%"),color:s}})}}return null}function ua(r){var i=ta.exec(r);if(i){var e=i[1],t=i[2];switch(e){case"a":e="repeat";break;case"x":e="repeat-x";break;case"y":e="repeat-y";break;case"n":e="no-repeat";break;default:e="no-repeat"}return{image:t,repetition:e}}return null}function eu(r){return!!r.type&&!!r.value}function tr(r){return r&&!!r.image}function qt(r){return r&&!(0,fe.Z)(r.r)&&!(0,fe.Z)(r.g)&&!(0,fe.Z)(r.b)}var nt=Ee(function(r){if(tr(r))return(0,K.Z)({repetition:"repeat"},r);if((0,fe.Z)(r)&&(r=""),r==="transparent")return qn;if(r==="currentColor")r="black";else if(r==="none")return jn;var i=oa(r);if(i)return i;var e=di.ZP(r),t=[0,0,0,0];return e!==null&&(t[0]=e.r||0,t[1]=e.g||0,t[2]=e.b||0,t[3]=e.opacity),$i.apply(void 0,t)});function la(r,i){if(!(!qt(r)||!qt(i)))return[[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],[Number(i.r),Number(i.g),Number(i.b),Number(i.alpha)],function(e){var t=e.slice();if(t[3])for(var n=0;n<3;n++)t[n]=Math.round((0,at.Z)(t[n],0,255));return t[3]=(0,at.Z)(t[3],0,1),"rgba(".concat(t.join(","),")")}]}function lt(r,i){if((0,fe.Z)(i))return te(0,"px");if(i="".concat(i).trim().toLowerCase(),isFinite(Number(i))){if("px".search(r)>=0)return te(Number(i),"px");if("deg".search(r)>=0)return te(Number(i),"deg")}var e=[];i=i.replace(r,function(n){return e.push(n),"U".concat(n)});var t="U(".concat(r.source,")");return e.map(function(n){return te(Number(i.replace(new RegExp("U".concat(n),"g"),"").replace(new RegExp(t,"g"),"*0")),n)})[0]}var nr=function(i){return lt(new RegExp("px","g"),i)},ca=Ee(nr),ha=function(i){return lt(new RegExp("%","g"),i)};Ee(ha);var rr=function(i){return(0,$e.Z)(i)||isFinite(Number(i))?te(Number(i)||0,"px"):lt(new RegExp("px|%|em|rem","g"),i)},en=Ee(rr),ir=function(i){return lt(new RegExp("deg|rad|grad|turn","g"),i)},fa=Ee(ir);function va(r,i,e,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a="",o=r.value||0,s=i.value||0,u=Jt(r.unit),l=r.convertTo(u),c=i.convertTo(u);return l&&c?(o=l.value,s=c.value,a=Kt(r.unit)):($.isLength(r.unit)||$.isLength(i.unit))&&(o=Pe(r,n,e),s=Pe(i,n,e),a="px"),[o,s,function(h){return t&&(h=Math.max(h,0)),h+a}]}function xe(r){var i=0;return r.unit===R.kDegrees?i=r.value:r.unit===R.kRadians?i=Me(Number(r.value)):r.unit===R.kTurns?i=Ni(Number(r.value)):r.value&&(i=r.value),i}function ar(r,i){var e;return Array.isArray(r)?e=r.map(function(t){return Number(t)}):(0,Ge.Z)(r)?e=r.split(" ").map(function(t){return Number(t)}):(0,$e.Z)(r)&&(e=[r]),i===2?e.length===1?[e[0],e[0]]:[e[0],e[1]]:e.length===1?[e[0],e[0],e[0],e[0]]:e.length===2?[e[0],e[1],e[0],e[1]]:e.length===3?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]}function Pe(r,i,e){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(r.unit===R.kPixels)return Number(r.value);if(r.unit===R.kPercentage&&e){var n=e.nodeName===b.GROUP?e.getLocalBounds():e.getGeometryBounds();return(t?n.min[i]:0)+r.value/100*n.halfExtents[i]*2}return 0}var da=function(i){return lt(/deg|rad|grad|turn|px|%/g,i)},ga=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function pa(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(r=r.toLowerCase().trim(),r==="none")return[];for(var i=/\s*([\w-]+)\(([^)]*)\)/g,e=[],t,n=0;t=i.exec(r);){if(t.index!==n)return[];if(n=t.index+t[0].length,ga.indexOf(t[1])>-1&&e.push({name:t[1],params:t[2].split(" ").map(function(a){return da(a)||nt(a)})}),i.lastIndex===r.length)return e}return[]}function or(r){return r.toString()}var sr=function(i){return typeof i=="number"?te(i):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(i)?te(Number(i)):te(0)},tn=Ee(sr);Ee(function(r){return(0,Ge.Z)(r)?r.split(" ").map(tn):r.map(tn)});function nn(r,i){return[r,i,or]}function rn(r,i){return function(e,t){return[e,t,function(n){return or((0,at.Z)(n,r,i))}]}}function ur(r,i){if(r.length===i.length)return[r,i,function(e){return e}]}function an(r){return r.parsedStyle.d.totalLength===0&&(r.parsedStyle.d.totalLength=(0,ai.D)(r.parsedStyle.d.absolutePath)),r.parsedStyle.d.totalLength}function ma(r){return r.parsedStyle.points.totalLength===0&&(r.parsedStyle.points.totalLength=(0,Ze.hE)(r.parsedStyle.points.points)),r.parsedStyle.points.totalLength}function ya(r){for(var i=0;i<r.length;i++){var e=r[i-1],t=r[i],n=t[0];if(n==="M"&&e){var a=e[0],o=[t[1],t[2]],s=void 0;a==="L"||a==="M"?s=[e[1],e[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[e[e.length-2],e[e.length-1]]),s&&Ct(o,s)&&(r.splice(i,1),i--)}}}function Ea(r){for(var i=!1,e=r.length,t=0;t<e;t++){var n=r[t],a=n[0];if(a==="C"||a==="A"||a==="Q"){i=!0;break}}return i}function ka(r){for(var i=[],e=[],t=[],n=0;n<r.length;n++){var a=r[n],o=a[0];o==="M"?(t.length&&(e.push(t),t=[]),t.push([a[1],a[2]])):o==="Z"?t.length&&(i.push(t),t=[]):t.push([a[1],a[2]])}return t.length>0&&e.push(t),{polygons:i,polylines:e}}function Ct(r,i){return r[0]===i[0]&&r[1]===i[1]}function xa(r,i){for(var e=[],t=[],n=[],a=0;a<r.length;a++){var o=r[a],s=o.currentPoint,u=o.params,l=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,Ze.x4)(l[0],l[1],u[1],u[2],u[3],u[4]);break;case"C":c=(0,Ze.l5)(l[0],l[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var h=o.arcParams;c=(0,Ze.vp)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:e.push(s[0]),t.push(s[1]);break}c&&(o.box=c,e.push(c.x,c.x+c.width),t.push(c.y,c.y+c.height)),i&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&n.push(o)}e=e.filter(function(Z){return!Number.isNaN(Z)&&Z!==1/0&&Z!==-1/0}),t=t.filter(function(Z){return!Number.isNaN(Z)&&Z!==1/0&&Z!==-1/0});var f=(0,In.Z)(e),d=(0,In.Z)(t),v=(0,bn.Z)(e),y=(0,bn.Z)(t);if(n.length===0)return{x:f,y:d,width:v-f,height:y-d};for(var m=0;m<n.length;m++){var T=n[m],M=T.currentPoint,P=void 0;M[0]===f?(P=St(T,i),f-=P.xExtra):M[0]===v&&(P=St(T,i),v+=P.xExtra),M[1]===d?(P=St(T,i),d-=P.yExtra):M[1]===y&&(P=St(T,i),y+=P.yExtra)}return{x:f,y:d,width:v-f,height:y-d}}function St(r,i){var e=r.prePoint,t=r.currentPoint,n=r.nextPoint,a=Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2),o=Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2),s=Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2),u=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!u||Math.sin(u)===0||(0,oi.Z)(u,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(n[1]-t[1],n[0]-t[0])),c=Math.abs(Math.atan2(n[0]-t[0],n[1]-t[1]));l=l>Math.PI/2?Math.PI-l:l,c=c>Math.PI/2?Math.PI-c:c;var h={xExtra:Math.cos(u/2-l)*(i/2*(1/Math.sin(u/2)))-i/2||0,yExtra:Math.cos(c-u/2)*(i/2*(1/Math.sin(u/2)))-i/2||0};return h}function lr(r,i){return[i[0]+(i[0]-r[0]),i[1]+(i[1]-r[1])]}var cr=function(i,e){var t=i.x*e.x+i.y*e.y,n=Math.sqrt((Math.pow(i.x,2)+Math.pow(i.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),a=i.x*e.y-i.y*e.x<0?-1:1,o=a*Math.acos(t/n);return o},hr=function(i,e,t,n,a,o,s,u){e=Math.abs(e),t=Math.abs(t),n=(0,_n.Z)(n,360);var l=j(n);if(i.x===s.x&&i.y===s.y)return{x:i.x,y:i.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(i.x-s.x)/2,h=(i.y-s.y)/2,f={x:Math.cos(l)*c+Math.sin(l)*h,y:-Math.sin(l)*c+Math.cos(l)*h},d=Math.pow(f.x,2)/Math.pow(e,2)+Math.pow(f.y,2)/Math.pow(t,2);d>1&&(e*=Math.sqrt(d),t*=Math.sqrt(d));var v=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(f.y,2)-Math.pow(t,2)*Math.pow(f.x,2),y=Math.pow(e,2)*Math.pow(f.y,2)+Math.pow(t,2)*Math.pow(f.x,2),m=v/y;m=m<0?0:m;var T=(a!==o?1:-1)*Math.sqrt(m),M={x:T*(e*f.y/t),y:T*(-(t*f.x)/e)},P={x:Math.cos(l)*M.x-Math.sin(l)*M.y+(i.x+s.x)/2,y:Math.sin(l)*M.x+Math.cos(l)*M.y+(i.y+s.y)/2},Z={x:(f.x-M.x)/e,y:(f.y-M.y)/t},E=cr({x:1,y:0},Z),g={x:(-f.x-M.x)/e,y:(-f.y-M.y)/t},p=cr(Z,g);!o&&p>0?p-=2*Math.PI:o&&p<0&&(p+=2*Math.PI),p%=2*Math.PI;var k=E+p*u,S=e*Math.cos(k),N=t*Math.sin(k),O={x:Math.cos(l)*S-Math.sin(l)*N+P.x,y:Math.sin(l)*S+Math.cos(l)*N+P.y,ellipticalArcStartAngle:E,ellipticalArcEndAngle:E+p,ellipticalArcAngle:k,ellipticalArcCenter:P,resultantRx:e,resultantRy:t};return O};function Ta(r){for(var i=[],e=null,t=null,n=null,a=0,o=r.length,s=0;s<o;s++){var u=r[s];t=r[s+1];var l=u[0],c={command:l,prePoint:e,params:u,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(l){case"M":n=[u[1],u[2]],a=s;break;case"A":var h=Pa(e,u);c.arcParams=h;break}if(l==="Z")e=n,t=r[a+1];else{var f=u.length;e=[u[f-2],u[f-1]]}t&&t[0]==="Z"&&(t=r[a],i[a]&&(i[a].prePoint=e)),c.currentPoint=e,i[a]&&Ct(e,i[a].currentPoint)&&(i[a].prePoint=c.prePoint);var d=t?[t[t.length-2],t[t.length-1]]:null;c.nextPoint=d;var v=c.prePoint;if(["L","H","V"].includes(l))c.startTangent=[v[0]-e[0],v[1]-e[1]],c.endTangent=[e[0]-v[0],e[1]-v[1]];else if(l==="Q"){var y=[u[1],u[2]];c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[e[0]-y[0],e[1]-y[1]]}else if(l==="T"){var m=i[s-1],T=lr(m.currentPoint,v);m.command==="Q"?(c.command="Q",c.startTangent=[v[0]-T[0],v[1]-T[1]],c.endTangent=[e[0]-T[0],e[1]-T[1]]):(c.command="TL",c.startTangent=[v[0]-e[0],v[1]-e[1]],c.endTangent=[e[0]-v[0],e[1]-v[1]])}else if(l==="C"){var M=[u[1],u[2]],P=[u[3],u[4]];c.startTangent=[v[0]-M[0],v[1]-M[1]],c.endTangent=[e[0]-P[0],e[1]-P[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[M[0]-P[0],M[1]-P[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[P[0]-M[0],P[1]-M[1]])}else if(l==="S"){var Z=i[s-1],E=lr(Z.currentPoint,v),g=[u[1],u[2]];Z.command==="C"?(c.command="C",c.startTangent=[v[0]-E[0],v[1]-E[1]],c.endTangent=[e[0]-g[0],e[1]-g[1]]):(c.command="SQ",c.startTangent=[v[0]-g[0],v[1]-g[1]],c.endTangent=[e[0]-g[0],e[1]-g[1]])}else if(l==="A"){var p=fr(c,0),k=p.x,S=p.y,N=fr(c,1,!1),O=N.x,L=N.y;c.startTangent=[k,S],c.endTangent=[O,L]}i.push(c)}return i}function fr(r,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,t=r.arcParams,n=t.rx,a=n===void 0?0:n,o=t.ry,s=o===void 0?0:o,u=t.xRotation,l=t.arcFlag,c=t.sweepFlag,h=hr({x:r.prePoint[0],y:r.prePoint[1]},a,s,u,!!l,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},i),f=hr({x:r.prePoint[0],y:r.prePoint[1]},a,s,u,!!l,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},e?i+.005:i-.005),d=f.x-h.x,v=f.y-h.y,y=Math.sqrt(d*d+v*v);return{x:-d/y,y:-v/y}}function Nt(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function on(r,i){return Nt(r)*Nt(i)?(r[0]*i[0]+r[1]*i[1])/(Nt(r)*Nt(i)):1}function vr(r,i){return(r[0]*i[1]<r[1]*i[0]?-1:1)*Math.acos(on(r,i))}function Pa(r,i){var e=i[1],t=i[2],n=(0,_n.Z)(j(i[3]),Math.PI*2),a=i[4],o=i[5],s=r[0],u=r[1],l=i[6],c=i[7],h=Math.cos(n)*(s-l)/2+Math.sin(n)*(u-c)/2,f=-1*Math.sin(n)*(s-l)/2+Math.cos(n)*(u-c)/2,d=h*h/(e*e)+f*f/(t*t);d>1&&(e*=Math.sqrt(d),t*=Math.sqrt(d));var v=e*e*(f*f)+t*t*(h*h),y=v?Math.sqrt((e*e*(t*t)-v)/v):1;a===o&&(y*=-1),isNaN(y)&&(y=0);var m=t?y*e*f/t:0,T=e?y*-t*h/e:0,M=(s+l)/2+Math.cos(n)*m-Math.sin(n)*T,P=(u+c)/2+Math.sin(n)*m+Math.cos(n)*T,Z=[(h-m)/e,(f-T)/t],E=[(-1*h-m)/e,(-1*f-T)/t],g=vr([1,0],Z),p=vr(Z,E);return on(Z,E)<=-1&&(p=Math.PI),on(Z,E)>=1&&(p=0),o===0&&p>0&&(p-=2*Math.PI),o===1&&p<0&&(p+=2*Math.PI),{cx:M,cy:P,rx:Ct(r,[l,c])?0:e,ry:Ct(r,[l,c])?0:t,startAngle:g,endAngle:g+p,xRotation:n,arcFlag:a,sweepFlag:o}}function Ma(r,i,e){return r.reduce(function(t,n){var a="";if(n[0]==="M"||n[0]==="L"){var o=x.al(n[1],n[2],0);e&&x.fF(o,o,e),a="".concat(n[0]).concat(o[0],",").concat(o[1])}else if(n[0]==="Z")a=n[0];else if(n[0]==="C"){var s=x.al(n[1],n[2],0),u=x.al(n[3],n[4],0),l=x.al(n[5],n[6],0);e&&(x.fF(s,s,e),x.fF(u,u,e),x.fF(l,l,e)),a="".concat(n[0]).concat(s[0],",").concat(s[1],",").concat(u[0],",").concat(u[1],",").concat(l[0],",").concat(l[1])}else if(n[0]==="A"){var c=x.al(n[6],n[7],0);e&&x.fF(c,c,e),a="".concat(n[0]).concat(n[1],",").concat(n[2],",").concat(n[3],",").concat(n[4],",").concat(n[5],",").concat(c[0],",").concat(c[1])}else if(n[0]==="Q"){var h=x.al(n[1],n[2],0),f=x.al(n[3],n[4],0);e&&(x.fF(h,h,e),x.fF(f,f,e)),a="".concat(n[0]).concat(n[1],",").concat(n[2],",").concat(n[3],",").concat(n[4],"}")}return t+=a},"")}function Ca(r,i,e,t){return[["M",r,i],["L",e,t]]}function dr(r,i,e,t){var n=(-1+Math.sqrt(2))/3*4,a=r*n,o=i*n,s=e-r,u=e+r,l=t-i,c=t+i;return[["M",s,t],["C",s,t-o,e-a,l,e,l],["C",e+a,l,u,t-o,u,t],["C",u,t+o,e+a,c,e,c],["C",e-a,c,s,t+o,s,t],["Z"]]}function Sa(r,i){var e=r.map(function(t,n){return[n===0?"M":"L",t[0],t[1]]});return i&&e.push(["Z"]),e}function Na(r,i,e,t,n){if(n){var a=(0,re.Z)(n,4),o=a[0],s=a[1],u=a[2],l=a[3],c=r>0?1:-1,h=i>0?1:-1,f=c+h!==0?1:0;return[["M",c*o+e,t],["L",r-c*s+e,t],s?["A",s,s,0,0,f,r+e,h*s+t]:null,["L",r+e,i-h*u+t],u?["A",u,u,0,0,f,r+e-c*u,i+t]:null,["L",e+c*l,i+t],l?["A",l,l,0,0,f,e,i+t-h*l]:null,["L",e,h*o+t],o?["A",o,o,0,0,f,c*o+e,t]:null,["Z"]].filter(function(d){return d})}return[["M",e,t],["L",e+r,t],["L",e+r,t+i],["L",e,t+i],["Z"]]}function wa(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r.getLocalTransform(),e=[];switch(r.nodeName){case b.LINE:var t=r.parsedStyle,n=t.x1,a=n===void 0?0:n,o=t.y1,s=o===void 0?0:o,u=t.x2,l=u===void 0?0:u,c=t.y2,h=c===void 0?0:c;e=Ca(a,s,l,h);break;case b.CIRCLE:{var f=r.parsedStyle,d=f.r,v=d===void 0?0:d,y=f.cx,m=y===void 0?0:y,T=f.cy,M=T===void 0?0:T;e=dr(v,v,m,M);break}case b.ELLIPSE:{var P=r.parsedStyle,Z=P.rx,E=Z===void 0?0:Z,g=P.ry,p=g===void 0?0:g,k=P.cx,S=k===void 0?0:k,N=P.cy,O=N===void 0?0:N;e=dr(E,p,S,O);break}case b.POLYLINE:case b.POLYGON:var L=r.parsedStyle.points;e=Sa(L.points,r.nodeName===b.POLYGON);break;case b.RECT:var B=r.parsedStyle,F=B.width,G=F===void 0?0:F,z=B.height,_=z===void 0?0:z,W=B.x,X=W===void 0?0:W,pe=B.y,me=pe===void 0?0:pe,Re=B.radius,Ln=Re&&Re.some(function(mt){return mt!==0});e=Na(G,_,X,me,Ln&&Re.map(function(mt){return(0,at.Z)(mt,0,Math.min(Math.abs(G)/2,Math.abs(_)/2))}));break;case b.PATH:var Dn=r.parsedStyle.d.absolutePath;e=(0,ne.Z)(Dn);break}if(e.length)return Ma(e,r,i)}function tu(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a=r.map(function(o,s){var u=o[0],l=r[s+1],c=s===0&&(i!==0||e!==0),h=(s===r.length-1||l&&(l[0]==="M"||l[0]==="Z"))&&t!==0&&n!==0,f=c?[i,e]:[0,0],d=_slicedToArray(f,2),v=d[0],y=d[1],m=h?[t,n]:[0,0],T=_slicedToArray(m,2),M=T[0],P=T[1];switch(u){case"M":return"M ".concat(o[1]+v,",").concat(o[2]+y);case"L":return"L ".concat(o[1]+M,",").concat(o[2]+P);case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]+M," ").concat(o[4]+P);case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]+M," ").concat(o[6]+P);case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]+M," ").concat(o[7]+P);case"Z":return"Z";default:return null}}).filter(function(o){return o!==null}).join(" ");return~a.indexOf("NaN")?"":a}var gr=function(i){if(i===""||Array.isArray(i)&&i.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=(0,Zn.A)(i)}catch(d){e=(0,Zn.A)(""),console.error("[g]: Invalid SVG Path definition: ".concat(i))}ya(e);var t=Ea(e),n=ka(e),a=n.polygons,o=n.polylines,s=Ta(e),u=xa(s,0),l=u.x,c=u.y,h=u.width,f=u.height;return{absolutePath:e,hasArc:t,segments:s,polygons:a,polylines:o,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(h)?h:0,height:Number.isFinite(f)?f:0}}},Aa=Ee(gr);function pr(r){return(0,Ge.Z)(r)?Aa(r):gr(r)}function Ra(r,i,e){var t=r.curve,n=i.curve;(!t||t.length===0)&&(t=(0,Bn.Y)(r.absolutePath,!1),r.curve=t),(!n||n.length===0)&&(n=(0,Bn.Y)(i.absolutePath,!1),i.curve=n);var a=[t,n];t.length!==n.length&&(a=(0,si.x)(t,n));var o=(0,Fn.b)(a[0])!==(0,Fn.b)(a[1])?(0,ui.G)(a[0]):(0,li.U)(a[0]);return[o,(0,ci.g)(a[1],o),function(s){return s}]}function Oa(r,i){var e;return(0,Ge.Z)(r)?e=r.split(" ").map(function(t){var n=t.split(","),a=(0,re.Z)(n,2),o=a[0],s=a[1];return[Number(o),Number(s)]}):e=r,{points:e,totalLength:0,segments:[]}}function La(r,i){return[r.points,i.points,function(e){return e}]}var ue=null,rt=/\s*(\w+)\(([^)]*)\)/g;function Te(r){return function(i){var e=0;return r.map(function(t){return t===ue?i[e++]:t})}}function We(r){return r}var ct={matrix:["NNNNNN",[ue,ue,0,0,ue,ue,0,0,0,0,1,0,ue,ue,0,1],We],matrix3d:["NNNNNNNNNNNNNNNN",We],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Te([ue,ue,new $(1)]),We],scaleX:["N",Te([ue,new $(1),new $(1)]),Te([ue,new $(1)])],scaleY:["N",Te([new $(1),ue,new $(1)]),Te([new $(1),ue])],scaleZ:["N",Te([new $(1),new $(1),ue])],scale3d:["NNN",We],skew:["Aa",null,We],skewX:["A",null,Te([ue,Ye])],skewY:["A",null,Te([Ye,ue])],translate:["Tt",Te([ue,ue,Ae]),We],translateX:["T",Te([ue,Ae,Ae]),Te([ue,Ae])],translateY:["T",Te([Ae,ue,Ae]),Te([Ae,ue])],translateZ:["L",Te([Ae,Ae,ue])],translate3d:["TTL",We]};function mr(r){for(var i=[],e=r.length,t=0;t<e;t++){var n=r[t],a=n[0],o=n.slice(1);a==="translate"||a==="skew"?o.length===1&&o.push(0):a==="scale"&&o.length===1&&o.push(o[0]);var s=ct[a];if(!s)return[];var u=o.map(function(l){return te(l)});i.push({t:a,d:u})}return i}function yr(r){if(Array.isArray(r))return mr(r);if(r=(r||"none").trim(),r==="none")return[];var i=[],e,t=0;for(rt.lastIndex=0;e=rt.exec(r);){if(e.index!==t)return[];t=e.index+e[0].length;var n=e[1],a=ct[n];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var u=[],l=0;l<s.length;l++){var c=o[l],h=s[l],f=void 0;if(c?f={A:function(v){return v.trim()==="0"?Ye:fa(v)},N:tn,T:en,L:ca}[h.toUpperCase()](c):f={a:Ye,n:u[0],t:Ae}[h],f===void 0)return[];u.push(f)}if(i.push({t:n,d:u}),rt.lastIndex===r.length)return i}return[]}function Da(r){if(Array.isArray(r))return mr(r);if(r=(r||"none").trim(),r==="none")return[];var i=[],e,t=0;for(rt.lastIndex=0;e=rt.exec(r);){if(e.index!==t)return[];t=e.index+e[0].length;var n=e[1],a=ct[n];if(!a)return[];var o=e[2].split(","),s=a[0];if(s.length<o.length)return[];for(var u=[],l=0;l<s.length;l++){var c=o[l],h=s[l],f=void 0;if(c?f={A:function(v){return v.trim()==="0"?Ye:ir(v)},N:sr,T:rr,L:nr}[h.toUpperCase()](c):f={a:Ye,n:u[0],t:Ae}[h],f===void 0)return[];u.push(f)}if(i.push({t:n,d:u}),rt.lastIndex===r.length)return i}return[]}function Ia(r){var i,e,t,n;switch(r.t){case"rotateX":return n=j(xe(r.d[0])),[1,0,0,0,0,Math.cos(n),Math.sin(n),0,0,-Math.sin(n),Math.cos(n),0,0,0,0,1];case"rotateY":return n=j(xe(r.d[0])),[Math.cos(n),0,-Math.sin(n),0,0,1,0,0,Math.sin(n),0,Math.cos(n),0,0,0,0,1];case"rotate":case"rotateZ":return n=j(xe(r.d[0])),[Math.cos(n),Math.sin(n),0,0,-Math.sin(n),Math.cos(n),0,0,0,0,1,0,0,0,0,1];case"rotate3d":i=r.d[0].value,e=r.d[1].value,t=r.d[2].value,n=j(xe(r.d[3]));var a=i*i+e*e+t*t;if(a===0)i=1,e=0,t=0;else if(a!==1){var o=Math.sqrt(a);i/=o,e/=o,t/=o}var s=Math.sin(n/2),u=s*Math.cos(n/2),l=s*s;return[1-2*(e*e+t*t)*l,2*(i*e*l+t*u),2*(i*t*l-e*u),0,2*(i*e*l-t*u),1-2*(i*i+t*t)*l,2*(e*t*l+i*u),0,2*(i*t*l+e*u),2*(e*t*l-i*u),1-2*(i*i+e*e)*l,0,0,0,0,1];case"scale":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[r.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,r.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,r.d[0].value,0,0,0,0,1];case"scale3d":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,r.d[2].value,0,0,0,0,1];case"skew":var c=j(xe(r.d[0])),h=j(xe(r.d[1]));return[1,Math.tan(h),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return n=j(xe(r.d[0])),[1,0,0,0,Math.tan(n),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return n=j(xe(r.d[0])),[1,Math.tan(n),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return i=Pe(r.d[0],0,null)||0,e=Pe(r.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,i,e,0,1];case"translateX":return i=Pe(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,i,0,0,1];case"translateY":return e=Pe(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1];case"translateZ":return t=Pe(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,t,1];case"translate3d":return i=Pe(r.d[0],0,null)||0,e=Pe(r.d[1],0,null)||0,t=Pe(r.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,i,e,t,1];case"perspective":var f=Pe(r.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[r.d[0].value,r.d[1].value,0,0,r.d[2].value,r.d[3].value,0,0,0,0,1,0,r.d[4].value,r.d[5].value,0,1];case"matrix3d":return r.d.map(function(v){return v.value})}}function ba(r,i){return[r[0]*i[0]+r[4]*i[1]+r[8]*i[2]+r[12]*i[3],r[1]*i[0]+r[5]*i[1]+r[9]*i[2]+r[13]*i[3],r[2]*i[0]+r[6]*i[1]+r[10]*i[2]+r[14]*i[3],r[3]*i[0]+r[7]*i[1]+r[11]*i[2]+r[15]*i[3],r[0]*i[4]+r[4]*i[5]+r[8]*i[6]+r[12]*i[7],r[1]*i[4]+r[5]*i[5]+r[9]*i[6]+r[13]*i[7],r[2]*i[4]+r[6]*i[5]+r[10]*i[6]+r[14]*i[7],r[3]*i[4]+r[7]*i[5]+r[11]*i[6]+r[15]*i[7],r[0]*i[8]+r[4]*i[9]+r[8]*i[10]+r[12]*i[11],r[1]*i[8]+r[5]*i[9]+r[9]*i[10]+r[13]*i[11],r[2]*i[8]+r[6]*i[9]+r[10]*i[10]+r[14]*i[11],r[3]*i[8]+r[7]*i[9]+r[11]*i[10]+r[15]*i[11],r[0]*i[12]+r[4]*i[13]+r[8]*i[14]+r[12]*i[15],r[1]*i[12]+r[5]*i[13]+r[9]*i[14]+r[13]*i[15],r[2]*i[12]+r[6]*i[13]+r[10]*i[14]+r[14]*i[15],r[3]*i[12]+r[7]*i[13]+r[11]*i[14]+r[15]*i[15]]}function _a(r){return r.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:r.map(Ia).reduce(ba)}function Er(r){var i=[0,0,0],e=[1,1,1],t=[0,0,0],n=[0,0,0,1],a=[0,0,0,1];return Li(_a(r),i,e,t,n,a),[[i,e,t,a,n]]}var Za=function(){function r(t,n){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var u=0;u<4;u++)a[o][s]+=n[o][u]*t[u][s];return a}function i(t){return t[0][2]===0&&t[0][3]===0&&t[1][2]===0&&t[1][3]===0&&t[2][0]===0&&t[2][1]===0&&t[2][2]===1&&t[2][3]===0&&t[3][2]===0&&t[3][3]===1}function e(t,n,a,o,s){for(var u=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)u[l][3]=s[l];for(var c=0;c<3;c++)for(var h=0;h<3;h++)u[3][c]+=t[h]*u[h][c];var f=o[0],d=o[1],v=o[2],y=o[3],m=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];m[0][0]=1-2*(d*d+v*v),m[0][1]=2*(f*d-v*y),m[0][2]=2*(f*v+d*y),m[1][0]=2*(f*d+v*y),m[1][1]=1-2*(f*f+v*v),m[1][2]=2*(d*v-f*y),m[2][0]=2*(f*v-d*y),m[2][1]=2*(d*v+f*y),m[2][2]=1-2*(f*f+d*d),u=r(u,m);var T=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(T[2][1]=a[2],u=r(u,T)),a[1]&&(T[2][1]=0,T[2][0]=a[0],u=r(u,T)),a[0]&&(T[2][0]=0,T[1][0]=a[0],u=r(u,T));for(var M=0;M<3;M++)for(var P=0;P<3;P++)u[M][P]*=n[M];return i(u)?[u[0][0],u[0][1],u[1][0],u[1][1],u[3][0],u[3][1]]:u[0].concat(u[1],u[2],u[3])}return e}();function Ba(r){return r.toFixed(6).replace(".000000","")}function sn(r,i){var e,t;return r.decompositionPair!==i&&(r.decompositionPair=i,e=Er(r)),i.decompositionPair!==r&&(i.decompositionPair=r,t=Er(i)),e[0]===null||t[0]===null?[[!1],[!0],function(n){return n?i[0].d:r[0].d}]:(e[0].push(0),t[0].push(1),[e,t,function(n){var a=Ga(e[0][3],t[0][3],n[5]),o=Za(n[0],n[1],n[2],a,n[4]),s=o.map(Ba).join(",");return s}])}function Fa(r,i){for(var e=0,t=0;t<r.length;t++)e+=r[t]*i[t];return e}function Ga(r,i,e){var t=Fa(r,i);t=(0,at.Z)(t,-1,1);var n=[];if(t===1)n=r;else for(var a=Math.acos(t),o=Math.sin(e*a)*1/Math.sqrt(1-t*t),s=0;s<4;s++)n.push(r[s]*(Math.cos(e*a)-t*o)+i[s]*o);return n}function un(r){return r.replace(/[XY]/,"")}function ln(r){return r.replace(/(X|Y|Z|3d)?$/,"3d")}var Ua=function(i,e){return i==="perspective"&&e==="perspective"||(i==="matrix"||i==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function Ya(r,i,e){var t=!1;if(!r.length||!i.length){r.length||(t=!0,r=i,i=[]);for(var n=function(){var O=r[a],L=O.t,B=O.d,F=L.substring(0,5)==="scale"?1:0;i.push({t:L,d:B.map(function(G){return typeof G=="number"?te(F):te(F,G.unit)})})},a=0;a<r.length;a++)n()}var o=[],s=[],u=[];if(r.length!==i.length){var l=sn(r,i);o=[l[0]],s=[l[1]],u=[["matrix",[l[2]]]]}else for(var c=0;c<r.length;c++){var h=r[c].t,f=i[c].t,d=r[c].d,v=i[c].d,y=ct[h],m=ct[f],T=void 0;if(Ua(h,f)){var M=sn([r[c]],[i[c]]);o.push(M[0]),s.push(M[1]),u.push(["matrix",[M[2]]]);continue}else if(h===f)T=h;else if(y[2]&&m[2]&&un(h)===un(f))T=un(h),d=y[2](d),v=m[2](v);else if(y[1]&&m[1]&&ln(h)===ln(f))T=ln(h),d=y[1](d),v=m[1](v);else{var P=sn(r,i);o=[P[0]],s=[P[1]],u=[["matrix",[P[2]]]];break}for(var Z=[],E=[],g=[],p=0;p<d.length;p++){var k=va(d[p],v[p],e,!1,p);Z[p]=k[0],E[p]=k[1],g.push(k[2])}o.push(Z),s.push(E),u.push([T,g])}if(t){var S=o;o=s,s=S}return[o,s,function(N){return N.map(function(O,L){var B=O.map(function(F,G){return u[L][1][G](F)}).join(",");return u[L][0]==="matrix"&&B.split(",").length===16&&(u[L][0]="matrix3d"),u[L][0]==="matrix3d"&&B.split(",").length===6&&(u[L][0]="matrix"),"".concat(u[L][0],"(").concat(B,")")}).join(" ")}]}var Wa=Ee(function(r){if((0,Ge.Z)(r)){if(r==="text-anchor")return[te(0,"px"),te(0,"px")];var i=r.split(" ");return i.length===1&&(i[0]==="top"||i[0]==="bottom"?(i[1]=i[0],i[0]="center"):i[1]="center"),i.length!==2?null:[en(kr(i[0])),en(kr(i[1]))]}return[te(r[0]||0,"px"),te(r[1]||0,"px")]});function kr(r){return r==="center"?"50%":r==="left"||r==="top"?"0%":r==="right"||r==="bottom"?"100%":r}var cn=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:A.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:A.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:A.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:A.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:A.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:A.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:A.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:A.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:A.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:A.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:A.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:A.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:A.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:A.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:A.FILTER},{n:"clipPath",syntax:A.DEFINED_PATH},{n:"textPath",syntax:A.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:A.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:A.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:A.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:A.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:A.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:A.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:A.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:A.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:A.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:A.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:A.COORDINATE},{n:"y1",int:!0,l:!0,syntax:A.COORDINATE},{n:"z1",int:!0,l:!0,syntax:A.COORDINATE},{n:"x2",int:!0,l:!0,syntax:A.COORDINATE},{n:"y2",int:!0,l:!0,syntax:A.COORDINATE},{n:"z2",int:!0,l:!0,syntax:A.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:A.PATH,p:50},{n:"points",int:!0,l:!0,syntax:A.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:A.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:A.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:A.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:A.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:A.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:A.NUMBER,d:function(i){return i===b.PATH||i===b.POLYGON||i===b.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:A.MARKER},{n:"markerEnd",syntax:A.MARKER},{n:"markerMid",syntax:A.MARKER},{n:"markerStartOffset",syntax:A.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:A.LENGTH,l:!0,int:!0,d:"0"}],za=new Set(cn.filter(function(r){return!!r.l}).map(function(r){return r.n})),xr={},Xa=function(){function r(i){var e=this;(0,D.Z)(this,r),this.runtime=i,cn.forEach(function(t){e.registerMetadata(t)})}return(0,I.Z)(r,[{key:"registerMetadata",value:function(e){[e.n].concat((0,ne.Z)(e.a||[])).forEach(function(t){xr[t]=e})}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e]}},{key:"processProperties",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(e.attributes,t);var a=e.parsedStyle.clipPath,o=e.parsedStyle.offsetPath;Va(e,t);var s=!!n.forceUpdateGeometry;if(!s){for(var u in t)if(za.has(u)){s=!0;break}}t.fill&&(e.parsedStyle.fill=nt(t.fill)),t.stroke&&(e.parsedStyle.stroke=nt(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=nt(t.shadowColor)),t.filter&&(e.parsedStyle.filter=pa(t.filter)),(0,fe.Z)(t.radius)||(e.parsedStyle.radius=ar(t.radius,4)),(0,fe.Z)(t.lineDash)||(e.parsedStyle.lineDash=ar(t.lineDash,2)),t.points&&(e.parsedStyle.points=Oa(t.points)),t.d===""&&(e.parsedStyle.d=(0,K.Z)({},Kn)),t.d&&(e.parsedStyle.d=pr(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory[A.TEXT_TRANSFORM].calculator(null,null,{value:t.textTransform},e,null),(0,ie.Z)(t.clipPath)||this.runtime.CSSPropertySyntaxFactory[A.DEFINED_PATH].calculator("clipPath",a,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory[A.DEFINED_PATH].calculator("offsetPath",o,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=yr(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=Wa(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[A.MARKER].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[A.MARKER].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[A.MARKER].calculator("",t.markerMid,t.markerMid,null,null)),(0,fe.Z)(t.zIndex)||this.runtime.CSSPropertySyntaxFactory[A.Z_INDEX].postProcessor(e),(0,fe.Z)(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory[A.OFFSET_DISTANCE].postProcessor(e),t.transform&&this.runtime.CSSPropertySyntaxFactory[A.TRANSFORM].postProcessor(e),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[A.TRANSFORM_ORIGIN].postProcessor(e),s&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},{key:"updateGeometry",value:function(e){var t=e.nodeName,n=this.runtime.geometryUpdaterFactory[t];if(n){var a=e.geometry;a.contentBounds||(a.contentBounds=new de),a.renderBounds||(a.renderBounds=new de);var o=e.parsedStyle,s=n.update(o,e),u=s.cx,l=u===void 0?0:u,c=s.cy,h=c===void 0?0:c,f=s.cz,d=f===void 0?0:f,v=s.hwidth,y=v===void 0?0:v,m=s.hheight,T=m===void 0?0:m,M=s.hdepth,P=M===void 0?0:M,Z=[Math.abs(y),Math.abs(T),P],E=o.stroke,g=o.lineWidth,p=g===void 0?1:g,k=o.increasedLineWidthForHitTesting,S=k===void 0?0:k,N=o.shadowType,O=N===void 0?"outer":N,L=o.shadowColor,B=o.filter,F=B===void 0?[]:B,G=o.transformOrigin,z=[l,h,d];a.contentBounds.update(z,Z);var _=t===b.POLYLINE||t===b.POLYGON||t===b.PATH?Math.SQRT2:.5,W=E&&!E.isNone;if(W){var X=((p||0)+(S||0))*_;Z[0]+=X,Z[1]+=X}if(a.renderBounds.update(z,Z),L&&O&&O!=="inner"){var pe=a.renderBounds,me=pe.min,Re=pe.max,Ln=o.shadowBlur,Dn=o.shadowOffsetX,mt=o.shadowOffsetY,Zt=Ln||0,$r=Dn||0,Kr=mt||0,Us=me[0]-Zt+$r,Ys=Re[0]+Zt+$r,Ws=me[1]-Zt+Kr,zs=Re[1]+Zt+Kr;me[0]=Math.min(me[0],Us),Re[0]=Math.max(Re[0],Ys),me[1]=Math.min(me[1],Ws),Re[1]=Math.max(Re[1],zs),a.renderBounds.setMinMax(me,Re)}F.forEach(function(jr){var qr=jr.name,Bt=jr.params;if(qr==="blur"){var ei=Bt[0].value;a.renderBounds.update(a.renderBounds.center,x.IH(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[ei,ei,0]))}else if(qr==="drop-shadow"){var ti=Bt[0].value,ni=Bt[1].value,Ft=Bt[2].value,ri=a.renderBounds,Ve=ri.min,He=ri.max,Hs=Ve[0]-Ft+ti,$s=He[0]+Ft+ti,Ks=Ve[1]-Ft+ni,Js=He[1]+Ft+ni;Ve[0]=Math.min(Ve[0],Hs),He[0]=Math.max(He[0],$s),Ve[1]=Math.min(Ve[1],Ks),He[1]=Math.max(He[1],Js),a.renderBounds.setMinMax(Ve,He)}}),e.geometry.dirty=!1;var Xs=y<0,Vs=T<0,Jr=(Xs?-1:1)*(G?Pe(G[0],0,e,!0):0),Qr=(Vs?-1:1)*(G?Pe(G[1],1,e,!0):0);(Jr||Qr)&&e.setOrigin(Jr,Qr)}}},{key:"updateSizeAttenuation",value:function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===b.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===b.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))}}])}();function Va(r,i){if(!C.enableMassiveParsedStyleAssignOptimization){Object.assign(r.parsedStyle,i);return}var e=r.constructor.PARSED_STYLE_LIST;for(var t in i)e.has(t)&&(r.parsedStyle[t]=i[t])}var Ha=function(){function r(){(0,D.Z)(this,r),this.mixer=nn}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){return xe(n)}}])}(),$a=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a,o){return n instanceof Se&&(n=null),o.sceneGraphService.updateDisplayObjectDependency(e,t,n,a),e==="clipPath"&&a.forEach(function(s){s.childNodes.length===0&&o.sceneGraphService.dirtifyToRoot(s)}),n}}])}(),Ka=function(){function r(){(0,D.Z)(this,r),this.parser=nt,this.mixer=la}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){return n instanceof Se?n.value==="none"?jn:qn:n}}])}(),Ja=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n instanceof Se?[]:n}}])}();function Tr(r){var i=r.parsedStyle,e=i.fontSize;return(0,fe.Z)(e)?null:e}var hn=function(){function r(){(0,D.Z)(this,r),this.mixer=nn}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a,o){if((0,$e.Z)(n))return n;if($.isRelativeUnit(n.unit)){if(n.unit===R.kPercentage)return 0;if(n.unit===R.kEms){if(a.parentNode){var s=Tr(a.parentNode);if(s)return s*=n.value,s}return 0}if(n.unit===R.kRems){var u;if(a!=null&&(u=a.ownerDocument)!==null&&u!==void 0&&u.documentElement){var l=Tr(a.ownerDocument.documentElement);if(l)return l*=n.value,l}return 0}}else return n.value}}])}(),Qa=function(){function r(){(0,D.Z)(this,r),this.mixer=ur}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n.map(function(a){return a.value})}}])}(),ja=function(){function r(){(0,D.Z)(this,r),this.mixer=ur}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n.map(function(a){return a.value})}}])}(),qa=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){var o;n instanceof Se&&(n=null);var s=(o=n)===null||o===void 0?void 0:o.cloneNode(!0);return s&&(s.style.isMarker=!0),s}}])}(),eo=function(){function r(){(0,D.Z)(this,r),this.mixer=nn}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n.value}}])}(),to=function(){function r(){(0,D.Z)(this,r),this.mixer=rn(0,1)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n.value}},{key:"postProcessor",value:function(e){var t=e.parsedStyle,n=t.offsetPath,a=t.offsetDistance;if(n){var o=n.nodeName;if(o===b.LINE||o===b.PATH||o===b.POLYLINE){var s=n.getPoint(a);s&&e.setLocalPosition(s.x,s.y)}}}}])}(),no=function(){function r(){(0,D.Z)(this,r),this.mixer=rn(0,1)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n.value}}])}(),ro=function(){function r(){(0,D.Z)(this,r),this.parser=pr,this.mixer=Ra}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n){return n instanceof Se&&n.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new qe(0,0,0,0)}:n}}])}(),io=(0,I.Z)(function r(){(0,D.Z)(this,r),this.mixer=La}),ao=function(r){function i(){var e;(0,D.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=(0,J.Z)(this,i,[].concat(n)),e.mixer=rn(0,1/0),e}return(0,Q.Z)(i,r),(0,I.Z)(i)}(hn),oo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){return n instanceof Se?n.value==="unset"?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||""}}])}(),so=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){var o=a.getAttribute("text");if(o){var s=o;n.value==="capitalize"?s=o.charAt(0).toUpperCase()+o.slice(1):n.value==="lowercase"?s=o.toLowerCase():n.value==="uppercase"&&(s=o.toUpperCase()),a.parsedStyle.text=s}return n.value}}])}(),nu=function(i){return Object.fromEntries(Object.entries(i).filter(function(e){var t=_slicedToArray(e,2),n=t[1];return n!==void 0}))},fn=new WeakMap;function uo(r,i,e){if(r){var t=typeof r=="string"?document.getElementById(r):r;fn.has(t)&&fn.get(t).destroy(e),fn.set(t,i)}}var wt=typeof window!="undefined"&&typeof window.document!="undefined";function lo(r){return!!r.getAttribute}function co(r,i){for(var e=0,t=r.length;e<t;){var n=e+t>>>1;Pr(r[n],i)<0?e=n+1:t=n}return e}function Pr(r,i){var e=Number(r.parsedStyle.zIndex||0),t=Number(i.parsedStyle.zIndex||0);if(e===t){var n=r.parentNode;if(n){var a=n.childNodes||[];return a.indexOf(r)-a.indexOf(i)}}return e-t}function Mr(r){var i=r;do{var e,t=(e=i.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(t)return i;i=i.parentElement}while(i!==null);return null}var Cr="px";function ho(r,i,e){wt&&r.style&&(r.style.width=i+Cr,r.style.height=e+Cr)}function Sr(r,i){if(wt)return document.defaultView.getComputedStyle(r,null).getPropertyValue(i)}function fo(r){var i=Sr(r,"width");return i==="auto"?r.offsetWidth:parseFloat(i)}function vo(r){var i=Sr(r,"height");return i==="auto"?r.offsetHeight:parseFloat(i)}var go=1,po={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},vn=typeof performance=="object"&&performance.now?performance:Date;function At(r){return r.nodeName===b.FRAGMENT?!0:r.getRootNode().nodeName===b.FRAGMENT}function mo(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",i=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,t=!1,n=!1,a=!!i&&!i.isNone,o=!!e&&!e.isNone;return r==="visiblepainted"||r==="painted"||r==="auto"?(t=a,n=o):r==="visiblefill"||r==="fill"?t=!0:r==="visiblestroke"||r==="stroke"?n=!0:(r==="visible"||r==="all")&&(t=!0,n=!0),[t,n]}var yo=1,Eo=function(){return yo++},Le=typeof self=="object"&&self.self===self?self:typeof U.g=="object"&&U.g.global===U.g?U.g:{},ko=Date.now(),xo=function(){return Le.performance&&typeof Le.performance.now=="function"?Le.performance.now():Date.now()-ko},ht={},Nr=Date.now(),To=function(i){if(typeof i!="function")throw new TypeError("".concat(i," is not a function"));var e=Date.now(),t=e-Nr,n=t>16?0:16-t,a=Eo();return ht[a]=i,Object.keys(ht).length>1||setTimeout(function(){Nr=e;var o=ht;ht={},Object.keys(o).forEach(function(s){return o[s](xo())})},n),a},Po=function(i){delete ht[i]},Mo=["","webkit","moz","ms","o"],wr=function(i){return typeof i!="string"?To:i===""?Le.requestAnimationFrame:Le["".concat(i,"RequestAnimationFrame")]},Co=function(i){return typeof i!="string"?Po:i===""?Le.cancelAnimationFrame:Le["".concat(i,"CancelAnimationFrame")]||Le["".concat(i,"CancelRequestAnimationFrame")]},So=function(i,e){for(var t=0;i[t]!==void 0;){if(e(i[t]))return i[t];t+=1}},Ar=So(Mo,function(r){return!!wr(r)}),dn=wr(Ar),Rr=Co(Ar);Le.requestAnimationFrame=dn,Le.cancelAnimationFrame=Rr;var No=function(){function r(){(0,D.Z)(this,r),this.callbacks=[]}return(0,I.Z)(r,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(e,t){this.callbacks.push(t)}},{key:"promise",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.all(this.callbacks.map(function(a){return a.apply(void 0,t)}))}}])}(),wo=function(){function r(){(0,D.Z)(this,r),this.callbacks=[]}return(0,I.Z)(r,[{key:"tapPromise",value:function(e,t){this.callbacks.push(t)}},{key:"promise",value:function(){var i=(0,Yt.Z)((0,Ke.Z)().mark(function t(){var n,a,o,s,u=arguments;return(0,Ke.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!this.callbacks.length){c.next=14;break}return c.next=3,(n=this.callbacks)[0].apply(n,u);case 3:a=c.sent,o=0;case 5:if(!(o<this.callbacks.length-1)){c.next=13;break}return s=this.callbacks[o],c.next=9,s(a);case 9:a=c.sent;case 10:o++,c.next=5;break;case 13:return c.abrupt("return",a);case 14:return c.abrupt("return",null);case 15:case"end":return c.stop()}},t,this)}));function e(){return i.apply(this,arguments)}return e}()}])}(),ke=function(){function r(){(0,D.Z)(this,r),this.callbacks=[]}return(0,I.Z)(r,[{key:"tap",value:function(e,t){this.callbacks.push(t)}},{key:"call",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=arguments;this.callbacks.forEach(function(o){o.apply(void 0,a)})}}])}(),gn=function(){function r(){(0,D.Z)(this,r),this.callbacks=[]}return(0,I.Z)(r,[{key:"tap",value:function(e,t){this.callbacks.push(t)}},{key:"call",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this.callbacks.length){for(var a=arguments,o=this.callbacks[0].apply(void 0,a),s=0;s<this.callbacks.length-1;s++){var u=this.callbacks[s];o=u(o)}return o}return null}}])}(),Ao=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ro=/([\"\'])[^\'\"]+\1/;function Oo(r){for(var i=r.fontSize,e=i===void 0?16:i,t=r.fontFamily,n=t===void 0?"sans-serif":t,a=r.fontStyle,o=a===void 0?"normal":a,s=r.fontVariant,u=s===void 0?"normal":s,l=r.fontWeight,c=l===void 0?"normal":l,h=(0,$e.Z)(e)&&"".concat(e,"px")||"16px",f=n.split(","),d=f.length-1;d>=0;d--){var v=f[d].trim();!Ro.test(v)&&Ao.indexOf(v)<0&&(v='"'.concat(v,'"')),f[d]=v}return"".concat(o," ").concat(u," ").concat(c," ").concat(h," ").concat(f.join(","))}function pn(r,i,e){return w.identity(r),r[4]=Math.tan(i),r[1]=Math.tan(e),r}var ce=w.create(),Lo=w.create(),Do={scale:function(i){w.fromScaling(ce,[i[0].value,i[1].value,1])},scaleX:function(i){w.fromScaling(ce,[i[0].value,1,1])},scaleY:function(i){w.fromScaling(ce,[1,i[0].value,1])},scaleZ:function(i){w.fromScaling(ce,[1,1,i[0].value])},scale3d:function(i){w.fromScaling(ce,[i[0].value,i[1].value,i[2].value])},translate:function(i){w.fromTranslation(ce,[i[0].value,i[1].value,0])},translateX:function(i){w.fromTranslation(ce,[i[0].value,0,0])},translateY:function(i){w.fromTranslation(ce,[0,i[0].value,0])},translateZ:function(i){w.fromTranslation(ce,[0,0,i[0].value])},translate3d:function(i){w.fromTranslation(ce,[i[0].value,i[1].value,i[2].value])},rotate:function(i){w.fromZRotation(ce,j(xe(i[0])))},rotateX:function(i){w.fromXRotation(ce,j(xe(i[0])))},rotateY:function(i){w.fromYRotation(ce,j(xe(i[0])))},rotateZ:function(i){w.fromZRotation(ce,j(xe(i[0])))},rotate3d:function(i){w.fromRotation(ce,j(xe(i[3])),[i[0].value,i[1].value,i[2].value])},skew:function(i){pn(ce,j(i[0].value),j(i[1].value))},skewX:function(i){pn(ce,j(i[0].value),0)},skewY:function(i){pn(ce,0,j(i[0].value))},matrix:function(i){w.set(ce,i[0].value,i[1].value,0,0,i[2].value,i[3].value,0,0,0,0,1,0,i[4].value,i[5].value,0,1)},matrix3d:function(i){w.set.apply(w,[ce].concat((0,ne.Z)(i.map(function(e){return e.value}))))}},Io=x.al(1,1,1),bo=x.Ue(),Or={translate:function(i,e){C.sceneGraphService.setLocalScale(i,Io,!1),C.sceneGraphService.setLocalEulerAngles(i,bo,void 0,void 0,!1),C.sceneGraphService.setLocalPosition(i,[e[0].value,e[1].value,0],!1),C.sceneGraphService.dirtifyLocal(i,i.transformable)}};function Lr(r,i){if(r.length){if(r.length===1&&Or[r[0].t]){Or[r[0].t](i,r[0].d);return}for(var e=w.identity(Lo),t=0;t<r.length;t++){var n=r[t],a=n.t,o=n.d,s=Do[a];s&&(s(o),w.mul(e,e,ce))}i.setLocalTransform(e)}else i.resetLocalTransform();return i.getLocalTransform()}var _o=function(){function r(){(0,D.Z)(this,r),this.parser=Da,this.mixer=Ya}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){return n instanceof Se?[]:n}},{key:"postProcessor",value:function(e){Lr(e.parsedStyle.transform,e)}}])}(),Zo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"postProcessor",value:function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===R.kPixels&&t[1].unit===R.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()}}])}(),Bo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"calculator",value:function(e,t,n,a){return n.value}},{key:"postProcessor",value:function(e){if(e.parentNode){var t=e.parentNode,n=t.renderable,a=t.sortable;n&&(n.dirty=!0),a&&(a.dirty=!0,a.dirtyReason=Tt.Z_INDEX_CHANGED)}}}])}(),Fo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e,t){var n=e.cx,a=n===void 0?0:n,o=e.cy,s=o===void 0?0:o,u=e.r,l=u===void 0?0:u;return{cx:a,cy:s,hwidth:l,hheight:l}}}])}(),Go=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e,t){var n=e.cx,a=n===void 0?0:n,o=e.cy,s=o===void 0?0:o,u=e.rx,l=u===void 0?0:u,c=e.ry,h=c===void 0?0:c;return{cx:a,cy:s,hwidth:l,hheight:h}}}])}(),Uo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e){var t=e.x1,n=e.y1,a=e.x2,o=e.y2,s=Math.min(t,a),u=Math.max(t,a),l=Math.min(n,o),c=Math.max(n,o),h=u-s,f=c-l,d=h/2,v=f/2;return{cx:s+d,cy:l+v,hwidth:d,hheight:v}}}])}(),Yo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e){var t=e.d,n=t.rect,a=n.x,o=n.y,s=n.width,u=n.height,l=s/2,c=u/2;return{cx:a+l,cy:o+c,hwidth:l,hheight:c}}}])}(),Wo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e){if(e.points&&(0,hi.Z)(e.points.points)){var t=e.points.points,n=Math.min.apply(Math,(0,ne.Z)(t.map(function(f){return f[0]}))),a=Math.max.apply(Math,(0,ne.Z)(t.map(function(f){return f[0]}))),o=Math.min.apply(Math,(0,ne.Z)(t.map(function(f){return f[1]}))),s=Math.max.apply(Math,(0,ne.Z)(t.map(function(f){return f[1]}))),u=a-n,l=s-o,c=u/2,h=l/2;return{cx:n+c,cy:o+h,hwidth:c,hheight:h}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),zo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e,t){var n=e.x,a=n===void 0?0:n,o=e.y,s=o===void 0?0:o,u=e.src,l=e.width,c=l===void 0?0:l,h=e.height,f=h===void 0?0:h,d=c,v=f;return u&&!(0,Ge.Z)(u)&&(d||(d=u.width,e.width=d),v||(v=u.height,e.height=v)),{cx:a+d/2,cy:s+v/2,hwidth:d/2,hheight:v/2}}}])}(),Xo=function(){function r(i){(0,D.Z)(this,r),this.globalRuntime=i}return(0,I.Z)(r,[{key:"isReadyToMeasure",value:function(e,t){var n=e.text;return n}},{key:"update",value:function(e,t){var n,a=e.text,o=e.textAlign,s=o===void 0?"start":o,u=e.lineWidth,l=u===void 0?1:u,c=e.textBaseline,h=c===void 0?"alphabetic":c,f=e.dx,d=f===void 0?0:f,v=e.dy,y=v===void 0?0:v,m=e.x,T=m===void 0?0:m,M=e.y,P=M===void 0?0:M;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var Z=(t==null||(n=t.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0?void 0:n.getConfig())||{},E=Z.offscreenCanvas,g=this.globalRuntime.textService.measureText(a,e,E);e.metrics=g;var p=g.width,k=g.height,S=p/2,N=k/2,O=T+S;s==="center"||s==="middle"?O+=l/2-S:(s==="right"||s==="end")&&(O+=l-S*2);var L=P-N;return h==="middle"?L+=N:h==="top"||h==="hanging"?L+=N*2:h==="alphabetic"||(h==="bottom"||h==="ideographic")&&(L+=0),d&&(O+=d),y&&(L+=y),{cx:O,cy:L,hwidth:S,hheight:N}}}])}(),Vo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),Ho=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"update",value:function(e,t){var n=e.x,a=n===void 0?0:n,o=e.y,s=o===void 0?0:o,u=e.width,l=u===void 0?0:u,c=e.height,h=c===void 0?0:c;return{cx:a+l/2,cy:s+h/2,hwidth:l/2,hheight:h/2}}}])}();function ru(r){return!!r.type}var Rt=function(){function r(i){(0,D.Z)(this,r),this.eventPhase=r.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ve,this.page=new ve,this.canvas=new ve,this.viewport=new ve,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=i}return(0,I.Z)(r,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(ee)}}])}(),Dr=function(r){function i(){var e;(0,D.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=(0,J.Z)(this,i,[].concat(n)),e.client=new ve,e.movement=new ve,e.offset=new ve,e.global=new ve,e.screen=new ve,e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(ee)}}])}(Rt),mn=function(r){function i(){var e;(0,D.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=(0,J.Z)(this,i,[].concat(n)),e.width=0,e.height=0,e.isPrimary=!1,e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(Dr),yn=function(r){function i(){return(0,D.Z)(this,i),(0,J.Z)(this,i,arguments)}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(Dr),ge=function(r){function i(e,t){var n;return(0,D.Z)(this,i),n=(0,J.Z)(this,i,[null]),n.type=e,n.detail=t,Object.assign(n,t),n}return(0,Q.Z)(i,r),(0,I.Z)(i)}(Rt),Ir=new WeakMap,br=function(){function r(){(0,D.Z)(this,r),this.emitter=new Gt.Z}return(0,I.Z)(r,[{key:"on",value:function(e,t,n){return this.addEventListener(e,t,n),this}},{key:"addEventListener",value:function(e,t,n){var a=!1,o=!1;if((0,Gn.Z)(n))a=n;else if(n){var s=n.capture;a=s===void 0?!1:s;var u=n.once;o=u===void 0?!1:u}a&&(e+="capture"),t=(0,ot.Z)(t)?t:t.handleEvent;var l=(0,ot.Z)(t)?void 0:t;return o?this.emitter.once(e,t,l):this.emitter.on(e,t,l),this}},{key:"off",value:function(e,t,n){return e?this.removeEventListener(e,t,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var e;(e=this.emitter)===null||e===void 0||e.removeAllListeners()}},{key:"removeEventListener",value:function(e,t,n){var a;if(!this.emitter)return this;var o=(0,Gn.Z)(n)?n:n==null?void 0:n.capture;o&&(e+="capture"),t=(0,ot.Z)(t)?t:(a=t)===null||a===void 0?void 0:a.handleEvent;var s=(0,ot.Z)(t)?void 0:t;return this.emitter.off(e,t,s),this}},{key:"emit",value:function(e,t){this.dispatchEvent(new ge(e,t))}},{key:"dispatchEvent",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Ir.get(this);if(!n){var a;this.document?n=this:this.defaultView?n=this.defaultView:n=(a=this.ownerDocument)===null||a===void 0?void 0:a.defaultView,n&&Ir.set(this,n)}if(n){if(e.manager=n.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],t||(e.target=this),e.manager.dispatchEvent(e,e.type,t)}else this.emitter.emit(e.type,e);return!e.defaultPrevented}}])}(),ae=function(r){function i(){var e;(0,D.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=(0,J.Z)(this,i,[].concat(n)),e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"textContent",get:function(){var t="";this.nodeName===b.TEXT&&(t+=this.style.text);var n=(0,Je.Z)(this.childNodes),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;o.nodeName===b.TEXT?t+=o.nodeValue:t+=o.textContent}}catch(s){n.e(s)}finally{n.f()}return t},set:function(t){var n=this;this.childNodes.slice().forEach(function(a){n.removeChild(a)}),this.nodeName===b.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(ee)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(ee)}},{key:"lookupPrefix",value:function(t){throw new Error(ee)}},{key:"normalize",value:function(){throw new Error(ee)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,a=this,o=[n],s=[a];(u=n.parentNode)!==null&&u!==void 0?u:a.parentNode;){var u;n=n.parentNode?(o.push(n.parentNode),n.parentNode):n,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a}if(n!==a)return i.DOCUMENT_POSITION_DISCONNECTED|i.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|i.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?i.DOCUMENT_POSITION_CONTAINED_BY|i.DOCUMENT_POSITION_FOLLOWING:i.DOCUMENT_POSITION_CONTAINS|i.DOCUMENT_POSITION_PRECEDING;for(var h=l.length-c.length,f=c.length-1;f>=0;f--){var d=c[f],v=l[h+f];if(v!==d){var y=d.parentNode.childNodes;return y.indexOf(d)<y.indexOf(v)?c===o?i.DOCUMENT_POSITION_PRECEDING:i.DOCUMENT_POSITION_FOLLOWING:l===o?i.DOCUMENT_POSITION_PRECEDING:i.DOCUMENT_POSITION_FOLLOWING}}return i.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var n=t;n&&this!==n;)n=n.parentNode;return!!n}},{key:"getAncestor",value:function(t){for(var n=this;t>0&&n;)n=n.parentNode,t--;return n}},{key:"forEach",value:function(t){for(var n=[this];n.length>0;){var a=n.pop(),o=t(a);if(o===!1)break;for(var s=a.childNodes.length-1;s>=0;s--)n.push(a.childNodes[s])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(br);ae.DOCUMENT_POSITION_DISCONNECTED=1,ae.DOCUMENT_POSITION_PRECEDING=2,ae.DOCUMENT_POSITION_FOLLOWING=4,ae.DOCUMENT_POSITION_CONTAINS=8,ae.DOCUMENT_POSITION_CONTAINED_BY=16,ae.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var $o=2048,Ko=function(){function r(i,e){var t=this;(0,D.Z)(this,r),this.emitter=new Gt.Z,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=w.create(),this.tmpVec3=x.Ue(),this.onPointerDown=function(n){var a=t.createPointerEvent(n);if(t.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")t.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;t.dispatchEvent(a,o?"rightdown":"mousedown")}var s=t.trackingData(n.pointerId);s.pressTargetsByButton[n.button]=a.composedPath(),t.freeEvent(a)},this.onPointerUp=function(n){var a=vn.now(),o=t.createPointerEvent(n,void 0,void 0,t.context.config.alwaysTriggerPointerEventOnCanvas?t.rootTarget:void 0);if(t.dispatchEvent(o,"pointerup"),o.pointerType==="touch")t.dispatchEvent(o,"touchend");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var s=o.button===2;t.dispatchEvent(o,s?"rightup":"mouseup")}var u=t.trackingData(n.pointerId),l=t.findMountedTarget(u.pressTargetsByButton[n.button]),c=l;if(l&&!o.composedPath().includes(l)){for(var h=l;h&&!o.composedPath().includes(h);){if(o.currentTarget=h,t.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch")t.notifyTarget(o,"touchendoutside");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var f=o.button===2;t.notifyTarget(o,f?"rightupoutside":"mouseupoutside")}ae.isNode(h)&&(h=h.parentNode)}delete u.pressTargetsByButton[n.button],c=h}if(c){var d,v=t.clonePointerEvent(o,"click");v.target=c,v.path=[],u.clicksByButton[n.button]||(u.clicksByButton[n.button]={clickCount:0,target:v.target,timeStamp:a});var y=t.context.renderingContext.root.ownerDocument.defaultView,m=u.clicksByButton[n.button];m.target===v.target&&a-m.timeStamp<y.dblClickSpeed?++m.clickCount:m.clickCount=1,m.target=v.target,m.timeStamp=a,v.detail=m.clickCount,(d=o.detail)!==null&&d!==void 0&&d.preventClick||(!t.context.config.useNativeClickEvent&&(v.pointerType==="mouse"||v.pointerType==="touch")&&t.dispatchEvent(v,"click"),t.dispatchEvent(v,"pointertap")),t.freeEvent(v)}t.freeEvent(o)},this.onPointerMove=function(n){var a=t.createPointerEvent(n,void 0,void 0,t.context.config.alwaysTriggerPointerEventOnCanvas?t.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=t.trackingData(n.pointerId),u=t.findMountedTarget(s.overTargets);if(s.overTargets&&u!==a.target){var l=n.type==="mousemove"?"mouseout":"pointerout",c=t.createPointerEvent(n,l,u||void 0);if(t.dispatchEvent(c,"pointerout"),o&&t.dispatchEvent(c,"mouseout"),!a.composedPath().includes(u)){var h=t.createPointerEvent(n,"pointerleave",u||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,t.notifyTarget(h),o&&t.notifyTarget(h,"mouseleave"),ae.isNode(h.target)&&(h.target=h.target.parentNode);t.freeEvent(h)}t.freeEvent(c)}if(u!==a.target){var f=n.type==="mousemove"?"mouseover":"pointerover",d=t.clonePointerEvent(a,f);t.dispatchEvent(d,"pointerover"),o&&t.dispatchEvent(d,"mouseover");for(var v=u&&ae.isNode(u)&&u.parentNode;v&&v!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode)&&v!==a.target;)v=v.parentNode;var y=!v||v===(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);if(y){var m=t.clonePointerEvent(a,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==u&&m.target!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);)m.currentTarget=m.target,t.notifyTarget(m),o&&t.notifyTarget(m,"mouseenter"),ae.isNode(m.target)&&(m.target=m.target.parentNode);t.freeEvent(m)}t.freeEvent(d)}t.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&t.dispatchEvent(a,"touchmove"),o&&(t.dispatchEvent(a,"mousemove"),t.cursor=t.getCursor(a.target)),s.overTargets=a.composedPath(),t.freeEvent(a)},this.onPointerOut=function(n){var a=t.trackingData(n.pointerId);if(a.overTargets){var o=n.pointerType==="mouse"||n.pointerType==="pen",s=t.findMountedTarget(a.overTargets),u=t.createPointerEvent(n,"pointerout",s||void 0);t.dispatchEvent(u),o&&t.dispatchEvent(u,"mouseout");var l=t.createPointerEvent(n,"pointerleave",s||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);)l.currentTarget=l.target,t.notifyTarget(l),o&&t.notifyTarget(l,"mouseleave"),ae.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=null,t.freeEvent(u),t.freeEvent(l)}t.cursor=null},this.onPointerOver=function(n){var a=t.trackingData(n.pointerId),o=t.createPointerEvent(n),s=o.pointerType==="mouse"||o.pointerType==="pen";t.dispatchEvent(o,"pointerover"),s&&t.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(t.cursor=t.getCursor(o.target));var u=t.clonePointerEvent(o,"pointerenter");for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(ae.isNode(t.rootTarget)&&t.rootTarget.parentNode);)u.currentTarget=u.target,t.notifyTarget(u),s&&t.notifyTarget(u,"mouseenter"),ae.isNode(u.target)&&(u.target=u.target.parentNode);a.overTargets=o.composedPath(),t.freeEvent(o),t.freeEvent(u)},this.onPointerUpOutside=function(n){var a=t.trackingData(n.pointerId),o=t.findMountedTarget(a.pressTargetsByButton[n.button]),s=t.createPointerEvent(n);if(o){for(var u=o;u;)s.currentTarget=u,t.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&t.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),ae.isNode(u)&&(u=u.parentNode);delete a.pressTargetsByButton[n.button]}t.freeEvent(s)},this.onWheel=function(n){var a=t.createWheelEvent(n);t.dispatchEvent(a),t.freeEvent(a)},this.onClick=function(n){if(t.context.config.useNativeClickEvent){var a=t.createPointerEvent(n);t.dispatchEvent(a),t.freeEvent(a)}},this.onPointerCancel=function(n){var a=t.createPointerEvent(n,void 0,void 0,t.context.config.alwaysTriggerPointerEventOnCanvas?t.rootTarget:void 0);t.dispatchEvent(a),t.freeEvent(a)},this.globalRuntime=i,this.context=e}return(0,I.Z)(r,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),t=1,n=1,a=this.context.contextService.getDomElement();if(a&&e){var o=a.offsetWidth,s=a.offsetHeight;o&&s&&(t=e.width/o,n=e.height/s)}return{scaleX:t,scaleY:n,bbox:e}}},{key:"client2Viewport",value:function(e){var t=this.getScale(),n=t.scaleX,a=t.scaleY,o=t.bbox;return new ve((e.x-((o==null?void 0:o.left)||0))/n,(e.y-((o==null?void 0:o.top)||0))/a)}},{key:"viewport2Client",value:function(e){var t=this.getScale(),n=t.scaleX,a=t.scaleY,o=t.bbox;return new ve((e.x+((o==null?void 0:o.left)||0))*n,(e.y+((o==null?void 0:o.top)||0))*a)}},{key:"viewport2Canvas",value:function(e){var t=e.x,n=e.y,a=this.rootTarget.defaultView,o=a.getCamera(),s=this.context.config,u=s.width,l=s.height,c=o.getPerspectiveInverse(),h=o.getWorldTransform(),f=w.multiply(this.tmpMatrix,h,c),d=x.t8(this.tmpVec3,t/u*2-1,(1-n/l)*2-1,0);return x.fF(d,d,f),new ve(d[0],d[1])}},{key:"canvas2Viewport",value:function(e){var t=this.rootTarget.defaultView,n=t.getCamera(),a=n.getPerspective(),o=n.getViewTransform(),s=w.multiply(this.tmpMatrix,a,o),u=x.t8(this.tmpVec3,e.x,e.y,0);x.fF(this.tmpVec3,this.tmpVec3,s);var l=this.context.config,c=l.width,h=l.height;return new ve((u[0]+1)/2*c,(1-(u[1]+1)/2)*h)}},{key:"setPickHandler",value:function(e){this.pickHandler=e}},{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(n,a){return n.priority-a.priority})}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,a=t.length;n<a;n++)t[n].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}}},{key:"dispatchEvent",value:function(e,t,n){if(!n)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var a=this.rootTarget.defaultView||null;e.currentTarget=a,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)}},{key:"propagate",value:function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var a=n.length-1;a>=1;a--)if(e.currentTarget=n[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var o=n.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var s=o+1;s<n.length;s++)if(e.currentTarget=n[s],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(e){var t=[e],n=this.rootTarget.defaultView||null;if(n&&n===e)return t.unshift(n.document),t;for(var a=0;a<$o&&e!==this.rootTarget;a++)ae.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return n&&t.push(n),t}},{key:"hitTest",value:function(e){var t=e.viewportX,n=e.viewportY,a=this.context.config,o=a.width,s=a.height,u=a.disableHitTesting;return t<0||n<0||t>o||n>s?null:!u&&this.pickHandler(e)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(e,t){var n,a=t==null?void 0:t.target;if((n=a)!==null&&n!==void 0&&n.shadowRoot&&(a=t.composedPath()[0]),a){if(a===e)return!0;if(e&&e.contains)return e.contains(a)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var t=0,n=e.nativeEvent.composedPath();t<n.length;t++){var a=n[t],o=this.nativeHTMLMap.get(a);if(o)return o}return null}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})}},{key:"createPointerEvent",value:function(e,t,n,a){var o=this.allocateEvent(mn);this.copyPointerData(e,o),this.copyMouseData(e,o),this.copyData(e,o),o.nativeEvent=e.nativeEvent,o.originalEvent=e;var s=this.getExistedHTML(o),u=this.context.contextService.getDomElement();return o.target=n!=null?n:s||this.isNativeEventFromCanvas(u,o.nativeEvent)&&this.pickTarget(o)||a,typeof t=="string"&&(o.type=t),o}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(yn);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var n=this.getExistedHTML(t),a=this.context.contextService.getDomElement();return t.target=n||this.isNativeEventFromCanvas(a,t.nativeEvent)&&this.pickTarget(t),t}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:"cloneWheelEvent",value:function(e){var t=this.allocateEvent(yn);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t}},{key:"clonePointerEvent",value:function(e,t){var n=this.allocateEvent(mn);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=t!=null?t:n.type,n}},{key:"copyPointerData",value:function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist}},{key:"copyMouseData",value:function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=vn.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}},{key:"notifyTarget",value:function(e,t){var n;t=(n=t)!==null&&n!==void 0?n:e.type;var a=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,a),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}},{key:"notifyListeners",value:function(e,t){var n=e.currentTarget.emitter,a=n._events[t];if(a)if("fn"in a)a.once&&n.removeListener(t,a.fn,void 0,!0),a.fn.call(e.currentTarget||a.context,e);else for(var o=0;o<a.length&&!e.propagationImmediatelyStopped;o++)a[o].once&&n.removeListener(t,a[o].fn,void 0,!0),a[o].fn.call(e.currentTarget||a[o].context,e)}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[e.length-1],n=e.length-2;n>=0;n--){var a=e[n];if(a===this.rootTarget||ae.isNode(a)&&a.parentNode===t)t=e[n];else break}return t}},{key:"getCursor",value:function(e){for(var t=e;t;){var n=lo(t)&&t.getAttribute("cursor");if(n)return n;t=ae.isNode(t)&&t.parentNode}}}])}(),_r=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"getOrCreateCanvas",value:function(e,t){if(this.canvas)return this.canvas;if(e||C.offscreenCanvas)this.canvas=e||C.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,K.Z)({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,K.Z)({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,K.Z)({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(e){}try{return document.createElement("canvas")}catch(e){}return null}}])}(),ft=function(r){return r[r.CAMERA_CHANGED=0]="CAMERA_CHANGED",r[r.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",r[r.NONE=2]="NONE",r}({}),Jo=function(){function r(i,e){(0,D.Z)(this,r),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ke,initAsync:new No,dirtycheck:new gn,cull:new gn,beginFrame:new ke,beforeRender:new ke,render:new ke,afterRender:new ke,endFrame:new ke,destroy:new ke,pick:new wo,pickSync:new gn,pointerDown:new ke,pointerUp:new ke,pointerMove:new ke,pointerOut:new ke,pointerOver:new ke,pointerWheel:new ke,pointerCancel:new ke,click:new ke},this.globalRuntime=i,this.context=e}return(0,I.Z)(r,[{key:"init",value:function(e){var t=this,n=(0,K.Z)((0,K.Z)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(n,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()}).catch(function(a){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var e=this.context.config.renderer,t=e.getConfig(),n=t.enableDirtyRectangleRendering;return!n||this.context.renderingContext.renderReasons.has(ft.CAMERA_CHANGED)}},{key:"render",value:function(e,t,n){var a=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var o=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(o.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),o.renderReasons.size&&this.inited){o.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var s=o.renderReasons.size===1&&o.renderReasons.has(ft.CAMERA_CHANGED),u=!e.disableRenderHooks||!(e.disableRenderHooks&&s);u&&this.renderDisplayObject(o.root,e,o),this.hooks.beginFrame.call(t),u&&o.renderListCurrentFrame.forEach(function(l){a.hooks.beforeRender.call(l),a.hooks.render.call(l),a.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),o.renderListCurrentFrame=[],o.renderReasons.clear(),n()}}},{key:"renderDisplayObject",value:function(e,t,n){var a=this,o=t.renderer.getConfig(),s=o.enableDirtyCheck,u=o.enableCulling;function l(v){var y=v.renderable,m=v.sortable,T=s?y.dirty||n.dirtyRectangleRenderingDisabled?v:null:v;if(T){var M=u?a.hooks.cull.call(T,a.context.camera):T;M&&(a.stats.rendered+=1,n.renderListCurrentFrame.push(M))}y.dirty=!1,m.renderOrder=a.zIndexCounter,a.zIndexCounter+=1,a.stats.total+=1,m.dirty&&(a.sort(v,m),m.dirty=!1,m.dirtyChildren=[],m.dirtyReason=void 0)}for(var c=[e];c.length>0;){var h=c.pop();l(h);for(var f=h.sortable.sorted||h.childNodes,d=f.length-1;d>=0;d--)c.push(f[d])}}},{key:"sort",value:function(e,t){t.sorted&&t.dirtyReason!==Tt.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(n){var a=e.childNodes.indexOf(n);if(a===-1){var o=t.sorted.indexOf(n);o>=0&&t.sorted.splice(o,1)}else if(t.sorted.length===0)t.sorted.push(n);else{var s=co(t.sorted,n);t.sorted.splice(s,0,n)}}):t.sorted=e.childNodes.slice().sort(Pr)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(ft.DISPLAY_OBJECT_CHANGED)}}])}(),Qo=/\[\s*(.*)=(.*)\s*\]/,jo=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"selectOne",value:function(e,t){var n=this;if(e.startsWith("."))return t.find(function(u){return((u==null?void 0:u.classList)||[]).indexOf(n.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(u){return u.id===n.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),o=a.name,s=a.value;return o?t.find(function(u){return t!==u&&(o==="name"?u.name===s:n.attributeToString(u,o)===s)}):null}return t.find(function(u){return t!==u&&u.nodeName===e})}},{key:"selectAll",value:function(e,t){var n=this;if(e.startsWith("."))return t.findAll(function(u){return t!==u&&((u==null?void 0:u.classList)||[]).indexOf(n.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(u){return t!==u&&u.id===n.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),o=a.name,s=a.value;return o?t.findAll(function(u){return t!==u&&(o==="name"?u.name===s:n.attributeToString(u,o)===s)}):[]}return t.findAll(function(u){return t!==u&&u.nodeName===e})}},{key:"is",value:function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var n=this.getAttribute(e),a=n.name,o=n.value;return a==="name"?t.name===o:this.attributeToString(t,a)===o}return t.nodeName===e}},{key:"getIdOrClassname",value:function(e){return e.substring(1)}},{key:"getAttribute",value:function(e){var t=e.match(Qo),n="",a="";return t&&t.length>2&&(n=t[1].replace(/"/g,""),a=t[2].replace(/"/g,"")),{name:n,value:a}}},{key:"attributeToString",value:function(e,t){if(!e.getAttribute)return"";var n=e.getAttribute(t);return(0,fe.Z)(n)?"":n.toString?n.toString():""}}])}(),he=function(r){return r.REPARENT="reparent",r.DESTROY="destroy",r.ATTR_MODIFIED="DOMAttrModified",r.INSERTED="DOMNodeInserted",r.REMOVED="removed",r.MOUNTED="DOMNodeInsertedIntoDocument",r.UNMOUNTED="DOMNodeRemovedFromDocument",r.BOUNDS_CHANGED="bounds-changed",r.CULLED="culled",r}({}),De=function(r){function i(e,t,n,a,o,s,u,l){var c;return(0,D.Z)(this,i),c=(0,J.Z)(this,i,[null]),c.relatedNode=t,c.prevValue=n,c.newValue=a,c.attrName=o,c.attrChange=s,c.prevParsedValue=u,c.newParsedValue=l,c.type=e,c}return(0,Q.Z)(i,r),(0,I.Z)(i)}(Rt);De.ADDITION=2,De.MODIFICATION=1,De.REMOVAL=3;function Zr(r){var i=r.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0)}var qo=new De(he.REPARENT,null,"","","",0,"",""),es=yt.Ue(),Ot=x.Ue(),ts=x.al(1,1,1),ns=w.create(),rs=yt.Ue(),Be=x.Ue(),it=w.create(),Fe=V.Ue(),is=x.Ue(),as=V.Ue(),os=x.Ue(),vt=x.Ue(),ze=x.Ue(),Lt=w.create(),Br=V.Ue(),Fr=V.Ue(),Dt=V.Ue(),En={affectChildren:!0},ss=function(){function r(i){(0,D.Z)(this,r),this.pendingEvents=new Map,this.boundsChangedEvent=new ge(he.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=i}return(0,I.Z)(r,[{key:"matches",value:function(e,t){return this.runtime.sceneGraphSelector.is(e,t)}},{key:"querySelector",value:function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)}},{key:"querySelectorAll",value:function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)}},{key:"attach",value:function(e,t,n){var a,o=!1;e.parentNode&&(o=e.parentNode!==t,this.detach(e));var s=e.nodeName===b.FRAGMENT,u=At(t);e.parentNode=t;var l=s?e.childNodes:[e];(0,$e.Z)(n)?l.forEach(function(d){t.childNodes.splice(n,0,d),d.parentNode=t}):l.forEach(function(d){t.childNodes.push(d),d.parentNode=t});var c=t,h=c.sortable;if((h!=null&&(a=h.sorted)!==null&&a!==void 0&&a.length||e.parsedStyle.zIndex)&&(h.dirtyChildren.indexOf(e)===-1&&h.dirtyChildren.push(e),h.dirty=!0,h.dirtyReason=Tt.ADDED),!u){if(s)this.dirtifyFragment(e);else{var f=e.transformable;f&&this.dirtifyWorld(e,f)}o&&e.dispatchEvent(qo)}}},{key:"detach",value:function(e){if(e.parentNode){var t,n,a=e.transformable,o=e.parentNode,s=o.sortable;(s!=null&&(t=s.sorted)!==null&&t!==void 0&&t.length||(n=e.style)!==null&&n!==void 0&&n.zIndex)&&(s.dirtyChildren.indexOf(e)===-1&&s.dirtyChildren.push(e),s.dirty=!0,s.dirtyReason=Tt.REMOVED);var u=e.parentNode.childNodes.indexOf(e);u>-1&&e.parentNode.childNodes.splice(u,1),a&&this.dirtifyWorld(e,a),e.parentNode=null}}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin}},{key:"setOrigin",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=[t,n,a]);var o=e.transformable;if(!(t[0]===o.origin[0]&&t[1]===o.origin[1]&&t[2]===o.origin[2])){var s=o.origin;s[0]=t[0],s[1]=t[1],s[2]=t[2]||0,this.dirtifyLocal(e,o)}}},{key:"rotate",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=x.al(t,n,a));var o=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.rotateLocal(e,t);else{var s=Fe;V.Su(s,t[0],t[1],t[2]);var u=this.getRotation(e),l=this.getRotation(e.parentNode);V.JG(Dt,l),V.U_(Dt,Dt),V.Jp(s,Dt,s),V.Jp(o.localRotation,s,u),V.Fv(o.localRotation,o.localRotation),this.dirtifyLocal(e,o)}}},{key:"rotateLocal",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=x.al(t,n,a));var o=e.transformable;V.Su(Fr,t[0],t[1],t[2]),V.dC(o.localRotation,o.localRotation,Fr),this.dirtifyLocal(e,o)}},{key:"setEulerAngles",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=x.al(t,n,a));var o=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.setLocalEulerAngles(e,t);else{V.Su(o.localRotation,t[0],t[1],t[2]);var s=this.getRotation(e.parentNode);V.JG(Br,V.U_(Fe,s)),V.dC(o.localRotation,o.localRotation,Br),this.dirtifyLocal(e,o)}}},{key:"setLocalEulerAngles",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof t=="number"&&(t=x.al(t,n,a));var s=e.transformable;V.Su(s.localRotation,t[0],t[1],t[2]),o&&this.dirtifyLocal(e,s)}},{key:"translateLocal",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=x.al(t,n,a));var o=e.transformable;x.fS(t,Ot)||(x.VC(t,t,o.localRotation),x.IH(o.localPosition,o.localPosition,t),this.dirtifyLocal(e,o))}},{key:"setPosition",value:function(e,t){var n,a=e.transformable;if(ze[0]=t[0],ze[1]=t[1],ze[2]=(n=t[2])!==null&&n!==void 0?n:0,!x.fS(this.getPosition(e),ze)){if(x.JG(a.position,ze),e.parentNode===null||!e.parentNode.transformable)x.JG(a.localPosition,ze);else{var o=e.parentNode.transformable;w.copy(Lt,o.worldTransform),w.invert(Lt,Lt),x.fF(a.localPosition,ze,Lt)}this.dirtifyLocal(e,a)}}},{key:"setLocalPosition",value:function(e,t){var n,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=e.transformable;vt[0]=t[0],vt[1]=t[1],vt[2]=(n=t[2])!==null&&n!==void 0?n:0,!x.fS(o.localPosition,vt)&&(x.JG(o.localPosition,vt),a&&this.dirtifyLocal(e,o))}},{key:"scaleLocal",value:function(e,t){var n,a=e.transformable;x.Jp(a.localScale,a.localScale,x.t8(Be,t[0],t[1],(n=t[2])!==null&&n!==void 0?n:1)),this.dirtifyLocal(e,a)}},{key:"setLocalScale",value:function(e,t){var n,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=e.transformable;x.t8(Be,t[0],t[1],(n=t[2])!==null&&n!==void 0?n:o.localScale[2]),!x.fS(Be,o.localScale)&&(x.JG(o.localScale,Be),a&&this.dirtifyLocal(e,o))}},{key:"translate",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t=="number"&&(t=x.t8(Be,t,n,a)),!x.fS(t,Ot)&&(x.IH(Be,this.getPosition(e),t),this.setPosition(e,Be))}},{key:"setRotation",value:function(e,t,n,a,o){var s=e.transformable;if(typeof t=="number"&&(t=V.al(t,n,a,o)),e.parentNode===null||!e.parentNode.transformable)this.setLocalRotation(e,t);else{var u=this.getRotation(e.parentNode);V.JG(Fe,u),V.U_(Fe,Fe),V.Jp(s.localRotation,Fe,t),V.Fv(s.localRotation,s.localRotation),this.dirtifyLocal(e,s)}}},{key:"setLocalRotation",value:function(e,t,n,a,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof t=="number"&&(t=V.t8(Fe,t,n,a,o));var u=e.transformable;V.JG(u.localRotation,t),s&&this.dirtifyLocal(e,u)}},{key:"setLocalSkew",value:function(e,t,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof t=="number"&&(t=yt.t8(rs,t,n));var o=e.transformable;yt.JG(o.localSkew,t),a&&this.dirtifyLocal(e,o)}},{key:"dirtifyLocal",value:function(e,t){At(e)||t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))}},{key:"dirtifyWorld",value:function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)}},{key:"dirtifyFragment",value:function(e){var t=e.transformable;t&&(t.frozen=!1,t.dirtyFlag=!0,t.localDirtyFlag=!0);var n=e.renderable;n&&(n.renderBoundsDirty=!0,n.boundsDirty=!0,n.dirty=!0);for(var a=e.childNodes.length,o=0;o<a;o++)this.dirtifyFragment(e.childNodes[o]);e.nodeName===b.FRAGMENT&&this.pendingEvents.set(e,!1)}},{key:"triggerPendingEvents",value:function(){var e=this,t=new Set,n=function(o,s){!o.isConnected||t.has(o)||o.nodeName===b.FRAGMENT||(e.boundsChangedEvent.detail=s,e.boundsChangedEvent.target=o,o.isMutationObserved?o.dispatchEvent(e.boundsChangedEvent):o.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(o))};this.pendingEvents.forEach(function(a,o){o.nodeName!==b.FRAGMENT&&(En.affectChildren=a,a?o.forEach(function(s){n(s,En)}):n(o,En))}),t.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e;for(n.renderable&&(n.renderable.dirty=!0);n;)Zr(n),n=n.parentNode;t&&e.forEach(function(a){Zr(a)}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,t)}},{key:"updateDisplayObjectDependency",value:function(e,t,n,a){if(t&&t!==n){var o=this.displayObjectDependencyMap.get(t);if(o&&o[e]){var s=o[e].indexOf(a);o[e].splice(s,1)}}if(n){var u=this.displayObjectDependencyMap.get(n);u||(this.displayObjectDependencyMap.set(n,{}),u=this.displayObjectDependencyMap.get(n)),u[e]||(u[e]=[]),u[e].push(a)}}},{key:"informDependentDisplayObjects",value:function(e){var t=this,n=this.displayObjectDependencyMap.get(e);n&&Object.keys(n).forEach(function(a){n[a].forEach(function(o){t.dirtifyToRoot(o,!0),o.dispatchEvent(new De(he.ATTR_MODIFIED,o,t,t,a,De.MODIFICATION,t,t)),o.isCustomElement&&o.isConnected&&o.attributeChangedCallback&&o.attributeChangedCallback(a,t,t)})})}},{key:"getPosition",value:function(e){var t=e.transformable;return w.getTranslation(t.position,this.getWorldTransform(e,t))}},{key:"getRotation",value:function(e){var t=e.transformable;return w.getRotation(t.rotation,this.getWorldTransform(e,t))}},{key:"getScale",value:function(e){var t=e.transformable;return w.getScaling(t.scaling,this.getWorldTransform(e,t))}},{key:"getWorldTransform",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.transformable;return!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation}},{key:"getLocalScale",value:function(e){return e.transformable.localScale}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew}},{key:"calcLocalTransform",value:function(e){var t=e.localSkew[0]!==0||e.localSkew[1]!==0;if(t){w.fromRotationTranslationScaleOrigin(e.localTransform,e.localRotation,e.localPosition,x.al(1,1,1),e.origin),(e.localSkew[0]!==0||e.localSkew[1]!==0)&&(w.identity(it),it[4]=Math.tan(e.localSkew[0]),it[1]=Math.tan(e.localSkew[1]),w.multiply(e.localTransform,e.localTransform,it));var n=w.fromRotationTranslationScaleOrigin(it,V.t8(Fe,0,0,0,1),x.t8(Be,1,1,1),e.localScale,e.origin);w.multiply(e.localTransform,e.localTransform,n)}else{var a=e.localTransform,o=e.localPosition,s=e.localRotation,u=e.localScale,l=e.origin,c=o[0]!==0||o[1]!==0||o[2]!==0,h=s[3]!==1||s[0]!==0||s[1]!==0||s[2]!==0,f=u[0]!==1||u[1]!==1||u[2]!==1,d=l[0]!==0||l[1]!==0||l[2]!==0;!h&&!f&&!d?c?w.fromTranslation(a,o):w.identity(a):w.fromRotationTranslationScaleOrigin(a,s,o,u,l)}}},{key:"getLocalTransform",value:function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform}},{key:"setLocalTransform",value:function(e,t){var n=w.getTranslation(is,t),a=w.getRotation(as,t),o=w.getScaling(os,t);this.setLocalScale(e,o,!1),this.setLocalPosition(e,n,!1),this.setLocalRotation(e,a,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,ts,!1),this.setLocalPosition(e,Ot,!1),this.setLocalEulerAngles(e,Ot,void 0,void 0,!1),this.setLocalSkew(e,es,void 0,!1),this.dirtifyLocal(e,e.transformable)}},{key:"getTransformedGeometryBounds",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2?arguments[2]:void 0,a=this.getGeometryBounds(e,t);if(!de.isEmpty(a)){var o=n||new de;return o.setFromTransformedAABB(a,this.getWorldTransform(e)),o}return null}},{key:"getGeometryBounds",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e,a=n.geometry;a.dirty&&C.styleValueRegistry.updateGeometry(e);var o=t?a.renderBounds:a.contentBounds||null;return o||new de}},{key:"getBounds",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e,o=a.renderable;if(!o.boundsDirty&&!n&&o.bounds)return o.bounds;if(!o.renderBoundsDirty&&n&&o.renderBounds)return o.renderBounds;var s=n?o.renderBounds:o.bounds,u=this.getTransformedGeometryBounds(e,n,s),l=e.childNodes;if(l.forEach(function(f){var d=t.getBounds(f,n);d&&(u?u.add(d):(u=s||new de,u.update(d.center,d.halfExtents)))}),u||(u=new de),n){var c=Mr(e);if(c){var h=c.parsedStyle.clipPath.getBounds(n);u?h&&(u=h.intersection(u)):u.update(h.center,h.halfExtents)}}return n?(o.renderBounds=u,o.renderBoundsDirty=!1):(o.bounds=u,o.boundsDirty=!1),u}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var t=ns;e.parentNode.transformable&&(t=w.invert(it,this.getWorldTransform(e.parentNode)));var n=this.getBounds(e);if(!de.isEmpty(n)){var a=new de;return a.setFromTransformedAABB(n,t),a}}return this.getBounds(e)}},{key:"getBoundingClientRect",value:function(e){var t,n,a=this.getGeometryBounds(e);de.isEmpty(a)||(n=new de,n.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(t=e.ownerDocument)===null||t===void 0||(t=t.defaultView)===null||t===void 0?void 0:t.getContextService().getBoundingClientRect();if(n){var s=n.getMin(),u=(0,re.Z)(s,2),l=u[0],c=u[1],h=n.getMax(),f=(0,re.Z)(h,2),d=f[0],v=f[1];return new qe(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),d-l,v-c)}return new qe((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(e,t){var n=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(s){var u=s.transformable;u.dirtyFlag||n.dirtifyWorldInternal(s,u)});var a=e,o=a.renderable;o&&(o.renderBoundsDirty=!0,o.boundsDirty=!0,o.dirty=!0)}}},{key:"syncHierarchy",value:function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var n=e.childNodes,a=0;a<n.length;a++)this.syncHierarchy(n[a])}}},{key:"sync",value:function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var n=e.parentNode,a=n&&n.transformable;n===null||!a?w.copy(t.worldTransform,t.localTransform):w.multiply(t.worldTransform,a.worldTransform,t.localTransform),t.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(e){for(var t=e.parentNode;t;){var n=t.transformable;n&&(n.frozen=!1),t=t.parentNode}}}])}(),Xe={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Gr=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,us=/[!%),.:;?\]}'""]/,ls=/[$('"]/,cs=/[!),.:;?\]}'""]/,hs=/[([{'"]/,fs=/[)\]'"?!:;,.]/,vs=/[(['"...]/,ds=/[!%),.:;?\]}'"]/,gs=/[$([{'"#]/,ps=new RegExp("".concat(us.source,"|").concat(cs.source,"|").concat(fs.source,"|").concat(ds.source)),ms=new RegExp("".concat(ls.source,"|").concat(hs.source,"|").concat(vs.source,"|").concat(gs.source)),ys=function(){function r(i){var e=this;(0,D.Z)(this,r),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,n){return e.isBreakingSpace(n)?!1:!!(t&&(ms.exec(n)||ps.exec(t)))},this.trimByKinsokuShorui=function(t){var n=(0,ne.Z)(t),a=n[n.length-2];if(!a)return t;var o=a[a.length-1];return n[n.length-2]=a.slice(0,-1),n[n.length-1]=o+n[n.length-1],n},this.runtime=i}return(0,I.Z)(r,[{key:"measureFont",value:function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var n={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),o=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});o.font=e;var s=Xe.MetricsString+Xe.BaselineSymbol,u=Math.ceil(o.measureText(s).width),l=Math.ceil(o.measureText(Xe.BaselineSymbol).width),c=Xe.HeightMultiplier*l;l=l*Xe.BaselineMultiplier|0,a.width=u,a.height=c,o.fillStyle="#f00",o.fillRect(0,0,u,c),o.font=e,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText(s,0,l);var h=o.getImageData(0,0,u||1,c||1).data,f=h.length,d=u*4,v=0,y=0,m=!1;for(v=0;v<l;++v){for(var T=0;T<d;T+=4)if(h[y+T]!==255){m=!0;break}if(!m)y+=d;else break}for(n.ascent=l-v,y=f-d,m=!1,v=c;v>l;--v){for(var M=0;M<d;M+=4)if(h[y+M]!==255){m=!0;break}if(!m)y-=d;else break}return n.descent=v-l,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[e]=n,n}},{key:"measureText",value:function(e,t,n){var a=t.fontSize,o=a===void 0?16:a,s=t.wordWrap,u=s===void 0?!1:s,l=t.lineHeight,c=t.lineWidth,h=c===void 0?1:c,f=t.textBaseline,d=f===void 0?"alphabetic":f,v=t.textAlign,y=v===void 0?"start":v,m=t.letterSpacing,T=m===void 0?0:m,M=t.textPath;t.textPathSide,t.textPathStartOffset;var P=t.leading,Z=P===void 0?0:P,E=Oo(t),g=this.measureFont(E,n);g.fontSize===0&&(g.fontSize=o,g.ascent=o);var p=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);p.font=E,t.isOverflowing=!1;var k=u?this.wordWrap(e,t,n):e,S=k.split(/(?:\r\n|\r|\n)/),N=new Array(S.length),O=0;if(M){M.getTotalLength();for(var L=0;L<S.length;L++)p.measureText(S[L]).width+(S[L].length-1)*T}else{for(var B=0;B<S.length;B++){var F=p.measureText(S[B]).width+(S[B].length-1)*T;N[B]=F,O=Math.max(O,F)}var G=O+h,z=l||g.fontSize+h,_=Math.max(z,g.fontSize+h)+(S.length-1)*(z+Z);z+=Z;var W=0;return d==="middle"?W=-_/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?W=-_:(d==="top"||d==="hanging")&&(W=0),{font:E,width:G,height:_,lines:S,lineWidths:N,lineHeight:z,maxLineWidth:O,fontProperties:g,lineMetrics:N.map(function(X,pe){var me=0;return y==="center"||y==="middle"?me-=X/2:(y==="right"||y==="end")&&(me-=X),new qe(me-h/2,W+pe*z,X+h,z)})}}}},{key:"wordWrap",value:function(e,t,n){var a=this,o=t.wordWrapWidth,s=o===void 0?0:o,u=t.letterSpacing,l=u===void 0?0:u,c=t.maxLines,h=c===void 0?1/0:c,f=t.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),v=s+l,y="";f==="ellipsis"?y="...":f&&f!=="clip"&&(y=f);var m=[],T=0,M=0,P={},Z=function(F){return a.getFromCache(F,l,P,d)},E=Array.from(y).reduce(function(B,F){return B+Z(F)},0);function g(B){if(!(E<=0||E>v)){for(var F=m[B].length,G=0,z=F,_=0;_<F;_++){var W=Z(m[B][_]);if(G+W+E>v){z=_;break}G+=W}m[B]=(m[B]||"").slice(0,z)+y}}for(var p=Array.from(e),k=0;k<p.length;k++){var S=p[k],N=e[k-1],O=e[k+1],L=Z(S);if(this.isNewline(S)){if(T++,T>=h){t.isOverflowing=!0,k<p.length-1&&g(T-1);break}M=0,m[T]="";continue}if(M>0&&M+L>v){if(T+1>=h){t.isOverflowing=!0,g(T);break}if(T++,M=0,m[T]="",this.isBreakingSpace(S))continue;this.canBreakInLastChar(S)||(m=this.trimToBreakable(m),M=this.sumTextWidthByCache(m[T]||"",P)),this.shouldBreakByKinsokuShorui(S,O)&&(m=this.trimByKinsokuShorui(m),M+=Z(N||""))}M+=L,m[T]=(m[T]||"")+S}return m.join(`
`)}},{key:"isBreakingSpace",value:function(e){return typeof e!="string"?!1:Xe.BreakingSpaces.indexOf(e.charCodeAt(0))>=0}},{key:"isNewline",value:function(e){return typeof e!="string"?!1:Xe.Newlines.indexOf(e.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(e){var t=(0,ne.Z)(e),n=t[t.length-2],a=this.findBreakableIndex(n);if(a===-1||!n)return t;var o=n.slice(a,a+1),s=this.isBreakingSpace(o),u=a+1,l=a+(s?0:1);return t[t.length-1]+=n.slice(u,n.length),t[t.length-2]=n.slice(0,l),t}},{key:"canBreakInLastChar",value:function(e){return!(e&&Gr.test(e))}},{key:"sumTextWidthByCache",value:function(e,t){return e.split("").reduce(function(n,a){if(!t[a])throw Error("cannot count the word without cache");return n+t[a]},0)}},{key:"findBreakableIndex",value:function(e){for(var t=e.length-1;t>=0;t--)if(!Gr.test(e[t]))return t;return-1}},{key:"getFromCache",value:function(e,t,n,a){var o=n[e];if(typeof o!="number"){var s=e.length*t;o=a.measureText(e).width+s,n[e]=o}return o}}])}(),C={},Es=function(r){var i=new zo,e=new Wo;return r={},(0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)(r,b.FRAGMENT,null),b.CIRCLE,new Fo),b.ELLIPSE,new Go),b.RECT,i),b.IMAGE,i),b.GROUP,new Vo),b.LINE,new Uo),b.TEXT,new Xo(C)),b.POLYLINE,e),b.POLYGON,e),(0,H.Z)((0,H.Z)((0,H.Z)(r,b.PATH,new Yo),b.HTML,new Ho),b.MESH,null)}(),ks=function(r){var i=new Ka,e=new hn;return r={},(0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)(r,A.PERCENTAGE,null),A.NUMBER,new eo),A.ANGLE,new Ha),A.DEFINED_PATH,new $a),A.PAINT,i),A.COLOR,i),A.FILTER,new Ja),A.LENGTH,e),A.LENGTH_PERCENTAGE,e),A.LENGTH_PERCENTAGE_12,new Qa),(0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)((0,H.Z)(r,A.LENGTH_PERCENTAGE_14,new ja),A.COORDINATE,new hn),A.OFFSET_DISTANCE,new to),A.OPACITY_VALUE,new no),A.PATH,new ro),A.LIST_OF_POINTS,new io),A.SHADOW_BLUR,new ao),A.TEXT,new oo),A.TEXT_TRANSFORM,new so),A.TRANSFORM,new _o),(0,H.Z)((0,H.Z)((0,H.Z)(r,A.TRANSFORM_ORIGIN,new Zo),A.Z_INDEX,new Bo),A.MARKER,new qa)}(),xs=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof U.g!="undefined"?U.g:{}};C.CameraContribution=$n,C.AnimationTimeline=null,C.EasingFunction=null,C.offscreenCanvasCreator=new _r,C.sceneGraphSelector=new jo,C.sceneGraphService=new ss(C),C.textService=new ys(C),C.geometryUpdaterFactory=Es,C.CSSPropertySyntaxFactory=ks,C.styleValueRegistry=new Xa(C),C.layoutRegistry=null,C.globalThis=xs(),C.enableStyleSyntax=!0,C.enableSizeAttenuation=!1;var Ur=0;function iu(){Ur=0}var kn=new De(he.INSERTED,null,"","","",0,"",""),xn=new De(he.REMOVED,null,"","","",0,"",""),Yr=new ge(he.DESTROY),Ts=function(r){function i(){var e;(0,D.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=(0,J.Z)(this,i,[].concat(n)),e.entity=Ur++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.cullable={strategy:bi.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return t!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(ee)}},{key:"appendChild",value:function(t,n){var a;if(t.destroyed)throw new Error(Pi);return C.sceneGraphService.attach(t,this,n),(a=this.ownerDocument)!==null&&a!==void 0&&a.defaultView&&(!At(this)&&t.nodeName===b.FRAGMENT?this.ownerDocument.defaultView.mountFragment(t):this.ownerDocument.defaultView.mountChildren(t)),this.isMutationObserved&&(kn.relatedNode=this,t.dispatchEvent(kn)),t}},{key:"insertBefore",value:function(t,n){if(!n)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var a=this.childNodes.indexOf(n);a===-1?this.appendChild(t):this.appendChild(t,a)}return t}},{key:"replaceChild",value:function(t,n){var a=this.childNodes.indexOf(n);return this.removeChild(n),this.appendChild(t,a),n}},{key:"removeChild",value:function(t){var n;return xn.relatedNode=this,t.dispatchEvent(xn),(n=t.ownerDocument)!==null&&n!==void 0&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),C.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var n=this.childNodes[t];this.removeChild(n)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var n=this.childNodes[t];n.childNodes.length>0&&n.destroyChildren(),n.destroy()}}},{key:"matches",value:function(t){return C.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return C.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return C.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return C.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return C.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return C.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return C.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var n=this;do{if(C.sceneGraphService.matches(t,n))return n;n=n.parentElement}while(n!==null);return null}},{key:"find",value:function(t){var n=this,a=null;return this.forEach(function(o){return o!==n&&t(o)?(a=o,!1):!0}),a}},{key:"findAll",value:function(t){var n=this,a=[];return this.forEach(function(o){o!==n&&t(o)&&a.push(o)}),a}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var n=this.parentNode.childNodes.indexOf(this),a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];o.forEach(function(u,l){var c;return(c=t.parentNode)===null||c===void 0?void 0:c.appendChild(u,n+l+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var t,n=this.parentNode.childNodes.indexOf(this),a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var u=o[0],l=o.slice(1);this.parentNode.appendChild(u,n),(t=u).after.apply(t,(0,ne.Z)(l))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];a.forEach(function(s){return t.appendChild(s)})}},{key:"prepend",value:function(){for(var t=this,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];a.forEach(function(s,u){return t.appendChild(s,u)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(Yr),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return C.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return C.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return C.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return C.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return C.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if(typeof t!="symbol"){var n=this.attributes[t];return n}}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,n,a,o){this.attributes[t]=n}},{key:"getAttributeNS",value:function(t,n){throw new Error(ee)}},{key:"getAttributeNode",value:function(t){throw new Error(ee)}},{key:"getAttributeNodeNS",value:function(t,n){throw new Error(ee)}},{key:"hasAttributeNS",value:function(t,n){throw new Error(ee)}},{key:"removeAttributeNS",value:function(t,n){throw new Error(ee)}},{key:"removeAttributeNode",value:function(t){throw new Error(ee)}},{key:"setAttributeNS",value:function(t,n,a){throw new Error(ee)}},{key:"setAttributeNode",value:function(t){throw new Error(ee)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(ee)}},{key:"toggleAttribute",value:function(t,n){throw new Error(ee)}}])}(ae);function q(r){return!!(r!=null&&r.nodeName)}var Ps=C.globalThis.Proxy?C.globalThis.Proxy:function(){},Ie=new De(he.ATTR_MODIFIED,null,null,null,null,De.MODIFICATION,null,null),dt=x.Ue(),Ms=V.Ue(),oe=function(r){function i(e){var t;return(0,D.Z)(this,i),t=(0,J.Z)(this,i),t.isCustomElement=!1,t.isMutationObserved=!1,t.activeAnimations=[],t.config=e,t.id=e.id||"",t.name=e.name||"",(e.className||e.class)&&(t.className=e.className||e.class),t.nodeName=e.type||b.GROUP,e.initialParsedStyle&&Object.assign(t.parsedStyle,e.initialParsedStyle),t.initAttributes(e.style),C.enableStyleSyntax&&(t.style=new Ps({setProperty:function(a,o){t.setAttribute(a,o)},getPropertyValue:function(a){return t.getAttribute(a)},removeProperty:function(a){t.removeAttribute(a)},item:function(){return""}},{get:function(a,o){return a[o]!==void 0?a[o]:t.getAttribute(o)},set:function(a,o,s){return t.setAttribute(o,s),!0}})),t}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"destroy",value:function(){(0,Un.Z)(i,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel()})}},{key:"cloneNode",value:function(t,n){var a=(0,K.Z)({},this.attributes);for(var o in a){var s=a[o];q(s)&&o!=="clipPath"&&o!=="offsetPath"&&o!=="textPath"&&(a[o]=s.cloneNode(t)),n&&(a[o]=n(o,s))}var u=new this.constructor((0,K.Z)((0,K.Z)({},this.config),{},{style:a}));return u.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);u.appendChild(c)}}),u}},{key:"initAttributes",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n={forceUpdateGeometry:!0};C.styleValueRegistry.processProperties(this,t,n),this.renderable.dirty=!0}},{key:"setAttribute",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;(0,ie.Z)(n)||(a||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:o}),(0,Un.Z)(i,"setAttribute",this,3)([t,n]))}},{key:"internalSetAttribute",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=this.renderable,s=this.attributes[t],u=this.parsedStyle[t];C.styleValueRegistry.processProperties(this,(0,H.Z)({},t,n),a),o.dirty=!0;var l=this.parsedStyle[t];if(this.isConnected&&(Ie.relatedNode=this,Ie.prevValue=s,Ie.newValue=n,Ie.attrName=t,Ie.prevParsedValue=u,Ie.newParsedValue=l,this.isMutationObserved?this.dispatchEvent(Ie):(Ie.target=this,this.ownerDocument.defaultView.dispatchEvent(Ie,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement){var c,h;(c=(h=this).attributeChangedCallback)===null||c===void 0||c.call(h,t,s,n,u,l)}}},{key:"getBBox",value:function(){var t=this.getBounds(),n=t.getMin(),a=(0,re.Z)(n,2),o=a[0],s=a[1],u=t.getMax(),l=(0,re.Z)(u,2),c=l[0],h=l[1];return new qe(o,s,c-o,h-s)}},{key:"setOrigin",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return C.sceneGraphService.setOrigin(this,ye(t,n,a,!1)),this}},{key:"getOrigin",value:function(){return C.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return C.sceneGraphService.setPosition(this,ye(t,n,a,!1)),this}},{key:"setLocalPosition",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return C.sceneGraphService.setLocalPosition(this,ye(t,n,a,!1)),this}},{key:"translate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return C.sceneGraphService.translate(this,ye(t,n,a,!1)),this}},{key:"translateLocal",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return C.sceneGraphService.translateLocal(this,ye(t,n,a,!1)),this}},{key:"getPosition",value:function(){return C.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return C.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,n,a){return this.scaleLocal(t,n,a)}},{key:"scaleLocal",value:function(t,n,a){return typeof t=="number"&&(n=n||t,a=a||t,t=ye(t,n,a,!1)),C.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,n,a){return typeof t=="number"&&(n=n||t,a=a||t,t=ye(t,n,a,!1)),C.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return C.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return C.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var t=Vt(dt,C.sceneGraphService.getWorldTransform(this)),n=(0,re.Z)(t,3),a=n[2];return Me(a)}},{key:"getLocalEulerAngles",value:function(){var t=Vt(dt,C.sceneGraphService.getLocalRotation(this)),n=(0,re.Z)(t,3),a=n[2];return Me(a)}},{key:"setEulerAngles",value:function(t){return C.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return C.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,n,a){return(0,fe.Z)(n)&&(0,fe.Z)(a)?C.sceneGraphService.rotateLocal(this,0,0,t):C.sceneGraphService.rotateLocal(this,t,n,a),this}},{key:"rotate",value:function(t,n,a){return(0,fe.Z)(n)&&(0,fe.Z)(a)?C.sceneGraphService.rotate(this,0,0,t):C.sceneGraphService.rotate(this,t,n,a),this}},{key:"setRotation",value:function(t,n,a,o){return C.sceneGraphService.setRotation(this,t,n,a,o),this}},{key:"setLocalRotation",value:function(t,n,a,o){return C.sceneGraphService.setLocalRotation(this,t,n,a,o),this}},{key:"setLocalSkew",value:function(t,n){return C.sceneGraphService.setLocalSkew(this,t,n),this}},{key:"getRotation",value:function(){return C.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return C.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return C.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return C.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return C.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return C.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){C.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,n){var a,o=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return o?o.play(this,t,n):null}},{key:"isVisible",value:function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,ne.Z)(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,ne.Z)(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=a[0],u=a[1];return s?(0,fi.Z)(s)?(Object.keys(s).forEach(function(l){t.setAttribute(l,s[l])}),this):a.length===2?(this.setAttribute(s,u),this):this.attributes[s]:this.attributes}},{key:"getMatrix",value:function(t){var n=t||this.getWorldTransform(),a=w.getTranslation(dt,n),o=(0,re.Z)(a,2),s=o[0],u=o[1],l=w.getScaling(dt,n),c=(0,re.Z)(l,2),h=c[0],f=c[1],d=w.getRotation(Ms,n),v=Vt(dt,d),y=(0,re.Z)(v,3),m=y[0],T=y[2];return Ri(m||T,s,u,h,f)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var n=zn(t),a=(0,re.Z)(n,5),o=a[0],s=a[1],u=a[2],l=a[3],c=a[4];this.setEulerAngles(c).setPosition(o,s).setLocalScale(u,l)}},{key:"setLocalMatrix",value:function(t){var n=zn(t),a=(0,re.Z)(n,5),o=a[0],s=a[1],u=a[2],l=a[3],c=a[4];this.setLocalEulerAngles(c).setLocalPosition(o,s).setLocalScale(u,l)}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,n){return this.appendChild(t,n)}},{key:"set",value:function(t,n){this.config[t]=n}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(t,n,a),this}},{key:"move",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(t,n,a),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(Ts);oe.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Tn=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.CIRCLE},e)])}return(0,Q.Z)(i,r),(0,I.Z)(i)}(oe);Tn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var Cs=["style"],Ss=function(r){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,a=(0,Ue.Z)(t,Cs);return(0,D.Z)(this,i),e=(0,J.Z)(this,i,[(0,K.Z)({style:n},a)]),e.isCustomElement=!0,e}return(0,Q.Z)(i,r),(0,I.Z)(i)}(oe),Pn=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.ELLIPSE},e)])}return(0,Q.Z)(i,r),(0,I.Z)(i)}(oe);Pn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var au=null,gt=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.GROUP},e)])}return(0,Q.Z)(i,r),(0,I.Z)(i)}(oe);gt.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["width","height"]));var Ns=["style"],Mn=function(r){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,a=(0,Ue.Z)(t,Ns);return(0,D.Z)(this,i),e=(0,J.Z)(this,i,[(0,K.Z)({type:b.HTML,style:n},a)]),e.cullable.enable=!1,e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=w.invert(w.create(),this.parentNode.getWorldTransform()),n=this.getBounds();if(!de.isEmpty(n)){var a=new de;return a.setFromTransformedAABB(n,t),a}}return this.getBounds()}}])}(oe);Mn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var Cn=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.IMAGE},e)])}return(0,Q.Z)(i,r),(0,I.Z)(i)}(oe);Cn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var ws=["style"],Sn=function(r){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,a=(0,Ue.Z)(t,ws);(0,D.Z)(this,i),e=(0,J.Z)(this,i,[(0,K.Z)({type:b.LINE,style:(0,K.Z)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},n)},a)]),e.markerStartAngle=0,e.markerEndAngle=0;var o=e.parsedStyle,s=o.markerStart,u=o.markerEnd;return s&&q(s)&&(e.markerStartAngle=s.getLocalEulerAngles(),e.appendChild(s)),u&&q(u)&&(e.markerEndAngle=u.getLocalEulerAngles(),e.appendChild(u)),e.transformMarker(!0),e.transformMarker(!1),e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"attributeChangedCallback",value:function(t,n,a,o,s){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(o&&q(o)&&(this.markerStartAngle=0,o.remove()),s&&q(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"&&(o&&q(o)&&(this.markerEndAngle=0,o.remove()),s&&q(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var n=this.parsedStyle,a=n.markerStart,o=n.markerEnd,s=n.markerStartOffset,u=n.markerEndOffset,l=n.x1,c=n.x2,h=n.y1,f=n.y2,d=t?a:o;if(!(!d||!q(d))){var v=0,y,m,T,M,P,Z;t?(T=l,M=h,y=c-l,m=f-h,P=s||0,Z=this.markerStartAngle):(T=c,M=f,y=l-c,m=h-f,P=u||0,Z=this.markerEndAngle),v=Math.atan2(m,y),d.setLocalEulerAngles(v*180/Math.PI+Z),d.setLocalPosition(T+Math.cos(v)*P,M+Math.sin(v)*P)}}},{key:"getPoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle,o=a.x1,s=a.y1,u=a.x2,l=a.y2,c=(0,Ze.U4)(o,s,u,l,t),h=c.x,f=c.y,d=x.fF(x.Ue(),x.al(h,f,0),n?this.getWorldTransform():this.getLocalTransform());return new ve(d[0],d[1])}},{key:"getPointAtLength",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(t/this.getTotalLength(),n)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,n=t.x1,a=t.y1,o=t.x2,s=t.y2;return(0,Ze.Xk)(n,a,o,s)}}])}(oe);Sn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var As=["style"],Nn=function(r){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,a=(0,Ue.Z)(t,As);(0,D.Z)(this,i),e=(0,J.Z)(this,i,[(0,K.Z)({type:b.PATH,style:n,initialParsedStyle:{miterLimit:4,d:(0,K.Z)({},Kn)}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var o=e.parsedStyle,s=o.markerStart,u=o.markerEnd,l=o.markerMid;return s&&q(s)&&(e.markerStartAngle=s.getLocalEulerAngles(),e.appendChild(s)),l&&q(l)&&e.placeMarkerMid(l),u&&q(u)&&(e.markerEndAngle=u.getLocalEulerAngles(),e.appendChild(u)),e.transformMarker(!0),e.transformMarker(!1),e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"attributeChangedCallback",value:function(t,n,a,o,s){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(o&&q(o)&&(this.markerStartAngle=0,o.remove()),s&&q(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"?(o&&q(o)&&(this.markerEndAngle=0,o.remove()),s&&q(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(s)}},{key:"transformMarker",value:function(t){var n=this.parsedStyle,a=n.markerStart,o=n.markerEnd,s=n.markerStartOffset,u=n.markerEndOffset,l=t?a:o;if(!(!l||!q(l))){var c=0,h,f,d,v,y,m;if(t){var T=this.getStartTangent(),M=(0,re.Z)(T,2),P=M[0],Z=M[1];d=Z[0],v=Z[1],h=P[0]-Z[0],f=P[1]-Z[1],y=s||0,m=this.markerStartAngle}else{var E=this.getEndTangent(),g=(0,re.Z)(E,2),p=g[0],k=g[1];d=k[0],v=k[1],h=p[0]-k[0],f=p[1]-k[1],y=u||0,m=this.markerEndAngle}c=Math.atan2(f,h),l.setLocalEulerAngles(c*180/Math.PI+m),l.setLocalPosition(d+Math.cos(c)*y,v+Math.sin(c)*y)}}},{key:"placeMarkerMid",value:function(t){var n=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&q(t))for(var a=1;a<n.length-1;a++){var o=(0,re.Z)(n[a].currentPoint,2),s=o[0],u=o[1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(s,u)}}},{key:"getTotalLength",value:function(){return an(this)}},{key:"getPointAtLength",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.d.absolutePath,o=(0,vi.r)(a,t),s=o.x,u=o.y,l=x.fF(x.Ue(),x.al(s,u,0),n?this.getWorldTransform():this.getLocalTransform());return new ve(l[0],l[1])}},{key:"getPoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(t*an(this),n)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,n=[];if(t.length>1){var a=t[0].currentPoint,o=t[1].currentPoint,s=t[1].startTangent;n=[],s?(n.push([a[0]-s[0],a[1]-s[1]]),n.push([a[0],a[1]])):(n.push([o[0],o[1]]),n.push([a[0],a[1]]))}return n}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,n=t.length,a=[];if(n>1){var o=t[n-2].currentPoint,s=t[n-1].currentPoint,u=t[n-1].endTangent;a=[],u?(a.push([s[0]-u[0],s[1]-u[1]]),a.push([s[0],s[1]])):(a.push([o[0],o[1]]),a.push([s[0],s[1]]))}return a}}])}(oe);Nn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var Rs=["style"],pt=function(r){function i(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,a=(0,Ue.Z)(t,Rs);(0,D.Z)(this,i),e=(0,J.Z)(this,i,[(0,K.Z)({type:b.POLYGON,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var o=e.parsedStyle,s=o.markerStart,u=o.markerEnd,l=o.markerMid;return s&&q(s)&&(e.markerStartAngle=s.getLocalEulerAngles(),e.appendChild(s)),l&&q(l)&&e.placeMarkerMid(l),u&&q(u)&&(e.markerEndAngle=u.getLocalEulerAngles(),e.appendChild(u)),e.transformMarker(!0),e.transformMarker(!1),e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"attributeChangedCallback",value:function(t,n,a,o,s){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(o&&q(o)&&(this.markerStartAngle=0,o.remove()),s&&q(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):t==="markerEnd"?(o&&q(o)&&(this.markerEndAngle=0,o.remove()),s&&q(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(s)}},{key:"transformMarker",value:function(t){var n=this.parsedStyle,a=n.markerStart,o=n.markerEnd,s=n.markerStartOffset,u=n.markerEndOffset,l=n.points,c=l||{},h=c.points,f=t?a:o;if(!(!f||!q(f)||!h)){var d=0,v,y,m,T,M,P;if(m=h[0][0],T=h[0][1],t)v=h[1][0]-h[0][0],y=h[1][1]-h[0][1],M=s||0,P=this.markerStartAngle;else{var Z=h.length;this.parsedStyle.isClosed?(v=h[Z-1][0]-h[0][0],y=h[Z-1][1]-h[0][1]):(m=h[Z-1][0],T=h[Z-1][1],v=h[Z-2][0]-h[Z-1][0],y=h[Z-2][1]-h[Z-1][1]),M=u||0,P=this.markerEndAngle}d=Math.atan2(y,v),f.setLocalEulerAngles(d*180/Math.PI+P),f.setLocalPosition(m+Math.cos(d)*M,T+Math.sin(d)*M)}}},{key:"placeMarkerMid",value:function(t){var n=this.parsedStyle.points,a=n||{},o=a.points;if(this.markerMidList.forEach(function(h){h.remove()}),this.markerMidList=[],t&&q(t)&&o)for(var s=1;s<(this.parsedStyle.isClosed?o.length:o.length-1);s++){var u=o[s][0],l=o[s][1],c=s===1?t:t.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(u,l)}}}])}(oe);pt.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var Os=["style"],wn=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.style,n=(0,Ue.Z)(e,Os);return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.POLYLINE,style:t,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},n)])}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"getTotalLength",value:function(){return ma(this)}},{key:"getPointAtLength",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(t/this.getTotalLength(),n)}},{key:"getPoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var o=[],s=0,u,l,c=this.getTotalLength();a.forEach(function(T,M){a[M+1]&&(u=[0,0],u[0]=s/c,l=(0,Ze.Xk)(T[0],T[1],a[M+1][0],a[M+1][1]),s+=l,u[1]=s/c,o.push(u))}),this.parsedStyle.points.segments=o}var h=0,f=0;this.parsedStyle.points.segments.forEach(function(T,M){t>=T[0]&&t<=T[1]&&(h=(t-T[0])/(T[1]-T[0]),f=M)});var d=(0,Ze.U4)(a[f][0],a[f][1],a[f+1][0],a[f+1][1],h),v=d.x,y=d.y,m=x.fF(x.Ue(),x.al(v,y,0),n?this.getWorldTransform():this.getLocalTransform());return new ve(m[0],m[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,n=[];return n.push([t[1][0],t[1][1]]),n.push([t[0][0],t[0][1]]),n}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,n=t.length-1,a=[];return a.push([t[n-1][0],t[n-1][1]]),a.push([t[n][0],t[n][1]]),a}}])}(pt);wn.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(pt.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var An=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.RECT},e)])}return(0,Q.Z)(i,r),(0,I.Z)(i)}(oe);An.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var Ls=["style"],It=function(r){function i(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.style,n=(0,Ue.Z)(e,Ls);return(0,D.Z)(this,i),(0,J.Z)(this,i,[(0,K.Z)({type:b.TEXT,style:(0,K.Z)({fill:"black"},t)},n)])}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(oe);It.PARSED_STYLE_LIST=new Set([].concat((0,ne.Z)(oe.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var Ds=function(){function r(){(0,D.Z)(this,r),this.registry={},this.define(b.CIRCLE,Tn),this.define(b.ELLIPSE,Pn),this.define(b.RECT,An),this.define(b.IMAGE,Cn),this.define(b.LINE,Sn),this.define(b.GROUP,gt),this.define(b.PATH,Nn),this.define(b.POLYGON,pt),this.define(b.POLYLINE,wn),this.define(b.TEXT,It),this.define(b.HTML,Mn)}return(0,I.Z)(r,[{key:"define",value:function(e,t){this.registry[e]=t}},{key:"get",value:function(e){return this.registry[e]}}])}(),Is={number:function(i){return new $(i)},percent:function(i){return new $(i,"%")},px:function(i){return new $(i,"px")},em:function(i){return new $(i,"em")},rem:function(i){return new $(i,"rem")},deg:function(i){return new $(i,"deg")},grad:function(i){return new $(i,"grad")},rad:function(i){return new $(i,"rad")},turn:function(i){return new $(i,"turn")},s:function(i){return new $(i,"s")},ms:function(i){return new $(i,"ms")},registerProperty:function(i){var e=i.name,t=i.inherits,n=i.interpolable,a=i.initialValue,o=i.syntax;C.styleValueRegistry.registerMetadata({n:e,inh:t,int:n,d:a,syntax:o})},registerLayout:function(i,e){C.layoutRegistry.registerLayout(i,e)}},bs=function(r){function i(){var e;(0,D.Z)(this,i),e=(0,J.Z)(this,i),e.defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new C.AnimationTimeline(e)}catch(n){}var t={};return cn.forEach(function(n){var a=n.n,o=n.inh,s=n.d;o&&s&&(t[a]=(0,ot.Z)(s)?s(b.GROUP):s)}),e.documentElement=new gt({id:"g-root",style:t}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,n){if(t==="svg")return this.documentElement;var a=this.defaultView.customElements.get(t);a||(console.warn("Unsupported tagName: ",t),a=t==="tspan"?It:gt);var o=new a(n);return o.ownerDocument=this,o}},{key:"createElementNS",value:function(t,n,a){return this.createElement(n,a)}},{key:"cloneNode",value:function(t){throw new Error(ee)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,n,a,o){var s=this.defaultView.context.rBushRoot,u=s.search({minX:t,minY:n,maxX:a,maxY:o}),l=[];return u.forEach(function(c){var h=c.displayObject,f=h.parsedStyle.pointerEvents,d=f===void 0?"auto":f,v=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(d);(!v||v&&h.isVisible())&&!h.isCulled()&&h.isInteractive()&&l.push(h)}),l.sort(function(c,h){return h.sortable.renderOrder-c.sortable.renderOrder}),l}},{key:"elementFromPointSync",value:function(t,n){var a=this.defaultView.canvas2Viewport({x:t,y:n}),o=a.x,s=a.y,u=this.defaultView.getConfig(),l=u.width,c=u.height;if(o<0||s<0||o>l||s>c)return null;var h=this.defaultView.viewport2Client({x:o,y:s}),f=h.x,d=h.y,v=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:n,viewportX:o,viewportY:s,clientX:f,clientY:d},picked:[]}),y=v.picked;return y&&y[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var e=(0,Yt.Z)((0,Ke.Z)().mark(function n(a,o){var s,u,l,c,h,f,d,v,y,m,T;return(0,Ke.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(s=this.defaultView.canvas2Viewport({x:a,y:o}),u=s.x,l=s.y,c=this.defaultView.getConfig(),h=c.width,f=c.height,!(u<0||l<0||u>h||l>f)){P.next=4;break}return P.abrupt("return",null);case 4:return d=this.defaultView.viewport2Client({x:u,y:l}),v=d.x,y=d.y,P.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:a,y:o,viewportX:u,viewportY:l,clientX:v,clientY:y},picked:[]});case 7:return m=P.sent,T=m.picked,P.abrupt("return",T&&T[0]||this.documentElement);case 10:case"end":return P.stop()}},n,this)}));function t(n,a){return e.apply(this,arguments)}return t}()},{key:"elementsFromPointSync",value:function(t,n){var a=this.defaultView.canvas2Viewport({x:t,y:n}),o=a.x,s=a.y,u=this.defaultView.getConfig(),l=u.width,c=u.height;if(o<0||s<0||o>l||s>c)return[];var h=this.defaultView.viewport2Client({x:o,y:s}),f=h.x,d=h.y,v=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:n,viewportX:o,viewportY:s,clientX:f,clientY:d},picked:[]}),y=v.picked;return y[y.length-1]!==this.documentElement&&y.push(this.documentElement),y}},{key:"elementsFromPoint",value:function(){var e=(0,Yt.Z)((0,Ke.Z)().mark(function n(a,o){var s,u,l,c,h,f,d,v,y,m,T;return(0,Ke.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(s=this.defaultView.canvas2Viewport({x:a,y:o}),u=s.x,l=s.y,c=this.defaultView.getConfig(),h=c.width,f=c.height,!(u<0||l<0||u>h||l>f)){P.next=4;break}return P.abrupt("return",[]);case 4:return d=this.defaultView.viewport2Client({x:u,y:l}),v=d.x,y=d.y,P.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:a,y:o,viewportX:u,viewportY:l,clientX:v,clientY:y},picked:[]});case 7:return m=P.sent,T=m.picked,T[T.length-1]!==this.documentElement&&T.push(this.documentElement),P.abrupt("return",T);case 11:case"end":return P.stop()}},n,this)}));function t(n,a){return e.apply(this,arguments)}return t}()},{key:"appendChild",value:function(t,n){throw new Error(et)}},{key:"insertBefore",value:function(t,n){throw new Error(et)}},{key:"removeChild",value:function(t,n){throw new Error(et)}},{key:"replaceChild",value:function(t,n,a){throw new Error(et)}},{key:"append",value:function(){throw new Error(et)}},{key:"prepend",value:function(){throw new Error(et)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}])}(ae),Wr=function(){function r(i){(0,D.Z)(this,r),this.strategies=i}return(0,I.Z)(r,[{key:"apply",value:function(e){var t=e.camera,n=e.renderingService,a=e.renderingContext,o=this.strategies;n.hooks.cull.tap(r.tag,function(s){if(s){var u=s.cullable;return o.length===0?u.visible=a.unculledEntities.indexOf(s.entity)>-1:u.visible=o.every(function(l){return l.isVisible(t,s)}),!s.isCulled()&&s.isVisible()?s:(s.dispatchEvent(new ge(he.CULLED)),null)}return s}),n.hooks.afterRender.tap(r.tag,function(s){s.cullable.visibilityPlaneMask=-1})}}])}();Wr.tag="Culling";var zr=function(){function r(){var i=this;(0,D.Z)(this,r),this.autoPreventDefault=!1,this.rootPointerEvent=new mn(null),this.rootWheelEvent=new yn(null),this.onPointerMove=function(e){var t,n=(t=i.context.renderingContext.root)===null||t===void 0||(t=t.ownerDocument)===null||t===void 0?void 0:t.defaultView;if(!(n.supportsTouchEvents&&e.pointerType==="touch")){var a=i.normalizeToPointerEvent(e,n),o=(0,Je.Z)(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=i.bootstrapEvent(i.rootPointerEvent,u,n,e);i.context.eventService.mapEvent(l)}}catch(c){o.e(c)}finally{o.f()}i.setCursor(i.context.eventService.cursor)}},this.onClick=function(e){var t,n=(t=i.context.renderingContext.root)===null||t===void 0||(t=t.ownerDocument)===null||t===void 0?void 0:t.defaultView,a=i.normalizeToPointerEvent(e,n),o=(0,Je.Z)(a),s;try{for(o.s();!(s=o.n()).done;){var u=s.value,l=i.bootstrapEvent(i.rootPointerEvent,u,n,e);i.context.eventService.mapEvent(l)}}catch(c){o.e(c)}finally{o.f()}i.setCursor(i.context.eventService.cursor)}}return(0,I.Z)(r,[{key:"apply",value:function(e){var t=this;this.context=e;var n=e.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(o){var s=t.context.renderingService.hooks.pickSync.call({position:o,picked:[],topmost:!0}),u=s.picked;return u[0]||null}),n.hooks.pointerWheel.tap(r.tag,function(o){var s=t.normalizeWheelEvent(o);t.context.eventService.mapEvent(s)}),n.hooks.pointerDown.tap(r.tag,function(o){if(!(a.supportsTouchEvents&&o.pointerType==="touch")){var s=t.normalizeToPointerEvent(o,a);if(t.autoPreventDefault&&s[0].isNormalized){var u=o.cancelable||!("cancelable"in o);u&&o.preventDefault()}var l=(0,Je.Z)(s),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,f=t.bootstrapEvent(t.rootPointerEvent,h,a,o);t.context.eventService.mapEvent(f)}}catch(d){l.e(d)}finally{l.f()}t.setCursor(t.context.eventService.cursor)}}),n.hooks.pointerUp.tap(r.tag,function(o){if(!(a.supportsTouchEvents&&o.pointerType==="touch")){var s=t.context.contextService.getDomElement(),u=t.context.eventService.isNativeEventFromCanvas(s,o),l=u?"":"outside",c=t.normalizeToPointerEvent(o,a),h=(0,Je.Z)(c),f;try{for(h.s();!(f=h.n()).done;){var d=f.value,v=t.bootstrapEvent(t.rootPointerEvent,d,a,o);v.type+=l,t.context.eventService.mapEvent(v)}}catch(y){h.e(y)}finally{h.f()}t.setCursor(t.context.eventService.cursor)}}),n.hooks.pointerMove.tap(r.tag,this.onPointerMove),n.hooks.pointerOver.tap(r.tag,this.onPointerMove),n.hooks.pointerOut.tap(r.tag,this.onPointerMove),n.hooks.click.tap(r.tag,this.onClick),n.hooks.pointerCancel.tap(r.tag,function(o){var s=t.normalizeToPointerEvent(o,a),u=(0,Je.Z)(s),l;try{for(u.s();!(l=u.n()).done;){var c=l.value,h=t.bootstrapEvent(t.rootPointerEvent,c,a,o);t.context.eventService.mapEvent(h)}}catch(f){u.e(f)}finally{u.f()}t.setCursor(t.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(e,t,n,a){e.view=n,e.originalEvent=null,e.nativeEvent=a,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var o=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),s=o.x,u=o.y;e.viewport.x=s,e.viewport.y=u;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,h=l.y;return e.canvas.x=c,e.canvas.y=h,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=a.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=po[e.type]||e.type),e}},{key:"normalizeWheelEvent",value:function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var n=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=n.x,o=n.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),u=s.x,l=s.y;return t.canvas.x=u,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t}},{key:"transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=vn.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(e,t){var n=[];if(t.isTouchEvent(e))for(var a=0;a<e.changedTouches.length;a++){var o=e.changedTouches[a];(0,ie.Z)(o.button)&&(o.button=0),(0,ie.Z)(o.buttons)&&(o.buttons=1),(0,ie.Z)(o.isPrimary)&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),(0,ie.Z)(o.width)&&(o.width=o.radiusX||1),(0,ie.Z)(o.height)&&(o.height=o.radiusY||1),(0,ie.Z)(o.tiltX)&&(o.tiltX=0),(0,ie.Z)(o.tiltY)&&(o.tiltY=0),(0,ie.Z)(o.pointerType)&&(o.pointerType="touch"),(0,ie.Z)(o.pointerId)&&(o.pointerId=o.identifier||0),(0,ie.Z)(o.pressure)&&(o.pressure=o.force||.5),(0,ie.Z)(o.twist)&&(o.twist=0),(0,ie.Z)(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,o.type=e.type,n.push(o)}else if(t.isMouseEvent(e)){var s=e;(0,ie.Z)(s.isPrimary)&&(s.isPrimary=!0),(0,ie.Z)(s.width)&&(s.width=1),(0,ie.Z)(s.height)&&(s.height=1),(0,ie.Z)(s.tiltX)&&(s.tiltX=0),(0,ie.Z)(s.tiltY)&&(s.tiltY=0),(0,ie.Z)(s.pointerType)&&(s.pointerType="mouse"),(0,ie.Z)(s.pointerId)&&(s.pointerId=go),(0,ie.Z)(s.pressure)&&(s.pressure=.5),(0,ie.Z)(s.twist)&&(s.twist=0),(0,ie.Z)(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,n.push(s)}else n.push(e);return n}}])}();zr.tag="Event";var _s=[b.CIRCLE,b.ELLIPSE,b.IMAGE,b.RECT,b.LINE,b.POLYLINE,b.POLYGON,b.TEXT,b.PATH,b.HTML],Zs=function(){function r(){(0,D.Z)(this,r)}return(0,I.Z)(r,[{key:"isVisible",value:function(e,t){var n,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(de.isEmpty(o))return!1;var s=e.getFrustum(),u=(n=t.parentNode)===null||n===void 0||(n=n.cullable)===null||n===void 0?void 0:n.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,u||je.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==je.OUTSIDE,a.visible}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,n,a){if(n===je.OUTSIDE||n===je.INSIDE)return n;for(var o=je.INSIDE,s=_s.indexOf(e.nodeName)>-1,u=0,l=a.length;u<l;++u){var c=1<<u;if(n&c&&!(s&&(u===4||u===5))){var h=a[u],f=h.normal,d=h.distance;if(x.AK(f,t.getPositiveFarPoint(a[u]))+d<0)return je.OUTSIDE;x.AK(f,t.getNegativeFarPoint(a[u]))+d<0&&(o|=c)}}return o}}])}(),Xr=function(){function r(){(0,D.Z)(this,r),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return(0,I.Z)(r,[{key:"apply",value:function(e){var t=this,n,a=e.renderingService,o=e.renderingContext,s=e.rBushRoot,u=o.root.ownerDocument.defaultView;this.rBush=s;var l=function(y){var m=y.target;m.renderable.dirty=!0,a.dirtify()},c=function(y){t.syncTasks.set(y.target,y.detail.affectChildren),a.dirtify()},h=function(y){var m=y.target;C.enableSizeAttenuation&&C.styleValueRegistry.updateSizeAttenuation(m,u.getCamera().getZoom())},f=function(y){var m=y.target,T=m.rBushNode;T.aabb&&t.rBush.remove(T.aabb),t.syncTasks.delete(m),C.sceneGraphService.dirtifyToRoot(m),a.dirtify()};a.hooks.init.tap(r.tag,function(){u.addEventListener(he.MOUNTED,h),u.addEventListener(he.UNMOUNTED,f),u.addEventListener(he.ATTR_MODIFIED,l),u.addEventListener(he.BOUNDS_CHANGED,c)}),a.hooks.destroy.tap(r.tag,function(){u.removeEventListener(he.MOUNTED,h),u.removeEventListener(he.UNMOUNTED,f),u.removeEventListener(he.ATTR_MODIFIED,l),u.removeEventListener(he.BOUNDS_CHANGED,c),t.syncTasks.clear()});var d=(n=C.globalThis.requestIdleCallback)!==null&&n!==void 0?n:dn.bind(C.globalThis);a.hooks.endFrame.tap(r.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,d(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})}},{key:"syncNode",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.isConnected){var n=e.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var a=e.getRenderBounds();if(a){var o=e.renderable;t&&(o.dirtyRenderBounds||(o.dirtyRenderBounds=new de),o.dirtyRenderBounds.update(a.center,a.halfExtents));var s=a.getMin(),u=(0,re.Z)(s,2),l=u[0],c=u[1],h=a.getMax(),f=(0,re.Z)(h,2),d=f[0],v=f[1];n.aabb||(n.aabb={}),n.aabb.displayObject=e,n.aabb.minX=l,n.aabb.minY=c,n.aabb.maxX=d,n.aabb.maxY=v}if(n.aabb&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.minX)&&!isNaN(n.aabb.minY))return n.aabb}}},{key:"syncRTree",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!t&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var n=[],a=new Set,o=function(u){if(!a.has(u)&&u.renderable){var l=e.syncNode(u,t);l&&(n.push(l),a.add(u))}};this.syncTasks.forEach(function(s,u){s&&u.forEach(o);for(var l=u;l;)o(l),l=l.parentElement}),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();Xr.tag="Prepare";function ou(r){return!!r.document}var be=function(r){return r.READY="ready",r.BEFORE_RENDER="beforerender",r.RERENDER="rerender",r.AFTER_RENDER="afterrender",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.RESIZE="resize",r.DIRTY_RECTANGLE="dirtyrectangle",r.RENDERER_CHANGED="rendererchanged",r}({}),Vr=500,Bs=.1,Fs=1e3,bt=new ge(he.MOUNTED),_t=new ge(he.UNMOUNTED),Rn=new ge(be.BEFORE_RENDER),Hr=new ge(be.RERENDER),On=new ge(be.AFTER_RENDER),Gs=function(r){function i(e){var t;(0,D.Z)(this,i),t=(0,J.Z)(this,i),t.Element=oe,t.inited=!1,t.context={},t.document=new bs,t.document.defaultView=t,t.customElements=new Ds;var n=e.container,a=e.canvas,o=e.offscreenCanvas,s=e.width,u=e.height,l=e.devicePixelRatio,c=e.renderer,h=e.background,f=e.cursor,d=e.document,v=e.requestAnimationFrame,y=e.cancelAnimationFrame,m=e.createImage,T=e.enableLargeImageOptimization,M=e.supportsPointerEvents,P=e.supportsTouchEvents,Z=e.supportsCSSTransform,E=e.cleanUpOnDestroy,g=E===void 0?!0:E,p=e.supportsMutipleCanvasesInOneContainer,k=e.useNativeClickEvent,S=e.alwaysTriggerPointerEventOnCanvas,N=e.isTouchEvent,O=e.isMouseEvent,L=e.dblClickSpeed;p||uo(n,t,g);var B=s,F=u,G=l;return a&&(G=l||wt&&window.devicePixelRatio||1,G=G>=1?Math.ceil(G):1,B=s||fo(a)||a.width/G,F=u||vo(a)||a.height/G),o&&(C.offscreenCanvas=o),t.devicePixelRatio=G,t.requestAnimationFrame=v!=null?v:dn.bind(C.globalThis),t.cancelAnimationFrame=y!=null?y:Rr.bind(C.globalThis),t.supportsTouchEvents=P!=null?P:"ontouchstart"in C.globalThis,t.supportsPointerEvents=M!=null?M:!!C.globalThis.PointerEvent,t.isTouchEvent=N!=null?N:function(z){return t.supportsTouchEvents&&z instanceof C.globalThis.TouchEvent},t.isMouseEvent=O!=null?O:function(z){return!C.globalThis.MouseEvent||z instanceof C.globalThis.MouseEvent&&(!t.supportsPointerEvents||!(z instanceof C.globalThis.PointerEvent))},t.dblClickSpeed=L!=null?L:200,t.initRenderingContext({container:n,canvas:a,width:B,height:F,renderer:c,offscreenCanvas:o,devicePixelRatio:G,cursor:f||"default",background:h||"transparent",createImage:m,enableLargeImageOptimization:T,document:d,supportsCSSTransform:Z,useNativeClickEvent:k,cleanUpOnDestroy:g,alwaysTriggerPointerEventOnCanvas:S}),t.initDefaultCamera(B,F,c.clipSpaceNearZ),t.initRenderer(c,!0),t}return(0,Q.Z)(i,r),(0,I.Z)(i,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,n,a){var o=this,s=new C.CameraContribution;s.clipSpaceNearZ=a,s.setType(se.EXPLORING,$t.DEFAULT).setPosition(t/2,n/2,Vr).setFocalPoint(t/2,n/2,0).setOrthographic(t/-2,t/2,n/2,n/-2,Bs,Fs),s.canvas=this,s.eventEmitter.on(Vn.UPDATED,function(){o.context.renderingContext.renderReasons.add(ft.CAMERA_CHANGED),C.enableSizeAttenuation&&o.getConfig().renderer.getConfig().enableSizeAttenuation&&o.updateSizeAttenuation()}),this.context.camera=s}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(n){C.styleValueRegistry.updateSizeAttenuation(n,t)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(n){t.resolveReadyPromise=function(){n(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;n===void 0&&(n=this.getConfig().fastCleanExistingCanvas),n||this.dispatchEvent(new ge(be.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),n||this.dispatchEvent(new ge(be.AFTER_DESTROY));var o=function(u){u.currentTarget=null,u.manager=null,u.target=null,u.relatedNode=null};o(bt),o(_t),o(Rn),o(Hr),o(On),o(Ie),o(kn),o(xn),o(Yr)}},{key:"changeSize",value:function(t,n){this.resize(t,n)}},{key:"resize",value:function(t,n){var a=this.context.config;a.width=t,a.height=n,this.getContextService().resize(t,n);var o=this.context.camera,s=o.getProjectionMode();o.setPosition(t/2,n/2,Vr).setFocalPoint(t/2,n/2,0),s===Ce.ORTHOGRAPHIC?o.setOrthographic(t/-2,t/2,n/2,n/-2,o.getNear(),o.getFar()):o.setAspect(t/n),this.dispatchEvent(new ge(be.RESIZE,{width:t,height:n}))}},{key:"appendChild",value:function(t,n){return this.document.documentElement.appendChild(t,n)}},{key:"insertBefore",value:function(t,n){return this.document.documentElement.insertBefore(t,n)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var n=this;t&&(Rn.detail=t,On.detail=t),this.dispatchEvent(Rn);var a=this.getRenderingService();a.render(this.getConfig(),t,function(){n.dispatchEvent(Hr)}),this.dispatchEvent(On)}},{key:"run",value:function(){var t=this,n=function(o,s){t.render(s),t.frameId=t.requestAnimationFrame(n)};n()}},{key:"initRenderer",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new pi,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new zr,new Xr,new Wr([new Zs])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService((0,K.Z)((0,K.Z)({},C),this.context)),this.context.renderingService=new Jo(C,this.context),this.context.eventService=new Ko(C,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,a,!0)):this.context.contextService.initAsync().then(function(){n.initRenderingService(t,a)})}},{key:"initRenderingService",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){n.inited=!0,a?o?n.requestAnimationFrame(function(){n.dispatchEvent(new ge(be.READY))}):n.dispatchEvent(new ge(be.READY)):n.dispatchEvent(new ge(be.RENDERER_CHANGED)),n.readyPromise&&n.resolveReadyPromise(),a||n.getRoot().forEach(function(s){var u=s,l=u.renderable;l&&(l.renderBoundsDirty=!0,l.boundsDirty=!0,l.dirty=!0)}),n.mountChildren(n.getRoot()),t.getConfig().enableAutoRendering&&n.run()})}},{key:"loadRendererContainerModule",value:function(t){var n=this,a=t.getPlugins();a.forEach(function(o){o.context=n.context,o.init(C)})}},{key:"setRenderer",value:function(t){var n=this.getConfig();if(n.renderer!==t){var a=n.renderer;n.renderer=t,this.destroy(!1,!0),(0,ne.Z)((a==null?void 0:a.getPlugins())||[]).reverse().forEach(function(o){o.destroy(C)}),this.initRenderer(t)}}},{key:"setCursor",value:function(t){var n=this.getConfig();n.cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var n=this;t.childNodes.forEach(function(a){n.unmountChildren(a)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(_t):(_t.target=t,this.dispatchEvent(_t,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:At(t);this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,a||(t.isMutationObserved?t.dispatchEvent(bt):(bt.target=t,this.dispatchEvent(bt,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(o){n.mountChildren(o,a)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,n){return this.client2Viewport({x:t,y:n})}},{key:"getClientByPoint",value:function(t,n){return this.viewport2Client({x:t,y:n})}}])}(br)}}]);
