!(function(){var HM=($t,W)=>(W=Symbol[$t])?W:Symbol.for("Symbol."+$t),yte=$t=>{throw TypeError($t)},vf=Math.pow;var ZM=($t,W,D)=>new Promise((ee,X)=>{var E=he=>{try{re(D.next(he))}catch(se){X(se)}},_e=he=>{try{re(D.throw(he))}catch(se){X(se)}},re=he=>he.done?ee(he.value):Promise.resolve(he.value).then(E,_e);re((D=D.apply($t,W)).next())}),_te=function($t,W){this[0]=$t,this[1]=W};var Ak=$t=>{var W=$t[HM("asyncIterator")],D=!1,ee,X={};return W==null?(W=$t[HM("iterator")](),ee=E=>X[E]=_e=>W[E](_e)):(W=W.call($t),ee=E=>X[E]=_e=>{if(D){if(D=!1,E==="throw")throw _e;return _e}return D=!0,{done:!1,value:new _te(new Promise(re=>{var he=W[E](_e);he instanceof Object||yte("Object expected"),re(he)}),1)}}),X[HM("iterator")]=()=>X,ee("next"),"throw"in W?ee("throw"):X.throw=E=>{throw E},"return"in W&&ee("return"),X};(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[212],{25330:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};W.default=D},67303:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};W.default=D},83647:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};W.default=D},57583:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};W.default=D},29260:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"};W.default=D},25828:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var D={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};W.default=D},64183:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var he,se=1,Se=arguments.length;se<Se;se++){he=arguments[se];for(var oe in he)Object.prototype.hasOwnProperty.call(he,oe)&&(re[oe]=he[oe])}return re},E.apply(this,arguments)},_e=(0,ee.forwardRef)(function(re,he){return ee.createElement(X.P,E({},re,{chartType:"Area",ref:he}))});W.Z=_e},79611:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var he,se=1,Se=arguments.length;se<Se;se++){he=arguments[se];for(var oe in he)Object.prototype.hasOwnProperty.call(he,oe)&&(re[oe]=he[oe])}return re},E.apply(this,arguments)},_e=(0,ee.forwardRef)(function(re,he){return ee.createElement(X.P,E({},re,{chartType:"Bar",ref:he}))});W.Z=_e},7366:function($t,W,D){"use strict";D.d(W,{P:function(){return dte}});var ee={};D.r(ee),D.d(ee,{area:function(){return ka},bottom:function(){return dh},bottomLeft:function(){return dh},bottomRight:function(){return dh},inside:function(){return dh},left:function(){return dh},outside:function(){return vO},right:function(){return dh},spider:function(){return dd},surround:function(){return Bd},top:function(){return dh},topLeft:function(){return dh},topRight:function(){return dh}});var X={};D.r(X),D.d(X,{interpolateBlues:function(){return h9},interpolateBrBG:function(){return W7},interpolateBuGn:function(){return e9},interpolateBuPu:function(){return t9},interpolateCividis:function(){return y9},interpolateCool:function(){return T9},interpolateCubehelixDefault:function(){return E9},interpolateGnBu:function(){return n9},interpolateGreens:function(){return d9},interpolateGreys:function(){return p9},interpolateInferno:function(){return I9},interpolateMagma:function(){return P9},interpolateOrRd:function(){return r9},interpolateOranges:function(){return g9},interpolatePRGn:function(){return G7},interpolatePiYG:function(){return X7},interpolatePlasma:function(){return L9},interpolatePuBu:function(){return o9},interpolatePuBuGn:function(){return i9},interpolatePuOr:function(){return Y7},interpolatePuRd:function(){return a9},interpolatePurples:function(){return m9},interpolateRainbow:function(){return w9},interpolateRdBu:function(){return $7},interpolateRdGy:function(){return K7},interpolateRdPu:function(){return s9},interpolateRdYlBu:function(){return q7},interpolateRdYlGn:function(){return Q7},interpolateReds:function(){return v9},interpolateSinebow:function(){return O9},interpolateSpectral:function(){return J7},interpolateTurbo:function(){return R9},interpolateViridis:function(){return M9},interpolateWarm:function(){return S9},interpolateYlGn:function(){return c9},interpolateYlGnBu:function(){return l9},interpolateYlOrBr:function(){return u9},interpolateYlOrRd:function(){return f9},schemeAccent:function(){return y7},schemeBlues:function(){return LI},schemeBrBG:function(){return hI},schemeBuGn:function(){return xI},schemeBuPu:function(){return EI},schemeCategory10:function(){return g7},schemeDark2:function(){return _7},schemeGnBu:function(){return SI},schemeGreens:function(){return DI},schemeGreys:function(){return NI},schemeObservable10:function(){return b7},schemeOrRd:function(){return TI},schemeOranges:function(){return kI},schemePRGn:function(){return dI},schemePaired:function(){return x7},schemePastel1:function(){return E7},schemePastel2:function(){return S7},schemePiYG:function(){return pI},schemePuBu:function(){return AI},schemePuBuGn:function(){return wI},schemePuOr:function(){return mI},schemePuRd:function(){return CI},schemePurples:function(){return BI},schemeRdBu:function(){return vI},schemeRdGy:function(){return gI},schemeRdPu:function(){return OI},schemeRdYlBu:function(){return yI},schemeRdYlGn:function(){return _I},schemeReds:function(){return FI},schemeSet1:function(){return T7},schemeSet2:function(){return w7},schemeSet3:function(){return A7},schemeSpectral:function(){return bI},schemeTableau10:function(){return C7},schemeYlGn:function(){return MI},schemeYlGnBu:function(){return RI},schemeYlOrBr:function(){return PI},schemeYlOrRd:function(){return II}});var E={};D.r(E),D.d(E,{geoAlbers:function(){return n8},geoAlbersUsa:function(){return E$},geoAzimuthalEqualArea:function(){return S$},geoAzimuthalEqualAreaRaw:function(){return JR},geoAzimuthalEquidistant:function(){return T$},geoAzimuthalEquidistantRaw:function(){return eM},geoConicConformal:function(){return A$},geoConicConformalRaw:function(){return o8},geoConicEqualArea:function(){return fw},geoConicEqualAreaRaw:function(){return t8},geoConicEquidistant:function(){return O$},geoConicEquidistantRaw:function(){return a8},geoEqualEarth:function(){return M$},geoEqualEarthRaw:function(){return tM},geoEquirectangular:function(){return C$},geoEquirectangularRaw:function(){return y2},geoGnomonic:function(){return P$},geoGnomonicRaw:function(){return nM},geoIdentity:function(){return I$},geoMercator:function(){return w$},geoMercatorRaw:function(){return g2},geoNaturalEarth1:function(){return L$},geoNaturalEarth1Raw:function(){return rM},geoOrthographic:function(){return D$},geoOrthographicRaw:function(){return iM},geoProjection:function(){return hv},geoProjectionMutator:function(){return qR},geoStereographic:function(){return N$},geoStereographicRaw:function(){return oM},geoTransverseMercator:function(){return B$},geoTransverseMercatorRaw:function(){return aM}});var _e={};D.r(_e),D.d(_e,{frequency:function(){return Bq},id:function(){return Fq},name:function(){return kq},weight:function(){return Nq}});var re=D(67294),he=D(73935),se=D.t(he,2),Se=function(){return Se=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Se.apply(this,arguments)},oe=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},je=function(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(p){return function(m){return h([p,m])}}function h(p){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(n=0)),n;)try{if(r=1,i&&(s=p[0]&2?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,i=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){n.label=p[1];break}if(p[0]===6&&n.label<s[1]){n.label=s[1],s=p;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(p);break}s[2]&&n.ops.pop(),n.trys.pop();continue}p=t.call(e,n)}catch(m){p=[6,m],i=0}finally{r=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},te=Se({},se),ve=te.version,Be=te.render,Te=te.unmountComponentAtNode,we;try{var le=Number((ve||"").split(".")[0]);le>=18&&(we=te.createRoot)}catch(e){}function Ze(e){var t=te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&typeof t=="object"&&(t.usingClientEntryPoint=e)}var xt="__rc_react_root__";function ft(e,t){Ze(!0);var n=t[xt]||we(t);Ze(!1),n.render(e),t[xt]=n}function Zt(e,t){Be(e,t)}function pt(e,t){}function vt(e,t){if(we){ft(e,t);return}Zt(e,t)}function ke(e){return oe(this,void 0,void 0,function(){return je(this,function(t){return[2,Promise.resolve().then(function(){var n;(n=e[xt])===null||n===void 0||n.unmount(),delete e[xt]})]})})}function Re(e){Te(e)}function bt(e){}function gt(e){return oe(this,void 0,void 0,function(){return je(this,function(t){return we!==void 0?[2,ke(e)]:(Re(e),[2])})})}var Ct=new Map;typeof document!="undefined"&&Ct.set("tooltip",document.createElement("div"));var Sn=function(e,t){t===void 0&&(t=!1);var n=null;if(t)n=Ct.get("tooltip");else if(n=document.createElement("div"),e!=null&&e.key){var r=Ct.get(e.key);r?n=r:Ct.set(e.key,n)}return vt(e,n),n},He=function(e){if(typeof document=="undefined")return"loading";var t=e.attachShadow({mode:"open"}),n=document.createElement("div"),r=document.createElement("style");r.innerHTML=`.loading {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .loading div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #ccc;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
  }
  .loading div:nth-child(1) {
    left: 8px;
    animation: loading1 0.6s infinite;
  }
  .loading div:nth-child(2) {
    left: 8px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(3) {
    left: 32px;
    animation: loading2 0.6s infinite;
  }
  .loading div:nth-child(4) {
    left: 56px;
    animation: loading3 0.6s infinite;
  }
  @keyframes loading1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes loading3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes loading2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  `,n.classList.add("loading"),n.innerHTML="<div></div><div></div><div></div><div></div>",t.appendChild(r),t.appendChild(n)},Ot=function(e){var t=e.loadingTemplate,n=e.theme,r=n===void 0?"light":n,i=re.useRef(null);re.useEffect(function(){!t&&i.current&&He(i.current)},[]);var s=function(){return t||re.createElement("div",{ref:i})};return re.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:r==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},s())},Ce=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ot=function(e){Ce(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.state={hasError:!1},n.renderError=function(r){var i=n.props.errorTemplate;switch(r){default:return typeof i=="function"?i(r):i||re.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",r.message)}},n}return t.getDerivedStateFromError=function(n){return{hasError:!0,error:n}},t.getDerivedStateFromProps=function(n,r){return r.children!==n.children?{children:n.children,hasError:!1,error:void 0}:null},t.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):re.createElement(re.Fragment,null,this.props.children)},t}(re.Component),$e=D(73234),Xe=function(e){var t=/react|\.jsx|children:\[\(|return\s+[A-Za-z0-9].createElement\((?!['"][g|circle|ellipse|image|rect|line|polyline|polygon|text|path|html|mesh]['"])([^\)])*,/i;return t.test(e)},Rt=D(27771),_t=D(77226),Pe=D(50576),Wt=D(68652),on=D(16423),Nn=function(){return Nn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Nn.apply(this,arguments)},jn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function lr(e,t){var n=(0,re.useRef)(),r=(0,re.useRef)(),i=(0,re.useRef)(null),s=t.onReady,l=t.onEvent,u=function(m,y){var b;m===void 0&&(m="image/png");var w=(b=i.current)===null||b===void 0?void 0:b.getElementsByTagName("canvas")[0];return w==null?void 0:w.toDataURL(m,y)},h=function(m,y,b){m===void 0&&(m="download"),y===void 0&&(y="image/png");var w=m;m.indexOf(".")===-1&&(w="".concat(m,".").concat(y.split("/")[1]));var R=u(y,b),P=document.createElement("a");return P.href=R,P.download=w,document.body.appendChild(P),P.click(),document.body.removeChild(P),P=null,w},p=function(m,y){y===void 0&&(y=!1);var b=Object.keys(m),w=y;b.forEach(function(R){var P=m[R];R==="tooltip"&&(w=!0),(0,$e.Z)(P)&&Xe("".concat(P))?m[R]=function(){for(var I=[],N=0;N<arguments.length;N++)I[N]=arguments[N];return Sn(P.apply(void 0,I),w)}:(0,Rt.Z)(P)?P.forEach(function(I){p(I,w)}):(0,_t.Z)(P)?p(P,w):w=y})};return(0,re.useEffect)(function(){if(n.current&&!(0,Pe.Z)(r.current,t)){var m=!1;if(r.current){var y=r.current,b=y.data,w=jn(y,["data"]),R=t.data,P=jn(t,["data"]);m=(0,Pe.Z)(w,P)}r.current=(0,Wt.Z)(t),m?n.current.changeData((0,on.Z)(t,"data")):(p(t),n.current.update(t),n.current.render())}},[t]),(0,re.useEffect)(function(){if(!i.current)return function(){return null};r.current||(r.current=(0,Wt.Z)(t)),p(t);var m=new e(i.current,Nn({},t));m.toDataURL=u,m.downloadImage=h,m.render(),n.current=m,s&&s(m);var y=function(b){l&&l(m,b)};return m.on("*",y),function(){n.current&&(n.current.destroy(),n.current.off("*",y),n.current=void 0)}},[]),{chart:n,container:i}}var Vt="*",en=function(){function e(){this._events={}}return e.prototype.on=function(t,n,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:n,once:!!r}),this},e.prototype.once=function(t,n){return this.on(t,n,!0)},e.prototype.emit=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=this._events[t]||[],l=this._events[Vt]||[],u=function(h){for(var p=h.length,m=0;m<p;m++)if(h[m]){var y=h[m],b=y.callback,w=y.once;w&&(h.splice(m,1),h.length===0&&delete n._events[t],p--,m--),b.apply(n,r)}};u(s),u(l)},e.prototype.off=function(t,n){if(!t)this._events={};else if(!n)delete this._events[t];else{for(var r=this._events[t]||[],i=r.length,s=0;s<i;s++)r[s].callback===n&&(r.splice(s,1),i--,s--);r.length===0&&delete this._events[t]}return this},e.prototype.getEvents=function(){return this._events},e}(),xn=en;const er="main-layer",sn="label-layer",Ut="element",Dt="view",Me="plot",Qe="component",Ft="label",U="area",ue="mask",at={};function ce(e,t){Object.assign(at,{[e]:t})}var j=D(97582),ln=D(38554),fn=ln,mt=D(77160),Gt=D(85975),Wn=D(49685);function hn(){var e=new Wn.WT(9);return Wn.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ht(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Ht(e){var t=new glMatrix.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Cn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ln(e,t,n,r,i,s,l,u,h){var p=new Wn.WT(9);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=i,p[5]=s,p[6]=l,p[7]=u,p[8]=h,p}function Gn(e,t,n,r,i,s,l,u,h,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=l,e[6]=u,e[7]=h,e[8]=p,e}function dt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ye(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Fe(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8],y=m*l-u*p,b=-m*s+u*h,w=p*s-l*h,R=n*y+r*b+i*w;return R?(R=1/R,e[0]=y*R,e[1]=(-m*r+i*p)*R,e[2]=(u*r-i*l)*R,e[3]=b*R,e[4]=(m*n-i*h)*R,e[5]=(-u*n+i*s)*R,e[6]=w*R,e[7]=(-p*n+r*h)*R,e[8]=(l*n-r*s)*R,e):null}function nt(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8];return e[0]=l*m-u*p,e[1]=i*p-r*m,e[2]=r*u-i*l,e[3]=u*h-s*m,e[4]=n*m-i*h,e[5]=i*s-n*u,e[6]=s*p-l*h,e[7]=r*h-n*p,e[8]=n*l-r*s,e}function Pt(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],l=e[5],u=e[6],h=e[7],p=e[8];return t*(p*s-l*h)+n*(-p*i+l*u)+r*(h*i-s*u)}function Mt(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],p=t[6],m=t[7],y=t[8],b=n[0],w=n[1],R=n[2],P=n[3],I=n[4],N=n[5],z=n[6],Z=n[7],Y=n[8];return e[0]=b*r+w*l+R*p,e[1]=b*i+w*u+R*m,e[2]=b*s+w*h+R*y,e[3]=P*r+I*l+N*p,e[4]=P*i+I*u+N*m,e[5]=P*s+I*h+N*y,e[6]=z*r+Z*l+Y*p,e[7]=z*i+Z*u+Y*m,e[8]=z*s+Z*h+Y*y,e}function Tn(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],p=t[6],m=t[7],y=t[8],b=n[0],w=n[1];return e[0]=r,e[1]=i,e[2]=s,e[3]=l,e[4]=u,e[5]=h,e[6]=b*r+w*l+p,e[7]=b*i+w*u+m,e[8]=b*s+w*h+y,e}function $n(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],p=t[6],m=t[7],y=t[8],b=Math.sin(n),w=Math.cos(n);return e[0]=w*r+b*l,e[1]=w*i+b*u,e[2]=w*s+b*h,e[3]=w*l-b*r,e[4]=w*u-b*i,e[5]=w*h-b*s,e[6]=p,e[7]=m,e[8]=y,e}function xr(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function qn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Ae(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function be(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ne(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function et(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=n+n,u=r+r,h=i+i,p=n*l,m=r*l,y=r*u,b=i*l,w=i*u,R=i*h,P=s*l,I=s*u,N=s*h;return e[0]=1-y-R,e[3]=m-N,e[6]=b+I,e[1]=m+N,e[4]=1-p-R,e[7]=w-P,e[2]=b-I,e[5]=w+P,e[8]=1-p-y,e}function wt(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],p=t[7],m=t[8],y=t[9],b=t[10],w=t[11],R=t[12],P=t[13],I=t[14],N=t[15],z=n*u-r*l,Z=n*h-i*l,Y=n*p-s*l,$=r*h-i*u,J=r*p-s*u,ae=i*p-s*h,pe=m*P-y*R,Oe=m*I-b*R,Ve=m*N-w*R,Ke=y*I-b*P,lt=y*N-w*P,Ge=b*N-w*I,rt=z*Ge-Z*lt+Y*Ke+$*Ve-J*Oe+ae*pe;return rt?(rt=1/rt,e[0]=(u*Ge-h*lt+p*Ke)*rt,e[1]=(h*Ve-l*Ge-p*Oe)*rt,e[2]=(l*lt-u*Ve+p*pe)*rt,e[3]=(i*lt-r*Ge-s*Ke)*rt,e[4]=(n*Ge-i*Ve+s*Oe)*rt,e[5]=(r*Ve-n*lt-s*pe)*rt,e[6]=(P*ae-I*J+N*$)*rt,e[7]=(I*Y-R*ae-N*Z)*rt,e[8]=(R*J-P*Y+N*z)*rt,e):null}function qt(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function vn(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function yt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Jt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function Qn(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function Er(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function Vr(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function mr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function kr(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],u=e[5],h=e[6],p=e[7],m=e[8],y=t[0],b=t[1],w=t[2],R=t[3],P=t[4],I=t[5],N=t[6],z=t[7],Z=t[8];return Math.abs(n-y)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-R)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(l-P)<=glMatrix.EPSILON*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(u-I)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(h-N)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(p-z)<=glMatrix.EPSILON*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(m-Z)<=glMatrix.EPSILON*Math.max(1,Math.abs(m),Math.abs(Z))}var Ei=null,Oi=null,ar=D(98333);function Kr(){var e=new Wn.WT(4);return Wn.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function hi(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Qr(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Io(e,t){var n=Math.acos(t[3])*2,r=Math.sin(n/2);return r>glMatrix.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function Ii(e,t){var n=Ri(e,t);return Math.acos(2*n*n-1)}function Fo(e,t,n){var r=t[0],i=t[1],s=t[2],l=t[3],u=n[0],h=n[1],p=n[2],m=n[3];return e[0]=r*m+l*u+i*p-s*h,e[1]=i*m+l*h+s*u-r*p,e[2]=s*m+l*p+r*h-i*u,e[3]=l*m-r*u-i*h-s*p,e}function _a(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],l=t[3],u=Math.sin(n),h=Math.cos(n);return e[0]=r*h+l*u,e[1]=i*h+s*u,e[2]=s*h-i*u,e[3]=l*h-r*u,e}function Co(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],l=t[3],u=Math.sin(n),h=Math.cos(n);return e[0]=r*h-s*u,e[1]=i*h+l*u,e[2]=s*h+r*u,e[3]=l*h-i*u,e}function Qo(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],l=t[3],u=Math.sin(n),h=Math.cos(n);return e[0]=r*h+i*u,e[1]=i*h-r*u,e[2]=s*h+l*u,e[3]=l*h-s*u,e}function De(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function Je(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=Math.sqrt(n*n+r*r+i*i),u=Math.exp(s),h=l>0?u*Math.sin(l)/l:0;return e[0]=n*h,e[1]=r*h,e[2]=i*h,e[3]=u*Math.cos(l),e}function kt(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=Math.sqrt(n*n+r*r+i*i),u=l>0?Math.atan2(l,s)/l:0;return e[0]=n*u,e[1]=r*u,e[2]=i*u,e[3]=.5*Math.log(n*n+r*r+i*i+s*s),e}function un(e,t,n){return kt(e,t),fo(e,e,n),Je(e,e),e}function Bn(e,t,n,r){var i=t[0],s=t[1],l=t[2],u=t[3],h=n[0],p=n[1],m=n[2],y=n[3],b,w,R,P,I;return w=i*h+s*p+l*m+u*y,w<0&&(w=-w,h=-h,p=-p,m=-m,y=-y),1-w>Wn.Ib?(b=Math.acos(w),R=Math.sin(b),P=Math.sin((1-r)*b)/R,I=Math.sin(r*b)/R):(P=1-r,I=r),e[0]=P*i+I*h,e[1]=P*s+I*p,e[2]=P*l+I*m,e[3]=P*u+I*y,e}function kn(e){var t=glMatrix.RANDOM(),n=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=s*Math.sin(2*Math.PI*r),e[3]=s*Math.cos(2*Math.PI*r),e}function pn(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=n*n+r*r+i*i+s*s,u=l?1/l:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=s*u,e}function On(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function vr(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var s=(i+1)%3,l=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[s*3+s]-t[l*3+l]+1),e[i]=.5*r,r=.5/r,e[3]=(t[s*3+l]-t[l*3+s])*r,e[s]=(t[s*3+i]+t[i*3+s])*r,e[l]=(t[l*3+i]+t[i*3+l])*r}return e}function fr(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var s=Math.sin(t),l=Math.cos(t),u=Math.sin(n),h=Math.cos(n),p=Math.sin(r),m=Math.cos(r);return e[0]=s*h*m-l*u*p,e[1]=l*u*m+s*h*p,e[2]=l*h*p-s*u*m,e[3]=l*h*m+s*u*p,e}function ci(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Gi=ar.d9,no=ar.al,Jr=ar.JG,ji=ar.t8,Di=ar.IH,Gr=Fo,fo=ar.bA,Ri=ar.AK,bo=ar.t7,xi=ar.kE,wo=null,ia=ar.we,Ga=null,Jo=ar.Fv,Wo=ar.I6,Ha=ar.fS,ds=function(){var e=mt.Ue(),t=mt.al(1,0,0),n=mt.al(0,1,0);return function(r,i,s){var l=mt.AK(i,s);return l<-.999999?(mt.kC(e,t,i),mt.Zh(e)<1e-6&&mt.kC(e,n,i),mt.Fv(e,e),Qr(r,e,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(mt.kC(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+l,Jo(r,r))}}(),Tt=function(){var e=Kr(),t=Kr();return function(n,r,i,s,l,u){return Bn(e,r,l,u),Bn(t,i,s,u),Bn(n,e,t,2*u*(1-u)),n}}(),Yt=function(){var e=hn();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Jo(t,vr(t,e))}}(),Fn=D(31437),dr=D(25897);function ai(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var Xr=D(95147),Uo=D(95456),Xo=function(e){return(0,Uo.Z)(e,"String")},ya=D(81957),vs={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function nl(e){return Array.isArray(e)&&e.every(function(t){var n=t[0].toLowerCase();return vs[n]===t.length-1&&"achlmqstvz".includes(n)})}function $f(e){return nl(e)&&e.every(function(t){var n=t[0];return n===n.toUpperCase()})}function jd(e){return $f(e)&&e.every(function(t){var n=t[0];return"ACLMQZ".includes(n)})}var Uh={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Pl(e){for(var t=e.pathValue[e.segmentStart],n=t.toLowerCase(),r=e.data;r.length>=vs[n]&&(n==="m"&&r.length>2?(e.segments.push([t].concat(r.splice(0,2))),n="l",t=t==="m"?"l":"L"):e.segments.push([t].concat(r.splice(0,vs[n]))),!!vs[n]););}function Df(e){var t=e.index,n=e.pathValue,r=n.charCodeAt(t);if(r===48){e.param=0,e.index+=1;return}if(r===49){e.param=1,e.index+=1;return}e.err='[path-util]: invalid Arc flag "'+n[t]+'", expecting 0 or 1 at index '+t}function Nf(e){return e>=48&&e<=57||e===43||e===45||e===46}function rc(e){return e>=48&&e<=57}function gu(e){var t=e.max,n=e.pathValue,r=e.index,i=r,s=!1,l=!1,u=!1,h=!1,p;if(i>=t){e.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(p=n.charCodeAt(i),(p===43||p===45)&&(i+=1,p=n.charCodeAt(i)),!rc(p)&&p!==46){e.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" is not a number';return}if(p!==46){if(s=p===48,i+=1,p=n.charCodeAt(i),s&&i<t&&p&&rc(p)){e.err="[path-util]: Invalid path value at index "+r+', "'+n[r]+'" illegal number';return}for(;i<t&&rc(n.charCodeAt(i));)i+=1,l=!0;p=n.charCodeAt(i)}if(p===46){for(h=!0,i+=1;rc(n.charCodeAt(i));)i+=1,u=!0;p=n.charCodeAt(i)}if(p===101||p===69){if(h&&!l&&!u){e.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" invalid float exponent';return}if(i+=1,p=n.charCodeAt(i),(p===43||p===45)&&(i+=1),i<t&&rc(n.charCodeAt(i)))for(;i<t&&rc(n.charCodeAt(i));)i+=1;else{e.err="[path-util]: Invalid path value at index "+i+', "'+n[i]+'" invalid integer exponent';return}}e.index=i,e.param=+e.pathValue.slice(r,i)}function ou(e){var t=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return e===10||e===13||e===8232||e===8233||e===32||e===9||e===11||e===12||e===160||e>=5760&&t.includes(e)}function qu(e){for(var t=e.pathValue,n=e.max;e.index<n&&ou(t.charCodeAt(e.index));)e.index+=1}function lc(e){switch(e|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function Xs(e){return(e|32)===97}function Lu(e){var t=e.max,n=e.pathValue,r=e.index,i=n.charCodeAt(r),s=vs[n[r].toLowerCase()];if(e.segmentStart=r,!lc(i)){e.err='[path-util]: Invalid path value "'+n[r]+'" is not a path command';return}if(e.index+=1,qu(e),e.data=[],!s){Pl(e);return}for(;;){for(var l=s;l>0;l-=1){if(Xs(i)&&(l===3||l===4)?Df(e):gu(e),e.err.length)return;e.data.push(e.param),qu(e),e.index<t&&n.charCodeAt(e.index)===44&&(e.index+=1,qu(e))}if(e.index>=e.max||!Nf(n.charCodeAt(e.index)))break}Pl(e)}var gf=function(){function e(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return e}();function jh(e){if(nl(e))return[].concat(e);var t=new gf(e);for(qu(t);t.index<t.max&&!t.err.length;)Lu(t);return t.err?t.err:t.segments}function bp(e){if($f(e))return[].concat(e);var t=jh(e),n=0,r=0,i=0,s=0;return t.map(function(l){var u=l.slice(1).map(Number),h=l[0],p=h.toUpperCase();if(h==="M")return n=u[0],r=u[1],i=n,s=r,["M",n,r];var m;if(h!==p)switch(p){case"A":m=[p,u[0],u[1],u[2],u[3],u[4],u[5]+n,u[6]+r];break;case"V":m=[p,u[0]+r];break;case"H":m=[p,u[0]+n];break;default:{var y=u.map(function(w,R){return w+(R%2?r:n)});m=[p].concat(y)}}else m=[p].concat(u);var b=m.length;switch(p){case"Z":n=i,r=s;break;case"H":n=m[1];break;case"V":r=m[1];break;default:n=m[b-2],r=m[b-1],p==="M"&&(i=n,s=r)}return m})}function vh(e,t){var n=e[0],r=t.x1,i=t.y1,s=t.x2,l=t.y2,u=e.slice(1).map(Number),h=e;if("TQ".includes(n)||(t.qx=null,t.qy=null),n==="H")h=["L",e[1],i];else if(n==="V")h=["L",r,e[1]];else if(n==="S"){var p=r*2-s,m=i*2-l;t.x1=p,t.y1=m,h=["C",p,m].concat(u)}else if(n==="T"){var y=r*2-t.qx,b=i*2-t.qy;t.qx=y,t.qy=b,h=["Q",y,b].concat(u)}else if(n==="Q"){var w=u[0],R=u[1];t.qx=w,t.qy=R}return h}function Kf(e){if(jd(e))return[].concat(e);for(var t=bp(e),n=(0,j.pi)({},Uh),r=0;r<t.length;r+=1){t[r]=vh(t[r],n);var i=t[r],s=i.length;n.x1=+i[s-2],n.y1=+i[s-1],n.x2=+i[s-4]||n.x1,n.y2=+i[s-3]||n.y1}return t}function Du(e,t,n){var r=e[0],i=e[1],s=t[0],l=t[1];return[r+(s-r)*n,i+(l-i)*n]}function gh(e,t,n,r,i){var s=ai([e,t],[n,r]),l={x:0,y:0};if(typeof i=="number")if(i<=0)l={x:e,y:t};else if(i>=s)l={x:n,y:r};else{var u=Du([e,t],[n,r],i/s),h=u[0],p=u[1];l={x:h,y:p}}return{length:s,point:l,min:{x:Math.min(e,n),y:Math.min(t,r)},max:{x:Math.max(e,n),y:Math.max(t,r)}}}function Vh(e,t){var n=e.x,r=e.y,i=t.x,s=t.y,l=n*i+r*s,u=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(s,2))),h=n*s-r*i<0?-1:1,p=h*Math.acos(l/u);return p}function bd(e,t,n,r,i,s,l,u,h,p){var m=Math.abs,y=Math.sin,b=Math.cos,w=Math.sqrt,R=Math.PI,P=m(n),I=m(r),N=(i%360+360)%360,z=N*(R/180);if(e===u&&t===h)return{x:e,y:t};if(P===0||I===0)return gh(e,t,u,h,p).point;var Z=(e-u)/2,Y=(t-h)/2,$={x:b(z)*Z+y(z)*Y,y:-y(z)*Z+b(z)*Y},J=Math.pow($.x,2)/Math.pow(P,2)+Math.pow($.y,2)/Math.pow(I,2);J>1&&(P*=w(J),I*=w(J));var ae=Math.pow(P,2)*Math.pow(I,2)-Math.pow(P,2)*Math.pow($.y,2)-Math.pow(I,2)*Math.pow($.x,2),pe=Math.pow(P,2)*Math.pow($.y,2)+Math.pow(I,2)*Math.pow($.x,2),Oe=ae/pe;Oe=Oe<0?0:Oe;var Ve=(s!==l?1:-1)*w(Oe),Ke={x:Ve*(P*$.y/I),y:Ve*(-(I*$.x)/P)},lt={x:b(z)*Ke.x-y(z)*Ke.y+(e+u)/2,y:y(z)*Ke.x+b(z)*Ke.y+(t+h)/2},Ge={x:($.x-Ke.x)/P,y:($.y-Ke.y)/I},rt=Vh({x:1,y:0},Ge),st={x:(-$.x-Ke.x)/P,y:(-$.y-Ke.y)/I},ut=Vh(Ge,st);!l&&ut>0?ut-=2*R:l&&ut<0&&(ut+=2*R),ut%=2*R;var jt=rt+ut*p,At=P*b(jt),zt=I*y(jt),wn={x:b(z)*At-y(z)*zt+lt.x,y:y(z)*At+b(z)*zt+lt.y};return wn}function t0(e,t,n,r,i,s,l,u,h,p,m){var y,b=m.bbox,w=b===void 0?!0:b,R=m.length,P=R===void 0?!0:R,I=m.sampleSize,N=I===void 0?30:I,z=typeof p=="number",Z=e,Y=t,$=0,J=[Z,Y,$],ae=[Z,Y],pe=0,Oe={x:0,y:0},Ve=[{x:Z,y:Y}];z&&p<=0&&(Oe={x:Z,y:Y});for(var Ke=0;Ke<=N;Ke+=1){if(pe=Ke/N,y=bd(e,t,n,r,i,s,l,u,h,pe),Z=y.x,Y=y.y,w&&Ve.push({x:Z,y:Y}),P&&($+=ai(ae,[Z,Y])),ae=[Z,Y],z&&$>=p&&p>J[2]){var lt=($-p)/($-J[2]);Oe={x:ae[0]*(1-lt)+J[0]*lt,y:ae[1]*(1-lt)+J[1]*lt}}J=[Z,Y,$]}return z&&p>=$&&(Oe={x:u,y:h}),{length:$,point:Oe,min:{x:Math.min.apply(null,Ve.map(function(Ge){return Ge.x})),y:Math.min.apply(null,Ve.map(function(Ge){return Ge.y}))},max:{x:Math.max.apply(null,Ve.map(function(Ge){return Ge.x})),y:Math.max.apply(null,Ve.map(function(Ge){return Ge.y}))}}}function qf(e,t,n,r,i,s,l,u,h){var p=1-h;return{x:Math.pow(p,3)*e+3*Math.pow(p,2)*h*n+3*p*Math.pow(h,2)*i+Math.pow(h,3)*l,y:Math.pow(p,3)*t+3*Math.pow(p,2)*h*r+3*p*Math.pow(h,2)*s+Math.pow(h,3)*u}}function yu(e,t,n,r,i,s,l,u,h,p){var m,y=p.bbox,b=y===void 0?!0:y,w=p.length,R=w===void 0?!0:w,P=p.sampleSize,I=P===void 0?10:P,N=typeof h=="number",z=e,Z=t,Y=0,$=[z,Z,Y],J=[z,Z],ae=0,pe={x:0,y:0},Oe=[{x:z,y:Z}];N&&h<=0&&(pe={x:z,y:Z});for(var Ve=0;Ve<=I;Ve+=1){if(ae=Ve/I,m=qf(e,t,n,r,i,s,l,u,ae),z=m.x,Z=m.y,b&&Oe.push({x:z,y:Z}),R&&(Y+=ai(J,[z,Z])),J=[z,Z],N&&Y>=h&&h>$[2]){var Ke=(Y-h)/(Y-$[2]);pe={x:J[0]*(1-Ke)+$[0]*Ke,y:J[1]*(1-Ke)+$[1]*Ke}}$=[z,Z,Y]}return N&&h>=Y&&(pe={x:l,y:u}),{length:Y,point:pe,min:{x:Math.min.apply(null,Oe.map(function(lt){return lt.x})),y:Math.min.apply(null,Oe.map(function(lt){return lt.y}))},max:{x:Math.max.apply(null,Oe.map(function(lt){return lt.x})),y:Math.max.apply(null,Oe.map(function(lt){return lt.y}))}}}function Vd(e,t,n,r,i,s,l){var u=1-l;return{x:Math.pow(u,2)*e+2*u*l*n+Math.pow(l,2)*i,y:Math.pow(u,2)*t+2*u*l*r+Math.pow(l,2)*s}}function zl(e,t,n,r,i,s,l,u){var h,p=u.bbox,m=p===void 0?!0:p,y=u.length,b=y===void 0?!0:y,w=u.sampleSize,R=w===void 0?10:w,P=typeof l=="number",I=e,N=t,z=0,Z=[I,N,z],Y=[I,N],$=0,J={x:0,y:0},ae=[{x:I,y:N}];P&&l<=0&&(J={x:I,y:N});for(var pe=0;pe<=R;pe+=1){if($=pe/R,h=Vd(e,t,n,r,i,s,$),I=h.x,N=h.y,m&&ae.push({x:I,y:N}),b&&(z+=ai(Y,[I,N])),Y=[I,N],P&&z>=l&&l>Z[2]){var Oe=(z-l)/(z-Z[2]);J={x:Y[0]*(1-Oe)+Z[0]*Oe,y:Y[1]*(1-Oe)+Z[1]*Oe}}Z=[I,N,z]}return P&&l>=z&&(J={x:i,y:s}),{length:z,point:J,min:{x:Math.min.apply(null,ae.map(function(Ve){return Ve.x})),y:Math.min.apply(null,ae.map(function(Ve){return Ve.y}))},max:{x:Math.max.apply(null,ae.map(function(Ve){return Ve.x})),y:Math.max.apply(null,ae.map(function(Ve){return Ve.y}))}}}function _u(e,t,n){for(var r,i,s,l,u,h,p=Kf(e),m=typeof t=="number",y,b=[],w,R=0,P=0,I=0,N=0,z,Z=[],Y=[],$=0,J={x:0,y:0},ae=J,pe=J,Oe=J,Ve=0,Ke=0,lt=p.length;Ke<lt;Ke+=1)z=p[Ke],w=z[0],y=w==="M",b=y?b:[R,P].concat(z.slice(1)),y?(I=z[1],N=z[2],J={x:I,y:N},ae=J,$=0,m&&t<.001&&(Oe=J)):w==="L"?(r=gh(b[0],b[1],b[2],b[3],(t||0)-Ve),$=r.length,J=r.min,ae=r.max,pe=r.point):w==="A"?(i=t0(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],(t||0)-Ve,n||{}),$=i.length,J=i.min,ae=i.max,pe=i.point):w==="C"?(s=yu(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],(t||0)-Ve,n||{}),$=s.length,J=s.min,ae=s.max,pe=s.point):w==="Q"?(l=zl(b[0],b[1],b[2],b[3],b[4],b[5],(t||0)-Ve,n||{}),$=l.length,J=l.min,ae=l.max,pe=l.point):w==="Z"&&(b=[R,P,I,N],u=gh(b[0],b[1],b[2],b[3],(t||0)-Ve),$=u.length,J=u.min,ae=u.max,pe=u.point),m&&Ve<t&&Ve+$>=t&&(Oe=pe),Y.push(ae),Z.push(J),Ve+=$,h=w!=="Z"?z.slice(-2):[I,N],R=h[0],P=h[1];return m&&t>=Ve&&(Oe={x:R,y:P}),{length:Ve,point:Oe,min:{x:Math.min.apply(null,Z.map(function(Ge){return Ge.x})),y:Math.min.apply(null,Z.map(function(Ge){return Ge.y}))},max:{x:Math.max.apply(null,Y.map(function(Ge){return Ge.x})),y:Math.max.apply(null,Y.map(function(Ge){return Ge.y}))}}}function Qu(e,t){return _u(e,void 0,(0,j.pi)((0,j.pi)({},t),{bbox:!1,length:!0})).length}var _s=function(e){return Array.isArray?Array.isArray(e):(0,Uo.Z)(e,"Array")},au=function(e){if(_s(e))return e.reduce(function(t,n){return Math.min(t,n)},e[0])},xc=function(e){if(_s(e))return e.reduce(function(t,n){return Math.max(t,n)},e[0])},Ju=1e-5;function hl(e,t,n){return n===void 0&&(n=Ju),Math.abs(e-t)<n}var Nu=function(e,t){return(e%t+t)%t},ef=Nu;function Hd(e,t,n){if(e[n].length>7){e[n].shift();for(var r=e[n],i=n;r.length;)t[n]="A",e.splice(i+=1,0,["C"].concat(r.splice(0,6)));e.splice(n,1)}}function Hh(e){return jd(e)&&e.every(function(t){var n=t[0];return"MC".includes(n)})}function ns(e,t,n){var r=e*Math.cos(n)-t*Math.sin(n),i=e*Math.sin(n)+t*Math.cos(n);return{x:r,y:i}}function yh(e,t,n,r,i,s,l,u,h,p){var m=e,y=t,b=n,w=r,R=u,P=h,I=Math.PI*120/180,N=Math.PI/180*(+i||0),z=[],Z,Y,$,J,ae;if(p)Y=p[0],$=p[1],J=p[2],ae=p[3];else{Z=ns(m,y,-N),m=Z.x,y=Z.y,Z=ns(R,P,-N),R=Z.x,P=Z.y;var pe=(m-R)/2,Oe=(y-P)/2,Ve=pe*pe/(b*b)+Oe*Oe/(w*w);Ve>1&&(Ve=Math.sqrt(Ve),b*=Ve,w*=Ve);var Ke=b*b,lt=w*w,Ge=(s===l?-1:1)*Math.sqrt(Math.abs((Ke*lt-Ke*Oe*Oe-lt*pe*pe)/(Ke*Oe*Oe+lt*pe*pe)));J=Ge*b*Oe/w+(m+R)/2,ae=Ge*-w*pe/b+(y+P)/2,Y=Math.asin(((y-ae)/w*Math.pow(10,9)>>0)/Math.pow(10,9)),$=Math.asin(((P-ae)/w*Math.pow(10,9)>>0)/Math.pow(10,9)),Y=m<J?Math.PI-Y:Y,$=R<J?Math.PI-$:$,Y<0&&(Y=Math.PI*2+Y),$<0&&($=Math.PI*2+$),l&&Y>$&&(Y-=Math.PI*2),!l&&$>Y&&($-=Math.PI*2)}var rt=$-Y;if(Math.abs(rt)>I){var st=$,ut=R,jt=P;$=Y+I*(l&&$>Y?1:-1),R=J+b*Math.cos($),P=ae+w*Math.sin($),z=yh(R,P,b,w,i,0,l,ut,jt,[$,st,J,ae])}rt=$-Y;var At=Math.cos(Y),zt=Math.sin(Y),wn=Math.cos($),Hn=Math.sin($),rr=Math.tan(rt/4),or=4/3*b*rr,Hr=4/3*w*rr,ui=[m,y],Qi=[m+or*zt,y-Hr*At],ii=[R+or*Hn,P-Hr*wn],ti=[R,P];if(Qi[0]=2*ui[0]-Qi[0],Qi[1]=2*ui[1]-Qi[1],p)return Qi.concat(ii,ti,z);z=Qi.concat(ii,ti,z);for(var Po=[],Ji=0,Vi=z.length;Ji<Vi;Ji+=1)Po[Ji]=Ji%2?ns(z[Ji-1],z[Ji],N).y:ns(z[Ji],z[Ji+1],N).x;return Po}function Zh(e,t,n,r,i,s){var l=.3333333333333333,u=2/3;return[l*e+u*n,l*t+u*r,l*i+u*n,l*s+u*r,i,s]}var Wh=function(e,t,n,r){var i=.5,s=Du([e,t],[n,r],i);return(0,j.ev)((0,j.ev)([],s,!0),[n,r,n,r],!1)};function rl(e,t){var n=e[0],r=e.slice(1).map(Number),i=r[0],s=r[1],l,u=t.x1,h=t.y1,p=t.x,m=t.y;switch("TQ".includes(n)||(t.qx=null,t.qy=null),n){case"M":return t.x=i,t.y=s,e;case"A":return l=[u,h].concat(r),["C"].concat(yh(l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9]));case"Q":return t.qx=i,t.qy=s,l=[u,h].concat(r),["C"].concat(Zh(l[0],l[1],l[2],l[3],l[4],l[5]));case"L":return["C"].concat(Wh(u,h,i,s));case"Z":return u===p&&h===m?["C",u,h,p,m,p,m]:["C"].concat(Wh(u,h,p,m));default:}return e}function Bf(e,t){if(t===void 0&&(t=!1),Hh(e)){var n=[].concat(e);return t?[n,[]]:n}for(var r=Kf(e),i=(0,j.pi)({},Uh),s=[],l="",u=r.length,h,p,m=[],y=0;y<u;y+=1){r[y]&&(l=r[y][0]),s[y]=l;var b=rl(r[y],i);r[y]=b,Hd(r,s,y),u=r.length,l==="Z"&&m.push(y),h=r[y],p=h.length,i.x1=+h[p-2],i.y1=+h[p-1],i.x2=+h[p-4]||i.x1,i.y2=+h[p-3]||i.y1}return t?[r,m]:r}function _h(e,t){t===void 0&&(t=.5);var n=e.slice(0,2),r=e.slice(2,4),i=e.slice(4,6),s=e.slice(6,8),l=Du(n,r,t),u=Du(r,i,t),h=Du(i,s,t),p=Du(l,u,t),m=Du(u,h,t),y=Du(p,m,t);return[["C"].concat(l,p,y),["C"].concat(m,h,s)]}function ne(e){return e.map(function(t,n,r){var i=n&&r[n-1].slice(-2).concat(t.slice(1)),s=n?yu(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,l;return n?l=s?_h(i):[t,t]:l=[t],{s:t,ss:l,l:s}})}function ge(e,t,n){var r=ne(e),i=ne(t),s=r.length,l=i.length,u=r.filter(function(I){return I.l}).length,h=i.filter(function(I){return I.l}).length,p=r.filter(function(I){return I.l}).reduce(function(I,N){var z=N.l;return I+z},0)/u||0,m=i.filter(function(I){return I.l}).reduce(function(I,N){var z=N.l;return I+z},0)/h||0,y=n||Math.max(s,l),b=[p,m],w=[y-s,y-l],R=0,P=[r,i].map(function(I,N){return I.l===y?I.map(function(z){return z.s}):I.map(function(z,Z){return R=Z&&w[N]&&z.l>=b[N],w[N]-=R?1:0,R?z.ss:[z.s]}).flat()});return P[0].length===P[1].length?P:ge(P[0],P[1],y)}function qe(e,t,n,r,i,s,l,u){return 3*((u-t)*(n+i)-(l-e)*(r+s)+r*(e-i)-n*(t-s)+u*(i+e/3)-l*(s+t/3))/20}function mn(e){var t=0,n=0,r=0;return Bf(e).map(function(i){var s;switch(i[0]){case"M":return t=i[1],n=i[2],0;default:var l=i.slice(1),u=l[0],h=l[1],p=l[2],m=l[3],y=l[4],b=l[5];return r=qe(t,n,u,h,p,m,y,b),s=i.slice(-2),t=s[0],n=s[1],r}}).reduce(function(i,s){return i+s},0)}function K(e){return mn(e)>=0}function tr(e){var t=e.slice(1).map(function(n,r,i){return r?i[r-1].slice(-2).concat(n.slice(1)):e[0].slice(1).concat(n.slice(1))}).map(function(n){return n.map(function(r,i){return n[n.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map(function(n){return["C"].concat(n.slice(2))}))}function Mr(e){return e.map(function(t){return Array.isArray(t)?[].concat(t):t})}function Bi(e){var t=e.length,n=t-1;return e.map(function(r,i){return e.map(function(s,l){var u=i+l,h;return l===0||e[u]&&e[u][0]==="M"?(h=e[u],["M"].concat(h.slice(-2))):(u>=t&&(u-=n),e[u])})})}function zi(e,t){var n=e.length-1,r=[],i=0,s=0,l=Bi(e);return l.forEach(function(u,h){e.slice(1).forEach(function(p,m){s+=ai(e[(h+m)%n].slice(-2),t[m%n].slice(-2))}),r[h]=s,s=0}),i=r.indexOf(Math.min.apply(null,r)),l[i]}var so=function(e){return e===void 0},Si=so,Sa=function(e){return(0,Uo.Z)(e,"Boolean")},Do=Sa,ha=function(e){var t=typeof e;return e!==null&&t==="object"||t==="function"};function rs(e,t,n){return _u(e,t,(0,j.pi)((0,j.pi)({},n),{bbox:!1,length:!0})).point}function ua(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Aa(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ls(){}var Ma=.7,Da=1/Ma,Xa="\\s*([+-]?\\d+)\\s*",Ls="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ec=/^#([0-9a-f]{3,8})$/,cs=new RegExp("^rgb\\(".concat(Xa,",").concat(Xa,",").concat(Xa,"\\)$")),Bu=new RegExp("^rgb\\(".concat(Qa,",").concat(Qa,",").concat(Qa,"\\)$")),bu=new RegExp("^rgba\\(".concat(Xa,",").concat(Xa,",").concat(Xa,",").concat(Ls,"\\)$")),Nc=new RegExp("^rgba\\(".concat(Qa,",").concat(Qa,",").concat(Qa,",").concat(Ls,"\\)$")),Qf=new RegExp("^hsl\\(".concat(Ls,",").concat(Qa,",").concat(Qa,"\\)$")),xd=new RegExp("^hsla\\(".concat(Ls,",").concat(Qa,",").concat(Qa,",").concat(Ls,"\\)$")),bh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ua(ls,Fu,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:yf,formatHex:yf,formatHex8:tf,formatHsl:Gh,formatRgb:xh,toString:xh});function yf(){return this.rgb().formatHex()}function tf(){return this.rgb().formatHex8()}function Gh(){return ks(this).formatHsl()}function xh(){return this.rgb().formatRgb()}function Fu(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ec.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?n0(t):n===3?new Bc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Jf(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Jf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=cs.exec(e))?new Bc(t[1],t[2],t[3],1):(t=Bu.exec(e))?new Bc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=bu.exec(e))?Jf(t[1],t[2],t[3],t[4]):(t=Nc.exec(e))?Jf(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Qf.exec(e))?_f(t[1],t[2]/100,t[3]/100,1):(t=xd.exec(e))?_f(t[1],t[2]/100,t[3]/100,t[4]):bh.hasOwnProperty(e)?n0(bh[e]):e==="transparent"?new Bc(NaN,NaN,NaN,0):null}function n0(e){return new Bc(e>>16&255,e>>8&255,e&255,1)}function Jf(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bc(e,t,n,r)}function xp(e){return e instanceof ls||(e=Fu(e)),e?(e=e.rgb(),new Bc(e.r,e.g,e.b,e.opacity)):new Bc}function Ed(e,t,n,r){return arguments.length===1?xp(e):new Bc(e,t,n,r==null?1:r)}function Bc(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ua(Bc,Ed,Aa(ls,{brighter:function(t){return t=t==null?Da:Math.pow(Da,t),new Bc(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Ma:Math.pow(Ma,t),new Bc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new Bc(xu(this.r),xu(this.g),xu(this.b),Yh(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xh,formatHex:Xh,formatHex8:Zd,formatRgb:Eh,toString:Eh}));function Xh(){return"#".concat(Sh(this.r)).concat(Sh(this.g)).concat(Sh(this.b))}function Zd(){return"#".concat(Sh(this.r)).concat(Sh(this.g)).concat(Sh(this.b)).concat(Sh((isNaN(this.opacity)?1:this.opacity)*255))}function Eh(){var e=Yh(this.opacity);return"".concat(e===1?"rgb(":"rgba(").concat(xu(this.r),", ").concat(xu(this.g),", ").concat(xu(this.b)).concat(e===1?")":", ".concat(e,")"))}function Yh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Sh(e){return e=xu(e),(e<16?"0":"")+e.toString(16)}function _f(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Gl(e,t,n,r)}function ks(e){if(e instanceof Gl)return new Gl(e.h,e.s,e.l,e.opacity);if(e instanceof ls||(e=Fu(e)),!e)return new Gl;if(e instanceof Gl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),l=NaN,u=s-i,h=(s+i)/2;return u?(t===s?l=(n-r)/u+(n<r)*6:n===s?l=(r-t)/u+2:l=(t-n)/u+4,u/=h<.5?s+i:2-s-i,l*=60):u=h>0&&h<1?0:l,new Gl(l,u,h,e.opacity)}function Wd(e,t,n,r){return arguments.length===1?ks(e):new Gl(e,t,n,r==null?1:r)}function Gl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ua(Gl,Wd,Aa(ls,{brighter:function(t){return t=t==null?Da:Math.pow(Da,t),new Gl(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Ma:Math.pow(Ma,t),new Gl(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new Bc(ct(t>=240?t-240:t+120,s,i),ct(t,s,i),ct(t<120?t+240:t-120,s,i),this.opacity)},clamp:function(){return new Gl(fe(this.h),Ie(this.s),Ie(this.l),Yh(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=Yh(this.opacity);return"".concat(t===1?"hsl(":"hsla(").concat(fe(this.h),", ").concat(Ie(this.s)*100,"%, ").concat(Ie(this.l)*100,"%").concat(t===1?")":", ".concat(t,")"))}}));function fe(e){return e=(e||0)%360,e<0?e+360:e}function Ie(e){return Math.max(0,Math.min(1,e||0))}function ct(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function gn(e,t,n,r){var i=e-n,s=t-r;return Math.sqrt(i*i+s*s)}function ir(e,t){var n=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(e),!1)),r=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(t),!1)),i=Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(e),!1)),s=Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(t),!1));return{x:n,y:r,width:i-n,height:s-r}}function Ur(e){return(e+Math.PI*2)%(Math.PI*2)}function mi(e,t){var n=Math.abs(e);return t>0?n:n*-1}function Ki(e,t,n,r,i,s){var l=n,u=r;if(l===0||u===0)return{x:e,y:t};for(var h=i-e,p=s-t,m=Math.abs(h),y=Math.abs(p),b=l*l,w=u*u,R=Math.PI/4,P=0,I=0,N=0;N<4;N++){P=l*Math.cos(R),I=u*Math.sin(R);var z=(b-w)*Math.pow(Math.cos(R),3)/l,Z=(w-b)*Math.pow(Math.sin(R),3)/u,Y=P-z,$=I-Z,J=m-z,ae=y-Z,pe=Math.hypot($,Y),Oe=Math.hypot(ae,J),Ve=pe*Math.asin((Y*ae-$*J)/(pe*Oe)),Ke=Ve/Math.sqrt(b+w-P*P-I*I);R+=Ke,R=Math.min(Math.PI/2,Math.max(0,R))}return{x:e+mi(P,h),y:t+mi(I,p)}}function ma(e,t,n,r,i,s,l,u){return-1*n*Math.cos(i)*Math.sin(u)-r*Math.sin(i)*Math.cos(u)}function ba(e,t,n,r,i,s,l,u){return-1*n*Math.sin(i)*Math.sin(u)+r*Math.cos(i)*Math.cos(u)}function bs(e,t,n){return Math.atan(-t/e*Math.tan(n))}function za(e,t,n){return Math.atan(t/(e*Math.tan(n)))}function Na(e,t,n,r,i,s){return n*Math.cos(i)*Math.cos(s)-r*Math.sin(i)*Math.sin(s)+e}function Sc(e,t,n,r,i,s){return n*Math.sin(i)*Math.cos(s)+r*Math.cos(i)*Math.sin(s)+t}function nf(e,t,n,r){var i=Math.atan2(r*e,n*t);return(i+Math.PI*2)%(Math.PI*2)}function Ys(e,t,n){return{x:e*Math.cos(n),y:t*Math.sin(n)}}function io(e,t,n){var r=Math.cos(n),i=Math.sin(n);return[e*r-t*i,e*i+t*r]}function Wc(e,t,n,r,i,s,l){for(var u=bs(n,r,i),h=1/0,p=-1/0,m=[s,l],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var b=u+y;s<l?s<b&&b<l&&m.push(b):l<b&&b<s&&m.push(b)}for(var y=0;y<m.length;y++){var w=Na(e,t,n,r,i,m[y]);w<h&&(h=w),w>p&&(p=w)}for(var R=za(n,r,i),P=1/0,I=-1/0,N=[s,l],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var z=R+y;s<l?s<z&&z<l&&N.push(z):l<z&&z<s&&N.push(z)}for(var y=0;y<N.length;y++){var Z=Sc(e,t,n,r,i,N[y]);Z<P&&(P=Z),Z>I&&(I=Z)}return{x:h,y:P,width:p-h,height:I-P}}function Gd(e,t,n,r,i,s,l,u,h){var p=io(u-e,h-t,-i),m=__read(p,2),y=m[0],b=m[1],w=Ki(0,0,n,r,y,b),R=nf(n,r,w.x,w.y);R<s?w=Ys(n,r,s):R>l&&(w=Ys(n,r,l));var P=io(w.x,w.y,i);return{x:P[0]+e,y:P[1]+t}}function $h(e,t,n,r,i,s,l,u){var h=(l-s)*u+s,p=ma(e,t,n,r,i,s,l,h),m=ba(e,t,n,r,i,s,l,h);return Ur(Math.atan2(m,p))}var _l=1e-4;function Ja(e,t,n,r,i,s){var l=-1,u=1/0,h=[n,r],p=20;s&&s>200&&(p=s/10);for(var m=1/p,y=m/10,b=0;b<=p;b++){var w=b*m,R=[i.apply(void 0,(0,j.ev)([],(0,j.CR)(e.concat([w])),!1)),i.apply(void 0,(0,j.ev)([],(0,j.CR)(t.concat([w])),!1))],P=gn(h[0],h[1],R[0],R[1]);P<u&&(l=w,u=P)}if(l===0)return{x:e[0],y:t[0]};if(l===1){var I=e.length;return{x:e[I-1],y:t[I-1]}}u=1/0;for(var b=0;b<32&&!(y<_l);b++){var N=l-y,z=l+y,R=[i.apply(void 0,(0,j.ev)([],(0,j.CR)(e.concat([N])),!1)),i.apply(void 0,(0,j.ev)([],(0,j.CR)(t.concat([N])),!1))],P=gn(h[0],h[1],R[0],R[1]);if(N>=0&&P<u)l=N,u=P;else{var Z=[i.apply(void 0,(0,j.ev)([],(0,j.CR)(e.concat([z])),!1)),i.apply(void 0,(0,j.ev)([],(0,j.CR)(t.concat([z])),!1))],Y=gn(h[0],h[1],Z[0],Z[1]);z<=1&&Y<u?(l=z,u=Y):y*=.5}}return{x:i.apply(void 0,(0,j.ev)([],(0,j.CR)(e.concat([l])),!1)),y:i.apply(void 0,(0,j.ev)([],(0,j.CR)(t.concat([l])),!1))}}function r0(e,t){for(var n=0,r=e.length,i=0;i<r;i++){var s=e[i],l=t[i],u=e[(i+1)%r],h=t[(i+1)%r];n+=gn(s,l,u,h)}return n/2}function Xi(e,t,n,r){return ir([e,n],[t,r])}function Ff(e,t,n,r){return gn(e,t,n,r)}function Eu(e,t,n,r,i){return{x:(1-i)*e+i*n,y:(1-i)*t+i*r}}function Ep(e,t,n,r,i,s){var l=(n-e)*(i-e)+(r-t)*(s-t);if(l<0)return gn(e,t,i,s);var u=(n-e)*(n-e)+(r-t)*(r-t);return l>u?gn(n,r,i,s):rf(e,t,n,r,i,s)}function rf(e,t,n,r,i,s){var l=[n-e,r-t];if(Fn.I6(l,[0,0]))return Math.sqrt((i-e)*(i-e)+(s-t)*(s-t));var u=[-l[1],l[0]];Fn.Fv(u,u);var h=[i-e,s-t];return Math.abs(Fn.AK(h,u))}function of(e,t,n,r){return Math.atan2(r-t,n-e)}function eh(e,t,n,r,i){var s=1-i;return s*s*s*e+3*t*i*s*s+3*n*i*i*s+r*i*i*i}function Sp(e,t,n,r,i){var s=1-i;return 3*(s*s*(t-e)+2*s*i*(n-t)+i*i*(r-n))}function Gc(e,t,n,r){var i=-3*e+9*t-9*n+3*r,s=6*e-12*t+6*n,l=3*t-3*e,u=[],h,p,m;if(hl(i,0))hl(s,0)||(h=-l/s,h>=0&&h<=1&&u.push(h));else{var y=s*s-4*i*l;hl(y,0)?u.push(-s/(2*i)):y>0&&(m=Math.sqrt(y),h=(-s+m)/(2*i),p=(-s-m)/(2*i),h>=0&&h<=1&&u.push(h),p>=0&&p<=1&&u.push(p))}return u}function th(e,t,n,r,i,s,l,u,h){var p=eh(e,n,i,l,h),m=eh(t,r,s,u,h),y=Eu(e,t,n,r,h),b=Eu(n,r,i,s,h),w=Eu(i,s,l,u,h),R=Eu(y.x,y.y,b.x,b.y,h),P=Eu(b.x,b.y,w.x,w.y,h);return[[e,t,y.x,y.y,R.x,R.y,p,m],[p,m,P.x,P.y,w.x,w.y,l,u]]}function i0(e,t,n,r,i,s,l,u,h){if(h===0)return r0([e,n,i,l],[t,r,s,u]);var p=th(e,t,n,r,i,s,l,u,.5),m=__spreadArray(__spreadArray([],__read(p[0]),!1),[h-1],!1),y=__spreadArray(__spreadArray([],__read(p[1]),!1),[h-1],!1);return i0.apply(void 0,__spreadArray([],__read(m),!1))+i0.apply(void 0,__spreadArray([],__read(y),!1))}function Sd(e,t,n,r,i,s,l,u){for(var h=[e,l],p=[t,u],m=Gc(e,n,i,l),y=Gc(t,r,s,u),b=0;b<m.length;b++)h.push(eh(e,n,i,l,m[b]));for(var b=0;b<y.length;b++)p.push(eh(t,r,s,u,y[b]));return ir(h,p)}function k0(e,t,n,r,i,s,l,u){return i0(e,t,n,r,i,s,l,u,3)}function z0(e,t,n,r,i,s,l,u,h,p,m){return Ja([e,n,i,l],[t,r,s,u],h,p,eh,m)}function su(e,t,n,r,i,s,l,u,h,p,m){var y=z0(e,t,n,r,i,s,l,u,h,p,m);return gn(y.x,y.y,h,p)}function af(e,t,n,r,i,s,l,u,h){return{x:eh(e,n,i,l,h),y:eh(t,r,s,u,h)}}function Ta(e,t,n,r,i,s,l,u,h){var p=Sp(e,n,i,l,h),m=Sp(t,r,s,u,h);return Ur(Math.atan2(m,p))}function ku(e){for(var t=0,n=[],r=0;r<e.length-1;r++){var i=e[r],s=e[r+1],l=gn(i[0],i[1],s[0],s[1]),u={from:i,to:s,length:l};n.push(u),t+=l}return{segments:n,totalLength:t}}function zu(e){if(e.length<2)return 0;for(var t=0,n=0;n<e.length-1;n++){var r=e[n],i=e[n+1];t+=gn(r[0],r[1],i[0],i[1])}return t}function cc(e,t){if(t>1||t<0||e.length<2)return null;var n=ku(e),r=n.segments,i=n.totalLength;if(i===0)return{x:e[0][0],y:e[0][1]};for(var s=0,l=null,u=0;u<r.length;u++){var h=r[u],p=h.from,m=h.to,y=h.length/i;if(t>=s&&t<=s+y){var b=(t-s)/y;l=Eu(p[0],p[1],m[0],m[1],b);break}s+=y}return l}function Th(e,t){if(t>1||t<0||e.length<2)return 0;for(var n=ku(e),r=n.segments,i=n.totalLength,s=0,l=0,u=0;u<r.length;u++){var h=r[u],p=h.from,m=h.to,y=h.length/i;if(t>=s&&t<=s+y){l=Math.atan2(m[1]-p[1],m[0]-p[0]);break}s+=y}return l}function Ul(e,t,n){for(var r=1/0,i=0;i<e.length-1;i++){var s=e[i],l=e[i+1],u=Ep(s[0],s[1],l[0],l[1],t,n);u<r&&(r=u)}return r}function Fc(e){for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r];t.push(i[0]),n.push(i[1])}return ir(t,n)}function Xc(e){return zu(e)}function Tp(e,t){return cc(e,t)}function jo(e,t,n){return Ul(e,t,n)}function Eo(e,t){return Th(e,t)}function kc(e){var t=e.slice(0);return e.length&&t.push(e[0]),t}function lu(e){return Fc(e)}function nh(e){return zu(kc(e))}function dl(e,t){return cc(kc(e),t)}function bf(e,t,n){return Ul(kc(e),t,n)}function wh(e,t){return Th(kc(e),t)}function kf(e,t,n,r){var i=1-r;return i*i*e+2*r*i*t+r*r*n}function xs(e,t,n){var r=e+n-2*t;if(hl(r,0))return[.5];var i=(e-t)/r;return i<=1&&i>=0?[i]:[]}function uc(e,t,n,r,i,s,l){var u=kf(e,n,i,l),h=kf(t,r,s,l),p=Eu(e,t,n,r,l),m=Eu(n,r,i,s,l);return[[e,t,p.x,p.y,u,h],[u,h,m.x,m.y,i,s]]}function Xd(e,t,n,r,i,s,l){if(l===0)return(gn(e,t,n,r)+gn(n,r,i,s)+gn(e,t,i,s))/2;var u=uc(e,t,n,r,i,s,.5),h=u[0],p=u[1];return h.push(l-1),p.push(l-1),Xd.apply(void 0,__spreadArray([],__read(h),!1))+Xd.apply(void 0,__spreadArray([],__read(p),!1))}function Kh(e,t,n,r,i,s){var l=xs(e,n,i)[0],u=xs(t,r,s)[0],h=[e,i],p=[t,s];return l!==void 0&&h.push(kf(e,n,i,l)),u!==void 0&&p.push(kf(t,r,s,u)),ir(h,p)}function U0(e,t,n,r,i,s){return Xd(e,t,n,r,i,s,3)}function Ah(e,t,n,r,i,s,l,u){return Ja([e,n,i],[t,r,s],l,u,kf)}function Su(e,t,n,r,i,s,l,u){var h=Ah(e,t,n,r,i,s,l,u);return gn(h.x,h.y,l,u)}var Yd=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},zf={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Yd,function(){function n($,J,ae,pe,Oe){r($,J,ae||0,pe||$.length-1,Oe||s)}function r($,J,ae,pe,Oe){for(;pe>ae;){if(pe-ae>600){var Ve=pe-ae+1,Ke=J-ae+1,lt=Math.log(Ve),Ge=.5*Math.exp(2*lt/3),rt=.5*Math.sqrt(lt*Ge*(Ve-Ge)/Ve)*(Ke-Ve/2<0?-1:1),st=Math.max(ae,Math.floor(J-Ke*Ge/Ve+rt)),ut=Math.min(pe,Math.floor(J+(Ve-Ke)*Ge/Ve+rt));r($,J,st,ut,Oe)}var jt=$[J],At=ae,zt=pe;for(i($,ae,J),Oe($[pe],jt)>0&&i($,ae,pe);At<zt;){for(i($,At,zt),At++,zt--;Oe($[At],jt)<0;)At++;for(;Oe($[zt],jt)>0;)zt--}Oe($[ae],jt)===0?i($,ae,zt):(zt++,i($,zt,pe)),zt<=J&&(ae=zt+1),J<=zt&&(pe=zt-1)}}function i($,J,ae){var pe=$[J];$[J]=$[ae],$[ae]=pe}function s($,J){return $<J?-1:$>J?1:0}var l=function(J){J===void 0&&(J=9),this._maxEntries=Math.max(4,J),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function(J){var ae=this.data,pe=[];if(!z(J,ae))return pe;for(var Oe=this.toBBox,Ve=[];ae;){for(var Ke=0;Ke<ae.children.length;Ke++){var lt=ae.children[Ke],Ge=ae.leaf?Oe(lt):lt;z(J,Ge)&&(ae.leaf?pe.push(lt):N(J,Ge)?this._all(lt,pe):Ve.push(lt))}ae=Ve.pop()}return pe},l.prototype.collides=function(J){var ae=this.data;if(!z(J,ae))return!1;for(var pe=[];ae;){for(var Oe=0;Oe<ae.children.length;Oe++){var Ve=ae.children[Oe],Ke=ae.leaf?this.toBBox(Ve):Ve;if(z(J,Ke)){if(ae.leaf||N(J,Ke))return!0;pe.push(Ve)}}ae=pe.pop()}return!1},l.prototype.load=function(J){if(!(J&&J.length))return this;if(J.length<this._minEntries){for(var ae=0;ae<J.length;ae++)this.insert(J[ae]);return this}var pe=this._build(J.slice(),0,J.length-1,0);if(!this.data.children.length)this.data=pe;else if(this.data.height===pe.height)this._splitRoot(this.data,pe);else{if(this.data.height<pe.height){var Oe=this.data;this.data=pe,pe=Oe}this._insert(pe,this.data.height-pe.height-1,!0)}return this},l.prototype.insert=function(J){return J&&this._insert(J,this.data.height-1),this},l.prototype.clear=function(){return this.data=Z([]),this},l.prototype.remove=function(J,ae){if(!J)return this;for(var pe=this.data,Oe=this.toBBox(J),Ve=[],Ke=[],lt,Ge,rt;pe||Ve.length;){if(pe||(pe=Ve.pop(),Ge=Ve[Ve.length-1],lt=Ke.pop(),rt=!0),pe.leaf){var st=u(J,pe.children,ae);if(st!==-1)return pe.children.splice(st,1),Ve.push(pe),this._condense(Ve),this}!rt&&!pe.leaf&&N(pe,Oe)?(Ve.push(pe),Ke.push(lt),lt=0,Ge=pe,pe=pe.children[0]):Ge?(lt++,pe=Ge.children[lt],rt=!1):pe=null}return this},l.prototype.toBBox=function(J){return J},l.prototype.compareMinX=function(J,ae){return J.minX-ae.minX},l.prototype.compareMinY=function(J,ae){return J.minY-ae.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function(J){return this.data=J,this},l.prototype._all=function(J,ae){for(var pe=[];J;)J.leaf?ae.push.apply(ae,J.children):pe.push.apply(pe,J.children),J=pe.pop();return ae},l.prototype._build=function(J,ae,pe,Oe){var Ve=pe-ae+1,Ke=this._maxEntries,lt;if(Ve<=Ke)return lt=Z(J.slice(ae,pe+1)),h(lt,this.toBBox),lt;Oe||(Oe=Math.ceil(Math.log(Ve)/Math.log(Ke)),Ke=Math.ceil(Ve/Math.pow(Ke,Oe-1))),lt=Z([]),lt.leaf=!1,lt.height=Oe;var Ge=Math.ceil(Ve/Ke),rt=Ge*Math.ceil(Math.sqrt(Ke));Y(J,ae,pe,rt,this.compareMinX);for(var st=ae;st<=pe;st+=rt){var ut=Math.min(st+rt-1,pe);Y(J,st,ut,Ge,this.compareMinY);for(var jt=st;jt<=ut;jt+=Ge){var At=Math.min(jt+Ge-1,ut);lt.children.push(this._build(J,jt,At,Oe-1))}}return h(lt,this.toBBox),lt},l.prototype._chooseSubtree=function(J,ae,pe,Oe){for(;Oe.push(ae),!(ae.leaf||Oe.length-1===pe);){for(var Ve=1/0,Ke=1/0,lt=void 0,Ge=0;Ge<ae.children.length;Ge++){var rt=ae.children[Ge],st=w(rt),ut=P(J,rt)-st;ut<Ke?(Ke=ut,Ve=st<Ve?st:Ve,lt=rt):ut===Ke&&st<Ve&&(Ve=st,lt=rt)}ae=lt||ae.children[0]}return ae},l.prototype._insert=function(J,ae,pe){var Oe=pe?J:this.toBBox(J),Ve=[],Ke=this._chooseSubtree(Oe,this.data,ae,Ve);for(Ke.children.push(J),m(Ke,Oe);ae>=0&&Ve[ae].children.length>this._maxEntries;)this._split(Ve,ae),ae--;this._adjustParentBBoxes(Oe,Ve,ae)},l.prototype._split=function(J,ae){var pe=J[ae],Oe=pe.children.length,Ve=this._minEntries;this._chooseSplitAxis(pe,Ve,Oe);var Ke=this._chooseSplitIndex(pe,Ve,Oe),lt=Z(pe.children.splice(Ke,pe.children.length-Ke));lt.height=pe.height,lt.leaf=pe.leaf,h(pe,this.toBBox),h(lt,this.toBBox),ae?J[ae-1].children.push(lt):this._splitRoot(pe,lt)},l.prototype._splitRoot=function(J,ae){this.data=Z([J,ae]),this.data.height=J.height+1,this.data.leaf=!1,h(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function(J,ae,pe){for(var Oe,Ve=1/0,Ke=1/0,lt=ae;lt<=pe-ae;lt++){var Ge=p(J,0,lt,this.toBBox),rt=p(J,lt,pe,this.toBBox),st=I(Ge,rt),ut=w(Ge)+w(rt);st<Ve?(Ve=st,Oe=lt,Ke=ut<Ke?ut:Ke):st===Ve&&ut<Ke&&(Ke=ut,Oe=lt)}return Oe||pe-ae},l.prototype._chooseSplitAxis=function(J,ae,pe){var Oe=J.leaf?this.compareMinX:y,Ve=J.leaf?this.compareMinY:b,Ke=this._allDistMargin(J,ae,pe,Oe),lt=this._allDistMargin(J,ae,pe,Ve);Ke<lt&&J.children.sort(Oe)},l.prototype._allDistMargin=function(J,ae,pe,Oe){J.children.sort(Oe);for(var Ve=this.toBBox,Ke=p(J,0,ae,Ve),lt=p(J,pe-ae,pe,Ve),Ge=R(Ke)+R(lt),rt=ae;rt<pe-ae;rt++){var st=J.children[rt];m(Ke,J.leaf?Ve(st):st),Ge+=R(Ke)}for(var ut=pe-ae-1;ut>=ae;ut--){var jt=J.children[ut];m(lt,J.leaf?Ve(jt):jt),Ge+=R(lt)}return Ge},l.prototype._adjustParentBBoxes=function(J,ae,pe){for(var Oe=pe;Oe>=0;Oe--)m(ae[Oe],J)},l.prototype._condense=function(J){for(var ae=J.length-1,pe=void 0;ae>=0;ae--)J[ae].children.length===0?ae>0?(pe=J[ae-1].children,pe.splice(pe.indexOf(J[ae]),1)):this.clear():h(J[ae],this.toBBox)};function u($,J,ae){if(!ae)return J.indexOf($);for(var pe=0;pe<J.length;pe++)if(ae($,J[pe]))return pe;return-1}function h($,J){p($,0,$.children.length,J,$)}function p($,J,ae,pe,Oe){Oe||(Oe=Z(null)),Oe.minX=1/0,Oe.minY=1/0,Oe.maxX=-1/0,Oe.maxY=-1/0;for(var Ve=J;Ve<ae;Ve++){var Ke=$.children[Ve];m(Oe,$.leaf?pe(Ke):Ke)}return Oe}function m($,J){return $.minX=Math.min($.minX,J.minX),$.minY=Math.min($.minY,J.minY),$.maxX=Math.max($.maxX,J.maxX),$.maxY=Math.max($.maxY,J.maxY),$}function y($,J){return $.minX-J.minX}function b($,J){return $.minY-J.minY}function w($){return($.maxX-$.minX)*($.maxY-$.minY)}function R($){return $.maxX-$.minX+($.maxY-$.minY)}function P($,J){return(Math.max(J.maxX,$.maxX)-Math.min(J.minX,$.minX))*(Math.max(J.maxY,$.maxY)-Math.min(J.minY,$.minY))}function I($,J){var ae=Math.max($.minX,J.minX),pe=Math.max($.minY,J.minY),Oe=Math.min($.maxX,J.maxX),Ve=Math.min($.maxY,J.maxY);return Math.max(0,Oe-ae)*Math.max(0,Ve-pe)}function N($,J){return $.minX<=J.minX&&$.minY<=J.minY&&J.maxX<=$.maxX&&J.maxY<=$.maxY}function z($,J){return J.minX<=$.maxX&&J.minY<=$.maxY&&J.maxX>=$.minX&&J.maxY>=$.minY}function Z($){return{children:$,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Y($,J,ae,pe,Oe){for(var Ve=[J,ae];Ve.length;)if(ae=Ve.pop(),J=Ve.pop(),!(ae-J<=pe)){var Ke=J+Math.ceil((ae-J)/pe/2)*pe;n($,Ke,J,ae,Oe),Ve.push(J,Ke,Ke,ae)}}return l})})(zf);var wp=zf.exports,Yr;(function(e){e.GROUP="g",e.CIRCLE="circle",e.ELLIPSE="ellipse",e.IMAGE="image",e.RECT="rect",e.LINE="line",e.POLYLINE="polyline",e.POLYGON="polygon",e.TEXT="text",e.PATH="path",e.HTML="html",e.MESH="mesh"})(Yr||(Yr={}));var Uf;(function(e){e[e.ZERO=0]="ZERO",e[e.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(Uf||(Uf={}));var jf=function(){function e(){this.plugins=[]}return e.prototype.addRenderingPlugin=function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)},e.prototype.removeAllRenderingPlugins=function(){var t=this;this.plugins.forEach(function(n){var r=t.context.renderingPlugins.indexOf(n);r>=0&&t.context.renderingPlugins.splice(r,1)})},e}(),qh=function(){function e(t){this.clipSpaceNearZ=Uf.NEGATIVE_ONE,this.plugins=[],this.config=(0,j.pi)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},t)}return e.prototype.registerPlugin=function(t){var n=this.plugins.findIndex(function(r){return r===t});n===-1&&this.plugins.push(t)},e.prototype.unregisterPlugin=function(t){var n=this.plugins.findIndex(function(r){return r===t});n>-1&&this.plugins.splice(n,1)},e.prototype.getPlugins=function(){return this.plugins},e.prototype.getPlugin=function(t){return this.plugins.find(function(n){return n.name===t})},e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(t){Object.assign(this.config,t)},e}();function xf(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ap(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function sf(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Ef(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function o0(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function rh(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function Yc(e){return e===void 0?0:e>360||e<-360?e%360:e}function $c(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=0),Array.isArray(e)&&e.length===3?mt.d9(e):(0,dr.Z)(e)?mt.al(e,t,n):mt.al(e[0],e[1]||t,e[2]||n)}function Ds(e){return e*(Math.PI/180)}function Tu(e){return e*(180/Math.PI)}function j0(e){return e=e%400,e<0&&(e+=400),e/400*360}function _(e){return e/360}function S(e){return 360*e}function x(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],l=n*n,u=r*r,h=i*i,p=s*s,m=l+u+h+p,y=n*s-r*i;return y>.499995*m?(e[0]=Math.PI/2,e[1]=2*Math.atan2(r,n),e[2]=0):y<-.499995*m?(e[0]=-Math.PI/2,e[1]=2*Math.atan2(r,n),e[2]=0):(e[0]=Math.asin(2*(n*i-s*r)),e[1]=Math.atan2(2*(n*s+r*i),1-2*(h+p)),e[2]=Math.atan2(2*(n*r+i*s),1-2*(u+h))),e}function C(e,t){var n,r,i=Math.PI*.5,s=(0,j.CR)(Gt.getScaling(mt.Ue(),t),3),l=s[0],u=s[1],h=s[2],p=Math.asin(-t[2]/l);return p<i?p>-i?(n=Math.atan2(t[6]/u,t[10]/h),r=Math.atan2(t[1]/l,t[0]/l)):(r=0,n=-Math.atan2(t[4]/u,t[5]/u)):(r=0,n=Math.atan2(t[4]/u,t[5]/u)),e[0]=n,e[1]=p,e[2]=r,e}function k(e,t){return t.length===16?C(e,t):x(e,t)}function G(e,t,n,r,i){var s=Math.cos(e),l=Math.sin(e);return Ln(r*s,i*l,0,-r*l,i*s,0,t,n,1)}function q(e,t,n,r,i,s,l,u){u===void 0&&(u=!1);var h=2*s/(n-t),p=2*s/(r-i),m=(n+t)/(n-t),y=(r+i)/(r-i),b,w;return u?(b=-l/(l-s),w=-l*s/(l-s)):(b=-(l+s)/(l-s),w=-2*l*s/(l-s)),e[0]=h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=m,e[9]=y,e[10]=b,e[11]=-1,e[12]=0,e[13]=0,e[14]=w,e[15]=0,e}function de(e){var t=e[0],n=e[1],r=e[3],i=e[4],s=Math.sqrt(t*t+n*n),l=Math.sqrt(r*r+i*i),u=t*i-n*r;u<0&&(t<i?s=-s:l=-l),s&&(t*=1/s,n*=1/s),l&&(r*=1/l,i*=1/l);var h=Math.atan2(n,t),p=Tu(h);return[e[6],e[7],s,l,p]}var ze=Gt.create(),it=Gt.create(),Bt=ar.Ue(),St=[mt.Ue(),mt.Ue(),mt.Ue()],Xt=mt.Ue();function En(e,t,n,r,i,s){if(!yn(ze,e)||(Gt.copy(it,ze),it[3]=0,it[7]=0,it[11]=0,it[15]=1,Math.abs(Gt.determinant(it))<1e-8))return!1;var l=ze[3],u=ze[7],h=ze[11],p=ze[12],m=ze[13],y=ze[14],b=ze[15];if(l!==0||u!==0||h!==0){Bt[0]=l,Bt[1]=u,Bt[2]=h,Bt[3]=b;var w=Gt.invert(it,it);if(!w)return!1;Gt.transpose(it,it),ar.fF(i,Bt,it)}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=p,t[1]=m,t[2]=y,Un(St,ze),n[0]=mt.kE(St[0]),mt.Fv(St[0],St[0]),r[0]=mt.AK(St[0],St[1]),cn(St[1],St[1],St[0],1,-r[0]),n[1]=mt.kE(St[1]),mt.Fv(St[1],St[1]),r[0]/=n[1],r[1]=mt.AK(St[0],St[2]),cn(St[2],St[2],St[0],1,-r[1]),r[2]=mt.AK(St[1],St[2]),cn(St[2],St[2],St[1],1,-r[2]),n[2]=mt.kE(St[2]),mt.Fv(St[2],St[2]),r[1]/=n[2],r[2]/=n[2],mt.kC(Xt,St[1],St[2]),mt.AK(St[0],Xt)<0)for(var R=0;R<3;R++)n[R]*=-1,St[R][0]*=-1,St[R][1]*=-1,St[R][2]*=-1;return s[0]=.5*Math.sqrt(Math.max(1+St[0][0]-St[1][1]-St[2][2],0)),s[1]=.5*Math.sqrt(Math.max(1-St[0][0]+St[1][1]-St[2][2],0)),s[2]=.5*Math.sqrt(Math.max(1-St[0][0]-St[1][1]+St[2][2],0)),s[3]=.5*Math.sqrt(Math.max(1+St[0][0]+St[1][1]+St[2][2],0)),St[2][1]>St[1][2]&&(s[0]=-s[0]),St[0][2]>St[2][0]&&(s[1]=-s[1]),St[1][0]>St[0][1]&&(s[2]=-s[2]),!0}function yn(e,t){var n=t[15];if(n===0)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0}function Un(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function cn(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i}var Rn=function(){function e(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return e.isEmpty=function(t){return!t||t.halfExtents[0]===0&&t.halfExtents[1]===0&&t.halfExtents[2]===0},e.prototype.update=function(t,n){xf(this.center,t),xf(this.halfExtents,n),Ap(this.min,this.center,this.halfExtents),sf(this.max,this.center,this.halfExtents)},e.prototype.setMinMax=function(t,n){sf(this.center,n,t),Ef(this.center,this.center,.5),Ap(this.halfExtents,n,t),Ef(this.halfExtents,this.halfExtents,.5),xf(this.min,t),xf(this.max,n)},e.prototype.getMin=function(){return this.min},e.prototype.getMax=function(){return this.max},e.prototype.add=function(t){if(!e.isEmpty(t)){if(e.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return}var n=this.center,r=n[0],i=n[1],s=n[2],l=this.halfExtents,u=l[0],h=l[1],p=l[2],m=r-u,y=r+u,b=i-h,w=i+h,R=s-p,P=s+p,I=t.center,N=I[0],z=I[1],Z=I[2],Y=t.halfExtents,$=Y[0],J=Y[1],ae=Y[2],pe=N-$,Oe=N+$,Ve=z-J,Ke=z+J,lt=Z-ae,Ge=Z+ae;pe<m&&(m=pe),Oe>y&&(y=Oe),Ve<b&&(b=Ve),Ke>w&&(w=Ke),lt<R&&(R=lt),Ge>P&&(P=Ge),n[0]=(m+y)*.5,n[1]=(b+w)*.5,n[2]=(R+P)*.5,l[0]=(y-m)*.5,l[1]=(w-b)*.5,l[2]=(P-R)*.5,this.min[0]=m,this.min[1]=b,this.min[2]=R,this.max[0]=y,this.max[1]=w,this.max[2]=P}},e.prototype.setFromTransformedAABB=function(t,n){var r=this.center,i=this.halfExtents,s=t.center,l=t.halfExtents,u=n[0],h=n[4],p=n[8],m=n[1],y=n[5],b=n[9],w=n[2],R=n[6],P=n[10],I=Math.abs(u),N=Math.abs(h),z=Math.abs(p),Z=Math.abs(m),Y=Math.abs(y),$=Math.abs(b),J=Math.abs(w),ae=Math.abs(R),pe=Math.abs(P);r[0]=n[12]+u*s[0]+h*s[1]+p*s[2],r[1]=n[13]+m*s[0]+y*s[1]+b*s[2],r[2]=n[14]+w*s[0]+R*s[1]+P*s[2],i[0]=I*l[0]+N*l[1]+z*l[2],i[1]=Z*l[0]+Y*l[1]+$*l[2],i[2]=J*l[0]+ae*l[1]+pe*l[2],Ap(this.min,r,i),sf(this.max,r,i)},e.prototype.intersects=function(t){var n=this.getMax(),r=this.getMin(),i=t.getMax(),s=t.getMin();return r[0]<=i[0]&&n[0]>=s[0]&&r[1]<=i[1]&&n[1]>=s[1]&&r[2]<=i[2]&&n[2]>=s[2]},e.prototype.intersection=function(t){if(!this.intersects(t))return null;var n=new e,r=o0([0,0,0],this.getMin(),t.getMin()),i=rh([0,0,0],this.getMax(),t.getMax());return n.setMinMax(r,i),n},e.prototype.getNegativeFarPoint=function(t){return t.pnVertexFlag===273?xf([0,0,0],this.min):t.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:t.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},e.prototype.getPositiveFarPoint=function(t){return t.pnVertexFlag===273?xf([0,0,0],this.max):t.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:t.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},e}(),Jn=function(){function e(t,n){this.distance=t||0,this.normal=n||mt.al(0,1,0),this.updatePNVertexFlag()}return e.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},e.prototype.distanceToPoint=function(t){return mt.AK(t,this.normal)-this.distance},e.prototype.normalize=function(){var t=1/mt.Zh(this.normal);mt.bA(this.normal,this.normal,t),this.distance*=t},e.prototype.intersectsLine=function(t,n,r){var i=this.distanceToPoint(t),s=this.distanceToPoint(n),l=i/(i-s),u=l>=0&&l<=1;return u&&r&&mt.t7(r,t,n,l),u},e}(),hr;(function(e){e[e.OUTSIDE=4294967295]="OUTSIDE",e[e.INSIDE=0]="INSIDE",e[e.INDETERMINATE=2147483647]="INDETERMINATE"})(hr||(hr={}));var Lr=function(){function e(t){if(this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new Jn)}return e.prototype.extractFromVPMatrix=function(t){var n=(0,j.CR)(t,16),r=n[0],i=n[1],s=n[2],l=n[3],u=n[4],h=n[5],p=n[6],m=n[7],y=n[8],b=n[9],w=n[10],R=n[11],P=n[12],I=n[13],N=n[14],z=n[15];mt.t8(this.planes[0].normal,l-r,m-u,R-y),this.planes[0].distance=z-P,mt.t8(this.planes[1].normal,l+r,m+u,R+y),this.planes[1].distance=z+P,mt.t8(this.planes[2].normal,l+i,m+h,R+b),this.planes[2].distance=z+I,mt.t8(this.planes[3].normal,l-i,m-h,R-b),this.planes[3].distance=z-I,mt.t8(this.planes[4].normal,l-s,m-p,R-w),this.planes[4].distance=z-N,mt.t8(this.planes[5].normal,l+s,m+p,R+w),this.planes[5].distance=z+N,this.planes.forEach(function(Z){Z.normalize(),Z.updatePNVertexFlag()})},e}(),gr=function(){function e(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this.x=0,this.y=0,this.x=t,this.y=n}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},e}(),Dr=function(){function e(t,n,r,i){this.x=t,this.y=n,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=n,this.bottom=n+i}return e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e.applyTransform=function(t,n){var r=ar.al(t.x,t.y,0,1),i=ar.al(t.x+t.width,t.y,0,1),s=ar.al(t.x,t.y+t.height,0,1),l=ar.al(t.x+t.width,t.y+t.height,0,1),u=ar.Ue(),h=ar.Ue(),p=ar.Ue(),m=ar.Ue();ar.fF(u,r,n),ar.fF(h,i,n),ar.fF(p,s,n),ar.fF(m,l,n);var y=Math.min(u[0],h[0],p[0],m[0]),b=Math.min(u[1],h[1],p[1],m[1]),w=Math.max(u[0],h[0],p[0],m[0]),R=Math.max(u[1],h[1],p[1],m[1]);return e.fromRect({x:y,y:b,width:w-y,height:R-b})},e.prototype.toJSON=function(){},e}(),Fr="Method not implemented.",Mi="Use document.documentElement instead.",Pi="Cannot append a destroyed element.",vi;(function(e){e[e.ORBITING=0]="ORBITING",e[e.EXPLORING=1]="EXPLORING",e[e.TRACKING=2]="TRACKING"})(vi||(vi={}));var Oo;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ROTATIONAL=1]="ROTATIONAL",e[e.TRANSLATIONAL=2]="TRANSLATIONAL",e[e.CINEMATIC=3]="CINEMATIC"})(Oo||(Oo={}));var yo;(function(e){e[e.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",e[e.PERSPECTIVE=1]="PERSPECTIVE"})(yo||(yo={}));var Ho={UPDATED:"updated"},is=2e-4,Cr=function(){function e(){this.clipSpaceNearZ=Uf.NEGATIVE_ONE,this.eventEmitter=new fn,this.matrix=Gt.create(),this.right=mt.al(1,0,0),this.up=mt.al(0,1,0),this.forward=mt.al(0,0,1),this.position=mt.al(0,0,1),this.focalPoint=mt.al(0,0,0),this.distanceVector=mt.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Gt.create(),this.projectionMatrixInverse=Gt.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=vi.EXPLORING,this.trackingMode=Oo.DEFAULT,this.projectionMode=yo.PERSPECTIVE,this.frustum=new Lr,this.orthoMatrix=Gt.create()}return e.prototype.isOrtho=function(){return this.projectionMode===yo.ORTHOGRAPHIC},e.prototype.getProjectionMode=function(){return this.projectionMode},e.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},e.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},e.prototype.getFrustum=function(){return this.frustum},e.prototype.getPosition=function(){return this.position},e.prototype.getFocalPoint=function(){return this.focalPoint},e.prototype.getDollyingStep=function(){return this.dollyingStep},e.prototype.getNear=function(){return this.near},e.prototype.getFar=function(){return this.far},e.prototype.getZoom=function(){return this.zoom},e.prototype.getOrthoMatrix=function(){return this.orthoMatrix},e.prototype.getView=function(){return this.view},e.prototype.setEnableUpdate=function(t){this.enableUpdate=t},e.prototype.setType=function(t,n){return this.type=t,this.type===vi.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===vi.TRACKING&&n!==void 0&&this.setTrackingMode(n),this},e.prototype.setProjectionMode=function(t){return this.projectionMode=t,this},e.prototype.setTrackingMode=function(t){if(this.type!==vi.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this},e.prototype.setWorldRotation=function(t){return this.rotateWorld=t,this._getAngles(),this},e.prototype.getViewTransform=function(){return Gt.invert(Gt.create(),this.matrix)},e.prototype.getWorldTransform=function(){return this.matrix},e.prototype.jitterProjectionMatrix=function(t,n){var r=Gt.fromTranslation(Gt.create(),[t,n,0]);this.jitteredProjectionMatrix=Gt.multiply(Gt.create(),r,this.projectionMatrix)},e.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},e.prototype.setMatrix=function(t){return this.matrix=t,this._update(),this},e.prototype.setProjectionMatrix=function(t){this.projectionMatrix=t},e.prototype.setFov=function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this},e.prototype.setAspect=function(t){return this.setPerspective(this.near,this.far,this.fov,t),this},e.prototype.setNear=function(t){return this.projectionMode===yo.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this},e.prototype.setFar=function(t){return this.projectionMode===yo.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this},e.prototype.setViewOffset=function(t,n,r,i,s,l){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=l,this.projectionMode===yo.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===yo.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.prototype.setZoom=function(t){return this.zoom=t,this.projectionMode===yo.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===yo.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},e.prototype.setZoomByViewportPoint=function(t,n){var r=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),i=r.x,s=r.y,l=this.roll;this.rotate(0,0,-l),this.setPosition(i,s),this.setFocalPoint(i,s),this.setZoom(t),this.rotate(0,0,l);var u=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),h=u.x,p=u.y,m=mt.al(h-i,p-s,0),y=mt.AK(m,this.right)/mt.kE(this.right),b=mt.AK(m,this.up)/mt.kE(this.up),w=(0,j.CR)(this.getPosition(),2),R=w[0],P=w[1],I=(0,j.CR)(this.getFocalPoint(),2),N=I[0],z=I[1];return this.setPosition(R-y,P-b),this.setFocalPoint(N-y,z-b),this},e.prototype.setPerspective=function(t,n,r,i){var s;this.projectionMode=yo.PERSPECTIVE,this.fov=r,this.near=t,this.far=n,this.aspect=i;var l=this.near*Math.tan(Ds(.5*this.fov))/this.zoom,u=2*l,h=this.aspect*u,p=-.5*h;if(!((s=this.view)===null||s===void 0)&&s.enabled){var m=this.view.fullWidth,y=this.view.fullHeight;p+=this.view.offsetX*h/m,l-=this.view.offsetY*u/y,h*=this.view.width/m,u*=this.view.height/y}return q(this.projectionMatrix,p,p+h,l-u,l,t,this.far,this.clipSpaceNearZ===Uf.ZERO),Gt.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},e.prototype.setOrthographic=function(t,n,r,i,s,l){var u;this.projectionMode=yo.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=r,this.bottom=i,this.near=s,this.far=l;var h=(this.rright-this.left)/(2*this.zoom),p=(this.top-this.bottom)/(2*this.zoom),m=(this.rright+this.left)/2,y=(this.top+this.bottom)/2,b=m-h,w=m+h,R=y+p,P=y-p;if(!((u=this.view)===null||u===void 0)&&u.enabled){var I=(this.rright-this.left)/this.view.fullWidth/this.zoom,N=(this.top-this.bottom)/this.view.fullHeight/this.zoom;b+=I*this.view.offsetX,w=b+I*this.view.width,R-=N*this.view.offsetY,P=R-N*this.view.height}return this.clipSpaceNearZ===Uf.NEGATIVE_ONE?Gt.ortho(this.projectionMatrix,b,w,R,P,s,l):Gt.orthoZO(this.projectionMatrix,b,w,R,P,s,l),Gt.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},e.prototype.setPosition=function(t,n,r){n===void 0&&(n=this.position[1]),r===void 0&&(r=this.position[2]);var i=$c(t,n,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},e.prototype.setFocalPoint=function(t,n,r){n===void 0&&(n=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=mt.al(0,1,0);if(this.focalPoint=$c(t,n,r),this.trackingMode===Oo.CINEMATIC){var s=mt.$X(mt.Ue(),this.focalPoint,this.position);t=s[0],n=s[1],r=s[2];var l=mt.kE(s),u=Tu(Math.asin(n/l)),h=90+Tu(Math.atan2(r,t)),p=Gt.create();Gt.rotateY(p,p,Ds(h)),Gt.rotateX(p,p,Ds(u)),i=mt.fF(mt.Ue(),[0,1,0],p)}return Gt.invert(this.matrix,Gt.lookAt(Gt.create(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},e.prototype.getDistance=function(){return this.distance},e.prototype.getDistanceVector=function(){return this.distanceVector},e.prototype.setDistance=function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<is&&(this.distance=is),this.dollyingStep=this.distance/100;var n=mt.Ue();t=this.distance;var r=this.forward,i=this.focalPoint;return n[0]=t*r[0]+i[0],n[1]=t*r[1]+i[1],n[2]=t*r[2]+i[2],this._setPosition(n),this.triggerUpdate(),this},e.prototype.setMaxDistance=function(t){return this.maxDistance=t,this},e.prototype.setMinDistance=function(t){return this.minDistance=t,this},e.prototype.setAzimuth=function(t){return this.azimuth=Yc(t),this.computeMatrix(),this._getAxes(),this.type===vi.ORBITING||this.type===vi.EXPLORING?this._getPosition():this.type===vi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.prototype.getAzimuth=function(){return this.azimuth},e.prototype.setElevation=function(t){return this.elevation=Yc(t),this.computeMatrix(),this._getAxes(),this.type===vi.ORBITING||this.type===vi.EXPLORING?this._getPosition():this.type===vi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.prototype.getElevation=function(){return this.elevation},e.prototype.setRoll=function(t){return this.roll=Yc(t),this.computeMatrix(),this._getAxes(),this.type===vi.ORBITING||this.type===vi.EXPLORING?this._getPosition():this.type===vi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.prototype.getRoll=function(){return this.roll},e.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},e.prototype.computeMatrix=function(){var t=Qr(Kr(),[0,0,1],Ds(this.roll));Gt.identity(this.matrix);var n=Qr(Kr(),[1,0,0],Ds((this.rotateWorld&&this.type!==vi.TRACKING||this.type===vi.TRACKING?1:-1)*this.elevation)),r=Qr(Kr(),[0,1,0],Ds((this.rotateWorld&&this.type!==vi.TRACKING||this.type===vi.TRACKING?1:-1)*this.azimuth)),i=Fo(Kr(),r,n);i=Fo(Kr(),i,t);var s=Gt.fromQuat(Gt.create(),i);this.type===vi.ORBITING||this.type===vi.EXPLORING?(Gt.translate(this.matrix,this.matrix,this.focalPoint),Gt.multiply(this.matrix,this.matrix,s),Gt.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===vi.TRACKING&&(Gt.translate(this.matrix,this.matrix,this.position),Gt.multiply(this.matrix,this.matrix,s))},e.prototype._setPosition=function(t,n,r){this.position=$c(t,n,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},e.prototype._getAxes=function(){mt.JG(this.right,$c(ar.fF(ar.Ue(),[1,0,0,0],this.matrix))),mt.JG(this.up,$c(ar.fF(ar.Ue(),[0,1,0,0],this.matrix))),mt.JG(this.forward,$c(ar.fF(ar.Ue(),[0,0,1,0],this.matrix))),mt.Fv(this.right,this.right),mt.Fv(this.up,this.up),mt.Fv(this.forward,this.forward)},e.prototype._getAngles=function(){var t=this.distanceVector[0],n=this.distanceVector[1],r=this.distanceVector[2],i=mt.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===vi.TRACKING?(this.elevation=Tu(Math.asin(n/i)),this.azimuth=Tu(Math.atan2(-t,-r))):this.rotateWorld?(this.elevation=Tu(Math.asin(n/i)),this.azimuth=Tu(Math.atan2(-t,-r))):(this.elevation=-Tu(Math.asin(n/i)),this.azimuth=-Tu(Math.atan2(-t,-r)))},e.prototype._getPosition=function(){mt.JG(this.position,$c(ar.fF(ar.Ue(),[0,0,0,1],this.matrix))),this._getDistance()},e.prototype._getFocalPoint=function(){mt.kK(this.distanceVector,[0,0,-this.distance],ht(hn(),this.matrix)),mt.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},e.prototype._getDistance=function(){this.distanceVector=mt.$X(mt.Ue(),this.focalPoint,this.position),this.distance=mt.kE(this.distanceVector),this.dollyingStep=this.distance/100},e.prototype._getOrthoMatrix=function(){if(this.projectionMode===yo.ORTHOGRAPHIC){var t=this.position,n=Qr(Kr(),[0,0,1],-this.roll*Math.PI/180);Gt.fromRotationTranslationScaleOrigin(this.orthoMatrix,n,mt.al((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),mt.al(this.zoom,this.zoom,1),t)}},e.prototype.triggerUpdate=function(){if(this.enableUpdate){var t=this.getViewTransform(),n=Gt.multiply(Gt.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit(Ho.UPDATED)}},e.prototype.rotate=function(t,n,r){throw new Error(Fr)},e.prototype.pan=function(t,n){throw new Error(Fr)},e.prototype.dolly=function(t){throw new Error(Fr)},e.prototype.createLandmark=function(t,n){throw new Error(Fr)},e.prototype.gotoLandmark=function(t,n){throw new Error(Fr)},e.prototype.cancelLandmarkAnimation=function(){throw new Error(Fr)},e}();function Kt(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=t?t.apply(this,r):r[0],l=n.cache;if(l.has(s))return l.get(s);var u=e.apply(this,r);return n.cache=l.set(s,u)||l,u};return n.cache=new(Kt.Cache||Map),n}Kt.Cache=Map;var Zr;(function(e){e[e.kUnknown=0]="kUnknown",e[e.kNumber=1]="kNumber",e[e.kPercentage=2]="kPercentage",e[e.kEms=3]="kEms",e[e.kPixels=4]="kPixels",e[e.kRems=5]="kRems",e[e.kDegrees=6]="kDegrees",e[e.kRadians=7]="kRadians",e[e.kGradians=8]="kGradians",e[e.kTurns=9]="kTurns",e[e.kMilliseconds=10]="kMilliseconds",e[e.kSeconds=11]="kSeconds",e[e.kInteger=12]="kInteger"})(Zr||(Zr={}));var ko;(function(e){e[e.kUNumber=0]="kUNumber",e[e.kUPercent=1]="kUPercent",e[e.kULength=2]="kULength",e[e.kUAngle=3]="kUAngle",e[e.kUTime=4]="kUTime",e[e.kUOther=5]="kUOther"})(ko||(ko={}));var qo;(function(e){e[e.kAll=0]="kAll",e[e.kNonNegative=1]="kNonNegative",e[e.kInteger=2]="kInteger",e[e.kNonNegativeInteger=3]="kNonNegativeInteger",e[e.kPositiveInteger=4]="kPositiveInteger"})(qo||(qo={}));var va;(function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"})(va||(va={}));var na;(function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"})(na||(na={}));var Vo=[{name:"em",unit_type:Zr.kEms},{name:"px",unit_type:Zr.kPixels},{name:"deg",unit_type:Zr.kDegrees},{name:"rad",unit_type:Zr.kRadians},{name:"grad",unit_type:Zr.kGradians},{name:"ms",unit_type:Zr.kMilliseconds},{name:"s",unit_type:Zr.kSeconds},{name:"rem",unit_type:Zr.kRems},{name:"turn",unit_type:Zr.kTurns}],sl;(function(e){e[e.kUnknownType=0]="kUnknownType",e[e.kUnparsedType=1]="kUnparsedType",e[e.kKeywordType=2]="kKeywordType",e[e.kUnitType=3]="kUnitType",e[e.kSumType=4]="kSumType",e[e.kProductType=5]="kProductType",e[e.kNegateType=6]="kNegateType",e[e.kInvertType=7]="kInvertType",e[e.kMinType=8]="kMinType",e[e.kMaxType=9]="kMaxType",e[e.kClampType=10]="kClampType",e[e.kTransformType=11]="kTransformType",e[e.kPositionType=12]="kPositionType",e[e.kURLImageType=13]="kURLImageType",e[e.kColorType=14]="kColorType",e[e.kUnsupportedColorType=15]="kUnsupportedColorType"})(sl||(sl={}));var bl=function(e){return Vo.find(function(t){return t.name===e}).unit_type},zc=function(e){return e?e==="number"?Zr.kNumber:e==="percent"||e==="%"?Zr.kPercentage:bl(e):Zr.kUnknown},ic=function(e){switch(e){case Zr.kNumber:case Zr.kInteger:return ko.kUNumber;case Zr.kPercentage:return ko.kUPercent;case Zr.kPixels:return ko.kULength;case Zr.kMilliseconds:case Zr.kSeconds:return ko.kUTime;case Zr.kDegrees:case Zr.kRadians:case Zr.kGradians:case Zr.kTurns:return ko.kUAngle;default:return ko.kUOther}},Rs=function(e){switch(e){case ko.kUNumber:return Zr.kNumber;case ko.kULength:return Zr.kPixels;case ko.kUPercent:return Zr.kPercentage;case ko.kUTime:return Zr.kSeconds;case ko.kUAngle:return Zr.kDegrees;default:return Zr.kUnknown}},ll=function(e){var t=1;switch(e){case Zr.kPixels:case Zr.kDegrees:case Zr.kSeconds:break;case Zr.kMilliseconds:t=.001;break;case Zr.kRadians:t=180/Math.PI;break;case Zr.kGradians:t=.9;break;case Zr.kTurns:t=360;break}return t},Qs=function(e){switch(e){case Zr.kNumber:case Zr.kInteger:return"";case Zr.kPercentage:return"%";case Zr.kEms:return"em";case Zr.kRems:return"rem";case Zr.kPixels:return"px";case Zr.kDegrees:return"deg";case Zr.kRadians:return"rad";case Zr.kGradians:return"grad";case Zr.kMilliseconds:return"ms";case Zr.kSeconds:return"s";case Zr.kTurns:return"turn"}return""},Tc=function(){function e(){}return e.isAngle=function(t){return t===Zr.kDegrees||t===Zr.kRadians||t===Zr.kGradians||t===Zr.kTurns},e.isLength=function(t){return t>=Zr.kEms&&t<Zr.kDegrees},e.isRelativeUnit=function(t){return t===Zr.kPercentage||t===Zr.kEms||t===Zr.kRems},e.isTime=function(t){return t===Zr.kSeconds||t===Zr.kMilliseconds},e.prototype.toString=function(){return this.buildCSSText(va.kNo,na.kNo,"")},e.prototype.isNumericValue=function(){return this.getType()>=sl.kUnitType&&this.getType()<=sl.kClampType},e}(),Ch=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this)||this;return r.colorSpace=n,r}return t.prototype.getType=function(){return sl.kColorType},t.prototype.to=function(n){return this},t}(Tc),Il;(function(e){e[e.Constant=0]="Constant",e[e.LinearGradient=1]="LinearGradient",e[e.RadialGradient=2]="RadialGradient"})(Il||(Il={}));var cu=function(e){(0,j.ZT)(t,e);function t(n,r){var i=e.call(this)||this;return i.type=n,i.value=r,i}return t.prototype.clone=function(){return new t(this.type,this.value)},t.prototype.buildCSSText=function(n,r,i){return i},t.prototype.getType=function(){return sl.kColorType},t}(Tc),pl=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this)||this;return r.value=n,r}return t.prototype.clone=function(){return new t(this.value)},t.prototype.getType=function(){return sl.kKeywordType},t.prototype.buildCSSText=function(n,r,i){return i+this.value},t}(Tc),$d=Kt(function(e){return e===void 0&&(e=""),e.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})}),Td=function(e){return e.split("").map(function(t,n){return t.toUpperCase()===t?"".concat(n!==0?"-":"").concat(t.toLowerCase()):t}).join("")};function Oh(e){if(!e)throw new Error}function Sf(e){return typeof e=="function"}function Qh(e){return typeof e=="symbol"}var Rh=function(e){return Object.fromEntries(Object.entries(e).filter(function(t){var n=__read(t,2),r=n[1];return r!==void 0}))},Ti={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},ml=Kt(function(e){var t=$d(e),n=Ti[t];return t=(n==null?void 0:n.alias)||t,t}),Ll=function(e,t){t===void 0&&(t="");var n="";return Number.isFinite(e)?(Oh(Number.isNaN(e)),n="NaN"):e>0?n="infinity":n="-infinity",n+=t},Kc=function(e){return Rs(ic(e))},os=function(e){(0,j.ZT)(t,e);function t(n,r){r===void 0&&(r=Zr.kNumber);var i=e.call(this)||this,s;return typeof r=="string"?s=zc(r):s=r,i.unit=s,i.value=n,i}return t.prototype.clone=function(){return new t(this.value,this.unit)},t.prototype.equals=function(n){var r=n;return this.value===r.value&&this.unit===r.unit},t.prototype.getType=function(){return sl.kUnitType},t.prototype.convertTo=function(n){if(this.unit===n)return new t(this.value,this.unit);var r=Kc(this.unit);if(r!==Kc(n)||r===Zr.kUnknown)return null;var i=ll(this.unit)/ll(n);return new t(this.value*i,n)},t.prototype.buildCSSText=function(n,r,i){var s;switch(this.unit){case Zr.kUnknown:break;case Zr.kInteger:s=Number(this.value).toFixed(0);break;case Zr.kNumber:case Zr.kPercentage:case Zr.kEms:case Zr.kRems:case Zr.kPixels:case Zr.kDegrees:case Zr.kRadians:case Zr.kGradians:case Zr.kMilliseconds:case Zr.kSeconds:case Zr.kTurns:{var l=-999999,u=999999,h=this.value,p=Qs(this.unit);if(h<l||h>u){var m=Qs(this.unit);!Number.isFinite(h)||Number.isNaN(h)?s=Ll(h,m):s=h+(m||"")}else s="".concat(h).concat(p)}}return i+=s,i},t}(Tc),Ns=new os(0,"px");new os(1,"px");var ga=new os(0,"deg"),xl=function(e){(0,j.ZT)(t,e);function t(n,r,i,s,l){s===void 0&&(s=1),l===void 0&&(l=!1);var u=e.call(this,"rgb")||this;return u.r=n,u.g=r,u.b=i,u.alpha=s,u.isNone=l,u}return t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.alpha)},t.prototype.buildCSSText=function(n,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},t}(Ch),Ba=new pl("unset"),ih=new pl("initial"),a0=new pl("inherit"),Tf={"":Ba,unset:Ba,initial:ih,inherit:a0},Kd=function(e){return Tf[e]||(Tf[e]=new pl(e)),Tf[e]},oh=new xl(0,0,0,0,!0),wd=new xl(0,0,0,0),Vf=Kt(function(e,t,n,r){return new xl(e,t,n,r)},function(e,t,n,r){return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")}),zs=function(e,t){return t===void 0&&(t=Zr.kNumber),new os(e,t)};new os(50,"%");var s0;(function(e){e[e.Standard=0]="Standard"})(s0||(s0={}));var wf;(function(e){e[e.ADDED=0]="ADDED",e[e.REMOVED=1]="REMOVED",e[e.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(wf||(wf={}));var uu={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Dr(0,0,0,0)},vo;(function(e){e.COORDINATE="<coordinate>",e.COLOR="<color>",e.PAINT="<paint>",e.NUMBER="<number>",e.ANGLE="<angle>",e.OPACITY_VALUE="<opacity-value>",e.SHADOW_BLUR="<shadow-blur>",e.LENGTH="<length>",e.PERCENTAGE="<percentage>",e.LENGTH_PERCENTAGE="<length> | <percentage>",e.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",e.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",e.LIST_OF_POINTS="<list-of-points>",e.PATH="<path>",e.FILTER="<filter>",e.Z_INDEX="<z-index>",e.OFFSET_DISTANCE="<offset-distance>",e.DEFINED_PATH="<defined-path>",e.MARKER="<marker>",e.TRANSFORM="<transform>",e.TRANSFORM_ORIGIN="<transform-origin>",e.TEXT="<text>",e.TEXT_TRANSFORM="<text-transform>"})(vo||(vo={}));function dm(e){var t=e.type,n=e.value;return t==="hex"?"#".concat(n):t==="literal"?n:t==="rgb"?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}var Cp=function(){var e={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function n(jt){throw new Error(t+": "+jt)}function r(){var jt=i();return t.length>0&&n("Invalid input not EOF"),jt}function i(){return Z(s)}function s(){return l("linear-gradient",e.linearGradient,h)||l("repeating-linear-gradient",e.repeatingLinearGradient,h)||l("radial-gradient",e.radialGradient,y)||l("repeating-radial-gradient",e.repeatingRadialGradient,y)||l("conic-gradient",e.conicGradient,y)}function l(jt,At,zt){return u(At,function(wn){var Hn=zt();return Hn&&(st(e.comma)||n("Missing comma before color stops")),{type:jt,orientation:Hn,colorStops:Z(Y)}})}function u(jt,At){var zt=st(jt);if(zt){st(e.startCall)||n("Missing (");var wn=At(zt);return st(e.endCall)||n("Missing )"),wn}}function h(){return p()||m()}function p(){return rt("directional",e.sideOrCorner,1)}function m(){return rt("angular",e.angleValue,1)}function y(){var jt,At=b(),zt;return At&&(jt=[],jt.push(At),zt=t,st(e.comma)&&(At=b(),At?jt.push(At):t=zt)),jt}function b(){var jt=w()||R();if(jt)jt.at=I();else{var At=P();if(At){jt=At;var zt=I();zt&&(jt.at=zt)}else{var wn=N();wn&&(jt={type:"default-radial",at:wn})}}return jt}function w(){var jt=rt("shape",/^(circle)/i,0);return jt&&(jt.style=Ge()||P()),jt}function R(){var jt=rt("shape",/^(ellipse)/i,0);return jt&&(jt.style=Ke()||P()),jt}function P(){return rt("extent-keyword",e.extentKeywords,1)}function I(){if(rt("position",/^at/,0)){var jt=N();return jt||n("Missing positioning value"),jt}}function N(){var jt=z();if(jt.x||jt.y)return{type:"position",value:jt}}function z(){return{x:Ke(),y:Ke()}}function Z(jt){var At=jt(),zt=[];if(At)for(zt.push(At);st(e.comma);)At=jt(),At?zt.push(At):n("One extra comma");return zt}function Y(){var jt=$();return jt||n("Expected color definition"),jt.length=Ke(),jt}function $(){return ae()||Oe()||pe()||J()}function J(){return rt("literal",e.literalColor,0)}function ae(){return rt("hex",e.hexColor,1)}function pe(){return u(e.rgbColor,function(){return{type:"rgb",value:Z(Ve)}})}function Oe(){return u(e.rgbaColor,function(){return{type:"rgba",value:Z(Ve)}})}function Ve(){return st(e.number)[1]}function Ke(){return rt("%",e.percentageValue,1)||lt()||Ge()}function lt(){return rt("position-keyword",e.positionKeywords,1)}function Ge(){return rt("px",e.pixelValue,1)||rt("em",e.emValue,1)}function rt(jt,At,zt){var wn=st(At);if(wn)return{type:jt,value:wn[zt]}}function st(jt){var At=/^[\n\r\t\s]+/.exec(t);At&&ut(At[0].length);var zt=jt.exec(t);return zt&&ut(zt[0].length),zt}function ut(jt){t=t.substring(jt)}return function(jt){return t=jt,r()}}();function vy(e,t,n,r){var i=Ds(r.value),s=0,l=0,u=s+t/2,h=l+n/2,p=Math.abs(t*Math.cos(i))+Math.abs(n*Math.sin(i)),m=e[0]+u-Math.cos(i)*p/2,y=e[1]+h-Math.sin(i)*p/2,b=e[0]+u+Math.cos(i)*p/2,w=e[1]+h+Math.sin(i)*p/2;return{x1:m,y1:y,x2:b,y2:w}}function ig(e,t,n,r,i,s){var l=r.value,u=i.value;r.unit===Zr.kPercentage&&(l=r.value/100*t),i.unit===Zr.kPercentage&&(u=i.value/100*n);var h=Math.max(ai([0,0],[l,u]),ai([0,n],[l,u]),ai([t,n],[l,u]),ai([t,0],[l,u]));return s&&(s instanceof os?h=s.value:s instanceof pl&&(s.value==="closest-side"?h=Math.min(l,t-l,u,n-u):s.value==="farthest-side"?h=Math.max(l,t-l,u,n-u):s.value==="closest-corner"&&(h=Math.min(ai([0,0],[l,u]),ai([0,n],[l,u]),ai([t,n],[l,u]),ai([t,0],[l,u]))))),{x:l+e[0],y:u+e[1],r:h}}var gy=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,dv=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,pm=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,l0=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function yy(e){var t,n,r,i=e.length;e[i-1].length=(t=e[i-1].length)!==null&&t!==void 0?t:{type:"%",value:"100"},i>1&&(e[0].length=(n=e[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"});for(var s=0,l=Number(e[0].length.value),u=1;u<i;u++){var h=(r=e[u].length)===null||r===void 0?void 0:r.value;if(!(0,Xr.Z)(h)&&!(0,Xr.Z)(l)){for(var p=1;p<u-s;p++)e[s+p].length={type:"%",value:"".concat(l+(Number(h)-l)*p/(u-s))};s=u,l=Number(h)}}}var Op={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},Rp=Kt(function(e){var t;return e.type==="angular"?t=Number(e.value):t=Op[e.value]||0,zs(t,"deg")}),pv=Kt(function(e){var t=50,n=50,r="%",i="%";if((e==null?void 0:e.type)==="position"){var s=e.value,l=s.x,u=s.y;(l==null?void 0:l.type)==="position-keyword"&&(l.value==="left"?t=0:l.value==="center"?t=50:l.value==="right"?t=100:l.value==="top"?n=0:l.value==="bottom"&&(n=100)),(u==null?void 0:u.type)==="position-keyword"&&(u.value==="left"?t=0:u.value==="center"?n=50:u.value==="right"?t=100:u.value==="top"?n=0:u.value==="bottom"&&(n=100)),((l==null?void 0:l.type)==="px"||(l==null?void 0:l.type)==="%"||(l==null?void 0:l.type)==="em")&&(r=l==null?void 0:l.type,t=Number(l.value)),((u==null?void 0:u.type)==="px"||(u==null?void 0:u.type)==="%"||(u==null?void 0:u.type)==="em")&&(i=u==null?void 0:u.type,n=Number(u.value))}return{cx:zs(t,r),cy:zs(n,i)}}),mv=Kt(function(e){var t;if(e.indexOf("linear")>-1||e.indexOf("radial")>-1){var n=Cp(e);return n.map(function(u){var h=u.type,p=u.orientation,m=u.colorStops;yy(m);var y=m.map(function(Z){return{offset:zs(Number(Z.length.value),"%"),color:dm(Z)}});if(h==="linear-gradient")return new cu(Il.LinearGradient,{angle:p?Rp(p):ga,steps:y});if(h==="radial-gradient"&&(p||(p=[{type:"shape",value:"circle"}]),p[0].type==="shape"&&p[0].value==="circle")){var b=pv(p[0].at),w=b.cx,R=b.cy,P=void 0;if(p[0].style){var I=p[0].style,N=I.type,z=I.value;N==="extent-keyword"?P=Kd(z):P=zs(z,N)}return new cu(Il.RadialGradient,{cx:w,cy:R,size:P,steps:y})}})}var r=e[0];if(e[1]==="("||e[2]==="("){if(r==="l"){var i=gy.exec(e);if(i){var s=((t=i[2].match(l0))===null||t===void 0?void 0:t.map(function(u){return u.split(":")}))||[];return[new cu(Il.LinearGradient,{angle:zs(parseFloat(i[1]),"deg"),steps:s.map(function(u){var h=(0,j.CR)(u,2),p=h[0],m=h[1];return{offset:zs(Number(p)*100,"%"),color:m}})})]}}else if(r==="r"){var l=og(e);if(l)if(Xo(l))e=l;else return[new cu(Il.RadialGradient,l)]}else if(r==="p")return mm(e)}});function og(e){var t,n=dv.exec(e);if(n){var r=((t=n[4].match(l0))===null||t===void 0?void 0:t.map(function(i){return i.split(":")}))||[];return{cx:zs(50,"%"),cy:zs(50,"%"),steps:r.map(function(i){var s=(0,j.CR)(i,2),l=s[0],u=s[1];return{offset:zs(Number(l)*100,"%"),color:u}})}}return null}function mm(e){var t=pm.exec(e);if(t){var n=t[1],r=t[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;case"n":n="no-repeat";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}function ag(e){return!!e.type&&!!e.value}function c0(e){return e&&!!e.image}function u0(e){return e&&!(0,Xr.Z)(e.r)&&!(0,Xr.Z)(e.g)&&!(0,Xr.Z)(e.b)}var Af=Kt(function(e){if(c0(e))return(0,j.pi)({repetition:"repeat"},e);if((0,Xr.Z)(e)&&(e=""),e==="transparent")return wd;if(e==="currentColor")e="black";else if(e==="none")return oh;var t=mv(e);if(t)return t;var n=Fu(e),r=[0,0,0,0];return n!==null&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),Vf.apply(void 0,(0,j.ev)([],(0,j.CR)(r),!1))});function vm(e,t){if(!(!u0(e)||!u0(t)))return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(n){var r=n.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round((0,ya.Z)(r[i],0,255));return r[3]=(0,ya.Z)(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function oc(e,t){if((0,Xr.Z)(t))return zs(0,"px");if(t="".concat(t).trim().toLowerCase(),isFinite(Number(t))){if("px".search(e)>=0)return zs(Number(t),"px");if("deg".search(e)>=0)return zs(Number(t),"deg")}var n=[];t=t.replace(e,function(i){return n.push(i),"U"+i});var r="U("+e.source+")";return n.map(function(i){return zs(Number(t.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var qd=function(e){return oc(new RegExp("px","g"),e)},El=Kt(qd),Ad=function(e){return oc(new RegExp("%","g"),e)};Kt(Ad);var Mp=function(e){return(0,dr.Z)(e)||isFinite(Number(e))?zs(Number(e)||0,"px"):oc(new RegExp("px|%|em|rem","g"),e)},ah=Kt(Mp),Cd=function(e){return oc(new RegExp("deg|rad|grad|turn","g"),e)},Jh=Kt(Cd);function Pp(e,t,n,r,i){i===void 0&&(i=0);var s="",l=e.value||0,u=t.value||0,h=Kc(e.unit),p=e.convertTo(h),m=t.convertTo(h);return p&&m?(l=p.value,u=m.value,s=Qs(e.unit)):(os.isLength(e.unit)||os.isLength(t.unit))&&(l=fu(e,i,n),u=fu(t,i,n),s="px"),[l,u,function(y){return r&&(y=Math.max(y,0)),y+s}]}function fc(e){var t=0;return e.unit===Zr.kDegrees?t=e.value:e.unit===Zr.kRadians?t=Tu(Number(e.value)):e.unit===Zr.kTurns&&(t=S(Number(e.value))),t}function Uu(e,t){var n;return Array.isArray(e)?n=e.map(function(r){return Number(r)}):Xo(e)?n=e.split(" ").map(function(r){return Number(r)}):(0,dr.Z)(e)&&(n=[e]),t===2?n.length===1?[n[0],n[0]]:[n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===3?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]}function Qd(e){return Xo(e)?e.split(" ").map(function(t){return ah(t)}):e.map(function(t){return ah(t.toString())})}function fu(e,t,n,r){if(r===void 0&&(r=!1),e.unit===Zr.kPixels)return Number(e.value);if(e.unit===Zr.kPercentage&&n){var i=n.nodeName===Yr.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[t]:0)+e.value/100*i.halfExtents[t]*2}return 0}var vv=function(e){return oc(/deg|rad|grad|turn|px|%/g,e)},ed=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function Cf(e){if(e===void 0&&(e=""),e=e.toLowerCase().trim(),e==="none")return[];for(var t=/\s*([\w-]+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];if(i=r.index+r[0].length,ed.indexOf(r[1])>-1&&n.push({name:r[1],params:r[2].split(" ").map(function(s){return vv(s)||Af(s)})}),t.lastIndex===e.length)return n}return[]}function sh(e){return e.toString()}var Od=function(e){return typeof e=="number"?zs(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?zs(Number(e)):zs(0)},td=Kt(Od);Kt(function(e){return Xo(e)?e.split(" ").map(td):e.map(td)});function Jd(e,t){return[e,t,sh]}function Of(e,t){return function(n,r){return[n,r,function(i){return sh((0,ya.Z)(i,e,t))}]}}function nd(e,t){if(e.length===t.length)return[e,t,function(n){return n}]}function gv(e){return e.parsedStyle.d.totalLength===0&&(e.parsedStyle.d.totalLength=Qu(e.parsedStyle.d.absolutePath)),e.parsedStyle.d.totalLength}function _y(e){return e.parsedStyle.points.totalLength===0&&(e.parsedStyle.points.totalLength=Xc(e.parsedStyle.points.points)),e.parsedStyle.points.totalLength}function yv(e){for(var t=0;t<e.length;t++){var n=e[t-1],r=e[t],i=r[0];if(i==="M"&&n){var s=n[0],l=[r[1],r[2]],u=void 0;s==="L"||s==="M"?u=[n[1],n[2]]:(s==="C"||s==="A"||s==="Q")&&(u=[n[n.length-2],n[n.length-1]]),u&&gm(l,u)&&(e.splice(t,1),t--)}}}function sg(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r],s=i[0];if(s==="C"||s==="A"||s==="Q"){t=!0;break}}return t}function rd(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var s=e[i],l=s[0];l==="M"?(r.length&&(n.push(r),r=[]),r.push([s[1],s[2]])):l==="Z"?r.length&&(t.push(r),r=[]):r.push([s[1],s[2]])}return r.length>0&&n.push(r),{polygons:t,polylines:n}}function gm(e,t){return e[0]===t[0]&&e[1]===t[1]}function lh(e,t){for(var n=[],r=[],i=[],s=0;s<e.length;s++){var l=e[s],u=l.currentPoint,h=l.params,p=l.prePoint,m=void 0;switch(l.command){case"Q":m=Kh(p[0],p[1],h[1],h[2],h[3],h[4]);break;case"C":m=Sd(p[0],p[1],h[1],h[2],h[3],h[4],h[5],h[6]);break;case"A":var y=l.arcParams;m=Wc(y.cx,y.cy,y.rx,y.ry,y.xRotation,y.startAngle,y.endAngle);break;default:n.push(u[0]),r.push(u[1]);break}m&&(l.box=m,n.push(m.x,m.x+m.width),r.push(m.y,m.y+m.height)),t&&(l.command==="L"||l.command==="M")&&l.prePoint&&l.nextPoint&&i.push(l)}n=n.filter(function(N){return!Number.isNaN(N)&&N!==1/0&&N!==-1/0}),r=r.filter(function(N){return!Number.isNaN(N)&&N!==1/0&&N!==-1/0});var b=au(n),w=au(r),R=xc(n),P=xc(r);if(i.length===0)return{x:b,y:w,width:R-b,height:P-w};for(var s=0;s<i.length;s++){var l=i[s],u=l.currentPoint,I=void 0;u[0]===b?(I=ep(l,t),b=b-I.xExtra):u[0]===R&&(I=ep(l,t),R=R+I.xExtra),u[1]===w?(I=ep(l,t),w=w-I.yExtra):u[1]===P&&(I=ep(l,t),P=P+I.yExtra)}return{x:b,y:w,width:R-b,height:P-w}}function ep(e,t){var n=e.prePoint,r=e.currentPoint,i=e.nextPoint,s=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),l=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),u=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),h=Math.acos((s+l-u)/(2*Math.sqrt(s)*Math.sqrt(l)));if(!h||Math.sin(h)===0||hl(h,0))return{xExtra:0,yExtra:0};var p=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),m=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));p=p>Math.PI/2?Math.PI-p:p,m=m>Math.PI/2?Math.PI-m:m;var y={xExtra:Math.cos(h/2-p)*(t/2*(1/Math.sin(h/2)))-t/2||0,yExtra:Math.cos(m-h/2)*(t/2*(1/Math.sin(h/2)))-t/2||0};return y}function tp(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}var Rd=function(e,t){var n=e.x*t.x+e.y*t.y,r=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2))),i=e.x*t.y-e.y*t.x<0?-1:1,s=i*Math.acos(n/r);return s},_v=function(e,t,n,r,i,s,l,u){t=Math.abs(t),n=Math.abs(n),r=ef(r,360);var h=Ds(r);if(e.x===l.x&&e.y===l.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(t===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var p=(e.x-l.x)/2,m=(e.y-l.y)/2,y={x:Math.cos(h)*p+Math.sin(h)*m,y:-Math.sin(h)*p+Math.cos(h)*m},b=Math.pow(y.x,2)/Math.pow(t,2)+Math.pow(y.y,2)/Math.pow(n,2);b>1&&(t=Math.sqrt(b)*t,n=Math.sqrt(b)*n);var w=Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(y.y,2)-Math.pow(n,2)*Math.pow(y.x,2),R=Math.pow(t,2)*Math.pow(y.y,2)+Math.pow(n,2)*Math.pow(y.x,2),P=w/R;P=P<0?0:P;var I=(i!==s?1:-1)*Math.sqrt(P),N={x:I*(t*y.y/n),y:I*(-(n*y.x)/t)},z={x:Math.cos(h)*N.x-Math.sin(h)*N.y+(e.x+l.x)/2,y:Math.sin(h)*N.x+Math.cos(h)*N.y+(e.y+l.y)/2},Z={x:(y.x-N.x)/t,y:(y.y-N.y)/n},Y=Rd({x:1,y:0},Z),$={x:(-y.x-N.x)/t,y:(-y.y-N.y)/n},J=Rd(Z,$);!s&&J>0?J-=2*Math.PI:s&&J<0&&(J+=2*Math.PI),J%=2*Math.PI;var ae=Y+J*u,pe=t*Math.cos(ae),Oe=n*Math.sin(ae),Ve={x:Math.cos(h)*pe-Math.sin(h)*Oe+z.x,y:Math.sin(h)*pe+Math.cos(h)*Oe+z.y,ellipticalArcStartAngle:Y,ellipticalArcEndAngle:Y+J,ellipticalArcAngle:ae,ellipticalArcCenter:z,resultantRx:t,resultantRy:n};return Ve};function np(e){for(var t=[],n=null,r=null,i=null,s=0,l=e.length,u=0;u<l;u++){var h=e[u];r=e[u+1];var p=h[0],m={command:p,prePoint:n,params:h,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(p){case"M":i=[h[1],h[2]],s=u;break;case"A":var y=hc(n,h);m.arcParams=y;break}if(p==="Z")n=i,r=e[s+1];else{var b=h.length;n=[h[b-2],h[b-1]]}r&&r[0]==="Z"&&(r=e[s],t[s]&&(t[s].prePoint=n)),m.currentPoint=n,t[s]&&gm(n,t[s].currentPoint)&&(t[s].prePoint=m.prePoint);var w=r?[r[r.length-2],r[r.length-1]]:null;m.nextPoint=w;var R=m.prePoint;if(["L","H","V"].includes(p))m.startTangent=[R[0]-n[0],R[1]-n[1]],m.endTangent=[n[0]-R[0],n[1]-R[1]];else if(p==="Q"){var P=[h[1],h[2]];m.startTangent=[R[0]-P[0],R[1]-P[1]],m.endTangent=[n[0]-P[0],n[1]-P[1]]}else if(p==="T"){var I=t[u-1],P=tp(I.currentPoint,R);I.command==="Q"?(m.command="Q",m.startTangent=[R[0]-P[0],R[1]-P[1]],m.endTangent=[n[0]-P[0],n[1]-P[1]]):(m.command="TL",m.startTangent=[R[0]-n[0],R[1]-n[1]],m.endTangent=[n[0]-R[0],n[1]-R[1]])}else if(p==="C"){var N=[h[1],h[2]],z=[h[3],h[4]];m.startTangent=[R[0]-N[0],R[1]-N[1]],m.endTangent=[n[0]-z[0],n[1]-z[1]],m.startTangent[0]===0&&m.startTangent[1]===0&&(m.startTangent=[N[0]-z[0],N[1]-z[1]]),m.endTangent[0]===0&&m.endTangent[1]===0&&(m.endTangent=[z[0]-N[0],z[1]-N[1]])}else if(p==="S"){var I=t[u-1],N=tp(I.currentPoint,R),z=[h[1],h[2]];I.command==="C"?(m.command="C",m.startTangent=[R[0]-N[0],R[1]-N[1]],m.endTangent=[n[0]-z[0],n[1]-z[1]]):(m.command="SQ",m.startTangent=[R[0]-z[0],R[1]-z[1]],m.endTangent=[n[0]-z[0],n[1]-z[1]])}else if(p==="A"){var Z=V0(m,0),Y=Z.x,$=Z.y,J=V0(m,1,!1),ae=J.x,pe=J.y;m.startTangent=[Y,$],m.endTangent=[ae,pe]}t.push(m)}return t}function V0(e,t,n){n===void 0&&(n=!0);var r=e.arcParams,i=r.rx,s=i===void 0?0:i,l=r.ry,u=l===void 0?0:l,h=r.xRotation,p=r.arcFlag,m=r.sweepFlag,y=_v({x:e.prePoint[0],y:e.prePoint[1]},s,u,h,!!p,!!m,{x:e.currentPoint[0],y:e.currentPoint[1]},t),b=_v({x:e.prePoint[0],y:e.prePoint[1]},s,u,h,!!p,!!m,{x:e.currentPoint[0],y:e.currentPoint[1]},n?t+.005:t-.005),w=b.x-y.x,R=b.y-y.y,P=Math.sqrt(w*w+R*R);return{x:-w/P,y:-R/P}}function Md(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function qc(e,t){return Md(e)*Md(t)?(e[0]*t[0]+e[1]*t[1])/(Md(e)*Md(t)):1}function Qc(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(qc(e,t))}function hc(e,t){var n=t[1],r=t[2],i=ef(Ds(t[3]),Math.PI*2),s=t[4],l=t[5],u=e[0],h=e[1],p=t[6],m=t[7],y=Math.cos(i)*(u-p)/2+Math.sin(i)*(h-m)/2,b=-1*Math.sin(i)*(u-p)/2+Math.cos(i)*(h-m)/2,w=y*y/(n*n)+b*b/(r*r);w>1&&(n*=Math.sqrt(w),r*=Math.sqrt(w));var R=n*n*(b*b)+r*r*(y*y),P=R?Math.sqrt((n*n*(r*r)-R)/R):1;s===l&&(P*=-1),isNaN(P)&&(P=0);var I=r?P*n*b/r:0,N=n?P*-r*y/n:0,z=(u+p)/2+Math.cos(i)*I-Math.sin(i)*N,Z=(h+m)/2+Math.sin(i)*I+Math.cos(i)*N,Y=[(y-I)/n,(b-N)/r],$=[(-1*y-I)/n,(-1*b-N)/r],J=Qc([1,0],Y),ae=Qc(Y,$);return qc(Y,$)<=-1&&(ae=Math.PI),qc(Y,$)>=1&&(ae=0),l===0&&ae>0&&(ae=ae-2*Math.PI),l===1&&ae<0&&(ae=ae+2*Math.PI),{cx:z,cy:Z,rx:gm(e,[p,m])?0:n,ry:gm(e,[p,m])?0:r,startAngle:J,endAngle:J+ae,xRotation:i,arcFlag:s,sweepFlag:l}}function lf(e,t,n){return e.reduce(function(r,i){var s="";if(i[0]==="M"||i[0]==="L"){var l=mt.al(i[1],i[2],0);n&&mt.fF(l,l,n),s="".concat(i[0]).concat(l[0],",").concat(l[1])}else if(i[0]==="Z")s=i[0];else if(i[0]==="C"){var u=mt.al(i[1],i[2],0),h=mt.al(i[3],i[4],0),p=mt.al(i[5],i[6],0);n&&(mt.fF(u,u,n),mt.fF(h,h,n),mt.fF(p,p,n)),s="".concat(i[0]).concat(u[0],",").concat(u[1],",").concat(h[0],",").concat(h[1],",").concat(p[0],",").concat(p[1])}else if(i[0]==="A"){var m=mt.al(i[6],i[7],0);n&&mt.fF(m,m,n),s="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(m[0],",").concat(m[1])}else if(i[0]==="Q"){var u=mt.al(i[1],i[2],0),h=mt.al(i[3],i[4],0);n&&(mt.fF(u,u,n),mt.fF(h,h,n)),s="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=s},"")}function wu(e,t,n,r){return[["M",e,t],["L",n,r]]}function rp(e,t,n,r){var i=(-1+Math.sqrt(2))/3*4,s=e*i,l=t*i,u=n-e,h=n+e,p=r-t,m=r+t;return[["M",u,r],["C",u,r-l,n-s,p,n,p],["C",n+s,p,h,r-l,h,r],["C",h,r+l,n+s,m,n,m],["C",n-s,m,u,r+l,u,r],["Z"]]}function bv(e,t){var n=e.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return t&&n.push(["Z"]),n}function by(e,t,n,r,i){if(i){var s=(0,j.CR)(i,4),l=s[0],u=s[1],h=s[2],p=s[3],m=e>0?1:-1,y=t>0?1:-1,b=m+y!==0?1:0;return[["M",m*l+n,r],["L",e-m*u+n,r],u?["A",u,u,0,0,b,e+n,y*u+r]:null,["L",e+n,t-y*h+r],h?["A",h,h,0,0,b,e+n-m*h,t+r]:null,["L",n+m*p,t+r],p?["A",p,p,0,0,b,n,t+r-y*p]:null,["L",n,y*l+r],l?["A",l,l,0,0,b,m*l+n,r]:null,["Z"]].filter(function(w){return w})}return[["M",n,r],["L",n+e,r],["L",n+e,r+t],["L",n,r+t],["Z"]]}function lg(e,t){t===void 0&&(t=e.getLocalTransform());var n=[];switch(e.nodeName){case Yr.LINE:var r=e.parsedStyle,i=r.x1,s=i===void 0?0:i,l=r.y1,u=l===void 0?0:l,h=r.x2,p=h===void 0?0:h,m=r.y2,y=m===void 0?0:m;n=wu(s,u,p,y);break;case Yr.CIRCLE:{var b=e.parsedStyle,w=b.r,R=w===void 0?0:w,P=b.cx,I=P===void 0?0:P,N=b.cy,z=N===void 0?0:N;n=rp(R,R,I,z);break}case Yr.ELLIPSE:{var Z=e.parsedStyle,Y=Z.rx,$=Y===void 0?0:Y,J=Z.ry,ae=J===void 0?0:J,pe=Z.cx,I=pe===void 0?0:pe,Oe=Z.cy,z=Oe===void 0?0:Oe;n=rp($,ae,I,z);break}case Yr.POLYLINE:case Yr.POLYGON:var Ve=e.parsedStyle.points;n=bv(Ve.points,e.nodeName===Yr.POLYGON);break;case Yr.RECT:var Ke=e.parsedStyle,lt=Ke.width,Ge=lt===void 0?0:lt,rt=Ke.height,st=rt===void 0?0:rt,ut=Ke.x,jt=ut===void 0?0:ut,At=Ke.y,zt=At===void 0?0:At,wn=Ke.radius,Hn=wn&&wn.some(function(or){return or!==0});n=by(Ge,st,jt,zt,Hn&&wn.map(function(or){return(0,ya.Z)(or,0,Math.min(Math.abs(Ge)/2,Math.abs(st)/2))}));break;case Yr.PATH:var rr=e.parsedStyle.d.absolutePath;n=(0,j.ev)([],(0,j.CR)(rr),!1);break}if(n.length)return lf(n,e,t)}function ym(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0);var s=e.map(function(l,u){var h=l[0],p=e[u+1],m=u===0&&(t!==0||n!==0),y=(u===e.length-1||p&&(p[0]==="M"||p[0]==="Z"))&&r!==0&&i!==0;switch(h){case"M":return m?"M ".concat(l[1]+t,",").concat(l[2]+n," L ").concat(l[1],",").concat(l[2]):"M ".concat(l[1],",").concat(l[2]);case"L":return"L ".concat(l[1]+(y?r:0),",").concat(l[2]+(y?i:0));case"Q":return"Q ".concat(l[1]," ").concat(l[2],",").concat(l[3]," ").concat(l[4])+(y?" L ".concat(l[3]+r,",").concat(l[4]+i):"");case"C":return"C ".concat(l[1]," ").concat(l[2],",").concat(l[3]," ").concat(l[4],",").concat(l[5]," ").concat(l[6])+(y?" L ".concat(l[5]+r,",").concat(l[6]+i):"");case"A":return"A ".concat(l[1]," ").concat(l[2]," ").concat(l[3]," ").concat(l[4]," ").concat(l[5]," ").concat(l[6]," ").concat(l[7])+(y?" L ".concat(l[6]+r,",").concat(l[7]+i):"");case"Z":return"Z"}}).join(" ");return~s.indexOf("NaN")?"":s}var _m=function(e){if(e===""||Array.isArray(e)&&e.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var t;try{t=Kf(e)}catch(b){t=Kf(""),console.error("[g]: Invalid SVG Path definition: ".concat(e))}yv(t);var n=sg(t),r=rd(t),i=r.polygons,s=r.polylines,l=np(t),u=lh(l,0),h=u.x,p=u.y,m=u.width,y=u.height;return{absolutePath:t,hasArc:n,segments:l,polygons:i,polylines:s,totalLength:0,rect:{x:Number.isFinite(h)?h:0,y:Number.isFinite(p)?p:0,width:Number.isFinite(m)?m:0,height:Number.isFinite(y)?y:0}}},xv=Kt(_m);function Jc(e){return Xo(e)?xv(e):_m(e)}function bm(e,t,n){var r=e.curve,i=t.curve;(!r||r.length===0)&&(r=Bf(e.absolutePath,!1),e.curve=r),(!i||i.length===0)&&(i=Bf(t.absolutePath,!1),t.curve=i);var s=[r,i];r.length!==i.length&&(s=ge(r,i));var l=K(s[0])!==K(s[1])?tr(s[0]):Mr(s[0]);return[l,zi(s[1],l),function(u){return u}]}function H0(e,t){var n;return Xo(e)?n=e.split(" ").map(function(r){var i=(0,j.CR)(r.split(","),2),s=i[0],l=i[1];return[Number(s),Number(l)]}):n=e,{points:n,totalLength:0,segments:[]}}function Ev(e,t){return[e.points,t.points,function(n){return n}]}var Sl=null;function wc(e){return function(t){var n=0;return e.map(function(r){return r===Sl?t[n++]:r})}}function Ip(e){return e}var xm={matrix:["NNNNNN",[Sl,Sl,0,0,Sl,Sl,0,0,0,0,1,0,Sl,Sl,0,1],Ip],matrix3d:["NNNNNNNNNNNNNNNN",Ip],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",wc([Sl,Sl,new os(1)]),Ip],scalex:["N",wc([Sl,new os(1),new os(1)]),wc([Sl,new os(1)])],scaley:["N",wc([new os(1),Sl,new os(1)]),wc([new os(1),Sl])],scalez:["N",wc([new os(1),new os(1),Sl])],scale3d:["NNN",Ip],skew:["Aa",null,Ip],skewx:["A",null,wc([Sl,ga])],skewy:["A",null,wc([ga,Sl])],translate:["Tt",wc([Sl,Sl,Ns]),Ip],translatex:["T",wc([Sl,Ns,Ns]),wc([Sl,Ns])],translatey:["T",wc([Ns,Sl,Ns]),wc([Ns,Sl])],translatez:["L",wc([Ns,Ns,Sl])],translate3d:["TTL",Ip]};function Em(e){if(e=(e||"none").toLowerCase().trim(),e==="none")return[];for(var t=/\s*(\w+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];i=r.index+r[0].length;var s=r[1],l=xm[s];if(!l)return[];var u=r[2].split(","),h=l[0];if(h.length<u.length)return[];for(var p=[],m=0;m<h.length;m++){var y=u[m],b=h[m],w=void 0;if(y?w={A:function(R){return R.trim()==="0"?ga:Jh(R)},N:td,T:ah,L:El}[b.toUpperCase()](y):w={a:ga,n:p[0],t:Ns}[b],w===void 0)return[];p.push(w)}if(n.push({t:s,d:p}),t.lastIndex===e.length)return n}return[]}function Sv(e){if(e=(e||"none").toLowerCase().trim(),e==="none")return[];for(var t=/\s*(\w+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];i=r.index+r[0].length;var s=r[1],l=xm[s];if(!l)return[];var u=r[2].split(","),h=l[0];if(h.length<u.length)return[];for(var p=[],m=0;m<h.length;m++){var y=u[m],b=h[m],w=void 0;if(y?w={A:function(R){return R.trim()==="0"?ga:Cd(R)},N:Od,T:Mp,L:qd}[b.toUpperCase()](y):w={a:ga,n:p[0],t:Ns}[b],w===void 0)return[];p.push(w)}if(n.push({t:s,d:p}),t.lastIndex===e.length)return n}return[]}function Ue(e){var t,n,r,i;switch(e.t){case"rotatex":return i=Ds(fc(e.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=Ds(fc(e.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=Ds(fc(e.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=e.d[0].value,n=e.d[1].value,r=e.d[2].value,i=Ds(fc(e.d[3]));var s=t*t+n*n+r*r;if(s===0)t=1,n=0,r=0;else if(s!==1){var l=Math.sqrt(s);t/=l,n/=l,r/=l}var u=Math.sin(i/2),h=u*Math.cos(i/2),p=u*u;return[1-2*(n*n+r*r)*p,2*(t*n*p+r*h),2*(t*r*p-n*h),0,2*(t*n*p-r*h),1-2*(t*t+r*r)*p,2*(n*r*p+t*h),0,2*(t*r*p+n*h),2*(n*r*p-t*h),1-2*(t*t+n*n)*p,0,0,0,0,1];case"scale":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[e.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,e.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,e.d[0].value,0,0,0,0,1];case"scale3d":return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,e.d[2].value,0,0,0,0,1];case"skew":var m=Ds(fc(e.d[0])),y=Ds(fc(e.d[1]));return[1,Math.tan(y),0,0,Math.tan(m),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=Ds(fc(e.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=Ds(fc(e.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return t=fu(e.d[0],0,null)||0,n=fu(e.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,0,1];case"translatex":return t=fu(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1];case"translatey":return n=fu(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,n,0,1];case"translatez":return r=fu(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return t=fu(e.d[0],0,null)||0,n=fu(e.d[1],0,null)||0,r=fu(e.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,r,1];case"perspective":var b=fu(e.d[0],0,null)||0,w=b?-1/b:0;return[1,0,0,0,0,1,0,0,0,0,1,w,0,0,0,1];case"matrix":return[e.d[0].value,e.d[1].value,0,0,e.d[2].value,e.d[3].value,0,0,0,0,1,0,e.d[4].value,e.d[5].value,0,1];case"matrix3d":return e.d.map(function(R){return R.value})}}function Qt(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]]}function Mn(e){return e.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map(Ue).reduce(Qt)}function Ar(e){var t=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],s=[0,0,0,1];return En(Mn(e),t,n,r,i,s),[[t,n,r,s,i]]}var $r=function(){function e(r,i){for(var s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],l=0;l<4;l++)for(var u=0;u<4;u++)for(var h=0;h<4;h++)s[l][u]+=i[l][h]*r[h][u];return s}function t(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function n(r,i,s,l,u){for(var h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],p=0;p<4;p++)h[p][3]=u[p];for(var p=0;p<3;p++)for(var m=0;m<3;m++)h[3][p]+=r[m]*h[m][p];var y=l[0],b=l[1],w=l[2],R=l[3],P=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];P[0][0]=1-2*(b*b+w*w),P[0][1]=2*(y*b-w*R),P[0][2]=2*(y*w+b*R),P[1][0]=2*(y*b+w*R),P[1][1]=1-2*(y*y+w*w),P[1][2]=2*(b*w-y*R),P[2][0]=2*(y*w-b*R),P[2][1]=2*(b*w+y*R),P[2][2]=1-2*(y*y+b*b),h=e(h,P);var I=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];s[2]&&(I[2][1]=s[2],h=e(h,I)),s[1]&&(I[2][1]=0,I[2][0]=s[0],h=e(h,I)),s[0]&&(I[2][0]=0,I[1][0]=s[0],h=e(h,I));for(var p=0;p<3;p++)for(var m=0;m<3;m++)h[p][m]*=i[p];return t(h)?[h[0][0],h[0][1],h[1][0],h[1][1],h[3][0],h[3][1]]:h[0].concat(h[1],h[2],h[3])}return n}();function Or(e){return e.toFixed(6).replace(".000000","")}function yr(e,t){var n,r;return e.decompositionPair!==t&&(e.decompositionPair=t,n=Ar(e)),t.decompositionPair!==e&&(t.decompositionPair=e,r=Ar(t)),n[0]===null||r[0]===null?[[!1],[!0],function(i){return i?t[0].d:e[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(i){var s=fi(n[0][3],r[0][3],i[5]),l=$r(i[0],i[1],i[2],s,i[4]),u=l.map(Or).join(",");return u}])}function Ai(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function fi(e,t,n){var r=Ai(e,t);r=(0,ya.Z)(r,-1,1);var i=[];if(r===1)i=e;else for(var s=Math.acos(r),l=Math.sin(n*s)*1/Math.sqrt(1-r*r),u=0;u<4;u++)i.push(e[u]*(Math.cos(n*s)-r*l)+t[u]*l);return i}function Li(e){return e.replace(/[xy]/,"")}function wi(e){return e.replace(/(x|y|z|3d)?$/,"3d")}var Ni=function(e,t){return e==="perspective"&&t==="perspective"||(e==="matrix"||e==="matrix3d")&&(t==="matrix"||t==="matrix3d")};function Yi(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=function(J){var ae=e[J],pe=ae.t,Oe=ae.d,Ve=pe.substring(0,5)==="scale"?1:0;t.push({t:pe,d:Oe.map(function(Ke){return typeof Ke=="number"?zs(Ve):zs(Ve,Ke.unit)})})},s=0;s<e.length;s++)i(s)}var l=[],u=[],h=[];if(e.length!==t.length){var p=yr(e,t);l=[p[0]],u=[p[1]],h=[["matrix",[p[2]]]]}else for(var s=0;s<e.length;s++){var m=e[s].t,y=t[s].t,b=e[s].d,w=t[s].d,R=xm[m],P=xm[y],I=void 0;if(Ni(m,y)){var p=yr([e[s]],[t[s]]);l.push(p[0]),u.push(p[1]),h.push(["matrix",[p[2]]]);continue}else if(m===y)I=m;else if(R[2]&&P[2]&&Li(m)===Li(y))I=Li(m),b=R[2](b),w=P[2](w);else if(R[1]&&P[1]&&wi(m)===wi(y))I=wi(m),b=R[1](b),w=P[1](w);else{var p=yr(e,t);l=[p[0]],u=[p[1]],h=[["matrix",[p[2]]]];break}for(var N=[],z=[],Z=[],Y=0;Y<b.length;Y++){var p=Pp(b[Y],w[Y],n,!1,Y);N[Y]=p[0],z[Y]=p[1],Z.push(p[2])}l.push(N),u.push(z),h.push([I,Z])}if(r){var $=l;l=u,u=$}return[l,u,function(J){return J.map(function(ae,pe){var Oe=ae.map(function(Ve,Ke){return h[pe][1][Ke](Ve)}).join(",");return h[pe][0]==="matrix"&&Oe.split(",").length===16&&(h[pe][0]="matrix3d"),h[pe][0]==="matrix3d"&&Oe.split(",").length===6&&(h[pe][0]="matrix"),h[pe][0]+"("+Oe+")"}).join(" ")}]}var pi=Kt(function(e){if(Xo(e)){if(e==="text-anchor")return[zs(0,"px"),zs(0,"px")];var t=e.split(" ");return t.length===1&&(t[0]==="top"||t[0]==="bottom"?(t[1]=t[0],t[0]="center"):t[1]="center"),t.length!==2?null:[ah(ur(t[0])),ah(ur(t[1]))]}else return[zs(e[0]||0,"px"),zs(e[1]||0,"px")]}),Fi=function(e){if(Xo(e)){if(e==="text-anchor")return[zs(0,"px"),zs(0,"px")];var t=e.split(" ");return t.length===1&&(t[0]==="top"||t[0]==="bottom"?(t[1]=t[0],t[0]="center"):t[1]="center"),t.length!==2?null:[Mp(ur(t[0])),Mp(ur(t[1]))]}else return[zs(e[0]||0,"px"),zs(e[1]||0,"px")]};function ur(e){return e==="center"?"50%":e==="left"||e==="top"?"0%":e==="right"||e==="bottom"?"100%":e}var Nr=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:vo.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:vo.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:vo.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:vo.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:vo.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:vo.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:vo.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:vo.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:vo.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:vo.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:vo.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:vo.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:vo.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:vo.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:vo.FILTER},{n:"clipPath",syntax:vo.DEFINED_PATH},{n:"textPath",syntax:vo.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:vo.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:vo.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:vo.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:vo.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:vo.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:vo.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:vo.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:vo.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:vo.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:vo.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:vo.COORDINATE},{n:"y1",int:!0,l:!0,syntax:vo.COORDINATE},{n:"z1",int:!0,l:!0,syntax:vo.COORDINATE},{n:"x2",int:!0,l:!0,syntax:vo.COORDINATE},{n:"y2",int:!0,l:!0,syntax:vo.COORDINATE},{n:"z2",int:!0,l:!0,syntax:vo.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:vo.PATH,p:50},{n:"points",int:!0,l:!0,syntax:vo.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:vo.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:vo.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:vo.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:vo.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:vo.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:vo.NUMBER,d:function(e){return e===Yr.PATH||e===Yr.POLYGON||e===Yr.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:vo.MARKER},{n:"markerEnd",syntax:vo.MARKER},{n:"markerMid",syntax:vo.MARKER},{n:"markerStartOffset",syntax:vo.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:vo.LENGTH,l:!0,int:!0,d:"0"}],Ci=Nr.filter(function(e){return!!e.l}).map(function(e){return e.n}),Hi={},ei=new WeakMap,ro=function(e,t){var n=ei.get(e);return!n||n.length===0?!0:n.includes(t)},yi=function(){function e(t){var n=this;this.runtime=t,Nr.forEach(function(r){n.registerMetadata(r)})}return e.prototype.registerMetadata=function(t){(0,j.ev)([t.n],(0,j.CR)(t.a||[]),!1).forEach(function(n){Hi[n]=t})},e.prototype.unregisterMetadata=function(t){delete Hi[t]},e.prototype.getPropertySyntax=function(t){return this.runtime.CSSPropertySyntaxFactory[t]},e.prototype.processProperties=function(t,n,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var m=r.skipUpdateAttribute,y=r.skipParse,b=r.forceUpdateGeometry,w=r.usedAttributes,R=r.memoize,P=b,I=Object.keys(n);I.forEach(function(N){var z;m||(t.attributes[N]=n[N]),!P&&(!((z=Hi[N])===null||z===void 0)&&z.l)&&(P=!0)}),y||I.forEach(function(N){t.computedStyle[N]=i.parseProperty(N,t.attributes[N],t,R)}),w!=null&&w.length&&(I=Array.from(new Set(I.concat(w)))),I.forEach(function(N){N in t.computedStyle&&(t.parsedStyle[N]=i.computeProperty(N,t.computedStyle[N],t,R))}),P&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t)),I.forEach(function(N){N in t.parsedStyle&&i.postProcessProperty(N,t,I)}),this.runtime.enableCSSParsing&&t.children.length&&I.forEach(function(N){N in t.parsedStyle&&i.isPropertyInheritable(N)&&t.children.forEach(function(z){z.internalSetAttribute(N,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(t.attributes,n);var s=Object.keys(n),l=t.parsedStyle.clipPath,u=t.parsedStyle.offsetPath;t.parsedStyle=Object.assign(t.parsedStyle,n);var h=!!r.forceUpdateGeometry;if(!h){for(var p=0;p<Ci.length;p++)if(Ci[p]in n){h=!0;break}}n.fill&&(t.parsedStyle.fill=Af(n.fill)),n.stroke&&(t.parsedStyle.stroke=Af(n.stroke)),n.shadowColor&&(t.parsedStyle.shadowColor=Af(n.shadowColor)),n.filter&&(t.parsedStyle.filter=Cf(n.filter)),(0,Xr.Z)(n.radius)||(t.parsedStyle.radius=Uu(n.radius,4)),(0,Xr.Z)(n.lineDash)||(t.parsedStyle.lineDash=Uu(n.lineDash,2)),n.points&&(t.parsedStyle.points=H0(n.points)),n.d===""&&(t.parsedStyle.d=(0,j.pi)({},uu)),n.d&&(t.parsedStyle.d=Jc(n.d)),n.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:n.textTransform},t,null),Si(n.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",l,n.clipPath,t,this.runtime),n.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",u,n.offsetPath,t,this.runtime),n.transform&&(t.parsedStyle.transform=Em(n.transform)),n.transformOrigin&&(t.parsedStyle.transformOrigin=pi(n.transformOrigin)),n.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,n.markerStart,n.markerStart,null,null)),n.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,n.markerEnd,n.markerEnd,null,null)),n.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",n.markerMid,n.markerMid,null,null)),(0,Xr.Z)(n.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(t,s),(0,Xr.Z)(n.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(t,s),n.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(t,s),n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(t,s),h&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},e.prototype.parseProperty=function(t,n,r,i){var s=Hi[t],l=n;if((n===""||(0,Xr.Z)(n))&&(n="unset"),n==="unset"||n==="initial"||n==="inherit")l=Kd(n);else if(s){var u=s.k,h=s.syntax,p=h&&this.getPropertySyntax(h);u&&u.indexOf(n)>-1?l=Kd(n):p&&(!i&&p.parserUnmemoize?l=p.parserUnmemoize(n,r):p.parser&&(l=p.parser(n,r)))}return l},e.prototype.computeProperty=function(t,n,r,i){var s=Hi[t],l=r.id==="g-root",u=n;if(s){var h=s.syntax,p=s.inh,m=s.d;if(n instanceof pl){var y=n.value;if(y==="unset"&&(p&&!l?y="inherit":y="initial"),y==="initial")(0,Xr.Z)(m)||(n=this.parseProperty(t,Sf(m)?m(r.nodeName):m,r,i));else if(y==="inherit"){var b=this.tryToResolveProperty(r,t,{inherited:!0});if((0,Xr.Z)(b)){this.addUnresolveProperty(r,t);return}else return b}}var w=h&&this.getPropertySyntax(h);if(w&&w.calculator){var R=r.parsedStyle[t];u=w.calculator(t,R,n,r,this.runtime)}else n instanceof pl?u=n.value:u=n}return u},e.prototype.postProcessProperty=function(t,n,r){var i=Hi[t];if(i&&i.syntax){var s=i.syntax&&this.getPropertySyntax(i.syntax),l=s;l&&l.postProcessor&&l.postProcessor(n,r)}},e.prototype.addUnresolveProperty=function(t,n){var r=ei.get(t);r||(ei.set(t,[]),r=ei.get(t)),r.indexOf(n)===-1&&r.push(n)},e.prototype.tryToResolveProperty=function(t,n,r){r===void 0&&(r={});var i=r.inherited;if(i&&t.parentElement&&ro(t.parentElement,n)){var s=t.parentElement.parsedStyle[n];return s==="unset"||s==="initial"||s==="inherit"?void 0:s}},e.prototype.recalc=function(t){var n=ei.get(t);if(n&&n.length){var r={};n.forEach(function(i){r[i]=t.attributes[i]}),this.processProperties(t,r),ei.delete(t)}},e.prototype.updateGeometry=function(t){var n=t.nodeName,r=this.runtime.geometryUpdaterFactory[n];if(r){var i=t.geometry;i.contentBounds||(i.contentBounds=new Rn),i.renderBounds||(i.renderBounds=new Rn);var s=t.parsedStyle,l=r.update(s,t),u=l.cx,h=u===void 0?0:u,p=l.cy,m=p===void 0?0:p,y=l.cz,b=y===void 0?0:y,w=l.hwidth,R=w===void 0?0:w,P=l.hheight,I=P===void 0?0:P,N=l.hdepth,z=N===void 0?0:N,Z=[Math.abs(R),Math.abs(I),z],Y=s,$=Y.stroke,J=Y.lineWidth,ae=J===void 0?1:J,pe=Y.increasedLineWidthForHitTesting,Oe=pe===void 0?0:pe,Ve=Y.shadowType,Ke=Ve===void 0?"outer":Ve,lt=Y.shadowColor,Ge=Y.filter,rt=Ge===void 0?[]:Ge,st=Y.transformOrigin,ut=[h,m,b];i.contentBounds.update(ut,Z);var jt=n===Yr.POLYLINE||n===Yr.POLYGON||n===Yr.PATH?Math.SQRT2:.5,At=$&&!$.isNone;if(At){var zt=((ae||0)+(Oe||0))*jt;Z[0]+=zt,Z[1]+=zt}if(i.renderBounds.update(ut,Z),lt&&Ke&&Ke!=="inner"){var wn=i.renderBounds,Hn=wn.min,rr=wn.max,or=s,Hr=or.shadowBlur,ui=or.shadowOffsetX,Qi=or.shadowOffsetY,ii=Hr||0,ti=ui||0,Po=Qi||0,Ji=Hn[0]-ii+ti,Vi=rr[0]+ii+ti,xo=Hn[1]-ii+Po,Ko=rr[1]+ii+Po;Hn[0]=Math.min(Hn[0],Ji),rr[0]=Math.max(rr[0],Vi),Hn[1]=Math.min(Hn[1],xo),rr[1]=Math.max(rr[1],Ko),i.renderBounds.setMinMax(Hn,rr)}rt.forEach(function(hs){var Ml=hs.name,Pu=hs.params;if(Ml==="blur"){var Yf=Pu[0].value;i.renderBounds.update(i.renderBounds.center,sf(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[Yf,Yf,0]))}else if(Ml==="drop-shadow"){var Zc=Pu[0].value,mh=Pu[1].value,Iu=Pu[2].value,Ud=i.renderBounds,_c=Ud.min,Dc=Ud.max,kh=_c[0]-Iu+Zc,Lf=Dc[0]+Iu+Zc,sa=_c[1]-Iu+mh,qa=Dc[1]+Iu+mh;_c[0]=Math.min(_c[0],kh),Dc[0]=Math.max(Dc[0],Lf),_c[1]=Math.min(_c[1],sa),Dc[1]=Math.max(Dc[1],qa),i.renderBounds.setMinMax(_c,Dc)}}),t.geometry.dirty=!1;var la=R<0,wa=I<0,Vs=(la?-1:1)*(st?fu(st[0],0,t,!0):0),Ea=(wa?-1:1)*(st?fu(st[1],1,t,!0):0);(Vs||Ea)&&t.setOrigin(Vs,Ea)}},e.prototype.updateSizeAttenuation=function(t,n){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/n,t.nodeName===Yr.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/n)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===Yr.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))},e.prototype.isPropertyInheritable=function(t){var n=Hi[t];return n?n.inh:!1},e}(),to=function(){function e(){this.parser=Jh,this.parserUnmemoize=Cd,this.parserWithCSSDisabled=null,this.mixer=Jd}return e.prototype.calculator=function(t,n,r,i){return fc(r)},e}(),si=function(){function e(){}return e.prototype.calculator=function(t,n,r,i,s){return r instanceof pl&&(r=null),s.sceneGraphService.updateDisplayObjectDependency(t,n,r,i),t==="clipPath"&&i.forEach(function(l){l.childNodes.length===0&&s.sceneGraphService.dirtifyToRoot(l)}),r},e}(),qi=function(){function e(){this.parser=Af,this.parserWithCSSDisabled=Af,this.mixer=vm}return e.prototype.calculator=function(t,n,r,i){return r instanceof pl?r.value==="none"?oh:wd:r},e}(),Go=function(){function e(){this.parser=Cf}return e.prototype.calculator=function(t,n,r){return r instanceof pl?[]:r},e}();function fa(e){var t=e.parsedStyle.fontSize;return(0,Xr.Z)(t)?null:t}var $i=function(){function e(){this.parser=ah,this.parserUnmemoize=Mp,this.parserWithCSSDisabled=null,this.mixer=Jd}return e.prototype.calculator=function(t,n,r,i,s){var l;if((0,dr.Z)(r))return r;if(os.isRelativeUnit(r.unit)){var u=s.styleValueRegistry;if(r.unit===Zr.kPercentage)return 0;if(r.unit===Zr.kEms){if(i.parentNode){var h=fa(i.parentNode);if(h)return h*=r.value,h;u.addUnresolveProperty(i,t)}else u.addUnresolveProperty(i,t);return 0}else if(r.unit===Zr.kRems){if(!((l=i==null?void 0:i.ownerDocument)===null||l===void 0)&&l.documentElement){var h=fa(i.ownerDocument.documentElement);if(h)return h*=r.value,h;u.addUnresolveProperty(i,t)}else u.addUnresolveProperty(i,t);return 0}}else return r.value},e}(),_i=function(){function e(){this.mixer=nd}return e.prototype.parser=function(t){var n=Qd((0,dr.Z)(t)?[t]:t),r;return n.length===1?r=[n[0],n[0]]:r=[n[0],n[1]],r},e.prototype.calculator=function(t,n,r){return r.map(function(i){return i.value})},e}(),qr=function(){function e(){this.mixer=nd}return e.prototype.parser=function(t){var n=Qd((0,dr.Z)(t)?[t]:t),r;return n.length===1?r=[n[0],n[0],n[0],n[0]]:n.length===2?r=[n[0],n[1],n[0],n[1]]:n.length===3?r=[n[0],n[1],n[2],n[1]]:r=[n[0],n[1],n[2],n[3]],r},e.prototype.calculator=function(t,n,r){return r.map(function(i){return i.value})},e}(),Zo=function(){function e(){}return e.prototype.calculator=function(t,n,r,i){r instanceof pl&&(r=null);var s=r==null?void 0:r.cloneNode(!0);return s&&(s.style.isMarker=!0),s},e}(),Ua=function(){function e(){this.mixer=Jd,this.parser=td,this.parserUnmemoize=Od,this.parserWithCSSDisabled=null}return e.prototype.calculator=function(t,n,r){return r.value},e}(),oo=function(){function e(){this.parser=td,this.parserUnmemoize=Od,this.parserWithCSSDisabled=null,this.mixer=Of(0,1)}return e.prototype.calculator=function(t,n,r){return r.value},e.prototype.postProcessor=function(t){var n=t.parsedStyle,r=n.offsetPath,i=n.offsetDistance;if(r){var s=r.nodeName;if(s===Yr.LINE||s===Yr.PATH||s===Yr.POLYLINE){var l=r.getPoint(i);l&&t.setLocalPosition(l.x,l.y)}}},e}(),Pa=function(){function e(){this.parser=td,this.parserUnmemoize=Od,this.parserWithCSSDisabled=null,this.mixer=Of(0,1)}return e.prototype.calculator=function(t,n,r){return r.value},e}(),da=function(){function e(){this.parser=Jc,this.parserWithCSSDisabled=Jc,this.mixer=bm}return e.prototype.calculator=function(t,n,r){return r instanceof pl&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Dr(0,0,0,0)}:r},e}(),oa=function(){function e(){this.parser=H0,this.mixer=Ev}return e}(),gs=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.mixer=Of(0,1/0),n}return t}($i),jl=function(){function e(){}return e.prototype.calculator=function(t,n,r,i){return r instanceof pl?r.value==="unset"?"":r.value:"".concat(r)},e.prototype.postProcessor=function(t){t.nodeValue="".concat(t.parsedStyle.text)||""},e}(),eu=function(){function e(){}return e.prototype.calculator=function(t,n,r,i){var s=i.getAttribute("text");if(s){var l=s;r.value==="capitalize"?l=s.charAt(0).toUpperCase()+s.slice(1):r.value==="lowercase"?l=s.toLowerCase():r.value==="uppercase"&&(l=s.toUpperCase()),i.parsedStyle.text=l}return r.value},e}(),ja={},Xl=0;function Js(e,t){if(e){var n=typeof e=="string"?e:e.id||Xl++;ja[n]&&ja[n].destroy(),ja[n]=t}}var vl=typeof window!="undefined"&&typeof window.document!="undefined";function Yl(e){return!!e.getAttribute}function ps(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;$l(e[i],t)<0?n=i+1:r=i}return n}function $l(e,t){var n=Number(e.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(n===r){var i=e.parentNode;if(i){var s=i.childNodes||[];return s.indexOf(e)-s.indexOf(t)}}return n-r}function Kl(e){var t,n=e;do{var r=(t=n.parsedStyle)===null||t===void 0?void 0:t.clipPath;if(r)return n;n=n.parentElement}while(n!==null);return null}var dc="px";function Ca(e,t,n){vl&&e.style&&(e.style.width=t+dc,e.style.height=n+dc)}function Uc(e,t){if(vl)return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function Ms(e){var t=Uc(e,"width");return t==="auto"?e.offsetWidth:parseFloat(t)}function Yo(e){var t=Uc(e,"height");return t==="auto"?e.offsetHeight:parseFloat(t)}var Ia=1,us={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Dl=typeof performance=="object"&&performance.now?performance:Date;function hu(e,t,n){e===void 0&&(e="auto");var r=!1,i=!1,s=!!t&&!t.isNone,l=!!n&&!n.isNone;return e==="visiblepainted"||e==="painted"||e==="auto"?(r=s,i=l):e==="visiblefill"||e==="fill"?r=!0:e==="visiblestroke"||e==="stroke"?i=!0:(e==="visible"||e==="all")&&(r=!0,i=!0),[r,i]}var dn=1,Pr=function(){return dn++},pr=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},lo=Date.now(),Fa=function(){return pr.performance&&typeof pr.performance.now=="function"?pr.performance.now():Date.now()-lo},as={},It=Date.now(),rn=function(e){if(typeof e!="function")throw new TypeError(e+" is not a function");var t=Date.now(),n=t-It,r=n>16?0:16-n,i=Pr();return as[i]=e,Object.keys(as).length>1||setTimeout(function(){It=t;var s=as;as={},Object.keys(s).forEach(function(l){return s[l](Fa())})},r),i},In=function(e){delete as[e]},wr=["","webkit","moz","ms","o"],br=function(e){return typeof e!="string"?rn:e===""?pr.requestAnimationFrame:pr[e+"RequestAnimationFrame"]},Vn=function(e){return typeof e!="string"?In:e===""?pr.cancelAnimationFrame:pr[e+"CancelAnimationFrame"]||pr[e+"CancelRequestAnimationFrame"]},Kn=function(e,t){for(var n=0;e[n]!==void 0;){if(t(e[n]))return e[n];n=n+1}},nr=Kn(wr,function(e){return!!br(e)}),bn=br(nr),Zn=Vn(nr);pr.requestAnimationFrame=bn,pr.cancelAnimationFrame=Zn;var nn=function(){function e(){this.callbacks=[]}return e.prototype.getCallbacksNum=function(){return this.callbacks.length},e.prototype.tapPromise=function(t,n){this.callbacks.push(n)},e.prototype.promise=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,(0,j.ev)([],(0,j.CR)(t),!1))}))},e}(),Xn=function(){function e(){this.callbacks=[]}return e.prototype.tapPromise=function(t,n){this.callbacks.push(n)},e.prototype.promise=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(0,j.mG)(this,void 0,void 0,function(){var r,i,s,l;return(0,j.Jh)(this,function(u){switch(u.label){case 0:return this.callbacks.length?[4,(l=this.callbacks)[0].apply(l,(0,j.ev)([],(0,j.CR)(t),!1))]:[3,6];case 1:r=u.sent(),i=0,u.label=2;case 2:return i<this.callbacks.length-1?(s=this.callbacks[i],[4,s(r)]):[3,5];case 3:r=u.sent(),u.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},e}(),Sr=function(){function e(){this.callbacks=[]}return e.prototype.tap=function(t,n){this.callbacks.push(n)},e.prototype.call=function(){var t=arguments;this.callbacks.forEach(function(n){n.apply(void 0,t)})},e}(),zr=function(){function e(){this.callbacks=[]}return e.prototype.tap=function(t,n){this.callbacks.push(n)},e.prototype.call=function(){if(this.callbacks.length){for(var t=arguments,n=this.callbacks[0].apply(void 0,t),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];n=i(n)}return n}return null},e}(),di=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ni=/([\"\'])[^\'\"]+\1/;function gi(e){for(var t=e.fontSize,n=t===void 0?16:t,r=e.fontFamily,i=r===void 0?"sans-serif":r,s=e.fontStyle,l=s===void 0?"normal":s,u=e.fontVariant,h=u===void 0?"normal":u,p=e.fontWeight,m=p===void 0?"normal":p,y=(0,dr.Z)(n)&&"".concat(n,"px")||"16px",b=i.split(","),w=b.length-1;w>=0;w--){var R=b[w].trim();!ni.test(R)&&di.indexOf(R)<0&&(R='"'.concat(R,'"')),b[w]=R}return"".concat(l," ").concat(h," ").concat(m," ").concat(y," ").concat(b.join(","))}function To(e,t,n){return Gt.identity(e),e[4]=Math.tan(t),e[1]=Math.tan(n),e}var co=1e-5,So=Gt.create(),mo=Gt.create();function aa(e,t){if(e.length){var n=Gt.identity(So);e.forEach(function(r){var i=r.t,s=r.d;if(i==="scale"){var l=(s==null?void 0:s.map(function(N){return Math.max(N.value,co)}))||[1,1];Gt.fromScaling(mo,[l[0],l[1],1])}else if(i==="scalex"){var l=(s==null?void 0:s.map(function(z){return Math.max(z.value,co)}))||[1];Gt.fromScaling(mo,[l[0],1,1])}else if(i==="scaley"){var l=(s==null?void 0:s.map(function(z){return Math.max(z.value,co)}))||[1];Gt.fromScaling(mo,[1,l[0],1])}else if(i==="scalez"){var l=(s==null?void 0:s.map(function(z){return Math.max(z.value,co)}))||[1];Gt.fromScaling(mo,[1,1,l[0]])}else if(i==="scale3d"){var l=(s==null?void 0:s.map(function(z){return Math.max(z.value,co)}))||[1,1,1];Gt.fromScaling(mo,[l[0],l[1],l[2]])}else if(i==="translate"){var u=s||[Ns,Ns];Gt.fromTranslation(mo,[u[0].value,u[1].value,0])}else if(i==="translatex"){var u=s||[Ns];Gt.fromTranslation(mo,[u[0].value,0,0])}else if(i==="translatey"){var u=s||[Ns];Gt.fromTranslation(mo,[0,u[0].value,0])}else if(i==="translatez"){var u=s||[Ns];Gt.fromTranslation(mo,[0,0,u[0].value])}else if(i==="translate3d"){var u=s||[Ns,Ns,Ns];Gt.fromTranslation(mo,[u[0].value,u[1].value,u[2].value])}else if(i==="rotate"){var h=s||[ga];Gt.fromZRotation(mo,Ds(fc(h[0])))}else if(i==="rotatex"){var h=s||[ga];Gt.fromXRotation(mo,Ds(fc(h[0])))}else if(i==="rotatey"){var h=s||[ga];Gt.fromYRotation(mo,Ds(fc(h[0])))}else if(i==="rotatez"){var h=s||[ga];Gt.fromZRotation(mo,Ds(fc(h[0])))}else if(i==="rotate3d"){var h=s||[Ns,Ns,Ns,ga];Gt.fromRotation(mo,Ds(fc(h[3])),[h[0].value,h[1].value,h[2].value])}else if(i==="skew"){var p=(s==null?void 0:s.map(function(N){return N.value}))||[0,0];To(mo,Ds(p[0]),Ds(p[1]))}else if(i==="skewx"){var p=(s==null?void 0:s.map(function(z){return z.value}))||[0];To(mo,Ds(p[0]),0)}else if(i==="skewy"){var p=(s==null?void 0:s.map(function(z){return z.value}))||[0];To(mo,0,Ds(p[0]))}else if(i==="matrix"){var m=(0,j.CR)(s.map(function(N){return N.value}),6),y=m[0],b=m[1],w=m[2],R=m[3],P=m[4],I=m[5];Gt.set(mo,y,b,0,0,w,R,0,0,0,0,1,0,P,I,0,1)}else i==="matrix3d"&&Gt.set.apply(Gt,(0,j.ev)([mo],(0,j.CR)(s.map(function(N){return N.value})),!1));Gt.mul(n,n,mo)}),t.setLocalTransform(n)}else t.resetLocalTransform();return t.getLocalTransform()}var Cs=function(){function e(){this.parser=Em,this.parserUnmemoize=Sv,this.parserWithCSSDisabled=Sv,this.mixer=Yi}return e.prototype.calculator=function(t,n,r,i){return r instanceof pl?[]:r},e.prototype.postProcessor=function(t){var n=t.parsedStyle.transform;aa(n,t)},e}(),Ac=function(){function e(){this.parser=pi,this.parserUnmemoize=Fi}return e.prototype.postProcessor=function(t){var n=t.parsedStyle.transformOrigin;n[0].unit===Zr.kPixels&&n[1].unit===Zr.kPixels?t.setOrigin(n[0].value,n[1].value):t.getGeometryBounds()},e}(),Au=function(){function e(){this.parser=td,this.parserUnmemoize=Od}return e.prototype.calculator=function(t,n,r,i){return r.value},e.prototype.postProcessor=function(t){if(t.parentNode){var n=t.parentNode,r=n.renderable,i=n.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=wf.Z_INDEX_CHANGED)}},e}(),Sm=function(){function e(){}return e.prototype.update=function(t,n){var r=t.cx,i=r===void 0?0:r,s=t.cy,l=s===void 0?0:s,u=t.r,h=u===void 0?0:u;return{cx:i,cy:l,hwidth:h,hheight:h}},e}(),cf=function(){function e(){}return e.prototype.update=function(t,n){var r=t.cx,i=r===void 0?0:r,s=t.cy,l=s===void 0?0:s,u=t.rx,h=u===void 0?0:u,p=t.ry,m=p===void 0?0:p;return{cx:i,cy:l,hwidth:h,hheight:m}},e}(),cg=function(){function e(){}return e.prototype.update=function(t){var n=t.x1,r=t.y1,i=t.x2,s=t.y2,l=Math.min(n,i),u=Math.max(n,i),h=Math.min(r,s),p=Math.max(r,s),m=u-l,y=p-h,b=m/2,w=y/2;return{cx:l+b,cy:h+w,hwidth:b,hheight:w}},e}(),Pd=function(){function e(){}return e.prototype.update=function(t){var n=t.d,r=n.rect,i=r.x,s=r.y,l=r.width,u=r.height,h=l/2,p=u/2;return{cx:i+h,cy:s+p,hwidth:h,hheight:p}},e}(),ip=function(){function e(){}return e.prototype.update=function(t){if(t.points&&_s(t.points.points)){var n=t.points.points,r=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(n.map(function(y){return y[0]})),!1)),i=Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(n.map(function(y){return y[0]})),!1)),s=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(n.map(function(y){return y[1]})),!1)),l=Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(n.map(function(y){return y[1]})),!1)),u=i-r,h=l-s,p=u/2,m=h/2;return{cx:r+p,cy:s+m,hwidth:p,hheight:m}}return{cx:0,cy:0,hwidth:0,hheight:0}},e}(),M1=function(){function e(){}return e.prototype.update=function(t,n){var r=t.x,i=r===void 0?0:r,s=t.y,l=s===void 0?0:s,u=t.src,h=t.width,p=h===void 0?0:h,m=t.height,y=m===void 0?0:m,b=p,w=y;return u&&!Xo(u)&&(b||(b=u.width,t.width=b),w||(w=u.height,t.height=w)),{cx:i+b/2,cy:l+w/2,hwidth:b/2,hheight:w/2}},e}(),P1=function(){function e(t){this.globalRuntime=t}return e.prototype.isReadyToMeasure=function(t,n){var r=t.text,i=t.textAlign,s=t.textBaseline,l=t.fontSize,u=t.fontStyle,h=t.fontWeight,p=t.fontVariant,m=t.lineWidth;return M.enableCSSParsing?r&&l&&u&&h&&p&&i&&s&&!(0,Xr.Z)(m):r},e.prototype.update=function(t,n){var r,i,s=t.text,l=t.textAlign,u=l===void 0?"start":l,h=t.lineWidth,p=h===void 0?1:h,m=t.textBaseline,y=m===void 0?"alphabetic":m,b=t.dx,w=b===void 0?0:b,R=t.dy,P=R===void 0?0:R,I=t.x,N=I===void 0?0:I,z=t.y,Z=z===void 0?0:z;if(!this.isReadyToMeasure(t,n))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var Y=(((i=(r=n==null?void 0:n.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,$=this.globalRuntime.textService.measureText(s,t,Y);t.metrics=$;var J=$.width,ae=$.height,pe=$.lineHeight,Oe=$.fontProperties,Ve=J/2,Ke=ae/2,lt=N+Ve;u==="center"||u==="middle"?lt+=p/2-Ve:(u==="right"||u==="end")&&(lt+=p-Ve*2);var Ge=Z-Ke;return y==="middle"?Ge+=Ke:y==="top"||y==="hanging"?Ge+=Ke*2:y==="alphabetic"?Ge+=this.globalRuntime.enableCSSParsing?pe-Oe.ascent:0:(y==="bottom"||y==="ideographic")&&(Ge+=0),w&&(lt+=w),P&&(Ge+=P),{cx:lt,cy:Ge,hwidth:Ve,hheight:Ke}},e}(),xb=function(){function e(){}return e.prototype.update=function(t,n){return{cx:0,cy:0,hwidth:0,hheight:0}},e}();function xy(e){return!!e.type}var Lp=function(){function e(t){this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new gr,this.page=new gr,this.canvas=new gr,this.viewport=new gr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),e.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(e.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},e.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.initEvent=function(){},e.prototype.initUIEvent=function(){},e.prototype.clone=function(){throw new Error(Fr)},e}(),Ey=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.client=new gr,n.movement=new gr,n.offset=new gr,n.global=new gr,n.screen=new gr,n}return Object.defineProperty(t.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),t.prototype.getModifierState=function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)},t.prototype.initMouseEvent=function(){throw new Error(Fr)},t}(Lp),Z0=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.width=0,n.height=0,n.isPrimary=!1,n}return t.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},t.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},t.prototype.clone=function(){return this.manager.clonePointerEvent(this)},t}(Ey),Sy=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},t}(Ey),Va=function(e){(0,j.ZT)(t,e);function t(n,r){var i=e.call(this,null)||this;return i.type=n,i.detail=r,Object.assign(i,r),i}return t}(Lp),cl=":",ug=function(){function e(){this.emitter=new fn}return e.prototype.on=function(t,n,r){return this.addEventListener(t,n,r),this},e.prototype.addEventListener=function(t,n,r){var i=Do(r)&&r||ha(r)&&r.capture,s=ha(r)&&r.once,l=Sf(n)?void 0:n,u=!1,h="";if(t.indexOf(cl)>-1){var p=(0,j.CR)(t.split(cl),2),m=p[0],y=p[1];t=y,h=m,u=!0}if(t=i?"".concat(t,"capture"):t,n=Sf(n)?n:n.handleEvent,u){var b=n;n=function(){for(var w,R=[],P=0;P<arguments.length;P++)R[P]=arguments[P];((w=R[0].target)===null||w===void 0?void 0:w.name)===h&&b.apply(void 0,(0,j.ev)([],(0,j.CR)(R),!1))}}return s?this.emitter.once(t,n,l):this.emitter.on(t,n,l),this},e.prototype.off=function(t,n,r){return t?this.removeEventListener(t,n,r):this.removeAllEventListeners(),this},e.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},e.prototype.removeEventListener=function(t,n,r){var i=Do(r)&&r||ha(r)&&r.capture,s=Sf(n)?void 0:n;return t=i?"".concat(t,"capture"):t,n=Sf(n)?n:n==null?void 0:n.handleEvent,this.emitter.off(t,n,s),this},e.prototype.emit=function(t,n){this.dispatchEvent(new Va(t,n))},e.prototype.dispatchEvent=function(t,n){var r,i;if(n===void 0&&(n=!1),!xy(t))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var s;if(this.document?s=this:this.defaultView?s=this.defaultView:s=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,s){if(t.manager=s.getEventService()||null,!t.manager)return!1;t.defaultPrevented=!1,t.path=[],n||(t.target=this),(i=t.manager)===null||i===void 0||i.dispatchEvent(t,t.type,n)}return!t.defaultPrevented},e}(),ju=function(e){(0,j.ZT)(t,e);function t(){var n=e.call(this)||this;return n.shadow=!1,n.ownerDocument=null,n.isConnected=!1,n.baseURI="",n.childNodes=[],n.nodeType=0,n.nodeName="",n.nodeValue=null,n.parentNode=null,n}return t.isNode=function(n){return!!n.childNodes},Object.defineProperty(t.prototype,"textContent",{get:function(){var n,r,i="";this.nodeName===Yr.TEXT&&(i+=this.style.text);try{for(var s=(0,j.XA)(this.childNodes),l=s.next();!l.done;l=s.next()){var u=l.value;u.nodeName===Yr.TEXT?i+=u.nodeValue:i+=u.textContent}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},set:function(n){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===Yr.TEXT&&(this.style.text="".concat(n))},enumerable:!1,configurable:!0}),t.prototype.getRootNode=function(n){return n===void 0&&(n={}),this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this},t.prototype.hasChildNodes=function(){return this.childNodes.length>0},t.prototype.isDefaultNamespace=function(n){throw new Error(Fr)},t.prototype.lookupNamespaceURI=function(n){throw new Error(Fr)},t.prototype.lookupPrefix=function(n){throw new Error(Fr)},t.prototype.normalize=function(){throw new Error(Fr)},t.prototype.isEqualNode=function(n){return this===n},t.prototype.isSameNode=function(n){return this.isEqualNode(n)},Object.defineProperty(t.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),t.prototype.compareDocumentPosition=function(n){var r;if(n===this)return 0;for(var i=n,s=this,l=[i],u=[s];(r=i.parentNode)!==null&&r!==void 0?r:s.parentNode;)i=i.parentNode?(l.push(i.parentNode),i.parentNode):i,s=s.parentNode?(u.push(s.parentNode),s.parentNode):s;if(i!==s)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var h=l.length>u.length?l:u,p=h===l?u:l;if(h[h.length-p.length]===p[0])return h===l?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var m=h.length-p.length,y=p.length-1;y>=0;y--){var b=p[y],w=h[m+y];if(w!==b){var R=b.parentNode.childNodes;return R.indexOf(b)<R.indexOf(w)?p===l?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING:h===l?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING}}return t.DOCUMENT_POSITION_FOLLOWING},t.prototype.contain=function(n){return this.contains(n)},t.prototype.contains=function(n){for(var r=n;r&&this!==r;)r=r.parentNode;return!!r},t.prototype.getAncestor=function(n){for(var r=this;n>0&&r;)r=r.parentNode,n--;return r},t.prototype.forEach=function(n,r){r===void 0&&(r=!1),n(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(n)})},t.DOCUMENT_POSITION_DISCONNECTED=1,t.DOCUMENT_POSITION_PRECEDING=2,t.DOCUMENT_POSITION_FOLLOWING=4,t.DOCUMENT_POSITION_CONTAINS=8,t.DOCUMENT_POSITION_CONTAINED_BY=16,t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,t}(ug),fg=2048,Tm=function(){function e(t,n){var r=this;this.globalRuntime=t,this.context=n,this.emitter=new fn,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Gt.create(),this.tmpVec3=mt.Ue(),this.onPointerDown=function(i){var s=r.createPointerEvent(i);if(r.dispatchEvent(s,"pointerdown"),s.pointerType==="touch")r.dispatchEvent(s,"touchstart");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightdown":"mousedown")}var u=r.trackingData(i.pointerId);u.pressTargetsByButton[i.button]=s.composedPath(),r.freeEvent(s)},this.onPointerUp=function(i){var s,l=Dl.now(),u=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(u,"pointerup"),u.pointerType==="touch")r.dispatchEvent(u,"touchend");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;r.dispatchEvent(u,h?"rightup":"mouseup")}var p=r.trackingData(i.pointerId),m=r.findMountedTarget(p.pressTargetsByButton[i.button]),y=m;if(m&&!u.composedPath().includes(m)){for(var b=m;b&&!u.composedPath().includes(b);){if(u.currentTarget=b,r.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch")r.notifyTarget(u,"touchendoutside");else if(u.pointerType==="mouse"||u.pointerType==="pen"){var h=u.button===2;r.notifyTarget(u,h?"rightupoutside":"mouseupoutside")}ju.isNode(b)&&(b=b.parentNode)}delete p.pressTargetsByButton[i.button],y=b}if(y){var w=r.clonePointerEvent(u,"click");w.target=y,w.path=[],p.clicksByButton[i.button]||(p.clicksByButton[i.button]={clickCount:0,target:w.target,timeStamp:l});var R=r.context.renderingContext.root.ownerDocument.defaultView,P=p.clicksByButton[i.button];P.target===w.target&&l-P.timeStamp<R.dblClickSpeed?++P.clickCount:P.clickCount=1,P.target=w.target,P.timeStamp=l,w.detail=P.clickCount,!((s=u.detail)===null||s===void 0)&&s.preventClick||(!r.context.config.useNativeClickEvent&&(w.pointerType==="mouse"||w.pointerType==="touch")&&r.dispatchEvent(w,"click"),r.dispatchEvent(w,"pointertap")),r.freeEvent(w)}r.freeEvent(u)},this.onPointerMove=function(i){var s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),l=s.pointerType==="mouse"||s.pointerType==="pen",u=r.trackingData(i.pointerId),h=r.findMountedTarget(u.overTargets);if(u.overTargets&&h!==s.target){var p=i.type==="mousemove"?"mouseout":"pointerout",m=r.createPointerEvent(i,p,h||void 0);if(r.dispatchEvent(m,"pointerout"),l&&r.dispatchEvent(m,"mouseout"),!s.composedPath().includes(h)){var y=r.createPointerEvent(i,"pointerleave",h||void 0);for(y.eventPhase=y.AT_TARGET;y.target&&!s.composedPath().includes(y.target);)y.currentTarget=y.target,r.notifyTarget(y),l&&r.notifyTarget(y,"mouseleave"),ju.isNode(y.target)&&(y.target=y.target.parentNode);r.freeEvent(y)}r.freeEvent(m)}if(h!==s.target){var b=i.type==="mousemove"?"mouseover":"pointerover",w=r.clonePointerEvent(s,b);r.dispatchEvent(w,"pointerover"),l&&r.dispatchEvent(w,"mouseover");for(var R=h&&ju.isNode(h)&&h.parentNode;R&&R!==(ju.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&R!==s.target;)R=R.parentNode;var P=!R||R===(ju.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(P){var I=r.clonePointerEvent(s,"pointerenter");for(I.eventPhase=I.AT_TARGET;I.target&&I.target!==h&&I.target!==(ju.isNode(r.rootTarget)&&r.rootTarget.parentNode);)I.currentTarget=I.target,r.notifyTarget(I),l&&r.notifyTarget(I,"mouseenter"),ju.isNode(I.target)&&(I.target=I.target.parentNode);r.freeEvent(I)}r.freeEvent(w)}r.dispatchEvent(s,"pointermove"),s.pointerType==="touch"&&r.dispatchEvent(s,"touchmove"),l&&(r.dispatchEvent(s,"mousemove"),r.cursor=r.getCursor(s.target)),u.overTargets=s.composedPath(),r.freeEvent(s)},this.onPointerOut=function(i){var s=r.trackingData(i.pointerId);if(s.overTargets){var l=i.pointerType==="mouse"||i.pointerType==="pen",u=r.findMountedTarget(s.overTargets),h=r.createPointerEvent(i,"pointerout",u||void 0);r.dispatchEvent(h),l&&r.dispatchEvent(h,"mouseout");var p=r.createPointerEvent(i,"pointerleave",u||void 0);for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==(ju.isNode(r.rootTarget)&&r.rootTarget.parentNode);)p.currentTarget=p.target,r.notifyTarget(p),l&&r.notifyTarget(p,"mouseleave"),ju.isNode(p.target)&&(p.target=p.target.parentNode);s.overTargets=null,r.freeEvent(h),r.freeEvent(p)}r.cursor=null},this.onPointerOver=function(i){var s=r.trackingData(i.pointerId),l=r.createPointerEvent(i),u=l.pointerType==="mouse"||l.pointerType==="pen";r.dispatchEvent(l,"pointerover"),u&&r.dispatchEvent(l,"mouseover"),l.pointerType==="mouse"&&(r.cursor=r.getCursor(l.target));var h=r.clonePointerEvent(l,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==(ju.isNode(r.rootTarget)&&r.rootTarget.parentNode);)h.currentTarget=h.target,r.notifyTarget(h),u&&r.notifyTarget(h,"mouseenter"),ju.isNode(h.target)&&(h.target=h.target.parentNode);s.overTargets=l.composedPath(),r.freeEvent(l),r.freeEvent(h)},this.onPointerUpOutside=function(i){var s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.pressTargetsByButton[i.button]),u=r.createPointerEvent(i);if(l){for(var h=l;h;)u.currentTarget=h,r.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch"||(u.pointerType==="mouse"||u.pointerType==="pen")&&r.notifyTarget(u,u.button===2?"rightupoutside":"mouseupoutside"),ju.isNode(h)&&(h=h.parentNode);delete s.pressTargetsByButton[i.button]}r.freeEvent(u)},this.onWheel=function(i){var s=r.createWheelEvent(i);r.dispatchEvent(s),r.freeEvent(s)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var s=r.createPointerEvent(i);r.dispatchEvent(s),r.freeEvent(s)}},this.onPointerCancel=function(i){var s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(s),r.freeEvent(s)}}return e.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},e.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},e.prototype.getScale=function(){var t=this.context.contextService.getBoundingClientRect(),n=1,r=1,i=this.context.contextService.getDomElement();if(i&&t){var s=i.offsetWidth,l=i.offsetHeight;s&&l&&(n=t.width/s,r=t.height/l)}return{scaleX:n,scaleY:r,bbox:t}},e.prototype.client2Viewport=function(t){var n=this.getScale(),r=n.scaleX,i=n.scaleY,s=n.bbox;return new gr((t.x-((s==null?void 0:s.left)||0))/r,(t.y-((s==null?void 0:s.top)||0))/i)},e.prototype.viewport2Client=function(t){var n=this.getScale(),r=n.scaleX,i=n.scaleY,s=n.bbox;return new gr((t.x+((s==null?void 0:s.left)||0))*r,(t.y+((s==null?void 0:s.top)||0))*i)},e.prototype.viewport2Canvas=function(t){var n=t.x,r=t.y,i=this.rootTarget.defaultView,s=i.getCamera(),l=this.context.config,u=l.width,h=l.height,p=s.getPerspectiveInverse(),m=s.getWorldTransform(),y=Gt.multiply(this.tmpMatrix,m,p),b=mt.t8(this.tmpVec3,n/u*2-1,(1-r/h)*2-1,0);return mt.fF(b,b,y),new gr(b[0],b[1])},e.prototype.canvas2Viewport=function(t){var n=this.rootTarget.defaultView,r=n.getCamera(),i=r.getPerspective(),s=r.getViewTransform(),l=Gt.multiply(this.tmpMatrix,i,s),u=mt.t8(this.tmpVec3,t.x,t.y,0);mt.fF(this.tmpVec3,this.tmpVec3,l);var h=this.context.config,p=h.width,m=h.height;return new gr((u[0]+1)/2*p,(1-(u[1]+1)/2)*m)},e.prototype.setPickHandler=function(t){this.pickHandler=t},e.prototype.addEventMapping=function(t,n){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:n,priority:0}),this.mappingTable[t].sort(function(r,i){return r.priority-i.priority})},e.prototype.mapEvent=function(t){if(this.rootTarget){var n=this.mappingTable[t.type];if(n)for(var r=0,i=n.length;r<i;r++)n[r].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}},e.prototype.dispatchEvent=function(t,n,r){if(!r)t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,n);else{t.eventPhase=t.AT_TARGET;var i=this.rootTarget.defaultView||null;t.currentTarget=i,this.notifyListeners(t,n)}this.emitter.emit(n||t.type,t)},e.prototype.propagate=function(t,n){if(t.target){var r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(t.currentTarget=r[i],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,n),!(t.propagationStopped||t.propagationImmediatelyStopped)){var s=r.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var i=s+1;i<r.length;i++)if(t.currentTarget=r[i],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return}}},e.prototype.propagationPath=function(t){var n=[t],r=this.rootTarget.defaultView||null;if(r&&r===t)return n.unshift(r.document),n;for(var i=0;i<fg&&t!==this.rootTarget;i++)ju.isNode(t)&&t.parentNode&&(n.push(t.parentNode),t=t.parentNode);return r&&n.push(r),n},e.prototype.hitTest=function(t){var n=t.viewportX,r=t.viewportY,i=this.context.config,s=i.width,l=i.height,u=i.disableHitTesting;return n<0||r<0||n>s||r>l?null:!u&&this.pickHandler(t)||this.rootTarget||null},e.prototype.isNativeEventFromCanvas=function(t,n){var r=n==null?void 0:n.target;if(r!=null&&r.shadowRoot&&(r=n.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r)}return n!=null&&n.composedPath?n.composedPath().indexOf(t)>-1:!1},e.prototype.getExistedHTML=function(t){var n,r;if(t.nativeEvent.composedPath)try{for(var i=(0,j.XA)(t.nativeEvent.composedPath()),s=i.next();!s.done;s=i.next()){var l=s.value,u=this.nativeHTMLMap.get(l);if(u)return u}}catch(h){n={error:h}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null},e.prototype.pickTarget=function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})},e.prototype.createPointerEvent=function(t,n,r,i){var s=this.allocateEvent(Z0);this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t;var l=this.getExistedHTML(s),u=this.context.contextService.getDomElement();return s.target=r!=null?r:l||this.isNativeEventFromCanvas(u,s.nativeEvent)&&this.pickTarget(s)||i,typeof n=="string"&&(s.type=n),s},e.prototype.createWheelEvent=function(t){var n=this.allocateEvent(Sy);this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t;var r=this.getExistedHTML(n),i=this.context.contextService.getDomElement();return n.target=r||this.isNativeEventFromCanvas(i,n.nativeEvent)&&this.pickTarget(n),n},e.prototype.trackingData=function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]},e.prototype.cloneWheelEvent=function(t){var n=this.allocateEvent(Sy);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=t.type,n},e.prototype.clonePointerEvent=function(t,n){var r=this.allocateEvent(Z0);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=n!=null?n:r.type,r},e.prototype.copyPointerData=function(t,n){n.pointerId=t.pointerId,n.width=t.width,n.height=t.height,n.isPrimary=t.isPrimary,n.pointerType=t.pointerType,n.pressure=t.pressure,n.tangentialPressure=t.tangentialPressure,n.tiltX=t.tiltX,n.tiltY=t.tiltY,n.twist=t.twist},e.prototype.copyMouseData=function(t,n){n.altKey=t.altKey,n.button=t.button,n.buttons=t.buttons,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.client.copyFrom(t.client),n.movement.copyFrom(t.movement),n.canvas.copyFrom(t.canvas),n.screen.copyFrom(t.screen),n.global.copyFrom(t.global),n.offset.copyFrom(t.offset)},e.prototype.copyWheelData=function(t,n){n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ},e.prototype.copyData=function(t,n){n.isTrusted=t.isTrusted,n.timeStamp=Dl.now(),n.type=t.type,n.detail=t.detail,n.view=t.view,n.page.copyFrom(t.page),n.viewport.copyFrom(t.viewport)},e.prototype.allocateEvent=function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var n=this.eventPool.get(t).pop()||new t(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n},e.prototype.freeEvent=function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=t.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(t)},e.prototype.notifyTarget=function(t,n){n=n!=null?n:t.type;var r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,n)},e.prototype.notifyListeners=function(t,n){var r=t.currentTarget.emitter,i=r._events[n];if(i)if("fn"in i)i.once&&r.removeListener(n,i.fn,void 0,!0),i.fn.call(t.currentTarget||i.context,t);else for(var s=0;s<i.length&&!t.propagationImmediatelyStopped;s++)i[s].once&&r.removeListener(n,i[s].fn,void 0,!0),i[s].fn.call(t.currentTarget||i[s].context,t)},e.prototype.findMountedTarget=function(t){if(!t)return null;for(var n=t[t.length-1],r=t.length-2;r>=0;r--){var i=t[r];if(i===this.rootTarget||ju.isNode(i)&&i.parentNode===n)n=t[r];else break}return n},e.prototype.getCursor=function(t){for(var n=t;n;){var r=Yl(n)&&n.getAttribute("cursor");if(r)return r;n=ju.isNode(n)&&n.parentNode}},e}(),Eb=function(){function e(){}return e.prototype.getOrCreateCanvas=function(t,n){if(this.canvas)return this.canvas;if(t||M.offscreenCanvas)this.canvas=t||M.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,j.pi)({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,j.pi)({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,j.pi)({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas},e.prototype.getOrCreateContext=function(t,n){return this.context?this.context:(this.getOrCreateCanvas(t,n),this.context)},e}(),id;(function(e){e[e.CAMERA_CHANGED=0]="CAMERA_CHANGED",e[e.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",e[e.NONE=2]="NONE"})(id||(id={}));var Dp=function(){function e(t,n){this.globalRuntime=t,this.context=n,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Sr,initAsync:new nn,dirtycheck:new zr,cull:new zr,beginFrame:new Sr,beforeRender:new Sr,render:new Sr,afterRender:new Sr,endFrame:new Sr,destroy:new Sr,pick:new Xn,pickSync:new zr,pointerDown:new Sr,pointerUp:new Sr,pointerMove:new Sr,pointerOut:new Sr,pointerOver:new Sr,pointerWheel:new Sr,pointerCancel:new Sr,click:new Sr}}return e.prototype.init=function(t){var n=this,r=(0,j.pi)((0,j.pi)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){n.inited=!0,t()})},e.prototype.getStats=function(){return this.stats},e.prototype.disableDirtyRectangleRendering=function(){var t=this.context.config.renderer,n=t.getConfig().enableDirtyRectangleRendering;return!n||this.context.renderingContext.renderReasons.has(id.CAMERA_CHANGED)},e.prototype.render=function(t,n,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var l=s.renderReasons.size===1&&s.renderReasons.has(id.CAMERA_CHANGED),u=!t.disableRenderHooks||!(t.disableRenderHooks&&l);u&&this.renderDisplayObject(s.root,t,s),this.hooks.beginFrame.call(n),u&&s.renderListCurrentFrame.forEach(function(h){i.hooks.beforeRender.call(h),i.hooks.render.call(h),i.hooks.afterRender.call(h)}),this.hooks.endFrame.call(n),s.renderListCurrentFrame=[],s.renderReasons.clear(),r()}},e.prototype.renderDisplayObject=function(t,n,r){var i=this,s=n.renderer.getConfig(),l=s.enableDirtyCheck,u=s.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(t);var h=t.renderable,p=l?h.dirty||r.dirtyRectangleRenderingDisabled?t:null:t;if(p){var m=u?this.hooks.cull.call(p,this.context.camera):p;m&&(this.stats.rendered++,r.renderListCurrentFrame.push(m))}t.renderable.dirty=!1,t.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var y=t.sortable;y.dirty&&(this.sort(t,y),y.dirty=!1,y.dirtyChildren=[],y.dirtyReason=void 0),(y.sorted||t.childNodes).forEach(function(b){i.renderDisplayObject(b,n,r)})},e.prototype.sort=function(t,n){n.sorted&&n.dirtyReason!==wf.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(r){var i=t.childNodes.indexOf(r);if(i===-1){var s=n.sorted.indexOf(r);s>=0&&n.sorted.splice(s,1)}else if(n.sorted.length===0)n.sorted.push(r);else{var l=ps(n.sorted,r);n.sorted.splice(l,0,r)}}):n.sorted=t.childNodes.slice().sort($l)},e.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},e.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(id.DISPLAY_OBJECT_CHANGED)},e}(),Id=/\[\s*(.*)=(.*)\s*\]/,I1=function(){function e(){}return e.prototype.selectOne=function(t,n){var r=this;if(t.startsWith("."))return n.find(function(u){return((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.find(function(u){return u.id===r.getIdOrClassname(t)});if(t.startsWith("[")){var i=this.getAttribute(t),s=i.name,l=i.value;return s?n.find(function(u){return n!==u&&(s==="name"?u.name===l:r.attributeToString(u,s)===l)}):null}else return n.find(function(u){return n!==u&&u.nodeName===t})},e.prototype.selectAll=function(t,n){var r=this;if(t.startsWith("."))return n.findAll(function(u){return n!==u&&((u==null?void 0:u.classList)||[]).indexOf(r.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.findAll(function(u){return n!==u&&u.id===r.getIdOrClassname(t)});if(t.startsWith("[")){var i=this.getAttribute(t),s=i.name,l=i.value;return s?n.findAll(function(u){return n!==u&&(s==="name"?u.name===l:r.attributeToString(u,s)===l)}):[]}else return n.findAll(function(u){return n!==u&&u.nodeName===t})},e.prototype.is=function(t,n){if(t.startsWith("."))return n.className===this.getIdOrClassname(t);if(t.startsWith("#"))return n.id===this.getIdOrClassname(t);if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,s=r.value;return i==="name"?n.name===s:this.attributeToString(n,i)===s}else return n.nodeName===t},e.prototype.getIdOrClassname=function(t){return t.substring(1)},e.prototype.getAttribute=function(t){var n=t.match(Id),r="",i="";return n&&n.length>2&&(r=n[1].replace(/"/g,""),i=n[2].replace(/"/g,"")),{name:r,value:i}},e.prototype.attributeToString=function(t,n){if(!t.getAttribute)return"";var r=t.getAttribute(n);return(0,Xr.Z)(r)?"":r.toString?r.toString():""},e}(),ul=function(e){(0,j.ZT)(t,e);function t(n,r,i,s,l,u,h,p){var m=e.call(this,null)||this;return m.relatedNode=r,m.prevValue=i,m.newValue=s,m.attrName=l,m.attrChange=u,m.prevParsedValue=h,m.newParsedValue=p,m.type=n,m}return t.ADDITION=2,t.MODIFICATION=1,t.REMOVAL=3,t}(Lp),No;(function(e){e.REPARENT="reparent",e.DESTROY="destroy",e.ATTR_MODIFIED="DOMAttrModified",e.INSERTED="DOMNodeInserted",e.REMOVED="removed",e.MOUNTED="DOMNodeInsertedIntoDocument",e.UNMOUNTED="DOMNodeRemovedFromDocument",e.BOUNDS_CHANGED="bounds-changed",e.CULLED="culled"})(No||(No={}));function op(e){var t=e.renderable;t&&(t.renderBoundsDirty=!0,t.boundsDirty=!0)}var hg=new ul(No.REPARENT,null,"","","",0,"",""),Hs=function(){function e(t){var n=this;this.runtime=t,this.pendingEvents=[],this.boundsChangedEvent=new Va(No.BOUNDS_CHANGED),this.rotate=function(){var r=Kr();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=mt.al(s,l,u));var p=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)n.rotateLocal(i,s);else{var m=Kr();fr(m,s[0],s[1],s[2]);var y=n.getRotation(i),b=n.getRotation(i.parentNode);Jr(r,b),pn(r,r),Fo(m,r,m),Fo(p.localRotation,m,y),Jo(p.localRotation,p.localRotation),h&&n.dirtifyLocal(i,p)}}}(),this.rotateLocal=function(){var r=Kr();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=mt.al(s,l,u));var p=i.transformable;fr(r,s[0],s[1],s[2]),Gr(p.localRotation,p.localRotation,r),h&&n.dirtifyLocal(i,p)}}(),this.setEulerAngles=function(){var r=Kr();return function(i,s,l,u,h){l===void 0&&(l=0),u===void 0&&(u=0),h===void 0&&(h=!0),typeof s=="number"&&(s=mt.al(s,l,u));var p=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)n.setLocalEulerAngles(i,s);else{fr(p.localRotation,s[0],s[1],s[2]);var m=n.getRotation(i.parentNode);Jr(r,pn(Kr(),m)),Gr(p.localRotation,p.localRotation,r),h&&n.dirtifyLocal(i,p)}}}(),this.translateLocal=function(){return function(r,i,s,l,u){s===void 0&&(s=0),l===void 0&&(l=0),u===void 0&&(u=!0),typeof i=="number"&&(i=mt.al(i,s,l));var h=r.transformable;mt.fS(i,mt.Ue())||(mt.VC(i,i,h.localRotation),mt.IH(h.localPosition,h.localPosition,i),u&&n.dirtifyLocal(r,h))}}(),this.setPosition=function(){var r=Gt.create(),i=mt.Ue();return function(s,l,u){u===void 0&&(u=!0);var h=s.transformable;if(i[0]=l[0],i[1]=l[1],i[2]=l[2]||0,!mt.fS(n.getPosition(s),i)){if(mt.JG(h.position,i),s.parentNode===null||!s.parentNode.transformable)mt.JG(h.localPosition,i);else{var p=s.parentNode.transformable;Gt.copy(r,p.worldTransform),Gt.invert(r,r),mt.fF(h.localPosition,i,r)}u&&n.dirtifyLocal(s,h)}}}(),this.setLocalPosition=function(){var r=mt.Ue();return function(i,s,l){l===void 0&&(l=!0);var u=i.transformable;r[0]=s[0],r[1]=s[1],r[2]=s[2]||0,!mt.fS(u.localPosition,r)&&(mt.JG(u.localPosition,r),l&&n.dirtifyLocal(i,u))}}(),this.translate=function(){var r=mt.Ue(),i=mt.Ue(),s=mt.Ue();return function(l,u,h,p,m){h===void 0&&(h=0),p===void 0&&(p=0),m===void 0&&(m=!0),typeof u=="number"&&(u=mt.t8(i,u,h,p)),!mt.fS(u,r)&&(mt.IH(s,n.getPosition(l),u),n.setPosition(l,s,m))}}(),this.setRotation=function(){var r=Kr();return function(i,s,l,u,h,p){p===void 0&&(p=!0);var m=i.transformable;if(typeof s=="number"&&(s=no(s,l,u,h)),i.parentNode===null||!i.parentNode.transformable)n.setLocalRotation(i,s);else{var y=n.getRotation(i.parentNode);Jr(r,y),pn(r,r),Fo(m.localRotation,r,s),Jo(m.localRotation,m.localRotation),p&&n.dirtifyLocal(i,m)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Gt.create(),i=mt.Ue(),s=no(0,0,0,1);return function(l){var u=l.localSkew[0]!==0||l.localSkew[1]!==0;if(u){if(Gt.fromRotationTranslationScaleOrigin(l.localTransform,l.localRotation,l.localPosition,mt.al(1,1,1),l.origin),l.localSkew[0]!==0||l.localSkew[1]!==0){var h=Gt.identity(r);h[4]=Math.tan(l.localSkew[0]),h[1]=Math.tan(l.localSkew[1]),Gt.multiply(l.localTransform,l.localTransform,h)}var p=Gt.fromRotationTranslationScaleOrigin(r,s,i,l.localScale,l.origin);Gt.multiply(l.localTransform,l.localTransform,p)}else Gt.fromRotationTranslationScaleOrigin(l.localTransform,l.localRotation,l.localPosition,l.localScale,l.origin)}}()}return e.prototype.matches=function(t,n){return this.runtime.sceneGraphSelector.is(t,n)},e.prototype.querySelector=function(t,n){return this.runtime.sceneGraphSelector.selectOne(t,n)},e.prototype.querySelectorAll=function(t,n){return this.runtime.sceneGraphSelector.selectAll(t,n)},e.prototype.attach=function(t,n,r){var i,s=!1;t.parentNode&&(s=t.parentNode!==n,this.detach(t)),t.parentNode=n,(0,Xr.Z)(r)?t.parentNode.childNodes.push(t):t.parentNode.childNodes.splice(r,0,t);var l=n.sortable;(!((i=l==null?void 0:l.sorted)===null||i===void 0)&&i.length||t.parsedStyle.zIndex)&&(l.dirtyChildren.indexOf(t)===-1&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=wf.ADDED);var u=t.transformable;u&&this.dirtifyWorld(t,u),u.frozen&&this.unfreezeParentToRoot(t),s&&t.dispatchEvent(hg)},e.prototype.detach=function(t){var n,r;if(t.parentNode){var i=t.transformable,s=t.parentNode.sortable;(!((n=s==null?void 0:s.sorted)===null||n===void 0)&&n.length||!((r=t.style)===null||r===void 0)&&r.zIndex)&&(s.dirtyChildren.indexOf(t)===-1&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=wf.REMOVED);var l=t.parentNode.childNodes.indexOf(t);l>-1&&t.parentNode.childNodes.splice(l,1),i&&this.dirtifyWorld(t,i),t.parentNode=null}},e.prototype.getOrigin=function(t){return t.getGeometryBounds(),t.transformable.origin},e.prototype.setOrigin=function(t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof n=="number"&&(n=[n,r,i]);var s=t.transformable;if(!(n[0]===s.origin[0]&&n[1]===s.origin[1]&&n[2]===s.origin[2])){var l=s.origin;l[0]=n[0],l[1]=n[1],l[2]=n[2]||0,this.dirtifyLocal(t,s)}},e.prototype.setLocalEulerAngles=function(t,n,r,i,s){r===void 0&&(r=0),i===void 0&&(i=0),s===void 0&&(s=!0),typeof n=="number"&&(n=mt.al(n,r,i));var l=t.transformable;fr(l.localRotation,n[0],n[1],n[2]),s&&this.dirtifyLocal(t,l)},e.prototype.scaleLocal=function(t,n,r){r===void 0&&(r=!0);var i=t.transformable;mt.Jp(i.localScale,i.localScale,mt.al(n[0],n[1],n[2]||1)),r&&this.dirtifyLocal(t,i)},e.prototype.setLocalScale=function(t,n,r){r===void 0&&(r=!0);var i=t.transformable,s=mt.al(n[0],n[1],n[2]||i.localScale[2]);mt.fS(s,i.localScale)||(mt.JG(i.localScale,s),r&&this.dirtifyLocal(t,i))},e.prototype.setLocalRotation=function(t,n,r,i,s,l){l===void 0&&(l=!0),typeof n=="number"&&(n=no(n,r,i,s));var u=t.transformable;Jr(u.localRotation,n),l&&this.dirtifyLocal(t,u)},e.prototype.setLocalSkew=function(t,n,r){typeof n=="number"&&(n=Fn.al(n,r));var i=t.transformable;Fn.JG(i.localSkew,n),this.dirtifyLocal(t,i)},e.prototype.dirtifyLocal=function(t,n){n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtifyWorld(t,n))},e.prototype.dirtifyWorld=function(t,n){n.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,n),this.dirtifyToRoot(t,!0)},e.prototype.triggerPendingEvents=function(){var t=this,n=new Set,r=function(i,s){i.isConnected&&!n.has(i.entity)&&(t.boundsChangedEvent.detail=s,t.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(t.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),n.add(i.entity))};this.pendingEvents.forEach(function(i){var s=(0,j.CR)(i,2),l=s[0],u=s[1];u.affectChildren?l.forEach(function(h){r(h,u)}):r(l,u)}),this.clearPendingEvents(),n.clear()},e.prototype.clearPendingEvents=function(){this.pendingEvents=[]},e.prototype.dirtifyToRoot=function(t,n){n===void 0&&(n=!1);var r=t;for(r.renderable&&(r.renderable.dirty=!0);r;)op(r),r=r.parentNode;n&&t.forEach(function(i){op(i)}),this.informDependentDisplayObjects(t),this.pendingEvents.push([t,{affectChildren:n}])},e.prototype.updateDisplayObjectDependency=function(t,n,r,i){if(n&&n!==r){var s=this.displayObjectDependencyMap.get(n);if(s&&s[t]){var l=s[t].indexOf(i);s[t].splice(l,1)}}if(r){var u=this.displayObjectDependencyMap.get(r);u||(this.displayObjectDependencyMap.set(r,{}),u=this.displayObjectDependencyMap.get(r)),u[t]||(u[t]=[]),u[t].push(i)}},e.prototype.informDependentDisplayObjects=function(t){var n=this,r=this.displayObjectDependencyMap.get(t);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(s){n.dirtifyToRoot(s,!0),s.dispatchEvent(new ul(No.ATTR_MODIFIED,s,n,n,i,ul.MODIFICATION,n,n)),s.isCustomElement&&s.isConnected&&s.attributeChangedCallback&&s.attributeChangedCallback(i,n,n)})})},e.prototype.getPosition=function(t){var n=t.transformable;return Gt.getTranslation(n.position,this.getWorldTransform(t,n))},e.prototype.getRotation=function(t){var n=t.transformable;return Gt.getRotation(n.rotation,this.getWorldTransform(t,n))},e.prototype.getScale=function(t){var n=t.transformable;return Gt.getScaling(n.scaling,this.getWorldTransform(t,n))},e.prototype.getWorldTransform=function(t,n){return n===void 0&&(n=t.transformable),!n.localDirtyFlag&&!n.dirtyFlag||(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,n)),n.worldTransform},e.prototype.getLocalPosition=function(t){return t.transformable.localPosition},e.prototype.getLocalRotation=function(t){return t.transformable.localRotation},e.prototype.getLocalScale=function(t){return t.transformable.localScale},e.prototype.getLocalSkew=function(t){return t.transformable.localSkew},e.prototype.getLocalTransform=function(t){var n=t.transformable;return n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.localTransform},e.prototype.setLocalTransform=function(t,n){var r=Gt.getTranslation(mt.Ue(),n),i=Gt.getRotation(Kr(),n),s=Gt.getScaling(mt.Ue(),n);this.setLocalScale(t,s,!1),this.setLocalPosition(t,r,!1),this.setLocalRotation(t,i,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)},e.prototype.resetLocalTransform=function(t){this.setLocalScale(t,[1,1,1]),this.setLocalPosition(t,[0,0,0]),this.setLocalEulerAngles(t,[0,0,0]),this.setLocalSkew(t,[0,0])},e.prototype.getTransformedGeometryBounds=function(t,n,r){n===void 0&&(n=!1);var i=this.getGeometryBounds(t,n);if(Rn.isEmpty(i))return null;var s=r||new Rn;return s.setFromTransformedAABB(i,this.getWorldTransform(t)),s},e.prototype.getGeometryBounds=function(t,n){n===void 0&&(n=!1);var r=t.geometry;r.dirty&&M.styleValueRegistry.updateGeometry(t);var i=n?r.renderBounds:r.contentBounds||null;return i||new Rn},e.prototype.getBounds=function(t,n){var r=this;n===void 0&&(n=!1);var i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var s=n?i.renderBounds:i.bounds,l=this.getTransformedGeometryBounds(t,n,s),u=t.childNodes;if(u.forEach(function(m){var y=r.getBounds(m,n);y&&(l?l.add(y):(l=s||new Rn,l.update(y.center,y.halfExtents)))}),l||(l=new Rn),n){var h=Kl(t);if(h){var p=h.parsedStyle.clipPath.getBounds(n);l?p&&(l=p.intersection(l)):l.update(p.center,p.halfExtents)}}return n?(i.renderBounds=l,i.renderBoundsDirty=!1):(i.bounds=l,i.boundsDirty=!1),l},e.prototype.getLocalBounds=function(t){if(t.parentNode){var n=Gt.create();t.parentNode.transformable&&(n=Gt.invert(Gt.create(),this.getWorldTransform(t.parentNode)));var r=this.getBounds(t);if(!Rn.isEmpty(r)){var i=new Rn;return i.setFromTransformedAABB(r,n),i}}return this.getBounds(t)},e.prototype.getBoundingClientRect=function(t){var n,r,i,s=this.getGeometryBounds(t);Rn.isEmpty(s)||(i=new Rn,i.setFromTransformedAABB(s,this.getWorldTransform(t)));var l=(r=(n=t.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var u=(0,j.CR)(i.getMin(),2),h=u[0],p=u[1],m=(0,j.CR)(i.getMax(),2),y=m[0],b=m[1];return new Dr(h+((l==null?void 0:l.left)||0),p+((l==null?void 0:l.top)||0),y-h,b-p)}return new Dr((l==null?void 0:l.left)||0,(l==null?void 0:l.top)||0,0,0)},e.prototype.dirtifyWorldInternal=function(t,n){var r=this;if(!n.dirtyFlag){n.dirtyFlag=!0,n.frozen=!1,t.childNodes.forEach(function(s){var l=s.transformable;l.dirtyFlag||r.dirtifyWorldInternal(s,l)});var i=t.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},e.prototype.syncHierarchy=function(t){var n=t.transformable;if(!n.frozen){n.frozen=!0,(n.localDirtyFlag||n.dirtyFlag)&&this.sync(t,n);for(var r=t.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},e.prototype.sync=function(t,n){if(n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.dirtyFlag){var r=t.parentNode,i=r&&r.transformable;r===null||!i?Gt.copy(n.worldTransform,n.localTransform):Gt.multiply(n.worldTransform,i.worldTransform,n.localTransform),n.dirtyFlag=!1}},e.prototype.unfreezeParentToRoot=function(t){for(var n=t.parentNode;n;){var r=n.transformable;r&&(r.frozen=!1),n=n.parentNode}},e}(),Np={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Ld=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,Mh=/[!%),.:;?\]}'""]/,L1=/[$('"]/,D1=/[!),.:;?\]}'""]/,Sb=/[([{'"]/,tu=/[)\]'"?!:;,.]/,f0=/[(['"...]/,Ty=/[!%),.:;?\]}'"]/,c=/[$([{'"#]/,d=new RegExp("".concat(Mh.source,"|").concat(D1.source,"|").concat(tu.source,"|").concat(Ty.source)),g=new RegExp("".concat(L1.source,"|").concat(Sb.source,"|").concat(f0.source,"|").concat(c.source)),A=function(){function e(t){var n=this;this.runtime=t,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return n.isBreakingSpace(i)?!1:!!(r&&(g.exec(i)||d.exec(r)))},this.trimByKinsokuShorui=function(r){var i=(0,j.ev)([],(0,j.CR)(r),!1),s=i[i.length-2];if(!s)return r;var l=s[s.length-1];return i[i.length-2]=s.slice(0,-1),i[i.length-1]=l+i[i.length-1],i}}return e.prototype.measureFont=function(t,n){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});s.font=t;var l=Np.MetricsString+Np.BaselineSymbol,u=Math.ceil(s.measureText(l).width),h=Math.ceil(s.measureText(Np.BaselineSymbol).width),p=Np.HeightMultiplier*h;h=h*Np.BaselineMultiplier|0,i.width=u,i.height=p,s.fillStyle="#f00",s.fillRect(0,0,u,p),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(l,0,h);var m=s.getImageData(0,0,u||1,p||1).data,y=m.length,b=u*4,w=0,R=0,P=!1;for(w=0;w<h;++w){for(var I=0;I<b;I+=4)if(m[R+I]!==255){P=!0;break}if(!P)R+=b;else break}for(r.ascent=h-w,R=y-b,P=!1,w=p;w>h;--w){for(var I=0;I<b;I+=4)if(m[R+I]!==255){P=!0;break}if(!P)R-=b;else break}return r.descent=w-h,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[t]=r,r},e.prototype.measureText=function(t,n,r){var i=n.fontSize,s=i===void 0?16:i,l=n.wordWrap,u=l===void 0?!1:l,h=n.lineHeight,p=n.lineWidth,m=p===void 0?1:p,y=n.textBaseline,b=y===void 0?"alphabetic":y,w=n.textAlign,R=w===void 0?"start":w,P=n.letterSpacing,I=P===void 0?0:P,N=n.textPath;n.textPathSide,n.textPathStartOffset;var z=n.leading,Z=z===void 0?0:z,Y=gi(n),$=this.measureFont(Y,r);$.fontSize===0&&($.fontSize=s,$.ascent=s);var J=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);J.font=Y,n.isOverflowing=!1;var ae=u?this.wordWrap(t,n,r):t,pe=ae.split(/(?:\r\n|\r|\n)/),Oe=new Array(pe.length),Ve=0;if(N){N.getTotalLength();for(var Ke=0;Ke<pe.length;Ke++)var lt=J.measureText(pe[Ke]).width+(pe[Ke].length-1)*I}else{for(var Ke=0;Ke<pe.length;Ke++){var Ge=J.measureText(pe[Ke]).width+(pe[Ke].length-1)*I;Oe[Ke]=Ge,Ve=Math.max(Ve,Ge)}var lt=Ve+m,rt=h||$.fontSize+m,st=Math.max(rt,$.fontSize+m)+(pe.length-1)*(rt+Z);rt+=Z;var ut=0;return b==="middle"?ut=-st/2:b==="bottom"||b==="alphabetic"||b==="ideographic"?ut=-st:(b==="top"||b==="hanging")&&(ut=0),{font:Y,width:lt,height:st,lines:pe,lineWidths:Oe,lineHeight:rt,maxLineWidth:Ve,fontProperties:$,lineMetrics:Oe.map(function(At,zt){var wn=0;return R==="center"||R==="middle"?wn-=At/2:(R==="right"||R==="end")&&(wn-=At),new Dr(wn-m/2,ut+zt*rt,At+m,rt)})}}},e.prototype.setGraphemeOnPath=function(){},e.prototype.wordWrap=function(t,n,r){var i=this,s=n.wordWrapWidth,l=s===void 0?0:s,u=n.letterSpacing,h=u===void 0?0:u,p=n.maxLines,m=p===void 0?1/0:p,y=n.textOverflow,b=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),w=l+h,R="";y==="ellipsis"?R="...":y&&y!=="clip"&&(R=y);for(var P=[],I=0,N=0,z={},Z=function(ut){return i.getFromCache(ut,h,z,b)},Y=Array.from(R).reduce(function(ut,jt){return ut+Z(jt)},0),$=Array.from(t),J=0;J<$.length;J++){var ae=$[J],pe=t[J-1],Oe=t[J+1],Ve=Z(ae);if(this.isNewline(ae)){if(I++,I>=m){n.isOverflowing=!0;break}N=0,P[I]="";continue}if(N>0&&N+Ve>w){if(I+1>=m){if(n.isOverflowing=!0,Y>0&&Y<=w){for(var Ke=P[I].length,lt=0,Ge=Ke,rt=0;rt<Ke;rt++){var st=Z(P[I][rt]);if(lt+st+Y>w){Ge=rt;break}lt+=st}P[I]=(P[I]||"").slice(0,Ge)+R}break}if(I++,N=0,P[I]="",this.isBreakingSpace(ae))continue;this.canBreakInLastChar(ae)||(P=this.trimToBreakable(P),N=this.sumTextWidthByCache(P[I]||"",z)),this.shouldBreakByKinsokuShorui(ae,Oe)&&(P=this.trimByKinsokuShorui(P),N+=Z(pe||""))}N+=Ve,P[I]=(P[I]||"")+ae}return P.join(`
`)},e.prototype.isBreakingSpace=function(t){return typeof t!="string"?!1:Np.BreakingSpaces.indexOf(t.charCodeAt(0))>=0},e.prototype.isNewline=function(t){return typeof t!="string"?!1:Np.Newlines.indexOf(t.charCodeAt(0))>=0},e.prototype.trimToBreakable=function(t){var n=(0,j.ev)([],(0,j.CR)(t),!1),r=n[n.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return n;var s=r.slice(i,i+1),l=this.isBreakingSpace(s),u=i+1,h=i+(l?0:1);return n[n.length-1]+=r.slice(u,r.length),n[n.length-2]=r.slice(0,h),n},e.prototype.canBreakInLastChar=function(t){return!(t&&Ld.test(t))},e.prototype.sumTextWidthByCache=function(t,n){return t.split("").reduce(function(r,i){if(!n[i])throw Error("cannot count the word without cache");return r+n[i]},0)},e.prototype.findBreakableIndex=function(t){for(var n=t.length-1;n>=0;n--)if(!Ld.test(t[n]))return n;return-1},e.prototype.getFromCache=function(t,n,r,i){var s=r[t];if(typeof s!="number"){var l=t.length*n;s=i.measureText(t).width+l,r[t]=s}return s},e}(),M={},B=function(){var e,t=new M1,n=new ip;return e={},e[Yr.CIRCLE]=new Sm,e[Yr.ELLIPSE]=new cf,e[Yr.RECT]=t,e[Yr.IMAGE]=t,e[Yr.GROUP]=new xb,e[Yr.LINE]=new cg,e[Yr.TEXT]=new P1(M),e[Yr.POLYLINE]=n,e[Yr.POLYGON]=n,e[Yr.PATH]=new Pd,e[Yr.HTML]=null,e[Yr.MESH]=null,e}(),V=function(){var e,t=new qi,n=new $i;return e={},e[vo.PERCENTAGE]=null,e[vo.NUMBER]=new Ua,e[vo.ANGLE]=new to,e[vo.DEFINED_PATH]=new si,e[vo.PAINT]=t,e[vo.COLOR]=t,e[vo.FILTER]=new Go,e[vo.LENGTH]=n,e[vo.LENGTH_PERCENTAGE]=n,e[vo.LENGTH_PERCENTAGE_12]=new _i,e[vo.LENGTH_PERCENTAGE_14]=new qr,e[vo.COORDINATE]=new $i,e[vo.OFFSET_DISTANCE]=new oo,e[vo.OPACITY_VALUE]=new Pa,e[vo.PATH]=new da,e[vo.LIST_OF_POINTS]=new oa,e[vo.SHADOW_BLUR]=new gs,e[vo.TEXT]=new jl,e[vo.TEXT_TRANSFORM]=new eu,e[vo.TRANSFORM]=new Cs,e[vo.TRANSFORM_ORIGIN]=new Ac,e[vo.Z_INDEX]=new Au,e[vo.MARKER]=new Zo,e}(),Q=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};M.CameraContribution=Cr,M.AnimationTimeline=null,M.EasingFunction=null,M.offscreenCanvasCreator=new Eb,M.sceneGraphSelector=new I1,M.sceneGraphService=new Hs(M),M.textService=new A(M),M.geometryUpdaterFactory=B,M.CSSPropertySyntaxFactory=V,M.styleValueRegistry=new yi(M),M.layoutRegistry=null,M.globalThis=Q(),M.enableCSSParsing=!1,M.enableDataset=!1,M.enableStyleSyntax=!0,M.enableAttributeDashCased=!1,M.enableSizeAttenuation=!1;var me=0;function Le(){me=0}var We=new ul(No.INSERTED,null,"","","",0,"",""),tt=new ul(No.REMOVED,null,"","","",0,"",""),Et=new Va(No.DESTROY),Nt=function(e){(0,j.ZT)(t,e);function t(){var n=e.call(this)||this;return n.entity=me++,n.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},n.cullable={strategy:s0.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},n.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},n.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},n.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},n.rBushNode={aabb:void 0},n.namespaceURI="g",n.scrollLeft=0,n.scrollTop=0,n.clientTop=0,n.clientLeft=0,n.destroyed=!1,n.style={},n.computedStyle=M.enableCSSParsing?{opacity:Ba,fillOpacity:Ba,strokeOpacity:Ba,fill:Ba,stroke:Ba,transform:Ba,transformOrigin:Ba,visibility:Ba,pointerEvents:Ba,lineWidth:Ba,lineCap:Ba,lineJoin:Ba,increasedLineWidthForHitTesting:Ba,fontSize:Ba,fontFamily:Ba,fontStyle:Ba,fontWeight:Ba,fontVariant:Ba,textAlign:Ba,textBaseline:Ba,textTransform:Ba,zIndex:Ba,filter:Ba,shadowType:Ba}:null,n.parsedStyle={},n.attributes={},n}return Object.defineProperty(t.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(n){return n!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null},enumerable:!1,configurable:!0}),t.prototype.cloneNode=function(n){throw new Error(Fr)},t.prototype.appendChild=function(n,r){var i;if(n.destroyed)throw new Error(Pi);return M.sceneGraphService.attach(n,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(n),this.isMutationObserved&&(We.relatedNode=this,n.dispatchEvent(We)),n},t.prototype.insertBefore=function(n,r){if(!r)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(n):this.appendChild(n,i)}return n},t.prototype.replaceChild=function(n,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(n,i),r},t.prototype.removeChild=function(n){var r;return tt.relatedNode=this,n.dispatchEvent(tt),!((r=n.ownerDocument)===null||r===void 0)&&r.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),M.sceneGraphService.detach(n),n},t.prototype.removeChildren=function(){for(var n=this.childNodes.length-1;n>=0;n--){var r=this.childNodes[n];this.removeChild(r)}},t.prototype.destroyChildren=function(){for(var n=this.childNodes.length-1;n>=0;n--){var r=this.childNodes[n];r.childNodes.length&&r.destroyChildren(),r.destroy()}},t.prototype.matches=function(n){return M.sceneGraphService.matches(n,this)},t.prototype.getElementById=function(n){return M.sceneGraphService.querySelector("#".concat(n),this)},t.prototype.getElementsByName=function(n){return M.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)},t.prototype.getElementsByClassName=function(n){return M.sceneGraphService.querySelectorAll(".".concat(n),this)},t.prototype.getElementsByTagName=function(n){return M.sceneGraphService.querySelectorAll(n,this)},t.prototype.querySelector=function(n){return M.sceneGraphService.querySelector(n,this)},t.prototype.querySelectorAll=function(n){return M.sceneGraphService.querySelectorAll(n,this)},t.prototype.closest=function(n){var r=this;do{if(M.sceneGraphService.matches(n,r))return r;r=r.parentElement}while(r!==null);return null},t.prototype.find=function(n){var r=this,i=null;return this.forEach(function(s){return s!==r&&n(s)?(i=s,!0):!1}),i},t.prototype.findAll=function(n){var r=this,i=[];return this.forEach(function(s){s!==r&&n(s)&&i.push(s)}),i},t.prototype.after=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this);r.forEach(function(l,u){var h;return(h=n.parentNode)===null||h===void 0?void 0:h.appendChild(l,s+u+1)})}},t.prototype.before=function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var s=this.parentNode.childNodes.indexOf(this),l=(0,j.CR)(r),u=l[0],h=l.slice(1);this.parentNode.appendChild(u,s),(n=u).after.apply(n,(0,j.ev)([],(0,j.CR)(h),!1))}},t.prototype.replaceWith=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this.after.apply(this,(0,j.ev)([],(0,j.CR)(n),!1)),this.remove()},t.prototype.append=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(s){return n.appendChild(s)})},t.prototype.prepend=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(s,l){return n.appendChild(s,l)})},t.prototype.replaceChildren=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,(0,j.ev)([],(0,j.CR)(n),!1))},t.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},t.prototype.destroy=function(){this.dispatchEvent(Et),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},t.prototype.getGeometryBounds=function(){return M.sceneGraphService.getGeometryBounds(this)},t.prototype.getRenderBounds=function(){return M.sceneGraphService.getBounds(this,!0)},t.prototype.getBounds=function(){return M.sceneGraphService.getBounds(this)},t.prototype.getLocalBounds=function(){return M.sceneGraphService.getLocalBounds(this)},t.prototype.getBoundingClientRect=function(){return M.sceneGraphService.getBoundingClientRect(this)},t.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},t.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},t.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},t.prototype.getAttribute=function(n){if(Qh(n))return M.enableCSSParsing?null:void 0;var r=this.attributes[n];if(r===void 0){if(M.enableAttributeDashCased){var i=ml(n);r=this.attributes[i]}return M.enableCSSParsing&&(0,Xr.Z)(r)?null:r}else return r},t.prototype.hasAttribute=function(n){return this.getAttributeNames().includes(n)},t.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},t.prototype.removeAttribute=function(n){this.setAttribute(n,null),delete this.attributes[n]},t.prototype.setAttribute=function(n,r,i,s){this.attributes[n]=r},t.prototype.getAttributeNS=function(n,r){throw new Error(Fr)},t.prototype.getAttributeNode=function(n){throw new Error(Fr)},t.prototype.getAttributeNodeNS=function(n,r){throw new Error(Fr)},t.prototype.hasAttributeNS=function(n,r){throw new Error(Fr)},t.prototype.removeAttributeNS=function(n,r){throw new Error(Fr)},t.prototype.removeAttributeNode=function(n){throw new Error(Fr)},t.prototype.setAttributeNS=function(n,r,i){throw new Error(Fr)},t.prototype.setAttributeNode=function(n){throw new Error(Fr)},t.prototype.setAttributeNodeNS=function(n){throw new Error(Fr)},t.prototype.toggleAttribute=function(n,r){throw new Error(Fr)},t}(ju);function tn(e){return!!(e!=null&&e.nodeName)}var _n=M.globalThis.Proxy?M.globalThis.Proxy:function(){},zn=new ul(No.ATTR_MODIFIED,null,null,null,null,ul.MODIFICATION,null,null),Dn={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},cr={fill:oh,stroke:oh,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},_r=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],Ir=(0,j.ev)((0,j.ev)([],(0,j.CR)(_r),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),Br="data-",jr=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=n,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||Yr.GROUP,M.enableCSSParsing?(Object.assign(r.attributes,Dn),Object.assign(r.parsedStyle,cr,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),M.enableDataset&&(r.dataset=new _n({},{get:function(i,s){var l="".concat(Br).concat(Td(s));return i[l]!==void 0?i[l]:r.getAttribute(l)},set:function(i,s,l){return r.setAttribute("".concat(Br).concat(Td(s)),l),!0}})),M.enableStyleSyntax&&(r.style=new _n({setProperty:function(i,s){r.setAttribute(i,s)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,s){return i[s]!==void 0?i[s]:r.getAttribute(s)},set:function(i,s,l){return r.setAttribute(s,l),!0}})),r}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.getAnimations().forEach(function(n){n.cancel()})},t.prototype.cloneNode=function(n,r){var i=(0,j.pi)({},this.attributes);for(var s in i){var l=i[s];tn(l)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(i[s]=l.cloneNode(n)),r&&(i[s]=r(s,l))}var u=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return u.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(h){if(!h.style.isMarker){var p=h.cloneNode(n);u.appendChild(p)}}),u},t.prototype.initAttributes=function(n){n===void 0&&(n={});var r=this.renderable,i={forceUpdateGeometry:!0};M.enableCSSParsing&&(i.usedAttributes=Ir);var s=n;if(M.enableAttributeDashCased){s={};for(var l in n){var u=ml(l);s[u]=n[l]}}M.styleValueRegistry.processProperties(this,s,i),r.dirty=!0},t.prototype.setAttribute=function(n,r,i,s){i===void 0&&(i=!1),s===void 0&&(s=!0),M.enableAttributeDashCased&&(n=ml(n)),!Si(r)&&(i||r!==this.attributes[n])&&(this.internalSetAttribute(n,r,{memoize:s}),e.prototype.setAttribute.call(this,n,r))},t.prototype.internalSetAttribute=function(n,r,i){var s;i===void 0&&(i={});var l=this.renderable,u=this.attributes[n],h=this.parsedStyle[n];M.styleValueRegistry.processProperties(this,(s={},s[n]=r,s),i),l.dirty=!0;var p=this.parsedStyle[n];this.isConnected&&(zn.relatedNode=this,zn.prevValue=u,zn.newValue=r,zn.attrName=n,zn.prevParsedValue=h,zn.newParsedValue=p,this.isMutationObserved?this.dispatchEvent(zn):(zn.target=this,this.ownerDocument.defaultView.dispatchEvent(zn,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(n,u,r,h,p)},t.prototype.getBBox=function(){var n=this.getBounds(),r=(0,j.CR)(n.getMin(),2),i=r[0],s=r[1],l=(0,j.CR)(n.getMax(),2),u=l[0],h=l[1];return new Dr(i,s,u-i,h-s)},t.prototype.setOrigin=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),M.sceneGraphService.setOrigin(this,$c(n,r,i)),this},t.prototype.getOrigin=function(){return M.sceneGraphService.getOrigin(this)},t.prototype.setPosition=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),M.sceneGraphService.setPosition(this,$c(n,r,i)),this},t.prototype.setLocalPosition=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),M.sceneGraphService.setLocalPosition(this,$c(n,r,i)),this},t.prototype.translate=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),M.sceneGraphService.translate(this,$c(n,r,i)),this},t.prototype.translateLocal=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),M.sceneGraphService.translateLocal(this,$c(n,r,i)),this},t.prototype.getPosition=function(){return M.sceneGraphService.getPosition(this)},t.prototype.getLocalPosition=function(){return M.sceneGraphService.getLocalPosition(this)},t.prototype.scale=function(n,r,i){return this.scaleLocal(n,r,i)},t.prototype.scaleLocal=function(n,r,i){return typeof n=="number"&&(r=r||n,i=i||n,n=$c(n,r,i)),M.sceneGraphService.scaleLocal(this,n),this},t.prototype.setLocalScale=function(n,r,i){return typeof n=="number"&&(r=r||n,i=i||n,n=$c(n,r,i)),M.sceneGraphService.setLocalScale(this,n),this},t.prototype.getLocalScale=function(){return M.sceneGraphService.getLocalScale(this)},t.prototype.getScale=function(){return M.sceneGraphService.getScale(this)},t.prototype.getEulerAngles=function(){var n=(0,j.CR)(k(mt.Ue(),M.sceneGraphService.getWorldTransform(this)),3),r=n[2];return Tu(r)},t.prototype.getLocalEulerAngles=function(){var n=(0,j.CR)(k(mt.Ue(),M.sceneGraphService.getLocalRotation(this)),3),r=n[2];return Tu(r)},t.prototype.setEulerAngles=function(n){return M.sceneGraphService.setEulerAngles(this,0,0,n),this},t.prototype.setLocalEulerAngles=function(n){return M.sceneGraphService.setLocalEulerAngles(this,0,0,n),this},t.prototype.rotateLocal=function(n,r,i){return(0,Xr.Z)(r)&&(0,Xr.Z)(i)?M.sceneGraphService.rotateLocal(this,0,0,n):M.sceneGraphService.rotateLocal(this,n,r,i),this},t.prototype.rotate=function(n,r,i){return(0,Xr.Z)(r)&&(0,Xr.Z)(i)?M.sceneGraphService.rotate(this,0,0,n):M.sceneGraphService.rotate(this,n,r,i),this},t.prototype.setRotation=function(n,r,i,s){return M.sceneGraphService.setRotation(this,n,r,i,s),this},t.prototype.setLocalRotation=function(n,r,i,s){return M.sceneGraphService.setLocalRotation(this,n,r,i,s),this},t.prototype.setLocalSkew=function(n,r){return M.sceneGraphService.setLocalSkew(this,n,r),this},t.prototype.getRotation=function(){return M.sceneGraphService.getRotation(this)},t.prototype.getLocalRotation=function(){return M.sceneGraphService.getLocalRotation(this)},t.prototype.getLocalSkew=function(){return M.sceneGraphService.getLocalSkew(this)},t.prototype.getLocalTransform=function(){return M.sceneGraphService.getLocalTransform(this)},t.prototype.getWorldTransform=function(){return M.sceneGraphService.getWorldTransform(this)},t.prototype.setLocalTransform=function(n){return M.sceneGraphService.setLocalTransform(this,n),this},t.prototype.resetLocalTransform=function(){M.sceneGraphService.resetLocalTransform(this)},t.prototype.getAnimations=function(){return this.activeAnimations},t.prototype.animate=function(n,r){var i,s=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return s?s.play(this,n,r):null},t.prototype.isVisible=function(){var n,r;return M.enableCSSParsing?((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(t.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"},enumerable:!1,configurable:!0}),t.prototype.isInteractive=function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"},t.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},t.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})),!1))+1),this},t.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})),!1))-1),this},t.prototype.getConfig=function(){return this.config},t.prototype.attr=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=(0,j.CR)(r,2),l=s[0],u=s[1];return l?ha(l)?(Object.keys(l).forEach(function(h){n.setAttribute(h,l[h])}),this):r.length===2?(this.setAttribute(l,u),this):this.attributes[l]:this.attributes},t.prototype.getMatrix=function(n){var r=n||this.getWorldTransform(),i=(0,j.CR)(Gt.getTranslation(mt.Ue(),r),2),s=i[0],l=i[1],u=(0,j.CR)(Gt.getScaling(mt.Ue(),r),2),h=u[0],p=u[1],m=Gt.getRotation(Kr(),r),y=(0,j.CR)(k(mt.Ue(),m),3),b=y[0],w=y[2];return G(b||w,s,l,h,p)},t.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},t.prototype.setMatrix=function(n){var r=(0,j.CR)(de(n),5),i=r[0],s=r[1],l=r[2],u=r[3],h=r[4];this.setEulerAngles(h).setPosition(i,s).setLocalScale(l,u)},t.prototype.setLocalMatrix=function(n){var r=(0,j.CR)(de(n),5),i=r[0],s=r[1],l=r[2],u=r[3],h=r[4];this.setLocalEulerAngles(h).setLocalPosition(i,s).setLocalScale(l,u)},t.prototype.show=function(){M.enableCSSParsing?this.style.visibility="visible":this.forEach(function(n){n.style.visibility="visible"})},t.prototype.hide=function(){M.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(n){n.style.visibility="hidden"})},t.prototype.getCount=function(){return this.childElementCount},t.prototype.getParent=function(){return this.parentElement},t.prototype.getChildren=function(){return this.children},t.prototype.getFirst=function(){return this.firstElementChild},t.prototype.getLast=function(){return this.lastElementChild},t.prototype.getChildByIndex=function(n){return this.children[n]||null},t.prototype.add=function(n,r){return this.appendChild(n,r)},t.prototype.set=function(n,r){this.config[n]=r},t.prototype.get=function(n){return this.config[n]},t.prototype.moveTo=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(n,r,i),this},t.prototype.move=function(n,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(n,r,i),this},t.prototype.setZIndex=function(n){return this.style.zIndex=n,this},t}(Nt),bi=function(e){(0,j.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,j.pi)({type:Yr.CIRCLE},n))||this}return t}(jr),Zi=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,j._T)(n,["style"]);return r=e.call(this,(0,j.pi)({style:M.enableCSSParsing?(0,j.pi)({},i):(0,j.pi)({},i)},s))||this,r.isCustomElement=!0,r}return t}(jr),Ro=function(e){(0,j.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,j.pi)({type:Yr.ELLIPSE},n))||this}return t}(jr),ki=function(e){(0,j.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,j.pi)({type:Yr.GROUP},n))||this}return t}(jr),zo=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,j._T)(n,["style"]);return r=e.call(this,(0,j.pi)({type:Yr.HTML,style:M.enableCSSParsing?(0,j.pi)({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):(0,j.pi)({},i)},s))||this,r.cullable.enable=!1,r}return t.prototype.getDomElement=function(){return this.parsedStyle.$el},t.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var n=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return Dr.applyTransform(r,Gt.invert(Gt.create(),n))}else{var i=this.parsedStyle,s=i.x,l=i.y,u=i.width,h=i.height;return new Dr(s,l,u,h)}},t.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},t.prototype.getBounds=function(){var n,r,i=this.getBoundingClientRect(),s=(r=(n=this.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),l=new Rn,u=i.left-((s==null?void 0:s.left)||0),h=i.top-((s==null?void 0:s.top)||0);return l.setMinMax([u,h,0],[u+i.width,h+i.height,0]),l},t.prototype.getLocalBounds=function(){if(this.parentNode){var n=Gt.invert(Gt.create(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!Rn.isEmpty(r)){var i=new Rn;return i.setFromTransformedAABB(r,n),i}}return this.getBounds()},t}(jr),ao=function(e){(0,j.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,j.pi)({type:Yr.IMAGE},n))||this}return t}(jr),xa=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,j._T)(n,["style"]);r=e.call(this,(0,j.pi)({type:Yr.LINE,style:(0,j.pi)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},s))||this,r.markerStartAngle=0,r.markerEndAngle=0;var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd;return u&&tn(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),h&&tn(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return t.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&tn(s)&&(this.markerStartAngle=0,s.remove()),l&&tn(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"&&(s&&tn(s)&&(this.markerEndAngle=0,s.remove()),l&&tn(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1)))},t.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.x1,p=r.x2,m=r.y1,y=r.y2,b=n?i:s;if(!(!b||!tn(b))){var w=0,R,P,I,N,z,Z;n?(I=h,N=m,R=p-h,P=y-m,z=l||0,Z=this.markerStartAngle):(I=p,N=y,R=h-p,P=m-y,z=u||0,Z=this.markerEndAngle),w=Math.atan2(P,R),b.setLocalEulerAngles(w*180/Math.PI+Z),b.setLocalPosition(I+Math.cos(w)*z,N+Math.sin(w)*z)}},t.prototype.getPoint=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle,s=i.x1,l=i.y1,u=i.x2,h=i.y2,p=Eu(s,l,u,h,n),m=p.x,y=p.y,b=mt.fF(mt.Ue(),mt.al(m,y,0),r?this.getWorldTransform():this.getLocalTransform());return new gr(b[0],b[1])},t.prototype.getPointAtLength=function(n,r){return r===void 0&&(r=!1),this.getPoint(n/this.getTotalLength(),r)},t.prototype.getTotalLength=function(){var n=this.parsedStyle,r=n.x1,i=n.y1,s=n.x2,l=n.y2;return Ff(r,i,s,l)},t}(jr),Mo=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,j._T)(n,["style"]);r=e.call(this,(0,j.pi)({type:Yr.PATH,style:M.enableCSSParsing?(0,j.pi)({d:"",miterLimit:""},i):(0,j.pi)({},i),initialParsedStyle:M.enableCSSParsing?null:{miterLimit:4,d:(0,j.pi)({},uu)}},s))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd,p=l.markerMid;return u&&tn(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),p&&tn(p)&&r.placeMarkerMid(p),h&&tn(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return t.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&tn(s)&&(this.markerStartAngle=0,s.remove()),l&&tn(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"?(s&&tn(s)&&(this.markerEndAngle=0,s.remove()),l&&tn(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(l)},t.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=n?i:s;if(!(!h||!tn(h))){var p=0,m,y,b,w,R,P;if(n){var I=(0,j.CR)(this.getStartTangent(),2),N=I[0],z=I[1];b=z[0],w=z[1],m=N[0]-z[0],y=N[1]-z[1],R=l||0,P=this.markerStartAngle}else{var Z=(0,j.CR)(this.getEndTangent(),2),N=Z[0],z=Z[1];b=z[0],w=z[1],m=N[0]-z[0],y=N[1]-z[1],R=u||0,P=this.markerEndAngle}p=Math.atan2(y,m),h.setLocalEulerAngles(p*180/Math.PI+P),h.setLocalPosition(b+Math.cos(p)*R,w+Math.sin(p)*R)}},t.prototype.placeMarkerMid=function(n){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(p){p.remove()}),n&&tn(n))for(var i=1;i<r.length-1;i++){var s=(0,j.CR)(r[i].currentPoint,2),l=s[0],u=s[1],h=i===1?n:n.cloneNode(!0);this.markerMidList.push(h),this.appendChild(h),h.setLocalPosition(l,u)}},t.prototype.getTotalLength=function(){return gv(this)},t.prototype.getPointAtLength=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,s=rs(i,n),l=s.x,u=s.y,h=mt.fF(mt.Ue(),mt.al(l,u,0),r?this.getWorldTransform():this.getLocalTransform());return new gr(h[0],h[1])},t.prototype.getPoint=function(n,r){return r===void 0&&(r=!1),this.getPointAtLength(n*gv(this),r)},t.prototype.getStartTangent=function(){var n=this.parsedStyle.d.segments,r=[];if(n.length>1){var i=n[0].currentPoint,s=n[1].currentPoint,l=n[1].startTangent;r=[],l?(r.push([i[0]-l[0],i[1]-l[1]]),r.push([i[0],i[1]])):(r.push([s[0],s[1]]),r.push([i[0],i[1]]))}return r},t.prototype.getEndTangent=function(){var n=this.parsedStyle.d.segments,r=n.length,i=[];if(r>1){var s=n[r-2].currentPoint,l=n[r-1].currentPoint,u=n[r-1].endTangent;i=[],u?(i.push([l[0]-u[0],l[1]-u[1]]),i.push([l[0],l[1]])):(i.push([s[0],s[1]]),i.push([l[0],l[1]]))}return i},t}(jr),_o=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=this,i=n.style,s=(0,j._T)(n,["style"]);r=e.call(this,(0,j.pi)({type:Yr.POLYGON,style:M.enableCSSParsing?(0,j.pi)({points:"",miterLimit:"",isClosed:!0},i):(0,j.pi)({},i),initialParsedStyle:M.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},s))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var l=r.parsedStyle,u=l.markerStart,h=l.markerEnd,p=l.markerMid;return u&&tn(u)&&(r.markerStartAngle=u.getLocalEulerAngles(),r.appendChild(u)),p&&tn(p)&&r.placeMarkerMid(p),h&&tn(h)&&(r.markerEndAngle=h.getLocalEulerAngles(),r.appendChild(h)),r.transformMarker(!0),r.transformMarker(!1),r}return t.prototype.attributeChangedCallback=function(n,r,i,s,l){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&tn(s)&&(this.markerStartAngle=0,s.remove()),l&&tn(l)&&(this.markerStartAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!0))):n==="markerEnd"?(s&&tn(s)&&(this.markerEndAngle=0,s.remove()),l&&tn(l)&&(this.markerEndAngle=l.getLocalEulerAngles(),this.appendChild(l),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(l)},t.prototype.transformMarker=function(n){var r=this.parsedStyle,i=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.points,p=(h||{}).points,m=n?i:s;if(!(!m||!tn(m)||!p)){var y=0,b,w,R,P,I,N;if(R=p[0][0],P=p[0][1],n)b=p[1][0]-p[0][0],w=p[1][1]-p[0][1],I=l||0,N=this.markerStartAngle;else{var z=p.length;this.parsedStyle.isClosed?(b=p[z-1][0]-p[0][0],w=p[z-1][1]-p[0][1]):(R=p[z-1][0],P=p[z-1][1],b=p[z-2][0]-p[z-1][0],w=p[z-2][1]-p[z-1][1]),I=u||0,N=this.markerEndAngle}y=Math.atan2(w,b),m.setLocalEulerAngles(y*180/Math.PI+N),m.setLocalPosition(R+Math.cos(y)*I,P+Math.sin(y)*I)}},t.prototype.placeMarkerMid=function(n){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(p){p.remove()}),this.markerMidList=[],n&&tn(n)&&i)for(var s=1;s<(this.parsedStyle.isClosed?i.length:i.length-1);s++){var l=i[s][0],u=i[s][1],h=s===1?n:n.cloneNode(!0);this.markerMidList.push(h),this.appendChild(h),h.setLocalPosition(l,u)}},t}(jr),Za=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=(0,j._T)(n,["style"]);return e.call(this,(0,j.pi)({type:Yr.POLYLINE,style:M.enableCSSParsing?(0,j.pi)({points:"",miterLimit:"",isClosed:!1},r):(0,j.pi)({},r),initialParsedStyle:M.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return t.prototype.getTotalLength=function(){return _y(this)},t.prototype.getPointAtLength=function(n,r){return r===void 0&&(r=!1),this.getPoint(n/this.getTotalLength(),r)},t.prototype.getPoint=function(n,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],l=0,u,h,p=this.getTotalLength();i.forEach(function(I,N){i[N+1]&&(u=[0,0],u[0]=l/p,h=Ff(I[0],I[1],i[N+1][0],i[N+1][1]),l+=h,u[1]=l/p,s.push(u))}),this.parsedStyle.points.segments=s}var m=0,y=0;this.parsedStyle.points.segments.forEach(function(I,N){n>=I[0]&&n<=I[1]&&(m=(n-I[0])/(I[1]-I[0]),y=N)});var b=Eu(i[y][0],i[y][1],i[y+1][0],i[y+1][1],m),w=b.x,R=b.y,P=mt.fF(mt.Ue(),mt.al(w,R,0),r?this.getWorldTransform():this.getLocalTransform());return new gr(P[0],P[1])},t.prototype.getStartTangent=function(){var n=this.parsedStyle.points.points,r=[];return r.push([n[1][0],n[1][1]]),r.push([n[0][0],n[0][1]]),r},t.prototype.getEndTangent=function(){var n=this.parsedStyle.points.points,r=n.length-1,i=[];return i.push([n[r-1][0],n[r-1][1]]),i.push([n[r][0],n[r][1]]),i},t}(_o),pa=function(e){(0,j.ZT)(t,e);function t(n){return n===void 0&&(n={}),e.call(this,(0,j.pi)({type:Yr.RECT},n))||this}return t}(jr),Oa=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=(0,j._T)(n,["style"]);return e.call(this,(0,j.pi)({type:Yr.TEXT,style:M.enableCSSParsing?(0,j.pi)({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):(0,j.pi)({fill:"black"},r)},i))||this}return t.prototype.getComputedTextLength=function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0},t.prototype.getLineBoundingRects=function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]},t.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},t}(jr),$o=function(){function e(){this.registry={},this.define(Yr.CIRCLE,bi),this.define(Yr.ELLIPSE,Ro),this.define(Yr.RECT,pa),this.define(Yr.IMAGE,ao),this.define(Yr.LINE,xa),this.define(Yr.GROUP,ki),this.define(Yr.PATH,Mo),this.define(Yr.POLYGON,_o),this.define(Yr.POLYLINE,Za),this.define(Yr.TEXT,Oa),this.define(Yr.HTML,zo)}return e.prototype.define=function(t,n){this.registry[t]=n},e.prototype.get=function(t){return this.registry[t]},e}(),Es={number:function(e){return new os(e)},percent:function(e){return new os(e,"%")},px:function(e){return new os(e,"px")},em:function(e){return new os(e,"em")},rem:function(e){return new os(e,"rem")},deg:function(e){return new os(e,"deg")},grad:function(e){return new os(e,"grad")},rad:function(e){return new os(e,"rad")},turn:function(e){return new os(e,"turn")},s:function(e){return new os(e,"s")},ms:function(e){return new os(e,"ms")},registerProperty:function(e){var t=e.name,n=e.inherits,r=e.interpolable,i=e.initialValue,s=e.syntax;M.styleValueRegistry.registerMetadata({n:t,inh:n,int:r,d:i,syntax:s})},registerLayout:function(e,t){M.layoutRegistry.registerLayout(e,t)}},Tl=function(e){(0,j.ZT)(t,e);function t(){var n=e.call(this)||this;n.defaultView=null,n.ownerDocument=null,n.nodeName="document";try{n.timeline=new M.AnimationTimeline(n)}catch(i){}var r={};return Nr.forEach(function(i){var s=i.n,l=i.inh,u=i.d;l&&u&&(r[s]=Sf(u)?u(Yr.GROUP):u)}),n.documentElement=new ki({id:"g-root",style:r}),n.documentElement.ownerDocument=n,n.documentElement.parentNode=n,n.childNodes=[n.documentElement],n}return Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),t.prototype.createElement=function(n,r){if(n==="svg")return this.documentElement;var i=this.defaultView.customElements.get(n);i||(console.warn("Unsupported tagName: ",n),i=n==="tspan"?Oa:ki);var s=new i(r);return s.ownerDocument=this,s},t.prototype.createElementNS=function(n,r,i){return this.createElement(r,i)},t.prototype.cloneNode=function(n){throw new Error(Fr)},t.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(n){}},t.prototype.elementsFromBBox=function(n,r,i,s){var l=this.defaultView.context.rBushRoot,u=l.search({minX:n,minY:r,maxX:i,maxY:s}),h=[];return u.forEach(function(p){var m=p.displayObject,y=m.parsedStyle.pointerEvents,b=y===void 0?"auto":y,w=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(b);(!w||w&&m.isVisible())&&!m.isCulled()&&m.isInteractive()&&h.push(m)}),h.sort(function(p,m){return m.sortable.renderOrder-p.sortable.renderOrder}),h},t.prototype.elementFromPointSync=function(n,r){var i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height;if(s<0||l<0||s>h||l>p)return null;var m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,w=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]}).picked;return w&&w[0]||this.documentElement},t.prototype.elementFromPoint=function(n,r){return(0,j.mG)(this,void 0,void 0,function(){var i,s,l,u,h,p,m,y,b,w;return(0,j.Jh)(this,function(R){switch(R.label){case 0:return i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height,s<0||l<0||s>h||l>p?[2,null]:(m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]})]);case 1:return w=R.sent().picked,[2,w&&w[0]||this.documentElement]}})})},t.prototype.elementsFromPointSync=function(n,r){var i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height;if(s<0||l<0||s>h||l>p)return[];var m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,w=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]}).picked;return w[w.length-1]!==this.documentElement&&w.push(this.documentElement),w},t.prototype.elementsFromPoint=function(n,r){return(0,j.mG)(this,void 0,void 0,function(){var i,s,l,u,h,p,m,y,b,w;return(0,j.Jh)(this,function(R){switch(R.label){case 0:return i=this.defaultView.canvas2Viewport({x:n,y:r}),s=i.x,l=i.y,u=this.defaultView.getConfig(),h=u.width,p=u.height,s<0||l<0||s>h||l>p?[2,[]]:(m=this.defaultView.viewport2Client({x:s,y:l}),y=m.x,b=m.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:n,y:r,viewportX:s,viewportY:l,clientX:y,clientY:b},picked:[]})]);case 1:return w=R.sent().picked,w[w.length-1]!==this.documentElement&&w.push(this.documentElement),[2,w]}})})},t.prototype.appendChild=function(n,r){throw new Error(Mi)},t.prototype.insertBefore=function(n,r){throw new Error(Mi)},t.prototype.removeChild=function(n,r){throw new Error(Mi)},t.prototype.replaceChild=function(n,r,i){throw new Error(Mi)},t.prototype.append=function(){throw new Error(Mi)},t.prototype.prepend=function(){throw new Error(Mi)},t.prototype.getElementById=function(n){return this.documentElement.getElementById(n)},t.prototype.getElementsByName=function(n){return this.documentElement.getElementsByName(n)},t.prototype.getElementsByTagName=function(n){return this.documentElement.getElementsByTagName(n)},t.prototype.getElementsByClassName=function(n){return this.documentElement.getElementsByClassName(n)},t.prototype.querySelector=function(n){return this.documentElement.querySelector(n)},t.prototype.querySelectorAll=function(n){return this.documentElement.querySelectorAll(n)},t.prototype.find=function(n){return this.documentElement.find(n)},t.prototype.findAll=function(n){return this.documentElement.findAll(n)},t}(ju),Vl=function(){function e(t){this.strategies=t}return e.prototype.apply=function(t){var n=t.camera,r=t.renderingService,i=t.renderingContext,s=this.strategies;r.hooks.cull.tap(e.tag,function(l){if(l){var u=l.cullable;return s.length===0?u.visible=i.unculledEntities.indexOf(l.entity)>-1:u.visible=s.every(function(h){return h.isVisible(n,l)}),!l.isCulled()&&l.isVisible()?l:(l.dispatchEvent(new Va(No.CULLED)),null)}return l}),r.hooks.afterRender.tap(e.tag,function(l){l.cullable.visibilityPlaneMask=-1})},e.tag="Culling",e}(),Hl=function(){function e(){var t=this;this.autoPreventDefault=!1,this.rootPointerEvent=new Z0(null),this.rootWheelEvent=new Sy(null),this.onPointerMove=function(n){var r,i,s,l,u=(l=(s=t.context.renderingContext.root)===null||s===void 0?void 0:s.ownerDocument)===null||l===void 0?void 0:l.defaultView;if(!(u.supportsTouchEvents&&n.pointerType==="touch")){var h=t.normalizeToPointerEvent(n,u);try{for(var p=(0,j.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,b=t.bootstrapEvent(t.rootPointerEvent,y,u,n);t.context.eventService.mapEvent(b)}}catch(w){r={error:w}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}t.setCursor(t.context.eventService.cursor)}},this.onClick=function(n){var r,i,s,l,u=(l=(s=t.context.renderingContext.root)===null||s===void 0?void 0:s.ownerDocument)===null||l===void 0?void 0:l.defaultView,h=t.normalizeToPointerEvent(n,u);try{for(var p=(0,j.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,b=t.bootstrapEvent(t.rootPointerEvent,y,u,n);t.context.eventService.mapEvent(b)}}catch(w){r={error:w}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}t.setCursor(t.context.eventService.cursor)}}return e.prototype.apply=function(t){var n=this;this.context=t;var r=t.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var l=n.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}).picked;return l[0]||null}),r.hooks.pointerWheel.tap(e.tag,function(s){var l=n.normalizeWheelEvent(s);n.context.eventService.mapEvent(l)}),r.hooks.pointerDown.tap(e.tag,function(s){var l,u;if(!(i.supportsTouchEvents&&s.pointerType==="touch")){var h=n.normalizeToPointerEvent(s,i);if(n.autoPreventDefault&&h[0].isNormalized){var p=s.cancelable||!("cancelable"in s);p&&s.preventDefault()}try{for(var m=(0,j.XA)(h),y=m.next();!y.done;y=m.next()){var b=y.value,w=n.bootstrapEvent(n.rootPointerEvent,b,i,s);n.context.eventService.mapEvent(w)}}catch(R){l={error:R}}finally{try{y&&!y.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerUp.tap(e.tag,function(s){var l,u;if(!(i.supportsTouchEvents&&s.pointerType==="touch")){var h=n.context.contextService.getDomElement(),p=n.context.eventService.isNativeEventFromCanvas(h,s),m=p?"":"outside",y=n.normalizeToPointerEvent(s,i);try{for(var b=(0,j.XA)(y),w=b.next();!w.done;w=b.next()){var R=w.value,P=n.bootstrapEvent(n.rootPointerEvent,R,i,s);P.type+=m,n.context.eventService.mapEvent(P)}}catch(I){l={error:I}}finally{try{w&&!w.done&&(u=b.return)&&u.call(b)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerMove.tap(e.tag,this.onPointerMove),r.hooks.pointerOver.tap(e.tag,this.onPointerMove),r.hooks.pointerOut.tap(e.tag,this.onPointerMove),r.hooks.click.tap(e.tag,this.onClick),r.hooks.pointerCancel.tap(e.tag,function(s){var l,u,h=n.normalizeToPointerEvent(s,i);try{for(var p=(0,j.XA)(h),m=p.next();!m.done;m=p.next()){var y=m.value,b=n.bootstrapEvent(n.rootPointerEvent,y,i,s);n.context.eventService.mapEvent(b)}}catch(w){l={error:w}}finally{try{m&&!m.done&&(u=p.return)&&u.call(p)}finally{if(l)throw l.error}}n.setCursor(n.context.eventService.cursor)})},e.prototype.bootstrapEvent=function(t,n,r,i){t.view=r,t.originalEvent=null,t.nativeEvent=i,t.pointerId=n.pointerId,t.width=n.width,t.height=n.height,t.isPrimary=n.isPrimary,t.pointerType=n.pointerType,t.pressure=n.pressure,t.tangentialPressure=n.tangentialPressure,t.tiltX=n.tiltX,t.tiltY=n.tiltY,t.twist=n.twist,this.transferMouseData(t,n);var s=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),l=s.x,u=s.y;t.viewport.x=l,t.viewport.y=u;var h=this.context.eventService.viewport2Canvas(t.viewport),p=h.x,m=h.y;return t.canvas.x=p,t.canvas.y=m,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=us[t.type]||t.type),t},e.prototype.normalizeWheelEvent=function(t){var n=this.rootWheelEvent;this.transferMouseData(n,t),n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ;var r=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),i=r.x,s=r.y;n.viewport.x=i,n.viewport.y=s;var l=this.context.eventService.viewport2Canvas(n.viewport),u=l.x,h=l.y;return n.canvas.x=u,n.canvas.y=h,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=t,n.type=t.type,n},e.prototype.transferMouseData=function(t,n){t.isTrusted=n.isTrusted,t.srcElement=n.srcElement,t.timeStamp=Dl.now(),t.type=n.type,t.altKey=n.altKey,t.metaKey=n.metaKey,t.shiftKey=n.shiftKey,t.ctrlKey=n.ctrlKey,t.button=n.button,t.buttons=n.buttons,t.client.x=n.clientX,t.client.y=n.clientY,t.movement.x=n.movementX,t.movement.y=n.movementY,t.page.x=n.pageX,t.page.y=n.pageY,t.screen.x=n.screenX,t.screen.y=n.screenY,t.relatedTarget=null},e.prototype.setCursor=function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")},e.prototype.normalizeToPointerEvent=function(t,n){var r=[];if(n.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var s=t.changedTouches[i];Si(s.button)&&(s.button=0),Si(s.buttons)&&(s.buttons=1),Si(s.isPrimary)&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),Si(s.width)&&(s.width=s.radiusX||1),Si(s.height)&&(s.height=s.radiusY||1),Si(s.tiltX)&&(s.tiltX=0),Si(s.tiltY)&&(s.tiltY=0),Si(s.pointerType)&&(s.pointerType="touch"),Si(s.pointerId)&&(s.pointerId=s.identifier||0),Si(s.pressure)&&(s.pressure=s.force||.5),Si(s.twist)&&(s.twist=0),Si(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=t.type,r.push(s)}else if(n.isMouseEvent(t)){var l=t;Si(l.isPrimary)&&(l.isPrimary=!0),Si(l.width)&&(l.width=1),Si(l.height)&&(l.height=1),Si(l.tiltX)&&(l.tiltX=0),Si(l.tiltY)&&(l.tiltY=0),Si(l.pointerType)&&(l.pointerType="mouse"),Si(l.pointerId)&&(l.pointerId=Ia),Si(l.pressure)&&(l.pressure=.5),Si(l.twist)&&(l.twist=0),Si(l.tangentialPressure)&&(l.tangentialPressure=0),l.isNormalized=!0,r.push(l)}else r.push(t);return r},e.tag="Event",e}(),wl=[Yr.CIRCLE,Yr.ELLIPSE,Yr.IMAGE,Yr.RECT,Yr.LINE,Yr.POLYLINE,Yr.POLYGON,Yr.TEXT,Yr.PATH,Yr.HTML],ql=function(){function e(){}return e.prototype.isVisible=function(t,n){var r,i,s=n.cullable;if(!s.enable)return!0;var l=n.getRenderBounds();if(Rn.isEmpty(l))return!1;var u=t.getFrustum(),h=(i=(r=n.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return s.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,l,h||hr.INDETERMINATE,u.planes),s.visible=s.visibilityPlaneMask!==hr.OUTSIDE,s.visible},e.prototype.computeVisibilityWithPlaneMask=function(t,n,r,i){if(r===hr.OUTSIDE||r===hr.INSIDE)return r;for(var s=hr.INSIDE,l=wl.indexOf(t.nodeName)>-1,u=0,h=i.length;u<h;++u){var p=1<<u;if(r&p&&!(l&&(u===4||u===5))){var m=i[u],y=m.normal,b=m.distance;if(mt.AK(y,n.getPositiveFarPoint(i[u]))+b<0)return hr.OUTSIDE;mt.AK(y,n.getNegativeFarPoint(i[u]))+b<0&&(s|=p)}}return s},e}(),jc=function(){function e(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return e.prototype.apply=function(t){var n=this,r,i=t.renderingService,s=t.renderingContext,l=t.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var h=function(w){var R=w.target;R.renderable.dirty=!0,i.dirtify()},p=function(w){var R=w.detail.affectChildren,P=w.target;R&&P.forEach(function(N){n.toSync.add(N)});for(var I=P;I;)I.renderable&&n.toSync.add(I),I=I.parentElement;i.dirtify()},m=function(w){var R=w.target;M.enableSizeAttenuation&&M.styleValueRegistry.updateSizeAttenuation(R,u.getCamera().getZoom()),M.enableCSSParsing&&M.styleValueRegistry.recalc(R),M.sceneGraphService.dirtifyToRoot(R),i.dirtify()},y=function(w){var R=w.target,P=R.rBushNode;P.aabb&&n.rBush.remove(P.aabb),n.toSync.delete(R),M.sceneGraphService.dirtifyToRoot(R),i.dirtify()};i.hooks.init.tap(e.tag,function(){u.addEventListener(No.MOUNTED,m),u.addEventListener(No.UNMOUNTED,y),u.addEventListener(No.ATTR_MODIFIED,h),u.addEventListener(No.BOUNDS_CHANGED,p)}),i.hooks.destroy.tap(e.tag,function(){u.removeEventListener(No.MOUNTED,m),u.removeEventListener(No.UNMOUNTED,y),u.removeEventListener(No.ATTR_MODIFIED,h),u.removeEventListener(No.BOUNDS_CHANGED,p),n.toSync.clear()});var b=(r=M.globalThis.requestIdleCallback)!==null&&r!==void 0?r:bn.bind(M.globalThis);i.hooks.endFrame.tap(e.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,b(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})},e.prototype.syncRTree=function(t){var n=this;if(t===void 0&&(t=!1),!(!t&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var s=i.rBushNode;s&&s.aabb&&n.rBush.remove(s.aabb);var l=i.getRenderBounds();if(l){var u=i.renderable;t&&(u.dirtyRenderBounds||(u.dirtyRenderBounds=new Rn),u.dirtyRenderBounds.update(l.center,l.halfExtents));var h=(0,j.CR)(l.getMin(),2),p=h[0],m=h[1],y=(0,j.CR)(l.getMax(),2),b=y[0],w=y[1];s.aabb||(s.aabb={}),s.aabb.displayObject=i,s.aabb.minX=p,s.aabb.minY=m,s.aabb.maxX=b,s.aabb.maxY=w}s.aabb&&!isNaN(s.aabb.maxX)&&!isNaN(s.aabb.maxX)&&!isNaN(s.aabb.minX)&&!isNaN(s.aabb.minY)&&r.push(s.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},e.tag="Prepare",e}();function nu(e){return!!e.document}var fl;(function(e){e.READY="ready",e.BEFORE_RENDER="beforerender",e.RERENDER="rerender",e.AFTER_RENDER="afterrender",e.BEFORE_DESTROY="beforedestroy",e.AFTER_DESTROY="afterdestroy",e.RESIZE="resize",e.DIRTY_RECTANGLE="dirtyrectangle",e.RENDERER_CHANGED="rendererchanged"})(fl||(fl={}));var Cc=500,Vu=.1,ac=1e3,Oc=new Va(No.MOUNTED),Ya=new Va(No.UNMOUNTED),$s=new Va(fl.BEFORE_RENDER),Zs=new Va(fl.RERENDER),ms=new Va(fl.AFTER_RENDER),Hu=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this)||this;r.Element=jr,r.inited=!1,r.context={},r.document=new Tl,r.document.defaultView=r,r.customElements=new $o;var i=n.container,s=n.canvas,l=n.offscreenCanvas,u=n.width,h=n.height,p=n.devicePixelRatio,m=n.renderer,y=n.background,b=n.cursor,w=n.document,R=n.requestAnimationFrame,P=n.cancelAnimationFrame,I=n.createImage,N=n.supportsPointerEvents,z=n.supportsTouchEvents,Z=n.supportsCSSTransform,Y=n.supportsMutipleCanvasesInOneContainer,$=n.useNativeClickEvent,J=n.alwaysTriggerPointerEventOnCanvas,ae=n.isTouchEvent,pe=n.isMouseEvent,Oe=n.dblClickSpeed;Y||Js(i,r);var Ve=u,Ke=h,lt=p;return s&&(lt=p||vl&&window.devicePixelRatio||1,lt=lt>=1?Math.ceil(lt):1,Ve=u||Ms(s)||s.width/lt,Ke=h||Yo(s)||s.height/lt),l&&(M.offscreenCanvas=l),r.devicePixelRatio=lt,r.requestAnimationFrame=R!=null?R:bn.bind(M.globalThis),r.cancelAnimationFrame=P!=null?P:Zn.bind(M.globalThis),r.supportsTouchEvents=z!=null?z:"ontouchstart"in M.globalThis,r.supportsPointerEvents=N!=null?N:!!M.globalThis.PointerEvent,r.isTouchEvent=ae!=null?ae:function(Ge){return r.supportsTouchEvents&&Ge instanceof M.globalThis.TouchEvent},r.isMouseEvent=pe!=null?pe:function(Ge){return!M.globalThis.MouseEvent||Ge instanceof M.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(Ge instanceof M.globalThis.PointerEvent))},r.dblClickSpeed=Oe!=null?Oe:200,r.initRenderingContext({container:i,canvas:s,width:Ve,height:Ke,renderer:m,offscreenCanvas:l,devicePixelRatio:lt,cursor:b||"default",background:y||"transparent",createImage:I,document:w,supportsCSSTransform:Z,useNativeClickEvent:$,alwaysTriggerPointerEventOnCanvas:J}),r.initDefaultCamera(Ve,Ke,m.clipSpaceNearZ),r.initRenderer(m,!0),r}return t.prototype.initRenderingContext=function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},t.prototype.initDefaultCamera=function(n,r,i){var s=this,l=new M.CameraContribution;l.clipSpaceNearZ=i,l.setType(vi.EXPLORING,Oo.DEFAULT).setPosition(n/2,r/2,Cc).setFocalPoint(n/2,r/2,0).setOrthographic(n/-2,n/2,r/2,r/-2,Vu,ac),l.canvas=this,l.eventEmitter.on(Ho.UPDATED,function(){s.context.renderingContext.renderReasons.add(id.CAMERA_CHANGED),M.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=l},t.prototype.updateSizeAttenuation=function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){M.styleValueRegistry.updateSizeAttenuation(r,n)})},t.prototype.getConfig=function(){return this.context.config},t.prototype.getRoot=function(){return this.document.documentElement},t.prototype.getCamera=function(){return this.context.camera},t.prototype.getContextService=function(){return this.context.contextService},t.prototype.getEventService=function(){return this.context.eventService},t.prototype.getRenderingService=function(){return this.context.renderingService},t.prototype.getRenderingContext=function(){return this.context.renderingContext},t.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(t.prototype,"ready",{get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){n.resolveReadyPromise=function(){r(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),t.prototype.destroy=function(n,r){if(n===void 0&&(n=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new Va(fl.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var s=this.getRoot();this.unmountChildren(s),n&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),n&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new Va(fl.AFTER_DESTROY))},t.prototype.changeSize=function(n,r){this.resize(n,r)},t.prototype.resize=function(n,r){var i=this.context.config;i.width=n,i.height=r,this.getContextService().resize(n,r);var s=this.context.camera,l=s.getProjectionMode();s.setPosition(n/2,r/2,Cc).setFocalPoint(n/2,r/2,0),l===yo.ORTHOGRAPHIC?s.setOrthographic(n/-2,n/2,r/2,r/-2,s.getNear(),s.getFar()):s.setAspect(n/r),this.dispatchEvent(new Va(fl.RESIZE,{width:n,height:r}))},t.prototype.appendChild=function(n,r){return this.document.documentElement.appendChild(n,r)},t.prototype.insertBefore=function(n,r){return this.document.documentElement.insertBefore(n,r)},t.prototype.removeChild=function(n){return this.document.documentElement.removeChild(n)},t.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},t.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},t.prototype.render=function(n){var r=this;n&&($s.detail=n,ms.detail=n),this.dispatchEvent($s);var i=this.getRenderingService();i.render(this.getConfig(),n,function(){r.dispatchEvent(Zs)}),this.dispatchEvent(ms)},t.prototype.run=function(){var n=this,r=function(i,s){n.render(s),n.frameId=n.requestAnimationFrame(r)};r()},t.prototype.initRenderer=function(n,r){var i=this;if(r===void 0&&(r=!1),!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new wp,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Hl,new jc,new Vl([new ql])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService((0,j.pi)((0,j.pi)({},M),this.context)),this.context.renderingService=new Dp(M,this.context),this.context.eventService=new Tm(M,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,r)})},t.prototype.initRenderingService=function(n,r,i){var s=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){s.inited=!0,r?i?s.requestAnimationFrame(function(){s.dispatchEvent(new Va(fl.READY))}):s.dispatchEvent(new Va(fl.READY)):s.dispatchEvent(new Va(fl.RENDERER_CHANGED)),s.readyPromise&&s.resolveReadyPromise(),r||s.getRoot().forEach(function(l){var u=l.renderable;u&&(u.renderBoundsDirty=!0,u.boundsDirty=!0,u.dirty=!0)}),s.mountChildren(s.getRoot()),n.getConfig().enableAutoRendering&&s.run()})},t.prototype.loadRendererContainerModule=function(n){var r=this,i=n.getPlugins();i.forEach(function(s){s.context=r.context,s.init(M)})},t.prototype.setRenderer=function(n){var r=this.getConfig();if(r.renderer!==n){var i=r.renderer;r.renderer=n,this.destroy(!1,!0),(0,j.ev)([],(0,j.CR)(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(s){s.destroy(M)}),this.initRenderer(n)}},t.prototype.setCursor=function(n){var r=this.getConfig();r.cursor=n,this.getContextService().applyCursorStyle(n)},t.prototype.unmountChildren=function(n){var r=this;n.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(n.isMutationObserved?n.dispatchEvent(Ya):(Ya.target=n,this.dispatchEvent(Ya,!0)),n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1),n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()},t.prototype.mountChildren=function(n){var r=this;this.inited?n.isConnected||(n.ownerDocument=this.document,n.isConnected=!0,n.isMutationObserved?n.dispatchEvent(Oc):(Oc.target=n,this.dispatchEvent(Oc,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName),n.childNodes.forEach(function(i){r.mountChildren(i)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()},t.prototype.client2Viewport=function(n){return this.getEventService().client2Viewport(n)},t.prototype.viewport2Client=function(n){return this.getEventService().viewport2Client(n)},t.prototype.viewport2Canvas=function(n){return this.getEventService().viewport2Canvas(n)},t.prototype.canvas2Viewport=function(n){return this.getEventService().canvas2Viewport(n)},t.prototype.getPointByClient=function(n,r){return this.client2Viewport({x:n,y:r})},t.prototype.getClientByPoint=function(n,r){return this.viewport2Client({x:n,y:r})},t}(ug),du=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.landmarks=[],n}return t.prototype.rotate=function(n,r,i){if(this.relElevation=Yc(r),this.relAzimuth=Yc(n),this.relRoll=Yc(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===vi.EXPLORING){var s=Qr(Kr(),[1,0,0],Ds((this.rotateWorld?1:-1)*this.relElevation)),l=Qr(Kr(),[0,1,0],Ds((this.rotateWorld?1:-1)*this.relAzimuth)),u=Qr(Kr(),[0,0,1],Ds(this.relRoll)),h=Fo(Kr(),l,s);h=Fo(Kr(),h,u);var p=Gt.fromQuat(Gt.create(),h);Gt.translate(this.matrix,this.matrix,[0,0,-this.distance]),Gt.multiply(this.matrix,this.matrix,p),Gt.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===vi.ORBITING||this.type===vi.EXPLORING?this._getPosition():this.type===vi.TRACKING&&this._getFocalPoint(),this._update(),this},t.prototype.pan=function(n,r){var i=$c(n,r,0),s=mt.d9(this.position);return mt.IH(s,s,mt.bA(mt.Ue(),this.right,i[0])),mt.IH(s,s,mt.bA(mt.Ue(),this.up,i[1])),this._setPosition(s),this.triggerUpdate(),this},t.prototype.dolly=function(n){var r=this.forward,i=mt.d9(this.position),s=n*this.dollyingStep,l=this.distance+n*this.dollyingStep;return s=Math.max(Math.min(l,this.maxDistance),this.minDistance)-this.distance,i[0]+=s*r[0],i[1]+=s*r[1],i[2]+=s*r[2],this._setPosition(i),this.type===vi.ORBITING||this.type===vi.EXPLORING?this._getDistance():this.type===vi.TRACKING&&mt.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},t.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},t.prototype.createLandmark=function(n,r){var i,s,l,u;r===void 0&&(r={});var h=r.position,p=h===void 0?this.position:h,m=r.focalPoint,y=m===void 0?this.focalPoint:m,b=r.roll,w=r.zoom,R=new M.CameraContribution;R.setType(this.type,void 0),R.setPosition(p[0],(i=p[1])!==null&&i!==void 0?i:this.position[1],(s=p[2])!==null&&s!==void 0?s:this.position[2]),R.setFocalPoint(y[0],(l=y[1])!==null&&l!==void 0?l:this.focalPoint[1],(u=y[2])!==null&&u!==void 0?u:this.focalPoint[2]),R.setRoll(b!=null?b:this.roll),R.setZoom(w!=null?w:this.zoom);var P={name:n,matrix:Gt.clone(R.getWorldTransform()),right:mt.d9(R.right),up:mt.d9(R.up),forward:mt.d9(R.forward),position:mt.d9(R.getPosition()),focalPoint:mt.d9(R.getFocalPoint()),distanceVector:mt.d9(R.getDistanceVector()),distance:R.getDistance(),dollyingStep:R.getDollyingStep(),azimuth:R.getAzimuth(),elevation:R.getElevation(),roll:R.getRoll(),relAzimuth:R.relAzimuth,relElevation:R.relElevation,relRoll:R.relRoll,zoom:R.getZoom()};return this.landmarks.push(P),P},t.prototype.gotoLandmark=function(n,r){var i=this;r===void 0&&(r={});var s=Xo(n)?this.landmarks.find(function(Ve){return Ve.name===n}):n;if(s){var l=(0,dr.Z)(r)?{duration:r}:r,u=l.easing,h=u===void 0?"linear":u,p=l.duration,m=p===void 0?100:p,y=l.easingFunction,b=y===void 0?void 0:y,w=l.onfinish,R=w===void 0?void 0:w,P=l.onframe,I=P===void 0?void 0:P,N=.01;this.cancelLandmarkAnimation();var z=s.position,Z=s.focalPoint,Y=s.zoom,$=s.roll,J=b||M.EasingFunction(h),ae,pe=function(){i.setFocalPoint(Z),i.setPosition(z),i.setRoll($),i.setZoom(Y),i.computeMatrix(),i.triggerUpdate(),R==null||R()};if(m===0)return pe();var Oe=function(Ve){ae===void 0&&(ae=Ve);var Ke=Ve-ae;if(Ke>=m){pe();return}var lt=J(Ke/m),Ge=mt.Ue(),rt=mt.Ue(),st=1,ut=0;mt.t7(Ge,i.focalPoint,Z,lt),mt.t7(rt,i.position,z,lt),ut=i.roll*(1-lt)+$*lt,st=i.zoom*(1-lt)+Y*lt,i.setFocalPoint(Ge),i.setPosition(rt),i.setRoll(ut),i.setZoom(st);var jt=mt.TK(Ge,Z)+mt.TK(rt,z);if(jt<=N&&Y==null&&$==null)return pe();i.computeMatrix(),i.triggerUpdate(),Ke<m&&(I==null||I(lt),i.landmarkAnimationID=i.canvas.requestAnimationFrame(Oe))};this.canvas.requestAnimationFrame(Oe)}},t}(Cr);M.CameraContribution=du;var il=function(){function e(t,n){this.type=t,this.target=n,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return e.copy=function(t){var n=new e(t.type,t.target);return n.addedNodes=t.addedNodes.slice(),n.removedNodes=t.removedNodes.slice(),n.previousSibling=t.previousSibling,n.nextSibling=t.nextSibling,n.attributeName=t.attributeName,n.attributeNamespace=t.attributeNamespace,n.oldValue=t.oldValue,n},e}(),sc=0,Al=new WeakMap,Ss=function(){function e(t,n,r){this.observer=t,this.target=n,this.options=r,this.transientObservedNodes=[]}return e.prototype.enqueue=function(t){var n=this.observer.records,r=n.length;if(n.length>0){var i=n[r-1],s=Dd(i,t);if(s){n[r-1]=s;return}}else Cm(this.observer);n[r]=t},e.prototype.addListeners=function(){this.addListeners_(this.target)},e.prototype.addListeners_=function(t){var n=this.options;n.attributes&&t.addEventListener(No.ATTR_MODIFIED,this,!0),n.childList&&t.addEventListener(No.INSERTED,this,!0),(n.childList||n.subtree)&&t.addEventListener(No.REMOVED,this,!0)},e.prototype.removeListeners=function(){this.removeListeners_(this.target)},e.prototype.removeListeners_=function(t){var n=this.options;n.attributes&&t.removeEventListener(No.ATTR_MODIFIED,this,!0),n.childList&&t.removeEventListener(No.INSERTED,this,!0),(n.childList||n.subtree)&&t.removeEventListener(No.REMOVED,this,!0)},e.prototype.removeTransientObservers=function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(n){this.removeListeners_(n);for(var r=Al.get(n),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},e.prototype.handleEvent=function(t){t.stopImmediatePropagation();var n,r;switch(t.type){case No.ATTR_MODIFIED:var i=t.attrName,s=t.relatedNode.namespaceURI;r=t.target,n=Ql("attributes",r),n.attributeName=i,n.attributeNamespace=s;var l=t.attrChange===ul.ADDITION?null:t.prevValue;Nd(r,function(b){if(b.attributes&&!(b.attributeFilter&&b.attributeFilter.length&&b.attributeFilter.indexOf(i)===-1&&b.attributeFilter.indexOf(s)===-1))return b.attributeOldValue?ch(l):n});break;case No.REMOVED:case No.INSERTED:r=t.relatedNode;var u=t.target,h=void 0,p=void 0;t.type===No.INSERTED?(h=[u],p=[]):(h=[],p=[u]);var m=u.previousSibling,y=u.nextSibling;n=Ql("childList",r),n.addedNodes=h,n.removedNodes=p,n.previousSibling=m,n.nextSibling=y,Nd(r,function(b){if(b.childList)return n})}Rf()},e}(),Bp=function(){function e(t){this.callback=t,this.nodes=[],this.records=[],this.uid=sc++}return e.prototype.observe=function(t,n){if(!n.childList&&!n.attributes&&!n.characterData||n.attributeOldValue&&!n.attributes||n.attributeFilter&&n.attributeFilter.length&&!n.attributes||n.characterDataOldValue&&!n.characterData)throw new SyntaxError;var r=Al.get(t);r||Al.set(t,r=[]);for(var i,s=0;s<r.length;s++)if(r[s].observer===this){i=r[s],i.removeListeners(),i.options=n;break}i||(i=new Ss(this,t,n),r.push(i),this.nodes.push(t)),i.addListeners()},e.prototype.disconnect=function(){var t=this;this.nodes.forEach(function(n){for(var r=Al.get(n),i=0;i<r.length;i++){var s=r[i];if(s.observer===t){s.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},e.prototype.takeRecords=function(){var t=this.records;return this.records=[],t},e}(),uf,Zu;function Ql(e,t){return uf=new il(e,t)}function ch(e){return Zu||(Zu=il.copy(uf),Zu.oldValue=e,Zu)}function Rf(){uf=Zu=void 0}function ap(e){return e===Zu||e===uf}function Dd(e,t){return e===t?e:Zu&&ap(e)?Zu:null}function wm(e){e.nodes.forEach(function(t){var n=Al.get(t);n&&n.forEach(function(r){r.observer===e&&r.removeTransientObservers()})})}function Nd(e,t){for(var n=e;n;n=n.parentNode){var r=Al.get(n);if(r)for(var i=0;i<r.length;i++){var s=r[i],l=s.options;if(!(n!==e&&!l.subtree)){var u=t(l);u&&s.enqueue(u)}}}}var sp=!1,Am=[];function Cm(e){Am.push(e),sp||(sp=!0,typeof M.globalThis!="undefined"?M.globalThis.setTimeout(h0):h0())}function h0(){sp=!1;var e=Am;Am=[],e.sort(function(n,r){return n.uid-r.uid});var t=!1;e.forEach(function(n){var r=n.takeRecords();wm(n),r.length&&(n.callback(r,n),t=!0)}),t&&h0()}var Om=function(e){(0,j.ZT)(t,e);function t(n,r,i,s){var l=e.call(this,n)||this;return l.currentTime=i,l.timelineTime=s,l.target=r,l.type="finish",l.bubbles=!1,l.currentTarget=r,l.defaultPrevented=!1,l.eventPhase=l.AT_TARGET,l.timeStamp=Date.now(),l.currentTime=i,l.timelineTime=s,l}return t}(Lp),wy=0,od=function(){function e(t,n){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=n,this.id="".concat(wy++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(e.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,r){t.resolveReadyPromise=function(){n(t)},t.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finished",{get:function(){var t=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,r){t.resolveFinishedPromise=function(){n(t)},t.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var n;t=Number(t),!isNaN(t)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},set:function(t){if(t!==null){if(this.updatePromises(),t=Number(t),isNaN(t)||this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=t,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),e.prototype.updatePromises=function(){var t=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==t&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):t==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():t==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise},e.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},e.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},e.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},e.prototype.cancel=function(){var t=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new Om(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(n)})}},e.prototype.reverse=function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),t!==null&&(this.currentTime=t),this.updatePromises()},e.prototype.updatePlaybackRate=function(t){this.playbackRate=t},e.prototype.targetAnimations=function(){var t,n=(t=this.effect)===null||t===void 0?void 0:t.target;return n.getAnimations()},e.prototype.markTarget=function(){var t=this.targetAnimations();t.indexOf(this)===-1&&t.push(this)},e.prototype.unmarkTarget=function(){var t=this.targetAnimations(),n=t.indexOf(this);n!==-1&&t.splice(n,1)},e.prototype.tick=function(t,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(t))},e.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},e.prototype.persist=function(){throw new Error(Fr)},e.prototype.addEventListener=function(t,n,r){throw new Error(Fr)},e.prototype.removeEventListener=function(t,n,r){throw new Error(Fr)},e.prototype.dispatchEvent=function(t){throw new Error(Fr)},e.prototype.commitStyles=function(){throw new Error(Fr)},e.prototype.ensureAlive=function(){var t,n;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(-1)):this._inEffect=!!(!((n=this.effect)===null||n===void 0)&&n.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},e.prototype.tickCurrentTime=function(t,n){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},e.prototype.fireEvents=function(t){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new Om(null,this,this.currentTime,t);setTimeout(function(){n.onfinish&&n.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new Om(null,this,this.currentTime,t);this.onframe(i)}this._finishedFlag=!1}},e}(),Fp=4,W0=.001,d0=1e-7,Rm=10,kp=11,Mm=1/(kp-1),Tv=typeof Float32Array=="function",zp=function(e,t){return 1-3*t+3*e},Pm=function(e,t){return 3*t-6*e},Im=function(e){return 3*e},p0=function(e,t,n){return((zp(t,n)*e+Pm(t,n))*e+Im(t))*e},G0=function(e,t,n){return 3*zp(t,n)*e*e+2*Pm(t,n)*e+Im(t)},Ay=function(e,t,n,r,i){var s,l,u=0;do l=t+(n-t)/2,s=p0(l,r,i)-e,s>0?n=l:t=l;while(Math.abs(s)>d0&&++u<Rm);return l},X0=function(e,t,n,r){for(var i=0;i<Fp;++i){var s=G0(t,n,r);if(s===0)return t;var l=p0(t,n,r)-e;t-=l/s}return t},m0=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return function(u){return u};for(var i=Tv?new Float32Array(kp):new Array(kp),s=0;s<kp;++s)i[s]=p0(s*Mm,e,n);var l=function(u){for(var h=0,p=1,m=kp-1;p!==m&&i[p]<=u;++p)h+=Mm;--p;var y=(u-i[p])/(i[p+1]-i[p]),b=h+y*Mm,w=G0(b,e,n);return w>=W0?X0(u,b,e,n):w===0?b:Ay(u,h,h+Mm,e,n)};return function(u){return u===0||u===1?u:p0(l(u),t,r)}},Lm=function(e){return e=e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())}),e.charAt(0)==="-"?e.substring(1):e},v0=function(e){return Math.pow(e,2)},lp=function(e){return Math.pow(e,3)},g0=function(e){return Math.pow(e,4)},Up=function(e){return Math.pow(e,5)},Dm=function(e){return Math.pow(e,6)},wv=function(e){return 1-Math.cos(e*Math.PI/2)},Nm=function(e){return 1-Math.sqrt(1-e*e)},Av=function(e){return e*e*(3*e-2)},Bm=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)},Cv=function(e,t){t===void 0&&(t=[]);var n=(0,j.CR)(t,2),r=n[0],i=r===void 0?1:r,s=n[1],l=s===void 0?.5:s,u=(0,ya.Z)(Number(i),1,10),h=(0,ya.Z)(Number(l),.1,2);return e===0||e===1?e:-u*Math.pow(2,10*(e-1))*Math.sin((e-1-h/(Math.PI*2)*Math.asin(1/u))*(Math.PI*2)/h)},jp=function(e,t,n){t===void 0&&(t=[]);var r=(0,j.CR)(t,4),i=r[0],s=i===void 0?1:i,l=r[1],u=l===void 0?100:l,h=r[2],p=h===void 0?10:h,m=r[3],y=m===void 0?0:m;s=(0,ya.Z)(s,.1,1e3),u=(0,ya.Z)(u,.1,1e3),p=(0,ya.Z)(p,.1,1e3),y=(0,ya.Z)(y,.1,1e3);var b=Math.sqrt(u/s),w=p/(2*Math.sqrt(u*s)),R=w<1?b*Math.sqrt(1-w*w):0,P=1,I=w<1?(w*b+-y)/R:-y+b,N=n?n*e/1e3:e;return w<1?N=Math.exp(-N*w*b)*(P*Math.cos(R*N)+I*Math.sin(R*N)):N=(P+I*N)*Math.exp(-N*b),e===0||e===1?e:1-N},Zl=function(e,t){t===void 0&&(t=[]);var n=(0,j.CR)(t,2),r=n[0],i=r===void 0?10:r,s=n[1],l=s=="start"?Math.ceil:Math.floor;return l((0,ya.Z)(e,0,1)*i)/i},ad=function(e,t){t===void 0&&(t=[]);var n=(0,j.CR)(t,4),r=n[0],i=n[1],s=n[2],l=n[3];return m0(r,i,s,l)(e)},dg=m0(.42,0,1,1),Cu=function(e){return function(t,n,r){return n===void 0&&(n=[]),1-e(1-t,n,r)}},Hf=function(e){return function(t,n,r){return n===void 0&&(n=[]),t<.5?e(t*2,n,r)/2:1-e(t*-2+2,n,r)/2}},uh=function(e){return function(t,n,r){return n===void 0&&(n=[]),t<.5?(1-e(1-t*2,n,r))/2:(e(t*2-1,n,r)+1)/2}},Ov={steps:Zl,"step-start":function(e){return Zl(e,[1,"start"])},"step-end":function(e){return Zl(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":ad,ease:function(e){return ad(e,[.25,.1,.25,1])},in:dg,out:Cu(dg),"in-out":Hf(dg),"out-in":uh(dg),"in-quad":v0,"out-quad":Cu(v0),"in-out-quad":Hf(v0),"out-in-quad":uh(v0),"in-cubic":lp,"out-cubic":Cu(lp),"in-out-cubic":Hf(lp),"out-in-cubic":uh(lp),"in-quart":g0,"out-quart":Cu(g0),"in-out-quart":Hf(g0),"out-in-quart":uh(g0),"in-quint":Up,"out-quint":Cu(Up),"in-out-quint":Hf(Up),"out-in-quint":uh(Up),"in-expo":Dm,"out-expo":Cu(Dm),"in-out-expo":Hf(Dm),"out-in-expo":uh(Dm),"in-sine":wv,"out-sine":Cu(wv),"in-out-sine":Hf(wv),"out-in-sine":uh(wv),"in-circ":Nm,"out-circ":Cu(Nm),"in-out-circ":Hf(Nm),"out-in-circ":uh(Nm),"in-back":Av,"out-back":Cu(Av),"in-out-back":Hf(Av),"out-in-back":uh(Av),"in-bounce":Bm,"out-bounce":Cu(Bm),"in-out-bounce":Hf(Bm),"out-in-bounce":uh(Bm),"in-elastic":Cv,"out-elastic":Cu(Cv),"in-out-elastic":Hf(Cv),"out-in-elastic":uh(Cv),spring:jp,"spring-in":jp,"spring-out":Cu(jp),"spring-in-out":Hf(jp),"spring-out-in":uh(jp)},ff=function(e){return Lm(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},pg=function(e){return Ov[ff(e)]||Ov.linear},Rv=function(e){return e},Vp=1,mg=.5,vg=0;function Cy(e,t){return function(n){if(n>=1)return 1;var r=1/e;return n+=t*r,n-n%r}}var y0="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",N1=new RegExp("cubic-bezier\\("+y0+","+y0+","+y0+","+y0+"\\)"),B1=/steps\(\s*(\d+)\s*\)/,F1=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function gg(e){var t=N1.exec(e);if(t)return m0.apply(void 0,(0,j.ev)([],(0,j.CR)(t.slice(1).map(Number)),!1));var n=B1.exec(e);if(n)return Cy(Number(n[1]),vg);var r=F1.exec(e);return r?Cy(Number(r[1]),{start:Vp,middle:mg,end:vg}[r[2]]):pg(e)}function Oy(e){return Math.abs(fh(e)/(e.playbackRate||1))}function fh(e){var t;return e.duration===0||e.iterations===0?0:(e.duration==="auto"?0:Number(e.duration))*((t=e.iterations)!==null&&t!==void 0?t:1)}var Mv=0,yg=1,Ph=2,_g=3;function Ry(e,t,n){if(t===null)return Mv;var r=n.endTime;return t<Math.min(n.delay,r)?yg:t>=Math.min(n.delay+e+n.endDelay,r)?Ph:_g}function _0(e,t,n,r,i){switch(r){case yg:return t==="backwards"||t==="both"?0:null;case _g:return n-i;case Ph:return t==="forwards"||t==="both"?e:null;case Mv:return null}}function Vc(e,t,n,r,i){var s=i;return e===0?t!==yg&&(s+=n):s+=r/e,s}function Fm(e,t,n,r,i,s){var l=e===1/0?t%1:e%1;return l===0&&n===Ph&&r!==0&&(i!==0||s===0)&&(l=1),l}function km(e,t,n,r){return e===Ph&&t===1/0?1/0:n===1?Math.floor(r)-1:Math.floor(r)}function Y0(e,t,n){var r=e;if(e!=="normal"&&e!=="reverse"){var i=t;e==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?n:1-n}function $0(e,t,n){var r=Ry(e,t,n),i=_0(e,n.fill,t,r,n.delay);if(i===null)return null;var s=n.duration==="auto"?0:n.duration,l=Vc(s,r,n.iterations,i,n.iterationStart),u=Fm(l,n.iterationStart,r,n.iterations,i,s),h=km(r,n.iterations,u,l),p=Y0(n.direction,h,u);return n.currentIteration=h,n.progress=p,n.easingFunction(p)}function k1(e,t,n){var r=z1(e,t),i=zm(r,n);return function(s,l){if(l!==null)i.filter(function(h){return l>=h.applyFrom&&l<h.applyTo}).forEach(function(h){var p=l-h.startOffset,m=h.endOffset-h.startOffset,y=m===0?0:p/m;s.setAttribute(h.property,h.interpolation(y),!1,!1)});else for(var u in r)bg(u)&&s.setAttribute(u,null)}}function bg(e){return e!=="offset"&&e!=="easing"&&e!=="composite"&&e!=="computedOffset"}function z1(e,t){for(var n={},r=0;r<e.length;r++)for(var i in e[r])if(bg(i)){var s={offset:e[r].offset,computedOffset:e[r].computedOffset,easing:e[r].easing,easingFunction:gg(e[r].easing)||t.easingFunction,value:e[r][i]};n[i]=n[i]||[],n[i].push(s)}return n}function zm(e,t){var n=[];for(var r in e)for(var i=e[r],s=0;s<i.length-1;s++){var l=s,u=s+1,h=i[l].computedOffset,p=i[u].computedOffset,m=h,y=p;s===0&&(m=-1/0,p===0&&(u=l)),s===i.length-2&&(y=1/0,h===1&&(l=u)),n.push({applyFrom:m,applyTo:y,startOffset:i[l].computedOffset,endOffset:i[u].computedOffset,easingFunction:i[l].easingFunction,property:r,interpolation:Ih(r,i[l].value,i[u].value,t)})}return n.sort(function(b,w){return b.startOffset-w.startOffset}),n}var xg=function(e,t,n){return function(r){var i=Eg(e,t,r);return!M.enableCSSParsing&&(0,dr.Z)(i)?i:n(i)}};function Ih(e,t,n,r){var i=Hi[e];if(i&&i.syntax&&i.int){var s=M.styleValueRegistry.getPropertySyntax(i.syntax);if(s){var l=void 0,u=void 0;if(M.enableCSSParsing){var h=M.styleValueRegistry.parseProperty(e,t,r,!1),p=M.styleValueRegistry.parseProperty(e,n,r,!1);l=M.styleValueRegistry.computeProperty(e,h,r,!1),u=M.styleValueRegistry.computeProperty(e,p,r,!1)}else{var m=s.parserWithCSSDisabled;l=m?m(t,r):t,u=m?m(n,r):n}var y=s.mixer(l,u,r);if(y){var b=xg.apply(void 0,(0,j.ev)([],(0,j.CR)(y),!1));return function(w){return w===0?t:w===1?n:b(w)}}}}return xg(!1,!0,function(w){return w?n:t})}function Eg(e,t,n){if(typeof e=="number"&&typeof t=="number")return e*(1-n)+t*n;if(typeof e=="boolean"&&typeof t=="boolean"||typeof e=="string"&&typeof t=="string")return n<.5?e:t;if(Array.isArray(e)&&Array.isArray(t)){for(var r=e.length,i=t.length,s=Math.max(r,i),l=[],u=0;u<s;u++)l.push(Eg(e[u<r?u:r-1],t[u<i?u:i-1],n));return l}throw new Error("Mismatched interpolation arguments "+e+":"+t)}var Sg=function(){function e(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=Rv,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(e.prototype,"easing",{get:function(){return this._easing},set:function(t){this.easingFunction=gg(t),this._easing=t},enumerable:!1,configurable:!0}),e}();function Tg(e){var t=[];for(var n in e)if(!(n in["easing","offset","composite"])){var r=e[n];Array.isArray(r)||(r=[r]);for(var i=r.length,s=0;s<i;s++){if(!t[s]){var l={};"offset"in e&&(l.offset=Number(e.offset)),"easing"in e&&(l.easing=e.easing),"composite"in e&&(l.composite=e.composite),t[s]=l}r[s]!==void 0&&r[s]!==null&&(t[s][n]=r[s])}}return t.sort(function(u,h){return(u.computedOffset||0)-(h.computedOffset||0)}),t}function Cl(e,t){if(e===null)return[];Array.isArray(e)||(e=Tg(e));for(var n=e.map(function(h){var p={};t!=null&&t.composite&&(p.composite="auto");for(var m in h){var y=h[m];if(m==="offset"){if(y!==null){if(y=Number(y),!isFinite(y))throw new Error("Keyframe offsets must be numbers.");if(y<0||y>1)throw new Error("Keyframe offsets must be between 0 and 1.");p.computedOffset=y}}else if(m==="composite"&&["replace","add","accumulate","auto"].indexOf(y)===-1)throw new Error("".concat(y," compositing is not supported"));p[m]=y}return p.offset===void 0&&(p.offset=null),p.easing===void 0&&(p.easing=(t==null?void 0:t.easing)||"linear"),p.composite===void 0&&(p.composite="auto"),p}),r=!0,i=-1/0,s=0;s<n.length;s++){var l=n[s].offset;if((0,Xr.Z)(l))r=!1;else{if(l<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=l}}n=n.filter(function(h){return Number(h.offset)>=0&&Number(h.offset)<=1});function u(){var h,p,m=n.length;n[m-1].computedOffset=Number((h=n[m-1].offset)!==null&&h!==void 0?h:1),m>1&&(n[0].computedOffset=Number((p=n[0].offset)!==null&&p!==void 0?p:0));for(var y=0,b=Number(n[0].computedOffset),w=1;w<m;w++){var R=n[w].computedOffset;if(!(0,Xr.Z)(R)&&!(0,Xr.Z)(b)){for(var P=1;P<w-y;P++)n[y+P].computedOffset=b+(Number(R)-b)*P/(w-y);y=w,b=Number(R)}}}return r||u(),n}var My="backwards|forwards|both|none".split("|"),Py="reverse|alternate|alternate-reverse".split("|");function Tb(e,t){var n=new Sg;return t&&(n.fill="both",n.duration="auto"),typeof e=="number"&&!isNaN(e)?n.duration=e:e!==void 0&&Object.keys(e).forEach(function(r){if(e[r]!==void 0&&e[r]!==null&&e[r]!=="auto"){if((typeof n[r]=="number"||r==="duration")&&(typeof e[r]!="number"||isNaN(e[r]))||r==="fill"&&My.indexOf(e[r])===-1||r==="direction"&&Py.indexOf(e[r])===-1)return;n[r]=e[r]}}),n}function U1(e,t){return e=Iy(e!=null?e:{duration:"auto"}),Tb(e,t)}function Iy(e){return typeof e=="number"&&(isNaN(e)?e={duration:"auto"}:e={duration:e}),e}var Um=function(){function e(t,n,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=U1(r,!1),this.timing.effect=this,this.timing.activeDuration=Oy(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Cl(n,this.timing),this.interpolations=k1(this.normalizedKeyframes,this.timing,this.target);var s=M.globalThis.Proxy;this.computedTiming=s?new s(this.timing,{get:function(l,u){return u==="duration"?l.duration==="auto"?0:l.duration:u==="fill"?l.fill==="auto"?"none":l.fill:u==="localTime"?i.animation&&i.animation.currentTime||null:u==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:l.currentIteration||0:u==="progress"?!i.animation||i.animation.playState!=="running"?null:l.progress||0:l[u]},set:function(){return!0}}):this.timing}return e.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},e.prototype.update=function(t){return t===null?!1:(this.timeFraction=$0(this.timing.activeDuration,t,this.timing),this.timeFraction!==null)},e.prototype.getKeyframes=function(){return this.normalizedKeyframes},e.prototype.setKeyframes=function(t){this.normalizedKeyframes=Cl(t)},e.prototype.getComputedTiming=function(){return this.computedTiming},e.prototype.getTiming=function(){return this.timing},e.prototype.updateTiming=function(t){var n=this;Object.keys(t||{}).forEach(function(r){n.timing[r]=t[r]})},e}();function j1(e,t){return Number(e.id)-Number(t.id)}var Ts=function(){function e(t){var n=this;this.document=t,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){n.currentTime=r,n.discardAnimations(),n.animations.length===0?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=n.rafCallbacks;n.rafCallbacks=[],r<Number(n.currentTime)&&(r=Number(n.currentTime)),n.animations.sort(j1),n.animations=n.tick(r,!0,n.animations)[0],i.forEach(function(s){s[1](r)}),n.applyPendingEffects()}}return e.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},e.prototype.isTicking=function(){return this.inTick},e.prototype.play=function(t,n,r){var i=new Um(t,n,r),s=new od(i,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s},e.prototype.applyDirtiedAnimation=function(t){var n=this;if(!this.inTick){t.markTarget();var r=t.targetAnimations();r.sort(j1);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(s){var l=n.animations.indexOf(s);l!==-1&&n.animations.splice(l,1)}),this.applyPendingEffects()}},e.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},e.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},e.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(t){t==null||t.applyInterpolations()}),this.pendingEffects=[]},e.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})},e.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return t.playState!=="finished"&&t.playState!=="idle"})},e.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},e.prototype.rAF=function(t){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,t]),n},e.prototype.requestAnimationFrame=function(t){var n=this;return this.rAF(function(r){n.updateAnimationsPromises(),t(r),n.updateAnimationsPromises()})},e.prototype.tick=function(t,n,r){var i,s,l=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var u=[],h=[],p=[],m=[];return r.forEach(function(y){y.tick(t,n),y._inEffect?(h.push(y.effect),y.markTarget()):(u.push(y.effect),y.unmarkTarget()),y._needsTick&&(l.ticking=!0);var b=y._inEffect||y._needsTick;y._inTimeline=b,b?p.push(y):m.push(y)}),(i=this.pendingEffects).push.apply(i,(0,j.ev)([],(0,j.CR)(u),!1)),(s=this.pendingEffects).push.apply(s,(0,j.ev)([],(0,j.CR)(h),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[p,m]},e}();M.EasingFunction=gg,M.AnimationTimeline=Ts;function V1(e,t){var n=t.cx,r=n===void 0?0:n,i=t.cy,s=i===void 0?0:i,l=t.r;e.arc(r,s,l,0,Math.PI*2,!1)}function wb(e,t){var n=t.cx,r=n===void 0?0:n,i=t.cy,s=i===void 0?0:i,l=t.rx,u=t.ry;if(e.ellipse)e.ellipse(r,s,l,u,0,0,Math.PI*2,!1);else{var h=l>u?l:u,p=l>u?1:l/u,m=l>u?u/l:1;e.save(),e.scale(p,m),e.arc(r,s,h,0,Math.PI*2)}}function sd(e,t){var n=t.x1,r=t.y1,i=t.x2,s=t.y2,l=t.markerStart,u=t.markerEnd,h=t.markerStartOffset,p=t.markerEndOffset,m=0,y=0,b=0,w=0,R=0,P,I;l&&tn(l)&&h&&(P=i-n,I=s-r,R=Math.atan2(I,P),m=Math.cos(R)*(h||0),y=Math.sin(R)*(h||0)),u&&tn(u)&&p&&(P=n-i,I=r-s,R=Math.atan2(I,P),b=Math.cos(R)*(p||0),w=Math.sin(R)*(p||0)),e.moveTo(n+m,r+y),e.lineTo(i+b,s+w)}function Pv(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,s=t.markerEndOffset,l=t.d,u=l.absolutePath,h=l.segments,p=0,m=0,y=0,b=0,w=0,R,P;if(n&&tn(n)&&i){var I=(0,j.CR)(n.parentNode.getStartTangent(),2),N=I[0],z=I[1];R=N[0]-z[0],P=N[1]-z[1],w=Math.atan2(P,R),p=Math.cos(w)*(i||0),m=Math.sin(w)*(i||0)}if(r&&tn(r)&&s){var Z=(0,j.CR)(r.parentNode.getEndTangent(),2),N=Z[0],z=Z[1];R=N[0]-z[0],P=N[1]-z[1],w=Math.atan2(P,R),y=Math.cos(w)*(s||0),b=Math.sin(w)*(s||0)}for(var Y=0;Y<u.length;Y++){var $=u[Y],J=$[0],ae=u[Y+1],pe=Y===0&&(p!==0||m!==0),Oe=(Y===u.length-1||ae&&(ae[0]==="M"||ae[0]==="Z"))&&y!==0&&b!==0;switch(J){case"M":pe?(e.moveTo($[1]+p,$[2]+m),e.lineTo($[1],$[2])):e.moveTo($[1],$[2]);break;case"L":Oe?e.lineTo($[1]+y,$[2]+b):e.lineTo($[1],$[2]);break;case"Q":e.quadraticCurveTo($[1],$[2],$[3],$[4]),Oe&&e.lineTo($[3]+y,$[4]+b);break;case"C":e.bezierCurveTo($[1],$[2],$[3],$[4],$[5],$[6]),Oe&&e.lineTo($[5]+y,$[6]+b);break;case"A":{var Ve=h[Y].arcParams,Ke=Ve.cx,lt=Ve.cy,Ge=Ve.rx,rt=Ve.ry,st=Ve.startAngle,ut=Ve.endAngle,jt=Ve.xRotation,At=Ve.sweepFlag;if(e.ellipse)e.ellipse(Ke,lt,Ge,rt,jt,st,ut,!!(1-At));else{var zt=Ge>rt?Ge:rt,wn=Ge>rt?1:Ge/rt,Hn=Ge>rt?rt/Ge:1;e.translate(Ke,lt),e.rotate(jt),e.scale(wn,Hn),e.arc(0,0,zt,st,ut,!!(1-At)),e.scale(1/wn,1/Hn),e.rotate(-jt),e.translate(-Ke,-lt)}Oe&&e.lineTo($[6]+y,$[7]+b);break}case"Z":e.closePath();break}}}function wg(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,s=t.markerEndOffset,l=t.points.points,u=l.length,h=l[0][0],p=l[0][1],m=l[u-1][0],y=l[u-1][1],b=0,w=0,R=0,P=0,I=0,N,z;n&&tn(n)&&i&&(N=l[1][0]-l[0][0],z=l[1][1]-l[0][1],I=Math.atan2(z,N),b=Math.cos(I)*(i||0),w=Math.sin(I)*(i||0)),r&&tn(r)&&s&&(N=l[u-1][0]-l[0][0],z=l[u-1][1]-l[0][1],I=Math.atan2(z,N),R=Math.cos(I)*(s||0),P=Math.sin(I)*(s||0)),e.moveTo(h+(b||R),p+(w||P));for(var Z=1;Z<u-1;Z++){var Y=l[Z];e.lineTo(Y[0],Y[1])}e.lineTo(m,y)}function H1(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,s=t.markerEndOffset,l=t.points.points,u=l.length,h=l[0][0],p=l[0][1],m=l[u-1][0],y=l[u-1][1],b=0,w=0,R=0,P=0,I=0,N,z;n&&tn(n)&&i&&(N=l[1][0]-l[0][0],z=l[1][1]-l[0][1],I=Math.atan2(z,N),b=Math.cos(I)*(i||0),w=Math.sin(I)*(i||0)),r&&tn(r)&&s&&(N=l[u-2][0]-l[u-1][0],z=l[u-2][1]-l[u-1][1],I=Math.atan2(z,N),R=Math.cos(I)*(s||0),P=Math.sin(I)*(s||0)),e.moveTo(h+b,p+w);for(var Z=1;Z<u-1;Z++){var Y=l[Z];e.lineTo(Y[0],Y[1])}e.lineTo(m+R,y+P)}function Iv(e,t){var n=t.x,r=n===void 0?0:n,i=t.y,s=i===void 0?0:i,l=t.radius,u=t.width,h=t.height,p=u,m=h,y=l&&l.some(function(Y){return Y!==0});if(!y)e.rect(r,s,p,m);else{var b=u>0?1:-1,w=h>0?1:-1,R=b+w===0,P=(0,j.CR)(l.map(function(Y){return(0,ya.Z)(Y,0,Math.min(Math.abs(p)/2,Math.abs(m)/2))}),4),I=P[0],N=P[1],z=P[2],Z=P[3];e.moveTo(b*I+r,s),e.lineTo(p-b*N+r,s),N!==0&&e.arc(p-b*N+r,w*N+s,N,-w*Math.PI/2,b>0?0:Math.PI,R),e.lineTo(p+r,m-w*z+s),z!==0&&e.arc(p-b*z+r,m-w*z+s,z,b>0?0:Math.PI,w>0?Math.PI/2:1.5*Math.PI,R),e.lineTo(b*Z+r,m+s),Z!==0&&e.arc(b*Z+r,m-w*Z+s,Z,w>0?Math.PI/2:-Math.PI/2,b>0?Math.PI:0,R),e.lineTo(r,w*I+s),I!==0&&e.arc(b*I+r,w*I+s,I,b>0?Math.PI:0,w>0?Math.PI*1.5:Math.PI/2,R)}}var Ag=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.name="canvas-path-generator",n}return t.prototype.init=function(){var n,r=(n={},n[Yr.CIRCLE]=V1,n[Yr.ELLIPSE]=wb,n[Yr.RECT]=Iv,n[Yr.LINE]=sd,n[Yr.POLYLINE]=H1,n[Yr.POLYGON]=wg,n[Yr.PATH]=Pv,n[Yr.TEXT]=void 0,n[Yr.GROUP]=void 0,n[Yr.IMAGE]=void 0,n[Yr.HTML]=void 0,n[Yr.MESH]=void 0,n);this.context.pathGeneratorFactory=r},t.prototype.destroy=function(){delete this.context.pathGeneratorFactory},t}(jf),Z1=mt.Ue(),F2=mt.Ue(),cp=mt.Ue(),b0=Gt.create(),jm=function(){function e(){var t=this;this.isHit=function(n,r,i,s){var l=t.context.pointInPathPickerFactory[n.nodeName];if(l){var u=Gt.invert(b0,i),h=mt.fF(F2,mt.t8(cp,r[0],r[1],0),u);if(l(n,new gr(h[0],h[1]),s,t.isPointInPath,t.context,t.runtime))return!0}return!1},this.isPointInPath=function(n,r){var i=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),s=t.context.pathGeneratorFactory[n.nodeName];return s&&(i.beginPath(),s(i,n.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return e.prototype.apply=function(t,n){var r=this,i,s=t.renderingService,l=t.renderingContext;this.context=t,this.runtime=n;var u=(i=l.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(e.tag,function(h){return(0,j.mG)(r,void 0,void 0,function(){return(0,j.Jh)(this,function(p){return[2,this.pick(u,h)]})})}),s.hooks.pickSync.tap(e.tag,function(h){return r.pick(u,h)})},e.prototype.pick=function(t,n){var r,i,s=n.topmost,l=n.position,u=l.x,h=l.y,p=mt.t8(Z1,u,h,0),m=t.elementsFromBBox(p[0],p[1],p[0],p[1]),y=[];try{for(var b=(0,j.XA)(m),w=b.next();!w.done;w=b.next()){var R=w.value,P=R.getWorldTransform(),I=this.isHit(R,p,P,!1);if(I){var N=Kl(R);if(N){var z=N.parsedStyle.clipPath,Z=this.isHit(z,p,z.getWorldTransform(),!0);if(Z){if(s)return n.picked=[R],n;y.push(R)}}else{if(s)return n.picked=[R],n;y.push(R)}}}}catch(Y){r={error:Y}}finally{try{w&&!w.done&&(i=b.return)&&i.call(b)}finally{if(r)throw r.error}}return n.picked=y,n},e.tag="CanvasPicker",e}();function Hp(e,t,n){var r=e.parsedStyle,i=r.cx,s=i===void 0?0:i,l=r.cy,u=l===void 0?0:l,h=r.r,p=r.fill,m=r.stroke,y=r.lineWidth,b=y===void 0?1:y,w=r.increasedLineWidthForHitTesting,R=w===void 0?0:w,P=r.pointerEvents,I=P===void 0?"auto":P,N=(b+R)/2,z=gn(s,u,t.x,t.y),Z=(0,j.CR)(hu(I,p,m),2),Y=Z[0],$=Z[1];return Y&&$||n?z<=h+N:Y?z<=h:$?z>=h-N&&z<=h+N:!1}function K0(e,t,n,r){return e/(n*n)+t/(r*r)}function k2(e,t,n){var r=e.parsedStyle,i=r.cx,s=i===void 0?0:i,l=r.cy,u=l===void 0?0:l,h=r.rx,p=r.ry,m=r.fill,y=r.stroke,b=r.lineWidth,w=b===void 0?1:b,R=r.increasedLineWidthForHitTesting,P=R===void 0?0:R,I=r.pointerEvents,N=I===void 0?"auto":I,z=t.x,Z=t.y,Y=(0,j.CR)(hu(N,m,y),2),$=Y[0],J=Y[1],ae=(w+P)/2,pe=(z-s)*(z-s),Oe=(Z-u)*(Z-u);return $&&J||n?K0(pe,Oe,h+ae,p+ae)<=1:$?K0(pe,Oe,h,p)<=1:J?K0(pe,Oe,h-ae,p-ae)>=1&&K0(pe,Oe,h+ae,p+ae)<=1:!1}function Vm(e,t,n,r,i,s){return i>=e&&i<=e+n&&s>=t&&s<=t+r}function z2(e,t,n,r,i,s,l){var u=i/2;return Vm(e-u,t-u,n,i,s,l)||Vm(e+n-u,t-u,i,r,s,l)||Vm(e+u,t+r-u,n,i,s,l)||Vm(e-u,t+u,i,r,s,l)}function Ly(e,t,n,r,i,s,l,u){var h=(Math.atan2(u-t,l-e)+Math.PI*2)%(Math.PI*2),p={x:e+n*Math.cos(h),y:t+n*Math.sin(h)};return gn(p.x,p.y,l,u)<=s/2}function x0(e,t,n,r,i,s,l){var u=Math.min(e,n),h=Math.max(e,n),p=Math.min(t,r),m=Math.max(t,r),y=i/2;return s>=u-y&&s<=h+y&&l>=p-y&&l<=m+y?rf(e,t,n,r,s,l)<=i/2:!1}function Jl(e,t,n,r,i){var s=e.length;if(s<2)return!1;for(var l=0;l<s-1;l++){var u=e[l][0],h=e[l][1],p=e[l+1][0],m=e[l+1][1];if(x0(u,h,p,m,t,n,r))return!0}if(i){var y=e[0],b=e[s-1];if(x0(y[0],y[1],b[0],b[1],t,n,r))return!0}return!1}var WM=1e-6;function U2(e){return Math.abs(e)<WM?0:e<0?-1:1}function j2(e,t,n){return(n[0]-e[0])*(t[1]-e[1])===(t[0]-e[0])*(n[1]-e[1])&&Math.min(e[0],t[0])<=n[0]&&n[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=n[1]&&n[1]<=Math.max(e[1],t[1])}function V2(e,t,n){var r=!1,i=e.length;if(i<=2)return!1;for(var s=0;s<i;s++){var l=e[s],u=e[(s+1)%i];if(j2(l,u,[t,n]))return!0;U2(l[1]-n)>0!=U2(u[1]-n)>0&&U2(t-(n-l[1])*(l[0]-u[0])/(l[1]-u[1])-l[0])<0&&(r=!r)}return r}function Dy(e,t,n){for(var r=!1,i=0;i<e.length;i++){var s=e[i];if(r=V2(s,t,n),r)break}return r}function Lv(e,t,n){var r=e.parsedStyle,i=r.x1,s=r.y1,l=r.x2,u=r.y2,h=r.lineWidth,p=h===void 0?1:h,m=r.increasedLineWidthForHitTesting,y=m===void 0?0:m,b=r.pointerEvents,w=b===void 0?"auto":b,R=r.fill,P=r.stroke,I=(0,j.CR)(hu(w,R,P),2),N=I[1];return!N&&!n||!p?!1:x0(i,s,l,u,p+y,t.x,t.y)}function H2(e,t,n,r,i){for(var s=!1,l=t/2,u=0;u<e.length;u++){var h=e[u],p=h.currentPoint,m=h.params,y=h.prePoint,b=h.box;if(!(b&&!Vm(b.x-l,b.y-l,b.width+t,b.height+t,n,r)))switch(h.command){case"L":case"Z":if(s=x0(y[0],y[1],p[0],p[1],t,n,r),s)return!0;break;case"Q":var w=Su(y[0],y[1],m[1],m[2],m[3],m[4],n,r);if(s=w<=t/2,s)return!0;break;case"C":var R=su(y[0],y[1],m[1],m[2],m[3],m[4],m[5],m[6],n,r,i);if(s=R<=t/2,s)return!0;break;case"A":h.cubicParams||(h.cubicParams=yh(y[0],y[1],m[1],m[2],m[3],m[4],m[5],m[6],m[7],void 0));for(var P=h.cubicParams,I=y,N=0;N<P.length;N+=6){var z=su(I[0],I[1],P[N],P[N+1],P[N+2],P[N+3],P[N+4],P[N+5],n,r,i);if(I=[P[N+4],P[N+5]],s=z<=t/2,s)return!0}break}}return s}function Z2(e,t,n,r,i,s){var l=e.parsedStyle,u=l.lineWidth,h=u===void 0?1:u,p=l.increasedLineWidthForHitTesting,m=p===void 0?0:p,y=l.stroke,b=l.fill,w=l.d,R=l.pointerEvents,P=R===void 0?"auto":R,I=w.segments,N=w.hasArc,z=w.polylines,Z=w.polygons,Y=(0,j.CR)(hu(P,(Z==null?void 0:Z.length)&&b,y),2),$=Y[0],J=Y[1],ae=gv(e),pe=!1;return $||n?(N?pe=r(e,t):pe=Dy(Z,t.x,t.y)||Dy(z,t.x,t.y),pe):((J||n)&&(pe=H2(I,h+m,t.x,t.y,ae)),pe)}function Dw(e,t,n){var r=e.parsedStyle,i=r.stroke,s=r.fill,l=r.lineWidth,u=l===void 0?1:l,h=r.increasedLineWidthForHitTesting,p=h===void 0?0:h,m=r.points,y=r.pointerEvents,b=y===void 0?"auto":y,w=(0,j.CR)(hu(b,s,i),2),R=w[0],P=w[1],I=!1;return(P||n)&&(I=Jl(m.points,u+p,t.x,t.y,!0)),!I&&(R||n)&&(I=V2(m.points,t.x,t.y)),I}function Ab(e,t,n){var r=e.parsedStyle,i=r.lineWidth,s=i===void 0?1:i,l=r.increasedLineWidthForHitTesting,u=l===void 0?0:l,h=r.points,p=r.pointerEvents,m=p===void 0?"auto":p,y=r.fill,b=r.stroke,w=(0,j.CR)(hu(m,y,b),2),R=w[1];return!R&&!n||!s?!1:Jl(h.points,s+u,t.x,t.y,!1)}function GM(e,t,n,r,i){var s=e.parsedStyle,l=s.radius,u=s.fill,h=s.stroke,p=s.lineWidth,m=p===void 0?1:p,y=s.increasedLineWidthForHitTesting,b=y===void 0?0:y,w=s.x,R=w===void 0?0:w,P=s.y,I=P===void 0?0:P,N=s.width,z=s.height,Z=s.pointerEvents,Y=Z===void 0?"auto":Z,$=(0,j.CR)(hu(Y,u,h),2),J=$[0],ae=$[1],pe=l&&l.some(function(lt){return lt!==0}),Oe=m+b;if(pe){var Ke=!1;return(ae||n)&&(Ke=Nw(R,I,N,z,l.map(function(lt){return(0,ya.Z)(lt,0,Math.min(Math.abs(N)/2,Math.abs(z)/2))}),Oe,t.x,t.y)),!Ke&&(J||n)&&(Ke=r(e,t)),Ke}else{var Ve=Oe/2;if(J&&ae||n)return Vm(R-Ve,I-Ve,N+Ve,z+Ve,t.x,t.y);if(J)return Vm(R,I,N,z,t.x,t.y);if(ae)return z2(R,I,N,z,Oe,t.x,t.y)}return!1}function Nw(e,t,n,r,i,s,l,u){var h=(0,j.CR)(i,4),p=h[0],m=h[1],y=h[2],b=h[3];return x0(e+p,t,e+n-m,t,s,l,u)||x0(e+n,t+m,e+n,t+r-y,s,l,u)||x0(e+n-y,t+r,e+b,t+r,s,l,u)||x0(e,t+r-b,e,t+p,s,l,u)||Ly(e+n-m,t+m,m,1.5*Math.PI,2*Math.PI,s,l,u)||Ly(e+n-y,t+r-y,y,0,.5*Math.PI,s,l,u)||Ly(e+b,t+r-b,b,.5*Math.PI,Math.PI,s,l,u)||Ly(e+p,t+p,p,Math.PI,1.5*Math.PI,s,l,u)}function XM(e,t,n,r,i,s){var l=e.parsedStyle,u=l.pointerEvents,h=u===void 0?"auto":u,p=l.x,m=p===void 0?0:p,y=l.y,b=y===void 0?0:y,w=l.width,R=l.height;if(h==="non-transparent-pixel"){var P=i.config.offscreenCanvas,I=s.offscreenCanvasCreator.getOrCreateCanvas(P),N=s.offscreenCanvasCreator.getOrCreateContext(P,{willReadFrequently:!0});I.width=w,I.height=R,i.defaultStyleRendererFactory[Yr.IMAGE].render(N,(0,j.pi)((0,j.pi)({},e.parsedStyle),{x:0,y:0}),e,void 0,void 0,void 0);var z=N.getImageData(t.x-m,t.y-b,1,1).data;return z.every(function(Z){return Z!==0})}return!0}var W2=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.name="canvas-picker",n}return t.prototype.init=function(){var n,r=function(){return!0},i=(n={},n[Yr.CIRCLE]=Hp,n[Yr.ELLIPSE]=k2,n[Yr.RECT]=GM,n[Yr.LINE]=Lv,n[Yr.POLYLINE]=Ab,n[Yr.POLYGON]=Dw,n[Yr.PATH]=Z2,n[Yr.TEXT]=r,n[Yr.GROUP]=null,n[Yr.IMAGE]=XM,n[Yr.HTML]=null,n[Yr.MESH]=null,n);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new jm)},t.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},t}(jf),Cg=function(){function e(t){this.canvasRendererPluginOptions=t,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Gt.create(),this.dprMatrix=Gt.create(),this.tmpMat4=Gt.create(),this.vec3a=mt.Ue(),this.vec3b=mt.Ue(),this.vec3c=mt.Ue(),this.vec3d=mt.Ue()}return e.prototype.apply=function(t,n){var r=this;this.context=t;var i=t.config,s=t.camera,l=t.renderingService,u=t.renderingContext,h=t.rBushRoot,p=t.pathGeneratorFactory;this.rBush=h,this.pathGeneratorFactory=p;var m=t.contextService,y=u.root.ownerDocument.defaultView,b=function(P){var I=P.target,N=I.rBushNode;N.aabb&&r.removedRBushNodeAABBs.push(N.aabb)},w=function(P){var I=P.target,N=I.rBushNode;N.aabb&&r.removedRBushNodeAABBs.push(N.aabb)};l.hooks.init.tap(e.tag,function(){y.addEventListener(No.UNMOUNTED,b),y.addEventListener(No.CULLED,w);var P=m.getDPR(),I=i.width,N=i.height,z=m.getContext();r.clearRect(z,0,0,I*P,N*P,i.background)}),l.hooks.destroy.tap(e.tag,function(){y.removeEventListener(No.UNMOUNTED,b),y.removeEventListener(No.CULLED,w),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),l.hooks.beginFrame.tap(e.tag,function(){var P,I=m.getContext(),N=m.getDPR(),z=i.width,Z=i.height,Y=r.canvasRendererPluginOptions,$=Y.dirtyObjectNumThreshold,J=Y.dirtyObjectRatioThreshold,ae=l.getStats(),pe=ae.total,Oe=ae.rendered,Ve=Oe/pe;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((P=y.context.renderingPlugins[1])===null||P===void 0)&&P.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||Oe>$&&Ve>J,I&&(I.resetTransform?I.resetTransform():I.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(I,0,0,z*N,Z*N,i.background))});var R=function(P,I){P.isVisible()&&!P.isCulled()&&r.renderDisplayObject(P,I,r.context,r.restoreStack,n);var N=P.sortable.sorted||P.childNodes;N.forEach(function(z){R(z,I)})};l.hooks.endFrame.tap(e.tag,function(){if(u.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var P=m.getContext(),I=m.getDPR();if(Gt.fromScaling(r.dprMatrix,[I,I,1]),Gt.multiply(r.vpMatrix,r.dprMatrix,s.getOrthoMatrix()),r.clearFullScreen)R(u.root,P);else{var N=r.safeMergeAABB.apply(r,(0,j.ev)([r.mergeDirtyAABBs(r.renderQueue)],(0,j.CR)(r.removedRBushNodeAABBs.map(function(Hn){var rr=Hn.minX,or=Hn.minY,Hr=Hn.maxX,ui=Hn.maxY,Qi=new Rn;return Qi.setMinMax([rr,or,0],[Hr,ui,0]),Qi})),!1));if(r.removedRBushNodeAABBs=[],Rn.isEmpty(N)){r.renderQueue=[];return}var z=r.convertAABB2Rect(N),Z=z.x,Y=z.y,$=z.width,J=z.height,ae=mt.fF(r.vec3a,[Z,Y,0],r.vpMatrix),pe=mt.fF(r.vec3b,[Z+$,Y,0],r.vpMatrix),Oe=mt.fF(r.vec3c,[Z,Y+J,0],r.vpMatrix),Ve=mt.fF(r.vec3d,[Z+$,Y+J,0],r.vpMatrix),Ke=Math.min(ae[0],pe[0],Ve[0],Oe[0]),lt=Math.min(ae[1],pe[1],Ve[1],Oe[1]),Ge=Math.max(ae[0],pe[0],Ve[0],Oe[0]),rt=Math.max(ae[1],pe[1],Ve[1],Oe[1]),st=Math.floor(Ke),ut=Math.floor(lt),jt=Math.ceil(Ge-Ke),At=Math.ceil(rt-lt);P.save(),r.clearRect(P,st,ut,jt,At,i.background),P.beginPath(),P.rect(st,ut,jt,At),P.clip(),P.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var zt=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;zt&&y.dispatchEvent(new Va(fl.DIRTY_RECTANGLE,{dirtyRect:{x:st,y:ut,width:jt,height:At}}));var wn=r.searchDirtyObjects(N);wn.sort(function(Hn,rr){return Hn.sortable.renderOrder-rr.sortable.renderOrder}).forEach(function(Hn){Hn&&Hn.isVisible()&&!Hn.isCulled()&&r.renderDisplayObject(Hn,P,r.context,r.restoreStack,n)}),P.restore(),r.renderQueue.forEach(function(Hn){r.saveDirtyAABB(Hn)}),r.renderQueue=[]}r.restoreStack.forEach(function(){P.restore()}),r.restoreStack=[]}),l.hooks.render.tap(e.tag,function(P){r.clearFullScreen||r.renderQueue.push(P)})},e.prototype.clearRect=function(t,n,r,i,s,l){t.clearRect(n,r,i,s),l&&(t.fillStyle=l,t.fillRect(n,r,i,s))},e.prototype.renderDisplayObject=function(t,n,r,i,s){var l=t.nodeName,u=i[i.length-1];u&&!(t.compareDocumentPosition(u)&ju.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),i.pop());var h=this.context.styleRendererFactory[l],p=this.pathGeneratorFactory[l],m=t.parsedStyle.clipPath;if(m){this.applyWorldTransform(n,m);var y=this.pathGeneratorFactory[m.nodeName];y&&(n.save(),i.push(t),n.beginPath(),y(n,m.parsedStyle),n.closePath(),n.clip())}h&&(this.applyWorldTransform(n,t),n.save(),this.applyAttributesToContext(n,t)),p&&(n.beginPath(),p(n,t.parsedStyle),t.nodeName!==Yr.LINE&&t.nodeName!==Yr.PATH&&t.nodeName!==Yr.POLYLINE&&n.closePath()),h&&(h.render(n,t.parsedStyle,t,r,this,s),n.restore()),t.renderable.dirty=!1},e.prototype.convertAABB2Rect=function(t){var n=t.getMin(),r=t.getMax(),i=Math.floor(n[0]),s=Math.floor(n[1]),l=Math.ceil(r[0]),u=Math.ceil(r[1]),h=l-i,p=u-s;return{x:i,y:s,width:h,height:p}},e.prototype.mergeDirtyAABBs=function(t){var n=new Rn;return t.forEach(function(r){var i=r.getRenderBounds();n.add(i);var s=r.renderable.dirtyRenderBounds;s&&n.add(s)}),n},e.prototype.searchDirtyObjects=function(t){var n=(0,j.CR)(t.getMin(),2),r=n[0],i=n[1],s=(0,j.CR)(t.getMax(),2),l=s[0],u=s[1],h=this.rBush.search({minX:r,minY:i,maxX:l,maxY:u});return h.map(function(p){var m=p.displayObject;return m})},e.prototype.saveDirtyAABB=function(t){var n=t.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new Rn);var r=t.getRenderBounds();r&&n.dirtyRenderBounds.update(r.center,r.halfExtents)},e.prototype.applyAttributesToContext=function(t,n){var r=n.parsedStyle,i=r.stroke,s=r.fill,l=r.opacity,u=r.lineDash,h=r.lineDashOffset;u&&t.setLineDash(u),(0,Xr.Z)(h)||(t.lineDashOffset=h),(0,Xr.Z)(l)||(t.globalAlpha*=l),!(0,Xr.Z)(i)&&!Array.isArray(i)&&!i.isNone&&(t.strokeStyle=n.attributes.stroke),!(0,Xr.Z)(s)&&!Array.isArray(s)&&!s.isNone&&(t.fillStyle=n.attributes.fill)},e.prototype.applyWorldTransform=function(t,n,r){r?(Gt.copy(this.tmpMat4,n.getLocalTransform()),Gt.multiply(this.tmpMat4,r,this.tmpMat4),Gt.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Gt.copy(this.tmpMat4,n.getWorldTransform()),Gt.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},e.prototype.safeMergeAABB=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=new Rn;return t.forEach(function(i){r.add(i)}),r},e.tag="CanvasRenderer",e}(),Hm=function(){function e(t){this.imagePool=t}return e.prototype.render=function(t,n,r,i,s,l){var u=n.fill,h=n.fillRule,p=n.opacity,m=p===void 0?1:p,y=n.fillOpacity,b=y===void 0?1:y,w=n.stroke,R=n.strokeOpacity,P=R===void 0?1:R,I=n.lineWidth,N=I===void 0?1:I,z=n.lineCap,Z=n.lineJoin,Y=n.shadowType,$=n.shadowColor,J=n.shadowBlur,ae=n.filter,pe=n.miterLimit,Oe=u&&!u.isNone,Ve=w&&!w.isNone&&N>0,Ke=(u==null?void 0:u.alpha)===0,lt=!!(ae&&ae.length),Ge=!(0,Xr.Z)($)&&J>0,rt=r.nodeName,st=Y==="inner",ut=Ve&&Ge&&(rt===Yr.PATH||rt===Yr.LINE||rt===Yr.POLYLINE||Ke||st);Oe&&(t.globalAlpha=m*b,ut||W1(r,t,Ge),X2(t,r,u,h,i,s,l,this.imagePool),ut||this.clearShadowAndFilter(t,lt,Ge)),Ve&&(t.globalAlpha=m*P,t.lineWidth=N,(0,Xr.Z)(pe)||(t.miterLimit=pe),(0,Xr.Z)(z)||(t.lineCap=z),(0,Xr.Z)(Z)||(t.lineJoin=Z),ut&&(st&&(t.globalCompositeOperation="source-atop"),W1(r,t,!0),st&&(G1(t,r,w,i,s,l,this.imagePool),t.globalCompositeOperation="source-over",this.clearShadowAndFilter(t,lt,!0))),G1(t,r,w,i,s,l,this.imagePool))},e.prototype.clearShadowAndFilter=function(t,n,r){if(r&&(t.shadowColor="transparent",t.shadowBlur=0),n){var i=t.filter;!(0,Xr.Z)(i)&&i.indexOf("drop-shadow")>-1&&(t.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},e}();function W1(e,t,n){var r=e.parsedStyle,i=r.filter,s=r.shadowColor,l=r.shadowBlur,u=r.shadowOffsetX,h=r.shadowOffsetY;i&&i.length&&(t.filter=e.style.filter),n&&(t.shadowColor=s.toString(),t.shadowBlur=l||0,t.shadowOffsetX=u||0,t.shadowOffsetY=h||0)}function Og(e,t,n,r,i,s,l){var u,h;if(e.image.nodeName==="rect"){var p=e.image.parsedStyle,m=p.width,y=p.height;h=r.contextService.getDPR();var b=r.config.offscreenCanvas;u=s.offscreenCanvasCreator.getOrCreateCanvas(b),u.width=m*h,u.height=y*h;var w=s.offscreenCanvasCreator.getOrCreateContext(b),R=[];e.image.forEach(function(I){i.renderDisplayObject(I,w,r,R,s)}),R.forEach(function(){w.restore()})}var P=l.getOrCreatePatternSync(e,n,u,h,t.getGeometryBounds().min,function(){t.renderable.dirty=!0,r.renderingService.dirtify()});return P}function G2(e,t,n,r){var i;if(e.type===Il.LinearGradient||e.type===Il.RadialGradient){var s=t.getGeometryBounds(),l=s&&s.halfExtents[0]*2||1,u=s&&s.halfExtents[1]*2||1,h=s&&s.min||[0,0];i=r.getOrCreateGradient((0,j.pi)((0,j.pi)({type:e.type},e.value),{min:h,width:l,height:u}),n)}return i}function X2(e,t,n,r,i,s,l,u,h){h===void 0&&(h=!1),Array.isArray(n)?n.forEach(function(p){e.fillStyle=G2(p,t,e,u),h||(r?e.fill(r):e.fill())}):(c0(n)&&(e.fillStyle=Og(n,t,e,i,s,l,u)),h||(r?e.fill(r):e.fill()))}function G1(e,t,n,r,i,s,l,u){u===void 0&&(u=!1),Array.isArray(n)?n.forEach(function(h){e.strokeStyle=G2(h,t,e,l),u||e.stroke()}):(c0(n)&&(e.strokeStyle=Og(n,t,e,r,i,s,l)),u||e.stroke())}var YM=function(){function e(t){this.imagePool=t}return e.prototype.render=function(t,n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l,h=n.width,p=n.height,m=n.src,y=n.shadowColor,b=n.shadowBlur,w,R=h,P=p;if(Xo(m)?w=this.imagePool.getImageSync(m):(R||(R=m.width),P||(P=m.height),w=m),w){var I=!(0,Xr.Z)(y)&&b>0;W1(r,t,I);try{t.drawImage(w,s,u,R,P)}catch(N){}}},e}(),X1=function(){function e(t){this.imagePool=t}return e.prototype.render=function(t,n,r,i,s,l){r.getBounds();var u=n,h=u.lineWidth,p=h===void 0?1:h,m=u.textAlign,y=m===void 0?"start":m,b=u.textBaseline,w=b===void 0?"alphabetic":b,R=u.lineJoin,P=R===void 0?"miter":R,I=u.miterLimit,N=I===void 0?10:I,z=u.letterSpacing,Z=z===void 0?0:z,Y=u.stroke,$=u.fill,J=u.fillRule,ae=u.fillOpacity,pe=ae===void 0?1:ae,Oe=u.strokeOpacity,Ve=Oe===void 0?1:Oe,Ke=u.opacity,lt=Ke===void 0?1:Ke,Ge=u.metrics,rt=u.x,st=rt===void 0?0:rt,ut=u.y,jt=ut===void 0?0:ut,At=u.dx,zt=u.dy,wn=u.shadowColor,Hn=u.shadowBlur,rr=Ge.font,or=Ge.lines,Hr=Ge.height,ui=Ge.lineHeight,Qi=Ge.lineMetrics;t.font=rr,t.lineWidth=p,t.textAlign=y==="middle"?"center":y;var ii=w;!l.enableCSSParsing&&ii==="alphabetic"&&(ii="bottom"),t.lineJoin=P,(0,Xr.Z)(N)||(t.miterLimit=N);var ti=jt;w==="middle"?ti+=-Hr/2-ui/2:w==="bottom"||w==="alphabetic"||w==="ideographic"?ti+=-Hr:(w==="top"||w==="hanging")&&(ti+=-ui);var Po=st+(At||0);ti+=zt||0,or.length===1&&(ii==="bottom"?(ii="middle",ti-=.5*Hr):ii==="top"&&(ii="middle",ti+=.5*Hr)),t.textBaseline=ii;var Ji=!(0,Xr.Z)(wn)&&Hn>0;W1(r,t,Ji);for(var Vi=0;Vi<or.length;Vi++){var xo=p/2+Po;ti+=ui,!(0,Xr.Z)(Y)&&!Y.isNone&&p&&this.drawLetterSpacing(t,r,or[Vi],Qi[Vi],y,xo,ti,Z,$,J,pe,Y,Ve,lt,!0,i,s,l),(0,Xr.Z)($)||this.drawLetterSpacing(t,r,or[Vi],Qi[Vi],y,xo,ti,Z,$,J,pe,Y,Ve,lt,!1,i,s,l)}},e.prototype.drawLetterSpacing=function(t,n,r,i,s,l,u,h,p,m,y,b,w,R,P,I,N,z){if(h===0){P?this.strokeText(t,n,r,l,u,b,w,I,N,z):this.fillText(t,n,r,l,u,p,m,y,R,I,N,z);return}var Z=t.textAlign;t.textAlign="left";var Y=l;s==="center"||s==="middle"?Y=l-i.width/2:(s==="right"||s==="end")&&(Y=l-i.width);for(var $=Array.from(r),J=t.measureText(r).width,ae=0,pe=0;pe<$.length;++pe){var Oe=$[pe];P?this.strokeText(t,n,Oe,Y,u,b,w,I,N,z):this.fillText(t,n,Oe,Y,u,p,m,y,R,I,N,z),ae=t.measureText(r.substring(pe+1)).width,Y+=J-ae+h,J=ae}t.textAlign=Z},e.prototype.fillText=function(t,n,r,i,s,l,u,h,p,m,y,b){X2(t,n,l,u,m,y,b,this.imagePool,!0);var w,R=!(0,Xr.Z)(h)&&h!==1;R&&(w=t.globalAlpha,t.globalAlpha=h*p),t.fillText(r,i,s),R&&(t.globalAlpha=w)},e.prototype.strokeText=function(t,n,r,i,s,l,u,h,p,m){G1(t,n,l,h,p,m,this.imagePool,!0);var y,b=!(0,Xr.Z)(u)&&u!==1;b&&(y=t.globalAlpha,t.globalAlpha=u),t.strokeText(r,i,s),b&&(t.globalAlpha=y)},e}(),Y2=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),Ck=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),$M=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),Ok=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),KM=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),Rk=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),qM=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Hm),Y1=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=e.call(this)||this;return r.options=n,r.name="canvas-renderer",r}return t.prototype.init=function(){var n,r=(0,j.pi)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,s=new Hm(i),l=(n={},n[Yr.CIRCLE]=s,n[Yr.ELLIPSE]=s,n[Yr.RECT]=s,n[Yr.IMAGE]=new YM(i),n[Yr.TEXT]=new X1(i),n[Yr.LINE]=s,n[Yr.POLYLINE]=s,n[Yr.POLYGON]=s,n[Yr.PATH]=s,n[Yr.GROUP]=void 0,n[Yr.HTML]=void 0,n[Yr.MESH]=void 0,n);this.context.defaultStyleRendererFactory=l,this.context.styleRendererFactory=l,this.addRenderingPlugin(new Cg(r))},t.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},t}(jf),QM=function(){function e(){}return e.prototype.apply=function(t,n){var r=this,i=t.renderingService,s=t.renderingContext,l=t.config;this.context=t;var u=s.root.ownerDocument.defaultView,h=function(J){i.hooks.pointerMove.call(J)},p=function(J){i.hooks.pointerUp.call(J)},m=function(J){i.hooks.pointerDown.call(J)},y=function(J){i.hooks.pointerOver.call(J)},b=function(J){i.hooks.pointerOut.call(J)},w=function(J){i.hooks.pointerCancel.call(J)},R=function(J){i.hooks.pointerWheel.call(J)},P=function(J){i.hooks.click.call(J)},I=function(J){n.globalThis.document.addEventListener("pointermove",h,!0),J.addEventListener("pointerdown",m,!0),J.addEventListener("pointerleave",b,!0),J.addEventListener("pointerover",y,!0),n.globalThis.addEventListener("pointerup",p,!0),n.globalThis.addEventListener("pointercancel",w,!0)},N=function(J){J.addEventListener("touchstart",m,!0),J.addEventListener("touchend",p,!0),J.addEventListener("touchmove",h,!0),J.addEventListener("touchcancel",w,!0)},z=function(J){n.globalThis.document.addEventListener("mousemove",h,!0),J.addEventListener("mousedown",m,!0),J.addEventListener("mouseout",b,!0),J.addEventListener("mouseover",y,!0),n.globalThis.addEventListener("mouseup",p,!0)},Z=function(J){n.globalThis.document.removeEventListener("pointermove",h,!0),J.removeEventListener("pointerdown",m,!0),J.removeEventListener("pointerleave",b,!0),J.removeEventListener("pointerover",y,!0),n.globalThis.removeEventListener("pointerup",p,!0)},Y=function(J){J.removeEventListener("touchstart",m,!0),J.removeEventListener("touchend",p,!0),J.removeEventListener("touchmove",h,!0),J.removeEventListener("touchcancel",w,!0)},$=function(J){n.globalThis.document.removeEventListener("mousemove",h,!0),J.removeEventListener("mousedown",m,!0),J.removeEventListener("mouseout",b,!0),J.removeEventListener("mouseover",y,!0),n.globalThis.removeEventListener("mouseup",p,!0)};i.hooks.init.tap(e.tag,function(){var J=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(J.style.msContentZooming="none",J.style.msTouchAction="none"):u.supportsPointerEvents&&(J.style.touchAction="none"),u.supportsPointerEvents?I(J):z(J),u.supportsTouchEvents&&N(J),l.useNativeClickEvent&&J.addEventListener("click",P,!0),J.addEventListener("wheel",R,{passive:!0,capture:!0})}),i.hooks.destroy.tap(e.tag,function(){var J=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(J.style.msContentZooming="",J.style.msTouchAction=""):u.supportsPointerEvents&&(J.style.touchAction=""),u.supportsPointerEvents?Z(J):$(J),u.supportsTouchEvents&&Y(J),l.useNativeClickEvent&&J.removeEventListener("click",P,!0),J.removeEventListener("wheel",R,!0)})},e.tag="DOMInteraction",e}(),JM=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.name="dom-interaction",n}return t.prototype.init=function(){this.addRenderingPlugin(new QM)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(jf),Bw="g-canvas-camera",Fw=function(){function e(){this.displayObjectHTMLElementMap=new WeakMap}return e.prototype.joinTransformMatrix=function(t){return"matrix(".concat([t[0],t[1],t[4],t[5],t[12],t[13]].join(","),")")},e.prototype.apply=function(t,n){var r=this,i=t.camera,s=t.renderingContext,l=t.renderingService;this.context=t;var u=s.root.ownerDocument.defaultView,h=u.context.eventService.nativeHTMLMap,p=function(P,I){I.style.transform=r.joinTransformMatrix(P.getWorldTransform())},m=function(P){var I=P.target;if(I.nodeName===Yr.HTML){r.$camera||(r.$camera=r.createCamera(i));var N=r.getOrCreateEl(I);if(r.$camera.appendChild(N),n.enableCSSParsing){var z=I.ownerDocument.documentElement.attributes;Object.keys(z).forEach(function(Z){N.style[Z]=z[Z]})}Object.keys(I.attributes).forEach(function(Z){r.updateAttribute(Z,I)}),p(I,N),h.set(N,I)}},y=function(P){var I=P.target;if(I.nodeName===Yr.HTML&&r.$camera){var N=r.getOrCreateEl(I);N&&(N.remove(),h.delete(N))}},b=function(P){var I=P.target;if(I.nodeName===Yr.HTML){var N=P.attrName;r.updateAttribute(N,I)}},w=function(P){var I=P.target;if(I.nodeName===Yr.HTML){var N=r.getOrCreateEl(I);p(I,N)}},R=function(){if(r.$camera){var P=r.context.config,I=P.width,N=P.height;r.$camera.style.width="".concat(I||0,"px"),r.$camera.style.height="".concat(N||0,"px")}};l.hooks.init.tap(e.tag,function(){u.addEventListener(fl.RESIZE,R),u.addEventListener(No.MOUNTED,m),u.addEventListener(No.UNMOUNTED,y),u.addEventListener(No.ATTR_MODIFIED,b),u.addEventListener(No.BOUNDS_CHANGED,w)}),l.hooks.endFrame.tap(e.tag,function(){r.$camera&&s.renderReasons.has(id.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),l.hooks.destroy.tap(e.tag,function(){r.$camera&&r.$camera.remove(),u.removeEventListener(fl.RESIZE,R),u.removeEventListener(No.MOUNTED,m),u.removeEventListener(No.UNMOUNTED,y),u.removeEventListener(No.ATTR_MODIFIED,b),u.removeEventListener(No.BOUNDS_CHANGED,w)})},e.prototype.createCamera=function(t){var n=this.context.config,r=n.document,i=n.width,s=n.height,l=this.context.contextService.getDomElement(),u=l.parentNode;if(u){var h=Bw,p=u.querySelector("#"+h);if(!p){var m=(r||document).createElement("div");p=m,m.id=h,m.style.position="absolute",m.style.left="".concat(l.offsetLeft||0,"px"),m.style.top="".concat(l.offsetTop||0,"px"),m.style.transformOrigin="left top",m.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),m.style.overflow="hidden",m.style.pointerEvents="none",m.style.width="".concat(i||0,"px"),m.style.height="".concat(s||0,"px"),u.appendChild(m)}return p}return null},e.prototype.getOrCreateEl=function(t){var n=this.context.config.document,r=this.displayObjectHTMLElementMap.get(t);return r||(r=(n||document).createElement("div"),t.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(t,r),t.id&&(r.id=t.id),t.name&&r.setAttribute("name",t.name),t.className&&(r.className=t.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(t.getWorldTransform())),r},e.prototype.updateAttribute=function(t,n){var r=this.getOrCreateEl(n);switch(t){case"innerHTML":var i=n.parsedStyle.innerHTML;Xo(i)?r.innerHTML=i:(r.innerHTML="",r.appendChild(i));break;case"x":r.style.left="".concat(n.parsedStyle.x,"px");break;case"y":r.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var s=n.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(s[0].value," ").concat(s[1].value);break;case"width":if(this.context.enableCSSParsing){var l=n.computedStyleMap().get("width");r.style.width=l.toString()}else{var l=n.parsedStyle.width;r.style.width=(0,dr.Z)(l)?"".concat(l,"px"):l.toString()}break;case"height":if(this.context.enableCSSParsing){var u=n.computedStyleMap().get("height");r.style.height=u.toString()}else{var u=n.parsedStyle.height;r.style.height=(0,dr.Z)(u)?"".concat(u,"px"):u.toString()}break;case"zIndex":var h=n.parsedStyle.zIndex;r.style["z-index"]="".concat(h);break;case"visibility":var p=n.parsedStyle.visibility;r.style.visibility=p;break;case"pointerEvents":var m=n.parsedStyle.pointerEvents,y=m===void 0?"auto":m;r.style.pointerEvents=y;break;case"opacity":var b=n.parsedStyle.opacity;r.style.opacity="".concat(b);break;case"fill":var w=n.parsedStyle.fill,R="";u0(w)?w.isNone?R="transparent":R=n.getAttribute("fill"):Array.isArray(w)?R=n.getAttribute("fill"):c0(w),r.style.background=R;break;case"stroke":var P=n.parsedStyle.stroke,I="";u0(P)?P.isNone?I="transparent":I=n.getAttribute("stroke"):Array.isArray(P)?I=n.getAttribute("stroke"):c0(P),r.style["border-color"]=I,r.style["border-style"]="solid";break;case"lineWidth":var N=n.parsedStyle.lineWidth;r.style["border-width"]="".concat(N||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var z=n.style.filter;r.style.filter=z;break;default:!(0,Xr.Z)(n.style[t])&&n.style[t]!==""&&(r.style[t]=n.style[t])}},e.tag="HTMLRendering",e}(),kw=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.name="html-renderer",n}return t.prototype.init=function(){this.addRenderingPlugin(new Fw)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(jf),zw=function(){function e(t){this.canvasConfig=t,this.imageCache={},this.gradientCache={},this.patternCache={}}return e.prototype.getImageSync=function(t,n){return this.imageCache[t]?n&&n(this.imageCache[t]):this.getOrCreateImage(t).then(function(r){n&&n(r)}),this.imageCache[t]},e.prototype.getOrCreateImage=function(t){var n=this;if(this.imageCache[t])return Promise.resolve(this.imageCache[t]);var r=this.canvasConfig.createImage;return new Promise(function(i,s){var l;r?l=r(t):vl&&(l=new window.Image),l&&(l.onload=function(){n.imageCache[t]=l,i(l)},l.onerror=function(u){s(u)},l.crossOrigin="Anonymous",l.src=t)})},e.prototype.getOrCreatePatternSync=function(t,n,r,i,s,l){var u=this.generatePatternKey(t);if(u&&this.patternCache[u])return this.patternCache[u];var h=t.image,p=t.repetition,m=t.transform,y,b=!1;Xo(h)?y=this.getImageSync(h,l):r?(y=r,b=!0):y=h;var w=y&&n.createPattern(y,p);if(w){var R=void 0;m?R=aa(Em(m),new jr({})):R=Gt.identity(Gt.create()),b&&Gt.scale(R,R,[1/i,1/i,1]),w.setTransform({a:R[0],b:R[1],c:R[4],d:R[5],e:R[12]+s[0],f:R[13]+s[1]})}return u&&w&&(this.patternCache[u]=w),w},e.prototype.getOrCreateGradient=function(t,n){var r=this.generateGradientKey(t),i=t.type,s=t.steps,l=t.min,u=t.width,h=t.height,p=t.angle,m=t.cx,y=t.cy,b=t.size;if(this.gradientCache[r])return this.gradientCache[r];var w=null;if(i===Il.LinearGradient){var R=vy(l,u,h,p),P=R.x1,I=R.y1,N=R.x2,z=R.y2;w=n.createLinearGradient(P,I,N,z)}else if(i===Il.RadialGradient){var Z=ig(l,u,h,m,y,b),Y=Z.x,$=Z.y,J=Z.r;w=n.createRadialGradient(Y,$,0,Y,$,J)}return w&&(s.forEach(function(ae){var pe=ae.offset,Oe=ae.color;pe.unit===Zr.kPercentage&&(w==null||w.addColorStop(pe.value/100,Oe.toString()))}),this.gradientCache[r]=w),this.gradientCache[r]},e.prototype.generateGradientKey=function(t){var n=t.type,r=t.min,i=t.width,s=t.height,l=t.steps,u=t.angle,h=t.cx,p=t.cy,m=t.size;return"gradient-".concat(n,"-").concat((u==null?void 0:u.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat((p==null?void 0:p.toString())||0,"-").concat((m==null?void 0:m.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(i,"-").concat(s,"-").concat(l.map(function(y){var b=y.offset,w=y.color;return"".concat(b).concat(w)}).join("-"))},e.prototype.generatePatternKey=function(t){var n=t.image,r=t.repetition;if(Xo(n))return"pattern-".concat(n,"-").concat(r);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(r)},e}(),Uw=function(){function e(){}return e.prototype.apply=function(t){var n=t.renderingService,r=t.renderingContext,i=t.imagePool,s=r.root.ownerDocument.defaultView,l=function(p,m,y){var b=p.parsedStyle,w=b.width,R=b.height;w&&!R?p.setAttribute("height",y/m*w):!w&&R&&p.setAttribute("width",m/y*R)},u=function(p){var m=p.target,y=m.nodeName,b=m.attributes;if(y===Yr.IMAGE){var w=b.src,R=b.keepAspectRatio;Xo(w)&&i.getImageSync(w,function(P){var I=P.width,N=P.height;R&&l(m,I,N),m.renderable.dirty=!0,n.dirtify()})}},h=function(p){var m=p.target,y=p.attrName,b=p.newValue;m.nodeName===Yr.IMAGE&&y==="src"&&Xo(b)&&i.getOrCreateImage(b).then(function(w){var R=w.width,P=w.height;m.attributes.keepAspectRatio&&l(m,R,P),m.renderable.dirty=!0,n.dirtify()})};n.hooks.init.tap(e.tag,function(){s.addEventListener(No.MOUNTED,u),s.addEventListener(No.ATTR_MODIFIED,h)}),n.hooks.destroy.tap(e.tag,function(){s.removeEventListener(No.MOUNTED,u),s.removeEventListener(No.ATTR_MODIFIED,h)})},e.tag="LoadImage",e}(),jw=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.name="image-loader",n}return t.prototype.init=function(){this.context.imagePool=new zw(this.context.config),this.addRenderingPlugin(new Uw)},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t}(jf),Vw=function(){function e(t){this.renderingContext=t.renderingContext,this.canvasConfig=t.config}return e.prototype.init=function(){var t=this.canvasConfig,n=t.container,r=t.canvas;if(r)this.$canvas=r,n&&r.parentElement!==n&&n.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=Xo(n)?document.getElementById(n):n,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},e.prototype.getContext=function(){return this.context},e.prototype.getDomElement=function(){return this.$canvas},e.prototype.getDPR=function(){return this.dpr},e.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},e.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},e.prototype.resize=function(t,n){var r=this.canvasConfig.devicePixelRatio,i=r||vl&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*n,Ca(this.$canvas,t,n)),this.renderingContext.renderReasons.add(id.CAMERA_CHANGED)},e.prototype.applyCursorStyle=function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)},e.prototype.toDataURL=function(t){return t===void 0&&(t={}),(0,j.mG)(this,void 0,void 0,function(){var n,r;return(0,j.Jh)(this,function(i){return n=t.type,r=t.encoderOptions,[2,this.context.canvas.toDataURL(n,r)]})})},e}(),$2=function(e){(0,j.ZT)(t,e);function t(){var n=e.apply(this,(0,j.ev)([],(0,j.CR)(arguments),!1))||this;return n.name="canvas-context-register",n}return t.prototype.init=function(){this.context.ContextService=Vw},t.prototype.destroy=function(){delete this.context.ContextService},t}(jf),Cb=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n)||this;return r.registerPlugin(new $2),r.registerPlugin(new jw),r.registerPlugin(new Ag),r.registerPlugin(new Y1),r.registerPlugin(new JM),r.registerPlugin(new W2),r.registerPlugin(new kw),r}return t}(qh),ld=function(){function e(t){this.dragndropPluginOptions=t}return e.prototype.apply=function(t){var n=this,r=t.renderingService,i=t.renderingContext,s=i.root.ownerDocument,l=s.defaultView,u=function(h){var p=h.target,m=p===s,y=m&&n.dragndropPluginOptions.isDocumentDraggable?s:p.closest&&p.closest("[draggable=true]");if(y){var b=!1,w=h.timeStamp,R=[h.clientX,h.clientY],P=null,I=[h.clientX,h.clientY],N=function(Z){return(0,j.mG)(n,void 0,void 0,function(){var Y,$,J,ae,pe,Oe;return(0,j.Jh)(this,function(Ve){switch(Ve.label){case 0:if(!b){if(Y=Z.timeStamp-w,$=ai([Z.clientX,Z.clientY],R),Y<=this.dragndropPluginOptions.dragstartTimeThreshold||$<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];Z.type="dragstart",y.dispatchEvent(Z),b=!0}return Z.type="drag",Z.dx=Z.clientX-I[0],Z.dy=Z.clientY-I[1],y.dispatchEvent(Z),I=[Z.clientX,Z.clientY],m?[3,2]:(J=this.dragndropPluginOptions.overlap==="pointer"?[Z.canvasX,Z.canvasY]:p.getBounds().center,[4,s.elementsFromPoint(J[0],J[1])]);case 1:ae=Ve.sent(),pe=ae[ae.indexOf(p)+1],Oe=(pe==null?void 0:pe.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?s:null),P!==Oe&&(P&&(Z.type="dragleave",Z.target=P,P.dispatchEvent(Z)),Oe&&(Z.type="dragenter",Z.target=Oe,Oe.dispatchEvent(Z)),P=Oe,P&&(Z.type="dragover",Z.target=P,P.dispatchEvent(Z))),Ve.label=2;case 2:return[2]}})})};l.addEventListener("pointermove",N);var z=function(Z){if(b){Z.detail={preventClick:!0};var Y=Z.clone();P&&(Y.type="drop",Y.target=P,P.dispatchEvent(Y)),Y.type="dragend",y.dispatchEvent(Y),b=!1}l.removeEventListener("pointermove",N)};p.addEventListener("pointerup",z,{once:!0}),p.addEventListener("pointerupoutside",z,{once:!0})}};r.hooks.init.tap(e.tag,function(){l.addEventListener("pointerdown",u)}),r.hooks.destroy.tap(e.tag,function(){l.removeEventListener("pointerdown",u)})},e.tag="Dragndrop",e}(),K2=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=e.call(this)||this;return r.options=n,r.name="dragndrop",r}return t.prototype.init=function(){this.addRenderingPlugin(new ld((0,j.pi)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},t.prototype.destroy=function(){this.removeAllRenderingPlugins()},t.prototype.setOptions=function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)},t}(jf);function Hw(e,t,n){var r;return function(){var i=this,s=arguments,l=function(){r=null,n||e.apply(i,s)},u=n&&!r;clearTimeout(r),r=setTimeout(l,t),u&&e.apply(i,s)}}var q2=Hw,Zw=function(e){return typeof e=="object"&&e!==null},Ob=Zw,Ww=function(e){if(!Ob(e)||!(0,Uo.Z)(e,"Object"))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},q0=Ww,Q2=5;function Gw(e,t){if(Object.hasOwn)return Object.hasOwn(e,t);if(e==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)}function J2(e,t,n,r){n=n||0,r=r||Q2;for(var i in t)if(Gw(t,i)){var s=t[i];s!==null&&q0(s)?(q0(e[i])||(e[i]={}),n<r?J2(e[i],s,n+1,r):e[i]=t[i]):_s(s)?(e[i]=[],e[i]=e[i].concat(s)):s!==void 0&&(e[i]=s)}}var Xw=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r+=1)J2(e,t[r]);return e},ri=Xw;class Yw extends Map{constructor(t,n=nE){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Rb(this,t))}has(t){return super.has(Rb(this,t))}set(t,n){return super.set(eE(this,t),n)}delete(t){return super.delete(tE(this,t))}}class eP extends null{constructor(t,n=nE){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Rb(this,t))}add(t){return super.add(eE(this,t))}delete(t){return super.delete(tE(this,t))}}function Rb({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function eE({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function tE({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function nE(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Ny(e){return e}function Rc(e,...t){return Rg(e,Ny,Ny,t)}function By(e,...t){return Rg(e,Array.from,Ny,t)}function rE(e,t){for(let n=1,r=t.length;n<r;++n)e=e.flatMap(i=>i.pop().map(([s,l])=>[...i,s,l]));return e}function iE(e,...t){return rE(By(e,...t),t)}function Mk(e,t,...n){return rE($1(e,t,...n),n)}function Mb(e,t,...n){return Rg(e,Ny,t,n)}function $1(e,t,...n){return Rg(e,Array.from,t,n)}function $w(e,...t){return Rg(e,identity,oE,t)}function tP(e,...t){return Rg(e,Array.from,oE,t)}function oE(e){if(e.length!==1)throw new Error("duplicate key");return e[0]}function Rg(e,t,n,r){return function i(s,l){if(l>=r.length)return n(s);const u=new Yw,h=r[l++];let p=-1;for(const m of s){const y=h(m,++p,s),b=u.get(y);b?b.push(m):u.set(y,[m])}for(const[m,y]of u)u.set(m,i(y,l));return t(u)}(e,0)}var aE=function(e){return(0,Xr.Z)(e)?"":e.toString()},Kw=function(e){var t=aE(e);return t.charAt(0).toLowerCase()+t.substring(1)},sE=Kw,nP=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};function Dv(e){return e}function Fy(e){return e.reduce((t,n)=>(r,...i)=>n(t(r,...i),...i),Dv)}function qw(e){return e.reduce((t,n)=>r=>nP(this,void 0,void 0,function*(){const i=yield t(r);return n(i)}),Dv)}function Pb(e){return e.replace(/( |^)[a-z]/g,t=>t.toUpperCase())}function Nv(e=""){throw new Error(e)}function Ib(e,t){const{attributes:n}=t,r=new Set(["id","className"]);for(const[i,s]of Object.entries(n))r.has(i)||e.attr(i,s)}function ec(e){return e!=null&&!Number.isNaN(e)}function Qw(e,t){return e+(t-e)*Math.random()}function Jw(e){const t=new Map;return n=>{if(t.has(n))return t.get(n);const r=e(n);return t.set(n,r),r}}function eA(e,t){const{transform:n}=e.style,i=(s=>s==="none"||s===void 0)(n)?"":n;e.style.transform=`${i} ${t}`.trimStart()}function uo(e,t){return lE(e,t)||{}}function lE(e,t){const n=Object.entries(e||{}).filter(([r])=>r.startsWith(t)).map(([r,i])=>[sE(r.replace(t,"").trim()),i]).filter(([r])=>!!r);return n.length===0?null:Object.fromEntries(n)}function rP(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[`${t}${upperFirst(n)}`,r]))}function cE(e,t){return Object.fromEntries(Object.entries(e).filter(([n])=>t.find(r=>n.startsWith(r))))}function K1(e,...t){return Object.fromEntries(Object.entries(e).filter(([n])=>t.every(r=>!n.startsWith(r))))}function q1(e,t){if(e===void 0)return null;if(typeof e=="number")return e;const n=+e.replace("%","");return Number.isNaN(n)?null:n/100*t}function Q0(e){return typeof e=="object"&&!(e instanceof Date)&&e!==null&&!Array.isArray(e)}function J0(e){return e===null||e===!1}function uE(e,t,n=5,r=0){if(!(r>=n)){for(const i of Object.keys(t)){const s=t[i];!q0(s)||!q0(e[i])?e[i]=s:uE(e[i],s,n,r+1)}return e}}function Ra(e){return new pu([e],null,e,e.ownerDocument)}class pu{constructor(t=null,n=null,r=null,i=null,s=[null,null,null,null,null],l=[],u=[]){this._elements=Array.from(t),this._data=n,this._parent=r,this._document=i,this._enter=s[0],this._update=s[1],this._exit=s[2],this._merge=s[3],this._split=s[4],this._transitions=l,this._facetElements=u}selectAll(t){const n=typeof t=="string"?this._parent.querySelectorAll(t):t;return new pu(n,null,this._elements[0],this._document)}selectFacetAll(t){const n=typeof t=="string"?this._parent.querySelectorAll(t):t;return new pu(this._elements,null,this._parent,this._document,void 0,void 0,n)}select(t){const n=typeof t=="string"?this._parent.querySelectorAll(t)[0]||null:t;return new pu([n],null,n,this._document)}append(t){const n=typeof t=="function"?t:()=>this.createElement(t),r=[];if(this._data!==null){for(let i=0;i<this._data.length;i++){const s=this._data[i],[l,u]=Array.isArray(s)?s:[s,null],h=n(l,i);h.__data__=l,u!==null&&(h.__fromElements__=u),this._parent.appendChild(h),r.push(h)}return new pu(r,null,this._parent,this._document)}else{for(let i=0;i<this._elements.length;i++){const s=this._elements[i],l=s.__data__,u=n(l,i);s.appendChild(u),r.push(u)}return new pu(r,null,r[0],this._document)}}maybeAppend(t,n,r){const i=this._elements[0],s=i.getElementById(t);if(s)return new pu([s],null,this._parent,this._document);const l=typeof n=="string"?this.createElement(n):n();return l.id=t,r&&(l.className=r),i.appendChild(l),new pu([l],null,this._parent,this._document)}data(t,n=i=>i,r=()=>null){const i=[],s=[],l=new Set(this._elements),u=[],h=new Set,p=new Map(this._elements.map((w,R)=>[n(w.__data__,R),w])),m=new Map(this._facetElements.map((w,R)=>[n(w.__data__,R),w])),y=Rc(this._elements,w=>r(w.__data__));for(let w=0;w<t.length;w++){const R=t[w],P=n(R,w),I=r(R,w);if(p.has(P)){const N=p.get(P);N.__data__=R,N.__facet__=!1,s.push(N),l.delete(N),p.delete(P)}else if(m.has(P)){const N=m.get(P);N.__data__=R,N.__facet__=!0,s.push(N),m.delete(P)}else if(y.has(P)){const N=y.get(P);u.push([R,N]);for(const z of N)l.delete(z);y.delete(P)}else if(p.has(I)){const N=p.get(I);N.__toData__?N.__toData__.push(R):N.__toData__=[R],h.add(N),l.delete(N)}else i.push(R)}const b=[new pu([],i,this._parent,this._document),new pu(s,null,this._parent,this._document),new pu(l,null,this._parent,this._document),new pu([],u,this._parent,this._document),new pu(h,null,this._parent,this._document)];return new pu(this._elements,null,this._parent,this._document,b)}merge(t){const n=[...this._elements,...t._elements],r=[...this._transitions,...t._transitions];return new pu(n,null,this._parent,this._document,void 0,r)}createElement(t){if(this._document)return this._document.createElement(t,{});const n=pu.registry[t];return n?new n:Nv(`Unknown node type: ${t}`)}join(t=l=>l,n=l=>l,r=l=>l.remove(),i=l=>l,s=l=>l.remove()){const l=t(this._enter),u=n(this._update),h=r(this._exit),p=i(this._merge),m=s(this._split);return u.merge(l).merge(h).merge(p).merge(m)}remove(){for(let t=0;t<this._elements.length;t++){const n=this._transitions[t];if(n){const r=Array.isArray(n)?n:[n];Promise.all(r.map(i=>i.finished)).then(()=>{this._elements[t].remove()})}else this._elements[t].remove()}return new pu([],null,this._parent,this._document,void 0,this._transitions)}each(t){for(let n=0;n<this._elements.length;n++){const r=this._elements[n],i=r.__data__;t(i,n,r)}return this}attr(t,n){const r=typeof n!="function"?()=>n:n;return this.each(function(i,s,l){n!==void 0&&(l[t]=r(i,s,l))})}style(t,n){const r=typeof n!="function"?()=>n:n;return this.each(function(i,s,l){n!==void 0&&(l.style[t]=r(i,s,l))})}transition(t){const n=typeof t!="function"?()=>t:t,{_transitions:r}=this;return this.each(function(i,s,l){r[s]=n(i,s,l)})}on(t,n){return this.each(function(r,i,s){s.addEventListener(t,n)}),this}call(t,...n){return t(this,...n),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}}pu.registry={g:ki,rect:pa,circle:bi,path:Mo,text:Oa,ellipse:Ro,image:ao,line:xa,polygon:_o,polyline:Za,html:zo};const gl={BEFORE_RENDER:"beforerender",AFTER_RENDER:"afterrender",BEFORE_PAINT:"beforepaint",AFTER_PAINT:"afterpaint",BEFORE_CHANGE_DATA:"beforechangedata",AFTER_CHANGE_DATA:"afterchangedata",BEFORE_CLEAR:"beforeclear",AFTER_CLEAR:"afterclear",BEFORE_DESTROY:"beforedestroy",AFTER_DESTROY:"afterdestroy",BEFORE_CHANGE_SIZE:"beforechangesize",AFTER_CHANGE_SIZE:"afterchangesize",POINTER_TAP:"pointertap",POINTER_DOWN:"pointerdown",POINTER_UP:"pointerup",POINTER_OVER:"pointerover",POINTER_OUT:"pointerout",POINTER_MOVE:"pointermove",POINTER_ENTER:"pointerenter",POINTER_LEAVE:"pointerleave",POINTER_UPOUTSIDE:"pointerupoutside",DRAG_START:"dragstart",DRAG:"drag",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"DROP",CLICK:"click",DBLCLICK:"dblclick"};var fE=function(e){var t=aE(e);return t.charAt(0).toUpperCase()+t.substring(1)},Zm=fE;function tA(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Q1(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function nA(e){return e=Q1(Math.abs(e)),e?e[1]:NaN}function hE(e,t){return function(n,r){for(var i=n.length,s=[],l=0,u=e[0],h=0;i>0&&u>0&&(h+u+1>r&&(u=Math.max(1,r-h)),s.push(n.substring(i-=u,i+u)),!((h+=u+1)>r));)u=e[l=(l+1)%e.length];return s.reverse().join(t)}}function dE(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var ky=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function J1(e){if(!(t=ky.exec(e)))throw new Error("invalid format: "+e);var t;return new e_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}J1.prototype=e_.prototype;function e_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}e_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function rA(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var t_;function iA(e,t){var n=Q1(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(t_=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Q1(e,Math.max(0,t+s-1))[0]}function pE(e,t){var n=Q1(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var mE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:tA,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>pE(e*100,t),r:pE,s:iA,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function vE(e){return e}var gE=Array.prototype.map,yE=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function oA(e){var t=e.grouping===void 0||e.thousands===void 0?vE:hE(gE.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?vE:dE(gE.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"\u2212":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function p(y){y=J1(y);var b=y.fill,w=y.align,R=y.sign,P=y.symbol,I=y.zero,N=y.width,z=y.comma,Z=y.precision,Y=y.trim,$=y.type;$==="n"?(z=!0,$="g"):mE[$]||(Z===void 0&&(Z=12),Y=!0,$="g"),(I||b==="0"&&w==="=")&&(I=!0,b="0",w="=");var J=P==="$"?n:P==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",ae=P==="$"?r:/[%p]/.test($)?l:"",pe=mE[$],Oe=/[defgprs%]/.test($);Z=Z===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z));function Ve(Ke){var lt=J,Ge=ae,rt,st,ut;if($==="c")Ge=pe(Ke)+Ge,Ke="";else{Ke=+Ke;var jt=Ke<0||1/Ke<0;if(Ke=isNaN(Ke)?h:pe(Math.abs(Ke),Z),Y&&(Ke=rA(Ke)),jt&&+Ke==0&&R!=="+"&&(jt=!1),lt=(jt?R==="("?R:u:R==="-"||R==="("?"":R)+lt,Ge=($==="s"?yE[8+t_/3]:"")+Ge+(jt&&R==="("?")":""),Oe){for(rt=-1,st=Ke.length;++rt<st;)if(ut=Ke.charCodeAt(rt),48>ut||ut>57){Ge=(ut===46?i+Ke.slice(rt+1):Ke.slice(rt))+Ge,Ke=Ke.slice(0,rt);break}}}z&&!I&&(Ke=t(Ke,1/0));var At=lt.length+Ke.length+Ge.length,zt=At<N?new Array(N-At+1).join(b):"";switch(z&&I&&(Ke=t(zt+Ke,zt.length?N-Ge.length:1/0),zt=""),w){case"<":Ke=lt+Ke+Ge+zt;break;case"=":Ke=lt+zt+Ke+Ge;break;case"^":Ke=zt.slice(0,At=zt.length>>1)+lt+Ke+Ge+zt.slice(At);break;default:Ke=zt+lt+Ke+Ge;break}return s(Ke)}return Ve.toString=function(){return y+""},Ve}function m(y,b){var w=p((y=J1(y),y.type="f",y)),R=Math.max(-8,Math.min(8,Math.floor(nA(b)/3)))*3,P=Math.pow(10,-R),I=yE[8+R/3];return function(N){return w(P*N)+I}}return{format:p,formatPrefix:m}}var n_,Wm,aA;sA({thousands:",",grouping:[3],currency:["$",""]});function sA(e){return n_=oA(e),Wm=n_.format,aA=n_.formatPrefix,n_}function E0(e,t){return Object.entries(e).reduce((n,[r,i])=>(n[r]=t(i,r,e),n),{})}function Bv(e){return e.map((t,n)=>n)}function iP(e){const t=e.length,n=e[0].length,r=new Array(n).fill(0).map(()=>new Array(t));for(let i=0;i<n;i++)for(let s=0;s<t;s++)r[i][s]=e[s][i];return r}function lA(e){return e[0]}function _E(e){return e[e.length-1]}function oP(e){return!e.some(Array.isArray)}function cA(e){return Array.from(new Set(e))}function bE(e,t){const n=[[],[]];return e.forEach(r=>{n[t(r)?0:1].push(r)}),n}function xE(e,t=e.length){if(t===1)return e.map(r=>[r]);const n=[];for(let r=0;r<e.length;r++){const i=e.slice(r+1);xE(i,t-1).forEach(l=>{n.push([e[r],...l])})}return n}function uA(e){if(e.length===1)return[e];const t=[];for(let n=1;n<=e.length;n++)t.push(...xE(e,n));return t}var aP=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},Mg=aP,zy=function(e,t){if(e===t)return!0;if(!e||!t||Xo(e)||Xo(t))return!1;if(Mg(e)||Mg(t)){if(e.length!==t.length)return!1;for(var n=!0,r=0;r<e.length&&(n=zy(e[r],t[r]),!!n);r++);return n}if(Ob(e)||Ob(t)){var i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(var n=!0,r=0;r<i.length&&(n=zy(e[i[r]],t[i[r]]),!!n);r++);return n}return!1},EE=zy;function up(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Ol(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function sP(e){return e*Math.PI/180}function lP(e){return e*180/Math.PI}function Uy(e,t){return e=e%(2*Math.PI),t=t%(2*Math.PI),e<0&&(e=2*Math.PI+e),t<0&&(t=2*Math.PI+t),e>=t&&(t=t+2*Math.PI),{startAngle:e,endAngle:t}}const Pg=(e={})=>{const t={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1},n=Object.assign(Object.assign({},t),e);return Object.assign(Object.assign({},n),Uy(n.startAngle,n.endAngle))},jy=e=>{const{startAngle:t,endAngle:n,innerRadius:r,outerRadius:i}=Pg(e);return[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",t,n,r,i]]};jy.props={};const SE=(e={})=>{const t={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},t),e)},Lb=e=>{const{startAngle:t,endAngle:n,innerRadius:r,outerRadius:i}=SE(e);return[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...jy({startAngle:t,endAngle:n,innerRadius:r,outerRadius:i})]};Lb.props={};function Vy(e,t,n){return Math.max(t,Math.min(e,n))}function r_(e,t=10){return typeof e!="number"||Math.abs(e)<1e-15?e:parseFloat(e.toFixed(t))}const fA=[["legendCategory",[[["color","discrete"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["shape","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","discrete"]],[["color","discrete"],["opacity","discrete"],["size","constant"]],[["color","discrete"],["opacity","constant"],["shape","discrete"]],[["color","discrete"],["opacity","constant"],["size","constant"]],[["color","discrete"],["shape","constant"],["size","constant"]],[["color","discrete"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["opacity","constant"],["shape","constant"]],[["color","constant"],["shape","discrete"],["size","constant"]],[["color","constant"],["opacity","discrete"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["size","constant"]],[["color","constant"],["opacity","constant"],["shape","discrete"]],[["color","constant"],["opacity","discrete"],["shape","constant"]],[["color","discrete"],["shape","discrete"]],[["color","discrete"],["size","constant"]],[["color","discrete"],["opacity","discrete"]],[["color","discrete"],["opacity","constant"]],[["color","discrete"],["shape","constant"]],[["color","constant"],["shape","discrete"]],[["color","constant"],["size","constant"]],[["color","constant"],["opacity","discrete"]],[["color","discrete"]]]],["legendContinuousSize",[[["color","continuous"],["opacity","continuous"],["size","continuous"]],[["color","constant"],["opacity","continuous"],["size","continuous"]],[["color","continuous"],["size","continuous"]],[["color","constant"],["size","continuous"]],[["size","continuous"],["opacity","continuous"]],[["size","continuous"]]]],["legendContinuousBlockSize",[[["color","distribution"],["opacity","distribution"],["size","distribution"]],[["color","distribution"],["size","distribution"]]]],["legendContinuousBlock",[[["color","distribution"],["opacity","continuous"]],[["color","distribution"]]]],["legendContinuous",[[["color","continuous"],["opacity","continuous"]],[["color","continuous"]],[["opacity","continuous"]]]]];var TE=D(17816);function pc(e){const{transformations:t}=e.getOptions();return t.map(([r])=>r).filter(r=>r==="transpose").length%2!==0}function Nl(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="polar")}function Hy(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="reflect")&&t.some(([n])=>n.startsWith("transpose"))}function wE(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="helix")}function Zy(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="parallel")}function AE(e){const{transformations:t}=e.getOptions();return t.some(([n])=>n==="fisheye")}function hA(e){return Zy(e)&&Nl(e)}function Ig(e){return wE(e)||Nl(e)}function CE(e){return Nl(e)&&pc(e)}function cP(e){return Nl(e)||Zy(e)||Hy(e)||CE(e)}function dA(e){if(Ig(e)){const[t,n]=e.getSize(),r=e.getOptions().transformations.find(i=>i[0]==="polar");if(r)return Math.max(t,n)/2*r[4]}return 0}function Db(e){const{transformations:t}=e.getOptions(),[,,,n,r]=t.find(i=>i[0]==="polar");return[+n,+r]}function Nb(e,t=!0){const{transformations:n}=e.getOptions(),[,r,i]=n.find(s=>s[0]==="polar");return t?[+r*180/Math.PI,+i*180/Math.PI]:[r,i]}function Bb(e,t){const{transformations:n}=e.getOptions(),[,...r]=n.find(i=>i[0]===t);return r}function OE(e,t){t(e),e.children&&e.children.forEach(function(n){n&&OE(n,t)})}function Wy(e){i_(e,!0)}function cd(e){i_(e,!1)}function i_(e,t){var n=t?"visible":"hidden";OE(e,function(r){r.attr("visibility",n)})}function pA(e){return typeof e=="boolean"?!1:"enter"in e&&"update"in e&&"exit"in e}function RE(e){if(!e)return{enter:!1,update:!1,exit:!1};var t=["enter","update","exit"],n=Object.fromEntries(Object.entries(e).filter(function(r){var i=(0,j.CR)(r,1),s=i[0];return!t.includes(s)}));return Object.fromEntries(t.map(function(r){return pA(e)?e[r]===!1?[r,!1]:[r,(0,j.pi)((0,j.pi)({},e[r]),n)]:[r,n]}))}function Lg(e,t){e?e.finished.then(t):t()}function uP(e,t){e.length===0?t():Promise.all(e.map(function(n){return n==null?void 0:n.finished})).then(t)}function ME(e,t){"update"in e?e.update(t):e.attr(t)}function PE(e,t,n){if(t.length===0)return null;if(!n){var r=t.slice(-1)[0];return ME(e,{style:r}),null}return e.animate(t,n)}function mA(e,t){return!(e.nodeName!=="text"||t.nodeName!=="text"||e.attributes.text!==t.attributes.text)}function vA(e,t,n,r){if(r===void 0&&(r="destroy"),mA(e,t))return e.remove(),[null];var i=function(){r==="destroy"?e.destroy():r==="hide"&&cd(e),t.isVisible()&&Wy(t)};if(!n)return i(),[null];var s=n.duration,l=s===void 0?0:s,u=n.delay,h=u===void 0?0:u,p=Math.ceil(+l/2),m=+l/4,y=(0,j.CR)(e.getGeometryBounds().center,2),b=y[0],w=y[1],R=(0,j.CR)(t.getGeometryBounds().center,2),P=R[0],I=R[1],N=(0,j.CR)([(b+P)/2-b,(w+I)/2-w],2),z=N[0],Z=N[1],Y=e.style.opacity,$=Y===void 0?1:Y,J=t.style.opacity,ae=J===void 0?1:J,pe=e.style.transform||"",Oe=t.style.transform||"",Ve=e.animate([{opacity:$,transform:"translate(0, 0) ".concat(pe)},{opacity:0,transform:"translate(".concat(z,", ").concat(Z,") ").concat(pe)}],(0,j.pi)((0,j.pi)({fill:"both"},n),{duration:h+p+m})),Ke=t.animate([{opacity:0,transform:"translate(".concat(-z,", ").concat(-Z,") ").concat(Oe),offset:.01},{opacity:ae,transform:"translate(0, 0) ".concat(Oe)}],(0,j.pi)((0,j.pi)({fill:"both"},n),{duration:p+m,delay:h+p-m}));return Lg(Ke,i),[Ve,Ke]}function Zp(e,t,n){var r={},i={};return Object.entries(t).forEach(function(s){var l=(0,j.CR)(s,2),u=l[0],h=l[1];if(!(0,Xr.Z)(h)){var p=e.style[u]||e.parsedStyle[u]||0;p!==h&&(r[u]=p,i[u]=h)}}),n?PE(e,[r,i],(0,j.pi)({fill:"both"},n)):(ME(e,i),null)}var gA=5,yA=function(e,t,n,r){n===void 0&&(n=0),r===void 0&&(r=gA),Object.entries(t).forEach(function(i){var s=(0,j.CR)(i,2),l=s[0],u=s[1],h=e;Object.prototype.hasOwnProperty.call(t,l)&&(u?q0(u)?(q0(e[l])||(h[l]={}),n<r?yA(e[l],u,n+1,r):h[l]=t[l]):_s(u)?(h[l]=[],h[l]=h[l].concat(u)):h[l]=u:h[l]=u)})},em=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r+=1)yA(e,t[r]);return e},IE=function(e){(0,j.ZT)(t,e);function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=e.apply(this,(0,j.ev)([],(0,j.CR)(n),!1))||this;return i.isMutationObserved=!0,i.addEventListener(No.INSERTED,function(){cd(i)}),i}return t}(ki);function LE(e){var t=e.appendChild(new IE({class:"offscreen"}));return cd(t),t}function _A(e){for(var t=e;t;){if(t.className==="offscreen")return!0;t=t.parent}return!1}function bA(){i_(this,this.attributes.visibility!=="hidden")}var Mf=function(e){(0,j.ZT)(t,e);function t(n,r){r===void 0&&(r={});var i=e.call(this,em({},{style:r},n))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=LE(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},t.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},t.prototype.attributeChangedCallback=function(n){n==="visibility"&&bA.call(this)},t.prototype.update=function(n,r){var i;return this.attr(em({},this.attributes,n||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},t.prototype.clear=function(){this.removeChildren()},t.prototype.bindEvents=function(n,r){},t.prototype.getSubShapeStyle=function(n){var r=n.x,i=n.y,s=n.transform,l=n.transformOrigin,u=n.class,h=n.className,p=n.zIndex,m=(0,j._T)(n,["x","y","transform","transformOrigin","class","className","zIndex"]);return m},t}(Zi);function Lh(e,t,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(s){s.node().removeChildren()}),e?n(t):(r&&i(t),null)}function xA(e,t){if(e.length<=t)return e;for(var n=Math.floor(e.length/t),r=[],i=0;i<e.length;i+=n)r.push(e[i]);return r}var Fb=function(e){(0,j.ZT)(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=(0,j._T)(n,["style"]);return e.call(this,(0,j.pi)({style:(0,j.pi)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=LE(this)),this._offscreen},enumerable:!1,configurable:!0}),t.prototype.disconnectedCallback=function(){var n;(n=this._offscreen)===null||n===void 0||n.destroy()},t}(Oa);function EA(e,t){var n=new Map;return e.forEach(function(r){var i=t(r);n.has(i)||n.set(i,[]),n.get(i).push(r)}),n}function SA(e){throw new Error(e)}var TA=function(){function e(i,s,l,u,h,p,m){i===void 0&&(i=null),s===void 0&&(s=null),l===void 0&&(l=null),u===void 0&&(u=null),h===void 0&&(h=[null,null,null,null,null]),p===void 0&&(p=[]),m===void 0&&(m=[]),t.add(this),this._elements=Array.from(i),this._data=s,this._parent=l,this._document=u,this._enter=h[0],this._update=h[1],this._exit=h[2],this._merge=h[3],this._split=h[4],this._transitions=p,this._facetElements=m}e.prototype.selectAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new n(s,null,this._elements[0],this._document)},e.prototype.selectFacetAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new n(this._elements,null,this._parent,this._document,void 0,void 0,s)},e.prototype.select=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new n([s],null,s,this._document)},e.prototype.append=function(i){var s=this,l=typeof i=="function"?i:function(){return s.createElement(i)},u=[];if(this._data!==null){for(var h=0;h<this._data.length;h++){var p=this._data[h],m=(0,j.CR)(Array.isArray(p)?p:[p,null],2),y=m[0],b=m[1],w=l(y,h);w.__data__=y,b!==null&&(w.__fromElements__=b),this._parent.appendChild(w),u.push(w)}return new n(u,null,this._parent,this._document)}for(var h=0;h<this._elements.length;h++){var R=this._elements[h],y=R.__data__,w=l(y,h);R.appendChild(w),u.push(w)}return new n(u,null,u[0],this._document)},e.prototype.maybeAppend=function(i,s){var l=(0,j.Q_)(this,t,"m",r).call(this,i[0]==="#"?i:"#".concat(i),s);return l.attr("id",i),l},e.prototype.maybeAppendByClassName=function(i,s){var l=i.toString(),u=(0,j.Q_)(this,t,"m",r).call(this,l[0]==="."?l:".".concat(l),s);return u.attr("className",l),u},e.prototype.maybeAppendByName=function(i,s){var l=(0,j.Q_)(this,t,"m",r).call(this,'[name="'.concat(i,'"]'),s);return l.attr("name",i),l},e.prototype.data=function(i,s,l){var u,h;s===void 0&&(s=function(Ve){return Ve}),l===void 0&&(l=function(){return null});for(var p=[],m=[],y=new Set(this._elements),b=[],w=new Set,R=new Map(this._elements.map(function(Ve,Ke){return[s(Ve.__data__,Ke),Ve]})),P=new Map(this._facetElements.map(function(Ve,Ke){return[s(Ve.__data__,Ke),Ve]})),I=EA(this._elements,function(Ve){return l(Ve.__data__)}),N=0;N<i.length;N++){var z=i[N],Z=s(z,N),Y=l(z,N);if(R.has(Z)){var $=R.get(Z);$.__data__=z,$.__facet__=!1,m.push($),y.delete($),R.delete(Z)}else if(P.has(Z)){var $=P.get(Z);$.__data__=z,$.__facet__=!0,m.push($),P.delete(Z)}else if(I.has(Z)){var J=I.get(Z);b.push([z,J]);try{for(var ae=(u=void 0,(0,j.XA)(J)),pe=ae.next();!pe.done;pe=ae.next()){var $=pe.value;y.delete($)}}catch(Ve){u={error:Ve}}finally{try{pe&&!pe.done&&(h=ae.return)&&h.call(ae)}finally{if(u)throw u.error}}I.delete(Z)}else if(R.has(Y)){var $=R.get(Y);$.__toData__?$.__toData__.push(z):$.__toData__=[z],w.add($),y.delete($)}else p.push(z)}var Oe=[new n([],p,this._parent,this._document),new n(m,null,this._parent,this._document),new n(y,null,this._parent,this._document),new n([],b,this._parent,this._document),new n(w,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,Oe)},e.prototype.merge=function(i){var s=(0,j.ev)((0,j.ev)([],(0,j.CR)(this._elements),!1),(0,j.CR)(i._elements),!1),l=(0,j.ev)((0,j.ev)([],(0,j.CR)(this._transitions),!1),(0,j.CR)(i._transitions),!1);return new n(s,null,this._parent,this._document,void 0,l)},e.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var s=n.registry[i];return s?new s:SA("Unknown node type: ".concat(i))},e.prototype.join=function(i,s,l,u,h){i===void 0&&(i=function(R){return R}),s===void 0&&(s=function(R){return R}),l===void 0&&(l=function(R){return R.remove()}),u===void 0&&(u=function(R){return R}),h===void 0&&(h=function(R){return R.remove()});var p=i(this._enter),m=s(this._update),y=l(this._exit),b=u(this._merge),w=h(this._split);return m.merge(p).merge(y).merge(b).merge(w)},e.prototype.remove=function(){for(var i=function(u){var h=s._elements[u],p=s._transitions[u];p?p.then(function(){return h.remove()}):h.remove()},s=this,l=0;l<this._elements.length;l++)i(l);return new n([],null,this._parent,this._document,void 0,this._transitions)},e.prototype.each=function(i){for(var s=0;s<this._elements.length;s++){var l=this._elements[s],u=l.__data__;i.call(l,u,s)}return this},e.prototype.attr=function(i,s){var l=typeof s!="function"?function(){return s}:s;return this.each(function(u,h){s!==void 0&&(this[i]=l.call(this,u,h))})},e.prototype.style=function(i,s,l){l===void 0&&(l=!0);var u=typeof s!="function"||!l?function(){return s}:s;return this.each(function(h,p){s!==void 0&&(this.style[i]=u.call(this,h,p))})},e.prototype.styles=function(i,s){return i===void 0&&(i={}),s===void 0&&(s=!0),this.each(function(l,u){var h=this;Object.entries(i).forEach(function(p){var m=(0,j.CR)(p,2),y=m[0],b=m[1],w=typeof b!="function"||!s?function(){return b}:b;b!==void 0&&h.attr(y,w.call(h,l,u))})})},e.prototype.update=function(i,s){s===void 0&&(s=!0);var l=typeof i!="function"||!s?function(){return i}:i;return this.each(function(u,h){i&&this.update&&this.update(l.call(this,u,h))})},e.prototype.maybeUpdate=function(i,s){s===void 0&&(s=!0);var l=typeof i!="function"||!s?function(){return i}:i;return this.each(function(u,h){i&&this.update&&this.update(l.call(this,u,h))})},e.prototype.transition=function(i){var s=this._transitions;return this.each(function(l,u){s[u]=i.call(this,l,u)})},e.prototype.on=function(i,s){return this.each(function(){this.addEventListener(i,s)}),this},e.prototype.call=function(i){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return i.call.apply(i,(0,j.ev)([this._parent,this],(0,j.CR)(s),!1)),this},e.prototype.node=function(){return this._elements[0]},e.prototype.nodes=function(){return this._elements},e.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},e.prototype.parent=function(){return this._parent};var t,n,r;return n=e,t=new WeakSet,r=function(s,l){var u=this._elements[0],h=u.querySelector(s);if(h)return new n([h],null,this._parent,this._document);var p=typeof l=="string"?this.createElement(l):l();return u.appendChild(p),new n([p],null,this._parent,this._document)},e.registry={g:ki,rect:pa,circle:bi,path:Mo,text:Fb,ellipse:Ro,image:ao,line:xa,polygon:_o,polyline:Za,html:zo},e}();function es(e){return new TA([e],null,e,e.ownerDocument)}function wA(e,t,n){return e.querySelector(t)?es(e).select(t):es(e).append(n)}var fp=function(e,t){var n=function(i){return"".concat(t,"-").concat(i)},r=Object.fromEntries(Object.entries(e).map(function(i){var s=(0,j.CR)(i,2),l=s[0],u=s[1],h=n(u);return[l,{name:h,class:".".concat(h),id:"#".concat(h),toString:function(){return h}}]}));return Object.assign(r,{prefix:n}),r},DE={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Mo({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},fP=ri({},DE,{style:{type:"arc"}}),NE=ri({},DE,{style:{}}),Bl=fp({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),Dh=function(e){return typeof e=="function"};function tm(e,t){return[e[0]*t,e[1]*t]}function Gy(e,t){return[e[0]+t[0],e[1]+t[1]]}function kb(e,t){return[e[0]-t[0],e[1]-t[1]]}function Fv(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]}function S0(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}function Xy(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function BE(e){if(e[0]===0&&e[1]===0)return[0,0];var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return[e[0]/t,e[1]/t]}function hP(e,t,n){var r=__read(e,2),i=r[0],s=r[1],l=__read(t,2),u=l[0],h=l[1],p=i-u,m=s-h,y=Math.sin(n),b=Math.cos(n);return[p*b-m*y+u,p*y+m*b+h]}function AA(e,t){return t?[e[1],-e[0]]:[-e[1],e[0]]}function Yy(e){return e*Math.PI/180}function CA(e){return Number((e*180/Math.PI).toPrecision(5))}function zb(e){return e.toString().charAt(0).toUpperCase()+e.toString().slice(1)}function OA(e){return e.toString().charAt(0).toLowerCase()+e.toString().slice(1)}function dP(e,t){return"".concat(t).concat(zb(e))}function FE(e,t,n){var r;n===void 0&&(n=!0);var i=t||((r=e.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",s=e.replace(new RegExp("^(".concat(i,")")),"");return n?OA(s):s}function RA(e,t){Object.entries(t).forEach(function(n){var r=(0,j.CR)(n,2),i=r[0],s=r[1];(0,j.ev)([e],(0,j.CR)(e.querySelectorAll(i)),!1).filter(function(l){return l.matches(i)}).forEach(function(l){if(l){var u=l;u.style.cssText+=Object.entries(s).reduce(function(h,p){return"".concat(h).concat(p.join(":"),";")},"")}})})}var o_=function(e,t){if(!(e!=null&&e.startsWith(t)))return!1;var n=e[t.length];return n>="A"&&n<="Z"};function Os(e,t,n){n===void 0&&(n=!1);var r={};return Object.entries(e).forEach(function(i){var s=(0,j.CR)(i,2),l=s[0],u=s[1];if(!(l==="className"||l==="class")){if(o_(l,"show")&&o_(FE(l,"show"),t)!==n)l===dP(t,"show")?r[l]=u:r[l.replace(new RegExp(zb(t)),"")]=u;else if(!o_(l,"show")&&o_(l,t)!==n){var h=FE(l,t);h==="filter"&&typeof u=="function"||(r[h]=u)}}}),r}function T0(e,t){return Object.entries(e).reduce(function(n,r){var i=(0,j.CR)(r,2),s=i[0],l=i[1];return s.startsWith("show")?n["show".concat(t).concat(s.slice(4))]=l:n["".concat(t).concat(zb(s))]=l,n},{})}function w0(e,t){t===void 0&&(t=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(e).forEach(function(s){var l=(0,j.CR)(s,2),u=l[0],h=l[1];t.includes(u)||(n.indexOf(u)!==-1?i[u]=h:r[u]=h)}),[r,i]}function ud(e,t){return Dh(e)?e.apply(void 0,(0,j.ev)([],(0,j.CR)(t),!1)):e}function a_(e,t){return e.style.opacity||(e.style.opacity=1),Zp(e,{opacity:0},t)}var MA=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function kE(e){return MA.includes(e)}function Ub(e){var t={};for(var n in e)kE(n)&&(t[n]=e[n]);return t}var Dg=fp({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function zE(e){return e.reduce(function(t,n,r){return t.push((0,j.ev)([r===0?"M":"L"],(0,j.CR)(n),!1)),t},[])}function UE(e,t,n){var r=t.connect,i=r===void 0?"line":r,s=t.center;if(i==="line")return zE(e);if(!s)return[];var l=Xy(e[0],s),u=n?0:1;return e.reduce(function(h,p,m){return m===0?h.push((0,j.ev)(["M"],(0,j.CR)(p),!1)):h.push((0,j.ev)(["A",l,l,0,0,u],(0,j.CR)(p),!1)),h},[])}function Ng(e,t,n){return t.type==="surround"?UE(e,t,n):zE(e)}function PA(e,t,n){var r=n.type,i=n.connect,s=n.center,l=n.closed,u=l?[["Z"]]:[],h=(0,j.CR)([Ng(e,n),Ng(t.slice().reverse(),n,!0)],2),p=h[0],m=h[1],y=(0,j.CR)([e[0],t.slice(-1)[0]],2),b=y[0],w=y[1],R=function(z,Z){return[p,z,m,Z,u].flat()};if(i==="line"||r==="surround")return R([(0,j.ev)(["L"],(0,j.CR)(w),!1)],[(0,j.ev)(["L"],(0,j.CR)(b),!1)]);if(!s)throw new Error("Arc grid need to specified center");var P=(0,j.CR)([Xy(w,s),Xy(b,s)],2),I=P[0],N=P[1];return R([(0,j.ev)(["A",I,I,0,0,1],(0,j.CR)(w),!1),(0,j.ev)(["L"],(0,j.CR)(w),!1)],[(0,j.ev)(["A",N,N,0,0,0],(0,j.CR)(b),!1),(0,j.ev)(["L"],(0,j.CR)(b),!1)])}function Bg(e,t,n,r){var i=n.animate,s=n.isBillboard,l=t.map(function(u,h){return{id:u.id||"grid-line-".concat(h),d:Ng(u.points,n)}});return e.selectAll(Dg.line.class).data(l,function(u){return u.id}).join(function(u){return u.append("path").each(function(h,p){var m=ud(Ub((0,j.pi)({d:h.d},r)),[h,p,l]);this.attr((0,j.pi)({class:Dg.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:s},m))})},function(u){return u.transition(function(h,p){var m=ud(Ub((0,j.pi)({d:h.d},r)),[h,p,l]);return Zp(this,m,i.update)})},function(u){return u.transition(function(){var h=this,p=a_(this,i.exit);return Lg(p,function(){return h.remove()}),p})}).transitions()}function IA(e,t,n){var r=n.animate,i=n.connect,s=n.areaFill;if(t.length<2||!s||!i)return[];for(var l=Array.isArray(s)?s:[s,"transparent"],u=function(R){return l[R%l.length]},h=[],p=0;p<t.length-1;p++){var m=(0,j.CR)([t[p].points,t[p+1].points],2),y=m[0],b=m[1],w=PA(y,b,n);h.push({d:w,fill:u(p)})}return e.selectAll(Dg.region.class).data(h,function(R,P){return P}).join(function(R){return R.append("path").each(function(P,I){var N=ud(P,[P,I,h]);this.attr(N)}).attr("className",Dg.region.name)},function(R){return R.transition(function(P,I){var N=ud(P,[P,I,h]);return Zp(this,N,r.update)})},function(R){return R.transition(function(){var P=this,I=a_(this,r.exit);return Lg(I,function(){return P.remove()}),I})}).transitions()}function LA(e){var t=e.data,n=t===void 0?[]:t,r=e.closed;return r?n.map(function(i){var s=i.points,l=(0,j.CR)(s,1),u=l[0];return(0,j.pi)((0,j.pi)({},i),{points:(0,j.ev)((0,j.ev)([],(0,j.CR)(s),!1),[u],!1)})}):n}var DA=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(n,r){var i=n.type,s=n.center,l=n.areaFill,u=n.closed,h=(0,j._T)(n,["type","center","areaFill","closed"]),p=LA(n),m=es(r).maybeAppendByClassName(Dg.lineGroup,"g"),y=es(r).maybeAppendByClassName(Dg.regionGroup,"g"),b=Bg(m,p,n,h),w=IA(y,p,n);return(0,j.ev)((0,j.ev)([],(0,j.CR)(b),!1),(0,j.CR)(w),!1)},t}(Mf),ol=function(e,t,n){for(var r=0,i=Xo(t)?t.split("."):t;e&&r<i.length;)e=e[i[r++]];return e===void 0||r<i.length?n:e},hp=function(e,t){return function(n){return e*(1-n)+t*n}};function Fg(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0;return function(i){var s=new Array(r),l=new Array(n),u=0;for(u=0;u<r;++u)s[u]=go(e[u],t[u]);for(;u<n;++u)l[u]=t[u];for(u=0;u<r;++u)l[u]=s[u](i);return l}}function NA(e,t){e===void 0&&(e={}),t===void 0&&(t={});var n={},r={};return Object.entries(t).forEach(function(i){var s=(0,j.CR)(i,2),l=s[0],u=s[1];l in e?n[l]=go(e[l],u):r[l]=u}),function(i){return Object.entries(n).forEach(function(s){var l=(0,j.CR)(s,2),u=l[0],h=l[1];return r[u]=h(i)}),r}}function go(e,t){return typeof e=="number"&&typeof t=="number"?hp(e,t):Array.isArray(e)&&Array.isArray(t)?Fg(e,t):typeof e=="object"&&typeof t=="object"?NA(e,t):function(n){return e}}function BA(e,t,n,r){if(!r)return e.attr("__keyframe_data__",n),null;var i=r.duration,s=i===void 0?0:i,l=go(t,n),u=Math.ceil(+s/16),h=new Array(u).fill(0).map(function(p,m,y){return{__keyframe_data__:l(m/(y.length-1))}});return e.animate(h,(0,j.pi)({fill:"both"},r))}function Gm(e){return typeof e=="function"?e():Xo(e)||(0,dr.Z)(e)?new Fb({style:{text:String(e)}}):e}function An(e,t,n){n===void 0&&(n=!1);var r=e.getBBox(),i=r.width,s=r.height,l=t/Math.max(i,s);return n&&(e.style.transform="scale(".concat(l,")")),l}function Bs(e,t){var n={},r=Array.isArray(t)?t:[t];for(var i in e)r.includes(i)||(n[i]=e[i]);return n}function $a(e,t){return Object.fromEntries(Object.entries(e).map(function(n){var r=(0,j.CR)(n,2),i=r[0],s=r[1];return[i,ud(s,t)]}))}function s_(e){if(e.type==="linear"){var t=e.startPos,n=e.endPos;return __spreadArray(__spreadArray([],__read(t),!1),__read(n),!1)}var r=e.startAngle,i=e.endAngle,s=e.center,l=e.radius;return __spreadArray(__spreadArray([r,i],__read(s),!1),[l],!1)}function hh(e,t){return t&&Dh(t)?e.filter(t):e}function fs(e,t){var n=t.startAngle,r=t.endAngle;return(r-n)*e+n}function mu(e,t){if(t.type==="linear"){var n=(0,j.CR)(t.startPos,2),r=n[0],i=n[1],s=(0,j.CR)(t.endPos,2),l=s[0],u=s[1],h=(0,j.CR)([l-r,u-i],2),p=h[0],m=h[1];return BE([p,m])}var y=Yy(fs(e,t));return[-Math.sin(y),Math.cos(y)]}function Zf(e,t,n){var r=mu(e,n);return AA(r,t!=="positive")}function tc(e,t){return Zf(e,t.labelDirection,t)}function Wu(e,t){var n=(0,j.CR)(t.startPos,2),r=n[0],i=n[1],s=(0,j.CR)(t.endPos,2),l=s[0],u=s[1],h=(0,j.CR)([l-r,u-i],2),p=h[0],m=h[1];return[r+p*e,i+m*e]}function vu(e,t){var n=t.radius,r=(0,j.CR)(t.center,2),i=r[0],s=r[1],l=Yy(fs(e,t));return[i+n*Math.cos(l),s+n*Math.sin(l)]}function al(e,t){return t.type==="linear"?Wu(e,t):vu(e,t)}function dp(e){return mu(0,e)[1]===0}function Xm(e){return mu(0,e)[0]===0}function jb(e,t){return t-e===360}function ss(e,t,n,r,i){var s=t-e,l=(0,j.CR)([i,i],2),u=l[0],h=l[1],p=(0,j.CR)([Yy(e),Yy(t)],2),m=p[0],y=p[1],b=function(Ve){return[n+i*Math.cos(Ve),r+i*Math.sin(Ve)]},w=(0,j.CR)(b(m),2),R=w[0],P=w[1],I=(0,j.CR)(b(y),2),N=I[0],z=I[1];if(jb(e,t)){var Z=(y+m)/2,Y=(0,j.CR)(b(Z),2),$=Y[0],J=Y[1];return[["M",R,P],["A",u,h,0,1,0,$,J],["A",u,h,0,1,0,N,z]]}var ae=s>180?1:0,pe=e>t?0:1,Oe=!1;return Oe?"M".concat(n,",").concat(r,",L").concat(R,",").concat(P,",A").concat(u,",").concat(h,",0,").concat(ae,",").concat(pe,",").concat(N,",").concat(z,",L").concat(n,",").concat(r):"M".concat(R,",").concat(P,",A").concat(u,",").concat(h,",0,").concat(ae,",").concat(pe,",").concat(N,",").concat(z)}function Wf(e){var t=e.attributes,n=t.startAngle,r=t.endAngle,i=t.center,s=t.radius;return(0,j.ev)((0,j.ev)([n,r],(0,j.CR)(i),!1),[s],!1)}function hf(e,t,n,r){var i=t.startAngle,s=t.endAngle,l=t.center,u=t.radius;return e.selectAll(Bl.line.class).data([{d:ss.apply(void 0,(0,j.ev)((0,j.ev)([i,s],(0,j.CR)(l),!1),[u],!1))}],function(h,p){return p}).join(function(h){return h.append("path").attr("className",Bl.line.name).styles(t).styles({d:function(p){return p.d}})},function(h){return h.transition(function(){var p=this,m=BA(this,Wf(this),(0,j.ev)((0,j.ev)([i,s],(0,j.CR)(l),!1),[u],!1),r.update);if(m){var y=function(){var b=ol(p.attributes,"__keyframe_data__");p.style.d=ss.apply(void 0,(0,j.ev)([],(0,j.CR)(b),!1))};m.onframe=y,m.onfinish=y}return m}).styles(t)},function(h){return h.remove()}).styles(n).transitions()}function Mc(e,t){var n=t.truncRange,r=t.truncShape,i=t.lineExtension}function pP(e,t,n){n===void 0&&(n=[0,0]);var r=(0,j.CR)([e,t,n],3),i=(0,j.CR)(r[0],2),s=i[0],l=i[1],u=(0,j.CR)(r[1],2),h=u[0],p=u[1],m=(0,j.CR)(r[2],2),y=m[0],b=m[1],w=(0,j.CR)([h-s,p-l],2),R=w[0],P=w[1],I=Math.sqrt(Math.pow(R,2)+Math.pow(P,2)),N=(0,j.CR)([-y/I,b/I],2),z=N[0],Z=N[1];return[z*R,z*P,Z*R,Z*P]}function mc(e){var t=(0,j.CR)(e,2),n=(0,j.CR)(t[0],2),r=n[0],i=n[1],s=(0,j.CR)(t[1],2),l=s[0],u=s[1];return{x1:r,y1:i,x2:l,y2:u}}function Wp(e,t,n,r){var i=t.showTrunc,s=t.startPos,l=t.endPos,u=t.truncRange,h=t.lineExtension,p=(0,j.CR)([s,l],2),m=(0,j.CR)(p[0],2),y=m[0],b=m[1],w=(0,j.CR)(p[1],2),R=w[0],P=w[1],I=(0,j.CR)(h?pP(s,l,h):new Array(4).fill(0),4),N=I[0],z=I[1],Z=I[2],Y=I[3],$=function(At){return e.selectAll(Bl.line.class).data(At,function(zt,wn){return wn}).join(function(zt){return zt.append("line").attr("className",function(wn){return"".concat(Bl.line.name," ").concat(wn.className)}).styles(n).transition(function(wn){return Zp(this,mc(wn.line),!1)})},function(zt){return zt.styles(n).transition(function(wn){var Hn=wn.line;return Zp(this,mc(Hn),r.update)})},function(zt){return zt.remove()}).transitions()};if(!i||!u)return $([{line:[[y+N,b+z],[R+Z,P+Y]],className:Bl.line.name}]);var J=(0,j.CR)(u,2),ae=J[0],pe=J[1],Oe=R-y,Ve=P-b,Ke=(0,j.CR)([y+Oe*ae,b+Ve*ae],2),lt=Ke[0],Ge=Ke[1],rt=(0,j.CR)([y+Oe*pe,b+Ve*pe],2),st=rt[0],ut=rt[1],jt=$([{line:[[y+N,b+z],[lt,Ge]],className:Bl.lineFirst.name},{line:[[st,ut],[R+Z,P+Y]],className:Bl.lineSecond.name}]);return Mc(e,t),jt}function kg(e,t,n,r){var i=n.showArrow,s=n.showTrunc,l=n.lineArrow,u=n.lineArrowOffset,h=n.lineArrowSize,p;if(t==="arc"?p=e.select(Bl.line.class):s?p=e.select(Bl.lineSecond.class):p=e.select(Bl.line.class),!i||!l||n.type==="arc"&&jb(n.startAngle,n.endAngle)){var m=p.node();m&&(m.style.markerEnd=void 0);return}var y=Gm(l);y.attr(r),An(y,h,!0),p.style("markerEnd",y).style("markerEndOffset",-u)}function l_(e,t,n){var r=t.type,i,s=Os(t,"line");return r==="linear"?i=Wp(e,t,Bs(s,"arrow"),n):i=hf(e,t,Bs(s,"arrow"),n),kg(e,r,t,s),i}function oi(e,t){return Zf(e,t.gridDirection,t)}function Ao(e){var t=e.type,n=e.gridCenter;return t==="linear"?n:n||e.center}function mP(e,t){var n=t.gridLength;return e.map(function(r,i){var s=r.value,l=(0,j.CR)(al(s,t),2),u=l[0],h=l[1],p=(0,j.CR)(tm(oi(s,t),n),2),m=p[0],y=p[1];return{id:i,points:[[u,h],[u+m,h+y]]}})}function ho(e,t){var n=t.gridControlAngles,r=Ao(t);if(!r)throw new Error("grid center is not provide");if(e.length<2)throw new Error("Invalid grid data");if(!n||n.length===0)throw new Error("Invalid gridControlAngles");var i=(0,j.CR)(r,2),s=i[0],l=i[1];return e.map(function(u,h){var p=u.value,m=(0,j.CR)(al(p,t),2),y=m[0],b=m[1],w=(0,j.CR)([y-s,b-l],2),R=w[0],P=w[1],I=[];return n.forEach(function(N){var z=Yy(N),Z=(0,j.CR)([Math.cos(z),Math.sin(z)],2),Y=Z[0],$=Z[1],J=R*Y-P*$+s,ae=R*$+P*Y+l;I.push([J,ae])}),{points:I,id:h}})}function ra(e,t,n,r){var i=Os(n,"grid"),s=i.type,l=i.areaFill,u=Ao(n),h=hh(t,n.gridFilter),p=s==="segment"?mP(h,n):ho(h,n),m=(0,j.pi)((0,j.pi)({},i),{center:u,areaFill:Dh(l)?h.map(function(y,b){return ud(l,[y,b,h])}):l,animate:r,data:p});return e.selectAll(Bl.grid.class).data([1]).join(function(y){return y.append(function(){return new DA({style:m})}).attr("className",Bl.grid.name)},function(y){return y.transition(function(){return this.update(m)})},function(y){return y.remove()}).transitions()}function Yn(e,t,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&e===t||i&&e===n?!0:e>t&&e<n}function c_(e){var t,n,r,i=e||1;function s(u,h){++t>i&&(r=n,l(1),++t),n[u]=h}function l(u){t=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var h=n[u];if(h!==void 0)return h;if((h=r[u])!==void 0)return s(u,h),h},set:function(u,h){n[u]!==void 0?n[u]=h:s(u,h)}}}var A0=function(e,t,n){if(n===void 0&&(n=128),!Dh(e))throw new TypeError("Expected a function");var r=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var l=t?t.apply(this,i):i[0],u=r.cache;if(u.has(l))return u.get(l);var h=e.apply(this,i);return u.set(l,h),h};return r.cache=c_(n),r},nm,u_;function FA(e){u_=e}var vP=A0(function(e,t){var n=t.fontSize,r=t.fontFamily,i=t.fontWeight,s=t.fontStyle,l=t.fontVariant;return u_?u_(e,n):(nm||(nm=M.offscreenCanvasCreator.getOrCreateContext(void 0)),nm.font=[s,l,i,"".concat(n,"px"),r].join(" "),nm.measureText(e).width)},function(e,t){return[e,Object.values(t||jE(e)).join()].join("")},4096),jE=function(e){var t=e.style.fontFamily||"sans-serif",n=e.style.fontWeight||"normal",r=e.style.fontStyle||"normal",i=e.style.fontVariant,s=e.style.fontSize;return s=typeof s=="object"?s.value:s,{fontSize:s,fontFamily:t,fontWeight:n,fontStyle:r,fontVariant:i}};function kA(e){return e.nodeName==="text"?e:e.nodeName==="g"&&e.children.length===1&&e.children[0].nodeName==="text"?e.children[0]:null}function zA(e,t){var n=kA(e);n&&n.attr(t)}function f_(e,t,n){n===void 0&&(n="..."),zA(e,{wordWrap:!0,wordWrapWidth:t,maxLines:1,textOverflow:n})}function Wa(e,t,n,r){n===void 0&&(n=2),r===void 0&&(r="top"),zA(e,{wordWrap:!0,wordWrapWidth:t,maxLines:n,textBaseline:r})}function kv(e,t,n){var r=e.getBBox(),i=r.width,s=r.height,l=(0,j.CR)([t,n].map(function(p,m){var y;return p.includes("%")?parseFloat(((y=p.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||y===void 0?void 0:y[0])||"0")/100*(m===0?i:s):p}),2),u=l[0],h=l[1];return[u,h]}function Vb(e,t){if(t)try{var n=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=t.replace(n,function(i,s,l){return"translate(".concat(kv(e,s,l),")")});e.attr("transform",r)}catch(i){}}var Hb=function(e){return e!==void 0&&e!=null&&!Number.isNaN(e)};function Pf(e){if((0,dr.Z)(e))return[e,e,e,e];if(_s(e)){var t=e.length;if(t===1)return[e[0],e[0],e[0],e[0]];if(t===2)return[e[0],e[1],e[0],e[1]];if(t===3)return[e[0],e[1],e[2],e[1]];if(t===4)return e}return[0,0,0,0]}var zv=function(){function e(t,n,r,i){this.set(t,n,r,i)}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),e.prototype.rotatedPoints=function(t,n,r){var i=this,s=i.x1,l=i.y1,u=i.x2,h=i.y2,p=Math.cos(t),m=Math.sin(t),y=n-n*p+r*m,b=r-n*m-r*p,w=[[p*s-m*h+y,m*s+p*h+b],[p*u-m*h+y,m*u+p*h+b],[p*s-m*l+y,m*s+p*l+b],[p*u-m*l+y,m*u+p*l+b]];return w},e.prototype.set=function(t,n,r,i){return r<t?(this.x2=t,this.x1=r):(this.x1=t,this.x2=r),i<n?(this.y2=n,this.y1=i):(this.y1=n,this.y2=i),this},e.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},e}();function Uv(e,t){var n=e.getEulerAngles()||0;e.setEulerAngles(0);var r=e.getBounds(),i=(0,j.CR)(r.min,2),s=i[0],l=i[1],u=(0,j.CR)(r.max,2),h=u[0],p=u[1],m=e.getBBox(),y=m.width,b=m.height,w=b,R=0,P=0,I=s,N=l,z=kA(e);if(z){w-=1.5;var Z=z.style.textAlign,Y=z.style.textBaseline;Z==="center"?I=(s+h)/2:(Z==="right"||Z==="end")&&(I=h),Y==="middle"?N=(l+p)/2:Y==="bottom"&&(N=p)}var $=(0,j.CR)(Pf(t),4),J=$[0],ae=J===void 0?0:J,pe=$[1],Oe=pe===void 0?0:pe,Ve=$[2],Ke=Ve===void 0?ae:Ve,lt=$[3],Ge=lt===void 0?Oe:lt,rt=new zv((R+=s)-Ge,(P+=l)-ae,R+y+Oe,P+w+Ke);return e.setEulerAngles(n),rt.rotatedPoints(Yy(n),I,N)}function h_(e,t){return t[0]<=Math.max(e[0][0],e[1][0])&&t[0]<=Math.min(e[0][0],e[1][0])&&t[1]<=Math.max(e[0][1],e[1][1])&&t[1]<=Math.min(e[0][1],e[1][1])}function $y(e,t,n){var r=(t[1]-e[1])*(n[0]-t[0])-(t[0]-e[0])*(n[1]-t[1]);return r===0?0:r<0?2:1}function gP(e,t){var n=$y(e[0],e[1],t[0]),r=$y(e[0],e[1],t[1]),i=$y(t[0],t[1],e[0]),s=$y(t[0],t[1],e[1]);return!!(n!==r&&i!==s||n===0&&h_(e,t[0])||r===0&&h_(e,t[1])||i===0&&h_(t,e[0])||s===0&&h_(t,e[1]))}function zg(e,t){var n=e.length;if(n<3)return!1;var r=[t,[9999,t[1]]],i=0,s=0;do{var l=[e[s],e[(s+1)%n]];if(gP(l,r)){if($y(l[0],t,l[1])===0)return h_(l,t);i++}s=(s+1)%n}while(s!==0);return!!(i&1)}function yP(e,t){return t.every(function(n){return zg(e,n)})}function _P(e,t,n){var r=e.x1,i=e.x2,s=e.y1,l=e.y2,u=[[r,s],[i,s],[i,l],[r,l]],h=Uv(t,n);return yP(u,h)}function VE(e,t){var n=(0,j.CR)(e,4),r=n[0],i=n[1],s=n[2],l=n[3],u=(0,j.CR)(t,4),h=u[0],p=u[1],m=u[2],y=u[3],b=s-r,w=l-i,R=m-h,P=y-p,I=b*P-R*w;if(I===0)return!1;var N=I>0,z=r-h,Z=i-p,Y=b*Z-w*z;if(Y<0===N)return!1;var $=R*Z-P*z;return!($<0===N||Y>I===N||$>I===N)}function UA(e,t){var n=[[e[0],e[1],e[2],e[3]],[e[2],e[3],e[4],e[5]],[e[4],e[5],e[6],e[7]],[e[6],e[7],e[0],e[1]]];return n.some(function(r){return VE(t,r)})}var Pk={lineToLine:VE,intersectBoxLine:UA,getBounds:Uv};function bP(e,t,n){var r,i,s=Uv(e,n).flat(1),l=Uv(t,n).flat(1),u=[[s[0],s[1],s[2],s[3]],[s[0],s[1],s[4],s[5]],[s[4],s[5],s[6],s[7]],[s[2],s[3],s[6],s[7]]];try{for(var h=(0,j.XA)(u),p=h.next();!p.done;p=h.next()){var m=p.value;if(UA(l,m))return!0}}catch(y){r={error:y}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return!1}function d_(e,t){var n=e.type,r=e.labelDirection,i=e.crossSize;if(!i)return!1;if(n==="arc"){var s=e.center,l=e.radius,u=(0,j.CR)(s,2),h=u[0],p=u[1],m=r==="negative"?0:i,y=-l-m,b=l+m,w=(0,j.CR)(Pf(t),4),R=w[0],P=w[1],I=w[2],N=w[3];return new zv(h+y-N,p+y-R,h+b+P,p+b+I)}var z=(0,j.CR)(e.startPos,2),Z=z[0],Y=z[1],$=(0,j.CR)(e.endPos,2),J=$[0],ae=$[1],pe=(0,j.CR)(Xm(e)?[-t,0,t,0]:[0,t,0,-t],4),Oe=pe[0],Ve=pe[1],Ke=pe[2],lt=pe[3],Ge=tc(0,e),rt=tm(Ge,i),st=new zv(Z,Y,J,ae);return st.x1+=lt,st.y1+=Oe,st.x2+=Ve+rt[0],st.y2+=Ke+rt[1],st}function Gp(e,t,n){var r,i,s=t.crossPadding,l=new Set,u=null,h=d_(t,s),p=function(R){return h?_P(h,R):!0},m=function(R,P){return!R||!R.firstChild?!0:!bP(R.firstChild,P.firstChild,Pf(n))};try{for(var y=(0,j.XA)(e),b=y.next();!b.done;b=y.next()){var w=b.value;p(w)?!u||m(u,w)?u=w:(l.add(u),l.add(w)):l.add(w)}}catch(R){r={error:R}}finally{try{b&&!b.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}return Array.from(l)}function Zb(e,t){return t===void 0&&(t={}),(0,Xr.Z)(e)?0:typeof e=="number"?e:Math.floor(vP(e,t))}function xP(e,t,n,r){if(!(e.length<=1)){var i=t.suffix,s=i===void 0?"...":i,l=t.minLength,u=t.maxLength,h=u===void 0?1/0:u,p=t.step,m=p===void 0?" ":p,y=t.margin,b=y===void 0?[0,0,0,0]:y,w=jE(r.getTextShape(e[0])),R=Zb(m,w),P=l?Zb(l,w):R,I=Zb(h,w);((0,Xr.Z)(I)||I===1/0)&&(I=Math.max.apply(null,e.map(function(rt){return rt.getBBox().width})));for(var N=e.slice(),z=(0,j.CR)(b,4),Z=z[0],Y=Z===void 0?0:Z,$=z[1],J=$===void 0?0:$,ae=z[2],pe=ae===void 0?Y:ae,Oe=z[3],Ve=Oe===void 0?J:Oe,Ke=function(rt){if(N.forEach(function(st){r.ellipsis(r.getTextShape(st),rt,s)}),N=Gp(e,n,b),N.length<1)return{value:void 0}},lt=I;lt>P+R;lt-=R){var Ge=Ke(lt);if(typeof Ge=="object")return Ge.value}}}function Wb(e){var t=e&&e.getRenderBounds();if(!t)return{width:0,height:0};var n=t.getMax(),r=t.getMin();return{width:n[0]-r[0],height:n[1]-r[1]}}function jA(e){var t=e.getLocalBounds(),n=t.min,r=t.max,i=(0,j.CR)([n,r],2),s=(0,j.CR)(i[0],2),l=s[0],u=s[1],h=(0,j.CR)(i[1],2),p=h[0],m=h[1];return{x:l,y:u,width:p-l,height:m-u,left:l,bottom:m,top:u,right:p}}function EP(e,t){var n=select(e).append("text").node();return n.attr(__assign(__assign({},t),{visibility:"hidden"})),n}function SP(e,t){var n=(0,j.CR)(e,2),r=n[0],i=n[1],s=(0,j.CR)(t,2),l=s[0],u=s[1];return r!==l&&i===u}function Ik(e,t){var n=__read(e,2),r=n[0],i=n[1],s=__read(t,2),l=s[0],u=s[1];return r===l&&i!==u}function VA(e,t){var n,r,i=t.attributes;try{for(var s=(0,j.XA)(Object.entries(i)),l=s.next();!l.done;l=s.next()){var u=(0,j.CR)(l.value,2),h=u[0],p=u[1];h!=="id"&&h!=="className"&&e.attr(h,p)}}catch(m){n={error:m}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}var HA={parity:function(e,t){var n=t.seq,r=n===void 0?2:n;return e.filter(function(i,s){return s%r?(cd(i),!1):!0})}},ZA=function(e){return e.filter(Hb)};function TP(e,t,n,r){var i=e.length,s=t.keepHeader,l=t.keepTail;if(!(i<=1||i===2&&s&&l)){var u=HA.parity,h=function(Z){return Z.forEach(r.show),Z},p=2,m=e.slice(),y=e.slice(),b=Math.min.apply(Math,(0,j.ev)([1],(0,j.CR)(e.map(function(Z){return Z.getBBox().width})),!1));if(n.type==="linear"&&(dp(n)||Xm(n))){var w=jA(e[0]).left,R=jA(e[i-1]).right,P=Math.abs(R-w)||1;p=Math.max(Math.floor(i*b/P),p)}var I,N;for(s&&(I=m.splice(0,1)[0]),l&&(N=m.splice(-1,1)[0],m.reverse()),h(m);p<e.length&&Gp(ZA(N?(0,j.ev)((0,j.ev)([N],(0,j.CR)(y),!1),[I],!1):(0,j.ev)([I],(0,j.CR)(y),!1)),n,t==null?void 0:t.margin).length;){if(N&&!I&&p%2===0){var z=m.splice(0,1);z.forEach(r.hide)}else if(N&&I){var z=m.splice(0,1);z.forEach(r.hide)}y=u(h(m),{seq:p}),p++}}}function HE(e,t,n,r){var i,s,l=t.optionalAngles,u=l===void 0?[0,45,90]:l,h=t.margin,p=t.recoverWhenFailed,m=p===void 0?!0:p,y=e.map(function(N){return N.getLocalEulerAngles()}),b=function(){return Gp(e,n,h).length<1},w=function(N){return e.forEach(function(z,Z){var Y=Array.isArray(N)?N[Z]:N;r.rotate(z,+Y)})};try{for(var R=(0,j.XA)(u),P=R.next();!P.done;P=R.next()){var I=P.value;if(w(I),b())return}}catch(N){i={error:N}}finally{try{P&&!P.done&&(s=R.return)&&s.call(R)}finally{if(i)throw i.error}}m&&w(y)}function p_(e){var t=e.type,n=e.labelDirection;return t==="linear"&&dp(e)?n==="negative"?"bottom":"top":"middle"}function ZE(e,t,n,r){var i=t.wordWrapWidth,s=i===void 0?50:i,l=t.maxLines,u=l===void 0?3:l,h=t.recoverWhenFailed,p=h===void 0?!0:h,m=t.margin,y=m===void 0?[0,0,0,0]:m,b=e.map(function(z){return z.attr("maxLines")||1}),w=Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(b),!1)),R=function(){return Gp(e,n,y).length<1},P=p_(n),I=function(z){return e.forEach(function(Z,Y){var $=Array.isArray(z)?z[Y]:z;r.wrap(Z,s,$,P)})};if(!(w>u)){for(var N=w;N<=u;N++)if(I(N),R())return;p&&I(b)}}var Gb=new Map([["hide",TP],["rotate",HE],["ellipsis",xP],["wrap",ZE]]);function WA(e,t,n){return t.labelOverlap.length<1?!1:n==="hide"?!_A(e[0]):n==="rotate"?!e.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):n==="ellipsis"||n==="wrap"?e.filter(function(r){return r.querySelector("text")}).length>1:!0}function Ug(e,t,n){var r=t.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(s){var l=s.type,u=Gb.get(l);WA(e,t,l)&&(u==null||u(e,s,t,n))})}function GA(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(r){return r==="positive"?-1:1};return e.reduce(function(r,i){return r*n(i)},1)}function Xb(e){for(var t=e;t<0;)t+=360;return Math.round(t%360)}function rm(e,t){var n=(0,j.CR)(e,2),r=n[0],i=n[1],s=(0,j.CR)(t,2),l=s[0],u=s[1],h=(0,j.CR)([r*l+i*u,r*u-i*l],2),p=h[0],m=h[1];return Math.atan2(m,p)}function XA(e){var t=(e+360)%180;return Yn(t,-90,90)||(t+=180),t}function wP(e,t,n){var r,i=n.labelAlign,s=(r=t.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(s)return t.getLocalEulerAngles();var l=0,u=tc(e.value,n),h=mu(e.value,n);return i==="horizontal"?0:(i==="perpendicular"?l=rm([1,0],u):l=rm([h[0]<0?-1:1,0],h),XA(CA(l)))}function YA(e,t,n){var r=n.type,i=n.labelAlign,s=tc(e,n),l=Xb(t),u=Xb(CA(rm([1,0],s))),h="center",p="middle";return r==="linear"?[90,270].includes(u)&&l===0?(h="center",p=s[1]===1?"top":"bottom"):!(u%180)&&[90,270].includes(l)?h="center":u===0?(Yn(l,0,90,!1,!0)||Yn(l,0,90)||Yn(l,270,360))&&(h="start"):u===90?Yn(l,0,90,!1,!0)?h="start":(Yn(l,90,180)||Yn(l,270,360))&&(h="end"):u===270?Yn(l,0,90,!1,!0)?h="end":(Yn(l,90,180)||Yn(l,270,360))&&(h="start"):u===180&&(l===90?h="start":(Yn(l,0,90)||Yn(l,270,360))&&(h="end")):i==="parallel"?Yn(u,0,180,!0)?p="top":p="bottom":i==="horizontal"?Yn(u,90,270,!1)?h="end":(Yn(u,270,360,!1)||Yn(u,0,90))&&(h="start"):i==="perpendicular"&&(Yn(u,90,270)?h="end":h="start"),{textAlign:h,textBaseline:p}}function WE(e,t,n){t.setLocalEulerAngles(e);var r=t.__data__.value,i=YA(r,e,n),s=t.querySelector(Bl.labelItem.class);s&&GE(s,i)}function im(e,t,n){var r=n.showTick,i=n.tickLength,s=n.tickDirection,l=n.labelDirection,u=n.labelSpacing,h=t.indexOf(e),p=ud(u,[e,h,t]),m=(0,j.CR)([tc(e.value,n),GA(l,s)],2),y=m[0],b=m[1],w=b===1?ud(r?i:0,[e,h,t]):0,R=(0,j.CR)(Gy(tm(y,p+w),al(e.value,n)),2),P=R[0],I=R[1];return{x:P,y:I}}function jg(e,t,n,r){var i=r.labelFormatter,s=Dh(i)?function(){return Gm(ud(i,[e,t,n,tc(e.value,r)]))}:function(){return Gm(e.label||"")};return s}function GE(e,t){e.nodeName==="text"&&e.attr(t)}function Yb(e){Ug(this.node().childNodes,e,{hide:cd,show:Wy,rotate:function(t,n){WE(+n,t,e)},ellipsis:function(t,n,r){t&&f_(t,n||1/0,r)},wrap:function(t,n,r){t&&Wa(t,n,r)},getTextShape:function(t){return t.querySelector("text")}})}function XE(e,t,n,r,i){var s=n.indexOf(t),l=es(e).append(jg(t,s,n,i)).attr("className",Bl.labelItem.name).node(),u=(0,j.CR)(w0($a(r,[t,s,n])),2),h=u[0],p=u[1],m=p.transform,y=(0,j._T)(p,["transform"]);Vb(l,m);var b=wP(t,l,i);return l.getLocalEulerAngles()||l.setLocalEulerAngles(b),GE(l,(0,j.pi)((0,j.pi)({},YA(t.value,b,i)),h)),e.attr(y),l}function $A(e,t,n,r){var i=hh(t,n.labelFilter),s=Os(n,"label");return e.selectAll(Bl.label.class).data(i,function(l,u){return u}).join(function(l){return l.append("g").attr("className",Bl.label.name).transition(function(u){XE(this,u,t,s,n);var h=im(u,t,n),p=h.x,m=h.y;return this.style.transform="translate(".concat(p,", ").concat(m,")"),null}).call(function(){Yb.call(e,n)})},function(l){return l.transition(function(u){var h=this.querySelector(Bl.labelItem.class),p=XE(this,u,t,s,n),m=vA(h,p,r.update),y=im(u,t,n),b=y.x,w=y.y,R=Zp(this,{transform:"translate(".concat(b,", ").concat(w,")")},r.update);return(0,j.ev)((0,j.ev)([],(0,j.CR)(m),!1),[R],!1)}).call(function(u){var h=ol(u,"_transitions").flat().filter(Hb);uP(h,function(){Yb.call(e,n)})})},function(l){return l.transition(function(){var u=this,h=a_(this.childNodes[0],r.exit);return Lg(h,function(){return es(u).remove()}),h})}).transitions()}function $b(e,t){return Zf(e,t.tickDirection,t)}function KA(e,t){var n=(0,j.CR)(e,2),r=n[0],i=n[1];return[[0,0],[r*t,i*t]]}function m_(e,t,n,r,i){var s=i.tickLength,l=(0,j.CR)(KA(r,ud(s,[e,t,n])),2),u=(0,j.CR)(l[0],2),h=u[0],p=u[1],m=(0,j.CR)(l[1],2),y=m[0],b=m[1];return{x1:h,x2:y,y1:p,y2:b}}function qA(e,t,n,r,i){var s=i.tickFormatter,l=$b(t.value,i),u="line";return Dh(s)&&(u=function(){return ud(s,[t,n,r,l])}),e.append(u).attr("className",Bl.tickItem.name)}function YE(e,t,n,r,i,s,l){var u=$b(e.value,s),h=m_(e,t,n,u,s),p=h.x1,m=h.x2,y=h.y1,b=h.y2,w=(0,j.CR)(w0($a(l,[e,t,n,u])),2),R=w[0],P=w[1];r.node().nodeName==="line"&&r.styles((0,j.pi)({x1:p,x2:m,y1:y,y2:b},R)),i.attr(P),r.styles(R)}function $E(e,t,n,r,i,s){var l=qA(es(this),e,t,n,r);YE(e,t,n,l,this,r,i);var u=(0,j.CR)(al(e.value,r),2),h=u[0],p=u[1];return Zp(this,{transform:"translate(".concat(h,", ").concat(p,")")},s)}function QA(e,t,n,r){var i=hh(t,n.tickFilter),s=Os(n,"tick");return e.selectAll(Bl.tick.class).data(i,function(l){return l.id||l.label}).join(function(l){return l.append("g").attr("className",Bl.tick.name).transition(function(u,h){return $E.call(this,u,h,i,n,s,!1)})},function(l){return l.transition(function(u,h){return this.removeChildren(),$E.call(this,u,h,i,n,s,r.update)})},function(l){return l.transition(function(){var u=this,h=a_(this.childNodes[0],r.exit);return Lg(h,function(){return u.remove()}),h})}).transitions()}var vc=function(){function e(t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=n,this.width=r,this.height=i}return Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},e.prototype.isPointIn=function(t,n){return t>=this.left&&t<=this.right&&n>=this.top&&n<=this.bottom},e}();function AP(e){var t=e.getRenderBounds(),n=__read(t.min,2),r=n[0],i=n[1],s=__read(t.max,2),l=s[0],u=s[1],h=l-r,p=u-i;return new vc(r,i,h,p)}var KE=fp({text:"text"},"title");function Kb(e){return/\S+-\S+/g.test(e)?e.split("-").map(function(t){return t[0]}):e.length>2?[e[0]]:e.split("")}function JA(e,t){var n=e.attributes,r=n.position,i=n.spacing,s=n.inset,l=n.text,u=e.getBBox(),h=t.getBBox(),p=Kb(r),m=(0,j.CR)(Pf(l?i:0),4),y=m[0],b=m[1],w=m[2],R=m[3],P=(0,j.CR)(Pf(s),4),I=P[0],N=P[1],z=P[2],Z=P[3],Y=(0,j.CR)([R+b,y+w],2),$=Y[0],J=Y[1],ae=(0,j.CR)([Z+N,I+z],2),pe=ae[0],Oe=ae[1];if(p[0]==="l")return new vc(u.x,u.y,h.width+u.width+$+pe,Math.max(h.height+Oe,u.height));if(p[0]==="t")return new vc(u.x,u.y,Math.max(h.width+pe,u.width),h.height+u.height+J+Oe);var Ve=(0,j.CR)([t.attributes.width||h.width,t.attributes.height||h.height],2),Ke=Ve[0],lt=Ve[1];return new vc(h.x,h.y,Ke+u.width+$+pe,lt+u.height+J+Oe)}function qE(e,t){var n=Object.entries(t).reduce(function(r,i){var s=(0,j.CR)(i,2),l=s[0],u=s[1],h=e.node().attr(l);return h||(r[l]=u),r},{});e.styles(n)}function eC(e){var t,n,r,i,s=e,l=s.width,u=s.height,h=s.position,p=(0,j.CR)([+l/2,+u/2],2),m=p[0],y=p[1],b=(0,j.CR)([+m,+y,"center","middle"],4),w=b[0],R=b[1],P=b[2],I=b[3],N=Kb(h);return N.includes("l")&&(t=(0,j.CR)([0,"start"],2),w=t[0],P=t[1]),N.includes("r")&&(n=(0,j.CR)([+l,"end"],2),w=n[0],P=n[1]),N.includes("t")&&(r=(0,j.CR)([0,"top"],2),R=r[0],I=r[1]),N.includes("b")&&(i=(0,j.CR)([+u,"bottom"],2),R=i[0],I=i[1]),{x:w,y:R,textAlign:P,textBaseline:I}}var QE=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return t.prototype.getAvailableSpace=function(){var n=this,r=this.attributes,i=r.width,s=r.height,l=r.position,u=r.spacing,h=r.inset,p=n.querySelector(KE.text.class);if(!p)return new vc(0,0,+i,+s);var m=p.getBBox(),y=m.width,b=m.height,w=(0,j.CR)(Pf(u),4),R=w[0],P=w[1],I=w[2],N=w[3],z=(0,j.CR)([0,0,+i,+s],4),Z=z[0],Y=z[1],$=z[2],J=z[3],ae=Kb(l);if(ae.includes("i"))return new vc(Z,Y,$,J);ae.forEach(function(ut,jt){var At,zt,wn,Hn;ut==="t"&&(At=(0,j.CR)(jt===0?[b+I,+s-b-I]:[0,+s],2),Y=At[0],J=At[1]),ut==="r"&&(zt=(0,j.CR)([+i-y-N],1),$=zt[0]),ut==="b"&&(wn=(0,j.CR)([+s-b-R],1),J=wn[0]),ut==="l"&&(Hn=(0,j.CR)(jt===0?[y+P,+i-y-P]:[0,+i],2),Z=Hn[0],$=Hn[1])});var pe=(0,j.CR)(Pf(h),4),Oe=pe[0],Ve=pe[1],Ke=pe[2],lt=pe[3],Ge=(0,j.CR)([lt+Ve,Oe+Ke],2),rt=Ge[0],st=Ge[1];return new vc(Z+lt,Y+Oe,$-rt,J-st)},t.prototype.getBBox=function(){return this.title?this.title.getBBox():new vc(0,0,0,0)},t.prototype.render=function(n,r){var i=this,s=n.width,l=n.height,u=n.position,h=n.spacing,p=(0,j._T)(n,["width","height","position","spacing"]),m=(0,j.CR)(w0(p),1),y=m[0],b=eC(n),w=b.x,R=b.y,P=b.textAlign,I=b.textBaseline;Lh(!!p.text,es(r),function(N){i.title=N.maybeAppendByClassName(KE.text,"text").styles(y).call(qE,{x:w,y:R,textAlign:P,textBaseline:I}).node()})},t}(Mf);function tC(e,t,n){var r=n.titlePosition,i=r===void 0?"lb":r,s=n.titleSpacing,l=Kb(i),u=e.node().getLocalBounds(),h=(0,j.CR)(u.min,2),p=h[0],m=h[1],y=(0,j.CR)(u.halfExtents,2),b=y[0],w=y[1],R=(0,j.CR)(t.node().getLocalBounds().halfExtents,2),P=R[0],I=R[1],N=(0,j.CR)([p+b,m+w],2),z=N[0],Z=N[1],Y=(0,j.CR)(Pf(s),4),$=Y[0],J=Y[1],ae=Y[2],pe=Y[3];if(["start","end"].includes(i)&&n.type==="linear"){var Oe=n.startPos,Ve=n.endPos,Ke=(0,j.CR)(i==="start"?[Oe,Ve]:[Ve,Oe],2),lt=Ke[0],Ge=Ke[1],rt=BE([-Ge[0]+lt[0],-Ge[1]+lt[1]]),st=(0,j.CR)(tm(rt,$),2),ut=st[0],jt=st[1];return{x:lt[0]+ut,y:lt[1]+jt}}return l.includes("t")&&(Z-=w+I+$),l.includes("r")&&(z+=b+P+J),l.includes("l")&&(z-=b+P+pe),l.includes("b")&&(Z+=w+I+ae),{x:z,y:Z}}function nC(e,t,n){var r=e.getGeometryBounds().halfExtents,i=r[1]*2;if(t==="vertical"){if(n==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(n==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function JE(e,t,n,r,i){var s=Os(r,"title"),l=(0,j.CR)(w0(s),2),u=l[0],h=l[1],p=h.transform,m=h.transformOrigin,y=(0,j._T)(h,["transform","transformOrigin"]);t.styles(y);var b=p||nC(e.node(),u.direction,u.position);e.styles((0,j.pi)((0,j.pi)({},u),{transformOrigin:m})),Vb(e.node(),b);var w=tC(es(n._offscreen||n.querySelector(Bl.mainGroup.class)),t,r),R=w.x,P=w.y,I=Zp(t.node(),{transform:"translate(".concat(R,", ").concat(P,")")},i);return I}function rC(e,t,n,r){var i=n.titleText;return e.selectAll(Bl.title.class).data([{title:i}].filter(function(s){return!!s.title}),function(s,l){return s.title}).join(function(s){return s.append(function(){return Gm(i)}).attr("className",Bl.title.name).transition(function(){return JE(es(this),e,t,n,r.enter)})},function(s){return s.transition(function(){return JE(es(this),e,t,n,r.update)})},function(s){return s.remove()}).transitions()}function ys(e,t,n,r){var i=e.showLine,s=e.showTick,l=e.showLabel,u=t.maybeAppendByClassName(Bl.lineGroup,"g"),h=Lh(i,u,function(w){return l_(w,e,r)})||[],p=t.maybeAppendByClassName(Bl.tickGroup,"g"),m=Lh(s,p,function(w){return QA(w,n,e,r)})||[],y=t.maybeAppendByClassName(Bl.labelGroup,"g"),b=Lh(l,y,function(w){return $A(w,n,e,r)})||[];return(0,j.ev)((0,j.ev)((0,j.ev)([],(0,j.CR)(h),!1),(0,j.CR)(m),!1),(0,j.CR)(b),!1).filter(function(w){return!!w})}var qb=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,DE)||this}return t.prototype.render=function(n,r,i){var s=this,l=n.titleText,u=n.data,h=n.animate,p=n.showTitle,m=n.showGrid,y=n.dataThreshold,b=n.truncRange,w=xA(u,y).filter(function($){var J=$.value;return!(b&&J>b[0]&&J<b[1])}),R=RE(i===void 0?h:i),P=es(r).maybeAppendByClassName(Bl.gridGroup,"g"),I=Lh(m,P,function($){return ra($,w,n,R)})||[],N=es(r).maybeAppendByClassName(Bl.mainGroup,"g");l&&(!this.initialized&&R.enter||this.initialized&&R.update)&&ys(n,es(this.offscreenGroup),w,RE(!1));var z=ys(n,es(N.node()),w,R),Z=es(r).maybeAppendByClassName(Bl.titleGroup,"g"),Y=Lh(p,Z,function($){return rC($,s,n,R)})||[];return(0,j.ev)((0,j.ev)((0,j.ev)([],(0,j.CR)(I),!1),(0,j.CR)(z),!1),(0,j.CR)(Y),!1).flat().filter(function($){return!!$})},t}(Mf),jv=function(e){return e};class df{constructor(t){this.options=ri({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=ri({},this.options,t),this.rescale(t)}rescale(t){}}function nc(e,t){return t-e?n=>(n-e)/(t-e):n=>.5}function Ou(e,...t){return t.reduce((n,r)=>i=>n(r(i)),e)}function Xp(e,t,n,r,i){let s=n||0,l=r||e.length;const u=i||(h=>h);for(;s<l;){const h=Math.floor((s+l)/2);u(e[h])>t?l=h:s=h+1}return s}var iC=D(19818),oC=D.n(iC);function Qb(e,t,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function eS(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100,i=e[3];if(n===0)return[r*255,r*255,r*255,i];const s=r<.5?r*(1+n):r+n-r*n,l=2*r-s,u=Qb(l,s,t+1/3),h=Qb(l,s,t),p=Qb(l,s,t-1/3);return[u*255,h*255,p*255,i]}function v_(e){const t=oC().get(e);if(!t)return null;const{model:n,value:r}=t;return n==="rgb"?r:n==="hsl"?eS(r):null}const If=(e,t)=>n=>e*(1-n)+t*n,Ym=(e,t)=>{const n=v_(e),r=v_(t);return n===null||r===null?n?()=>e:()=>t:i=>{const s=new Array(4);for(let m=0;m<4;m+=1){const y=n[m],b=r[m];s[m]=y*(1-i)+b*i}const[l,u,h,p]=s;return`rgba(${Math.round(l)}, ${Math.round(u)}, ${Math.round(h)}, ${p})`}},$m=(e,t)=>typeof e=="number"&&typeof t=="number"?If(e,t):typeof e=="string"&&typeof t=="string"?Ym(e,t):()=>e,aC=(e,t)=>{const n=If(e,t);return r=>Math.round(n(r))};var tS=function(e){return e===null},sC=tS;function g_(e){return!Si(e)&&!sC(e)&&!Number.isNaN(e)}const Vv=Math.sqrt(50),Jb=Math.sqrt(10),ex=Math.sqrt(2);function tx(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/vf(10,i);return i>=0?(s>=Vv?10:s>=Jb?5:s>=ex?2:1)*vf(10,i):-vf(10,-i)/(s>=Vv?10:s>=Jb?5:s>=ex?2:1)}function nx(e,t,n){const r=Math.abs(t-e)/Math.max(0,n);let i=vf(10,Math.floor(Math.log(r)/Math.LN10));const s=r/i;return s>=Vv?i*=10:s>=Jb?i*=5:s>=ex&&(i*=2),t<e?-i:i}const rx=(e,t,n=5)=>{const r=[e,t];let i=0,s=r.length-1,l=r[i],u=r[s],h;return u<l&&([l,u]=[u,l],[i,s]=[s,i]),h=tx(l,u,n),h>0?(l=Math.floor(l/h)*h,u=Math.ceil(u/h)*h,h=tx(l,u,n)):h<0&&(l=Math.ceil(l*h)/h,u=Math.floor(u*h)/h,h=tx(l,u,n)),h>0?(r[i]=Math.floor(l/h)*h,r[s]=Math.ceil(u/h)*h):h<0&&(r[i]=Math.ceil(l*h)/h,r[s]=Math.floor(u*h)/h),r};function Km(e,t){const n=t<e?t:e,r=e>t?e:t;return i=>Math.min(Math.max(n,i),r)}const CP=(e,t,n)=>{const[r,i]=e,[s,l]=t;let u,h;return r<i?(u=nc(r,i),h=n(s,l)):(u=nc(i,r),h=n(l,s)),Ou(h,u)},pp=(e,t,n)=>{const r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),l=e[0]>e[r],u=l?[...e].reverse():e,h=l?[...t].reverse():t;for(let p=0;p<r;p+=1)i[p]=nc(u[p],u[p+1]),s[p]=n(h[p],h[p+1]);return p=>{const m=Xp(e,p,1,r)-1,y=i[m],b=s[m];return Ou(b,y)(p)}},nS=(e,t,n,r)=>(Math.min(e.length,t.length)>2?pp:CP)(e,t,r?aC:n);class Bo extends df{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:If,tickCount:5}}map(t){return g_(t)?this.output(t):this.options.unknown}invert(t){return g_(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,n,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,n,r,...i)}getTicks(){const{tickMethod:t}=this.options,[n,r,i,...s]=this.getTickMethodOptions();return t(n,r,i,...s)}getTickMethodOptions(){const{domain:t,tickCount:n}=this.options,r=t[0],i=t[t.length-1];return[r,i,n]}chooseNice(){return rx}rescale(){this.nice();const[t,n]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,n,this.chooseClamp(n))}chooseClamp(t){const{clamp:n,range:r}=this.options,i=this.options.domain.map(t),s=Math.min(i.length,r.length);return n?Km(i[0],i[s-1]):jv}composeOutput(t,n){const{domain:r,range:i,round:s,interpolate:l}=this.options,u=nS(r.map(t),i,l,s);this.output=Ou(u,n,t)}composeInput(t,n,r){const{domain:i,range:s}=this.options,l=nS(s,i.map(t),If);this.input=Ou(n,r,l)}}const qm=(e,t,n)=>{let r,i,s=e,l=t;if(s===l&&n>0)return[s];let u=tx(s,l,n);if(u===0||!Number.isFinite(u))return[];if(u>0){s=Math.ceil(s/u),l=Math.floor(l/u),i=new Array(r=Math.ceil(l-s+1));for(let h=0;h<r;h+=1)i[h]=(s+h)*u}else{u=-u,s=Math.ceil(s*u),l=Math.floor(l*u),i=new Array(r=Math.ceil(l-s+1));for(let h=0;h<r;h+=1)i[h]=(s+h)/u}return i};class Gf extends Bo{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:$m,tickMethod:qm,tickCount:5}}chooseTransforms(){return[jv,jv]}clone(){return new Gf(this.options)}}function lC(e,t){if(e){var n;if(_s(e))for(var r=0,i=e.length;r<i&&(n=t(e[r],r),n!==!1);r++);else if(ha(e)){for(var s in e)if(e.hasOwnProperty(s)&&(n=t(e[s],s),n===!1))break}}}var y_=lC,cC=function(e,t,n){if(!_s(e)&&!q0(e))return e;var r=n;return y_(e,function(i,s){r=t(r,i,s)}),r},rS=cC,ix=function(e,t){return rS(e,function(n,r,i){return t.includes(i)||(n[i]=r),n},{})};function om(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}function iS(e){for(var t=1/0,n=1/0,r=-1/0,i=-1/0,s=0;s<e.length;s++){var l=e[s],u=l.x,h=l.y,p=l.width,m=l.height,y=(0,j.CR)([u+p,h+m],2),b=y[0],w=y[1];u<t&&(t=u),h<n&&(n=h),b>r&&(r=b),w>i&&(i=w)}return new vc(t,n,r-t,i-n)}var Ky=function(e,t,n){var r=e.width,i=e.height,s=n.flexDirection,l=s===void 0?"row":s,u=n.flexWrap,h=u===void 0?"nowrap":u,p=n.justifyContent,m=p===void 0?"flex-start":p,y=n.alignContent,b=y===void 0?"flex-start":y,w=n.alignItems,R=w===void 0?"flex-start":w,P=l==="row",I=l==="row"||l==="column",N=P?I?[1,0]:[-1,0]:I?[0,1]:[0,-1],z=(0,j.CR)([0,0],2),Z=z[0],Y=z[1],$=t.map(function(Ge){var rt,st=Ge.width,ut=Ge.height,jt=(0,j.CR)([Z,Y],2),At=jt[0],zt=jt[1];return rt=(0,j.CR)([Z+st*N[0],Y+ut*N[1]],2),Z=rt[0],Y=rt[1],new vc(At,zt,st,ut)}),J=iS($),ae={"flex-start":0,"flex-end":P?r-J.width:i-J.height,center:P?(r-J.width)/2:(i-J.height)/2},pe=$.map(function(Ge){var rt=Ge.x,st=Ge.y,ut=vc.fromRect(Ge);return ut.x=P?rt+ae[m]:rt,ut.y=P?st:st+ae[m],ut}),Oe=iS(pe),Ve=function(Ge){var rt=(0,j.CR)(P?["height",i]:["width",r],2),st=rt[0],ut=rt[1];switch(R){case"flex-start":return 0;case"flex-end":return ut-Ge[st];case"center":return ut/2-Ge[st]/2;default:return 0}},Ke=pe.map(function(Ge){var rt=Ge.x,st=Ge.y,ut=vc.fromRect(Ge);return ut.x=P?rt:rt+Ve(ut),ut.y=P?st+Ve(ut):st,ut}),lt=Ke.map(function(Ge){var rt,st,ut=vc.fromRect(Ge);return ut.x+=(rt=e.x)!==null&&rt!==void 0?rt:0,ut.y+=(st=e.y)!==null&&st!==void 0?st:0,ut});return lt},__=function(e,t,n){return[]},Vg=function(e,t,n){if(t.length===0)return[];var r={flex:Ky,grid:__},i=n.display in r?r[n.display]:null;return(i==null?void 0:i.call(null,e,t,n))||[]},Hg=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n)||this;r.layoutEvents=[No.BOUNDS_CHANGED,No.INSERTED,No.REMOVED],r.$margin=Pf(0),r.$padding=Pf(0);var i=n.style||{},s=i.margin,l=s===void 0?0:s,u=i.padding,h=u===void 0?0:u;return r.margin=l,r.padding=h,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(t.prototype,"margin",{get:function(){return this.$margin},set:function(n){this.$margin=Pf(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.$padding},set:function(n){this.$padding=Pf(n)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n=this.attributes,r=n.x,i=r===void 0?0:r,s=n.y,l=s===void 0?0:s,u=n.width,h=n.height,p=(0,j.CR)(this.$margin,4),m=p[0],y=p[1],b=p[2],w=p[3];return new vc(i-w,l-m,u+w+y,h+m+b)},t.prototype.appendChild=function(n,r){return n.isMutationObserved=!0,e.prototype.appendChild.call(this,n,r),n},t.prototype.getAvailableSpace=function(){var n=this.attributes,r=n.width,i=n.height,s=(0,j.CR)(this.$padding,4),l=s[0],u=s[1],h=s[2],p=s[3],m=(0,j.CR)(this.$margin,4),y=m[0],b=m[3];return new vc(p+b,l+y,r-p-u,i-l-h)},t.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(l){return!l.isConnected}))try{var n=this.attributes,r=n.x,i=n.y;this.style.transform="translate(".concat(r,", ").concat(i,")");var s=Vg(this.getAvailableSpace(),this.children.map(function(l){return l.getBBox()}),this.attributes);this.children.forEach(function(l,u){var h=s[u],p=h.x,m=h.y;l.style.transform="translate(".concat(p,", ").concat(m,")")})}catch(l){}},t.prototype.bindEvents=function(){var n=this;this.layoutEvents.forEach(function(r){n.addEventListener(r,function(i){i.target.isMutationObserved=!0,n.layout()})})},t.prototype.attributeChangedCallback=function(n,r,i){n==="margin"?this.margin=i:n==="padding"&&(this.padding=i),this.layout()},t}(ki),ox=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function qy(e){return class extends Zi{constructor(t){super(t),this.descriptor=e}connectedCallback(){var t,n;(n=(t=this.descriptor).render)===null||n===void 0||n.call(t,this.attributes,this)}update(t={}){var n,r;this.attr(ri({},this.attributes,t)),(r=(n=this.descriptor).render)===null||r===void 0||r.call(n,this.attributes,this)}}}function ax(e,t,n){return e.querySelector(t)?Ra(e).select(t):Ra(e).append(n)}function Yp(e){return Array.isArray(e)?e.join(", "):`${e||""}`}function oS(e,t){const n={display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"};let{flexDirection:r,justifyContent:i,alignItems:s}=n;const l={top:["row","flex-start","center"],bottom:["row","flex-start","center"],left:["column","flex-start","center"],right:["column","flex-start","center"],center:["column","center","center"]};return e in l&&([r,i,s]=l[e]),Object.assign({display:"flex",flexDirection:r,justifyContent:i,alignItems:s},t)}class aS extends Hg{get child(){var t;return(t=this.children)===null||t===void 0?void 0:t[0]}update(t){var n;this.attr(t);const{subOptions:r}=t;(n=this.child)===null||n===void 0||n.update(r)}}class sx extends aS{update(t){var n;const{subOptions:r}=t;this.attr(t),(n=this.child)===null||n===void 0||n.update(r)}}function C0(e,t){var n;return(n=e.filter(r=>r.getOptions().name===t))===null||n===void 0?void 0:n[0]}function uC(e){return e==="horizontal"||e===0}function lx(e){return e==="vertical"||e===-Math.PI/2}function sS(e,t,n){const{bbox:r}=e,{position:i="top",size:s,length:l}=t,u=["top","bottom","center"].includes(i),[h,p]=u?[r.height,r.width]:[r.width,r.height],{defaultSize:m,defaultLength:y}=n.props,b=s||m||h,w=l||y||p,R=u?"horizontal":"vertical",[P,I]=u?[w,b]:[b,w];return{orientation:R,width:P,height:I,size:b,length:w}}function fd(e){return e.find(t=>t.getOptions().domain.length>0).getOptions().domain}function b_(e){const t=["arrow","crosshairs","grid","handle","handleLabel","indicator","label","line","tick","tip","title","trunc"],{style:n}=e,r=ox(e,["style"]),i={};return Object.entries(r).forEach(([s,l])=>{t.includes(s)?i[`show${Zm(s)}`]=l:i[s]=l}),Object.assign(Object.assign({},i),n)}var lS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function cS(e,t){const{eulerAngles:n,origin:r}=t;r&&e.setOrigin(r),n&&e.rotate(n[0],n[1],n[2])}function uS(e){const{innerWidth:t,innerHeight:n,depth:r}=e.getOptions();return[t,n,r]}function fC(e,t){const{width:n,height:r}=t.getOptions();return i=>{if(!AE(t))return i;const s=e==="bottom"?[i,1]:[0,i],l=t.map(s);if(e==="bottom"){const u=l[0];return new Gf({domain:[0,n],range:[0,1]}).map(u)}else if(e==="left"){const u=l[1];return new Gf({domain:[0,r],range:[0,1]}).map(u)}return i}}function hC(e,t,n){if(e.getTicks)return e.getTicks();if(!n)return t;const[r,i]=om(t,l=>+l),{tickCount:s}=e.getOptions();return n(r,i,s)}function dC(e,t){if(Nl(t))return w=>w;const n=t.getOptions(),{innerWidth:r,innerHeight:i,insetTop:s,insetBottom:l,insetLeft:u,insetRight:h}=n,[p,m,y]=e==="left"||e==="right"?[s,l,i]:[u,h,r],b=new Gf({domain:[0,1],range:[p/y,1-m/y]});return w=>b.map(w)}function fS(e,t,n,r,i,s,l,u){var h;(n!==void 0||s!==void 0)&&e.update(Object.assign(Object.assign({},n&&{tickCount:n}),s&&{tickMethod:s}));const p=hC(e,t,s),m=i?p.filter(i):p,y=N=>N instanceof Date?String(N):typeof N=="object"&&N?N:String(N),b=r||((h=e.getFormatter)===null||h===void 0?void 0:h.call(e))||y,w=dC(l,u),R=fC(l,u),P=N=>["top","bottom","center","outer"].includes(N),I=N=>["left","right"].includes(N);return Nl(u)||pc(u)?m.map((N,z,Z)=>{var Y,$;const J=((Y=e.getBandWidth)===null||Y===void 0?void 0:Y.call(e,N))/2||0,ae=w(e.map(N)+J);return{value:Hy(u)&&l==="center"||pc(u)&&(($=e.getTicks)===null||$===void 0?void 0:$.call(e))&&P(l)||pc(u)&&I(l)?1-ae:ae,label:y(b(r_(N),z,Z)),id:String(z)}}):m.map((N,z,Z)=>{var Y;const $=((Y=e.getBandWidth)===null||Y===void 0?void 0:Y.call(e,N))/2||0,J=R(w(e.map(N)+$));return{value:I(l)?1-J:J,label:y(b(r_(N),z,Z)),id:String(z)}})}function pC(e,t,n="xy"){const[r,i,s]=uS(t);return n==="xy"?e.includes("bottom")||e.includes("top")?i:r:n==="xz"?e.includes("bottom")||e.includes("top")?s:r:e.includes("bottom")||e.includes("top")?i:s}function hS(e=[],t){if(e.length>0)return e;const{labelAutoRotate:n,labelAutoHide:r,labelAutoEllipsis:i,labelAutoWrap:s}=t,l=[],u=(h,p)=>{p&&l.push(Object.assign(Object.assign({},h),p))};return u({type:"rotate",optionalAngles:[0,15,30,45,60,90]},n),u({type:"ellipsis",minLength:20},i),u({type:"hide"},r),u({type:"wrap",wordWrapWidth:100,maxLines:3,recoveryWhenFail:!0},s),l}function mC(e,t,n,r,i){const{x:s,y:l,width:u,height:h}=t,p=[s+u/2,l+h/2],m=Math.min(u,h)/2,[y,b]=Nb(i),[w,R]=uS(i),P=Math.min(w,R)/2,I={center:p,radius:m,startAngle:y,endAngle:b,gridLength:(r-n)*P};if(e==="inner"){const{insetLeft:N,insetTop:z}=i.getOptions();return Object.assign(Object.assign({},I),{center:[p[0]-N,p[1]-z],labelAlign:"perpendicular",labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"})}return Object.assign(Object.assign({},I),{labelAlign:"parallel",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"})}function vC(e,t,n){return CE(t)||Zy(t)?!1:e===void 0?!!n.getTicks:e}function gC(e){const{depth:t}=e.getOptions();return t?{tickIsBillboard:!0,lineIsBillboard:!0,labelIsBillboard:!0,titleIsBillboard:!0,gridIsBillboard:!0}:{}}function Pc(e,t,n,r,i){const{x:s,y:l,width:u,height:h}=n;if(e==="bottom")return{startPos:[s,l],endPos:[s+u,l]};if(e==="left")return{startPos:[s+u,l+h],endPos:[s+u,l]};if(e==="right")return{startPos:[s,l+h],endPos:[s,l]};if(e==="top")return{startPos:[s,l+h],endPos:[s+u,l+h]};if(e==="center"){if(t==="vertical")return{startPos:[s,l],endPos:[s,l+h]};if(t==="horizontal")return{startPos:[s,l],endPos:[s+u,l]};if(typeof t=="number"){const[p,m]=r.getCenter(),[y,b]=Db(r),[w,R]=Nb(r),P=Math.min(u,h)/2,{insetLeft:I,insetTop:N}=r.getOptions(),z=y*P,Z=b*P,[Y,$]=[p+s-I,m+l-N],[J,ae]=[Math.cos(t),Math.sin(t)],pe=[Y+Z*J,$+Z*ae],Oe=[Y+z*J,$+z*ae],Ve=()=>{const{domain:lt}=i.getOptions();return lt.length},Ke=Nl(r)&&i?Ve():3;return{startPos:pe,endPos:Oe,gridClosed:Math.abs(R-w-360)<1e-6,gridCenter:[Y,$],gridControlAngles:new Array(Ke).fill(0).map((lt,Ge,rt)=>(R-w)/Ke*Ge)}}}return{}}const dS=e=>{const{order:t,size:n,position:r,orientation:i,labelFormatter:s,tickFilter:l,tickCount:u,tickMethod:h,important:p={},style:m={},indexBBox:y,title:b,grid:w=!1}=e,R=lS(e,["order","size","position","orientation","labelFormatter","tickFilter","tickCount","tickMethod","important","style","indexBBox","title","grid"]);return({scales:[P],value:I,coordinate:N,theme:z})=>{const{bbox:Z}=I,{domain:Y}=P.getOptions(),$=fS(P,Y,u,s,l,h,r,N),J=y?$.map((Ge,rt)=>{const st=y.get(rt);return!st||st[0]!==Ge.label?Ge:Object.assign(Object.assign({},Ge),{bbox:st[1]})}):$,[ae,pe]=Db(N),Oe=mC(r,Z,ae,pe,N),{axis:Ve,axisArc:Ke={}}=z,lt=b_(ri({},Ve,Ke,Oe,Object.assign(Object.assign({type:"arc",data:J,titleText:Yp(b),grid:w},R),p)));return new qb({style:ix(lt,["transform"])})}};function Qy(e,t,n,r,i,s){const l=n.axis,u=["top","right","bottom","left"].includes(i)?n[`axis${Pb(i)}`]:n.axisLinear,h=e.getOptions().name,p=n[`axis${Zm(h)}`]||{};return Object.assign({},l,u,p)}function x_(e,t,n,r,i,s){const l=Qy(e,t,n,r,i,s);return i==="center"?Object.assign(Object.assign(Object.assign(Object.assign({},l),{labelDirection:r==="right"?"negative":"positive"}),r==="center"?{labelTransform:"translate(50%,0)"}:null),{tickDirection:r==="right"?"negative":"positive",labelSpacing:r==="center"?0:4,titleSpacing:lx(s)?10:0,tick:r==="center"?!1:void 0}):l}const E_=e=>{const{direction:t="left",important:n={},labelFormatter:r,order:i,orientation:s,actualPosition:l,position:u,size:h,style:p={},title:m,tickCount:y,tickFilter:b,tickMethod:w,transform:R,indexBBox:P}=e,I=lS(e,["direction","important","labelFormatter","order","orientation","actualPosition","position","size","style","title","tickCount","tickFilter","tickMethod","transform","indexBBox"]);return({scales:N,value:z,coordinate:Z,theme:Y})=>{const{bbox:$}=z,[J]=N,{domain:ae,xScale:pe}=J.getOptions(),Oe=x_(J,Z,Y,t,u,s),Ve=Object.assign(Object.assign(Object.assign({},Oe),p),I),Ke=pC(l||u,Z,e.plane),lt=Pc(u,s,$,Z,pe),Ge=gC(Z),rt=fS(J,ae,y,r,b,w,u,Z),st=P?rt.map((At,zt)=>{const wn=P.get(zt);return!wn||wn[0]!==At.label?At:Object.assign(Object.assign({},At),{bbox:wn[1]})}):rt,ut=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ve),{type:"linear",data:st,crossSize:h,titleText:Yp(m),labelOverlap:hS(R,Ve),grid:vC(Ve.grid,Z,J),gridLength:Ke,line:!0,indexBBox:P}),Ve.line?null:{lineOpacity:0}),lt),Ge),n);return ut.labelOverlap.find(At=>At.type==="hide")&&(ut.crossSize=!1),new qb({className:"axis",style:b_(ut)})}},O0=e=>t=>{const{labelFormatter:n,labelFilter:r=()=>!0}=t;return i=>{var s;const{scales:[l]}=i,u=((s=l.getTicks)===null||s===void 0?void 0:s.call(l))||l.getOptions().domain,h=typeof n=="string"?Wm(n):n,p=(y,b,w)=>r(u[b],b,u),m=Object.assign(Object.assign({},t),{labelFormatter:h,labelFilter:p,scale:l});return e(m)(i)}},mp=O0(E_),pS=O0(dS);mp.props={defaultPosition:"center",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]},pS.props={defaultPosition:"outer",defaultOrientation:"vertical",defaultSize:45,defaultOrder:0,defaultCrossPadding:[12,12],defaultPadding:[12,12]};var S_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function yC(e){const t=e%(Math.PI*2);return t===Math.PI/2?{titleTransform:"translate(0, 50%)"}:t>-Math.PI/2&&t<Math.PI/2?{titleTransform:"translate(50%, 0)"}:t>Math.PI/2&&t<Math.PI*3/2?{titleTransform:"translate(-50%, 0)"}:{}}function _C(e,t,n,r){const{radar:i}=e,[s]=r,l=s.getOptions().name,[u,h]=Nb(n),{axisRadar:p={}}=t;return Object.assign(Object.assign({},p),{grid:l==="position",gridConnect:"line",gridControlAngles:new Array(i.count).fill(0).map((m,y)=>(h-u)/i.count*y)})}const Hv=e=>{const{important:t={}}=e,n=S_(e,["important"]);return r=>{const{theme:i,coordinate:s,scales:l}=r;return mp(Object.assign(Object.assign(Object.assign({},n),yC(e.orientation)),{important:Object.assign(Object.assign({},_C(e,i,s,l)),t)}))(r)}};Hv.props=Object.assign(Object.assign({},mp.props),{defaultPosition:"center"});function Zv(e,t){return+e.toPrecision(t)}function OP(e){return e.toLocaleString()}function cx(e){return e.toExponential()}function T_(e,t){return t===void 0&&(t=0),Math.abs(e)<1e3?String(e):"".concat(Zv(e/1e3,t).toLocaleString(),"K")}var ux=function(e,t,n){return e<0&&Number.isFinite(e)?t:n},RP=function(e,t,n){return e>0&&Number.isFinite(e)?t:n},w_=function(e,t){return e*t},MP=function(e,t){return e/2+(t||0)/2};function A_(e){var t=e.canvas,n=e.touches,r=e.offsetX,i=e.offsetY;if(t){var s=t.x,l=t.y;return[s,l]}if(n){var u=n[0],h=u.clientX,p=u.clientY;return[h,p]}return r&&i?[r,i]:[0,0]}var bC={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(e){return e.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},C_=fp({background:"background",labelGroup:"label-group",label:"label"},"indicator"),Gu=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n,bC)||this;return r.point=[0,0],r.group=r.appendChild(new ki({})),r.isMutationObserved=!0,r}return t.prototype.renderBackground=function(){if(this.label){var n=this.attributes,r=n.position,i=n.padding,s=(0,j.CR)(Pf(i),4),l=s[0],u=s[1],h=s[2],p=s[3],m=this.label.node().getLocalBounds(),y=m.min,b=m.max,w=new vc(y[0]-p,y[1]-l,b[0]+u-y[0]+p,b[1]+h-y[1]+l),R=this.getPath(r,w),P=Os(this.attributes,"background");this.background=es(this.group).maybeAppendByClassName(C_.background,"path").styles((0,j.pi)((0,j.pi)({},P),{d:R})),this.group.appendChild(this.label.node())}},t.prototype.renderLabel=function(){var n=this.attributes,r=n.formatter,i=n.labelText,s=Os(this.attributes,"label"),l=(0,j.CR)(w0(s),2),u=l[0],h=l[1],p=u.text,m=(0,j._T)(u,["text"]);if(this.label=es(this.group).maybeAppendByClassName(C_.labelGroup,"g").styles(h),!!i){var y=this.label.maybeAppendByClassName(C_.label,function(){return Gm(r(i))}).style("text",r(i).toString());y.selectAll("text").styles(m)}},t.prototype.adjustLayout=function(){var n=(0,j.CR)(this.point,2),r=n[0],i=n[1],s=this.attributes,l=s.x,u=s.y;this.group.attr("transform","translate(".concat(l-r,", ").concat(u-i,")"))},t.prototype.getPath=function(n,r){var i=this.attributes.radius,s=r.x,l=r.y,u=r.width,h=r.height,p=[["M",s+i,l],["L",s+u-i,l],["A",i,i,0,0,1,s+u,l+i],["L",s+u,l+h-i],["A",i,i,0,0,1,s+u-i,l+h],["L",s+i,l+h],["A",i,i,0,0,1,s,l+h-i],["L",s,l+i],["A",i,i,0,0,1,s+i,l],["Z"]],m={top:4,right:6,bottom:0,left:2},y=m[n],b=this.createCorner([p[y].slice(-2),p[y+1].slice(-2)]);return p.splice.apply(p,(0,j.ev)([y+1,1],(0,j.CR)(b),!1)),p[0][0]="M",p},t.prototype.createCorner=function(n,r){r===void 0&&(r=10);var i=.8,s=SP.apply(void 0,(0,j.ev)([],(0,j.CR)(n),!1)),l=(0,j.CR)(n,2),u=(0,j.CR)(l[0],2),h=u[0],p=u[1],m=(0,j.CR)(l[1],2),y=m[0],b=m[1],w=(0,j.CR)(s?[y-h,[h,y]]:[b-p,[p,b]],2),R=w[0],P=(0,j.CR)(w[1],2),I=P[0],N=P[1],z=R/2,Z=R/Math.abs(R),Y=r*Z,$=Y/2,J=Y*Math.sqrt(3)/2*i,ae=(0,j.CR)([I,I+z-$,I+z,I+z+$,N],5),pe=ae[0],Oe=ae[1],Ve=ae[2],Ke=ae[3],lt=ae[4];return s?(this.point=[Ve,p-J],[["L",pe,p],["L",Oe,p],["L",Ve,p-J],["L",Ke,p],["L",lt,p]]):(this.point=[h+J,Ve],[["L",h,pe],["L",h,Oe],["L",h+J,Ve],["L",h,Ke],["L",h,lt]])},t.prototype.applyVisibility=function(){var n=this.attributes.visibility;n==="hidden"?cd(this):Wy(this)},t.prototype.bindEvents=function(){this.label.on(No.BOUNDS_CHANGED,this.renderBackground)},t.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},t}(Mf),O_={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},mS={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},R_={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},R0=fp({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),Qm=fp({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),xC=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(n,r){var i=n.x,s=n.y,l=n.size,u=l===void 0?10:l,h=n.radius,p=h===void 0?u/4:h,m=n.orientation,y=(0,j._T)(n,["x","y","size","radius","orientation"]),b=u,w=b*2.4,R=es(r).maybeAppendByClassName(Qm.iconRect,"rect").styles((0,j.pi)((0,j.pi)({},y),{width:b,height:w,radius:p,x:i-b/2,y:s-w/2,transformOrigin:"center"})),P=i+1/3*b-b/2,I=i+2/3*b-b/2,N=s+1/4*w-w/2,z=s+3/4*w-w/2;R.maybeAppendByClassName("".concat(Qm.iconLine,"-1"),"line").styles((0,j.pi)({x1:P,x2:P,y1:N,y2:z},y)),R.maybeAppendByClassName("".concat(Qm.iconLine,"-2"),"line").styles((0,j.pi)({x1:I,x2:I,y1:N,y2:z},y)),m==="vertical"&&(R.node().style.transform="rotate(90)")},t}(Mf),M_=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,R_)||this}return t.prototype.renderLabel=function(n){var r=this,i=this.attributes,s=i.x,l=i.y,u=i.showLabel,h=Os(this.attributes,"label"),p=h.x,m=p===void 0?0:p,y=h.y,b=y===void 0?0:y,w=h.transform,R=h.transformOrigin,P=(0,j._T)(h,["x","y","transform","transformOrigin"]),I=(0,j.CR)(w0(P,[]),2),N=I[0],z=I[1],Z=es(n).maybeAppendByClassName(Qm.labelGroup,"g").styles(z),Y=(0,j.pi)((0,j.pi)({},mS),N),$=Y.text,J=(0,j._T)(Y,["text"]);Lh(!!u,Z,function(ae){r.label=ae.maybeAppendByClassName(Qm.label,"text").styles((0,j.pi)((0,j.pi)({},J),{x:s+m,y:l+b,transform:w,transformOrigin:R,text:"".concat($)})),r.label.on("mousedown",function(pe){pe.stopPropagation()}),r.label.on("touchstart",function(pe){pe.stopPropagation()})})},t.prototype.renderIcon=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.orientation,u=r.type,h=(0,j.pi)((0,j.pi)({x:i,y:s,orientation:l},O_),Os(this.attributes,"icon")),p=this.attributes.iconShape,m=p===void 0?function(){return new xC({style:h})}:p,y=es(n).maybeAppendByClassName(Qm.iconGroup,"g");y.selectAll(Qm.icon.class).data([m]).join(function(b){return b.append(typeof m=="string"?m:function(){return m(u)}).attr("className",Qm.icon.name)},function(b){return b.update(h)},function(b){return b.remove()})},t.prototype.render=function(n,r){this.renderIcon(r),this.renderLabel(r)},t}(Mf),fx=function(e,t,n){return[["M",e-n,t],["A",n,n,0,1,0,e+n,t],["A",n,n,0,1,0,e-n,t],["Z"]]},EC=fx,Zg=function(e,t,n){return[["M",e-n,t-n],["L",e+n,t-n],["L",e+n,t+n],["L",e-n,t+n],["Z"]]},SC=function(e,t,n){return[["M",e-n,t],["L",e,t-n],["L",e+n,t],["L",e,t+n],["Z"]]},TC=function(e,t,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t+r],["L",e,t-r],["L",e+n,t+r],["Z"]]},wC=function(e,t,n){var r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t-r],["L",e+n,t-r],["L",e,t+r],["Z"]]},AC=function(e,t,n){var r=n/2*Math.sqrt(3);return[["M",e,t-n],["L",e+r,t-n/2],["L",e+r,t+n/2],["L",e,t+n],["L",e-r,t+n/2],["L",e-r,t-n/2],["Z"]]},CC=function(e,t,n){var r=n-1.5;return[["M",e-n,t-r],["L",e+n,t+r],["L",e+n,t-r],["L",e-n,t+r],["Z"]]},vS=function(e,t,n){return[["M",e,t+n],["L",e,t-n]]},OC=function(e,t,n){return[["M",e-n,t-n],["L",e+n,t+n],["M",e+n,t-n],["L",e-n,t+n]]},gS=function(e,t,n){return[["M",e-n/2,t-n],["L",e+n/2,t-n],["M",e,t-n],["L",e,t+n],["M",e-n/2,t+n],["L",e+n/2,t+n]]},RC=function(e,t,n){return[["M",e-n,t],["L",e+n,t],["M",e,t-n],["L",e,t+n]]},yS=function(e,t,n){return[["M",e-n,t],["L",e+n,t]]},hx=function(e,t,n){return[["M",e-n,t],["L",e+n,t]]},MC=hx,PC=function(e,t,n){return[["M",e-n,t],["A",n/2,n/2,0,1,1,e,t],["A",n/2,n/2,0,1,0,e+n,t]]},IC=function(e,t,n){return[["M",e-n-1,t-2.5],["L",e,t-2.5],["L",e,t+2.5],["L",e+n+1,t+2.5]]},P_=function(e,t,n){return[["M",e-n-1,t+2.5],["L",e,t+2.5],["L",e,t-2.5],["L",e+n+1,t-2.5]]},Wg=function(e,t,n){return[["M",e-(n+1),t+2.5],["L",e-n/2,t+2.5],["L",e-n/2,t-2.5],["L",e+n/2,t-2.5],["L",e+n/2,t+2.5],["L",e+n+1,t+2.5]]};function LC(e,t){return[["M",e-5,t+2.5],["L",e-5,t],["L",e,t],["L",e,t-3],["L",e,t+3],["L",e+6.5,t+3]]}var DC=function(e,t,n){return[["M",e-n,t-n],["L",e+n,t],["L",e-n,t+n],["Z"]]};function NC(e){var t="default";if(ha(e)&&e instanceof Image)t="image";else if(Dh(e))t="symbol";else if(Xo(e)){var n=new RegExp("data:(image|text)");e.match(n)?t="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)?t="url":t="symbol"}return t}function BC(e){var t=NC(e);return["base64","url","image"].includes(t)?"image":e&&t==="symbol"?"path":null}var yl=function(e){(0,j.ZT)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l,h=this.getSubShapeStyle(n),p=h.symbol,m=h.size,y=m===void 0?16:m,b=(0,j._T)(h,["symbol","size"]),w=BC(p);Lh(!!w,es(r),function(R){R.maybeAppendByClassName("marker",w).attr("className","marker ".concat(w,"-marker")).call(function(P){if(w==="image"){var I=y*2;P.styles({img:p,width:I,height:I,x:s-y,y:u-y})}else{var I=y/2,N=Dh(p)?p:t.getSymbol(p);P.styles((0,j.pi)({d:N==null?void 0:N(s,u,I)},b))}})})},t.MARKER_SYMBOL_MAP=new Map,t.registerSymbol=function(n,r){t.MARKER_SYMBOL_MAP.set(n,r)},t.getSymbol=function(n){return t.MARKER_SYMBOL_MAP.get(n)},t.getSymbols=function(){return Array.from(t.MARKER_SYMBOL_MAP.keys())},t}(Mf);yl.registerSymbol("cross",OC),yl.registerSymbol("hyphen",yS),yl.registerSymbol("line",vS),yl.registerSymbol("plus",RC),yl.registerSymbol("tick",gS),yl.registerSymbol("circle",fx),yl.registerSymbol("point",EC),yl.registerSymbol("bowtie",CC),yl.registerSymbol("hexagon",AC),yl.registerSymbol("square",Zg),yl.registerSymbol("diamond",SC),yl.registerSymbol("triangle",TC),yl.registerSymbol("triangle-down",wC),yl.registerSymbol("line",vS),yl.registerSymbol("dot",hx),yl.registerSymbol("dash",MC),yl.registerSymbol("smooth",PC),yl.registerSymbol("hv",IC),yl.registerSymbol("vh",P_),yl.registerSymbol("hvh",Wg),yl.registerSymbol("vhv",LC);function FC(e,t,n){var r=Math.round((e-n)/t);return n+r*t}function _S(e,t,n){var r=1.4,i=r*n;return[["M",e-n,t-i],["L",e+n,t-i],["L",e+n,t+i],["L",e-n,t+i],["Z"]]}var bS=1.4,dx=.4;function $p(e,t,n){var r=n,i=r*bS,s=r/2,l=r/6,u=e+i*dx;return[["M",e,t],["L",u,t+s],["L",e+i,t+s],["L",e+i,t-s],["L",u,t-s],["Z"],["M",u,t+l],["L",e+i-2,t+l],["M",u,t-l],["L",e+i-2,t-l]]}function kC(e,t,n){var r=n,i=r*bS,s=r/2,l=r/6,u=t+i*dx;return[["M",e,t],["L",e-s,u],["L",e-s,t+i],["L",e+s,t+i],["L",e+s,u],["Z"],["M",e-l,u],["L",e-l,t+i-2],["M",e+l,u],["L",e+l,t+i-2]]}yl.registerSymbol("hiddenHandle",_S),yl.registerSymbol("verticalHandle",$p),yl.registerSymbol("horizontalHandle",kC);var PP=function(e,t,n){return e===void 0&&(e="horizontal"),e==="horizontal"?t:n};function xS(e,t,n,r){var i;r===void 0&&(r=4);var s=(0,j.CR)(e,2),l=s[0],u=s[1],h=(0,j.CR)(t,2),p=h[0],m=h[1],y=(0,j.CR)(n,2),b=y[0],w=y[1],R=(0,j.CR)([p,m],2),P=R[0],I=R[1],N=I-P;return P>I&&(i=(0,j.CR)([I,P],2),P=i[0],I=i[1]),N>u-l?[l,u]:P<l?b===l&&w===I?[l,I]:[l,N+l]:I>u?w===u&&b===P?[P,u]:[u-N,u]:[P,I]}function M0(e,t,n){return e===void 0&&(e="horizontal"),e==="horizontal"?t:n}var Jy=fp({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),px={showLabel:!0,formatter:function(e){return e.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},zC=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,px)||this}return t.prototype.render=function(n,r){var i=es(r).maybeAppendByClassName(Jy.markerGroup,"g");this.renderMarker(i);var s=es(r).maybeAppendByClassName(Jy.labelGroup,"g");this.renderLabel(s)},t.prototype.renderMarker=function(n){var r=this,i=this.attributes,s=i.orientation,l=i.markerSymbol,u=l===void 0?M0(s,"horizontalHandle","verticalHandle"):l;Lh(!!u,n,function(h){var p=Os(r.attributes,"marker"),m=(0,j.pi)({symbol:u},p);r.marker=h.maybeAppendByClassName(Jy.marker,function(){return new yl({style:m})}).update(m)})},t.prototype.renderLabel=function(n){var r=this,i=this.attributes,s=i.showLabel,l=i.orientation,u=i.spacing,h=u===void 0?0:u,p=i.formatter;Lh(s,n,function(m){var y,b=Os(r.attributes,"label"),w=b.text,R=(0,j._T)(b,["text"]),P=((y=m.select(Jy.marker.class))===null||y===void 0?void 0:y.node().getBBox())||{},I=P.width,N=I===void 0?0:I,z=P.height,Z=z===void 0?0:z,Y=(0,j.CR)(M0(l,[0,Z+h,"center","top"],[N+h,0,"start","middle"]),4),$=Y[0],J=Y[1],ae=Y[2],pe=Y[3];m.maybeAppendByClassName(Jy.label,"text").styles((0,j.pi)((0,j.pi)({},R),{x:$,y:J,text:p(w).toString(),textAlign:ae,textBaseline:pe}))})},t}(Mf),ES={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},SS=em({},ES,{}),UC=em({},ES,T0(px,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),jC=.01,mx=.5,Xf=fp({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend");function VC(e,t){for(var n=1;n<e.length;n+=1){var r=e[n-1],i=e[n];if(t>=r&&t<=i)return[r,i]}return[t,t]}function HC(e,t,n){var r=Array.from(t),i=e.length;return new Array(i).fill(0).reduce(function(s,l,u){var h=r[u%r.length];return s+=" ".concat(e[u],":").concat(h).concat(u<i-1?" ".concat(e[u+1],":").concat(h):"")},"l(".concat(n==="horizontal"?"0":"270",")"))}function TS(e,t){var n=(0,j.CR)(VC(e,t),2),r=n[0],i=n[1];return{tick:t>(r+i)/2?i:r,range:[r,i]}}var e1=fp({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function wS(e){var t=e.orientation,n=e.size,r=e.length;return M0(t,[r,n],[n,r])}function vx(e){var t=e.type,n=(0,j.CR)(wS(e),2),r=n[0],i=n[1];return t==="size"?[["M",0,i],["L",0+r,0],["L",0+r,i],["Z"]]:[["M",0,i],["L",0,0],["L",0+r,0],["L",0+r,i],["Z"]]}function ZC(e){return vx(e)}function WC(e){var t=e.orientation,n=e.color,r=e.block,i=e.partition,s;if(Dh(n)){var l=20;s=new Array(l).fill(0).map(function(p,m,y){return n(m/(y.length-1))})}else s=n;var u=s.length,h=s.map(function(p){return Af(p).toString()});return u?u===1?h[0]:r?HC(i,h,t):h.reduce(function(p,m,y){return p+=" ".concat(y/(u-1),":").concat(m)},"l(".concat(M0(t,"0","270"),")")):""}function AS(e){var t=e.orientation,n=e.range;if(!n)return[];var r=(0,j.CR)(wS(e),2),i=r[0],s=r[1],l=(0,j.CR)(n,2),u=l[0],h=l[1],p=M0(t,u*i,0),m=M0(t,0,u*s),y=M0(t,h*i,i),b=M0(t,s,h*s);return[["M",p,m],["L",p,b],["L",y,b],["L",y,m],["Z"]]}function t1(e,t){var n=Os(t,"track");e.maybeAppendByClassName(e1.track,"path").styles((0,j.pi)({d:vx(t)},n))}function GC(e,t){var n=Os(t,"selection"),r=WC(t),i=e.maybeAppendByClassName(e1.selection,"path").styles((0,j.pi)({d:ZC(t),fill:r},n)),s=i.maybeAppendByClassName(e1.clipPath,"path").styles({d:AS(t)}).node();i.style("clipPath",s)}var XC=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,{type:"color",orientation:"horizontal",size:30,range:[0,1],length:200,block:!1,partition:[],color:["#fff","#000"],trackFill:"#e5e5e5"})||this}return t.prototype.render=function(n,r){var i=es(r).maybeAppendByClassName(e1.trackGroup,"g");t1(i,n);var s=es(r).maybeAppendByClassName(e1.selectionGroup,"g");GC(s,n)},t}(Mf);function YC(e){return{min:Math.min.apply(Math,(0,j.ev)([],(0,j.CR)(e.map(function(t){return t.value})),!1)),max:Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(e.map(function(t){return t.value})),!1))}}var $C=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n,UC)||this;return r.eventToOffsetScale=new Gf({}),r.innerRibbonScale=new Gf({}),r.cacheLabelBBox=null,r.cacheHandleBBox=null,r.onHovering=function(i){var s=r.attributes,l=s.data,u=s.block;i.stopPropagation();var h=r.getValueByCanvasPoint(i);if(u){var p=TS(l.map(function(b){var w=b.value;return w}),h).range,m=r.getRealSelection(p);r.showIndicator((p[0]+p[1])/2,"".concat(m[0],"-").concat(m[1])),r.dispatchIndicated(h,p)}else{var y=r.getTickValue(h);r.showIndicator(y,"".concat(r.getRealValue(y))),r.dispatchIndicated(y)}},r.onDragStart=function(i){return function(s){s.stopPropagation(),r.attributes.slidable&&(r.target=i,r.prevValue=r.getTickValue(r.getValueByCanvasPoint(s)),document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseleave",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd))}},r.onDragging=function(i){var s=r.target;r.updateMouse();var l=(0,j.CR)(r.selection,2),u=l[0],h=l[1],p=r.getTickValue(r.getValueByCanvasPoint(i)),m=p-r.prevValue;s==="start"?u!==p&&r.updateSelection(p,h):s==="end"?h!==p&&r.updateSelection(u,p):s==="ribbon"&&m!==0&&(r.prevValue=p,r.updateSelection(m,m,!0))},r.onDragEnd=function(){r.style.cursor="pointer",document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("touchmove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r}return Object.defineProperty(t.prototype,"handleOffsetRatio",{get:function(){return this.ifHorizontal(.5,.5)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n=this.attributes,r=n.width,i=n.height;return new vc(0,0,r,i)},t.prototype.render=function(n,r){var i=this,s=n.showLabel;this.renderTitle(es(r));var l=this.availableSpace,u=l.x,h=l.y,p=es(r).maybeAppendByClassName(Xf.contentGroup,"g").styles({transform:"translate(".concat(u,", ").concat(h,")")}),m=p.maybeAppendByClassName(Xf.labelGroup,"g").styles({zIndex:1});Lh(!!s,m,function(b){i.renderLabel(b)});var y=p.maybeAppendByClassName(Xf.ribbonGroup,"g").styles({zIndex:0});this.handlesGroup=p.maybeAppendByClassName(Xf.handlesGroup,"g").styles({zIndex:2}),this.renderHandles(),this.renderRibbon(y),this.renderIndicator(p),this.adjustLabel(),this.adjustHandles()},Object.defineProperty(t.prototype,"range",{get:function(){var n=this.attributes,r=n.data,i=n.domain;return i?{min:i[0],max:i[1]}:YC(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonScale",{get:function(){var n=this.range,r=n.min,i=n.max;return this.innerRibbonScale.update({domain:[r,i],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonRange",{get:function(){var n=(0,j.CR)(this.selection,2),r=n[0],i=n[1],s=this.ribbonScale;return[s.map(r),s.map(i)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){var n=this.range,r=n.min,i=n.max,s=this.attributes.defaultValue,l=s===void 0?[r,i]:s,u=(0,j.CR)(l,2),h=u[0],p=u[1];return[h,p]},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(n,r){return M0(this.attributes.orientation,typeof n=="function"?n():n,typeof r=="function"?r():r)},t.prototype.renderTitle=function(n){var r=this.attributes,i=r.showTitle,s=r.titleText,l=r.width,u=r.height,h=Os(this.attributes,"title"),p=(0,j.pi)((0,j.pi)({},h),{width:l,height:u,text:s}),m=this;n.selectAll(Xf.title.class).data(i?[s]:[]).join(function(y){return y.append(function(){return new QE({style:p})}).attr("className",Xf.title.name).each(function(){m.title=this})},function(y){return y.update(p)},function(y){return y.each(function(){m.title=void 0}).remove()})},Object.defineProperty(t.prototype,"availableSpace",{get:function(){if(this.title)return this.title.getAvailableSpace();var n=this.attributes,r=n.width,i=n.height;return new vc(0,0,r,i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelFixedSpacing",{get:function(){var n=this.attributes.showTick;return n?5:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelPosition",{get:function(){var n=this.attributes,r=n.orientation,i=n.labelDirection,s={vertical:{positive:"right",negative:"left"},horizontal:{positive:"bottom",negative:"top"}};return s[r][i]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelBBox",{get:function(){var n,r=this.attributes.showLabel;if(!r)return new vc(0,0,0,0);if(this.cacheLabelBBox)return this.cacheLabelBBox;var i=((n=this.label.querySelector(Bl.labelGroup.class))===null||n===void 0?void 0:n.children.slice(-1)[0]).getBBox(),s=i.width,l=i.height;return this.cacheLabelBBox=new vc(0,0,s,l),this.cacheLabelBBox},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelShape",{get:function(){var n=this.attributes,r=n.showLabel,i=n.labelSpacing,s=i===void 0?0:i;if(!r)return{width:0,height:0,size:0,length:0};var l=this.labelBBox,u=l.width,h=l.height,p=this.ifHorizontal(h,u)+s+this.labelFixedSpacing,m=this.ifHorizontal(u,h);return{width:u,height:h,size:p,length:m}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonBBox",{get:function(){var n=this.attributes,r=n.showHandle,i=n.ribbonSize,s=this.availableSpace,l=s.width,u=s.height,h=this.labelShape,p=h.size,m=h.length,y=(0,j.CR)(this.ifHorizontal([u,l],[l,u]),2),b=y[0],w=y[1],R=r?this.handleShape:{size:0,length:0},P=R.size,I=R.length,N=this.handleOffsetRatio,z=0,Z=this.labelPosition;i?z=i:["bottom","right"].includes(Z)?z=Math.min(b-p,(b-P)/N):b*(1-N)>P?z=Math.max(b-p,0):z=Math.max((b-p-P)/N,0);var Y=Math.max(I,m),$=w-Y,J=(0,j.CR)(this.ifHorizontal([$,z],[z,$]),2),ae=J[0],pe=J[1],Oe=["top","left"].includes(Z)?p:0,Ve=(0,j.CR)(this.ifHorizontal([Y/2,Oe],[Oe,Y/2]),2),Ke=Ve[0],lt=Ve[1];return new vc(Ke,lt,ae,pe)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ribbonShape",{get:function(){var n=this.ribbonBBox,r=n.width,i=n.height;return this.ifHorizontal({size:i,length:r},{size:r,length:i})},enumerable:!1,configurable:!0}),t.prototype.renderRibbon=function(n){var r=this.attributes,i=r.data,s=r.type,l=r.orientation,u=r.color,h=r.block,p=Os(this.attributes,"ribbon"),m=this.range,y=m.min,b=m.max,w=this.ribbonBBox,R=w.x,P=w.y,I=this.ribbonShape,N=I.length,z=I.size,Z=em({transform:"translate(".concat(R,", ").concat(P,")"),length:N,size:z,type:s,orientation:l,color:u,block:h,partition:i.map(function(Y){return(Y.value-y)/(b-y)}),range:this.ribbonRange},p);this.ribbon=n.maybeAppendByClassName(Xf.ribbon,function(){return new XC({style:Z})}).update(Z)},t.prototype.getHandleClassName=function(n){return"".concat(Xf.prefix("".concat(n,"-handle")))},t.prototype.renderHandles=function(){var n=this.attributes,r=n.showHandle,i=n.orientation,s=Os(this.attributes,"handle"),l=(0,j.CR)(this.selection,2),u=l[0],h=l[1],p=(0,j.pi)((0,j.pi)({},s),{orientation:i}),m=s.shape,y=m===void 0?"slider":m,b=y==="basic"?zC:M_,w=this;this.handlesGroup.selectAll(Xf.handle.class).data(r?[{value:u,type:"start"},{value:h,type:"end"}]:[],function(R){return R.type}).join(function(R){return R.append(function(){return new b({style:p})}).attr("className",function(P){var I=P.type;return"".concat(Xf.handle," ").concat(w.getHandleClassName(I))}).each(function(P){var I=P.type,N=P.value;this.update({labelText:N});var z="".concat(I,"Handle");w[z]=this,this.addEventListener("pointerdown",w.onDragStart(I))})},function(R){return R.update(p).each(function(P){var I=P.value;this.update({labelText:I})})},function(R){return R.each(function(P){var I=P.type,N="".concat(I,"Handle");w[N]=void 0}).remove()})},t.prototype.adjustHandles=function(){var n=(0,j.CR)(this.selection,2),r=n[0],i=n[1];this.setHandlePosition("start",r),this.setHandlePosition("end",i)},Object.defineProperty(t.prototype,"handleBBox",{get:function(){if(this.cacheHandleBBox)return this.cacheHandleBBox;if(!this.attributes.showHandle)return new vc(0,0,0,0);var n=this.startHandle.getBBox(),r=n.width,i=n.height,s=this.endHandle.getBBox(),l=s.width,u=s.height,h=(0,j.CR)([Math.max(r,l),Math.max(i,u)],2),p=h[0],m=h[1];return this.cacheHandleBBox=new vc(0,0,p,m),this.cacheHandleBBox},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"handleShape",{get:function(){var n=this.handleBBox,r=n.width,i=n.height,s=(0,j.CR)(this.ifHorizontal([i,r],[r,i]),2),l=s[0],u=s[1];return{width:r,height:i,size:l,length:u}},enumerable:!1,configurable:!0}),t.prototype.setHandlePosition=function(n,r){var i=this.attributes.handleFormatter,s=this.ribbonBBox,l=s.x,u=s.y,h=this.ribbonShape.size,p=this.getOffset(r),m=(0,j.CR)(this.ifHorizontal([l+p,u+h*this.handleOffsetRatio],[l+h*this.handleOffsetRatio,u+p]),2),y=m[0],b=m[1],w=this.handlesGroup.select(".".concat(this.getHandleClassName(n))).node();w==null||w.update({transform:"translate(".concat(y,", ").concat(b,")"),formatter:i})},t.prototype.renderIndicator=function(n){var r=Os(this.attributes,"indicator");this.indicator=n.maybeAppendByClassName(Xf.indicator,function(){return new Gu({})}).update(r)},Object.defineProperty(t.prototype,"labelData",{get:function(){var n=this,r=this.attributes.data;return r.reduce(function(i,s,l,u){var h,p,m=(h=s==null?void 0:s.id)!==null&&h!==void 0?h:l.toString();if(i.push((0,j.pi)((0,j.pi)({},s),{id:m,index:l,type:"value",label:(p=s==null?void 0:s.label)!==null&&p!==void 0?p:s.value.toString(),value:n.ribbonScale.map(s.value)})),l<u.length-1){var y=u[l+1],b=(0,j.CR)([s.value,y.value],2),w=b[0],R=b[1],P=(w+R)/2;i.push((0,j.pi)((0,j.pi)({},s),{id:m,index:l,type:"range",range:[w,R],label:[w,R].join("~"),value:n.ribbonScale.map(P)}))}return i},[])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelStyle",{get:function(){var n=(0,j.CR)(["center","middle"],2),r=n[0],i=n[1],s=this.labelPosition;return s==="top"?i="bottom":s==="bottom"?i="top":s==="left"?r="end":s==="right"&&(r="start"),{labelTextAlign:r,labelTextBaseline:i}},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(n){var r=this.attributes,i=r.showTick,s=i===void 0?!1:i,l=r.labelFilter,u=r.labelFormatter,h=Os(this.attributes,"tick"),p=Os(this.attributes,"label"),m=p.align,y=em((0,j.pi)({showLine:!1,showGrid:!1,showTick:s,type:"linear",startPos:[0,0],endPos:[0,0],tickDirection:"negative",labelTransform:"rotate(0)"},this.labelStyle),T0(h,"tick"),T0(p,"label"),{data:this.labelData}),b={tickFilter:function(R,P,I){return(R==null?void 0:R.type)!=="value"?!1:l?l(R,R.index,I.filter(function(N){return N.type!=="value"})):!0},labelFilter:function(R,P,I){return(R==null?void 0:R.type)!==m?!1:l?l(R,R.index,I.filter(function(N){return N.type===m})):!0},labelFormatter:u},w=(0,j.pi)((0,j.pi)((0,j.pi)({},y),b),{labelOverlap:[{type:"hide"}]});this.label=n.maybeAppendByClassName(Xf.label,function(){return new qb({style:w})}).node(),this.label.update(w,!1)},Object.defineProperty(t.prototype,"labelAxisStyle",{get:function(){var n=this.attributes,r=n.showTick,i=n.labelDirection,s=n.labelSpacing,l=n.tickLength,u=this.ribbonShape.size,h=this.labelPosition,p=this.labelFixedSpacing,m=(0,j.CR)([0,0,0],3),y=m[0],b=m[1],w=m[2],R=l!=null?l:u;return r?(w=R,b=p,i==="positive"?h==="right"?(y=R,w=R):h==="bottom"&&(y=w):i==="negative"&&(h==="top"||h==="left")&&(y=u)):i==="positive"?h==="right"?b=R:h==="bottom"&&(y=u+p,b=s):i==="negative"&&(h==="left"||h==="top")&&(b=s),{offset:y,spacing:b,tickLength:w}},enumerable:!1,configurable:!0}),t.prototype.adjustLabel=function(){var n=this.attributes.showLabel;if(n){var r=this.ribbonBBox,i=r.x,s=r.y,l=r.width,u=r.height,h=this.labelAxisStyle,p=h.offset,m=h.spacing,y=h.tickLength,b=(0,j.CR)(this.ifHorizontal([[i,s+p],[i+l,s+p]],[[i+p,s+u],[i+p,s]]),2),w=b[0],R=b[1];this.label.update({startPos:w,endPos:R,tickLength:y,labelSpacing:m},!1)}},t.prototype.bindEvents=function(){this.style.cursor="pointer",this.ribbon.on("pointerdown",this.onDragStart("ribbon")),this.ribbon.on("pointermove",this.onHovering),this.addEventListener("pointerout",this.hideIndicator)},t.prototype.showIndicator=function(n,r){r===void 0&&(r="".concat(n));var i=this.attributes.showIndicator;if(!i||typeof n!="number"){this.hideIndicator();return}var s=this.range,l=s.min,u=s.max,h=this.ribbonBBox,p=h.x,m=h.y,y=(0,ya.Z)(n,l,u),b=this.getOffset(y),w=this.ifHorizontal([b+p,m],[p,b+m]);this.indicator.update({x:w[0],y:w[1],position:this.ifHorizontal("top","left"),labelText:r}),Wy(this.indicator.node())},t.prototype.hideIndicator=function(){cd(this.indicator.node())},t.prototype.updateMouse=function(){this.attributes.slidable&&(this.style.cursor="grabbing")},t.prototype.setSelection=function(n,r){this.updateSelection(n,r)},t.prototype.updateSelection=function(n,r,i){var s;i===void 0&&(i=!1);var l=(0,j.CR)(this.selection,2),u=l[0],h=l[1],p=(0,j.CR)([n,r],2),m=p[0],y=p[1];i&&(m+=u,y+=h);var b=this.range,w=b.min,R=b.max;s=(0,j.CR)(xS([w,R],[m,y],this.selection),2),m=s[0],y=s[1],this.update({defaultValue:[m,y]}),this.dispatchSelection()},Object.defineProperty(t.prototype,"step",{get:function(){var n=this.attributes.step,r=n===void 0?1:n,i=this.range,s=i.min,l=i.max;return Si(r)?Zv((l-s)*jC,0):r},enumerable:!1,configurable:!0}),t.prototype.getTickValue=function(n){var r=this.attributes,i=r.data,s=r.block,l=this.range.min;return s?TS(i.map(function(u){var h=u.value;return h}),n).tick:FC(n,this.step,l)},t.prototype.getValueByCanvasPoint=function(n){var r=this.range,i=r.min,s=r.max,l=(0,j.CR)(this.ribbon.node().getPosition(),2),u=l[0],h=l[1],p=this.ifHorizontal(u,h),m=this.ifHorizontal.apply(this,(0,j.ev)([],(0,j.CR)(A_(n)),!1)),y=m-p,b=(0,ya.Z)(this.getOffset(y,!0),i,s);return b},t.prototype.getOffset=function(n,r){r===void 0&&(r=!1);var i=this.range,s=i.min,l=i.max,u=this.ribbonShape.length,h=this.eventToOffsetScale;return h.update({domain:[s,l],range:[0,u]}),r?h.invert(n):h.map(n)},t.prototype.getRealSelection=function(n){var r=this.range.max,i=(0,j.CR)(n,2),s=i[0],l=i[1];return this.ifHorizontal([s,l],[r-l,r-s])},t.prototype.getRealValue=function(n){var r=this.range.max;return this.ifHorizontal(n,r-n)},t.prototype.dispatchSelection=function(){var n=this.getRealSelection(this.selection),r=new Va("valuechange",{detail:{value:n}});this.dispatchEvent(r)},t.prototype.dispatchIndicated=function(n,r){var i=this,s=this.range.max,l=this.ifHorizontal(function(){return{value:n,range:r}},function(){return{value:s-n,range:r?i.getRealSelection(r):void 0}}),u=new Va("indicate",{detail:l});this.dispatchEvent(u)},t}(Mf);class n1 extends df{getDefaultOptions(){return{range:[0],domain:[0,1],unknown:void 0,tickCount:5,tickMethod:qm}}map(t){const[n]=this.options.range;return n!==void 0?n:this.options.unknown}invert(t){const[n]=this.options.range;return t===n&&n!==void 0?this.options.domain:[]}getTicks(){const{tickMethod:t,domain:n,tickCount:r}=this.options,[i,s]=n;return!(0,dr.Z)(i)||!(0,dr.Z)(s)?[]:t(i,s,r)}clone(){return new n1(this.options)}}class Jm extends df{getDefaultOptions(){return{domain:[.5],range:[0,1]}}constructor(t){super(t)}map(t){if(!g_(t))return this.options.unknown;const n=Xp(this.thresholds,t,0,this.n);return this.options.range[n]}invert(t){const{range:n}=this.options,r=n.indexOf(t),i=this.thresholds;return[i[r-1],i[r]]}clone(){return new Jm(this.options)}rescale(){const{domain:t,range:n}=this.options;this.n=Math.min(t.length,n.length-1),this.thresholds=t}}function r1(e){return(0,Xr.Z)(e)?0:Mg(e)?e.length:Object.keys(e).length}var KC=function(e,t){if(!Mg(e))return-1;var n=Array.prototype.indexOf;if(n)return n.call(e,t);for(var r=-1,i=0;i<e.length;i++)if(e[i]===t){r=i;break}return r},i1=KC;function o1(e){return Math.abs(e)<1e-14?e:parseFloat(e.toFixed(14))}const qC=[1,5,2,2.5,4,3],IP=null,gx=Number.EPSILON*100;function QC(e,t){return(e%t+t)%t}function JC(e){return Math.round(e*1e12)/1e12}function CS(e,t,n,r,i,s){const l=r1(t),u=i1(t,e);let h=0;const p=QC(r,s);return(p<gx||s-p<gx)&&r<=0&&i>=0&&(h=1),1-u/(l-1)-n+h}function I_(e,t,n){const r=r1(t);return 1-i1(t,e)/(r-1)-n+1}function Gg(e,t,n,r,i,s){const l=(e-1)/(s-i),u=(t-1)/(Math.max(s,r)-Math.min(n,i));return 2-Math.max(l/u,u/l)}function eO(e,t){return e>=t?2-(e-1)/(t-1):1}function tO(e,t,n,r){const i=t-e;return 1-.5*(vf(t-r,2)+vf(e-n,2))/vf(.1*i,2)}function L_(e,t,n){const r=t-e;if(n>r){const i=(n-r)/2;return 1-vf(i,2)/vf(.1*r,2)}return 1}function nO(){return 1}const yx=(e,t,n=5,r=!0,i=qC,s=[.25,.2,.5,.05])=>{const l=n<0?0:Math.round(n);if(Number.isNaN(e)||Number.isNaN(t)||typeof e!="number"||typeof t!="number"||!l)return[];if(t-e<1e-15||l===1)return[e];const u={score:-2,lmin:0,lmax:0,lstep:0};let h=1;for(;h<1/0;){for(let R=0;R<i.length;R+=1){const P=i[R],I=I_(P,i,h);if(s[0]*I+s[1]+s[2]+s[3]<u.score){h=1/0;break}let N=2;for(;N<1/0;){const z=eO(N,l);if(s[0]*I+s[1]+s[2]*z+s[3]<u.score)break;const Z=(t-e)/(N+1)/h/P;let Y=Math.ceil(Math.log10(Z));for(;Y<1/0;){const $=h*P*vf(10,Y),J=L_(e,t,$*(N-1));if(s[0]*I+s[1]*J+s[2]*z+s[3]<u.score)break;const ae=Math.floor(t/$)*h-(N-1)*h,pe=Math.ceil(e/$)*h;if(ae<=pe){const Oe=pe-ae;for(let Ve=0;Ve<=Oe;Ve+=1){const lt=(ae+Ve)*($/h),Ge=lt+$*(N-1),rt=$,st=CS(P,i,h,lt,Ge,rt),ut=tO(e,t,lt,Ge),jt=Gg(N,l,e,t,lt,Ge),At=nO(),zt=s[0]*st+s[1]*ut+s[2]*jt+s[3]*At;zt>u.score&&(!r||lt<=e&&Ge>=t)&&(u.lmin=lt,u.lmax=Ge,u.lstep=rt,u.score=zt)}}Y+=1}N+=1}}h+=1}const p=o1(u.lmax),m=o1(u.lmin),y=o1(u.lstep),b=Math.floor(JC((p-m)/y))+1,w=new Array(b);w[0]=o1(m);for(let R=1;R<b;R+=1)w[R]=o1(w[R-1]+y);return w};class Ws extends Jm{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:yx}}constructor(t){super(t)}nice(){const{nice:t}=this.options;if(t){const[n,r,i]=this.getTickMethodOptions();this.options.domain=rx(n,r,i)}}getTicks(){const{tickMethod:t}=this.options,[n,r,i]=this.getTickMethodOptions();return t(n,r,i)}getTickMethodOptions(){const{domain:t,tickCount:n}=this.options,r=t[0],i=t[t.length-1];return[r,i,n]}rescale(){this.nice();const{range:t,domain:n}=this.options,[r,i]=n;this.n=t.length-1,this.thresholds=new Array(this.n);for(let s=0;s<this.n;s+=1)this.thresholds[s]=((s+1)*i-(s-this.n)*r)/(this.n+1)}invert(t){const[n,r]=super.invert(t),[i,s]=this.options.domain;return n===void 0&&r===void 0?[n,r]:[n||i,r||s]}getThresholds(){return this.thresholds}clone(){return new Ws(this.options)}}function OS(e,t){const n=e.length;if(!n)return;if(n<2)return e[n-1];const r=(n-1)*t,i=Math.floor(r),s=e[i],l=e[i+1];return s+(l-s)*(r-i)}function RS(e,t,n=!1){const r=e;n||r.sort((s,l)=>s-l);const i=[];for(let s=1;s<t;s+=1)i.push(OS(r,s/t));return i}class D_ extends Jm{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:yx}}constructor(t){super(t)}rescale(){const{domain:t,range:n}=this.options;this.n=n.length-1,this.thresholds=RS(t,this.n+1,!1)}invert(t){const[n,r]=super.invert(t),{domain:i}=this.options,s=i[0],l=i[i.length-1];return n===void 0&&r===void 0?[n,r]:[n||s,r||l]}getThresholds(){return this.thresholds}clone(){return new D_(this.options)}getTicks(){const{tickCount:t,domain:n,tickMethod:r}=this.options,i=n.length-1,s=n[0],l=n[i];return r(s,l,t)}}var N_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function MS(e,t,n){return e.size=t,uC(n)?e.height=t:e.width=t,e}function rO(e,t,n){const{size:r}=t,i=sS(e,t,n);return MS(i,r,i.orientation)}function iO(e){return t=>({value:t/e,label:String(t)})}function oO(e,t,n,r,i){const s=t.thresholds,l=iO(r);return Object.assign(Object.assign({},e),{color:i,data:[n,...s,r].map(l)})}function aO(e,t,n){const i=[-1/0,...t.thresholds,1/0].map((s,l)=>({value:l,label:s}));return Object.assign(Object.assign({},e),{data:i,color:n,labelFilter:(s,l)=>l>0&&l<i.length-1})}function _x(e){const{domain:t}=e.getOptions(),[n,r]=[t[0],_E(t)];return[n,r]}function sO(e,t){const n=e.getOptions(),r=e.clone();return r.update(Object.assign(Object.assign({},n),{range:[Af(t).toString()]})),r}function lO(e,t,n,r,i,s){const{length:l}=e,u=n||r,h=i.color?s.legendContinuous.ribbonFill||"black":s.color,p=t||sO(u,h),[m,y]=_x(p),[b,w]=_x([t,n,r].filter(R=>R!==void 0).find(R=>!(R instanceof n1)));return Object.assign(Object.assign({},e),{domain:[b,w],data:p.getTicks().map(R=>({value:R})),color:new Array(Math.floor(l)).fill(0).map((R,P)=>{const I=(y-m)/(l-1)*P+m,N=p.map(I)||h,z=r?r.map(I):1;return N.replace(/rgb[a]*\(([\d]{1,3}) *, *([\d]{1,3}) *, *([\d]{1,3})[\S\s]*\)/,(Z,Y,$,J)=>`rgba(${Y}, ${$}, ${J}, ${z})`)})})}function cO(e,t,n,r,i,s){const l=C0(e,"color"),u=rO(n,r,i);if(l instanceof Jm){const{range:m}=l.getOptions(),[y,b]=_x(l);return l instanceof Ws||l instanceof D_?oO(u,l,y,b,m):aO(u,l,m)}const h=C0(e,"size"),p=C0(e,"opacity");return lO(u,l,h,p,t,s)}const ev=e=>{const{labelFormatter:t,layout:n,order:r,orientation:i,position:s,size:l,title:u,style:h,crossPadding:p,padding:m}=e,y=N_(e,["labelFormatter","layout","order","orientation","position","size","title","style","crossPadding","padding"]);return({scales:b,value:w,theme:R,scale:P})=>{const{bbox:I}=w,{x:N,y:z,width:Z,height:Y}=I,$=oS(s,n),{legendContinuous:J={}}=R,ae=b_(Object.assign({},J,Object.assign(Object.assign({titleText:Yp(u),labelAlign:"value",labelFormatter:typeof t=="string"?Oe=>Wm(t)(Oe.label):t},cO(b,P,w,e,ev,R)),h),y)),pe=new aS({style:Object.assign(Object.assign({x:N,y:z,width:Z,height:Y},$),{subOptions:ae})});return pe.appendChild(new $C({className:"legend-continuous",style:ae})),pe}};ev.props={defaultPosition:"top",defaultOrientation:"vertical",defaultOrder:1,defaultSize:60,defaultLength:200,defaultLegendSize:60,defaultPadding:[20,10],defaultCrossPadding:[12,12]};const bx=e=>(...t)=>ev(Object.assign({},{block:!0},e))(...t);bx.props=Object.assign(Object.assign({},ev.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const B_=e=>t=>{const{scales:n}=t,r=C0(n,"size");return ev(Object.assign({},{type:"size",data:r.getTicks().map((i,s)=>({value:i,label:String(i)}))},e))(t)};B_.props=Object.assign(Object.assign({},ev.props),{defaultPosition:"top",defaultOrientation:"horizontal"});const xx=e=>B_(Object.assign({},{block:!0},e));xx.props=Object.assign(Object.assign({},ev.props),{defaultPosition:"top",defaultOrientation:"horizontal"});var uO=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const PS=({static:e=!1}={})=>t=>{const{width:n,height:r,depth:i,paddingLeft:s,paddingRight:l,paddingTop:u,paddingBottom:h,padding:p,inset:m,insetLeft:y,insetTop:b,insetRight:w,insetBottom:R,margin:P,marginLeft:I,marginBottom:N,marginTop:z,marginRight:Z,data:Y,coordinate:$,theme:J,component:ae,interaction:pe,x:Oe,y:Ve,z:Ke,key:lt,frame:Ge,labelTransform:rt,parentKey:st,clip:ut,viewStyle:jt,title:At}=t,zt=uO(t,["width","height","depth","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinate","theme","component","interaction","x","y","z","key","frame","labelTransform","parentKey","clip","viewStyle","title"]);return[Object.assign(Object.assign({type:"standardView",x:Oe,y:Ve,z:Ke,key:lt,width:n,height:r,depth:i,padding:p,paddingLeft:s,paddingRight:l,paddingTop:u,inset:m,insetLeft:y,insetTop:b,insetRight:w,insetBottom:R,paddingBottom:h,theme:J,coordinate:$,component:ae,interaction:pe,frame:Ge,labelTransform:rt,margin:P,marginLeft:I,marginBottom:N,marginTop:z,marginRight:Z,parentKey:st,clip:ut,style:jt},!e&&{title:At}),{marks:[Object.assign(Object.assign(Object.assign({},zt),{key:`${lt}-0`,data:Y}),e&&{title:At})]})]};PS.props={};var fO=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Xg(e){return(t,...n)=>ri({},e(t,...n),t)}function Wv(e){return(t,...n)=>ri({},t,e(t,...n))}function hO(e){return e instanceof Date?!1:typeof e=="object"}function F_(e,t){if(!e)return t;if(Array.isArray(e))return e;if(hO(e)){const{value:n=t}=e,r=fO(e,["value"]);return Object.assign(Object.assign({},r),{value:n})}return e}var am=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const IS=()=>e=>{const{children:t}=e,n=am(e,["children"]);if(!Array.isArray(t))return[];const{data:r,scale:i={},axis:s={},legend:l={},encode:u={},transform:h=[]}=n,p=am(n,["data","scale","axis","legend","encode","transform"]),m=t.map(y=>{var{data:b,scale:w={},axis:R={},legend:P={},encode:I={},transform:N=[]}=y,z=am(y,["data","scale","axis","legend","encode","transform"]);return Object.assign({data:F_(b,r),scale:ri({},i,w),encode:ri({},u,I),transform:[...h,...N],axis:R&&s?ri({},s,R):!1,legend:P&&l?ri({},l,P):!1},z)});return[Object.assign(Object.assign({},p),{marks:m,type:"standardView"})]};IS.props={};function ru([e,t],[n,r]){return[e-n,t-r]}function k_([e,t],[n,r]){return[e+n,t+r]}function Ic([e,t],[n,r]){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}function vp([e,t]){return Math.atan2(t,e)}function Yg([e,t]){return vp([e,t])+Math.PI/2}function z_(e,t){const n=vp(e),r=vp(t);return n<r?r-n:Math.PI*2-(n-r)}function $g(e){let t=1/0,n=-1/0,r=1/0,i=-1/0;for(const[u,h]of e)t=Math.min(u,t),n=Math.max(u,n),r=Math.min(h,r),i=Math.max(h,i);const s=n-t,l=i-r;return[t,r,s,l]}function LS([e,t],[n,r]){return[(e+n)/2,(t+r)/2]}function ea(e,t){for(const[n,r]of Object.entries(t))e.style(n,r)}function dO(e,t){return t.forEach((n,r)=>r===0?e.moveTo(n[0],n[1]):e.lineTo(n[0],n[1])),e.closePath(),e}function pO(e,t,n){const{arrowSize:r}=n,i=typeof r=="string"?+parseFloat(r)/100*Ic(e,t):r,s=Math.PI/6,l=Math.atan2(t[1]-e[1],t[0]-e[0]),u=Math.PI/2-l-s,h=[t[0]-i*Math.sin(u),t[1]-i*Math.cos(u)],p=l-s,m=[t[0]-i*Math.cos(p),t[1]-i*Math.sin(p)];return[h,m]}function a1(e,t,n,r,i){const s=vp(ru(r,t))+Math.PI,l=vp(ru(r,n))+Math.PI;return e.arc(r[0],r[1],i,s,l,l-s<0),e}function DS(e,t,n,r="y",i="between",s=!1){const l=(I,N)=>I==="y"||I===!0?N?180:90:N?90:0,u=r==="y"||r===!0?n:t,h=l(r,s),p=Bv(u),[m,y]=om(p,I=>u[I]),b=new Gf({domain:[m,y],range:[0,100]}),w=I=>(0,dr.Z)(u[I])&&!Number.isNaN(u[I])?b.map(u[I]):0,R={between:I=>`${e[I]} ${w(I)}%`,start:I=>I===0?`${e[I]} ${w(I)}%`:`${e[I-1]} ${w(I)}%, ${e[I]} ${w(I)}%`,end:I=>I===e.length-1?`${e[I]} ${w(I)}%`:`${e[I]} ${w(I)}%, ${e[I+1]} ${w(I)}%`},P=p.sort((I,N)=>w(I)-w(N)).map(R[i]||R.between).join(",");return`linear-gradient(${h}deg, ${P})`}function s1(e){const[t,n,r,i]=e;return[i,t,n,r]}function Gv(e,t,n){const[r,i,,s]=pc(e)?s1(t):t,[l,u]=n,h=e.getCenter(),p=Yg(ru(r,h)),m=Yg(ru(i,h)),y=m===p&&l!==u?m+Math.PI*2:m;return{startAngle:p,endAngle:y-p>=0?y:Math.PI*2+y,innerRadius:Ic(s,h),outerRadius:Ic(r,h)}}function LP(e){const t="connect";return Object.fromEntries(Object.entries(e).filter(([n])=>n.startsWith(t)).map(([n,r])=>[lowerFirst(n.replace(t,"").trim()),r]).filter(([n])=>n!==void 0))}function U_(e){const{colorAttribute:t,opacityAttribute:n=t}=e;return`${n}Opacity`}function NS(e,t){if(!Nl(e))return"";const n=e.getCenter(),{transform:r}=t;return`translate(${n[0]}, ${n[1]}) ${r||""}`}function Ex(e){if(e.length===1)return e[0];const[[t,n,r=0],[i,s,l=0]]=e;return[(t+i)/2,(n+s)/2,(r+l)/2]}function Kg(e){return e.replace(/-(\w)/g,function(t,n){return n.toUpperCase()})}function mO(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}var Lk=Array.prototype.slice;function a(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function o(e){return function(){return e}}function f(e){this._context=e}f.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function v(e){return new f(e)}const T=Math.PI,O=2*T,L=1e-6,F=O-L;function H(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function ie(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return H;const n=vf(10,t);return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class xe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?H:ie(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,l){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+l}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let l=this._x1,u=this._y1,h=r-t,p=i-n,m=l-t,y=u-n,b=m*m+y*y;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(b>L)if(!(Math.abs(y*h-p*m)>L)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let w=r-l,R=i-u,P=h*h+p*p,I=w*w+R*R,N=Math.sqrt(P),z=Math.sqrt(b),Z=s*Math.tan((T-Math.acos((P+b-I)/(2*N*z)))/2),Y=Z/z,$=Z/N;Math.abs(Y-1)>L&&this._append`L${t+Y*m},${n+Y*y}`,this._append`A${s},${s},0,0,${+(y*w>m*R)},${this._x1=t+$*h},${this._y1=n+$*p}`}}arc(t,n,r,i,s,l){if(t=+t,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(i),h=r*Math.sin(i),p=t+u,m=n+h,y=1^l,b=l?i-s:s-i;this._x1===null?this._append`M${p},${m}`:(Math.abs(this._x1-p)>L||Math.abs(this._y1-m)>L)&&this._append`L${p},${m}`,r&&(b<0&&(b=b%O+O),b>F?this._append`A${r},${r},0,1,${y},${t-u},${n-h}A${r},${r},0,1,${y},${this._x1=p},${this._y1=m}`:b>L&&this._append`A${r},${r},0,${+(b>=T)},${y},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Ee(){return new xe}Ee.prototype=xe.prototype;function Ye(e=3){return new xe(+e)}function Lt(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new xe(t)}function an(e){return e[0]}function Pn(e){return e[1]}function sr(e,t){var n=o(!0),r=null,i=v,s=null,l=Lt(u);e=typeof e=="function"?e:e===void 0?an:o(e),t=typeof t=="function"?t:t===void 0?Pn:o(t);function u(h){var p,m=(h=a(h)).length,y,b=!1,w;for(r==null&&(s=i(w=l())),p=0;p<=m;++p)!(p<m&&n(y=h[p],p,h))===b&&((b=!b)?s.lineStart():s.lineEnd()),b&&s.point(+e(y,p,h),+t(y,p,h));if(w)return s=null,w+""||null}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:o(+h),u):e},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:o(+h),u):t},u.defined=function(h){return arguments.length?(n=typeof h=="function"?h:o(!!h),u):n},u.curve=function(h){return arguments.length?(i=h,r!=null&&(s=i(r)),u):i},u.context=function(h){return arguments.length?(h==null?r=s=null:s=i(r=h),u):r},u}function Rr(e){const t=typeof e=="function"?e:e.render;return class extends Zi{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){t(this)}}}var Tr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function li(e){const{min:[t,n],max:[r,i]}=e.getLocalBounds();let s=0,l=0;return t>0&&(s=t),r<0&&(s=r),n>0&&(l=n),i<0&&(l=i),[s,l]}function Ui(e,t=[]){const[n=0,r=0,i=n,s=r]=t,l=e.parentNode,u=l.getEulerAngles();l.setEulerAngles(0);const{min:h,halfExtents:p}=e.getLocalBounds(),[m,y]=h,[b,w]=p;return l.setEulerAngles(u),{x:m-s,y:y-n,width:b*2+s+r,height:w*2+n+i}}const Lo=(e,t,n)=>{const r=dist(e,t),i=dist(t,n),s=dist(n,e);return(Math.pow(r,2)+Math.pow(i,2)-Math.pow(s,2))/(2*r*i)};function eo(e,t,n,r,i=!0,s=!0){const l=y=>sr()(y);if(!t[0]&&!t[1])return l([li(e),t]);if(!n.length)return l([[0,0],t]);const[u,h]=n,p=[...h],m=[...u];if(h[0]!==u[0]){const y=i?-4:4;p[1]=h[1],s&&!i&&(p[0]=Math.max(u[0],h[0]-y),h[1]<u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.max(m[0],p[0]-y))),!s&&!i&&(p[0]=Math.max(u[0],h[0]-y),h[1]>u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.max(m[0],p[0]-y))),!s&&i&&(p[0]=Math.min(u[0],h[0]-y),h[1]>u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.min(m[0],p[0]-y))),s&&i&&(p[0]=Math.min(u[0],h[0]-y),h[1]<u[1]?m[1]=p[1]:(m[1]=u[1],m[0]=Math.min(m[0],p[0]-y)))}return l([h,p,m,u,t])}const Wr=Rr(e=>{const t=e.attributes,{className:n,class:r,transform:i,rotate:s,labelTransform:l,labelTransformOrigin:u,x:h,y:p,x0:m=h,y0:y=p,text:b,background:w,connector:R,startMarker:P,endMarker:I,coordCenter:N,innerHTML:z}=t,Z=Tr(t,["className","class","transform","rotate","labelTransform","labelTransformOrigin","x","y","x0","y0","text","background","connector","startMarker","endMarker","coordCenter","innerHTML"]);if(e.style.transform=`translate(${h}, ${p})`,[h,p,m,y].some(At=>!(0,dr.Z)(At))){e.children.forEach(At=>At.remove());return}const Y=uo(Z,"background"),{padding:$}=Y,J=Tr(Y,["padding"]),ae=uo(Z,"connector"),{points:pe=[]}=ae,Oe=Tr(ae,["points"]);let Ve;z?Ve=Ra(e).maybeAppend("html","html",n).style("zIndex",0).style("innerHTML",z).call(ea,Object.assign({transform:l,transformOrigin:u},Z)).node():Ve=Ra(e).maybeAppend("text","text").style("zIndex",0).style("text",b).call(ea,Object.assign({textBaseline:"middle",transform:l,transformOrigin:u},Z)).node();const Ke=Ra(e).maybeAppend("background","rect").style("zIndex",-1).call(ea,Ui(Ve,$)).call(ea,w?J:{}).node(),lt=+m<N[0],Ge=+y<N[1],rt=[+m-+h,+y-+p],st=eo(Ke,rt,pe,N,lt,Ge),ut=P&&new yl({id:"startMarker",style:Object.assign({x:0,y:0},uo(Z,"startMarker"))}),jt=I&&new yl({id:"endMarker",style:Object.assign({x:0,y:0},uo(Z,"endMarker"))});Ra(e).maybeAppend("connector","path").style("zIndex",0).style("d",st).style("markerStart",ut).style("markerEnd",jt).call(ea,R?Oe:{})});function Wi(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);return r}function ka(e,t,n,r){const i=t.length/2,s=t.slice(0,i),l=t.slice(i);let u=Wi(s,(w,R)=>Math.abs(w[1]-l[R][1]));u=Math.max(Math.min(u,i-2),1);const h=w=>[s[w][0],(s[w][1]+l[w][1])/2],p=h(u),m=h(u-1),y=h(u+1),b=vp(ru(y,m))/Math.PI*180;return{x:p[0],y:p[1],transform:`rotate(${b})`,textAlign:"center",textBaseline:"middle"}}function ws(e,t,n,r){const{bounds:i}=n,[[s,l],[u,h]]=i,p=u-s,m=h-l,y=b=>{const{x:w,y:R}=b,P=q1(n.x,p),I=q1(n.y,m);return Object.assign(Object.assign({},b),{x:(P||w)+s,y:(I||R)+l})};return y(e==="left"?{x:0,y:m/2,textAlign:"start",textBaseline:"middle"}:e==="right"?{x:p,y:m/2,textAlign:"end",textBaseline:"middle"}:e==="top"?{x:p/2,y:0,textAlign:"center",textBaseline:"top"}:e==="bottom"?{x:p/2,y:m,textAlign:"center",textBaseline:"bottom"}:e==="top-left"?{x:0,y:0,textAlign:"start",textBaseline:"top"}:e==="top-right"?{x:p,y:0,textAlign:"end",textBaseline:"top"}:e==="bottom-left"?{x:0,y:m,textAlign:"start",textBaseline:"bottom"}:e==="bottom-right"?{x:p,y:m,textAlign:"end",textBaseline:"bottom"}:{x:p/2,y:m/2,textAlign:"center",textBaseline:"middle"})}function ta(e,t,n,r){const{y:i,y1:s,autoRotate:l,rotateToAlignArc:u}=n,h=r.getCenter(),p=Gv(r,t,[i,s]),{innerRadius:m,outerRadius:y,startAngle:b,endAngle:w}=p,R=e==="inside"?(b+w)/2:w,P=Us(R,l,u),I=(()=>{const[N,z]=t,Z=m+(y-m)*.5,[Y,$]=e==="inside"?ts(h,R,Z):LS(N,z);return{x:Y,y:$}})();return Object.assign(Object.assign({},I),{textAlign:e==="inside"?"center":"start",textBaseline:"middle",rotate:P})}function ts(e,t,n){return[e[0]+Math.sin(t)*n,e[1]-Math.cos(t)*n]}function Us(e,t,n){if(!t)return 0;const r=n?0:Math.sin(e)<0?90:-90;return e/Math.PI*180+r}function Nh(e,t,n,r){const{y:i,y1:s,autoRotate:l,rotateToAlignArc:u,radius:h=.5,offset:p=0}=n,m=Gv(r,t,[i,s]),{startAngle:y,endAngle:b}=m,w=r.getCenter(),R=(y+b)/2,I={textAlign:"center",textBaseline:"middle",rotate:Us(R,l,u)},{innerRadius:N,outerRadius:z}=m,Y=N+(z-N)*h+p,[$,J]=ts(w,R,Y);return Object.assign({x:$,y:J},I)}function Bh(e){return e===void 0?null:e}function Fh(e,t,n,r){const{bounds:i}=n,[s]=i;return{x:Bh(s[0]),y:Bh(s[1])}}function dh(e,t,n,r){const{bounds:i}=n;return i.length===1?Fh(e,t,n,r):(Hy(r)?ta:Ig(r)?Nh:ws)(e,t,n,r)}function tv(e,t,n,r,i){const[s,l]=ts(e,t,n),[u,h]=ts(e,t,r),p=Math.sin(t)>0?1:-1;return[[s,l],[u,h],[u+p*i,h]]}function hd(e,t,n){const r=Gv(n,e,[t.y,t.y1]),{innerRadius:i,outerRadius:s}=r;return i+(s-i)}function qg(e,t,n){const r=Gv(n,e,[t.y,t.y1]),{startAngle:i,endAngle:s}=r;return(i+s)/2}function Sx(e,t,n,r){const{autoRotate:i,rotateToAlignArc:s,offset:l=0,connector:u=!0,connectorLength:h=l,connectorLength2:p=0,connectorDistance:m=0}=n,y=r.getCenter(),b=qg(t,n,r),w=Math.sin(b)>0?1:-1,R=Us(b,i,s),P={textAlign:w>0||Hy(r)?"start":"end",textBaseline:"middle",rotate:R},I=hd(t,n,r),N=I+(u?h:l),[[z,Z],[Y,$],[J,ae]]=tv(y,b,I,N,u?p:0),pe=u?+m*w:0,Oe=J+pe,Ve=ae,Ke={connector:u,connectorPoints:[[Y-Oe,$-Ve],[J-Oe,ae-Ve]]};return Object.assign(Object.assign({x0:z,y0:Z,x:J+pe,y:ae},P),Ke)}function vO(e,t,n,r){const{bounds:i}=n;return i.length===1?Fh(e,t,n,r):(Hy(r)?ta:Ig(r)?Sx:ws)(e,t,n,r)}function iu(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gO(e,t){return Array.from(t,n=>e[n])}function Kp(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,s)=>s);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,s)=>{for(const l of t){const u=l1(l[i],l[s]);if(u)return u}})):(n=e.map(n),r.sort((i,s)=>l1(n[i],n[s]))),gO(e,r)}return e.sort(BS(n))}function BS(e=iu){if(e===iu)return l1;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function l1(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function FS(e,t={}){const{labelHeight:n=14,height:r}=t,i=Kp(e,p=>p.y),s=i.length,l=new Array(s);for(let p=0;p<s;p++){const m=i[p],{y}=m;l[p]={y,y1:y+n,labels:[y]}}let u=!0;for(;u;){u=!1;for(let p=l.length-1;p>0;p--){const m=l[p],y=l[p-1];if(y.y1>m.y){u=!0,y.labels.push(...m.labels),l.splice(p,1),y.y1+=m.y1-m.y;const b=y.y1-y.y;y.y1=Math.max(Math.min(y.y1,r),b),y.y=y.y1-b}}}let h=0;for(const p of l){const{y:m,labels:y}=p;let b=m-n;for(const w of y){const R=i[h++],I=b+n-w;R.connectorPoints[0][1]-=I,R.y=b+n,b+=n}}}function ca(e,t){const n=Kp(e,u=>u.y),{height:r,labelHeight:i=14}=t,s=Math.ceil(r/i);if(n.length<=s)return FS(n,t);const l=[];for(let u=0;u<n.length;u++)u<n.length-s?(n[u].opacity=0,n[u].connector=!1):l.push(n[u]);FS(l,t)}var Ks=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const el=new WeakMap;function po(e,t,n){const{connectorLength:r,connectorLength2:i,connectorDistance:s}=t,l=Ks(Sx("outside",e,t,n),[]),u=n.getCenter(),h=hd(e,t,n),p=qg(e,t,n),m=h+r+i,y=Math.sin(p)>0?1:-1,b=u[0]+(m+ +s)*y,{x:w}=l,R=b-w;return l.x+=R,l.connectorPoints[0][0]-=R,l}function dd(e,t,n,r,i,s){if(!Ig(r))return{};if(el.has(t))return el.get(t);const l=s.map(b=>po(b,n,r)),{width:u,height:h}=r.getOptions(),p=l.filter(b=>b.x<u/2),m=l.filter(b=>b.x>=u/2),y=Object.assign(Object.assign({},i),{height:h});return ca(p,y),ca(m,y),l.forEach((b,w)=>el.set(s[w],b)),el.get(t)}var gc=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Bd(e,t,n,r){if(!Ig(r))return{};const{connectorLength:i,connectorLength2:s,connectorDistance:l}=n,u=gc(Sx("outside",t,n,r),[]),{x0:h,y0:p}=u,m=r.getCenter(),b=dA(r)+i,w=Yg([h-m[0],p-m[1]]),R=Math.sin(w)>0?1:-1,[P,I]=ts(m,w,b);return u.x=P+(s+l)*R,u.y=I,u}var pd=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Xv(e,t){return e!==void 0?e:Ig(t)?"inside":pc(t)?"right":"top"}function kS(e,t,n,r,i,s){const{position:l}=t,{render:u}=i,h=Xv(l,n),m=r[u?"htmlLabel":h==="inside"?"innerLabel":"label"],y=Object.assign({},m,t),b=ee[Kg(h)];if(!b)throw new Error(`Unknown position: ${h}`);return Object.assign(Object.assign({},m),b(h,e,y,n,i,s))}const DP=(e,t)=>{const{coordinate:n,theme:r}=t,{render:i}=e;return(s,l,u,h)=>{const{text:p,x:m,y,transform:b="",transformOrigin:w,className:R=""}=l,P=pd(l,["text","x","y","transform","transformOrigin","className"]),I=kS(s,l,n,r,e,h),{rotate:N=0,transform:z=""}=I,Z=pd(I,["rotate","transform"]);return Ra(new Wr).call(ea,Z).style("text",`${p}`).style("className",`${R} g2-label`).style("innerHTML",i?i(p,l.datum,l.index):void 0).style("labelTransform",`${z} rotate(${+N}) ${b}`.trim()).style("labelTransformOrigin",w).style("coordCenter",n.getCenter()).call(ea,P).node()}};DP.props={defaultMarker:"point"};var Dk=function(e,t){if(!Mg(e))return e;for(var n=[],r=0;r<e.length;r++){var i=e[r];t(i,r)&&n.push(i)}return n},NP=Dk;function Nk(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Qg(e){let t,n,r;e.length!==2?(t=iu,n=(u,h)=>iu(e(u),h),r=(u,h)=>e(u)-h):(t=e===iu||e===Nk?e:Bk,n=e,r=e);function i(u,h,p=0,m=u.length){if(p<m){if(t(h,h)!==0)return m;do{const y=p+m>>>1;n(u[y],h)<0?p=y+1:m=y}while(p<m)}return p}function s(u,h,p=0,m=u.length){if(p<m){if(t(h,h)!==0)return m;do{const y=p+m>>>1;n(u[y],h)<=0?p=y+1:m=y}while(p<m)}return p}function l(u,h,p=0,m=u.length){const y=i(u,h,p,m-1);return y>p&&r(u[y-1],h)>-r(u[y],h)?y-1:y}return{left:i,center:l,right:s}}function Bk(){return 0}function yO(e){return e===null?NaN:+e}function*Fk(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const BP=Qg(iu),kk=BP.right,zk=BP.left,Uk=Qg(yO).center;var jk=kk;function Vk(e,t,n){return Math.min(n,Math.max(t,e))}function Tx(e){return!!e.getBandWidth}function j_(e,t,n){if(!Tx(e))return e.invert(t);const{adjustedRange:r}=e,{domain:i}=e.getOptions(),s=n?-1:0,l=e.getStep(),u=n?r:r.map(m=>m+l),h=zk(u,t),p=Vk(h+s,0,i.length-1);return i[p]}function Jg(e,t,n){if(!t)return e.getOptions().domain;if(!Tx(e)){const h=Kp(t);if(!n)return h;const[p]=h,{range:m}=e.getOptions(),[y,b]=m,w=y>b?-1:1,R=e.invert(e.map(p)+w*n);return[p,R]}const{domain:r}=e.getOptions(),i=t[0],s=r.indexOf(i);if(n){const h=s+Math.round(r.length*n);return r.slice(s,h)}const l=t[t.length-1],u=r.indexOf(l);return r.slice(s,u+1)}function zS(e,t,n,r,i,s){const{x:l,y:u}=i,h=(w,R)=>{const[P,I]=s.invert(w);return[j_(l,P,R),j_(u,I,R)]},p=h([e,t],!0),m=h([n,r],!1),y=Jg(l,[p[0],m[0]]),b=Jg(u,[p[1],m[1]]);return[y,b]}function US(e,t){const[n,r]=e,i=s=>s.getStep?s.getStep():0;return[t.map(n),t.map(r)+i(t)]}function Hk(e,t,n){const{x:r,y:i}=t,[s,l]=e,u=US(s,r),h=US(l,i),p=[u[0],h[0]],m=[u[1],h[1]],[y,b]=n.map(p),[w,R]=n.map(m);return[y,b,w,R]}const FP=Math.abs,md=Math.atan2,c1=Math.cos,Zk=Math.max,_O=Math.min,nv=Math.sin,V_=Math.sqrt,vd=1e-12,Ax=Math.PI,jS=Ax/2,Wk=2*Ax;function Gk(e){return e>1?0:e<-1?Ax:Math.acos(e)}function kP(e){return e>=1?jS:e<=-1?-jS:Math.asin(e)}function Xk(e){return e.innerRadius}function Yk(e){return e.outerRadius}function $k(e){return e.startAngle}function Kk(e){return e.endAngle}function qk(e){return e&&e.padAngle}function Qk(e,t,n,r,i,s,l,u){var h=n-e,p=r-t,m=l-i,y=u-s,b=y*h-m*p;if(!(b*b<vd))return b=(m*(t-s)-y*(e-i))/b,[e+b*h,t+b*p]}function VS(e,t,n,r,i,s,l){var u=e-n,h=t-r,p=(l?s:-s)/V_(u*u+h*h),m=p*h,y=-p*u,b=e+m,w=t+y,R=n+m,P=r+y,I=(b+R)/2,N=(w+P)/2,z=R-b,Z=P-w,Y=z*z+Z*Z,$=i-s,J=b*P-R*w,ae=(Z<0?-1:1)*V_(Zk(0,$*$*Y-J*J)),pe=(J*Z-z*ae)/Y,Oe=(-J*z-Z*ae)/Y,Ve=(J*Z+z*ae)/Y,Ke=(-J*z+Z*ae)/Y,lt=pe-I,Ge=Oe-N,rt=Ve-I,st=Ke-N;return lt*lt+Ge*Ge>rt*rt+st*st&&(pe=Ve,Oe=Ke),{cx:pe,cy:Oe,x01:-m,y01:-y,x11:pe*(i/$-1),y11:Oe*(i/$-1)}}function HS(){var e=Xk,t=Yk,n=o(0),r=null,i=$k,s=Kk,l=qk,u=null,h=Lt(p);function p(){var m,y,b=+e.apply(this,arguments),w=+t.apply(this,arguments),R=i.apply(this,arguments)-jS,P=s.apply(this,arguments)-jS,I=FP(P-R),N=P>R;if(u||(u=m=h()),w<b&&(y=w,w=b,b=y),!(w>vd))u.moveTo(0,0);else if(I>Wk-vd)u.moveTo(w*c1(R),w*nv(R)),u.arc(0,0,w,R,P,!N),b>vd&&(u.moveTo(b*c1(P),b*nv(P)),u.arc(0,0,b,P,R,N));else{var z=R,Z=P,Y=R,$=P,J=I,ae=I,pe=l.apply(this,arguments)/2,Oe=pe>vd&&(r?+r.apply(this,arguments):V_(b*b+w*w)),Ve=_O(FP(w-b)/2,+n.apply(this,arguments)),Ke=Ve,lt=Ve,Ge,rt;if(Oe>vd){var st=kP(Oe/b*nv(pe)),ut=kP(Oe/w*nv(pe));(J-=st*2)>vd?(st*=N?1:-1,Y+=st,$-=st):(J=0,Y=$=(R+P)/2),(ae-=ut*2)>vd?(ut*=N?1:-1,z+=ut,Z-=ut):(ae=0,z=Z=(R+P)/2)}var jt=w*c1(z),At=w*nv(z),zt=b*c1($),wn=b*nv($);if(Ve>vd){var Hn=w*c1(Z),rr=w*nv(Z),or=b*c1(Y),Hr=b*nv(Y),ui;if(I<Ax)if(ui=Qk(jt,At,or,Hr,Hn,rr,zt,wn)){var Qi=jt-ui[0],ii=At-ui[1],ti=Hn-ui[0],Po=rr-ui[1],Ji=1/nv(Gk((Qi*ti+ii*Po)/(V_(Qi*Qi+ii*ii)*V_(ti*ti+Po*Po)))/2),Vi=V_(ui[0]*ui[0]+ui[1]*ui[1]);Ke=_O(Ve,(b-Vi)/(Ji-1)),lt=_O(Ve,(w-Vi)/(Ji+1))}else Ke=lt=0}ae>vd?lt>vd?(Ge=VS(or,Hr,jt,At,w,lt,N),rt=VS(Hn,rr,zt,wn,w,lt,N),u.moveTo(Ge.cx+Ge.x01,Ge.cy+Ge.y01),lt<Ve?u.arc(Ge.cx,Ge.cy,lt,md(Ge.y01,Ge.x01),md(rt.y01,rt.x01),!N):(u.arc(Ge.cx,Ge.cy,lt,md(Ge.y01,Ge.x01),md(Ge.y11,Ge.x11),!N),u.arc(0,0,w,md(Ge.cy+Ge.y11,Ge.cx+Ge.x11),md(rt.cy+rt.y11,rt.cx+rt.x11),!N),u.arc(rt.cx,rt.cy,lt,md(rt.y11,rt.x11),md(rt.y01,rt.x01),!N))):(u.moveTo(jt,At),u.arc(0,0,w,z,Z,!N)):u.moveTo(jt,At),!(b>vd)||!(J>vd)?u.lineTo(zt,wn):Ke>vd?(Ge=VS(zt,wn,Hn,rr,b,-Ke,N),rt=VS(jt,At,or,Hr,b,-Ke,N),u.lineTo(Ge.cx+Ge.x01,Ge.cy+Ge.y01),Ke<Ve?u.arc(Ge.cx,Ge.cy,Ke,md(Ge.y01,Ge.x01),md(rt.y01,rt.x01),!N):(u.arc(Ge.cx,Ge.cy,Ke,md(Ge.y01,Ge.x01),md(Ge.y11,Ge.x11),!N),u.arc(0,0,b,md(Ge.cy+Ge.y11,Ge.cx+Ge.x11),md(rt.cy+rt.y11,rt.cx+rt.x11),N),u.arc(rt.cx,rt.cy,Ke,md(rt.y11,rt.x11),md(rt.y01,rt.x01),!N))):u.arc(0,0,b,$,Y,N)}if(u.closePath(),m)return u=null,m+""||null}return p.centroid=function(){var m=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,y=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Ax/2;return[c1(y)*m,nv(y)*m]},p.innerRadius=function(m){return arguments.length?(e=typeof m=="function"?m:o(+m),p):e},p.outerRadius=function(m){return arguments.length?(t=typeof m=="function"?m:o(+m),p):t},p.cornerRadius=function(m){return arguments.length?(n=typeof m=="function"?m:o(+m),p):n},p.padRadius=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:o(+m),p):r},p.startAngle=function(m){return arguments.length?(i=typeof m=="function"?m:o(+m),p):i},p.endAngle=function(m){return arguments.length?(s=typeof m=="function"?m:o(+m),p):s},p.padAngle=function(m){return arguments.length?(l=typeof m=="function"?m:o(+m),p):l},p.context=function(m){return arguments.length?(u=m==null?null:m,p):u},p}var ZS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function zP(e,t,n,r,i={}){const{inset:s=0,radius:l=0,insetLeft:u=s,insetTop:h=s,insetRight:p=s,insetBottom:m=s,radiusBottomLeft:y=l,radiusBottomRight:b=l,radiusTopLeft:w=l,radiusTopRight:R=l,minWidth:P=-1/0,maxWidth:I=1/0,minHeight:N=-1/0}=i,z=ZS(i,["inset","radius","insetLeft","insetTop","insetRight","insetBottom","radiusBottomLeft","radiusBottomRight","radiusTopLeft","radiusTopRight","minWidth","maxWidth","minHeight"]);if(!Nl(r)&&!wE(r)){const pe=!!pc(r),[Oe,,Ve]=pe?s1(t):t,[Ke,lt]=Oe,[Ge,rt]=ru(Ve,Oe),st=Ge>0?Ke:Ke+Ge,ut=rt>0?lt:lt+rt,jt=Math.abs(Ge),At=Math.abs(rt),zt=st+u,wn=ut+h,Hn=jt-(u+p),rr=At-(h+m),or=pe?Vy(Hn,N,1/0):Vy(Hn,P,I),Hr=pe?Vy(rr,P,I):Vy(rr,N,1/0),ui=pe?zt:zt-(or-Hn)/2,Qi=pe?wn-(Hr-rr)/2:wn-(Hr-rr);return Ra(e.createElement("rect",{})).style("x",ui).style("y",Qi).style("width",or).style("height",Hr).style("radius",[w,R,b,y]).call(ea,z).node()}const{y:Z,y1:Y}=n,$=r.getCenter(),J=Gv(r,t,[Z,Y]),ae=HS().cornerRadius(l).padAngle(s*Math.PI/180);return Ra(e.createElement("path",{})).style("d",ae(J)).style("transform",`translate(${$[0]}, ${$[1]})`).style("radius",l).style("inset",s).call(ea,z).node()}const Cx=(e,t)=>{const{colorAttribute:n,opacityAttribute:r="fill",first:i=!0,last:s=!0}=e,l=ZS(e,["colorAttribute","opacityAttribute","first","last"]),{coordinate:u,document:h}=t;return(p,m,y)=>{const{color:b,radius:w=0}=y,R=ZS(y,["color","radius"]),P=R.lineWidth||1,{stroke:I,radius:N=w,radiusTopLeft:z=N,radiusTopRight:Z=N,radiusBottomRight:Y=N,radiusBottomLeft:$=N,innerRadius:J=0,innerRadiusTopLeft:ae=J,innerRadiusTopRight:pe=J,innerRadiusBottomRight:Oe=J,innerRadiusBottomLeft:Ve=J,lineWidth:Ke=n==="stroke"||I?P:0,inset:lt=0,insetLeft:Ge=lt,insetRight:rt=lt,insetBottom:st=lt,insetTop:ut=lt,minWidth:jt,maxWidth:At,minHeight:zt}=l,wn=ZS(l,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","lineWidth","inset","insetLeft","insetRight","insetBottom","insetTop","minWidth","maxWidth","minHeight"]),{color:Hn=b,opacity:rr}=m,or=[i?z:ae,i?Z:pe,s?Y:Oe,s?$:Ve],Hr=["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"];pc(u)&&Hr.push(Hr.shift());const ui=Object.assign(Object.assign({radius:N},Object.fromEntries(Hr.map((Qi,ii)=>[Qi,or[ii]]))),{inset:lt,insetLeft:Ge,insetRight:rt,insetBottom:st,insetTop:ut,minWidth:jt,maxWidth:At,minHeight:zt});return Ra(zP(h,p,m,u,ui)).call(ea,R).style("fill","transparent").style(n,Hn).style(U_(e),rr).style("lineWidth",Ke).style("stroke",I===void 0?Hn:I).call(ea,wn).node()}};Cx.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Jk={visibility:"visible",opacity:1,fillOpacity:1,strokeOpacity:1};function e7(e,t){var n;return(n=e.style[t])!==null&&n!==void 0?n:Jk[t]}function bO(e,t,n,r){e.style[t]=n,r&&e.children.forEach(i=>bO(i,t,n,r))}function xO(e){bO(e,"visibility","hidden",!0)}function WS(e){bO(e,"visibility","visible",!0)}var Ox=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function ey(e){return Ra(e).selectAll(`.${Ut}`).nodes().filter(t=>!t.__removed__)}function UP(e,t){return EO(e,t).flatMap(({container:n})=>ey(n))}function EO(e,t){return t.filter(n=>n!==e&&n.options.parentKey===e.options.key)}function rv(e){return Ra(e).select(`.${Me}`).node()}function jP(e){if(e.tagName==="g")return e.getRenderBounds();const t=e.getGeometryBounds(),n=new Rn;return n.setFromTransformedAABB(t,e.getWorldTransform()),n}function Rx(e,t){const{offsetX:n,offsetY:r}=t,i=jP(e),{min:[s,l],max:[u,h]}=i,p=n<s||n>u,m=r<l||r>h;return p||m?null:[n-s,r-l]}function SO(e,t){const{offsetX:n,offsetY:r}=t,[i,s,l,u]=t7(e);return[Math.min(l,Math.max(i,n))-i,Math.min(u,Math.max(s,r))-s]}function t7(e){const t=e.getRenderBounds(),{min:[n,r],max:[i,s]}=t;return[n,r,i,s]}function VP(e){return t=>t.__data__.color}function TO(e){return t=>t.__data__.x}function u1(e){const t=Array.isArray(e)?e:[e],n=new Map(t.flatMap(r=>Array.from(r.markState.keys()).map(s=>[GS(r.key,s.key),s.data])));return r=>{const{index:i,markKey:s,viewKey:l}=r.__data__;return n.get(GS(l,s))[i]}}function Yv(e,t=(r,i)=>r,n=(r,i,s)=>r.setAttribute(i,s)){const r="__states__",i="__ordinal__",s=m=>{const{[r]:y=[],[i]:b={}}=m,w=y.reduce((R,P)=>Object.assign(Object.assign({},R),e[P]),b);if(Object.keys(w).length!==0){for(const[R,P]of Object.entries(w)){const I=e7(m,R),N=t(P,m);n(m,R,N),R in b||(b[R]=I)}m[i]=b}},l=m=>{m[r]||(m[r]=[])};return{setState:(m,...y)=>{l(m),m[r]=[...y],s(m)},removeState:(m,...y)=>{l(m);for(const b of y){const w=m[r].indexOf(b);w!==-1&&m[r].splice(w,1)}s(m)},hasState:(m,y)=>(l(m),m[r].indexOf(y)!==-1)}}function n7(e){return e===void 0?!0:typeof e!="object"?!1:Object.keys(e).length===0}function GS(e,t){return`${e},${t}`}function H_(e,t){const r=(Array.isArray(e)?e:[e]).flatMap(s=>s.marks.map(l=>[GS(s.key,l.key),l.state])),i={};for(const s of t){const[l,u]=Array.isArray(s)?s:[s,{}];i[l]=r.reduce((h,p)=>{const[m,y={}]=p,b=n7(y[l])?u:y[l];for(const[w,R]of Object.entries(b)){const P=h[w],I=(N,z,Z,Y)=>{const $=GS(Y.__data__.viewKey,Y.__data__.markKey);return m!==$?P==null?void 0:P(N,z,Z,Y):typeof R!="function"?R:R(N,z,Z,Y)};h[w]=I}return h},{})}return i}function Mx(e,t){const n=new Map(e.map((i,s)=>[i,s])),r=t?e.map(t):e;return(i,s)=>{if(typeof i!="function")return i;const l=n.get(s),u=t?t(s):s;return i(u,l,r,s)}}function HP(e){var{link:t=!1,valueof:n=(m,y)=>m,coordinate:r}=e,i=Ox(e,["link","valueof","coordinate"]);const s="element-link";if(!t)return[()=>{},()=>{}];const l=m=>m.__data__.points,u=(m,y)=>{const[,b,w]=m,[R,,,P]=y;return[b,R,P,w]};return[m=>{var y;if(m.length<=1)return;const b=Kp(m,(w,R)=>{const{x:P}=w.__data__,{x:I}=R.__data__;return P-I});for(let w=1;w<b.length;w++){const R=Ee(),P=b[w-1],I=b[w],[N,z,Z,Y]=u(l(P),l(I));R.moveTo(...N),R.lineTo(...z),R.lineTo(...Z),R.lineTo(...Y),R.closePath();const $=E0(i,Oe=>n(Oe,P)),{fill:J=P.getAttribute("fill")}=$,ae=Ox($,["fill"]),pe=new Mo({className:s,style:Object.assign({d:R.toString(),fill:J,zIndex:-2},ae)});(y=P.link)===null||y===void 0||y.remove(),P.parentNode.appendChild(pe),P.link=pe}},m=>{var y;(y=m.link)===null||y===void 0||y.remove(),m.link=null}]}function ZP(e,t,n){const r=i=>{const{transform:s}=e.style;return s?`${s} ${i}`:i};if(Nl(n)){const{points:i}=e.__data__,[s,l]=pc(n)?s1(i):i,u=n.getCenter(),h=ru(s,u),p=ru(l,u),m=vp(h),y=z_(h,p),b=m+y/2,w=t*Math.cos(b),R=t*Math.sin(b);return r(`translate(${w}, ${R})`)}return pc(n)?r(`translate(${t}, 0)`):r(`translate(0, ${-t})`)}function WP(e){var{document:t,background:n,scale:r,coordinate:i,valueof:s}=e,l=Ox(e,["document","background","scale","coordinate","valueof"]);const u="element-background";if(!n)return[()=>{},()=>{}];const h=(N,z,Z)=>{const Y=N.invert(z),$=z+N.getBandWidth(Y)/2,J=N.getStep(Y)/2,ae=J*Z;return[$-J+ae,$+J-ae]},p=(N,z)=>{const{x:Z}=r;if(!Tx(Z))return[0,1];const{__data__:Y}=N,{x:$}=Y,[J,ae]=h(Z,$,z);return[J,ae]},m=(N,z)=>{const{y:Z}=r;if(!Tx(Z))return[0,1];const{__data__:Y}=N,{y:$}=Y,[J,ae]=h(Z,$,z);return[J,ae]},y=(N,z)=>{const{padding:Z}=z,[Y,$]=p(N,Z),[J,ae]=m(N,Z),pe=[[Y,J],[$,J],[$,ae],[Y,ae]].map(lt=>i.map(lt)),{__data__:Oe}=N,{y:Ve,y1:Ke}=Oe;return zP(t,pe,{y:Ve,y1:Ke},i,z)},b=(N,z)=>{const{transform:Z="scale(1.2, 1.2)",transformOrigin:Y="center center",stroke:$=""}=z,J=Ox(z,["transform","transformOrigin","stroke"]),ae=Object.assign({transform:Z,transformOrigin:Y,stroke:$},J),pe=N.cloneNode(!0);for(const[Oe,Ve]of Object.entries(ae))pe.style[Oe]=Ve;return pe},w=()=>{const{x:N,y:z}=r;return[N,z].some(Tx)};return[N=>{N.background&&N.background.remove();const z=E0(l,lt=>s(lt,N)),{fill:Z="#CCD6EC",fillOpacity:Y=.3,zIndex:$=-2,padding:J=.001,lineWidth:ae=0}=z,pe=Ox(z,["fill","fillOpacity","zIndex","padding","lineWidth"]),Oe=Object.assign(Object.assign({},pe),{fill:Z,fillOpacity:Y,zIndex:$,padding:J,lineWidth:ae}),Ke=(w()?y:b)(N,Oe);Ke.className=u,N.parentNode.parentNode.appendChild(Ke),N.background=Ke},N=>{var z;(z=N.background)===null||z===void 0||z.remove(),N.background=null},N=>N.className===u]}function ty(e,t){const r=e.getRootNode().defaultView.getContextService().getDomElement();r!=null&&r.style&&(e.cursor=r.style.cursor,r.style.cursor=t)}function r7(e){ty(e,e.cursor)}function wO(e,t,n){return e.find(r=>Object.entries(t).every(([i,s])=>n(r)[i]===s))}function XS(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Px(e,t=!1){const n=NP(e,r=>!!r).map((r,i)=>[i===0?"M":"L",...r]);return t&&n.push(["Z"]),n}function GP(e){return e.querySelectorAll(".element")}function i7(e,t,n=0){const r=[["M",...t[1]]],i=XS(e,t[1]),s=XS(e,t[0]);return i===0?r.push(["L",...t[3]],["A",s,s,0,n,1,...t[0]],["Z"]):r.push(["A",i,i,0,n,0,...t[2]],["L",...t[3]],["A",s,s,0,n,1,...t[0]],["Z"]),r}function YS(e,t){if(t(e))return e;let n=e.parent;for(;n&&!t(n);)n=n.parent;return n}function XP(e,t){const{__data__:n}=e,{markKey:r,index:i,seriesIndex:s}=n,{markState:l}=t,u=Array.from(l.keys()).find(h=>h.key===r);if(u)return s?s.map(h=>u.data[h]):u.data[i]}function o7(e){return YS(e,t=>t.className==="component")}function a7(e){return YS(e,t=>t.className==="element")}function s7(e){return YS(e,t=>t.className==="label")}function ph(e,t,n,r=i=>!0){return i=>{if(!r(i))return;n.emit(`plot:${e}`,i);const{target:s}=i;if(!s)return;const{className:l}=s;if(l==="plot")return;const u=a7(s),h=o7(s),p=s7(s),m=u||h||p;if(!m)return;const{className:y,markType:b}=m,w=Object.assign(Object.assign({},i),{nativeEvent:!0});y==="element"?(w.data={data:XP(m,t)},n.emit(`element:${e}`,w),n.emit(`${b}:${e}`,w)):y==="label"?(w.data={data:m.attributes.datum},n.emit(`label:${e}`,w),n.emit(`${l}:${e}`,w)):(n.emit(`component:${e}`,w),n.emit(`${l}:${e}`,w))}}function YP(){return(e,t,n)=>{const{container:r,view:i}=e,s=ph(gl.CLICK,i,n,ae=>ae.detail===1),l=ph(gl.DBLCLICK,i,n,ae=>ae.detail===2),u=ph(gl.POINTER_TAP,i,n),h=ph(gl.POINTER_DOWN,i,n),p=ph(gl.POINTER_UP,i,n),m=ph(gl.POINTER_OVER,i,n),y=ph(gl.POINTER_OUT,i,n),b=ph(gl.POINTER_MOVE,i,n),w=ph(gl.POINTER_ENTER,i,n),R=ph(gl.POINTER_LEAVE,i,n),P=ph(gl.POINTER_UPOUTSIDE,i,n),I=ph(gl.DRAG_START,i,n),N=ph(gl.DRAG,i,n),z=ph(gl.DRAG_END,i,n),Z=ph(gl.DRAG_ENTER,i,n),Y=ph(gl.DRAG_LEAVE,i,n),$=ph(gl.DRAG_OVER,i,n),J=ph(gl.DROP,i,n);return r.addEventListener("click",s),r.addEventListener("click",l),r.addEventListener("pointertap",u),r.addEventListener("pointerdown",h),r.addEventListener("pointerup",p),r.addEventListener("pointerover",m),r.addEventListener("pointerout",y),r.addEventListener("pointermove",b),r.addEventListener("pointerenter",w),r.addEventListener("pointerleave",R),r.addEventListener("pointerupoutside",P),r.addEventListener("dragstart",I),r.addEventListener("drag",N),r.addEventListener("dragend",z),r.addEventListener("dragenter",Z),r.addEventListener("dragleave",Y),r.addEventListener("dragover",$),r.addEventListener("drop",J),()=>{r.removeEventListener("click",s),r.removeEventListener("click",l),r.removeEventListener("pointertap",u),r.removeEventListener("pointerdown",h),r.removeEventListener("pointerup",p),r.removeEventListener("pointerover",m),r.removeEventListener("pointerout",y),r.removeEventListener("pointermove",b),r.removeEventListener("pointerenter",w),r.removeEventListener("pointerleave",R),r.removeEventListener("pointerupoutside",P),r.removeEventListener("dragstart",I),r.removeEventListener("drag",N),r.removeEventListener("dragend",z),r.removeEventListener("dragenter",Z),r.removeEventListener("dragleave",Y),r.removeEventListener("dragover",$),r.removeEventListener("drop",J)}}}YP.props={reapplyWhenUpdate:!0};function l7(){return{"component.axisRadar":Hv,"component.axisLinear":mp,"component.axisArc":pS,"component.legendContinuousBlock":bx,"component.legendContinuousBlockSize":xx,"component.legendContinuousSize":B_,"interaction.event":YP,"composition.mark":PS,"composition.view":IS,"shape.label.label":DP}}var c7=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Hc(e,t){const n=Object.assign(Object.assign({},l7()),t),r=s=>{if(typeof s!="string")return s;const l=`${e}.${s}`;return n[l]||Nv(`Unknown Component: ${l}`)};return[(s,l)=>{const{type:u}=s,h=c7(s,["type"]);u||Nv("Plot type is required!");const p=r(u);return p==null?void 0:p(h,l)},r]}function $P(e){const{canvas:t,group:n}=e;return(t==null?void 0:t.document)||(n==null?void 0:n.ownerDocument)||Nv("Cannot find library document")}var KP=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function u7(e,t,n){const[r]=Hc("coordinate",n),{innerHeight:i,innerWidth:s,insetLeft:l,insetTop:u,insetRight:h,insetBottom:p}=e,{coordinates:m=[]}=t,y=v7(m),b=y[0].type==="cartesian3D",w=Object.assign(Object.assign({},e),{x:l,y:u,width:s-l-h,height:i-p-u,transformations:y.flatMap(r)});return b?new TE.Coordinate3D(w):new TE.Coordinate(w)}function qP(e,t){const{coordinate:n={},coordinates:r}=e,i=KP(e,["coordinate","coordinates"]);if(r)return e;const{type:s,transform:l=[]}=n,u=KP(n,["type","transform"]);if(!s)return Object.assign(Object.assign({},i),{coordinates:l});const[,h]=Hc("coordinate",t),{transform:p=!1}=h(s).props||{};if(p)throw new Error(`Unknown coordinate: ${s}.`);return Object.assign(Object.assign({},i),{coordinates:[Object.assign({type:s},u),...l]})}function sm(e,t){return e.filter(n=>n.type===t)}function f1(e){return sm(e,"polar").length>0}function f7(e){return sm(e,"helix").length>0}function Z_(e){return sm(e,"transpose").length%2===1}function h7(e){return sm(e,"parallel").length>0}function QP(e){return sm(e,"theta").length>0}function d7(e){return sm(e,"reflect").length>0}function Ix(e){return sm(e,"radial").length>0}function p7(e){return sm(e,"radar").length>0}function m7(e){return sm(e,"reflectY").length>0}function v7(e){return e.find(t=>t.type==="cartesian"||t.type==="cartesian3D")?e:[...e,{type:"cartesian"}]}function Ps(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}var g7=Ps("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),y7=Ps("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),_7=Ps("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),b7=Ps("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),x7=Ps("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),E7=Ps("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),S7=Ps("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),T7=Ps("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),w7=Ps("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),A7=Ps("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),C7=Ps("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function $S(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function AO(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function W_(){}var h1=.7,G_=1/h1,X_="\\s*([+-]?\\d+)\\s*",Lx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",iv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",O7=/^#([0-9a-f]{3,8})$/,R7=new RegExp("^rgb\\(".concat(X_,",").concat(X_,",").concat(X_,"\\)$")),M7=new RegExp("^rgb\\(".concat(iv,",").concat(iv,",").concat(iv,"\\)$")),P7=new RegExp("^rgba\\(".concat(X_,",").concat(X_,",").concat(X_,",").concat(Lx,"\\)$")),I7=new RegExp("^rgba\\(".concat(iv,",").concat(iv,",").concat(iv,",").concat(Lx,"\\)$")),L7=new RegExp("^hsl\\(".concat(Lx,",").concat(iv,",").concat(iv,"\\)$")),D7=new RegExp("^hsla\\(".concat(Lx,",").concat(iv,",").concat(iv,",").concat(Lx,"\\)$")),JP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$S(W_,CO,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:eI,formatHex:eI,formatHex8:N7,formatHsl:B7,formatRgb:tI,toString:tI});function eI(){return this.rgb().formatHex()}function N7(){return this.rgb().formatHex8()}function B7(){return sI(this).formatHsl()}function tI(){return this.rgb().formatRgb()}function CO(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=O7.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?nI(t):n===3?new gd(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?KS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?KS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=R7.exec(e))?new gd(t[1],t[2],t[3],1):(t=M7.exec(e))?new gd(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=P7.exec(e))?KS(t[1],t[2],t[3],t[4]):(t=I7.exec(e))?KS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=L7.exec(e))?aI(t[1],t[2]/100,t[3]/100,1):(t=D7.exec(e))?aI(t[1],t[2]/100,t[3]/100,t[4]):JP.hasOwnProperty(e)?nI(JP[e]):e==="transparent"?new gd(NaN,NaN,NaN,0):null}function nI(e){return new gd(e>>16&255,e>>8&255,e&255,1)}function KS(e,t,n,r){return r<=0&&(e=t=n=NaN),new gd(e,t,n,r)}function rI(e){return e instanceof W_||(e=CO(e)),e?(e=e.rgb(),new gd(e.r,e.g,e.b,e.opacity)):new gd}function Dx(e,t,n,r){return arguments.length===1?rI(e):new gd(e,t,n,r==null?1:r)}function gd(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}$S(gd,Dx,AO(W_,{brighter:function(t){return t=t==null?G_:Math.pow(G_,t),new gd(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?h1:Math.pow(h1,t),new gd(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},clamp:function(){return new gd(d1(this.r),d1(this.g),d1(this.b),qS(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iI,formatHex:iI,formatHex8:F7,formatRgb:oI,toString:oI}));function iI(){return"#".concat(p1(this.r)).concat(p1(this.g)).concat(p1(this.b))}function F7(){return"#".concat(p1(this.r)).concat(p1(this.g)).concat(p1(this.b)).concat(p1((isNaN(this.opacity)?1:this.opacity)*255))}function oI(){var e=qS(this.opacity);return"".concat(e===1?"rgb(":"rgba(").concat(d1(this.r),", ").concat(d1(this.g),", ").concat(d1(this.b)).concat(e===1?")":", ".concat(e,")"))}function qS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function d1(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function p1(e){return e=d1(e),(e<16?"0":"")+e.toString(16)}function aI(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new lm(e,t,n,r)}function sI(e){if(e instanceof lm)return new lm(e.h,e.s,e.l,e.opacity);if(e instanceof W_||(e=CO(e)),!e)return new lm;if(e instanceof lm)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),l=NaN,u=s-i,h=(s+i)/2;return u?(t===s?l=(n-r)/u+(n<r)*6:n===s?l=(r-t)/u+2:l=(t-n)/u+4,u/=h<.5?s+i:2-s-i,l*=60):u=h>0&&h<1?0:l,new lm(l,u,h,e.opacity)}function k7(e,t,n,r){return arguments.length===1?sI(e):new lm(e,t,n,r==null?1:r)}function lm(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$S(lm,k7,AO(W_,{brighter:function(t){return t=t==null?G_:Math.pow(G_,t),new lm(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?h1:Math.pow(h1,t),new lm(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,s=2*r-i;return new gd(OO(t>=240?t-240:t+120,s,i),OO(t,s,i),OO(t<120?t+240:t-120,s,i),this.opacity)},clamp:function(){return new lm(lI(this.h),QS(this.s),QS(this.l),qS(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=qS(this.opacity);return"".concat(t===1?"hsl(":"hsla(").concat(lI(this.h),", ").concat(QS(this.s)*100,"%, ").concat(QS(this.l)*100,"%").concat(t===1?")":", ".concat(t,")"))}}));function lI(e){return e=(e||0)%360,e<0?e+360:e}function QS(e){return Math.max(0,Math.min(1,e||0))}function OO(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function cI(e,t,n,r,i){var s=e*e,l=s*e;return((1-3*e+3*s-l)*t+(4-6*s+3*l)*n+(1+3*e+3*s-3*l)*r+l*i)/6}function z7(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],l=r>0?e[r-1]:2*i-s,u=r<t-1?e[r+2]:2*s-i;return cI((n-r/t)*t,l,i,s,u)}}function U7(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],l=e[(r+1)%t],u=e[(r+2)%t];return cI((n-r/t)*t,i,s,l,u)}}var RO=function(e){return function(){return e}};function uI(e,t){return function(n){return e+n*t}}function j7(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function V7(e,t){var n=t-e;return n?uI(e,n>180||n<-180?n-360*Math.round(n/360):n):RO(isNaN(e)?t:e)}function H7(e){return(e=+e)==1?Y_:function(t,n){return n-t?j7(t,n,e):RO(isNaN(t)?n:t)}}function Y_(e,t){var n=t-e;return n?uI(e,n):RO(isNaN(e)?t:e)}var bte=function e(t){var n=H7(t);function r(i,s){var l=n((i=Dx(i)).r,(s=Dx(s)).r),u=n(i.g,s.g),h=n(i.b,s.b),p=Y_(i.opacity,s.opacity);return function(m){return i.r=l(m),i.g=u(m),i.b=h(m),i.opacity=p(m),i+""}}return r.gamma=e,r}(1);function fI(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),l,u;for(l=0;l<n;++l)u=Dx(t[l]),r[l]=u.r||0,i[l]=u.g||0,s[l]=u.b||0;return r=e(r),i=e(i),s=e(s),u.opacity=1,function(h){return u.r=r(h),u.g=i(h),u.b=s(h),u+""}}}var Z7=fI(z7),xte=fI(U7),Lc=e=>Z7(e[e.length-1]),hI=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ps),W7=Lc(hI),dI=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ps),G7=Lc(dI),pI=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ps),X7=Lc(pI),mI=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ps),Y7=Lc(mI),vI=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ps),$7=Lc(vI),gI=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ps),K7=Lc(gI),yI=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ps),q7=Lc(yI),_I=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ps),Q7=Lc(_I),bI=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ps),J7=Lc(bI),xI=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ps),e9=Lc(xI),EI=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ps),t9=Lc(EI),SI=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ps),n9=Lc(SI),TI=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ps),r9=Lc(TI),wI=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ps),i9=Lc(wI),AI=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ps),o9=Lc(AI),CI=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ps),a9=Lc(CI),OI=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ps),s9=Lc(OI),RI=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ps),l9=Lc(RI),MI=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ps),c9=Lc(MI),PI=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ps),u9=Lc(PI),II=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ps),f9=Lc(II),LI=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ps),h9=Lc(LI),DI=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ps),d9=Lc(DI),NI=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ps),p9=Lc(NI),BI=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ps),m9=Lc(BI),FI=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ps),v9=Lc(FI),kI=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ps),g9=Lc(kI);function y9(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}var _9=Math.PI/180,b9=180/Math.PI,zI=-.14861,MO=1.78277,PO=-.29227,JS=-.90649,Nx=1.97294,UI=Nx*JS,jI=Nx*MO,VI=MO*PO-JS*zI;function x9(e){if(e instanceof m1)return new m1(e.h,e.s,e.l,e.opacity);e instanceof gd||(e=rI(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(VI*r+UI*t-jI*n)/(VI+UI-jI),s=r-i,l=(Nx*(n-i)-PO*s)/JS,u=Math.sqrt(l*l+s*s)/(Nx*i*(1-i)),h=u?Math.atan2(l,s)*b9-120:NaN;return new m1(h<0?h+360:h,u,i,e.opacity)}function ov(e,t,n,r){return arguments.length===1?x9(e):new m1(e,t,n,r==null?1:r)}function m1(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$S(m1,ov,AO(W_,{brighter:function(t){return t=t==null?G_:Math.pow(G_,t),new m1(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?h1:Math.pow(h1,t),new m1(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*_9,n=+this.l,r=isNaN(this.s)?0:this.s*n*(1-n),i=Math.cos(t),s=Math.sin(t);return new gd(255*(n+r*(zI*i+MO*s)),255*(n+r*(PO*i+JS*s)),255*(n+r*(Nx*i)),this.opacity)}}));function HI(e){return function t(n){n=+n;function r(i,s){var l=e((i=ov(i)).h,(s=ov(s)).h),u=Y_(i.s,s.s),h=Y_(i.l,s.l),p=Y_(i.opacity,s.opacity);return function(m){return i.h=l(m),i.s=u(m),i.l=h(Math.pow(m,n)),i.opacity=p(m),i+""}}return r.gamma=t,r}(1)}var Ete=HI(V7),IO=HI(Y_),E9=IO(ov(300,.5,0),ov(-240,.5,1)),S9=IO(ov(-100,.75,.35),ov(80,1.5,.8)),T9=IO(ov(260,.75,.35),ov(80,1.5,.8)),eT=ov();function w9(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return eT.h=360*e-100,eT.s=1.5-1.5*t,eT.l=.8-.9*t,eT+""}var tT=Dx(),A9=Math.PI/3,C9=Math.PI*2/3;function O9(e){var t;return e=(.5-e)*Math.PI,tT.r=255*(t=Math.sin(e))*t,tT.g=255*(t=Math.sin(e+A9))*t,tT.b=255*(t=Math.sin(e+C9))*t,tT+""}function R9(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function nT(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var M9=nT(Ps("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),P9=nT(Ps("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),I9=nT(Ps("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),L9=nT(Ps("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function D9(e,t,n,r,i,s){const{guide:l={}}=n,u=Z9(e,t,n);if(typeof u!="string")return n;const h=W9(u,e,t,n),p=j9(u,h,n);return Object.assign(Object.assign(Object.assign({},n),X9(u,e,t,n,r)),{domain:p,range:G9(u,e,t,n,p,i,s),expectedDomain:h,guide:l,name:e,type:u})}function N9(e,t){const n={};for(const r of e){const{values:i,name:s}=r,l=t[s];for(const u of i){const{name:h,value:p}=u;n[h]=p.map(m=>l.map(m))}}return n}function B9(e,t){const n=Array.from(e.values()).flatMap(i=>i.channels);$1(n,i=>i.map(s=>t.get(s.scale.uid)),i=>i.name).filter(([,i])=>i.some(s=>typeof s.getOptions().groupTransform=="function")&&i.every(s=>s.getTicks)).map(i=>i[1]).forEach(i=>{const s=i.map(l=>l.getOptions().groupTransform)[0];s(i)})}function F9(e,t){var n;const{components:r=[]}=t,i=["scale","encode","axis","legend","data","transform"],s=Array.from(new Set(e.flatMap(u=>u.channels.map(h=>h.scale)))),l=new Map(s.map(u=>[u.name,u]));for(const u of r){const h=U9(u);for(const p of h){const m=l.get(p),y=((n=u.scale)===null||n===void 0?void 0:n[p])||{},{independent:b=!1}=y;if(m&&!b){const{guide:w}=m,R=typeof w=="boolean"?{}:w;m.guide=ri({},R,u),Object.assign(m,y)}else{const w=Object.assign(Object.assign({},y),{expectedDomain:y.domain,name:p,guide:ix(u,i)});s.push(w)}}}return s}function k9(e){if(!e||!Array.isArray(e))return[Dv,Dv];let t,n;return[s=>{var l;t=s.map.bind(s),n=(l=s.invert)===null||l===void 0?void 0:l.bind(s);const u=e.filter(([b])=>typeof b=="function"),h=e.filter(([b])=>typeof b!="function"),p=new Map(h);if(s.map=b=>{for(const[w,R]of u)if(w(b))return R;return p.has(b)?p.get(b):t(b)},!n)return s;const m=new Map(h.map(([b,w])=>[w,b])),y=new Map(u.map(([b,w])=>[w,b]));return s.invert=b=>y.has(b)?b:m.has(b)?m.get(b):n(b),s},s=>(t!==null&&(s.map=t),n!==null&&(s.invert=n),s)]}function ZI(e,t){const n=Object.keys(e);for(const r of Object.values(t)){const{name:i}=r.getOptions();if(!(i in e))e[i]=r;else{const s=n.filter(h=>h.startsWith(i)).map(h=>+(h.replace(i,"")||0)),l=Ol(s)+1,u=`${i}${l}`;e[u]=r,r.getOptions().key=u}}return e}function WI(e,t){const[n]=Hc("scale",t),{relations:r}=e,[i]=k9(r),s=n(e);return i(s)}function z9(e){const t=e.flatMap(n=>Array.from(n.values())).flatMap(n=>n.channels.map(r=>r.scale));GI(t,"x"),GI(t,"y")}function U9(e){const{channels:t=[],type:n,scale:r={}}=e,i=["shape","color","opacity","size"];return t.length!==0?t:n==="axisX"?["x"]:n==="axisY"?["y"]:n==="legends"?Object.keys(r).filter(s=>i.includes(s)):[]}function GI(e,t){const n=e.filter(({name:s,facet:l=!0})=>l&&s===t),r=n.flatMap(s=>s.domain),i=n.every(XI)?om(r):n.every(YI)?Array.from(new Set(r)):null;if(i!==null)for(const s of n)s.domain=i}function j9(e,t,n){const{ratio:r}=n;return r==null?t:XI({type:e})?V9(t,r,e):YI({type:e})?H9(t,r):t}function V9(e,t,n){const r=e.map(Number),i=new Gf({domain:r,range:[r[0],r[0]+(r[r.length-1]-r[0])*t]});return n==="time"?e.map(s=>new Date(i.map(s))):e.map(s=>i.map(s))}function H9(e,t){const n=Math.round(e.length*t);return e.slice(0,n)}function XI(e){const{type:t}=e;return typeof t!="string"?!1:["linear","log","pow","time"].includes(t)}function YI(e){const{type:t}=e;return typeof t!="string"?!1:["band","point","ordinal"].includes(t)}function Z9(e,t,n){const{type:r,domain:i,range:s,quantitative:l,ordinal:u}=n;return r!==void 0?r:oz(t)?"identity":typeof s=="string"?"linear":(i||s||[]).length>2?LO(e,u):i!==void 0?QI([i])?LO(e,u):JI(t)?"time":KI(e,s,l):QI(t)?LO(e,u):JI(t)?"time":KI(e,s,l)}function W9(e,t,n,r){const{domain:i}=r;if(i!==void 0)return i;switch(e){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":return qI(ez(n,r),r);case"band":case"ordinal":case"point":return tz(n);case"quantile":return nz(n);case"sequential":return qI(rz(n),r);default:return[]}}function G9(e,t,n,r,i,s,l){const{range:u}=r;if(typeof u=="string")return Y9(u);if(u!==void 0)return u;const{rangeMin:h,rangeMax:p}=r;switch(e){case"linear":case"time":case"log":case"pow":case"sqrt":{const m=$I(n,r,i,s,l),[y,b]=iz(t,m);return[h!=null?h:y,p!=null?p:b]}case"band":case"point":{const m=t==="size"?5:0,y=t==="size"?10:1;return[h!=null?h:m,p!=null?p:y]}case"ordinal":return $I(n,r,i,s,l);case"sequential":return;case"constant":return[n[0][0]];default:return[]}}function X9(e,t,n,r,i){switch(e){case"linear":case"time":case"log":case"pow":case"sqrt":return q9(i,r);case"band":case"point":return Q9(e,t,i,r);case"sequential":return K9(r);default:return r}}function $I(e,t,n,r,i){const[s]=Hc("palette",i),{category10:l,category20:u}=r,h=cA(n).length<=l.length?l:u,{palette:p=h,offset:m}=t;if(Array.isArray(p))return p;try{return s({type:p})}catch(y){const b=$9(p,n,m);if(b)return b;throw new Error(`Unknown Component: ${p} `)}}function Y9(e){return e.split("-")}function $9(e,t,n=r=>r){if(!e)return null;const r=Zm(e),i=X[`scheme${r}`],s=X[`interpolate${r}`];if(!i&&!s)return null;if(i){if(!i.some(Array.isArray))return i;const l=i[t.length];if(l)return l}return t.map((l,u)=>s(n(u/t.length)))}function K9(e){const{palette:t="ylGnBu",offset:n}=e,r=Zm(t),i=X[`interpolate${r}`];if(!i)throw new Error(`Unknown palette: ${r}`);return{interpolator:n?s=>i(n(s)):i}}function q9(e,t){const{interpolate:n=$m,nice:r=!1,tickCount:i=5}=t;return Object.assign(Object.assign({},t),{interpolate:n,nice:r,tickCount:i})}function Q9(e,t,n,r){if(r.padding!==void 0||r.paddingInner!==void 0||r.paddingOuter!==void 0)return Object.assign(Object.assign({},r),{unknown:NaN});const i=J9(e,t,n),{paddingInner:s=i,paddingOuter:l=i}=r;return Object.assign(Object.assign({},r),{paddingInner:s,paddingOuter:l,padding:i,unknown:NaN})}function J9(e,t,n){return t==="enterDelay"||t==="enterDuration"||t==="size"?0:e==="band"?QP(n)?0:.1:e==="point"?.5:0}function LO(e,t){return t||(az(e)?"point":"ordinal")}function KI(e,t,n){return n||(e!=="color"||t?"linear":"sequential")}function qI(e,t){if(e.length===0)return e;const{domainMin:n,domainMax:r}=t,[i,s]=e;return[n!=null?n:i,r!=null?r:s]}function ez(e,t){const{zero:n=!1}=t;let r=1/0,i=-1/0;for(const s of e)for(const l of s)ec(l)&&(r=Math.min(r,+l),i=Math.max(i,+l));return r===1/0?[]:n?[Math.min(0,r),i]:[r,i]}function tz(e){return Array.from(new Set(e.flat()))}function nz(e){return e.flat().sort()}function rz(e){let t=1/0,n=-1/0;for(const r of e)for(const i of r)ec(i)&&(t=Math.min(t,+i),n=Math.max(n,+i));return t===1/0?[]:[t<0?-n:t,n]}function iz(e,t){return e==="enterDelay"?[0,1e3]:e=="enterDuration"?[300,1e3]:e.startsWith("y")||e.startsWith("position")?[1,0]:e==="color"?[lA(t),_E(t)]:e==="opacity"?[0,1]:e==="size"?[1,10]:[0,1]}function QI(e){return DO(e,t=>{const n=typeof t;return n==="string"||n==="boolean"})}function JI(e){return DO(e,t=>t instanceof Date)}function oz(e){return DO(e,Q0)}function DO(e,t){for(const n of e)if(n.some(t))return!0;return!1}function az(e){return e.startsWith("x")||e.startsWith("y")||e.startsWith("position")||e.startsWith("size")}function sz(e){return e.startsWith("x")||e.startsWith("y")||e.startsWith("position")||e==="enterDelay"||e==="enterDuration"||e==="updateDelay"||e==="updateDuration"||e==="exitDelay"||e==="exitDuration"}function lz(e){if(!e||!e.type)return!1;if(typeof e.type=="function")return!0;const{type:t,domain:n,range:r,interpolator:i}=e,s=n&&n.length>0,l=r&&r.length>0;return!!(["linear","sqrt","log","time","pow","threshold","quantize","quantile","ordinal","band","point"].includes(t)&&s&&l||["sequential"].includes(t)&&s&&(l||i)||["constant","identity"].includes(t)&&l)}const cz={linear:"linear",identity:"identity",log:"log",pow:"pow",sqrt:"sqrt",sequential:"sequential"},uz={threshold:"threshold",quantize:"quantize",quantile:"quantile"},fz={ordinal:"ordinal",band:"band",point:"point"},hz={constant:"constant"};var ny=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function dz(e,t,n){const{coordinates:r=[],title:i}=t,[,s]=Hc("component",n),l=e.filter(({guide:m})=>m!==null),u=[],h=Sz(t,e,n);if(u.push(...h),i){const{props:m}=s("title"),{defaultPosition:y,defaultOrientation:b,defaultOrder:w,defaultSize:R,defaultCrossPadding:P}=m,I=typeof i=="string"?{title:i}:i;u.push(Object.assign({type:"title",position:y,orientation:b,order:w,crossPadding:P[0],defaultSize:R},I))}return yz(l,r).forEach(([m,y])=>{const{props:b}=s(m),{defaultPosition:w,defaultPlane:R="xy",defaultOrientation:P,defaultSize:I,defaultOrder:N,defaultLength:z,defaultPadding:Z=[0,0],defaultCrossPadding:Y=[0,0]}=b,$=ri({},...y),{guide:J,field:ae}=$,pe=Array.isArray(J)?J:[J];for(const Oe of pe){const[Ve,Ke]=xz(m,w,P,Oe,y,l,r);if(!Ve&&!Ke)continue;const lt=Ve==="left"||Ve==="right",Ge=lt?Z[1]:Z[0],rt=lt?Y[1]:Y[0],{size:st,order:ut=N,length:jt=z,padding:At=Ge,crossPadding:zt=rt}=Oe;u.push(Object.assign(Object.assign({title:ae},Oe),{defaultSize:I,length:jt,position:Ve,plane:R,orientation:Ke,padding:At,order:ut,crossPadding:zt,size:st,type:m,scales:y}))}}),u}function e5(e,t,n,r,i){const[s]=Hc("component",r),{scaleInstances:l,scale:u,bbox:h}=e,p=ny(e,["scaleInstances","scale","bbox"]),m={bbox:h,library:r};return s(p)({coordinate:t,library:r,markState:i,scales:l,theme:n,value:m,scale:u})}function pz(e){return e.map(t=>{const n=ri(t,t.style);return delete n.style,n})}function Ste(e){return e.flatMap(t=>t.type=="group"?t.children:t)}function t5(e,t){const n=["left","right","bottom","top"];return By(e,({type:s,position:l,group:u})=>n.includes(l)?u===void 0?s.startsWith("legend")?`legend-${l}`:Symbol("independent"):u==="independent"?Symbol("independent"):u:Symbol("independent")).flatMap(([,s])=>{if(s.length===1)return s[0];if(t!==void 0){const m=s.filter(P=>P.length!==void 0).map(P=>P.length),y=up(m);if(y>t)return s.forEach(P=>P.group=Symbol("independent")),s;const b=t-y,w=s.length-m.length,R=b/w;s.forEach(P=>{P.length===void 0&&(P.length=R)})}const l=Ol(s,m=>m.size),u=Ol(s,m=>m.order),h=Ol(s,m=>m.crossPadding),p=s[0].position;return{type:"group",size:l,order:u,position:p,children:s,crossPadding:h}})}function mz(e,t){const n=["shape","size","color","opacity"],r=(b,w)=>b==="constant"&&w==="size",i=e.filter(({type:b,name:w})=>typeof b=="string"&&n.includes(w)&&!r(b,w)),s=i.filter(({type:b})=>b==="constant"),l=i.filter(({type:b})=>b!=="constant"),h=By(l,b=>b.field?b.field:Symbol("independent")).map(([b,w])=>[b,[...w,...s]]).filter(([,b])=>b.some(w=>w.type!=="constant")),p=new Map(h);if(p.size===0)return[];const m=b=>b.sort(([w],[R])=>w.localeCompare(R));return Array.from(p).map(([,b])=>{const R=uA(b).sort((P,I)=>I.length-P.length).map(P=>({combination:P,option:P.map(I=>[I.name,vz(I)])}));for(const{option:P,combination:I}of R)if(!P.every(N=>N[1]==="constant")&&P.every(N=>N[1]==="discrete"||N[1]==="constant"))return["legendCategory",I];for(const[P,I]of fA)for(const{option:N,combination:z}of R)if(I.some(Z=>EE(m(Z),m(N))))return[P,z];return null}).filter(ec)}function vz(e){const{type:t}=e;return typeof t!="string"?null:t in cz?"continuous":t in fz?"discrete":t in uz?"distribution":t in hz?"constant":null}function gz(e,t){return e.map(n=>{const{name:r}=n;if(f7(t)||QP(t)||Z_(t)&&(f1(t)||Ix(t)))return null;if(r.startsWith("x"))return f1(t)?["axisArc",[n]]:Ix(t)?["axisLinear",[n]]:[Z_(t)?"axisY":"axisX",[n]];if(r.startsWith("y"))return f1(t)?["axisLinear",[n]]:Ix(t)?["axisArc",[n]]:[Z_(t)?"axisX":"axisY",[n]];if(r.startsWith("z"))return["axisZ",[n]];if(r.startsWith("position")){if(p7(t))return["axisRadar",[n]];if(!f1(t))return["axisY",[n]]}return null}).filter(ec)}function yz(e,t){const n=e.filter(r=>lz(r));return[...mz(n,t),...gz(n,t)]}function NO(e){const t=sm(e,"polar");if(t.length){const r=t[t.length-1],{startAngle:i,endAngle:s}=Pg(r);return[i,s]}const n=sm(e,"radial");if(n.length){const r=n[n.length-1],{startAngle:i,endAngle:s}=SE(r);return[i,s]}return[-Math.PI/2,Math.PI/2*3]}function _z(e){const t=/position(\d*)/g.exec(e);return t?+t[1]:null}function bz(e,t,n,r,i){const{name:s}=n[0];if(e==="axisRadar"){const l=r.filter(y=>y.name.startsWith("position")),u=_z(s);if(s===l.slice(-1)[0].name||u===null)return[null,null];const[h,p]=NO(i);return["center",(p-h)/(l.length-1)*u+h]}if(e==="axisY"&&h7(i))return Z_(i)?["center","horizontal"]:["center","vertical"];if(e==="axisLinear"){const[l]=NO(i);return["center",l]}return e==="axisArc"?t[0]==="inner"?["inner",null]:["outer",null]:f1(i)?["center",null]:Ix(i)?["center",null]:e==="axisX"&&d7(i)||e==="axisX"&&m7(i)?["top",null]:t}function xz(e,t,n,r,i,s,l){const[u]=NO(l),h=[r.position||t,u!=null?u:n];return typeof e=="string"&&e.startsWith("axis")?bz(e,h,i,s,l):typeof e=="string"&&e.startsWith("legend")&&f1(l)&&r.position==="center"?["center","vertical"]:h}function Ez(e,t,n=[]){return e==="x"?Z_(n)?`${t}Y`:`${t}X`:e==="y"?Z_(n)?`${t}X`:`${t}Y`:null}function Sz(e,t,n){const[,r]=Hc("component",n),{coordinates:i}=e;function s(l,u,h,p){const m=Ez(u,l,i);if(!p||!m)return;const{props:y}=r(m),{defaultPosition:b,defaultSize:w,defaultOrder:R,defaultCrossPadding:[P]}=y;return Object.assign(Object.assign({position:b,defaultSize:w,order:R,type:m,crossPadding:P},p),{scales:[h]})}return t.filter(l=>l.slider||l.scrollbar).flatMap(l=>{const{slider:u,scrollbar:h,name:p}=l;return[s("slider",p,l,u),s("scrollbar",p,l,h)]}).filter(l=>!!l)}function n5(e,t,n,r,i,s){const{type:l}=e;if(!["left","right","bottom","top"].includes(r)||typeof l!="string")return;const h=l;return(h.startsWith("axis")?Oz:h.startsWith("group")?Tz:h.startsWith("legendContinuous")?Rz:h==="legendCategory"?Mz:h.startsWith("slider")?Cz:h==="title"?Az:h.startsWith("scrollbar")?wz:()=>{})(e,t,n,r,i,s)}function Tz(e,t,n,r,i,s){const{children:l}=e,u=Ol(l,p=>p.crossPadding);l.forEach(p=>p.crossPadding=u),l.forEach(p=>n5(p,t,n,r,i,s));const h=Ol(l,p=>p.size);e.size=h,l.forEach(p=>p.size=h)}function wz(e,t,n,r,i,s){const{trackSize:l=6}=ri({},i.scrollbar,e);e.size=l}function Az(e,t,n,r,i,s){const l=ri({},i.title,e),{title:u,subtitle:h,spacing:p=0}=l,m=ny(l,["title","subtitle","spacing"]);if(u){const y=uo(m,"title"),b=aT(u,y);e.size=b.height}if(h){const y=uo(m,"subtitle"),b=aT(h,y);e.size+=p+b.height}}function Cz(e,t,n,r,i,s){const l=()=>{const{slider:m}=i;return ri({},m,e)},{trackSize:u,handleIconSize:h}=l(),p=Math.max(u,h*2.4);e.size=p}function Oz(e,t,n,r,i,s){var l;e.transform=e.transform||[{type:"hide"}];const u=r==="left"||r==="right",h=r5(e,r,i),{tickLength:p=0,labelSpacing:m=0,titleSpacing:y=0,labelAutoRotate:b}=h,w=ny(h,["tickLength","labelSpacing","titleSpacing","labelAutoRotate"]),R=rT(e,s),P=iT(w,R),I=p+m;if(P&&P.length){const z=Ol(P,Y=>Y.width),Z=Ol(P,Y=>Y.height);if(u)e.size=z+I;else{const{tickFilter:Y,labelTransform:$}=e;Lz(R,P,t,n,Y)&&!$&&b!==!1&&b!==null?(e.labelTransform="rotate(90)",e.size=z+I):(e.labelTransform=(l=e.labelTransform)!==null&&l!==void 0?l:"rotate(0)",e.size=Z+I)}}else e.size=p;const N=oT(w);N&&(u?e.size+=y+N.width:e.size+=y+N.height)}function Rz(e,t,n,r,i,s){const u=(()=>{const{legendContinuous:Y}=i;return ri({},Y,e)})(),{labelSpacing:h=0,titleSpacing:p=0}=u,m=ny(u,["labelSpacing","titleSpacing"]),y=r==="left"||r==="right",b=uo(m,"ribbon"),{size:w}=b,R=uo(m,"handleIcon"),{size:P}=R,I=Math.max(w,P*2.4);e.size=I;const N=rT(e,s),z=iT(m,N);if(z){const Y=y?"width":"height",$=Ol(z,J=>J[Y]);e.size+=$+h}const Z=oT(m);Z&&(y?e.size=Math.max(e.size,Z.width):e.size+=p+Z.height)}function Mz(e,t,n,r,i,s){const u=(()=>{const{legendCategory:rt}=i,{title:st}=e,[ut,jt]=Array.isArray(st)?[st,void 0]:[void 0,st];return ri({title:ut},rt,Object.assign(Object.assign({},e),{title:jt}))})(),{itemSpacing:h,itemMarkerSize:p,titleSpacing:m,rowPadding:y,colPadding:b,maxCols:w=1/0,maxRows:R=1/0}=u,P=ny(u,["itemSpacing","itemMarkerSize","titleSpacing","rowPadding","colPadding","maxCols","maxRows"]),{cols:I,length:N}=e,z=rt=>Math.min(rt,R),Z=rt=>Math.min(rt,w),Y=r==="left"||r==="right",$=N===void 0?t+(Y?0:n[0]+n[1]):N,J=oT(P),ae=rT(e,s),pe=iT(P,ae,"itemLabel"),Oe=Math.max(pe[0].height,p)+y,Ve=(rt,st=0)=>p+rt+h[0]+st;Y?(()=>{let rt=-1/0,st=0,ut=1,jt=0,At=-1/0,zt=-1/0;const wn=J?J.height:0,Hn=$-wn;for(const{width:rr}of pe){const or=Ve(rr,b);rt=Math.max(rt,or),st+Oe>Hn?(ut++,At=Math.max(At,jt),zt=Math.max(zt,st),jt=1,st=Oe):(st+=Oe,jt++)}ut<=1&&(At=jt,zt=st),e.size=rt*Z(ut),e.length=zt+wn,ri(e,{cols:Z(ut),gridRow:At})})():typeof I=="number"?(()=>{const rt=Math.ceil(pe.length/I),st=Ol(pe,ut=>Ve(ut.width))*I;e.size=Oe*z(rt)-y,e.length=Math.min(st,$)})():(()=>{let rt=1,st=0,ut=-1/0;for(const{width:jt}of pe){const At=Ve(jt,b);st+At>$?(ut=Math.max(ut,st),st=At,rt++):st+=At}rt===1&&(ut=st),e.size=Oe*z(rt)-y,e.length=ut})(),J&&(Y?e.size=Math.max(e.size,J.width):e.size+=m+J.height)}function rT(e,t){const[n]=Hc("scale",t),{scales:r,tickCount:i,tickMethod:s}=e,l=r.find(u=>u.type!=="constant"&&u.type!=="identity");return i!==void 0&&(l.tickCount=i),s!==void 0&&(l.tickMethod=s),n(l)}function iT(e,t,n="label"){const{labelFormatter:r,tickFilter:i,label:s=!0}=e,l=ny(e,["labelFormatter","tickFilter","label"]);if(!s)return null;const u=Pz(t,r,i),h=uo(l,n),p=u.map((b,w)=>Object.fromEntries(Object.entries(h).map(([R,P])=>[R,typeof P=="function"?P(b,w):P]))),m=u.map((b,w)=>{const R=p[w];return aT(b,R)});if(!p.some(b=>b.transform)){const b=u.map((w,R)=>R);e.indexBBox=new Map(b.map(w=>[w,[u[w],m[w]]]))}return m}function oT(e){const t=p=>p===!1||p===null,{title:n}=e,r=ny(e,["title"]);if(t(n)||n===void 0)return null;const i=uo(r,"title"),{direction:s,transform:l}=i,u=Array.isArray(n)?n.join(","):n;return typeof u!="string"?null:aT(u,Object.assign(Object.assign({},i),{transform:l||(s==="vertical"?"rotate(-90)":"")}))}function r5(e,t,n){const{title:r}=e,[i,s]=Array.isArray(r)?[r,void 0]:[void 0,r],{axis:l,[`axis${Pb(t)}`]:u}=n;return ri({title:i},l,u,Object.assign(Object.assign({},e),{title:s}))}function i5(e,t){const n=e.getTicks?e.getTicks():e.getOptions().domain;return t?n.filter(t):n}function Pz(e,t,n){const i=i5(e,n).map(l=>typeof l=="number"?r_(l):l),s=t?typeof t=="string"?Wm(t):t:e.getFormatter?e.getFormatter():l=>`${l}`;return i.map(s)}function Iz(e,t){return e.getBandWidth?e.getBandWidth(t)/2:0}function Lz(e,t,n,r,i){if(up(t,w=>w.width)>n)return!0;const l=e.clone();l.update({range:[0,n]});const u=i5(e,i),h=u.map(w=>l.map(w)+Iz(l,w)),p=u.map((w,R)=>R),m=-r[0],y=n+r[1],b=(w,R)=>{const{width:P}=R;return[w-P/2,w+P/2]};for(let w=0;w<p.length;w++){const R=h[w],[P,I]=b(R,t[w]);if(P<m||I>y)return!0;const N=h[w+1];if(N){const[z]=b(N,t[w+1]);if(I>z)return!0}}return!1}function aT(e,t){const n=Dz(e),{filter:r}=t,i=ny(t,["filter"]);return n.attr(Object.assign(Object.assign({},i),{visibility:"none"})),n.getBBox()}function Dz(e){return e instanceof jr?e:new Oa({style:{text:`${e}`}})}function qp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Nz(e){const t=e.find(({type:i})=>i==="axisX"),n=e.find(({type:i})=>i==="axisY"),r=e.find(({type:i})=>i==="axisZ");t&&n&&r&&(t.plane="xy",n.plane="xy",r.plane="yz",r.origin=[t.bbox.x,t.bbox.y,0],r.eulerAngles=[0,-90,0],r.bbox.x=t.bbox.x,r.bbox.y=t.bbox.y,e.push(Object.assign(Object.assign({},t),{plane:"xz",showLabel:!1,showTitle:!1,origin:[t.bbox.x,t.bbox.y,0],eulerAngles:[-90,0,0]})),e.push(Object.assign(Object.assign({},n),{plane:"yz",showLabel:!1,showTitle:!1,origin:[n.bbox.x+n.bbox.width,n.bbox.y,0],eulerAngles:[0,-90,0]})),e.push(Object.assign(Object.assign({},r),{plane:"xz",actualPosition:"left",showLabel:!1,showTitle:!1,eulerAngles:[90,-90,0]})))}function Bz(e,t,n,r){var i,s;const{width:l,height:u,depth:h,x:p=0,y:m=0,z:y=0,inset:b=(i=n.inset)!==null&&i!==void 0?i:0,insetLeft:w=b,insetTop:R=b,insetBottom:P=b,insetRight:I=b,margin:N=(s=n.margin)!==null&&s!==void 0?s:0,marginLeft:z=N,marginBottom:Z=N,marginTop:Y=N,marginRight:$=N,padding:J=n.padding,paddingBottom:ae=J,paddingLeft:pe=J,paddingRight:Oe=J,paddingTop:Ve=J}=kz(e,t,n,r),Ke=1/4,lt=(Ji,Vi,xo,Ko,la)=>{const{marks:wa}=t;if(wa.length===0)return[Ko,la];if(Ji-Ko-la-Ji*Ke>0)return[Ko,la];const hs=Ji*(1-Ke);return[Vi==="auto"?hs*Ko/(Ko+la):Ko,xo==="auto"?hs*la/(Ko+la):la]},Ge=Ji=>Ji==="auto"?20:Ji!=null?Ji:20,rt=Ge(Ve),st=Ge(ae),ut=o5(e,u-rt-st,[rt+Y,st+Z],["left","right"],t,n,r),{paddingLeft:jt,paddingRight:At}=ut,zt=l-z-$,[wn,Hn]=lt(zt,pe,Oe,jt,At),rr=zt-wn-Hn,or=o5(e,rr,[wn+z,Hn+$],["bottom","top"],t,n,r),{paddingTop:Hr,paddingBottom:ui}=or,Qi=u-Z-Y,[ii,ti]=lt(Qi,ae,Ve,ui,Hr),Po=Qi-ii-ti;return{width:l,height:u,depth:h,insetLeft:w,insetTop:R,insetBottom:P,insetRight:I,innerWidth:rr,innerHeight:Po,paddingLeft:wn,paddingRight:Hn,paddingTop:ti,paddingBottom:ii,marginLeft:z,marginBottom:Z,marginTop:Y,marginRight:$,x:p,y:m,z:y}}function Fz(e){const{height:t,width:n,padding:r=0,paddingLeft:i=r,paddingRight:s=r,paddingTop:l=r,paddingBottom:u=r,margin:h=16,marginLeft:p=h,marginRight:m=h,marginTop:y=h,marginBottom:b=h,inset:w=0,insetLeft:R=w,insetRight:P=w,insetTop:I=w,insetBottom:N=w}=e,z=$=>$==="auto"?20:$,Z=n-z(i)-z(s)-p-m-R-P,Y=t-z(l)-z(u)-y-b-I-N;return{width:Z,height:Y}}function kz(e,t,n,r){const{coordinates:i}=t;if(!f1(i)&&!Ix(i))return t;const s=e.filter(N=>typeof N.type=="string"&&N.type.startsWith("axis"));if(s.length===0)return t;const l=s.map(N=>{const z=N.type==="axisArc"?"arc":"linear";return r5(N,z,n)}),u=Ol(l,N=>{var z;return(z=N.labelSpacing)!==null&&z!==void 0?z:0}),h=s.flatMap((N,z)=>{const Z=l[z],Y=rT(N,r);return iT(Z,Y)}).filter(ec),p=Ol(h,N=>N.height)+u,m=s.flatMap((N,z)=>{const Z=l[z];return oT(Z)}).filter(N=>N!==null),y=m.length===0?0:Ol(m,N=>N.height),{inset:b=p,insetLeft:w=b,insetBottom:R=b,insetTop:P=b+y,insetRight:I=b}=t;return Object.assign(Object.assign({},t),{insetLeft:w,insetBottom:R,insetTop:P,insetRight:I})}function o5(e,t,n,r,i,s,l){const u=Rc(e,R=>R.position),{padding:h=s.padding,paddingLeft:p=h,paddingRight:m=h,paddingBottom:y=h,paddingTop:b=h}=i,w={paddingBottom:y,paddingLeft:p,paddingTop:b,paddingRight:m};for(const R of r){const P=`padding${Pb(Kg(R))}`,I=u.get(R)||[],N=w[P],z=Oe=>{Oe.size===void 0&&(Oe.size=Oe.defaultSize)},Z=Oe=>{Oe.type==="group"?(Oe.children.forEach(z),Oe.size=Ol(Oe.children,Ve=>Ve.size)):Oe.size=Oe.defaultSize},Y=Oe=>{Oe.size||(N!=="auto"?Z(Oe):(n5(Oe,t,n,R,s,l),z(Oe)))},$=Oe=>{Oe.type.startsWith("axis")&&Oe.labelAutoHide===void 0&&(Oe.labelAutoHide=!0)},J=R==="bottom"||R==="top",ae=qp(I,Oe=>Oe.order),pe=I.filter(Oe=>Oe.type.startsWith("axis")&&Oe.order==ae);if(pe.length&&(pe[0].crossPadding=0),typeof N=="number")I.forEach(z),I.forEach($);else if(I.length===0)w[P]=0;else{const Oe=J?t+n[0]+n[1]:t,Ve=t5(I,Oe);Ve.forEach(Y);const Ke=Ve.reduce((lt,{size:Ge,crossPadding:rt=12})=>lt+Ge+rt,0);w[P]=Ke}}return w}function zz(e,t,n){const r=Rc(e,J=>`${J.plane||"xy"}-${J.position}`),{paddingLeft:i,paddingRight:s,paddingTop:l,paddingBottom:u,marginLeft:h,marginTop:p,marginBottom:m,marginRight:y,innerHeight:b,innerWidth:w,insetBottom:R,insetLeft:P,insetRight:I,insetTop:N,height:z,width:Z,depth:Y}=n,$={xy:BO({width:Z,height:z,paddingLeft:i,paddingRight:s,paddingTop:l,paddingBottom:u,marginLeft:h,marginTop:p,marginBottom:m,marginRight:y,innerHeight:b,innerWidth:w,insetBottom:R,insetLeft:P,insetRight:I,insetTop:N}),yz:BO({width:Y,height:z,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:Y,innerHeight:z,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0}),xz:BO({width:Z,height:Y,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,marginLeft:0,marginTop:0,marginBottom:0,marginRight:0,innerWidth:Z,innerHeight:Y,insetBottom:0,insetLeft:0,insetRight:0,insetTop:0})};for(const[J,ae]of r.entries()){const[pe,Oe]=J.split("-"),Ve=$[pe][Oe],[Ke,lt]=bE(ae,Ge=>typeof Ge.type!="string"?!1:!!(Oe==="center"||Ge.type.startsWith("axis")&&["inner","outer"].includes(Oe)));Ke.length&&Uz(Ke,t,Ve,Oe),lt.length&&$z(ae,t,Ve)}}function BO({width:e,height:t,paddingLeft:n,paddingRight:r,paddingTop:i,paddingBottom:s,marginLeft:l,marginTop:u,marginBottom:h,marginRight:p,innerHeight:m,innerWidth:y,insetBottom:b,insetLeft:w,insetRight:R,insetTop:P}){const I=n+l,N=i+u,z=r+p,Z=s+h,Y=e-l-p,$=[I+w,N+P,y-w-R,m-P-b,"center",null,null];return{top:[I,0,y,N,"vertical",!0,iu,l,Y],right:[e-z,N,z,m,"horizontal",!1,iu],bottom:[I,t-Z,y,Z,"vertical",!1,iu,l,Y],left:[0,N,I,m,"horizontal",!0,iu],"top-left":[I,0,y,N,"vertical",!0,iu],"top-right":[I,0,y,N,"vertical",!0,iu],"bottom-left":[I,t-Z,y,Z,"vertical",!1,iu],"bottom-right":[I,t-Z,y,Z,"vertical",!1,iu],center:$,inner:$,outer:$}}function Uz(e,t,n,r){const[i,s]=bE(e,l=>!!(typeof l.type=="string"&&l.type.startsWith("axis")));jz(i,t,n,r),Kz(s,t,n)}function jz(e,t,n,r){r==="center"?hA(t)?Yz(e,t,n,r):Nl(t)?Zz(e,t,n):Zy(t)&&Wz(e,t,n,e[0].orientation):r==="inner"?Vz(e,t,n):r==="outer"&&Hz(e,t,n)}function Vz(e,t,n){const[r,i,,s]=n,[l,u]=t.getCenter(),[h]=Db(t),p=s/2,m=h*p,y=l-m,b=u-m;for(let w=0;w<e.length;w++){const R=e[w];R.bbox={x:r+y,y:i+b,width:m*2,height:m*2}}}function Hz(e,t,n){const[r,i,s,l]=n;for(const u of e)u.bbox={x:r,y:i,width:s,height:l}}function Zz(e,t,n){const[r,i,s,l]=n;for(const u of e)u.bbox={x:r,y:i,width:s,height:l}}function Wz(e,t,n,r){r==="horizontal"?Xz(e,t,n):r==="vertical"&&Gz(e,t,n)}function Gz(e,t,n){const[r,i,,s]=n,l=new Array(e.length).fill(0),h=t.map(l).filter((p,m)=>m%2===0).map(p=>p+r);for(let p=0;p<e.length;p++){const m=e[p],y=h[p],b=h[p+1]-y;m.bbox={x:y,y:i,width:b,height:s}}}function Xz(e,t,n){const[r,i,s]=n,l=new Array(e.length).fill(0),h=t.map(l).filter((p,m)=>m%2===1).map(p=>p+i);for(let p=0;p<e.length;p++){const m=e[p],y=h[p],b=h[p+1]-y;m.bbox={x:r,y,width:s,height:b}}}function Yz(e,t,n,r){const[i,s,l,u]=n;for(const h of e)h.bbox={x:i,y:s,width:l,height:u},h.radar={index:e.indexOf(h),count:e.length}}function $z(e,t,n){const[r,i,s,l,u,h,p,m,y]=n,[b,w,R,P,I,N,z,Z]=u==="vertical"?["y",i,"x",r,"height",l,"width",s]:["x",r,"y",i,"width",s,"height",l];e.sort((Oe,Ve)=>p==null?void 0:p(Oe.order,Ve.order));const Y=Oe=>Oe==="title"||Oe==="group"||Oe.startsWith("legend"),$=(Oe,Ve,Ke)=>Ke===void 0?Ve:Y(Oe)?Ke:Ve,J=(Oe,Ve,Ke)=>Ke===void 0?Ve:Y(Oe)?Ke:Ve,ae=h?w+N:w;for(let Oe=0,Ve=ae;Oe<e.length;Oe++){const Ke=e[Oe],{crossPadding:lt=0,type:Ge}=Ke,{size:rt}=Ke;Ke.bbox={[b]:h?Ve-rt-lt:Ve+lt,[R]:J(Ge,P,m),[I]:rt,[z]:$(Ge,Z,y)},Ve+=(rt+lt)*(h?-1:1)}const pe=e.filter(Oe=>Oe.type==="group");for(const Oe of pe){const{bbox:Ve,children:Ke}=Oe,lt=Ve[z],Ge=lt/Ke.length,rt=Ke.reduce((zt,wn)=>{var Hn;const rr=(Hn=wn.layout)===null||Hn===void 0?void 0:Hn.justifyContent;return rr||zt},"flex-start"),st=Ke.map((zt,wn)=>{const{length:Hn=Ge,padding:rr=0}=zt;return Hn+(wn===Ke.length-1?0:rr)}),ut=up(st),jt=lt-ut,At=rt==="flex-start"?0:rt==="center"?jt/2:jt;for(let zt=0,wn=Ve[R]+At;zt<Ke.length;zt++){const Hn=Ke[zt],{padding:rr=0}=Hn,or=zt===Ke.length-1?0:rr;Hn.bbox={[I]:Ve[I],[b]:Ve[b],[R]:wn,[z]:st[zt]-or},ri(Hn,{layout:{justifyContent:rt}}),wn+=st[zt]}}}function Kz(e,t,n){if(e.length===0)return;const[r,i,s,l]=n,[u]=Db(t),h=l/2*u/Math.sqrt(2),p=r+s/2,m=i+l/2;for(let y=0;y<e.length;y++){const b=e[y];b.bbox={x:p-h,y:m-h,width:h*2,height:h*2}}}function av(e,t,n={},r=!1){if(J0(e)||Array.isArray(e)&&r)return e;const i=uo(e,t);return ri(n,i)}function sT(e,t={}){return J0(e)||Array.isArray(e)||!a5(e)?e:ri(t,e)}function a5(e){if(Object.keys(e).length===0)return!0;const{title:t,items:n}=e;return t!==void 0||n!==void 0}function sv(e,t){return typeof e=="object"?uo(e,t):e}var qz=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},$_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Qz(e,t,n){const{encode:r={},scale:i={},transform:s=[]}=t,l=$_(t,["encode","scale","transform"]);return[e,Object.assign(Object.assign({},l),{encode:r,scale:i,transform:s})]}function s5(e,t,n){return qz(this,void 0,void 0,function*(){const{library:r}=n,{data:i}=t,[s]=Hc("data",r),l=fU(i),{transform:u=[]}=l,m=[$_(l,["transform"]),...u].map(w=>s(w,n)),y=yield qw(m)(i),b=i&&!Array.isArray(i)&&!Array.isArray(y)?{value:y}:y;return[Array.isArray(y)?Bv(y):[],Object.assign(Object.assign({},t),{data:b})]})}function Jz(e,t,n){const{encode:r}=t;if(!r)return[e,t];const i={};for(const[s,l]of Object.entries(r))if(Array.isArray(l))for(let u=0;u<l.length;u++){const h=`${s}${u===0?"":u}`;i[h]=l[u]}else i[s]=l;return[e,Object.assign(Object.assign({},t),{encode:i})]}function eU(e,t,n){const{encode:r,data:i}=t;if(!r)return[e,t];const s=E0(r,l=>lU(l)?l:{type:cU(i,l),value:l});return[e,Object.assign(Object.assign({},t),{encode:s})]}function tU(e,t,n){const{encode:r}=t;if(!r)return[e,t];const i=E0(r,(s,l)=>{const{type:u}=s;return u!=="constant"||sz(l)?s:Object.assign(Object.assign({},s),{constant:!0})});return[e,Object.assign(Object.assign({},t),{encode:i})]}function nU(e,t,n){const{encode:r,data:i}=t;if(!r)return[e,t];const{library:s}=n,l=pU(s),u=E0(r,h=>l(i,h));return[e,Object.assign(Object.assign({},t),{encode:u})]}function rU(e,t,n){const{tooltip:r={}}=t;return J0(r)?[e,t]:Array.isArray(r)?[e,Object.assign(Object.assign({},t),{tooltip:{items:r}})]:Q0(r)&&a5(r)?[e,Object.assign(Object.assign({},t),{tooltip:r})]:[e,Object.assign(Object.assign({},t),{tooltip:{items:[r]}})]}function iU(e,t,n){const{data:r,encode:i,tooltip:s={}}=t;if(J0(s))return[e,t];const l=y=>{if(!y)return y;if(typeof y=="string")return e.map(b=>({name:y,value:r[b][y]}));if(Q0(y)){const{field:b,channel:w,color:R,name:P=b,valueFormatter:I=J=>J}=y,N=typeof I=="string"?Wm(I):I,z=w&&i[w],Z=z&&i[w].field,Y=P||Z||w,$=[];for(const J of e){const ae=b?r[J][b]:z?i[w].value[J]:null;$[J]={name:Y,color:R,value:N(ae)}}return $}if(typeof y=="function"){const b=[];for(const w of e){const R=y(r[w],w,r,i);Q0(R)?b[w]=R:b[w]={value:R}}return b}return y},{title:u,items:h=[]}=s,p=$_(s,["title","items"]),m=Object.assign({title:l(u),items:Array.isArray(h)?h.map(l):[]},p);return[e,Object.assign(Object.assign({},t),{tooltip:m})]}function oU(e,t,n){const{encode:r}=t,i=$_(t,["encode"]);if(!r)return[e,t];const s=Object.entries(r),l=s.filter(([,h])=>{const{value:p}=h;return Array.isArray(p[0])}).flatMap(([h,p])=>{const m=[[h,new Array(e.length).fill(void 0)]],{value:y}=p,b=$_(p,["value"]);for(let w=0;w<y.length;w++){const R=y[w];if(Array.isArray(R))for(let P=0;P<R.length;P++){const I=m[P]||[`${h}${P}`,new Array(e).fill(void 0)];I[1][w]=R[P],m[P]=I}}return m.map(([w,R])=>[w,Object.assign({type:"column",value:R},b)])}),u=Object.fromEntries([...s,...l]);return[e,Object.assign(Object.assign({},i),{encode:u})]}function aU(e,t,n){const{axis:r={},legend:i={},slider:s={},scrollbar:l={}}=t,u=(p,m)=>{if(typeof p=="boolean")return p?{}:null;const y=p[m];return y===void 0||y?y:null},h=typeof r=="object"?Array.from(new Set(["x","y","z",...Object.keys(r)])):["x","y","z"];return ri(t,{scale:Object.assign(Object.assign({},Object.fromEntries(h.map(p=>{const m=u(l,p);return[p,Object.assign({guide:u(r,p),slider:u(s,p),scrollbar:m},m&&{ratio:m.ratio===void 0?.5:m.ratio})]}))),{color:{guide:u(i,"color")},size:{guide:u(i,"size")},shape:{guide:u(i,"shape")},opacity:{guide:u(i,"opacity")}})}),[e,t]}function sU(e,t,n){const{animate:r}=t;return r||r===void 0?[e,t]:(ri(t,{animate:{enter:{type:null},exit:{type:null},update:{type:null}}}),[e,t])}function lU(e){if(typeof e!="object"||e instanceof Date||e===null)return!1;const{type:t}=e;return ec(t)}function cU(e,t){return typeof t=="function"?"transform":typeof t=="string"&&uU(e,t)?"field":"constant"}function uU(e,t){return Array.isArray(e)?e.some(n=>n[t]!==void 0):!1}function fU(e){if((0,dr.Z)(e))return{type:"inline",value:e};if(!e)return{type:"inline",value:null};if(Array.isArray(e))return{type:"inline",value:e};const{type:t="inline"}=e,n=$_(e,["type"]);return Object.assign(Object.assign({},n),{type:t})}var l5=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},hU=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function dU(e,t,n){return l5(this,void 0,void 0,function*(){const[r,i]=yield mU(e,t,n),{encode:s,scale:l,data:u,tooltip:h}=i;if(Array.isArray(u)===!1)return null;const{channels:p}=t,m=$1(Object.entries(s).filter(([,b])=>ec(b)),b=>b.map(([w,R])=>Object.assign({name:w},R)),([b])=>{var w;const R=(w=/([^\d]+)\d*$/.exec(b))===null||w===void 0?void 0:w[1],P=p.find(I=>I.name===R);return P!=null&&P.independent?b:R}),y=p.filter(b=>{const{name:w,required:R}=b;if(m.find(([P])=>P===w))return!0;if(R)throw new Error(`Missing encoding for channel: ${w}.`);return!1}).flatMap(b=>{const{name:w,scale:R,scaleKey:P,range:I,quantitative:N,ordinal:z}=b;return m.filter(([Y])=>Y.startsWith(w)).map(([Y,$],J)=>{const ae=$.some(ut=>ut.visual),pe=$.some(ut=>ut.constant),Oe=l[Y]||{},{independent:Ve=!1,key:Ke=P||Y,type:lt=pe?"constant":ae?"identity":R}=Oe,Ge=hU(Oe,["independent","key","type"]),rt=lt==="constant",st=rt?void 0:I;return{name:Y,values:$,scaleKey:Ve||rt?Symbol("independent"):Ke,scale:Object.assign(Object.assign({type:lt,range:st},Ge),{quantitative:N,ordinal:z})}})});return[i,Object.assign(Object.assign({},t),{index:r,channels:y,tooltip:h})]})}function pU(e){const[t]=Hc("encode",e);return(n,r)=>r===void 0||n===void 0?null:Object.assign(Object.assign({},r),{type:"column",value:t(r)(n),field:vU(r)})}function mU(e,t,n){return l5(this,void 0,void 0,function*(){const{library:r}=n,[i]=Hc("transform",r),{preInference:s=[],postInference:l=[]}=t,{transform:u=[]}=e,h=[Qz,s5,Jz,eU,tU,nU,oU,sU,aU,rU,...s.map(i),...u.map(i),...l.map(i),iU];let p=[],m=e;for(const y of h)[p,m]=yield y(p,m,n);return[p,m]})}function vU(e){const{type:t,value:n}=e;return t==="field"&&typeof n=="string"?n:null}var $v=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},ry=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function FO(e,t,n){var r;return $v(this,void 0,void 0,function*(){const{library:i}=n,[s]=Hc("composition",i),[l]=Hc("interaction",i),u=new Set(Object.keys(i).map(Ge=>{var rt;return(rt=/mark\.(.*)/.exec(Ge))===null||rt===void 0?void 0:rt[1]}).filter(ec)),h=new Set(Object.keys(i).map(Ge=>{var rt;return(rt=/component\.(.*)/.exec(Ge))===null||rt===void 0?void 0:rt[1]}).filter(ec)),p=Ge=>{const{type:rt}=Ge;if(typeof rt=="function"){const{props:st={}}=rt,{composite:ut=!0}=st;if(ut)return"mark"}return typeof rt!="string"?rt:u.has(rt)||h.has(rt)?"mark":rt},m=Ge=>p(Ge)==="mark",y=Ge=>p(Ge)==="standardView",b=Ge=>{const{type:rt}=Ge;return typeof rt!="string"?!1:!!h.has(rt)},w=Ge=>{if(y(Ge))return[Ge];const rt=p(Ge);return s({type:rt,static:b(Ge)})(Ge)},R=[],P=new Map,I=new Map,N=[e],z=[];for(;N.length;){const Ge=N.shift();if(y(Ge)){const rt=I.get(Ge),[st,ut]=rt?h5(rt,Ge,i):yield u5(Ge,n);P.set(st,Ge),R.push(st);const jt=ut.flatMap(w).map(At=>qP(At,i));if(N.push(...jt),jt.every(y)){const At=yield Promise.all(jt.map(zt=>f5(zt,n)));z9(At);for(let zt=0;zt<jt.length;zt++){const wn=jt[zt],Hn=At[zt];I.set(wn,Hn)}}}else{const rt=m(Ge)?Ge:yield v5(Ge,n),st=w(rt);Array.isArray(st)?N.push(...st):typeof st=="function"&&z.push(st())}}n.emitter.emit(gl.BEFORE_PAINT);const Z=new Map,Y=new Map,$=[];t.selectAll(lv(Dt)).data(R,Ge=>Ge.key).join(Ge=>Ge.append("g").attr("className",Dt).attr("id",rt=>rt.key).call(c5).each(function(rt,st,ut){zO(rt,Ra(ut),$,n),Z.set(rt,ut)}),Ge=>Ge.call(c5).each(function(rt,st,ut){zO(rt,Ra(ut),$,n),Y.set(rt,ut)}),Ge=>Ge.each(function(rt,st,ut){const jt=ut.nameInteraction.values();for(const At of jt)At.destroy()}).remove());const J=(Ge,rt,st)=>Array.from(Ge.entries()).map(([ut,jt])=>{const At=st||new Map,zt=(rr,or=Hr=>Hr)=>At.set(rr,or),wn=P.get(ut),Hn=yU(Ra(jt),wn,n);return{view:ut,container:jt,options:wn,setState:zt,update:(rr,or)=>$v(this,void 0,void 0,function*(){const ui=Fy(Array.from(At.values()))(wn);return yield Hn(ui,rr,()=>{_s(or)&&rt(Ge,or,At)})})}}),ae=(Ge=Y,rt,st)=>{var ut;const jt=J(Ge,ae,st);for(const At of jt){const{options:zt,container:wn}=At,Hn=wn.nameInteraction;let rr=lT(zt);rt&&(rr=rr.filter(or=>rt.includes(or[0])));for(const or of rr){const[Hr,ui]=or,Qi=Hn.get(Hr);if(Qi&&((ut=Qi.destroy)===null||ut===void 0||ut.call(Qi)),ui){const ti=kO(At.view,Hr,ui,l)(At,jt,n.emitter);Hn.set(Hr,{destroy:ti})}}}},pe=J(Z,ae);for(const Ge of pe){const{options:rt}=Ge,st=new Map;Ge.container.nameInteraction=st;for(const ut of lT(rt)){const[jt,At]=ut;if(At){const wn=kO(Ge.view,jt,At,l)(Ge,pe,n.emitter);st.set(jt,{destroy:wn})}}}ae();const{width:Oe,height:Ve}=e,Ke=[];for(const Ge of z){const rt=new Promise(st=>$v(this,void 0,void 0,function*(){for(const ut of Ge){const jt=Object.assign({width:Oe,height:Ve},ut);yield FO(jt,t,n)}st()}));Ke.push(rt)}n.views=R,(r=n.animations)===null||r===void 0||r.forEach(Ge=>Ge==null?void 0:Ge.cancel()),n.animations=$,n.emitter.emit(gl.AFTER_PAINT);const lt=$.filter(ec).map(LU).map(Ge=>Ge.finished);return Promise.all([...lt,...Ke])})}function c5(e){e.style("transform",t=>`translate(${t.layout.x}, ${t.layout.y})`)}function gU(e){const[,t]=Hc("interaction",e);return n=>{const[r,i]=n;try{return[r,t(r)]}catch(s){return[r,i.type]}}}function yU(e,t,n){const{library:r}=n,i=gU(r),s=h=>h[1]&&h[1].props&&h[1].props.reapplyWhenUpdate,u=lT(t).map(i).filter(s).map(h=>h[0]);return(h,p,m)=>$v(this,void 0,void 0,function*(){const y=[],[b,w]=yield u5(h,n);zO(b,e,y,n);for(const R of u.filter(P=>P!==p))_U(R,e,h,b,n);for(const R of w)FO(R,e,n);return m(),{options:h,view:b}})}function _U(e,t,n,r,i){var s;const{library:l}=i,[u]=Hc("interaction",l),p=t.node().nameInteraction,m=lT(n).find(([P])=>P===e),y=p.get(e);if(!y||((s=y.destroy)===null||s===void 0||s.call(y),!m[1]))return;const b=kO(r,e,m[1],u),w={options:n,view:r,container:t.node(),update:P=>Promise.resolve(P)},R=b(w,[],i.emitter);p.set(e,{destroy:R})}function u5(e,t){return $v(this,void 0,void 0,function*(){const{library:n}=t,r=yield xU(e,t),i=bU(r);e.interaction=i.interaction,e.coordinate=i.coordinate,e.marks=[...i.marks,...i.components];const s=qP(i,n),l=yield f5(s,t);return h5(l,s,n)})}function bU(e){const{coordinate:t={},interaction:n={},style:r={},marks:i}=e,s=ry(e,["coordinate","interaction","style","marks"]),l=i.map(b=>b.coordinate||{}),u=i.map(b=>b.interaction||{}),h=i.map(b=>b.viewStyle||{}),p=[...l,t].reduceRight((b,w)=>ri(b,w),{}),m=[n,...u].reduce((b,w)=>ri(b,w),{}),y=[...h,r].reduce((b,w)=>ri(b,w),{});return Object.assign(Object.assign({},s),{marks:i,coordinate:p,interaction:m,style:y})}function xU(e,t){return $v(this,void 0,void 0,function*(){const{library:n}=t,[r,i]=Hc("mark",n),s=new Set(Object.keys(n).map(w=>{var R;return(R=/component\.(.*)/.exec(w))===null||R===void 0?void 0:R[1]}).filter(ec)),{marks:l}=e,u=[],h=[],p=[...l],{width:m,height:y}=Fz(e),b={options:e,width:m,height:y};for(;p.length;){const[w]=p.splice(0,1),R=yield v5(w,t),{type:P=Nv("G2Mark type is required."),key:I}=R;if(s.has(P))h.push(R);else{const{props:N={}}=i(P),{composite:z=!0}=N;if(!z)u.push(R);else{const{data:Z}=R,Y=Object.assign(Object.assign({},R),{data:Z&&(Array.isArray(Z)?Z:Z.value)}),$=yield r(Y,b),J=Array.isArray($)?$:[$];p.unshift(...J.map((ae,pe)=>Object.assign(Object.assign({},ae),{key:`${I}-${pe}`})))}}}return Object.assign(Object.assign({},e),{marks:u,components:h})})}function f5(e,t){return $v(this,void 0,void 0,function*(){const{library:n}=t,[r]=Hc("theme",n),[,i]=Hc("mark",n),{theme:s,marks:l,coordinates:u=[]}=e,h=r(m5(s)),p=new Map;for(const y of l){const{type:b}=y,{props:w={}}=i(b),R=yield dU(y,w,t);if(R){const[P,I]=R;p.set(P,I)}}const m=Rc(Array.from(p.values()).flatMap(y=>y.channels),({scaleKey:y})=>y);for(const y of m.values()){const b=y.reduce((Y,{scale:$})=>ri(Y,$),{}),{scaleKey:w}=y[0],{values:R}=y[0],P=Array.from(new Set(R.map(Y=>Y.field).filter(ec))),I=ri({guide:{title:P.length===0?void 0:P},field:P[0]},b),{name:N}=y[0],z=y.flatMap(({values:Y})=>Y.map($=>$.value)),Z=Object.assign(Object.assign({},D9(N,z,I,u,h,n)),{uid:Symbol("scale"),key:w});y.forEach(Y=>Y.scale=Z)}return p})}function kO(e,t,n,r){const i=e.theme,s=typeof t=="string"?i[t]||{}:{};return r(ri(s,Object.assign({type:t},n)))}function h5(e,t,n){var r;const[i]=Hc("mark",n),[s]=Hc("theme",n),[l]=Hc("labelTransform",n),{key:u,frame:h=!1,theme:p,clip:m,style:y={},labelTransform:b=[]}=t,w=s(m5(p)),R=Array.from(e.values()),P=F9(R,t),I=pz(dz(FU(Array.from(P),R,e),t,n)),N=Bz(I,t,w,n),z=u7(N,t,n),Z=h?ri({mainLineWidth:1,mainStroke:"#000"},y):y;zz(t5(I),z,N),Nz(I);const Y=new Map(Array.from(e.values()).flatMap(pe=>{const{channels:Oe}=pe;return Oe.map(({scale:Ve})=>[Ve.uid,WI(Ve,n)])}));B9(e,Y);const $={};for(const pe of I){const{scales:Oe=[]}=pe,Ve=[];for(const Ke of Oe){const{name:lt,uid:Ge}=Ke,rt=(r=Y.get(Ge))!==null&&r!==void 0?r:WI(Ke,n);Ve.push(rt),lt==="y"&&rt.update(Object.assign(Object.assign({},rt.getOptions()),{xScale:$.x})),ZI($,{[lt]:rt})}pe.scaleInstances=Ve}const J=[];for(const[pe,Oe]of e.entries()){const{children:Ve,dataDomain:Ke,modifier:lt,key:Ge}=pe,{index:rt,channels:st,tooltip:ut}=Oe,jt=Object.fromEntries(st.map(({name:Ji,scale:Vi})=>[Ji,Vi])),At=E0(jt,({uid:Ji})=>Y.get(Ji));ZI($,At);const zt=N9(st,At),wn=i(pe),[Hn,rr,or]=TU(wn(rt,At,zt,z)),Hr=Ke||Hn.length,ui=lt?lt(rr,Hr,N):[],Qi=Ji=>{var Vi,xo;return(xo=(Vi=ut.title)===null||Vi===void 0?void 0:Vi[Ji])===null||xo===void 0?void 0:xo.value},ii=Ji=>ut.items.map(Vi=>Vi[Ji]),ti=Hn.map((Ji,Vi)=>{const xo=Object.assign({points:rr[Vi],transform:ui[Vi],index:Ji,markKey:Ge,viewKey:u},ut&&{title:Qi(Ji),items:ii(Ji)});for(const[Ko,la]of Object.entries(zt))xo[Ko]=la[Ji],or&&(xo[`series${Zm(Ko)}`]=or[Vi].map(wa=>la[wa]));return or&&(xo.seriesIndex=or[Vi]),or&&ut&&(xo.seriesItems=or[Vi].map(Ko=>ii(Ko)),xo.seriesTitle=or[Vi].map(Ko=>Qi(Ko))),xo});Oe.data=ti,Oe.index=Hn;const Po=Ve==null?void 0:Ve(ti,At,N);J.push(...Po||[])}return[{layout:N,theme:w,coordinate:z,markState:e,key:u,clip:m,scale:$,style:Z,components:I,labelTransform:Fy(b.map(l))},J]}function zO(e,t,n,r){return $v(this,void 0,void 0,function*(){const{library:i}=r,{components:s,theme:l,layout:u,markState:h,coordinate:p,key:m,style:y,clip:b,scale:w}=e,{x:R,y:P,width:I,height:N}=u,z=ry(u,["x","y","width","height"]),Z=["view","plot","main","content"],Y=Z.map((At,zt)=>zt),$=["a","margin","padding","inset"],J=Z.map(At=>lE(Object.assign({},l.view,y),At)),ae=$.map(At=>uo(z,At)),pe=At=>At.style("x",zt=>Ge[zt].x).style("y",zt=>Ge[zt].y).style("width",zt=>Ge[zt].width).style("height",zt=>Ge[zt].height).each(function(zt,wn,Hn){kU(Ra(Hn),J[zt])});let Oe=0,Ve=0,Ke=I,lt=N;const Ge=Y.map(At=>{const zt=ae[At],{left:wn=0,top:Hn=0,bottom:rr=0,right:or=0}=zt;return Oe+=wn,Ve+=Hn,Ke-=wn+or,lt-=Hn+rr,{x:Oe,y:Ve,width:Ke,height:lt}});t.selectAll(lv(U)).data(Y.filter(At=>ec(J[At])),At=>Z[At]).join(At=>At.append("rect").attr("className",U).style("zIndex",-2).call(pe),At=>At.call(pe),At=>At.remove());const rt=OU(h),st=rt?{duration:rt[1]}:!1;for(const[,At]of By(s,zt=>`${zt.type}-${zt.position}`))At.forEach((zt,wn)=>zt.index=wn);const ut=t.selectAll(lv(Qe)).data(s,At=>`${At.type}-${At.position}-${At.index}`).join(At=>At.append("g").style("zIndex",({zIndex:zt})=>zt||-1).attr("className",Qe).append(zt=>e5(ri({animate:st,scale:w},zt),p,l,i,h)),At=>At.transition(function(zt,wn,Hn){const{preserve:rr=!1}=zt;if(rr)return;const or=e5(ri({animate:st,scale:w},zt),p,l,i,h),{attributes:Hr}=or,[ui]=Hn.childNodes;return ui.update(Hr,!1)})).transitions();n.push(...ut.flat().filter(ec));const jt=t.selectAll(lv(Me)).data([u],()=>m).join(At=>At.append("rect").style("zIndex",0).style("fill","transparent").attr("className",Me).call(g5).call(_5,Array.from(h.keys())).call(b5,b),At=>At.call(_5,Array.from(h.keys())).call(zt=>rt?BU(zt,rt):g5(zt)).call(b5,b)).transitions();n.push(...jt.flat());for(const[At,zt]of h.entries()){const{data:wn}=zt,{key:Hn,class:rr,type:or}=At,Hr=t.select(`#${Hn}`),ui=PU(At,zt,e,r),Qi=IU(At,zt,e,i),ii=DU(At,zt,e,i),ti=NU(At,zt,e,i),Po=RU(t,Hr,rr,"element"),Ji=Hr.selectAll(lv(Ut)).selectFacetAll(Po).data(wn,Vi=>Vi.key,Vi=>Vi.groupKey).join(Vi=>Vi.append(ui).attr("className",Ut).attr("markType",or).transition(function(xo,Ko,la){return Qi(xo,[la])}),Vi=>Vi.call(xo=>{const Ko=xo.parent(),la=Jw(wa=>{const[Vs,Ea]=wa.getBounds().min;return[Vs,Ea]});xo.transition(function(wa,Vs,Ea){MU(Ea,Ko,la);const hs=ui(wa,Vs),Ml=ii(wa,[Ea],[hs]);return Ml!==null||(Ea.nodeName===hs.nodeName&&hs.nodeName!=="g"?Ib(Ea,hs):(Ea.parentNode.replaceChild(hs,Ea),hs.className=Ut,hs.markType=or,hs.__data__=Ea.__data__)),Ml}).attr("markType",or).attr("className",Ut)}),Vi=>Vi.each(function(xo,Ko,la){la.__removed__=!0}).transition(function(xo,Ko,la){return ti(xo,[la])}).remove(),Vi=>Vi.append(ui).attr("className",Ut).attr("markType",or).transition(function(xo,Ko,la){const{__fromElements__:wa}=la,Vs=ii(xo,wa,[la]);return new pu(wa,null,la.parentNode).transition(Vs).remove(),Vs}),Vi=>Vi.transition(function(xo,Ko,la){const Vs=new pu([],la.__toData__,la.parentNode).append(ui).attr("className",Ut).attr("markType",or).nodes();return ii(xo,[la],Vs)}).remove()).transitions();n.push(...Ji.flat())}EU(e,t,n,i,r)})}function EU(e,t,n,r,i){const[s]=Hc("labelTransform",r),{markState:l,labelTransform:u}=e,h=t.select(lv(sn)).node(),p=new Map,m=new Map,y=Array.from(l.entries()).flatMap(([I,N])=>{const{labels:z=[],key:Z}=I,Y=CU(I,N,e,r,i),$=t.select(`#${Z}`).selectAll(lv(Ut)).nodes().filter(J=>!J.__removed__);return z.flatMap((J,ae)=>{const{transform:pe=[]}=J,Oe=ry(J,["transform"]);return $.flatMap(Ve=>{const Ke=SU(Oe,ae,Ve);return Ke.forEach(lt=>{p.set(lt,Y),m.set(lt,J)}),Ke})})}),b=Ra(h).selectAll(lv(Ft)).data(y,I=>I.key).join(I=>I.append(N=>p.get(N)(N)).attr("className",Ft),I=>I.each(function(N,z,Z){const $=p.get(N)(N);Ib(Z,$)}),I=>I.remove()).nodes(),w=Rc(b,I=>m.get(I.__data__)),{coordinate:R}=e,P={canvas:i.canvas,coordinate:R};for(const[I,N]of w){const{transform:z=[]}=I;Fy(z.map(s))(N,P)}u&&u(b,P)}function SU(e,t,n){const{seriesIndex:r,seriesKey:i,points:s,key:l,index:u}=n.__data__,h=AU(n);if(!r)return[Object.assign(Object.assign({},e),{key:`${l}-${t}`,bounds:h,index:u,points:s,dependentElement:n})];const p=wU(e),m=r.map((y,b)=>Object.assign(Object.assign({},e),{key:`${i[b]}-${t}`,bounds:[s[b]],index:y,points:s,dependentElement:n}));return p?p(m):m}function TU([e,t,n]){if(n)return[e,t,n];const r=[],i=[];for(let s=0;s<e.length;s++){const l=e[s],u=t[s];u.every(([h,p])=>ec(h)&&ec(p))&&(r.push(l),i.push(u))}return[r,i]}function wU(e){const{selector:t}=e;if(!t)return null;if(typeof t=="function")return t;if(t==="first")return n=>[n[0]];if(t==="last")return n=>[n[n.length-1]];throw new Error(`Unknown selector: ${t}`)}function AU(e){const t=e.cloneNode(),n=e.getAnimations();t.style.visibility="hidden",n.forEach(l=>{const u=l.effect.getKeyframes();t.attr(u[u.length-1])}),e.parentNode.appendChild(t);const r=t.getLocalBounds();t.destroy();const{min:i,max:s}=r;return[i,s]}function CU(e,t,n,r,i){const[s]=Hc("shape",r),{data:l,encode:u}=e,{data:h,defaultLabelShape:p}=t,m=h.map(P=>P.points),y=E0(u,P=>P.value),{theme:b,coordinate:w}=n,R=Object.assign(Object.assign({},i),{document:$P(i),theme:b,coordinate:w});return P=>{const{index:I,points:N}=P,z=l[I],{formatter:Z=jt=>`${jt}`,transform:Y,style:$,render:J}=P,ae=ry(P,["formatter","transform","style","render"]),pe=E0(Object.assign(Object.assign({},ae),$),jt=>d5(jt,z,I,l,{channel:y})),{shape:Oe=p,text:Ve}=pe,Ke=ry(pe,["shape","text"]),lt=typeof Z=="string"?Wm(Z):Z,Ge=Object.assign(Object.assign({},Ke),{text:lt(Ve,z,I,l),datum:z}),rt=Object.assign({type:`label.${Oe}`,render:J},Ke),st=s(rt,R),ut=p5(b,"label",Oe,"label");return st(N,Ge,ut,m)}}function d5(e,t,n,r,i){return typeof e=="function"?e(t,n,r,i):typeof e!="string"?e:Q0(t)&&t[e]!==void 0?t[e]:e}function OU(e){let t=-1/0,n=1/0;for(const[r,i]of e){const{animate:s={}}=r,{data:l}=i,{enter:u={},update:h={},exit:p={}}=s,{type:m,duration:y=300,delay:b=0}=h,{type:w,duration:R=300,delay:P=0}=u,{type:I,duration:N=300,delay:z=0}=p;for(const Z of l){const{updateType:Y=m,updateDuration:$=y,updateDelay:J=b,enterType:ae=w,enterDuration:pe=R,enterDelay:Oe=P,exitDuration:Ve=N,exitDelay:Ke=z,exitType:lt=I}=Z;(Y===void 0||Y)&&(t=Math.max(t,$+J),n=Math.min(n,J)),(lt===void 0||lt)&&(t=Math.max(t,Ve+Ke),n=Math.min(n,Ke)),(ae===void 0||ae)&&(t=Math.max(t,pe+Oe),n=Math.min(n,Oe))}}return t===-1/0?null:[n,t-n]}function RU(e,t,n,r){return e.node().parentElement.findAll(s=>s.style.facet!==void 0&&s.style.facet===n&&s!==t.node()).flatMap(s=>s.getElementsByClassName(r))}function MU(e,t,n){if(!e.__facet__)return;const r=e.parentNode.parentNode,i=t.parentNode,[s,l]=n(r),[u,h]=n(i),p=`translate(${s-u}, ${l-h})`;eA(e,p),t.append(e)}function PU(e,t,n,r){const{library:i}=r,[s]=Hc("shape",i),{data:l,encode:u}=e,{defaultShape:h,data:p,shape:m}=t,y=E0(u,z=>z.value),b=p.map(z=>z.points),{theme:w,coordinate:R}=n,{type:P,style:I={}}=e,N=Object.assign(Object.assign({},r),{document:$P(r),coordinate:R,theme:w});return z=>{const{shape:Z=h}=I,{shape:Y=Z,points:$,seriesIndex:J,index:ae}=z,pe=ry(z,["shape","points","seriesIndex","index"]),Oe=Object.assign(Object.assign({},pe),{index:ae}),Ve=J?J.map(st=>l[st]):l[ae],Ke=J||ae,lt=E0(I,st=>d5(st,Ve,Ke,l,{channel:y})),Ge=m[Y]?m[Y](lt,N):s(Object.assign(Object.assign({},lt),{type:y5(e,Y)}),N),rt=p5(w,P,Y,h);return Ge($,Oe,rt,b)}}function p5(e,t,n,r){if(typeof t!="string")return;const{color:i}=e,s=e[t]||{},l=s[n]||s[r];return Object.assign({color:i},l)}function UO(e,t,n,r,i){var s,l;const[,u]=Hc("shape",i),[h]=Hc("animation",i),{defaultShape:p,shape:m}=n,{theme:y,coordinate:b}=r,R=`default${Zm(e)}Animation`,{[R]:P}=((s=m[p])===null||s===void 0?void 0:s.props)||u(y5(t,p)).props,{[e]:I={}}=y,N=((l=t.animate)===null||l===void 0?void 0:l[e])||{},z={coordinate:b};return(Z,Y,$)=>{const{[`${e}Type`]:J,[`${e}Delay`]:ae,[`${e}Duration`]:pe,[`${e}Easing`]:Oe}=Z,Ve=Object.assign({type:J||P},N);if(!Ve.type)return null;const Ge=h(Ve,z)(Y,$,ri(I,{delay:ae,duration:pe,easing:Oe}));return Array.isArray(Ge)?Ge:[Ge]}}function IU(e,t,n,r){return UO("enter",e,t,n,r)}function LU(e){return e.finished.then(()=>{e.cancel()}),e}function DU(e,t,n,r){return UO("update",e,t,n,r)}function NU(e,t,n,r){return UO("exit",e,t,n,r)}function m5(e={}){if(typeof e=="string")return{type:e};const{type:t="light"}=e,n=ry(e,["type"]);return Object.assign(Object.assign({},n),{type:t})}function lT(e){const t={event:!0,tooltip:!0,sliderFilter:!0,legendFilter:!0,scrollbarFilter:!0},{interaction:n={}}=e;return Object.entries(ri(t,n)).reverse()}function v5(e,t){return $v(this,void 0,void 0,function*(){const{data:n}=e,r=ry(e,["data"]);if(n==null)return e;const[,{data:i}]=yield s5([],{data:n},t);return Object.assign({data:i},r)})}function g5(e){e.style("transform",t=>`translate(${t.paddingLeft+t.marginLeft}, ${t.paddingTop+t.marginTop})`).style("width",t=>t.innerWidth).style("height",t=>t.innerHeight)}function BU(e,t){const[n,r]=t;e.transition(function(i,s,l){const{transform:u,width:h,height:p}=l.style,{paddingLeft:m,paddingTop:y,innerWidth:b,innerHeight:w,marginLeft:R,marginTop:P}=i,I=[{transform:u,width:h,height:p},{transform:`translate(${m+R}, ${y+P})`,width:b,height:w}];return l.animate(I,{delay:n,duration:r,fill:"both"})})}function y5(e,t){const{type:n}=e;return typeof t=="string"?`${n}.${t}`:t}function _5(e,t){const n=s=>s.class!==void 0?`${s.class}`:"";e.nodes().length===0||(e.selectAll(lv(er)).data(t,s=>s.key).join(s=>s.append("g").attr("className",er).attr("id",l=>l.key).style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),s=>s.style("facet",n).style("fill","transparent").style("zIndex",l=>{var u;return(u=l.zIndex)!==null&&u!==void 0?u:0}),s=>s.remove()),e.select(lv(sn)).node())||e.append("g").attr("className",sn).style("zIndex",0)}function lv(...e){return e.map(t=>`.${t}`).join("")}function b5(e,t){e.node()&&e.style("clipPath",n=>{if(!t)return null;const{paddingTop:r,paddingLeft:i,marginLeft:s,marginTop:l,innerWidth:u,innerHeight:h}=n;return new pa({style:{x:i+s,y:r+l,width:u,height:h}})})}function FU(e,t,n){var r;for(const[p]of n.entries())if(p.type==="cell")return e.filter(m=>m.name!=="shape");if(t.length!==1||e.some(p=>p.name==="shape"))return e;const{defaultShape:i}=t[0];if(!["point","line","rect","hollow"].includes(i))return e;const l={point:"point",line:"hyphen",rect:"square",hollow:"hollow"},h={field:((r=e.find(p=>p.name==="color"))===null||r===void 0?void 0:r.field)||null,name:"shape",type:"constant",domain:[],range:[l[i]]};return[...e,h]}function kU(e,t){for(const[n,r]of Object.entries(t))e.style(n,r)}function x5(e){const t=ri({},e),n=new Map([[t,null]]),r=new Map([[null,-1]]),i=[t];for(;i.length;){const s=i.shift();if(s.key===void 0){const u=n.get(s),h=r.get(s),p=u===null?"0":`${u.key}-${h}`;s.key=p}const{children:l=[]}=s;if(Array.isArray(l))for(let u=0;u<l.length;u++){const h=ri({},l[u]);l[u]=h,n.set(h,s),r.set(h,u),i.push(h)}}return t}function zU(e,t){const n=new Cb;return n.registerPlugin(new K2),new Hu({width:e,height:t,container:document.createElement("div"),renderer:n})}function UU(e,t={},n=()=>{},r=i=>{throw i}){const{width:i=640,height:s=480,depth:l=0}=e,u=x5(e),{canvas:h=zU(i,s),emitter:p=new xn,library:m}=t;t.canvas=h,t.emitter=p;const{width:y,height:b}=h.getConfig();(y!==i||b!==s)&&h.resize(i,s),p.emit(gl.BEFORE_RENDER);const w=Ra(h.document.documentElement);return h.ready.then(()=>FO(Object.assign(Object.assign({},u),{width:i,height:s,depth:l}),w,t)).then(()=>{if(l){const[R,P]=h.document.documentElement.getPosition();h.document.documentElement.setPosition(R,P,-l/2)}h.requestAnimationFrame(()=>{p.emit(gl.AFTER_RENDER),n==null||n()})}).catch(R=>{r==null||r(R)}),VU(h.getConfig().container)}function Tte(e,t={},n=()=>{},r=i=>{throw i}){var i;const{width:s=640,height:l=480}=e,u=x5(e),{group:h=new Group,emitter:p=new EventEmitter,library:m}=t;h!=null&&h.parentElement||error("renderToMountedElement can't render chart to unmounted group.");const y=select(h);return t.group=h,t.emitter=p,t.canvas=t.canvas||((i=h==null?void 0:h.ownerDocument)===null||i===void 0?void 0:i.defaultView),p.emit(ChartEvent.BEFORE_RENDER),plot(Object.assign(Object.assign({},u),{width:s,height:l}),y,t).then(()=>{var b;(b=t.canvas)===null||b===void 0||b.requestAnimationFrame(()=>{p.emit(ChartEvent.AFTER_RENDER),n==null||n()})}).catch(b=>{r==null||r(b)}),h}function E5(e,t={},n=!1){const{canvas:r,emitter:i}=t;r&&(jU(r),n?r.destroy():r.destroyChildren()),i.off()}function jU(e){const t=e.getRoot().querySelectorAll(`.${Dt}`);t==null||t.forEach(n=>{const{nameInteraction:r=new Map}=n;(r==null?void 0:r.size)>0&&Array.from(r==null?void 0:r.values()).forEach(i=>{i==null||i.destroy()})})}function VU(e){return typeof e=="string"?document.getElementById(e):e}const K_=e=>e?parseInt(e):0;function HU(e){const t=getComputedStyle(e),n=e.clientWidth||K_(t.width),r=e.clientHeight||K_(t.height),i=K_(t.paddingLeft)+K_(t.paddingRight),s=K_(t.paddingTop)+K_(t.paddingBottom);return{width:n-i,height:r-s}}function wte(e){const{height:t,width:n,padding:r=0,paddingLeft:i=r,paddingRight:s=r,paddingTop:l=r,paddingBottom:u=r,margin:h=0,marginLeft:p=h,marginRight:m=h,marginTop:y=h,marginBottom:b=h,inset:w=0,insetLeft:R=w,insetRight:P=w,insetTop:I=w,insetBottom:N=w}=e,z=$=>$==="auto"?20:$,Z=n-z(i)-z(s)-p-m-R-P,Y=t-z(l)-z(u)-y-b-I-N;return{width:Z,height:Y}}function jO(e,t){const n=[e];for(;n.length;){const r=n.shift();t&&t(r);const i=r.children||[];for(const s of i)n.push(s)}}class VO{constructor(t={},n){this.parentNode=null,this.children=[],this.index=0,this.type=n,this.value=t}map(t=n=>n){const n=t(this.value);return this.value=n,this}attr(t,n){return arguments.length===1?this.value[t]:this.map(r=>(r[t]=n,r))}append(t){const n=new t({});return n.children=[],this.push(n),n}push(t){return t.parentNode=this,t.index=this.children.length,this.children.push(t),this}remove(){const t=this.parentNode;if(t){const{children:n}=t,r=n.findIndex(i=>i===this);n.splice(r,1)}return this}getNodeByKey(t){let n=null;return jO(this,i=>{t===i.attr("key")&&(n=i)}),n}getNodesByType(t){const n=[];return jO(this,i=>{t===i.type&&n.push(i)}),n}getNodeByType(t){let n=null;return jO(this,r=>{n||t===r.type&&(n=r)}),n}call(t,...n){return t(this.map(),...n),this}getRoot(){let t=this;for(;t&&t.parentNode;)t=t.parentNode;return t}}var S5=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const HO=["width","height","depth","padding","paddingLeft","paddingRight","paddingBottom","paddingTop","inset","insetLeft","insetRight","insetTop","insetBottom","margin","marginLeft","marginRight","marginTop","marginBottom","autoFit","theme","title"],T5="__remove__",w5="__callback__",A5=1,C5=1;function ZU(e){if(e===void 0){const t=document.createElement("div");return t[T5]=!0,t}return typeof e=="string"?document.getElementById(e):e}function WU(e){const t=e.parentNode;t&&t.removeChild(e)}function GU(e){if(e.type!==null)return e;const t=e.children[e.children.length-1];for(const n of HO)t.attr(n,e.attr(n));return t}function O5(e){return Object.assign(Object.assign({},e.value),{type:e.type})}function ZO(e,t){const{width:n,height:r,autoFit:i,depth:s=0}=e;let l=640,u=480;if(i){const{width:h,height:p}=HU(t);l=h||l,u=p||u}return l=n||l,u=r||u,{width:Math.max((0,dr.Z)(l)?l:A5,A5),height:Math.max((0,dr.Z)(u)?u:C5,C5),depth:s}}function XU(e){const t=GU(e),n=[t],r=new Map;for(r.set(t,O5(t));n.length;){const i=n.pop(),s=r.get(i),{children:l=[]}=i;for(const u of l)if(u.type===w5)s.children=u.value;else{const h=O5(u),{children:p=[]}=s;p.push(h),n.push(u),r.set(u,h),s.children=p}}return r.get(t)}function YU(e,t){return typeof e=="function"?!0:new Set(Object.keys(t)).has(e)}function $U(e,t){return typeof e!="function"&&new Set(Object.keys(t)).has(e)}function KU(e,t,n,r,i){const{type:s}=e,{type:l=n||s}=t;if($U(l,i)){for(const u of HO)e.attr(u)!==void 0&&t[u]===void 0&&(t[u]=e.attr(u));return t}if(YU(l,r)){const u={type:"view"},h=Object.assign({},t);for(const p of HO)h[p]!==void 0&&(u[p]=h[p],delete h[p]);return Object.assign(Object.assign({},u),{children:[h]})}return t}function qU(e,t,n){if(typeof e=="function")return t.mark;const i=Object.assign(Object.assign({},t),n)[e];if(!i)throw new Error(`Unknown mark: ${e}.`);return i}function QU(e,t,n){if(typeof e=="function"){const h=new VO;return h.value=e,h.type=w5,h}const{type:r,children:i}=e,s=S5(e,["type","children"]),l=qU(r,t,n),u=new l;return u.value=s,u.type=r,u}function JU(e,t){const{type:n,children:r}=t,i=S5(t,["type","children"]);e.type===n||n===void 0?uE(e.value,i):typeof n=="string"&&(e.type=n,e.value=i)}function ej(e,t,n,r){if(!e)return;const i=[[e,t]];for(;i.length;){const[s,l]=i.shift(),u=QU(l,n,r);Array.isArray(s.children)&&s.push(u);const{children:h}=l;if(Array.isArray(h))for(const p of h)i.push([u,p]);else typeof h=="function"&&i.push([u,h])}}function tj(e,t,n,r,i){const s=KU(e,t,n,r,i),l=[[null,e,s]];for(;l.length;){const[u,h,p]=l.shift();if(!h)ej(u,p,r,i);else if(!p)h.remove();else{JU(h,p);const{children:m}=p,{children:y}=h;if(Array.isArray(m)&&Array.isArray(y)){const b=Math.max(m.length,y.length);for(let w=0;w<b;w++){const R=m[w],P=y[w];l.push([h,P,R])}}else typeof m=="function"&&l.push([h,null,m])}}}function nj(){let e,t;return[new Promise((r,i)=>{t=r,e=i}),t,e]}function rj(e,t,{key:n=t}){e.prototype[t]=function(r){return arguments.length===0?this.attr(n):this.attr(n,r)}}function ij(e,t,{key:n=t}){e.prototype[t]=function(r){if(arguments.length===0)return this.attr(n);if(Array.isArray(r))return this.attr(n,r);const i=[...this.attr(n)||[],r];return this.attr(n,i)}}function oj(e,t,{key:n=t}){e.prototype[t]=function(r,i){if(arguments.length===0)return this.attr(n);if(arguments.length===1&&typeof r!="string")return this.attr(n,r);const s=this.attr(n)||{};return s[r]=arguments.length===1?!0:i,this.attr(n,s)}}function aj(e,t,n){e.prototype[t]=function(r){if(arguments.length===0)return this.attr(t);if(Array.isArray(r))return this.attr(t,{items:r});if(Q0(r)&&(r.title!==void 0||r.items!==void 0))return this.attr(t,r);if(r===null||r===!1)return this.attr(t,r);const i=this.attr(t)||{},{items:s=[]}=i;return s.push(r),i.items=s,this.attr(t,i)}}function sj(e,t,{ctor:n}){e.prototype[t]=function(r){const i=this.append(n);return t==="mark"&&(i.type=r),i}}function lj(e,t,{ctor:n}){e.prototype[t]=function(){return this.type=null,this.append(n)}}function cT(e){return t=>{for(const[n,r]of Object.entries(e)){const{type:i}=r;i==="value"?rj(t,n,r):i==="array"?ij(t,n,r):i==="object"?oj(t,n,r):i==="node"?sj(t,n,r):i==="container"?lj(t,n,r):i==="mix"&&aj(t,n,r)}return t}}function R5(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,{type:"node",ctor:n}]))}const M5={encode:{type:"object"},scale:{type:"object"},data:{type:"value"},transform:{type:"array"},style:{type:"object"},animate:{type:"object"},coordinate:{type:"object"},interaction:{type:"object"},label:{type:"array",key:"labels"},axis:{type:"object"},legend:{type:"object"},slider:{type:"object"},scrollbar:{type:"object"},state:{type:"object"},layout:{type:"object"},theme:{type:"object"},title:{type:"value"}},cj=Object.assign(Object.assign({},M5),{tooltip:{type:"mix"},viewStyle:{type:"object"}}),uj=Object.assign(Object.assign({},M5),{labelTransform:{type:"array"}});var fj=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let uT=class extends VO{changeData(t){var n;const r=this.getRoot();if(r)return this.attr("data",t),!((n=this.children)===null||n===void 0)&&n.length&&this.children.forEach(i=>{i.attr("data",t)}),r==null?void 0:r.render()}getView(){const t=this.getRoot(),{views:n}=t.getContext();if(n!=null&&n.length)return n.find(r=>r.key===this._key)}getScale(){var t;return(t=this.getView())===null||t===void 0?void 0:t.scale}getScaleByChannel(t){const n=this.getScale();if(n)return n[t]}getCoordinate(){var t;return(t=this.getView())===null||t===void 0?void 0:t.coordinate}getTheme(){var t;return(t=this.getView())===null||t===void 0?void 0:t.theme}getGroup(){const t=this._key;return t?this.getRoot().getContext().canvas.getRoot().getElementById(t):void 0}show(){const t=this.getGroup();t&&!t.isVisible()&&WS(t)}hide(){const t=this.getGroup();t&&t.isVisible()&&xO(t)}};uT=fj([cT(uj)],uT);var hj=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let WO=class extends VO{changeData(t){const n=this.getRoot();if(n)return this.attr("data",t),n==null?void 0:n.render()}getMark(){var t;const n=(t=this.getRoot())===null||t===void 0?void 0:t.getView();if(!n)return;const{markState:r}=n,i=Array.from(r.keys()).find(s=>s.key===this.attr("key"));return r.get(i)}getScale(){var t;const n=(t=this.getRoot())===null||t===void 0?void 0:t.getView();if(n)return n==null?void 0:n.scale}getScaleByChannel(t){var n,r;const i=(n=this.getRoot())===null||n===void 0?void 0:n.getView();if(i)return(r=i==null?void 0:i.scale)===null||r===void 0?void 0:r[t]}getGroup(){const t=this.attr("key");return t?this.getRoot().getContext().canvas.getRoot().getElementById(t):void 0}};WO=hj([cT(cj)],WO);var dj=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},pj=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const mj="G2_CHART_KEY";class vj extends uT{constructor(t){const{container:n,canvas:r,renderer:i,plugins:s,lib:l,createCanvas:u}=t,h=pj(t,["container","canvas","renderer","plugins","lib","createCanvas"]);super(h,"view"),this._hasBindAutoFit=!1,this._rendering=!1,this._trailing=!1,this._trailingResolve=null,this._trailingReject=null,this._previousDefinedType=null,this._onResize=q2(()=>{this.forceFit()},300),this._renderer=i||new Cb,this._plugins=s||[],this._container=ZU(n),this._emitter=new xn,this._context={library:Object.assign(Object.assign({},l),at),emitter:this._emitter,canvas:r,createCanvas:u},this._create()}render(){if(this._rendering)return this._addToTrailing();this._context.canvas||this._createCanvas(),this._context.canvas.getConfig().supportsCSSTransform=!0,this._bindAutoFit(),this._rendering=!0;const t=new Promise((s,l)=>UU(this._computedOptions(),this._context,this._createResolve(s),this._createReject(l))),[n,r,i]=nj();return t.then(r).catch(i).then(()=>this._renderTrailing()),n}options(t){if(arguments.length===0)return XU(this);const{type:n}=t;return n&&(this._previousDefinedType=n),tj(this,t,this._previousDefinedType,this._marks,this._compositions),this}getContainer(){return this._container}getContext(){return this._context}on(t,n,r){return this._emitter.on(t,n,r),this}once(t,n){return this._emitter.once(t,n),this}emit(t,...n){return this._emitter.emit(t,...n),this}off(t,n){return this._emitter.off(t,n),this}clear(){const t=this.options();this.emit(gl.BEFORE_CLEAR),this._reset(),E5(t,this._context,!1),this.emit(gl.AFTER_CLEAR)}destroy(){const t=this.options();this.emit(gl.BEFORE_DESTROY),this._unbindAutoFit(),this._reset(),E5(t,this._context,!0),this._container[T5]&&WU(this._container),this.emit(gl.AFTER_DESTROY)}forceFit(){this.options.autoFit=!0;const{width:t,height:n}=ZO(this.options(),this._container);if(t===this._width&&n===this._height)return Promise.resolve(this);this.emit(gl.BEFORE_CHANGE_SIZE);const r=this.render();return r.then(()=>{this.emit(gl.AFTER_CHANGE_SIZE)}),r}changeSize(t,n){if(t===this._width&&n===this._height)return Promise.resolve(this);this.emit(gl.BEFORE_CHANGE_SIZE),this.attr("width",t),this.attr("height",n);const r=this.render();return r.then(()=>{this.emit(gl.AFTER_CHANGE_SIZE)}),r}_create(){const{library:t}=this._context,n=s=>s.startsWith("mark.")||s==="component.axisX"||s==="component.axisY"||s==="component.legends",r=["mark.mark",...Object.keys(t).filter(n)];this._marks={};for(const s of r){const l=s.split(".").pop();class u extends WO{constructor(){super({},l)}}this._marks[l]=u,this[l]=function(h){const p=this.append(u);return l==="mark"&&(p.type=h),p}}const i=["composition.view",...Object.keys(t).filter(s=>s.startsWith("composition.")&&s!=="composition.mark")];this._compositions=Object.fromEntries(i.map(s=>{const l=s.split(".").pop();let u=class extends uT{constructor(){super({},l)}};return u=dj([cT(R5(this._marks))],u),[l,u]}));for(const s of Object.values(this._compositions))cT(R5(this._compositions))(s);for(const s of i){const l=s.split(".").pop();this[l]=function(){const u=this._compositions[l];return this.type=null,this.append(u)}}}_reset(){const t=["theme","type","width","height","autoFit"];this.type="view",this.value=Object.fromEntries(Object.entries(this.value).filter(([n])=>n.startsWith("margin")||n.startsWith("padding")||n.startsWith("inset")||t.includes(n))),this.children=[]}_renderTrailing(){this._trailing&&(this._trailing=!1,this.render().then(()=>{const t=this._trailingResolve.bind(this);this._trailingResolve=null,t(this)}).catch(t=>{const n=this._trailingReject.bind(this);this._trailingReject=null,n(t)}))}_createResolve(t){return()=>{this._rendering=!1,t(this)}}_createReject(t){return n=>{this._rendering=!1,t(n)}}_computedOptions(){const t=this.options(),{key:n=mj}=t,{width:r,height:i,depth:s}=ZO(t,this._container);return this._width=r,this._height=i,this._key=n,Object.assign(Object.assign({key:this._key},t),{width:r,height:i,depth:s})}_createCanvas(){const{width:t,height:n}=ZO(this.options(),this._container);this._plugins.push(new K2),this._plugins.forEach(r=>this._renderer.registerPlugin(r)),this._context.canvas=new Hu({container:this._container,width:t,height:n,renderer:this._renderer})}_addToTrailing(){var t;return(t=this._trailingResolve)===null||t===void 0||t.call(this,this),this._trailing=!0,new Promise((r,i)=>{this._trailingResolve=r,this._trailingReject=i})}_bindAutoFit(){const t=this.options(),{autoFit:n}=t;if(this._hasBindAutoFit){n||this._unbindAutoFit();return}n&&(this._hasBindAutoFit=!0,window.addEventListener("resize",this._onResize))}_unbindAutoFit(){this._hasBindAutoFit&&(this._hasBindAutoFit=!1,window.removeEventListener("resize",this._onResize))}}function gj(e,t){class n extends e{constructor(i){super(Object.assign(Object.assign({},i),{lib:t}))}}return n}var yj=Object.prototype.hasOwnProperty,GO=function(e,t){if(e===null||!q0(e))return{};var n={};return y_(t,function(r){yj.call(e,r)&&(n[r]=e[r])}),n};function P5(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Bx(e,t,n,r,i){for(var s=e.children,l,u=-1,h=s.length,p=e.value&&(r-t)/e.value;++u<h;)l=s[u],l.y0=n,l.y1=i,l.x0=t,l.x1=t+=l.value*p}function _j(){var e=1,t=1,n=0,r=!1;function i(l){var u=l.height+1;return l.x0=l.y0=n,l.x1=e,l.y1=t/u,l.eachBefore(s(t,u)),r&&l.eachBefore(P5),l}function s(l,u){return function(h){h.children&&Bx(h,h.x0,l*(h.depth+1)/u,h.x1,l*(h.depth+2)/u);var p=h.x0,m=h.y0,y=h.x1-n,b=h.y1-n;y<p&&(p=y=(p+y)/2),b<m&&(m=b=(m+b)/2),h.x0=p,h.y0=m,h.x1=y,h.y1=b}}return i.round=function(l){return arguments.length?(r=!!l,i):r},i.size=function(l){return arguments.length?(e=+l[0],t=+l[1],i):[e,t]},i.padding=function(l){return arguments.length?(n=+l,i):n},i}var bj=D(9783);function xj(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Ej(){return this.eachAfter(xj)}var XO=D(64599);function Sj(e,t){var n=-1,r=XO(this),i;try{for(r.s();!(i=r.n()).done;){var s=i.value;e.call(t,s,++n,this)}}catch(l){r.e(l)}finally{r.f()}return this}function Tj(e,t){for(var n=this,r=[n],i,s,l=-1;n=r.pop();)if(e.call(t,n,++l,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function wj(e,t){for(var n=this,r=[n],i=[],s,l,u,h=-1;n=r.pop();)if(i.push(n),s=n.children)for(l=0,u=s.length;l<u;++l)r.push(s[l]);for(;n=i.pop();)e.call(t,n,++h,this);return this}function Aj(e,t){var n=-1,r=XO(this),i;try{for(r.s();!(i=r.n()).done;){var s=i.value;if(e.call(t,s,++n,this))return s}}catch(l){r.e(l)}finally{r.f()}}function Cj(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Oj(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Rj(e){for(var t=this,n=Mj(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Mj(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Pj(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Ij(){return Array.from(this)}function Lj(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Dj(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}var I5=D(15009),Nj=I5().mark(L5);function L5(){var e,t,n,r,i,s;return I5().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:e=this,n=[e];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){u.next=8;break}return u.next=5,e;case 5:if(r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);u.next=2;break;case 8:if(n.length){u.next=1;break}case 9:case"end":return u.stop()}},Nj,this)}function q_(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=kj)):t===void 0&&(t=Fj);for(var n=new Q_(e),r,i=[n],s,l,u,h;r=i.pop();)if((l=t(r.data))&&(h=(l=Array.from(l)).length))for(r.children=l,u=h-1;u>=0;--u)i.push(s=l[u]=new Q_(l[u])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(D5)}function Bj(){return q_(this).eachBefore(zj)}function Fj(e){return e.children}function kj(e){return Array.isArray(e)?e[1]:null}function zj(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function D5(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Q_(e){this.data=e,this.depth=this.height=0,this.parent=null}Q_.prototype=q_.prototype=bj({constructor:Q_,count:Ej,each:Sj,eachAfter:wj,eachBefore:Tj,find:Aj,sum:Cj,sort:Oj,path:Rj,ancestors:Pj,descendants:Ij,leaves:Lj,links:Dj,copy:Bj},Symbol.iterator,L5);function YO(e,t){for(var n in t)t.hasOwnProperty(n)&&n!=="constructor"&&t[n]!==void 0&&(e[n]=t[n])}function Uj(e,t,n,r){return t&&YO(e,t),n&&YO(e,n),r&&YO(e,r),e}const jj={field:"value",size:[1,1],round:!1,padding:0,sort:(e,t)=>t.value-e.value,as:["x","y"],ignoreParentValue:!0},Vj="nodeIndex",Fx="childNodeCount",Hj="nodeAncestor",$O="Invalid field: it must be a string!";function Zj(e,t){const{field:n,fields:r}=e;if(Xo(n))return n;if(_s(n))return console.warn($O),n[0];if(console.warn(`${$O} will try to get fields instead.`),Xo(r))return r;if(_s(r)&&r.length)return r[0];if(t)return t;throw new TypeError($O)}function Wj(e){const t=[];if(e&&e.each){let n,r;e.each(i=>{var s,l;i.parent!==n?(n=i.parent,r=0):r+=1;const u=NP((((s=i.ancestors)===null||s===void 0?void 0:s.call(i))||[]).map(h=>t.find(p=>p.name===h.name)||h),({depth:h})=>h>0&&h<i.depth);i[Hj]=u,i[Fx]=((l=i.children)===null||l===void 0?void 0:l.length)||0,i[Vj]=r,t.push(i)})}else e&&e.eachNode&&e.eachNode(n=>{t.push(n)});return t}function Gj(e,t){t=Uj({},jj,t);const n=t.as;if(!_s(n)||n.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');let r;try{r=Zj(t)}catch(h){console.warn(h)}const s=(h=>_j().size(t.size).round(t.round).padding(t.padding)(q_(h).sum(p=>r1(p.children)?t.ignoreParentValue?0:p[r]-rS(p.children,(m,y)=>m+y[r],0):p[r]).sort(t.sort)))(e),l=n[0],u=n[1];return s.each(h=>{var p,m;h[l]=[h.x0,h.x1,h.x1,h.x0],h[u]=[h.y1,h.y1,h.y0,h.y0],h.name=h.name||((p=h.data)===null||p===void 0?void 0:p.name)||((m=h.data)===null||m===void 0?void 0:m.label),h.data.name=h.name,["x0","x1","y0","y1"].forEach(y=>{n.indexOf(y)===-1&&delete h[y]})}),Wj(s)}var Xj=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const J_="sunburst",KO="markType",Ate="value",N5="path",fT="ancestor-node";function Yj(e){const{data:t,encode:n}=e,{color:r,value:i}=n,l=Gj(t,{field:i,type:"hierarchy.partition",as:["x","y"]}),u=[];return l.forEach(h=>{var p,m,y,b;if(h.depth===0)return null;let w=h.data.name;const R=[w];let P=Object.assign({},h);for(;P.depth>1;)w=`${(p=P.parent.data)===null||p===void 0?void 0:p.name} / ${w}`,R.unshift((m=P.parent.data)===null||m===void 0?void 0:m.name),P=P.parent;const I=Object.assign(Object.assign(Object.assign({},GO(h.data,[i])),{[N5]:w,[fT]:P.data.name}),h);r&&r!==fT&&(I[r]=h.data[r]||((b=(y=h.parent)===null||y===void 0?void 0:y.data)===null||b===void 0?void 0:b[r])),u.push(I)}),u.map(h=>{const p=h.x.slice(0,2),m=[h.y[2],h.y[0]];return p[0]===p[1]&&(m[0]=m[1]=(h.y[2]+h.y[0])/2),Object.assign(Object.assign({},h),{x:p,y:m,fillOpacity:Math.pow(.85,h.depth)})})}const B5={id:J_,encode:{x:"x",y:"y",key:N5,color:fT,value:"value"},axis:{x:!1,y:!1},style:{[KO]:J_,stroke:"#fff",lineWidth:.5,fillOpacity:"fillOpacity",[Fx]:Fx,depth:"depth"},state:{active:{zIndex:2,stroke:"#000"},inactive:{zIndex:1,stroke:"#fff"}},legend:!1,interaction:{drillDown:!0},coordinate:{type:"polar",innerRadius:.2}},F5=e=>{const{encode:t,data:n=[],legend:r}=e,i=Xj(e,["encode","data","legend"]),s=Object.assign(Object.assign({},i.coordinate),{innerRadius:Math.max(ol(i,["coordinate","innerRadius"],.2),1e-5)}),l=Object.assign(Object.assign({},B5.encode),t),{value:u}=l,h=Yj({encode:l,data:n});return console.log(h,"rectData"),[ri({},B5,Object.assign(Object.assign({type:"rect",data:h,encode:l,tooltip:{title:"path",items:[p=>({name:u,value:p[u]})]}},i),{coordinate:s}))]};F5.props={};var $j=Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];return y_(e,function(n,r){Dh(e)&&r==="prototype"||t.push(r)}),t},qO=$j,Kj=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const qj=e=>e.querySelectorAll(".element").filter(t=>ol(t,["style",KO])===J_);function Qj(e){return Ra(e).select(`.${Me}`).node()}const Jj={rootText:"root",style:{fill:"rgba(0, 0, 0, 0.85)",fontSize:12,y:1},active:{fill:"rgba(0, 0, 0, 0.5)"}};function eV(e={}){const{breadCrumb:t={},isFixedColor:n=!1}=e,r=ri({},Jj,t);return i=>{const{update:s,setState:l,container:u,view:h,options:p}=i,m=u.ownerDocument,y=Qj(u),b=p.marks.find(({id:Z})=>Z===J_),{state:w}=b,R=m.createElement("g");y.appendChild(R);const P=(Z,Y)=>Kj(this,void 0,void 0,function*(){if(R.removeChildren(),Z){const $=m.createElement("text",{style:Object.assign({x:0,text:r.rootText,depth:0},r.style)});R.appendChild($);let J="";const ae=Z==null?void 0:Z.split(" / ");let pe=r.style.y,Oe=R.getBBox().width;const Ve=y.getBBox().width,Ke=ae.map((lt,Ge)=>{const rt=m.createElement("text",{style:Object.assign(Object.assign({x:Oe,text:" / "},r.style),{y:pe})});R.appendChild(rt),Oe+=rt.getBBox().width,J=`${J}${lt} / `;const st=m.createElement("text",{name:J.replace(/\s\/\s$/,""),style:Object.assign(Object.assign({text:lt,x:Oe,depth:Ge+1},r.style),{y:pe})});return R.appendChild(st),Oe+=st.getBBox().width,Oe>Ve&&(pe=R.getBBox().height,Oe=0,rt.attr({x:Oe,y:pe}),Oe+=rt.getBBox().width,st.attr({x:Oe,y:pe}),Oe+=st.getBBox().width),st});[$,...Ke].forEach((lt,Ge)=>{if(Ge===Ke.length)return;const rt=Object.assign({},lt.attributes);lt.attr("cursor","pointer"),lt.addEventListener("mouseenter",()=>{lt.attr(r.active)}),lt.addEventListener("mouseleave",()=>{lt.attr(rt)}),lt.addEventListener("click",()=>{P(lt.name,ol(lt,["style","depth"]))})})}l("drillDown",$=>{const{marks:J}=$,ae=J.map(pe=>{if(pe.id!==J_&&pe.type!=="rect")return pe;const{data:Oe}=pe,Ve=Object.fromEntries(["color"].map(lt=>[lt,{domain:h.scale[lt].getOptions().domain}])),Ke=Oe.filter(lt=>{const Ge=lt.path;return n||(lt[fT]=Ge.split(" / ")[Y]),Z?new RegExp(`^${Z}.+`).test(Ge):!0});return ri({},pe,n?{data:Ke,scale:Ve}:{data:Ke})});return Object.assign(Object.assign({},$),{marks:ae})}),yield s()}),I=Z=>{const Y=Z.target;if(ol(Y,["style",KO])!==J_||ol(Y,["markType"])!=="rect"||!ol(Y,["style",Fx]))return;const $=ol(Y,["__data__","key"]),J=ol(Y,["style","depth"]);Y.style.cursor="pointer",P($,J)};y.addEventListener("click",I);const N=qO(Object.assign(Object.assign({},w.active),w.inactive)),z=()=>{qj(y).forEach(Y=>{const $=ol(Y,["style",Fx]);if(ol(Y,["style","cursor"])!=="pointer"&&$){Y.style.cursor="pointer";const ae=GO(Y.attributes,N);Y.addEventListener("mouseenter",()=>{Y.attr(w.active)}),Y.addEventListener("mouseleave",()=>{Y.attr(ri(ae,w.inactive))})}})};return y.addEventListener("mousemove",z),()=>{R.remove(),y.removeEventListener("click",I),y.removeEventListener("mousemove",z)}}}function tV(){return{"interaction.drillDown":eV,"mark.sunburst":F5}}const k5=()=>[["cartesian"]];k5.props={};const QO=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];QO.props={transform:!0};const nV=(e={})=>{const t={startAngle:-Math.PI/2,endAngle:Math.PI*3/2,innerRadius:0,outerRadius:1};return Object.assign(Object.assign({},t),e)},z5=e=>{const{startAngle:t,endAngle:n,innerRadius:r,outerRadius:i}=nV(e);return[...QO(),...jy({startAngle:t,endAngle:n,innerRadius:r,outerRadius:i})]};z5.props={};const JO=()=>[["parallel",0,1,0,1]];JO.props={};const U5=({focusX:e=0,focusY:t=0,distortionX:n=2,distortionY:r=2,visual:i=!1})=>[["fisheye",e,t,n,r,i]];U5.props={transform:!0};const j5=e=>{const{startAngle:t=-Math.PI/2,endAngle:n=Math.PI*3/2,innerRadius:r=0,outerRadius:i=1}=e;return[...JO(),...jy({startAngle:t,endAngle:n,innerRadius:r,outerRadius:i})]};j5.props={};const V5=({value:e})=>t=>t.map(()=>e);V5.props={};const H5=({value:e})=>t=>t.map(n=>n[e]);H5.props={};const Z5=({value:e})=>t=>t.map(e);Z5.props={};const W5=({value:e})=>()=>e;W5.props={};function yc(e,t){if(e!==null)return{type:"column",value:e,field:t}}function hT(e,t){const n=yc(e,t);return Object.assign(Object.assign({},n),{inferred:!0})}function dT(e,t){if(e!==null)return{type:"column",value:e,field:t,visual:!0}}function rV(e,t){const n=yc(e,t);return Object.assign(Object.assign({},n),{constant:!1})}function iy(e,t){const n=[];for(const r of e)n[r]=t;return n}function tl(e,t){const n=e[t];if(!n)return[null,null];const{value:r,field:i=null}=n;return[r,i]}function kx(e,...t){for(const n of t)if(typeof n=="string"){const[r,i]=tl(e,n);if(r!==null)return[r,i]}else return[n,null];return[null,null]}function zx(e){return e instanceof Date?!1:typeof e=="object"}const Ux=()=>(e,t)=>{const{encode:n}=t,{y1:r}=n;return r!==void 0?[e,t]:[e,ri({},t,{encode:{y1:hT(iy(e,0))}})]};Ux.props={};const v1=()=>(e,t)=>{const{encode:n}=t,{x:r}=n;return r!==void 0?[e,t]:[e,ri({},t,{encode:{x:hT(iy(e,0))},scale:{x:{guide:null}}})]};v1.props={};const g1=(e,t)=>Cx(Object.assign({colorAttribute:"fill"},e),t);g1.props=Object.assign(Object.assign({},Cx.props),{defaultMarker:"square"});const pT=(e,t)=>Cx(Object.assign({colorAttribute:"stroke"},e),t);pT.props=Object.assign(Object.assign({},Cx.props),{defaultMarker:"hollowSquare"});function eb(){}function G5(e){this._context=e}G5.prototype={areaStart:eb,areaEnd:eb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function e3(e){return new G5(e)}var X5=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function iV(e,t,n){const[r,i,s,l]=e;if(pc(n)){const p=[t?t[0][0]:i[0],i[1]],m=[t?t[3][0]:s[0],s[1]];return[r,p,m,l]}const u=[i[0],t?t[0][1]:i[1]],h=[s[0],t?t[3][1]:s[1]];return[r,u,h,l]}const t3=(e,t)=>{const{adjustPoints:n=iV}=e,r=X5(e,["adjustPoints"]),{coordinate:i,document:s}=t;return(l,u,h,p)=>{const{index:m}=u,{color:y}=h,b=X5(h,["color"]),w=p[m+1],R=n(l,w,i),P=!!pc(i),[I,N,z,Z]=P?s1(R):R,{color:Y=y,opacity:$}=u,J=sr().curve(e3)([I,N,z,Z]);return Ra(s.createElement("path",{})).call(ea,b).style("d",J).style("fill",Y).style("fillOpacity",$).call(ea,r).node()}};t3.props={defaultMarker:"square"};function oV(e,t,n){const[r,i,s,l]=e;if(pc(n)){const p=[t?t[0][0]:(i[0]+s[0])/2,i[1]],m=[t?t[3][0]:(i[0]+s[0])/2,s[1]];return[r,p,m,l]}const u=[i[0],t?t[0][1]:(i[1]+s[1])/2],h=[s[0],t?t[3][1]:(i[1]+s[1])/2];return[r,u,h,l]}const Y5=(e,t)=>t3(Object.assign({adjustPoints:oV},e),t);Y5.props={defaultMarker:"square"};function jx(e){return Math.abs(e)>10?String(e):e.toString().padStart(2,"0")}function aV(e){const t=e.getFullYear(),n=jx(e.getMonth()+1),r=jx(e.getDate()),i=`${t}-${n}-${r}`,s=e.getHours(),l=e.getMinutes(),u=e.getSeconds();return s||l||u?`${i} ${jx(s)}:${jx(l)}:${jx(u)}`:i}const mT=(e={})=>{const{channel:t="x"}=e;return(n,r)=>{const{encode:i}=r,{tooltip:s}=r;if(J0(s))return[n,r];const{title:l}=s;if(l!==void 0)return[n,r];const u=Object.keys(i).filter(p=>p.startsWith(t)).filter(p=>!i[p].inferred).map(p=>tl(i,p)).filter(([p])=>p).map(p=>p[0]);if(u.length===0)return[n,r];const h=[];for(const p of n)h[p]={value:u.map(m=>m[p]instanceof Date?aV(m[p]):m[p]).join(", ")};return[n,ri({},r,{tooltip:{title:h}})]}};mT.props={};const vT=e=>{const{channel:t}=e;return(n,r)=>{const{encode:i,tooltip:s}=r;if(J0(s))return[n,r];const{items:l=[]}=s;if(!l||l.length>0)return[n,r];const h=(Array.isArray(t)?t:[t]).flatMap(p=>Object.keys(i).filter(m=>m.startsWith(p)).map(m=>{const{field:y,value:b,inferred:w=!1,aggregate:R}=i[m];return w?null:R&&b?{channel:m}:y?{field:y}:b?{channel:m}:null}).filter(m=>m!==null));return[n,ri({},r,{tooltip:{items:h}})]}};vT.props={};var sV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const $5=()=>(e,t)=>{const{encode:n}=t,{key:r}=n,i=sV(n,["key"]);if(r!==void 0)return[e,t];const s=Object.values(i).map(({value:u})=>u),l=e.map(u=>s.filter(Array.isArray).map(h=>h[u]).join("-"));return[e,ri({},t,{encode:{key:yc(l)}})]};$5.props={};function K5(e={}){const{shapes:t}=e;return[{name:"color"},{name:"opacity"},{name:"shape",range:t},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function Fd(e={}){return[...K5(e),{name:"title",scale:"identity"}]}function Cte(){return[{type:MaybeTitle,channel:"color"},{type:MaybeTooltip,channel:["x","y","z"]}]}function oy(){return[{type:mT,channel:"color"},{type:vT,channel:["x","y"]}]}function tb(){return[{type:mT,channel:"x"},{type:vT,channel:["y"]}]}function lV(){return[{type:mT,channel:"color"},{type:vT,channel:["position"]}]}function nb(e={}){return K5(e)}function Xu(){return[{type:$5}]}function pf(){return[]}function n3(e,t){return e.getBandWidth(e.invert(t))}function y1(e,t,n={}){const{x:r,y:i,series:s}=t,{x:l,y:u,series:h}=e,{style:{bandOffset:p=h?0:.5,bandOffsetX:m=p,bandOffsetY:y=p}={}}=n,b=!!(l!=null&&l.getBandWidth),w=!!(u!=null&&u.getBandWidth),R=!!(h!=null&&h.getBandWidth);return!b&&!w?P=>P:(P,I)=>{const N=b?n3(l,r[I]):0,z=w?n3(u,i[I]):0,Y=R&&s?(n3(h,s[I])/2+ +s[I])*N:0,[$,J]=P;return[$+m*N+Y,J+y*z]}}function gT(e){return parseFloat(e)/100}function r3(e,t,n,r){const{x:i,y:s}=n,{innerWidth:l,innerHeight:u}=r.getOptions(),h=Array.from(e,p=>{const m=i[p],y=s[p],b=typeof m=="string"?gT(m)*l:+m,w=typeof y=="string"?gT(y)*u:+y;return[[b,w]]});return[e,h]}function cv(e){return typeof e=="function"?e:t=>t[e]}function i3(e,t){return Array.from(e,cv(t))}function o3(e,t){const{source:n=m=>m.source,target:r=m=>m.target,value:i=m=>m.value}=t,{links:s,nodes:l}=e,u=i3(s,n),h=i3(s,r),p=i3(s,i);return{links:s.map((m,y)=>({target:h[y],source:u[y],value:p[y]})),nodes:l||Array.from(new Set([...u,...h]),m=>({key:m}))}}function q5(e,t){return e.getBandWidth(e.invert(t))}const Q5={rect:g1,hollow:pT,funnel:t3,pyramid:Y5},J5=()=>(e,t,n,r)=>{const{x:i,y:s,y1:l,series:u,size:h}=n,p=t.x,m=t.series,[y]=r.getSize(),b=h?h.map(P=>+P/y):null,w=h?(P,I,N)=>{const z=P+I/2,Z=b[N];return[z-Z/2,z+Z/2]}:(P,I,N)=>[P,P+I],R=Array.from(e,P=>{const I=q5(p,i[P]),N=m?q5(m,u==null?void 0:u[P]):1,z=I*N,Z=(+(u==null?void 0:u[P])||0)*I,Y=+i[P]+Z,[$,J]=w(Y,z,P),ae=+s[P],pe=+l[P];return[[$,ae],[J,ae],[J,pe],[$,pe]].map(Ge=>r.map(Ge))});return[e,R]};J5.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:Q5,channels:[...Fd({shapes:Object.keys(Q5)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[...Xu(),{type:Ux},{type:v1}],postInference:[...pf(),...tb()],interaction:{shareTooltip:!0}};const e4={rect:g1,hollow:pT},t4=()=>(e,t,n,r)=>{const{x:i,x1:s,y:l,y1:u}=n,h=Array.from(e,p=>{const m=[+i[p],+l[p]],y=[+s[p],+l[p]],b=[+s[p],+u[p]],w=[+i[p],+u[p]];return[m,y,b,w].map(R=>r.map(R))});return[e,h]};t4.props={defaultShape:"rect",defaultLabelShape:"label",composite:!1,shape:e4,channels:[...Fd({shapes:Object.keys(e4)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Xu(),{type:Ux}],postInference:[...pf(),...tb()],interaction:{shareTooltip:!0}};var n4=a3(v);function r4(e){this._curve=e}r4.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function a3(e){function t(n){return new r4(e(n))}return t._curve=e,t}function Vx(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(n){return arguments.length?t(a3(n)):t()._curve},e}function cV(){return Vx(sr().curve(n4))}var i4=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const uV=Rr(e=>{const{d1:t,d2:n,style1:r,style2:i}=e.attributes,s=e.ownerDocument;Ra(e).maybeAppend("line",()=>s.createElement("path",{})).style("d",t).call(ea,r),Ra(e).maybeAppend("line1",()=>s.createElement("path",{})).style("d",n).call(ea,i)});function fV(e,t){const n=[],r=[];let i=!1,s=null;for(const l of e)!t(l[0])||!t(l[1])?i=!0:(n.push(l),i&&(i=!1,r.push([s,l])),s=l);return[n,r]}const P0=(e,t)=>{const{curve:n,gradient:r=!1,gradientColor:i="between",defined:s=m=>!Number.isNaN(m)&&m!==void 0&&m!==null,connect:l=!1}=e,u=i4(e,["curve","gradient","gradientColor","defined","connect"]),{coordinate:h,document:p}=t;return(m,y,b)=>{const{color:w,lineWidth:R}=b,P=i4(b,["color","lineWidth"]),{color:I=w,size:N=R,seriesColor:z,seriesX:Z,seriesY:Y}=y,$=NS(h,y),J=pc(h),ae=r&&z?DS(z,Z,Y,r,i,J):I,pe=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},P),ae&&{stroke:ae}),N&&{lineWidth:N}),$&&{transform:$}),u);let Oe;if(Nl(h)){const st=h.getCenter();Oe=ut=>cV().angle((jt,At)=>Yg(ru(ut[At],st))).radius((jt,At)=>Ic(ut[At],st)).defined(([jt,At])=>s(jt)&&s(At)).curve(n)(ut)}else Oe=sr().x(st=>st[0]).y(st=>st[1]).defined(([st,ut])=>s(st)&&s(ut)).curve(n);const[Ve,Ke]=fV(m,s),lt=uo(pe,"connect"),Ge=!!Ke.length;if(!Ge||l&&!Object.keys(lt).length)return Ra(p.createElement("path",{})).style("d",Oe(Ve)||[]).call(ea,pe).node();if(Ge&&!l)return Ra(p.createElement("path",{})).style("d",Oe(m)).call(ea,pe).node();const rt=st=>st.map(Oe).join(",");return Ra(new uV).style("style1",Object.assign(Object.assign({},pe),lt)).style("style2",pe).style("d1",rt(Ke)).style("d2",Oe(m)).node()}};P0.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const o4=(e,t)=>{const{coordinate:n}=t;return(...r)=>{const i=Nl(n)?e3:v;return P0(Object.assign({curve:i},e),t)(...r)}};o4.props=Object.assign(Object.assign({},P0.props),{defaultMarker:"line"});function s3(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function l3(e,t){this._context=e,this._k=(1-t)/6}l3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:s3(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:s3(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ote=function e(t){function n(r){return new l3(r,t)}return n.tension=function(r){return e(+r)},n}(0);function c3(e,t){this._context=e,this._k=(1-t)/6}c3.prototype={areaStart:eb,areaEnd:eb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:s3(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Rte=function e(t){function n(r){return new c3(r,t)}return n.tension=function(r){return e(+r)},n}(0);function a4(e,t,n){var r=e._x1,i=e._y1,s=e._x2,l=e._y2;if(e._l01_a>vd){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,h=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/h,i=(i*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/h}if(e._l23_a>vd){var p=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,m=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*p+e._x1*e._l23_2a-t*e._l12_2a)/m,l=(l*p+e._y1*e._l23_2a-n*e._l12_2a)/m}e._context.bezierCurveTo(r,i,s,l,e._x2,e._y2)}function s4(e,t){this._context=e,this._alpha=t}s4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:a4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Mte=function e(t){function n(r){return t?new s4(r,t):new l3(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function l4(e,t){this._context=e,this._alpha=t}l4.prototype={areaStart:eb,areaEnd:eb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:a4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var c4=function e(t){function n(r){return t?new l4(r,t):new c3(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function u4(e){return e<0?-1:1}function f4(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),l=(n-e._y1)/(i||r<0&&-0),u=(s*i+l*r)/(r+i);return(u4(s)+u4(l))*Math.min(Math.abs(s),Math.abs(l),.5*Math.abs(u))||0}function h4(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function u3(e,t,n){var r=e._x0,i=e._y0,s=e._x1,l=e._y1,u=(s-r)/3;e._context.bezierCurveTo(r+u,i+u*t,s-u,l-u*n,s,l)}function yT(e){this._context=e}yT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:u3(this,this._t0,h4(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,u3(this,h4(this,n=f4(this,e,t)),n);break;default:u3(this,this._t0,n=f4(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function d4(e){this._context=new p4(e)}(d4.prototype=Object.create(yT.prototype)).point=function(e,t){yT.prototype.point.call(this,t,e)};function p4(e){this._context=e}p4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function m4(e){return new yT(e)}function v4(e){return new d4(e)}var hV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const g4=(e,t)=>{const n=hV(e,[]),{coordinate:r}=t;return(...i)=>{const s=Nl(r)?c4:pc(r)?v4:m4;return P0(Object.assign({curve:s},n),t)(...i)}};g4.props=Object.assign(Object.assign({},P0.props),{defaultMarker:"smooth"});function _T(e,t){this._context=e,this._t=t}_T.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function y4(e){return new _T(e,.5)}function _4(e){return new _T(e,0)}function b4(e){return new _T(e,1)}const x4=(e,t)=>P0(Object.assign({curve:b4},e),t);x4.props=Object.assign(Object.assign({},P0.props),{defaultMarker:"hv"});const E4=(e,t)=>P0(Object.assign({curve:_4},e),t);E4.props=Object.assign(Object.assign({},P0.props),{defaultMarker:"vh"});const S4=(e,t)=>P0(Object.assign({curve:y4},e),t);S4.props=Object.assign(Object.assign({},P0.props),{defaultMarker:"hvh"});var dV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function pV(e,t,n,r,i){const s=ru(n,t),l=vp(s),u=l+Math.PI/2,h=[r/2*Math.cos(u),r/2*Math.sin(u)],p=[i/2*Math.cos(u),i/2*Math.sin(u)],m=[i/2*Math.cos(l),i/2*Math.sin(l)],y=[r/2*Math.cos(l),r/2*Math.sin(l)],b=k_(t,h),w=k_(n,p),R=k_(w,m),P=k_(n,m),I=ru(P,p),N=ru(n,p),z=ru(t,h),Z=ru(z,y),Y=ru(t,y),$=ru(b,y);e.moveTo(...b),e.lineTo(...w),e.arcTo(...R,...P,i/2),e.arcTo(...I,...N,i/2),e.lineTo(...z),e.arcTo(...Z,...Y,r/2),e.arcTo(...$,...b,r/2),e.closePath()}const T4=(e,t)=>{const{document:n}=t;return(r,i,s)=>{const{seriesSize:l,color:u}=i,{color:h}=s,p=dV(s,["color"]),m=Ee();for(let y=0;y<r.length-1;y++){const b=r[y],w=r[y+1],R=l[y],P=l[y+1];[...b,...w].every(ec)&&pV(m,b,w,R,P)}return Ra(n.createElement("path",{})).call(ea,p).style("fill",u||h).style("d",m.toString()).call(ea,e).node()}};T4.props=Object.assign(Object.assign({},P0.props),{defaultMarker:"line"});const w4=()=>(e,t)=>{const{style:n={},encode:r}=t,{series:i}=r,{gradient:s}=n;return!s||i?[e,t]:[e,ri({},t,{encode:{series:dT(iy(e,void 0))}})]};w4.props={};const f3=()=>(e,t)=>{const{encode:n}=t,{series:r,color:i}=n;if(r!==void 0||i===void 0)return[e,t];const[s,l]=tl(n,"color");return[e,ri({},t,{encode:{series:yc(s,l)}})]};f3.props={};const A4={line:o4,smooth:g4,hv:x4,vh:E4,hvh:S4,trail:T4},mV=(e,t,n,r)=>{var i,s;const{series:l,x:u,y:h}=n,{x:p,y:m}=t;if(u===void 0||h===void 0)throw new Error("Missing encode for x or y channel.");const y=l?Array.from(Rc(e,I=>l[I]).values()):[e],b=y.map(I=>I[0]).filter(I=>I!==void 0),w=(((i=p==null?void 0:p.getBandWidth)===null||i===void 0?void 0:i.call(p))||0)/2,R=(((s=m==null?void 0:m.getBandWidth)===null||s===void 0?void 0:s.call(m))||0)/2,P=Array.from(y,I=>I.map(N=>r.map([+u[N]+w,+h[N]+R])));return[b,P,y]},vV=(e,t,n,r)=>{const i=Object.entries(n).filter(([l])=>l.startsWith("position")).map(([,l])=>l);if(i.length===0)throw new Error("Missing encode for position channel.");const s=Array.from(e,l=>{const u=i.map(m=>+m[l]),h=r.map(u),p=[];for(let m=0;m<h.length;m+=2)p.push([h[m],h[m+1]]);return p});return[e,s]},C4=()=>(e,t,n,r)=>(Zy(r)?vV:mV)(e,t,n,r);C4.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:A4,channels:[...Fd({shapes:Object.keys(A4)}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...Xu(),{type:w4},{type:f3}],postInference:[...pf(),...tb(),...lV()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};var gV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const h3=(e,t,n)=>[["M",e-n,t],["A",n,n,0,1,0,e+n,t],["A",n,n,0,1,0,e-n,t],["Z"]];h3.style=["fill"];const O4=h3.bind(void 0);O4.style=["stroke","lineWidth"];const bT=(e,t,n)=>[["M",e-n,t-n],["L",e+n,t-n],["L",e+n,t+n],["L",e-n,t+n],["Z"]];bT.style=["fill"];const R4=bT.bind(void 0);R4.style=["fill"];const M4=bT.bind(void 0);M4.style=["stroke","lineWidth"];const p3=(e,t,n)=>{const r=n*.618;return[["M",e-r,t],["L",e,t-n],["L",e+r,t],["L",e,t+n],["Z"]]};p3.style=["fill"];const P4=p3.bind(void 0);P4.style=["stroke","lineWidth"];const m3=(e,t,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t+r],["L",e,t-r],["L",e+n,t+r],["Z"]]};m3.style=["fill"];const I4=m3.bind(void 0);I4.style=["stroke","lineWidth"];const v3=(e,t,n)=>{const r=n*Math.sin(.3333333333333333*Math.PI);return[["M",e-n,t-r],["L",e+n,t-r],["L",e,t+r],["Z"]]};v3.style=["fill"];const L4=v3.bind(void 0);L4.style=["stroke","lineWidth"];const g3=(e,t,n)=>{const r=n/2*Math.sqrt(3);return[["M",e,t-n],["L",e+r,t-n/2],["L",e+r,t+n/2],["L",e,t+n],["L",e-r,t+n/2],["L",e-r,t-n/2],["Z"]]};g3.style=["fill"];const D4=g3.bind(void 0);D4.style=["stroke","lineWidth"];const y3=(e,t,n)=>{const r=n-1.5;return[["M",e-n,t-r],["L",e+n,t+r],["L",e+n,t-r],["L",e-n,t+r],["Z"]]};y3.style=["fill"];const N4=y3.bind(void 0);N4.style=["stroke","lineWidth"];const B4=(e,t,n)=>[["M",e,t+n],["L",e,t-n]];B4.style=["stroke","lineWidth"];const F4=(e,t,n)=>[["M",e-n,t-n],["L",e+n,t+n],["M",e+n,t-n],["L",e-n,t+n]];F4.style=["stroke","lineWidth"];const k4=(e,t,n)=>[["M",e-n/2,t-n],["L",e+n/2,t-n],["M",e,t-n],["L",e,t+n],["M",e-n/2,t+n],["L",e+n/2,t+n]];k4.style=["stroke","lineWidth"];const z4=(e,t,n)=>[["M",e-n,t],["L",e+n,t],["M",e,t-n],["L",e,t+n]];z4.style=["stroke","lineWidth"];const U4=(e,t,n)=>[["M",e-n,t],["L",e+n,t]];U4.style=["stroke","lineWidth"];const _3=(e,t,n)=>[["M",e-n,t],["L",e+n,t]];_3.style=["stroke","lineWidth"];const j4=_3.bind(void 0);j4.style=["stroke","lineWidth"];const V4=(e,t,n)=>[["M",e-n,t],["A",n/2,n/2,0,1,1,e,t],["A",n/2,n/2,0,1,0,e+n,t]];V4.style=["stroke","lineWidth"];const H4=(e,t,n)=>[["M",e-n-1,t-2.5],["L",e,t-2.5],["L",e,t+2.5],["L",e+n+1,t+2.5]];H4.style=["stroke","lineWidth"];const Z4=(e,t,n)=>[["M",e-n-1,t+2.5],["L",e,t+2.5],["L",e,t-2.5],["L",e+n+1,t-2.5]];Z4.style=["stroke","lineWidth"];const W4=(e,t,n)=>[["M",e-(n+1),t+2.5],["L",e-n/2,t+2.5],["L",e-n/2,t-2.5],["L",e+n/2,t-2.5],["L",e+n/2,t+2.5],["L",e+n+1,t+2.5]];W4.style=["stroke","lineWidth"];const G4=(e,t,n)=>[["M",e-5,t+2.5],["L",e-5,t],["L",e,t],["L",e,t-3],["L",e,t+3],["L",e+6.5,t+3]];G4.style=["stroke","lineWidth"];const rb=new Map([["bowtie",y3],["cross",F4],["dash",j4],["diamond",p3],["dot",_3],["hexagon",g3],["hollowBowtie",N4],["hollowDiamond",P4],["hollowHexagon",D4],["hollowPoint",O4],["hollowSquare",M4],["hollowTriangle",I4],["hollowTriangleDown",L4],["hv",H4],["hvh",W4],["hyphen",U4],["line",B4],["plus",z4],["point",h3],["rect",R4],["smooth",V4],["square",bT],["tick",k4],["triangleDown",v3],["triangle",m3],["vh",Z4],["vhv",G4]]);function yV(e,t){var{d:n,fill:r,lineWidth:i,path:s,stroke:l,color:u}=t,h=gV(t,["d","fill","lineWidth","path","stroke","color"]);const p=rb.get(e)||rb.get("point");return(...m)=>new Mo({style:Object.assign(Object.assign({},h),{d:p(...m),stroke:p.style.includes("stroke")?u||l:"",fill:p.style.includes("fill")?u||r:"",lineWidth:p.style.includes("lineWidth")?i||i||2:0})})}function Pte(e,t){rb.set(e,t)}function Ite(e){rb.delete(e)}var _V=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function X4(e,t,n,r){if(t.length===1)return;const{size:i}=n;if(e==="fixed")return i;if(e==="normal"||AE(r)){const[[s,l],[u,h]]=t,p=Math.abs((u-s)/2),m=Math.abs((h-l)/2);return Math.max(0,(p+m)/2)}return i}const Gs=(e,t)=>{const{colorAttribute:n,symbol:r,mode:i="auto"}=e,s=_V(e,["colorAttribute","symbol","mode"]),l=rb.get(r)||rb.get("point"),{coordinate:u,document:h}=t;return(p,m,y)=>{const{lineWidth:b,color:w}=y,R=s.stroke?b||1:b,{color:P=w,transform:I,opacity:N}=m,[z,Z]=Ex(p),$=X4(i,p,m,u)||s.r||y.r;return Ra(h.createElement("path",{})).call(ea,y).style("fill","transparent").style("d",l(z,Z,$)).style("lineWidth",R).style("transform",I).style("transformOrigin",`${z-$} ${Z-$}`).style("stroke",P).style(U_(e),N).style(n,P).call(ea,s).node()}};Gs.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const Y4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"point"},e),t);Y4.props=Object.assign({defaultMarker:"hollowPoint"},Gs.props);const $4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"diamond"},e),t);$4.props=Object.assign({defaultMarker:"hollowDiamond"},Gs.props);const K4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},e),t);K4.props=Object.assign({defaultMarker:"hollowHexagon"},Gs.props);const q4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"square"},e),t);q4.props=Object.assign({defaultMarker:"hollowSquare"},Gs.props);const Q4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},e),t);Q4.props=Object.assign({defaultMarker:"hollowTriangleDown"},Gs.props);const J4=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"triangle"},e),t);J4.props=Object.assign({defaultMarker:"hollowTriangle"},Gs.props);const eL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},e),t);eL.props=Object.assign({defaultMarker:"hollowBowtie"},Gs.props);var bV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const tL=(e,t)=>{const{colorAttribute:n,mode:r="auto"}=e,i=bV(e,["colorAttribute","mode"]),{coordinate:s,document:l}=t;return(u,h,p)=>{const{lineWidth:m,color:y}=p,b=i.stroke?m||1:m,{color:w=y,transform:R,opacity:P}=h,[I,N]=Ex(u),Z=X4(r,u,h,s)||i.r||p.r;return Ra(l.createElement("circle",{})).call(ea,p).style("fill","transparent").style("cx",I).style("cy",N).style("r",Z).style("lineWidth",b).style("transform",R).style("transformOrigin",`${I} ${N}`).style("stroke",w).style(U_(e),P).style(n,w).call(ea,i).node()}},b3=(e,t)=>tL(Object.assign({colorAttribute:"fill"},e),t);b3.props={defaultMarker:"circle",defaultEnterAnimation:"fadeIn",defaultExitAnimation:"fadeOut"};const nL=(e,t)=>tL(Object.assign({colorAttribute:"stroke"},e),t);nL.props=Object.assign({defaultMarker:"hollowPoint"},b3.props);const rL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"point"},e),t);rL.props=Object.assign({defaultMarker:"point"},Gs.props);const iL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"plus"},e),t);iL.props=Object.assign({defaultMarker:"plus"},Gs.props);const oL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"diamond"},e),t);oL.props=Object.assign({defaultMarker:"diamond"},Gs.props);const aL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"square"},e),t);aL.props=Object.assign({defaultMarker:"square"},Gs.props);const sL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"triangle"},e),t);sL.props=Object.assign({defaultMarker:"triangle"},Gs.props);const lL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"hexagon"},e),t);lL.props=Object.assign({defaultMarker:"hexagon"},Gs.props);const cL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"cross"},e),t);cL.props=Object.assign({defaultMarker:"cross"},Gs.props);const uL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"bowtie"},e),t);uL.props=Object.assign({defaultMarker:"bowtie"},Gs.props);const fL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},e),t);fL.props=Object.assign({defaultMarker:"hyphen"},Gs.props);const hL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"line"},e),t);hL.props=Object.assign({defaultMarker:"line"},Gs.props);const dL=(e,t)=>Gs(Object.assign({colorAttribute:"stroke",symbol:"tick"},e),t);dL.props=Object.assign({defaultMarker:"tick"},Gs.props);const pL=(e,t)=>Gs(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},e),t);pL.props=Object.assign({defaultMarker:"triangleDown"},Gs.props);const xT=()=>(e,t)=>{const{encode:n}=t,{y:r}=n;return r!==void 0?[e,t]:[e,ri({},t,{encode:{y:hT(iy(e,0))},scale:{y:{guide:null}}})]};xT.props={};const mL=()=>(e,t)=>{const{encode:n}=t,{size:r}=n;return r!==void 0?[e,t]:[e,ri({},t,{encode:{size:dT(iy(e,3))}})]};mL.props={};const vL={hollow:Y4,hollowDiamond:$4,hollowHexagon:K4,hollowSquare:q4,hollowTriangleDown:Q4,hollowTriangle:J4,hollowBowtie:eL,hollowCircle:nL,point:rL,plus:iL,diamond:oL,square:aL,triangle:sL,hexagon:lL,cross:cL,bowtie:uL,hyphen:fL,line:hL,tick:dL,triangleDown:pL,circle:b3},gL=e=>(t,n,r,i)=>{const{x:s,y:l,x1:u,y1:h,size:p,dx:m,dy:y}=r,[b,w]=i.getSize(),R=y1(n,r,e),P=N=>{const z=+((m==null?void 0:m[N])||0),Z=+((y==null?void 0:y[N])||0),Y=u?(+s[N]+ +u[N])/2:+s[N],$=h?(+l[N]+ +h[N])/2:+l[N],J=Y+z,ae=$+Z;return[J,ae]},I=p?Array.from(t,N=>{const[z,Z]=P(N),Y=+p[N],$=Y/b,J=Y/w,ae=[z-$,Z-J],pe=[z+$,Z+J];return[i.map(R(ae,N)),i.map(R(pe,N))]}):Array.from(t,N=>[i.map(R(P(N),N))]);return[t,I]};gL.props={defaultShape:"hollow",defaultLabelShape:"label",composite:!1,shape:vL,channels:[...Fd({shapes:Object.keys(vL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",quantitative:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...Xu(),{type:v1},{type:xT}],postInference:[...pf(),{type:mL},...oy()]};const yL=(e,t)=>{const{coordinate:n}=t;return(r,i,s)=>{const{color:l,text:u="",fontSize:h,rotate:p=0,transform:m=""}=i,y={text:String(u),stroke:l,fill:l,fontSize:h},[[b,w]]=r;return Ra(new Wr).style("x",b).style("y",w).call(ea,s).style("transform",`${m}rotate(${+p})`).style("coordCenter",n.getCenter()).call(ea,y).call(ea,e).node()}};yL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var x3=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function xV(e){const t=e/Math.sqrt(2),n=e*Math.sqrt(2),[r,i]=[-t,t-n],[s,l]=[0,0],[u,h]=[t,t-n];return[["M",r,i],["A",e,e,0,1,1,u,h],["L",s,l],["Z"]]}function EV(e){const{min:t,max:n}=e.getLocalBounds();return[(t[0]+n[0])*.5,(t[1]+n[1])*.5]}const SV=Rr(e=>{const t=e.attributes,{class:n,x:r,y:i,transform:s}=t,l=x3(t,["class","x","y","transform"]),u=uo(l,"marker"),{size:h=24}=u,p=()=>xV(h/2),m=Ra(e).maybeAppend("marker",()=>new yl({})).call(w=>w.node().update(Object.assign({symbol:p},u))).node(),[y,b]=EV(m);Ra(e).maybeAppend("text","text").style("x",y).style("y",b).call(ea,l)}),_L=(e,t)=>{const n=x3(e,[]);return(r,i,s)=>{const{color:l}=s,u=x3(s,["color"]),{color:h=l,text:p=""}=i,m={text:String(p),stroke:h,fill:h},[[y,b]]=r;return Ra(new SV).call(ea,u).style("transform",`translate(${y},${b})`).call(ea,m).call(ea,n).node()}};_L.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const bL=(e,t)=>{const{coordinate:n}=t;return(r,i,s)=>{const{color:l,text:u="",fontSize:h,rotate:p=0,transform:m=""}=i,y={text:String(u),stroke:l,fill:l,fontSize:h,textAlign:"center",textBaseline:"middle"},[[b,w]]=r;return Ra(new Oa).style("x",b).style("y",w).call(ea,s).style("transformOrigin","center center").style("transform",`${m}rotate(${p}deg)`).style("coordCenter",n.getCenter()).call(ea,y).call(ea,e).node()}};bL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const ET=()=>(e,t)=>{const{data:n}=t;if(!Array.isArray(n)||n.some(zx))return[e,t];const r=Array.isArray(n[0])?n:[n],i=r.map(l=>l[0]),s=r.map(l=>l[1]);return[e,ri({},t,{encode:{x:yc(i),y:yc(s)}})]};ET.props={};var xL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const ST=()=>(e,t)=>{const{data:n,style:r={}}=t,i=xL(t,["data","style"]),{x:s,y:l}=r,u=xL(r,["x","y"]);if(s==null||l==null)return[e,t];const h=s||0,p=l||0;return[[0],ri({},i,{data:[0],cartesian:!0,encode:{x:yc([h]),y:yc([p])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:u})]};ST.props={};const EL={text:yL,badge:_L,tag:bL},SL=e=>{const{cartesian:t=!1}=e;return t?r3:(n,r,i,s)=>{const{x:l,y:u}=i,h=y1(r,i,e),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};SL.props={defaultShape:"text",defaultLabelShape:"label",composite:!1,shape:EL,channels:[...Fd({shapes:Object.keys(EL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize",scale:"identity"},{name:"rotate",scale:"identity"}],preInference:[...Xu(),{type:ET},{type:ST}],postInference:[...pf(),...oy()]};const E3=()=>(e,t)=>[e,ri({scale:{x:{padding:0},y:{padding:0}}},t)];E3.props={};const TL={cell:g1,hollow:pT},wL=()=>(e,t,n,r)=>{const{x:i,y:s}=n,l=t.x,u=t.y,h=Array.from(e,p=>{const m=l.getBandWidth(l.invert(+i[p])),y=u.getBandWidth(u.invert(+s[p])),b=+i[p],w=+s[p],R=[b,w],P=[b+m,w],I=[b+m,w+y],N=[b,w+y];return[R,P,I,N].map(z=>r.map(z))});return[e,h]};wL.props={defaultShape:"cell",defaultLabelShape:"label",shape:TL,composite:!1,channels:[...Fd({shapes:Object.keys(TL)}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...Xu(),{type:v1},{type:xT},{type:E3}],postInference:[...pf(),...oy()]};function S3(e,t,n){var r=null,i=o(!0),s=null,l=v,u=null,h=Lt(p);e=typeof e=="function"?e:e===void 0?an:o(+e),t=typeof t=="function"?t:o(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Pn:o(+n);function p(y){var b,w,R,P=(y=a(y)).length,I,N=!1,z,Z=new Array(P),Y=new Array(P);for(s==null&&(u=l(z=h())),b=0;b<=P;++b){if(!(b<P&&i(I=y[b],b,y))===N)if(N=!N)w=b,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),R=b-1;R>=w;--R)u.point(Z[R],Y[R]);u.lineEnd(),u.areaEnd()}N&&(Z[b]=+e(I,b,y),Y[b]=+t(I,b,y),u.point(r?+r(I,b,y):Z[b],n?+n(I,b,y):Y[b]))}if(z)return u=null,z+""||null}function m(){return sr().defined(i).curve(l).context(s)}return p.x=function(y){return arguments.length?(e=typeof y=="function"?y:o(+y),r=null,p):e},p.x0=function(y){return arguments.length?(e=typeof y=="function"?y:o(+y),p):e},p.x1=function(y){return arguments.length?(r=y==null?null:typeof y=="function"?y:o(+y),p):r},p.y=function(y){return arguments.length?(t=typeof y=="function"?y:o(+y),n=null,p):t},p.y0=function(y){return arguments.length?(t=typeof y=="function"?y:o(+y),p):t},p.y1=function(y){return arguments.length?(n=y==null?null:typeof y=="function"?y:o(+y),p):n},p.lineX0=p.lineY0=function(){return m().x(e).y(t)},p.lineY1=function(){return m().x(e).y(n)},p.lineX1=function(){return m().x(r).y(t)},p.defined=function(y){return arguments.length?(i=typeof y=="function"?y:o(!!y),p):i},p.curve=function(y){return arguments.length?(l=y,s!=null&&(u=l(s)),p):l},p.context=function(y){return arguments.length?(y==null?s=u=null:u=l(s=y),p):s},p}function TV(){var e=S3().curve(n4),t=e.curve,n=e.lineX0,r=e.lineX1,i=e.lineY0,s=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return Vx(n())},delete e.lineX0,e.lineEndAngle=function(){return Vx(r())},delete e.lineX1,e.lineInnerRadius=function(){return Vx(i())},delete e.lineY0,e.lineOuterRadius=function(){return Vx(s())},delete e.lineY1,e.curve=function(l){return arguments.length?t(a3(l)):t()._curve},e}var wV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function AV(e,t){const n=[],r=[],i=[];let s=!1,l=null;const u=e.length/2;for(let h=0;h<u;h++){const p=e[h],m=e[h+u];if([...p,...m].some(y=>!t(y)))s=!0;else{if(n.push(p),r.push(m),s&&l){s=!1;const[y,b]=l;i.push([y,p,b,m])}l=[p,m]}}return[n.concat(r),i]}const AL=Rr(e=>{const{areaPath:t,connectPath:n,areaStyle:r,connectStyle:i}=e.attributes,s=e.ownerDocument;Ra(e).maybeAppend("connect-path",()=>s.createElement("path",{})).style("d",n).call(ea,i),Ra(e).maybeAppend("area-path",()=>s.createElement("path",{})).style("d",t).call(ea,r)}),cm=(e,t)=>{const{curve:n,gradient:r=!1,defined:i=p=>!Number.isNaN(p)&&p!==void 0&&p!==null,connect:s=!1}=e,l=wV(e,["curve","gradient","defined","connect"]),{coordinate:u,document:h}=t;return(p,m,y)=>{const{color:b}=y,{color:w=b,seriesColor:R,seriesX:P,seriesY:I}=m,N=pc(u),z=NS(u,m),Z=r&&R?DS(R,P,I,r,void 0,N):w,Y=Object.assign(Object.assign(Object.assign(Object.assign({},y),{stroke:Z,fill:Z}),z&&{transform:z}),l),[$,J]=AV(p,i),ae=uo(Y,"connect"),pe=!!J.length,Oe=Ve=>Ra(h.createElement("path",{})).style("d",Ve||"").call(ea,Y).node();if(Nl(u)){const Ve=Ke=>{const lt=u.getCenter(),Ge=Ke.slice(0,Ke.length/2),rt=Ke.slice(Ke.length/2);return TV().angle((st,ut)=>Yg(ru(Ge[ut],lt))).outerRadius((st,ut)=>Ic(Ge[ut],lt)).innerRadius((st,ut)=>Ic(rt[ut],lt)).defined((st,ut)=>[...Ge[ut],...rt[ut]].every(i)).curve(n)(rt)};return!pe||s&&!Object.keys(ae).length?Oe(Ve($)):pe&&!s?Oe(Ve(p)):Ra(new AL).style("areaStyle",Y).style("connectStyle",Object.assign(Object.assign({},ae),l)).style("areaPath",Ve(p)).style("connectPath",J.map(Ve).join("")).node()}else{const Ve=Ke=>{const lt=Ke.slice(0,Ke.length/2),Ge=Ke.slice(Ke.length/2);return N?S3().y((rt,st)=>lt[st][1]).x1((rt,st)=>lt[st][0]).x0((rt,st)=>Ge[st][0]).defined((rt,st)=>[...lt[st],...Ge[st]].every(i)).curve(n)(lt):S3().x((rt,st)=>lt[st][0]).y1((rt,st)=>lt[st][1]).y0((rt,st)=>Ge[st][1]).defined((rt,st)=>[...lt[st],...Ge[st]].every(i)).curve(n)(lt)};return!pe||s&&!Object.keys(ae).length?Oe(Ve($)):pe&&!s?Oe(Ve(p)):Ra(new AL).style("areaStyle",Y).style("connectStyle",Object.assign(Object.assign({},ae),l)).style("areaPath",Ve(p)).style("connectPath",J.map(Ve).join("")).node()}}};cm.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const CL=(e,t)=>{const{coordinate:n}=t;return(...r)=>{const i=Nl(n)?e3:v;return cm(Object.assign({curve:i},e),t)(...r)}};CL.props=Object.assign(Object.assign({},cm.props),{defaultMarker:"square"});var CV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const OL=(e,t)=>{const n=CV(e,[]),{coordinate:r}=t;return(...i)=>{const s=Nl(r)?c4:pc(r)?v4:m4;return cm(Object.assign({curve:s},n),t)(...i)}};OL.props=Object.assign(Object.assign({},cm.props),{defaultMarker:"smooth"});const RL=(e,t)=>(...n)=>cm(Object.assign({curve:y4},e),t)(...n);RL.props=Object.assign(Object.assign({},cm.props),{defaultMarker:"hvh"});const ML=(e,t)=>(...n)=>cm(Object.assign({curve:_4},e),t)(...n);ML.props=Object.assign(Object.assign({},cm.props),{defaultMarker:"vh"});const PL=(e,t)=>(...n)=>cm(Object.assign({curve:b4},e),t)(...n);PL.props=Object.assign(Object.assign({},cm.props),{defaultMarker:"hv"});const IL={area:CL,smooth:OL,hvh:RL,vh:ML,hv:PL},LL=()=>(e,t,n,r)=>{var i,s;const{x:l,y:u,y1:h,series:p}=n,{x:m,y}=t,b=p?Array.from(Rc(e,N=>p[N]).values()):[e],w=b.map(N=>N[0]).filter(N=>N!==void 0),R=(((i=m==null?void 0:m.getBandWidth)===null||i===void 0?void 0:i.call(m))||0)/2,P=(((s=y==null?void 0:y.getBandWidth)===null||s===void 0?void 0:s.call(y))||0)/2,I=Array.from(b,N=>{const z=N.length,Z=new Array(z*2);for(let Y=0;Y<N.length;Y++){const $=N[Y];Z[Y]=r.map([+l[$]+R,+u[$]+P]),Z[z+Y]=r.map([+l[$]+R,+h[$]+P])}return Z});return[w,I,b]};LL.props={defaultShape:"area",defaultLabelShape:"label",composite:!1,shape:IL,channels:[...Fd({shapes:Object.keys(IL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"band"}],preInference:[...Xu(),{type:f3},{type:Ux},{type:E3}],postInference:[...pf(),...tb()],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const DL=()=>(e,t)=>{const{encode:n}=t,{y1:r}=n;if(r)return[e,t];const[i]=tl(n,"y");return[e,ri({},t,{encode:{y1:yc([...i])}})]};DL.props={};const NL=()=>(e,t)=>{const{encode:n}=t,{x1:r}=n;if(r)return[e,t];const[i]=tl(n,"x");return[e,ri({},t,{encode:{x1:yc([...i])}})]};NL.props={};var BL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const T3=(e,t)=>{const{arrow:n=!0,arrowSize:r="40%"}=e,i=BL(e,["arrow","arrowSize"]),{document:s}=t;return(l,u,h)=>{const{defaultColor:p}=h,m=BL(h,["defaultColor"]),{color:y=p,transform:b}=u,[w,R]=l,P=Ee();if(P.moveTo(...w),P.lineTo(...R),n){const[I,N]=pO(w,R,{arrowSize:r});P.moveTo(...I),P.lineTo(...R),P.lineTo(...N)}return Ra(s.createElement("path",{})).call(ea,m).style("d",P.toString()).style("stroke",y).style("transform",b).call(ea,i).node()}};T3.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const FL=(e,t)=>{const{arrow:n=!1}=e;return(...r)=>T3(Object.assign(Object.assign({},e),{arrow:n}),t)(...r)};FL.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var kL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const zL=(e,t)=>{const n=kL(e,[]),{coordinate:r,document:i}=t;return(s,l,u)=>{const{color:h}=u,p=kL(u,["color"]),{color:m=h,transform:y}=l,[b,w]=s,R=Ee();if(R.moveTo(b[0],b[1]),Nl(r)){const P=r.getCenter();R.quadraticCurveTo(P[0],P[1],w[0],w[1])}else{const P=LS(b,w),I=Ic(b,w)/2;a1(R,b,w,P,I)}return Ra(i.createElement("path",{})).call(ea,p).style("d",R.toString()).style("stroke",m).style("transform",y).call(ea,n).node()}};zL.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var UL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const jL=(e,t)=>{const n=UL(e,[]),{document:r}=t;return(i,s,l)=>{const{color:u}=l,h=UL(l,["color"]),{color:p=u,transform:m}=s,[y,b]=i,w=Ee();return w.moveTo(y[0],y[1]),w.bezierCurveTo(y[0]/2+b[0]/2,y[1],y[0]/2+b[0]/2,b[1],b[0],b[1]),Ra(r.createElement("path",{})).call(ea,h).style("d",w.toString()).style("stroke",p).style("transform",m).call(ea,n).node()}};jL.props={defaultMarker:"smooth",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var VL=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function OV(e,t,n,r){const i=Ee();if(Nl(n)){const s=n.getCenter(),l=Ic(e,s),h=(Ic(t,s)-l)*r+l;return i.moveTo(e[0],e[1]),a1(i,e,t,s,h),i.lineTo(t[0],t[1]),i}return pc(n)?(i.moveTo(e[0],e[1]),i.lineTo(e[0]+(t[0]-e[0])*r,e[1]),i.lineTo(e[0]+(t[0]-e[0])*r,t[1]),i.lineTo(t[0],t[1]),i):(i.moveTo(e[0],e[1]),i.lineTo(e[0],e[1]+(t[1]-e[1])*r),i.lineTo(t[0],e[1]+(t[1]-e[1])*r),i.lineTo(t[0],t[1]),i)}const HL=(e,t)=>{const{cornerRatio:n=1/3}=e,r=VL(e,["cornerRatio"]),{coordinate:i,document:s}=t;return(l,u,h)=>{const{defaultColor:p}=h,m=VL(h,["defaultColor"]),{color:y=p,transform:b}=u,[w,R]=l,P=OV(w,R,i,n);return Ra(s.createElement("path",{})).call(ea,m).style("d",P.toString()).style("stroke",y).style("transform",b).call(ea,r).node()}};HL.props={defaultMarker:"vhv",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const ZL={link:FL,arc:zL,smooth:jL,vhv:HL},w3=e=>(t,n,r,i)=>{const{x:s,y:l,x1:u=s,y1:h=l}=r,p=y1(n,r,e),m=t.map(y=>[i.map(p([+s[y],+l[y]],y)),i.map(p([+u[y],+h[y]],y))]);return[t,m]};w3.props={defaultShape:"link",defaultLabelShape:"label",composite:!1,shape:ZL,channels:[...Fd({shapes:Object.keys(ZL)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Xu(),{type:DL},{type:NL}],postInference:[...pf(),...oy()]};var RV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const WL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u}=l,h=RV(l,["color"]),{color:p=u,src:m="",size:y=32,transform:b=""}=s;let{width:w=y,height:R=y}=e;const[[P,I]]=i,[N,z]=n.getSize();w=typeof w=="string"?gT(w)*N:w,R=typeof R=="string"?gT(R)*z:R;const Z=P-Number(w)/2,Y=I-Number(R)/2;return Ra(r.createElement("image",{})).call(ea,h).style("x",Z).style("y",Y).style("src",m).style("stroke",p).style("transform",b).call(ea,e).style("width",w).style("height",R).node()}};WL.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const GL={image:WL},XL=e=>{const{cartesian:t}=e;return t?r3:(n,r,i,s)=>{const{x:l,y:u}=i,h=y1(r,i,e),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};XL.props={defaultShape:"image",defaultLabelShape:"label",composite:!1,shape:GL,channels:[...Fd({shapes:Object.keys(GL)}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[...Xu(),{type:ET},{type:ST}],postInference:[...pf(),...oy()]};var MV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function PV(e,t){const n=Ee();if(Nl(t)){const r=t.getCenter(),i=[...e,e[0]],s=i.map(l=>Ic(l,r));return i.forEach((l,u)=>{if(u===0){n.moveTo(l[0],l[1]);return}const h=s[u],p=e[u-1],m=s[u-1];m!==void 0&&Math.abs(h-m)<1e-10?a1(n,p,l,r,h):n.lineTo(l[0],l[1])}),n.closePath(),n}return dO(n,e)}const YL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u}=l,h=MV(l,["color"]),{color:p=u,transform:m}=s,y=PV(i,n);return Ra(r.createElement("path",{})).call(ea,h).style("d",y.toString()).style("stroke",p).style("fill",p).style("transform",m).call(ea,e).node()}};YL.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var $L=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function IV(e,t){const[n,r,i,s]=e,l=Ee();if(Nl(t)){const u=t.getCenter(),h=Ic(u,n);return l.moveTo(n[0],n[1]),l.quadraticCurveTo(u[0],u[1],i[0],i[1]),a1(l,i,s,u,h),l.quadraticCurveTo(u[0],u[1],r[0],r[1]),a1(l,r,n,u,h),l.closePath(),l}return l.moveTo(n[0],n[1]),l.bezierCurveTo(n[0]/2+i[0]/2,n[1],n[0]/2+i[0]/2,i[1],i[0],i[1]),l.lineTo(s[0],s[1]),l.bezierCurveTo(s[0]/2+r[0]/2,s[1],s[0]/2+r[0]/2,r[1],r[0],r[1]),l.lineTo(n[0],n[1]),l.closePath(),l}const KL=(e,t)=>{const n=$L(e,[]),{coordinate:r,document:i}=t;return(s,l,u)=>{const{color:h}=u,p=$L(u,["color"]),{color:m=h,transform:y}=l,b=IV(s,r);return Ra(i.createElement("path",{})).call(ea,p).style("d",b.toString()).style("fill",m||h).style("stroke",m||h).style("transform",y).call(ea,n).node()}};KL.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const qL={polygon:YL,ribbon:KL},QL=()=>(e,t,n,r)=>{const i=Object.entries(n).filter(([u])=>u.startsWith("x")).map(([,u])=>u),s=Object.entries(n).filter(([u])=>u.startsWith("y")).map(([,u])=>u),l=e.map(u=>{const h=[];for(let p=0;p<i.length;p++){const m=i[p][u];if(m===void 0)break;const y=s[p][u];h.push(r.map([+m,+y]))}return h});return[e,l]};QL.props={defaultShape:"polygon",defaultLabelShape:"label",composite:!1,shape:qL,channels:[...Fd({shapes:Object.keys(qL)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Xu()],postInference:[...pf(),...oy()]};var LV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function DV(e,t){const n=Ee();if(!Nl(t))n.moveTo(...e[0]),n.lineTo(...e[1]),n.moveTo(...e[2]),n.lineTo(...e[3]),n.moveTo(...e[4]),n.lineTo(...e[5]),n.lineTo(...e[6]),n.lineTo(...e[7]),n.closePath(),n.moveTo(...e[8]),n.lineTo(...e[9]),n.moveTo(...e[10]),n.lineTo(...e[11]),n.moveTo(...e[12]),n.lineTo(...e[13]);else{const r=t.getCenter(),[i,s]=r,l=vp(ru(e[0],r)),u=vp(ru(e[1],r)),h=Ic(r,e[2]),p=Ic(r,e[3]),m=Ic(r,e[8]),y=Ic(r,e[10]),b=Ic(r,e[11]);n.moveTo(...e[0]),n.arc(i,s,h,l,u),n.arc(i,s,h,u,l,!0),n.moveTo(...e[2]),n.lineTo(...e[3]),n.moveTo(...e[4]),n.arc(i,s,p,l,u),n.lineTo(...e[6]),n.arc(i,s,y,u,l,!0),n.closePath(),n.moveTo(...e[8]),n.arc(i,s,m,l,u),n.arc(i,s,m,u,l,!0),n.moveTo(...e[10]),n.lineTo(...e[11]),n.moveTo(...e[12]),n.arc(i,s,b,l,u),n.arc(i,s,b,u,l,!0)}return n}const JL=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u,transform:h}=s,{color:p,fill:m=p,stroke:y=p}=l,b=LV(l,["color","fill","stroke"]),w=DV(i,n);return Ra(r.createElement("path",{})).call(ea,b).style("d",w.toString()).style("stroke",y).style("fill",u||m).style("transform",h).call(ea,e).node()}};JL.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var NV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function BV(e,t,n=4){const r=Ee();if(!Nl(t))return r.moveTo(...e[2]),r.lineTo(...e[3]),r.lineTo(e[3][0]-n,e[3][1]),r.lineTo(e[10][0]-n,e[10][1]),r.lineTo(e[10][0]+n,e[10][1]),r.lineTo(e[3][0]+n,e[3][1]),r.lineTo(...e[3]),r.closePath(),r.moveTo(...e[10]),r.lineTo(...e[11]),r.moveTo(e[3][0]+n/2,e[8][1]),r.arc(e[3][0],e[8][1],n/2,0,Math.PI*2),r.closePath(),r;const i=t.getCenter(),[s,l]=i,u=Ic(i,e[3]),h=Ic(i,e[8]),p=Ic(i,e[10]),m=vp(ru(e[2],i)),y=Math.asin(n/h),b=m-y,w=m+y;r.moveTo(...e[2]),r.lineTo(...e[3]),r.moveTo(Math.cos(b)*u+s,Math.sin(b)*u+l),r.arc(s,l,u,b,w),r.lineTo(Math.cos(w)*p+s,Math.sin(w)*p+l),r.arc(s,l,p,w,b,!0),r.lineTo(Math.cos(b)*u+s,Math.sin(b)*u+l),r.closePath(),r.moveTo(...e[10]),r.lineTo(...e[11]);const R=(b+w)/2;return r.moveTo(Math.cos(R)*(h+n/2)+s,Math.sin(R)*(h+n/2)+l),r.arc(Math.cos(R)*h+s,Math.sin(R)*h+l,n/2,R,Math.PI*2+R),r.closePath(),r}const e6=(e,t)=>{const{coordinate:n,document:r}=t;return(i,s,l)=>{const{color:u,transform:h}=s,p=4,{color:m,fill:y=m,stroke:b=m}=l,w=NV(l,["color","fill","stroke"]),R=BV(i,n,p);return Ra(r.createElement("path",{})).call(ea,w).style("d",R.toString()).style("stroke",b).style("fill",u||y).style("transform",h).call(ea,e).node()}};e6.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const t6={box:JL,violin:e6},n6=()=>(e,t,n,r)=>{const{x:i,y:s,y1:l,y2:u,y3:h,y4:p,series:m}=n,y=t.x,b=t.series,w=Array.from(e,R=>{const P=y.getBandWidth(y.invert(+i[R])),I=b?b.getBandWidth(b.invert(+(m==null?void 0:m[R]))):1,N=P*I,z=(+(m==null?void 0:m[R])||0)*P,Z=+i[R]+z+N/2,[Y,$,J,ae,pe]=[+s[R],+l[R],+u[R],+h[R],+p[R]];return[[Z-N/2,pe],[Z+N/2,pe],[Z,pe],[Z,ae],[Z-N/2,ae],[Z+N/2,ae],[Z+N/2,$],[Z-N/2,$],[Z-N/2,J],[Z+N/2,J],[Z,$],[Z,Y],[Z-N/2,Y],[Z+N/2,Y]].map(Ve=>r.map(Ve))});return[e,w]};n6.props={defaultShape:"box",defaultLabelShape:"label",composite:!1,shape:t6,channels:[...Fd({shapes:Object.keys(t6)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...Xu(),{type:v1}],postInference:[...pf(),...tb()],interaction:{shareTooltip:!0}};const r6={vector:T3},i6=()=>(e,t,n,r)=>{const{x:i,y:s,size:l,rotate:u}=n,[h,p]=r.getSize(),m=e.map(y=>{const b=+u[y]/180*Math.PI,w=+l[y],R=w/h,P=w/p,I=R*Math.cos(b),N=-P*Math.sin(b);return[r.map([+i[y]-I/2,+s[y]-N/2]),r.map([+i[y]+I/2,+s[y]+N/2])]});return[e,m]};i6.props={defaultShape:"vector",defaultLabelShape:"label",composite:!1,shape:r6,channels:[...Fd({shapes:Object.keys(r6)}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[...Xu()],postInference:[...pf(),...oy()]};var o6=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function FV(e,t,n){return e.createElement("path",{style:Object.assign({d:`M ${t},${t} L -${t},0 L ${t},-${t} L 0,0 Z`,transformOrigin:"center"},n)})}function kV(e,t){if(!Nl(t))return sr().x(r=>r[0]).y(r=>r[1])(e);const n=t.getCenter();return HS()({startAngle:0,endAngle:Math.PI*2,outerRadius:Ic(e[0],n),innerRadius:Ic(e[1],n)})}function zV(e,t){if(!Nl(e))return t;const[n,r]=e.getCenter();return`translate(${n}, ${r}) ${t||""}`}const A3=(e,t)=>{const{arrow:n,arrowSize:r=4}=e,i=o6(e,["arrow","arrowSize"]),{coordinate:s,document:l}=t;return(u,h,p)=>{const{color:m,lineWidth:y}=p,b=o6(p,["color","lineWidth"]),{color:w=m,size:R=y}=h,P=n?FV(l,r,Object.assign({fill:i.stroke||w,stroke:i.stroke||w},uo(i,"arrow"))):null,I=kV(u,s),N=zV(s,h.transform);return Ra(l.createElement("path",{})).call(ea,b).style("d",I).style("stroke",w).style("lineWidth",R).style("transform",N).style("markerEnd",P).call(ea,i).node()}};A3.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const a6=()=>(e,t)=>{const{data:n}=t;return!Array.isArray(n)||n.some(zx)?[e,t]:[e,ri({},t,{encode:{x:yc(n)}})]};a6.props={};const s6={line:A3},l6=e=>(t,n,r,i)=>{const{x:s}=r,l=y1(n,r,ri({style:{bandOffset:0}},e)),u=Array.from(t,h=>{const p=[s[h],1],m=[s[h],0];return[p,m].map(y=>i.map(l(y,h)))});return[t,u]};l6.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:s6,channels:[...nb({shapes:Object.keys(s6)}),{name:"x",required:!0}],preInference:[...Xu(),{type:a6}],postInference:[...pf()]};const c6=()=>(e,t)=>{const{data:n}=t;return!Array.isArray(n)||n.some(zx)?[e,t]:[e,ri({},t,{encode:{y:yc(n)}})]};c6.props={};const u6={line:A3},f6=e=>(t,n,r,i)=>{const{y:s}=r,l=y1(n,r,ri({style:{bandOffset:0}},e)),u=Array.from(t,h=>{const p=[0,s[h]],m=[1,s[h]];return[p,m].map(y=>i.map(l(y,h)))});return[t,u]};f6.props={defaultShape:"line",defaultLabelShape:"label",composite:!1,shape:u6,channels:[...nb({shapes:Object.keys(u6)}),{name:"y",required:!0}],preInference:[...Xu(),{type:c6}],postInference:[...pf()]};var h6=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function UV(e,t,n){return[["M",e,t],["L",e+2*n,t-n],["L",e+2*n,t+n],["Z"]]}function jV(e){return sr().x(t=>t[0]).y(t=>t[1])(e)}function VV(e,t,n,r,i=0){const[[s,l],[u,h]]=t;if(pc(e)){const b=s+n,w=u+r,R=b+i;return[[b,l],[R,l],[R,h],[w,h]]}const p=l-n,m=h-r,y=p-i;return[[s,p],[s,y],[u,y],[u,m]]}const d6=(e,t)=>{const{offset:n=0,offset1:r=n,offset2:i=n,connectLength1:s,endMarker:l=!0}=e,u=h6(e,["offset","offset1","offset2","connectLength1","endMarker"]),{coordinate:h}=t;return(p,m,y)=>{const{color:b,connectLength1:w}=y,R=h6(y,["color","connectLength1"]),{color:P,transform:I}=m,N=VV(h,p,r,i,s!=null?s:w),z=uo(Object.assign(Object.assign({},u),y),"endMarker");return Ra(new Mo).call(ea,R).style("d",jV(N)).style("stroke",P||b).style("transform",I).style("markerEnd",l?new yl({className:"marker",style:Object.assign(Object.assign({},z),{symbol:UV})}):null).call(ea,u).node()}};d6.props={defaultMarker:"line",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const p6={connector:d6},m6=(...e)=>w3(...e);m6.props={defaultShape:"connector",defaultLabelShape:"label",composite:!1,shape:p6,channels:[...nb({shapes:Object.keys(p6)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Xu()],postInference:[...pf()]};function v6(e,t,n,r){if(t)return()=>[0,1];const{[e]:i,[`${e}1`]:s}=n;return l=>{var u;const h=((u=r.getBandWidth)===null||u===void 0?void 0:u.call(r,r.invert(+s[l])))||0;return[i[l],s[l]+h]}}function C3(e={}){const{extendX:t=!1,extendY:n=!1}=e;return(r,i,s,l)=>{const u=v6("x",t,s,i.x),h=v6("y",n,s,i.y),p=Array.from(r,m=>{const[y,b]=u(m),[w,R]=h(m);return[[y,w],[b,w],[b,R],[y,R]].map(Z=>l.map(Z))});return[r,p]}}const g6={range:g1},y6=()=>C3();y6.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:g6,channels:[...nb({shapes:Object.keys(g6)}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Xu()],postInference:[...pf()]};const _6=()=>(e,t)=>{const{data:n}=t;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(zx))){const r=(i,s)=>Array.isArray(i[0])?i.map(l=>l[s]):[i[s]];return[e,ri({},t,{encode:{x:yc(r(n,0)),x1:yc(r(n,1))}})]}return[e,t]};_6.props={};const b6={range:g1},x6=()=>C3({extendY:!0});x6.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:b6,channels:[...nb({shapes:Object.keys(b6)}),{name:"x",required:!0}],preInference:[...Xu(),{type:_6}],postInference:[...pf()]};const E6=()=>(e,t)=>{const{data:n}=t;if(Array.isArray(n)&&(n.every(Array.isArray)||!n.some(zx))){const r=(i,s)=>Array.isArray(i[0])?i.map(l=>l[s]):[i[s]];return[e,ri({},t,{encode:{y:yc(r(n,0)),y1:yc(r(n,1))}})]}return[e,t]};E6.props={};const S6={range:g1},T6=()=>C3({extendX:!0});T6.props={defaultShape:"range",defaultLabelShape:"label",composite:!1,shape:S6,channels:[...nb({shapes:Object.keys(S6)}),{name:"y",required:!0}],preInference:[...Xu(),{type:E6}],postInference:[...pf()]};var w6=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const O3=(e,t)=>{const{arrow:n,colorAttribute:r}=e,i=w6(e,["arrow","colorAttribute"]),{coordinate:s,document:l}=t;return(u,h,p)=>{const{color:m,stroke:y}=p,b=w6(p,["color","stroke"]),{d:w,color:R=m}=h,[P,I]=s.getSize();return Ra(l.createElement("path",{})).call(ea,b).style("d",typeof w=="function"?w({width:P,height:I}):w).style(r,R).call(ea,i).node()}};O3.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const A6=(e,t)=>O3(Object.assign({colorAttribute:"fill"},e),t);A6.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const C6=(e,t)=>O3(Object.assign({fill:"none",colorAttribute:"stroke"},e),t);C6.props={defaultMarker:"hvh",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const O6={path:A6,hollow:C6},R6=e=>(t,n,r,i)=>[t,t.map(()=>[[0,0]])];R6.props={defaultShape:"path",defaultLabelShape:"label",shape:O6,composite:!1,channels:[...Fd({shapes:Object.keys(O6)}),{name:"d",scale:"identity"}],preInference:[...Xu()],postInference:[...pf()]};var HV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const M6=(e,t)=>{const{render:n}=e,r=HV(e,["render"]);return i=>{const[[s,l]]=i;return n(Object.assign(Object.assign({},r),{x:s,y:l}),t)}};M6.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const P6=()=>(e,t)=>{const{style:n={}}=t;return[e,ri({},t,{style:Object.assign(Object.assign({},n),Object.fromEntries(Object.entries(n).filter(([,r])=>typeof r=="function").map(([r,i])=>[r,()=>i])))})]};P6.props={};const ZV={shape:M6},I6=e=>{const{cartesian:t}=e;return t?r3:(n,r,i,s)=>{const{x:l,y:u}=i,h=y1(r,i,e),p=Array.from(n,m=>{const y=[+l[m],+u[m]];return[s.map(h(y,m))]});return[n,p]}};I6.props={defaultShape:"shape",defaultLabelShape:"label",composite:!1,shape:ZV,channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Xu(),{type:ET},{type:ST},{type:P6}]};var WV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const L6=(e,t)=>{const{document:n}=t;return(r,i,s)=>{const{transform:l}=i,{color:u}=s,h=WV(s,["color"]),{color:p=u}=i,[m,...y]=r,b=Ee();return b.moveTo(...m),y.forEach(([w,R])=>{b.lineTo(w,R)}),b.closePath(),Ra(n.createElement("path",{})).call(ea,h).style("d",b.toString()).style("stroke",p||u).style("fill",p||u).style("fillOpacity",.4).style("transform",l).call(ea,e).node()}};L6.props={defaultMarker:"square",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const D6={density:L6},N6=()=>(e,t,n,r)=>{const{x:i,series:s}=n,l=Object.entries(n).filter(([y])=>y.startsWith("y")).map(([,y])=>y),u=Object.entries(n).filter(([y])=>y.startsWith("size")).map(([,y])=>y);if(i===void 0||l===void 0||u===void 0)throw new Error("Missing encode for x or y or size channel.");const h=t.x,p=t.series,m=Array.from(e,y=>{const b=h.getBandWidth(h.invert(+i[y])),w=p?p.getBandWidth(p.invert(+(s==null?void 0:s[y]))):1,R=b*w,P=(+(s==null?void 0:s[y])||0)*b,I=+i[y]+P+R/2;return[...l.map((z,Z)=>[I+ +u[Z][y]/e.length,+l[Z][y]]),...l.map((z,Z)=>[I-+u[Z][y]/e.length,+l[Z][y]]).reverse()].map(z=>r.map(z))});return[e,m]};N6.props={defaultShape:"density",defaultLabelShape:"label",composite:!1,shape:D6,channels:[...Fd({shapes:Object.keys(D6)}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"series",scale:"band"},{name:"size",required:!0,scale:"identity"}],preInference:[...Xu(),{type:Ux},{type:v1}],postInference:[...pf(),...tb()],interaction:{shareTooltip:!0}};function B6(e){var t,n,r,i=e||1;function s(u,h){++t>i&&(r=n,l(1),++t),n[u]=h}function l(u){t=0,n=Object.create(null),u||(r=Object.create(null))}return l(),{clear:l,has:function(u){return n[u]!==void 0||r[u]!==void 0},get:function(u){var h=n[u];if(h!==void 0)return h;if((h=r[u])!==void 0)return s(u,h),h},set:function(u,h){n[u]!==void 0?n[u]=h:s(u,h)}}}const Lte=B6(3);function GV(e,t=(...r)=>`${r[0]}`,n=16){const r=B6(n);return(...i)=>{const s=t(...i);let l=r.get(s);return r.has(s)?r.get(s):(l=e(...i),r.set(s,l),l)}}function XV(e){return typeof e=="string"?e.split(" ").map(t=>{const[n,r]=t.split(":");return[+n,r]}):e}function TT(e,t,n){const r=e?e():document.createElement("canvas");return r.width=t,r.height=n,r}const YV=GV((e,t,n)=>{const r=TT(n,e*2,e*2),i=r.getContext("2d"),s=e,l=e;if(t===1)i.beginPath(),i.arc(s,l,e,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{const u=i.createRadialGradient(s,l,e*t,s,l,e);u.addColorStop(0,"rgba(0,0,0,1)"),u.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=u,i.fillRect(0,0,2*e,2*e)}return r},e=>`${e}`);function $V(e,t){const r=TT(t,256,1).getContext("2d"),i=r.createLinearGradient(0,0,256,1);return XV(e).forEach(([s,l])=>{i.addColorStop(s,l)}),r.fillStyle=i,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data}function KV(e,t,n,r,i,s){const{blur:l}=i;let u=r.length;for(;u--;){const{x:h,y:p,value:m,radius:y}=r[u],b=Math.min(m,n),w=h-y,R=p-y,P=YV(y,1-l,s),I=(b-t)/(n-t);e.globalAlpha=Math.max(I,.001),e.drawImage(P,w,R)}return e}function qV(e,t,n,r,i){const{minOpacity:s,opacity:l,maxOpacity:u,useGradientOpacity:h}=i,p=0,m=0,y=t,b=n,w=e.getImageData(p,m,y,b),R=w.data,P=R.length;for(let I=3;I<P;I+=4){const N=R[I],z=N*4;if(!z)continue;const Z=l||Math.max(0,Math.min(u,Math.max(s,N)));R[I-3]=r[z],R[I-2]=r[z+1],R[I-1]=r[z+2],R[I]=h?r[z+3]:Z}return w}function QV(e,t,n,r,i,s,l){const u=Object.assign({blur:.85,minOpacity:0,opacity:.6,maxOpacity:1,gradient:[[.25,"rgb(0,0,255)"],[.55,"rgb(0,255,0)"],[.85,"yellow"],[1,"rgb(255,0,0)"]]},s);u.minOpacity*=255,u.opacity*=255,u.maxOpacity*=255;const p=TT(l,e,t).getContext("2d"),m=$V(u.gradient,l);p.clearRect(0,0,e,t),KV(p,n,r,i,u,l);const y=qV(p,e,t,m,u),w=TT(l,e,t).getContext("2d");return w.putImageData(y,0,0),w}var JV=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function eH(e,t){return Object.keys(e).reduce((n,r)=>{const i=e[r];return t(i,r)||(n[r]=i),n},{})}const F6=(e,t)=>{const{gradient:n,opacity:r,maxOpacity:i,minOpacity:s,blur:l,useGradientOpacity:u}=e,h=JV(e,["gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity"]),{coordinate:p,createCanvas:m,document:y}=t;return(b,w,R)=>{const{transform:P}=w,[I,N]=p.getSize(),z=b.map(ae=>({x:ae[0],y:ae[1],value:ae[2],radius:ae[3]})),Z=qp(b,ae=>ae[2]),Y=Ol(b,ae=>ae[2]),J=I&&N?QV(I,N,Z,Y,z,eH({gradient:n,opacity:r,minOpacity:s,maxOpacity:i,blur:l,useGradientOpacity:u},ae=>ae===void 0),m):{canvas:null};return Ra(y.createElement("image",{})).call(ea,R).style("x",0).style("y",0).style("width",I).style("height",N).style("src",J.canvas).style("transform",P).call(ea,h).node()}};F6.props={defaultMarker:"point",defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const k6={heatmap:F6},z6=e=>(t,n,r,i)=>{const{x:s,y:l,size:u,color:h}=r,p=Array.from(t,m=>{const y=u?+u[m]:40;return[...i.map([+s[m],+l[m]]),h[m],y]});return[[0],[p]]};z6.props={defaultShape:"heatmap",defaultLabelShape:"label",composite:!1,shape:k6,channels:[...Fd({shapes:Object.keys(k6)}),{name:"x",required:!0},{name:"y",required:!0},{name:"color",scale:"identity",required:!0},{name:"size"}],preInference:[...Xu(),{type:v1},{type:xT}],postInference:[...pf(),...oy()]};var tH=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},nH=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function rH(e,t){const{text:n="text",value:r="value"}=t;return e.map(i=>Object.assign(Object.assign({},i),{text:i[n],value:i[r]}))}const iH=()=>({axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size",shape:"tag"},scale:{x:{range:[0,1]},y:{range:[0,1]}},style:{fontFamily:e=>e.fontFamily}}),R3=(e,t)=>tH(void 0,void 0,void 0,function*(){const{width:n,height:r}=t,{data:i,encode:s={},scale:l,style:u={},layout:h={}}=e,p=nH(e,["data","encode","scale","style","layout"]),m=rH(i,s);return ri({},iH(),Object.assign(Object.assign({data:{value:m,transform:[Object.assign({type:"wordCloud",size:[n,r]},h)]},encode:s,scale:l,style:u},p),{axis:!1}))});R3.props={};const U6=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];U6.props={};const j6=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];j6.props={};const V6=e=>new Gf(e);V6.props={};const wT=Symbol("defaultUnknown");function H6(e,t,n){for(let r=0;r<t.length;r+=1)e.has(t[r])||e.set(n(t[r]),r)}function Z6(e){const{value:t,from:n,to:r,mapper:i,notFoundReturn:s}=e;let l=i.get(t);if(l===void 0){if(s!==wT)return s;l=n.push(t)-1,i.set(t,l)}return r[l%r.length]}function W6(e){return e instanceof Date?t=>`${t}`:typeof e=="object"?t=>JSON.stringify(t):t=>t}class AT extends df{getDefaultOptions(){return{domain:[],range:[],unknown:wT}}constructor(t){super(t)}map(t){return this.domainIndexMap.size===0&&H6(this.domainIndexMap,this.getDomain(),this.domainKey),Z6({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return this.rangeIndexMap.size===0&&H6(this.rangeIndexMap,this.getRange(),this.rangeKey),Z6({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[n]=this.options.domain,[r]=this.options.range;if(this.domainKey=W6(n),this.rangeKey=W6(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!t||t.range)&&this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new AT(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:n}=this.options;return this.sortedDomain=n?[...t].sort(n):t,this.sortedDomain}}const G6=e=>new AT(e);G6.props={};function X6({map:e,initKey:t},n){const r=t(n);return e.has(r)?e.get(r):n}function oH({map:e,initKey:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function aH({map:e,initKey:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function sH(e){return typeof e=="object"?e.valueOf():e}class Y6 extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=sH,t!==null)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(X6({map:this.map,initKey:this.initKey},t))}has(t){return super.has(X6({map:this.map,initKey:this.initKey},t))}set(t,n){return super.set(oH({map:this.map,initKey:this.initKey},t),n)}delete(t){return super.delete(aH({map:this.map,initKey:this.initKey},t))}}function lH(e){const t=Math.min(...e);return e.map(n=>n/t)}function cH(e,t){const n=e.length,r=t-n;return r>0?[...e,...new Array(r).fill(1)]:r<0?e.slice(0,t):e}function uH(e){return Math.round(e*1e12)/1e12}function fH(e){const{domain:t,range:n,paddingOuter:r,paddingInner:i,flex:s,round:l,align:u}=e,h=t.length,p=cH(s,h),[m,y]=n,b=y-m,w=2/h*r+1-1/h*i,R=b/w,P=R*i/h,I=R-h*P,N=lH(p),z=N.reduce((lt,Ge)=>lt+Ge),Z=I/z,Y=new Y6(t.map((lt,Ge)=>{const rt=N[Ge]*Z;return[lt,l?Math.floor(rt):rt]})),$=new Y6(t.map((lt,Ge)=>{const st=N[Ge]*Z+P;return[lt,l?Math.floor(st):st]})),J=Array.from($.values()).reduce((lt,Ge)=>lt+Ge),pe=(b-(J-J/h*i))*u,Oe=m+pe;let Ve=l?Math.round(Oe):Oe;const Ke=new Array(h);for(let lt=0;lt<h;lt+=1){Ke[lt]=uH(Ve);const Ge=t[lt];Ve+=$.get(Ge)}return{valueBandWidth:Y,valueStep:$,adjustedRange:Ke}}function hH(e){var t;const{domain:n}=e,r=n.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((t=e.flex)===null||t===void 0)&&t.length))return fH(e);const{range:s,paddingOuter:l,paddingInner:u,round:h,align:p}=e;let m,y,b=s[0];const R=s[1]-b,P=l*2,I=r-u;m=R/Math.max(1,P+I),h&&(m=Math.floor(m)),b+=(R-m*(r-u))*p,y=m*(1-u),h&&(b=Math.round(b),y=Math.round(y));const N=new Array(r).fill(0).map((z,Z)=>b+Z*m);return{valueStep:m,valueBandWidth:y,adjustedRange:N}}class ay extends AT{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:wT,flex:[]}}constructor(t){super(t)}clone(){return new ay(this.options)}getStep(t){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:t===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:t===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:n}=this.options;return t>0?t:n}getPaddingOuter(){const{padding:t,paddingOuter:n}=this.options;return t>0?t:n}rescale(){super.rescale();const{align:t,domain:n,range:r,round:i,flex:s}=this.options,{adjustedRange:l,valueBandWidth:u,valueStep:h}=hH({align:t,range:r,round:i,flex:s,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:n});this.valueStep=h,this.valueBandWidth=u,this.adjustedRange=l}}const $6=e=>new ay(e);$6.props={};class CT extends df{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:yx}}map(t){return g_(t)?t:this.options.unknown}invert(t){return this.map(t)}clone(){return new CT(this.options)}getTicks(){const{domain:t,tickCount:n,tickMethod:r}=this.options,[i,s]=t;return!(0,dr.Z)(i)||!(0,dr.Z)(s)?[]:r(i,s,n)}}const K6=e=>new CT(e);K6.props={};class M3 extends ay{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:wT,paddingInner:1,paddingOuter:0}}constructor(t){super(t)}getPaddingInner(){return 1}clone(){return new M3(this.options)}update(t){super.update(t)}getPaddingOuter(){return this.options.padding}}const q6=e=>new M3(e);q6.props={};var Q6=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,sy="\\d\\d?",ly="\\d\\d",dH="\\d{3}",pH="\\d{4}",Hx="[^\\s]+",J6=/\[([^]*?)\]/gm;function eD(e,t){for(var n=[],r=0,i=e.length;r<i;r++)n.push(e[r].substr(0,t));return n}var tD=function(e){return function(t,n){var r=n[e].map(function(s){return s.toLowerCase()}),i=r.indexOf(t.toLowerCase());return i>-1?i:null}};function _1(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var s=i[r];for(var l in s)e[l]=s[l]}return e}var nD=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],rD=["January","February","March","April","May","June","July","August","September","October","November","December"],mH=eD(rD,3),vH=eD(nD,3),iD={dayNamesShort:vH,dayNames:nD,monthNamesShort:mH,monthNames:rD,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!==10?1:0)*e%10]}},OT=_1({},iD),gH=function(e){return OT=_1(OT,e)},oD=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},gp=function(e,t){for(t===void 0&&(t=2),e=String(e);e.length<t;)e="0"+e;return e},yH={D:function(e){return String(e.getDate())},DD:function(e){return gp(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return gp(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return gp(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return gp(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return gp(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return gp(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return gp(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return gp(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return gp(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return gp(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return gp(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+gp(Math.floor(Math.abs(t)/60)*100+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+gp(Math.floor(Math.abs(t)/60),2)+":"+gp(Math.abs(t)%60,2)}},aD=function(e){return+e-1},sD=[null,sy],lD=[null,Hx],cD=["isPm",Hx,function(e,t){var n=e.toLowerCase();return n===t.amPm[0]?0:n===t.amPm[1]?1:null}],uD=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var n=+t[1]*60+parseInt(t[2],10);return t[0]==="+"?n:-n}return 0}],_H={D:["day",sy],DD:["day",ly],Do:["day",sy+Hx,function(e){return parseInt(e,10)}],M:["month",sy,aD],MM:["month",ly,aD],YY:["year",ly,function(e){var t=new Date,n=+(""+t.getFullYear()).substr(0,2);return+(""+(+e>68?n-1:n)+e)}],h:["hour",sy,void 0,"isPm"],hh:["hour",ly,void 0,"isPm"],H:["hour",sy],HH:["hour",ly],m:["minute",sy],mm:["minute",ly],s:["second",sy],ss:["second",ly],YYYY:["year",pH],S:["millisecond","\\d",function(e){return+e*100}],SS:["millisecond",ly,function(e){return+e*10}],SSS:["millisecond",dH],d:sD,dd:sD,ddd:lD,dddd:lD,MMM:["month",Hx,tD("monthNamesShort")],MMMM:["month",Hx,tD("monthNames")],a:cD,A:cD,ZZ:uD,Z:uD},RT={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},bH=function(e){return _1(RT,e)},fD=function(e,t,n){if(t===void 0&&(t=RT.default),n===void 0&&(n={}),typeof e=="number"&&(e=new Date(e)),Object.prototype.toString.call(e)!=="[object Date]"||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");t=RT[t]||t;var r=[];t=t.replace(J6,function(s,l){return r.push(l),"@@@"});var i=_1(_1({},OT),n);return t=t.replace(Q6,function(s){return yH[s](e,i)}),t.replace(/@@@/g,function(){return r.shift()})};function xH(e,t,n){if(n===void 0&&(n={}),typeof t!="string")throw new Error("Invalid format in fecha parse");if(t=RT[t]||t,e.length>1e3)return null;var r=new Date,i={year:r.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},s=[],l=[],u=t.replace(J6,function(Y,$){return l.push(oD($)),"@@@"}),h={},p={};u=oD(u).replace(Q6,function(Y){var $=_H[Y],J=$[0],ae=$[1],pe=$[3];if(h[J])throw new Error("Invalid format. "+J+" specified twice in format");return h[J]=!0,pe&&(p[pe]=!0),s.push($),"("+ae+")"}),Object.keys(p).forEach(function(Y){if(!h[Y])throw new Error("Invalid format. "+Y+" is required in specified format")}),u=u.replace(/@@@/g,function(){return l.shift()});var m=e.match(new RegExp(u,"i"));if(!m)return null;for(var y=_1(_1({},OT),n),b=1;b<m.length;b++){var w=s[b-1],R=w[0],P=w[2],I=P?P(m[b],y):+m[b];if(I==null)return null;i[R]=I}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);var N;if(i.timezoneOffset==null){N=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var z=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],b=0,Z=z.length;b<Z;b++)if(h[z[b][0]]&&i[z[b][0]]!==N[z[b][1]]())return null}else if(N=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return N}var Dte={format:fD,parse:xH,defaultI18n:iD,setGlobalDateI18n:gH,setGlobalDateMasks:bH},Nte=null;const Zx=1e3,Wx=Zx*60,Gx=Wx*60,b1=Gx*24,Xx=b1*7,hD=b1*30,dD=b1*365;function yd(e,t,n,r){const i=(p,m)=>{const y=w=>r(w)%m===0;let b=m;for(;b&&!y(p);)n(p,-1),b-=1;return p},s=(p,m)=>{m&&i(p,m),t(p)},l=(p,m)=>{const y=new Date(+p);return s(y,m),y},u=(p,m)=>{const y=new Date(+p-1);return s(y,m),n(y,m),s(y),y};return{ceil:u,floor:l,range:(p,m,y,b)=>{const w=[],R=Math.floor(y),P=b?u(p,y):u(p);for(let I=P;I<m;n(I,R),s(I))w.push(new Date(+I));return w},duration:e}}const EH=yd(1,e=>e,(e,t=1)=>{e.setTime(+e+t)},e=>e.getTime()),SH=yd(Zx,e=>{e.setMilliseconds(0)},(e,t=1)=>{e.setTime(+e+Zx*t)},e=>e.getSeconds()),TH=yd(Wx,e=>{e.setSeconds(0,0)},(e,t=1)=>{e.setTime(+e+Wx*t)},e=>e.getMinutes()),wH=yd(Gx,e=>{e.setMinutes(0,0,0)},(e,t=1)=>{e.setTime(+e+Gx*t)},e=>e.getHours()),AH=yd(b1,e=>{e.setHours(0,0,0,0)},(e,t=1)=>{e.setTime(+e+b1*t)},e=>e.getDate()-1),pD=yd(hD,e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t=1)=>{const n=e.getMonth();e.setMonth(n+t)},e=>e.getMonth()),CH=yd(Xx,e=>{e.setDate(e.getDate()-e.getDay()%7),e.setHours(0,0,0,0)},(e,t=1)=>{e.setDate(e.getDate()+7*t)},e=>{const t=pD.floor(e),n=new Date(+e);return Math.floor((+n-+t)/Xx)}),OH=yd(dD,e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t=1)=>{const n=e.getFullYear();e.setFullYear(n+t)},e=>e.getFullYear()),mD={millisecond:EH,second:SH,minute:TH,hour:wH,day:AH,week:CH,month:pD,year:OH},RH=yd(1,e=>e,(e,t=1)=>{e.setTime(+e+t)},e=>e.getTime()),MH=yd(Zx,e=>{e.setUTCMilliseconds(0)},(e,t=1)=>{e.setTime(+e+Zx*t)},e=>e.getUTCSeconds()),PH=yd(Wx,e=>{e.setUTCSeconds(0,0)},(e,t=1)=>{e.setTime(+e+Wx*t)},e=>e.getUTCMinutes()),IH=yd(Gx,e=>{e.setUTCMinutes(0,0,0)},(e,t=1)=>{e.setTime(+e+Gx*t)},e=>e.getUTCHours()),LH=yd(b1,e=>{e.setUTCHours(0,0,0,0)},(e,t=1)=>{e.setTime(+e+b1*t)},e=>e.getUTCDate()-1),vD=yd(hD,e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t=1)=>{const n=e.getUTCMonth();e.setUTCMonth(n+t)},e=>e.getUTCMonth()),DH=yd(Xx,e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7)%7),e.setUTCHours(0,0,0,0)},(e,t=1)=>{e.setTime(+e+Xx*t)},e=>{const t=vD.floor(e),n=new Date(+e);return Math.floor((+n-+t)/Xx)}),NH=yd(dD,e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t=1)=>{const n=e.getUTCFullYear();e.setUTCFullYear(n+t)},e=>e.getUTCFullYear()),gD={millisecond:RH,second:MH,minute:PH,hour:IH,day:LH,week:DH,month:vD,year:NH};function BH(e){const t=e?gD:mD,{year:n,month:r,week:i,day:s,hour:l,minute:u,second:h,millisecond:p}=t;return{tickIntervals:[[h,1],[h,5],[h,15],[h,30],[u,1],[u,5],[u,15],[u,30],[l,1],[l,3],[l,6],[l,12],[s,1],[s,2],[i,1],[r,1],[r,3],[n,1]],year:n,millisecond:p}}function yD(e,t,n,r,i){const s=+e,l=+t,{tickIntervals:u,year:h,millisecond:p}=BH(i),m=([I,N])=>I.duration*N,y=r?(l-s)/r:n||5,b=r||(l-s)/y,w=u.length,R=Xp(u,b,0,w,m);let P;if(R===w){const I=nx(s/h.duration,l/h.duration,y);P=[h,I]}else if(R){const I=b/m(u[R-1])<m(u[R])/b,[N,z]=I?u[R-1]:u[R],Z=r?Math.ceil(r/N.duration):z;P=[N,Z]}else{const I=Math.max(nx(s,l,y),1);P=[p,I]}return P}const FH=(e,t,n,r,i)=>{const s=e>t,l=s?t:e,u=s?e:t,[h,p]=yD(l,u,n,r,i),m=h.range(l,new Date(+u+1),p,!0);return s?m.reverse():m},kH=(e,t,n,r,i)=>{const s=e>t,l=s?t:e,u=s?e:t,[h,p]=yD(l,u,n,r,i),m=[h.floor(l,p),h.ceil(u,p)];return s?m.reverse():m};function zH(e,t){const{second:n,minute:r,hour:i,day:s,week:l,month:u,year:h}=t;return n.floor(e)<e?".SSS":r.floor(e)<e?":ss":i.floor(e)<e?"hh:mm":s.floor(e)<e?"hh A":u.floor(e)<e?l.floor(e)<e?"MMM DD":"ddd DD":h.floor(e)<e?"MMMM":"YYYY"}function UH(e){const t=e.getTimezoneOffset(),n=new Date(e);return n.setMinutes(n.getMinutes()+t,n.getSeconds(),n.getMilliseconds()),n}class P3 extends Bo{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:FH,interpolate:If,mask:void 0,utc:!1}}chooseTransforms(){return[r=>+r,r=>new Date(r)]}chooseNice(){return kH}getTickMethodOptions(){const{domain:t,tickCount:n,tickInterval:r,utc:i}=this.options,s=t[0],l=t[t.length-1];return[s,l,n,r,i]}getFormatter(){const{mask:t,utc:n}=this.options,r=n?gD:mD,i=n?UH:jv;return s=>fD(i(s),t||zH(s,r))}clone(){return new P3(this.options)}}const _D=e=>new P3(e);_D.props={};const bD=e=>t=>-e(-t),I3=(e,t)=>{const n=Math.log(e),r=e===Math.E?Math.log:e===10?Math.log10:e===2?Math.log2:i=>Math.log(i)/n;return t?bD(r):r},L3=(e,t)=>{const n=e===Math.E?Math.exp:r=>vf(e,r);return t?bD(n):n},jH=(e,t,n,r=10)=>{const i=e<0,s=L3(r,i),l=I3(r,i),u=t<e,h=u?t:e,p=u?e:t;let m=l(h),y=l(p),b=[];if(!(r%1)&&y-m<n){if(m=Math.floor(m),y=Math.ceil(y),i)for(;m<=y;m+=1){const w=s(m);for(let R=r-1;R>=1;R-=1){const P=w*R;if(P>p)break;P>=h&&b.push(P)}}else for(;m<=y;m+=1){const w=s(m);for(let R=1;R<r;R+=1){const P=w*R;if(P>p)break;P>=h&&b.push(P)}}b.length*2<n&&(b=qm(h,p,n))}else{const w=n===-1?y-m:Math.min(y-m,n);b=qm(m,y,w).map(s)}return u?b.reverse():b},VH=(e,t,n,r)=>{const i=e<0,s=I3(r,i),l=L3(r,i),u=e>t,h=u?t:e,p=u?e:t,m=[l(Math.floor(s(h))),l(Math.ceil(s(p)))];return u?m.reverse():m};class D3 extends Bo{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:$m,tickMethod:jH,tickCount:5}}chooseNice(){return VH}getTickMethodOptions(){const{domain:t,tickCount:n,base:r}=this.options,i=t[0],s=t[t.length-1];return[i,s,n,r]}chooseTransforms(){const{base:t,domain:n}=this.options,r=n[0]<0;return[I3(t,r),L3(t,r)]}clone(){return new D3(this.options)}}const xD=e=>new D3(e);xD.props={};const HH=e=>t=>t<0?-vf(-t,e):vf(t,e),ZH=e=>t=>t<0?-vf(-t,1/e):vf(t,1/e),WH=e=>e<0?-Math.sqrt(-e):Math.sqrt(e);class MT extends Bo{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:$m,tickMethod:qm,tickCount:5}}constructor(t){super(t)}chooseTransforms(){const{exponent:t}=this.options;if(t===1)return[jv,jv];const n=t===.5?WH:HH(t),r=ZH(t);return[n,r]}clone(){return new MT(this.options)}}const ED=e=>new MT(e);ED.props={};class N3 extends MT{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:$m,tickMethod:qm,tickCount:5,exponent:.5}}constructor(t){super(t)}update(t){super.update(t)}clone(){return new N3(this.options)}}const SD=e=>new N3(e);SD.props={};const TD=e=>new Jm(e);TD.props={};const wD=e=>new D_(e);wD.props={};const AD=e=>new Ws(e);AD.props={};const GH=e=>t=>{const n=e(t);return(0,dr.Z)(n)?Math.round(n):n};function XH(e,t){return n=>{n.prototype.rescale=function(){this.initRange(),this.nice();const[r]=this.chooseTransforms();this.composeOutput(r,this.chooseClamp(r))},n.prototype.initRange=function(){const{interpolator:r}=this.options;this.options.range=e(r)},n.prototype.composeOutput=function(r,i){const{domain:s,interpolator:l,round:u}=this.getOptions(),h=t(s.map(r)),p=u?GH(l):l;this.output=Ou(p,h,i,r)},n.prototype.invert=void 0}}var YH=function(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(s=(i<3?l(s):i>3?l(t,n,s):l(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},B3;function $H(e){return[e(0),e(1)]}const KH=e=>{const[t,n]=e;return Ou(If(0,1),nc(t,n))};let F3=B3=class extends Gf{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:jv,tickMethod:qm,tickCount:5}}constructor(t){super(t)}clone(){return new B3(this.options)}};F3=B3=YH([XH($H,KH)],F3);const CD=e=>new F3(e);CD.props={};const OD=e=>new n1(e);OD.props={};function k3({colorDefault:e,colorBlack:t,colorWhite:n,colorStroke:r,colorBackground:i,padding1:s,padding2:l,padding3:u,alpha90:h,alpha65:p,alpha45:m,alpha25:y,alpha10:b,category10:w,category20:R,sizeDefault:P=1,padding:I="auto",margin:N=16}){return{padding:I,margin:N,size:P,color:e,category10:w,category20:R,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},view:{viewFill:i,plotFill:"transparent",mainFill:"transparent",contentFill:"transparent"},line:{line:{fill:"",strokeOpacity:1,lineWidth:1,lineCap:"round"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,strokeOpacity:.95,lineWidth:1},plus:{r:3,strokeOpacity:.95,lineWidth:3},diamond:{r:3,strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:t,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,lineWidth:0,connectorStroke:r,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:r,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,lineWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:r,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:r,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:r,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:r,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:r,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:r,endMarkerFillOpacity:.95}},axis:{arrow:!1,gridLineDash:[3,4],gridLineWidth:.5,gridStroke:t,gridStrokeOpacity:b,labelAlign:"horizontal",labelFill:t,labelOpacity:m,labelFontSize:12,labelFontWeight:"normal",labelSpacing:s,line:!1,lineLineWidth:.5,lineStroke:t,lineStrokeOpacity:m,tickLength:4,tickLineWidth:1,tickStroke:t,tickOpacity:m,titleFill:t,titleOpacity:h,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,titleTransformOrigin:"center",lineArrowOffset:6,lineArrowSize:6},axisTop:{gridDirection:"positive",labelDirection:"negative",tickDirection:"negative",titlePosition:"top",titleSpacing:12,labelSpacing:4,titleTextBaseline:"middle"},axisBottom:{gridDirection:"negative",labelDirection:"positive",tickDirection:"positive",titlePosition:"bottom",titleSpacing:12,labelSpacing:4,titleTextBaseline:"bottom",titleTransform:"translate(0, 8)"},axisLeft:{gridDirection:"positive",labelDirection:"negative",labelSpacing:4,tickDirection:"negative",titlePosition:"left",titleSpacing:12,titleTextBaseline:"middle",titleDirection:"vertical",titleTransform:"rotate(-90) translate(0, -8)",titleTransformOrigin:"center"},axisRight:{gridDirection:"negative",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",titlePosition:"right",titleSpacing:12,titleTextBaseline:"top",titleDirection:"vertical",titleTransformOrigin:"center"},axisLinear:{girdClosed:!0,gridConnect:"arc",gridDirection:"negative",gridType:"surround",titlePosition:"top",titleSpacing:0},axisArc:{title:!1,titlePosition:"inner",line:!1,tick:!0,labelSpacing:4},axisRadar:{girdClosed:!0,gridStrokeOpacity:.3,gridType:"surround",label:!1,tick:!1,titlePosition:"start"},legendCategory:{backgroundFill:"transparent",itemBackgroundFill:"transparent",itemLabelFill:t,itemLabelFillOpacity:h,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[s,s],itemValueFill:t,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",navButtonFill:t,navButtonFillOpacity:.65,navPageNumFill:t,navPageNumFillOpacity:.45,navPageNumFontSize:12,padding:8,title:!1,titleFill:t,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,tickStroke:t,tickStrokeOpacity:.25,rowPadding:s,colPadding:l,maxRows:3,maxCols:3},legendContinuous:{handleHeight:12,handleLabelFill:t,handleLabelFillOpacity:m,handleLabelFontSize:12,handleLabelFontWeight:"normal",handleMarkerFill:t,handleMarkerFillOpacity:.6,handleMarkerLineWidth:1,handleMarkerStroke:t,handleMarkerStrokeOpacity:.25,handleWidth:10,labelFill:t,labelFillOpacity:m,labelFontSize:12,labelFontWeight:"normal",labelSpacing:3,tick:!0,tickLength:12,ribbonSize:12,ribbonFill:"#aaa",handle:!0,handleLabel:!1,handleShape:"slider",handleIconSize:12/1.8,indicator:!1,titleFontSize:12,titleSpacing:4,titleFontWeight:"normal",titleFillOpacity:h,tickStroke:t,tickStrokeOpacity:m},label:{fill:t,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:void 0,offset:12,connectorStroke:t,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength:12,connectorLength2:8,connectorDistance:4},innerLabel:{fill:n,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:void 0,offset:0},htmlLabel:{fontSize:12,opacity:.65,color:t,fontWeight:"normal"},slider:{trackSize:16,trackFill:r,trackFillOpacity:1,selectionFill:e,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:t,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:t,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{padding:[0,0,0,0],trackSize:6,isRound:!0,slidable:!0,scrollable:!0,trackFill:"#e5e5e5",trackFillOpacity:0,thumbFill:"#000",thumbFillOpacity:.15,thumbHighlightedFillOpacity:.2},title:{spacing:8,titleFill:t,titleFillOpacity:h,titleFontSize:16,titleFontWeight:"bold",titleTextBaseline:"top",subtitleFill:t,subtitleFillOpacity:p,subtitleFontSize:12,subtitleFontWeight:"normal",subtitleTextBaseline:"top"},tooltip:{css:{".g2-tooltip":{"font-family":"sans-serif"}}}}}const qH=k3({colorBlack:"#1D2129",colorWhite:"#ffffff",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),z3=e=>ri({},qH,e);z3.props={};const RD=e=>ri({},z3(),{category10:"category10",category20:"category20"},e);RD.props={};const QH=k3({colorBlack:"#fff",colorWhite:"#000",colorStroke:"#416180",colorDefault:"#1783FF",colorBackground:"transparent",category10:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F"],category20:["#1783FF","#00C9C9","#F0884D","#D580FF","#7863FF","#60C42D","#BD8F24","#FF80CA","#2491B3","#17C76F","#AABA01","#BC7CFC","#237CBC","#2DE379","#CE8032","#FF7AF4","#545FD3","#AFE410","#D8C608","#FFA1E0"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.25}),MD=e=>ri({},QH,{tooltip:{crosshairsStroke:"#fff",crosshairsLineWidth:1,crosshairsStrokeOpacity:.25,css:{".g2-tooltip":{background:"#1f1f1f",opacity:.95},".g2-tooltip-title":{color:"#A6A6A6"},".g2-tooltip-list-item-name-label":{color:"#A6A6A6"},".g2-tooltip-list-item-value":{color:"#A6A6A6"}}}},e),PD=e=>Object.assign({},MD(),{category10:"category10",category20:"category20"},e);PD.props={};const JH=k3({colorBlack:"#000",colorWhite:"#fff",colorStroke:"#888",colorDefault:"#4e79a7",colorBackground:"transparent",category10:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],category20:["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],padding1:8,padding2:12,padding3:20,alpha90:.9,alpha65:.65,alpha45:.45,alpha25:.25,alpha10:.1}),ID=e=>ri({},JH,{text:{text:{fontSize:10}},axis:{gridLineDash:[0,0],gridLineWidth:1,gridStroke:"#ddd",gridStrokeOpacity:1,labelOpacity:1,labelStrokeOpacity:1,labelFontSize:10,line:!0,lineLineWidth:1,lineStroke:"#888",lineStrokeOpacity:1,tickLength:5,tickStrokeOpacity:1,titleOpacity:1,titleStrokeOpacity:1,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},axisLeft:{gridFilter:(t,n)=>n!==0},axisRight:{gridFilter:(t,n)=>n!==0},legendCategory:{itemLabelFillOpacity:1,itemLabelFontSize:10,itemValueFillOpacity:1,itemValueFontSize:10,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold"},legendContinuous:{handleLabelFontSize:10,labelFillOpacity:.45,labelFontSize:10},label:{fontSize:10},innerLabel:{fontSize:10},htmlLabel:{fontSize:10},slider:{handleLabelFontSize:10,trackFillOpacity:.05}},e);ID.props={};const LD=e=>(...t)=>{const n=mp(Object.assign({},{crossPadding:50},e))(...t);return cS(n,e),n};LD.props=Object.assign(Object.assign({},mp.props),{defaultPosition:"bottom"});function zte(){}const DD=e=>(...t)=>{const n=mp(Object.assign({},{crossPadding:10},e))(...t);return cS(n,e),n};DD.props=Object.assign(Object.assign({},mp.props),{defaultPosition:"left"});var U3=function(){},eZ=function(e,t,n){var r=e,i=Xo(t)?t.split("."):t;return i.forEach(function(s,l){l<i.length-1?(ha(r[s])||(r[s]=(0,dr.Z)(i[l+1])?[]:{}),r=r[s]):r[s]=n}),e};function tZ(e,t){return e.reduce(function(n,r){return(n[r[t]]=n[r[t]]||[]).push(r),n},{})}function nZ(e){var t;return((t=e[0])===null||t===void 0?void 0:t.map(function(n,r){return e.map(function(i){return i[r]})}))||[]}var I0=fp({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),rZ=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:DC(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,s){return"".concat(i,"/").concat(s)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new ki({class:I0.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new ki({class:I0.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(t.prototype,"defaultPage",{get:function(){var n=this.attributes.defaultPage;return(0,ya.Z)(n,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageShape",{get:function(){var n=this.pageViews,r=(0,j.CR)(nZ(n.map(function(y){var b=y.getBBox(),w=b.width,R=b.height;return[w,R]})).map(function(y){return Math.max.apply(Math,(0,j.ev)([],(0,j.CR)(y),!1))}),2),i=r[0],s=r[1],l=this.attributes,u=l.pageWidth,h=u===void 0?i:u,p=l.pageHeight,m=p===void 0?s:p;return{pageWidth:h,pageHeight:m}},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(t.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n=e.prototype.getBBox.call(this),r=n.x,i=n.y,s=this.controllerShape,l=this.pageShape,u=l.pageWidth,h=l.pageHeight;return new vc(r,i,u+s.width,h)},t.prototype.goTo=function(n){var r=this,i=this.attributes.animate,s=this,l=s.currPage,u=s.playState,h=s.playWindow,p=s.pageViews;if(u!=="idle"||n<0||p.length<=0||n>=p.length)return null;p[l].setLocalPosition(0,0),this.prepareFollowingPage(n);var m=(0,j.CR)(this.getFollowingPageDiff(n),2),y=m[0],b=m[1];this.playState="running";var w=PE(h,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-y,", ").concat(-b,")")}],i);return Lg(w,function(){r.innerCurrPage=n,r.playState="idle",r.setVisiblePages([n]),r.updatePageInfo()}),w},t.prototype.prev=function(){var n=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!n&&i<=0)return null;var s=n?(i-1+r)%r:(0,ya.Z)(i-1,0,r);return this.goTo(s)},t.prototype.next=function(){var n=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!n&&i>=r-1)return null;var s=n?(i+1)%r:(0,ya.Z)(i+1,0,r);return this.goTo(s)},t.prototype.renderClipPath=function(n){var r=this.pageShape,i=r.pageWidth,s=r.pageHeight;if(!i||!s){this.contentGroup.style.clipPath=void 0;return}this.clipPath=n.maybeAppendByClassName(I0.clipPath,"rect").styles({width:i,height:s}),this.contentGroup.attr("clipPath",this.clipPath.node())},t.prototype.setVisiblePages=function(n){this.playWindow.children.forEach(function(r,i){n.includes(i)?Wy(r):cd(r)})},t.prototype.adjustControllerLayout=function(){var n=this,r=n.prevBtnGroup,i=n.nextBtnGroup,s=n.pageInfoGroup,l=this.attributes,u=l.orientation,h=l.controllerPadding,p=s.getBBox(),m=p.width,y=p.height,b=(0,j.CR)(u==="horizontal"?[-180,0]:[-90,90],2),w=b[0],R=b[1];r.setLocalEulerAngles(w),i.setLocalEulerAngles(R);var P=r.getBBox(),I=P.width,N=P.height,z=i.getBBox(),Z=z.width,Y=z.height,$=Math.max(I,m,Z),J=u==="horizontal"?{offset:[[0,0],[I/2+h,0],[I+m+h*2,0]],textAlign:"start"}:{offset:[[$/2,-N-h],[$/2,0],[$/2,Y+h]],textAlign:"center"},ae=(0,j.CR)(J.offset,3),pe=(0,j.CR)(ae[0],2),Oe=pe[0],Ve=pe[1],Ke=(0,j.CR)(ae[1],2),lt=Ke[0],Ge=Ke[1],rt=(0,j.CR)(ae[2],2),st=rt[0],ut=rt[1],jt=J.textAlign,At=s.querySelector("text");At&&(At.style.textAlign=jt),r.setLocalPosition(Oe,Ve),s.setLocalPosition(lt,Ge),i.setLocalPosition(st,ut)},t.prototype.updatePageInfo=function(){var n,r=this,i=r.currPage,s=r.pageViews,l=r.attributes.formatter;s.length<2||((n=this.pageInfoGroup.querySelector(I0.pageInfo.class))===null||n===void 0||n.attr("text",l(i+1,s.length)),this.adjustControllerLayout())},t.prototype.getFollowingPageDiff=function(n){var r=this.currPage;if(r===n)return[0,0];var i=this.attributes.orientation,s=this.pageShape,l=s.pageWidth,u=s.pageHeight,h=n<r?-1:1;return i==="horizontal"?[h*l,0]:[0,h*u]},t.prototype.prepareFollowingPage=function(n){var r=this,i=r.currPage,s=r.pageViews;if(this.setVisiblePages([n,i]),n!==i){var l=(0,j.CR)(this.getFollowingPageDiff(n),2),u=l[0],h=l[1];s[n].setLocalPosition(u,h)}},t.prototype.renderController=function(n){var r=this,i=this.attributes.controllerSpacing,s=this.pageShape,l=s.pageWidth,u=s.pageHeight,h=this.pageViews.length>=2,p=n.maybeAppendByClassName(I0.controller,"g");if(i_(p.node(),h),!!h){var m=Os(this.attributes,"button"),y=Os(this.attributes,"pageNum"),b=(0,j.CR)(w0(m),2),w=b[0],R=b[1],P=w.size,I=(0,j._T)(w,["size"]),N=!p.select(I0.prevBtnGroup.class).node(),z=p.maybeAppendByClassName(I0.prevBtnGroup,"g").styles(R);this.prevBtnGroup=z.node();var Z=z.maybeAppendByClassName(I0.prevBtn,"path"),Y=p.maybeAppendByClassName(I0.nextBtnGroup,"g").styles(R);this.nextBtnGroup=Y.node();var $=Y.maybeAppendByClassName(I0.nextBtn,"path");[Z,$].forEach(function(ae){ae.styles((0,j.pi)((0,j.pi)({},I),{transformOrigin:"center"})),An(ae.node(),P,!0)});var J=p.maybeAppendByClassName(I0.pageInfoGroup,"g");this.pageInfoGroup=J.node(),J.maybeAppendByClassName(I0.pageInfo,"text").styles(y),this.updatePageInfo(),p.node().setLocalPosition(l+i,u/2),N&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},t.prototype.render=function(n,r){var i=n.x,s=i===void 0?0:i,l=n.y,u=l===void 0?0:l;this.attr("transform","translate(".concat(s,", ").concat(u,")"));var h=es(r);this.renderClipPath(h),this.renderController(h),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},t.prototype.bindEvents=function(){var n=this,r=q2(function(){return n.render(n.attributes,n)},50);this.playWindow.addEventListener(No.INSERTED,r),this.playWindow.addEventListener(No.REMOVED,r)},t}(Mf),Qp=fp({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function iZ(e){var t=e.querySelector(Qp.marker.class);return t?t.style:{}}var oZ=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,{span:[1,1],marker:function(){return new bi({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(t.prototype,"showValue",{get:function(){var n=this.attributes.valueText;return n?typeof n=="string"||typeof n=="number"?n!=="":typeof n=="function"?!0:n.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualSpace",{get:function(){var n=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,s=n.node().getBBox(),l=s.width,u=s.height,h=r.node().getBBox(),p=h.width,m=h.height;return{markerWidth:i,labelWidth:l,valueWidth:p,height:Math.max(i,u,m)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"span",{get:function(){var n=this.attributes.span;if(!n)return[1,1];var r=(0,j.CR)(Pf(n),2),i=r[0],s=r[1],l=this.showValue?s:0,u=i+l;return[i/u,l/u]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var n,r=this.attributes,i=r.markerSize,s=r.width,l=this.actualSpace,u=l.markerWidth,h=l.height,p=this.actualSpace,m=p.labelWidth,y=p.valueWidth,b=(0,j.CR)(this.spacing,2),w=b[0],R=b[1];if(s){var P=s-i-w-R,I=(0,j.CR)(this.span,2),N=I[0],z=I[1];n=(0,j.CR)([N*P,z*P],2),m=n[0],y=n[1]}var Z=u+m+y+w+R;return{width:Z,height:h,markerWidth:u,labelWidth:m,valueWidth:y}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){var n=this.attributes.spacing;if(!n)return[0,0];var r=(0,j.CR)(Pf(n),2),i=r[0],s=r[1];return this.showValue?[i,s]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){var n=this.shape,r=n.markerWidth,i=n.labelWidth,s=n.valueWidth,l=n.width,u=n.height,h=(0,j.CR)(this.spacing,2),p=h[0],m=h[1];return{height:u,width:l,markerWidth:r,labelWidth:i,valueWidth:s,position:[r/2,r+p,r+i+p+m]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleSize",{get:function(){var n=iZ(this.markerGroup.node()),r=this.attributes,i=r.markerSize,s=r.markerStrokeWidth,l=s===void 0?n.strokeWidth:s,u=r.markerLineWidth,h=u===void 0?n.lineWidth:u,p=r.markerStroke,m=p===void 0?n.stroke:p,y=+(l||h||(m?1:0))*Math.sqrt(2),b=this.markerGroup.node().getBBox(),w=b.width,R=b.height;return(1-y/Math.max(w,R))*i},enumerable:!1,configurable:!0}),t.prototype.renderMarker=function(n){var r=this,i=this.attributes.marker,s=Os(this.attributes,"marker");this.markerGroup=n.maybeAppendByClassName(Qp.markerGroup,"g").style("zIndex",0),Lh(!!i,this.markerGroup,function(){var l,u=r.markerGroup.node(),h=(l=u.childNodes)===null||l===void 0?void 0:l[0],p=typeof i=="string"?new yl({style:{symbol:i},className:Qp.marker.name}):i();h?p.nodeName===h.nodeName?h instanceof yl?h.update((0,j.pi)((0,j.pi)({},s),{symbol:i})):(VA(h,p),es(h).styles(s)):(h.remove(),es(p).attr("className",Qp.marker.name).styles(s),u.appendChild(p)):(p instanceof yl||es(p).attr("className",Qp.marker.name).styles(s),u.appendChild(p)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var m=An(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(m,")")})},t.prototype.renderLabel=function(n){var r=Os(this.attributes,"label"),i=r.text,s=(0,j._T)(r,["text"]);this.labelGroup=n.maybeAppendByClassName(Qp.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Qp.label,function(){return Gm(i)}).styles(s)},t.prototype.renderValue=function(n){var r=this,i=Os(this.attributes,"value"),s=i.text,l=(0,j._T)(i,["text"]);this.valueGroup=n.maybeAppendByClassName(Qp.valueGroup,"g").style("zIndex",0),Lh(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(Qp.value,function(){return Gm(s)}).styles(l)})},t.prototype.renderBackground=function(n){var r=this.shape,i=r.width,s=r.height,l=Os(this.attributes,"background");this.background=n.maybeAppendByClassName(Qp.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Qp.background,"rect").styles((0,j.pi)({width:i,height:s},l))},t.prototype.adjustLayout=function(){var n=this.layout,r=n.labelWidth,i=n.valueWidth,s=n.height,l=(0,j.CR)(n.position,3),u=l[0],h=l[1],p=l[2],m=s/2;this.markerGroup.styles({transform:"translate(".concat(u,", ").concat(m,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(h,", ").concat(m,")")}),f_(this.labelGroup.select(Qp.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(p,", ").concat(m,")")}),f_(this.valueGroup.select(Qp.value.class).node(),Math.ceil(i)))},t.prototype.render=function(n,r){var i=es(r),s=n.x,l=s===void 0?0:s,u=n.y,h=u===void 0?0:u;i.styles({transform:"translate(".concat(l,", ").concat(h,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},t}(Mf),x1=fp({page:"item-page",navigator:"navigator",item:"item"},"items"),ND=function(e,t,n){return n===void 0&&(n=!0),e?t(e):n},aZ=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:U3,mouseenter:U3,mouseleave:U3})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){var n=this.attributes,r=n.gridRow,i=n.gridCol,s=n.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,s.length]:[s.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderData",{get:function(){var n=this.attributes,r=n.data,i=n.layout,s=Os(this.attributes,"item"),l=r.map(function(u,h){var p=u.id,m=p===void 0?h:p,y=u.label,b=u.value;return{id:"".concat(m),index:h,style:(0,j.pi)({layout:i,labelText:y,valueText:b},Object.fromEntries(Object.entries(s).map(function(w){var R=(0,j.CR)(w,2),P=R[0],I=R[1];return[P,ud(I,[u,h,r])]})))}});return l},enumerable:!1,configurable:!0}),t.prototype.getGridLayout=function(){var n=this,r=this.attributes,i=r.orientation,s=r.width,l=r.rowPadding,u=r.colPadding,h=(0,j.CR)(this.navigatorShape,1),p=h[0],m=(0,j.CR)(this.grid,2),y=m[0],b=m[1],w=b*y,R=0;return this.pageViews.children.map(function(P,I){var N,z,Z=Math.floor(I/w),Y=I%w,$=n.ifHorizontal(b,y),J=[Math.floor(Y/$),Y%$];i==="vertical"&&J.reverse();var ae=(0,j.CR)(J,2),pe=ae[0],Oe=ae[1],Ve=(s-p-(b-1)*u)/b,Ke=P.getBBox().height,lt=(0,j.CR)([0,0],2),Ge=lt[0],rt=lt[1];return i==="horizontal"?(N=(0,j.CR)([R,pe*(Ke+l)],2),Ge=N[0],rt=N[1],R=Oe===b-1?0:R+Ve+u):(z=(0,j.CR)([Oe*(Ve+u),R],2),Ge=z[0],rt=z[1],R=pe===y-1?0:R+Ke+l),{page:Z,index:I,row:pe,col:Oe,pageIndex:Y,width:Ve,height:Ke,x:Ge,y:rt}})},t.prototype.getFlexLayout=function(){var n=this.attributes,r=n.width,i=n.height,s=n.rowPadding,l=n.colPadding,u=(0,j.CR)(this.navigatorShape,1),h=u[0],p=(0,j.CR)(this.grid,2),m=p[0],y=p[1],b=(0,j.CR)([r-h,i],2),w=b[0],R=b[1],P=(0,j.CR)([0,0,0,0,0,0,0,0],8),I=P[0],N=P[1],z=P[2],Z=P[3],Y=P[4],$=P[5],J=P[6],ae=P[7];return this.pageViews.children.map(function(pe,Oe){var Ve,Ke,lt,Ge,rt=pe.getBBox(),st=rt.width,ut=rt.height,jt=J===0?0:l,At=J+jt+st;if(At<=w&&ND(Y,function(wn){return wn<y}))return Ve=(0,j.CR)([J+jt,ae,At],3),I=Ve[0],N=Ve[1],J=Ve[2],{width:st,height:ut,x:I,y:N,page:z,index:Oe,pageIndex:Z++,row:$,col:Y++};Ke=(0,j.CR)([$+1,0,0,ae+ut+s],4),$=Ke[0],Y=Ke[1],J=Ke[2],ae=Ke[3];var zt=ae+ut;return zt<=R&&ND($,function(wn){return wn<m})?(lt=(0,j.CR)([J,ae,st],3),I=lt[0],N=lt[1],J=lt[2],{width:st,height:ut,x:I,y:N,page:z,index:Oe,pageIndex:Z++,row:$,col:Y++}):(Ge=(0,j.CR)([0,0,st,0,z+1,0,0,0],8),I=Ge[0],N=Ge[1],J=Ge[2],ae=Ge[3],z=Ge[4],Z=Ge[5],$=Ge[6],Y=Ge[7],{width:st,height:ut,x:I,y:N,page:z,index:Oe,pageIndex:Z++,row:$,col:Y++})})},Object.defineProperty(t.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var n=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=n.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],n.call(this)):r},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(n,r){var i=this.attributes.orientation;return M0(i,n,r)},t.prototype.flattenPage=function(n){n.querySelectorAll(x1.item.class).forEach(function(r){n.appendChild(r)}),n.querySelectorAll(x1.page.class).forEach(function(r){var i=n.removeChild(r);i.destroy()})},t.prototype.renderItems=function(n){var r=this.attributes,i=r.click,s=r.mouseenter,l=r.mouseleave;this.flattenPage(n);var u=this.dispatchCustomEvent.bind(this);es(n).selectAll(x1.item.class).data(this.renderData,function(h){return h.id}).join(function(h){return h.append(function(p){var m=p.style;return new oZ({style:m})}).attr("className",x1.item.name).on("click",function(){i==null||i(this),u("itemClick",{item:this})}).on("pointerenter",function(){s==null||s(this),u("itemMouseenter",{item:this})}).on("pointerleave",function(){l==null||l(this),u("itemMouseleave",{item:this})})},function(h){return h.each(function(p){var m=p.style;this.update(m)})},function(h){return h.remove()})},t.prototype.relayoutNavigator=function(){var n,r=this.attributes,i=r.layout,s=r.width,l=((n=this.pageViews.children[0])===null||n===void 0?void 0:n.getBBox().height)||0,u=(0,j.CR)(this.navigatorShape,2),h=u[0],p=u[1];this.navigator.update(i==="grid"?{pageWidth:s-h,pageHeight:l-p}:{})},t.prototype.adjustLayout=function(){var n=this,r=Object.entries(tZ(this.itemsLayout,"page")).map(function(s){var l=(0,j.CR)(s,2),u=l[0],h=l[1];return{page:u,layouts:h}}),i=(0,j.ev)([],(0,j.CR)(this.navigator.getContainer().children),!1);r.forEach(function(s){var l=s.layouts,u=n.pageViews.appendChild(new ki({className:x1.page.name}));l.forEach(function(h){var p=h.x,m=h.y,y=h.index,b=h.width,w=h.height,R=i[y];u.appendChild(R),eZ(R,"__layout__",h),R.update({x:p,y:m,width:b,height:w})})}),this.relayoutNavigator()},t.prototype.renderNavigator=function(n){var r=this.attributes.orientation,i=Os(this.attributes,"nav"),s=em({orientation:r},i),l=this;return n.selectAll(x1.navigator.class).data(["nav"]).join(function(u){return u.append(function(){return new rZ({style:s})}).attr("className",x1.navigator.name).each(function(){l.navigator=this})},function(u){return u.each(function(){this.update(s)})},function(u){return u.remove()}),this.navigator},t.prototype.getBBox=function(){return this.navigator.getBBox()},t.prototype.render=function(n,r){var i=this.attributes.data;if(!(!i||i.length===0)){var s=this.renderNavigator(es(r));this.renderItems(s.getContainer()),this.adjustLayout()}},t.prototype.dispatchCustomEvent=function(n,r){var i=new Va(n,{detail:r});this.dispatchEvent(i)},t}(Mf),sZ=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,SS)||this}return t.prototype.renderTitle=function(n,r,i){var s=this.attributes,l=s.showTitle,u=s.titleText,h=Os(this.attributes,"title"),p=(0,j.CR)(w0(h),2),m=p[0],y=p[1];this.titleGroup=n.maybeAppendByClassName(Xf.titleGroup,"g").styles(y);var b=(0,j.pi)((0,j.pi)({width:r,height:i},m),{text:l?u:""});this.title=this.titleGroup.maybeAppendByClassName(Xf.title,function(){return new QE({style:b})}).update(b)},t.prototype.renderItems=function(n,r){var i=r.x,s=r.y,l=r.width,u=r.height,h=Os(this.attributes,"title",!0),p=(0,j.CR)(w0(h),2),m=p[0],y=p[1],b=(0,j.pi)((0,j.pi)({},m),{width:l,height:u,x:0,y:0});this.itemsGroup=n.maybeAppendByClassName(Xf.itemsGroup,"g").styles((0,j.pi)((0,j.pi)({},y),{transform:"translate(".concat(i,", ").concat(s,")")}));var w=this;this.itemsGroup.selectAll(Xf.items.class).data(["items"]).join(function(R){return R.append(function(){return new aZ({style:b})}).attr("className",Xf.items.name).each(function(){w.items=es(this)})},function(R){return R.update(b)},function(R){return R.remove()})},t.prototype.adjustLayout=function(){var n=this.attributes.showTitle;if(n){var r=this.title.node().getAvailableSpace(),i=r.x,s=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(s,")")}},Object.defineProperty(t.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.showTitle,i=n.width,s=n.height;return r?this.title.node().getAvailableSpace():new vc(0,0,i,s)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var n,r,i=(n=this.title)===null||n===void 0?void 0:n.node(),s=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!s?e.prototype.getBBox.call(this):JA(i,s)},t.prototype.render=function(n,r){var i=this.attributes,s=i.width,l=i.height,u=i.x,h=u===void 0?0:u,p=i.y,m=p===void 0?0:p,y=es(r);r.style.transform="translate(".concat(h,", ").concat(m,")"),this.renderTitle(y,s,l),this.renderItems(y,this.availableSpace),this.adjustLayout()},t}(Mf);function Yx(e){if(Mg(e)){var t=e;return t[t.length-1]}}var lZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function cZ(e,t){const n=C0(e,"shape"),r=C0(e,"color"),i=n?n.clone():null,s=[];for(const[u,h]of t){const p=u.type,y=((r==null?void 0:r.getOptions().domain.length)>0?r==null?void 0:r.getOptions().domain:h.data).map((b,w)=>{var R;return i?i.map(b||"point"):((R=u==null?void 0:u.style)===null||R===void 0?void 0:R.shape)||h.defaultShape||"point"});typeof p=="string"&&s.push([p,y])}if(s.length===0)return["point",["point"]];if(s.length===1||!n)return s[0];const{range:l}=n.getOptions();return s.map(([u,h])=>{let p=0;for(let m=0;m<s.length;m++){const y=l[m%l.length];h[m]===y&&p++}return[p/h.length,[u,h]]}).sort((u,h)=>h[0]-u[0])[0][1]}function uZ(e,t){const{scales:n,library:r,markState:i}=t,[s,l]=cZ(n,i),{itemMarker:u,itemMarkerSize:h}=e,p=(b,w)=>{var R,P,I;const N=((I=(P=(R=r[`mark.${s}`])===null||R===void 0?void 0:R.props)===null||P===void 0?void 0:P.shape[b])===null||I===void 0?void 0:I.props.defaultMarker)||Yx(b.split(".")),z=typeof h=="function"?h(w):h;return()=>yV(N,{color:w.color})(0,0,z)},m=b=>`${l[b]}`;return C0(n,"shape")&&!u?(b,w)=>p(m(w),b):typeof u=="function"?(b,w)=>{const R=u(b.id,w);return typeof R=="string"?p(R,b):R}:(b,w)=>p(u||m(w),b)}function fZ(e){const t=C0(e,"opacity");if(t){const{range:n}=t.getOptions();return(r,i)=>n[i]}}function hZ(e,t){const n=C0(e,"size");return n instanceof CT?n.map(NaN)*2:t}function dZ(e,t){const{labelFormatter:n=b=>`${b}`}=e,{scales:r,theme:i}=t,s=i.legendCategory.itemMarkerSize,l=hZ(r,s),u={itemMarker:uZ(Object.assign(Object.assign({},e),{itemMarkerSize:l}),t),itemMarkerSize:l,itemMarkerOpacity:fZ(r)},h=typeof n=="string"?Wm(n):n,p=C0(r,"color"),m=fd(r),y=p?b=>p.map(b):()=>t.theme.color;return Object.assign(Object.assign({},u),{data:m.map(b=>({id:b,label:h(b),color:y(b)}))})}function pZ(e,t,n){const{position:r}=t;if(r==="center"){const{bbox:l}=e,{width:u,height:h}=l;return{width:u,height:h}}const{width:i,height:s}=sS(e,t,n);return{width:i,height:s}}const j3=e=>{const{labelFormatter:t,layout:n,order:r,orientation:i,position:s,size:l,title:u,cols:h,itemMarker:p}=e,m=lZ(e,["labelFormatter","layout","order","orientation","position","size","title","cols","itemMarker"]),{gridRow:y}=m;return b=>{const{value:w,theme:R}=b,{bbox:P}=w,{width:I,height:N}=pZ(w,e,j3),z=oS(s,n),Z=Object.assign(Object.assign(Object.assign(Object.assign({orientation:["right","left","center"].includes(s)?"vertical":"horizontal",width:I,height:N,layout:h!==void 0?"grid":"flex"},h!==void 0&&{gridCol:h}),y!==void 0&&{gridRow:y}),{titleText:Yp(u)}),dZ(e,b)),{legendCategory:Y={}}=R,$=b_(Object.assign({},Y,Z,m)),J=new sx({style:Object.assign(Object.assign({x:P.x,y:P.y,width:P.width,height:P.height},z),{subOptions:$})});return J.appendChild(new sZ({className:"legend-category",style:$})),J}};j3.props={defaultPosition:"top",defaultOrder:1,defaultSize:40,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const BD=e=>()=>new ki;BD.props={};var mZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function FD(e,t,n,r){switch(r){case"center":return{x:e+n/2,y:t,textAlign:"middle"};case"right":return{x:e+n,y:t,textAlign:"right"};default:return{x:e,y:t,textAlign:"left"}}}const vZ=qy({render(e,t){const{width:n,title:r,subtitle:i,spacing:s=2,align:l="left",x:u,y:h}=e,p=mZ(e,["width","title","subtitle","spacing","align","x","y"]);t.style.transform=`translate(${u}, ${h})`;const m=uo(p,"title"),y=uo(p,"subtitle"),w=ax(t,".title","text").attr("className","title").call(ea,Object.assign(Object.assign(Object.assign({},FD(0,0,n,l)),{fontSize:14,textBaseline:"top",text:r}),m)).node().getLocalBounds();ax(t,".sub-title","text").attr("className","sub-title").call(R=>{if(!i)return R.node().remove();R.node().attr(Object.assign(Object.assign(Object.assign({},FD(0,w.max[1]+s,n,l)),{fontSize:12,textBaseline:"top",text:i}),y))})}}),kD=e=>({value:t,theme:n})=>{const{x:r,y:i,width:s,height:l}=t.bbox;return new vZ({style:ri({},n.title,Object.assign({x:r,y:i,width:s,height:l},e))})};kD.props={defaultPosition:"top",defaultOrder:2,defaultSize:36,defaultCrossPadding:[20,20],defaultPadding:[12,12]};var V3=function(e){if(typeof e!="object"||e===null)return e;var t;if(_s(e)){t=[];for(var n=0,r=e.length;n<r;n++)typeof e[n]=="object"&&e[n]!=null?t[n]=V3(e[n]):t[n]=e[n]}else{t={};for(var i in e)typeof e[i]=="object"&&e[i]!=null?t[i]=V3(e[i]):t[i]=e[i]}return t},H3=V3,gZ=function(e){(0,j.ZT)(t,e);function t(n){var r=this,i=n.style,s=(0,j._T)(n,["style"]);return r=e.call(this,ri({},{type:"column"},(0,j.pi)({style:i},s)))||this,r.columnsGroup=new ki({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return t.prototype.render=function(){var n=this.attributes,r=n.columns,i=n.x,s=n.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(s,")"),es(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(l){return l.append("rect").attr("className","column").each(function(u){this.attr(u)})},function(l){return l.each(function(u){this.attr(u)})},function(l){return l.remove()})},t.prototype.update=function(n){this.attr(em({},this.attributes,n)),this.render()},t.prototype.clear=function(){this.removeChildren()},t}(jr),yZ=function(e){(0,j.ZT)(t,e);function t(n){var r=this,i=n.style,s=(0,j._T)(n,["style"]);return r=e.call(this,ri({},{type:"lines"},(0,j.pi)({style:i},s)))||this,r.linesGroup=r.appendChild(new ki),r.areasGroup=r.appendChild(new ki),r.render(),r}return t.prototype.render=function(){var n=this.attributes,r=n.lines,i=n.areas,s=n.x,l=n.y;this.style.transform="translate(".concat(s,", ").concat(l,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},t.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},t.prototype.update=function(n){this.attr(em({},this.attributes,n)),this.render()},t.prototype.renderLines=function(n){es(this.linesGroup).selectAll(".line").data(n).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},t.prototype.renderAreas=function(n){es(this.linesGroup).selectAll(".area").data(n).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},t}(jr);function _Z(e,t,n,r){var i,s=[],l=!!r,u,h,p=[1/0,1/0],m=[-1/0,-1/0],y,b,w;if(l){i=(0,j.CR)(r,2),p=i[0],m=i[1];for(var R=0,P=e.length;R<P;R+=1){var I=e[R];p=Fv(p,I),m=S0(m,I)}}for(var R=0,N=e.length;R<N;R+=1){var I=e[R];if(R===0&&!n)w=I;else if(R===N-1&&!n)b=I,s.push(w),s.push(b);else{var z=[R?R-1:N-1,R-1][n?0:1];u=e[z],h=e[n?(R+1)%N:R+1];var Z=[0,0];Z=kb(h,u),Z=tm(Z,t);var Y=Xy(I,u),$=Xy(I,h),J=Y+$;J!==0&&(Y/=J,$/=J);var ae=tm(Z,-Y),pe=tm(Z,$);b=Gy(I,ae),y=Gy(I,pe),y=Fv(y,S0(h,I)),y=S0(y,Fv(h,I)),ae=kb(y,I),ae=tm(ae,-Y/$),b=Gy(I,ae),b=Fv(b,S0(u,I)),b=S0(b,Fv(u,I)),pe=kb(I,b),pe=tm(pe,$/Y),y=Gy(I,pe),l&&(b=S0(b,p),b=Fv(b,m),y=S0(y,p),y=Fv(y,m)),s.push(w),s.push(b),w=y}}return n&&s.push(s.shift()),s}function bZ(e,t,n){var r;t===void 0&&(t=!1),n===void 0&&(n=[[0,0],[1,1]]);for(var i=!!t,s=[],l=0,u=e.length;l<u;l+=2)s.push([e[l],e[l+1]]);for(var h=_Z(s,.4,i,n),p=s.length,m=[],y,b,w,l=0;l<p-1;l+=1)y=h[l*2],b=h[l*2+1],w=s[l+1],m.push(["C",y[0],y[1],b[0],b[1],w[0],w[1]]);return i&&(y=h[p],b=h[p+1],r=(0,j.CR)(s,1),w=r[0],m.push(["C",y[0],y[1],b[0],b[1],w[0],w[1]])),m}function xZ(e,t){var n,r=t.x,i=t.y,s=(0,j.CR)(i.getOptions().range||[0,0],2),l=s[0],u=s[1];return u>l&&(n=(0,j.CR)([l,u],2),u=n[0],l=n[1]),e.map(function(h){var p=h.map(function(m,y){return[r.map(y),(0,ya.Z)(i.map(m),u,l)]});return p})}function $x(e,t){t===void 0&&(t=!1);var n=t?e.length-1:0,r=e.map(function(i,s){return(0,j.ev)([s===n?"M":"L"],(0,j.CR)(i),!1)});return t?r.reverse():r}function PT(e,t){if(t===void 0&&(t=!1),e.length<=2)return $x(e);for(var n=[],r=e.length,i=0;i<r;i+=1){var s=t?e[r-i-1]:e[i];EE(s,n.slice(-2))||n.push.apply(n,(0,j.ev)([],(0,j.CR)(s),!1))}var l=bZ(n,!1);return t?l.unshift((0,j.ev)(["M"],(0,j.CR)(e[r-1]),!1)):l.unshift((0,j.ev)(["M"],(0,j.CR)(e[0]),!1)),l}function Z3(e,t,n){var r=H3(e);return r.push(["L",t,n],["L",0,n],["Z"]),r}function EZ(e,t,n,r){return e.map(function(i){return Z3(t?PT(i):$x(i),n,r)})}function SZ(e,t,n){for(var r=[],i=e.length-1;i>=0;i-=1){var s=e[i],l=$x(s),u=void 0;if(i===0)u=Z3(l,t,n);else{var h=e[i-1],p=$x(h,!0);p[0][0]="L",u=(0,j.ev)((0,j.ev)((0,j.ev)([],(0,j.CR)(l),!1),(0,j.CR)(p),!1),[["Z"]],!1)}r.push(u)}return r}function TZ(e,t,n){for(var r=[],i=e.length-1;i>=0;i-=1){var s=e[i],l=PT(s),u=void 0;if(i===0)u=Z3(l,t,n);else{var h=e[i-1],p=PT(h,!0),m=s[0];p[0][0]="L",u=(0,j.ev)((0,j.ev)((0,j.ev)([],(0,j.CR)(l),!1),(0,j.CR)(p),!1),[(0,j.ev)(["M"],(0,j.CR)(m),!1),["Z"]],!1)}r.push(u)}return r}var wZ=function(e,t){if(_s(e)){for(var n,r=1/0,i=0;i<e.length;i++){var s=e[i],l=Dh(t)?t(s):s[t];l<r&&(n=s,r=l)}return n}},AZ=function(e,t){if(_s(e)){for(var n,r=-1/0,i=0;i<e.length;i++){var s=e[i],l=Dh(t)?t(s):s[t];l>r&&(n=s,r=l)}return n}};function zD(e){return e.length===0?[0,0]:[au(wZ(e,function(t){return au(t)||0})),xc(AZ(e,function(t){return xc(t)||0}))]}function UD(e){for(var t=H3(e),n=t[0].length,r=(0,j.CR)([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],s=r[1],l=0;l<t.length;l+=1)for(var u=t[l],h=0;h<n;h+=1)u[h]>=0?(u[h]+=i[h],i[h]=u[h]):(u[h]+=s[h],s[h]=u[h]);return t}var CZ=function(e){(0,j.ZT)(t,e);function t(n){return e.call(this,n,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(t.prototype,"rawData",{get:function(){var n=this.attributes.data;if(!n||(n==null?void 0:n.length)===0)return[[]];var r=H3(n);return(0,dr.Z)(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.attributes.isStack?UD(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseline",{get:function(){var n=this.scales.y,r=(0,j.CR)(n.getOptions().domain||[0,0],2),i=r[0],s=r[1];return s<0?n.map(s):n.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"containerShape",{get:function(){var n=this.attributes,r=n.width,i=n.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linesStyle",{get:function(){var n=this,r=this.attributes,i=r.type,s=r.isStack,l=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var u=Os(this.attributes,"area"),h=Os(this.attributes,"line"),p=this.containerShape.width,m=this.data;if(m[0].length===0)return{lines:[],areas:[]};var y=this.scales,b=y.x,w=y.y,R=xZ(m,{type:"line",x:b,y:w}),P=[];if(u){var I=this.baseline;s?P=l?TZ(R,p,I):SZ(R,p,I):P=EZ(R,l,p,I)}return{lines:R.map(function(N,z){return(0,j.pi)({stroke:n.getColor(z),d:l?PT(N):$x(N)},h)}),areas:P.map(function(N,z){return(0,j.pi)({d:N,fill:n.getColor(z)},u)})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnsStyle",{get:function(){var n=this,r=Os(this.attributes,"column"),i=this.attributes,s=i.isStack,l=i.type,u=i.scale;if(l!=="column")throw new Error("columnsStyle can only be used in column type");var h=this.containerShape.height,p=this.rawData;if(!p)return{columns:[]};s&&(p=UD(p));var m=this.createScales(p),y=m.x,b=m.y,w=(0,j.CR)(zD(p),2),R=w[0],P=w[1],I=new Gf({domain:[0,P-(R>0?0:R)],range:[0,h*u]}),N=y.getBandWidth(),z=this.rawData;return{columns:p.map(function(Z,Y){return Z.map(function($,J){var ae=N/p.length,pe=function(){return{x:y.map(J)+ae*Y,y:$>=0?b.map($):b.map(0),width:ae,height:I.map(Math.abs($))}},Oe=function(){return{x:y.map(J),y:b.map($),width:N,height:I.map(z[Y][J])}};return(0,j.pi)((0,j.pi)({fill:n.getColor(Y)},r),s?Oe():pe())})})}},enumerable:!1,configurable:!0}),t.prototype.render=function(n,r){wA(r,".container","rect").attr("className","container").node();var i=n.type,s=n.x,l=n.y,u="spark".concat(i),h=(0,j.pi)({x:s,y:l},i==="line"?this.linesStyle:this.columnsStyle);es(r).selectAll(".spark").data([i]).join(function(p){return p.append(function(m){return m==="line"?new yZ({className:u,style:h}):new gZ({className:u,style:h})}).attr("className","spark ".concat(u))},function(p){return p.update(h)},function(p){return p.remove()})},t.prototype.getColor=function(n){var r=this.attributes.color;return _s(r)?r[n%r.length]:Dh(r)?r.call(null,n):r},t.prototype.createScales=function(n){var r,i,s=this.attributes,l=s.type,u=s.scale,h=s.range,p=h===void 0?[]:h,m=s.spacing,y=this.containerShape,b=y.width,w=y.height,R=(0,j.CR)(zD(n),2),P=R[0],I=R[1],N=new Gf({domain:[(r=p[0])!==null&&r!==void 0?r:P,(i=p[1])!==null&&i!==void 0?i:I],range:[w,w*(1-u)]});return l==="line"?{type:l,x:new Gf({domain:[0,n[0].length-1],range:[0,b]}),y:N}:{type:l,x:new ay({domain:n[0].map(function(z,Z){return Z}),range:[0,b],paddingInner:m,paddingOuter:m/2,align:.5}),y:N}},t.tag="sparkline",t}(Mf),jD=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n,(0,j.pi)((0,j.pi)((0,j.pi)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},T0(R_,"handle")),T0(O_,"handleIcon")),T0(mS,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(s){s.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal(A_(s));var l=r.availableSpace,u=l.x,h=l.y,p=r.getBBox(),m=p.x,y=p.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([u,h])-r.getOrientVal([+m,+y])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var s=r.attributes,l=s.slidable,u=s.brushable,h=s.type;i.stopPropagation();var p=r.getOrientVal(A_(i)),m=p-r.prevPos;if(m){var y=r.getRatio(m);switch(r.target){case"start":l&&r.setValuesOffset(y);break;case"end":l&&r.setValuesOffset(0,y);break;case"selection":l&&r.setValuesOffset(y,y);break;case"track":if(!u)return;r.selectionWidth+=y,h==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=p}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var s=r.attributes,l=s.onChange,u=s.type,h=u==="range"?i:i[1],p=u==="range"?r.getValues():r.getValues()[1],m=new Va("valuechange",{detail:{oldValue:h,value:p}});r.dispatchEvent(m),l==null||l(p)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(t.prototype,"values",{get:function(){return this.attributes.values},set:function(n){this.attributes.values=this.clampValues(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sparklineStyle",{get:function(){var n=this.attributes.orientation;if(n!=="horizontal")return null;var r=Os(this.attributes,"sparkline");return(0,j.pi)((0,j.pi)({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var n=this.attributes,r=n.trackLength,i=n.trackSize,s=(0,j.CR)(this.getOrientVal([[r,i],[i,r]]),2),l=s[0],u=s[1];return{width:l,height:u}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableSpace",{get:function(){var n=this.attributes,r=n.x,i=n.y,s=n.padding,l=(0,j.CR)(Pf(s),4),u=l[0],h=l[1],p=l[2],m=l[3],y=this.shape,b=y.width,w=y.height;return{x:m,y:u,width:b-(m+h),height:w-(u+p)}},enumerable:!1,configurable:!0}),t.prototype.getValues=function(){return this.values},t.prototype.setValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1),this.attributes.values=n;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},t.prototype.updateSelectionArea=function(n){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(R0.selection.class).each(function(i,s){Zp(this,r[s],n)})},t.prototype.updateHandlesPosition=function(n){this.attributes.showHandle&&(this.startHandle&&Zp(this.startHandle,this.getHandleStyle("start"),n),this.endHandle&&Zp(this.endHandle,this.getHandleStyle("end"),n))},t.prototype.innerSetValues=function(n,r){n===void 0&&(n=[0,0]),r===void 0&&(r=!1);var i=this.values,s=this.clampValues(n);this.attributes.values=s,this.setValues(s),r&&this.onValueChange(i)},t.prototype.renderTrack=function(n){var r=this.attributes,i=r.x,s=r.y,l=Os(this.attributes,"track");this.trackShape=es(n).maybeAppendByClassName(R0.track,"rect").styles((0,j.pi)((0,j.pi)({x:i,y:s},this.shape),l))},t.prototype.renderBrushArea=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.brushable;this.brushArea=es(n).maybeAppendByClassName(R0.brushArea,"rect").styles((0,j.pi)({x:i,y:s,fill:"transparent",cursor:l?"crosshair":"default"},this.shape))},t.prototype.renderSparkline=function(n){var r=this,i=this.attributes,s=i.x,l=i.y,u=i.orientation,h=es(n).maybeAppendByClassName(R0.sparklineGroup,"g");Lh(u==="horizontal",h,function(p){var m=(0,j.pi)((0,j.pi)({},r.sparklineStyle),{x:s,y:l});p.maybeAppendByClassName(R0.sparkline,function(){return new CZ({style:m})}).update(m)})},t.prototype.renderHandles=function(){var n=this,r,i=this.attributes,s=i.showHandle,l=i.type,u=l==="range"?["start","end"]:["end"],h=s?u:[],p=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(R0.handle.class).data(h.map(function(m){return{type:m}}),function(m){return m.type}).join(function(m){return m.append(function(y){var b=y.type;return new M_({style:n.getHandleStyle(b)})}).each(function(y){var b=y.type;this.attr("class","".concat(R0.handle.name," ").concat(b,"-handle"));var w="".concat(b,"Handle");p[w]=this,this.addEventListener("pointerdown",p.onDragStart(b))})},function(m){return m.each(function(y){var b=y.type;this.update(p.getHandleStyle(b))})},function(m){return m.each(function(y){var b=y.type,w="".concat(b,"Handle");p[w]=void 0}).remove()})},t.prototype.renderSelection=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.type,u=r.selectionType;this.foregroundGroup=es(n).maybeAppendByClassName(R0.foreground,"g");var h=Os(this.attributes,"selection"),p=function(y){return y.style("visibility",function(b){return b.show?"visible":"hidden"}).style("cursor",function(b){return u==="select"?"grab":u==="invert"?"crosshair":"default"}).styles((0,j.pi)((0,j.pi)({},h),{transform:"translate(".concat(i,", ").concat(s,")")}))},m=this;this.foregroundGroup.selectAll(R0.selection.class).data(l==="value"?[]:this.calcSelectionArea().map(function(y,b){return{style:(0,j.pi)({},y),index:b,show:u==="select"?b===1:b!==1}}),function(y){return y.index}).join(function(y){return y.append("rect").attr("className",R0.selection.name).call(p).each(function(b,w){var R=this;w===1?(m.selectionShape=es(this),this.on("pointerdown",function(P){R.attr("cursor","grabbing"),m.onDragStart("selection")(P)}),m.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),m.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),m.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){R.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){R.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){R.attr("cursor","pointer")})):this.on("pointerdown",m.onDragStart("track"))})},function(y){return y.call(p)},function(y){return y.remove()}),this.updateSelectionArea(!1),this.renderHandles()},t.prototype.render=function(n,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},t.prototype.clampValues=function(n,r){var i;r===void 0&&(r=4);var s=(0,j.CR)(this.range,2),l=s[0],u=s[1],h=(0,j.CR)(this.getValues().map(function(I){return Zv(I,r)}),2),p=h[0],m=h[1],y=Array.isArray(n)?n:[p,n!=null?n:m],b=(0,j.CR)((y||[p,m]).map(function(I){return Zv(I,r)}),2),w=b[0],R=b[1];if(this.attributes.type==="value")return[0,(0,ya.Z)(R,l,u)];w>R&&(i=(0,j.CR)([R,w],2),w=i[0],R=i[1]);var P=R-w;return P>u-l?[l,u]:w<l?p===l&&m===R?[l,R]:[l,P+l]:R>u?m===u&&p===w?[w,u]:[u-P,u]:[w,R]},t.prototype.calcSelectionArea=function(n){var r=(0,j.CR)(this.clampValues(n),2),i=r[0],s=r[1],l=this.availableSpace,u=l.x,h=l.y,p=l.width,m=l.height;return this.getOrientVal([[{y:h,height:m,x:u,width:i*p},{y:h,height:m,x:i*p+u,width:(s-i)*p},{y:h,height:m,x:s*p,width:(1-s)*p}],[{x:u,width:p,y:h,height:i*m},{x:u,width:p,y:i*m+h,height:(s-i)*m},{x:u,width:p,y:s*m,height:(1-s)*m}]])},t.prototype.calcHandlePosition=function(n){var r=this.attributes.handleIconOffset,i=this.availableSpace,s=i.x,l=i.y,u=i.width,h=i.height,p=(0,j.CR)(this.clampValues(),2),m=p[0],y=p[1],b=n==="start"?-r:r,w=(n==="start"?m:y)*this.getOrientVal([u,h])+b;return{x:s+this.getOrientVal([w,u/2]),y:l+this.getOrientVal([h/2,w])}},t.prototype.inferTextStyle=function(n){var r=this.attributes.orientation;return r==="horizontal"?{}:n==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:n==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},t.prototype.calcHandleText=function(n){var r,i=this.attributes,s=i.type,l=i.orientation,u=i.formatter,h=i.autoFitLabel,p=Os(this.attributes,"handle"),m=Os(p,"label"),y=p.spacing,b=this.getHandleSize(),w=this.clampValues(),R=n==="start"?w[0]:w[1],P=u(R),I=new Fb({style:(0,j.pi)((0,j.pi)((0,j.pi)({},m),this.inferTextStyle(n)),{text:P})}),N=I.getBBox(),z=N.width,Z=N.height;if(I.destroy(),!h){if(s==="value")return{text:P,x:0,y:-Z-y};var Y=y+b+(l==="horizontal"?z/2:0);return r={text:P},r[l==="horizontal"?"x":"y"]=n==="start"?-Y:Y,r}var $=0,J=0,ae=this.availableSpace,pe=ae.width,Oe=ae.height,Ve=this.calcSelectionArea()[1],Ke=Ve.x,lt=Ve.y,Ge=Ve.width,rt=Ve.height,st=y+b;if(l==="horizontal"){var ut=st+z/2;if(n==="start"){var jt=Ke-st-z;$=jt>0?-ut:ut}else{var At=pe-Ke-Ge-st>z;$=At?ut:-ut}}else{var zt=st,wn=Z+st;n==="start"?J=lt-b>Z?-wn:zt:J=Oe-(lt+rt)-b>Z?wn:-zt}return{x:$,y:J,text:P}},t.prototype.getHandleLabelStyle=function(n){var r=Os(this.attributes,"handleLabel");return(0,j.pi)((0,j.pi)((0,j.pi)({},r),this.calcHandleText(n)),this.inferTextStyle(n))},t.prototype.getHandleIconStyle=function(){var n=this.attributes.handleIconShape,r=Os(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),s=this.getHandleSize();return(0,j.pi)({cursor:i,shape:n,size:s},r)},t.prototype.getHandleStyle=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.showLabel,u=r.showLabelOnInteraction,h=r.orientation,p=this.calcHandlePosition(n),m=p.x,y=p.y,b=this.calcHandleText(n),w=l;return!l&&u&&(this.target?w=!0:w=!1),(0,j.pi)((0,j.pi)((0,j.pi)({},T0(this.getHandleIconStyle(),"icon")),T0((0,j.pi)((0,j.pi)({},this.getHandleLabelStyle(n)),b),"label")),{transform:"translate(".concat(m+i,", ").concat(y+s,")"),orientation:h,showLabel:w,type:n,zIndex:3})},t.prototype.getHandleSize=function(){var n=this.attributes,r=n.handleIconSize,i=n.width,s=n.height;return r||Math.floor((this.getOrientVal([+s,+i])+4)/2.4)},t.prototype.getOrientVal=function(n){var r=(0,j.CR)(n,2),i=r[0],s=r[1],l=this.attributes.orientation;return l==="horizontal"?i:s},t.prototype.setValuesOffset=function(n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=this.attributes.type,l=(0,j.CR)(this.getValues(),2),u=l[0],h=l[1],p=s==="range"?n:0,m=[u+p,h+r].sort();i?this.setValues(m):this.innerSetValues(m,!0)},t.prototype.getRatio=function(n){var r=this.availableSpace,i=r.width,s=r.height;return n/this.getOrientVal([i,s])},t.prototype.dispatchCustomEvent=function(n,r,i){var s=this;n.on(r,function(l){l.stopPropagation(),s.dispatchEvent(new Va(i,{detail:l}))})},t.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var n=this.brushArea;this.dispatchCustomEvent(n,"click","trackClick"),this.dispatchCustomEvent(n,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(n,"pointerleave","trackMouseleave"),n.on("pointerdown",this.onDragStart("track"))},t.prototype.onScroll=function(n){var r=this.attributes.scrollable;if(r){var i=n.deltaX,s=n.deltaY,l=s||i,u=this.getRatio(l);this.setValuesOffset(u,u,!0)}},t.tag="slider",t}(Mf),OZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function RZ(e,t,n){const{x:r,y:i,width:s,height:l}=e;if(t==="left")return[r+s-n,i];if(t==="right")return[r,i];if(t==="bottom")return[r,i];if(t==="top")return[r,i+l-n]}const Kx=e=>{const{orientation:t,labelFormatter:n,size:r,style:i={},position:s}=e,l=OZ(e,["orientation","labelFormatter","size","style","position"]);return u=>{var h;const{scales:[p],value:m,theme:y,coordinate:b}=u,{bbox:w}=m,{width:R,height:P}=w,{slider:I={}}=y,N=((h=p.getFormatter)===null||h===void 0?void 0:h.call(p))||(pe=>pe+""),z=typeof n=="string"?Wm(n):n,Z=t==="horizontal",Y=pc(b)&&Z,{trackSize:$=I.trackSize}=i,[J,ae]=RZ(w,s,$);return new jD({className:"slider",style:Object.assign({},I,Object.assign(Object.assign({x:J,y:ae,trackLength:Z?R:P,orientation:t,formatter:pe=>{const Oe=z||N,Ve=Y?1-pe:pe,Ke=j_(p,Ve,!0);return Oe(Ke)},sparklineData:PZ(e,u)},i),l))})}};function MZ(e,t){const[n]=Array.from(e.entries()).filter(([i])=>i.type==="line"||i.type==="area").filter(([i])=>i.slider).map(([i])=>{const{encode:s,slider:l}=i;if(l!=null&&l.x){const u=h=>{const p=s[h];return[h,p?p.value:void 0]};return Object.fromEntries(t.map(u))}});if(!(n!=null&&n.series))return n==null?void 0:n.y;const r=n.series.reduce((i,s,l)=>(i[s]=i[s]||[],i[s].push(n.y[l]),i),{});return Object.values(r)}function PZ(e,t){const{markState:n}=t;return _s(e.sparklineData)?e.sparklineData:MZ(n,["y","series"])}Kx.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const VD=e=>Kx(Object.assign(Object.assign({},e),{orientation:"horizontal"}));VD.props=Object.assign(Object.assign({},Kx.props),{defaultPosition:"bottom"});const HD=e=>Kx(Object.assign(Object.assign({},e),{orientation:"vertical"}));HD.props=Object.assign(Object.assign({},Kx.props),{defaultPosition:"left"});var IZ=function(e){(0,j.ZT)(t,e);function t(n){var r=e.call(this,n,{x:0,y:0,isRound:!0,orientation:"vertical",padding:[2,2,2,2],scrollable:!0,slidable:!0,thumbCursor:"default",trackSize:10,value:0})||this;return r.range=[0,1],r.onValueChange=function(i){var s=r.attributes.value;if(i!==s){var l={detail:{oldValue:i,value:s}};r.dispatchEvent(new Va("scroll",l)),r.dispatchEvent(new Va("valuechange",l))}},r.onTrackClick=function(i){var s=r.attributes.slidable;if(s){var l=(0,j.CR)(r.getLocalPosition(),2),u=l[0],h=l[1],p=(0,j.CR)(r.padding,4),m=p[0],y=p[3],b=r.getOrientVal([u+y,h+m]),w=r.getOrientVal(A_(i)),R=(w-b)/r.trackLength;r.setValue(R,!0)}},r.onThumbMouseenter=function(i){r.dispatchEvent(new Va("thumbMouseenter",{detail:i.detail}))},r.onTrackMouseenter=function(i){r.dispatchEvent(new Va("trackMouseenter",{detail:i.detail}))},r.onThumbMouseleave=function(i){r.dispatchEvent(new Va("thumbMouseleave",{detail:i.detail}))},r.onTrackMouseleave=function(i){r.dispatchEvent(new Va("trackMouseleave",{detail:i.detail}))},r}return Object.defineProperty(t.prototype,"padding",{get:function(){var n=this.attributes.padding;return Pf(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var n=this.attributes.value,r=(0,j.CR)(this.range,2),i=r[0],s=r[1];return(0,ya.Z)(n,i,s)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trackLength",{get:function(){var n=this.attributes,r=n.viewportLength,i=n.trackLength,s=i===void 0?r:i;return s},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableSpace",{get:function(){var n=this.attributes.trackSize,r=this.trackLength,i=(0,j.CR)(this.padding,4),s=i[0],l=i[1],u=i[2],h=i[3],p=(0,j.CR)(this.getOrientVal([[r,n],[n,r]]),2),m=p[0],y=p[1];return{x:h,y:s,width:+m-(h+l),height:+y-(s+u)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trackRadius",{get:function(){var n=this.attributes,r=n.isRound,i=n.trackSize;return r?i/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbRadius",{get:function(){var n=this.attributes,r=n.isRound,i=n.thumbRadius;if(!r)return 0;var s=this.availableSpace,l=s.width,u=s.height;return i||this.getOrientVal([u,l])/2},enumerable:!1,configurable:!0}),t.prototype.getValues=function(n){n===void 0&&(n=this.value);var r=this.attributes,i=r.viewportLength,s=r.contentLength,l=i/s,u=(0,j.CR)(this.range,2),h=u[0],p=u[1],m=n*(p-h-l);return[m,m+l]},t.prototype.getValue=function(){return this.value},t.prototype.renderSlider=function(n){var r=this.attributes,i=r.x,s=r.y,l=r.orientation,u=r.trackSize,h=r.padding,p=r.slidable,m=Os(this.attributes,"track"),y=Os(this.attributes,"thumb"),b=(0,j.pi)((0,j.pi)({x:i,y:s,brushable:!1,orientation:l,padding:h,selectionRadius:this.thumbRadius,showHandle:!1,slidable:p,trackLength:this.trackLength,trackRadius:this.trackRadius,trackSize:u,values:this.getValues()},T0(m,"track")),T0(y,"selection"));this.slider=es(n).maybeAppendByClassName("scrollbar",function(){return new jD({style:b})}).update(b).node()},t.prototype.render=function(n,r){this.renderSlider(r)},t.prototype.setValue=function(n,r){r===void 0&&(r=!1);var i=this.attributes.value,s=(0,j.CR)(this.range,2),l=s[0],u=s[1];this.slider.setValues(this.getValues((0,ya.Z)(n,l,u)),r),this.onValueChange(i)},t.prototype.bindEvents=function(){var n=this;this.slider.addEventListener("trackClick",function(r){r.stopPropagation(),n.onTrackClick(r.detail)}),this.onHover()},t.prototype.getOrientVal=function(n){var r=this.attributes.orientation;return r==="horizontal"?n[0]:n[1]},t.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},t.tag="scrollbar",t}(Mf),LZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const qx=e=>{const{orientation:t,labelFormatter:n,style:r}=e,i=LZ(e,["orientation","labelFormatter","style"]);return({scales:[s],value:l,theme:u})=>{const{bbox:h}=l,{x:p,y:m,width:y,height:b}=h,{scrollbar:w={}}=u,{ratio:R,range:P}=s.getOptions(),I=t==="horizontal"?y:b,N=I/R,[z,Z]=P,Y=Z>z?0:1;return new IZ({className:"g2-scrollbar",style:Object.assign({},w,Object.assign(Object.assign(Object.assign(Object.assign({},r),{x:p,y:m,trackLength:I,value:Y}),i),{orientation:t,contentLength:N,viewportLength:I}))})}};qx.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1,defaultCrossPadding:[12,12],defaultPadding:[12,12]};const ZD=e=>qx(Object.assign(Object.assign({},e),{orientation:"horizontal"}));ZD.props=Object.assign(Object.assign({},qx.props),{defaultPosition:"bottom"});const WD=e=>qx(Object.assign(Object.assign({},e),{orientation:"vertical"}));WD.props=Object.assign(Object.assign({},qx.props),{defaultPosition:"left"});const W3=(e,t)=>{const{coordinate:r}=t;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[b,w]=pc(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],R=[{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.01},{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y}];return u.animate(R,Object.assign(Object.assign({},l),e))}},DZ=(e,t)=>{const{coordinate:r}=t;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[b,w]=pc(r)?["left bottom",`scale(1, ${1e-4})`]:["left top",`scale(${1e-4}, 1)`],R=[{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:b},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.99},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(R,Object.assign(Object.assign({},l),e))}},GD=(e,t)=>{const{coordinate:r}=t;return Es.registerProperty({name:"scaleInYRadius",inherits:!1,initialValue:"",interpolable:!0,syntax:vo.NUMBER}),(i,s,l)=>{const[u]=i,h=m=>{const{__data__:y,style:b}=m,{radius:w=0,inset:R=0,fillOpacity:P=1,strokeOpacity:I=1,opacity:N=1}=b,{points:z,y:Z,y1:Y}=y,$=Gv(r,z,[Z,Y]),{innerRadius:J,outerRadius:ae}=$,pe=HS().cornerRadius(w).padAngle(R*Math.PI/180),Oe=new Mo({}),Ve=Ge=>(Oe.attr({d:pe(Ge)}),lg(Oe)),Ke=[{scaleInYRadius:J+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{scaleInYRadius:J+1e-4,fillOpacity:P,strokeOpacity:I,opacity:N,offset:.01},{scaleInYRadius:ae,fillOpacity:P,strokeOpacity:I,opacity:N}],lt=m.animate(Ke,Object.assign(Object.assign({},l),e));return lt.onframe=function(){m.style.d=Ve(Object.assign(Object.assign({},$),{outerRadius:Number(m.style.scaleInYRadius)}))},lt.onfinish=function(){m.style.d=Ve(Object.assign(Object.assign({},$),{outerRadius:ae}))},lt},p=m=>{const{style:y}=m,{transform:b="",fillOpacity:w=1,strokeOpacity:R=1,opacity:P=1}=y,[I,N]=pc(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],z=[{transform:`${b} ${N}`.trimStart(),transformOrigin:I,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${b} ${N}`.trimStart(),transformOrigin:I,fillOpacity:w,strokeOpacity:R,opacity:P,offset:.01},{transform:`${b} scale(1, 1)`.trimStart(),transformOrigin:I,fillOpacity:w,strokeOpacity:R,opacity:P}];return m.animate(z,Object.assign(Object.assign({},l),e))};return Nl(r)?h(u):p(u)}},NZ=(e,t)=>{const{coordinate:r}=t;return(i,s,l)=>{const[u]=i,{transform:h="",fillOpacity:p=1,strokeOpacity:m=1,opacity:y=1}=u.style,[b,w]=pc(r)?["left top",`scale(${1e-4}, 1)`]:["left bottom",`scale(1, ${1e-4})`],R=[{transform:`${h} scale(1, 1)`.trimStart(),transformOrigin:b},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:p,strokeOpacity:m,opacity:y,offset:.99},{transform:`${h} ${w}`.trimStart(),transformOrigin:b,fillOpacity:0,strokeOpacity:0,opacity:0}];return u.animate(R,Object.assign(Object.assign({},l),e))}},XD=(e,t)=>{Es.registerProperty({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:vo.NUMBER});const{coordinate:r}=t;return(i,s,l)=>{const[u]=i;if(!Nl(r))return W3(e,t)(i,s,l);const{__data__:h,style:p}=u,{radius:m=0,inset:y=0,fillOpacity:b=1,strokeOpacity:w=1,opacity:R=1}=p,{points:P,y:I,y1:N}=h,z=HS().cornerRadius(m).padAngle(y*Math.PI/180),Z=Gv(r,P,[I,N]),{startAngle:Y,endAngle:$}=Z,J=[{waveInArcAngle:Y+1e-4,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:Y+1e-4,fillOpacity:b,strokeOpacity:w,opacity:R,offset:.01},{waveInArcAngle:$,fillOpacity:b,strokeOpacity:w,opacity:R}],ae=u.animate(J,Object.assign(Object.assign({},l),e));return ae.onframe=function(){u.style.d=z(Object.assign(Object.assign({},Z),{endAngle:Number(u.style.waveInArcAngle)}))},ae.onfinish=function(){u.style.d=z(Object.assign(Object.assign({},Z),{endAngle:$}))},ae}};XD.props={};const YD=e=>(t,n,r)=>{const[i]=t,{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=i.style,h=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:s,strokeOpacity:l,opacity:u}];return i.animate(h,Object.assign(Object.assign({},r),e))};YD.props={};const $D=e=>(t,n,r)=>{const[i]=t,{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=i.style,h=[{fillOpacity:s,strokeOpacity:l,opacity:u},{fillOpacity:0,strokeOpacity:0,opacity:0}];return i.animate(h,Object.assign(Object.assign({},r),e))};$D.props={};const BZ=e=>(n,r,i)=>{const[s]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:h=1,opacity:p=1}=s.style,m="center center",y=[{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p,offset:.01},{transform:`${l} scale(1)`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p}];return s.animate(y,Object.assign(Object.assign({},i),e))},FZ=e=>(n,r,i)=>{const[s]=n,{transform:l="",fillOpacity:u=1,strokeOpacity:h=1,opacity:p=1}=s.style,m="center center",y=[{transform:`${l} scale(1)`.trimStart(),transformOrigin:m},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:u,strokeOpacity:h,opacity:p,offset:.99},{transform:`${l} scale(${1e-4})`.trimStart(),transformOrigin:m,fillOpacity:0,strokeOpacity:0,opacity:0}];return s.animate(y,Object.assign(Object.assign({},i),e))},KD=e=>(t,n,r)=>{var i,s;const[l]=t,u=((s=(i=l).getTotalLength)===null||s===void 0?void 0:s.call(i))||0,h=[{lineDash:[0,u]},{lineDash:[u,0]}];return l.animate(h,Object.assign(Object.assign({},r),e))};KD.props={};const kZ={opacity:1,strokeOpacity:1,fillOpacity:1,lineWidth:0,x:0,y:0,cx:0,cy:0,r:0,rx:0,ry:0,width:0,height:0},zZ={[Yr.CIRCLE]:["cx","cy","r"],[Yr.ELLIPSE]:["cx","cy","rx","ry"],[Yr.RECT]:["x","y","width","height"],[Yr.IMAGE]:["x","y","width","height"],[Yr.LINE]:["x1","y1","x2","y2"],[Yr.POLYLINE]:["points"],[Yr.POLYGON]:["points"]};function ib(e,t,n=!1){const r={};for(const i of t){const s=e.style[i];s?r[i]=s:n&&(r[i]=kZ[i])}return r}const Qx=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"];function G3(e){const{min:t,max:n}=e.getLocalBounds(),[r,i]=t,[s,l]=n,u=l-i,h=s-r;return[r,i,h,u]}function UZ(e){const[t,n,r,i]=e;return`
    M ${t} ${n}
    L ${t+r} ${n}
    L ${t+r} ${n+i}
    L ${t} ${n+i}
    Z
  `}function jZ(e,t){const[n,r,i,s]=G3(e),l=s/i,u=Math.ceil(Math.sqrt(t/l)),h=Math.ceil(t/u),p=[],m=s/h;let y=0,b=t;for(;b>0;){const w=Math.min(b,u),R=i/w;for(let P=0;P<w;P++){const I=n+P*R,N=r+y*m;p.push(UZ([I,N,R,m]))}b-=w,y+=1}return p}function VZ(e="pack"){return typeof e=="function"?e:jZ}function HZ(e,t,n){let{transform:r}=e.style;const{transform:i}=t.style;qD(t,e);let s=Qx;if(e.nodeName===Yr.GROUP){const[h,p,m,y]=G3(e),[b,w,R,P]=G3(t),I=h-b,N=p-w,z=m/R,Z=y/P;r=`translate(${I}, ${N}) scale(${z}, ${Z})`}else s=s.concat(zZ[e.nodeName]||[]);const l=[Object.assign({transform:r!=null?r:"none"},ib(e,s,!0)),Object.assign({transform:i!=null?i:"none"},ib(t,s,!0))];return t.animate(l,n)}function qD(e,t){e.__data__=t.__data__,e.className=t.className,e.markType=t.markType,t.parentNode.replaceChild(e,t)}function ZZ(e,t){const{nodeName:n}=e;if(n==="path")return e;const r=new Mo({style:Object.assign(Object.assign({},ib(e,Qx)),{d:t})});return qD(r,e),r}function QD(e,t){const n=e.indexOf(t),r=e.lastIndexOf(t);return n===r}function WZ(e){return!QD(e,"m")||!QD(e,"M")}function JD(e){const t=lg(e);if(t&&!WZ(t))return t}function X3(e,t,n,r){const{nodeName:i}=t,{nodeName:s}=n,l=JD(t),u=JD(n);if(i===s&&i!=="path"||(l===void 0||u===void 0))return HZ(t,n,r);const m=ZZ(e,l),y=[Object.assign({},ib(t,Qx)),Object.assign({},ib(n,Qx))];if(l!==u){y[0].d=l,y[1].d=u;const b=m.animate(y,r);return b.onfinish=()=>{const w=m.style.d;Ib(m,n),m.style.d=w,m.style.transform="none"},m.style.transform="none",b}return null}function GZ(e,t,n,r){e.style.visibility="hidden";const i=r(e,t.length);return t.map((s,l)=>{const u=new Mo({style:Object.assign({d:i[l]},ib(e,Qx))});return X3(s,u,s,n)})}function XZ(e,t,n,r){const i=r(t,e.length),{fillOpacity:s=1,strokeOpacity:l=1,opacity:u=1}=t.style,h=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:s,strokeOpacity:l,opacity:u}],p=t.animate(h,n);return[...e.map((y,b)=>{const w=new Mo({style:{d:i[b],fill:t.style.fill}});return X3(y,y,w,n)}),p]}const eN=e=>(t,n,r)=>{const i=VZ(e.split),s=Object.assign(Object.assign({},r),e),{length:l}=t,{length:u}=n;if(l===1&&u===1||l>1&&u>1){const[h]=t,[p]=n;return X3(h,h,p,s)}if(l===1&&u>1){const[h]=t;return GZ(h,n,s,i)}if(l>1&&u===1){const[h]=n;return XZ(t,h,s,i)}return null};eN.props={};const tN=(e,t)=>(n,r,i)=>{const[s]=n,{min:[l,u],halfExtents:h}=s.getLocalBounds(),p=h[0]*2,m=h[1]*2,y=new Mo({style:{d:`M${l},${u}L${l+p},${u}L${l+p},${u+m}L${l},${u+m}Z`}});return s.appendChild(y),s.style.clipPath=y,W3(e,t)([y],r,i)};tN.props={};const nN=(e,t)=>(n,r,i)=>{const[s]=n,{min:[l,u],halfExtents:h}=s.getLocalBounds(),p=h[0]*2,m=h[1]*2,y=new Mo({style:{d:`M${l},${u}L${l+p},${u}L${l+p},${u+m}L${l},${u+m}Z`}});return s.appendChild(y),s.style.clipPath=y,GD(e,t)([y],r,i)};nN.props={};var YZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function $Z(e,{elements:t,datum:n,groupKey:r=y=>y,link:i=!1,background:s=!1,delay:l=60,scale:u,coordinate:h,emitter:p,state:m={}}){var y;const b=t(e),w=new Set(b),R=Rc(b,r),P=Mx(b,n),[I,N]=HP(Object.assign({elements:b,valueof:P,link:i,coordinate:h},uo(m.active,"link"))),[z,Z,Y]=WP(Object.assign({document:e.ownerDocument,scale:u,coordinate:h,background:s,valueof:P},uo(m.active,"background"))),$=ri(m,{active:Object.assign({},((y=m.active)===null||y===void 0?void 0:y.offset)&&{transform:(...jt)=>{const At=m.active.offset(...jt),[,zt]=jt;return ZP(b[zt],At,h)}})}),{setState:J,removeState:ae,hasState:pe}=Yv($,P);let Oe;const Ve=jt=>{const{target:At,nativeEvent:zt=!0}=jt;if(!w.has(At))return;Oe&&clearTimeout(Oe);const wn=r(At),Hn=R.get(wn),rr=new Set(Hn);for(const or of b)rr.has(or)?pe(or,"active")||J(or,"active"):(J(or,"inactive"),N(or)),or!==At&&Z(or);z(At),I(Hn),zt&&p.emit("element:highlight",{nativeEvent:zt,data:{data:n(At),group:Hn.map(n)}})},Ke=()=>{Oe&&clearTimeout(Oe),Oe=setTimeout(()=>{lt(),Oe=null},l)},lt=(jt=!0)=>{for(const At of b)ae(At,"active","inactive"),Z(At),N(At);jt&&p.emit("element:unhighlight",{nativeEvent:jt})},Ge=jt=>{const{target:At}=jt;s&&!Y(At)||!s&&!w.has(At)||(l>0?Ke():lt())},rt=()=>{lt()};e.addEventListener("pointerover",Ve),e.addEventListener("pointerout",Ge),e.addEventListener("pointerleave",rt);const st=jt=>{const{nativeEvent:At}=jt;At||lt(!1)},ut=jt=>{const{nativeEvent:At}=jt;if(At)return;const{data:zt}=jt.data,wn=wO(b,zt,n);wn&&Ve({target:wn,nativeEvent:!1})};return p.on("element:highlight",ut),p.on("element:unhighlight",st),()=>{e.removeEventListener("pointerover",Ve),e.removeEventListener("pointerout",Ge),e.removeEventListener("pointerleave",rt),p.off("element:highlight",ut),p.off("element:unhighlight",st);for(const jt of b)Z(jt),N(jt)}}function IT(e){var{delay:t,createGroup:n,background:r=!1,link:i=!1}=e,s=YZ(e,["delay","createGroup","background","link"]);return(l,u,h)=>{const{container:p,view:m,options:y}=l,{scale:b,coordinate:w}=m,R=rv(p);return $Z(R,Object.assign({elements:ey,datum:u1(m),groupKey:n?n(m):void 0,coordinate:w,scale:b,state:H_(y,[["active",r?{}:{lineWidth:"1",stroke:"#000"}],"inactive"]),background:r,link:i,delay:t,emitter:h},s))}}IT.props={reapplyWhenUpdate:!0};function rN(e){return IT(Object.assign(Object.assign({},e),{createGroup:TO}))}rN.props={reapplyWhenUpdate:!0};function iN(e){return IT(Object.assign(Object.assign({},e),{createGroup:VP}))}iN.props={reapplyWhenUpdate:!0};var KZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function qZ(e,{elements:t,datum:n,groupKey:r=y=>y,link:i=!1,single:s=!1,coordinate:l,background:u=!1,scale:h,emitter:p,state:m={}}){var y;const b=t(e),w=new Set(b),R=Rc(b,r),P=Mx(b,n),[I,N]=HP(Object.assign({link:i,elements:b,valueof:P,coordinate:l},uo(m.selected,"link"))),[z,Z]=WP(Object.assign({document:e.ownerDocument,background:u,coordinate:l,scale:h,valueof:P},uo(m.selected,"background"))),Y=ri(m,{selected:Object.assign({},((y=m.selected)===null||y===void 0?void 0:y.offset)&&{transform:(...rt)=>{const st=m.selected.offset(...rt),[,ut]=rt;return ZP(b[ut],st,l)}})}),{setState:$,removeState:J,hasState:ae}=Yv(Y,P),pe=(rt=!0)=>{for(const st of b)J(st,"selected","unselected"),N(st),Z(st);rt&&p.emit("element:unselect",{nativeEvent:!0})},Oe=(rt,st,ut=!0)=>{if(ae(st,"selected"))pe();else{const jt=r(st),At=R.get(jt),zt=new Set(At);for(const wn of b)zt.has(wn)?$(wn,"selected"):($(wn,"unselected"),N(wn)),wn!==st&&Z(wn);if(I(At),z(st),!ut)return;p.emit("element:select",Object.assign(Object.assign({},rt),{nativeEvent:ut,data:{data:[n(st),...At.map(n)]}}))}},Ve=(rt,st,ut=!0)=>{const jt=r(st),At=R.get(jt),zt=new Set(At);if(ae(st,"selected")){if(!b.some(Hn=>!zt.has(Hn)&&ae(Hn,"selected")))return pe();for(const Hn of At)$(Hn,"unselected"),N(Hn),Z(Hn)}else{const wn=At.some(Hn=>ae(Hn,"selected"));for(const Hn of b)zt.has(Hn)?$(Hn,"selected"):ae(Hn,"selected")||$(Hn,"unselected");!wn&&i&&I(At),z(st)}ut&&p.emit("element:select",Object.assign(Object.assign({},rt),{nativeEvent:ut,data:{data:b.filter(wn=>ae(wn,"selected")).map(n)}}))},Ke=rt=>{const{target:st,nativeEvent:ut=!0}=rt;return w.has(st)?s?Oe(rt,st,ut):Ve(rt,st,ut):pe()};e.addEventListener("click",Ke);const lt=rt=>{const{nativeEvent:st,data:ut}=rt;if(st)return;const jt=s?ut.data.slice(0,1):ut.data;for(const At of jt){const zt=wO(b,At,n);Ke({target:zt,nativeEvent:!1})}},Ge=()=>{pe(!1)};return p.on("element:select",lt),p.on("element:unselect",Ge),()=>{for(const rt of b)N(rt);e.removeEventListener("click",Ke),p.off("element:select",lt),p.off("element:unselect",Ge)}}function LT(e){var{createGroup:t,background:n=!1,link:r=!1}=e,i=KZ(e,["createGroup","background","link"]);return(s,l,u)=>{const{container:h,view:p,options:m}=s,{coordinate:y,scale:b}=p,w=rv(h);return qZ(w,Object.assign({elements:ey,datum:u1(p),groupKey:t?t(p):void 0,coordinate:y,scale:b,state:H_(m,[["selected",n?{}:{lineWidth:"1",stroke:"#000"}],"unselected"]),background:n,link:r,emitter:u},i))}}LT.props={reapplyWhenUpdate:!0};function oN(e){return LT(Object.assign(Object.assign({},e),{createGroup:TO}))}oN.props={reapplyWhenUpdate:!0};function aN(e){return LT(Object.assign(Object.assign({},e),{createGroup:VP}))}aN.props={reapplyWhenUpdate:!0};var E1=function(e,t,n){var r,i,s,l,u=0;n||(n={});var h=function(){u=n.leading===!1?0:Date.now(),r=null,l=e.apply(i,s),r||(i=s=null)},p=function(){var m=Date.now();!u&&n.leading===!1&&(u=m);var y=t-(m-u);return i=this,s=arguments,y<=0||y>t?(r&&(clearTimeout(r),r=null),u=m,l=e.apply(i,s),r||(i=s=null)):!r&&n.trailing!==!1&&(r=setTimeout(h,y)),l};return p.cancel=function(){clearTimeout(r),u=0,r=i=s=null},p};function QZ(e){const{coordinate:t={}}=e,{transform:n=[]}=t,r=n.find(s=>s.type==="fisheye");if(r)return r;const i={type:"fisheye"};return n.push(i),t.transform=n,e.coordinate=t,i}function JZ({wait:e=30,leading:t,trailing:n=!1}){return r=>{const{options:i,update:s,setState:l,container:u}=r,h=rv(u),p=E1(m=>{const y=Rx(h,m);if(!y){l("fisheye"),s();return}l("fisheye",b=>{const w=ri({},b,{interaction:{tooltip:{preserve:!0}}});for(const N of w.marks)N.animate=!1;const[R,P]=y,I=QZ(w);return I.focusX=R,I.focusY=P,I.visual=!0,w}),s()},e,{leading:t,trailing:n});return h.addEventListener("pointerenter",p),h.addEventListener("pointermove",p),h.addEventListener("pointerleave",p),()=>{h.removeEventListener("pointerenter",p),h.removeEventListener("pointermove",p),h.removeEventListener("pointerleave",p)}}}var eW=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},tW=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function nW(e){const{transform:t=[]}=e,n=t.find(i=>i.type==="normalizeY");if(n)return n;const r={type:"normalizeY"};return t.push(r),e.transform=t,r}function rW(e,t,n){const[r]=Array.from(e.entries()).filter(([i])=>i.type===t).map(([i])=>{const{encode:s}=i,l=u=>{const h=s[u];return[u,h?h.value:void 0]};return Object.fromEntries(n.map(l))});return r}function sN(e){var{wait:t=20,leading:n,trailing:r=!1,labelFormatter:i=l=>`${l}`}=e,s=tW(e,["wait","leading","trailing","labelFormatter"]);return l=>{const{view:u,container:h,update:p,setState:m}=l,{markState:y,scale:b,coordinate:w}=u,R=rW(y,"line",["x","y","series"]);if(!R)return;const{y:P,x:I,series:N=[]}=R,z=P.map((jt,At)=>At),Z=Kp(z.map(jt=>I[jt])),Y=rv(h),$=h.getElementsByClassName(Ut),J=h.getElementsByClassName(Ft),pe=Rc(J,jt=>jt.__data__.key.split("-")[0]),Oe=new xa({style:Object.assign({x1:0,y1:0,x2:0,y2:Y.getAttribute("height"),stroke:"black",lineWidth:1},uo(s,"rule"))}),Ve=new Oa({style:Object.assign({x:0,y:Y.getAttribute("height"),text:"",fontSize:10},uo(s,"label"))});Oe.append(Ve),Y.appendChild(Oe);const Ke=(jt,At,zt)=>{const[wn]=jt.invert(zt),Hn=At.invert(wn);return Z[Uk(Z,Hn)]},lt=(jt,At)=>{Oe.setAttribute("x1",jt[0]),Oe.setAttribute("x2",jt[0]),Ve.setAttribute("text",i(At))};let Ge;const rt=jt=>eW(this,void 0,void 0,function*(){const{x:At}=b,zt=Ke(w,At,jt);lt(jt,zt),m("chartIndex",Hn=>{const rr=ri({},Hn),or=rr.marks.find(ti=>ti.type==="line"),ui=Ol(Mb(z,ti=>Ol(ti,Po=>+P[Po])/qp(ti,Po=>+P[Po]),ti=>N[ti]).values()),Qi=[1/ui,ui];ri(or,{scale:{y:{domain:Qi}}});const ii=nW(or);ii.groupBy="color",ii.basis=(ti,Po)=>{const Ji=ti[Qg(Vi=>I[+Vi]).center(ti,zt)];return Po[Ji]};for(const ti of rr.marks)ti.animate=!1;return rr}),Ge=(yield p("chartIndex")).view}),st=jt=>{const{scale:At,coordinate:zt}=Ge,{x:wn,y:Hn}=At,rr=Ke(zt,wn,jt);lt(jt,rr);for(const or of $){const{seriesIndex:Hr,key:ui}=or.__data__,Qi=Hr[Qg(Ko=>I[+Ko]).center(Hr,rr)],ii=[0,Hn.map(1)],ti=[0,Hn.map(P[Qi]/P[Hr[0]])],[,Po]=zt.map(ii),[,Ji]=zt.map(ti),Vi=Po-Ji;or.setAttribute("transform",`translate(0, ${Vi})`);const xo=pe.get(ui)||[];for(const Ko of xo)Ko.setAttribute("dy",Vi)}},ut=E1(jt=>{const At=Rx(Y,jt);At&&st(At)},t,{leading:n,trailing:r});return rt([0,0]),Y.addEventListener("pointerenter",ut),Y.addEventListener("pointermove",ut),Y.addEventListener("pointerleave",ut),()=>{Oe.remove(),Y.removeEventListener("pointerenter",ut),Y.removeEventListener("pointermove",ut),Y.removeEventListener("pointerleave",ut)}}}sN.props={reapplyWhenUpdate:!0};function Jx(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);return r}function e2(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function lN(e){var t=document.createElement("div");t.innerHTML=e;var n=t.childNodes[0];return n&&t.contains(n)&&t.removeChild(n),n}function iW(e,t){return!e||!t?e:e.replace(/\\?\{([^{}]+)\}/g,function(n,r){return n.charAt(0)==="\\"?n.slice(1):t[r]===void 0?"":t[r]})}var oW=iW,cN=function(e,t){if(t==null){e.innerHTML="";return}e.replaceChildren?Array.isArray(t)?e.replaceChildren.apply(e,(0,j.ev)([],(0,j.CR)(t),!1)):e.replaceChildren(t):(e.innerHTML="",Array.isArray(t)?t.forEach(function(n){return e.appendChild(n)}):e.appendChild(t))};function Y3(e){return e===void 0&&(e=""),{CONTAINER:"".concat(e,"tooltip"),TITLE:"".concat(e,"tooltip-title"),LIST:"".concat(e,"tooltip-list"),LIST_ITEM:"".concat(e,"tooltip-list-item"),NAME:"".concat(e,"tooltip-list-item-name"),MARKER:"".concat(e,"tooltip-list-item-marker"),NAME_LABEL:"".concat(e,"tooltip-list-item-name-label"),VALUE:"".concat(e,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(e,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(e,"tooltip-crosshair-y")}}var uN={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function aW(e){var t;e===void 0&&(e="");var n=Y3(e);return t={},t[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},t[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},t[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},t[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},t[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},t[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},t[".".concat(n.NAME_LABEL)]=(0,j.pi)({flex:1},uN),t[".".concat(n.VALUE)]=(0,j.pi)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},uN),t[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t}var sW=function(e){(0,j.ZT)(t,e);function t(n){var r=this,i,s,l=(s=(i=n.style)===null||i===void 0?void 0:i.template)===null||s===void 0?void 0:s.prefixCls,u=Y3(l);return r=e.call(this,n,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(u.CONTAINER,'"></div>'),title:'<div class="'.concat(u.TITLE,'"></div>'),item:'<li class="'.concat(u.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(u.NAME,`">
          <span class="`).concat(u.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(u.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(u.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:aW(l)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(t.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.element},Object.defineProperty(t.prototype,"elementSize",{get:function(){var n=this.element.offsetWidth,r=this.element.offsetHeight;return{width:n,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HTMLTooltipItemsElements",{get:function(){var n=this.attributes,r=n.data,i=n.template;return r.map(function(s,l){var u=s.name,h=u===void 0?"":u,p=s.color,m=p===void 0?"black":p,y=s.index,b=(0,j._T)(s,["name","color","index"]),w=(0,j.pi)({name:h,color:m,index:y!=null?y:l},b);return lN(oW(i.item,w))})},enumerable:!1,configurable:!0}),t.prototype.render=function(n,r){this.renderHTMLTooltipElement(),this.updatePosition()},t.prototype.destroy=function(){var n;(n=this.element)===null||n===void 0||n.remove(),e.prototype.destroy.call(this)},t.prototype.show=function(n,r){var i=this;if(n!==void 0&&r!==void 0){var s=this.element.style.visibility==="hidden",l=function(){i.attributes.x=n!=null?n:i.attributes.x,i.attributes.y=r!=null?r:i.attributes.y,i.updatePosition()};s?this.closeTransition(l):l()}this.element.style.visibility="visible"},t.prototype.hide=function(n,r){n===void 0&&(n=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(n,r)||(this.element.style.visibility="hidden")},t.prototype.initShape=function(){var n=this.attributes.template;this.element=lN(n.container),this.id&&this.element.setAttribute("id",this.id)},t.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var n=this.attributes.content;n&&(typeof n=="string"&&(this.element.innerHTML=n),cN(this.element,n))}},t.prototype.renderHTMLTooltipElement=function(){var n,r,i=this.attributes,s=i.template,l=i.title,u=i.enterable,h=i.style,p=i.content,m=Y3(s.prefixCls),y=this.element;if(this.element.style.pointerEvents=u?"auto":"none",p)this.renderCustomContent();else{l?(y.innerHTML=s.title,y.getElementsByClassName(m.TITLE)[0].innerHTML=l):(r=(n=y.getElementsByClassName(m.TITLE))===null||n===void 0?void 0:n[0])===null||r===void 0||r.remove();var b=this.HTMLTooltipItemsElements,w=document.createElement("ul");w.className=m.LIST,cN(w,b);var R=this.element.querySelector(".".concat(m.LIST));R?R.replaceWith(w):y.appendChild(w)}RA(y,h)},t.prototype.getRelativeOffsetFromCursor=function(n){var r=this.attributes,i=r.position,s=r.offset,l=n||i,u=l.split("-"),h={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},p=this.elementSize,m=p.width,y=p.height,b=[-m/2,-y/2];return u.forEach(function(w){var R=(0,j.CR)(b,2),P=R[0],I=R[1],N=(0,j.CR)(h[w],2),z=N[0],Z=N[1];b=[P+(m/2+s[0])*z,I+(y/2+s[1])*Z]}),b},t.prototype.setOffsetPosition=function(n){var r=(0,j.CR)(n,2),i=r[0],s=r[1],l=this.attributes,u=l.x,h=u===void 0?0:u,p=l.y,m=p===void 0?0:p,y=l.container,b=y.x,w=y.y;this.element.style.left="".concat(+h+b+i,"px"),this.element.style.top="".concat(+m+w+s,"px")},t.prototype.updatePosition=function(){var n=this.attributes.showDelay,r=n===void 0?60:n,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},t.prototype.autoPosition=function(n){var r=(0,j.CR)(n,2),i=r[0],s=r[1],l=this.attributes,u=l.x,h=l.y,p=l.bounding,m=l.position;if(!p)return[i,s];var y=this.element,b=y.offsetWidth,w=y.offsetHeight,R=(0,j.CR)([+u+i,+h+s],2),P=R[0],I=R[1],N={left:"right",right:"left",top:"bottom",bottom:"top"},z=p.x,Z=p.y,Y=p.width,$=p.height,J={left:P<z,right:P+b>z+Y,top:I<Z,bottom:I+w>Z+$},ae=[];m.split("-").forEach(function(Oe){J[Oe]?ae.push(N[Oe]):ae.push(Oe)});var pe=ae.join("-");return this.getRelativeOffsetFromCursor(pe)},t.prototype.isCursorEntered=function(n,r){if(this.element){var i=this.element.getBoundingClientRect(),s=i.x,l=i.y,u=i.width,h=i.height;return new vc(s,l,u,h).isPointIn(n,r)}return!1},t.prototype.closeTransition=function(n){var r=this,i=this.element.style.transition;this.element.style.transition="none",n(),setTimeout(function(){r.element.style.transition=i},10)},t.tag="tooltip",t}(Mf),S1=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function DT(e,t){return t?typeof t=="string"?document.querySelector(t):t:e.ownerDocument.defaultView.getContextService().getDomElement().parentElement}function lW(e){const t=e.getRenderBounds(),{min:[n,r],max:[i,s]}=t;return{x:n,y:r,width:i-n,height:s-r}}function cW(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:n.x-r.x,y:n.y-r.y}}function uW(e,t,n,r,i,s,l,u={},h=[10,10]){const p={".g2-tooltip":{},".g2-tooltip-title":{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},m=new sW({className:"tooltip",style:{x:t,y:n,container:l,data:[],bounding:s,position:r,enterable:i,title:"",offset:h,template:{prefixCls:"g2-"},style:ri(p,u)}});return e.appendChild(m.HTMLTooltipElement),m}function fN({root:e,data:t,x:n,y:r,render:i,event:s,single:l,position:u="right-bottom",enterable:h=!1,css:p,mount:m,bounding:y,offset:b}){const w=DT(e,m),R=DT(e),P=l?R:e,I=y||lW(e),N=cW(R,w),{tooltipElement:z=uW(w,n,r,u,h,I,N,p,b)}=P,{items:Z,title:Y=""}=t;z.update(Object.assign({x:n,y:r,data:Z,title:Y,position:u,enterable:h},i!==void 0&&{content:i(s,{items:Z,title:Y})})),P.tooltipElement=z}function cy({root:e,single:t,emitter:n,nativeEvent:r=!0,event:i=null}){r&&n.emit("tooltip:hide",{nativeEvent:r});const s=DT(e),l=t?s:e,{tooltipElement:u}=l;u&&u.hide(i==null?void 0:i.clientX,i==null?void 0:i.clientY),vN(e),gN(e),yN(e)}function $3({root:e,single:t}){const n=DT(e),r=t?n:e;if(!r)return;const{tooltipElement:i}=r;i&&(i.destroy(),r.tooltipElement=void 0),vN(e),gN(e),yN(e)}function hN(e){const{value:t}=e;return Object.assign(Object.assign({},e),{value:t===void 0?"undefined":t})}function fW(e){const{__data__:t}=e,{title:n,items:r=[]}=t,i=r.filter(ec).map(s=>{var{color:l=dN(e)}=s,u=S1(s,["color"]);return Object.assign(Object.assign({},u),{color:l})}).map(hN);return Object.assign(Object.assign({},n&&{title:n}),{items:i})}function hW(e,t){const{color:n,series:r,facet:i=!1}=e,{color:s,series:l}=t,u=h=>h&&h.invert&&!(h instanceof ay)&&!(h instanceof n1);if(u(r))return r.clone().invert(l);if(l&&r instanceof ay&&r.invert(l)!==s&&!i)return r.invert(l);if(u(n)){const h=n.invert(s);return Array.isArray(h)?null:h}return null}function dN(e){const t=e.getAttribute("fill"),n=e.getAttribute("stroke"),{__data__:r}=e,{color:i=t&&t!=="transparent"?t:n}=r;return i}function pN(e,t=n=>n){const n=new Map(e.map(r=>[t(r),r]));return Array.from(n.values())}function mN(e,t,n,r=e.map(s=>s.__data__),i={}){const s=h=>h instanceof Date?+h:h,l=pN(r.map(h=>h.title),s).filter(ec),u=r.flatMap((h,p)=>{const m=e[p],{items:y=[],title:b}=h,w=y.filter(ec),R=n!==void 0?n:y.length<=1;return w.map(P=>{var{color:I=dN(m)||i.color,name:N}=P,z=S1(P,["color","name"]);const Z=hW(t,h),Y=R?Z||N:N||Z;return Object.assign(Object.assign({},z),{color:I,name:Y||b})})}).map(hN);return Object.assign(Object.assign({},l.length>0&&{title:l.join(",")}),{items:pN(u,h=>`(${s(h.name)}, ${s(h.value)}, ${s(h.color)})`)})}function dW(e,t,n,r){var{plotWidth:i,plotHeight:s,mainWidth:l,mainHeight:u,startX:h,startY:p,transposed:m,polar:y,insetLeft:b,insetTop:w}=r,R=S1(r,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const P=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},R),I=(J,ae,pe)=>{const Oe=new bi({style:Object.assign({cx:J,cy:ae,r:pe},P)});return e.appendChild(Oe),Oe},N=(J,ae,pe,Oe)=>{const Ve=new xa({style:Object.assign({x1:J,x2:ae,y1:pe,y2:Oe},P)});return e.appendChild(Ve),Ve},Z=((J,ae)=>{if(ae.length===1)return ae[0];const pe=ae.map(Ve=>Ic(Ve,J)),Oe=Jx(pe,Ve=>Ve);return ae[Oe]})(n,t),Y=()=>m?[h+Z[0],h+Z[0],p,p+s]:[h,h+i,Z[1]+p,Z[1]+p],$=()=>{const J=h+b+l/2,ae=p+w+u/2,pe=Ic([J,ae],Z);return[J,ae,pe]};if(y){const[J,ae,pe]=$(),Oe=e.ruleX||I(J,ae,pe);Oe.style.cx=J,Oe.style.cy=ae,Oe.style.r=pe,e.ruleX=Oe}else{const[J,ae,pe,Oe]=Y(),Ve=e.ruleX||N(J,ae,pe,Oe);Ve.style.x1=J,Ve.style.x2=ae,Ve.style.y1=pe,Ve.style.y2=Oe,e.ruleX=Ve}}function pW(e,t,n){var{plotWidth:r,plotHeight:i,mainWidth:s,mainHeight:l,startX:u,startY:h,transposed:p,polar:m,insetLeft:y,insetTop:b}=n,w=S1(n,["plotWidth","plotHeight","mainWidth","mainHeight","startX","startY","transposed","polar","insetLeft","insetTop"]);const R=Object.assign({lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},w),P=t.map(Oe=>Oe[1]),I=t.map(Oe=>Oe[0]),N=e2(P),z=e2(I),Z=()=>{if(m){const Oe=Math.min(s,l)/2,Ve=u+y+s/2,Ke=h+b+l/2,lt=vp(ru([z,N],[Ve,Ke])),Ge=Ve+Oe*Math.cos(lt),rt=Ke+Oe*Math.sin(lt);return[Ve,Ge,Ke,rt]}return p?[u,u+r,N+h,N+h]:[z+u,z+u,h,h+i]},[Y,$,J,ae]=Z(),pe=()=>{const Oe=new xa({style:Object.assign({x1:Y,x2:$,y1:J,y2:ae},R)});return e.appendChild(Oe),Oe};if(I.length>0){const Oe=e.ruleY||pe();Oe.style.x1=Y,Oe.style.x2=$,Oe.style.y1=J,Oe.style.y2=ae,e.ruleY=Oe}}function vN(e){e.ruleY&&(e.ruleY.remove(),e.ruleY=void 0)}function gN(e){e.ruleX&&(e.ruleX.remove(),e.ruleX=void 0)}function mW(e,{data:t,style:n,theme:r}){e.markers&&e.markers.forEach(l=>l.remove());const{type:i=""}=n,s=t.filter(l=>{const[{x:u,y:h}]=l;return ec(u)&&ec(h)}).map(l=>{const[{color:u,element:h},p]=l,m=u||h.style.fill||h.style.stroke||r.color,y=i==="hollow"?"transparent":m,b=i==="hollow"?m:"#fff";return new bi({className:"g2-tooltip-marker",style:Object.assign({cx:p[0],cy:p[1],fill:y,r:4,stroke:b,lineWidth:2},n)})});for(const l of s)e.appendChild(l);e.markers=s}function yN(e){e.markers&&(e.markers.forEach(t=>t.remove()),e.markers=[])}function _N(e,t){return Array.from(e.values()).some(n=>{var r;return(r=n.interaction)===null||r===void 0?void 0:r[t]})}function Kv(e,t){return e===void 0?t:e}function bN(e){const{title:t,items:n}=e;return n.length===0&&t===void 0}function vW(e){return Array.from(e.values()).some(t=>{var n;return((n=t.interaction)===null||n===void 0?void 0:n.seriesTooltip)&&t.tooltip})}function xN(e,t){var{elements:n,sort:r,filter:i,scale:s,coordinate:l,crosshairs:u,crosshairsX:h,crosshairsY:p,render:m,groupName:y,emitter:b,wait:w=50,leading:R=!0,trailing:P=!1,startX:I=0,startY:N=0,body:z=!0,single:Z=!0,position:Y,enterable:$,mount:J,bounding:ae,theme:pe,offset:Oe,disableNative:Ve=!1,marker:Ke=!0,preserve:lt=!1,style:Ge={},css:rt={}}=t,st=S1(t,["elements","sort","filter","scale","coordinate","crosshairs","crosshairsX","crosshairsY","render","groupName","emitter","wait","leading","trailing","startX","startY","body","single","position","enterable","mount","bounding","theme","offset","disableNative","marker","preserve","style","css"]);const ut=n(e),jt=pc(l),At=Nl(l),zt=ri(Ge,st),{innerWidth:wn,innerHeight:Hn,width:rr,height:or,insetLeft:Hr,insetTop:ui}=l.getOptions(),Qi=[],ii=[];for(const sa of ut){const{__data__:qa}=sa,{seriesX:Is,title:Fs,items:bc}=qa;Is?Qi.push(sa):(Fs||bc)&&ii.push(sa)}const ti=sa=>sa.markType==="interval",Po=ii.length&&ii.every(ti)&&!Nl(l),Ji=sa=>sa.__data__.x,xo=!!s.x.getBandWidth&&ii.length>0;Qi.sort((sa,qa)=>{const Is=jt?0:1,Fs=bc=>bc.getBounds().min[Is];return jt?Fs(qa)-Fs(sa):Fs(sa)-Fs(qa)});const Ko=sa=>{const qa=jt?1:0,{min:Is,max:Fs}=sa.getLocalBounds();return Kp([Is[qa],Fs[qa]])};Po?ut.sort((sa,qa)=>Ji(sa)-Ji(qa)):ii.sort((sa,qa)=>{const[Is,Fs]=Ko(sa),[bc,$u]=Ko(qa),Ku=(Is+Fs)/2,zh=(bc+$u)/2;return jt?zh-Ku:Ku-zh});const la=new Map(Qi.map(sa=>{const{__data__:qa}=sa,{seriesX:Is}=qa,Fs=Is.map(($u,Ku)=>Ku),bc=Kp(Fs,$u=>Is[+$u]);return[sa,[bc,Is]]})),{x:wa}=s,Vs=wa!=null&&wa.getBandWidth?wa.getBandWidth()/2:0,Ea=sa=>{const[qa]=l.invert(sa);return qa-Vs},hs=(sa,qa,Is,Fs)=>{const{_x:bc}=sa,$u=bc!==void 0?wa.map(bc):Ea(qa),Ku=Fs.filter(ec),[zh,F0]=Kp([Ku[0],Ku[Ku.length-1]]),hm=zh===F0;if(!xo&&($u<zh||$u>F0)&&!hm)return null;const bb=Qg(rg=>Fs[+rg]).center,L2=bb(Is,$u);return Is[L2]},Ml=Po?(sa,qa)=>{const Is=Qg(Ji).center,Fs=Is(qa,Ea(sa)),bc=qa[Fs];return Rc(qa,Ji).get(Ji(bc))}:(sa,qa)=>{const Fs=sa[jt?1:0],bc=qa.filter(zh=>{const[F0,hm]=Ko(zh);return Fs>=F0&&Fs<=hm});if(!xo||bc.length>0)return bc;const $u=Qg(zh=>{const[F0,hm]=Ko(zh);return(F0+hm)/2}).center,Ku=$u(qa,Fs);return[qa[Ku]].filter(ec)},Pu=(sa,qa)=>{const{__data__:Is}=sa;return Object.fromEntries(Object.entries(Is).filter(([Fs])=>Fs.startsWith("series")&&Fs!=="series").map(([Fs,bc])=>{const $u=bc[qa];return[sE(Fs.replace("series","")),$u]}))},Yf=E1(sa=>{var qa;const Is=Rx(e,sa);if(!Is)return;const Fs=jP(e),bc=Fs.min[0],$u=Fs.min[1],Ku=[Is[0]-I,Is[1]-N];if(!Ku)return;const zh=Ml(Ku,ii),F0=[],hm=[];for(const mf of Qi){const[N2,VM]=la.get(mf),B2=hs(sa,Ku,N2,VM);if(B2!==null){F0.push(mf);const Lw=Pu(mf,B2),{x:mte,y:vte}=Lw,gte=l.map([(mte||0)+Vs,vte||0]);hm.push([Object.assign(Object.assign({},Lw),{element:mf}),gte])}}const bb=Array.from(new Set(hm.map(mf=>mf[0].x))),L2=bb[Jx(bb,mf=>Math.abs(mf-Ea(Ku)))],rg=hm.filter(mf=>mf[0].x===L2),UM=[...rg.map(mf=>mf[0]),...zh.map(mf=>mf.__data__)],Iw=[...F0,...zh],D2=mN(Iw,s,y,UM,pe);if(r&&D2.items.sort((mf,N2)=>r(mf)-r(N2)),i&&(D2.items=D2.items.filter(i)),Iw.length===0||bN(D2)){Zc(sa);return}if(z&&fN({root:e,data:D2,x:Is[0]+bc,y:Is[1]+$u,render:m,event:sa,single:Z,position:Y,enterable:$,mount:J,bounding:ae,css:rt,offset:Oe}),u||h||p){const mf=uo(zt,"crosshairs"),N2=Object.assign(Object.assign({},mf),uo(zt,"crosshairsX")),VM=Object.assign(Object.assign({},mf),uo(zt,"crosshairsY")),B2=rg.map(Lw=>Lw[1]);h&&dW(e,B2,Is,Object.assign(Object.assign({},N2),{plotWidth:wn,plotHeight:Hn,mainWidth:rr,mainHeight:or,insetLeft:Hr,insetTop:ui,startX:I,startY:N,transposed:jt,polar:At})),p&&pW(e,B2,Object.assign(Object.assign({},VM),{plotWidth:wn,plotHeight:Hn,mainWidth:rr,mainHeight:or,insetLeft:Hr,insetTop:ui,startX:I,startY:N,transposed:jt,polar:At}))}if(Ke){const mf=uo(zt,"marker");mW(e,{data:rg,style:mf,theme:pe})}const jM=(qa=rg[0])===null||qa===void 0?void 0:qa[0].x,pte=jM!=null?jM:Ea(Ku);b.emit("tooltip:show",Object.assign(Object.assign({},sa),{nativeEvent:!0,data:{data:{x:j_(s.x,pte,!0)}}}))},w,{leading:R,trailing:P}),Zc=sa=>{cy({root:e,single:Z,emitter:b,event:sa})},mh=()=>{$3({root:e,single:Z})},Iu=sa=>{var qa,{nativeEvent:Is,data:Fs,offsetX:bc,offsetY:$u}=sa,Ku=S1(sa,["nativeEvent","data","offsetX","offsetY"]);if(Is)return;const zh=(qa=Fs==null?void 0:Fs.data)===null||qa===void 0?void 0:qa.x,hm=s.x.map(zh),[bb,L2]=l.map([hm,.5]),rg=e.getRenderBounds(),UM=rg.min[0],Iw=rg.min[1];Yf(Object.assign(Object.assign({},Ku),{offsetX:bc!==void 0?bc:UM+bb,offsetY:$u!==void 0?$u:Iw+L2,_x:zh}))},Ud=()=>{cy({root:e,single:Z,emitter:b,nativeEvent:!1})},_c=()=>{Lf(),mh()},Dc=()=>{kh()},kh=()=>{Ve||(e.addEventListener("pointerenter",Yf),e.addEventListener("pointermove",Yf),e.addEventListener("pointerleave",sa=>{Rx(e,sa)||Zc(sa)}))},Lf=()=>{Ve||(e.removeEventListener("pointerenter",Yf),e.removeEventListener("pointermove",Yf),e.removeEventListener("pointerleave",Zc))};return kh(),b.on("tooltip:show",Iu),b.on("tooltip:hide",Ud),b.on("tooltip:disable",_c),b.on("tooltip:enable",Dc),()=>{Lf(),b.off("tooltip:show",Iu),b.off("tooltip:hide",Ud),b.off("tooltip:disable",_c),b.off("tooltip:enable",Dc),lt?cy({root:e,single:Z,emitter:b,nativeEvent:!1}):mh()}}function gW(e,{elements:t,coordinate:n,scale:r,render:i,groupName:s,sort:l,filter:u,emitter:h,wait:p=50,leading:m=!0,trailing:y=!1,groupKey:b=Ke=>Ke,single:w=!0,position:R,enterable:P,datum:I,view:N,mount:z,bounding:Z,theme:Y,offset:$,shared:J=!1,body:ae=!0,disableNative:pe=!1,preserve:Oe=!1,css:Ve={}}){var Ke,lt;const Ge=t(e),rt=Rc(Ge,b),st=Vi=>Vi.markType==="interval",ut=Ge.every(st)&&!Nl(n),jt=r.x,At=r.series,zt=(lt=(Ke=jt==null?void 0:jt.getBandWidth)===null||Ke===void 0?void 0:Ke.call(jt))!==null&&lt!==void 0?lt:0,wn=At?Vi=>Vi.__data__.x+Vi.__data__.series*zt:Vi=>Vi.__data__.x+zt/2;ut&&Ge.sort((Vi,xo)=>wn(Vi)-wn(xo));const Hn=Vi=>{const{target:xo}=Vi;return YS(xo,Ko=>Ko.classList?Ko.classList.includes("element"):!1)},rr=ut?Vi=>{const xo=Rx(e,Vi);if(!xo)return;const[Ko]=n.invert(xo),la=Ko,wa=Qg(wn).center,Vs=wa(Ge,la),Ea=Ge[Vs];return!J&&Ge.find(Ml=>Ml!==Ea&&wn(Ml)===wn(Ea))?Hn(Vi):Ea}:Hn,or=E1(Vi=>{const xo=rr(Vi);if(!xo){cy({root:e,single:w,emitter:h,event:Vi});return}const Ko=b(xo),la=rt.get(Ko);if(!la)return;const wa=la.length===1&&!J?fW(la[0]):mN(la,r,s,void 0,Y);if(l&&wa.items.sort((hs,Ml)=>l(hs)-l(Ml)),u&&(wa.items=wa.items.filter(u)),bN(wa)){cy({root:e,single:w,emitter:h,event:Vi});return}const{offsetX:Vs,offsetY:Ea}=Vi;ae&&fN({root:e,data:wa,x:Vs,y:Ea,render:i,event:Vi,single:w,position:R,enterable:P,mount:z,bounding:Z,css:Ve,offset:$}),h.emit("tooltip:show",Object.assign(Object.assign({},Vi),{nativeEvent:!0,data:{data:XP(xo,N)}}))},p,{leading:m,trailing:y}),Hr=Vi=>{cy({root:e,single:w,emitter:h,event:Vi})},ui=()=>{pe||(e.addEventListener("pointermove",or),e.addEventListener("pointerleave",Hr))},Qi=()=>{pe||(e.removeEventListener("pointermove",or),e.removeEventListener("pointerleave",Hr))},ii=({nativeEvent:Vi,offsetX:xo,offsetY:Ko,data:la})=>{if(Vi)return;const{data:wa}=la,Vs=wO(Ge,wa,I);if(!Vs)return;const Ea=Vs.getBBox(),{x:hs,y:Ml,width:Pu,height:Yf}=Ea,Zc=e.getBBox();or({target:Vs,offsetX:xo!==void 0?xo+Zc.x:hs+Pu/2,offsetY:Ko!==void 0?Ko+Zc.y:Ml+Yf/2})},ti=({nativeEvent:Vi}={})=>{Vi||cy({root:e,single:w,emitter:h,nativeEvent:!1})},Po=()=>{Qi(),$3({root:e,single:w})},Ji=()=>{ui()};return h.on("tooltip:show",ii),h.on("tooltip:hide",ti),h.on("tooltip:enable",Ji),h.on("tooltip:disable",Po),ui(),()=>{Qi(),h.off("tooltip:show",ii),h.off("tooltip:hide",ti),Oe?cy({root:e,single:w,emitter:h,nativeEvent:!1}):$3({root:e,single:w})}}function EN(e){const{shared:t,crosshairs:n,crosshairsX:r,crosshairsY:i,series:s,name:l,item:u=()=>({}),facet:h=!1}=e,p=S1(e,["shared","crosshairs","crosshairsX","crosshairsY","series","name","item","facet"]);return(m,y,b)=>{const{container:w,view:R}=m,{scale:P,markState:I,coordinate:N,theme:z}=R,Z=_N(I,"seriesTooltip"),Y=_N(I,"crosshairs"),$=rv(w),J=Kv(s,Z),ae=Kv(n,Y);if(J&&vW(I)&&!h)return xN($,Object.assign(Object.assign({},p),{theme:z,elements:ey,scale:P,coordinate:N,crosshairs:ae,crosshairsX:Kv(Kv(r,n),!1),crosshairsY:Kv(i,ae),item:u,emitter:b}));if(J&&h){const pe=y.filter(rt=>rt!==m&&rt.options.parentKey===m.options.key),Oe=UP(m,y),Ve=pe[0].view.scale,Ke=$.getBounds(),lt=Ke.min[0],Ge=Ke.min[1];return Object.assign(Ve,{facet:!0}),xN($.parentNode.parentNode,Object.assign(Object.assign({},p),{theme:z,elements:()=>Oe,scale:Ve,coordinate:N,crosshairs:Kv(n,Y),crosshairsX:Kv(Kv(r,n),!1),crosshairsY:Kv(i,ae),item:u,startX:lt,startY:Ge,emitter:b}))}return gW($,Object.assign(Object.assign({},p),{datum:u1(R),elements:ey,scale:P,coordinate:N,groupKey:t?TO(R):void 0,item:u,emitter:b,view:R,theme:z,shared:t}))}}EN.props={reapplyWhenUpdate:!0};var NT=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const SN="legend-category",yW="legend-continuous",_W="items-item",bW="legend-category-item-marker",xW="legend-category-item-label";function TN(e){return e.getElementsByClassName(bW)[0]}function wN(e){return e.getElementsByClassName(xW)[0]}function AN(e){return e.getElementsByClassName(_W)}function K3(e){return e.getElementsByClassName(SN)}function CN(e){return e.getElementsByClassName(yW)}function EW(e,t){[...K3(e),...CN(e)].forEach(r=>{t(r,i=>i)})}function q3(e){let t=e.parentNode;for(;t&&!t.__data__;)t=t.parentNode;return t.__data__}function Ute(e){let t=e;for(;t&&!t.attr("class").startsWith("legend");)t=t.children[0];return t.attributes}function SW(e,{legends:t,marker:n,label:r,datum:i,filter:s,emitter:l,channel:u,state:h={}}){const p=new Map,m=new Map,y=new Map,{unselected:b={markerStroke:"#aaa",markerFill:"#aaa",labelFill:"#aaa"}}=h,w={unselected:uo(b,"marker")},R={unselected:uo(b,"label")},{setState:P,removeState:I}=Yv(w,void 0),{setState:N,removeState:z}=Yv(R,void 0),Z=Array.from(t(e));let Y=Z.map(i);const $=()=>{for(const pe of Z){const Oe=i(pe),Ve=n(pe),Ke=r(pe);Y.includes(Oe)?(I(Ve,"unselected"),z(Ke,"unselected")):(P(Ve,"unselected"),N(Ke,"unselected"))}};for(const pe of Z){const Oe=()=>{ty(e,"pointer")},Ve=()=>{r7(e)},Ke=lt=>NT(this,void 0,void 0,function*(){const Ge=i(pe),rt=Y.indexOf(Ge);rt===-1?Y.push(Ge):Y.splice(rt,1),yield s(Y),$();const{nativeEvent:st=!0}=lt;st&&(Y.length===Z.length?l.emit("legend:reset",{nativeEvent:st}):l.emit("legend:filter",Object.assign(Object.assign({},lt),{nativeEvent:st,data:{channel:u,values:Y}})))});pe.addEventListener("click",Ke),pe.addEventListener("pointerenter",Oe),pe.addEventListener("pointerout",Ve),p.set(pe,Ke),m.set(pe,Oe),y.set(pe,Ve)}const J=pe=>NT(this,void 0,void 0,function*(){const{nativeEvent:Oe}=pe;if(Oe)return;const{data:Ve}=pe,{channel:Ke,values:lt}=Ve;Ke===u&&(Y=lt,yield s(Y),$())}),ae=pe=>NT(this,void 0,void 0,function*(){const{nativeEvent:Oe}=pe;Oe||(Y=Z.map(i),yield s(Y),$())});return l.on("legend:filter",J),l.on("legend:reset",ae),()=>{for(const pe of Z)pe.removeEventListener("click",p.get(pe)),pe.removeEventListener("pointerenter",m.get(pe)),pe.removeEventListener("pointerout",y.get(pe)),l.off("legend:filter",J),l.off("legend:reset",ae)}}function TW(e,{legend:t,filter:n,emitter:r,channel:i}){const s=({detail:{value:l}})=>{n(l),r.emit({nativeEvent:!0,data:{channel:i,values:l}})};return t.addEventListener("valuechange",s),()=>{t.removeEventListener("valuechange",s)}}function ON(e,{legend:t,channel:n,value:r,ordinal:i,channels:s,allChannels:l,facet:u=!1}){return NT(this,void 0,void 0,function*(){const{view:h,update:p,setState:m}=e;m(t,y=>{const{marks:b}=y,w=b.map(R=>{if(R.type==="legends")return R;const{transform:P=[]}=R,I=P.findIndex(({type:Z})=>Z.startsWith("group")||Z.startsWith("bin")),N=[...P];N.splice(I+1,0,{type:"filter",[n]:{value:r,ordinal:i}});const z=Object.fromEntries(s.map(Z=>[Z,{domain:h.scale[Z].getOptions().domain}]));return ri({},R,Object.assign(Object.assign({transform:N,scale:z},!i&&{animate:!1}),{legend:u?!1:Object.fromEntries(l.map(Z=>[Z,{preserve:!0}]))}))});return Object.assign(Object.assign({},y),{marks:w})}),yield p()})}function wW(e,t){for(const n of e)ON(n,Object.assign(Object.assign({},t),{facet:!0}))}function AW(){return(e,t,n)=>{const{container:r}=e,i=t.filter(y=>y!==e),s=i.length>0,l=y=>q3(y).scales.map(b=>b.name),u=[...K3(r),...CN(r)],h=u.flatMap(l),p=s?E1(wW,50,{trailing:!0}):E1(ON,50,{trailing:!0}),m=u.map(y=>{const{name:b,domain:w}=q3(y).scales[0],R=l(y),P={legend:y,channel:b,channels:R,allChannels:h};return y.className===SN?SW(r,{legends:AN,marker:TN,label:wN,datum:I=>{const{__data__:N}=I,{index:z}=N;return w[z]},filter:I=>{const N=Object.assign(Object.assign({},P),{value:I,ordinal:!0});p(s?i:e,N)},state:y.attributes.state,channel:b,emitter:n}):TW(r,{legend:y,filter:I=>{const N=Object.assign(Object.assign({},P),{value:I,ordinal:!1});p(s?i:e,N)},emitter:n,channel:b})});return()=>{m.forEach(y=>y())}}}function CW(){return(e,t,n)=>{const{container:r,view:i,options:s}=e,l=K3(r),u=ey(r),h=w=>q3(w).scales[0].name,p=w=>{const{scale:{[w]:R}}=i;return R},m=H_(s,["active","inactive"]),y=Mx(u,u1(i)),b=[];for(const w of l){const R=wn=>{const{data:Hn}=w.attributes,{__data__:rr}=wn,{index:or}=rr;return Hn[or].label},P=h(w),I=AN(w),N=p(P),z=Rc(u,wn=>N.invert(wn.__data__[P])),{state:Z={}}=w.attributes,{inactive:Y={}}=Z,{setState:$,removeState:J}=Yv(m,y),ae={inactive:uo(Y,"marker")},pe={inactive:uo(Y,"label")},{setState:Oe,removeState:Ve}=Yv(ae),{setState:Ke,removeState:lt}=Yv(pe),Ge=wn=>{for(const Hn of I){const rr=TN(Hn),or=wN(Hn);Hn===wn||wn===null?(Ve(rr,"inactive"),lt(or,"inactive")):(Oe(rr,"inactive"),Ke(or,"inactive"))}},rt=(wn,Hn)=>{const rr=R(Hn),or=new Set(z.get(rr));for(const ui of u)or.has(ui)?$(ui,"active"):$(ui,"inactive");Ge(Hn);const{nativeEvent:Hr=!0}=wn;Hr&&n.emit("legend:highlight",Object.assign(Object.assign({},wn),{nativeEvent:Hr,data:{channel:P,value:rr}}))},st=new Map;for(const wn of I){const Hn=rr=>{rt(rr,wn)};wn.addEventListener("pointerover",Hn),st.set(wn,Hn)}const ut=wn=>{for(const rr of u)J(rr,"inactive","active");Ge(null);const{nativeEvent:Hn=!0}=wn;Hn&&n.emit("legend:unhighlight",{nativeEvent:Hn})},jt=wn=>{const{nativeEvent:Hn,data:rr}=wn;if(Hn)return;const{channel:or,value:Hr}=rr;if(or!==P)return;const ui=I.find(Qi=>R(Qi)===Hr);ui&&rt({nativeEvent:!1},ui)},At=wn=>{const{nativeEvent:Hn}=wn;Hn||ut({nativeEvent:!1})};w.addEventListener("pointerleave",ut),n.on("legend:highlight",jt),n.on("legend:unhighlight",At);const zt=()=>{w.removeEventListener(ut),n.off("legend:highlight",jt),n.off("legend:unhighlight",At);for(const[wn,Hn]of st)wn.removeEventListener(Hn)};b.push(zt)}return()=>b.forEach(w=>w())}}var L0=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function OW(e,t){const[n,r,i,s]=e,[l,u,h,p]=t;return!(l>i||h<n||u>s||p<r)}function RW(e,t,n,r,i){const[s,l,u,h]=i;return[Math.max(s,Math.min(e,n)),Math.max(l,Math.min(t,r)),Math.min(u,Math.max(e,n)),Math.min(h,Math.max(t,r))]}function MW(e){const{width:t,height:n}=e.getBBox();return[0,0,t,n]}function qv(e,t){for(const[n,r]of Object.entries(t))e.style(n,r)}const RN=Rr(e=>{const t=e.attributes,{x:n,y:r,width:i,height:s,class:l,renders:u={},handleSize:h=10,document:p}=t,m=L0(t,["x","y","width","height","class","renders","handleSize","document"]);if(!p||i===void 0||s===void 0||n===void 0||r===void 0)return;const y=h/2,b=(Hr,ui,Qi)=>{Hr.handle||(Hr.handle=Qi.createElement("rect"),Hr.append(Hr.handle));const{handle:ii}=Hr;return ii.attr(ui),ii},w=uo(K1(m,"handleNW","handleNE"),"handleN"),{render:R=b}=w,P=L0(w,["render"]),I=uo(m,"handleE"),{render:N=b}=I,z=L0(I,["render"]),Z=uo(K1(m,"handleSE","handleSW"),"handleS"),{render:Y=b}=Z,$=L0(Z,["render"]),J=uo(m,"handleW"),{render:ae=b}=J,pe=L0(J,["render"]),Oe=uo(m,"handleNW"),{render:Ve=b}=Oe,Ke=L0(Oe,["render"]),lt=uo(m,"handleNE"),{render:Ge=b}=lt,rt=L0(lt,["render"]),st=uo(m,"handleSE"),{render:ut=b}=st,jt=L0(st,["render"]),At=uo(m,"handleSW"),{render:zt=b}=At,wn=L0(At,["render"]),Hn=(Hr,ui)=>{const{id:Qi}=Hr,ii=ui(Hr,Hr.attributes,p);ii.id=Qi,ii.style.draggable=!0},rr=Hr=>()=>{const ui=Rr(Qi=>Hn(Qi,Hr));return new ui({})},or=Ra(e).attr("className",l).style("transform",`translate(${n}, ${r})`).style("draggable",!0);or.maybeAppend("selection","rect").style("draggable",!0).style("fill","transparent").call(qv,Object.assign(Object.assign({width:i,height:s},K1(m,"handle")),{transform:void 0})),or.maybeAppend("handle-n",rr(R)).style("x",y).style("y",-y).style("width",i-h).style("height",h).style("fill","transparent").call(qv,P),or.maybeAppend("handle-e",rr(N)).style("x",i-y).style("y",y).style("width",h).style("height",s-h).style("fill","transparent").call(qv,z),or.maybeAppend("handle-s",rr(Y)).style("x",y).style("y",s-y).style("width",i-h).style("height",h).style("fill","transparent").call(qv,$),or.maybeAppend("handle-w",rr(ae)).style("x",-y).style("y",y).style("width",h).style("height",s-h).style("fill","transparent").call(qv,pe),or.maybeAppend("handle-nw",rr(Ve)).style("x",-y).style("y",-y).style("width",h).style("height",h).style("fill","transparent").call(qv,Ke),or.maybeAppend("handle-ne",rr(Ge)).style("x",i-y).style("y",-y).style("width",h).style("height",h).style("fill","transparent").call(qv,rt),or.maybeAppend("handle-se",rr(ut)).style("x",i-y).style("y",s-y).style("width",h).style("height",h).style("fill","transparent").call(qv,jt),or.maybeAppend("handle-sw",rr(zt)).style("x",-y).style("y",s-y).style("width",h).style("height",h).style("fill","transparent").call(qv,wn)});function Q3(e,t){var{brushed:n=()=>{},brushended:r=()=>{},brushcreated:i=()=>{},brushstarted:s=()=>{},brushupdated:l=()=>{},extent:u=MW(e),brushRegion:h=(ii,ti,Po,Ji,Vi)=>[ii,ti,Po,Ji],reverse:p=!1,fill:m="#777",fillOpacity:y="0.3",stroke:b="#fff",selectedHandles:w=["handle-n","handle-e","handle-s","handle-w","handle-nw","handle-ne","handle-se","handle-sw"]}=t,R=L0(t,["brushed","brushended","brushcreated","brushstarted","brushupdated","extent","brushRegion","reverse","fill","fillOpacity","stroke","selectedHandles"]);let P=null,I=null,N=null,z=null,Z=null,Y=!1;const[$,J,ae,pe]=u;ty(e,"crosshair"),e.style.draggable=!0;const Oe=(ii,ti,Po)=>{if(s(Po),z&&z.remove(),Z&&Z.remove(),P=[ii,ti],p)return Ve();Ke()},Ve=()=>{Z=new Mo({style:Object.assign(Object.assign({},R),{fill:m,fillOpacity:y,stroke:b,pointerEvents:"none"})}),z=new RN({style:{x:0,y:0,width:0,height:0,draggable:!0,document:e.ownerDocument},className:"mask"}),e.appendChild(Z),e.appendChild(z)},Ke=()=>{z=new RN({style:Object.assign(Object.assign({document:e.ownerDocument,x:0,y:0},R),{fill:m,fillOpacity:y,stroke:b,draggable:!0}),className:"mask"}),e.appendChild(z)},lt=(ii=!0)=>{z&&z.remove(),Z&&Z.remove(),P=null,I=null,N=null,Y=!1,z=null,Z=null,r(ii)},Ge=(ii,ti,Po=!0)=>{const[Ji,Vi,xo,Ko]=RW(ii[0],ii[1],ti[0],ti[1],u),[la,wa,Vs,Ea]=h(Ji,Vi,xo,Ko,u);return p?st(la,wa,Vs,Ea):rt(la,wa,Vs,Ea),n(la,wa,Vs,Ea,Po),[la,wa,Vs,Ea]},rt=(ii,ti,Po,Ji)=>{z.style.x=ii,z.style.y=ti,z.style.width=Po-ii,z.style.height=Ji-ti},st=(ii,ti,Po,Ji)=>{Z.style.d=`
      M${$},${J}L${ae},${J}L${ae},${pe}L${$},${pe}Z
      M${ii},${ti}L${ii},${Ji}L${Po},${Ji}L${Po},${ti}Z
    `,z.style.x=ii,z.style.y=ti,z.style.width=Po-ii,z.style.height=Ji-ti},ut=ii=>{const ti=(wa,Vs,Ea,hs,Ml)=>wa+Vs<hs?hs-Vs:wa+Ea>Ml?Ml-Ea:wa,Po=ii[0]-N[0],Ji=ii[1]-N[1],Vi=ti(Po,P[0],I[0],$,ae),xo=ti(Ji,P[1],I[1],J,pe),Ko=[P[0]+Vi,P[1]+xo],la=[I[0]+Vi,I[1]+xo];Ge(Ko,la)},jt={"handle-n":{vector:[0,1,0,0],cursor:"ns-resize"},"handle-e":{vector:[0,0,1,0],cursor:"ew-resize"},"handle-s":{vector:[0,0,0,1],cursor:"ns-resize"},"handle-w":{vector:[1,0,0,0],cursor:"ew-resize"},"handle-nw":{vector:[1,1,0,0],cursor:"nwse-resize"},"handle-ne":{vector:[0,1,1,0],cursor:"nesw-resize"},"handle-se":{vector:[0,0,1,1],cursor:"nwse-resize"},"handle-sw":{vector:[1,0,0,1],cursor:"nesw-resize"}},At=ii=>wn(ii)||zt(ii),zt=ii=>{const{id:ti}=ii;return w.indexOf(ti)===-1?!1:new Set(Object.keys(jt)).has(ti)},wn=ii=>ii===z.getElementById("selection"),Hn=ii=>{const{target:ti}=ii,[Po,Ji]=SO(e,ii);if(!z||!At(ti)){Oe(Po,Ji,ii),Y=!0;return}At(ti)&&(N=[Po,Ji])},rr=ii=>{const{target:ti}=ii,Po=SO(e,ii);if(!P)return;if(!N)return Ge(P,Po);if(wn(ti))return ut(Po);const[Ji,Vi]=[Po[0]-N[0],Po[1]-N[1]],{id:xo}=ti;if(jt[xo]){const[Ko,la,wa,Vs]=jt[xo].vector;return Ge([P[0]+Ji*Ko,P[1]+Vi*la],[I[0]+Ji*wa,I[1]+Vi*Vs])}},or=ii=>{if(N){N=null;const{x:xo,y:Ko,width:la,height:wa}=z.style;P=[xo,Ko],I=[xo+la,Ko+wa],l(xo,Ko,xo+la,Ko+wa,ii);return}I=SO(e,ii);const[ti,Po,Ji,Vi]=Ge(P,I);Y=!1,i(ti,Po,Ji,Vi,ii)},Hr=ii=>{const{target:ti}=ii;z&&!At(ti)&&lt()},ui=ii=>{const{target:ti}=ii;!z||!At(ti)||Y?ty(e,"crosshair"):wn(ti)?ty(e,"move"):zt(ti)&&ty(e,jt[ti.id].cursor)},Qi=()=>{ty(e,"default")};return e.addEventListener("dragstart",Hn),e.addEventListener("drag",rr),e.addEventListener("dragend",or),e.addEventListener("click",Hr),e.addEventListener("pointermove",ui),e.addEventListener("pointerleave",Qi),{mask:z,move(ii,ti,Po,Ji,Vi=!0){z||Oe(ii,ti,{}),P=[ii,ti],I=[Po,Ji],Ge([ii,ti],[Po,Ji],Vi)},remove(ii=!0){z&&lt(ii)},destroy(){z&&lt(!1),ty(e,"default"),e.removeEventListener("dragstart",Hn),e.removeEventListener("drag",rr),e.removeEventListener("dragend",or),e.removeEventListener("click",Hr),e.removeEventListener("pointermove",ui),e.removeEventListener("pointerleave",Qi)}}}function J3(e,t,n){return t.filter(r=>{if(r===e)return!1;const{interaction:i={}}=r.options;return Object.values(i).find(s=>s.brushKey===n)})}function PW(e,t,n){return J3(e,t,n).map(r=>rv(r.container))}function IW(e,t,n){return J3(e,t,n).map(r=>r.options)}function MN(e,t){var{elements:n,selectedHandles:r,siblings:i=rr=>[],datum:s,brushRegion:l,extent:u,reverse:h,scale:p,coordinate:m,series:y=!1,key:b=rr=>rr,bboxOf:w=rr=>{const{x:or,y:Hr,width:ui,height:Qi}=rr.style;return{x:or,y:Hr,width:ui,height:Qi}},state:R={},emitter:P}=t,I=L0(t,["elements","selectedHandles","siblings","datum","brushRegion","extent","reverse","scale","coordinate","series","key","bboxOf","state","emitter"]);const N=n(e),z=i(e),Z=z.flatMap(n),Y=Mx(N,s),$=uo(I,"mask"),{setState:J,removeState:ae}=Yv(R,Y),pe=new Map,{width:Oe,height:Ve,x:Ke=0,y:lt=0}=w(e),Ge=u||[0,0,Oe,Ve],rt=()=>{for(const rr of[...N,...Z])ae(rr,"active","inactive")},st=(rr,or,Hr,ui)=>{var Qi;for(const ti of z)(Qi=ti.brush)===null||Qi===void 0||Qi.remove();const ii=new Set;for(const ti of N){const{min:Po,max:Ji}=ti.getLocalBounds(),[Vi,xo]=Po,[Ko,la]=Ji;OW([Vi,xo,Ko,la],[rr,or,Hr,ui])?(J(ti,"active"),ii.add(b(ti))):J(ti,"inactive")}for(const ti of Z)ii.has(b(ti))?J(ti,"active"):J(ti,"inactive")},ut=()=>{for(const rr of N)ae(rr,"inactive");for(const rr of pe.values())rr.remove();pe.clear()},jt=(rr,or,Hr,ui)=>{const Qi=ti=>{const Po=ti.cloneNode();return Po.__data__=ti.__data__,ti.parentNode.appendChild(Po),pe.set(ti,Po),Po},ii=new pa({style:{x:rr+Ke,y:or+lt,width:Hr-rr,height:ui-or}});e.appendChild(ii);for(const ti of N){const Po=pe.get(ti)||Qi(ti);Po.style.clipPath=ii,J(ti,"inactive"),J(Po,"active")}},At=Q3(e,Object.assign(Object.assign({},$),{extent:Ge,brushRegion:l,reverse:h,selectedHandles:r,brushended:rr=>{const or=y?ut:rt;rr&&P.emit("brush:remove",{nativeEvent:!0}),or()},brushed:(rr,or,Hr,ui,Qi)=>{const ii=zS(rr,or,Hr,ui,p,m);Qi&&P.emit("brush:highlight",{nativeEvent:!0,data:{selection:ii}}),(y?jt:st)(rr,or,Hr,ui)},brushcreated:(rr,or,Hr,ui,Qi)=>{const ii=zS(rr,or,Hr,ui,p,m);P.emit("brush:end",Object.assign(Object.assign({},Qi),{nativeEvent:!0,data:{selection:ii}}))},brushupdated:(rr,or,Hr,ui,Qi)=>{const ii=zS(rr,or,Hr,ui,p,m);P.emit("brush:end",Object.assign(Object.assign({},Qi),{nativeEvent:!0,data:{selection:ii}}))},brushstarted:rr=>{P.emit("brush:start",rr)}})),zt=({nativeEvent:rr,data:or})=>{if(rr)return;const{selection:Hr}=or,[ui,Qi,ii,ti]=Hk(Hr,p,m);At.move(ui,Qi,ii,ti,!1)};P.on("brush:highlight",zt);const wn=({nativeEvent:rr}={})=>{rr||At.remove(!1)};P.on("brush:remove",wn);const Hn=At.destroy.bind(At);return At.destroy=()=>{P.off("brush:highlight",zt),P.off("brush:remove",wn),Hn()},At}function eR(e){var{facet:t,brushKey:n}=e,r=L0(e,["facet","brushKey"]);return(i,s,l)=>{const{container:u,view:h,options:p}=i,m=rv(u),y={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",reverse:!1},b=["active",["inactive",{opacity:.5}]],{scale:w,coordinate:R}=h;if(t){const I=m.getBounds(),N=I.min[0],z=I.min[1],Z=I.max[0],Y=I.max[1];return MN(m.parentNode.parentNode,Object.assign(Object.assign({elements:()=>UP(i,s),datum:u1(EO(i,s).map($=>$.view)),brushRegion:($,J,ae,pe)=>[$,J,ae,pe],extent:[N,z,Z,Y],state:H_(EO(i,s).map($=>$.options),b),emitter:l,scale:w,coordinate:R,selectedHandles:void 0},y),r))}const P=MN(m,Object.assign(Object.assign({elements:ey,key:I=>I.__data__.key,siblings:()=>PW(i,s,n),datum:u1([h,...J3(i,s,n).map(I=>I.view)]),brushRegion:(I,N,z,Z)=>[I,N,z,Z],extent:void 0,state:H_([p,...IW(i,s,n)],b),emitter:l,scale:w,coordinate:R,selectedHandles:void 0},y),r));return m.brush=P,()=>P.destroy()}}function tR(e,t,n,r,i){const[,s,,l]=i;return[e,s,n,l]}function LW(e){return eR(Object.assign(Object.assign({},e),{brushRegion:tR,selectedHandles:["handle-e","handle-w"]}))}function nR(e,t,n,r,i){const[s,,l]=i;return[s,t,l,r]}function DW(e){return eR(Object.assign(Object.assign({},e),{brushRegion:nR,selectedHandles:["handle-n","handle-s"]}))}var rR=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const NW="axis",BW="axis-line",FW="axis-main-group",PN="axis-hot-area";function kW(e){return e.getElementsByClassName(NW)}function IN(e){return e.getElementsByClassName(BW)[0]}function zW(e){return e.getElementsByClassName(FW)[0]}function LN(e){return zW(e).getLocalBounds()}function UW(e,t){var{cross:n,offsetX:r,offsetY:i}=t,s=rR(t,["cross","offsetX","offsetY"]);const l=LN(e),u=IN(e),[h]=u.getLocalBounds().min,[p,m]=l.min,[y,b]=l.max,w=(y-p)*2;return{brushRegion:nR,hotZone:new pa({className:PN,style:Object.assign({width:n?w/2:w,transform:`translate(${(n?p:h-w/2).toFixed(2)}, ${m})`,height:b-m},s)}),extent:n?(R,P,I,N)=>[-1/0,P,1/0,N]:(R,P,I,N)=>[Math.floor(p-r),P,Math.ceil(y-r),N]}}function jW(e,t){var{offsetY:n,offsetX:r,cross:i=!1}=t,s=rR(t,["offsetY","offsetX","cross"]);const l=LN(e),u=IN(e),[,h]=u.getLocalBounds().min,[p,m]=l.min,[y,b]=l.max,w=b-m;return{brushRegion:tR,hotZone:new pa({className:PN,style:Object.assign({width:y-p,height:i?w:w*2,transform:`translate(${p}, ${i?m:h-w})`},s)}),extent:i?(R,P,I,N)=>[R,-1/0,I,1/0]:(R,P,I,N)=>[R,Math.floor(m-n),I,Math.ceil(b-n)]}}function VW(e,t){var{axes:n,elements:r,points:i,horizontal:s,datum:l,offsetY:u,offsetX:h,reverse:p=!1,state:m={},emitter:y,coordinate:b}=t,w=rR(t,["axes","elements","points","horizontal","datum","offsetY","offsetX","reverse","state","emitter","coordinate"]);const R=r(e),P=n(e),I=Mx(R,l),{setState:N,removeState:z}=Yv(m,I),Z=new Map,Y=uo(w,"mask"),$=zt=>Array.from(Z.values()).every(([wn,Hn,rr,or])=>zt.some(([Hr,ui])=>Hr>=wn&&Hr<=rr&&ui>=Hn&&ui<=or)),J=P.map(zt=>zt.attributes.scale),ae=zt=>zt.length>2?[zt[0],zt[zt.length-1]]:zt,pe=new Map,Oe=()=>{pe.clear();for(let zt=0;zt<P.length;zt++){const wn=J[zt],{domain:Hn}=wn.getOptions();pe.set(zt,ae(Hn))}};Oe();const Ve=(zt,wn)=>{const Hn=[];for(const or of R){const Hr=i(or);$(Hr)?(N(or,"active"),Hn.push(or)):N(or,"inactive")}if(pe.set(zt,lt(Hn,zt)),!wn)return;const rr=()=>{if(!Ge)return Array.from(pe.values());const or=[];for(const[Hr,ui]of pe){const Qi=J[Hr],{name:ii}=Qi.getOptions();ii==="x"?or[0]=ui:or[1]=ui}return or};y.emit("brushAxis:highlight",{nativeEvent:!0,data:{selection:rr()}})},Ke=zt=>{for(const wn of R)z(wn,"active","inactive");Oe(),zt&&y.emit("brushAxis:remove",{nativeEvent:!0})},lt=(zt,wn)=>{const Hn=J[wn],{name:rr}=Hn.getOptions(),or=zt.map(Hr=>{const ui=Hr.__data__;return Hn.invert(ui[rr])});return ae(Jg(Hn,or))},Ge=P.some(s)&&P.some(zt=>!s(zt)),rt=[];for(let zt=0;zt<P.length;zt++){const wn=P[zt],Hn=s(wn)?jW:UW,{hotZone:rr,brushRegion:or,extent:Hr}=Hn(wn,{offsetY:u,offsetX:h,cross:Ge,zIndex:999,fill:"transparent"});wn.parentNode.appendChild(rr);const ui=Q3(rr,Object.assign(Object.assign({},Y),{reverse:p,brushRegion:or,brushended(Qi){Z.delete(wn),Array.from(Z.entries()).length===0?Ke(Qi):Ve(zt,Qi)},brushed(Qi,ii,ti,Po,Ji){Z.set(wn,Hr(Qi,ii,ti,Po)),Ve(zt,Ji)}}));rt.push(ui)}const st=(zt={})=>{const{nativeEvent:wn}=zt;wn||rt.forEach(Hn=>Hn.remove(!1))},ut=(zt,wn,Hn)=>{const[rr,or]=zt,Hr=ii=>ii.getStep?ii.getStep():0,ui=jt(rr,wn,Hn),Qi=jt(or,wn,Hn)+Hr(wn);return s(Hn)?[ui,-1/0,Qi,1/0]:[-1/0,ui,1/0,Qi]},jt=(zt,wn,Hn)=>{const{height:rr,width:or}=b.getOptions(),Hr=wn.clone();return s(Hn)?Hr.update({range:[0,or]}):Hr.update({range:[rr,0]}),Hr.map(zt)},At=zt=>{const{nativeEvent:wn}=zt;if(wn)return;const{selection:Hn}=zt.data;for(let rr=0;rr<rt.length;rr++){const or=Hn[rr],Hr=rt[rr],ui=P[rr];if(or){const Qi=J[rr];Hr.move(...ut(or,Qi,ui),!1)}else Hr.remove(!1)}};return y.on("brushAxis:remove",st),y.on("brushAxis:highlight",At),()=>{rt.forEach(zt=>zt.destroy()),y.off("brushAxis:remove",st),y.off("brushAxis:highlight",At)}}function HW(e){return(t,n,r)=>{const{container:i,view:s,options:l}=t,u=rv(i),{x:h,y:p}=u.getBBox(),{coordinate:m}=s;return VW(i,Object.assign({elements:ey,axes:kW,offsetY:p,offsetX:h,points:y=>y.__data__.points,horizontal:y=>{const{startPos:[b,w],endPos:[R,P]}=y.attributes;return b!==R&&w===P},datum:u1(s),state:H_(l,["active",["inactive",{opacity:.5}]]),coordinate:m,emitter:r},e))}}var ZW=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},DN=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function WW(e=300){let t=null;return n=>{const{timeStamp:r}=n;return t!==null&&r-t<e?(t=r,!0):(t=r,!1)}}function GW(e,t){var{filter:n,reset:r,brushRegion:i,extent:s,reverse:l,emitter:u,scale:h,coordinate:p,selection:m,series:y=!1}=t,b=DN(t,["filter","reset","brushRegion","extent","reverse","emitter","scale","coordinate","selection","series"]);const w=uo(b,"mask"),{width:R,height:P}=e.getBBox(),I=s||[0,0,R,P],N=WW(),z=Q3(e,Object.assign(Object.assign({},w),{extent:I,brushRegion:i,reverse:l,brushcreated:Z}));e.addEventListener("click",Y);function Z(J,ae,pe,Oe,Ve){Ve.nativeEvent=!0,n(m(J,ae,pe,Oe),Ve),z.remove()}function Y(J){N(J)&&(J.nativeEvent=!0,r(J))}const $=({nativeEvent:J,data:ae})=>{if(J)return;const{selection:pe}=ae;n(pe,{nativeEvent:!1})};return u.on("brush:filter",$),()=>{z.destroy(),u.off("brush:filter",$),e.removeEventListener("click",Y)}}function iR(e){var{hideX:t=!0,hideY:n=!0}=e,r=DN(e,["hideX","hideY"]);return(i,s,l)=>{const{container:u,view:h,options:p,update:m,setState:y}=i,b=rv(u),w={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};let R=!1,P=!1,I=h;const{scale:N,coordinate:z}=h;return GW(b,Object.assign(Object.assign({brushRegion:(Z,Y,$,J)=>[Z,Y,$,J],selection:(Z,Y,$,J)=>{const{scale:ae,coordinate:pe}=I;return zS(Z,Y,$,J,ae,pe)},filter:(Z,Y)=>ZW(this,void 0,void 0,function*(){if(P)return;P=!0;const[$,J]=Z;y("brushFilter",pe=>{const{marks:Oe}=pe,Ve=Oe.map(Ke=>ri({axis:Object.assign(Object.assign({},t&&{x:{transform:[{type:"hide"}]}}),n&&{y:{transform:[{type:"hide"}]}})},Ke,{scale:{x:{domain:$,nice:!1},y:{domain:J,nice:!1}}}));return Object.assign(Object.assign({},p),{marks:Ve,clip:!0})}),l.emit("brush:filter",Object.assign(Object.assign({},Y),{data:{selection:[$,J]}})),I=(yield m()).view,P=!1,R=!0}),reset:Z=>{if(P||!R)return;const{scale:Y}=h,{x:$,y:J}=Y,ae=$.getOptions().domain,pe=J.getOptions().domain;l.emit("brush:filter",Object.assign(Object.assign({},Z),{data:{selection:[ae,pe]}})),R=!1,I=h,y("brushFilter"),m()},extent:void 0,emitter:l,scale:N,coordinate:z},w),r))}}function XW(e){return iR(Object.assign(Object.assign({hideX:!0},e),{brushRegion:tR}))}function YW(e){return iR(Object.assign(Object.assign({hideY:!0},e),{brushRegion:nR}))}var $W=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const KW="slider";function qW(e,t,n,r=!1,i="x",s="y"){const{marks:l}=e,u=l.map(h=>{var p,m;return ri({axis:{x:{transform:[{type:"hide"}]},y:{transform:[{type:"hide"}]}}},h,{scale:t,[n]:Object.assign(Object.assign({},((p=h[n])===null||p===void 0?void 0:p[i])&&{[i]:Object.assign({preserve:!0},r&&{ratio:null})}),((m=h[n])===null||m===void 0?void 0:m[s])&&{[s]:{preserve:!0}}),animate:!1})});return Object.assign(Object.assign({},e),{marks:u,clip:!0,animate:!1})}function QW(e,t,n){const[r,i]=e,s=n?h=>1-h:h=>h,l=j_(t,s(r),!0),u=j_(t,s(i),!1);return Jg(t,[l,u])}function BT(e){return[e[0],e[e.length-1]]}function NN({initDomain:e={},className:t=KW,prefix:n="slider",setValue:r=(p,m)=>p.setValues(m),hasState:i=!1,wait:s=50,leading:l=!0,trailing:u=!1,getInitValues:h=p=>{var m;const y=(m=p==null?void 0:p.attributes)===null||m===void 0?void 0:m.values;if(y[0]!==0||y[1]!==1)return y}}){return(p,m,y)=>{const{container:b,view:w,update:R,setState:P}=p,I=b.getElementsByClassName(t);if(!I.length)return()=>{};let N=!1;const{scale:z,coordinate:Z,layout:Y}=w,{paddingLeft:$,paddingTop:J,paddingBottom:ae,paddingRight:pe}=Y,{x:Oe,y:Ve}=z,Ke=pc(Z),lt=ut=>{const jt=ut==="vertical"?"y":"x",At=ut==="vertical"?"x":"y";return Ke?[At,jt]:[jt,At]},Ge=new Map,rt=new Set,st={x:e.x||Oe.getOptions().domain,y:e.y||Ve.getOptions().domain};for(const ut of I){const{orientation:jt}=ut.attributes,[At,zt]=lt(jt),wn=`${n}${Zm(At)}:filter`,Hn=At==="x",{ratio:rr}=Oe.getOptions(),{ratio:or}=Ve.getOptions(),Hr=ti=>{if(ti.data){const{selection:Ko}=ti.data,[la=BT(st.x),wa=BT(st.y)]=Ko;return Hn?[Jg(Oe,la,rr),Jg(Ve,wa,or)]:[Jg(Ve,wa,or),Jg(Oe,la,rr)]}const{value:Po}=ti.detail,Ji=z[At],Vi=QW(Po,Ji,Ke&&jt==="horizontal"),xo=st[zt];return[Vi,xo]},ui=E1(ti=>$W(this,void 0,void 0,function*(){const{initValue:Po=!1}=ti;if(N&&!Po)return;N=!0;const{nativeEvent:Ji=!0}=ti,[Vi,xo]=Hr(ti);if(st[At]=Vi,st[zt]=xo,Ji){const Ko=Hn?Vi:xo,la=Hn?xo:Vi;y.emit(wn,Object.assign(Object.assign({},ti),{nativeEvent:Ji,data:{selection:[BT(Ko),BT(la)]}}))}P(ut,Ko=>Object.assign(Object.assign({},qW(Ko,{[At]:{domain:Vi,nice:!1}},n,i,At,zt)),{paddingLeft:$,paddingTop:J,paddingBottom:ae,paddingRight:pe})),yield R(),N=!1}),s,{leading:l,trailing:u}),Qi=ti=>{const{nativeEvent:Po}=ti;if(Po)return;const{data:Ji}=ti,{selection:Vi}=Ji,[xo,Ko]=Vi;ut.dispatchEvent(new Va("valuechange",{data:Ji,nativeEvent:!1}));const la=Hn?US(xo,Oe):US(Ko,Ve);r(ut,la)};y.on(wn,Qi),ut.addEventListener("valuechange",ui),Ge.set(ut,ui),rt.add([wn,Qi]);const ii=h(ut);ii&&ut.dispatchEvent(new Va("valuechange",{detail:{value:ii},nativeEvent:!1,initValue:!0}))}return()=>{for(const[ut,jt]of Ge)ut.removeEventListener("valuechange",jt);for(const[ut,jt]of rt)y.off(ut,jt)}}}const BN="g2-scrollbar";function JW(e={}){return(t,n,r)=>{const{view:i,container:s}=t;if(!s.getElementsByClassName(BN).length)return()=>{};const{scale:u}=i,{x:h,y:p}=u,m={x:[...h.getOptions().domain],y:[...p.getOptions().domain]};return h.update({domain:h.getOptions().expectedDomain}),p.update({domain:p.getOptions().expectedDomain}),NN(Object.assign(Object.assign({},e),{initDomain:m,className:BN,prefix:"scrollbar",hasState:!0,setValue:(b,w)=>b.setValue(w[0]),getInitValues:b=>{const w=b.slider.attributes.values;if(w[0]!==0)return w}}))(t,n,r)}}var eG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function tG(e,t,n){return`<${e} style="${Object.entries(n).map(([r,i])=>`${mO(r)}:${i}`).join(";")}">${t}</${e}>`}const nG={backgroundColor:"rgba(0,0,0,0.75)",color:"#fff",width:"max-content",padding:"1px 4px",fontSize:"12px",borderRadius:"2.5px",boxShadow:"0 3px 6px -4px rgba(0,0,0,0.12), 0 6px 16px 0 rgba(0,0,0,0.08), 0 9px 28px 8px rgba(0,0,0,0.05)"};function FN(e){return e.nodeName!=="text"?!1:!!e.isOverflowing()}function kN(e){var{offsetX:t=8,offsetY:n=8}=e,r=eG(e,["offsetX","offsetY"]);return i=>{const{container:s}=i,[l,u]=s.getBounds().min,h=uo(r,"tip"),p=new Set,m=b=>{const{target:w}=b;if(!FN(w)){b.stopPropagation();return}const{offsetX:R,offsetY:P}=b,I=R+t-l,N=P+n-u;if(w.tip){w.tip.style.x=I,w.tip.style.y=N;return}const{text:z}=w.style,Z=new zo({className:"poptip",style:{innerHTML:tG("div",z,Object.assign(Object.assign({},nG),h)),x:I,y:N}});s.appendChild(Z),w.tip=Z,p.add(Z)},y=b=>{const{target:w}=b;if(!FN(w)){b.stopPropagation();return}w.tip&&(w.tip.remove(),w.tip=null,p.delete(w.tip))};return s.addEventListener("pointerover",m),s.addEventListener("pointerout",y),()=>{s.removeEventListener("pointerover",m),s.removeEventListener("pointerout",y),p.forEach(b=>b.remove())}}}kN.props={reapplyWhenUpdate:!0};function rG(e,t){var n=qO(t),r=n.length;if((0,Xr.Z)(e))return!r;for(var i=0;i<r;i+=1){var s=n[i];if(t[s]!==e[s]||!(s in e))return!1}return!0}var iG=rG;function oG(e,t){if(!_s(e))return null;var n;if(Dh(t)&&(n=t),q0(t)&&(n=function(i){return iG(i,t)}),n){for(var r=0;r<e.length;r+=1)if(n(e[r]))return e[r]}return null}var ob=oG;function FT(e){return e==null?null:zN(e)}function zN(e){if(typeof e!="function")throw new Error;return e}var aG={depth:-1},UN={},oR={};function sG(e){return e.id}function lG(e){return e.parentId}function aR(){var e=sG,t=lG,n;function r(i){var s=Array.from(i),l=e,u=t,h,p,m,y,b,w,R,P,I=new Map;if(n!=null){var N=s.map(function(pe,Oe){return cG(n(pe,Oe,i))}),z=N.map(jN),Z=new Set(N).add(""),Y=XO(z),$;try{for(Y.s();!($=Y.n()).done;){var J=$.value;Z.has(J)||(Z.add(J),N.push(J),z.push(jN(J)),s.push(oR))}}catch(pe){Y.e(pe)}finally{Y.f()}l=function(Oe,Ve){return N[Ve]},u=function(Oe,Ve){return z[Ve]}}for(m=0,h=s.length;m<h;++m)p=s[m],w=s[m]=new Q_(p),(R=l(p,m,i))!=null&&(R+="")&&(P=w.id=R,I.set(P,I.has(P)?UN:w)),(R=u(p,m,i))!=null&&(R+="")&&(w.parent=R);for(m=0;m<h;++m)if(w=s[m],R=w.parent){if(b=I.get(R),!b)throw new Error("missing: "+R);if(b===UN)throw new Error("ambiguous: "+R);b.children?b.children.push(w):b.children=[w],w.parent=b}else{if(y)throw new Error("multiple roots");y=w}if(!y)throw new Error("no root");if(n!=null){for(;y.data===oR&&y.children.length===1;)y=y.children[0],--h;for(var ae=s.length-1;ae>=0&&(w=s[ae],w.data===oR);--ae)w.data=null}if(y.parent=aG,y.eachBefore(function(pe){pe.depth=pe.parent.depth+1,--h}).eachBefore(D5),y.parent=null,h>0)throw new Error("cycle");return y}return r.id=function(i){return arguments.length?(e=FT(i),r):e},r.parentId=function(i){return arguments.length?(t=FT(i),r):t},r.path=function(i){return arguments.length?(n=FT(i),r):n},r}function cG(e){e="".concat(e);var t=e.length;return sR(e,t-1)&&!sR(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:"/".concat(e)}function jN(e){var t=e.length;if(t<2)return"";for(;--t>1&&!sR(e,t););return e.slice(0,t)}function sR(e,t){if(e[t]==="/"){for(var n=0;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function uG(e,t,n,r,i){var s=e.children,l,u=s.length,h,p=new Array(u+1);for(p[0]=h=l=0;l<u;++l)p[l+1]=h+=s[l].value;m(0,u,e.value,t,n,r,i);function m(y,b,w,R,P,I,N){if(y>=b-1){var z=s[y];z.x0=R,z.y0=P,z.x1=I,z.y1=N;return}for(var Z=p[y],Y=w/2+Z,$=y+1,J=b-1;$<J;){var ae=$+J>>>1;p[ae]<Y?$=ae+1:J=ae}Y-p[$-1]<p[$]-Y&&y+1<$&&--$;var pe=p[$]-Z,Oe=w-pe;if(I-R>N-P){var Ve=w?(R*Oe+I*pe)/w:I;m(y,$,pe,R,P,Ve,N),m($,b,Oe,Ve,P,I,N)}else{var Ke=w?(P*Oe+N*pe)/w:N;m(y,$,pe,R,P,I,Ke),m($,b,Oe,R,Ke,I,N)}}}function kT(e,t,n,r,i){for(var s=e.children,l,u=-1,h=s.length,p=e.value&&(i-n)/e.value;++u<h;)l=s[u],l.x0=t,l.x1=r,l.y0=n,l.y1=n+=l.value*p}function fG(e,t,n,r,i){(e.depth&1?kT:Bx)(e,t,n,r,i)}var VN=(1+Math.sqrt(5))/2;function HN(e,t,n,r,i,s){for(var l=[],u=t.children,h,p,m=0,y=0,b=u.length,w,R,P=t.value,I,N,z,Z,Y,$,J;m<b;){w=i-n,R=s-r;do I=u[y++].value;while(!I&&y<b);for(N=z=I,$=Math.max(R/w,w/R)/(P*e),J=I*I*$,Y=Math.max(z/J,J/N);y<b;++y){if(I+=p=u[y].value,p<N&&(N=p),p>z&&(z=p),J=I*I*$,Z=Math.max(z/J,J/N),Z>Y){I-=p;break}Y=Z}l.push(h={value:I,dice:w<R,children:u.slice(m,y)}),h.dice?Bx(h,n,r,i,P?r+=R*I/P:s):kT(h,n,r,P?n+=w*I/P:i,s),P-=I,m=y}return l}var ZN=function e(t){function n(r,i,s,l,u){HN(t,r,i,s,l,u)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(VN),hG=function e(t){function n(r,i,s,l,u){if((h=r._squarify)&&h.ratio===t)for(var h,p,m,y,b=-1,w,R=h.length,P=r.value;++b<R;){for(p=h[b],m=p.children,y=p.value=0,w=m.length;y<w;++y)p.value+=m[y].value;p.dice?Bx(p,i,s,l,P?s+=(u-s)*p.value/P:u):kT(p,i,s,P?i+=(l-i)*p.value/P:l,u),P-=p.value}else r._squarify=h=HN(t,r,i,s,l,u),h.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(VN);function T1(){return 0}function ab(e){return function(){return e}}function dG(){var e=ZN,t=!1,n=1,r=1,i=[0],s=T1,l=T1,u=T1,h=T1,p=T1;function m(b){return b.x0=b.y0=0,b.x1=n,b.y1=r,b.eachBefore(y),i=[0],t&&b.eachBefore(P5),b}function y(b){var w=i[b.depth],R=b.x0+w,P=b.y0+w,I=b.x1-w,N=b.y1-w;I<R&&(R=I=(R+I)/2),N<P&&(P=N=(P+N)/2),b.x0=R,b.y0=P,b.x1=I,b.y1=N,b.children&&(w=i[b.depth+1]=s(b)/2,R+=p(b)-w,P+=l(b)-w,I-=u(b)-w,N-=h(b)-w,I<R&&(R=I=(R+I)/2),N<P&&(P=N=(P+N)/2),e(b,R,P,I,N))}return m.round=function(b){return arguments.length?(t=!!b,m):t},m.size=function(b){return arguments.length?(n=+b[0],r=+b[1],m):[n,r]},m.tile=function(b){return arguments.length?(e=zN(b),m):e},m.padding=function(b){return arguments.length?m.paddingInner(b).paddingOuter(b):m.paddingInner()},m.paddingInner=function(b){return arguments.length?(s=typeof b=="function"?b:ab(+b),m):s},m.paddingOuter=function(b){return arguments.length?m.paddingTop(b).paddingRight(b).paddingBottom(b).paddingLeft(b):m.paddingTop()},m.paddingTop=function(b){return arguments.length?(l=typeof b=="function"?b:ab(+b),m):l},m.paddingRight=function(b){return arguments.length?(u=typeof b=="function"?b:ab(+b),m):u},m.paddingBottom=function(b){return arguments.length?(h=typeof b=="function"?b:ab(+b),m):h},m.paddingLeft=function(b){return arguments.length?(p=typeof b=="function"?b:ab(+b),m):p},m}function pG(e,t){return Array.isArray(e)?typeof t=="function"?aR().path(t)(e):aR()(e):q_(e)}function WN(e,t=[e.data.name]){e.id=e.id||e.data.name,e.path=t,e.children&&e.children.forEach(n=>{n.id=`${e.id}/${n.data.name}`,n.path=[...t,n.data.name],WN(n,n.path)})}function GN(e){const t=ol(e,["data","name"]);t.replaceAll&&(e.path=t.replaceAll(".","/").split("/")),e.children&&e.children.forEach(n=>{GN(n)})}function mG(e,t){const n={treemapBinary:uG,treemapDice:Bx,treemapSlice:kT,treemapSliceDice:fG,treemapSquarify:ZN,treemapResquarify:hG},r=e==="treemapSquarify"?n[e].ratio(t):n[e];if(!r)throw new TypeError("Invalid tile method!");return r}function XN(e,t,n){const{value:r}=n,i=mG(t.tile,t.ratio),s=pG(e,t.path);_s(e)?GN(s):WN(s),r?s.sum(h=>t.ignoreParentValue&&h.children?0:cv(r)(h)).sort(t.sort):s.count(),dG().tile(i).size(t.size).round(t.round).paddingInner(t.paddingInner).paddingOuter(t.paddingOuter).paddingTop(t.paddingTop).paddingRight(t.paddingRight).paddingBottom(t.paddingBottom).paddingLeft(t.paddingLeft)(s);const l=s.descendants().map(h=>Object.assign(h,{id:h.id.replace(/^\//,""),x:[h.x0,h.x1],y:[h.y0,h.y1]}));return[l.filter(typeof t.layer=="function"?t.layer:h=>h.height===t.layer),l]}var vG=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},gG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function yG(e){return Ra(e).select(`.${Me}`).node()}const _G={breadCrumbFill:"rgba(0, 0, 0, 0.85)",breadCrumbFontSize:12,breadCrumbY:12,activeFill:"rgba(0, 0, 0, 0.5)"};function bG(e={}){const{originData:t=[],layout:n}=e,r=gG(e,["originData","layout"]),i=ri({},_G,r),s=uo(i,"breadCrumb"),l=uo(i,"active");return u=>{const{update:h,setState:p,container:m,options:y}=u,b=yG(m),w=y.marks[0],{state:R}=w,P=new ki;b.appendChild(P);const I=(Y,$)=>vG(this,void 0,void 0,function*(){if(P.removeChildren(),$){let J="",ae=s.y,pe=0;const Oe=[],Ve=b.getBBox().width,Ke=Y.map((lt,Ge)=>{J=`${J}${lt}/`,Oe.push(lt);const rt=new Oa({name:J.replace(/\/$/,""),style:Object.assign(Object.assign({text:lt,x:pe,path:[...Oe],depth:Ge},s),{y:ae})});P.appendChild(rt),pe+=rt.getBBox().width;const st=new Oa({style:Object.assign(Object.assign({x:pe,text:" / "},s),{y:ae})});return P.appendChild(st),pe+=st.getBBox().width,pe>Ve&&(ae=P.getBBox().height+s.y,pe=0,rt.attr({x:pe,y:ae}),pe+=rt.getBBox().width,st.attr({x:pe,y:ae}),pe+=st.getBBox().width),Ge===r1(Y)-1&&st.remove(),rt});Ke.forEach((lt,Ge)=>{if(Ge===r1(Ke)-1)return;const rt=Object.assign({},lt.attributes);lt.attr("cursor","pointer"),lt.addEventListener("mouseenter",()=>{lt.attr(l)}),lt.addEventListener("mouseleave",()=>{lt.attr(rt)}),lt.addEventListener("click",()=>{I(ol(lt,["style","path"]),ol(lt,["style","depth"]))})})}EW(m,p),p("treemapDrillDown",J=>{const{marks:ae}=J,pe=Y.join("/"),Oe=ae.map(Ve=>{if(Ve.type!=="rect")return Ve;let Ke=t;if($){const Ge=t.filter(At=>{const zt=ol(At,["id"]);return zt&&(zt.match(`${pe}/`)||pe.match(zt))}).map(At=>({value:At.height===0?ol(At,["value"]):void 0,name:ol(At,["id"])})),{paddingLeft:rt,paddingBottom:st,paddingRight:ut}=n,jt=Object.assign(Object.assign({},n),{paddingTop:(n.paddingTop||P.getBBox().height+10)/($+1),paddingLeft:rt/($+1),paddingBottom:st/($+1),paddingRight:ut/($+1),path:At=>At.name,layer:At=>At.depth===$+1});Ke=XN(Ge,jt,{value:"value"})[0]}else Ke=t.filter(Ge=>Ge.depth===1);const lt=[];return Ke.forEach(({path:Ge})=>{lt.push(Yx(Ge))}),ri({},Ve,{data:Ke,scale:{color:{domain:lt}}})});return Object.assign(Object.assign({},J),{marks:Oe})}),yield h(void 0,["legendFilter"])}),N=Y=>{const $=Y.target;if(ol($,["markType"])!=="rect")return;const J=ol($,["__data__","key"]),ae=ob(t,pe=>pe.id===J);ol(ae,"height")&&I(ol(ae,"path"),ol(ae,"depth"))};b.addEventListener("click",N);const z=qO(Object.assign(Object.assign({},R.active),R.inactive)),Z=()=>{GP(b).forEach($=>{const J=ol($,["style","cursor"]),ae=ob(t,pe=>pe.id===ol($,["__data__","key"]));if(J!=="pointer"&&(ae!=null&&ae.height)){$.style.cursor="pointer";const pe=GO($.attributes,z);$.addEventListener("mouseenter",()=>{$.attr(R.active)}),$.addEventListener("mouseleave",()=>{$.attr(ri(pe,R.inactive))})}})};return Z(),b.addEventListener("mousemove",Z),()=>{P.remove(),b.removeEventListener("click",N),b.removeEventListener("mousemove",Z)}}}var lR=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},xG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const EG={pointR:6,pointStrokeWidth:1,pointStroke:"#888",pointActiveStroke:"#f5f5f5",pathStroke:"#888",pathLineDash:[3,4],labelFontSize:12,labelFill:"#888",labelStroke:"#fff",labelLineWidth:1,labelY:-6,labelX:2},cR="movePoint",YN=e=>{const t=e.target,{markType:n}=t;n==="line"&&(t.attr("_lineWidth",t.attr("lineWidth")||1),t.attr("lineWidth",t.attr("_lineWidth")+3)),n==="interval"&&(t.attr("_opacity",t.attr("opacity")||1),t.attr("opacity",.7*t.attr("_opacity")))},$N=e=>{const t=e.target,{markType:n}=t;n==="line"&&t.attr("lineWidth",t.attr("_lineWidth")),n==="interval"&&t.attr("opacity",t.attr("_opacity"))},SG=(e,t,n)=>t.map(r=>["x","color"].reduce((s,l)=>{const u=n[l];return u&&r[u]!==e[u]?!1:s},!0)?Object.assign(Object.assign({},r),e):r),TG=e=>{const t=ol(e,["__data__","y"]),r=ol(e,["__data__","y1"])-t,{__data__:{data:i,encode:s,transform:l},childNodes:u}=e.parentNode,h=ob(l,({type:y})=>y==="normalizeY"),p=ol(s,["y","field"]),m=i[u.indexOf(e)][p];return(y,b=!1)=>h||b?y/(1-y)/(r/(1-r))*m:y},wG=(e,t)=>{const n=ol(e,["__data__","seriesItems",t,"0","value"]),r=ol(e,["__data__","seriesIndex",t]),{__data__:{data:i,encode:s,transform:l}}=e.parentNode,u=ob(l,({type:m})=>m==="normalizeY"),h=ol(s,["y","field"]),p=i[r][h];return m=>u?n===1?m:m/(1-m)/(n/(1-n))*p:m},KN=(e,t,n)=>{e.forEach((r,i)=>{r.attr("stroke",t[1]===i?n.activeStroke:n.stroke)})},qN=(e,t,n,r)=>{const i=new Mo({style:n}),s=new Oa({style:r});return t.appendChild(s),e.appendChild(i),[i,s]},QN=(e,t)=>{if(!ol(e,["options","range","indexOf"]))return;const r=e.options.range.indexOf(t);return e.sortedDomain[r]},uR=(e,t,n)=>{const r=XS(e,t),s=XS(e,n)/r,l=e[0]+(t[0]-e[0])*s,u=e[1]+(t[1]-e[1])*s;return[l,u]};function AG(e={}){const{selection:t=[],precision:n=2}=e,r=xG(e,["selection","precision"]),i=Object.assign(Object.assign({},EG),r||{}),s=uo(i,"path"),l=uo(i,"label"),u=uo(i,"point");return(h,p,m)=>{const{update:y,setState:b,container:w,view:R,options:{marks:P,coordinate:I}}=h,N=rv(w);let z=GP(N),Z,Y=t;const{transform:$=[],type:J}=I,ae=!!ob($,({type:At})=>At==="transpose"),pe=J==="polar",Oe=J==="theta",Ve=!!ob(z,({markType:At})=>At==="area");Ve&&(z=z.filter(({markType:At})=>At==="area"));const Ke=new ki({style:{zIndex:2}});N.appendChild(Ke);const lt=()=>{m.emit("element-point:select",{nativeEvent:!0,data:{selection:Y}})},Ge=(At,zt)=>{m.emit("element-point:moved",{nativeEvent:!0,data:{changeData:At,data:zt}})},rt=At=>{const zt=At.target;Y=[zt.parentNode.childNodes.indexOf(zt)],lt(),ut(zt)},st=At=>{const{data:{selection:zt},nativeEvent:wn}=At;if(wn)return;Y=zt;const Hn=ol(z,[Y==null?void 0:Y[0]]);Hn&&ut(Hn)},ut=At=>{const{attributes:zt,markType:wn,__data__:Hn}=At,{stroke:rr}=zt,{points:or,seriesTitle:Hr,color:ui,title:Qi,seriesX:ii,y1:ti}=Hn;if(ae&&wn!=="interval")return;const{scale:Po,coordinate:Ji}=(Z==null?void 0:Z.view)||R,{color:Vi,y:xo,x:Ko}=Po,la=Ji.getCenter();Ke.removeChildren();let wa;const Vs=(Ea,hs,Ml,Pu)=>lR(this,void 0,void 0,function*(){return b("elementPointMove",Yf=>{var Zc;const mh=(((Zc=Z==null?void 0:Z.options)===null||Zc===void 0?void 0:Zc.marks)||P).map(Iu=>{if(!Pu.includes(Iu.type))return Iu;const{data:Ud,encode:_c}=Iu,kh=Object.keys(_c).reduce((sa,qa)=>{const Is=_c[qa];return qa==="x"&&(sa[Is]=Ea),qa==="y"&&(sa[Is]=hs),qa==="color"&&(sa[Is]=Ml),sa},{}),Lf=SG(kh,Ud,_c);return Ge(kh,Lf),ri({},Iu,{data:Lf,animate:!1})});return Object.assign(Object.assign({},Yf),{marks:mh})}),yield y("elementPointMove")});if(["line","area"].includes(wn))or.forEach((Ea,hs)=>{const Ml=Ko.invert(ii[hs]);if(!Ml)return;const Pu=new bi({name:cR,style:Object.assign({cx:Ea[0],cy:Ea[1],fill:rr},u)}),Yf=wG(At,hs);Pu.addEventListener("mousedown",Zc=>{const mh=Ji.output([ii[hs],0]),Iu=Hr==null?void 0:Hr.length;w.attr("cursor","move"),Y[1]!==hs&&(Y[1]=hs,lt()),KN(Ke.childNodes,Y,u);const[Ud,_c]=qN(Ke,Pu,s,l),Dc=Lf=>{const sa=Ea[1]+Lf.clientY-wa[1];if(Ve)if(pe){const qa=Ea[0]+Lf.clientX-wa[0],[Is,Fs]=uR(la,mh,[qa,sa]),[,bc]=Ji.output([1,xo.output(0)]),[,$u]=Ji.invert([Is,bc-(or[hs+Iu][1]-Fs)]),Ku=(hs+1)%Iu,zh=(hs-1+Iu)%Iu,F0=Px([or[zh],[Is,Fs],Hr[Ku]&&or[Ku]]);_c.attr("text",Yf(xo.invert($u)).toFixed(n)),Ud.attr("d",F0),Pu.attr("cx",Is),Pu.attr("cy",Fs)}else{const[,qa]=Ji.output([1,xo.output(0)]),[,Is]=Ji.invert([Ea[0],qa-(or[hs+Iu][1]-sa)]),Fs=Px([or[hs-1],[Ea[0],sa],Hr[hs+1]&&or[hs+1]]);_c.attr("text",Yf(xo.invert(Is)).toFixed(n)),Ud.attr("d",Fs),Pu.attr("cy",sa)}else{const[,qa]=Ji.invert([Ea[0],sa]),Is=Px([or[hs-1],[Ea[0],sa],or[hs+1]]);_c.attr("text",xo.invert(qa).toFixed(n)),Ud.attr("d",Is),Pu.attr("cy",sa)}};wa=[Zc.clientX,Zc.clientY],window.addEventListener("mousemove",Dc);const kh=()=>lR(this,void 0,void 0,function*(){if(w.attr("cursor","default"),window.removeEventListener("mousemove",Dc),w.removeEventListener("mouseup",kh),Si(_c.attr("text")))return;const Lf=Number(_c.attr("text")),sa=QN(Vi,ui);Z=yield Vs(Ml,Lf,sa,["line","area"]),_c.remove(),Ud.remove(),ut(At)});w.addEventListener("mouseup",kh)}),Ke.appendChild(Pu)}),KN(Ke.childNodes,Y,u);else if(wn==="interval"){let Ea=[(or[0][0]+or[1][0])/2,or[0][1]];ae?Ea=[or[0][0],(or[0][1]+or[1][1])/2]:Oe&&(Ea=or[0]);const hs=TG(At),Ml=new bi({name:cR,style:Object.assign(Object.assign({cx:Ea[0],cy:Ea[1],fill:rr},u),{stroke:u.activeStroke})});Ml.addEventListener("mousedown",Pu=>{w.attr("cursor","move");const Yf=QN(Vi,ui),[Zc,mh]=qN(Ke,Ml,s,l),Iu=_c=>{if(ae){const Dc=Ea[0]+_c.clientX-wa[0],[kh]=Ji.output([xo.output(0),xo.output(0)]),[,Lf]=Ji.invert([kh+(Dc-or[2][0]),Ea[1]]),sa=Px([[Dc,or[0][1]],[Dc,or[1][1]],or[2],or[3]],!0);mh.attr("text",hs(xo.invert(Lf)).toFixed(n)),Zc.attr("d",sa),Ml.attr("cx",Dc)}else if(Oe){const Dc=Ea[1]+_c.clientY-wa[1],kh=Ea[0]+_c.clientX-wa[0],[Lf,sa]=uR(la,[kh,Dc],Ea),[qa,Is]=uR(la,[kh,Dc],or[1]),Fs=Ji.invert([Lf,sa])[1],bc=ti-Fs;if(bc<0)return;const $u=i7(la,[[Lf,sa],[qa,Is],or[2],or[3]],bc>.5?1:0);mh.attr("text",hs(bc,!0).toFixed(n)),Zc.attr("d",$u),Ml.attr("cx",Lf),Ml.attr("cy",sa)}else{const Dc=Ea[1]+_c.clientY-wa[1],[,kh]=Ji.output([1,xo.output(0)]),[,Lf]=Ji.invert([Ea[0],kh-(or[2][1]-Dc)]),sa=Px([[or[0][0],Dc],[or[1][0],Dc],or[2],or[3]],!0);mh.attr("text",hs(xo.invert(Lf)).toFixed(n)),Zc.attr("d",sa),Ml.attr("cy",Dc)}};wa=[Pu.clientX,Pu.clientY],window.addEventListener("mousemove",Iu);const Ud=()=>lR(this,void 0,void 0,function*(){if(w.attr("cursor","default"),w.removeEventListener("mouseup",Ud),window.removeEventListener("mousemove",Iu),Si(mh.attr("text")))return;const _c=Number(mh.attr("text"));Z=yield Vs(Qi,_c,Yf,[wn]),mh.remove(),Zc.remove(),ut(At)});w.addEventListener("mouseup",Ud)}),Ke.appendChild(Ml)}};z.forEach((At,zt)=>{Y[0]===zt&&ut(At),At.addEventListener("click",rt),At.addEventListener("mouseenter",YN),At.addEventListener("mouseleave",$N)});const jt=At=>{const zt=At==null?void 0:At.target;(!zt||zt.name!==cR&&!z.includes(zt))&&(Y=[],lt(),Ke.removeChildren())};return m.on("element-point:select",st),m.on("element-point:unselect",jt),w.addEventListener("mousedown",jt),()=>{Ke.remove(),m.off("element-point:select",st),m.off("element-point:unselect",jt),w.removeEventListener("mousedown",jt),z.forEach(At=>{At.removeEventListener("click",rt),At.removeEventListener("mouseenter",YN),At.removeEventListener("mouseleave",$N)})}}}var CG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const JN=()=>e=>{const{children:t}=e;if(!Array.isArray(t))return[];const{x:n=0,y:r=0,width:i,height:s,data:l}=e;return t.map(u=>{var{data:h,x:p,y:m,width:y,height:b}=u,w=CG(u,["data","x","y","width","height"]);return Object.assign(Object.assign({},w),{data:F_(h,l),x:p!=null?p:n,y:m!=null?m:r,width:y!=null?y:i,height:b!=null?b:s})})};JN.props={};var OG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const eB=()=>e=>{const{children:t}=e;if(!Array.isArray(t))return[];const{direction:n="row",ratio:r=t.map(()=>1),padding:i=0,data:s}=e,[l,u,h,p]=n==="col"?["y","height","width","x"]:["x","width","height","y"],m=r.reduce((P,I)=>P+I),y=e[u]-i*(t.length-1),b=r.map(P=>y*(P/m)),w=[];let R=e[l]||0;for(let P=0;P<b.length;P+=1){const I=t[P],{data:N}=I,z=OG(I,["data"]),Z=F_(N,s);w.push(Object.assign({[l]:R,[u]:b[P],[p]:e[p]||0,[h]:e[h],data:Z},z)),R+=b[P]+i}return w};eB.props={};class t2{constructor(t){this.$value=t}static of(t){return new t2(t)}call(t,...n){return this.$value=t(this.$value,...n),this}value(){return this.$value}}var RG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const MG=Xg(e=>{const{encode:t,data:n,scale:r,shareSize:i=!1}=e,{x:s,y:l}=t,u=(h,p)=>{var m;if(h===void 0||!i)return{};const y=Rc(n,R=>R[h]),b=((m=r==null?void 0:r[p])===null||m===void 0?void 0:m.domain)||Array.from(y.keys()),w=b.map(R=>y.has(R)?y.get(R).length:1);return{domain:b,flex:w}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:s===void 0?null:{position:"top"}},s===void 0&&{paddingInner:0}),u(s,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:l===void 0?null:{position:"right"}},l===void 0&&{paddingInner:0}),u(l,"y"))}}}),fR=Wv(e=>{const{data:t,scale:n,legend:r}=e,i=[e];let s,l,u;for(;i.length;){const b=i.shift(),{children:w,encode:R={},scale:P={},legend:I={}}=b,{color:N}=R,{color:z}=P,{color:Z}=I;N!==void 0&&(s=N),z!==void 0&&(l=z),Z!==void 0&&(u=Z),Array.isArray(w)&&i.push(...w)}const h=()=>{var b;const w=(b=n==null?void 0:n.color)===null||b===void 0?void 0:b.domain;if(w!==void 0)return[w];if(s===void 0)return[void 0];const R=typeof s=="function"?s:I=>I[s],P=t.map(R);return P.some(I=>typeof I=="number")?[om(P)]:[Array.from(new Set(P)),"ordinal"]},p=typeof s=="string"?s:"",[m,y]=h();return Object.assign({encode:{color:{type:"column",value:m!=null?m:[]}},scale:{color:ri({},l,{domain:m,type:y})}},r===void 0&&{legend:{color:ri({title:p},u)}})}),hR=Xg(()=>({animate:{enterType:"fadeIn"}})),dR=Wv(()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}})),pR=Wv(()=>({type:"cell"})),tB=Wv(e=>{const{data:t}=e;return{data:{type:"inline",value:t,transform:[{type:"custom",callback:()=>{const{data:r,encode:i}=e,{x:s,y:l}=i,u=s?Array.from(new Set(r.map(m=>m[s]))):[],h=l?Array.from(new Set(r.map(m=>m[l]))):[];return(()=>{if(u.length&&h.length){const m=[];for(const y of u)for(const b of h)m.push({[s]:y,[l]:b});return m}if(u.length)return u.map(m=>({[s]:m}));if(h.length)return h.map(m=>({[l]:m}))})()}}]}}}),nB=Wv((e,t=PG,n=IG,r=LG,i={})=>{const{data:s,encode:l,children:u,scale:h,x:p=0,y:m=0,shareData:y=!1,key:b}=e,{value:w}=s,{x:R,y:P}=l,{color:I}=h,{domain:N}=I;return{children:(Z,Y,$)=>{const{x:J,y:ae}=Y,{paddingLeft:pe,paddingTop:Oe,marginLeft:Ve,marginTop:Ke}=$,{domain:lt}=J.getOptions(),{domain:Ge}=ae.getOptions(),rt=Bv(Z),st=Z.map(t),ut=Z.map(({x:rr,y:or})=>[J.invert(rr),ae.invert(or)]),At=ut.map(([rr,or])=>Hr=>{const{[R]:ui,[P]:Qi}=Hr;return(R!==void 0?ui===rr:!0)&&(P!==void 0?Qi===or:!0)}).map(rr=>w.filter(rr)),zt=y?Ol(At,rr=>rr.length):void 0,wn=ut.map(([rr,or])=>({columnField:R,columnIndex:lt.indexOf(rr),columnValue:rr,columnValuesLength:lt.length,rowField:P,rowIndex:Ge.indexOf(or),rowValue:or,rowValuesLength:Ge.length})),Hn=wn.map(rr=>Array.isArray(u)?u:[u(rr)].flat(1));return rt.flatMap(rr=>{const[or,Hr,ui,Qi]=st[rr],ii=wn[rr],ti=At[rr];return Hn[rr].map(Ji=>{var Vi,xo,{scale:Ko,key:la,facet:wa=!0,axis:Vs={},legend:Ea={}}=Ji,hs=RG(Ji,["scale","key","facet","axis","legend"]);const Ml=((Vi=Ko==null?void 0:Ko.y)===null||Vi===void 0?void 0:Vi.guide)||Vs.y,Pu=((xo=Ko==null?void 0:Ko.x)===null||xo===void 0?void 0:xo.guide)||Vs.x,Yf={x:{tickCount:R?5:void 0},y:{tickCount:P?5:void 0}},Zc=wa?ti:ti.length===0?[]:w,mh={color:{domain:N}},Iu={x:rB(Pu,n)(ii,Zc),y:rB(Ml,r)(ii,Zc)};return Object.assign(Object.assign({key:`${la}-${rr}`,data:Zc,margin:0,x:or+pe+p+Ve,y:Hr+Oe+m+Ke,parentKey:b,width:ui,height:Qi,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!Zc.length,dataDomain:zt,scale:ri(Yf,Ko,mh),axis:ri({},Vs,Iu),legend:!1},hs),i)})})}}});function PG(e){const{points:t}=e;return $g(t)}function zT(e,t){return t.length?ri({title:!1,tick:null,label:null},e):ri({title:!1,tick:null,label:null,grid:null},e)}function IG(e){return(t,n)=>{const{rowIndex:r,rowValuesLength:i,columnIndex:s,columnValuesLength:l}=t;if(r!==i-1)return zT(e,n);const u=s!==l-1?!1:void 0,h=n.length?void 0:null;return ri({title:u,grid:h},e)}}function LG(e){return(t,n)=>{const{rowIndex:r,columnIndex:i}=t;if(i!==0)return zT(e,n);const s=r!==0?!1:void 0,l=n.length?void 0:null;return ri({title:s,grid:l},e)}}function rB(e,t){return typeof e=="function"?e:e===null||e===!1?()=>null:t(e)}const iB=()=>e=>[t2.of(e).call(pR).call(fR).call(hR).call(MG).call(dR).call(tB).call(nB).value()];iB.props={};var mR=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const DG=Xg(e=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),NG=Wv(e=>{const{data:t,children:n,x:r=0,y:i=0,key:s}=e;return{children:(u,h,p)=>{const{x:m,y}=h,{paddingLeft:b,paddingTop:w,marginLeft:R,marginTop:P}=p,{domain:I}=m.getOptions(),{domain:N}=y.getOptions(),z=Bv(u),Z=u.map(({points:ae})=>$g(ae)),Y=u.map(({x:ae,y:pe})=>[m.invert(ae),y.invert(pe)]),$=Y.map(([ae,pe])=>({columnField:ae,columnIndex:I.indexOf(ae),columnValue:ae,columnValuesLength:I.length,rowField:pe,rowIndex:N.indexOf(pe),rowValue:pe,rowValuesLength:N.length})),J=$.map(ae=>Array.isArray(n)?n:[n(ae)].flat(1));return z.flatMap(ae=>{const[pe,Oe,Ve,Ke]=Z[ae],[lt,Ge]=Y[ae],rt=$[ae];return J[ae].map(ut=>{var jt,At;const{scale:zt,key:wn,encode:Hn,axis:rr,interaction:or}=ut,Hr=mR(ut,["scale","key","encode","axis","interaction"]),ui=(jt=zt==null?void 0:zt.y)===null||jt===void 0?void 0:jt.guide,Qi=(At=zt==null?void 0:zt.x)===null||At===void 0?void 0:At.guide,ii={x:{facet:!1},y:{facet:!1}},ti={x:FG(Qi)(rt,t),y:kG(ui)(rt,t)},Po={x:{tickCount:5},y:{tickCount:5}};return Object.assign({data:t,parentKey:s,key:`${wn}-${ae}`,x:pe+b+r+R,y:Oe+w+i+P,width:Ve,height:Ke,margin:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:ri(ii,zt),axis:ri(Po,rr,ti),legend:!1,encode:ri({},Hn,{x:lt,y:Ge}),interaction:ri({},or,{legendFilter:!1})},Hr)})})}}}),BG=Wv(e=>{const{encode:t}=e,n=mR(e,["encode"]),{position:r=[],x:i=r,y:s=[...r].reverse()}=t,l=mR(t,["position","x","y"]),u=[];for(const h of[i].flat(1))for(const p of[s].flat(1))u.push({$x:h,$y:p});return Object.assign(Object.assign({},n),{data:u,encode:Object.assign(Object.assign({},l),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},[i].flat(1).length===1&&{x:{paddingInner:0}}),[s].flat(1).length===1&&{y:{paddingInner:0}})})});function FG(e){return typeof e=="function"?e:e===null?()=>null:(t,n)=>{const{rowIndex:r,rowValuesLength:i}=t;if(r!==i-1)return zT(e,n)}}function kG(e){return typeof e=="function"?e:e===null?()=>null:(t,n)=>{const{columnIndex:r}=t;if(r!==0)return zT(e,n)}}const zG=()=>e=>[t2.of(e).call(pR).call(fR).call(NG).call(BG).call(hR).call(dR).call(DG).value()];var UG=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const jG=Xg(e=>({scale:{x:{guide:{type:"axisArc"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}})),VG=Xg(e=>({coordinate:{type:"polar"}})),HG=e=>{const{encode:t}=e,n=UG(e,["encode"]),{position:r}=t;return Object.assign(Object.assign({},n),{encode:{x:r}})};function oB(e){return t=>null}function ZG(e){const{points:t}=e,[n,r,i,s]=t,l=Ic(n,s),u=ru(n,s),h=ru(r,i),p=z_(u,h),m=1/Math.sin(p/2),y=l/(1+m),b=y*Math.sqrt(2),[w,R]=i,I=Yg(u)+p/2,N=y*m,z=w+N*Math.sin(I),Z=R-N*Math.cos(I);return[z-b/2,Z-b/2,b,b]}const WG=()=>e=>[t2.of(e).call(pR).call(HG).call(fR).call(VG).call(tB).call(nB,ZG,oB,oB,{frame:!1}).call(hR).call(dR).call(jG).value()];function GG(e,t,n){const i=n,s=[0,i],l=[-i+1,1];if(e==="normal")return s;if(e==="reverse")return l;if(e==="alternate")return t%2===0?s:l;if(e==="reverse-alternate")return t%2===0?l:s}function XG(e,t,n){const r=[e];for(;r.length;){const i=r.pop();i.animate=ri({enter:{duration:t},update:{duration:t,easing:n,type:"morphing",fill:"both"},exit:{type:"fadeOut",duration:t}},i.animate||{});const{children:s}=i;Array.isArray(s)&&r.push(...s)}return e}const aB=()=>e=>{const{children:t=[],duration:n=1e3,iterationCount:r=1,direction:i="normal",easing:s="ease-in-out-sine"}=e,l=t.length;if(!Array.isArray(t)||l===0)return[];const{key:u}=t[0],h=t.map(p=>Object.assign(Object.assign({},p),{key:u})).map(p=>XG(p,n,s));return function*(){let p=0,m;for(;r==="infinite"||p<r;){const[y,b]=GG(i,p,l);for(let w=y;w<b;w+=1){const R=Math.abs(w);m!==R&&(yield h[R]),m=R}p++}}};aB.props={};function uy(e,t,n){const{encode:r}=n;if(e===null)return[t];const i=YG(e).map(l=>{var u;return[l,(u=tl(r,l))===null||u===void 0?void 0:u[0]]}).filter(([,l])=>ec(l)),s=l=>i.map(([,u])=>u[l]).join("-");return Array.from(Rc(t,s).values())}function sB(e){return Array.isArray(e)?qG(e):typeof e=="function"?KG(e):e==="series"?$G:e==="value"?QG:e==="sum"?JG:e==="maxIndex"?eX:null}function lB(e,t){for(const n of e)n.sort(t)}function cB(e,t){return(t==null?void 0:t.domain)||Array.from(new Set(e))}function YG(e){return Array.isArray(e)?e:[e]}function $G(e,t,n){return n2(r=>n[r])}function KG(e){return(t,n,r)=>n2(i=>e(t[i]))}function qG(e){return(t,n,r)=>(i,s)=>e.reduce((l,u)=>l!==0?l:iu(t[i][u],t[s][u]),0)}function QG(e,t,n){return n2(r=>t[r])}function JG(e,t,n){const r=Bv(e),i=Array.from(Rc(r,l=>n[+l]).entries()),s=new Map(i.map(([l,u])=>[l,u.reduce((h,p)=>h+ +t[p])]));return n2(l=>s.get(n[l]))}function eX(e,t,n){const r=Bv(e),i=Array.from(Rc(r,l=>n[+l]).entries()),s=new Map(i.map(([l,u])=>[l,Wi(u,h=>t[h])]));return n2(l=>s.get(n[l]))}function n2(e){return(t,n)=>iu(e(t),e(n))}const uB=(e={})=>{const{groupBy:t="x",orderBy:n=null,reverse:r=!1,y:i="y",y1:s="y1",series:l=!0}=e;return(u,h)=>{var p;const{data:m,encode:y,style:b={}}=h,[w,R]=tl(y,"y"),[P,I]=tl(y,"y1"),[N]=l?kx(y,"series","color"):tl(y,"color"),z=uy(t,u,h),Y=((p=sB(n))!==null&&p!==void 0?p:()=>null)(m,w,N);Y&&lB(z,Y);const $=new Array(u.length),J=new Array(u.length),ae=new Array(u.length),pe=[],Oe=[];for(const rt of z){r&&rt.reverse();const st=P?+P[rt[0]]:0,ut=[],jt=[];for(const Hr of rt){const ui=ae[Hr]=+w[Hr]-st;ui<0?jt.push(Hr):ui>=0&&ut.push(Hr)}const At=ut.length>0?ut:jt,zt=jt.length>0?jt:ut;let wn=ut.length-1,Hn=0;for(;wn>0&&w[At[wn]]===0;)wn--;for(;Hn<zt.length-1&&w[zt[Hn]]===0;)Hn++;pe.push(At[wn]),Oe.push(zt[Hn]);let rr=st;for(const Hr of jt.reverse()){const ui=ae[Hr];rr=$[Hr]=(J[Hr]=rr)+ui}let or=st;for(const Hr of ut){const ui=ae[Hr];ui>0?or=$[Hr]=(J[Hr]=or)+ui:$[Hr]=J[Hr]=or}}const Ve=new Set(pe),Ke=new Set(Oe),lt=i==="y"?$:J,Ge=s==="y"?$:J;return[u,ri({},h,{encode:{y0:hT(w,R),y:yc(lt,R),y1:yc(Ge,I)},style:Object.assign({first:(rt,st)=>Ve.has(st),last:(rt,st)=>Ke.has(st)},b)})]}};uB.props={};function fB(e,t){let n=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(i=+i)>=i&&++n}return n}function tX(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let l of e)l!=null&&(l=+l)>=l&&(r=l-i,i+=r/++n,s+=r*(l-i));else{let l=-1;for(let u of e)(u=t(u,++l,e))!=null&&(u=+u)>=u&&(r=u-i,i+=r/++n,s+=r*(u-i))}if(n>1)return s/(n-1)}function hB(e,t){const n=tX(e,t);return n&&Math.sqrt(n)}function nX(e,t,n){const r=fB(e),i=hB(e);return r&&i?Math.ceil((n-t)*Math.cbrt(r)/(3.49*i)):1}var dB=Array.prototype,rX=dB.slice,jte=dB.map;function vR(e){return()=>e}const iX=Math.sqrt(50),oX=Math.sqrt(10),aX=Math.sqrt(2);function UT(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),l=s>=iX?10:s>=oX?5:s>=aX?2:1;let u,h,p;return i<0?(p=Math.pow(10,-i)/l,u=Math.round(e*p),h=Math.round(t*p),u/p<e&&++u,h/p>t&&--h,p=-p):(p=Math.pow(10,i)*l,u=Math.round(e/p),h=Math.round(t/p),u*p<e&&++u,h*p>t&&--h),h<u&&.5<=n&&n<2?UT(e,t,n*2):[u,h,p]}function sX(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,l]=r?UT(t,e,n):UT(e,t,n);if(!(s>=i))return[];const u=s-i+1,h=new Array(u);if(r)if(l<0)for(let p=0;p<u;++p)h[p]=(s-p)/-l;else for(let p=0;p<u;++p)h[p]=(s-p)*l;else if(l<0)for(let p=0;p<u;++p)h[p]=(i+p)/-l;else for(let p=0;p<u;++p)h[p]=(i+p)*l;return h}function r2(e,t,n){return t=+t,e=+e,n=+n,UT(e,t,n)[2]}function Vte(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?r2(t,e,n):r2(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function lX(e,t,n){let r;for(;;){const i=r2(e,t,n);if(i===r||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function cX(e){return Math.max(1,Math.ceil(Math.log(fB(e))/Math.LN2)+1)}function uX(){var e=Ny,t=om,n=cX;function r(i){Array.isArray(i)||(i=Array.from(i));var s,l=i.length,u,h,p=new Array(l);for(s=0;s<l;++s)p[s]=e(i[s],s,i);var m=t(p),y=m[0],b=m[1],w=n(p,y,b);if(!Array.isArray(w)){const Z=b,Y=+w;if(t===om&&([y,b]=lX(y,b,Y)),w=sX(y,b,Y),w[0]<=y&&(h=r2(y,b,Y)),w[w.length-1]>=b)if(Z>=b&&t===om){const $=r2(y,b,Y);isFinite($)&&($>0?b=(Math.floor(b/$)+1)*$:$<0&&(b=(Math.ceil(b*-$)+1)/-$))}else w.pop()}for(var R=w.length,P=0,I=R;w[P]<=y;)++P;for(;w[I-1]>b;)--I;(P||I<R)&&(w=w.slice(P,I),R=I-P);var N=new Array(R+1),z;for(s=0;s<=R;++s)z=N[s]=[],z.x0=s>0?w[s-1]:y,z.x1=s<R?w[s]:b;if(isFinite(h)){if(h>0)for(s=0;s<l;++s)(u=p[s])!=null&&y<=u&&u<=b&&N[Math.min(R,Math.floor((u-y)/h))].push(i[s]);else if(h<0){for(s=0;s<l;++s)if((u=p[s])!=null&&y<=u&&u<=b){const Z=Math.floor((y-u)*h);N[Math.min(R,Z+(w[Z]<=u))].push(i[s])}}}else for(s=0;s<l;++s)(u=p[s])!=null&&y<=u&&u<=b&&N[jk(w,u,0,R)].push(i[s]);return N}return r.value=function(i){return arguments.length?(e=typeof i=="function"?i:vR(i),r):e},r.domain=function(i){return arguments.length?(t=typeof i=="function"?i:vR([i[0],i[1]]),r):t},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:vR(Array.isArray(i)?rX.call(i):i),r):n},r}function gR(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?l1:BS(i);r>n;){if(r-n>600){const h=r-n+1,p=t-n+1,m=Math.log(h),y=.5*Math.exp(2*m/3),b=.5*Math.sqrt(m*y*(h-y)/h)*(p-h/2<0?-1:1),w=Math.max(n,Math.floor(t-p*y/h+b)),R=Math.min(r,Math.floor(t+(h-p)*y/h+b));gR(e,t,w,R,i)}const s=e[t];let l=n,u=r;for(i2(e,n,t),i(e[r],s)>0&&i2(e,n,r);l<u;){for(i2(e,l,u),++l,--u;i(e[l],s)<0;)++l;for(;i(e[u],s)>0;)--u}i(e[n],s)===0?i2(e,n,u):(++u,i2(e,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}return e}function i2(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function fX(e,t=iu){let n,r=!1;if(t.length===1){let i;for(const s of e){const l=t(s);(r?iu(l,i)>0:iu(l,l)===0)&&(n=s,i=l,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function jT(e,t,n){if(e=Float64Array.from(Fk(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return qp(e);if(t>=1)return Ol(e);var r,i=(r-1)*t,s=Math.floor(i),l=Ol(gR(e,s).subarray(0,s+1)),u=qp(e.subarray(s+1));return l+(u-l)*(i-s)}}function Hte(e,t,n=number){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),l=+n(e[s],s,e),u=+n(e[s+1],s+1,e);return l+(u-l)*(i-s)}}function hX(e,t,n=yO){if(!isNaN(t=+t)){if(r=Float64Array.from(e,(u,h)=>yO(n(e[h],h,e))),t<=0)return Jx(r);if(t>=1)return Wi(r);var r,i=Uint32Array.from(e,(u,h)=>h),s=r.length-1,l=Math.floor(s*t);return gR(i,l,0,s,(u,h)=>l1(r[u],r[h])),l=fX(i.subarray(0,l+1),u=>r[u]),l>=0?l:-1}}function yR(e,t){return jT(e,.5,t)}function dX(e,t){return hX(e,.5,t)}var pX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function fy(e){return t=>t===null?e:`${e} of ${t}`}function mX(e){if(typeof e=="function")return[e,null];const n={mean:vX,max:yX,count:bX,first:EX,last:SX,sum:xX,min:_X,median:gX}[e];if(!n)throw new Error(`Unknown reducer: ${e}.`);return n()}function vX(){const e=(n,r)=>e2(n,i=>+r[i]),t=fy("mean");return[e,t]}function gX(){const e=(n,r)=>yR(n,i=>+r[i]),t=fy("median");return[e,t]}function yX(){const e=(n,r)=>Ol(n,i=>+r[i]),t=fy("max");return[e,t]}function _X(){const e=(n,r)=>qp(n,i=>+r[i]),t=fy("min");return[e,t]}function bX(){const e=(n,r)=>n.length,t=fy("count");return[e,t]}function xX(){const e=(n,r)=>up(n,i=>+r[i]),t=fy("sum");return[e,t]}function EX(){const e=(n,r)=>r[n[0]],t=fy("first");return[e,t]}function SX(){const e=(n,r)=>r[n[n.length-1]],t=fy("last");return[e,t]}const _R=(e={})=>{const{groupBy:t}=e,n=pX(e,["groupBy"]);return(r,i)=>{const{data:s,encode:l}=i,u=t(r,i);if(!u)return[r,i];const h=(w,R)=>{if(w)return w;const{from:P}=R;if(!P)return w;const[,I]=tl(l,P);return I},p=Object.entries(n).map(([w,R])=>{const[P,I]=mX(R),[N,z]=tl(l,w),Z=h(z,R),Y=u.map($=>P($,N!=null?N:s));return[w,Object.assign(Object.assign({},rV(Y,(I==null?void 0:I(Z))||Z)),{aggregate:!0})]}),m=Object.keys(l).map(w=>{const[R,P]=tl(l,w),I=u.map(N=>R[N[0]]);return[w,yc(I,P)]}),y=u.map(w=>s[w[0]]);return[Bv(u),ri({},i,{data:y,encode:Object.fromEntries([...m,...p])})]}};_R.props={};var TX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const pB="thresholds";function wX(e){const[t,n]=om(e);return Math.min(200,nX(e,t,n))}const bR=(e={})=>{const{groupChannels:t=["color"],binChannels:n=["x","y"]}=e,r=TX(e,["groupChannels","binChannels"]),i={},s=(l,u)=>{const{encode:h}=u,p=n.map(R=>{const[P]=tl(h,R);return P}),m=uo(r,pB),y=l.filter(R=>p.every(P=>ec(P[R]))),b=[...t.map(R=>{const[P]=tl(h,R);return P}).filter(ec).map(R=>P=>R[P]),...n.map((R,P)=>{const I=p[P],N=m[R]||wX(I),z=uX().thresholds(N).value(Y=>+I[Y])(y),Z=new Map(z.flatMap(Y=>{const{x0:$,x1:J}=Y,ae=`${$},${J}`;return Y.map(pe=>[pe,ae])}));return i[R]=Z,Y=>Z.get(Y)})],w=R=>b.map(P=>P(R)).join("-");return Array.from(Rc(y,w).values())};return _R(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(r).filter(([l])=>!l.startsWith(pB)))),Object.fromEntries(n.flatMap(l=>{const u=([p])=>+i[l].get(p).split(",")[0],h=([p])=>+i[l].get(p).split(",")[1];return h.from=l,[[l,u],[`${l}1`,h]]}))),{groupBy:s}))};bR.props={};const mB=(e={})=>{const{thresholds:t}=e;return bR(Object.assign(Object.assign({},e),{thresholdsX:t,groupChannels:["color"],binChannels:["x"]}))};mB.props={};var AX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const vB=(e={})=>{const{groupBy:t="x",reverse:n=!1,orderBy:r,padding:i}=e,s=AX(e,["groupBy","reverse","orderBy","padding"]);return(l,u)=>{const{data:h,encode:p,scale:m}=u,{series:y}=m,[b]=tl(p,"y"),[w]=kx(p,"series","color"),R=cB(w,y),P=ri({},u,{scale:{series:{domain:R,paddingInner:i}}}),I=uy(t,l,u),N=sB(r);if(!N)return[l,ri(P,{encode:{series:yc(w)}})];const z=N(h,b,w);z&&lB(I,z);const Z=new Array(l.length);for(const Y of I){n&&Y.reverse();for(let $=0;$<Y.length;$++)Z[Y[$]]=R[$]}return[l,ri(P,{encode:{series:yc(r?Z:w)}})]}};vB.props={};function VT(e,t,n){if(e===null)return[-.5,.5];const r=cB(e,t),s=new ay({domain:r,range:[0,1],padding:n}).getBandWidth();return[-s/2,s/2]}function HT(e,t,n){return t*(1-e)+n*e}const gB=(e={})=>{const{padding:t=0,paddingX:n=t,paddingY:r=t,random:i=Math.random}=e;return(s,l)=>{const{encode:u,scale:h}=l,{x:p,y:m}=h,[y]=tl(u,"x"),[b]=tl(u,"y"),w=VT(y,p,n),R=VT(b,m,r),P=s.map(()=>HT(i(),...R)),I=s.map(()=>HT(i(),...w));return[s,ri({scale:{x:{padding:.5},y:{padding:.5}}},l,{encode:{dy:yc(P),dx:yc(I)}})]}};gB.props={};const yB=(e={})=>{const{padding:t=0,random:n=Math.random}=e;return(r,i)=>{const{encode:s,scale:l}=i,{x:u}=l,[h]=tl(s,"x"),p=VT(h,u,t),m=r.map(()=>HT(n(),...p));return[r,ri({scale:{x:{padding:.5}}},i,{encode:{dx:yc(m)}})]}};yB.props={};const _B=(e={})=>{const{padding:t=0,random:n=Math.random}=e;return(r,i)=>{const{encode:s,scale:l}=i,{y:u}=l,[h]=tl(s,"y"),p=VT(h,u,t),m=r.map(()=>HT(n(),...p));return[r,ri({scale:{y:{padding:.5}}},i,{encode:{dy:yc(m)}})]}};_B.props={};var CX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const bB=(e={})=>{const{groupBy:t="x"}=e;return(n,r)=>{const{encode:i}=r,{x:s}=i,l=CX(i,["x"]),u=Object.entries(l).filter(([b])=>b.startsWith("y")).map(([b])=>[b,tl(i,b)[0]]),h=u.map(([b])=>[b,new Array(n.length)]),p=uy(t,n,r),m=new Array(p.length);for(let b=0;b<p.length;b++){const R=p[b].flatMap(N=>u.map(([,z])=>+z[N])),[P,I]=om(R);m[b]=(P+I)/2}const y=Math.max(...m);for(let b=0;b<p.length;b++){const w=y-m[b],R=p[b];for(const P of R)for(let I=0;I<u.length;I++){const[,N]=u[I],[,z]=h[I];z[P]=+N[P]+w}}return[n,ri({},r,{encode:Object.fromEntries(h.map(([b,w])=>[b,yc(w,tl(i,b)[1])]))})]}};bB.props={};const xB=(e={})=>{const{groupBy:t="x",series:n=!0}=e;return(r,i)=>{const{encode:s}=i,[l]=tl(s,"y"),[u,h]=tl(s,"y1"),[p]=n?kx(s,"series","color"):tl(s,"color"),m=uy(t,r,i),y=new Array(r.length);for(const b of m){const w=b.map(R=>+l[R]);for(let R=0;R<b.length;R++){const P=b[R],I=Math.max(...w.filter((N,z)=>z!==R));y[P]=+l[P]>I?I:l[P]}}return[r,ri({},i,{encode:{y1:yc(y,h)}})]}};xB.props={};const EB=e=>{const{groupBy:t=["x"],reducer:n=(l,u)=>u[l[0]],orderBy:r=null,reverse:i=!1,duration:s}=e;return(l,u)=>{const{encode:h}=u,m=(Array.isArray(t)?t:[t]).map(I=>[I,tl(h,I)[0]]);if(m.length===0)return[l,u];let y=[l];for(const[,I]of m){const N=[];for(const z of y){const Z=Array.from(Rc(z,Y=>I[Y]).values());N.push(...Z)}y=N}if(r){const[I]=tl(h,r);I&&y.sort((N,z)=>n(N,I)-n(z,I)),i&&y.reverse()}const b=(s||3e3)/y.length,[w]=s?[iy(l,b)]:kx(h,"enterDuration",iy(l,b)),[R]=kx(h,"enterDelay",iy(l,0)),P=new Array(l.length);for(let I=0,N=0;I<y.length;I++){const z=y[I],Z=Ol(z,Y=>+w[Y]);for(const Y of z)P[Y]=+R[Y]+N;N+=Z}return[l,ri({},u,{encode:{enterDuration:dT(w),enterDelay:dT(P)}})]}};EB.props={};var OX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function RX(e){return typeof e=="function"?e:{min:(n,r)=>qp(n,i=>r[+i]),max:(n,r)=>Ol(n,i=>r[+i]),first:(n,r)=>r[n[0]],last:(n,r)=>r[n[n.length-1]],mean:(n,r)=>e2(n,i=>r[+i]),median:(n,r)=>yR(n,i=>r[+i]),sum:(n,r)=>up(n,i=>r[+i]),deviation:(n,r)=>hB(n,i=>r[+i])}[e]||Ol}const SB=(e={})=>{const{groupBy:t="x",basis:n="max"}=e;return(r,i)=>{const{encode:s,tooltip:l}=i,{x:u}=s,h=OX(s,["x"]),p=Object.entries(h).filter(([P])=>P.startsWith("y")).map(([P])=>[P,tl(s,P)[0]]),[,m]=p.find(([P])=>P==="y"),y=p.map(([P])=>[P,new Array(r.length)]),b=uy(t,r,i),w=RX(n);for(const P of b){const I=w(P,m);for(const N of P)for(let z=0;z<p.length;z++){const[,Z]=p[z],[,Y]=y[z];Y[N]=+Z[N]/I}}const R=J0(l)||(l==null?void 0:l.items)&&(l==null?void 0:l.items.length)!==0;return[r,ri({},i,Object.assign({encode:Object.fromEntries(y.map(([P,I])=>[P,yc(I,tl(s,P)[1])]))},!R&&s.y0&&{tooltip:{items:[{channel:"y0"}]}}))]}};SB.props={};function TB(e,t){return[e[0]]}function MX(e,t){const n=e.length-1;return[e[n]]}function PX(e,t){const n=Wi(e,r=>t[r]);return[e[n]]}function IX(e,t){const n=Jx(e,r=>t[r]);return[e[n]]}function LX(e){return typeof e=="function"?e:{first:TB,last:MX,max:PX,min:IX}[e]||TB}const ZT=(e={})=>{const{groupBy:t="series",channel:n,selector:r}=e;return(i,s)=>{const{encode:l}=s,u=uy(t,i,s),[h]=tl(l,n),p=LX(r);return[u.flatMap(m=>p(m,h)),s]}};ZT.props={};var DX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const wB=(e={})=>{const{selector:t}=e,n=DX(e,["selector"]);return ZT(Object.assign({channel:"x",selector:t},n))};wB.props={};var NX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const AB=(e={})=>{const{selector:t}=e,n=NX(e,["selector"]);return ZT(Object.assign({channel:"y",selector:t},n))};AB.props={};var BX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const o2=(e={})=>{const{channels:t=["x","y"]}=e,n=BX(e,["channels"]),r=(i,s)=>uy(t,i,s);return _R(Object.assign(Object.assign({},n),{groupBy:r}))};o2.props={};const CB=(e={})=>o2(Object.assign(Object.assign({},e),{channels:["x","color","series"]}));CB.props={};const OB=(e={})=>o2(Object.assign(Object.assign({},e),{channels:["y","color","series"]}));OB.props={};const RB=(e={})=>o2(Object.assign(Object.assign({},e),{channels:["color"]}));RB.props={};function FX(e,t,n){return(t.length!==2?Kp(Mb(e,t,n),([r,i],[s,l])=>iu(i,l)||iu(r,s)):Kp(Rc(e,n),([r,i],[s,l])=>t(i,l)||iu(r,s))).map(([r])=>r)}var MB=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function kX(e,t,n){const{by:r=e,reducer:i="max"}=t,[s]=tl(n,r);if(typeof i=="function")return l=>i(l,s);if(i==="max")return l=>Ol(l,u=>+s[u]);if(i==="min")return l=>qp(l,u=>+s[u]);if(i==="sum")return l=>up(l,u=>+s[u]);if(i==="median")return l=>yR(l,u=>+s[u]);if(i==="mean")return l=>e2(l,u=>+s[u]);if(i==="first")return l=>s[l[0]];if(i==="last")return l=>s[l[l.length-1]];throw new Error(`Unknown reducer: ${i}`)}function zX(e,t,n){const{reverse:r,channel:i}=n,{encode:s}=t,[l]=tl(s,i),u=Kp(e,h=>l[h]);return r&&u.reverse(),[u,t]}function UX(e,t,n){if(!Array.isArray(n))return e;const r=new Set(n);return e.filter(i=>r.has(t[i]))}function jX(e,t,n){var r;const{reverse:i,slice:s,channel:l}=n,u=MB(n,["reverse","slice","channel"]),{encode:h,scale:p={}}=t,m=(r=p[l])===null||r===void 0?void 0:r.domain,[y]=tl(h,l),b=kX(l,u,h),w=UX(e,y,m),R=FX(w,b,N=>y[N]);i&&R.reverse();const P=typeof s=="number"?[0,s]:s,I=s?R.slice(...P):R;return[e,ri(t,{scale:{[l]:{domain:I}}})]}const WT=(e={})=>{const{reverse:t=!1,slice:n,channel:r,ordinal:i=!0}=e,s=MB(e,["reverse","slice","channel","ordinal"]);return(l,u)=>i?jX(l,u,Object.assign({reverse:t,slice:n,channel:r},s)):zX(l,u,Object.assign({reverse:t,slice:n,channel:r},s))};WT.props={};const PB=(e={})=>WT(Object.assign(Object.assign({},e),{channel:"x"}));PB.props={};const IB=(e={})=>WT(Object.assign(Object.assign({},e),{channel:"y"}));IB.props={};const LB=(e={})=>WT(Object.assign(Object.assign({},e),{channel:"color"}));LB.props={};function VX(e,t){return typeof t=="string"?e.map(n=>n[t]):e.map(t)}function HX(e,t){if(typeof e=="function")return n=>e(n,t);if(e==="sum")return n=>up(n,r=>+t[r]);throw new Error(`Unknown reducer: ${e}`)}const DB=(e={})=>{const{field:t,channel:n="y",reducer:r="sum"}=e;return(i,s)=>{const{data:l,encode:u}=s,[h]=tl(u,"x"),p=t?VX(l,t):tl(u,n)[0],m=HX(r,p),y=$1(i,m,b=>h[b]).map(b=>b[1]);return[i,ri({},s,{scale:{x:{flex:y}}})]}};DB.props={};function ZX(e){const{padding:t=0,direction:n="col"}=e;return(r,i,s)=>{const l=r.length;if(l===0)return[];const{innerWidth:u,innerHeight:h}=s,p=h/u;let m=Math.ceil(Math.sqrt(i/p)),y=u/m,b=Math.ceil(i/m),w=b*y;for(;w>h;)m=m+1,y=u/m,b=Math.ceil(i/m),w=b*y;const R=h-b*y,P=b<=1?0:R/(b-1),[I,N]=b<=1?[(u-l*y)/(l-1),(h-y)/2]:[0,0];return r.map((z,Z)=>{const[Y,$,J,ae]=$g(z),pe=n==="col"?Z%m:Math.floor(Z/b),Oe=n==="col"?Math.floor(Z/m):Z%b,Ve=pe*y,Ke=(b-Oe-1)*y+R,lt=(y-t)/J,Ge=(y-t)/ae,rt=Ve-Y+I*pe+1/2*t,st=Ke-$-P*Oe-N+1/2*t;return`translate(${rt}, ${st}) scale(${lt}, ${Ge})`})}}const NB=e=>(t,n)=>[t,ri({},n,{modifier:ZX(e),axis:!1})];NB.props={};function WX(e,t,n,r){const i=e.length;if(r>=i||r===0)return e;const s=w=>t[e[w]]*1,l=w=>n[e[w]]*1,u=[],h=(i-2)/(r-2);let p=0,m,y,b;u.push(p);for(let w=0;w<r-2;w++){let R=0,P=0,I=Math.floor((w+1)*h)+1,N=Math.floor((w+2)*h)+1;N=Math.min(N,i);const z=N-I;for(;I<N;I++)R+=s(I),P+=l(I);R/=z,P/=z;let Z=Math.floor((w+0)*h)+1;const Y=Math.floor((w+1)*h)+1,$=[s(p),l(p)];for(m=y=-1;Z<Y;Z++)y=Math.abs(($[0]-R)*(s(Z)-$[1])-($[0]-l(Z))*(P-$[0]))*.5,y>m&&(m=y,b=Z);u.push(b),p=b}return u.push(i-1),u.map(w=>e[w])}function GX(e){if(typeof e=="function")return e;if(e==="lttb")return WX;const t={first:r=>[r[0]],last:r=>[r[r.length-1]],min:(r,i,s)=>[r[Jx(r,l=>s[l])]],max:(r,i,s)=>[r[Wi(r,l=>s[l])]],median:(r,i,s)=>[r[dX(r,l=>s[l])]]},n=t[e]||t.median;return(r,i,s,l)=>{const u=Math.max(1,Math.floor(r.length/l));return XX(r,u).flatMap(p=>n(p,i,s))}}function XX(e,t){const n=e.length,r=[];let i=0;for(;i<n;)r.push(e.slice(i,i+=t));return r}const BB=(e={})=>{const{strategy:t="median",thresholds:n=2e3,groupBy:r=["series","color"]}=e,i=GX(t);return(s,l)=>{const{encode:u}=l,h=uy(r,s,l),[p]=tl(u,"x"),[m]=tl(u,"y");return[h.flatMap(y=>i(y,p,m,n)),l]}};BB.props={};function YX(e){return typeof e=="object"?[e.value,e.ordinal]:[e,!0]}function $X(e){var t;const{encode:n}=e,r=Object.assign(Object.assign({},e),{encode:Object.assign(Object.assign({},e.encode),{y:Object.assign(Object.assign({},e.encode.y),{value:[]})})}),i=(t=n==null?void 0:n.color)===null||t===void 0?void 0:t.field;if(!n||!i)return r;let s;for(const[l,u]of Object.entries(n))(l==="x"||l==="y")&&u.field===i&&(s=Object.assign(Object.assign({},s),{[l]:Object.assign(Object.assign({},u),{value:[]})}));return s?Object.assign(Object.assign({},e),{encode:Object.assign(Object.assign({},e.encode),s)}):r}const FB=(e={})=>(t,n)=>{const{encode:r,data:i}=n,s=Object.entries(e).map(([m,y])=>{const[b]=tl(r,m);if(!b)return null;const[w,R=!0]=YX(y);if(typeof w=="function")return P=>w(b[P]);if(R){const P=Array.isArray(w)?w:[w];return P.length===0?null:I=>P.includes(b[I])}else{const[P,I]=w;return N=>b[N]>=P&&b[N]<=I}}).filter(ec),l=m=>s.every(y=>y(m)),u=t.filter(l),h=u.map((m,y)=>y);if(s.length===0){const m=$X(n);return[t,m]}const p=Object.entries(r).map(([m,y])=>[m,Object.assign(Object.assign({},y),{value:h.map(b=>y.value[u[b]]).filter(b=>b!==void 0)})]);return[h,ri({},n,{encode:Object.fromEntries(p),data:u.map(m=>i[m])})]};FB.props={};var kB={},xR={},ER=34,a2=10,SR=13;function zB(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function KX(e,t){var n=zB(e);return function(r,i){return t(n(r),i,e)}}function UB(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function yp(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function qX(e){return e<0?"-"+yp(-e,6):e>9999?"+"+yp(e,6):yp(e,4)}function QX(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":qX(e.getUTCFullYear(),4)+"-"+yp(e.getUTCMonth()+1,2)+"-"+yp(e.getUTCDate(),2)+(i?"T"+yp(t,2)+":"+yp(n,2)+":"+yp(r,2)+"."+yp(i,3)+"Z":r?"T"+yp(t,2)+":"+yp(n,2)+":"+yp(r,2)+"Z":n||t?"T"+yp(t,2)+":"+yp(n,2)+"Z":"")}function JX(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(y,b){var w,R,P=i(y,function(I,N){if(w)return w(I,N-1);R=I,w=b?KX(I,b):zB(I)});return P.columns=R||[],P}function i(y,b){var w=[],R=y.length,P=0,I=0,N,z=R<=0,Z=!1;y.charCodeAt(R-1)===a2&&--R,y.charCodeAt(R-1)===SR&&--R;function Y(){if(z)return xR;if(Z)return Z=!1,kB;var J,ae=P,pe;if(y.charCodeAt(ae)===ER){for(;P++<R&&y.charCodeAt(P)!==ER||y.charCodeAt(++P)===ER;);return(J=P)>=R?z=!0:(pe=y.charCodeAt(P++))===a2?Z=!0:pe===SR&&(Z=!0,y.charCodeAt(P)===a2&&++P),y.slice(ae+1,J-1).replace(/""/g,'"')}for(;P<R;){if((pe=y.charCodeAt(J=P++))===a2)Z=!0;else if(pe===SR)Z=!0,y.charCodeAt(P)===a2&&++P;else if(pe!==n)continue;return y.slice(ae,J)}return z=!0,y.slice(ae,R)}for(;(N=Y())!==xR;){for(var $=[];N!==kB&&N!==xR;)$.push(N),N=Y();b&&($=b($,I++))==null||w.push($)}return w}function s(y,b){return y.map(function(w){return b.map(function(R){return m(w[R])}).join(e)})}function l(y,b){return b==null&&(b=UB(y)),[b.map(m).join(e)].concat(s(y,b)).join(`
`)}function u(y,b){return b==null&&(b=UB(y)),s(y,b).join(`
`)}function h(y){return y.map(p).join(`
`)}function p(y){return y.map(m).join(e)}function m(y){return y==null?"":y instanceof Date?QX(y):t.test(y+="")?'"'+y.replace(/"/g,'""')+'"':y}return{parse:r,parseRows:i,format:l,formatBody:u,formatRows:h,formatRow:p,formatValue:m}}function eY(e){for(var t in e){var n=e[t].trim(),r,i;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(i=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))tY&&i[4]&&!i[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;e[t]=n}return e}const tY=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var nY=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};const jB=e=>{const{value:t,format:n=t.split(".").pop(),delimiter:r=",",autoType:i=!0}=e;return()=>nY(void 0,void 0,void 0,function*(){const s=yield fetch(t);if(n==="csv"){const l=yield s.text();return JX(r).parse(l,i?eY:Dv)}else if(n==="json")return yield s.json();throw new Error(`Unknown format: ${n}.`)})};jB.props={};const VB=e=>{const{value:t}=e;return()=>t};VB.props={};function rY(e,t){return e.map(n=>{if(Array.isArray(n)){const[r,i=t]=n;return[r,i]}return[n,t]})}const HB=e=>{const{fields:t=[]}=e,n=rY(t,!0);return r=>{const i=(s,l)=>n.reduce((u,[h,p=!0])=>u!==0?u:p?s[h]<l[h]?-1:+(s[h]!==l[h]):s[h]>l[h]?-1:+(s[h]!==l[h]),0);return[...r].sort(i)}};HB.props={};function Zte(e){return e!=null&&!Number.isNaN(e)}const ZB=e=>{const{callback:t}=e;return n=>Array.isArray(n)?[...n].sort(t):n};ZB.props={};function iY(e){return e!=null&&!Number.isNaN(e)}const WB=e=>{const{callback:t=iY}=e;return n=>n.filter(t)};WB.props={};function oY(e,t=[]){return t.reduce((n,r)=>(r in e&&(n[r]=e[r]),n),{})}const GB=e=>{const{fields:t}=e;return n=>n.map(r=>oY(r,t))};GB.props={};function aY(e){return Object.keys(e).length===0}const XB=e=>t=>{if(!e||aY(e))return t;const n=r=>Object.entries(r).reduce((i,[s,l])=>(i[e[s]||s]=l,i),{});return t.map(n)};XB.props={};function sY(e){return!e||Object.keys(e).length===0}const YB=e=>{const{fields:t,key:n="key",value:r="value"}=e;return i=>sY(t)?i:i.flatMap(s=>t.map(l=>Object.assign(Object.assign({},s),{[n]:l,[r]:s[l]})))};YB.props={};const $B=e=>{const{start:t,end:n}=e;return r=>r.slice(t,n)};$B.props={};const KB=e=>{const{callback:t=Dv}=e;return n=>t(n)};KB.props={};const qB=e=>{const{callback:t=Dv}=e;return n=>Array.isArray(n)?n.map(t):n};qB.props={};function QB(e){return typeof e=="string"?t=>t[e]:e}const JB=e=>{const{join:t,on:n,select:r=[],as:i=r,unknown:s=NaN}=e,[l,u]=n,h=QB(u),p=QB(l),m=Mb(t,([y])=>y,y=>h(y));return y=>y.map(b=>{const w=m.get(p(b));return Object.assign(Object.assign({},b),r.reduce((R,P,I)=>(R[i[I]]=w?w[P]:s,R),{}))})};JB.props={};var lY=D(53843),cY=D.n(lY);function Wte(e){return e!=null&&!Number.isNaN(e)}const eF=e=>{const{field:t,groupBy:n,as:r=["y","size"],min:i,max:s,size:l=10,width:u}=e,[h,p]=r;return m=>Array.from(Rc(m,b=>n.map(w=>b[w]).join("-")).values()).map(b=>{const w=cY().create(b.map(I=>I[t]),{min:i,max:s,size:l,width:u}),R=w.map(I=>I.x),P=w.map(I=>I.y);return Object.assign(Object.assign({},b[0]),{[h]:R,[p]:P})})};eF.props={};const tF=()=>e=>(console.log("G2 data section:",e),e);tF.props={};var uY=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})};function fY(e,t){return{set(n,r,i){if(t[n]===void 0)return this;const s=r?r.call(null,t[n]):t[n];return i?i.call(null,s):typeof e[n]=="function"?e[n](s):e[n]=s,this},setAsync(n,r,i){return uY(this,void 0,void 0,function*(){if(t[n]===void 0)return this;const s=r?yield r.call(null,t[n]):t[n];return i?i.call(null,s):typeof e[n]=="function"?e[n](s):e[n]=s,this})}}}const TR=Math.PI/180,s2=64,GT=2048;function hY(e){return e.text}function dY(){return"serif"}function nF(){return"normal"}function pY(e){return e.value}function mY(){return~~(Math.random()*2)*90}function vY(){return 1}function gY(){}function yY(e,t,n,r){if(t.sprite)return;const i=e.context,s=e.ratio;i.clearRect(0,0,(s2<<5)/s,GT/s);let l=0,u=0,h=0;const p=n.length;for(--r;++r<p;){t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font;let b=i.measureText(t.text+"m").width*s,w=t.size<<1;if(t.rotate){const R=Math.sin(t.rotate*TR),P=Math.cos(t.rotate*TR),I=b*P,N=b*R,z=w*P,Z=w*R;b=Math.max(Math.abs(I+Z),Math.abs(I-Z))+31>>5<<5,w=~~Math.max(Math.abs(N+z),Math.abs(N-z))}else b=b+31>>5<<5;if(w>h&&(h=w),l+b>=s2<<5&&(l=0,u+=h,h=0),u+w>=GT)break;i.translate((l+(b>>1))/s,(u+(w>>1))/s),t.rotate&&i.rotate(t.rotate*TR),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=b,t.height=w,t.xoff=l,t.yoff=u,t.x1=b>>1,t.y1=w>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,l+=b}const m=i.getImageData(0,0,(s2<<5)/s,GT/s).data,y=[];for(;--r>=0;){if(t=n[r],!t.hasText)continue;const b=t.width,w=b>>5;let R=t.y1-t.y0;for(let N=0;N<R*w;N++)y[N]=0;if(l=t.xoff,l==null)return;u=t.yoff;let P=0,I=-1;for(let N=0;N<R;N++){for(let z=0;z<b;z++){const Z=w*N+(z>>5),Y=m[(u+N)*(s2<<5)+(l+z)<<2]?1<<31-z%32:0;y[Z]|=Y,P|=Y}P?I=N:(t.y0++,R--,N--,u++)}t.y1=t.y0+I,t.sprite=y.slice(0,(t.y1-t.y0)*w)}}function _Y(e,t,n){n>>=5;const r=e.sprite,i=e.width>>5,s=e.x-(i<<4),l=s&127,u=32-l,h=e.y1-e.y0;let p=(e.y+e.y0)*n+(s>>5),m;for(let y=0;y<h;y++){m=0;for(let b=0;b<=i;b++)if((m<<u|(b<i?(m=r[y*i+b])>>>l:0))&t[p+b])return!0;p+=n}return!1}function bY(e,t){const n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function xY(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function rF(e){const t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function EY(e){const n=4*e[0]/e[1];let r=0,i=0;return function(s){const l=s<0?-1:1;switch(Math.sqrt(1+4*l*s)-l&3){case 0:r+=n;break;case 1:i+=4;break;case 2:r-=n;break;default:i-=4;break}return[r,i]}}function iF(e){const t=[];let n=-1;for(;++n<e;)t[n]=0;return t}function SY(){return document.createElement("canvas")}function Qv(e){return typeof e=="function"?e:function(){return e}}const TY={archimedean:rF,rectangular:EY};function wY(){let e=[256,256],t=hY,n=dY,r=pY,i=nF,s=mY,l=vY,u=rF,h=Math.random,p=gY,m=[],y=null,b=1/0,w=SY;const R=nF,P={};P.start=function(){const[z,Z]=e,Y=I(w()),$=P.board?P.board:iF((e[0]>>5)*e[1]),J=m.length,ae=[],pe=m.map(function(lt,Ge,rt){return lt.text=t.call(this,lt,Ge,rt),lt.font=n.call(this,lt,Ge,rt),lt.style=R.call(this,lt,Ge,rt),lt.weight=i.call(this,lt,Ge,rt),lt.rotate=s.call(this,lt,Ge,rt),lt.size=~~r.call(this,lt,Ge,rt),lt.padding=l.call(this,lt,Ge,rt),lt}).sort(function(lt,Ge){return Ge.size-lt.size});let Oe=-1,Ve=P.board?[{x:0,y:0},{x:z,y:Z}]:void 0;y&&clearInterval(y),y=setInterval(Ke,0),Ke();function Ke(){const lt=Date.now();for(;Date.now()-lt<b&&++Oe<J;){const Ge=pe[Oe];Ge.x=z*(h()+.5)>>1,Ge.y=Z*(h()+.5)>>1,yY(Y,Ge,pe,Oe),Ge.hasText&&N($,Ge,Ve)&&(p.call(null,"word",{cloud:P,word:Ge}),ae.push(Ge),Ve?P.hasImage||bY(Ve,Ge):Ve=[{x:Ge.x+Ge.x0,y:Ge.y+Ge.y0},{x:Ge.x+Ge.x1,y:Ge.y+Ge.y1}],Ge.x-=e[0]>>1,Ge.y-=e[1]>>1)}P._tags=ae,P._bounds=Ve,Oe>=J&&(P.stop(),p.call(null,"end",{cloud:P,words:ae,bounds:Ve}))}return P},P.stop=function(){return y&&(clearInterval(y),y=null),P};function I(z){z.width=z.height=1;const Z=Math.sqrt(z.getContext("2d").getImageData(0,0,1,1).data.length>>2);z.width=(s2<<5)/Z,z.height=GT/Z;const Y=z.getContext("2d");return Y.fillStyle=Y.strokeStyle="red",Y.textAlign="center",Y.textBaseline="middle",{context:Y,ratio:Z}}function N(z,Z,Y){const $=Z.x,J=Z.y,ae=Math.sqrt(e[0]*e[0]+e[1]*e[1]),pe=u(e),Oe=h()<.5?1:-1;let Ve,Ke=-Oe,lt,Ge;for(;(Ve=pe(Ke+=Oe))&&(lt=~~Ve[0],Ge=~~Ve[1],!(Math.min(Math.abs(lt),Math.abs(Ge))>=ae));)if(Z.x=$+lt,Z.y=J+Ge,!(Z.x+Z.x0<0||Z.y+Z.y0<0||Z.x+Z.x1>e[0]||Z.y+Z.y1>e[1])&&(!Y||!_Y(Z,z,e[0]))&&(!Y||xY(Z,Y))){const rt=Z.sprite,st=Z.width>>5,ut=e[0]>>5,jt=Z.x-(st<<4),At=jt&127,zt=32-At,wn=Z.y1-Z.y0;let Hn,rr=(Z.y+Z.y0)*ut+(jt>>5);for(let or=0;or<wn;or++){Hn=0;for(let Hr=0;Hr<=st;Hr++)z[rr+Hr]|=Hn<<zt|(Hr<st?(Hn=rt[or*st+Hr])>>>At:0);rr+=ut}return delete Z.sprite,!0}return!1}return P.createMask=z=>{const Z=document.createElement("canvas"),[Y,$]=e;if(!Y||!$)return;const J=Y>>5,ae=iF((Y>>5)*$);Z.width=Y,Z.height=$;const pe=Z.getContext("2d");pe.drawImage(z,0,0,z.width,z.height,0,0,Y,$);const Oe=pe.getImageData(0,0,Y,$).data;for(let Ve=0;Ve<$;Ve++)for(let Ke=0;Ke<Y;Ke++){const lt=J*Ve+(Ke>>5),Ge=Ve*Y+Ke<<2,st=Oe[Ge]>=250&&Oe[Ge+1]>=250&&Oe[Ge+2]>=250?1<<31-Ke%32:0;ae[lt]|=st}P.board=ae,P.hasImage=!0},P.timeInterval=function(z){b=z==null?1/0:z},P.words=function(z){m=z},P.size=function(z=[]){e=[+z[0],+z[1]]},P.text=function(z){t=Qv(z)},P.font=function(z){n=Qv(z)},P.fontWeight=function(z){i=Qv(z)},P.rotate=function(z){s=Qv(z)},P.canvas=function(z){w=Qv(z)},P.spiral=function(z){u=TY[z]||z},P.fontSize=function(z){r=Qv(z)},P.padding=function(z){l=Qv(z)},P.random=function(z){h=Qv(z)},P.on=function(z){p=Qv(z)},P}var AY=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function u(m){try{p(r.next(m))}catch(y){l(y)}}function h(m){try{p(r.throw(m))}catch(y){l(y)}}function p(m){m.done?s(m.value):i(m.value).then(u,h)}p((r=r.apply(e,t||[])).next())})},CY=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const OY={fontSize:[20,60],font:"Impact",padding:2,rotate:function(){return(~~(Math.random()*6)-3)*30}};function RY(e){return new Promise((t,n)=>{if(e instanceof HTMLImageElement){t(e);return}if(typeof e=="string"){const r=new Image;r.crossOrigin="anonymous",r.src=e,r.onload=()=>t(r),r.onerror=()=>{console.error(`'image ${e} load failed !!!'`),n()};return}n()})}function MY(e,t){if(typeof e=="function")return e;if(Array.isArray(e)){const[n,r]=e;if(!t)return()=>(r+n)/2;const[i,s]=t;return s===i?()=>(r+n)/2:({value:l})=>(r-n)/(s-i)*(l-i)+n}return()=>e}const oF=(e,t)=>n=>AY(void 0,void 0,void 0,function*(){const r=Object.assign({},OY,e,{canvas:t.createCanvas}),i=wY();yield fY(i,r).set("fontSize",z=>{const Z=n.map(Y=>Y.value);return MY(z,[qp(Z),Ol(Z)])}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").set("canvas").setAsync("imageMask",RY,i.createMask),i.words([...n]);const s=i.start(),[l,u]=r.size,h=[{x:0,y:0},{x:l,y:u}],{_bounds:p=h,_tags:m,hasImage:y}=s,b=m.map(z=>{var{x:Z,y:Y,font:$}=z,J=CY(z,["x","y","font"]);return Object.assign(Object.assign({},J),{x:Z+l/2,y:Y+u/2,fontFamily:$})}),[{x:w,y:R},{x:P,y:I}]=p,N={text:"",value:0,opacity:0,fontSize:0};return b.push(Object.assign(Object.assign({},N),{x:y?0:w,y:y?0:R}),Object.assign(Object.assign({},N),{x:y?l:P,y:y?u:I})),b});oF.props={};function wR(e){const{min:t,max:n}=e;return[[t[0],t[1]],[n[0],n[1]]]}function aF(e,t){const[n,r]=e,[i,s]=t;return n>=i[0]&&n<=s[0]&&r>=i[1]&&r<=s[1]}function PY(e,t){const[n,r]=e;return!(aF(n,t)&&aF(r,t))}function IY(e,t){const[n,r]=e,[i,s]=t;return n[0]<s[0]&&r[0]>i[0]&&n[1]<s[1]&&r[1]>i[1]}const LY=e=>{const{priority:t}=e;return n=>{const r=[];return t&&n.sort(t),n.forEach(i=>{WS(i);const s=i.getLocalBounds();r.some(u=>IY(wR(s),wR(u.getLocalBounds())))?xO(i):r.push(i)}),n}};function DY([e,t],[n,r]){return r>e&&t>n}function XT(){const e=new Map;return[r=>e.get(r),(r,i)=>e.set(r,i)]}function NY(e){const t=e.cloneNode(!0),n=t.getElementById("connector");n&&t.removeChild(n);const{min:r,max:i}=t.getRenderBounds();return t.destroy(),{min:r,max:i}}const BY=e=>{const{maxIterations:t=10,maxError:n=.1,padding:r=1}=e;return i=>{const s=i.length;if(s<=1)return i;const[l,u]=XT(),[h,p]=XT(),[m,y]=XT(),[b,w]=XT();for(const R of i){const{min:P,max:I}=NY(R),[N,z]=P,[Z,Y]=I;u(R,z),p(R,z),y(R,Y-z),w(R,[N,Z])}for(let R=0;R<t;R++){i.sort((I,N)=>iu(h(I),h(N)));let P=0;for(let I=0;I<s-1;I++){const N=i[I];let z=I+1,Z;for(;(Z=i[z])&&!DY(b(N),b(Z));)z+=1;if(Z){const Y=h(N),$=m(N),J=h(Z),ae=J-(Y+$);if(ae<r){const pe=(r-ae)/2;P=Math.max(P,pe),p(N,Y-pe),p(Z,J+pe)}}}if(P<n)break}for(const R of i)R.style.y+=h(R)-l(R);return i}},FY=()=>e=>(e.forEach(t=>{WS(t);const n=t.attr("bounds"),r=t.getLocalBounds();PY(wR(r),n)&&xO(t)}),e);function kY(e){return typeof e=="object"?e:Af(e)}function AR(e){let t=e/255;return t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),t}function sF(e,t,n){return .2126*AR(e)+.7152*AR(t)+.0722*AR(n)}function lF(e,t){const{r:n,g:r,b:i}=e,{r:s,g:l,b:u}=t,h=sF(n,r,i),p=sF(s,l,u);return(Math.max(h,p)+.05)/(Math.min(h,p)+.05)}function zY(e,t){const n=Wi(t,r=>lF(e,kY(r)));return t[n]}const UY=e=>{const{threshold:t=4.5,palette:n=["#000","#fff"]}=e;return r=>(r.forEach(i=>{const s=i.attr("dependentElement").parsedStyle.fill,l=i.parsedStyle.fill;lF(l,s)<t&&i.attr("fill",zY(s,n))}),r)},jY=(e,t)=>{const[[n,r],[i,s]]=t,[[l,u],[h,p]]=e;let m=0,y=0;return l<n?m=n-l:h>i&&(m=i-h),u<r?y=r-u:p>s&&(y=s-p),[m,y]},VY=()=>(e,{canvas:t})=>{const{width:n,height:r}=t.getConfig();return e.forEach(i=>{WS(i);const{max:s,min:l}=i.getRenderBounds(),[u,h]=s,[p,m]=l,y=jY([[p,m],[u,h]],[[0,0],[n,r]]);i.style.connector&&i.style.connectorPoints&&(i.style.connectorPoints[0][0]-=y[0],i.style.connectorPoints[0][1]-=y[1]),i.style.x+=y[0],i.style.y+=y[1]}),e};function HY(){return{"data.fetch":jB,"data.inline":VB,"data.sortBy":HB,"data.sort":ZB,"data.filter":WB,"data.pick":GB,"data.rename":XB,"data.fold":YB,"data.slice":$B,"data.custom":KB,"data.map":qB,"data.join":JB,"data.kde":eF,"data.log":tF,"data.wordCloud":oF,"transform.stackY":uB,"transform.binX":mB,"transform.bin":bR,"transform.dodgeX":vB,"transform.jitter":gB,"transform.jitterX":yB,"transform.jitterY":_B,"transform.symmetryY":bB,"transform.diffY":xB,"transform.stackEnter":EB,"transform.normalizeY":SB,"transform.select":ZT,"transform.selectX":wB,"transform.selectY":AB,"transform.groupX":CB,"transform.groupY":OB,"transform.groupColor":RB,"transform.group":o2,"transform.sortX":PB,"transform.sortY":IB,"transform.sortColor":LB,"transform.flexX":DB,"transform.pack":NB,"transform.sample":BB,"transform.filter":FB,"coordinate.cartesian":k5,"coordinate.polar":jy,"coordinate.transpose":QO,"coordinate.theta":z5,"coordinate.parallel":JO,"coordinate.fisheye":U5,"coordinate.radial":Lb,"coordinate.radar":j5,"encode.constant":V5,"encode.field":H5,"encode.transform":Z5,"encode.column":W5,"mark.interval":J5,"mark.rect":t4,"mark.line":C4,"mark.point":gL,"mark.text":SL,"mark.cell":wL,"mark.area":LL,"mark.link":w3,"mark.image":XL,"mark.polygon":QL,"mark.box":n6,"mark.vector":i6,"mark.lineX":l6,"mark.lineY":f6,"mark.connector":m6,"mark.range":y6,"mark.rangeX":x6,"mark.rangeY":T6,"mark.path":R6,"mark.shape":I6,"mark.density":N6,"mark.heatmap":z6,"mark.wordCloud":R3,"palette.category10":U6,"palette.category20":j6,"scale.linear":V6,"scale.ordinal":G6,"scale.band":$6,"scale.identity":K6,"scale.point":q6,"scale.time":_D,"scale.log":xD,"scale.pow":ED,"scale.sqrt":SD,"scale.threshold":TD,"scale.quantile":wD,"scale.quantize":AD,"scale.sequential":CD,"scale.constant":OD,"theme.classic":RD,"theme.classicDark":PD,"theme.academy":ID,"theme.light":z3,"theme.dark":MD,"component.axisX":LD,"component.axisY":DD,"component.legendCategory":j3,"component.legendContinuous":ev,"component.legends":BD,"component.title":kD,"component.sliderX":VD,"component.sliderY":HD,"component.scrollbarX":ZD,"component.scrollbarY":WD,"animation.scaleInX":W3,"animation.scaleOutX":DZ,"animation.scaleInY":GD,"animation.scaleOutY":NZ,"animation.waveIn":XD,"animation.fadeIn":YD,"animation.fadeOut":$D,"animation.zoomIn":BZ,"animation.zoomOut":FZ,"animation.pathIn":KD,"animation.morphing":eN,"animation.growInX":tN,"animation.growInY":nN,"interaction.elementHighlight":IT,"interaction.elementHighlightByX":rN,"interaction.elementHighlightByColor":iN,"interaction.elementSelect":LT,"interaction.elementSelectByX":oN,"interaction.elementSelectByColor":aN,"interaction.fisheye":JZ,"interaction.chartIndex":sN,"interaction.tooltip":EN,"interaction.legendFilter":AW,"interaction.legendHighlight":CW,"interaction.brushHighlight":eR,"interaction.brushXHighlight":LW,"interaction.brushYHighlight":DW,"interaction.brushAxisHighlight":HW,"interaction.brushFilter":iR,"interaction.brushXFilter":XW,"interaction.brushYFilter":YW,"interaction.sliderFilter":NN,"interaction.scrollbarFilter":JW,"interaction.poptip":kN,"interaction.treemapDrillDown":bG,"interaction.elementPointMove":AG,"composition.spaceLayer":JN,"composition.spaceFlex":eB,"composition.facetRect":iB,"composition.repeatMatrix":zG,"composition.facetCircle":WG,"composition.timingKeyframe":aB,"labelTransform.overlapHide":LY,"labelTransform.overlapDodgeY":BY,"labelTransform.overflowHide":FY,"labelTransform.contrastReverse":UY,"labelTransform.exceedAdjust":VY}}var l2=e=>e;function YT(e,t){e&&uF.hasOwnProperty(e.type)&&uF[e.type](e,t)}var cF={Feature:function(e,t){YT(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)YT(n[r].geometry,t)}},uF={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){CR(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)CR(n[r],t,0)},Polygon:function(e,t){fF(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)fF(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)YT(n[r],t)}};function CR(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function fF(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)CR(e[n],t,1);t.polygonEnd()}function sb(e,t){e&&cF.hasOwnProperty(e.type)?cF[e.type](e,t):YT(e,t)}class Jv{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],l=t+s,u=Math.abs(t)<Math.abs(s)?t-(l-s):s-(l-t);u&&(n[r++]=u),t=l}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,l=0;if(n>0){for(l=t[--n];n>0&&(r=l,i=t[--n],l=r+i,s=i-(l-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=l+i,i==r-l&&(l=r))}return l}}function Gte(e,t){const n=new Jv;if(t===void 0)for(let r of e)(r=+r)&&n.add(r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&n.add(i)}return+n}function Xte(e,t){const n=new Jv;let r=-1;return Float64Array.from(e,t===void 0?i=>n.add(+i||0):i=>n.add(+t(i,++r,e)||0))}var Ka=1e-6,hF=1e-12,qs=Math.PI,Yu=qs/2,dF=qs/4,Jp=qs*2,_d=180/qs,Ru=qs/180,Fl=Math.abs,lb=Math.atan,eg=Math.atan2,js=Math.cos,$T=Math.ceil,pF=Math.exp,Yte=Math.floor,$te=Math.hypot,KT=Math.log,OR=Math.pow,As=Math.sin,D0=Math.sign||function(e){return e>0?1:e<0?-1:0},_p=Math.sqrt,RR=Math.tan;function mF(e){return e>1?0:e<-1?qs:Math.acos(e)}function N0(e){return e>1?Yu:e<-1?-Yu:Math.asin(e)}function Kte(e){return(e=As(e/2))*e}function B0(){}var MR=new Jv,PR=new Jv,vF,gF,IR,LR,hy={point:B0,lineStart:B0,lineEnd:B0,polygonStart:function(){hy.lineStart=ZY,hy.lineEnd=GY},polygonEnd:function(){hy.lineStart=hy.lineEnd=hy.point=B0,MR.add(Fl(PR)),PR=new Jv},result:function(){var e=MR/2;return MR=new Jv,e}};function ZY(){hy.point=WY}function WY(e,t){hy.point=yF,vF=IR=e,gF=LR=t}function yF(e,t){PR.add(LR*e-IR*t),IR=e,LR=t}function GY(){yF(vF,gF)}var _F=hy,cb=1/0,qT=cb,c2=-cb,QT=c2,XY={point:YY,lineStart:B0,lineEnd:B0,polygonStart:B0,polygonEnd:B0,result:function(){var e=[[cb,qT],[c2,QT]];return c2=QT=-(qT=cb=1/0),e}};function YY(e,t){e<cb&&(cb=e),e>c2&&(c2=e),t<qT&&(qT=t),t>QT&&(QT=t)}var JT=XY,DR=0,NR=0,u2=0,ew=0,tw=0,ub=0,BR=0,FR=0,f2=0,bF,xF,uv,fv,um={point:w1,lineStart:EF,lineEnd:SF,polygonStart:function(){um.lineStart=qY,um.lineEnd=QY},polygonEnd:function(){um.point=w1,um.lineStart=EF,um.lineEnd=SF},result:function(){var e=f2?[BR/f2,FR/f2]:ub?[ew/ub,tw/ub]:u2?[DR/u2,NR/u2]:[NaN,NaN];return DR=NR=u2=ew=tw=ub=BR=FR=f2=0,e}};function w1(e,t){DR+=e,NR+=t,++u2}function EF(){um.point=$Y}function $Y(e,t){um.point=KY,w1(uv=e,fv=t)}function KY(e,t){var n=e-uv,r=t-fv,i=_p(n*n+r*r);ew+=i*(uv+e)/2,tw+=i*(fv+t)/2,ub+=i,w1(uv=e,fv=t)}function SF(){um.point=w1}function qY(){um.point=JY}function QY(){TF(bF,xF)}function JY(e,t){um.point=TF,w1(bF=uv=e,xF=fv=t)}function TF(e,t){var n=e-uv,r=t-fv,i=_p(n*n+r*r);ew+=i*(uv+e)/2,tw+=i*(fv+t)/2,ub+=i,i=fv*e-uv*t,BR+=i*(uv+e),FR+=i*(fv+t),f2+=i*3,w1(uv=e,fv=t)}var wF=um;function AF(e){this._context=e}AF.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Jp);break}}},result:B0};var kR=new Jv,zR,CF,OF,h2,d2,nw={point:B0,lineStart:function(){nw.point=e$},lineEnd:function(){zR&&RF(CF,OF),nw.point=B0},polygonStart:function(){zR=!0},polygonEnd:function(){zR=null},result:function(){var e=+kR;return kR=new Jv,e}};function e$(e,t){nw.point=RF,CF=h2=e,OF=d2=t}function RF(e,t){h2-=e,d2-=t,kR.add(_p(h2*h2+d2*d2)),h2=e,d2=t}var MF=nw;let PF,rw,IF,LF;class DF{constructor(t){this._append=t==null?NF:t$(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==IF||this._append!==rw){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,IF=r,rw=this._append,LF=this._,this._=i}this._+=LF;break}}}result(){const t=this._;return this._="",t.length?t:null}}function NF(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function t$(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return NF;if(t!==PF){const n=vf(10,t);PF=t,rw=function(i){let s=1;this._+=i[0];for(const l=i.length;s<l;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return rw}function BF(e,t){let n=3,r=4.5,i,s;function l(u){return u&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),sb(u,i(s))),s.result()}return l.area=function(u){return sb(u,i(_F)),_F.result()},l.measure=function(u){return sb(u,i(MF)),MF.result()},l.bounds=function(u){return sb(u,i(JT)),JT.result()},l.centroid=function(u){return sb(u,i(wF)),wF.result()},l.projection=function(u){return arguments.length?(i=u==null?(e=null,l2):(e=u).stream,l):e},l.context=function(u){return arguments.length?(s=u==null?(t=null,new DF(n)):new AF(t=u),typeof r!="function"&&s.pointRadius(r),l):t},l.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(s.pointRadius(+u),+u),l):r},l.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const h=Math.floor(u);if(!(h>=0))throw new RangeError(`invalid digits: ${u}`);n=h}return t===null&&(s=new DF(n)),l},l.projection(e).digits(n).context(t)}function fb(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function FF(e,t,n){var r=fb(e,t-Ka,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function kF(e,t,n){var r=fb(e,t-Ka,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function n$(){var e,t,n,r,i,s,l,u,h=10,p=h,m=90,y=360,b,w,R,P,I=2.5;function N(){return{type:"MultiLineString",coordinates:z()}}function z(){return fb($T(r/m)*m,n,m).map(R).concat(fb($T(u/y)*y,l,y).map(P)).concat(fb($T(t/h)*h,e,h).filter(function(Z){return Fl(Z%m)>Ka}).map(b)).concat(fb($T(s/p)*p,i,p).filter(function(Z){return Fl(Z%y)>Ka}).map(w))}return N.lines=function(){return z().map(function(Z){return{type:"LineString",coordinates:Z}})},N.outline=function(){return{type:"Polygon",coordinates:[R(r).concat(P(l).slice(1),R(n).reverse().slice(1),P(u).reverse().slice(1))]}},N.extent=function(Z){return arguments.length?N.extentMajor(Z).extentMinor(Z):N.extentMinor()},N.extentMajor=function(Z){return arguments.length?(r=+Z[0][0],n=+Z[1][0],u=+Z[0][1],l=+Z[1][1],r>n&&(Z=r,r=n,n=Z),u>l&&(Z=u,u=l,l=Z),N.precision(I)):[[r,u],[n,l]]},N.extentMinor=function(Z){return arguments.length?(t=+Z[0][0],e=+Z[1][0],s=+Z[0][1],i=+Z[1][1],t>e&&(Z=t,t=e,e=Z),s>i&&(Z=s,s=i,i=Z),N.precision(I)):[[t,s],[e,i]]},N.step=function(Z){return arguments.length?N.stepMajor(Z).stepMinor(Z):N.stepMinor()},N.stepMajor=function(Z){return arguments.length?(m=+Z[0],y=+Z[1],N):[m,y]},N.stepMinor=function(Z){return arguments.length?(h=+Z[0],p=+Z[1],N):[h,p]},N.precision=function(Z){return arguments.length?(I=+Z,b=FF(s,i,90),w=kF(t,e,I),R=FF(u,l,90),P=kF(r,n,I),N):I},N.extentMajor([[-180,-90+Ka],[180,90-Ka]]).extentMinor([[-180,-80-Ka],[180,80+Ka]])}function r$(){return n$()()}function zF(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:B0,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function iw(e,t){return Fl(e[0]-t[0])<Ka&&Fl(e[1]-t[1])<Ka}function ow(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function UF(e,t,n,r,i){var s=[],l=[],u,h;if(e.forEach(function(R){if(!((P=R.length-1)<=0)){var P,I=R[0],N=R[P],z;if(iw(I,N)){if(!I[2]&&!N[2]){for(i.lineStart(),u=0;u<P;++u)i.point((I=R[u])[0],I[1]);i.lineEnd();return}N[0]+=2*Ka}s.push(z=new ow(I,R,null,!0)),l.push(z.o=new ow(I,null,z,!1)),s.push(z=new ow(N,R,null,!1)),l.push(z.o=new ow(N,null,z,!0))}}),!!s.length){for(l.sort(t),jF(s),jF(l),u=0,h=l.length;u<h;++u)l[u].e=n=!n;for(var p=s[0],m,y;;){for(var b=p,w=!0;b.v;)if((b=b.n)===p)return;m=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(w)for(u=0,h=m.length;u<h;++u)i.point((y=m[u])[0],y[1]);else r(b.x,b.n.x,1,i);b=b.n}else{if(w)for(m=b.p.z,u=m.length-1;u>=0;--u)i.point((y=m[u])[0],y[1]);else r(b.x,b.p.x,-1,i);b=b.p}b=b.o,m=b.z,w=!w}while(!b.v);i.lineEnd()}}}function jF(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function UR(e){return[eg(e[1],e[0]),N0(e[2])]}function hb(e){var t=e[0],n=e[1],r=js(n);return[r*js(t),r*As(t),As(n)]}function aw(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function sw(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function jR(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function lw(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function VR(e){var t=_p(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function HR(e){return Fl(e[0])<=qs?e[0]:D0(e[0])*((Fl(e[0])+qs)%Jp-qs)}function i$(e,t){var n=HR(t),r=t[1],i=As(r),s=[As(n),-js(n),0],l=0,u=0,h=new Jv;i===1?r=Yu+Ka:i===-1&&(r=-Yu-Ka);for(var p=0,m=e.length;p<m;++p)if(b=(y=e[p]).length)for(var y,b,w=y[b-1],R=HR(w),P=w[1]/2+dF,I=As(P),N=js(P),z=0;z<b;++z,R=Y,I=J,N=ae,w=Z){var Z=y[z],Y=HR(Z),$=Z[1]/2+dF,J=As($),ae=js($),pe=Y-R,Oe=pe>=0?1:-1,Ve=Oe*pe,Ke=Ve>qs,lt=I*J;if(h.add(eg(lt*Oe*As(Ve),N*ae+lt*js(Ve))),l+=Ke?pe+Oe*Jp:pe,Ke^R>=n^Y>=n){var Ge=sw(hb(w),hb(Z));VR(Ge);var rt=sw(s,Ge);VR(rt);var st=(Ke^pe>=0?-1:1)*N0(rt[2]);(r>st||r===st&&(Ge[0]||Ge[1]))&&(u+=Ke^pe>=0?1:-1)}}return(l<-Ka||l<Ka&&h<-hF)^u&1}function*o$(e){for(const t of e)yield*Ak(t)}function VF(e){return Array.from(o$(e))}function HF(e,t,n,r){return function(i){var s=t(i),l=zF(),u=t(l),h=!1,p,m,y,b={point:w,lineStart:P,lineEnd:I,polygonStart:function(){b.point=N,b.lineStart=z,b.lineEnd=Z,m=[],p=[]},polygonEnd:function(){b.point=w,b.lineStart=P,b.lineEnd=I,m=VF(m);var Y=i$(p,r);m.length?(h||(i.polygonStart(),h=!0),UF(m,s$,Y,n,i)):Y&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),m=p=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function w(Y,$){e(Y,$)&&i.point(Y,$)}function R(Y,$){s.point(Y,$)}function P(){b.point=R,s.lineStart()}function I(){b.point=w,s.lineEnd()}function N(Y,$){y.push([Y,$]),u.point(Y,$)}function z(){u.lineStart(),y=[]}function Z(){N(y[0][0],y[0][1]),u.lineEnd();var Y=u.clean(),$=l.result(),J,ae=$.length,pe,Oe,Ve;if(y.pop(),p.push(y),y=null,!!ae){if(Y&1){if(Oe=$[0],(pe=Oe.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),J=0;J<pe;++J)i.point((Ve=Oe[J])[0],Ve[1]);i.lineEnd()}return}ae>1&&Y&2&&$.push($.pop().concat($.shift())),m.push($.filter(a$))}}return b}}function a$(e){return e.length>1}function s$(e,t){return((e=e.x)[0]<0?e[1]-Yu-Ka:Yu-e[1])-((t=t.x)[0]<0?t[1]-Yu-Ka:Yu-t[1])}var ZF=HF(function(){return!0},l$,u$,[-qs,-Yu]);function l$(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,l){var u=s>0?qs:-qs,h=Fl(s-t);Fl(h-qs)<Ka?(e.point(t,n=(n+l)/2>0?Yu:-Yu),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(s,n),i=0):r!==u&&h>=qs&&(Fl(t-r)<Ka&&(t-=r*Ka),Fl(s-u)<Ka&&(s-=u*Ka),n=c$(t,n,s,l),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),i=0),e.point(t=s,n=l),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function c$(e,t,n,r){var i,s,l=As(e-n);return Fl(l)>Ka?lb((As(t)*(s=js(r))*As(n)-As(r)*(i=js(t))*As(e))/(i*s*l)):(t+r)/2}function u$(e,t,n,r){var i;if(e==null)i=n*Yu,r.point(-qs,i),r.point(0,i),r.point(qs,i),r.point(qs,0),r.point(qs,-i),r.point(0,-i),r.point(-qs,-i),r.point(-qs,0),r.point(-qs,i);else if(Fl(e[0]-t[0])>Ka){var s=e[0]<t[0]?qs:-qs;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function WF(e,t,n,r,i,s){if(n){var l=js(t),u=As(t),h=r*n;i==null?(i=t+r*Jp,s=t-h/2):(i=GF(l,i),s=GF(l,s),(r>0?i<s:i>s)&&(i+=r*Jp));for(var p,m=i;r>0?m>s:m<s;m-=h)p=UR([l,-u*js(m),-u*As(m)]),e.point(p[0],p[1])}}function GF(e,t){t=hb(t),t[0]-=e,VR(t);var n=mF(-t[1]);return((-t[2]<0?-n:n)+Jp-Ka)%Jp}function qte(){var e=constant([0,0]),t=constant(90),n=constant(2),r,i,s={point:l};function l(h,p){r.push(h=i(h,p)),h[0]*=degrees,h[1]*=degrees}function u(){var h=e.apply(this,arguments),p=t.apply(this,arguments)*radians,m=n.apply(this,arguments)*radians;return r=[],i=rotateRadians(-h[0]*radians,-h[1]*radians,0).invert,WF(s,p,m,1),h={type:"Polygon",coordinates:[r]},r=i=null,h}return u.center=function(h){return arguments.length?(e=typeof h=="function"?h:constant([+h[0],+h[1]]),u):e},u.radius=function(h){return arguments.length?(t=typeof h=="function"?h:constant(+h),u):t},u.precision=function(h){return arguments.length?(n=typeof h=="function"?h:constant(+h),u):n},u}function f$(e){var t=js(e),n=2*Ru,r=t>0,i=Fl(t)>Ka;function s(m,y,b,w){WF(w,e,n,b,m,y)}function l(m,y){return js(m)*js(y)>t}function u(m){var y,b,w,R,P;return{lineStart:function(){R=w=!1,P=1},point:function(I,N){var z=[I,N],Z,Y=l(I,N),$=r?Y?0:p(I,N):Y?p(I+(I<0?qs:-qs),N):0;if(!y&&(R=w=Y)&&m.lineStart(),Y!==w&&(Z=h(y,z),(!Z||iw(y,Z)||iw(z,Z))&&(z[2]=1)),Y!==w)P=0,Y?(m.lineStart(),Z=h(z,y),m.point(Z[0],Z[1])):(Z=h(y,z),m.point(Z[0],Z[1],2),m.lineEnd()),y=Z;else if(i&&y&&r^Y){var J;!($&b)&&(J=h(z,y,!0))&&(P=0,r?(m.lineStart(),m.point(J[0][0],J[0][1]),m.point(J[1][0],J[1][1]),m.lineEnd()):(m.point(J[1][0],J[1][1]),m.lineEnd(),m.lineStart(),m.point(J[0][0],J[0][1],3)))}Y&&(!y||!iw(y,z))&&m.point(z[0],z[1]),y=z,w=Y,b=$},lineEnd:function(){w&&m.lineEnd(),y=null},clean:function(){return P|(R&&w)<<1}}}function h(m,y,b){var w=hb(m),R=hb(y),P=[1,0,0],I=sw(w,R),N=aw(I,I),z=I[0],Z=N-z*z;if(!Z)return!b&&m;var Y=t*N/Z,$=-t*z/Z,J=sw(P,I),ae=lw(P,Y),pe=lw(I,$);jR(ae,pe);var Oe=J,Ve=aw(ae,Oe),Ke=aw(Oe,Oe),lt=Ve*Ve-Ke*(aw(ae,ae)-1);if(!(lt<0)){var Ge=_p(lt),rt=lw(Oe,(-Ve-Ge)/Ke);if(jR(rt,ae),rt=UR(rt),!b)return rt;var st=m[0],ut=y[0],jt=m[1],At=y[1],zt;ut<st&&(zt=st,st=ut,ut=zt);var wn=ut-st,Hn=Fl(wn-qs)<Ka,rr=Hn||wn<Ka;if(!Hn&&At<jt&&(zt=jt,jt=At,At=zt),rr?Hn?jt+At>0^rt[1]<(Fl(rt[0]-st)<Ka?jt:At):jt<=rt[1]&&rt[1]<=At:wn>qs^(st<=rt[0]&&rt[0]<=ut)){var or=lw(Oe,(-Ve+Ge)/Ke);return jR(or,ae),[rt,UR(or)]}}}function p(m,y){var b=r?e:qs-e,w=0;return m<-b?w|=1:m>b&&(w|=2),y<-b?w|=4:y>b&&(w|=8),w}return HF(l,u,s,r?[0,-e]:[-qs,e-qs])}function h$(e,t,n,r,i,s){var l=e[0],u=e[1],h=t[0],p=t[1],m=0,y=1,b=h-l,w=p-u,R;if(R=n-l,!(!b&&R>0)){if(R/=b,b<0){if(R<m)return;R<y&&(y=R)}else if(b>0){if(R>y)return;R>m&&(m=R)}if(R=i-l,!(!b&&R<0)){if(R/=b,b<0){if(R>y)return;R>m&&(m=R)}else if(b>0){if(R<m)return;R<y&&(y=R)}if(R=r-u,!(!w&&R>0)){if(R/=w,w<0){if(R<m)return;R<y&&(y=R)}else if(w>0){if(R>y)return;R>m&&(m=R)}if(R=s-u,!(!w&&R<0)){if(R/=w,w<0){if(R>y)return;R>m&&(m=R)}else if(w>0){if(R<m)return;R<y&&(y=R)}return m>0&&(e[0]=l+m*b,e[1]=u+m*w),y<1&&(t[0]=l+y*b,t[1]=u+y*w),!0}}}}}var p2=1e9,cw=-p2;function XF(e,t,n,r){function i(p,m){return e<=p&&p<=n&&t<=m&&m<=r}function s(p,m,y,b){var w=0,R=0;if(p==null||(w=l(p,y))!==(R=l(m,y))||h(p,m)<0^y>0)do b.point(w===0||w===3?e:n,w>1?r:t);while((w=(w+y+4)%4)!==R);else b.point(m[0],m[1])}function l(p,m){return Fl(p[0]-e)<Ka?m>0?0:3:Fl(p[0]-n)<Ka?m>0?2:1:Fl(p[1]-t)<Ka?m>0?1:0:m>0?3:2}function u(p,m){return h(p.x,m.x)}function h(p,m){var y=l(p,1),b=l(m,1);return y!==b?y-b:y===0?m[1]-p[1]:y===1?p[0]-m[0]:y===2?p[1]-m[1]:m[0]-p[0]}return function(p){var m=p,y=zF(),b,w,R,P,I,N,z,Z,Y,$,J,ae={point:pe,lineStart:lt,lineEnd:Ge,polygonStart:Ve,polygonEnd:Ke};function pe(st,ut){i(st,ut)&&m.point(st,ut)}function Oe(){for(var st=0,ut=0,jt=w.length;ut<jt;++ut)for(var At=w[ut],zt=1,wn=At.length,Hn=At[0],rr,or,Hr=Hn[0],ui=Hn[1];zt<wn;++zt)rr=Hr,or=ui,Hn=At[zt],Hr=Hn[0],ui=Hn[1],or<=r?ui>r&&(Hr-rr)*(r-or)>(ui-or)*(e-rr)&&++st:ui<=r&&(Hr-rr)*(r-or)<(ui-or)*(e-rr)&&--st;return st}function Ve(){m=y,b=[],w=[],J=!0}function Ke(){var st=Oe(),ut=J&&st,jt=(b=VF(b)).length;(ut||jt)&&(p.polygonStart(),ut&&(p.lineStart(),s(null,null,1,p),p.lineEnd()),jt&&UF(b,u,st,s,p),p.polygonEnd()),m=p,b=w=R=null}function lt(){ae.point=rt,w&&w.push(R=[]),$=!0,Y=!1,z=Z=NaN}function Ge(){b&&(rt(P,I),N&&Y&&y.rejoin(),b.push(y.result())),ae.point=pe,Y&&m.lineEnd()}function rt(st,ut){var jt=i(st,ut);if(w&&R.push([st,ut]),$)P=st,I=ut,N=jt,$=!1,jt&&(m.lineStart(),m.point(st,ut));else if(jt&&Y)m.point(st,ut);else{var At=[z=Math.max(cw,Math.min(p2,z)),Z=Math.max(cw,Math.min(p2,Z))],zt=[st=Math.max(cw,Math.min(p2,st)),ut=Math.max(cw,Math.min(p2,ut))];h$(At,zt,e,t,n,r)?(Y||(m.lineStart(),m.point(At[0],At[1])),m.point(zt[0],zt[1]),jt||m.lineEnd(),J=!1):jt&&(m.lineStart(),m.point(st,ut),J=!1)}z=st,Z=ut,Y=jt}return ae}}function ZR(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function WR(e,t){return Fl(e)>qs&&(e-=Math.round(e/Jp)*Jp),[e,t]}WR.invert=WR;function YF(e,t,n){return(e%=Jp)?t||n?ZR(KF(e),qF(t,n)):KF(e):t||n?qF(t,n):WR}function $F(e){return function(t,n){return t+=e,Fl(t)>qs&&(t-=Math.round(t/Jp)*Jp),[t,n]}}function KF(e){var t=$F(e);return t.invert=$F(-e),t}function qF(e,t){var n=js(e),r=As(e),i=js(t),s=As(t);function l(u,h){var p=js(h),m=js(u)*p,y=As(u)*p,b=As(h),w=b*n+m*r;return[eg(y*i-w*s,m*n-b*r),N0(w*i+y*s)]}return l.invert=function(u,h){var p=js(h),m=js(u)*p,y=As(u)*p,b=As(h),w=b*i-y*s;return[eg(y*i+b*s,m*n+w*r),N0(w*n-m*r)]},l}function d$(e){e=YF(e[0]*Ru,e[1]*Ru,e.length>2?e[2]*Ru:0);function t(n){return n=e(n[0]*Ru,n[1]*Ru),n[0]*=_d,n[1]*=_d,n}return t.invert=function(n){return n=e.invert(n[0]*Ru,n[1]*Ru),n[0]*=_d,n[1]*=_d,n},t}function Qte(e){return{stream:m2(e)}}function m2(e){return function(t){var n=new GR;for(var r in e)n[r]=e[r];return n.stream=t,n}}function GR(){}GR.prototype={constructor:GR,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function XR(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),sb(n,e.stream(JT)),t(JT.result()),r!=null&&e.clipExtent(r),e}function uw(e,t,n){return XR(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],l=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),u=+t[0][0]+(i-l*(r[1][0]+r[0][0]))/2,h=+t[0][1]+(s-l*(r[1][1]+r[0][1]))/2;e.scale(150*l).translate([u,h])},n)}function YR(e,t,n){return uw(e,[[0,0],t],n)}function $R(e,t,n){return XR(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),l=(i-s*(r[1][0]+r[0][0]))/2,u=-s*r[0][1];e.scale(150*s).translate([l,u])},n)}function KR(e,t,n){return XR(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),l=-s*r[0][0],u=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([l,u])},n)}var QF=16,p$=js(30*Ru);function JF(e,t){return+t?v$(e,t):m$(e)}function m$(e){return m2({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function v$(e,t){function n(r,i,s,l,u,h,p,m,y,b,w,R,P,I){var N=p-r,z=m-i,Z=N*N+z*z;if(Z>4*t&&P--){var Y=l+b,$=u+w,J=h+R,ae=_p(Y*Y+$*$+J*J),pe=N0(J/=ae),Oe=Fl(Fl(J)-1)<Ka||Fl(s-y)<Ka?(s+y)/2:eg($,Y),Ve=e(Oe,pe),Ke=Ve[0],lt=Ve[1],Ge=Ke-r,rt=lt-i,st=z*Ge-N*rt;(st*st/Z>t||Fl((N*Ge+z*rt)/Z-.5)>.3||l*b+u*w+h*R<p$)&&(n(r,i,s,l,u,h,Ke,lt,Oe,Y/=ae,$/=ae,J,P,I),I.point(Ke,lt),n(Ke,lt,Oe,Y,$,J,p,m,y,b,w,R,P,I))}}return function(r){var i,s,l,u,h,p,m,y,b,w,R,P,I={point:N,lineStart:z,lineEnd:Y,polygonStart:function(){r.polygonStart(),I.lineStart=$},polygonEnd:function(){r.polygonEnd(),I.lineStart=z}};function N(pe,Oe){pe=e(pe,Oe),r.point(pe[0],pe[1])}function z(){y=NaN,I.point=Z,r.lineStart()}function Z(pe,Oe){var Ve=hb([pe,Oe]),Ke=e(pe,Oe);n(y,b,m,w,R,P,y=Ke[0],b=Ke[1],m=pe,w=Ve[0],R=Ve[1],P=Ve[2],QF,r),r.point(y,b)}function Y(){I.point=N,r.lineEnd()}function $(){z(),I.point=J,I.lineEnd=ae}function J(pe,Oe){Z(i=pe,Oe),s=y,l=b,u=w,h=R,p=P,I.point=Z}function ae(){n(y,b,m,w,R,P,s,l,i,u,h,p,QF,r),I.lineEnd=Y,Y()}return I}}var g$=m2({point:function(e,t){this.stream.point(e*Ru,t*Ru)}});function y$(e){return m2({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function _$(e,t,n,r,i){function s(l,u){return l*=r,u*=i,[t+e*l,n-e*u]}return s.invert=function(l,u){return[(l-t)/e*r,(n-u)/e*i]},s}function e8(e,t,n,r,i,s){if(!s)return _$(e,t,n,r,i);var l=js(s),u=As(s),h=l*e,p=u*e,m=l/e,y=u/e,b=(u*n-l*t)/e,w=(u*t+l*n)/e;function R(P,I){return P*=r,I*=i,[h*P-p*I+t,n-p*P-h*I]}return R.invert=function(P,I){return[r*(m*P-y*I+b),i*(w-y*P-m*I)]},R}function hv(e){return qR(function(){return e})()}function qR(e){var t,n=150,r=480,i=250,s=0,l=0,u=0,h=0,p=0,m,y=0,b=1,w=1,R=null,P=ZF,I=null,N,z,Z,Y=l2,$=.5,J,ae,pe,Oe,Ve;function Ke(st){return pe(st[0]*Ru,st[1]*Ru)}function lt(st){return st=pe.invert(st[0],st[1]),st&&[st[0]*_d,st[1]*_d]}Ke.stream=function(st){return Oe&&Ve===st?Oe:Oe=g$(y$(m)(P(J(Y(Ve=st)))))},Ke.preclip=function(st){return arguments.length?(P=st,R=void 0,rt()):P},Ke.postclip=function(st){return arguments.length?(Y=st,I=N=z=Z=null,rt()):Y},Ke.clipAngle=function(st){return arguments.length?(P=+st?f$(R=st*Ru):(R=null,ZF),rt()):R*_d},Ke.clipExtent=function(st){return arguments.length?(Y=st==null?(I=N=z=Z=null,l2):XF(I=+st[0][0],N=+st[0][1],z=+st[1][0],Z=+st[1][1]),rt()):I==null?null:[[I,N],[z,Z]]},Ke.scale=function(st){return arguments.length?(n=+st,Ge()):n},Ke.translate=function(st){return arguments.length?(r=+st[0],i=+st[1],Ge()):[r,i]},Ke.center=function(st){return arguments.length?(s=st[0]%360*Ru,l=st[1]%360*Ru,Ge()):[s*_d,l*_d]},Ke.rotate=function(st){return arguments.length?(u=st[0]%360*Ru,h=st[1]%360*Ru,p=st.length>2?st[2]%360*Ru:0,Ge()):[u*_d,h*_d,p*_d]},Ke.angle=function(st){return arguments.length?(y=st%360*Ru,Ge()):y*_d},Ke.reflectX=function(st){return arguments.length?(b=st?-1:1,Ge()):b<0},Ke.reflectY=function(st){return arguments.length?(w=st?-1:1,Ge()):w<0},Ke.precision=function(st){return arguments.length?(J=JF(ae,$=st*st),rt()):_p($)},Ke.fitExtent=function(st,ut){return uw(Ke,st,ut)},Ke.fitSize=function(st,ut){return YR(Ke,st,ut)},Ke.fitWidth=function(st,ut){return $R(Ke,st,ut)},Ke.fitHeight=function(st,ut){return KR(Ke,st,ut)};function Ge(){var st=e8(n,0,0,b,w,y).apply(null,t(s,l)),ut=e8(n,r-st[0],i-st[1],b,w,y);return m=YF(u,h,p),ae=ZR(t,ut),pe=ZR(m,ae),J=JF(ae,$),rt()}function rt(){return Oe=Ve=null,Ke}return function(){return t=e.apply(this,arguments),Ke.invert=t.invert&&lt,Ge()}}function QR(e){var t=0,n=qs/3,r=qR(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Ru,n=s[1]*Ru):[t*_d,n*_d]},i}function b$(e){var t=js(e);function n(r,i){return[r*t,As(i)/t]}return n.invert=function(r,i){return[r/t,N0(i*t)]},n}function t8(e,t){var n=As(e),r=(n+As(t))/2;if(Fl(r)<Ka)return b$(e);var i=1+n*(2*r-n),s=_p(i)/r;function l(u,h){var p=_p(i-2*r*As(h))/r;return[p*As(u*=r),s-p*js(u)]}return l.invert=function(u,h){var p=s-h,m=eg(u,Fl(p))*D0(p);return p*r<0&&(m-=qs*D0(u)*D0(p)),[m/r,N0((i-(u*u+p*p)*r*r)/(2*r))]},l}function fw(){return QR(t8).scale(155.424).center([0,33.6442])}function n8(){return fw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function x$(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function E$(){var e,t,n=n8(),r,i=fw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,l=fw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,h,p={point:function(b,w){h=[b,w]}};function m(b){var w=b[0],R=b[1];return h=null,r.point(w,R),h||(s.point(w,R),h)||(u.point(w,R),h)}m.invert=function(b){var w=n.scale(),R=n.translate(),P=(b[0]-R[0])/w,I=(b[1]-R[1])/w;return(I>=.12&&I<.234&&P>=-.425&&P<-.214?i:I>=.166&&I<.234&&P>=-.214&&P<-.115?l:n).invert(b)},m.stream=function(b){return e&&t===b?e:e=x$([n.stream(t=b),i.stream(b),l.stream(b)])},m.precision=function(b){return arguments.length?(n.precision(b),i.precision(b),l.precision(b),y()):n.precision()},m.scale=function(b){return arguments.length?(n.scale(b),i.scale(b*.35),l.scale(b),m.translate(n.translate())):n.scale()},m.translate=function(b){if(!arguments.length)return n.translate();var w=n.scale(),R=+b[0],P=+b[1];return r=n.translate(b).clipExtent([[R-.455*w,P-.238*w],[R+.455*w,P+.238*w]]).stream(p),s=i.translate([R-.307*w,P+.201*w]).clipExtent([[R-.425*w+Ka,P+.12*w+Ka],[R-.214*w-Ka,P+.234*w-Ka]]).stream(p),u=l.translate([R-.205*w,P+.212*w]).clipExtent([[R-.214*w+Ka,P+.166*w+Ka],[R-.115*w-Ka,P+.234*w-Ka]]).stream(p),y()},m.fitExtent=function(b,w){return uw(m,b,w)},m.fitSize=function(b,w){return YR(m,b,w)},m.fitWidth=function(b,w){return $R(m,b,w)},m.fitHeight=function(b,w){return KR(m,b,w)};function y(){return e=t=null,m}return m.scale(1070)}function r8(e){return function(t,n){var r=js(t),i=js(n),s=e(r*i);return s===1/0?[2,0]:[s*i*As(t),s*As(n)]}}function v2(e){return function(t,n){var r=_p(t*t+n*n),i=e(r),s=As(i),l=js(i);return[eg(t*s,r*l),N0(r&&n*s/r)]}}var JR=r8(function(e){return _p(2/(1+e))});JR.invert=v2(function(e){return 2*N0(e/2)});function S$(){return hv(JR).scale(124.75).clipAngle(180-.001)}var eM=r8(function(e){return(e=mF(e))&&e/As(e)});eM.invert=v2(function(e){return e});function T$(){return hv(eM).scale(79.4188).clipAngle(180-.001)}function g2(e,t){return[e,KT(RR((Yu+t)/2))]}g2.invert=function(e,t){return[e,2*lb(pF(t))-Yu]};function w$(){return i8(g2).scale(961/Jp)}function i8(e){var t=hv(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,l=null,u,h,p;t.scale=function(y){return arguments.length?(r(y),m()):r()},t.translate=function(y){return arguments.length?(i(y),m()):i()},t.center=function(y){return arguments.length?(n(y),m()):n()},t.clipExtent=function(y){return arguments.length?(y==null?l=u=h=p=null:(l=+y[0][0],u=+y[0][1],h=+y[1][0],p=+y[1][1]),m()):l==null?null:[[l,u],[h,p]]};function m(){var y=qs*r(),b=t(d$(t.rotate()).invert([0,0]));return s(l==null?[[b[0]-y,b[1]-y],[b[0]+y,b[1]+y]]:e===g2?[[Math.max(b[0]-y,l),u],[Math.min(b[0]+y,h),p]]:[[l,Math.max(b[1]-y,u)],[h,Math.min(b[1]+y,p)]])}return m()}function hw(e){return RR((Yu+e)/2)}function o8(e,t){var n=js(e),r=e===t?As(e):KT(n/js(t))/KT(hw(t)/hw(e)),i=n*OR(hw(e),r)/r;if(!r)return g2;function s(l,u){i>0?u<-Yu+Ka&&(u=-Yu+Ka):u>Yu-Ka&&(u=Yu-Ka);var h=i/OR(hw(u),r);return[h*As(r*l),i-h*js(r*l)]}return s.invert=function(l,u){var h=i-u,p=D0(r)*_p(l*l+h*h),m=eg(l,Fl(h))*D0(h);return h*r<0&&(m-=qs*D0(l)*D0(h)),[m/r,2*lb(OR(i/p,1/r))-Yu]},s}function A$(){return QR(o8).scale(109.5).parallels([30,30])}function y2(e,t){return[e,t]}y2.invert=y2;function C$(){return hv(y2).scale(152.63)}function a8(e,t){var n=js(e),r=e===t?As(e):(n-js(t))/(t-e),i=n/r+e;if(Fl(r)<Ka)return y2;function s(l,u){var h=i-u,p=r*l;return[h*As(p),i-h*js(p)]}return s.invert=function(l,u){var h=i-u,p=eg(l,Fl(h))*D0(h);return h*r<0&&(p-=qs*D0(l)*D0(h)),[p/r,i-D0(r)*_p(l*l+h*h)]},s}function O$(){return QR(a8).scale(131.154).center([0,13.9389])}var _2=1.340264,b2=-.081106,x2=893e-6,E2=.003796,dw=_p(3)/2,R$=12;function tM(e,t){var n=N0(dw*As(t)),r=n*n,i=r*r*r;return[e*js(n)/(dw*(_2+3*b2*r+i*(7*x2+9*E2*r))),n*(_2+b2*r+i*(x2+E2*r))]}tM.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,l,u,h;s<R$&&(u=n*(_2+b2*r+i*(x2+E2*r))-t,h=_2+3*b2*r+i*(7*x2+9*E2*r),n-=l=u/h,r=n*n,i=r*r*r,!(Fl(l)<hF));++s);return[dw*e*(_2+3*b2*r+i*(7*x2+9*E2*r))/js(n),N0(As(n)/dw)]};function M$(){return hv(tM).scale(177.158)}function nM(e,t){var n=js(t),r=js(e)*n;return[n*As(e)/r,As(t)/r]}nM.invert=v2(lb);function P$(){return hv(nM).scale(144.049).clipAngle(60)}function I$(){var e=1,t=0,n=0,r=1,i=1,s=0,l,u,h=null,p,m,y,b=1,w=1,R=m2({point:function(Y,$){var J=Z([Y,$]);this.stream.point(J[0],J[1])}}),P=l2,I,N;function z(){return b=e*r,w=e*i,I=N=null,Z}function Z(Y){var $=Y[0]*b,J=Y[1]*w;if(s){var ae=J*l-$*u;$=$*l+J*u,J=ae}return[$+t,J+n]}return Z.invert=function(Y){var $=Y[0]-t,J=Y[1]-n;if(s){var ae=J*l+$*u;$=$*l-J*u,J=ae}return[$/b,J/w]},Z.stream=function(Y){return I&&N===Y?I:I=R(P(N=Y))},Z.postclip=function(Y){return arguments.length?(P=Y,h=p=m=y=null,z()):P},Z.clipExtent=function(Y){return arguments.length?(P=Y==null?(h=p=m=y=null,l2):XF(h=+Y[0][0],p=+Y[0][1],m=+Y[1][0],y=+Y[1][1]),z()):h==null?null:[[h,p],[m,y]]},Z.scale=function(Y){return arguments.length?(e=+Y,z()):e},Z.translate=function(Y){return arguments.length?(t=+Y[0],n=+Y[1],z()):[t,n]},Z.angle=function(Y){return arguments.length?(s=Y%360*Ru,u=As(s),l=js(s),z()):s*_d},Z.reflectX=function(Y){return arguments.length?(r=Y?-1:1,z()):r<0},Z.reflectY=function(Y){return arguments.length?(i=Y?-1:1,z()):i<0},Z.fitExtent=function(Y,$){return uw(Z,Y,$)},Z.fitSize=function(Y,$){return YR(Z,Y,$)},Z.fitWidth=function(Y,$){return $R(Z,Y,$)},Z.fitHeight=function(Y,$){return KR(Z,Y,$)},Z}function rM(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}rM.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,l=s*s;n-=i=(n*(1.007226+s*(.015085+l*(-.044475+.028874*s-.005916*l)))-t)/(1.007226+s*(.015085*3+l*(-.044475*7+.028874*9*s-.005916*11*l)))}while(Fl(i)>Ka&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function L$(){return hv(rM).scale(175.295)}function iM(e,t){return[js(t)*As(e),As(t)]}iM.invert=v2(N0);function D$(){return hv(iM).scale(249.5).clipAngle(90+Ka)}function oM(e,t){var n=js(t),r=1+js(e)*n;return[n*As(e)/r,As(t)/r]}oM.invert=v2(function(e){return 2*lb(e)});function N$(){return hv(oM).scale(250).clipAngle(142)}function aM(e,t){return[KT(RR((Yu+t)/2)),-e]}aM.invert=function(e,t){return[-t,2*lb(pF(e))-Yu]};function B$(){var e=i8(aM),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var F$=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function k$(e){if(typeof e=="function")return e;const t=`geo${Zm(e)}`,n=E[t];if(!n)throw new Error(`Unknown coordinate: ${e}`);return n}function z$(e){return{type:"FeatureCollection",features:e.flatMap(t=>U$(t).features)}}function U$(e){const t={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!e||!e.type)return null;const n=t[e.type];if(!n)return null;if(n==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(n==="feature")return{type:"FeatureCollection",features:[e]};if(n==="featureCollection")return e}function j$(e,t){var n;for(const[r,i]of Object.entries(t))(n=e[r])===null||n===void 0||n.call(e,i)}function V$(e,t,n,r){const i=()=>{const u=t.filter(s8);return u.find(p=>p.sphere)?{type:"Sphere"}:z$(u.filter(p=>!p.sphere).flatMap(p=>p.data.value))},{outline:s=i()}=r,{size:l="fitExtent"}=r;if(l==="fitExtent")return H$(e,s,n);if(l==="fitWidth")return Z$(e,s,n)}function H$(e,t,n){const{x:r,y:i,width:s,height:l}=n;e.fitExtent([[r,i],[s,l]],t)}function Z$(e,t,n){const{width:r,height:i}=n,[[s,l],[u,h]]=BF(e.fitWidth(r,t)).bounds(t),p=Math.ceil(h-l),m=Math.min(Math.ceil(u-s),p),y=e.scale()*(m-1)/m,[b,w]=e.translate(),R=w+(i-p)/2;e.scale(y).translate([b,R]).precision(.2)}function W$(e){const{data:t}=e;if(Array.isArray(t))return Object.assign(Object.assign({},e),{data:{value:t}});const{type:n}=t;return n==="graticule10"?Object.assign(Object.assign({},e),{data:{value:[r$()]}}):n==="sphere"?Object.assign(Object.assign({},e),{sphere:!0,data:{value:[{type:"Sphere"}]}}):e}function s8(e){return e.type==="geoPath"}const l8=()=>e=>{const{children:t,coordinate:n={}}=e;if(!Array.isArray(t))return[];const{type:r="equalEarth"}=n,i=F$(n,["type"]),s=k$(r),l=t.map(W$);let u;function h(){return[["custom",(y,b,w,R)=>{const P=s();V$(P,l,{x:y,y:b,width:w,height:R},i),j$(P,i),u=BF(P);const N=new Gf({domain:[y,y+w]}),z=new Gf({domain:[b,b+R]}),Z=$=>{const J=P($);if(!J)return[null,null];const[ae,pe]=J;return[N.map(ae),z.map(pe)]},Y=$=>{if(!$)return null;const[J,ae]=$,pe=[N.invert(J),z.invert(ae)];return P.invert(pe)};return{transform:$=>Z($),untransform:$=>Y($)}}]]}function p(y){const{style:b,tooltip:w={}}=y;return Object.assign(Object.assign({},y),{type:"path",tooltip:sT(w,{title:"id",items:[{channel:"color"}]}),style:Object.assign(Object.assign({},b),{d:R=>u(R)||[]})})}const m=y=>s8(y)?p(y):y;return[Object.assign(Object.assign({},e),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinate:{type:h},children:l.flatMap(m)})]};l8.props={};var G$=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const c8=()=>e=>{const{type:t,data:n,scale:r,encode:i,style:s,animate:l,key:u,state:h}=e,p=G$(e,["type","data","scale","encode","style","animate","key","state"]);return[Object.assign(Object.assign({type:"geoView"},p),{children:[{type:"geoPath",key:`${u}-0`,data:{value:n},scale:r,encode:i,style:s,animate:l,state:h}]})]};c8.props={};function X$(){return{"composition.geoView":l8,"composition.geoPath":c8}}function Y$(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return u8(this.cover(t,n),t,n,e)}function u8(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,l={data:r},u=e._x0,h=e._y0,p=e._x1,m=e._y1,y,b,w,R,P,I,N,z;if(!s)return e._root=l,e;for(;s.length;)if((P=t>=(y=(u+p)/2))?u=y:p=y,(I=n>=(b=(h+m)/2))?h=b:m=b,i=s,!(s=s[N=I<<1|P]))return i[N]=l,e;if(w=+e._x.call(null,s.data),R=+e._y.call(null,s.data),t===w&&n===R)return l.next=s,i?i[N]=l:e._root=l,e;do i=i?i[N]=new Array(4):e._root=new Array(4),(P=t>=(y=(u+p)/2))?u=y:p=y,(I=n>=(b=(h+m)/2))?h=b:m=b;while((N=I<<1|P)===(z=(R>=b)<<1|w>=y));return i[z]=s,i[N]=l,e}function $$(e){var t,n,r=e.length,i,s,l=new Array(r),u=new Array(r),h=1/0,p=1/0,m=-1/0,y=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(l[n]=i,u[n]=s,i<h&&(h=i),i>m&&(m=i),s<p&&(p=s),s>y&&(y=s));if(h>m||p>y)return this;for(this.cover(h,p).cover(m,y),n=0;n<r;++n)u8(this,l[n],u[n],e[n]);return this}function K$(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var l=i-n||1,u=this._root,h,p;n>e||e>=i||r>t||t>=s;)switch(p=(t<r)<<1|e<n,h=new Array(4),h[p]=u,u=h,l*=2,p){case 0:i=n+l,s=r+l;break;case 1:n=i-l,s=r+l;break;case 2:i=n+l,r=s-l;break;case 3:n=i-l,r=s-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function q$(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Q$(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function kd(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function J$(e,t,n){var r,i=this._x0,s=this._y0,l,u,h,p,m=this._x1,y=this._y1,b=[],w=this._root,R,P;for(w&&b.push(new kd(w,i,s,m,y)),n==null?n=1/0:(i=e-n,s=t-n,m=e+n,y=t+n,n*=n);R=b.pop();)if(!(!(w=R.node)||(l=R.x0)>m||(u=R.y0)>y||(h=R.x1)<i||(p=R.y1)<s))if(w.length){var I=(l+h)/2,N=(u+p)/2;b.push(new kd(w[3],I,N,h,p),new kd(w[2],l,N,I,p),new kd(w[1],I,u,h,N),new kd(w[0],l,u,I,N)),(P=(t>=N)<<1|e>=I)&&(R=b[b.length-1],b[b.length-1]=b[b.length-1-P],b[b.length-1-P]=R)}else{var z=e-+this._x.call(null,w.data),Z=t-+this._y.call(null,w.data),Y=z*z+Z*Z;if(Y<n){var $=Math.sqrt(n=Y);i=e-$,s=t-$,m=e+$,y=t+$,r=w.data}}return r}function eK(e){if(isNaN(m=+this._x.call(null,e))||isNaN(y=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,l=this._x0,u=this._y0,h=this._x1,p=this._y1,m,y,b,w,R,P,I,N;if(!n)return this;if(n.length)for(;;){if((R=m>=(b=(l+h)/2))?l=b:h=b,(P=y>=(w=(u+p)/2))?u=w:p=w,t=n,!(n=n[I=P<<1|R]))return this;if(!n.length)break;(t[I+1&3]||t[I+2&3]||t[I+3&3])&&(r=t,N=I)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[I]=s:delete t[I],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[N]=n:this._root=n),this):(this._root=s,this)}function tK(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function nK(){return this._root}function rK(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function iK(e){var t=[],n,r=this._root,i,s,l,u,h;for(r&&t.push(new kd(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,l=n.y0,u=n.x1,h=n.y1)&&r.length){var p=(s+u)/2,m=(l+h)/2;(i=r[3])&&t.push(new kd(i,p,m,u,h)),(i=r[2])&&t.push(new kd(i,s,m,p,h)),(i=r[1])&&t.push(new kd(i,p,l,u,m)),(i=r[0])&&t.push(new kd(i,s,l,p,m))}return this}function oK(e){var t=[],n=[],r;for(this._root&&t.push(new kd(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,l=r.x0,u=r.y0,h=r.x1,p=r.y1,m=(l+h)/2,y=(u+p)/2;(s=i[0])&&t.push(new kd(s,l,u,m,y)),(s=i[1])&&t.push(new kd(s,m,u,h,y)),(s=i[2])&&t.push(new kd(s,l,y,m,p)),(s=i[3])&&t.push(new kd(s,m,y,h,p))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function aK(e){return e[0]}function sK(e){return arguments.length?(this._x=e,this):this._x}function lK(e){return e[1]}function cK(e){return arguments.length?(this._y=e,this):this._y}function f8(e,t,n){var r=new sM(t==null?aK:t,n==null?lK:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function sM(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function h8(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var zd=f8.prototype=sM.prototype;zd.copy=function(){var e=new sM(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=h8(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=h8(r));return e},zd.add=Y$,zd.addAll=$$,zd.cover=K$,zd.data=q$,zd.extent=Q$,zd.find=J$,zd.remove=eK,zd.removeAll=tK,zd.root=nK,zd.size=rK,zd.visit=iK,zd.visitAfter=oK,zd.x=sK,zd.y=cK;function e0(e){return function(){return e}}function db(e){return(e()-.5)*1e-6}var uK={value:function(){}};function d8(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new pw(n)}function pw(e){this._=e}function fK(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}pw.prototype=d8.prototype={constructor:pw,on:function(t,n){var r=this._,i=fK(t+"",r),s,l=-1,u=i.length;if(arguments.length<2){for(;++l<u;)if((s=(t=i[l]).type)&&(s=hK(r[s],t.name)))return s;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++l<u;)if(s=(t=i[l]).type)r[s]=p8(r[s],t.name,n);else if(n==null)for(s in r)r[s]=p8(r[s],t.name,null);return this},copy:function(){var t={},n=this._;for(var r in n)t[r]=n[r].slice();return new pw(t)},call:function(t,n){if((s=arguments.length-2)>0)for(var r=new Array(s),i=0,s,l;i<s;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=this._[t],i=0,s=l.length;i<s;++i)l[i].value.apply(n,r)},apply:function(t,n,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],s=0,l=i.length;s<l;++s)i[s].value.apply(n,r)}};function hK(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function p8(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=uK,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var dK=d8,pb=0,S2=0,T2=0,m8=1e3,mw,w2,vw=0,A1=0,gw=0,A2=typeof performance=="object"&&performance.now?performance:Date,v8=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function g8(){return A1||(v8(pK),A1=A2.now()+gw)}function pK(){A1=0}function lM(){this._call=this._time=this._next=null}lM.prototype=y8.prototype={constructor:lM,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?g8():+n)+(t==null?0:+t),!this._next&&w2!==this&&(w2?w2._next=this:mw=this,w2=this),this._call=e,this._time=n,cM()},stop:function(){this._call&&(this._call=null,this._time=1/0,cM())}};function y8(e,t,n){var r=new lM;return r.restart(e,t,n),r}function mK(){g8(),++pb;for(var e=mw,t;e;)(t=A1-e._time)>=0&&e._call.call(void 0,t),e=e._next;--pb}function _8(){A1=(vw=A2.now())+gw,pb=S2=0;try{mK()}finally{pb=0,gK(),A1=0}}function vK(){var e=A2.now(),t=e-vw;t>m8&&(gw-=t,vw=e)}function gK(){for(var e,t=mw,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:mw=n);w2=e,cM(r)}function cM(e){if(!pb){S2&&(S2=clearTimeout(S2));var t=e-A1;t>24?(e<1/0&&(S2=setTimeout(_8,e-A2.now()-gw)),T2&&(T2=clearInterval(T2))):(T2||(vw=A2.now(),T2=setInterval(vK,m8)),pb=1,v8(_8))}}const yK=1664525,_K=1013904223,b8=4294967296;function bK(){let e=1;return()=>(e=(yK*e+_K)%b8)/b8}function xK(e){return e.x}function EK(e){return e.y}var SK=10,TK=Math.PI*(3-Math.sqrt(5));function wK(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,l=.6,u=new Map,h=y8(y),p=dK("tick","end"),m=bK();e==null&&(e=[]);function y(){b(),p.call("tick",t),n<r&&(h.stop(),p.call("end",t))}function b(P){var I,N=e.length,z;P===void 0&&(P=1);for(var Z=0;Z<P;++Z)for(n+=(s-n)*i,u.forEach(function(Y){Y(n)}),I=0;I<N;++I)z=e[I],z.fx==null?z.x+=z.vx*=l:(z.x=z.fx,z.vx=0),z.fy==null?z.y+=z.vy*=l:(z.y=z.fy,z.vy=0);return t}function w(){for(var P=0,I=e.length,N;P<I;++P){if(N=e[P],N.index=P,N.fx!=null&&(N.x=N.fx),N.fy!=null&&(N.y=N.fy),isNaN(N.x)||isNaN(N.y)){var z=SK*Math.sqrt(.5+P),Z=P*TK;N.x=z*Math.cos(Z),N.y=z*Math.sin(Z)}(isNaN(N.vx)||isNaN(N.vy))&&(N.vx=N.vy=0)}}function R(P){return P.initialize&&P.initialize(e,m),P}return w(),t={tick:b,restart:function(){return h.restart(y),t},stop:function(){return h.stop(),t},nodes:function(P){return arguments.length?(e=P,w(),u.forEach(R),t):e},alpha:function(P){return arguments.length?(n=+P,t):n},alphaMin:function(P){return arguments.length?(r=+P,t):r},alphaDecay:function(P){return arguments.length?(i=+P,t):+i},alphaTarget:function(P){return arguments.length?(s=+P,t):s},velocityDecay:function(P){return arguments.length?(l=1-P,t):1-l},randomSource:function(P){return arguments.length?(m=P,u.forEach(R),t):m},force:function(P,I){return arguments.length>1?(I==null?u.delete(P):u.set(P,R(I)),t):u.get(P)},find:function(P,I,N){var z=0,Z=e.length,Y,$,J,ae,pe;for(N==null?N=1/0:N*=N,z=0;z<Z;++z)ae=e[z],Y=P-ae.x,$=I-ae.y,J=Y*Y+$*$,J<N&&(pe=ae,N=J);return pe},on:function(P,I){return arguments.length>1?(p.on(P,I),t):p.on(P)}}}function AK(){var e,t,n,r,i=e0(-30),s,l=1,u=1/0,h=.81;function p(w){var R,P=e.length,I=f8(e,xK,EK).visitAfter(y);for(r=w,R=0;R<P;++R)t=e[R],I.visit(b)}function m(){if(e){var w,R=e.length,P;for(s=new Array(R),w=0;w<R;++w)P=e[w],s[P.index]=+i(P,w,e)}}function y(w){var R=0,P,I,N=0,z,Z,Y;if(w.length){for(z=Z=Y=0;Y<4;++Y)(P=w[Y])&&(I=Math.abs(P.value))&&(R+=P.value,N+=I,z+=I*P.x,Z+=I*P.y);w.x=z/N,w.y=Z/N}else{P=w,P.x=P.data.x,P.y=P.data.y;do R+=s[P.data.index];while(P=P.next)}w.value=R}function b(w,R,P,I){if(!w.value)return!0;var N=w.x-t.x,z=w.y-t.y,Z=I-R,Y=N*N+z*z;if(Z*Z/h<Y)return Y<u&&(N===0&&(N=db(n),Y+=N*N),z===0&&(z=db(n),Y+=z*z),Y<l&&(Y=Math.sqrt(l*Y)),t.vx+=N*w.value*r/Y,t.vy+=z*w.value*r/Y),!0;if(w.length||Y>=u)return;(w.data!==t||w.next)&&(N===0&&(N=db(n),Y+=N*N),z===0&&(z=db(n),Y+=z*z),Y<l&&(Y=Math.sqrt(l*Y)));do w.data!==t&&(Z=s[w.data.index]*r/Y,t.vx+=N*Z,t.vy+=z*Z);while(w=w.next)}return p.initialize=function(w,R){e=w,n=R,m()},p.strength=function(w){return arguments.length?(i=typeof w=="function"?w:e0(+w),m(),p):i},p.distanceMin=function(w){return arguments.length?(l=w*w,p):Math.sqrt(l)},p.distanceMax=function(w){return arguments.length?(u=w*w,p):Math.sqrt(u)},p.theta=function(w){return arguments.length?(h=w*w,p):Math.sqrt(h)},p}function CK(e){return e.index}function x8(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function OK(e){var t=CK,n=y,r,i=e0(30),s,l,u,h,p,m=1;e==null&&(e=[]);function y(I){return 1/Math.min(u[I.source.index],u[I.target.index])}function b(I){for(var N=0,z=e.length;N<m;++N)for(var Z=0,Y,$,J,ae,pe,Oe,Ve;Z<z;++Z)Y=e[Z],$=Y.source,J=Y.target,ae=J.x+J.vx-$.x-$.vx||db(p),pe=J.y+J.vy-$.y-$.vy||db(p),Oe=Math.sqrt(ae*ae+pe*pe),Oe=(Oe-s[Z])/Oe*I*r[Z],ae*=Oe,pe*=Oe,J.vx-=ae*(Ve=h[Z]),J.vy-=pe*Ve,$.vx+=ae*(Ve=1-Ve),$.vy+=pe*Ve}function w(){if(l){var I,N=l.length,z=e.length,Z=new Map(l.map(($,J)=>[t($,J,l),$])),Y;for(I=0,u=new Array(N);I<z;++I)Y=e[I],Y.index=I,typeof Y.source!="object"&&(Y.source=x8(Z,Y.source)),typeof Y.target!="object"&&(Y.target=x8(Z,Y.target)),u[Y.source.index]=(u[Y.source.index]||0)+1,u[Y.target.index]=(u[Y.target.index]||0)+1;for(I=0,h=new Array(z);I<z;++I)Y=e[I],h[I]=u[Y.source.index]/(u[Y.source.index]+u[Y.target.index]);r=new Array(z),R(),s=new Array(z),P()}}function R(){if(l)for(var I=0,N=e.length;I<N;++I)r[I]=+n(e[I],I,e)}function P(){if(l)for(var I=0,N=e.length;I<N;++I)s[I]=+i(e[I],I,e)}return b.initialize=function(I,N){l=I,p=N,w()},b.links=function(I){return arguments.length?(e=I,w(),b):e},b.id=function(I){return arguments.length?(t=I,b):t},b.iterations=function(I){return arguments.length?(m=+I,b):m},b.strength=function(I){return arguments.length?(n=typeof I=="function"?I:e0(+I),R(),b):n},b.distance=function(I){return arguments.length?(i=typeof I=="function"?I:e0(+I),P(),b):i},b}function RK(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,l=n.length,u,h=0,p=0;for(s=0;s<l;++s)u=n[s],h+=u.x,p+=u.y;for(h=(h/l-e)*r,p=(p/l-t)*r,s=0;s<l;++s)u=n[s],u.x-=h,u.y-=p}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function MK(e){var t=e0(.1),n,r,i;typeof e!="function"&&(e=e0(e==null?0:+e));function s(u){for(var h=0,p=n.length,m;h<p;++h)m=n[h],m.vx+=(i[h]-m.x)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+e(n[u],u,n))?0:+t(n[u],u,n)}}return s.initialize=function(u){n=u,l()},s.strength=function(u){return arguments.length?(t=typeof u=="function"?u:e0(+u),l(),s):t},s.x=function(u){return arguments.length?(e=typeof u=="function"?u:e0(+u),l(),s):e},s}function PK(e){var t=e0(.1),n,r,i;typeof e!="function"&&(e=e0(e==null?0:+e));function s(u){for(var h=0,p=n.length,m;h<p;++h)m=n[h],m.vy+=(i[h]-m.y)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+e(n[u],u,n))?0:+t(n[u],u,n)}}return s.initialize=function(u){n=u,l()},s.strength=function(u){return arguments.length?(t=typeof u=="function"?u:e0(+u),l(),s):t},s.y=function(u){return arguments.length?(e=typeof u=="function"?u:e0(+u),l(),s):e},s}var IK=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const LK={joint:!0},DK={type:"link",axis:!1,legend:!1,encode:{x:[e=>e.source.x,e=>e.target.x],y:[e=>e.source.y,e=>e.target.y]},style:{stroke:"#999",strokeOpacity:.6}},NK={type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},style:{stroke:"#fff"}},BK={text:""};function FK(e,t,n){const{nodes:r,links:i}=e,{joint:s,nodeStrength:l,linkStrength:u}=t,{nodeKey:h=R=>R.id,linkKey:p=R=>R.id}=n,m=AK(),y=OK(i).id(cv(p));typeof l=="function"&&m.strength(l),typeof u=="function"&&y.strength(u);const b=wK(r).force("link",y).force("charge",m);s?b.force("center",RK()):b.force("x",MK()).force("y",PK()),b.stop();const w=Math.ceil(Math.log(b.alphaMin())/Math.log(1-b.alphaDecay()));for(let R=0;R<w;R++)b.tick();return{nodesData:r,linksData:i}}const E8=e=>{const{data:t,encode:n={},scale:r,style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=e,{nodeKey:m=J=>J.id,linkKey:y=J=>J.id}=n,b=IK(n,["nodeKey","linkKey"]),w=Object.assign({nodeKey:m,linkKey:y},b),R=uo(w,"node"),P=uo(w,"link"),{links:I,nodes:N}=o3(t,w),{nodesData:z,linksData:Z}=FK({links:I,nodes:N},ri({},LK,s),w),Y=av(p,"link",{items:[J=>({name:"source",value:cv(y)(J.source)}),J=>({name:"target",value:cv(y)(J.target)})]}),$=av(p,"node",{items:[J=>({name:"key",value:cv(m)(J)})]},!0);return[ri({},DK,{data:Z,encode:P,labels:u,style:uo(i,"link"),tooltip:Y,animate:sv(h,"link")}),ri({},NK,{data:z,encode:Object.assign({},R),scale:r,style:uo(i,"node"),tooltip:$,labels:[Object.assign(Object.assign({},BK),uo(i,"label")),...l],animate:sv(h,"link")})]};E8.props={};function kK(e,t){return e.parent===t.parent?1:2}function uM(e){var t=e.children;return t?t[0]:e.t}function fM(e){var t=e.children;return t?t[t.length-1]:e.t}function zK(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function UK(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function jK(e,t,n){return e.a.parent===t.parent?e.a:n}function yw(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}yw.prototype=Object.create(Q_.prototype);function VK(e){for(var t=new yw(e,0),n,r=[t],i,s,l,u;n=r.pop();)if(s=n._.children)for(n.children=new Array(u=s.length),l=u-1;l>=0;--l)r.push(i=n.children[l]=new yw(s[l],l)),i.parent=n;return(t.parent=new yw(null,0)).children=[t],t}function HK(){var e=kK,t=1,n=1,r=null;function i(p){var m=VK(p);if(m.eachAfter(s),m.parent.m=-m.z,m.eachBefore(l),r)p.eachBefore(h);else{var y=p,b=p,w=p;p.eachBefore(function(z){z.x<y.x&&(y=z),z.x>b.x&&(b=z),z.depth>w.depth&&(w=z)});var R=y===b?1:e(y,b)/2,P=R-y.x,I=t/(b.x+R+P),N=n/(w.depth||1);p.eachBefore(function(z){z.x=(z.x+P)*I,z.y=z.depth*N})}return p}function s(p){var m=p.children,y=p.parent.children,b=p.i?y[p.i-1]:null;if(m){UK(p);var w=(m[0].z+m[m.length-1].z)/2;b?(p.z=b.z+e(p._,b._),p.m=p.z-w):p.z=w}else b&&(p.z=b.z+e(p._,b._));p.parent.A=u(p,b,p.parent.A||y[0])}function l(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function u(p,m,y){if(m){for(var b=p,w=p,R=m,P=b.parent.children[0],I=b.m,N=w.m,z=R.m,Z=P.m,Y;R=fM(R),b=uM(b),R&&b;)P=uM(P),w=fM(w),w.a=p,Y=R.z+z-b.z-I+e(R._,b._),Y>0&&(zK(jK(R,p,y),p,Y),I+=Y,N+=Y),z+=R.m,I+=b.m,Z+=P.m,N+=w.m;R&&!fM(w)&&(w.t=R,w.m+=z-N),b&&!uM(P)&&(P.t=b,P.m+=I-Z,y=p)}return y}function h(p){p.x*=t,p.y=p.depth*n}return i.separation=function(p){return arguments.length?(e=p,i):e},i.size=function(p){return arguments.length?(r=!1,t=+p[0],n=+p[1],i):r?null:[t,n]},i.nodeSize=function(p){return arguments.length?(r=!0,t=+p[0],n=+p[1],i):r?[t,n]:null},i}function ZK(e,t){return e.parent===t.parent?1:2}function WK(e){return e.reduce(GK,0)/e.length}function GK(e,t){return e+t.x}function XK(e){return 1+e.reduce(YK,0)}function YK(e,t){return Math.max(e,t.y)}function $K(e){for(var t;t=e.children;)e=t[0];return e}function KK(e){for(var t;t=e.children;)e=t[t.length-1];return e}function qK(){var e=ZK,t=1,n=1,r=!1;function i(s){var l,u=0;s.eachAfter(function(b){var w=b.children;w?(b.x=WK(w),b.y=XK(w)):(b.x=l?u+=e(b,l):0,b.y=0,l=b)});var h=$K(s),p=KK(s),m=h.x-e(h,p)/2,y=p.x+e(p,h)/2;return s.eachAfter(r?function(b){b.x=(b.x-s.x)*t,b.y=(s.y-b.y)*n}:function(b){b.x=(b.x-m)/(y-m)*t,b.y=(1-(s.y?b.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}const S8=e=>t=>n=>{const{field:r="value",nodeSize:i,separation:s,sortBy:l,as:u=["x","y"]}=t,[h,p]=u,m=q_(n,R=>R.children).sum(R=>R[r]).sort(l),y=e();y.size([1,1]),i&&y.nodeSize(i),s&&y.separation(s),y(m);const b=[];m.each(R=>{R[h]=R.x,R[p]=R.y,R.name=R.data.name,b.push(R)});const w=m.links();return w.forEach(R=>{R[h]=[R.source[h],R.target[h]],R[p]=[R.source[p],R.target[p]]}),{nodes:b,edges:w}},T8=e=>S8(qK)(e);T8.props={};const w8=e=>S8(HK)(e);w8.props={};const QK={sortBy:(e,t)=>t.value-e.value},JK={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},eq={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},tq={text:"",fontSize:10},A8=e=>{const{data:t,encode:n={},scale:r={},style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=e,m=n==null?void 0:n.value,{nodes:y,edges:b}=w8(Object.assign(Object.assign(Object.assign({},QK),s),{field:m}))(t),w=av(p,"node",{title:"name",items:["value"]},!0),R=av(p,"link",{title:"",items:[P=>({name:"source",value:P.source.name}),P=>({name:"target",value:P.target.name})]});return[ri({},eq,{data:b,encode:uo(n,"link"),scale:uo(r,"link"),labels:u,style:Object.assign({stroke:"#999"},uo(i,"link")),tooltip:R,animate:sv(h,"link")}),ri({},JK,{data:y,scale:uo(r,"node"),encode:uo(n,"node"),labels:[Object.assign(Object.assign({},tq),uo(i,"label")),...l],style:Object.assign({},uo(i,"node")),tooltip:w,animate:sv(h,"node")})]};A8.props={};var nq=1664525,rq=1013904223,C8=4294967296;function iq(){var e=1;return function(){return(e=(nq*e+rq)%C8)/C8}}var oq=D(52677);function aq(e){return oq(e)==="object"&&"length"in e?e:Array.from(e)}function sq(e,t){for(var n=e.length,r,i;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function Jte(e){return O8(e,lcg())}function O8(e,t){for(var n=0,r=(e=sq(Array.from(e),t)).length,i=[],s,l;n<r;)s=e[n],l&&R8(l,s)?++n:(l=cq(i=lq(i,s)),n=0);return l}function lq(e,t){var n,r;if(hM(t,e))return[t];for(n=0;n<e.length;++n)if(_w(t,e[n])&&hM(C2(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(_w(C2(e[n],e[r]),t)&&_w(C2(e[n],t),e[r])&&_w(C2(e[r],t),e[n])&&hM(M8(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function _w(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function R8(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function hM(e,t){for(var n=0;n<t.length;++n)if(!R8(e,t[n]))return!1;return!0}function cq(e){switch(e.length){case 1:return uq(e[0]);case 2:return C2(e[0],e[1]);case 3:return M8(e[0],e[1],e[2])}}function uq(e){return{x:e.x,y:e.y,r:e.r}}function C2(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,l=t.y,u=t.r,h=s-n,p=l-r,m=u-i,y=Math.sqrt(h*h+p*p);return{x:(n+s+h/y*m)/2,y:(r+l+p/y*m)/2,r:(y+i+u)/2}}function M8(e,t,n){var r=e.x,i=e.y,s=e.r,l=t.x,u=t.y,h=t.r,p=n.x,m=n.y,y=n.r,b=r-l,w=r-p,R=i-u,P=i-m,I=h-s,N=y-s,z=r*r+i*i-s*s,Z=z-l*l-u*u+h*h,Y=z-p*p-m*m+y*y,$=w*R-b*P,J=(R*Y-P*Z)/($*2)-r,ae=(P*I-R*N)/$,pe=(w*Z-b*Y)/($*2)-i,Oe=(b*N-w*I)/$,Ve=ae*ae+Oe*Oe-1,Ke=2*(s+J*ae+pe*Oe),lt=J*J+pe*pe-s*s,Ge=-(Math.abs(Ve)>1e-6?(Ke+Math.sqrt(Ke*Ke-4*Ve*lt))/(2*Ve):lt/Ke);return{x:r+J+ae*Ge,y:i+pe+Oe*Ge,r:Ge}}function P8(e,t,n){var r=e.x-t.x,i,s,l=e.y-t.y,u,h,p=r*r+l*l;p?(s=t.r+n.r,s*=s,h=e.r+n.r,h*=h,s>h?(i=(p+h-s)/(2*p),u=Math.sqrt(Math.max(0,h/p-i*i)),n.x=e.x-i*r-u*l,n.y=e.y-i*l+u*r):(i=(p+s-h)/(2*p),u=Math.sqrt(Math.max(0,s/p-i*i)),n.x=t.x+i*r-u*l,n.y=t.y+i*l+u*r)):(n.x=t.x+n.r,n.y=t.y)}function I8(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function L8(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function bw(e){this._=e,this.next=null,this.previous=null}function D8(e,t){if(!(s=(e=aq(e)).length))return 0;var n,r,i,s,l,u,h,p,m,y,b;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(s>2))return n.r+r.r;P8(r,n,i=e[2]),n=new bw(n),r=new bw(r),i=new bw(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(h=3;h<s;++h){P8(n._,r._,i=e[h]),i=new bw(i),p=r.next,m=n.previous,y=r._.r,b=n._.r;do if(y<=b){if(I8(p._,i._)){r=p,n.next=r,r.previous=n,--h;continue e}y+=p._.r,p=p.next}else{if(I8(m._,i._)){n=m,n.next=r,r.previous=n,--h;continue e}b+=m._.r,m=m.previous}while(p!==m.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,l=L8(n);(i=i.next)!==r;)(u=L8(i))<l&&(n=i,l=u);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=O8(n,t),h=0;h<s;++h)n=e[h],n.x-=i.x,n.y-=i.y;return i.r}function ene(e){return D8(e,lcg()),e}function fq(e){return Math.sqrt(e.value)}function hq(){var e=null,t=1,n=1,r=T1;function i(s){var l=iq();return s.x=t/2,s.y=n/2,e?s.eachBefore(N8(e)).eachAfter(dM(r,.5,l)).eachBefore(B8(1)):s.eachBefore(N8(fq)).eachAfter(dM(T1,1,l)).eachAfter(dM(r,s.r/Math.min(t,n),l)).eachBefore(B8(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=FT(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:ab(+s),i):r},i}function N8(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function dM(e,t,n){return function(r){if(i=r.children){var i,s,l=i.length,u=e(r)*t||0,h;if(u)for(s=0;s<l;++s)i[s].r+=u;if(h=D8(i,n),u)for(s=0;s<l;++s)i[s].r-=u;r.r=h+u}}}function B8(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var dq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const pq=(e,t)=>({size:[e,t],padding:0,sort:(n,r)=>r.value-n.value}),mq=(e,t,n)=>({type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,e]},y:{domain:[0,t]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:n.color?void 0:r=>r.height===0?"#ddd":"#fff",stroke:n.color?void 0:r=>r.height===0?"":"#000"}}),vq={text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:e=>e.r*2},gq={title:e=>e.data.name,items:[{field:"value"}]},yq=(e,t,n)=>{const{value:r}=n,i=_s(e)?aR().path(t.path)(e):q_(e);return r?i.sum(s=>cv(r)(s)).sort(t.sort):i.count(),hq().size(t.size).padding(t.padding)(i),i.descendants()},F8=(e,t)=>{const{width:n,height:r}=t,{data:i,encode:s={},scale:l={},style:u={},layout:h={},labels:p=[],tooltip:m={}}=e,y=dq(e,["data","encode","scale","style","layout","labels","tooltip"]),b=mq(n,r,s),w=yq(i,ri({},pq(n,r),h),ri({},b.encode,s)),R=uo(u,"label");return ri({},b,Object.assign(Object.assign({data:w,encode:s,scale:l,style:u,labels:[Object.assign(Object.assign({},vq),R),...p]},y),{tooltip:sT(m,gq),axis:!1}))};F8.props={};function _q(e){return e.target.depth}function bq(e){return e.depth}function xq(e,t){return t-1-e.height}function xw(e,t){return e.sourceLinks.length?e.depth:t-1}function Eq(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?qp(e.sourceLinks,_q)-1:0}function Ew(e){return function(){return e}}function k8(e,t){return Sw(e.source,t.source)||e.index-t.index}function z8(e,t){return Sw(e.target,t.target)||e.index-t.index}function Sw(e,t){return e.y0-t.y0}function pM(e){return e.value}function Sq(e){return e.index}function Tq(e){return e.nodes}function wq(e){return e.links}function U8(e,t){const n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function j8({nodes:e}){for(const t of e){let n=t.y0,r=n;for(const i of t.sourceLinks)i.y0=n+i.width/2,n+=i.width;for(const i of t.targetLinks)i.y1=r+i.width/2,r+=i.width}}function Aq(){let e=0,t=0,n=1,r=1,i=24,s=8,l,u=Sq,h=xw,p,m,y,b=Tq,w=wq,R=6;function P(ut){const jt={nodes:b(ut),links:w(ut)};return I(jt),N(jt),z(jt),Z(jt),J(jt),j8(jt),jt}P.update=function(ut){return j8(ut),ut},P.nodeId=function(ut){return arguments.length?(u=typeof ut=="function"?ut:Ew(ut),P):u},P.nodeAlign=function(ut){return arguments.length?(h=typeof ut=="function"?ut:Ew(ut),P):h},P.nodeDepth=function(ut){return arguments.length?(p=ut,P):p},P.nodeSort=function(ut){return arguments.length?(m=ut,P):m},P.nodeWidth=function(ut){return arguments.length?(i=+ut,P):i},P.nodePadding=function(ut){return arguments.length?(s=l=+ut,P):s},P.nodes=function(ut){return arguments.length?(b=typeof ut=="function"?ut:Ew(ut),P):b},P.links=function(ut){return arguments.length?(w=typeof ut=="function"?ut:Ew(ut),P):w},P.linkSort=function(ut){return arguments.length?(y=ut,P):y},P.size=function(ut){return arguments.length?(e=t=0,n=+ut[0],r=+ut[1],P):[n-e,r-t]},P.extent=function(ut){return arguments.length?(e=+ut[0][0],n=+ut[1][0],t=+ut[0][1],r=+ut[1][1],P):[[e,t],[n,r]]},P.iterations=function(ut){return arguments.length?(R=+ut,P):R};function I({nodes:ut,links:jt}){ut.forEach((zt,wn)=>{zt.index=wn,zt.sourceLinks=[],zt.targetLinks=[]});const At=new Map(ut.map(zt=>[u(zt),zt]));if(jt.forEach((zt,wn)=>{zt.index=wn;let{source:Hn,target:rr}=zt;typeof Hn!="object"&&(Hn=zt.source=U8(At,Hn)),typeof rr!="object"&&(rr=zt.target=U8(At,rr)),Hn.sourceLinks.push(zt),rr.targetLinks.push(zt)}),y!=null)for(const{sourceLinks:zt,targetLinks:wn}of ut)zt.sort(y),wn.sort(y)}function N({nodes:ut}){for(const jt of ut)jt.value=jt.fixedValue===void 0?Math.max(up(jt.sourceLinks,pM),up(jt.targetLinks,pM)):jt.fixedValue}function z({nodes:ut}){const jt=ut.length;let At=new Set(ut),zt=new Set,wn=0;for(;At.size;){if(At.forEach(Hn=>{Hn.depth=wn;for(const{target:rr}of Hn.sourceLinks)zt.add(rr)}),++wn>jt)throw new Error("circular link");At=zt,zt=new Set}if(p){const Hn=Math.max(Ol(ut,or=>or.depth)+1,0);let rr;for(let or=0;or<ut.length;or++)rr=ut[or],rr.depth=p.call(null,rr,Hn)}}function Z({nodes:ut}){const jt=ut.length;let At=new Set(ut),zt=new Set,wn=0;for(;At.size;){if(At.forEach(Hn=>{Hn.height=wn;for(const{source:rr}of Hn.targetLinks)zt.add(rr)}),++wn>jt)throw new Error("circular link");At=zt,zt=new Set}}function Y({nodes:ut}){const jt=Math.max(Ol(ut,wn=>wn.depth)+1,0),At=(n-e-i)/(jt-1),zt=new Array(jt).fill(0).map(()=>[]);for(const wn of ut){const Hn=Math.max(0,Math.min(jt-1,Math.floor(h.call(null,wn,jt))));wn.layer=Hn,wn.x0=e+Hn*At,wn.x1=wn.x0+i,zt[Hn]?zt[Hn].push(wn):zt[Hn]=[wn]}if(m)for(const wn of zt)wn.sort(m);return zt}function $(ut){const jt=qp(ut,At=>(r-t-(At.length-1)*l)/up(At,pM));for(const At of ut){let zt=t;for(const wn of At){wn.y0=zt,wn.y1=zt+wn.value*jt,zt=wn.y1+l;for(const Hn of wn.sourceLinks)Hn.width=Hn.value*jt}zt=(r-zt+l)/(At.length+1);for(let wn=0;wn<At.length;++wn){const Hn=At[wn];Hn.y0+=zt*(wn+1),Hn.y1+=zt*(wn+1)}Ge(At)}}function J(ut){const jt=Y(ut);l=Math.min(s,(r-t)/(Ol(jt,At=>At.length)-1)),$(jt);for(let At=0;At<R;++At){const zt=Math.pow(.99,At),wn=Math.max(1-zt,(At+1)/R);pe(jt,zt,wn),ae(jt,zt,wn)}}function ae(ut,jt,At){for(let zt=1,wn=ut.length;zt<wn;++zt){const Hn=ut[zt];for(const rr of Hn){let or=0,Hr=0;for(const{source:Qi,value:ii}of rr.targetLinks){const ti=ii*(rr.layer-Qi.layer);or+=rt(Qi,rr)*ti,Hr+=ti}if(!(Hr>0))continue;const ui=(or/Hr-rr.y0)*jt;rr.y0+=ui,rr.y1+=ui,lt(rr)}m===void 0&&Hn.sort(Sw),Hn.length&&Oe(Hn,At)}}function pe(ut,jt,At){for(let zt=ut.length,wn=zt-2;wn>=0;--wn){const Hn=ut[wn];for(const rr of Hn){let or=0,Hr=0;for(const{target:Qi,value:ii}of rr.sourceLinks){const ti=ii*(Qi.layer-rr.layer);or+=st(rr,Qi)*ti,Hr+=ti}if(!(Hr>0))continue;const ui=(or/Hr-rr.y0)*jt;rr.y0+=ui,rr.y1+=ui,lt(rr)}m===void 0&&Hn.sort(Sw),Hn.length&&Oe(Hn,At)}}function Oe(ut,jt){const At=ut.length>>1,zt=ut[At];Ke(ut,zt.y0-l,At-1,jt),Ve(ut,zt.y1+l,At+1,jt),Ke(ut,r,ut.length-1,jt),Ve(ut,t,0,jt)}function Ve(ut,jt,At,zt){for(;At<ut.length;++At){const wn=ut[At],Hn=(jt-wn.y0)*zt;Hn>1e-6&&(wn.y0+=Hn,wn.y1+=Hn),jt=wn.y1+l}}function Ke(ut,jt,At,zt){for(;At>=0;--At){const wn=ut[At],Hn=(wn.y1-jt)*zt;Hn>1e-6&&(wn.y0-=Hn,wn.y1-=Hn),jt=wn.y0-l}}function lt({sourceLinks:ut,targetLinks:jt}){if(y===void 0){for(const{source:{sourceLinks:At}}of jt)At.sort(z8);for(const{target:{targetLinks:At}}of ut)At.sort(k8)}}function Ge(ut){if(y===void 0)for(const{sourceLinks:jt,targetLinks:At}of ut)jt.sort(z8),At.sort(k8)}function rt(ut,jt){let At=ut.y0-(ut.sourceLinks.length-1)*l/2;for(const{target:zt,width:wn}of ut.sourceLinks){if(zt===jt)break;At+=wn+l}for(const{source:zt,width:wn}of jt.targetLinks){if(zt===ut)break;At-=wn}return At}function st(ut,jt){let At=jt.y0-(jt.targetLinks.length-1)*l/2;for(const{source:zt,width:wn}of jt.targetLinks){if(zt===ut)break;At+=wn+l}for(const{target:zt,width:wn}of ut.sourceLinks){if(zt===jt)break;At-=wn}return At}return P}const Cq={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:e=>e.nodes,links:e=>e.links,nodeSort:void 0,linkSort:void 0,iterations:6},Oq={left:bq,right:xq,center:Eq,justify:xw};function Rq(e){const t=typeof e;return t==="string"?Oq[e]||xw:t==="function"?e:xw}const V8=e=>t=>{const{nodeId:n,nodeSort:r,nodeAlign:i,nodeWidth:s,nodePadding:l,nodeDepth:u,nodes:h,links:p,linkSort:m,iterations:y}=Object.assign({},Cq,e),b=Aq().nodeSort(r).linkSort(m).links(p).nodes(h).nodeWidth(s).nodePadding(l).nodeDepth(u).nodeAlign(Rq(i)).iterations(y).extent([[0,0],[1,1]]);typeof n=="function"&&b.nodeId(n);const w=b(t),{nodes:R,links:P}=w,I=R.map(z=>{const{x0:Z,x1:Y,y0:$,y1:J}=z;return Object.assign(Object.assign({},z),{x:[Z,Y,Y,Z],y:[$,$,J,J]})}),N=P.map(z=>{const{source:Z,target:Y}=z,$=Z.x1,J=Y.x0,ae=z.width/2;return Object.assign(Object.assign({},z),{x:[$,$,J,J],y:[z.y0+ae,z.y0-ae,z.y1+ae,z.y1-ae]})});return{nodes:I,links:N}};V8.props={};var Mq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Pq={nodeId:e=>e.key,nodeWidth:.02,nodePadding:.02},Iq={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},Lq={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:void 0}},Dq={textAlign:e=>e.x[0]<.5?"start":"end",position:e=>e.x[0]<.5?"right":"left",fontSize:10},H8=e=>{const{data:t,encode:n={},scale:r,style:i={},layout:s={},nodeLabels:l=[],linkLabels:u=[],animate:h={},tooltip:p={}}=e,{links:m,nodes:y}=o3(t,n),b=uo(n,"node"),w=uo(n,"link"),{key:R=Oe=>Oe.key,color:P=R}=b,{links:I,nodes:N}=V8(Object.assign(Object.assign(Object.assign({},Pq),{nodeId:cv(R)}),s))({links:m,nodes:y}),z=uo(i,"label"),{text:Z=R,spacing:Y=5}=z,$=Mq(z,["text","spacing"]),J=cv(R),ae=av(p,"node",{title:J,items:[{field:"value"}]},!0),pe=av(p,"link",{title:"",items:[Oe=>({name:"source",value:J(Oe.source)}),Oe=>({name:"target",value:J(Oe.target)})]});return[ri({},Iq,{data:N,encode:Object.assign(Object.assign({},b),{color:P}),scale:r,style:uo(i,"node"),labels:[Object.assign(Object.assign(Object.assign({},Dq),{text:Z,dx:Oe=>Oe.x[0]<.5?Y:-Y}),$),...l],tooltip:ae,animate:sv(h,"node"),axis:!1}),ri({},Lq,{data:I,encode:w,labels:u,style:Object.assign({fill:w.color?void 0:"#aaa",lineWidth:0},uo(i,"link")),tooltip:pe,animate:sv(h,"link")})]};H8.props={};function Nq(e,t){return t.value-e.value}function Bq(e,t){return t.frequency-e.frequency}function Fq(e,t){return`${e.id}`.localeCompare(`${t.id}`)}function kq(e,t){return`${e.name}`.localeCompare(`${t.name}`)}const zq={y:0,thickness:.05,weight:!1,marginRatio:.1,id:e=>e.id,source:e=>e.source,target:e=>e.target,sourceWeight:e=>e.value||1,targetWeight:e=>e.value||1,sortBy:null};function Uq(e){const{y:t,thickness:n,weight:r,marginRatio:i,id:s,source:l,target:u,sourceWeight:h,targetWeight:p,sortBy:m}=Object.assign(Object.assign({},zq),e);function y(I){const N=I.nodes.map(Z=>Object.assign({},Z)),z=I.edges.map(Z=>Object.assign({},Z));return b(N,z),w(N,z),R(N,z),P(N,z),{nodes:N,edges:z}}function b(I,N){N.forEach(Y=>{Y.source=l(Y),Y.target=u(Y),Y.sourceWeight=h(Y),Y.targetWeight=p(Y)});const z=Rc(N,Y=>Y.source),Z=Rc(N,Y=>Y.target);return I.forEach(Y=>{Y.id=s(Y);const $=z.has(Y.id)?z.get(Y.id):[],J=Z.has(Y.id)?Z.get(Y.id):[];Y.frequency=$.length+J.length,Y.value=up($,ae=>ae.sourceWeight)+up(J,ae=>ae.targetWeight)}),{nodes:I,edges:N}}function w(I,N){const z=typeof m=="function"?m:_e[m];z&&I.sort(z)}function R(I,N){const z=I.length;if(!z)throw Nv("Invalid nodes: it's empty!");if(!r){const $=1/z;return I.forEach((J,ae)=>{J.x=(ae+.5)*$,J.y=t}),{nodes:I,edges:N}}const Z=i/(2*z),Y=I.reduce(($,J)=>$+=J.value,0);return I.reduce(($,J)=>{J.weight=J.value/Y,J.width=J.weight*(1-i),J.height=n;const ae=Z+$,pe=ae+J.width,Oe=t-n/2,Ve=Oe+n;return J.x=[ae,pe,pe,ae],J.y=[Oe,Oe,Ve,Ve],$+J.width+2*Z},0),{nodes:I,edges:N}}function P(I,N){const z=new Map(I.map($=>[$.id,$]));if(!r)return N.forEach($=>{const J=l($),ae=u($),pe=z.get(J),Oe=z.get(ae);pe&&Oe&&($.x=[pe.x,Oe.x],$.y=[pe.y,Oe.y])}),{nodes:I,edges:N};N.forEach($=>{$.x=[0,0,0,0],$.y=[t,t,t,t]});const Z=Rc(N,$=>$.source),Y=Rc(N,$=>$.target);I.forEach($=>{const{edges:J,width:ae,x:pe,y:Oe,value:Ve,id:Ke}=$,lt=Z.get(Ke)||[],Ge=Y.get(Ke)||[];let rt=0;lt.map(st=>{const ut=st.sourceWeight/Ve*ae;st.x[0]=pe[0]+rt,st.x[1]=pe[0]+rt+ut,rt+=ut}),Ge.forEach(st=>{const ut=st.targetWeight/Ve*ae;st.x[3]=pe[0]+rt,st.x[2]=pe[0]+rt+ut,rt+=ut})})}return y}const mM=e=>t=>Uq(e)(t);mM.props={};var Z8=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const vM={y:0,thickness:.05,marginRatio:.1,id:e=>e.key,source:e=>e.source,target:e=>e.target,sourceWeight:e=>e.value||1,targetWeight:e=>e.value||1,sortBy:null},jq={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{opacity:1,fillOpacity:1,lineWidth:1}},Vq={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{opacity:.5,lineWidth:1}},Hq={position:"outside",fontSize:10},W8=(e,t)=>{const{data:n,encode:r={},scale:i,style:s={},layout:l={},nodeLabels:u=[],linkLabels:h=[],animate:p={},tooltip:m={}}=e,{nodes:y,links:b}=o3(n,r),w=uo(r,"node"),R=uo(r,"link"),{key:P=st=>st.key,color:I=P}=w,{linkEncodeColor:N=st=>st.source}=R,{nodeWidthRatio:z=vM.thickness,nodePaddingRatio:Z=vM.marginRatio}=l,Y=Z8(l,["nodeWidthRatio","nodePaddingRatio"]),{nodes:$,edges:J}=mM(Object.assign(Object.assign(Object.assign(Object.assign({},vM),{id:cv(P),thickness:z,marginRatio:Z}),Y),{weight:!0}))({nodes:y,edges:b}),ae=uo(s,"label"),{text:pe=P}=ae,Oe=Z8(ae,["text"]),Ve=av(m,"node",{title:"",items:[st=>({name:st.key,value:st.value})]},!0),Ke=av(m,"link",{title:"",items:[st=>({name:`${st.source} -> ${st.target}`,value:st.value})]}),{height:lt,width:Ge}=t,rt=Math.min(lt,Ge);return[ri({},Vq,{data:J,encode:Object.assign(Object.assign({},R),{color:N}),labels:h,style:Object.assign({fill:N?void 0:"#aaa"},uo(s,"link")),tooltip:Ke,animate:sv(p,"link")}),ri({},jq,{data:$,encode:Object.assign(Object.assign({},w),{color:I}),scale:i,style:uo(s,"node"),coordinate:{type:"polar",outerRadius:(rt-20)/rt,startAngle:-Math.PI*2,endAngle:0},labels:[Object.assign(Object.assign(Object.assign({},Hq),{text:pe}),Oe),...u],tooltip:Ve,animate:sv(p,"node"),axis:!1})]};W8.props={};var Zq=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Wq=(e,t)=>({tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[e,t],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(n,r)=>r.value-n.value,layer:0}),Gq=(e,t)=>({type:"rect",axis:!1,encode:{x:"x",y:"y",key:"id",color:n=>n.path[1]},scale:{x:{domain:[0,e],range:[0,1]},y:{domain:[0,t],range:[0,1]}},style:{stroke:"#fff"},state:{active:{opacity:.6},inactive:{opacity:1}}}),Xq={fontSize:10,text:e=>Yx(e.path),position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:e=>e.x1-e.x0},Yq={title:e=>{var t,n;return(n=(t=e.path)===null||t===void 0?void 0:t.join)===null||n===void 0?void 0:n.call(t,".")},items:[{field:"value"}]},$q={title:e=>Yx(e.path),items:[{field:"value"}]},G8=(e,t)=>{const{width:n,height:r,options:i}=t,{data:s,encode:l={},scale:u,style:h={},layout:p={},labels:m=[],tooltip:y={}}=e,b=Zq(e,["data","encode","scale","style","layout","labels","tooltip"]),w=ol(i,["interaction","treemapDrillDown"]),R=ri({},Wq(n,r),p,{layer:w?z=>z.depth===1:p.layer}),[P,I]=XN(s,R,l),N=uo(h,"label");return ri({},Gq(n,r),Object.assign(Object.assign({data:P,scale:u,style:h,labels:[Object.assign(Object.assign({},Xq),N),...m]},b),{encode:l,tooltip:sT(y,Yq),axis:!1}),w?{interaction:Object.assign(Object.assign({},b.interaction),{treemapDrillDown:w?Object.assign(Object.assign({},w),{originData:I,layout:R}):void 0}),encode:Object.assign({color:z=>Yx(z.path)},l),tooltip:sT(y,$q)}:{})};G8.props={};function Kq(){return{"data.arc":mM,"data.cluster":T8,"mark.forceGraph":E8,"mark.tree":A8,"mark.pack":F8,"mark.sankey":H8,"mark.chord":W8,"mark.treemap":G8}}var X8=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function qq(e,t){return qp(e,n=>t[n])}function Qq(e,t){return Ol(e,n=>t[n])}function Y8(e,t){const n=gM(e,t)*2.5-yM(e,t)*1.5;return qp(e,r=>t[r]>=n?t[r]:NaN)}function gM(e,t){return jT(e,.25,n=>t[n])}function Jq(e,t){return jT(e,.5,n=>t[n])}function yM(e,t){return jT(e,.75,n=>t[n])}function $8(e,t){const n=yM(e,t)*2.5-gM(e,t)*1.5;return Ol(e,r=>t[r]<=n?t[r]:NaN)}function eQ(){return(e,t)=>{const{encode:n}=t,{y:r,x:i}=n,{value:s}=r,{value:l}=i;return[Array.from(Rc(e,p=>l[+p]).values()).flatMap(p=>{const m=Y8(p,s),y=$8(p,s);return p.filter(b=>s[b]<m||s[b]>y)}),t]}}const K8=e=>{const{data:t,encode:n,style:r={},tooltip:i={},transform:s,animate:l}=e,u=X8(e,["data","encode","style","tooltip","transform","animate"]),{point:h=!0}=r,p=X8(r,["point"]),{y:m}=n,y={y:m,y1:m,y2:m,y3:m,y4:m},b={y1:gM,y2:Jq,y3:yM},w=av(i,"box",{items:[{channel:"y",name:"min"},{channel:"y1",name:"q1"},{channel:"y2",name:"q2"},{channel:"y3",name:"q3"},{channel:"y4",name:"max"}]},!0),R=av(i,"point",{title:{channel:"x"},items:[{name:"outlier",channel:"y"}]});if(!h)return Object.assign({type:"box",data:t,transform:[Object.assign(Object.assign({type:"groupX",y:qq},b),{y4:Qq})],encode:Object.assign(Object.assign({},n),y),style:p,tooltip:w},u);const P=uo(p,"box"),I=uo(p,"point");return[Object.assign({type:"box",data:t,transform:[Object.assign(Object.assign({type:"groupX",y:Y8},b),{y4:$8})],encode:Object.assign(Object.assign({},n),y),style:P,tooltip:w,animate:sv(l,"box")},u),{type:"point",data:t,transform:[{type:eQ}],encode:n,style:Object.assign({},I),tooltip:R,animate:sv(l,"point")}]};K8.props={};const q8=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))/2,tQ=(e,t)=>{if(!t)return;const{coordinate:n}=t;if(!(n!=null&&n.getCenter))return;const r=n.getCenter();return(i,s,l)=>{const{document:u}=t.canvas,{color:h,index:p}=s,m=u.createElement("g",{}),y=q8(i[0],i[1]),b=q8(i[0],r)*2,w=u.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:[["M",...i[0]],["A",y,y,0,1,0,...i[1]],["A",b+y*2,b+y*2,0,0,0,...i[2]],["A",y,y,0,1,p===0?0:1,...i[3]],["A",b,b,0,0,1,...i[0]],["Z"]]},l),ix(e,["shape","last","first"])),{fill:h||l.color})});return m.appendChild(w),m}};var Tw=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const nQ=(e,t)=>{const{shape:n,radius:r}=e,i=Tw(e,["shape","radius"]),s=uo(i,"pointer"),l=uo(i,"pin"),{shape:u}=s,h=Tw(s,["shape"]),{shape:p}=l,m=Tw(l,["shape"]),{coordinate:y,theme:b}=t;return(w,R)=>{const P=w.map(rt=>y.invert(rt)),[I,N,z]=Bb(y,"polar"),Z=y.clone(),{color:Y}=R,$=Lb({startAngle:I,endAngle:N,innerRadius:z,outerRadius:r});$.push(["cartesian"]),Z.update({transformations:$});const J=P.map(rt=>Z.map(rt)),[ae,pe]=Ex(J),[Oe,Ve]=y.getCenter(),Ke=Object.assign(Object.assign({x1:ae,y1:pe,x2:Oe,y2:Ve,stroke:Y},h),i),lt=Object.assign(Object.assign({cx:Oe,cy:Ve,stroke:Y},m),i),Ge=Ra(new ki);return J0(u)||(typeof u=="function"?Ge.append(()=>u(J,R,Z,b)):Ge.append("line").call(ea,Ke).node()),J0(p)||(typeof p=="function"?Ge.append(()=>p(J,R,Z,b)):Ge.append("circle").call(ea,lt).node()),Ge.node()}},Q8={coordinate:{type:"radial",innerRadius:.9,outerRadius:1,startAngle:-11/10*Math.PI,endAngle:1/10*Math.PI},axis:{x:!1},legend:!1,tooltip:!1,encode:{x:"x",y:"y",color:"color"},scale:{color:{range:["#30BF78","#D0D0D0"]}}},rQ={style:{shape:nQ,lineWidth:4,pointerLineCap:"round",pinR:10,pinFill:"#fff",radius:.6}},iQ={type:"text",style:{x:"50%",y:"60%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"}};function oQ(e){if((0,dr.Z)(e)){const t=Math.max(0,Math.min(e,1));return{percent:t,target:t,total:1}}return e}function aQ(e,t){const{name:n="score",target:r,total:i,percent:s,thresholds:l=[]}=oQ(e),u=s||r,h=s?1:i,p=Object.assign({y:{domain:[0,h]}},t);return l.length?{targetData:[{x:n,y:u,color:"target"}],totalData:l.map((m,y)=>({x:n,y:y>=1?m-l[y-1]:m,color:y})),target:u,total:h,scale:p}:{targetData:[{x:n,y:u,color:"target"}],totalData:[{x:n,y:u,color:"target"},{x:n,y:h-u,color:"total"}],target:u,total:h,scale:p}}function sQ(e,{target:t,total:n}){const{content:r}=e;return r?r(t,n):t.toString()}const J8=e=>{const{data:t={},scale:n={},style:r={},animate:i={},transform:s=[]}=e,l=Tw(e,["data","scale","style","animate","transform"]),{targetData:u,totalData:h,target:p,total:m,scale:y}=aQ(t,n),b=uo(r,"text"),w=cE(r,["pointer","pin"]),R=uo(r,"arc"),P=R.shape;return[ri({},Q8,Object.assign({type:"interval",transform:[{type:"stackY"}],data:h,scale:y,style:P==="round"?Object.assign(Object.assign({},R),{shape:tQ}):R,animate:typeof i=="object"?uo(i,"arc"):i},l)),ri({},Q8,rQ,Object.assign({type:"point",data:u,scale:y,style:w,animate:typeof i=="object"?uo(i,"indicator"):i},l)),ri({},iQ,{style:Object.assign({text:sQ(b,{target:p,total:m})},b),animate:typeof i=="object"?uo(i,"text"):i})]};J8.props={};const ek=5e3;function tk(e,t,n){return e+(t-e)*n}function lQ(e,t,n,r){return t===0?[[e+1/2*n/Math.PI/2,r/2],[e+1/2*n/Math.PI,r],[e+n/4,r]]:t===1?[[e+1/2*n/Math.PI/2*(Math.PI-2),r],[e+1/2*n/Math.PI/2*(Math.PI-1),r/2],[e+n/4,0]]:t===2?[[e+1/2*n/Math.PI/2,-r/2],[e+1/2*n/Math.PI,-r],[e+n/4,-r]]:[[e+1/2*n/Math.PI/2*(Math.PI-2),-r],[e+1/2*n/Math.PI/2*(Math.PI-1),-r/2],[e+n/4,0]]}function cQ(e,t,n,r,i,s,l){const u=Math.ceil(2*e/n*4)*4,h=[];let p=r;for(;p<-Math.PI*2;)p+=Math.PI*2;for(;p>0;)p-=Math.PI*2;p=p/Math.PI/2*n;const m=s-e+p-e*2;h.push(["M",m,t]);let y=0;for(let b=0;b<u;++b){const w=b%4,R=lQ(b*n/4,w,n,i);h.push(["C",R[0][0]+m,-R[0][1]+t,R[1][0]+m,-R[1][1]+t,R[2][0]+m,-R[2][1]+t]),b===u-1&&(y=R[2][0])}return h.push(["L",y+m,l+e]),h.push(["L",m,l+e]),h.push(["Z"]),h}function uQ(e,t,n,r,i,s,l,u,h,p,m){const{fill:y,fillOpacity:b,opacity:w}=i;for(let R=0;R<r;R++){const P=r<=1?1:R/(r-1),I=cQ(u,l+u*n,h,0,u/40,e,t),N=m.createElement("path",{style:{d:I,fill:y,opacity:tk(.2,.9,P)*Number(w||b)}});s.appendChild(N);try{if(p===!1)return;const z=[{transform:"translate(0, 0)"},{transform:`translate(${h*2}, 0)`}];N.animate(z,{duration:tk(.5*ek,ek,P)*2,iterations:1/0})}catch(z){console.warn("off-screen group animate error!")}}}function fQ(e,t,n){return`
      M ${e} ${t-n} 
      a ${n} ${n} 0 1 0 0 ${n*2}
      a ${n} ${n} 0 1 0 0 ${-n*2}
      Z
    `}function hQ(e,t,n){const i=n*.618;return`
      M ${e-i} ${t-n}
      L ${e+i} ${t-n}
      L ${e+i} ${t+n}
      L ${e-i} ${t+n}
      Z
    `}function dQ(e,t,n){return`
      M ${e} ${t-n}
      L ${e+n} ${t}
      L ${e} ${t+n}
      L ${e-n} ${t}
      Z
    `}function pQ(e,t,n){return`
      M ${e} ${t-n}
      L ${e+n} ${t+n}
      L ${e-n} ${t+n}
      Z
    `}function mQ(e,t,n){const r=n*4/3,i=Math.max(r,n*2),s=r/2,l=e,u=s+t-i/2,h=Math.asin(s/((i-s)*.85)),p=Math.sin(h)*s,m=Math.cos(h)*s,y=l-m,b=u+p,w=e,R=u+s/Math.sin(h);return`
      M ${y} ${b}
      A ${s} ${s} 0 1 1 ${y+m*2} ${b}
      Q ${w} ${R} ${e} ${t+i/2}
      Q ${w} ${R} ${y} ${b}
      Z 
    `}const nk={pin:mQ,rect:hQ,circle:fQ,diamond:dQ,triangle:pQ};var rk=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const vQ=(e="circle")=>nk[e]||nk.circle,ik=(e,t)=>{if(!t)return;const{coordinate:n}=t,{liquidOptions:r,styleOptions:i}=e,{liquidShape:s,percent:l}=r,{background:u,outline:h={},wave:p={}}=i,m=rk(i,["background","outline","wave"]),{border:y=2,distance:b=0}=h,w=rk(h,["border","distance"]),{length:R=192,count:P=3}=p;return(I,N,z)=>{const{document:Z}=t.canvas,{color:Y,fillOpacity:$}=z,J=Object.assign(Object.assign({fill:Y},z),m),ae=Z.createElement("g",{}),[pe,Oe]=n.getCenter(),Ve=n.getSize(),Ke=Math.min(...Ve)/2,Ge=(Dh(s)?s:vQ(s))(pe,Oe,Ke,...Ve);if(Object.keys(u).length){const ut=Z.createElement("path",{style:Object.assign({d:Ge,fill:"#fff"},u)});ae.appendChild(ut)}if(l>0){const ut=Z.createElement("path",{style:{d:Ge}});ae.appendChild(ut),ae.style.clipPath=ut,uQ(pe,Oe,1-l,P,J,ae,ut.getBBox().y,Ke*2,R,!0,Z)}const rt=Z.createElement("path",{style:{d:Ge,fill:"transparent",lineWidth:y+2*b,stroke:"#fff"}}),st=Z.createElement("path",{style:Object.assign(Object.assign(Object.assign({d:Ge,stroke:Y,strokeOpacity:$,lineWidth:y},J),w),{fill:"transparent"})});return ae.appendChild(rt),ae.appendChild(st),ae}};ik.props={};var gQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const yQ={axis:{x:!1,y:!1},legend:!1,tooltip:!1,encode:{x:"type",y:"percent"},scale:{y:{domain:[0,1]}},style:{shape:ik},animate:{enter:{type:"fadeIn"}}},_Q={type:"text",style:{x:"50%",y:"50%",textAlign:"center",textBaseline:"middle",fontSize:20,fontWeight:800,fill:"#888"},animate:{enter:{type:"fadeIn"}}},ok=e=>{const{data:t={},style:n={},animate:r}=e,i=gQ(e,["data","style","animate"]),s=Math.max(0,(0,dr.Z)(t)?t:t==null?void 0:t.percent),l=[{percent:s,type:"liquid"}],u=Object.assign(Object.assign({},uo(n,"text")),uo(n,"content")),h=uo(n,"outline"),p=uo(n,"wave"),m=uo(n,"background");return[ri({},yQ,Object.assign({type:"interval",data:l,style:{liquidOptions:{percent:s,liquidShape:n==null?void 0:n.shape},styleOptions:Object.assign(Object.assign({},n),{outline:h,wave:p,background:m})},animate:r},i)),ri({},_Q,{style:Object.assign({text:`${r_(s*100)} %`},u),animate:r})]};ok.props={};var tg=D(69916);const ak=1e-10;function sk(e,t){const n=xQ(e),r=n.filter(function(h){return bQ(h,e)});let i=0,s=0,l;const u=[];if(r.length>1){const h=EQ(r);for(l=0;l<r.length;++l){const m=r[l];m.angle=Math.atan2(m.x-h.x,m.y-h.y)}r.sort(function(m,y){return y.angle-m.angle});let p=r[r.length-1];for(l=0;l<r.length;++l){const m=r[l];s+=(p.x+m.x)*(m.y-p.y);const y={x:(m.x+p.x)/2,y:(m.y+p.y)/2};let b=null;for(let w=0;w<m.parentIndex.length;++w)if(p.parentIndex.indexOf(m.parentIndex[w])>-1){const R=e[m.parentIndex[w]],P=Math.atan2(m.x-R.x,m.y-R.y),I=Math.atan2(p.x-R.x,p.y-R.y);let N=I-P;N<0&&(N+=2*Math.PI);const z=I-N/2;let Z=O2(y,{x:R.x+R.radius*Math.sin(z),y:R.y+R.radius*Math.cos(z)});Z>R.radius*2&&(Z=R.radius*2),(b===null||b.width>Z)&&(b={circle:R,width:Z,p1:m,p2:p})}b!==null&&(u.push(b),i+=_M(b.circle.radius,b.width),p=m)}}else{let h=e[0];for(l=1;l<e.length;++l)e[l].radius<h.radius&&(h=e[l]);let p=!1;for(l=0;l<e.length;++l)if(O2(e[l],h)>Math.abs(h.radius-e[l].radius)){p=!0;break}p?i=s=0:(i=h.radius*h.radius*Math.PI,u.push({circle:h,p1:{x:h.x,y:h.y+h.radius},p2:{x:h.x-ak,y:h.y+h.radius},width:h.radius*2}))}return s/=2,t&&(t.area=i+s,t.arcArea=i,t.polygonArea=s,t.arcs=u,t.innerPoints=r,t.intersectionPoints=n),i+s}function bQ(e,t){for(let n=0;n<t.length;++n)if(O2(e,t[n])>t[n].radius+ak)return!1;return!0}function xQ(e){const t=[];for(let n=0;n<e.length;++n)for(let r=n+1;r<e.length;++r){const i=ck(e[n],e[r]);for(let s=0;s<i.length;++s){const l=i[s];l.parentIndex=[n,r],t.push(l)}}return t}function _M(e,t){return e*e*Math.acos(1-t/e)-(e-t)*Math.sqrt(t*(2*e-t))}function O2(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function lk(e,t,n){if(n>=e+t)return 0;if(n<=Math.abs(e-t))return Math.PI*Math.min(e,t)*Math.min(e,t);const r=e-(n*n-t*t+e*e)/(2*n),i=t-(n*n-e*e+t*t)/(2*n);return _M(e,r)+_M(t,i)}function ck(e,t){const n=O2(e,t),r=e.radius,i=t.radius;if(n>=r+i||n<=Math.abs(r-i))return[];const s=(r*r-i*i+n*n)/(2*n),l=Math.sqrt(r*r-s*s),u=e.x+s*(t.x-e.x)/n,h=e.y+s*(t.y-e.y)/n,p=-(t.y-e.y)*(l/n),m=-(t.x-e.x)*(l/n);return[{x:u+p,y:h-m},{x:u-p,y:h+m}]}function EQ(e){const t={x:0,y:0};for(let n=0;n<e.length;++n)t.x+=e[n].x,t.y+=e[n].y;return t.x/=e.length,t.y/=e.length,t}function SQ(e,t){t=t||{},t.maxIterations=t.maxIterations||500;const n=t.initialLayout||CQ,r=t.lossFunction||xM;e=TQ(e);const i=n(e,t),s=[],l=[];let u;for(u in i)i.hasOwnProperty(u)&&(s.push(i[u].x),s.push(i[u].y),l.push(u));const p=(0,tg.nelderMead)(function(m){const y={};for(let b=0;b<l.length;++b){const w=l[b];y[w]={x:m[2*b],y:m[2*b+1],radius:i[w].radius}}return r(y,e)},s,t).x;for(let m=0;m<l.length;++m)u=l[m],i[u].x=p[2*m],i[u].y=p[2*m+1];return i}const uk=1e-10;function bM(e,t,n){return Math.min(e,t)*Math.min(e,t)*Math.PI<=n+uk?Math.abs(e-t):(0,tg.bisect)(function(r){return lk(e,t,r)-n},0,e+t)}function TQ(e){e=e.slice();const t=[],n={};let r,i,s,l;for(r=0;r<e.length;++r){const u=e[r];u.sets.length==1?t.push(u.sets[0]):u.sets.length==2&&(s=u.sets[0],l=u.sets[1],n[[s,l]]=!0,n[[l,s]]=!0)}for(t.sort((u,h)=>u>h?1:-1),r=0;r<t.length;++r)for(s=t[r],i=r+1;i<t.length;++i)l=t[i],[s,l]in n||e.push({sets:[s,l],size:0});return e}function wQ(e,t,n){const r=(0,tg.zerosM)(t.length,t.length),i=(0,tg.zerosM)(t.length,t.length);return e.filter(function(s){return s.sets.length==2}).map(function(s){const l=n[s.sets[0]],u=n[s.sets[1]],h=Math.sqrt(t[l].size/Math.PI),p=Math.sqrt(t[u].size/Math.PI),m=bM(h,p,s.size);r[l][u]=r[u][l]=m;let y=0;s.size+1e-10>=Math.min(t[l].size,t[u].size)?y=1:s.size<=1e-10&&(y=-1),i[l][u]=i[u][l]=y}),{distances:r,constraints:i}}function AQ(e,t,n,r){let i=0,s;for(s=0;s<t.length;++s)t[s]=0;for(s=0;s<n.length;++s){const l=e[2*s],u=e[2*s+1];for(let h=s+1;h<n.length;++h){const p=e[2*h],m=e[2*h+1],y=n[s][h],b=r[s][h],w=(p-l)*(p-l)+(m-u)*(m-u),R=Math.sqrt(w),P=w-y*y;b>0&&R<=y||b<0&&R>=y||(i+=2*P*P,t[2*s]+=4*P*(l-p),t[2*s+1]+=4*P*(u-m),t[2*h]+=4*P*(p-l),t[2*h+1]+=4*P*(m-u))}}return i}function CQ(e,t){let n=RQ(e,t);const r=t.lossFunction||xM;if(e.length>=8){const i=OQ(e,t),s=r(i,e),l=r(n,e);s+1e-8<l&&(n=i)}return n}function OQ(e,t){t=t||{};const n=t.restarts||10,r=[],i={};let s;for(s=0;s<e.length;++s){const P=e[s];P.sets.length==1&&(i[P.sets[0]]=r.length,r.push(P))}const l=wQ(e,r,i);let u=l.distances;const h=l.constraints,p=(0,tg.norm2)(u.map(tg.norm2))/u.length;u=u.map(function(P){return P.map(function(I){return I/p})});const m=function(P,I){return AQ(P,I,u,h)};let y,b;for(s=0;s<n;++s){const P=(0,tg.zeros)(u.length*2).map(Math.random);b=(0,tg.conjugateGradient)(m,P,t),(!y||b.fx<y.fx)&&(y=b)}const w=y.x,R={};for(s=0;s<r.length;++s){const P=r[s];R[P.sets[0]]={x:w[2*s]*p,y:w[2*s+1]*p,radius:Math.sqrt(P.size/Math.PI)}}if(t.history)for(s=0;s<t.history.length;++s)(0,tg.scale)(t.history[s].x,p);return R}function RQ(e,t){const n=t&&t.lossFunction?t.lossFunction:xM,r={},i={};let s;for(let y=0;y<e.length;++y){const b=e[y];b.sets.length==1&&(s=b.sets[0],r[s]={x:1e10,y:1e10,rowid:Object.keys(r).length,size:b.size,radius:Math.sqrt(b.size/Math.PI)},i[s]=[])}e=e.filter(function(y){return y.sets.length==2});for(let y=0;y<e.length;++y){const b=e[y];let w=b.hasOwnProperty("weight")?b.weight:1;const R=b.sets[0],P=b.sets[1];b.size+uk>=Math.min(r[R].size,r[P].size)&&(w=0),i[R].push({set:P,size:b.size,weight:w}),i[P].push({set:R,size:b.size,weight:w})}const l=[];for(s in i)if(i.hasOwnProperty(s)){let y=0;for(let b=0;b<i[s].length;++b)y+=i[s][b].size*i[s][b].weight;l.push({set:s,size:y})}function u(y,b){return b.size-y.size}l.sort(u);const h={};function p(y){return y.set in h}function m(y,b){r[b].x=y.x,r[b].y=y.y,h[b]=!0}m({x:0,y:0},l[0].set);for(let y=1;y<l.length;++y){const b=l[y].set,w=i[b].filter(p);if(s=r[b],w.sort(u),w.length===0)throw"ERROR: missing pairwise overlap information";const R=[];for(let N=0;N<w.length;++N){const z=r[w[N].set],Z=bM(s.radius,z.radius,w[N].size);R.push({x:z.x+Z,y:z.y}),R.push({x:z.x-Z,y:z.y}),R.push({y:z.y+Z,x:z.x}),R.push({y:z.y-Z,x:z.x});for(let Y=N+1;Y<w.length;++Y){const $=r[w[Y].set],J=bM(s.radius,$.radius,w[Y].size),ae=ck({x:z.x,y:z.y,radius:Z},{x:$.x,y:$.y,radius:J});for(let pe=0;pe<ae.length;++pe)R.push(ae[pe])}}let P=1e50,I=R[0];for(let N=0;N<R.length;++N){r[b].x=R[N].x,r[b].y=R[N].y;const z=n(r,e);z<P&&(P=z,I=R[N])}m(I,b)}return r}function xM(e,t){let n=0;function r(i){return i.map(function(s){return e[s]})}for(let i=0;i<t.length;++i){const s=t[i];let l;if(s.sets.length==1)continue;if(s.sets.length==2){const h=e[s.sets[0]],p=e[s.sets[1]];l=lk(h.radius,p.radius,O2(h,p))}else l=sk(r(s.sets));const u=s.hasOwnProperty("weight")?s.weight:1;n+=u*(l-s.size)*(l-s.size)}return n}function MQ(e,t,n){n===null?e.sort(function(i,s){return s.radius-i.radius}):e.sort(n);let r;if(e.length>0){const i=e[0].x,s=e[0].y;for(r=0;r<e.length;++r)e[r].x-=i,e[r].y-=s}if(e.length==2&&distance(e[0],e[1])<Math.abs(e[1].radius-e[0].radius)&&(e[1].x=e[0].x+e[0].radius-e[1].radius-1e-10,e[1].y=e[0].y),e.length>1){const i=Math.atan2(e[1].x,e[1].y)-t;let s,l;const u=Math.cos(i),h=Math.sin(i);for(r=0;r<e.length;++r)s=e[r].x,l=e[r].y,e[r].x=u*s-h*l,e[r].y=h*s+u*l}if(e.length>2){let i=Math.atan2(e[2].x,e[2].y)-t;for(;i<0;)i+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI;if(i>Math.PI){const s=e[1].y/(1e-10+e[1].x);for(r=0;r<e.length;++r){const l=(e[r].x+s*e[r].y)/(1+s*s);e[r].x=2*l-e[r].x,e[r].y=2*l*s-e[r].y}}}}function PQ(e){e.map(function(l){l.parent=l});function t(l){return l.parent!==l&&(l.parent=t(l.parent)),l.parent}function n(l,u){const h=t(l),p=t(u);h.parent=p}for(let l=0;l<e.length;++l)for(let u=l+1;u<e.length;++u){const h=e[l].radius+e[u].radius;distance(e[l],e[u])+1e-10<h&&n(e[u],e[l])}const r={};let i;for(let l=0;l<e.length;++l)i=t(e[l]).parent.setid,i in r||(r[i]=[]),r[i].push(e[l]);e.map(function(l){delete l.parent});const s=[];for(i in r)r.hasOwnProperty(i)&&s.push(r[i]);return s}function EM(e){const t=function(n){const r=Math.max.apply(null,e.map(function(s){return s[n]+s.radius})),i=Math.min.apply(null,e.map(function(s){return s[n]-s.radius}));return{max:r,min:i}};return{xRange:t("x"),yRange:t("y")}}function tne(e,t,n){t===null&&(t=Math.PI/2);let r=[],i,s;for(s in e)if(e.hasOwnProperty(s)){const b=e[s];r.push({x:b.x,y:b.y,radius:b.radius,setid:s})}const l=PQ(r);for(i=0;i<l.length;++i){MQ(l[i],t,n);const b=EM(l[i]);l[i].size=(b.xRange.max-b.xRange.min)*(b.yRange.max-b.yRange.min),l[i].bounds=b}l.sort(function(b,w){return w.size-b.size}),r=l[0];let u=r.bounds;const h=(u.xRange.max-u.xRange.min)/50;function p(b,w,R){if(!b)return;const P=b.bounds;let I,N,z;w?I=u.xRange.max-P.xRange.min+h:(I=u.xRange.max-P.xRange.max,z=(P.xRange.max-P.xRange.min)/2-(u.xRange.max-u.xRange.min)/2,z<0&&(I+=z)),R?N=u.yRange.max-P.yRange.min+h:(N=u.yRange.max-P.yRange.max,z=(P.yRange.max-P.yRange.min)/2-(u.yRange.max-u.yRange.min)/2,z<0&&(N+=z));for(let Z=0;Z<b.length;++Z)b[Z].x+=I,b[Z].y+=N,r.push(b[Z])}let m=1;for(;m<l.length;)p(l[m],!0,!1),p(l[m+1],!1,!0),p(l[m+2],!0,!0),m+=3,u=EM(r);const y={};for(i=0;i<r.length;++i)y[r[i].setid]=r[i];return y}function IQ(e,t,n,r){const i=[],s=[];for(const P in e)e.hasOwnProperty(P)&&(s.push(P),i.push(e[P]));t-=2*r,n-=2*r;const l=EM(i),u=l.xRange,h=l.yRange;if(u.max==u.min||h.max==h.min)return console.log("not scaling solution: zero size detected"),e;const p=t/(u.max-u.min),m=n/(h.max-h.min),y=Math.min(m,p),b=(t-(u.max-u.min)*y)/2,w=(n-(h.max-h.min)*y)/2,R={};for(let P=0;P<i.length;++P){const I=i[P];R[s[P]]={radius:y*I.radius,x:r+b+(I.x-u.min)*y,y:r+w+(I.y-h.min)*y}}return R}function LQ(e,t,n){const r=[],i=e-n,s=t;return r.push("M",i,s),r.push("A",n,n,0,1,0,i+2*n,s),r.push("A",n,n,0,1,0,i,s),r.join(" ")}function DQ(e){const t={};sk(e,t);const n=t.arcs;if(n.length===0)return"M 0 0";if(n.length==1){const r=n[0].circle;return LQ(r.x,r.y,r.radius)}else{const r=[`
M`,n[0].p2.x,n[0].p2.y];for(let i=0;i<n.length;++i){const s=n[i],l=s.circle.radius,u=s.width>l;r.push(`
A`,l,l,0,u?1:0,1,s.p1.x,s.p1.y)}return r.join(" ")}}const fk=e=>{const{sets:t="sets",size:n="size",as:r=["key","path"],padding:i=0}=e,[s,l]=r;return u=>{const h=u.map(y=>Object.assign(Object.assign({},y),{sets:y[t],size:y[n],[s]:y.sets.join("&")}));h.sort((y,b)=>y.sets.length-b.sets.length);const p=SQ(h);let m;return h.map(y=>{const b=y[t],w=({width:R,height:P})=>{m=m||IQ(p,R,P,i);const I=b.map(z=>m[z]);let N=DQ(I);return/[zZ]$/.test(N)||(N+=" Z"),N};return Object.assign(Object.assign({},y),{[l]:w})})}};fk.props={};function NQ(){return{"data.venn":fk,"mark.boxplot":K8,"mark.gauge":J8,"mark.wordCloud":R3,"mark.liquid":ok}}function BQ(){return Object.assign(Object.assign(Object.assign(Object.assign({},X$()),Kq()),NQ()),HY())}var ww=function(){return ww=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},ww.apply(this,arguments)},FQ=gj(vj,ww(ww({},BQ()),tV())),SM=D(73505),R2=function(){return R2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},R2.apply(this,arguments)},kQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},zQ=["renderer"],hk=["width","height","autoFit","theme","inset","insetLeft","insetRight","insetTop","insetBottom","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","depth","title","clip","children","type","data","direction"],TM="__transform__",UQ="__skipDelCustomKeys__",C1=function(e,t){return(0,SM.Z)(t)?{type:e,available:t}:R2({type:e},t)},wM={xField:"encode.x",yField:"encode.y",colorField:"encode.color",angleField:"encode.y",keyField:"encode.key",sizeField:"encode.size",shapeField:"encode.shape",seriesField:"encode.series",positionField:"encode.position",textField:"encode.text",valueField:"encode.value",binField:"encode.x",srcField:"encode.src",linkColorField:"encode.linkColor",fontSizeField:"encode.fontSize",radius:"coordinate.outerRadius",innerRadius:"coordinate.innerRadius",startAngle:"coordinate.startAngle",endAngle:"coordinate.endAngle",focusX:"coordinate.focusX",focusY:"coordinate.focusY",distortionX:"coordinate.distortionX",distortionY:"coordinate.distortionY",visual:"coordinate.visual",stack:{target:"transform",value:function(e){return C1("stackY",e)}},normalize:{target:"transform",value:function(e){return C1("normalizeY",e)}},percent:{target:"transform",value:function(e){return C1("normalizeY",e)}},group:{target:"transform",value:function(e){return C1("dodgeX",e)}},sort:{target:"transform",value:function(e){return C1("sortX",e)}},symmetry:{target:"transform",value:function(e){return C1("symmetryY",e)}},diff:{target:"transform",value:function(e){return C1("diffY",e)}},meta:{target:"scale",value:function(e){return e}},label:{target:"labels",value:function(e){return e}},shape:"style.shape",connectNulls:{target:"style",value:function(e){return(0,SM.Z)(e)?{connect:e}:e}}},AM=["xField","yField","seriesField","colorField","keyField","positionField","meta","tooltip","animate","stack","normalize","percent","group","sort","symmetry","diff"],Aw=[{key:"annotations",extend_keys:[]},{key:"line",type:"line",extend_keys:AM},{key:"point",type:"point",extend_keys:AM},{key:"area",type:"area",extend_keys:AM}],jQ=[{key:"transform",callback:function(e,t,n){var r;e[t]=e[t]||[];var i=n.available,s=i===void 0?!0:i,l=kQ(n,["available"]);if(s)e[t].push(R2((r={},r[TM]=!0,r),l));else{var u=e[t].indexOf(function(h){return h.type===n.type});u!==-1&&e[t].splice(u,1)}}},{key:"labels",callback:function(e,t,n){var r;if(!n||(0,Rt.Z)(n)){e[t]=n||[];return}n.text||(n.text=e.yField),e[t]=e[t]||[],e[t].push(R2((r={},r[TM]=!0,r),n))}}],CM=[{key:"conversionTag",shape:"ConversionTag"},{key:"axisText",shape:"BidirectionalBarAxisText"}],VQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Cw=function(){return Cw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Cw.apply(this,arguments)},HQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},ZQ=function(e){VQ(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=HQ(n,["style"]);return e.call(this,Cw({style:Cw({fill:"#eee"},r)},i))||this}return t}(_o),WQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ow=function(){return Ow=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ow.apply(this,arguments)},GQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},dk=function(e){WQ(t,e);function t(n){n===void 0&&(n={});var r=n.style,i=GQ(n,["style"]);return e.call(this,Ow({style:Ow({text:"",fontSize:12,textBaseline:"middle",textAlign:"center",fill:"#000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1},r)},i))||this}return t}(Oa),XQ=D(19177),pk=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},YQ=function(e,t){if((0,Rt.Z)(t))return t},dy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return XQ.Z.apply(void 0,pk(pk([],e,!1),[YQ],!1))},$Q=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),mk=function(e){$Q(t,e);function t(n,r,i){var s=e.call(this,{style:dy(i,r)})||this;return s.chart=n,s}return t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this)},t.prototype.disconnectedCallback=function(){},t.prototype.attributeChangedCallback=function(n){},t.prototype.update=function(n,r){var i;return this.attr(dy({},this.attributes,n||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},t.prototype.clear=function(){this.removeChildren()},t.prototype.getElementsLayout=function(){var n=this.chart.getContext().canvas,r=n.document.getElementsByClassName("element"),i=[];return r.forEach(function(s){var l=s.getBBox(),u=l.x,h=l.y,p=l.width,m=l.height,y=s.__data__;i.push({bbox:l,x:u,y:h,width:p,height:m,key:y.key,data:y})}),i},t.prototype.bindEvents=function(n,r){},t}(Zi),KQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rw=function(){return Rw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Rw.apply(this,arguments)},qQ=function(e){KQ(t,e);function t(n,r){return e.call(this,n,r,{type:t.tag})||this}return t.prototype.getConversionTagLayout=function(){var n=this.direction==="vertical",r=this.getElementsLayout(),i=r[0],s=i.x,l=i.y,u=i.height,h=i.width,p=i.data,m=["items",0,"value"],y=(0,on.Z)(p,m),b=n?r[1].y-l-u:r[1].x-s-h,w=[],R=this.attributes,P=R.size,I=P===void 0?40:P,N=R.arrowSize,z=N===void 0?20:N,Z=R.spacing,Y=Z===void 0?4:Z;return r.forEach(function($,J){if(J>0){var ae=$.x,pe=$.y,Oe=$.height,Ve=$.width,Ke=$.data,lt=$.key,Ge=(0,on.Z)(Ke,m),rt=I/2;if(n){var st=ae+Ve/2,ut=pe;w.push({points:[[st+rt,ut-b+Y],[st+rt,ut-z-Y],[st,ut-Y],[st-rt,ut-z-Y],[st-rt,ut-b+Y]],center:[st,ut-b/2-Y],width:b,value:[y,Ge],key:lt})}else{var st=ae,ut=pe+Oe/2;w.push({points:[[ae-b+Y,ut-rt],[ae-z-Y,ut-rt],[st-Y,ut],[ae-z-Y,ut+rt],[ae-b+Y,ut+rt]],center:[st-b/2-Y,ut],width:b,value:[y,Ge],key:lt})}y=Ge}}),w},t.prototype.render=function(){this.setDirection(),this.drawConversionTag()},t.prototype.setDirection=function(){var n=this.chart.getCoordinate(),r=(0,on.Z)(n,"options.transformations"),i="horizontal";r.forEach(function(s){s.includes("transpose")&&(i="vertical")}),this.direction=i},t.prototype.drawConversionTag=function(){var n=this,r=this.getConversionTagLayout(),i=this.attributes,s=i.style,l=i.text,u=l.style,h=l.formatter;r.forEach(function(p){var m=p.points,y=p.center,b=p.value,w=p.key,R=b[0],P=b[1],I=y[0],N=y[1],z=new ZQ({style:Rw({points:m,fill:"#eee"},s),id:"polygon-".concat(w)}),Z=new dk({style:Rw({x:I,y:N,text:(0,$e.Z)(h)?h(R,P):(P/R*100).toFixed(2)+"%"},u),id:"text-".concat(w)});n.appendChild(z),n.appendChild(Z)})},t.prototype.update=function(){var n=this,r=this.getConversionTagLayout();r.forEach(function(i){var s=i.points,l=i.center,u=i.key,h=l[0],p=l[1],m=n.getElementById("polygon-".concat(u)),y=n.getElementById("text-".concat(u));m.setAttribute("points",s),y.setAttribute("x",h),y.setAttribute("y",p)})},t.tag="ConversionTag",t}(mk),OM=D(87783),vk=D(15643),RM=32,gk=16,yk=48,QQ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),M2=function(){return M2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},M2.apply(this,arguments)},JQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},eJ=function(e){QQ(t,e);function t(n,r){return e.call(this,n,r,{type:t.tag})||this}return t.prototype.render=function(){this.drawText()},t.prototype.getBidirectionalBarAxisTextLayout=function(){var n=this.attributes.layout,r=n==="vertical",i=this.getElementsLayout(),s=r?(0,OM.Z)(i,"x"):(0,OM.Z)(i,"y"),l=["title"],u=[],h=this.chart.getContext().views,p=(0,on.Z)(h,[0,"layout"]),m=p.width,y=p.height;return s.forEach(function(b){var w=b.x,R=b.y,P=b.height,I=b.width,N=b.data,z=b.key,Z=(0,on.Z)(N,l);r?u.push({x:w+I/2,y,text:Z,key:z}):u.push({x:m,y:R+P/2,text:Z,key:z})}),(0,OM.Z)(u,"text").length!==u.length&&(u=Object.values((0,vk.Z)(u,"text")).map(function(b){var w,R=b.reduce(function(P,I){return P+(r?I.x:I.y)},0);return M2(M2({},b[0]),(w={},w[r?"x":"y"]=R/b.length,w))})),u},t.prototype.transformLabelStyle=function(n){var r={},i=/^label[A-Z]/;return Object.keys(n).forEach(function(s){i.test(s)&&(r[s.replace("label","").replace(/^[A-Z]/,function(l){return l.toLowerCase()})]=n[s])}),r},t.prototype.drawText=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout(),i=this.attributes,s=i.layout,l=i.labelFormatter,u=JQ(i,["layout","labelFormatter"]);r.forEach(function(h){var p=h.x,m=h.y,y=h.text,b=h.key,w=new dk({style:M2({x:p,y:m,text:(0,$e.Z)(l)?l(y):y,wordWrap:!0,wordWrapWidth:s==="horizontal"?RM*2:120,maxLines:2,textOverflow:"ellipsis"},n.transformLabelStyle(u)),id:"text-".concat(b)});n.appendChild(w)})},t.prototype.update=function(){var n=this,r=this.getBidirectionalBarAxisTextLayout();r.forEach(function(i){var s=i.x,l=i.y,u=i.key,h=n.getElementById("text-".concat(u));h.setAttribute("x",s),h.setAttribute("y",l)})},t.tag="BidirectionalBarAxisText",t}(mk),tJ={ConversionTag:qQ,BidirectionalBarAxisText:eJ},nJ=function(){function e(t,n){this.container=new Map,this.chart=t,this.config=n,this.init()}return e.prototype.init=function(){var t=this;CM.forEach(function(n){var r,i=n.key,s=n.shape,l=t.config[i];if(l){var u=new tJ[s](t.chart,l),h=t.chart.getContext().canvas;h.appendChild(u),t.container.set(i,u)}else(r=t.container.get(i))===null||r===void 0||r.clear()})},e.prototype.update=function(){var t=this;this.container.size&&CM.forEach(function(n){var r=n.key,i=t.container.get(r);i==null||i.update()})},e}(),_k=D(69441),rJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),mb=function(){return mb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},mb.apply(this,arguments)},bk="data-chart-source-type",Rl=function(e){rJ(t,e);function t(n,r){var i=e.call(this)||this;return i.container=typeof n=="string"?document.getElementById(n):n,i.options=i.mergeOption(r),i.createG2(),i.bindEvents(),i}return t.prototype.getChartOptions=function(){return mb(mb({},(0,_k.Z)(this.options,zQ)),{container:this.container})},t.prototype.getSpecOptions=function(){return this.type==="base"||this[UQ]?mb(mb({},this.options),this.getChartOptions()):this.options},t.prototype.createG2=function(){if(!this.container)throw Error("The container is not initialized!");this.chart=new FQ(this.getChartOptions()),this.container.setAttribute(bk,"Ant Design Charts")},t.prototype.bindEvents=function(){var n=this;this.chart&&this.chart.on("*",function(r){r!=null&&r.type&&n.emit(r.type,r)})},t.prototype.getBaseOptions=function(){return{type:"view",autoFit:!0}},t.prototype.getDefaultOptions=function(){},t.prototype.render=function(){var n=this;this.type!=="base"&&this.execAdaptor(),this.chart.options(this.getSpecOptions()),this.chart.render().then(function(){n.annotation=new nJ(n.chart,n.options)}),this.bindSizeSensor()},t.prototype.update=function(n){this.options=this.mergeOption(n)},t.prototype.mergeOption=function(n){return dy({},this.getBaseOptions(),this.getDefaultOptions(),n)},t.prototype.changeData=function(n){this.chart.changeData(n)},t.prototype.changeSize=function(n,r){this.chart.changeSize(n,r)},t.prototype.destroy=function(){this.chart.destroy(),this.off(),this.container.removeAttribute(bk)},t.prototype.execAdaptor=function(){var n=this.getSchemaAdaptor();n({chart:this.chart,options:this.options})},t.prototype.triggerResize=function(){this.chart.forceFit()},t.prototype.bindSizeSensor=function(){var n=this,r=this.options.autoFit,i=r===void 0?!0:r;i&&this.chart.on(gl.AFTER_CHANGE_SIZE,function(){n.annotation.update()})},t}(xn),iJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oJ=function(e){iJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="base",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"line"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return function(n){return n}},t}(Rl),kl=D(99503),aJ=function(e){var t=e.options,n=t.children,r=n===void 0?[]:n;return r.forEach(function(i){Object.keys(i).forEach(function(s){(0,Rt.Z)(i[s])&&s!=="data"&&(i[s]=i[s].filter(function(l){return!l[TM]}))})}),t},MM=D(32180),sJ=D(49360),La=D(48707),xk=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},lJ=function(e){var t=e.children,n=t===void 0?[]:t,r=Object.keys(wM).concat(Aw.map(function(i){return i.key}));return r.forEach(function(i){delete e[i]}),n.forEach(function(i){Object.keys(i).forEach(function(s){r.includes(s)&&delete i[s]})}),Object.keys(e).forEach(function(i){xk(xk([],hk,!0),CM.map(function(s){return s.key}),!0).includes(i)||delete e[i]}),e},Wl=function(e){var t=aJ(e),n=t.children,r=n===void 0?[]:n,i=(0,MM.Z)(t,[].concat(hk,Aw.map(function(p){return p.key}))),s=function(p){var m;return(m=jQ.find(function(y){return y.key===p}))===null||m===void 0?void 0:m.callback},l=function(p,m,y){var b=s(m);b?b(p,m,y):p[m]=dy({},p[m],y)},u=function(p){Object.keys(p).forEach(function(m){if(p[m]){var y=Aw.find(function(R){return R.key===m});if(y){var b=y.type,w=y.extend_keys;b?r.push(h(dy({},(0,_k.Z)(p,w),{type:b},p[m]))):(0,Rt.Z)(p[m])&&p[m].forEach(function(R){r.push(h(R))})}}})},h=function(p){return u(p),Object.keys(wM).forEach(function(m){var y=wM[m];if(!(0,sJ.Z)(p[m]))if((0,_t.Z)(y)){var b=y.value,w=y.target,R=b(p[m]);l(p,w,R)}else(0,La.Z)(p,y,p[m])}),p};return r.forEach(function(p){var m=dy({},i,p);h(dy(p,m))}),u(t),lJ(t),e},PM=function(){return PM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},PM.apply(this,arguments)};function cJ(e){var t=e.options,n=t.stack,r=t.tooltip,i=t.xField;if(!n)return e;var s=Aw.map(function(u){return u.type}).filter(function(u){return!!u}),l=!1;return s.forEach(function(u){t[u]&&(l=!0,(0,La.Z)(t,[u,"stack"],PM({y1:"y"},typeof n=="object"?n:{})))}),l&&!(0,SM.Z)(r)&&!r&&(0,La.Z)(t,"tooltip",{title:i,items:[{channel:"y"}]}),e}function Mu(e){return(0,kl.Z)(cJ)(e)}function uJ(e){return(0,kl.Z)(Mu,Wl)(e)}var fJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hJ=function(e){fJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="area",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"area"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return uJ},t}(Rl),vb=function(){return vb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},vb.apply(this,arguments)};function Ek(e){var t=function(n){var r=n.options;(0,on.Z)(r,"children.length")>1&&(0,La.Z)(r,"children",[{type:"interval"}]);var i=r.scale,s=r.markBackground,l=r.data,u=r.children,h=r.yField,p=(0,on.Z)(i,"y.domain",[]);if(s&&p.length&&(0,Rt.Z)(l)){var m="domainMax",y=l.map(function(b){var w;return vb(vb({originData:vb({},b)},(0,MM.Z)(b,h)),(w={},w[m]=p[p.length-1],w))});u.unshift(vb({type:"interval",data:y,yField:m,tooltip:!1,style:{fill:"#eee"},label:!1},s))}return n};return(0,kl.Z)(t,Mu,Wl)(e)}var dJ=function(){var e=function(t,n){return function(r){var i=t.fill,s=i===void 0?"#2888FF":i,l=t.stroke,u=t.fillOpacity,h=u===void 0?1:u,p=t.strokeOpacity,m=p===void 0?.2:p,y=t.pitch,b=y===void 0?8:y,w=r[0],R=r[1],P=r[2],I=r[3],N=(R[1]-w[1])/2,z=n.document,Z=z.createElement("g",{}),Y=z.createElement("polygon",{style:{points:[w,[w[0]-b,w[1]+N],[P[0]-b,w[1]+N],I],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m,inset:30}}),$=z.createElement("polygon",{style:{points:[[w[0]-b,w[1]+N],R,P,[P[0]-b,w[1]+N]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m}}),J=z.createElement("polygon",{style:{points:[w,[w[0]-b,w[1]+N],R,[w[0]+b,w[1]+N]],fill:s,fillOpacity:h-.2}});return Z.appendChild(Y),Z.appendChild($),Z.appendChild(J),Z}};ce("shape.interval.bar25D",e)},pJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();dJ();var mJ=function(e){pJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Bar",n}return t.getDefaultOptions=function(){return{type:"view",coordinate:{transform:[{type:"transpose"}]},children:[{type:"interval"}],scale:{y:{nice:!0}},axis:{y:{title:!1},x:{title:!1}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Ek},t}(Rl),vJ=function(){var e=function(t,n){return function(r){var i=t.fill,s=i===void 0?"#2888FF":i,l=t.stroke,u=t.fillOpacity,h=u===void 0?1:u,p=t.strokeOpacity,m=p===void 0?.2:p,y=t.pitch,b=y===void 0?8:y,w=r[1][0]-r[0][0],R=w/2+r[0][0],P=n.document,I=P.createElement("g",{}),N=P.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[R,r[1][1]+b],[R,r[3][1]+b],[r[3][0],r[3][1]]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m,inset:30}}),z=P.createElement("polygon",{style:{points:[[R,r[1][1]+b],[r[1][0],r[1][1]],[r[2][0],r[2][1]],[R,r[2][1]+b]],fill:s,fillOpacity:h,stroke:l,strokeOpacity:m}}),Z=P.createElement("polygon",{style:{points:[[r[0][0],r[0][1]],[R,r[1][1]-b],[r[1][0],r[1][1]],[R,r[1][1]+b]],fill:s,fillOpacity:h-.2}});return I.appendChild(z),I.appendChild(N),I.appendChild(Z),I}};ce("shape.interval.column25D",e)},gJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();vJ();var yJ=function(e){gJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="column",n}return t.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0},elementHighlight:{background:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Ek},t}(Rl);function _J(e){var t=function(r){var i=r.options,s=i.children,l=s===void 0?[]:s,u=i.legend;return u&&l.forEach(function(h){if(!(0,on.Z)(h,"colorField")){var p=(0,on.Z)(h,"yField");(0,La.Z)(h,"colorField",function(){return p})}}),r},n=function(r){var i=r.options,s=i.annotations,l=s===void 0?[]:s,u=i.children,h=u===void 0?[]:u,p=i.scale,m=!1;return(0,on.Z)(p,"y.key")||h.forEach(function(y,b){if(!(0,on.Z)(y,"scale.y.key")){var w="child".concat(b,"Scale");(0,La.Z)(y,"scale.y.key",w);var R=y.annotations,P=R===void 0?[]:R;P.length>0&&((0,La.Z)(y,"scale.y.independent",!1),P.forEach(function(I){(0,La.Z)(I,"scale.y.key",w)})),!m&&l.length>0&&(0,on.Z)(y,"scale.y.independent")===void 0&&(m=!0,(0,La.Z)(y,"scale.y.independent",!1),l.forEach(function(I){(0,La.Z)(I,"scale.y.key",w)}))}}),r};return(0,kl.Z)(t,n,Mu,Wl)(e)}var bJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sk=function(e){bJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="DualAxes",n}return t.getDefaultOptions=function(){return{type:"view",axis:{y:{title:!1,tick:!1},x:{title:!1}},scale:{y:{independent:!0,nice:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return _J},t}(Rl);function xJ(e){var t=function(s){var l=s.options,u=l.xField,h=l.colorField;return h||(0,La.Z)(l,"colorField",u),s},n=function(s){var l=s.options,u=l.compareField,h=l.transform,p=l.isTransposed,m=p===void 0?!0:p,y=l.coordinate;return h||(u?(0,La.Z)(l,"transform",[]):(0,La.Z)(l,"transform",[{type:"symmetryY"}])),!y&&m&&(0,La.Z)(l,"coordinate",{transform:[{type:"transpose"}]}),s},r=function(s){var l=s.options,u=l.compareField,h=l.seriesField,p=l.data,m=l.children,y=l.yField,b=l.isTransposed,w=b===void 0?!0:b;if(u||h){var R=Object.values((0,vk.Z)(p,function(P){return P[u||h]}));m[0].data=R[0],m.push({type:"interval",data:R[1],yField:function(P){return-P[y]}}),delete l.compareField,delete l.data}return h&&((0,La.Z)(l,"type","spaceFlex"),(0,La.Z)(l,"ratio",[1,1]),(0,La.Z)(l,"direction",w?"row":"col"),delete l.seriesField),s},i=function(s){var l=s.options,u=l.tooltip,h=l.xField,p=l.yField;return u||(0,La.Z)(l,"tooltip",{title:!1,items:[function(m){return{name:m[h],value:m[p]}}]}),s};return(0,kl.Z)(t,n,r,i,Mu,Wl)(e)}var EJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),SJ=function(e){EJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="column",n}return t.getDefaultOptions=function(){return{type:"view",scale:{x:{padding:0}},animate:{enter:{type:"fadeIn"}},axis:!1,shapeField:"funnel",label:{position:"inside",transform:[{type:"contrastReverse"}]},children:[{type:"interval"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return xJ},t}(Rl);function TJ(e){return(0,kl.Z)(Mu,Wl)(e)}var wJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),AJ=function(e){wJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="line",n}return t.getDefaultOptions=function(){return{type:"view",scale:{y:{nice:!0}},interaction:{tooltip:{shared:!0}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"line"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return TJ},t}(Rl);function P2(e){switch(typeof e){case"function":return e;case"string":return function(t){return(0,on.Z)(t,[e])};default:return function(){return e}}}var py=function(){return py=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},py.apply(this,arguments)};function CJ(e){var t=function(n){var r=n.options,i=r.angleField,s=r.data,l=r.label,u=r.tooltip,h=r.colorField,p=P2(h);if((0,Rt.Z)(s)){var m=s.reduce(function(b,w){return b+w[i]},0);if(m===0){var y=s.map(function(b){var w;return py(py({},b),(w={},w[i]=1,w))});(0,La.Z)(r,"data",y),l&&(0,La.Z)(r,"label",py(py({},l),{formatter:function(){return 0}})),u!==!1&&(0,La.Z)(r,"tooltip",py(py({},u),{items:[function(b,w,R){return{name:p(b,w,R),value:0}}]}))}}return n};return(0,kl.Z)(t,Wl)(e)}var OJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),RJ=function(e){OJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="pie",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"theta"},transform:[{type:"stackY",reverse:!0}],animate:{enter:{type:"waveIn"}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return CJ},t}(Rl);function MJ(e){return(0,kl.Z)(Mu,Wl)(e)}var PJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),IJ=function(e){PJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="scatter",n}return t.getDefaultOptions=function(){return{axis:{y:{title:!1},x:{title:!1}},legend:{size:!1},children:[{type:"point"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return MJ},t}(Rl);function LJ(e){var t=function(n){return(0,La.Z)(n,"options.coordinate",{type:(0,on.Z)(n,"options.coordinateType","polar")}),n};return(0,kl.Z)(t,Wl)(e)}var DJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),NJ=function(e){DJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="radar",n}return t.getDefaultOptions=function(){return{axis:{x:{grid:!0,line:!0},y:{zIndex:1,title:!1,line:!0,nice:!0}},meta:{x:{padding:.5,align:0}},interaction:{tooltip:{style:{crosshairsLineDash:[4,4]}}},children:[{type:"line"}],coordinateType:"polar"}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return LJ},t}(Rl),gb=D(43836),ng=function(){return ng=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},ng.apply(this,arguments)},BJ="__stock-range__",FJ="trend",kJ="up",zJ="down";function UJ(e){var t=function(r){var i=r.options,s=i.data,l=i.yField;return r.options.data=(0,gb.Z)(s,function(u){var h=u&&ng({},u);if(Array.isArray(l)&&h){var p=l[0],m=l[1],y=l[2],b=l[3];h[FJ]=h[p]<=h[m]?kJ:zJ,h[BJ]=[h[p],h[m],h[y],h[b]]}return h}),r},n=function(r){var i=r.options,s=i.xField,l=i.yField,u=i.fallingFill,h=i.risingFill,p=l[0],m=l[1],y=l[2],b=l[3],w=P2(s);return r.options.children=(0,gb.Z)(r.options.children,function(R,P){var I=P===0;return ng(ng({},R),{tooltip:{title:function(N,z,Z){var Y=w(N,z,Z);return Y instanceof Date?Y.toLocaleString():Y},items:[{field:y},{field:b},{field:p},{field:m}]},encode:ng(ng({},R.encode||{}),{y:I?[y,b]:[p,m],color:function(N){return Math.sign(N[m]-N[p])}}),style:ng(ng({},R.style||{}),{lineWidth:I?1:10})})}),delete i.yField,r.options.legend={color:!1},u&&(0,La.Z)(r,"options.scale.color.range[0]",u),h&&(0,La.Z)(r,"options.scale.color.range[2]",h),r};return(0,kl.Z)(t,n,Wl)(e)}var jJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),VJ=["#26a69a","#999999","#ef5350"],HJ=function(e){jJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="stock",n}return t.getDefaultOptions=function(){return{type:"view",scale:{color:{domain:[-1,0,1],range:VJ},y:{nice:!0}},children:[{type:"link"},{type:"link"}],axis:{x:{title:!1,grid:!1},y:{title:!1,grid:!0,gridLineDash:null}},animate:{enter:{type:"scaleInY"}},interaction:{tooltip:{shared:!0,marker:!1,groupName:!1,crosshairs:!0}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return UJ},t}(Rl);function ZJ(e){return(0,kl.Z)(Mu,Wl)(e)}var WJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),GJ=function(e){WJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyLine",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"line",axis:!1}],animate:{enter:{type:"growInX",duration:500}},padding:0,margin:0,tooltip:!1}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return ZJ},t}(Rl);function XJ(e){return(0,kl.Z)(Mu,Wl)(e)}var YJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),$J=function(e){YJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyArea",n}return t.getDefaultOptions=function(){return{type:"view",animate:{enter:{type:"growInX",duration:500}},children:[{type:"area",axis:!1}],padding:0,margin:0,tooltip:!1}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return XJ},t}(Rl);function KJ(e){return(0,kl.Z)(Mu,Wl)(e)}var qJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),QJ=function(e){qJ(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyColumn",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval",axis:!1}],padding:0,margin:0,tooltip:!1}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return KJ},t}(Rl),IM=function(){return IM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},IM.apply(this,arguments)};function JJ(e){var t=function(n){var r=n.options,i=r.percent,s=r.color,l=s===void 0?[]:s;if(!i)return n;var u={scale:{color:{range:l.length?l:[]}},data:[1,i]};return Object.assign(r,IM({},u)),n};return(0,kl.Z)(t,Mu,Wl)(e)}var eee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),tee=function(e){eee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyProgress",n}return t.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,tooltip:!1,children:[{interaction:{tooltip:!1},coordinate:{transform:[{type:"transpose"}]},type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return JJ},t}(Rl),LM=function(){return LM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},LM.apply(this,arguments)};function nee(e){var t=function(r){var i=r.options,s=i.radius,l=s===void 0?.8:s;return(0,La.Z)(r,"options.coordinate.innerRadius",l),r},n=function(r){var i=r.options,s=i.percent,l=i.color,u=l===void 0?[]:l;if(!s)return r;var h={scale:{color:{range:u.length?u:[]}},data:[1,s]};return Object.assign(i,LM({},h)),r};return(0,kl.Z)(t,n,Mu,Wl)(e)}var ree=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),iee=function(e){ree(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="TinyRing",n}return t.getDefaultOptions=function(){return{type:"view",data:[],margin:0,padding:0,coordinate:{type:"theta"},animate:{enter:{type:"waveIn"}},interaction:{tooltip:!1},tooltip:!1,children:[{type:"interval",axis:!1,legend:!1,encode:{y:function(n){return n},color:function(n,r){return r}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return nee},t}(Rl);function oee(e){return(0,kl.Z)(Wl)(e)}var aee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),see=function(e){aee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="rose",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"polar"},animate:{enter:{type:"waveIn"}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return oee},t}(Rl),DM="__start__",yb="__end__",NM="__waterfall_value__",BM=function(){return BM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},BM.apply(this,arguments)},lee=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))};function cee(e){var t=function(r){var i=r.options,s=i.data,l=s===void 0?[]:s,u=i.yField;return l.length&&(l.reduce(function(h,p,m){var y,b=P2(u),w=b(p,m,l);if(m===0||p.isTotal)p[DM]=0,p[yb]=w,p[NM]=w;else{var R=(y=h[yb])!==null&&y!==void 0?y:b(h,m,l);p[DM]=R,p[yb]=R+w,p[NM]=h[yb]}return p},[]),Object.assign(i,{yField:[DM,yb]})),r},n=function(r){var i=r.options,s=i.data,l=s===void 0?[]:s,u=i.xField,h=i.children,p=i.linkStyle,m=lee([],l,!0);return m.reduce(function(y,b,w){return w>0&&(b.x1=y[u],b.x2=b[u],b.y1=y[yb]),b},[]),m.shift(),h.push({type:"link",xField:["x1","x2"],yField:"y1",zIndex:-1,data:m,style:BM({stroke:"#697474"},p),label:!1,tooltip:!1}),r};return(0,kl.Z)(t,n,Mu,Wl)(e)}var uee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),fee=function(e){uee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="waterfall",n}return t.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{field:NM,valueFormatter:"~s",name:"value"},axis:{y:{title:null,labelFormatter:"~s"},x:{title:null}},children:[{type:"interval",interaction:{elementHighlight:{background:!0}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return cee},t}(Rl),_b=D(290),Tk=D(79432),hee=D(20956),dee=D(20544);function pee(e){var t=function(n){var r=n.options,i=r.data,s=r.binNumber,l=r.binWidth,u=r.children,h=r.channel,p=h===void 0?"count":h,m=(0,on.Z)(u,"[0].transform[0]",{});return(0,_b.Z)(l)?((0,Tk.Z)(m,{thresholds:(0,hee.Z)((0,dee.Z)(i.length,l)),y:p}),n):((0,_b.Z)(s)&&(0,Tk.Z)(m,{thresholds:s,y:p}),n)};return(0,kl.Z)(t,Mu,Wl)(e)}var mee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),vee=function(e){mee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Histogram",n}return t.getDefaultOptions=function(){return{type:"view",autoFit:!0,axis:{y:{title:!1},x:{title:!1}},children:[{type:"rect",transform:[{type:"binX",y:"count"}],interaction:{elementHighlight:{background:!0}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return pee},t}(Rl);function gee(e){var t=function(r){var i=r.options,s=i.tooltip,l=s===void 0?{}:s,u=i.colorField,h=i.sizeField;return l&&!l.field&&(l.field=u||h),r},n=function(r){var i=r.options,s=i.mark,l=i.children;return s&&(l[0].type=s),r};return(0,kl.Z)(t,n,Mu,Wl)(e)}var yee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_ee=function(e){yee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="heatmap",n}return t.getDefaultOptions=function(){return{type:"view",legend:null,tooltip:{valueFormatter:"~s"},axis:{y:{title:null,grid:!0},x:{title:null,grid:!0}},children:[{type:"point",interaction:{elementHighlight:{background:!0}}}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return gee},t}(Rl);function bee(e){var t=function(n){var r=n.options.boxType,i=r===void 0?"box":r;return n.options.children[0].type=i,n};return(0,kl.Z)(t,Mu,Wl)(e)}var xee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Eee=function(e){xee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="box",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"box"}],axis:{y:{title:!1},x:{title:!1}},tooltip:{items:[{name:"min",channel:"y"},{name:"q1",channel:"y1"},{name:"q2",channel:"y2"},{name:"q3",channel:"y3"},{name:"max",channel:"y4"}]}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return bee},t}(Rl);function See(e){var t=function(n){var r=n.options,i=r.data,s=[{type:"custom",callback:function(u){return{links:u}}}];if((0,Rt.Z)(i))i.length>0?(0,La.Z)(r,"data",{value:i,transform:s}):delete r.children;else if((0,on.Z)(i,"type")==="fetch"&&(0,on.Z)(i,"value")){var l=(0,on.Z)(i,"transform");(0,Rt.Z)(l)?(0,La.Z)(i,"transform",l.concat(s)):(0,La.Z)(i,"transform",s)}return n};return(0,kl.Z)(t,Mu,Wl)(e)}var Tee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),wee=function(e){Tee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="sankey",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"sankey"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return See},t}(Rl);function Aee(e){var t=e.options.layout,n=t===void 0?"horizontal":t;return e.options.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}],e}function Cee(e){Aee(e);var t=e.options.layout,n=t===void 0?"horizontal":t;return e.options.children.forEach(function(r){var i;!((i=r==null?void 0:r.coordinate)===null||i===void 0)&&i.transform&&(r.coordinate.transform=n!=="horizontal"?void 0:[{type:"transpose"}])}),e}var Oee=D(27601),Ree=D(36378),Mee=D(90096),fm=function(){return fm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},fm.apply(this,arguments)},Mw=["#f0efff","#5B8FF9","#3D76DD"];function FM(e,t,n,r){r===void 0&&(r=!0);var i=0,s=!1,l=(0,gb.Z)(e,function(u){var h,p,m=(0,on.Z)(u,[t]);if((0,Oee.Z)(m))return[];if((0,Ree.Z)(m)){var y=Number(m);return isNaN(y)?[]:(h={},h[n]=u[n],h[t]=y,h)}return(0,Rt.Z)(m)?(s=!0,i=Math.max(i,m.length),(0,gb.Z)(r?m.sort(function(b,w){return w-b}):m,function(b,w){var R;return R={},R[n]=u[n],R[t]=b,R.index=w,R})):(i=Math.max(1,i),p={},p[n]=u[n],p[t]=m,p)}).flat();return s?[l.map(function(u){return fm({index:0},u)}),i]:[l,i]}function kM(e,t){return new Array(e).fill("").map(function(n,r){return(0,Rt.Z)(t)?t[r%t.length]:t})}function Pee(e){var t=function(i){var s=i.options,l=s.color,u=s.rangeField,h=u===void 0?"ranges":u,p=s.measureField,m=p===void 0?"measures":p,y=s.targetField,b=y===void 0?"targets":y,w=s.xField,R=w===void 0?"title":w,P=s.mapField,I=s.data,N=FM(I,h,R),z=N[0],Z=N[1],Y=FM(I,m,R,!1),$=Y[0],J=Y[1],ae=FM(I,b,R,!1),pe=ae[0],Oe=ae[1],Ve=(0,on.Z)(l,[h],Mw[0]),Ke=(0,on.Z)(l,[m],Mw[1]),lt=(0,on.Z)(l,[b],Mw[2]),Ge=[kM(Z,Ve),kM(J,Ke),kM(Oe,lt)].flat();return i.options.children=(0,gb.Z)(i.options.children,function(rt,st){var ut=[z,$,pe][st],jt=[h,m,b][st];return fm(fm({},rt),{data:ut,encode:fm(fm({},rt.encode||{}),{x:R,y:jt,color:function(At){var zt=At.index,wn=(0,_b.Z)(zt)?"".concat(jt,"_").concat(zt):jt;return P?(0,on.Z)(P,[jt,zt],wn):wn}}),style:fm(fm({},rt.style||{}),{zIndex:function(At){return-At[jt]}}),labels:st!==0?(0,gb.Z)(rt.labels,function(At){return fm(fm({},At),{text:jt})}):void 0})}),i.options.scale.color.range=Ge,i.options.legend.color.itemMarker=function(rt){return P&&(0,Mee.Z)(P==null?void 0:P[b],rt)||(rt==null?void 0:rt.replace(/\_\d$/,""))===b?"line":"square"},i},n=function(i){var s=i.options.layout,l=s===void 0?"horizontal":s;return l!=="horizontal"&&(0,La.Z)(i,"options.children[2].shapeField","hyphen"),i},r=function(i){var s=i.options,l=s.range,u=l===void 0?{}:l,h=s.measure,p=h===void 0?{}:h,m=s.target,y=m===void 0?{}:m,b=s.children;return i.options.children=[u,p,y].map(function(w,R){return dy(b[R],w)}),i};return(0,kl.Z)(t,n,r,Cee,Wl)(e)}var Iee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lee=function(e){Iee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="bullet",n}return t.getDefaultOptions=function(){return{type:"view",scale:{color:{range:Mw}},legend:{color:{itemMarker:function(n){return n==="target"?"line":"square"}}},axis:{y:{title:!1},x:{title:!1}},children:[{type:"interval",style:{maxWidth:30},axis:{y:{grid:!0,gridLineWidth:2}}},{type:"interval",style:{maxWidth:20},transform:[{type:"stackY"}]},{type:"point",encode:{size:8,shape:"line"}}],interaction:{tooltip:{shared:!0}},coordinate:{transform:[{type:"transpose"}]}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Pee},t}(Rl);function Dee(e){var t=function(n){var r=n.options.data;return n.options.data={value:r},n};return(0,kl.Z)(t,Mu,Wl)(e)}var Nee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bee=function(e){Nee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Gauge",n}return t.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"gauge"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Dee},t}(Rl);function Fee(e){var t=function(n){var r=n.options.percent;return(0,_b.Z)(r)&&((0,La.Z)(n,"options.data",r),delete n.options.percent),n};return(0,kl.Z)(t,Mu,Wl)(e)}var kee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),zee=function(e){kee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Liquid",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"liquid"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Fee},t}(Rl);function Uee(e){return(0,kl.Z)(Mu,Wl)(e)}var jee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vee=function(e){jee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="WordCloud",n}return t.getDefaultOptions=function(){return{type:"view",legend:!1,children:[{type:"wordCloud"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Uee},t}(Rl);function Hee(e){var t=function(n){var r=n.options,i=r.data;return i&&(0,La.Z)(r,"data",{value:i}),n};return(0,kl.Z)(t,Mu,Wl)(e)}var Zee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wee=function(e){Zee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="treemap",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"treemap"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Hee},t}(Rl),O1=function(){return O1=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},O1.apply(this,arguments)};function Gee(e){var t=function(i){var s=i.options,l=s.startAngle,u=s.maxAngle,h=s.coordinate,p=(0,_b.Z)(l)?l/(2*Math.PI)*360:-90,m=(0,_b.Z)(u)?(Number(u)+p)/180*Math.PI:Math.PI;return(0,La.Z)(i,["options","coordinate"],O1(O1({},h),{endAngle:m,startAngle:l!=null?l:-Math.PI/2})),i},n=function(i){var s=i.options,l=s.tooltip,u=s.xField,h=s.yField,p=P2(u),m=P2(h);return l||(0,La.Z)(s,"tooltip",{title:!1,items:[function(y,b,w){return{name:p(y,b,w),value:m(y,b,w)}}]}),i},r=function(i){var s=i.options,l=s.markBackground,u=s.children,h=s.scale,p=s.coordinate,m=s.xField,y=(0,on.Z)(h,"y.domain",[]);return l&&u.unshift(O1({type:"interval",xField:m,yField:y[y.length-1],colorField:l.color,scale:{color:{type:"identity"}},style:{fillOpacity:l.opacity,fill:l.color?void 0:"#e0e4ee"},coordinate:O1(O1({},p),{startAngle:-Math.PI/2,endAngle:1.5*Math.PI}),animate:!1},l)),i};return(0,kl.Z)(t,n,r,Mu,Wl)(e)}var Xee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yee=function(e){Xee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="radial",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"interval"}],coordinate:{type:"radial",innerRadius:.1,outerRadius:1,endAngle:Math.PI},animate:{enter:{type:"waveIn",duration:800}},axis:{y:{nice:!0,labelAutoHide:!0,labelAutoRotate:!1},x:{title:!1,nice:!0,labelAutoRotate:!1,labelAutoHide:{type:"equidistance",cfg:{minGap:6}}}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Gee},t}(Rl);function $ee(e){return(0,kl.Z)(Wl)(e)}var Kee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),qee=function(e){Kee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="CirclePacking",n}return t.getDefaultOptions=function(){return{legend:!1,type:"view",children:[{type:"pack"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return $ee},t}(Rl),Pw=function(){return Pw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Pw.apply(this,arguments)};function Qee(e){var t=function(n){var r=n.options,i=r.xField,s=r.yField,l=r.seriesField,u=r.children,h=u==null?void 0:u.map(function(p){return Pw(Pw({},p),{xField:i,yField:s,seriesField:l,colorField:l,data:p.type==="density"?{transform:[{type:"kde",field:s,groupBy:[i,l]}]}:p.data})}).filter(function(p){return r.violinType!=="density"||p.type==="density"});return(0,La.Z)(r,"children",h),r.violinType==="polar"&&(0,La.Z)(r,"coordinate",{type:"polar"}),(0,La.Z)(r,"violinType",void 0),n};return(0,kl.Z)(t,Mu,Wl)(e)}var Jee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ete=function(e){Jee(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="violin",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"density",sizeField:"size",tooltip:!1},{type:"boxplot",shapeField:"violin",style:{opacity:.5,point:!1}}],animate:{enter:{type:"fadeIn"}}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Qee},t}(Rl),tte=D(37514),I2=function(){return I2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},I2.apply(this,arguments)},nte=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))};function rte(e){var t=function(s){var l=s.options,u=l.yField,h=l.children;return h.forEach(function(p,m){(0,La.Z)(p,"yField",u[m])}),s},n=function(s){var l=s.options,u=l.yField,h=l.children,p=l.data;if((0,tte.Z)(p))return s;var m=(0,Rt.Z)((0,on.Z)(p,[0]))?p:[p,p];return h.forEach(function(y,b){(0,La.Z)(y,"data",nte([],m[b].map(function(w){return I2({groupKey:u[b]},w)}),!0))}),s},r=function(s){var l=s.options,u=l.yField,h=u[0],p=u[1],m=l.tooltip;return m||(0,La.Z)(l,"tooltip",{items:[{field:h,value:h},{field:p,value:p}]}),s},i=function(s){var l=s.options,u=l.children,h=l.layout,p=l.coordinate.transform,m=l.paddingBottom,y=m===void 0?yk:m,b=l.paddingLeft,w=b===void 0?yk:b,R=l.axis;(0,La.Z)(l,"axisText",I2(I2({},(R==null?void 0:R.x)||{}),{layout:h}));var P=u[0],I=u[1];if(h==="vertical")(0,La.Z)(l,"direction","col"),(0,La.Z)(l,"paddingLeft",w),(0,La.Z)(l,"coordinate.transform",p.filter(function($){return $.type!=="transpose"})),(0,La.Z)(P,"paddingBottom",gk),(0,La.Z)(I,"paddingTop",gk),(0,La.Z)(I,"axis",{x:{position:"top"}}),(0,La.Z)(I,"scale",{y:{range:[0,1]}});else{(0,La.Z)(l,"paddingBottom",y),(0,La.Z)(P,"scale",{y:{range:[0,1]}});var N=P.paddingRight,z=N===void 0?RM:N,Z=I.paddingLeft,Y=Z===void 0?RM:Z;(0,La.Z)(P,"paddingRight",z),(0,La.Z)(P,"axis",{x:{position:"right"}}),(0,La.Z)(I,"paddingLeft",Y)}return s};return(0,kl.Z)(t,n,r,i,Mu,Wl)(e)}var ite=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ote=function(e){ite(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="BidirectionalBar",n}return t.getDefaultOptions=function(){return{type:"spaceFlex",coordinate:{transform:[{type:"transpose"}]},scale:{y:{nice:!0}},direction:"row",layout:"horizontal",legend:!1,axis:{y:{title:!1},x:{title:!1,label:!1}},children:[{type:"interval"},{type:"interval"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return rte},t}(Rl),R1;(function(e){e.color="key",e.d="path"})(R1||(R1={}));function ate(e){var t=function(n){var r=n.options,i=r.data,s=r.setsField,l=r.sizeField;return(0,Rt.Z)(i)&&((0,La.Z)(r,"data",{type:"inline",value:i,transform:[{type:"venn",sets:s,size:l,as:[R1.color,R1.d]}]}),(0,La.Z)(r,"colorField",s),(0,La.Z)(r,["children","0","encode","d"],R1.d)),(0,La.Z)(n,"options",(0,MM.Z)(r,["sizeField","setsField"])),n};return(0,kl.Z)(t,Wl)(e)}var ste=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),lte=function(e){ste(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="venn",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"path"}],legend:{color:{itemMarker:"circle"}},encode:{color:R1.color,d:R1.d}}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return ate},t}(Rl);function cte(e){var t=function(n){return n};return(0,kl.Z)(t,Wl)(e)}var ute=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),fte=function(e){ute(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type="Sunburst",n}return t.getDefaultOptions=function(){return{type:"view",children:[{type:"sunburst"}]}},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return cte},t}(Rl),hte={Base:oJ,Line:AJ,Column:yJ,Pie:RJ,Area:hJ,Bar:mJ,DualAxes:Sk,Funnel:SJ,Scatter:IJ,Radar:NJ,Rose:see,Stock:HJ,TinyLine:GJ,TinyArea:$J,TinyColumn:QJ,TinyProgress:tee,TinyRing:iee,Waterfall:fee,Histogram:vee,Heatmap:_ee,Box:Eee,Sankey:wee,Bullet:Lee,Gauge:Bee,Liquid:zee,WordCloud:Vee,Treemap:Wee,RadialBar:Yee,CirclePacking:qee,Violin:ete,BidirectionalBar:ote,Venn:lte,Mix:Sk,Sunburst:fte},zM=function(){return zM=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},zM.apply(this,arguments)},wk=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},dte=(0,re.forwardRef)(function(e,t){var n=e.chartType,r=n===void 0?"Base":n,i=wk(e,["chartType"]),s=i.containerStyle,l=s===void 0?{height:"inherit",flex:1}:s,u=i.containerAttributes,h=u===void 0?{}:u,p=i.className,m=i.loading,y=i.loadingTemplate,b=i.errorTemplate,w=wk(i,["containerStyle","containerAttributes","className","loading","loadingTemplate","errorTemplate"]),R=lr(hte[r],w),P=R.chart,I=R.container;return(0,re.useImperativeHandle)(t,function(){return P.current}),re.createElement(ot,{errorTemplate:b},m&&re.createElement(Ot,{loadingTemplate:y}),re.createElement("div",zM({className:p,style:l,ref:I},h)))})},78677:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var he,se=1,Se=arguments.length;se<Se;se++){he=arguments[se];for(var oe in he)Object.prototype.hasOwnProperty.call(he,oe)&&(re[oe]=he[oe])}return re},E.apply(this,arguments)},_e=(0,ee.forwardRef)(function(re,he){return ee.createElement(X.P,E({},re,{chartType:"Column",ref:he}))});W.Z=_e},80652:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var he,se=1,Se=arguments.length;se<Se;se++){he=arguments[se];for(var oe in he)Object.prototype.hasOwnProperty.call(he,oe)&&(re[oe]=he[oe])}return re},E.apply(this,arguments)},_e=(0,ee.forwardRef)(function(re,he){return ee.createElement(X.P,E({},re,{chartType:"Line",ref:he}))});W.Z=_e},63430:function($t,W,D){"use strict";var ee=D(67294),X=D(7366),E=function(){return E=Object.assign||function(re){for(var he,se=1,Se=arguments.length;se<Se;se++){he=arguments[se];for(var oe in he)Object.prototype.hasOwnProperty.call(he,oe)&&(re[oe]=he[oe])}return re},E.apply(this,arguments)},_e=(0,ee.forwardRef)(function(re,he){return ee.createElement(X.P,E({},re,{chartType:"Pie",ref:he}))});W.Z=_e},6466:function($t,W,D){"use strict";D.d(W,{Z:function(){return vt}});var ee=D(4942),X=D(1413),E=D(45987),_e=D(28459),re=D(93967),he=D.n(re),se=D(67294),Se=D(53911),oe=D(44962),je=D(98082),te=function(Re){return(0,ee.Z)({},Re.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:Re.marginLG,marginInline:0,color:Re.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function ve(ke){return(0,je.Xj)("ProCardOperation",function(Re){var bt=(0,X.Z)((0,X.Z)({},Re),{},{componentCls:".".concat(ke)});return[te(bt)]})}var Be=D(85893),Te=function(Re){var bt=Re.className,gt=Re.style,Ct=gt===void 0?{}:gt,Sn=Re.children,He=(0,se.useContext)(_e.ZP.ConfigContext),Ot=He.getPrefixCls,Ce=Ot("pro-card-operation"),ot=ve(Ce),$e=ot.wrapSSR,Xe=ot.hashId,Rt=he()(Ce,bt,Xe);return $e((0,Be.jsx)("div",{className:Rt,style:Ct,children:Sn}))},we=Te,le=D(96604),Ze=function(Re){return(0,ee.Z)({},Re.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,ee.Z)({flexDirection:"row"},"".concat(Re.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(Re.colorBorder)}})};function xt(ke){return(0,je.Xj)("StatisticCard",function(Re){var bt=(0,X.Z)((0,X.Z)({},Re),{},{componentCls:".".concat(ke)});return[Ze(bt)]})}var ft=["children","statistic","className","chart","chartPlacement","footer"],Zt=function(Re){var bt=Re.children,gt=Re.statistic,Ct=Re.className,Sn=Re.chart,He=Re.chartPlacement,Ot=Re.footer,Ce=(0,E.Z)(Re,ft),ot=(0,se.useContext)(_e.ZP.ConfigContext),$e=ot.getPrefixCls,Xe=$e("pro-statistic-card"),Rt=xt(Xe),_t=Rt.wrapSSR,Pe=Rt.hashId,Wt=he()(Xe,Ct,Pe),on=gt&&(0,Be.jsx)(le.Z,(0,X.Z)({layout:"vertical"},gt)),Nn=he()("".concat(Xe,"-chart"),Pe,(0,ee.Z)((0,ee.Z)({},"".concat(Xe,"-chart-left"),He==="left"&&Sn&&gt),"".concat(Xe,"-chart-right"),He==="right"&&Sn&&gt)),jn=Sn&&(0,Be.jsx)("div",{className:Nn,children:Sn}),lr=he()("".concat(Xe,"-content "),Pe,(0,ee.Z)({},"".concat(Xe,"-content-horizontal"),He==="left"||He==="right")),Vt=(jn||on)&&(He==="left"?(0,Be.jsxs)("div",{className:lr,children:[jn,on]}):(0,Be.jsxs)("div",{className:lr,children:[on,jn]})),en=Ot&&(0,Be.jsx)("div",{className:"".concat(Xe,"-footer ").concat(Pe).trim(),children:Ot});return _t((0,Be.jsxs)(Se.Z,(0,X.Z)((0,X.Z)({className:Wt},Ce),{},{children:[Vt,bt,en]})))},pt=function(Re){return(0,Be.jsx)(Zt,(0,X.Z)({bodyStyle:{padding:0}},Re))};Zt.Statistic=le.Z,Zt.Divider=oe.Z,Zt.Operation=we,Zt.isProCard=!0,Zt.Group=pt;var vt=Zt},96604:function($t,W,D){"use strict";D.d(W,{Z:function(){return sn}});var ee=D(1413),X=D(4942),E=D(45987),_e=D(87462),re=D(67294),he=D(36688),se=D(55304),Se=function(Dt,Me){return re.createElement(se.Z,(0,_e.Z)({},Dt,{ref:Me,icon:he.Z}))},oe=re.forwardRef(Se),je=oe,te=D(28459),ve=D(83062),Be=D(40411),Te=D(57838),we=D(96159),le=D(93967),Ze=D.n(le),xt=D(64217),ft=D(53124),Zt=D(87564),vt=Ut=>{const{value:Dt,formatter:Me,precision:Qe,decimalSeparator:Ft,groupSeparator:U="",prefixCls:ue}=Ut;let at;if(typeof Me=="function")at=Me(Dt);else{const ce=String(Dt),j=ce.match(/^(-?)(\d*)(\.(\d+))?$/);if(!j||ce==="-")at=ce;else{const ln=j[1];let fn=j[2]||"0",mt=j[4]||"";fn=fn.replace(/\B(?=(\d{3})+(?!\d))/g,U),typeof Qe=="number"&&(mt=mt.padEnd(Qe,"0").slice(0,Qe>0?Qe:0)),mt&&(mt=`${Ft}${mt}`),at=[re.createElement("span",{key:"int",className:`${ue}-content-value-int`},ln,fn),mt&&re.createElement("span",{key:"decimal",className:`${ue}-content-value-decimal`},mt)]}}return re.createElement("span",{className:`${ue}-content-value`},at)},ke=D(14747),Re=D(83559),bt=D(83262);const gt=Ut=>{const{componentCls:Dt,marginXXS:Me,padding:Qe,colorTextDescription:Ft,titleFontSize:U,colorTextHeading:ue,contentFontSize:at,fontFamily:ce}=Ut;return{[`${Dt}`]:Object.assign(Object.assign({},(0,ke.Wf)(Ut)),{[`${Dt}-title`]:{marginBottom:Me,color:Ft,fontSize:U},[`${Dt}-skeleton`]:{paddingTop:Qe},[`${Dt}-content`]:{color:ue,fontSize:at,fontFamily:ce,[`${Dt}-content-value`]:{display:"inline-block",direction:"ltr"},[`${Dt}-content-prefix, ${Dt}-content-suffix`]:{display:"inline-block"},[`${Dt}-content-prefix`]:{marginInlineEnd:Me},[`${Dt}-content-suffix`]:{marginInlineStart:Me}}})}},Ct=Ut=>{const{fontSizeHeading3:Dt,fontSize:Me}=Ut;return{titleFontSize:Me,contentFontSize:Dt}};var Sn=(0,Re.I$)("Statistic",Ut=>{const Dt=(0,bt.mergeToken)(Ut,{});return[gt(Dt)]},Ct),He=function(Ut,Dt){var Me={};for(var Qe in Ut)Object.prototype.hasOwnProperty.call(Ut,Qe)&&Dt.indexOf(Qe)<0&&(Me[Qe]=Ut[Qe]);if(Ut!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ft=0,Qe=Object.getOwnPropertySymbols(Ut);Ft<Qe.length;Ft++)Dt.indexOf(Qe[Ft])<0&&Object.prototype.propertyIsEnumerable.call(Ut,Qe[Ft])&&(Me[Qe[Ft]]=Ut[Qe[Ft]]);return Me},Ce=Ut=>{const{prefixCls:Dt,className:Me,rootClassName:Qe,style:Ft,valueStyle:U,value:ue=0,title:at,valueRender:ce,prefix:j,suffix:ln,loading:fn=!1,formatter:mt,precision:Gt,decimalSeparator:Wn=".",groupSeparator:hn=",",onMouseEnter:ht,onMouseLeave:Ht}=Ut,Cn=He(Ut,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:Ln,direction:Gn,statistic:dt}=re.useContext(ft.E_),ye=Ln("statistic",Dt),[Fe,nt,Pt]=Sn(ye),Mt=re.createElement(vt,{decimalSeparator:Wn,groupSeparator:hn,prefixCls:ye,formatter:mt,precision:Gt,value:ue}),Tn=Ze()(ye,{[`${ye}-rtl`]:Gn==="rtl"},dt==null?void 0:dt.className,Me,Qe,nt,Pt),$n=(0,xt.Z)(Cn,{aria:!0,data:!0});return Fe(re.createElement("div",Object.assign({},$n,{className:Tn,style:Object.assign(Object.assign({},dt==null?void 0:dt.style),Ft),onMouseEnter:ht,onMouseLeave:Ht}),at&&re.createElement("div",{className:`${ye}-title`},at),re.createElement(Zt.Z,{paragraph:!1,loading:fn,className:`${ye}-skeleton`},re.createElement("div",{style:U,className:`${ye}-content`},j&&re.createElement("span",{className:`${ye}-content-prefix`},j),ce?ce(Mt):Mt,ln&&re.createElement("span",{className:`${ye}-content-suffix`},ln)))))};const ot=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function $e(Ut,Dt){let Me=Ut;const Qe=/\[[^\]]*]/g,Ft=(Dt.match(Qe)||[]).map(ce=>ce.slice(1,-1)),U=Dt.replace(Qe,"[]"),ue=ot.reduce((ce,j)=>{let[ln,fn]=j;if(ce.includes(ln)){const mt=Math.floor(Me/fn);return Me-=mt*fn,ce.replace(new RegExp(`${ln}+`,"g"),Gt=>{const Wn=Gt.length;return mt.toString().padStart(Wn,"0")})}return ce},U);let at=0;return ue.replace(Qe,()=>{const ce=Ft[at];return at+=1,ce})}function Xe(Ut,Dt){const{format:Me=""}=Dt,Qe=new Date(Ut).getTime(),Ft=Date.now(),U=Math.max(Qe-Ft,0);return $e(U,Me)}var Rt=function(Ut,Dt){var Me={};for(var Qe in Ut)Object.prototype.hasOwnProperty.call(Ut,Qe)&&Dt.indexOf(Qe)<0&&(Me[Qe]=Ut[Qe]);if(Ut!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ft=0,Qe=Object.getOwnPropertySymbols(Ut);Ft<Qe.length;Ft++)Dt.indexOf(Qe[Ft])<0&&Object.prototype.propertyIsEnumerable.call(Ut,Qe[Ft])&&(Me[Qe[Ft]]=Ut[Qe[Ft]]);return Me};const _t=1e3/30;function Pe(Ut){return new Date(Ut).getTime()}const Wt=Ut=>{const{value:Dt,format:Me="HH:mm:ss",onChange:Qe,onFinish:Ft}=Ut,U=Rt(Ut,["value","format","onChange","onFinish"]),ue=(0,Te.Z)(),at=re.useRef(null),ce=()=>{Ft==null||Ft(),at.current&&(clearInterval(at.current),at.current=null)},j=()=>{const mt=Pe(Dt);mt>=Date.now()&&(at.current=setInterval(()=>{ue(),Qe==null||Qe(mt-Date.now()),mt<Date.now()&&ce()},_t))};re.useEffect(()=>(j(),()=>{at.current&&(clearInterval(at.current),at.current=null)}),[Dt]);const ln=(mt,Gt)=>Xe(mt,Object.assign(Object.assign({},Gt),{format:Me})),fn=mt=>(0,we.Tm)(mt,{title:void 0});return re.createElement(Ce,Object.assign({},U,{value:Dt,valueRender:fn,formatter:ln}))};var on=re.memo(Wt);Ce.Countdown=on;var Nn=Ce,jn=D(98082),lr=function(Dt){return(0,X.Z)({},Dt.componentCls,(0,X.Z)((0,X.Z)((0,X.Z)((0,X.Z)((0,X.Z)({display:"flex",fontSize:Dt.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,X.Z)({display:"flex",width:"100%"},"".concat(Dt.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,X.Z)({width:"100%"},"".concat(Dt.antCls,"-statistic-content"),{"&-value-int":{fontSize:Dt.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat(Dt.antCls,"-statistic-title"),{color:Dt.colorText}),"&-trend-up",(0,X.Z)({},"".concat(Dt.antCls,"-statistic-content"),(0,X.Z)({color:"#f5222d"},"".concat(Dt.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,X.Z)({},"".concat(Dt.antCls,"-statistic-content"),(0,X.Z)({color:"#389e0d"},"".concat(Dt.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,X.Z)((0,X.Z)((0,X.Z)({display:"flex",justifyContent:"space-between"},"".concat(Dt.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(Dt.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(Dt.antCls,"-statistic-title,").concat(Dt.antCls,"-statistic-content,").concat(Dt.antCls,"-statistic-content-suffix,").concat(Dt.antCls,"-statistic-content-prefix,").concat(Dt.antCls,"-statistic-content-value-decimal"),{fontSize:Dt.fontSize})),"& &-layout-inline",(0,X.Z)((0,X.Z)((0,X.Z)({display:"inline-flex",color:Dt.colorTextSecondary},"".concat(Dt.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(Dt.antCls,"-statistic-content"),{color:Dt.colorTextSecondary}),"".concat(Dt.antCls,"-statistic-title,").concat(Dt.antCls,"-statistic-content,").concat(Dt.antCls,"-statistic-content-suffix,").concat(Dt.antCls,"-statistic-content-prefix,").concat(Dt.antCls,"-statistic-content-value-decimal"),{fontSize:Dt.fontSizeSM})))};function Vt(Ut){return(0,jn.Xj)("Statistic",function(Dt){var Me=(0,ee.Z)((0,ee.Z)({},Dt),{},{componentCls:".".concat(Ut)});return[lr(Me)]})}var en=D(85893),xn=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],er=function(Dt){var Me=Dt.className,Qe=Dt.layout,Ft=Qe===void 0?"inline":Qe,U=Dt.style,ue=Dt.description,at=Dt.children,ce=Dt.title,j=Dt.tip,ln=Dt.status,fn=Dt.trend,mt=Dt.prefix,Gt=Dt.icon,Wn=(0,E.Z)(Dt,xn),hn=(0,re.useContext)(te.ZP.ConfigContext),ht=hn.getPrefixCls,Ht=ht("pro-card-statistic"),Cn=Vt(Ht),Ln=Cn.wrapSSR,Gn=Cn.hashId,dt=Ze()(Ht,Me,Gn),ye=Ze()("".concat(Ht,"-status"),Gn),Fe=Ze()("".concat(Ht,"-icon"),Gn),nt=Ze()("".concat(Ht,"-wrapper"),Gn),Pt=Ze()("".concat(Ht,"-content"),Gn),Mt=Ze()(Gn,(0,X.Z)((0,X.Z)({},"".concat(Ht,"-layout-").concat(Ft),Ft),"".concat(Ht,"-trend-").concat(fn),fn)),Tn=j&&(0,en.jsx)(ve.Z,{title:j,children:(0,en.jsx)(je,{className:"".concat(Ht,"-tip ").concat(Gn).trim()})}),$n=Ze()("".concat(Ht,"-trend-icon"),Gn,(0,X.Z)({},"".concat(Ht,"-trend-icon-").concat(fn),fn)),xr=fn&&(0,en.jsx)("div",{className:$n}),qn=ln&&(0,en.jsx)("div",{className:ye,children:(0,en.jsx)(Be.Z,{status:ln,text:null})}),Ae=Gt&&(0,en.jsx)("div",{className:Fe,children:Gt});return Ln((0,en.jsxs)("div",{className:dt,style:U,children:[Ae,(0,en.jsxs)("div",{className:nt,children:[qn,(0,en.jsxs)("div",{className:Pt,children:[(0,en.jsx)(Nn,(0,ee.Z)({title:(ce||Tn)&&(0,en.jsxs)(en.Fragment,{children:[ce,Tn]}),prefix:(xr||mt)&&(0,en.jsxs)(en.Fragment,{children:[xr,mt]}),className:Mt},Wn)),ue&&(0,en.jsx)("div",{className:"".concat(Ht,"-description ").concat(Gn).trim(),children:ue})]})]})]}))},sn=er},46343:function($t,W,D){"use strict";D.d(W,{S$:function(){return Ut},bf:function(){return Dt},ni:function(){return Wt},oI:function(){return er},sX:function(){return sn}});var ee=D(34155);function X(Me,Qe,Ft,U){function ue(at){return at instanceof Ft?at:new Ft(function(ce){ce(at)})}return new(Ft||(Ft=Promise))(function(at,ce){function j(mt){try{fn(U.next(mt))}catch(Gt){ce(Gt)}}function ln(mt){try{fn(U.throw(mt))}catch(Gt){ce(Gt)}}function fn(mt){mt.done?at(mt.value):ue(mt.value).then(j,ln)}fn((U=U.apply(Me,Qe||[])).next())})}function E(Me,Qe){var Ft={label:0,sent:function(){if(at[0]&1)throw at[1];return at[1]},trys:[],ops:[]},U,ue,at,ce;return ce={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(ce[Symbol.iterator]=function(){return this}),ce;function j(fn){return function(mt){return ln([fn,mt])}}function ln(fn){if(U)throw new TypeError("Generator is already executing.");for(;Ft;)try{if(U=1,ue&&(at=fn[0]&2?ue.return:fn[0]?ue.throw||((at=ue.return)&&at.call(ue),0):ue.next)&&!(at=at.call(ue,fn[1])).done)return at;switch(ue=0,at&&(fn=[fn[0]&2,at.value]),fn[0]){case 0:case 1:at=fn;break;case 4:return Ft.label++,{value:fn[1],done:!1};case 5:Ft.label++,ue=fn[1],fn=[0];continue;case 7:fn=Ft.ops.pop(),Ft.trys.pop();continue;default:if(at=Ft.trys,!(at=at.length>0&&at[at.length-1])&&(fn[0]===6||fn[0]===2)){Ft=0;continue}if(fn[0]===3&&(!at||fn[1]>at[0]&&fn[1]<at[3])){Ft.label=fn[1];break}if(fn[0]===6&&Ft.label<at[1]){Ft.label=at[1],at=fn;break}if(at&&Ft.label<at[2]){Ft.label=at[2],Ft.ops.push(fn);break}at[2]&&Ft.ops.pop(),Ft.trys.pop();continue}fn=Qe.call(Me,Ft)}catch(mt){fn=[6,mt],ue=0}finally{U=at=0}if(fn[0]&5)throw fn[1];return{value:fn[0]?fn[1]:void 0,done:!0}}}function _e(Me,Qe){var Ft=typeof Symbol=="function"&&Me[Symbol.iterator];if(!Ft)return Me;var U=Ft.call(Me),ue,at=[],ce;try{for(;(Qe===void 0||Qe-- >0)&&!(ue=U.next()).done;)at.push(ue.value)}catch(j){ce={error:j}}finally{try{ue&&!ue.done&&(Ft=U.return)&&Ft.call(U)}finally{if(ce)throw ce.error}}return at}function re(Me,Qe,Ft){if(Ft||arguments.length===2)for(var U=0,ue=Qe.length,at;U<ue;U++)(at||!(U in Qe))&&(at||(at=Array.prototype.slice.call(Qe,0,U)),at[U]=Qe[U]);return Me.concat(at||Array.prototype.slice.call(Qe))}function he(Me){return Me&&Me.__esModule&&Object.prototype.hasOwnProperty.call(Me,"default")?Me.default:Me}var se={exports:{}},Se={exports:{}},oe={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=Ft;function Ft(U){return U&&typeof U.length=="number"&&U.length>=0&&U.length%1===0}Me.exports=Qe.default})(oe,oe.exports);var je={},te={exports:{}},ve={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=function(Ft){return function(){for(var U=[],ue=arguments.length;ue--;)U[ue]=arguments[ue];var at=U.pop();return Ft.call(this,U,at)}},Me.exports=Qe.default})(ve,ve.exports);var Be={};Object.defineProperty(Be,"__esModule",{value:!0}),Be.fallback=Ze,Be.wrap=xt;var Te=Be.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,we=Be.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,le=Be.hasNextTick=typeof ee=="object"&&typeof ee.nextTick=="function";function Ze(Me){setTimeout(Me,0)}function xt(Me){return function(Qe){for(var Ft=[],U=arguments.length-1;U-- >0;)Ft[U]=arguments[U+1];return Me(function(){return Qe.apply(void 0,Ft)})}}var ft;Te?ft=queueMicrotask:we?ft=setImmediate:le?ft=ee.nextTick:ft=Ze,Be.default=xt(ft),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=ln;var Ft=ve.exports,U=j(Ft),ue=Be,at=j(ue),ce=je;function j(Gt){return Gt&&Gt.__esModule?Gt:{default:Gt}}function ln(Gt){return(0,ce.isAsync)(Gt)?function(){for(var Wn=[],hn=arguments.length;hn--;)Wn[hn]=arguments[hn];var ht=Wn.pop(),Ht=Gt.apply(this,Wn);return fn(Ht,ht)}:(0,U.default)(function(Wn,hn){var ht;try{ht=Gt.apply(this,Wn)}catch(Ht){return hn(Ht)}if(ht&&typeof ht.then=="function")return fn(ht,hn);hn(null,ht)})}function fn(Gt,Wn){return Gt.then(function(hn){mt(Wn,null,hn)},function(hn){mt(Wn,hn&&hn.message?hn:new Error(hn))})}function mt(Gt,Wn,hn){try{Gt(Wn,hn)}catch(ht){(0,at.default)(function(Ht){throw Ht},ht)}}Me.exports=Qe.default}(te,te.exports),Object.defineProperty(je,"__esModule",{value:!0}),je.isAsyncIterable=je.isAsyncGenerator=je.isAsync=void 0;var Zt=te.exports,pt=vt(Zt);function vt(Me){return Me&&Me.__esModule?Me:{default:Me}}function ke(Me){return Me[Symbol.toStringTag]==="AsyncFunction"}function Re(Me){return Me[Symbol.toStringTag]==="AsyncGenerator"}function bt(Me){return typeof Me[Symbol.asyncIterator]=="function"}function gt(Me){if(typeof Me!="function")throw new Error("expected a function");return ke(Me)?(0,pt.default)(Me):Me}je.default=gt,je.isAsync=ke,je.isAsyncGenerator=Re,je.isAsyncIterable=bt;var Ct={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=Ft;function Ft(U,ue){if(ue===void 0&&(ue=U.length),!ue)throw new Error("arity is undefined");function at(){for(var ce=this,j=[],ln=arguments.length;ln--;)j[ln]=arguments[ln];return typeof j[ue-1]=="function"?U.apply(this,j):new Promise(function(fn,mt){j[ue-1]=function(Gt){for(var Wn=[],hn=arguments.length-1;hn-- >0;)Wn[hn]=arguments[hn+1];if(Gt)return mt(Gt);fn(Wn.length>1?Wn:Wn[0])},U.apply(ce,j)})}return at}Me.exports=Qe.default})(Ct,Ct.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft=oe.exports,U=ln(Ft),ue=je,at=ln(ue),ce=Ct.exports,j=ln(ce);function ln(fn){return fn&&fn.__esModule?fn:{default:fn}}Qe.default=(0,j.default)(function(fn,mt,Gt){var Wn=(0,U.default)(mt)?[]:{};fn(mt,function(hn,ht,Ht){(0,at.default)(hn)(function(Cn){for(var Ln,Gn=[],dt=arguments.length-1;dt-- >0;)Gn[dt]=arguments[dt+1];Gn.length<2&&(Ln=Gn,Gn=Ln[0]),Wn[ht]=Gn,Ht(Cn)})},function(hn){return Gt(hn,Wn)})},3),Me.exports=Qe.default}(Se,Se.exports);var Sn={exports:{}},He={exports:{}},Ot={exports:{}},Ce={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=Ft;function Ft(U){function ue(){for(var at=[],ce=arguments.length;ce--;)at[ce]=arguments[ce];if(U!==null){var j=U;U=null,j.apply(this,at)}}return Object.assign(ue,U),ue}Me.exports=Qe.default})(Ce,Ce.exports);var ot={exports:{}},$e={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=function(Ft){return Ft[Symbol.iterator]&&Ft[Symbol.iterator]()},Me.exports=Qe.default})($e,$e.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=mt;var Ft=oe.exports,U=ce(Ft),ue=$e.exports,at=ce(ue);function ce(Gt){return Gt&&Gt.__esModule?Gt:{default:Gt}}function j(Gt){var Wn=-1,hn=Gt.length;return function(){return++Wn<hn?{value:Gt[Wn],key:Wn}:null}}function ln(Gt){var Wn=-1;return function(){var ht=Gt.next();return ht.done?null:(Wn++,{value:ht.value,key:Wn})}}function fn(Gt){var Wn=Gt?Object.keys(Gt):[],hn=-1,ht=Wn.length;return function Ht(){var Cn=Wn[++hn];return Cn==="__proto__"?Ht():hn<ht?{value:Gt[Cn],key:Cn}:null}}function mt(Gt){if((0,U.default)(Gt))return j(Gt);var Wn=(0,at.default)(Gt);return Wn?ln(Wn):fn(Gt)}Me.exports=Qe.default}(ot,ot.exports);var Xe={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=Ft;function Ft(U){return function(){for(var ue=[],at=arguments.length;at--;)ue[at]=arguments[at];if(U===null)throw new Error("Callback was already called.");var ce=U;U=null,ce.apply(this,ue)}}Me.exports=Qe.default})(Xe,Xe.exports);var Rt={exports:{}},_t={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft={};Qe.default=Ft,Me.exports=Qe.default})(_t,_t.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=at;var Ft=_t.exports,U=ue(Ft);function ue(ce){return ce&&ce.__esModule?ce:{default:ce}}function at(ce,j,ln,fn){var mt=!1,Gt=!1,Wn=!1,hn=0,ht=0;function Ht(){hn>=j||Wn||mt||(Wn=!0,ce.next().then(function(Gn){var dt=Gn.value,ye=Gn.done;if(!(Gt||mt)){if(Wn=!1,ye){mt=!0,hn<=0&&fn(null);return}hn++,ln(dt,ht,Cn),ht++,Ht()}}).catch(Ln))}function Cn(Gn,dt){if(hn-=1,!Gt){if(Gn)return Ln(Gn);if(Gn===!1){mt=!0,Gt=!0;return}if(dt===U.default||mt&&hn<=0)return mt=!0,fn(null);Ht()}}function Ln(Gn){Gt||(Wn=!1,mt=!0,fn(Gn))}Ht()}Me.exports=Qe.default}(Rt,Rt.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft=Ce.exports,U=hn(Ft),ue=ot.exports,at=hn(ue),ce=Xe.exports,j=hn(ce),ln=je,fn=Rt.exports,mt=hn(fn),Gt=_t.exports,Wn=hn(Gt);function hn(ht){return ht&&ht.__esModule?ht:{default:ht}}Qe.default=function(ht){return function(Ht,Cn,Ln){if(Ln=(0,U.default)(Ln),ht<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Ht)return Ln(null);if((0,ln.isAsyncGenerator)(Ht))return(0,mt.default)(Ht,ht,Cn,Ln);if((0,ln.isAsyncIterable)(Ht))return(0,mt.default)(Ht[Symbol.asyncIterator](),ht,Cn,Ln);var Gn=(0,at.default)(Ht),dt=!1,ye=!1,Fe=0,nt=!1;function Pt(Tn,$n){if(!ye)if(Fe-=1,Tn)dt=!0,Ln(Tn);else if(Tn===!1)dt=!0,ye=!0;else{if($n===Wn.default||dt&&Fe<=0)return dt=!0,Ln(null);nt||Mt()}}function Mt(){for(nt=!0;Fe<ht&&!dt;){var Tn=Gn();if(Tn===null){dt=!0,Fe<=0&&Ln(null);return}Fe+=1,Cn(Tn.value,Tn.key,(0,j.default)(Pt))}nt=!1}Mt()}},Me.exports=Qe.default}(Ot,Ot.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft=Ot.exports,U=ln(Ft),ue=je,at=ln(ue),ce=Ct.exports,j=ln(ce);function ln(mt){return mt&&mt.__esModule?mt:{default:mt}}function fn(mt,Gt,Wn,hn){return(0,U.default)(Gt)(mt,(0,at.default)(Wn),hn)}Qe.default=(0,j.default)(fn,4),Me.exports=Qe.default}(He,He.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft=He.exports,U=ce(Ft),ue=Ct.exports,at=ce(ue);function ce(ln){return ln&&ln.__esModule?ln:{default:ln}}function j(ln,fn,mt){return(0,U.default)(ln,1,fn,mt)}Qe.default=(0,at.default)(j,3),Me.exports=Qe.default}(Sn,Sn.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=j;var Ft=Se.exports,U=ce(Ft),ue=Sn.exports,at=ce(ue);function ce(ln){return ln&&ln.__esModule?ln:{default:ln}}function j(ln,fn){return(0,U.default)(at.default,ln,fn)}Me.exports=Qe.default}(se,se.exports);var Pe=he(se.exports),Wt=function(){function Me(){this.args=[],this.tasks=[]}return Me.prototype.call=function(){for(var Qe=arguments,Ft=[],U=0;U<arguments.length;U++)Ft[U]=Qe[U];return this.args=Ft,Pe(this.tasks)},Me.prototype.tap=function(Qe,Ft){var U=this;this.tasks.push(function(ue){Ft.apply(void 0,re([],_e(U.args),!1)),ue(null,Qe)})},Me}(),on={exports:{}},Nn={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft=oe.exports,U=Cn(Ft),ue=_t.exports,at=Cn(ue),ce=He.exports,j=Cn(ce),ln=Ce.exports,fn=Cn(ln),mt=Xe.exports,Gt=Cn(mt),Wn=je,hn=Cn(Wn),ht=Ct.exports,Ht=Cn(ht);function Cn(ye){return ye&&ye.__esModule?ye:{default:ye}}function Ln(ye,Fe,nt){nt=(0,fn.default)(nt);var Pt=0,Mt=0,Tn=ye.length,$n=!1;Tn===0&&nt(null);function xr(qn,Ae){qn===!1&&($n=!0),$n!==!0&&(qn?nt(qn):(++Mt===Tn||Ae===at.default)&&nt(null))}for(;Pt<Tn;Pt++)Fe(ye[Pt],Pt,(0,Gt.default)(xr))}function Gn(ye,Fe,nt){return(0,j.default)(ye,1/0,Fe,nt)}function dt(ye,Fe,nt){var Pt=(0,U.default)(ye)?Ln:Gn;return Pt(ye,(0,hn.default)(Fe),nt)}Qe.default=(0,Ht.default)(dt,3),Me.exports=Qe.default})(Nn,Nn.exports),function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=j;var Ft=Nn.exports,U=ce(Ft),ue=Se.exports,at=ce(ue);function ce(ln){return ln&&ln.__esModule?ln:{default:ln}}function j(ln,fn){return(0,at.default)(U.default,ln,fn)}Me.exports=Qe.default}(on,on.exports);var jn=he(on.exports),lr=function(){function Me(){this.tasks=[]}return Me.prototype.promise=function(){return jn(this.tasks)},Me.prototype.tapPromise=function(Qe,Ft){var U=this;this.tasks.push(function(ue){return X(U,void 0,void 0,function(){return E(this,function(at){switch(at.label){case 0:return[4,Ft()];case 1:return at.sent(),ue(null,Qe),[2]}})})})},Me}(),Vt={exports:{}};(function(Me,Qe){Object.defineProperty(Qe,"__esModule",{value:!0});var Ft=Ce.exports,U=mt(Ft),ue=Xe.exports,at=mt(ue),ce=je,j=mt(ce),ln=Ct.exports,fn=mt(ln);function mt(Wn){return Wn&&Wn.__esModule?Wn:{default:Wn}}function Gt(Wn,hn){if(hn=(0,U.default)(hn),!Array.isArray(Wn))return hn(new Error("First argument to waterfall must be an array of functions"));if(!Wn.length)return hn();var ht=0;function Ht(Ln){var Gn=(0,j.default)(Wn[ht++]);Gn.apply(void 0,Ln.concat([(0,at.default)(Cn)]))}function Cn(Ln){for(var Gn=[],dt=arguments.length-1;dt-- >0;)Gn[dt]=arguments[dt+1];if(Ln!==!1){if(Ln||ht===Wn.length)return hn.apply(void 0,[Ln].concat(Gn));Ht(Gn)}}Ht([])}Qe.default=(0,fn.default)(Gt),Me.exports=Qe.default})(Vt,Vt.exports);var en=he(Vt.exports),xn=function(){function Me(){this.tasks=[]}return Me.prototype.call=function(){return en(this.tasks)},Me.prototype.tap=function(Qe,Ft){this.tasks.length===0?this.tasks.push(function(U){var ue=Ft();U(ue?null:!1,ue)}):this.tasks.push(function(U,ue){var at=Ft.apply(void 0,re([],_e(U),!1));ue(at?null:!1,Qe)})},Me}(),er=function(){function Me(){this.tasks=[]}return Me.prototype.call=function(){return Pe(this.tasks)},Me.prototype.tap=function(Qe,Ft){this.tasks.push(function(U){var ue=Ft();U(ue,Qe)})},Me}(),sn=function(){function Me(){this.args=[],this.tasks=[]}return Me.prototype.promise=function(){for(var Qe=arguments,Ft=[],U=0;U<arguments.length;U++)Ft[U]=Qe[U];return this.args=Ft,Pe(this.tasks)},Me.prototype.tapPromise=function(Qe,Ft){var U=this;this.tasks.push(function(ue){return X(U,void 0,void 0,function(){return E(this,function(at){switch(at.label){case 0:return[4,Ft.apply(void 0,re([],_e(this.args),!1))];case 1:return at.sent(),ue(null,Qe),[2]}})})})},Me}(),Ut=function(){function Me(){this.args=[],this.tasks=[]}return Me.prototype.promise=function(){for(var Qe=arguments,Ft=[],U=0;U<arguments.length;U++)Ft[U]=Qe[U];return this.args=Ft,Pe(this.tasks)},Me.prototype.tapPromise=function(Qe,Ft){var U=this;this.tasks.push(function(ue){return X(U,void 0,void 0,function(){var at;return E(this,function(ce){switch(ce.label){case 0:return[4,Ft.apply(void 0,re([],_e(this.args),!1))];case 1:return at=ce.sent(),ue(at,Qe),[2]}})})})},Me}(),Dt=function(){function Me(){this.tasks=[]}return Me.prototype.promise=function(){return en(this.tasks)},Me.prototype.tapPromise=function(Qe,Ft){this.tasks.length===0?this.tasks.push(function(U){Ft().then(function(ue){U(null,ue)})}):this.tasks.push(function(U,ue){Ft(U).then(function(at){ue(null,at)})})},Me}()},17816:function($t,W){(function(D,ee){ee(W)})(this,function(D){"use strict";function ee(De){var Je=typeof Symbol=="function"&&Symbol.iterator,kt=Je&&De[Je],un=0;if(kt)return kt.call(De);if(De&&typeof De.length=="number")return{next:function(){return{value:(De=De&&un>=De.length?void 0:De)&&De[un++],done:!De}}};throw new TypeError(Je?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(De,Je){var kt=typeof Symbol=="function"&&De[Symbol.iterator];if(!kt)return De;var un,Bn,kn=kt.call(De),pn=[];try{for(;(Je===void 0||0<Je--)&&!(un=kn.next()).done;)pn.push(un.value)}catch(On){Bn={error:On}}finally{try{un&&!un.done&&(kt=kn.return)&&kt.call(kn)}finally{if(Bn)throw Bn.error}}return pn}function E(De,Je,kt){if(kt||arguments.length===2)for(var un,Bn=0,kn=Je.length;Bn<kn;Bn++)!un&&Bn in Je||((un=un||Array.prototype.slice.call(Je,0,Bn))[Bn]=Je[Bn]);return De.concat(un||Array.prototype.slice.call(Je))}function _e(De){return he(De,"Function")}var re={}.toString,he=function(De,Je){return re.call(De)==="[object "+Je+"]"},se=function(De){return Array.isArray?Array.isArray(De):he(De,"Array")},Se=function(De){if(typeof(Je=De)!="object"||Je===null||!he(De,"Object"))return!1;var Je;if(Object.getPrototypeOf(De)===null)return!0;for(var kt=De;Object.getPrototypeOf(kt)!==null;)kt=Object.getPrototypeOf(kt);return Object.getPrototypeOf(De)===kt},oe=function(De){return he(De,"Number")},je=Object.values?function(De){return Object.values(De)}:function(De){var Je,kt=[],un=De,Bn=function(vr,fr){_e(De)&&fr==="prototype"||kt.push(vr)};if(un){if(se(un))for(var kn=0,pn=un.length;kn<pn&&Bn(un[kn],kn)!==!1;kn++);else if(Je=typeof un,un!==null&&Je=="object"||Je=="function"){for(var On in un)if(un.hasOwnProperty(On)&&Bn(un[On],On)===!1)break}}return kt},te=5;function ve(De){for(var Je=[],kt=1;kt<arguments.length;kt++)Je[kt-1]=arguments[kt];for(var un=0;un<Je.length;un+=1)(function Bn(kn,pn,On,vr){for(var fr in On=On||0,vr=vr||te,pn){var ci;pn.hasOwnProperty(fr)&&((ci=pn[fr])!==null&&Se(ci)?(Se(kn[fr])||(kn[fr]={}),On<vr?Bn(kn[fr],ci,On+1,vr):kn[fr]=pn[fr]):se(ci)?(kn[fr]=[],kn[fr]=kn[fr].concat(ci)):ci!==void 0&&(kn[fr]=ci))}})(De,Je[un]);return De}function Be(De){return De}(function(De,Je){var kt;if(_e(De))return(kt=function(){for(var un=[],Bn=0;Bn<arguments.length;Bn++)un[Bn]=arguments[Bn];var kn,pn=Je?Je.apply(this,un):un[0],On=kt.cache;return On.has(pn)?On.get(pn):(kn=De.apply(this,un),On.set(pn,kn),kn)}).cache=new Map;throw new TypeError("Expected a function")})(function(De,pn){var kt=(pn=pn===void 0?{}:pn).fontSize,un=pn.fontFamily,Bn=pn.fontWeight,kn=pn.fontStyle,pn=pn.fontVariant;return(Te=Te||document.createElement("canvas").getContext("2d")).font=[kn,pn,Bn,kt+"px",un].join(" "),Te.measureText(he(De,"String")?De:"").width},function(De,Je){return function(){for(var kt=0,un=0,Bn=arguments.length;un<Bn;un++)kt+=arguments[un].length;for(var kn=Array(kt),pn=0,un=0;un<Bn;un++)for(var On=arguments[un],vr=0,fr=On.length;vr<fr;vr++,pn++)kn[pn]=On[vr];return kn}([De],je(Je=Je===void 0?{}:Je)).join("")});var Te,we=typeof Float32Array!="undefined"?Float32Array:Array;function le(){var De=new we(9);return we!=Float32Array&&(De[1]=0,De[2]=0,De[3]=0,De[5]=0,De[6]=0,De[7]=0),De[0]=1,De[4]=1,De[8]=1,De}Math.hypot||(Math.hypot=function(){for(var De=0,Je=arguments.length;Je--;)De+=arguments[Je]*arguments[Je];return Math.sqrt(De)});var Ze=function(De,Gi,xi){var un=Gi[0],Bn=Gi[1],kn=Gi[2],pn=Gi[3],On=Gi[4],vr=Gi[5],fr=Gi[6],ci=Gi[7],Gi=Gi[8],no=xi[0],Jr=xi[1],ji=xi[2],Di=xi[3],Gr=xi[4],fo=xi[5],Ri=xi[6],bo=xi[7],xi=xi[8];return De[0]=no*un+Jr*pn+ji*fr,De[1]=no*Bn+Jr*On+ji*ci,De[2]=no*kn+Jr*vr+ji*Gi,De[3]=Di*un+Gr*pn+fo*fr,De[4]=Di*Bn+Gr*On+fo*ci,De[5]=Di*kn+Gr*vr+fo*Gi,De[6]=Ri*un+bo*pn+xi*fr,De[7]=Ri*Bn+bo*On+xi*ci,De[8]=Ri*kn+bo*vr+xi*Gi,De};function xt(){var De=new we(16);return we!=Float32Array&&(De[1]=0,De[2]=0,De[3]=0,De[4]=0,De[6]=0,De[7]=0,De[8]=0,De[9]=0,De[11]=0,De[12]=0,De[13]=0,De[14]=0),De[0]=1,De[5]=1,De[10]=1,De[15]=1,De}var ft=function(De,Ri,kt){var un=Ri[0],Bn=Ri[1],kn=Ri[2],pn=Ri[3],On=Ri[4],vr=Ri[5],fr=Ri[6],ci=Ri[7],Gi=Ri[8],no=Ri[9],Jr=Ri[10],ji=Ri[11],Di=Ri[12],Gr=Ri[13],fo=Ri[14],Ri=Ri[15],bo=kt[0],xi=kt[1],wo=kt[2],ia=kt[3];return De[0]=bo*un+xi*On+wo*Gi+ia*Di,De[1]=bo*Bn+xi*vr+wo*no+ia*Gr,De[2]=bo*kn+xi*fr+wo*Jr+ia*fo,De[3]=bo*pn+xi*ci+wo*ji+ia*Ri,bo=kt[4],xi=kt[5],wo=kt[6],ia=kt[7],De[4]=bo*un+xi*On+wo*Gi+ia*Di,De[5]=bo*Bn+xi*vr+wo*no+ia*Gr,De[6]=bo*kn+xi*fr+wo*Jr+ia*fo,De[7]=bo*pn+xi*ci+wo*ji+ia*Ri,bo=kt[8],xi=kt[9],wo=kt[10],ia=kt[11],De[8]=bo*un+xi*On+wo*Gi+ia*Di,De[9]=bo*Bn+xi*vr+wo*no+ia*Gr,De[10]=bo*kn+xi*fr+wo*Jr+ia*fo,De[11]=bo*pn+xi*ci+wo*ji+ia*Ri,bo=kt[12],xi=kt[13],wo=kt[14],ia=kt[15],De[12]=bo*un+xi*On+wo*Gi+ia*Di,De[13]=bo*Bn+xi*vr+wo*no+ia*Gr,De[14]=bo*kn+xi*fr+wo*Jr+ia*fo,De[15]=bo*pn+xi*ci+wo*ji+ia*Ri,De};function Zt(De){for(var Je=[],kt=1;kt<arguments.length;kt++)Je[kt-1]=arguments[kt];return De?Je.reduce(function(un,Bn){return function(kn){return Bn(un(kn))}},De):Be}function pt(De){return De instanceof Float32Array||De instanceof Array}function vt(De,Je,kt){for(;De<Je;)De+=2*Math.PI;for(;kt<De;)De-=2*Math.PI;return De}nt=new we(3),we!=Float32Array&&(nt[0]=0,nt[1]=0,nt[2]=0),nt=new we(4),we!=Float32Array&&(nt[0]=0,nt[1]=0,nt[2]=0,nt[3]=0);function ke(pn,Je,kt,un,Bn){var kn=(pn=X(pn,2))[0],pn=pn[1],On=le();return kn=[kn,pn],(pn=On)[0]=1,pn[1]=0,pn[2]=0,pn[3]=0,pn[4]=1,pn[5]=0,pn[6]=kn[0],pn[7]=kn[1],pn[8]=1,pn}function Re(De,...Je){return Je.reduce((kt,un)=>Bn=>kt(un(Bn)),De)}function bt(De,Je){return Je-De?kt=>(kt-De)/(Je-De):kt=>.5}const gt=Math.sqrt(50),Ct=Math.sqrt(10),Sn=Math.sqrt(2);function He(De,Je,kt){return Je=(Je-De)/Math.max(0,kt),De=Math.floor(Math.log(Je)/Math.LN10),kt=Je/vf(10,De),0<=De?(kt>=gt?10:kt>=Ct?5:kt>=Sn?2:1)*vf(10,De):-vf(10,-De)/(kt>=gt?10:kt>=Ct?5:kt>=Sn?2:1)}const Ot=(De,Je,kt=5)=>{De=[De,Je];let un=0,Bn=De.length-1,kn=De[un],pn=De[Bn],On;return pn<kn&&([kn,pn]=[pn,kn],[un,Bn]=[Bn,un]),0<(On=He(kn,pn,kt))?(kn=Math.floor(kn/On)*On,pn=Math.ceil(pn/On)*On,On=He(kn,pn,kt)):On<0&&(kn=Math.ceil(kn*On)/On,pn=Math.floor(pn*On)/On,On=He(kn,pn,kt)),0<On?(De[un]=Math.floor(kn/On)*On,De[Bn]=Math.ceil(pn/On)*On):On<0&&(De[un]=Math.ceil(kn*On)/On,De[Bn]=Math.floor(pn*On)/On),De};function Ce(De){return De!=null&&!Number.isNaN(De)}function ot(De,Je){return kt=>{kt.prototype.rescale=function(){this.initRange(),this.nice();var[un]=this.chooseTransforms();this.composeOutput(un,this.chooseClamp(un))},kt.prototype.initRange=function(){var un=this.options.interpolator;this.options.range=De(un)},kt.prototype.composeOutput=function(un,Bn){var kn,{domain:On,interpolator:pn,round:vr}=this.getOptions(),On=Je(On.map(un)),vr=vr?(kn=pn,fr=>(fr=kn(fr),oe(fr)?Math.round(fr):fr)):pn;this.output=Re(vr,On,Bn,un)},kt.prototype.invert=void 0}}var $e,nt={exports:{}},Fe={exports:{}},Xe=function(De){return!(!De||typeof De=="string")&&(De instanceof Array||Array.isArray(De)||0<=De.length&&(De.splice instanceof Function||Object.getOwnPropertyDescriptor(De,De.length-1)&&De.constructor.name!=="String"))},Rt=Array.prototype.concat,_t=Array.prototype.slice,Pe=Fe.exports=function(De){for(var Je=[],kt=0,un=De.length;kt<un;kt++){var Bn=De[kt];Xe(Bn)?Je=Rt.call(Je,_t.call(Bn)):Je.push(Bn)}return Je},Wt=(Pe.wrap=function(De){return function(){return De(Pe(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),on=Fe.exports,Nn=Object.hasOwnProperty,jn=Object.create(null);for($e in Wt)Nn.call(Wt,$e)&&(jn[Wt[$e]]=$e);var lr=nt.exports={to:{},get:{}};function Vt(De,Je,kt){return Math.min(Math.max(Je,De),kt)}function en(De){return De=Math.round(De).toString(16).toUpperCase(),De.length<2?"0"+De:De}lr.get=function(De){var Je,kt;switch(De.substring(0,3).toLowerCase()){case"hsl":Je=lr.get.hsl(De),kt="hsl";break;case"hwb":Je=lr.get.hwb(De),kt="hwb";break;default:Je=lr.get.rgb(De),kt="rgb"}return Je?{model:kt,value:Je}:null},lr.get.rgb=function(De){if(!De)return null;var Je,kt,un,Bn=[0,0,0,1];if(Je=De.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(un=Je[2],Je=Je[1],kt=0;kt<3;kt++){var kn=2*kt;Bn[kt]=parseInt(Je.slice(kn,2+kn),16)}un&&(Bn[3]=parseInt(un,16)/255)}else if(Je=De.match(/^#([a-f0-9]{3,4})$/i)){for(un=(Je=Je[1])[3],kt=0;kt<3;kt++)Bn[kt]=parseInt(Je[kt]+Je[kt],16);un&&(Bn[3]=parseInt(un+un,16)/255)}else{if(Je=De.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/))for(kt=0;kt<3;kt++)Bn[kt]=parseInt(Je[kt+1],0);else{if(!(Je=De.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(Je=De.match(/^(\w+)$/))?Je[1]==="transparent"?[0,0,0,0]:Nn.call(Wt,Je[1])?((Bn=Wt[Je[1]])[3]=1,Bn):null:null;for(kt=0;kt<3;kt++)Bn[kt]=Math.round(2.55*parseFloat(Je[kt+1]))}Je[4]&&(Je[5]?Bn[3]=.01*parseFloat(Je[4]):Bn[3]=parseFloat(Je[4]))}for(kt=0;kt<3;kt++)Bn[kt]=Vt(Bn[kt],0,255);return Bn[3]=Vt(Bn[3],0,1),Bn},lr.get.hsl=function(De){var Je;return(De=De&&De.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(Je=parseFloat(De[4]),[(parseFloat(De[1])%360+360)%360,Vt(parseFloat(De[2]),0,100),Vt(parseFloat(De[3]),0,100),Vt(isNaN(Je)?1:Je,0,1)]):null},lr.get.hwb=function(De){var Je;return(De=De&&De.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/))?(Je=parseFloat(De[4]),[(parseFloat(De[1])%360+360)%360,Vt(parseFloat(De[2]),0,100),Vt(parseFloat(De[3]),0,100),Vt(isNaN(Je)?1:Je,0,1)]):null},lr.to.hex=function(){var De=on(arguments);return"#"+en(De[0])+en(De[1])+en(De[2])+(De[3]<1?en(Math.round(255*De[3])):"")},lr.to.rgb=function(){var De=on(arguments);return De.length<4||De[3]===1?"rgb("+Math.round(De[0])+", "+Math.round(De[1])+", "+Math.round(De[2])+")":"rgba("+Math.round(De[0])+", "+Math.round(De[1])+", "+Math.round(De[2])+", "+De[3]+")"},lr.to.rgb.percent=function(){var De=on(arguments),Je=Math.round(De[0]/255*100),kt=Math.round(De[1]/255*100),un=Math.round(De[2]/255*100);return De.length<4||De[3]===1?"rgb("+Je+"%, "+kt+"%, "+un+"%)":"rgba("+Je+"%, "+kt+"%, "+un+"%, "+De[3]+")"},lr.to.hsl=function(){var De=on(arguments);return De.length<4||De[3]===1?"hsl("+De[0]+", "+De[1]+"%, "+De[2]+"%)":"hsla("+De[0]+", "+De[1]+"%, "+De[2]+"%, "+De[3]+")"},lr.to.hwb=function(){var De=on(arguments),Je="";return 4<=De.length&&De[3]!==1&&(Je=", "+De[3]),"hwb("+De[0]+", "+De[1]+"%, "+De[2]+"%"+Je+")"},lr.to.keyword=function(De){return jn[De.slice(0,3)]};var xn=nt.exports;function er(De,Je,kt){let un=kt;return un<0&&(un+=1),1<un&&--un,un<1/6?De+6*(Je-De)*un:un<.5?Je:un<2/3?De+(Je-De)*(2/3-un)*6:De}function sn(Bn){var Je,kt,un,Bn=xn.get(Bn);return Bn?({model:Bn,value:Je}=Bn,Bn==="rgb"?Je:Bn==="hsl"?(Je=(Bn=Je)[0]/360,kt=Bn[1]/100,un=Bn[2]/100,Bn=Bn[3],kt==0?[255*un,255*un,255*un,Bn]:[255*er(kt=2*un-(un=un<.5?un*(1+kt):un+kt-un*kt),un,Je+1/3),255*er(kt,un,Je),255*er(kt,un,Je-1/3),Bn]):null):null}const Ut=(De,Je)=>kt=>De*(1-kt)+Je*kt,Dt=(De,Je)=>{if(typeof De=="number"&&typeof Je=="number")return Ut(De,Je);if(typeof De!="string"||typeof Je!="string")return()=>De;{var kt=De,un=Je;const Bn=sn(kt),kn=sn(un);return Bn===null||kn===null?Bn?()=>kt:()=>un:pn=>{var On=new Array(4);for(let ji=0;ji<4;ji+=1){var vr=Bn[ji],fr=kn[ji];On[ji]=vr*(1-pn)+fr*pn}var[ci,Gi,no,Jr]=On;return`rgba(${Math.round(ci)}, ${Math.round(Gi)}, ${Math.round(no)}, ${Jr})`}}},Me=(De,Je)=>{const kt=Ut(De,Je);return un=>Math.round(kt(un))};function Qe({map:De,initKey:Je},kt){return Je=Je(kt),De.has(Je)?De.get(Je):kt}function Ft(De){return typeof De=="object"?De.valueOf():De}class U extends Map{constructor(Je){if(super(),this.map=new Map,this.initKey=Ft,Je!==null)for(var[kt,un]of Je)this.set(kt,un)}get(Je){return super.get(Qe({map:this.map,initKey:this.initKey},Je))}has(Je){return super.has(Qe({map:this.map,initKey:this.initKey},Je))}set(Je,kt){return super.set(([{map:Je,initKey:un},Bn]=[{map:this.map,initKey:this.initKey},Je],un=un(Bn),Je.has(un)?Je.get(un):(Je.set(un,Bn),Bn)),kt);var un,Bn}delete(Je){return super.delete(([{map:Je,initKey:kt},un]=[{map:this.map,initKey:this.initKey},Je],kt=kt(un),Je.has(kt)&&(un=Je.get(kt),Je.delete(kt)),un));var kt,un}}class ue{constructor(Je){this.options=ve({},this.getDefaultOptions()),this.update(Je)}getOptions(){return this.options}update(Je={}){this.options=ve({},this.options,Je),this.rescale(Je)}rescale(Je){}}const at=Symbol("defaultUnknown");function ce(De,Je,kt){for(let un=0;un<Je.length;un+=1)De.has(Je[un])||De.set(kt(Je[un]),un)}function j(Je){var{value:Je,from:kt,to:un,mapper:Bn,notFoundReturn:kn}=Je;let pn=Bn.get(Je);if(pn===void 0){if(kn!==at)return kn;pn=kt.push(Je)-1,Bn.set(Je,pn)}return un[pn%un.length]}function ln(De){return De instanceof Date?Je=>""+Je:typeof De=="object"?Je=>JSON.stringify(Je):Je=>Je}class fn extends ue{getDefaultOptions(){return{domain:[],range:[],unknown:at}}constructor(Je){super(Je)}map(Je){return this.domainIndexMap.size===0&&ce(this.domainIndexMap,this.getDomain(),this.domainKey),j({value:this.domainKey(Je),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(Je){return this.rangeIndexMap.size===0&&ce(this.rangeIndexMap,this.getRange(),this.rangeKey),j({value:this.rangeKey(Je),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(Je){var[kt]=this.options.domain,[un]=this.options.range;this.domainKey=ln(kt),this.rangeKey=ln(un),this.rangeIndexMap?(Je&&!Je.range||this.rangeIndexMap.clear(),Je&&!Je.domain&&!Je.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)):(this.rangeIndexMap=new Map,this.domainIndexMap=new Map)}clone(){return new fn(this.options)}getRange(){return this.options.range}getDomain(){var Je,kt;return this.sortedDomain||({domain:Je,compare:kt}=this.options,this.sortedDomain=kt?[...Je].sort(kt):Je),this.sortedDomain}}function mt(Gr){const{domain:Je,range:kt,paddingOuter:un,paddingInner:Bn,flex:kn,round:pn,align:On}=Gr;var vr=Je.length,Jr=0<(Jr=(Gr=vr)-(fr=kn).length)?[...fr,...new Array(Jr).fill(1)]:Jr<0?fr.slice(0,Gr):fr,[Gr,fr]=kt,fr=fr-Gr,Di=fr/(2/vr*un+1-1/vr*Bn);const ci=Di*Bn/vr;Di-=vr*ci;const Gi=function(xi){const wo=Math.min(...xi);return xi.map(ia=>ia/wo)}(Jr),no=Di/Gi.reduce((xi,wo)=>xi+wo);var Jr=new U(Je.map((xi,wo)=>(wo=Gi[wo]*no,[xi,pn?Math.floor(wo):wo]))),ji=new U(Je.map((xi,wo)=>(wo=Gi[wo]*no+ci,[xi,pn?Math.floor(wo):wo]))),Di=Array.from(ji.values()).reduce((xi,wo)=>xi+wo),Gr=Gr+(fr-(Di-Di/vr*Bn))*On;let fo=pn?Math.round(Gr):Gr;var Ri=new Array(vr);for(let xi=0;xi<vr;xi+=1){Ri[xi]=(bo=fo,Math.round(1e12*bo)/1e12);var bo=Je[xi];fo+=ji.get(bo)}return{valueBandWidth:Jr,valueStep:ji,adjustedRange:Ri}}class Gt extends fn{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:at,flex:[]}}constructor(Je){super(Je)}clone(){return new Gt(this.options)}getStep(Je){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:Je===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(Je)}getBandWidth(Je){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:Je===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(Je)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:Je,paddingInner:kt}=this.options;return 0<Je?Je:kt}getPaddingOuter(){var{padding:Je,paddingOuter:kt}=this.options;return 0<Je?Je:kt}rescale(){super.rescale();var{align:un,domain:Je,range:Bn,round:kn,flex:kt}=this.options,{adjustedRange:un,valueBandWidth:Bn,valueStep:kn}=function(fr){var On=fr.domain;if((On=On.length)===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!((vr=fr.flex)==null||!vr.length))return mt(fr);var{range:vr,paddingOuter:fr,paddingInner:ci,round:Gi,align:no}=fr;let Jr,ji,Di=vr[0];return vr=vr[1]-Di,Jr=vr/Math.max(1,2*fr+(On-ci)),Gi&&(Jr=Math.floor(Jr)),Di+=(vr-Jr*(On-ci))*no,ji=Jr*(1-ci),Gi&&(Di=Math.round(Di),ji=Math.round(ji)),fr=new Array(On).fill(0).map((Gr,fo)=>Di+fo*Jr),{valueStep:Jr,valueBandWidth:ji,adjustedRange:fr}}({align:un,range:Bn,round:kn,flex:kt,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:Je});this.valueStep=kn,this.valueBandWidth=Bn,this.adjustedRange=un}}const Wn=(De,Je,kt)=>{let un,Bn,kn=De,pn=Je;if(kn===pn&&0<kt)return[kn];let On=He(kn,pn,kt);if(On===0||!Number.isFinite(On))return[];if(0<On){kn=Math.ceil(kn/On),pn=Math.floor(pn/On),Bn=new Array(un=Math.ceil(pn-kn+1));for(let vr=0;vr<un;vr+=1)Bn[vr]=(kn+vr)*On}else{On=-On,kn=Math.ceil(kn*On),pn=Math.floor(pn*On),Bn=new Array(un=Math.ceil(pn-kn+1));for(let vr=0;vr<un;vr+=1)Bn[vr]=(kn+vr)/On}return Bn},hn=(un,kn,kt)=>{var[un,Bn]=un,[kn,pn]=kn;let On,vr;return Re(vr=un<Bn?(On=bt(un,Bn),kt(kn,pn)):(On=bt(Bn,un),kt(pn,kn)),On)},ht=(De,Je,kt)=>{const un=Math.min(De.length,Je.length)-1,Bn=new Array(un),kn=new Array(un);var pn=De[0]>De[un],On=pn?[...De].reverse():De,vr=pn?[...Je].reverse():Je;for(let fr=0;fr<un;fr+=1)Bn[fr]=bt(On[fr],On[fr+1]),kn[fr]=kt(vr[fr],vr[fr+1]);return fr=>{var ci=function(no,Jr,ji,Di,Gr){let fo=ji||0,Ri=Di||no.length;for(var bo=Gr||(wo=>wo);fo<Ri;){var xi=Math.floor((fo+Ri)/2);bo(no[xi])>Jr?Ri=xi:fo=xi+1}return fo}(De,fr,1,un)-1,Gi=Bn[ci];return Re(kn[ci],Gi)(fr)}},Ht=(De,Je,kt,un)=>(2<Math.min(De.length,Je.length)?ht:hn)(De,Je,un?Me:kt);class Cn extends ue{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Ut,tickCount:5}}map(Je){return Ce(Je)?this.output(Je):this.options.unknown}invert(Je){return Ce(Je)?this.input(Je):this.options.unknown}nice(){var Je,kt,un,Bn;this.options.nice&&([Je,kt,un,...Bn]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(Je,kt,un,...Bn))}getTicks(){var Je=this.options.tickMethod,[kt,un,Bn,...kn]=this.getTickMethodOptions();return Je(kt,un,Bn,...kn)}getTickMethodOptions(){var{domain:Je,tickCount:kt}=this.options;return[Je[0],Je[Je.length-1],kt]}chooseNice(){return Ot}rescale(){this.nice();var[Je,kt]=this.chooseTransforms();this.composeOutput(Je,this.chooseClamp(Je)),this.composeInput(Je,kt,this.chooseClamp(kt))}chooseClamp(un){var{clamp:kt,range:Bn}=this.options,un=this.options.domain.map(un),Bn=Math.min(un.length,Bn.length);if(kt){kt=un[0],un=un[Bn-1];const kn=un<kt?un:kt,pn=un<kt?kt:un;return On=>Math.min(Math.max(kn,On),pn)}return Be}composeOutput(Je,kt){var{domain:pn,range:un,round:Bn,interpolate:kn}=this.options,pn=Ht(pn.map(Je),un,kn,Bn);this.output=Re(pn,kt,Je)}composeInput(Je,kt,un){var{domain:Bn,range:kn}=this.options,kn=Ht(kn,Bn.map(Je),Ut);this.input=Re(kt,un,kn)}}class Ln extends Cn{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Dt,tickMethod:Wn,tickCount:5}}chooseTransforms(){return[Be,Be]}clone(){return new Ln(this.options)}}class Gn extends Gt{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:at,paddingInner:1,paddingOuter:0}}constructor(Je){super(Je)}getPaddingInner(){return 1}clone(){return new Gn(this.options)}update(Je){super.update(Je)}getPaddingOuter(){return this.options.padding}}function dt(De,Je){for(var kt=[],un=0,Bn=De.length;un<Bn;un++)kt.push(De[un].substr(0,Je));return kt}var ye,Fe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],nt=["January","February","March","April","May","June","July","August","September","October","November","December"],Pt=dt(nt,3);(function(De){for(var Je=[],kt=1;kt<arguments.length;kt++)Je[kt-1]=arguments[kt];for(var un=0,Bn=Je;un<Bn.length;un++){var kn,pn=Bn[un];for(kn in pn)De[kn]=pn[kn]}})({},{dayNamesShort:dt(Fe,3),dayNames:Fe,monthNamesShort:Pt,monthNames:nt,amPm:["am","pm"],DoFn:function(De){return De+["th","st","nd","rd"][3<De%10?0:(De-De%10!=10?1:0)*De%10]}});var Mt;let Tn=ye=class extends Ln{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Be,tickMethod:Wn,tickCount:5}}constructor(De){super(De)}clone(){return new ye(this.options)}};Tn=ye=function(De,Je,kt,un){var Bn,kn=arguments.length,pn=kn<3?Je:un===null?un=Object.getOwnPropertyDescriptor(Je,kt):un;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")pn=Reflect.decorate(De,Je,kt,un);else for(var On=De.length-1;0<=On;On--)(Bn=De[On])&&(pn=(kn<3?Bn(pn):3<kn?Bn(Je,kt,pn):Bn(Je,kt))||pn);return 3<kn&&pn&&Object.defineProperty(Je,kt,pn),pn}([ot(function(De){return[De(0),De(1)]},Je=>{var[Je,kt]=Je;return Re(Ut(0,1),bt(Je,kt))})],Tn);let $n=Mt=class extends Ln{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:Be,tickMethod:Wn,tickCount:5}}constructor(De){super(De)}clone(){return new Mt(this.options)}};$n=Mt=function(De,Je,kt,un){var Bn,kn=arguments.length,pn=kn<3?Je:un===null?un=Object.getOwnPropertyDescriptor(Je,kt):un;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")pn=Reflect.decorate(De,Je,kt,un);else for(var On=De.length-1;0<=On;On--)(Bn=De[On])&&(pn=(kn<3?Bn(pn):3<kn?Bn(Je,kt,pn):Bn(Je,kt))||pn);return 3<kn&&pn&&Object.defineProperty(Je,kt,pn),pn}([ot(function(De){return[De(0),De(.5),De(1)]},De=>{const[Je,kt,un]=De,Bn=Re(Ut(0,.5),bt(Je,kt)),kn=Re(Ut(.5,1),bt(kt,un));return pn=>(Je>un?pn<kt?kn:Bn:pn<kt?Bn:kn)(pn)})],$n);function xr(De,Je,kt,un,Bn){var kn=new Ln({range:[Je,Je+un]}),pn=new Ln({range:[kt,kt+Bn]});return{transform:function(fr){var fr=X(fr,2),vr=fr[0],fr=fr[1];return[kn.map(vr),pn.map(fr)]},untransform:function(fr){var fr=X(fr,2),vr=fr[0],fr=fr[1];return[kn.invert(vr),pn.invert(fr)]}}}function qn(De,Je,kt,un,Bn){return(0,X(De,1)[0])(Je,kt,un,Bn)}function Ae(De,Je,kt,un,Bn){return X(De,1)[0]}function be(vr,Je,kt,un,Bn){var kn=(vr=X(vr,4))[0],pn=vr[1],On=vr[2],vr=vr[3],fr=new Ln({range:[On,vr]}),ci=new Ln({range:[kn,pn]}),Gi=1<(On=Bn/un)?1:On,no=1<On?1/On:1;return{transform:function(Di){var Di=X(Di,2),ji=Di[0],Di=Di[1],ji=ci.map(ji),Di=fr.map(Di);return[.5*(Di*Math.cos(ji)*Gi)+.5,.5*(Di*Math.sin(ji)*no)+.5]},untransform:function(Gr){var Gr=X(Gr,2),ji=Gr[0],Gr=Gr[1],ji=2*(ji-.5)/Gi,Gr=2*(Gr-.5)/no,Di=Math.sqrt(Math.pow(ji,2)+Math.pow(Gr,2)),Gr=vt(Math.atan2(Gr,ji),kn,pn);return[ci.invert(Gr),fr.invert(Di)]}}}function Ne(De,Je,kt,un,Bn){return{transform:function(pn){var pn=X(pn,2),On=pn[0];return[pn[1],On]},untransform:function(pn){var pn=X(pn,2),On=pn[0];return[pn[1],On]}}}function et(De){for(var Je=[],kt=1;kt<arguments.length;kt++)Je[kt-1]=arguments[kt];return Qn.apply(void 0,E([[-1,-1]],X(Je),!1))}function wt(De){for(var Je=[],kt=1;kt<arguments.length;kt++)Je[kt-1]=arguments[kt];return Qn.apply(void 0,E([[-1,1]],X(Je),!1))}function qt(De){for(var Je=[],kt=1;kt<arguments.length;kt++)Je[kt-1]=arguments[kt];return Qn.apply(void 0,E([[1,-1]],X(Je),!1))}function vn(pn,Je,kt,un,Bn){var kn,pn=X(pn,1)[0],On=le();return On=On,pn=pn,kn=Math.sin(pn),pn=Math.cos(pn),On[0]=pn,On[1]=kn,On[2]=0,On[3]=-kn,On[4]=pn,On[5]=0,On[6]=0,On[7]=0,On[8]=1,On}function yt(De,Je,kt,un,Bn){var kn=(De=X(De,4))[0],pn=De[1],On=De[2],vr=(De[3]-On)/(+pn/(2*Math.PI)+1),fr=vr/(2*Math.PI),ci=new Ln({range:[On,On+.99*vr]}),Gi=new Ln({range:[kn,pn]}),no=1<(De=Bn/un)?1:De,Jr=1<De?1/De:1;return{transform:function(Gr){var Gr=X(Gr,2),Di=Gr[0],Gr=Gr[1],Di=Gi.map(Di),Gr=ci.map(Gr);return[.5*(Math.cos(Di)*(fr*Di+Gr)*no)+.5,.5*(Math.sin(Di)*(fr*Di+Gr)*Jr)+.5]},untransform:function(Gr){var Gr=X(Gr,2),fo=Gr[0],Gr=Gr[1],fo=2*(fo-.5)/no,Gr=2*(Gr-.5)/Jr,Di=Math.sqrt(Math.pow(fo,2)+Math.pow(Gr,2)),Gr=vt(Math.atan2(Gr,fo)+Math.floor(Di/vr)*Math.PI*2,kn,pn),fo=Di-fr*Gr;return[Gi.invert(Gr),ci.invert(fo)]}}}function Jt(vr,Je,kt,un,Bn){var kn=(vr=X(vr,4))[0],pn=vr[1],On=vr[2],vr=vr[3],fr=new Ln({range:[On,vr]});return{transform:function(ci){for(var Gi=[],no=ci.length,Jr=new Gn({domain:new Array(no).fill(0).map(function(fo,Ri){return Ri}),range:[kn,pn]}),ji=0;ji<no;ji++){var Gr=ci[ji],Di=Jr.map(ji),Gr=fr.map(Gr);Gi.push(Di,Gr)}return Gi},untransform:function(ci){for(var Gi=[],no=0;no<ci.length;no+=2){var Jr=ci[no+1];Gi.push(fr.invert(Jr))}return Gi}}}var Qn=function(pn,Je,kt,un,Bn){var pn=X(pn,2),kn=pn[0],pn=pn[1],On=le();return kn=[kn,pn],(pn=On)[0]=kn[0],pn[1]=0,pn[2]=0,pn[3]=0,pn[4]=kn[1],pn[5]=0,pn[6]=0,pn[7]=0,pn[8]=1,pn};function Er(De){return 1/Math.tan(De)}function Vr(De,Je,kt,un,Bn){var kn=Er(X(De,1)[0]);return{transform:function(vr){var vr=X(vr,2),On=vr[0],vr=vr[1];return[On+vr*kn,vr]},untransform:function(vr){var vr=X(vr,2),On=vr[0],vr=vr[1];return[On-vr*kn,vr]}}}function mr(De,Je,kt,un,Bn){var kn=Er(X(De,1)[0]);return{transform:function(On){var On=X(On,2),vr=On[0];return[vr,On[1]+vr*kn]},untransform:function(On){var On=X(On,2),vr=On[0];return[vr,On[1]-vr*kn]}}}function kr(De,Je,kt,On,pn){var kn=De<Je,pn=(kn?Je-On:pn-Je)||pn-On,On=kn?-1:1;return On*pn*(kt+1)/(kt+pn/((De-Je)*On))+Je}function Ei(De,Je,kt,un,pn){var kn=De<Je,pn=(kn?Je-un:pn-Je)||pn-un;return pn/(pn*(kt+1)/(De-Je)-kt*(kn?-1:1))+Je}function Oi(De,Je,kt){return kt?new Ln({range:[0,1],domain:[0,Je]}).map(De):De}function ar(On,Je,kt,un,Bn){var kn=(On=X(On,3))[0],pn=On[1],On=On[2],vr=Oi(kn,un,On!==void 0&&On);return{transform:function(Gi){var Gi=X(Gi,2),ci=Gi[0],Gi=Gi[1];return[kr(ci,vr,pn,0,1),Gi]},untransform:function(Gi){var Gi=X(Gi,2),ci=Gi[0],Gi=Gi[1];return[Ei(ci,vr,pn,0,1),Gi]}}}function Kr(On,Je,kt,un,Bn){var kn=(On=X(On,3))[0],pn=On[1],On=On[2],vr=Oi(kn,Bn,On!==void 0&&On);return{transform:function(fr){return fr=X(fr,2),[fr[0],kr(fr[1],vr,pn,0,1)]},untransform:function(fr){return fr=X(fr,2),[fr[0],Ei(fr[1],vr,pn,0,1)]}}}function hi(fr,Je,kt,un,Bn){var kn=(fr=X(fr,5))[0],pn=fr[1],On=fr[2],vr=fr[3],fr=fr[4],ci=Oi(kn,un,fr=fr!==void 0&&fr),Gi=Oi(pn,Bn,fr);return{transform:function(ji){var ji=X(ji,2),Jr=ji[0],ji=ji[1];return[kr(Jr,ci,On,0,1),kr(ji,Gi,vr,0,1)]},untransform:function(ji){var ji=X(ji,2),Jr=ji[0],ji=ji[1];return[Ei(Jr,ci,On,0,1),Ei(ji,Gi,vr,0,1)]}}}function Qr(fr,Je,kt,un,Bn){var kn=(fr=X(fr,5))[0],pn=fr[1],On=fr[2],vr=fr[3],fr=(fr=fr[4])!==void 0&&fr,ci=new Ln({range:[0,un]}),Gi=new Ln({range:[0,Bn]}),no=fr?kn:ci.map(kn),Jr=fr?pn:Gi.map(pn);return{transform:function(Gr){var Gr=X(Gr,2),Di=Gr[0],Gr=Gr[1],fo=ci.map(Di)-no,Ri=Gi.map(Gr)-Jr,bo=Math.sqrt(fo*fo+Ri*Ri);return On<bo?[Di,Gr]:(Di=kr(bo,0,vr,0,On),Gr=Math.atan2(Ri,fo),bo=no+Di*Math.cos(Gr),Ri=Jr+Di*Math.sin(Gr),[ci.invert(bo),Gi.invert(Ri)])},untransform:function(Gr){var Gr=X(Gr,2),Di=Gr[0],Gr=Gr[1],fo=ci.map(Di)-no,Ri=Gi.map(Gr)-Jr,bo=Math.sqrt(fo*fo+Ri*Ri);return On<bo?[Di,Gr]:(Di=Ei(bo,0,vr,0,On),Gr=Math.atan2(Ri,fo),bo=no+Di*Math.cos(Gr),Ri=Jr+Di*Math.sin(Gr),[ci.invert(bo),Gi.invert(Ri)])}}}function Io(De,Je,kt,un,Bn,kn,pn){var On=new Ln({range:[Je,Je+Bn]}),vr=new Ln({range:[kt,kt+kn]}),fr=new Ln({range:[un,un+pn]});return{transform:function(Jr){var Jr=X(Jr,3),Gi=Jr[0],no=Jr[1],Jr=Jr[2];return[On.map(Gi),vr.map(no),fr.map(Jr)]},untransform:function(Jr){var Jr=X(Jr,3),Gi=Jr[0],no=Jr[1],Jr=Jr[2];return[On.invert(Gi),vr.invert(no),fr.invert(Jr)]}}}function Ii(ci,Je,kt,un,Bn,kn,pn){var On,vr=(ci=X(ci,3))[0],fr=ci[1],ci=ci[2];return On=xt(),vr=[vr,fr,ci],On[0]=1,On[1]=0,On[2]=0,On[3]=0,On[4]=0,On[5]=1,On[6]=0,On[7]=0,On[8]=0,On[9]=0,On[10]=1,On[11]=0,On[12]=vr[0],On[13]=vr[1],On[14]=vr[2],On[15]=1,On}function Fo(De,Je,kt,un,Bn,kn,pn){return{transform:function(vr){var vr=X(vr,3),fr=vr[0];return[vr[1],fr,vr[2]]},untransform:function(vr){var vr=X(vr,3),fr=vr[0];return[vr[1],fr,vr[2]]}}}function _a(ci,Je,kt,un,Bn,kn,pn){var On,vr=(ci=X(ci,3))[0],fr=ci[1],ci=ci[2];return On=xt(),vr=[vr,fr,ci],On[0]=vr[0],On[1]=0,On[2]=0,On[3]=0,On[4]=0,On[5]=vr[1],On[6]=0,On[7]=0,On[8]=0,On[9]=0,On[10]=vr[2],On[11]=0,On[12]=0,On[13]=0,On[14]=0,On[15]=1,On}Co.prototype.update=function(De){this.options=ve({},this.options,De),this.recoordinate()},Co.prototype.clone=function(){return new Co(this.options)},Co.prototype.getOptions=function(){return this.options},Co.prototype.clear=function(){this.update({transformations:[]})},Co.prototype.getSize=function(){var De=this.options;return[De.width,De.height]},Co.prototype.getCenter=function(){var De=this.options,Je=De.x,kt=De.y;return[(2*Je+De.width)/2,(2*kt+De.height)/2]},Co.prototype.transform=function(){for(var De=[],Je=0;Je<arguments.length;Je++)De[Je]=arguments[Je];var kt=this.options.transformations;return this.update({transformations:E(E([],X(kt),!1),[E([],X(De),!1)],!1)}),this},Co.prototype.map=function(De){return this.output(De)},Co.prototype.invert=function(De){return this.input(De)},Co.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Co.prototype.compose=function(De){function Je(xi,wo){var ia;On.push((wo=wo===void 0?!0:wo)?(ia=xi,function(Ga){for(var Jo=[],Wo=0;Wo<Ga.length-1;Wo+=2){var Ha=[Ga[Wo],Ga[Wo+1]],Ha=ia(Ha);Jo.push.apply(Jo,E([],X(Ha),!1))}return Jo}):xi)}var kt,un,Bn=(De=De===void 0?!1:De)?E([],X(this.options.transformations),!1).reverse():this.options.transformations,kn=De?function(xi){return xi.untransform}:function(xi){return xi.transform},pn=[],On=[];try{for(var vr=ee(Bn),fr=vr.next();!fr.done;fr=vr.next()){var ci,Gi,no,Jr,ji,Di,Gr=X(fr.value),fo=Gr[0],Ri=Gr.slice(1),bo=this.transformers[fo];bo&&(Gi=(ci=this.options).x,no=ci.y,Jr=ci.width,ji=ci.height,pt(Di=bo(E([],X(Ri),!1),Gi,no,Jr,ji))?pn.push(Di):(pn.length&&(Je(this.createMatrixTransform(pn,De)),pn.splice(0,pn.length)),Je(kn(Di)||Be,fo!=="parallel")))}}catch(xi){kt={error:xi}}finally{try{fr&&!fr.done&&(un=vr.return)&&un.call(vr)}finally{if(kt)throw kt.error}}return pn.length&&Je(this.createMatrixTransform(pn,De)),Zt.apply(void 0,E([],X(On),!1))},Co.prototype.createMatrixTransform=function(De,Je){var kt,un,Bn,kn,pn,On,vr,fr,ci,Gi,no,Jr,ji=le();return Je&&De.reverse(),De.forEach(function(Di){return Ze(ji,ji,Di)}),Je&&(Je=De=ji,(Jr=new we(9))[0]=Je[0],Jr[1]=Je[1],Jr[2]=Je[2],Jr[3]=Je[3],Jr[4]=Je[4],Jr[5]=Je[5],Jr[6]=Je[6],Jr[7]=Je[7],Jr[8]=Je[8],Jr=(Je=Jr)[0],kt=Je[1],un=Je[2],Bn=Je[3],kn=Je[4],pn=Je[5],On=Je[6],vr=Je[7],fr=(Je=Je[8])*kn-pn*vr,no=Jr*fr+kt*(ci=-Je*Bn+pn*On)+un*(Gi=vr*Bn-kn*On))&&(De[0]=fr*(no=1/no),De[1]=(-Je*kt+un*vr)*no,De[2]=(pn*kt-un*kn)*no,De[3]=ci*no,De[4]=(Je*Jr-un*On)*no,De[5]=(-pn*Jr+un*Bn)*no,De[6]=Gi*no,De[7]=(-vr*Jr+kt*On)*no,De[8]=(kn*Jr-kt*Bn)*no),function(wo){var Gr,fo,Ri,bo,xi,wo=[wo[0],wo[1],1];return Ri=ji,bo=(fo=Gr=wo)[0],xi=fo[1],fo=fo[2],Gr[0]=bo*Ri[0]+xi*Ri[3]+fo*Ri[6],Gr[1]=bo*Ri[1]+xi*Ri[4]+fo*Ri[7],Gr[2]=bo*Ri[2]+xi*Ri[5]+fo*Ri[8],[wo[0],wo[1]]}},Fe=Co;function Co(De){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:xr,translate:ke,custom:qn,matrix:Ae,polar:be,transpose:Ne,scale:Qn,"shear.x":Vr,"shear.y":mr,reflect:et,"reflect.x":wt,"reflect.y":qt,rotate:vn,helix:yt,parallel:Jt,fisheye:hi,"fisheye.x":ar,"fisheye.y":Kr,"fisheye.circular":Qr},this.update(De)}Qo.prototype.update=function(De){this.options=ve({},this.options,De),this.recoordinate()},Qo.prototype.clone=function(){return new Qo(this.options)},Qo.prototype.getOptions=function(){return this.options},Qo.prototype.clear=function(){this.update({transformations:[]})},Qo.prototype.getSize=function(){var De=this.options;return[De.width,De.height,De.depth]},Qo.prototype.getCenter=function(){var De=this.options,Je=De.x,kt=De.y,un=De.z;return[(2*Je+De.width)/2,(2*kt+De.height)/2,(2*un+De.depth)/2]},Qo.prototype.transform=function(){for(var De=[],Je=0;Je<arguments.length;Je++)De[Je]=arguments[Je];var kt=this.options.transformations;return this.update({transformations:E(E([],X(kt),!1),[E([],X(De),!1)],!1)}),this},Qo.prototype.map=function(De){return this.output(De)},Qo.prototype.invert=function(De){return this.input(De)},Qo.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},Qo.prototype.compose=function(De){function Je(ia,Ga){var Jo;On.push((Ga=Ga===void 0?!0:Ga)?(Jo=ia,function(Wo){for(var Ha=[],ds=0;ds<Wo.length-1;ds+=3){var Tt=[Wo[ds],Wo[ds+1],Wo[ds+2]],Tt=Jo(Tt);Ha.push.apply(Ha,E([],X(Tt),!1))}return Ha}):ia)}var kt,un,Bn=(De=De===void 0?!1:De)?E([],X(this.options.transformations),!1).reverse():this.options.transformations,kn=De?function(ia){return ia.untransform}:function(ia){return ia.transform},pn=[],On=[];try{for(var vr=ee(Bn),fr=vr.next();!fr.done;fr=vr.next()){var ci,Gi,no,Jr,ji,Di,Gr,fo,Ri=X(fr.value),bo=Ri[0],xi=Ri.slice(1),wo=this.transformers[bo];wo&&(Gi=(ci=this.options).x,no=ci.y,Jr=ci.z,ji=ci.width,Di=ci.height,Gr=ci.depth,pt(fo=wo(E([],X(xi),!1),Gi,no,Jr,ji,Di,Gr))?pn.push(fo):(pn.length&&(Je(this.createMatrixTransform(pn,De)),pn.splice(0,pn.length)),Je(kn(fo)||Be,!0)))}}catch(ia){kt={error:ia}}finally{try{fr&&!fr.done&&(un=vr.return)&&un.call(vr)}finally{if(kt)throw kt.error}}return pn.length&&Je(this.createMatrixTransform(pn,De)),Zt.apply(void 0,E([],X(On),!1))},Qo.prototype.createMatrixTransform=function(De,Je){var kt,un,Bn,kn,pn,On,vr,fr,ci,Gi,no,Jr,ji,Di,Gr,fo,Ri,bo,xi,wo,ia,Ga,Jo,Wo,Ha,ds,Tt,Yt,Fn=xt();return Je&&De.reverse(),De.forEach(function(dr){return ft(Fn,Fn,dr)}),Je&&(Je=De=Fn,(Yt=new we(16))[0]=Je[0],Yt[1]=Je[1],Yt[2]=Je[2],Yt[3]=Je[3],Yt[4]=Je[4],Yt[5]=Je[5],Yt[6]=Je[6],Yt[7]=Je[7],Yt[8]=Je[8],Yt[9]=Je[9],Yt[10]=Je[10],Yt[11]=Je[11],Yt[12]=Je[12],Yt[13]=Je[13],Yt[14]=Je[14],Yt[15]=Je[15],Yt=(Je=Yt)[0],kt=Je[1],un=Je[2],Bn=Je[3],kn=Je[4],pn=Je[5],On=Je[6],vr=Je[7],fr=Je[8],ci=Je[9],Gi=Je[10],no=Je[11],Jr=Je[12],ji=Je[13],Di=Je[14],Je=Je[15],Tt=(Gr=Yt*pn-kt*kn)*(ds=Gi*Je-no*Di)-(fo=Yt*On-un*kn)*(Ha=ci*Je-no*ji)+(Ri=Yt*vr-Bn*kn)*(Wo=ci*Di-Gi*ji)+(bo=kt*On-un*pn)*(Jo=fr*Je-no*Jr)-(xi=kt*vr-Bn*pn)*(Ga=fr*Di-Gi*Jr)+(wo=un*vr-Bn*On)*(ia=fr*ji-ci*Jr))&&(De[0]=(pn*ds-On*Ha+vr*Wo)*(Tt=1/Tt),De[1]=(un*Ha-kt*ds-Bn*Wo)*Tt,De[2]=(ji*wo-Di*xi+Je*bo)*Tt,De[3]=(Gi*xi-ci*wo-no*bo)*Tt,De[4]=(On*Jo-kn*ds-vr*Ga)*Tt,De[5]=(Yt*ds-un*Jo+Bn*Ga)*Tt,De[6]=(Di*Ri-Jr*wo-Je*fo)*Tt,De[7]=(fr*wo-Gi*Ri+no*fo)*Tt,De[8]=(kn*Ha-pn*Jo+vr*ia)*Tt,De[9]=(kt*Jo-Yt*Ha-Bn*ia)*Tt,De[10]=(Jr*xi-ji*Ri+Je*Gr)*Tt,De[11]=(ci*Ri-fr*xi-no*Gr)*Tt,De[12]=(pn*Ga-kn*Wo-On*ia)*Tt,De[13]=(Yt*Wo-kt*Ga+un*ia)*Tt,De[14]=(ji*fo-Jr*bo-Di*Gr)*Tt,De[15]=(fr*bo-ci*fo+Gi*Gr)*Tt),function(nl){var ai,Xr,Uo,Xo,ya,vs,nl=[nl[0],nl[1],nl[2],1];return Uo=Fn,Xo=(Xr=ai=nl)[0],ya=Xr[1],vs=Xr[2],Xr=Xr[3],ai[0]=Uo[0]*Xo+Uo[4]*ya+Uo[8]*vs+Uo[12]*Xr,ai[1]=Uo[1]*Xo+Uo[5]*ya+Uo[9]*vs+Uo[13]*Xr,ai[2]=Uo[2]*Xo+Uo[6]*ya+Uo[10]*vs+Uo[14]*Xr,ai[3]=Uo[3]*Xo+Uo[7]*ya+Uo[11]*vs+Uo[15]*Xr,[nl[0],nl[1],nl[2]]}},Pt=Qo;function Qo(De){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:Io,translate3D:Ii,scale3D:_a,transpose3D:Fo},this.update(De)}D.Coordinate=Fe,D.Coordinate3D=Pt,Object.defineProperty(D,"__esModule",{value:!0})})},90857:function($t){"use strict";var W=Object.prototype.hasOwnProperty,D="~";function ee(){}Object.create&&(ee.prototype=Object.create(null),new ee().__proto__||(D=!1));function X(he,se,Se){this.fn=he,this.context=se,this.once=Se||!1}function E(he,se,Se,oe,je){if(typeof Se!="function")throw new TypeError("The listener must be a function");var te=new X(Se,oe||he,je),ve=D?D+se:se;return he._events[ve]?he._events[ve].fn?he._events[ve]=[he._events[ve],te]:he._events[ve].push(te):(he._events[ve]=te,he._eventsCount++),he}function _e(he,se){--he._eventsCount===0?he._events=new ee:delete he._events[se]}function re(){this._events=new ee,this._eventsCount=0}re.prototype.eventNames=function(){var se=[],Se,oe;if(this._eventsCount===0)return se;for(oe in Se=this._events)W.call(Se,oe)&&se.push(D?oe.slice(1):oe);return Object.getOwnPropertySymbols?se.concat(Object.getOwnPropertySymbols(Se)):se},re.prototype.listeners=function(se){var Se=D?D+se:se,oe=this._events[Se];if(!oe)return[];if(oe.fn)return[oe.fn];for(var je=0,te=oe.length,ve=new Array(te);je<te;je++)ve[je]=oe[je].fn;return ve},re.prototype.listenerCount=function(se){var Se=D?D+se:se,oe=this._events[Se];return oe?oe.fn?1:oe.length:0},re.prototype.emit=function(se,Se,oe,je,te,ve){var Be=D?D+se:se;if(!this._events[Be])return!1;var Te=this._events[Be],we=arguments.length,le,Ze;if(Te.fn){switch(Te.once&&this.removeListener(se,Te.fn,void 0,!0),we){case 1:return Te.fn.call(Te.context),!0;case 2:return Te.fn.call(Te.context,Se),!0;case 3:return Te.fn.call(Te.context,Se,oe),!0;case 4:return Te.fn.call(Te.context,Se,oe,je),!0;case 5:return Te.fn.call(Te.context,Se,oe,je,te),!0;case 6:return Te.fn.call(Te.context,Se,oe,je,te,ve),!0}for(Ze=1,le=new Array(we-1);Ze<we;Ze++)le[Ze-1]=arguments[Ze];Te.fn.apply(Te.context,le)}else{var xt=Te.length,ft;for(Ze=0;Ze<xt;Ze++)switch(Te[Ze].once&&this.removeListener(se,Te[Ze].fn,void 0,!0),we){case 1:Te[Ze].fn.call(Te[Ze].context);break;case 2:Te[Ze].fn.call(Te[Ze].context,Se);break;case 3:Te[Ze].fn.call(Te[Ze].context,Se,oe);break;case 4:Te[Ze].fn.call(Te[Ze].context,Se,oe,je);break;default:if(!le)for(ft=1,le=new Array(we-1);ft<we;ft++)le[ft-1]=arguments[ft];Te[Ze].fn.apply(Te[Ze].context,le)}}return!0},re.prototype.on=function(se,Se,oe){return E(this,se,Se,oe,!1)},re.prototype.once=function(se,Se,oe){return E(this,se,Se,oe,!0)},re.prototype.removeListener=function(se,Se,oe,je){var te=D?D+se:se;if(!this._events[te])return this;if(!Se)return _e(this,te),this;var ve=this._events[te];if(ve.fn)ve.fn===Se&&(!je||ve.once)&&(!oe||ve.context===oe)&&_e(this,te);else{for(var Be=0,Te=[],we=ve.length;Be<we;Be++)(ve[Be].fn!==Se||je&&!ve[Be].once||oe&&ve[Be].context!==oe)&&Te.push(ve[Be]);Te.length?this._events[te]=Te.length===1?Te[0]:Te:_e(this,te)}return this},re.prototype.removeAllListeners=function(se){var Se;return se?(Se=D?D+se:se,this._events[Se]&&_e(this,Se)):(this._events=new ee,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=D,re.EventEmitter=re,$t.exports=re},38554:function($t){"use strict";var W=Object.prototype.hasOwnProperty,D="~";function ee(){}Object.create&&(ee.prototype=Object.create(null),new ee().__proto__||(D=!1));function X(he,se,Se){this.fn=he,this.context=se,this.once=Se||!1}function E(he,se,Se,oe,je){if(typeof Se!="function")throw new TypeError("The listener must be a function");var te=new X(Se,oe||he,je),ve=D?D+se:se;return he._events[ve]?he._events[ve].fn?he._events[ve]=[he._events[ve],te]:he._events[ve].push(te):(he._events[ve]=te,he._eventsCount++),he}function _e(he,se){--he._eventsCount===0?he._events=new ee:delete he._events[se]}function re(){this._events=new ee,this._eventsCount=0}re.prototype.eventNames=function(){var se=[],Se,oe;if(this._eventsCount===0)return se;for(oe in Se=this._events)W.call(Se,oe)&&se.push(D?oe.slice(1):oe);return Object.getOwnPropertySymbols?se.concat(Object.getOwnPropertySymbols(Se)):se},re.prototype.listeners=function(se){var Se=D?D+se:se,oe=this._events[Se];if(!oe)return[];if(oe.fn)return[oe.fn];for(var je=0,te=oe.length,ve=new Array(te);je<te;je++)ve[je]=oe[je].fn;return ve},re.prototype.listenerCount=function(se){var Se=D?D+se:se,oe=this._events[Se];return oe?oe.fn?1:oe.length:0},re.prototype.emit=function(se,Se,oe,je,te,ve){var Be=D?D+se:se;if(!this._events[Be])return!1;var Te=this._events[Be],we=arguments.length,le,Ze;if(Te.fn){switch(Te.once&&this.removeListener(se,Te.fn,void 0,!0),we){case 1:return Te.fn.call(Te.context),!0;case 2:return Te.fn.call(Te.context,Se),!0;case 3:return Te.fn.call(Te.context,Se,oe),!0;case 4:return Te.fn.call(Te.context,Se,oe,je),!0;case 5:return Te.fn.call(Te.context,Se,oe,je,te),!0;case 6:return Te.fn.call(Te.context,Se,oe,je,te,ve),!0}for(Ze=1,le=new Array(we-1);Ze<we;Ze++)le[Ze-1]=arguments[Ze];Te.fn.apply(Te.context,le)}else{var xt=Te.length,ft;for(Ze=0;Ze<xt;Ze++)switch(Te[Ze].once&&this.removeListener(se,Te[Ze].fn,void 0,!0),we){case 1:Te[Ze].fn.call(Te[Ze].context);break;case 2:Te[Ze].fn.call(Te[Ze].context,Se);break;case 3:Te[Ze].fn.call(Te[Ze].context,Se,oe);break;case 4:Te[Ze].fn.call(Te[Ze].context,Se,oe,je);break;default:if(!le)for(ft=1,le=new Array(we-1);ft<we;ft++)le[ft-1]=arguments[ft];Te[Ze].fn.apply(Te[Ze].context,le)}}return!0},re.prototype.on=function(se,Se,oe){return E(this,se,Se,oe,!1)},re.prototype.once=function(se,Se,oe){return E(this,se,Se,oe,!0)},re.prototype.removeListener=function(se,Se,oe,je){var te=D?D+se:se;if(!this._events[te])return this;if(!Se)return _e(this,te),this;var ve=this._events[te];if(ve.fn)ve.fn===Se&&(!je||ve.once)&&(!oe||ve.context===oe)&&_e(this,te);else{for(var Be=0,Te=[],we=ve.length;Be<we;Be++)(ve[Be].fn!==Se||je&&!ve[Be].once||oe&&ve[Be].context!==oe)&&Te.push(ve[Be]);Te.length?this._events[te]=Te.length===1?Te[0]:Te:_e(this,te)}return this},re.prototype.removeAllListeners=function(se){var Se;return se?(Se=D?D+se:se,this._events[Se]&&_e(this,Se)):(this._events=new ee,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=D,re.EventEmitter=re,$t.exports=re},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function($t){try{let oe=function(){re||(re=!0,E())},je=function(){try{_e.documentElement.doScroll("left")}catch(te){return void setTimeout(je,50)}oe()};var se=oe,Se=je,D=(D=document.getElementsByTagName("script"))[D.length-1],W=D.getAttribute("data-injectcss"),D=D.getAttribute("data-disable-injectsvg");if(!D){var ee,X,E,_e,re,he=function(te,ve){ve.parentNode.insertBefore(te,ve)};if(W&&!$t.__iconfont__svg__cssinject__){$t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(te){console&&console.log(te)}}ee=function(){var te,ve=document.createElement("div");ve.innerHTML=$t._iconfont_svg_string_3580659,(ve=ve.getElementsByTagName("svg")[0])&&(ve.setAttribute("aria-hidden","true"),ve.style.position="absolute",ve.style.width=0,ve.style.height=0,ve.style.overflow="hidden",ve=ve,(te=document.body).firstChild?he(ve,te.firstChild):te.appendChild(ve))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(ee,0):(X=function(){document.removeEventListener("DOMContentLoaded",X,!1),ee()},document.addEventListener("DOMContentLoaded",X,!1)):document.attachEvent&&(E=ee,_e=$t.document,re=!1,je(),_e.onreadystatechange=function(){_e.readyState=="complete"&&(_e.onreadystatechange=null,oe())})}}catch(oe){}}(window)},39827:function($t,W,D){"use strict";D.d(W,{GC:function(){return U},h0:function(){return sn},lv:function(){return jn},lo:function(){return Vt},kw:function(){return en},Or:function(){return xn},KD:function(){return Me},I9:function(){return ue},lE:function(){return Dt},d:function(){return lr},n3:function(){return _h},vY:function(){return Qe},P7:function(){return Bf},yn:function(){return Ut},ee:function(){return Ft},v2:function(){return On},e7:function(){return rl},Hp:function(){return Wh},gl:function(){return re},cO:function(){return yh},Vb:function(){return we}});var ee=D(1413),X=D(4942),E=D(8543);let _e=function(ne){return ne.Normal="normal",ne.PostProcessing="post-processing",ne}({}),re=function(ne){return ne[ne.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",ne[ne.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",ne[ne.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",ne[ne.POINTS=0]="POINTS",ne[ne.LINES=1]="LINES",ne[ne.LINE_LOOP=2]="LINE_LOOP",ne[ne.LINE_STRIP=3]="LINE_STRIP",ne[ne.TRIANGLES=4]="TRIANGLES",ne[ne.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",ne[ne.TRIANGLE_FAN=6]="TRIANGLE_FAN",ne[ne.ZERO=0]="ZERO",ne[ne.ONE=1]="ONE",ne[ne.SRC_COLOR=768]="SRC_COLOR",ne[ne.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",ne[ne.SRC_ALPHA=770]="SRC_ALPHA",ne[ne.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",ne[ne.DST_ALPHA=772]="DST_ALPHA",ne[ne.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",ne[ne.DST_COLOR=774]="DST_COLOR",ne[ne.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",ne[ne.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",ne[ne.FUNC_ADD=32774]="FUNC_ADD",ne[ne.BLEND_EQUATION=32777]="BLEND_EQUATION",ne[ne.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",ne[ne.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",ne[ne.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",ne[ne.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",ne[ne.MAX_EXT=32776]="MAX_EXT",ne[ne.MIN_EXT=32775]="MIN_EXT",ne[ne.BLEND_DST_RGB=32968]="BLEND_DST_RGB",ne[ne.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",ne[ne.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",ne[ne.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",ne[ne.CONSTANT_COLOR=32769]="CONSTANT_COLOR",ne[ne.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",ne[ne.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",ne[ne.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",ne[ne.BLEND_COLOR=32773]="BLEND_COLOR",ne[ne.ARRAY_BUFFER=34962]="ARRAY_BUFFER",ne[ne.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",ne[ne.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",ne[ne.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",ne[ne.STREAM_DRAW=35040]="STREAM_DRAW",ne[ne.STATIC_DRAW=35044]="STATIC_DRAW",ne[ne.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",ne[ne.BUFFER_SIZE=34660]="BUFFER_SIZE",ne[ne.BUFFER_USAGE=34661]="BUFFER_USAGE",ne[ne.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",ne[ne.FRONT=1028]="FRONT",ne[ne.BACK=1029]="BACK",ne[ne.FRONT_AND_BACK=1032]="FRONT_AND_BACK",ne[ne.CULL_FACE=2884]="CULL_FACE",ne[ne.BLEND=3042]="BLEND",ne[ne.DITHER=3024]="DITHER",ne[ne.STENCIL_TEST=2960]="STENCIL_TEST",ne[ne.DEPTH_TEST=2929]="DEPTH_TEST",ne[ne.SCISSOR_TEST=3089]="SCISSOR_TEST",ne[ne.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",ne[ne.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",ne[ne.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",ne[ne.NO_ERROR=0]="NO_ERROR",ne[ne.INVALID_ENUM=1280]="INVALID_ENUM",ne[ne.INVALID_VALUE=1281]="INVALID_VALUE",ne[ne.INVALID_OPERATION=1282]="INVALID_OPERATION",ne[ne.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",ne[ne.CW=2304]="CW",ne[ne.CCW=2305]="CCW",ne[ne.LINE_WIDTH=2849]="LINE_WIDTH",ne[ne.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",ne[ne.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",ne[ne.CULL_FACE_MODE=2885]="CULL_FACE_MODE",ne[ne.FRONT_FACE=2886]="FRONT_FACE",ne[ne.DEPTH_RANGE=2928]="DEPTH_RANGE",ne[ne.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",ne[ne.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",ne[ne.DEPTH_FUNC=2932]="DEPTH_FUNC",ne[ne.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",ne[ne.STENCIL_FUNC=2962]="STENCIL_FUNC",ne[ne.STENCIL_FAIL=2964]="STENCIL_FAIL",ne[ne.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",ne[ne.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",ne[ne.STENCIL_REF=2967]="STENCIL_REF",ne[ne.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",ne[ne.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",ne[ne.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",ne[ne.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",ne[ne.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",ne[ne.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",ne[ne.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",ne[ne.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",ne[ne.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",ne[ne.VIEWPORT=2978]="VIEWPORT",ne[ne.SCISSOR_BOX=3088]="SCISSOR_BOX",ne[ne.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",ne[ne.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",ne[ne.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",ne[ne.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",ne[ne.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",ne[ne.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",ne[ne.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",ne[ne.RED_BITS=3410]="RED_BITS",ne[ne.GREEN_BITS=3411]="GREEN_BITS",ne[ne.BLUE_BITS=3412]="BLUE_BITS",ne[ne.ALPHA_BITS=3413]="ALPHA_BITS",ne[ne.DEPTH_BITS=3414]="DEPTH_BITS",ne[ne.STENCIL_BITS=3415]="STENCIL_BITS",ne[ne.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",ne[ne.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",ne[ne.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",ne[ne.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",ne[ne.SAMPLES=32937]="SAMPLES",ne[ne.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",ne[ne.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",ne[ne.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",ne[ne.DONT_CARE=4352]="DONT_CARE",ne[ne.FASTEST=4353]="FASTEST",ne[ne.NICEST=4354]="NICEST",ne[ne.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",ne[ne.BYTE=5120]="BYTE",ne[ne.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",ne[ne.SHORT=5122]="SHORT",ne[ne.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",ne[ne.INT=5124]="INT",ne[ne.UNSIGNED_INT=5125]="UNSIGNED_INT",ne[ne.FLOAT=5126]="FLOAT",ne[ne.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",ne[ne.ALPHA=6406]="ALPHA",ne[ne.RGB=6407]="RGB",ne[ne.RGBA=6408]="RGBA",ne[ne.LUMINANCE=6409]="LUMINANCE",ne[ne.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",ne[ne.RED=6403]="RED",ne[ne.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",ne[ne.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",ne[ne.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",ne[ne.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",ne[ne.VERTEX_SHADER=35633]="VERTEX_SHADER",ne[ne.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",ne[ne.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",ne[ne.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",ne[ne.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",ne[ne.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",ne[ne.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",ne[ne.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",ne[ne.SHADER_TYPE=35663]="SHADER_TYPE",ne[ne.DELETE_STATUS=35712]="DELETE_STATUS",ne[ne.LINK_STATUS=35714]="LINK_STATUS",ne[ne.VALIDATE_STATUS=35715]="VALIDATE_STATUS",ne[ne.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",ne[ne.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",ne[ne.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",ne[ne.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",ne[ne.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",ne[ne.NEVER=512]="NEVER",ne[ne.LESS=513]="LESS",ne[ne.EQUAL=514]="EQUAL",ne[ne.LEQUAL=515]="LEQUAL",ne[ne.GREATER=516]="GREATER",ne[ne.NOTEQUAL=517]="NOTEQUAL",ne[ne.GEQUAL=518]="GEQUAL",ne[ne.ALWAYS=519]="ALWAYS",ne[ne.KEEP=7680]="KEEP",ne[ne.REPLACE=7681]="REPLACE",ne[ne.INCR=7682]="INCR",ne[ne.DECR=7683]="DECR",ne[ne.INVERT=5386]="INVERT",ne[ne.INCR_WRAP=34055]="INCR_WRAP",ne[ne.DECR_WRAP=34056]="DECR_WRAP",ne[ne.VENDOR=7936]="VENDOR",ne[ne.RENDERER=7937]="RENDERER",ne[ne.VERSION=7938]="VERSION",ne[ne.NEAREST=9728]="NEAREST",ne[ne.LINEAR=9729]="LINEAR",ne[ne.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",ne[ne.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",ne[ne.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",ne[ne.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",ne[ne.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",ne[ne.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",ne[ne.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",ne[ne.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",ne[ne.TEXTURE_2D=3553]="TEXTURE_2D",ne[ne.TEXTURE=5890]="TEXTURE",ne[ne.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",ne[ne.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",ne[ne.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",ne[ne.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",ne[ne.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",ne[ne.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",ne[ne.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",ne[ne.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",ne[ne.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",ne[ne.TEXTURE0=33984]="TEXTURE0",ne[ne.TEXTURE1=33985]="TEXTURE1",ne[ne.TEXTURE2=33986]="TEXTURE2",ne[ne.TEXTURE3=33987]="TEXTURE3",ne[ne.TEXTURE4=33988]="TEXTURE4",ne[ne.TEXTURE5=33989]="TEXTURE5",ne[ne.TEXTURE6=33990]="TEXTURE6",ne[ne.TEXTURE7=33991]="TEXTURE7",ne[ne.TEXTURE8=33992]="TEXTURE8",ne[ne.TEXTURE9=33993]="TEXTURE9",ne[ne.TEXTURE10=33994]="TEXTURE10",ne[ne.TEXTURE11=33995]="TEXTURE11",ne[ne.TEXTURE12=33996]="TEXTURE12",ne[ne.TEXTURE13=33997]="TEXTURE13",ne[ne.TEXTURE14=33998]="TEXTURE14",ne[ne.TEXTURE15=33999]="TEXTURE15",ne[ne.TEXTURE16=34e3]="TEXTURE16",ne[ne.TEXTURE17=34001]="TEXTURE17",ne[ne.TEXTURE18=34002]="TEXTURE18",ne[ne.TEXTURE19=34003]="TEXTURE19",ne[ne.TEXTURE20=34004]="TEXTURE20",ne[ne.TEXTURE21=34005]="TEXTURE21",ne[ne.TEXTURE22=34006]="TEXTURE22",ne[ne.TEXTURE23=34007]="TEXTURE23",ne[ne.TEXTURE24=34008]="TEXTURE24",ne[ne.TEXTURE25=34009]="TEXTURE25",ne[ne.TEXTURE26=34010]="TEXTURE26",ne[ne.TEXTURE27=34011]="TEXTURE27",ne[ne.TEXTURE28=34012]="TEXTURE28",ne[ne.TEXTURE29=34013]="TEXTURE29",ne[ne.TEXTURE30=34014]="TEXTURE30",ne[ne.TEXTURE31=34015]="TEXTURE31",ne[ne.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",ne[ne.REPEAT=10497]="REPEAT",ne[ne.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",ne[ne.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",ne[ne.FLOAT_VEC2=35664]="FLOAT_VEC2",ne[ne.FLOAT_VEC3=35665]="FLOAT_VEC3",ne[ne.FLOAT_VEC4=35666]="FLOAT_VEC4",ne[ne.INT_VEC2=35667]="INT_VEC2",ne[ne.INT_VEC3=35668]="INT_VEC3",ne[ne.INT_VEC4=35669]="INT_VEC4",ne[ne.BOOL=35670]="BOOL",ne[ne.BOOL_VEC2=35671]="BOOL_VEC2",ne[ne.BOOL_VEC3=35672]="BOOL_VEC3",ne[ne.BOOL_VEC4=35673]="BOOL_VEC4",ne[ne.FLOAT_MAT2=35674]="FLOAT_MAT2",ne[ne.FLOAT_MAT3=35675]="FLOAT_MAT3",ne[ne.FLOAT_MAT4=35676]="FLOAT_MAT4",ne[ne.SAMPLER_2D=35678]="SAMPLER_2D",ne[ne.SAMPLER_CUBE=35680]="SAMPLER_CUBE",ne[ne.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",ne[ne.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",ne[ne.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",ne[ne.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",ne[ne.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",ne[ne.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",ne[ne.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",ne[ne.COMPILE_STATUS=35713]="COMPILE_STATUS",ne[ne.LOW_FLOAT=36336]="LOW_FLOAT",ne[ne.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",ne[ne.HIGH_FLOAT=36338]="HIGH_FLOAT",ne[ne.LOW_INT=36339]="LOW_INT",ne[ne.MEDIUM_INT=36340]="MEDIUM_INT",ne[ne.HIGH_INT=36341]="HIGH_INT",ne[ne.FRAMEBUFFER=36160]="FRAMEBUFFER",ne[ne.RENDERBUFFER=36161]="RENDERBUFFER",ne[ne.RGBA4=32854]="RGBA4",ne[ne.RGB5_A1=32855]="RGB5_A1",ne[ne.RGB565=36194]="RGB565",ne[ne.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",ne[ne.STENCIL_INDEX=6401]="STENCIL_INDEX",ne[ne.STENCIL_INDEX8=36168]="STENCIL_INDEX8",ne[ne.DEPTH_STENCIL=34041]="DEPTH_STENCIL",ne[ne.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",ne[ne.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",ne[ne.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",ne[ne.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",ne[ne.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",ne[ne.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",ne[ne.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",ne[ne.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",ne[ne.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",ne[ne.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",ne[ne.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",ne[ne.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",ne[ne.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",ne[ne.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",ne[ne.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",ne[ne.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",ne[ne.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",ne[ne.NONE=0]="NONE",ne[ne.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",ne[ne.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",ne[ne.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",ne[ne.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",ne[ne.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",ne[ne.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",ne[ne.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",ne[ne.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",ne[ne.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",ne[ne.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",ne[ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",ne[ne.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",ne[ne.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",ne[ne.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",ne}({});const he=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:se,isNil:Se,upperFirst:oe}=E.lodashUtil;class je{constructor(){(0,X.Z)(this,"shaderModuleService",void 0),(0,X.Z)(this,"rendererService",void 0),(0,X.Z)(this,"config",void 0),(0,X.Z)(this,"quad",he),(0,X.Z)(this,"enabled",!0),(0,X.Z)(this,"renderToScreen",!1),(0,X.Z)(this,"model",void 0),(0,X.Z)(this,"name",void 0),(0,X.Z)(this,"optionsToUpdate",{})}getName(){return this.name}setName(ge){this.name=ge}getType(){return _e.PostProcessing}init(ge,qe){this.config=qe,this.rendererService=ge.getContainer().rendererService,this.shaderModuleService=ge.getContainer().shaderModuleService;const{createAttribute:mn,createBuffer:K,createModel:tr}=this.rendererService,{vs:Mr,fs:Bi,uniforms:zi}=this.setupShaders();this.model=tr({vs:Mr,fs:Bi,attributes:{a_Position:mn({buffer:K({data:[-4,-4,4,-4,0,4],type:re.FLOAT}),size:2})},uniforms:(0,ee.Z)((0,ee.Z)({u_Texture:null},zi),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(ge,qe){const mn=ge.multiPassRenderer.getPostProcessor(),{useFramebuffer:K,getViewportSize:tr,clear:Mr}=this.rendererService,{width:Bi,height:zi}=tr();K(this.renderToScreen?null:mn.getWriteFBO(),()=>{Mr({framebuffer:mn.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const so=(0,ee.Z)({u_BloomFinal:0,u_Texture:mn.getReadFBO(),u_ViewportSize:[Bi,zi]},this.convertOptionsToUniforms(this.optionsToUpdate));qe&&(so.u_BloomFinal=1,so.u_Texture2=qe),this.model.draw({uniforms:so})})}isEnabled(){return this.enabled}setEnabled(ge){this.enabled=ge}setRenderToScreen(ge){this.renderToScreen=ge}updateOptions(ge){this.optionsToUpdate=(0,ee.Z)((0,ee.Z)({},this.optionsToUpdate),ge)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(ge){const qe={};return Object.keys(ge).forEach(mn=>{Se(ge[mn])||(qe[`u_${oe(se(mn))}`]=ge[mn])}),qe}}function te(ne){let ge=0;switch(ne){case"vec2":case"ivec2":ge=2;break;case"vec3":case"ivec3":ge=3;break;case"vec4":case"ivec4":case"mat2":ge=4;break;case"mat3":ge=9;break;case"mat4":ge=16;break;default:}return ge}const ve=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Be(ne,ge=!1){const qe={};return ne=ne.replace(ve,(mn,K,tr)=>{const Mr=tr.split(":"),Bi=Mr[0].trim();let zi="";switch(Mr.length>1&&(zi=Mr[1].trim()),K){case"bool":zi=zi==="true";break;case"float":case"int":zi=Number(zi);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":zi?zi=zi.replace("[","").replace("]","").split(",").reduce((so,Si)=>(so.push(Number(Si.trim())),so),[]):zi=new Array(te(K)).fill(0);break;default:}return qe[Bi]=zi,`${ge?"uniform ":""}${K} ${Bi};
`}),{content:ne,uniforms:qe}}function Te(ne){let{content:ge,uniforms:qe}=Be(ne,!0);return ge=ge.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(mn,K,tr)=>{tr=tr.trim().replace(/^.*$/gm,zi=>`uniform ${zi}`);const{content:Mr,uniforms:Bi}=Be(tr);return Object.assign(qe,Bi),`${K}{
${Mr}
};`}),{content:ge,uniforms:qe}}function we(ne){const ge={};return ne.replace(ve,(qe,mn,K)=>{const tr=K.trim();return ge[tr]?"":(ge[tr]=!0,`uniform ${mn} ${tr};
`)})}const le=null;function Ze(ne){return le.indexOf(ne)}const{clamp:xt}=E.lodashUtil,ft=2,Zt=4,pt=64,vt=128,ke=256,Re=512,bt=8192,gt=16384,Ct=32768,Sn=null,He=131072,Ot=262144,Ce=524288,ot=1048576,$e=2097152,Xe=4194304,Rt=8388608,_t=16777216,Pe=null;function Wt(ne,ge){return ne=xt(Math.floor(ne),0,255),ge=xt(Math.floor(ge),0,255),256*ne+ge}function on(ne){const{color:ge,radius:qe,tileX:mn,tileY:K,shape:tr,opacity:Mr,stroke:Bi,strokeWidth:zi,strokeOpacity:so}=ne,Si=[],Sa=[],Do=[],ha=[Wt(ge[0],ge[1]),Wt(ge[2],ge[3])],rs=[Wt(Bi[0],Bi[1]),Wt(Bi[2],Bi[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(([ua,Aa])=>{Si.push([...ha,(ua+1)*Rt+(Aa+1)*$e+getShapeIndex(tr)*He+qe,(mn+512)*Ce+(K+512)*pt]),Sa.push([...rs,zi,so]),Do.push([Mr,0,0,0])}),{packedBuffer:Si,packedBuffer2:Sa,packedBuffer3:Do}}function Nn(ne,ge){if(ne===0&&!ge)return 0;if(ne===1&&ge)return 4294967295;const qe=ge?1:0,mn=Math.floor(ne*127);return mn*Pe+qe*_t+mn*He+qe*Sn+mn*Re+qe*ke+mn*ft+qe}const jn={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let lr=function(ne){return ne.TOPRIGHT="topright",ne.TOPLEFT="topleft",ne.BOTTOMRIGHT="bottomright",ne.BOTTOMLEFT="bottomleft",ne.TOPCENTER="topcenter",ne.BOTTOMCENTER="bottomcenter",ne.LEFTCENTER="leftcenter",ne.RIGHTCENTER="rightcenter",ne.LEFTTOP="lefttop",ne.RIGHTTOP="righttop",ne.LEFTBOTTOM="leftbottom",ne.RIGHTBOTTOM="rightbottom",ne}({}),Vt=function(ne){return ne[ne.LNGLAT=1]="LNGLAT",ne[ne.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",ne[ne.VECTOR_TILE=3]="VECTOR_TILE",ne[ne.IDENTITY=4]="IDENTITY",ne[ne.METER_OFFSET=5]="METER_OFFSET",ne}({});const en={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var xn={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let er=function(ne){return ne.Hover="hover",ne.Click="click",ne.Select="select",ne.Active="active",ne.Drag="drag",ne}({}),sn=function(ne){return ne.normal="normal",ne.additive="additive",ne.subtractive="subtractive",ne.min="min",ne.max="max",ne.none="none",ne}({}),Ut=function(ne){return ne.MULTIPLE="MULTIPLE",ne.SINGLE="SINGLE",ne}({}),Dt=function(ne){return ne.AND="and",ne.OR="or",ne}({}),Me=function(ne){return ne.INIT="init",ne.UPDATE="update",ne}({}),Qe=function(ne){return ne.LINEAR="linear",ne.SEQUENTIAL="sequential",ne.POWER="power",ne.LOG="log",ne.IDENTITY="identity",ne.TIME="time",ne.QUANTILE="quantile",ne.QUANTIZE="quantize",ne.THRESHOLD="threshold",ne.CAT="cat",ne.DIVERGING="diverging",ne.CUSTOM="threshold",ne}({}),Ft=function(ne){return ne.CONSTANT="constant",ne.VARIABLE="variable",ne}({}),U=function(ne){return ne[ne.Attribute=0]="Attribute",ne[ne.InstancedAttribute=1]="InstancedAttribute",ne[ne.Uniform=2]="Uniform",ne}({});const ue=["mapload","mapchange","mapAfterFrameChange"];var at=D(49296),ce=D.n(at),j=D(26729),ln=D.n(j);const fn=30;function mt({characterSet:ne,getFontWidth:ge,fontHeight:qe,buffer:mn,maxCanvasWidth:K,mapping:tr={},xOffset:Mr=0,yOffset:Bi=0}){let zi=0,so=Mr;Array.from(ne).forEach((Sa,Do)=>{if(!tr[Sa]){const ha=ge(Sa,Do);so+fn>K&&(so=0,zi++),tr[Sa]={x:so,y:Bi+zi*fn,width:fn,height:fn,advance:ha},so+=fn}});const Si=qe+mn*2;return{mapping:tr,xOffset:so,yOffset:Bi+zi*Si,canvasHeight:hn(Bi+(zi+1)*Si)}}function Gt(ne,ge,qe){let mn=0,K=0,tr=0,Mr=[];const Bi={};for(const so of ne)if(!Bi[so.id]){const{size:Si}=so;mn+Si+ge>qe&&(Wn(Bi,Mr,K),mn=0,K=tr+K+ge,tr=0,Mr=[]),Mr.push({icon:so,xOffset:mn}),mn=mn+Si+ge,tr=Math.max(tr,Si)}Mr.length>0&&Wn(Bi,Mr,K);const zi=hn(tr+K+ge);return{mapping:Bi,canvasHeight:zi}}function Wn(ne,ge,qe){for(const mn of ge){const{icon:K,xOffset:tr}=mn;ne[K.id]=(0,ee.Z)((0,ee.Z)({},K),{},{x:tr,y:qe,image:K.image,width:K.width,height:K.height})}}function hn(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}const ht=$n(),Ht="sans-serif",Cn="normal",Ln=24,Gn=3,dt=.25,ye=8,Fe=1024,nt=1,Pt=1,Mt=3,Tn=null;function $n(){const ne=[];for(let ge=32;ge<128;ge++)ne.push(String.fromCharCode(ge));return ne}function xr(ne,ge,qe,mn){ne.font=`${mn} ${qe}px ${ge}`,ne.fillStyle="black",ne.textBaseline="middle"}function qn(ne,ge){for(let qe=0;qe<ne.length;qe++)ge.data[4*qe+3]=ne[qe]}class Ae extends j.EventEmitter{constructor(...ge){super(...ge),(0,X.Z)(this,"fontAtlas",void 0),(0,X.Z)(this,"iconFontMap",void 0),(0,X.Z)(this,"iconFontGlyphs",{}),(0,X.Z)(this,"fontOptions",void 0),(0,X.Z)(this,"key",void 0),(0,X.Z)(this,"cache",new E.z6(Mt))}get scale(){return Pt}get canvas(){const ge=this.cache.get(this.key);return ge&&ge.data}get mapping(){const ge=this.cache.get(this.key);return ge&&ge.mapping||{}}getCanvasByKey(ge){const qe=this.cache.get(ge);return qe&&qe.data}getMappingByKey(ge){const qe=this.cache.get(ge);return qe&&qe.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:Ht,fontWeight:Cn,characterSet:ht,fontSize:Ln,buffer:Gn,sdf:!0,cutoff:dt,radius:ye,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(ge){ge.forEach(qe=>{this.iconFontGlyphs[qe.name]=qe.unicode})}addIconFont(ge,qe){this.iconFontMap.set(ge,qe)}getIconFontKey(ge){return this.iconFontMap.get(ge)||ge}getGlyph(ge){return this.iconFontGlyphs[ge]?String.fromCharCode(parseInt(this.iconFontGlyphs[ge],16)):""}setFontOptions(ge){this.fontOptions=(0,ee.Z)((0,ee.Z)({},this.fontOptions),ge),this.key=this.getKey();const qe=this.getNewChars(this.key,this.fontOptions.characterSet),mn=this.cache.get(this.key);if(mn&&qe.length===0)return;const K=this.generateFontAtlas(this.key,qe,mn);this.fontAtlas=K,this.cache.set(this.key,K)}addFontFace(ge,qe){const mn=document.createElement("style");mn.type="text/css",mn.innerText=`
        @font-face{
            font-family: '${ge}';
            src: url('${qe}') format('woff2'),
            url('${qe}') format('woff'),
            url('${qe}') format('truetype');
        }`,mn.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${ge}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:ge})})}catch(K){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(K)}},document.getElementsByTagName("head")[0].appendChild(mn)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(ge,qe,mn){const{fontFamily:K,fontWeight:tr,fontSize:Mr,buffer:Bi,sdf:zi,radius:so,cutoff:Si,iconfont:Sa}=this.fontOptions;let Do=mn&&mn.data;Do||(Do=window.document.createElement("canvas"),Do.width=Fe);const ha=Do.getContext("2d",{willReadFrequently:!0});xr(ha,K,Mr,tr);const{mapping:rs,canvasHeight:ua,xOffset:Aa,yOffset:ls}=mt((0,ee.Z)({getFontWidth:Da=>ha.measureText(Da).width,fontHeight:Mr*Pt,buffer:Bi,characterSet:qe,maxCanvasWidth:Fe},mn&&{mapping:mn.mapping,xOffset:mn.xOffset,yOffset:mn.yOffset})),Ma=ha.getImageData(0,0,Do.width,Do.height);if(Do.height=ua,ha.putImageData(Ma,0,0),xr(ha,K,Mr,tr),zi){const Da=new(ce())(Mr,Bi,so,Si,K,tr),Xa=ha.getImageData(0,0,Da.size,Da.size);for(const Ls of qe){if(Sa){const Qa=String.fromCharCode(parseInt(Ls.replace("&#x","").replace(";",""),16)),Ec=Da.draw(Qa);qn(Ec,Xa)}else qn(Da.draw(Ls),Xa);ha.putImageData(Xa,rs[Ls].x,rs[Ls].y)}}else for(const Da of qe)ha.fillText(Da,rs[Da].x,rs[Da].y+Mr*nt);return{xOffset:Aa,yOffset:ls,mapping:rs,data:Do,width:Do.width,height:Do.height}}getKey(){const{fontFamily:ge,fontWeight:qe}=this.fontOptions;return`${ge}_${qe}`}getNewChars(ge,qe){const mn=this.cache.get(ge);if(!mn)return qe;const K=[],tr=mn.mapping,Mr=new Set(Object.keys(tr));return new Set(qe).forEach(zi=>{Mr.has(zi)||K.push(zi)}),K}}var be=D(15861);const Ne=3,et=1024,wt=64;class qt extends j.EventEmitter{constructor(...ge){super(...ge),(0,X.Z)(this,"canvasHeight",128),(0,X.Z)(this,"texture",void 0),(0,X.Z)(this,"canvas",void 0),(0,X.Z)(this,"iconData",void 0),(0,X.Z)(this,"iconMap",void 0),(0,X.Z)(this,"ctx",void 0),(0,X.Z)(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(ge,qe){var mn=this;return(0,be.Z)(function*(){let K=new Image;mn.loadingImageCount++,mn.hasImage(ge)?console.warn("Image Id already exists"):mn.iconData.push({id:ge,size:wt}),mn.updateIconMap(),K=yield mn.loadImage(qe);const tr=mn.iconData.find(Mr=>Mr.id===ge);tr&&(tr.image=K,tr.width=K.width,tr.height=K.height),mn.update()})()}addImageMini(ge,qe,mn){const K=mn.getSceneConfig().canvas;let tr=K.createImage();if(this.loadingImageCount++,this.hasImage(ge))throw new Error("Image Id already exists");this.iconData.push({id:ge,size:wt}),this.updateIconMap(),this.loadImageMini(qe,K).then(Mr=>{tr=Mr;const Bi=this.iconData.find(zi=>zi.id===ge);Bi&&(Bi.image=tr,Bi.width=tr.width,Bi.height=tr.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(ge){return this.iconMap.hasOwnProperty(ge)}removeImage(ge){this.hasImage(ge)&&(this.iconData=this.iconData.filter(qe=>qe.id!==ge),delete this.iconMap[ge],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(ge){return new Promise((qe,mn)=>{if(ge instanceof HTMLImageElement){qe(ge);return}const K=new Image;K.crossOrigin="anonymous",K.onload=()=>{qe(K)},K.onerror=()=>{mn(new Error("Could not load image at "+ge))},K.src=ge instanceof File?URL.createObjectURL(ge):ge})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=et,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(ge=>{const{x:qe,y:mn,image:K,width:tr=64,height:Mr=64}=this.iconMap[ge],zi=Math.max(tr,Mr)/wt,so=Mr/zi,Si=tr/zi;K&&this.ctx.drawImage(K,qe+(wt-Si)/2,mn+(wt-so)/2,Si,so)})}updateIconMap(){const{mapping:ge,canvasHeight:qe}=Gt(this.iconData,Ne,et);this.iconMap=ge,this.canvasHeight=qe}loadImageMini(ge,qe){return new Promise((mn,K)=>{const tr=qe.createImage();tr.crossOrigin="anonymous",tr.onload=()=>{mn(tr)},tr.onerror=()=>{K(new Error("Could not load image at "+ge))},tr.src=ge})}}var vn=D(85975);class yt{constructor(){(0,X.Z)(this,"viewport",void 0),(0,X.Z)(this,"overridedViewProjectionMatrix",void 0),(0,X.Z)(this,"viewMatrixInverse",void 0),(0,X.Z)(this,"cameraPosition",void 0)}init(){}update(ge){this.viewport=ge,this.viewMatrixInverse=vn.create(),vn.invert(this.viewMatrixInverse,ge.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[ge,qe]=this.viewport.getCenter();return[ge,qe]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(ge,qe){return this.viewport.projectFlat(ge,qe)}setViewProjectionMatrix(ge){this.overridedViewProjectionMatrix=ge}}const Jt={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class Qn{constructor(){(0,X.Z)(this,"container",void 0),(0,X.Z)(this,"controlCorners",void 0),(0,X.Z)(this,"controlContainer",void 0),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"controls",[]),(0,X.Z)(this,"unAddControls",[])}init(ge,qe){this.container=ge.container,this.scene=qe,this.mapsService=qe.mapService,this.initControlPos()}addControl(ge,qe){qe.mapService.map?(ge.addTo(this.scene),this.controls.push(ge)):this.unAddControls.push(ge)}getControlByName(ge){return this.controls.find(qe=>qe.controlOption.name===ge)}removeControl(ge){const qe=this.controls.indexOf(ge);return qe>-1&&this.controls.splice(qe,1),ge.remove(),this}addControls(){this.unAddControls.forEach(ge=>{ge.addTo(this.scene),this.controls.push(ge)}),this.unAddControls=[]}destroy(){for(const ge of this.controls)ge.remove();this.controls=[],this.clearControlPos()}initControlPos(){const ge=this.controlCorners={},qe="l7-",mn=this.controlContainer=E.SO.create("div",qe+"control-container",this.container);function K(Mr=[]){const Bi=Mr.map(zi=>qe+zi).join(" ");ge[Mr.filter(zi=>!["row","column"].includes(zi)).join("")]=E.SO.create("div",Bi,mn)}function tr(Mr){return[...Mr.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),Jt[Mr]]}Object.values(lr).forEach(Mr=>{K(tr(Mr))}),this.checkCornerOverlap()}clearControlPos(){for(const ge in this.controlCorners)this.controlCorners[ge]&&E.SO.remove(this.controlCorners[ge]);this.controlContainer&&E.SO.remove(this.controlContainer)}checkCornerOverlap(){const ge=window.MutationObserver;if(ge)for(const qe of Object.keys(this.controlCorners)){const mn=qe.match(/^(top|bottom)(left|right)$/);if(mn){const[,K,tr]=mn,Mr=this.controlCorners[`${K}${tr}`];new ge(([{target:zi}])=>{Mr&&(Mr.style[K]=zi.clientHeight+"px")}).observe(this.controlCorners[`${tr}${K}`],{childList:!0,attributes:!0})}}}}class Er{constructor(){(0,X.Z)(this,"container",void 0),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"markers",[]),(0,X.Z)(this,"markerLayers",[]),(0,X.Z)(this,"unAddMarkers",[]),(0,X.Z)(this,"unAddMarkerLayers",[])}addMarkerLayer(ge){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(ge),ge.addTo(this.scene)):this.unAddMarkerLayers.push(ge)}removeMarkerLayer(ge){ge.destroy(),this.markerLayers.indexOf(ge);const qe=this.markerLayers.indexOf(ge);qe>-1&&this.markerLayers.splice(qe,1)}addMarker(ge){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(ge),ge.addTo(this.scene)):this.unAddMarkers.push(ge)}addMarkers(){this.unAddMarkers.forEach(ge=>{ge.addTo(this.scene),this.markers.push(ge)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(ge=>{this.markerLayers.push(ge),ge.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(ge){ge.remove(),this.markers.indexOf(ge);const qe=this.markers.indexOf(ge);qe>-1&&this.markers.splice(qe,1)}removeAllMarkers(){this.destroy()}init(ge){this.scene=ge,this.mapsService=ge.mapService}destroy(){this.markers.forEach(ge=>{ge.remove()}),this.markers=[],this.markerLayers.forEach(ge=>{ge.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(ge){ge.destroy()}}class Vr{constructor(){(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"popups",[]),(0,X.Z)(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(ge){ge!=null&&ge.isOpen()&&ge.remove();const qe=this.popups.indexOf(ge);qe>-1&&this.popups.splice(qe,1);const mn=this.unAddPopups.indexOf(ge);mn>-1&&this.unAddPopups.splice(mn,1)}destroy(){this.popups.forEach(ge=>ge.remove())}addPopup(ge){ge&&ge.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(qe=>{qe.getOptions().autoClose&&this.removePopup(qe)}),this.isMarkerReady?(ge.addTo(this.scene),this.popups.push(ge)):this.unAddPopups.push(ge),ge.on("close",()=>{this.removePopup(ge)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(ge=>{this.addPopup(ge),this.unAddPopups=[]})}init(ge){this.scene=ge,this.mapsService=ge.mapService}}var kr={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"};const{merge:Ei}=E.lodashUtil,Oi={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},ar={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Dt.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class Kr{constructor(){(0,X.Z)(this,"sceneConfigCache",{}),(0,X.Z)(this,"layerConfigCache",{}),(0,X.Z)(this,"layerAttributeConfigCache",{})}getSceneConfig(ge){return this.sceneConfigCache[ge]}getSceneWarninfo(ge){return kr[ge]}setSceneConfig(ge,qe){this.sceneConfigCache[ge]=(0,ee.Z)((0,ee.Z)({},Oi),qe)}getLayerConfig(ge){return this.layerConfigCache[ge]}setLayerConfig(ge,qe,mn){this.layerConfigCache[qe]=(0,ee.Z)({},Ei({},this.sceneConfigCache[ge],ar,mn))}getAttributeConfig(ge){return this.layerAttributeConfigCache[ge]}setAttributeConfig(ge,qe){this.layerAttributeConfigCache[ge]=(0,ee.Z)((0,ee.Z)({},this.layerAttributeConfigCache[ge]),qe)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}var hi=D(98333);const Qr=Math.PI/180,Io=512,Ii=4003e4;function Fo({latitude:ne=0,zoom:ge=0,scale:qe,highPrecision:mn=!1,flipY:K=!1}){qe=qe!==void 0?qe:Math.pow(2,ge);const tr={},Mr=Io*qe,Bi=Math.cos(ne*Qr),zi=Mr/360,so=zi/Bi,Si=Mr/Ii/Bi;if(tr.pixelsPerMeter=[Si,-Si,Si],tr.metersPerPixel=[1/Si,-1/Si,1/Si],tr.pixelsPerDegree=[zi,-so,Si],tr.degreesPerPixel=[1/zi,-1/so,1/Si],mn){const Sa=Qr*Math.tan(ne*Qr)/Bi,Do=zi*Sa/2,ha=Mr/Ii*Sa,rs=ha/so*Si;tr.pixelsPerDegree2=[0,-Do,ha],tr.pixelsPerMeter2=[rs,0,rs],K&&(tr.pixelsPerDegree2[1]=-tr.pixelsPerDegree2[1],tr.pixelsPerMeter2[1]=-tr.pixelsPerMeter2[1])}return K&&(tr.pixelsPerMeter[1]=-tr.pixelsPerMeter[1],tr.metersPerPixel[1]=-tr.metersPerPixel[1],tr.pixelsPerDegree[1]=-tr.pixelsPerDegree[1],tr.degreesPerPixel[1]=-tr.degreesPerPixel[1]),tr}const _a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class Co{constructor(ge){(0,X.Z)(this,"needRefresh",!0),(0,X.Z)(this,"coordinateSystem",void 0),(0,X.Z)(this,"viewportCenter",void 0),(0,X.Z)(this,"viewportCenterProjection",void 0),(0,X.Z)(this,"pixelsPerDegree",void 0),(0,X.Z)(this,"pixelsPerDegree2",void 0),(0,X.Z)(this,"pixelsPerMeter",void 0),this.cameraService=ge}refresh(ge){const qe=this.cameraService.getZoom(),mn=ge||this.cameraService.getCenter(),{pixelsPerMeter:K,pixelsPerDegree:tr}=Fo({latitude:mn[1],zoom:qe});this.viewportCenter=mn,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=K,this.pixelsPerDegree=tr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Vt.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Vt.LNGLAT_OFFSET&&this.calculateLnglatOffset(mn,qe),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(ge){this.coordinateSystem=ge}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(ge,qe,mn,K){const{pixelsPerMeter:tr,pixelsPerDegree:Mr,pixelsPerDegree2:Bi}=Fo({latitude:ge[1],zoom:qe,scale:mn,flipY:K,highPrecision:!0});let zi=this.cameraService.getViewMatrix();const so=this.cameraService.getProjectionMatrix();let Si=vn.multiply([],so,zi);const Sa=this.cameraService.projectFlat([Math.fround(ge[0]),Math.fround(ge[1])],Math.pow(2,qe));this.viewportCenterProjection=hi.fF([],[Sa[0],Sa[1],0,1],Si),zi=this.cameraService.getViewMatrixUncentered()||zi,Si=vn.multiply([],so,zi),Si=vn.multiply([],Si,_a),this.cameraService.setViewProjectionMatrix(Si),this.pixelsPerMeter=tr,this.pixelsPerDegree=Mr,this.pixelsPerDegree2=Bi}}class Qo extends j.EventEmitter{constructor(...ge){super(...ge),(0,X.Z)(this,"renderMap",new Map),(0,X.Z)(this,"enable",!1),(0,X.Z)(this,"renderEnable",!1),(0,X.Z)(this,"cacheLogs",{})}setEnable(ge){this.enable=!!ge}log(ge,qe){if(!this.enable)return;const mn=ge.split(".");let K=null;mn.forEach((tr,Mr)=>{K!==null?(K[tr]||(K[tr]={}),Mr!==mn.length-1&&(K=K[tr])):(this.cacheLogs[tr]||(this.cacheLogs[tr]={}),Mr!==mn.length-1&&(K=this.cacheLogs[tr])),Mr===mn.length-1&&(K[tr]=(0,ee.Z)((0,ee.Z)({time:Date.now()},K[tr]),qe))})}getLog(ge){switch(typeof ge){case"string":return this.cacheLogs[ge];case"object":return ge.map(qe=>this.cacheLogs[qe]).filter(qe=>qe!==void 0);case"undefined":return this.cacheLogs}}removeLog(ge){delete this.cacheLogs[ge]}generateRenderUid(){return this.renderEnable?(0,E.M8)():""}renderDebug(ge){this.renderEnable=ge}renderStart(ge){if(!this.renderEnable||!this.enable)return;const qe=this.renderMap.get(ge)||{};this.renderMap.set(ge,(0,ee.Z)((0,ee.Z)({},qe),{},{renderUid:ge,renderStart:Date.now()}))}renderEnd(ge){if(!this.renderEnable||!this.enable)return;const qe=this.renderMap.get(ge);if(qe){const mn=qe.renderStart,K=Date.now();this.emit("renderEnd",(0,ee.Z)((0,ee.Z)({},qe),{},{renderEnd:K,renderDuration:K-mn})),this.renderMap.delete(ge)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var De=D(50840),Je=D.n(De);const kt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class un extends ln(){get mapService(){return this.container.mapService}constructor(ge){super(),(0,X.Z)(this,"indragging",!1),(0,X.Z)(this,"hammertime",void 0),(0,X.Z)(this,"lastClickTime",0),(0,X.Z)(this,"lastClickXY",[-1,-1]),(0,X.Z)(this,"clickTimer",void 0),(0,X.Z)(this,"$containter",void 0),(0,X.Z)(this,"onDrag",qe=>{const mn=this.interactionEvent(qe);mn.type=kt[mn.type],mn.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(er.Drag,mn)}),(0,X.Z)(this,"onHammer",qe=>{qe.srcEvent.stopPropagation();const mn=this.interactionEvent(qe);this.emit(er.Hover,mn)}),(0,X.Z)(this,"onTouch",qe=>{const mn=qe.touches[0];this.onHover({clientX:mn.clientX,clientY:mn.clientY,type:"touchstart"})}),(0,X.Z)(this,"onTouchEnd",qe=>{if(qe.changedTouches.length>0){const mn=qe.changedTouches[0];this.onHover({clientX:mn.clientX,clientY:mn.clientY,type:"touchend"})}}),(0,X.Z)(this,"onTouchMove",qe=>{const mn=qe.changedTouches[0];this.onHover({clientX:mn.clientX,clientY:mn.clientY,type:"touchmove"})}),(0,X.Z)(this,"onHover",qe=>{const{clientX:mn,clientY:K}=qe;let tr=mn,Mr=K;const Bi=qe.type,zi=this.mapService.getMapContainer();if(zi){const{top:Si,left:Sa}=zi.getBoundingClientRect();tr=tr-Sa-zi.clientLeft,Mr=Mr-Si-zi.clientTop}const so=this.mapService.containerToLngLat([tr,Mr]);if(Bi==="click"){this.isDoubleTap(tr,Mr,so);return}if(Bi==="touch"){this.isDoubleTap(tr,Mr,so);return}Bi!=="click"&&Bi!=="dblclick"&&this.emit(er.Hover,{x:tr,y:Mr,lngLat:so,type:Bi,target:qe})}),this.container=ge}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(er.Hover)}triggerHover({x:ge,y:qe}){this.emit(er.Hover,{x:ge,y:qe})}triggerSelect(ge){this.emit(er.Select,{featureId:ge})}triggerActive(ge){this.emit(er.Active,{featureId:ge})}addEventListenerOnMap(){const ge=this.mapService.getMapContainer();if(ge){const qe=new(Je()).Manager(ge);qe.add(new(Je()).Tap({event:"dblclick",taps:2})),qe.add(new(Je()).Tap({event:"click"})),qe.add(new(Je()).Pan({threshold:0,pointers:0})),qe.add(new(Je()).Press({})),qe.on("dblclick click",this.onHammer),qe.on("panstart panmove panend pancancel",this.onDrag),ge.addEventListener("touchstart",this.onTouch),ge.addEventListener("touchend",this.onTouchEnd),ge.addEventListener("mousemove",this.onHover),ge.addEventListener("touchmove",this.onTouchMove),ge.addEventListener("mousedown",this.onHover,!0),ge.addEventListener("mouseup",this.onHover),ge.addEventListener("contextmenu",this.onHover),this.hammertime=qe}}removeEventListenerOnMap(){const ge=this.mapService.getMapContainer();ge&&(ge.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),ge.removeEventListener("touchstart",this.onTouch),ge.removeEventListener("touchend",this.onTouchEnd),ge.removeEventListener("mousedown",this.onHover),ge.removeEventListener("mouseup",this.onHover),ge.removeEventListener("contextmenu",this.onHover))}interactionEvent(ge){const{type:qe,pointerType:mn}=ge;let K,tr;mn==="touch"?(tr=Math.floor(ge.pointers[0].clientY),K=Math.floor(ge.pointers[0].clientX)):(tr=Math.floor(ge.srcEvent.y),K=Math.floor(ge.srcEvent.x));const Mr=this.mapService.getMapContainer();if(Mr){const{top:zi,left:so}=Mr.getBoundingClientRect();K-=so,tr-=zi}const Bi=this.mapService.containerToLngLat([K,tr]);return{x:K,y:tr,lngLat:Bi,type:qe,target:ge.srcEvent}}isDoubleTap(ge,qe,mn){const K=new Date().getTime();let tr="click";K-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-ge)<10&&Math.abs(this.lastClickXY[1]-qe)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),tr="dblclick",this.emit(er.Hover,{x:ge,y:qe,lngLat:mn,type:tr})):(this.lastClickTime=K,this.lastClickXY=[ge,qe],this.clickTimer=setTimeout(()=>{tr="click",this.emit(er.Hover,{x:ge,y:qe,lngLat:mn,type:tr})},400))}}let Bn=0;function kn(ne){let ge=ne;if(typeof ne=="string"&&(ge=document.getElementById(ne)),ge){const qe=document.createElement("div");return qe.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,qe.id=`l7-scene-${Bn++}`,qe.classList.add("l7-scene"),ge.appendChild(qe),qe}return null}function pn(ne){var ge;let qe=!0;if((ne==null||(ge=ne.target)===null||ge===void 0?void 0:ge.target)instanceof HTMLElement){var mn;let tr=ne==null||(mn=ne.target)===null||mn===void 0?void 0:mn.target;for(;tr;){var K;const Mr=Array.from(tr.classList);if(Mr.includes("l7-marker")||Mr.includes("l7-popup")){qe=!1;break}tr=(K=tr)===null||K===void 0?void 0:K.parentElement}}return qe}let On=function(ne){return ne[ne.SAMPLED=0]="SAMPLED",ne[ne.RENDER_TARGET=1]="RENDER_TARGET",ne}({});class vr{constructor(ge){var qe=this;(0,X.Z)(this,"pickedColors",void 0),(0,X.Z)(this,"pickedTileLayers",[]),(0,X.Z)(this,"pickingFBO",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),(0,X.Z)(this,"alreadyInPicking",!1),(0,X.Z)(this,"pickBufferScale",1),(0,X.Z)(this,"pickFromPickingFBO",function(){var mn=(0,be.Z)(function*(K,{x:tr,y:Mr,lngLat:Bi,type:zi,target:so}){var Si;let Sa=!1;const{readPixels:Do,readPixelsAsync:ha,getViewportSize:rs,queryVerdorInfo:ua}=qe.rendererService,{width:Aa,height:ls}=rs(),{enableHighlight:Ma,enableSelect:Da}=K.getLayerConfig(),Xa=tr*E.SO.DPR,Ls=Mr*E.SO.DPR;if(Xa>Aa-1*E.SO.DPR||Xa<0||Ls>ls-1*E.SO.DPR||Ls<0)return!1;let Qa;if(ua()==="WebGPU"?Qa=yield ha({x:Math.floor(Xa/qe.pickBufferScale),y:Math.floor((ls-(Mr+1)*E.SO.DPR)/qe.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:qe.pickingFBO}):Qa=Do({x:Math.floor(Xa/qe.pickBufferScale),y:Math.floor((ls-(Mr+1)*E.SO.DPR)/qe.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:qe.pickingFBO}),qe.pickedColors=Qa,Qa[0]!==0||Qa[1]!==0||Qa[2]!==0){const cs=(0,E.W0)(Qa),Bu=K.layerPickService.getFeatureById(cs);cs!==K.getCurrentPickId()&&zi==="mousemove"&&(zi="mouseenter");const bu={x:tr,y:Mr,type:zi,lngLat:Bi,featureId:cs,feature:Bu,target:so};Bu&&(Sa=!0,K.setCurrentPickId(cs),qe.triggerHoverOnLayer(K,bu))}else{const cs={x:tr,y:Mr,lngLat:Bi,type:K.getCurrentPickId()!==null&&zi==="mousemove"?"mouseout":"un"+zi,featureId:null,target:so,feature:null};qe.triggerHoverOnLayer(K,(0,ee.Z)((0,ee.Z)({},cs),{},{type:"unpick"})),qe.triggerHoverOnLayer(K,cs),K.setCurrentPickId(null)}if(Ma&&K.layerPickService.highlightPickedFeature(Qa),Da&&zi==="click"&&((Si=Qa)===null||Si===void 0?void 0:Si.toString())!==[0,0,0,0].toString()){const cs=(0,E.W0)(Qa);K.getCurrentSelectedId()===null||cs!==K.getCurrentSelectedId()?(K.layerPickService.selectFeature(Qa),K.setCurrentSelectedId(cs)):(K.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),K.setCurrentSelectedId(null))}return Sa});return function(K,tr){return mn.apply(this,arguments)}}()),this.container=ge}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(ge){const{createTexture2D:qe,createFramebuffer:mn,getViewportSize:K}=this.rendererService;let{width:tr,height:Mr}=K();this.pickBufferScale=this.configService.getSceneConfig(ge).pickBufferScale||1,tr=Math.round(tr/this.pickBufferScale),Mr=Math.round(Mr/this.pickBufferScale);const Bi=qe({width:tr,height:Mr,usage:On.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=mn({color:Bi,depth:!0,width:tr,height:Mr}),this.interactionService.on(er.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(ge,qe,mn){var K=this;return(0,be.Z)(function*(){const{useFramebufferAsync:tr,clear:Mr}=K.rendererService;K.resizePickingFBO(),ge.hooks.beforePickingEncode.call(),yield tr(K.pickingFBO,(0,be.Z)(function*(){Mr({framebuffer:K.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),ge.renderModels({ispick:!0})})),ge.hooks.afterPickingEncode.call();const Bi=yield K.pickBox(ge,qe);mn(Bi)})()}pickBox(ge,qe){var mn=this;return(0,be.Z)(function*(){const[K,tr,Mr,Bi]=qe.map(ls=>{const Ma=ls<0?0:ls;return Math.floor(Ma*E.SO.DPR/mn.pickBufferScale)}),{readPixelsAsync:zi,getViewportSize:so}=mn.rendererService,{width:Si,height:Sa}=so();if(K>(Si-1)*E.SO.DPR/mn.pickBufferScale||Mr<0||tr>(Sa-1)*E.SO.DPR/mn.pickBufferScale||Bi<0)return[];const Do=Math.min(Si/mn.pickBufferScale,Mr)-K,ha=Math.min(Sa/mn.pickBufferScale,Bi)-tr,rs=yield zi({x:K,y:Math.floor(Sa/mn.pickBufferScale-(Bi+1)),width:Do,height:ha,data:new Uint8Array(Do*ha*4),framebuffer:mn.pickingFBO}),ua=[],Aa={};for(let ls=0;ls<rs.length/4;ls=ls+1){const Ma=rs.slice(ls*4,ls*4+4),Da=(0,E.W0)(Ma);if(Da!==-1&&!Aa[Da]){const Xa=ge.layerPickService.getFeatureById(Da);ua.push((0,ee.Z)((0,ee.Z)({},Xa),{},{pickedFeatureIdx:Da})),Aa[Da]=!0}}return ua})()}handleCursor(ge,qe){const{cursor:mn="",cursorEnabled:K}=ge.getLayerConfig();if(K){const Mr=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),Bi=Mr==null?void 0:Mr.style.getPropertyValue("cursor");qe==="unmousemove"&&Bi!==""?Mr==null||Mr.style.setProperty("cursor",""):qe==="mousemove"&&(Mr==null||Mr.style.setProperty("cursor",mn))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(ge){var qe=this;return(0,be.Z)(function*(){!qe.layerService.needPick(ge.type)||!qe.isPickingAllLayer()||(qe.alreadyInPicking=!0,yield qe.pickingLayers(ge),qe.layerService.renderLayers(),qe.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:ge}=this.rendererService,{width:qe,height:mn}=ge();(this.width!==qe||this.height!==mn)&&(this.pickingFBO.resize({width:Math.round(qe/this.pickBufferScale),height:Math.round(mn/this.pickBufferScale)}),this.width=qe,this.height=mn)}pickingLayers(ge){var qe=this;return(0,be.Z)(function*(){const{clear:mn,useFramebufferAsync:K}=qe.rendererService;qe.resizePickingFBO();const tr=qe.layerService.getRenderList();for(const Mr of tr.filter(Bi=>Bi.needPick(ge.type)).reverse()){yield K(qe.pickingFBO,(0,be.Z)(function*(){mn({framebuffer:qe.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Mr.layerPickService.pickRender(ge)}));const Bi=yield qe.pickFromPickingFBO(Mr,ge);if(qe.layerService.pickedLayerId=Bi?+Mr.id:-1,Bi&&!Mr.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(ge,qe){pn(qe)&&(this.handleCursor(ge,qe.type),ge.emit(qe.type,qe))}}class fr{constructor(ge=!0){(0,X.Z)(this,"autoStart",void 0),(0,X.Z)(this,"startTime",0),(0,X.Z)(this,"oldTime",0),(0,X.Z)(this,"running",!1),(0,X.Z)(this,"elapsedTime",0),this.autoStart=ge}start(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let ge=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const qe=(typeof performance=="undefined"?Date:performance).now();ge=(qe-this.oldTime)/1e3,this.oldTime=qe,this.elapsedTime+=ge}return ge}}const{throttle:ci}=E.lodashUtil;class Gi extends j.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(ge){super(),(0,X.Z)(this,"pickedLayerId",-1),(0,X.Z)(this,"clock",new fr),(0,X.Z)(this,"alreadyInRendering",!1),(0,X.Z)(this,"layers",[]),(0,X.Z)(this,"layerList",[]),(0,X.Z)(this,"layerRenderID",void 0),(0,X.Z)(this,"sceneInited",!1),(0,X.Z)(this,"animateInstanceCount",0),(0,X.Z)(this,"shaderPicking",!0),(0,X.Z)(this,"enableRender",!0),(0,X.Z)(this,"reRender",ci(()=>{this.renderLayers()},32)),(0,X.Z)(this,"throttleRenderLayers",ci(()=>{this.renderLayers()},16)),this.container=ge}needPick(ge){return this.updateLayerRenderList(),this.layerList.some(qe=>qe.needPick(ge))}add(ge){this.layers.push(ge),this.sceneInited&&ge.init().then(()=>{this.renderLayers()})}addMask(ge){this.sceneInited&&ge.init().then(()=>{this.renderLayers()})}initLayers(){var ge=this;return(0,be.Z)(function*(){ge.sceneInited=!0,ge.layers.forEach(function(){var qe=(0,be.Z)(function*(mn){mn.startInit||(yield mn.init(),ge.updateLayerRenderList())});return function(mn){return qe.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(ge){return this.layers.find(qe=>qe.id===ge)}getLayerByName(ge){return this.layers.find(qe=>qe.name===ge)}remove(ge,qe){var mn=this;return(0,be.Z)(function*(){qe?qe.layerChildren=qe.layerChildren.filter(K=>K!==ge):mn.layers=mn.layers.filter(K=>K!==ge),ge.destroy(),mn.reRender(),mn.emit("layerChange",mn.layers)})()}removeAllLayers(){var ge=this;return(0,be.Z)(function*(){ge.destroy(),ge.reRender()})()}setEnableRender(ge){this.enableRender=ge}renderLayers(){var ge=this;return(0,be.Z)(function*(){if(ge.alreadyInRendering||!ge.enableRender)return;ge.updateLayerRenderList();const qe=ge.debugService.generateRenderUid();ge.debugService.renderStart(qe),ge.alreadyInRendering=!0,ge.clear();for(const mn of ge.layerList)mn.prerender();ge.renderService.beginFrame();for(const mn of ge.layerList){const{enableMask:K}=mn.getLayerConfig();mn.masks.filter(tr=>tr.inited).length>0&&K&&ge.renderMask(mn.masks),mn.getLayerConfig().enableMultiPassRenderer?yield mn.renderMultiPass():mn.render()}ge.renderService.endFrame(),ge.debugService.renderEnd(qe),ge.alreadyInRendering=!1})()}renderMask(ge){let qe=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const mn=ge.length>1?Ut.MULTIPLE:Ut.SINGLE;for(const K of ge)K.render({isStencil:!0,stencilType:mn,stencilIndex:qe++})}beforeRenderData(ge){var qe=this;return(0,be.Z)(function*(){(yield ge.hooks.beforeRenderData.promise())&&qe.renderLayers()})()}renderTileLayerMask(ge){let qe=0;const{enableMask:mn=!0}=ge.getLayerConfig();let K=ge.tileMask?1:0;const tr=ge.masks.filter(Bi=>Bi.inited);K=K+(mn?tr.length:1);const Mr=K>1?Ut.MULTIPLE:Ut.SINGLE;if((ge.tileMask||tr.length&&mn)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),tr.length&&mn)for(const Bi of tr)Bi.render({isStencil:!0,stencilType:Mr,stencilIndex:qe++});ge.tileMask&&ge.tileMask.render({isStencil:!0,stencilType:Mr,stencilIndex:qe++,stencilOperation:Dt.OR})}renderTileLayer(ge){var qe=this;return(0,be.Z)(function*(){qe.renderTileLayerMask(ge),ge.getLayerConfig().enableMultiPassRenderer?yield ge.renderMultiPass():yield ge.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(ge=>ge.inited).filter(ge=>ge.isVisible()).sort((ge,qe)=>ge.zIndex-qe.zIndex).forEach(ge=>{this.layerList.push(ge)})}destroy(){this.layers.forEach(ge=>{ge.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const ge=(0,E.CI)(this.mapService.bgColor);this.renderService.clear({color:ge,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}var no=D(45987);const{isNil:Jr}=E.lodashUtil;class ji{constructor(ge){(0,X.Z)(this,"name",void 0),(0,X.Z)(this,"type",void 0),(0,X.Z)(this,"scale",void 0),(0,X.Z)(this,"descriptor",void 0),(0,X.Z)(this,"featureBufferLayout",[]),(0,X.Z)(this,"needRescale",!1),(0,X.Z)(this,"needRemapping",!1),(0,X.Z)(this,"needRegenerateVertices",!1),(0,X.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,X.Z)(this,"vertexAttribute",void 0),(0,X.Z)(this,"defaultCallback",qe=>{if(qe.length===0){var mn;return((mn=this.scale)===null||mn===void 0?void 0:mn.defaultValues)||[]}return qe.map((K,tr)=>{var Mr;return((Mr=this.scale)===null||Mr===void 0?void 0:Mr.scalers[tr].func)(K)})}),this.setProps(ge)}setProps(ge){Object.assign(this,ge)}mapping(ge){var qe;if((qe=this.scale)!==null&&qe!==void 0&&qe.callback){var mn;const K=(mn=this.scale)===null||mn===void 0?void 0:mn.callback(...ge);if(!Jr(K))return[K]}return this.defaultCallback(ge)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const Di=["buffer","update","name"],Gr=["buffer","update","name"],fo={[re.FLOAT]:4,[re.UNSIGNED_BYTE]:1,[re.UNSIGNED_SHORT]:2};class Ri{constructor(ge){(0,X.Z)(this,"attributesAndIndices",void 0),(0,X.Z)(this,"attributes",[]),(0,X.Z)(this,"triangulation",void 0),(0,X.Z)(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=ge}registerStyleAttribute(ge){let qe=this.getLayerStyleAttribute(ge.name||"");return qe?qe.setProps(ge):(qe=new ji(ge),this.attributes.push(qe)),qe}unRegisterStyleAttribute(ge){const qe=this.attributes.findIndex(mn=>mn.name===ge);qe>-1&&this.attributes.splice(qe,1)}updateScaleAttribute(ge){this.attributes.forEach(qe=>{var mn;const K=qe.name,tr=(mn=qe.scale)===null||mn===void 0?void 0:mn.field;(ge[K]||tr&&ge[tr])&&(qe.needRescale=!0,qe.needRemapping=!0,qe.needRegenerateVertices=!0)})}updateStyleAttribute(ge,qe,mn){let K=this.getLayerStyleAttribute(ge);K||(K=this.registerStyleAttribute((0,ee.Z)((0,ee.Z)({},qe),{},{name:ge})));const{scale:tr}=qe;tr&&K&&(K.scale=tr,K.needRescale=!0,K.needRemapping=!0,K.needRegenerateVertices=!0,mn&&mn.featureRange&&(K.featureRange=mn.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(ge){return this.attributes.find(qe=>qe.name===ge)}getLayerAttributeScale(ge){var qe;const mn=this.getLayerStyleAttribute(ge),K=mn==null||(qe=mn.scale)===null||qe===void 0?void 0:qe.scalers;return K&&K[0]?K[0].func:null}updateAttributeByFeatureRange(ge,qe,mn=0,K,tr){const Mr=this.attributes.find(Bi=>Bi.name===ge);if(Mr&&Mr.descriptor){const{descriptor:Bi}=Mr,{update:zi,buffer:so,size:Si=0}=Bi,Sa=fo[so.type||re.FLOAT];if(zi){const{elements:Do,sizePerElement:ha}=this.featureLayout,rs=Do.slice(mn,K);if(!rs.length)return;const{offset:ua}=rs[0],Aa=ua*Si*Sa,ls=rs.map(({featureIdx:Ma,vertices:Da,normals:Xa},Ls)=>{const Qa=Da.length/ha,Ec=[];for(let cs=0;cs<Qa;cs++){const Bu=Xa?Xa.slice(cs*3,cs*3+3):[];Ec.push(...zi(qe[Ma],Ma,Da.slice(cs*ha,cs*ha+ha),Ls,Bu))}return Ec}).flat();Mr.vertexAttribute.updateBuffer({data:ls,offset:Aa}),tr==null||tr.emit(`legend:${ge}`,tr.getLegend(ge))}}}createAttributesAndIndices(ge,qe,mn,K){this.featureLayout={sizePerElement:0,elements:[]},qe&&(this.triangulation=qe);const tr=this.attributes.map(ua=>(ua.resetDescriptor(),ua.descriptor));let Mr=0,Bi=0;const zi=[];let so=3;ge.forEach((ua,Aa)=>{const{indices:ls,vertices:Ma,normals:Da,size:Xa,indexes:Ls,count:Qa}=this.triangulation(ua,mn);typeof Qa=="number"&&(Bi+=Qa),ls.forEach(cs=>{zi.push(cs+Mr)}),so=Xa;const Ec=Ma.length/Xa;this.featureLayout.sizePerElement=so,this.featureLayout.elements.push({featureIdx:Aa,vertices:Ma,normals:Da,offset:Mr}),Mr+=Ec;for(let cs=0;cs<Ec;cs++){const Bu=(Da==null?void 0:Da.slice(cs*3,cs*3+3))||[],bu=Ma.slice(cs*Xa,cs*Xa+Xa);let Nc=0;Ls&&Ls[cs]!==void 0&&(Nc=Ls[cs]),tr.forEach((Qf,xd)=>{Qf&&Qf.update&&Qf.buffer.data.push(...Qf.update(ua,Aa,bu,cs,Bu,Nc))})}});const{createAttribute:Si,createBuffer:Sa,createElements:Do}=this.rendererService,ha={};tr.forEach((ua,Aa)=>{if(ua){const{buffer:ls,update:Ma,name:Da}=ua,Xa=(0,no.Z)(ua,Di),Ls=Si((0,ee.Z)({buffer:Sa(ls)},Xa));ha[ua.name||""]=Ls,this.attributes[Aa].vertexAttribute=Ls}});const rs=Do({data:zi,type:re.UNSIGNED_INT,count:zi.length});return this.attributesAndIndices={attributes:ha,elements:rs,count:Bi},Object.values(this.attributes).filter(ua=>ua.scale).forEach(ua=>{const Aa=ua.name;K==null||K.emit(`legend:${Aa}`,K.getLegend(Aa))}),this.attributesAndIndices}createAttributes(ge,qe){this.featureLayout={sizePerElement:0,elements:[]},qe&&(this.triangulation=qe);const mn=this.attributes.map(Si=>(Si.resetDescriptor(),Si.descriptor));let K=0;const tr=[];let Mr=3;ge.forEach((Si,Sa)=>{const{indices:Do,vertices:ha,normals:rs,size:ua,indexes:Aa}=this.triangulation(Si);Do.forEach(Ma=>{tr.push(Ma+K)}),Mr=ua;const ls=ha.length/ua;this.featureLayout.sizePerElement=Mr,this.featureLayout.elements.push({featureIdx:Sa,vertices:ha,normals:rs,offset:K}),K+=ls;for(let Ma=0;Ma<ls;Ma++){const Da=(rs==null?void 0:rs.slice(Ma*3,Ma*3+3))||[],Xa=ha.slice(Ma*ua,Ma*ua+ua);let Ls=0;Aa&&Aa[Ma]!==void 0&&(Ls=Aa[Ma]),mn.forEach((Qa,Ec)=>{Qa&&Qa.update&&Qa.buffer.data.push(...Qa.update(Si,Sa,Xa,Ma,Da,Ls))})}});const{createAttribute:Bi,createBuffer:zi}=this.rendererService,so={};return mn.forEach((Si,Sa)=>{if(Si){const{buffer:Do,update:ha,name:rs}=Si,ua=(0,no.Z)(Si,Gr),Aa=Bi((0,ee.Z)({buffer:zi(Do)},ua));so[Si.name||""]=Aa,this.attributes[Sa].vertexAttribute=Aa}}),{attributes:so}}clearAllAttributes(){var ge;this.attributes.forEach(qe=>{qe.vertexAttribute&&qe.vertexAttribute.destroy()}),(ge=this.attributesAndIndices)===null||ge===void 0||ge.elements.destroy(),this.attributes=[]}}var bo=D(46343),xi=D(63844),wo=D.n(xi);class ia extends j.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(ge){super(),(0,X.Z)(this,"destroyed",!1),(0,X.Z)(this,"loaded",!1),(0,X.Z)(this,"id",void 0),(0,X.Z)(this,"inited",!1),(0,X.Z)(this,"rendering",!1),(0,X.Z)(this,"$container",void 0),(0,X.Z)(this,"canvas",void 0),(0,X.Z)(this,"markerContainer",void 0),(0,X.Z)(this,"resizeDetector",void 0),(0,X.Z)(this,"hooks",void 0),(0,X.Z)(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),(0,X.Z)(this,"handleMapCameraChanged",qe=>{this.cameraService.update(qe),this.render()}),this.container=ge,this.hooks={init:new bo.sX},this.id=ge.id}init(ge){var qe=this;this.configService.setSceneConfig(this.id,ge),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,be.Z)(function*(){qe.debugService.log("map.mapInitStart",{type:qe.map.version}),yield new Promise(mn=>{qe.map.onCameraChanged(K=>{qe.cameraService.init(),qe.cameraService.update(K),mn()}),qe.map.init()}),qe.map.onCameraChanged(qe.handleMapCameraChanged),qe.map.addMarkerContainer(),qe.markerService.addMarkers(),qe.markerService.addMarkerLayers(),qe.popupService.initPopup(),qe.interactionService.init(),qe.interactionService.on(er.Drag,qe.addSceneEvent.bind(qe))})),this.hooks.init.tapPromise("initRenderer",(0,be.Z)(function*(){var mn;const K=((mn=qe.map)===null||mn===void 0?void 0:mn.getOverlayContainer())||void 0;if(K?qe.$container=K:qe.$container=kn(qe.configService.getSceneConfig(qe.id).id||""),qe.$container){const{canvas:Mr}=ge;if(qe.canvas=Mr||E.SO.create("canvas","",qe.$container),qe.setCanvas(),yield qe.rendererService.init(qe.canvas,qe.configService.getSceneConfig(qe.id),ge.gl),qe.registerContextLost(),qe.initContainer(),qe.resizeDetector=wo()({strategy:"scroll"}),qe.resizeDetector.listenTo(qe.$container,qe.handleWindowResized),window.matchMedia){var tr;(tr=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||tr===void 0||tr.addListener(qe.handleWindowResized.bind("screen"))}}else console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");qe.pickingService.init(qe.id)})),this.render()}registerContextLost(){const ge=this.rendererService.getCanvas();ge&&ge.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(ge){this.layerService.sceneService=this,this.layerService.add(ge)}addMask(ge){this.layerService.sceneService=this,this.layerService.addMask(ge)}render(){var ge=this;return(0,be.Z)(function*(){ge.rendering||ge.destroyed||(ge.rendering=!0,ge.inited?(yield ge.layerService.initLayers(),yield ge.layerService.renderLayers()):(yield ge.hooks.init.promise(),ge.destroyed&&ge.destroy(),yield ge.layerService.initLayers(),ge.layerService.renderLayers(),ge.controlService.addControls(),ge.loaded=!0,ge.emit("loaded"),ge.inited=!0),ge.rendering=!1)})()}addFontFace(ge,qe){this.fontService.addFontFace(ge,qe)}getSceneContainer(){return this.$container}exportPng(ge){var qe=this;return(0,be.Z)(function*(){var mn;const K=(mn=qe.$container)===null||mn===void 0?void 0:mn.getElementsByTagName("canvas")[0];return yield qe.render(),ge==="jpg"?K==null?void 0:K.toDataURL("image/jpeg"):K==null?void 0:K.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const ge=this.$container.parentElement;ge!==null&&(this.markerContainer=E.SO.create("div","l7-marker-container",ge))}getMarkerContainer(){return this.markerContainer}destroy(){var ge;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var qe;(qe=this.$container)===null||qe===void 0||qe.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(ge=this.$container)===null||ge===void 0||(ge=ge.parentNode)===null||ge===void 0||ge.removeChild(this.$container),this.emit("destroy")}initContainer(){var ge,qe;const mn=E.SO.DPR,K=((ge=this.$container)===null||ge===void 0?void 0:ge.clientWidth)||400,tr=((qe=this.$container)===null||qe===void 0?void 0:qe.clientHeight)||300,Mr=this.canvas;Mr&&(Mr.width=K*mn,Mr.height=tr*mn),this.rendererService.viewport({x:0,y:0,width:mn*K,height:mn*tr})}setCanvas(){var ge,qe;const mn=E.SO.DPR,K=((ge=this.$container)===null||ge===void 0?void 0:ge.clientWidth)||400,tr=((qe=this.$container)===null||qe===void 0?void 0:qe.clientHeight)||300,Mr=this.canvas;Mr.width=K*mn,Mr.height=tr*mn,Mr.style.width="100%",Mr.style.height="100%"}addSceneEvent(ge){this.emit(ge.type,ge)}}const{uniq:Ga}=E.lodashUtil,Jo="#define PI 3.14159265359",Wo=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Ha=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,ds=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,Tt=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,Yt=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,Fn=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,dr=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,ai=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,Xr=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,Uo=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,Xo=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,ya=/precision\s+(high|low|medium)p\s+float/,vs=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,nl=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,$f=/void\s+main\s*\([^)]*\)\s*\{\n?/;class jd{constructor(){(0,X.Z)(this,"moduleCache",{}),(0,X.Z)(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:Jo,fs:Jo}),this.registerModule("decode",{vs:Ha,fs:""}),this.registerModule("scene_uniforms",{vs:Uo,fs:Uo}),this.registerModule("picking_uniforms",{vs:Fn,fs:Fn}),this.registerModule("projection",{vs:ai,fs:ai}),this.registerModule("project",{vs:dr,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Xo}),this.registerModule("lighting",{vs:ds,fs:""}),this.registerModule("light",{vs:Wo,fs:""}),this.registerModule("picking",{vs:Yt,fs:Tt}),this.registerModule("rotation_2d",{vs:Xr,fs:""})}registerModule(ge,qe){qe.vs=qe.vs.replace(/\r\n/g,`
`),qe.fs=qe.fs.replace(/\r\n/g,`
`);const{vs:mn,fs:K,uniforms:tr,defines:Mr,inject:Bi}=qe,{content:zi,uniforms:so}=Te(mn),{content:Si,uniforms:Sa}=Te(K);this.rawContentCache[ge]={fs:Si,defines:Mr,inject:Bi,uniforms:(0,ee.Z)((0,ee.Z)((0,ee.Z)({},so),Sa),tr),vs:zi}}getModule(ge){let qe=this.rawContentCache[ge].vs,mn=this.rawContentCache[ge].fs;const{defines:K={},inject:tr={}}=this.rawContentCache[ge];let Mr={};tr["vs:#decl"]&&(qe=tr["vs:#decl"]+qe,Mr=Te(tr["vs:#decl"]).uniforms),tr["vs:#main-start"]&&(qe=qe.replace($f,ua=>ua+tr["vs:#main-start"])),tr["fs:#decl"]&&(mn=tr["fs:#decl"]+mn),qe=Uh(K)+qe;const{content:zi,includeList:so}=this.processModule(qe,[],"vs"),{content:Si,includeList:Sa}=this.processModule(mn,[],"fs"),Do=Ga(so.concat(Sa).concat(ge)).reduce((ua,Aa)=>(0,ee.Z)((0,ee.Z)({},ua),this.rawContentCache[Aa].uniforms),(0,ee.Z)({},Mr)),ha=(ya.test(Si)?"":vs)+zi,rs=(ya.test(Si)?"":vs)+Si;return this.moduleCache[ge]={vs:ha.trim(),fs:rs.trim(),uniforms:Do},this.moduleCache[ge]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(ge,qe,mn){return{content:ge.replace(nl,(tr,Mr)=>{const zi=Mr.split(" ")[0].replace(/"/g,"");if(qe.indexOf(zi)>-1)return"";const so=this.rawContentCache[zi][mn];qe.push(zi);const{content:Si}=this.processModule(so,qe,mn);return Si}),includeList:qe}}}function Uh(ne){return Object.keys(ne).reduce((qe,mn)=>qe+`#define ${mn.toUpperCase()} ${ne[mn]}
`,`
`)}class Pl{constructor(){(0,X.Z)(this,"shaderModuleService",void 0),(0,X.Z)(this,"rendererService",void 0),(0,X.Z)(this,"cameraService",void 0),(0,X.Z)(this,"mapService",void 0),(0,X.Z)(this,"interactionService",void 0),(0,X.Z)(this,"layerService",void 0),(0,X.Z)(this,"config",void 0)}getName(){return""}getType(){return _e.Normal}init(ge,qe){this.config=qe,this.rendererService=ge.getContainer().rendererService,this.cameraService=ge.getContainer().cameraService,this.mapService=ge.getContainer().mapService,this.interactionService=ge.getContainer().interactionService,this.layerService=ge.getContainer().layerService,this.shaderModuleService=ge.getContainer().shaderModuleService}render(ge){}}class Df extends Pl{getName(){return"clear"}init(ge,qe){super.init(ge,qe)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class Nf{constructor(ge){(0,X.Z)(this,"passes",[]),(0,X.Z)(this,"layer",void 0),(0,X.Z)(this,"renderFlag",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),this.postProcessor=ge}setLayer(ge){this.layer=ge}setRenderFlag(ge){this.renderFlag=ge}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var ge=this;return(0,be.Z)(function*(){for(const qe of ge.passes)yield qe.render(ge.layer);yield ge.postProcessor.render(ge.layer)})()}resize(ge,qe){(this.width!==ge||this.height!==qe)&&(this.postProcessor.resize(ge,qe),this.width=ge,this.height=qe)}add(ge,qe){ge.getType()===_e.PostProcessing?this.postProcessor.add(ge,this.layer,qe):(ge.init(this.layer,qe),this.passes.push(ge))}insert(ge,qe,mn){ge.init(this.layer,qe),this.passes.splice(mn,0,ge)}destroy(){this.passes.length=0}}class rc extends Pl{constructor(...ge){var qe;super(...ge),qe=this,(0,X.Z)(this,"pickingFBO",void 0),(0,X.Z)(this,"layer",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),(0,X.Z)(this,"alreadyInRendering",!1),(0,X.Z)(this,"pickFromPickingFBO",({x:mn,y:K,lngLat:tr,type:Mr})=>{if(!this.layer.isVisible()||!this.layer.needPick(Mr))return;const{getViewportSize:Bi,readPixelsAsync:zi,useFramebuffer:so}=this.rendererService,{width:Si,height:Sa}=Bi(),{enableHighlight:Do,enableSelect:ha}=this.layer.getLayerConfig(),rs=mn*E.SO.DPR,ua=K*E.SO.DPR;if(rs>Si||rs<0||ua>Sa||ua<0)return;let Aa;so(this.pickingFBO,(0,be.Z)(function*(){var ls;if(Aa=yield zi({x:Math.round(rs),y:Math.round(Sa-(K+1)*E.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:qe.pickingFBO}),Aa[0]!==0||Aa[1]!==0||Aa[2]!==0){const Ma=(0,E.W0)(Aa),Da=qe.layer.getSource().getFeatureById(Ma),Xa={x:mn,y:K,type:Mr,lngLat:tr,featureId:Ma,feature:Da};Da&&(qe.layer.setCurrentPickId(Ma),qe.triggerHoverOnLayer(Xa))}else{const Ma={x:mn,y:K,lngLat:tr,type:qe.layer.getCurrentPickId()===null?"un"+Mr:"mouseout",featureId:null,feature:null};qe.triggerHoverOnLayer((0,ee.Z)((0,ee.Z)({},Ma),{},{type:"unpick"})),qe.triggerHoverOnLayer(Ma),qe.layer.setCurrentPickId(null)}Do&&qe.highlightPickedFeature(Aa),ha&&Mr==="click"&&((ls=Aa)===null||ls===void 0?void 0:ls.toString())!==[0,0,0,0].toString()&&qe.selectFeature(Aa)}))})}getType(){return _e.Normal}getName(){return"pixelPicking"}init(ge,qe){super.init(ge,qe),this.layer=ge;const{createTexture2D:mn,createFramebuffer:K,getViewportSize:tr}=this.rendererService,{width:Mr,height:Bi}=tr(),zi=mn({width:Mr,height:Bi,wrapS:re.CLAMP_TO_EDGE,wrapT:re.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=K({color:zi}),this.interactionService.on(er.Hover,this.pickFromPickingFBO),this.interactionService.on(er.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(er.Active,this.highlightFeatureHandle.bind(this))}render(ge){if(this.alreadyInRendering)return;const{getViewportSize:qe,useFramebuffer:mn,clear:K}=this.rendererService,{width:tr,height:Mr}=qe();this.alreadyInRendering=!0,(this.width!==tr||this.height!==Mr)&&(this.pickingFBO.resize({width:tr,height:Mr}),this.width=tr,this.height=Mr),mn(this.pickingFBO,()=>{K({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const Bi=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),ge.hooks.beforePickingEncode.call(),ge.render(),ge.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(Bi),this.alreadyInRendering=!1})}triggerHoverOnLayer(ge){this.layer.emit(ge.type,ge)}highlightPickedFeature(ge){const[qe,mn,K]=ge;this.layer.hooks.beforeHighlight.call([qe,mn,K]),this.layerService.renderLayers()}selectFeature(ge){const[qe,mn,K]=ge;this.layer.hooks.beforeSelect.call([qe,mn,K]),this.layerService.renderLayers()}selectFeatureHandle({featureId:ge}){const qe=(0,E.Z6)(ge);this.selectFeature(new Uint8Array(qe))}highlightFeatureHandle({featureId:ge}){const qe=(0,E.Z6)(ge);this.highlightPickedFeature(new Uint8Array(qe))}}class gu{constructor(ge){(0,X.Z)(this,"passes",[]),(0,X.Z)(this,"readFBO",void 0),(0,X.Z)(this,"writeFBO",void 0),this.rendererService=ge,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:ge,createTexture2D:qe}=this.rendererService,{width:mn,height:K}=ge();return qe({x:0,y:0,width:mn,height:K,copy:!0})}getReadFBOTex(){var ge=this;const{useFramebuffer:qe}=this.rendererService;return new Promise(mn=>{qe(this.readFBO,(0,be.Z)(function*(){mn(ge.getCurrentFBOTex())}))})}renderBloomPass(ge,qe){var mn=this;return(0,be.Z)(function*(){const K=yield mn.getReadFBOTex();let tr=0;for(;tr<4;)yield qe.render(ge,K),mn.swap(),tr++})()}render(ge){var qe=this;return(0,be.Z)(function*(){for(let mn=0;mn<qe.passes.length;mn++){const K=qe.passes[mn];K.setRenderToScreen(qe.isLastEnabledPass(mn)),K.getName()==="bloom"?yield qe.renderBloomPass(ge,K):(yield K.render(ge),mn!==qe.passes.length-1&&qe.swap())}})()}resize(ge,qe){this.readFBO.resize({width:ge,height:qe}),this.writeFBO.resize({width:ge,height:qe})}add(ge,qe,mn){ge.init(qe,mn),this.passes.push(ge)}insert(ge,qe,mn,K){ge.init(mn,K),this.passes.splice(qe,0,ge)}getPostProcessingPassByName(ge){return this.passes.find(qe=>qe.getName()===ge)}init(){const{createFramebuffer:ge,createTexture2D:qe}=this.rendererService;this.readFBO=ge({color:qe({width:1,height:1,wrapS:re.CLAMP_TO_EDGE,wrapT:re.CLAMP_TO_EDGE,usage:On.RENDER_TARGET})}),this.writeFBO=ge({color:qe({width:1,height:1,wrapS:re.CLAMP_TO_EDGE,wrapT:re.CLAMP_TO_EDGE,usage:On.RENDER_TARGET})})}isLastEnabledPass(ge){for(let qe=ge+1;qe<this.passes.length;qe++)if(this.passes[qe].isEnabled())return!1;return!0}swap(){const ge=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=ge}}class ou extends Pl{getType(){return _e.Normal}getName(){return"render"}init(ge,qe){super.init(ge,qe)}render(ge){const{useFramebuffer:qe,clear:mn}=this.rendererService,K=ge.multiPassRenderer.getPostProcessor().getReadFBO();qe(K,()=>{mn({color:[0,0,0,0],depth:1,stencil:0,framebuffer:K}),ge.multiPassRenderer.setRenderFlag(!1),ge.models.forEach(tr=>{tr.draw({uniforms:ge.layerModel.getUninforms()})}),ge.multiPassRenderer.setRenderFlag(!0)})}}const qu=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,lc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:Xs}=E.lodashUtil;class Lu extends je{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:lc,fs:qu});const{vs:ge,fs:qe,uniforms:mn}=this.shaderModuleService.getModule("blur-pass"),{width:K,height:tr}=this.rendererService.getViewportSize();return{vs:ge,fs:qe,uniforms:(0,ee.Z)((0,ee.Z)({},mn),{},{u_ViewportSize:[K,tr]})}}convertOptionsToUniforms(ge){const qe={};return Xs(ge.bloomRadius)||(qe.u_radius=ge.bloomRadius),Xs(ge.bloomIntensity)||(qe.u_intensity=ge.bloomIntensity),Xs(ge.bloomBaseRadio)||(qe.u_baseRadio=ge.bloomBaseRadio),qe}}const gf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,jh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:bp}=E.lodashUtil;class vh extends je{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:jh,fs:gf});const{vs:ge,fs:qe,uniforms:mn}=this.shaderModuleService.getModule("blur-pass"),{width:K,height:tr}=this.rendererService.getViewportSize();return{vs:ge,fs:qe,uniforms:(0,ee.Z)((0,ee.Z)({},mn),{},{u_ViewportSize:[K,tr]})}}convertOptionsToUniforms(ge){const qe={};return bp(ge.blurRadius)||(qe.u_BlurDir=[ge.blurRadius,0]),qe}}const Kf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Du=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:gh}=E.lodashUtil;class Vh extends je{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:Du,fs:Kf});const{vs:ge,fs:qe,uniforms:mn}=this.shaderModuleService.getModule("blur-pass"),{width:K,height:tr}=this.rendererService.getViewportSize();return{vs:ge,fs:qe,uniforms:(0,ee.Z)((0,ee.Z)({},mn),{},{u_ViewportSize:[K,tr]})}}convertOptionsToUniforms(ge){const qe={};return gh(ge.blurRadius)||(qe.u_BlurDir=[0,ge.blurRadius]),qe}}const bd=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,t0=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class qf extends je{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:t0,fs:bd});const{vs:ge,fs:qe,uniforms:mn}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:K,height:tr}=this.rendererService.getViewportSize();return{vs:ge,fs:qe,uniforms:(0,ee.Z)((0,ee.Z)({},mn),{},{u_ViewportSize:[K,tr]})}}}const yu=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Vd=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class zl extends je{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:Vd,fs:yu}),this.shaderModuleService.getModule("copy-pass")}}const _u=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Qu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class _s extends je{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Qu,fs:_u});const{vs:ge,fs:qe,uniforms:mn}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:K,height:tr}=this.rendererService.getViewportSize();return{vs:ge,fs:qe,uniforms:(0,ee.Z)((0,ee.Z)({},mn),{},{u_ViewportSize:[K,tr]})}}}const au=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,xc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class Ju extends je{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:xc,fs:au});const{vs:ge,fs:qe,uniforms:mn}=this.shaderModuleService.getModule("ink-pass"),{width:K,height:tr}=this.rendererService.getViewportSize();return{vs:ge,fs:qe,uniforms:(0,ee.Z)((0,ee.Z)({},mn),{},{u_ViewportSize:[K,tr]})}}}const hl=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Nu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class ef extends je{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:Nu,fs:hl}),this.shaderModuleService.getModule("noise-pass")}}const Hd=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Hh=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class ns extends je{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Hd,fs:Hh}),this.shaderModuleService.getModule("sepia-pass")}}const yh=new Kr;let Zh=0;function Wh(){const ne=new jd,ge=new Qo,qe=new yt,mn=new Co(qe),K=new Ae,tr=new qt,Mr=new Er,Bi=new Vr,zi=new Qn,so={id:`${Zh++}`,globalConfigService:yh,shaderModuleService:ne,debugService:ge,cameraService:qe,coordinateSystemService:mn,fontService:K,iconService:tr,markerService:Mr,popupService:Bi,controlService:zi,customRenderService:{}},Si=new Gi(so);so.layerService=Si;const Sa=new ia(so);so.sceneService=Sa;const Do=new un(so);so.interactionService=Do;const ha=new vr(so);so.pickingService=ha;const rs={clear:new Df,pixelPicking:new rc,render:new ou};so.normalPassFactory=Aa=>rs[Aa];const ua={copy:new zl,bloom:new Lu,blurH:new vh,blurV:new Vh,noise:new ef,sepia:new ns,colorHalftone:new qf,hexagonalPixelate:new _s,ink:new Ju};return so.postProcessingPass=ua,so.postProcessingPassFactory=Aa=>ua[Aa],so}function rl(ne){const ge=(0,ee.Z)({},ne);return ge.postProcessor=new gu(ge.rendererService),ge.multiPassRenderer=new Nf(ge.postProcessor),ge.styleAttributeService=new Ri(ge.rendererService),ge}const Bf=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let _h=function(ne){return ne.IMAGE="image",ne.CUSTOMIMAGE="customImage",ne.ARRAYBUFFER="arraybuffer",ne.RGB="rgb",ne.TERRAINRGB="terrainRGB",ne.CUSTOMRGB="customRGB",ne.CUSTOMARRAYBUFFER="customArrayBuffer",ne.CUSTOMTERRAINRGB="customTerrainRGB",ne}({})},35914:function($t,W,D){"use strict";D.d(W,{Z:function(){return Wn}});var ee=D(1413),X=D(4942);class E{constructor(ht){(0,X.Z)(this,"configService",void 0),(0,X.Z)(this,"config",void 0),this.config=ht}setContainer(ht,Ht){this.configService=ht.globalConfigService,ht.mapConfig=(0,ee.Z)((0,ee.Z)({},this.config),{},{id:Ht}),ht.mapService=new(this.getServiceConstructor())(ht)}getServiceConstructor(){throw new Error("Method not implemented.")}}var _e=D(45987),re=D(15861),he=D(85975),se=D(77160),Se=D(6158),oe=D.n(Se),je=D(15671),te=D(43144),ve=D(82963),Be=D(61120),Te=D(60136),we=D(97326),le=D(97685),Ze=D(98333);function xt(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ft(hn,ht){var Ht=Ze.fF([],ht,hn);return Ze.bA(Ht,Ht,1/Ht[3]),Ht}function Zt(hn,ht){var Ht=hn%ht;return Ht<0?ht+Ht:Ht}function pt(hn,ht,Ht){return Ht*ht+(1-Ht)*hn}var vt=D(31437);function ke(hn,ht){if(!hn)throw new Error(ht||"viewport-mercator-project: assertion failed.")}var Re=Math.PI,bt=Re/4,gt=Re/180,Ct=180/Re,Sn=512,He=4003e4,Ot=1.5;function Ce(hn){return Math.pow(2,hn)}function ot(hn){return Math.log2(hn)}function $e(hn,ht){var Ht=(0,le.Z)(hn,2),Cn=Ht[0],Ln=Ht[1];ke(Number.isFinite(Cn)&&Number.isFinite(ht)),ke(Number.isFinite(Ln)&&Ln>=-90&&Ln<=90,"invalid latitude"),ht*=Sn;var Gn=Cn*gt,dt=Ln*gt,ye=ht*(Gn+Re)/(2*Re),Fe=ht*(Re-Math.log(Math.tan(bt+dt*.5)))/(2*Re);return[ye,Fe]}function Xe(hn,ht){var Ht=(0,le.Z)(hn,2),Cn=Ht[0],Ln=Ht[1];ht*=Sn;var Gn=Cn/ht*(2*Re)-Re,dt=2*(Math.atan(Math.exp(Re-Ln/ht*(2*Re)))-bt);return[Gn*Ct,dt*Ct]}function Rt(hn){var ht=hn.latitude;assert(Number.isFinite(ht));var Ht=Math.cos(ht*gt);return ot(He*Ht)-9}function _t(hn){var ht=hn.latitude,Ht=hn.longitude,Cn=hn.zoom,Ln=hn.scale,Gn=hn.highPrecision,dt=Gn===void 0?!1:Gn;Ln=Ln!==void 0?Ln:Ce(Cn),ke(Number.isFinite(ht)&&Number.isFinite(Ht)&&Number.isFinite(Ln));var ye={},Fe=Sn*Ln,nt=Math.cos(ht*gt),Pt=Fe/360,Mt=Pt/nt,Tn=Fe/He/nt;if(ye.pixelsPerMeter=[Tn,-Tn,Tn],ye.metersPerPixel=[1/Tn,-1/Tn,1/Tn],ye.pixelsPerDegree=[Pt,-Mt,Tn],ye.degreesPerPixel=[1/Pt,-1/Mt,1/Tn],dt){var $n=gt*Math.tan(ht*gt)/nt,xr=Pt*$n/2,qn=Fe/He*$n,Ae=qn/Mt*Tn;ye.pixelsPerDegree2=[0,-xr,qn],ye.pixelsPerMeter2=[Ae,0,Ae]}return ye}function Pe(hn,ht){var Ht=_slicedToArray(hn,3),Cn=Ht[0],Ln=Ht[1],Gn=Ht[2],dt=_slicedToArray(ht,3),ye=dt[0],Fe=dt[1],nt=dt[2],Pt=1,Mt=_t({longitude:Cn,latitude:Ln,scale:Pt,highPrecision:!0}),Tn=Mt.pixelsPerMeter,$n=Mt.pixelsPerMeter2,xr=$e(hn,Pt);xr[0]+=ye*(Tn[0]+$n[0]*Fe),xr[1]+=Fe*(Tn[1]+$n[1]*Fe);var qn=Xe(xr,Pt),Ae=(Gn||0)+(nt||0);return Number.isFinite(Gn)||Number.isFinite(nt)?[qn[0],qn[1],Ae]:qn}function Wt(hn){var ht=hn.height,Ht=hn.pitch,Cn=hn.bearing,Ln=hn.altitude,Gn=hn.center,dt=Gn===void 0?null:Gn,ye=hn.flipY,Fe=ye===void 0?!1:ye,nt=xt();return he.translate(nt,nt,[0,0,-Ln]),he.scale(nt,nt,[1,1,1/ht]),he.rotateX(nt,nt,-Ht*gt),he.rotateZ(nt,nt,Cn*gt),Fe&&he.scale(nt,nt,[1,-1,1]),dt&&he.translate(nt,nt,se.tk([],dt)),nt}function on(hn){var ht=hn.width,Ht=hn.height,Cn=hn.altitude,Ln=Cn===void 0?Ot:Cn,Gn=hn.pitch,dt=Gn===void 0?0:Gn,ye=hn.nearZMultiplier,Fe=ye===void 0?1:ye,nt=hn.farZMultiplier,Pt=nt===void 0?1:nt,Mt=dt*gt,Tn=Math.atan(.5/Ln),$n=Math.sin(Tn)*Ln/Math.sin(Math.PI/2-Mt-Tn),xr=Math.cos(Math.PI/2-Mt)*$n+Ln;return{fov:2*Math.atan(Ht/2/Ln),aspect:ht/Ht,focalDistance:Ln,near:Fe,far:xr*Pt}}function Nn(hn){var ht=hn.width,Ht=hn.height,Cn=hn.pitch,Ln=hn.altitude,Gn=hn.nearZMultiplier,dt=hn.farZMultiplier,ye=on({width:ht,height:Ht,altitude:Ln,pitch:Cn,nearZMultiplier:Gn,farZMultiplier:dt}),Fe=ye.fov,nt=ye.aspect,Pt=ye.near,Mt=ye.far,Tn=he.perspective([],Fe,nt,Pt,Mt);return Tn}function jn(hn,ht){var Ht=(0,le.Z)(hn,3),Cn=Ht[0],Ln=Ht[1],Gn=Ht[2],dt=Gn===void 0?0:Gn;return ke(Number.isFinite(Cn)&&Number.isFinite(Ln)&&Number.isFinite(dt)),ft(ht,[Cn,Ln,dt,1])}function lr(hn,ht){var Ht=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,Cn=(0,le.Z)(hn,3),Ln=Cn[0],Gn=Cn[1],dt=Cn[2];if(ke(Number.isFinite(Ln)&&Number.isFinite(Gn),"invalid pixel coordinate"),Number.isFinite(dt)){var ye=ft(ht,[Ln,Gn,dt,1]);return ye}var Fe=ft(ht,[Ln,Gn,0,1]),nt=ft(ht,[Ln,Gn,1,1]),Pt=Fe[2],Mt=nt[2],Tn=Pt===Mt?0:((Ht||0)-Pt)/(Mt-Pt);return vt.t7([],Fe,nt,Tn)}var Vt=xt(),en=function(){function hn(){var ht=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ht=ht.width,Cn=ht.height,Ln=ht.viewMatrix,Gn=Ln===void 0?Vt:Ln,dt=ht.projectionMatrix,ye=dt===void 0?Vt:dt;(0,je.Z)(this,hn),this.width=Ht||1,this.height=Cn||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=Gn,this.projectionMatrix=ye;var Fe=xt();he.multiply(Fe,Fe,this.projectionMatrix),he.multiply(Fe,Fe,this.viewMatrix),this.viewProjectionMatrix=Fe;var nt=xt();he.scale(nt,nt,[this.width/2,-this.height/2,1]),he.translate(nt,nt,[1,-1,0]),he.multiply(nt,nt,this.viewProjectionMatrix);var Pt=he.invert(xt(),nt);if(!Pt)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=nt,this.pixelUnprojectionMatrix=Pt,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,te.Z)(hn,[{key:"equals",value:function(Ht){return Ht instanceof hn?Ht.width===this.width&&Ht.height===this.height&&he.equals(Ht.projectionMatrix,this.projectionMatrix)&&he.equals(Ht.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(Ht){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ln=Cn.topLeft,Gn=Ln===void 0?!0:Ln,dt=this.projectPosition(Ht),ye=jn(dt,this.pixelProjectionMatrix),Fe=(0,le.Z)(ye,2),nt=Fe[0],Pt=Fe[1],Mt=Gn?Pt:this.height-Pt;return Ht.length===2?[nt,Mt]:[nt,Mt,ye[2]]}},{key:"unproject",value:function(Ht){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ln=Cn.topLeft,Gn=Ln===void 0?!0:Ln,dt=Cn.targetZ,ye=(0,le.Z)(Ht,3),Fe=ye[0],nt=ye[1],Pt=ye[2],Mt=Gn?nt:this.height-nt,Tn=dt&&dt*this.pixelsPerMeter,$n=lr([Fe,Mt,Pt],this.pixelUnprojectionMatrix,Tn),xr=this.unprojectPosition($n),qn=(0,le.Z)(xr,3),Ae=qn[0],be=qn[1],Ne=qn[2];return Number.isFinite(Pt)?[Ae,be,Ne]:Number.isFinite(dt)?[Ae,be,dt]:[Ae,be]}},{key:"projectPosition",value:function(Ht){var Cn=this.projectFlat(Ht),Ln=(0,le.Z)(Cn,2),Gn=Ln[0],dt=Ln[1],ye=(Ht[2]||0)*this.pixelsPerMeter;return[Gn,dt,ye]}},{key:"unprojectPosition",value:function(Ht){var Cn=this.unprojectFlat(Ht),Ln=(0,le.Z)(Cn,2),Gn=Ln[0],dt=Ln[1],ye=(Ht[2]||0)/this.pixelsPerMeter;return[Gn,dt,ye]}},{key:"projectFlat",value:function(Ht){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ht}},{key:"unprojectFlat",value:function(Ht){var Cn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ht}}]),hn}();function xn(hn){var ht=hn.width,Ht=hn.height,Cn=hn.bounds,Ln=hn.minExtent,Gn=Ln===void 0?0:Ln,dt=hn.maxZoom,ye=dt===void 0?24:dt,Fe=hn.padding,nt=Fe===void 0?0:Fe,Pt=hn.offset,Mt=Pt===void 0?[0,0]:Pt,Tn=(0,le.Z)(Cn,2),$n=(0,le.Z)(Tn[0],2),xr=$n[0],qn=$n[1],Ae=(0,le.Z)(Tn[1],2),be=Ae[0],Ne=Ae[1];if(Number.isFinite(nt)){var et=nt;nt={top:et,bottom:et,left:et,right:et}}else ke(Number.isFinite(nt.top)&&Number.isFinite(nt.bottom)&&Number.isFinite(nt.left)&&Number.isFinite(nt.right));var wt=new er({width:ht,height:Ht,longitude:0,latitude:0,zoom:0}),qt=wt.project([xr,Ne]),vn=wt.project([be,qn]),yt=[Math.max(Math.abs(vn[0]-qt[0]),Gn),Math.max(Math.abs(vn[1]-qt[1]),Gn)],Jt=[ht-nt.left-nt.right-Math.abs(Mt[0])*2,Ht-nt.top-nt.bottom-Math.abs(Mt[1])*2];ke(Jt[0]>0&&Jt[1]>0);var Qn=Jt[0]/yt[0],Er=Jt[1]/yt[1],Vr=(nt.right-nt.left)/2/Qn,mr=(nt.bottom-nt.top)/2/Er,kr=[(vn[0]+qt[0])/2+Vr,(vn[1]+qt[1])/2+mr],Ei=wt.unproject(kr),Oi=wt.zoom+Math.log2(Math.abs(Math.min(Qn,Er)));return{longitude:Ei[0],latitude:Ei[1],zoom:Math.min(Oi,ye)}}var er=function(hn){(0,Te.Z)(ht,hn);function ht(){var Ht,Cn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ln=Cn.width,Gn=Cn.height,dt=Cn.latitude,ye=dt===void 0?0:dt,Fe=Cn.longitude,nt=Fe===void 0?0:Fe,Pt=Cn.zoom,Mt=Pt===void 0?0:Pt,Tn=Cn.pitch,$n=Tn===void 0?0:Tn,xr=Cn.bearing,qn=xr===void 0?0:xr,Ae=Cn.altitude,be=Ae===void 0?1.5:Ae,Ne=Cn.nearZMultiplier,et=Cn.farZMultiplier;(0,je.Z)(this,ht),Ln=Ln||1,Gn=Gn||1;var wt=Ce(Mt);be=Math.max(.75,be);var qt=$e([nt,ye],wt);qt[2]=0;var vn=Nn({width:Ln,height:Gn,pitch:$n,bearing:qn,altitude:be,nearZMultiplier:Ne||1/Gn,farZMultiplier:et||1.01}),yt=Wt({height:Gn,center:qt,pitch:$n,bearing:qn,altitude:be,flipY:!0});return Ht=(0,ve.Z)(this,(0,Be.Z)(ht).call(this,{width:Ln,height:Gn,viewMatrix:yt,projectionMatrix:vn})),Ht.latitude=ye,Ht.longitude=nt,Ht.zoom=Mt,Ht.pitch=$n,Ht.bearing=qn,Ht.altitude=be,Ht.scale=wt,Ht.center=qt,Ht.pixelsPerMeter=_t((0,we.Z)((0,we.Z)(Ht))).pixelsPerMeter[2],Object.freeze((0,we.Z)((0,we.Z)(Ht))),Ht}return(0,te.Z)(ht,[{key:"projectFlat",value:function(Cn){var Ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return $e(Cn,Ln)}},{key:"unprojectFlat",value:function(Cn){var Ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Xe(Cn,Ln)}},{key:"getMapCenterByLngLatPosition",value:function(Cn){var Ln=Cn.lngLat,Gn=Cn.pos,dt=lr(Gn,this.pixelUnprojectionMatrix),ye=$e(Ln,this.scale),Fe=vt.IH([],ye,vt.tk([],dt)),nt=vt.IH([],this.center,Fe);return Xe(nt,this.scale)}},{key:"getLocationAtPoint",value:function(Cn){var Ln=Cn.lngLat,Gn=Cn.pos;return this.getMapCenterByLngLatPosition({lngLat:Ln,pos:Gn})}},{key:"fitBounds",value:function(Cn){var Ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Gn=this.width,dt=this.height,ye=xn(Object.assign({width:Gn,height:dt,bounds:Cn},Ln)),Fe=ye.longitude,nt=ye.latitude,Pt=ye.zoom;return new ht({width:Gn,height:dt,longitude:Fe,latitude:nt,zoom:Pt})}}]),ht}(en);class sn{constructor(){(0,X.Z)(this,"viewport",new er)}syncWithMapCamera(ht){const{center:Ht,zoom:Cn,pitch:Ln,bearing:Gn,viewportHeight:dt,viewportWidth:ye}=ht,Fe={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new er((0,ee.Z)((0,ee.Z)({},Fe),{},{width:ye,height:dt,longitude:Ht&&Ht[0],latitude:Ht&&Ht[1],zoom:Cn,pitch:Ln,bearing:Gn}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(ht,Ht){return this.viewport.projectFlat(ht,Ht)}}var Ut=D(39827),Dt=D(8543),Me=D(26729);class Qe{constructor(ht){(0,X.Z)(this,"size",1e4),this.size=ht||1e4}setSize(ht){this.size=ht}getSize(){return[this.size,this.size]}mercatorXfromLng(ht){return(180+ht)/360*this.size}mercatorYfromLat(ht){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+ht*Math.PI/360)))/360)*this.size}lngFromMercatorX(ht){return ht/this.size*360-180}latFromMercatorY(ht){const Ht=180-(1-ht/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(Ht*Math.PI/180))-90}project(ht){const Ht=this.mercatorXfromLng(ht[0]),Cn=this.mercatorYfromLat(ht[1]);return[Ht,Cn]}unproject(ht){const Ht=this.lngFromMercatorX(ht[0]),Cn=this.latFromMercatorY(ht[1]);return[Ht,Cn]}}const Ft={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},U={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},ue=12;class at{constructor(ht){(0,X.Z)(this,"version","DEFAUlTMAP"),(0,X.Z)(this,"map",void 0),(0,X.Z)(this,"simpleMapCoord",new Qe),(0,X.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,X.Z)(this,"config",void 0),(0,X.Z)(this,"configService",void 0),(0,X.Z)(this,"coordinateSystemService",void 0),(0,X.Z)(this,"eventEmitter",void 0),(0,X.Z)(this,"markerContainer",void 0),(0,X.Z)(this,"cameraChangedCallback",void 0),(0,X.Z)(this,"$mapContainer",void 0),(0,X.Z)(this,"handleCameraChanged",Ht=>{const{lat:Cn,lng:Ln}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[Ln,Cn],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=ht.mapConfig,this.configService=ht.globalConfigService,this.coordinateSystemService=ht.coordinateSystemService,this.eventEmitter=new Me.EventEmitter}setBgColor(ht){this.bgColor=ht}addMarkerContainer(){const ht=this.map.getCanvasContainer();this.markerContainer=Dt.SO.create("div","l7-marker-container",ht),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(ht,Ht){Ut.I9.indexOf(ht)!==-1?this.eventEmitter.on(ht,Ht):this.map.on(U[ht]||ht,Ht)}off(ht,Ht){this.map.off(U[ht]||ht,Ht),this.eventEmitter.off(ht,Ht)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();const ht=this.map.transform;return[ht.width,ht.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(ht){return this.map.setZoom(ht)}getCenter(){return this.map.getCenter()}setCenter(ht){this.map.setCenter(ht)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(ht){this.map.setBearing(ht)}zoomIn(ht,Ht){this.map.zoomIn(ht,Ht)}zoomOut(ht,Ht){this.map.zoomOut(ht,Ht)}setPitch(ht){return this.map.setPitch(ht)}panTo(ht){this.map.panTo(ht)}panBy(ht=0,Ht=0){this.map.panBy([ht,Ht])}fitBounds(ht,Ht){this.map.fitBounds(ht,Ht)}setMaxZoom(ht){this.map.setMaxZoom(ht)}setMinZoom(ht){this.map.setMinZoom(ht)}setMapStatus(ht){ht.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),ht.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),ht.dragEnable===!1&&this.map.dragPan.disable(),ht.dragEnable===!0&&this.map.dragPan.enable(),ht.rotateEnable===!1&&this.map.dragRotate.disable(),ht.dragEnable===!0&&this.map.dragRotate.enable(),ht.keyboardEnable===!1&&this.map.keyboard.disable(),ht.keyboardEnable===!0&&this.map.keyboard.enable(),ht.zoomEnable===!1&&this.map.scrollZoom.disable(),ht.zoomEnable===!0&&this.map.scrollZoom.enable()}setZoomAndCenter(ht,Ht){this.map.flyTo({zoom:ht,center:Ht})}setMapStyle(ht){var Ht;(Ht=this.map)===null||Ht===void 0||Ht.setStyle(this.getMapStyleValue(ht))}meterToCoord(ht,Ht){return 1}pixelToLngLat(ht){return this.map.unproject(ht)}lngLatToPixel(ht){return this.map.project(ht)}containerToLngLat(ht){return this.map.unproject(ht)}lngLatToContainer(ht){return this.map.project(ht)}getMapStyle(){try{var ht;const Ht=(ht=this.map.getStyle().sprite)!==null&&ht!==void 0?ht:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(Ht)?Ht==null?void 0:Ht.replace(/\/\w+$/,"").replace(/sprites/,"styles"):Ht}catch(Ht){return""}}getMapStyleConfig(){return Ft}getMapStyleValue(ht){var Ht;return(Ht=this.getMapStyleConfig()[ht])!==null&&Ht!==void 0?Ht:ht}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(ht,...Ht){this.eventEmitter.emit(ht,...Ht)}once(ht,...Ht){this.eventEmitter.once(ht,...Ht)}getMapContainer(){return this.$mapContainer}exportMap(ht){var Ht;const Cn=(Ht=this.map)===null||Ht===void 0?void 0:Ht.getCanvas();return ht==="jpg"?Cn==null?void 0:Cn.toDataURL("image/jpeg"):Cn==null?void 0:Cn.toDataURL("image/png")}onCameraChanged(ht){this.cameraChangedCallback=ht}creatMapContainer(ht){let Ht=ht;return typeof ht=="string"&&(Ht=document.getElementById(ht)),Ht}updateView(ht){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:ht.bearing,center:ht.center,viewportHeight:ht.viewportHeight,pitch:ht.pitch,viewportWidth:ht.viewportWidth,zoom:ht.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:ht=!0}=this.config;this.viewport.getZoom()>ue&&ht?this.coordinateSystemService.setCoordinateSystem(Ut.lo.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Ut.lo.LNGLAT)}}const ce=["id","attributionControl","style","token","rotation","mapInstance"];function j(hn,ht){var Ht=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Cn=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(Ht||Cn)&&(ht||(ht=document),!!ht)){var Ln=ht.head||ht.getElementsByTagName("head")[0];if(!Ln){Ln=ht.createElement("head");var Gn=ht.body||ht.getElementsByTagName("body")[0];Gn?Gn.parentNode.insertBefore(Ln,Gn):ht.documentElement.appendChild(Ln)}var dt=ht.createElement("style");return dt.type="text/css",dt.styleSheet?dt.styleSheet.cssText=hn:dt.appendChild(ht.createTextNode(hn)),Ln.appendChild(dt),dt}}j(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=oe();let ln=0;const fn="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class mt extends at{constructor(...ht){super(...ht),(0,X.Z)(this,"version","MAPBOX"),(0,X.Z)(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(ht,Ht={x:0,y:0,z:0}){const{x:Cn,y:Ln}=this.lngLatToMercator(ht,0);return[Cn-Ht.x,Ln-Ht.y]}lngLatToMercator(ht,Ht){const{x:Cn=0,y:Ln=0,z:Gn=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(ht,Ht);return{x:Cn,y:Ln,z:Gn}}getModelMatrix(ht,Ht,Cn,Ln=[1,1,1],Gn={x:0,y:0,z:0}){const dt=window.mapboxgl.MercatorCoordinate.fromLngLat(ht,Ht),ye=dt.meterInMercatorCoordinateUnits(),Fe=he.create();return he.translate(Fe,Fe,se.al(dt.x-Gn.x,dt.y-Gn.y,dt.z||0-Gn.z)),he.scale(Fe,Fe,se.al(ye*Ln[0],-ye*Ln[1],ye*Ln[2])),he.rotateX(Fe,Fe,Cn[0]),he.rotateY(Fe,Fe,Cn[1]),he.rotateZ(Fe,Fe,Cn[2]),Fe}init(){var ht=this;return(0,re.Z)(function*(){const Ht=ht.config,{id:Cn="map",attributionControl:Ln=!1,style:Gn="light",token:dt=fn,rotation:ye=0,mapInstance:Fe}=Ht,nt=(0,_e.Z)(Ht,ce);ht.viewport=new sn,!Fe&&!window.mapboxgl&&console.error(ht.configService.getSceneWarninfo("SDK")),dt===fn&&Gn!=="blank"&&!window.mapboxgl.accessToken&&!Fe&&console.warn(ht.configService.getSceneWarninfo("MapToken")),!Fe&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=dt),Fe?(ht.map=Fe,ht.$mapContainer=ht.map.getContainer()):(ht.$mapContainer=ht.creatMapContainer(Cn),ht.map=new window.mapboxgl.Map((0,ee.Z)({container:ht.$mapContainer,style:ht.getMapStyleValue(Gn),attributionControl:Ln,bearing:ye},nt))),ht.map.on("load",()=>{ht.handleCameraChanged()}),ht.map.on("move",ht.handleCameraChanged),ht.handleCameraChanged()})()}destroy(){var ht;(ht=this.$mapContainer)===null||ht===void 0||(ht=ht.parentNode)===null||ht===void 0||ht.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(ht,...Ht){this.eventEmitter.emit(ht,...Ht)}once(ht,...Ht){this.eventEmitter.once(ht,...Ht)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var ht;return(ht=this.getMapContainer())===null||ht===void 0?void 0:ht.querySelector(".mapboxgl-canvas-container")}meterToCoord(ht,Ht){const Cn=new(oe()).LngLat(ht[0],ht[1]),Ln=new(oe()).LngLat(Ht[0],Ht[1]),Gn=Cn.distanceTo(Ln),dt=oe().MercatorCoordinate.fromLngLat({lng:ht[0],lat:ht[1]}),ye=oe().MercatorCoordinate.fromLngLat({lng:Ht[0],lat:Ht[1]}),{x:Fe,y:nt}=dt,{x:Pt,y:Mt}=ye;return Math.sqrt(Math.pow(Fe-Pt,2)+Math.pow(nt-Mt,2))*4194304*2/Gn}exportMap(ht){const Ht=this.map.getCanvas();return ht==="jpg"?Ht==null?void 0:Ht.toDataURL("image/jpeg"):Ht==null?void 0:Ht.toDataURL("image/png")}creatMapContainer(ht){let Ht=ht;typeof ht=="string"&&(Ht=document.getElementById(ht));const Cn=document.createElement("div");return Cn.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,Cn.id="l7_mapbox_div"+ln++,Ht.appendChild(Cn),Cn}}function Gt(hn,ht){var Ht=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Cn=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(Ht||Cn)&&(ht||(ht=document),!!ht)){var Ln=ht.head||ht.getElementsByTagName("head")[0];if(!Ln){Ln=ht.createElement("head");var Gn=ht.body||ht.getElementsByTagName("body")[0];Gn?Gn.parentNode.insertBefore(Ln,Gn):ht.documentElement.appendChild(Ln)}var dt=ht.createElement("style");return dt.type="text/css",dt.styleSheet?dt.styleSheet.cssText=hn:dt.appendChild(ht.createTextNode(hn)),Ln.appendChild(dt),dt}}Gt(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class Wn extends E{getServiceConstructor(){return mt}}},4771:function(){},8543:function($t,W,D){"use strict";D.d(W,{SO:function(){return ee},z6:function(){return rl},a5:function(){return X},SA:function(){return E},nx:function(){return xu},Z:function(){return $f},rQ:function(){return He},bV:function(){return Sn},zi:function(){return Ot},ds:function(){return ou},oO:function(){return gu},SI:function(){return vh},Rx:function(){return Kf},W0:function(){return Xe},LS:function(){return Gl},Z6:function(){return Rt},We:function(){return Fn},Co:function(){return Ct},Ks:function(){return ds},hj:function(){return Wt},Cl:function(){return _t},Oc:function(){return Nn},M4:function(){return Pe},NJ:function(){return on},ks:function(){return ft},Ol:function(){return Du},Yu:function(){return pt},ZB:function(){return lr},gJ:function(){return gt},z0:function(){return ks},jG:function(){return Wd},M8:function(){return bd},fg:function(){return Jr},if:function(){return Yt},vP:function(){return Uo},lodashUtil:function(){return Jt},LF:function(){return le},Fv:function(){return qu},yA:function(){return rc},CI:function(){return $e}});var ee={};D.r(ee),D.d(ee,{DPR:function(){return kt},addClass:function(){return ar},addStyle:function(){return un},appendElementType:function(){return Gi},clearChildren:function(){return fr},create:function(){return Ei},css2Style:function(){return pn},empty:function(){return Fo},findParentElement:function(){return no},getClass:function(){return Ii},getContainer:function(){return Er},getDiffRect:function(){return On},getStyleList:function(){return Bn},getViewPortScale:function(){return Je},hasClass:function(){return hi},printCanvas:function(){return De},remove:function(){return Oi},removeClass:function(){return Kr},removeStyle:function(){return kn},setChecked:function(){return vr},setClass:function(){return Qr},setTransform:function(){return Co},setUnDraggable:function(){return ci},splitWords:function(){return mr},toggleClass:function(){return Io},triggerResize:function(){return Qo},trim:function(){return Vr}});var X={};D.r(X),D.d(X,{getColumn:function(){return K},getSatByColumn:function(){return tr},max:function(){return Bf},mean:function(){return ge},min:function(){return _h},mode:function(){return qe},statMap:function(){return mn},sum:function(){return ne}});var E={REGISTERED_PROTOCOLS:{}},_e=Object.defineProperty,re=Object.defineProperties,he=Object.getOwnPropertyDescriptors,se=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,je=(fe,Ie,ct)=>Ie in fe?_e(fe,Ie,{enumerable:!0,configurable:!0,writable:!0,value:ct}):fe[Ie]=ct,te=(fe,Ie)=>{for(var ct in Ie||(Ie={}))Se.call(Ie,ct)&&je(fe,ct,Ie[ct]);if(se)for(var ct of se(Ie))oe.call(Ie,ct)&&je(fe,ct,Ie[ct]);return fe},ve=(fe,Ie)=>re(fe,he(Ie)),Be=fe=>E.REGISTERED_PROTOCOLS[fe.substring(0,fe.indexOf("://"))],Te=class extends Error{constructor(fe,Ie,ct,gn){super(`AJAXError: ${Ie} (${fe}): ${ct}`),this.status=fe,this.statusText=Ie,this.url=ct,this.body=gn}};function we(fe,Ie){const ct=new XMLHttpRequest,gn=Array.isArray(fe.url)?fe.url[0]:fe.url;ct.open(fe.method||"GET",gn,!0),fe.type==="arrayBuffer"&&(ct.responseType="arraybuffer");for(const ir in fe.headers)fe.headers.hasOwnProperty(ir)&&ct.setRequestHeader(ir,fe.headers[ir]);return fe.type==="json"&&(ct.responseType="text",ct.setRequestHeader("Accept","application/json")),ct.withCredentials=fe.credentials==="include",ct.onerror=()=>{Ie(new Error(ct.statusText))},ct.onload=()=>{if((ct.status>=200&&ct.status<300||ct.status===0)&&ct.response!==null){let ir=ct.response;if(fe.type==="json")try{ir=JSON.parse(ct.response)}catch(Ur){return Ie(Ur)}Ie(null,ir,ct.getResponseHeader("Cache-Control"),ct.getResponseHeader("Expires"),ct)}else{const ir=new Blob([ct.response],{type:ct.getResponseHeader("Content-Type")});Ie(new Te(ct.status,ct.statusText,gn.toString(),ir))}},ct.cancel=ct.abort,ct.send(fe.body),ct}function le(fe){return new Promise((Ie,ct)=>{we(fe,(gn,ir,Ur,mi,Ki)=>{gn?ct({err:gn,data:null,xhr:Ki}):Ie({err:null,data:ir,cacheControl:Ur,expires:mi,xhr:Ki})})})}function Ze(fe,Ie){return we(fe,Ie)}var xt=(fe,Ie)=>(Be(fe.url)||Ze)(ve(te({},fe),{type:"json"}),Ie),ft=(fe,Ie)=>(Be(fe.url)||Ze)(ve(te({},fe),{type:"arrayBuffer"}),Ie),Zt=(fe,Ie)=>Ze(ve(te({},fe),{method:"POST"}),Ie),pt=(fe,Ie)=>Ze(ve(te({},fe),{method:"GET"}),Ie);function vt(fe){const Ie=window.document.createElement("a");return Ie.href=fe,Ie.protocol===window.document.location.protocol&&Ie.host===window.document.location.host}var ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Re(fe,Ie){const ct=new window.Image,gn=window.URL||window.webkitURL;ct.crossOrigin="anonymous",ct.onload=()=>{Ie(null,ct),gn.revokeObjectURL(ct.src),ct.onload=null,window.requestAnimationFrame(()=>{ct.src=ke})},ct.onerror=()=>Ie(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ir=new Blob([new Uint8Array(fe)],{type:"image/png"});ct.src=fe.byteLength?gn.createObjectURL(ir):ke}function bt(fe,Ie){const ct=new Blob([new Uint8Array(fe)],{type:"image/png"});createImageBitmap(ct).then(gn=>{Ie(null,gn)}).catch(gn=>{Ie(new Error(`Could not load image because of ${gn.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var gt=(fe,Ie,ct)=>{const gn=(ir,Ur)=>{if(ir)Ie(ir);else if(Ur){const mi=typeof createImageBitmap=="function",Ki=ct?ct(Ur):Ur;mi?bt(Ki,Ie):Re(Ki,Ie)}};return fe.type==="json"?xt(fe,gn):ft(fe,gn)},Ct=(fe,Ie)=>{typeof createImageBitmap=="function"?bt(fe,Ie):Re(fe,Ie)},Sn=(fe=>(fe.CENTER="center",fe.TOP="top",fe["TOP-LEFT"]="top-left",fe["TOP-RIGHT"]="top-right",fe.BOTTOM="bottom",fe["BOTTOM-LEFT"]="bottom-left",fe["BOTTOM-RIGHT"]="bottom-right",fe.LEFT="left",fe.RIGHT="right",fe))(Sn||{}),He={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ot(fe,Ie,ct){const gn=fe.classList;for(const ir in He)He.hasOwnProperty(ir)&&gn.remove(`l7-${ct}-anchor-${ir}`);gn.add(`l7-${ct}-anchor-${Ie}`)}var Ce=D(37620);function ot(fe){return typeof fe=="string"?!!d3.color(fe):!1}function $e(fe){const Ie=Ce.ZP(fe),ct=[0,0,0,0];return Ie!=null&&(ct[0]=Ie.r/255,ct[1]=Ie.g/255,ct[2]=Ie.b/255,ct[3]=Ie.opacity),ct}function Xe(fe){const Ie=fe&&fe[0],ct=fe&&fe[1],gn=fe&&fe[2];return Ie+ct*256+gn*65536-1}function Rt(fe){return[fe+1&255,fe+1>>8&255,fe+1>>8>>8&255]}function _t(fe){let Ie=window.document.createElement("canvas"),ct=Ie.getContext("2d");Ie.width=256,Ie.height=1;let gn=null;const ir=ct.createLinearGradient(0,0,256,1),Ur=fe.positions[0],mi=fe.positions[fe.positions.length-1];for(let Ki=0;Ki<fe.colors.length;++Ki){const ma=(fe.positions[Ki]-Ur)/(mi-Ur);ir.addColorStop(ma,fe.colors[Ki])}return ct.fillStyle=ir,ct.fillRect(0,0,256,1),gn=new Uint8ClampedArray(ct.getImageData(0,0,256,1).data),Ie=null,ct=null,{data:gn,width:256,height:1}}function Pe(fe,Ie){let ct=window.document.createElement("canvas"),gn=ct.getContext("2d");ct.width=256,ct.height=1;const ir=gn.createLinearGradient(0,0,256,1),Ur=Ie[1]-Ie[0];for(let ma=0;ma<fe.colors.length;++ma){const ba=Math.max((fe.positions[ma]-Ie[0])/Ur,0);ir.addColorStop(ba,fe.colors[ma])}gn.fillStyle=ir,gn.fillRect(0,0,256,1);const mi=gn.getImageData(0,0,256,1).data,Ki=jn(gn,mi);return ct=null,gn=null,Ki}function Wt(fe){let Ie=window.document.createElement("canvas"),ct=Ie.getContext("2d");Ie.width=256,Ie.height=1;const gn=ct.createImageData(256,1);return gn.data.fill(0),fe.positions.forEach((ir,Ur)=>{const mi=$e(fe.colors[Ur]);gn.data[ir*4+0]=mi[0]*255,gn.data[ir*4+1]=mi[1]*255,gn.data[ir*4+2]=mi[2]*255,gn.data[ir*4+3]=mi[3]*255}),Ie=null,ct=null,gn}function on(fe){let Ie=window.document.createElement("canvas"),ct=Ie.getContext("2d");ct.globalAlpha=1,Ie.width=256,Ie.height=1;const gn=256/fe.colors.length;for(let mi=0;mi<fe.colors.length;mi++)ct.beginPath(),ct.lineWidth=2,ct.strokeStyle=fe.colors[mi],ct.moveTo(mi*gn,0),ct.lineTo((mi+1)*gn,0),ct.stroke();const ir=ct.getImageData(0,0,256,1).data,Ur=jn(ct,ir);return Ie=null,ct=null,Ur}function Nn(fe,Ie){let ct=window.document.createElement("canvas"),gn=ct.getContext("2d");gn.globalAlpha=1,ct.width=256,ct.height=1;const ir=Ie[1]-Ie[0];fe.positions.length-fe.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(let Ki=0;Ki<fe.colors.length;Ki++)gn.beginPath(),gn.lineWidth=2,gn.strokeStyle=fe.colors[Ki],gn.moveTo((fe.positions[Ki]-Ie[0])/ir*255,0),gn.lineTo((fe.positions[Ki+1]-Ie[0])/ir*255,0),gn.stroke();const Ur=gn.getImageData(0,0,256,1).data,mi=jn(gn,Ur);return ct=null,gn=null,mi}function jn(fe,Ie){const ct=fe.createImageData(256,1);for(let gn=0;gn<ct.data.length;gn+=4)ct.data[gn+0]=Ie[gn+0],ct.data[gn+1]=Ie[gn+1],ct.data[gn+2]=Ie[gn+2],ct.data[gn+3]=Ie[gn+3];return ct}function lr(fe){switch(fe==null?void 0:fe.type){case"cat":return[0,255];default:return[0,1]}}var Vt=D(74691),en=D.n(Vt),xn=D(50361),er=D.n(xn),sn=D(23279),Ut=D.n(sn),Dt=D(27361),Me=D.n(Dt),Qe=D(51584),Ft=D.n(Qe),U=D(18446),ue=D.n(U),at=D(14293),ce=D.n(at),j=D(81763),ln=D.n(j),fn=D(68630),mt=D.n(fn),Gt=D(47037),Wn=D.n(Gt),hn=D(36719),ht=D.n(hn),Ht=D(82492),Cn=D.n(Ht),Ln=D(30236),Gn=D.n(Ln),dt=D(97019),ye=D.n(dt),Fe=D(23493),nt=D.n(Fe),Pt=D(44908),Mt=D.n(Pt),Tn=D(11700),$n=D.n(Tn),xr=D(23560),qn=D.n(xr),Ae=D(13218),be=D.n(Ae),Ne=D(52353),et=D.n(Ne),wt=D(68929),qt=D.n(wt),vn=D(73955),yt=D.n(vn),Jt={isNil:ce(),merge:Cn(),throttle:nt(),isString:Wn(),debounce:Ut(),pull:ye(),isTypedArray:ht(),isPlainObject:mt(),isNumber:ln(),isBoolean:Ft(),isEqual:ue(),cloneDeep:er(),uniq:Mt(),clamp:en(),upperFirst:$n(),get:Me(),mergeWith:Gn(),isFunction:qn(),isObject:be(),isUndefined:et(),camelCase:qt(),uniqueId:yt()},{pull:Qn}=Jt;function Er(fe){let Ie=fe;return typeof fe=="string"&&(Ie=window.document.getElementById(fe)),Ie}function Vr(fe){return fe.trim?fe.trim():fe.replace(/^\s+|\s+$/g,"")}function mr(fe){return Vr(fe).split(/\s+/)}function kr(fe){var Ie;const ct=(Ie=document==null?void 0:document.documentElement)==null?void 0:Ie.style;if(!ct)return fe[0];for(const gn in fe)if(fe[gn]&&fe[gn]in ct)return fe[gn];return fe[0]}function Ei(fe,Ie,ct){const gn=window.document.createElement(fe);return Ie&&(gn.className=Ie||""),ct&&ct.appendChild(gn),gn}function Oi(fe){const Ie=fe.parentNode;Ie&&Ie.removeChild(fe)}function ar(fe,Ie){if(fe.classList!==void 0){const ct=mr(Ie);for(let gn=0,ir=ct.length;gn<ir;gn++)fe.classList.add(ct[gn])}else if(!hi(fe,Ie)){const ct=Ii(fe);Qr(fe,(ct?ct+" ":"")+Ie)}}function Kr(fe,Ie){fe.classList!==void 0?mr(Ie).forEach(gn=>{fe.classList.remove(gn)}):Qr(fe,Vr((" "+Ii(fe)+" ").replace(" "+Ie+" "," ")))}function hi(fe,Ie){if(fe.classList!==void 0)return fe.classList.contains(Ie);const ct=Ii(fe);return ct.length>0&&new RegExp("(^|\\s)"+Ie+"(\\s|$)").test(ct)}function Qr(fe,Ie){fe instanceof HTMLElement?fe.className=Ie:fe.className.baseVal=Ie}function Io(fe,Ie,ct){ct===void 0?hi(fe,Ie)?Kr(fe,Ie):ar(fe,Ie):ct?ar(fe,Ie):Kr(fe,Ie)}function Ii(fe){return fe instanceof SVGElement&&(fe=fe.correspondingElement),fe.className.baseVal===void 0?fe.className:fe.className.baseVal}function Fo(fe){for(;fe&&fe.firstChild;)fe.removeChild(fe.firstChild)}var _a=kr(["transform","WebkitTransform"]);function Co(fe,Ie){fe.style[_a]=Ie}function Qo(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{const fe=window.document.createEvent("UIEvents");fe.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(fe)}}function De(fe){const Ie=["padding: "+(fe.height/2-8)+"px "+fe.width/2+"px;","line-height: "+fe.height+"px;","background-image: url("+fe.toDataURL()+");"];console.log(`%c
`,Ie.join(""))}function Je(){var fe;const Ie=window.document.querySelector('meta[name="viewport"]');if(!Ie)return 1;const gn=((fe=Ie.content)==null?void 0:fe.split(",")).find(ir=>{const[Ur]=ir.split("=");return Ur==="initial-scale"});return gn?gn.split("=")[1]*1:1}var kt=Je()<1?1:window.devicePixelRatio;function un(fe,Ie){fe.setAttribute("style",`${fe.style.cssText}${Ie}`)}function Bn(fe){return fe.split(";").map(Ie=>Ie.trim()).filter(Ie=>Ie)}function kn(fe,Ie){var ct;const gn=Bn((ct=fe.getAttribute("style"))!=null?ct:""),ir=Bn(Ie),Ur=Qn(gn,...ir);fe.setAttribute("style",Ur.join(";"))}function pn(fe){return Object.entries(fe).map(([Ie,ct])=>`${Ie}: ${ct}`).join(";")}function On(fe,Ie){return{left:fe.left-Ie.left,top:fe.top-Ie.top,right:Ie.left+Ie.width-fe.left-fe.width,bottom:Ie.top+Ie.height-fe.top-fe.height}}function vr(fe,Ie){fe.checked=Ie,Ie?fe.setAttribute("checked","true"):fe.removeAttribute("checked")}function fr(fe){fe.innerHTML=""}function ci(fe){fe.setAttribute("draggable","false")}function Gi(fe,Ie){if(typeof Ie=="string"){const ct=document.createElement("div");for(ct.innerHTML=Ie;ct.firstChild;)fe.append(ct.firstChild)}else Array.isArray(Ie)?fe.append(...Ie):fe.append(Ie)}function no(fe,Ie){var ct;const gn=Array.isArray(Ie)?Ie:[Ie];let ir=fe;for(;ir instanceof Element&&ir!==window.document.body;){if(gn.find(Ur=>ir==null?void 0:ir.matches(Ur)))return ir;ir=(ct=ir==null?void 0:ir.parentElement)!=null?ct:null}}function Jr(fe){return typeof ImageBitmap!="undefined"&&fe instanceof ImageBitmap}function ji(){return typeof importScripts=="function"}var Di=ji()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Gr=navigator==null?void 0:navigator.userAgent,fo=!!Gr.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Ri=Gr.indexOf("Android")>-1||Gr.indexOf("Adr")>-1;function bo(){const fe=Gr,Ie=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let ct=!0;for(const gn of Ie)if(fe.indexOf(gn)>0){ct=!1;break}return ct}function xi(fe,Ie){fe.forEach(ct=>{Ie[ct]&&(Ie[ct]=Ie[ct].bind(Ie))})}var wo=class{constructor(fe=16){this.duration=16,this.timestamp=new Date().getTime(),this.duration=fe}run(fe){const Ie=new Date().getTime(),ct=Ie-this.timestamp;this.timestamp=Ie,ct>=this.duration&&fe()}},ia=D(39034);function Ga(fe){var Ie=[1/0,1/0,-1/0,-1/0];return(0,ia.pZ)(fe,function(ct){Ie[0]>ct[0]&&(Ie[0]=ct[0]),Ie[1]>ct[1]&&(Ie[1]=ct[1]),Ie[2]<ct[0]&&(Ie[2]=ct[0]),Ie[3]<ct[1]&&(Ie[3]=ct[1])}),Ie}Ga.default=Ga;var Jo=Ga,Wo=D(1449);function Ha(fe){return typeof fe=="number"}function ds(fe){return fe-Math.fround(fe)}var Tt=2*Math.PI*6378137/2;function Yt(fe,Ie){const[ct,gn,ir,Ur]=Ie;return fe.lng>ct&&fe.lng<=ir&&fe.lat>gn&&fe.lat<=Ur}function Fn(fe){const Ie=[1/0,1/0,-1/0,-1/0];return fe.forEach(ct=>{const{coordinates:gn}=ct;dr(Ie,gn)}),Ie}function dr(fe,Ie){return Array.isArray(Ie[0])?Ie.forEach(ct=>{dr(fe,ct)}):(fe[0]>Ie[0]&&(fe[0]=Ie[0]),fe[1]>Ie[1]&&(fe[1]=Ie[1]),fe[2]<Ie[0]&&(fe[2]=Ie[0]),fe[3]<Ie[1]&&(fe[3]=Ie[1])),fe}function ai(fe,Ie){return Xr(fe,Ie)}function Xr(fe,Ie){return Array.isArray(fe[0])?fe.map(ct=>Xr(ct,Ie)):Ie(fe)}function Uo(fe,Ie=!0,ct={enable:!0,decimal:1}){fe=nl(fe,Ie);const gn=fe[0],ir=fe[1];let Ur=gn*Tt/180,mi=Math.log(Math.tan((90+ir)*Math.PI/360))/(Math.PI/180);return mi=mi*Tt/180,ct.enable&&(Ur=Number(Ur.toFixed(ct.decimal)),mi=Number(mi.toFixed(ct.decimal))),fe.length===3?[Ur,mi,fe[2]]:[Ur,mi]}function Xo(fe,Ie=6){const ct=fe[0],gn=fe[1];let ir=ct/Tt*180,Ur=gn/Tt*180;return Ur=180/Math.PI*(2*Math.atan(Math.exp(Ur*Math.PI/180))-Math.PI/2),Ie!=null&&(ir=Number(ir.toFixed(Ie)),Ur=Number(Ur.toFixed(Ie))),fe.length===3?[ir,Ur,fe[2]]:[ir,Ur]}function ya(fe){if(fe==null)throw new Error("lng is required");return(fe>180||fe<-180)&&(fe=fe%360,fe>180&&(fe=-360+fe),fe<-180&&(fe=360+fe),fe===0&&(fe=0)),fe}function vs(fe){if(fe==null)throw new Error("lat is required");return(fe>90||fe<-90)&&(fe=fe%180,fe>90&&(fe=-180+fe),fe<-90&&(fe=180+fe),fe===0&&(fe=0)),fe}function nl(fe,Ie){if(Ie===!1)return fe;const ct=ya(fe[0]);let gn=vs(fe[1]);return gn>85&&(gn=85),gn<-85&&(gn=-85),fe.length===3?[ct,gn,fe[2]]:[ct,gn]}function $f(fe){const Ie=85.0511287798,ct=Math.max(Math.min(Ie,fe[1]),-Ie),gn=256<<20;let ir=Math.PI/180,Ur=fe[0]*ir,mi=ct*ir;mi=Math.log(Math.tan(Math.PI/4+mi/2));const Ki=.5/Math.PI,ma=.5,ba=-.5/Math.PI;return ir=.5,Ur=gn*(Ki*Ur+ma),mi=gn*(ba*mi+ir),[Math.floor(Ur),Math.floor(mi)]}function jd(fe){const Ie=.5/Math.PI,ct=.5,gn=-.5/Math.PI;let ir=.5;const Ur=256<<20;let[mi,Ki]=fe;mi=(mi/Ur-ct)/Ie,Ki=(Ki/Ur-ir)/gn,Ki=(Math.atan(Math.pow(Math.E,Ki))-Math.PI/4)*2,ir=Math.PI/180;const ma=Ki/ir;return[mi/ir,ma]}function Uh(fe,Ie){const ct=85.0511287798,gn=Math.PI/180,ir=6378137;return Ie=Math.max(Math.min(ct,Ie),-ct),fe*=gn,Ie*=gn,Ie=Math.log(Math.tan(Math.PI/4+Ie/2)),[fe*ir,Ie*ir]}function Pl(fe,Ie){const ct=Math.PI/180,gn=6378137,ir=fe/gn/ct,Ur=2*(Math.atan(Math.exp(Ie/gn))-Math.PI/4)/ct;return[ir,Ur]}function Df(fe,Ie,ct){const gn=degreesToRadians(Ie[1]-fe[1]),ir=degreesToRadians(Ie[0]-fe[0]),Ur=degreesToRadians(fe[1]),mi=degreesToRadians(Ie[1]),Ki=Math.pow(Math.sin(gn/2),2)+Math.pow(Math.sin(ir/2),2)*Math.cos(Ur)*Math.cos(mi);return radiansToLength(2*Math.atan2(Math.sqrt(Ki),Math.sqrt(1-Ki)),ct="meters")}function Nf(fe){const Ie=Math.PI/180,ct=85.0511287798,gn=6378137,ir=Math.max(Math.min(ct,fe[1]),-ct),Ur=Math.sin(ir*Ie),mi=gn*fe[0]*Ie,Ki=gn*Math.log((1+Ur)/(1-Ur))/2;return[mi,Ki]}function rc(fe,Ie){const ct=Math.abs(fe[1][1]-fe[0][1])*Ie,gn=Math.abs(fe[1][0]-fe[0][0])*Ie;return[[fe[0][0]-gn,fe[0][1]-ct],[fe[1][0]+gn,fe[1][1]+ct]]}function gu(fe,Ie){return fe[0][0]<=Ie[0][0]&&fe[0][1]<=Ie[0][1]&&fe[1][0]>=Ie[1][0]&&fe[1][1]>=Ie[1][1]}function ou(fe){return[[fe[0],fe[1]],[fe[2],fe[3]]]}function qu(fe){const Ie=lc(fe,[0,0]);return[fe[0]/Ie,fe[1]/Ie]}function lc(fe,Ie){return Math.sqrt(Math.pow(fe[0]-Ie[0],2)+Math.pow(fe[1]-Ie[1],2))}function Xs(fe,Ie){return fe[0]*Ie[0]+fe[1]*Ie[1]}function Lu(fe){return Math.sqrt(fe[0]*fe[0]+fe[1]*fe[1])}function gf(fe,Ie){return Math.acos(Xs(fe,Ie)/(Lu(fe)*Lu(Ie)))*180/Math.PI}function jh(fe,Ie){return Ie[0]>0?Ie[1]>0?90-Math.atan(Ie[1]/Ie[0])*180/Math.PI:90+Math.atan(-Ie[1]/Ie[0])*180/Math.PI:Ie[1]<0?180+(90-Math.atan(Ie[1]/Ie[0])*180/Math.PI):270+Math.atan(Ie[1]/-Ie[0])*180/Math.PI}function bp(fe,Ie=100){if(!fe||fe.length<2)return;const ct=[0,1];let gn=0;const ir=[];for(let Ur=0;Ur<fe.length-1;Ur++){const mi=fe[Ur],Ki=fe[Ur+1],ma=lc(mi,Ki);gn+=ma;const ba=[mi[0]-Ki[0],mi[1]-Ki[1]];let bs=jh(ct,ba);if(Ur>0){const za=ir[Ur-1].rotation;za-bs>360-za+bs&&(bs=bs+360)}ir.push({start:mi,end:Ki,dis:ma,rotation:bs,duration:0})}return ir.map(Ur=>{Ur.duration=Ie*(Ur.dis/gn)}),ir}function vh(fe){if(Ha(fe[0]))return fe;if(Ha(fe[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ha(fe[0][0][0])){const Ie=fe;let ct=0,gn=0,ir=0;return Ie.forEach(Ur=>{Ur.forEach(mi=>{ct+=mi[0],gn+=mi[1],ir++})}),[ct/ir,gn/ir,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Kf(fe){let Ie=fe[0],ct=fe[1],gn=fe[0],ir=fe[1],Ur=0,mi=0,Ki=0;for(let ma=0;ma<fe.length;ma+=2){const ba=fe[ma],bs=fe[ma+1];ba&&bs&&(Ie=Math.max(ba,Ie),ct=Math.max(bs,ct),gn=Math.min(ba,gn),ir=Math.min(bs,ir),Ur+=ba,mi+=bs,Ki++)}return{center:[Ur/Ki,mi/Ki],radius:Math.sqrt(Math.pow(Ie-gn,2)+Math.pow(ct-ir,2))/2}}function Du(fe){return Jo((0,Wo.uf)([(0,Wo.Tu)(fe)]))}function gh(fe){let gn=0;fe+="x";const ir=Math.floor(9007199254740991/137);for(let Ur=0;Ur<fe.length;Ur++)gn>ir&&(gn=Math.floor(gn/137)),gn=gn*131+fe.charCodeAt(Ur);return gn}function Vh(fe){fe=fe.toString();let Ie=5381,ct=fe.length;for(;ct;)Ie=Ie*33^fe.charCodeAt(--ct);return Ie>>>0}function bd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,fe=>{const Ie=Math.random()*16|0;return(fe==="x"?Ie:Ie&3|8).toString(16)})}function t0(fe,Ie,ct,gn,ir=30,Ur){let mi=ct;return Ur&&(mi=Math.round(ct*(ir-1))/(ir-1)),gn?zl(fe,Ie,mi,gn):zl(fe,Ie,mi,.314)}function qf(fe,Ie){const ct=1-Ie;return(fe[0]*ct+fe[1]*Ie)*ct+(fe[1]*ct+fe[2]*Ie)*Ie}function yu(fe,Ie){return Math.sqrt(Math.pow(fe[0]-Ie[0],2)+Math.pow(fe[1]-Ie[1],2))}function Vd(fe,Ie,ct){const gn=[Ie[0]-fe[0],Ie[1]-fe[1]],ir=yu(gn,[0,0]),Ur=Math.atan2(gn[1],gn[0]),mi=ir/2/Math.cos(ct),Ki=Ur+ct;return[mi*Math.cos(Ki)+fe[0],mi*Math.sin(Ki)+fe[1]]}function zl(fe,Ie,ct,gn){const ir=Vd(fe,Ie,gn),Ur=[fe[0],ir[0],Ie[0]],mi=[fe[1],ir[1],Ie[1]];return[qf(Ur,ct),qf(mi,ct),0]}function _u(fe,Ie,ct,gn,ir=30,Ur){let mi=ct;return Ur&&(mi=Math.round(ct*29)/29),_s(fe,Ie,mi)}function Qu(fe,Ie){const ct=[fe[0]-Ie[0],fe[1]-Ie[1]],gn=[Math.sin(ct[0]/2),Math.sin(ct[1]/2)],ir=gn[1]*gn[1]+Math.cos(fe[1])*Math.cos(Ie[1])*gn[0]*gn[0];return 2*Math.atan2(Math.sqrt(ir),Math.sqrt(1-ir))}function _s(fe,Ie,ct){const gn=[degreesToRadians(fe[0]),degreesToRadians(fe[1])],ir=[degreesToRadians(Ie[0]),degreesToRadians(Ie[1])],Ur=Qu(gn,ir);if(Math.abs(Ur-Math.PI)<.001)return[(1-ct)*gn[0]+ct*ir[0],(1-ct)*gn[1]+ct*ir[1]];const mi=Math.sin((1-ct)*Ur)/Math.sin(Ur),Ki=Math.sin(ct*Ur)/Math.sin(Ur),ma=[Math.sin(gn[0]),Math.sin(gn[1])],ba=[Math.cos(gn[0]),Math.cos(gn[1])],bs=[Math.sin(ir[0]),Math.sin(ir[1])],za=[Math.cos(ir[0]),Math.cos(ir[1])],Na=mi*ba[1]*ba[0]+Ki*za[1]*za[0],Sc=mi*ba[1]*ma[0]+Ki*za[1]*bs[0],nf=mi*ma[1]+Ki*bs[1];return[radiansToDegrees(Math.atan2(Sc,Na)),radiansToDegrees(Math.atan2(nf,Math.sqrt(Na*Na+Sc*Sc)))]}function au(fe,Ie){let ct=0;const gn=[];for(let Ki=0;Ki<fe.length-1;Ki++){const ma=fe[Ki],ba=fe[Ki+1],bs=Ju(ma,ba),za=ct;ct+=bs,gn.push({p1:ma,p2:ba,totalDistance:ct,distance:bs,lastTotalDistance:za})}const ir=ct*Ie;let Ur,mi;for(const Ki of gn)if(Ki.totalDistance>ir){const ba=Ki.p1,bs=Ki.p2,za=(ir-Ki.lastTotalDistance)/Ki.distance,Na=xc(bs,ba,za);Ur=Na[0],mi=Na[1];break}return{lng:Ur,lat:mi,height:0}}function xc(fe,Ie,ct){return[fe[0]*ct+Ie[0]*(1-ct),fe[1]*ct+Ie[1]*(1-ct)]}function Ju(fe,Ie){return Math.sqrt(Math.pow(fe[0]-Ie[0],2)+Math.pow(fe[1]-Ie[1],2))}var hl=Object.defineProperty,Nu=Object.getOwnPropertySymbols,ef=Object.prototype.hasOwnProperty,Hd=Object.prototype.propertyIsEnumerable,Hh=(fe,Ie,ct)=>Ie in fe?hl(fe,Ie,{enumerable:!0,configurable:!0,writable:!0,value:ct}):fe[Ie]=ct,ns=(fe,Ie)=>{for(var ct in Ie||(Ie={}))ef.call(Ie,ct)&&Hh(fe,ct,Ie[ct]);if(Nu)for(var ct of Nu(Ie))Hd.call(Ie,ct)&&Hh(fe,ct,Ie[ct]);return fe};function yh(fe,Ie){const{featureId:ct}=Ie;let gn=fe.data.dataArray;return typeof ct=="number"&&(gn=gn.filter(({id:ir})=>ir===ct)),gn.map(ir=>{const Ur=Wh(ir,Ie);return ns(ns({},ir),Ur)})}function Zh(fe,Ie){return new Promise(ct=>{fe.inited?ct(yh(fe,Ie)):fe.once("update",()=>{ct(yh(fe,Ie))})})}function Wh(fe,Ie){const{offset:ct,shape:gn,thetaOffset:ir,segmentNumber:Ur=30,autoFit:mi=!0}=Ie,{coordinates:Ki}=fe;if(gn==="line")return pathLineAtOffset(Ki,ct);const ma=Ki[0],ba=Ki[1],bs=typeof ir=="string"?fe[ir]||0:ir;let za;switch(gn){case"arc":za=arcLineAtOffset;break;case"greatcircle":za=greatCircleLineAtOffset;break;default:za=arcLineAtOffset}const[Na,Sc,nf]=za(ma,ba,ct,bs,Ur,mi);return{lng:Na,lat:Sc,height:nf}}var rl=class{constructor(fe=50,Ie){this.limit=fe,this.destroy=Ie||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(fe=>{this.delete(fe)}),this.cache={},this.order=[]}get(fe){const Ie=this.cache[fe];return Ie&&(this.deleteOrder(fe),this.appendOrder(fe)),Ie}set(fe,Ie){this.cache[fe]?(this.delete(fe),this.cache[fe]=Ie,this.appendOrder(fe)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[fe]=Ie,this.appendOrder(fe))}delete(fe){const Ie=this.cache[fe];Ie&&(this.deleteCache(fe),this.deleteOrder(fe),this.destroy(Ie,fe))}deleteCache(fe){delete this.cache[fe]}deleteOrder(fe){const Ie=this.order.findIndex(ct=>ct===fe);Ie>=0&&this.order.splice(Ie,1)}appendOrder(fe){this.order.push(fe)}defaultDestroy(fe,Ie){return null}};function Bf(fe){if(fe.length===0)throw new Error("max requires at least one data point");let Ie=fe[0];for(let ct=1;ct<fe.length;ct++)fe[ct]>Ie&&(Ie=fe[ct]);return Ie*1}function _h(fe){if(fe.length===0)throw new Error("min requires at least one data point");let Ie=fe[0];for(let ct=1;ct<fe.length;ct++)fe[ct]<Ie&&(Ie=fe[ct]);return Ie*1}function ne(fe){if(fe.length===0)return 0;let Ie=fe[0]*1;for(let ct=1;ct<fe.length;ct++)Ie+=fe[ct]*1;return Ie}function ge(fe){if(fe.length===0)throw new Error("mean requires at least one data point");return ne(fe)/fe.length}function qe(fe){if(fe.length===0)throw new Error("mean requires at least one data point");if(fe.length<3)return fe[0];fe.sort();let Ie=fe[0],ct=NaN,gn=0,ir=1;for(let Ur=1;Ur<fe.length+1;Ur++)fe[Ur]!==Ie?(ir>gn&&(gn=ir,ct=Ie),ir=1,Ie=fe[Ur]):ir++;return ct*1}var mn={min:_h,max:Bf,mean:ge,sum:ne,mode:qe};function K(fe,Ie){return fe.map(ct=>ct[Ie])}function tr(fe,Ie){return mn[fe](Ie)}function Mr(fe,Ie){Ie===void 0&&(Ie={});var ct=Number(fe[0]),gn=Number(fe[1]),ir=Number(fe[2]),Ur=Number(fe[3]);if(fe.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var mi=[ct,gn],Ki=[ct,Ur],ma=[ir,Ur],ba=[ir,gn];return(0,Wo.yu)([[mi,ba,ma,Ki,mi]],Ie.properties,{bbox:fe,id:Ie.id})}var Bi=D(26729),zi=D.n(Bi),so=(fe=>(fe.Realtime="realtime",fe.Overlap="overlap",fe.Replace="replace",fe))(so||{}),Si=(fe=>(fe.Loading="Loading",fe.Loaded="Loaded",fe.Failure="Failure",fe.Cancelled="Cancelled",fe))(Si||{}),Sa=0,Do=1,ha=2;function rs(fe){fe.forEach(Ie=>{Ie.isCurrent&&(Ie.isVisible=Ie.isLoaded)})}function ua(fe){fe.forEach(Ie=>{Ie.properties.state=Sa}),fe.forEach(Ie=>{Ie.isCurrent&&!ls(Ie)&&Ma(Ie)}),fe.forEach(Ie=>{Ie.isVisible=!!(Ie.properties.state&ha)})}function Aa(fe){fe.forEach(ct=>{ct.properties.state=Sa}),fe.forEach(ct=>{ct.isCurrent&&ls(ct)}),fe.slice().sort((ct,gn)=>ct.z-gn.z).forEach(ct=>{ct.isVisible=!!(ct.properties.state&ha),ct.children.length&&(ct.isVisible||ct.properties.state&Do)?ct.children.forEach(gn=>{gn.properties.state=Do}):ct.isCurrent&&Ma(ct)})}function ls(fe){for(;fe;){if(fe.isLoaded)return fe.properties.state|=ha,!0;fe=fe.parent}return!1}function Ma(fe){fe.children.forEach(Ie=>{Ie.isLoaded?Ie.properties.state|=ha:Ma(Ie)})}var Da=256,Xa=[-1/0,-1/0,1/0,1/0],Ls=.2,Qa=5,Ec={[so.Realtime]:rs,[so.Overlap]:ua,[so.Replace]:Aa},cs=()=>{};function Bu(fe,Ie,ct){const gn=Math.floor((fe+180)/360*Math.pow(2,ct)),ir=Math.floor((1-Math.log(Math.tan(Ie*Math.PI/180)+1/Math.cos(Ie*Math.PI/180))/Math.PI)/2*Math.pow(2,ct));return[gn,ir]}function bu(fe,Ie,ct){const gn=fe/Math.pow(2,ct)*360-180,ir=Math.PI-2*Math.PI*Ie/Math.pow(2,ct),Ur=180/Math.PI*Math.atan(.5*(Math.exp(ir)-Math.exp(-ir)));return[gn,Ur]}var Nc=(fe,Ie,ct)=>{const[gn,ir]=bu(fe,Ie,ct),[Ur,mi]=bu(fe+1,Ie+1,ct);return[gn,mi,Ur,ir]};function Qf({zoom:fe,latLonBounds:Ie,maxZoom:ct=1/0,minZoom:gn=0,zoomOffset:ir=0,extent:Ur=Xa}){let mi=Math.ceil(fe)+ir;if(Number.isFinite(gn)&&mi<gn)return[];Number.isFinite(ct)&&mi>ct&&(mi=ct);const[Ki,ma,ba,bs]=Ie,za=[Math.max(Ki,Ur[0]),Math.max(ma,Ur[1]),Math.min(ba,Ur[2]),Math.min(bs,Ur[3])],Na=[],[Sc,nf]=Bu(za[0],za[1],mi),[Ys,io]=Bu(za[2],za[3],mi);for(let _l=Sc;_l<=Ys;_l++)for(let Ja=io;Ja<=nf;Ja++)Na.push({x:_l,y:Ja,z:mi});const Wc=(Ys+Sc)/2,Gd=(nf+io)/2,$h=(_l,Ja)=>Math.abs(_l-Wc)+Math.abs(Ja-Gd);return Na.sort((_l,Ja)=>$h(_l.x,_l.y)-$h(Ja.x,Ja.y)),Na}var xd=(fe,Ie,ct,gn=!0)=>{const ir=Math.pow(2,ct),Ur=ir-1,mi=ir;let Ki=fe;const ma=Ie;return gn&&(Ki<0?Ki=Ki+mi:Ki>Ur&&(Ki=Ki%mi)),{warpX:Ki,warpY:ma}},bh=(fe,Ie,ct)=>new Promise((gn,ir)=>{var Ur=ma=>{try{Ki(ct.next(ma))}catch(ba){ir(ba)}},mi=ma=>{try{Ki(ct.throw(ma))}catch(ba){ir(ba)}},Ki=ma=>ma.done?gn(ma.value):Promise.resolve(ma.value).then(Ur,mi);Ki((ct=ct.apply(fe,Ie)).next())}),yf=class extends Bi.EventEmitter{constructor(fe){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:Ie,y:ct,z:gn,tileSize:ir,warp:Ur=!0}=fe;this.x=Ie,this.y=ct,this.z=gn,this.warp=Ur||!0,this.tileSize=ir}get isLoading(){return this.loadStatus===Si.Loading}get isLoaded(){return this.loadStatus===Si.Loaded}get isFailure(){return this.loadStatus===Si.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===Si.Cancelled}get isDone(){return[Si.Loaded,Si.Cancelled,Si.Failure].includes(this.loadStatus)}get bounds(){return Nc(this.x,this.y,this.z)}get bboxPolygon(){const[fe,Ie,ct,gn]=this.bounds,ir=[(ct-fe)/2,(gn-Ie)/2];return Mr(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:ir,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(fe){return bh(this,arguments,function*({getData:Ie,onLoad:ct,onError:gn}){this.loadDataId++;const ir=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Si.Loading;let Ur=null,mi;try{const{x:Ki,y:ma,z:ba,bounds:bs,tileSize:za,warp:Na}=this,{warpX:Sc,warpY:nf}=xd(Ki,ma,ba,Na),{signal:Ys}=this.abortController;Ur=yield Ie({x:Sc,y:nf,z:ba,bounds:bs,tileSize:za,signal:Ys,warp:Na},this)}catch(Ki){mi=Ki}if(ir===this.loadDataId&&!(this.isCancelled&&!Ur)){if(mi||!Ur){this.loadStatus=Si.Failure,gn(mi,this);return}this.loadStatus=Si.Loaded,this.data=Ur,ct(this)}})}reloadData(fe){this.isLoading&&this.abortLoad(),this.loadData(fe)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=Si.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},tf=(fe,Ie)=>{const ct=ou(fe),gn=rc(ct,Ie),ir=360*3-180,Ur=85.0511287798065;return[Math.max(gn[0][0],-ir),Math.max(gn[0][1],-Ur),Math.min(gn[1][0],ir),Math.min(gn[1][1],Ur)]},Gh=(fe,Ie)=>{const ct=ou(fe),gn=ou(Ie);return gu(ct,gn)},xh=Object.defineProperty,Fu=Object.defineProperties,n0=Object.getOwnPropertyDescriptors,Jf=Object.getOwnPropertySymbols,xp=Object.prototype.hasOwnProperty,Ed=Object.prototype.propertyIsEnumerable,Bc=(fe,Ie,ct)=>Ie in fe?xh(fe,Ie,{enumerable:!0,configurable:!0,writable:!0,value:ct}):fe[Ie]=ct,Xh=(fe,Ie)=>{for(var ct in Ie||(Ie={}))xp.call(Ie,ct)&&Bc(fe,ct,Ie[ct]);if(Jf)for(var ct of Jf(Ie))Ed.call(Ie,ct)&&Bc(fe,ct,Ie[ct]);return fe},Zd=(fe,Ie)=>Fu(fe,n0(Ie)),{throttle:Eh}=Jt,Yh=(fe=>(fe.TilesLoadStart="tiles-load-start",fe.TileLoaded="tile-loaded",fe.TileError="tile-error",fe.TileUnload="tile-unload",fe.TileUpdate="tile-update",fe.TilesLoadFinished="tiles-load-finished",fe))(Yh||{}),xu=class extends zi(){constructor(fe){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=Eh((Ie,ct)=>{this.update(Ie,ct)},16),this.onTileLoad=Ie=>{this.emit("tile-loaded",Ie),this.updateTileVisible(),this.loadFinished()},this.onTileError=(Ie,ct)=>{this.emit("tile-error",{error:Ie,tile:ct}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=Ie=>{this.emit("tile-unload",Ie),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Xa,getTileData:cs,warp:!0,updateStrategy:so.Replace},this.updateOptions(fe)}get isLoaded(){return this.currentTiles.every(fe=>fe.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((Ie,ct)=>Ie.z-ct.z)}updateOptions(fe){const Ie=fe.minZoom===void 0?this.options.minZoom:Math.ceil(fe.minZoom),ct=fe.maxZoom===void 0?this.options.maxZoom:Math.floor(fe.maxZoom);this.options=Zd(Xh(Xh({},this.options),fe),{minZoom:Ie,maxZoom:ct})}update(fe,Ie){const ct=Math.max(0,Math.ceil(fe));if(this.lastViewStates&&this.lastViewStates.zoom===ct&&Gh(this.lastViewStates.latLonBoundsBuffer,Ie))return;const gn=tf(Ie,Ls);this.lastViewStates={zoom:ct,latLonBounds:Ie,latLonBoundsBuffer:gn},this.currentZoom=ct;let ir=!1;const Ur=this.getTileIndices(ct,gn).filter(mi=>this.options.warp||mi.x>=0&&mi.x<Math.pow(2,ct));this.emit("tiles-load-start"),this.currentTiles=Ur.map(({x:mi,y:Ki,z:ma})=>{let ba=this.getTile(mi,Ki,ma);return ba?(((ba==null?void 0:ba.isFailure)||(ba==null?void 0:ba.isCancelled))&&ba.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),ba):(ba=this.createTile(mi,Ki,ma),ir=!0,ba)}),ir&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[fe,Ie]of this.cacheTiles){if(!this.currentTiles.includes(Ie)){this.cacheTiles.delete(fe),this.onTileUnload(Ie);return}this.onTileUnload(Ie),Ie.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(fe,Ie,ct){const gn=this.cacheTiles.get(`${Ie},${ct},${fe}`);gn&&(this.onTileUnload(gn),gn.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(fe,Ie,ct){const gn=this.getTileByLngLat(fe,Ie,ct);gn&&this.reloadTileById(gn.z,gn.x,gn.y)}reloadTileByExtent(fe,Ie){this.getTileIndices(Ie,fe).forEach(gn=>{this.reloadTileById(gn.z,gn.x,gn.y)})}pruneRequests(){const fe=[];for(const Ie of this.cacheTiles.values())Ie.isLoading&&!Ie.isCurrent&&!Ie.isVisible&&fe.push(Ie);for(;fe.length>0;)fe.shift().abortLoad()}getTileByLngLat(fe,Ie,ct){const{zoomOffset:gn}=this.options,ir=Math.ceil(ct)+gn,Ur=Bu(fe,Ie,ir);return this.tiles.filter(Ki=>Ki.key===`${Ur[0]}_${Ur[1]}_${ir}`)[0]}getTileExtent(fe,Ie){return this.getTileIndices(Ie,fe)}getTileByZXY(fe,Ie,ct){return this.tiles.filter(ir=>ir.key===`${Ie}_${ct}_${fe}`)[0]}clear(){for(const fe of this.cacheTiles.values())fe.isLoading?fe.abortLoad():this.onTileUnload(fe);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const fe=this.options.updateStrategy,Ie=new Map;for(const ir of this.cacheTiles.values())Ie.set(ir.key,ir.isVisible),ir.isCurrent=!1,ir.isVisible=!1;for(const ir of this.currentTiles)ir.isCurrent=!0,ir.isVisible=!0;const ct=Array.from(this.cacheTiles.values());typeof fe=="function"?fe(ct):Ec[fe](ct);let gn=!1;Array.from(this.cacheTiles.values()).forEach(ir=>{ir.isVisible!==Ie.get(ir.key)?(ir.isVisibleChange=!0,gn=!0):ir.isVisibleChange=!1}),gn&&this.emit("tile-update")}getTileIndices(fe,Ie){const{tileSize:ct,extent:gn,zoomOffset:ir}=this.options,Ur=Math.floor(this.options.maxZoom),mi=Math.ceil(this.options.minZoom);return Qf({maxZoom:Ur,minZoom:mi,zoomOffset:ir,tileSize:ct,zoom:fe,latLonBounds:Ie,extent:gn})}getTileId(fe,Ie,ct){return`${fe},${Ie},${ct}`}loadFinished(){const fe=!this.currentTiles.some(Ie=>!Ie.isDone);return fe&&this.emit("tiles-load-finished"),fe}getTile(fe,Ie,ct){const gn=this.getTileId(fe,Ie,ct);return this.cacheTiles.get(gn)}createTile(fe,Ie,ct){const gn=this.getTileId(fe,Ie,ct),ir=new yf({x:fe,y:Ie,z:ct,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(gn,ir),ir.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),ir}resizeCacheTiles(){const fe=Qa*this.currentTiles.length;if(this.cacheTiles.size>fe){for(const[ct,gn]of this.cacheTiles)if(!gn.isVisible&&!this.currentTiles.includes(gn)&&(this.cacheTiles.delete(ct),this.onTileUnload(gn)),this.cacheTiles.size<=fe)break}this.rebuildTileTree()}rebuildTileTree(){for(const fe of this.cacheTiles.values())fe.parent=null,fe.children.length=0;for(const fe of this.cacheTiles.values()){const Ie=this.getNearestAncestor(fe.x,fe.y,fe.z);fe.parent=Ie,Ie!=null&&Ie.children&&Ie.children.push(fe)}}getNearestAncestor(fe,Ie,ct){for(;ct>this.options.minZoom;){fe=Math.floor(fe/2),Ie=Math.floor(Ie/2),ct=ct-1;const gn=this.getTile(fe,Ie,ct);if(gn)return gn}return null}};function Sh(fe){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(fe)}function _f(fe){const Ie=[];let ct=/\{([a-z])-([a-z])\}/.exec(fe);if(ct){const gn=ct[1].charCodeAt(0),ir=ct[2].charCodeAt(0);let Ur;for(Ur=gn;Ur<=ir;++Ur)Ie.push(fe.replace(ct[0],String.fromCharCode(Ur)));return Ie}if(ct=/\{(\d+)-(\d+)\}/.exec(fe),ct){const gn=parseInt(ct[2],10);for(let ir=parseInt(ct[1],10);ir<=gn;ir++)Ie.push(fe.replace(ct[0],ir.toString()));return Ie}return Ie.push(fe),Ie}function ks(fe,Ie){if(!fe||!fe.length)throw new Error("url is not allowed to be empty");const{x:ct,y:gn,z:ir}=Ie,Ur=_f(fe),mi=Math.abs(ct+gn)%Ur.length;return(Be(Ur[mi])?`${Ur[mi]}/{z}/{x}/{y}`:Ur[mi]).replace(/\{x\}/g,ct.toString()).replace(/\{y\}/g,gn.toString()).replace(/\{z\}/g,ir.toString()).replace(/\{bbox\}/g,Nc(ct,gn,ir).join(",")).replace(/\{-y\}/g,(Math.pow(2,ir)-gn-1).toString())}function Wd(fe,Ie){const{x:ct,y:gn,z:ir,layer:Ur,version:mi="1.0.0",style:Ki="default",format:ma,service:ba="WMTS",tileMatrixset:bs}=Ie,za=_f(fe),Na=Math.abs(ct+gn)%za.length;return`${za[Na]}&SERVICE=${ba}&REQUEST=GetTile&VERSION=${mi}&LAYER=${Ur}&STYLE=${Ki}&TILEMATRIXSET=${bs}&FORMAT=${ma}&TILECOL=${ct}&TILEROW=${gn}&TILEMATRIX=${ir}`}function Gl(fe,Ie){return fe==null?Ie:fe}},48271:function($t,W,D){"use strict";D.d(W,{oT:function(){return Zr},Ie:function(){return Fy},dW:function(){return zy},GI:function(){return zb},xs:function(){return mO}});var ee={},X={},E=a=>X[a],_e=(a,o)=>{X[a]=o},re=a=>ee[a],he=(a,o)=>{ee[a]=o},se={},Se={},oe=34,je=10,te=13;function ve(a){return new Function("d","return {"+a.map(function(o,f){return JSON.stringify(o)+": d["+f+'] || ""'}).join(",")+"}")}function Be(a,o){var f=ve(a);return function(v,T){return o(f(v),T,a)}}function Te(a){var o=Object.create(null),f=[];return a.forEach(function(v){for(var T in v)T in o||f.push(o[T]=T)}),f}function we(a,o){var f=a+"",v=f.length;return v<o?new Array(o-v+1).join(0)+f:f}function le(a){return a<0?"-"+we(-a,6):a>9999?"+"+we(a,6):we(a,4)}function Ze(a){var o=a.getUTCHours(),f=a.getUTCMinutes(),v=a.getUTCSeconds(),T=a.getUTCMilliseconds();return isNaN(a)?"Invalid Date":le(a.getUTCFullYear(),4)+"-"+we(a.getUTCMonth()+1,2)+"-"+we(a.getUTCDate(),2)+(T?"T"+we(o,2)+":"+we(f,2)+":"+we(v,2)+"."+we(T,3)+"Z":v?"T"+we(o,2)+":"+we(f,2)+":"+we(v,2)+"Z":f||o?"T"+we(o,2)+":"+we(f,2)+"Z":"")}function xt(a){var o=new RegExp('["'+a+`
\r]`),f=a.charCodeAt(0);function v(Ee,Ye){var Lt,an,Pn=T(Ee,function(sr,Rr){if(Lt)return Lt(sr,Rr-1);an=sr,Lt=Ye?Be(sr,Ye):ve(sr)});return Pn.columns=an||[],Pn}function T(Ee,Ye){var Lt=[],an=Ee.length,Pn=0,sr=0,Rr,Tr=an<=0,li=!1;Ee.charCodeAt(an-1)===je&&--an,Ee.charCodeAt(an-1)===te&&--an;function Ui(){if(Tr)return Se;if(li)return li=!1,se;var eo,Wr=Pn,Wi;if(Ee.charCodeAt(Wr)===oe){for(;Pn++<an&&Ee.charCodeAt(Pn)!==oe||Ee.charCodeAt(++Pn)===oe;);return(eo=Pn)>=an?Tr=!0:(Wi=Ee.charCodeAt(Pn++))===je?li=!0:Wi===te&&(li=!0,Ee.charCodeAt(Pn)===je&&++Pn),Ee.slice(Wr+1,eo-1).replace(/""/g,'"')}for(;Pn<an;){if((Wi=Ee.charCodeAt(eo=Pn++))===je)li=!0;else if(Wi===te)li=!0,Ee.charCodeAt(Pn)===je&&++Pn;else if(Wi!==f)continue;return Ee.slice(Wr,eo)}return Tr=!0,Ee.slice(Wr,an)}for(;(Rr=Ui())!==Se;){for(var Lo=[];Rr!==se&&Rr!==Se;)Lo.push(Rr),Rr=Ui();Ye&&(Lo=Ye(Lo,sr++))==null||Lt.push(Lo)}return Lt}function O(Ee,Ye){return Ee.map(function(Lt){return Ye.map(function(an){return xe(Lt[an])}).join(a)})}function L(Ee,Ye){return Ye==null&&(Ye=Te(Ee)),[Ye.map(xe).join(a)].concat(O(Ee,Ye)).join(`
`)}function F(Ee,Ye){return Ye==null&&(Ye=Te(Ee)),O(Ee,Ye).join(`
`)}function H(Ee){return Ee.map(ie).join(`
`)}function ie(Ee){return Ee.map(xe).join(a)}function xe(Ee){return Ee==null?"":Ee instanceof Date?Ze(Ee):o.test(Ee+="")?'"'+Ee.replace(/"/g,'""')+'"':Ee}return{parse:v,parseRows:T,format:L,formatBody:F,formatRows:H,formatRow:ie,formatValue:xe}}var ft=xt(","),Zt=ft.parse,pt=ft.parseRows,vt=ft.format,ke=ft.formatBody,Re=ft.formatRows,bt=ft.formatRow,gt=ft.formatValue,Ct=D(1449);function Sn(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function He(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ot(a){if(a.length>1&&isNumber(a[0])&&isNumber(a[1]))return!0;if(Array.isArray(a[0])&&a[0].length)return Ot(a[0]);throw new Error("coordinates must only contain numbers")}function Ce(a,o,f){if(!o||!f)throw new Error("type and name required");if(!a||a.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+a.type)}function ot(a,o,f){if(!a)throw new Error("No feature passed");if(!f)throw new Error(".featureOf() requires a name");if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+f+", Feature with geometry required");if(!a.geometry||a.geometry.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+a.geometry.type)}function $e(a,o,f){if(!a)throw new Error("No featureCollection passed");if(!f)throw new Error(".collectionOf() requires a name");if(!a||a.type!=="FeatureCollection")throw new Error("Invalid input to "+f+", FeatureCollection required");for(var v=0,T=a.features;v<T.length;v++){var O=T[v];if(!O||O.type!=="Feature"||!O.geometry)throw new Error("Invalid input to "+f+", Feature with geometry required");if(!O.geometry||O.geometry.type!==o)throw new Error("Invalid input to "+f+": must be a "+o+", given "+O.geometry.type)}}function Xe(a){return a.type==="Feature"?a.geometry:a}function Rt(a,o){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}var _t=D(39034),Pe=D(8543),Wt=D(38163),on=D.n(Wt);function Nn(a,o){return a.map(f=>f[o]*1)}function jn(a){return a===void 0?!1:!Array.isArray(a)&&a.data!==void 0}function lr(a){return Array.isArray(a)?a.length===0?!1:!!jn(a[0]):!1}function Vt(a){return Array.isArray(a)?a.length===0||typeof a[0]=="number":!1}function en(a){const o=Object.isFrozen(a)?Pe.lodashUtil.cloneDeep(a):a;return on()(o,!0),o}function xn(a,o){return a||[[o[0],o[3]],[o[2],o[3]],[o[2],o[1]],[o[0],o[1]]]}var er=Object.defineProperty,sn=Object.defineProperties,Ut=Object.getOwnPropertyDescriptors,Dt=Object.getOwnPropertySymbols,Me=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable,Ft=(a,o,f)=>o in a?er(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,U=(a,o)=>{for(var f in o||(o={}))Me.call(o,f)&&Ft(a,f,o[f]);if(Dt)for(var f of Dt(o))Qe.call(o,f)&&Ft(a,f,o[f]);return a},ue=(a,o)=>sn(a,Ut(o));function at(a,o){const{x:f,y:v,x1:T,y1:O,coordinates:L,geometry:F}=o,H=[];if(!Array.isArray(a))return{dataArray:[]};if(F)return a.filter(ie=>ie[F]&&ie[F].type&&ie[F].coordinates&&ie[F].coordinates.length>0).forEach((ie,xe)=>{const Ee=en(ie[F]);(0,_t.nG)(Ee,Ye=>{const Lt=He(Ye),an=ue(U({},ie),{_id:xe,coordinates:Lt});H.push(an)})}),{dataArray:H};for(let ie=0;ie<a.length;ie++){const xe=a[ie];let Ee=[];if(L){let Lt="Polygon";Array.isArray(L[0])||(Lt="Point"),Array.isArray(L[0])&&!Array.isArray(L[0][0])&&(Lt="LineString"),Ee=en({type:Lt,coordinates:xe[L]}).coordinates}else if(f&&v&&T&&O){const Lt=[parseFloat(xe[f]),parseFloat(xe[v])],an=[parseFloat(xe[T]),parseFloat(xe[O])];Ee=[Lt,an]}else f&&v&&(Ee=[parseFloat(xe[f]),parseFloat(xe[v])]);const Ye=ue(U({},xe),{_id:ie,coordinates:Ee});H.push(Ye)}return{dataArray:H}}function ce(a,o){const f=Zt(a);return at(f,o)}var j=Object.defineProperty,ln=Object.defineProperties,fn=Object.getOwnPropertyDescriptors,mt=Object.getOwnPropertySymbols,Gt=Object.prototype.hasOwnProperty,Wn=Object.prototype.propertyIsEnumerable,hn=(a,o,f)=>o in a?j(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,ht=(a,o)=>{for(var f in o||(o={}))Gt.call(o,f)&&hn(a,f,o[f]);if(mt)for(var f of mt(o))Wn.call(o,f)&&hn(a,f,o[f]);return a},Ht=(a,o)=>ln(a,fn(o));function Cn(a){const o=a.toString();let f=5381,v=o.length;for(;v;)f=f*33^o.charCodeAt(--v);return f>>>0}function Ln(a,o){return o===void 0?null:typeof(a.properties[o]*1)=="number"?a.properties[o]*1:a.properties&&a.properties[o]?Cn(a.properties[o]+"")%1000019:null}function Gn(a,o){const f=[],v={};return a.features?(a.features=a.features.filter(T=>{const O=T.geometry;return T!=null&&O&&O.type&&O.coordinates&&O.coordinates.length>0}),a=en(a),a.features.length===0?{dataArray:[],featureKeys:v}:((0,_t.nG)(a,(T,O)=>{let L=Ln(T,o==null?void 0:o.featureId);L===null&&(L=O);const F=L,H=He(T),ie=Ht(ht({},T.properties),{coordinates:H,_id:F});f.push(ie)}),{dataArray:f,featureKeys:v})):(a.features=[],{dataArray:[]})}function dt(a,o,f,v){for(var T=v,O=f-o>>1,L=f-o,F,H=a[o],ie=a[o+1],xe=a[f],Ee=a[f+1],Ye=o+3;Ye<f;Ye+=3){var Lt=ye(a[Ye],a[Ye+1],H,ie,xe,Ee);if(Lt>T)F=Ye,T=Lt;else if(Lt===T){var an=Math.abs(Ye-O);an<L&&(F=Ye,L=an)}}T>v&&(F-o>3&&dt(a,o,F,v),a[F+2]=T,f-F>3&&dt(a,F,f,v))}function ye(a,o,f,v,T,O){var L=T-f,F=O-v;if(L!==0||F!==0){var H=((a-f)*L+(o-v)*F)/(L*L+F*F);H>1?(f=T,v=O):H>0&&(f+=L*H,v+=F*H)}return L=a-f,F=o-v,L*L+F*F}function Fe(a,o,f,v){var T={id:typeof a=="undefined"?null:a,type:o,geometry:f,tags:v,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return nt(T),T}function nt(a){var o=a.geometry,f=a.type;if(f==="Point"||f==="MultiPoint"||f==="LineString")Pt(a,o);else if(f==="Polygon"||f==="MultiLineString")for(var v=0;v<o.length;v++)Pt(a,o[v]);else if(f==="MultiPolygon")for(v=0;v<o.length;v++)for(var T=0;T<o[v].length;T++)Pt(a,o[v][T])}function Pt(a,o){for(var f=0;f<o.length;f+=3)a.minX=Math.min(a.minX,o[f]),a.minY=Math.min(a.minY,o[f+1]),a.maxX=Math.max(a.maxX,o[f]),a.maxY=Math.max(a.maxY,o[f+1])}function Mt(a,o){var f=[];if(a.type==="FeatureCollection")for(var v=0;v<a.features.length;v++)Tn(f,a.features[v],o,v);else a.type==="Feature"?Tn(f,a,o):Tn(f,{geometry:a},o);return f}function Tn(a,o,f,v){if(o.geometry){var T=o.geometry.coordinates,O=o.geometry.type,L=Math.pow(f.tolerance/((1<<f.maxZoom)*f.extent),2),F=[],H=o.id;if(f.promoteId?H=o.properties[f.promoteId]:f.generateId&&(H=v||0),O==="Point")$n(T,F);else if(O==="MultiPoint")for(var ie=0;ie<T.length;ie++)$n(T[ie],F);else if(O==="LineString")xr(T,F,L,!1);else if(O==="MultiLineString")if(f.lineMetrics){for(ie=0;ie<T.length;ie++)F=[],xr(T[ie],F,L,!1),a.push(Fe(H,"LineString",F,o.properties));return}else qn(T,F,L,!1);else if(O==="Polygon")qn(T,F,L,!0);else if(O==="MultiPolygon")for(ie=0;ie<T.length;ie++){var xe=[];qn(T[ie],xe,L,!0),F.push(xe)}else if(O==="GeometryCollection"){for(ie=0;ie<o.geometry.geometries.length;ie++)Tn(a,{id:H,geometry:o.geometry.geometries[ie],properties:o.properties},f,v);return}else throw new Error("Input data is not a valid GeoJSON object.");a.push(Fe(H,O,F,o.properties))}}function $n(a,o){o.push(Ae(a[0])),o.push(be(a[1])),o.push(0)}function xr(a,o,f,v){for(var T,O,L=0,F=0;F<a.length;F++){var H=Ae(a[F][0]),ie=be(a[F][1]);o.push(H),o.push(ie),o.push(0),F>0&&(v?L+=(T*ie-H*O)/2:L+=Math.sqrt(Math.pow(H-T,2)+Math.pow(ie-O,2))),T=H,O=ie}var xe=o.length-3;o[2]=1,dt(o,0,xe,f),o[xe+2]=1,o.size=Math.abs(L),o.start=0,o.end=o.size}function qn(a,o,f,v){for(var T=0;T<a.length;T++){var O=[];xr(a[T],O,f,v),o.push(O)}}function Ae(a){return a/360+.5}function be(a){var o=Math.sin(a*Math.PI/180),f=.5-.25*Math.log((1+o)/(1-o))/Math.PI;return f<0?0:f>1?1:f}function Ne(a,o,f,v,T,O,L,F){if(f/=o,v/=o,O>=f&&L<v)return a;if(L<f||O>=v)return null;for(var H=[],ie=0;ie<a.length;ie++){var xe=a[ie],Ee=xe.geometry,Ye=xe.type,Lt=T===0?xe.minX:xe.minY,an=T===0?xe.maxX:xe.maxY;if(Lt>=f&&an<v){H.push(xe);continue}else if(an<f||Lt>=v)continue;var Pn=[];if(Ye==="Point"||Ye==="MultiPoint")et(Ee,Pn,f,v,T);else if(Ye==="LineString")wt(Ee,Pn,f,v,T,!1,F.lineMetrics);else if(Ye==="MultiLineString")vn(Ee,Pn,f,v,T,!1);else if(Ye==="Polygon")vn(Ee,Pn,f,v,T,!0);else if(Ye==="MultiPolygon")for(var sr=0;sr<Ee.length;sr++){var Rr=[];vn(Ee[sr],Rr,f,v,T,!0),Rr.length&&Pn.push(Rr)}if(Pn.length){if(F.lineMetrics&&Ye==="LineString"){for(sr=0;sr<Pn.length;sr++)H.push(Fe(xe.id,Ye,Pn[sr],xe.tags));continue}(Ye==="LineString"||Ye==="MultiLineString")&&(Pn.length===1?(Ye="LineString",Pn=Pn[0]):Ye="MultiLineString"),(Ye==="Point"||Ye==="MultiPoint")&&(Ye=Pn.length===3?"Point":"MultiPoint"),H.push(Fe(xe.id,Ye,Pn,xe.tags))}}return H.length?H:null}function et(a,o,f,v,T){for(var O=0;O<a.length;O+=3){var L=a[O+T];L>=f&&L<=v&&(o.push(a[O]),o.push(a[O+1]),o.push(a[O+2]))}}function wt(a,o,f,v,T,O,L){for(var F=qt(a),H=T===0?Jt:Qn,ie=a.start,xe,Ee,Ye=0;Ye<a.length-3;Ye+=3){var Lt=a[Ye],an=a[Ye+1],Pn=a[Ye+2],sr=a[Ye+3],Rr=a[Ye+4],Tr=T===0?Lt:an,li=T===0?sr:Rr,Ui=!1;L&&(xe=Math.sqrt(Math.pow(Lt-sr,2)+Math.pow(an-Rr,2))),Tr<f?li>f&&(Ee=H(F,Lt,an,sr,Rr,f),L&&(F.start=ie+xe*Ee)):Tr>v?li<v&&(Ee=H(F,Lt,an,sr,Rr,v),L&&(F.start=ie+xe*Ee)):yt(F,Lt,an,Pn),li<f&&Tr>=f&&(Ee=H(F,Lt,an,sr,Rr,f),Ui=!0),li>v&&Tr<=v&&(Ee=H(F,Lt,an,sr,Rr,v),Ui=!0),!O&&Ui&&(L&&(F.end=ie+xe*Ee),o.push(F),F=qt(a)),L&&(ie+=xe)}var Lo=a.length-3;Lt=a[Lo],an=a[Lo+1],Pn=a[Lo+2],Tr=T===0?Lt:an,Tr>=f&&Tr<=v&&yt(F,Lt,an,Pn),Lo=F.length-3,O&&Lo>=3&&(F[Lo]!==F[0]||F[Lo+1]!==F[1])&&yt(F,F[0],F[1],F[2]),F.length&&o.push(F)}function qt(a){var o=[];return o.size=a.size,o.start=a.start,o.end=a.end,o}function vn(a,o,f,v,T,O){for(var L=0;L<a.length;L++)wt(a[L],o,f,v,T,O,!1)}function yt(a,o,f,v){a.push(o),a.push(f),a.push(v)}function Jt(a,o,f,v,T,O){var L=(O-o)/(v-o);return a.push(O),a.push(f+(T-f)*L),a.push(1),L}function Qn(a,o,f,v,T,O){var L=(O-f)/(T-f);return a.push(o+(v-o)*L),a.push(O),a.push(1),L}function Er(a,o){var f=o.buffer/o.extent,v=a,T=Ne(a,1,-1-f,f,0,-1,2,o),O=Ne(a,1,1-f,2+f,0,-1,2,o);return(T||O)&&(v=Ne(a,1,-f,1+f,0,-1,2,o)||[],T&&(v=Vr(T,1).concat(v)),O&&(v=v.concat(Vr(O,-1)))),v}function Vr(a,o){for(var f=[],v=0;v<a.length;v++){var T=a[v],O=T.type,L;if(O==="Point"||O==="MultiPoint"||O==="LineString")L=mr(T.geometry,o);else if(O==="MultiLineString"||O==="Polygon"){L=[];for(var F=0;F<T.geometry.length;F++)L.push(mr(T.geometry[F],o))}else if(O==="MultiPolygon")for(L=[],F=0;F<T.geometry.length;F++){for(var H=[],ie=0;ie<T.geometry[F].length;ie++)H.push(mr(T.geometry[F][ie],o));L.push(H)}f.push(Fe(T.id,O,L,T.tags))}return f}function mr(a,o){var f=[];f.size=a.size,a.start!==void 0&&(f.start=a.start,f.end=a.end);for(var v=0;v<a.length;v+=3)f.push(a[v]+o,a[v+1],a[v+2]);return f}function kr(a,o){if(a.transformed)return a;var f=1<<a.z,v=a.x,T=a.y,O,L,F;for(O=0;O<a.features.length;O++){var H=a.features[O],ie=H.geometry,xe=H.type;if(H.geometry=[],xe===1)for(L=0;L<ie.length;L+=2)H.geometry.push(Ei(ie[L],ie[L+1],o,f,v,T));else for(L=0;L<ie.length;L++){var Ee=[];for(F=0;F<ie[L].length;F+=2)Ee.push(Ei(ie[L][F],ie[L][F+1],o,f,v,T));H.geometry.push(Ee)}}return a.transformed=!0,a}function Ei(a,o,f,v,T,O){return[Math.round(f*(a*v-T)),Math.round(f*(o*v-O))]}function Oi(a,o,f,v,T){for(var O=o===T.maxZoom?0:T.tolerance/((1<<o)*T.extent),L={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:f,y:v,z:o,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},F=0;F<a.length;F++){L.numFeatures++,ar(L,a[F],O,T);var H=a[F].minX,ie=a[F].minY,xe=a[F].maxX,Ee=a[F].maxY;H<L.minX&&(L.minX=H),ie<L.minY&&(L.minY=ie),xe>L.maxX&&(L.maxX=xe),Ee>L.maxY&&(L.maxY=Ee)}return L}function ar(a,o,f,v){var T=o.geometry,O=o.type,L=[];if(O==="Point"||O==="MultiPoint")for(var F=0;F<T.length;F+=3)L.push(T[F]),L.push(T[F+1]),a.numPoints++,a.numSimplified++;else if(O==="LineString")Kr(L,T,a,f,!1,!1);else if(O==="MultiLineString"||O==="Polygon")for(F=0;F<T.length;F++)Kr(L,T[F],a,f,O==="Polygon",F===0);else if(O==="MultiPolygon")for(var H=0;H<T.length;H++){var ie=T[H];for(F=0;F<ie.length;F++)Kr(L,ie[F],a,f,!0,F===0)}if(L.length){var xe=o.tags||null;if(O==="LineString"&&v.lineMetrics){xe={};for(var Ee in o.tags)xe[Ee]=o.tags[Ee];xe.mapbox_clip_start=T.start/T.size,xe.mapbox_clip_end=T.end/T.size}var Ye={geometry:L,type:O==="Polygon"||O==="MultiPolygon"?3:O==="LineString"||O==="MultiLineString"?2:1,tags:xe};o.id!==null&&(Ye.id=o.id),a.features.push(Ye)}}function Kr(a,o,f,v,T,O){var L=v*v;if(v>0&&o.size<(T?L:v)){f.numPoints+=o.length/3;return}for(var F=[],H=0;H<o.length;H+=3)(v===0||o[H+2]>L)&&(f.numSimplified++,F.push(o[H]),F.push(o[H+1])),f.numPoints++;T&&hi(F,O),a.push(F)}function hi(a,o){for(var f=0,v=0,T=a.length,O=T-2;v<T;O=v,v+=2)f+=(a[v]-a[O])*(a[v+1]+a[O+1]);if(f>0===o)for(v=0,T=a.length;v<T/2;v+=2){var L=a[v],F=a[v+1];a[v]=a[T-2-v],a[v+1]=a[T-1-v],a[T-2-v]=L,a[T-1-v]=F}}function Qr(a,o){return new Io(a,o)}function Io(a,o){o=this.options=Fo(Object.create(this.options),o);var f=o.debug;if(f&&console.time("preprocess data"),o.maxZoom<0||o.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(o.promoteId&&o.generateId)throw new Error("promoteId and generateId cannot be used together.");var v=Mt(a,o);this.tiles={},this.tileCoords=[],f&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",o.indexMaxZoom,o.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),v=Er(v,o),v.length&&this.splitTile(v,0,0,0),f&&(v.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Io.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Io.prototype.splitTile=function(a,o,f,v,T,O,L){for(var F=[a,o,f,v],H=this.options,ie=H.debug;F.length;){v=F.pop(),f=F.pop(),o=F.pop(),a=F.pop();var xe=1<<o,Ee=Ii(o,f,v),Ye=this.tiles[Ee];if(!Ye&&(ie>1&&console.time("creation"),Ye=this.tiles[Ee]=Oi(a,o,f,v,H),this.tileCoords.push({z:o,x:f,y:v}),ie)){ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",o,f,v,Ye.numFeatures,Ye.numPoints,Ye.numSimplified),console.timeEnd("creation"));var Lt="z"+o;this.stats[Lt]=(this.stats[Lt]||0)+1,this.total++}if(Ye.source=a,T){if(o===H.maxZoom||o===T)continue;var an=1<<T-o;if(f!==Math.floor(O/an)||v!==Math.floor(L/an))continue}else if(o===H.indexMaxZoom||Ye.numPoints<=H.indexMaxPoints)continue;if(Ye.source=null,a.length!==0){ie>1&&console.time("clipping");var Pn=.5*H.buffer/H.extent,sr=.5-Pn,Rr=.5+Pn,Tr=1+Pn,li,Ui,Lo,eo,Wr,Wi;li=Ui=Lo=eo=null,Wr=Ne(a,xe,f-Pn,f+Rr,0,Ye.minX,Ye.maxX,H),Wi=Ne(a,xe,f+sr,f+Tr,0,Ye.minX,Ye.maxX,H),a=null,Wr&&(li=Ne(Wr,xe,v-Pn,v+Rr,1,Ye.minY,Ye.maxY,H),Ui=Ne(Wr,xe,v+sr,v+Tr,1,Ye.minY,Ye.maxY,H),Wr=null),Wi&&(Lo=Ne(Wi,xe,v-Pn,v+Rr,1,Ye.minY,Ye.maxY,H),eo=Ne(Wi,xe,v+sr,v+Tr,1,Ye.minY,Ye.maxY,H),Wi=null),ie>1&&console.timeEnd("clipping"),F.push(li||[],o+1,f*2,v*2),F.push(Ui||[],o+1,f*2,v*2+1),F.push(Lo||[],o+1,f*2+1,v*2),F.push(eo||[],o+1,f*2+1,v*2+1)}}},Io.prototype.getTile=function(a,o,f){var v=this.options,T=v.extent,O=v.debug;if(a<0||a>24)return null;var L=1<<a;o=(o%L+L)%L;var F=Ii(a,o,f);if(this.tiles[F])return kr(this.tiles[F],T);O>1&&console.log("drilling down to z%d-%d-%d",a,o,f);for(var H=a,ie=o,xe=f,Ee;!Ee&&H>0;)H--,ie=Math.floor(ie/2),xe=Math.floor(xe/2),Ee=this.tiles[Ii(H,ie,xe)];return!Ee||!Ee.source?null:(O>1&&console.log("found parent tile z%d-%d-%d",H,ie,xe),O>1&&console.time("drilling down"),this.splitTile(Ee.source,H,ie,xe,a,o,f),O>1&&console.timeEnd("drilling down"),this.tiles[F]?kr(this.tiles[F],T):null)};function Ii(a,o,f){return((1<<a)*f+o)*32+a}function Fo(a,o){for(var f in o)a[f]=o[f];return a}var _a=class{constructor(a,o,f,v){this.vectorLayerCache={},this.x=o,this.y=f,this.z=v,this.vectorTile=a}getTileData(a){return!a||!this.vectorTile.layers[a]?[]:this.vectorLayerCache[a]?this.vectorLayerCache[a]:this.vectorTile.layers[a].features}getFeatureById(){throw new Error("Method not implemented.")}},Co=Object.defineProperty,Qo=Object.defineProperties,De=Object.getOwnPropertyDescriptors,Je=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable,Bn=(a,o,f)=>o in a?Co(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,kn=(a,o)=>{for(var f in o||(o={}))kt.call(o,f)&&Bn(a,f,o[f]);if(Je)for(var f of Je(o))un.call(o,f)&&Bn(a,f,o[f]);return a},pn=(a,o)=>Qo(a,De(o)),On=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),vr={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function fr(a){let o=0;for(let f=0,v=a.length,T=v-1,O,L;f<v;T=f++)O=a[f],L=a[T],o+=(L.x-O.x)*(O.y+L.y);return o}function ci(a){const o=a.length;if(o<=1)return[a];const f=[];let v,T;for(let O=0;O<o;O++){const L=fr(a[O]);L!==0&&(T===void 0&&(T=L<0),T===L<0?(v&&f.push(v),v=[a[O]]):v.push(a[O]))}return v&&f.push(v),f}var Gi=["Unknown","Point","LineString","Polygon"];function no(a,o,f,v,T){let O=T.geometry;const L=T.type,F=T.tags,H=T.id,ie=a*Math.pow(2,v),xe=a*o,Ee=a*f;let Ye=Gi[L],Lt,an;function Pn(Rr){for(let Tr=0;Tr<Rr.length;Tr++){const li=Rr[Tr];if(li[3])break;const Ui=180-(li[1]+Ee)*360/ie,Lo=(li[0]+xe)*360/ie-180,eo=360/Math.PI*Math.atan(Math.exp(Ui*Math.PI/180))-90;Rr[Tr]=[Lo,eo,0,1]}}switch(L){case 1:const Rr=[];for(Lt=0;Lt<O.length;Lt++)Rr[Lt]=O[Lt][0];O=Rr,Pn(O);break;case 2:for(Lt=0;Lt<O.length;Lt++)Pn(O[Lt]);break;case 3:for(O=ci(O),Lt=0;Lt<O.length;Lt++)for(an=0;an<O[Lt].length;an++)Pn(O[Lt][an]);break}return O.length===1?O=O[0]:Ye="Multi"+Ye,{type:"Feature",geometry:{type:Ye,coordinates:O},properties:F,id:H,tileOrigin:[0,0],coord:""}}var Jr=(a,o,f,v)=>On(void 0,null,function*(){return new Promise(T=>{const O=o.getTile(a.z,a.x,a.y),F={layers:{defaultLayer:{features:O?O.features.map(ie=>no(v,f.x,f.y,f.z,ie)):[]}}},H=new _a(F,a.x,a.y,a.z);T(H)})});function ji(a){const o={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return a===void 0||typeof a.geojsonvtOptions=="undefined"?o:kn(kn({},o),a.geojsonvtOptions)}function Di(a,o){const f=ji(o),v=f.extent||4096,T=Qr(a,f),O=(F,H)=>Jr(H,T,F,v),L=pn(kn(kn({},vr),o),{getTileData:O});return{data:a,dataArray:[],tilesetOptions:L,isTile:!0}}var Gr=Object.defineProperty,fo=Object.defineProperties,Ri=Object.getOwnPropertyDescriptors,bo=Object.getOwnPropertySymbols,xi=Object.prototype.hasOwnProperty,wo=Object.prototype.propertyIsEnumerable,ia=(a,o,f)=>o in a?Gr(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Ga=(a,o)=>{for(var f in o||(o={}))xi.call(o,f)&&ia(a,f,o[f]);if(bo)for(var f of bo(o))wo.call(o,f)&&ia(a,f,o[f]);return a},Jo=(a,o)=>fo(a,Ri(o));function Wo(a,o){const{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:v,requestParameters:T={}}=o,O=new Promise(H=>{a instanceof HTMLImageElement||(0,Pe.fg)(a)?H([a]):Ha(a,T,ie=>{H(ie)})}),L=xn(v,f);return{originData:a,images:O,_id:1,dataArray:[{_id:0,coordinates:L}]}}function Ha(a,o,f){const v=[];if(typeof a=="string")(0,Pe.gJ)(Jo(Ga({},o),{url:a}),(T,O)=>{O&&(v.push(O),f(v))});else{const T=a.length;let O=0;a.forEach(L=>{(0,Pe.gJ)(Jo(Ga({},o),{url:L}),(F,H)=>{O++,H&&v.push(H),O===T&&f(v)})})}return Wo}var ds=Object.defineProperty,Tt=Object.defineProperties,Yt=Object.getOwnPropertyDescriptors,Fn=Object.getOwnPropertySymbols,dr=Object.prototype.hasOwnProperty,ai=Object.prototype.propertyIsEnumerable,Xr=(a,o,f)=>o in a?ds(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Uo=(a,o)=>{for(var f in o||(o={}))dr.call(o,f)&&Xr(a,f,o[f]);if(Fn)for(var f of Fn(o))ai.call(o,f)&&Xr(a,f,o[f]);return a},Xo=(a,o)=>Tt(a,Yt(o)),ya=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),vs=(a,o,f,v)=>ya(void 0,null,function*(){const T={x:o.x,y:o.y,z:o.z},O=(0,Pe.z0)(a,T);return new Promise(L=>{v?v(T,(F,H)=>{if(F||!H){const ie={layers:{defaultLayer:{features:[]}}},xe=new _a(ie,o.x,o.y,o.z);L(xe)}else{const ie={layers:{defaultLayer:{features:H.features}}},xe=new _a(ie,o.x,o.y,o.z);L(xe)}}):(0,Pe.Yu)(Xo(Uo({},f),{url:O}),(F,H)=>{if(F||!H){const ie={layers:{defaultLayer:{features:[]}}},xe=new _a(ie,o.x,o.y,o.z);L(xe)}else{const xe={layers:{defaultLayer:{features:JSON.parse(H)}}},Ee=new _a(xe,o.x,o.y,o.z);L(Ee)}})})});function nl(a,o){const f=(T,O)=>vs(a,O,o==null?void 0:o.requestParameters,o.getCustomData),v=Xo(Uo({},o),{getTileData:f});return{dataArray:[],tilesetOptions:v,isTile:!0}}var $f=D(38929),jd=D(3614),Uh=D.n(jd),Pl=Object.defineProperty,Df=Object.defineProperties,Nf=Object.getOwnPropertyDescriptors,rc=Object.getOwnPropertySymbols,gu=Object.prototype.hasOwnProperty,ou=Object.prototype.propertyIsEnumerable,qu=(a,o,f)=>o in a?Pl(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,lc=(a,o)=>{for(var f in o||(o={}))gu.call(o,f)&&qu(a,f,o[f]);if(rc)for(var f of rc(o))ou.call(o,f)&&qu(a,f,o[f]);return a},Xs=(a,o)=>Df(a,Nf(o)),Lu=class{constructor(a,o,f,v){this.vectorLayerCache={},this.x=o,this.y=f,this.z=v,this.vectorTile=new $f.VectorTile(new(Uh())(a))}getTileData(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];const o=this.vectorTile.layers[a];if(Array.isArray(o.features))return this.vectorLayerCache[a]=o.features,o.features;const f=[];for(let v=0;v<o.length;v++){const O=o.feature(v).toGeoJSON(this.x,this.y,this.z);f.push(Xs(lc({},O),{properties:lc({id:O.id},O.properties)}))}return this.vectorLayerCache[a]=f,f}getFeatureById(){throw new Error("Method not implemented.")}},gf=Object.defineProperty,jh=Object.defineProperties,bp=Object.getOwnPropertyDescriptors,vh=Object.getOwnPropertySymbols,Kf=Object.prototype.hasOwnProperty,Du=Object.prototype.propertyIsEnumerable,gh=(a,o,f)=>o in a?gf(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Vh=(a,o)=>{for(var f in o||(o={}))Kf.call(o,f)&&gh(a,f,o[f]);if(vh)for(var f of vh(o))Du.call(o,f)&&gh(a,f,o[f]);return a},bd=(a,o)=>jh(a,bp(o)),t0=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),qf={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},yu=(a,o,f,v,T)=>t0(void 0,null,function*(){const O=(0,Pe.z0)(a,o);return new Promise(L=>{if(T)T({x:f.x,y:f.y,z:f.z},(F,H)=>{if(F||!H)L(void 0);else{const ie=new Lu(H,f.x,f.y,f.z);L(ie)}});else{const F=(0,Pe.ks)(bd(Vh({},v),{url:O}),(H,ie)=>{if(H||!ie)L(void 0);else{const xe=new Lu(ie,f.x,f.y,f.z);L(xe)}});f.xhrCancel=()=>F.cancel()}})});function Vd(a,o){const f=Array.isArray(a)?a[0]:a,v=(O,L)=>yu(f,O,L,o==null?void 0:o.requestParameters,o==null?void 0:o.getCustomData),T=bd(Vh(Vh({},qf),o),{getTileData:v});return{data:f,dataArray:[],tilesetOptions:T,isTile:!0}}function zl(a,o,f){switch(a){case"+":return o+f;case"-":return o-f;case"*":return o*f;case"/":return o/f;case"%":return o%f;case"^":return Math.pow(o,f);case"abs":return Math.abs(o);case"floor":return Math.floor(o);case"round":return Math.round(o);case"ceil":return Math.ceil(o);case"sin":return Math.sin(o);case"cos":return Math.cos(o);case"atan":return f===-1?Math.atan(o):Math.atan2(o,f);case"min":return Math.min(o,f);case"max":return Math.max(o,f);case"log10":return Math.log(o);case"log2":return Math.log2(o);default:return console.warn("Calculate symbol err! Return default 0"),0}}function _u(a,o){const{width:f,height:v}=o[0],T=o.map(H=>H.rasterData),O=f*v,L=[],F=JSON.stringify(a);for(let H=0;H<O;H++){const ie=JSON.parse(F),xe=Qu(ie,T,H);if(typeof xe=="number")L.push(xe);else{const Ee=au(ie);L.push(Ee)}}return L}function Qu(a,o,f){if(a.length===2&&a[0]==="band"&&typeof a[1]=="number")try{return o[a[1]][f]}catch(v){return console.warn("Raster Data err!"),0}a.map((v,T)=>{if(Array.isArray(v)&&v.length>0)switch(v[0]){case"band":try{a[T]=o[v[1]][f]}catch(O){console.warn("Raster Data err!"),a[T]=0}break;default:Qu(v,o,f)}})}function _s(a){const[o,f=-1,v=-1]=a;return o===void 0?(console.warn("Express err!"),["+",0,0]):[o.replace(/\s+/g,""),f,v]}function au(a){const o=_s(a),f=o[0];let v=o[1],T=o[2];return Array.isArray(v)&&(v=au(a[1])),Array.isArray(T)&&(T=au(a[2])),zl(f,v,T)}var xc={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:Ju}};function Ju(a,o){const f=a[0].rasterData,v=a[1].rasterData,T=a[2].rasterData,O=[],[L,F]=(o==null?void 0:o.countCut)||[2,98],H=(o==null?void 0:o.RMinMax)||hl(f,L,F),ie=(o==null?void 0:o.GMinMax)||hl(v,L,F),xe=(o==null?void 0:o.BMinMax)||hl(T,L,F);for(let Ee=0;Ee<f.length;Ee++)O.push(Math.max(0,f[Ee]-H[0])),O.push(Math.max(0,v[Ee]-ie[0])),O.push(Math.max(0,T[Ee]-xe[0]));return{rasterData:O,rMinMax:H,gMinMax:ie,bMinMax:xe}}function hl(a,o,f){const v=a.slice().sort((F,H)=>F-H),T=v.length,O=v[Math.ceil(T*o/100)],L=v[Math.ceil(T*f/100)];return[O,L]}var Nu=Object.defineProperty,ef=Object.defineProperties,Hd=Object.getOwnPropertyDescriptors,Hh=Object.getOwnPropertySymbols,ns=Object.prototype.hasOwnProperty,yh=Object.prototype.propertyIsEnumerable,Zh=(a,o,f)=>o in a?Nu(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Wh=(a,o)=>{for(var f in o||(o={}))ns.call(o,f)&&Zh(a,f,o[f]);if(Hh)for(var f of Hh(o))yh.call(o,f)&&Zh(a,f,o[f]);return a},rl=(a,o)=>ef(a,Hd(o)),Bf=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())});function _h(a,o,f){return Bf(this,null,function*(){if(a.length===0)return{rasterData:[0],width:1,heigh:1};const v=yield Promise.all(a.map(({data:H,bands:ie=[0]})=>o(H,ie))),T=[];v.forEach(H=>{Array.isArray(H)?T.push(...H):T.push(H)});const{width:O,height:L}=T[0];let F;switch(typeof f){case"function":F=f(T);break;case"object":Array.isArray(f)?F={rasterData:_u(f,T)}:F=ne(f,T);break;default:F={rasterData:T[0].rasterData}}return rl(Wh({},F),{width:O,height:L})})}function ne(a,o){const f=xc[a.type];if(f.type==="function")return f.method(o,a==null?void 0:a.options);if(f.type==="operation")return a.type==="rgb"?ge(f.expression,o):{rasterData:_u(f.expression,o)}}function ge(a,o){a.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),a.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),a.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const f=_u(a.r||["band",0],o),v=_u(a.g||["band",0],o),T=_u(a.b||["band",0],o);return[f,v,T]}function qe(a,o,f,v){return Bf(this,null,function*(){const T=yield _h(a,o,f);v(null,{data:T})})}function mn(a,o){const{extent:f=[121.168,30.2828,121.384,30.4219],coordinates:v,width:T,height:O,min:L,max:F,format:H,operation:ie}=o;let xe,Ee,Ye;if(H===void 0||Vt(a))xe=Array.from(a),Ee=T,Ye=O;else{const Pn=Array.isArray(a)?a:[a];xe=_h(Pn,H,ie)}const Lt=xn(v,f);return{_id:1,dataArray:[{_id:1,data:xe,width:Ee,height:Ye,min:L,max:F,coordinates:Lt}]}}var K=D(39827),tr=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Mr=(a,o,f,v)=>tr(void 0,null,function*(){return new Promise((T,O)=>{o({x:a.x,y:a.y,z:a.z},(L,F)=>{if(L||F.length===0){O(L);return}F&&qe([{data:F,bands:[0]}],f,v,(H,ie)=>{H?O(H):ie&&T(ie)})})})}),Bi=(a,o)=>tr(void 0,null,function*(){return new Promise((f,v)=>{o({x:a.x,y:a.y,z:a.z},(T,O)=>{if(T||!O){v(T);return}O instanceof ArrayBuffer?(0,Pe.Co)(O,(L,F)=>{L&&v(L),f(F)}):O instanceof HTMLImageElement?f(O):v(T)})})});function zi(a,o){return Array.isArray(a)?typeof a[0]=="string"?a.map(f=>(0,Pe.z0)(f,o)):a.map(f=>({url:(0,Pe.z0)(f.url,o),bands:f.bands||[0]})):(0,Pe.z0)(a,o)}function so(a){return typeof a=="string"?[{url:a,bands:[0]}]:typeof a[0]=="string"?a.map(o=>({url:o,bands:[0]})):a}function Si(a,o){a.xhrCancel=()=>{o.map(f=>{f.abort()})}}var Sa=Object.defineProperty,Do=Object.defineProperties,ha=Object.getOwnPropertyDescriptors,rs=Object.getOwnPropertySymbols,ua=Object.prototype.hasOwnProperty,Aa=Object.prototype.propertyIsEnumerable,ls=(a,o,f)=>o in a?Sa(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Ma=(a,o)=>{for(var f in o||(o={}))ua.call(o,f)&&ls(a,f,o[f]);if(rs)for(var f of rs(o))Aa.call(o,f)&&ls(a,f,o[f]);return a},Da=(a,o)=>Do(a,ha(o)),Xa=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Ls=(a,o,f,v,T)=>Xa(void 0,null,function*(){const O=so(o.url);if(O.length>1){const{rasterFiles:L,xhrList:F,errList:H}=yield Qa(O,o);if(Si(a,F),H.length>0){f(H,null);return}qe(L,v,T,f)}else{const L=(0,Pe.ks)(o,(F,H)=>{if(F)f(F);else if(H){const ie=[{data:H,bands:O[0].bands}];qe(ie,v,T,f)}});Si(a,[L])}});function Qa(a,o){return Xa(this,null,function*(){const f=[],v=[],T=[];for(let O=0;O<a.length;O++){const L=a[O],F=Da(Ma({},o),{url:L.url}),H=L.bands,{err:ie,data:xe,xhr:Ee}=yield(0,Pe.LF)(Da(Ma({},F),{type:"arrayBuffer"}));ie&&T.push(ie),v.push(Ee),f.push({data:xe,bands:H})}return{rasterFiles:f,xhrList:v,errList:T}})}var Ec=Object.defineProperty,cs=Object.defineProperties,Bu=Object.getOwnPropertyDescriptors,bu=Object.getOwnPropertySymbols,Nc=Object.prototype.hasOwnProperty,Qf=Object.prototype.propertyIsEnumerable,xd=(a,o,f)=>o in a?Ec(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,bh=(a,o)=>{for(var f in o||(o={}))Nc.call(o,f)&&xd(a,f,o[f]);if(bu)for(var f of bu(o))Qf.call(o,f)&&xd(a,f,o[f]);return a},yf=(a,o)=>cs(a,Bu(o)),tf=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),Gh=(a,o,f,v)=>tf(void 0,null,function*(){const{format:T=Fu,operation:O,requestParameters:L={}}=v,F=yf(bh({},L),{url:zi(a,o)});return new Promise((H,ie)=>{Ls(f,F,(xe,Ee)=>{xe?ie(xe):Ee&&H(Ee)},T,O)})}),xh=(a,o,f,v)=>tf(void 0,null,function*(){let T;const O=Array.isArray(a)?a[0]:a;return v.wmtsOptions?T=((v==null?void 0:v.getURLFromTemplate)||Pe.jG)(O,bh(bh({},o),v.wmtsOptions)):T=((v==null?void 0:v.getURLFromTemplate)||Pe.z0)(O,o),new Promise((L,F)=>{var H;const ie=(0,Pe.gJ)(yf(bh({},v==null?void 0:v.requestParameters),{url:T,type:((H=v==null?void 0:v.requestParameters)==null?void 0:H.type)||"arrayBuffer"}),(xe,Ee)=>{xe?F(xe):Ee&&L(Ee)},v.transformResponse);f.xhrCancel=()=>ie.cancel()})}),Fu=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),n0=Object.defineProperty,Jf=Object.defineProperties,xp=Object.getOwnPropertyDescriptors,Ed=Object.getOwnPropertySymbols,Bc=Object.prototype.hasOwnProperty,Xh=Object.prototype.propertyIsEnumerable,Zd=(a,o,f)=>o in a?n0(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Eh=(a,o)=>{for(var f in o||(o={}))Bc.call(o,f)&&Zd(a,f,o[f]);if(Ed)for(var f of Ed(o))Xh.call(o,f)&&Zd(a,f,o[f]);return a},Yh=(a,o)=>Jf(a,xp(o)),xu={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Sh=[K.n3.ARRAYBUFFER,K.n3.RGB];function _f(a){return!!(Array.isArray(a)&&a.length===0||!Array.isArray(a)&&typeof a!="string")}function ks(a,o={}){if(_f(a))throw new Error("tile server url is error");let f=(o==null?void 0:o.dataType)||K.n3.IMAGE;f===K.n3.RGB&&(f=K.n3.ARRAYBUFFER);const v=(O,L)=>{switch(f){case K.n3.IMAGE:return xh(a,O,L,o);case K.n3.CUSTOMIMAGE:case K.n3.CUSTOMTERRAINRGB:return Bi(L,o==null?void 0:o.getCustomData);case K.n3.ARRAYBUFFER:return Gh(a,O,L,o);case K.n3.CUSTOMARRAYBUFFER:case K.n3.CUSTOMRGB:return Mr(L,o==null?void 0:o.getCustomData,(o==null?void 0:o.format)||Fu,o==null?void 0:o.operation);default:return xh(a,O,L,o)}},T=Yh(Eh(Eh({},xu),o),{getTileData:v});return{data:a,dataArray:[],tilesetOptions:T,isTile:!0}}var Wd=Object.defineProperty,Gl=Object.defineProperties,fe=Object.getOwnPropertyDescriptors,Ie=Object.getOwnPropertySymbols,ct=Object.prototype.hasOwnProperty,gn=Object.prototype.propertyIsEnumerable,ir=(a,o,f)=>o in a?Wd(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Ur=(a,o)=>{for(var f in o||(o={}))ct.call(o,f)&&ir(a,f,o[f]);if(Ie)for(var f of Ie(o))gn.call(o,f)&&ir(a,f,o[f]);return a},mi=(a,o)=>Gl(a,fe(o)),Ki=(a,o)=>{var f={};for(var v in a)ct.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Ie)for(var v of Ie(a))o.indexOf(v)<0&&gn.call(a,v)&&(f[v]=a[v]);return f};function ma(a,o){const f=o,{extent:v=[121.168,30.2828,121.384,30.4219],coordinates:T,width:O,height:L}=f,F=Ki(f,["extent","coordinates","width","height"]);a.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[H,ie]=F.bands||[0,1],xe=[a[H],a[ie]],Ee=[];for(let an=0;an<xe[0].length;an++)Ee.push((xe[1][an]-xe[0][an])/(xe[1][an]+xe[0][an]));const Ye=xn(T,v);return{_id:1,dataArray:[mi(Ur({_id:1,data:Ee,width:O,height:L},F),{coordinates:Ye})]}}var ba=Object.defineProperty,bs=Object.defineProperties,za=Object.getOwnPropertyDescriptors,Na=Object.getOwnPropertySymbols,Sc=Object.prototype.hasOwnProperty,nf=Object.prototype.propertyIsEnumerable,Ys=(a,o,f)=>o in a?ba(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,io=(a,o)=>{for(var f in o||(o={}))Sc.call(o,f)&&Ys(a,f,o[f]);if(Na)for(var f of Na(o))nf.call(o,f)&&Ys(a,f,o[f]);return a},Wc=(a,o)=>bs(a,za(o)),Gd=(a,o)=>{var f={};for(var v in a)Sc.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Na)for(var v of Na(a))o.indexOf(v)<0&&nf.call(a,v)&&(f[v]=a[v]);return f};function $h(a,o){const f=o,{extent:v,coordinates:T,width:O,height:L}=f,F=Gd(f,["extent","coordinates","width","height"]);a.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");const[H,ie,xe]=F.bands||[0,1,2],Ee=[a[H],a[ie],a[xe]],Ye=[],[Lt,an]=(F==null?void 0:F.countCut)||[2,98],Pn=(F==null?void 0:F.RMinMax)||hl(Ee[0],Lt,an),sr=(F==null?void 0:F.GMinMax)||hl(Ee[1],Lt,an),Rr=(F==null?void 0:F.BMinMax)||hl(Ee[2],Lt,an);for(let Ui=0;Ui<Ee[0].length;Ui++)Ye.push(Math.max(0,Ee[0][Ui]-Pn[0])),Ye.push(Math.max(0,Ee[1][Ui]-sr[0])),Ye.push(Math.max(0,Ee[2][Ui]-Rr[0]));const Tr=xn(T,v);return{_id:1,dataArray:[Wc(io({_id:1,data:Ye,width:O,height:L,rMinMax:Pn,gMinMax:sr,bMinMax:Rr},F),{coordinates:Tr})]}}var _l=Object.defineProperty,Ja=Object.defineProperties,r0=Object.getOwnPropertyDescriptors,Xi=Object.getOwnPropertySymbols,Ff=Object.prototype.hasOwnProperty,Eu=Object.prototype.propertyIsEnumerable,Ep=(a,o,f)=>o in a?_l(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,rf=(a,o)=>{for(var f in o||(o={}))Ff.call(o,f)&&Ep(a,f,o[f]);if(Xi)for(var f of Xi(o))Eu.call(o,f)&&Ep(a,f,o[f]);return a},of=(a,o)=>Ja(a,r0(o)),eh=(a,o)=>{var f={};for(var v in a)Ff.call(a,v)&&o.indexOf(v)<0&&(f[v]=a[v]);if(a!=null&&Xi)for(var v of Xi(a))o.indexOf(v)<0&&Eu.call(a,v)&&(f[v]=a[v]);return f};function Sp(a,o){const f=o,{extent:v,coordinates:T,min:O,max:L,width:F,height:H,format:ie,operation:xe}=f,Ee=eh(f,["extent","coordinates","min","max","width","height","format","operation"]);let Ye;if(ie===void 0||Vt(a))Ye=Array.from(a);else{const Pn=Array.isArray(a)?a:[a];Ye=_h(Pn,ie,xe)}const Lt=xn(T,v);return{_id:1,dataArray:[of(rf({_id:1,data:Ye,width:F,height:H},Ee),{min:O,max:L,coordinates:Lt})]}}var Gc=Object.defineProperty,th=Object.defineProperties,i0=Object.getOwnPropertyDescriptors,Sd=Object.getOwnPropertySymbols,k0=Object.prototype.hasOwnProperty,z0=Object.prototype.propertyIsEnumerable,su=(a,o,f)=>o in a?Gc(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,af=(a,o)=>{for(var f in o||(o={}))k0.call(o,f)&&su(a,f,o[f]);if(Sd)for(var f of Sd(o))z0.call(o,f)&&su(a,f,o[f]);return a},Ta=(a,o)=>th(a,i0(o)),ku=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),zu={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},cc=a=>ku(void 0,null,function*(){return new Promise(o=>{const[f,v,T,O]=a.bounds,L={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,x:(f+T)/2,y:(v+O)/2},geometry:{type:"LineString",coordinates:[[T,O],[T,v],[f,v],[f,v]]}}]}}};o(L)})});function Th(a,o){const f=T=>cc(T),v=Ta(af(af({},zu),o),{getTileData:f});return{data:a,dataArray:[],tilesetOptions:v,isTile:!0}}var Ul=D(46343),Fc=D(26729),Xc=D.n(Fc),Tp=D(69848),jo=D.n(Tp),Eo=Object.defineProperty,kc=Object.getOwnPropertySymbols,lu=Object.prototype.hasOwnProperty,nh=Object.prototype.propertyIsEnumerable,dl=(a,o,f)=>o in a?Eo(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,bf=(a,o)=>{for(var f in o||(o={}))lu.call(o,f)&&dl(a,f,o[f]);if(kc)for(var f of kc(o))nh.call(o,f)&&dl(a,f,o[f]);return a};function wh(a,o){const{radius:f=40,maxZoom:v=18,minZoom:T=0,zoom:O=2}=o;if(a.pointIndex){const H=a.pointIndex.getClusters(a.extent,Math.floor(O));return a.dataArray=kf(H),a}const L=new(jo())({radius:f,minZoom:T,maxZoom:v}),F={type:"FeatureCollection",features:[]};return F.features=a.dataArray.map(H=>({type:"Feature",geometry:{type:"Point",coordinates:H.coordinates},properties:bf({},H)})),L.load(F.features),L}function kf(a){return a.map((o,f)=>bf({coordinates:o.geometry.coordinates,_id:f+1},o.properties))}function xs(a){if(a.length===0)throw new Error("max requires at least one data point");let o=a[0];for(let f=1;f<a.length;f++)a[f]>o&&(o=a[f]);return o}function uc(a){if(a.length===0)throw new Error("min requires at least one data point");let o=a[0];for(let f=1;f<a.length;f++)a[f]<o&&(o=a[f]);return o}function Xd(a){if(a.length===0)return 0;let o=a[0],f=0,v;for(let T=1;T<a.length;T++)v=o+a[T]*1,Math.abs(o)>=Math.abs(a[T])?f+=o-v+a[T]:f+=a[T]-v+o,o=v;return o+f*1}function Kh(a){if(a.length===0)throw new Error("mean requires at least one data point");return Xd(a)/a.length}var U0={min:uc,max:xs,mean:Kh,sum:Xd},Ah=Object.defineProperty,Su=Object.getOwnPropertySymbols,Yd=Object.prototype.hasOwnProperty,zf=Object.prototype.propertyIsEnumerable,wp=(a,o,f)=>o in a?Ah(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Yr=(a,o)=>{for(var f in o||(o={}))Yd.call(o,f)&&wp(a,f,o[f]);if(Su)for(var f of Su(o))zf.call(o,f)&&wp(a,f,o[f]);return a},Uf=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),{cloneDeep:jf,isFunction:qh,isString:xf,mergeWith:Ap}=Pe.lodashUtil;function sf(a,o){if(Array.isArray(o))return o}var Ef=class extends Fc.EventEmitter{constructor(a,o){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new Ul.ni},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=a,this.initCfg(o),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}getClustersLeaves(a){return this.clusterIndex.getLeaves(a,1/0)}getParserType(){return this.parser.type}updateClusterData(a){const{method:o="sum",field:f}=this.clusterOptions;let v=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,v.forEach(T=>{T.id||(T.properties.point_count=1)}),(f||qh(o))&&(v=v.map(T=>{const O=T.id;if(O){const F=this.clusterIndex.getLeaves(O,1/0).map(ie=>ie.properties);let H;if(xf(o)&&f){const ie=Nn(F,f);H=U0[o](ie)}qh(o)&&(H=o(F)),T.properties.stat=H}else T.properties.point_count=1;return T})),this.data=E("geojson")({type:"FeatureCollection",features:v}),this.executeTrans()}getFeatureById(a){const{type:o="geojson",geometry:f}=this.parser;if(o==="geojson"&&!this.cluster){const v=a<this.originData.features.length?this.originData.features[a]:"null",T=jf(v);if(T!=null&&T.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const O=this.data.dataArray.find(L=>L._id===a);T.properties=O}return T}else return o==="json"&&f?this.data.dataArray.find(v=>v._id===a):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}updateFeaturePropertiesById(a,o){this.data.dataArray=this.data.dataArray.map(f=>f._id===a?Yr(Yr({},f),o):f),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(a,o){const f=this.data.dataArray.find(v=>v[a]===o);return f==null?void 0:f._id}setData(a,o){this.originData=a,this.dataArrayChanged=!1,this.initCfg(o),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var a;(a=this.tileset)==null||a.reloadAll()}reloadTilebyId(a,o,f){var v;(v=this.tileset)==null||v.reloadTileById(a,o,f)}reloadTileByLnglat(a,o,f){var v;(v=this.tileset)==null||v.reloadTileByLnglat(a,o,f)}getTileExtent(a,o){var f;return(f=this.tileset)==null?void 0:f.getTileExtent(a,o)}getTileByZXY(a,o,f){var v;return(v=this.tileset)==null?void 0:v.getTileByZXY(a,o,f)}reloadTileByExtent(a,o){var f;(f=this.tileset)==null||f.reloadTileByExtent(a,o)}destroy(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)==null||a.destroy()}processData(){return Uf(this,null,function*(){return new Promise((a,o)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),a({})}catch(f){o(f)}})})}initCfg(a){this.cfg=Ap(this.cfg,a,sf);const o=this.cfg;o&&(o.parser&&(this.parser=o.parser),o.transforms&&(this.transforms=o.transforms),this.cluster=o.cluster||!1,o.clusterOptions&&(this.cluster=!0,this.clusterOptions=Yr(Yr({},this.clusterOptions),o.clusterOptions)))}init(){return Uf(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const a=this.parser,o=a.type||"geojson",f=E(o);this.data=f(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=(0,Pe.We)(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:a}=this.data;return a?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(a),this.tileset):new Pe.nx(Yr({},a))):void 0}executeTrans(){this.transforms.forEach(o=>{const{type:f}=o,v=re(f)(this.data,o);Object.assign(this.data,v)})}initCluster(){if(!this.cluster)return;const a=this.clusterOptions||{};this.clusterIndex=wh(this.data,a)}caculClusterExtent(a){let o=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(o=(0,Pe.yA)((0,Pe.ds)(this.extent),a)),o[0].concat(o[1])}};function o0(a,o){const{callback:f}=o;return f&&(a.dataArray=a.dataArray.filter(f)),a}var rh=6378e3;function Yc(a,o){const f=a.dataArray,{size:v=10}=o,T=v/(2*Math.PI*rh)*(256<<20)/2,{gridHash:O,gridOffset:L}=$c(f,v),F=_(O,L,o);return{yOffset:T,xOffset:T,radius:T,type:"grid",dataArray:F}}function $c(a,o){let f=1/0,v=-1/0,T;for(const H of a)T=H.coordinates[1],Number.isFinite(T)&&(f=T<f?T:f,v=T>v?T:v);const O=(f+v)/2,L=Ds(o,O);if(L.xOffset<=0||L.yOffset<=0)return{gridHash:{},gridOffset:L};const F={};for(const H of a){const ie=H.coordinates[1],xe=H.coordinates[0];if(Number.isFinite(ie)&&Number.isFinite(xe)){const Ee=Math.floor((ie+90)/L.yOffset),Ye=Math.floor((xe+180)/L.xOffset),Lt=`${Ee}-${Ye}`;F[Lt]=F[Lt]||{count:0,points:[]},F[Lt].count+=1,F[Lt].points.push(H)}}return{gridHash:F,gridOffset:L}}function Ds(a,o){const f=Tu(a),v=j0(o,a);return{yOffset:f,xOffset:v}}function Tu(a){return a/rh*(180/Math.PI)}function j0(a,o){return o/rh*(180/Math.PI)/Math.cos(a*Math.PI/180)}function _(a,o,f){return Object.keys(a).reduce((v,T,O)=>{const L=T.split("-"),F=parseInt(L[0],10),H=parseInt(L[1],10),ie={};if(f.field&&f.method){const xe=Pe.a5.getColumn(a[T].points,f.field);ie[f.method]=Pe.a5.statMap[f.method](xe)}return Object.assign(ie,{_id:O,coordinates:(0,Pe.Z)([-180+o.xOffset*(H+.5),-90+o.yOffset*(F+.5)]),rawData:a[T].points,count:a[T].count}),v.push(ie),v},[])}var S=Math.PI/3,x=[0,S,2*S,3*S,4*S,5*S];function C(a){return a[0]}function k(a){return a[1]}function G(){var a=0,o=0,f=1,v=1,T=C,O=k,L,F,H;function ie(Ee){var Ye={},Lt=[],an,Pn=Ee.length;for(an=0;an<Pn;++an)if(!(isNaN(Rr=+T.call(null,sr=Ee[an],an,Ee))||isNaN(Tr=+O.call(null,sr,an,Ee)))){var sr,Rr,Tr,li=Math.round(Tr=Tr/H),Ui=Math.round(Rr=Rr/F-(li&1)/2),Lo=Tr-li;if(Math.abs(Lo)*3>1){var eo=Rr-Ui,Wr=Ui+(Rr<Ui?-1:1)/2,Wi=li+(Tr<li?-1:1),ka=Rr-Wr,ws=Tr-Wi;eo*eo+Lo*Lo>ka*ka+ws*ws&&(Ui=Wr+(li&1?1:-1)/2,li=Wi)}var ta=Ui+"-"+li,ts=Ye[ta];ts?ts.push(sr):(Lt.push(ts=Ye[ta]=[sr]),ts.x=(Ui+(li&1)/2)*F,ts.y=li*H)}return Lt}function xe(Ee){var Ye=0,Lt=0;return x.map(function(an){var Pn=Math.sin(an)*Ee,sr=-Math.cos(an)*Ee,Rr=Pn-Ye,Tr=sr-Lt;return Ye=Pn,Lt=sr,[Rr,Tr]})}return ie.hexagon=function(Ee){return"m"+xe(Ee==null?L:+Ee).join("l")+"z"},ie.centers=function(){for(var Ee=[],Ye=Math.round(o/H),Lt=Math.round(a/F),an=Ye*H;an<v+L;an+=H,++Ye)for(var Pn=Lt*F+(Ye&1)*F/2;Pn<f+F/2;Pn+=F)Ee.push([Pn,an]);return Ee},ie.mesh=function(){var Ee=xe(L).slice(0,4).join("l");return ie.centers().map(function(Ye){return"M"+Ye+"m"+Ee}).join("")},ie.x=function(Ee){return arguments.length?(T=Ee,ie):T},ie.y=function(Ee){return arguments.length?(O=Ee,ie):O},ie.radius=function(Ee){return arguments.length?(L=+Ee,F=L*2*Math.sin(S),H=L*1.5,ie):L},ie.size=function(Ee){return arguments.length?(a=o=0,f=+Ee[0],v=+Ee[1],ie):[f-a,v-o]},ie.extent=function(Ee){return arguments.length?(a=+Ee[0][0],o=+Ee[0][1],f=+Ee[1][0],v=+Ee[1][1],ie):[[a,o],[f,v]]},ie.radius(1)}var q=Object.defineProperty,de=Object.defineProperties,ze=Object.getOwnPropertyDescriptors,it=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,St=Object.prototype.propertyIsEnumerable,Xt=(a,o,f)=>o in a?q(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,En=(a,o)=>{for(var f in o||(o={}))Bt.call(o,f)&&Xt(a,f,o[f]);if(it)for(var f of it(o))St.call(o,f)&&Xt(a,f,o[f]);return a},yn=(a,o)=>de(a,ze(o)),Un=6378e3;function cn(a,o){const f=a.dataArray,{size:v=10,method:T="sum"}=o,O=v/(2*Math.PI*Un)*(256<<20)/2,L=f.map(xe=>{const[Ee,Ye]=(0,Pe.Z)(xe.coordinates);return yn(En({},xe),{coordinates:[Ee,Ye]})});return{dataArray:G().radius(O).x(xe=>xe.coordinates[0]).y(xe=>xe.coordinates[1])(L).map((xe,Ee)=>{if(o.field&&T){const Ye=Pe.a5.getColumn(xe,o.field);xe[T]=Pe.a5.statMap[T](Ye)}return{[o.method]:xe[T],count:xe.length,rawData:xe,coordinates:[xe.x,xe.y],_id:Ee}}),radius:O,xOffset:O,yOffset:O,type:"hexagon"}}var Rn=Object.defineProperty,Jn=Object.getOwnPropertySymbols,hr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable,gr=(a,o,f)=>o in a?Rn(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,Dr=(a,o)=>{for(var f in o||(o={}))hr.call(o,f)&&gr(a,f,o[f]);if(Jn)for(var f of Jn(o))Lr.call(o,f)&&gr(a,f,o[f]);return a};function Fr(a,o){const{sourceField:f,targetField:v,data:T}=o,O={};return T.forEach(L=>{O[L[f]]=L}),a.dataArray=a.dataArray.map(L=>{const F=L[v];return Dr(Dr({},L),O[F])}),a}function Mi(a,o){const{callback:f}=o;return f&&(a.dataArray=a.dataArray.map(f)),a}var Pi=D(4771);_e("rasterTile",ks),_e("mvt",Vd),_e("geojsonvt",Di),_e("testTile",Th),_e("geojson",Gn),_e("jsonTile",nl),_e("image",Wo),_e("csv",ce),_e("json",at),_e("raster",mn),_e("rasterRgb",Sp),_e("rgb",$h),_e("ndi",ma),he("cluster",wh),he("filter",o0),he("join",Fr),he("map",Mi),he("grid",Yc),he("hexagon",cn);var vi=Ef;class Oo extends null{getMarkerLayerContainerSize(){}constructor(o){super(),_defineProperty(this,"markerOption",void 0),_defineProperty(this,"popup",void 0),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"lngLat",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"added",!1),_defineProperty(this,"preLngLat",{lng:0,lat:0}),_defineProperty(this,"onMarkerDragStart",f=>{const v=this.mapsService.getContainer();if(!v)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:T,top:O}=v.getClientRects()[0],{x:L,y:F}=f;this.preLngLat=this.mapsService.containerToLngLat([L-T,F-O]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),_defineProperty(this,"onMarkerDragMove",f=>{const v=f.lngLat||f.lnglat,{lng:T,lat:O}=this.preLngLat,{lng:L,lat:F}=v,H={lng:this.lngLat.lng+L-T,lat:this.lngLat.lat+F-O};this.setLnglat(H),this.preLngLat=v,this.emit("dragging",H)}),_defineProperty(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),_defineProperty(this,"eventHandle",f=>{this.polyfillEvent(f),this.emit(f.type,{target:f,data:this.markerOption.extData,lngLat:this.lngLat})}),_defineProperty(this,"touchStartTime",void 0),this.markerOption=_objectSpread(_objectSpread({},this.getDefault()),o),bindAll(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}addTo(o){this.scene=o,this.mapsService=o.mapService;const{element:f}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(f),this.registerMarkerEvent(f),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:o}=this.markerOption;return o&&DOM.remove(o),this.popup&&this.popup.remove(),this}setLnglat(o){return this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(o){if(!this.added)return this.once("added",()=>{this.setElement(o)}),this;const{element:f}=this.markerOption;return f&&DOM.remove(f),this.markerOption.element=o,this.init(),this.mapsService.getMarkerContainer().appendChild(o),this.registerMarkerEvent(o),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const o=this.popup;return o?(o.isOpen()||o.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const o=this.popup;return o&&o.remove(),this}setPopup(o){return this.popup=o,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const o=this.popup;if(o)o.isOpen()?o.remove():o.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(o){this.markerOption.draggable=o,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(o){this.markerOption.extData=o}update(){if(!this.mapsService)return;const{element:o,anchor:f}=this.markerOption;this.updatePosition(),DOM.setTransform(o,`${anchorTranslate[f]}`)}updatePositionWhenZoom(o){if(!this.mapsService)return;const{element:f,offsets:v}=this.markerOption,{lng:T,lat:O}=this.lngLat;if(f){f.style.display="block",f.style.whiteSpace="nowrap";const{containerHeight:L,containerWidth:F,bounds:H}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!H)return;const ie=o.map,xe=o.center,Ee=o.zoom,Ye=ie.DE(this.lngLat,Ee,xe);if(Ye.x=Math.round(Ye.x+v[0]),Ye.y=Math.round(Ye.y-v[1]),Math.abs(H[0][0])>180||Math.abs(H[1][0])>180){if(Ye.x>F){const Lt=this.mapsService.lngLatToContainer([T-360,O]);Ye.x=Lt.x}if(Ye.x<0){const Lt=this.mapsService.lngLatToContainer([T+360,O]);Ye.x=Lt.x}}(Ye.x>F||Ye.x<0||Ye.y>L||Ye.y<0)&&(f.style.display="none"),f.style.left=Ye.x+"px",f.style.top=Ye.y+"px",f.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(o){const{element:f}=this.markerOption;this.popup&&f&&this.togglePopup()}getCurrentContainerSize(){const o=this.mapsService.getContainer();return{containerHeight:(o==null?void 0:o.scrollHeight)||0,containerWidth:(o==null?void 0:o.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:o}=this.markerOption;o==null||o.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(o==null||o.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:o,offsets:f}=this.markerOption,{lng:v,lat:T}=this.lngLat,O=this.mapsService.lngLatToContainer([v,T]);if(o){o.style.display="block",o.style.whiteSpace="nowrap";const{containerHeight:L,containerWidth:F,bounds:H}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!H)return;if(Math.abs(H[0][0])>180||Math.abs(H[1][0])>180){if(O.x>F){const ie=this.mapsService.lngLatToContainer([v-360,T]);O.x=ie.x}if(O.x<0){const ie=this.mapsService.lngLatToContainer([v+360,T]);O.x=ie.x}}(O.x>F||O.x<0||O.y>L||O.y<0)&&(o.style.display="none"),o.style.left=O.x+f[0]+"px",o.style.top=O.y-f[1]+"px"}}init(){let{element:o}=this.markerOption;const{color:f,anchor:v}=this.markerOption;if(!o){o=DOM.create("div"),this.markerOption.element=o;const T=document.createElementNS("http://www.w3.org/2000/svg","svg");T.setAttributeNS(null,"display","block"),T.setAttributeNS(null,"height","48px"),T.setAttributeNS(null,"width","48px"),T.setAttributeNS(null,"viewBox","0 0 1024 1024");const O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),O.setAttributeNS(null,"fill",f),T.appendChild(O),o.appendChild(T)}DOM.addClass(o,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(T=>{var O,L;const F=((O=this.markerOption)===null||O===void 0?void 0:O.style)&&((L=this.markerOption)===null||L===void 0?void 0:L.style[T]);o&&(o.style[T]=F)}),applyAnchorClass(o,v,"marker")}registerMarkerEvent(o){o.addEventListener("click",this.onMapClick),o.addEventListener("mousemove",this.eventHandle),o.addEventListener("click",this.eventHandle),o.addEventListener("mousedown",this.eventHandle),o.addEventListener("mouseup",this.eventHandle),o.addEventListener("dblclick",this.eventHandle),o.addEventListener("contextmenu",this.eventHandle),o.addEventListener("mouseover",this.eventHandle),o.addEventListener("mouseout",this.eventHandle),o.addEventListener("touchstart",this.eventHandle),o.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const o=this.getElement();o.removeEventListener("click",this.onMapClick),o.removeEventListener("mousemove",this.eventHandle),o.removeEventListener("click",this.eventHandle),o.removeEventListener("mousedown",this.eventHandle),o.removeEventListener("mouseup",this.eventHandle),o.removeEventListener("dblclick",this.eventHandle),o.removeEventListener("contextmenu",this.eventHandle),o.removeEventListener("mouseover",this.eventHandle),o.removeEventListener("mouseout",this.eventHandle),o.removeEventListener("touchstart",this.eventHandle),o.removeEventListener("touchend",this.eventHandle)}polyfillEvent(o){!this.mapsService||this.mapsService.getType()!=="amap"||isPC()||(o.type==="touchstart"&&(this.touchStartTime=Date.now()),o.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:o,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(o){return null}onUp(o){throw new Error("Method not implemented.")}}const{merge:yo}=Pe.lodashUtil;class Ho extends null{constructor(o){var f;super(),_defineProperty(this,"markers",[]),_defineProperty(this,"markerLayerOption",void 0),_defineProperty(this,"clusterIndex",void 0),_defineProperty(this,"points",[]),_defineProperty(this,"clusterMarkers",[]),_defineProperty(this,"mapsService",void 0),_defineProperty(this,"scene",void 0),_defineProperty(this,"zoom",void 0),_defineProperty(this,"bbox",void 0),_defineProperty(this,"inited",void 0),_defineProperty(this,"containerSize",void 0),this.markerLayerOption=yo(this.getDefault(),o),bindAll(["update"],this),this.zoom=((f=this.markerLayerOption.clusterOption)===null||f===void 0?void 0:f.zoom)||-99}getDefault(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}addTo(o){return this.scene=o,this.mapsService=o.mapService,this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}setContainerSize(){if(!this.mapsService)return;const o=this.mapsService.getContainer();this.containerSize={containerWidth:(o==null?void 0:o.scrollWidth)||0,containerHeight:(o==null?void 0:o.scrollHeight)||0,bounds:this.mapsService.getBounds()}}getContainerSize(){return this.containerSize}addMarker(o){const f=this.markerLayerOption.cluster;if(o.getMarkerLayerContainerSize=this.getContainerSize.bind(this),f&&(this.addPoint(o,this.markers.length),this.mapsService)){const v=this.mapsService.getZoom(),T=this.mapsService.getBounds();this.bbox=padBounds(T,.5),this.zoom=Math.floor(v),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(o)}removeMarker(o){this.markers.indexOf(o);const f=this.markers.indexOf(o);f>-1&&(this.markers.splice(f,1),this.markerLayerOption.cluster&&(this.removePoint(f),this.mapsService&&this.getClusterMarker(this.bbox,this.zoom)))}hide(){this.markers.map(o=>{o.getElement().style.opacity="0"}),this.clusterMarkers.map(o=>{o.getElement().style.opacity="0"})}show(){this.markers.map(o=>{o.getElement().style.opacity="1"}),this.clusterMarkers.map(o=>{o.getElement().style.opacity="1"})}getMarkers(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}getOriginMarkers(){return this.markers}addMarkers(){this.getMarkers().forEach(o=>{o.addTo(this.scene)})}clear(){this.markers.forEach(o=>{o.remove()}),this.clusterMarkers.forEach(o=>{o.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}destroy(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}addPoint(o,f){const{lng:v,lat:T}=o.getLnglat(),O={geometry:{type:"Point",coordinates:[v,T]},properties:_objectSpread(_objectSpread({},o.getExtData()),{},{marker_id:f})};this.points.push(O),this.clusterIndex&&this.clusterIndex.load(this.points)}removePoint(o){const f=this.points.findIndex(v=>v.properties.marker_id===o);f>-1&&this.points.splice(f,1),this.clusterIndex&&this.clusterIndex.load(this.points)}initCluster(){if(!this.markerLayerOption.cluster)return;const{radius:o,minZoom:f=0,maxZoom:v}=this.markerLayerOption.clusterOption;this.clusterIndex=new Supercluster({radius:o,minZoom:f,maxZoom:v}),this.clusterIndex.load(this.points)}getClusterMarker(o,f){const v=o[0].concat(o[1]),T=this.clusterIndex.getClusters(v,f);this.clusterMarkers.forEach(O=>{O.remove()}),this.clusterMarkers=[],T.forEach(O=>{var L;const{field:F,method:H}=this.markerLayerOption.clusterOption;if((L=O.properties)!==null&&L!==void 0&&L.cluster_id){var ie;const Ee=this.getLeaves((ie=O.properties)===null||ie===void 0?void 0:ie.cluster_id);if(O.properties.clusterData=Ee,F&&H){const Ye=Ee==null?void 0:Ee.map(sr=>({[F]:sr.properties[F]})),Lt=Satistics.getColumn(Ye,F),an=Satistics.getSatByColumn(H,Lt),Pn="point_"+H;O.properties[Pn]=an.toFixed(2)}}const xe=this.clusterMarker(O);this.clusterMarkers.push(xe),xe.addTo(this.scene)})}getLeaves(o,f=1/0,v=0){return o?this.clusterIndex.getLeaves(o,f,v):null}clusterMarker(o){const f=this.markerLayerOption.clusterOption,{element:v=this.generateElement.bind(this)}=f;return new Marker({element:v(o)}).setLnglat({lng:o.geometry.coordinates[0],lat:o.geometry.coordinates[1]})}normalMarker(o){const f=o.properties.marker_id;return this.markers[f]}update(){if(!this.mapsService||this.markers.length===0)return;const o=this.mapsService.getZoom(),f=this.mapsService.getBounds();(!this.bbox||Math.abs(o-this.zoom)>=1||!boundsContains(this.bbox,f))&&(this.bbox=padBounds(f,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom))}generateElement(o){const f=DOM.create("div","l7-marker-cluster"),v=DOM.create("div","",f),T=DOM.create("span","",v),{field:O,method:L}=this.markerLayerOption.clusterOption;o.properties.point_count=o.properties.point_count||1;const F=O&&L?o.properties["point_"+L]||o.properties[O]:o.properties.point_count;return T.textContent=F,f}}var is=D(4157),Cr=D(1413),Kt=D(4942);class Zr extends Xc(){constructor(o){super(),(0,Kt.Z)(this,"controlOption",void 0),(0,Kt.Z)(this,"container",void 0),(0,Kt.Z)(this,"isShow",void 0),(0,Kt.Z)(this,"sceneContainer",void 0),(0,Kt.Z)(this,"scene",void 0),(0,Kt.Z)(this,"mapsService",void 0),(0,Kt.Z)(this,"renderService",void 0),(0,Kt.Z)(this,"layerService",void 0),(0,Kt.Z)(this,"controlService",void 0),(0,Kt.Z)(this,"configService",void 0),Zr.controlCount++,this.controlOption=(0,Cr.Z)((0,Cr.Z)({},this.getDefault(o)),o||{})}getOptions(){return this.controlOption}setOptions(o){const f=this.getDefault(o);Object.entries(o).forEach(([v,T])=>{T===void 0&&(o[v]=f[v])}),"position"in o&&this.setPosition(o.position),"className"in o&&this.setClassName(o.className),"style"in o&&this.setStyle(o.style),this.controlOption=(0,Cr.Z)((0,Cr.Z)({},this.controlOption),o)}addTo(o){this.mapsService=o.mapService,this.renderService=o.rendererService,this.layerService=o.layerService,this.controlService=o.controlService,this.configService=o.globalConfigService,this.scene=o.sceneService,this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd(),Pe.SO.addClass(this.container,"l7-control");const{className:f,style:v}=this.controlOption;return f&&this.setClassName(f),v&&this.setStyle(v),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;Pe.SO.remove(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return Pe.SO.create("div")}onRemove(){}show(){const o=this.container;Pe.SO.removeClass(o,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const o=this.container;Pe.SO.addClass(o,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(o){return{position:K.d.TOPRIGHT,name:`${Zr.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(o){if(this.mapsService&&o&&o.screenX>0&&o.screenY>0){const f=this.mapsService.getContainer();f!==null&&f.focus()}}setPosition(o=K.d.TOPLEFT){const f=this.controlService;return f&&f.removeControl(this),this.controlOption.position=o,f&&f.addControl(this,this.sceneContainer),this}setClassName(o){const f=this.container,{className:v}=this.controlOption;v&&Pe.SO.removeClass(f,v),o&&Pe.SO.addClass(f,o)}setStyle(o){const f=this.container;o?f.setAttribute("style",o):f.removeAttribute("style")}insertContainer(){const o=this.controlOption.position,f=this.container;if(o instanceof Element)o.appendChild(f);else{const v=this.controlService.controlCorners[o];["bottomleft","bottomright","righttop","rightbottom"].includes(o)?v.insertBefore(f,v.firstChild):v.appendChild(f)}}checkUpdateOption(o,f){return f.some(v=>v in o)}}(0,Kt.Z)(Zr,"controlCount",0);class ko extends null{constructor(...o){super(...o),_defineProperty(this,"isDisable",!1),_defineProperty(this,"button",void 0),_defineProperty(this,"buttonText",void 0),_defineProperty(this,"buttonIcon",void 0)}setIsDisable(o){if(this.isDisable=o,o){var f;(f=this.button)===null||f===void 0||f.setAttribute("disabled","true")}else{var v;(v=this.button)===null||v===void 0||v.removeAttribute("disabled")}}createButton(o=""){return DOM.create("button",`l7-button-control ${o}`)}onAdd(){this.button=this.createButton(),this.isDisable=!1;const{title:o,btnText:f,btnIcon:v}=this.controlOption;return this.setBtnTitle(o),this.setBtnText(f),this.setBtnIcon(v),this.button}onRemove(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}setOptions(o){const{title:f,btnText:v,btnIcon:T}=o;this.checkUpdateOption(o,["title"])&&this.setBtnTitle(f),this.checkUpdateOption(o,["btnIcon"])&&this.setBtnIcon(T),this.checkUpdateOption(o,["btnText"])&&this.setBtnText(v),super.setOptions(o)}setBtnTitle(o){var f;(f=this.button)===null||f===void 0||f.setAttribute("title",o!=null?o:"")}setBtnIcon(o){if(this.buttonIcon&&DOM.remove(this.buttonIcon),o){var f;const O=(f=this.button)===null||f===void 0?void 0:f.firstChild;if(O){var v;(v=this.button)===null||v===void 0||v.insertBefore(o,O)}else{var T;(T=this.button)===null||T===void 0||T.appendChild(o)}this.buttonIcon=o}}setBtnText(o){if(this.button)if(DOM.removeClass(this.button,"l7-button-control--row"),DOM.removeClass(this.button,"l7-button-control--column"),o){let v=this.buttonText;if(!v){var f;v=DOM.create("div","l7-button-control__text"),(f=this.button)===null||f===void 0||f.appendChild(v),this.buttonText=v}v.innerText=o,DOM.addClass(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!o&&this.buttonText&&(DOM.remove(this.buttonText),this.buttonText=void 0)}}class qo extends Fc.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(o,f){super(),(0,Kt.Z)(this,"popperDOM",void 0),(0,Kt.Z)(this,"contentDOM",void 0),(0,Kt.Z)(this,"button",void 0),(0,Kt.Z)(this,"option",void 0),(0,Kt.Z)(this,"isShow",!1),(0,Kt.Z)(this,"content",void 0),(0,Kt.Z)(this,"timeout",null),(0,Kt.Z)(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),Pe.SO.removeClass(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&qo.conflictPopperList.forEach(v=>{v!==this&&v.isShow&&v.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),(0,Kt.Z)(this,"hide",()=>this.isShow?(Pe.SO.addClass(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),(0,Kt.Z)(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),(0,Kt.Z)(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),(0,Kt.Z)(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),(0,Kt.Z)(this,"onPopperUnClick",v=>{Pe.SO.findParentElement(v.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),(0,Kt.Z)(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),(0,Kt.Z)(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=o,this.option=f,this.init(),f.unique&&qo.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(o){typeof o=="string"?this.contentDOM.innerHTML=o:o instanceof HTMLElement&&(Pe.SO.clearChildren(this.contentDOM),this.contentDOM.appendChild(o)),this.content=o}init(){const{trigger:o}=this.option;this.popperDOM=this.createPopper(),o==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Pe.SO.remove(this.popperDOM)}resetPopperPosition(){const o={},{container:f,offset:v=[0,0],placement:T}=this.option,[O,L]=v,F=this.button.getBoundingClientRect(),H=f.getBoundingClientRect(),{left:ie,right:xe,top:Ee,bottom:Ye}=Pe.SO.getDiffRect(F,H);let Lt=!1,an=!1;/^(left|right)/.test(T)?(T.includes("left")?o.right=`${F.width+xe}px`:T.includes("right")&&(o.left=`${F.width+ie}px`),T.includes("start")?o.top=`${Ee}px`:T.includes("end")?o.bottom=`${Ye}px`:(o.top=`${Ee+F.height/2}px`,an=!0,o.transform=`translate(${O}px, calc(${L}px - 50%))`)):/^(top|bottom)/.test(T)&&(T.includes("top")?o.bottom=`${F.height+Ye}px`:T.includes("bottom")&&(o.top=`${F.height+Ee}px`),T.includes("start")?o.left=`${ie}px`:T.includes("end")?o.right=`${xe}px`:(o.left=`${ie+F.width/2}px`,Lt=!0,o.transform=`translate(calc(${O}px - 50%), ${L}px)`)),o.transform=`translate(calc(${O}px - ${Lt?"50%":"0%"}), calc(${L}px - ${an?"50%":"0%"})`;const Pn=T.split("-");Pn.length&&Pe.SO.addClass(this.popperDOM,Pn.map(sr=>`l7-popper-${sr}`).join(" ")),Pe.SO.addStyle(this.popperDOM,Pe.SO.css2Style(o))}createPopper(){const{container:o,className:f="",content:v}=this.option,T=Pe.SO.create("div",`l7-popper l7-popper-hide ${f}`),O=Pe.SO.create("div","l7-popper-content"),L=Pe.SO.create("div","l7-popper-arrow");return T.appendChild(O),T.appendChild(L),o.appendChild(T),this.popperDOM=T,this.contentDOM=O,v&&this.setContent(v),T}}(0,Kt.Z)(qo,"conflictPopperList",[]);const va={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"};class na extends null{constructor(...o){super(...o),_defineProperty(this,"popper",void 0)}getPopper(){return this.popper}hide(){this.popper.hide(),super.hide()}getDefault(o){var f;const v=super.getDefault(o),T=(f=o==null?void 0:o.position)!==null&&f!==void 0?f:v.position;return _objectSpread(_objectSpread({},super.getDefault(o)),{},{popperPlacement:T instanceof Element?"bottom":va[T],popperTrigger:"click"})}onAdd(){const o=super.onAdd();return this.initPopper(),o}onRemove(){this.popper.destroy()}initPopper(){const{popperClassName:o,popperPlacement:f,popperTrigger:v}=this.controlOption,T=this.mapsService.getMapContainer();return this.popper=new Popper(this.button,{className:o,placement:f,trigger:v,container:T,unique:!0}),this.popper.on("show",()=>{this.emit("popperShow",this)}).on("hide",()=>{this.emit("popperHide",this)}),this.popper}setOptions(o){if(super.setOptions(o),this.checkUpdateOption(o,["popperPlacement","popperTrigger","popperClassName"])){const f=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(f)}}}var Vo=function(a){return a.ActiveOptionClassName="l7-select-control-item-active",a.OptionValueAttrKey="data-option-value",a.OptionIndexAttrKey="data-option-index",a}(Vo||{});class sl extends null{constructor(...o){super(...o),_defineProperty(this,"selectValue",[]),_defineProperty(this,"optionDOMList",void 0),_defineProperty(this,"createNormalOption",f=>{const v=this.selectValue.includes(f.value),T=DOM.create("div",`l7-select-control-item ${v?Vo.ActiveOptionClassName:""}`);this.getIsMultiple()?T.appendChild(this.createCheckbox(v)):T.appendChild(this.createRadio(v)),f.icon&&T.appendChild(f.icon);const O=DOM.create("span");return O.innerText=f.text,T.appendChild(O),T}),_defineProperty(this,"onItemClick",f=>{if(this.getIsMultiple()){const v=this.selectValue.findIndex(T=>T===f.value);v>-1?this.selectValue.splice(v,1):this.selectValue=[...this.selectValue,f.value]}else this.selectValue=[f.value];this.setSelectValue(this.selectValue)})}setOptions(o){super.setOptions(o);const{options:f}=o;f&&this.popper.setContent(this.getPopperContent(f))}onAdd(){const o=super.onAdd(),{defaultValue:f}=this.controlOption;return f&&(this.selectValue=this.transSelectValue(f)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),o}getSelectValue(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}setSelectValue(o,f=!0){const v=this.transSelectValue(o);this.optionDOMList.forEach(T=>{const O=T.getAttribute(Vo.OptionValueAttrKey),L=T.querySelector("input[type=checkbox]"),F=T.querySelector("input[type=radio]"),H=v.includes(O),ie=(xe,Ee)=>{DOM.toggleClass(T,Vo.ActiveOptionClassName,Ee),xe&&DOM.setChecked(xe,Ee)};ie(L,H),ie(F,H)}),this.selectValue=v,f&&this.emit("selectChange",this.getIsMultiple()?v:v[0])}getIsMultiple(){return!1}getPopperContent(o){const f=this.isImageOptions(),v=DOM.create("div",f?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&DOM.addClass(v,"l7-select-control--multiple");const T=o.map((O,L)=>{const F=f?this.createImageOption(O):this.createNormalOption(O);return F.setAttribute(Vo.OptionValueAttrKey,O.value),F.setAttribute(Vo.OptionIndexAttrKey,window.String(L)),F.addEventListener("click",this.onItemClick.bind(this,O)),F});return v.append(...T),this.optionDOMList=T,v}createImageOption(o){const f=this.selectValue.includes(o.value),v=DOM.create("div",`l7-select-control-item ${f?Vo.ActiveOptionClassName:""}`),T=DOM.create("img");T.setAttribute("src",o.img),DOM.setUnDraggable(T),v.appendChild(T);const O=DOM.create("div","l7-select-control-item-row");this.getIsMultiple()&&v.appendChild(this.createCheckbox(f));const L=DOM.create("span");return L.innerText=o.text,O.appendChild(L),v.appendChild(O),v}createCheckbox(o){const f=DOM.create("input");return f.setAttribute("type","checkbox"),o&&DOM.setChecked(f,!0),f}createRadio(o){const f=DOM.create("input");return f.setAttribute("type","radio"),o&&DOM.setChecked(f,!0),f}isImageOptions(){return!!this.controlOption.options.find(o=>o.img)}transSelectValue(o){return Array.isArray(o)?o:[o]}}const bl=a=>{const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.classList.add("l7-iconfont"),o.setAttribute("aria-hidden","true");const f=document.createElementNS("http://www.w3.org/2000/svg","use");return f.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${a}`),o.appendChild(f),o};class zc extends null{constructor(...o){var f;super(...o),f=this,_defineProperty(this,"onClick",_asyncToGenerator(function*(){const{onExport:v}=f.controlOption;v==null||v(yield f.getImage())})),_defineProperty(this,"mergeImage",_asyncToGenerator(function*(...v){var T,O;const{imageType:L}=f.controlOption,{width:F=0,height:H=0}=(T=(O=f.mapsService.getContainer())===null||O===void 0?void 0:O.getBoundingClientRect())!==null&&T!==void 0?T:{},ie=document.createElement("canvas");ie.width=F,ie.height=H;const xe=ie.getContext("2d");return(yield Promise.all(v.map(Ye=>new Promise(Lt=>{const an=new Image;an.onload=()=>{Lt(an)},an.src=Ye})))).forEach(Ye=>{xe==null||xe.drawImage(Ye,0,0,F,H)}),ie.toDataURL(`image/${L}`)}))}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),o}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:createL7Icon("l7-icon-export-picture"),imageType:"png"})}getImage(){var o=this;return _asyncToGenerator(function*(){const f=yield o.mapsService.exportMap("png"),v=yield o.scene.exportPng("png");return o.mergeImage(...[f,v].filter(T=>T))})()}}const ic=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Rs=(()=>{if(typeof document=="undefined")return!1;const a=ic[0],o={};for(const f of ic)if((f==null?void 0:f[1])in document){for(const[T,O]of f.entries())o[a[T]]=O;return o}return!1})(),ll={change:Rs.fullscreenchange,error:Rs.fullscreenerror};let Qs={request(a=document.documentElement,o){return new Promise((f,v)=>{const T=()=>{Qs.off("change",T),f()};Qs.on("change",T);const O=a[Rs.requestFullscreen](o);O instanceof Promise&&O.then(T).catch(v)})},exit(){return new Promise((a,o)=>{if(!Qs.isFullscreen){a();return}const f=()=>{Qs.off("change",f),a()};Qs.on("change",f);const v=document[Rs.exitFullscreen]();v instanceof Promise&&v.then(f).catch(o)})},toggle(a,o){return Qs.isFullscreen?Qs.exit():Qs.request(a,o)},onchange(a){Qs.on("change",a)},onerror(a){Qs.on("error",a)},on(a,o){const f=ll[a];f&&document.addEventListener(f,o,!1)},off(a,o){const f=ll[a];f&&document.removeEventListener(f,o,!1)},raw:Rs};Object.defineProperties(Qs,{isFullscreen:{get:()=>!!document[Rs.fullscreenElement]},element:{enumerable:!0,get:()=>{var a;return(a=document[Rs.fullscreenElement])!==null&&a!==void 0?a:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[Rs.fullscreenEnabled]}}),Rs||(Qs={isEnabled:!1});var Tc=null;class Ch extends null{constructor(o){var f;super(o),f=this,_defineProperty(this,"isFullscreen",!1),_defineProperty(this,"mapContainer",void 0),_defineProperty(this,"toggleFullscreen",_asyncToGenerator(function*(){ScreenFull.isEnabled&&(yield ScreenFull.toggle(f.mapContainer))})),_defineProperty(this,"onClick",()=>{this.toggleFullscreen()}),_defineProperty(this,"onFullscreenChange",()=>{this.isFullscreen=!!document.fullscreenElement;const{btnText:v,btnIcon:T,title:O,exitBtnText:L,exitBtnIcon:F,exitTitle:H}=this.controlOption;this.isFullscreen?(this.setBtnTitle(H),this.setBtnText(L),this.setBtnIcon(F)):(this.setBtnTitle(O),this.setBtnText(v),this.setBtnIcon(T)),this.emit("fullscreenChange",this.isFullscreen)}),ScreenFull.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316")}setOptions(o){const{exitBtnText:f,exitBtnIcon:v,exitTitle:T}=o;this.isFullscreen&&(this.checkUpdateOption(o,["exitBtnIcon"])&&this.setBtnIcon(v),this.checkUpdateOption(o,["exitBtnText"])&&this.setBtnText(f),this.checkUpdateOption(o,["exitTitle"])&&this.setBtnTitle(T)),super.setOptions(o)}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),this.mapContainer=DOM.getContainer(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),o}onRemove(){super.onRemove(),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5168\u5C4F",btnIcon:createL7Icon("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:createL7Icon("l7-icon-exit-fullscreen")})}}class Il extends null{constructor(o){var f;super(o),f=this,_defineProperty(this,"getGeoLocation",()=>new Promise((v,T)=>{window.navigator.geolocation.getCurrentPosition(({coords:O})=>{const{longitude:L,latitude:F}=O!=null?O:{};!isNaN(L)&&!isNaN(F)?v([L,F]):T()},O=>{T(O)})})),_defineProperty(this,"onClick",_asyncToGenerator(function*(){if(!window.navigator.geolocation)return;const{transform:v}=f.controlOption,T=yield f.getGeoLocation(),O=f.mapsService.getZoom();f.mapsService.setZoomAndCenter(O>15?O:15,v?yield v(T):T)})),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D")}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5B9A\u4F4D",btnIcon:createL7Icon("l7-icon-reposition")})}onAdd(){const o=super.onAdd();return o.addEventListener("click",this.onClick),o}}function cu(a){return Object.keys(a!=null?a:{}).every(o=>["layer","name","img"].includes(o))}class pl extends null{constructor(...o){super(...o),_defineProperty(this,"onLayerChange",()=>{var f;(f=this.controlOption.layers)!==null&&f!==void 0&&f.length||(this.selectValue=this.getLayerVisible(),this.setOptions({options:this.getLayerOptions()}))}),_defineProperty(this,"onLayerVisibleChane",()=>{this.setSelectValue(this.getLayerVisible())}),_defineProperty(this,"onSelectChange",()=>{this.layers.forEach(f=>{const v=this.selectValue.includes(f.name),T=f.isVisible();v&&!T&&f.show(),!v&&T&&f.hide()})})}get layers(){const o=this.layerService,{layers:f}=this.controlOption;if(Array.isArray(f)&&f.length){const v=[];return f.forEach(T=>{if(T instanceof Object&&(cu(T)?v.push(T.layer):v.push(T)),typeof T=="string"){const O=o.getLayer(T)||o.getLayerByName(T);O&&v.push(O)}}),v}return o.getLayers()||[]}getDefault(o){var f;return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:createL7Icon("l7-icon-layer"),options:[],multiple:(f=o==null?void 0:o.multiple)!==null&&f!==void 0?f:!0})}getLayerVisible(){return this.layers.filter(o=>o.isVisible()).map(o=>o.name)}getLayerOptions(){const{layers:o}=this.controlOption,f=o==null?void 0:o.every(v=>v.img);return o?o==null?void 0:o.map(v=>{if(cu(v))return{text:v.name||v.layer.name,value:v.layer.name,img:f?v.img:void 0};if(typeof v=="string"){const T=this.layerService.getLayer(v)||this.layerService.getLayerByName(v);return{text:T==null?void 0:T.name,value:T==null?void 0:T.name}}return{text:v.name,value:v.name}}):this.layers.map(v=>({text:v.name,value:v.name}))}setOptions(o){const f=this.checkUpdateOption(o,["layers","multiple"]);super.setOptions(o),f&&(this.controlOption.multiple===!1&&this.handleSingleSelection(),this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}handleSingleSelection(){this.layers.forEach((o,f)=>{f===0?o.show():o.hide()})}onAdd(){var o;return this.controlOption.multiple===!1&&this.handleSingleSelection(),(o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),super.onAdd()}onRemove(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}getIsMultiple(){return this.controlOption.multiple}}class $d extends Zr{getDefault(){return{position:K.d.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const o=Pe.SO.create("div","l7-control-logo");return this.setLogoContent(o),o}onRemove(){return null}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["img","href"])&&(Pe.SO.clearChildren(this.container),this.setLogoContent(this.container))}setLogoContent(o){const{href:f,img:v}=this.controlOption,T=Pe.SO.create("img");if(T.setAttribute("src",v),T.setAttribute("aria-label","AntV logo"),Pe.SO.setUnDraggable(T),f){const O=Pe.SO.create("a","l7-control-logo-link");O.target="_blank",O.href=f,O.rel="noopener nofollow",O.setAttribute("rel","noopener nofollow"),O.appendChild(T),o.appendChild(O)}else o.appendChild(T)}}const Td={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},Oh={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};class Sf extends null{constructor(...o){super(...o),_defineProperty(this,"onMapThemeChange",()=>{this.mapsService.setMapStyle(this.selectValue[0])})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:createL7Icon("l7-icon-color"),options:[]})}getStyleOptions(){const o=this.mapsService.getType()==="mapbox"?MapboxMapStyleConfig:GaodeMapStyleConfig;return Object.entries(this.mapsService.getMapStyleConfig()).filter(([f,v])=>typeof v=="string"&&f!=="blank").map(([f,v])=>{var T;const{text:O,img:L}=(T=o[f])!==null&&T!==void 0?T:{};return{text:O!=null?O:f,value:v,img:L,key:f}})}getMapStyle(){return this.mapsService.getMapStyle()}onAdd(){var o;if((o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var f,v;const T=this.controlOption.defaultValue;this.controlOption.defaultValue=(f=(v=this.controlOption.options.find(O=>O.key===T))===null||v===void 0?void 0:v.value)!==null&&f!==void 0?f:T}else{const T=this.getMapStyle();T?this.controlOption.defaultValue=T:this.mapsService.map.once("styledata",()=>{const O=this.mapsService.getMapStyle();this.controlOption.defaultValue=O,this.setSelectValue(O,!1)})}return this.on("selectChange",this.onMapThemeChange),super.onAdd()}getIsMultiple(){return!1}}class Qh extends null{constructor(...o){super(...o),_defineProperty(this,"location",[0,0]),_defineProperty(this,"onMouseMove",f=>{let v=this.location;const T=f.lngLat||f.lnglat,{transform:O}=this.controlOption;T&&(v=[T.lng,T.lat]),this.location=v,O&&(v=O(v)),this.insertLocation2HTML(v),this.emit("locationChange",v)})}getLocation(){return this.location}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{position:PositionType.BOTTOMLEFT,transform:([f,v])=>[+(+f).toFixed(6),+(+v).toFixed(6)]})}onAdd(){const o=DOM.create("div","l7-control-mouse-location");return o.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),o}onRemove(){this.mapsService.off("mousemove",this.onMouseMove)}insertLocation2HTML(o){this.container.innerText=o.join(", ")}}class Rh extends null{constructor(...o){super(...o),_defineProperty(this,"mScale",void 0),_defineProperty(this,"iScale",void 0),_defineProperty(this,"update",()=>{const f=this.mapsService,{maxWidth:v}=this.controlOption,T=f.getSize()[1]/2,O=f.containerToLngLat([0,T]),L=f.containerToLngLat([v,T]),F=lnglatDistance([O.lng,O.lat],[L.lng,L.lat]);this.updateScales(F)})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{name:"scale",position:PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const f=DOM.create("div","l7-control-scale");this.resetScaleLines(f);const{updateWhenIdle:v}=this.controlOption;return this.mapsService.on(v?"moveend":"mapmove",this.update),this.mapsService.on(v?"zoomend":"zoomchange",this.update),f}onRemove(){const{updateWhenIdle:o}=this.controlOption;this.mapsService.off(o?"zoomend":"zoomchange",this.update),this.mapsService.off(o?"moveend":"mapmove",this.update)}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(o){const{metric:f,imperial:v}=this.controlOption;f&&o&&this.updateMetric(o),v&&o&&this.updateImperial(o)}resetScaleLines(o){DOM.clearChildren(o);const{metric:f,imperial:v,maxWidth:T,lockWidth:O}=this.controlOption;O&&DOM.addStyle(o,`width: ${T}px`),f&&(this.mScale=DOM.create("div","l7-control-scale-line",o)),v&&(this.iScale=DOM.create("div","l7-control-scale-line",o)),this.update()}updateScale(o,f,v){const{maxWidth:T}=this.controlOption;o.style.width=Math.round(T*v)+"px",o.innerHTML=f}getRoundNum(o){const f=Math.pow(10,(Math.floor(o)+"").length-1);let v=o/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}updateMetric(o){const f=this.getRoundNum(o),v=f<1e3?f+" m":f/1e3+" km";this.updateScale(this.mScale,v,f/o)}updateImperial(o){const f=o*3.2808399;let v,T,O;f>5280?(v=f/5280,T=this.getRoundNum(v),this.updateScale(this.iScale,T+" mi",T/v)):(O=this.getRoundNum(f),this.updateScale(this.iScale,O+" ft",O/f))}}var Ti=D(15861),ml=D(45987);class Ll{constructor(){(0,Kt.Z)(this,"mapService",void 0),(0,Kt.Z)(this,"fontService",void 0)}apply(o,{styleAttributeService:f,mapService:v,fontService:T}){var O=this;this.mapService=v,this.fontService=T,o.hooks.init.tapPromise("DataMappingPlugin",(0,Ti.Z)(function*(){o.log(K.Or.MappingStart,K.KD.INIT),O.generateMaping(o,{styleAttributeService:f}),o.log(K.Or.MappingEnd,K.KD.INIT)})),o.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var L=(0,Ti.Z)(function*(F){if(!F)return F;o.dataState.dataMappingNeedUpdate=!1,o.log(K.Or.MappingStart,K.KD.UPDATE);const H=O.generateMaping(o,{styleAttributeService:f});return o.log(K.Or.MappingEnd,K.KD.UPDATE),H});return function(F){return L.apply(this,arguments)}}()),o.hooks.beforeRender.tap("DataMappingPlugin",()=>{const L=o.getSource();if(o.layerModelNeedUpdate||!L||!L.inited)return;const F=f.getLayerStyleAttributes()||[],H=f.getLayerStyleAttribute("filter"),{dataArray:ie}=L.data;if(Array.isArray(ie)&&ie.length===0)return;const xe=F.filter(Ye=>Ye.needRemapping);let Ee=ie;if(H!=null&&H.needRemapping&&H!==null&&H!==void 0&&H.scale&&(Ee=ie.filter(Ye=>this.applyAttributeMapping(H,Ye)[0])),xe.length){const Ye=this.mapping(o,xe,Ee,o.getEncodedData());o.setEncodedData(Ye)}})}generateMaping(o,{styleAttributeService:f}){const v=f.getLayerStyleAttributes()||[],T=f.getLayerStyleAttribute("filter"),{dataArray:O}=o.getSource().data;let L=O;T!=null&&T.scale&&(L=O.filter(H=>this.applyAttributeMapping(T,H)[0])),L=o.processData(L);const F=this.mapping(o,v,L,void 0);return o.setEncodedData(F),o.emit("dataUpdate",null),!0}mapping(o,f,v,T){const O=f.filter(F=>F.scale!==void 0).filter(F=>F.name!=="filter"),L=v.map((F,H)=>{const ie=T?T[H]:{},xe=(0,Cr.Z)({id:F._id,coordinates:F.coordinates},ie);return O.forEach(Ee=>{let Ye=this.applyAttributeMapping(Ee,F);(Ee.name==="color"||Ee.name==="stroke")&&(Ye=Ye.map(Lt=>(0,Pe.CI)(Lt))),xe[Ee.name]=Array.isArray(Ye)&&Ye.length===1?Ye[0]:Ye,Ee.name==="shape"&&(xe.shape=this.fontService.getIconFontKey(xe[Ee.name]))}),xe});return f.forEach(F=>{F.needRemapping=!1}),this.adjustData2SimpleCoordinates(L),L}adjustData2SimpleCoordinates(o){o.length>0&&this.mapService.version==="SIMPLE"&&o.map(f=>{f.simpleCoordinate||(f.coordinates=this.unProjectCoordinates(f.coordinates),f.simpleCoordinate=!0)})}unProjectCoordinates(o){if(typeof o[0]=="number")return this.mapService.simpleMapCoord.unproject(o);if(o[0]&&o[0][0]instanceof Array){const f=[];return o.map(v=>{const T=[];v.map(O=>{T.push(this.mapService.simpleMapCoord.unproject(O))}),f.push(T)}),f}else{const f=[];return o.map(v=>{f.push(this.mapService.simpleMapCoord.unproject(v))}),f}}applyAttributeMapping(o,f){var v;if(!o.scale)return[];const T=(o==null||(v=o.scale)===null||v===void 0?void 0:v.scalers)||[],O=[];return T.forEach(({field:F})=>{var H;(f.hasOwnProperty(F)||((H=o.scale)===null||H===void 0?void 0:H.type)==="variable")&&O.push(f[F])}),o.mapping?o.mapping(O):[]}getArrowPoints(o,f){const v=[f[0]-o[0],f[1]-o[1]],T=(0,Pe.Fv)(v);return[o[0]+T[0]*1e-4,o[1]+T[1]*1e-4]}}class Kc{constructor(){(0,Kt.Z)(this,"mapService",void 0)}apply(o){var f=this;this.mapService=o.getContainer().mapService,o.hooks.init.tapPromise("DataSourcePlugin",(0,Ti.Z)(function*(){o.log(K.Or.SourceInitStart,K.KD.INIT);let v=o.getSource();if(!v){const{data:T,options:O}=o.sourceOption||o.defaultSourceConfig;v=new vi(T,O),o.setSource(v)}v.inited?(f.updateClusterData(o),o.log(K.Or.SourceInitEnd,K.KD.INIT)):yield new Promise(T=>{v.on("update",O=>{O.type==="inited"&&(f.updateClusterData(o),o.log(K.Or.SourceInitEnd,K.KD.INIT)),T(null)})})})),o.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,Ti.Z)(function*(){const v=f.updateClusterData(o),T=o.dataState.dataSourceNeedUpdate;return o.dataState.dataSourceNeedUpdate=!1,v||T}))}updateClusterData(o){if(o.isTileLayer||o.tileLayer||!o.getSource())return!1;const f=o.getSource(),v=f.cluster,{zoom:T=0}=f.clusterOptions,O=this.mapService.getZoom()-1,L=o.dataState.dataSourceNeedUpdate;return v&&L&&f.updateClusterData(Math.floor(O)),v&&Math.abs(o.clusterZoom-O)>=1?(T!==Math.floor(O)&&f.updateClusterData(Math.floor(O)),o.clusterZoom=O,!0):!1}}var os=D(64599),Ns=D.n(os);function ga(a,o){var f,v;if(o===void 0){var T=Ns()(a),O;try{for(T.s();!(O=T.n()).done;){var L=O.value;L!=null&&(f===void 0?L>=L&&(f=v=L):(f>L&&(f=L),v<L&&(v=L)))}}catch(Ee){T.e(Ee)}finally{T.f()}}else{var F=-1,H=Ns()(a),ie;try{for(H.s();!(ie=H.n()).done;){var xe=ie.value;(xe=o(xe,++F,a))!=null&&(f===void 0?xe>=xe&&(f=v=xe):(f>xe&&(f=xe),v<xe&&(v=xe)))}}catch(Ee){H.e(Ee)}finally{H.f()}}return[f,v]}var xl=D(37620);function Ba(a,o,f,v,T){var O=a*a,L=O*a;return((1-3*a+3*O-L)*o+(4-6*O+3*L)*f+(1+3*a+3*O-3*L)*v+L*T)/6}function ih(a){var o=a.length-1;return function(f){var v=f<=0?f=0:f>=1?(f=1,o-1):Math.floor(f*o),T=a[v],O=a[v+1],L=v>0?a[v-1]:2*T-O,F=v<o-1?a[v+2]:2*O-T;return Ba((f-v/o)*o,L,T,O,F)}}function a0(a){var o=a.length;return function(f){var v=Math.floor(((f%=1)<0?++f:f)*o),T=a[(v+o-1)%o],O=a[v%o],L=a[(v+1)%o],F=a[(v+2)%o];return Ba((f-v/o)*o,T,O,L,F)}}function Tf(a){return function(){return a}}function Kd(a,o){return function(f){return a+f*o}}function oh(a,o,f){return a=Math.pow(a,f),o=Math.pow(o,f)-a,f=1/f,function(v){return Math.pow(a+v*o,f)}}function wd(a,o){var f=o-a;return f?Kd(a,f>180||f<-180?f-360*Math.round(f/360):f):constant(isNaN(a)?o:a)}function Vf(a){return(a=+a)==1?zs:function(o,f){return f-o?oh(o,f,a):Tf(isNaN(o)?f:o)}}function zs(a,o){var f=o-a;return f?Kd(a,f):Tf(isNaN(a)?o:a)}var s0=function a(o){var f=Vf(o);function v(T,O){var L=f((T=(0,xl.B8)(T)).r,(O=(0,xl.B8)(O)).r),F=f(T.g,O.g),H=f(T.b,O.b),ie=zs(T.opacity,O.opacity);return function(xe){return T.r=L(xe),T.g=F(xe),T.b=H(xe),T.opacity=ie(xe),T+""}}return v.gamma=a,v}(1);function wf(a){return function(o){var f=o.length,v=new Array(f),T=new Array(f),O=new Array(f),L,F;for(L=0;L<f;++L)F=(0,xl.B8)(o[L]),v[L]=F.r||0,T[L]=F.g||0,O[L]=F.b||0;return v=a(v),T=a(T),O=a(O),F.opacity=1,function(H){return F.r=v(H),F.g=T(H),F.b=O(H),F+""}}}var uu=wf(ih),vo=wf(a0);function dm(a,o){return a<o?-1:a>o?1:a>=o?0:NaN}function Cp(a){return a.length===1&&(a=vy(a)),{left:function(o,f,v,T){for(v==null&&(v=0),T==null&&(T=o.length);v<T;){var O=v+T>>>1;a(o[O],f)<0?v=O+1:T=O}return v},right:function(o,f,v,T){for(v==null&&(v=0),T==null&&(T=o.length);v<T;){var O=v+T>>>1;a(o[O],f)>0?T=O:v=O+1}return v}}}function vy(a){return function(o,f){return dm(a(o),f)}}var ig=Cp(dm),gy=ig.right,dv=ig.left,pm=gy,l0=Array.prototype,yy=l0.slice,Op=l0.map,Rp=Math.sqrt(50),pv=Math.sqrt(10),mv=Math.sqrt(2);function og(a,o,f){var v,T=-1,O,L,F;if(o=+o,a=+a,f=+f,a===o&&f>0)return[a];if((v=o<a)&&(O=a,a=o,o=O),(F=mm(a,o,f))===0||!isFinite(F))return[];if(F>0)for(a=Math.ceil(a/F),o=Math.floor(o/F),L=new Array(O=Math.ceil(o-a+1));++T<O;)L[T]=(a+T)*F;else for(a=Math.floor(a*F),o=Math.ceil(o*F),L=new Array(O=Math.ceil(a-o+1));++T<O;)L[T]=(a-T)/F;return v&&L.reverse(),L}function mm(a,o,f){var v=(o-a)/Math.max(0,f),T=Math.floor(Math.log(v)/Math.LN10),O=v/Math.pow(10,T);return T>=0?(O>=Rp?10:O>=pv?5:O>=mv?2:1)*Math.pow(10,T):-Math.pow(10,-T)/(O>=Rp?10:O>=pv?5:O>=mv?2:1)}function ag(a,o,f){var v=Math.abs(o-a)/Math.max(0,f),T=Math.pow(10,Math.floor(Math.log(v)/Math.LN10)),O=v/T;return O>=Rp?T*=10:O>=pv?T*=5:O>=mv&&(T*=2),o<a?-T:T}function c0(){var a=identity,o=extent,f=sturges;function v(T){var O,L=T.length,F,H=new Array(L);for(O=0;O<L;++O)H[O]=a(T[O],O,T);var ie=o(H),xe=ie[0],Ee=ie[1],Ye=f(H,xe,Ee);Array.isArray(Ye)||(Ye=tickStep(xe,Ee,Ye),Ye=range(Math.ceil(xe/Ye)*Ye,Ee,Ye));for(var Lt=Ye.length;Ye[0]<=xe;)Ye.shift(),--Lt;for(;Ye[Lt-1]>Ee;)Ye.pop(),--Lt;var an=new Array(Lt+1),Pn;for(O=0;O<=Lt;++O)Pn=an[O]=[],Pn.x0=O>0?Ye[O-1]:xe,Pn.x1=O<Lt?Ye[O]:Ee;for(O=0;O<L;++O)F=H[O],xe<=F&&F<=Ee&&an[bisect(Ye,F,0,Lt)].push(T[O]);return an}return v.value=function(T){return arguments.length?(a=typeof T=="function"?T:constant(T),v):a},v.domain=function(T){return arguments.length?(o=typeof T=="function"?T:constant([T[0],T[1]]),v):o},v.thresholds=function(T){return arguments.length?(f=typeof T=="function"?T:Array.isArray(T)?constant(slice.call(T)):constant(T),v):f},v}function u0(a,o,f){return a=map.call(a,number).sort(ascending),Math.ceil((f-o)/(2*(quantile(a,.75)-quantile(a,.25))*Math.pow(a.length,-1/3)))}function Af(a){return a===null?NaN:+a}function vm(a,o,f){if(f==null&&(f=Af),!!(v=a.length)){if((o=+o)<=0||v<2)return+f(a[0],0,a);if(o>=1)return+f(a[v-1],v-1,a);var v,T=(v-1)*o,O=Math.floor(T),L=+f(a[O],O,a),F=+f(a[O+1],O+1,a);return L+(F-L)*(T-O)}}var oc="$";function qd(){}qd.prototype=El.prototype={constructor:qd,has:function(a){return oc+a in this},get:function(a){return this[oc+a]},set:function(a,o){return this[oc+a]=o,this},remove:function(a){var o=oc+a;return o in this&&delete this[o]},clear:function(){for(var a in this)a[0]===oc&&delete this[a]},keys:function(){var a=[];for(var o in this)o[0]===oc&&a.push(o.slice(1));return a},values:function(){var a=[];for(var o in this)o[0]===oc&&a.push(this[o]);return a},entries:function(){var a=[];for(var o in this)o[0]===oc&&a.push({key:o.slice(1),value:this[o]});return a},size:function(){var a=0;for(var o in this)o[0]===oc&&++a;return a},empty:function(){for(var a in this)if(a[0]===oc)return!1;return!0},each:function(a){for(var o in this)o[0]===oc&&a(this[o],o.slice(1),this)}};function El(a,o){var f=new qd;if(a instanceof qd)a.each(function(F,H){f.set(H,F)});else if(Array.isArray(a)){var v=-1,T=a.length,O;if(o==null)for(;++v<T;)f.set(v,a[v]);else for(;++v<T;)f.set(o(O=a[v],v,a),O)}else if(a)for(var L in a)f.set(L,a[L]);return f}var Ad=El;function Mp(){var a=[],o=[],f,v,T;function O(F,H,ie,xe){if(H>=a.length)return f!=null&&F.sort(f),v!=null?v(F):F;for(var Ee=-1,Ye=F.length,Lt=a[H++],an,Pn,sr=map(),Rr,Tr=ie();++Ee<Ye;)(Rr=sr.get(an=Lt(Pn=F[Ee])+""))?Rr.push(Pn):sr.set(an,[Pn]);return sr.each(function(li,Ui){xe(Tr,Ui,O(li,H,ie,xe))}),Tr}function L(F,H){if(++H>a.length)return F;var ie,xe=o[H-1];return v!=null&&H>=a.length?ie=F.entries():(ie=[],F.each(function(Ee,Ye){ie.push({key:Ye,values:L(Ee,H)})})),xe!=null?ie.sort(function(Ee,Ye){return xe(Ee.key,Ye.key)}):ie}return T={object:function(F){return O(F,0,ah,Cd)},map:function(F){return O(F,0,Jh,Pp)},entries:function(F){return L(O(F,0,Jh,Pp),0)},key:function(F){return a.push(F),T},sortKeys:function(F){return o[a.length-1]=F,T},sortValues:function(F){return f=F,T},rollup:function(F){return v=F,T}}}function ah(){return{}}function Cd(a,o,f){a[o]=f}function Jh(){return map()}function Pp(a,o,f){a.set(o,f)}function fc(){}var Uu=Ad.prototype;fc.prototype=Qd.prototype={constructor:fc,has:Uu.has,add:function(a){return a+="",this[oc+a]=a,this},remove:Uu.remove,clear:Uu.clear,values:Uu.keys,size:Uu.size,empty:Uu.empty,each:Uu.each};function Qd(a,o){var f=new fc;if(a instanceof fc)a.each(function(O){f.add(O)});else if(a){var v=-1,T=a.length;if(o==null)for(;++v<T;)f.add(a[v]);else for(;++v<T;)f.add(o(a[v],v,a))}return f}var fu=null,vv=Array.prototype,ed=vv.map,Cf=vv.slice;function sh(a,o){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(o).domain(a);break}return this}function Od(a,o){switch(arguments.length){case 0:break;case 1:this.interpolator(a);break;default:this.interpolator(o).domain(a);break}return this}var td={name:"implicit"};function Jd(){var a=Ad(),o=[],f=[],v=td;function T(O){var L=O+"",F=a.get(L);if(!F){if(v!==td)return v;a.set(L,F=o.push(O))}return f[(F-1)%f.length]}return T.domain=function(O){if(!arguments.length)return o.slice();o=[],a=Ad();for(var L=-1,F=O.length,H,ie;++L<F;)a.has(ie=(H=O[L])+"")||a.set(ie,o.push(H));return T},T.range=function(O){return arguments.length?(f=Cf.call(O),T):f.slice()},T.unknown=function(O){return arguments.length?(v=O,T):v},T.copy=function(){return Jd(o,f).unknown(v)},sh.apply(T,arguments),T}function Of(){var a=ordinal().unknown(void 0),o=a.domain,f=a.range,v=[0,1],T,O,L=!1,F=0,H=0,ie=.5;delete a.unknown;function xe(){var Ee=o().length,Ye=v[1]<v[0],Lt=v[Ye-0],an=v[1-Ye];T=(an-Lt)/Math.max(1,Ee-F+H*2),L&&(T=Math.floor(T)),Lt+=(an-Lt-T*(Ee-F))*ie,O=T*(1-F),L&&(Lt=Math.round(Lt),O=Math.round(O));var Pn=sequence(Ee).map(function(sr){return Lt+T*sr});return f(Ye?Pn.reverse():Pn)}return a.domain=function(Ee){return arguments.length?(o(Ee),xe()):o()},a.range=function(Ee){return arguments.length?(v=[+Ee[0],+Ee[1]],xe()):v.slice()},a.rangeRound=function(Ee){return v=[+Ee[0],+Ee[1]],L=!0,xe()},a.bandwidth=function(){return O},a.step=function(){return T},a.round=function(Ee){return arguments.length?(L=!!Ee,xe()):L},a.padding=function(Ee){return arguments.length?(F=Math.min(1,H=+Ee),xe()):F},a.paddingInner=function(Ee){return arguments.length?(F=Math.min(1,Ee),xe()):F},a.paddingOuter=function(Ee){return arguments.length?(H=+Ee,xe()):H},a.align=function(Ee){return arguments.length?(ie=Math.max(0,Math.min(1,Ee)),xe()):ie},a.copy=function(){return Of(o(),v).round(L).paddingInner(F).paddingOuter(H).align(ie)},initRange.apply(xe(),arguments)}function nd(a){var o=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return nd(o())},a}function gv(){return nd(Of.apply(null,arguments).paddingInner(1))}function _y(a,o){return(isNumberArray(o)?numberArray:yv)(a,o)}function yv(a,o){var f=o?o.length:0,v=a?Math.min(f,a.length):0,T=new Array(v),O=new Array(f),L;for(L=0;L<v;++L)T[L]=Md(a[L],o[L]);for(;L<f;++L)O[L]=o[L];return function(F){for(L=0;L<v;++L)O[L]=T[L](F);return O}}function sg(a,o){var f=new Date;return a=+a,o=+o,function(v){return f.setTime(a*(1-v)+o*v),f}}function rd(a,o){return a=+a,o=+o,function(f){return a*(1-f)+o*f}}function gm(a,o){var f={},v={},T;(a===null||typeof a!="object")&&(a={}),(o===null||typeof o!="object")&&(o={});for(T in o)T in a?f[T]=Md(a[T],o[T]):v[T]=o[T];return function(O){for(T in f)v[T]=f[T](O);return v}}var lh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ep=new RegExp(lh.source,"g");function tp(a){return function(){return a}}function Rd(a){return function(o){return a(o)+""}}function _v(a,o){var f=lh.lastIndex=ep.lastIndex=0,v,T,O,L=-1,F=[],H=[];for(a=a+"",o=o+"";(v=lh.exec(a))&&(T=ep.exec(o));)(O=T.index)>f&&(O=o.slice(f,O),F[L]?F[L]+=O:F[++L]=O),(v=v[0])===(T=T[0])?F[L]?F[L]+=T:F[++L]=T:(F[++L]=null,H.push({i:L,x:rd(v,T)})),f=ep.lastIndex;return f<o.length&&(O=o.slice(f),F[L]?F[L]+=O:F[++L]=O),F.length<2?H[0]?Rd(H[0].x):tp(o):(o=H.length,function(ie){for(var xe=0,Ee;xe<o;++xe)F[(Ee=H[xe]).i]=Ee.x(ie);return F.join("")})}function np(a,o){o||(o=[]);var f=a?Math.min(o.length,a.length):0,v=o.slice(),T;return function(O){for(T=0;T<f;++T)v[T]=a[T]*(1-O)+o[T]*O;return v}}function V0(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function Md(a,o){var f=typeof o,v;return o==null||f==="boolean"?Tf(o):(f==="number"?rd:f==="string"?(v=(0,xl.ZP)(o))?(o=v,s0):_v:o instanceof xl.ZP?s0:o instanceof Date?sg:V0(o)?np:Array.isArray(o)?yv:typeof o.valueOf!="function"&&typeof o.toString!="function"||isNaN(o)?gm:rd)(a,o)}function qc(a,o){return a=+a,o=+o,function(f){return Math.round(a*(1-f)+o*f)}}function Qc(a){return function(){return a}}function hc(a){return+a}var lf=[0,1];function wu(a){return a}function rp(a,o){return(o-=a=+a)?function(f){return(f-a)/o}:Qc(isNaN(o)?NaN:.5)}function bv(a){var o=a[0],f=a[a.length-1],v;return o>f&&(v=o,o=f,f=v),function(T){return Math.max(o,Math.min(f,T))}}function by(a,o,f){var v=a[0],T=a[1],O=o[0],L=o[1];return T<v?(v=rp(T,v),O=f(L,O)):(v=rp(v,T),O=f(O,L)),function(F){return O(v(F))}}function lg(a,o,f){var v=Math.min(a.length,o.length)-1,T=new Array(v),O=new Array(v),L=-1;for(a[v]<a[0]&&(a=a.slice().reverse(),o=o.slice().reverse());++L<v;)T[L]=rp(a[L],a[L+1]),O[L]=f(o[L],o[L+1]);return function(F){var H=pm(a,F,1,v)-1;return O[H](T[H](F))}}function ym(a,o){return o.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp()).unknown(a.unknown())}function _m(){var a=lf,o=lf,f=Md,v,T,O,L=wu,F,H,ie;function xe(){return F=Math.min(a.length,o.length)>2?lg:by,H=ie=null,Ee}function Ee(Ye){return isNaN(Ye=+Ye)?O:(H||(H=F(a.map(v),o,f)))(v(L(Ye)))}return Ee.invert=function(Ye){return L(T((ie||(ie=F(o,a.map(v),rd)))(Ye)))},Ee.domain=function(Ye){return arguments.length?(a=ed.call(Ye,hc),L===wu||(L=bv(a)),xe()):a.slice()},Ee.range=function(Ye){return arguments.length?(o=Cf.call(Ye),xe()):o.slice()},Ee.rangeRound=function(Ye){return o=Cf.call(Ye),f=qc,xe()},Ee.clamp=function(Ye){return arguments.length?(L=Ye?bv(a):wu,Ee):L!==wu},Ee.interpolate=function(Ye){return arguments.length?(f=Ye,xe()):f},Ee.unknown=function(Ye){return arguments.length?(O=Ye,Ee):O},function(Ye,Lt){return v=Ye,T=Lt,xe()}}function xv(a,o){return _m()(a,o)}var Jc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bm(a){if(!(o=Jc.exec(a)))throw new Error("invalid format: "+a);var o;return new H0({fill:o[1],align:o[2],sign:o[3],symbol:o[4],zero:o[5],width:o[6],comma:o[7],precision:o[8]&&o[8].slice(1),trim:o[9],type:o[10]})}bm.prototype=H0.prototype;function H0(a){this.fill=a.fill===void 0?" ":a.fill+"",this.align=a.align===void 0?">":a.align+"",this.sign=a.sign===void 0?"-":a.sign+"",this.symbol=a.symbol===void 0?"":a.symbol+"",this.zero=!!a.zero,this.width=a.width===void 0?void 0:+a.width,this.comma=!!a.comma,this.precision=a.precision===void 0?void 0:+a.precision,this.trim=!!a.trim,this.type=a.type===void 0?"":a.type+""}H0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ev(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)}function Sl(a,o){if((f=(a=o?a.toExponential(o-1):a.toExponential()).indexOf("e"))<0)return null;var f,v=a.slice(0,f);return[v.length>1?v[0]+v.slice(2):v,+a.slice(f+1)]}function wc(a){return a=Sl(Math.abs(a)),a?a[1]:NaN}function Ip(a,o){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wc(o)/3)))*3-wc(Math.abs(a)))}function xm(a,o){return function(f,v){for(var T=f.length,O=[],L=0,F=a[0],H=0;T>0&&F>0&&(H+F+1>v&&(F=Math.max(1,v-H)),O.push(f.substring(T-=F,T+F)),!((H+=F+1)>v));)F=a[L=(L+1)%a.length];return O.reverse().join(o)}}function Em(a){return function(o){return o.replace(/[0-9]/g,function(f){return a[+f]})}}function Sv(a){e:for(var o=a.length,f=1,v=-1,T;f<o;++f)switch(a[f]){case".":v=T=f;break;case"0":v===0&&(v=f),T=f;break;default:if(!+a[f])break e;v>0&&(v=0);break}return v>0?a.slice(0,v)+a.slice(T+1):a}var Ue;function Qt(a,o){var f=Sl(a,o);if(!f)return a+"";var v=f[0],T=f[1],O=T-(Ue=Math.max(-8,Math.min(8,Math.floor(T/3)))*3)+1,L=v.length;return O===L?v:O>L?v+new Array(O-L+1).join("0"):O>0?v.slice(0,O)+"."+v.slice(O):"0."+new Array(1-O).join("0")+Sl(a,Math.max(0,o+O-1))[0]}function Mn(a,o){var f=Sl(a,o);if(!f)return a+"";var v=f[0],T=f[1];return T<0?"0."+new Array(-T).join("0")+v:v.length>T+1?v.slice(0,T+1)+"."+v.slice(T+1):v+new Array(T-v.length+2).join("0")}var Ar={"%":function(a,o){return(a*100).toFixed(o)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:Ev,e:function(a,o){return a.toExponential(o)},f:function(a,o){return a.toFixed(o)},g:function(a,o){return a.toPrecision(o)},o:function(a){return Math.round(a).toString(8)},p:function(a,o){return Mn(a*100,o)},r:Mn,s:Qt,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function $r(a){return a}var Or=Array.prototype.map,yr=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Ai(a){var o=a.grouping===void 0||a.thousands===void 0?$r:xm(Or.call(a.grouping,Number),a.thousands+""),f=a.currency===void 0?"":a.currency[0]+"",v=a.currency===void 0?"":a.currency[1]+"",T=a.decimal===void 0?".":a.decimal+"",O=a.numerals===void 0?$r:Em(Or.call(a.numerals,String)),L=a.percent===void 0?"%":a.percent+"",F=a.minus===void 0?"-":a.minus+"",H=a.nan===void 0?"NaN":a.nan+"";function ie(Ee){Ee=bm(Ee);var Ye=Ee.fill,Lt=Ee.align,an=Ee.sign,Pn=Ee.symbol,sr=Ee.zero,Rr=Ee.width,Tr=Ee.comma,li=Ee.precision,Ui=Ee.trim,Lo=Ee.type;Lo==="n"?(Tr=!0,Lo="g"):Ar[Lo]||(li===void 0&&(li=12),Ui=!0,Lo="g"),(sr||Ye==="0"&&Lt==="=")&&(sr=!0,Ye="0",Lt="=");var eo=Pn==="$"?f:Pn==="#"&&/[boxX]/.test(Lo)?"0"+Lo.toLowerCase():"",Wr=Pn==="$"?v:/[%p]/.test(Lo)?L:"",Wi=Ar[Lo],ka=/[defgprs%]/.test(Lo);li=li===void 0?6:/[gprs]/.test(Lo)?Math.max(1,Math.min(21,li)):Math.max(0,Math.min(20,li));function ws(ta){var ts=eo,Us=Wr,Nh,Bh,Fh;if(Lo==="c")Us=Wi(ta)+Us,ta="";else{ta=+ta;var dh=ta<0||1/ta<0;if(ta=isNaN(ta)?H:Wi(Math.abs(ta),li),Ui&&(ta=Sv(ta)),dh&&+ta==0&&an!=="+"&&(dh=!1),ts=(dh?an==="("?an:F:an==="-"||an==="("?"":an)+ts,Us=(Lo==="s"?yr[8+Ue/3]:"")+Us+(dh&&an==="("?")":""),ka){for(Nh=-1,Bh=ta.length;++Nh<Bh;)if(Fh=ta.charCodeAt(Nh),48>Fh||Fh>57){Us=(Fh===46?T+ta.slice(Nh+1):ta.slice(Nh))+Us,ta=ta.slice(0,Nh);break}}}Tr&&!sr&&(ta=o(ta,1/0));var tv=ts.length+ta.length+Us.length,hd=tv<Rr?new Array(Rr-tv+1).join(Ye):"";switch(Tr&&sr&&(ta=o(hd+ta,hd.length?Rr-Us.length:1/0),hd=""),Lt){case"<":ta=ts+ta+Us+hd;break;case"=":ta=ts+hd+ta+Us;break;case"^":ta=hd.slice(0,tv=hd.length>>1)+ts+ta+Us+hd.slice(tv);break;default:ta=hd+ts+ta+Us;break}return O(ta)}return ws.toString=function(){return Ee+""},ws}function xe(Ee,Ye){var Lt=ie((Ee=bm(Ee),Ee.type="f",Ee)),an=Math.max(-8,Math.min(8,Math.floor(wc(Ye)/3)))*3,Pn=Math.pow(10,-an),sr=yr[8+an/3];return function(Rr){return Lt(Pn*Rr)+sr}}return{format:ie,formatPrefix:xe}}var fi,Li,wi;Ni({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Ni(a){return fi=Ai(a),Li=fi.format,wi=fi.formatPrefix,fi}function Yi(a,o){return a=Math.abs(a),o=Math.abs(o)-a,Math.max(0,wc(o)-wc(a))+1}function pi(a){return Math.max(0,-wc(Math.abs(a)))}function Fi(a,o,f,v){var T=ag(a,o,f),O;switch(v=bm(v==null?",f":v),v.type){case"s":{var L=Math.max(Math.abs(a),Math.abs(o));return v.precision==null&&!isNaN(O=Ip(T,L))&&(v.precision=O),wi(v,L)}case"":case"e":case"g":case"p":case"r":{v.precision==null&&!isNaN(O=Yi(T,Math.max(Math.abs(a),Math.abs(o))))&&(v.precision=O-(v.type==="e"));break}case"f":case"%":{v.precision==null&&!isNaN(O=pi(T))&&(v.precision=O-(v.type==="%")*2);break}}return Li(v)}function ur(a){var o=a.domain;return a.ticks=function(f){var v=o();return og(v[0],v[v.length-1],f==null?10:f)},a.tickFormat=function(f,v){var T=o();return Fi(T[0],T[T.length-1],f==null?10:f,v)},a.nice=function(f){f==null&&(f=10);var v=o(),T=0,O=v.length-1,L=v[T],F=v[O],H;return F<L&&(H=L,L=F,F=H,H=T,T=O,O=H),H=mm(L,F,f),H>0?(L=Math.floor(L/H)*H,F=Math.ceil(F/H)*H,H=mm(L,F,f)):H<0&&(L=Math.ceil(L*H)/H,F=Math.floor(F*H)/H,H=mm(L,F,f)),H>0?(v[T]=Math.floor(L/H)*H,v[O]=Math.ceil(F/H)*H,o(v)):H<0&&(v[T]=Math.ceil(L*H)/H,v[O]=Math.floor(F*H)/H,o(v)),a},a}function Nr(){var a=xv(wu,wu);return a.copy=function(){return ym(a,Nr())},sh.apply(a,arguments),ur(a)}function Ci(a){var o;function f(v){return isNaN(v=+v)?o:v}return f.invert=f,f.domain=f.range=function(v){return arguments.length?(a=map.call(v,number),f):a.slice()},f.unknown=function(v){return arguments.length?(o=v,f):o},f.copy=function(){return Ci(a).unknown(o)},a=arguments.length?map.call(a,number):[0,1],linearish(f)}function Hi(a,o){a=a.slice();var f=0,v=a.length-1,T=a[f],O=a[v],L;return O<T&&(L=f,f=v,v=L,L=T,T=O,O=L),a[f]=o.floor(T),a[v]=o.ceil(O),a}function ei(a){return Math.log(a)}function ro(a){return Math.exp(a)}function yi(a){return-Math.log(-a)}function to(a){return-Math.exp(-a)}function si(a){return isFinite(a)?+("1e"+a):a<0?0:a}function qi(a){return a===10?si:a===Math.E?Math.exp:function(o){return Math.pow(a,o)}}function Go(a){return a===Math.E?Math.log:a===10&&Math.log10||a===2&&Math.log2||(a=Math.log(a),function(o){return Math.log(o)/a})}function fa(a){return function(o){return-a(-o)}}function $i(a){var o=a(ei,ro),f=o.domain,v=10,T,O;function L(){return T=Go(v),O=qi(v),f()[0]<0?(T=fa(T),O=fa(O),a(yi,to)):a(ei,ro),o}return o.base=function(F){return arguments.length?(v=+F,L()):v},o.domain=function(F){return arguments.length?(f(F),L()):f()},o.ticks=function(F){var H=f(),ie=H[0],xe=H[H.length-1],Ee;(Ee=xe<ie)&&(Ye=ie,ie=xe,xe=Ye);var Ye=T(ie),Lt=T(xe),an,Pn,sr,Rr=F==null?10:+F,Tr=[];if(!(v%1)&&Lt-Ye<Rr){if(Ye=Math.round(Ye)-1,Lt=Math.round(Lt)+1,ie>0){for(;Ye<Lt;++Ye)for(Pn=1,an=O(Ye);Pn<v;++Pn)if(sr=an*Pn,!(sr<ie)){if(sr>xe)break;Tr.push(sr)}}else for(;Ye<Lt;++Ye)for(Pn=v-1,an=O(Ye);Pn>=1;--Pn)if(sr=an*Pn,!(sr<ie)){if(sr>xe)break;Tr.push(sr)}}else Tr=og(Ye,Lt,Math.min(Lt-Ye,Rr)).map(O);return Ee?Tr.reverse():Tr},o.tickFormat=function(F,H){if(H==null&&(H=v===10?".0e":","),typeof H!="function"&&(H=Li(H)),F===1/0)return H;F==null&&(F=10);var ie=Math.max(1,v*F/o.ticks().length);return function(xe){var Ee=xe/O(Math.round(T(xe)));return Ee*v<v-.5&&(Ee*=v),Ee<=ie?H(xe):""}},o.nice=function(){return f(Hi(f(),{floor:function(F){return O(Math.floor(T(F)))},ceil:function(F){return O(Math.ceil(T(F)))}}))},o}function _i(){var a=$i(_m()).domain([1,10]);return a.copy=function(){return ym(a,_i()).base(a.base())},sh.apply(a,arguments),a}function qr(a){return function(o){return Math.sign(o)*Math.log1p(Math.abs(o/a))}}function Zo(a){return function(o){return Math.sign(o)*Math.expm1(Math.abs(o))*a}}function Ua(a){var o=1,f=a(qr(o),Zo(o));return f.constant=function(v){return arguments.length?a(qr(o=+v),Zo(o)):o},linearish(f)}function oo(){var a=Ua(transformer());return a.copy=function(){return copy(a,oo()).constant(a.constant())},initRange.apply(a,arguments)}function Pa(a){return function(o){return o<0?-Math.pow(-o,a):Math.pow(o,a)}}function da(a){return a<0?-Math.sqrt(-a):Math.sqrt(a)}function oa(a){return a<0?-a*a:a*a}function gs(a){var o=a(wu,wu),f=1;function v(){return f===1?a(wu,wu):f===.5?a(da,oa):a(Pa(f),Pa(1/f))}return o.exponent=function(T){return arguments.length?(f=+T,v()):f},ur(o)}function jl(){var a=gs(_m());return a.copy=function(){return ym(a,jl()).exponent(a.exponent())},sh.apply(a,arguments),a}function eu(){return jl.apply(null,arguments).exponent(.5)}function ja(){var a=[],o=[],f=[],v;function T(){var L=0,F=Math.max(1,o.length);for(f=new Array(F-1);++L<F;)f[L-1]=vm(a,L/F);return O}function O(L){return isNaN(L=+L)?v:o[pm(f,L)]}return O.invertExtent=function(L){var F=o.indexOf(L);return F<0?[NaN,NaN]:[F>0?f[F-1]:a[0],F<f.length?f[F]:a[a.length-1]]},O.domain=function(L){if(!arguments.length)return a.slice();a=[];for(var F=0,H=L.length,ie;F<H;++F)ie=L[F],ie!=null&&!isNaN(ie=+ie)&&a.push(ie);return a.sort(dm),T()},O.range=function(L){return arguments.length?(o=Cf.call(L),T()):o.slice()},O.unknown=function(L){return arguments.length?(v=L,O):v},O.quantiles=function(){return f.slice()},O.copy=function(){return ja().domain(a).range(o).unknown(v)},sh.apply(O,arguments)}function Xl(){var a=0,o=1,f=1,v=[.5],T=[0,1],O;function L(H){return H<=H?T[pm(v,H,0,f)]:O}function F(){var H=-1;for(v=new Array(f);++H<f;)v[H]=((H+1)*o-(H-f)*a)/(f+1);return L}return L.domain=function(H){return arguments.length?(a=+H[0],o=+H[1],F()):[a,o]},L.range=function(H){return arguments.length?(f=(T=Cf.call(H)).length-1,F()):T.slice()},L.invertExtent=function(H){var ie=T.indexOf(H);return ie<0?[NaN,NaN]:ie<1?[a,v[0]]:ie>=f?[v[f-1],o]:[v[ie-1],v[ie]]},L.unknown=function(H){return arguments.length&&(O=H),L},L.thresholds=function(){return v.slice()},L.copy=function(){return Xl().domain([a,o]).range(T).unknown(O)},sh.apply(ur(L),arguments)}function Js(){var a=[.5],o=[0,1],f,v=1;function T(O){return O<=O?o[pm(a,O,0,v)]:f}return T.domain=function(O){return arguments.length?(a=Cf.call(O),v=Math.min(a.length,o.length-1),T):a.slice()},T.range=function(O){return arguments.length?(o=Cf.call(O),v=Math.min(a.length,o.length-1),T):o.slice()},T.invertExtent=function(O){var L=o.indexOf(O);return[a[L-1],a[L]]},T.unknown=function(O){return arguments.length?(f=O,T):f},T.copy=function(){return Js().domain(a).range(o).unknown(f)},sh.apply(T,arguments)}var vl=new Date,Yl=new Date;function ps(a,o,f,v){function T(O){return a(O=arguments.length===0?new Date:new Date(+O)),O}return T.floor=function(O){return a(O=new Date(+O)),O},T.ceil=function(O){return a(O=new Date(O-1)),o(O,1),a(O),O},T.round=function(O){var L=T(O),F=T.ceil(O);return O-L<F-O?L:F},T.offset=function(O,L){return o(O=new Date(+O),L==null?1:Math.floor(L)),O},T.range=function(O,L,F){var H=[],ie;if(O=T.ceil(O),F=F==null?1:Math.floor(F),!(O<L)||!(F>0))return H;do H.push(ie=new Date(+O)),o(O,F),a(O);while(ie<O&&O<L);return H},T.filter=function(O){return ps(function(L){if(L>=L)for(;a(L),!O(L);)L.setTime(L-1)},function(L,F){if(L>=L)if(F<0)for(;++F<=0;)for(;o(L,-1),!O(L););else for(;--F>=0;)for(;o(L,1),!O(L););})},f&&(T.count=function(O,L){return vl.setTime(+O),Yl.setTime(+L),a(vl),a(Yl),Math.floor(f(vl,Yl))},T.every=function(O){return O=Math.floor(O),!isFinite(O)||!(O>0)?null:O>1?T.filter(v?function(L){return v(L)%O===0}:function(L){return T.count(0,L)%O===0}):T}),T}var $l=ps(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,o){a.setFullYear(a.getFullYear()+o)},function(a,o){return o.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});$l.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:ps(function(o){o.setFullYear(Math.floor(o.getFullYear()/a)*a),o.setMonth(0,1),o.setHours(0,0,0,0)},function(o,f){o.setFullYear(o.getFullYear()+f*a)})};var Kl=$l,dc=$l.range,Ca=ps(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,o){a.setMonth(a.getMonth()+o)},function(a,o){return o.getMonth()-a.getMonth()+(o.getFullYear()-a.getFullYear())*12},function(a){return a.getMonth()}),Uc=Ca,Ms=Ca.range,Yo=1e3,Ia=6e4,us=36e5,Dl=864e5,hu=6048e5;function dn(a){return ps(function(o){o.setDate(o.getDate()-(o.getDay()+7-a)%7),o.setHours(0,0,0,0)},function(o,f){o.setDate(o.getDate()+f*7)},function(o,f){return(f-o-(f.getTimezoneOffset()-o.getTimezoneOffset())*Ia)/hu})}var Pr=dn(0),pr=dn(1),lo=dn(2),Fa=dn(3),as=dn(4),It=dn(5),rn=dn(6),In=Pr.range,wr=pr.range,br=lo.range,Vn=Fa.range,Kn=as.range,nr=It.range,bn=rn.range,Zn=ps(function(a){a.setHours(0,0,0,0)},function(a,o){a.setDate(a.getDate()+o)},function(a,o){return(o-a-(o.getTimezoneOffset()-a.getTimezoneOffset())*Ia)/Dl},function(a){return a.getDate()-1}),nn=Zn,Xn=Zn.range,Sr=ps(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Yo-a.getMinutes()*Ia)},function(a,o){a.setTime(+a+o*us)},function(a,o){return(o-a)/us},function(a){return a.getHours()}),zr=Sr,di=Sr.range,ni=ps(function(a){a.setTime(a-a.getMilliseconds()-a.getSeconds()*Yo)},function(a,o){a.setTime(+a+o*Ia)},function(a,o){return(o-a)/Ia},function(a){return a.getMinutes()}),gi=ni,To=ni.range,co=ps(function(a){a.setTime(a-a.getMilliseconds())},function(a,o){a.setTime(+a+o*Yo)},function(a,o){return(o-a)/Yo},function(a){return a.getUTCSeconds()}),So=co,mo=co.range,aa=ps(function(){},function(a,o){a.setTime(+a+o)},function(a,o){return o-a});aa.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?ps(function(o){o.setTime(Math.floor(o/a)*a)},function(o,f){o.setTime(+o+f*a)},function(o,f){return(f-o)/a}):aa};var Cs=aa,Ac=aa.range;function Au(a){return ps(function(o){o.setUTCDate(o.getUTCDate()-(o.getUTCDay()+7-a)%7),o.setUTCHours(0,0,0,0)},function(o,f){o.setUTCDate(o.getUTCDate()+f*7)},function(o,f){return(f-o)/hu})}var Sm=Au(0),cf=Au(1),cg=Au(2),Pd=Au(3),ip=Au(4),M1=Au(5),P1=Au(6),xb=Sm.range,xy=cf.range,Lp=cg.range,Ey=Pd.range,Z0=ip.range,Sy=M1.range,Va=P1.range,cl=ps(function(a){a.setUTCHours(0,0,0,0)},function(a,o){a.setUTCDate(a.getUTCDate()+o)},function(a,o){return(o-a)/Dl},function(a){return a.getUTCDate()-1}),ug=cl,ju=cl.range,fg=ps(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,o){a.setUTCFullYear(a.getUTCFullYear()+o)},function(a,o){return o.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});fg.every=function(a){return!isFinite(a=Math.floor(a))||!(a>0)?null:ps(function(o){o.setUTCFullYear(Math.floor(o.getUTCFullYear()/a)*a),o.setUTCMonth(0,1),o.setUTCHours(0,0,0,0)},function(o,f){o.setUTCFullYear(o.getUTCFullYear()+f*a)})};var Tm=fg,Eb=fg.range;function id(a){if(0<=a.y&&a.y<100){var o=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return o.setFullYear(a.y),o}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function Dp(a){if(0<=a.y&&a.y<100){var o=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return o.setUTCFullYear(a.y),o}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function Id(a,o,f){return{y:a,m:o,d:f,H:0,M:0,S:0,L:0}}function I1(a){var o=a.dateTime,f=a.date,v=a.time,T=a.periods,O=a.days,L=a.shortDays,F=a.months,H=a.shortMonths,ie=Ld(T),xe=Mh(T),Ee=Ld(O),Ye=Mh(O),Lt=Ld(L),an=Mh(L),Pn=Ld(F),sr=Mh(F),Rr=Ld(H),Tr=Mh(H),li={a:dh,A:tv,b:hd,B:qg,c:null,d:tn,e:tn,f:_r,g:Mo,G:Za,H:_n,I:zn,j:Dn,L:cr,m:Ir,M:Br,p:Sx,q:vO,Q:il,s:sc,S:jr,u:bi,U:Zi,V:ki,w:zo,W:ao,x:null,X:null,y:xa,Y:_o,Z:pa,"%":du},Ui={a:iu,A:gO,b:Kp,B:BS,c:null,d:Oa,e:Oa,f:Hl,g:$s,G:ms,H:$o,I:Es,j:Tl,L:Vl,m:wl,M:ql,p:l1,q:FS,Q:il,s:sc,S:jc,u:nu,U:fl,V:Vu,w:ac,W:Oc,x:null,X:null,y:Ya,Y:Zs,Z:Hu,"%":du},Lo={a:ws,A:ta,b:ts,B:Us,c:Nh,d:M,e:M,f:We,g:c,G:Ty,H:V,I:V,j:B,L:Le,m:A,M:Q,p:ka,q:g,Q:Et,s:Nt,S:me,u:D1,U:Sb,V:tu,w:L1,W:f0,x:Bh,X:Fh,y:c,Y:Ty,Z:d,"%":tt};li.x=eo(f,li),li.X=eo(v,li),li.c=eo(o,li),Ui.x=eo(f,Ui),Ui.X=eo(v,Ui),Ui.c=eo(o,Ui);function eo(ca,Ks){return function(el){var po=[],dd=-1,gc=0,Bd=ca.length,pd,Xv,kS;for(el instanceof Date||(el=new Date(+el));++dd<Bd;)ca.charCodeAt(dd)===37&&(po.push(ca.slice(gc,dd)),(Xv=ul[pd=ca.charAt(++dd)])!=null?pd=ca.charAt(++dd):Xv=pd==="e"?" ":"0",(kS=Ks[pd])&&(pd=kS(el,Xv)),po.push(pd),gc=dd+1);return po.push(ca.slice(gc,dd)),po.join("")}}function Wr(ca,Ks){return function(el){var po=Id(1900,void 0,1),dd=Wi(po,ca,el+="",0),gc,Bd;if(dd!=el.length)return null;if("Q"in po)return new Date(po.Q);if("s"in po)return new Date(po.s*1e3+("L"in po?po.L:0));if(Ks&&!("Z"in po)&&(po.Z=0),"p"in po&&(po.H=po.H%12+po.p*12),po.m===void 0&&(po.m="q"in po?po.q:0),"V"in po){if(po.V<1||po.V>53)return null;"w"in po||(po.w=1),"Z"in po?(gc=Dp(Id(po.y,0,1)),Bd=gc.getUTCDay(),gc=Bd>4||Bd===0?cf.ceil(gc):cf(gc),gc=ug.offset(gc,(po.V-1)*7),po.y=gc.getUTCFullYear(),po.m=gc.getUTCMonth(),po.d=gc.getUTCDate()+(po.w+6)%7):(gc=id(Id(po.y,0,1)),Bd=gc.getDay(),gc=Bd>4||Bd===0?pr.ceil(gc):pr(gc),gc=nn.offset(gc,(po.V-1)*7),po.y=gc.getFullYear(),po.m=gc.getMonth(),po.d=gc.getDate()+(po.w+6)%7)}else("W"in po||"U"in po)&&("w"in po||(po.w="u"in po?po.u%7:"W"in po?1:0),Bd="Z"in po?Dp(Id(po.y,0,1)).getUTCDay():id(Id(po.y,0,1)).getDay(),po.m=0,po.d="W"in po?(po.w+6)%7+po.W*7-(Bd+5)%7:po.w+po.U*7-(Bd+6)%7);return"Z"in po?(po.H+=po.Z/100|0,po.M+=po.Z%100,Dp(po)):id(po)}}function Wi(ca,Ks,el,po){for(var dd=0,gc=Ks.length,Bd=el.length,pd,Xv;dd<gc;){if(po>=Bd)return-1;if(pd=Ks.charCodeAt(dd++),pd===37){if(pd=Ks.charAt(dd++),Xv=Lo[pd in ul?Ks.charAt(dd++):pd],!Xv||(po=Xv(ca,el,po))<0)return-1}else if(pd!=el.charCodeAt(po++))return-1}return po}function ka(ca,Ks,el){var po=ie.exec(Ks.slice(el));return po?(ca.p=xe[po[0].toLowerCase()],el+po[0].length):-1}function ws(ca,Ks,el){var po=Lt.exec(Ks.slice(el));return po?(ca.w=an[po[0].toLowerCase()],el+po[0].length):-1}function ta(ca,Ks,el){var po=Ee.exec(Ks.slice(el));return po?(ca.w=Ye[po[0].toLowerCase()],el+po[0].length):-1}function ts(ca,Ks,el){var po=Rr.exec(Ks.slice(el));return po?(ca.m=Tr[po[0].toLowerCase()],el+po[0].length):-1}function Us(ca,Ks,el){var po=Pn.exec(Ks.slice(el));return po?(ca.m=sr[po[0].toLowerCase()],el+po[0].length):-1}function Nh(ca,Ks,el){return Wi(ca,o,Ks,el)}function Bh(ca,Ks,el){return Wi(ca,f,Ks,el)}function Fh(ca,Ks,el){return Wi(ca,v,Ks,el)}function dh(ca){return L[ca.getDay()]}function tv(ca){return O[ca.getDay()]}function hd(ca){return H[ca.getMonth()]}function qg(ca){return F[ca.getMonth()]}function Sx(ca){return T[+(ca.getHours()>=12)]}function vO(ca){return 1+~~(ca.getMonth()/3)}function iu(ca){return L[ca.getUTCDay()]}function gO(ca){return O[ca.getUTCDay()]}function Kp(ca){return H[ca.getUTCMonth()]}function BS(ca){return F[ca.getUTCMonth()]}function l1(ca){return T[+(ca.getUTCHours()>=12)]}function FS(ca){return 1+~~(ca.getUTCMonth()/3)}return{format:function(ca){var Ks=eo(ca+="",li);return Ks.toString=function(){return ca},Ks},parse:function(ca){var Ks=Wr(ca+="",!1);return Ks.toString=function(){return ca},Ks},utcFormat:function(ca){var Ks=eo(ca+="",Ui);return Ks.toString=function(){return ca},Ks},utcParse:function(ca){var Ks=Wr(ca+="",!0);return Ks.toString=function(){return ca},Ks}}}var ul={"-":"",_:" ",0:"0"},No=/^\s*\d+/,op=/^%/,hg=/[\\^$*+?|[\]().{}]/g;function Hs(a,o,f){var v=a<0?"-":"",T=(v?-a:a)+"",O=T.length;return v+(O<f?new Array(f-O+1).join(o)+T:T)}function Np(a){return a.replace(hg,"\\$&")}function Ld(a){return new RegExp("^(?:"+a.map(Np).join("|")+")","i")}function Mh(a){for(var o={},f=-1,v=a.length;++f<v;)o[a[f].toLowerCase()]=f;return o}function L1(a,o,f){var v=No.exec(o.slice(f,f+1));return v?(a.w=+v[0],f+v[0].length):-1}function D1(a,o,f){var v=No.exec(o.slice(f,f+1));return v?(a.u=+v[0],f+v[0].length):-1}function Sb(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.U=+v[0],f+v[0].length):-1}function tu(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.V=+v[0],f+v[0].length):-1}function f0(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.W=+v[0],f+v[0].length):-1}function Ty(a,o,f){var v=No.exec(o.slice(f,f+4));return v?(a.y=+v[0],f+v[0].length):-1}function c(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.y=+v[0]+(+v[0]>68?1900:2e3),f+v[0].length):-1}function d(a,o,f){var v=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(o.slice(f,f+6));return v?(a.Z=v[1]?0:-(v[2]+(v[3]||"00")),f+v[0].length):-1}function g(a,o,f){var v=No.exec(o.slice(f,f+1));return v?(a.q=v[0]*3-3,f+v[0].length):-1}function A(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.m=v[0]-1,f+v[0].length):-1}function M(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.d=+v[0],f+v[0].length):-1}function B(a,o,f){var v=No.exec(o.slice(f,f+3));return v?(a.m=0,a.d=+v[0],f+v[0].length):-1}function V(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.H=+v[0],f+v[0].length):-1}function Q(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.M=+v[0],f+v[0].length):-1}function me(a,o,f){var v=No.exec(o.slice(f,f+2));return v?(a.S=+v[0],f+v[0].length):-1}function Le(a,o,f){var v=No.exec(o.slice(f,f+3));return v?(a.L=+v[0],f+v[0].length):-1}function We(a,o,f){var v=No.exec(o.slice(f,f+6));return v?(a.L=Math.floor(v[0]/1e3),f+v[0].length):-1}function tt(a,o,f){var v=op.exec(o.slice(f,f+1));return v?f+v[0].length:-1}function Et(a,o,f){var v=No.exec(o.slice(f));return v?(a.Q=+v[0],f+v[0].length):-1}function Nt(a,o,f){var v=No.exec(o.slice(f));return v?(a.s=+v[0],f+v[0].length):-1}function tn(a,o){return Hs(a.getDate(),o,2)}function _n(a,o){return Hs(a.getHours(),o,2)}function zn(a,o){return Hs(a.getHours()%12||12,o,2)}function Dn(a,o){return Hs(1+nn.count(Kl(a),a),o,3)}function cr(a,o){return Hs(a.getMilliseconds(),o,3)}function _r(a,o){return cr(a,o)+"000"}function Ir(a,o){return Hs(a.getMonth()+1,o,2)}function Br(a,o){return Hs(a.getMinutes(),o,2)}function jr(a,o){return Hs(a.getSeconds(),o,2)}function bi(a){var o=a.getDay();return o===0?7:o}function Zi(a,o){return Hs(Pr.count(Kl(a)-1,a),o,2)}function Ro(a){var o=a.getDay();return o>=4||o===0?as(a):as.ceil(a)}function ki(a,o){return a=Ro(a),Hs(as.count(Kl(a),a)+(Kl(a).getDay()===4),o,2)}function zo(a){return a.getDay()}function ao(a,o){return Hs(pr.count(Kl(a)-1,a),o,2)}function xa(a,o){return Hs(a.getFullYear()%100,o,2)}function Mo(a,o){return a=Ro(a),Hs(a.getFullYear()%100,o,2)}function _o(a,o){return Hs(a.getFullYear()%1e4,o,4)}function Za(a,o){var f=a.getDay();return a=f>=4||f===0?as(a):as.ceil(a),Hs(a.getFullYear()%1e4,o,4)}function pa(a){var o=a.getTimezoneOffset();return(o>0?"-":(o*=-1,"+"))+Hs(o/60|0,"0",2)+Hs(o%60,"0",2)}function Oa(a,o){return Hs(a.getUTCDate(),o,2)}function $o(a,o){return Hs(a.getUTCHours(),o,2)}function Es(a,o){return Hs(a.getUTCHours()%12||12,o,2)}function Tl(a,o){return Hs(1+ug.count(Tm(a),a),o,3)}function Vl(a,o){return Hs(a.getUTCMilliseconds(),o,3)}function Hl(a,o){return Vl(a,o)+"000"}function wl(a,o){return Hs(a.getUTCMonth()+1,o,2)}function ql(a,o){return Hs(a.getUTCMinutes(),o,2)}function jc(a,o){return Hs(a.getUTCSeconds(),o,2)}function nu(a){var o=a.getUTCDay();return o===0?7:o}function fl(a,o){return Hs(Sm.count(Tm(a)-1,a),o,2)}function Cc(a){var o=a.getUTCDay();return o>=4||o===0?ip(a):ip.ceil(a)}function Vu(a,o){return a=Cc(a),Hs(ip.count(Tm(a),a)+(Tm(a).getUTCDay()===4),o,2)}function ac(a){return a.getUTCDay()}function Oc(a,o){return Hs(cf.count(Tm(a)-1,a),o,2)}function Ya(a,o){return Hs(a.getUTCFullYear()%100,o,2)}function $s(a,o){return a=Cc(a),Hs(a.getUTCFullYear()%100,o,2)}function Zs(a,o){return Hs(a.getUTCFullYear()%1e4,o,4)}function ms(a,o){var f=a.getUTCDay();return a=f>=4||f===0?ip(a):ip.ceil(a),Hs(a.getUTCFullYear()%1e4,o,4)}function Hu(){return"+0000"}function du(){return"%"}function il(a){return+a}function sc(a){return Math.floor(+a/1e3)}var Al,Ss,Bp,uf,Zu;Ql({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ql(a){return Al=I1(a),Ss=Al.format,Bp=Al.parse,uf=Al.utcFormat,Zu=Al.utcParse,Al}var ch=1e3,Rf=ch*60,ap=Rf*60,Dd=ap*24,wm=Dd*7,Nd=Dd*30,sp=Dd*365;function Am(a){return new Date(a)}function Cm(a){return a instanceof Date?+a:+new Date(+a)}function h0(a,o,f,v,T,O,L,F,H){var ie=xv(wu,wu),xe=ie.invert,Ee=ie.domain,Ye=H(".%L"),Lt=H(":%S"),an=H("%I:%M"),Pn=H("%I %p"),sr=H("%a %d"),Rr=H("%b %d"),Tr=H("%B"),li=H("%Y"),Ui=[[L,1,ch],[L,5,5*ch],[L,15,15*ch],[L,30,30*ch],[O,1,Rf],[O,5,5*Rf],[O,15,15*Rf],[O,30,30*Rf],[T,1,ap],[T,3,3*ap],[T,6,6*ap],[T,12,12*ap],[v,1,Dd],[v,2,2*Dd],[f,1,wm],[o,1,Nd],[o,3,3*Nd],[a,1,sp]];function Lo(Wr){return(L(Wr)<Wr?Ye:O(Wr)<Wr?Lt:T(Wr)<Wr?an:v(Wr)<Wr?Pn:o(Wr)<Wr?f(Wr)<Wr?sr:Rr:a(Wr)<Wr?Tr:li)(Wr)}function eo(Wr,Wi,ka,ws){if(Wr==null&&(Wr=10),typeof Wr=="number"){var ta=Math.abs(ka-Wi)/Wr,ts=Cp(function(Us){return Us[2]}).right(Ui,ta);ts===Ui.length?(ws=ag(Wi/sp,ka/sp,Wr),Wr=a):ts?(ts=Ui[ta/Ui[ts-1][2]<Ui[ts][2]/ta?ts-1:ts],ws=ts[1],Wr=ts[0]):(ws=Math.max(ag(Wi,ka,Wr),1),Wr=F)}return ws==null?Wr:Wr.every(ws)}return ie.invert=function(Wr){return new Date(xe(Wr))},ie.domain=function(Wr){return arguments.length?Ee(ed.call(Wr,Cm)):Ee().map(Am)},ie.ticks=function(Wr,Wi){var ka=Ee(),ws=ka[0],ta=ka[ka.length-1],ts=ta<ws,Us;return ts&&(Us=ws,ws=ta,ta=Us),Us=eo(Wr,ws,ta,Wi),Us=Us?Us.range(ws,ta+1):[],ts?Us.reverse():Us},ie.tickFormat=function(Wr,Wi){return Wi==null?Lo:H(Wi)},ie.nice=function(Wr,Wi){var ka=Ee();return(Wr=eo(Wr,ka[0],ka[ka.length-1],Wi))?Ee(Hi(ka,Wr)):ie},ie.copy=function(){return ym(ie,h0(a,o,f,v,T,O,L,F,H))},ie}function Om(){return sh.apply(h0(Kl,Uc,Pr,nn,zr,gi,So,Cs,Ss).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function wy(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function od(){var a=0,o=1,f,v,T,O,L=wu,F=!1,H;function ie(xe){return isNaN(xe=+xe)?H:L(T===0?.5:(xe=(O(xe)-f)*T,F?Math.max(0,Math.min(1,xe)):xe))}return ie.domain=function(xe){return arguments.length?(f=O(a=+xe[0]),v=O(o=+xe[1]),T=f===v?0:1/(v-f),ie):[a,o]},ie.clamp=function(xe){return arguments.length?(F=!!xe,ie):F},ie.interpolator=function(xe){return arguments.length?(L=xe,ie):L},ie.unknown=function(xe){return arguments.length?(H=xe,ie):H},function(xe){return O=xe,f=xe(a),v=xe(o),T=f===v?0:1/(v-f),ie}}function Fp(a,o){return o.domain(a.domain()).interpolator(a.interpolator()).clamp(a.clamp()).unknown(a.unknown())}function W0(){var a=ur(od()(wu));return a.copy=function(){return Fp(a,W0())},Od.apply(a,arguments)}function d0(){var a=loggish(od()).domain([1,10]);return a.copy=function(){return Fp(a,d0()).base(a.base())},initInterpolator.apply(a,arguments)}function Rm(){var a=symlogish(od());return a.copy=function(){return Fp(a,Rm()).constant(a.constant())},initInterpolator.apply(a,arguments)}function kp(){var a=powish(od());return a.copy=function(){return Fp(a,kp()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function Mm(){return kp.apply(null,arguments).exponent(.5)}function Tv(){var a=[],o=identity;function f(v){if(!isNaN(v=+v))return o((bisect(a,v)-1)/(a.length-1))}return f.domain=function(v){if(!arguments.length)return a.slice();a=[];for(var T=0,O=v.length,L;T<O;++T)L=v[T],L!=null&&!isNaN(L=+L)&&a.push(L);return a.sort(ascending),f},f.interpolator=function(v){return arguments.length?(o=v,f):o},f.copy=function(){return Tv(o).domain(a)},initInterpolator.apply(f,arguments)}function zp(){var a=0,o=.5,f=1,v,T,O,L,F,H=wu,ie,xe=!1,Ee;function Ye(Lt){return isNaN(Lt=+Lt)?Ee:(Lt=.5+((Lt=+ie(Lt))-T)*(Lt<T?L:F),H(xe?Math.max(0,Math.min(1,Lt)):Lt))}return Ye.domain=function(Lt){return arguments.length?(v=ie(a=+Lt[0]),T=ie(o=+Lt[1]),O=ie(f=+Lt[2]),L=v===T?0:.5/(T-v),F=T===O?0:.5/(O-T),Ye):[a,o,f]},Ye.clamp=function(Lt){return arguments.length?(xe=!!Lt,Ye):xe},Ye.interpolator=function(Lt){return arguments.length?(H=Lt,Ye):H},Ye.unknown=function(Lt){return arguments.length?(Ee=Lt,Ye):Ee},function(Lt){return ie=Lt,v=Lt(a),T=Lt(o),O=Lt(f),L=v===T?0:.5/(T-v),F=T===O?0:.5/(O-T),Ye}}function Pm(){var a=ur(zp()(wu));return a.copy=function(){return Fp(a,Pm())},Od.apply(a,arguments)}function Im(){var a=loggish(zp()).domain([.1,1,10]);return a.copy=function(){return copy(a,Im()).base(a.base())},initInterpolator.apply(a,arguments)}function p0(){var a=symlogish(zp());return a.copy=function(){return copy(a,p0()).constant(a.constant())},initInterpolator.apply(a,arguments)}function G0(){var a=powish(zp());return a.copy=function(){return copy(a,G0()).exponent(a.exponent())},initInterpolator.apply(a,arguments)}function Ay(){return G0.apply(null,arguments).exponent(.5)}function X0(a){let o,f=[];function v(T){return T==null?o:T}return v.invert=v,v.domain=v.range=T=>T?(f=T,T):f,v.unknown=T=>T?(o=T,T):o,v.copy=()=>X0(a).unknown(o),v}const{isNil:m0,isString:Lm,uniq:v0}=Pe.lodashUtil,lp=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,g0={[K.vY.LINEAR]:Nr,[K.vY.POWER]:jl,[K.vY.LOG]:_i,[K.vY.IDENTITY]:X0,[K.vY.SEQUENTIAL]:W0,[K.vY.TIME]:Om,[K.vY.QUANTILE]:ja,[K.vY.QUANTIZE]:Xl,[K.vY.THRESHOLD]:Js,[K.vY.CAT]:Jd,[K.vY.DIVERGING]:Pm};class Up{constructor(){(0,Kt.Z)(this,"scaleOptions",{})}apply(o,{styleAttributeService:f}){var v=this;o.hooks.init.tapPromise("FeatureScalePlugin",(0,Ti.Z)(function*(){var T;o.log(K.Or.ScaleInitStart,K.KD.INIT),v.scaleOptions=o.getScaleOptions();const O=f.getLayerStyleAttributes(),L=(T=o.getSource())===null||T===void 0?void 0:T.data.dataArray;Array.isArray(L)&&L.length===0||(v.caculateScalesForAttributes(O||[],L),o.log(K.Or.ScaleInitEnd,K.KD.INIT))})),o.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var T=(0,Ti.Z)(function*(O){if(!O)return O;o.log(K.Or.ScaleInitStart,K.KD.UPDATE),v.scaleOptions=o.getScaleOptions();const L=f.getLayerStyleAttributes(),F=o.getSource().data.dataArray;return Array.isArray(F)&&F.length===0||(v.caculateScalesForAttributes(L||[],F),o.log(K.Or.ScaleInitEnd,K.KD.UPDATE),o.layerModelNeedUpdate=!0),!0});return function(O){return T.apply(this,arguments)}}()),o.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(o.layerModelNeedUpdate)return;this.scaleOptions=o.getScaleOptions();const T=f.getLayerStyleAttributes(),O=o.getSource().data.dataArray;if(!(Array.isArray(O)&&O.length===0)&&T){const L=T.filter(F=>F.needRescale);L.length&&this.caculateScalesForAttributes(L,O)}})}isNumber(o){return!isNaN(parseFloat(o))&&isFinite(o)}caculateScalesForAttributes(o,f){o.forEach(v=>{if(v.scale){const T=v.scale,O=v.scale.field;T.names=this.parseFields(m0(O)?[]:O);const L=[];T.names.forEach(F=>{var H;L.push(this.createScale(F,v.name,(H=v.scale)===null||H===void 0?void 0:H.values,f))}),L.some(F=>F.type===K.ee.VARIABLE)?(T.type=K.ee.VARIABLE,L.forEach(F=>{if(!T.callback&&T.values!=="text"){var H;switch((H=F.option)===null||H===void 0?void 0:H.type){case K.vY.LOG:case K.vY.LINEAR:case K.vY.POWER:if(T.values&&T.values.length>2){const xe=F.scale.ticks(T.values.length);F.scale.domain(xe)}T.values?F.scale.range(T.values):F.scale.range(F.option.domain);break;case K.vY.QUANTILE:case K.vY.QUANTIZE:case K.vY.THRESHOLD:F.scale.range(T.values);break;case K.vY.IDENTITY:break;case K.vY.CAT:T.values?F.scale.range(T.values):F.scale.range(F.option.domain);break;case K.vY.DIVERGING:case K.vY.SEQUENTIAL:F.scale.interpolator(uu(T.values));break}}if(T.values==="text"){var ie;F.scale.range((ie=F.option)===null||ie===void 0?void 0:ie.domain)}})):(T.type=K.ee.CONSTANT,T.defaultValues=L.map((F,H)=>F.scale(T.names[H]))),T.scalers=L.map(F=>({field:F.field,func:F.scale,option:F.option})),v.needRescale=!1}})}parseFields(o){return Array.isArray(o)?o:Lm(o)?o.split("*"):[o]}createScale(o,f,v,T){var O,L;const F=this.scaleOptions[f]&&((O=this.scaleOptions[f])===null||O===void 0?void 0:O.field)===o?this.scaleOptions[f]:this.scaleOptions[o],H={field:o,scale:void 0,type:K.ee.VARIABLE,option:F};if(!T||!T.length)return F&&F.type?H.scale=this.createDefaultScale(F):(H.scale=Jd([o]),H.type=K.ee.CONSTANT),H;const ie=(L=T.find(xe=>!m0(xe[o])))===null||L===void 0?void 0:L[o];if(this.isNumber(o)||m0(ie)&&!F)H.scale=Jd([o]),H.type=K.ee.CONSTANT;else{let xe=F&&F.type||this.getDefaultType(ie);v==="text"&&(xe=K.vY.CAT),v===void 0&&(xe=K.vY.IDENTITY);const Ee=this.createScaleConfig(xe,o,F,T);H.scale=this.createDefaultScale(Ee),H.option=Ee}return H}getDefaultType(o){let f=K.vY.LINEAR;return typeof o=="string"&&(f=lp.test(o)?K.vY.TIME:K.vY.CAT),f}createScaleConfig(o,f,v,T){const O={type:o};let L=[];if(o===K.vY.QUANTILE){const F=new Map;T==null||T.forEach(H=>{F.set(H._id,H[f])}),L=Array.from(F.values())}else L=(T==null?void 0:T.map(F=>F[f]))||[];if(v!=null&&v.domain)O.domain=v==null?void 0:v.domain;else if(o===K.vY.CAT||o===K.vY.IDENTITY)O.domain=v0(L);else if(o===K.vY.QUANTILE)O.domain=L;else if(o===K.vY.DIVERGING){const F=ga(L),H=(v==null?void 0:v.neutral)!==void 0?v==null?void 0:v.neutral:(F[0]+F[1])/2;O.domain=[F[0],H,F[1]]}else O.domain=ga(L);return(0,Cr.Z)((0,Cr.Z)({},O),v)}createDefaultScale({type:o,domain:f,unknown:v,clamp:T,nice:O}){const L=g0[o]();return f&&L.domain&&L.domain(f),v&&L.unknown(v),T!==void 0&&L.clamp&&L.clamp(T),O!==void 0&&L.nice&&L.nice(O),L}}class Dm{apply(o){o.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{o.animateStatus&&o.models.forEach(v=>{v.addUniforms((0,Cr.Z)({},o.layerModel.getAnimateUniforms()))})})}}class wv{apply(o){o.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:f,enableMask:v}=o.getLayerConfig();!o.tileLayer&&f&&f.length>0&&o.updateLayerConfig({mask:v})})}}class Nm{build(o){return(0,Ti.Z)(function*(){o.prepareBuildModel(),yield o.buildModels()})()}initLayerModel(o){var f=this;return(0,Ti.Z)(function*(){yield f.build(o),o.styleNeedUpdate=!1})()}prepareLayerModel(o){var f=this;return(0,Ti.Z)(function*(){yield f.build(o),o.styleNeedUpdate=!1})()}apply(o){var f=this;o.hooks.init.tapPromise("LayerModelPlugin",(0,Ti.Z)(function*(){if(o.getSource().isTile){o.prepareBuildModel();return}o.log(K.Or.BuildModelStart,K.KD.INIT),yield f.initLayerModel(o),o.log(K.Or.BuildModelEnd,K.KD.INIT)})),o.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var v=(0,Ti.Z)(function*(T){return!T||o.getSource().isTile?!1:(o.log(K.Or.BuildModelStart,K.KD.UPDATE),yield f.prepareLayerModel(o),o.log(K.Or.BuildModelEnd,K.KD.UPDATE),!0)});return function(T){return v.apply(this,arguments)}}())}}class Av{apply(o){o.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:f,fitBoundsOptions:v}=o.getLayerConfig();f&&o.fitBounds(v),o.styleNeedUpdate=!1})}}const Bm=["type"],Cv={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},jp={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Zl={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},ad={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function dg(a){const o={u_DirectionalLights:new Array(3).fill((0,Cr.Z)({},Zl)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,Cr.Z)({},ad)),u_NumOfSpotLights:0};return(!a||!a.length)&&(a=[jp]),a.forEach(f=>{let{type:v="directional"}=f,T=(0,ml.Z)(f,Bm);const O=Cv[v].lights,L=Cv[v].num,F=o[L];o[O][F]=(0,Cr.Z)((0,Cr.Z)({},o[O][F]),T),o[L]++}),o}class Cu{apply(o){o.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:f}=o.getLayerConfig();f&&o.models.forEach(v=>v.addUniforms((0,Cr.Z)({},dg())))})}}function Hf(a){return a.map(o=>(typeof o=="string"&&(o=[o,{}]),o))}function uh(a,o,f,v){const T=a.multiPassRenderer;return T.add(v("render")),Hf(o).forEach(O=>{const[L,F]=O;T.add(f(L),F)}),T.add(f("copy")),T}class Ov{constructor(){(0,Kt.Z)(this,"enabled",void 0)}apply(o,{rendererService:f,postProcessingPassFactory:v,normalPassFactory:T}){o.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:O,passes:L=[]}=o.getLayerConfig();this.enabled=!!O&&o.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(o.multiPassRenderer=uh(o,L,v,T),o.multiPassRenderer.setRenderFlag(!0))}),o.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:O,height:L}=f.getViewportSize();o.multiPassRenderer.resize(O,L)}})}}const ff={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function pg(a){switch(a){case"rotation":return{name:"Rotation",type:K.GC.Attribute,descriptor:{name:"a_Rotation",shaderLocation:ff.ROTATION,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{rotation:f=0}=o;return Array.isArray(f)?[f[0]]:[f]}}};case"stroke":return{name:"stroke",type:K.GC.Attribute,descriptor:{name:"a_Stroke",shaderLocation:ff.STROKE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:o=>{const{stroke:f=[1,1,1,1]}=o;return f}}};case"opacity":return{name:"opacity",type:K.GC.Attribute,descriptor:{name:"a_Opacity",shaderLocation:ff.OPACITY,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{opacity:f=1}=o;return[f]}}};case"offsets":return{name:"offsets",type:K.GC.Attribute,descriptor:{name:"a_Offsets",shaderLocation:ff.OFFSETS,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{offsets:f}=o;return f}}};default:return}}const{isNumber:Rv}=Pe.lodashUtil,Vp={NONE:0,ENCODE:1,HIGHLIGHT:2};class mg{constructor(){(0,Kt.Z)(this,"pickingUniformMap",void 0)}pickOption2Array(){const o=[];return this.pickingUniformMap.forEach(f=>{Rv(f)?o.push(f):o.push(...f)}),o}updatePickOption(o,f){Object.keys(o).forEach(L=>{this.pickingUniformMap.set(L,o[L])});const v=f.getLayerConfig().pickingBuffer||0,T=Number(f.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",v),this.pickingUniformMap.set("u_shaderPick",T),f.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(o,{styleAttributeService:f}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),o.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();f.registerStyleAttribute({name:"pickingColor",type:K.GC.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:ff.PICKING_COLOR,buffer:{data:[],type:K.gl.FLOAT},size:3,update:T=>{const{id:O}=T;return v?(0,Pe.Z6)(O):[0,0,0]}}})}),o.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();v&&o.isVisible()&&(this.updatePickOption({u_PickingStage:Vp.ENCODE},o),o.models.forEach(T=>T.addUniforms({u_PickingStage:Vp.ENCODE})))}),o.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:v}=o.getLayerConfig();v&&o.isVisible()&&(this.updatePickOption({u_PickingStage:Vp.HIGHLIGHT},o),o.models.forEach(T=>T.addUniforms({u_PickingStage:Vp.HIGHLIGHT})))}),o.hooks.beforeHighlight.tap("PixelPickingPlugin",v=>{const{highlightColor:T,activeMix:O=0}=o.getLayerConfig(),L=typeof T=="string"?(0,Pe.CI)(T):T||[1,0,0,1];o.updateLayerConfig({pickedFeatureID:(0,Pe.W0)(new Uint8Array(v))});const F={u_PickingStage:Vp.HIGHLIGHT,u_PickingColor:v,u_HighlightColor:L.map(H=>H*255),u_activeMix:O};this.updatePickOption(F,o),o.models.forEach(H=>H.addUniforms(F))}),o.hooks.beforeSelect.tap("PixelPickingPlugin",v=>{const{selectColor:T,selectMix:O=0}=o.getLayerConfig(),L=typeof T=="string"?(0,Pe.CI)(T):T||[1,0,0,1];o.updateLayerConfig({pickedFeatureID:(0,Pe.W0)(new Uint8Array(v))});const F={u_PickingStage:Vp.HIGHLIGHT,u_PickingColor:v,u_HighlightColor:L.map(H=>H*255),u_activeMix:O,u_CurrentSelectedId:v,u_SelectColor:L.map(H=>H*255)};this.updatePickOption(F,o),o.models.forEach(H=>H.addUniforms(F))})}}const vg=["mvt","geojsonvt","testTile"];function Cy(a){const o=a.getSource();return vg.includes(o.parser.type)}class y0{apply(o,{styleAttributeService:f}){o.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{Cy(o)||this.registerBuiltinAttributes(f,o)})}registerBuiltinAttributes(o,f){if(f.type==="MaskLayer"){this.registerPositionAttribute(o);return}this.registerPositionAttribute(o),this.registerColorAttribute(o)}registerPositionAttribute(o){o.registerStyleAttribute({name:"position",type:K.GC.Attribute,descriptor:{name:"a_Position",shaderLocation:ff.POSITION,buffer:{data:[],type:K.gl.FLOAT},size:3,update:(f,v,T)=>T.length===2?[T[0],T[1],0]:[T[0],T[1],T[2]]}})}registerColorAttribute(o){o.registerStyleAttribute({name:"color",type:K.GC.Attribute,descriptor:{name:"a_Color",shaderLocation:ff.COLOR,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:f=>{const{color:v}=f;return!v||!v.length?[1,1,1,1]:v}}})}}class N1{constructor(){(0,Kt.Z)(this,"cameraService",void 0),(0,Kt.Z)(this,"coordinateSystemService",void 0),(0,Kt.Z)(this,"rendererService",void 0),(0,Kt.Z)(this,"mapService",void 0),(0,Kt.Z)(this,"layerService",void 0)}apply(o,{rendererService:f,mapService:v,layerService:T,coordinateSystemService:O,cameraService:L}){this.rendererService=f,this.mapService=v,this.layerService=T,this.coordinateSystemService=O,this.cameraService=L;let F;this.rendererService.uniformBuffers[0]||(F=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=F),o.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const H=o.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(H);const{width:ie,height:xe}=this.rendererService.getViewportSize(),{data:Ee,uniforms:Ye}=this.generateUBO(ie,xe);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:Ee}),this.rendererService.queryVerdorInfo()==="WebGL1"&&o.models.forEach(an=>{an.addUniforms((0,Cr.Z)((0,Cr.Z)({},Ye),{},{u_PickingBuffer:o.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(o.getShaderPickStat())}))})})}generateUBO(o,f){const v=this.cameraService.getProjectionMatrix(),T=this.cameraService.getViewMatrix(),O=this.cameraService.getViewProjectionMatrix(),L=this.cameraService.getModelMatrix(),F=this.coordinateSystemService.getViewportCenterProjection(),H=this.coordinateSystemService.getPixelsPerDegree(),ie=this.cameraService.getZoom(),xe=this.coordinateSystemService.getPixelsPerDegree2(),Ee=this.cameraService.getZoomScale(),Ye=this.coordinateSystemService.getPixelsPerMeter(),Lt=this.coordinateSystemService.getCoordinateSystem(),an=this.cameraService.getCameraPosition(),Pn=window.devicePixelRatio,sr=this.coordinateSystemService.getViewportCenter(),Rr=[o,f],Tr=this.cameraService.getFocalDistance();return{data:[...T,...v,...O,...L,...F,...H,ie,...xe,Ee,...Ye,Lt,...an,Pn,...sr,...Rr,Tr,0,0,0],uniforms:{[K.lv.ProjectionMatrix]:v,[K.lv.ViewMatrix]:T,[K.lv.ViewProjectionMatrix]:O,[K.lv.Zoom]:ie,[K.lv.ZoomScale]:Ee,[K.lv.FocalDistance]:Tr,[K.lv.CameraPosition]:an,[K.kw.CoordinateSystem]:Lt,[K.kw.ViewportCenter]:sr,[K.kw.ViewportCenterProjection]:F,[K.kw.PixelsPerDegree]:H,[K.kw.PixelsPerDegree2]:xe,[K.kw.PixelsPerMeter]:Ye,u_ViewportSize:Rr,u_ModelMatrix:L,u_DevicePixelRatio:Pn}}}}class B1{apply(o){o.hooks.beforeRender.tap("UpdateModelPlugin",()=>{o.layerModel&&o.layerModel.needUpdate().then(f=>{f&&o.renderLayers()})}),o.hooks.afterRender.tap("UpdateModelPlugin",()=>{o.layerModelNeedUpdate=!1})}}class F1{apply(o,{styleAttributeService:f}){o.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(o,{styleAttributeService:f})}),o.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{o.layerModelNeedUpdate||o.inited&&this.updateStyleAttribute(o,{styleAttributeService:f})})}updateStyleAttribute(o,{styleAttributeService:f}){const v=f.getLayerStyleAttributes()||[],T=f.getLayerStyleAttribute("filter");if(T&&T.needRegenerateVertices){o.layerModelNeedUpdate=!0,v.forEach(O=>O.needRegenerateVertices=!1);return}v.filter(O=>O.needRegenerateVertices).forEach(O=>{f.updateAttributeByFeatureRange(O.name,o.getEncodedData(),O.featureRange.startIndex,O.featureRange.endIndex,o),O.needRegenerateVertices=!1})}initStyleAttribute(o,{styleAttributeService:f}){(f.getLayerStyleAttributes()||[]).filter(T=>T.needRegenerateVertices).forEach(T=>{f.updateAttributeByFeatureRange(T.name,o.getEncodedData(),T.featureRange.startIndex,T.featureRange.endIndex),T.needRegenerateVertices=!1})}}function gg(){return[new Kc,new y0,new Up,new Ll,new Av,new wv,new F1,new B1,new Ov,new N1,new Dm,new Cu,new mg,new Nm]}const Oy={[K.h0.additive]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE,srcAlpha:1,dstAlpha:1}},[K.h0.none]:{enable:!1},[K.h0.normal]:{enable:!0,func:{srcRGB:K.gl.SRC_ALPHA,dstRGB:K.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[K.h0.subtractive]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE,srcAlpha:K.gl.ZERO,dstAlpha:K.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:K.gl.FUNC_SUBTRACT,alpha:K.gl.FUNC_SUBTRACT}},[K.h0.max]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE},equation:{rgb:K.gl.MAX_EXT}},[K.h0.min]:{enable:!0,func:{srcRGB:K.gl.ONE,dstRGB:K.gl.ONE},equation:{rgb:K.gl.MIN_EXT}}};class fh{constructor(o){(0,Kt.Z)(this,"layer",void 0),this.layer=o}pickRender(o){const v=this.layer.getContainer().layerService,T=this.layer;if(T.tileLayer)return T.tileLayer.pickRender(o);T.hooks.beforePickingEncode.call(),v.renderTileLayerMask(T),T.renderModels({ispick:!0}),T.hooks.afterPickingEncode.call()}pick(o,f){var v=this;return(0,Ti.Z)(function*(){const O=v.layer.getContainer().pickingService;return o.type==="RasterLayer"?v.pickRasterLayer(o,f):(v.pickRender(f),O.pickFromPickingFBO(o,f))})()}pickRasterLayer(o,f,v){const T=this.layer.getContainer(),O=T.pickingService,L=T.mapService,F=this.layer.getSource().extent,H=(0,Pe.if)(f.lngLat,F),ie={x:f.x,y:f.y,type:f.type,lngLat:f.lngLat,target:f,rasterValue:null},xe=v||o;if(H){const Ee=this.readRasterValue(o,F,L,f.x,f.y);return ie.rasterValue=Ee,O.triggerHoverOnLayer(xe,ie),!0}else return ie.type=f.type==="mousemove"?"mouseout":"un"+f.type,O.triggerHoverOnLayer(xe,(0,Cr.Z)((0,Cr.Z)({},ie),{},{type:"unpick"})),O.triggerHoverOnLayer(xe,ie),!1}readRasterValue(o,f,v,T,O){const L=o.getSource().data.dataArray[0],[F=0,H=0,ie=10,xe=-10]=f,Ee=v.lngLatToContainer([F,H]),Ye=v.lngLatToContainer([ie,xe]),Lt=Ye.x-Ee.x,an=Ee.y-Ye.y,Pn=[(T-Ee.x)/Lt,(O-Ye.y)/an],sr=L.width||1,Rr=L.height||1,Tr=Math.floor(Pn[0]*sr),li=Math.floor(Pn[1]*Rr),Ui=Math.max(0,li-1)*sr+Tr;return L.data[Ui]}selectFeature(o){const f=this.layer,[v,T,O]=o;f.hooks.beforeSelect.call([v,T,O])}highlightPickedFeature(o){const[f,v,T]=o;this.layer.hooks.beforeHighlight.call([f,v,T])}getFeatureById(o){return this.layer.getSource().getFeatureById(o)}}class Mv{constructor(o){(0,Kt.Z)(this,"layer",void 0),(0,Kt.Z)(this,"rendererService",void 0),(0,Kt.Z)(this,"colorTexture",void 0),(0,Kt.Z)(this,"key",void 0),this.layer=o;const f=this.layer.getContainer();this.rendererService=f.rendererService}getColorTexture(o,f){const v=this.getTextureKey(o,f);return this.key===v?this.colorTexture:(this.createColorTexture(o,f),this.key=v,this.colorTexture)}createColorTexture(o,f){const{createTexture2D:v}=this.rendererService,T=this.getColorRampBar(o,f),O=v({data:new Uint8Array(T.data),width:T.width,height:T.height,flipY:!1,unorm:!0});return this.colorTexture=O,O}setColorTexture(o,f,v){this.key=this.getTextureKey(f,v),this.colorTexture=o}destroy(){var o;(o=this.colorTexture)===null||o===void 0||o.destroy()}getColorRampBar(o,f){switch(o.type){case"cat":return(0,Pe.hj)(o);case"quantize":return(0,Pe.NJ)(o);case"custom":return(0,Pe.Oc)(o,f);case"linear":return(0,Pe.M4)(o,f);default:return(0,Pe.Cl)(o)}}getTextureKey(o,f){var v;return`${o.colors.join("_")}_${o==null||(v=o.positions)===null||v===void 0?void 0:v.join("_")}_${o.type}_${f==null?void 0:f.join("_")}`}}const yg=["passes"],Ph=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:_g,isFunction:Ry,isNumber:_0,isObject:Vc,isPlainObject:Fm,isUndefined:km}=Pe.lodashUtil;let Y0=0;class $0 extends Fc.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var o;return(o=this.container)===null||o===void 0?void 0:o.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(o={}){super(),(0,Kt.Z)(this,"id",`${Y0++}`),(0,Kt.Z)(this,"name",`${Y0}`),(0,Kt.Z)(this,"parent",void 0),(0,Kt.Z)(this,"coordCenter",void 0),(0,Kt.Z)(this,"type",void 0),(0,Kt.Z)(this,"visible",!0),(0,Kt.Z)(this,"zIndex",0),(0,Kt.Z)(this,"minZoom",void 0),(0,Kt.Z)(this,"maxZoom",void 0),(0,Kt.Z)(this,"inited",!1),(0,Kt.Z)(this,"layerModelNeedUpdate",!1),(0,Kt.Z)(this,"pickedFeatureID",null),(0,Kt.Z)(this,"selectedFeatureID",null),(0,Kt.Z)(this,"styleNeedUpdate",!1),(0,Kt.Z)(this,"rendering",void 0),(0,Kt.Z)(this,"forceRender",!1),(0,Kt.Z)(this,"clusterZoom",0),(0,Kt.Z)(this,"layerType",void 0),(0,Kt.Z)(this,"triangulation",void 0),(0,Kt.Z)(this,"layerPickService",void 0),(0,Kt.Z)(this,"textureService",void 0),(0,Kt.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,Kt.Z)(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,Kt.Z)(this,"hooks",{init:new Ul.S$,afterInit:new Ul.oI,beforeRender:new Ul.oI,beforeRenderData:new Ul.bf,afterRender:new Ul.ni,beforePickingEncode:new Ul.ni,afterPickingEncode:new Ul.ni,beforeHighlight:new Ul.ni(["pickedColor"]),afterHighlight:new Ul.ni,beforeSelect:new Ul.ni(["pickedColor"]),afterSelect:new Ul.ni,beforeDestroy:new Ul.ni,afterDestroy:new Ul.ni}),(0,Kt.Z)(this,"models",[]),(0,Kt.Z)(this,"multiPassRenderer",void 0),(0,Kt.Z)(this,"plugins",void 0),(0,Kt.Z)(this,"startInit",!1),(0,Kt.Z)(this,"sourceOption",void 0),(0,Kt.Z)(this,"layerModel",void 0),(0,Kt.Z)(this,"shapeOption",void 0),(0,Kt.Z)(this,"tileLayer",void 0),(0,Kt.Z)(this,"layerChildren",[]),(0,Kt.Z)(this,"masks",[]),(0,Kt.Z)(this,"configService",K.cO),(0,Kt.Z)(this,"styleAttributeService",void 0),(0,Kt.Z)(this,"layerSource",void 0),(0,Kt.Z)(this,"postProcessingPassFactory",void 0),(0,Kt.Z)(this,"animateOptions",{enable:!1}),(0,Kt.Z)(this,"container",void 0),(0,Kt.Z)(this,"encodedData",void 0),(0,Kt.Z)(this,"currentPickId",null),(0,Kt.Z)(this,"rawConfig",void 0),(0,Kt.Z)(this,"needUpdateConfig",void 0),(0,Kt.Z)(this,"encodeStyleAttribute",{}),(0,Kt.Z)(this,"enableShaderEncodeStyles",[]),(0,Kt.Z)(this,"enableDataEncodeStyles",[]),(0,Kt.Z)(this,"pendingStyleAttributes",[]),(0,Kt.Z)(this,"scaleOptions",{}),(0,Kt.Z)(this,"animateStartTime",void 0),(0,Kt.Z)(this,"animateStatus",!1),(0,Kt.Z)(this,"isDestroyed",!1),(0,Kt.Z)(this,"uniformBuffers",[]),(0,Kt.Z)(this,"encodeDataLength",0),(0,Kt.Z)(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;const f=this.getLayerConfig();f&&f.autoFit&&this.fitBounds(f.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=o.name||this.id,this.zIndex=o.zIndex||0,this.rawConfig=o,this.masks=o.maskLayers||[]}addMask(o){this.masks.push(o),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(o){const f=this.masks.indexOf(o);f>-1&&this.masks.splice(f,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(o){this.masks.push(o)}removeMaskLayer(o){const f=this.masks.indexOf(o);f>-1&&this.masks.splice(f,1),o.destroy()}getAttribute(o){return this.styleAttributeService.getLayerStyleAttribute(o)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(o){if(Object.keys(o).map(f=>{f in this.rawConfig&&(this.rawConfig[f]=o[f])}),!this.startInit)this.needUpdateConfig=(0,Cr.Z)((0,Cr.Z)({},this.needUpdateConfig),o);else{const f=this.container.id;this.configService.setLayerConfig(f,this.id,(0,Cr.Z)((0,Cr.Z)((0,Cr.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),o)),this.needUpdateConfig={}}}setContainer(o){this.container=o}getContainer(){return this.container}addPlugin(o){return this.plugins.push(o),this}init(){var o=this;return(0,Ti.Z)(function*(){const f=o.container.id;o.startInit=!0,o.configService.setLayerConfig(f,o.id,o.rawConfig),o.layerType=o.rawConfig.layerType;const{enableMultiPassRenderer:v,passes:T}=o.getLayerConfig();v&&T!==null&&T!==void 0&&T.length&&T.length>0&&o.mapService.on("mapAfterFrameChange",()=>{o.renderLayers()}),o.postProcessingPassFactory=o.container.postProcessingPassFactory,o.styleAttributeService=o.container.styleAttributeService,v&&(o.multiPassRenderer=o.container.multiPassRenderer,o.multiPassRenderer.setLayer(o)),o.pendingStyleAttributes.forEach(({attributeName:O,attributeField:L,attributeValues:F,updateOptions:H})=>{o.styleAttributeService.updateStyleAttribute(O,{scale:(0,Cr.Z)({field:L},o.splitValuesAndCallbackInAttribute(F,L?void 0:o.getLayerConfig()[O]))},H)}),o.pendingStyleAttributes=[],o.plugins=gg();for(const O of o.plugins)O.apply(o,o.container);o.layerPickService=new fh(o),o.textureService=new Mv(o),o.log(K.Or.LayerInitStart),yield o.hooks.init.promise(),o.log(K.Or.LayerInitEnd),o.inited=!0,o.emit("inited",{target:o,type:"inited"}),o.emit("add",{target:o,type:"add"}),o.hooks.afterInit.call()})()}log(o,f="init"){var v;if(this.tileLayer||this.isTileLayer)return;const T=`${this.id}.${f}.${o}`,O={id:this.id,type:this.type};(v=this.debugService)===null||v===void 0||v.log(T,O)}updateModelData(o){o.attributes&&o.elements?this.models.map(f=>{f.updateAttributesAndElements(o.attributes,o.elements)}):console.warn("data error")}setLayerPickService(o){this.layerPickService=o}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:o}=this.getLayerConfig();o!=null&&o.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(o,f,v){return this.updateStyleAttribute("color",o,f,v),this}texture(o,f,v){return this.updateStyleAttribute("texture",o,f,v),this}rotate(o,f,v){return this.updateStyleAttribute("rotate",o,f,v),this}size(o,f,v){return this.updateStyleAttribute("size",o,f,v),this}filter(o,f,v){const T=this.updateStyleAttribute("filter",o,f,v);return this.dataState.dataSourceNeedUpdate=T&&this.inited,this}shape(o,f,v){this.shapeOption={field:o,values:f};const T=this.updateStyleAttribute("shape",o,f,v);return this.dataState.dataSourceNeedUpdate=T&&this.inited,this}label(o,f,v){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:o,attributeValues:f,updateOptions:v}),this}animate(o){let f={};return Vc(o)?(f.enable=!0,f=(0,Cr.Z)((0,Cr.Z)({},f),o)):f.enable=o,this.updateLayerConfig({animateOption:f}),this}source(o,f){return(o==null?void 0:o.type)==="source"?(this.setSource(o),this):(this.sourceOption={data:o,options:f},this.clusterZoom=0,this)}setData(o,f){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(o,f)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(o,f)}),this}dataUpdatelog(){this.log(K.Or.SourceInitStart,K.KD.UPDATE),this.layerSource.once("update",()=>{this.log(K.Or.SourceInitEnd,K.KD.UPDATE)})}style(o){const{passes:f}=o,v=(0,ml.Z)(o,yg);f&&Hf(f).forEach(O=>{const L=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(O[0]);L&&L.updateOptions(O[1])}),v.borderColor&&(v.stroke=v.borderColor),v.borderWidth&&(v.strokeWidth=v.borderWidth);const T=v;return Object.keys(v).forEach(O=>{const L=v[O];Array.isArray(L)&&L.length===2&&!_0(L[0])&&!_0(L[1])&&(T[O]={field:L[0],value:L[1]})}),this.encodeStyle(T),this.updateLayerConfig(T),this}encodeStyle(o){Object.keys(o).forEach(f=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(f)&&Fm(o[f])&&(o[f].field||o[f].value)&&!_g(this.encodeStyleAttribute[f],o[f])?(this.encodeStyleAttribute[f]=o[f],this.updateStyleAttribute(f,o[f].field,o[f].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[f]&&(delete this.encodeStyleAttribute[f],this.dataState.dataSourceNeedUpdate=!0)})}scale(o,f){const v=(0,Cr.Z)({},this.scaleOptions);if(Vc(o)?this.scaleOptions=(0,Cr.Z)((0,Cr.Z)({},this.scaleOptions),o):this.scaleOptions[o]=f,this.styleAttributeService&&!_g(v,this.scaleOptions)){const T=Vc(o)?o:{[o]:f};this.styleAttributeService.updateScaleAttribute(T)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(o={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(o),this))}renderMultiPass(){var o=this;return(0,Ti.Z)(function*(){o.encodeDataLength<=0&&!o.forceRender||(o.multiPassRenderer&&o.multiPassRenderer.getRenderFlag()?yield o.multiPassRenderer.render():o.renderModels())})()}active(o){const f={};return f.enableHighlight=Vc(o)?!0:o,Vc(o)?(f.enableHighlight=!0,o.color&&(f.highlightColor=o.color),o.mix&&(f.activeMix=o.mix)):f.enableHighlight=!!o,this.updateLayerConfig(f),this}setActive(o,f){if(Vc(o)){const{x:v=0,y:T=0}=o;this.updateLayerConfig({highlightColor:Vc(f)?f.color:this.getLayerConfig().highlightColor,activeMix:Vc(f)?f.mix:this.getLayerConfig().activeMix}),this.pick({x:v,y:T})}else this.updateLayerConfig({pickedFeatureID:o,highlightColor:Vc(f)?f.color:this.getLayerConfig().highlightColor,activeMix:Vc(f)?f.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,Pe.Z6)(o)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(o){const f={};return f.enableSelect=Vc(o)?!0:o,Vc(o)?(f.enableSelect=!0,o.color&&(f.selectColor=o.color),o.mix&&(f.selectMix=o.mix)):f.enableSelect=!!o,this.updateLayerConfig(f),this}setSelect(o,f){if(Vc(o)){const{x:v=0,y:T=0}=o;this.updateLayerConfig({selectColor:Vc(f)?f.color:this.getLayerConfig().selectColor,selectMix:Vc(f)?f.mix:this.getLayerConfig().selectMix}),this.pick({x:v,y:T})}else this.updateLayerConfig({pickedFeatureID:o,selectColor:Vc(f)?f.color:this.getLayerConfig().selectColor,selectMix:Vc(f)?f.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,Pe.Z6)(o)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(o){return this.updateLayerConfig({blend:o}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(o){return this.zIndex=o,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(o){this.currentPickId=o}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(o){this.selectedFeatureID=o}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const o=this.mapService.getZoom(),{visible:f,minZoom:v=-1/0,maxZoom:T=1/0}=this.getLayerConfig();return!!f&&o>=v&&o<T}setMultiPass(o,f){if(this.updateLayerConfig({enableMultiPassRenderer:o}),f&&this.updateLayerConfig({passes:f}),o){const{passes:v=[]}=this.getLayerConfig();this.multiPassRenderer=uh(this,v,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:T,height:O}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(T,O)}return this}setMinZoom(o){return this.updateLayerConfig({minZoom:o}),this}getMinZoom(){const{minZoom:o}=this.getLayerConfig();return o}getMaxZoom(){const{maxZoom:o}=this.getLayerConfig();return o}get(o){return this.getLayerConfig()[o]}setMaxZoom(o){return this.updateLayerConfig({maxZoom:o}),this}setAutoFit(o){return this.updateLayerConfig({autoFit:o}),this}fitBounds(o){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const v=this.getSource().extent;return v.some(O=>Math.abs(O)===1/0)?this:(this.mapService.fitBounds([[v[0],v[1]],[v[2],v[3]]],o),this)}destroy(o=!0){var f,v,T,O,L;if(this.isDestroyed)return;(f=this.layerModel)===null||f===void 0||f.uniformBuffers.forEach(H=>{H.destroy()}),this.layerChildren.map(H=>H.destroy(!1)),this.layerChildren=[];const{maskfence:F}=this.getLayerConfig();F&&(this.masks.map(H=>H.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(v=this.multiPassRenderer)===null||v===void 0||v.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(T=this.layerModel)===null||T===void 0||T.clearModels(o),(O=this.tileLayer)===null||O===void 0||O.destroy(),this.models=[],(L=this.debugService)===null||L===void 0||L.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var o;this.models.forEach(f=>f.destroy()),(o=this.layerModel)===null||o===void 0||o.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(o=>o.needRescale||o.needRemapping||o.needRegenerateVertices).length}setSource(o){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=o,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const f=this.mapService.getZoom();this.layerSource.updateClusterData(f)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:f})=>{if(this.coordCenter===void 0){const v=this.layerSource.center;this.coordCenter=v}if(f==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(o){this.encodedData=o,this.encodeDataLength=o.length}getEncodedData(){return this.encodedData}getScale(o){return this.styleAttributeService.getLayerAttributeScale(o)}getLegend(o){var f,v,T;const O=this.styleAttributeService.getLayerStyleAttribute(o);return{type:(v=((O==null||(f=O.scale)===null||f===void 0?void 0:f.scalers)||[])[0])===null||v===void 0||(v=v.option)===null||v===void 0?void 0:v.type,field:O==null||(T=O.scale)===null||T===void 0?void 0:T.field,items:this.getLegendItems(o)}}getLegendItems(o){const f=this.styleAttributeService.getLayerAttributeScale(o);return f?f.invertExtent?f.range().map(T=>({value:f.invertExtent(T),[o]:T})):f.ticks?f.ticks().map(T=>({value:T,[o]:f(T)})):f!=null&&f.domain?f.domain().filter(T=>!km(T)).map(T=>({value:T,[o]:f(T)})):[]:[]}pick({x:o,y:f}){this.interactionService.triggerHover({x:o,y:f})}boxSelect(o,f){this.pickingService.boxPickLayer(this,o,f)}buildLayerModel(o){var f=this;return(0,Ti.Z)(function*(){const{moduleName:v,vertexShader:T,fragmentShader:O,defines:L,inject:F,triangulation:H,styleOption:ie,pickingEnabled:xe=!0}=o,Ee=(0,ml.Z)(o,Ph);f.shaderModuleService.registerModule(v,{vs:T,fs:O,defines:L,inject:F});const{vs:Ye,fs:Lt,uniforms:an}=f.shaderModuleService.getModule(v),{createModel:Pn}=f.rendererService;return new Promise(sr=>{const{attributes:Rr,elements:Tr,count:li}=f.styleAttributeService.createAttributesAndIndices(f.encodedData,H,ie,f),Ui=[...f.layerModel.uniformBuffers,...f.rendererService.uniformBuffers];xe&&Ui.push(f.getPickingUniformBuffer());const Lo=(0,Cr.Z)({attributes:Rr,uniforms:an,fs:Lt,vs:Ye,elements:Tr,blend:Oy[K.h0.normal],uniformBuffers:Ui,textures:f.layerModel.textures},Ee);li&&(Lo.count=li);const eo=Pn(Lo);sr(eo)})})()}createAttributes(o){const{triangulation:f}=o,{attributes:v}=this.styleAttributeService.createAttributes(this.encodedData,f);return v}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(o){const{enableHighlight:f=!0,enableSelect:v=!0}=this.getLayerConfig();let T=this.eventNames().indexOf(o)!==-1||this.eventNames().indexOf("un"+o)!==-1;return(o==="click"||o==="dblclick")&&v&&(T=!0),o==="mousemove"&&(f||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(T=!0),this.isVisible()&&T}buildModels(){return(0,Ti.Z)(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var o=this;return(0,Ti.Z)(function*(){yield o.buildModels()})()}renderMulPass(o){return(0,Ti.Z)(function*(){yield o.render()})()}renderModels(o={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(f=>{f.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(o),textures:this.layerModel.textures},(o==null?void 0:o.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(o,f,v,T){const O=this.configService.getAttributeConfig(this.id)||{};return _g(O[o],{field:f,values:v})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(o)!==-1&&this.configService.setAttributeConfig(this.id,{[o]:{field:f,values:v}}),this.startInit?this.styleAttributeService.updateStyleAttribute(o,{scale:(0,Cr.Z)({field:f},this.splitValuesAndCallbackInAttribute(v,this.getLayerConfig()[f]))},T):this.pendingStyleAttributes.push({attributeName:o,attributeField:f,attributeValues:v,updateOptions:T}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(o){console.warn("empty fn")}processData(o){return o}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var o=this;return(0,Ti.Z)(function*(){o.models.forEach(v=>v.destroy()),o.models=[],o.uniformBuffers.forEach(v=>{v.destroy()}),o.uniformBuffers=[];const f=o.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});o.uniformBuffers.push(f),o.models=yield o.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(o){return{values:Ry(o)?void 0:o,callback:Ry(o)?o:void 0}}}function k1(a,o){return{enable:a,mask:255,func:{cmp:K.gl.EQUAL,ref:o?1:0,mask:1}}}function bg(a){return a.maskOperation===K.lE.OR?{enable:!0,mask:255,func:{cmp:K.gl.ALWAYS,ref:1,mask:255},opFront:{fail:K.gl.KEEP,zfail:K.gl.REPLACE,zpass:K.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:a.stencilType===K.yn.SINGLE||a.stencilIndex===0?K.gl.ALWAYS:K.gl.LESS,ref:a.stencilType===K.yn.SINGLE?1:a.stencilIndex===0?2:1,mask:255},opFront:{fail:K.gl.KEEP,zfail:K.gl.REPLACE,zpass:K.gl.REPLACE}}}const z1={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},zm={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var xg=D(9187),Ih=D.n(xg);function Eg(a){return Math.max(Math.ceil(a/4)*4,4)}function Sg(a,o,f,v=!0){const T=f===3;if(v){a=a.slice();const L=[];for(let F=0;F<a.length;F+=f){L[0]=a[F],L[1]=a[F+1],T&&(L[2]=a[F+2]);const H=(0,Pe.vP)(L,!0,{enable:!1,decimal:1});a[F]=H[0],a[F+1]=H[1],T&&(a[F+2]=H[2])}}return Ih()(a,o,f)}const Tg="ATTRIBUTE_LOCATION_";class Cl{get attributeLocation(){return(0,Cr.Z)({},ff)}constructor(o){(0,Kt.Z)(this,"triangulation",void 0),(0,Kt.Z)(this,"uniformBuffers",[]),(0,Kt.Z)(this,"textures",[]),(0,Kt.Z)(this,"createTexture2D",void 0),(0,Kt.Z)(this,"preStyleAttribute",{}),(0,Kt.Z)(this,"encodeStyleAttribute",{}),(0,Kt.Z)(this,"layer",void 0),(0,Kt.Z)(this,"dataTexture",void 0),(0,Kt.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,Kt.Z)(this,"dataTextureTest",void 0),(0,Kt.Z)(this,"configService",void 0),(0,Kt.Z)(this,"shaderModuleService",void 0),(0,Kt.Z)(this,"rendererService",void 0),(0,Kt.Z)(this,"iconService",void 0),(0,Kt.Z)(this,"fontService",void 0),(0,Kt.Z)(this,"styleAttributeService",void 0),(0,Kt.Z)(this,"mapService",void 0),(0,Kt.Z)(this,"cameraService",void 0),(0,Kt.Z)(this,"layerService",void 0),(0,Kt.Z)(this,"pickingService",void 0),(0,Kt.Z)(this,"attributeUnifoms",void 0),(0,Kt.Z)(this,"commonUnifoms",void 0),this.layer=o,this.configService=o.getContainer().globalConfigService,this.rendererService=o.getContainer().rendererService,this.pickingService=o.getContainer().pickingService,this.shaderModuleService=o.getContainer().shaderModuleService,this.styleAttributeService=o.getContainer().styleAttributeService,this.mapService=o.getContainer().mapService,this.iconService=o.getContainer().iconService,this.fontService=o.getContainer().fontService,this.cameraService=o.getContainer().cameraService,this.layerService=o.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:f}=this.rendererService;this.createTexture2D=f}getBlend(){const{blend:o="normal"}=this.layer.getLayerConfig();return Oy[K.h0[o]]}getStencil(o){const{mask:f=!1,maskInside:v=!0,enableMask:T,maskOperation:O=K.lE.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return bg({isStencil:!0,stencilType:K.yn.SINGLE});if(o.isStencil)return bg((0,Cr.Z)((0,Cr.Z)({},o),{},{maskOperation:O}));const L=f||T&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return k1(L,v)}getDefaultStyle(){return{}}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const v=(0,Cr.Z)((0,Cr.Z)({},f.uniformsOption),o.uniformsOption);return Object.keys(v).forEach(T=>{typeof v[T]=="boolean"&&(v[T]=v[T]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(v.u_texture=this.textures[0]),v}getAnimateUniforms(){return{}}needUpdate(){return(0,Ti.Z)(function*(){return!1})()}buildModels(){return(0,Ti.Z)(function*(){throw new Error("Method not implemented.")})()}initModels(){return(0,Ti.Z)(function*(){throw new Error("Method not implemented.")})()}clearModels(o=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(o){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(o){return[o.enable?0:1,o.duration||4,o.interval||.2,o.trailLength||.1]}startModelAnimate(){const{animateOption:o}=this.layer.getLayerConfig();o.enable&&this.layer.setAnimateStartTime()}getInject(){return My(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const o=Object.keys(this.attributeLocation).reduce((f,v)=>{const T=Tg+v;return f[T]=this.attributeLocation[v],f},{});return(0,Cr.Z)({},o)}getStyleAttribute(){const o={};return this.layer.enableShaderEncodeStyles.forEach(f=>{if(!this.layer.encodeStyleAttribute[f]){const v=this.layer.getLayerConfig()[f];let T=typeof v=="undefined"?z1[f]:v;f==="stroke"&&(T=(0,Pe.CI)(T)),o["u_"+f]=T}}),o}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(o=>{const f=pg(o);f&&this.styleAttributeService.registerStyleAttribute(f)})}registerPosition64LowAttribute(o=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:K.GC.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:K.gl.FLOAT},size:2,update:(f,v,T)=>o?[(0,Pe.Ks)(T[0]),(0,Pe.Ks)(T[1])]:[0,0]}})}updateEncodeAttribute(o,f){this.encodeStyleAttribute[o]=f}initUniformsBuffer(){const o=this.getUniformsBufferInfo(this.getStyleAttribute()),f=this.getCommonUniformsInfo();o.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(Eg(o.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),f.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(Eg(f.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(o){let f=0;const v=[];return Object.values(o).forEach(T=>{Array.isArray(T)?(v.push(...T),f+=T.length):typeof T=="number"?(v.push(T),f+=1):typeof T=="boolean"&&(v.push(Number(T)),f+=1)}),{uniformsOption:o,uniformsLength:f,uniformsArray:v}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var o,f;const{uniformsArray:v}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:T}=this.getCommonUniformsInfo();(o=this.attributeUnifoms)===null||o===void 0||o.subData({offset:0,data:new Uint8Array(new Float32Array(v).buffer)}),(f=this.commonUnifoms)===null||f===void 0||f.subData({offset:0,data:new Uint8Array(new Float32Array(T).buffer)})}}function My(a,o){const f=[];let v="";a.forEach(L=>{const F=L.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),H=Tg+F;o[L]?v+=`#define USE_ATTRIBUTE_${F} 0.0 
`:f.push(`  ${zm[L]} u_${L};`),v+=`
#ifdef USE_ATTRIBUTE_${F}
layout(location = ${H}) in ${zm[L]} a_${L.charAt(0).toUpperCase()+L.slice(1)};
#endif 
`});const T=f.length?`
layout(std140) uniform AttributeUniforms {
  ${f.join(`
`)}
};
`:"";v+=T;let O="";return a.forEach(L=>{const F=L.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();O+=`
  #ifdef USE_ATTRIBUTE_${F}
    ${zm[L]} ${L} = a_${L.charAt(0).toUpperCase()+L.slice(1)};
  #else
    ${zm[L]} ${L} = u_${L};
  #endif
  `}),{"vs:#decl":v,"fs:#decl":T,"vs:#main-start":O}}const Py=100,Tb=36,U1=40;function Iy(a){return a/180*Math.acos(-1)}function Um(a){const o=Iy(a[0])+Math.PI/2,f=Iy(a[1]),v=Py+Math.random()*.4,T=v*Math.cos(f)*Math.cos(o),O=v*Math.cos(f)*Math.sin(o),L=v*Math.sin(f);return[O,L,T]}function j1(a,o){const f=mat4.create(),v=mat4.create(),T=vec3.fromValues(0,1,0),O=vec3.fromValues(0,0,0);o=o||{},a=typeof a!="undefined"?a:1;const F=2+(typeof o.segments!="undefined"?o.segments:32),H=2*F,ie=[],xe=[],Ee=[],Ye=[],Lt=[],an=[];for(let Pn=0;Pn<=F;Pn++){const sr=Pn/F,Rr=sr*Math.PI;for(let Tr=0;Tr<=H;Tr++){const li=Tr/H,Ui=li*Math.PI*2;mat4.identity(v),mat4.rotateZ(v,v,-Rr),mat4.identity(f),mat4.rotateY(f,f,Ui),vec3.transformMat4(O,T,v),vec3.transformMat4(O,O,f),vec3.scale(O,O,-a),Ee.push(O.slice()),Ye.push(...O.slice()),vec3.normalize(O,O),Lt.push(...O.slice()),an.push([li,1-sr]),Ye.push(li,1-sr)}if(Pn>0){const Tr=Ee.length;let li=Tr-2*(H+1);for(;li+H+2<Tr;li++)ie.push([li,li+1,li+H+1]),xe.push(li,li+1,li+H+1),ie.push([li+H+1,li+1,li+H+2]),xe.push(li+H+1,li+1,li+H+2)}}return{cells:ie,positions:Ee,uvs:an,positionsArr:Ye,indicesArr:xe,normalArr:Lt}}var Ts=D(31437);const V1=Ts.Ue(),wb=Ts.Ue(),sd=Ts.Ue(),Pv=Ts.Ue(),wg=Ts.Ue();function H1(a,o,f,v,T){Ts.IH(a,f,v),Ts.Fv(a,a),o=Ts.al(-a[1],a[0]);const O=Ts.al(-f[1],f[0]);return[T/Ts.AK(o,O),o]}function Iv(a,o){return Ts.t8(a,-o[1],o[0])}function Ag(a,o,f){return Ts.lu(a,o,f),Ts.Fv(a,a),a}function Z1(a,o){return a[0]===o[0]&&a[1]===o[1]}function F2(a){const o=new Map;for(let f=0;f<a.length;f++){const v=a[0].toString()+"-"+a[1].toString();o.get(v)?(a.splice(f,1),f++):o.set(v,v)}return a}class cp{constructor(o={}){(0,Kt.Z)(this,"complex",void 0),(0,Kt.Z)(this,"join",void 0),(0,Kt.Z)(this,"cap",void 0),(0,Kt.Z)(this,"miterLimit",void 0),(0,Kt.Z)(this,"thickness",void 0),(0,Kt.Z)(this,"normal",void 0),(0,Kt.Z)(this,"lastFlip",-1),(0,Kt.Z)(this,"miter",Ts.al(0,0)),(0,Kt.Z)(this,"started",!1),(0,Kt.Z)(this,"dash",!1),(0,Kt.Z)(this,"totalDistance",0),(0,Kt.Z)(this,"currentIndex",0),this.join=o.join||"miter",this.cap=o.cap||"butt",this.miterLimit=o.miterLimit||10,this.thickness=o.thickness||1,this.dash=o.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(o){const f=this.complex;if(o.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const v=o.length;let T=f.startIndex;for(let O=1;O<v;O++){const L=o[O-1],F=o[O],H=O<o.length-1?o[O+1]:null,ie=this.simpleSegment(f,T,L,F,H);T+=ie}if(this.dash)for(let O=0;O<f.positions.length/6;O++)f.positions[O*6+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}extrude(o){const f=this.complex;if(o.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const v=o.length;let T=f.startIndex;for(let O=1;O<v;O++){const L=o[O-1],F=o[O],H=O<o.length-1?o[O+1]:null,ie=this.segment(f,T,L,F,H);T+=ie}if(this.dash)for(let O=0;O<f.positions.length/6;O++)f.positions[O*6+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}simpleSegment(o,f,v,T,O){let L=0;const F=o.indices,H=o.positions,ie=o.normals,xe=(0,Pe.Z)([T[0],T[1]]),Ee=(0,Pe.Z)([v[0],v[1]]);Ag(sd,xe,Ee);let Ye=0;if(this.dash&&(Ye=this.lineSegmentDistance(xe,Ee),this.totalDistance+=Ye),this.normal||(this.normal=Ts.Ue(),Iv(this.normal,sd)),this.started||(this.started=!0,this.extrusions(H,ie,v,this.normal,this.thickness,this.totalDistance-Ye)),F.push(f+0,f+1,f+2),!O)Iv(this.normal,sd),this.extrusions(H,ie,T,this.normal,this.thickness,this.totalDistance),F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),L+=2;else{const Lt=(0,Pe.Z)([O[0],O[1]]);Z1(xe,Lt)&&Ts.IH(Lt,xe,Ts.Fv(Lt,Ts.$X(Lt,xe,Ee))),Ag(Pv,Lt,xe);const[an,Pn]=H1(wg,Ts.Ue(),sd,Pv,this.thickness);let sr=Ts.AK(wg,this.normal)<0?-1:1;this.extrusions(H,ie,T,Pn,an,this.totalDistance),F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),sr=-1,Ts.JG(this.normal,Pn),L+=2,this.lastFlip=sr}return L}segment(o,f,v,T,O){let L=0;const F=o.indices,H=o.positions,ie=o.normals,xe=this.cap==="square",Ee=this.join==="bevel",Ye=(0,Pe.Z)([T[0],T[1]]),Lt=(0,Pe.Z)([v[0],v[1]]);Ag(sd,Ye,Lt);let an=0;if(this.dash&&(an=this.lineSegmentDistance(Ye,Lt),this.totalDistance+=an),this.normal||(this.normal=Ts.Ue(),Iv(this.normal,sd)),!this.started)if(this.started=!0,xe){const Pn=Ts.Ue(),sr=Ts.Ue();Ts.IH(Pn,this.normal,sd),Ts.IH(sr,this.normal,sd),ie.push(sr[0],sr[1],0),ie.push(Pn[0],Pn[1],0),H.push(v[0],v[1],v[2]|0,this.totalDistance-an,-this.thickness,v[2]|0),this.complex.indexes.push(this.currentIndex),H.push(v[0],v[1],v[2]|0,this.totalDistance-an,this.thickness,v[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(H,ie,v,this.normal,this.thickness,this.totalDistance-an);if(F.push(f+0,f+1,f+2),O){const Pn=(0,Pe.Z)([O[0],O[1]]);Z1(Ye,Pn)&&Ts.IH(Pn,Ye,Ts.Fv(Pn,Ts.$X(Pn,Ye,Lt))),Ag(Pv,Pn,Ye);const[sr,Rr]=H1(wg,Ts.Ue(),sd,Pv,this.thickness);let Tr=Ts.AK(wg,this.normal)<0?-1:1,li=Ee;!li&&this.join==="miter"&&sr>this.miterLimit&&(li=!0),li?(ie.push(this.normal[0],this.normal[1],0),ie.push(Rr[0],Rr[1],0),H.push(T[0],T[1],T[2]|0,this.totalDistance,-this.thickness*Tr,T[2]|0),this.complex.indexes.push(this.currentIndex),H.push(T[0],T[1],T[2]|0,this.totalDistance,this.thickness*Tr,T[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,F.push(...this.lastFlip!==-Tr?[f,f+2,f+3]:[f+2,f+1,f+3]),F.push(f+2,f+3,f+4),Iv(V1,Pv),Ts.JG(this.normal,V1),ie.push(this.normal[0],this.normal[1],0),H.push(T[0],T[1],T[2]|0,this.totalDistance,-this.thickness*Tr,T[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,L+=3):(this.extrusions(H,ie,T,Rr,sr,this.totalDistance),F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),Tr=-1,Ts.JG(this.normal,Rr),L+=2),this.lastFlip=Tr}else{if(Iv(this.normal,sd),xe){const Pn=Ts.Ue(),sr=Ts.Ue();Ts.lu(sr,sd,this.normal),Ts.IH(Pn,sd,this.normal),ie.push(sr[0],sr[1],0),ie.push(Pn[0],Pn[1],0),H.push(T[0],T[1],T[2]|0,this.totalDistance,this.thickness,T[2]|0),this.complex.indexes.push(this.currentIndex),H.push(T[0],T[1],T[2]|0,this.totalDistance,this.thickness,T[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(H,ie,T,this.normal,this.thickness,this.totalDistance);F.push(...this.lastFlip===1?[f,f+2,f+3]:[f+2,f+1,f+3]),L+=2}return L}extrusions(o,f,v,T,O,L){f.push(T[0],T[1],0),f.push(T[0],T[1],0),o.push(v[0],v[1],v[2]|0,L,-O,v[2]|0),this.complex.indexes.push(this.currentIndex),o.push(v[0],v[1],v[2]|0,L,O,v[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(o,f){const v=f[0]-o[0],T=f[1]-o[1];return Math.sqrt(v*v+T*T)}}let b0=function(a){return a.CYLINDER="cylinder",a.SQUARECOLUMN="squareColumn",a.TRIANGLECOLUMN="triangleColumn",a.HEXAGONCOLUMN="hexagonColumn",a.PENTAGONCOLUMN="pentagonColumn",a}({}),jm=function(a){return a.CIRCLE="circle",a.SQUARE="square",a.TRIANGLE="triangle",a.HEXAGON="hexagon",a.PENTAGON="pentagon",a}({});function Hp(a,o=0){const f=Math.PI*2/a,v=[];for(let O=0;O<a;O++)v.push(f*O+o*Math.PI/12);return v.map(O=>{const L=Math.sin(O+Math.PI/4),F=Math.cos(O+Math.PI/4);return[L,F,0]})}function K0(){return Hp(30)}function k2(){return Hp(4)}function Vm(){return Hp(3)}function z2(){return Hp(6,1)}function Ly(){return Hp(5)}const x0={[jm.CIRCLE]:K0,[jm.HEXAGON]:z2,[jm.TRIANGLE]:Vm,[jm.SQUARE]:k2,[jm.PENTAGON]:Ly,[b0.CYLINDER]:K0,[b0.HEXAGONCOLUMN]:z2,[b0.TRIANGLECOLUMN]:Vm,[b0.SQUARECOLUMN]:k2,[b0.PENTAGONCOLUMN]:Ly};var Jl=D(77160);function WM(a){const o=a[0][0],f=a[0][a[0].length-1];o[0]===f[0]&&o[1]===f[1]&&(a[0]=a[0].slice(0,a[0].length-1));const v=a[0].length,T=earcut.flatten(a),{vertices:O,dimensions:L}=T,F=[],H=[];for(let xe=0;xe<O.length/L;xe++)L===2?F.push(O[xe*2],O[xe*2+1],1):F.push(O[xe*3],O[xe*3+1],1);const ie=earcut(T.vertices,T.holes,T.dimensions);H.push(...ie);for(let xe=0;xe<v;xe++){const Ee=T.vertices.slice(xe*L,(xe+1)*L);let Ye=T.vertices.slice((xe+1)*L,(xe+2)*L);Ye.length===0&&(Ye=T.vertices.slice(0,L));const Lt=F.length/3;F.push(Ee[0],Ee[1],1,Ye[0],Ye[1],1,Ee[0],Ee[1],0,Ye[0],Ye[1],0),H.push(...[0,2,1,2,3,1].map(an=>an+Lt))}return{positions:F,index:H}}function U2(a){const o=earcut.flatten(a),f=earcut(o.vertices,o.holes,o.dimensions);return{positions:o.vertices,index:f}}function j2(a,o=!1){const f=a[0][0],v=a[0][a[0].length-1];f[0]===v[0]&&f[1]===v[1]&&(a[0]=a[0].slice(0,a[0].length-1));const T=a[0].length,O=Ih().flatten(a),{vertices:L,dimensions:F,holes:H}=O,ie=[],xe=[],Ee=[];for(let Lt=0;Lt<L.length/F;Lt++)ie.push(L[Lt*F],L[Lt*F+1],1,-1,-1),Ee.push(0,0,1);const Ye=Sg(L,H,F,o);xe.push(...Ye);for(let Lt=0;Lt<T;Lt++){const an=O.vertices.slice(Lt*F,(Lt+1)*F);let Pn=O.vertices.slice((Lt+1)*F,(Lt+2)*F);Pn.length===0&&(Pn=O.vertices.slice(0,F));const sr=ie.length/5;ie.push(an[0],an[1],1,0,0,Pn[0],Pn[1],1,.1,0,an[0],an[1],0,0,.8,Pn[0],Pn[1],0,.1,.8);const Rr=V2([Pn[0],Pn[1],1],[an[0],an[1],0],[an[0],an[1],1],o);Ee.push(...Rr,...Rr,...Rr,...Rr),xe.push(...[1,2,0,3,2,1].map(Tr=>Tr+sr))}return{positions:ie,index:xe,normals:Ee}}function V2(a,o,f,v=!1){const T=Jl.Ue(),O=Jl.Ue(),L=Jl.Ue();v&&(a=(0,Pe.vP)(a),o=(0,Pe.vP)(o),f=(0,Pe.vP)(f));const F=Jl.al(...a),H=Jl.al(...o),ie=Jl.al(...f);Jl.lu(T,ie,H),Jl.lu(O,F,H),Jl.kC(L,T,O);const xe=Jl.Ue();return Jl.Fv(xe,L),xe}const Dy={};function Lv(a){const o=(0,Pe.SI)(a.coordinates);return{vertices:[...o,...o,...o,...o],indices:[0,1,2,2,3,0],size:o.length}}function H2(a){const o=(0,Pe.SI)(a.coordinates),f=Um(o);return{vertices:[...f,...f,...f,...f],indices:[0,1,2,2,3,0],size:f.length}}function Z2(a){const{shape:o}=a,{positions:f,index:v,normals:T}=$M(o,!1);return{vertices:f,indices:v,normals:T,size:5}}function Dw(a){const o=(0,Pe.SI)(a.coordinates);return{vertices:[...o],indices:[0],size:o.length}}function Ab(a){const{coordinates:o}=a,f=new cp({dash:!0,join:"bevel"});let v=o;v[0]&&!Array.isArray(v[0][0])&&(v=[o]),v.forEach(O=>{f.extrude(O)});const T=f.complex;return{vertices:T.positions,indices:T.indices,normals:T.normals,indexes:T.indexes,size:6}}function GM(a){const o=a.coordinates.flat(),f=1,v=1;return{vertices:[1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o,1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o],normals:[-f,2*v,1,2*v,-v,1,v,-v,1,v,-v,1,-f,-v,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Nw(a){const{coordinates:o}=a,f=[];if(!Array.isArray(o[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:v,totalDistance:T}=Hm(o);return v.map(O=>{f.push(O[0],O[1],O[2],O[3],0,T)}),{vertices:f,indices:[],normals:[],size:6,count:v.length}}function XM(a){const{coordinates:o}=a,f=[];if(!Array.isArray(o[0]))return{vertices:[],indices:[],size:4,count:0};const{results:v}=W1(o);return v.map(T=>{f.push(T[0],T[1],T[2],T[3])}),{vertices:f,indices:[],size:4,count:v.length}}function W2(a,o){const f=o[0]-a[0],v=o[1]-a[1];return Math.sqrt(f*f+v*v)}function Cg(a,o){return a.length<3&&a.push(0),o!==void 0&&a.push(o),a}function Hm(a){let o=a;Array.isArray(o)&&Array.isArray(o[0])&&Array.isArray(o[0][0])&&(o=a.flat());let f=0;if(o.length<2)return{results:o,totalDistance:0};{const v=[],T=Cg(o[0],f);v.push(T);for(let L=1;L<o.length-1;L++){const F=W2((0,Pe.Z)(o[L-1]),(0,Pe.Z)(o[L]));f+=F;const H=Cg(o[L],f);v.push(H),v.push(H)}const O=W2((0,Pe.Z)(o[o.length-2]),(0,Pe.Z)(o[o.length-1]));return f+=O,v.push(Cg(o[o.length-1],f)),{results:v,totalDistance:f}}}function W1(a){if(a.length<2)return{results:a};{const o=[],f=Cg(a[0]);o.push(f);for(let v=1;v<a.length-1;v++){const T=Cg(a[v]);o.push(T),o.push(T)}return o.push(Cg(a[a.length-1])),{results:o}}}function Og(a){const{coordinates:o}=a,f=Ih().flatten(o),{vertices:v,dimensions:T,holes:O}=f;return{indices:Sg(v,O,T),vertices:v,size:T}}function G2(a){const{indices:o,vertices:f,size:v}=Og(a);return{indices:o,vertices:X2(f),size:v+4}}function X2(a){const o=[],{center:f,radius:v}=(0,Pe.Rx)(a);for(let T=0;T<a.length;T+=2){const O=a[T],L=a[T+1];o.push(O,L,0,...f,v)}return o}function G1(a){const o=a.coordinates,{positions:f,index:v,normals:T}=j2(o,!0);return{vertices:f,indices:v,normals:T,size:5}}function YM(a){const{shape:o}=a,{positions:f,index:v}=qM(o);return{vertices:f,indices:v,size:3}}function X1(a){const o=a.coordinates;return{vertices:[...o[0],0,0,0,...o[1],0,1,0,...o[2],0,1,1,...o[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function Y2(a,o){const{segmentNumber:f=30}=o,v=a.coordinates,T=[],O=[];for(let L=0;L<f;L++)T.push(L,1,L,v[0][0],v[0][1],v[1][0],v[1][1],L,-1,L,v[0][0],v[0][1],v[1][0],v[1][1]),L!==f-1&&O.push(...[0,1,2,1,3,2].map(F=>L*2+F));return{vertices:T,indices:O,size:7}}function Ck(a){const o=a.coordinates;o.length===2&&o.push(0);const f=Y1(-1,1),v=Y1(1,1),T=Y1(-1,-1),O=Y1(1,-1);return{vertices:[...o,...f,...o,...T,...o,...O,...o,...v],indices:[0,1,2,3,0,2],size:5}}function $M(a,o=!1){if(Dy&&Dy[a])return Dy[a];const f=x0[a]?x0[a]():x0.cylinder(),v=j2([f],o);return Dy[a]=v,v}function Ok(a,o,f=3,v=!1){const T=new Float32Array(a.length/f*3);let O,L,F;const H=vec3.create(),ie=vec3.create(),xe=vec3.create();for(let Ee=0,Ye=o.length;Ee<Ye;Ee+=3){O=o[Ee+0]*3,L=o[Ee+1]*3,F=o[Ee+2]*3;let Lt=[a[O],a[O+1]],an=[a[L],a[L+1]],Pn=[a[F],a[F+1]];v&&(Lt=lngLatToMeters(Lt),an=lngLatToMeters(an),Pn=lngLatToMeters(Pn));const[sr,Rr]=Lt,Tr=vec3.fromValues(sr,Rr,a[O+2]),[li,Ui]=an,Lo=vec3.fromValues(li,Ui,a[L+2]),[eo,Wr]=Pn,Wi=vec3.fromValues(eo,Wr,a[F+2]);vec3.sub(H,Wi,Lo),vec3.sub(ie,Tr,Lo),vec3.cross(xe,H,ie),T[O]+=H[0],T[O+1]+=H[1],T[O+2]+=H[2],T[L]+=H[0],T[L+1]+=H[1],T[L+2]+=H[2],T[F]+=H[0],T[F+1]+=H[1],T[F+2]+=H[2]}return KM(T),T}function KM(a){for(let o=0,f=a.length;o<f;o+=3){const v=vec3.fromValues(a[o],a[o+1],a[o+2]),T=vec3.create();vec3.normalize(T,v),a.set(T,o)}}function Rk(a){const o=a[0][0],f=a[0][a[0].length-1];return o[0]===f[0]&&o[1]===f[1]}function qM(a){const o=["cylinder","triangleColumn","hexagonColumn","squareColumn"],f=geometryShape[a]?geometryShape[a]():geometryShape.circle();return o.indexOf(a)===-1?fillPolygon([f]):extrudePolygon([f])}function Y1(a,o){const f=(a+1)/2,v=(o+1)/2;return[f,v]}function QM(){const a=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),{positionsArr:o,indicesArr:f,normalArr:v}=a;return{vertices:o,indices:f,size:5,normals:v}}function JM(){const a=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),{positionsArr:o,indicesArr:f,normalArr:v}=a;return{vertices:o,indices:f,size:5,normals:v}}const Bw=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,Fw=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // \u6B63\u5411
    return mid;
  } else {
    // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // \u8D77\u59CB\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // \u8BA1\u7B97 dashArray \u548C distanceRatio \u8F93\u51FA\u5230\u7247\u5143
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F
    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance / pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,kw={solid:0,dash:1};class zw extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5],forward:L=!0,lineTexture:F=!1,iconStep:H=100,segmentNumber:ie=30}=this.layer.getLayerConfig(),{animateOption:xe}=this.layer.getLayerConfig();let Ee=O;T!=="dash"&&(Ee=[0,0]),Ee.length===2&&Ee.push(0,0);let Ye=0,Lt=[0,0,0,0],an=[0,0,0,0];if(o&&f&&(Lt=(0,Pe.CI)(o),an=(0,Pe.CI)(f),Ye=1),this.rendererService.getDirty()){var Pn;(Pn=this.texture)===null||Pn===void 0||Pn.bind()}const sr={u_animate:this.animateOption2Array(xe),u_dash_array:Ee,u_sourceColor:Lt,u_targetColor:an,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:ie,u_lineDir:L?1:-1,u_icon_step:H,u_line_texture:F?1:0,u_textureBlend:v==="normal"?0:1,u_blur:.9,u_line_type:kw[T||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Ye};return this.getUniformsBufferInfo(sr)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:Bw,vert:Fw,type:""}}buildModels(){var o=this;return(0,Ti.Z)(function*(){o.initUniformsBuffer();const{segmentNumber:f=30}=o.layer.getLayerConfig(),{frag:v,vert:T,type:O}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:"lineArc2d"+O,vertexShader:T,fragmentShader:v,defines:o.getDefines(),inject:o.getInject(),triangulation:Y2,depth:{enable:!1},styleOption:{segmentNumber:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Pe.Ks)(v[3]),(0,Pe.Ks)(v[4]),(0,Pe.Ks)(v[5]),(0,Pe.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:K.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{thetaOffset:f=1}=o;return[f]}}})}}const Uw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,jw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,Vw={solid:0,dash:1};class $2 extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5],lineTexture:L=!1,iconStep:F=100,segmentNumber:H=30,globalArcHeight:ie=10}=this.layer.getLayerConfig(),{animateOption:xe}=this.layer.getLayerConfig();O.length===2&&O.push(0,0);let Ee=0,Ye=[0,0,0,0],Lt=[0,0,0,0];if(o&&f&&(Ye=(0,Pe.CI)(o),Lt=(0,Pe.CI)(f),Ee=1),this.rendererService.getDirty()){var an;(an=this.texture)===null||an===void 0||an.bind()}const Pn={u_animate:this.animateOption2Array(xe),u_dash_array:O,u_sourceColor:Ye,u_targetColor:Lt,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Py,u_global_height:ie,segmentNumber:H,u_line_type:Vw[T]||0,u_icon_step:F,u_line_texture:L?1:0,u_textureBlend:v==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:Ee};return this.getUniformsBufferInfo(Pn)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:Uw,vert:jw,type:""}}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{segmentNumber:f=30}=o.layer.getLayerConfig(),{frag:v,vert:T,type:O}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:"lineArc3d"+O,vertexShader:T,fragmentShader:v,defines:o.getDefines(),inject:o.getInject(),triangulation:Y2,styleOption:{segmentNumber:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Pe.Ks)(v[3]),(0,Pe.Ks)(v[4]),(0,Pe.Ks)(v[5]),(0,Pe.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:K.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{thetaOffset:f=1}=o;return[f]}}})}}const Cb={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},ld=1/2;function K2(a,o){const{width:f=2,height:v=1}=o;return{vertices:[0,ld*a,1*a*f,-(v+ld)*a,1*a*f,(v-ld)*a,0,ld*a,1*a*f,-(v+ld)*a,1*a*f,(v-ld)*a],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*a,-2*a,1,-2*a,1.5*a,1,1*a,1.5*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function Hw(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,1*a*f,1*v,1*a*f,-1*v,0,0,1*a*f,1*v,1*a*f,-1*v],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*a,1,2,1*a,1,-2,1*a,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function q2(a,o){const{width:f=2,height:v=2}=o;return{vertices:[0,v/2,a*f*1,v/2,a*f*1,-v/2,0,-v/2,0,v/2,a*f*1,v/2,a*f*1,-v/2,0,-v/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Zw(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,1*f*a,.5*v,2*f*a,0,1*f*a,-.5*v,0,0,1*f*a,.5*v,2*f*a,0,1*f*a,-.5*v],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Ob(a,o){const{width:f=2,height:v=3}=o;return{vertices:[0,0,2*a*f,1*v,1.5*a*f,0,2*a*f,-1*v,0,0,2*a*f,1*v,1.5*a*f,0,2*a*f,-1*v],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-a,1,1,0,1,0,-a,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Ww(a,o){const{width:f=2,height:v=2}=o,T=K0(),O=Ih().flatten([T]),L=Ih()(O.vertices,O.holes,O.dimensions),F=T.map(H=>[H[0]*f*a,H[1]*v]).flat();return{vertices:[...F,...F],dimensions:2,indices:L.map(H=>H+T.length),outLineIndices:L,normals:[...T.map(H=>[H[1]*v,H[0]*f*a,1]).flat(),...new Array(T.length*3).fill(0)]}}function q0(a,o=0,f){const v=typeof f.source=="object"?f.source.type:f.source,T=typeof f.target=="object"?f.target.type:f.target,{width:O=v?Cb[v]:0}=typeof f.source=="object"?f.source:{},{width:L=T?Cb[T]:0}=typeof f.target=="object"?f.target:{};return{vertices:[0,ld,1*O,...a,1,ld,-1*L,...a,1,-ld,-1*L,...a,0,-ld,1*O,...a,0,ld,1*O,...a,1,ld,-1*L,...a,1,-ld,-1*L,...a,0,-ld,1*O,...a],outLineIndices:[0,1,2,0,2,3].map(F=>F+o),indices:[4,5,6,4,6,7].map(F=>F+o),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function Q2(a,o){const f=typeof a=="object"?a.type:a,v=o==="source"?1:-1,T=typeof a=="object"?a:{};switch(f){case"circle":return Ww(v,T);case"triangle":return Hw(v,T);case"diamond":return Zw(v,T);case"rect":return q2(v,T);case"classic":return Ob(v,T);case"halfTriangle":return K2(v,T);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function Gw(a){const o=a.coordinates.flat(),f=1,v=1;return{vertices:[1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o,1,0,0,...o,1,2,-3,...o,1,1,-3,...o,0,1,0,...o,0,0,0,...o],normals:[-f,2*v,1,2*v,-v,1,v,-v,1,v,-v,1,-f,-v,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function J2(a,o){return o?Xw(a,o):Gw(a)}function Xw(a,o){const f=a.coordinates.flat(),{target:v="classic",source:T="circle"}=o,O=ri(Q2(T,"source"),f,0,0),L=q0(f,O.vertices.length/7,o),F=ri(Q2(v,"target"),f,1,O.vertices.length/7+L.vertices.length/7);return{vertices:[...O.vertices,...L.vertices,...F.vertices],indices:[...O.outLineIndices,...L.outLineIndices,...F.outLineIndices,...O.indices,...L.indices,...F.indices],normals:[...O.normals,...L.normals,...F.normals],size:7}}function ri(a,o,f=1,v=0){const T=[],{vertices:O,indices:L,dimensions:F,outLineIndices:H}=a;for(let ie=0;ie<O.length;ie+=F)T.push(f,O[ie+1],O[ie],...o);return(0,Cr.Z)((0,Cr.Z)({},a),{},{vertices:T,indices:L.map(ie=>ie+v),outLineIndices:H.map(ie=>ie+v)})}const Yw=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,eP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source_world = a_Instance.rg; // \u8D77\u70B9
  vec2 target_world = a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class Rb extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:o=2,strokeWidth:f=1,strokeOpacity:v=1}=this.layer.getLayerConfig(),T={u_gap_width:o,u_stroke_width:f,u_stroke_opacity:v};return this.getUniformsBufferInfo(T)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return[yield o.layer.buildLayerModel({moduleName:"flow_line",vertexShader:eP,fragmentShader:Yw,defines:o.getDefines(),inject:o.getInject(),triangulation:J2,styleOption:o.layer.getLayerConfig().symbol,primitive:K.gl.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Pe.Ks)(v[3]),(0,Pe.Ks)(v[4]),(0,Pe.Ks)(v[5]),(0,Pe.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}})}}const eE=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,tE=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,nE={solid:0,dash:1};class Ny extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5],lineTexture:L=!1,iconStep:F=100,segmentNumber:H=30}=this.layer.getLayerConfig(),{animateOption:ie}=this.layer.getLayerConfig();if(O.length===2&&O.push(0,0),this.rendererService.getDirty()){var xe;(xe=this.texture)===null||xe===void 0||xe.bind()}let Ee=0,Ye=[0,0,0,0],Lt=[0,0,0,0];o&&f&&(Ye=(0,Pe.CI)(o),Lt=(0,Pe.CI)(f),Ee=1);let an=this.layer.getLayerAnimateTime();isNaN(an)&&(an=0);const Pn={u_animate:this.animateOption2Array(ie),u_dash_array:O,u_sourceColor:Ye,u_targetColor:Lt,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:H,u_line_type:nE[T]||0,u_icon_step:F,u_line_texture:L?1:0,u_textureBlend:v==="normal"?0:1,u_time:an,u_linearColor:Ee};return this.getUniformsBufferInfo(Pn)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{segmentNumber:f=30}=o.layer.getLayerConfig();return[yield o.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:tE,fragmentShader:eE,triangulation:Y2,styleOption:{segmentNumber:f},defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:K.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[v[3],v[4],v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:K.GC.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>[(0,Pe.Ks)(v[3]),(0,Pe.Ks)(v[4]),(0,Pe.Ks)(v[5]),(0,Pe.Ks)(v[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}})}}let Rc=function(a){return a[a.solid=0]="solid",a[a.dash=1]="dash",a}({}),By=function(a){return a.VERTICAL="vertical",a.HORIZONTAL="horizontal",a}({}),rE=function(a){return a.NORMAL="normal",a.REPLACE="replace",a}({}),iE=function(a){return a[a.pixel=0]="pixel",a[a.meter=1]="meter",a}({}),Mk=function(a){return a.ALWAYS="always",a.DRAGEND="dragend",a}({});const Mb=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,$1=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth / linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class $w extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"textureEventFlag",!1),(0,Kt.Z)(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",lineType:T="solid",dashArray:O=[10,5,0,0],lineTexture:L=!1,iconStep:F=100,vertexHeightScale:H=20,strokeWidth:ie=0,raisingHeight:xe=0,heightfixed:Ee=!1,linearDir:Ye=By.VERTICAL,blur:Lt=[1,1,1,0]}=this.layer.getLayerConfig();let an=O;if(T!=="dash"&&(an=[0,0,0,0]),an.length===2&&an.push(0,0),this.rendererService.getDirty()&&this.texture){var Pn;(Pn=this.texture)===null||Pn===void 0||Pn.bind()}const{animateOption:sr}=this.layer.getLayerConfig();let Rr=0,Tr=[0,0,0,0],li=[0,0,0,0];o&&f&&(Tr=(0,Pe.CI)(o),li=(0,Pe.CI)(f),Rr=1);const Ui={u_animate:this.animateOption2Array(sr),u_dash_array:an,u_blur:Lt,u_sourceColor:Tr,u_targetColor:li,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:F,u_heightfixed:Number(Ee),u_vertexScale:H,u_raisingHeight:Number(xe),u_strokeWidth:ie,u_textureBlend:v===rE.NORMAL?0:1,u_line_texture:L?1:0,u_linearDir:Ye===By.VERTICAL?1:0,u_linearColor:Rr,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Ui)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.textureEventFlag||(o.textureEventFlag=!0,o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture)),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{depth:f=!1}=o.layer.getLayerConfig(),{frag:v,vert:T,type:O}=o.getShaders();return o.layer.triangulation=Ab,[yield o.layer.buildLayerModel({moduleName:"line"+O,vertexShader:T,fragmentShader:v,triangulation:Ab,defines:o.getDefines(),inject:o.getInject(),depth:{enable:f}})]})()}getShaders(){return{frag:Mb,vert:$1,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:K.GC.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O,L)=>L===void 0?[v[3],10,v[4]]:[v[3],L,v[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:K.GC.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v,T,O)=>[...O,v[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}})}}const tP=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,oE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class Rg extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,lineType:v="solid",dashArray:T=[10,5,0,0],vertexHeightScale:O=20}=this.layer.getLayerConfig();let L=T;v!=="dash"&&(L=[0,0,0,0]),L.length===2&&L.push(0,0);let F=0,H=[0,0,0,0],ie=[0,0,0,0];o&&f&&(H=(0,Pe.CI)(o),ie=(0,Pe.CI)(f),F=1);const xe={u_sourceColor:H,u_targetColor:ie,u_dash_array:L,u_vertexScale:O,u_linearColor:F};return this.getUniformsBufferInfo(xe)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}getShaders(){return{frag:tP,vert:oE,type:"lineSimpleNormal"}}buildModels(){var o=this;return(0,Ti.Z)(function*(){o.initUniformsBuffer();const{frag:f,vert:v,type:T}=o.getShaders();return[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,triangulation:Nw,defines:o.getDefines(),inject:o.getInject(),primitive:K.gl.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:K.GC.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:(o,f,v)=>{const{size:T=1}=o,O=Array.isArray(T)?[T[0],T[1]]:[T,0];return[O[0],O[1],v[3],v[5]]}}})}}const aE=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,Kw=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance; // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen; // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // \u56FA\u5B9A\u9AD8\u5EA6
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class sE extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.NEAREST,min:K.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:o,targetColor:f,textureBlend:v="normal",heightfixed:T=!1,lineTexture:O=!1,iconStep:L=100,iconStepCount:F=1}=this.layer.getLayerConfig(),{animateOption:H}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var ie;(ie=this.texture)===null||ie===void 0||ie.bind()}let xe=0,Ee=[0,0,0,0],Ye=[0,0,0,0];o&&f&&(Ee=(0,Pe.CI)(o),Ye=(0,Pe.CI)(f),xe=1);const Lt={u_animate:this.animateOption2Array(H),u_sourceColor:Ee,u_targetColor:Ye,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:L,u_heightfixed:Number(T),u_linearColor:xe,u_line_texture:O?1:0,u_textureBlend:v==="normal"?0:1,u_iconStepCount:F,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(Lt)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.updateTexture(),o.iconService.on("imageUpdate",o.updateTexture),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ti.Z)(function*(){return[yield o.layer.buildLayerModel({moduleName:"lineWall",vertexShader:Kw,fragmentShader:aE,triangulation:Ab,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},blend:o.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:K.GC.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v)=>[v[3],v[4],v[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{texture:v}=o,{x:T,y:O}=f[v]||{x:0,y:0};return[T,O]}}})}}var Dv={arc:zw,arc3d:$2,greatcircle:Ny,wall:sE,line:$w,simple:Rg,flowline:Rb,earthArc3d:$2};class Fy extends $0{constructor(...o){super(...o),(0,Kt.Z)(this,"type","LineLayer"),(0,Kt.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,Kt.Z)(this,"arrowInsertCount",0),(0,Kt.Z)(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var o=this;return(0,Ti.Z)(function*(){const f=o.getModelType();o.layerModel=new Dv[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[o]}getModelType(){var o;if(this.layerType)return this.layerType;const f=this.styleAttributeService.getLayerStyleAttribute("shape");return(f==null||(o=f.scale)===null||o===void 0?void 0:o.field)||"line"}processData(o){if(this.getModelType()!=="simple")return o;const f=[];return o.map(v=>{if(Array.isArray(v.coordinates)&&Array.isArray(v.coordinates[0])&&Array.isArray(v.coordinates[0][0])){const T=(0,Cr.Z)({},v);v.coordinates.map(O=>{f.push((0,Cr.Z)((0,Cr.Z)({},T),{},{coordinates:O}))})}else f.push(v)}),f}}const qw=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Pb=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if (u_heightfixed < 1.0) {
    // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
  } else {
    // \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if (u_linearColor == 1.0) {
    // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;class Nv extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"raiseCount",0),(0,Kt.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:o={enable:!1,speed:.01,repeat:!1},sourceColor:f,targetColor:v,pickLight:T=!1,heightfixed:O=!1,opacityLinear:L={enable:!1,dir:"up"},lightEnable:F=!0}=this.layer.getLayerConfig();let H=0,ie=[0,0,0,0],xe=[0,0,0,0];if(f&&v&&(ie=(0,Pe.CI)(f),xe=(0,Pe.CI)(v),H=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){const{speed:Lt=.01}=o;this.raiseCount+=Lt,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const Ee={u_pickLight:Number(T),u_heightfixed:Number(O),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:H,u_sourceColor:ie,u_targetColor:xe,u_opacitylinear:Number(L.enable),u_opacitylinear_dir:L.dir==="up"?1:0,u_lightEnable:Number(F)};return this.getUniformsBufferInfo(Ee)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{depth:f=!0,animateOption:{repeat:v=1}}=o.layer.getLayerConfig();return o.raiseRepeat=v,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:Pb,fragmentShader:qw,triangulation:Z2,defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:K.gl.FRONT},depth:{enable:f}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:o=>{const{size:f}=o;if(f){let v=[];return Array.isArray(f)&&(v=f.length===2?[f[0],f[0],f[1]]:f),Array.isArray(f)||(v=[f,f,f]),v}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:4,update:o=>{const f=(0,Pe.SI)(o.coordinates);return[f[0],f[1],(0,Pe.Ks)(f[0]),(0,Pe.Ks)(f[1])]}}})}}const Ib=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,ec=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Qw extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:o=1,strokeWidth:f=0,blend:v,blur:T=0,raisingHeight:O=0,heightfixed:L=!1,unit:F="pixel"}=this.layer.getLayerConfig();let H=this.getAnimateUniforms().u_time;isNaN(H)&&(H=-1);const ie={u_blur_height_fixed:[T,Number(O),Number(L)],u_stroke_width:f,u_additive:v==="additive"?1:0,u_stroke_opacity:o,u_size_unit:iE[F],u_time:H,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(ie)}getAnimateUniforms(){const{animateOption:o={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(o),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Lv)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{frag:f,vert:v,type:T}=o.getShaders();return o.layer.triangulation=Lv,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:Lv,depth:{enable:!1}})]})()}getShaders(){return{frag:Ib,vert:ec,type:"pointFill"}}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){const o=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(f,v,T,O)=>{const L=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],F=O%4*3;return[L[F],L[F+1],L[F+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:f=>{const{size:v=5}=f;return Array.isArray(v)?[v[0]]:[v]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:K.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:f=>{const{shape:v=2}=f;return[o.indexOf(v)]}}})}}const Jw=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,eA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class uo extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.LINEAR,min:K.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var o;(o=this.texture)===null||o===void 0||o.bind()}const f=this.getCommonUniformsInfo(),v=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},f.uniformsOption),v.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:o=0,heightfixed:f=!1}=this.layer.getLayerConfig(),v={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(o),u_heightfixed:Number(f),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.iconService.on("imageUpdate",o.updateTexture),o.updateTexture(),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointImage",vertexShader:eA,fragmentShader:Jw,triangulation:Dw,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},primitive:K.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{shape:v}=o,{x:T,y:O}=f[v]||{x:-64,y:-64};return[T,O]}}})}}const lE=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,rP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function cE(a){const o=a.coordinates;return{vertices:[...o],indices:[0],size:o.length}}class K1 extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const o={u_size_scale:.5};return this.getUniformsBufferInfo(o)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.layer.triangulation=cE,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:rP,fragmentShader:lE,triangulation:cE,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1},primitive:K.gl.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}var q1=D(98333),Q0=D(85975);class J0{constructor(o,f,v){(0,Kt.Z)(this,"boxCells",[]),(0,Kt.Z)(this,"xCellCount",void 0),(0,Kt.Z)(this,"yCellCount",void 0),(0,Kt.Z)(this,"boxKeys",void 0),(0,Kt.Z)(this,"bboxes",void 0),(0,Kt.Z)(this,"width",void 0),(0,Kt.Z)(this,"height",void 0),(0,Kt.Z)(this,"xScale",void 0),(0,Kt.Z)(this,"yScale",void 0),(0,Kt.Z)(this,"boxUid",void 0);const T=this.boxCells;this.xCellCount=Math.ceil(o/v),this.yCellCount=Math.ceil(f/v);for(let O=0;O<this.xCellCount*this.yCellCount;O++)T.push([]);this.boxKeys=[],this.bboxes=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0}insert(o,f,v,T,O){this.forEachCell(f,v,T,O,this.insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(T),this.bboxes.push(O)}query(o,f,v,T,O){return this.queryHitTest(o,f,v,T,!1,O)}hitTest(o,f,v,T,O){return this.queryHitTest(o,f,v,T,!0,O)}insertBoxCell(o,f,v,T,O,L){this.boxCells[O].push(L)}queryHitTest(o,f,v,T,O,L){if(v<0||o>this.width||T<0||f>this.height)return O?!1:[];const F=[];if(o<=0&&f<=0&&this.width<=v&&this.height<=T){if(O)return!0;for(let ie=0;ie<this.boxKeys.length;ie++)F.push({key:this.boxKeys[ie],x1:this.bboxes[ie*4],y1:this.bboxes[ie*4+1],x2:this.bboxes[ie*4+2],y2:this.bboxes[ie*4+3]});return L?F.filter(L):F}const H={hitTest:O,seenUids:{box:{},circle:{}}};return this.forEachCell(o,f,v,T,this.queryCell,F,H,L),O?F.length>0:F}queryCell(o,f,v,T,O,L,F,H){const ie=F.seenUids,xe=this.boxCells[O];if(xe!==null){const Ee=this.bboxes;for(const Ye of xe)if(!ie.box[Ye]){ie.box[Ye]=!0;const Lt=Ye*4;if(o<=Ee[Lt+2]&&f<=Ee[Lt+3]&&v>=Ee[Lt+0]&&T>=Ee[Lt+1]&&(!H||H(this.boxKeys[Ye]))){if(F.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[Ye],x1:Ee[Lt],y1:Ee[Lt+1],x2:Ee[Lt+2],y2:Ee[Lt+3]})}}}return!1}forEachCell(o,f,v,T,O,L,F,H){const ie=this.convertToXCellCoord(o),xe=this.convertToYCellCoord(f),Ee=this.convertToXCellCoord(v),Ye=this.convertToYCellCoord(T);for(let Lt=ie;Lt<=Ee;Lt++)for(let an=xe;an<=Ye;an++){const Pn=this.xCellCount*an+Lt;if(O.call(this,o,f,v,T,Pn,L,F,H))return}}convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}}var uE=J0;class Ra{constructor(o,f){(0,Kt.Z)(this,"width",void 0),(0,Kt.Z)(this,"height",void 0),(0,Kt.Z)(this,"grid",void 0),(0,Kt.Z)(this,"viewportPadding",100),(0,Kt.Z)(this,"screenRightBoundary",void 0),(0,Kt.Z)(this,"screenBottomBoundary",void 0),(0,Kt.Z)(this,"gridRightBoundary",void 0),(0,Kt.Z)(this,"gridBottomBoundary",void 0),this.width=o,this.height=f,this.viewportPadding=Math.max(o,f),this.grid=new uE(o+this.viewportPadding,f+this.viewportPadding,25),this.screenRightBoundary=o+this.viewportPadding,this.screenBottomBoundary=f+this.viewportPadding,this.gridRightBoundary=o+2*this.viewportPadding,this.gridBottomBoundary=f+2*this.viewportPadding}placeCollisionBox(o){const f=o.x1+o.anchorPointX+this.viewportPadding,v=o.y1+o.anchorPointY+this.viewportPadding,T=o.x2+o.anchorPointX+this.viewportPadding,O=o.y2+o.anchorPointY+this.viewportPadding;return!this.isInsideGrid(f,v,T,O)||this.grid.hitTest(f,v,T,O)?{box:[]}:{box:[f,v,T,O]}}insertCollisionBox(o,f){const v={featureIndex:f};this.grid.insert(v,o[0],o[1],o[2],o[3])}project(o,f,v){const T=q1.al(f,v,0,1),O=q1.Ue(),L=Q0.fromValues(...o);return q1.fF(O,T,L),{x:(O[0]/O[3]+1)/2*this.width+this.viewportPadding,y:(-O[1]/O[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(o,f,v,T){return v>=0&&o<this.gridRightBoundary&&T>=0&&f<this.gridBottomBoundary}}function pu(a){let o=.5,f=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0;break;default:o=.5}switch(a){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0;break;default:f=.5}return{horizontalAlign:o,verticalAlign:f}}function gl(a,o,f,v,T){if(!T)return;const O=a[v],L=O.glyph;if(L){const F=o[L].advance*O.scale,H=(a[v].x+F)*T;for(let ie=f;ie<=v;ie++)a[ie].x-=H}}function fE(a,o,f,v,T,O,L){const F=(o-f)*T,H=(-v*L+.5)*O;for(const ie of a)ie.x+=F,ie.y+=H}function Zm(a,o,f,v,T,O,L){let H=0,ie=-8,xe=0;const Ee=a.positionedGlyphs,Ye=O==="right"?1:O==="left"?0:.5,Lt=Ee.length;f.forEach(Rr=>{if(Rr.split("").forEach(Tr=>{const li=o[Tr];li&&(Ee.push({glyph:Tr,x:H,y:ie+0,vertical:!1,scale:1,metrics:li}),H+=li.advance+L)}),Ee.length!==Lt){const Tr=H-L;xe=Math.max(Tr,xe),gl(Ee,o,Lt,Ee.length-1,Ye)}H=0,ie-=v+5});const{horizontalAlign:an,verticalAlign:Pn}=pu(T);fE(Ee,Ye,an,Pn,xe,v,f.length);const sr=ie- -8;a.top+=-Pn*sr,a.bottom=a.top-sr,a.left+=-an*xe,a.right=a.left+xe}function tA(a,o,f,v,T,O,L){let H=0,ie=-8,xe=0;const Ee=a.positionedGlyphs,Ye=O==="right"?1:O==="left"?0:.5,Lt=Ee.length;f.forEach(Rr=>{const Tr=o[Rr];if(Tr&&(Ee.push({glyph:Rr,x:Tr.advance/2,y:ie+0,vertical:!1,scale:1,metrics:Tr}),H+=Tr.advance+L),Ee.length!==Lt){const Ui=H-L;xe=Math.max(Ui,xe),gl(Ee,o,Lt,Ee.length-1,Ye)}H=0,ie-=v+5});const{horizontalAlign:an,verticalAlign:Pn}=pu(T);fE(Ee,Ye,an,Pn,xe,v,f.length);const sr=ie- -8;a.top+=-Pn*sr,a.bottom=a.top-sr,a.left+=-an*xe,a.right=a.left+xe}function Q1(a,o,f,v,T,O,L=[0,0],F){const H=a.split(`
`),ie=[],xe={positionedGlyphs:ie,top:L[1],bottom:L[1],left:L[0],right:L[0],lineCount:H.length,text:a};return F?tA(xe,o,H,f,v,T,O):Zm(xe,o,H,f,v,T,O),ie.length?xe:!1}function nA(a,o=[0,0],f){const{positionedGlyphs:v=[]}=a,T=[];for(const O of v){const L=O.metrics,F=4,H=L.advance*O.scale/2,ie=f?[O.x+H,O.y]:[0,0],xe=f?[0,0]:[O.x+H+o[0],O.y+o[1]],Ee=(0-F)*O.scale-H+xe[0],Ye=(0-F)*O.scale+xe[1],Lt=Ee+L.width*O.scale,an=Ye+L.height*O.scale,Pn={x:Ee,y:Ye},sr={x:Lt,y:Ye},Rr={x:Ee,y:an},Tr={x:Lt,y:an};T.push({tl:Pn,tr:sr,bl:Rr,br:Tr,tex:L,glyphOffset:ie})}return T}const hE=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,dE=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:ky}=Pe.lodashUtil;function J1(a){const o=this,f=a.id,v=[],T=[];if(!o.glyphInfoMap||!o.glyphInfoMap[f])return{vertices:[],indices:[],size:7};const O=o.glyphInfoMap[f].centroid,L=O.length===2?[O[0],O[1],0]:O;return o.glyphInfoMap[f].glyphQuads.forEach((F,H)=>{v.push(...L,F.tex.x,F.tex.y+F.tex.height,F.tl.x,F.tl.y,...L,F.tex.x+F.tex.width,F.tex.y+F.tex.height,F.tr.x,F.tr.y,...L,F.tex.x+F.tex.width,F.tex.y,F.br.x,F.br.y,...L,F.tex.x,F.tex.y,F.bl.x,F.bl.y),T.push(0+H*4,1+H*4,2+H*4,2+H*4,3+H*4,0+H*4)}),{vertices:v,indices:T,size:7}}class e_ extends Cl{constructor(...o){var f;super(...o),f=this,(0,Kt.Z)(this,"glyphInfo",void 0),(0,Kt.Z)(this,"glyphInfoMap",{}),(0,Kt.Z)(this,"rawEncodeData",void 0),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"currentZoom",-1),(0,Kt.Z)(this,"extent",void 0),(0,Kt.Z)(this,"textureHeight",0),(0,Kt.Z)(this,"textCount",0),(0,Kt.Z)(this,"preTextStyle",{}),(0,Kt.Z)(this,"mapping",(0,Ti.Z)(function*(){f.initGlyph(),f.updateTexture(),yield f.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:o="#fff",strokeWidth:f=0,halo:v=.5,gamma:T=2,raisingHeight:O=0}=this.layer.getLayerConfig(),L=this.getFontServiceMapping(),F=this.getFontServiceCanvas();L&&Object.keys(L).length!==this.textCount&&F&&(this.updateTexture(),this.textCount=Object.keys(L).length),this.preTextStyle=this.getTextStyle();const H={u_stroke_color:(0,Pe.CI)(o),u_sdf_map_size:[(F==null?void 0:F.width)||1,(F==null?void 0:F.height)||1],u_raisingHeight:Number(O),u_stroke_width:f,u_gamma_scale:T,u_halo_blur:v};return this.getUniformsBufferInfo(H)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.bindEvent(),o.extent=o.textExtent(),o.rawEncodeData=o.layer.getEncodedData(),o.preTextStyle=o.getTextStyle(),o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{textAllowOverlap:f=!1}=o.layer.getLayerConfig();return o.initGlyph(),o.updateTexture(),f||o.filterGlyphs(),[yield o.layer.buildLayerModel({moduleName:"pointText",vertexShader:dE,fragmentShader:hE,defines:o.getDefines(),inject:o.getInject(),triangulation:J1.bind(o),depth:{enable:!1}})]})()}needUpdate(){var o=this;return(0,Ti.Z)(function*(){const{textAllowOverlap:f=!1,textAnchor:v="center",textOffset:T,padding:O,fontFamily:L,fontWeight:F}=o.getTextStyle();if(!ky(O,o.preTextStyle.padding)||!ky(T,o.preTextStyle.textOffset)||!ky(v,o.preTextStyle.textAnchor)||!ky(L,o.preTextStyle.fontFamily)||!ky(F,o.preTextStyle.fontWeight))return yield o.mapping(),!0;if(f)return!1;const H=o.mapService.getZoom(),ie=o.mapService.getBounds(),xe=(0,Pe.oO)(o.extent,ie);return Math.abs(o.currentZoom-H)>.5||!xe||f!==o.preTextStyle.textAllowOverlap?(yield o.reBuildModel(),!0):!1})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:K.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[5],v[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:K.GC.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=12}=o;return Array.isArray(f)?[f[0]]:[f]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const o=this.mapService.getBounds();return(0,Pe.yA)(o,.5)}initTextFont(){const{fontWeight:o,fontFamily:f}=this.getTextStyle(),v=this.rawEncodeData,T=[];v.forEach(O=>{let{shape:L=""}=O;L=L.toString();for(const F of L)T.indexOf(F)===-1&&T.push(F)}),this.fontService.setFontOptions({characterSet:T,fontWeight:o,fontFamily:f,iconfont:!1})}initIconFontTex(){const{fontWeight:o,fontFamily:f}=this.getTextStyle(),v=this.rawEncodeData,T=[];v.forEach(O=>{let{shape:L=""}=O;L=`${L}`,T.indexOf(L)===-1&&T.push(L)}),this.fontService.setFontOptions({characterSet:T,fontWeight:o,fontFamily:f,iconfont:!0})}getTextStyle(){const{fontWeight:o="400",fontFamily:f="sans-serif",textAllowOverlap:v=!1,padding:T=[0,0],textAnchor:O="center",textOffset:L=[0,0],opacity:F=1,strokeOpacity:H=1,strokeWidth:ie=0,stroke:xe="#000"}=this.layer.getLayerConfig();return{fontWeight:o,fontFamily:f,textAllowOverlap:v,padding:T,textAnchor:O,textOffset:L,opacity:F,strokeOpacity:H,strokeWidth:ie,stroke:xe}}generateGlyphLayout(o){const f=this.getFontServiceMapping(),{spacing:v=2,textAnchor:T="center",textOffset:O}=this.layer.getLayerConfig(),L=this.rawEncodeData;this.glyphInfo=L.map(F=>{const{shape:H="",id:ie,size:xe=1}=F,Ee=F.textOffset?F.textOffset:O||[0,0],Ye=F.textAnchor?F.textAnchor:T||"center",Lt=Q1(H.toString(),f,xe,Ye,"left",v,Ee,o),an=nA(Lt,Ee,!1);return F.shaping=Lt,F.glyphQuads=an,F.centroid=(0,Pe.SI)(F.coordinates),this.glyphInfoMap[ie]={shaping:Lt,glyphQuads:an,centroid:(0,Pe.SI)(F.coordinates)},F})}getFontServiceMapping(){const{fontWeight:o="400",fontFamily:f="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${f}_${o}`)}getFontServiceCanvas(){const{fontWeight:o="400",fontFamily:f="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${f}_${o}`)}filterGlyphs(){const{padding:o=[0,0],textAllowOverlap:f=!1}=this.layer.getLayerConfig();if(f)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:v,height:T}=this.rendererService.getViewportSize(),O=new Ra(v,T);this.glyphInfo.filter(F=>{const{shaping:H,id:ie=0}=F,xe=F.centroid,Ye=F.size/16,Lt=this.mapService.lngLatToContainer(xe),{box:an}=O.placeCollisionBox({x1:H.left*Ye-o[0],x2:H.right*Ye+o[0],y1:H.top*Ye-o[1],y2:H.bottom*Ye+o[1],anchorPointX:Lt.x,anchorPointY:Lt.y});return an&&an.length?(O.insertCollisionBox(an,ie),!0):!1}).forEach(F=>{this.glyphInfoMap[F.id]=F})}initGlyph(){const{iconfont:o=!1}=this.layer.getLayerConfig();o?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(o)}updateTexture(){const{createTexture2D:o}=this.rendererService,f=this.getFontServiceCanvas();this.textureHeight=f.height,this.texture&&this.texture.destroy(),this.texture=o({data:f,mag:K.gl.LINEAR,min:K.gl.LINEAR,width:f.width,height:f.height}),this.textures=[this.texture]}reBuildModel(){var o=this;return(0,Ti.Z)(function*(){o.filterGlyphs();const f=yield o.layer.buildLayerModel({moduleName:"pointText",vertexShader:dE,fragmentShader:hE,triangulation:J1.bind(o),defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}});o.layer.models=[f]})()}}function rA(a){return t_.apply(this,arguments)}function t_(){return t_=(0,Ti.Z)(function*(a){if(window.createImageBitmap){const o=yield fetch(a);return yield createImageBitmap(yield o.blob())}else{const o=new window.Image;return new Promise(f=>{o.onload=()=>f(o),o.src=a,o.crossOrigin="Anonymous"})}}),t_.apply(this,arguments)}const iA=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,pE=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,mE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,vE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,gE=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,yE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class oA extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:o,heightfixed:f=!1,raisingHeight:v=0,topsurface:T=!0,sidesurface:O=!0,sourceColor:L,targetColor:F}=this.layer.getLayerConfig();let H=0,ie=[1,1,1,1],xe=[1,1,1,1];L&&F&&(ie=(0,Pe.CI)(L),xe=(0,Pe.CI)(F),H=1);const Ee={u_sourceColor:ie,u_targetColor:xe,u_linearColor:H,u_topsurface:Number(T),u_sidesurface:Number(O),u_heightfixed:Number(f),u_raisingHeight:Number(v)};return o&&this.texture&&(Ee.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(Ee)}initModels(){var o=this;return(0,Ti.Z)(function*(){return yield o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{frag:f,vert:v,type:T}=o.getShaders();return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,depth:{enable:!0},defines:o.getDefines(),inject:o.getInject(),triangulation:G1})]})()}getShaders(){const{pickLight:o,mapTexture:f}=this.layer.getLayerConfig();return f?{frag:gE,vert:yE,type:"polygonExtrudeTexture"}:o?{frag:pE,vert:mE,type:"polygonExtrudePickLight"}:{frag:iA,vert:vE,type:"polygonExtrude"}}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.textures=[]}registerBuiltinAttributes(){const o=this.layer.getSource().extent,f=o[2]-o[0],v=o[3]-o[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:K.GC.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(T,O,L)=>{const F=L[0],H=L[1];return[(F-o[0])/f,(H-o[1])/v,L[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(T,O,L,F,H)=>H}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:T=>{const{size:O=10}=T;return Array.isArray(O)?[O[0]]:[O]}}})}loadTexture(){var o=this;return(0,Ti.Z)(function*(){const{mapTexture:f}=o.layer.getLayerConfig(),{createTexture2D:v}=o.rendererService;if(o.texture=v({height:1,width:1}),f){const T=yield rA(f);o.texture=v({data:T,width:T.width,height:T.height,wrapS:K.gl.CLAMP_TO_EDGE,wrapT:K.gl.CLAMP_TO_EDGE,min:K.gl.LINEAR,mag:K.gl.LINEAR})}})()}}const n_=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,Wm=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class aA extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const o={};return this.getUniformsBufferInfo(o)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{frag:f,vert:v,type:T}=o.getShaders();return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:T,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:G1,depth:{enable:!0}})]})()}getShaders(){return{frag:n_,vert:Wm,type:"polygonExtrude"}}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=10}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:K.GC.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{extrusionBase:f=0}=o;return[f]}}})}}const sA=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,E0=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,Bv=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,iP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class lA extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:o=0,opacityLinear:f={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),v={u_raisingHeight:Number(o),u_opacitylinear:Number(f.enable),u_dir:f.dir==="in"?1:0};return this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{frag:f,vert:v,triangulation:T,type:O}=o.getModelParams();return o.initUniformsBuffer(),o.layer.triangulation=T,[yield o.layer.buildLayerModel({moduleName:O,vertexShader:v,fragmentShader:f,defines:o.getDefines(),inject:o.getInject(),triangulation:T,primitive:K.gl.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:o={enable:!1,dir:"in"}}=this.layer.getLayerConfig();o.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:K.GC.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(f,v,T)=>[T[3],T[4],T[5]]}})}getModelParams(){const{opacityLinear:o={enable:!1}}=this.layer.getLayerConfig();return o.enable?{frag:E0,vert:Bv,type:"polygonLinear",triangulation:G2}:{frag:sA,vert:iP,type:"polygonFill",triangulation:Og}}}const _E=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,oP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class cA extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture1",void 0),(0,Kt.Z)(this,"texture2",void 0),(0,Kt.Z)(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{watercolor:o="#6D99A8",watercolor2:f="#0F121C"}=this.layer.getLayerConfig(),v={u_watercolor:(0,Pe.CI)(o),u_watercolor2:(0,Pe.CI)(f),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(v)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:oP,fragmentShader:_E,defines:o.getDefines(),inject:o.getInject(),triangulation:Og,primitive:K.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var o,f,v;(o=this.texture1)===null||o===void 0||o.destroy(),(f=this.texture2)===null||f===void 0||f.destroy(),(v=this.texture3)===null||v===void 0||v.destroy()}registerBuiltinAttributes(){const o=this.layer.getSource().extent,[f,v,T,O]=o,L=T-f,F=O-v;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:K.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(H,ie,xe)=>{const[Ee,Ye]=xe;return[(Ee-f)/L,(Ye-v)/F]}}})}loadTexture(){const{createTexture2D:o}=this.rendererService,f={height:0,width:0};this.texture1=o(f),this.texture2=o(f),this.texture3=o(f),v(O=>{this.texture1=T(O[0]),this.texture2=T(O[1]),this.texture3=T(O[2]),this.layerService.reRender()});function v(O){let L=0;const F=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(ie=>{const xe=new Image;xe.crossOrigin="",xe.src=ie,F.push(xe),xe.onload=()=>{L++,L===3&&O(F)}})}function T(O){return o({data:O,width:O.width,height:O.height,wrapS:K.gl.MIRRORED_REPEAT,wrapT:K.gl.MIRRORED_REPEAT,min:K.gl.LINEAR,mag:K.gl.LINEAR})}}}const bE=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,xE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class uA extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{speed:o=.5}=this.layer.getLayerConfig(),f={u_speed:o,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(f)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.loadTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:xE,fragmentShader:bE,triangulation:Og,defines:o.getDefines(),inject:o.getInject(),primitive:K.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){const o=this.layer.getSource().extent,[f,v,T,O]=o,L=T-f,F=O-v;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:K.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(H,ie,xe)=>{const[Ee,Ye]=xe;return[(Ee-f)/L,(Ye-v)/F]}}})}loadTexture(){const{waterTexture:o}=this.layer.getLayerConfig(),{createTexture2D:f}=this.rendererService;this.texture=f({height:1,width:1});const v=new Image;v.crossOrigin="",o?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),v.src=o):v.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",v.onload=()=>{this.texture=f({data:v,width:v.width,height:v.height,wrapS:K.gl.MIRRORED_REPEAT,wrapT:K.gl.MIRRORED_REPEAT,min:K.gl.LINEAR,mag:K.gl.LINEAR}),this.layerService.reRender()}}}var Mg={fill:lA,line:$w,extrude:oA,text:e_,point_fill:Qw,point_image:uo,point_normal:K1,point_extrude:Nv,water:uA,ocean:cA,extrusion:aA};class zy extends $0{constructor(...o){super(...o),(0,Kt.Z)(this,"type","PolygonLayer"),(0,Kt.Z)(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var o=this;return(0,Ti.Z)(function*(){const f=o.getModelType();o.layerModel=new Mg[f](o),yield o.initLayerModels()})()}getModelType(){var o;const f=this.styleAttributeService.getLayerStyleAttribute("shape"),v=f==null||(o=f.scale)===null||o===void 0?void 0:o.field;return v==="fill"||!v?"fill":v==="extrude"?"extrude":v==="extrusion"?"extrusion":v==="water"?"water":v==="ocean"?"ocean":v==="line"?"line":this.getPointModelType()}getPointModelType(){const o=this.getEncodedData(),{shape2d:f,shape3d:v}=this.getLayerConfig(),T=this.iconService.getIconMap(),O=o.find(L=>L.hasOwnProperty("shape"));if(O){const L=O.shape;return L==="dot"?"point_normal":(f==null?void 0:f.indexOf(L))!==-1?"point_fill":(v==null?void 0:v.indexOf(L))!==-1?"point_extrude":T.hasOwnProperty(L)?"point_image":"text"}else return"fill"}}class EE{constructor({rendererService:o,layerService:f,parent:v}){(0,Kt.Z)(this,"tileResource",new Map),(0,Kt.Z)(this,"rendererService",void 0),(0,Kt.Z)(this,"layerService",void 0),(0,Kt.Z)(this,"parent",void 0),(0,Kt.Z)(this,"layerTiles",[]),this.rendererService=o,this.layerService=f,this.parent=v}get tiles(){return this.layerTiles}hasTile(o){return this.layerTiles.some(f=>f.key===o)}addTile(o){this.layerTiles.push(o)}getTile(o){return this.layerTiles.find(f=>f.key===o)}getVisibleTileBylngLat(o){return this.layerTiles.find(f=>f.isLoaded&&f.visible&&f.lnglatInBounds(o))}removeTile(o){const f=this.layerTiles.findIndex(T=>T.key===o),v=this.layerTiles.splice(f,1);v[0]&&v[0].destroy()}updateTileVisible(o){const f=this.getTile(o.key);if(o.isVisible)if(o.parent){const v=this.isChildrenLoaded(o.parent);f==null||f.updateVisible(v)}else f==null||f.updateVisible(!0);else if(o.parent){const v=this.isChildrenLoaded(o.parent);f==null||f.updateVisible(!v)}else f==null||f.updateVisible(!1)}isParentLoaded(o){const f=o.parent;if(!f)return!0;const v=this.getTile(f==null?void 0:f.key);return!!(v!=null&&v.isLoaded)}isChildrenLoaded(o){const f=o==null?void 0:o.children;return f.length===0?!0:f.every(v=>{const T=this.getTile(v==null?void 0:v.key);return T?(T==null?void 0:T.isLoaded)===!0:!0})}render(){var o=this;return(0,Ti.Z)(function*(){const v=o.getRenderLayers().map(function(){var T=(0,Ti.Z)(function*(O){yield o.layerService.renderTileLayer(O)});return function(O){return T.apply(this,arguments)}}());yield Promise.all(v)})()}getRenderLayers(){const o=this.layerTiles.filter(v=>v.visible&&v.isLoaded),f=[];return o.map(v=>f.push(...v.getLayers())),f}getLayers(){const o=this.layerTiles.filter(v=>v.isLoaded),f=[];return o.map(v=>f.push(...v.getLayers())),f}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(o=>o.destroy()),this.tileResource.clear()}}var up=D(32676);function Ol(a,o,f){f===void 0&&(f={});var v=Xe(a),T=Xe(o),O=up.union(v.coordinates,T.coordinates);return O.length===0?null:O.length===1?(0,Ct.yu)(O[0],f.properties):(0,Ct.tw)(O,f.properties)}var sP=Ol;class lP{getCombineFeature(o){let f=null;const v=o[0];return o.map(T=>{const O=Ct.yu(T.coordinates);f===null?f=O:f=sP(f,O)}),v&&(f.properties=(0,Cr.Z)({},v)),f}}const Uy="select",Pg="active";class jy{constructor({layerService:o,tileLayerService:f,parent:v}){(0,Kt.Z)(this,"layerService",void 0),(0,Kt.Z)(this,"tileLayerService",void 0),(0,Kt.Z)(this,"tileSourceService",void 0),(0,Kt.Z)(this,"parent",void 0),(0,Kt.Z)(this,"tilePickID",new Map),this.layerService=o,this.tileLayerService=f,this.parent=v,this.tileSourceService=new lP}pickRender(o){const f=this.tileLayerService.getVisibleTileBylngLat(o.lngLat);if(f){const v=f.getMainLayer();v==null||v.layerPickService.pickRender(o)}}pick(o,f){var v=this;return(0,Ti.Z)(function*(){const O=v.parent.getContainer().pickingService;if(o.type==="RasterLayer"){const L=v.tileLayerService.getVisibleTileBylngLat(f.lngLat);if(L&&L.getMainLayer()!==void 0){const F=L.getMainLayer();return F.layerPickService.pickRasterLayer(F,f,v.parent)}return!1}return v.pickRender(f),O.pickFromPickingFBO(o,f)})()}selectFeature(o){const[f,v,T]=o,O=this.color2PickId(f,v,T);this.tilePickID.set(Uy,O),this.updateHighLight(f,v,T,Uy)}highlightPickedFeature(o){const[f,v,T]=o,O=this.color2PickId(f,v,T);this.tilePickID.set(Pg,O),this.updateHighLight(f,v,T,Pg)}updateHighLight(o,f,v,T){this.tileLayerService.tiles.map(O=>{const L=O.getMainLayer();switch(T){case Uy:L==null||L.hooks.beforeSelect.call([o,f,v]);break;case Pg:L==null||L.hooks.beforeHighlight.call([o,f,v]);break}})}setPickState(){const o=this.tilePickID.get(Uy),f=this.tilePickID.get(Pg);if(o){const[v,T,O]=this.pickId2Color(o);this.updateHighLight(v,T,O,Uy);return}if(f){const[v,T,O]=this.pickId2Color(f);this.updateHighLight(v,T,O,Pg);return}}color2PickId(o,f,v){return(0,Pe.W0)(new Uint8Array([o,f,v]))}pickId2Color(o){return(0,Pe.Z6)(o)}getFeatureById(o){const f=this.tileLayerService.getTiles().filter(T=>T.visible),v=[];return f.forEach(T=>{v.push(...T.getFeatureById(o))}),v}pickRasterLayer(){return!1}}const SE=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,Lb=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Vy(a){const o=a.coordinates;return{vertices:[...o],indices:[0],size:o.length}}class r_ extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:o,strokeOpacity:f=1,strokeWidth:v=0,stroke:T="#fff"}=this.layer.getLayerConfig(),O={u_stroke_color:(0,Pe.CI)(T),u_additive:o==="additive"?1:0,u_stroke_opacity:f,u_stroke_width:v};return this.getUniformsBufferInfo(O)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.layer.triangulation=Vy,o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:Lb,fragmentShader:SE,defines:o.getDefines(),inject:o.getInject(),triangulation:Vy,depth:{enable:!1},primitive:K.gl.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=1}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}const fA=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,TE=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    //
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:pc}=Pe.lodashUtil;class Nl extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"raiseCount",0),(0,Kt.Z)(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:o={enable:!1,speed:.01,repeat:!1},opacity:f=1,sourceColor:v,targetColor:T,pickLight:O=!1,heightfixed:L=!0,opacityLinear:F={enable:!1,dir:"up"},lightEnable:H=!0}=this.layer.getLayerConfig();let ie=0,xe=[0,0,0,0],Ee=[0,0,0,0];if(v&&T&&(xe=(0,Pe.CI)(v),Ee=(0,Pe.CI)(T),ie=1),this.raiseCount<1&&this.raiseRepeat>0&&o.enable){const{speed:an=.01}=o;this.raiseCount+=an,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const Ye={u_sourceColor:xe,u_targetColor:Ee,u_linearColor:ie,u_pickLight:Number(O),u_heightfixed:Number(L),u_r:o.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:pc(f)?f:1,u_opacitylinear:Number(F.enable),u_opacitylinear_dir:F.dir==="up"?1:0,u_lightEnable:Number(H)};return this.getUniformsBufferInfo(Ye)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){const{animateOption:{repeat:f=1}}=o.layer.getLayerConfig();return o.raiseRepeat=f,[yield o.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:TE,fragmentShader:fA,triangulation:Z2,depth:{enable:!0},defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:K.gl.FRONT},blend:o.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:o=>{const{size:f}=o;if(f){let v=[];return Array.isArray(f)&&(v=f.length===2?[f[0],f[0],f[1]]:f),Array.isArray(f)||(v=[f,f,f]),v}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:K.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:K.gl.STATIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T,O)=>O}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:K.GC.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:o=>{const f=(0,Pe.SI)(o.coordinates);return Um([f[0],f[1]])}}})}}const Hy=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,wE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;class Zy extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:o=1,strokeWidth:f=0,blend:v,blur:T=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const O={u_additive:v==="additive"?1:0,u_stroke_opacity:o,u_stroke_width:f,u_blur:T};return this.getUniformsBufferInfo(O)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.layer.triangulation=H2,[yield o.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:wE,fragmentShader:Hy,triangulation:H2,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!0},blend:o.getBlend()})]})()}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T)=>{const[O,L,F]=v,H=Jl.al(0,0,1),ie=Jl.al(O,0,F),xe=O>=0?Jl.EU(H,ie):Math.PI*2-Jl.EU(H,ie),Ee=Math.PI*2-Math.asin(L/100),Ye=Q0.create();Q0.rotateY(Ye,Ye,xe),Q0.rotateX(Ye,Ye,Ee);const Lt=Jl.al(1,1,0);Jl.fF(Lt,Lt,Ye),Jl.Fv(Lt,Lt);const an=Jl.al(-1,1,0);Jl.fF(an,an,Ye),Jl.Fv(an,an);const Pn=Jl.al(-1,-1,0);Jl.fF(Pn,Pn,Ye),Jl.Fv(Pn,Pn);const sr=Jl.al(1,-1,0);Jl.fF(sr,sr,Ye),Jl.Fv(sr,sr);const Rr=[...Lt,...an,...Pn,...sr],Tr=T%4*3;return[Rr[Tr],Rr[Tr+1],Rr[Tr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:K.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{shape:f=2}=o;return[this.layer.getLayerConfig().shape2d.indexOf(f)]}}})}}const AE=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,hA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Ig extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"meter2coord",1),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"isMeter",!1),(0,Kt.Z)(this,"radian",0),(0,Kt.Z)(this,"updateTexture",()=>{const{createTexture2D:f}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=f({data:this.iconService.getCanvas(),mag:K.gl.LINEAR,min:K.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:o=0,heightfixed:f=!1,unit:v="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var T;(T=this.texture)===null||T===void 0||T.bind()}const O={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(f),u_raisingHeight:Number(o),u_size_unit:iE[v]};return this.getUniformsBufferInfo(O)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Lv)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.iconService.on("imageUpdate",o.updateTexture),o.updateTexture(),o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:hA,fragmentShader:AE,triangulation:Lv,depth:{enable:!1},defines:o.getDefines(),inject:o.getInject(),cull:{enable:!0,face:K.gl.FRONT}})]})()}clearModels(){var o;this.iconService.off("imageUpdate",this.updateTexture),(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:o=>{const f=this.iconService.getIconMap(),{shape:v}=o,{x:T,y:O}=f[v]||{x:-64,y:-64};return[T,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T)=>{const O=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],L=T%4*3;return[O[L],O[L+1],O[L+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}const CE=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,cP=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class dA extends Cl{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:o,speed:f=1,unit:v="pixel"}=this.layer.getLayerConfig(),T={u_additive:o==="additive"?1:0,u_size_unit:iE[v],u_speed:f,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(T)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Lv)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:cP,fragmentShader:CE,triangulation:Lv,defines:o.getDefines(),inject:o.getInject(),depth:{enable:!1}})]})()}animateOption2Array(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:K.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:3,update:(o,f,v,T)=>{const O=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],L=T%4*3;return[O[L],O[L+1],O[L+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:K.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:1,update:o=>{const{size:f=5}=o;return Array.isArray(f)?[f[0]]:[f]}}})}}var Nb={fillImage:Ig,fill:Qw,radar:dA,image:uo,normal:K1,simplePoint:r_,extrude:Nv,text:e_,earthFill:Zy,earthExtrude:Nl};class Bb extends $0{constructor(...o){super(...o),(0,Kt.Z)(this,"type","PointLayer"),(0,Kt.Z)(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,Kt.Z)(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,Kt.Z)(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var o=this;return(0,Ti.Z)(function*(){const f=o.getModelType();o.layerModel&&o.layerModel.clearModels(),o.layerModel=new Nb[f](o),yield o.initLayerModels()})()}rebuildModels(){var o=this;return(0,Ti.Z)(function*(){yield o.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:o,values:f}=this.shapeOption,{shape2d:v}=this.getLayerConfig(),T=this.iconService.getIconMap();if(o&&(v==null?void 0:v.indexOf(o))!==-1)return"fill";if(f==="text")return"text";if(f&&f instanceof Array){for(const O of f)if(typeof O=="string"&&T.hasOwnProperty(O))return"image"}}return"normal"}getDefaultConfig(){const o=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[o]}getModelType(){const o=this.getEncodedData(),{shape2d:f,shape3d:v,billboard:T=!0}=this.getLayerConfig(),O=this.iconService.getIconMap(),L=o.find(F=>F.hasOwnProperty("shape"));if(L){const F=L.shape;return F==="dot"?"normal":F==="simple"?"simplePoint":F==="radar"?"radar":this.layerType==="fillImage"||T===!1?"fillImage":(f==null?void 0:f.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(v==null?void 0:v.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":O.hasOwnProperty(F)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function OE(a){return a==="PolygonLayer"?zy:a==="LineLayer"?Fy:Bb}function Wy(a){return["PolygonLayer","LineLayer"].indexOf(a)!==-1}class cd extends Fc.EventEmitter{constructor(o,f){super(),(0,Kt.Z)(this,"x",void 0),(0,Kt.Z)(this,"y",void 0),(0,Kt.Z)(this,"z",void 0),(0,Kt.Z)(this,"key",void 0),(0,Kt.Z)(this,"parent",void 0),(0,Kt.Z)(this,"sourceTile",void 0),(0,Kt.Z)(this,"visible",!0),(0,Kt.Z)(this,"layers",[]),(0,Kt.Z)(this,"isLoaded",!1),(0,Kt.Z)(this,"tileMaskLayers",[]),(0,Kt.Z)(this,"tileMask",void 0),this.parent=f,this.sourceTile=o,this.x=o.x,this.y=o.y,this.z=o.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...o){}lnglatInBounds(o){const[f,v,T,O]=this.sourceTile.bounds,{lng:L,lat:F}=o;return L>=f&&L<=T&&F>=v&&F<=O}getLayerOptions(){var o;const f=this.parent.getLayerConfig();return(0,Cr.Z)((0,Cr.Z)({},f),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:Wy(this.parent.type),mask:f.mask||((o=f.maskLayers)===null||o===void 0?void 0:o.length)!==0&&f.enableMask})}getMaskLayer(){const{maskLayers:o}=this.parent.getLayerConfig(),f=[];return o==null||o.forEach(v=>{if(!v.tileLayer)return f.push(v),v;const O=v.tileLayer.getTile(this.sourceTile.key),L=O==null?void 0:O.getLayers()[0];L&&f.push(L)}),f}addTileMask(){var o=this;return(0,Ti.Z)(function*(){const f=new zy({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[o.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),v=(0,K.e7)(o.parent.container);f.setContainer(v),yield f.init(),o.tileMask=f;const T=o.getMainLayer();return T!==void 0&&(T.tileMask=f),f})()}addMask(o,f){var v=this;return(0,Ti.Z)(function*(){const T=(0,K.e7)(v.parent.container);f.setContainer(T),yield f.init(),o.addMask(f),v.tileMaskLayers.push(f)})()}addLayer(o){var f=this;return(0,Ti.Z)(function*(){o.isTileLayer=!0;const v=(0,K.e7)(f.parent.container);o.setContainer(v),f.layers.push(o),yield o.init()})()}updateVisible(o){this.visible=o,this.updateOptions("visible",o)}updateOptions(o,f){this.layers.forEach(v=>{v.updateLayerConfig({[o]:f})})}getMainLayer(){return this.layers[0]}getFeatures(o){return[]}getFeatureById(o){return[]}destroy(){var o;(o=this.tileMask)===null||o===void 0||o.destroy(),this.layers.forEach(f=>f.destroy())}}class i_ extends cd{initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.getSourceOption(),v=f.data.features[0].properties,T=new Fy().source(f.data,f.options).size(1).shape("line").color("red"),O=new Bb({minZoom:o.z-1,maxZoom:o.z+1,textAllowOverlap:!0}).source([v],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(o.key).style({stroke:"#fff",strokeWidth:2});yield o.addLayer(T),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:o.transforms}}}}const pA=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,RE=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Lg extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:o,brightness:f,contrast:v,saturation:T,gamma:O}=this.layer.getLayerConfig(),L={u_opacity:(0,Pe.LS)(o,1),u_brightness:(0,Pe.LS)(f,1),u_contrast:(0,Pe.LS)(v,1),u_saturation:(0,Pe.LS)(T,1),u_gamma:(0,Pe.LS)(O,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(L)}initModels(){var o=this;return(0,Ti.Z)(function*(){return yield o.loadTexture(),o.buildModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}loadTexture(){var o=this;return(0,Ti.Z)(function*(){const{createTexture2D:f}=o.rendererService,T=yield o.layer.getSource().data.images;o.texture=f({data:T[0],width:T[0].width,height:T[0].height,mag:K.gl.LINEAR,min:K.gl.LINEAR})})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:RE,fragmentShader:pA,defines:o.getDefines(),triangulation:X1,primitive:K.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}var ME={image:Lg};class PE extends $0{constructor(...o){super(...o),(0,Kt.Z)(this,"type","ImageLayer")}buildModels(){var o=this;return(0,Ti.Z)(function*(){const f=o.getModelType();o.layerModel=new ME[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{image:{}}[o]}getModelType(){return"image"}}class mA extends cd{initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new PE((0,Cr.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}const vA=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,Zp=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class gA extends Cl{getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,color:f="#000"}=this.layer.getLayerConfig(),v={u_color:(0,Pe.CI)(f),u_opacity:o||1};return this.getUniformsBufferInfo(v)}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initUniformsBuffer(),[yield o.layer.buildLayerModel({moduleName:"mask",vertexShader:Zp,fragmentShader:vA,defines:o.getDefines(),triangulation:Og,depth:{enable:!1},pick:!1})]})()}clearModels(o=!0){o&&this.layerService.clear()}registerBuiltinAttributes(){return""}}var em={fill:gA};class IE extends $0{constructor(...o){super(...o),(0,Kt.Z)(this,"type","MaskLayer")}buildModels(){var o=this;return(0,Ti.Z)(function*(){const f=o.getModelType();o.layerModel=new em[f](o),yield o.initLayerModels()})()}getModelType(){return"fill"}}class LE extends cd{initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new IE((0,Cr.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getFeatures(o){return o?this.sourceTile.data.getTileData(o):[]}getSourceOption(){const o=this.parent.getSource(),{sourceLayer:f,featureId:v}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(f)},options:{parser:{type:"geojson",featureId:v},transforms:o.transforms}}}}function _A(a,o){return{type:a.type,field:"value",items:a.positions.map((f,v)=>({[o]:v>=a.colors.length?null:a.colors[v],value:f}))}}const bA=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,Mf=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Lh extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,clampLow:f=!0,clampHigh:v=!0,noDataValue:T=-9999999,domain:O,rampColors:L}=this.layer.getLayerConfig(),F=O||(0,Pe.ZB)(L);this.colorTexture=this.layer.textureService.getColorTexture(L,F);const H={u_domain:F,u_opacity:o||1,u_noDataValue:T,u_clampLow:f?1:0,u_clampHigh:(typeof v!="undefined"?v:f)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(H)}getRasterData(o){return(0,Ti.Z)(function*(){if(Array.isArray(o.data))return{data:o.data,width:o.width,height:o.height};{const{rasterData:f,width:v,height:T}=yield o.data;return{data:Array.from(f),width:v,height:T}}})()}initModels(){var o=this;return(0,Ti.Z)(function*(){return o.buildModels()})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v,queryVerdorInfo:T}=o.rendererService,O=f.data.dataArray[0],{data:L,width:F,height:H}=yield o.getRasterData(O);return o.texture=v({data:new Float32Array(L),width:F,height:H,format:T()==="WebGL1"?K.gl.LUMINANCE:K.gl.RED,type:K.gl.FLOAT,alignment:1}),[yield o.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:Mf,fragmentShader:bA,defines:o.getDefines(),triangulation:X1,primitive:K.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var o,f;(o=this.texture)===null||o===void 0||o.destroy(),(f=this.colorTexture)===null||f===void 0||f.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}const xA=["data"],Fb=["rasterData"],EA=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,SA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class TA extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0),(0,Kt.Z)(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const o=this.getCommonUniformsInfo(),f=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,Cr.Z)((0,Cr.Z)({},o.uniformsOption),f.uniformsOption)}getCommonUniformsInfo(){const{opacity:o=1,noDataValue:f=0}=this.layer.getLayerConfig(),{rMinMax:v=[0,255],gMinMax:T=[0,255],bMinMax:O=[0,255]}=this.dataOption,L={u_rminmax:v,u_gminmax:T,u_bminmax:O,u_opacity:o||1,u_noDataValue:f,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(L)}getRasterData(o){var f=this;return(0,Ti.Z)(function*(){if(Array.isArray(o.data)){const{data:L}=o,F=(0,ml.Z)(o,xA);return f.dataOption=F,(0,Cr.Z)({data:L},F)}const v=yield o.data,{rasterData:T}=v,O=(0,ml.Z)(v,Fb);return f.dataOption=O,Array.isArray(T)?(0,Cr.Z)({data:T},O):(0,Cr.Z)({data:Array.from(T)},O)})()}initModels(){var o=this;return(0,Ti.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v}=o.rendererService,T=f.data.dataArray[0],{data:O,width:L,height:F}=yield o.getRasterData(T);return o.texture=v({data:new Float32Array(O),width:L,height:F,format:K.gl.RGB,type:K.gl.FLOAT}),[yield o.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:SA,fragmentShader:EA,defines:o.getDefines(),triangulation:X1,primitive:K.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initModels()})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}const es=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,wA=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class fp extends Cl{constructor(...o){super(...o),(0,Kt.Z)(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:o,clampLow:f=!0,clampHigh:v=!0,noDataValue:T=-9999999,domain:O,rampColors:L,colorTexture:F,rScaler:H=6553.6,gScaler:ie=25.6,bScaler:xe=.1,offset:Ee=1e4}=this.layer.getLayerConfig(),Ye=O||(0,Pe.ZB)(L);let Lt=F;F?this.layer.textureService.setColorTexture(F,L,Ye):Lt=this.layer.textureService.getColorTexture(L,Ye);const an={u_unpack:[H,ie,xe,Ee],u_domain:Ye,u_opacity:o||1,u_noDataValue:T,u_clampLow:f,u_clampHigh:typeof v!="undefined"?v:f,u_texture:this.texture,u_colorTexture:Lt};return this.textures=[this.texture,Lt],this.getUniformsBufferInfo(an)}initModels(){var o=this;return(0,Ti.Z)(function*(){o.initUniformsBuffer();const f=o.layer.getSource(),{createTexture2D:v}=o.rendererService,T=yield f.data.images;return o.texture=v({data:T[0],width:T[0].width,height:T[0].height,min:K.gl.LINEAR,mag:K.gl.LINEAR}),[yield o.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:wA,fragmentShader:es,defines:o.getDefines(),triangulation:X1,primitive:K.gl.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var o;(o=this.texture)===null||o===void 0||o.destroy()}buildModels(){var o=this;return(0,Ti.Z)(function*(){return o.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:K.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:K.gl.DYNAMIC_DRAW,data:[],type:K.gl.FLOAT},size:2,update:(o,f,v)=>[v[3],v[4]]}})}}var fP={raster:Lh,rasterRgb:TA,raster3d:Lh,rasterTerrainRgb:fp};class NE extends $0{constructor(...o){super(...o),(0,Kt.Z)(this,"type","RasterLayer")}buildModels(){var o=this;return(0,Ti.Z)(function*(){const f=o.getModelType();o.layerModel=new fP[f](o),yield o.initLayerModels()})()}getDefaultConfig(){const o=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[o]}getModelType(){switch(this.layerSource.getParserType()){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(o){if(o!=="color")return{type:void 0,field:void 0,items:[]};const f=this.getLayerConfig().rampColors;return _A(f,o)}}const Bl=["rasterData"];class Dh extends cd{initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new NE((0,Cr.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource(),f=this.sourceTile.data.data,{rasterData:v}=f,T=(0,ml.Z)(f,Bl);return{data:v,options:{parser:(0,Cr.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},T),transforms:o.transforms}}}}class tm extends cd{initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),O=new NE((0,Cr.Z)({},v)).source(T.data,T.options);f&&Object.keys(f).forEach(L=>{var F,H;const ie=L;O[ie]((F=f[ie])===null||F===void 0?void 0:F.field,(H=f[ie])===null||H===void 0?void 0:H.values)}),yield o.addLayer(O),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}const Gy=["rasterData"],kb={positions:[0,1],colors:["#000","#fff"]};class Fv extends cd{constructor(...o){super(...o),(0,Kt.Z)(this,"colorTexture",void 0)}initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=o.getSourceOption(),{rampColors:O,domain:L}=o.getLayerOptions();o.colorTexture=o.parent.textureService.getColorTexture(O,L);const F=new NE((0,Cr.Z)((0,Cr.Z)({},v),{},{colorTexture:o.colorTexture})).source(T.data,T.options);f&&Object.keys(f).forEach(H=>{var ie,xe;const Ee=H;F[Ee]((ie=f[Ee])===null||ie===void 0?void 0:ie.field,(xe=f[Ee])===null||xe===void 0?void 0:xe.values)}),yield o.addLayer(F),o.isLoaded=!0})()}getSourceOption(){const o=this.parent.getSource(),f=this.sourceTile.data.data,{rasterData:v}=f,T=(0,ml.Z)(f,Gy);return{data:v,options:{parser:(0,Cr.Z)({type:"raster",extent:this.sourceTile.bounds},T),transforms:o.transforms}}}styleUpdate(...o){const{rampColors:f=kb,domain:v}=o;this.colorTexture=this.parent.textureService.getColorTexture(f,v||(0,Pe.ZB)(f)),this.layers.forEach(T=>T.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(o=>o.destroy())}}class S0 extends cd{initTileLayer(){var o=this;return(0,Ti.Z)(function*(){const f=o.parent.getLayerAttributeConfig(),v=o.getLayerOptions(),T=OE(o.parent.type),O=o.getSourceOption();if(!O){o.isLoaded=!0,o.emit("loaded");return}const L=new T((0,Cr.Z)({},v)).source(O.data,O.options);Object.keys(f).forEach(F=>{var H,ie;const xe=F;L[xe]((H=f[xe])===null||H===void 0?void 0:H.field,(ie=f[xe])===null||ie===void 0?void 0:ie.values)}),yield o.addLayer(L),v.tileMask&&(yield o.addTileMask()),o.setLayerMinMaxZoom(L),o.isLoaded=!0,o.emit("loaded")})()}getSourceOption(){const o=this.parent.getSource(),{sourceLayer:f="defaultLayer",featureId:v="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(f)},options:{parser:{type:"geojson",featureId:v},transforms:o.transforms}}}setLayerMinMaxZoom(o){o.getModelType()==="text"&&o.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(o){return this.sourceTile.data.getTileData(o)}getFeatureById(o){const f=this.getMainLayer();return f?f.getSource().data.dataArray.filter(T=>T._id===o):[]}}function Xy(a){switch(a.type){case"PolygonLayer":return S0;case"LineLayer":return S0;case"PointLayer":return S0;case"TileDebugLayer":return i_;case"MaskLayer":return LE;case"RasterLayer":const{dataType:f}=a.getSource().parser;switch(f){case K.n3.RGB:case K.n3.CUSTOMRGB:return Dh;case K.n3.ARRAYBUFFER:case K.n3.CUSTOMARRAYBUFFER:return Fv;case K.n3.TERRAINRGB:case K.n3.CUSTOMTERRAINRGB:return tm;default:return mA}default:return S0}}const BE=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:hP}=Pe.lodashUtil;class AA{constructor(o){(0,Kt.Z)(this,"parent",void 0),(0,Kt.Z)(this,"tileLayerService",void 0),(0,Kt.Z)(this,"mapService",void 0),(0,Kt.Z)(this,"layerService",void 0),(0,Kt.Z)(this,"rendererService",void 0),(0,Kt.Z)(this,"pickingService",void 0),(0,Kt.Z)(this,"tilePickService",void 0),(0,Kt.Z)(this,"tilesetManager",void 0),(0,Kt.Z)(this,"initedTileset",!1),(0,Kt.Z)(this,"lastViewStates",void 0),(0,Kt.Z)(this,"mapchange",()=>{var v;if(this.parent.isVisible()===!1)return;const{latLonBounds:T,zoom:O}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===O&&this.lastViewStates.latLonBounds.toString()===T.toString()||(this.lastViewStates={zoom:O,latLonBounds:T},(v=this.tilesetManager)===null||v===void 0||v.throttleUpdate(O,T))}),(0,Kt.Z)(this,"viewchange",hP(this.mapchange,24)),this.parent=o;const f=this.parent.getContainer();this.rendererService=f.rendererService,this.layerService=f.layerService,this.mapService=f.mapService,this.pickingService=f.pickingService,this.tileLayerService=new EE({rendererService:this.rendererService,layerService:this.layerService,parent:o}),this.tilePickService=new jy({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:o}),this.parent.setLayerPickService(this.tilePickService),this.proxy(o),this.initTileSetManager()}initTileSetManager(){var o;const f=this.parent.getSource();if(this.tilesetManager=f.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:v,zoom:T}=this.getCurrentView();(o=this.tilesetManager)===null||o===void 0||o.update(T,v)}getCurrentView(){const o=this.mapService.getBounds(),f=[o[0][0],o[0][1],o[1][0],o[1][1]],v=this.mapService.getZoom();return{latLonBounds:f,zoom:v}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",o=>{}),this.tilesetManager.on("tile-unload",o=>{this.tileUnLoad(o)}),this.tilesetManager.on("tile-error",(o,f)=>{this.tileError(o)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(o){return this.tileLayerService.getTile(o)}tileLoaded(o){}tileError(o){console.warn("error:",o)}destroy(){var o;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(o=this.tilesetManager)===null||o===void 0||o.destroy(),this.tileLayerService.destroy()}reload(){var o;this.tilesetManager.clear();const{latLonBounds:f,zoom:v}=this.getCurrentView();(o=this.tilesetManager)===null||o===void 0||o.update(v,f)}tileUnLoad(o){this.tileLayerService.removeTile(o.key)}tileUpdate(){var o=this;return(0,Ti.Z)(function*(){if(!o.tilesetManager)return;const f=o.parent.getMinZoom(),v=o.parent.getMaxZoom(),T=o.tilesetManager.tiles.filter(O=>O.isLoaded).filter(O=>O.isVisibleChange).filter(O=>O.data).filter(O=>O.z>=f&&O.z<v);yield Promise.all(T.map(function(){var O=(0,Ti.Z)(function*(L){if(o.tileLayerService.hasTile(L.key))o.tileLayerService.updateTileVisible(L),o.tilePickService.setPickState(),o.layerService.reRender();else{const F=Xy(o.parent),H=new F(L,o.parent);yield H.initTileLayer(),o.tilePickService.setPickState(),H.getLayers().length!==0&&(o.tileLayerService.addTile(H),o.tileLayerService.updateTileVisible(L),o.layerService.reRender())}});return function(L){return O.apply(this,arguments)}}())),o.tilesetManager.isLoaded&&o.parent.emit("tiles-loaded",o.tilesetManager.currentTiles)})()}setPickState(o){}pickRender(o){this.tilePickService.pickRender(o)}selectFeature(o){this.tilePickService.selectFeature(o)}highlightPickedFeature(o){this.tilePickService.highlightPickedFeature(o)}proxy(o){BE.forEach(f=>{const v=o[f].bind(o);o[f]=(...T)=>(v(...T),this.getLayers().map(O=>{O[f](...T)}),f==="style"&&this.getTiles().forEach(O=>O.styleUpdate(...T)),o)})}}class Yy extends null{constructor(...o){super(...o),_defineProperty(this,"isMoving",!1),_defineProperty(this,"maskLayer",void 0),_defineProperty(this,"move",f=>{switch(f.stopPropagation(),f.type){case"touchcancel":case"touchend":case"mouseup":{var v;this.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(T=>{document.removeEventListener(T,this.move)}),(v=this.scene)===null||v===void 0||v.render();break}case"mousedown":case"touchstart":this.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(T=>{document.addEventListener(T,this.move)});case"mousemove":case"touchmove":{if(this.isMoving)if(this.controlOption.orientation==="vertical"){let T;if("pageX"in f?T=f.pageX:f.touches&&f.touches.length&&f.touches[0].pageX?T=f.touches[0].pageX:f.changedTouches&&f.changedTouches.length&&(T=f.changedTouches[0].pageX),!T)break;const O=this.getContainerDOMRect(),L=this.getContainerSize(),F=L[0],H=(O==null?void 0:O.left)||0,ie=T-H+window.scrollX-document.documentElement.clientLeft,xe=F-Math.min(Math.max(0,F-ie),F),Ee=xe/F;this.setOptions({ratio:Ee}),this.emit("moving",{size:[xe,L[1]],ratio:[Ee,0]})}else{let T;if("pageY"in f?T=f.pageY:f.touches&&f.touches.length&&f.touches[0].pageY?T=f.touches[0].pageY:f.changedTouches&&f.changedTouches.length&&(T=f.changedTouches[0].pageY),!T)break;const O=this.getContainerDOMRect(),L=this.getContainerSize(),F=L[1],H=(O==null?void 0:O.top)||0,ie=T-H+window.scrollY-document.documentElement.clientTop,xe=F-Math.min(Math.max(0,F-ie),F),Ee=xe/F;this.setOptions({ratio:Ee}),this.emit("moving",{size:[L[0],xe],ratio:[0,Ee]})}break}default:break}}),_defineProperty(this,"getMaskLayer",()=>(console.log(this.getMaskGeoData()),new PolygonLayer({visible:!1}).source(this.getMaskGeoData()).shape("fill").color("red").style({opacity:.1}))),_defineProperty(this,"updateMask",()=>{var f;if(!this.mapsService)return;const v=this.getMaskGeoData();(f=this.maskLayer)===null||f===void 0||f.setData(v)})}getDefault(){return _objectSpread(_objectSpread({},super.getDefault()),{},{layers:[],rightLayers:[],ratio:.5,orientation:"vertical"})}onAdd(){const o=DOM.create("div","l7-control-swipe");DOM.create("button","l7-control-swipe__button",o);const{orientation:f="vertical",ratio:v=.5}=this.controlOption;return f==="horizontal"?(o.style.top=v*100+"%",o.style.left=""):(o.style.left=v*100+"%",o.style.top=""),o.classList.add(f),o}addTo(o){this.mapsService=o.mapService,this.renderService=o.rendererService,this.layerService=o.layerService,this.controlService=o.controlService,this.configService=o.globalConfigService,this.scene=o.sceneService,this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd();const{className:f,style:v,layers:T,rightLayers:O}=this.controlOption;f&&this.setClassName(f),v&&this.setStyle(v),this.mapsService.getMarkerContainer().appendChild(this.container),this.maskLayer=this.getMaskLayer(),this.registerEvent();const L=createLayerContainer(o);return this.maskLayer.setContainer(L),this.scene.addLayer(this.maskLayer),this.addMaskToLayers(T,!1),this.addMaskToLayers(O,!0),this.emit("add",this),this}onRemove(){if(this.maskLayer){var o;const{layers:f,rightLayers:v}=this.controlOption;this.removeMaskFromLayers(f),this.removeMaskFromLayers(v),(o=this.layerService)===null||o===void 0||o.remove(this.maskLayer)}this.unRegisterEvent(),this.removeAllListeners()}show(){var o;const f=this.container;DOM.removeClass(f,"l7-control-swipe_hide");const{layers:v,rightLayers:T}=this.controlOption;v.forEach(O=>O.enableMask()),T.forEach(O=>O.enableMask()),(o=this.scene)===null||o===void 0||o.render(),this.isShow=!0,this.emit("show",this)}hide(){var o;const f=this.container;DOM.addClass(f,"l7-control-swipe_hide");const{layers:v,rightLayers:T}=this.controlOption;v.forEach(O=>O.disableMask()),T.forEach(O=>O.disableMask()),(o=this.scene)===null||o===void 0||o.render(),this.isShow=!1,this.emit("hide",this)}setOptions(o){const f=_objectSpread(_objectSpread({},this.controlOption),o);if(o.className&&this.setClassName(o.className),o.style&&this.setStyle(o.style),(o.orientation||o.ratio!==void 0)&&this.setOrientationAndRatio(f.orientation,f.ratio),o.layers){const v=o.layers,T=this.controlOption.layers;this.setLayers(v,T,!1)}if(o.rightLayers){const v=o.rightLayers,T=this.controlOption.rightLayers;this.setLayers(v,T,!0)}this.controlOption=f,this.updateMask()}registerEvent(){this.container.addEventListener("mousedown",this.move),this.container.addEventListener("touchstart",this.move),this.mapsService.on("camerachange",this.updateMask)}unRegisterEvent(){var o;this.container.removeEventListener("mousedown",this.move),this.container.removeEventListener("touchstart",this.move),(o=this.mapsService)===null||o===void 0||o.off("camerachange",this.updateMask)}setOrientationAndRatio(o="vertical",f=.5){this.container.classList.remove("horizontal","vertical"),this.container.classList.add(o),o==="horizontal"?(this.container.style.top=f*100+"%",this.container.style.left=""):(this.container.style.left=f*100+"%",this.container.style.top="")}setLayers(o,f,v=!1){const T=o.filter(L=>f.includes(L)===!1),O=f.filter(L=>o.includes(L)===!1);this.addMaskToLayers(T,v),this.removeMaskFromLayers(O)}addMaskToLayers(o,f){o.forEach(v=>{v.updateLayerConfig({maskInside:!f}),v.addMask(this.maskLayer)})}removeMaskFromLayers(o){o.forEach(f=>{f.updateLayerConfig({maskInside:!0}),f.removeMask(this.maskLayer)})}getMaskGeoData(){const{ratio:o=.5,orientation:f="vertical"}=this.controlOption,v=f==="vertical",[T,O]=this.getBounds(),[L,F]=T,[H,ie]=O;let xe;if(v){const Ye=L+(H-L)*o;xe=[[L,ie],[Ye,ie],[Ye,F],T,[L,ie]]}else{const Ye=this.getContainerSize(),an=this.mapsService.containerToLngLat([Ye[0],Ye[1]*o]).lat;xe=[[L,ie],O,[H,an],[L,an],[L,ie]]}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[xe]}}]}}getContainerDOMRect(){var o;return(o=this.mapsService.getContainer())===null||o===void 0?void 0:o.getBoundingClientRect()}getContainerSize(){return this.mapsService.getSize()}getBounds(){return this.mapsService.getBounds()}addLayer(o,f=!1){const v=Array.isArray(o)?o:[o];if(f){const T=this.controlOption.rightLayers.concat(...v);this.setOptions({rightLayers:T})}else{const T=this.controlOption.layers.concat(...v);this.setOptions({layers:T})}}removeLayer(o){const f=Array.isArray(o)?o:[o],v=this.controlOption.layers.filter(O=>f.includes(O)),T=this.controlOption.rightLayers.filter(O=>f.includes(O));this.setOptions({layers:v,rightLayers:T})}removeLayers(){this.setOptions({layers:[],rightLayers:[]})}}class CA extends null{constructor(...o){super(...o),_defineProperty(this,"disabled",void 0),_defineProperty(this,"zoomInButton",void 0),_defineProperty(this,"zoomOutButton",void 0),_defineProperty(this,"zoomNumDiv",void 0),_defineProperty(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),_defineProperty(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),_defineProperty(this,"updateDisabled",()=>{const f=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||f.getZoom()<=f.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(f.getZoom()))),(this.disabled||f.getZoom()>=f.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(o){return _objectSpread(_objectSpread({},super.getDefault(o)),{},{position:PositionType.BOTTOMRIGHT,name:"zoom",zoomInText:createL7Icon("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:createL7Icon("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(o){super.setOptions(o),this.checkUpdateOption(o,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const o=DOM.create("div","l7-control-zoom");return this.resetButtonGroup(o),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),o}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(o){DOM.clearChildren(o),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",o,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",o)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",o,this.zoomOut),this.updateDisabled()}createButton(o,f,v,T,O){const L=DOM.create("button",v,T);return typeof o=="string"?L.innerHTML=o:L.append(o),L.title=f,O&&L.addEventListener("click",O),L}}class zb extends Fc.EventEmitter{get lngLat(){var o;return(o=this.popupOption.lngLat)!==null&&o!==void 0?o:{lng:0,lat:0}}set lngLat(o){this.popupOption.lngLat=o}constructor(o){super(),(0,Kt.Z)(this,"popupOption",void 0),(0,Kt.Z)(this,"mapsService",void 0),(0,Kt.Z)(this,"sceneService",void 0),(0,Kt.Z)(this,"layerService",void 0),(0,Kt.Z)(this,"scene",void 0),(0,Kt.Z)(this,"closeButton",void 0),(0,Kt.Z)(this,"container",void 0),(0,Kt.Z)(this,"content",void 0),(0,Kt.Z)(this,"contentTitle",void 0),(0,Kt.Z)(this,"contentPanel",void 0),(0,Kt.Z)(this,"tip",void 0),(0,Kt.Z)(this,"isShow",!0),(0,Kt.Z)(this,"onMouseMove",v=>{var T;const O=this.mapsService.getMapContainer(),{left:L=0,top:F=0}=(T=O==null?void 0:O.getBoundingClientRect())!==null&&T!==void 0?T:{};this.setPopupPosition(v.clientX-L,v.clientY-F)}),(0,Kt.Z)(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:v,lat:T}=this.lngLat,{x:O,y:L}=this.mapsService.lngLatToContainer([v,T]);this.setPopupPosition(O,L)}),(0,Kt.Z)(this,"updateLngLatPositionWhenZoom",v=>{if(!this.mapsService||this.popupOption.followCursor)return;const T=v.map,O=T.getSize();O.x=O.x/2,O.y=O.y/2;const L=v.center,F=v.zoom,H=T.DE(this.lngLat,F,L);H.x=Math.round(H.x),H.y=Math.round(H.y),this.setPopupPosition(H.x,H.y,!0)}),(0,Kt.Z)(this,"onKeyDown",v=>{v.keyCode===27&&this.remove()}),(0,Kt.Z)(this,"onCloseButtonClick",v=>{v.stopPropagation&&v.stopPropagation(),this.hide()}),(0,Kt.Z)(this,"updatePosition",(v,T=!0)=>{const O=!!this.lngLat,{className:L,style:F,maxWidth:H,anchor:ie,stopPropagation:xe}=this.popupOption;if(!this.mapsService||!O||!this.content)return;const Ee=this.mapsService.getMarkerContainer();if(!this.container&&Ee&&(this.container=Pe.SO.create("div",`l7-popup ${L!=null?L:""} ${this.isShow?"":"l7-popup-hide"}`,Ee),F&&this.container.setAttribute("style",F),this.tip=Pe.SO.create("div","l7-popup-tip",this.container),this.container.appendChild(this.content),xe&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(Ye=>{this.container.addEventListener(Ye,Lt=>{Lt.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),T?this.updateLngLatPositionWhenZoom(v):this.updateLngLatPosition(),Pe.SO.setTransform(this.container,`${Pe.rQ[ie]}`),(0,Pe.zi)(this.container,ie,"popup"),H){const{width:Ye}=this.container.getBoundingClientRect();Ye>parseFloat(H)&&(this.container.style.width=H)}else this.container.style.removeProperty("width")}),(0,Kt.Z)(this,"updateWhenZoom",v=>{this.updatePosition(v,!0)}),(0,Kt.Z)(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=(0,Cr.Z)((0,Cr.Z)({},this.getDefault(o!=null?o:{})),o);const{lngLat:f}=this.popupOption;f&&(this.lngLat=f)}getIsShow(){return this.isShow}addTo(o){this.mapsService=o.mapService,this.sceneService=o.sceneService,this.layerService=o.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=o,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:f,text:v,title:T}=this.popupOption;return f?this.setHTML(f):v&&this.setText(v),T&&this.setTitle(T),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&Pe.SO.remove(this.content),this.container&&(Pe.SO.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(o){this.show();const{className:f}=this.popupOption;if(this.popupOption=(0,Cr.Z)((0,Cr.Z)({},this.popupOption),o),this.checkUpdateOption(o,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(Pe.SO.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(o,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(o,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(o,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(o,["html"])&&o.html?this.setHTML(o.html):this.checkUpdateOption(o,["text"])&&o.text&&this.setText(o.text),this.checkUpdateOption(o,["className"])){var v;f&&this.container.classList.remove(f!=null?f:""),this.container.classList.add((v=o.className)!==null&&v!==void 0?v:"")}if(this.checkUpdateOption(o,["style"])){var T;Pe.SO.addStyle(this.container,(T=o.style)!==null&&T!==void 0?T:"")}return this.checkUpdateOption(o,["lngLat"])&&o.lngLat&&this.setLnglat(o.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&Pe.SO.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&Pe.SO.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(o){return this.popupOption.html=o,this.setDOMContent(o)}setText(o){return this.popupOption.text=o,this.setDOMContent(window.document.createTextNode(o))}setTitle(o){this.show(),this.popupOption.title=o,o?(this.contentTitle||(this.contentTitle=Pe.SO.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),Pe.SO.clearChildren(this.contentTitle),Pe.SO.appendElementType(this.contentTitle,o)):this.contentTitle&&(Pe.SO.remove(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:o,lat:f}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([o,f]),this}setLngLat(o){return this.setLnglat(o)}setLnglat(o){return this.show(),this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(o){return this.popupOption.maxWidth=o,this.update(),this}isOpen(){return!!this.mapsService}getDefault(o){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:Pe.bV.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(o){return this.show(),this.createContent(),Pe.SO.appendElementType(this.contentPanel,o),this.update(),this}updateCloseOnClick(o){const f=this.mapsService;f&&(f==null||f.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!o&&requestAnimationFrame(()=>{f==null||f.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(o){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!o&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(o){var f;const v=(f=this.mapsService)===null||f===void 0?void 0:f.getContainer();v&&(v==null||v.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!o&&(v==null||v.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&Pe.SO.remove(this.content),this.contentTitle=void 0,this.content=Pe.SO.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const o=bl("l7-icon-guanbi");Pe.SO.addClass(o,"l7-popup-close-button"),this.content.appendChild(o),this.popupOption.closeButtonOffsets&&(o.style.right=this.popupOption.closeButtonOffsets[0]+"px",o.style.top=this.popupOption.closeButtonOffsets[1]+"px"),o.setAttribute("aria-label","Close popup"),o.addEventListener("click",()=>{this.hide()}),o.addEventListener("pointerup",f=>{f.stopPropagation()}),o.addEventListener("pointerdown",f=>{f.stopPropagation()}),this.closeButton=o}else this.closeButton=void 0;this.contentPanel=Pe.SO.create("div","l7-popup-content__panel",this.content)}setPopupPosition(o,f,v=!1){if(this.container){const{offsets:T}=this.popupOption;this.container.style.left=o+T[0]+"px",this.container.style.top=f-T[1]+"px",v?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(o,f){return f.some(v=>v in o)}}const{get:OA}=Pe.lodashUtil;class dP extends null{constructor(...o){super(...o),_defineProperty(this,"layerClickCountByFrame",0),_defineProperty(this,"layerConfigMap",new WeakMap),_defineProperty(this,"displayFeatureInfo",void 0),_defineProperty(this,"onLayerClick",(f,v)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(f,v.featureId))this.hide();else{const{title:T,content:O}=this.getLayerInfoFrag(f,v);this.setDOMContent(O),this.setLnglat(v.lngLat),this.setTitle(T),this.setDisplayFeatureInfo({layer:f,featureId:v.featureId}),this.show()}})}),_defineProperty(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),_defineProperty(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),_defineProperty(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var o;const{config:f,items:v}=this.popupOption;return(o=f!=null?f:v)!==null&&o!==void 0?o:[]}addTo(o){return super.addTo(o),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(o){this.unbindLayerEvent();const f=_objectSpread({},o),v=f.trigger||this.popupOption.trigger,T=f.items||this.popupOption.items,O=(T==null?void 0:T.length)===0;f.followCursor=v==="hover"&&!O;const L=this.isShow;return super.setOptions(f),this.bindLayerEvent(),(O||!L)&&this.hide(),this}getDefault(o){const f=o.trigger!=="click";return _objectSpread(_objectSpread({},super.getDefault(o)),{},{trigger:"hover",followCursor:f,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:o,closeOnClick:f}=this.popupOption;this.layerConfigItems.forEach(v=>{var T;const O=this.getLayerByConfig(v);if(!O)return;const L=_objectSpread({},v);if(o==="hover"){const xe=this.onLayerMouseMove.bind(this,O),Ee=this.onLayerMouseOut.bind(this,O);L.onMouseMove=xe,L.onMouseOut=Ee,O==null||O.on("mousemove",xe),O==null||O.on("mouseout",Ee)}else{var F;const xe=this.onLayerClick.bind(this,O);L.onClick=xe,O==null||O.on("click",xe);const Ee=(F=this.mapsService)===null||F===void 0?void 0:F.getMapContainer();Ee&&f&&Ee.addEventListener("click",this.onSceneClick)}const H=O==null||(T=O.getSource)===null||T===void 0?void 0:T.call(O),ie=this.onSourceUpdate.bind(this);H==null||H.on("update",ie),L.onSourceUpdate=ie,this.layerConfigMap.set(O,L)})}unbindLayerEvent(){this.layerConfigItems.forEach(o=>{var f;const v=this.getLayerByConfig(o),T=v&&this.layerConfigMap.get(v);if(!T)return;const{onMouseMove:O,onMouseOut:L,onClick:F,onSourceUpdate:H}=T;if(O&&v.off("mousemove",O),L&&v.off("mouseout",L),F&&v.off("click",F),H){var ie;v==null||(ie=v.getSource())===null||ie===void 0||ie.off("update",H)}const xe=(f=this.mapsService)===null||f===void 0?void 0:f.getMapContainer();xe&&xe.removeEventListener("click",this.onSceneClick)})}onLayerMouseMove(o,f){if(!this.isSameFeature(o,f.featureId)){const{title:v,content:T}=this.getLayerInfoFrag(o,f);this.setDOMContent(T),this.setTitle(v),this.setDisplayFeatureInfo({layer:o,featureId:f.featureId}),this.show()}}onLayerMouseOut(o,f){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(o,f){const v=this.layerConfigMap.get(o);let T;const O=document.createDocumentFragment();if(v){let L=f.feature;L.type==="Feature"&&"properties"in L&&"geometry"in L&&(L=L.properties);const{title:F,fields:H,customContent:ie}=v;if(F){T=document.createDocumentFragment();const xe=F instanceof Function?F(L):F;DOM.appendElementType(T,xe)}if(ie){const xe=ie instanceof Function?ie(L):ie;DOM.appendElementType(O,xe)}else H!=null&&H.length&&(H==null||H.forEach(xe=>{var Ee,Ye;const{field:Lt,formatField:an,formatValue:Pn,getValue:sr}=typeof xe=="string"?{field:xe}:xe,Rr=DOM.create("div","l7-layer-popup__row"),Tr=sr?sr(f.feature):OA(L,Lt),li=(Ee=an instanceof Function?an(Lt,L):an)!==null&&Ee!==void 0?Ee:Lt;let Ui=(Ye=Pn instanceof Function?Pn(Tr,L):Pn)!==null&&Ye!==void 0?Ye:Tr;const Lo=DOM.create("span","l7-layer-popup__key",Rr);DOM.appendElementType(Lo,li),DOM.appendElementType(Lo,document.createTextNode("\uFF1A"));const eo=DOM.create("span","l7-layer-popup__value",Rr);Array.isArray(Ui)&&Ui.every(Wr=>!(Wr instanceof Object))&&(Ui=Ui.map(Wr=>String(Wr)).join(",")),DOM.appendElementType(eo,Ui),O.appendChild(Rr)}))}return{title:T,content:O}}getLayerByConfig(o){const f=o.layer;if(f instanceof Object)return f;if(typeof f=="string")return this.layerService.getLayer(f)||this.layerService.getLayerByName(f)}isSameFeature(o,f){const v=this.displayFeatureInfo;return v&&o===v.layer&&f===v.featureId}setDisplayFeatureInfo(o){const f=this.displayFeatureInfo;f&&f.layer.off("hide",this.onLayerHide),o&&o.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=o}}function FE(a,o){var f=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,v=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(f||v)&&(o||(o=document),!!o)){var T=o.head||o.getElementsByTagName("head")[0];if(!T){T=o.createElement("head");var O=o.body||o.getElementsByTagName("body")[0];O?O.parentNode.insertBefore(T,O):o.documentElement.appendChild(T)}var L=o.createElement("style");return L.type="text/css",L.styleSheet?L.styleSheet.cssText=a:L.appendChild(o.createTextNode(a)),T.appendChild(L),L}}FE(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var RA=D(81550),o_=D.n(RA),Os=class{constructor(a,o){const{buffer:f,offset:v,stride:T,normalized:O,size:L,divisor:F}=o;this.buffer=f,this.attribute={buffer:f.get(),offset:v||0,stride:T||0,normalized:O||!1,divisor:F||0},L&&(this.attribute.size=L)}get(){return this.attribute}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},T0={[K.gl.POINTS]:"points",[K.gl.LINES]:"lines",[K.gl.LINE_LOOP]:"line loop",[K.gl.LINE_STRIP]:"line strip",[K.gl.TRIANGLES]:"triangles",[K.gl.TRIANGLE_FAN]:"triangle fan",[K.gl.TRIANGLE_STRIP]:"triangle strip"},w0={[K.gl.STATIC_DRAW]:"static",[K.gl.DYNAMIC_DRAW]:"dynamic",[K.gl.STREAM_DRAW]:"stream"},ud={[K.gl.BYTE]:"int8",[K.gl.INT]:"int32",[K.gl.UNSIGNED_BYTE]:"uint8",[K.gl.UNSIGNED_SHORT]:"uint16",[K.gl.UNSIGNED_INT]:"uint32",[K.gl.FLOAT]:"float"},a_={[K.gl.ALPHA]:"alpha",[K.gl.LUMINANCE]:"luminance",[K.gl.LUMINANCE_ALPHA]:"luminance alpha",[K.gl.RGB]:"rgb",[K.gl.RGBA]:"rgba",[K.gl.RGBA4]:"rgba4",[K.gl.RGB5_A1]:"rgb5 a1",[K.gl.RGB565]:"rgb565",[K.gl.DEPTH_COMPONENT]:"depth",[K.gl.DEPTH_STENCIL]:"depth stencil"},MA={[K.gl.DONT_CARE]:"dont care",[K.gl.NICEST]:"nice",[K.gl.FASTEST]:"fast"},kE={[K.gl.NEAREST]:"nearest",[K.gl.LINEAR]:"linear",[K.gl.LINEAR_MIPMAP_LINEAR]:"mipmap",[K.gl.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[K.gl.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[K.gl.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},Ub={[K.gl.REPEAT]:"repeat",[K.gl.CLAMP_TO_EDGE]:"clamp",[K.gl.MIRRORED_REPEAT]:"mirror"},Dg={[K.gl.NONE]:"none",[K.gl.BROWSER_DEFAULT_WEBGL]:"browser"},zE={[K.gl.NEVER]:"never",[K.gl.ALWAYS]:"always",[K.gl.LESS]:"less",[K.gl.LEQUAL]:"lequal",[K.gl.GREATER]:"greater",[K.gl.GEQUAL]:"gequal",[K.gl.EQUAL]:"equal",[K.gl.NOTEQUAL]:"notequal"},UE={[K.gl.FUNC_ADD]:"add",[K.gl.MIN_EXT]:"min",[K.gl.MAX_EXT]:"max",[K.gl.FUNC_SUBTRACT]:"subtract",[K.gl.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},Ng={[K.gl.ZERO]:"zero",[K.gl.ONE]:"one",[K.gl.SRC_COLOR]:"src color",[K.gl.ONE_MINUS_SRC_COLOR]:"one minus src color",[K.gl.SRC_ALPHA]:"src alpha",[K.gl.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[K.gl.DST_COLOR]:"dst color",[K.gl.ONE_MINUS_DST_COLOR]:"one minus dst color",[K.gl.DST_ALPHA]:"dst alpha",[K.gl.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[K.gl.CONSTANT_COLOR]:"constant color",[K.gl.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[K.gl.CONSTANT_ALPHA]:"constant alpha",[K.gl.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[K.gl.SRC_ALPHA_SATURATE]:"src alpha saturate"},PA={[K.gl.NEVER]:"never",[K.gl.ALWAYS]:"always",[K.gl.LESS]:"less",[K.gl.LEQUAL]:"lequal",[K.gl.GREATER]:"greater",[K.gl.GEQUAL]:"gequal",[K.gl.EQUAL]:"equal",[K.gl.NOTEQUAL]:"notequal"},Bg={[K.gl.ZERO]:"zero",[K.gl.KEEP]:"keep",[K.gl.REPLACE]:"replace",[K.gl.INVERT]:"invert",[K.gl.INCR]:"increment",[K.gl.DECR]:"decrement",[K.gl.INCR_WRAP]:"increment wrap",[K.gl.DECR_WRAP]:"decrement wrap"},IA={[K.gl.FRONT]:"front",[K.gl.BACK]:"back"},LA=class{constructor(a,o){this.isDestroyed=!1;const{data:f,usage:v,type:T}=o;this.buffer=a.buffer({data:f,usage:w0[v||K.gl.STATIC_DRAW],type:ud[T||K.gl.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:o}){this.buffer.subdata(a,o)}},DA=class{constructor(a,o){const{data:f,usage:v,type:T,count:O}=o;this.elements=a.elements({data:f,usage:w0[v||K.gl.STATIC_DRAW],type:ud[T||K.gl.UNSIGNED_BYTE],count:O})}get(){return this.elements}subData({data:a}){this.elements.subdata(a)}destroy(){}},ol=class{constructor(a,o){const{width:f,height:v,color:T,colors:O}=o,L={width:f,height:v};Array.isArray(O)&&(L.colors=O.map(F=>F.get())),T&&typeof T!="boolean"&&(L.color=T.get()),this.framebuffer=a.framebuffer(L)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:a,height:o}){this.framebuffer.resize(a,o)}},hp=D(95147),Fg=D(25897),NA=D(81957),go=D(97582),BA=D(90857),Gm=BA,An;(function(a){a[a.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",a[a.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",a[a.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN",a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC_COLOR=768]="SRC_COLOR",a[a.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.DST_COLOR=774]="DST_COLOR",a[a.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",a[a.CONSTANT_COLOR=32769]="CONSTANT_COLOR",a[a.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",a[a.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",a[a.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",a[a.FUNC_ADD=32774]="FUNC_ADD",a[a.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",a[a.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",a[a.BLEND_EQUATION=32777]="BLEND_EQUATION",a[a.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",a[a.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",a[a.BLEND_DST_RGB=32968]="BLEND_DST_RGB",a[a.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",a[a.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",a[a.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",a[a.BLEND_COLOR=32773]="BLEND_COLOR",a[a.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",a[a.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",a[a.LINE_WIDTH=2849]="LINE_WIDTH",a[a.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",a[a.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",a[a.CULL_FACE_MODE=2885]="CULL_FACE_MODE",a[a.FRONT_FACE=2886]="FRONT_FACE",a[a.DEPTH_RANGE=2928]="DEPTH_RANGE",a[a.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",a[a.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",a[a.DEPTH_FUNC=2932]="DEPTH_FUNC",a[a.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",a[a.STENCIL_FUNC=2962]="STENCIL_FUNC",a[a.STENCIL_FAIL=2964]="STENCIL_FAIL",a[a.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",a[a.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",a[a.STENCIL_REF=2967]="STENCIL_REF",a[a.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",a[a.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",a[a.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",a[a.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",a[a.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",a[a.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",a[a.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",a[a.VIEWPORT=2978]="VIEWPORT",a[a.SCISSOR_BOX=3088]="SCISSOR_BOX",a[a.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",a[a.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",a[a.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",a[a.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",a[a.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",a[a.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",a[a.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",a[a.RED_BITS=3410]="RED_BITS",a[a.GREEN_BITS=3411]="GREEN_BITS",a[a.BLUE_BITS=3412]="BLUE_BITS",a[a.ALPHA_BITS=3413]="ALPHA_BITS",a[a.DEPTH_BITS=3414]="DEPTH_BITS",a[a.STENCIL_BITS=3415]="STENCIL_BITS",a[a.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",a[a.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",a[a.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",a[a.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",a[a.SAMPLES=32937]="SAMPLES",a[a.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",a[a.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",a[a.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",a[a.VENDOR=7936]="VENDOR",a[a.RENDERER=7937]="RENDERER",a[a.VERSION=7938]="VERSION",a[a.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",a[a.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",a[a.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",a[a.STATIC_DRAW=35044]="STATIC_DRAW",a[a.STREAM_DRAW=35040]="STREAM_DRAW",a[a.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.BUFFER_SIZE=34660]="BUFFER_SIZE",a[a.BUFFER_USAGE=34661]="BUFFER_USAGE",a[a.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",a[a.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",a[a.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",a[a.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",a[a.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",a[a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",a[a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",a[a.CULL_FACE=2884]="CULL_FACE",a[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",a[a.BLEND=3042]="BLEND",a[a.DEPTH_TEST=2929]="DEPTH_TEST",a[a.DITHER=3024]="DITHER",a[a.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",a[a.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",a[a.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",a[a.SCISSOR_TEST=3089]="SCISSOR_TEST",a[a.STENCIL_TEST=2960]="STENCIL_TEST",a[a.NO_ERROR=0]="NO_ERROR",a[a.INVALID_ENUM=1280]="INVALID_ENUM",a[a.INVALID_VALUE=1281]="INVALID_VALUE",a[a.INVALID_OPERATION=1282]="INVALID_OPERATION",a[a.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",a[a.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",a[a.CW=2304]="CW",a[a.CCW=2305]="CCW",a[a.DONT_CARE=4352]="DONT_CARE",a[a.FASTEST=4353]="FASTEST",a[a.NICEST=4354]="NICEST",a[a.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",a[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.DOUBLE=5130]="DOUBLE",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.ALPHA=6406]="ALPHA",a[a.RGB=6407]="RGB",a[a.RGBA=6408]="RGBA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",a[a.VERTEX_SHADER=35633]="VERTEX_SHADER",a[a.COMPILE_STATUS=35713]="COMPILE_STATUS",a[a.DELETE_STATUS=35712]="DELETE_STATUS",a[a.LINK_STATUS=35714]="LINK_STATUS",a[a.VALIDATE_STATUS=35715]="VALIDATE_STATUS",a[a.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",a[a.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",a[a.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",a[a.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",a[a.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",a[a.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",a[a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",a[a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",a[a.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",a[a.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",a[a.SHADER_TYPE=35663]="SHADER_TYPE",a[a.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",a[a.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",a[a.NEVER=512]="NEVER",a[a.ALWAYS=519]="ALWAYS",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.GEQUAL=518]="GEQUAL",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.KEEP=7680]="KEEP",a[a.REPLACE=7681]="REPLACE",a[a.INCR=7682]="INCR",a[a.DECR=7683]="DECR",a[a.INVERT=5386]="INVERT",a[a.INCR_WRAP=34055]="INCR_WRAP",a[a.DECR_WRAP=34056]="DECR_WRAP",a[a.NEAREST=9728]="NEAREST",a[a.LINEAR=9729]="LINEAR",a[a.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",a[a.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",a[a.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",a[a.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",a[a.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",a[a.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",a[a.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",a[a.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE=5890]="TEXTURE",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",a[a.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",a[a.TEXTURE0=33984]="TEXTURE0",a[a.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",a[a.REPEAT=10497]="REPEAT",a[a.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",a[a.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",a[a.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",a[a.SAMPLER_CUBE=35680]="SAMPLER_CUBE",a[a.LOW_FLOAT=36336]="LOW_FLOAT",a[a.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",a[a.HIGH_FLOAT=36338]="HIGH_FLOAT",a[a.LOW_INT=36339]="LOW_INT",a[a.MEDIUM_INT=36340]="MEDIUM_INT",a[a.HIGH_INT=36341]="HIGH_INT",a[a.FRAMEBUFFER=36160]="FRAMEBUFFER",a[a.RENDERBUFFER=36161]="RENDERBUFFER",a[a.RGBA4=32854]="RGBA4",a[a.RGB5_A1=32855]="RGB5_A1",a[a.RGB565=36194]="RGB565",a[a.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",a[a.STENCIL_INDEX=6401]="STENCIL_INDEX",a[a.STENCIL_INDEX8=36168]="STENCIL_INDEX8",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",a[a.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",a[a.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",a[a.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",a[a.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",a[a.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",a[a.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",a[a.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",a[a.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",a[a.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",a[a.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",a[a.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",a[a.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",a[a.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",a[a.NONE=0]="NONE",a[a.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",a[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",a[a.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",a[a.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",a[a.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",a[a.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",a[a.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",a[a.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",a[a.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",a[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",a[a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",a[a.READ_BUFFER=3074]="READ_BUFFER",a[a.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",a[a.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",a[a.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",a[a.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",a[a.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",a[a.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",a[a.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",a[a.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",a[a.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",a[a.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",a[a.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",a[a.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",a[a.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",a[a.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",a[a.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",a[a.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",a[a.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",a[a.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",a[a.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",a[a.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",a[a.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",a[a.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",a[a.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",a[a.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",a[a.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",a[a.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",a[a.RED=6403]="RED",a[a.RGB8=32849]="RGB8",a[a.RGBA8=32856]="RGBA8",a[a.RGB10_A2=32857]="RGB10_A2",a[a.TEXTURE_3D=32879]="TEXTURE_3D",a[a.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",a[a.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",a[a.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",a[a.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",a[a.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",a[a.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",a[a.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",a[a.SRGB=35904]="SRGB",a[a.SRGB8=35905]="SRGB8",a[a.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",a[a.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",a[a.RGBA32F=34836]="RGBA32F",a[a.RGB32F=34837]="RGB32F",a[a.RGBA16F=34842]="RGBA16F",a[a.RGB16F=34843]="RGB16F",a[a.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",a[a.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",a[a.R11F_G11F_B10F=35898]="R11F_G11F_B10F",a[a.RGB9_E5=35901]="RGB9_E5",a[a.RGBA32UI=36208]="RGBA32UI",a[a.RGB32UI=36209]="RGB32UI",a[a.RGBA16UI=36214]="RGBA16UI",a[a.RGB16UI=36215]="RGB16UI",a[a.RGBA8UI=36220]="RGBA8UI",a[a.RGB8UI=36221]="RGB8UI",a[a.RGBA32I=36226]="RGBA32I",a[a.RGB32I=36227]="RGB32I",a[a.RGBA16I=36232]="RGBA16I",a[a.RGB16I=36233]="RGB16I",a[a.RGBA8I=36238]="RGBA8I",a[a.RGB8I=36239]="RGB8I",a[a.RED_INTEGER=36244]="RED_INTEGER",a[a.RGB_INTEGER=36248]="RGB_INTEGER",a[a.RGBA_INTEGER=36249]="RGBA_INTEGER",a[a.R8=33321]="R8",a[a.RG8=33323]="RG8",a[a.R16F=33325]="R16F",a[a.R32F=33326]="R32F",a[a.RG16F=33327]="RG16F",a[a.RG32F=33328]="RG32F",a[a.R8I=33329]="R8I",a[a.R8UI=33330]="R8UI",a[a.R16I=33331]="R16I",a[a.R16UI=33332]="R16UI",a[a.R32I=33333]="R32I",a[a.R32UI=33334]="R32UI",a[a.RG8I=33335]="RG8I",a[a.RG8UI=33336]="RG8UI",a[a.RG16I=33337]="RG16I",a[a.RG16UI=33338]="RG16UI",a[a.RG32I=33339]="RG32I",a[a.RG32UI=33340]="RG32UI",a[a.R8_SNORM=36756]="R8_SNORM",a[a.RG8_SNORM=36757]="RG8_SNORM",a[a.RGB8_SNORM=36758]="RGB8_SNORM",a[a.RGBA8_SNORM=36759]="RGBA8_SNORM",a[a.RGB10_A2UI=36975]="RGB10_A2UI",a[a.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",a[a.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",a[a.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",a[a.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",a[a.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",a[a.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",a[a.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",a[a.HALF_FLOAT=5131]="HALF_FLOAT",a[a.RG=33319]="RG",a[a.RG_INTEGER=33320]="RG_INTEGER",a[a.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",a[a.CURRENT_QUERY=34917]="CURRENT_QUERY",a[a.QUERY_RESULT=34918]="QUERY_RESULT",a[a.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",a[a.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",a[a.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",a[a.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",a[a.DRAW_BUFFER0=34853]="DRAW_BUFFER0",a[a.DRAW_BUFFER1=34854]="DRAW_BUFFER1",a[a.DRAW_BUFFER2=34855]="DRAW_BUFFER2",a[a.DRAW_BUFFER3=34856]="DRAW_BUFFER3",a[a.DRAW_BUFFER4=34857]="DRAW_BUFFER4",a[a.DRAW_BUFFER5=34858]="DRAW_BUFFER5",a[a.DRAW_BUFFER6=34859]="DRAW_BUFFER6",a[a.DRAW_BUFFER7=34860]="DRAW_BUFFER7",a[a.DRAW_BUFFER8=34861]="DRAW_BUFFER8",a[a.DRAW_BUFFER9=34862]="DRAW_BUFFER9",a[a.DRAW_BUFFER10=34863]="DRAW_BUFFER10",a[a.DRAW_BUFFER11=34864]="DRAW_BUFFER11",a[a.DRAW_BUFFER12=34865]="DRAW_BUFFER12",a[a.DRAW_BUFFER13=34866]="DRAW_BUFFER13",a[a.DRAW_BUFFER14=34867]="DRAW_BUFFER14",a[a.DRAW_BUFFER15=34868]="DRAW_BUFFER15",a[a.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",a[a.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",a[a.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",a[a.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",a[a.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",a[a.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",a[a.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",a[a.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",a[a.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",a[a.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",a[a.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",a[a.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",a[a.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",a[a.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",a[a.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",a[a.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",a[a.SAMPLER_3D=35679]="SAMPLER_3D",a[a.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",a[a.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",a[a.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",a[a.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",a[a.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",a[a.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",a[a.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",a[a.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",a[a.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",a[a.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",a[a.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",a[a.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",a[a.MAX_SAMPLES=36183]="MAX_SAMPLES",a[a.SAMPLER_BINDING=35097]="SAMPLER_BINDING",a[a.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",a[a.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",a[a.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",a[a.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",a[a.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",a[a.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",a[a.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",a[a.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",a[a.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",a[a.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",a[a.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",a[a.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",a[a.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",a[a.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",a[a.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",a[a.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",a[a.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",a[a.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",a[a.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",a[a.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",a[a.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",a[a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",a[a.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",a[a.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",a[a.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",a[a.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",a[a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",a[a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",a[a.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",a[a.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",a[a.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",a[a.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",a[a.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",a[a.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",a[a.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",a[a.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",a[a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",a[a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",a[a.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",a[a.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",a[a.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",a[a.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",a[a.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",a[a.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",a[a.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",a[a.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",a[a.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",a[a.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",a[a.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",a[a.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",a[a.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",a[a.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",a[a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",a[a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",a[a.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",a[a.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",a[a.UNIFORM_TYPE=35383]="UNIFORM_TYPE",a[a.UNIFORM_SIZE=35384]="UNIFORM_SIZE",a[a.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",a[a.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",a[a.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",a[a.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",a[a.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",a[a.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",a[a.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",a[a.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",a[a.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",a[a.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",a[a.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",a[a.OBJECT_TYPE=37138]="OBJECT_TYPE",a[a.SYNC_CONDITION=37139]="SYNC_CONDITION",a[a.SYNC_STATUS=37140]="SYNC_STATUS",a[a.SYNC_FLAGS=37141]="SYNC_FLAGS",a[a.SYNC_FENCE=37142]="SYNC_FENCE",a[a.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",a[a.UNSIGNALED=37144]="UNSIGNALED",a[a.SIGNALED=37145]="SIGNALED",a[a.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",a[a.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",a[a.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",a[a.WAIT_FAILED=37149]="WAIT_FAILED",a[a.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",a[a.COLOR=6144]="COLOR",a[a.DEPTH=6145]="DEPTH",a[a.STENCIL=6146]="STENCIL",a[a.MIN=32775]="MIN",a[a.MAX=32776]="MAX",a[a.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",a[a.STREAM_READ=35041]="STREAM_READ",a[a.STREAM_COPY=35042]="STREAM_COPY",a[a.STATIC_READ=35045]="STATIC_READ",a[a.STATIC_COPY=35046]="STATIC_COPY",a[a.DYNAMIC_READ=35049]="DYNAMIC_READ",a[a.DYNAMIC_COPY=35050]="DYNAMIC_COPY",a[a.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",a[a.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",a[a.INVALID_INDEX=4294967295]="INVALID_INDEX",a[a.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",a[a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",a[a.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",a[a.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",a[a.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",a[a.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",a[a.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",a[a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",a[a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",a[a.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",a[a.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",a[a.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",a[a.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",a[a.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",a[a.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",a[a.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",a[a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",a[a.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",a[a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",a[a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",a[a.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",a[a.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",a[a.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",a[a.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",a[a.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",a[a.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",a[a.RGBA32F_EXT=34836]="RGBA32F_EXT",a[a.RGB32F_EXT=34837]="RGB32F_EXT",a[a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",a[a.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",a[a.MIN_EXT=32775]="MIN_EXT",a[a.MAX_EXT=32776]="MAX_EXT",a[a.SRGB_EXT=35904]="SRGB_EXT",a[a.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",a[a.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",a[a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",a[a.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",a[a.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",a[a.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",a[a.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",a[a.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",a[a.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",a[a.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",a[a.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",a[a.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",a[a.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",a[a.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",a[a.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",a[a.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",a[a.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",a[a.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",a[a.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",a[a.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",a[a.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",a[a.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",a[a.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",a[a.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",a[a.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",a[a.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",a[a.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",a[a.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",a[a.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",a[a.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",a[a.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",a[a.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",a[a.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",a[a.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",a[a.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",a[a.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",a[a.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",a[a.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",a[a.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",a[a.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",a[a.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",a[a.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",a[a.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",a[a.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",a[a.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",a[a.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(An||(An={}));var Bs;(function(a){a[a.Buffer=0]="Buffer",a[a.Texture=1]="Texture",a[a.RenderTarget=2]="RenderTarget",a[a.Sampler=3]="Sampler",a[a.Program=4]="Program",a[a.Bindings=5]="Bindings",a[a.InputLayout=6]="InputLayout",a[a.RenderPipeline=7]="RenderPipeline",a[a.ComputePipeline=8]="ComputePipeline",a[a.Readback=9]="Readback",a[a.QueryPool=10]="QueryPool",a[a.RenderBundle=11]="RenderBundle"})(Bs||(Bs={}));var $a;(function(a){a[a.NEVER=512]="NEVER",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.GEQUAL=518]="GEQUAL",a[a.ALWAYS=519]="ALWAYS"})($a||($a={}));var s_;(function(a){a[a.CCW=2305]="CCW",a[a.CW=2304]="CW"})(s_||(s_={}));var hh;(function(a){a[a.NONE=0]="NONE",a[a.FRONT=1]="FRONT",a[a.BACK=2]="BACK",a[a.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(hh||(hh={}));var fs;(function(a){a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC=768]="SRC",a[a.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",a[a.DST=774]="DST",a[a.ONE_MINUS_DST=775]="ONE_MINUS_DST",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.CONST=32769]="CONST",a[a.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(fs||(fs={}));var mu;(function(a){a[a.ADD=32774]="ADD",a[a.SUBSTRACT=32778]="SUBSTRACT",a[a.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",a[a.MIN=32775]="MIN",a[a.MAX=32776]="MAX"})(mu||(mu={}));var Zf;(function(a){a[a.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",a[a.REPEAT=1]="REPEAT",a[a.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(Zf||(Zf={}));var tc;(function(a){a[a.POINT=0]="POINT",a[a.BILINEAR=1]="BILINEAR"})(tc||(tc={}));var Wu;(function(a){a[a.NO_MIP=0]="NO_MIP",a[a.NEAREST=1]="NEAREST",a[a.LINEAR=2]="LINEAR"})(Wu||(Wu={}));var vu;(function(a){a[a.POINTS=0]="POINTS",a[a.TRIANGLES=1]="TRIANGLES",a[a.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",a[a.LINES=3]="LINES",a[a.LINE_STRIP=4]="LINE_STRIP"})(vu||(vu={}));var al;(function(a){a[a.MAP_READ=1]="MAP_READ",a[a.MAP_WRITE=2]="MAP_WRITE",a[a.COPY_SRC=4]="COPY_SRC",a[a.COPY_DST=8]="COPY_DST",a[a.INDEX=16]="INDEX",a[a.VERTEX=32]="VERTEX",a[a.UNIFORM=64]="UNIFORM",a[a.STORAGE=128]="STORAGE",a[a.INDIRECT=256]="INDIRECT",a[a.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(al||(al={}));var dp;(function(a){a[a.STATIC=1]="STATIC",a[a.DYNAMIC=2]="DYNAMIC"})(dp||(dp={}));var Xm;(function(a){a[a.VERTEX=1]="VERTEX",a[a.INSTANCE=2]="INSTANCE"})(Xm||(Xm={}));var jb;(function(a){a.LOADED="loaded"})(jb||(jb={}));var ss;(function(a){a[a.TEXTURE_2D=0]="TEXTURE_2D",a[a.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",a[a.TEXTURE_3D=2]="TEXTURE_3D",a[a.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(ss||(ss={}));var Wf;(function(a){a[a.SAMPLED=1]="SAMPLED",a[a.RENDER_TARGET=2]="RENDER_TARGET",a[a.STORAGE=4]="STORAGE"})(Wf||(Wf={}));var hf;(function(a){a[a.NONE=0]="NONE",a[a.RED=1]="RED",a[a.GREEN=2]="GREEN",a[a.BLUE=4]="BLUE",a[a.ALPHA=8]="ALPHA",a[a.RGB=7]="RGB",a[a.ALL=15]="ALL"})(hf||(hf={}));var Mc;(function(a){a[a.KEEP=7680]="KEEP",a[a.ZERO=0]="ZERO",a[a.REPLACE=7681]="REPLACE",a[a.INVERT=5386]="INVERT",a[a.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",a[a.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",a[a.INCREMENT_WRAP=34055]="INCREMENT_WRAP",a[a.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(Mc||(Mc={}));function pP(a,o,f,v){var T=ss.TEXTURE_2D,O=1,L=Wf.SAMPLED;return{dimension:T,format:a,width:o,height:f,depthOrArrayLayers:O,mipLevelCount:v,usage:L}}var mc;(function(a){a[a.Float=0]="Float",a[a.UnfilterableFloat=1]="UnfilterableFloat",a[a.Uint=2]="Uint",a[a.Sint=3]="Sint",a[a.Depth=4]="Depth"})(mc||(mc={}));var Wp;(function(a){a[a.LOWER_LEFT=0]="LOWER_LEFT",a[a.UPPER_LEFT=1]="UPPER_LEFT"})(Wp||(Wp={}));var kg;(function(a){a[a.NEGATIVE_ONE=0]="NEGATIVE_ONE",a[a.ZERO=1]="ZERO"})(kg||(kg={}));var l_;(function(a){a[a.OcclusionConservative=0]="OcclusionConservative"})(l_||(l_={}));var oi;(function(a){a[a.U8=1]="U8",a[a.U16=2]="U16",a[a.U32=3]="U32",a[a.S8=4]="S8",a[a.S16=5]="S16",a[a.S32=6]="S32",a[a.F16=7]="F16",a[a.F32=8]="F32",a[a.BC1=65]="BC1",a[a.BC2=66]="BC2",a[a.BC3=67]="BC3",a[a.BC4_UNORM=68]="BC4_UNORM",a[a.BC4_SNORM=69]="BC4_SNORM",a[a.BC5_UNORM=70]="BC5_UNORM",a[a.BC5_SNORM=71]="BC5_SNORM",a[a.U16_PACKED_5551=97]="U16_PACKED_5551",a[a.U16_PACKED_565=98]="U16_PACKED_565",a[a.D24=129]="D24",a[a.D32F=130]="D32F",a[a.D24S8=131]="D24S8",a[a.D32FS8=132]="D32FS8"})(oi||(oi={}));var Ao;(function(a){a[a.R=1]="R",a[a.RG=2]="RG",a[a.RGB=3]="RGB",a[a.RGBA=4]="RGBA",a[a.A=5]="A"})(Ao||(Ao={}));function mP(a){return a}var ho;(function(a){a[a.None=0]="None",a[a.Normalized=1]="Normalized",a[a.sRGB=2]="sRGB",a[a.Depth=4]="Depth",a[a.Stencil=8]="Stencil",a[a.RenderTarget=16]="RenderTarget",a[a.Luminance=32]="Luminance"})(ho||(ho={}));function ra(a,o,f){return a<<16|o<<8|f}var Yn;(function(a){a[a.ALPHA=ra(oi.U8,Ao.A,ho.None)]="ALPHA",a[a.U8_LUMINANCE=ra(oi.U8,Ao.A,ho.Luminance)]="U8_LUMINANCE",a[a.F16_LUMINANCE=ra(oi.F16,Ao.A,ho.Luminance)]="F16_LUMINANCE",a[a.F32_LUMINANCE=ra(oi.F32,Ao.A,ho.Luminance)]="F32_LUMINANCE",a[a.F16_R=ra(oi.F16,Ao.R,ho.None)]="F16_R",a[a.F16_RG=ra(oi.F16,Ao.RG,ho.None)]="F16_RG",a[a.F16_RGB=ra(oi.F16,Ao.RGB,ho.None)]="F16_RGB",a[a.F16_RGBA=ra(oi.F16,Ao.RGBA,ho.None)]="F16_RGBA",a[a.F32_R=ra(oi.F32,Ao.R,ho.None)]="F32_R",a[a.F32_RG=ra(oi.F32,Ao.RG,ho.None)]="F32_RG",a[a.F32_RGB=ra(oi.F32,Ao.RGB,ho.None)]="F32_RGB",a[a.F32_RGBA=ra(oi.F32,Ao.RGBA,ho.None)]="F32_RGBA",a[a.U8_R=ra(oi.U8,Ao.R,ho.None)]="U8_R",a[a.U8_R_NORM=ra(oi.U8,Ao.R,ho.Normalized)]="U8_R_NORM",a[a.U8_RG=ra(oi.U8,Ao.RG,ho.None)]="U8_RG",a[a.U8_RG_NORM=ra(oi.U8,Ao.RG,ho.Normalized)]="U8_RG_NORM",a[a.U8_RGB=ra(oi.U8,Ao.RGB,ho.None)]="U8_RGB",a[a.U8_RGB_NORM=ra(oi.U8,Ao.RGB,ho.Normalized)]="U8_RGB_NORM",a[a.U8_RGB_SRGB=ra(oi.U8,Ao.RGB,ho.sRGB|ho.Normalized)]="U8_RGB_SRGB",a[a.U8_RGBA=ra(oi.U8,Ao.RGBA,ho.None)]="U8_RGBA",a[a.U8_RGBA_NORM=ra(oi.U8,Ao.RGBA,ho.Normalized)]="U8_RGBA_NORM",a[a.U8_RGBA_SRGB=ra(oi.U8,Ao.RGBA,ho.sRGB|ho.Normalized)]="U8_RGBA_SRGB",a[a.U16_R=ra(oi.U16,Ao.R,ho.None)]="U16_R",a[a.U16_R_NORM=ra(oi.U16,Ao.R,ho.Normalized)]="U16_R_NORM",a[a.U16_RG_NORM=ra(oi.U16,Ao.RG,ho.Normalized)]="U16_RG_NORM",a[a.U16_RGBA_NORM=ra(oi.U16,Ao.RGBA,ho.Normalized)]="U16_RGBA_NORM",a[a.U16_RGBA=ra(oi.U16,Ao.RGBA,ho.None)]="U16_RGBA",a[a.U16_RGB=ra(oi.U16,Ao.RGB,ho.None)]="U16_RGB",a[a.U16_RG=ra(oi.U16,Ao.RG,ho.None)]="U16_RG",a[a.U32_R=ra(oi.U32,Ao.R,ho.None)]="U32_R",a[a.U32_RG=ra(oi.U32,Ao.RG,ho.None)]="U32_RG",a[a.U32_RGB=ra(oi.U32,Ao.RGB,ho.None)]="U32_RGB",a[a.U32_RGBA=ra(oi.U32,Ao.RGBA,ho.None)]="U32_RGBA",a[a.S8_R=ra(oi.S8,Ao.R,ho.None)]="S8_R",a[a.S8_R_NORM=ra(oi.S8,Ao.R,ho.Normalized)]="S8_R_NORM",a[a.S8_RG_NORM=ra(oi.S8,Ao.RG,ho.Normalized)]="S8_RG_NORM",a[a.S8_RGB_NORM=ra(oi.S8,Ao.RGB,ho.Normalized)]="S8_RGB_NORM",a[a.S8_RGBA_NORM=ra(oi.S8,Ao.RGBA,ho.Normalized)]="S8_RGBA_NORM",a[a.S16_R=ra(oi.S16,Ao.R,ho.None)]="S16_R",a[a.S16_RG=ra(oi.S16,Ao.RG,ho.None)]="S16_RG",a[a.S16_RG_NORM=ra(oi.S16,Ao.RG,ho.Normalized)]="S16_RG_NORM",a[a.S16_RGB_NORM=ra(oi.S16,Ao.RGB,ho.Normalized)]="S16_RGB_NORM",a[a.S16_RGBA=ra(oi.S16,Ao.RGBA,ho.None)]="S16_RGBA",a[a.S16_RGBA_NORM=ra(oi.S16,Ao.RGBA,ho.Normalized)]="S16_RGBA_NORM",a[a.S32_R=ra(oi.S32,Ao.R,ho.None)]="S32_R",a[a.S32_RG=ra(oi.S32,Ao.RG,ho.None)]="S32_RG",a[a.S32_RGB=ra(oi.S32,Ao.RGB,ho.None)]="S32_RGB",a[a.S32_RGBA=ra(oi.S32,Ao.RGBA,ho.None)]="S32_RGBA",a[a.U16_RGBA_5551=ra(oi.U16_PACKED_5551,Ao.RGBA,ho.Normalized)]="U16_RGBA_5551",a[a.U16_RGB_565=ra(oi.U16_PACKED_565,Ao.RGB,ho.Normalized)]="U16_RGB_565",a[a.BC1=ra(oi.BC1,Ao.RGBA,ho.Normalized)]="BC1",a[a.BC1_SRGB=ra(oi.BC1,Ao.RGBA,ho.Normalized|ho.sRGB)]="BC1_SRGB",a[a.BC2=ra(oi.BC2,Ao.RGBA,ho.Normalized)]="BC2",a[a.BC2_SRGB=ra(oi.BC2,Ao.RGBA,ho.Normalized|ho.sRGB)]="BC2_SRGB",a[a.BC3=ra(oi.BC3,Ao.RGBA,ho.Normalized)]="BC3",a[a.BC3_SRGB=ra(oi.BC3,Ao.RGBA,ho.Normalized|ho.sRGB)]="BC3_SRGB",a[a.BC4_UNORM=ra(oi.BC4_UNORM,Ao.R,ho.Normalized)]="BC4_UNORM",a[a.BC4_SNORM=ra(oi.BC4_SNORM,Ao.R,ho.Normalized)]="BC4_SNORM",a[a.BC5_UNORM=ra(oi.BC5_UNORM,Ao.RG,ho.Normalized)]="BC5_UNORM",a[a.BC5_SNORM=ra(oi.BC5_SNORM,Ao.RG,ho.Normalized)]="BC5_SNORM",a[a.D24=ra(oi.D24,Ao.R,ho.Depth)]="D24",a[a.D24_S8=ra(oi.D24S8,Ao.RG,ho.Depth|ho.Stencil)]="D24_S8",a[a.D32F=ra(oi.D32F,Ao.R,ho.Depth)]="D32F",a[a.D32F_S8=ra(oi.D32FS8,Ao.RG,ho.Depth|ho.Stencil)]="D32F_S8",a[a.U8_RGB_RT=ra(oi.U8,Ao.RGB,ho.RenderTarget|ho.Normalized)]="U8_RGB_RT",a[a.U8_RGBA_RT=ra(oi.U8,Ao.RGBA,ho.RenderTarget|ho.Normalized)]="U8_RGBA_RT",a[a.U8_RGBA_RT_SRGB=ra(oi.U8,Ao.RGBA,ho.RenderTarget|ho.Normalized|ho.sRGB)]="U8_RGBA_RT_SRGB"})(Yn||(Yn={}));function c_(a){return a>>>8&255}function A0(a){return a>>>16&255}function nm(a){return a&255}function u_(a){switch(a){case oi.F32:case oi.U32:case oi.S32:return 4;case oi.U16:case oi.S16:case oi.F16:return 2;case oi.U8:case oi.S8:return 1;default:throw new Error("whoops")}}function FA(a){return u_(A0(a))}function vP(a){return c_(a)}function jE(a){var o=u_(A0(a)),f=c_(a);return o*f}function kA(a,o){return a&4294967040|o}function zA(a,o){return a&4294902015|o<<8}function f_(a){var o=nm(a);if(o&ho.Depth)return mc.Depth;if(o&ho.Normalized)return mc.Float;var f=A0(a);if(f===oi.F16||f===oi.F32)return mc.Float;if(f===oi.U8||f===oi.U16||f===oi.U32)return mc.Uint;if(f===oi.S8||f===oi.S16||f===oi.S32)return mc.Sint;throw new Error("whoops")}function Wa(a,o){if(o===void 0&&(o=""),!a)throw new Error("Assert fail: ".concat(o))}function kv(a){if(a!=null)return a;throw new Error("Missing object")}function Vb(a,o){return a.r===o.r&&a.g===o.g&&a.b===o.b&&a.a===o.a}function Hb(a,o){a.r=o.r,a.g=o.g,a.b=o.b,a.a=o.a}function Pf(a){var o=a.r,f=a.g,v=a.b,T=a.a;return{r:o,g:f,b:v,a:T}}function zv(a,o,f,v){return v===void 0&&(v=1),{r:a,g:o,b:f,a:v}}var Uv=zv(0,0,0,0),h_=zv(0,0,0,1),$y=zv(1,1,1,0),gP=zv(1,1,1,1),zg=!0;function yP(a,o){o===void 0&&(o=zg),o&&(a[10]=-a[10],a[14]=-a[14])}function _P(a,o){o===void 0&&(o=zg),o&&(a[10]=-a[10],a[14]=-a[14]+1)}function VE(a,o){if(o===void 0&&(o=zg),o)switch(a){case $a.LESS:return $a.GREATER;case $a.LEQUAL:return $a.GEQUAL;case $a.GEQUAL:return $a.LEQUAL;case $a.GREATER:return $a.LESS;default:return a}else return a}function UA(a,o){return o===void 0&&(o=zg),o?1-a:a}function Pk(a,o){return o===void 0&&(o=zg),o?-a:a}function bP(a,o,f,v){if(v===void 0&&(v=zg),f=VE(f,v),f===$a.LESS)return a<o;if(f===$a.LEQUAL)return a<=o;if(f===$a.GREATER)return a>o;if(f===$a.GEQUAL)return a>=o;throw new Error("whoops")}function d_(a){return!!(a&&!(a&a-1))}function Gp(a,o){return a!=null?a:o}function Zb(a){return a===void 0?null:a}function xP(a,o,f){a.length=o,a.fill(f)}function Wb(a,o){var f=o-1;return a+f&~f}function jA(a,o){return((a+o-1)/o|0)*o}function EP(a,o,f){for(var v=0,T=a.length;v<T;){var O=v+(T-v>>>1),L=f(o,a[O]);L<0?T=O:v=O+1}return v}function SP(a,o,f){var v=EP(a,o,f);a.splice(v,0,o)}function Ik(a,o,f){return f?a|=o:a&=~o,a}function VA(a,o){for(var f=new Array(a),v=0;v<a;v++)f[v]=o();return f}function HA(a,o){o===void 0&&(o=1);var f=a.split(`
`);return f.map(function(v,T){return"".concat(ZA(""+(o+T),4," "),"  ").concat(v)}).join(`
`)}function ZA(a,o,f){for(f===void 0&&(f="0");a.length<o;)a="".concat(f).concat(a);return a}function TP(a,o){for(var f=[],v=a;v<a+o;v++)f.push(v);return f}function HE(a,o){a.blendDstFactor=o.blendDstFactor,a.blendSrcFactor=o.blendSrcFactor,a.blendMode=o.blendMode}function p_(a,o){return a===void 0&&(a={}),a.compare=o.compare,a.depthFailOp=o.depthFailOp,a.passOp=o.passOp,a.failOp=o.failOp,a.mask=o.mask,a}function ZE(a,o){return a===void 0&&(a={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),HE(a.rgbBlendState,o.rgbBlendState),HE(a.alphaBlendState,o.alphaBlendState),a.channelWriteMask=o.channelWriteMask,a}function Gb(a,o){a.length!==o.length&&(a.length=o.length);for(var f=0;f<o.length;f++)a[f]=ZE(a[f],o[f])}function WA(a,o){o.attachmentsState!==void 0&&Gb(a.attachmentsState,o.attachmentsState),a.blendConstant&&o.blendConstant&&Hb(a.blendConstant,o.blendConstant),a.depthCompare=Gp(o.depthCompare,a.depthCompare),a.depthWrite=Gp(o.depthWrite,a.depthWrite),a.stencilWrite=Gp(o.stencilWrite,a.stencilWrite),a.stencilFront&&o.stencilFront&&p_(a.stencilFront,o.stencilFront),a.stencilBack&&o.stencilBack&&p_(a.stencilBack,o.stencilBack),a.cullMode=Gp(o.cullMode,a.cullMode),a.frontFace=Gp(o.frontFace,a.frontFace),a.polygonOffset=Gp(o.polygonOffset,a.polygonOffset),a.polygonOffsetFactor=Gp(o.polygonOffsetFactor,a.polygonOffsetFactor),a.polygonOffsetUnits=Gp(o.polygonOffsetUnits,a.polygonOffsetUnits)}function Ug(a){var o=Object.assign({},a);return o.attachmentsState=[],Gb(o.attachmentsState,a.attachmentsState),o.blendConstant=o.blendConstant&&Pf(o.blendConstant),o.stencilFront=p_(void 0,a.stencilFront),o.stencilBack=p_(void 0,a.stencilBack),o}function GA(a,o){o.channelWriteMask!==void 0&&(a.channelWriteMask=o.channelWriteMask),o.rgbBlendMode!==void 0&&(a.rgbBlendState.blendMode=o.rgbBlendMode),o.alphaBlendMode!==void 0&&(a.alphaBlendState.blendMode=o.alphaBlendMode),o.rgbBlendSrcFactor!==void 0&&(a.rgbBlendState.blendSrcFactor=o.rgbBlendSrcFactor),o.alphaBlendSrcFactor!==void 0&&(a.alphaBlendState.blendSrcFactor=o.alphaBlendSrcFactor),o.rgbBlendDstFactor!==void 0&&(a.rgbBlendState.blendDstFactor=o.rgbBlendDstFactor),o.alphaBlendDstFactor!==void 0&&(a.alphaBlendState.blendDstFactor=o.alphaBlendDstFactor)}var Xb={blendMode:mu.ADD,blendSrcFactor:fs.ONE,blendDstFactor:fs.ZERO},rm={attachmentsState:[{channelWriteMask:hf.ALL,rgbBlendState:Xb,alphaBlendState:Xb}],blendConstant:Pf(Uv),depthWrite:!0,depthCompare:$a.LEQUAL,stencilWrite:!1,stencilFront:{compare:$a.ALWAYS,passOp:Mc.KEEP,depthFailOp:Mc.KEEP,failOp:Mc.KEEP},stencilBack:{compare:$a.ALWAYS,passOp:Mc.KEEP,depthFailOp:Mc.KEEP,failOp:Mc.KEEP},cullMode:hh.NONE,frontFace:s_.CCW,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0};function XA(a,o){a===void 0&&(a=null),o===void 0&&(o=rm);var f=Ug(o);return a!==null&&WA(f,a),f}var wP=XA({depthCompare:$a.ALWAYS,depthWrite:!1},rm);function YA(a,o){return a.attachmentsState===void 0&&(a.attachmentsState=[],Gb(a.attachmentsState,rm.attachmentsState)),GA(a.attachmentsState[0],o),a}var WE={texture:null,sampler:null,formatKind:mc.Float,dimension:ss.TEXTURE_2D};function im(a,o,f){if(a.length!==o.length)return!1;for(var v=0;v<a.length;v++)if(!f(a[v],o[v]))return!1;return!0}function jg(a,o){for(var f=Array(a.length),v=0;v<a.length;v++)f[v]=o(a[v]);return f}function GE(a,o){return a.texture===o.texture&&a.binding===o.binding}function Yb(a,o){return a.buffer===o.buffer&&a.size===o.size&&a.binding===o.binding&&a.offset===o.offset}function XE(a,o){return a===null?o===null:o===null?!1:a.sampler===o.sampler&&a.texture===o.texture&&a.dimension===o.dimension&&a.formatKind===o.formatKind&&a.comparison===o.comparison}function $A(a,o){return a.samplerBindings=a.samplerBindings||[],a.uniformBufferBindings=a.uniformBufferBindings||[],a.storageBufferBindings=a.storageBufferBindings||[],a.storageTextureBindings=a.storageTextureBindings||[],o.samplerBindings=o.samplerBindings||[],o.uniformBufferBindings=o.uniformBufferBindings||[],o.storageBufferBindings=o.storageBufferBindings||[],o.storageTextureBindings=o.storageTextureBindings||[],!(a.samplerBindings.length!==o.samplerBindings.length||!im(a.samplerBindings,o.samplerBindings,XE)||!im(a.uniformBufferBindings,o.uniformBufferBindings,Yb)||!im(a.storageBufferBindings,o.storageBufferBindings,Yb)||!im(a.storageTextureBindings,o.storageTextureBindings,GE))}function $b(a,o){return a.blendMode==o.blendMode&&a.blendSrcFactor===o.blendSrcFactor&&a.blendDstFactor===o.blendDstFactor}function KA(a,o){return!(!$b(a.rgbBlendState,o.rgbBlendState)||!$b(a.alphaBlendState,o.alphaBlendState)||a.channelWriteMask!==o.channelWriteMask)}function m_(a,o){return a.compare==o.compare&&a.depthFailOp===o.depthFailOp&&a.failOp===o.failOp&&a.passOp===o.passOp&&a.mask===o.mask}function qA(a,o){return!im(a.attachmentsState,o.attachmentsState,KA)||a.blendConstant&&o.blendConstant&&!Vb(a.blendConstant,o.blendConstant)||a.stencilFront&&o.stencilFront&&!m_(a.stencilFront,o.stencilFront)||a.stencilBack&&o.stencilBack&&!m_(a.stencilBack,o.stencilBack)?!1:a.depthCompare===o.depthCompare&&a.depthWrite===o.depthWrite&&a.stencilWrite===o.stencilWrite&&a.cullMode===o.cullMode&&a.frontFace===o.frontFace&&a.polygonOffset===o.polygonOffset&&a.polygonOffsetFactor===o.polygonOffsetFactor&&a.polygonOffsetUnits===o.polygonOffsetUnits}function YE(a,o){return a.id===o.id}function $E(a,o){return a===o}function QA(a,o){return!(a.topology!==o.topology||a.inputLayout!==o.inputLayout||a.sampleCount!==o.sampleCount||a.megaStateDescriptor&&o.megaStateDescriptor&&!qA(a.megaStateDescriptor,o.megaStateDescriptor)||!YE(a.program,o.program)||!im(a.colorAttachmentFormats,o.colorAttachmentFormats,$E)||a.depthStencilAttachmentFormat!==o.depthStencilAttachmentFormat)}function vc(a,o){return a.offset===o.offset&&a.shaderLocation===o.shaderLocation&&a.format===o.format&&a.divisor===o.divisor}function AP(a,o){return(0,hp.Z)(a)?(0,hp.Z)(o):(0,hp.Z)(o)?!1:a.arrayStride===o.arrayStride&&a.stepMode===o.stepMode&&im(a.attributes,o.attributes,vc)}function KE(a,o){return!(a.indexBufferFormat!==o.indexBufferFormat||!im(a.vertexBufferDescriptors,o.vertexBufferDescriptors,AP)||!YE(a.program,o.program))}function Kb(a,o){return a.addressModeU===o.addressModeU&&a.addressModeV===o.addressModeV&&a.minFilter===o.minFilter&&a.magFilter===o.magFilter&&a.mipmapFilter===o.mipmapFilter&&a.lodMinClamp===o.lodMinClamp&&a.lodMaxClamp===o.lodMaxClamp&&a.maxAnisotropy===o.maxAnisotropy&&a.compareFunction===o.compareFunction}function JA(a){var o=a.sampler,f=a.texture,v=a.dimension,T=a.formatKind,O=a.comparison;return{sampler:o,texture:f,dimension:v,formatKind:T,comparison:O}}function qE(a){var o=a.buffer,f=a.size,v=a.binding,T=a.offset;return{binding:v,buffer:o,offset:T,size:f}}function eC(a){var o=a.binding,f=a.texture;return{binding:o,texture:f}}function QE(a){var o=a.samplerBindings&&jg(a.samplerBindings,JA),f=a.uniformBufferBindings&&jg(a.uniformBufferBindings,qE),v=a.storageBufferBindings&&jg(a.storageBufferBindings,qE),T=a.storageTextureBindings&&jg(a.storageTextureBindings,eC);return{samplerBindings:o,uniformBufferBindings:f,storageBufferBindings:v,storageTextureBindings:T,pipeline:a.pipeline}}function tC(a){var o=a.inputLayout,f=a.program,v=a.topology,T=a.megaStateDescriptor&&Ug(a.megaStateDescriptor),O=a.colorAttachmentFormats.slice(),L=a.depthStencilAttachmentFormat,F=a.sampleCount;return{inputLayout:o,megaStateDescriptor:T,program:f,topology:v,colorAttachmentFormats:O,depthStencilAttachmentFormat:L,sampleCount:F}}function nC(a){var o=a.shaderLocation,f=a.format,v=a.offset,T=a.divisor;return{shaderLocation:o,format:f,offset:v,divisor:T}}function JE(a){if((0,hp.Z)(a))return a;var o=a.arrayStride,f=a.stepMode,v=jg(a.attributes,nC);return{arrayStride:o,stepMode:f,attributes:v}}function rC(a){var o=jg(a.vertexBufferDescriptors,JE),f=a.indexBufferFormat,v=a.program;return{vertexBufferDescriptors:o,indexBufferFormat:f,program:v}}var ys,qb=/([^[]*)(\[[0-9]+\])?/;function jv(a){if(a[a.length-1]!=="]")return{name:a,length:1,isArray:!1};var o=a.match(qb);if(!o||o.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(a));return{name:o[1],length:Number(o[2])||1,isArray:!!o[2]}}function df(){var a=null;return function(o,f,v){var T=a!==v;return T&&(o.uniform1i(f,v),a=v),T}}function nc(a,o,f,v){var T=null,O=null;return function(L,F,H){var ie=o(H,f),xe=ie.length,Ee=!1;if(T===null)T=new Float32Array(xe),O=xe,Ee=!0;else{Wa(O===xe,"Uniform length cannot change.");for(var Ye=0;Ye<xe;++Ye)if(ie[Ye]!==T[Ye]){Ee=!0;break}}return Ee&&(v(L,a,F,ie),T.set(ie)),Ee}}function Ou(a,o,f,v){a[o](f,v)}function Xp(a,o,f,v){a[o](f,!1,v)}var iC={},oC={},Qb={},eS=[0];function v_(a,o,f,v){o===1&&typeof a=="boolean"&&(a=a?1:0),Number.isFinite(a)&&(eS[0]=a,a=eS);var T=a.length;if(a instanceof f)return a;var O=v[T];O||(O=new f(T),v[T]=O);for(var L=0;L<T;L++)O[L]=a[L];return O}function If(a,o){return v_(a,o,Float32Array,iC)}function Ym(a,o){return v_(a,o,Int32Array,oC)}function $m(a,o){return v_(a,o,Uint32Array,Qb)}var aC=(ys={},ys[An.FLOAT]=nc.bind(null,"uniform1fv",If,1,Ou),ys[An.FLOAT_VEC2]=nc.bind(null,"uniform2fv",If,2,Ou),ys[An.FLOAT_VEC3]=nc.bind(null,"uniform3fv",If,3,Ou),ys[An.FLOAT_VEC4]=nc.bind(null,"uniform4fv",If,4,Ou),ys[An.INT]=nc.bind(null,"uniform1iv",Ym,1,Ou),ys[An.INT_VEC2]=nc.bind(null,"uniform2iv",Ym,2,Ou),ys[An.INT_VEC3]=nc.bind(null,"uniform3iv",Ym,3,Ou),ys[An.INT_VEC4]=nc.bind(null,"uniform4iv",Ym,4,Ou),ys[An.BOOL]=nc.bind(null,"uniform1iv",Ym,1,Ou),ys[An.BOOL_VEC2]=nc.bind(null,"uniform2iv",Ym,2,Ou),ys[An.BOOL_VEC3]=nc.bind(null,"uniform3iv",Ym,3,Ou),ys[An.BOOL_VEC4]=nc.bind(null,"uniform4iv",Ym,4,Ou),ys[An.FLOAT_MAT2]=nc.bind(null,"uniformMatrix2fv",If,4,Xp),ys[An.FLOAT_MAT3]=nc.bind(null,"uniformMatrix3fv",If,9,Xp),ys[An.FLOAT_MAT4]=nc.bind(null,"uniformMatrix4fv",If,16,Xp),ys[An.UNSIGNED_INT]=nc.bind(null,"uniform1uiv",$m,1,Ou),ys[An.UNSIGNED_INT_VEC2]=nc.bind(null,"uniform2uiv",$m,2,Ou),ys[An.UNSIGNED_INT_VEC3]=nc.bind(null,"uniform3uiv",$m,3,Ou),ys[An.UNSIGNED_INT_VEC4]=nc.bind(null,"uniform4uiv",$m,4,Ou),ys[An.FLOAT_MAT2x3]=nc.bind(null,"uniformMatrix2x3fv",If,6,Xp),ys[An.FLOAT_MAT2x4]=nc.bind(null,"uniformMatrix2x4fv",If,8,Xp),ys[An.FLOAT_MAT3x2]=nc.bind(null,"uniformMatrix3x2fv",If,6,Xp),ys[An.FLOAT_MAT3x4]=nc.bind(null,"uniformMatrix3x4fv",If,12,Xp),ys[An.FLOAT_MAT4x2]=nc.bind(null,"uniformMatrix4x2fv",If,8,Xp),ys[An.FLOAT_MAT4x3]=nc.bind(null,"uniformMatrix4x3fv",If,12,Xp),ys[An.SAMPLER_2D]=df,ys[An.SAMPLER_CUBE]=df,ys[An.SAMPLER_3D]=df,ys[An.SAMPLER_2D_SHADOW]=df,ys[An.SAMPLER_2D_ARRAY]=df,ys[An.SAMPLER_2D_ARRAY_SHADOW]=df,ys[An.SAMPLER_CUBE_SHADOW]=df,ys[An.INT_SAMPLER_2D]=df,ys[An.INT_SAMPLER_3D]=df,ys[An.INT_SAMPLER_CUBE]=df,ys[An.INT_SAMPLER_2D_ARRAY]=df,ys[An.UNSIGNED_INT_SAMPLER_2D]=df,ys[An.UNSIGNED_INT_SAMPLER_3D]=df,ys[An.UNSIGNED_INT_SAMPLER_CUBE]=df,ys[An.UNSIGNED_INT_SAMPLER_2D_ARRAY]=df,ys);function tS(a,o,f){var v=aC[f.type];if(!v)throw new Error("Unknown GLSL uniform type ".concat(f.type));return v().bind(null,a,o)}var sC={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function g_(a){return Object.prototype.toString.call(a)in sC}function Vv(a,o){return"#define ".concat(a," ").concat(o)}function Jb(a){var o={};return a.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(f,v,T){var O=Number(T);return o[v]=isNaN(O)?T:O,""}),o}function ex(a,o){var f=[];return a.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(v,T,O){var L=Number(T);return f.push({location:isNaN(L)?o[T]:L,name:O}),""}),f}function tx(a){var o=[],f=[];return a.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(v,T,O){var L=[];return O.trim().replace(`\r
`,`
`).split(`
`).forEach(function(F){var H=__read(F.trim().split(/\s+/),2),ie=H[0],xe=H[1];L.push({type:ie.trim(),name:xe.replace(";","").trim()})}),f.push({type:T.trim(),uniforms:L}),""}),a.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,function(v,T){return T.trim().replace(`\r
`,`
`).split(`
`).forEach(function(O){var L=O.trim().split(" "),F=L[0]||"",H=L[1]||"",ie=H.indexOf("[")>-1;if(H=H.replace(";","").replace("[","").trim(),!F.startsWith("#")){if(F){var xe=f.find(function(Lt){return F===Lt.type});if(xe)if(ie)for(var Ee=function(Lt){xe.uniforms.forEach(function(an){o.push("".concat(H,"[").concat(Lt,"].").concat(an.name))})},Ye=0;Ye<5;Ye++)Ee(Ye);else xe.uniforms.forEach(function(Lt){o.push("".concat(H,".").concat(Lt.name))})}H&&o.push(H)}}),""}),o}function nx(a){if(a===void 0)return null;var o=/binding\s*=\s*(\d+)/.exec(a);if(o!==null){var f=parseInt(o[1],10);if(!Number.isNaN(f))return f}return null}function rx(a){var o="",f=a;return[f,o]}function Km(a,o,f,v,T){var O;v===void 0&&(v=null),T===void 0&&(T=!0);var L=a.glslVersion==="#version 100",F=o==="frag"&&((O=f.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||O===void 0?void 0:O.length)>1,H=f.replace(`\r
`,`
`).split(`
`).map(function(eo){return eo.replace(/[/][/].*$/,"")}).filter(function(eo){var Wr=!eo||/^\s+$/.test(eo);return!Wr}),ie="";v!==null&&(ie=Object.keys(v).map(function(eo){return Vv(eo,v[eo])}).join(`
`));var xe=H.find(function(eo){return eo.startsWith("precision")})||"precision mediump float;",Ee=T?H.filter(function(eo){return!eo.startsWith("precision")}).join(`
`):H.join(`
`),Ye="";if(a.viewportOrigin===Wp.UPPER_LEFT&&(Ye+="".concat(Vv("VIEWPORT_ORIGIN_TL","1"),`
`)),a.clipSpaceNearZ===kg.ZERO&&(Ye+="".concat(Vv("CLIPSPACE_NEAR_ZERO","1"),`
`)),a.explicitBindingLocations){var Lt=0,an=0,Pn=0;Ee=Ee.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(eo,Wr,Wi,ka){var ws=Wi?"".concat(Wi,", "):"";return"layout(".concat(ws,"set = ").concat(Lt,", binding = ").concat(an++,") uniform ").concat(ka)}),Lt++,an=0,Wa(a.separateSamplerTextures),Ee=Ee.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(eo,Wr,Wi,ka,ws){var ta=nx(Wi);ta===null&&(ta=an++);var ts=(0,go.CR)(rx(ka),2),Us=ts[0],Nh=ts[1];return o==="frag"?`
layout(set = `.concat(Lt,", binding = ").concat(ta*2+0,") uniform texture").concat(Us," T_").concat(ws,`;
layout(set = `).concat(Lt,", binding = ").concat(ta*2+1,") uniform sampler").concat(Nh," S_").concat(ws,";").trim():""}),Ee=Ee.replace(o==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(eo,Wr){return"layout(location = ".concat(Pn++,") ").concat(Wr)}),Ye+="".concat(Vv("gl_VertexID","gl_VertexIndex"),`
`),Ye+="".concat(Vv("gl_InstanceID","gl_InstanceIndex"),`
`),xe=xe.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var sr=0;Ee=Ee.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(eo,Wr,Wi,ka,ws){var ta=nx(Wi);return ta===null&&(ta=sr++),"uniform sampler".concat(ka," ").concat(ws,"; // BINDING=").concat(ta)})}if(Ee=Ee.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return"SAMPLER_".concat(Wr,"(P_").concat(Wi,")")}),Ee=Ee.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return"PP_SAMPLER_".concat(Wr,"(P_").concat(Wi,")")}),Ee=Ee.replace(/\bPU_TEXTURE\((.*?)\)/g,function(eo,Wr){return"TEXTURE(P_".concat(Wr,")")}),a.separateSamplerTextures)Ee=Ee.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){var ka=(0,go.CR)(rx(Wr),2),ws=ka[0],ta=ka[1];return"texture".concat(ws," T_P_").concat(Wi,", sampler").concat(ta," S_P_").concat(Wi)}),Ee=Ee.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return"T_".concat(Wi,", S_").concat(Wi)}),Ee=Ee.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return"sampler".concat(Wr,"(T_").concat(Wi,", S_").concat(Wi,")")}),Ee=Ee.replace(/\bTEXTURE\((.*?)\)/g,function(eo,Wr){return"T_".concat(Wr)});else{var Rr=[];Ee=Ee.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return"sampler".concat(Wr," P_").concat(Wi)}),Ee=Ee.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return Wi}),Ee=Ee.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(eo,Wr,Wi){return Rr.push([Wi,Wr]),Wi}),L&&Rr.forEach(function(eo){var Wr=(0,go.CR)(eo,2),Wi=Wr[0],ka=Wr[1];Ee=Ee.replace(new RegExp("texture\\(".concat(Wi),"g"),function(){return"texture".concat(ka,"(").concat(Wi)})}),Ee=Ee.replace(/\bTEXTURE\((.*?)\)/g,function(eo,Wr){return Wr})}var Tr="".concat(L?"":a.glslVersion,`
`).concat(L&&F?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(L&&o==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(T?xe:"",`
`).concat(Ye||"").concat(ie?ie+`
`:"",`
`).concat(Ee,`
`).trim();if(a.explicitBindingLocations&&o==="frag"&&(Tr=Tr.replace(/^\b(out)\b/g,function(eo,Wr){return"layout(location = 0) ".concat(Wr)})),L){if(o==="frag"&&(Tr=Tr.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(eo,Wr,Wi){return"varying ".concat(Wr," ").concat(Wi,`;
`)})),o==="vert"&&(Tr=Tr.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(eo,Wr,Wi){return"varying ".concat(Wr," ").concat(Wi,`;
`)}),Tr=Tr.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(eo,Wr,Wi){return"attribute ".concat(Wr," ").concat(Wi,`;
`)})),Tr=Tr.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(eo,Wr){return Wr.trim().replace(/^.*$/gm,function(Wi){var ka=Wi.trim();return ka.startsWith("#")?ka:Wi?"uniform ".concat(ka):""})}),o==="frag")if(F){var li=[];Tr=Tr.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(eo,Wr){return li.push(Wr),"vec4 ".concat(Wr,`;
`)});var Ui=Tr.lastIndexOf("}");Tr=Tr.substring(0,Ui)+`
    `.concat(li.map(function(eo,Wr){return"gl_FragData[".concat(Wr,"] = ").concat(eo,`;
    `)}).join(`
`))+Tr.substring(Ui)}else{var Lo;if(Tr=Tr.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(eo,Wr,Wi){return Lo=Wi,"".concat(Wr," ").concat(Wi,`;
`)}),Lo){var Ui=Tr.lastIndexOf("}");Tr=Tr.substring(0,Ui)+`
  gl_FragColor = vec4(`.concat(Lo,`);
`)+Tr.substring(Ui)}}Tr=Tr.replace(/^\s*layout\((.*)\)/gm,"")}return Tr}function CP(a,o,f,v){v===void 0&&(v=null);var T=Km(a,"vert",o,v),O=Km(a,"frag",f,v);return{vert:o,frag:f,preprocessedVert:T,preprocessedFrag:O}}var pp=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this)||this;return O.id=v,O.device=T,O.device.resourceCreationTracker!==null&&O.device.resourceCreationTracker.trackResourceCreated(O),O}return o.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},o}(Gm),nS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.Bindings;var F=O.uniformBufferBindings,H=O.samplerBindings;return L.uniformBufferBindings=F||[],L.samplerBindings=H||[],L.bindingLayouts=L.createBindingLayouts(),L}return o.prototype.createBindingLayouts=function(){var f=0,v=0,T=[],O=this.uniformBufferBindings.length,L=this.samplerBindings.length;return T.push({firstUniformBuffer:f,numUniformBuffers:O,firstSampler:v,numSamplers:L}),f+=O,v+=L,{numUniformBuffers:f,numSamplers:v,bindingLayoutTables:T}},o}(pp);function Bo(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}function qm(a){var o=A0(a);switch(o){case oi.BC1:case oi.BC2:case oi.BC3:case oi.BC4_UNORM:case oi.BC4_SNORM:case oi.BC5_UNORM:case oi.BC5_SNORM:return!0;default:return!1}}function Gf(a){var o=nm(a);if(o&ho.Normalized)return!1;var f=A0(a);return f===oi.S8||f===oi.S16||f===oi.S32||f===oi.U8||f===oi.U16||f===oi.U32}function lC(a){switch(a){case dp.STATIC:return An.STATIC_DRAW;case dp.DYNAMIC:return An.DYNAMIC_DRAW}}function y_(a){if(a&al.INDEX)return An.ELEMENT_ARRAY_BUFFER;if(a&al.VERTEX)return An.ARRAY_BUFFER;if(a&al.UNIFORM)return An.UNIFORM_BUFFER}function cC(a){switch(a){case vu.TRIANGLES:return An.TRIANGLES;case vu.POINTS:return An.POINTS;case vu.TRIANGLE_STRIP:return An.TRIANGLE_STRIP;case vu.LINES:return An.LINES;case vu.LINE_STRIP:return An.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function rS(a){switch(a){case oi.U8:return An.UNSIGNED_BYTE;case oi.U16:return An.UNSIGNED_SHORT;case oi.U32:return An.UNSIGNED_INT;case oi.S8:return An.BYTE;case oi.S16:return An.SHORT;case oi.S32:return An.INT;case oi.F16:return An.HALF_FLOAT;case oi.F32:return An.FLOAT;default:throw new Error("whoops")}}function ix(a){switch(a){case Ao.R:return 1;case Ao.RG:return 2;case Ao.RGB:return 3;case Ao.RGBA:return 4;default:return 1}}function om(a){var o=A0(a),f=c_(a),v=nm(a),T=rS(o),O=ix(f),L=!!(v&ho.Normalized);return{size:O,type:T,normalized:L}}function iS(a){switch(a){case Yn.U8_R:return An.UNSIGNED_BYTE;case Yn.U16_R:return An.UNSIGNED_SHORT;case Yn.U32_R:return An.UNSIGNED_INT;default:throw new Error("whoops")}}function Ky(a){switch(a){case Zf.CLAMP_TO_EDGE:return An.CLAMP_TO_EDGE;case Zf.REPEAT:return An.REPEAT;case Zf.MIRRORED_REPEAT:return An.MIRRORED_REPEAT;default:throw new Error("whoops")}}function __(a,o){if(o===Wu.LINEAR&&a===tc.BILINEAR)return An.LINEAR_MIPMAP_LINEAR;if(o===Wu.LINEAR&&a===tc.POINT)return An.NEAREST_MIPMAP_LINEAR;if(o===Wu.NEAREST&&a===tc.BILINEAR)return An.LINEAR_MIPMAP_NEAREST;if(o===Wu.NEAREST&&a===tc.POINT)return An.NEAREST_MIPMAP_NEAREST;if(o===Wu.NO_MIP&&a===tc.BILINEAR)return An.LINEAR;if(o===Wu.NO_MIP&&a===tc.POINT)return An.NEAREST;throw new Error("Unknown texture filter mode")}function Vg(a,o){o===void 0&&(o=0);var f=a;return f.gl_buffer_pages[o/f.pageByteSize|0]}function Hg(a){var o=a;return o.gl_texture}function ox(a){var o=a;return o.gl_sampler}function qy(a,o){a.name=o,a.__SPECTOR_Metadata={name:o}}function ax(a,o){for(var f=[];;){var v=o.exec(a);if(!v)break;f.push(v)}return f}function Yp(a){return a.blendMode==mu.ADD&&a.blendSrcFactor==fs.ONE&&a.blendDstFactor===fs.ZERO}function oS(a){switch(a){case l_.OcclusionConservative:return An.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function aS(a){if(a===ss.TEXTURE_2D)return An.TEXTURE_2D;if(a===ss.TEXTURE_2D_ARRAY)return An.TEXTURE_2D_ARRAY;if(a===ss.TEXTURE_CUBE_MAP)return An.TEXTURE_CUBE_MAP;if(a===ss.TEXTURE_3D)return An.TEXTURE_3D;throw new Error("whoops")}function sx(a,o,f,v){return!(a%f!==0||o%v!==0)}var C0=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.Buffer;var F=O.viewOrSize,H=O.usage,ie=O.hint,xe=ie===void 0?dp.STATIC:ie,Ee=T.uniformBufferMaxPageByteSize,Ye=T.gl,Lt=H&al.UNIFORM;Lt||(Bo(Ye)?Ye.bindVertexArray(null):T.OES_vertex_array_object.bindVertexArrayOES(null));var an=(0,Fg.Z)(F)?Wb(F,4):Wb(F.byteLength,4);L.gl_buffer_pages=[];var Pn;if(Lt){for(var sr=an;sr>0;)L.gl_buffer_pages.push(L.createBufferPage(Math.min(sr,Ee),H,xe)),sr-=Ee;Pn=Ee}else L.gl_buffer_pages.push(L.createBufferPage(an,H,xe)),Pn=an;return L.pageByteSize=Pn,L.byteSize=an,L.usage=H,L.gl_target=y_(H),(0,Fg.Z)(F)||L.setSubData(0,new Uint8Array(F.buffer)),Lt||(Bo(Ye)?Ye.bindVertexArray(L.device.currentBoundVAO):T.OES_vertex_array_object.bindVertexArrayOES(L.device.currentBoundVAO)),L}return o.prototype.setSubData=function(f,v,T,O){T===void 0&&(T=0),O===void 0&&(O=v.byteLength-T);for(var L=this.device.gl,F=this.pageByteSize,H=f+O,ie=f,xe=f%F;ie<H;){var Ee=Bo(L)?L.COPY_WRITE_BUFFER:this.gl_target,Ye=Vg(this,ie);if(Ye.ubo)return;L.bindBuffer(Ee,Ye),Bo(L)?L.bufferSubData(Ee,xe,v,T,Math.min(H-ie,F)):L.bufferSubData(Ee,xe,v),ie+=F,xe=0,T+=F,this.device.debugGroupStatisticsBufferUpload()}},o.prototype.destroy=function(){a.prototype.destroy.call(this);for(var f=0;f<this.gl_buffer_pages.length;f++)this.gl_buffer_pages[f].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[f]);this.gl_buffer_pages=[]},o.prototype.createBufferPage=function(f,v,T){var O=this.device.gl,L=v&al.UNIFORM;if(!Bo(O)&&L)return{ubo:!0};var F=this.device.ensureResourceExists(O.createBuffer()),H=y_(v),ie=lC(T);return O.bindBuffer(H,F),O.bufferData(H,f,ie),F},o}(pp),uC=function(a){(0,go.ZT)(o,a);function o(f){var v,T,O,L,F=f.id,H=f.device,ie=f.descriptor,xe,Ee=a.call(this,{id:F,device:H})||this;Ee.type=Bs.InputLayout;var Ye=ie.vertexBufferDescriptors,Lt=ie.indexBufferFormat,an=ie.program;Wa(Lt===Yn.U16_R||Lt===Yn.U32_R||Lt===null);var Pn=Lt!==null?iS(Lt):null,sr=Lt!==null?FA(Lt):null,Rr=Ee.device.gl,Tr=Ee.device.ensureResourceExists(Bo(Rr)?Rr.createVertexArray():H.OES_vertex_array_object.createVertexArrayOES());Bo(Rr)?Rr.bindVertexArray(Tr):H.OES_vertex_array_object.bindVertexArrayOES(Tr),Rr.bindBuffer(Rr.ARRAY_BUFFER,Vg(Ee.device.fallbackVertexBuffer));try{for(var li=(0,go.XA)(ie.vertexBufferDescriptors),Ui=li.next();!Ui.done;Ui=li.next()){var Lo=Ui.value,eo=Lo.stepMode,Wr=Lo.attributes;try{for(var Wi=(O=void 0,(0,go.XA)(Wr)),ka=Wi.next();!ka.done;ka=Wi.next()){var ws=ka.value,ta=ws.shaderLocation,ts=ws.format,Us=ws.divisor,Nh=Us===void 0?1:Us,Bh=Bo(Rr)?ta:(xe=an.attributes[ta])===null||xe===void 0?void 0:xe.location,Fh=om(ts);if(ws.vertexFormat=Fh,!(0,hp.Z)(Bh)){Gf(ts);var dh=Fh.size,tv=Fh.type,hd=Fh.normalized;Rr.vertexAttribPointer(Bh,dh,tv,hd,0,0),eo===Xm.INSTANCE&&(Bo(Rr)?Rr.vertexAttribDivisor(Bh,Nh):H.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(Bh,Nh)),Rr.enableVertexAttribArray(Bh)}}}catch(qg){O={error:qg}}finally{try{ka&&!ka.done&&(L=Wi.return)&&L.call(Wi)}finally{if(O)throw O.error}}}}catch(qg){v={error:qg}}finally{try{Ui&&!Ui.done&&(T=li.return)&&T.call(li)}finally{if(v)throw v.error}}return Bo(Rr)?Rr.bindVertexArray(null):H.OES_vertex_array_object.bindVertexArrayOES(null),Ee.vertexBufferDescriptors=Ye,Ee.vao=Tr,Ee.indexBufferFormat=Lt,Ee.indexBufferType=Pn,Ee.indexBufferCompByteSize=sr,Ee.program=an,Ee}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Bo(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},o}(pp),lx=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=f.fake,F=a.call(this,{id:v,device:T})||this;F.type=Bs.Texture,O=(0,go.pi)({dimension:ss.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},O);var H=F.device.gl,ie,xe,Ee=F.clampmipLevelCount(O);if(F.immutable=O.usage===Wf.RENDER_TARGET,F.pixelStore=O.pixelStore,F.format=O.format,F.dimension=O.dimension,F.formatKind=f_(O.format),F.width=O.width,F.height=O.height,F.depthOrArrayLayers=O.depthOrArrayLayers,F.mipmaps=Ee>=1,!L){xe=F.device.ensureResourceExists(H.createTexture());var Ye=F.device.translateTextureType(O.format),Lt=F.device.translateTextureInternalFormat(O.format);if(F.device.setActiveTexture(H.TEXTURE0),F.device.currentTextures[0]=null,F.preprocessImage(),O.dimension===ss.TEXTURE_2D){if(ie=An.TEXTURE_2D,H.bindTexture(ie,xe),F.immutable)if(Bo(H))H.texStorage2D(ie,Ee,Lt,O.width,O.height);else{var an=(Lt===An.DEPTH_COMPONENT||F.isNPOT(),0);(F.format===Yn.D32F||F.format===Yn.D24_S8)&&!Bo(H)&&!T.WEBGL_depth_texture||(H.texImage2D(ie,an,Lt,O.width,O.height,0,Lt,Ye,null),F.mipmaps&&(F.mipmaps=!1,H.texParameteri(An.TEXTURE_2D,An.TEXTURE_MIN_FILTER,An.LINEAR),H.texParameteri(An.TEXTURE_2D,An.TEXTURE_WRAP_S,An.CLAMP_TO_EDGE),H.texParameteri(An.TEXTURE_2D,An.TEXTURE_WRAP_T,An.CLAMP_TO_EDGE)))}Wa(O.depthOrArrayLayers===1)}else if(O.dimension===ss.TEXTURE_2D_ARRAY)ie=An.TEXTURE_2D_ARRAY,H.bindTexture(ie,xe),F.immutable&&Bo(H)&&H.texStorage3D(ie,Ee,Lt,O.width,O.height,O.depthOrArrayLayers);else if(O.dimension===ss.TEXTURE_3D)ie=An.TEXTURE_3D,H.bindTexture(ie,xe),F.immutable&&Bo(H)&&H.texStorage3D(ie,Ee,Lt,O.width,O.height,O.depthOrArrayLayers);else if(O.dimension===ss.TEXTURE_CUBE_MAP)ie=An.TEXTURE_CUBE_MAP,H.bindTexture(ie,xe),F.immutable&&Bo(H)&&H.texStorage2D(ie,Ee,Lt,O.width,O.height),Wa(O.depthOrArrayLayers===6);else throw new Error("whoops")}return F.gl_texture=xe,F.gl_target=ie,F.mipLevelCount=Ee,F}return o.prototype.setImageData=function(f,v){v===void 0&&(v=0);var T=this.device.gl;qm(this.format);var O=this.gl_target===An.TEXTURE_3D||this.gl_target===An.TEXTURE_2D_ARRAY,L=this.gl_target===An.TEXTURE_CUBE_MAP,F=g_(f[0]);this.device.setActiveTexture(T.TEXTURE0),this.device.currentTextures[0]=null;var H=f[0],ie,xe;F?(ie=this.width,xe=this.height):(ie=H.width,xe=H.height,this.width=ie,this.height=xe),T.bindTexture(this.gl_target,this.gl_texture);var Ee=this.device.translateTextureFormat(this.format),Ye=Bo(T)?this.device.translateInternalTextureFormat(this.format):Ee,Lt=this.device.translateTextureType(this.format);this.preprocessImage();for(var an=0;an<this.depthOrArrayLayers;an++){var Pn=f[an],sr=this.gl_target;L&&(sr=An.TEXTURE_CUBE_MAP_POSITIVE_X+an%6),this.immutable?T.texSubImage2D(sr,v,0,0,ie,xe,Ee,Lt,Pn):Bo(T)?O?T.texImage3D(sr,v,Ye,ie,xe,this.depthOrArrayLayers,0,Ee,Lt,Pn):T.texImage2D(sr,v,Ye,ie,xe,0,Ee,Lt,Pn):F?T.texImage2D(sr,v,Ee,ie,xe,0,Ee,Lt,Pn):T.texImage2D(sr,v,Ee,Ee,Lt,Pn)}this.mipmaps&&this.generateMipmap(O)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.gl.deleteTexture(Hg(this))},o.prototype.clampmipLevelCount=function(f){if(f.dimension===ss.TEXTURE_2D_ARRAY&&f.depthOrArrayLayers>1){var v=A0(f.format);if(v===oi.BC1)for(var T=f.width,O=f.height,L=0;L<f.mipLevelCount;L++){if(T<=2||O<=2)return L-1;T=Math.max(T/2|0,1),O=Math.max(O/2|0,1)}}return f.mipLevelCount},o.prototype.preprocessImage=function(){var f=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&f.pixelStorei(An.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&f.pixelStorei(An.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&f.pixelStorei(An.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},o.prototype.generateMipmap=function(f){f===void 0&&(f=!1);var v=this.device.gl;return!Bo(v)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(v.bindTexture(this.gl_target,this.gl_texture),f?(v.texParameteri(this.gl_target,An.TEXTURE_BASE_LEVEL,0),v.texParameteri(this.gl_target,An.TEXTURE_MAX_LEVEL,Math.log2(this.width)),v.texParameteri(this.gl_target,An.TEXTURE_MIN_FILTER,An.LINEAR_MIPMAP_LINEAR),v.texParameteri(this.gl_target,An.TEXTURE_MAG_FILTER,An.LINEAR)):v.texParameteri(An.TEXTURE_2D,An.TEXTURE_MIN_FILTER,An.NEAREST_MIPMAP_LINEAR),v.generateMipmap(this.gl_target),v.bindTexture(this.gl_target,null)),this)},o.prototype.isNPOT=function(){var f=this.device.gl;return Bo(f)?!1:!d_(this.width)||!d_(this.height)},o}(pp),sS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.RenderTarget,L.gl_renderbuffer=null,L.texture=null;var F=L.device.gl,H=O.format,ie=O.width,xe=O.height,Ee=O.sampleCount,Ye=Ee===void 0?1:Ee,Lt=O.texture,an=!1;if((H===Yn.D32F||H===Yn.D24_S8)&&Lt&&!Bo(F)&&!T.WEBGL_depth_texture&&(Lt.destroy(),L.texture=null,an=!0),!an&&Lt)L.texture=Lt;else{L.gl_renderbuffer=L.device.ensureResourceExists(F.createRenderbuffer()),F.bindRenderbuffer(F.RENDERBUFFER,L.gl_renderbuffer);var Pn=L.device.translateTextureInternalFormat(H,!0);Bo(F)&&Ye>1?F.renderbufferStorageMultisample(An.RENDERBUFFER,Ye,Pn,ie,xe):F.renderbufferStorage(An.RENDERBUFFER,Pn,ie,xe)}return L.format=H,L.width=ie,L.height=xe,L.sampleCount=Ye,L}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},o}(pp),fd;(function(a){a[a.NeedsCompile=0]="NeedsCompile",a[a.Compiling=1]="Compiling",a[a.NeedsBind=2]="NeedsBind",a[a.ReadyToUse=3]="ReadyToUse"})(fd||(fd={}));var b_=function(a){(0,go.ZT)(o,a);function o(f,v){var T=f.id,O=f.device,L=f.descriptor,F=a.call(this,{id:T,device:O})||this;F.rawVertexGLSL=v,F.type=Bs.Program,F.uniformSetters={},F.attributes=[];var H=F.device.gl;return F.descriptor=L,F.gl_program=F.device.ensureResourceExists(H.createProgram()),F.gl_shader_vert=null,F.gl_shader_frag=null,F.compileState=fd.NeedsCompile,F.tryCompileProgram(),F}return o.prototype.destroy=function(){a.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},o.prototype.tryCompileProgram=function(){Wa(this.compileState===fd.NeedsCompile);var f=this.descriptor,v=f.vertex,T=f.fragment,O=this.device.gl;v!=null&&v.glsl&&(T!=null&&T.glsl)&&(this.gl_shader_vert=this.compileShader(v.postprocess?v.postprocess(v.glsl):v.glsl,O.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(T.postprocess?T.postprocess(T.glsl):T.glsl,O.FRAGMENT_SHADER),O.attachShader(this.gl_program,this.gl_shader_vert),O.attachShader(this.gl_program,this.gl_shader_frag),O.linkProgram(this.gl_program),this.compileState=fd.Compiling,Bo(O)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},o.prototype.readAttributesFromLinkedProgram=function(){for(var f,v=this.device.gl,T=v.getProgramParameter(this.gl_program,v.ACTIVE_ATTRIBUTES),O=Jb(this.descriptor.vertex.glsl),L=ex(this.rawVertexGLSL,O),F=function(xe){var Ee=v.getActiveAttrib(H.gl_program,xe),Ye=Ee.name,Lt=Ee.type,an=Ee.size,Pn=v.getAttribLocation(H.gl_program,Ye),sr=(f=L.find(function(Rr){return Rr.name===Ye}))===null||f===void 0?void 0:f.location;Pn>=0&&!(0,hp.Z)(sr)&&(H.attributes[sr]={name:Ye,location:Pn,type:Lt,size:an})},H=this,ie=0;ie<T;ie++)F(ie)},o.prototype.readUniformLocationsFromLinkedProgram=function(){for(var f=this.device.gl,v=f.getProgramParameter(this.gl_program,f.ACTIVE_UNIFORMS),T=0;T<v;T++){var O=f.getActiveUniform(this.gl_program,T),L=jv(O.name).name,F=f.getUniformLocation(this.gl_program,L);if(this.uniformSetters[L]=tS(f,F,O),O&&O.size>1)for(var H=0;H<O.size;H++)F=f.getUniformLocation(this.gl_program,"".concat(L,"[").concat(H,"]")),this.uniformSetters["".concat(L,"[").concat(H,"]")]=tS(f,F,O)}},o.prototype.compileShader=function(f,v){var T=this.device.gl,O=this.device.ensureResourceExists(T.createShader(v));return T.shaderSource(O,f),T.compileShader(O),O},o.prototype.setUniformsLegacy=function(f){f===void 0&&(f={});var v=this.device.gl;if(!Bo(v)){var T=!1;for(var O in f){T||(v.useProgram(this.gl_program),T=!0);var L=f[O],F=this.uniformSetters[O];if(F){var H=L;H instanceof lx&&(H=H.textureIndex),F(H)}}}return this},o}(pp),lS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.QueryPool;var F=L.device.gl;if(Bo(F)){var H=O.elemCount,ie=O.type;L.gl_query=VA(H,function(){return L.device.ensureResourceExists(F.createQuery())}),L.gl_query_type=oS(ie)}return L}return o.prototype.queryResultOcclusion=function(f){var v=this.device.gl;if(Bo(v)){var T=this.gl_query[f];return v.getQueryParameter(T,v.QUERY_RESULT_AVAILABLE)?!!v.getQueryParameter(T,v.QUERY_RESULT):null}return null},o.prototype.destroy=function(){a.prototype.destroy.call(this);var f=this.device.gl;if(Bo(f))for(var v=0;v<this.gl_query.length;v++)f.deleteQuery(this.gl_query[v])},o}(pp),cS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this,{id:v,device:T})||this;return O.type=Bs.Readback,O.gl_pbo=null,O.gl_sync=null,O}return o.prototype.clientWaitAsync=function(f,v,T){v===void 0&&(v=0),T===void 0&&(T=10);var O=this.device.gl;return new Promise(function(L,F){function H(){var ie=O.clientWaitSync(f,v,0);if(ie==O.WAIT_FAILED){F();return}if(ie==O.TIMEOUT_EXPIRED){setTimeout(H,(0,NA.Z)(T,0,O.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}L()}H()})},o.prototype.getBufferSubDataAsync=function(f,v,T,O,L,F){return(0,go.mG)(this,void 0,void 0,function(){var H;return(0,go.Jh)(this,function(ie){switch(ie.label){case 0:return H=this.device.gl,Bo(H)?(this.gl_sync=H.fenceSync(H.SYNC_GPU_COMMANDS_COMPLETE,0),H.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return ie.sent(),H.bindBuffer(f,v),H.getBufferSubData(f,T,O,L,F),H.bindBuffer(f,null),[2,O];case 2:return[2]}})})},o.prototype.readTexture=function(f,v,T,O,L,F,H,ie){return H===void 0&&(H=0),ie===void 0&&(ie=F.byteLength||0),(0,go.mG)(this,void 0,void 0,function(){var xe,Ee,Ye,Lt,an;return(0,go.Jh)(this,function(Pn){return xe=this.device.gl,Ee=f,Ye=this.device.translateTextureFormat(Ee.format),Lt=this.device.translateTextureType(Ee.format),an=jE(Ee.format),Bo(xe)?(this.gl_pbo=this.device.ensureResourceExists(xe.createBuffer()),xe.bindBuffer(xe.PIXEL_PACK_BUFFER,this.gl_pbo),xe.bufferData(xe.PIXEL_PACK_BUFFER,ie,xe.STREAM_READ),xe.bindBuffer(xe.PIXEL_PACK_BUFFER,null),xe.bindFramebuffer(An.READ_FRAMEBUFFER,this.device.readbackFramebuffer),xe.framebufferTexture2D(An.READ_FRAMEBUFFER,An.COLOR_ATTACHMENT0,An.TEXTURE_2D,Ee.gl_texture,0),xe.bindBuffer(xe.PIXEL_PACK_BUFFER,this.gl_pbo),xe.readPixels(v,T,O,L,Ye,Lt,H*an),xe.bindBuffer(xe.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(xe.PIXEL_PACK_BUFFER,this.gl_pbo,0,F,H,0)]):[2,this.readTextureSync(f,v,T,O,L,F,H,ie)]})})},o.prototype.readTextureSync=function(f,v,T,O,L,F,H,ie){ie===void 0&&(ie=F.byteLength||0);var xe=this.device.gl,Ee=f,Ye=this.device.translateTextureType(Ee.format);return xe.bindFramebuffer(An.FRAMEBUFFER,this.device.readbackFramebuffer),xe.framebufferTexture2D(An.FRAMEBUFFER,An.COLOR_ATTACHMENT0,An.TEXTURE_2D,Ee.gl_texture,0),xe.pixelStorei(xe.PACK_ALIGNMENT,4),xe.readPixels(v,T,O,L,xe.RGBA,Ye,F),F},o.prototype.readBuffer=function(f,v,T,O,L){return(0,go.mG)(this,void 0,void 0,function(){var F;return(0,go.Jh)(this,function(H){return F=this.device.gl,Bo(F)?[2,this.getBufferSubDataAsync(F.ARRAY_BUFFER,Vg(f,v),v,T,O,L)]:[2,Promise.reject()]})})},o.prototype.destroy=function(){a.prototype.destroy.call(this),Bo(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},o}(pp),uS=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;return H.type=Bs.RenderPipeline,H.drawMode=cC((L=O.topology)!==null&&L!==void 0?L:vu.TRIANGLES),H.program=O.program,H.inputLayout=O.inputLayout,H.megaState=(0,go.pi)((0,go.pi)({},Ug(rm)),O.megaStateDescriptor),H.colorAttachmentFormats=O.colorAttachmentFormats.slice(),H.depthStencilAttachmentFormat=O.depthStencilAttachmentFormat,H.sampleCount=(F=O.sampleCount)!==null&&F!==void 0?F:1,H}return o}(pp),fC=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;return L.type=Bs.ComputePipeline,L.descriptor=O,L}return o}(pp),hC=function(){function a(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return a.prototype.trackResourceCreated=function(o){this.creationStacks.set(o,new Error().stack),this.liveObjects.add(o)},a.prototype.trackResourceDestroyed=function(o){this.deletionStacks.has(o)&&console.warn("Object double freed:",o,`

Creation stack: `,this.creationStacks.get(o),`

Deletion stack: `,this.deletionStacks.get(o),`

This stack: `,new Error().stack),this.deletionStacks.set(o,new Error().stack),this.liveObjects.delete(o)},a.prototype.checkForLeaks=function(){var o,f;try{for(var v=(0,go.XA)(this.liveObjects.values()),T=v.next();!T.done;T=v.next()){var O=T.value;console.warn("Object leaked:",O,"Creation stack:",this.creationStacks.get(O))}}catch(L){o={error:L}}finally{try{T&&!T.done&&(f=v.return)&&f.call(v)}finally{if(o)throw o.error}}},a.prototype.setResourceLeakCheck=function(o,f){f?this.liveObjects.add(o):this.liveObjects.delete(o)},a}(),dC=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;H.type=Bs.Sampler;var ie=H.device.gl;if(Bo(ie)){var xe=H.device.ensureResourceExists(ie.createSampler());ie.samplerParameteri(xe,An.TEXTURE_WRAP_S,Ky(O.addressModeU)),ie.samplerParameteri(xe,An.TEXTURE_WRAP_T,Ky(O.addressModeV)),ie.samplerParameteri(xe,An.TEXTURE_WRAP_R,Ky((L=O.addressModeW)!==null&&L!==void 0?L:O.addressModeU)),ie.samplerParameteri(xe,An.TEXTURE_MIN_FILTER,__(O.minFilter,O.mipmapFilter)),ie.samplerParameteri(xe,An.TEXTURE_MAG_FILTER,__(O.magFilter,Wu.NO_MIP)),O.lodMinClamp!==void 0&&ie.samplerParameterf(xe,An.TEXTURE_MIN_LOD,O.lodMinClamp),O.lodMaxClamp!==void 0&&ie.samplerParameterf(xe,An.TEXTURE_MAX_LOD,O.lodMaxClamp),O.compareFunction!==void 0&&(ie.samplerParameteri(xe,ie.TEXTURE_COMPARE_MODE,ie.COMPARE_REF_TO_TEXTURE),ie.samplerParameteri(xe,ie.TEXTURE_COMPARE_FUNC,O.compareFunction));var Ee=(F=O.maxAnisotropy)!==null&&F!==void 0?F:1;Ee>1&&H.device.EXT_texture_filter_anisotropic!==null&&(Wa(O.minFilter===tc.BILINEAR&&O.magFilter===tc.BILINEAR&&O.mipmapFilter===Wu.LINEAR),ie.samplerParameterf(xe,H.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ee)),H.gl_sampler=xe}else H.descriptor=O;return H}return o.prototype.setTextureParameters=function(f,v,T){var O,L=this.device.gl,F=this.descriptor;this.isNPOT(v,T)?L.texParameteri(An.TEXTURE_2D,An.TEXTURE_MIN_FILTER,An.LINEAR):L.texParameteri(f,An.TEXTURE_MIN_FILTER,__(F.minFilter,F.mipmapFilter)),L.texParameteri(An.TEXTURE_2D,An.TEXTURE_WRAP_S,Ky(F.addressModeU)),L.texParameteri(An.TEXTURE_2D,An.TEXTURE_WRAP_T,Ky(F.addressModeV)),L.texParameteri(f,An.TEXTURE_MAG_FILTER,__(F.magFilter,Wu.NO_MIP));var H=(O=F.maxAnisotropy)!==null&&O!==void 0?O:1;H>1&&this.device.EXT_texture_filter_anisotropic!==null&&(Wa(F.minFilter===tc.BILINEAR&&F.magFilter===tc.BILINEAR&&F.mipmapFilter===Wu.LINEAR),L.texParameteri(f,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H))},o.prototype.destroy=function(){a.prototype.destroy.call(this),Bo(this.device.gl)&&this.device.gl.deleteSampler(ox(this))},o.prototype.isNPOT=function(f,v){return!d_(f)||!d_(v)},o}(pp),fS=function(){function a(){}return a.prototype.dispatchWorkgroups=function(o,f,v){},a.prototype.dispatchWorkgroupsIndirect=function(o,f){},a.prototype.setPipeline=function(o){},a.prototype.setBindings=function(o){},a.prototype.pushDebugGroup=function(o){},a.prototype.popDebugGroup=function(){},a.prototype.insertDebugMarker=function(o){},a}(),pC=function(a){(0,go.ZT)(o,a);function o(){var f=a!==null&&a.apply(this,arguments)||this;return f.type=Bs.RenderBundle,f.commands=[],f}return o.prototype.push=function(f){this.commands.push(f)},o.prototype.replay=function(){this.commands.forEach(function(f){return f()})},o}(pp),hS=65536,mC=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,vC=function(){function a(o,f){f===void 0&&(f={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=Ug(rm),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Wp.LOWER_LEFT,this.clipSpaceNearZ=kg.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=o,this.contextAttributes=kv(o.getContextAttributes()),Bo(o)?(this.EXT_texture_norm16=o.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=o.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=o.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=o.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=o.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=o.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=o.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=o.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=o.getExtension("EXT_color_buffer_half_float"),o.getExtension("EXT_frag_depth"),o.getExtension("OES_element_index_uint"),o.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=o.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=o.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=o.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=o.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=o.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=o.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=o.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=o.getExtension("KHR_parallel_shader_compile"),Bo(o)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new lx({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:ss.TEXTURE_2D,mipLevelCount:1,usage:Wf.RENDER_TARGET,format:this.contextAttributes.alpha===!1?Yn.U8_RGB_RT:Yn.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=mc.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(o.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(ss.TEXTURE_2D,mc.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(ss.TEXTURE_2D,mc.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:al.VERTEX,hint:dp.STATIC}),Bo(o)&&(this.fallbackTexture2DArray=this.createFallbackTexture(ss.TEXTURE_2D_ARRAY,mc.Float),this.fallbackTexture3D=this.createFallbackTexture(ss.TEXTURE_3D,mc.Float),this.fallbackTextureCube=this.createFallbackTexture(ss.TEXTURE_CUBE_MAP,mc.Float)),this.currentMegaState.depthCompare=$a.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=hf.ALL,o.enable(o.DEPTH_TEST),o.enable(o.STENCIL_TEST),this.checkLimits(),f.shaderDebug&&(this.shaderDebug=!0),f.trackResources&&(this.resourceCreationTracker=new hC)}return a.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},a.prototype.createFallbackTexture=function(o,f){var v=o===ss.TEXTURE_CUBE_MAP?6:1,T=f===mc.Depth?Yn.D32F:Yn.U8_RGBA_NORM,O=this.createTexture({dimension:o,format:T,usage:Wf.SAMPLED,width:1,height:1,depthOrArrayLayers:v,mipLevelCount:1});return f===mc.Float&&O.setImageData([new Uint8Array(4*v)]),Hg(O)},a.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},a.prototype.checkLimits=function(){var o=this.gl;if(this.maxVertexAttribs=o.getParameter(An.MAX_VERTEX_ATTRIBS),Bo(o)){this.uniformBufferMaxPageByteSize=Math.min(o.getParameter(An.MAX_UNIFORM_BLOCK_SIZE),hS),this.uniformBufferWordAlignment=o.getParameter(o.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var f=o.getInternalformatParameter(o.RENDERBUFFER,o.DEPTH32F_STENCIL8,o.SAMPLES);this.supportedSampleCounts=f?(0,go.ev)([],(0,go.CR)(f),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=hS;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(v,T){return v-T})},a.prototype.configureSwapChain=function(o,f,v){var T=this.scTexture;T.width=o,T.height=f,this.scPlatformFramebuffer=Zb(v)},a.prototype.getDevice=function(){return this},a.prototype.getCanvas=function(){return this.gl.canvas},a.prototype.getOnscreenTexture=function(){return this.scTexture},a.prototype.beginFrame=function(){},a.prototype.endFrame=function(){},a.prototype.translateTextureInternalFormat=function(o,f){switch(f===void 0&&(f=!1),o){case Yn.ALPHA:return An.ALPHA;case Yn.U8_LUMINANCE:case Yn.F16_LUMINANCE:case Yn.F32_LUMINANCE:return An.LUMINANCE;case Yn.F16_R:return An.R16F;case Yn.F16_RG:return An.RG16F;case Yn.F16_RGB:return An.RGB16F;case Yn.F16_RGBA:return An.RGBA16F;case Yn.F32_R:return An.R32F;case Yn.F32_RG:return An.RG32F;case Yn.F32_RGB:return An.RGB32F;case Yn.F32_RGBA:return Bo(this.gl)?An.RGBA32F:f?this.WEBGL_color_buffer_float.RGBA32F_EXT:An.RGBA;case Yn.U8_R_NORM:return An.R8;case Yn.U8_RG_NORM:return An.RG8;case Yn.U8_RGB_NORM:case Yn.U8_RGB_RT:return An.RGB8;case Yn.U8_RGB_SRGB:return An.SRGB8;case Yn.U8_RGBA_NORM:case Yn.U8_RGBA_RT:return Bo(this.gl)?An.RGBA8:f?An.RGBA4:An.RGBA;case Yn.U8_RGBA:return An.RGBA;case Yn.U8_RGBA_SRGB:case Yn.U8_RGBA_RT_SRGB:return An.SRGB8_ALPHA8;case Yn.U16_R:return An.R16UI;case Yn.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case Yn.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case Yn.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case Yn.U16_RGBA_5551:return An.RGB5_A1;case Yn.U16_RGB_565:return An.RGB565;case Yn.U32_R:return An.R32UI;case Yn.S8_RGBA_NORM:return An.RGBA8_SNORM;case Yn.S8_RG_NORM:return An.RG8_SNORM;case Yn.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case Yn.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case Yn.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case Yn.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case Yn.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case Yn.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case Yn.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case Yn.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case Yn.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case Yn.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case Yn.D32F_S8:return Bo(this.gl)?An.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?An.DEPTH_STENCIL:An.DEPTH_COMPONENT16;case Yn.D24_S8:return Bo(this.gl)?An.DEPTH24_STENCIL8:this.WEBGL_depth_texture?An.DEPTH_STENCIL:An.DEPTH_COMPONENT16;case Yn.D32F:return Bo(this.gl)?An.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?An.DEPTH_COMPONENT:An.DEPTH_COMPONENT16;case Yn.D24:return Bo(this.gl)?An.DEPTH_COMPONENT24:this.WEBGL_depth_texture?An.DEPTH_COMPONENT:An.DEPTH_COMPONENT16;default:throw new Error("whoops")}},a.prototype.translateTextureType=function(o){var f=A0(o);switch(f){case oi.U8:return An.UNSIGNED_BYTE;case oi.U16:return An.UNSIGNED_SHORT;case oi.U32:return An.UNSIGNED_INT;case oi.S8:return An.BYTE;case oi.F16:return An.HALF_FLOAT;case oi.F32:return An.FLOAT;case oi.U16_PACKED_5551:return An.UNSIGNED_SHORT_5_5_5_1;case oi.D32F:return Bo(this.gl)?An.FLOAT:this.WEBGL_depth_texture?An.UNSIGNED_INT:An.UNSIGNED_BYTE;case oi.D24:return Bo(this.gl)?An.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?An.UNSIGNED_SHORT:An.UNSIGNED_BYTE;case oi.D24S8:return Bo(this.gl)?An.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?An.UNSIGNED_INT_24_8_WEBGL:An.UNSIGNED_BYTE;case oi.D32FS8:return An.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},a.prototype.translateInternalTextureFormat=function(o){switch(o){case Yn.F32_R:return An.R32F;case Yn.F32_RG:return An.RG32F;case Yn.F32_RGB:return An.RGB32F;case Yn.F32_RGBA:return An.RGBA32F;case Yn.F16_R:return An.R16F;case Yn.F16_RG:return An.RG16F;case Yn.F16_RGB:return An.RGB16F;case Yn.F16_RGBA:return An.RGBA16F}return this.translateTextureFormat(o)},a.prototype.translateTextureFormat=function(o){if(qm(o)||o===Yn.F32_LUMINANCE||o===Yn.U8_LUMINANCE)return this.translateTextureInternalFormat(o);var f=Bo(this.gl)||!Bo(this.gl)&&!!this.WEBGL_depth_texture;switch(o){case Yn.D24_S8:case Yn.D32F_S8:return f?An.DEPTH_STENCIL:An.RGBA;case Yn.D24:case Yn.D32F:return f?An.DEPTH_COMPONENT:An.RGBA}var v=Gf(o),T=c_(o);switch(T){case Ao.A:return An.ALPHA;case Ao.R:return v?An.RED_INTEGER:An.RED;case Ao.RG:return v?An.RG_INTEGER:An.RG;case Ao.RGB:return v?An.RGB_INTEGER:An.RGB;case Ao.RGBA:return An.RGBA}},a.prototype.setActiveTexture=function(o){this.currentActiveTexture!==o&&(this.gl.activeTexture(o),this.currentActiveTexture=o)},a.prototype.bindVAO=function(o){this.currentBoundVAO!==o&&(Bo(this.gl)?this.gl.bindVertexArray(o):this.OES_vertex_array_object.bindVertexArrayOES(o),this.currentBoundVAO=o)},a.prototype.programCompiled=function(o){Wa(o.compileState!==fd.NeedsCompile),o.compileState===fd.Compiling&&(o.compileState=fd.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(o))},a.prototype.useProgram=function(o){this.currentProgram!==o&&(this.programCompiled(o),this.gl.useProgram(o.gl_program),this.currentProgram=o)},a.prototype.ensureResourceExists=function(o){if(o===null){var f=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(f))}else return o},a.prototype.createBuffer=function(o){return new C0({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTexture=function(o){return new lx({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createSampler=function(o){return new dC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTarget=function(o){return new sS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTargetFromTexture=function(o){var f=o,v=f.format,T=f.width,O=f.height,L=f.mipLevelCount;return Wa(L===1),this.createRenderTarget({format:v,width:T,height:O,sampleCount:1,texture:o})},a.prototype.createProgram=function(o){var f,v,T,O=(f=o.vertex)===null||f===void 0?void 0:f.glsl;return!((v=o.vertex)===null||v===void 0)&&v.glsl&&(o.vertex.glsl=Km(this.queryVendorInfo(),"vert",o.vertex.glsl)),!((T=o.fragment)===null||T===void 0)&&T.glsl&&(o.fragment.glsl=Km(this.queryVendorInfo(),"frag",o.fragment.glsl)),this.createProgramSimple(o,O)},a.prototype.createProgramSimple=function(o,f){var v=new b_({id:this.getNextUniqueId(),device:this,descriptor:o},f);return v},a.prototype.createBindings=function(o){return new nS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createInputLayout=function(o){return new uC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderPipeline=function(o){return new uS({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createComputePass=function(){return new fS},a.prototype.createComputePipeline=function(o){return new fC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createReadback=function(){return new cS({id:this.getNextUniqueId(),device:this})},a.prototype.createQueryPool=function(o,f){return new lS({id:this.getNextUniqueId(),device:this,descriptor:{type:o,elemCount:f}})},a.prototype.formatRenderPassDescriptor=function(o){var f,v,T,O,L,F,H=o.colorAttachment;o.depthClearValue=(f=o.depthClearValue)!==null&&f!==void 0?f:"load",o.stencilClearValue=(v=o.stencilClearValue)!==null&&v!==void 0?v:"load";for(var ie=0;ie<H.length;ie++)o.colorAttachmentLevel||(o.colorAttachmentLevel=[]),o.colorAttachmentLevel[ie]=(T=o.colorAttachmentLevel[ie])!==null&&T!==void 0?T:0,o.colorResolveToLevel||(o.colorResolveToLevel=[]),o.colorResolveToLevel[ie]=(O=o.colorResolveToLevel[ie])!==null&&O!==void 0?O:0,o.colorClearColor||(o.colorClearColor=[]),o.colorClearColor[ie]=(L=o.colorClearColor[ie])!==null&&L!==void 0?L:"load",o.colorStore||(o.colorStore=[]),o.colorStore[ie]=(F=o.colorStore[ie])!==null&&F!==void 0?F:!1},a.prototype.createRenderBundle=function(){return new pC({id:this.getNextUniqueId(),device:this})},a.prototype.beginBundle=function(o){this.renderBundle=o},a.prototype.endBundle=function(){this.renderBundle=void 0},a.prototype.executeBundles=function(o){o.forEach(function(f){f.replay()})},a.prototype.createRenderPass=function(o){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=o,this.formatRenderPassDescriptor(o);var f=o.colorAttachment,v=o.colorAttachmentLevel,T=o.colorClearColor,O=o.colorResolveTo,L=o.colorResolveToLevel,F=o.depthStencilAttachment,H=o.depthClearValue,ie=o.stencilClearValue,xe=o.depthStencilResolveTo,Ee=O&&O.length===1&&O[0]===this.scTexture;this.setRenderPassParametersBegin(f.length,Ee);for(var Ye=0;Ye<f.length;Ye++)this.setRenderPassParametersColor(Ye,f[Ye],v[Ye],O[Ye],L[Ye],Ee);this.setRenderPassParametersDepthStencil(F,xe,Ee),this.validateCurrentAttachments();for(var Ye=0;Ye<f.length;Ye++){var Lt=T[Ye];Lt!=="load"&&this.setRenderPassParametersClearColor(Ye,Lt.r,Lt.g,Lt.b,Lt.a)}return this.setRenderPassParametersClearDepthStencil(H,ie),this},a.prototype.submitPass=function(o){Wa(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},a.prototype.copySubTexture2D=function(o,f,v,T,O,L){var F=this.gl,H=o,ie=T;if(Wa(ie.mipLevelCount===1),Wa(H.mipLevelCount===1),Bo(F))H===this.scTexture?F.bindFramebuffer(F.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(F.bindFramebuffer(F.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(F.DRAW_FRAMEBUFFER,F.COLOR_ATTACHMENT0,H,0)),F.bindFramebuffer(F.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(F.READ_FRAMEBUFFER,F.COLOR_ATTACHMENT0,ie,0),F.blitFramebuffer(O,L,O+ie.width,L+ie.height,f,v,f+ie.width,v+ie.height,F.COLOR_BUFFER_BIT,F.LINEAR),F.bindFramebuffer(F.READ_FRAMEBUFFER,null),F.bindFramebuffer(F.DRAW_FRAMEBUFFER,null);else if(H===this.scTexture){var xe=this.createRenderTargetFromTexture(T);this.submitBlitRenderPass(xe,H)}},a.prototype.queryLimits=function(){return this},a.prototype.queryTextureFormatSupported=function(o,f,v){switch(o){case Yn.BC1_SRGB:case Yn.BC2_SRGB:case Yn.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?sx(f,v,4,4):!1;case Yn.BC1:case Yn.BC2:case Yn.BC3:return this.WEBGL_compressed_texture_s3tc!==null?sx(f,v,4,4):!1;case Yn.BC4_UNORM:case Yn.BC4_SNORM:case Yn.BC5_UNORM:case Yn.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?sx(f,v,4,4):!1;case Yn.U16_R_NORM:case Yn.U16_RG_NORM:case Yn.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case Yn.F32_R:case Yn.F32_RG:case Yn.F32_RGB:case Yn.F32_RGBA:return this.OES_texture_float_linear!==null;case Yn.F16_R:case Yn.F16_RG:case Yn.F16_RGB:case Yn.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},a.prototype.queryProgramReady=function(o){var f=this.gl;if(o.compileState===fd.NeedsCompile)throw new Error("whoops");if(o.compileState===fd.Compiling){var v=void 0;return this.KHR_parallel_shader_compile!==null?v=f.getProgramParameter(o.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):v=!0,v&&this.programCompiled(o),v}return o.compileState===fd.NeedsBind||o.compileState===fd.ReadyToUse},a.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},a.prototype.queryVendorInfo=function(){return this},a.prototype.queryRenderPass=function(o){return this.currentRenderPassDescriptor},a.prototype.queryRenderTarget=function(o){var f=o;return f},a.prototype.setResourceName=function(o,f){if(o.name=f,o.type===Bs.Buffer)for(var v=o.gl_buffer_pages,T=0;T<v.length;T++)qy(v[T],"".concat(f," Page ").concat(T));else if(o.type===Bs.Texture)qy(Hg(o),f);else if(o.type===Bs.Sampler)qy(ox(o),f);else if(o.type===Bs.RenderTarget){var O=o.gl_renderbuffer;O!==null&&qy(O,f)}else o.type===Bs.InputLayout&&qy(o.vao,f)},a.prototype.setResourceLeakCheck=function(o,f){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(o,f)},a.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},a.prototype.pushDebugGroup=function(o){},a.prototype.popDebugGroup=function(){},a.prototype.insertDebugMarker=function(o){},a.prototype.programPatched=function(o,f){Wa(this.shaderDebug)},a.prototype.getBufferData=function(o,f,v){v===void 0&&(v=0);var T=this.gl;Bo(T)&&(T.bindBuffer(T.COPY_READ_BUFFER,Vg(o,v*4)),T.getBufferSubData(T.COPY_READ_BUFFER,v*4,f))},a.prototype.debugGroupStatisticsDrawCall=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].drawCallCount+=o},a.prototype.debugGroupStatisticsBufferUpload=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].bufferUploadCount+=o},a.prototype.debugGroupStatisticsTextureBind=function(o){o===void 0&&(o=1);for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].textureBindCount+=o},a.prototype.debugGroupStatisticsTriangles=function(o){for(var f=this.debugGroupStack.length-1;f>=0;f--)this.debugGroupStack[f].triangleCount+=o},a.prototype.reportShaderError=function(o,f){var v=this.gl,T=v.getShaderParameter(o,v.COMPILE_STATUS);if(!T){console.error(HA(f));var O=v.getExtension("WEBGL_debug_shaders");O&&console.error(O.getTranslatedShaderSource(o)),console.error(v.getShaderInfoLog(o))}return T},a.prototype.checkProgramCompilationForErrors=function(o){var f=this.gl,v=o.gl_program;if(!f.getProgramParameter(v,f.LINK_STATUS)){var T=o.descriptor;if(!this.reportShaderError(o.gl_shader_vert,T.vertex.glsl)||!this.reportShaderError(o.gl_shader_frag,T.fragment.glsl))return;console.error(f.getProgramInfoLog(o.gl_program))}},a.prototype.bindFramebufferAttachment=function(o,f,v,T){var O=this.gl;if((0,hp.Z)(v))O.framebufferRenderbuffer(o,f,O.RENDERBUFFER,null);else if(v.type===Bs.RenderTarget)v.gl_renderbuffer!==null?O.framebufferRenderbuffer(o,f,O.RENDERBUFFER,v.gl_renderbuffer):v.texture!==null&&O.framebufferTexture2D(o,f,An.TEXTURE_2D,Hg(v.texture),T);else if(v.type===Bs.Texture){var L=Hg(v);v.dimension===ss.TEXTURE_2D?O.framebufferTexture2D(o,f,An.TEXTURE_2D,L,T):Bo(O)&&(v.dimension,ss.TEXTURE_2D_ARRAY)}},a.prototype.bindFramebufferDepthStencilAttachment=function(o,f){var v=this.gl,T=(0,hp.Z)(f)?ho.Depth|ho.Stencil:nm(f.format),O=!!(T&ho.Depth),L=!!(T&ho.Stencil);if(O&&L){var F=Bo(this.gl)||!Bo(this.gl)&&!!this.WEBGL_depth_texture;F?this.bindFramebufferAttachment(o,v.DEPTH_STENCIL_ATTACHMENT,f,0):this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,f,0)}else O?(this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,f,0),this.bindFramebufferAttachment(o,v.STENCIL_ATTACHMENT,null,0)):L&&(this.bindFramebufferAttachment(o,v.STENCIL_ATTACHMENT,f,0),this.bindFramebufferAttachment(o,v.DEPTH_ATTACHMENT,null,0))},a.prototype.validateCurrentAttachments=function(){for(var o=-1,f=-1,v=-1,T=0;T<this.currentColorAttachments.length;T++){var O=this.currentColorAttachments[T];O!==null&&(o===-1?(o=O.sampleCount,f=O.width,v=O.height):(Wa(o===O.sampleCount),Wa(f===O.width),Wa(v===O.height)))}this.currentDepthStencilAttachment&&(o===-1?o=this.currentDepthStencilAttachment.sampleCount:(Wa(o===this.currentDepthStencilAttachment.sampleCount),Wa(f===this.currentDepthStencilAttachment.width),Wa(v===this.currentDepthStencilAttachment.height))),this.currentSampleCount=o},a.prototype.setRenderPassParametersBegin=function(o,f){f===void 0&&(f=!1);var v=this.gl;if(f)v.bindFramebuffer(An.FRAMEBUFFER,null);else if(Bo(v)?v.bindFramebuffer(An.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||v.bindFramebuffer(An.FRAMEBUFFER,this.renderPassDrawFramebuffer),Bo(v)?v.drawBuffers([An.COLOR_ATTACHMENT0,An.COLOR_ATTACHMENT1,An.COLOR_ATTACHMENT2,An.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([An.COLOR_ATTACHMENT0_WEBGL,An.COLOR_ATTACHMENT1_WEBGL,An.COLOR_ATTACHMENT2_WEBGL,An.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var T=o;T<this.currentColorAttachments.length;T++){var O=Bo(v)?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,L=Bo(v)?An.COLOR_ATTACHMENT0:An.COLOR_ATTACHMENT0_WEBGL;v.framebufferRenderbuffer(O,L+T,An.RENDERBUFFER,null),v.framebufferTexture2D(O,L+T,An.TEXTURE_2D,null,0)}this.currentColorAttachments.length=o},a.prototype.setRenderPassParametersColor=function(o,f,v,T,O,L){L===void 0&&(L=!1);var F=this.gl,H=Bo(F);(this.currentColorAttachments[o]!==f||this.currentColorAttachmentLevels[o]!==v)&&(this.currentColorAttachments[o]=f,this.currentColorAttachmentLevels[o]=v,!L&&(H||!H&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(H?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,(H?An.COLOR_ATTACHMENT0:An.COLOR_ATTACHMENT0_WEBGL)+o,f,v),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[o]!==T||this.currentColorResolveToLevels[o]!==O)&&(this.currentColorResolveTos[o]=T,this.currentColorResolveToLevels[o]=O,T!==null&&(this.resolveColorAttachmentsChanged=!0))},a.prototype.setRenderPassParametersDepthStencil=function(o,f,v){v===void 0&&(v=!1);var T=this.gl;this.currentDepthStencilAttachment!==o&&(this.currentDepthStencilAttachment=o,!v&&!this.inBlitRenderPass&&this.bindFramebufferDepthStencilAttachment(Bo(T)?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==f&&(this.currentDepthStencilResolveTo=f,f&&(this.resolveDepthStencilAttachmentsChanged=!0))},a.prototype.setRenderPassParametersClearColor=function(o,f,v,T,O){var L=this.gl;if(this.OES_draw_buffers_indexed!==null){var F=this.currentMegaState.attachmentsState[o];F&&F.channelWriteMask!==hf.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(o,!0,!0,!0,!0),F.channelWriteMask=hf.ALL)}else{var F=this.currentMegaState.attachmentsState[0];F&&F.channelWriteMask!==hf.ALL&&(L.colorMask(!0,!0,!0,!0),F.channelWriteMask=hf.ALL)}this.setScissorRectEnabled(!1),Bo(L)?L.clearBufferfv(L.COLOR,o,[f,v,T,O]):(L.clearColor(f,v,T,O),L.clear(L.COLOR_BUFFER_BIT))},a.prototype.setRenderPassParametersClearDepthStencil=function(o,f){o===void 0&&(o="load"),f===void 0&&(f="load");var v=this.gl;o!=="load"&&(Wa(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(v.depthMask(!0),this.currentMegaState.depthWrite=!0),Bo(v)?v.clearBufferfv(v.DEPTH,0,[o]):(v.clearDepth(o),v.clear(v.DEPTH_BUFFER_BIT))),f!=="load"&&(Wa(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(v.enable(v.STENCIL_TEST),v.stencilMask(255),this.currentMegaState.stencilWrite=!0),Bo(v)?v.clearBufferiv(v.STENCIL,0,[f]):(v.clearStencil(f),v.clear(v.STENCIL_BUFFER_BIT)))},a.prototype.setBindings=function(o){var f=this,v;if(this.renderBundle){this.renderBundle.push(function(){return f.setBindings(o)});return}var T=this.gl,O=o,L=O.uniformBufferBindings,F=O.samplerBindings,H=O.bindingLayouts;Wa(0<H.bindingLayoutTables.length);var ie=H.bindingLayoutTables[0];Wa(L.length>=ie.numUniformBuffers),Wa(F.length>=ie.numSamplers);for(var xe=0;xe<L.length;xe++){var Ee=L[xe];if(Ee.size!==0){var Ye=ie.firstUniformBuffer+xe,Lt=Ee.buffer,an=Ee.offset||0,Pn=Ee.size||Lt.byteSize;if(Lt!==this.currentUniformBuffers[Ye]||an!==this.currentUniformBufferByteOffsets[Ye]||Pn!==this.currentUniformBufferByteSizes[Ye]){var sr=an%Lt.pageByteSize,Rr=Lt.gl_buffer_pages[an/Lt.pageByteSize|0];Wa(sr+Pn<=Lt.pageByteSize),Bo(T)&&T.bindBufferRange(T.UNIFORM_BUFFER,Ye,Rr,sr,Pn),this.currentUniformBuffers[Ye]=Lt,this.currentUniformBufferByteOffsets[Ye]=an,this.currentUniformBufferByteSizes[Ye]=Pn}}}for(var xe=0;xe<ie.numSamplers;xe++){var Ee=F[xe],Tr=ie.firstSampler+xe,li=Ee!==null&&Ee.sampler!==null?ox(Ee.sampler):null,Ui=Ee!==null&&Ee.texture!==null?Hg(Ee.texture):null;if(this.currentSamplers[Tr]!==li&&(Bo(T)&&T.bindSampler(Tr,li),this.currentSamplers[Tr]=li),this.currentTextures[Tr]!==Ui){if(this.setActiveTexture(T.TEXTURE0+Tr),Ui!==null){var Lo=kv(Ee).texture,eo=Lo.gl_target,Wr=Lo.width,Wi=Lo.height;Ee.texture.textureIndex=Tr,T.bindTexture(eo,Ui),Bo(T)||(v=Ee.sampler)===null||v===void 0||v.setTextureParameters(eo,Wr,Wi),this.debugGroupStatisticsTextureBind()}else{var ka=(0,go.pi)((0,go.pi)({},Ee),WE),ws=ka.dimension,ta=ka.formatKind,eo=aS(ws);T.bindTexture(eo,this.getFallbackTexture((0,go.pi)({gl_target:eo,formatKind:ta},ka)))}this.currentTextures[Tr]=Ui}}},a.prototype.setViewport=function(o,f,v,T){var O=this.gl;O.viewport(o,f,v,T)},a.prototype.setScissorRect=function(o,f,v,T){var O=this.gl;this.setScissorRectEnabled(!0),O.scissor(o,f,v,T)},a.prototype.applyAttachmentStateIndexed=function(o,f,v){var T=this.gl,O=this.OES_draw_buffers_indexed;f.channelWriteMask!==v.channelWriteMask&&(O.colorMaskiOES(o,!!(v.channelWriteMask&hf.RED),!!(v.channelWriteMask&hf.GREEN),!!(v.channelWriteMask&hf.BLUE),!!(v.channelWriteMask&hf.ALPHA)),f.channelWriteMask=v.channelWriteMask);var L=f.rgbBlendState.blendMode!==v.rgbBlendState.blendMode||f.alphaBlendState.blendMode!==v.alphaBlendState.blendMode,F=f.rgbBlendState.blendSrcFactor!==v.rgbBlendState.blendSrcFactor||f.alphaBlendState.blendSrcFactor!==v.alphaBlendState.blendSrcFactor||f.rgbBlendState.blendDstFactor!==v.rgbBlendState.blendDstFactor||f.alphaBlendState.blendDstFactor!==v.alphaBlendState.blendDstFactor;(F||L)&&(Yp(f.rgbBlendState)&&Yp(f.alphaBlendState)?O.enableiOES(o,T.BLEND):Yp(v.rgbBlendState)&&Yp(v.alphaBlendState)&&O.disableiOES(o,T.BLEND)),L&&(O.blendEquationSeparateiOES(o,v.rgbBlendState.blendMode,v.alphaBlendState.blendMode),f.rgbBlendState.blendMode=v.rgbBlendState.blendMode,f.alphaBlendState.blendMode=v.alphaBlendState.blendMode),F&&(O.blendFuncSeparateiOES(o,v.rgbBlendState.blendSrcFactor,v.rgbBlendState.blendDstFactor,v.alphaBlendState.blendSrcFactor,v.alphaBlendState.blendDstFactor),f.rgbBlendState.blendSrcFactor=v.rgbBlendState.blendSrcFactor,f.alphaBlendState.blendSrcFactor=v.alphaBlendState.blendSrcFactor,f.rgbBlendState.blendDstFactor=v.rgbBlendState.blendDstFactor,f.alphaBlendState.blendDstFactor=v.alphaBlendState.blendDstFactor)},a.prototype.applyAttachmentState=function(o,f){var v=this.gl;o.channelWriteMask!==f.channelWriteMask&&(v.colorMask(!!(f.channelWriteMask&hf.RED),!!(f.channelWriteMask&hf.GREEN),!!(f.channelWriteMask&hf.BLUE),!!(f.channelWriteMask&hf.ALPHA)),o.channelWriteMask=f.channelWriteMask);var T=o.rgbBlendState.blendMode!==f.rgbBlendState.blendMode||o.alphaBlendState.blendMode!==f.alphaBlendState.blendMode,O=o.rgbBlendState.blendSrcFactor!==f.rgbBlendState.blendSrcFactor||o.alphaBlendState.blendSrcFactor!==f.alphaBlendState.blendSrcFactor||o.rgbBlendState.blendDstFactor!==f.rgbBlendState.blendDstFactor||o.alphaBlendState.blendDstFactor!==f.alphaBlendState.blendDstFactor;(O||T)&&(Yp(o.rgbBlendState)&&Yp(o.alphaBlendState)?v.enable(v.BLEND):Yp(f.rgbBlendState)&&Yp(f.alphaBlendState)&&v.disable(v.BLEND)),T&&(v.blendEquationSeparate(f.rgbBlendState.blendMode,f.alphaBlendState.blendMode),o.rgbBlendState.blendMode=f.rgbBlendState.blendMode,o.alphaBlendState.blendMode=f.alphaBlendState.blendMode),O&&(v.blendFuncSeparate(f.rgbBlendState.blendSrcFactor,f.rgbBlendState.blendDstFactor,f.alphaBlendState.blendSrcFactor,f.alphaBlendState.blendDstFactor),o.rgbBlendState.blendSrcFactor=f.rgbBlendState.blendSrcFactor,o.alphaBlendState.blendSrcFactor=f.alphaBlendState.blendSrcFactor,o.rgbBlendState.blendDstFactor=f.rgbBlendState.blendDstFactor,o.alphaBlendState.blendDstFactor=f.alphaBlendState.blendDstFactor)},a.prototype.setMegaState=function(o){var f=this.gl,v=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var T=0;T<o.attachmentsState.length;T++)this.applyAttachmentStateIndexed(T,v.attachmentsState[0],o.attachmentsState[0]);else Wa(o.attachmentsState.length===1),this.applyAttachmentState(v.attachmentsState[0],o.attachmentsState[0]);Vb(v.blendConstant,o.blendConstant)||(f.blendColor(o.blendConstant.r,o.blendConstant.g,o.blendConstant.b,o.blendConstant.a),Hb(v.blendConstant,o.blendConstant)),v.depthCompare!==o.depthCompare&&(f.depthFunc(o.depthCompare),v.depthCompare=o.depthCompare),!!v.depthWrite!=!!o.depthWrite&&(f.depthMask(o.depthWrite),v.depthWrite=o.depthWrite),!!v.stencilWrite!=!!o.stencilWrite&&(f.stencilMask(o.stencilWrite?255:0),v.stencilWrite=o.stencilWrite);var O=!1;if(!m_(v.stencilFront,o.stencilFront)){O=!0;var L=o.stencilFront,F=L.passOp,H=L.failOp,ie=L.depthFailOp,xe=L.compare;(v.stencilFront.passOp!==F||v.stencilFront.failOp!==H||v.stencilFront.depthFailOp!==ie)&&(f.stencilOpSeparate(f.FRONT,H,ie,F),v.stencilFront.passOp=F,v.stencilFront.failOp=H,v.stencilFront.depthFailOp=ie),v.stencilFront.compare!==xe&&(this.setStencilReference(0),v.stencilFront.compare=xe)}if(!m_(v.stencilBack,o.stencilBack)){O=!0;var Ee=o.stencilBack,F=Ee.passOp,H=Ee.failOp,ie=Ee.depthFailOp,xe=Ee.compare;(v.stencilBack.passOp!==F||v.stencilBack.failOp!==H||v.stencilBack.depthFailOp!==ie)&&(f.stencilOpSeparate(f.BACK,H,ie,F),v.stencilBack.passOp=F,v.stencilBack.failOp=H,v.stencilBack.depthFailOp=ie),v.stencilBack.compare!==xe&&(this.setStencilReference(0),v.stencilBack.compare=xe)}(v.stencilFront.mask!==o.stencilFront.mask||v.stencilBack.mask!==o.stencilBack.mask)&&(O=!0,v.stencilFront.mask=o.stencilFront.mask,v.stencilBack.mask=o.stencilBack.mask),O&&this.applyStencil(),v.cullMode!==o.cullMode&&(v.cullMode===hh.NONE?f.enable(f.CULL_FACE):o.cullMode===hh.NONE&&f.disable(f.CULL_FACE),o.cullMode===hh.BACK?f.cullFace(f.BACK):o.cullMode===hh.FRONT?f.cullFace(f.FRONT):o.cullMode===hh.FRONT_AND_BACK&&f.cullFace(f.FRONT_AND_BACK),v.cullMode=o.cullMode),v.frontFace!==o.frontFace&&(f.frontFace(o.frontFace),v.frontFace=o.frontFace),v.polygonOffset!==o.polygonOffset&&(o.polygonOffset?f.enable(f.POLYGON_OFFSET_FILL):f.disable(f.POLYGON_OFFSET_FILL),v.polygonOffset=o.polygonOffset),(v.polygonOffsetFactor!==o.polygonOffsetFactor||v.polygonOffsetUnits!==o.polygonOffsetUnits)&&(f.polygonOffset(o.polygonOffsetFactor,o.polygonOffsetUnits),v.polygonOffsetFactor=o.polygonOffsetFactor,v.polygonOffsetUnits=o.polygonOffsetUnits)},a.prototype.validatePipelineFormats=function(o){for(var f=0;f<this.currentColorAttachments.length;f++)var v=this.currentColorAttachments[f];this.currentDepthStencilAttachment&&Wa(this.currentDepthStencilAttachment.format===o.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&Wa(this.currentSampleCount===o.sampleCount)},a.prototype.setPipeline=function(o){var f=this;if(this.renderBundle){this.renderBundle.push(function(){return f.setPipeline(o)});return}this.currentPipeline=o,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var v=this.currentPipeline.program;if(this.useProgram(v),v.compileState===fd.NeedsBind){var T=this.gl,O=v.gl_program,L=v.descriptor,F=ax(L.vertex.glsl,mC);if(Bo(T))for(var H=0;H<F.length;H++){var ie=(0,go.CR)(F[H],2),xe=ie[1],Ee=T.getUniformBlockIndex(O,xe);Ee!==-1&&Ee!==4294967295&&T.uniformBlockBinding(O,Ee,H)}for(var Ye=ax(L.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),H=0;H<Ye.length;H++){var Lt=(0,go.CR)(Ye[H],3),an=Lt[1],Pn=Lt[2],sr=T.getUniformLocation(O,an);T.uniform1i(sr,parseInt(Pn))}v.compileState=fd.ReadyToUse}},a.prototype.setVertexInput=function(o,f,v){var T,O,L=this,F;if(this.renderBundle){this.renderBundle.push(function(){return L.setVertexInput(o,f,v)});return}if(o!==null){Wa(this.currentPipeline.inputLayout===o);var H=o;this.bindVAO(H.vao);for(var ie=this.gl,xe=0;xe<H.vertexBufferDescriptors.length;xe++){var Ee=H.vertexBufferDescriptors[xe],Ye=Ee.arrayStride,Lt=Ee.attributes;try{for(var an=(T=void 0,(0,go.XA)(Lt)),Pn=an.next();!Pn.done;Pn=an.next()){var sr=Pn.value,Rr=sr.shaderLocation,Tr=sr.offset,li=Bo(ie)?Rr:(F=H.program.attributes[Rr])===null||F===void 0?void 0:F.location;if(!(0,hp.Z)(li)){var Ui=f[xe];if(Ui===null)continue;var Lo=sr.vertexFormat;ie.bindBuffer(ie.ARRAY_BUFFER,Vg(Ui.buffer));var eo=(Ui.offset||0)+Tr;ie.vertexAttribPointer(li,Lo.size,Lo.type,Lo.normalized,Ye,eo)}}}catch(Wi){T={error:Wi}}finally{try{Pn&&!Pn.done&&(O=an.return)&&O.call(an)}finally{if(T)throw T.error}}}if(Wa(v!==null==(H.indexBufferFormat!==null)),v!==null){var Wr=v.buffer;Wa(Wr.usage===al.INDEX),ie.bindBuffer(ie.ELEMENT_ARRAY_BUFFER,Vg(Wr)),this.currentIndexBufferByteOffset=v.offset||0}else this.currentIndexBufferByteOffset=null}else Wa(this.currentPipeline.inputLayout===null),Wa(v===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},a.prototype.setStencilReference=function(o){this.currentStencilRef!==o&&(this.currentStencilRef=o,this.applyStencil())},a.prototype.draw=function(o,f,v,T){var O,L=this;if(this.renderBundle){this.renderBundle.push(function(){return L.draw(o,f,v,T)});return}var F=this.gl,H=this.currentPipeline;if(f){var ie=[H.drawMode,v||0,o,f];Bo(F)?F.drawArraysInstanced.apply(F,(0,go.ev)([],(0,go.CR)(ie),!1)):(O=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(O,(0,go.ev)([],(0,go.CR)(ie),!1))}else F.drawArrays(H.drawMode,v,o);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(o/3*Math.max(f,1))},a.prototype.drawIndexed=function(o,f,v,T,O){var L,F=this;if(this.renderBundle){this.renderBundle.push(function(){return F.drawIndexed(o,f,v,T,O)});return}var H=this.gl,ie=this.currentPipeline,xe=kv(ie.inputLayout),Ee=kv(this.currentIndexBufferByteOffset)+v*xe.indexBufferCompByteSize;if(f){var Ye=[ie.drawMode,o,xe.indexBufferType,Ee,f];Bo(H)?H.drawElementsInstanced.apply(H,(0,go.ev)([],(0,go.CR)(Ye),!1)):(L=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(L,(0,go.ev)([],(0,go.CR)(Ye),!1))}else H.drawElements(ie.drawMode,o,xe.indexBufferType,Ee);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(o/3*Math.max(f,1))},a.prototype.drawIndirect=function(o,f){},a.prototype.drawIndexedIndirect=function(o,f){},a.prototype.beginOcclusionQuery=function(o){var f=this.gl;if(Bo(f)){var v=this.currentRenderPassDescriptor.occlusionQueryPool;f.beginQuery(v.gl_query_type,v.gl_query[o])}},a.prototype.endOcclusionQuery=function(){var o=this.gl;if(Bo(o)){var f=this.currentRenderPassDescriptor.occlusionQueryPool;o.endQuery(f.gl_query_type)}},a.prototype.pipelineQueryReady=function(o){var f=o;return this.queryProgramReady(f.program)},a.prototype.pipelineForceReady=function(o){},a.prototype.endPass=function(){for(var o=this.gl,f=Bo(o),v=this.currentColorResolveTos.length===1&&this.currentColorResolveTos[0]===this.scTexture,T=!1,O=0;O<this.currentColorAttachments.length;O++){var L=this.currentColorAttachments[O];if(L!==null){var F=this.currentColorResolveTos[O],H=!1;F!==null&&(Wa(L.width===F.width&&L.height===F.height),this.setScissorRectEnabled(!1),v||(f&&o.bindFramebuffer(o.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&f&&this.bindFramebufferAttachment(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,L,this.currentColorAttachmentLevels[O])),H=!0,v||(F===this.scTexture?o.bindFramebuffer(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,this.scPlatformFramebuffer):(o.bindFramebuffer(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&o.framebufferTexture2D(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,F.gl_texture,this.currentColorResolveToLevels[O]))),v||(f?(o.blitFramebuffer(0,0,L.width,L.height,0,0,F.width,F.height,o.COLOR_BUFFER_BIT,o.LINEAR),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(L,F)),T=!0),this.currentRenderPassDescriptor.colorStore[O]||!v&&!H&&(o.bindFramebuffer(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,o.COLOR_ATTACHMENT0,L,this.currentColorAttachmentLevels[O])),v||o.bindFramebuffer(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var ie=this.currentDepthStencilAttachment;if(ie){var xe=this.currentDepthStencilResolveTo,H=!1;xe&&(Wa(ie.width===xe.width&&ie.height===xe.height),this.setScissorRectEnabled(!1),v||(o.bindFramebuffer(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),o.bindFramebuffer(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,ie),this.bindFramebufferDepthStencilAttachment(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,xe))),H=!0,v||(f&&o.blitFramebuffer(0,0,ie.width,ie.height,0,0,xe.width,xe.height,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,null)),T=!0),!v&&!this.currentRenderPassDescriptor.depthStencilStore&&(H||(o.bindFramebuffer(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,ie),H=!0),f&&o.invalidateFramebuffer(o.READ_FRAMEBUFFER,[o.DEPTH_STENCIL_ATTACHMENT])),!v&&H&&o.bindFramebuffer(f?An.READ_FRAMEBUFFER:An.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}!v&&!T&&o.bindFramebuffer(f?An.DRAW_FRAMEBUFFER:An.FRAMEBUFFER,null)},a.prototype.setScissorRectEnabled=function(o){if(this.currentScissorEnabled!==o){var f=this.gl;o?f.enable(f.SCISSOR_TEST):f.disable(f.SCISSOR_TEST),this.currentScissorEnabled=o}},a.prototype.applyStencil=function(){(0,hp.Z)(this.currentStencilRef)||(this.gl.stencilFuncSeparate(An.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(An.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},a.prototype.getFallbackTexture=function(o){var f=o.gl_target,v=o.formatKind;if(f===An.TEXTURE_2D)return v===mc.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(f===An.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(f===An.TEXTURE_3D)return this.fallbackTexture3D;if(f===An.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},a.prototype.submitBlitRenderPass=function(o,f){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:al.VERTEX|al.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:Xm.VERTEX,attributes:[{format:Yn.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:vu.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[Yn.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:Ug(rm)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:o.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:o}));var v=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var T=this.createRenderPass({colorAttachment:[o],colorResolveTo:[f],colorClearColor:[$y]}),O=this.getCanvas(),L=O.width,F=O.height;T.setPipeline(this.blitRenderPipeline),T.setBindings(this.blitBindings),T.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),T.setViewport(0,0,L,F),this.gl.disable(this.gl.BLEND),T.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=v,this.inBlitRenderPass=!1},a}(),gC=function(){function a(o){this.pluginOptions=o}return a.prototype.createSwapChain=function(o){return(0,go.mG)(this,void 0,void 0,function(){var f,v,T,O,L,F,H,ie,xe,Ee,Ye,Lt,an;return(0,go.Jh)(this,function(Pn){return f=this.pluginOptions,v=f.targets,T=f.xrCompatible,O=f.antialias,L=O===void 0?!1:O,F=f.preserveDrawingBuffer,H=F===void 0?!1:F,ie=f.premultipliedAlpha,xe=ie===void 0?!0:ie,Ee=f.shaderDebug,Ye=f.trackResources,Lt={antialias:L,preserveDrawingBuffer:H,stencil:!0,premultipliedAlpha:xe,xrCompatible:T},this.handleContextEvents(o),v.includes("webgl2")&&(an=o.getContext("webgl2",Lt)||o.getContext("experimental-webgl2",Lt)),!an&&v.includes("webgl1")&&(an=o.getContext("webgl",Lt)||o.getContext("experimental-webgl",Lt)),[2,new vC(an,{shaderDebug:Ee,trackResources:Ye})]})})},a.prototype.handleContextEvents=function(o){var f=this.pluginOptions,v=f.onContextLost,T=f.onContextRestored,O=f.onContextCreationError;O&&o.addEventListener("webglcontextcreationerror",O,!1),v&&o.addEventListener("webglcontextlost",v,!1),T&&o.addEventListener("webglcontextrestored",T,!1)},a}();let Pc;const dS=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&dS.decode();let Qy=null;function x_(){return(Qy===null||Qy.byteLength===0)&&(Qy=new Uint8Array(Pc.memory.buffer)),Qy}function E_(a,o){return a=a>>>0,dS.decode(x_().subarray(a,a+o))}const O0=new Array(128).fill(void 0);O0.push(void 0,null,!0,!1);let mp=O0.length;function pS(a){mp===O0.length&&O0.push(O0.length+1);const o=mp;return mp=O0[o],O0[o]=a,o}function S_(a){return O0[a]}function yC(a){a<132||(O0[a]=mp,mp=a)}function _C(a){const o=S_(a);return yC(a),o}let Hv=0;const Zv=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},OP=typeof Zv.encodeInto=="function"?function(a,o){return Zv.encodeInto(a,o)}:function(a,o){const f=Zv.encode(a);return o.set(f),{read:a.length,written:f.length}};function cx(a,o,f){if(f===void 0){const F=Zv.encode(a),H=o(F.length,1)>>>0;return x_().subarray(H,H+F.length).set(F),Hv=F.length,H}let v=a.length,T=o(v,1)>>>0;const O=x_();let L=0;for(;L<v;L++){const F=a.charCodeAt(L);if(F>127)break;O[T+L]=F}if(L!==v){L!==0&&(a=a.slice(L)),T=f(T,v,v=L+a.length*3,1)>>>0;const F=x_().subarray(T+L,T+v),H=OP(a,F);L+=H.written}return Hv=L,T}let T_=null;function ux(){return(T_===null||T_.byteLength===0)&&(T_=new Int32Array(Pc.memory.buffer)),T_}function RP(a,o,f){let v,T;try{const F=Pc.__wbindgen_add_to_stack_pointer(-16),H=cx(a,Pc.__wbindgen_malloc,Pc.__wbindgen_realloc),ie=Hv,xe=cx(o,Pc.__wbindgen_malloc,Pc.__wbindgen_realloc),Ee=Hv;Pc.glsl_compile(F,H,ie,xe,Ee,f);var O=ux()[F/4+0],L=ux()[F/4+1];return v=O,T=L,E_(O,L)}finally{Pc.__wbindgen_add_to_stack_pointer(16),Pc.__wbindgen_free(v,T,1)}}class w_{static __wrap(o){o=o>>>0;const f=Object.create(w_.prototype);return f.__wbg_ptr=o,f}__destroy_into_raw(){const o=this.__wbg_ptr;return this.__wbg_ptr=0,o}free(){const o=this.__destroy_into_raw();Pc.__wbg_wgslcomposer_free(o)}constructor(){const o=Pc.wgslcomposer_new();return w_.__wrap(o)}load_composable(o){const f=cx(o,Pc.__wbindgen_malloc,Pc.__wbindgen_realloc),v=Hv;Pc.wgslcomposer_load_composable(this.__wbg_ptr,f,v)}wgsl_compile(o){let f,v;try{const L=Pc.__wbindgen_add_to_stack_pointer(-16),F=cx(o,Pc.__wbindgen_malloc,Pc.__wbindgen_realloc),H=Hv;Pc.wgslcomposer_wgsl_compile(L,this.__wbg_ptr,F,H);var T=ux()[L/4+0],O=ux()[L/4+1];return f=T,v=O,E_(T,O)}finally{Pc.__wbindgen_add_to_stack_pointer(16),Pc.__wbindgen_free(f,v,1)}}}function MP(a,o){return ZM(this,null,function*(){if(typeof Response=="function"&&a instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(a,o)}catch(v){if(a.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",v);else throw v}const f=yield a.arrayBuffer();return yield WebAssembly.instantiate(f,o)}else{const f=yield WebAssembly.instantiate(a,o);return f instanceof WebAssembly.Instance?{instance:f,module:a}:f}})}function A_(){const a={};return a.wbg={},a.wbg.__wbindgen_string_new=function(o,f){const v=E_(o,f);return pS(v)},a.wbg.__wbindgen_object_drop_ref=function(o){_C(o)},a.wbg.__wbg_log_1d3ae0273d8f4f8a=function(o){console.log(S_(o))},a.wbg.__wbg_log_576ca876af0d4a77=function(o,f){console.log(S_(o),S_(f))},a.wbg.__wbindgen_throw=function(o,f){throw new Error(E_(o,f))},a}function bC(a,o){return Pc=a.exports,C_.__wbindgen_wasm_module=o,T_=null,Qy=null,Pc}function C_(a){return ZM(this,null,function*(){if(Pc!==void 0)return Pc;const o=A_();(typeof a=="string"||typeof Request=="function"&&a instanceof Request||typeof URL=="function"&&a instanceof URL)&&(a=fetch(a));const{instance:f,module:v}=yield MP(yield a,o);return bC(f,v)})}var Gu;(function(a){a[a.COPY_SRC=1]="COPY_SRC",a[a.COPY_DST=2]="COPY_DST",a[a.TEXTURE_BINDING=4]="TEXTURE_BINDING",a[a.STORAGE_BINDING=8]="STORAGE_BINDING",a[a.STORAGE=8]="STORAGE",a[a.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Gu||(Gu={}));var O_;(function(a){a[a.READ=1]="READ",a[a.WRITE=2]="WRITE"})(O_||(O_={}));function mS(a){var o=0;return a&Wf.SAMPLED&&(o|=Gu.TEXTURE_BINDING|Gu.COPY_DST|Gu.COPY_SRC),a&Wf.STORAGE&&(o|=Gu.TEXTURE_BINDING|Gu.STORAGE_BINDING|Gu.COPY_SRC|Gu.COPY_DST),a&Wf.RENDER_TARGET&&(o|=Gu.RENDER_ATTACHMENT|Gu.TEXTURE_BINDING|Gu.COPY_SRC|Gu.COPY_DST),o}function R_(a){if(a===Yn.U8_R_NORM)return"r8unorm";if(a===Yn.S8_R_NORM)return"r8snorm";if(a===Yn.U8_RG_NORM)return"rg8unorm";if(a===Yn.S8_RG_NORM)return"rg8snorm";if(a===Yn.U32_R)return"r32uint";if(a===Yn.S32_R)return"r32sint";if(a===Yn.F32_R)return"r32float";if(a===Yn.U16_RG)return"rg16uint";if(a===Yn.S16_RG)return"rg16sint";if(a===Yn.F16_RG)return"rg16float";if(a===Yn.U8_RGBA_RT)return"bgra8unorm";if(a===Yn.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(a===Yn.U8_RGBA_NORM)return"rgba8unorm";if(a===Yn.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(a===Yn.S8_RGBA_NORM)return"rgba8snorm";if(a===Yn.U32_RG)return"rg32uint";if(a===Yn.S32_RG)return"rg32sint";if(a===Yn.F32_RG)return"rg32float";if(a===Yn.U16_RGBA)return"rgba16uint";if(a===Yn.S16_RGBA)return"rgba16sint";if(a===Yn.F16_RGBA)return"rgba16float";if(a===Yn.F32_RGBA)return"rgba32float";if(a===Yn.U32_RGBA)return"rgba32uint";if(a===Yn.S32_RGBA)return"rgba32sint";if(a===Yn.D24)return"depth24plus";if(a===Yn.D24_S8)return"depth24plus-stencil8";if(a===Yn.D32F)return"depth32float";if(a===Yn.D32F_S8)return"depth32float-stencil8";if(a===Yn.BC1)return"bc1-rgba-unorm";if(a===Yn.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(a===Yn.BC2)return"bc2-rgba-unorm";if(a===Yn.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(a===Yn.BC3)return"bc3-rgba-unorm";if(a===Yn.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(a===Yn.BC4_SNORM)return"bc4-r-snorm";if(a===Yn.BC4_UNORM)return"bc4-r-unorm";if(a===Yn.BC5_SNORM)return"bc5-rg-snorm";if(a===Yn.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function R0(a){if(a===ss.TEXTURE_2D)return"2d";if(a===ss.TEXTURE_CUBE_MAP)return"2d";if(a===ss.TEXTURE_2D_ARRAY)return"2d";if(a===ss.TEXTURE_3D)return"3d";throw new Error("whoops")}function Qm(a){if(a===ss.TEXTURE_2D)return"2d";if(a===ss.TEXTURE_CUBE_MAP)return"cube";if(a===ss.TEXTURE_2D_ARRAY)return"2d-array";if(a===ss.TEXTURE_3D)return"3d";throw new Error("whoops")}function xC(a){var o=0;return a&al.INDEX&&(o|=GPUBufferUsage.INDEX),a&al.VERTEX&&(o|=GPUBufferUsage.VERTEX),a&al.UNIFORM&&(o|=GPUBufferUsage.UNIFORM),a&al.STORAGE&&(o|=GPUBufferUsage.STORAGE),a&al.COPY_SRC&&(o|=GPUBufferUsage.COPY_SRC),a&al.INDIRECT&&(o|=GPUBufferUsage.INDIRECT),o|=GPUBufferUsage.COPY_DST,o}function M_(a){if(a===Zf.CLAMP_TO_EDGE)return"clamp-to-edge";if(a===Zf.REPEAT)return"repeat";if(a===Zf.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function fx(a){if(a===tc.BILINEAR)return"linear";if(a===tc.POINT)return"nearest";throw new Error("whoops")}function EC(a){if(a===Wu.LINEAR)return"linear";if(a===Wu.NEAREST)return"nearest";if(a===Wu.NO_MIP)return"nearest";throw new Error("whoops")}function Zg(a){var o=a;return o.gpuBuffer}function SC(a){var o=a;return o.gpuSampler}function TC(a){var o=a;return o.querySet}function wC(a){if(a===l_.OcclusionConservative)return"occlusion";throw new Error("whoops")}function AC(a){switch(a){case vu.TRIANGLES:return"triangle-list";case vu.POINTS:return"point-list";case vu.TRIANGLE_STRIP:return"triangle-strip";case vu.LINES:return"line-list";case vu.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function CC(a){if(a===hh.NONE)return"none";if(a===hh.FRONT)return"front";if(a===hh.BACK)return"back";throw new Error("whoops")}function vS(a){if(a===s_.CCW)return"ccw";if(a===s_.CW)return"cw";throw new Error("whoops")}function OC(a,o){return{topology:AC(a),cullMode:CC(o.cullMode),frontFace:vS(o.frontFace)}}function gS(a){if(a===fs.ZERO)return"zero";if(a===fs.ONE)return"one";if(a===fs.SRC)return"src";if(a===fs.ONE_MINUS_SRC)return"one-minus-src";if(a===fs.DST)return"dst";if(a===fs.ONE_MINUS_DST)return"one-minus-dst";if(a===fs.SRC_ALPHA)return"src-alpha";if(a===fs.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(a===fs.DST_ALPHA)return"dst-alpha";if(a===fs.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(a===fs.CONST)return"constant";if(a===fs.ONE_MINUS_CONSTANT)return"one-minus-constant";if(a===fs.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function RC(a){if(a===mu.ADD)return"add";if(a===mu.SUBSTRACT)return"subtract";if(a===mu.REVERSE_SUBSTRACT)return"reverse-subtract";if(a===mu.MIN)return"min";if(a===mu.MAX)return"max";throw new Error("whoops")}function yS(a){return{operation:RC(a.blendMode),srcFactor:gS(a.blendSrcFactor),dstFactor:gS(a.blendDstFactor)}}function hx(a){return a.blendMode===mu.ADD&&a.blendSrcFactor===fs.ONE&&a.blendDstFactor===fs.ZERO}function MC(a){if(!(hx(a.rgbBlendState)&&hx(a.alphaBlendState)))return{color:yS(a.rgbBlendState),alpha:yS(a.alphaBlendState)}}function PC(a,o){return{format:R_(o),blend:MC(a),writeMask:a.channelWriteMask}}function IC(a,o){return o.attachmentsState.map(function(f,v){return PC(f,a[v])})}function P_(a){if(a===$a.NEVER)return"never";if(a===$a.LESS)return"less";if(a===$a.EQUAL)return"equal";if(a===$a.LEQUAL)return"less-equal";if(a===$a.GREATER)return"greater";if(a===$a.NOTEQUAL)return"not-equal";if(a===$a.GEQUAL)return"greater-equal";if(a===$a.ALWAYS)return"always";throw new Error("whoops")}function Wg(a){if(a===Mc.KEEP)return"keep";if(a===Mc.REPLACE)return"replace";if(a===Mc.ZERO)return"zero";if(a===Mc.DECREMENT_CLAMP)return"decrement-clamp";if(a===Mc.DECREMENT_WRAP)return"decrement-wrap";if(a===Mc.INCREMENT_CLAMP)return"increment-clamp";if(a===Mc.INCREMENT_WRAP)return"increment-wrap";if(a===Mc.INVERT)return"invert";throw new Error("whoops")}function LC(a,o){if(!(0,hp.Z)(a))return{format:R_(a),depthWriteEnabled:!!o.depthWrite,depthCompare:P_(o.depthCompare),depthBias:o.polygonOffset?o.polygonOffsetUnits:0,depthBiasSlopeScale:o.polygonOffset?o.polygonOffsetFactor:0,stencilFront:{compare:P_(o.stencilFront.compare),passOp:Wg(o.stencilFront.passOp),failOp:Wg(o.stencilFront.failOp),depthFailOp:Wg(o.stencilFront.depthFailOp)},stencilBack:{compare:P_(o.stencilBack.compare),passOp:Wg(o.stencilBack.passOp),failOp:Wg(o.stencilBack.failOp),depthFailOp:Wg(o.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function DC(a){if(a!==null){if(a===Yn.U16_R)return"uint16";if(a===Yn.U32_R)return"uint32";throw new Error("whoops")}}function NC(a){if(a===Xm.VERTEX)return"vertex";if(a===Xm.INSTANCE)return"instance";throw new Error("whoops")}function BC(a){if(a===Yn.U8_R)return"uint8x2";if(a===Yn.U8_RG)return"uint8x2";if(a===Yn.U8_RGB)return"uint8x4";if(a===Yn.U8_RGBA)return"uint8x4";if(a===Yn.U8_RG_NORM)return"unorm8x2";if(a===Yn.U8_RGBA_NORM)return"unorm8x4";if(a===Yn.S8_RGB_NORM)return"snorm8x4";if(a===Yn.S8_RGBA_NORM)return"snorm8x4";if(a===Yn.U16_RG_NORM)return"unorm16x2";if(a===Yn.U16_RGBA_NORM)return"unorm16x4";if(a===Yn.S16_RG_NORM)return"snorm16x2";if(a===Yn.S16_RGBA_NORM)return"snorm16x4";if(a===Yn.S16_RG)return"uint16x2";if(a===Yn.F16_RG)return"float16x2";if(a===Yn.F16_RGBA)return"float16x4";if(a===Yn.F32_R)return"float32";if(a===Yn.F32_RG)return"float32x2";if(a===Yn.F32_RGB)return"float32x3";if(a===Yn.F32_RGBA)return"float32x4";throw"whoops"}function yl(a){var o=A0(a);switch(o){case oi.BC1:case oi.BC2:case oi.BC3:case oi.BC4_SNORM:case oi.BC4_UNORM:case oi.BC5_SNORM:case oi.BC5_UNORM:return!0;default:return!1}}function FC(a){var o=A0(a);switch(o){case oi.BC1:case oi.BC2:case oi.BC3:case oi.BC4_SNORM:case oi.BC4_UNORM:case oi.BC5_SNORM:case oi.BC5_UNORM:return 4;default:return 1}}function _S(a,o,f,v){switch(f===void 0&&(f=!1),a){case Yn.S8_R:case Yn.S8_R_NORM:case Yn.S8_RG_NORM:case Yn.S8_RGB_NORM:case Yn.S8_RGBA_NORM:{var T=o instanceof ArrayBuffer?new Int8Array(o):new Int8Array(o);return v&&T.set(new Int8Array(v)),T}case Yn.U8_R:case Yn.U8_R_NORM:case Yn.U8_RG:case Yn.U8_RG_NORM:case Yn.U8_RGB:case Yn.U8_RGB_NORM:case Yn.U8_RGB_SRGB:case Yn.U8_RGBA:case Yn.U8_RGBA_NORM:case Yn.U8_RGBA_SRGB:{var O=o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o);return v&&O.set(new Uint8Array(v)),O}case Yn.S16_R:case Yn.S16_RG:case Yn.S16_RG_NORM:case Yn.S16_RGB_NORM:case Yn.S16_RGBA:case Yn.S16_RGBA_NORM:{var L=o instanceof ArrayBuffer?new Int16Array(o):new Int16Array(f?o/2:o);return v&&L.set(new Int16Array(v)),L}case Yn.U16_R:case Yn.U16_RGB:case Yn.U16_RGBA_5551:case Yn.U16_RGBA_NORM:case Yn.U16_RG_NORM:case Yn.U16_R_NORM:{var F=o instanceof ArrayBuffer?new Uint16Array(o):new Uint16Array(f?o/2:o);return v&&F.set(new Uint16Array(v)),F}case Yn.S32_R:{var H=o instanceof ArrayBuffer?new Int32Array(o):new Int32Array(f?o/4:o);return v&&H.set(new Int32Array(v)),H}case Yn.U32_R:case Yn.U32_RG:{var ie=o instanceof ArrayBuffer?new Uint32Array(o):new Uint32Array(f?o/4:o);return v&&ie.set(new Uint32Array(v)),ie}case Yn.F32_R:case Yn.F32_RG:case Yn.F32_RGB:case Yn.F32_RGBA:{var xe=o instanceof ArrayBuffer?new Float32Array(o):new Float32Array(f?o/4:o);return v&&xe.set(new Float32Array(v)),xe}}var Ee=o instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o);return v&&Ee.set(new Uint8Array(v)),Ee}function bS(a){var o=(a&32768)>>15,f=(a&31744)>>10,v=a&1023;return f===0?(o?-1:1)*Math.pow(2,-14)*(v/Math.pow(2,10)):f==31?v?NaN:(o?-1:1)*(1/0):(o?-1:1)*Math.pow(2,f-15)*(1+v/Math.pow(2,10))}function dx(a){switch(a){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var $p=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this)||this;return O.id=v,O.device=T,O}return o.prototype.destroy=function(){},o}(Gm),kC=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;H.type=Bs.Bindings;var ie=O.pipeline;Wa(!!ie);var xe=O.uniformBufferBindings,Ee=O.storageBufferBindings,Ye=O.samplerBindings,Lt=O.storageTextureBindings;H.numUniformBuffers=(xe==null?void 0:xe.length)||0;var an=[[],[],[],[]],Pn=0;if(xe&&xe.length)for(var sr=0;sr<xe.length;sr++){var Rr=O.uniformBufferBindings[sr],Tr=Rr.binding,li=Rr.size,Ui=Rr.offset,Lo=Rr.buffer,eo={buffer:Zg(Lo),offset:Ui!=null?Ui:0,size:li};an[0].push({binding:Tr!=null?Tr:Pn++,resource:eo})}if(Ye&&Ye.length){Pn=0;for(var sr=0;sr<Ye.length;sr++){var Wr=(0,go.pi)((0,go.pi)({},Ye[sr]),WE),Tr=O.samplerBindings[sr],Wi=Tr.texture!==null?Tr.texture:H.device.getFallbackTexture(Wr);Wr.dimension=Wi.dimension,Wr.formatKind=f_(Wi.format);var ka=Wi.gpuTextureView;if(an[1].push({binding:(L=Tr.textureBinding)!==null&&L!==void 0?L:Pn++,resource:ka}),Tr.samplerBinding!==-1){var ws=Tr.sampler!==null?Tr.sampler:H.device.getFallbackSampler(Wr),ta=SC(ws);an[1].push({binding:(F=Tr.samplerBinding)!==null&&F!==void 0?F:Pn++,resource:ta})}}}if(Ee&&Ee.length){Pn=0;for(var sr=0;sr<Ee.length;sr++){var ts=O.storageBufferBindings[sr],Tr=ts.binding,li=ts.size,Ui=ts.offset,Lo=ts.buffer,eo={buffer:Zg(Lo),offset:Ui!=null?Ui:0,size:li};an[2].push({binding:Tr!=null?Tr:Pn++,resource:eo})}}if(Lt&&Lt.length){Pn=0;for(var sr=0;sr<Lt.length;sr++){var Us=O.storageTextureBindings[sr],Tr=Us.binding,Wi=Us.texture,ka=Wi.gpuTextureView;an[3].push({binding:Tr!=null?Tr:Pn++,resource:ka})}}var Nh=an.findLastIndex(function(Bh){return!!Bh.length});return H.gpuBindGroup=an.map(function(Bh,Fh){return Fh<=Nh&&H.device.device.createBindGroup({layout:ie.getBindGroupLayout(Fh),entries:Bh})}),H}return o}($p),PP=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.Buffer;var F=O.usage,H=O.viewOrSize,ie=!!(F&al.MAP_READ);L.usage=xC(F),ie&&(L.usage=al.MAP_READ|al.COPY_DST);var xe=!(0,Fg.Z)(H);if(L.view=(0,Fg.Z)(H)?null:H,L.size=(0,Fg.Z)(H)?Wb(H,4):Wb(H.byteLength,4),(0,Fg.Z)(H))L.gpuBuffer=L.device.device.createBuffer({usage:L.usage,size:L.size,mappedAtCreation:ie?xe:!1});else{L.gpuBuffer=L.device.device.createBuffer({usage:L.usage,size:L.size,mappedAtCreation:!0});var Ee=H&&H.constructor||Float32Array;new Ee(L.gpuBuffer.getMappedRange()).set(H),L.gpuBuffer.unmap()}return L}return o.prototype.setSubData=function(f,v,T,O){T===void 0&&(T=0),O===void 0&&(O=0);var L=this.gpuBuffer;O=O||v.byteLength,O=Math.min(O,this.size-f);var F=v.byteOffset+T,H=F+O,ie=O+3&-4;if(ie!==O){var xe=new Uint8Array(v.buffer.slice(F,H));v=new Uint8Array(ie),v.set(xe),T=0,F=0,H=ie,O=ie}for(var Ee=1024*1024*15,Ye=0;H-(F+Ye)>Ee;)this.device.device.queue.writeBuffer(L,f+Ye,v.buffer,F+Ye,Ee),Ye+=Ee;this.device.device.queue.writeBuffer(L,f+Ye,v.buffer,F+Ye,O-Ye)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gpuBuffer.destroy()},o}($p),xS=function(){function a(){this.gpuComputePassEncoder=null}return a.prototype.dispatchWorkgroups=function(o,f,v){this.gpuComputePassEncoder.dispatchWorkgroups(o,f,v)},a.prototype.dispatchWorkgroupsIndirect=function(o,f){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(o.gpuBuffer,f)},a.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},a.prototype.beginComputePass=function(o){Wa(this.gpuComputePassEncoder===null),this.frameCommandEncoder=o,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},a.prototype.setPipeline=function(o){var f=o,v=kv(f.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(v)},a.prototype.setBindings=function(o){var f=this,v=o;v.gpuBindGroup.forEach(function(T,O){T&&f.gpuComputePassEncoder.setBindGroup(O,v.gpuBindGroup[O])})},a.prototype.pushDebugGroup=function(o){this.gpuComputePassEncoder.pushDebugGroup(o)},a.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},a.prototype.insertDebugMarker=function(o){this.gpuComputePassEncoder.insertDebugMarker(o)},a}(),M0=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.ComputePipeline,L.gpuComputePipeline=null,L.descriptor=O;var F=O.program,H=F.computeStage;if(H===null)return L;var ie={layout:"auto",compute:(0,go.pi)({},H)};return L.gpuComputePipeline=L.device.device.createComputePipeline(ie),L.name!==void 0&&(L.gpuComputePipeline.label=L.name),L}return o.prototype.getBindGroupLayout=function(f){return this.gpuComputePipeline.getBindGroupLayout(f)},o}($p),Jy=function(a){(0,go.ZT)(o,a);function o(f){var v,T,O,L,F=f.id,H=f.device,ie=f.descriptor,xe=a.call(this,{id:F,device:H})||this;xe.type=Bs.InputLayout;var Ee=[];try{for(var Ye=(0,go.XA)(ie.vertexBufferDescriptors),Lt=Ye.next();!Lt.done;Lt=Ye.next()){var an=Lt.value,Pn=an.arrayStride,sr=an.stepMode,Rr=an.attributes;Ee.push({arrayStride:Pn,stepMode:NC(sr),attributes:[]});try{for(var Tr=(O=void 0,(0,go.XA)(Rr)),li=Tr.next();!li.done;li=Tr.next()){var Ui=li.value,Lo=Ui.shaderLocation,eo=Ui.format,Wr=Ui.offset;Ee[Ee.length-1].attributes.push({shaderLocation:Lo,format:BC(eo),offset:Wr})}}catch(Wi){O={error:Wi}}finally{try{li&&!li.done&&(L=Tr.return)&&L.call(Tr)}finally{if(O)throw O.error}}}}catch(Wi){v={error:Wi}}finally{try{Lt&&!Lt.done&&(T=Ye.return)&&T.call(Ye)}finally{if(v)throw v.error}}return xe.indexFormat=DC(ie.indexBufferFormat),xe.buffers=Ee,xe}return o}($p),px=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;return L.type=Bs.Program,L.vertexStage=null,L.fragmentStage=null,L.computeStage=null,L.descriptor=O,O.vertex&&(L.vertexStage=L.createShaderStage(O.vertex,"vertex")),O.fragment&&(L.fragmentStage=L.createShaderStage(O.fragment,"fragment")),O.compute&&(L.computeStage=L.createShaderStage(O.compute,"compute")),L}return o.prototype.setUniformsLegacy=function(f){},o.prototype.createShaderStage=function(f,v){var T,O,L=f.glsl,F=f.wgsl,H=f.entryPoint,ie=f.postprocess,xe=!1,Ee=F;if(!Ee)try{Ee=this.device.glsl_compile(L,v,xe)}catch(Rr){throw console.error(Rr,L),new Error("whoops")}var Ye=function(Rr){if(!Ee.includes(Rr))return"continue";Ee=Ee.replace("var T_".concat(Rr,": texture_2d<f32>;"),"var T_".concat(Rr,": texture_depth_2d;")),Ee=Ee.replace(new RegExp("textureSample\\(T_".concat(Rr,"(.*)\\);$"),"gm"),function(Tr,li){return"vec4<f32>(textureSample(T_".concat(Rr).concat(li,"), 0.0, 0.0, 0.0);")})};try{for(var Lt=(0,go.XA)(["u_TextureFramebufferDepth"]),an=Lt.next();!an.done;an=Lt.next()){var Pn=an.value;Ye(Pn)}}catch(Rr){T={error:Rr}}finally{try{an&&!an.done&&(O=Lt.return)&&O.call(Lt)}finally{if(T)throw T.error}}ie&&(Ee=ie(Ee));var sr=this.device.device.createShaderModule({code:Ee});return{module:sr,entryPoint:H||"main"}},o}($p),zC=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;L.type=Bs.QueryPool;var F=O.elemCount,H=O.type;return L.querySet=L.device.device.createQuerySet({type:wC(H),count:F}),L.resolveBuffer=L.device.device.createBuffer({size:F*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),L.cpuBuffer=L.device.device.createBuffer({size:F*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),L.results=null,L}return o.prototype.queryResultOcclusion=function(f){return this.results===null?null:this.results[f]!==BigInt(0)},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},o}($p),ES=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this,{id:v,device:T})||this;return O.type=Bs.Readback,O}return o.prototype.readTexture=function(f,v,T,O,L,F,H,ie){return H===void 0&&(H=0),(0,go.mG)(this,void 0,void 0,function(){var xe,Ee,Ye,Lt,an,Pn,sr,Rr;return(0,go.Jh)(this,function(Tr){return xe=f,Ee=0,Ye=dx(xe.gpuTextureformat),Lt=Math.ceil(O/Ye.width)*Ye.length,an=Math.ceil(Lt/256)*256,Pn=an*L,sr=this.device.createBuffer({usage:al.STORAGE|al.MAP_READ|al.COPY_DST,hint:dp.STATIC,viewOrSize:Pn}),Rr=this.device.device.createCommandEncoder(),Rr.copyTextureToBuffer({texture:xe.gpuTexture,mipLevel:0,origin:{x:v,y:T,z:Math.max(Ee,0)}},{buffer:sr.gpuBuffer,offset:0,bytesPerRow:an},{width:O,height:L,depthOrArrayLayers:1}),this.device.device.queue.submit([Rr.finish()]),[2,this.readBuffer(sr,0,F.byteLength===Pn?F:null,H,Pn,xe.format,!0,!1,Lt,an,L)]})})},o.prototype.readTextureSync=function(f,v,T,O,L,F,H,ie){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},o.prototype.readBuffer=function(f,v,T,O,L,F,H,ie,xe,Ee,Ye){var Lt=this;v===void 0&&(v=0),T===void 0&&(T=null),L===void 0&&(L=0),F===void 0&&(F=Yn.U8_RGB),H===void 0&&(H=!1),xe===void 0&&(xe=0),Ee===void 0&&(Ee=0),Ye===void 0&&(Ye=0);var an=f,Pn=L||an.size,sr=T||an.view,Rr=sr&&sr.constructor&&sr.constructor.BYTES_PER_ELEMENT||FA(F),Tr=an;if(!(an.usage&al.MAP_READ&&an.usage&al.COPY_DST)){var li=this.device.device.createCommandEncoder();Tr=this.device.createBuffer({usage:al.STORAGE|al.MAP_READ|al.COPY_DST,hint:dp.STATIC,viewOrSize:Pn}),li.copyBufferToBuffer(an.gpuBuffer,v,Tr.gpuBuffer,0,Pn),this.device.device.queue.submit([li.finish()])}return new Promise(function(Ui,Lo){Tr.gpuBuffer.mapAsync(O_.READ,v,Pn).then(function(){var eo=Tr.gpuBuffer.getMappedRange(v,Pn),Wr=sr;if(H)Wr===null?Wr=_S(F,Pn,!0,eo):Wr=_S(F,Wr.buffer,void 0,eo);else if(Wr===null)switch(Rr){case 1:Wr=new Uint8Array(Pn),Wr.set(new Uint8Array(eo));break;case 2:Wr=Lt.getHalfFloatAsFloatRGBAArrayBuffer(Pn/2,eo);break;case 4:Wr=new Float32Array(Pn/4),Wr.set(new Float32Array(eo));break}else switch(Rr){case 1:Wr=new Uint8Array(Wr.buffer),Wr.set(new Uint8Array(eo));break;case 2:Wr=Lt.getHalfFloatAsFloatRGBAArrayBuffer(Pn/2,eo,sr);break;case 4:var Wi=sr&&sr.constructor||Float32Array;Wr=new Wi(Wr.buffer),Wr.set(new Wi(eo));break}if(xe!==Ee){Rr===1&&!H&&(xe*=2,Ee*=2);for(var ka=new Uint8Array(Wr.buffer),ws=xe,ta=0,ts=1;ts<Ye;++ts){ta=ts*Ee;for(var Us=0;Us<xe;++Us)ka[ws++]=ka[ta++]}Rr!==0&&!H?Wr=new Float32Array(ka.buffer,0,ws/4):Wr=new Uint8Array(ka.buffer,0,ws)}Tr.gpuBuffer.unmap(),Ui(Wr)},function(eo){return Lo(eo)})})},o.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(f,v,T){T||(T=new Float32Array(f));for(var O=new Uint16Array(v);f--;)T[f]=bS(O[f]);return T},o}($p),SS=function(){function a(o){this.device=o,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return a.prototype.getEncoder=function(){var o;return((o=this.renderBundle)===null||o===void 0?void 0:o.renderBundleEncoder)||this.gpuRenderPassEncoder},a.prototype.getTextureView=function(o,f){return Wa(f<o.mipLevelCount),o.mipLevelCount===1?o.gpuTextureView:o.gpuTexture.createView({baseMipLevel:f,mipLevelCount:1})},a.prototype.setRenderPassDescriptor=function(o){var f,v,T,O,L,F;this.descriptor=o,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var H=o.colorAttachment.length;this.gfxColorAttachment.length=H,this.gfxColorResolveTo.length=H;for(var ie=0;ie<o.colorAttachment.length;ie++){var xe=o.colorAttachment[ie],Ee=o.colorResolveTo[ie];if(xe===null&&Ee!==null&&(xe=Ee,Ee=null),this.gfxColorAttachment[ie]=xe,this.gfxColorResolveTo[ie]=Ee,this.gfxColorAttachmentLevel[ie]=((f=o.colorAttachmentLevel)===null||f===void 0?void 0:f[ie])||0,this.gfxColorResolveToLevel[ie]=((v=o.colorResolveToLevel)===null||v===void 0?void 0:v[ie])||0,xe!==null){this.gpuColorAttachments[ie]===void 0&&(this.gpuColorAttachments[ie]={});var Ye=this.gpuColorAttachments[ie];Ye.view=this.getTextureView(xe,((T=this.gfxColorAttachmentLevel)===null||T===void 0?void 0:T[ie])||0);var Lt=(L=(O=o.colorClearColor)===null||O===void 0?void 0:O[ie])!==null&&L!==void 0?L:"load";Lt==="load"?Ye.loadOp="load":(Ye.loadOp="clear",Ye.clearValue=Lt),Ye.storeOp=!((F=o.colorStore)===null||F===void 0)&&F[ie]?"store":"discard",Ye.resolveTarget=void 0,Ee!==null&&(xe.sampleCount>1?Ye.resolveTarget=this.getTextureView(Ee,this.gfxColorResolveToLevel[ie]):Ye.storeOp="store")}else{this.gpuColorAttachments.length=ie,this.gfxColorAttachment.length=ie,this.gfxColorResolveTo.length=ie;break}}if(this.gfxDepthStencilAttachment=o.depthStencilAttachment,this.gfxDepthStencilResolveTo=o.depthStencilResolveTo,o.depthStencilAttachment){var an=o.depthStencilAttachment,Ye=this.gpuDepthStencilAttachment;Ye.view=an.gpuTextureView;var Pn=!!(nm(an.format)&ho.Depth);Pn?(o.depthClearValue==="load"?Ye.depthLoadOp="load":(Ye.depthLoadOp="clear",Ye.depthClearValue=o.depthClearValue),o.depthStencilStore||this.gfxDepthStencilResolveTo!==null?Ye.depthStoreOp="store":Ye.depthStoreOp="discard"):(Ye.depthLoadOp=void 0,Ye.depthStoreOp=void 0);var sr=!!(nm(an.format)&ho.Stencil);sr?(o.stencilClearValue==="load"?Ye.stencilLoadOp="load":(Ye.stencilLoadOp="clear",Ye.stencilClearValue=o.stencilClearValue),o.depthStencilStore||this.gfxDepthStencilResolveTo!==null?Ye.stencilStoreOp="store":Ye.stencilStoreOp="discard"):(Ye.stencilLoadOp=void 0,Ye.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=(0,hp.Z)(o.occlusionQueryPool)?void 0:TC(o.occlusionQueryPool)},a.prototype.beginRenderPass=function(o,f){Wa(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(f),this.frameCommandEncoder=o,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},a.prototype.flipY=function(o,f){var v=this.device.swapChainHeight;return v-o-f},a.prototype.setViewport=function(o,f,v,T,O,L){O===void 0&&(O=0),L===void 0&&(L=1),this.gpuRenderPassEncoder.setViewport(o,this.flipY(f,T),v,T,O,L)},a.prototype.setScissorRect=function(o,f,v,T){this.gpuRenderPassEncoder.setScissorRect(o,this.flipY(f,T),v,T)},a.prototype.setPipeline=function(o){var f=o,v=kv(f.gpuRenderPipeline);this.getEncoder().setPipeline(v)},a.prototype.setVertexInput=function(o,f,v){if(o!==null){var T=this.getEncoder(),O=o;v!==null&&T.setIndexBuffer(Zg(v.buffer),kv(O.indexFormat),v.offset);for(var L=0;L<f.length;L++){var F=f[L];F!==null&&T.setVertexBuffer(L,Zg(F.buffer),F.offset)}}},a.prototype.setBindings=function(o){var f=o,v=this.getEncoder();f.gpuBindGroup.forEach(function(T,O){T&&v.setBindGroup(O,f.gpuBindGroup[O])})},a.prototype.setStencilReference=function(o){this.gpuRenderPassEncoder.setStencilReference(o)},a.prototype.draw=function(o,f,v,T){this.getEncoder().draw(o,f,v,T)},a.prototype.drawIndexed=function(o,f,v,T,O){this.getEncoder().drawIndexed(o,f,v,T,O)},a.prototype.drawIndirect=function(o,f){this.getEncoder().drawIndirect(Zg(o),f)},a.prototype.drawIndexedIndirect=function(o,f){this.getEncoder().drawIndexedIndirect(Zg(o),f)},a.prototype.beginOcclusionQuery=function(o){this.gpuRenderPassEncoder.beginOcclusionQuery(o)},a.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},a.prototype.pushDebugGroup=function(o){this.gpuRenderPassEncoder.pushDebugGroup(o)},a.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},a.prototype.insertDebugMarker=function(o){this.gpuRenderPassEncoder.insertDebugMarker(o)},a.prototype.beginBundle=function(o){this.renderBundle=o},a.prototype.endBundle=function(){this.renderBundle.finish()},a.prototype.executeBundles=function(o){this.gpuRenderPassEncoder.executeBundles(o.map(function(f){return f.renderBundle}))},a.prototype.finish=function(){var o;(o=this.gpuRenderPassEncoder)===null||o===void 0||o.end(),this.gpuRenderPassEncoder=null;for(var f=0;f<this.gfxColorAttachment.length;f++){var v=this.gfxColorAttachment[f],T=this.gfxColorResolveTo[f];v!==null&&T!==null&&v.sampleCount===1&&this.copyAttachment(T,this.gfxColorAttachmentLevel[f],v,this.gfxColorResolveToLevel[f])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},a.prototype.copyAttachment=function(o,f,v,T){Wa(v.sampleCount===1);var O={texture:v.gpuTexture,mipLevel:T},L={texture:o.gpuTexture,mipLevel:f};Wa(v.width>>>T===o.width>>>f),Wa(v.height>>>T===o.height>>>f),Wa(!!(v.usage&Gu.COPY_SRC)),Wa(!!(o.usage&Gu.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(O,L,[o.width,o.height,1])},a}(),UC=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=a.call(this,{id:v,device:T})||this;return L.type=Bs.RenderPipeline,L.isCreatingAsync=!1,L.gpuRenderPipeline=null,L.descriptor=O,L.device.createRenderPipelineInternal(L,!1),L}return o.prototype.getBindGroupLayout=function(f){return this.gpuRenderPipeline.getBindGroupLayout(f)},o}($p),jC=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L,F,H=a.call(this,{id:v,device:T})||this;H.type=Bs.Sampler;var ie=O.lodMinClamp,xe=O.mipmapFilter===Wu.NO_MIP?O.lodMinClamp:O.lodMaxClamp,Ee=(L=O.maxAnisotropy)!==null&&L!==void 0?L:1;return Ee>1&&Wa(O.minFilter===tc.BILINEAR&&O.magFilter===tc.BILINEAR&&O.mipmapFilter===Wu.LINEAR),H.gpuSampler=H.device.device.createSampler({addressModeU:M_(O.addressModeU),addressModeV:M_(O.addressModeV),addressModeW:M_((F=O.addressModeW)!==null&&F!==void 0?F:O.addressModeU),lodMinClamp:ie,lodMaxClamp:xe,minFilter:fx(O.minFilter),magFilter:fx(O.magFilter),mipmapFilter:EC(O.mipmapFilter),compare:O.compareFunction!==void 0?P_(O.compareFunction):void 0,maxAnisotropy:Ee}),H}return o}($p),mx=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=f.descriptor,L=f.skipCreate,F=f.sampleCount,H=a.call(this,{id:v,device:T})||this;H.type=Bs.Texture,H.flipY=!1;var ie=O.format,xe=O.dimension,Ee=O.width,Ye=O.height,Lt=O.depthOrArrayLayers,an=O.mipLevelCount,Pn=O.usage,sr=O.pixelStore;return H.flipY=!!(sr!=null&&sr.unpackFlipY),H.device.createTextureShared({format:ie,dimension:xe!=null?xe:ss.TEXTURE_2D,width:Ee,height:Ye,depthOrArrayLayers:Lt!=null?Lt:1,mipLevelCount:an!=null?an:1,usage:Pn,sampleCount:F!=null?F:1},H,L),H}return o.prototype.textureFromImageBitmapOrCanvas=function(f,v,T){for(var O=v[0].width,L=v[0].height,F={size:{width:O,height:L,depthOrArrayLayers:T},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},H=f.createTexture(F),ie=0;ie<v.length;ie++)f.queue.copyExternalImageToTexture({source:v[ie],flipY:this.flipY},{texture:H,origin:[0,0,ie]},[O,L]);return[H,O,L]},o.prototype.isImageBitmapOrCanvases=function(f){var v=f[0];return v instanceof ImageBitmap||v instanceof HTMLCanvasElement||v instanceof OffscreenCanvas},o.prototype.isVideo=function(f){var v=f[0];return v instanceof HTMLVideoElement},o.prototype.setImageData=function(f,v){var T,O=this,L=this.device.device,F,H,ie;if(this.isImageBitmapOrCanvases(f))T=(0,go.CR)(this.textureFromImageBitmapOrCanvas(L,f,this.depthOrArrayLayers),3),F=T[0],H=T[1],ie=T[2];else if(this.isVideo(f))F=L.importExternalTexture({source:f[0]});else{var xe=dx(this.gpuTextureformat),Ee=Math.ceil(this.width/xe.width)*xe.length;f.forEach(function(Ye){L.queue.writeTexture({texture:O.gpuTexture},Ye,{bytesPerRow:Ee},{width:O.width,height:O.height})})}this.width=H,this.height=ie,F&&(this.gpuTexture=F),this.gpuTextureView=this.gpuTexture.createView({dimension:Qm(this.dimension)})},o.prototype.destroy=function(){a.prototype.destroy.call(this),this.gpuTexture.destroy()},o}($p),Xf=function(a){(0,go.ZT)(o,a);function o(f){var v=f.id,T=f.device,O=a.call(this,{id:v,device:T})||this;return O.type=Bs.RenderBundle,O.renderBundleEncoder=O.device.device.createRenderBundleEncoder({colorFormats:[O.device.swapChainFormat]}),O}return o.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},o}($p),VC=function(){function a(o,f,v,T,O,L){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Gu.RENDER_ATTACHMENT|Gu.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Wp.UPPER_LEFT,this.clipSpaceNearZ=kg.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=f,this.canvas=v,this.canvasContext=T,this.glsl_compile=O,this.WGSLComposer=L,this.fallbackTexture2D=this.createFallbackTexture(ss.TEXTURE_2D,mc.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(ss.TEXTURE_2D,mc.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(ss.TEXTURE_2D_ARRAY,mc.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(ss.TEXTURE_3D,mc.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(ss.TEXTURE_CUBE_MAP,mc.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:Zf.REPEAT,addressModeV:Zf.REPEAT,minFilter:tc.POINT,magFilter:tc.POINT,mipmapFilter:Wu.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:Zf.REPEAT,addressModeV:Zf.REPEAT,minFilter:tc.POINT,magFilter:tc.POINT,mipmapFilter:Wu.NEAREST,compareFunction:$a.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(F){console.error(F.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return a.prototype.destroy=function(){},a.prototype.configureSwapChain=function(o,f){this.swapChainWidth===o&&this.swapChainHeight===f||(this.swapChainWidth=o,this.swapChainHeight=f)},a.prototype.getOnscreenTexture=function(){var o=this.canvasContext.getCurrentTexture(),f=o.createView(),v=new mx({id:0,device:this,descriptor:{format:Yn.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:ss.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return v.depthOrArrayLayers=1,v.sampleCount=1,v.gpuTexture=o,v.gpuTextureView=f,v.name="Onscreen",this.setResourceName(v,"Onscreen Texture"),v},a.prototype.getDevice=function(){return this},a.prototype.getCanvas=function(){return this.canvas},a.prototype.beginFrame=function(){Wa(this.frameCommandEncoderPool.length===0)},a.prototype.endFrame=function(){Wa(this.frameCommandEncoderPool.every(function(o){return o!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(o){return o.finish()})),this.frameCommandEncoderPool=[]},a.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},a.prototype.createBuffer=function(o){return new PP({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTexture=function(o){return new mx({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createSampler=function(o){return new jC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderTarget=function(o){var f=new mx({id:this.getNextUniqueId(),device:this,descriptor:(0,go.pi)((0,go.pi)({},o),{dimension:ss.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:Wf.RENDER_TARGET}),sampleCount:o.sampleCount});return f.depthOrArrayLayers=1,f.type=Bs.RenderTarget,f},a.prototype.createRenderTargetFromTexture=function(o){var f=o,v=f.format,T=f.width,O=f.height,L=f.depthOrArrayLayers,F=f.sampleCount,H=f.mipLevelCount,ie=f.gpuTexture,xe=f.gpuTextureView,Ee=f.usage;Wa(!!(Ee&Gu.RENDER_ATTACHMENT));var Ye=new mx({id:this.getNextUniqueId(),device:this,descriptor:{format:v,width:T,height:O,depthOrArrayLayers:L,dimension:ss.TEXTURE_2D,mipLevelCount:H,usage:Ee},skipCreate:!0});return Ye.depthOrArrayLayers=L,Ye.sampleCount=F,Ye.gpuTexture=ie,Ye.gpuTextureView=xe,Ye},a.prototype.createProgram=function(o){var f,v;return!((f=o.vertex)===null||f===void 0)&&f.glsl&&(o.vertex.glsl=Km(this.queryVendorInfo(),"vert",o.vertex.glsl)),!((v=o.fragment)===null||v===void 0)&&v.glsl&&(o.fragment.glsl=Km(this.queryVendorInfo(),"frag",o.fragment.glsl)),new px({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createProgramSimple=function(o){return new px({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createTextureShared=function(o,f,v){var T={width:o.width,height:o.height,depthOrArrayLayers:o.depthOrArrayLayers},O=o.mipLevelCount,L=R_(o.format),F=R0(o.dimension),H=mS(o.usage);if(f.gpuTextureformat=L,f.dimension=o.dimension,f.format=o.format,f.width=o.width,f.height=o.height,f.depthOrArrayLayers=o.depthOrArrayLayers,f.mipLevelCount=O,f.usage=H,f.sampleCount=o.sampleCount,!v){var ie=this.device.createTexture({size:T,mipLevelCount:O,format:L,dimension:F,sampleCount:o.sampleCount,usage:H}),xe=ie.createView();f.gpuTexture=ie,f.gpuTextureView=xe}},a.prototype.getFallbackSampler=function(o){var f=o.formatKind;return f===mc.Depth&&o.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},a.prototype.getFallbackTexture=function(o){var f=o.dimension,v=o.formatKind;if(f===ss.TEXTURE_2D)return v===mc.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(f===ss.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(f===ss.TEXTURE_3D)return this.fallbackTexture3D;if(f===ss.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},a.prototype.createFallbackTexture=function(o,f){var v=o===ss.TEXTURE_CUBE_MAP?6:1,T=f===mc.Float?Yn.U8_RGBA_NORM:Yn.D24;return this.createTexture({dimension:o,format:T,usage:Wf.SAMPLED,width:1,height:1,depthOrArrayLayers:v,mipLevelCount:1})},a.prototype.createBindings=function(o){return new kC({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createInputLayout=function(o){return new Jy({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createComputePipeline=function(o){return new M0({id:this.getNextUniqueId(),device:this,descriptor:o})},a.prototype.createRenderPipeline=function(o){return new UC({id:this.getNextUniqueId(),device:this,descriptor:(0,go.pi)({},o)})},a.prototype.createQueryPool=function(o,f){return new zC({id:this.getNextUniqueId(),device:this,descriptor:{type:o,elemCount:f}})},a.prototype.createRenderPipelineInternal=function(o,f){var v;if(o.gpuRenderPipeline===null){var T=o.descriptor,O=T.program,L=O.vertexStage,F=O.fragmentStage;if(!(L===null||F===null)){var H=T.megaStateDescriptor||{},ie=H.stencilBack,xe=H.stencilFront,Ee=(0,go._T)(H,["stencilBack","stencilFront"]),Ye=Ug(rm);T.megaStateDescriptor=(0,go.pi)((0,go.pi)((0,go.pi)({},Ye),{stencilBack:(0,go.pi)((0,go.pi)({},Ye.stencilBack),ie),stencilFront:(0,go.pi)((0,go.pi)({},Ye.stencilFront),xe)}),Ee);var Lt=T.megaStateDescriptor.attachmentsState[0];T.colorAttachmentFormats.forEach(function(Ui,Lo){T.megaStateDescriptor.attachmentsState[Lo]||(T.megaStateDescriptor.attachmentsState[Lo]=ZE(void 0,Lt))});var an=OC((v=T.topology)!==null&&v!==void 0?v:vu.TRIANGLES,T.megaStateDescriptor),Pn=IC(T.colorAttachmentFormats,T.megaStateDescriptor),sr=LC(T.depthStencilAttachmentFormat,T.megaStateDescriptor),Rr=void 0;T.inputLayout!==null&&(Rr=T.inputLayout.buffers);var Tr=T.sampleCount,li={layout:"auto",vertex:(0,go.pi)((0,go.pi)({},L),{buffers:Rr}),primitive:an,depthStencil:sr,multisample:{count:Tr},fragment:(0,go.pi)((0,go.pi)({},F),{targets:Pn})};o.gpuRenderPipeline=this.device.createRenderPipeline(li)}}},a.prototype.createReadback=function(){return new ES({id:this.getNextUniqueId(),device:this})},a.prototype.createRenderBundle=function(){return new Xf({id:this.getNextUniqueId(),device:this})},a.prototype.createRenderPass=function(o){var f=this.renderPassPool.pop();f===void 0&&(f=new SS(this));var v=this.frameCommandEncoderPool.pop();return v===void 0&&(v=this.device.createCommandEncoder()),f.beginRenderPass(v,o),f},a.prototype.createComputePass=function(){var o=this.computePassPool.pop();o===void 0&&(o=new xS);var f=this.frameCommandEncoderPool.pop();return f===void 0&&(f=this.device.createCommandEncoder()),o.beginComputePass(f),o},a.prototype.submitPass=function(o){var f=o;f instanceof SS?(this.frameCommandEncoderPool.push(f.frameCommandEncoder),f.finish(),this.renderPassPool.push(f)):f instanceof xS&&(this.frameCommandEncoderPool.push(f.frameCommandEncoder),f.finish(),this.computePassPool.push(f))},a.prototype.copySubTexture2D=function(o,f,v,T,O,L,F){var H=this.device.createCommandEncoder(),ie=o,xe=T,Ee={texture:xe.gpuTexture,origin:[O,L,0],mipLevel:0,aspect:"all"},Ye={texture:ie.gpuTexture,origin:[f,v,0],mipLevel:0,aspect:"all"};Wa(!!(xe.usage&Gu.COPY_SRC)),Wa(!!(ie.usage&Gu.COPY_DST)),H.copyTextureToTexture(Ee,Ye,[xe.width,xe.height,F||1]),this.device.queue.submit([H.finish()])},a.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},a.prototype.queryTextureFormatSupported=function(o,f,v){if(yl(o)){if(!this.featureTextureCompressionBC)return!1;var T=FC(o);return f%T!==0||v%T!==0?!1:this.featureTextureCompressionBC}switch(o){case Yn.U16_RGBA_NORM:return!1;case Yn.F32_RGBA:return!1}return!0},a.prototype.queryPlatformAvailable=function(){return!0},a.prototype.queryVendorInfo=function(){return this},a.prototype.queryRenderPass=function(o){var f=o;return f.descriptor},a.prototype.queryRenderTarget=function(o){var f=o;return f},a.prototype.setResourceName=function(o,f){if(o.name=f,o.type===Bs.Buffer){var v=o;v.gpuBuffer.label=f}else if(o.type===Bs.Texture){var v=o;v.gpuTexture.label=f,v.gpuTextureView.label=f}else if(o.type===Bs.RenderTarget){var v=o;v.gpuTexture.label=f,v.gpuTextureView.label=f}else if(o.type===Bs.Sampler){var v=o;v.gpuSampler.label=f}else if(o.type===Bs.RenderPipeline){var v=o;v.gpuRenderPipeline!==null&&(v.gpuRenderPipeline.label=f)}},a.prototype.setResourceLeakCheck=function(o,f){},a.prototype.checkForLeaks=function(){},a.prototype.programPatched=function(o){},a.prototype.pipelineQueryReady=function(o){var f=o;return f.gpuRenderPipeline!==null},a.prototype.pipelineForceReady=function(o){var f=o;this.createRenderPipelineInternal(f,!1)},a}(),HC=function(){function a(o){this.pluginOptions=o}return a.prototype.createSwapChain=function(o){return(0,go.mG)(this,void 0,void 0,function(){var f,v,T,O,L,F,H,ie;return(0,go.Jh)(this,function(xe){switch(xe.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];f=null,xe.label=1;case 1:return xe.trys.push([1,3,,4]),v=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:v})];case 2:return f=xe.sent(),[3,4];case 3:return T=xe.sent(),console.log(T),[3,4];case 4:return f===null?[2,null]:(O=["depth32float-stencil8","texture-compression-bc","float32-filterable"],L=O.filter(function(Ee){return f.features.has(Ee)}),[4,f.requestDevice({requiredFeatures:L})]);case 5:if(F=xe.sent(),F&&(H=this.pluginOptions.onContextLost,F.lost.then(function(){H&&H()})),F===null)return[2,null];if(ie=o.getContext("webgpu"),!ie)return[2,null];xe.label=6;case 6:return xe.trys.push([6,8,,9]),[4,C_(this.pluginOptions.shaderCompilerPath)];case 7:return xe.sent(),[3,9];case 8:return xe.sent(),[3,9];case 9:return[2,new VC(f,F,o,ie,RP,w_&&new w_)]}})})},a}(),TS=Object.defineProperty,e1=Object.defineProperties,wS=Object.getOwnPropertyDescriptors,vx=Object.getOwnPropertySymbols,ZC=Object.prototype.hasOwnProperty,WC=Object.prototype.propertyIsEnumerable,AS=(a,o,f)=>o in a?TS(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,t1=(a,o)=>{for(var f in o||(o={}))ZC.call(o,f)&&AS(a,f,o[f]);if(vx)for(var f of vx(o))WC.call(o,f)&&AS(a,f,o[f]);return a},GC=(a,o)=>e1(a,wS(o)),{isPlainObject:XC,isTypedArray:YC}=Pe.lodashUtil,$C=class{constructor(a,o){this.destroyed=!1,this.uniforms={},this.reGl=a;const{vs:f,fs:v,attributes:T,uniforms:O,primitive:L,count:F,elements:H,depth:ie,cull:xe,instances:Ee}=o,Ye={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Wp.LOWER_LEFT,clipSpaceNearZ:kg.NEGATIVE_ONE,supportMRT:!1},Lt={};this.options=o,O&&(this.uniforms=this.extractUniforms(O),Object.keys(O).forEach(Tr=>{Lt[Tr]=a.prop(Tr)}));const an={};Object.keys(T).forEach(Tr=>{an[Tr]=T[Tr].get()});const Pn=(0,K.Vb)(Km(Ye,"frag",v,null,!1)),sr=(0,K.Vb)(Km(Ye,"vert",f,null,!1)),Rr={attributes:an,frag:Pn,uniforms:Lt,vert:sr,colorMask:a.prop("colorMask"),lineWidth:1,blend:{enable:a.prop("blend.enable"),func:a.prop("blend.func"),equation:a.prop("blend.equation"),color:a.prop("blend.color")},stencil:{enable:a.prop("stencil.enable"),mask:a.prop("stencil.mask"),func:a.prop("stencil.func"),opFront:a.prop("stencil.opFront"),opBack:a.prop("stencil.opBack")},primitive:T0[L===void 0?K.gl.TRIANGLES:L]};Ee&&(Rr.instances=Ee),F?Rr.count=F:H&&(Rr.elements=H.get()),this.initDepthDrawParams({depth:ie},Rr),this.initCullDrawParams({cull:xe},Rr),this.drawCommand=a(Rr),this.drawParams=Rr}updateAttributesAndElements(a,o){const f={};Object.keys(a).forEach(v=>{f[v]=a[v].get()}),this.drawParams.attributes=f,this.drawParams.elements=o.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(a){const o={};Object.keys(a).forEach(f=>{o[f]=a[f].get()}),this.drawParams.attributes=o,this.drawCommand=this.reGl(this.drawParams)}addUniforms(a){this.uniforms=t1(t1({},this.uniforms),this.extractUniforms(a))}draw(a,o){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const f=t1(t1({},this.uniforms),this.extractUniforms(a.uniforms||{})),v={};Object.keys(f).forEach(T=>{const O=typeof f[T];O==="boolean"||O==="number"||Array.isArray(f[T])||f[T].BYTES_PER_ELEMENT?v[T]=f[T]:v[T]=f[T].get()}),v.blend=o?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(a),v.stencil=this.getStencilDrawParams(a),v.colorMask=this.getColorMaskDrawParams(a,o),this.drawCommand(v)}destroy(){var a,o;(o=(a=this.drawParams)==null?void 0:a.elements)==null||o.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(f=>{f==null||f.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:a},o){a&&(o.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:zE[a.func||K.gl.LESS],range:a.range||[0,1]})}getBlendDrawParams({blend:a}){const{enable:o,func:f,equation:v,color:T=[0,0,0,0]}=a||{};return{enable:!!o,func:{srcRGB:Ng[f&&f.srcRGB||K.gl.SRC_ALPHA],srcAlpha:Ng[f&&f.srcAlpha||K.gl.SRC_ALPHA],dstRGB:Ng[f&&f.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Ng[f&&f.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:UE[v&&v.rgb||K.gl.FUNC_ADD],alpha:UE[v&&v.alpha||K.gl.FUNC_ADD]},color:T}}getStencilDrawParams({stencil:a}){const{enable:o,mask:f=-1,func:v={cmp:K.gl.ALWAYS,ref:0,mask:-1},opFront:T={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP},opBack:O={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}}=a||{};return{enable:!!o,mask:f,func:GC(t1({},v),{cmp:PA[v.cmp]}),opFront:{fail:Bg[T.fail],zfail:Bg[T.zfail],zpass:Bg[T.zpass]},opBack:{fail:Bg[O.fail],zfail:Bg[O.zfail],zpass:Bg[O.zpass]}}}getColorMaskDrawParams({stencil:a},o){return a!=null&&a.enable&&a.opFront&&!o?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:a},o){if(a){const{enable:f,face:v=K.gl.BACK}=a;o.cull={enable:!!f,face:IA[v]}}}extractUniforms(a){const o={};return Object.keys(a).forEach(f=>{this.extractUniformsRecursively(f,a[f],o,"")}),o}extractUniformsRecursively(a,o,f,v){if(o===null||typeof o=="number"||typeof o=="boolean"||Array.isArray(o)&&typeof o[0]=="number"||YC(o)||o===""||"resize"in o){f[`${v&&v+"."}${a}`]=o;return}XC(o)&&Object.keys(o).forEach(T=>{this.extractUniformsRecursively(T,o[T],f,`${v&&v+"."}${a}`)}),Array.isArray(o)&&o.forEach((T,O)=>{Object.keys(T).forEach(L=>{this.extractUniformsRecursively(L,T[L],f,`${v&&v+"."}${a}[${O}]`)})})}},n1=class{constructor(a,o){this.isDestroy=!1;const{data:f,type:v=K.gl.UNSIGNED_BYTE,width:T,height:O,flipY:L=!1,format:F=K.gl.RGBA,mipmap:H=!1,wrapS:ie=K.gl.CLAMP_TO_EDGE,wrapT:xe=K.gl.CLAMP_TO_EDGE,aniso:Ee=0,alignment:Ye=1,premultiplyAlpha:Lt=!1,mag:an=K.gl.NEAREST,min:Pn=K.gl.NEAREST,colorSpace:sr=K.gl.BROWSER_DEFAULT_WEBGL,x:Rr=0,y:Tr=0,copy:li=!1}=o;this.width=T,this.height=O;const Ui={width:T,height:O,type:ud[v],format:a_[F],wrapS:Ub[ie],wrapT:Ub[xe],mag:kE[an],min:kE[Pn],alignment:Ye,flipY:L,colorSpace:Dg[sr],premultiplyAlpha:Lt,aniso:Ee,x:Rr,y:Tr,copy:li};f&&(Ui.data=f),typeof H=="number"?Ui.mipmap=MA[H]:typeof H=="boolean"&&(Ui.mipmap=H),this.texture=a.texture(Ui)}get(){return this.texture}update(a={}){this.texture(a)}bind(){this.texture._texture.bind()}resize({width:a,height:o}){this.texture.resize(a,o),this.width=a,this.height=o}getSize(){return[this.width,this.height]}destroy(){var a;this.isDestroy||(a=this.texture)==null||a.destroy(),this.isDestroy=!0}},Jm=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),r1=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=a=>new $C(this.gl,a),this.createAttribute=a=>new Os(this.gl,a),this.createBuffer=a=>new LA(this.gl,a),this.createElements=a=>new DA(this.gl,a),this.createTexture2D=a=>new n1(this.gl,a),this.createFramebuffer=a=>new ol(this.gl,a),this.useFramebuffer=(a,o)=>{this.gl({framebuffer:a?a.get():null})(o)},this.useFramebufferAsync=(a,o)=>Jm(this,null,function*(){this.gl({framebuffer:a?a.get():null})(o)}),this.clear=a=>{var o;const{color:f,depth:v,stencil:T,framebuffer:O=null}=a,L={color:f,depth:v,stencil:T};L.framebuffer=O===null?O:O.get(),(o=this.gl)==null||o.clear(L)},this.viewport=({x:a,y:o,width:f,height:v})=>{this.gl._gl.viewport(a,o,f,v),this.width=f,this.height=v,this.gl._refresh()},this.readPixels=a=>{const{framebuffer:o,x:f,y:v,width:T,height:O}=a,L={x:f,y:v,width:T,height:O};return o&&(L.framebuffer=o.get()),this.gl.read(L)},this.readPixelsAsync=a=>Jm(this,null,function*(){return this.readPixels(a)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var a,o,f;this.canvas=null,(f=(o=(a=this.gl)==null?void 0:a._gl)==null?void 0:o.getExtension("WEBGL_lose_context"))==null||f.loseContext(),this.gl.destroy(),this.gl=null}}init(a,o,f){return Jm(this,null,function*(){this.canvas=a,f?this.gl=f:this.gl=yield new Promise((v,T)=>{o_()({canvas:this.canvas,attributes:{alpha:!0,antialias:o.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:o.preserveDrawingBuffer,stencil:o.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(O,L)=>{(O||!L)&&T(O),v(L)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const a=this.getGLContext();a.disable(a.CULL_FACE)}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},KC=class{constructor(a,o){const{buffer:f,offset:v,stride:T,normalized:O,size:L,divisor:F,shaderLocation:H}=o;this.buffer=f,this.attribute={shaderLocation:H,buffer:f.get(),offset:v||0,stride:T||0,normalized:O||!1,divisor:F||0},L&&(this.attribute.size=L)}get(){return this.buffer}updateBuffer(a){this.buffer.subData(a)}destroy(){this.buffer.destroy()}},i1={[K.gl.FLOAT]:Float32Array,[K.gl.UNSIGNED_BYTE]:Uint8Array,[K.gl.SHORT]:Int16Array,[K.gl.UNSIGNED_SHORT]:Uint16Array,[K.gl.INT]:Int32Array,[K.gl.UNSIGNED_INT]:Uint32Array},o1={[K.gl.POINTS]:vu.POINTS,[K.gl.LINES]:vu.LINES,[K.gl.LINE_LOOP]:vu.LINES,[K.gl.LINE_STRIP]:vu.LINE_STRIP,[K.gl.TRIANGLES]:vu.TRIANGLES,[K.gl.TRIANGLE_FAN]:vu.TRIANGLES,[K.gl.TRIANGLE_STRIP]:vu.TRIANGLE_STRIP},qC={1:Yn.F32_R,2:Yn.F32_RG,3:Yn.F32_RGB,4:Yn.F32_RGBA},IP={[K.gl.STATIC_DRAW]:dp.STATIC,[K.gl.DYNAMIC_DRAW]:dp.DYNAMIC,[K.gl.STREAM_DRAW]:dp.DYNAMIC},gx={[K.gl.REPEAT]:Zf.REPEAT,[K.gl.CLAMP_TO_EDGE]:Zf.CLAMP_TO_EDGE,[K.gl.MIRRORED_REPEAT]:Zf.MIRRORED_REPEAT},QC={[K.gl.NEVER]:$a.NEVER,[K.gl.ALWAYS]:$a.ALWAYS,[K.gl.LESS]:$a.LESS,[K.gl.LEQUAL]:$a.LEQUAL,[K.gl.GREATER]:$a.GREATER,[K.gl.GEQUAL]:$a.GEQUAL,[K.gl.EQUAL]:$a.EQUAL,[K.gl.NOTEQUAL]:$a.NOTEQUAL},JC={[K.gl.FRONT]:hh.FRONT,[K.gl.BACK]:hh.BACK},CS={[K.gl.FUNC_ADD]:mu.ADD,[K.gl.MIN_EXT]:mu.MIN,[K.gl.MAX_EXT]:mu.MAX,[K.gl.FUNC_SUBTRACT]:mu.SUBSTRACT,[K.gl.FUNC_REVERSE_SUBTRACT]:mu.REVERSE_SUBSTRACT},I_={[K.gl.ZERO]:fs.ZERO,[K.gl.ONE]:fs.ONE,[K.gl.SRC_COLOR]:fs.SRC,[K.gl.ONE_MINUS_SRC_COLOR]:fs.ONE_MINUS_SRC,[K.gl.SRC_ALPHA]:fs.SRC_ALPHA,[K.gl.ONE_MINUS_SRC_ALPHA]:fs.ONE_MINUS_SRC_ALPHA,[K.gl.DST_COLOR]:fs.DST,[K.gl.ONE_MINUS_DST_COLOR]:fs.ONE_MINUS_DST,[K.gl.DST_ALPHA]:fs.DST_ALPHA,[K.gl.ONE_MINUS_DST_ALPHA]:fs.ONE_MINUS_DST_ALPHA,[K.gl.CONSTANT_COLOR]:fs.CONST,[K.gl.ONE_MINUS_CONSTANT_COLOR]:fs.ONE_MINUS_CONSTANT,[K.gl.CONSTANT_ALPHA]:fs.CONST,[K.gl.ONE_MINUS_CONSTANT_ALPHA]:fs.ONE_MINUS_CONSTANT,[K.gl.SRC_ALPHA_SATURATE]:fs.SRC_ALPHA_SATURATE},Gg={[K.gl.REPLACE]:Mc.REPLACE,[K.gl.KEEP]:Mc.KEEP,[K.gl.ZERO]:Mc.ZERO,[K.gl.INVERT]:Mc.INVERT,[K.gl.INCR]:Mc.INCREMENT_CLAMP,[K.gl.DECR]:Mc.DECREMENT_CLAMP,[K.gl.INCR_WRAP]:Mc.INCREMENT_WRAP,[K.gl.DECR_WRAP]:Mc.DECREMENT_WRAP},eO={[K.gl.ALWAYS]:$a.ALWAYS,[K.gl.EQUAL]:$a.EQUAL,[K.gl.GEQUAL]:$a.GEQUAL,[K.gl.GREATER]:$a.GREATER,[K.gl.LEQUAL]:$a.LEQUAL,[K.gl.LESS]:$a.LESS,[K.gl.NEVER]:$a.NEVER,[K.gl.NOTEQUAL]:$a.NOTEQUAL},tO={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function L_(a){return Object.prototype.toString.call(a)in tO}function nO(a,o){const f=a.length,v=Math.ceil(f/3),T=f+v,O=new Float32Array(T);for(let L=0;L<T;L+=4)O[L]=a[L/4*3],O[L+1]=a[L/4*3+1],O[L+2]=a[L/4*3+2],O[L+3]=o;return O}var yx=class{constructor(a,o){this.isDestroyed=!1;const{data:f,usage:v,type:T,isUBO:O,label:L}=o;let F;L_(f)?F=f:F=new i1[this.type||K.gl.FLOAT](f),this.type=T,this.size=F.byteLength,this.buffer=a.createBuffer({viewOrSize:F,usage:O?al.UNIFORM:al.VERTEX,hint:IP[v||K.gl.STATIC_DRAW]}),L&&a.setResourceName(this.buffer,L)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:a,offset:o}){let f;L_(a)?f=a:f=new i1[this.type||K.gl.FLOAT](a),this.buffer.setSubData(o,new Uint8Array(f.buffer))}};function Ws(a,o=0){return a+=o,a+=a<<10,a+=a>>>6,a>>>0}function OS(a){return a+=a<<3,a^=a>>>11,a+=a<<15,a>>>0}function RS(){return 0}var D_=class{constructor(){this.keys=[],this.values=[]}},N_=class{constructor(a,o){this.keyEqualFunc=a,this.keyHashFunc=o,this.buckets=new Map}findBucketIndex(a,o){for(let f=0;f<a.keys.length;f++)if(this.keyEqualFunc(o,a.keys[f]))return f;return-1}findBucket(a){const o=this.keyHashFunc(a);return this.buckets.get(o)}get(a){const o=this.findBucket(a);if(o===void 0)return null;const f=this.findBucketIndex(o,a);return f<0?null:o.values[f]}add(a,o){const f=this.keyHashFunc(a);this.buckets.get(f)===void 0&&this.buckets.set(f,new D_);const v=this.buckets.get(f);v.keys.push(a),v.values.push(o)}delete(a){const o=this.findBucket(a);if(o===void 0)return;const f=this.findBucketIndex(o,a);f!==-1&&(o.keys.splice(f,1),o.values.splice(f,1))}clear(){this.buckets.clear()}size(){let a=0;for(const o of this.buckets.values())a+=o.values.length;return a}*values(){for(const a of this.buckets.values())for(let o=a.values.length-1;o>=0;o--)yield a.values[o]}};function MS(a,o){return a=Ws(a,o.blendMode),a=Ws(a,o.blendSrcFactor),a=Ws(a,o.blendDstFactor),a}function rO(a,o){return a=MS(a,o.rgbBlendState),a=MS(a,o.alphaBlendState),a=Ws(a,o.channelWriteMask),a}function iO(a,o){return a=Ws(a,o.r<<24|o.g<<16|o.b<<8|o.a),a}function oO(a,o){var f,v,T,O,L,F,H,ie;for(let xe=0;xe<o.attachmentsState.length;xe++)a=rO(a,o.attachmentsState[xe]);return a=iO(a,o.blendConstant||Uv),a=Ws(a,o.depthCompare),a=Ws(a,o.depthWrite?1:0),a=Ws(a,(f=o.stencilFront)==null?void 0:f.compare),a=Ws(a,(v=o.stencilFront)==null?void 0:v.passOp),a=Ws(a,(T=o.stencilFront)==null?void 0:T.failOp),a=Ws(a,(O=o.stencilFront)==null?void 0:O.depthFailOp),a=Ws(a,(L=o.stencilBack)==null?void 0:L.compare),a=Ws(a,(F=o.stencilBack)==null?void 0:F.passOp),a=Ws(a,(H=o.stencilBack)==null?void 0:H.failOp),a=Ws(a,(ie=o.stencilBack)==null?void 0:ie.depthFailOp),a=Ws(a,o.stencilWrite?1:0),a=Ws(a,o.cullMode),a=Ws(a,o.frontFace?1:0),a=Ws(a,o.polygonOffset?1:0),a}function aO(a){let o=0;o=Ws(o,a.program.id),a.inputLayout!==null&&(o=Ws(o,a.inputLayout.id)),o=oO(o,a.megaStateDescriptor);for(let f=0;f<a.colorAttachmentFormats.length;f++)o=Ws(o,a.colorAttachmentFormats[f]||0);return o=Ws(o,a.depthStencilAttachmentFormat||0),OS(o)}function _x(a){let o=0;if(a.samplerBindings)for(let f=0;f<a.samplerBindings.length;f++){const v=a.samplerBindings[f];v!==null&&v.texture!==null&&(o=Ws(o,v.texture.id))}if(a.uniformBufferBindings)for(let f=0;f<a.uniformBufferBindings.length;f++){const v=a.uniformBufferBindings[f];v!==null&&v.buffer!==null&&(o=Ws(o,v.buffer.id),o=Ws(o,v.binding),o=Ws(o,v.offset),o=Ws(o,v.size))}if(a.storageBufferBindings)for(let f=0;f<a.storageBufferBindings.length;f++){const v=a.storageBufferBindings[f];v!==null&&v.buffer!==null&&(o=Ws(o,v.buffer.id),o=Ws(o,v.binding),o=Ws(o,v.offset),o=Ws(o,v.size))}if(a.storageTextureBindings)for(let f=0;f<a.storageTextureBindings.length;f++){const v=a.storageTextureBindings[f];v!==null&&v.texture!==null&&(o=Ws(o,v.texture.id),o=Ws(o,v.binding))}return OS(o)}function sO(a,o){var f,v,T,O;return((f=a.vertex)==null?void 0:f.glsl)===((v=o.vertex)==null?void 0:v.glsl)&&((T=a.fragment)==null?void 0:T.glsl)===((O=o.fragment)==null?void 0:O.glsl)}function lO(a){var o,f;return{vertex:{glsl:(o=a.vertex)==null?void 0:o.glsl},fragment:{glsl:(f=a.fragment)==null?void 0:f.glsl}}}var cO=class{constructor(a){this.device=a,this.bindingsCache=new N_($A,_x),this.renderPipelinesCache=new N_(QA,aO),this.inputLayoutsCache=new N_(KE,RS),this.programCache=new N_(sO,RS)}createBindings(a){var o;let f=this.bindingsCache.get(a);if(f===null){const v=QE(a);v.uniformBufferBindings=(o=v.uniformBufferBindings)==null?void 0:o.filter(({size:T})=>T&&T>0),f=this.device.createBindings(v),this.bindingsCache.add(v,f)}return f}createRenderPipeline(a){let o=this.renderPipelinesCache.get(a);if(o===null){const f=tC(a);f.colorAttachmentFormats=f.colorAttachmentFormats.filter(v=>v),o=this.device.createRenderPipeline(f),this.renderPipelinesCache.add(f,o)}return o}createInputLayout(a){a.vertexBufferDescriptors=a.vertexBufferDescriptors.filter(f=>!!f);let o=this.inputLayoutsCache.get(a);if(o===null){const f=rC(a);o=this.device.createInputLayout(f),this.inputLayoutsCache.add(f,o)}return o}createProgram(a){let o=this.programCache.get(a);if(o===null){const f=lO(a);o=this.device.createProgram(a),this.programCache.add(f,o)}return o}destroy(){for(const a of this.bindingsCache.values())a.destroy();for(const a of this.renderPipelinesCache.values())a.destroy();for(const a of this.inputLayoutsCache.values())a.destroy();for(const a of this.programCache.values())a.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},ev=class{constructor(a,o){const{data:f,type:v,count:T=0}=o;let O;L_(f)?O=f:O=new i1[this.type||K.gl.UNSIGNED_INT](f),this.type=v,this.count=T,this.indexBuffer=a.createBuffer({viewOrSize:O,usage:al.INDEX})}get(){return this.indexBuffer}subData({data:a}){let o;L_(a)?o=a:o=new i1[this.type||K.gl.UNSIGNED_INT](a),this.indexBuffer.setSubData(0,new Uint8Array(o.buffer))}destroy(){this.indexBuffer.destroy()}};function bx(a){return!!(a&&a.texture)}var B_=class{constructor(a,o){this.device=a,this.options=o,this.isDestroy=!1;const{wrapS:f=K.gl.CLAMP_TO_EDGE,wrapT:v=K.gl.CLAMP_TO_EDGE,aniso:T,mag:O=K.gl.NEAREST,min:L=K.gl.NEAREST}=o;this.createTexture(o),this.sampler=a.createSampler({addressModeU:gx[f],addressModeV:gx[v],minFilter:L===K.gl.NEAREST?tc.POINT:tc.BILINEAR,magFilter:O===K.gl.NEAREST?tc.POINT:tc.BILINEAR,mipmapFilter:Wu.NO_MIP,maxAnisotropy:T})}createTexture(a){const{type:o=K.gl.UNSIGNED_BYTE,width:f,height:v,flipY:T=!1,format:O=K.gl.RGBA,alignment:L=1,usage:F=K.v2.SAMPLED,unorm:H=!1,label:ie}=a;let{data:xe}=a;this.width=f,this.height=v;let Ee=Yn.U8_RGBA_RT;if(o===K.gl.UNSIGNED_BYTE&&O===K.gl.RGBA)Ee=H?Yn.U8_RGBA_NORM:Yn.U8_RGBA_RT;else if(o===K.gl.UNSIGNED_BYTE&&O===K.gl.LUMINANCE)Ee=Yn.U8_LUMINANCE;else if(o===K.gl.FLOAT&&O===K.gl.LUMINANCE)Ee=Yn.F32_LUMINANCE;else if(o===K.gl.FLOAT&&O===K.gl.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(xe&&(xe=nO(xe,0)),Ee=Yn.F32_RGBA):Ee=Yn.F32_RGB;else if(o===K.gl.FLOAT&&O===K.gl.RGBA)Ee=Yn.F32_RGBA;else if(o===K.gl.FLOAT&&O===K.gl.RED)Ee=Yn.F32_R;else throw new Error(`create texture error, type: ${o}, format: ${O}`);this.texture=this.device.createTexture({format:Ee,width:f,height:v,usage:F===K.v2.SAMPLED?Wf.SAMPLED:Wf.RENDER_TARGET,pixelStore:{unpackFlipY:T,packAlignment:L},mipLevelCount:1}),ie&&this.device.setResourceName(this.texture,ie),xe&&this.texture.setImageData([xe])}get(){return this.texture}update(a){const{data:o}=a;this.texture.setImageData([o])}bind(){}resize({width:a,height:o}){(this.width!==a||this.height!==o)&&this.destroy(),this.options.width=a,this.options.height=o,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var a;!this.isDestroy&&!this.texture.destroyed&&((a=this.texture)==null||a.destroy()),this.isDestroy=!0}},xx=class{constructor(a,o){this.device=a,this.options=o,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(a=!1){const{width:o,height:f,color:v}=this.options;v&&(bx(v)?(a&&v.resize({width:o,height:f}),this.colorTexture=v.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=v.width,this.height=v.height):o&&f&&(this.colorTexture=this.device.createTexture({format:Yn.U8_RGBA_RT,usage:Wf.RENDER_TARGET,width:o,height:f}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=o,this.height=f))}createDepthRenderTarget(a=!1){const{width:o,height:f,depth:v}=this.options;v&&(bx(v)?(a&&v.resize({width:o,height:f}),this.depthTexture=v.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=v.width,this.height=v.height):o&&f&&(this.depthTexture=this.device.createTexture({format:Yn.D24_S8,usage:Wf.RENDER_TARGET,width:o,height:f}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=o,this.height=f))}get(){return this.colorRenderTarget}destroy(){var a,o;(a=this.colorRenderTarget)==null||a.destroy(),(o=this.depthRenderTarget)==null||o.destroy()}resize({width:a,height:o}){(this.width!==a||this.height!==o)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=a,this.options.height=o,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},uO=Object.defineProperty,PS=Object.defineProperties,fO=Object.getOwnPropertyDescriptors,Xg=Object.getOwnPropertySymbols,Wv=Object.prototype.hasOwnProperty,hO=Object.prototype.propertyIsEnumerable,F_=(a,o,f)=>o in a?uO(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,am=(a,o)=>{for(var f in o||(o={}))Wv.call(o,f)&&F_(a,f,o[f]);if(Xg)for(var f of Xg(o))hO.call(o,f)&&F_(a,f,o[f]);return a},IS=(a,o)=>PS(a,fO(o)),{isPlainObject:ru,isTypedArray:k_,isNil:Ic}=Pe.lodashUtil,vp=class{constructor(a,o,f){this.device=a,this.options=o,this.service=f,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:v,fs:T,attributes:O,uniforms:L,count:F,elements:H,diagnosticDerivativeUniformityEnabled:ie}=o;this.options=o;const xe=ie?"":this.service.viewportOrigin===Wp.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=f.renderCache.createProgram({vertex:{glsl:v},fragment:{glsl:T,postprocess:an=>xe+an}}),L&&(this.uniforms=this.extractUniforms(L));const Ee=[];let Ye=0;Object.keys(O).forEach(an=>{const Pn=O[an],sr=Pn.get();this.vertexBuffers.push(sr.get());const{offset:Rr=0,stride:Tr=0,size:li=1,divisor:Ui=0,shaderLocation:Lo=0}=Pn.attribute;Ee.push({arrayStride:Tr||li*4,stepMode:Xm.VERTEX,attributes:[{format:qC[li],shaderLocation:Lo,offset:Rr,divisor:Ui}]}),Ye=sr.size/li}),F||(this.options.count=Ye),H&&(this.indexBuffer=H.get());const Lt=f.renderCache.createInputLayout({vertexBufferDescriptors:Ee,indexBufferFormat:H?Yn.U32_R:null,program:this.program});this.inputLayout=Lt,this.pipeline=this.createPipeline(o)}createPipeline(a,o){var f;const{primitive:v=K.gl.TRIANGLES,depth:T,cull:O,blend:L,stencil:F}=a,H=this.initDepthDrawParams({depth:T}),ie=!!(H&&H.enable),xe=this.initCullDrawParams({cull:O}),Ee=!!(xe&&xe.enable),Ye=this.getBlendDrawParams({blend:L}),Lt=!!(Ye&&Ye.enable),an=this.getStencilDrawParams({stencil:F}),Pn=!!(an&&an.enable),sr=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:o1[v],colorAttachmentFormats:[Yn.U8_RGBA_RT],depthStencilAttachmentFormat:Yn.D24_S8,megaStateDescriptor:{attachmentsState:[o?{channelWriteMask:hf.ALL,rgbBlendState:{blendMode:mu.ADD,blendSrcFactor:fs.ONE,blendDstFactor:fs.ZERO},alphaBlendState:{blendMode:mu.ADD,blendSrcFactor:fs.ONE,blendDstFactor:fs.ZERO}}:{channelWriteMask:Pn&&an.opFront.zpass===Mc.REPLACE?hf.NONE:hf.ALL,rgbBlendState:{blendMode:Lt&&Ye.equation.rgb||mu.ADD,blendSrcFactor:Lt&&Ye.func.srcRGB||fs.SRC_ALPHA,blendDstFactor:Lt&&Ye.func.dstRGB||fs.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:Lt&&Ye.equation.alpha||mu.ADD,blendSrcFactor:Lt&&Ye.func.srcAlpha||fs.ONE,blendDstFactor:Lt&&Ye.func.dstAlpha||fs.ONE}}],blendConstant:Lt?Uv:void 0,depthWrite:ie,depthCompare:ie&&H.func||$a.LESS,cullMode:Ee&&xe.face||hh.NONE,stencilWrite:Pn,stencilFront:{compare:Pn?an.func.cmp:$a.ALWAYS,passOp:an.opFront.zpass,failOp:an.opFront.fail,depthFailOp:an.opFront.zfail,mask:an.opFront.mask},stencilBack:{compare:Pn?an.func.cmp:$a.ALWAYS,passOp:an.opBack.zpass,failOp:an.opBack.fail,depthFailOp:an.opBack.zfail,mask:an.opBack.mask}}});return Pn&&!Ic((f=F==null?void 0:F.func)==null?void 0:f.ref)&&(sr.stencilFuncReference=F.func.ref),sr}updateAttributesAndElements(){}updateAttributes(){}addUniforms(a){this.uniforms=am(am({},this.uniforms),this.extractUniforms(a))}draw(a,o){const f=am(am({},this.options),a),{count:v=0,instances:T,elements:O,uniforms:L={},uniformBuffers:F,textures:H}=f;this.uniforms=am(am({},this.uniforms),this.extractUniforms(L));const{renderPass:ie,currentFramebuffer:xe,width:Ee,height:Ye}=this.service;this.pipeline=this.createPipeline(f,o);const Lt=this.service.device,an=Lt.swapChainHeight;if(Lt.swapChainHeight=(xe==null?void 0:xe.height)||Ye,ie.setViewport(0,0,(xe==null?void 0:xe.width)||Ee,(xe==null?void 0:xe.height)||Ye),Lt.swapChainHeight=an,ie.setPipeline(this.pipeline),Ic(this.pipeline.stencilFuncReference)||ie.setStencilReference(this.pipeline.stencilFuncReference),ie.setVertexInput(this.inputLayout,this.vertexBuffers.map(Pn=>({buffer:Pn})),O?{buffer:this.indexBuffer,offset:0}:null),F&&(this.bindings=Lt.createBindings({pipeline:this.pipeline,uniformBufferBindings:F.map((Pn,sr)=>{const Rr=Pn;return{binding:sr,buffer:Rr.get(),size:Rr.size}}),samplerBindings:H==null?void 0:H.map(Pn=>({texture:Pn.texture,sampler:Pn.sampler}))})),this.bindings&&(ie.setBindings(this.bindings),Object.keys(this.uniforms).forEach(Pn=>{const sr=this.uniforms[Pn];sr instanceof B_?this.uniforms[Pn]=sr.get():sr instanceof xx&&(this.uniforms[Pn]=sr.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),O){const Pn=O.count;Pn===0?ie.draw(v,T):ie.drawIndexed(Pn,T)}else ie.draw(v,T)}destroy(){var a,o,f;(a=this.vertexBuffers)==null||a.forEach(v=>v.destroy()),(o=this.indexBuffer)==null||o.destroy(),(f=this.bindings)==null||f.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:a}){if(a)return{enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:QC[a.func||K.gl.LESS],range:a.range||[0,1]}}getBlendDrawParams({blend:a}){const{enable:o,func:f,equation:v,color:T=[0,0,0,0]}=a||{};return{enable:!!o,func:{srcRGB:I_[f&&f.srcRGB||K.gl.SRC_ALPHA],srcAlpha:I_[f&&f.srcAlpha||K.gl.SRC_ALPHA],dstRGB:I_[f&&f.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:I_[f&&f.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:CS[v&&v.rgb||K.gl.FUNC_ADD],alpha:CS[v&&v.alpha||K.gl.FUNC_ADD]},color:T}}getStencilDrawParams({stencil:a}){const{enable:o,mask:f=4294967295,func:v={cmp:K.gl.ALWAYS,ref:0,mask:4294967295},opFront:T={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP},opBack:O={fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}}=a||{};return{enable:!!o,mask:f,func:IS(am({},v),{cmp:eO[v.cmp]}),opFront:{fail:Gg[T.fail],zfail:Gg[T.zfail],zpass:Gg[T.zpass],mask:v.mask},opBack:{fail:Gg[O.fail],zfail:Gg[O.zfail],zpass:Gg[O.zpass],mask:v.mask}}}initCullDrawParams({cull:a}){if(a){const{enable:o,face:f=K.gl.BACK}=a;return{enable:!!o,face:JC[f]}}}extractUniforms(a){const o={};return Object.keys(a).forEach(f=>{this.extractUniformsRecursively(f,a[f],o,"")}),o}extractUniformsRecursively(a,o,f,v){if(o===null||typeof o=="number"||typeof o=="boolean"||Array.isArray(o)&&typeof o[0]=="number"||k_(o)||o===""||"resize"in o){f[`${v&&v+"."}${a}`]=o;return}ru(o)&&Object.keys(o).forEach(T=>{this.extractUniformsRecursively(T,o[T],f,`${v&&v+"."}${a}`)}),Array.isArray(o)&&o.forEach((T,O)=>{Object.keys(T).forEach(L=>{this.extractUniformsRecursively(L,T[L],f,`${v&&v+"."}${a}[${O}]`)})})}};function Yg(a){return typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext?!0:!!(a&&a._version===2)}var z_=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),{isUndefined:$g}=Pe.lodashUtil,LS=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=a=>new vp(this.device,a,this),this.createAttribute=a=>new KC(this.device,a),this.createBuffer=a=>new yx(this.device,a),this.createElements=a=>new ev(this.device,a),this.createTexture2D=a=>new B_(this.device,a),this.createFramebuffer=a=>new xx(this.device,a),this.useFramebuffer=(a,o)=>{this.currentFramebuffer=a,this.beginFrame(),o(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(a,o)=>z_(this,null,function*(){this.currentFramebuffer=a,this.preRenderPass=this.renderPass,this.beginFrame(),yield o(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=a=>{const{color:o,depth:f,stencil:v,framebuffer:T=null}=a;if(T)T.clearOptions={color:o,depth:f,stencil:v};else{const O=this.queryVerdorInfo();if(O==="WebGL1"){const L=this.getGLContext();$g(v)?$g(f)||(L.clearDepth(f),L.clear(L.DEPTH_BUFFER_BIT)):(L.clearStencil(v),L.clear(L.STENCIL_BUFFER_BIT))}else if(O==="WebGL2"){const L=this.getGLContext();$g(v)?$g(f)||L.clearBufferfv(L.DEPTH,0,[f]):L.clearBufferiv(L.STENCIL,0,[v])}}},this.viewport=({width:a,height:o})=>{this.swapChain.configureSwapChain(a,o),this.createMainColorDepthRT(a,o),this.width=a,this.height=o},this.readPixels=a=>{const{framebuffer:o,x:f,y:v,width:T,height:O}=a,L=this.device.createReadback(),F=o.colorTexture,H=L.readTextureSync(F,f,this.viewportOrigin===Wp.LOWER_LEFT?v:this.height-v,T,O,new Uint8Array(T*O*4));if(this.viewportOrigin!==Wp.LOWER_LEFT)for(let ie=0;ie<H.length;ie+=4){const xe=H[ie];H[ie]=H[ie+2],H[ie+2]=xe}return L.destroy(),H},this.readPixelsAsync=a=>z_(this,null,function*(){const{framebuffer:o,x:f,y:v,width:T,height:O}=a,L=this.device.createReadback(),F=o.colorTexture,H=yield L.readTexture(F,f,this.viewportOrigin===Wp.LOWER_LEFT?v:this.height-v,T,O,new Uint8Array(T*O*4));if(this.viewportOrigin!==Wp.LOWER_LEFT)for(let ie=0;ie<H.length;ie+=4){const xe=H[ie];H[ie]=H[ie+2],H[ie+2]=xe}return L.destroy(),H}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var a;return(a=this.canvas)==null?void 0:a.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var a;this.canvas=null,(a=this.uniformBuffers)==null||a.forEach(o=>{o.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(a,o){return z_(this,null,function*(){const{enableWebGPU:f,shaderCompilerPath:v,antialias:T}=o;this.canvas=a;const L=yield(f?new HC({shaderCompilerPath:v}):new gC({targets:["webgl2","webgl1"],antialias:T,onContextLost(H){console.warn("context lost",H)},onContextCreationError(H){console.warn("context creation error",H)},onContextRestored(H){console.warn("context restored",H)}})).createSwapChain(a);L.configureSwapChain(a.width,a.height),this.device=L.getDevice(),this.swapChain=L,this.renderCache=new cO(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const F=this.device.gl;this.extensionObject={OES_texture_float:!Yg(F)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height)})}createMainColorDepthRT(a,o){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:Yn.U8_RGBA_RT,width:a,height:o,usage:Wf.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:Yn.D24_S8,width:a,height:o,usage:Wf.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:a,swapChain:o,mainColorRT:f,mainDepthRT:v}=this,T=a?a.colorRenderTarget:f,O=a?null:o.getOnscreenTexture(),L=a?a.depthRenderTarget:v,{color:F=[0,0,0,0],depth:H=1,stencil:ie=0}=(a==null?void 0:a.clearOptions)||{},xe=T?zv(F[0]*255,F[1]*255,F[2]*255,F[3]):Uv,Ee=L?H:void 0,Ye=L?ie:void 0,Lt=this.device.createRenderPass({colorAttachment:[T],colorResolveTo:[O],colorClearColor:[xe],colorStore:[!0],depthStencilAttachment:L,depthClearValue:Ee,stencilClearValue:Ye});this.renderPass=Lt}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const a=this.device.gl;return a.getParameter(a.ALIASED_POINT_SIZE_RANGE)}testExtension(a){return!!this.getGLContext().getExtension(a)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(a){this.isDirty=a}getDirty(){return this.isDirty}},ea=["selectstart","selecting","selectend"],dO=class extends Fc.EventEmitter{constructor(a,o={}){super(),this.isEnable=!1,this.onDragStart=f=>{this.box.style.display="block",this.startEvent=this.endEvent=f,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=f=>{this.endEvent=f,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=f=>{this.endEvent=f,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=a,this.options=o}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:a}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const o=Pe.SO.create("div",void 0,this.container);o.classList.add("l7-select-box"),a&&o.classList.add(a),o.style.display="none",this.box=o}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:a,y:o}=this.startEvent,{x:f,y:v}=this.endEvent,T=Math.min(a,f),O=Math.min(o,v),L=Math.abs(a-f),F=Math.abs(o-v);this.box.style.top=`${O}px`,this.box.style.left=`${T}px`,this.box.style.width=`${L}px`,this.box.style.height=`${F}px`}getLngLatBox(){const{lngLat:{lng:a,lat:o}}=this.startEvent,{lngLat:{lng:f,lat:v}}=this.endEvent;return(0,Pe.Ol)([[a,o],[f,v]])}},pO=Object.defineProperty,a1=Object.defineProperties,DS=Object.getOwnPropertyDescriptors,s1=Object.getOwnPropertySymbols,Gv=Object.prototype.hasOwnProperty,LP=Object.prototype.propertyIsEnumerable,U_=(a,o,f)=>o in a?pO(a,o,{enumerable:!0,configurable:!0,writable:!0,value:f}):a[o]=f,NS=(a,o)=>{for(var f in o||(o={}))Gv.call(o,f)&&U_(a,f,o[f]);if(s1)for(var f of s1(o))LP.call(o,f)&&U_(a,f,o[f]);return a},Ex=(a,o)=>a1(a,DS(o)),Kg=(a,o,f)=>new Promise((v,T)=>{var O=H=>{try{F(f.next(H))}catch(ie){T(ie)}},L=H=>{try{F(f.throw(H))}catch(ie){T(ie)}},F=H=>H.done?v(H.value):Promise.resolve(H.value).then(O,L);F((f=f.apply(a,o)).next())}),mO=class{constructor(a){const{id:o,map:f,renderer:v="device"}=a,T=(0,K.Hp)();this.container=T,f.setContainer(T,o),v==="regl"?T.rendererService=new r1:T.rendererService=new LS,this.sceneService=T.sceneService,this.mapService=T.mapService,this.iconService=T.iconService,this.fontService=T.fontService,this.controlService=T.controlService,this.layerService=T.layerService,this.debugService=T.debugService,this.debugService.setEnable(a.debug),this.markerService=T.markerService,this.interactionService=T.interactionService,this.popupService=T.popupService,this.boxSelect=new dO(this,{}),this.initComponent(o),this.sceneService.init(a),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(a){return Kg(this,null,function*(){return this.sceneService.exportPng(a)})}exportMap(a){return Kg(this,null,function*(){return this.sceneService.exportPng(a)})}registerRenderService(a){this.sceneService.loaded?new a(this).init():this.on("loaded",()=>{new a(this).init()})}setBgColor(a){this.mapService.setBgColor(a)}addLayer(a){this.loaded?this.preAddLayer(a):this.once("loaded",()=>{this.preAddLayer(a)})}preAddLayer(a){const o=(0,K.e7)(this.container);if(a.setContainer(o),this.sceneService.addLayer(a),a.inited){this.initTileLayer(a);const f=this.initMask(a);this.addMask(f,a.id)}else a.on("inited",()=>{this.initTileLayer(a);const f=this.initMask(a);this.addMask(f,a.id)})}initMask(a){const{mask:o,maskfence:f,maskColor:v="#000",maskOpacity:T=0}=a.getLayerConfig();return!o||!f?void 0:new IE().source(f).shape("fill").style({color:v,opacity:T})}addMask(a,o){if(!a)return;const f=this.getLayer(o);if(f){const v=(0,K.e7)(this.container);a.setContainer(v),f.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(a){return this.layerService.getLayer(a)}getLayerByName(a){return this.layerService.getLayerByName(a)}removeLayer(a,o){return Kg(this,null,function*(){yield this.layerService.remove(a,o)})}removeAllLayer(){return Kg(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(a){this.layerService.setEnableRender(a)}addIconFont(a,o){this.fontService.addIconFont(a,o)}addIconFonts(a){a.forEach(([o,f])=>{this.fontService.addIconFont(o,f)})}addFontFace(a,o){this.fontService.once("fontloaded",f=>{this.emit("fontloaded",f)}),this.fontService.addFontFace(a,o)}addImage(a,o){return Kg(this,null,function*(){yield this.iconService.addImage(a,o)})}hasImage(a){return this.iconService.hasImage(a)}removeImage(a){this.iconService.removeImage(a)}addIconFontGlyphs(a,o){this.fontService.addIconGlyphs(o)}addControl(a){this.controlService.addControl(a,this.container)}removeControl(a){this.controlService.removeControl(a)}getControlByName(a){return this.controlService.getControlByName(a)}addMarker(a){this.markerService.addMarker(a)}addMarkerLayer(a){this.markerService.addMarkerLayer(a)}removeMarkerLayer(a){this.markerService.removeMarkerLayer(a)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(a){this.popupService.addPopup(a)}removePopup(a){this.popupService.removePopup(a)}on(a,o){var f;ea.includes(a)?(f=this.boxSelect)==null||f.on(a,o):K.P7.includes(a)?this.sceneService.on(a,o):this.mapService.on(a,o)}once(a,o){var f;ea.includes(a)?(f=this.boxSelect)==null||f.once(a,o):K.P7.includes(a)?this.sceneService.once(a,o):this.mapService.once(a,o)}emit(a,o){K.P7.indexOf(a)===-1?this.mapService.on(a,o):this.sceneService.emit(a,o)}off(a,o){var f;ea.includes(a)?(f=this.boxSelect)==null||f.off(a,o):K.P7.includes(a)?this.sceneService.off(a,o):this.mapService.off(a,o)}getZoom(){return this.mapService.getZoom()}getCenter(a){return this.mapService.getCenter(a)}setCenter(a,o){return this.mapService.setCenter(a,o)}getPitch(){return this.mapService.getPitch()}setPitch(a){return this.mapService.setPitch(a)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(a){this.mapService.setRotation(a)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(a){this.mapService.panTo(a)}panBy(a,o){this.mapService.panBy(a,o)}getContainer(){return this.mapService.getContainer()}setZoom(a){this.mapService.setZoom(a)}fitBounds(a,o){const{fitBoundsOptions:f,animate:v}=this.sceneService.getSceneConfig();this.mapService.fitBounds(a,o||Ex(NS({},f),{animate:v}))}setZoomAndCenter(a,o){this.mapService.setZoomAndCenter(a,o)}setMapStyle(a){this.mapService.setMapStyle(a)}setMapStatus(a){this.mapService.setMapStatus(a)}pixelToLngLat(a){return this.mapService.pixelToLngLat(a)}lngLatToPixel(a){return this.mapService.lngLatToPixel(a)}containerToLngLat(a){return this.mapService.containerToLngLat(a)}lngLatToContainer(a){return this.mapService.lngLatToContainer(a)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(a){this.container.postProcessingPass.name=new a}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(a=!0){this.boxSelect.enable(),a&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(a,o){Pe.SA.REGISTERED_PROTOCOLS[a]=o}static removeProtocol(a){delete Pe.SA.REGISTERED_PROTOCOLS[a]}getProtocol(a){return Pe.SA.REGISTERED_PROTOCOLS[a]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(a){this.controlService.init({container:Pe.SO.getContainer(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:a,logoPosition:o}=this.sceneService.getSceneConfig();a&&this.addControl(new $d({position:o}))}initTileLayer(a){a.getSource().isTile&&(a.tileLayer=new AA(a))}},Lk="2.22.0"},81957:function($t,W){"use strict";var D=function(ee,X,E){return ee<X?X:ee>E?E:ee};W.Z=D},95147:function($t,W){"use strict";var D=function(ee){return ee==null};W.Z=D},25897:function($t,W,D){"use strict";var ee=D(95456),X=function(E){return(0,ee.Z)(E,"Number")};W.Z=X},95456:function($t,W){"use strict";var D={}.toString,ee=function(X,E){return D.call(X)==="[object "+E+"]"};W.Z=ee},131:function($t,W,D){"use strict";D.r(W),D.d(W,{TinyColor:function(){return ee.C},bounds:function(){return pt},convertDecimalToHex:function(){return he.Wl},convertHexToDecimal:function(){return he.T6},default:function(){return vt},fromRatio:function(){return oe},hslToRgb:function(){return he.ve},hsvToRgb:function(){return he.WE},inputToRGB:function(){return te.uA},isReadable:function(){return _e},isValidCSSUnit:function(){return te.ky},legacyRandom:function(){return je},mostReadable:function(){return re},names:function(){return X.R},numberInputToObject:function(){return he.Yt},parseIntFromHex:function(){return he.VD},random:function(){return ve},readability:function(){return E},rgbToHex:function(){return he.vq},rgbToHsl:function(){return he.lC},rgbToHsv:function(){return he.py},rgbToRgb:function(){return he.rW},rgbaToArgbHex:function(){return he.GC},rgbaToHex:function(){return he.s},stringInputToObject:function(){return te.uz},tinycolor:function(){return ee.H},toMsFilter:function(){return se}});var ee=D(10274),X=D(48701);function E(ke,Re){var bt=new ee.C(ke),gt=new ee.C(Re);return(Math.max(bt.getLuminance(),gt.getLuminance())+.05)/(Math.min(bt.getLuminance(),gt.getLuminance())+.05)}function _e(ke,Re,bt){var gt,Ct;bt===void 0&&(bt={level:"AA",size:"small"});var Sn=E(ke,Re);switch(((gt=bt.level)!==null&&gt!==void 0?gt:"AA")+((Ct=bt.size)!==null&&Ct!==void 0?Ct:"small")){case"AAsmall":case"AAAlarge":return Sn>=4.5;case"AAlarge":return Sn>=3;case"AAAsmall":return Sn>=7;default:return!1}}function re(ke,Re,bt){bt===void 0&&(bt={includeFallbackColors:!1,level:"AA",size:"small"});for(var gt=null,Ct=0,Sn=bt.includeFallbackColors,He=bt.level,Ot=bt.size,Ce=0,ot=Re;Ce<ot.length;Ce++){var $e=ot[Ce],Xe=E(ke,$e);Xe>Ct&&(Ct=Xe,gt=new ee.C($e))}return _e(ke,gt,{level:He,size:Ot})||!Sn?gt:(bt.includeFallbackColors=!1,re(ke,["#fff","#000"],bt))}var he=D(86500);function se(ke,Re){var bt=new ee.C(ke),gt="#"+(0,he.GC)(bt.r,bt.g,bt.b,bt.a),Ct=gt,Sn=bt.gradientType?"GradientType = 1, ":"";if(Re){var He=new ee.C(Re);Ct="#"+(0,he.GC)(He.r,He.g,He.b,He.a)}return"progid:DXImageTransform.Microsoft.gradient(".concat(Sn,"startColorstr=").concat(gt,",endColorstr=").concat(Ct,")")}var Se=D(90279);function oe(ke,Re){var bt={r:(0,Se.JX)(ke.r),g:(0,Se.JX)(ke.g),b:(0,Se.JX)(ke.b)};return ke.a!==void 0&&(bt.a=Number(ke.a)),new ee.C(bt,Re)}function je(){return new ee.C({r:Math.random(),g:Math.random(),b:Math.random()})}var te=D(1350);function ve(ke){if(ke===void 0&&(ke={}),ke.count!==void 0&&ke.count!==null){var Re=ke.count,bt=[];for(ke.count=void 0;Re>bt.length;)ke.count=null,ke.seed&&(ke.seed+=1),bt.push(ve(ke));return ke.count=Re,bt}var gt=Be(ke.hue,ke.seed),Ct=Te(gt,ke),Sn=we(gt,Ct,ke),He={h:gt,s:Ct,v:Sn};return ke.alpha!==void 0&&(He.a=ke.alpha),new ee.C(He)}function Be(ke,Re){var bt=Ze(ke),gt=ft(bt,Re);return gt<0&&(gt=360+gt),gt}function Te(ke,Re){if(Re.hue==="monochrome")return 0;if(Re.luminosity==="random")return ft([0,100],Re.seed);var bt=xt(ke).saturationRange,gt=bt[0],Ct=bt[1];switch(Re.luminosity){case"bright":gt=55;break;case"dark":gt=Ct-10;break;case"light":Ct=55;break;default:break}return ft([gt,Ct],Re.seed)}function we(ke,Re,bt){var gt=le(ke,Re),Ct=100;switch(bt.luminosity){case"dark":Ct=gt+20;break;case"light":gt=(Ct+gt)/2;break;case"random":gt=0,Ct=100;break;default:break}return ft([gt,Ct],bt.seed)}function le(ke,Re){for(var bt=xt(ke).lowerBounds,gt=0;gt<bt.length-1;gt++){var Ct=bt[gt][0],Sn=bt[gt][1],He=bt[gt+1][0],Ot=bt[gt+1][1];if(Re>=Ct&&Re<=He){var Ce=(Ot-Sn)/(He-Ct),ot=Sn-Ce*Ct;return Ce*Re+ot}}return 0}function Ze(ke){var Re=parseInt(ke,10);if(!Number.isNaN(Re)&&Re<360&&Re>0)return[Re,Re];if(typeof ke=="string"){var bt=pt.find(function(He){return He.name===ke});if(bt){var gt=Zt(bt);if(gt.hueRange)return gt.hueRange}var Ct=new ee.C(ke);if(Ct.isValid){var Sn=Ct.toHsv().h;return[Sn,Sn]}}return[0,360]}function xt(ke){ke>=334&&ke<=360&&(ke-=360);for(var Re=0,bt=pt;Re<bt.length;Re++){var gt=bt[Re],Ct=Zt(gt);if(Ct.hueRange&&ke>=Ct.hueRange[0]&&ke<=Ct.hueRange[1])return Ct}throw Error("Color not found")}function ft(ke,Re){if(Re===void 0)return Math.floor(ke[0]+Math.random()*(ke[1]+1-ke[0]));var bt=ke[1]||1,gt=ke[0]||0;Re=(Re*9301+49297)%233280;var Ct=Re/233280;return Math.floor(gt+Ct*(bt-gt))}function Zt(ke){var Re=ke.lowerBounds[0][0],bt=ke.lowerBounds[ke.lowerBounds.length-1][0],gt=ke.lowerBounds[ke.lowerBounds.length-1][1],Ct=ke.lowerBounds[0][1];return{name:ke.name,hueRange:ke.hueRange,lowerBounds:ke.lowerBounds,saturationRange:[Re,bt],brightnessRange:[gt,Ct]}}var pt=[{name:"monochrome",hueRange:null,lowerBounds:[[0,0],[100,0]]},{name:"red",hueRange:[-26,18],lowerBounds:[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]},{name:"orange",hueRange:[19,46],lowerBounds:[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]},{name:"yellow",hueRange:[47,62],lowerBounds:[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]},{name:"green",hueRange:[63,178],lowerBounds:[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]},{name:"blue",hueRange:[179,257],lowerBounds:[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]},{name:"purple",hueRange:[258,282],lowerBounds:[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]},{name:"pink",hueRange:[283,334],lowerBounds:[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]}],vt=ee.H},38163:function($t){$t.exports=W;function W(X,E){var _e=X&&X.type,re;if(_e==="FeatureCollection")for(re=0;re<X.features.length;re++)W(X.features[re],E);else if(_e==="GeometryCollection")for(re=0;re<X.geometries.length;re++)W(X.geometries[re],E);else if(_e==="Feature")W(X.geometry,E);else if(_e==="Polygon")D(X.coordinates,E);else if(_e==="MultiPolygon")for(re=0;re<X.coordinates.length;re++)D(X.coordinates[re],E);return X}function D(X,E){if(X.length!==0){ee(X[0],E);for(var _e=1;_e<X.length;_e++)ee(X[_e],!E)}}function ee(X,E){for(var _e=0,re=0,he=0,se=X.length,Se=se-1;he<se;Se=he++){var oe=(X[he][0]-X[Se][0])*(X[Se][1]+X[he][1]),je=_e+oe;re+=Math.abs(_e)>=Math.abs(oe)?_e-je+oe:oe-je+_e,_e=je}_e+re>=0!=!!E&&X.reverse()}},75550:function($t){"use strict";$t.exports=W;function W(D,ee){this.x=D,this.y=ee}W.prototype={clone:function(){return new W(this.x,this.y)},add:function(D){return this.clone()._add(D)},sub:function(D){return this.clone()._sub(D)},multByPoint:function(D){return this.clone()._multByPoint(D)},divByPoint:function(D){return this.clone()._divByPoint(D)},mult:function(D){return this.clone()._mult(D)},div:function(D){return this.clone()._div(D)},rotate:function(D){return this.clone()._rotate(D)},rotateAround:function(D,ee){return this.clone()._rotateAround(D,ee)},matMult:function(D){return this.clone()._matMult(D)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(D){return this.x===D.x&&this.y===D.y},dist:function(D){return Math.sqrt(this.distSqr(D))},distSqr:function(D){var ee=D.x-this.x,X=D.y-this.y;return ee*ee+X*X},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(D){return Math.atan2(this.y-D.y,this.x-D.x)},angleWith:function(D){return this.angleWithSep(D.x,D.y)},angleWithSep:function(D,ee){return Math.atan2(this.x*ee-this.y*D,this.x*D+this.y*ee)},_matMult:function(D){var ee=D[0]*this.x+D[1]*this.y,X=D[2]*this.x+D[3]*this.y;return this.x=ee,this.y=X,this},_add:function(D){return this.x+=D.x,this.y+=D.y,this},_sub:function(D){return this.x-=D.x,this.y-=D.y,this},_mult:function(D){return this.x*=D,this.y*=D,this},_div:function(D){return this.x/=D,this.y/=D,this},_multByPoint:function(D){return this.x*=D.x,this.y*=D.y,this},_divByPoint:function(D){return this.x/=D.x,this.y/=D.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var D=this.y;return this.y=this.x,this.x=-D,this},_rotate:function(D){var ee=Math.cos(D),X=Math.sin(D),E=ee*this.x-X*this.y,_e=X*this.x+ee*this.y;return this.x=E,this.y=_e,this},_rotateAround:function(D,ee){var X=Math.cos(D),E=Math.sin(D),_e=ee.x+X*(this.x-ee.x)-E*(this.y-ee.y),re=ee.y+E*(this.x-ee.x)+X*(this.y-ee.y);return this.x=_e,this.y=re,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},W.convert=function(D){return D instanceof W?D:Array.isArray(D)?new W(D[0],D[1]):D}},49296:function($t){"use strict";$t.exports=D,$t.exports.default=D;var W=1e20;function D(re,he,se,Se,oe,je){this.fontSize=re||24,this.buffer=he===void 0?3:he,this.cutoff=Se||.25,this.fontFamily=oe||"sans-serif",this.fontWeight=je||"normal",this.radius=se||8;var te=this.size=this.fontSize+this.buffer*2,ve=te+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=te,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ve*ve),this.gridInner=new Float64Array(ve*ve),this.f=new Float64Array(ve),this.z=new Float64Array(ve+1),this.v=new Uint16Array(ve),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(te/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ee(re,he,se,Se,oe,je,te){je.fill(W,0,he*se),te.fill(0,0,he*se);for(var ve=(he-Se)/2,Be=0;Be<oe;Be++)for(var Te=0;Te<Se;Te++){var we=(Be+ve)*he+Te+ve,le=re.data[4*(Be*Se+Te)+3]/255;if(le===1)je[we]=0,te[we]=W;else if(le===0)je[we]=W,te[we]=0;else{var Ze=Math.max(0,.5-le),xt=Math.max(0,le-.5);je[we]=Ze*Ze,te[we]=xt*xt}}}function X(re,he,se,Se,oe,je,te){for(var ve=0;ve<he*se;ve++){var Be=Math.sqrt(Se[ve])-Math.sqrt(oe[ve]);re[ve]=Math.round(255-255*(Be/je+te))}}D.prototype._draw=function(re,he){var se=this.ctx.measureText(re),Se=se.width,oe=2*this.buffer,je,te,ve,Be,Te,we,le,Ze;he&&this.useMetrics?(Te=Math.floor(se.actualBoundingBoxAscent),Ze=this.buffer+Math.ceil(se.actualBoundingBoxAscent),we=this.buffer,le=this.buffer,te=Math.min(this.size,Math.ceil(se.actualBoundingBoxRight-se.actualBoundingBoxLeft)),Be=Math.min(this.size-we,Math.ceil(se.actualBoundingBoxAscent+se.actualBoundingBoxDescent)),je=te+oe,ve=Be+oe,this.ctx.textBaseline="alphabetic"):(je=te=this.size,ve=Be=this.size,Te=19*this.fontSize/24,we=le=0,Ze=this.middle,this.ctx.textBaseline="middle");var xt;te&&Be&&(this.ctx.clearRect(le,we,te,Be),this.ctx.fillText(re,this.buffer,Ze),xt=this.ctx.getImageData(le,we,te,Be));var ft=new Uint8ClampedArray(je*ve);return ee(xt,je,ve,te,Be,this.gridOuter,this.gridInner),E(this.gridOuter,je,ve,this.f,this.v,this.z),E(this.gridInner,je,ve,this.f,this.v,this.z),X(ft,je,ve,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ft,metrics:{width:te,height:Be,sdfWidth:je,sdfHeight:ve,top:Te,left:0,advance:Se}}},D.prototype.draw=function(re){return this._draw(re,!1).data},D.prototype.drawWithMetrics=function(re){return this._draw(re,!0)};function E(re,he,se,Se,oe,je){for(var te=0;te<he;te++)_e(re,te,he,se,Se,oe,je);for(var ve=0;ve<se;ve++)_e(re,ve*he,1,he,Se,oe,je)}function _e(re,he,se,Se,oe,je,te){var ve,Be,Te,we;for(je[0]=0,te[0]=-W,te[1]=W,ve=0;ve<Se;ve++)oe[ve]=re[he+ve*se];for(ve=1,Be=0,Te=0;ve<Se;ve++){do we=je[Be],Te=(oe[ve]-oe[we]+ve*ve-we*we)/(ve-we)/2;while(Te<=te[Be]&&--Be>-1);Be++,je[Be]=ve,te[Be]=Te,te[Be+1]=W}for(ve=0,Be=0;ve<Se;ve++){for(;te[Be+1]<ve;)Be++;we=je[Be],re[he+ve*se]=oe[we]+(ve-we)*(ve-we)}}},38929:function($t,W,D){$t.exports.VectorTile=D(22779),D(66024),D(59701)},22779:function($t,W,D){"use strict";var ee=D(59701);$t.exports=X;function X(_e,re){this.layers=_e.readFields(E,{},re)}function E(_e,re,he){if(_e===3){var se=new ee(he,he.readVarint()+he.pos);se.length&&(re[se.name]=se)}}},66024:function($t,W,D){"use strict";var ee=D(75550);$t.exports=X;function X(se,Se,oe,je,te){this.properties={},this.extent=oe,this.type=0,this._pbf=se,this._geometry=-1,this._keys=je,this._values=te,se.readFields(E,this,Se)}function E(se,Se,oe){se==1?Se.id=oe.readVarint():se==2?_e(oe,Se):se==3?Se.type=oe.readVarint():se==4&&(Se._geometry=oe.pos)}function _e(se,Se){for(var oe=se.readVarint()+se.pos;se.pos<oe;){var je=Se._keys[se.readVarint()],te=Se._values[se.readVarint()];Se.properties[je]=te}}X.types=["Unknown","Point","LineString","Polygon"],X.prototype.loadGeometry=function(){var se=this._pbf;se.pos=this._geometry;for(var Se=se.readVarint()+se.pos,oe=1,je=0,te=0,ve=0,Be=[],Te;se.pos<Se;){if(je<=0){var we=se.readVarint();oe=we&7,je=we>>3}if(je--,oe===1||oe===2)te+=se.readSVarint(),ve+=se.readSVarint(),oe===1&&(Te&&Be.push(Te),Te=[]),Te.push(new ee(te,ve));else if(oe===7)Te&&Te.push(Te[0].clone());else throw new Error("unknown command "+oe)}return Te&&Be.push(Te),Be},X.prototype.bbox=function(){var se=this._pbf;se.pos=this._geometry;for(var Se=se.readVarint()+se.pos,oe=1,je=0,te=0,ve=0,Be=1/0,Te=-1/0,we=1/0,le=-1/0;se.pos<Se;){if(je<=0){var Ze=se.readVarint();oe=Ze&7,je=Ze>>3}if(je--,oe===1||oe===2)te+=se.readSVarint(),ve+=se.readSVarint(),te<Be&&(Be=te),te>Te&&(Te=te),ve<we&&(we=ve),ve>le&&(le=ve);else if(oe!==7)throw new Error("unknown command "+oe)}return[Be,we,Te,le]},X.prototype.toGeoJSON=function(se,Se,oe){var je=this.extent*Math.pow(2,oe),te=this.extent*se,ve=this.extent*Se,Be=this.loadGeometry(),Te=X.types[this.type],we,le;function Ze(Zt){for(var pt=0;pt<Zt.length;pt++){var vt=Zt[pt],ke=180-(vt.y+ve)*360/je;Zt[pt]=[(vt.x+te)*360/je-180,360/Math.PI*Math.atan(Math.exp(ke*Math.PI/180))-90]}}switch(this.type){case 1:var xt=[];for(we=0;we<Be.length;we++)xt[we]=Be[we][0];Be=xt,Ze(Be);break;case 2:for(we=0;we<Be.length;we++)Ze(Be[we]);break;case 3:for(Be=re(Be),we=0;we<Be.length;we++)for(le=0;le<Be[we].length;le++)Ze(Be[we][le]);break}Be.length===1?Be=Be[0]:Te="Multi"+Te;var ft={type:"Feature",geometry:{type:Te,coordinates:Be},properties:this.properties};return"id"in this&&(ft.id=this.id),ft};function re(se){var Se=se.length;if(Se<=1)return[se];for(var oe=[],je,te,ve=0;ve<Se;ve++){var Be=he(se[ve]);Be!==0&&(te===void 0&&(te=Be<0),te===Be<0?(je&&oe.push(je),je=[se[ve]]):je.push(se[ve]))}return je&&oe.push(je),oe}function he(se){for(var Se=0,oe=0,je=se.length,te=je-1,ve,Be;oe<je;te=oe++)ve=se[oe],Be=se[te],Se+=(Be.x-ve.x)*(ve.y+Be.y);return Se}},59701:function($t,W,D){"use strict";var ee=D(66024);$t.exports=X;function X(re,he){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=re,this._keys=[],this._values=[],this._features=[],re.readFields(E,this,he),this.length=this._features.length}function E(re,he,se){re===15?he.version=se.readVarint():re===1?he.name=se.readString():re===5?he.extent=se.readVarint():re===2?he._features.push(se.pos):re===3?he._keys.push(se.readString()):re===4&&he._values.push(_e(se))}function _e(re){for(var he=null,se=re.readVarint()+re.pos;re.pos<se;){var Se=re.readVarint()>>3;he=Se===1?re.readString():Se===2?re.readFloat():Se===3?re.readDouble():Se===4?re.readVarint64():Se===5?re.readVarint():Se===6?re.readSVarint():Se===7?re.readBoolean():null}return he}X.prototype.feature=function(re){if(re<0||re>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[re];var he=this._pbf.readVarint()+this._pbf.pos;return new ee(this._pbf,he,this.extent,this._keys,this._values)}},85549:function($t,W,D){"use strict";"use client";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=D(51130),_e=D(46549);const re=se=>{const{space:Se,form:oe,children:je}=se;if(je==null)return null;let te=je;return oe&&(te=X.default.createElement(E.NoFormStyle,{override:!0,status:!0},te)),Se&&(te=X.default.createElement(_e.NoCompactStyle,null,te)),te};var he=W.default=re},45471:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.PresetStatusColorTypes=void 0,W.isPresetColor=he,W.isPresetStatusColor=se;var X=ee(D(861)),E=D(36496);const _e=E.PresetColors.map(Se=>`${Se}-inverse`),re=W.PresetStatusColorTypes=["success","processing","error","default","warning"];function he(Se){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat((0,X.default)(_e),(0,X.default)(E.PresetColors)).includes(Se):E.PresetColors.includes(Se)}function se(Se){return re.includes(Se)}},49314:function($t,W,D){"use strict";"use client";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=ee(D(43273));const _e=he=>{let se;return typeof he=="object"&&(he!=null&&he.clearIcon)?se=he:he&&(se={clearIcon:X.default.createElement(E.default,null)}),se};var re=W.default=_e},56333:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.containerBaseZIndexOffset=W.consumerBaseZIndexOffset=W.CONTAINER_MAX_OFFSET=void 0,W.useZIndex=ve;var X=ee(D(67294)),E=ee(D(41401)),_e=D(13594),re=ee(D(96877));const he=100,se=10,Se=W.CONTAINER_MAX_OFFSET=he*se,oe=W.containerBaseZIndexOffset={Modal:he,Drawer:he,Popover:he,Popconfirm:he,Tooltip:he,Tour:he},je=W.consumerBaseZIndexOffset={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function te(Be){return Be in oe}function ve(Be,Te){const[,we]=(0,E.default)(),le=X.default.useContext(re.default),Ze=te(Be);let xt;if(Te!==void 0)xt=[Te,Te];else{let ft=le!=null?le:0;Ze?ft+=(le?0:we.zIndexPopupBase)+oe[Be]:ft+=je[Be],xt=[le===void 0?Te:ft,ft]}return xt}},53683:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getTransitionName=W.default=void 0;var ee=D(31929);const X=()=>({height:0,opacity:0}),E=je=>{const{scrollHeight:te}=je;return{height:te,opacity:1}},_e=je=>({height:je?je.offsetHeight:0}),re=(je,te)=>(te==null?void 0:te.deadline)===!0||te.propertyName==="height",he=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:ee.defaultPrefixCls}-motion-collapse`,onAppearStart:X,onEnterStart:X,onAppearActive:E,onEnterActive:E,onLeaveStart:_e,onLeaveActive:X,onAppearEnd:re,onEnterEnd:re,onLeaveEnd:re,motionDeadline:500}},se=null,Se=(je,te,ve)=>ve!==void 0?ve:`${je}-${te}`;W.getTransitionName=Se;var oe=W.default=he},74132:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=he,W.getOverflowOptions=X;var ee=D(9064);function X(se,Se,oe,je){if(je===!1)return{adjustX:!1,adjustY:!1};const te=je&&typeof je=="object"?je:{},ve={};switch(se){case"top":case"bottom":ve.shiftX=Se.arrowOffsetHorizontal*2+oe,ve.shiftY=!0,ve.adjustY=!0;break;case"left":case"right":ve.shiftY=Se.arrowOffsetVertical*2+oe,ve.shiftX=!0,ve.adjustX=!0;break}const Be=Object.assign(Object.assign({},ve),te);return Be.shiftX||(Be.adjustX=!0),Be.shiftY||(Be.adjustY=!0),Be}const E={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},_e={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},re=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function he(se){const{arrowWidth:Se,autoAdjustOverflow:oe,arrowPointAtCenter:je,offset:te,borderRadius:ve,visibleFirst:Be}=se,Te=Se/2,we={};return Object.keys(E).forEach(le=>{const Ze=je&&_e[le]||E[le],xt=Object.assign(Object.assign({},Ze),{offset:[0,0],dynamicInset:!0});switch(we[le]=xt,re.has(le)&&(xt.autoArrow=!1),le){case"top":case"topLeft":case"topRight":xt.offset[1]=-Te-te;break;case"bottom":case"bottomLeft":case"bottomRight":xt.offset[1]=Te+te;break;case"left":case"leftTop":case"leftBottom":xt.offset[0]=-Te-te;break;case"right":case"rightTop":case"rightBottom":xt.offset[0]=Te+te;break}const ft=(0,ee.getArrowOffsetToken)({contentRadius:ve,limitVerticalRadius:!0});if(je)switch(le){case"topLeft":case"bottomLeft":xt.offset[0]=-ft.arrowOffsetHorizontal-Te;break;case"topRight":case"bottomRight":xt.offset[0]=ft.arrowOffsetHorizontal+Te;break;case"leftTop":case"rightTop":xt.offset[1]=-ft.arrowOffsetHorizontal-Te;break;case"leftBottom":case"rightBottom":xt.offset[1]=ft.arrowOffsetHorizontal+Te;break}xt.overflow=X(le,ft,Se,oe),Be&&(xt.htmlRegion="visibleFirst")}),we}},47419:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.cloneElement=re,W.isFragment=E,W.replaceElement=void 0;var X=ee(D(67294));function E(he){return he&&X.default.isValidElement(he)&&he.type===X.default.Fragment}const _e=(he,se,Se)=>X.default.isValidElement(he)?X.default.cloneElement(he,typeof Se=="function"?Se(he.props||{}):Se):se;W.replaceElement=_e;function re(he,se){return _e(he,he,se)}},71434:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.getMergedStatus=void 0,W.getStatusClassNames=_e;var X=ee(D(93967));const E=null;function _e(he,se,Se){return(0,X.default)({[`${he}-status-success`]:se==="success",[`${he}-status-warning`]:se==="warning",[`${he}-status-error`]:se==="error",[`${he}-status-validating`]:se==="validating",[`${he}-has-feedback`]:Se})}const re=(he,se)=>se||he;W.getMergedStatus=re},38882:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.canUseDocElement=void 0,Object.defineProperty(W,"isStyleSupport",{enumerable:!0,get:function(){return E.isStyleSupport}});var X=ee(D(19158)),E=D(3481);const _e=()=>(0,X.default)()&&window.document.documentElement;W.canUseDocElement=_e},60938:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(27712)),re=function(oe,je){var te={};for(var ve in oe)Object.prototype.hasOwnProperty.call(oe,ve)&&je.indexOf(ve)<0&&(te[ve]=oe[ve]);if(oe!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Be=0,ve=Object.getOwnPropertySymbols(oe);Be<ve.length;Be++)je.indexOf(ve[Be])<0&&Object.prototype.propertyIsEnumerable.call(oe,ve[Be])&&(te[ve[Be]]=oe[ve[Be]]);return te};const he={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-flex"},se=E.forwardRef((oe,je)=>{const te=ft=>{const{keyCode:Zt}=ft;Zt===_e.default.ENTER&&ft.preventDefault()},ve=ft=>{const{keyCode:Zt}=ft,{onClick:pt}=oe;Zt===_e.default.ENTER&&pt&&pt()},{style:Be,noStyle:Te,disabled:we,tabIndex:le=0}=oe,Ze=re(oe,["style","noStyle","disabled","tabIndex"]);let xt={};return Te||(xt=Object.assign({},he)),we&&(xt.pointerEvents="none"),xt=Object.assign(Object.assign({},xt),Be),E.createElement("div",Object.assign({role:"button",tabIndex:le,ref:je},Ze,{onKeyDown:te,onKeyUp:ve,style:xt}))});var Se=W.default=se},13594:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.devUseWarning=W.default=W.WarningContext=void 0,W.noop=_e,W.resetWarned=he;var X=ee(D(67294)),E=ee(D(45520));function _e(){}let re=null;function he(){re=null,(0,E.resetWarned)()}let se=_e;const Se=W.WarningContext=X.createContext({}),oe=W.devUseWarning=()=>{const te=()=>{};return te.deprecated=_e,te};var je=W.default=se},96877:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294));const E=X.default.createContext(void 0);var _e=W.default=E},93319:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=W.DisabledContextProvider=void 0;var X=ee(D(67294));const E=X.createContext(!1),_e=he=>{let{children:se,disabled:Se}=he;const oe=X.useContext(E);return X.createElement(E.Provider,{value:Se!=null?Se:oe},se)};W.DisabledContextProvider=_e;var re=W.default=E},16722:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=re;var X=ee(D(67294)),E=D(29372),_e=D(3184);function re(he){const{children:se}=he,[,Se]=(0,_e.useToken)(),{motion:oe}=Se,je=X.useRef(!1);return je.current=je.current||oe===!1,je.current?X.createElement(E.Provider,{motion:oe},se):se}},11380:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=D(13594);const _e=null;var re=W.default=()=>null},3236:function($t,W,D){"use strict";"use client";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=W.SizeContextProvider=void 0;var X=ee(D(67294));const E=X.createContext(void 0),_e=he=>{let{children:se,size:Se}=he;const oe=X.useContext(E);return X.createElement(E.Provider,{value:Se||oe},se)};W.SizeContextProvider=_e;var re=W.default=E},7177:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.defaultPrefixCls=W.defaultIconPrefixCls=W.Variants=W.ConfigContext=W.ConfigConsumer=void 0;var X=ee(D(67294));const E=W.defaultPrefixCls="ant",_e=W.defaultIconPrefixCls="anticon",re=W.Variants=["outlined","borderless","filled"],he=(oe,je)=>je||(oe?`${E}-${oe}`:E),se=W.ConfigContext=X.createContext({getPrefixCls:he,iconPrefixCls:_e}),{Consumer:Se}=se;W.ConfigConsumer=Se},56301:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.getStyle=Se,W.registerTheme=oe;var X=D(65409),E=D(131),_e=ee(D(19158)),re=D(93399),he=ee(D(13594));const se=`-ant-${Date.now()}-${Math.random()}`;function Se(je,te){const ve={},Be=(le,Ze)=>{let xt=le.clone();return xt=(Ze==null?void 0:Ze(xt))||xt,xt.toRgbString()},Te=(le,Ze)=>{const xt=new E.TinyColor(le),ft=(0,X.generate)(xt.toRgbString());ve[`${Ze}-color`]=Be(xt),ve[`${Ze}-color-disabled`]=ft[1],ve[`${Ze}-color-hover`]=ft[4],ve[`${Ze}-color-active`]=ft[6],ve[`${Ze}-color-outline`]=xt.clone().setAlpha(.2).toRgbString(),ve[`${Ze}-color-deprecated-bg`]=ft[0],ve[`${Ze}-color-deprecated-border`]=ft[2]};if(te.primaryColor){Te(te.primaryColor,"primary");const le=new E.TinyColor(te.primaryColor),Ze=(0,X.generate)(le.toRgbString());Ze.forEach((ft,Zt)=>{ve[`primary-${Zt+1}`]=ft}),ve["primary-color-deprecated-l-35"]=Be(le,ft=>ft.lighten(35)),ve["primary-color-deprecated-l-20"]=Be(le,ft=>ft.lighten(20)),ve["primary-color-deprecated-t-20"]=Be(le,ft=>ft.tint(20)),ve["primary-color-deprecated-t-50"]=Be(le,ft=>ft.tint(50)),ve["primary-color-deprecated-f-12"]=Be(le,ft=>ft.setAlpha(ft.getAlpha()*.12));const xt=new E.TinyColor(Ze[0]);ve["primary-color-active-deprecated-f-30"]=Be(xt,ft=>ft.setAlpha(ft.getAlpha()*.3)),ve["primary-color-active-deprecated-d-02"]=Be(xt,ft=>ft.darken(2))}return te.successColor&&Te(te.successColor,"success"),te.warningColor&&Te(te.warningColor,"warning"),te.errorColor&&Te(te.errorColor,"error"),te.infoColor&&Te(te.infoColor,"info"),`
  :root {
    ${Object.keys(ve).map(le=>`--${je}-${le}: ${ve[le]};`).join(`
`)}
  }
  `.trim()}function oe(je,te){const ve=Se(je,te);(0,_e.default)()&&(0,re.updateCSS)(ve,`${se}-dynamic-theme`)}},14893:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(3184);const X=_e=>{const[,,,,re]=(0,ee.useToken)();return re?`${_e}-css-var`:""};var E=W.default=X},5819:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=D(67294),E=ee(D(93319)),_e=ee(D(3236));function re(){const se=(0,X.useContext)(E.default),Se=(0,X.useContext)(_e.default);return{componentDisabled:se,componentSize:Se}}var he=W.default=re},65693:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294)),E=ee(D(3236));const _e=he=>{const se=X.default.useContext(E.default);return X.default.useMemo(()=>he?typeof he=="string"?he!=null?he:se:he instanceof Function?he(se):se:se,[he,se])};var re=W.default=_e},25494:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=se;var X=ee(D(67265)),E=ee(D(11102)),_e=D(13594),re=D(3184),he=ee(D(78459));function se(Se,oe,je){var te,ve;const Be=(0,_e.devUseWarning)("ConfigProvider"),Te=Se||{},we=Te.inherit===!1||!oe?Object.assign(Object.assign({},re.defaultConfig),{hashed:(te=oe==null?void 0:oe.hashed)!==null&&te!==void 0?te:re.defaultConfig.hashed,cssVar:oe==null?void 0:oe.cssVar}):oe,le=(0,he.default)();return(0,X.default)(()=>{var Ze,xt;if(!Se)return oe;const ft=Object.assign({},we.components);Object.keys(Se.components||{}).forEach(vt=>{ft[vt]=Object.assign(Object.assign({},ft[vt]),Se.components[vt])});const Zt=`css-var-${le.replace(/:/g,"")}`,pt=((Ze=Te.cssVar)!==null&&Ze!==void 0?Ze:we.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:je==null?void 0:je.prefixCls},typeof we.cssVar=="object"?we.cssVar:{}),typeof Te.cssVar=="object"?Te.cssVar:{}),{key:typeof Te.cssVar=="object"&&((xt=Te.cssVar)===null||xt===void 0?void 0:xt.key)||Zt});return Object.assign(Object.assign(Object.assign({},we),Te),{token:Object.assign(Object.assign({},we.token),Te.token),components:ft,cssVar:pt})},[Te,we],(Ze,xt)=>Ze.some((ft,Zt)=>{const pt=xt[Zt];return!(0,E.default)(ft,pt,!0)}))}},78459:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294));const E=Object.assign({},X),{useId:_e}=E,he=typeof _e=="undefined"?()=>"":_e;var se=W.default=he},31929:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"ConfigConsumer",{enumerable:!0,get:function(){return we.ConfigConsumer}}),Object.defineProperty(W,"ConfigContext",{enumerable:!0,get:function(){return we.ConfigContext}}),Object.defineProperty(W,"Variants",{enumerable:!0,get:function(){return we.Variants}}),W.default=W.configConsumerProps=void 0,Object.defineProperty(W,"defaultIconPrefixCls",{enumerable:!0,get:function(){return we.defaultIconPrefixCls}}),Object.defineProperty(W,"defaultPrefixCls",{enumerable:!0,get:function(){return we.defaultPrefixCls}}),W.warnContext=W.globalConfig=void 0;var E=X(D(67294)),_e=D(85088),re=ee(D(13357)),he=ee(D(67265)),se=D(20059),Se=X(D(13594)),oe=ee(D(2197)),je=X(D(64050)),te=ee(D(44805)),ve=ee(D(18253)),Be=D(89329),Te=ee(D(98411)),we=D(7177),le=D(56301),Ze=D(93319),xt=ee(D(5819)),ft=ee(D(25494)),Zt=ee(D(16722)),pt=ee(D(11380)),vt=X(D(3236)),ke=ee(D(82932)),Re=function(jn,lr){var Vt={};for(var en in jn)Object.prototype.hasOwnProperty.call(jn,en)&&lr.indexOf(en)<0&&(Vt[en]=jn[en]);if(jn!=null&&typeof Object.getOwnPropertySymbols=="function")for(var xn=0,en=Object.getOwnPropertySymbols(jn);xn<en.length;xn++)lr.indexOf(en[xn])<0&&Object.prototype.propertyIsEnumerable.call(jn,en[xn])&&(Vt[en[xn]]=jn[en[xn]]);return Vt};let bt=!1;const gt=W.warnContext=null,Ct=W.configConsumerProps=["getTargetContainer","getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale"],Sn=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let He,Ot,Ce,ot;function $e(){return He||we.defaultPrefixCls}function Xe(){return Ot||we.defaultIconPrefixCls}function Rt(jn){return Object.keys(jn).some(lr=>lr.endsWith("Color"))}const _t=jn=>{const{prefixCls:lr,iconPrefixCls:Vt,theme:en,holderRender:xn}=jn;lr!==void 0&&(He=lr),Vt!==void 0&&(Ot=Vt),"holderRender"in jn&&(ot=xn),en&&(Rt(en)?(0,le.registerTheme)($e(),en):Ce=en)},Pe=()=>({getPrefixCls:(jn,lr)=>lr||(jn?`${$e()}-${jn}`:$e()),getIconPrefixCls:Xe,getRootPrefixCls:()=>He||$e(),getTheme:()=>Ce,holderRender:ot});W.globalConfig=Pe;const Wt=jn=>{const{children:lr,csp:Vt,autoInsertSpaceInButton:en,alert:xn,anchor:er,form:sn,locale:Ut,componentSize:Dt,direction:Me,space:Qe,virtual:Ft,dropdownMatchSelectWidth:U,popupMatchSelectWidth:ue,popupOverflow:at,legacyLocale:ce,parentContext:j,iconPrefixCls:ln,theme:fn,componentDisabled:mt,segmented:Gt,statistic:Wn,spin:hn,calendar:ht,carousel:Ht,cascader:Cn,collapse:Ln,typography:Gn,checkbox:dt,descriptions:ye,divider:Fe,drawer:nt,skeleton:Pt,steps:Mt,image:Tn,layout:$n,list:xr,mentions:qn,modal:Ae,progress:be,result:Ne,slider:et,breadcrumb:wt,menu:qt,pagination:vn,input:yt,textArea:Jt,empty:Qn,badge:Er,radio:Vr,rate:mr,switch:kr,transfer:Ei,avatar:Oi,message:ar,tag:Kr,table:hi,card:Qr,tabs:Io,timeline:Ii,timePicker:Fo,upload:_a,notification:Co,tree:Qo,colorPicker:De,datePicker:Je,rangePicker:kt,flex:un,wave:Bn,dropdown:kn,warning:pn,tour:On,floatButtonGroup:vr,variant:fr,inputNumber:ci,treeSelect:Gi}=jn,no=E.useCallback((Ga,Jo)=>{const{prefixCls:Wo}=jn;if(Jo)return Jo;const Ha=Wo||j.getPrefixCls("");return Ga?`${Ha}-${Ga}`:Ha},[j.getPrefixCls,jn.prefixCls]),Jr=ln||j.iconPrefixCls||we.defaultIconPrefixCls,ji=Vt||j.csp;(0,ke.default)(Jr,ji);const Di=(0,ft.default)(fn,j.theme,{prefixCls:no("")}),Gr={csp:ji,autoInsertSpaceInButton:en,alert:xn,anchor:er,locale:Ut||ce,direction:Me,space:Qe,virtual:Ft,popupMatchSelectWidth:ue!=null?ue:U,popupOverflow:at,getPrefixCls:no,iconPrefixCls:Jr,theme:Di,segmented:Gt,statistic:Wn,spin:hn,calendar:ht,carousel:Ht,cascader:Cn,collapse:Ln,typography:Gn,checkbox:dt,descriptions:ye,divider:Fe,drawer:nt,skeleton:Pt,steps:Mt,image:Tn,input:yt,textArea:Jt,layout:$n,list:xr,mentions:qn,modal:Ae,progress:be,result:Ne,slider:et,breadcrumb:wt,menu:qt,pagination:vn,empty:Qn,badge:Er,radio:Vr,rate:mr,switch:kr,transfer:Ei,avatar:Oi,message:ar,tag:Kr,table:hi,card:Qr,tabs:Io,timeline:Ii,timePicker:Fo,upload:_a,notification:Co,tree:Qo,colorPicker:De,datePicker:Je,rangePicker:kt,flex:un,wave:Bn,dropdown:kn,warning:pn,tour:On,floatButtonGroup:vr,variant:fr,inputNumber:ci,treeSelect:Gi},fo=Object.assign({},j);Object.keys(Gr).forEach(Ga=>{Gr[Ga]!==void 0&&(fo[Ga]=Gr[Ga])}),Sn.forEach(Ga=>{const Jo=jn[Ga];Jo&&(fo[Ga]=Jo)}),typeof en!="undefined"&&(fo.button=Object.assign({autoInsertSpace:en},fo.button));const Ri=(0,he.default)(()=>fo,fo,(Ga,Jo)=>{const Wo=Object.keys(Ga),Ha=Object.keys(Jo);return Wo.length!==Ha.length||Wo.some(ds=>Ga[ds]!==Jo[ds])}),bo=E.useMemo(()=>({prefixCls:Jr,csp:ji}),[Jr,ji]);let xi=E.createElement(E.Fragment,null,E.createElement(pt.default,{dropdownMatchSelectWidth:U}),lr);const wo=E.useMemo(()=>{var Ga,Jo,Wo,Ha;return(0,se.merge)(((Ga=ve.default.Form)===null||Ga===void 0?void 0:Ga.defaultValidateMessages)||{},((Wo=(Jo=Ri.locale)===null||Jo===void 0?void 0:Jo.Form)===null||Wo===void 0?void 0:Wo.defaultValidateMessages)||{},((Ha=Ri.form)===null||Ha===void 0?void 0:Ha.validateMessages)||{},(sn==null?void 0:sn.validateMessages)||{})},[Ri,sn==null?void 0:sn.validateMessages]);Object.keys(wo).length>0&&(xi=E.createElement(oe.default.Provider,{value:wo},xi)),Ut&&(xi=E.createElement(je.default,{locale:Ut,_ANT_MARK__:je.ANT_MARK},xi)),(Jr||ji)&&(xi=E.createElement(re.default.Provider,{value:bo},xi)),Dt&&(xi=E.createElement(vt.SizeContextProvider,{size:Dt},xi)),xi=E.createElement(Zt.default,null,xi);const ia=E.useMemo(()=>{const Ga=Di||{},{algorithm:Jo,token:Wo,components:Ha,cssVar:ds}=Ga,Tt=Re(Ga,["algorithm","token","components","cssVar"]),Yt=Jo&&(!Array.isArray(Jo)||Jo.length>0)?(0,_e.createTheme)(Jo):Be.defaultTheme,Fn={};Object.entries(Ha||{}).forEach(ai=>{let[Xr,Uo]=ai;const Xo=Object.assign({},Uo);"algorithm"in Xo&&(Xo.algorithm===!0?Xo.theme=Yt:(Array.isArray(Xo.algorithm)||typeof Xo.algorithm=="function")&&(Xo.theme=(0,_e.createTheme)(Xo.algorithm)),delete Xo.algorithm),Fn[Xr]=Xo});const dr=Object.assign(Object.assign({},Te.default),Wo);return Object.assign(Object.assign({},Tt),{theme:Yt,token:dr,components:Fn,override:Object.assign({override:dr},Fn),cssVar:ds})},[Di]);return fn&&(xi=E.createElement(Be.DesignTokenContext.Provider,{value:ia},xi)),Ri.warning&&(xi=E.createElement(Se.WarningContext.Provider,{value:Ri.warning},xi)),mt!==void 0&&(xi=E.createElement(Ze.DisabledContextProvider,{disabled:mt},xi)),E.createElement(we.ConfigContext.Provider,{value:Ri},xi)},on=jn=>{const lr=E.useContext(we.ConfigContext),Vt=E.useContext(te.default);return E.createElement(Wt,Object.assign({parentContext:lr,legacyLocale:Vt},jn))};on.ConfigContext=we.ConfigContext,on.SizeContext=vt.default,on.config=_t,on.useConfig=xt.default,Object.defineProperty(on,"SizeContext",{get:()=>vt.default});var Nn=W.default=on},82932:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"default",{enumerable:!0,get:function(){return ee.useResetIconStyle}});var ee=D(3184)},51130:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.VariantContext=W.NoStyleItemContext=W.NoFormStyle=W.FormProvider=W.FormItemPrefixContext=W.FormItemInputContext=W.FormContext=void 0;var E=X(D(67294)),_e=E,re=D(88692),he=ee(D(18475));const se=W.FormContext=_e.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),Se=W.NoStyleItemContext=_e.createContext(null),oe=Te=>{const we=(0,he.default)(Te,["prefixCls"]);return _e.createElement(re.FormProvider,Object.assign({},we))};W.FormProvider=oe;const je=W.FormItemPrefixContext=_e.createContext({prefixCls:""}),te=W.FormItemInputContext=_e.createContext({}),ve=Te=>{let{children:we,status:le,override:Ze}=Te;const xt=(0,E.useContext)(te),ft=(0,E.useMemo)(()=>{const Zt=Object.assign({},xt);return Ze&&delete Zt.isFormItemInput,le&&(delete Zt.status,delete Zt.hasFeedback,delete Zt.feedbackIcon),Zt},[le,Ze,xt]);return _e.createElement(te.Provider,{value:ft},we)};W.NoFormStyle=ve;const Be=W.VariantContext=(0,E.createContext)(void 0)},96424:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294),X=D(51130),E=D(31929);const _e=function(he,se){let Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;var oe,je;const{variant:te,[he]:ve}=(0,ee.useContext)(E.ConfigContext),Be=(0,ee.useContext)(X.VariantContext),Te=ve==null?void 0:ve.variant;let we;typeof se!="undefined"?we=se:Se===!1?we="borderless":we=(je=(oe=Be!=null?Be:Te)!==null&&oe!==void 0?oe:te)!==null&&je!==void 0?je:"outlined";const le=E.Variants.includes(we);return[we,le]};var re=W.default=_e},2197:function($t,W,D){"use strict";"use client";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294),X=W.default=(0,ee.createContext)(void 0)},10815:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0,W.triggerFocus=vt;var E=X(D(67294)),_e=ee(D(93967)),re=ee(D(67656)),he=D(75531),se=ee(D(85549)),Se=ee(D(49314)),oe=D(71434),je=D(13594),te=D(31929),ve=ee(D(93319)),Be=ee(D(14893)),Te=ee(D(65693)),we=D(51130),le=ee(D(96424)),Ze=D(46549),xt=ee(D(81722)),ft=ee(D(89858)),Zt=D(36714),pt=function(bt,gt){var Ct={};for(var Sn in bt)Object.prototype.hasOwnProperty.call(bt,Sn)&&gt.indexOf(Sn)<0&&(Ct[Sn]=bt[Sn]);if(bt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var He=0,Sn=Object.getOwnPropertySymbols(bt);He<Sn.length;He++)gt.indexOf(Sn[He])<0&&Object.prototype.propertyIsEnumerable.call(bt,Sn[He])&&(Ct[Sn[He]]=bt[Sn[He]]);return Ct};function vt(bt,gt){if(!bt)return;bt.focus(gt);const{cursor:Ct}=gt||{};if(Ct){const Sn=bt.value.length;switch(Ct){case"start":bt.setSelectionRange(0,0);break;case"end":bt.setSelectionRange(Sn,Sn);break;default:bt.setSelectionRange(0,Sn)}}}const ke=(0,E.forwardRef)((bt,gt)=>{var Ct;const{prefixCls:Sn,bordered:He=!0,status:Ot,size:Ce,disabled:ot,onBlur:$e,onFocus:Xe,suffix:Rt,allowClear:_t,addonAfter:Pe,addonBefore:Wt,className:on,style:Nn,styles:jn,rootClassName:lr,onChange:Vt,classNames:en,variant:xn}=bt,er=pt(bt,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:sn,direction:Ut,input:Dt}=E.default.useContext(te.ConfigContext),Me=sn("input",Sn),Qe=(0,E.useRef)(null),Ft=(0,Be.default)(Me),[U,ue,at]=(0,ft.default)(Me,Ft),{compactSize:ce,compactItemClassnames:j}=(0,Ze.useCompactItemContext)(Me,Ut),ln=(0,Te.default)(Tn=>{var $n;return($n=Ce!=null?Ce:ce)!==null&&$n!==void 0?$n:Tn}),fn=E.default.useContext(ve.default),mt=ot!=null?ot:fn,{status:Gt,hasFeedback:Wn,feedbackIcon:hn}=(0,E.useContext)(we.FormItemInputContext),ht=(0,oe.getMergedStatus)(Gt,Ot),Ht=(0,Zt.hasPrefixSuffix)(bt)||!!Wn,Cn=(0,E.useRef)(Ht),Ln=(0,xt.default)(Qe,!0),Gn=Tn=>{Ln(),$e==null||$e(Tn)},dt=Tn=>{Ln(),Xe==null||Xe(Tn)},ye=Tn=>{Ln(),Vt==null||Vt(Tn)},Fe=(Wn||Rt)&&E.default.createElement(E.default.Fragment,null,Rt,Wn&&hn),nt=(0,Se.default)(_t!=null?_t:Dt==null?void 0:Dt.allowClear),[Pt,Mt]=(0,le.default)("input",xn,He);return U(E.default.createElement(re.default,Object.assign({ref:(0,he.composeRef)(gt,Qe),prefixCls:Me,autoComplete:Dt==null?void 0:Dt.autoComplete},er,{disabled:mt,onBlur:Gn,onFocus:dt,style:Object.assign(Object.assign({},Dt==null?void 0:Dt.style),Nn),styles:Object.assign(Object.assign({},Dt==null?void 0:Dt.styles),jn),suffix:Fe,allowClear:nt,className:(0,_e.default)(on,lr,at,Ft,j,Dt==null?void 0:Dt.className),onChange:ye,addonBefore:Wt&&E.default.createElement(se.default,{form:!0,space:!0},Wt),addonAfter:Pe&&E.default.createElement(se.default,{form:!0,space:!0},Pe),classNames:Object.assign(Object.assign(Object.assign({},en),Dt==null?void 0:Dt.classNames),{input:(0,_e.default)({[`${Me}-sm`]:ln==="small",[`${Me}-lg`]:ln==="large",[`${Me}-rtl`]:Ut==="rtl"},en==null?void 0:en.input,(Ct=Dt==null?void 0:Dt.classNames)===null||Ct===void 0?void 0:Ct.input,ue),variant:(0,_e.default)({[`${Me}-${Pt}`]:Mt},(0,oe.getStatusClassNames)(Me,ht)),affixWrapper:(0,_e.default)({[`${Me}-affix-wrapper-sm`]:ln==="small",[`${Me}-affix-wrapper-lg`]:ln==="large",[`${Me}-affix-wrapper-rtl`]:Ut==="rtl"},ue),wrapper:(0,_e.default)({[`${Me}-group-rtl`]:Ut==="rtl"},ue),groupWrapper:(0,_e.default)({[`${Me}-group-wrapper-sm`]:ln==="small",[`${Me}-group-wrapper-lg`]:ln==="large",[`${Me}-group-wrapper-rtl`]:Ut==="rtl",[`${Me}-group-wrapper-${Pt}`]:Mt},(0,oe.getStatusClassNames)(`${Me}-group-wrapper`,ht,Wn),ue)})})))});var Re=W.default=ke},14104:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=E,re=ee(D(93967)),he=ee(D(43961)),se=ee(D(49314)),Se=D(71434),oe=D(13594),je=D(31929),te=ee(D(93319)),ve=ee(D(14893)),Be=ee(D(65693)),Te=D(51130),we=ee(D(96424)),le=D(10815),Ze=ee(D(89858)),xt=function(pt,vt){var ke={};for(var Re in pt)Object.prototype.hasOwnProperty.call(pt,Re)&&vt.indexOf(Re)<0&&(ke[Re]=pt[Re]);if(pt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var bt=0,Re=Object.getOwnPropertySymbols(pt);bt<Re.length;bt++)vt.indexOf(Re[bt])<0&&Object.prototype.propertyIsEnumerable.call(pt,Re[bt])&&(ke[Re[bt]]=pt[Re[bt]]);return ke};const ft=(0,E.forwardRef)((pt,vt)=>{var ke,Re;const{prefixCls:bt,bordered:gt=!0,size:Ct,disabled:Sn,status:He,allowClear:Ot,classNames:Ce,rootClassName:ot,className:$e,style:Xe,styles:Rt,variant:_t}=pt,Pe=xt(pt,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant"]),{getPrefixCls:Wt,direction:on,textArea:Nn}=_e.useContext(je.ConfigContext),jn=(0,Be.default)(Ct),lr=_e.useContext(te.default),Vt=Sn!=null?Sn:lr,{status:en,hasFeedback:xn,feedbackIcon:er}=_e.useContext(Te.FormItemInputContext),sn=(0,Se.getMergedStatus)(en,He),Ut=_e.useRef(null);_e.useImperativeHandle(vt,()=>{var j;return{resizableTextArea:(j=Ut.current)===null||j===void 0?void 0:j.resizableTextArea,focus:ln=>{var fn,mt;(0,le.triggerFocus)((mt=(fn=Ut.current)===null||fn===void 0?void 0:fn.resizableTextArea)===null||mt===void 0?void 0:mt.textArea,ln)},blur:()=>{var ln;return(ln=Ut.current)===null||ln===void 0?void 0:ln.blur()}}});const Dt=Wt("input",bt),Me=(0,ve.default)(Dt),[Qe,Ft,U]=(0,Ze.default)(Dt,Me),[ue,at]=(0,we.default)("textArea",_t,gt),ce=(0,se.default)(Ot!=null?Ot:Nn==null?void 0:Nn.allowClear);return Qe(_e.createElement(he.default,Object.assign({autoComplete:Nn==null?void 0:Nn.autoComplete},Pe,{style:Object.assign(Object.assign({},Nn==null?void 0:Nn.style),Xe),styles:Object.assign(Object.assign({},Nn==null?void 0:Nn.styles),Rt),disabled:Vt,allowClear:ce,className:(0,re.default)(U,Me,$e,ot,Nn==null?void 0:Nn.className),classNames:Object.assign(Object.assign(Object.assign({},Ce),Nn==null?void 0:Nn.classNames),{textarea:(0,re.default)({[`${Dt}-sm`]:jn==="small",[`${Dt}-lg`]:jn==="large"},Ft,Ce==null?void 0:Ce.textarea,(ke=Nn==null?void 0:Nn.classNames)===null||ke===void 0?void 0:ke.textarea),variant:(0,re.default)({[`${Dt}-${ue}`]:at},(0,Se.getStatusClassNames)(Dt,sn)),affixWrapper:(0,re.default)(`${Dt}-textarea-affix-wrapper`,{[`${Dt}-affix-wrapper-rtl`]:on==="rtl",[`${Dt}-affix-wrapper-sm`]:jn==="small",[`${Dt}-affix-wrapper-lg`]:jn==="large",[`${Dt}-textarea-show-count`]:pt.showCount||((Re=pt.count)===null||Re===void 0?void 0:Re.show)},Ft)}),prefixCls:Dt,suffix:xn&&_e.createElement("span",{className:`${Dt}-textarea-suffix`},er),ref:Ut})))});var Zt=W.default=ft},81722:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=X;var ee=D(67294);function X(E,_e){const re=(0,ee.useRef)([]),he=()=>{re.current.push(setTimeout(()=>{var se,Se,oe,je;!((se=E.current)===null||se===void 0)&&se.input&&((Se=E.current)===null||Se===void 0?void 0:Se.input.getAttribute("type"))==="password"&&(!((oe=E.current)===null||oe===void 0)&&oe.input.hasAttribute("value"))&&((je=E.current)===null||je===void 0||je.input.removeAttribute("value"))}))};return(0,ee.useEffect)(()=>(_e&&he(),()=>re.current.forEach(se=>{se&&clearTimeout(se)})),[]),he}},89858:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genPlaceholderStyle=W.genInputSmallStyle=W.genInputGroupStyle=W.genBasicInputStyle=W.genActiveStyle=W.default=void 0,Object.defineProperty(W,"initComponentToken",{enumerable:!0,get:function(){return re.initComponentToken}}),Object.defineProperty(W,"initInputToken",{enumerable:!0,get:function(){return re.initInputToken}});var ee=D(85088),X=D(98078),E=D(78793),_e=D(3184),re=D(25735),he=D(58594);const se=pt=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:pt,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}});W.genPlaceholderStyle=se;const Se=pt=>({borderColor:pt.activeBorderColor,boxShadow:pt.activeShadow,outline:0,backgroundColor:pt.activeBg});W.genActiveStyle=Se;const oe=pt=>{const{paddingBlockLG:vt,lineHeightLG:ke,borderRadiusLG:Re,paddingInlineLG:bt}=pt;return{padding:`${(0,ee.unit)(vt)} ${(0,ee.unit)(bt)}`,fontSize:pt.inputFontSizeLG,lineHeight:ke,borderRadius:Re}},je=pt=>({padding:`${(0,ee.unit)(pt.paddingBlockSM)} ${(0,ee.unit)(pt.paddingInlineSM)}`,fontSize:pt.inputFontSizeSM,borderRadius:pt.borderRadiusSM});W.genInputSmallStyle=je;const te=pt=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${(0,ee.unit)(pt.paddingBlock)} ${(0,ee.unit)(pt.paddingInline)}`,color:pt.colorText,fontSize:pt.inputFontSize,lineHeight:pt.lineHeight,borderRadius:pt.borderRadius,transition:`all ${pt.motionDurationMid}`},se(pt.colorTextPlaceholder)),{"textarea&":{maxWidth:"100%",height:"auto",minHeight:pt.controlHeight,lineHeight:pt.lineHeight,verticalAlign:"bottom",transition:`all ${pt.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},oe(pt)),"&-sm":Object.assign({},je(pt)),"&-rtl, &-textarea-rtl":{direction:"rtl"}});W.genBasicInputStyle=te;const ve=pt=>{const{componentCls:vt,antCls:ke}=pt;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:pt.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${vt}, &-lg > ${vt}-group-addon`]:Object.assign({},oe(pt)),[`&-sm ${vt}, &-sm > ${vt}-group-addon`]:Object.assign({},je(pt)),[`&-lg ${ke}-select-single ${ke}-select-selector`]:{height:pt.controlHeightLG},[`&-sm ${ke}-select-single ${ke}-select-selector`]:{height:pt.controlHeightSM},[`> ${vt}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${vt}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${(0,ee.unit)(pt.paddingInline)}`,color:pt.colorText,fontWeight:"normal",fontSize:pt.inputFontSize,textAlign:"center",borderRadius:pt.borderRadius,transition:`all ${pt.motionDurationSlow}`,lineHeight:1,[`${ke}-select`]:{margin:`${(0,ee.unit)(pt.calc(pt.paddingBlock).add(1).mul(-1).equal())} ${(0,ee.unit)(pt.calc(pt.paddingInline).mul(-1).equal())}`,[`&${ke}-select-single:not(${ke}-select-customize-input):not(${ke}-pagination-size-changer)`]:{[`${ke}-select-selector`]:{backgroundColor:"inherit",border:`${(0,ee.unit)(pt.lineWidth)} ${pt.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${ke}-select-selector`]:{color:pt.colorPrimary}}},[`${ke}-cascader-picker`]:{margin:`-9px ${(0,ee.unit)(pt.calc(pt.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${ke}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[`${vt}`]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${vt}-search-with-button &`]:{zIndex:0}}},[`> ${vt}:first-child, ${vt}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${ke}-select ${ke}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${vt}-affix-wrapper`]:{[`&:not(:first-child) ${vt}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${vt}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${vt}:last-child, ${vt}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${ke}-select ${ke}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${vt}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${vt}-search &`]:{borderStartStartRadius:pt.borderRadius,borderEndStartRadius:pt.borderRadius}},[`&:not(:first-child), ${vt}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${vt}-group-compact`]:Object.assign(Object.assign({display:"block"},(0,X.clearFix)()),{[`${vt}-group-addon, ${vt}-group-wrap, > ${vt}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:pt.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${vt}-affix-wrapper,
        & > ${vt}-number-affix-wrapper,
        & > ${ke}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:pt.calc(pt.lineWidth).mul(-1).equal(),borderInlineEndWidth:pt.lineWidth},[`${vt}`]:{float:"none"},[`& > ${ke}-select > ${ke}-select-selector,
      & > ${ke}-select-auto-complete ${vt},
      & > ${ke}-cascader-picker ${vt},
      & > ${vt}-group-wrapper ${vt}`]:{borderInlineEndWidth:pt.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${ke}-select-focused`]:{zIndex:1},[`& > ${ke}-select > ${ke}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${ke}-select:first-child > ${ke}-select-selector,
      & > ${ke}-select-auto-complete:first-child ${vt},
      & > ${ke}-cascader-picker:first-child ${vt}`]:{borderStartStartRadius:pt.borderRadius,borderEndStartRadius:pt.borderRadius},[`& > *:last-child,
      & > ${ke}-select:last-child > ${ke}-select-selector,
      & > ${ke}-cascader-picker:last-child ${vt},
      & > ${ke}-cascader-picker-focused:last-child ${vt}`]:{borderInlineEndWidth:pt.lineWidth,borderStartEndRadius:pt.borderRadius,borderEndEndRadius:pt.borderRadius},[`& > ${ke}-select-auto-complete ${vt}`]:{verticalAlign:"top"},[`${vt}-group-wrapper + ${vt}-group-wrapper`]:{marginInlineStart:pt.calc(pt.lineWidth).mul(-1).equal(),[`${vt}-affix-wrapper`]:{borderRadius:0}},[`${vt}-group-wrapper:not(:last-child)`]:{[`&${vt}-search > ${vt}-group`]:{[`& > ${vt}-group-addon > ${vt}-search-button`]:{borderRadius:0},[`& > ${vt}`]:{borderStartStartRadius:pt.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:pt.borderRadius}}}})}};W.genInputGroupStyle=ve;const Be=pt=>{const{componentCls:vt,controlHeightSM:ke,lineWidth:Re,calc:bt}=pt,Ct=bt(ke).sub(bt(Re).mul(2)).sub(16).div(2).equal();return{[vt]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,X.resetComponent)(pt)),te(pt)),(0,he.genOutlinedStyle)(pt)),(0,he.genFilledStyle)(pt)),(0,he.genBorderlessStyle)(pt)),{'&[type="color"]':{height:pt.controlHeight,[`&${vt}-lg`]:{height:pt.controlHeightLG},[`&${vt}-sm`]:{height:ke,paddingTop:Ct,paddingBottom:Ct}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},Te=pt=>{const{componentCls:vt}=pt;return{[`${vt}-clear-icon`]:{margin:0,color:pt.colorTextQuaternary,fontSize:pt.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${pt.motionDurationSlow}`,"&:hover":{color:pt.colorTextTertiary},"&:active":{color:pt.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${(0,ee.unit)(pt.inputAffixPadding)}`}}}},we=pt=>{const{componentCls:vt,inputAffixPadding:ke,colorTextDescription:Re,motionDurationSlow:bt,colorIcon:gt,colorIconHover:Ct,iconCls:Sn}=pt;return{[`${vt}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign({},te(pt)),{display:"inline-flex",[`&:not(${vt}-disabled):hover`]:{zIndex:1,[`${vt}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${vt}`]:{padding:0},[`> input${vt}, > textarea${vt}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${vt}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:pt.paddingXS}},"&-show-count-suffix":{color:Re},"&-show-count-has-suffix":{marginInlineEnd:pt.paddingXXS},"&-prefix":{marginInlineEnd:ke},"&-suffix":{marginInlineStart:ke}}}),Te(pt)),{[`${Sn}${vt}-password-icon`]:{color:gt,cursor:"pointer",transition:`all ${bt}`,"&:hover":{color:Ct}}})}},le=pt=>{const{componentCls:vt,borderRadiusLG:ke,borderRadiusSM:Re}=pt;return{[`${vt}-group`]:Object.assign(Object.assign(Object.assign({},(0,X.resetComponent)(pt)),ve(pt)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${vt}-group-addon`]:{borderRadius:ke,fontSize:pt.inputFontSizeLG}},"&-sm":{[`${vt}-group-addon`]:{borderRadius:Re}}},(0,he.genOutlinedGroupStyle)(pt)),(0,he.genFilledGroupStyle)(pt)),{[`&:not(${vt}-compact-first-item):not(${vt}-compact-last-item)${vt}-compact-item`]:{[`${vt}, ${vt}-group-addon`]:{borderRadius:0}},[`&:not(${vt}-compact-last-item)${vt}-compact-first-item`]:{[`${vt}, ${vt}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${vt}-compact-first-item)${vt}-compact-last-item`]:{[`${vt}, ${vt}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${vt}-compact-last-item)${vt}-compact-item`]:{[`${vt}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}}})})}},Ze=pt=>{const{componentCls:vt,antCls:ke}=pt,Re=`${vt}-search`;return{[Re]:{[`${vt}`]:{"&:hover, &:focus":{borderColor:pt.colorPrimaryHover,[`+ ${vt}-group-addon ${Re}-button:not(${ke}-btn-primary)`]:{borderInlineStartColor:pt.colorPrimaryHover}}},[`${vt}-affix-wrapper`]:{borderRadius:0},[`${vt}-lg`]:{lineHeight:pt.calc(pt.lineHeightLG).sub(2e-4).equal()},[`> ${vt}-group`]:{[`> ${vt}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${Re}-button`]:{marginInlineEnd:-1,paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:pt.borderRadius,borderEndEndRadius:pt.borderRadius,borderEndStartRadius:0,boxShadow:"none"},[`${Re}-button:not(${ke}-btn-primary)`]:{color:pt.colorTextDescription,"&:hover":{color:pt.colorPrimaryHover},"&:active":{color:pt.colorPrimaryActive},[`&${ke}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${Re}-button`]:{height:pt.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${Re}-button`]:{height:pt.controlHeightLG},[`&-small ${Re}-button`]:{height:pt.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${vt}-compact-item`]:{[`&:not(${vt}-compact-last-item)`]:{[`${vt}-group-addon`]:{[`${vt}-search-button`]:{marginInlineEnd:pt.calc(pt.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${vt}-compact-first-item)`]:{[`${vt},${vt}-affix-wrapper`]:{borderRadius:0}},[`> ${vt}-group-addon ${vt}-search-button,
        > ${vt},
        ${vt}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${vt}-affix-wrapper-focused`]:{zIndex:2}}}}},xt=pt=>{const{componentCls:vt,paddingLG:ke}=pt,Re=`${vt}-textarea`;return{[Re]:{position:"relative","&-show-count":{[`> ${vt}`]:{height:"100%"},[`${vt}-data-count`]:{position:"absolute",bottom:pt.calc(pt.fontSize).mul(pt.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:pt.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${vt},
        &-affix-wrapper${Re}-has-feedback ${vt}
      `]:{paddingInlineEnd:ke},[`&-affix-wrapper${vt}-affix-wrapper`]:{padding:0,[`> textarea${vt}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent","&:focus":{boxShadow:"none !important"}},[`${vt}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${vt}-clear-icon`]:{position:"absolute",insetInlineEnd:pt.paddingInline,insetBlockStart:pt.paddingXS},[`${Re}-suffix`]:{position:"absolute",top:0,insetInlineEnd:pt.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${vt}-affix-wrapper-sm`]:{[`${vt}-suffix`]:{[`${vt}-clear-icon`]:{insetInlineEnd:pt.paddingInlineSM}}}}}},ft=pt=>{const{componentCls:vt}=pt;return{[`${vt}-out-of-range`]:{[`&, & input, & textarea, ${vt}-show-count-suffix, ${vt}-data-count`]:{color:pt.colorError}}}};var Zt=W.default=(0,_e.genStyleHooks)("Input",pt=>{const vt=(0,_e.mergeToken)(pt,(0,re.initInputToken)(pt));return[Be(vt),xt(vt),we(vt),le(vt),Ze(vt),ft(vt),(0,E.genCompactItemStyle)(vt)]},re.initComponentToken,{resetFont:!1})},25735:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.initComponentToken=void 0,W.initInputToken=X;var ee=D(3184);function X(_e){return(0,ee.mergeToken)(_e,{inputAffixPadding:_e.paddingXXS})}const E=_e=>{const{controlHeight:re,fontSize:he,lineHeight:se,lineWidth:Se,controlHeightSM:oe,controlHeightLG:je,fontSizeLG:te,lineHeightLG:ve,paddingSM:Be,controlPaddingHorizontalSM:Te,controlPaddingHorizontal:we,colorFillAlter:le,colorPrimaryHover:Ze,colorPrimary:xt,controlOutlineWidth:ft,controlOutline:Zt,colorErrorOutline:pt,colorWarningOutline:vt,colorBgContainer:ke}=_e;return{paddingBlock:Math.max(Math.round((re-he*se)/2*10)/10-Se,0),paddingBlockSM:Math.max(Math.round((oe-he*se)/2*10)/10-Se,0),paddingBlockLG:Math.ceil((je-te*ve)/2*10)/10-Se,paddingInline:Be-Se,paddingInlineSM:Te-Se,paddingInlineLG:we-Se,addonBg:le,activeBorderColor:xt,hoverBorderColor:Ze,activeShadow:`0 0 0 ${ft}px ${Zt}`,errorActiveShadow:`0 0 0 ${ft}px ${pt}`,warningActiveShadow:`0 0 0 ${ft}px ${vt}`,hoverBg:ke,activeBg:ke,inputFontSize:he,inputFontSizeLG:te,inputFontSizeSM:he}};W.initComponentToken=E},58594:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genOutlinedStyle=W.genOutlinedGroupStyle=W.genHoverStyle=W.genFilledStyle=W.genFilledGroupStyle=W.genDisabledStyle=W.genBorderlessStyle=W.genBaseOutlinedStyle=void 0;var ee=D(85088),X=D(3184);const E=le=>({borderColor:le.hoverBorderColor,backgroundColor:le.hoverBg});W.genHoverStyle=E;const _e=le=>({color:le.colorTextDisabled,backgroundColor:le.colorBgContainerDisabled,borderColor:le.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},E((0,X.mergeToken)(le,{hoverBorderColor:le.colorBorder,hoverBg:le.colorBgContainerDisabled})))});W.genDisabledStyle=_e;const re=(le,Ze)=>({background:le.colorBgContainer,borderWidth:le.lineWidth,borderStyle:le.lineType,borderColor:Ze.borderColor,"&:hover":{borderColor:Ze.hoverBorderColor,backgroundColor:le.hoverBg},"&:focus, &:focus-within":{borderColor:Ze.activeBorderColor,boxShadow:Ze.activeShadow,outline:0,backgroundColor:le.activeBg}});W.genBaseOutlinedStyle=re;const he=(le,Ze)=>({[`&${le.componentCls}-status-${Ze.status}:not(${le.componentCls}-disabled)`]:Object.assign(Object.assign({},re(le,Ze)),{[`${le.componentCls}-prefix, ${le.componentCls}-suffix`]:{color:Ze.affixColor}}),[`&${le.componentCls}-status-${Ze.status}${le.componentCls}-disabled`]:{borderColor:Ze.borderColor}}),se=(le,Ze)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},re(le,{borderColor:le.colorBorder,hoverBorderColor:le.hoverBorderColor,activeBorderColor:le.activeBorderColor,activeShadow:le.activeShadow})),{[`&${le.componentCls}-disabled, &[disabled]`]:Object.assign({},_e(le))}),he(le,{status:"error",borderColor:le.colorError,hoverBorderColor:le.colorErrorBorderHover,activeBorderColor:le.colorError,activeShadow:le.errorActiveShadow,affixColor:le.colorError})),he(le,{status:"warning",borderColor:le.colorWarning,hoverBorderColor:le.colorWarningBorderHover,activeBorderColor:le.colorWarning,activeShadow:le.warningActiveShadow,affixColor:le.colorWarning})),Ze)});W.genOutlinedStyle=se;const Se=(le,Ze)=>({[`&${le.componentCls}-group-wrapper-status-${Ze.status}`]:{[`${le.componentCls}-group-addon`]:{borderColor:Ze.addonBorderColor,color:Ze.addonColor}}}),oe=le=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${le.componentCls}-group`]:{"&-addon":{background:le.addonBg,border:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},Se(le,{status:"error",addonBorderColor:le.colorError,addonColor:le.colorErrorText})),Se(le,{status:"warning",addonBorderColor:le.colorWarning,addonColor:le.colorWarningText})),{[`&${le.componentCls}-group-wrapper-disabled`]:{[`${le.componentCls}-group-addon`]:Object.assign({},_e(le))}})});W.genOutlinedGroupStyle=oe;const je=(le,Ze)=>{const{componentCls:xt}=le;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${xt}-disabled, &[disabled]`]:{color:le.colorTextDisabled},[`&${xt}-status-error`]:{"&, & input, & textarea":{color:le.colorError}},[`&${xt}-status-warning`]:{"&, & input, & textarea":{color:le.colorWarning}}},Ze)}};W.genBorderlessStyle=je;const te=(le,Ze)=>({background:Ze.bg,borderWidth:le.lineWidth,borderStyle:le.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:Ze==null?void 0:Ze.inputColor},"&:hover":{background:Ze.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:Ze.activeBorderColor,backgroundColor:le.activeBg}}),ve=(le,Ze)=>({[`&${le.componentCls}-status-${Ze.status}:not(${le.componentCls}-disabled)`]:Object.assign(Object.assign({},te(le,Ze)),{[`${le.componentCls}-prefix, ${le.componentCls}-suffix`]:{color:Ze.affixColor}})}),Be=(le,Ze)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},te(le,{bg:le.colorFillTertiary,hoverBg:le.colorFillSecondary,activeBorderColor:le.activeBorderColor})),{[`&${le.componentCls}-disabled, &[disabled]`]:Object.assign({},_e(le))}),ve(le,{status:"error",bg:le.colorErrorBg,hoverBg:le.colorErrorBgHover,activeBorderColor:le.colorError,inputColor:le.colorErrorText,affixColor:le.colorError})),ve(le,{status:"warning",bg:le.colorWarningBg,hoverBg:le.colorWarningBgHover,activeBorderColor:le.colorWarning,inputColor:le.colorWarningText,affixColor:le.colorWarning})),Ze)});W.genFilledStyle=Be;const Te=(le,Ze)=>({[`&${le.componentCls}-group-wrapper-status-${Ze.status}`]:{[`${le.componentCls}-group-addon`]:{background:Ze.addonBg,color:Ze.addonColor}}}),we=le=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${le.componentCls}-group`]:{"&-addon":{background:le.colorFillTertiary},[`${le.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorSplit}`}}}},Te(le,{status:"error",addonBg:le.colorErrorBg,addonColor:le.colorErrorText})),Te(le,{status:"warning",addonBg:le.colorWarningBg,addonColor:le.colorWarningText})),{[`&${le.componentCls}-group-wrapper-disabled`]:{[`${le.componentCls}-group`]:{"&-addon":{background:le.colorFillTertiary,color:le.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`,borderTop:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`,borderBottom:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`,borderTop:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`,borderBottom:`${(0,ee.unit)(le.lineWidth)} ${le.lineType} ${le.colorBorder}`}}}})});W.genFilledGroupStyle=we},36714:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.hasPrefixSuffix=D;function D(ee){return!!(ee.prefix||ee.suffix||ee.allowClear||ee.showCount)}},44805:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294);const X=(0,ee.createContext)(void 0);var E=W.default=X},64050:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=W.ANT_MARK=void 0,Object.defineProperty(W,"useLocale",{enumerable:!0,get:function(){return se.default}});var E=X(D(67294)),_e=D(13594),re=D(10625),he=ee(D(44805)),se=ee(D(76647));const Se=W.ANT_MARK="internalMark",oe=te=>{const{locale:ve={},children:Be,_ANT_MARK__:Te}=te;E.useEffect(()=>(0,re.changeConfirmLocale)(ve==null?void 0:ve.Modal),[ve]);const we=E.useMemo(()=>Object.assign(Object.assign({},ve),{exist:!0}),[ve]);return E.createElement(he.default.Provider,{value:we},Be)};var je=W.default=oe},76647:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(44805)),re=ee(D(18253));const he=(Se,oe)=>{const je=E.useContext(_e.default),te=E.useMemo(()=>{var Be;const Te=oe||re.default[Se],we=(Be=je==null?void 0:je[Se])!==null&&Be!==void 0?Be:{};return Object.assign(Object.assign({},typeof Te=="function"?Te():Te),we||{})},[Se,oe,je]),ve=E.useMemo(()=>{const Be=je==null?void 0:je.locale;return je!=null&&je.exist&&!Be?re.default.locale:Be},[je]);return[te,ve]};var se=W.default=he},10625:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.changeConfirmLocale=he,W.getConfirmLocale=se;var X=ee(D(18253));let E=Object.assign({},X.default.Modal),_e=[];const re=()=>_e.reduce((Se,oe)=>Object.assign(Object.assign({},Se),oe),X.default.Modal);function he(Se){if(Se){const oe=Object.assign({},Se);return _e.push(oe),E=re(),()=>{_e=_e.filter(je=>je!==oe),E=re()}}E=Object.assign({},X.default.Modal)}function se(){return E}},46549:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.useCompactItemContext=W.default=W.SpaceCompactItemContext=W.NoCompactStyle=void 0;var E=X(D(67294)),_e=ee(D(93967)),re=ee(D(45598)),he=D(31929),se=ee(D(65693)),Se=ee(D(54277)),oe=function(le,Ze){var xt={};for(var ft in le)Object.prototype.hasOwnProperty.call(le,ft)&&Ze.indexOf(ft)<0&&(xt[ft]=le[ft]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Zt=0,ft=Object.getOwnPropertySymbols(le);Zt<ft.length;Zt++)Ze.indexOf(ft[Zt])<0&&Object.prototype.propertyIsEnumerable.call(le,ft[Zt])&&(xt[ft[Zt]]=le[ft[Zt]]);return xt};const je=W.SpaceCompactItemContext=E.createContext(null),te=(le,Ze)=>{const xt=E.useContext(je),ft=E.useMemo(()=>{if(!xt)return"";const{compactDirection:Zt,isFirstItem:pt,isLastItem:vt}=xt,ke=Zt==="vertical"?"-vertical-":"-";return(0,_e.default)(`${le}-compact${ke}item`,{[`${le}-compact${ke}first-item`]:pt,[`${le}-compact${ke}last-item`]:vt,[`${le}-compact${ke}item-rtl`]:Ze==="rtl"})},[le,Ze,xt]);return{compactSize:xt==null?void 0:xt.compactSize,compactDirection:xt==null?void 0:xt.compactDirection,compactItemClassnames:ft}};W.useCompactItemContext=te;const ve=le=>{let{children:Ze}=le;return E.createElement(je.Provider,{value:null},Ze)};W.NoCompactStyle=ve;const Be=le=>{var{children:Ze}=le,xt=oe(le,["children"]);return E.createElement(je.Provider,{value:xt},Ze)},Te=le=>{const{getPrefixCls:Ze,direction:xt}=E.useContext(he.ConfigContext),{size:ft,direction:Zt,block:pt,prefixCls:vt,className:ke,rootClassName:Re,children:bt}=le,gt=oe(le,["size","direction","block","prefixCls","className","rootClassName","children"]),Ct=(0,se.default)(Rt=>ft!=null?ft:Rt),Sn=Ze("space-compact",vt),[He,Ot]=(0,Se.default)(Sn),Ce=(0,_e.default)(Sn,Ot,{[`${Sn}-rtl`]:xt==="rtl",[`${Sn}-block`]:pt,[`${Sn}-vertical`]:Zt==="vertical"},ke,Re),ot=E.useContext(je),$e=(0,re.default)(bt),Xe=E.useMemo(()=>$e.map((Rt,_t)=>{const Pe=(Rt==null?void 0:Rt.key)||`${Sn}-item-${_t}`;return E.createElement(Be,{key:Pe,compactSize:Ct,compactDirection:Zt,isFirstItem:_t===0&&(!ot||(ot==null?void 0:ot.isFirstItem)),isLastItem:_t===$e.length-1&&(!ot||(ot==null?void 0:ot.isLastItem))},Rt)}),[ft,$e,ot]);return $e.length===0?null:He(E.createElement("div",Object.assign({className:Ce},gt),Xe))};var we=W.default=Te},35969:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>{const{componentCls:E}=X;return{[E]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}};var ee=W.default=D},54277:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.prepareComponentToken=W.default=void 0;var X=D(3184),E=ee(D(35969));const _e=Se=>{const{componentCls:oe,antCls:je}=Se;return{[oe]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${oe}-item:empty`]:{display:"none"},[`${oe}-item > ${je}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},re=Se=>{const{componentCls:oe}=Se;return{[oe]:{"&-gap-row-small":{rowGap:Se.spaceGapSmallSize},"&-gap-row-middle":{rowGap:Se.spaceGapMiddleSize},"&-gap-row-large":{rowGap:Se.spaceGapLargeSize},"&-gap-col-small":{columnGap:Se.spaceGapSmallSize},"&-gap-col-middle":{columnGap:Se.spaceGapMiddleSize},"&-gap-col-large":{columnGap:Se.spaceGapLargeSize}}}},he=()=>({});W.prepareComponentToken=he;var se=W.default=(0,X.genStyleHooks)("Space",Se=>{const oe=(0,X.mergeToken)(Se,{spaceGapSmallSize:Se.paddingXS,spaceGapMiddleSize:Se.padding,spaceGapLargeSize:Se.paddingLG});return[_e(oe),re(oe),(0,E.default)(oe)]},()=>({}),{resetStyle:!1})},78793:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genCompactItemStyle=X;function D(E,_e,re){const{focusElCls:he,focus:se,borderElCls:Se}=re,oe=Se?"> *":"",je=["hover",se?"focus":null,"active"].filter(Boolean).map(te=>`&:${te} ${oe}`).join(",");return{[`&-item:not(${_e}-last-item)`]:{marginInlineEnd:E.calc(E.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[je]:{zIndex:2}},he?{[`&${he}`]:{zIndex:2}}:{}),{[`&[disabled] ${oe}`]:{zIndex:0}})}}function ee(E,_e,re){const{borderElCls:he}=re,se=he?`> ${he}`:"";return{[`&-item:not(${_e}-first-item):not(${_e}-last-item) ${se}`]:{borderRadius:0},[`&-item:not(${_e}-last-item)${_e}-first-item`]:{[`& ${se}, &${E}-sm ${se}, &${E}-lg ${se}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${_e}-first-item)${_e}-last-item`]:{[`& ${se}, &${E}-sm ${se}, &${E}-lg ${se}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function X(E){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:re}=E,he=`${re}-compact`;return{[he]:Object.assign(Object.assign({},D(E,he,_e)),ee(re,he,_e))}}},98078:function($t,W,D){"use strict";"use client";Object.defineProperty(W,"__esModule",{value:!0}),W.genLinkStyle=W.genFocusStyle=W.genFocusOutline=W.genCommonStyle=W.clearFix=void 0,Object.defineProperty(W,"operationUnit",{enumerable:!0,get:function(){return X.operationUnit}}),W.textEllipsis=W.resetIcon=W.resetComponent=void 0;var ee=D(85088),X=D(22548);const E=W.textEllipsis={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},_e=function(te){let ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:te.colorText,fontSize:te.fontSize,lineHeight:te.lineHeight,listStyle:"none",fontFamily:ve?"inherit":te.fontFamily}};W.resetComponent=_e;const re=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}});W.resetIcon=re;const he=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}});W.clearFix=he;const se=te=>({a:{color:te.colorLink,textDecoration:te.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${te.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:te.colorLinkHover},"&:active":{color:te.colorLinkActive},"&:active, &:hover":{textDecoration:te.linkHoverDecoration,outline:0},"&:focus":{textDecoration:te.linkFocusDecoration,outline:0},"&[disabled]":{color:te.colorTextDisabled,cursor:"not-allowed"}}});W.genLinkStyle=se;const Se=(te,ve,Be,Te)=>{const we=`[class^="${ve}"], [class*=" ${ve}"]`,le=Be?`.${Be}`:we,Ze={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let xt={};return Te!==!1&&(xt={fontFamily:te.fontFamily,fontSize:te.fontSize}),{[le]:Object.assign(Object.assign(Object.assign({},xt),Ze),{[we]:Ze})}};W.genCommonStyle=Se;const oe=te=>({outline:`${(0,ee.unit)(te.lineWidthFocus)} solid ${te.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"});W.genFocusOutline=oe;const je=te=>({"&:focus-visible":Object.assign({},oe(te))});W.genFocusStyle=je},57253:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>({[X.componentCls]:{[`${X.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${X.motionDurationMid} ${X.motionEaseInOut},
        opacity ${X.motionDurationMid} ${X.motionEaseInOut} !important`}},[`${X.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${X.motionDurationMid} ${X.motionEaseInOut},
        opacity ${X.motionDurationMid} ${X.motionEaseInOut} !important`}}});var ee=W.default=D},84460:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.initFadeMotion=W.fadeOut=W.fadeIn=void 0;var ee=D(85088),X=D(94631);const E=W.fadeIn=new ee.Keyframes("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),_e=W.fadeOut=new ee.Keyframes("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),re=function(he){let se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:Se}=he,oe=`${Se}-fade`,je=se?"&":"";return[(0,X.initMotion)(oe,E,_e,he.motionDurationMid,se),{[`
        ${je}${oe}-enter,
        ${je}${oe}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${je}${oe}-leave`]:{animationTimingFunction:"linear"}}]};W.initFadeMotion=re},42836:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"fadeIn",{enumerable:!0,get:function(){return E.fadeIn}}),Object.defineProperty(W,"fadeOut",{enumerable:!0,get:function(){return E.fadeOut}}),Object.defineProperty(W,"genCollapseMotion",{enumerable:!0,get:function(){return X.default}}),Object.defineProperty(W,"initFadeMotion",{enumerable:!0,get:function(){return E.initFadeMotion}}),Object.defineProperty(W,"initMoveMotion",{enumerable:!0,get:function(){return _e.initMoveMotion}}),Object.defineProperty(W,"initSlideMotion",{enumerable:!0,get:function(){return re.initSlideMotion}}),Object.defineProperty(W,"initZoomMotion",{enumerable:!0,get:function(){return he.initZoomMotion}}),Object.defineProperty(W,"moveDownIn",{enumerable:!0,get:function(){return _e.moveDownIn}}),Object.defineProperty(W,"moveDownOut",{enumerable:!0,get:function(){return _e.moveDownOut}}),Object.defineProperty(W,"moveLeftIn",{enumerable:!0,get:function(){return _e.moveLeftIn}}),Object.defineProperty(W,"moveLeftOut",{enumerable:!0,get:function(){return _e.moveLeftOut}}),Object.defineProperty(W,"moveRightIn",{enumerable:!0,get:function(){return _e.moveRightIn}}),Object.defineProperty(W,"moveRightOut",{enumerable:!0,get:function(){return _e.moveRightOut}}),Object.defineProperty(W,"moveUpIn",{enumerable:!0,get:function(){return _e.moveUpIn}}),Object.defineProperty(W,"moveUpOut",{enumerable:!0,get:function(){return _e.moveUpOut}}),Object.defineProperty(W,"slideDownIn",{enumerable:!0,get:function(){return re.slideDownIn}}),Object.defineProperty(W,"slideDownOut",{enumerable:!0,get:function(){return re.slideDownOut}}),Object.defineProperty(W,"slideLeftIn",{enumerable:!0,get:function(){return re.slideLeftIn}}),Object.defineProperty(W,"slideLeftOut",{enumerable:!0,get:function(){return re.slideLeftOut}}),Object.defineProperty(W,"slideRightIn",{enumerable:!0,get:function(){return re.slideRightIn}}),Object.defineProperty(W,"slideRightOut",{enumerable:!0,get:function(){return re.slideRightOut}}),Object.defineProperty(W,"slideUpIn",{enumerable:!0,get:function(){return re.slideUpIn}}),Object.defineProperty(W,"slideUpOut",{enumerable:!0,get:function(){return re.slideUpOut}}),Object.defineProperty(W,"zoomBigIn",{enumerable:!0,get:function(){return he.zoomBigIn}}),Object.defineProperty(W,"zoomBigOut",{enumerable:!0,get:function(){return he.zoomBigOut}}),Object.defineProperty(W,"zoomDownIn",{enumerable:!0,get:function(){return he.zoomDownIn}}),Object.defineProperty(W,"zoomDownOut",{enumerable:!0,get:function(){return he.zoomDownOut}}),Object.defineProperty(W,"zoomIn",{enumerable:!0,get:function(){return he.zoomIn}}),Object.defineProperty(W,"zoomLeftIn",{enumerable:!0,get:function(){return he.zoomLeftIn}}),Object.defineProperty(W,"zoomLeftOut",{enumerable:!0,get:function(){return he.zoomLeftOut}}),Object.defineProperty(W,"zoomOut",{enumerable:!0,get:function(){return he.zoomOut}}),Object.defineProperty(W,"zoomRightIn",{enumerable:!0,get:function(){return he.zoomRightIn}}),Object.defineProperty(W,"zoomRightOut",{enumerable:!0,get:function(){return he.zoomRightOut}}),Object.defineProperty(W,"zoomUpIn",{enumerable:!0,get:function(){return he.zoomUpIn}}),Object.defineProperty(W,"zoomUpOut",{enumerable:!0,get:function(){return he.zoomUpOut}});var X=ee(D(57253)),E=D(84460),_e=D(17060),re=D(17581),he=D(99269)},94631:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.initMotion=void 0;const D=E=>({animationDuration:E,animationFillMode:"both"}),ee=E=>({animationDuration:E,animationFillMode:"both"}),X=function(E,_e,re,he){const Se=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${Se}${E}-enter,
      ${Se}${E}-appear
    `]:Object.assign(Object.assign({},D(he)),{animationPlayState:"paused"}),[`${Se}${E}-leave`]:Object.assign(Object.assign({},ee(he)),{animationPlayState:"paused"}),[`
      ${Se}${E}-enter${E}-enter-active,
      ${Se}${E}-appear${E}-appear-active
    `]:{animationName:_e,animationPlayState:"running"},[`${Se}${E}-leave${E}-leave-active`]:{animationName:re,animationPlayState:"running",pointerEvents:"none"}}};W.initMotion=X},17060:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.moveUpOut=W.moveUpIn=W.moveRightOut=W.moveRightIn=W.moveLeftOut=W.moveLeftIn=W.moveDownOut=W.moveDownIn=W.initMoveMotion=void 0;var ee=D(85088),X=D(94631);const E=W.moveDownIn=new ee.Keyframes("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),_e=W.moveDownOut=new ee.Keyframes("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),re=W.moveLeftIn=new ee.Keyframes("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),he=W.moveLeftOut=new ee.Keyframes("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),se=W.moveRightIn=new ee.Keyframes("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Se=W.moveRightOut=new ee.Keyframes("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),oe=W.moveUpIn=new ee.Keyframes("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),je=W.moveUpOut=new ee.Keyframes("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),te={"move-up":{inKeyframes:oe,outKeyframes:je},"move-down":{inKeyframes:E,outKeyframes:_e},"move-left":{inKeyframes:re,outKeyframes:he},"move-right":{inKeyframes:se,outKeyframes:Se}},ve=(Be,Te)=>{const{antCls:we}=Be,le=`${we}-${Te}`,{inKeyframes:Ze,outKeyframes:xt}=te[Te];return[(0,X.initMotion)(le,Ze,xt,Be.motionDurationMid),{[`
        ${le}-enter,
        ${le}-appear
      `]:{opacity:0,animationTimingFunction:Be.motionEaseOutCirc},[`${le}-leave`]:{animationTimingFunction:Be.motionEaseInOutCirc}}]};W.initMoveMotion=ve},17581:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.slideUpOut=W.slideUpIn=W.slideRightOut=W.slideRightIn=W.slideLeftOut=W.slideLeftIn=W.slideDownOut=W.slideDownIn=W.initSlideMotion=void 0;var ee=D(85088),X=D(94631);const E=W.slideUpIn=new ee.Keyframes("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),_e=W.slideUpOut=new ee.Keyframes("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),re=W.slideDownIn=new ee.Keyframes("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),he=W.slideDownOut=new ee.Keyframes("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),se=W.slideLeftIn=new ee.Keyframes("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),Se=W.slideLeftOut=new ee.Keyframes("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),oe=W.slideRightIn=new ee.Keyframes("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),je=W.slideRightOut=new ee.Keyframes("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),te={"slide-up":{inKeyframes:E,outKeyframes:_e},"slide-down":{inKeyframes:re,outKeyframes:he},"slide-left":{inKeyframes:se,outKeyframes:Se},"slide-right":{inKeyframes:oe,outKeyframes:je}},ve=(Be,Te)=>{const{antCls:we}=Be,le=`${we}-${Te}`,{inKeyframes:Ze,outKeyframes:xt}=te[Te];return[(0,X.initMotion)(le,Ze,xt,Be.motionDurationMid),{[`
      ${le}-enter,
      ${le}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:Be.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${le}-leave`]:{animationTimingFunction:Be.motionEaseInQuint}}]};W.initSlideMotion=ve},99269:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.zoomUpOut=W.zoomUpIn=W.zoomRightOut=W.zoomRightIn=W.zoomOut=W.zoomLeftOut=W.zoomLeftIn=W.zoomIn=W.zoomDownOut=W.zoomDownIn=W.zoomBigOut=W.zoomBigIn=W.initZoomMotion=void 0;var ee=D(85088),X=D(94631);const E=W.zoomIn=new ee.Keyframes("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),_e=W.zoomOut=new ee.Keyframes("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),re=W.zoomBigIn=new ee.Keyframes("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),he=W.zoomBigOut=new ee.Keyframes("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),se=W.zoomUpIn=new ee.Keyframes("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Se=W.zoomUpOut=new ee.Keyframes("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),oe=W.zoomLeftIn=new ee.Keyframes("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),je=W.zoomLeftOut=new ee.Keyframes("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),te=W.zoomRightIn=new ee.Keyframes("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),ve=W.zoomRightOut=new ee.Keyframes("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),Be=W.zoomDownIn=new ee.Keyframes("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),Te=W.zoomDownOut=new ee.Keyframes("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),we={zoom:{inKeyframes:E,outKeyframes:_e},"zoom-big":{inKeyframes:re,outKeyframes:he},"zoom-big-fast":{inKeyframes:re,outKeyframes:he},"zoom-left":{inKeyframes:oe,outKeyframes:je},"zoom-right":{inKeyframes:te,outKeyframes:ve},"zoom-up":{inKeyframes:se,outKeyframes:Se},"zoom-down":{inKeyframes:Be,outKeyframes:Te}},le=(Ze,xt)=>{const{antCls:ft}=Ze,Zt=`${ft}-${xt}`,{inKeyframes:pt,outKeyframes:vt}=we[xt];return[(0,X.initMotion)(Zt,pt,vt,xt==="zoom-big-fast"?Ze.motionDurationFast:Ze.motionDurationMid),{[`
        ${Zt}-enter,
        ${Zt}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:Ze.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${Zt}-leave`]:{animationTimingFunction:Ze.motionEaseInOutCirc}}]};W.initZoomMotion=le},22548:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.operationUnit=void 0;const D=ee=>({color:ee.colorLink,textDecoration:"none",outline:"none",cursor:"pointer",transition:`color ${ee.motionDurationSlow}`,"&:focus, &:hover":{color:ee.colorLinkHover},"&:active":{color:ee.colorLinkActive}});W.operationUnit=D},9064:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.MAX_VERTICAL_CONTENT_RADIUS=void 0,W.default=he,W.getArrowOffsetToken=_e;var ee=D(85088),X=D(51337);const E=W.MAX_VERTICAL_CONTENT_RADIUS=8;function _e(se){const{contentRadius:Se,limitVerticalRadius:oe}=se,je=Se>12?Se+2:12;return{arrowOffsetHorizontal:je,arrowOffsetVertical:oe?E:je}}function re(se,Se){return se?Se:{}}function he(se,Se,oe){const{componentCls:je,boxShadowPopoverArrow:te,arrowOffsetVertical:ve,arrowOffsetHorizontal:Be}=se,{arrowDistance:Te=0,arrowPlacement:we={left:!0,right:!0,top:!0,bottom:!0}}=oe||{};return{[je]:Object.assign(Object.assign(Object.assign(Object.assign({[`${je}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},(0,X.genRoundedArrow)(se,Se,te)),{"&:before":{background:Se}})]},re(!!we.top,{[[`&-placement-top > ${je}-arrow`,`&-placement-topLeft > ${je}-arrow`,`&-placement-topRight > ${je}-arrow`].join(",")]:{bottom:Te,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${je}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":Be,[`> ${je}-arrow`]:{left:{_skip_check_:!0,value:Be}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,ee.unit)(Be)})`,[`> ${je}-arrow`]:{right:{_skip_check_:!0,value:Be}}}})),re(!!we.bottom,{[[`&-placement-bottom > ${je}-arrow`,`&-placement-bottomLeft > ${je}-arrow`,`&-placement-bottomRight > ${je}-arrow`].join(",")]:{top:Te,transform:"translateY(-100%)"},[`&-placement-bottom > ${je}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":Be,[`> ${je}-arrow`]:{left:{_skip_check_:!0,value:Be}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,ee.unit)(Be)})`,[`> ${je}-arrow`]:{right:{_skip_check_:!0,value:Be}}}})),re(!!we.left,{[[`&-placement-left > ${je}-arrow`,`&-placement-leftTop > ${je}-arrow`,`&-placement-leftBottom > ${je}-arrow`].join(",")]:{right:{_skip_check_:!0,value:Te},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${je}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${je}-arrow`]:{top:ve},[`&-placement-leftBottom > ${je}-arrow`]:{bottom:ve}})),re(!!we.right,{[[`&-placement-right > ${je}-arrow`,`&-placement-rightTop > ${je}-arrow`,`&-placement-rightBottom > ${je}-arrow`].join(",")]:{left:{_skip_check_:!0,value:Te},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${je}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${je}-arrow`]:{top:ve},[`&-placement-rightBottom > ${je}-arrow`]:{bottom:ve}}))}}},51337:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.genRoundedArrow=void 0,W.getArrowToken=X;var ee=D(85088);function X(_e){const{sizePopupArrow:re,borderRadiusXS:he,borderRadiusOuter:se}=_e,Se=re/2,oe=0,je=Se,te=se*1/Math.sqrt(2),ve=Se-se*(1-1/Math.sqrt(2)),Be=Se-he*(1/Math.sqrt(2)),Te=se*(Math.sqrt(2)-1)+he*(1/Math.sqrt(2)),we=2*Se-Be,le=Te,Ze=2*Se-te,xt=ve,ft=2*Se-oe,Zt=je,pt=Se*Math.sqrt(2)+se*(Math.sqrt(2)-2),vt=se*(Math.sqrt(2)-1),ke=`polygon(${vt}px 100%, 50% ${vt}px, ${2*Se-vt}px 100%, ${vt}px 100%)`,Re=`path('M ${oe} ${je} A ${se} ${se} 0 0 0 ${te} ${ve} L ${Be} ${Te} A ${he} ${he} 0 0 1 ${we} ${le} L ${Ze} ${xt} A ${se} ${se} 0 0 0 ${ft} ${Zt} Z')`;return{arrowShadowWidth:pt,arrowPath:Re,arrowPolygon:ke}}const E=(_e,re,he)=>{const{sizePopupArrow:se,arrowPolygon:Se,arrowPath:oe,arrowShadowWidth:je,borderRadiusXS:te,calc:ve}=_e;return{pointerEvents:"none",width:se,height:se,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:se,height:ve(se).div(2).equal(),background:re,clipPath:{_multi_value_:!0,value:[Se,oe]},content:'""'},"&::after":{content:'""',position:"absolute",width:je,height:je,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${(0,ee.unit)(te)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:he,zIndex:0,background:"transparent"}}};W.genRoundedArrow=E},89329:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.defaultTheme=W.defaultConfig=W.DesignTokenContext=void 0;var X=ee(D(67294)),E=D(85088),_e=ee(D(9924)),re=ee(D(98411));const he=W.defaultTheme=(0,E.createTheme)(_e.default),se=W.defaultConfig={token:re.default,override:{override:re.default},hashed:!0},Se=W.DesignTokenContext=X.default.createContext(se)},36496:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"PresetColors",{enumerable:!0,get:function(){return ee.PresetColors}});var ee=D(81342)},81342:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.PresetColors=void 0;const D=W.PresetColors=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"]},3184:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),Object.defineProperty(W,"DesignTokenContext",{enumerable:!0,get:function(){return je.DesignTokenContext}}),Object.defineProperty(W,"PresetColors",{enumerable:!0,get:function(){return _e.PresetColors}}),Object.defineProperty(W,"calc",{enumerable:!0,get:function(){return E.genCalc}}),Object.defineProperty(W,"defaultConfig",{enumerable:!0,get:function(){return je.defaultConfig}}),Object.defineProperty(W,"genComponentStyleHook",{enumerable:!0,get:function(){return se.genComponentStyleHook}}),Object.defineProperty(W,"genPresetColor",{enumerable:!0,get:function(){return Se.default}}),Object.defineProperty(W,"genStyleHooks",{enumerable:!0,get:function(){return se.genStyleHooks}}),Object.defineProperty(W,"genSubStyleComponent",{enumerable:!0,get:function(){return se.genSubStyleComponent}}),Object.defineProperty(W,"getLineHeight",{enumerable:!0,get:function(){return re.getLineHeight}}),Object.defineProperty(W,"mergeToken",{enumerable:!0,get:function(){return E.mergeToken}}),Object.defineProperty(W,"statistic",{enumerable:!0,get:function(){return E.statistic}}),Object.defineProperty(W,"statisticToken",{enumerable:!0,get:function(){return E.statisticToken}}),Object.defineProperty(W,"useResetIconStyle",{enumerable:!0,get:function(){return oe.default}}),Object.defineProperty(W,"useStyleRegister",{enumerable:!0,get:function(){return X.useStyleRegister}}),Object.defineProperty(W,"useToken",{enumerable:!0,get:function(){return he.default}});var X=D(85088),E=D(83262),_e=D(36496),re=D(62231),he=ee(D(41401)),se=D(24225),Se=ee(D(36219)),oe=ee(D(54894)),je=D(89329)},26162:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getSolidColor=W.getAlphaColor=void 0;var ee=D(131);const X=(_e,re)=>new ee.TinyColor(_e).setAlpha(re).toRgbString();W.getAlphaColor=X;const E=(_e,re)=>new ee.TinyColor(_e).darken(re).toHexString();W.getSolidColor=E},80373:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.generateNeutralColorPalettes=W.generateColorPalettes=void 0;var ee=D(65409),X=D(26162);const E=re=>{const he=(0,ee.generate)(re);return{1:he[0],2:he[1],3:he[2],4:he[3],5:he[4],6:he[5],7:he[6],8:he[4],9:he[5],10:he[6]}};W.generateColorPalettes=E;const _e=(re,he)=>{const se=re||"#fff",Se=he||"#000";return{colorBgBase:se,colorTextBase:Se,colorText:(0,X.getAlphaColor)(Se,.88),colorTextSecondary:(0,X.getAlphaColor)(Se,.65),colorTextTertiary:(0,X.getAlphaColor)(Se,.45),colorTextQuaternary:(0,X.getAlphaColor)(Se,.25),colorFill:(0,X.getAlphaColor)(Se,.15),colorFillSecondary:(0,X.getAlphaColor)(Se,.06),colorFillTertiary:(0,X.getAlphaColor)(Se,.04),colorFillQuaternary:(0,X.getAlphaColor)(Se,.02),colorBgLayout:(0,X.getSolidColor)(se,4),colorBgContainer:(0,X.getSolidColor)(se,0),colorBgElevated:(0,X.getSolidColor)(se,0),colorBgSpotlight:(0,X.getAlphaColor)(Se,.85),colorBgBlur:"transparent",colorBorder:(0,X.getSolidColor)(se,15),colorBorderSecondary:(0,X.getSolidColor)(se,6)}};W.generateNeutralColorPalettes=_e},9924:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=je;var X=D(65409),E=D(98411),_e=ee(D(10805)),re=ee(D(81594)),he=ee(D(54730)),se=ee(D(69853)),Se=ee(D(19216)),oe=D(80373);function je(te){X.presetPrimaryColors.pink=X.presetPrimaryColors.magenta,X.presetPalettes.pink=X.presetPalettes.magenta;const ve=Object.keys(E.defaultPresetColors).map(Be=>{const Te=te[Be]===X.presetPrimaryColors[Be]?X.presetPalettes[Be]:(0,X.generate)(te[Be]);return new Array(10).fill(1).reduce((we,le,Ze)=>(we[`${Be}-${Ze+1}`]=Te[Ze],we[`${Be}${Ze+1}`]=Te[Ze],we),{})}).reduce((Be,Te)=>(Be=Object.assign(Object.assign({},Be),Te),Be),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},te),ve),(0,_e.default)(te,{generateColorPalettes:oe.generateColorPalettes,generateNeutralColorPalettes:oe.generateNeutralColorPalettes})),(0,se.default)(te.fontSize)),(0,Se.default)(te)),(0,he.default)(te)),(0,re.default)(te))}},98411:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.defaultPresetColors=W.default=void 0;const D=W.defaultPresetColors={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},ee=Object.assign(Object.assign({},D),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});var X=W.default=ee},10805:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=X;var ee=D(131);function X(E,_e){let{generateColorPalettes:re,generateNeutralColorPalettes:he}=_e;const{colorSuccess:se,colorWarning:Se,colorError:oe,colorInfo:je,colorPrimary:te,colorBgBase:ve,colorTextBase:Be}=E,Te=re(te),we=re(se),le=re(Se),Ze=re(oe),xt=re(je),ft=he(ve,Be),Zt=E.colorLink||E.colorInfo,pt=re(Zt);return Object.assign(Object.assign({},ft),{colorPrimaryBg:Te[1],colorPrimaryBgHover:Te[2],colorPrimaryBorder:Te[3],colorPrimaryBorderHover:Te[4],colorPrimaryHover:Te[5],colorPrimary:Te[6],colorPrimaryActive:Te[7],colorPrimaryTextHover:Te[8],colorPrimaryText:Te[9],colorPrimaryTextActive:Te[10],colorSuccessBg:we[1],colorSuccessBgHover:we[2],colorSuccessBorder:we[3],colorSuccessBorderHover:we[4],colorSuccessHover:we[4],colorSuccess:we[6],colorSuccessActive:we[7],colorSuccessTextHover:we[8],colorSuccessText:we[9],colorSuccessTextActive:we[10],colorErrorBg:Ze[1],colorErrorBgHover:Ze[2],colorErrorBgActive:Ze[3],colorErrorBorder:Ze[3],colorErrorBorderHover:Ze[4],colorErrorHover:Ze[5],colorError:Ze[6],colorErrorActive:Ze[7],colorErrorTextHover:Ze[8],colorErrorText:Ze[9],colorErrorTextActive:Ze[10],colorWarningBg:le[1],colorWarningBgHover:le[2],colorWarningBorder:le[3],colorWarningBorderHover:le[4],colorWarningHover:le[4],colorWarning:le[6],colorWarningActive:le[7],colorWarningTextHover:le[8],colorWarningText:le[9],colorWarningTextActive:le[10],colorInfoBg:xt[1],colorInfoBgHover:xt[2],colorInfoBorder:xt[3],colorInfoBorderHover:xt[4],colorInfoHover:xt[4],colorInfo:xt[6],colorInfoActive:xt[7],colorInfoTextHover:xt[8],colorInfoText:xt[9],colorInfoTextActive:xt[10],colorLinkHover:pt[4],colorLink:pt[6],colorLinkActive:pt[7],colorBgMask:new ee.TinyColor("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},81594:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(78117));function E(_e){const{motionUnit:re,motionBase:he,borderRadius:se,lineWidth:Se}=_e;return Object.assign({motionDurationFast:`${(he+re).toFixed(1)}s`,motionDurationMid:`${(he+re*2).toFixed(1)}s`,motionDurationSlow:`${(he+re*3).toFixed(1)}s`,lineWidthBold:Se+1},(0,X.default)(se))}},54730:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>{const{controlHeight:E}=X;return{controlHeightSM:E*.75,controlHeightXS:E*.5,controlHeightLG:E*1.25}};var ee=W.default=D},69853:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(62231));const E=re=>{const he=(0,X.default)(re),se=he.map(we=>we.size),Se=he.map(we=>we.lineHeight),oe=se[1],je=se[0],te=se[2],ve=Se[1],Be=Se[0],Te=Se[2];return{fontSizeSM:je,fontSize:oe,fontSizeLG:te,fontSizeXL:se[3],fontSizeHeading1:se[6],fontSizeHeading2:se[5],fontSizeHeading3:se[4],fontSizeHeading4:se[3],fontSizeHeading5:se[2],lineHeight:ve,lineHeightLG:Te,lineHeightSM:Be,fontHeight:Math.round(ve*oe),fontHeightLG:Math.round(Te*te),fontHeightSM:Math.round(Be*je),lineHeightHeading1:Se[6],lineHeightHeading2:Se[5],lineHeightHeading3:Se[4],lineHeightHeading4:Se[3],lineHeightHeading5:Se[2]}};var _e=W.default=E},62231:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=ee,W.getLineHeight=D;function D(X){return(X+8)/X}function ee(X){const E=new Array(10).fill(null).map((_e,re)=>{const he=re-1,se=X*Math.pow(Math.E,he/5),Se=re>1?Math.floor(se):Math.ceil(se);return Math.floor(Se/2)*2});return E[1]=X,E.map(_e=>({size:_e,lineHeight:D(_e)}))}},78117:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const D=X=>{let E=X,_e=X,re=X,he=X;return X<6&&X>=5?E=X+1:X<16&&X>=6?E=X+2:X>=16&&(E=16),X<7&&X>=5?_e=4:X<8&&X>=7?_e=5:X<14&&X>=8?_e=6:X<16&&X>=14?_e=7:X>=16&&(_e=8),X<6&&X>=2?re=1:X>=6&&(re=2),X>4&&X<8?he=4:X>=8&&(he=6),{borderRadius:X,borderRadiusXS:re,borderRadiusSM:_e,borderRadiusLG:E,borderRadiusOuter:he}};var ee=W.default=D},19216:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=D;function D(ee){const{sizeUnit:X,sizeStep:E}=ee;return{sizeXXL:X*(E+8),sizeXL:X*(E+4),sizeLG:X*(E+2),sizeMD:X*(E+1),sizeMS:X*E,size:X*E,sizeSM:X*(E-1),sizeXS:X*(E-2),sizeXXS:X*(E-3)}}},41401:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=Be,W.unitless=W.ignore=W.getComputedToken=void 0;var X=ee(D(67294)),E=D(85088),_e=ee(D(87629)),re=D(89329),he=ee(D(98411)),se=ee(D(27722)),Se=function(Te,we){var le={};for(var Ze in Te)Object.prototype.hasOwnProperty.call(Te,Ze)&&we.indexOf(Ze)<0&&(le[Ze]=Te[Ze]);if(Te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var xt=0,Ze=Object.getOwnPropertySymbols(Te);xt<Ze.length;xt++)we.indexOf(Ze[xt])<0&&Object.prototype.propertyIsEnumerable.call(Te,Ze[xt])&&(le[Ze[xt]]=Te[Ze[xt]]);return le};const oe=W.unitless={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},je=W.ignore={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},te={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},ve=(Te,we,le)=>{const Ze=le.getDerivativeToken(Te),{override:xt}=we,ft=Se(we,["override"]);let Zt=Object.assign(Object.assign({},Ze),{override:xt});return Zt=(0,se.default)(Zt),ft&&Object.entries(ft).forEach(pt=>{let[vt,ke]=pt;const{theme:Re}=ke,bt=Se(ke,["theme"]);let gt=bt;Re&&(gt=ve(Object.assign(Object.assign({},Zt),bt),{override:bt},Re)),Zt[vt]=gt}),Zt};W.getComputedToken=ve;function Be(){const{token:Te,hashed:we,theme:le,override:Ze,cssVar:xt}=X.default.useContext(re.DesignTokenContext),ft=`${_e.default}-${we||""}`,Zt=le||re.defaultTheme,[pt,vt,ke]=(0,E.useCacheToken)(Zt,[he.default,Te],{salt:ft,override:Ze,getComputedToken:ve,formatToken:se.default,cssVar:xt&&{prefix:xt.prefix,key:xt.key,unitless:oe,ignore:je,preserve:te}});return[Zt,ke,we?vt:"",pt,xt]}},27722:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=he;var X=D(131),E=ee(D(98411)),_e=ee(D(83609)),re=function(se,Se){var oe={};for(var je in se)Object.prototype.hasOwnProperty.call(se,je)&&Se.indexOf(je)<0&&(oe[je]=se[je]);if(se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var te=0,je=Object.getOwnPropertySymbols(se);te<je.length;te++)Se.indexOf(je[te])<0&&Object.prototype.propertyIsEnumerable.call(se,je[te])&&(oe[je[te]]=se[je[te]]);return oe};function he(se){const{override:Se}=se,oe=re(se,["override"]),je=Object.assign({},Se);Object.keys(E.default).forEach(ft=>{delete je[ft]});const te=Object.assign(Object.assign({},oe),je),ve=480,Be=576,Te=768,we=992,le=1200,Ze=1600;if(te.motion===!1){const ft="0s";te.motionDurationFast=ft,te.motionDurationMid=ft,te.motionDurationSlow=ft}return Object.assign(Object.assign(Object.assign({},te),{colorFillContent:te.colorFillSecondary,colorFillContentHover:te.colorFill,colorFillAlter:te.colorFillQuaternary,colorBgContainerDisabled:te.colorFillTertiary,colorBorderBg:te.colorBgContainer,colorSplit:(0,_e.default)(te.colorBorderSecondary,te.colorBgContainer),colorTextPlaceholder:te.colorTextQuaternary,colorTextDisabled:te.colorTextQuaternary,colorTextHeading:te.colorText,colorTextLabel:te.colorTextSecondary,colorTextDescription:te.colorTextTertiary,colorTextLightSolid:te.colorWhite,colorHighlight:te.colorError,colorBgTextHover:te.colorFillSecondary,colorBgTextActive:te.colorFill,colorIcon:te.colorTextTertiary,colorIconHover:te.colorText,colorErrorOutline:(0,_e.default)(te.colorErrorBg,te.colorBgContainer),colorWarningOutline:(0,_e.default)(te.colorWarningBg,te.colorBgContainer),fontSizeIcon:te.fontSizeSM,lineWidthFocus:te.lineWidth*4,lineWidth:te.lineWidth,controlOutlineWidth:te.lineWidth*2,controlInteractiveSize:te.controlHeight/2,controlItemBgHover:te.colorFillTertiary,controlItemBgActive:te.colorPrimaryBg,controlItemBgActiveHover:te.colorPrimaryBgHover,controlItemBgActiveDisabled:te.colorFill,controlTmpOutline:te.colorFillQuaternary,controlOutline:(0,_e.default)(te.colorPrimaryBg,te.colorBgContainer),lineType:te.lineType,borderRadius:te.borderRadius,borderRadiusXS:te.borderRadiusXS,borderRadiusSM:te.borderRadiusSM,borderRadiusLG:te.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:te.sizeXXS,paddingXS:te.sizeXS,paddingSM:te.sizeSM,padding:te.size,paddingMD:te.sizeMD,paddingLG:te.sizeLG,paddingXL:te.sizeXL,paddingContentHorizontalLG:te.sizeLG,paddingContentVerticalLG:te.sizeMS,paddingContentHorizontal:te.sizeMS,paddingContentVertical:te.sizeSM,paddingContentHorizontalSM:te.size,paddingContentVerticalSM:te.sizeXS,marginXXS:te.sizeXXS,marginXS:te.sizeXS,marginSM:te.sizeSM,margin:te.size,marginMD:te.sizeMD,marginLG:te.sizeLG,marginXL:te.sizeXL,marginXXL:te.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:ve,screenXSMin:ve,screenXSMax:Be-1,screenSM:Be,screenSMMin:Be,screenSMMax:Te-1,screenMD:Te,screenMDMin:Te,screenMDMax:we-1,screenLG:we,screenLGMin:we,screenLGMax:le-1,screenXL:le,screenXLMin:le,screenXLMax:Ze-1,screenXXL:Ze,screenXXLMin:Ze,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new X.TinyColor("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new X.TinyColor("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new X.TinyColor("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),je)}},36219:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=X;var ee=D(36496);function X(E,_e){return ee.PresetColors.reduce((re,he)=>{const se=E[`${he}1`],Se=E[`${he}3`],oe=E[`${he}6`],je=E[`${he}7`];return Object.assign(Object.assign({},re),_e(he,{lightColor:se,lightBorderColor:Se,darkColor:oe,textColor:je}))},{})}},24225:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.genSubStyleComponent=W.genStyleHooks=W.genComponentStyleHook=void 0;var E=D(67294),_e=D(83262),re=D(7177),he=D(98078),se=X(D(41401)),Se=ee(D(54894));const{genStyleHooks:oe,genComponentStyleHook:je,genSubStyleComponent:te}=(0,_e.genStyleUtils)({usePrefix:()=>{const{getPrefixCls:ve,iconPrefixCls:Be}=(0,E.useContext)(re.ConfigContext);return{rootPrefixCls:ve(),iconPrefixCls:Be}},useToken:()=>{const[ve,Be,Te,we,le]=(0,se.default)();return{theme:ve,realToken:Be,hashId:Te,token:we,cssVar:le}},useCSP:()=>{const{csp:ve,iconPrefixCls:Be}=(0,E.useContext)(re.ConfigContext);return(0,Se.default)(Be,ve),ve!=null?ve:{}},getResetStyles:ve=>[{"&":(0,he.genLinkStyle)(ve)}],getCommonStyle:he.genCommonStyle,getCompUnitless:()=>se.unitless});W.genSubStyleComponent=te,W.genComponentStyleHook=je,W.genStyleHooks=oe},83609:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(131);function X(re){return re>=0&&re<=255}function E(re,he){const{r:se,g:Se,b:oe,a:je}=new ee.TinyColor(re).toRgb();if(je<1)return re;const{r:te,g:ve,b:Be}=new ee.TinyColor(he).toRgb();for(let Te=.01;Te<=1;Te+=.01){const we=Math.round((se-te*(1-Te))/Te),le=Math.round((Se-ve*(1-Te))/Te),Ze=Math.round((oe-Be*(1-Te))/Te);if(X(we)&&X(le)&&X(Ze))return new ee.TinyColor({r:we,g:le,b:Ze,a:Math.round(Te*100)/100}).toRgbString()}return new ee.TinyColor({r:se,g:Se,b:oe,a:1}).toRgbString()}var _e=W.default=E},54894:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=D(85088),E=D(98078),_e=ee(D(41401));const re=(se,Se)=>{const[oe,je]=(0,_e.default)();return(0,X.useStyleRegister)({theme:oe,token:je,hashId:"",path:["ant-design-icons",se],nonce:()=>Se==null?void 0:Se.nonce,layer:{name:"antd"}},()=>[{[`.${se}`]:Object.assign(Object.assign({},(0,E.resetIcon)()),{[`.${se} .${se}-icon`]:{display:"block"}})}])};var he=W.default=re},92125:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(93967)),re=D(92419),he=D(31929),se=ee(D(15086)),Se=D(48125);const oe=te=>{const{prefixCls:ve,className:Be,placement:Te="top",title:we,color:le,overlayInnerStyle:Ze}=te,{getPrefixCls:xt}=E.useContext(he.ConfigContext),ft=xt("tooltip",ve),[Zt,pt,vt]=(0,se.default)(ft),ke=(0,Se.parseColor)(ft,le),Re=ke.arrowStyle,bt=Object.assign(Object.assign({},Ze),ke.overlayStyle),gt=(0,_e.default)(pt,vt,ft,`${ft}-pure`,`${ft}-placement-${Te}`,Be,ke.className);return Zt(E.createElement("div",{className:gt,style:Re},E.createElement("div",{className:`${ft}-arrow`}),E.createElement(re.Popup,Object.assign({},te,{className:pt,prefixCls:ft,overlayInnerStyle:bt}),we)))};var je=W.default=oe},94055:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(93967)),re=ee(D(92419)),he=ee(D(60869)),se=ee(D(85549)),Se=D(56333),oe=D(53683),je=ee(D(74132)),te=D(47419),ve=D(13594),Be=ee(D(96877)),Te=D(31929),we=D(3184),le=ee(D(92125)),Ze=ee(D(15086)),xt=D(48125),ft=function(ke,Re){var bt={};for(var gt in ke)Object.prototype.hasOwnProperty.call(ke,gt)&&Re.indexOf(gt)<0&&(bt[gt]=ke[gt]);if(ke!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ct=0,gt=Object.getOwnPropertySymbols(ke);Ct<gt.length;Ct++)Re.indexOf(gt[Ct])<0&&Object.prototype.propertyIsEnumerable.call(ke,gt[Ct])&&(bt[gt[Ct]]=ke[gt[Ct]]);return bt};const pt=E.forwardRef((ke,Re)=>{var bt,gt;const{prefixCls:Ct,openClassName:Sn,getTooltipContainer:He,overlayClassName:Ot,color:Ce,overlayInnerStyle:ot,children:$e,afterOpenChange:Xe,afterVisibleChange:Rt,destroyTooltipOnHide:_t,arrow:Pe=!0,title:Wt,overlay:on,builtinPlacements:Nn,arrowPointAtCenter:jn=!1,autoAdjustOverflow:lr=!0}=ke,Vt=!!Pe,[,en]=(0,we.useToken)(),{getPopupContainer:xn,getPrefixCls:er,direction:sn}=E.useContext(Te.ConfigContext),Ut=(0,ve.devUseWarning)("Tooltip"),Dt=E.useRef(null),Me=()=>{var et;(et=Dt.current)===null||et===void 0||et.forceAlign()};E.useImperativeHandle(Re,()=>{var et;return{forceAlign:Me,forcePopupAlign:()=>{Ut.deprecated(!1,"forcePopupAlign","forceAlign"),Me()},nativeElement:(et=Dt.current)===null||et===void 0?void 0:et.nativeElement}});const[Qe,Ft]=(0,he.default)(!1,{value:(bt=ke.open)!==null&&bt!==void 0?bt:ke.visible,defaultValue:(gt=ke.defaultOpen)!==null&&gt!==void 0?gt:ke.defaultVisible}),U=!Wt&&!on&&Wt!==0,ue=et=>{var wt,qt;Ft(U?!1:et),U||((wt=ke.onOpenChange)===null||wt===void 0||wt.call(ke,et),(qt=ke.onVisibleChange)===null||qt===void 0||qt.call(ke,et))},at=E.useMemo(()=>{var et,wt;let qt=jn;return typeof Pe=="object"&&(qt=(wt=(et=Pe.pointAtCenter)!==null&&et!==void 0?et:Pe.arrowPointAtCenter)!==null&&wt!==void 0?wt:jn),Nn||(0,je.default)({arrowPointAtCenter:qt,autoAdjustOverflow:lr,arrowWidth:Vt?en.sizePopupArrow:0,borderRadius:en.borderRadius,offset:en.marginXXS,visibleFirst:!0})},[jn,Pe,Nn,en]),ce=E.useMemo(()=>Wt===0?Wt:on||Wt||"",[on,Wt]),j=E.createElement(se.default,{space:!0},typeof ce=="function"?ce():ce),{getPopupContainer:ln,placement:fn="top",mouseEnterDelay:mt=.1,mouseLeaveDelay:Gt=.1,overlayStyle:Wn,rootClassName:hn}=ke,ht=ft(ke,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),Ht=er("tooltip",Ct),Cn=er(),Ln=ke["data-popover-inject"];let Gn=Qe;!("open"in ke)&&!("visible"in ke)&&U&&(Gn=!1);const dt=E.isValidElement($e)&&!(0,te.isFragment)($e)?$e:E.createElement("span",null,$e),ye=dt.props,Fe=!ye.className||typeof ye.className=="string"?(0,_e.default)(ye.className,Sn||`${Ht}-open`):ye.className,[nt,Pt,Mt]=(0,Ze.default)(Ht,!Ln),Tn=(0,xt.parseColor)(Ht,Ce),$n=Tn.arrowStyle,xr=Object.assign(Object.assign({},ot),Tn.overlayStyle),qn=(0,_e.default)(Ot,{[`${Ht}-rtl`]:sn==="rtl"},Tn.className,hn,Pt,Mt),[Ae,be]=(0,Se.useZIndex)("Tooltip",ht.zIndex),Ne=E.createElement(re.default,Object.assign({},ht,{zIndex:Ae,showArrow:Vt,placement:fn,mouseEnterDelay:mt,mouseLeaveDelay:Gt,prefixCls:Ht,overlayClassName:qn,overlayStyle:Object.assign(Object.assign({},$n),Wn),getTooltipContainer:ln||He||xn,ref:Dt,builtinPlacements:at,overlay:j,visible:Gn,onVisibleChange:ue,afterVisibleChange:Xe!=null?Xe:Rt,overlayInnerStyle:xr,arrowContent:E.createElement("span",{className:`${Ht}-arrow-content`}),motion:{motionName:(0,oe.getTransitionName)(Cn,"zoom-big-fast",ke.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!_t}),Gn?(0,te.cloneElement)(dt,{className:Fe}):dt);return nt(E.createElement(Be.default.Provider,{value:be},Ne))});pt._InternalPanelDoNotUseOrYouWillBeFired=le.default;var vt=W.default=pt},15086:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.prepareComponentToken=W.default=void 0;var X=D(85088),E=D(98078),_e=D(42836),re=ee(D(9064)),he=D(51337),se=D(3184);const Se=te=>{const{componentCls:ve,tooltipMaxWidth:Be,tooltipColor:Te,tooltipBg:we,tooltipBorderRadius:le,zIndexPopup:Ze,controlHeight:xt,boxShadowSecondary:ft,paddingSM:Zt,paddingXS:pt}=te;return[{[ve]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,E.resetComponent)(te)),{position:"absolute",zIndex:Ze,display:"block",width:"max-content",maxWidth:Be,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":we,[`${ve}-inner`]:{minWidth:"1em",minHeight:xt,padding:`${(0,X.unit)(te.calc(Zt).div(2).equal())} ${(0,X.unit)(pt)}`,color:Te,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:we,borderRadius:le,boxShadow:ft,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${ve}-inner`]:{borderRadius:te.min(le,re.MAX_VERTICAL_CONTENT_RADIUS)}},[`${ve}-content`]:{position:"relative"}}),(0,se.genPresetColor)(te,(vt,ke)=>{let{darkColor:Re}=ke;return{[`&${ve}-${vt}`]:{[`${ve}-inner`]:{backgroundColor:Re},[`${ve}-arrow`]:{"--antd-arrow-background-color":Re}}}})),{"&-rtl":{direction:"rtl"}})},(0,re.default)(te,"var(--antd-arrow-background-color)"),{[`${ve}-pure`]:{position:"relative",maxWidth:"none",margin:te.sizePopupArrow}}]},oe=te=>Object.assign(Object.assign({zIndexPopup:te.zIndexPopupBase+70},(0,re.getArrowOffsetToken)({contentRadius:te.borderRadius,limitVerticalRadius:!0})),(0,he.getArrowToken)((0,se.mergeToken)(te,{borderRadiusOuter:Math.min(te.borderRadiusOuter,4)})));W.prepareComponentToken=oe;var je=W.default=function(ve){let Be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(0,se.genStyleHooks)("Tooltip",we=>{const{borderRadius:le,colorTextLightSolid:Ze,colorBgSpotlight:xt}=we,ft=(0,se.mergeToken)(we,{tooltipMaxWidth:250,tooltipColor:Ze,tooltipBorderRadius:le,tooltipBg:xt});return[Se(ft),(0,_e.initZoomMotion)(we,"zoom-big-fast")]},oe,{resetStyle:!1,injectStyle:Be})(ve)}},48125:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.parseColor=_e;var X=ee(D(93967)),E=D(45471);function _e(re,he){const se=(0,E.isPresetColor)(he),Se=(0,X.default)({[`${re}-${he}`]:he&&se}),oe={},je={};return he&&!se&&(oe.background=he,je["--antd-arrow-background-color"]=he),{className:Se,overlayStyle:oe,arrowStyle:je}}},6847:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(83874)),re=ee(D(90091)),he=ee(D(4121)),se=ee(D(93967)),Se=ee(D(60938)),oe=ee(D(94055)),je=D(81410);const te=Be=>{const{prefixCls:Te,copied:we,locale:le,iconOnly:Ze,tooltips:xt,icon:ft,loading:Zt,tabIndex:pt,onCopy:vt}=Be,ke=(0,je.toList)(xt),Re=(0,je.toList)(ft),{copied:bt,copy:gt}=le!=null?le:{},Ct=we?(0,je.getNode)(ke[1],bt):(0,je.getNode)(ke[0],gt),He=typeof Ct=="string"?Ct:we?bt:gt;return E.createElement(oe.default,{key:"copy",title:Ct},E.createElement(Se.default,{className:(0,se.default)(`${Te}-copy`,{[`${Te}-copy-success`]:we,[`${Te}-copy-icon-only`]:Ze}),onClick:vt,"aria-label":He,tabIndex:pt},we?(0,je.getNode)(Re[1],E.createElement(_e.default,null),!0):(0,je.getNode)(Re[0],Zt?E.createElement(he.default,null):E.createElement(re.default,null),!0)))};var ve=W.default=te},12385:function($t,W,D){"use strict";"use client";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=Ze;var E=X(D(861)),_e=ee(D(67294)),re=X(D(45598)),he=X(D(82546));const se=_e.forwardRef((xt,ft)=>{let{style:Zt,children:pt}=xt;const vt=_e.useRef(null);return _e.useImperativeHandle(ft,()=>({isExceed:()=>{const ke=vt.current;return ke.scrollHeight>ke.clientHeight},getHeight:()=>vt.current.clientHeight})),_e.createElement("span",{"aria-hidden":!0,ref:vt,style:Object.assign({position:"fixed",display:"block",left:0,top:0,pointerEvents:"none",backgroundColor:"rgba(255, 0, 0, 0.65)"},Zt)},pt)});function Se(xt){const ft=typeof xt;return ft==="string"||ft==="number"}function oe(xt){let ft=0;return xt.forEach(Zt=>{Se(Zt)?ft+=String(Zt).length:ft+=1}),ft}function je(xt,ft){let Zt=0;const pt=[];for(let vt=0;vt<xt.length;vt+=1){if(Zt===ft)return pt;const ke=xt[vt],bt=Se(ke)?String(ke).length:1,gt=Zt+bt;if(gt>ft){const Ct=ft-Zt;return pt.push(String(ke).slice(0,Ct)),pt}pt.push(ke),Zt=gt}return xt}const te=0,ve=1,Be=2,Te=3,we=4,le={display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical"};function Ze(xt){const{enableMeasure:ft,width:Zt,text:pt,children:vt,rows:ke,expanded:Re,miscDeps:bt,onEllipsis:gt}=xt,Ct=_e.useMemo(()=>(0,re.default)(pt),[pt]),Sn=_e.useMemo(()=>oe(Ct),[pt]),He=_e.useMemo(()=>vt(Ct,!1),[pt]),[Ot,Ce]=_e.useState(null),ot=_e.useRef(null),$e=_e.useRef(null),Xe=_e.useRef(null),Rt=_e.useRef(null),_t=_e.useRef(null),[Pe,Wt]=_e.useState(!1),[on,Nn]=_e.useState(te),[jn,lr]=_e.useState(0),[Vt,en]=_e.useState(null);(0,he.default)(()=>{Nn(ft&&Zt&&Sn?ve:te)},[Zt,pt,ke,ft,Ct]),(0,he.default)(()=>{var Ut,Dt,Me,Qe;if(on===ve){Nn(Be);const Ft=$e.current&&getComputedStyle($e.current).whiteSpace;en(Ft)}else if(on===Be){const Ft=!!(!((Ut=Xe.current)===null||Ut===void 0)&&Ut.isExceed());Nn(Ft?Te:we),Ce(Ft?[0,Sn]:null),Wt(Ft);const U=((Dt=Xe.current)===null||Dt===void 0?void 0:Dt.getHeight())||0,ue=ke===1?0:((Me=Rt.current)===null||Me===void 0?void 0:Me.getHeight())||0,at=((Qe=_t.current)===null||Qe===void 0?void 0:Qe.getHeight())||0,ce=ue+at,j=Math.max(U,ce);lr(j+1),gt(Ft)}},[on]);const xn=Ot?Math.ceil((Ot[0]+Ot[1])/2):0;(0,he.default)(()=>{var Ut;const[Dt,Me]=Ot||[0,0];if(Dt!==Me){const Ft=(((Ut=ot.current)===null||Ut===void 0?void 0:Ut.getHeight())||0)>jn;let U=xn;Me-Dt===1&&(U=Ft?Dt:Me),Ce(Ft?[Dt,U]:[U,Me])}},[Ot,xn]);const er=_e.useMemo(()=>{if(on!==Te||!Ot||Ot[0]!==Ot[1]){const Ut=vt(Ct,!1);return on!==we&&on!==te?_e.createElement("span",{style:Object.assign(Object.assign({},le),{WebkitLineClamp:ke})},Ut):Ut}return vt(Re?Ct:je(Ct,Ot[0]),Pe)},[Re,on,Ot,Ct].concat((0,E.default)(bt))),sn={width:Zt,margin:0,padding:0,whiteSpace:Vt==="nowrap"?"normal":"inherit"};return _e.createElement(_e.Fragment,null,er,on===Be&&_e.createElement(_e.Fragment,null,_e.createElement(se,{style:Object.assign(Object.assign(Object.assign({},sn),le),{WebkitLineClamp:ke}),ref:Xe},He),_e.createElement(se,{style:Object.assign(Object.assign(Object.assign({},sn),le),{WebkitLineClamp:ke-1}),ref:Rt},He),_e.createElement(se,{style:Object.assign(Object.assign(Object.assign({},sn),le),{WebkitLineClamp:1}),ref:_t},vt([],!0))),on===Te&&Ot&&Ot[0]!==Ot[1]&&_e.createElement(se,{style:Object.assign(Object.assign({},sn),{top:400}),ref:ot},vt(je(Ct,xn),!0)),on===ve&&_e.createElement("span",{style:{whiteSpace:"inherit"},ref:$e}))}},69274:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(94055));const re=se=>{let{enableEllipsis:Se,isEllipsis:oe,children:je,tooltipProps:te}=se;return!(te!=null&&te.title)||!Se?je:E.createElement(_e.default,Object.assign({open:oe?void 0:!1},te),je)};var he=W.default=re},28460:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(10875)),re=ee(D(93967)),he=ee(D(9220)),se=ee(D(45598)),Se=ee(D(82546)),oe=ee(D(60869)),je=ee(D(18475)),te=D(75531),ve=D(38882),Be=ee(D(60938)),Te=D(31929),we=ee(D(76647)),le=ee(D(94055)),Ze=ee(D(69425)),xt=ee(D(63985)),ft=ee(D(92759)),Zt=ee(D(28991)),pt=ee(D(67312)),vt=ee(D(89652)),ke=ee(D(6847)),Re=ee(D(12385)),bt=ee(D(69274)),gt=function(Ce,ot){var $e={};for(var Xe in Ce)Object.prototype.hasOwnProperty.call(Ce,Xe)&&ot.indexOf(Xe)<0&&($e[Xe]=Ce[Xe]);if(Ce!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Rt=0,Xe=Object.getOwnPropertySymbols(Ce);Rt<Xe.length;Rt++)ot.indexOf(Xe[Rt])<0&&Object.prototype.propertyIsEnumerable.call(Ce,Xe[Rt])&&($e[Xe[Rt]]=Ce[Xe[Rt]]);return $e};function Ct(Ce,ot){let{mark:$e,code:Xe,underline:Rt,delete:_t,strong:Pe,keyboard:Wt,italic:on}=Ce,Nn=ot;function jn(lr,Vt){Vt&&(Nn=E.createElement(lr,{},Nn))}return jn("strong",Pe),jn("u",Rt),jn("del",_t),jn("code",Xe),jn("mark",$e),jn("kbd",Wt),jn("i",on),Nn}const Sn="...",He=E.forwardRef((Ce,ot)=>{var $e,Xe,Rt;const{prefixCls:_t,className:Pe,style:Wt,type:on,disabled:Nn,children:jn,ellipsis:lr,editable:Vt,copyable:en,component:xn,title:er}=Ce,sn=gt(Ce,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:Ut,direction:Dt}=E.useContext(Te.ConfigContext),[Me]=(0,we.default)("Text"),Qe=E.useRef(null),Ft=E.useRef(null),U=Ut("typography",_t),ue=(0,je.default)(sn,["mark","code","delete","underline","strong","keyboard","italic"]),[at,ce]=(0,ft.default)(Vt),[j,ln]=(0,oe.default)(!1,{value:ce.editing}),{triggerType:fn=["icon"]}=ce,mt=De=>{var Je;De&&((Je=ce.onStart)===null||Je===void 0||Je.call(ce)),ln(De)},Gt=(0,Zt.default)(j);(0,pt.default)(()=>{var De;!j&&Gt&&((De=Ft.current)===null||De===void 0||De.focus())},[j]);const Wn=De=>{De==null||De.preventDefault(),mt(!0)},hn=De=>{var Je;(Je=ce.onChange)===null||Je===void 0||Je.call(ce,De),mt(!1)},ht=()=>{var De;(De=ce.onCancel)===null||De===void 0||De.call(ce),mt(!1)},[Ht,Cn]=(0,ft.default)(en),{copied:Ln,copyLoading:Gn,onClick:dt}=(0,xt.default)({copyConfig:Cn,children:jn}),[ye,Fe]=E.useState(!1),[nt,Pt]=E.useState(!1),[Mt,Tn]=E.useState(!1),[$n,xr]=E.useState(!1),[qn,Ae]=E.useState(!0),[be,Ne]=(0,ft.default)(lr,{expandable:!1,symbol:De=>De?Me==null?void 0:Me.collapse:Me==null?void 0:Me.expand}),[et,wt]=(0,oe.default)(Ne.defaultExpanded||!1,{value:Ne.expanded}),qt=be&&(!et||Ne.expandable==="collapsible"),{rows:vn=1}=Ne,yt=E.useMemo(()=>qt&&(Ne.suffix!==void 0||Ne.onEllipsis||Ne.expandable||at||Ht),[qt,Ne,at,Ht]);(0,Se.default)(()=>{be&&!yt&&(Fe((0,ve.isStyleSupport)("webkitLineClamp")),Pt((0,ve.isStyleSupport)("textOverflow")))},[yt,be]);const[Jt,Qn]=E.useState(qt),Er=E.useMemo(()=>yt?!1:vn===1?nt:ye,[yt,nt,ye]);(0,Se.default)(()=>{Qn(Er&&qt)},[Er,qt]);const Vr=qt&&(Jt?$n:Mt),mr=qt&&vn===1&&Jt,kr=qt&&vn>1&&Jt,Ei=(De,Je)=>{var kt;wt(Je.expanded),(kt=Ne.onExpand)===null||kt===void 0||kt.call(Ne,De,Je)},[Oi,ar]=E.useState(0),Kr=De=>{let{offsetWidth:Je}=De;ar(Je)},hi=De=>{var Je;Tn(De),Mt!==De&&((Je=Ne.onEllipsis)===null||Je===void 0||Je.call(Ne,De))};E.useEffect(()=>{const De=Qe.current;if(be&&Jt&&De){const Je=kr?De.offsetHeight<De.scrollHeight:De.offsetWidth<De.scrollWidth;$n!==Je&&xr(Je)}},[be,Jt,jn,kr,qn,Oi]),E.useEffect(()=>{const De=Qe.current;if(typeof IntersectionObserver=="undefined"||!De||!Jt||!qt)return;const Je=new IntersectionObserver(()=>{Ae(!!De.offsetParent)});return Je.observe(De),()=>{Je.disconnect()}},[Jt,qt]);let Qr={};Ne.tooltip===!0?Qr={title:($e=ce.text)!==null&&$e!==void 0?$e:jn}:E.isValidElement(Ne.tooltip)?Qr={title:Ne.tooltip}:typeof Ne.tooltip=="object"?Qr=Object.assign({title:(Xe=ce.text)!==null&&Xe!==void 0?Xe:jn},Ne.tooltip):Qr={title:Ne.tooltip};const Io=E.useMemo(()=>{const De=Je=>["string","number"].includes(typeof Je);if(!(!be||Jt)){if(De(ce.text))return ce.text;if(De(jn))return jn;if(De(er))return er;if(De(Qr.title))return Qr.title}},[be,Jt,er,Qr.title,Vr]);if(j)return E.createElement(Ze.default,{value:(Rt=ce.text)!==null&&Rt!==void 0?Rt:typeof jn=="string"?jn:"",onSave:hn,onCancel:ht,onEnd:ce.onEnd,prefixCls:U,className:Pe,style:Wt,direction:Dt,component:xn,maxLength:ce.maxLength,autoSize:ce.autoSize,enterIcon:ce.enterIcon});const Ii=()=>{const{expandable:De,symbol:Je}=Ne;return!De||et&&De!=="collapsible"?null:E.createElement(Be.default,{key:"expand",className:`${U}-${et?"collapse":"expand"}`,onClick:kt=>Ei(kt,{expanded:!et}),"aria-label":et?Me.collapse:Me==null?void 0:Me.expand},typeof Je=="function"?Je(et):Je)},Fo=()=>{if(!at)return;const{icon:De,tooltip:Je,tabIndex:kt}=ce,un=(0,se.default)(Je)[0]||(Me==null?void 0:Me.edit),Bn=typeof un=="string"?un:"";return fn.includes("icon")?E.createElement(le.default,{key:"edit",title:Je===!1?"":un},E.createElement(Be.default,{ref:Ft,className:`${U}-edit`,onClick:Wn,"aria-label":Bn,tabIndex:kt},De||E.createElement(_e.default,{role:"button"}))):null},_a=()=>Ht?E.createElement(ke.default,Object.assign({key:"copy"},Cn,{prefixCls:U,copied:Ln,locale:Me,onCopy:dt,loading:Gn,iconOnly:jn==null})):null,Co=De=>[De&&Ii(),Fo(),_a()],Qo=De=>[De&&!et&&E.createElement("span",{"aria-hidden":!0,key:"ellipsis"},Sn),Ne.suffix,Co(De)];return E.createElement(he.default,{onResize:Kr,disabled:!qt},De=>E.createElement(bt.default,{tooltipProps:Qr,enableEllipsis:qt,isEllipsis:Vr},E.createElement(vt.default,Object.assign({className:(0,re.default)({[`${U}-${on}`]:on,[`${U}-disabled`]:Nn,[`${U}-ellipsis`]:be,[`${U}-ellipsis-single-line`]:mr,[`${U}-ellipsis-multiple-line`]:kr},Pe),prefixCls:_t,style:Object.assign(Object.assign({},Wt),{WebkitLineClamp:kr?vn:void 0}),component:xn,ref:(0,te.composeRef)(De,Qe,ot),direction:Dt,onClick:fn.includes("text")?Wn:void 0,"aria-label":Io==null?void 0:Io.toString(),title:er},ue),E.createElement(Re.default,{enableMeasure:qt&&!Jt,text:jn,rows:vn,width:Oi,onEllipsis:hi,expanded:et,miscDeps:[Ln,et,Gn,at,Ht]},(Je,kt)=>Ct(Ce,E.createElement(E.Fragment,null,Je.length>0&&kt&&!et&&Io?E.createElement("span",{key:"show-content","aria-hidden":!0},Je):Je,Qo(kt)))))))});var Ot=W.default=He},81410:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getNode=ee,W.toList=D;function D(X){return X===!1?[!1,!1]:Array.isArray(X)?X:[X]}function ee(X,E,_e){return X===!0||X===void 0?E:X||_e&&E}},69425:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(7224)),re=ee(D(93967)),he=ee(D(27712)),se=D(47419),Se=ee(D(14104)),oe=ee(D(23461));const je=ve=>{const{prefixCls:Be,"aria-label":Te,className:we,style:le,direction:Ze,maxLength:xt,autoSize:ft=!0,value:Zt,onSave:pt,onCancel:vt,onEnd:ke,component:Re,enterIcon:bt=E.createElement(_e.default,null)}=ve,gt=E.useRef(null),Ct=E.useRef(!1),Sn=E.useRef(),[He,Ot]=E.useState(Zt);E.useEffect(()=>{Ot(Zt)},[Zt]),E.useEffect(()=>{var Vt;if(!((Vt=gt.current)===null||Vt===void 0)&&Vt.resizableTextArea){const{textArea:en}=gt.current.resizableTextArea;en.focus();const{length:xn}=en.value;en.setSelectionRange(xn,xn)}},[]);const Ce=Vt=>{let{target:en}=Vt;Ot(en.value.replace(/[\n\r]/g,""))},ot=()=>{Ct.current=!0},$e=()=>{Ct.current=!1},Xe=Vt=>{let{keyCode:en}=Vt;Ct.current||(Sn.current=en)},Rt=()=>{pt(He.trim())},_t=Vt=>{let{keyCode:en,ctrlKey:xn,altKey:er,metaKey:sn,shiftKey:Ut}=Vt;Sn.current===en&&!Ct.current&&!xn&&!er&&!sn&&!Ut&&(en===he.default.ENTER?(Rt(),ke==null||ke()):en===he.default.ESC&&vt())},Pe=()=>{Rt()},Wt=Re?`${Be}-${Re}`:"",[on,Nn,jn]=(0,oe.default)(Be),lr=(0,re.default)(Be,`${Be}-edit-content`,{[`${Be}-rtl`]:Ze==="rtl"},we,Wt,Nn,jn);return on(E.createElement("div",{className:lr,style:le},E.createElement(Se.default,{ref:gt,maxLength:xt,value:He,onChange:Ce,onKeyDown:Xe,onKeyUp:_t,onCompositionStart:ot,onCompositionEnd:$e,onBlur:Pe,"aria-label":Te,rows:1,autoSize:ft}),bt!==null?(0,se.cloneElement)(bt,{className:`${Be}-edit-content-confirm`}):null))};var te=W.default=je},34528:function($t,W,D){"use strict";var ee,X=D(64836).default,E=D(75263).default;ee={value:!0},W.Z=void 0;var _e=E(D(67294)),re=D(13594),he=X(D(28460)),se=function(te,ve){var Be={};for(var Te in te)Object.prototype.hasOwnProperty.call(te,Te)&&ve.indexOf(Te)<0&&(Be[Te]=te[Te]);if(te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var we=0,Te=Object.getOwnPropertySymbols(te);we<Te.length;we++)ve.indexOf(Te[we])<0&&Object.prototype.propertyIsEnumerable.call(te,Te[we])&&(Be[Te[we]]=te[Te[we]]);return Be};const Se=[1,2,3,4,5],oe=_e.forwardRef((te,ve)=>{const{level:Be=1}=te,Te=se(te,["level"]);let we;return Se.includes(Be)?we=`h${Be}`:we="h1",_e.createElement(he.default,Object.assign({ref:ve},Te,{component:we}))});var je=W.Z=oe},89652:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(93967)),re=D(75531),he=D(13594),se=D(31929),Se=ee(D(23461)),oe=function(ve,Be){var Te={};for(var we in ve)Object.prototype.hasOwnProperty.call(ve,we)&&Be.indexOf(we)<0&&(Te[we]=ve[we]);if(ve!=null&&typeof Object.getOwnPropertySymbols=="function")for(var le=0,we=Object.getOwnPropertySymbols(ve);le<we.length;le++)Be.indexOf(we[le])<0&&Object.prototype.propertyIsEnumerable.call(ve,we[le])&&(Te[we[le]]=ve[we[le]]);return Te};const je=E.forwardRef((ve,Be)=>{const{prefixCls:Te,component:we="article",className:le,rootClassName:Ze,setContentRef:xt,children:ft,direction:Zt,style:pt}=ve,vt=oe(ve,["prefixCls","component","className","rootClassName","setContentRef","children","direction","style"]),{getPrefixCls:ke,direction:Re,typography:bt}=E.useContext(se.ConfigContext),gt=Zt!=null?Zt:Re;let Ct=Be;xt&&(Ct=(0,re.composeRef)(Be,xt));const Sn=ke("typography",Te),[He,Ot,Ce]=(0,Se.default)(Sn),ot=(0,_e.default)(Sn,bt==null?void 0:bt.className,{[`${Sn}-rtl`]:gt==="rtl"},le,Ze,Ot,Ce),$e=Object.assign(Object.assign({},bt==null?void 0:bt.style),pt);return He(E.createElement(we,Object.assign({className:ot,style:$e,ref:Ct},vt),ft))});var te=W.default=je},63985:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(67294)),_e=ee(D(20640)),re=D(56790),he=function(oe,je,te,ve){function Be(Te){return Te instanceof te?Te:new te(function(we){we(Te)})}return new(te||(te=Promise))(function(Te,we){function le(ft){try{xt(ve.next(ft))}catch(Zt){we(Zt)}}function Ze(ft){try{xt(ve.throw(ft))}catch(Zt){we(Zt)}}function xt(ft){ft.done?Te(ft.value):Be(ft.value).then(le,Ze)}xt((ve=ve.apply(oe,je||[])).next())})};const se=oe=>{let{copyConfig:je,children:te}=oe;const[ve,Be]=E.useState(!1),[Te,we]=E.useState(!1),le=E.useRef(null),Ze=()=>{le.current&&clearTimeout(le.current)},xt={};je.format&&(xt.format=je.format),E.useEffect(()=>Ze,[]);const ft=(0,re.useEvent)(Zt=>he(void 0,void 0,void 0,function*(){var pt;Zt==null||Zt.preventDefault(),Zt==null||Zt.stopPropagation(),we(!0);try{const vt=typeof je.text=="function"?yield je.text():je.text;(0,_e.default)(vt||String(te)||"",xt),we(!1),Be(!0),Ze(),le.current=setTimeout(()=>{Be(!1)},3e3),(pt=je.onCopy)===null||pt===void 0||pt.call(je,Zt)}catch(vt){throw we(!1),vt}}));return{copied:ve,copyLoading:Te,onClick:ft}};var Se=W.default=se},92759:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(67294));function E(_e,re){return X.useMemo(()=>{const he=!!_e;return[he,Object.assign(Object.assign({},re),he&&typeof _e=="object"?_e:null)]},[_e])}},28991:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294);const X=_e=>{const re=(0,ee.useRef)();return(0,ee.useEffect)(()=>{re.current=_e}),re.current};var E=W.default=X},67312:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(67294));const E=(re,he)=>{const se=X.useRef(!1);X.useEffect(()=>{se.current?re():se.current=!0},he)};var _e=W.default=E},23461:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.prepareComponentToken=W.default=void 0;var ee=D(98078),X=D(3184),E=D(48385);const _e=se=>{const{componentCls:Se,titleMarginTop:oe}=se;return{[Se]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:se.colorText,wordBreak:"break-word",lineHeight:se.lineHeight,[`&${Se}-secondary`]:{color:se.colorTextDescription},[`&${Se}-success`]:{color:se.colorSuccess},[`&${Se}-warning`]:{color:se.colorWarning},[`&${Se}-danger`]:{color:se.colorError,"a&:active, a&:focus":{color:se.colorErrorActive},"a&:hover":{color:se.colorErrorHover}},[`&${Se}-disabled`]:{color:se.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},"\n        div&,\n        p\n      ":{marginBottom:"1em"}},(0,E.getTitleStyles)(se)),{[`
      & + h1${Se},
      & + h2${Se},
      & + h3${Se},
      & + h4${Se},
      & + h5${Se}
      `]:{marginTop:oe},"\n      div,\n      ul,\n      li,\n      p,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5":{"\n        + h1,\n        + h2,\n        + h3,\n        + h4,\n        + h5\n        ":{marginTop:oe}}}),(0,E.getResetStyles)(se)),(0,E.getLinkStyles)(se)),{[`
        ${Se}-expand,
        ${Se}-collapse,
        ${Se}-edit,
        ${Se}-copy
      `]:Object.assign(Object.assign({},(0,ee.operationUnit)(se)),{marginInlineStart:se.marginXXS})}),(0,E.getEditableStyles)(se)),(0,E.getCopyableStyles)(se)),(0,E.getEllipsisStyles)()),{"&-rtl":{direction:"rtl"}})}},re=()=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em"});W.prepareComponentToken=re;var he=W.default=(0,X.genStyleHooks)("Typography",se=>[_e(se)],re)},48385:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.getTitleStyles=W.getResetStyles=W.getLinkStyles=W.getEllipsisStyles=W.getEditableStyles=W.getCopyableStyles=void 0;var ee=D(65409),X=D(85088),E=D(98078);const _e=(te,ve,Be,Te)=>{const{titleMarginBottom:we,fontWeightStrong:le}=Te;return{marginBottom:we,color:Be,fontWeight:le,fontSize:te,lineHeight:ve}},re=te=>{const ve=[1,2,3,4,5],Be={};return ve.forEach(Te=>{Be[`
      h${Te}&,
      div&-h${Te},
      div&-h${Te} > textarea,
      h${Te}
    `]=_e(te[`fontSizeHeading${Te}`],te[`lineHeightHeading${Te}`],te.colorTextHeading,te)}),Be};W.getTitleStyles=re;const he=te=>{const{componentCls:ve}=te;return{"a&, a":Object.assign(Object.assign({},(0,E.operationUnit)(te)),{textDecoration:te.linkDecoration,"&:active, &:hover":{textDecoration:te.linkHoverDecoration},[`&[disabled], &${ve}-disabled`]:{color:te.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:te.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}};W.getLinkStyles=he;const se=te=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:te.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:te.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:ee.gold[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:te.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}});W.getResetStyles=se;const Se=te=>{const{componentCls:ve,paddingSM:Be}=te,Te=Be;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:te.calc(te.paddingSM).mul(-1).equal(),marginTop:te.calc(Te).mul(-1).equal(),marginBottom:`calc(1em - ${(0,X.unit)(Te)})`},[`${ve}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:te.calc(te.marginXS).add(2).equal(),insetBlockEnd:te.marginXS,color:te.colorTextDescription,fontWeight:"normal",fontSize:te.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}};W.getEditableStyles=Se;const oe=te=>({[`${te.componentCls}-copy-success`]:{"\n    &,\n    &:hover,\n    &:focus":{color:te.colorSuccess}},[`${te.componentCls}-copy-icon-only`]:{marginInlineStart:0}});W.getCopyableStyles=oe;const je=()=>({"\n  a&-ellipsis,\n  span&-ellipsis\n  ":{display:"inline-block",maxWidth:"100%"},"&-ellipsis-single-line":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"},"> code":{paddingBlock:0,maxWidth:"calc(100% - 1.2em)",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"bottom",boxSizing:"content-box"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}});W.getEllipsisStyles=je},87629:function($t,W,D){"use strict";"use client";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(36245)),E=W.default=X.default},36245:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var D=W.default="5.20.0"},83874:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(71079));function X(_e){return _e&&_e.__esModule?_e:{default:_e}}const E=ee;W.default=E,$t.exports=E},43273:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(72225));function X(_e){return _e&&_e.__esModule?_e:{default:_e}}const E=ee;W.default=E,$t.exports=E},90091:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(29539));function X(_e){return _e&&_e.__esModule?_e:{default:_e}}const E=ee;W.default=E,$t.exports=E},10875:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(54825));function X(_e){return _e&&_e.__esModule?_e:{default:_e}}const E=ee;W.default=E,$t.exports=E},7224:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(43552));function X(_e){return _e&&_e.__esModule?_e:{default:_e}}const E=ee;W.default=E,$t.exports=E},4121:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;const ee=X(D(61929));function X(_e){return _e&&_e.__esModule?_e:{default:_e}}const E=ee;W.default=E,$t.exports=E},26545:function($t,W,D){"use strict";"use client";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=ee(D(10434)),_e=ee(D(27424)),re=ee(D(38416)),he=ee(D(70215)),se=X(D(67294)),Se=ee(D(93967)),oe=D(65409),je=ee(D(13357)),te=ee(D(46648)),ve=D(46338),Be=D(49458),Te=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];(0,ve.setTwoToneColor)(oe.blue.primary);var we=se.forwardRef(function(Ze,xt){var ft=Ze.className,Zt=Ze.icon,pt=Ze.spin,vt=Ze.rotate,ke=Ze.tabIndex,Re=Ze.onClick,bt=Ze.twoToneColor,gt=(0,he.default)(Ze,Te),Ct=se.useContext(je.default),Sn=Ct.prefixCls,He=Sn===void 0?"anticon":Sn,Ot=Ct.rootClassName,Ce=(0,Se.default)(Ot,He,(0,re.default)((0,re.default)({},"".concat(He,"-").concat(Zt.name),!!Zt.name),"".concat(He,"-spin"),!!pt||Zt.name==="loading"),ft),ot=ke;ot===void 0&&Re&&(ot=-1);var $e=vt?{msTransform:"rotate(".concat(vt,"deg)"),transform:"rotate(".concat(vt,"deg)")}:void 0,Xe=(0,Be.normalizeTwoToneColors)(bt),Rt=(0,_e.default)(Xe,2),_t=Rt[0],Pe=Rt[1];return se.createElement("span",(0,E.default)({role:"img","aria-label":Zt.name},gt,{ref:xt,tabIndex:ot,onClick:Re,className:Ce}),se.createElement(te.default,{icon:Zt,primaryColor:_t,secondaryColor:Pe,style:$e}))});we.displayName="AntdIcon",we.getTwoToneColor=ve.getTwoToneColor,we.setTwoToneColor=ve.setTwoToneColor;var le=W.default=we},13357:function($t,W,D){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var ee=D(67294),X=(0,ee.createContext)({}),E=W.default=X},46648:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=ee(D(70215)),_e=ee(D(42122)),re=X(D(67294)),he=D(49458),se=["icon","className","onClick","style","primaryColor","secondaryColor"],Se={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function oe(Be){var Te=Be.primaryColor,we=Be.secondaryColor;Se.primaryColor=Te,Se.secondaryColor=we||(0,he.getSecondaryColor)(Te),Se.calculated=!!we}function je(){return(0,_e.default)({},Se)}var te=function(Te){var we=Te.icon,le=Te.className,Ze=Te.onClick,xt=Te.style,ft=Te.primaryColor,Zt=Te.secondaryColor,pt=(0,E.default)(Te,se),vt=re.useRef(),ke=Se;if(ft&&(ke={primaryColor:ft,secondaryColor:Zt||(0,he.getSecondaryColor)(ft)}),(0,he.useInsertStyles)(vt),(0,he.warning)((0,he.isIconDefinition)(we),"icon should be icon definiton, but got ".concat(we)),!(0,he.isIconDefinition)(we))return null;var Re=we;return Re&&typeof Re.icon=="function"&&(Re=(0,_e.default)((0,_e.default)({},Re),{},{icon:Re.icon(ke.primaryColor,ke.secondaryColor)})),(0,he.generate)(Re.icon,"svg-".concat(Re.name),(0,_e.default)((0,_e.default)({className:le,onClick:Ze,style:xt,"data-icon":Re.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},pt),{},{ref:vt}))};te.displayName="IconReact",te.getTwoToneColors=je,te.setTwoToneColors=oe;var ve=W.default=te},46338:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.getTwoToneColor=he,W.setTwoToneColor=re;var X=ee(D(27424)),E=ee(D(46648)),_e=D(49458);function re(se){var Se=(0,_e.normalizeTwoToneColors)(se),oe=(0,X.default)(Se,2),je=oe[0],te=oe[1];return E.default.setTwoToneColors({primaryColor:je,secondaryColor:te})}function he(){var se=E.default.getTwoToneColors();return se.calculated?[se.primaryColor,se.secondaryColor]:se.primaryColor}},71079:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),_e=ee(D(67294)),re=X(D(25330)),he=X(D(26545)),se=function(te,ve){return _e.createElement(he.default,(0,E.default)({},te,{ref:ve,icon:re.default}))},Se=_e.forwardRef(se),oe=W.default=Se},72225:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),_e=ee(D(67294)),re=X(D(67303)),he=X(D(26545)),se=function(te,ve){return _e.createElement(he.default,(0,E.default)({},te,{ref:ve,icon:re.default}))},Se=_e.forwardRef(se),oe=W.default=Se},29539:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),_e=ee(D(67294)),re=X(D(83647)),he=X(D(26545)),se=function(te,ve){return _e.createElement(he.default,(0,E.default)({},te,{ref:ve,icon:re.default}))},Se=_e.forwardRef(se),oe=W.default=Se},54825:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),_e=ee(D(67294)),re=X(D(57583)),he=X(D(26545)),se=function(te,ve){return _e.createElement(he.default,(0,E.default)({},te,{ref:ve,icon:re.default}))},Se=_e.forwardRef(se),oe=W.default=Se},43552:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),_e=ee(D(67294)),re=X(D(29260)),he=X(D(26545)),se=function(te,ve){return _e.createElement(he.default,(0,E.default)({},te,{ref:ve,icon:re.default}))},Se=_e.forwardRef(se),oe=W.default=Se},61929:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var E=X(D(10434)),_e=ee(D(67294)),re=X(D(25828)),he=X(D(26545)),se=function(te,ve){return _e.createElement(he.default,(0,E.default)({},te,{ref:ve,icon:re.default}))},Se=_e.forwardRef(se),oe=W.default=Se},49458:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.generate=we,W.getSecondaryColor=le,W.iconStyles=void 0,W.isIconDefinition=Be,W.normalizeAttrs=Te,W.normalizeTwoToneColors=Ze,W.useInsertStyles=W.svgBaseProps=void 0,W.warning=ve;var E=X(D(42122)),_e=X(D(18698)),re=D(65409),he=D(93399),se=D(63298),Se=X(D(45520)),oe=ee(D(67294)),je=X(D(13357));function te(pt){return pt.replace(/-(.)/g,function(vt,ke){return ke.toUpperCase()})}function ve(pt,vt){(0,Se.default)(pt,"[@ant-design/icons] ".concat(vt))}function Be(pt){return(0,_e.default)(pt)==="object"&&typeof pt.name=="string"&&typeof pt.theme=="string"&&((0,_e.default)(pt.icon)==="object"||typeof pt.icon=="function")}function Te(){var pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(pt).reduce(function(vt,ke){var Re=pt[ke];switch(ke){case"class":vt.className=Re,delete vt.class;break;default:delete vt[ke],vt[te(ke)]=Re}return vt},{})}function we(pt,vt,ke){return ke?oe.default.createElement(pt.tag,(0,E.default)((0,E.default)({key:vt},Te(pt.attrs)),ke),(pt.children||[]).map(function(Re,bt){return we(Re,"".concat(vt,"-").concat(pt.tag,"-").concat(bt))})):oe.default.createElement(pt.tag,(0,E.default)({key:vt},Te(pt.attrs)),(pt.children||[]).map(function(Re,bt){return we(Re,"".concat(vt,"-").concat(pt.tag,"-").concat(bt))}))}function le(pt){return(0,re.generate)(pt)[0]}function Ze(pt){return pt?Array.isArray(pt)?pt:[pt]:[]}var xt=W.svgBaseProps={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},ft=W.iconStyles=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Zt=W.useInsertStyles=function(vt){var ke=(0,oe.useContext)(je.default),Re=ke.csp,bt=ke.prefixCls,gt=ft;bt&&(gt=gt.replace(/anticon/g,bt)),(0,oe.useEffect)(function(){var Ct=vt.current,Sn=(0,se.getShadowRoot)(Ct);(0,he.updateCSS)(gt,"@ant-design-icons",{prepend:!0,csp:Re,attachTo:Sn})},[])}},98129:function($t,W,D){"use strict";var ee=D(60690);$t.exports=function(_e){_e=_e||{};var re=_e.reporter,he=ee.getOption(_e,"async",!0),se=ee.getOption(_e,"auto",!0);se&&!he&&(re&&re.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),he=!0);var Se=X(),oe,je=!1;function te(xt,ft){!je&&se&&he&&Se.size()===0&&Te(),Se.add(xt,ft)}function ve(){for(je=!0;Se.size();){var xt=Se;Se=X(),xt.process()}je=!1}function Be(xt){je||(xt===void 0&&(xt=he),oe&&(le(oe),oe=null),xt?Te():ve())}function Te(){oe=Ze(ve)}function we(){Se={},batchSize=0,topLevel=0,bottomLevel=0}function le(xt){var ft=clearTimeout;return ft(xt)}function Ze(xt){var ft=function(Zt){return setTimeout(Zt,0)};return ft(xt)}return{add:te,force:Be}};function X(){var E={},_e=0,re=0,he=0;function se(je,te){te||(te=je,je=0),je>re?re=je:je<he&&(he=je),E[je]||(E[je]=[]),E[je].push(te),_e++}function Se(){for(var je=he;je<=re;je++)for(var te=E[je],ve=0;ve<te.length;ve++){var Be=te[ve];Be()}}function oe(){return _e}return{add:se,process:Se,size:oe}}},60690:function($t){"use strict";var W=$t.exports={};W.getOption=D;function D(ee,X,E){var _e=ee[X];return _e==null&&E!==void 0?E:_e}},8874:function($t){"use strict";$t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function($t,W,D){var ee=D(8874),X=D(86851),E=Object.hasOwnProperty,_e=Object.create(null);for(var re in ee)E.call(ee,re)&&(_e[ee[re]]=re);var he=$t.exports={to:{},get:{}};he.get=function(oe){var je=oe.substring(0,3).toLowerCase(),te,ve;switch(je){case"hsl":te=he.get.hsl(oe),ve="hsl";break;case"hwb":te=he.get.hwb(oe),ve="hwb";break;default:te=he.get.rgb(oe),ve="rgb";break}return te?{model:ve,value:te}:null},he.get.rgb=function(oe){if(!oe)return null;var je=/^#([a-f0-9]{3,4})$/i,te=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,ve=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Be=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Te=/^(\w+)$/,we=[0,0,0,1],le,Ze,xt;if(le=oe.match(te)){for(xt=le[2],le=le[1],Ze=0;Ze<3;Ze++){var ft=Ze*2;we[Ze]=parseInt(le.slice(ft,ft+2),16)}xt&&(we[3]=parseInt(xt,16)/255)}else if(le=oe.match(je)){for(le=le[1],xt=le[3],Ze=0;Ze<3;Ze++)we[Ze]=parseInt(le[Ze]+le[Ze],16);xt&&(we[3]=parseInt(xt+xt,16)/255)}else if(le=oe.match(ve)){for(Ze=0;Ze<3;Ze++)we[Ze]=parseInt(le[Ze+1],0);le[4]&&(le[5]?we[3]=parseFloat(le[4])*.01:we[3]=parseFloat(le[4]))}else if(le=oe.match(Be)){for(Ze=0;Ze<3;Ze++)we[Ze]=Math.round(parseFloat(le[Ze+1])*2.55);le[4]&&(le[5]?we[3]=parseFloat(le[4])*.01:we[3]=parseFloat(le[4]))}else return(le=oe.match(Te))?le[1]==="transparent"?[0,0,0,0]:E.call(ee,le[1])?(we=ee[le[1]],we[3]=1,we):null:null;for(Ze=0;Ze<3;Ze++)we[Ze]=se(we[Ze],0,255);return we[3]=se(we[3],0,1),we},he.get.hsl=function(oe){if(!oe)return null;var je=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,te=oe.match(je);if(te){var ve=parseFloat(te[4]),Be=(parseFloat(te[1])%360+360)%360,Te=se(parseFloat(te[2]),0,100),we=se(parseFloat(te[3]),0,100),le=se(isNaN(ve)?1:ve,0,1);return[Be,Te,we,le]}return null},he.get.hwb=function(oe){if(!oe)return null;var je=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,te=oe.match(je);if(te){var ve=parseFloat(te[4]),Be=(parseFloat(te[1])%360+360)%360,Te=se(parseFloat(te[2]),0,100),we=se(parseFloat(te[3]),0,100),le=se(isNaN(ve)?1:ve,0,1);return[Be,Te,we,le]}return null},he.to.hex=function(){var oe=X(arguments);return"#"+Se(oe[0])+Se(oe[1])+Se(oe[2])+(oe[3]<1?Se(Math.round(oe[3]*255)):"")},he.to.rgb=function(){var oe=X(arguments);return oe.length<4||oe[3]===1?"rgb("+Math.round(oe[0])+", "+Math.round(oe[1])+", "+Math.round(oe[2])+")":"rgba("+Math.round(oe[0])+", "+Math.round(oe[1])+", "+Math.round(oe[2])+", "+oe[3]+")"},he.to.rgb.percent=function(){var oe=X(arguments),je=Math.round(oe[0]/255*100),te=Math.round(oe[1]/255*100),ve=Math.round(oe[2]/255*100);return oe.length<4||oe[3]===1?"rgb("+je+"%, "+te+"%, "+ve+"%)":"rgba("+je+"%, "+te+"%, "+ve+"%, "+oe[3]+")"},he.to.hsl=function(){var oe=X(arguments);return oe.length<4||oe[3]===1?"hsl("+oe[0]+", "+oe[1]+"%, "+oe[2]+"%)":"hsla("+oe[0]+", "+oe[1]+"%, "+oe[2]+"%, "+oe[3]+")"},he.to.hwb=function(){var oe=X(arguments),je="";return oe.length>=4&&oe[3]!==1&&(je=", "+oe[3]),"hwb("+oe[0]+", "+oe[1]+"%, "+oe[2]+"%"+je+")"},he.to.keyword=function(oe){return _e[oe.slice(0,3)]};function se(oe,je,te){return Math.min(Math.max(je,oe),te)}function Se(oe){var je=Math.round(oe).toString(16).toUpperCase();return je.length<2?"0"+je:je}},37620:function($t,W,D){"use strict";D.d(W,{ZP:function(){return Zt},B8:function(){return Re}});function ee(Xe,Rt,_t){Xe.prototype=Rt.prototype=_t,_t.constructor=Xe}function X(Xe,Rt){var _t=Object.create(Xe.prototype);for(var Pe in Rt)_t[Pe]=Rt[Pe];return _t}function E(){}var _e=.7,re=1/_e,he="\\s*([+-]?\\d+)\\s*",se="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Se="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oe=/^#([0-9a-f]{3,8})$/,je=new RegExp("^rgb\\("+[he,he,he]+"\\)$"),te=new RegExp("^rgb\\("+[Se,Se,Se]+"\\)$"),ve=new RegExp("^rgba\\("+[he,he,he,se]+"\\)$"),Be=new RegExp("^rgba\\("+[Se,Se,Se,se]+"\\)$"),Te=new RegExp("^hsl\\("+[se,Se,Se]+"\\)$"),we=new RegExp("^hsla\\("+[se,Se,Se,se]+"\\)$"),le={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ee(E,Zt,{copy:function(Xe){return Object.assign(new this.constructor,this,Xe)},displayable:function(){return this.rgb().displayable()},hex:Ze,formatHex:Ze,formatHsl:xt,formatRgb:ft,toString:ft});function Ze(){return this.rgb().formatHex()}function xt(){return Ot(this).formatHsl()}function ft(){return this.rgb().formatRgb()}function Zt(Xe){var Rt,_t;return Xe=(Xe+"").trim().toLowerCase(),(Rt=oe.exec(Xe))?(_t=Rt[1].length,Rt=parseInt(Rt[1],16),_t===6?pt(Rt):_t===3?new bt(Rt>>8&15|Rt>>4&240,Rt>>4&15|Rt&240,(Rt&15)<<4|Rt&15,1):_t===8?vt(Rt>>24&255,Rt>>16&255,Rt>>8&255,(Rt&255)/255):_t===4?vt(Rt>>12&15|Rt>>8&240,Rt>>8&15|Rt>>4&240,Rt>>4&15|Rt&240,((Rt&15)<<4|Rt&15)/255):null):(Rt=je.exec(Xe))?new bt(Rt[1],Rt[2],Rt[3],1):(Rt=te.exec(Xe))?new bt(Rt[1]*255/100,Rt[2]*255/100,Rt[3]*255/100,1):(Rt=ve.exec(Xe))?vt(Rt[1],Rt[2],Rt[3],Rt[4]):(Rt=Be.exec(Xe))?vt(Rt[1]*255/100,Rt[2]*255/100,Rt[3]*255/100,Rt[4]):(Rt=Te.exec(Xe))?He(Rt[1],Rt[2]/100,Rt[3]/100,1):(Rt=we.exec(Xe))?He(Rt[1],Rt[2]/100,Rt[3]/100,Rt[4]):le.hasOwnProperty(Xe)?pt(le[Xe]):Xe==="transparent"?new bt(NaN,NaN,NaN,0):null}function pt(Xe){return new bt(Xe>>16&255,Xe>>8&255,Xe&255,1)}function vt(Xe,Rt,_t,Pe){return Pe<=0&&(Xe=Rt=_t=NaN),new bt(Xe,Rt,_t,Pe)}function ke(Xe){return Xe instanceof E||(Xe=Zt(Xe)),Xe?(Xe=Xe.rgb(),new bt(Xe.r,Xe.g,Xe.b,Xe.opacity)):new bt}function Re(Xe,Rt,_t,Pe){return arguments.length===1?ke(Xe):new bt(Xe,Rt,_t,Pe==null?1:Pe)}function bt(Xe,Rt,_t,Pe){this.r=+Xe,this.g=+Rt,this.b=+_t,this.opacity=+Pe}ee(bt,Re,X(E,{brighter:function(Xe){return Xe=Xe==null?re:Math.pow(re,Xe),new bt(this.r*Xe,this.g*Xe,this.b*Xe,this.opacity)},darker:function(Xe){return Xe=Xe==null?_e:Math.pow(_e,Xe),new bt(this.r*Xe,this.g*Xe,this.b*Xe,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gt,formatHex:gt,formatRgb:Ct,toString:Ct}));function gt(){return"#"+Sn(this.r)+Sn(this.g)+Sn(this.b)}function Ct(){var Xe=this.opacity;return Xe=isNaN(Xe)?1:Math.max(0,Math.min(1,Xe)),(Xe===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Xe===1?")":", "+Xe+")")}function Sn(Xe){return Xe=Math.max(0,Math.min(255,Math.round(Xe)||0)),(Xe<16?"0":"")+Xe.toString(16)}function He(Xe,Rt,_t,Pe){return Pe<=0?Xe=Rt=_t=NaN:_t<=0||_t>=1?Xe=Rt=NaN:Rt<=0&&(Xe=NaN),new ot(Xe,Rt,_t,Pe)}function Ot(Xe){if(Xe instanceof ot)return new ot(Xe.h,Xe.s,Xe.l,Xe.opacity);if(Xe instanceof E||(Xe=Zt(Xe)),!Xe)return new ot;if(Xe instanceof ot)return Xe;Xe=Xe.rgb();var Rt=Xe.r/255,_t=Xe.g/255,Pe=Xe.b/255,Wt=Math.min(Rt,_t,Pe),on=Math.max(Rt,_t,Pe),Nn=NaN,jn=on-Wt,lr=(on+Wt)/2;return jn?(Rt===on?Nn=(_t-Pe)/jn+(_t<Pe)*6:_t===on?Nn=(Pe-Rt)/jn+2:Nn=(Rt-_t)/jn+4,jn/=lr<.5?on+Wt:2-on-Wt,Nn*=60):jn=lr>0&&lr<1?0:Nn,new ot(Nn,jn,lr,Xe.opacity)}function Ce(Xe,Rt,_t,Pe){return arguments.length===1?Ot(Xe):new ot(Xe,Rt,_t,Pe==null?1:Pe)}function ot(Xe,Rt,_t,Pe){this.h=+Xe,this.s=+Rt,this.l=+_t,this.opacity=+Pe}ee(ot,Ce,X(E,{brighter:function(Xe){return Xe=Xe==null?re:Math.pow(re,Xe),new ot(this.h,this.s,this.l*Xe,this.opacity)},darker:function(Xe){return Xe=Xe==null?_e:Math.pow(_e,Xe),new ot(this.h,this.s,this.l*Xe,this.opacity)},rgb:function(){var Xe=this.h%360+(this.h<0)*360,Rt=isNaN(Xe)||isNaN(this.s)?0:this.s,_t=this.l,Pe=_t+(_t<.5?_t:1-_t)*Rt,Wt=2*_t-Pe;return new bt($e(Xe>=240?Xe-240:Xe+120,Wt,Pe),$e(Xe,Wt,Pe),$e(Xe<120?Xe+240:Xe-120,Wt,Pe),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Xe=this.opacity;return Xe=isNaN(Xe)?1:Math.max(0,Math.min(1,Xe)),(Xe===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(Xe===1?")":", "+Xe+")")}}));function $e(Xe,Rt,_t){return(Xe<60?Rt+(_t-Rt)*Xe/60:Xe<180?_t:Xe<240?Rt+(_t-Rt)*(240-Xe)/60:Rt)*255}},9187:function($t){"use strict";$t.exports=W,$t.exports.default=W;function W(Ce,ot,$e){$e=$e||2;var Xe=ot&&ot.length,Rt=Xe?ot[0]*$e:Ce.length,_t=D(Ce,0,Rt,$e,!0),Pe=[];if(!_t||_t.next===_t.prev)return Pe;var Wt,on,Nn,jn,lr,Vt,en;if(Xe&&(_t=se(Ce,ot,_t,$e)),Ce.length>80*$e){Wt=Nn=Ce[0],on=jn=Ce[1];for(var xn=$e;xn<Rt;xn+=$e)lr=Ce[xn],Vt=Ce[xn+1],lr<Wt&&(Wt=lr),Vt<on&&(on=Vt),lr>Nn&&(Nn=lr),Vt>jn&&(jn=Vt);en=Math.max(Nn-Wt,jn-on),en=en!==0?32767/en:0}return X(_t,Pe,$e,Wt,on,en,0),Pe}function D(Ce,ot,$e,Xe,Rt){var _t,Pe;if(Rt===Ot(Ce,ot,$e,Xe)>0)for(_t=ot;_t<$e;_t+=Xe)Pe=Ct(_t,Ce[_t],Ce[_t+1],Pe);else for(_t=$e-Xe;_t>=ot;_t-=Xe)Pe=Ct(_t,Ce[_t],Ce[_t+1],Pe);return Pe&&ft(Pe,Pe.next)&&(Sn(Pe),Pe=Pe.next),Pe}function ee(Ce,ot){if(!Ce)return Ce;ot||(ot=Ce);var $e=Ce,Xe;do if(Xe=!1,!$e.steiner&&(ft($e,$e.next)||xt($e.prev,$e,$e.next)===0)){if(Sn($e),$e=ot=$e.prev,$e===$e.next)break;Xe=!0}else $e=$e.next;while(Xe||$e!==ot);return ot}function X(Ce,ot,$e,Xe,Rt,_t,Pe){if(Ce){!Pe&&_t&&ve(Ce,Xe,Rt,_t);for(var Wt=Ce,on,Nn;Ce.prev!==Ce.next;){if(on=Ce.prev,Nn=Ce.next,_t?_e(Ce,Xe,Rt,_t):E(Ce)){ot.push(on.i/$e|0),ot.push(Ce.i/$e|0),ot.push(Nn.i/$e|0),Sn(Ce),Ce=Nn.next,Wt=Nn.next;continue}if(Ce=Nn,Ce===Wt){Pe?Pe===1?(Ce=re(ee(Ce),ot,$e),X(Ce,ot,$e,Xe,Rt,_t,2)):Pe===2&&he(Ce,ot,$e,Xe,Rt,_t):X(ee(Ce),ot,$e,Xe,Rt,_t,1);break}}}}function E(Ce){var ot=Ce.prev,$e=Ce,Xe=Ce.next;if(xt(ot,$e,Xe)>=0)return!1;for(var Rt=ot.x,_t=$e.x,Pe=Xe.x,Wt=ot.y,on=$e.y,Nn=Xe.y,jn=Rt<_t?Rt<Pe?Rt:Pe:_t<Pe?_t:Pe,lr=Wt<on?Wt<Nn?Wt:Nn:on<Nn?on:Nn,Vt=Rt>_t?Rt>Pe?Rt:Pe:_t>Pe?_t:Pe,en=Wt>on?Wt>Nn?Wt:Nn:on>Nn?on:Nn,xn=Xe.next;xn!==ot;){if(xn.x>=jn&&xn.x<=Vt&&xn.y>=lr&&xn.y<=en&&le(Rt,Wt,_t,on,Pe,Nn,xn.x,xn.y)&&xt(xn.prev,xn,xn.next)>=0)return!1;xn=xn.next}return!0}function _e(Ce,ot,$e,Xe){var Rt=Ce.prev,_t=Ce,Pe=Ce.next;if(xt(Rt,_t,Pe)>=0)return!1;for(var Wt=Rt.x,on=_t.x,Nn=Pe.x,jn=Rt.y,lr=_t.y,Vt=Pe.y,en=Wt<on?Wt<Nn?Wt:Nn:on<Nn?on:Nn,xn=jn<lr?jn<Vt?jn:Vt:lr<Vt?lr:Vt,er=Wt>on?Wt>Nn?Wt:Nn:on>Nn?on:Nn,sn=jn>lr?jn>Vt?jn:Vt:lr>Vt?lr:Vt,Ut=Te(en,xn,ot,$e,Xe),Dt=Te(er,sn,ot,$e,Xe),Me=Ce.prevZ,Qe=Ce.nextZ;Me&&Me.z>=Ut&&Qe&&Qe.z<=Dt;){if(Me.x>=en&&Me.x<=er&&Me.y>=xn&&Me.y<=sn&&Me!==Rt&&Me!==Pe&&le(Wt,jn,on,lr,Nn,Vt,Me.x,Me.y)&&xt(Me.prev,Me,Me.next)>=0||(Me=Me.prevZ,Qe.x>=en&&Qe.x<=er&&Qe.y>=xn&&Qe.y<=sn&&Qe!==Rt&&Qe!==Pe&&le(Wt,jn,on,lr,Nn,Vt,Qe.x,Qe.y)&&xt(Qe.prev,Qe,Qe.next)>=0))return!1;Qe=Qe.nextZ}for(;Me&&Me.z>=Ut;){if(Me.x>=en&&Me.x<=er&&Me.y>=xn&&Me.y<=sn&&Me!==Rt&&Me!==Pe&&le(Wt,jn,on,lr,Nn,Vt,Me.x,Me.y)&&xt(Me.prev,Me,Me.next)>=0)return!1;Me=Me.prevZ}for(;Qe&&Qe.z<=Dt;){if(Qe.x>=en&&Qe.x<=er&&Qe.y>=xn&&Qe.y<=sn&&Qe!==Rt&&Qe!==Pe&&le(Wt,jn,on,lr,Nn,Vt,Qe.x,Qe.y)&&xt(Qe.prev,Qe,Qe.next)>=0)return!1;Qe=Qe.nextZ}return!0}function re(Ce,ot,$e){var Xe=Ce;do{var Rt=Xe.prev,_t=Xe.next.next;!ft(Rt,_t)&&Zt(Rt,Xe,Xe.next,_t)&&Re(Rt,_t)&&Re(_t,Rt)&&(ot.push(Rt.i/$e|0),ot.push(Xe.i/$e|0),ot.push(_t.i/$e|0),Sn(Xe),Sn(Xe.next),Xe=Ce=_t),Xe=Xe.next}while(Xe!==Ce);return ee(Xe)}function he(Ce,ot,$e,Xe,Rt,_t){var Pe=Ce;do{for(var Wt=Pe.next.next;Wt!==Pe.prev;){if(Pe.i!==Wt.i&&Ze(Pe,Wt)){var on=gt(Pe,Wt);Pe=ee(Pe,Pe.next),on=ee(on,on.next),X(Pe,ot,$e,Xe,Rt,_t,0),X(on,ot,$e,Xe,Rt,_t,0);return}Wt=Wt.next}Pe=Pe.next}while(Pe!==Ce)}function se(Ce,ot,$e,Xe){var Rt=[],_t,Pe,Wt,on,Nn;for(_t=0,Pe=ot.length;_t<Pe;_t++)Wt=ot[_t]*Xe,on=_t<Pe-1?ot[_t+1]*Xe:Ce.length,Nn=D(Ce,Wt,on,Xe,!1),Nn===Nn.next&&(Nn.steiner=!0),Rt.push(we(Nn));for(Rt.sort(Se),_t=0;_t<Rt.length;_t++)$e=oe(Rt[_t],$e);return $e}function Se(Ce,ot){return Ce.x-ot.x}function oe(Ce,ot){var $e=je(Ce,ot);if(!$e)return ot;var Xe=gt($e,Ce);return ee(Xe,Xe.next),ee($e,$e.next)}function je(Ce,ot){var $e=ot,Xe=Ce.x,Rt=Ce.y,_t=-1/0,Pe;do{if(Rt<=$e.y&&Rt>=$e.next.y&&$e.next.y!==$e.y){var Wt=$e.x+(Rt-$e.y)*($e.next.x-$e.x)/($e.next.y-$e.y);if(Wt<=Xe&&Wt>_t&&(_t=Wt,Pe=$e.x<$e.next.x?$e:$e.next,Wt===Xe))return Pe}$e=$e.next}while($e!==ot);if(!Pe)return null;var on=Pe,Nn=Pe.x,jn=Pe.y,lr=1/0,Vt;$e=Pe;do Xe>=$e.x&&$e.x>=Nn&&Xe!==$e.x&&le(Rt<jn?Xe:_t,Rt,Nn,jn,Rt<jn?_t:Xe,Rt,$e.x,$e.y)&&(Vt=Math.abs(Rt-$e.y)/(Xe-$e.x),Re($e,Ce)&&(Vt<lr||Vt===lr&&($e.x>Pe.x||$e.x===Pe.x&&te(Pe,$e)))&&(Pe=$e,lr=Vt)),$e=$e.next;while($e!==on);return Pe}function te(Ce,ot){return xt(Ce.prev,Ce,ot.prev)<0&&xt(ot.next,Ce,Ce.next)<0}function ve(Ce,ot,$e,Xe){var Rt=Ce;do Rt.z===0&&(Rt.z=Te(Rt.x,Rt.y,ot,$e,Xe)),Rt.prevZ=Rt.prev,Rt.nextZ=Rt.next,Rt=Rt.next;while(Rt!==Ce);Rt.prevZ.nextZ=null,Rt.prevZ=null,Be(Rt)}function Be(Ce){var ot,$e,Xe,Rt,_t,Pe,Wt,on,Nn=1;do{for($e=Ce,Ce=null,_t=null,Pe=0;$e;){for(Pe++,Xe=$e,Wt=0,ot=0;ot<Nn&&(Wt++,Xe=Xe.nextZ,!!Xe);ot++);for(on=Nn;Wt>0||on>0&&Xe;)Wt!==0&&(on===0||!Xe||$e.z<=Xe.z)?(Rt=$e,$e=$e.nextZ,Wt--):(Rt=Xe,Xe=Xe.nextZ,on--),_t?_t.nextZ=Rt:Ce=Rt,Rt.prevZ=_t,_t=Rt;$e=Xe}_t.nextZ=null,Nn*=2}while(Pe>1);return Ce}function Te(Ce,ot,$e,Xe,Rt){return Ce=(Ce-$e)*Rt|0,ot=(ot-Xe)*Rt|0,Ce=(Ce|Ce<<8)&16711935,Ce=(Ce|Ce<<4)&252645135,Ce=(Ce|Ce<<2)&858993459,Ce=(Ce|Ce<<1)&1431655765,ot=(ot|ot<<8)&16711935,ot=(ot|ot<<4)&252645135,ot=(ot|ot<<2)&858993459,ot=(ot|ot<<1)&1431655765,Ce|ot<<1}function we(Ce){var ot=Ce,$e=Ce;do(ot.x<$e.x||ot.x===$e.x&&ot.y<$e.y)&&($e=ot),ot=ot.next;while(ot!==Ce);return $e}function le(Ce,ot,$e,Xe,Rt,_t,Pe,Wt){return(Rt-Pe)*(ot-Wt)>=(Ce-Pe)*(_t-Wt)&&(Ce-Pe)*(Xe-Wt)>=($e-Pe)*(ot-Wt)&&($e-Pe)*(_t-Wt)>=(Rt-Pe)*(Xe-Wt)}function Ze(Ce,ot){return Ce.next.i!==ot.i&&Ce.prev.i!==ot.i&&!ke(Ce,ot)&&(Re(Ce,ot)&&Re(ot,Ce)&&bt(Ce,ot)&&(xt(Ce.prev,Ce,ot.prev)||xt(Ce,ot.prev,ot))||ft(Ce,ot)&&xt(Ce.prev,Ce,Ce.next)>0&&xt(ot.prev,ot,ot.next)>0)}function xt(Ce,ot,$e){return(ot.y-Ce.y)*($e.x-ot.x)-(ot.x-Ce.x)*($e.y-ot.y)}function ft(Ce,ot){return Ce.x===ot.x&&Ce.y===ot.y}function Zt(Ce,ot,$e,Xe){var Rt=vt(xt(Ce,ot,$e)),_t=vt(xt(Ce,ot,Xe)),Pe=vt(xt($e,Xe,Ce)),Wt=vt(xt($e,Xe,ot));return!!(Rt!==_t&&Pe!==Wt||Rt===0&&pt(Ce,$e,ot)||_t===0&&pt(Ce,Xe,ot)||Pe===0&&pt($e,Ce,Xe)||Wt===0&&pt($e,ot,Xe))}function pt(Ce,ot,$e){return ot.x<=Math.max(Ce.x,$e.x)&&ot.x>=Math.min(Ce.x,$e.x)&&ot.y<=Math.max(Ce.y,$e.y)&&ot.y>=Math.min(Ce.y,$e.y)}function vt(Ce){return Ce>0?1:Ce<0?-1:0}function ke(Ce,ot){var $e=Ce;do{if($e.i!==Ce.i&&$e.next.i!==Ce.i&&$e.i!==ot.i&&$e.next.i!==ot.i&&Zt($e,$e.next,Ce,ot))return!0;$e=$e.next}while($e!==Ce);return!1}function Re(Ce,ot){return xt(Ce.prev,Ce,Ce.next)<0?xt(Ce,ot,Ce.next)>=0&&xt(Ce,Ce.prev,ot)>=0:xt(Ce,ot,Ce.prev)<0||xt(Ce,Ce.next,ot)<0}function bt(Ce,ot){var $e=Ce,Xe=!1,Rt=(Ce.x+ot.x)/2,_t=(Ce.y+ot.y)/2;do $e.y>_t!=$e.next.y>_t&&$e.next.y!==$e.y&&Rt<($e.next.x-$e.x)*(_t-$e.y)/($e.next.y-$e.y)+$e.x&&(Xe=!Xe),$e=$e.next;while($e!==Ce);return Xe}function gt(Ce,ot){var $e=new He(Ce.i,Ce.x,Ce.y),Xe=new He(ot.i,ot.x,ot.y),Rt=Ce.next,_t=ot.prev;return Ce.next=ot,ot.prev=Ce,$e.next=Rt,Rt.prev=$e,Xe.next=$e,$e.prev=Xe,_t.next=Xe,Xe.prev=_t,Xe}function Ct(Ce,ot,$e,Xe){var Rt=new He(Ce,ot,$e);return Xe?(Rt.next=Xe.next,Rt.prev=Xe,Xe.next.prev=Rt,Xe.next=Rt):(Rt.prev=Rt,Rt.next=Rt),Rt}function Sn(Ce){Ce.next.prev=Ce.prev,Ce.prev.next=Ce.next,Ce.prevZ&&(Ce.prevZ.nextZ=Ce.nextZ),Ce.nextZ&&(Ce.nextZ.prevZ=Ce.prevZ)}function He(Ce,ot,$e){this.i=Ce,this.x=ot,this.y=$e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}W.deviation=function(Ce,ot,$e,Xe){var Rt=ot&&ot.length,_t=Rt?ot[0]*$e:Ce.length,Pe=Math.abs(Ot(Ce,0,_t,$e));if(Rt)for(var Wt=0,on=ot.length;Wt<on;Wt++){var Nn=ot[Wt]*$e,jn=Wt<on-1?ot[Wt+1]*$e:Ce.length;Pe-=Math.abs(Ot(Ce,Nn,jn,$e))}var lr=0;for(Wt=0;Wt<Xe.length;Wt+=3){var Vt=Xe[Wt]*$e,en=Xe[Wt+1]*$e,xn=Xe[Wt+2]*$e;lr+=Math.abs((Ce[Vt]-Ce[xn])*(Ce[en+1]-Ce[Vt+1])-(Ce[Vt]-Ce[en])*(Ce[xn+1]-Ce[Vt+1]))}return Pe===0&&lr===0?0:Math.abs((lr-Pe)/Pe)};function Ot(Ce,ot,$e,Xe){for(var Rt=0,_t=ot,Pe=$e-Xe;_t<$e;_t+=Xe)Rt+=(Ce[Pe]-Ce[_t])*(Ce[_t+1]+Ce[Pe+1]),Pe=_t;return Rt}W.flatten=function(Ce){for(var ot=Ce[0][0].length,$e={vertices:[],holes:[],dimensions:ot},Xe=0,Rt=0;Rt<Ce.length;Rt++){for(var _t=0;_t<Ce[Rt].length;_t++)for(var Pe=0;Pe<ot;Pe++)$e.vertices.push(Ce[Rt][_t][Pe]);Rt>0&&(Xe+=Ce[Rt-1].length,$e.holes.push(Xe))}return $e}},2268:function($t){"use strict";var W=$t.exports={};W.isIE=function(D){function ee(){var E=navigator.userAgent.toLowerCase();return E.indexOf("msie")!==-1||E.indexOf("trident")!==-1||E.indexOf(" edge/")!==-1}if(!ee())return!1;if(!D)return!0;var X=function(){var E,_e=3,re=document.createElement("div"),he=re.getElementsByTagName("i");do re.innerHTML="<!--[if gt IE "+ ++_e+"]><i></i><![endif]-->";while(he[0]);return _e>4?_e:E}();return D===X},W.isLegacyOpera=function(){return!!window.opera}},17900:function($t){"use strict";var W=$t.exports={};W.forEach=function(D,ee){for(var X=0;X<D.length;X++){var E=ee(D[X]);if(E)return E}}},58229:function($t,W,D){"use strict";var ee=D(2268);$t.exports=function(X){X=X||{};var E=X.reporter,_e=X.batchProcessor,re=X.stateHandler.getState;if(!E)throw new Error("Missing required dependency: reporter.");function he(te,ve){function Be(){ve(te)}if(ee.isIE(8))re(te).object={proxy:Be},te.attachEvent("onresize",Be);else{var Te=oe(te);if(!Te)throw new Error("Element is not detectable by this strategy.");Te.contentDocument.defaultView.addEventListener("resize",Be)}}function se(te){var ve=X.important?" !important; ":"; ";return(te.join(ve)+ve).trim()}function Se(te,ve,Be){Be||(Be=ve,ve=te,te=null),te=te||{};var Te=te.debug;function we(le,Ze){var xt=se(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),ft=!1,Zt=window.getComputedStyle(le),pt=le.offsetWidth,vt=le.offsetHeight;re(le).startSize={width:pt,height:vt};function ke(){function Re(){if(Zt.position==="static"){le.style.setProperty("position","relative",te.important?"important":"");var Ct=function(Sn,He,Ot,Ce){function ot(Xe){return Xe.replace(/[^-\d\.]/g,"")}var $e=Ot[Ce];$e!=="auto"&&ot($e)!=="0"&&(Sn.warn("An element that is positioned static has style."+Ce+"="+$e+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Ce+" will be set to 0. Element: ",He),He.style.setProperty(Ce,"0",te.important?"important":""))};Ct(E,le,Zt,"top"),Ct(E,le,Zt,"right"),Ct(E,le,Zt,"bottom"),Ct(E,le,Zt,"left")}}function bt(){ft||Re();function Ct(He,Ot){if(!He.contentDocument){var Ce=re(He);Ce.checkForObjectDocumentTimeoutId&&window.clearTimeout(Ce.checkForObjectDocumentTimeoutId),Ce.checkForObjectDocumentTimeoutId=setTimeout(function(){Ce.checkForObjectDocumentTimeoutId=0,Ct(He,Ot)},100);return}Ot(He.contentDocument)}var Sn=this;Ct(Sn,function(Ot){Ze(le)})}Zt.position!==""&&(Re(Zt),ft=!0);var gt=document.createElement("object");gt.style.cssText=xt,gt.tabIndex=-1,gt.type="text/html",gt.setAttribute("aria-hidden","true"),gt.onload=bt,ee.isIE()||(gt.data="about:blank"),re(le)&&(le.appendChild(gt),re(le).object=gt,ee.isIE()&&(gt.data="about:blank"))}_e?_e.add(ke):ke()}ee.isIE(8)?Be(ve):we(ve,Be)}function oe(te){return re(te).object}function je(te){if(re(te)){var ve=oe(te);ve&&(ee.isIE(8)?te.detachEvent("onresize",ve.proxy):te.removeChild(ve),re(te).checkForObjectDocumentTimeoutId&&window.clearTimeout(re(te).checkForObjectDocumentTimeoutId),delete re(te).object)}}return{makeDetectable:Se,addListener:he,uninstall:je}}},60787:function($t,W,D){"use strict";var ee=D(17900).forEach;$t.exports=function(X){X=X||{};var E=X.reporter,_e=X.batchProcessor,re=X.stateHandler.getState,he=X.stateHandler.hasState,se=X.idHandler;if(!_e)throw new Error("Missing required dependency: batchProcessor");if(!E)throw new Error("Missing required dependency: reporter.");var Se=Be(),oe="erd_scroll_detection_scrollbar_style",je="erd_scroll_detection_container";function te(ke){Te(ke,oe,je)}te(window.document);function ve(ke){var Re=X.important?" !important; ":"; ";return(ke.join(Re)+Re).trim()}function Be(){var ke=500,Re=500,bt=document.createElement("div");bt.style.cssText=ve(["position: absolute","width: "+ke*2+"px","height: "+Re*2+"px","visibility: hidden","margin: 0","padding: 0"]);var gt=document.createElement("div");gt.style.cssText=ve(["position: absolute","width: "+ke+"px","height: "+Re+"px","overflow: scroll","visibility: none","top: "+-ke*3+"px","left: "+-Re*3+"px","visibility: hidden","margin: 0","padding: 0"]),gt.appendChild(bt),document.body.insertBefore(gt,document.body.firstChild);var Ct=ke-gt.clientWidth,Sn=Re-gt.clientHeight;return document.body.removeChild(gt),{width:Ct,height:Sn}}function Te(ke,Re,bt){function gt(Ot,Ce){Ce=Ce||function($e){ke.head.appendChild($e)};var ot=ke.createElement("style");return ot.innerHTML=Ot,ot.id=Re,Ce(ot),ot}if(!ke.getElementById(Re)){var Ct=bt+"_animation",Sn=bt+"_animation_active",He=`/* Created by the element-resize-detector library. */
`;He+="."+bt+" > div::-webkit-scrollbar { "+ve(["display: none"])+` }

`,He+="."+Sn+" { "+ve(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+Ct,"animation-name: "+Ct])+` }
`,He+="@-webkit-keyframes "+Ct+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,He+="@keyframes "+Ct+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",gt(He)}}function we(ke){ke.className+=" "+je+"_animation_active"}function le(ke,Re,bt){if(ke.addEventListener)ke.addEventListener(Re,bt);else if(ke.attachEvent)ke.attachEvent("on"+Re,bt);else return E.error("[scroll] Don't know how to add event listeners.")}function Ze(ke,Re,bt){if(ke.removeEventListener)ke.removeEventListener(Re,bt);else if(ke.detachEvent)ke.detachEvent("on"+Re,bt);else return E.error("[scroll] Don't know how to remove event listeners.")}function xt(ke){return re(ke).container.childNodes[0].childNodes[0].childNodes[0]}function ft(ke){return re(ke).container.childNodes[0].childNodes[0].childNodes[1]}function Zt(ke,Re){var bt=re(ke).listeners;if(!bt.push)throw new Error("Cannot add listener to an element that is not detectable.");re(ke).listeners.push(Re)}function pt(ke,Re,bt){bt||(bt=Re,Re=ke,ke=null),ke=ke||{};function gt(){if(ke.debug){var Ut=Array.prototype.slice.call(arguments);if(Ut.unshift(se.get(Re),"Scroll: "),E.log.apply)E.log.apply(null,Ut);else for(var Dt=0;Dt<Ut.length;Dt++)E.log(Ut[Dt])}}function Ct(Ut){function Dt(Me){var Qe=Me.getRootNode&&Me.getRootNode().contains(Me);return Me===Me.ownerDocument.body||Me.ownerDocument.body.contains(Me)||Qe}return!Dt(Ut)||window.getComputedStyle(Ut)===null}function Sn(Ut){var Dt=re(Ut).container.childNodes[0],Me=window.getComputedStyle(Dt);return!Me.width||Me.width.indexOf("px")===-1}function He(){var Ut=window.getComputedStyle(Re),Dt={};return Dt.position=Ut.position,Dt.width=Re.offsetWidth,Dt.height=Re.offsetHeight,Dt.top=Ut.top,Dt.right=Ut.right,Dt.bottom=Ut.bottom,Dt.left=Ut.left,Dt.widthCSS=Ut.width,Dt.heightCSS=Ut.height,Dt}function Ot(){var Ut=He();re(Re).startSize={width:Ut.width,height:Ut.height},gt("Element start size",re(Re).startSize)}function Ce(){re(Re).listeners=[]}function ot(){if(gt("storeStyle invoked."),!re(Re)){gt("Aborting because element has been uninstalled");return}var Ut=He();re(Re).style=Ut}function $e(Ut,Dt,Me){re(Ut).lastWidth=Dt,re(Ut).lastHeight=Me}function Xe(Ut){return xt(Ut).childNodes[0]}function Rt(){return 2*Se.width+1}function _t(){return 2*Se.height+1}function Pe(Ut){return Ut+10+Rt()}function Wt(Ut){return Ut+10+_t()}function on(Ut){return Ut*2+Rt()}function Nn(Ut){return Ut*2+_t()}function jn(Ut,Dt,Me){var Qe=xt(Ut),Ft=ft(Ut),U=Pe(Dt),ue=Wt(Me),at=on(Dt),ce=Nn(Me);Qe.scrollLeft=U,Qe.scrollTop=ue,Ft.scrollLeft=at,Ft.scrollTop=ce}function lr(){var Ut=re(Re).container;if(!Ut){Ut=document.createElement("div"),Ut.className=je,Ut.style.cssText=ve(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),re(Re).container=Ut,we(Ut),Re.appendChild(Ut);var Dt=function(){re(Re).onRendered&&re(Re).onRendered()};le(Ut,"animationstart",Dt),re(Re).onAnimationStart=Dt}return Ut}function Vt(){function Ut(){var Ln=re(Re).style;if(Ln.position==="static"){Re.style.setProperty("position","relative",ke.important?"important":"");var Gn=function(dt,ye,Fe,nt){function Pt(Tn){return Tn.replace(/[^-\d\.]/g,"")}var Mt=Fe[nt];Mt!=="auto"&&Pt(Mt)!=="0"&&(dt.warn("An element that is positioned static has style."+nt+"="+Mt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+nt+" will be set to 0. Element: ",ye),ye.style[nt]=0)};Gn(E,Re,Ln,"top"),Gn(E,Re,Ln,"right"),Gn(E,Re,Ln,"bottom"),Gn(E,Re,Ln,"left")}}function Dt(Ln,Gn,dt,ye){return Ln=Ln?Ln+"px":"0",Gn=Gn?Gn+"px":"0",dt=dt?dt+"px":"0",ye=ye?ye+"px":"0",["left: "+Ln,"top: "+Gn,"right: "+ye,"bottom: "+dt]}if(gt("Injecting elements"),!re(Re)){gt("Aborting because element has been uninstalled");return}Ut();var Me=re(Re).container;Me||(Me=lr());var Qe=Se.width,Ft=Se.height,U=ve(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),ue=ve(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(Dt(-(1+Qe),-(1+Ft),-Ft,-Qe))),at=ve(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ce=ve(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),j=ve(["position: absolute","left: 0","top: 0"]),ln=ve(["position: absolute","width: 200%","height: 200%"]),fn=document.createElement("div"),mt=document.createElement("div"),Gt=document.createElement("div"),Wn=document.createElement("div"),hn=document.createElement("div"),ht=document.createElement("div");fn.dir="ltr",fn.style.cssText=U,fn.className=je,mt.className=je,mt.style.cssText=ue,Gt.style.cssText=at,Wn.style.cssText=j,hn.style.cssText=ce,ht.style.cssText=ln,Gt.appendChild(Wn),hn.appendChild(ht),mt.appendChild(Gt),mt.appendChild(hn),fn.appendChild(mt),Me.appendChild(fn);function Ht(){var Ln=re(Re);Ln&&Ln.onExpand?Ln.onExpand():gt("Aborting expand scroll handler: element has been uninstalled")}function Cn(){var Ln=re(Re);Ln&&Ln.onShrink?Ln.onShrink():gt("Aborting shrink scroll handler: element has been uninstalled")}le(Gt,"scroll",Ht),le(hn,"scroll",Cn),re(Re).onExpandScroll=Ht,re(Re).onShrinkScroll=Cn}function en(){function Ut(at,ce,j){var ln=Xe(at),fn=Pe(ce),mt=Wt(j);ln.style.setProperty("width",fn+"px",ke.important?"important":""),ln.style.setProperty("height",mt+"px",ke.important?"important":"")}function Dt(at){var ce=Re.offsetWidth,j=Re.offsetHeight,ln=ce!==re(Re).lastWidth||j!==re(Re).lastHeight;gt("Storing current size",ce,j),$e(Re,ce,j),_e.add(0,function(){if(ln){if(!re(Re)){gt("Aborting because element has been uninstalled");return}if(!Me()){gt("Aborting because element container has not been initialized");return}if(ke.debug){var mt=Re.offsetWidth,Gt=Re.offsetHeight;(mt!==ce||Gt!==j)&&E.warn(se.get(Re),"Scroll: Size changed before updating detector elements.")}Ut(Re,ce,j)}}),_e.add(1,function(){if(!re(Re)){gt("Aborting because element has been uninstalled");return}if(!Me()){gt("Aborting because element container has not been initialized");return}jn(Re,ce,j)}),ln&&at&&_e.add(2,function(){if(!re(Re)){gt("Aborting because element has been uninstalled");return}if(!Me()){gt("Aborting because element container has not been initialized");return}at()})}function Me(){return!!re(Re).container}function Qe(){function at(){return re(Re).lastNotifiedWidth===void 0}gt("notifyListenersIfNeeded invoked");var ce=re(Re);if(at()&&ce.lastWidth===ce.startSize.width&&ce.lastHeight===ce.startSize.height)return gt("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(ce.lastWidth===ce.lastNotifiedWidth&&ce.lastHeight===ce.lastNotifiedHeight)return gt("Not notifying: Size already notified");gt("Current size not notified, notifying..."),ce.lastNotifiedWidth=ce.lastWidth,ce.lastNotifiedHeight=ce.lastHeight,ee(re(Re).listeners,function(j){j(Re)})}function Ft(){if(gt("startanimation triggered."),Sn(Re)){gt("Ignoring since element is still unrendered...");return}gt("Element rendered.");var at=xt(Re),ce=ft(Re);(at.scrollLeft===0||at.scrollTop===0||ce.scrollLeft===0||ce.scrollTop===0)&&(gt("Scrollbars out of sync. Updating detector elements..."),Dt(Qe))}function U(){if(gt("Scroll detected."),Sn(Re)){gt("Scroll event fired while unrendered. Ignoring...");return}Dt(Qe)}if(gt("registerListenersAndPositionElements invoked."),!re(Re)){gt("Aborting because element has been uninstalled");return}re(Re).onRendered=Ft,re(Re).onExpand=U,re(Re).onShrink=U;var ue=re(Re).style;Ut(Re,ue.width,ue.height)}function xn(){if(gt("finalizeDomMutation invoked."),!re(Re)){gt("Aborting because element has been uninstalled");return}var Ut=re(Re).style;$e(Re,Ut.width,Ut.height),jn(Re,Ut.width,Ut.height)}function er(){bt(Re)}function sn(){gt("Installing..."),Ce(),Ot(),_e.add(0,ot),_e.add(1,Vt),_e.add(2,en),_e.add(3,xn),_e.add(4,er)}gt("Making detectable..."),Ct(Re)?(gt("Element is detached"),lr(),gt("Waiting until element is attached..."),re(Re).onRendered=function(){gt("Element is now attached"),sn()}):sn()}function vt(ke){var Re=re(ke);Re&&(Re.onExpandScroll&&Ze(xt(ke),"scroll",Re.onExpandScroll),Re.onShrinkScroll&&Ze(ft(ke),"scroll",Re.onShrinkScroll),Re.onAnimationStart&&Ze(Re.container,"animationstart",Re.onAnimationStart),Re.container&&ke.removeChild(Re.container))}return{makeDetectable:pt,addListener:Zt,uninstall:vt,initDocument:te}}},63844:function($t,W,D){"use strict";var ee=D(17900).forEach,X=D(68452),E=D(96199),_e=D(75805),re=D(79799),he=D(71724),se=D(2268),Se=D(98129),oe=D(21931),je=D(58229),te=D(60787);function ve(le){return Array.isArray(le)||le.length!==void 0}function Be(le){if(Array.isArray(le))return le;var Ze=[];return ee(le,function(xt){Ze.push(xt)}),Ze}function Te(le){return le&&le.nodeType===1}$t.exports=function(le){le=le||{};var Ze;if(le.idHandler)Ze={get:function(Xe){return le.idHandler.get(Xe,!0)},set:le.idHandler.set};else{var xt=_e(),ft=re({idGenerator:xt,stateHandler:oe});Ze=ft}var Zt=le.reporter;if(!Zt){var pt=Zt===!1;Zt=he(pt)}var vt=we(le,"batchProcessor",Se({reporter:Zt})),ke={};ke.callOnAdd=!!we(le,"callOnAdd",!0),ke.debug=!!we(le,"debug",!1);var Re=E(Ze),bt=X({stateHandler:oe}),gt,Ct=we(le,"strategy","object"),Sn=we(le,"important",!1),He={reporter:Zt,batchProcessor:vt,stateHandler:oe,idHandler:Ze,important:Sn};if(Ct==="scroll"&&(se.isLegacyOpera()?(Zt.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),Ct="object"):se.isIE(9)&&(Zt.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),Ct="object")),Ct==="scroll")gt=te(He);else if(Ct==="object")gt=je(He);else throw new Error("Invalid strategy name: "+Ct);var Ot={};function Ce(Xe,Rt,_t){function Pe(Vt){var en=Re.get(Vt);ee(en,function(er){er(Vt)})}function Wt(Vt,en,xn){Re.add(en,xn),Vt&&xn(en)}if(_t||(_t=Rt,Rt=Xe,Xe={}),!Rt)throw new Error("At least one element required.");if(!_t)throw new Error("Listener required.");if(Te(Rt))Rt=[Rt];else if(ve(Rt))Rt=Be(Rt);else return Zt.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var on=0,Nn=we(Xe,"callOnAdd",ke.callOnAdd),jn=we(Xe,"onReady",function(){}),lr=we(Xe,"debug",ke.debug);ee(Rt,function(en){oe.getState(en)||(oe.initState(en),Ze.set(en));var xn=Ze.get(en);if(lr&&Zt.log("Attaching listener to element",xn,en),!bt.isDetectable(en)){if(lr&&Zt.log(xn,"Not detectable."),bt.isBusy(en)){lr&&Zt.log(xn,"System busy making it detectable"),Wt(Nn,en,_t),Ot[xn]=Ot[xn]||[],Ot[xn].push(function(){on++,on===Rt.length&&jn()});return}return lr&&Zt.log(xn,"Making detectable..."),bt.markBusy(en,!0),gt.makeDetectable({debug:lr,important:Sn},en,function(sn){if(lr&&Zt.log(xn,"onElementDetectable"),oe.getState(sn)){bt.markAsDetectable(sn),bt.markBusy(sn,!1),gt.addListener(sn,Pe),Wt(Nn,sn,_t);var Ut=oe.getState(sn);if(Ut&&Ut.startSize){var Dt=sn.offsetWidth,Me=sn.offsetHeight;(Ut.startSize.width!==Dt||Ut.startSize.height!==Me)&&Pe(sn)}Ot[xn]&&ee(Ot[xn],function(Qe){Qe()})}else lr&&Zt.log(xn,"Element uninstalled before being detectable.");delete Ot[xn],on++,on===Rt.length&&jn()})}lr&&Zt.log(xn,"Already detecable, adding listener."),Wt(Nn,en,_t),on++}),on===Rt.length&&jn()}function ot(Xe){if(!Xe)return Zt.error("At least one element is required.");if(Te(Xe))Xe=[Xe];else if(ve(Xe))Xe=Be(Xe);else return Zt.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");ee(Xe,function(Rt){Re.removeAllListeners(Rt),gt.uninstall(Rt),oe.cleanState(Rt)})}function $e(Xe){gt.initDocument&&gt.initDocument(Xe)}return{listenTo:Ce,removeListener:Re.removeListener,removeAllListeners:Re.removeAllListeners,uninstall:ot,initDocument:$e}};function we(le,Ze,xt){var ft=le[Ze];return ft==null&&xt!==void 0?xt:ft}},68452:function($t){"use strict";$t.exports=function(W){var D=W.stateHandler.getState;function ee(re){var he=D(re);return he&&!!he.isDetectable}function X(re){D(re).isDetectable=!0}function E(re){return!!D(re).busy}function _e(re,he){D(re).busy=!!he}return{isDetectable:ee,markAsDetectable:X,isBusy:E,markBusy:_e}}},75805:function($t){"use strict";$t.exports=function(){var W=1;function D(){return W++}return{generate:D}}},79799:function($t){"use strict";$t.exports=function(W){var D=W.idGenerator,ee=W.stateHandler.getState;function X(_e){var re=ee(_e);return re&&re.id!==void 0?re.id:null}function E(_e){var re=ee(_e);if(!re)throw new Error("setId required the element to have a resize detection state.");var he=D.generate();return re.id=he,he}return{get:X,set:E}}},96199:function($t){"use strict";$t.exports=function(W){var D={};function ee(re){var he=W.get(re);return he===void 0?[]:D[he]||[]}function X(re,he){var se=W.get(re);D[se]||(D[se]=[]),D[se].push(he)}function E(re,he){for(var se=ee(re),Se=0,oe=se.length;Se<oe;++Se)if(se[Se]===he){se.splice(Se,1);break}}function _e(re){var he=ee(re);he&&(he.length=0)}return{get:ee,add:X,removeListener:E,removeAllListeners:_e}}},71724:function($t){"use strict";$t.exports=function(W){function D(){}var ee={log:D,warn:D,error:D};if(!W&&window.console){var X=function(E,_e){E[_e]=function(){var he=console[_e];if(he.apply)he.apply(console,arguments);else for(var se=0;se<arguments.length;se++)he(arguments[se])}};X(ee,"log"),X(ee,"warn"),X(ee,"error")}return ee}},21931:function($t){"use strict";var W="_erd";function D(E){return E[W]={},ee(E)}function ee(E){return E[W]}function X(E){delete E[W]}$t.exports={initState:D,getState:ee,cleanState:X}},26729:function($t){"use strict";var W=Object.prototype.hasOwnProperty,D="~";function ee(){}Object.create&&(ee.prototype=Object.create(null),new ee().__proto__||(D=!1));function X(he,se,Se){this.fn=he,this.context=se,this.once=Se||!1}function E(he,se,Se,oe,je){if(typeof Se!="function")throw new TypeError("The listener must be a function");var te=new X(Se,oe||he,je),ve=D?D+se:se;return he._events[ve]?he._events[ve].fn?he._events[ve]=[he._events[ve],te]:he._events[ve].push(te):(he._events[ve]=te,he._eventsCount++),he}function _e(he,se){--he._eventsCount===0?he._events=new ee:delete he._events[se]}function re(){this._events=new ee,this._eventsCount=0}re.prototype.eventNames=function(){var se=[],Se,oe;if(this._eventsCount===0)return se;for(oe in Se=this._events)W.call(Se,oe)&&se.push(D?oe.slice(1):oe);return Object.getOwnPropertySymbols?se.concat(Object.getOwnPropertySymbols(Se)):se},re.prototype.listeners=function(se){var Se=D?D+se:se,oe=this._events[Se];if(!oe)return[];if(oe.fn)return[oe.fn];for(var je=0,te=oe.length,ve=new Array(te);je<te;je++)ve[je]=oe[je].fn;return ve},re.prototype.listenerCount=function(se){var Se=D?D+se:se,oe=this._events[Se];return oe?oe.fn?1:oe.length:0},re.prototype.emit=function(se,Se,oe,je,te,ve){var Be=D?D+se:se;if(!this._events[Be])return!1;var Te=this._events[Be],we=arguments.length,le,Ze;if(Te.fn){switch(Te.once&&this.removeListener(se,Te.fn,void 0,!0),we){case 1:return Te.fn.call(Te.context),!0;case 2:return Te.fn.call(Te.context,Se),!0;case 3:return Te.fn.call(Te.context,Se,oe),!0;case 4:return Te.fn.call(Te.context,Se,oe,je),!0;case 5:return Te.fn.call(Te.context,Se,oe,je,te),!0;case 6:return Te.fn.call(Te.context,Se,oe,je,te,ve),!0}for(Ze=1,le=new Array(we-1);Ze<we;Ze++)le[Ze-1]=arguments[Ze];Te.fn.apply(Te.context,le)}else{var xt=Te.length,ft;for(Ze=0;Ze<xt;Ze++)switch(Te[Ze].once&&this.removeListener(se,Te[Ze].fn,void 0,!0),we){case 1:Te[Ze].fn.call(Te[Ze].context);break;case 2:Te[Ze].fn.call(Te[Ze].context,Se);break;case 3:Te[Ze].fn.call(Te[Ze].context,Se,oe);break;case 4:Te[Ze].fn.call(Te[Ze].context,Se,oe,je);break;default:if(!le)for(ft=1,le=new Array(we-1);ft<we;ft++)le[ft-1]=arguments[ft];Te[Ze].fn.apply(Te[Ze].context,le)}}return!0},re.prototype.on=function(se,Se,oe){return E(this,se,Se,oe,!1)},re.prototype.once=function(se,Se,oe){return E(this,se,Se,oe,!0)},re.prototype.removeListener=function(se,Se,oe,je){var te=D?D+se:se;if(!this._events[te])return this;if(!Se)return _e(this,te),this;var ve=this._events[te];if(ve.fn)ve.fn===Se&&(!je||ve.once)&&(!oe||ve.context===oe)&&_e(this,te);else{for(var Be=0,Te=[],we=ve.length;Be<we;Be++)(ve[Be].fn!==Se||je&&!ve[Be].once||oe&&ve[Be].context!==oe)&&Te.push(ve[Be]);Te.length?this._events[te]=Te.length===1?Te[0]:Te:_e(this,te)}return this},re.prototype.removeAllListeners=function(se){var Se;return se?(Se=D?D+se:se,this._events[Se]&&_e(this,Se)):(this._events=new ee,this._eventsCount=0),this},re.prototype.off=re.prototype.removeListener,re.prototype.addListener=re.prototype.on,re.prefixed=D,re.EventEmitter=re,$t.exports=re},69916:function($t,W){(function(D,ee){ee(W)})(this,function(D){"use strict";function ee(Be,Te,we,le){le=le||{};var Ze=le.maxIterations||100,xt=le.tolerance||1e-10,ft=Be(Te),Zt=Be(we),pt=we-Te;if(ft*Zt>0)throw"Initial bisect points must have opposite signs";if(ft===0)return Te;if(Zt===0)return we;for(var vt=0;vt<Ze;++vt){pt/=2;var ke=Te+pt,Re=Be(ke);if(Re*ft>=0&&(Te=ke),Math.abs(pt)<xt||Re===0)return ke}return Te+pt}function X(Be){for(var Te=new Array(Be),we=0;we<Be;++we)Te[we]=0;return Te}function E(Be,Te){return X(Be).map(function(){return X(Te)})}function _e(Be,Te){for(var we=0,le=0;le<Be.length;++le)we+=Be[le]*Te[le];return we}function re(Be){return Math.sqrt(_e(Be,Be))}function he(Be,Te,we){for(var le=0;le<Te.length;++le)Be[le]=Te[le]*we}function se(Be,Te,we,le,Ze){for(var xt=0;xt<Be.length;++xt)Be[xt]=Te*we[xt]+le*Ze[xt]}function Se(Be,Te,we){we=we||{};var le=we.maxIterations||Te.length*200,Ze=we.nonZeroDelta||1.05,xt=we.zeroDelta||.001,ft=we.minErrorDelta||1e-6,Zt=we.minErrorDelta||1e-5,pt=we.rho!==void 0?we.rho:1,vt=we.chi!==void 0?we.chi:2,ke=we.psi!==void 0?we.psi:-.5,Re=we.sigma!==void 0?we.sigma:.5,bt,gt=Te.length,Ct=new Array(gt+1);Ct[0]=Te,Ct[0].fx=Be(Te),Ct[0].id=0;for(var Sn=0;Sn<gt;++Sn){var He=Te.slice();He[Sn]=He[Sn]?He[Sn]*Ze:xt,Ct[Sn+1]=He,Ct[Sn+1].fx=Be(He),Ct[Sn+1].id=Sn+1}function Ot(jn){for(var lr=0;lr<jn.length;lr++)Ct[gt][lr]=jn[lr];Ct[gt].fx=jn.fx}for(var Ce=function(jn,lr){return jn.fx-lr.fx},ot=Te.slice(),$e=Te.slice(),Xe=Te.slice(),Rt=Te.slice(),_t=0;_t<le;++_t){if(Ct.sort(Ce),we.history){var Pe=Ct.map(function(jn){var lr=jn.slice();return lr.fx=jn.fx,lr.id=jn.id,lr});Pe.sort(function(jn,lr){return jn.id-lr.id}),we.history.push({x:Ct[0].slice(),fx:Ct[0].fx,simplex:Pe})}for(bt=0,Sn=0;Sn<gt;++Sn)bt=Math.max(bt,Math.abs(Ct[0][Sn]-Ct[1][Sn]));if(Math.abs(Ct[0].fx-Ct[gt].fx)<ft&&bt<Zt)break;for(Sn=0;Sn<gt;++Sn){ot[Sn]=0;for(var Wt=0;Wt<gt;++Wt)ot[Sn]+=Ct[Wt][Sn];ot[Sn]/=gt}var on=Ct[gt];if(se($e,1+pt,ot,-pt,on),$e.fx=Be($e),$e.fx<Ct[0].fx)se(Rt,1+vt,ot,-vt,on),Rt.fx=Be(Rt),Rt.fx<$e.fx?Ot(Rt):Ot($e);else if($e.fx>=Ct[gt-1].fx){var Nn=!1;if($e.fx>on.fx?(se(Xe,1+ke,ot,-ke,on),Xe.fx=Be(Xe),Xe.fx<on.fx?Ot(Xe):Nn=!0):(se(Xe,1-ke*pt,ot,ke*pt,on),Xe.fx=Be(Xe),Xe.fx<$e.fx?Ot(Xe):Nn=!0),Nn){if(Re>=1)break;for(Sn=1;Sn<Ct.length;++Sn)se(Ct[Sn],1-Re,Ct[0],Re,Ct[Sn]),Ct[Sn].fx=Be(Ct[Sn])}}else Ot($e)}return Ct.sort(Ce),{fx:Ct[0].fx,x:Ct[0]}}function oe(Be,Te,we,le,Ze,xt,ft){var Zt=we.fx,pt=_e(we.fxprime,Te),vt=Zt,ke=Zt,Re=pt,bt=0;Ze=Ze||1,xt=xt||1e-6,ft=ft||.1;function gt(Sn,He,Ot){for(var Ce=0;Ce<16;++Ce)if(Ze=(Sn+He)/2,se(le.x,1,we.x,Ze,Te),vt=le.fx=Be(le.x,le.fxprime),Re=_e(le.fxprime,Te),vt>Zt+xt*Ze*pt||vt>=Ot)He=Ze;else{if(Math.abs(Re)<=-ft*pt)return Ze;Re*(He-Sn)>=0&&(He=Sn),Sn=Ze,Ot=vt}return 0}for(var Ct=0;Ct<10;++Ct){if(se(le.x,1,we.x,Ze,Te),vt=le.fx=Be(le.x,le.fxprime),Re=_e(le.fxprime,Te),vt>Zt+xt*Ze*pt||Ct&&vt>=ke)return gt(bt,Ze,ke);if(Math.abs(Re)<=-ft*pt)return Ze;if(Re>=0)return gt(Ze,bt,vt);ke=vt,bt=Ze,Ze*=2}return Ze}function je(Be,Te,we){var le={x:Te.slice(),fx:0,fxprime:Te.slice()},Ze={x:Te.slice(),fx:0,fxprime:Te.slice()},xt=Te.slice(),ft,Zt,pt=1,vt;we=we||{},vt=we.maxIterations||Te.length*20,le.fx=Be(le.x,le.fxprime),ft=le.fxprime.slice(),he(ft,le.fxprime,-1);for(var ke=0;ke<vt;++ke){if(pt=oe(Be,ft,le,Ze,pt),we.history&&we.history.push({x:le.x.slice(),fx:le.fx,fxprime:le.fxprime.slice(),alpha:pt}),!pt)he(ft,le.fxprime,-1);else{se(xt,1,Ze.fxprime,-1,le.fxprime);var Re=_e(le.fxprime,le.fxprime),bt=Math.max(0,_e(xt,Ze.fxprime)/Re);se(ft,bt,ft,-1,Ze.fxprime),Zt=le,le=Ze,Ze=Zt}if(re(le.fxprime)<=1e-5)break}return we.history&&we.history.push({x:le.x.slice(),fx:le.fx,fxprime:le.fxprime.slice(),alpha:pt}),le}function te(Be,Te,we){we=we||{};for(var le=we.maxIterations||Te.length*100,Ze=we.learnRate||.001,xt={x:Te.slice(),fx:0,fxprime:Te.slice()},ft=0;ft<le&&(xt.fx=Be(xt.x,xt.fxprime),we.history&&we.history.push({x:xt.x.slice(),fx:xt.fx,fxprime:xt.fxprime.slice()}),se(xt.x,1,xt.x,-Ze,xt.fxprime),!(re(xt.fxprime)<=1e-5));++ft);return xt}function ve(Be,Te,we){we=we||{};var le={x:Te.slice(),fx:0,fxprime:Te.slice()},Ze={x:Te.slice(),fx:0,fxprime:Te.slice()},xt=we.maxIterations||Te.length*100,ft=we.learnRate||1,Zt=Te.slice(),pt=we.c1||.001,vt=we.c2||.1,ke,Re=[];if(we.history){var bt=Be;Be=function(Ct,Sn){return Re.push(Ct.slice()),bt(Ct,Sn)}}le.fx=Be(le.x,le.fxprime);for(var gt=0;gt<xt&&(he(Zt,le.fxprime,-1),ft=oe(Be,Zt,le,Ze,ft,pt,vt),we.history&&(we.history.push({x:le.x.slice(),fx:le.fx,fxprime:le.fxprime.slice(),functionCalls:Re,learnRate:ft,alpha:ft}),Re=[]),ke=le,le=Ze,Ze=ke,!(ft===0||re(le.fxprime)<1e-5));++gt);return le}D.bisect=ee,D.nelderMead=Se,D.conjugateGradient=je,D.gradientDescent=te,D.gradientDescentLineSearch=ve,D.zeros=X,D.zerosM=E,D.norm2=re,D.weightedSum=se,D.scale=he})},49685:function($t,W,D){"use strict";D.d(W,{Ib:function(){return ee},WT:function(){return X}});var ee=1e-6,X=typeof Float32Array!="undefined"?Float32Array:Array,E=Math.random;function _e(Se){X=Se}var re=Math.PI/180;function he(Se){return Se*re}function se(Se,oe){return Math.abs(Se-oe)<=ee*Math.max(1,Math.abs(Se),Math.abs(oe))}Math.hypot||(Math.hypot=function(){for(var Se=0,oe=arguments.length;oe--;)Se+=arguments[oe]*arguments[oe];return Math.sqrt(Se)})},85975:function($t,W,D){"use strict";D.r(W),D.d(W,{add:function(){return xn},adjoint:function(){return je},clone:function(){return E},copy:function(){return _e},create:function(){return X},determinant:function(){return te},equals:function(){return Me},exactEquals:function(){return Dt},frob:function(){return en},fromQuat:function(){return ot},fromQuat2:function(){return gt},fromRotation:function(){return pt},fromRotationTranslation:function(){return bt},fromRotationTranslationScale:function(){return Ot},fromRotationTranslationScaleOrigin:function(){return Ce},fromScaling:function(){return Zt},fromTranslation:function(){return ft},fromValues:function(){return re},fromXRotation:function(){return vt},fromYRotation:function(){return ke},fromZRotation:function(){return Re},frustum:function(){return $e},getRotation:function(){return He},getScaling:function(){return Sn},getTranslation:function(){return Ct},identity:function(){return se},invert:function(){return oe},lookAt:function(){return jn},mul:function(){return Qe},multiply:function(){return ve},multiplyScalar:function(){return sn},multiplyScalarAndAdd:function(){return Ut},ortho:function(){return on},orthoNO:function(){return Wt},orthoZO:function(){return Nn},perspective:function(){return Rt},perspectiveFromFieldOfView:function(){return Pe},perspectiveNO:function(){return Xe},perspectiveZO:function(){return _t},rotate:function(){return we},rotateX:function(){return le},rotateY:function(){return Ze},rotateZ:function(){return xt},scale:function(){return Te},set:function(){return he},str:function(){return Vt},sub:function(){return Ft},subtract:function(){return er},targetTo:function(){return lr},translate:function(){return Be},transpose:function(){return Se}});var ee=D(49685);function X(){var U=new ee.WT(16);return ee.WT!=Float32Array&&(U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[11]=0,U[12]=0,U[13]=0,U[14]=0),U[0]=1,U[5]=1,U[10]=1,U[15]=1,U}function E(U){var ue=new ee.WT(16);return ue[0]=U[0],ue[1]=U[1],ue[2]=U[2],ue[3]=U[3],ue[4]=U[4],ue[5]=U[5],ue[6]=U[6],ue[7]=U[7],ue[8]=U[8],ue[9]=U[9],ue[10]=U[10],ue[11]=U[11],ue[12]=U[12],ue[13]=U[13],ue[14]=U[14],ue[15]=U[15],ue}function _e(U,ue){return U[0]=ue[0],U[1]=ue[1],U[2]=ue[2],U[3]=ue[3],U[4]=ue[4],U[5]=ue[5],U[6]=ue[6],U[7]=ue[7],U[8]=ue[8],U[9]=ue[9],U[10]=ue[10],U[11]=ue[11],U[12]=ue[12],U[13]=ue[13],U[14]=ue[14],U[15]=ue[15],U}function re(U,ue,at,ce,j,ln,fn,mt,Gt,Wn,hn,ht,Ht,Cn,Ln,Gn){var dt=new ee.WT(16);return dt[0]=U,dt[1]=ue,dt[2]=at,dt[3]=ce,dt[4]=j,dt[5]=ln,dt[6]=fn,dt[7]=mt,dt[8]=Gt,dt[9]=Wn,dt[10]=hn,dt[11]=ht,dt[12]=Ht,dt[13]=Cn,dt[14]=Ln,dt[15]=Gn,dt}function he(U,ue,at,ce,j,ln,fn,mt,Gt,Wn,hn,ht,Ht,Cn,Ln,Gn,dt){return U[0]=ue,U[1]=at,U[2]=ce,U[3]=j,U[4]=ln,U[5]=fn,U[6]=mt,U[7]=Gt,U[8]=Wn,U[9]=hn,U[10]=ht,U[11]=Ht,U[12]=Cn,U[13]=Ln,U[14]=Gn,U[15]=dt,U}function se(U){return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}function Se(U,ue){if(U===ue){var at=ue[1],ce=ue[2],j=ue[3],ln=ue[6],fn=ue[7],mt=ue[11];U[1]=ue[4],U[2]=ue[8],U[3]=ue[12],U[4]=at,U[6]=ue[9],U[7]=ue[13],U[8]=ce,U[9]=ln,U[11]=ue[14],U[12]=j,U[13]=fn,U[14]=mt}else U[0]=ue[0],U[1]=ue[4],U[2]=ue[8],U[3]=ue[12],U[4]=ue[1],U[5]=ue[5],U[6]=ue[9],U[7]=ue[13],U[8]=ue[2],U[9]=ue[6],U[10]=ue[10],U[11]=ue[14],U[12]=ue[3],U[13]=ue[7],U[14]=ue[11],U[15]=ue[15];return U}function oe(U,ue){var at=ue[0],ce=ue[1],j=ue[2],ln=ue[3],fn=ue[4],mt=ue[5],Gt=ue[6],Wn=ue[7],hn=ue[8],ht=ue[9],Ht=ue[10],Cn=ue[11],Ln=ue[12],Gn=ue[13],dt=ue[14],ye=ue[15],Fe=at*mt-ce*fn,nt=at*Gt-j*fn,Pt=at*Wn-ln*fn,Mt=ce*Gt-j*mt,Tn=ce*Wn-ln*mt,$n=j*Wn-ln*Gt,xr=hn*Gn-ht*Ln,qn=hn*dt-Ht*Ln,Ae=hn*ye-Cn*Ln,be=ht*dt-Ht*Gn,Ne=ht*ye-Cn*Gn,et=Ht*ye-Cn*dt,wt=Fe*et-nt*Ne+Pt*be+Mt*Ae-Tn*qn+$n*xr;return wt?(wt=1/wt,U[0]=(mt*et-Gt*Ne+Wn*be)*wt,U[1]=(j*Ne-ce*et-ln*be)*wt,U[2]=(Gn*$n-dt*Tn+ye*Mt)*wt,U[3]=(Ht*Tn-ht*$n-Cn*Mt)*wt,U[4]=(Gt*Ae-fn*et-Wn*qn)*wt,U[5]=(at*et-j*Ae+ln*qn)*wt,U[6]=(dt*Pt-Ln*$n-ye*nt)*wt,U[7]=(hn*$n-Ht*Pt+Cn*nt)*wt,U[8]=(fn*Ne-mt*Ae+Wn*xr)*wt,U[9]=(ce*Ae-at*Ne-ln*xr)*wt,U[10]=(Ln*Tn-Gn*Pt+ye*Fe)*wt,U[11]=(ht*Pt-hn*Tn-Cn*Fe)*wt,U[12]=(mt*qn-fn*be-Gt*xr)*wt,U[13]=(at*be-ce*qn+j*xr)*wt,U[14]=(Gn*nt-Ln*Mt-dt*Fe)*wt,U[15]=(hn*Mt-ht*nt+Ht*Fe)*wt,U):null}function je(U,ue){var at=ue[0],ce=ue[1],j=ue[2],ln=ue[3],fn=ue[4],mt=ue[5],Gt=ue[6],Wn=ue[7],hn=ue[8],ht=ue[9],Ht=ue[10],Cn=ue[11],Ln=ue[12],Gn=ue[13],dt=ue[14],ye=ue[15];return U[0]=mt*(Ht*ye-Cn*dt)-ht*(Gt*ye-Wn*dt)+Gn*(Gt*Cn-Wn*Ht),U[1]=-(ce*(Ht*ye-Cn*dt)-ht*(j*ye-ln*dt)+Gn*(j*Cn-ln*Ht)),U[2]=ce*(Gt*ye-Wn*dt)-mt*(j*ye-ln*dt)+Gn*(j*Wn-ln*Gt),U[3]=-(ce*(Gt*Cn-Wn*Ht)-mt*(j*Cn-ln*Ht)+ht*(j*Wn-ln*Gt)),U[4]=-(fn*(Ht*ye-Cn*dt)-hn*(Gt*ye-Wn*dt)+Ln*(Gt*Cn-Wn*Ht)),U[5]=at*(Ht*ye-Cn*dt)-hn*(j*ye-ln*dt)+Ln*(j*Cn-ln*Ht),U[6]=-(at*(Gt*ye-Wn*dt)-fn*(j*ye-ln*dt)+Ln*(j*Wn-ln*Gt)),U[7]=at*(Gt*Cn-Wn*Ht)-fn*(j*Cn-ln*Ht)+hn*(j*Wn-ln*Gt),U[8]=fn*(ht*ye-Cn*Gn)-hn*(mt*ye-Wn*Gn)+Ln*(mt*Cn-Wn*ht),U[9]=-(at*(ht*ye-Cn*Gn)-hn*(ce*ye-ln*Gn)+Ln*(ce*Cn-ln*ht)),U[10]=at*(mt*ye-Wn*Gn)-fn*(ce*ye-ln*Gn)+Ln*(ce*Wn-ln*mt),U[11]=-(at*(mt*Cn-Wn*ht)-fn*(ce*Cn-ln*ht)+hn*(ce*Wn-ln*mt)),U[12]=-(fn*(ht*dt-Ht*Gn)-hn*(mt*dt-Gt*Gn)+Ln*(mt*Ht-Gt*ht)),U[13]=at*(ht*dt-Ht*Gn)-hn*(ce*dt-j*Gn)+Ln*(ce*Ht-j*ht),U[14]=-(at*(mt*dt-Gt*Gn)-fn*(ce*dt-j*Gn)+Ln*(ce*Gt-j*mt)),U[15]=at*(mt*Ht-Gt*ht)-fn*(ce*Ht-j*ht)+hn*(ce*Gt-j*mt),U}function te(U){var ue=U[0],at=U[1],ce=U[2],j=U[3],ln=U[4],fn=U[5],mt=U[6],Gt=U[7],Wn=U[8],hn=U[9],ht=U[10],Ht=U[11],Cn=U[12],Ln=U[13],Gn=U[14],dt=U[15],ye=ue*fn-at*ln,Fe=ue*mt-ce*ln,nt=ue*Gt-j*ln,Pt=at*mt-ce*fn,Mt=at*Gt-j*fn,Tn=ce*Gt-j*mt,$n=Wn*Ln-hn*Cn,xr=Wn*Gn-ht*Cn,qn=Wn*dt-Ht*Cn,Ae=hn*Gn-ht*Ln,be=hn*dt-Ht*Ln,Ne=ht*dt-Ht*Gn;return ye*Ne-Fe*be+nt*Ae+Pt*qn-Mt*xr+Tn*$n}function ve(U,ue,at){var ce=ue[0],j=ue[1],ln=ue[2],fn=ue[3],mt=ue[4],Gt=ue[5],Wn=ue[6],hn=ue[7],ht=ue[8],Ht=ue[9],Cn=ue[10],Ln=ue[11],Gn=ue[12],dt=ue[13],ye=ue[14],Fe=ue[15],nt=at[0],Pt=at[1],Mt=at[2],Tn=at[3];return U[0]=nt*ce+Pt*mt+Mt*ht+Tn*Gn,U[1]=nt*j+Pt*Gt+Mt*Ht+Tn*dt,U[2]=nt*ln+Pt*Wn+Mt*Cn+Tn*ye,U[3]=nt*fn+Pt*hn+Mt*Ln+Tn*Fe,nt=at[4],Pt=at[5],Mt=at[6],Tn=at[7],U[4]=nt*ce+Pt*mt+Mt*ht+Tn*Gn,U[5]=nt*j+Pt*Gt+Mt*Ht+Tn*dt,U[6]=nt*ln+Pt*Wn+Mt*Cn+Tn*ye,U[7]=nt*fn+Pt*hn+Mt*Ln+Tn*Fe,nt=at[8],Pt=at[9],Mt=at[10],Tn=at[11],U[8]=nt*ce+Pt*mt+Mt*ht+Tn*Gn,U[9]=nt*j+Pt*Gt+Mt*Ht+Tn*dt,U[10]=nt*ln+Pt*Wn+Mt*Cn+Tn*ye,U[11]=nt*fn+Pt*hn+Mt*Ln+Tn*Fe,nt=at[12],Pt=at[13],Mt=at[14],Tn=at[15],U[12]=nt*ce+Pt*mt+Mt*ht+Tn*Gn,U[13]=nt*j+Pt*Gt+Mt*Ht+Tn*dt,U[14]=nt*ln+Pt*Wn+Mt*Cn+Tn*ye,U[15]=nt*fn+Pt*hn+Mt*Ln+Tn*Fe,U}function Be(U,ue,at){var ce=at[0],j=at[1],ln=at[2],fn,mt,Gt,Wn,hn,ht,Ht,Cn,Ln,Gn,dt,ye;return ue===U?(U[12]=ue[0]*ce+ue[4]*j+ue[8]*ln+ue[12],U[13]=ue[1]*ce+ue[5]*j+ue[9]*ln+ue[13],U[14]=ue[2]*ce+ue[6]*j+ue[10]*ln+ue[14],U[15]=ue[3]*ce+ue[7]*j+ue[11]*ln+ue[15]):(fn=ue[0],mt=ue[1],Gt=ue[2],Wn=ue[3],hn=ue[4],ht=ue[5],Ht=ue[6],Cn=ue[7],Ln=ue[8],Gn=ue[9],dt=ue[10],ye=ue[11],U[0]=fn,U[1]=mt,U[2]=Gt,U[3]=Wn,U[4]=hn,U[5]=ht,U[6]=Ht,U[7]=Cn,U[8]=Ln,U[9]=Gn,U[10]=dt,U[11]=ye,U[12]=fn*ce+hn*j+Ln*ln+ue[12],U[13]=mt*ce+ht*j+Gn*ln+ue[13],U[14]=Gt*ce+Ht*j+dt*ln+ue[14],U[15]=Wn*ce+Cn*j+ye*ln+ue[15]),U}function Te(U,ue,at){var ce=at[0],j=at[1],ln=at[2];return U[0]=ue[0]*ce,U[1]=ue[1]*ce,U[2]=ue[2]*ce,U[3]=ue[3]*ce,U[4]=ue[4]*j,U[5]=ue[5]*j,U[6]=ue[6]*j,U[7]=ue[7]*j,U[8]=ue[8]*ln,U[9]=ue[9]*ln,U[10]=ue[10]*ln,U[11]=ue[11]*ln,U[12]=ue[12],U[13]=ue[13],U[14]=ue[14],U[15]=ue[15],U}function we(U,ue,at,ce){var j=ce[0],ln=ce[1],fn=ce[2],mt=Math.hypot(j,ln,fn),Gt,Wn,hn,ht,Ht,Cn,Ln,Gn,dt,ye,Fe,nt,Pt,Mt,Tn,$n,xr,qn,Ae,be,Ne,et,wt,qt;return mt<ee.Ib?null:(mt=1/mt,j*=mt,ln*=mt,fn*=mt,Gt=Math.sin(at),Wn=Math.cos(at),hn=1-Wn,ht=ue[0],Ht=ue[1],Cn=ue[2],Ln=ue[3],Gn=ue[4],dt=ue[5],ye=ue[6],Fe=ue[7],nt=ue[8],Pt=ue[9],Mt=ue[10],Tn=ue[11],$n=j*j*hn+Wn,xr=ln*j*hn+fn*Gt,qn=fn*j*hn-ln*Gt,Ae=j*ln*hn-fn*Gt,be=ln*ln*hn+Wn,Ne=fn*ln*hn+j*Gt,et=j*fn*hn+ln*Gt,wt=ln*fn*hn-j*Gt,qt=fn*fn*hn+Wn,U[0]=ht*$n+Gn*xr+nt*qn,U[1]=Ht*$n+dt*xr+Pt*qn,U[2]=Cn*$n+ye*xr+Mt*qn,U[3]=Ln*$n+Fe*xr+Tn*qn,U[4]=ht*Ae+Gn*be+nt*Ne,U[5]=Ht*Ae+dt*be+Pt*Ne,U[6]=Cn*Ae+ye*be+Mt*Ne,U[7]=Ln*Ae+Fe*be+Tn*Ne,U[8]=ht*et+Gn*wt+nt*qt,U[9]=Ht*et+dt*wt+Pt*qt,U[10]=Cn*et+ye*wt+Mt*qt,U[11]=Ln*et+Fe*wt+Tn*qt,ue!==U&&(U[12]=ue[12],U[13]=ue[13],U[14]=ue[14],U[15]=ue[15]),U)}function le(U,ue,at){var ce=Math.sin(at),j=Math.cos(at),ln=ue[4],fn=ue[5],mt=ue[6],Gt=ue[7],Wn=ue[8],hn=ue[9],ht=ue[10],Ht=ue[11];return ue!==U&&(U[0]=ue[0],U[1]=ue[1],U[2]=ue[2],U[3]=ue[3],U[12]=ue[12],U[13]=ue[13],U[14]=ue[14],U[15]=ue[15]),U[4]=ln*j+Wn*ce,U[5]=fn*j+hn*ce,U[6]=mt*j+ht*ce,U[7]=Gt*j+Ht*ce,U[8]=Wn*j-ln*ce,U[9]=hn*j-fn*ce,U[10]=ht*j-mt*ce,U[11]=Ht*j-Gt*ce,U}function Ze(U,ue,at){var ce=Math.sin(at),j=Math.cos(at),ln=ue[0],fn=ue[1],mt=ue[2],Gt=ue[3],Wn=ue[8],hn=ue[9],ht=ue[10],Ht=ue[11];return ue!==U&&(U[4]=ue[4],U[5]=ue[5],U[6]=ue[6],U[7]=ue[7],U[12]=ue[12],U[13]=ue[13],U[14]=ue[14],U[15]=ue[15]),U[0]=ln*j-Wn*ce,U[1]=fn*j-hn*ce,U[2]=mt*j-ht*ce,U[3]=Gt*j-Ht*ce,U[8]=ln*ce+Wn*j,U[9]=fn*ce+hn*j,U[10]=mt*ce+ht*j,U[11]=Gt*ce+Ht*j,U}function xt(U,ue,at){var ce=Math.sin(at),j=Math.cos(at),ln=ue[0],fn=ue[1],mt=ue[2],Gt=ue[3],Wn=ue[4],hn=ue[5],ht=ue[6],Ht=ue[7];return ue!==U&&(U[8]=ue[8],U[9]=ue[9],U[10]=ue[10],U[11]=ue[11],U[12]=ue[12],U[13]=ue[13],U[14]=ue[14],U[15]=ue[15]),U[0]=ln*j+Wn*ce,U[1]=fn*j+hn*ce,U[2]=mt*j+ht*ce,U[3]=Gt*j+Ht*ce,U[4]=Wn*j-ln*ce,U[5]=hn*j-fn*ce,U[6]=ht*j-mt*ce,U[7]=Ht*j-Gt*ce,U}function ft(U,ue){return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=ue[0],U[13]=ue[1],U[14]=ue[2],U[15]=1,U}function Zt(U,ue){return U[0]=ue[0],U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=ue[1],U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=ue[2],U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}function pt(U,ue,at){var ce=at[0],j=at[1],ln=at[2],fn=Math.hypot(ce,j,ln),mt,Gt,Wn;return fn<ee.Ib?null:(fn=1/fn,ce*=fn,j*=fn,ln*=fn,mt=Math.sin(ue),Gt=Math.cos(ue),Wn=1-Gt,U[0]=ce*ce*Wn+Gt,U[1]=j*ce*Wn+ln*mt,U[2]=ln*ce*Wn-j*mt,U[3]=0,U[4]=ce*j*Wn-ln*mt,U[5]=j*j*Wn+Gt,U[6]=ln*j*Wn+ce*mt,U[7]=0,U[8]=ce*ln*Wn+j*mt,U[9]=j*ln*Wn-ce*mt,U[10]=ln*ln*Wn+Gt,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U)}function vt(U,ue){var at=Math.sin(ue),ce=Math.cos(ue);return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=ce,U[6]=at,U[7]=0,U[8]=0,U[9]=-at,U[10]=ce,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}function ke(U,ue){var at=Math.sin(ue),ce=Math.cos(ue);return U[0]=ce,U[1]=0,U[2]=-at,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=at,U[9]=0,U[10]=ce,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}function Re(U,ue){var at=Math.sin(ue),ce=Math.cos(ue);return U[0]=ce,U[1]=at,U[2]=0,U[3]=0,U[4]=-at,U[5]=ce,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}function bt(U,ue,at){var ce=ue[0],j=ue[1],ln=ue[2],fn=ue[3],mt=ce+ce,Gt=j+j,Wn=ln+ln,hn=ce*mt,ht=ce*Gt,Ht=ce*Wn,Cn=j*Gt,Ln=j*Wn,Gn=ln*Wn,dt=fn*mt,ye=fn*Gt,Fe=fn*Wn;return U[0]=1-(Cn+Gn),U[1]=ht+Fe,U[2]=Ht-ye,U[3]=0,U[4]=ht-Fe,U[5]=1-(hn+Gn),U[6]=Ln+dt,U[7]=0,U[8]=Ht+ye,U[9]=Ln-dt,U[10]=1-(hn+Cn),U[11]=0,U[12]=at[0],U[13]=at[1],U[14]=at[2],U[15]=1,U}function gt(U,ue){var at=new ee.WT(3),ce=-ue[0],j=-ue[1],ln=-ue[2],fn=ue[3],mt=ue[4],Gt=ue[5],Wn=ue[6],hn=ue[7],ht=ce*ce+j*j+ln*ln+fn*fn;return ht>0?(at[0]=(mt*fn+hn*ce+Gt*ln-Wn*j)*2/ht,at[1]=(Gt*fn+hn*j+Wn*ce-mt*ln)*2/ht,at[2]=(Wn*fn+hn*ln+mt*j-Gt*ce)*2/ht):(at[0]=(mt*fn+hn*ce+Gt*ln-Wn*j)*2,at[1]=(Gt*fn+hn*j+Wn*ce-mt*ln)*2,at[2]=(Wn*fn+hn*ln+mt*j-Gt*ce)*2),bt(U,ue,at),U}function Ct(U,ue){return U[0]=ue[12],U[1]=ue[13],U[2]=ue[14],U}function Sn(U,ue){var at=ue[0],ce=ue[1],j=ue[2],ln=ue[4],fn=ue[5],mt=ue[6],Gt=ue[8],Wn=ue[9],hn=ue[10];return U[0]=Math.hypot(at,ce,j),U[1]=Math.hypot(ln,fn,mt),U[2]=Math.hypot(Gt,Wn,hn),U}function He(U,ue){var at=new ee.WT(3);Sn(at,ue);var ce=1/at[0],j=1/at[1],ln=1/at[2],fn=ue[0]*ce,mt=ue[1]*j,Gt=ue[2]*ln,Wn=ue[4]*ce,hn=ue[5]*j,ht=ue[6]*ln,Ht=ue[8]*ce,Cn=ue[9]*j,Ln=ue[10]*ln,Gn=fn+hn+Ln,dt=0;return Gn>0?(dt=Math.sqrt(Gn+1)*2,U[3]=.25*dt,U[0]=(ht-Cn)/dt,U[1]=(Ht-Gt)/dt,U[2]=(mt-Wn)/dt):fn>hn&&fn>Ln?(dt=Math.sqrt(1+fn-hn-Ln)*2,U[3]=(ht-Cn)/dt,U[0]=.25*dt,U[1]=(mt+Wn)/dt,U[2]=(Ht+Gt)/dt):hn>Ln?(dt=Math.sqrt(1+hn-fn-Ln)*2,U[3]=(Ht-Gt)/dt,U[0]=(mt+Wn)/dt,U[1]=.25*dt,U[2]=(ht+Cn)/dt):(dt=Math.sqrt(1+Ln-fn-hn)*2,U[3]=(mt-Wn)/dt,U[0]=(Ht+Gt)/dt,U[1]=(ht+Cn)/dt,U[2]=.25*dt),U}function Ot(U,ue,at,ce){var j=ue[0],ln=ue[1],fn=ue[2],mt=ue[3],Gt=j+j,Wn=ln+ln,hn=fn+fn,ht=j*Gt,Ht=j*Wn,Cn=j*hn,Ln=ln*Wn,Gn=ln*hn,dt=fn*hn,ye=mt*Gt,Fe=mt*Wn,nt=mt*hn,Pt=ce[0],Mt=ce[1],Tn=ce[2];return U[0]=(1-(Ln+dt))*Pt,U[1]=(Ht+nt)*Pt,U[2]=(Cn-Fe)*Pt,U[3]=0,U[4]=(Ht-nt)*Mt,U[5]=(1-(ht+dt))*Mt,U[6]=(Gn+ye)*Mt,U[7]=0,U[8]=(Cn+Fe)*Tn,U[9]=(Gn-ye)*Tn,U[10]=(1-(ht+Ln))*Tn,U[11]=0,U[12]=at[0],U[13]=at[1],U[14]=at[2],U[15]=1,U}function Ce(U,ue,at,ce,j){var ln=ue[0],fn=ue[1],mt=ue[2],Gt=ue[3],Wn=ln+ln,hn=fn+fn,ht=mt+mt,Ht=ln*Wn,Cn=ln*hn,Ln=ln*ht,Gn=fn*hn,dt=fn*ht,ye=mt*ht,Fe=Gt*Wn,nt=Gt*hn,Pt=Gt*ht,Mt=ce[0],Tn=ce[1],$n=ce[2],xr=j[0],qn=j[1],Ae=j[2],be=(1-(Gn+ye))*Mt,Ne=(Cn+Pt)*Mt,et=(Ln-nt)*Mt,wt=(Cn-Pt)*Tn,qt=(1-(Ht+ye))*Tn,vn=(dt+Fe)*Tn,yt=(Ln+nt)*$n,Jt=(dt-Fe)*$n,Qn=(1-(Ht+Gn))*$n;return U[0]=be,U[1]=Ne,U[2]=et,U[3]=0,U[4]=wt,U[5]=qt,U[6]=vn,U[7]=0,U[8]=yt,U[9]=Jt,U[10]=Qn,U[11]=0,U[12]=at[0]+xr-(be*xr+wt*qn+yt*Ae),U[13]=at[1]+qn-(Ne*xr+qt*qn+Jt*Ae),U[14]=at[2]+Ae-(et*xr+vn*qn+Qn*Ae),U[15]=1,U}function ot(U,ue){var at=ue[0],ce=ue[1],j=ue[2],ln=ue[3],fn=at+at,mt=ce+ce,Gt=j+j,Wn=at*fn,hn=ce*fn,ht=ce*mt,Ht=j*fn,Cn=j*mt,Ln=j*Gt,Gn=ln*fn,dt=ln*mt,ye=ln*Gt;return U[0]=1-ht-Ln,U[1]=hn+ye,U[2]=Ht-dt,U[3]=0,U[4]=hn-ye,U[5]=1-Wn-Ln,U[6]=Cn+Gn,U[7]=0,U[8]=Ht+dt,U[9]=Cn-Gn,U[10]=1-Wn-ht,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}function $e(U,ue,at,ce,j,ln,fn){var mt=1/(at-ue),Gt=1/(j-ce),Wn=1/(ln-fn);return U[0]=ln*2*mt,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=ln*2*Gt,U[6]=0,U[7]=0,U[8]=(at+ue)*mt,U[9]=(j+ce)*Gt,U[10]=(fn+ln)*Wn,U[11]=-1,U[12]=0,U[13]=0,U[14]=fn*ln*2*Wn,U[15]=0,U}function Xe(U,ue,at,ce,j){var ln=1/Math.tan(ue/2),fn;return U[0]=ln/at,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=ln,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[11]=-1,U[12]=0,U[13]=0,U[15]=0,j!=null&&j!==1/0?(fn=1/(ce-j),U[10]=(j+ce)*fn,U[14]=2*j*ce*fn):(U[10]=-1,U[14]=-2*ce),U}var Rt=Xe;function _t(U,ue,at,ce,j){var ln=1/Math.tan(ue/2),fn;return U[0]=ln/at,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=ln,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[11]=-1,U[12]=0,U[13]=0,U[15]=0,j!=null&&j!==1/0?(fn=1/(ce-j),U[10]=j*fn,U[14]=j*ce*fn):(U[10]=-1,U[14]=-ce),U}function Pe(U,ue,at,ce){var j=Math.tan(ue.upDegrees*Math.PI/180),ln=Math.tan(ue.downDegrees*Math.PI/180),fn=Math.tan(ue.leftDegrees*Math.PI/180),mt=Math.tan(ue.rightDegrees*Math.PI/180),Gt=2/(fn+mt),Wn=2/(j+ln);return U[0]=Gt,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=Wn,U[6]=0,U[7]=0,U[8]=-((fn-mt)*Gt*.5),U[9]=(j-ln)*Wn*.5,U[10]=ce/(at-ce),U[11]=-1,U[12]=0,U[13]=0,U[14]=ce*at/(at-ce),U[15]=0,U}function Wt(U,ue,at,ce,j,ln,fn){var mt=1/(ue-at),Gt=1/(ce-j),Wn=1/(ln-fn);return U[0]=-2*mt,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=-2*Gt,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=2*Wn,U[11]=0,U[12]=(ue+at)*mt,U[13]=(j+ce)*Gt,U[14]=(fn+ln)*Wn,U[15]=1,U}var on=Wt;function Nn(U,ue,at,ce,j,ln,fn){var mt=1/(ue-at),Gt=1/(ce-j),Wn=1/(ln-fn);return U[0]=-2*mt,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=-2*Gt,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=Wn,U[11]=0,U[12]=(ue+at)*mt,U[13]=(j+ce)*Gt,U[14]=ln*Wn,U[15]=1,U}function jn(U,ue,at,ce){var j,ln,fn,mt,Gt,Wn,hn,ht,Ht,Cn,Ln=ue[0],Gn=ue[1],dt=ue[2],ye=ce[0],Fe=ce[1],nt=ce[2],Pt=at[0],Mt=at[1],Tn=at[2];return Math.abs(Ln-Pt)<ee.Ib&&Math.abs(Gn-Mt)<ee.Ib&&Math.abs(dt-Tn)<ee.Ib?se(U):(hn=Ln-Pt,ht=Gn-Mt,Ht=dt-Tn,Cn=1/Math.hypot(hn,ht,Ht),hn*=Cn,ht*=Cn,Ht*=Cn,j=Fe*Ht-nt*ht,ln=nt*hn-ye*Ht,fn=ye*ht-Fe*hn,Cn=Math.hypot(j,ln,fn),Cn?(Cn=1/Cn,j*=Cn,ln*=Cn,fn*=Cn):(j=0,ln=0,fn=0),mt=ht*fn-Ht*ln,Gt=Ht*j-hn*fn,Wn=hn*ln-ht*j,Cn=Math.hypot(mt,Gt,Wn),Cn?(Cn=1/Cn,mt*=Cn,Gt*=Cn,Wn*=Cn):(mt=0,Gt=0,Wn=0),U[0]=j,U[1]=mt,U[2]=hn,U[3]=0,U[4]=ln,U[5]=Gt,U[6]=ht,U[7]=0,U[8]=fn,U[9]=Wn,U[10]=Ht,U[11]=0,U[12]=-(j*Ln+ln*Gn+fn*dt),U[13]=-(mt*Ln+Gt*Gn+Wn*dt),U[14]=-(hn*Ln+ht*Gn+Ht*dt),U[15]=1,U)}function lr(U,ue,at,ce){var j=ue[0],ln=ue[1],fn=ue[2],mt=ce[0],Gt=ce[1],Wn=ce[2],hn=j-at[0],ht=ln-at[1],Ht=fn-at[2],Cn=hn*hn+ht*ht+Ht*Ht;Cn>0&&(Cn=1/Math.sqrt(Cn),hn*=Cn,ht*=Cn,Ht*=Cn);var Ln=Gt*Ht-Wn*ht,Gn=Wn*hn-mt*Ht,dt=mt*ht-Gt*hn;return Cn=Ln*Ln+Gn*Gn+dt*dt,Cn>0&&(Cn=1/Math.sqrt(Cn),Ln*=Cn,Gn*=Cn,dt*=Cn),U[0]=Ln,U[1]=Gn,U[2]=dt,U[3]=0,U[4]=ht*dt-Ht*Gn,U[5]=Ht*Ln-hn*dt,U[6]=hn*Gn-ht*Ln,U[7]=0,U[8]=hn,U[9]=ht,U[10]=Ht,U[11]=0,U[12]=j,U[13]=ln,U[14]=fn,U[15]=1,U}function Vt(U){return"mat4("+U[0]+", "+U[1]+", "+U[2]+", "+U[3]+", "+U[4]+", "+U[5]+", "+U[6]+", "+U[7]+", "+U[8]+", "+U[9]+", "+U[10]+", "+U[11]+", "+U[12]+", "+U[13]+", "+U[14]+", "+U[15]+")"}function en(U){return Math.hypot(U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15])}function xn(U,ue,at){return U[0]=ue[0]+at[0],U[1]=ue[1]+at[1],U[2]=ue[2]+at[2],U[3]=ue[3]+at[3],U[4]=ue[4]+at[4],U[5]=ue[5]+at[5],U[6]=ue[6]+at[6],U[7]=ue[7]+at[7],U[8]=ue[8]+at[8],U[9]=ue[9]+at[9],U[10]=ue[10]+at[10],U[11]=ue[11]+at[11],U[12]=ue[12]+at[12],U[13]=ue[13]+at[13],U[14]=ue[14]+at[14],U[15]=ue[15]+at[15],U}function er(U,ue,at){return U[0]=ue[0]-at[0],U[1]=ue[1]-at[1],U[2]=ue[2]-at[2],U[3]=ue[3]-at[3],U[4]=ue[4]-at[4],U[5]=ue[5]-at[5],U[6]=ue[6]-at[6],U[7]=ue[7]-at[7],U[8]=ue[8]-at[8],U[9]=ue[9]-at[9],U[10]=ue[10]-at[10],U[11]=ue[11]-at[11],U[12]=ue[12]-at[12],U[13]=ue[13]-at[13],U[14]=ue[14]-at[14],U[15]=ue[15]-at[15],U}function sn(U,ue,at){return U[0]=ue[0]*at,U[1]=ue[1]*at,U[2]=ue[2]*at,U[3]=ue[3]*at,U[4]=ue[4]*at,U[5]=ue[5]*at,U[6]=ue[6]*at,U[7]=ue[7]*at,U[8]=ue[8]*at,U[9]=ue[9]*at,U[10]=ue[10]*at,U[11]=ue[11]*at,U[12]=ue[12]*at,U[13]=ue[13]*at,U[14]=ue[14]*at,U[15]=ue[15]*at,U}function Ut(U,ue,at,ce){return U[0]=ue[0]+at[0]*ce,U[1]=ue[1]+at[1]*ce,U[2]=ue[2]+at[2]*ce,U[3]=ue[3]+at[3]*ce,U[4]=ue[4]+at[4]*ce,U[5]=ue[5]+at[5]*ce,U[6]=ue[6]+at[6]*ce,U[7]=ue[7]+at[7]*ce,U[8]=ue[8]+at[8]*ce,U[9]=ue[9]+at[9]*ce,U[10]=ue[10]+at[10]*ce,U[11]=ue[11]+at[11]*ce,U[12]=ue[12]+at[12]*ce,U[13]=ue[13]+at[13]*ce,U[14]=ue[14]+at[14]*ce,U[15]=ue[15]+at[15]*ce,U}function Dt(U,ue){return U[0]===ue[0]&&U[1]===ue[1]&&U[2]===ue[2]&&U[3]===ue[3]&&U[4]===ue[4]&&U[5]===ue[5]&&U[6]===ue[6]&&U[7]===ue[7]&&U[8]===ue[8]&&U[9]===ue[9]&&U[10]===ue[10]&&U[11]===ue[11]&&U[12]===ue[12]&&U[13]===ue[13]&&U[14]===ue[14]&&U[15]===ue[15]}function Me(U,ue){var at=U[0],ce=U[1],j=U[2],ln=U[3],fn=U[4],mt=U[5],Gt=U[6],Wn=U[7],hn=U[8],ht=U[9],Ht=U[10],Cn=U[11],Ln=U[12],Gn=U[13],dt=U[14],ye=U[15],Fe=ue[0],nt=ue[1],Pt=ue[2],Mt=ue[3],Tn=ue[4],$n=ue[5],xr=ue[6],qn=ue[7],Ae=ue[8],be=ue[9],Ne=ue[10],et=ue[11],wt=ue[12],qt=ue[13],vn=ue[14],yt=ue[15];return Math.abs(at-Fe)<=ee.Ib*Math.max(1,Math.abs(at),Math.abs(Fe))&&Math.abs(ce-nt)<=ee.Ib*Math.max(1,Math.abs(ce),Math.abs(nt))&&Math.abs(j-Pt)<=ee.Ib*Math.max(1,Math.abs(j),Math.abs(Pt))&&Math.abs(ln-Mt)<=ee.Ib*Math.max(1,Math.abs(ln),Math.abs(Mt))&&Math.abs(fn-Tn)<=ee.Ib*Math.max(1,Math.abs(fn),Math.abs(Tn))&&Math.abs(mt-$n)<=ee.Ib*Math.max(1,Math.abs(mt),Math.abs($n))&&Math.abs(Gt-xr)<=ee.Ib*Math.max(1,Math.abs(Gt),Math.abs(xr))&&Math.abs(Wn-qn)<=ee.Ib*Math.max(1,Math.abs(Wn),Math.abs(qn))&&Math.abs(hn-Ae)<=ee.Ib*Math.max(1,Math.abs(hn),Math.abs(Ae))&&Math.abs(ht-be)<=ee.Ib*Math.max(1,Math.abs(ht),Math.abs(be))&&Math.abs(Ht-Ne)<=ee.Ib*Math.max(1,Math.abs(Ht),Math.abs(Ne))&&Math.abs(Cn-et)<=ee.Ib*Math.max(1,Math.abs(Cn),Math.abs(et))&&Math.abs(Ln-wt)<=ee.Ib*Math.max(1,Math.abs(Ln),Math.abs(wt))&&Math.abs(Gn-qt)<=ee.Ib*Math.max(1,Math.abs(Gn),Math.abs(qt))&&Math.abs(dt-vn)<=ee.Ib*Math.max(1,Math.abs(dt),Math.abs(vn))&&Math.abs(ye-yt)<=ee.Ib*Math.max(1,Math.abs(ye),Math.abs(yt))}var Qe=ve,Ft=er},31437:function($t,W,D){"use strict";D.d(W,{$X:function(){return Se},AK:function(){return bt},Fv:function(){return Re},I6:function(){return Pe},IH:function(){return se},JG:function(){return re},Ue:function(){return X},al:function(){return _e},lu:function(){return Nn},t7:function(){return Ct},t8:function(){return he},tk:function(){return vt}});var ee=D(49685);function X(){var sn=new ee.WT(2);return ee.WT!=Float32Array&&(sn[0]=0,sn[1]=0),sn}function E(sn){var Ut=new glMatrix.ARRAY_TYPE(2);return Ut[0]=sn[0],Ut[1]=sn[1],Ut}function _e(sn,Ut){var Dt=new ee.WT(2);return Dt[0]=sn,Dt[1]=Ut,Dt}function re(sn,Ut){return sn[0]=Ut[0],sn[1]=Ut[1],sn}function he(sn,Ut,Dt){return sn[0]=Ut,sn[1]=Dt,sn}function se(sn,Ut,Dt){return sn[0]=Ut[0]+Dt[0],sn[1]=Ut[1]+Dt[1],sn}function Se(sn,Ut,Dt){return sn[0]=Ut[0]-Dt[0],sn[1]=Ut[1]-Dt[1],sn}function oe(sn,Ut,Dt){return sn[0]=Ut[0]*Dt[0],sn[1]=Ut[1]*Dt[1],sn}function je(sn,Ut,Dt){return sn[0]=Ut[0]/Dt[0],sn[1]=Ut[1]/Dt[1],sn}function te(sn,Ut){return sn[0]=Math.ceil(Ut[0]),sn[1]=Math.ceil(Ut[1]),sn}function ve(sn,Ut){return sn[0]=Math.floor(Ut[0]),sn[1]=Math.floor(Ut[1]),sn}function Be(sn,Ut,Dt){return sn[0]=Math.min(Ut[0],Dt[0]),sn[1]=Math.min(Ut[1],Dt[1]),sn}function Te(sn,Ut,Dt){return sn[0]=Math.max(Ut[0],Dt[0]),sn[1]=Math.max(Ut[1],Dt[1]),sn}function we(sn,Ut){return sn[0]=Math.round(Ut[0]),sn[1]=Math.round(Ut[1]),sn}function le(sn,Ut,Dt){return sn[0]=Ut[0]*Dt,sn[1]=Ut[1]*Dt,sn}function Ze(sn,Ut,Dt,Me){return sn[0]=Ut[0]+Dt[0]*Me,sn[1]=Ut[1]+Dt[1]*Me,sn}function xt(sn,Ut){var Dt=Ut[0]-sn[0],Me=Ut[1]-sn[1];return Math.hypot(Dt,Me)}function ft(sn,Ut){var Dt=Ut[0]-sn[0],Me=Ut[1]-sn[1];return Dt*Dt+Me*Me}function Zt(sn){var Ut=sn[0],Dt=sn[1];return Math.hypot(Ut,Dt)}function pt(sn){var Ut=sn[0],Dt=sn[1];return Ut*Ut+Dt*Dt}function vt(sn,Ut){return sn[0]=-Ut[0],sn[1]=-Ut[1],sn}function ke(sn,Ut){return sn[0]=1/Ut[0],sn[1]=1/Ut[1],sn}function Re(sn,Ut){var Dt=Ut[0],Me=Ut[1],Qe=Dt*Dt+Me*Me;return Qe>0&&(Qe=1/Math.sqrt(Qe)),sn[0]=Ut[0]*Qe,sn[1]=Ut[1]*Qe,sn}function bt(sn,Ut){return sn[0]*Ut[0]+sn[1]*Ut[1]}function gt(sn,Ut,Dt){var Me=Ut[0]*Dt[1]-Ut[1]*Dt[0];return sn[0]=sn[1]=0,sn[2]=Me,sn}function Ct(sn,Ut,Dt,Me){var Qe=Ut[0],Ft=Ut[1];return sn[0]=Qe+Me*(Dt[0]-Qe),sn[1]=Ft+Me*(Dt[1]-Ft),sn}function Sn(sn,Ut){Ut=Ut||1;var Dt=glMatrix.RANDOM()*2*Math.PI;return sn[0]=Math.cos(Dt)*Ut,sn[1]=Math.sin(Dt)*Ut,sn}function He(sn,Ut,Dt){var Me=Ut[0],Qe=Ut[1];return sn[0]=Dt[0]*Me+Dt[2]*Qe,sn[1]=Dt[1]*Me+Dt[3]*Qe,sn}function Ot(sn,Ut,Dt){var Me=Ut[0],Qe=Ut[1];return sn[0]=Dt[0]*Me+Dt[2]*Qe+Dt[4],sn[1]=Dt[1]*Me+Dt[3]*Qe+Dt[5],sn}function Ce(sn,Ut,Dt){var Me=Ut[0],Qe=Ut[1];return sn[0]=Dt[0]*Me+Dt[3]*Qe+Dt[6],sn[1]=Dt[1]*Me+Dt[4]*Qe+Dt[7],sn}function ot(sn,Ut,Dt){var Me=Ut[0],Qe=Ut[1];return sn[0]=Dt[0]*Me+Dt[4]*Qe+Dt[12],sn[1]=Dt[1]*Me+Dt[5]*Qe+Dt[13],sn}function $e(sn,Ut,Dt,Me){var Qe=Ut[0]-Dt[0],Ft=Ut[1]-Dt[1],U=Math.sin(Me),ue=Math.cos(Me);return sn[0]=Qe*ue-Ft*U+Dt[0],sn[1]=Qe*U+Ft*ue+Dt[1],sn}function Xe(sn,Ut){var Dt=sn[0],Me=sn[1],Qe=Ut[0],Ft=Ut[1],U=Math.sqrt(Dt*Dt+Me*Me)*Math.sqrt(Qe*Qe+Ft*Ft),ue=U&&(Dt*Qe+Me*Ft)/U;return Math.acos(Math.min(Math.max(ue,-1),1))}function Rt(sn){return sn[0]=0,sn[1]=0,sn}function _t(sn){return"vec2("+sn[0]+", "+sn[1]+")"}function Pe(sn,Ut){return sn[0]===Ut[0]&&sn[1]===Ut[1]}function Wt(sn,Ut){var Dt=sn[0],Me=sn[1],Qe=Ut[0],Ft=Ut[1];return Math.abs(Dt-Qe)<=glMatrix.EPSILON*Math.max(1,Math.abs(Dt),Math.abs(Qe))&&Math.abs(Me-Ft)<=glMatrix.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Ft))}var on=null,Nn=Se,jn=null,lr=null,Vt=null,en=null,xn=null,er=function(){var sn=X();return function(Ut,Dt,Me,Qe,Ft,U){var ue,at;for(Dt||(Dt=2),Me||(Me=0),Qe?at=Math.min(Qe*Dt+Me,Ut.length):at=Ut.length,ue=Me;ue<at;ue+=Dt)sn[0]=Ut[ue],sn[1]=Ut[ue+1],Ft(sn,sn,U),Ut[ue]=sn[0],Ut[ue+1]=sn[1];return Ut}}()},77160:function($t,W,D){"use strict";D.d(W,{$X:function(){return oe},AK:function(){return bt},EU:function(){return Pe},Fv:function(){return Re},IH:function(){return Se},JG:function(){return he},Jp:function(){return je},TK:function(){return xn},Ue:function(){return X},VC:function(){return $e},Zh:function(){return sn},al:function(){return re},bA:function(){return Ze},d9:function(){return E},fF:function(){return Ce},fS:function(){return jn},kC:function(){return gt},kE:function(){return _e},kK:function(){return ot},lu:function(){return lr},t7:function(){return Ct},t8:function(){return se},tk:function(){return vt}});var ee=D(49685);function X(){var Me=new ee.WT(3);return ee.WT!=Float32Array&&(Me[0]=0,Me[1]=0,Me[2]=0),Me}function E(Me){var Qe=new ee.WT(3);return Qe[0]=Me[0],Qe[1]=Me[1],Qe[2]=Me[2],Qe}function _e(Me){var Qe=Me[0],Ft=Me[1],U=Me[2];return Math.hypot(Qe,Ft,U)}function re(Me,Qe,Ft){var U=new ee.WT(3);return U[0]=Me,U[1]=Qe,U[2]=Ft,U}function he(Me,Qe){return Me[0]=Qe[0],Me[1]=Qe[1],Me[2]=Qe[2],Me}function se(Me,Qe,Ft,U){return Me[0]=Qe,Me[1]=Ft,Me[2]=U,Me}function Se(Me,Qe,Ft){return Me[0]=Qe[0]+Ft[0],Me[1]=Qe[1]+Ft[1],Me[2]=Qe[2]+Ft[2],Me}function oe(Me,Qe,Ft){return Me[0]=Qe[0]-Ft[0],Me[1]=Qe[1]-Ft[1],Me[2]=Qe[2]-Ft[2],Me}function je(Me,Qe,Ft){return Me[0]=Qe[0]*Ft[0],Me[1]=Qe[1]*Ft[1],Me[2]=Qe[2]*Ft[2],Me}function te(Me,Qe,Ft){return Me[0]=Qe[0]/Ft[0],Me[1]=Qe[1]/Ft[1],Me[2]=Qe[2]/Ft[2],Me}function ve(Me,Qe){return Me[0]=Math.ceil(Qe[0]),Me[1]=Math.ceil(Qe[1]),Me[2]=Math.ceil(Qe[2]),Me}function Be(Me,Qe){return Me[0]=Math.floor(Qe[0]),Me[1]=Math.floor(Qe[1]),Me[2]=Math.floor(Qe[2]),Me}function Te(Me,Qe,Ft){return Me[0]=Math.min(Qe[0],Ft[0]),Me[1]=Math.min(Qe[1],Ft[1]),Me[2]=Math.min(Qe[2],Ft[2]),Me}function we(Me,Qe,Ft){return Me[0]=Math.max(Qe[0],Ft[0]),Me[1]=Math.max(Qe[1],Ft[1]),Me[2]=Math.max(Qe[2],Ft[2]),Me}function le(Me,Qe){return Me[0]=Math.round(Qe[0]),Me[1]=Math.round(Qe[1]),Me[2]=Math.round(Qe[2]),Me}function Ze(Me,Qe,Ft){return Me[0]=Qe[0]*Ft,Me[1]=Qe[1]*Ft,Me[2]=Qe[2]*Ft,Me}function xt(Me,Qe,Ft,U){return Me[0]=Qe[0]+Ft[0]*U,Me[1]=Qe[1]+Ft[1]*U,Me[2]=Qe[2]+Ft[2]*U,Me}function ft(Me,Qe){var Ft=Qe[0]-Me[0],U=Qe[1]-Me[1],ue=Qe[2]-Me[2];return Math.hypot(Ft,U,ue)}function Zt(Me,Qe){var Ft=Qe[0]-Me[0],U=Qe[1]-Me[1],ue=Qe[2]-Me[2];return Ft*Ft+U*U+ue*ue}function pt(Me){var Qe=Me[0],Ft=Me[1],U=Me[2];return Qe*Qe+Ft*Ft+U*U}function vt(Me,Qe){return Me[0]=-Qe[0],Me[1]=-Qe[1],Me[2]=-Qe[2],Me}function ke(Me,Qe){return Me[0]=1/Qe[0],Me[1]=1/Qe[1],Me[2]=1/Qe[2],Me}function Re(Me,Qe){var Ft=Qe[0],U=Qe[1],ue=Qe[2],at=Ft*Ft+U*U+ue*ue;return at>0&&(at=1/Math.sqrt(at)),Me[0]=Qe[0]*at,Me[1]=Qe[1]*at,Me[2]=Qe[2]*at,Me}function bt(Me,Qe){return Me[0]*Qe[0]+Me[1]*Qe[1]+Me[2]*Qe[2]}function gt(Me,Qe,Ft){var U=Qe[0],ue=Qe[1],at=Qe[2],ce=Ft[0],j=Ft[1],ln=Ft[2];return Me[0]=ue*ln-at*j,Me[1]=at*ce-U*ln,Me[2]=U*j-ue*ce,Me}function Ct(Me,Qe,Ft,U){var ue=Qe[0],at=Qe[1],ce=Qe[2];return Me[0]=ue+U*(Ft[0]-ue),Me[1]=at+U*(Ft[1]-at),Me[2]=ce+U*(Ft[2]-ce),Me}function Sn(Me,Qe,Ft,U,ue,at){var ce=at*at,j=ce*(2*at-3)+1,ln=ce*(at-2)+at,fn=ce*(at-1),mt=ce*(3-2*at);return Me[0]=Qe[0]*j+Ft[0]*ln+U[0]*fn+ue[0]*mt,Me[1]=Qe[1]*j+Ft[1]*ln+U[1]*fn+ue[1]*mt,Me[2]=Qe[2]*j+Ft[2]*ln+U[2]*fn+ue[2]*mt,Me}function He(Me,Qe,Ft,U,ue,at){var ce=1-at,j=ce*ce,ln=at*at,fn=j*ce,mt=3*at*j,Gt=3*ln*ce,Wn=ln*at;return Me[0]=Qe[0]*fn+Ft[0]*mt+U[0]*Gt+ue[0]*Wn,Me[1]=Qe[1]*fn+Ft[1]*mt+U[1]*Gt+ue[1]*Wn,Me[2]=Qe[2]*fn+Ft[2]*mt+U[2]*Gt+ue[2]*Wn,Me}function Ot(Me,Qe){Qe=Qe||1;var Ft=glMatrix.RANDOM()*2*Math.PI,U=glMatrix.RANDOM()*2-1,ue=Math.sqrt(1-U*U)*Qe;return Me[0]=Math.cos(Ft)*ue,Me[1]=Math.sin(Ft)*ue,Me[2]=U*Qe,Me}function Ce(Me,Qe,Ft){var U=Qe[0],ue=Qe[1],at=Qe[2],ce=Ft[3]*U+Ft[7]*ue+Ft[11]*at+Ft[15];return ce=ce||1,Me[0]=(Ft[0]*U+Ft[4]*ue+Ft[8]*at+Ft[12])/ce,Me[1]=(Ft[1]*U+Ft[5]*ue+Ft[9]*at+Ft[13])/ce,Me[2]=(Ft[2]*U+Ft[6]*ue+Ft[10]*at+Ft[14])/ce,Me}function ot(Me,Qe,Ft){var U=Qe[0],ue=Qe[1],at=Qe[2];return Me[0]=U*Ft[0]+ue*Ft[3]+at*Ft[6],Me[1]=U*Ft[1]+ue*Ft[4]+at*Ft[7],Me[2]=U*Ft[2]+ue*Ft[5]+at*Ft[8],Me}function $e(Me,Qe,Ft){var U=Ft[0],ue=Ft[1],at=Ft[2],ce=Ft[3],j=Qe[0],ln=Qe[1],fn=Qe[2],mt=ue*fn-at*ln,Gt=at*j-U*fn,Wn=U*ln-ue*j,hn=ue*Wn-at*Gt,ht=at*mt-U*Wn,Ht=U*Gt-ue*mt,Cn=ce*2;return mt*=Cn,Gt*=Cn,Wn*=Cn,hn*=2,ht*=2,Ht*=2,Me[0]=j+mt+hn,Me[1]=ln+Gt+ht,Me[2]=fn+Wn+Ht,Me}function Xe(Me,Qe,Ft,U){var ue=[],at=[];return ue[0]=Qe[0]-Ft[0],ue[1]=Qe[1]-Ft[1],ue[2]=Qe[2]-Ft[2],at[0]=ue[0],at[1]=ue[1]*Math.cos(U)-ue[2]*Math.sin(U),at[2]=ue[1]*Math.sin(U)+ue[2]*Math.cos(U),Me[0]=at[0]+Ft[0],Me[1]=at[1]+Ft[1],Me[2]=at[2]+Ft[2],Me}function Rt(Me,Qe,Ft,U){var ue=[],at=[];return ue[0]=Qe[0]-Ft[0],ue[1]=Qe[1]-Ft[1],ue[2]=Qe[2]-Ft[2],at[0]=ue[2]*Math.sin(U)+ue[0]*Math.cos(U),at[1]=ue[1],at[2]=ue[2]*Math.cos(U)-ue[0]*Math.sin(U),Me[0]=at[0]+Ft[0],Me[1]=at[1]+Ft[1],Me[2]=at[2]+Ft[2],Me}function _t(Me,Qe,Ft,U){var ue=[],at=[];return ue[0]=Qe[0]-Ft[0],ue[1]=Qe[1]-Ft[1],ue[2]=Qe[2]-Ft[2],at[0]=ue[0]*Math.cos(U)-ue[1]*Math.sin(U),at[1]=ue[0]*Math.sin(U)+ue[1]*Math.cos(U),at[2]=ue[2],Me[0]=at[0]+Ft[0],Me[1]=at[1]+Ft[1],Me[2]=at[2]+Ft[2],Me}function Pe(Me,Qe){var Ft=Me[0],U=Me[1],ue=Me[2],at=Qe[0],ce=Qe[1],j=Qe[2],ln=Math.sqrt(Ft*Ft+U*U+ue*ue),fn=Math.sqrt(at*at+ce*ce+j*j),mt=ln*fn,Gt=mt&&bt(Me,Qe)/mt;return Math.acos(Math.min(Math.max(Gt,-1),1))}function Wt(Me){return Me[0]=0,Me[1]=0,Me[2]=0,Me}function on(Me){return"vec3("+Me[0]+", "+Me[1]+", "+Me[2]+")"}function Nn(Me,Qe){return Me[0]===Qe[0]&&Me[1]===Qe[1]&&Me[2]===Qe[2]}function jn(Me,Qe){var Ft=Me[0],U=Me[1],ue=Me[2],at=Qe[0],ce=Qe[1],j=Qe[2];return Math.abs(Ft-at)<=ee.Ib*Math.max(1,Math.abs(Ft),Math.abs(at))&&Math.abs(U-ce)<=ee.Ib*Math.max(1,Math.abs(U),Math.abs(ce))&&Math.abs(ue-j)<=ee.Ib*Math.max(1,Math.abs(ue),Math.abs(j))}var lr=oe,Vt=null,en=null,xn=ft,er=null,sn=_e,Ut=null,Dt=function(){var Me=X();return function(Qe,Ft,U,ue,at,ce){var j,ln;for(Ft||(Ft=3),U||(U=0),ue?ln=Math.min(ue*Ft+U,Qe.length):ln=Qe.length,j=U;j<ln;j+=Ft)Me[0]=Qe[j],Me[1]=Qe[j+1],Me[2]=Qe[j+2],at(Me,Me,ce),Qe[j]=Me[0],Qe[j+1]=Me[1],Qe[j+2]=Me[2];return Qe}}()},98333:function($t,W,D){"use strict";D.d(W,{AK:function(){return bt},Fv:function(){return Re},I6:function(){return $e},IH:function(){return se},JG:function(){return re},Ue:function(){return X},al:function(){return _e},bA:function(){return le},d9:function(){return E},fF:function(){return He},fS:function(){return Xe},kE:function(){return Zt},t7:function(){return Ct},t8:function(){return he},we:function(){return pt}});var ee=D(49685);function X(){var Vt=new ee.WT(4);return ee.WT!=Float32Array&&(Vt[0]=0,Vt[1]=0,Vt[2]=0,Vt[3]=0),Vt}function E(Vt){var en=new ee.WT(4);return en[0]=Vt[0],en[1]=Vt[1],en[2]=Vt[2],en[3]=Vt[3],en}function _e(Vt,en,xn,er){var sn=new ee.WT(4);return sn[0]=Vt,sn[1]=en,sn[2]=xn,sn[3]=er,sn}function re(Vt,en){return Vt[0]=en[0],Vt[1]=en[1],Vt[2]=en[2],Vt[3]=en[3],Vt}function he(Vt,en,xn,er,sn){return Vt[0]=en,Vt[1]=xn,Vt[2]=er,Vt[3]=sn,Vt}function se(Vt,en,xn){return Vt[0]=en[0]+xn[0],Vt[1]=en[1]+xn[1],Vt[2]=en[2]+xn[2],Vt[3]=en[3]+xn[3],Vt}function Se(Vt,en,xn){return Vt[0]=en[0]-xn[0],Vt[1]=en[1]-xn[1],Vt[2]=en[2]-xn[2],Vt[3]=en[3]-xn[3],Vt}function oe(Vt,en,xn){return Vt[0]=en[0]*xn[0],Vt[1]=en[1]*xn[1],Vt[2]=en[2]*xn[2],Vt[3]=en[3]*xn[3],Vt}function je(Vt,en,xn){return Vt[0]=en[0]/xn[0],Vt[1]=en[1]/xn[1],Vt[2]=en[2]/xn[2],Vt[3]=en[3]/xn[3],Vt}function te(Vt,en){return Vt[0]=Math.ceil(en[0]),Vt[1]=Math.ceil(en[1]),Vt[2]=Math.ceil(en[2]),Vt[3]=Math.ceil(en[3]),Vt}function ve(Vt,en){return Vt[0]=Math.floor(en[0]),Vt[1]=Math.floor(en[1]),Vt[2]=Math.floor(en[2]),Vt[3]=Math.floor(en[3]),Vt}function Be(Vt,en,xn){return Vt[0]=Math.min(en[0],xn[0]),Vt[1]=Math.min(en[1],xn[1]),Vt[2]=Math.min(en[2],xn[2]),Vt[3]=Math.min(en[3],xn[3]),Vt}function Te(Vt,en,xn){return Vt[0]=Math.max(en[0],xn[0]),Vt[1]=Math.max(en[1],xn[1]),Vt[2]=Math.max(en[2],xn[2]),Vt[3]=Math.max(en[3],xn[3]),Vt}function we(Vt,en){return Vt[0]=Math.round(en[0]),Vt[1]=Math.round(en[1]),Vt[2]=Math.round(en[2]),Vt[3]=Math.round(en[3]),Vt}function le(Vt,en,xn){return Vt[0]=en[0]*xn,Vt[1]=en[1]*xn,Vt[2]=en[2]*xn,Vt[3]=en[3]*xn,Vt}function Ze(Vt,en,xn,er){return Vt[0]=en[0]+xn[0]*er,Vt[1]=en[1]+xn[1]*er,Vt[2]=en[2]+xn[2]*er,Vt[3]=en[3]+xn[3]*er,Vt}function xt(Vt,en){var xn=en[0]-Vt[0],er=en[1]-Vt[1],sn=en[2]-Vt[2],Ut=en[3]-Vt[3];return Math.hypot(xn,er,sn,Ut)}function ft(Vt,en){var xn=en[0]-Vt[0],er=en[1]-Vt[1],sn=en[2]-Vt[2],Ut=en[3]-Vt[3];return xn*xn+er*er+sn*sn+Ut*Ut}function Zt(Vt){var en=Vt[0],xn=Vt[1],er=Vt[2],sn=Vt[3];return Math.hypot(en,xn,er,sn)}function pt(Vt){var en=Vt[0],xn=Vt[1],er=Vt[2],sn=Vt[3];return en*en+xn*xn+er*er+sn*sn}function vt(Vt,en){return Vt[0]=-en[0],Vt[1]=-en[1],Vt[2]=-en[2],Vt[3]=-en[3],Vt}function ke(Vt,en){return Vt[0]=1/en[0],Vt[1]=1/en[1],Vt[2]=1/en[2],Vt[3]=1/en[3],Vt}function Re(Vt,en){var xn=en[0],er=en[1],sn=en[2],Ut=en[3],Dt=xn*xn+er*er+sn*sn+Ut*Ut;return Dt>0&&(Dt=1/Math.sqrt(Dt)),Vt[0]=xn*Dt,Vt[1]=er*Dt,Vt[2]=sn*Dt,Vt[3]=Ut*Dt,Vt}function bt(Vt,en){return Vt[0]*en[0]+Vt[1]*en[1]+Vt[2]*en[2]+Vt[3]*en[3]}function gt(Vt,en,xn,er){var sn=xn[0]*er[1]-xn[1]*er[0],Ut=xn[0]*er[2]-xn[2]*er[0],Dt=xn[0]*er[3]-xn[3]*er[0],Me=xn[1]*er[2]-xn[2]*er[1],Qe=xn[1]*er[3]-xn[3]*er[1],Ft=xn[2]*er[3]-xn[3]*er[2],U=en[0],ue=en[1],at=en[2],ce=en[3];return Vt[0]=ue*Ft-at*Qe+ce*Me,Vt[1]=-(U*Ft)+at*Dt-ce*Ut,Vt[2]=U*Qe-ue*Dt+ce*sn,Vt[3]=-(U*Me)+ue*Ut-at*sn,Vt}function Ct(Vt,en,xn,er){var sn=en[0],Ut=en[1],Dt=en[2],Me=en[3];return Vt[0]=sn+er*(xn[0]-sn),Vt[1]=Ut+er*(xn[1]-Ut),Vt[2]=Dt+er*(xn[2]-Dt),Vt[3]=Me+er*(xn[3]-Me),Vt}function Sn(Vt,en){en=en||1;var xn,er,sn,Ut,Dt,Me;do xn=glMatrix.RANDOM()*2-1,er=glMatrix.RANDOM()*2-1,Dt=xn*xn+er*er;while(Dt>=1);do sn=glMatrix.RANDOM()*2-1,Ut=glMatrix.RANDOM()*2-1,Me=sn*sn+Ut*Ut;while(Me>=1);var Qe=Math.sqrt((1-Dt)/Me);return Vt[0]=en*xn,Vt[1]=en*er,Vt[2]=en*sn*Qe,Vt[3]=en*Ut*Qe,Vt}function He(Vt,en,xn){var er=en[0],sn=en[1],Ut=en[2],Dt=en[3];return Vt[0]=xn[0]*er+xn[4]*sn+xn[8]*Ut+xn[12]*Dt,Vt[1]=xn[1]*er+xn[5]*sn+xn[9]*Ut+xn[13]*Dt,Vt[2]=xn[2]*er+xn[6]*sn+xn[10]*Ut+xn[14]*Dt,Vt[3]=xn[3]*er+xn[7]*sn+xn[11]*Ut+xn[15]*Dt,Vt}function Ot(Vt,en,xn){var er=en[0],sn=en[1],Ut=en[2],Dt=xn[0],Me=xn[1],Qe=xn[2],Ft=xn[3],U=Ft*er+Me*Ut-Qe*sn,ue=Ft*sn+Qe*er-Dt*Ut,at=Ft*Ut+Dt*sn-Me*er,ce=-Dt*er-Me*sn-Qe*Ut;return Vt[0]=U*Ft+ce*-Dt+ue*-Qe-at*-Me,Vt[1]=ue*Ft+ce*-Me+at*-Dt-U*-Qe,Vt[2]=at*Ft+ce*-Qe+U*-Me-ue*-Dt,Vt[3]=en[3],Vt}function Ce(Vt){return Vt[0]=0,Vt[1]=0,Vt[2]=0,Vt[3]=0,Vt}function ot(Vt){return"vec4("+Vt[0]+", "+Vt[1]+", "+Vt[2]+", "+Vt[3]+")"}function $e(Vt,en){return Vt[0]===en[0]&&Vt[1]===en[1]&&Vt[2]===en[2]&&Vt[3]===en[3]}function Xe(Vt,en){var xn=Vt[0],er=Vt[1],sn=Vt[2],Ut=Vt[3],Dt=en[0],Me=en[1],Qe=en[2],Ft=en[3];return Math.abs(xn-Dt)<=ee.Ib*Math.max(1,Math.abs(xn),Math.abs(Dt))&&Math.abs(er-Me)<=ee.Ib*Math.max(1,Math.abs(er),Math.abs(Me))&&Math.abs(sn-Qe)<=ee.Ib*Math.max(1,Math.abs(sn),Math.abs(Qe))&&Math.abs(Ut-Ft)<=ee.Ib*Math.max(1,Math.abs(Ut),Math.abs(Ft))}var Rt=null,_t=null,Pe=null,Wt=null,on=null,Nn=null,jn=null,lr=function(){var Vt=X();return function(en,xn,er,sn,Ut,Dt){var Me,Qe;for(xn||(xn=4),er||(er=0),sn?Qe=Math.min(sn*xn+er,en.length):Qe=en.length,Me=er;Me<Qe;Me+=xn)Vt[0]=en[Me],Vt[1]=en[Me+1],Vt[2]=en[Me+2],Vt[3]=en[Me+3],Ut(Vt,Vt,Dt),en[Me]=Vt[0],en[Me+1]=Vt[1],en[Me+2]=Vt[2],en[Me+3]=Vt[3];return en}}()},50840:function($t,W,D){var ee;(function(X,E,_e,re){"use strict";var he=["","webkit","Moz","MS","ms","o"],se=E.createElement("div"),Se="function",oe=Math.round,je=Math.abs,te=Date.now;function ve(Tt,Yt,Fn){return setTimeout(Zt(Tt,Fn),Yt)}function Be(Tt,Yt,Fn){return Array.isArray(Tt)?(Te(Tt,Fn[Yt],Fn),!0):!1}function Te(Tt,Yt,Fn){var dr;if(Tt)if(Tt.forEach)Tt.forEach(Yt,Fn);else if(Tt.length!==re)for(dr=0;dr<Tt.length;)Yt.call(Fn,Tt[dr],dr,Tt),dr++;else for(dr in Tt)Tt.hasOwnProperty(dr)&&Yt.call(Fn,Tt[dr],dr,Tt)}function we(Tt,Yt,Fn){var dr="DEPRECATED METHOD: "+Yt+`
`+Fn+` AT 
`;return function(){var ai=new Error("get-stack-trace"),Xr=ai&&ai.stack?ai.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Uo=X.console&&(X.console.warn||X.console.log);return Uo&&Uo.call(X.console,dr,Xr),Tt.apply(this,arguments)}}var le;typeof Object.assign!="function"?le=function(Yt){if(Yt===re||Yt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Fn=Object(Yt),dr=1;dr<arguments.length;dr++){var ai=arguments[dr];if(ai!==re&&ai!==null)for(var Xr in ai)ai.hasOwnProperty(Xr)&&(Fn[Xr]=ai[Xr])}return Fn}:le=Object.assign;var Ze=we(function(Yt,Fn,dr){for(var ai=Object.keys(Fn),Xr=0;Xr<ai.length;)(!dr||dr&&Yt[ai[Xr]]===re)&&(Yt[ai[Xr]]=Fn[ai[Xr]]),Xr++;return Yt},"extend","Use `assign`."),xt=we(function(Yt,Fn){return Ze(Yt,Fn,!0)},"merge","Use `assign`.");function ft(Tt,Yt,Fn){var dr=Yt.prototype,ai;ai=Tt.prototype=Object.create(dr),ai.constructor=Tt,ai._super=dr,Fn&&le(ai,Fn)}function Zt(Tt,Yt){return function(){return Tt.apply(Yt,arguments)}}function pt(Tt,Yt){return typeof Tt==Se?Tt.apply(Yt&&Yt[0]||re,Yt):Tt}function vt(Tt,Yt){return Tt===re?Yt:Tt}function ke(Tt,Yt,Fn){Te(Ct(Yt),function(dr){Tt.addEventListener(dr,Fn,!1)})}function Re(Tt,Yt,Fn){Te(Ct(Yt),function(dr){Tt.removeEventListener(dr,Fn,!1)})}function bt(Tt,Yt){for(;Tt;){if(Tt==Yt)return!0;Tt=Tt.parentNode}return!1}function gt(Tt,Yt){return Tt.indexOf(Yt)>-1}function Ct(Tt){return Tt.trim().split(/\s+/g)}function Sn(Tt,Yt,Fn){if(Tt.indexOf&&!Fn)return Tt.indexOf(Yt);for(var dr=0;dr<Tt.length;){if(Fn&&Tt[dr][Fn]==Yt||!Fn&&Tt[dr]===Yt)return dr;dr++}return-1}function He(Tt){return Array.prototype.slice.call(Tt,0)}function Ot(Tt,Yt,Fn){for(var dr=[],ai=[],Xr=0;Xr<Tt.length;){var Uo=Yt?Tt[Xr][Yt]:Tt[Xr];Sn(ai,Uo)<0&&dr.push(Tt[Xr]),ai[Xr]=Uo,Xr++}return Fn&&(Yt?dr=dr.sort(function(ya,vs){return ya[Yt]>vs[Yt]}):dr=dr.sort()),dr}function Ce(Tt,Yt){for(var Fn,dr,ai=Yt[0].toUpperCase()+Yt.slice(1),Xr=0;Xr<he.length;){if(Fn=he[Xr],dr=Fn?Fn+ai:Yt,dr in Tt)return dr;Xr++}return re}var ot=1;function $e(){return ot++}function Xe(Tt){var Yt=Tt.ownerDocument||Tt;return Yt.defaultView||Yt.parentWindow||X}var Rt=/mobile|tablet|ip(ad|hone|od)|android/i,_t="ontouchstart"in X,Pe=Ce(X,"PointerEvent")!==re,Wt=_t&&Rt.test(navigator.userAgent),on="touch",Nn="pen",jn="mouse",lr="kinect",Vt=25,en=1,xn=2,er=4,sn=8,Ut=1,Dt=2,Me=4,Qe=8,Ft=16,U=Dt|Me,ue=Qe|Ft,at=U|ue,ce=["x","y"],j=["clientX","clientY"];function ln(Tt,Yt){var Fn=this;this.manager=Tt,this.callback=Yt,this.element=Tt.element,this.target=Tt.options.inputTarget,this.domHandler=function(dr){pt(Tt.options.enable,[Tt])&&Fn.handler(dr)},this.init()}ln.prototype={handler:function(){},init:function(){this.evEl&&ke(this.element,this.evEl,this.domHandler),this.evTarget&&ke(this.target,this.evTarget,this.domHandler),this.evWin&&ke(Xe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Re(this.element,this.evEl,this.domHandler),this.evTarget&&Re(this.target,this.evTarget,this.domHandler),this.evWin&&Re(Xe(this.element),this.evWin,this.domHandler)}};function fn(Tt){var Yt,Fn=Tt.options.inputClass;return Fn?Yt=Fn:Pe?Yt=be:Wt?Yt=Qn:_t?Yt=kr:Yt=Tn,new Yt(Tt,mt)}function mt(Tt,Yt,Fn){var dr=Fn.pointers.length,ai=Fn.changedPointers.length,Xr=Yt&en&&dr-ai===0,Uo=Yt&(er|sn)&&dr-ai===0;Fn.isFirst=!!Xr,Fn.isFinal=!!Uo,Xr&&(Tt.session={}),Fn.eventType=Yt,Gt(Tt,Fn),Tt.emit("hammer.input",Fn),Tt.recognize(Fn),Tt.session.prevInput=Fn}function Gt(Tt,Yt){var Fn=Tt.session,dr=Yt.pointers,ai=dr.length;Fn.firstInput||(Fn.firstInput=ht(Yt)),ai>1&&!Fn.firstMultiple?Fn.firstMultiple=ht(Yt):ai===1&&(Fn.firstMultiple=!1);var Xr=Fn.firstInput,Uo=Fn.firstMultiple,Xo=Uo?Uo.center:Xr.center,ya=Yt.center=Ht(dr);Yt.timeStamp=te(),Yt.deltaTime=Yt.timeStamp-Xr.timeStamp,Yt.angle=dt(Xo,ya),Yt.distance=Gn(Xo,ya),Wn(Fn,Yt),Yt.offsetDirection=Ln(Yt.deltaX,Yt.deltaY);var vs=Cn(Yt.deltaTime,Yt.deltaX,Yt.deltaY);Yt.overallVelocityX=vs.x,Yt.overallVelocityY=vs.y,Yt.overallVelocity=je(vs.x)>je(vs.y)?vs.x:vs.y,Yt.scale=Uo?Fe(Uo.pointers,dr):1,Yt.rotation=Uo?ye(Uo.pointers,dr):0,Yt.maxPointers=Fn.prevInput?Yt.pointers.length>Fn.prevInput.maxPointers?Yt.pointers.length:Fn.prevInput.maxPointers:Yt.pointers.length,hn(Fn,Yt);var nl=Tt.element;bt(Yt.srcEvent.target,nl)&&(nl=Yt.srcEvent.target),Yt.target=nl}function Wn(Tt,Yt){var Fn=Yt.center,dr=Tt.offsetDelta||{},ai=Tt.prevDelta||{},Xr=Tt.prevInput||{};(Yt.eventType===en||Xr.eventType===er)&&(ai=Tt.prevDelta={x:Xr.deltaX||0,y:Xr.deltaY||0},dr=Tt.offsetDelta={x:Fn.x,y:Fn.y}),Yt.deltaX=ai.x+(Fn.x-dr.x),Yt.deltaY=ai.y+(Fn.y-dr.y)}function hn(Tt,Yt){var Fn=Tt.lastInterval||Yt,dr=Yt.timeStamp-Fn.timeStamp,ai,Xr,Uo,Xo;if(Yt.eventType!=sn&&(dr>Vt||Fn.velocity===re)){var ya=Yt.deltaX-Fn.deltaX,vs=Yt.deltaY-Fn.deltaY,nl=Cn(dr,ya,vs);Xr=nl.x,Uo=nl.y,ai=je(nl.x)>je(nl.y)?nl.x:nl.y,Xo=Ln(ya,vs),Tt.lastInterval=Yt}else ai=Fn.velocity,Xr=Fn.velocityX,Uo=Fn.velocityY,Xo=Fn.direction;Yt.velocity=ai,Yt.velocityX=Xr,Yt.velocityY=Uo,Yt.direction=Xo}function ht(Tt){for(var Yt=[],Fn=0;Fn<Tt.pointers.length;)Yt[Fn]={clientX:oe(Tt.pointers[Fn].clientX),clientY:oe(Tt.pointers[Fn].clientY)},Fn++;return{timeStamp:te(),pointers:Yt,center:Ht(Yt),deltaX:Tt.deltaX,deltaY:Tt.deltaY}}function Ht(Tt){var Yt=Tt.length;if(Yt===1)return{x:oe(Tt[0].clientX),y:oe(Tt[0].clientY)};for(var Fn=0,dr=0,ai=0;ai<Yt;)Fn+=Tt[ai].clientX,dr+=Tt[ai].clientY,ai++;return{x:oe(Fn/Yt),y:oe(dr/Yt)}}function Cn(Tt,Yt,Fn){return{x:Yt/Tt||0,y:Fn/Tt||0}}function Ln(Tt,Yt){return Tt===Yt?Ut:je(Tt)>=je(Yt)?Tt<0?Dt:Me:Yt<0?Qe:Ft}function Gn(Tt,Yt,Fn){Fn||(Fn=ce);var dr=Yt[Fn[0]]-Tt[Fn[0]],ai=Yt[Fn[1]]-Tt[Fn[1]];return Math.sqrt(dr*dr+ai*ai)}function dt(Tt,Yt,Fn){Fn||(Fn=ce);var dr=Yt[Fn[0]]-Tt[Fn[0]],ai=Yt[Fn[1]]-Tt[Fn[1]];return Math.atan2(ai,dr)*180/Math.PI}function ye(Tt,Yt){return dt(Yt[1],Yt[0],j)+dt(Tt[1],Tt[0],j)}function Fe(Tt,Yt){return Gn(Yt[0],Yt[1],j)/Gn(Tt[0],Tt[1],j)}var nt={mousedown:en,mousemove:xn,mouseup:er},Pt="mousedown",Mt="mousemove mouseup";function Tn(){this.evEl=Pt,this.evWin=Mt,this.pressed=!1,ln.apply(this,arguments)}ft(Tn,ln,{handler:function(Yt){var Fn=nt[Yt.type];Fn&en&&Yt.button===0&&(this.pressed=!0),Fn&xn&&Yt.which!==1&&(Fn=er),this.pressed&&(Fn&er&&(this.pressed=!1),this.callback(this.manager,Fn,{pointers:[Yt],changedPointers:[Yt],pointerType:jn,srcEvent:Yt}))}});var $n={pointerdown:en,pointermove:xn,pointerup:er,pointercancel:sn,pointerout:sn},xr={2:on,3:Nn,4:jn,5:lr},qn="pointerdown",Ae="pointermove pointerup pointercancel";X.MSPointerEvent&&!X.PointerEvent&&(qn="MSPointerDown",Ae="MSPointerMove MSPointerUp MSPointerCancel");function be(){this.evEl=qn,this.evWin=Ae,ln.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ft(be,ln,{handler:function(Yt){var Fn=this.store,dr=!1,ai=Yt.type.toLowerCase().replace("ms",""),Xr=$n[ai],Uo=xr[Yt.pointerType]||Yt.pointerType,Xo=Uo==on,ya=Sn(Fn,Yt.pointerId,"pointerId");Xr&en&&(Yt.button===0||Xo)?ya<0&&(Fn.push(Yt),ya=Fn.length-1):Xr&(er|sn)&&(dr=!0),!(ya<0)&&(Fn[ya]=Yt,this.callback(this.manager,Xr,{pointers:Fn,changedPointers:[Yt],pointerType:Uo,srcEvent:Yt}),dr&&Fn.splice(ya,1))}});var Ne={touchstart:en,touchmove:xn,touchend:er,touchcancel:sn},et="touchstart",wt="touchstart touchmove touchend touchcancel";function qt(){this.evTarget=et,this.evWin=wt,this.started=!1,ln.apply(this,arguments)}ft(qt,ln,{handler:function(Yt){var Fn=Ne[Yt.type];if(Fn===en&&(this.started=!0),!!this.started){var dr=vn.call(this,Yt,Fn);Fn&(er|sn)&&dr[0].length-dr[1].length===0&&(this.started=!1),this.callback(this.manager,Fn,{pointers:dr[0],changedPointers:dr[1],pointerType:on,srcEvent:Yt})}}});function vn(Tt,Yt){var Fn=He(Tt.touches),dr=He(Tt.changedTouches);return Yt&(er|sn)&&(Fn=Ot(Fn.concat(dr),"identifier",!0)),[Fn,dr]}var yt={touchstart:en,touchmove:xn,touchend:er,touchcancel:sn},Jt="touchstart touchmove touchend touchcancel";function Qn(){this.evTarget=Jt,this.targetIds={},ln.apply(this,arguments)}ft(Qn,ln,{handler:function(Yt){var Fn=yt[Yt.type],dr=Er.call(this,Yt,Fn);dr&&this.callback(this.manager,Fn,{pointers:dr[0],changedPointers:dr[1],pointerType:on,srcEvent:Yt})}});function Er(Tt,Yt){var Fn=He(Tt.touches),dr=this.targetIds;if(Yt&(en|xn)&&Fn.length===1)return dr[Fn[0].identifier]=!0,[Fn,Fn];var ai,Xr,Uo=He(Tt.changedTouches),Xo=[],ya=this.target;if(Xr=Fn.filter(function(vs){return bt(vs.target,ya)}),Yt===en)for(ai=0;ai<Xr.length;)dr[Xr[ai].identifier]=!0,ai++;for(ai=0;ai<Uo.length;)dr[Uo[ai].identifier]&&Xo.push(Uo[ai]),Yt&(er|sn)&&delete dr[Uo[ai].identifier],ai++;if(Xo.length)return[Ot(Xr.concat(Xo),"identifier",!0),Xo]}var Vr=2500,mr=25;function kr(){ln.apply(this,arguments);var Tt=Zt(this.handler,this);this.touch=new Qn(this.manager,Tt),this.mouse=new Tn(this.manager,Tt),this.primaryTouch=null,this.lastTouches=[]}ft(kr,ln,{handler:function(Yt,Fn,dr){var ai=dr.pointerType==on,Xr=dr.pointerType==jn;if(!(Xr&&dr.sourceCapabilities&&dr.sourceCapabilities.firesTouchEvents)){if(ai)Ei.call(this,Fn,dr);else if(Xr&&ar.call(this,dr))return;this.callback(Yt,Fn,dr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ei(Tt,Yt){Tt&en?(this.primaryTouch=Yt.changedPointers[0].identifier,Oi.call(this,Yt)):Tt&(er|sn)&&Oi.call(this,Yt)}function Oi(Tt){var Yt=Tt.changedPointers[0];if(Yt.identifier===this.primaryTouch){var Fn={x:Yt.clientX,y:Yt.clientY};this.lastTouches.push(Fn);var dr=this.lastTouches,ai=function(){var Xr=dr.indexOf(Fn);Xr>-1&&dr.splice(Xr,1)};setTimeout(ai,Vr)}}function ar(Tt){for(var Yt=Tt.srcEvent.clientX,Fn=Tt.srcEvent.clientY,dr=0;dr<this.lastTouches.length;dr++){var ai=this.lastTouches[dr],Xr=Math.abs(Yt-ai.x),Uo=Math.abs(Fn-ai.y);if(Xr<=mr&&Uo<=mr)return!0}return!1}var Kr=Ce(se.style,"touchAction"),hi=Kr!==re,Qr="compute",Io="auto",Ii="manipulation",Fo="none",_a="pan-x",Co="pan-y",Qo=kt();function De(Tt,Yt){this.manager=Tt,this.set(Yt)}De.prototype={set:function(Tt){Tt==Qr&&(Tt=this.compute()),hi&&this.manager.element.style&&Qo[Tt]&&(this.manager.element.style[Kr]=Tt),this.actions=Tt.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Tt=[];return Te(this.manager.recognizers,function(Yt){pt(Yt.options.enable,[Yt])&&(Tt=Tt.concat(Yt.getTouchAction()))}),Je(Tt.join(" "))},preventDefaults:function(Tt){var Yt=Tt.srcEvent,Fn=Tt.offsetDirection;if(this.manager.session.prevented){Yt.preventDefault();return}var dr=this.actions,ai=gt(dr,Fo)&&!Qo[Fo],Xr=gt(dr,Co)&&!Qo[Co],Uo=gt(dr,_a)&&!Qo[_a];if(ai){var Xo=Tt.pointers.length===1,ya=Tt.distance<2,vs=Tt.deltaTime<250;if(Xo&&ya&&vs)return}if(!(Uo&&Xr)&&(ai||Xr&&Fn&U||Uo&&Fn&ue))return this.preventSrc(Yt)},preventSrc:function(Tt){this.manager.session.prevented=!0,Tt.preventDefault()}};function Je(Tt){if(gt(Tt,Fo))return Fo;var Yt=gt(Tt,_a),Fn=gt(Tt,Co);return Yt&&Fn?Fo:Yt||Fn?Yt?_a:Co:gt(Tt,Ii)?Ii:Io}function kt(){if(!hi)return!1;var Tt={},Yt=X.CSS&&X.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Fn){Tt[Fn]=Yt?X.CSS.supports("touch-action",Fn):!0}),Tt}var un=1,Bn=2,kn=4,pn=8,On=pn,vr=16,fr=32;function ci(Tt){this.options=le({},this.defaults,Tt||{}),this.id=$e(),this.manager=null,this.options.enable=vt(this.options.enable,!0),this.state=un,this.simultaneous={},this.requireFail=[]}ci.prototype={defaults:{},set:function(Tt){return le(this.options,Tt),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Tt){if(Be(Tt,"recognizeWith",this))return this;var Yt=this.simultaneous;return Tt=Jr(Tt,this),Yt[Tt.id]||(Yt[Tt.id]=Tt,Tt.recognizeWith(this)),this},dropRecognizeWith:function(Tt){return Be(Tt,"dropRecognizeWith",this)?this:(Tt=Jr(Tt,this),delete this.simultaneous[Tt.id],this)},requireFailure:function(Tt){if(Be(Tt,"requireFailure",this))return this;var Yt=this.requireFail;return Tt=Jr(Tt,this),Sn(Yt,Tt)===-1&&(Yt.push(Tt),Tt.requireFailure(this)),this},dropRequireFailure:function(Tt){if(Be(Tt,"dropRequireFailure",this))return this;Tt=Jr(Tt,this);var Yt=Sn(this.requireFail,Tt);return Yt>-1&&this.requireFail.splice(Yt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Tt){return!!this.simultaneous[Tt.id]},emit:function(Tt){var Yt=this,Fn=this.state;function dr(ai){Yt.manager.emit(ai,Tt)}Fn<pn&&dr(Yt.options.event+Gi(Fn)),dr(Yt.options.event),Tt.additionalEvent&&dr(Tt.additionalEvent),Fn>=pn&&dr(Yt.options.event+Gi(Fn))},tryEmit:function(Tt){if(this.canEmit())return this.emit(Tt);this.state=fr},canEmit:function(){for(var Tt=0;Tt<this.requireFail.length;){if(!(this.requireFail[Tt].state&(fr|un)))return!1;Tt++}return!0},recognize:function(Tt){var Yt=le({},Tt);if(!pt(this.options.enable,[this,Yt])){this.reset(),this.state=fr;return}this.state&(On|vr|fr)&&(this.state=un),this.state=this.process(Yt),this.state&(Bn|kn|pn|vr)&&this.tryEmit(Yt)},process:function(Tt){},getTouchAction:function(){},reset:function(){}};function Gi(Tt){return Tt&vr?"cancel":Tt&pn?"end":Tt&kn?"move":Tt&Bn?"start":""}function no(Tt){return Tt==Ft?"down":Tt==Qe?"up":Tt==Dt?"left":Tt==Me?"right":""}function Jr(Tt,Yt){var Fn=Yt.manager;return Fn?Fn.get(Tt):Tt}function ji(){ci.apply(this,arguments)}ft(ji,ci,{defaults:{pointers:1},attrTest:function(Tt){var Yt=this.options.pointers;return Yt===0||Tt.pointers.length===Yt},process:function(Tt){var Yt=this.state,Fn=Tt.eventType,dr=Yt&(Bn|kn),ai=this.attrTest(Tt);return dr&&(Fn&sn||!ai)?Yt|vr:dr||ai?Fn&er?Yt|pn:Yt&Bn?Yt|kn:Bn:fr}});function Di(){ji.apply(this,arguments),this.pX=null,this.pY=null}ft(Di,ji,{defaults:{event:"pan",threshold:10,pointers:1,direction:at},getTouchAction:function(){var Tt=this.options.direction,Yt=[];return Tt&U&&Yt.push(Co),Tt&ue&&Yt.push(_a),Yt},directionTest:function(Tt){var Yt=this.options,Fn=!0,dr=Tt.distance,ai=Tt.direction,Xr=Tt.deltaX,Uo=Tt.deltaY;return ai&Yt.direction||(Yt.direction&U?(ai=Xr===0?Ut:Xr<0?Dt:Me,Fn=Xr!=this.pX,dr=Math.abs(Tt.deltaX)):(ai=Uo===0?Ut:Uo<0?Qe:Ft,Fn=Uo!=this.pY,dr=Math.abs(Tt.deltaY))),Tt.direction=ai,Fn&&dr>Yt.threshold&&ai&Yt.direction},attrTest:function(Tt){return ji.prototype.attrTest.call(this,Tt)&&(this.state&Bn||!(this.state&Bn)&&this.directionTest(Tt))},emit:function(Tt){this.pX=Tt.deltaX,this.pY=Tt.deltaY;var Yt=no(Tt.direction);Yt&&(Tt.additionalEvent=this.options.event+Yt),this._super.emit.call(this,Tt)}});function Gr(){ji.apply(this,arguments)}ft(Gr,ji,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Fo]},attrTest:function(Tt){return this._super.attrTest.call(this,Tt)&&(Math.abs(Tt.scale-1)>this.options.threshold||this.state&Bn)},emit:function(Tt){if(Tt.scale!==1){var Yt=Tt.scale<1?"in":"out";Tt.additionalEvent=this.options.event+Yt}this._super.emit.call(this,Tt)}});function fo(){ci.apply(this,arguments),this._timer=null,this._input=null}ft(fo,ci,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Io]},process:function(Tt){var Yt=this.options,Fn=Tt.pointers.length===Yt.pointers,dr=Tt.distance<Yt.threshold,ai=Tt.deltaTime>Yt.time;if(this._input=Tt,!dr||!Fn||Tt.eventType&(er|sn)&&!ai)this.reset();else if(Tt.eventType&en)this.reset(),this._timer=ve(function(){this.state=On,this.tryEmit()},Yt.time,this);else if(Tt.eventType&er)return On;return fr},reset:function(){clearTimeout(this._timer)},emit:function(Tt){this.state===On&&(Tt&&Tt.eventType&er?this.manager.emit(this.options.event+"up",Tt):(this._input.timeStamp=te(),this.manager.emit(this.options.event,this._input)))}});function Ri(){ji.apply(this,arguments)}ft(Ri,ji,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Fo]},attrTest:function(Tt){return this._super.attrTest.call(this,Tt)&&(Math.abs(Tt.rotation)>this.options.threshold||this.state&Bn)}});function bo(){ji.apply(this,arguments)}ft(bo,ji,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:U|ue,pointers:1},getTouchAction:function(){return Di.prototype.getTouchAction.call(this)},attrTest:function(Tt){var Yt=this.options.direction,Fn;return Yt&(U|ue)?Fn=Tt.overallVelocity:Yt&U?Fn=Tt.overallVelocityX:Yt&ue&&(Fn=Tt.overallVelocityY),this._super.attrTest.call(this,Tt)&&Yt&Tt.offsetDirection&&Tt.distance>this.options.threshold&&Tt.maxPointers==this.options.pointers&&je(Fn)>this.options.velocity&&Tt.eventType&er},emit:function(Tt){var Yt=no(Tt.offsetDirection);Yt&&this.manager.emit(this.options.event+Yt,Tt),this.manager.emit(this.options.event,Tt)}});function xi(){ci.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ft(xi,ci,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ii]},process:function(Tt){var Yt=this.options,Fn=Tt.pointers.length===Yt.pointers,dr=Tt.distance<Yt.threshold,ai=Tt.deltaTime<Yt.time;if(this.reset(),Tt.eventType&en&&this.count===0)return this.failTimeout();if(dr&&ai&&Fn){if(Tt.eventType!=er)return this.failTimeout();var Xr=this.pTime?Tt.timeStamp-this.pTime<Yt.interval:!0,Uo=!this.pCenter||Gn(this.pCenter,Tt.center)<Yt.posThreshold;this.pTime=Tt.timeStamp,this.pCenter=Tt.center,!Uo||!Xr?this.count=1:this.count+=1,this._input=Tt;var Xo=this.count%Yt.taps;if(Xo===0)return this.hasRequireFailures()?(this._timer=ve(function(){this.state=On,this.tryEmit()},Yt.interval,this),Bn):On}return fr},failTimeout:function(){return this._timer=ve(function(){this.state=fr},this.options.interval,this),fr},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==On&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function wo(Tt,Yt){return Yt=Yt||{},Yt.recognizers=vt(Yt.recognizers,wo.defaults.preset),new Jo(Tt,Yt)}wo.VERSION="2.0.7",wo.defaults={domEvents:!1,touchAction:Qr,enable:!0,inputTarget:null,inputClass:null,preset:[[Ri,{enable:!1}],[Gr,{enable:!1},["rotate"]],[bo,{direction:U}],[Di,{direction:U},["swipe"]],[xi],[xi,{event:"doubletap",taps:2},["tap"]],[fo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ia=1,Ga=2;function Jo(Tt,Yt){this.options=le({},wo.defaults,Yt||{}),this.options.inputTarget=this.options.inputTarget||Tt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Tt,this.input=fn(this),this.touchAction=new De(this,this.options.touchAction),Wo(this,!0),Te(this.options.recognizers,function(Fn){var dr=this.add(new Fn[0](Fn[1]));Fn[2]&&dr.recognizeWith(Fn[2]),Fn[3]&&dr.requireFailure(Fn[3])},this)}Jo.prototype={set:function(Tt){return le(this.options,Tt),Tt.touchAction&&this.touchAction.update(),Tt.inputTarget&&(this.input.destroy(),this.input.target=Tt.inputTarget,this.input.init()),this},stop:function(Tt){this.session.stopped=Tt?Ga:ia},recognize:function(Tt){var Yt=this.session;if(!Yt.stopped){this.touchAction.preventDefaults(Tt);var Fn,dr=this.recognizers,ai=Yt.curRecognizer;(!ai||ai&&ai.state&On)&&(ai=Yt.curRecognizer=null);for(var Xr=0;Xr<dr.length;)Fn=dr[Xr],Yt.stopped!==Ga&&(!ai||Fn==ai||Fn.canRecognizeWith(ai))?Fn.recognize(Tt):Fn.reset(),!ai&&Fn.state&(Bn|kn|pn)&&(ai=Yt.curRecognizer=Fn),Xr++}},get:function(Tt){if(Tt instanceof ci)return Tt;for(var Yt=this.recognizers,Fn=0;Fn<Yt.length;Fn++)if(Yt[Fn].options.event==Tt)return Yt[Fn];return null},add:function(Tt){if(Be(Tt,"add",this))return this;var Yt=this.get(Tt.options.event);return Yt&&this.remove(Yt),this.recognizers.push(Tt),Tt.manager=this,this.touchAction.update(),Tt},remove:function(Tt){if(Be(Tt,"remove",this))return this;if(Tt=this.get(Tt),Tt){var Yt=this.recognizers,Fn=Sn(Yt,Tt);Fn!==-1&&(Yt.splice(Fn,1),this.touchAction.update())}return this},on:function(Tt,Yt){if(Tt!==re&&Yt!==re){var Fn=this.handlers;return Te(Ct(Tt),function(dr){Fn[dr]=Fn[dr]||[],Fn[dr].push(Yt)}),this}},off:function(Tt,Yt){if(Tt!==re){var Fn=this.handlers;return Te(Ct(Tt),function(dr){Yt?Fn[dr]&&Fn[dr].splice(Sn(Fn[dr],Yt),1):delete Fn[dr]}),this}},emit:function(Tt,Yt){this.options.domEvents&&Ha(Tt,Yt);var Fn=this.handlers[Tt]&&this.handlers[Tt].slice();if(!(!Fn||!Fn.length)){Yt.type=Tt,Yt.preventDefault=function(){Yt.srcEvent.preventDefault()};for(var dr=0;dr<Fn.length;)Fn[dr](Yt),dr++}},destroy:function(){this.element&&Wo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Wo(Tt,Yt){var Fn=Tt.element;if(Fn.style){var dr;Te(Tt.options.cssProps,function(ai,Xr){dr=Ce(Fn.style,Xr),Yt?(Tt.oldCssProps[dr]=Fn.style[dr],Fn.style[dr]=ai):Fn.style[dr]=Tt.oldCssProps[dr]||""}),Yt||(Tt.oldCssProps={})}}function Ha(Tt,Yt){var Fn=E.createEvent("Event");Fn.initEvent(Tt,!0,!0),Fn.gesture=Yt,Yt.target.dispatchEvent(Fn)}le(wo,{INPUT_START:en,INPUT_MOVE:xn,INPUT_END:er,INPUT_CANCEL:sn,STATE_POSSIBLE:un,STATE_BEGAN:Bn,STATE_CHANGED:kn,STATE_ENDED:pn,STATE_RECOGNIZED:On,STATE_CANCELLED:vr,STATE_FAILED:fr,DIRECTION_NONE:Ut,DIRECTION_LEFT:Dt,DIRECTION_RIGHT:Me,DIRECTION_UP:Qe,DIRECTION_DOWN:Ft,DIRECTION_HORIZONTAL:U,DIRECTION_VERTICAL:ue,DIRECTION_ALL:at,Manager:Jo,Input:ln,TouchAction:De,TouchInput:Qn,MouseInput:Tn,PointerEventInput:be,TouchMouseInput:kr,SingleTouchInput:qt,Recognizer:ci,AttrRecognizer:ji,Tap:xi,Pan:Di,Swipe:bo,Pinch:Gr,Rotate:Ri,Press:fo,on:ke,off:Re,each:Te,merge:xt,extend:Ze,assign:le,inherit:ft,bindFn:Zt,prefixed:Ce});var ds=typeof X!="undefined"?X:typeof self!="undefined"?self:{};ds.Hammer=wo,ee=function(){return wo}.call(W,D,W,$t),ee!==re&&($t.exports=ee)})(window,document,"Hammer")},47443:function($t,W,D){var ee=D(42118);function X(E,_e){var re=E==null?0:E.length;return!!re&&ee(E,_e,0)>-1}$t.exports=X},1196:function($t){function W(D,ee,X){for(var E=-1,_e=D==null?0:D.length;++E<_e;)if(X(ee,D[E]))return!0;return!1}$t.exports=W},29750:function($t){function W(D,ee,X){return D===D&&(X!==void 0&&(D=D<=X?D:X),ee!==void 0&&(D=D>=ee?D:ee)),D}$t.exports=W},41848:function($t){function W(D,ee,X,E){for(var _e=D.length,re=X+(E?1:-1);E?re--:++re<_e;)if(ee(D[re],re,D))return re;return-1}$t.exports=W},42118:function($t,W,D){var ee=D(41848),X=D(62722),E=D(39375);function _e(re,he,se){return he===he?E(re,he,se):ee(re,X,se)}$t.exports=_e},74221:function($t){function W(D,ee,X,E){for(var _e=X-1,re=D.length;++_e<re;)if(E(D[_e],ee))return _e;return-1}$t.exports=W},62722:function($t){function W(D){return D!==D}$t.exports=W},65464:function($t,W,D){var ee=D(29932),X=D(42118),E=D(74221),_e=D(51717),re=D(6450),he=Array.prototype,se=he.splice;function Se(oe,je,te,ve){var Be=ve?E:X,Te=-1,we=je.length,le=oe;for(oe===je&&(je=re(je)),te&&(le=ee(oe,_e(te)));++Te<we;)for(var Ze=0,xt=je[Te],ft=te?te(xt):xt;(Ze=Be(le,ft,Ze,ve))>-1;)le!==oe&&se.call(le,Ze,1),se.call(oe,Ze,1);return oe}$t.exports=Se},45652:function($t,W,D){var ee=D(88668),X=D(47443),E=D(1196),_e=D(74757),re=D(23593),he=D(21814),se=200;function Se(oe,je,te){var ve=-1,Be=X,Te=oe.length,we=!0,le=[],Ze=le;if(te)we=!1,Be=E;else if(Te>=se){var xt=je?null:re(oe);if(xt)return he(xt);we=!1,Be=_e,Ze=new ee}else Ze=je?[]:le;e:for(;++ve<Te;){var ft=oe[ve],Zt=je?je(ft):ft;if(ft=te||ft!==0?ft:0,we&&Zt===Zt){for(var pt=Ze.length;pt--;)if(Ze[pt]===Zt)continue e;je&&Ze.push(Zt),le.push(ft)}else Be(Ze,Zt,te)||(Ze!==le&&Ze.push(Zt),le.push(ft))}return le}$t.exports=Se},23593:function($t,W,D){var ee=D(58525),X=D(28117),E=D(21814),_e=1/0,re=ee&&1/E(new ee([,-0]))[1]==_e?function(he){return new ee(he)}:X;$t.exports=re},39375:function($t){function W(D,ee,X){for(var E=X-1,_e=D.length;++E<_e;)if(D[E]===ee)return E;return-1}$t.exports=W},74691:function($t,W,D){var ee=D(29750),X=D(14841);function E(_e,re,he){return he===void 0&&(he=re,re=void 0),he!==void 0&&(he=X(he),he=he===he?he:0),re!==void 0&&(re=X(re),re=re===re?re:0),ee(X(_e),re,he)}$t.exports=E},51584:function($t,W,D){var ee=D(44239),X=D(37005),E="[object Boolean]";function _e(re){return re===!0||re===!1||X(re)&&ee(re)==E}$t.exports=_e},18446:function($t,W,D){var ee=D(90939);function X(E,_e){return ee(E,_e)}$t.exports=X},14293:function($t){function W(D){return D==null}$t.exports=W},81763:function($t,W,D){var ee=D(44239),X=D(37005),E="[object Number]";function _e(re){return typeof re=="number"||X(re)&&ee(re)==E}$t.exports=_e},52353:function($t){function W(D){return D===void 0}$t.exports=W},30236:function($t,W,D){var ee=D(42980),X=D(21463),E=X(function(_e,re,he,se){ee(_e,re,he,se)});$t.exports=E},28117:function($t){function W(){}$t.exports=W},97019:function($t,W,D){var ee=D(5976),X=D(45604),E=ee(X);$t.exports=E},45604:function($t,W,D){var ee=D(65464);function X(E,_e){return E&&E.length&&_e&&_e.length?ee(E,_e):E}$t.exports=X},44908:function($t,W,D){var ee=D(45652);function X(E){return E&&E.length?ee(E):[]}$t.exports=X},73955:function($t,W,D){var ee=D(79833),X=0;function E(_e){var re=++X;return ee(_e)+re}$t.exports=E},6158:function($t){(function(W,D){$t.exports=D()})(this,function(){"use strict";var W,D,ee;function X(E,_e){if(!W)W=_e;else if(!D)D=_e;else{var re="var sharedChunk = {}; ("+W+")(sharedChunk); ("+D+")(sharedChunk);",he={};W(he),ee=_e(he),typeof window!="undefined"&&(ee.workerUrl=window.URL.createObjectURL(new Blob([re],{type:"text/javascript"})))}}return X(["exports"],function(E){"use strict";function _e(c,d){return c(d={exports:{}},d.exports),d.exports}var re=he;function he(c,d,g,A){this.cx=3*c,this.bx=3*(g-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(A-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=A,this.p2x=g,this.p2y=A}he.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c},he.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c},he.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},he.prototype.solveCurveX=function(c,d){var g,A,M,B,V;for(d===void 0&&(d=1e-6),M=c,V=0;V<8;V++){if(B=this.sampleCurveX(M)-c,Math.abs(B)<d)return M;var Q=this.sampleCurveDerivativeX(M);if(Math.abs(Q)<1e-6)break;M-=B/Q}if((M=c)<(g=0))return g;if(M>(A=1))return A;for(;g<A;){if(B=this.sampleCurveX(M),Math.abs(B-c)<d)return M;c>B?g=M:A=M,M=.5*(A-g)+g}return M},he.prototype.solve=function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))};var se=Se;function Se(c,d){this.x=c,this.y=d}Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,d){return this.clone()._rotateAround(c,d)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var d=c.x-this.x,g=c.y-this.y;return d*d+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)},_matMult:function(c){var d=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=d,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var d=Math.cos(c),g=Math.sin(c),A=g*this.x+d*this.y;return this.x=d*this.x-g*this.y,this.y=A,this},_rotateAround:function(c,d){var g=Math.cos(c),A=Math.sin(c),M=d.y+A*(this.x-d.x)+g*(this.y-d.y);return this.x=d.x+g*(this.x-d.x)-A*(this.y-d.y),this.y=M,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Se.convert=function(c){return c instanceof Se?c:Array.isArray(c)?new Se(c[0],c[1]):c};var oe=typeof self!="undefined"?self:{},je=Math.pow(2,53)-1;function te(c,d,g,A){var M=new re(c,d,g,A);return function(B){return M.solve(B)}}var ve=te(.25,.1,.25,1);function Be(c,d,g){return Math.min(g,Math.max(d,c))}function Te(c,d,g){var A=g-d,M=((c-d)%A+A)%A+d;return M===d?g:M}function we(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var A=0,M=d;A<M.length;A+=1){var B=M[A];for(var V in B)c[V]=B[V]}return c}var le=1;function Ze(){return le++}function xt(){return function c(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function ft(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Zt(c,d){c.forEach(function(g){d[g]&&(d[g]=d[g].bind(d))})}function pt(c,d){return c.indexOf(d,c.length-d.length)!==-1}function vt(c,d,g){var A={};for(var M in c)A[M]=d.call(g||this,c[M],M,c);return A}function ke(c,d,g){var A={};for(var M in c)d.call(g||this,c[M],M,c)&&(A[M]=c[M]);return A}function Re(c){return Array.isArray(c)?c.map(Re):typeof c=="object"&&c?vt(c,Re):c}var bt={};function gt(c){bt[c]||(typeof console!="undefined"&&console.warn(c),bt[c]=!0)}function Ct(c,d,g){return(g.y-c.y)*(d.x-c.x)>(d.y-c.y)*(g.x-c.x)}function Sn(c){for(var d=0,g=0,A=c.length,M=A-1,B=void 0,V=void 0;g<A;M=g++)d+=((V=c[M]).x-(B=c[g]).x)*(B.y+V.y);return d}function He(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Ot(c){var d={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(A,M,B,V){var Q=B||V;return d[M]=!Q||Q.toLowerCase(),""}),d["max-age"]){var g=parseInt(d["max-age"],10);isNaN(g)?delete d["max-age"]:d["max-age"]=g}return d}var Ce=null;function ot(c){if(Ce==null){var d=c.navigator?c.navigator.userAgent:null;Ce=!!c.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Ce}function $e(c){try{var d=oe[c];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch(g){return!1}}var Xe,Rt,_t,Pe,Wt=oe.performance&&oe.performance.now?oe.performance.now.bind(oe.performance):Date.now.bind(Date),on=oe.requestAnimationFrame||oe.mozRequestAnimationFrame||oe.webkitRequestAnimationFrame||oe.msRequestAnimationFrame,Nn=oe.cancelAnimationFrame||oe.mozCancelAnimationFrame||oe.webkitCancelAnimationFrame||oe.msCancelAnimationFrame,jn={now:Wt,frame:function(c){var d=on(c);return{cancel:function(){return Nn(d)}}},getImageData:function(c,d){d===void 0&&(d=0);var g=oe.document.createElement("canvas"),A=g.getContext("2d");if(!A)throw new Error("failed to create canvas 2d context");return g.width=c.width,g.height=c.height,A.drawImage(c,0,0,c.width,c.height),A.getImageData(-d,-d,c.width+2*d,c.height+2*d)},resolveURL:function(c){return Xe||(Xe=oe.document.createElement("a")),Xe.href=c,Xe.href},hardwareConcurrency:oe.navigator&&oe.navigator.hardwareConcurrency||4,get devicePixelRatio(){return oe.devicePixelRatio},get prefersReducedMotion(){return!!oe.matchMedia&&(Rt==null&&(Rt=oe.matchMedia("(prefers-reduced-motion: reduce)")),Rt.matches)}},lr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Vt={supported:!1,testSupport:function(c){!en&&Pe&&(xn?er(c):_t=c)}},en=!1,xn=!1;function er(c){var d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Pe),c.isContextLost())return;Vt.supported=!0}catch(g){}c.deleteTexture(d),en=!0}oe.document&&((Pe=oe.document.createElement("img")).onload=function(){_t&&er(_t),_t=null,xn=!0},Pe.onerror=function(){en=!0,_t=null},Pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var sn="01",Ut=function(c,d){this._transformRequestFn=c,this._customAccessToken=d,this._createSkuToken()};function Dt(c){return c.indexOf("mapbox:")===0}Ut.prototype._createSkuToken=function(){var c=function(){for(var d="",g=0;g<10;g++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",sn,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt},Ut.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ut.prototype.transformRequest=function(c,d){return this._transformRequestFn&&this._transformRequestFn(c,d)||{url:c}},Ut.prototype.normalizeStyleURL=function(c,d){if(!Dt(c))return c;var g=U(c);return g.path="/styles/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},Ut.prototype.normalizeGlyphsURL=function(c,d){if(!Dt(c))return c;var g=U(c);return g.path="/fonts/v1"+g.path,this._makeAPIURL(g,this._customAccessToken||d)},Ut.prototype.normalizeSourceURL=function(c,d){if(!Dt(c))return c;var g=U(c);return g.path="/v4/"+g.authority+".json",g.params.push("secure"),this._makeAPIURL(g,this._customAccessToken||d)},Ut.prototype.normalizeSpriteURL=function(c,d,g,A){var M=U(c);return Dt(c)?(M.path="/styles/v1"+M.path+"/sprite"+d+g,this._makeAPIURL(M,this._customAccessToken||A)):(M.path+=""+d+g,ue(M))},Ut.prototype.normalizeTileURL=function(c,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Dt(c))return c;var g=U(c);g.path=g.path.replace(/(\.(png|jpg)\d*)(?=$)/,(jn.devicePixelRatio>=2||d===512?"@2x":"")+(Vt.supported?".webp":"$1")),g.path=g.path.replace(/^.+\/v4\//,"/"),g.path="/v4"+g.path;var A=this._customAccessToken||function(M){for(var B=0,V=M;B<V.length;B+=1){var Q=V[B].match(/^access_token=(.*)$/);if(Q)return Q[1]}return null}(g.params)||lr.ACCESS_TOKEN;return lr.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&g.params.push("sku="+this._skuToken),this._makeAPIURL(g,A)},Ut.prototype.canonicalizeTileURL=function(c,d){var g=U(c);if(!g.path.match(/(^\/v4\/)/)||!g.path.match(/\.[\w]+$/))return c;var A="mapbox://tiles/";A+=g.path.replace("/v4/","");var M=g.params;return d&&(M=M.filter(function(B){return!B.match(/^access_token=/)})),M.length&&(A+="?"+M.join("&")),A},Ut.prototype.canonicalizeTileset=function(c,d){for(var g=!!d&&Dt(d),A=[],M=0,B=c.tiles||[];M<B.length;M+=1){var V=B[M];Qe(V)?A.push(this.canonicalizeTileURL(V,g)):A.push(V)}return A},Ut.prototype._makeAPIURL=function(c,d){var g="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",A=U(lr.API_URL);if(c.protocol=A.protocol,c.authority=A.authority,c.protocol==="http"){var M=c.params.indexOf("secure");M>=0&&c.params.splice(M,1)}if(A.path!=="/"&&(c.path=""+A.path+c.path),!lr.REQUIRE_ACCESS_TOKEN)return ue(c);if(!(d=d||lr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+g);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+g);return c.params=c.params.filter(function(B){return B.indexOf("access_token")===-1}),c.params.push("access_token="+d),ue(c)};var Me=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Qe(c){return Me.test(c)}var Ft=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function U(c){var d=c.match(Ft);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function ue(c){var d=c.params.length?"?"+c.params.join("&"):"";return c.protocol+"://"+c.authority+c.path+d}function at(c){if(!c)return null;var d=c.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(oe.atob(d[1]).split("").map(function(g){return"%"+("00"+g.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(g){return null}}var ce=function(c){this.type=c,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ce.prototype.getStorageKey=function(c){var d,g=at(lr.ACCESS_TOKEN);return d=g&&g.u?oe.btoa(encodeURIComponent(g.u).replace(/%([0-9A-F]{2})/g,function(A,M){return String.fromCharCode(+("0x"+M))})):lr.ACCESS_TOKEN||"",c?"mapbox.eventData."+c+":"+d:"mapbox.eventData:"+d},ce.prototype.fetchEventData=function(){var c=$e("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{var A=oe.localStorage.getItem(d);A&&(this.eventData=JSON.parse(A));var M=oe.localStorage.getItem(g);M&&(this.anonId=M)}catch(B){gt("Unable to read from LocalStorage")}},ce.prototype.saveEventData=function(){var c=$e("localStorage"),d=this.getStorageKey(),g=this.getStorageKey("uuid");if(c)try{oe.localStorage.setItem(g,this.anonId),Object.keys(this.eventData).length>=1&&oe.localStorage.setItem(d,JSON.stringify(this.eventData))}catch(A){gt("Unable to write to LocalStorage")}},ce.prototype.processRequests=function(c){},ce.prototype.postEvent=function(c,d,g,A){var M=this;if(lr.EVENTS_URL){var B=U(lr.EVENTS_URL);B.params.push("access_token="+(A||lr.ACCESS_TOKEN||""));var V={event:this.type,created:new Date(c).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:sn,userId:this.anonId},Q=d?we(V,d):V,me={url:ue(B),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Q])};this.pendingRequest=qn(me,function(Le){M.pendingRequest=null,g(Le),M.saveEventData(),M.processRequests(A)})}},ce.prototype.queueRequest=function(c,d){this.queue.push(c),this.processRequests(d)};var j,ln,fn=function(c){function d(){c.call(this,"map.load"),this.success={},this.skuToken=""}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(g,A,M,B){this.skuToken=M;var V=!(!B&&!lr.ACCESS_TOKEN),Q=Array.isArray(g)&&g.some(function(me){return Dt(me)||Qe(me)});lr.EVENTS_URL&&V&&Q&&this.queueRequest({id:A,timestamp:Date.now()},B)},d.prototype.processRequests=function(g){var A=this;if(!this.pendingRequest&&this.queue.length!==0){var M=this.queue.shift(),B=M.id,V=M.timestamp;B&&this.success[B]||(this.anonId||this.fetchEventData(),ft(this.anonId)||(this.anonId=xt()),this.postEvent(V,{skuToken:this.skuToken},function(Q){Q||B&&(A.success[B]=!0)},g))}},d}(ce),mt=new(function(c){function d(g){c.call(this,"appUserTurnstile"),this._customAccessToken=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(g,A){lr.EVENTS_URL&&lr.ACCESS_TOKEN&&Array.isArray(g)&&g.some(function(M){return Dt(M)||Qe(M)})&&this.queueRequest(Date.now(),A)},d.prototype.processRequests=function(g){var A=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var M=at(lr.ACCESS_TOKEN),B=M?M.u:lr.ACCESS_TOKEN,V=B!==this.eventData.tokenU;ft(this.anonId)||(this.anonId=xt(),V=!0);var Q=this.queue.shift();if(this.eventData.lastSuccess){var me=new Date(this.eventData.lastSuccess),Le=new Date(Q),We=(Q-this.eventData.lastSuccess)/864e5;V=V||We>=1||We<-1||me.getDate()!==Le.getDate()}else V=!0;if(!V)return this.processRequests();this.postEvent(Q,{"enabled.telemetry":!1},function(tt){tt||(A.eventData.lastSuccess=Q,A.eventData.tokenU=B)},g)}},d}(ce)),Gt=mt.postTurnstileEvent.bind(mt),Wn=new fn,hn=Wn.postMapLoadEvent.bind(Wn),ht=500,Ht=50;function Cn(){oe.caches&&!j&&(j=oe.caches.open("mapbox-tiles"))}function Ln(c){var d=c.indexOf("?");return d<0?c:c.slice(0,d)}var Gn,dt=1/0;function ye(){return Gn==null&&(Gn=oe.OffscreenCanvas&&new oe.OffscreenCanvas(1,1).getContext("2d")&&typeof oe.createImageBitmap=="function"),Gn}var Fe={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Fe);var nt=function(c){function d(g,A,M){A===401&&Qe(M)&&(g+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),c.call(this,g),this.status=A,this.url=M,this.name=this.constructor.name,this.message=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),Pt=He()?function(){return self.worker&&self.worker.referrer}:function(){return(oe.location.protocol==="blob:"?oe.parent:oe).location.href},Mt,Tn,$n=function(c,d){if(!(/^file:/.test(g=c.url)||/^file:/.test(Pt())&&!/^\w+:/.test(g))){if(oe.fetch&&oe.Request&&oe.AbortController&&oe.Request.prototype.hasOwnProperty("signal"))return function(A,M){var B,V=new oe.AbortController,Q=new oe.Request(A.url,{method:A.method||"GET",body:A.body,credentials:A.credentials,headers:A.headers,referrer:Pt(),signal:V.signal}),me=!1,Le=!1,We=(B=Q.url).indexOf("sku=")>0&&Qe(B);A.type==="json"&&Q.headers.set("Accept","application/json");var tt=function(Nt,tn,_n){if(!Le){if(Nt&&Nt.message!=="SecurityError"&&gt(Nt),tn&&_n)return Et(tn);var zn=Date.now();oe.fetch(Q).then(function(Dn){if(Dn.ok){var cr=We?Dn.clone():null;return Et(Dn,cr,zn)}return M(new nt(Dn.statusText,Dn.status,A.url))}).catch(function(Dn){Dn.code!==20&&M(new Error(Dn.message))})}},Et=function(Nt,tn,_n){(A.type==="arrayBuffer"?Nt.arrayBuffer():A.type==="json"?Nt.json():Nt.text()).then(function(zn){Le||(tn&&_n&&function(Dn,cr,_r){if(Cn(),j){var Ir={status:cr.status,statusText:cr.statusText,headers:new oe.Headers};cr.headers.forEach(function(jr,bi){return Ir.headers.set(bi,jr)});var Br=Ot(cr.headers.get("Cache-Control")||"");Br["no-store"]||(Br["max-age"]&&Ir.headers.set("Expires",new Date(_r+1e3*Br["max-age"]).toUTCString()),new Date(Ir.headers.get("Expires")).getTime()-_r<42e4||function(jr,bi){if(ln===void 0)try{new Response(new ReadableStream),ln=!0}catch(Zi){ln=!1}ln?bi(jr.body):jr.blob().then(bi)}(cr,function(jr){var bi=new oe.Response(jr,Ir);Cn(),j&&j.then(function(Zi){return Zi.put(Ln(Dn.url),bi)}).catch(function(Zi){return gt(Zi.message)})}))}}(Q,tn,_n),me=!0,M(null,zn,Nt.headers.get("Cache-Control"),Nt.headers.get("Expires")))}).catch(function(zn){Le||M(new Error(zn.message))})};return We?function(Nt,tn){if(Cn(),!j)return tn(null);var _n=Ln(Nt.url);j.then(function(zn){zn.match(_n).then(function(Dn){var cr=function(_r){if(!_r)return!1;var Ir=new Date(_r.headers.get("Expires")||0),Br=Ot(_r.headers.get("Cache-Control")||"");return Ir>Date.now()&&!Br["no-cache"]}(Dn);zn.delete(_n),cr&&zn.put(_n,Dn.clone()),tn(null,Dn,cr)}).catch(tn)}).catch(tn)}(Q,tt):tt(null,null),{cancel:function(){Le=!0,me||V.abort()}}}(c,d);if(He()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,d,void 0,!0)}var g;return function(A,M){var B=new oe.XMLHttpRequest;for(var V in B.open(A.method||"GET",A.url,!0),A.type==="arrayBuffer"&&(B.responseType="arraybuffer"),A.headers)B.setRequestHeader(V,A.headers[V]);return A.type==="json"&&(B.responseType="text",B.setRequestHeader("Accept","application/json")),B.withCredentials=A.credentials==="include",B.onerror=function(){M(new Error(B.statusText))},B.onload=function(){if((B.status>=200&&B.status<300||B.status===0)&&B.response!==null){var Q=B.response;if(A.type==="json")try{Q=JSON.parse(B.response)}catch(me){return M(me)}M(null,Q,B.getResponseHeader("Cache-Control"),B.getResponseHeader("Expires"))}else M(new nt(B.statusText,B.status,A.url))},B.send(A.body),{cancel:function(){return B.abort()}}}(c,d)},xr=function(c,d){return $n(we(c,{type:"arrayBuffer"}),d)},qn=function(c,d){return $n(we(c,{method:"POST"}),d)},Ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Mt=[],Tn=0;var be=function(c,d){if(Vt.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Tn>=lr.MAX_PARALLEL_IMAGE_REQUESTS){var g={requestParameters:c,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return Mt.push(g),g}Tn++;var A=!1,M=function(){if(!A)for(A=!0,Tn--;Mt.length&&Tn<lr.MAX_PARALLEL_IMAGE_REQUESTS;){var V=Mt.shift();V.cancelled||(V.cancel=be(V.requestParameters,V.callback).cancel)}},B=xr(c,function(V,Q,me,Le){M(),V?d(V):Q&&(ye()?function(We,tt){var Et=new oe.Blob([new Uint8Array(We)],{type:"image/png"});oe.createImageBitmap(Et).then(function(Nt){tt(null,Nt)}).catch(function(Nt){tt(new Error("Could not load image because of "+Nt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(Q,d):function(We,tt,Et,Nt){var tn=new oe.Image,_n=oe.URL;tn.onload=function(){tt(null,tn),_n.revokeObjectURL(tn.src),tn.onload=null,oe.requestAnimationFrame(function(){tn.src=Ae})},tn.onerror=function(){return tt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var zn=new oe.Blob([new Uint8Array(We)],{type:"image/png"});tn.cacheControl=Et,tn.expires=Nt,tn.src=We.byteLength?_n.createObjectURL(zn):Ae}(Q,d,me,Le))});return{cancel:function(){B.cancel(),M()}}};function Ne(c,d,g){g[c]&&g[c].indexOf(d)!==-1||(g[c]=g[c]||[],g[c].push(d))}function et(c,d,g){if(g&&g[c]){var A=g[c].indexOf(d);A!==-1&&g[c].splice(A,1)}}var wt=function(c,d){d===void 0&&(d={}),we(this,d),this.type=c},qt=function(c){function d(g,A){A===void 0&&(A={}),c.call(this,"error",we({error:g},A))}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(wt),vn=function(){};vn.prototype.on=function(c,d){return this._listeners=this._listeners||{},Ne(c,d,this._listeners),this},vn.prototype.off=function(c,d){return et(c,d,this._listeners),et(c,d,this._oneTimeListeners),this},vn.prototype.once=function(c,d){return this._oneTimeListeners=this._oneTimeListeners||{},Ne(c,d,this._oneTimeListeners),this},vn.prototype.fire=function(c,d){typeof c=="string"&&(c=new wt(c,d||{}));var g=c.type;if(this.listens(g)){c.target=this;for(var A=0,M=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];A<M.length;A+=1)M[A].call(this,c);for(var B=0,V=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];B<V.length;B+=1){var Q=V[B];et(g,Q,this._oneTimeListeners),Q.call(this,c)}var me=this._eventedParent;me&&(we(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),me.fire(c))}else c instanceof qt&&console.error(c.error);return this},vn.prototype.listens=function(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)},vn.prototype.setEventedParent=function(c,d){return this._eventedParent=c,this._eventedParentData=d,this};var yt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Jt=function(c,d,g,A){this.message=(c?c+": ":"")+g,A&&(this.identifier=A),d!=null&&d.__line__&&(this.line=d.__line__)};function Qn(c){var d=c.value;return d?[new Jt(c.key,d,"constants have been deprecated as of v8")]:[]}function Er(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];for(var A=0,M=d;A<M.length;A+=1){var B=M[A];for(var V in B)c[V]=B[V]}return c}function Vr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function mr(c){if(Array.isArray(c))return c.map(mr);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){var d={};for(var g in c)d[g]=mr(c[g]);return d}return Vr(c)}var kr=function(c){function d(g,A){c.call(this,A),this.message=A,this.key=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Error),Ei=function(c,d){d===void 0&&(d=[]),this.parent=c,this.bindings={};for(var g=0,A=d;g<A.length;g+=1){var M=A[g];this.bindings[M[0]]=M[1]}};Ei.prototype.concat=function(c){return new Ei(this,c)},Ei.prototype.get=function(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(c+" not found in scope.")},Ei.prototype.has=function(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)};var Oi={kind:"null"},ar={kind:"number"},Kr={kind:"string"},hi={kind:"boolean"},Qr={kind:"color"},Io={kind:"object"},Ii={kind:"value"},Fo={kind:"collator"},_a={kind:"formatted"},Co={kind:"resolvedImage"};function Qo(c,d){return{kind:"array",itemType:c,N:d}}function De(c){if(c.kind==="array"){var d=De(c.itemType);return typeof c.N=="number"?"array<"+d+", "+c.N+">":c.itemType.kind==="value"?"array":"array<"+d+">"}return c.kind}var Je=[Oi,ar,Kr,hi,Qr,_a,Io,Qo(Ii),Co];function kt(c,d){if(d.kind==="error")return null;if(c.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!kt(c.itemType,d.itemType))&&(typeof c.N!="number"||c.N===d.N))return null}else{if(c.kind===d.kind)return null;if(c.kind==="value"){for(var g=0,A=Je;g<A.length;g+=1)if(!kt(A[g],d))return null}}return"Expected "+De(c)+" but found "+De(d)+" instead."}function un(c,d){return d.some(function(g){return g.kind===c.kind})}function Bn(c,d){return d.some(function(g){return g==="null"?c===null:g==="array"?Array.isArray(c):g==="object"?c&&!Array.isArray(c)&&typeof c=="object":g===typeof c})}var kn=_e(function(c,d){var g={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function A(Q){return(Q=Math.round(Q))<0?0:Q>255?255:Q}function M(Q){return A(Q[Q.length-1]==="%"?parseFloat(Q)/100*255:parseInt(Q))}function B(Q){return(me=Q[Q.length-1]==="%"?parseFloat(Q)/100:parseFloat(Q))<0?0:me>1?1:me;var me}function V(Q,me,Le){return Le<0?Le+=1:Le>1&&(Le-=1),6*Le<1?Q+(me-Q)*Le*6:2*Le<1?me:3*Le<2?Q+(me-Q)*(2/3-Le)*6:Q}try{d.parseCSSColor=function(Q){var me,Le=Q.replace(/ /g,"").toLowerCase();if(Le in g)return g[Le].slice();if(Le[0]==="#")return Le.length===4?(me=parseInt(Le.substr(1),16))>=0&&me<=4095?[(3840&me)>>4|(3840&me)>>8,240&me|(240&me)>>4,15&me|(15&me)<<4,1]:null:Le.length===7&&(me=parseInt(Le.substr(1),16))>=0&&me<=16777215?[(16711680&me)>>16,(65280&me)>>8,255&me,1]:null;var We=Le.indexOf("("),tt=Le.indexOf(")");if(We!==-1&&tt+1===Le.length){var Et=Le.substr(0,We),Nt=Le.substr(We+1,tt-(We+1)).split(","),tn=1;switch(Et){case"rgba":if(Nt.length!==4)return null;tn=B(Nt.pop());case"rgb":return Nt.length!==3?null:[M(Nt[0]),M(Nt[1]),M(Nt[2]),tn];case"hsla":if(Nt.length!==4)return null;tn=B(Nt.pop());case"hsl":if(Nt.length!==3)return null;var _n=(parseFloat(Nt[0])%360+360)%360/360,zn=B(Nt[1]),Dn=B(Nt[2]),cr=Dn<=.5?Dn*(zn+1):Dn+zn-Dn*zn,_r=2*Dn-cr;return[A(255*V(_r,cr,_n+1/3)),A(255*V(_r,cr,_n)),A(255*V(_r,cr,_n-1/3)),tn];default:return null}}return null}}catch(Q){}}).parseCSSColor,pn=function(c,d,g,A){A===void 0&&(A=1),this.r=c,this.g=d,this.b=g,this.a=A};pn.parse=function(c){if(c){if(c instanceof pn)return c;if(typeof c=="string"){var d=kn(c);if(d)return new pn(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},pn.prototype.toString=function(){var c=this.toArray(),d=c[1],g=c[2],A=c[3];return"rgba("+Math.round(c[0])+","+Math.round(d)+","+Math.round(g)+","+A+")"},pn.prototype.toArray=function(){var c=this.a;return c===0?[0,0,0,0]:[255*this.r/c,255*this.g/c,255*this.b/c,c]},pn.black=new pn(0,0,0,1),pn.white=new pn(1,1,1,1),pn.transparent=new pn(0,0,0,0),pn.red=new pn(1,0,0,1);var On=function(c,d,g){this.sensitivity=c?d?"variant":"case":d?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};On.prototype.compare=function(c,d){return this.collator.compare(c,d)},On.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var vr=function(c,d,g,A,M){this.text=c,this.image=d,this.scale=g,this.fontStack=A,this.textColor=M},fr=function(c){this.sections=c};fr.fromString=function(c){return new fr([new vr(c,null,null,null,null)])},fr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(c){return c.text.length!==0||c.image&&c.image.name.length!==0})},fr.factory=function(c){return c instanceof fr?c:fr.fromString(c)},fr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(c){return c.text}).join("")},fr.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var A=g[d];if(A.image)c.push(["image",A.image.name]);else{c.push(A.text);var M={};A.fontStack&&(M["text-font"]=["literal",A.fontStack.split(",")]),A.scale&&(M["font-scale"]=A.scale),A.textColor&&(M["text-color"]=["rgba"].concat(A.textColor.toArray())),c.push(M)}}return c};var ci=function(c){this.name=c.name,this.available=c.available};function Gi(c,d,g,A){return typeof c=="number"&&c>=0&&c<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof g=="number"&&g>=0&&g<=255?A===void 0||typeof A=="number"&&A>=0&&A<=1?null:"Invalid rgba value ["+[c,d,g,A].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof A=="number"?[c,d,g,A]:[c,d,g]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function no(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof pn||c instanceof On||c instanceof fr||c instanceof ci)return!0;if(Array.isArray(c)){for(var d=0,g=c;d<g.length;d+=1)if(!no(g[d]))return!1;return!0}if(typeof c=="object"){for(var A in c)if(!no(c[A]))return!1;return!0}return!1}function Jr(c){if(c===null)return Oi;if(typeof c=="string")return Kr;if(typeof c=="boolean")return hi;if(typeof c=="number")return ar;if(c instanceof pn)return Qr;if(c instanceof On)return Fo;if(c instanceof fr)return _a;if(c instanceof ci)return Co;if(Array.isArray(c)){for(var d,g=c.length,A=0,M=c;A<M.length;A+=1){var B=Jr(M[A]);if(d){if(d===B)continue;d=Ii;break}d=B}return Qo(d||Ii,g)}return Io}function ji(c){var d=typeof c;return c===null?"":d==="string"||d==="number"||d==="boolean"?String(c):c instanceof pn||c instanceof fr||c instanceof ci?c.toString():JSON.stringify(c)}ci.prototype.toString=function(){return this.name},ci.fromString=function(c){return c?new ci({name:c,available:!1}):null},ci.prototype.serialize=function(){return["image",this.name]};var Di=function(c,d){this.type=c,this.value=d};Di.parse=function(c,d){if(c.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(!no(c[1]))return d.error("invalid value");var g=c[1],A=Jr(g),M=d.expectedType;return A.kind!=="array"||A.N!==0||!M||M.kind!=="array"||typeof M.N=="number"&&M.N!==0||(A=M),new Di(A,g)},Di.prototype.evaluate=function(){return this.value},Di.prototype.eachChild=function(){},Di.prototype.outputDefined=function(){return!0},Di.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof pn?["rgba"].concat(this.value.toArray()):this.value instanceof fr?this.value.serialize():this.value};var Gr=function(c){this.name="ExpressionEvaluationError",this.message=c};Gr.prototype.toJSON=function(){return this.message};var fo={string:Kr,number:ar,boolean:hi,object:Io},Ri=function(c,d){this.type=c,this.args=d};Ri.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g,A=1,M=c[0];if(M==="array"){var B,V;if(c.length>2){var Q=c[1];if(typeof Q!="string"||!(Q in fo)||Q==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);B=fo[Q],A++}else B=Ii;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return d.error('The length argument to "array" must be a positive integer literal',2);V=c[2],A++}g=Qo(B,V)}else g=fo[M];for(var me=[];A<c.length;A++){var Le=d.parse(c[A],A,Ii);if(!Le)return null;me.push(Le)}return new Ri(g,me)},Ri.prototype.evaluate=function(c){for(var d=0;d<this.args.length;d++){var g=this.args[d].evaluate(c);if(!kt(this.type,Jr(g)))return g;if(d===this.args.length-1)throw new Gr("Expected value to be of type "+De(this.type)+", but found "+De(Jr(g))+" instead.")}return null},Ri.prototype.eachChild=function(c){this.args.forEach(c)},Ri.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Ri.prototype.serialize=function(){var c=this.type,d=[c.kind];if(c.kind==="array"){var g=c.itemType;if(g.kind==="string"||g.kind==="number"||g.kind==="boolean"){d.push(g.kind);var A=c.N;(typeof A=="number"||this.args.length>1)&&d.push(A)}}return d.concat(this.args.map(function(M){return M.serialize()}))};var bo=function(c){this.type=_a,this.sections=c};bo.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[1];if(!Array.isArray(g)&&typeof g=="object")return d.error("First argument must be an image or text section.");for(var A=[],M=!1,B=1;B<=c.length-1;++B){var V=c[B];if(M&&typeof V=="object"&&!Array.isArray(V)){M=!1;var Q=null;if(V["font-scale"]&&!(Q=d.parse(V["font-scale"],1,ar)))return null;var me=null;if(V["text-font"]&&!(me=d.parse(V["text-font"],1,Qo(Kr))))return null;var Le=null;if(V["text-color"]&&!(Le=d.parse(V["text-color"],1,Qr)))return null;var We=A[A.length-1];We.scale=Q,We.font=me,We.textColor=Le}else{var tt=d.parse(c[B],1,Ii);if(!tt)return null;var Et=tt.type.kind;if(Et!=="string"&&Et!=="value"&&Et!=="null"&&Et!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");M=!0,A.push({content:tt,scale:null,font:null,textColor:null})}}return new bo(A)},bo.prototype.evaluate=function(c){return new fr(this.sections.map(function(d){var g=d.content.evaluate(c);return Jr(g)===Co?new vr("",g,null,null,null):new vr(ji(g),null,d.scale?d.scale.evaluate(c):null,d.font?d.font.evaluate(c).join(","):null,d.textColor?d.textColor.evaluate(c):null)}))},bo.prototype.eachChild=function(c){for(var d=0,g=this.sections;d<g.length;d+=1){var A=g[d];c(A.content),A.scale&&c(A.scale),A.font&&c(A.font),A.textColor&&c(A.textColor)}},bo.prototype.outputDefined=function(){return!1},bo.prototype.serialize=function(){for(var c=["format"],d=0,g=this.sections;d<g.length;d+=1){var A=g[d];c.push(A.content.serialize());var M={};A.scale&&(M["font-scale"]=A.scale.serialize()),A.font&&(M["text-font"]=A.font.serialize()),A.textColor&&(M["text-color"]=A.textColor.serialize()),c.push(M)}return c};var xi=function(c){this.type=Co,this.input=c};xi.parse=function(c,d){if(c.length!==2)return d.error("Expected two arguments.");var g=d.parse(c[1],1,Kr);return g?new xi(g):d.error("No image name provided.")},xi.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=ci.fromString(d);return g&&c.availableImages&&(g.available=c.availableImages.indexOf(d)>-1),g},xi.prototype.eachChild=function(c){c(this.input)},xi.prototype.outputDefined=function(){return!1},xi.prototype.serialize=function(){return["image",this.input.serialize()]};var wo={"to-boolean":hi,"to-color":Qr,"to-number":ar,"to-string":Kr},ia=function(c,d){this.type=c,this.args=d};ia.parse=function(c,d){if(c.length<2)return d.error("Expected at least one argument.");var g=c[0];if((g==="to-boolean"||g==="to-string")&&c.length!==2)return d.error("Expected one argument.");for(var A=wo[g],M=[],B=1;B<c.length;B++){var V=d.parse(c[B],B,Ii);if(!V)return null;M.push(V)}return new ia(A,M)},ia.prototype.evaluate=function(c){if(this.type.kind==="boolean")return!!this.args[0].evaluate(c);if(this.type.kind==="color"){for(var d,g,A=0,M=this.args;A<M.length;A+=1){if(g=null,(d=M[A].evaluate(c))instanceof pn)return d;if(typeof d=="string"){var B=c.parseColor(d);if(B)return B}else if(Array.isArray(d)&&!(g=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":Gi(d[0],d[1],d[2],d[3])))return new pn(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Gr(g||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var V=null,Q=0,me=this.args;Q<me.length;Q+=1){if((V=me[Q].evaluate(c))===null)return 0;var Le=Number(V);if(!isNaN(Le))return Le}throw new Gr("Could not convert "+JSON.stringify(V)+" to number.")}return this.type.kind==="formatted"?fr.fromString(ji(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?ci.fromString(ji(this.args[0].evaluate(c))):ji(this.args[0].evaluate(c))},ia.prototype.eachChild=function(c){this.args.forEach(c)},ia.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},ia.prototype.serialize=function(){if(this.type.kind==="formatted")return new bo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new xi(this.args[0]).serialize();var c=["to-"+this.type.kind];return this.eachChild(function(d){c.push(d.serialize())}),c};var Ga=["Unknown","Point","LineString","Polygon"],Jo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Jo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Jo.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ga[this.feature.type]:this.feature.type:null},Jo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Jo.prototype.canonicalID=function(){return this.canonical},Jo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Jo.prototype.parseColor=function(c){var d=this._parseColorCache[c];return d||(d=this._parseColorCache[c]=pn.parse(c)),d};var Wo=function(c,d,g,A){this.name=c,this.type=d,this._evaluate=g,this.args=A};Wo.prototype.evaluate=function(c){return this._evaluate(c,this.args)},Wo.prototype.eachChild=function(c){this.args.forEach(c)},Wo.prototype.outputDefined=function(){return!1},Wo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(c){return c.serialize()}))},Wo.parse=function(c,d){var g,A=c[0],M=Wo.definitions[A];if(!M)return d.error('Unknown expression "'+A+'". If you wanted a literal array, use ["literal", [...]].',0);for(var B=Array.isArray(M)?M[0]:M.type,V=Array.isArray(M)?[[M[1],M[2]]]:M.overloads,Q=V.filter(function(zo){var ao=zo[0];return!Array.isArray(ao)||ao.length===c.length-1}),me=null,Le=0,We=Q;Le<We.length;Le+=1){var tt=We[Le],Et=tt[0],Nt=tt[1];me=new ou(d.registry,d.path,null,d.scope);for(var tn=[],_n=!1,zn=1;zn<c.length;zn++){var Dn=c[zn],cr=Array.isArray(Et)?Et[zn-1]:Et.type,_r=me.parse(Dn,1+tn.length,cr);if(!_r){_n=!0;break}tn.push(_r)}if(!_n)if(Array.isArray(Et)&&Et.length!==tn.length)me.error("Expected "+Et.length+" arguments, but found "+tn.length+" instead.");else{for(var Ir=0;Ir<tn.length;Ir++){var Br=Array.isArray(Et)?Et[Ir]:Et.type,jr=tn[Ir];me.concat(Ir+1).checkSubtype(Br,jr.type)}if(me.errors.length===0)return new Wo(A,B,Nt,tn)}}if(Q.length===1)(g=d.errors).push.apply(g,me.errors);else{for(var bi=(Q.length?Q:V).map(function(zo){var ao;return ao=zo[0],Array.isArray(ao)?"("+ao.map(De).join(", ")+")":"("+De(ao.type)+"...)"}).join(" | "),Zi=[],Ro=1;Ro<c.length;Ro++){var ki=d.parse(c[Ro],1+Zi.length);if(!ki)return null;Zi.push(De(ki.type))}d.error("Expected arguments of type "+bi+", but found ("+Zi.join(", ")+") instead.")}return null},Wo.register=function(c,d){for(var g in Wo.definitions=d,d)c[g]=Wo};var Ha=function(c,d,g){this.type=Fo,this.locale=g,this.caseSensitive=c,this.diacriticSensitive=d};function ds(c,d){c[0]=Math.min(c[0],d[0]),c[1]=Math.min(c[1],d[1]),c[2]=Math.max(c[2],d[0]),c[3]=Math.max(c[3],d[1])}function Tt(c,d){return!(c[0]<=d[0]||c[2]>=d[2]||c[1]<=d[1]||c[3]>=d[3])}function Yt(c,d){var g=(180+c[0])/360,A=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,M=Math.pow(2,d.z);return[Math.round(g*M*8192),Math.round(A*M*8192)]}function Fn(c,d,g){return d[1]>c[1]!=g[1]>c[1]&&c[0]<(g[0]-d[0])*(c[1]-d[1])/(g[1]-d[1])+d[0]}function dr(c,d){for(var g,A,M,B,V,Q,me,Le=!1,We=0,tt=d.length;We<tt;We++)for(var Et=d[We],Nt=0,tn=Et.length;Nt<tn-1;Nt++){if((B=(g=c)[0]-(A=Et[Nt])[0])*(me=g[1]-(M=Et[Nt+1])[1])-(Q=g[0]-M[0])*(V=g[1]-A[1])==0&&B*Q<=0&&V*me<=0)return!1;Fn(c,Et[Nt],Et[Nt+1])&&(Le=!Le)}return Le}function ai(c,d){for(var g=0;g<d.length;g++)if(dr(c,d[g]))return!0;return!1}function Xr(c,d,g,A){var M=A[0]-g[0],B=A[1]-g[1],V=(c[0]-g[0])*B-M*(c[1]-g[1]),Q=(d[0]-g[0])*B-M*(d[1]-g[1]);return V>0&&Q<0||V<0&&Q>0}function Uo(c,d,g){for(var A=0,M=g;A<M.length;A+=1)for(var B=M[A],V=0;V<B.length-1;++V)if((tt=[(We=B[V+1])[0]-(Le=B[V])[0],We[1]-Le[1]])[0]*(Et=[(me=d)[0]-(Q=c)[0],me[1]-Q[1]])[1]-tt[1]*Et[0]!=0&&Xr(Q,me,Le,We)&&Xr(Le,We,Q,me))return!0;var Q,me,Le,We,tt,Et;return!1}function Xo(c,d){for(var g=0;g<c.length;++g)if(!dr(c[g],d))return!1;for(var A=0;A<c.length-1;++A)if(Uo(c[A],c[A+1],d))return!1;return!0}function ya(c,d){for(var g=0;g<d.length;g++)if(Xo(c,d[g]))return!0;return!1}function vs(c,d,g){for(var A=[],M=0;M<c.length;M++){for(var B=[],V=0;V<c[M].length;V++){var Q=Yt(c[M][V],g);ds(d,Q),B.push(Q)}A.push(B)}return A}function nl(c,d,g){for(var A=[],M=0;M<c.length;M++){var B=vs(c[M],d,g);A.push(B)}return A}function $f(c,d,g,A){if(c[0]<g[0]||c[0]>g[2]){var M=.5*A,B=c[0]-g[0]>M?-A:g[0]-c[0]>M?A:0;B===0&&(B=c[0]-g[2]>M?-A:g[2]-c[0]>M?A:0),c[0]+=B}ds(d,c)}function jd(c,d,g,A){for(var M=8192*Math.pow(2,A.z),B=[8192*A.x,8192*A.y],V=[],Q=0,me=c;Q<me.length;Q+=1)for(var Le=0,We=me[Q];Le<We.length;Le+=1){var tt=We[Le],Et=[tt.x+B[0],tt.y+B[1]];$f(Et,d,g,M),V.push(Et)}return V}function Uh(c,d,g,A){for(var M,B=8192*Math.pow(2,A.z),V=[8192*A.x,8192*A.y],Q=[],me=0,Le=c;me<Le.length;me+=1){for(var We=[],tt=0,Et=Le[me];tt<Et.length;tt+=1){var Nt=Et[tt],tn=[Nt.x+V[0],Nt.y+V[1]];ds(d,tn),We.push(tn)}Q.push(We)}if(d[2]-d[0]<=B/2){(M=d)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(var _n=0,zn=Q;_n<zn.length;_n+=1)for(var Dn=0,cr=zn[_n];Dn<cr.length;Dn+=1)$f(cr[Dn],d,g,B)}return Q}Ha.parse=function(c,d){if(c.length!==2)return d.error("Expected one argument.");var g=c[1];if(typeof g!="object"||Array.isArray(g))return d.error("Collator options argument must be an object.");var A=d.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,hi);if(!A)return null;var M=d.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,hi);if(!M)return null;var B=null;return g.locale&&!(B=d.parse(g.locale,1,Kr))?null:new Ha(A,M,B)},Ha.prototype.evaluate=function(c){return new On(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)},Ha.prototype.eachChild=function(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)},Ha.prototype.outputDefined=function(){return!1},Ha.prototype.serialize=function(){var c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]};var Pl=function(c,d){this.type=hi,this.geojson=c,this.geometries=d};function Df(c){if(c instanceof Wo&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Pl)return!1;var d=!0;return c.eachChild(function(g){d&&!Df(g)&&(d=!1)}),d}function Nf(c){if(c instanceof Wo&&c.name==="feature-state")return!1;var d=!0;return c.eachChild(function(g){d&&!Nf(g)&&(d=!1)}),d}function rc(c,d){if(c instanceof Wo&&d.indexOf(c.name)>=0)return!1;var g=!0;return c.eachChild(function(A){g&&!rc(A,d)&&(g=!1)}),g}Pl.parse=function(c,d){if(c.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(c.length-1)+" instead.");if(no(c[1])){var g=c[1];if(g.type==="FeatureCollection")for(var A=0;A<g.features.length;++A){var M=g.features[A].geometry.type;if(M==="Polygon"||M==="MultiPolygon")return new Pl(g,g.features[A].geometry)}else if(g.type==="Feature"){var B=g.geometry.type;if(B==="Polygon"||B==="MultiPolygon")return new Pl(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Pl(g,g)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Pl.prototype.evaluate=function(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(d,g){var A=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],B=d.canonicalID();if(g.type==="Polygon"){var V=vs(g.coordinates,M,B),Q=jd(d.geometry(),A,M,B);if(!Tt(A,M))return!1;for(var me=0,Le=Q;me<Le.length;me+=1)if(!dr(Le[me],V))return!1}if(g.type==="MultiPolygon"){var We=nl(g.coordinates,M,B),tt=jd(d.geometry(),A,M,B);if(!Tt(A,M))return!1;for(var Et=0,Nt=tt;Et<Nt.length;Et+=1)if(!ai(Nt[Et],We))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(d,g){var A=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],B=d.canonicalID();if(g.type==="Polygon"){var V=vs(g.coordinates,M,B),Q=Uh(d.geometry(),A,M,B);if(!Tt(A,M))return!1;for(var me=0,Le=Q;me<Le.length;me+=1)if(!Xo(Le[me],V))return!1}if(g.type==="MultiPolygon"){var We=nl(g.coordinates,M,B),tt=Uh(d.geometry(),A,M,B);if(!Tt(A,M))return!1;for(var Et=0,Nt=tt;Et<Nt.length;Et+=1)if(!ya(Nt[Et],We))return!1}return!0}(c,this.geometries)}return!1},Pl.prototype.eachChild=function(){},Pl.prototype.outputDefined=function(){return!0},Pl.prototype.serialize=function(){return["within",this.geojson]};var gu=function(c,d){this.type=d.type,this.name=c,this.boundExpression=d};gu.parse=function(c,d){if(c.length!==2||typeof c[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var g=c[1];return d.scope.has(g)?new gu(g,d.scope.get(g)):d.error('Unknown variable "'+g+'". Make sure "'+g+'" has been bound in an enclosing "let" expression before using it.',1)},gu.prototype.evaluate=function(c){return this.boundExpression.evaluate(c)},gu.prototype.eachChild=function(){},gu.prototype.outputDefined=function(){return!1},gu.prototype.serialize=function(){return["var",this.name]};var ou=function(c,d,g,A,M){d===void 0&&(d=[]),A===void 0&&(A=new Ei),M===void 0&&(M=[]),this.registry=c,this.path=d,this.key=d.map(function(B){return"["+B+"]"}).join(""),this.scope=A,this.errors=M,this.expectedType=g};function qu(c,d){for(var g,A=c.length-1,M=0,B=A,V=0;M<=B;)if((g=c[V=Math.floor((M+B)/2)])<=d){if(V===A||d<c[V+1])return V;M=V+1}else{if(!(g>d))throw new Gr("Input is not a number.");B=V-1}return 0}ou.prototype.parse=function(c,d,g,A,M){return M===void 0&&(M={}),d?this.concat(d,g,A)._parse(c,M):this._parse(c,M)},ou.prototype._parse=function(c,d){function g(Le,We,tt){return tt==="assert"?new Ri(We,[Le]):tt==="coerce"?new ia(We,[Le]):Le}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var A=c[0];if(typeof A!="string")return this.error("Expression name must be a string, but found "+typeof A+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var M=this.registry[A];if(M){var B=M.parse(c,this);if(!B)return null;if(this.expectedType){var V=this.expectedType,Q=B.type;if(V.kind!=="string"&&V.kind!=="number"&&V.kind!=="boolean"&&V.kind!=="object"&&V.kind!=="array"||Q.kind!=="value")if(V.kind!=="color"&&V.kind!=="formatted"&&V.kind!=="resolvedImage"||Q.kind!=="value"&&Q.kind!=="string"){if(this.checkSubtype(V,Q))return null}else B=g(B,V,d.typeAnnotation||"coerce");else B=g(B,V,d.typeAnnotation||"assert")}if(!(B instanceof Di)&&B.type.kind!=="resolvedImage"&&function Le(We){if(We instanceof gu)return Le(We.boundExpression);if(We instanceof Wo&&We.name==="error"||We instanceof Ha||We instanceof Pl)return!1;var tt=We instanceof ia||We instanceof Ri,Et=!0;return We.eachChild(function(Nt){Et=tt?Et&&Le(Nt):Et&&Nt instanceof Di}),!!Et&&Df(We)&&rc(We,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(B)){var me=new Jo;try{B=new Di(B.type,B.evaluate(me))}catch(Le){return this.error(Le.message),null}}return B}return this.error('Unknown expression "'+A+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof c+" instead.")},ou.prototype.concat=function(c,d,g){var A=typeof c=="number"?this.path.concat(c):this.path,M=g?this.scope.concat(g):this.scope;return new ou(this.registry,A,d||null,M,this.errors)},ou.prototype.error=function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];var A=""+this.key+d.map(function(M){return"["+M+"]"}).join("");this.errors.push(new kr(A,c))},ou.prototype.checkSubtype=function(c,d){var g=kt(c,d);return g&&this.error(g),g};var lc=function(c,d,g){this.type=c,this.input=d,this.labels=[],this.outputs=[];for(var A=0,M=g;A<M.length;A+=1){var B=M[A],V=B[1];this.labels.push(B[0]),this.outputs.push(V)}};function Xs(c,d,g){return c*(1-g)+d*g}lc.parse=function(c,d){if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");var g=d.parse(c[1],1,ar);if(!g)return null;var A=[],M=null;d.expectedType&&d.expectedType.kind!=="value"&&(M=d.expectedType);for(var B=1;B<c.length;B+=2){var V=B===1?-1/0:c[B],Q=c[B+1],me=B,Le=B+1;if(typeof V!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',me);if(A.length&&A[A.length-1][0]>=V)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',me);var We=d.parse(Q,Le,M);if(!We)return null;M=M||We.type,A.push([V,We])}return new lc(M,g,A)},lc.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var A=this.input.evaluate(c);if(A<=d[0])return g[0].evaluate(c);var M=d.length;return A>=d[M-1]?g[M-1].evaluate(c):g[qu(d,A)].evaluate(c)},lc.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},lc.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},lc.prototype.serialize=function(){for(var c=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&c.push(this.labels[d]),c.push(this.outputs[d].serialize());return c};var Lu=Object.freeze({__proto__:null,number:Xs,color:function(c,d,g){return new pn(Xs(c.r,d.r,g),Xs(c.g,d.g,g),Xs(c.b,d.b,g),Xs(c.a,d.a,g))},array:function(c,d,g){return c.map(function(A,M){return Xs(A,d[M],g)})}}),gf=6/29*3*(6/29),jh=Math.PI/180,bp=180/Math.PI;function vh(c){return c>.008856451679035631?Math.pow(c,1/3):c/gf+4/29}function Kf(c){return c>6/29?c*c*c:gf*(c-4/29)}function Du(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function gh(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Vh(c){var d=gh(c.r),g=gh(c.g),A=gh(c.b),M=vh((.4124564*d+.3575761*g+.1804375*A)/.95047),B=vh((.2126729*d+.7151522*g+.072175*A)/1);return{l:116*B-16,a:500*(M-B),b:200*(B-vh((.0193339*d+.119192*g+.9503041*A)/1.08883)),alpha:c.a}}function bd(c){var d=(c.l+16)/116,g=isNaN(c.a)?d:d+c.a/500,A=isNaN(c.b)?d:d-c.b/200;return d=1*Kf(d),g=.95047*Kf(g),A=1.08883*Kf(A),new pn(Du(3.2404542*g-1.5371385*d-.4985314*A),Du(-.969266*g+1.8760108*d+.041556*A),Du(.0556434*g-.2040259*d+1.0572252*A),c.alpha)}function t0(c,d,g){var A=d-c;return c+g*(A>180||A<-180?A-360*Math.round(A/360):A)}var qf={forward:Vh,reverse:bd,interpolate:function(c,d,g){return{l:Xs(c.l,d.l,g),a:Xs(c.a,d.a,g),b:Xs(c.b,d.b,g),alpha:Xs(c.alpha,d.alpha,g)}}},yu={forward:function(c){var d=Vh(c),g=d.l,A=d.a,M=d.b,B=Math.atan2(M,A)*bp;return{h:B<0?B+360:B,c:Math.sqrt(A*A+M*M),l:g,alpha:c.a}},reverse:function(c){var d=c.h*jh,g=c.c;return bd({l:c.l,a:Math.cos(d)*g,b:Math.sin(d)*g,alpha:c.alpha})},interpolate:function(c,d,g){return{h:t0(c.h,d.h,g),c:Xs(c.c,d.c,g),l:Xs(c.l,d.l,g),alpha:Xs(c.alpha,d.alpha,g)}}},Vd=Object.freeze({__proto__:null,lab:qf,hcl:yu}),zl=function(c,d,g,A,M){this.type=c,this.operator=d,this.interpolation=g,this.input=A,this.labels=[],this.outputs=[];for(var B=0,V=M;B<V.length;B+=1){var Q=V[B],me=Q[1];this.labels.push(Q[0]),this.outputs.push(me)}};function _u(c,d,g,A){var M=A-g,B=c-g;return M===0?0:d===1?B/M:(Math.pow(d,B)-1)/(Math.pow(d,M)-1)}zl.interpolationFactor=function(c,d,g,A){var M=0;if(c.name==="exponential")M=_u(d,c.base,g,A);else if(c.name==="linear")M=_u(d,1,g,A);else if(c.name==="cubic-bezier"){var B=c.controlPoints;M=new re(B[0],B[1],B[2],B[3]).solve(_u(d,1,g,A))}return M},zl.parse=function(c,d){var g=c[0],A=c[1],M=c[2],B=c.slice(3);if(!Array.isArray(A)||A.length===0)return d.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){var V=A[1];if(typeof V!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:V}}else{if(A[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(A[0]),1,0);var Q=A.slice(1);if(Q.length!==4||Q.some(function(zn){return typeof zn!="number"||zn<0||zn>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:Q}}if(c.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(M=d.parse(M,2,ar)))return null;var me=[],Le=null;g==="interpolate-hcl"||g==="interpolate-lab"?Le=Qr:d.expectedType&&d.expectedType.kind!=="value"&&(Le=d.expectedType);for(var We=0;We<B.length;We+=2){var tt=B[We],Et=B[We+1],Nt=We+3,tn=We+4;if(typeof tt!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Nt);if(me.length&&me[me.length-1][0]>=tt)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Nt);var _n=d.parse(Et,tn,Le);if(!_n)return null;Le=Le||_n.type,me.push([tt,_n])}return Le.kind==="number"||Le.kind==="color"||Le.kind==="array"&&Le.itemType.kind==="number"&&typeof Le.N=="number"?new zl(Le,g,A,M,me):d.error("Type "+De(Le)+" is not interpolatable.")},zl.prototype.evaluate=function(c){var d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(c);var A=this.input.evaluate(c);if(A<=d[0])return g[0].evaluate(c);var M=d.length;if(A>=d[M-1])return g[M-1].evaluate(c);var B=qu(d,A),V=zl.interpolationFactor(this.interpolation,A,d[B],d[B+1]),Q=g[B].evaluate(c),me=g[B+1].evaluate(c);return this.operator==="interpolate"?Lu[this.type.kind.toLowerCase()](Q,me,V):this.operator==="interpolate-hcl"?yu.reverse(yu.interpolate(yu.forward(Q),yu.forward(me),V)):qf.reverse(qf.interpolate(qf.forward(Q),qf.forward(me),V))},zl.prototype.eachChild=function(c){c(this.input);for(var d=0,g=this.outputs;d<g.length;d+=1)c(g[d])},zl.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})},zl.prototype.serialize=function(){var c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,c,this.input.serialize()],g=0;g<this.labels.length;g++)d.push(this.labels[g],this.outputs[g].serialize());return d};var Qu=function(c,d){this.type=c,this.args=d};Qu.parse=function(c,d){if(c.length<2)return d.error("Expectected at least one argument.");var g=null,A=d.expectedType;A&&A.kind!=="value"&&(g=A);for(var M=[],B=0,V=c.slice(1);B<V.length;B+=1){var Q=d.parse(V[B],1+M.length,g,void 0,{typeAnnotation:"omit"});if(!Q)return null;g=g||Q.type,M.push(Q)}var me=A&&M.some(function(Le){return kt(A,Le.type)});return new Qu(me?Ii:g,M)},Qu.prototype.evaluate=function(c){for(var d,g=null,A=0,M=0,B=this.args;M<B.length&&(A++,(g=B[M].evaluate(c))&&g instanceof ci&&!g.available&&(d||(d=g.name),g=null,A===this.args.length&&(g=d)),g===null);M+=1);return g},Qu.prototype.eachChild=function(c){this.args.forEach(c)},Qu.prototype.outputDefined=function(){return this.args.every(function(c){return c.outputDefined()})},Qu.prototype.serialize=function(){var c=["coalesce"];return this.eachChild(function(d){c.push(d.serialize())}),c};var _s=function(c,d){this.type=d.type,this.bindings=[].concat(c),this.result=d};_s.prototype.evaluate=function(c){return this.result.evaluate(c)},_s.prototype.eachChild=function(c){for(var d=0,g=this.bindings;d<g.length;d+=1)c(g[d][1]);c(this.result)},_s.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found "+(c.length-1)+" instead.");for(var g=[],A=1;A<c.length-1;A+=2){var M=c[A];if(typeof M!="string")return d.error("Expected string, but found "+typeof M+" instead.",A);if(/[^a-zA-Z0-9_]/.test(M))return d.error("Variable names must contain only alphanumeric characters or '_'.",A);var B=d.parse(c[A+1],A+1);if(!B)return null;g.push([M,B])}var V=d.parse(c[c.length-1],c.length-1,d.expectedType,g);return V?new _s(g,V):null},_s.prototype.outputDefined=function(){return this.result.outputDefined()},_s.prototype.serialize=function(){for(var c=["let"],d=0,g=this.bindings;d<g.length;d+=1){var A=g[d];c.push(A[0],A[1].serialize())}return c.push(this.result.serialize()),c};var au=function(c,d,g){this.type=c,this.index=d,this.input=g};au.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,ar),A=d.parse(c[2],2,Qo(d.expectedType||Ii));return g&&A?new au(A.type.itemType,g,A):null},au.prototype.evaluate=function(c){var d=this.index.evaluate(c),g=this.input.evaluate(c);if(d<0)throw new Gr("Array index out of bounds: "+d+" < 0.");if(d>=g.length)throw new Gr("Array index out of bounds: "+d+" > "+(g.length-1)+".");if(d!==Math.floor(d))throw new Gr("Array index must be an integer, but found "+d+" instead.");return g[d]},au.prototype.eachChild=function(c){c(this.index),c(this.input)},au.prototype.outputDefined=function(){return!1},au.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var xc=function(c,d){this.type=hi,this.needle=c,this.haystack=d};xc.parse=function(c,d){if(c.length!==3)return d.error("Expected 2 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Ii),A=d.parse(c[2],2,Ii);return g&&A?un(g.type,[hi,Kr,ar,Oi,Ii])?new xc(g,A):d.error("Expected first argument to be of type boolean, string, number or null, but found "+De(g.type)+" instead"):null},xc.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!g)return!1;if(!Bn(d,["boolean","string","number","null"]))throw new Gr("Expected first argument to be of type boolean, string, number or null, but found "+De(Jr(d))+" instead.");if(!Bn(g,["string","array"]))throw new Gr("Expected second argument to be of type array or string, but found "+De(Jr(g))+" instead.");return g.indexOf(d)>=0},xc.prototype.eachChild=function(c){c(this.needle),c(this.haystack)},xc.prototype.outputDefined=function(){return!0},xc.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ju=function(c,d,g){this.type=ar,this.needle=c,this.haystack=d,this.fromIndex=g};Ju.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Ii),A=d.parse(c[2],2,Ii);if(!g||!A)return null;if(!un(g.type,[hi,Kr,ar,Oi,Ii]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+De(g.type)+" instead");if(c.length===4){var M=d.parse(c[3],3,ar);return M?new Ju(g,A,M):null}return new Ju(g,A)},Ju.prototype.evaluate=function(c){var d=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!Bn(d,["boolean","string","number","null"]))throw new Gr("Expected first argument to be of type boolean, string, number or null, but found "+De(Jr(d))+" instead.");if(!Bn(g,["string","array"]))throw new Gr("Expected second argument to be of type array or string, but found "+De(Jr(g))+" instead.");if(this.fromIndex){var A=this.fromIndex.evaluate(c);return g.indexOf(d,A)}return g.indexOf(d)},Ju.prototype.eachChild=function(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)},Ju.prototype.outputDefined=function(){return!1},Ju.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var hl=function(c,d,g,A,M,B){this.inputType=c,this.type=d,this.input=g,this.cases=A,this.outputs=M,this.otherwise=B};hl.parse=function(c,d){if(c.length<5)return d.error("Expected at least 4 arguments, but found only "+(c.length-1)+".");if(c.length%2!=1)return d.error("Expected an even number of arguments.");var g,A;d.expectedType&&d.expectedType.kind!=="value"&&(A=d.expectedType);for(var M={},B=[],V=2;V<c.length-1;V+=2){var Q=c[V],me=c[V+1];Array.isArray(Q)||(Q=[Q]);var Le=d.concat(V);if(Q.length===0)return Le.error("Expected at least one branch label.");for(var We=0,tt=Q;We<tt.length;We+=1){var Et=tt[We];if(typeof Et!="number"&&typeof Et!="string")return Le.error("Branch labels must be numbers or strings.");if(typeof Et=="number"&&Math.abs(Et)>Number.MAX_SAFE_INTEGER)return Le.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Et=="number"&&Math.floor(Et)!==Et)return Le.error("Numeric branch labels must be integer values.");if(g){if(Le.checkSubtype(g,Jr(Et)))return null}else g=Jr(Et);if(M[String(Et)]!==void 0)return Le.error("Branch labels must be unique.");M[String(Et)]=B.length}var Nt=d.parse(me,V,A);if(!Nt)return null;A=A||Nt.type,B.push(Nt)}var tn=d.parse(c[1],1,Ii);if(!tn)return null;var _n=d.parse(c[c.length-1],c.length-1,A);return _n?tn.type.kind!=="value"&&d.concat(1).checkSubtype(g,tn.type)?null:new hl(g,A,tn,M,B,_n):null},hl.prototype.evaluate=function(c){var d=this.input.evaluate(c);return(Jr(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(c)},hl.prototype.eachChild=function(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)},hl.prototype.outputDefined=function(){return this.outputs.every(function(c){return c.outputDefined()})&&this.otherwise.outputDefined()},hl.prototype.serialize=function(){for(var c=this,d=["match",this.input.serialize()],g=[],A={},M=0,B=Object.keys(this.cases).sort();M<B.length;M+=1){var V=B[M];(tt=A[this.cases[V]])===void 0?(A[this.cases[V]]=g.length,g.push([this.cases[V],[V]])):g[tt][1].push(V)}for(var Q=function(Nt){return c.inputType.kind==="number"?Number(Nt):Nt},me=0,Le=g;me<Le.length;me+=1){var We=Le[me],tt=We[0],Et=We[1];d.push(Et.length===1?Q(Et[0]):Et.map(Q)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var Nu=function(c,d,g){this.type=c,this.branches=d,this.otherwise=g};Nu.parse=function(c,d){if(c.length<4)return d.error("Expected at least 3 arguments, but found only "+(c.length-1)+".");if(c.length%2!=0)return d.error("Expected an odd number of arguments.");var g;d.expectedType&&d.expectedType.kind!=="value"&&(g=d.expectedType);for(var A=[],M=1;M<c.length-1;M+=2){var B=d.parse(c[M],M,hi);if(!B)return null;var V=d.parse(c[M+1],M+1,g);if(!V)return null;A.push([B,V]),g=g||V.type}var Q=d.parse(c[c.length-1],c.length-1,g);return Q?new Nu(g,A,Q):null},Nu.prototype.evaluate=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var A=g[d],M=A[1];if(A[0].evaluate(c))return M.evaluate(c)}return this.otherwise.evaluate(c)},Nu.prototype.eachChild=function(c){for(var d=0,g=this.branches;d<g.length;d+=1){var A=g[d],M=A[1];c(A[0]),c(M)}c(this.otherwise)},Nu.prototype.outputDefined=function(){return this.branches.every(function(c){return c[1].outputDefined()})&&this.otherwise.outputDefined()},Nu.prototype.serialize=function(){var c=["case"];return this.eachChild(function(d){c.push(d.serialize())}),c};var ef=function(c,d,g,A){this.type=c,this.input=d,this.beginIndex=g,this.endIndex=A};function Hd(c,d){return c==="=="||c==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function Hh(c,d,g,A){return A.compare(d,g)===0}function ns(c,d,g){var A=c!=="=="&&c!=="!=";return function(){function M(B,V,Q){this.type=hi,this.lhs=B,this.rhs=V,this.collator=Q,this.hasUntypedArgument=B.type.kind==="value"||V.type.kind==="value"}return M.parse=function(B,V){if(B.length!==3&&B.length!==4)return V.error("Expected two or three arguments.");var Q=B[0],me=V.parse(B[1],1,Ii);if(!me)return null;if(!Hd(Q,me.type))return V.concat(1).error('"'+Q+`" comparisons are not supported for type '`+De(me.type)+"'.");var Le=V.parse(B[2],2,Ii);if(!Le)return null;if(!Hd(Q,Le.type))return V.concat(2).error('"'+Q+`" comparisons are not supported for type '`+De(Le.type)+"'.");if(me.type.kind!==Le.type.kind&&me.type.kind!=="value"&&Le.type.kind!=="value")return V.error("Cannot compare types '"+De(me.type)+"' and '"+De(Le.type)+"'.");A&&(me.type.kind==="value"&&Le.type.kind!=="value"?me=new Ri(Le.type,[me]):me.type.kind!=="value"&&Le.type.kind==="value"&&(Le=new Ri(me.type,[Le])));var We=null;if(B.length===4){if(me.type.kind!=="string"&&Le.type.kind!=="string"&&me.type.kind!=="value"&&Le.type.kind!=="value")return V.error("Cannot use collator to compare non-string types.");if(!(We=V.parse(B[3],3,Fo)))return null}return new M(me,Le,We)},M.prototype.evaluate=function(B){var V=this.lhs.evaluate(B),Q=this.rhs.evaluate(B);if(A&&this.hasUntypedArgument){var me=Jr(V),Le=Jr(Q);if(me.kind!==Le.kind||me.kind!=="string"&&me.kind!=="number")throw new Gr('Expected arguments for "'+c+'" to be (string, string) or (number, number), but found ('+me.kind+", "+Le.kind+") instead.")}if(this.collator&&!A&&this.hasUntypedArgument){var We=Jr(V),tt=Jr(Q);if(We.kind!=="string"||tt.kind!=="string")return d(B,V,Q)}return this.collator?g(B,V,Q,this.collator.evaluate(B)):d(B,V,Q)},M.prototype.eachChild=function(B){B(this.lhs),B(this.rhs),this.collator&&B(this.collator)},M.prototype.outputDefined=function(){return!0},M.prototype.serialize=function(){var B=[c];return this.eachChild(function(V){B.push(V.serialize())}),B},M}()}ef.parse=function(c,d){if(c.length<=2||c.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1,Ii),A=d.parse(c[2],2,ar);if(!g||!A)return null;if(!un(g.type,[Qo(Ii),Kr,Ii]))return d.error("Expected first argument to be of type array or string, but found "+De(g.type)+" instead");if(c.length===4){var M=d.parse(c[3],3,ar);return M?new ef(g.type,g,A,M):null}return new ef(g.type,g,A)},ef.prototype.evaluate=function(c){var d=this.input.evaluate(c),g=this.beginIndex.evaluate(c);if(!Bn(d,["string","array"]))throw new Gr("Expected first argument to be of type array or string, but found "+De(Jr(d))+" instead.");if(this.endIndex){var A=this.endIndex.evaluate(c);return d.slice(g,A)}return d.slice(g)},ef.prototype.eachChild=function(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)},ef.prototype.outputDefined=function(){return!1},ef.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var yh=ns("==",function(c,d,g){return d===g},Hh),Zh=ns("!=",function(c,d,g){return d!==g},function(c,d,g,A){return!Hh(0,d,g,A)}),Wh=ns("<",function(c,d,g){return d<g},function(c,d,g,A){return A.compare(d,g)<0}),rl=ns(">",function(c,d,g){return d>g},function(c,d,g,A){return A.compare(d,g)>0}),Bf=ns("<=",function(c,d,g){return d<=g},function(c,d,g,A){return A.compare(d,g)<=0}),_h=ns(">=",function(c,d,g){return d>=g},function(c,d,g,A){return A.compare(d,g)>=0}),ne=function(c,d,g,A,M){this.type=Kr,this.number=c,this.locale=d,this.currency=g,this.minFractionDigits=A,this.maxFractionDigits=M};ne.parse=function(c,d){if(c.length!==3)return d.error("Expected two arguments.");var g=d.parse(c[1],1,ar);if(!g)return null;var A=c[2];if(typeof A!="object"||Array.isArray(A))return d.error("NumberFormat options argument must be an object.");var M=null;if(A.locale&&!(M=d.parse(A.locale,1,Kr)))return null;var B=null;if(A.currency&&!(B=d.parse(A.currency,1,Kr)))return null;var V=null;if(A["min-fraction-digits"]&&!(V=d.parse(A["min-fraction-digits"],1,ar)))return null;var Q=null;return A["max-fraction-digits"]&&!(Q=d.parse(A["max-fraction-digits"],1,ar))?null:new ne(g,M,B,V,Q)},ne.prototype.evaluate=function(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))},ne.prototype.eachChild=function(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)},ne.prototype.outputDefined=function(){return!1},ne.prototype.serialize=function(){var c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]};var ge=function(c){this.type=ar,this.input=c};ge.parse=function(c,d){if(c.length!==2)return d.error("Expected 1 argument, but found "+(c.length-1)+" instead.");var g=d.parse(c[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+De(g.type)+" instead."):new ge(g):null},ge.prototype.evaluate=function(c){var d=this.input.evaluate(c);if(typeof d=="string"||Array.isArray(d))return d.length;throw new Gr("Expected value to be of type string or array, but found "+De(Jr(d))+" instead.")},ge.prototype.eachChild=function(c){c(this.input)},ge.prototype.outputDefined=function(){return!1},ge.prototype.serialize=function(){var c=["length"];return this.eachChild(function(d){c.push(d.serialize())}),c};var qe={"==":yh,"!=":Zh,">":rl,"<":Wh,">=":_h,"<=":Bf,array:Ri,at:au,boolean:Ri,case:Nu,coalesce:Qu,collator:Ha,format:bo,image:xi,in:xc,"index-of":Ju,interpolate:zl,"interpolate-hcl":zl,"interpolate-lab":zl,length:ge,let:_s,literal:Di,match:hl,number:Ri,"number-format":ne,object:Ri,slice:ef,step:lc,string:Ri,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,var:gu,within:Pl};function mn(c,d){var g=d[0],A=d[1],M=d[2],B=d[3];g=g.evaluate(c),A=A.evaluate(c),M=M.evaluate(c);var V=B?B.evaluate(c):1,Q=Gi(g,A,M,V);if(Q)throw new Gr(Q);return new pn(g/255*V,A/255*V,M/255*V,V)}function K(c,d){return c in d}function tr(c,d){var g=d[c];return g===void 0?null:g}function Mr(c){return{type:c}}function Bi(c){return{result:"success",value:c}}function zi(c){return{result:"error",value:c}}function so(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Si(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Sa(c){return!!c.expression&&c.expression.interpolated}function Do(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function ha(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function rs(c){return c}function ua(c,d,g){return c!==void 0?c:d!==void 0?d:g!==void 0?g:void 0}function Aa(c,d,g,A,M){return ua(typeof g===M?A[g]:void 0,c.default,d.default)}function ls(c,d,g){if(Do(g)!=="number")return ua(c.default,d.default);var A=c.stops.length;if(A===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[A-1][0])return c.stops[A-1][1];var M=qu(c.stops.map(function(B){return B[0]}),g);return c.stops[M][1]}function Ma(c,d,g){var A=c.base!==void 0?c.base:1;if(Do(g)!=="number")return ua(c.default,d.default);var M=c.stops.length;if(M===1||g<=c.stops[0][0])return c.stops[0][1];if(g>=c.stops[M-1][0])return c.stops[M-1][1];var B=qu(c.stops.map(function(tt){return tt[0]}),g),V=function(tt,Et,Nt,tn){var _n=tn-Nt,zn=tt-Nt;return _n===0?0:Et===1?zn/_n:(Math.pow(Et,zn)-1)/(Math.pow(Et,_n)-1)}(g,A,c.stops[B][0],c.stops[B+1][0]),Q=c.stops[B][1],me=c.stops[B+1][1],Le=Lu[d.type]||rs;if(c.colorSpace&&c.colorSpace!=="rgb"){var We=Vd[c.colorSpace];Le=function(tt,Et){return We.reverse(We.interpolate(We.forward(tt),We.forward(Et),V))}}return typeof Q.evaluate=="function"?{evaluate:function(){for(var tt=[],Et=arguments.length;Et--;)tt[Et]=arguments[Et];var Nt=Q.evaluate.apply(void 0,tt),tn=me.evaluate.apply(void 0,tt);if(Nt!==void 0&&tn!==void 0)return Le(Nt,tn,V)}}:Le(Q,me,V)}function Da(c,d,g){return d.type==="color"?g=pn.parse(g):d.type==="formatted"?g=fr.fromString(g.toString()):d.type==="resolvedImage"?g=ci.fromString(g.toString()):Do(g)===d.type||d.type==="enum"&&d.values[g]||(g=void 0),ua(g,c.default,d.default)}Wo.register(qe,{error:[{kind:"error"},[Kr],function(c,d){throw new Gr(d[0].evaluate(c))}],typeof:[Kr,[Ii],function(c,d){return De(Jr(d[0].evaluate(c)))}],"to-rgba":[Qo(ar,4),[Qr],function(c,d){return d[0].evaluate(c).toArray()}],rgb:[Qr,[ar,ar,ar],mn],rgba:[Qr,[ar,ar,ar,ar],mn],has:{type:hi,overloads:[[[Kr],function(c,d){return K(d[0].evaluate(c),c.properties())}],[[Kr,Io],function(c,d){var g=d[1];return K(d[0].evaluate(c),g.evaluate(c))}]]},get:{type:Ii,overloads:[[[Kr],function(c,d){return tr(d[0].evaluate(c),c.properties())}],[[Kr,Io],function(c,d){var g=d[1];return tr(d[0].evaluate(c),g.evaluate(c))}]]},"feature-state":[Ii,[Kr],function(c,d){return tr(d[0].evaluate(c),c.featureState||{})}],properties:[Io,[],function(c){return c.properties()}],"geometry-type":[Kr,[],function(c){return c.geometryType()}],id:[Ii,[],function(c){return c.id()}],zoom:[ar,[],function(c){return c.globals.zoom}],"heatmap-density":[ar,[],function(c){return c.globals.heatmapDensity||0}],"line-progress":[ar,[],function(c){return c.globals.lineProgress||0}],accumulated:[Ii,[],function(c){return c.globals.accumulated===void 0?null:c.globals.accumulated}],"+":[ar,Mr(ar),function(c,d){for(var g=0,A=0,M=d;A<M.length;A+=1)g+=M[A].evaluate(c);return g}],"*":[ar,Mr(ar),function(c,d){for(var g=1,A=0,M=d;A<M.length;A+=1)g*=M[A].evaluate(c);return g}],"-":{type:ar,overloads:[[[ar,ar],function(c,d){var g=d[1];return d[0].evaluate(c)-g.evaluate(c)}],[[ar],function(c,d){return-d[0].evaluate(c)}]]},"/":[ar,[ar,ar],function(c,d){var g=d[1];return d[0].evaluate(c)/g.evaluate(c)}],"%":[ar,[ar,ar],function(c,d){var g=d[1];return d[0].evaluate(c)%g.evaluate(c)}],ln2:[ar,[],function(){return Math.LN2}],pi:[ar,[],function(){return Math.PI}],e:[ar,[],function(){return Math.E}],"^":[ar,[ar,ar],function(c,d){var g=d[1];return Math.pow(d[0].evaluate(c),g.evaluate(c))}],sqrt:[ar,[ar],function(c,d){return Math.sqrt(d[0].evaluate(c))}],log10:[ar,[ar],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN10}],ln:[ar,[ar],function(c,d){return Math.log(d[0].evaluate(c))}],log2:[ar,[ar],function(c,d){return Math.log(d[0].evaluate(c))/Math.LN2}],sin:[ar,[ar],function(c,d){return Math.sin(d[0].evaluate(c))}],cos:[ar,[ar],function(c,d){return Math.cos(d[0].evaluate(c))}],tan:[ar,[ar],function(c,d){return Math.tan(d[0].evaluate(c))}],asin:[ar,[ar],function(c,d){return Math.asin(d[0].evaluate(c))}],acos:[ar,[ar],function(c,d){return Math.acos(d[0].evaluate(c))}],atan:[ar,[ar],function(c,d){return Math.atan(d[0].evaluate(c))}],min:[ar,Mr(ar),function(c,d){return Math.min.apply(Math,d.map(function(g){return g.evaluate(c)}))}],max:[ar,Mr(ar),function(c,d){return Math.max.apply(Math,d.map(function(g){return g.evaluate(c)}))}],abs:[ar,[ar],function(c,d){return Math.abs(d[0].evaluate(c))}],round:[ar,[ar],function(c,d){var g=d[0].evaluate(c);return g<0?-Math.round(-g):Math.round(g)}],floor:[ar,[ar],function(c,d){return Math.floor(d[0].evaluate(c))}],ceil:[ar,[ar],function(c,d){return Math.ceil(d[0].evaluate(c))}],"filter-==":[hi,[Kr,Ii],function(c,d){var g=d[0],A=d[1];return c.properties()[g.value]===A.value}],"filter-id-==":[hi,[Ii],function(c,d){var g=d[0];return c.id()===g.value}],"filter-type-==":[hi,[Kr],function(c,d){var g=d[0];return c.geometryType()===g.value}],"filter-<":[hi,[Kr,Ii],function(c,d){var g=d[0],A=d[1],M=c.properties()[g.value],B=A.value;return typeof M==typeof B&&M<B}],"filter-id-<":[hi,[Ii],function(c,d){var g=d[0],A=c.id(),M=g.value;return typeof A==typeof M&&A<M}],"filter->":[hi,[Kr,Ii],function(c,d){var g=d[0],A=d[1],M=c.properties()[g.value],B=A.value;return typeof M==typeof B&&M>B}],"filter-id->":[hi,[Ii],function(c,d){var g=d[0],A=c.id(),M=g.value;return typeof A==typeof M&&A>M}],"filter-<=":[hi,[Kr,Ii],function(c,d){var g=d[0],A=d[1],M=c.properties()[g.value],B=A.value;return typeof M==typeof B&&M<=B}],"filter-id-<=":[hi,[Ii],function(c,d){var g=d[0],A=c.id(),M=g.value;return typeof A==typeof M&&A<=M}],"filter->=":[hi,[Kr,Ii],function(c,d){var g=d[0],A=d[1],M=c.properties()[g.value],B=A.value;return typeof M==typeof B&&M>=B}],"filter-id->=":[hi,[Ii],function(c,d){var g=d[0],A=c.id(),M=g.value;return typeof A==typeof M&&A>=M}],"filter-has":[hi,[Ii],function(c,d){return d[0].value in c.properties()}],"filter-has-id":[hi,[],function(c){return c.id()!==null&&c.id()!==void 0}],"filter-type-in":[hi,[Qo(Kr)],function(c,d){return d[0].value.indexOf(c.geometryType())>=0}],"filter-id-in":[hi,[Qo(Ii)],function(c,d){return d[0].value.indexOf(c.id())>=0}],"filter-in-small":[hi,[Kr,Qo(Ii)],function(c,d){var g=d[0];return d[1].value.indexOf(c.properties()[g.value])>=0}],"filter-in-large":[hi,[Kr,Qo(Ii)],function(c,d){var g=d[0],A=d[1];return function(M,B,V,Q){for(;V<=Q;){var me=V+Q>>1;if(B[me]===M)return!0;B[me]>M?Q=me-1:V=me+1}return!1}(c.properties()[g.value],A.value,0,A.value.length-1)}],all:{type:hi,overloads:[[[hi,hi],function(c,d){var g=d[1];return d[0].evaluate(c)&&g.evaluate(c)}],[Mr(hi),function(c,d){for(var g=0,A=d;g<A.length;g+=1)if(!A[g].evaluate(c))return!1;return!0}]]},any:{type:hi,overloads:[[[hi,hi],function(c,d){var g=d[1];return d[0].evaluate(c)||g.evaluate(c)}],[Mr(hi),function(c,d){for(var g=0,A=d;g<A.length;g+=1)if(A[g].evaluate(c))return!0;return!1}]]},"!":[hi,[hi],function(c,d){return!d[0].evaluate(c)}],"is-supported-script":[hi,[Kr],function(c,d){var g=c.globals&&c.globals.isSupportedScript;return!g||g(d[0].evaluate(c))}],upcase:[Kr,[Kr],function(c,d){return d[0].evaluate(c).toUpperCase()}],downcase:[Kr,[Kr],function(c,d){return d[0].evaluate(c).toLowerCase()}],concat:[Kr,Mr(Ii),function(c,d){return d.map(function(g){return ji(g.evaluate(c))}).join("")}],"resolved-locale":[Kr,[Fo],function(c,d){return d[0].evaluate(c).resolvedLocale()}]});var Xa=function(c,d){this.expression=c,this._warningHistory={},this._evaluator=new Jo,this._defaultValue=d?function(g){return g.type==="color"&&ha(g.default)?new pn(0,0,0,0):g.type==="color"?pn.parse(g.default)||null:g.default===void 0?null:g.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function Ls(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in qe}function Qa(c,d){var g=new ou(qe,[],d?function(M){var B={color:Qr,string:Kr,number:ar,enum:Kr,boolean:hi,formatted:_a,resolvedImage:Co};return M.type==="array"?Qo(B[M.value]||Ii,M.length):B[M.type]}(d):void 0),A=g.parse(c,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return A?Bi(new Xa(A,d)):zi(g.errors)}Xa.prototype.evaluateWithoutErrorHandling=function(c,d,g,A,M,B){return this._evaluator.globals=c,this._evaluator.feature=d,this._evaluator.featureState=g,this._evaluator.canonical=A,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=B,this.expression.evaluate(this._evaluator)},Xa.prototype.evaluate=function(c,d,g,A,M,B){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=g||null,this._evaluator.canonical=A,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=B||null;try{var V=this.expression.evaluate(this._evaluator);if(V==null||typeof V=="number"&&V!=V)return this._defaultValue;if(this._enumValues&&!(V in this._enumValues))throw new Gr("Expected value to be one of "+Object.keys(this._enumValues).map(function(Q){return JSON.stringify(Q)}).join(", ")+", but found "+JSON.stringify(V)+" instead.");return V}catch(Q){return this._warningHistory[Q.message]||(this._warningHistory[Q.message]=!0,typeof console!="undefined"&&console.warn(Q.message)),this._defaultValue}};var Ec=function(c,d){this.kind=c,this._styleExpression=d,this.isStateDependent=c!=="constant"&&!Nf(d.expression)};Ec.prototype.evaluateWithoutErrorHandling=function(c,d,g,A,M,B){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,A,M,B)},Ec.prototype.evaluate=function(c,d,g,A,M,B){return this._styleExpression.evaluate(c,d,g,A,M,B)};var cs=function(c,d,g,A){this.kind=c,this.zoomStops=g,this._styleExpression=d,this.isStateDependent=c!=="camera"&&!Nf(d.expression),this.interpolationType=A};function Bu(c,d){if((c=Qa(c,d)).result==="error")return c;var g=c.value.expression,A=Df(g);if(!A&&!so(d))return zi([new kr("","data expressions not supported")]);var M=rc(g,["zoom"]);if(!M&&!Si(d))return zi([new kr("","zoom expressions not supported")]);var B=function V(Q){var me=null;if(Q instanceof _s)me=V(Q.result);else if(Q instanceof Qu)for(var Le=0,We=Q.args;Le<We.length&&!(me=V(We[Le]));Le+=1);else(Q instanceof lc||Q instanceof zl)&&Q.input instanceof Wo&&Q.input.name==="zoom"&&(me=Q);return me instanceof kr||Q.eachChild(function(tt){var Et=V(tt);Et instanceof kr?me=Et:!me&&Et?me=new kr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):me&&Et&&me!==Et&&(me=new kr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),me}(g);return B||M?B instanceof kr?zi([B]):B instanceof zl&&!Sa(d)?zi([new kr("",'"interpolate" expressions cannot be used with this property')]):Bi(B?new cs(A?"camera":"composite",c.value,B.labels,B instanceof zl?B.interpolation:void 0):new Ec(A?"constant":"source",c.value)):zi([new kr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}cs.prototype.evaluateWithoutErrorHandling=function(c,d,g,A,M,B){return this._styleExpression.evaluateWithoutErrorHandling(c,d,g,A,M,B)},cs.prototype.evaluate=function(c,d,g,A,M,B){return this._styleExpression.evaluate(c,d,g,A,M,B)},cs.prototype.interpolationFactor=function(c,d,g){return this.interpolationType?zl.interpolationFactor(this.interpolationType,c,d,g):0};var bu=function(c,d){this._parameters=c,this._specification=d,Er(this,function g(A,M){var B,V,Q,me=M.type==="color",Le=A.stops&&typeof A.stops[0][0]=="object",We=Le||!(Le||A.property!==void 0),tt=A.type||(Sa(M)?"exponential":"interval");if(me&&((A=Er({},A)).stops&&(A.stops=A.stops.map(function(ki){return[ki[0],pn.parse(ki[1])]})),A.default=pn.parse(A.default?A.default:M.default)),A.colorSpace&&A.colorSpace!=="rgb"&&!Vd[A.colorSpace])throw new Error("Unknown color space: "+A.colorSpace);if(tt==="exponential")B=Ma;else if(tt==="interval")B=ls;else if(tt==="categorical"){B=Aa,V=Object.create(null);for(var Et=0,Nt=A.stops;Et<Nt.length;Et+=1){var tn=Nt[Et];V[tn[0]]=tn[1]}Q=typeof A.stops[0][0]}else{if(tt!=="identity")throw new Error('Unknown function type "'+tt+'"');B=Da}if(Le){for(var _n={},zn=[],Dn=0;Dn<A.stops.length;Dn++){var cr=A.stops[Dn],_r=cr[0].zoom;_n[_r]===void 0&&(_n[_r]={zoom:_r,type:A.type,property:A.property,default:A.default,stops:[]},zn.push(_r)),_n[_r].stops.push([cr[0].value,cr[1]])}for(var Ir=[],Br=0,jr=zn;Br<jr.length;Br+=1){var bi=jr[Br];Ir.push([_n[bi].zoom,g(_n[bi],M)])}var Zi={name:"linear"};return{kind:"composite",interpolationType:Zi,interpolationFactor:zl.interpolationFactor.bind(void 0,Zi),zoomStops:Ir.map(function(ki){return ki[0]}),evaluate:function(ki,zo){var ao=ki.zoom;return Ma({stops:Ir,base:A.base},M,ao).evaluate(ao,zo)}}}if(We){var Ro=tt==="exponential"?{name:"exponential",base:A.base!==void 0?A.base:1}:null;return{kind:"camera",interpolationType:Ro,interpolationFactor:zl.interpolationFactor.bind(void 0,Ro),zoomStops:A.stops.map(function(ki){return ki[0]}),evaluate:function(ki){return B(A,M,ki.zoom,V,Q)}}}return{kind:"source",evaluate:function(ki,zo){var ao=zo&&zo.properties?zo.properties[A.property]:void 0;return ao===void 0?ua(A.default,M.default):B(A,M,ao,V,Q)}}}(this._parameters,this._specification))};function Nc(c){var d=c.key,g=c.value,A=c.valueSpec||{},M=c.objectElementValidators||{},B=c.style,V=c.styleSpec,Q=[],me=Do(g);if(me!=="object")return[new Jt(d,g,"object expected, "+me+" found")];for(var Le in g){var We=Le.split(".")[0],tt=A[We]||A["*"],Et=void 0;if(M[We])Et=M[We];else if(A[We])Et=Ie;else if(M["*"])Et=M["*"];else{if(!A["*"]){Q.push(new Jt(d,g[Le],'unknown property "'+Le+'"'));continue}Et=Ie}Q=Q.concat(Et({key:(d&&d+".")+Le,value:g[Le],valueSpec:tt,style:B,styleSpec:V,object:g,objectKey:Le},g))}for(var Nt in A)M[Nt]||A[Nt].required&&A[Nt].default===void 0&&g[Nt]===void 0&&Q.push(new Jt(d,g,'missing required property "'+Nt+'"'));return Q}function Qf(c){var d=c.value,g=c.valueSpec,A=c.style,M=c.styleSpec,B=c.key,V=c.arrayElementValidator||Ie;if(Do(d)!=="array")return[new Jt(B,d,"array expected, "+Do(d)+" found")];if(g.length&&d.length!==g.length)return[new Jt(B,d,"array length "+g.length+" expected, length "+d.length+" found")];if(g["min-length"]&&d.length<g["min-length"])return[new Jt(B,d,"array length at least "+g["min-length"]+" expected, length "+d.length+" found")];var Q={type:g.value,values:g.values};M.$version<7&&(Q.function=g.function),Do(g.value)==="object"&&(Q=g.value);for(var me=[],Le=0;Le<d.length;Le++)me=me.concat(V({array:d,arrayIndex:Le,value:d[Le],valueSpec:Q,style:A,styleSpec:M,key:B+"["+Le+"]"}));return me}function xd(c){var d=c.key,g=c.value,A=c.valueSpec,M=Do(g);return M==="number"&&g!=g&&(M="NaN"),M!=="number"?[new Jt(d,g,"number expected, "+M+" found")]:"minimum"in A&&g<A.minimum?[new Jt(d,g,g+" is less than the minimum value "+A.minimum)]:"maximum"in A&&g>A.maximum?[new Jt(d,g,g+" is greater than the maximum value "+A.maximum)]:[]}function bh(c){var d,g,A,M=c.valueSpec,B=Vr(c.value.type),V={},Q=B!=="categorical"&&c.value.property===void 0,me=!Q,Le=Do(c.value.stops)==="array"&&Do(c.value.stops[0])==="array"&&Do(c.value.stops[0][0])==="object",We=Nc({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Nt){if(B==="identity")return[new Jt(Nt.key,Nt.value,'identity function may not have a "stops" property')];var tn=[],_n=Nt.value;return tn=tn.concat(Qf({key:Nt.key,value:_n,valueSpec:Nt.valueSpec,style:Nt.style,styleSpec:Nt.styleSpec,arrayElementValidator:tt})),Do(_n)==="array"&&_n.length===0&&tn.push(new Jt(Nt.key,_n,"array must have at least one stop")),tn},default:function(Nt){return Ie({key:Nt.key,value:Nt.value,valueSpec:M,style:Nt.style,styleSpec:Nt.styleSpec})}}});return B==="identity"&&Q&&We.push(new Jt(c.key,c.value,'missing required property "property"')),B==="identity"||c.value.stops||We.push(new Jt(c.key,c.value,'missing required property "stops"')),B==="exponential"&&c.valueSpec.expression&&!Sa(c.valueSpec)&&We.push(new Jt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(me&&!so(c.valueSpec)?We.push(new Jt(c.key,c.value,"property functions not supported")):Q&&!Si(c.valueSpec)&&We.push(new Jt(c.key,c.value,"zoom functions not supported"))),B!=="categorical"&&!Le||c.value.property!==void 0||We.push(new Jt(c.key,c.value,'"property" property is required')),We;function tt(Nt){var tn=[],_n=Nt.value,zn=Nt.key;if(Do(_n)!=="array")return[new Jt(zn,_n,"array expected, "+Do(_n)+" found")];if(_n.length!==2)return[new Jt(zn,_n,"array length 2 expected, length "+_n.length+" found")];if(Le){if(Do(_n[0])!=="object")return[new Jt(zn,_n,"object expected, "+Do(_n[0])+" found")];if(_n[0].zoom===void 0)return[new Jt(zn,_n,"object stop key must have zoom")];if(_n[0].value===void 0)return[new Jt(zn,_n,"object stop key must have value")];if(A&&A>Vr(_n[0].zoom))return[new Jt(zn,_n[0].zoom,"stop zoom values must appear in ascending order")];Vr(_n[0].zoom)!==A&&(A=Vr(_n[0].zoom),g=void 0,V={}),tn=tn.concat(Nc({key:zn+"[0]",value:_n[0],valueSpec:{zoom:{}},style:Nt.style,styleSpec:Nt.styleSpec,objectElementValidators:{zoom:xd,value:Et}}))}else tn=tn.concat(Et({key:zn+"[0]",value:_n[0],valueSpec:{},style:Nt.style,styleSpec:Nt.styleSpec},_n));return Ls(mr(_n[1]))?tn.concat([new Jt(zn+"[1]",_n[1],"expressions are not allowed in function stops.")]):tn.concat(Ie({key:zn+"[1]",value:_n[1],valueSpec:M,style:Nt.style,styleSpec:Nt.styleSpec}))}function Et(Nt,tn){var _n=Do(Nt.value),zn=Vr(Nt.value),Dn=Nt.value!==null?Nt.value:tn;if(d){if(_n!==d)return[new Jt(Nt.key,Dn,_n+" stop domain type must match previous stop domain type "+d)]}else d=_n;if(_n!=="number"&&_n!=="string"&&_n!=="boolean")return[new Jt(Nt.key,Dn,"stop domain value must be a number, string, or boolean")];if(_n!=="number"&&B!=="categorical"){var cr="number expected, "+_n+" found";return so(M)&&B===void 0&&(cr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Jt(Nt.key,Dn,cr)]}return B!=="categorical"||_n!=="number"||isFinite(zn)&&Math.floor(zn)===zn?B!=="categorical"&&_n==="number"&&g!==void 0&&zn<g?[new Jt(Nt.key,Dn,"stop domain values must appear in ascending order")]:(g=zn,B==="categorical"&&zn in V?[new Jt(Nt.key,Dn,"stop domain values must be unique")]:(V[zn]=!0,[])):[new Jt(Nt.key,Dn,"integer expected, found "+zn)]}}function yf(c){var d=(c.expressionContext==="property"?Bu:Qa)(mr(c.value),c.valueSpec);if(d.result==="error")return d.value.map(function(A){return new Jt(""+c.key+A.key,c.value,A.message)});var g=d.value.expression||d.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!g.outputDefined())return[new Jt(c.key,c.value,'Invalid data expression for "'+c.propertyKey+'". Output values must be contained as literals within the expression.')];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Nf(g))return[new Jt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Nf(g))return[new Jt(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!rc(g,["zoom","feature-state"]))return[new Jt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Df(g))return[new Jt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function tf(c){var d=c.key,g=c.value,A=c.valueSpec,M=[];return Array.isArray(A.values)?A.values.indexOf(Vr(g))===-1&&M.push(new Jt(d,g,"expected one of ["+A.values.join(", ")+"], "+JSON.stringify(g)+" found")):Object.keys(A.values).indexOf(Vr(g))===-1&&M.push(new Jt(d,g,"expected one of ["+Object.keys(A.values).join(", ")+"], "+JSON.stringify(g)+" found")),M}function Gh(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(var d=0,g=c.slice(1);d<g.length;d+=1){var A=g[d];if(!Gh(A)&&typeof A!="boolean")return!1}return!0;default:return!0}}bu.deserialize=function(c){return new bu(c._parameters,c._specification)},bu.serialize=function(c){return{_parameters:c._parameters,_specification:c._specification}};var xh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(c){if(c==null)return{filter:function(){return!0},needGeometry:!1};Gh(c)||(c=Jf(c));var d=Qa(c,xh);if(d.result==="error")throw new Error(d.value.map(function(g){return g.key+": "+g.message}).join(", "));return{filter:function(g,A,M){return d.value.evaluate(g,A,{},M)},needGeometry:function g(A){if(!Array.isArray(A))return!1;if(A[0]==="within")return!0;for(var M=1;M<A.length;M++)if(g(A[M]))return!0;return!1}(c)}}function n0(c,d){return c<d?-1:c>d?1:0}function Jf(c){if(!c)return!0;var d,g=c[0];return c.length<=1?g!=="any":g==="=="?xp(c[1],c[2],"=="):g==="!="?Xh(xp(c[1],c[2],"==")):g==="<"||g===">"||g==="<="||g===">="?xp(c[1],c[2],g):g==="any"?(d=c.slice(1),["any"].concat(d.map(Jf))):g==="all"?["all"].concat(c.slice(1).map(Jf)):g==="none"?["all"].concat(c.slice(1).map(Jf).map(Xh)):g==="in"?Ed(c[1],c.slice(2)):g==="!in"?Xh(Ed(c[1],c.slice(2))):g==="has"?Bc(c[1]):g==="!has"?Xh(Bc(c[1])):g!=="within"||c}function xp(c,d,g){switch(c){case"$type":return["filter-type-"+g,d];case"$id":return["filter-id-"+g,d];default:return["filter-"+g,c,d]}}function Ed(c,d){if(d.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(g){return typeof g!=typeof d[0]})?["filter-in-large",c,["literal",d.sort(n0)]]:["filter-in-small",c,["literal",d]]}}function Bc(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Xh(c){return["!",c]}function Zd(c){return Gh(mr(c.value))?yf(Er({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(g){var A=g.value,M=g.key;if(Do(A)!=="array")return[new Jt(M,A,"array expected, "+Do(A)+" found")];var B,V=g.styleSpec,Q=[];if(A.length<1)return[new Jt(M,A,"filter array must have at least 1 element")];switch(Q=Q.concat(tf({key:M+"[0]",value:A[0],valueSpec:V.filter_operator,style:g.style,styleSpec:g.styleSpec})),Vr(A[0])){case"<":case"<=":case">":case">=":A.length>=2&&Vr(A[1])==="$type"&&Q.push(new Jt(M,A,'"$type" cannot be use with operator "'+A[0]+'"'));case"==":case"!=":A.length!==3&&Q.push(new Jt(M,A,'filter array for operator "'+A[0]+'" must have 3 elements'));case"in":case"!in":A.length>=2&&(B=Do(A[1]))!=="string"&&Q.push(new Jt(M+"[1]",A[1],"string expected, "+B+" found"));for(var me=2;me<A.length;me++)B=Do(A[me]),Vr(A[1])==="$type"?Q=Q.concat(tf({key:M+"["+me+"]",value:A[me],valueSpec:V.geometry_type,style:g.style,styleSpec:g.styleSpec})):B!=="string"&&B!=="number"&&B!=="boolean"&&Q.push(new Jt(M+"["+me+"]",A[me],"string, number, or boolean expected, "+B+" found"));break;case"any":case"all":case"none":for(var Le=1;Le<A.length;Le++)Q=Q.concat(d({key:M+"["+Le+"]",value:A[Le],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":B=Do(A[1]),A.length!==2?Q.push(new Jt(M,A,'filter array for "'+A[0]+'" operator must have 2 elements')):B!=="string"&&Q.push(new Jt(M+"[1]",A[1],"string expected, "+B+" found"));break;case"within":B=Do(A[1]),A.length!==2?Q.push(new Jt(M,A,'filter array for "'+A[0]+'" operator must have 2 elements')):B!=="object"&&Q.push(new Jt(M+"[1]",A[1],"object expected, "+B+" found"))}return Q}(c)}function Eh(c,d){var g=c.key,A=c.style,M=c.styleSpec,B=c.value,V=c.objectKey,Q=M[d+"_"+c.layerType];if(!Q)return[];var me=V.match(/^(.*)-transition$/);if(d==="paint"&&me&&Q[me[1]]&&Q[me[1]].transition)return Ie({key:g,value:B,valueSpec:M.transition,style:A,styleSpec:M});var Le,We=c.valueSpec||Q[V];if(!We)return[new Jt(g,B,'unknown property "'+V+'"')];if(Do(B)==="string"&&so(We)&&!We.tokens&&(Le=/^{([^}]+)}$/.exec(B)))return[new Jt(g,B,'"'+V+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Le[1])+" }`.")];var tt=[];return c.layerType==="symbol"&&(V==="text-field"&&A&&!A.glyphs&&tt.push(new Jt(g,B,'use of "text-field" requires a style "glyphs" property')),V==="text-font"&&ha(mr(B))&&Vr(B.type)==="identity"&&tt.push(new Jt(g,B,'"text-font" does not support identity functions'))),tt.concat(Ie({key:c.key,value:B,valueSpec:We,style:A,styleSpec:M,expressionContext:"property",propertyType:d,propertyKey:V}))}function Yh(c){return Eh(c,"paint")}function xu(c){return Eh(c,"layout")}function Sh(c){var d=[],g=c.value,A=c.key,M=c.style,B=c.styleSpec;g.type||g.ref||d.push(new Jt(A,g,'either "type" or "ref" is required'));var V,Q=Vr(g.type),me=Vr(g.ref);if(g.id)for(var Le=Vr(g.id),We=0;We<c.arrayIndex;We++){var tt=M.layers[We];Vr(tt.id)===Le&&d.push(new Jt(A,g.id,'duplicate layer id "'+g.id+'", previously used at line '+tt.id.__line__))}if("ref"in g)["type","source","source-layer","filter","layout"].forEach(function(tn){tn in g&&d.push(new Jt(A,g[tn],'"'+tn+'" is prohibited for ref layers'))}),M.layers.forEach(function(tn){Vr(tn.id)===me&&(V=tn)}),V?V.ref?d.push(new Jt(A,g.ref,"ref cannot reference another ref layer")):Q=Vr(V.type):d.push(new Jt(A,g.ref,'ref layer "'+me+'" not found'));else if(Q!=="background")if(g.source){var Et=M.sources&&M.sources[g.source],Nt=Et&&Vr(Et.type);Et?Nt==="vector"&&Q==="raster"?d.push(new Jt(A,g.source,'layer "'+g.id+'" requires a raster source')):Nt==="raster"&&Q!=="raster"?d.push(new Jt(A,g.source,'layer "'+g.id+'" requires a vector source')):Nt!=="vector"||g["source-layer"]?Nt==="raster-dem"&&Q!=="hillshade"?d.push(new Jt(A,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!g.paint||!g.paint["line-gradient"]||Nt==="geojson"&&Et.lineMetrics||d.push(new Jt(A,g,'layer "'+g.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new Jt(A,g,'layer "'+g.id+'" must specify a "source-layer"')):d.push(new Jt(A,g.source,'source "'+g.source+'" not found'))}else d.push(new Jt(A,g,'missing required property "source"'));return d=d.concat(Nc({key:A,value:g,valueSpec:B.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ie({key:A+".type",value:g.type,valueSpec:B.layer.type,style:c.style,styleSpec:c.styleSpec,object:g,objectKey:"type"})},filter:Zd,layout:function(tn){return Nc({layer:g,key:tn.key,value:tn.value,style:tn.style,styleSpec:tn.styleSpec,objectElementValidators:{"*":function(_n){return xu(Er({layerType:Q},_n))}}})},paint:function(tn){return Nc({layer:g,key:tn.key,value:tn.value,style:tn.style,styleSpec:tn.styleSpec,objectElementValidators:{"*":function(_n){return Yh(Er({layerType:Q},_n))}}})}}}))}function _f(c){var d=c.value,g=c.key,A=Do(d);return A!=="string"?[new Jt(g,d,"string expected, "+A+" found")]:[]}var ks={promoteId:function(c){var d=c.key,g=c.value;if(Do(g)==="string")return _f({key:d,value:g});var A=[];for(var M in g)A.push.apply(A,_f({key:d+"."+M,value:g[M]}));return A}};function Wd(c){var d=c.value,g=c.key,A=c.styleSpec,M=c.style;if(!d.type)return[new Jt(g,d,'"type" is required')];var B,V=Vr(d.type);switch(V){case"vector":case"raster":case"raster-dem":return Nc({key:g,value:d,valueSpec:A["source_"+V.replace("-","_")],style:c.style,styleSpec:A,objectElementValidators:ks});case"geojson":if(B=Nc({key:g,value:d,valueSpec:A.source_geojson,style:M,styleSpec:A,objectElementValidators:ks}),d.cluster)for(var Q in d.clusterProperties){var me=d.clusterProperties[Q],Le=me[0],We=typeof Le=="string"?[Le,["accumulated"],["get",Q]]:Le;B.push.apply(B,yf({key:g+"."+Q+".map",value:me[1],expressionContext:"cluster-map"})),B.push.apply(B,yf({key:g+"."+Q+".reduce",value:We,expressionContext:"cluster-reduce"}))}return B;case"video":return Nc({key:g,value:d,valueSpec:A.source_video,style:M,styleSpec:A});case"image":return Nc({key:g,value:d,valueSpec:A.source_image,style:M,styleSpec:A});case"canvas":return[new Jt(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tf({key:g+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:M,styleSpec:A})}}function Gl(c){var d=c.value,g=c.styleSpec,A=g.light,M=c.style,B=[],V=Do(d);if(d===void 0)return B;if(V!=="object")return B.concat([new Jt("light",d,"object expected, "+V+" found")]);for(var Q in d){var me=Q.match(/^(.*)-transition$/);B=B.concat(me&&A[me[1]]&&A[me[1]].transition?Ie({key:Q,value:d[Q],valueSpec:g.transition,style:M,styleSpec:g}):A[Q]?Ie({key:Q,value:d[Q],valueSpec:A[Q],style:M,styleSpec:g}):[new Jt(Q,d[Q],'unknown property "'+Q+'"')])}return B}var fe={"*":function(){return[]},array:Qf,boolean:function(c){var d=c.value,g=c.key,A=Do(d);return A!=="boolean"?[new Jt(g,d,"boolean expected, "+A+" found")]:[]},number:xd,color:function(c){var d=c.key,g=c.value,A=Do(g);return A!=="string"?[new Jt(d,g,"color expected, "+A+" found")]:kn(g)===null?[new Jt(d,g,'color expected, "'+g+'" found')]:[]},constants:Qn,enum:tf,filter:Zd,function:bh,layer:Sh,object:Nc,source:Wd,light:Gl,string:_f,formatted:function(c){return _f(c).length===0?[]:yf(c)},resolvedImage:function(c){return _f(c).length===0?[]:yf(c)}};function Ie(c){var d=c.value,g=c.valueSpec,A=c.styleSpec;return g.expression&&ha(Vr(d))?bh(c):g.expression&&Ls(mr(d))?yf(c):g.type&&fe[g.type]?fe[g.type](c):Nc(Er({},c,{valueSpec:g.type?A[g.type]:g}))}function ct(c){var d=c.value,g=c.key,A=_f(c);return A.length||(d.indexOf("{fontstack}")===-1&&A.push(new Jt(g,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&A.push(new Jt(g,d,'"glyphs" url must include a "{range}" token'))),A}function gn(c,d){d===void 0&&(d=yt);var g=[];return g=g.concat(Ie({key:"",value:c,valueSpec:d.$root,styleSpec:d,style:c,objectElementValidators:{glyphs:ct,"*":function(){return[]}}})),c.constants&&(g=g.concat(Qn({key:"constants",value:c.constants,style:c,styleSpec:d}))),ir(g)}function ir(c){return[].concat(c).sort(function(d,g){return d.line-g.line})}function Ur(c){return function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];return ir(c.apply(this,d))}}gn.source=Ur(Wd),gn.light=Ur(Gl),gn.layer=Ur(Sh),gn.filter=Ur(Zd),gn.paintProperty=Ur(Yh),gn.layoutProperty=Ur(xu);var mi=gn,Ki=mi.light,ma=mi.paintProperty,ba=mi.layoutProperty;function bs(c,d){var g=!1;if(d&&d.length)for(var A=0,M=d;A<M.length;A+=1)c.fire(new qt(new Error(M[A].message))),g=!0;return g}var za=Na;function Na(c,d,g){var A=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var M=new Int32Array(this.arrayBuffer);c=M[0],this.d=(d=M[1])+2*(g=M[2]);for(var B=0;B<this.d*this.d;B++){var V=M[3+B],Q=M[3+B+1];A.push(V===Q?null:M.subarray(V,Q))}var me=M[3+A.length+1];this.keys=M.subarray(M[3+A.length],me),this.bboxes=M.subarray(me),this.insert=this._insertReadonly}else{this.d=d+2*g;for(var Le=0;Le<this.d*this.d;Le++)A.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=c,this.padding=g,this.scale=d/c,this.uid=0;var We=g/d*c;this.min=-We,this.max=c+We}Na.prototype.insert=function(c,d,g,A,M){this._forEachCell(d,g,A,M,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(A),this.bboxes.push(M)},Na.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Na.prototype._insertCell=function(c,d,g,A,M,B){this.cells[M].push(B)},Na.prototype.query=function(c,d,g,A,M){var B=this.min,V=this.max;if(c<=B&&d<=B&&V<=g&&V<=A&&!M)return Array.prototype.slice.call(this.keys);var Q=[];return this._forEachCell(c,d,g,A,this._queryCell,Q,{},M),Q},Na.prototype._queryCell=function(c,d,g,A,M,B,V,Q){var me=this.cells[M];if(me!==null)for(var Le=this.keys,We=this.bboxes,tt=0;tt<me.length;tt++){var Et=me[tt];if(V[Et]===void 0){var Nt=4*Et;(Q?Q(We[Nt+0],We[Nt+1],We[Nt+2],We[Nt+3]):c<=We[Nt+2]&&d<=We[Nt+3]&&g>=We[Nt+0]&&A>=We[Nt+1])?(V[Et]=!0,B.push(Le[Et])):V[Et]=!1}}},Na.prototype._forEachCell=function(c,d,g,A,M,B,V,Q){for(var me=this._convertToCellCoord(c),Le=this._convertToCellCoord(d),We=this._convertToCellCoord(g),tt=this._convertToCellCoord(A),Et=me;Et<=We;Et++)for(var Nt=Le;Nt<=tt;Nt++){var tn=this.d*Nt+Et;if((!Q||Q(this._convertFromCellCoord(Et),this._convertFromCellCoord(Nt),this._convertFromCellCoord(Et+1),this._convertFromCellCoord(Nt+1)))&&M.call(this,c,d,g,A,tn,B,V,Q))return}},Na.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},Na.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},Na.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,d=3+this.cells.length+1+1,g=0,A=0;A<this.cells.length;A++)g+=this.cells[A].length;var M=new Int32Array(d+g+this.keys.length+this.bboxes.length);M[0]=this.extent,M[1]=this.n,M[2]=this.padding;for(var B=d,V=0;V<c.length;V++){var Q=c[V];M[3+V]=B,M.set(Q,B),B+=Q.length}return M[3+c.length]=B,M.set(this.keys,B),M[3+c.length+1]=B+=this.keys.length,M.set(this.bboxes,B),B+=this.bboxes.length,M.buffer};var Sc=oe.ImageData,nf=oe.ImageBitmap,Ys={};function io(c,d,g){g===void 0&&(g={}),Object.defineProperty(d,"_classRegistryKey",{value:c,writeable:!1}),Ys[c]={klass:d,omit:g.omit||[],shallow:g.shallow||[]}}for(var Wc in io("Object",Object),za.serialize=function(c,d){var g=c.toArrayBuffer();return d&&d.push(g),{buffer:g}},za.deserialize=function(c){return new za(c.buffer)},io("Grid",za),io("Color",pn),io("Error",Error),io("ResolvedImage",ci),io("StylePropertyFunction",bu),io("StyleExpression",Xa,{omit:["_evaluator"]}),io("ZoomDependentExpression",cs),io("ZoomConstantExpression",Ec),io("CompoundExpression",Wo,{omit:["_evaluate"]}),qe)qe[Wc]._classRegistryKey||io("Expression_"+Wc,qe[Wc]);function Gd(c){return c&&typeof ArrayBuffer!="undefined"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function $h(c){return nf&&c instanceof nf}function _l(c,d){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Gd(c)||$h(c))return d&&d.push(c),c;if(ArrayBuffer.isView(c)){var g=c;return d&&d.push(g.buffer),g}if(c instanceof Sc)return d&&d.push(c.data.buffer),c;if(Array.isArray(c)){for(var A=[],M=0,B=c;M<B.length;M+=1)A.push(_l(B[M],d));return A}if(typeof c=="object"){var V=c.constructor,Q=V._classRegistryKey;if(!Q)throw new Error("can't serialize object of unregistered class");var me=V.serialize?V.serialize(c,d):{};if(!V.serialize){for(var Le in c)if(c.hasOwnProperty(Le)&&!(Ys[Q].omit.indexOf(Le)>=0)){var We=c[Le];me[Le]=Ys[Q].shallow.indexOf(Le)>=0?We:_l(We,d)}c instanceof Error&&(me.message=c.message)}if(me.$name)throw new Error("$name property is reserved for worker serialization logic.");return Q!=="Object"&&(me.$name=Q),me}throw new Error("can't serialize object of type "+typeof c)}function Ja(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Gd(c)||$h(c)||ArrayBuffer.isView(c)||c instanceof Sc)return c;if(Array.isArray(c))return c.map(Ja);if(typeof c=="object"){var d=c.$name||"Object",g=Ys[d].klass;if(!g)throw new Error("can't deserialize unregistered class "+d);if(g.deserialize)return g.deserialize(c);for(var A=Object.create(g.prototype),M=0,B=Object.keys(c);M<B.length;M+=1){var V=B[M];if(V!=="$name"){var Q=c[V];A[V]=Ys[d].shallow.indexOf(V)>=0?Q:Ja(Q)}}return A}throw new Error("can't deserialize object of type "+typeof c)}var r0=function(){this.first=!0};r0.prototype.update=function(c,d){var g=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=d),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=g,!0))};var Xi={"Latin-1 Supplement":function(c){return c>=128&&c<=255},Arabic:function(c){return c>=1536&&c<=1791},"Arabic Supplement":function(c){return c>=1872&&c<=1919},"Arabic Extended-A":function(c){return c>=2208&&c<=2303},"Hangul Jamo":function(c){return c>=4352&&c<=4607},"Unified Canadian Aboriginal Syllabics":function(c){return c>=5120&&c<=5759},Khmer:function(c){return c>=6016&&c<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(c){return c>=6320&&c<=6399},"General Punctuation":function(c){return c>=8192&&c<=8303},"Letterlike Symbols":function(c){return c>=8448&&c<=8527},"Number Forms":function(c){return c>=8528&&c<=8591},"Miscellaneous Technical":function(c){return c>=8960&&c<=9215},"Control Pictures":function(c){return c>=9216&&c<=9279},"Optical Character Recognition":function(c){return c>=9280&&c<=9311},"Enclosed Alphanumerics":function(c){return c>=9312&&c<=9471},"Geometric Shapes":function(c){return c>=9632&&c<=9727},"Miscellaneous Symbols":function(c){return c>=9728&&c<=9983},"Miscellaneous Symbols and Arrows":function(c){return c>=11008&&c<=11263},"CJK Radicals Supplement":function(c){return c>=11904&&c<=12031},"Kangxi Radicals":function(c){return c>=12032&&c<=12255},"Ideographic Description Characters":function(c){return c>=12272&&c<=12287},"CJK Symbols and Punctuation":function(c){return c>=12288&&c<=12351},Hiragana:function(c){return c>=12352&&c<=12447},Katakana:function(c){return c>=12448&&c<=12543},Bopomofo:function(c){return c>=12544&&c<=12591},"Hangul Compatibility Jamo":function(c){return c>=12592&&c<=12687},Kanbun:function(c){return c>=12688&&c<=12703},"Bopomofo Extended":function(c){return c>=12704&&c<=12735},"CJK Strokes":function(c){return c>=12736&&c<=12783},"Katakana Phonetic Extensions":function(c){return c>=12784&&c<=12799},"Enclosed CJK Letters and Months":function(c){return c>=12800&&c<=13055},"CJK Compatibility":function(c){return c>=13056&&c<=13311},"CJK Unified Ideographs Extension A":function(c){return c>=13312&&c<=19903},"Yijing Hexagram Symbols":function(c){return c>=19904&&c<=19967},"CJK Unified Ideographs":function(c){return c>=19968&&c<=40959},"Yi Syllables":function(c){return c>=40960&&c<=42127},"Yi Radicals":function(c){return c>=42128&&c<=42191},"Hangul Jamo Extended-A":function(c){return c>=43360&&c<=43391},"Hangul Syllables":function(c){return c>=44032&&c<=55215},"Hangul Jamo Extended-B":function(c){return c>=55216&&c<=55295},"Private Use Area":function(c){return c>=57344&&c<=63743},"CJK Compatibility Ideographs":function(c){return c>=63744&&c<=64255},"Arabic Presentation Forms-A":function(c){return c>=64336&&c<=65023},"Vertical Forms":function(c){return c>=65040&&c<=65055},"CJK Compatibility Forms":function(c){return c>=65072&&c<=65103},"Small Form Variants":function(c){return c>=65104&&c<=65135},"Arabic Presentation Forms-B":function(c){return c>=65136&&c<=65279},"Halfwidth and Fullwidth Forms":function(c){return c>=65280&&c<=65519}};function Ff(c){for(var d=0,g=c;d<g.length;d+=1)if(Eu(g[d].charCodeAt(0)))return!0;return!1}function Eu(c){return!(c!==746&&c!==747&&(c<4352||!(Xi["Bopomofo Extended"](c)||Xi.Bopomofo(c)||Xi["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Xi["CJK Compatibility Ideographs"](c)||Xi["CJK Compatibility"](c)||Xi["CJK Radicals Supplement"](c)||Xi["CJK Strokes"](c)||!(!Xi["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Xi["CJK Unified Ideographs Extension A"](c)||Xi["CJK Unified Ideographs"](c)||Xi["Enclosed CJK Letters and Months"](c)||Xi["Hangul Compatibility Jamo"](c)||Xi["Hangul Jamo Extended-A"](c)||Xi["Hangul Jamo Extended-B"](c)||Xi["Hangul Jamo"](c)||Xi["Hangul Syllables"](c)||Xi.Hiragana(c)||Xi["Ideographic Description Characters"](c)||Xi.Kanbun(c)||Xi["Kangxi Radicals"](c)||Xi["Katakana Phonetic Extensions"](c)||Xi.Katakana(c)&&c!==12540||!(!Xi["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Xi["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Xi["Unified Canadian Aboriginal Syllabics"](c)||Xi["Unified Canadian Aboriginal Syllabics Extended"](c)||Xi["Vertical Forms"](c)||Xi["Yijing Hexagram Symbols"](c)||Xi["Yi Syllables"](c)||Xi["Yi Radicals"](c))))}function Ep(c){return!(Eu(c)||function(d){return!!(Xi["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Xi["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Xi["Letterlike Symbols"](d)||Xi["Number Forms"](d)||Xi["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Xi["Control Pictures"](d)&&d!==9251||Xi["Optical Character Recognition"](d)||Xi["Enclosed Alphanumerics"](d)||Xi["Geometric Shapes"](d)||Xi["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Xi["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Xi["CJK Symbols and Punctuation"](d)||Xi.Katakana(d)||Xi["Private Use Area"](d)||Xi["CJK Compatibility Forms"](d)||Xi["Small Form Variants"](d)||Xi["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(c))}function rf(c){return c>=1424&&c<=2303||Xi["Arabic Presentation Forms-A"](c)||Xi["Arabic Presentation Forms-B"](c)}function of(c,d){return!(!d&&rf(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Xi.Khmer(c))}function eh(c){for(var d=0,g=c;d<g.length;d+=1)if(rf(g[d].charCodeAt(0)))return!0;return!1}var Sp=null,Gc="unavailable",th=null,i0=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Gc="error"),Sp&&Sp(c)};function Sd(){k0.fire(new wt("pluginStateChange",{pluginStatus:Gc,pluginURL:th}))}var k0=new vn,z0=function(){return Gc},su=function(){if(Gc!=="deferred"||!th)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gc="loading",Sd(),th&&xr({url:th},function(c){c?i0(c):(Gc="loaded",Sd())})},af={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Gc==="loaded"||af.applyArabicShaping!=null},isLoading:function(){return Gc==="loading"},setState:function(c){Gc=c.pluginStatus,th=c.pluginURL},isParsed:function(){return af.applyArabicShaping!=null&&af.processBidirectionalText!=null&&af.processStyledBidirectionalText!=null},getPluginURL:function(){return th}},Ta=function(c,d){this.zoom=c,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new r0,this.transition={})};Ta.prototype.isSupportedScript=function(c){return function(d,g){for(var A=0,M=d;A<M.length;A+=1)if(!of(M[A].charCodeAt(0),g))return!1;return!0}(c,af.isLoaded())},Ta.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ta.prototype.getCrossfadeParameters=function(){var c=this.zoom,d=c-Math.floor(c),g=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*d}};var ku=function(c,d){this.property=c,this.value=d,this.expression=function(g,A){if(ha(g))return new bu(g,A);if(Ls(g)){var M=Bu(g,A);if(M.result==="error")throw new Error(M.value.map(function(V){return V.key+": "+V.message}).join(", "));return M.value}var B=g;return typeof g=="string"&&A.type==="color"&&(B=pn.parse(g)),{kind:"constant",evaluate:function(){return B}}}(d===void 0?c.specification.default:d,c.specification)};ku.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ku.prototype.possiblyEvaluate=function(c,d,g){return this.property.possiblyEvaluate(this,c,d,g)};var zu=function(c){this.property=c,this.value=new ku(c,void 0)};zu.prototype.transitioned=function(c,d){return new Th(this.property,this.value,d,we({},c.transition,this.transition),c.now)},zu.prototype.untransitioned=function(){return new Th(this.property,this.value,null,{},0)};var cc=function(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)};cc.prototype.getValue=function(c){return Re(this._values[c].value.value)},cc.prototype.setValue=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new zu(this._values[c].property)),this._values[c].value=new ku(this._values[c].property,d===null?void 0:Re(d))},cc.prototype.getTransition=function(c){return Re(this._values[c].transition)},cc.prototype.setTransition=function(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new zu(this._values[c].property)),this._values[c].transition=Re(d)||void 0},cc.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var A=g[d],M=this.getValue(A);M!==void 0&&(c[A]=M);var B=this.getTransition(A);B!==void 0&&(c[A+"-transition"]=B)}return c},cc.prototype.transitioned=function(c,d){for(var g=new Ul(this._properties),A=0,M=Object.keys(this._values);A<M.length;A+=1){var B=M[A];g._values[B]=this._values[B].transitioned(c,d._values[B])}return g},cc.prototype.untransitioned=function(){for(var c=new Ul(this._properties),d=0,g=Object.keys(this._values);d<g.length;d+=1){var A=g[d];c._values[A]=this._values[A].untransitioned()}return c};var Th=function(c,d,g,A,M){this.property=c,this.value=d,this.begin=M+A.delay||0,this.end=this.begin+A.duration||0,c.specification.transition&&(A.delay||A.duration)&&(this.prior=g)};Th.prototype.possiblyEvaluate=function(c,d,g){var A=c.now||0,M=this.value.possiblyEvaluate(c,d,g),B=this.prior;if(B){if(A>this.end)return this.prior=null,M;if(this.value.isDataDriven())return this.prior=null,M;if(A<this.begin)return B.possiblyEvaluate(c,d,g);var V=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(B.possiblyEvaluate(c,d,g),M,function(Q){if(Q<=0)return 0;if(Q>=1)return 1;var me=Q*Q,Le=me*Q;return 4*(Q<.5?Le:3*(Q-me)+Le-.75)}(V))}return M};var Ul=function(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)};Ul.prototype.possiblyEvaluate=function(c,d,g){for(var A=new Tp(this._properties),M=0,B=Object.keys(this._values);M<B.length;M+=1){var V=B[M];A._values[V]=this._values[V].possiblyEvaluate(c,d,g)}return A},Ul.prototype.hasTransition=function(){for(var c=0,d=Object.keys(this._values);c<d.length;c+=1)if(this._values[d[c]].prior)return!0;return!1};var Fc=function(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)};Fc.prototype.getValue=function(c){return Re(this._values[c].value)},Fc.prototype.setValue=function(c,d){this._values[c]=new ku(this._values[c].property,d===null?void 0:Re(d))},Fc.prototype.serialize=function(){for(var c={},d=0,g=Object.keys(this._values);d<g.length;d+=1){var A=g[d],M=this.getValue(A);M!==void 0&&(c[A]=M)}return c},Fc.prototype.possiblyEvaluate=function(c,d,g){for(var A=new Tp(this._properties),M=0,B=Object.keys(this._values);M<B.length;M+=1){var V=B[M];A._values[V]=this._values[V].possiblyEvaluate(c,d,g)}return A};var Xc=function(c,d,g){this.property=c,this.value=d,this.parameters=g};Xc.prototype.isConstant=function(){return this.value.kind==="constant"},Xc.prototype.constantOr=function(c){return this.value.kind==="constant"?this.value.value:c},Xc.prototype.evaluate=function(c,d,g,A){return this.property.evaluate(this.value,this.parameters,c,d,g,A)};var Tp=function(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)};Tp.prototype.get=function(c){return this._values[c]};var jo=function(c){this.specification=c};jo.prototype.possiblyEvaluate=function(c,d){return c.expression.evaluate(d)},jo.prototype.interpolate=function(c,d,g){var A=Lu[this.specification.type];return A?A(c,d,g):c};var Eo=function(c,d){this.specification=c,this.overrides=d};Eo.prototype.possiblyEvaluate=function(c,d,g,A){return new Xc(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(d,null,{},g,A)}:c.expression,d)},Eo.prototype.interpolate=function(c,d,g){if(c.value.kind!=="constant"||d.value.kind!=="constant")return c;if(c.value.value===void 0||d.value.value===void 0)return new Xc(this,{kind:"constant",value:void 0},c.parameters);var A=Lu[this.specification.type];return A?new Xc(this,{kind:"constant",value:A(c.value.value,d.value.value,g)},c.parameters):c},Eo.prototype.evaluate=function(c,d,g,A,M,B){return c.kind==="constant"?c.value:c.evaluate(d,g,A,M,B)};var kc=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,A,M,B){if(g.value===void 0)return new Xc(this,{kind:"constant",value:void 0},A);if(g.expression.kind==="constant"){var V=g.expression.evaluate(A,null,{},M,B),Q=g.property.specification.type==="resolvedImage"&&typeof V!="string"?V.name:V,me=this._calculate(Q,Q,Q,A);return new Xc(this,{kind:"constant",value:me},A)}if(g.expression.kind==="camera"){var Le=this._calculate(g.expression.evaluate({zoom:A.zoom-1}),g.expression.evaluate({zoom:A.zoom}),g.expression.evaluate({zoom:A.zoom+1}),A);return new Xc(this,{kind:"constant",value:Le},A)}return new Xc(this,g.expression,A)},d.prototype.evaluate=function(g,A,M,B,V,Q){if(g.kind==="source"){var me=g.evaluate(A,M,B,V,Q);return this._calculate(me,me,me,A)}return g.kind==="composite"?this._calculate(g.evaluate({zoom:Math.floor(A.zoom)-1},M,B),g.evaluate({zoom:Math.floor(A.zoom)},M,B),g.evaluate({zoom:Math.floor(A.zoom)+1},M,B),A):g.value},d.prototype._calculate=function(g,A,M,B){return B.zoom>B.zoomHistory.lastIntegerZoom?{from:g,to:A}:{from:M,to:A}},d.prototype.interpolate=function(g){return g},d}(Eo),lu=function(c){this.specification=c};lu.prototype.possiblyEvaluate=function(c,d,g,A){if(c.value!==void 0){if(c.expression.kind==="constant"){var M=c.expression.evaluate(d,null,{},g,A);return this._calculate(M,M,M,d)}return this._calculate(c.expression.evaluate(new Ta(Math.floor(d.zoom-1),d)),c.expression.evaluate(new Ta(Math.floor(d.zoom),d)),c.expression.evaluate(new Ta(Math.floor(d.zoom+1),d)),d)}},lu.prototype._calculate=function(c,d,g,A){return A.zoom>A.zoomHistory.lastIntegerZoom?{from:c,to:d}:{from:g,to:d}},lu.prototype.interpolate=function(c){return c};var nh=function(c){this.specification=c};nh.prototype.possiblyEvaluate=function(c,d,g,A){return!!c.expression.evaluate(d,null,{},g,A)},nh.prototype.interpolate=function(){return!1};var dl=function(c){for(var d in this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],c){var g=c[d];g.specification.overridable&&this.overridableProperties.push(d);var A=this.defaultPropertyValues[d]=new ku(g,void 0),M=this.defaultTransitionablePropertyValues[d]=new zu(g);this.defaultTransitioningPropertyValues[d]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=A.possiblyEvaluate({})}};io("DataDrivenProperty",Eo),io("DataConstantProperty",jo),io("CrossFadedDataDrivenProperty",kc),io("CrossFadedProperty",lu),io("ColorRampProperty",nh);var bf=function(c){function d(g,A){if(c.call(this),this.id=g.id,this.type=g.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},g.type!=="custom"&&(this.metadata=(g=g).metadata,this.minzoom=g.minzoom,this.maxzoom=g.maxzoom,g.type!=="background"&&(this.source=g.source,this.sourceLayer=g["source-layer"],this.filter=g.filter),A.layout&&(this._unevaluatedLayout=new Fc(A.layout)),A.paint)){for(var M in this._transitionablePaint=new cc(A.paint),g.paint)this.setPaintProperty(M,g.paint[M],{validate:!1});for(var B in g.layout)this.setLayoutProperty(B,g.layout[B],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Tp(A.paint)}}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(g){return g==="visibility"?this.visibility:this._unevaluatedLayout.getValue(g)},d.prototype.setLayoutProperty=function(g,A,M){M===void 0&&(M={}),A!=null&&this._validate(ba,"layers."+this.id+".layout."+g,g,A,M)||(g!=="visibility"?this._unevaluatedLayout.setValue(g,A):this.visibility=A)},d.prototype.getPaintProperty=function(g){return pt(g,"-transition")?this._transitionablePaint.getTransition(g.slice(0,-11)):this._transitionablePaint.getValue(g)},d.prototype.setPaintProperty=function(g,A,M){if(M===void 0&&(M={}),A!=null&&this._validate(ma,"layers."+this.id+".paint."+g,g,A,M))return!1;if(pt(g,"-transition"))return this._transitionablePaint.setTransition(g.slice(0,-11),A||void 0),!1;var B=this._transitionablePaint._values[g],V=B.property.specification["property-type"]==="cross-faded-data-driven",Q=B.value.isDataDriven(),me=B.value;this._transitionablePaint.setValue(g,A),this._handleSpecialPaintPropertyUpdate(g);var Le=this._transitionablePaint._values[g].value;return Le.isDataDriven()||Q||V||this._handleOverridablePaintPropertyUpdate(g,me,Le)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){},d.prototype._handleOverridablePaintPropertyUpdate=function(g,A,M){return!1},d.prototype.isHidden=function(g){return!!(this.minzoom&&g<this.minzoom)||!!(this.maxzoom&&g>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(g){this._transitioningPaint=this._transitionablePaint.transitioned(g,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(g,A){g.getCrossfadeParameters&&(this._crossfadeParameters=g.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(g,void 0,A)),this.paint=this._transitioningPaint.possiblyEvaluate(g,void 0,A)},d.prototype.serialize=function(){var g={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(g.layout=g.layout||{},g.layout.visibility=this.visibility),ke(g,function(A,M){return!(A===void 0||M==="layout"&&!Object.keys(A).length||M==="paint"&&!Object.keys(A).length)})},d.prototype._validate=function(g,A,M,B,V){return V===void 0&&(V={}),(!V||V.validate!==!1)&&bs(this,g.call(mi,{key:A,layerType:this.type,objectKey:M,value:B,styleSpec:yt,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var g in this.paint._values){var A=this.paint.get(g);if(A instanceof Xc&&so(A.property.specification)&&(A.value.kind==="source"||A.value.kind==="composite")&&A.value.isStateDependent)return!0}return!1},d}(vn),wh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},kf=function(c,d){this._structArray=c,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},xs=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function uc(c,d){d===void 0&&(d=1);var g=0,A=0;return{members:c.map(function(M){var B=wh[M.type].BYTES_PER_ELEMENT,V=g=Xd(g,Math.max(d,B)),Q=M.components||1;return A=Math.max(A,B),g+=B*Q,{name:M.name,type:M.type,components:Q,offset:V}}),size:Xd(g,Math.max(A,d)),alignment:d}}function Xd(c,d){return Math.ceil(c/d)*d}xs.serialize=function(c,d){return c._trim(),d&&(c.isTransferred=!0,d.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}},xs.deserialize=function(c){var d=Object.create(this.prototype);return d.arrayBuffer=c.arrayBuffer,d.length=c.length,d.capacity=c.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},xs.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},xs.prototype.clear=function(){this.length=0},xs.prototype.resize=function(c){this.reserve(c),this.length=c},xs.prototype.reserve=function(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},xs.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Kh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A){var M=this.length;return this.resize(M+1),this.emplace(M,g,A)},d.prototype.emplace=function(g,A,M){var B=2*g;return this.int16[B+0]=A,this.int16[B+1]=M,g},d}(xs);Kh.prototype.bytesPerElement=4,io("StructArrayLayout2i4",Kh);var U0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B){var V=this.length;return this.resize(V+1),this.emplace(V,g,A,M,B)},d.prototype.emplace=function(g,A,M,B,V){var Q=4*g;return this.int16[Q+0]=A,this.int16[Q+1]=M,this.int16[Q+2]=B,this.int16[Q+3]=V,g},d}(xs);U0.prototype.bytesPerElement=8,io("StructArrayLayout4i8",U0);var Ah=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q){var me=this.length;return this.resize(me+1),this.emplace(me,g,A,M,B,V,Q)},d.prototype.emplace=function(g,A,M,B,V,Q,me){var Le=6*g;return this.int16[Le+0]=A,this.int16[Le+1]=M,this.int16[Le+2]=B,this.int16[Le+3]=V,this.int16[Le+4]=Q,this.int16[Le+5]=me,g},d}(xs);Ah.prototype.bytesPerElement=12,io("StructArrayLayout2i4i12",Ah);var Su=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q){var me=this.length;return this.resize(me+1),this.emplace(me,g,A,M,B,V,Q)},d.prototype.emplace=function(g,A,M,B,V,Q,me){var Le=4*g,We=8*g;return this.int16[Le+0]=A,this.int16[Le+1]=M,this.uint8[We+4]=B,this.uint8[We+5]=V,this.uint8[We+6]=Q,this.uint8[We+7]=me,g},d}(xs);Su.prototype.bytesPerElement=8,io("StructArrayLayout2i4ub8",Su);var Yd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A){var M=this.length;return this.resize(M+1),this.emplace(M,g,A)},d.prototype.emplace=function(g,A,M){var B=2*g;return this.float32[B+0]=A,this.float32[B+1]=M,g},d}(xs);Yd.prototype.bytesPerElement=8,io("StructArrayLayout2f8",Yd);var zf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q,me,Le,We,tt){var Et=this.length;return this.resize(Et+1),this.emplace(Et,g,A,M,B,V,Q,me,Le,We,tt)},d.prototype.emplace=function(g,A,M,B,V,Q,me,Le,We,tt,Et){var Nt=10*g;return this.uint16[Nt+0]=A,this.uint16[Nt+1]=M,this.uint16[Nt+2]=B,this.uint16[Nt+3]=V,this.uint16[Nt+4]=Q,this.uint16[Nt+5]=me,this.uint16[Nt+6]=Le,this.uint16[Nt+7]=We,this.uint16[Nt+8]=tt,this.uint16[Nt+9]=Et,g},d}(xs);zf.prototype.bytesPerElement=20,io("StructArrayLayout10ui20",zf);var wp=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q,me,Le,We,tt,Et,Nt){var tn=this.length;return this.resize(tn+1),this.emplace(tn,g,A,M,B,V,Q,me,Le,We,tt,Et,Nt)},d.prototype.emplace=function(g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn){var _n=12*g;return this.int16[_n+0]=A,this.int16[_n+1]=M,this.int16[_n+2]=B,this.int16[_n+3]=V,this.uint16[_n+4]=Q,this.uint16[_n+5]=me,this.uint16[_n+6]=Le,this.uint16[_n+7]=We,this.int16[_n+8]=tt,this.int16[_n+9]=Et,this.int16[_n+10]=Nt,this.int16[_n+11]=tn,g},d}(xs);wp.prototype.bytesPerElement=24,io("StructArrayLayout4i4ui4i24",wp);var Yr=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,M)},d.prototype.emplace=function(g,A,M,B){var V=3*g;return this.float32[V+0]=A,this.float32[V+1]=M,this.float32[V+2]=B,g},d}(xs);Yr.prototype.bytesPerElement=12,io("StructArrayLayout3f12",Yr);var Uf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var A=this.length;return this.resize(A+1),this.emplace(A,g)},d.prototype.emplace=function(g,A){return this.uint32[1*g+0]=A,g},d}(xs);Uf.prototype.bytesPerElement=4,io("StructArrayLayout1ul4",Uf);var jf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q,me,Le,We){var tt=this.length;return this.resize(tt+1),this.emplace(tt,g,A,M,B,V,Q,me,Le,We)},d.prototype.emplace=function(g,A,M,B,V,Q,me,Le,We,tt){var Et=10*g,Nt=5*g;return this.int16[Et+0]=A,this.int16[Et+1]=M,this.int16[Et+2]=B,this.int16[Et+3]=V,this.int16[Et+4]=Q,this.int16[Et+5]=me,this.uint32[Nt+3]=Le,this.uint16[Et+8]=We,this.uint16[Et+9]=tt,g},d}(xs);jf.prototype.bytesPerElement=20,io("StructArrayLayout6i1ul2ui20",jf);var qh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q){var me=this.length;return this.resize(me+1),this.emplace(me,g,A,M,B,V,Q)},d.prototype.emplace=function(g,A,M,B,V,Q,me){var Le=6*g;return this.int16[Le+0]=A,this.int16[Le+1]=M,this.int16[Le+2]=B,this.int16[Le+3]=V,this.int16[Le+4]=Q,this.int16[Le+5]=me,g},d}(xs);qh.prototype.bytesPerElement=12,io("StructArrayLayout2i2i2i12",qh);var xf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V){var Q=this.length;return this.resize(Q+1),this.emplace(Q,g,A,M,B,V)},d.prototype.emplace=function(g,A,M,B,V,Q){var me=4*g,Le=8*g;return this.float32[me+0]=A,this.float32[me+1]=M,this.float32[me+2]=B,this.int16[Le+6]=V,this.int16[Le+7]=Q,g},d}(xs);xf.prototype.bytesPerElement=16,io("StructArrayLayout2f1f2i16",xf);var Ap=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B){var V=this.length;return this.resize(V+1),this.emplace(V,g,A,M,B)},d.prototype.emplace=function(g,A,M,B,V){var Q=12*g,me=3*g;return this.uint8[Q+0]=A,this.uint8[Q+1]=M,this.float32[me+1]=B,this.float32[me+2]=V,g},d}(xs);Ap.prototype.bytesPerElement=12,io("StructArrayLayout2ub2f12",Ap);var sf=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,M)},d.prototype.emplace=function(g,A,M,B){var V=3*g;return this.uint16[V+0]=A,this.uint16[V+1]=M,this.uint16[V+2]=B,g},d}(xs);sf.prototype.bytesPerElement=6,io("StructArrayLayout3ui6",sf);var Ef=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n,zn,Dn,cr){var _r=this.length;return this.resize(_r+1),this.emplace(_r,g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n,zn,Dn,cr)},d.prototype.emplace=function(g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n,zn,Dn,cr,_r){var Ir=24*g,Br=12*g,jr=48*g;return this.int16[Ir+0]=A,this.int16[Ir+1]=M,this.uint16[Ir+2]=B,this.uint16[Ir+3]=V,this.uint32[Br+2]=Q,this.uint32[Br+3]=me,this.uint32[Br+4]=Le,this.uint16[Ir+10]=We,this.uint16[Ir+11]=tt,this.uint16[Ir+12]=Et,this.float32[Br+7]=Nt,this.float32[Br+8]=tn,this.uint8[jr+36]=_n,this.uint8[jr+37]=zn,this.uint8[jr+38]=Dn,this.uint32[Br+10]=cr,this.int16[Ir+22]=_r,g},d}(xs);Ef.prototype.bytesPerElement=48,io("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ef);var o0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n,zn,Dn,cr,_r,Ir,Br,jr,bi,Zi,Ro,ki,zo,ao,xa){var Mo=this.length;return this.resize(Mo+1),this.emplace(Mo,g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n,zn,Dn,cr,_r,Ir,Br,jr,bi,Zi,Ro,ki,zo,ao,xa)},d.prototype.emplace=function(g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n,zn,Dn,cr,_r,Ir,Br,jr,bi,Zi,Ro,ki,zo,ao,xa,Mo){var _o=34*g,Za=17*g;return this.int16[_o+0]=A,this.int16[_o+1]=M,this.int16[_o+2]=B,this.int16[_o+3]=V,this.int16[_o+4]=Q,this.int16[_o+5]=me,this.int16[_o+6]=Le,this.int16[_o+7]=We,this.uint16[_o+8]=tt,this.uint16[_o+9]=Et,this.uint16[_o+10]=Nt,this.uint16[_o+11]=tn,this.uint16[_o+12]=_n,this.uint16[_o+13]=zn,this.uint16[_o+14]=Dn,this.uint16[_o+15]=cr,this.uint16[_o+16]=_r,this.uint16[_o+17]=Ir,this.uint16[_o+18]=Br,this.uint16[_o+19]=jr,this.uint16[_o+20]=bi,this.uint16[_o+21]=Zi,this.uint16[_o+22]=Ro,this.uint32[Za+12]=ki,this.float32[Za+13]=zo,this.float32[Za+14]=ao,this.float32[Za+15]=xa,this.float32[Za+16]=Mo,g},d}(xs);o0.prototype.bytesPerElement=68,io("StructArrayLayout8i15ui1ul4f68",o0);var rh=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var A=this.length;return this.resize(A+1),this.emplace(A,g)},d.prototype.emplace=function(g,A){return this.float32[1*g+0]=A,g},d}(xs);rh.prototype.bytesPerElement=4,io("StructArrayLayout1f4",rh);var Yc=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,M)},d.prototype.emplace=function(g,A,M,B){var V=3*g;return this.int16[V+0]=A,this.int16[V+1]=M,this.int16[V+2]=B,g},d}(xs);Yc.prototype.bytesPerElement=6,io("StructArrayLayout3i6",Yc);var $c=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M){var B=this.length;return this.resize(B+1),this.emplace(B,g,A,M)},d.prototype.emplace=function(g,A,M,B){var V=4*g;return this.uint32[2*g+0]=A,this.uint16[V+2]=M,this.uint16[V+3]=B,g},d}(xs);$c.prototype.bytesPerElement=8,io("StructArrayLayout1ul2ui8",$c);var Ds=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A){var M=this.length;return this.resize(M+1),this.emplace(M,g,A)},d.prototype.emplace=function(g,A,M){var B=2*g;return this.uint16[B+0]=A,this.uint16[B+1]=M,g},d}(xs);Ds.prototype.bytesPerElement=4,io("StructArrayLayout2ui4",Ds);var Tu=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g){var A=this.length;return this.resize(A+1),this.emplace(A,g)},d.prototype.emplace=function(g,A){return this.uint16[1*g+0]=A,g},d}(xs);Tu.prototype.bytesPerElement=2,io("StructArrayLayout1ui2",Tu);var j0=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(g,A,M,B){var V=this.length;return this.resize(V+1),this.emplace(V,g,A,M,B)},d.prototype.emplace=function(g,A,M,B,V){var Q=4*g;return this.float32[Q+0]=A,this.float32[Q+1]=M,this.float32[Q+2]=B,this.float32[Q+3]=V,g},d}(xs);j0.prototype.bytesPerElement=16,io("StructArrayLayout4f16",j0);var _=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return g.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},g.x1.get=function(){return this._structArray.int16[this._pos2+2]},g.y1.get=function(){return this._structArray.int16[this._pos2+3]},g.x2.get=function(){return this._structArray.int16[this._pos2+4]},g.y2.get=function(){return this._structArray.int16[this._pos2+5]},g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.anchorPoint.get=function(){return new se(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,g),d}(kf);_.prototype.size=20;var S=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new _(this,g)},d}(jf);io("CollisionBoxArray",S);var x=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},g.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},g.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},g.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},g.segment.get=function(){return this._structArray.uint16[this._pos2+10]},g.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},g.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},g.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},g.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},g.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},g.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},g.placedOrientation.set=function(A){this._structArray.uint8[this._pos1+37]=A},g.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},g.hidden.set=function(A){this._structArray.uint8[this._pos1+38]=A},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},g.crossTileID.set=function(A){this._structArray.uint32[this._pos4+10]=A},g.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,g),d}(kf);x.prototype.size=48;var C=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new x(this,g)},d}(Ef);io("PlacedSymbolArray",C);var k=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return g.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},g.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},g.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},g.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},g.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},g.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},g.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},g.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},g.key.get=function(){return this._structArray.uint16[this._pos2+8]},g.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},g.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},g.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},g.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},g.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},g.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},g.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},g.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},g.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},g.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},g.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},g.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},g.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},g.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},g.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},g.crossTileID.set=function(A){this._structArray.uint32[this._pos4+12]=A},g.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},g.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},g.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},g.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,g),d}(kf);k.prototype.size=68;var G=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new k(this,g)},d}(o0);io("SymbolInstanceArray",G);var q=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getoffsetX=function(g){return this.float32[1*g+0]},d}(rh);io("GlyphOffsetArray",q);var de=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.getx=function(g){return this.int16[3*g+0]},d.prototype.gety=function(g){return this.int16[3*g+1]},d.prototype.gettileUnitDistanceFromAnchor=function(g){return this.int16[3*g+2]},d}(Yc);io("SymbolLineVertexArray",de);var ze=function(c){function d(){c.apply(this,arguments)}c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d;var g={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return g.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},g.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},g.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,g),d}(kf);ze.prototype.size=8;var it=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.get=function(g){return new ze(this,g)},d}($c);io("FeatureIndexArray",it);var Bt=uc([{name:"a_pos",components:2,type:"Int16"}],4).members,St=function(c){c===void 0&&(c=[]),this.segments=c};function Xt(c,d){return 256*(c=Be(Math.floor(c),0,255))+Be(Math.floor(d),0,255)}St.prototype.prepareSegment=function(c,d,g,A){var M=this.segments[this.segments.length-1];return c>St.MAX_VERTEX_ARRAY_LENGTH&&gt("Max vertices per segment is "+St.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+c),(!M||M.vertexLength+c>St.MAX_VERTEX_ARRAY_LENGTH||M.sortKey!==A)&&(M={vertexOffset:d.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},A!==void 0&&(M.sortKey=A),this.segments.push(M)),M},St.prototype.get=function(){return this.segments},St.prototype.destroy=function(){for(var c=0,d=this.segments;c<d.length;c+=1){var g=d[c];for(var A in g.vaos)g.vaos[A].destroy()}},St.simpleSegment=function(c,d,g,A){return new St([{vertexOffset:c,primitiveOffset:d,vertexLength:g,primitiveLength:A,vaos:{},sortKey:0}])},St.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,io("SegmentVector",St);var En=uc([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),yn=_e(function(c){c.exports=function(d,g){var A,M,B,V,Q,me,Le,We;for(M=d.length-(A=3&d.length),B=g,Q=3432918353,me=461845907,We=0;We<M;)Le=255&d.charCodeAt(We)|(255&d.charCodeAt(++We))<<8|(255&d.charCodeAt(++We))<<16|(255&d.charCodeAt(++We))<<24,++We,B=27492+(65535&(V=5*(65535&(B=(B^=Le=(65535&(Le=(Le=(65535&Le)*Q+(((Le>>>16)*Q&65535)<<16)&4294967295)<<15|Le>>>17))*me+(((Le>>>16)*me&65535)<<16)&4294967295)<<13|B>>>19))+((5*(B>>>16)&65535)<<16)&4294967295))+((58964+(V>>>16)&65535)<<16);switch(Le=0,A){case 3:Le^=(255&d.charCodeAt(We+2))<<16;case 2:Le^=(255&d.charCodeAt(We+1))<<8;case 1:B^=Le=(65535&(Le=(Le=(65535&(Le^=255&d.charCodeAt(We)))*Q+(((Le>>>16)*Q&65535)<<16)&4294967295)<<15|Le>>>17))*me+(((Le>>>16)*me&65535)<<16)&4294967295}return B^=d.length,B=2246822507*(65535&(B^=B>>>16))+((2246822507*(B>>>16)&65535)<<16)&4294967295,B=3266489909*(65535&(B^=B>>>13))+((3266489909*(B>>>16)&65535)<<16)&4294967295,(B^=B>>>16)>>>0}}),Un=_e(function(c){c.exports=function(d,g){for(var A,M=d.length,B=g^M,V=0;M>=4;)A=1540483477*(65535&(A=255&d.charCodeAt(V)|(255&d.charCodeAt(++V))<<8|(255&d.charCodeAt(++V))<<16|(255&d.charCodeAt(++V))<<24))+((1540483477*(A>>>16)&65535)<<16),B=1540483477*(65535&B)+((1540483477*(B>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),M-=4,++V;switch(M){case 3:B^=(255&d.charCodeAt(V+2))<<16;case 2:B^=(255&d.charCodeAt(V+1))<<8;case 1:B=1540483477*(65535&(B^=255&d.charCodeAt(V)))+((1540483477*(B>>>16)&65535)<<16)}return B=1540483477*(65535&(B^=B>>>13))+((1540483477*(B>>>16)&65535)<<16),(B^=B>>>15)>>>0}}),cn=yn,Rn=Un;cn.murmur3=yn,cn.murmur2=Rn;var Jn=function(){this.ids=[],this.positions=[],this.indexed=!1};Jn.prototype.add=function(c,d,g,A){this.ids.push(Lr(c)),this.positions.push(d,g,A)},Jn.prototype.getPositions=function(c){for(var d=Lr(c),g=0,A=this.ids.length-1;g<A;){var M=g+A>>1;this.ids[M]>=d?A=M:g=M+1}for(var B=[];this.ids[g]===d;)B.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return B},Jn.serialize=function(c,d){var g=new Float64Array(c.ids),A=new Uint32Array(c.positions);return function M(B,V,Q,me){for(;Q<me;){for(var Le=B[Q+me>>1],We=Q-1,tt=me+1;;){do We++;while(B[We]<Le);do tt--;while(B[tt]>Le);if(We>=tt)break;gr(B,We,tt),gr(V,3*We,3*tt),gr(V,3*We+1,3*tt+1),gr(V,3*We+2,3*tt+2)}tt-Q<me-tt?(M(B,V,Q,tt),Q=tt+1):(M(B,V,tt+1,me),me=tt)}}(g,A,0,g.length-1),d&&d.push(g.buffer,A.buffer),{ids:g,positions:A}},Jn.deserialize=function(c){var d=new Jn;return d.ids=c.ids,d.positions=c.positions,d.indexed=!0,d};var hr=Math.pow(2,53)-1;function Lr(c){var d=+c;return!isNaN(d)&&d<=hr?d:cn(String(c))}function gr(c,d,g){var A=c[d];c[d]=c[g],c[g]=A}io("FeaturePositionMap",Jn);var Dr=function(c,d){this.gl=c.gl,this.location=d},Fr=function(c){function d(g,A){c.call(this,g,A),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1i(this.location,g))},d}(Dr),Mi=function(c){function d(g,A){c.call(this,g,A),this.current=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){this.current!==g&&(this.current=g,this.gl.uniform1f(this.location,g))},d}(Dr),Pi=function(c){function d(g,A){c.call(this,g,A),this.current=[0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]||(this.current=g,this.gl.uniform2f(this.location,g[0],g[1]))},d}(Dr),vi=function(c){function d(g,A){c.call(this,g,A),this.current=[0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]||(this.current=g,this.gl.uniform3f(this.location,g[0],g[1],g[2]))},d}(Dr),Oo=function(c){function d(g,A){c.call(this,g,A),this.current=[0,0,0,0]}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]&&g[3]===this.current[3]||(this.current=g,this.gl.uniform4f(this.location,g[0],g[1],g[2],g[3]))},d}(Dr),yo=function(c){function d(g,A){c.call(this,g,A),this.current=pn.transparent}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){g.r===this.current.r&&g.g===this.current.g&&g.b===this.current.b&&g.a===this.current.a||(this.current=g,this.gl.uniform4f(this.location,g.r,g.g,g.b,g.a))},d}(Dr),Ho=new Float32Array(16),is=function(c){function d(g,A){c.call(this,g,A),this.current=Ho}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.set=function(g){if(g[12]!==this.current[12]||g[0]!==this.current[0])return this.current=g,void this.gl.uniformMatrix4fv(this.location,!1,g);for(var A=1;A<16;A++)if(g[A]!==this.current[A]){this.current=g,this.gl.uniformMatrix4fv(this.location,!1,g);break}},d}(Dr);function Cr(c){return[Xt(255*c.r,255*c.g),Xt(255*c.b,255*c.a)]}var Kt=function(c,d,g){this.value=c,this.uniformNames=d.map(function(A){return"u_"+A}),this.type=g};Kt.prototype.setUniform=function(c,d,g){c.set(g.constantOr(this.value))},Kt.prototype.getBinding=function(c,d,g){return this.type==="color"?new yo(c,d):new Mi(c,d)};var Zr=function(c,d){this.uniformNames=d.map(function(g){return"u_"+g}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Zr.prototype.setConstantPatternPositions=function(c,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=c.tlbr},Zr.prototype.setUniform=function(c,d,g,A){var M=A==="u_pattern_to"?this.patternTo:A==="u_pattern_from"?this.patternFrom:A==="u_pixel_ratio_to"?this.pixelRatioTo:A==="u_pixel_ratio_from"?this.pixelRatioFrom:null;M&&c.set(M)},Zr.prototype.getBinding=function(c,d,g){return g.substr(0,9)==="u_pattern"?new Oo(c,d):new Mi(c,d)};var ko=function(c,d,g,A){this.expression=c,this.type=g,this.maxValue=0,this.paintVertexAttributes=d.map(function(M){return{name:"a_"+M,type:"Float32",components:g==="color"?2:1,offset:0}}),this.paintVertexArray=new A};ko.prototype.populatePaintArray=function(c,d,g,A,M){var B=this.paintVertexArray.length,V=this.expression.evaluate(new Ta(0),d,{},A,[],M);this.paintVertexArray.resize(c),this._setPaintValue(B,c,V)},ko.prototype.updatePaintArray=function(c,d,g,A){var M=this.expression.evaluate({zoom:0},g,A);this._setPaintValue(c,d,M)},ko.prototype._setPaintValue=function(c,d,g){if(this.type==="color")for(var A=Cr(g),M=c;M<d;M++)this.paintVertexArray.emplace(M,A[0],A[1]);else{for(var B=c;B<d;B++)this.paintVertexArray.emplace(B,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}},ko.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ko.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var qo=function(c,d,g,A,M,B){this.expression=c,this.uniformNames=d.map(function(V){return"u_"+V+"_t"}),this.type=g,this.useIntegerZoom=A,this.zoom=M,this.maxValue=0,this.paintVertexAttributes=d.map(function(V){return{name:"a_"+V,type:"Float32",components:g==="color"?4:2,offset:0}}),this.paintVertexArray=new B};qo.prototype.populatePaintArray=function(c,d,g,A,M){var B=this.expression.evaluate(new Ta(this.zoom),d,{},A,[],M),V=this.expression.evaluate(new Ta(this.zoom+1),d,{},A,[],M),Q=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(Q,c,B,V)},qo.prototype.updatePaintArray=function(c,d,g,A){var M=this.expression.evaluate({zoom:this.zoom},g,A),B=this.expression.evaluate({zoom:this.zoom+1},g,A);this._setPaintValue(c,d,M,B)},qo.prototype._setPaintValue=function(c,d,g,A){if(this.type==="color")for(var M=Cr(g),B=Cr(A),V=c;V<d;V++)this.paintVertexArray.emplace(V,M[0],M[1],B[0],B[1]);else{for(var Q=c;Q<d;Q++)this.paintVertexArray.emplace(Q,g,A);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(A))}},qo.prototype.upload=function(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},qo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},qo.prototype.setUniform=function(c,d){var g=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,A=Be(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);c.set(A)},qo.prototype.getBinding=function(c,d,g){return new Mi(c,d)};var va=function(c,d,g,A,M,B){this.expression=c,this.type=d,this.useIntegerZoom=g,this.zoom=A,this.layerId=B,this.zoomInPaintVertexArray=new M,this.zoomOutPaintVertexArray=new M};va.prototype.populatePaintArray=function(c,d,g){var A=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(A,c,d.patterns&&d.patterns[this.layerId],g)},va.prototype.updatePaintArray=function(c,d,g,A,M){this._setPaintValues(c,d,g.patterns&&g.patterns[this.layerId],M)},va.prototype._setPaintValues=function(c,d,g,A){if(A&&g){var M=A[g.min],B=A[g.mid],V=A[g.max];if(M&&B&&V)for(var Q=c;Q<d;Q++)this.zoomInPaintVertexArray.emplace(Q,B.tl[0],B.tl[1],B.br[0],B.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],B.pixelRatio,M.pixelRatio),this.zoomOutPaintVertexArray.emplace(Q,B.tl[0],B.tl[1],B.br[0],B.br[1],V.tl[0],V.tl[1],V.br[0],V.br[1],B.pixelRatio,V.pixelRatio)}},va.prototype.upload=function(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,En.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,En.members,this.expression.isStateDependent))},va.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var na=function(c,d,g){this.binders={},this._buffers=[];var A=[];for(var M in c.paint._values)if(g(M)){var B=c.paint.get(M);if(B instanceof Xc&&so(B.property.specification)){var V=sl(M,c.type),Q=B.value,me=B.property.specification.type,Le=B.property.useIntegerZoom,We=B.property.specification["property-type"],tt=We==="cross-faded"||We==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[M]=tt?new Zr(Q.value,V):new Kt(Q.value,V,me),A.push("/u_"+M);else if(Q.kind==="source"||tt){var Et=bl(M,me,"source");this.binders[M]=tt?new va(Q,me,Le,d,Et,c.id):new ko(Q,V,me,Et),A.push("/a_"+M)}else{var Nt=bl(M,me,"composite");this.binders[M]=new qo(Q,V,me,Le,d,Nt),A.push("/z_"+M)}}}this.cacheKey=A.sort().join("")};na.prototype.getMaxValue=function(c){var d=this.binders[c];return d instanceof ko||d instanceof qo?d.maxValue:0},na.prototype.populatePaintArrays=function(c,d,g,A,M){for(var B in this.binders){var V=this.binders[B];(V instanceof ko||V instanceof qo||V instanceof va)&&V.populatePaintArray(c,d,g,A,M)}},na.prototype.setConstantPatternPositions=function(c,d){for(var g in this.binders){var A=this.binders[g];A instanceof Zr&&A.setConstantPatternPositions(c,d)}},na.prototype.updatePaintArrays=function(c,d,g,A,M){var B=!1;for(var V in c)for(var Q=0,me=d.getPositions(V);Q<me.length;Q+=1){var Le=me[Q],We=g.feature(Le.index);for(var tt in this.binders){var Et=this.binders[tt];if((Et instanceof ko||Et instanceof qo||Et instanceof va)&&Et.expression.isStateDependent===!0){var Nt=A.paint.get(tt);Et.expression=Nt.value,Et.updatePaintArray(Le.start,Le.end,We,c[V],M),B=!0}}}return B},na.prototype.defines=function(){var c=[];for(var d in this.binders){var g=this.binders[d];(g instanceof Kt||g instanceof Zr)&&c.push.apply(c,g.uniformNames.map(function(A){return"#define HAS_UNIFORM_"+A}))}return c},na.prototype.getBinderAttributes=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof ko||g instanceof qo)for(var A=0;A<g.paintVertexAttributes.length;A++)c.push(g.paintVertexAttributes[A].name);else if(g instanceof va)for(var M=0;M<En.members.length;M++)c.push(En.members[M].name)}return c},na.prototype.getBinderUniforms=function(){var c=[];for(var d in this.binders){var g=this.binders[d];if(g instanceof Kt||g instanceof Zr||g instanceof qo)for(var A=0,M=g.uniformNames;A<M.length;A+=1)c.push(M[A])}return c},na.prototype.getPaintVertexBuffers=function(){return this._buffers},na.prototype.getUniforms=function(c,d){var g=[];for(var A in this.binders){var M=this.binders[A];if(M instanceof Kt||M instanceof Zr||M instanceof qo)for(var B=0,V=M.uniformNames;B<V.length;B+=1){var Q=V[B];if(d[Q]){var me=M.getBinding(c,d[Q],Q);g.push({name:Q,property:A,binding:me})}}}return g},na.prototype.setUniforms=function(c,d,g,A){for(var M=0,B=d;M<B.length;M+=1){var V=B[M],Q=V.name,me=V.property;this.binders[me].setUniform(V.binding,A,g.get(me),Q)}},na.prototype.updatePaintBuffers=function(c){for(var d in this._buffers=[],this.binders){var g=this.binders[d];if(c&&g instanceof va){var A=c.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;A&&this._buffers.push(A)}else(g instanceof ko||g instanceof qo)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}},na.prototype.upload=function(c){for(var d in this.binders){var g=this.binders[d];(g instanceof ko||g instanceof qo||g instanceof va)&&g.upload(c)}this.updatePaintBuffers()},na.prototype.destroy=function(){for(var c in this.binders){var d=this.binders[c];(d instanceof ko||d instanceof qo||d instanceof va)&&d.destroy()}};var Vo=function(c,d,g){g===void 0&&(g=function(){return!0}),this.programConfigurations={};for(var A=0,M=c;A<M.length;A+=1){var B=M[A];this.programConfigurations[B.id]=new na(B,d,g)}this.needsUpload=!1,this._featureMap=new Jn,this._bufferOffset=0};function sl(c,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(d+"-","").replace(/-/g,"_")]}function bl(c,d,g){var A={color:{source:Yd,composite:j0},number:{source:rh,composite:Yd}},M=function(B){return{"line-pattern":{source:zf,composite:zf},"fill-pattern":{source:zf,composite:zf},"fill-extrusion-pattern":{source:zf,composite:zf}}[B]}(c);return M&&M[g]||A[d][g]}Vo.prototype.populatePaintArrays=function(c,d,g,A,M,B){for(var V in this.programConfigurations)this.programConfigurations[V].populatePaintArrays(c,d,A,M,B);d.id!==void 0&&this._featureMap.add(d.id,g,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0},Vo.prototype.updatePaintArrays=function(c,d,g,A){for(var M=0,B=g;M<B.length;M+=1){var V=B[M];this.needsUpload=this.programConfigurations[V.id].updatePaintArrays(c,this._featureMap,d,V,A)||this.needsUpload}},Vo.prototype.get=function(c){return this.programConfigurations[c]},Vo.prototype.upload=function(c){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(c);this.needsUpload=!1}},Vo.prototype.destroy=function(){for(var c in this.programConfigurations)this.programConfigurations[c].destroy()},io("ConstantBinder",Kt),io("CrossFadedConstantBinder",Zr),io("SourceExpressionBinder",ko),io("CrossFadedCompositeBinder",va),io("CompositeExpressionBinder",qo),io("ProgramConfiguration",na,{omit:["_buffers"]}),io("ProgramConfigurationSet",Vo);var zc=Math.pow(2,14)-1,ic=-zc-1;function Rs(c){for(var d=8192/c.extent,g=c.loadGeometry(),A=0;A<g.length;A++)for(var M=g[A],B=0;B<M.length;B++){var V=M[B],Q=Math.round(V.x*d),me=Math.round(V.y*d);V.x=Be(Q,ic,zc),V.y=Be(me,ic,zc),(Q<V.x||Q>V.x+1||me<V.y||me>V.y+1)&&gt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return g}function ll(c,d){return{type:c.type,id:c.id,properties:c.properties,geometry:d?Rs(c):[]}}function Qs(c,d,g,A,M){c.emplaceBack(2*d+(A+1)/2,2*g+(M+1)/2)}var Tc=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Kh,this.indexArray=new sf,this.segments=new St,this.programConfigurations=new Vo(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function Ch(c,d){for(var g=0;g<c.length;g++)if(Rh(d,c[g]))return!0;for(var A=0;A<d.length;A++)if(Rh(c,d[A]))return!0;return!!$d(c,d)}function Il(c,d,g){return!!Rh(c,d)||!!Oh(d,c,g)}function cu(c,d){if(c.length===1)return Qh(d,c[0]);for(var g=0;g<d.length;g++)for(var A=d[g],M=0;M<A.length;M++)if(Rh(c,A[M]))return!0;for(var B=0;B<c.length;B++)if(Qh(d,c[B]))return!0;for(var V=0;V<d.length;V++)if($d(c,d[V]))return!0;return!1}function pl(c,d,g){if(c.length>1){if($d(c,d))return!0;for(var A=0;A<d.length;A++)if(Oh(d[A],c,g))return!0}for(var M=0;M<c.length;M++)if(Oh(c[M],d,g))return!0;return!1}function $d(c,d){if(c.length===0||d.length===0)return!1;for(var g=0;g<c.length-1;g++)for(var A=c[g],M=c[g+1],B=0;B<d.length-1;B++)if(Td(A,M,d[B],d[B+1]))return!0;return!1}function Td(c,d,g,A){return Ct(c,g,A)!==Ct(d,g,A)&&Ct(c,d,g)!==Ct(c,d,A)}function Oh(c,d,g){var A=g*g;if(d.length===1)return c.distSqr(d[0])<A;for(var M=1;M<d.length;M++)if(Sf(c,d[M-1],d[M])<A)return!0;return!1}function Sf(c,d,g){var A=d.distSqr(g);if(A===0)return c.distSqr(d);var M=((c.x-d.x)*(g.x-d.x)+(c.y-d.y)*(g.y-d.y))/A;return c.distSqr(M<0?d:M>1?g:g.sub(d)._mult(M)._add(d))}function Qh(c,d){for(var g,A,M,B=!1,V=0;V<c.length;V++)for(var Q=0,me=(g=c[V]).length-1;Q<g.length;me=Q++)(A=g[Q]).y>d.y!=(M=g[me]).y>d.y&&d.x<(M.x-A.x)*(d.y-A.y)/(M.y-A.y)+A.x&&(B=!B);return B}function Rh(c,d){for(var g=!1,A=0,M=c.length-1;A<c.length;M=A++){var B=c[A],V=c[M];B.y>d.y!=V.y>d.y&&d.x<(V.x-B.x)*(d.y-B.y)/(V.y-B.y)+B.x&&(g=!g)}return g}function Ti(c,d,g){var A=g[0],M=g[2];if(c.x<A.x&&d.x<A.x||c.x>M.x&&d.x>M.x||c.y<A.y&&d.y<A.y||c.y>M.y&&d.y>M.y)return!1;var B=Ct(c,d,g[0]);return B!==Ct(c,d,g[1])||B!==Ct(c,d,g[2])||B!==Ct(c,d,g[3])}function ml(c,d,g){var A=d.paint.get(c).value;return A.kind==="constant"?A.value:g.programConfigurations.get(d.id).getMaxValue(c)}function Ll(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Kc(c,d,g,A,M){if(!d[0]&&!d[1])return c;var B=se.convert(d)._mult(M);g==="viewport"&&B._rotate(-A);for(var V=[],Q=0;Q<c.length;Q++)V.push(c[Q].sub(B));return V}Tc.prototype.populate=function(c,d,g){var A=this.layers[0],M=[],B=null;A.type==="circle"&&(B=A.layout.get("circle-sort-key"));for(var V=0,Q=c;V<Q.length;V+=1){var me=Q[V],Le=me.feature,We=me.id,tt=me.index,Et=me.sourceLayerIndex,Nt=this.layers[0]._featureFilter.needGeometry,tn=ll(Le,Nt);if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),tn,g)){var _n=B?B.evaluate(tn,{},g):void 0,zn={id:We,properties:Le.properties,type:Le.type,sourceLayerIndex:Et,index:tt,geometry:Nt?tn.geometry:Rs(Le),patterns:{},sortKey:_n};M.push(zn)}}B&&M.sort(function(Zi,Ro){return Zi.sortKey-Ro.sortKey});for(var Dn=0,cr=M;Dn<cr.length;Dn+=1){var _r=cr[Dn],Ir=_r.geometry,Br=_r.index,jr=_r.sourceLayerIndex,bi=c[Br].feature;this.addFeature(_r,Ir,Br,g),d.featureIndex.insert(bi,Ir,Br,jr,this.index)}},Tc.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Tc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Tc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Tc.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Bt),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},Tc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Tc.prototype.addFeature=function(c,d,g,A){for(var M=0,B=d;M<B.length;M+=1)for(var V=0,Q=B[M];V<Q.length;V+=1){var me=Q[V],Le=me.x,We=me.y;if(!(Le<0||Le>=8192||We<0||We>=8192)){var tt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),Et=tt.vertexLength;Qs(this.layoutVertexArray,Le,We,-1,-1),Qs(this.layoutVertexArray,Le,We,1,-1),Qs(this.layoutVertexArray,Le,We,1,1),Qs(this.layoutVertexArray,Le,We,-1,1),this.indexArray.emplaceBack(Et,Et+1,Et+2),this.indexArray.emplaceBack(Et,Et+3,Et+2),tt.vertexLength+=4,tt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,{},A)},io("CircleBucket",Tc,{omit:["layers"]});var os=new dl({"circle-sort-key":new Eo(yt.layout_circle["circle-sort-key"])}),Ns={paint:new dl({"circle-radius":new Eo(yt.paint_circle["circle-radius"]),"circle-color":new Eo(yt.paint_circle["circle-color"]),"circle-blur":new Eo(yt.paint_circle["circle-blur"]),"circle-opacity":new Eo(yt.paint_circle["circle-opacity"]),"circle-translate":new jo(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new jo(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jo(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jo(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Eo(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Eo(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Eo(yt.paint_circle["circle-stroke-opacity"])}),layout:os},ga=typeof Float32Array!="undefined"?Float32Array:Array;function xl(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Ba(c,d,g){var A=d[0],M=d[1],B=d[2],V=d[3],Q=d[4],me=d[5],Le=d[6],We=d[7],tt=d[8],Et=d[9],Nt=d[10],tn=d[11],_n=d[12],zn=d[13],Dn=d[14],cr=d[15],_r=g[0],Ir=g[1],Br=g[2],jr=g[3];return c[0]=_r*A+Ir*Q+Br*tt+jr*_n,c[1]=_r*M+Ir*me+Br*Et+jr*zn,c[2]=_r*B+Ir*Le+Br*Nt+jr*Dn,c[3]=_r*V+Ir*We+Br*tn+jr*cr,c[4]=(_r=g[4])*A+(Ir=g[5])*Q+(Br=g[6])*tt+(jr=g[7])*_n,c[5]=_r*M+Ir*me+Br*Et+jr*zn,c[6]=_r*B+Ir*Le+Br*Nt+jr*Dn,c[7]=_r*V+Ir*We+Br*tn+jr*cr,c[8]=(_r=g[8])*A+(Ir=g[9])*Q+(Br=g[10])*tt+(jr=g[11])*_n,c[9]=_r*M+Ir*me+Br*Et+jr*zn,c[10]=_r*B+Ir*Le+Br*Nt+jr*Dn,c[11]=_r*V+Ir*We+Br*tn+jr*cr,c[12]=(_r=g[12])*A+(Ir=g[13])*Q+(Br=g[14])*tt+(jr=g[15])*_n,c[13]=_r*M+Ir*me+Br*Et+jr*zn,c[14]=_r*B+Ir*Le+Br*Nt+jr*Dn,c[15]=_r*V+Ir*We+Br*tn+jr*cr,c}Math.hypot||(Math.hypot=function(){for(var c=arguments,d=0,g=arguments.length;g--;)d+=c[g]*c[g];return Math.sqrt(d)});var ih,a0=Ba;function Tf(c,d,g){var A=d[0],M=d[1],B=d[2],V=d[3];return c[0]=g[0]*A+g[4]*M+g[8]*B+g[12]*V,c[1]=g[1]*A+g[5]*M+g[9]*B+g[13]*V,c[2]=g[2]*A+g[6]*M+g[10]*B+g[14]*V,c[3]=g[3]*A+g[7]*M+g[11]*B+g[15]*V,c}ih=new ga(3),ga!=Float32Array&&(ih[0]=0,ih[1]=0,ih[2]=0),function(){var c=new ga(4);ga!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0)}();var Kd=(function(){var c=new ga(2);ga!=Float32Array&&(c[0]=0,c[1]=0)}(),function(c){function d(g){c.call(this,g,Ns)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new Tc(g)},d.prototype.queryRadius=function(g){var A=g;return ml("circle-radius",this,A)+ml("circle-stroke-width",this,A)+Ll(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(g,A,M,B,V,Q,me,Le){for(var We=Kc(g,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,me),tt=this.paint.get("circle-radius").evaluate(A,M)+this.paint.get("circle-stroke-width").evaluate(A,M),Et=this.paint.get("circle-pitch-alignment")==="map",Nt=Et?We:function(bi,Zi){return bi.map(function(Ro){return oh(Ro,Zi)})}(We,Le),tn=Et?tt*me:tt,_n=0,zn=B;_n<zn.length;_n+=1)for(var Dn=0,cr=zn[_n];Dn<cr.length;Dn+=1){var _r=cr[Dn],Ir=Et?_r:oh(_r,Le),Br=tn,jr=Tf([],[_r.x,_r.y,0,1],Le);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Br*=jr[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Br*=Q.cameraToCenterDistance/jr[3]),Il(Nt,Ir,Br))return!0}return!1},d}(bf));function oh(c,d){var g=Tf([],[c.x,c.y,0,1],d);return new se(g[0]/g[3],g[1]/g[3])}var wd=function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(Tc);function Vf(c,d,g,A){var M=d.width,B=d.height;if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==M*B*g)throw new RangeError("mismatched image size")}else A=new Uint8Array(M*B*g);return c.width=M,c.height=B,c.data=A,c}function zs(c,d,g){var A=d.width,M=d.height;if(A!==c.width||M!==c.height){var B=Vf({},{width:A,height:M},g);s0(c,B,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,A),height:Math.min(c.height,M)},g),c.width=A,c.height=M,c.data=B.data}}function s0(c,d,g,A,M,B){if(M.width===0||M.height===0)return d;if(M.width>c.width||M.height>c.height||g.x>c.width-M.width||g.y>c.height-M.height)throw new RangeError("out of range source coordinates for image copy");if(M.width>d.width||M.height>d.height||A.x>d.width-M.width||A.y>d.height-M.height)throw new RangeError("out of range destination coordinates for image copy");for(var V=c.data,Q=d.data,me=0;me<M.height;me++)for(var Le=((g.y+me)*c.width+g.x)*B,We=((A.y+me)*d.width+A.x)*B,tt=0;tt<M.width*B;tt++)Q[We+tt]=V[Le+tt];return d}io("HeatmapBucket",wd,{omit:["layers"]});var wf=function(c,d){Vf(this,c,1,d)};wf.prototype.resize=function(c){zs(this,c,1)},wf.prototype.clone=function(){return new wf({width:this.width,height:this.height},new Uint8Array(this.data))},wf.copy=function(c,d,g,A,M){s0(c,d,g,A,M,1)};var uu=function(c,d){Vf(this,c,4,d)};uu.prototype.resize=function(c){zs(this,c,4)},uu.prototype.replace=function(c,d){d?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c},uu.prototype.clone=function(){return new uu({width:this.width,height:this.height},new Uint8Array(this.data))},uu.copy=function(c,d,g,A,M){s0(c,d,g,A,M,4)},io("AlphaImage",wf),io("RGBAImage",uu);var vo={paint:new dl({"heatmap-radius":new Eo(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Eo(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jo(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nh(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jo(yt.paint_heatmap["heatmap-opacity"])})};function dm(c){var d={},g=c.resolution||256,A=c.clips?c.clips.length:1,M=c.image||new uu({width:g,height:A}),B=function(tn,_n,zn){d[c.evaluationKey]=zn;var Dn=c.expression.evaluate(d);M.data[tn+_n+0]=Math.floor(255*Dn.r/Dn.a),M.data[tn+_n+1]=Math.floor(255*Dn.g/Dn.a),M.data[tn+_n+2]=Math.floor(255*Dn.b/Dn.a),M.data[tn+_n+3]=Math.floor(255*Dn.a)};if(c.clips)for(var V=0,Q=0;V<A;++V,Q+=4*g)for(var me=0,Le=0;me<g;me++,Le+=4){var We=me/(g-1),tt=c.clips[V];B(Q,Le,tt.start*(1-We)+tt.end*We)}else for(var Et=0,Nt=0;Et<g;Et++,Nt+=4)B(0,Nt,Et/(g-1));return M}var Cp=function(c){function d(g){c.call(this,g,vo),this._updateColorRamp()}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new wd(g)},d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=dm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(bf),vy={paint:new dl({"hillshade-illumination-direction":new jo(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new jo(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jo(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jo(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jo(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jo(yt.paint_hillshade["hillshade-accent-color"])})},ig=function(c){function d(g){c.call(this,g,vy)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(bf),gy=uc([{name:"a_pos",components:2,type:"Int16"}],4).members,dv=l0,pm=l0;function l0(c,d,g){g=g||2;var A,M,B,V,Q,me,Le,We=d&&d.length,tt=We?d[0]*g:c.length,Et=yy(c,0,tt,g,!0),Nt=[];if(!Et||Et.next===Et.prev)return Nt;if(We&&(Et=function(_n,zn,Dn,cr){var _r,Ir,Br,jr=[];for(_r=0,Ir=zn.length;_r<Ir;_r++)(Br=yy(_n,zn[_r]*cr,_r<Ir-1?zn[_r+1]*cr:_n.length,cr,!1))===Br.next&&(Br.steiner=!0),jr.push(vm(Br));for(jr.sort(ag),_r=0;_r<jr.length;_r++)c0(jr[_r],Dn),Dn=Op(Dn,Dn.next);return Dn}(c,d,Et,g)),c.length>80*g){A=B=c[0],M=V=c[1];for(var tn=g;tn<tt;tn+=g)(Q=c[tn])<A&&(A=Q),(me=c[tn+1])<M&&(M=me),Q>B&&(B=Q),me>V&&(V=me);Le=(Le=Math.max(B-A,V-M))!==0?1/Le:0}return Rp(Et,Nt,g,A,M,Le),Nt}function yy(c,d,g,A,M){var B,V;if(M===fu(c,d,g,A)>0)for(B=d;B<g;B+=A)V=fc(B,c[B],c[B+1],V);else for(B=g-A;B>=d;B-=A)V=fc(B,c[B],c[B+1],V);return V&&Ad(V,V.next)&&(Uu(V),V=V.next),V}function Op(c,d){if(!c)return c;d||(d=c);var g,A=c;do if(g=!1,A.steiner||!Ad(A,A.next)&&El(A.prev,A,A.next)!==0)A=A.next;else{if(Uu(A),(A=d=A.prev)===A.next)break;g=!0}while(g||A!==d);return d}function Rp(c,d,g,A,M,B,V){if(c){!V&&B&&function(We,tt,Et,Nt){var tn=We;do tn.z===null&&(tn.z=Af(tn.x,tn.y,tt,Et,Nt)),tn.prevZ=tn.prev,tn.nextZ=tn.next,tn=tn.next;while(tn!==We);tn.prevZ.nextZ=null,tn.prevZ=null,function(_n){var zn,Dn,cr,_r,Ir,Br,jr,bi,Zi=1;do{for(Dn=_n,_n=null,Ir=null,Br=0;Dn;){for(Br++,cr=Dn,jr=0,zn=0;zn<Zi&&(jr++,cr=cr.nextZ);zn++);for(bi=Zi;jr>0||bi>0&&cr;)jr!==0&&(bi===0||!cr||Dn.z<=cr.z)?(_r=Dn,Dn=Dn.nextZ,jr--):(_r=cr,cr=cr.nextZ,bi--),Ir?Ir.nextZ=_r:_n=_r,_r.prevZ=Ir,Ir=_r;Dn=cr}Ir.nextZ=null,Zi*=2}while(Br>1)}(tn)}(c,A,M,B);for(var Q,me,Le=c;c.prev!==c.next;)if(Q=c.prev,me=c.next,B?mv(c,A,M,B):pv(c))d.push(Q.i/g),d.push(c.i/g),d.push(me.i/g),Uu(c),c=me.next,Le=me.next;else if((c=me)===Le){V?V===1?Rp(c=og(Op(c),d,g),d,g,A,M,B,2):V===2&&mm(c,d,g,A,M,B):Rp(Op(c),d,g,A,M,B,1);break}}}function pv(c){var d=c.prev,g=c,A=c.next;if(El(d,g,A)>=0)return!1;for(var M=c.next.next;M!==c.prev;){if(oc(d.x,d.y,g.x,g.y,A.x,A.y,M.x,M.y)&&El(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function mv(c,d,g,A){var M=c.prev,B=c,V=c.next;if(El(M,B,V)>=0)return!1;for(var Q=M.x>B.x?M.x>V.x?M.x:V.x:B.x>V.x?B.x:V.x,me=M.y>B.y?M.y>V.y?M.y:V.y:B.y>V.y?B.y:V.y,Le=Af(M.x<B.x?M.x<V.x?M.x:V.x:B.x<V.x?B.x:V.x,M.y<B.y?M.y<V.y?M.y:V.y:B.y<V.y?B.y:V.y,d,g,A),We=Af(Q,me,d,g,A),tt=c.prevZ,Et=c.nextZ;tt&&tt.z>=Le&&Et&&Et.z<=We;){if(tt!==c.prev&&tt!==c.next&&oc(M.x,M.y,B.x,B.y,V.x,V.y,tt.x,tt.y)&&El(tt.prev,tt,tt.next)>=0||(tt=tt.prevZ,Et!==c.prev&&Et!==c.next&&oc(M.x,M.y,B.x,B.y,V.x,V.y,Et.x,Et.y)&&El(Et.prev,Et,Et.next)>=0))return!1;Et=Et.nextZ}for(;tt&&tt.z>=Le;){if(tt!==c.prev&&tt!==c.next&&oc(M.x,M.y,B.x,B.y,V.x,V.y,tt.x,tt.y)&&El(tt.prev,tt,tt.next)>=0)return!1;tt=tt.prevZ}for(;Et&&Et.z<=We;){if(Et!==c.prev&&Et!==c.next&&oc(M.x,M.y,B.x,B.y,V.x,V.y,Et.x,Et.y)&&El(Et.prev,Et,Et.next)>=0)return!1;Et=Et.nextZ}return!0}function og(c,d,g){var A=c;do{var M=A.prev,B=A.next.next;!Ad(M,B)&&Mp(M,A,A.next,B)&&Jh(M,B)&&Jh(B,M)&&(d.push(M.i/g),d.push(A.i/g),d.push(B.i/g),Uu(A),Uu(A.next),A=c=B),A=A.next}while(A!==c);return Op(A)}function mm(c,d,g,A,M,B){var V=c;do{for(var Q=V.next.next;Q!==V.prev;){if(V.i!==Q.i&&qd(V,Q)){var me=Pp(V,Q);return V=Op(V,V.next),me=Op(me,me.next),Rp(V,d,g,A,M,B),void Rp(me,d,g,A,M,B)}Q=Q.next}V=V.next}while(V!==c)}function ag(c,d){return c.x-d.x}function c0(c,d){if(d=function(A,M){var B,V=M,Q=A.x,me=A.y,Le=-1/0;do{if(me<=V.y&&me>=V.next.y&&V.next.y!==V.y){var We=V.x+(me-V.y)*(V.next.x-V.x)/(V.next.y-V.y);if(We<=Q&&We>Le){if(Le=We,We===Q){if(me===V.y)return V;if(me===V.next.y)return V.next}B=V.x<V.next.x?V:V.next}}V=V.next}while(V!==M);if(!B)return null;if(Q===Le)return B;var tt,Et=B,Nt=B.x,tn=B.y,_n=1/0;V=B;do Q>=V.x&&V.x>=Nt&&Q!==V.x&&oc(me<tn?Q:Le,me,Nt,tn,me<tn?Le:Q,me,V.x,V.y)&&(tt=Math.abs(me-V.y)/(Q-V.x),Jh(V,A)&&(tt<_n||tt===_n&&(V.x>B.x||V.x===B.x&&u0(B,V)))&&(B=V,_n=tt)),V=V.next;while(V!==Et);return B}(c,d)){var g=Pp(d,c);Op(d,d.next),Op(g,g.next)}}function u0(c,d){return El(c.prev,c,d.prev)<0&&El(d.next,c,c.next)<0}function Af(c,d,g,A,M){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-g)*M)|c<<8))|c<<4))|c<<2))|c<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-A)*M)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function vm(c){var d=c,g=c;do(d.x<g.x||d.x===g.x&&d.y<g.y)&&(g=d),d=d.next;while(d!==c);return g}function oc(c,d,g,A,M,B,V,Q){return(M-V)*(d-Q)-(c-V)*(B-Q)>=0&&(c-V)*(A-Q)-(g-V)*(d-Q)>=0&&(g-V)*(B-Q)-(M-V)*(A-Q)>=0}function qd(c,d){return c.next.i!==d.i&&c.prev.i!==d.i&&!function(g,A){var M=g;do{if(M.i!==g.i&&M.next.i!==g.i&&M.i!==A.i&&M.next.i!==A.i&&Mp(M,M.next,g,A))return!0;M=M.next}while(M!==g);return!1}(c,d)&&(Jh(c,d)&&Jh(d,c)&&function(g,A){var M=g,B=!1,V=(g.x+A.x)/2,Q=(g.y+A.y)/2;do M.y>Q!=M.next.y>Q&&M.next.y!==M.y&&V<(M.next.x-M.x)*(Q-M.y)/(M.next.y-M.y)+M.x&&(B=!B),M=M.next;while(M!==g);return B}(c,d)&&(El(c.prev,c,d.prev)||El(c,d.prev,d))||Ad(c,d)&&El(c.prev,c,c.next)>0&&El(d.prev,d,d.next)>0)}function El(c,d,g){return(d.y-c.y)*(g.x-d.x)-(d.x-c.x)*(g.y-d.y)}function Ad(c,d){return c.x===d.x&&c.y===d.y}function Mp(c,d,g,A){var M=Cd(El(c,d,g)),B=Cd(El(c,d,A)),V=Cd(El(g,A,c)),Q=Cd(El(g,A,d));return M!==B&&V!==Q||!(M!==0||!ah(c,g,d))||!(B!==0||!ah(c,A,d))||!(V!==0||!ah(g,c,A))||!(Q!==0||!ah(g,d,A))}function ah(c,d,g){return d.x<=Math.max(c.x,g.x)&&d.x>=Math.min(c.x,g.x)&&d.y<=Math.max(c.y,g.y)&&d.y>=Math.min(c.y,g.y)}function Cd(c){return c>0?1:c<0?-1:0}function Jh(c,d){return El(c.prev,c,c.next)<0?El(c,d,c.next)>=0&&El(c,c.prev,d)>=0:El(c,d,c.prev)<0||El(c,c.next,d)<0}function Pp(c,d){var g=new Qd(c.i,c.x,c.y),A=new Qd(d.i,d.x,d.y),M=c.next,B=d.prev;return c.next=d,d.prev=c,g.next=M,M.prev=g,A.next=g,g.prev=A,B.next=A,A.prev=B,A}function fc(c,d,g,A){var M=new Qd(c,d,g);return A?(M.next=A.next,M.prev=A,A.next.prev=M,A.next=M):(M.prev=M,M.next=M),M}function Uu(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Qd(c,d,g){this.i=c,this.x=d,this.y=g,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function fu(c,d,g,A){for(var M=0,B=d,V=g-A;B<g;B+=A)M+=(c[V]-c[B])*(c[B+1]+c[V+1]),V=B;return M}function vv(c,d,g,A,M){(function B(V,Q,me,Le,We){for(;Le>me;){if(Le-me>600){var tt=Le-me+1,Et=Q-me+1,Nt=Math.log(tt),tn=.5*Math.exp(2*Nt/3),_n=.5*Math.sqrt(Nt*tn*(tt-tn)/tt)*(Et-tt/2<0?-1:1);B(V,Q,Math.max(me,Math.floor(Q-Et*tn/tt+_n)),Math.min(Le,Math.floor(Q+(tt-Et)*tn/tt+_n)),We)}var zn=V[Q],Dn=me,cr=Le;for(ed(V,me,Q),We(V[Le],zn)>0&&ed(V,me,Le);Dn<cr;){for(ed(V,Dn,cr),Dn++,cr--;We(V[Dn],zn)<0;)Dn++;for(;We(V[cr],zn)>0;)cr--}We(V[me],zn)===0?ed(V,me,cr):ed(V,++cr,Le),cr<=Q&&(me=cr+1),Q<=cr&&(Le=cr-1)}})(c,d,g||0,A||c.length-1,M||Cf)}function ed(c,d,g){var A=c[d];c[d]=c[g],c[g]=A}function Cf(c,d){return c<d?-1:c>d?1:0}function sh(c,d){var g=c.length;if(g<=1)return[c];for(var A,M,B=[],V=0;V<g;V++){var Q=Sn(c[V]);Q!==0&&(c[V].area=Math.abs(Q),M===void 0&&(M=Q<0),M===Q<0?(A&&B.push(A),A=[c[V]]):A.push(c[V]))}if(A&&B.push(A),d>1)for(var me=0;me<B.length;me++)B[me].length<=d||(vv(B[me],d,1,B[me].length-1,Od),B[me]=B[me].slice(0,d));return B}function Od(c,d){return d.area-c.area}function td(c,d,g){for(var A=g.patternDependencies,M=!1,B=0,V=d;B<V.length;B+=1){var Q=V[B].paint.get(c+"-pattern");Q.isConstant()||(M=!0);var me=Q.constantOr(null);me&&(M=!0,A[me.to]=!0,A[me.from]=!0)}return M}function Jd(c,d,g,A,M){for(var B=M.patternDependencies,V=0,Q=d;V<Q.length;V+=1){var me=Q[V],Le=me.paint.get(c+"-pattern").value;if(Le.kind!=="constant"){var We=Le.evaluate({zoom:A-1},g,{},M.availableImages),tt=Le.evaluate({zoom:A},g,{},M.availableImages),Et=Le.evaluate({zoom:A+1},g,{},M.availableImages);tt=tt&&tt.name?tt.name:tt,Et=Et&&Et.name?Et.name:Et,B[We=We&&We.name?We.name:We]=!0,B[tt]=!0,B[Et]=!0,g.patterns[me.id]={min:We,mid:tt,max:Et}}}return g}l0.deviation=function(c,d,g,A){var M=d&&d.length,B=Math.abs(fu(c,0,M?d[0]*g:c.length,g));if(M)for(var V=0,Q=d.length;V<Q;V++)B-=Math.abs(fu(c,d[V]*g,V<Q-1?d[V+1]*g:c.length,g));var me=0;for(V=0;V<A.length;V+=3){var Le=A[V]*g,We=A[V+1]*g,tt=A[V+2]*g;me+=Math.abs((c[Le]-c[tt])*(c[We+1]-c[Le+1])-(c[Le]-c[We])*(c[tt+1]-c[Le+1]))}return B===0&&me===0?0:Math.abs((me-B)/B)},l0.flatten=function(c){for(var d=c[0][0].length,g={vertices:[],holes:[],dimensions:d},A=0,M=0;M<c.length;M++){for(var B=0;B<c[M].length;B++)for(var V=0;V<d;V++)g.vertices.push(c[M][B][V]);M>0&&g.holes.push(A+=c[M-1].length)}return g},dv.default=pm;var Of=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Kh,this.indexArray=new sf,this.indexArray2=new Ds,this.programConfigurations=new Vo(c.layers,c.zoom),this.segments=new St,this.segments2=new St,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};Of.prototype.populate=function(c,d,g){this.hasPattern=td("fill",this.layers,d);for(var A=this.layers[0].layout.get("fill-sort-key"),M=[],B=0,V=c;B<V.length;B+=1){var Q=V[B],me=Q.feature,Le=Q.id,We=Q.index,tt=Q.sourceLayerIndex,Et=this.layers[0]._featureFilter.needGeometry,Nt=ll(me,Et);if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),Nt,g)){var tn=A?A.evaluate(Nt,{},g,d.availableImages):void 0,_n={id:Le,properties:me.properties,type:me.type,sourceLayerIndex:tt,index:We,geometry:Et?Nt.geometry:Rs(me),patterns:{},sortKey:tn};M.push(_n)}}A&&M.sort(function(bi,Zi){return bi.sortKey-Zi.sortKey});for(var zn=0,Dn=M;zn<Dn.length;zn+=1){var cr=Dn[zn],_r=cr.geometry,Ir=cr.index,Br=cr.sourceLayerIndex;if(this.hasPattern){var jr=Jd("fill",this.layers,cr,this.zoom,d);this.patternFeatures.push(jr)}else this.addFeature(cr,_r,Ir,g,{});d.featureIndex.insert(c[Ir].feature,_r,Ir,Br,this.index)}},Of.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Of.prototype.addFeatures=function(c,d,g){for(var A=0,M=this.patternFeatures;A<M.length;A+=1){var B=M[A];this.addFeature(B,B.geometry,B.index,d,g)}},Of.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Of.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Of.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,gy),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0},Of.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Of.prototype.addFeature=function(c,d,g,A,M){for(var B=0,V=sh(d,500);B<V.length;B+=1){for(var Q=V[B],me=0,Le=0,We=Q;Le<We.length;Le+=1)me+=We[Le].length;for(var tt=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray),Et=tt.vertexLength,Nt=[],tn=[],_n=0,zn=Q;_n<zn.length;_n+=1){var Dn=zn[_n];if(Dn.length!==0){Dn!==Q[0]&&tn.push(Nt.length/2);var cr=this.segments2.prepareSegment(Dn.length,this.layoutVertexArray,this.indexArray2),_r=cr.vertexLength;this.layoutVertexArray.emplaceBack(Dn[0].x,Dn[0].y),this.indexArray2.emplaceBack(_r+Dn.length-1,_r),Nt.push(Dn[0].x),Nt.push(Dn[0].y);for(var Ir=1;Ir<Dn.length;Ir++)this.layoutVertexArray.emplaceBack(Dn[Ir].x,Dn[Ir].y),this.indexArray2.emplaceBack(_r+Ir-1,_r+Ir),Nt.push(Dn[Ir].x),Nt.push(Dn[Ir].y);cr.vertexLength+=Dn.length,cr.primitiveLength+=Dn.length}}for(var Br=dv(Nt,tn),jr=0;jr<Br.length;jr+=3)this.indexArray.emplaceBack(Et+Br[jr],Et+Br[jr+1],Et+Br[jr+2]);tt.vertexLength+=me,tt.primitiveLength+=Br.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,M,A)},io("FillBucket",Of,{omit:["layers","patternFeatures"]});var nd=new dl({"fill-sort-key":new Eo(yt.layout_fill["fill-sort-key"])}),gv={paint:new dl({"fill-antialias":new jo(yt.paint_fill["fill-antialias"]),"fill-opacity":new Eo(yt.paint_fill["fill-opacity"]),"fill-color":new Eo(yt.paint_fill["fill-color"]),"fill-outline-color":new Eo(yt.paint_fill["fill-outline-color"]),"fill-translate":new jo(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new jo(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new kc(yt.paint_fill["fill-pattern"])}),layout:nd},_y=function(c){function d(g){c.call(this,g,gv)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,A){c.prototype.recalculate.call(this,g,A);var M=this.paint._values["fill-outline-color"];M.value.kind==="constant"&&M.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(g){return new Of(g)},d.prototype.queryRadius=function(){return Ll(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(g,A,M,B,V,Q,me){return cu(Kc(g,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,me),B)},d.prototype.isTileClipped=function(){return!0},d}(bf),yv=uc([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,sg=rd;function rd(c,d,g,A,M){this.properties={},this.extent=g,this.type=0,this._pbf=c,this._geometry=-1,this._keys=A,this._values=M,c.readFields(gm,this,d)}function gm(c,d,g){c==1?d.id=g.readVarint():c==2?function(A,M){for(var B=A.readVarint()+A.pos;A.pos<B;){var V=M._keys[A.readVarint()],Q=M._values[A.readVarint()];M.properties[V]=Q}}(g,d):c==3?d.type=g.readVarint():c==4&&(d._geometry=g.pos)}function lh(c){for(var d,g,A=0,M=0,B=c.length,V=B-1;M<B;V=M++)A+=((g=c[V]).x-(d=c[M]).x)*(d.y+g.y);return A}rd.types=["Unknown","Point","LineString","Polygon"],rd.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d,g=c.readVarint()+c.pos,A=1,M=0,B=0,V=0,Q=[];c.pos<g;){if(M<=0){var me=c.readVarint();A=7&me,M=me>>3}if(M--,A===1||A===2)B+=c.readSVarint(),V+=c.readSVarint(),A===1&&(d&&Q.push(d),d=[]),d.push(new se(B,V));else{if(A!==7)throw new Error("unknown command "+A);d&&d.push(d[0].clone())}}return d&&Q.push(d),Q},rd.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,g=1,A=0,M=0,B=0,V=1/0,Q=-1/0,me=1/0,Le=-1/0;c.pos<d;){if(A<=0){var We=c.readVarint();g=7&We,A=We>>3}if(A--,g===1||g===2)(M+=c.readSVarint())<V&&(V=M),M>Q&&(Q=M),(B+=c.readSVarint())<me&&(me=B),B>Le&&(Le=B);else if(g!==7)throw new Error("unknown command "+g)}return[V,me,Q,Le]},rd.prototype.toGeoJSON=function(c,d,g){var A,M,B=this.extent*Math.pow(2,g),V=this.extent*c,Q=this.extent*d,me=this.loadGeometry(),Le=rd.types[this.type];function We(Nt){for(var tn=0;tn<Nt.length;tn++){var _n=Nt[tn];Nt[tn]=[360*(_n.x+V)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(_n.y+Q)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var tt=[];for(A=0;A<me.length;A++)tt[A]=me[A][0];We(me=tt);break;case 2:for(A=0;A<me.length;A++)We(me[A]);break;case 3:for(me=function(Nt){var tn=Nt.length;if(tn<=1)return[Nt];for(var _n,zn,Dn=[],cr=0;cr<tn;cr++){var _r=lh(Nt[cr]);_r!==0&&(zn===void 0&&(zn=_r<0),zn===_r<0?(_n&&Dn.push(_n),_n=[Nt[cr]]):_n.push(Nt[cr]))}return _n&&Dn.push(_n),Dn}(me),A=0;A<me.length;A++)for(M=0;M<me[A].length;M++)We(me[A][M])}me.length===1?me=me[0]:Le="Multi"+Le;var Et={type:"Feature",geometry:{type:Le,coordinates:me},properties:this.properties};return"id"in this&&(Et.id=this.id),Et};var ep=tp;function tp(c,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(Rd,this,d),this.length=this._features.length}function Rd(c,d,g){c===15?d.version=g.readVarint():c===1?d.name=g.readString():c===5?d.extent=g.readVarint():c===2?d._features.push(g.pos):c===3?d._keys.push(g.readString()):c===4&&d._values.push(function(A){for(var M=null,B=A.readVarint()+A.pos;A.pos<B;){var V=A.readVarint()>>3;M=V===1?A.readString():V===2?A.readFloat():V===3?A.readDouble():V===4?A.readVarint64():V===5?A.readVarint():V===6?A.readSVarint():V===7?A.readBoolean():null}return M}(g))}function _v(c,d,g){if(c===3){var A=new ep(g,g.readVarint()+g.pos);A.length&&(d[A.name]=A)}}tp.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var d=this._pbf.readVarint()+this._pbf.pos;return new sg(this._pbf,d,this.extent,this._keys,this._values)};var np={VectorTile:function(c,d){this.layers=c.readFields(_v,{},d)},VectorTileFeature:sg,VectorTileLayer:ep},V0=np.VectorTileFeature.types,Md=Math.pow(2,13);function qc(c,d,g,A,M,B,V,Q){c.emplaceBack(d,g,2*Math.floor(A*Md)+V,M*Md*2,B*Md*2,Math.round(Q))}var Qc=function(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Ah,this.indexArray=new sf,this.programConfigurations=new Vo(c.layers,c.zoom),this.segments=new St,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function hc(c,d){return c.x===d.x&&(c.x<0||c.x>8192)||c.y===d.y&&(c.y<0||c.y>8192)}Qc.prototype.populate=function(c,d,g){this.features=[],this.hasPattern=td("fill-extrusion",this.layers,d);for(var A=0,M=c;A<M.length;A+=1){var B=M[A],V=B.feature,Q=B.id,me=B.index,Le=B.sourceLayerIndex,We=this.layers[0]._featureFilter.needGeometry,tt=ll(V,We);if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),tt,g)){var Et={id:Q,sourceLayerIndex:Le,index:me,geometry:We?tt.geometry:Rs(V),properties:V.properties,type:V.type,patterns:{}};this.hasPattern?this.features.push(Jd("fill-extrusion",this.layers,Et,this.zoom,d)):this.addFeature(Et,Et.geometry,me,g,{}),d.featureIndex.insert(V,Et.geometry,me,Le,this.index,!0)}}},Qc.prototype.addFeatures=function(c,d,g){for(var A=0,M=this.features;A<M.length;A+=1){var B=M[A];this.addFeature(B,B.geometry,B.index,d,g)}},Qc.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Qc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qc.prototype.upload=function(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,yv),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},Qc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qc.prototype.addFeature=function(c,d,g,A,M){for(var B=0,V=sh(d,500);B<V.length;B+=1){for(var Q=V[B],me=0,Le=0,We=Q;Le<We.length;Le+=1)me+=We[Le].length;for(var tt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Et=0,Nt=Q;Et<Nt.length;Et+=1){var tn=Nt[Et];if(tn.length!==0&&!((Za=tn).every(function(pa){return pa.x<0})||Za.every(function(pa){return pa.x>8192})||Za.every(function(pa){return pa.y<0})||Za.every(function(pa){return pa.y>8192})))for(var _n=0,zn=0;zn<tn.length;zn++){var Dn=tn[zn];if(zn>=1){var cr=tn[zn-1];if(!hc(Dn,cr)){tt.vertexLength+4>St.MAX_VERTEX_ARRAY_LENGTH&&(tt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _r=Dn.sub(cr)._perp()._unit(),Ir=cr.dist(Dn);_n+Ir>32768&&(_n=0),qc(this.layoutVertexArray,Dn.x,Dn.y,_r.x,_r.y,0,0,_n),qc(this.layoutVertexArray,Dn.x,Dn.y,_r.x,_r.y,0,1,_n),qc(this.layoutVertexArray,cr.x,cr.y,_r.x,_r.y,0,0,_n+=Ir),qc(this.layoutVertexArray,cr.x,cr.y,_r.x,_r.y,0,1,_n);var Br=tt.vertexLength;this.indexArray.emplaceBack(Br,Br+2,Br+1),this.indexArray.emplaceBack(Br+1,Br+2,Br+3),tt.vertexLength+=4,tt.primitiveLength+=2}}}}if(tt.vertexLength+me>St.MAX_VERTEX_ARRAY_LENGTH&&(tt=this.segments.prepareSegment(me,this.layoutVertexArray,this.indexArray)),V0[c.type]==="Polygon"){for(var jr=[],bi=[],Zi=tt.vertexLength,Ro=0,ki=Q;Ro<ki.length;Ro+=1){var zo=ki[Ro];if(zo.length!==0){zo!==Q[0]&&bi.push(jr.length/2);for(var ao=0;ao<zo.length;ao++){var xa=zo[ao];qc(this.layoutVertexArray,xa.x,xa.y,0,0,1,1,0),jr.push(xa.x),jr.push(xa.y)}}}for(var Mo=dv(jr,bi),_o=0;_o<Mo.length;_o+=3)this.indexArray.emplaceBack(Zi+Mo[_o],Zi+Mo[_o+2],Zi+Mo[_o+1]);tt.primitiveLength+=Mo.length/3,tt.vertexLength+=me}}var Za;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,M,A)},io("FillExtrusionBucket",Qc,{omit:["layers","features"]});var lf={paint:new dl({"fill-extrusion-opacity":new jo(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Eo(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jo(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jo(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new kc(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Eo(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Eo(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new jo(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},wu=function(c){function d(g){c.call(this,g,lf)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.createBucket=function(g){return new Qc(g)},d.prototype.queryRadius=function(){return Ll(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(g,A,M,B,V,Q,me,Le){var We=Kc(g,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,me),tt=this.paint.get("fill-extrusion-height").evaluate(A,M),Et=this.paint.get("fill-extrusion-base").evaluate(A,M),Nt=function(_n,zn,Dn,cr){for(var _r=[],Ir=0,Br=_n;Ir<Br.length;Ir+=1){var jr=Br[Ir],bi=[jr.x,jr.y,0,1];Tf(bi,bi,zn),_r.push(new se(bi[0]/bi[3],bi[1]/bi[3]))}return _r}(We,Le),tn=function(_n,zn,Dn,cr){for(var _r=[],Ir=[],Br=cr[8]*zn,jr=cr[9]*zn,bi=cr[10]*zn,Zi=cr[11]*zn,Ro=cr[8]*Dn,ki=cr[9]*Dn,zo=cr[10]*Dn,ao=cr[11]*Dn,xa=0,Mo=_n;xa<Mo.length;xa+=1){for(var _o=[],Za=[],pa=0,Oa=Mo[xa];pa<Oa.length;pa+=1){var $o=Oa[pa],Es=$o.x,Tl=$o.y,Vl=cr[0]*Es+cr[4]*Tl+cr[12],Hl=cr[1]*Es+cr[5]*Tl+cr[13],wl=cr[2]*Es+cr[6]*Tl+cr[14],ql=cr[3]*Es+cr[7]*Tl+cr[15],jc=wl+bi,nu=ql+Zi,fl=Vl+Ro,Cc=Hl+ki,Vu=wl+zo,ac=ql+ao,Oc=new se((Vl+Br)/nu,(Hl+jr)/nu);Oc.z=jc/nu,_o.push(Oc);var Ya=new se(fl/ac,Cc/ac);Ya.z=Vu/ac,Za.push(Ya)}_r.push(_o),Ir.push(Za)}return[_r,Ir]}(B,Et,tt,Le);return function(_n,zn,Dn){var cr=1/0;cu(Dn,zn)&&(cr=bv(Dn,zn[0]));for(var _r=0;_r<zn.length;_r++)for(var Ir=zn[_r],Br=_n[_r],jr=0;jr<Ir.length-1;jr++){var bi=Ir[jr],Zi=[bi,Ir[jr+1],Br[jr+1],Br[jr],bi];Ch(Dn,Zi)&&(cr=Math.min(cr,bv(Dn,Zi)))}return cr!==1/0&&cr}(tn[0],tn[1],Nt)},d}(bf);function rp(c,d){return c.x*d.x+c.y*d.y}function bv(c,d){if(c.length===1){for(var g,A=0,M=d[A++];!g||M.equals(g);)if(!(g=d[A++]))return 1/0;for(;A<d.length;A++){var B=d[A],V=c[0],Q=g.sub(M),me=B.sub(M),Le=V.sub(M),We=rp(Q,Q),tt=rp(Q,me),Et=rp(me,me),Nt=rp(Le,Q),tn=rp(Le,me),_n=We*Et-tt*tt,zn=(Et*Nt-tt*tn)/_n,Dn=(We*tn-tt*Nt)/_n,cr=M.z*(1-zn-Dn)+g.z*zn+B.z*Dn;if(isFinite(cr))return cr}return 1/0}for(var _r=1/0,Ir=0,Br=d;Ir<Br.length;Ir+=1)_r=Math.min(_r,Br[Ir].z);return _r}var by=uc([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,lg=uc([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ym=np.VectorTileFeature.types,_m=Math.cos(Math.PI/180*37.5),xv=Math.pow(2,14)/.5,Jc=function(c){var d=this;this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(g){return g.id}),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(g){d.gradients[g.id]={}}),this.layoutVertexArray=new Su,this.layoutVertexArray2=new Yd,this.indexArray=new sf,this.programConfigurations=new Vo(c.layers,c.zoom),this.segments=new St,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(g){return g.isStateDependent()}).map(function(g){return g.id})};Jc.prototype.populate=function(c,d,g){this.hasPattern=td("line",this.layers,d);for(var A=this.layers[0].layout.get("line-sort-key"),M=[],B=0,V=c;B<V.length;B+=1){var Q=V[B],me=Q.feature,Le=Q.id,We=Q.index,tt=Q.sourceLayerIndex,Et=this.layers[0]._featureFilter.needGeometry,Nt=ll(me,Et);if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),Nt,g)){var tn=A?A.evaluate(Nt,{},g):void 0,_n={id:Le,properties:me.properties,type:me.type,sourceLayerIndex:tt,index:We,geometry:Et?Nt.geometry:Rs(me),patterns:{},sortKey:tn};M.push(_n)}}A&&M.sort(function(bi,Zi){return bi.sortKey-Zi.sortKey});for(var zn=0,Dn=M;zn<Dn.length;zn+=1){var cr=Dn[zn],_r=cr.geometry,Ir=cr.index,Br=cr.sourceLayerIndex;if(this.hasPattern){var jr=Jd("line",this.layers,cr,this.zoom,d);this.patternFeatures.push(jr)}else this.addFeature(cr,_r,Ir,g,{});d.featureIndex.insert(c[Ir].feature,_r,Ir,Br,this.index)}},Jc.prototype.update=function(c,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,g)},Jc.prototype.addFeatures=function(c,d,g){for(var A=0,M=this.patternFeatures;A<M.length;A+=1){var B=M[A];this.addFeature(B,B.geometry,B.index,d,g)}},Jc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Jc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Jc.prototype.upload=function(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,lg)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,by),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0},Jc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Jc.prototype.lineFeatureClips=function(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}},Jc.prototype.addFeature=function(c,d,g,A,M){var B=this.layers[0].layout,V=B.get("line-join").evaluate(c,{}),Q=B.get("line-cap"),me=B.get("line-miter-limit"),Le=B.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(var We=0,tt=d;We<tt.length;We+=1)this.addLine(tt[We],c,V,Q,me,Le);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,M,A)},Jc.prototype.addLine=function(c,d,g,A,M,B){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var V=0;V<c.length-1;V++)this.totalDistance+=c[V].dist(c[V+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var Q=ym[d.type]==="Polygon",me=c.length;me>=2&&c[me-1].equals(c[me-2]);)me--;for(var Le=0;Le<me-1&&c[Le].equals(c[Le+1]);)Le++;if(!(me<(Q?3:2))){g==="bevel"&&(M=1.05);var We,tt=this.overscaling<=16?122880/(512*this.overscaling):0,Et=this.segments.prepareSegment(10*me,this.layoutVertexArray,this.indexArray),Nt=void 0,tn=void 0,_n=void 0,zn=void 0;this.e1=this.e2=-1,Q&&(zn=c[Le].sub(We=c[me-2])._unit()._perp());for(var Dn=Le;Dn<me;Dn++)if(!(tn=Dn===me-1?Q?c[Le+1]:void 0:c[Dn+1])||!c[Dn].equals(tn)){zn&&(_n=zn),We&&(Nt=We),We=c[Dn],zn=tn?tn.sub(We)._unit()._perp():_n;var cr=(_n=_n||zn).add(zn);cr.x===0&&cr.y===0||cr._unit();var _r=_n.x*zn.x+_n.y*zn.y,Ir=cr.x*zn.x+cr.y*zn.y,Br=Ir!==0?1/Ir:1/0,jr=2*Math.sqrt(2-2*Ir),bi=Ir<_m&&Nt&&tn,Zi=_n.x*zn.y-_n.y*zn.x>0;if(bi&&Dn>Le){var Ro=We.dist(Nt);if(Ro>2*tt){var ki=We.sub(We.sub(Nt)._mult(tt/Ro)._round());this.updateDistance(Nt,ki),this.addCurrentVertex(ki,_n,0,0,Et),Nt=ki}}var zo=Nt&&tn,ao=zo?g:Q?"butt":A;if(zo&&ao==="round"&&(Br<B?ao="miter":Br<=2&&(ao="fakeround")),ao==="miter"&&Br>M&&(ao="bevel"),ao==="bevel"&&(Br>2&&(ao="flipbevel"),Br<M&&(ao="miter")),Nt&&this.updateDistance(Nt,We),ao==="miter")cr._mult(Br),this.addCurrentVertex(We,cr,0,0,Et);else if(ao==="flipbevel"){if(Br>100)cr=zn.mult(-1);else{var xa=Br*_n.add(zn).mag()/_n.sub(zn).mag();cr._perp()._mult(xa*(Zi?-1:1))}this.addCurrentVertex(We,cr,0,0,Et),this.addCurrentVertex(We,cr.mult(-1),0,0,Et)}else if(ao==="bevel"||ao==="fakeround"){var Mo=-Math.sqrt(Br*Br-1),_o=Zi?Mo:0,Za=Zi?0:Mo;if(Nt&&this.addCurrentVertex(We,_n,_o,Za,Et),ao==="fakeround")for(var pa=Math.round(180*jr/Math.PI/20),Oa=1;Oa<pa;Oa++){var $o=Oa/pa;if($o!==.5){var Es=$o-.5;$o+=$o*Es*($o-1)*((1.0904+_r*(_r*(3.55645-1.43519*_r)-3.2452))*Es*Es+(.848013+_r*(.215638*_r-1.06021)))}var Tl=zn.sub(_n)._mult($o)._add(_n)._unit()._mult(Zi?-1:1);this.addHalfVertex(We,Tl.x,Tl.y,!1,Zi,0,Et)}tn&&this.addCurrentVertex(We,zn,-_o,-Za,Et)}else if(ao==="butt")this.addCurrentVertex(We,cr,0,0,Et);else if(ao==="square"){var Vl=Nt?1:-1;this.addCurrentVertex(We,cr,Vl,Vl,Et)}else ao==="round"&&(Nt&&(this.addCurrentVertex(We,_n,0,0,Et),this.addCurrentVertex(We,_n,1,1,Et,!0)),tn&&(this.addCurrentVertex(We,zn,-1,-1,Et,!0),this.addCurrentVertex(We,zn,0,0,Et)));if(bi&&Dn<me-1){var Hl=We.dist(tn);if(Hl>2*tt){var wl=We.add(tn.sub(We)._mult(tt/Hl)._round());this.updateDistance(We,wl),this.addCurrentVertex(wl,zn,0,0,Et),We=wl}}}}},Jc.prototype.addCurrentVertex=function(c,d,g,A,M,B){B===void 0&&(B=!1);var V=d.y*A-d.x,Q=-d.y-d.x*A;this.addHalfVertex(c,d.x+d.y*g,d.y-d.x*g,B,!1,g,M),this.addHalfVertex(c,V,Q,B,!0,-A,M),this.distance>xv/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(c,d,g,A,M,B))},Jc.prototype.addHalfVertex=function(c,d,g,A,M,B,V){var Q=.5*(this.lineClips?this.scaledDistance*(xv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c.x<<1)+(A?1:0),(c.y<<1)+(M?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(B===0?0:B<0?-1:1)|(63&Q)<<2,Q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var me=V.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,me),V.primitiveLength++),M?this.e2=me:this.e1=me},Jc.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Jc.prototype.updateDistance=function(c,d){this.distance+=c.dist(d),this.updateScaledDistance()},io("LineBucket",Jc,{omit:["layers","patternFeatures"]});var bm=new dl({"line-cap":new jo(yt.layout_line["line-cap"]),"line-join":new Eo(yt.layout_line["line-join"]),"line-miter-limit":new jo(yt.layout_line["line-miter-limit"]),"line-round-limit":new jo(yt.layout_line["line-round-limit"]),"line-sort-key":new Eo(yt.layout_line["line-sort-key"])}),H0={paint:new dl({"line-opacity":new Eo(yt.paint_line["line-opacity"]),"line-color":new Eo(yt.paint_line["line-color"]),"line-translate":new jo(yt.paint_line["line-translate"]),"line-translate-anchor":new jo(yt.paint_line["line-translate-anchor"]),"line-width":new Eo(yt.paint_line["line-width"]),"line-gap-width":new Eo(yt.paint_line["line-gap-width"]),"line-offset":new Eo(yt.paint_line["line-offset"]),"line-blur":new Eo(yt.paint_line["line-blur"]),"line-dasharray":new lu(yt.paint_line["line-dasharray"]),"line-pattern":new kc(yt.paint_line["line-pattern"]),"line-gradient":new nh(yt.paint_line["line-gradient"])}),layout:bm},Ev=new(function(c){function d(){c.apply(this,arguments)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(g,A){return A=new Ta(Math.floor(A.zoom),{now:A.now,fadeDuration:A.fadeDuration,zoomHistory:A.zoomHistory,transition:A.transition}),c.prototype.possiblyEvaluate.call(this,g,A)},d.prototype.evaluate=function(g,A,M,B){return A=we({},A,{zoom:Math.floor(A.zoom)}),c.prototype.evaluate.call(this,g,A,M,B)},d}(Eo))(H0.paint.properties["line-width"].specification);Ev.useIntegerZoom=!0;var Sl=function(c){function d(g){c.call(this,g,H0),this.gradientVersion=0}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(g){g==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof lc,this.gradientVersion=(this.gradientVersion+1)%je)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(g,A){c.prototype.recalculate.call(this,g,A),this.paint._values["line-floorwidth"]=Ev.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)},d.prototype.createBucket=function(g){return new Jc(g)},d.prototype.queryRadius=function(g){var A=g,M=wc(ml("line-width",this,A),ml("line-gap-width",this,A)),B=ml("line-offset",this,A);return M/2+Math.abs(B)+Ll(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(g,A,M,B,V,Q,me){var Le=Kc(g,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,me),We=me/2*wc(this.paint.get("line-width").evaluate(A,M),this.paint.get("line-gap-width").evaluate(A,M)),tt=this.paint.get("line-offset").evaluate(A,M);return tt&&(B=function(Et,Nt){for(var tn=[],_n=new se(0,0),zn=0;zn<Et.length;zn++){for(var Dn=Et[zn],cr=[],_r=0;_r<Dn.length;_r++){var Ir=Dn[_r],Br=Dn[_r+1],jr=_r===0?_n:Ir.sub(Dn[_r-1])._unit()._perp(),bi=_r===Dn.length-1?_n:Br.sub(Ir)._unit()._perp(),Zi=jr._add(bi)._unit();Zi._mult(1/(Zi.x*bi.x+Zi.y*bi.y)),cr.push(Zi._mult(Nt)._add(Ir))}tn.push(cr)}return tn}(B,tt*me)),function(Et,Nt,tn){for(var _n=0;_n<Nt.length;_n++){var zn=Nt[_n];if(Et.length>=3){for(var Dn=0;Dn<zn.length;Dn++)if(Rh(Et,zn[Dn]))return!0}if(pl(Et,zn,tn))return!0}return!1}(Le,B,We)},d.prototype.isTileClipped=function(){return!0},d}(bf);function wc(c,d){return d>0?d+2*c:c}var Ip=uc([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),xm=uc([{name:"a_projected_pos",components:3,type:"Float32"}],4),Em=(uc([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),uc([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Sv=(uc([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),uc([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ue=uc([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Qt(c,d,g){return c.sections.forEach(function(A){A.text=function(M,B,V){var Q=B.layout.get("text-transform").evaluate(V,{});return Q==="uppercase"?M=M.toLocaleUpperCase():Q==="lowercase"&&(M=M.toLocaleLowerCase()),af.applyArabicShaping&&(M=af.applyArabicShaping(M)),M}(A.text,d,g)}),c}uc([{name:"triangle",components:3,type:"Uint16"}]),uc([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),uc([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),uc([{type:"Float32",name:"offsetX"}]),uc([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Mn={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ar=function(c,d,g,A,M){var B,V,Q=8*M-A-1,me=(1<<Q)-1,Le=me>>1,We=-7,tt=g?M-1:0,Et=g?-1:1,Nt=c[d+tt];for(tt+=Et,B=Nt&(1<<-We)-1,Nt>>=-We,We+=Q;We>0;B=256*B+c[d+tt],tt+=Et,We-=8);for(V=B&(1<<-We)-1,B>>=-We,We+=A;We>0;V=256*V+c[d+tt],tt+=Et,We-=8);if(B===0)B=1-Le;else{if(B===me)return V?NaN:1/0*(Nt?-1:1);V+=Math.pow(2,A),B-=Le}return(Nt?-1:1)*V*Math.pow(2,B-A)},$r=function(c,d,g,A,M,B){var V,Q,me,Le=8*B-M-1,We=(1<<Le)-1,tt=We>>1,Et=M===23?Math.pow(2,-24)-Math.pow(2,-77):0,Nt=A?0:B-1,tn=A?1:-1,_n=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(Q=isNaN(d)?1:0,V=We):(V=Math.floor(Math.log(d)/Math.LN2),d*(me=Math.pow(2,-V))<1&&(V--,me*=2),(d+=V+tt>=1?Et/me:Et*Math.pow(2,1-tt))*me>=2&&(V++,me/=2),V+tt>=We?(Q=0,V=We):V+tt>=1?(Q=(d*me-1)*Math.pow(2,M),V+=tt):(Q=d*Math.pow(2,tt-1)*Math.pow(2,M),V=0));M>=8;c[g+Nt]=255&Q,Nt+=tn,Q/=256,M-=8);for(V=V<<M|Q,Le+=M;Le>0;c[g+Nt]=255&V,Nt+=tn,V/=256,Le-=8);c[g+Nt-tn]|=128*_n},Or=yr;function yr(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}yr.Varint=0,yr.Fixed64=1,yr.Bytes=2,yr.Fixed32=5;var Ai=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function fi(c){return c.type===yr.Bytes?c.readVarint()+c.pos:c.pos+1}function Li(c,d,g){return g?4294967296*d+(c>>>0):4294967296*(d>>>0)+(c>>>0)}function wi(c,d,g){var A=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));g.realloc(A);for(var M=g.pos-1;M>=c;M--)g.buf[M+A]=g.buf[M]}function Ni(c,d){for(var g=0;g<c.length;g++)d.writeVarint(c[g])}function Yi(c,d){for(var g=0;g<c.length;g++)d.writeSVarint(c[g])}function pi(c,d){for(var g=0;g<c.length;g++)d.writeFloat(c[g])}function Fi(c,d){for(var g=0;g<c.length;g++)d.writeDouble(c[g])}function ur(c,d){for(var g=0;g<c.length;g++)d.writeBoolean(c[g])}function Nr(c,d){for(var g=0;g<c.length;g++)d.writeFixed32(c[g])}function Ci(c,d){for(var g=0;g<c.length;g++)d.writeSFixed32(c[g])}function Hi(c,d){for(var g=0;g<c.length;g++)d.writeFixed64(c[g])}function ei(c,d){for(var g=0;g<c.length;g++)d.writeSFixed64(c[g])}function ro(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+16777216*c[d+3]}function yi(c,d,g){c[g]=d,c[g+1]=d>>>8,c[g+2]=d>>>16,c[g+3]=d>>>24}function to(c,d){return(c[d]|c[d+1]<<8|c[d+2]<<16)+(c[d+3]<<24)}function si(c,d,g){c===1&&g.readMessage(qi,d)}function qi(c,d,g){if(c===3){var A=g.readMessage(Go,{}),M=A.width,B=A.height,V=A.left,Q=A.top,me=A.advance;d.push({id:A.id,bitmap:new wf({width:M+6,height:B+6},A.bitmap),metrics:{width:M,height:B,left:V,top:Q,advance:me}})}}function Go(c,d,g){c===1?d.id=g.readVarint():c===2?d.bitmap=g.readBytes():c===3?d.width=g.readVarint():c===4?d.height=g.readVarint():c===5?d.left=g.readSVarint():c===6?d.top=g.readSVarint():c===7&&(d.advance=g.readVarint())}function fa(c){for(var d=0,g=0,A=0,M=c;A<M.length;A+=1){var B=M[A];d+=B.w*B.h,g=Math.max(g,B.w)}c.sort(function(_n,zn){return zn.h-_n.h});for(var V=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),g),h:1/0}],Q=0,me=0,Le=0,We=c;Le<We.length;Le+=1)for(var tt=We[Le],Et=V.length-1;Et>=0;Et--){var Nt=V[Et];if(!(tt.w>Nt.w||tt.h>Nt.h)){if(tt.x=Nt.x,tt.y=Nt.y,me=Math.max(me,tt.y+tt.h),Q=Math.max(Q,tt.x+tt.w),tt.w===Nt.w&&tt.h===Nt.h){var tn=V.pop();Et<V.length&&(V[Et]=tn)}else tt.h===Nt.h?(Nt.x+=tt.w,Nt.w-=tt.w):tt.w===Nt.w?(Nt.y+=tt.h,Nt.h-=tt.h):(V.push({x:Nt.x+tt.w,y:Nt.y,w:Nt.w-tt.w,h:tt.h}),Nt.y+=tt.h,Nt.h-=tt.h);break}}return{w:Q,h:me,fill:d/(Q*me)||0}}yr.prototype={destroy:function(){this.buf=null},readFields:function(c,d,g){for(g=g||this.length;this.pos<g;){var A=this.readVarint(),M=A>>3,B=this.pos;this.type=7&A,c(M,d,this),this.pos===B&&this.skip(A)}return d},readMessage:function(c,d){return this.readFields(c,d,this.readVarint()+this.pos)},readFixed32:function(){var c=ro(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=to(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=ro(this.buf,this.pos)+4294967296*ro(this.buf,this.pos+4);return this.pos+=8,c},readSFixed64:function(){var c=ro(this.buf,this.pos)+4294967296*to(this.buf,this.pos+4);return this.pos+=8,c},readFloat:function(){var c=Ar(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=Ar(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var d,g,A=this.buf;return d=127&(g=A[this.pos++]),g<128?d:(d|=(127&(g=A[this.pos++]))<<7,g<128?d:(d|=(127&(g=A[this.pos++]))<<14,g<128?d:(d|=(127&(g=A[this.pos++]))<<21,g<128?d:function(M,B,V){var Q,me,Le=V.buf;if(Q=(112&(me=Le[V.pos++]))>>4,me<128||(Q|=(127&(me=Le[V.pos++]))<<3,me<128)||(Q|=(127&(me=Le[V.pos++]))<<10,me<128)||(Q|=(127&(me=Le[V.pos++]))<<17,me<128)||(Q|=(127&(me=Le[V.pos++]))<<24,me<128)||(Q|=(1&(me=Le[V.pos++]))<<31,me<128))return Li(M,Q,B);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(g=A[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,d=this.pos;return this.pos=c,c-d>=12&&Ai?function(g,A,M){return Ai.decode(g.subarray(A,M))}(this.buf,d,c):function(g,A,M){for(var B="",V=A;V<M;){var Q,me,Le,We=g[V],tt=null,Et=We>239?4:We>223?3:We>191?2:1;if(V+Et>M)break;Et===1?We<128&&(tt=We):Et===2?(192&(Q=g[V+1]))==128&&(tt=(31&We)<<6|63&Q)<=127&&(tt=null):Et===3?(me=g[V+2],(192&(Q=g[V+1]))==128&&(192&me)==128&&((tt=(15&We)<<12|(63&Q)<<6|63&me)<=2047||tt>=55296&&tt<=57343)&&(tt=null)):Et===4&&(me=g[V+2],Le=g[V+3],(192&(Q=g[V+1]))==128&&(192&me)==128&&(192&Le)==128&&((tt=(15&We)<<18|(63&Q)<<12|(63&me)<<6|63&Le)<=65535||tt>=1114112)&&(tt=null)),tt===null?(tt=65533,Et=1):tt>65535&&(tt-=65536,B+=String.fromCharCode(tt>>>10&1023|55296),tt=56320|1023&tt),B+=String.fromCharCode(tt),V+=Et}return B}(this.buf,d,c)},readBytes:function(){var c=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,c);return this.pos=c,d},readPackedVarint:function(c,d){if(this.type!==yr.Bytes)return c.push(this.readVarint(d));var g=fi(this);for(c=c||[];this.pos<g;)c.push(this.readVarint(d));return c},readPackedSVarint:function(c){if(this.type!==yr.Bytes)return c.push(this.readSVarint());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==yr.Bytes)return c.push(this.readBoolean());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==yr.Bytes)return c.push(this.readFloat());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==yr.Bytes)return c.push(this.readDouble());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==yr.Bytes)return c.push(this.readFixed32());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==yr.Bytes)return c.push(this.readSFixed32());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==yr.Bytes)return c.push(this.readFixed64());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==yr.Bytes)return c.push(this.readSFixed64());var d=fi(this);for(c=c||[];this.pos<d;)c.push(this.readSFixed64());return c},skip:function(c){var d=7&c;if(d===yr.Varint)for(;this.buf[this.pos++]>127;);else if(d===yr.Bytes)this.pos=this.readVarint()+this.pos;else if(d===yr.Fixed32)this.pos+=4;else{if(d!==yr.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(c,d){this.writeVarint(c<<3|d)},realloc:function(c){for(var d=this.length||16;d<this.pos+c;)d*=2;if(d!==this.length){var g=new Uint8Array(d);g.set(this.buf),this.buf=g,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),yi(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),yi(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),yi(this.buf,-1&c,this.pos),yi(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),yi(this.buf,-1&c,this.pos),yi(this.buf,Math.floor(c*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(d,g){var A,M;if(d>=0?(A=d%4294967296|0,M=d/4294967296|0):(M=~(-d/4294967296),4294967295^(A=~(-d%4294967296))?A=A+1|0:(A=0,M=M+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(B,V,Q){Q.buf[Q.pos++]=127&B|128,B>>>=7,Q.buf[Q.pos++]=127&B|128,B>>>=7,Q.buf[Q.pos++]=127&B|128,B>>>=7,Q.buf[Q.pos++]=127&B|128,Q.buf[Q.pos]=127&(B>>>=7)}(A,0,g),function(B,V){var Q=(7&B)<<4;V.buf[V.pos++]|=Q|((B>>>=3)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B|((B>>>=7)?128:0),B&&(V.buf[V.pos++]=127&B)))))}(M,g)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var d=this.pos;this.pos=function(A,M,B){for(var V,Q,me=0;me<M.length;me++){if((V=M.charCodeAt(me))>55295&&V<57344){if(!Q){V>56319||me+1===M.length?(A[B++]=239,A[B++]=191,A[B++]=189):Q=V;continue}if(V<56320){A[B++]=239,A[B++]=191,A[B++]=189,Q=V;continue}V=Q-55296<<10|V-56320|65536,Q=null}else Q&&(A[B++]=239,A[B++]=191,A[B++]=189,Q=null);V<128?A[B++]=V:(V<2048?A[B++]=V>>6|192:(V<65536?A[B++]=V>>12|224:(A[B++]=V>>18|240,A[B++]=V>>12&63|128),A[B++]=V>>6&63|128),A[B++]=63&V|128)}return B}(this.buf,c,this.pos);var g=this.pos-d;g>=128&&wi(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g},writeFloat:function(c){this.realloc(4),$r(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),$r(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var d=c.length;this.writeVarint(d),this.realloc(d);for(var g=0;g<d;g++)this.buf[this.pos++]=c[g]},writeRawMessage:function(c,d){this.pos++;var g=this.pos;c(d,this);var A=this.pos-g;A>=128&&wi(g,A,this),this.pos=g-1,this.writeVarint(A),this.pos+=A},writeMessage:function(c,d,g){this.writeTag(c,yr.Bytes),this.writeRawMessage(d,g)},writePackedVarint:function(c,d){d.length&&this.writeMessage(c,Ni,d)},writePackedSVarint:function(c,d){d.length&&this.writeMessage(c,Yi,d)},writePackedBoolean:function(c,d){d.length&&this.writeMessage(c,ur,d)},writePackedFloat:function(c,d){d.length&&this.writeMessage(c,pi,d)},writePackedDouble:function(c,d){d.length&&this.writeMessage(c,Fi,d)},writePackedFixed32:function(c,d){d.length&&this.writeMessage(c,Nr,d)},writePackedSFixed32:function(c,d){d.length&&this.writeMessage(c,Ci,d)},writePackedFixed64:function(c,d){d.length&&this.writeMessage(c,Hi,d)},writePackedSFixed64:function(c,d){d.length&&this.writeMessage(c,ei,d)},writeBytesField:function(c,d){this.writeTag(c,yr.Bytes),this.writeBytes(d)},writeFixed32Field:function(c,d){this.writeTag(c,yr.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(c,d){this.writeTag(c,yr.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(c,d){this.writeTag(c,yr.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(c,d){this.writeTag(c,yr.Fixed64),this.writeSFixed64(d)},writeVarintField:function(c,d){this.writeTag(c,yr.Varint),this.writeVarint(d)},writeSVarintField:function(c,d){this.writeTag(c,yr.Varint),this.writeSVarint(d)},writeStringField:function(c,d){this.writeTag(c,yr.Bytes),this.writeString(d)},writeFloatField:function(c,d){this.writeTag(c,yr.Fixed32),this.writeFloat(d)},writeDoubleField:function(c,d){this.writeTag(c,yr.Fixed64),this.writeDouble(d)},writeBooleanField:function(c,d){this.writeVarintField(c,!!d)}};var $i=function(c,d){var g=d.pixelRatio,A=d.version,M=d.stretchX,B=d.stretchY,V=d.content;this.paddedRect=c,this.pixelRatio=g,this.stretchX=M,this.stretchY=B,this.content=V,this.version=A},_i={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};_i.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},_i.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},_i.tlbr.get=function(){return this.tl.concat(this.br)},_i.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties($i.prototype,_i);var qr=function(c,d){var g={},A={};this.haveRenderCallbacks=[];var M=[];this.addImages(c,g,M),this.addImages(d,A,M);var B=fa(M),V=new uu({width:B.w||1,height:B.h||1});for(var Q in c){var me=c[Q],Le=g[Q].paddedRect;uu.copy(me.data,V,{x:0,y:0},{x:Le.x+1,y:Le.y+1},me.data)}for(var We in d){var tt=d[We],Et=A[We].paddedRect,Nt=Et.x+1,tn=Et.y+1,_n=tt.data.width,zn=tt.data.height;uu.copy(tt.data,V,{x:0,y:0},{x:Nt,y:tn},tt.data),uu.copy(tt.data,V,{x:0,y:zn-1},{x:Nt,y:tn-1},{width:_n,height:1}),uu.copy(tt.data,V,{x:0,y:0},{x:Nt,y:tn+zn},{width:_n,height:1}),uu.copy(tt.data,V,{x:_n-1,y:0},{x:Nt-1,y:tn},{width:1,height:zn}),uu.copy(tt.data,V,{x:0,y:0},{x:Nt+_n,y:tn},{width:1,height:zn})}this.image=V,this.iconPositions=g,this.patternPositions=A};qr.prototype.addImages=function(c,d,g){for(var A in c){var M=c[A],B={x:0,y:0,w:M.data.width+2,h:M.data.height+2};g.push(B),d[A]=new $i(B,M),M.hasRenderCallback&&this.haveRenderCallbacks.push(A)}},qr.prototype.patchUpdatedImages=function(c,d){for(var g in c.dispatchRenderCallbacks(this.haveRenderCallbacks),c.updatedImages)this.patchUpdatedImage(this.iconPositions[g],c.getImage(g),d),this.patchUpdatedImage(this.patternPositions[g],c.getImage(g),d)},qr.prototype.patchUpdatedImage=function(c,d,g){if(c&&d&&c.version!==d.version){c.version=d.version;var A=c.tl;g.update(d.data,void 0,{x:A[0],y:A[1]})}},io("ImagePosition",$i),io("ImageAtlas",qr);var Zo={horizontal:1,vertical:2,horizontalOnly:3},Ua=function(){this.scale=1,this.fontStack="",this.imageName=null};Ua.forText=function(c,d){var g=new Ua;return g.scale=c||1,g.fontStack=d,g},Ua.forImage=function(c){var d=new Ua;return d.imageName=c,d};var oo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Pa(c,d,g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n){var zn,Dn=oo.fromFeature(c,M);tt===Zo.vertical&&Dn.verticalizePunctuation();var cr=af.processBidirectionalText,_r=af.processStyledBidirectionalText;if(cr&&Dn.sections.length===1){zn=[];for(var Ir=0,Br=cr(Dn.toString(),Xl(Dn,Le,B,d,A,Nt,tn));Ir<Br.length;Ir+=1){var jr=Br[Ir],bi=new oo;bi.text=jr,bi.sections=Dn.sections;for(var Zi=0;Zi<jr.length;Zi++)bi.sectionIndex.push(0);zn.push(bi)}}else if(_r){zn=[];for(var Ro=0,ki=_r(Dn.text,Dn.sectionIndex,Xl(Dn,Le,B,d,A,Nt,tn));Ro<ki.length;Ro+=1){var zo=ki[Ro],ao=new oo;ao.text=zo[0],ao.sectionIndex=zo[1],ao.sections=Dn.sections,zn.push(ao)}}else zn=function(_o,Za){for(var pa=[],Oa=_o.text,$o=0,Es=0,Tl=Za;Es<Tl.length;Es+=1){var Vl=Tl[Es];pa.push(_o.substring($o,Vl)),$o=Vl}return $o<Oa.length&&pa.push(_o.substring($o,Oa.length)),pa}(Dn,Xl(Dn,Le,B,d,A,Nt,tn));var xa=[],Mo={positionedLines:xa,text:Dn.toString(),top:We[1],bottom:We[1],left:We[0],right:We[0],writingMode:tt,iconsInText:!1,verticalizable:!1};return function(_o,Za,pa,Oa,$o,Es,Tl,Vl,Hl,wl,ql,jc){for(var nu=0,fl=-17,Cc=0,Vu=0,ac=Vl==="right"?1:Vl==="left"?0:.5,Oc=0,Ya=0,$s=$o;Ya<$s.length;Ya+=1){var Zs=$s[Ya];Zs.trim();var ms=Zs.getMaxScale(),Hu=24*(ms-1),du={positionedGlyphs:[],lineOffset:0};_o.positionedLines[Oc]=du;var il=du.positionedGlyphs,sc=0;if(Zs.length()){for(var Al=0;Al<Zs.length();Al++){var Ss=Zs.getSection(Al),Bp=Zs.getSectionIndex(Al),uf=Zs.getCharCode(Al),Zu=0,Ql=null,ch=null,Rf=null,ap=24,Dd=!(Hl===Zo.horizontal||!ql&&!Eu(uf)||ql&&(da[uf]||(od=uf,Xi.Arabic(od)||Xi["Arabic Supplement"](od)||Xi["Arabic Extended-A"](od)||Xi["Arabic Presentation Forms-A"](od)||Xi["Arabic Presentation Forms-B"](od))));if(Ss.imageName){var wm=Oa[Ss.imageName];if(!wm)continue;Rf=Ss.imageName,_o.iconsInText=_o.iconsInText||!0,ch=wm.paddedRect;var Nd=wm.displaySize;Ss.scale=24*Ss.scale/jc,Zu=Hu+(24-Nd[1]*Ss.scale),ap=(Ql={width:Nd[0],height:Nd[1],left:1,top:-3,advance:Dd?Nd[1]:Nd[0]}).advance;var sp=Dd?Nd[0]*Ss.scale-24*ms:Nd[1]*Ss.scale-24*ms;sp>0&&sp>sc&&(sc=sp)}else{var Am=pa[Ss.fontStack],Cm=Am&&Am[uf];if(Cm&&Cm.rect)ch=Cm.rect,Ql=Cm.metrics;else{var h0=Za[Ss.fontStack],Om=h0&&h0[uf];if(!Om)continue;Ql=Om.metrics}Zu=24*(ms-Ss.scale)}Dd?(_o.verticalizable=!0,il.push({glyph:uf,imageName:Rf,x:nu,y:fl+Zu,vertical:Dd,scale:Ss.scale,fontStack:Ss.fontStack,sectionIndex:Bp,metrics:Ql,rect:ch}),nu+=ap*Ss.scale+wl):(il.push({glyph:uf,imageName:Rf,x:nu,y:fl+Zu,vertical:Dd,scale:Ss.scale,fontStack:Ss.fontStack,sectionIndex:Bp,metrics:Ql,rect:ch}),nu+=Ql.advance*Ss.scale+wl)}il.length!==0&&(Cc=Math.max(nu-wl,Cc),vl(il,0,il.length-1,ac,sc)),nu=0;var wy=Es*ms+sc;du.lineOffset=Math.max(sc,Hu),fl+=wy,Vu=Math.max(wy,Vu),++Oc}else fl+=Es,++Oc}var od,Fp=fl- -17,W0=Js(Tl),d0=W0.horizontalAlign,Rm=W0.verticalAlign;(function(kp,Mm,Tv,zp,Pm,Im,p0,G0,Ay){var X0,m0=(Mm-Tv)*Pm;X0=Im!==p0?-G0*zp- -17:(-zp*Ay+.5)*p0;for(var Lm=0,v0=kp;Lm<v0.length;Lm+=1)for(var lp=0,g0=v0[Lm].positionedGlyphs;lp<g0.length;lp+=1){var Up=g0[lp];Up.x+=m0,Up.y+=X0}})(_o.positionedLines,ac,d0,Rm,Cc,Vu,Es,Fp,$o.length),_o.top+=-Rm*Fp,_o.bottom=_o.top+Fp,_o.left+=-d0*Cc,_o.right=_o.left+Cc}(Mo,d,g,A,zn,V,Q,me,tt,Le,Et,_n),!function(_o){for(var Za=0,pa=_o;Za<pa.length;Za+=1)if(pa[Za].positionedGlyphs.length!==0)return!1;return!0}(xa)&&Mo}oo.fromFeature=function(c,d){for(var g=new oo,A=0;A<c.sections.length;A++){var M=c.sections[A];M.image?g.addImageSection(M):g.addTextSection(M,d)}return g},oo.prototype.length=function(){return this.text.length},oo.prototype.getSection=function(c){return this.sections[this.sectionIndex[c]]},oo.prototype.getSectionIndex=function(c){return this.sectionIndex[c]},oo.prototype.getCharCode=function(c){return this.text.charCodeAt(c)},oo.prototype.verticalizePunctuation=function(){this.text=function(c){for(var d="",g=0;g<c.length;g++){var A=c.charCodeAt(g+1)||null,M=c.charCodeAt(g-1)||null;d+=A&&Ep(A)&&!Mn[c[g+1]]||M&&Ep(M)&&!Mn[c[g-1]]||!Mn[c[g]]?c[g]:Mn[c[g]]}return d}(this.text)},oo.prototype.trim=function(){for(var c=0,d=0;d<this.text.length&&da[this.text.charCodeAt(d)];d++)c++;for(var g=this.text.length,A=this.text.length-1;A>=0&&A>=c&&da[this.text.charCodeAt(A)];A--)g--;this.text=this.text.substring(c,g),this.sectionIndex=this.sectionIndex.slice(c,g)},oo.prototype.substring=function(c,d){var g=new oo;return g.text=this.text.substring(c,d),g.sectionIndex=this.sectionIndex.slice(c,d),g.sections=this.sections,g},oo.prototype.toString=function(){return this.text},oo.prototype.getMaxScale=function(){var c=this;return this.sectionIndex.reduce(function(d,g){return Math.max(d,c.sections[g].scale)},0)},oo.prototype.addTextSection=function(c,d){this.text+=c.text,this.sections.push(Ua.forText(c.scale,c.fontStack||d));for(var g=this.sections.length-1,A=0;A<c.text.length;++A)this.sectionIndex.push(g)},oo.prototype.addImageSection=function(c){var d=c.image?c.image.name:"";if(d.length!==0){var g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Ua.forImage(d)),this.sectionIndex.push(this.sections.length-1)):gt("Reached maximum number of images 6401")}else gt("Can't add FormattedSection with an empty image.")},oo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var da={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oa={};function gs(c,d,g,A,M,B){if(d.imageName){var V=A[d.imageName];return V?V.displaySize[0]*d.scale*24/B+M:0}var Q=g[d.fontStack],me=Q&&Q[c];return me?me.metrics.advance*d.scale+M:0}function jl(c,d,g,A){var M=Math.pow(c-d,2);return A?c<d?M/2:2*M:M+Math.abs(g)*g}function eu(c,d,g){var A=0;return c===10&&(A-=1e4),g&&(A+=150),c!==40&&c!==65288||(A+=50),d!==41&&d!==65289||(A+=50),A}function ja(c,d,g,A,M,B){for(var V=null,Q=jl(d,g,M,B),me=0,Le=A;me<Le.length;me+=1){var We=Le[me],tt=jl(d-We.x,g,M,B)+We.badness;tt<=Q&&(V=We,Q=tt)}return{index:c,x:d,priorBreak:V,badness:Q}}function Xl(c,d,g,A,M,B,V){if(B!=="point")return[];if(!c)return[];for(var Q,me=[],Le=function(zn,Dn,cr,_r,Ir,Br){for(var jr=0,bi=0;bi<zn.length();bi++){var Zi=zn.getSection(bi);jr+=gs(zn.getCharCode(bi),Zi,_r,Ir,Dn,Br)}return jr/Math.max(1,Math.ceil(jr/cr))}(c,d,g,A,M,V),We=c.text.indexOf("\u200B")>=0,tt=0,Et=0;Et<c.length();Et++){var Nt=c.getSection(Et),tn=c.getCharCode(Et);if(da[tn]||(tt+=gs(tn,Nt,A,M,d,V)),Et<c.length()-1){var _n=!((Q=tn)<11904||!(Xi["Bopomofo Extended"](Q)||Xi.Bopomofo(Q)||Xi["CJK Compatibility Forms"](Q)||Xi["CJK Compatibility Ideographs"](Q)||Xi["CJK Compatibility"](Q)||Xi["CJK Radicals Supplement"](Q)||Xi["CJK Strokes"](Q)||Xi["CJK Symbols and Punctuation"](Q)||Xi["CJK Unified Ideographs Extension A"](Q)||Xi["CJK Unified Ideographs"](Q)||Xi["Enclosed CJK Letters and Months"](Q)||Xi["Halfwidth and Fullwidth Forms"](Q)||Xi.Hiragana(Q)||Xi["Ideographic Description Characters"](Q)||Xi["Kangxi Radicals"](Q)||Xi["Katakana Phonetic Extensions"](Q)||Xi.Katakana(Q)||Xi["Vertical Forms"](Q)||Xi["Yi Radicals"](Q)||Xi["Yi Syllables"](Q)));(oa[tn]||_n||Nt.imageName)&&me.push(ja(Et+1,tt,Le,me,eu(tn,c.getCharCode(Et+1),_n&&We),!1))}}return function zn(Dn){return Dn?zn(Dn.priorBreak).concat(Dn.index):[]}(ja(c.length(),tt,Le,me,0,!0))}function Js(c){var d=.5,g=.5;switch(c){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:d,verticalAlign:g}}function vl(c,d,g,A,M){if(A||M)for(var B=c[g],V=(c[g].x+B.metrics.advance*B.scale)*A,Q=d;Q<=g;Q++)c[Q].x-=V,c[Q].y+=M}function Yl(c,d,g,A,M,B){var V,Q=c.image;if(Q.content){var me=Q.content,Le=Q.pixelRatio||1;V=[me[0]/Le,me[1]/Le,Q.displaySize[0]-me[2]/Le,Q.displaySize[1]-me[3]/Le]}var We,tt,Et,Nt,tn=d.left*B,_n=d.right*B;g==="width"||g==="both"?(Nt=M[0]+tn-A[3],tt=M[0]+_n+A[1]):tt=(Nt=M[0]+(tn+_n-Q.displaySize[0])/2)+Q.displaySize[0];var zn=d.top*B,Dn=d.bottom*B;return g==="height"||g==="both"?(We=M[1]+zn-A[0],Et=M[1]+Dn+A[2]):Et=(We=M[1]+(zn+Dn-Q.displaySize[1])/2)+Q.displaySize[1],{image:Q,top:We,right:tt,bottom:Et,left:Nt,collisionPadding:V}}oa[10]=!0,oa[32]=!0,oa[38]=!0,oa[40]=!0,oa[41]=!0,oa[43]=!0,oa[45]=!0,oa[47]=!0,oa[173]=!0,oa[183]=!0,oa[8203]=!0,oa[8208]=!0,oa[8211]=!0,oa[8231]=!0;var ps=function(c){function d(g,A,M,B){c.call(this,g,A),this.angle=M,B!==void 0&&(this.segment=B)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(se);function $l(c,d){var g=d.expression;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new Ta(c+1))};if(g.kind==="source")return{kind:"source"};for(var A=g.zoomStops,M=g.interpolationType,B=0;B<A.length&&A[B]<=c;)B++;for(var V=B=Math.max(0,B-1);V<A.length&&A[V]<c+1;)V++;V=Math.min(A.length-1,V);var Q=A[B],me=A[V];return g.kind==="composite"?{kind:"composite",minZoom:Q,maxZoom:me,interpolationType:M}:{kind:"camera",minZoom:Q,maxZoom:me,minSize:g.evaluate(new Ta(Q)),maxSize:g.evaluate(new Ta(me)),interpolationType:M}}function Kl(c,d,g){var A=d.uSize,M=g.lowerSize;return c.kind==="source"?M/128:c.kind==="composite"?Xs(M/128,g.upperSize/128,d.uSizeT):A}function dc(c,d){var g=0,A=0;if(c.kind==="constant")A=c.layoutSize;else if(c.kind!=="source"){var M=c.interpolationType,B=M?Be(zl.interpolationFactor(M,d,c.minZoom,c.maxZoom),0,1):0;c.kind==="camera"?A=Xs(c.minSize,c.maxSize,B):g=B}return{uSizeT:g,uSize:A}}io("Anchor",ps);var Ca=Object.freeze({__proto__:null,getSizeData:$l,evaluateSizeForFeature:Kl,evaluateSizeForZoom:dc,SIZE_PACK_FACTOR:128});function Uc(c,d,g,A,M){if(d.segment===void 0)return!0;for(var B=d,V=d.segment+1,Q=0;Q>-g/2;){if(--V<0)return!1;Q-=c[V].dist(B),B=c[V]}Q+=c[V].dist(c[V+1]),V++;for(var me=[],Le=0;Q<g/2;){var We=c[V],tt=c[V+1];if(!tt)return!1;var Et=c[V-1].angleTo(We)-We.angleTo(tt);for(Et=Math.abs((Et+3*Math.PI)%(2*Math.PI)-Math.PI),me.push({distance:Q,angleDelta:Et}),Le+=Et;Q-me[0].distance>A;)Le-=me.shift().angleDelta;if(Le>M)return!1;V++,Q+=We.dist(tt)}return!0}function Ms(c){for(var d=0,g=0;g<c.length-1;g++)d+=c[g].dist(c[g+1]);return d}function Yo(c,d,g){return c?.6*d*g:0}function Ia(c,d){return Math.max(c?c.right-c.left:0,d?d.right-d.left:0)}function us(c,d,g,A,M,B){for(var V=Yo(g,M,B),Q=Ia(g,A)*B,me=0,Le=Ms(c)/2,We=0;We<c.length-1;We++){var tt=c[We],Et=c[We+1],Nt=tt.dist(Et);if(me+Nt>Le){var tn=(Le-me)/Nt,_n=Xs(tt.x,Et.x,tn),zn=Xs(tt.y,Et.y,tn),Dn=new ps(_n,zn,Et.angleTo(tt),We);return Dn._round(),!V||Uc(c,Dn,Q,V,d)?Dn:void 0}me+=Nt}}function Dl(c,d,g,A,M,B,V,Q,me){var Le=Yo(A,B,V),We=Ia(A,M),tt=We*V,Et=c[0].x===0||c[0].x===me||c[0].y===0||c[0].y===me;return d-tt<d/4&&(d=tt+d/4),function Nt(tn,_n,zn,Dn,cr,_r,Ir,Br,jr){for(var bi=_r/2,Zi=Ms(tn),Ro=0,ki=_n-zn,zo=[],ao=0;ao<tn.length-1;ao++){for(var xa=tn[ao],Mo=tn[ao+1],_o=xa.dist(Mo),Za=Mo.angleTo(xa);ki+zn<Ro+_o;){var pa=((ki+=zn)-Ro)/_o,Oa=Xs(xa.x,Mo.x,pa),$o=Xs(xa.y,Mo.y,pa);if(Oa>=0&&Oa<jr&&$o>=0&&$o<jr&&ki-bi>=0&&ki+bi<=Zi){var Es=new ps(Oa,$o,Za,ao);Es._round(),Dn&&!Uc(tn,Es,_r,Dn,cr)||zo.push(Es)}}Ro+=_o}return Br||zo.length||Ir||(zo=Nt(tn,Ro/2,zn,Dn,cr,_r,Ir,!0,jr)),zo}(c,Et?d/2*Q%d:(We/2+2*B)*V*Q%d,d,Le,g,tt,Et,!1,me)}function hu(c,d,g,A,M){for(var B=[],V=0;V<c.length;V++)for(var Q=c[V],me=void 0,Le=0;Le<Q.length-1;Le++){var We=Q[Le],tt=Q[Le+1];We.x<d&&tt.x<d||(We.x<d?We=new se(d,We.y+(d-We.x)/(tt.x-We.x)*(tt.y-We.y))._round():tt.x<d&&(tt=new se(d,We.y+(d-We.x)/(tt.x-We.x)*(tt.y-We.y))._round()),We.y<g&&tt.y<g||(We.y<g?We=new se(We.x+(g-We.y)/(tt.y-We.y)*(tt.x-We.x),g)._round():tt.y<g&&(tt=new se(We.x+(g-We.y)/(tt.y-We.y)*(tt.x-We.x),g)._round()),We.x>=A&&tt.x>=A||(We.x>=A?We=new se(A,We.y+(A-We.x)/(tt.x-We.x)*(tt.y-We.y))._round():tt.x>=A&&(tt=new se(A,We.y+(A-We.x)/(tt.x-We.x)*(tt.y-We.y))._round()),We.y>=M&&tt.y>=M||(We.y>=M?We=new se(We.x+(M-We.y)/(tt.y-We.y)*(tt.x-We.x),M)._round():tt.y>=M&&(tt=new se(We.x+(M-We.y)/(tt.y-We.y)*(tt.x-We.x),M)._round()),me&&We.equals(me[me.length-1])||B.push(me=[We]),me.push(tt)))))}return B}function dn(c,d,g,A){var M=[],B=c.image,V=B.pixelRatio,Q=B.paddedRect.w-2,me=B.paddedRect.h-2,Le=c.right-c.left,We=c.bottom-c.top,tt=B.stretchX||[[0,Q]],Et=B.stretchY||[[0,me]],Nt=function(Oa,$o){return Oa+$o[1]-$o[0]},tn=tt.reduce(Nt,0),_n=Et.reduce(Nt,0),zn=Q-tn,Dn=me-_n,cr=0,_r=tn,Ir=0,Br=_n,jr=0,bi=zn,Zi=0,Ro=Dn;if(B.content&&A){var ki=B.content;cr=Pr(tt,0,ki[0]),Ir=Pr(Et,0,ki[1]),_r=Pr(tt,ki[0],ki[2]),Br=Pr(Et,ki[1],ki[3]),jr=ki[0]-cr,Zi=ki[1]-Ir,bi=ki[2]-ki[0]-_r,Ro=ki[3]-ki[1]-Br}var zo=function(Oa,$o,Es,Tl){var Vl=lo(Oa.stretch-cr,_r,Le,c.left),Hl=Fa(Oa.fixed-jr,bi,Oa.stretch,tn),wl=lo($o.stretch-Ir,Br,We,c.top),ql=Fa($o.fixed-Zi,Ro,$o.stretch,_n),jc=lo(Es.stretch-cr,_r,Le,c.left),nu=Fa(Es.fixed-jr,bi,Es.stretch,tn),fl=lo(Tl.stretch-Ir,Br,We,c.top),Cc=Fa(Tl.fixed-Zi,Ro,Tl.stretch,_n),Vu=new se(Vl,wl),ac=new se(jc,wl),Oc=new se(jc,fl),Ya=new se(Vl,fl),$s=new se(Hl/V,ql/V),Zs=new se(nu/V,Cc/V),ms=d*Math.PI/180;if(ms){var Hu=Math.sin(ms),du=Math.cos(ms),il=[du,-Hu,Hu,du];Vu._matMult(il),ac._matMult(il),Ya._matMult(il),Oc._matMult(il)}var sc=Oa.stretch+Oa.fixed,Al=$o.stretch+$o.fixed;return{tl:Vu,tr:ac,bl:Ya,br:Oc,tex:{x:B.paddedRect.x+1+sc,y:B.paddedRect.y+1+Al,w:Es.stretch+Es.fixed-sc,h:Tl.stretch+Tl.fixed-Al},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$s,pixelOffsetBR:Zs,minFontScaleX:bi/V/Le,minFontScaleY:Ro/V/We,isSDF:g}};if(A&&(B.stretchX||B.stretchY))for(var ao=pr(tt,zn,tn),xa=pr(Et,Dn,_n),Mo=0;Mo<ao.length-1;Mo++)for(var _o=ao[Mo],Za=ao[Mo+1],pa=0;pa<xa.length-1;pa++)M.push(zo(_o,xa[pa],Za,xa[pa+1]));else M.push(zo({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Q+1},{fixed:0,stretch:me+1}));return M}function Pr(c,d,g){for(var A=0,M=0,B=c;M<B.length;M+=1){var V=B[M];A+=Math.max(d,Math.min(g,V[1]))-Math.max(d,Math.min(g,V[0]))}return A}function pr(c,d,g){for(var A=[{fixed:-1,stretch:0}],M=0,B=c;M<B.length;M+=1){var V=B[M],Q=V[0],me=V[1],Le=A[A.length-1];A.push({fixed:Q-Le.stretch,stretch:Le.stretch}),A.push({fixed:Q-Le.stretch,stretch:Le.stretch+(me-Q)})}return A.push({fixed:d+1,stretch:g}),A}function lo(c,d,g,A){return c/d*g+A}function Fa(c,d,g,A){return c-d*g/A}var as=function(c,d,g,A,M,B,V,Q,me,Le){if(this.boxStartIndex=c.length,me){var We=B.top,tt=B.bottom,Et=B.collisionPadding;Et&&(We-=Et[1],tt+=Et[3]);var Nt=tt-We;Nt>0&&(Nt=Math.max(10,Nt),this.circleDiameter=Nt)}else{var tn=B.top*V-Q,_n=B.bottom*V+Q,zn=B.left*V-Q,Dn=B.right*V+Q,cr=B.collisionPadding;if(cr&&(zn-=cr[0]*V,tn-=cr[1]*V,Dn+=cr[2]*V,_n+=cr[3]*V),Le){var _r=new se(zn,tn),Ir=new se(Dn,tn),Br=new se(zn,_n),jr=new se(Dn,_n),bi=Le*Math.PI/180;_r._rotate(bi),Ir._rotate(bi),Br._rotate(bi),jr._rotate(bi),zn=Math.min(_r.x,Ir.x,Br.x,jr.x),Dn=Math.max(_r.x,Ir.x,Br.x,jr.x),tn=Math.min(_r.y,Ir.y,Br.y,jr.y),_n=Math.max(_r.y,Ir.y,Br.y,jr.y)}c.emplaceBack(d.x,d.y,zn,tn,Dn,_n,g,A,M)}this.boxEndIndex=c.length},It=function(c,d){if(c===void 0&&(c=[]),d===void 0&&(d=rn),this.data=c,this.length=this.data.length,this.compare=d,this.length>0)for(var g=(this.length>>1)-1;g>=0;g--)this._down(g)};function rn(c,d){return c<d?-1:c>d?1:0}function In(c,d,g){d===void 0&&(d=1),g===void 0&&(g=!1);for(var A=1/0,M=1/0,B=-1/0,V=-1/0,Q=c[0],me=0;me<Q.length;me++){var Le=Q[me];(!me||Le.x<A)&&(A=Le.x),(!me||Le.y<M)&&(M=Le.y),(!me||Le.x>B)&&(B=Le.x),(!me||Le.y>V)&&(V=Le.y)}var We=Math.min(B-A,V-M),tt=We/2,Et=new It([],wr);if(We===0)return new se(A,M);for(var Nt=A;Nt<B;Nt+=We)for(var tn=M;tn<V;tn+=We)Et.push(new br(Nt+tt,tn+tt,tt,c));for(var _n=function(cr){for(var _r=0,Ir=0,Br=0,jr=cr[0],bi=0,Zi=jr.length,Ro=Zi-1;bi<Zi;Ro=bi++){var ki=jr[bi],zo=jr[Ro],ao=ki.x*zo.y-zo.x*ki.y;Ir+=(ki.x+zo.x)*ao,Br+=(ki.y+zo.y)*ao,_r+=3*ao}return new br(Ir/_r,Br/_r,0,cr)}(c),zn=Et.length;Et.length;){var Dn=Et.pop();(Dn.d>_n.d||!_n.d)&&(_n=Dn,g&&console.log("found best %d after %d probes",Math.round(1e4*Dn.d)/1e4,zn)),Dn.max-_n.d<=d||(Et.push(new br(Dn.p.x-(tt=Dn.h/2),Dn.p.y-tt,tt,c)),Et.push(new br(Dn.p.x+tt,Dn.p.y-tt,tt,c)),Et.push(new br(Dn.p.x-tt,Dn.p.y+tt,tt,c)),Et.push(new br(Dn.p.x+tt,Dn.p.y+tt,tt,c)),zn+=4)}return g&&(console.log("num probes: "+zn),console.log("best distance: "+_n.d)),_n.p}function wr(c,d){return d.max-c.max}function br(c,d,g,A){this.p=new se(c,d),this.h=g,this.d=function(M,B){for(var V=!1,Q=1/0,me=0;me<B.length;me++)for(var Le=B[me],We=0,tt=Le.length,Et=tt-1;We<tt;Et=We++){var Nt=Le[We],tn=Le[Et];Nt.y>M.y!=tn.y>M.y&&M.x<(tn.x-Nt.x)*(M.y-Nt.y)/(tn.y-Nt.y)+Nt.x&&(V=!V),Q=Math.min(Q,Sf(M,Nt,tn))}return(V?1:-1)*Math.sqrt(Q)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}It.prototype.push=function(c){this.data.push(c),this.length++,this._up(this.length-1)},It.prototype.pop=function(){if(this.length!==0){var c=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),c}},It.prototype.peek=function(){return this.data[0]},It.prototype._up=function(c){for(var d=this.data,g=this.compare,A=d[c];c>0;){var M=c-1>>1,B=d[M];if(g(A,B)>=0)break;d[c]=B,c=M}d[c]=A},It.prototype._down=function(c){for(var d=this.data,g=this.compare,A=this.length>>1,M=d[c];c<A;){var B=1+(c<<1),V=d[B],Q=B+1;if(Q<this.length&&g(d[Q],V)<0&&(B=Q,V=d[Q]),g(V,M)>=0)break;d[c]=V,c=B}d[c]=M};var Vn=Number.POSITIVE_INFINITY;function Kn(c,d){return d[1]!==Vn?function(g,A,M){var B=0,V=0;switch(A=Math.abs(A),M=Math.abs(M),g){case"top-right":case"top-left":case"top":V=M-7;break;case"bottom-right":case"bottom-left":case"bottom":V=7-M}switch(g){case"top-right":case"bottom-right":case"right":B=-A;break;case"top-left":case"bottom-left":case"left":B=A}return[B,V]}(c,d[0],d[1]):function(g,A){var M=0,B=0;A<0&&(A=0);var V=A/Math.sqrt(2);switch(g){case"top-right":case"top-left":B=V-7;break;case"bottom-right":case"bottom-left":B=7-V;break;case"bottom":B=7-A;break;case"top":B=A-7}switch(g){case"top-right":case"bottom-right":M=-V;break;case"top-left":case"bottom-left":M=V;break;case"left":M=A;break;case"right":M=-A}return[M,B]}(c,d[0])}function nr(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function bn(c,d,g,A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn){var _n=function(Ir,Br,jr,bi,Zi,Ro,ki,zo){for(var ao=bi.layout.get("text-rotate").evaluate(Ro,{})*Math.PI/180,xa=[],Mo=0,_o=Br.positionedLines;Mo<_o.length;Mo+=1)for(var Za=_o[Mo],pa=0,Oa=Za.positionedGlyphs;pa<Oa.length;pa+=1){var $o=Oa[pa];if($o.rect){var Es=$o.rect||{},Tl=4,Vl=!0,Hl=1,wl=0,ql=(Zi||zo)&&$o.vertical,jc=$o.metrics.advance*$o.scale/2;if(zo&&Br.verticalizable&&(wl=Za.lineOffset/2-($o.imageName?-(24-$o.metrics.width*$o.scale)/2:24*($o.scale-1))),$o.imageName){var nu=ki[$o.imageName];Vl=nu.sdf,Tl=1/(Hl=nu.pixelRatio)}var fl=Zi?[$o.x+jc,$o.y]:[0,0],Cc=Zi?[0,0]:[$o.x+jc+jr[0],$o.y+jr[1]-wl],Vu=[0,0];ql&&(Vu=Cc,Cc=[0,0]);var ac=($o.metrics.left-Tl)*$o.scale-jc+Cc[0],Oc=(-$o.metrics.top-Tl)*$o.scale+Cc[1],Ya=ac+Es.w*$o.scale/Hl,$s=Oc+Es.h*$o.scale/Hl,Zs=new se(ac,Oc),ms=new se(Ya,Oc),Hu=new se(ac,$s),du=new se(Ya,$s);if(ql){var il=new se(-jc,jc- -17),sc=-Math.PI/2,Al=12-jc,Ss=new se(22-Al,-($o.imageName?Al:0)),Bp=new(Function.prototype.bind.apply(se,[null].concat(Vu)));Zs._rotateAround(sc,il)._add(Ss)._add(Bp),ms._rotateAround(sc,il)._add(Ss)._add(Bp),Hu._rotateAround(sc,il)._add(Ss)._add(Bp),du._rotateAround(sc,il)._add(Ss)._add(Bp)}if(ao){var uf=Math.sin(ao),Zu=Math.cos(ao),Ql=[Zu,-uf,uf,Zu];Zs._matMult(Ql),ms._matMult(Ql),Hu._matMult(Ql),du._matMult(Ql)}var ch=new se(0,0),Rf=new se(0,0);xa.push({tl:Zs,tr:ms,bl:Hu,br:du,tex:Es,writingMode:Br.writingMode,glyphOffset:fl,sectionIndex:$o.sectionIndex,isSDF:Vl,pixelOffsetTL:ch,pixelOffsetBR:Rf,minFontScaleX:0,minFontScaleY:0})}}return xa}(0,g,Q,M,B,V,A,c.allowVerticalPlacement),zn=c.textSizeData,Dn=null;zn.kind==="source"?(Dn=[128*M.layout.get("text-size").evaluate(V,{})])[0]>32640&&gt(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):zn.kind==="composite"&&((Dn=[128*Nt.compositeTextSizes[0].evaluate(V,{},tn),128*Nt.compositeTextSizes[1].evaluate(V,{},tn)])[0]>32640||Dn[1]>32640)&&gt(c.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),c.addSymbols(c.text,_n,Dn,Q,B,V,Le,d,me.lineStartIndex,me.lineLength,Et,tn);for(var cr=0,_r=We;cr<_r.length;cr+=1)tt[_r[cr]]=c.text.placedSymbolArray.length-1;return 4*_n.length}function Zn(c){for(var d in c)return c[d];return null}function nn(c,d,g,A){var M=c.compareText;if(d in M){for(var B=M[d],V=B.length-1;V>=0;V--)if(A.dist(B[V])<g)return!0}else M[d]=[];return M[d].push(A),!1}var Xn=np.VectorTileFeature.types,Sr=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zr(c,d,g,A,M,B,V,Q,me,Le,We,tt,Et){var Nt=Q?Math.min(32640,Math.round(Q[0])):0,tn=Q?Math.min(32640,Math.round(Q[1])):0;c.emplaceBack(d,g,Math.round(32*A),Math.round(32*M),B,V,(Nt<<1)+(me?1:0),tn,16*Le,16*We,256*tt,256*Et)}function di(c,d,g){c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g),c.emplaceBack(d.x,d.y,g)}function ni(c){for(var d=0,g=c.sections;d<g.length;d+=1)if(eh(g[d].text))return!0;return!1}var gi=function(c){this.layoutVertexArray=new wp,this.indexArray=new sf,this.programConfigurations=c,this.segments=new St,this.dynamicLayoutVertexArray=new Yr,this.opacityVertexArray=new Uf,this.placedSymbolArray=new C};gi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},gi.prototype.upload=function(c,d,g,A){this.isEmpty()||(g&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Ip.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,xm.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Sr,!0),this.opacityVertexBuffer.itemSize=1),(g||A)&&this.programConfigurations.upload(c))},gi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},io("SymbolBuffers",gi);var To=function(c,d,g){this.layoutVertexArray=new c,this.layoutAttributes=d,this.indexArray=new g,this.segments=new St,this.collisionVertexArray=new Ap};To.prototype.upload=function(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,Em.members,!0)},To.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},io("CollisionBuffers",To);var co=function(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=xl([]),this.placementViewportMatrix=xl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$l(this.zoom,d["text-size"]),this.iconSizeData=$l(this.zoom,d["icon-size"]);var g=this.layers[0].layout,A=g.get("symbol-sort-key"),M=g.get("symbol-z-order");this.canOverlap=g.get("text-allow-overlap")||g.get("icon-allow-overlap")||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=M!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(M==="viewport-y"||M==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(function(B){return Zo[B]})),this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id}),this.sourceID=c.sourceID};co.prototype.createArrays=function(){this.text=new gi(new Vo(this.layers,this.zoom,function(c){return/^text/.test(c)})),this.icon=new gi(new Vo(this.layers,this.zoom,function(c){return/^icon/.test(c)})),this.glyphOffsetArray=new q,this.lineVertexArray=new de,this.symbolInstances=new G},co.prototype.calculateGlyphDependencies=function(c,d,g,A,M){for(var B=0;B<c.length;B++)if(d[c.charCodeAt(B)]=!0,(g||A)&&M){var V=Mn[c.charAt(B)];V&&(d[V.charCodeAt(0)]=!0)}},co.prototype.populate=function(c,d,g){var A=this.layers[0],M=A.layout,B=M.get("text-font"),V=M.get("text-field"),Q=M.get("icon-image"),me=(V.value.kind!=="constant"||V.value.value instanceof fr&&!V.value.value.isEmpty()||V.value.value.toString().length>0)&&(B.value.kind!=="constant"||B.value.value.length>0),Le=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,We=M.get("symbol-sort-key");if(this.features=[],me||Le){for(var tt=d.iconDependencies,Et=d.glyphDependencies,Nt=d.availableImages,tn=new Ta(this.zoom),_n=0,zn=c;_n<zn.length;_n+=1){var Dn=zn[_n],cr=Dn.feature,_r=Dn.id,Ir=Dn.index,Br=Dn.sourceLayerIndex,jr=A._featureFilter.needGeometry,bi=ll(cr,jr);if(A._featureFilter.filter(tn,bi,g)){jr||(bi.geometry=Rs(cr));var Zi=void 0;if(me){var Ro=A.getValueAndResolveTokens("text-field",bi,g,Nt),ki=fr.factory(Ro);ni(ki)&&(this.hasRTLText=!0),(!this.hasRTLText||z0()==="unavailable"||this.hasRTLText&&af.isParsed())&&(Zi=Qt(ki,A,bi))}var zo=void 0;if(Le){var ao=A.getValueAndResolveTokens("icon-image",bi,g,Nt);zo=ao instanceof ci?ao:ci.fromString(ao)}if(Zi||zo){var xa=this.sortFeaturesByKey?We.evaluate(bi,{},g):void 0;if(this.features.push({id:_r,text:Zi,icon:zo,index:Ir,sourceLayerIndex:Br,geometry:bi.geometry,properties:cr.properties,type:Xn[cr.type],sortKey:xa}),zo&&(tt[zo.name]=!0),Zi){var Mo=B.evaluate(bi,{},g).join(","),_o=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Zo.vertical)>=0;for(var Za=0,pa=Zi.sections;Za<pa.length;Za+=1){var Oa=pa[Za];if(Oa.image)tt[Oa.image.name]=!0;else{var $o=Ff(Zi.toString()),Es=Oa.fontStack||Mo,Tl=Et[Es]=Et[Es]||{};this.calculateGlyphDependencies(Oa.text,Tl,_o,this.allowVerticalPlacement,$o)}}}}}}M.get("symbol-placement")==="line"&&(this.features=function(Vl){var Hl={},wl={},ql=[],jc=0;function nu(il){ql.push(Vl[il]),jc++}function fl(il,sc,Al){var Ss=wl[il];return delete wl[il],wl[sc]=Ss,ql[Ss].geometry[0].pop(),ql[Ss].geometry[0]=ql[Ss].geometry[0].concat(Al[0]),Ss}function Cc(il,sc,Al){var Ss=Hl[sc];return delete Hl[sc],Hl[il]=Ss,ql[Ss].geometry[0].shift(),ql[Ss].geometry[0]=Al[0].concat(ql[Ss].geometry[0]),Ss}function Vu(il,sc,Al){var Ss=Al?sc[0][sc[0].length-1]:sc[0][0];return il+":"+Ss.x+":"+Ss.y}for(var ac=0;ac<Vl.length;ac++){var Oc=Vl[ac],Ya=Oc.geometry,$s=Oc.text?Oc.text.toString():null;if($s){var Zs=Vu($s,Ya),ms=Vu($s,Ya,!0);if(Zs in wl&&ms in Hl&&wl[Zs]!==Hl[ms]){var Hu=Cc(Zs,ms,Ya),du=fl(Zs,ms,ql[Hu].geometry);delete Hl[Zs],delete wl[ms],wl[Vu($s,ql[du].geometry,!0)]=du,ql[Hu].geometry=null}else Zs in wl?fl(Zs,ms,Ya):ms in Hl?Cc(Zs,ms,Ya):(nu(ac),Hl[Zs]=jc-1,wl[ms]=jc-1)}else nu(ac)}return ql.filter(function(il){return il.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Vl,Hl){return Vl.sortKey-Hl.sortKey})}},co.prototype.update=function(c,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,d,this.layers,g),this.icon.programConfigurations.updatePaintArrays(c,d,this.layers,g))},co.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},co.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},co.prototype.upload=function(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},co.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},co.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},co.prototype.addToLineVertexArray=function(c,d){var g=this.lineVertexArray.length;if(c.segment!==void 0){for(var A=c.dist(d[c.segment+1]),M=c.dist(d[c.segment]),B={},V=c.segment+1;V<d.length;V++)B[V]={x:d[V].x,y:d[V].y,tileUnitDistanceFromAnchor:A},V<d.length-1&&(A+=d[V+1].dist(d[V]));for(var Q=c.segment||0;Q>=0;Q--)B[Q]={x:d[Q].x,y:d[Q].y,tileUnitDistanceFromAnchor:M},Q>0&&(M+=d[Q-1].dist(d[Q]));for(var me=0;me<d.length;me++){var Le=B[me];this.lineVertexArray.emplaceBack(Le.x,Le.y,Le.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}},co.prototype.addSymbols=function(c,d,g,A,M,B,V,Q,me,Le,We,tt){for(var Et=c.indexArray,Nt=c.layoutVertexArray,tn=c.segments.prepareSegment(4*d.length,Nt,Et,this.canOverlap?B.sortKey:void 0),_n=this.glyphOffsetArray.length,zn=tn.vertexLength,Dn=this.allowVerticalPlacement&&V===Zo.vertical?Math.PI/2:0,cr=B.text&&B.text.sections,_r=0;_r<d.length;_r++){var Ir=d[_r],Br=Ir.tl,jr=Ir.tr,bi=Ir.bl,Zi=Ir.br,Ro=Ir.tex,ki=Ir.pixelOffsetTL,zo=Ir.pixelOffsetBR,ao=Ir.minFontScaleX,xa=Ir.minFontScaleY,Mo=Ir.glyphOffset,_o=Ir.isSDF,Za=Ir.sectionIndex,pa=tn.vertexLength,Oa=Mo[1];zr(Nt,Q.x,Q.y,Br.x,Oa+Br.y,Ro.x,Ro.y,g,_o,ki.x,ki.y,ao,xa),zr(Nt,Q.x,Q.y,jr.x,Oa+jr.y,Ro.x+Ro.w,Ro.y,g,_o,zo.x,ki.y,ao,xa),zr(Nt,Q.x,Q.y,bi.x,Oa+bi.y,Ro.x,Ro.y+Ro.h,g,_o,ki.x,zo.y,ao,xa),zr(Nt,Q.x,Q.y,Zi.x,Oa+Zi.y,Ro.x+Ro.w,Ro.y+Ro.h,g,_o,zo.x,zo.y,ao,xa),di(c.dynamicLayoutVertexArray,Q,Dn),Et.emplaceBack(pa,pa+1,pa+2),Et.emplaceBack(pa+1,pa+2,pa+3),tn.vertexLength+=4,tn.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Mo[0]),_r!==d.length-1&&Za===d[_r+1].sectionIndex||c.programConfigurations.populatePaintArrays(Nt.length,B,B.index,{},tt,cr&&cr[Za])}c.placedSymbolArray.emplaceBack(Q.x,Q.y,_n,this.glyphOffsetArray.length-_n,zn,me,Le,Q.segment,g?g[0]:0,g?g[1]:0,A[0],A[1],V,0,!1,0,We)},co.prototype._addCollisionDebugVertex=function(c,d,g,A,M,B){return d.emplaceBack(0,0),c.emplaceBack(g.x,g.y,A,M,Math.round(B.x),Math.round(B.y))},co.prototype.addCollisionDebugVertices=function(c,d,g,A,M,B,V){var Q=M.segments.prepareSegment(4,M.layoutVertexArray,M.indexArray),me=Q.vertexLength,Le=M.layoutVertexArray,We=M.collisionVertexArray,tt=V.anchorX,Et=V.anchorY;this._addCollisionDebugVertex(Le,We,B,tt,Et,new se(c,d)),this._addCollisionDebugVertex(Le,We,B,tt,Et,new se(g,d)),this._addCollisionDebugVertex(Le,We,B,tt,Et,new se(g,A)),this._addCollisionDebugVertex(Le,We,B,tt,Et,new se(c,A)),Q.vertexLength+=4;var Nt=M.indexArray;Nt.emplaceBack(me,me+1),Nt.emplaceBack(me+1,me+2),Nt.emplaceBack(me+2,me+3),Nt.emplaceBack(me+3,me),Q.primitiveLength+=4},co.prototype.addDebugCollisionBoxes=function(c,d,g,A){for(var M=c;M<d;M++){var B=this.collisionBoxArray.get(M);this.addCollisionDebugVertices(B.x1,B.y1,B.x2,B.y2,A?this.textCollisionBox:this.iconCollisionBox,B.anchorPoint,g)}},co.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new To(qh,Sv.members,Ds),this.iconCollisionBox=new To(qh,Sv.members,Ds);for(var c=0;c<this.symbolInstances.length;c++){var d=this.symbolInstances.get(c);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},co.prototype._deserializeCollisionBoxesForSymbol=function(c,d,g,A,M,B,V,Q,me){for(var Le={},We=d;We<g;We++){var tt=c.get(We);Le.textBox={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2,anchorPointX:tt.anchorPointX,anchorPointY:tt.anchorPointY},Le.textFeatureIndex=tt.featureIndex;break}for(var Et=A;Et<M;Et++){var Nt=c.get(Et);Le.verticalTextBox={x1:Nt.x1,y1:Nt.y1,x2:Nt.x2,y2:Nt.y2,anchorPointX:Nt.anchorPointX,anchorPointY:Nt.anchorPointY},Le.verticalTextFeatureIndex=Nt.featureIndex;break}for(var tn=B;tn<V;tn++){var _n=c.get(tn);Le.iconBox={x1:_n.x1,y1:_n.y1,x2:_n.x2,y2:_n.y2,anchorPointX:_n.anchorPointX,anchorPointY:_n.anchorPointY},Le.iconFeatureIndex=_n.featureIndex;break}for(var zn=Q;zn<me;zn++){var Dn=c.get(zn);Le.verticalIconBox={x1:Dn.x1,y1:Dn.y1,x2:Dn.x2,y2:Dn.y2,anchorPointX:Dn.anchorPointX,anchorPointY:Dn.anchorPointY},Le.verticalIconFeatureIndex=Dn.featureIndex;break}return Le},co.prototype.deserializeCollisionBoxes=function(c){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var g=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}},co.prototype.hasTextData=function(){return this.text.segments.get().length>0},co.prototype.hasIconData=function(){return this.icon.segments.get().length>0},co.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},co.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},co.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},co.prototype.addIndicesForPlacedSymbol=function(c,d){for(var g=c.placedSymbolArray.get(d),A=g.vertexStartIndex+4*g.numGlyphs,M=g.vertexStartIndex;M<A;M+=4)c.indexArray.emplaceBack(M,M+1,M+2),c.indexArray.emplaceBack(M+1,M+2,M+3)},co.prototype.getSortedSymbolIndexes=function(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(c),g=Math.cos(c),A=[],M=[],B=[],V=0;V<this.symbolInstances.length;++V){B.push(V);var Q=this.symbolInstances.get(V);A.push(0|Math.round(d*Q.anchorX+g*Q.anchorY)),M.push(Q.featureIndex)}return B.sort(function(me,Le){return A[me]-A[Le]||M[Le]-M[me]}),B},co.prototype.addToSortKeyRanges=function(c,d){var g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===d?g.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:c,symbolInstanceEnd:c+1})},co.prototype.sortFeatures=function(c){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var g=0,A=this.symbolInstanceIndexes;g<A.length;g+=1){var M=this.symbolInstances.get(A[g]);this.featureSortOrder.push(M.featureIndex),[M.rightJustifiedTextSymbolIndex,M.centerJustifiedTextSymbolIndex,M.leftJustifiedTextSymbolIndex].forEach(function(B,V,Q){B>=0&&Q.indexOf(B)===V&&d.addIndicesForPlacedSymbol(d.text,B)}),M.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,M.verticalPlacedTextSymbolIndex),M.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.placedIconSymbolIndex),M.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,M.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},io("SymbolBucket",co,{omit:["layers","collisionBoxArray","features","compareText"]}),co.MAX_GLYPHS=65535,co.addDynamicAttributes=di;var So=new dl({"symbol-placement":new jo(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new jo(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jo(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Eo(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jo(yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new jo(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new jo(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new jo(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jo(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Eo(yt.layout_symbol["icon-size"]),"icon-text-fit":new jo(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jo(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Eo(yt.layout_symbol["icon-image"]),"icon-rotate":new Eo(yt.layout_symbol["icon-rotate"]),"icon-padding":new jo(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new jo(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new Eo(yt.layout_symbol["icon-offset"]),"icon-anchor":new Eo(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jo(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jo(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jo(yt.layout_symbol["text-rotation-alignment"]),"text-field":new Eo(yt.layout_symbol["text-field"]),"text-font":new Eo(yt.layout_symbol["text-font"]),"text-size":new Eo(yt.layout_symbol["text-size"]),"text-max-width":new Eo(yt.layout_symbol["text-max-width"]),"text-line-height":new jo(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new Eo(yt.layout_symbol["text-letter-spacing"]),"text-justify":new Eo(yt.layout_symbol["text-justify"]),"text-radial-offset":new Eo(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jo(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new Eo(yt.layout_symbol["text-anchor"]),"text-max-angle":new jo(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new jo(yt.layout_symbol["text-writing-mode"]),"text-rotate":new Eo(yt.layout_symbol["text-rotate"]),"text-padding":new jo(yt.layout_symbol["text-padding"]),"text-keep-upright":new jo(yt.layout_symbol["text-keep-upright"]),"text-transform":new Eo(yt.layout_symbol["text-transform"]),"text-offset":new Eo(yt.layout_symbol["text-offset"]),"text-allow-overlap":new jo(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new jo(yt.layout_symbol["text-ignore-placement"]),"text-optional":new jo(yt.layout_symbol["text-optional"])}),mo={paint:new dl({"icon-opacity":new Eo(yt.paint_symbol["icon-opacity"]),"icon-color":new Eo(yt.paint_symbol["icon-color"]),"icon-halo-color":new Eo(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Eo(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Eo(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new jo(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new jo(yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Eo(yt.paint_symbol["text-opacity"]),"text-color":new Eo(yt.paint_symbol["text-color"],{runtimeType:Qr,getOverride:function(c){return c.textColor},hasOverride:function(c){return!!c.textColor}}),"text-halo-color":new Eo(yt.paint_symbol["text-halo-color"]),"text-halo-width":new Eo(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new Eo(yt.paint_symbol["text-halo-blur"]),"text-translate":new jo(yt.paint_symbol["text-translate"]),"text-translate-anchor":new jo(yt.paint_symbol["text-translate-anchor"])}),layout:So},aa=function(c){this.type=c.property.overrides?c.property.overrides.runtimeType:Oi,this.defaultValue=c};aa.prototype.evaluate=function(c){if(c.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(c.formattedSection))return d.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default},aa.prototype.eachChild=function(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)},aa.prototype.outputDefined=function(){return!1},aa.prototype.serialize=function(){return null},io("FormatSectionOverride",aa,{omit:["defaultValue"]});var Cs=function(c){function d(g){c.call(this,g,mo)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.recalculate=function(g,A){if(c.prototype.recalculate.call(this,g,A),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var M=this.layout.get("text-writing-mode");if(M){for(var B=[],V=0,Q=M;V<Q.length;V+=1){var me=Q[V];B.indexOf(me)<0&&B.push(me)}this.layout._values["text-writing-mode"]=B}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(g,A,M,B){var V=this.layout.get(g).evaluate(A,{},M,B),Q=this._unevaluatedLayout._values[g];return Q.isDataDriven()||Ls(Q.value)||!V?V:function(me,Le){return Le.replace(/{([^{}]+)}/g,function(We,tt){return tt in me?String(me[tt]):""})}(A.properties,V)},d.prototype.createBucket=function(g){return new co(g)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var g=0,A=mo.paint.overridableProperties;g<A.length;g+=1){var M=A[g];if(d.hasPaintOverride(this.layout,M)){var B,V=this.paint.get(M),Q=new aa(V),me=new Xa(Q,V.property.specification);B=V.value.kind==="constant"||V.value.kind==="source"?new Ec("source",me):new cs("composite",me,V.value.zoomStops,V.value._interpolationType),this.paint._values[M]=new Xc(V.property,B,V.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(g,A,M){return!(!this.layout||A.isDataDriven()||M.isDataDriven())&&d.hasPaintOverride(this.layout,g)},d.hasPaintOverride=function(g,A){var M=g.get("text-field"),B=mo.paint.properties[A],V=!1,Q=function(We){for(var tt=0,Et=We;tt<Et.length;tt+=1)if(B.overrides&&B.overrides.hasOverride(Et[tt]))return void(V=!0)};if(M.value.kind==="constant"&&M.value.value instanceof fr)Q(M.value.value.sections);else if(M.value.kind==="source"){var me=function(We){V||(We instanceof Di&&Jr(We.value)===_a?Q(We.value.sections):We instanceof bo?Q(We.sections):We.eachChild(me))},Le=M.value;Le._styleExpression&&me(Le._styleExpression.expression)}return V},d}(bf),Ac={paint:new dl({"background-color":new jo(yt.paint_background["background-color"]),"background-pattern":new lu(yt.paint_background["background-pattern"]),"background-opacity":new jo(yt.paint_background["background-opacity"])})},Au=function(c){function d(g){c.call(this,g,Ac)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(bf),Sm={paint:new dl({"raster-opacity":new jo(yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new jo(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jo(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jo(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new jo(yt.paint_raster["raster-saturation"]),"raster-contrast":new jo(yt.paint_raster["raster-contrast"]),"raster-resampling":new jo(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new jo(yt.paint_raster["raster-fade-duration"])})},cf=function(c){function d(g){c.call(this,g,Sm)}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d}(bf),cg=function(c){function d(g){c.call(this,g,{}),this.implementation=g}return c&&(d.__proto__=c),(d.prototype=Object.create(c&&c.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(g){this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},d.prototype.onRemove=function(g){this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},d}(bf),Pd={circle:Kd,heatmap:Cp,hillshade:ig,fill:_y,"fill-extrusion":wu,line:Sl,symbol:Cs,background:Au,raster:cf},ip=oe.HTMLImageElement,M1=oe.HTMLCanvasElement,P1=oe.HTMLVideoElement,xb=oe.ImageData,xy=oe.ImageBitmap,Lp=function(c,d,g,A){this.context=c,this.format=g,this.texture=c.gl.createTexture(),this.update(d,A)};Lp.prototype.update=function(c,d,g){var A=c.width,M=c.height,B=!(this.size&&this.size[0]===A&&this.size[1]===M||g),V=this.context,Q=V.gl;if(this.useMipmap=!!(d&&d.useMipmap),Q.bindTexture(Q.TEXTURE_2D,this.texture),V.pixelStoreUnpackFlipY.set(!1),V.pixelStoreUnpack.set(1),V.pixelStoreUnpackPremultiplyAlpha.set(this.format===Q.RGBA&&(!d||d.premultiply!==!1)),B)this.size=[A,M],c instanceof ip||c instanceof M1||c instanceof P1||c instanceof xb||xy&&c instanceof xy?Q.texImage2D(Q.TEXTURE_2D,0,this.format,this.format,Q.UNSIGNED_BYTE,c):Q.texImage2D(Q.TEXTURE_2D,0,this.format,A,M,0,this.format,Q.UNSIGNED_BYTE,c.data);else{var me=g||{x:0,y:0},Le=me.x,We=me.y;c instanceof ip||c instanceof M1||c instanceof P1||c instanceof xb||xy&&c instanceof xy?Q.texSubImage2D(Q.TEXTURE_2D,0,Le,We,Q.RGBA,Q.UNSIGNED_BYTE,c):Q.texSubImage2D(Q.TEXTURE_2D,0,Le,We,A,M,Q.RGBA,Q.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Q.generateMipmap(Q.TEXTURE_2D)},Lp.prototype.bind=function(c,d,g){var A=this.context.gl;A.bindTexture(A.TEXTURE_2D,this.texture),g!==A.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=A.LINEAR),c!==this.filter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,c),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,g||c),this.filter=c),d!==this.wrap&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,d),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,d),this.wrap=d)},Lp.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Lp.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ey=function(c){var d=this;this._callback=c,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};Ey.prototype.trigger=function(){var c=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){c._triggered=!1,c._callback()},0))},Ey.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Z0=function(c,d,g){this.target=c,this.parent=d,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Zt(["receive","process"],this),this.invoker=new Ey(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=He()?c:oe};function Sy(c,d,g){var A=2*Math.PI*6378137/256/Math.pow(2,g);return[c*A-2*Math.PI*6378137/2,d*A-2*Math.PI*6378137/2]}Z0.prototype.send=function(c,d,g,A,M){var B=this;M===void 0&&(M=!1);var V=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[V]=g);var Q=ot(this.globalScope)?void 0:[];return this.target.postMessage({id:V,type:c,hasCallback:!!g,targetMapId:A,mustQueue:M,sourceMapId:this.mapId,data:_l(d,Q)},Q),{cancel:function(){g&&delete B.callbacks[V],B.target.postMessage({id:V,type:"<cancel>",targetMapId:A,sourceMapId:B.mapId})}}},Z0.prototype.receive=function(c){var d=c.data,g=d.id;if(g&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[g];var A=this.cancelCallbacks[g];delete this.cancelCallbacks[g],A&&A()}else He()||d.mustQueue?(this.tasks[g]=d,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,d)},Z0.prototype.process=function(){if(this.taskQueue.length){var c=this.taskQueue.shift(),d=this.tasks[c];delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(c,d)}},Z0.prototype.processTask=function(c,d){var g=this;if(d.type==="<response>"){var A=this.callbacks[c];delete this.callbacks[c],A&&(d.error?A(Ja(d.error)):A(null,Ja(d.data)))}else{var M=!1,B=ot(this.globalScope)?void 0:[],V=d.hasCallback?function(We,tt){M=!0,delete g.cancelCallbacks[c],g.target.postMessage({id:c,type:"<response>",sourceMapId:g.mapId,error:We?_l(We):null,data:_l(tt,B)},B)}:function(We){M=!0},Q=null,me=Ja(d.data);if(this.parent[d.type])Q=this.parent[d.type](d.sourceMapId,me,V);else if(this.parent.getWorkerSource){var Le=d.type.split(".");Q=this.parent.getWorkerSource(d.sourceMapId,Le[0],me.source)[Le[1]](me,V)}else V(new Error("Could not find function "+d.type));!M&&Q&&Q.cancel&&(this.cancelCallbacks[c]=Q.cancel)}},Z0.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Va=function(c,d){c&&(d?this.setSouthWest(c).setNorthEast(d):c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1]))};Va.prototype.setNorthEast=function(c){return this._ne=c instanceof cl?new cl(c.lng,c.lat):cl.convert(c),this},Va.prototype.setSouthWest=function(c){return this._sw=c instanceof cl?new cl(c.lng,c.lat):cl.convert(c),this},Va.prototype.extend=function(c){var d,g,A=this._sw,M=this._ne;if(c instanceof cl)d=c,g=c;else{if(!(c instanceof Va))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(Va.convert(c)):this.extend(cl.convert(c)):this;if(g=c._ne,!(d=c._sw)||!g)return this}return A||M?(A.lng=Math.min(d.lng,A.lng),A.lat=Math.min(d.lat,A.lat),M.lng=Math.max(g.lng,M.lng),M.lat=Math.max(g.lat,M.lat)):(this._sw=new cl(d.lng,d.lat),this._ne=new cl(g.lng,g.lat)),this},Va.prototype.getCenter=function(){return new cl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Va.prototype.getSouthWest=function(){return this._sw},Va.prototype.getNorthEast=function(){return this._ne},Va.prototype.getNorthWest=function(){return new cl(this.getWest(),this.getNorth())},Va.prototype.getSouthEast=function(){return new cl(this.getEast(),this.getSouth())},Va.prototype.getWest=function(){return this._sw.lng},Va.prototype.getSouth=function(){return this._sw.lat},Va.prototype.getEast=function(){return this._ne.lng},Va.prototype.getNorth=function(){return this._ne.lat},Va.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Va.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Va.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Va.prototype.contains=function(c){var d=cl.convert(c),g=d.lng,A=d.lat,M=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(M=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=A&&A<=this._ne.lat&&M},Va.convert=function(c){return!c||c instanceof Va?c:new Va(c)};var cl=function(c,d){if(isNaN(c)||isNaN(d))throw new Error("Invalid LngLat object: ("+c+", "+d+")");if(this.lng=+c,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};cl.prototype.wrap=function(){return new cl(Te(this.lng,-180,180),this.lat)},cl.prototype.toArray=function(){return[this.lng,this.lat]},cl.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},cl.prototype.distanceTo=function(c){var d=Math.PI/180,g=this.lat*d,A=c.lat*d,M=Math.sin(g)*Math.sin(A)+Math.cos(g)*Math.cos(A)*Math.cos((c.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(M,1))},cl.prototype.toBounds=function(c){c===void 0&&(c=0);var d=360*c/40075017,g=d/Math.cos(Math.PI/180*this.lat);return new Va(new cl(this.lng-g,this.lat-d),new cl(this.lng+g,this.lat+d))},cl.convert=function(c){if(c instanceof cl)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new cl(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new cl(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ug=2*Math.PI*63710088e-1;function ju(c){return ug*Math.cos(c*Math.PI/180)}function fg(c){return(180+c)/360}function Tm(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Eb(c,d){return c/ju(d)}function id(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}var Dp=function(c,d,g){g===void 0&&(g=0),this.x=+c,this.y=+d,this.z=+g};Dp.fromLngLat=function(c,d){d===void 0&&(d=0);var g=cl.convert(c);return new Dp(fg(g.lng),Tm(g.lat),Eb(d,g.lat))},Dp.prototype.toLngLat=function(){return new cl(360*this.x-180,id(this.y))},Dp.prototype.toAltitude=function(){return this.z*ju(id(this.y))},Dp.prototype.meterInMercatorCoordinateUnits=function(){return 1/ug*(c=id(this.y),1/Math.cos(c*Math.PI/180));var c};var Id=function(c,d,g){this.z=c,this.x=d,this.y=g,this.key=No(0,c,c,d,g)};Id.prototype.equals=function(c){return this.z===c.z&&this.x===c.x&&this.y===c.y},Id.prototype.url=function(c,d){var g,A,M,B,V,Q=(A=this.y,M=this.z,B=Sy(256*(g=this.x),256*(A=Math.pow(2,M)-A-1),M),V=Sy(256*(g+1),256*(A+1),M),B[0]+","+B[1]+","+V[0]+","+V[1]),me=function(Le,We,tt){for(var Et,Nt="",tn=Le;tn>0;tn--)Nt+=(We&(Et=1<<tn-1)?1:0)+(tt&Et?2:0);return Nt}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",me).replace("{bbox-epsg-3857}",Q)},Id.prototype.getTilePoint=function(c){var d=Math.pow(2,this.z);return new se(8192*(c.x*d-this.x),8192*(c.y*d-this.y))},Id.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var I1=function(c,d){this.wrap=c,this.canonical=d,this.key=No(c,d.z,d.z,d.x,d.y)},ul=function(c,d,g,A,M){this.overscaledZ=c,this.wrap=d,this.canonical=new Id(g,+A,+M),this.key=No(d,c,g,A,M)};function No(c,d,g,A,M){(c*=2)<0&&(c=-1*c-1);var B=1<<g;return(B*B*c+B*M+A).toString(36)+g.toString(36)+d.toString(36)}ul.prototype.equals=function(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)},ul.prototype.scaledTo=function(c){var d=this.canonical.z-c;return c>this.canonical.z?new ul(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ul(c,this.wrap,c,this.canonical.x>>d,this.canonical.y>>d)},ul.prototype.calculateScaledKey=function(c,d){var g=this.canonical.z-c;return c>this.canonical.z?No(this.wrap*+d,c,this.canonical.z,this.canonical.x,this.canonical.y):No(this.wrap*+d,c,c,this.canonical.x>>g,this.canonical.y>>g)},ul.prototype.isChildOf=function(c){if(c.wrap!==this.wrap)return!1;var d=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>d&&c.canonical.y===this.canonical.y>>d},ul.prototype.children=function(c){if(this.overscaledZ>=c)return[new ul(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,g=2*this.canonical.x,A=2*this.canonical.y;return[new ul(d,this.wrap,d,g,A),new ul(d,this.wrap,d,g+1,A),new ul(d,this.wrap,d,g,A+1),new ul(d,this.wrap,d,g+1,A+1)]},ul.prototype.isLessThan=function(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))},ul.prototype.wrapped=function(){return new ul(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ul.prototype.unwrapTo=function(c){return new ul(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)},ul.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ul.prototype.toUnwrapped=function(){return new I1(this.wrap,this.canonical)},ul.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ul.prototype.getTilePoint=function(c){return this.canonical.getTilePoint(new Dp(c.x-this.wrap,c.y))},io("CanonicalTileID",Id),io("OverscaledTileID",ul,{omit:["posMatrix"]});var op=function(c,d,g){if(this.uid=c,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return gt('"'+g+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var A=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=g||"mapbox";for(var M=0;M<A;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(A,M)]=this.data[this._idx(A-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,A)]=this.data[this._idx(M,A-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(A,-1)]=this.data[this._idx(A-1,0)],this.data[this._idx(-1,A)]=this.data[this._idx(0,A-1)],this.data[this._idx(A,A)]=this.data[this._idx(A-1,A-1)]};op.prototype.get=function(c,d){var g=new Uint8Array(this.data.buffer),A=4*this._idx(c,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[A],g[A+1],g[A+2])},op.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},op.prototype._idx=function(c,d){if(c<-1||c>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(c+1)},op.prototype._unpackMapbox=function(c,d,g){return(256*c*256+256*d+g)/10-1e4},op.prototype._unpackTerrarium=function(c,d,g){return 256*c+d+g/256-32768},op.prototype.getPixels=function(){return new uu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},op.prototype.backfillBorder=function(c,d,g){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");var A=d*this.dim,M=d*this.dim+this.dim,B=g*this.dim,V=g*this.dim+this.dim;switch(d){case-1:A=M-1;break;case 1:M=A+1}switch(g){case-1:B=V-1;break;case 1:V=B+1}for(var Q=-d*this.dim,me=-g*this.dim,Le=B;Le<V;Le++)for(var We=A;We<M;We++)this.data[this._idx(We,Le)]=c.data[this._idx(We+Q,Le+me)]},io("DEMData",op);var hg=function(c){this._stringToNumber={},this._numberToString=[];for(var d=0;d<c.length;d++){var g=c[d];this._stringToNumber[g]=d,this._numberToString[d]=g}};hg.prototype.encode=function(c){return this._stringToNumber[c]},hg.prototype.decode=function(c){return this._numberToString[c]};var Hs=function(c,d,g,A,M){this.type="Feature",this._vectorTileFeature=c,c._z=d,c._x=g,c._y=A,this.properties=c.properties,this.id=M},Np={geometry:{configurable:!0}};Np.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Np.geometry.set=function(c){this._geometry=c},Hs.prototype.toJSON=function(){var c={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(c[d]=this[d]);return c},Object.defineProperties(Hs.prototype,Np);var Ld=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ld.prototype.updateState=function(c,d,g){var A=String(d);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][A]=this.stateChanges[c][A]||{},we(this.stateChanges[c][A],g),this.deletedStates[c]===null)for(var M in this.deletedStates[c]={},this.state[c])M!==A&&(this.deletedStates[c][M]=null);else if(this.deletedStates[c]&&this.deletedStates[c][A]===null)for(var B in this.deletedStates[c][A]={},this.state[c][A])g[B]||(this.deletedStates[c][A][B]=null);else for(var V in g)this.deletedStates[c]&&this.deletedStates[c][A]&&this.deletedStates[c][A][V]===null&&delete this.deletedStates[c][A][V]},Ld.prototype.removeFeatureState=function(c,d,g){if(this.deletedStates[c]!==null){var A=String(d);if(this.deletedStates[c]=this.deletedStates[c]||{},g&&d!==void 0)this.deletedStates[c][A]!==null&&(this.deletedStates[c][A]=this.deletedStates[c][A]||{},this.deletedStates[c][A][g]=null);else if(d!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][A])for(g in this.deletedStates[c][A]={},this.stateChanges[c][A])this.deletedStates[c][A][g]=null;else this.deletedStates[c][A]=null;else this.deletedStates[c]=null}},Ld.prototype.getState=function(c,d){var g=String(d),A=we({},(this.state[c]||{})[g],(this.stateChanges[c]||{})[g]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){var M=this.deletedStates[c][d];if(M===null)return{};for(var B in M)delete A[B]}return A},Ld.prototype.initializeTileState=function(c,d){c.setFeatureState(this.state,d)},Ld.prototype.coalesceChanges=function(c,d){var g={};for(var A in this.stateChanges){this.state[A]=this.state[A]||{};var M={};for(var B in this.stateChanges[A])this.state[A][B]||(this.state[A][B]={}),we(this.state[A][B],this.stateChanges[A][B]),M[B]=this.state[A][B];g[A]=M}for(var V in this.deletedStates){this.state[V]=this.state[V]||{};var Q={};if(this.deletedStates[V]===null)for(var me in this.state[V])Q[me]={},this.state[V][me]={};else for(var Le in this.deletedStates[V]){if(this.deletedStates[V][Le]===null)this.state[V][Le]={};else for(var We=0,tt=Object.keys(this.deletedStates[V][Le]);We<tt.length;We+=1)delete this.state[V][Le][tt[We]];Q[Le]=this.state[V][Le]}g[V]=g[V]||{},we(g[V],Q)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(var Et in c)c[Et].setFeatureState(g,d)};var Mh=function(c,d){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new za(8192,16,0),this.grid3D=new za(8192,16,0),this.featureIndexArray=new it,this.promoteId=d};function L1(c,d,g,A,M){return vt(c,function(B,V){var Q=d instanceof Tp?d.get(V):null;return Q&&Q.evaluate?Q.evaluate(g,A,M):Q})}function D1(c){for(var d=1/0,g=1/0,A=-1/0,M=-1/0,B=0,V=c;B<V.length;B+=1){var Q=V[B];d=Math.min(d,Q.x),g=Math.min(g,Q.y),A=Math.max(A,Q.x),M=Math.max(M,Q.y)}return{minX:d,minY:g,maxX:A,maxY:M}}function Sb(c,d){return d-c}Mh.prototype.insert=function(c,d,g,A,M,B){var V=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,A,M);for(var Q=B?this.grid3D:this.grid,me=0;me<d.length;me++){for(var Le=d[me],We=[1/0,1/0,-1/0,-1/0],tt=0;tt<Le.length;tt++){var Et=Le[tt];We[0]=Math.min(We[0],Et.x),We[1]=Math.min(We[1],Et.y),We[2]=Math.max(We[2],Et.x),We[3]=Math.max(We[3],Et.y)}We[0]<8192&&We[1]<8192&&We[2]>=0&&We[3]>=0&&Q.insert(V,We[0],We[1],We[2],We[3])}},Mh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new np.VectorTile(new Or(this.rawTileData)).layers,this.sourceLayerCoder=new hg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Mh.prototype.query=function(c,d,g,A){var M=this;this.loadVTLayers();for(var B=c.params||{},V=8192/c.tileSize/c.scale,Q=Fu(B.filter),me=c.queryGeometry,Le=c.queryPadding*V,We=D1(me),tt=this.grid.query(We.minX-Le,We.minY-Le,We.maxX+Le,We.maxY+Le),Et=D1(c.cameraQueryGeometry),Nt=this.grid3D.query(Et.minX-Le,Et.minY-Le,Et.maxX+Le,Et.maxY+Le,function(Ir,Br,jr,bi){return function(Zi,Ro,ki,zo,ao){for(var xa=0,Mo=Zi;xa<Mo.length;xa+=1){var _o=Mo[xa];if(Ro<=_o.x&&ki<=_o.y&&zo>=_o.x&&ao>=_o.y)return!0}var Za=[new se(Ro,ki),new se(Ro,ao),new se(zo,ao),new se(zo,ki)];if(Zi.length>2){for(var pa=0,Oa=Za;pa<Oa.length;pa+=1)if(Rh(Zi,Oa[pa]))return!0}for(var $o=0;$o<Zi.length-1;$o++)if(Ti(Zi[$o],Zi[$o+1],Za))return!0;return!1}(c.cameraQueryGeometry,Ir-Le,Br-Le,jr+Le,bi+Le)}),tn=0,_n=Nt;tn<_n.length;tn+=1)tt.push(_n[tn]);tt.sort(Sb);for(var zn,Dn={},cr=function(Ir){var Br=tt[Ir];if(Br!==zn){zn=Br;var jr=M.featureIndexArray.get(Br),bi=null;M.loadMatchingFeature(Dn,jr.bucketIndex,jr.sourceLayerIndex,jr.featureIndex,Q,B.layers,B.availableImages,d,g,A,function(Zi,Ro,ki){return bi||(bi=Rs(Zi)),Ro.queryIntersectsFeature(me,Zi,ki,bi,M.z,c.transform,V,c.pixelPosMatrix)})}},_r=0;_r<tt.length;_r++)cr(_r);return Dn},Mh.prototype.loadMatchingFeature=function(c,d,g,A,M,B,V,Q,me,Le,We){var tt=this.bucketLayerIDs[d];if(!B||function(Zi,Ro){for(var ki=0;ki<Zi.length;ki++)if(Ro.indexOf(Zi[ki])>=0)return!0;return!1}(B,tt)){var Et=this.sourceLayerCoder.decode(g),Nt=this.vtLayers[Et].feature(A);if(M.needGeometry){var tn=ll(Nt,!0);if(!M.filter(new Ta(this.tileID.overscaledZ),tn,this.tileID.canonical))return}else if(!M.filter(new Ta(this.tileID.overscaledZ),Nt))return;for(var _n=this.getId(Nt,Et),zn=0;zn<tt.length;zn++){var Dn=tt[zn];if(!(B&&B.indexOf(Dn)<0)){var cr=Q[Dn];if(cr){var _r={};_n!==void 0&&Le&&(_r=Le.getState(cr.sourceLayer||"_geojsonTileLayer",_n));var Ir=we({},me[Dn]);Ir.paint=L1(Ir.paint,cr.paint,Nt,_r,V),Ir.layout=L1(Ir.layout,cr.layout,Nt,_r,V);var Br=!We||We(Nt,cr,_r);if(Br){var jr=new Hs(Nt,this.z,this.x,this.y,_n);jr.layer=Ir;var bi=c[Dn];bi===void 0&&(bi=c[Dn]=[]),bi.push({featureIndex:A,feature:jr,intersectionZ:Br})}}}}}},Mh.prototype.lookupSymbolFeatures=function(c,d,g,A,M,B,V,Q){var me={};this.loadVTLayers();for(var Le=Fu(M),We=0,tt=c;We<tt.length;We+=1)this.loadMatchingFeature(me,g,A,tt[We],Le,B,V,Q,d);return me},Mh.prototype.hasLayer=function(c){for(var d=0,g=this.bucketLayerIDs;d<g.length;d+=1)for(var A=0,M=g[d];A<M.length;A+=1)if(c===M[A])return!0;return!1},Mh.prototype.getId=function(c,d){var g=c.id;return this.promoteId&&typeof(g=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(g=Number(g)),g},io("FeatureIndex",Mh,{omit:["rawTileData","sourceLayerCoder"]});var tu=function(c,d){this.tileID=c,this.uid=Ze(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};tu.prototype.registerFadeDuration=function(c){var d=c+this.timeAdded;d<jn.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},tu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},tu.prototype.loadVectorData=function(c,d,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){for(var A in c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(Le,We){var tt={};if(!We)return tt;for(var Et=function(){var _n=tn[Nt],zn=_n.layerIds.map(function(_r){return We.getLayer(_r)}).filter(Boolean);if(zn.length!==0){_n.layers=zn,_n.stateDependentLayerIds&&(_n.stateDependentLayers=_n.stateDependentLayerIds.map(function(_r){return zn.filter(function(Ir){return Ir.id===_r})[0]}));for(var Dn=0,cr=zn;Dn<cr.length;Dn+=1)tt[cr[Dn].id]=_n}},Nt=0,tn=Le;Nt<tn.length;Nt+=1)Et();return tt}(c.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var M=this.buckets[A];if(M instanceof co){if(this.hasSymbolBuckets=!0,!g)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var B in this.buckets){var V=this.buckets[B];if(V instanceof co&&V.hasRTLText){this.hasRTLText=!0,af.isLoading()||af.isLoaded()||z0()!=="deferred"||su();break}}for(var Q in this.queryPadding=0,this.buckets){var me=this.buckets[Q];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(Q).queryRadius(me))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new S},tu.prototype.unloadVectorData=function(){for(var c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},tu.prototype.getBucket=function(c){return this.buckets[c.id]},tu.prototype.upload=function(c){for(var d in this.buckets){var g=this.buckets[d];g.uploadPending()&&g.upload(c)}var A=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Lp(c,this.imageAtlas.image,A.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Lp(c,this.glyphAtlasImage,A.ALPHA),this.glyphAtlasImage=null)},tu.prototype.prepare=function(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)},tu.prototype.queryRenderedFeatures=function(c,d,g,A,M,B,V,Q,me,Le){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:A,cameraQueryGeometry:M,scale:B,tileSize:this.tileSize,pixelPosMatrix:Le,transform:Q,params:V,queryPadding:this.queryPadding*me},c,d,g):{}},tu.prototype.querySourceFeatures=function(c,d){var g=this.latestFeatureIndex;if(g&&g.rawTileData){var A=g.loadVTLayers(),M=d?d.sourceLayer:"",B=A._geojsonTileLayer||A[M];if(B)for(var V=Fu(d&&d.filter),Q=this.tileID.canonical,me=Q.z,Le=Q.x,We=Q.y,tt={z:me,x:Le,y:We},Et=0;Et<B.length;Et++){var Nt=B.feature(Et);if(V.needGeometry){var tn=ll(Nt,!0);if(!V.filter(new Ta(this.tileID.overscaledZ),tn,this.tileID.canonical))continue}else if(!V.filter(new Ta(this.tileID.overscaledZ),Nt))continue;var _n=g.getId(Nt,M),zn=new Hs(Nt,me,Le,We,_n);zn.tile=tt,c.push(zn)}}},tu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},tu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},tu.prototype.setExpiryData=function(c){var d=this.expirationTime;if(c.cacheControl){var g=Ot(c.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){var A=Date.now(),M=!1;if(this.expirationTime>A)M=!1;else if(d)if(this.expirationTime<d)M=!0;else{var B=this.expirationTime-d;B?this.expirationTime=A+Math.max(B,3e4):M=!0}else M=!0;M?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},tu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},tu.prototype.setFeatureState=function(c,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(c).length!==0){var g=this.latestFeatureIndex.loadVTLayers();for(var A in this.buckets)if(d.style.hasLayer(A)){var M=this.buckets[A],B=M.layers[0].sourceLayer||"_geojsonTileLayer",V=g[B],Q=c[B];if(V&&Q&&Object.keys(Q).length!==0){M.update(Q,V,this.imageAtlas&&this.imageAtlas.patternPositions||{});var me=d&&d.style&&d.style.getLayer(A);me&&(this.queryPadding=Math.max(this.queryPadding,me.queryRadius(M)))}}}},tu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},tu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<jn.now()},tu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},tu.prototype.setHoldDuration=function(c){this.symbolFadeHoldUntil=jn.now()+c},tu.prototype.setDependencies=function(c,d){for(var g={},A=0,M=d;A<M.length;A+=1)g[M[A]]=!0;this.dependencies[c]=g},tu.prototype.hasDependency=function(c,d){for(var g=0,A=c;g<A.length;g+=1){var M=this.dependencies[A[g]];if(M){for(var B=0,V=d;B<V.length;B+=1)if(M[V[B]])return!0}}return!1};var f0=oe.performance,Ty=function(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},f0.mark(this._marks.start)};Ty.prototype.finish=function(){f0.mark(this._marks.end);var c=f0.getEntriesByName(this._marks.measure);return c.length===0&&(f0.measure(this._marks.measure,this._marks.start,this._marks.end),c=f0.getEntriesByName(this._marks.measure),f0.clearMarks(this._marks.start),f0.clearMarks(this._marks.end),f0.clearMeasures(this._marks.measure)),c},E.Actor=Z0,E.AlphaImage=wf,E.CanonicalTileID=Id,E.CollisionBoxArray=S,E.Color=pn,E.DEMData=op,E.DataConstantProperty=jo,E.DictionaryCoder=hg,E.EXTENT=8192,E.ErrorEvent=qt,E.EvaluationParameters=Ta,E.Event=wt,E.Evented=vn,E.FeatureIndex=Mh,E.FillBucket=Of,E.FillExtrusionBucket=Qc,E.ImageAtlas=qr,E.ImagePosition=$i,E.LineBucket=Jc,E.LngLat=cl,E.LngLatBounds=Va,E.MercatorCoordinate=Dp,E.ONE_EM=24,E.OverscaledTileID=ul,E.Point=se,E.Point$1=se,E.Properties=dl,E.Protobuf=Or,E.RGBAImage=uu,E.RequestManager=Ut,E.RequestPerformance=Ty,E.ResourceType=Fe,E.SegmentVector=St,E.SourceFeatureState=Ld,E.StructArrayLayout1ui2=Tu,E.StructArrayLayout2f1f2i16=xf,E.StructArrayLayout2i4=Kh,E.StructArrayLayout3ui6=sf,E.StructArrayLayout4i8=U0,E.SymbolBucket=co,E.Texture=Lp,E.Tile=tu,E.Transitionable=cc,E.Uniform1f=Mi,E.Uniform1i=Fr,E.Uniform2f=Pi,E.Uniform3f=vi,E.Uniform4f=Oo,E.UniformColor=yo,E.UniformMatrix4f=is,E.UnwrappedTileID=I1,E.ValidationError=Jt,E.WritingMode=Zo,E.ZoomHistory=r0,E.add=function(c,d,g){return c[0]=d[0]+g[0],c[1]=d[1]+g[1],c[2]=d[2]+g[2],c},E.addDynamicAttributes=di,E.asyncAll=function(c,d,g){if(!c.length)return g(null,[]);var A=c.length,M=new Array(c.length),B=null;c.forEach(function(V,Q){d(V,function(me,Le){me&&(B=me),M[Q]=Le,--A==0&&g(B,M)})})},E.bezier=te,E.bindAll=Zt,E.browser=jn,E.cacheEntryPossiblyAdded=function(c){++dt>Ht&&(c.getActor().send("enforceCacheSizeLimit",ht),dt=0)},E.clamp=Be,E.clearTileCache=function(c){var d=oe.caches.delete("mapbox-tiles");c&&d.catch(c).then(function(){return c()})},E.clipLine=hu,E.clone=function(c){var d=new ga(16);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15],d},E.clone$1=Re,E.clone$2=function(c){var d=new ga(3);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d},E.collisionCircleLayout=Ue,E.config=lr,E.create=function(){var c=new ga(16);return ga!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},E.create$1=function(){var c=new ga(9);return ga!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},E.create$2=function(){var c=new ga(4);return ga!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},E.createCommonjsModule=_e,E.createExpression=Qa,E.createLayout=uc,E.createStyleLayer=function(c){return c.type==="custom"?new cg(c):new Pd[c.type](c)},E.cross=function(c,d,g){var A=d[0],M=d[1],B=d[2],V=g[0],Q=g[1],me=g[2];return c[0]=M*me-B*Q,c[1]=B*V-A*me,c[2]=A*Q-M*V,c},E.deepEqual=function c(d,g){if(Array.isArray(d)){if(!Array.isArray(g)||d.length!==g.length)return!1;for(var A=0;A<d.length;A++)if(!c(d[A],g[A]))return!1;return!0}if(typeof d=="object"&&d!==null&&g!==null){if(typeof g!="object"||Object.keys(d).length!==Object.keys(g).length)return!1;for(var M in d)if(!c(d[M],g[M]))return!1;return!0}return d===g},E.dot=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]},E.dot$1=function(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3]},E.ease=ve,E.emitValidationErrors=bs,E.endsWith=pt,E.enforceCacheSizeLimit=function(c){Cn(),j&&j.then(function(d){d.keys().then(function(g){for(var A=0;A<g.length-c;A++)d.delete(g[A])})})},E.evaluateSizeForFeature=Kl,E.evaluateSizeForZoom=dc,E.evaluateVariableOffset=Kn,E.evented=k0,E.extend=we,E.featureFilter=Fu,E.filterObject=ke,E.fromRotation=function(c,d){var g=Math.sin(d),A=Math.cos(d);return c[0]=A,c[1]=g,c[2]=0,c[3]=-g,c[4]=A,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},E.getAnchorAlignment=Js,E.getAnchorJustification=nr,E.getArrayBuffer=xr,E.getImage=be,E.getJSON=function(c,d){return $n(we(c,{type:"json"}),d)},E.getRTLTextPluginStatus=z0,E.getReferrer=Pt,E.getVideo=function(c,d){var g,A,M=oe.document.createElement("video");M.muted=!0,M.onloadstart=function(){d(null,M)};for(var B=0;B<c.length;B++){var V=oe.document.createElement("source");g=c[B],A=void 0,(A=oe.document.createElement("a")).href=g,(A.protocol!==oe.document.location.protocol||A.host!==oe.document.location.host)&&(M.crossOrigin="Anonymous"),V.src=c[B],M.appendChild(V)}return{cancel:function(){}}},E.identity=xl,E.invert=function(c,d){var g=d[0],A=d[1],M=d[2],B=d[3],V=d[4],Q=d[5],me=d[6],Le=d[7],We=d[8],tt=d[9],Et=d[10],Nt=d[11],tn=d[12],_n=d[13],zn=d[14],Dn=d[15],cr=g*Q-A*V,_r=g*me-M*V,Ir=g*Le-B*V,Br=A*me-M*Q,jr=A*Le-B*Q,bi=M*Le-B*me,Zi=We*_n-tt*tn,Ro=We*zn-Et*tn,ki=We*Dn-Nt*tn,zo=tt*zn-Et*_n,ao=tt*Dn-Nt*_n,xa=Et*Dn-Nt*zn,Mo=cr*xa-_r*ao+Ir*zo+Br*ki-jr*Ro+bi*Zi;return Mo?(c[0]=(Q*xa-me*ao+Le*zo)*(Mo=1/Mo),c[1]=(M*ao-A*xa-B*zo)*Mo,c[2]=(_n*bi-zn*jr+Dn*Br)*Mo,c[3]=(Et*jr-tt*bi-Nt*Br)*Mo,c[4]=(me*ki-V*xa-Le*Ro)*Mo,c[5]=(g*xa-M*ki+B*Ro)*Mo,c[6]=(zn*Ir-tn*bi-Dn*_r)*Mo,c[7]=(We*bi-Et*Ir+Nt*_r)*Mo,c[8]=(V*ao-Q*ki+Le*Zi)*Mo,c[9]=(A*ki-g*ao-B*Zi)*Mo,c[10]=(tn*jr-_n*Ir+Dn*cr)*Mo,c[11]=(tt*Ir-We*jr-Nt*cr)*Mo,c[12]=(Q*Ro-V*zo-me*Zi)*Mo,c[13]=(g*zo-A*Ro+M*Zi)*Mo,c[14]=(_n*_r-tn*Br-zn*cr)*Mo,c[15]=(We*Br-tt*_r+Et*cr)*Mo,c):null},E.isChar=Xi,E.isMapboxURL=Dt,E.keysDifference=function(c,d){var g=[];for(var A in c)A in d||g.push(A);return g},E.makeRequest=$n,E.mapObject=vt,E.mercatorXfromLng=fg,E.mercatorYfromLat=Tm,E.mercatorZfromAltitude=Eb,E.mul=a0,E.multiply=Ba,E.mvt=np,E.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},E.normalize=function(c,d){var g=d[0],A=d[1],M=d[2],B=g*g+A*A+M*M;return B>0&&(B=1/Math.sqrt(B)),c[0]=d[0]*B,c[1]=d[1]*B,c[2]=d[2]*B,c},E.number=Xs,E.offscreenCanvasSupported=ye,E.ortho=function(c,d,g,A,M,B,V){var Q=1/(d-g),me=1/(A-M),Le=1/(B-V);return c[0]=-2*Q,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*me,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*Le,c[11]=0,c[12]=(d+g)*Q,c[13]=(M+A)*me,c[14]=(V+B)*Le,c[15]=1,c},E.parseGlyphPBF=function(c){return new Or(c).readFields(si,[])},E.pbf=Or,E.performSymbolLayout=function(c,d,g,A,M,B,V){c.createArrays(),c.tilePixelRatio=8192/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;var Q=c.layers[0].layout,me=c.layers[0]._unevaluatedLayout._values,Le={};if(c.textSizeData.kind==="composite"){var We=c.textSizeData,tt=We.maxZoom;Le.compositeTextSizes=[me["text-size"].possiblyEvaluate(new Ta(We.minZoom),V),me["text-size"].possiblyEvaluate(new Ta(tt),V)]}if(c.iconSizeData.kind==="composite"){var Et=c.iconSizeData,Nt=Et.maxZoom;Le.compositeIconSizes=[me["icon-size"].possiblyEvaluate(new Ta(Et.minZoom),V),me["icon-size"].possiblyEvaluate(new Ta(Nt),V)]}Le.layoutTextSize=me["text-size"].possiblyEvaluate(new Ta(c.zoom+1),V),Le.layoutIconSize=me["icon-size"].possiblyEvaluate(new Ta(c.zoom+1),V),Le.textMaxSize=me["text-size"].possiblyEvaluate(new Ta(18));for(var tn=24*Q.get("text-line-height"),_n=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",zn=Q.get("text-keep-upright"),Dn=Q.get("text-size"),cr=function(){var Br=Ir[_r],jr=Q.get("text-font").evaluate(Br,{},V).join(","),bi=Dn.evaluate(Br,{},V),Zi=Le.layoutTextSize.evaluate(Br,{},V),Ro=Le.layoutIconSize.evaluate(Br,{},V),ki={horizontal:{},vertical:void 0},zo=Br.text,ao=[0,0];if(zo){var xa=zo.toString(),Mo=24*Q.get("text-letter-spacing").evaluate(Br,{},V),_o=function(Ya){for(var $s=0,Zs=Ya;$s<Zs.length;$s+=1)if(ms=Zs[$s].charCodeAt(0),Xi.Arabic(ms)||Xi["Arabic Supplement"](ms)||Xi["Arabic Extended-A"](ms)||Xi["Arabic Presentation Forms-A"](ms)||Xi["Arabic Presentation Forms-B"](ms))return!1;var ms;return!0}(xa)?Mo:0,Za=Q.get("text-anchor").evaluate(Br,{},V),pa=Q.get("text-variable-anchor");if(!pa){var Oa=Q.get("text-radial-offset").evaluate(Br,{},V);ao=Oa?Kn(Za,[24*Oa,Vn]):Q.get("text-offset").evaluate(Br,{},V).map(function(Ya){return 24*Ya})}var $o=_n?"center":Q.get("text-justify").evaluate(Br,{},V),Es=Q.get("symbol-placement"),Tl=Es==="point"?24*Q.get("text-max-width").evaluate(Br,{},V):0,Vl=function(){c.allowVerticalPlacement&&Ff(xa)&&(ki.vertical=Pa(zo,d,g,M,jr,Tl,tn,Za,"left",_o,ao,Zo.vertical,!0,Es,Zi,bi))};if(!_n&&pa){for(var Hl=$o==="auto"?pa.map(function(Ya){return nr(Ya)}):[$o],wl=!1,ql=0;ql<Hl.length;ql++){var jc=Hl[ql];if(!ki.horizontal[jc])if(wl)ki.horizontal[jc]=ki.horizontal[0];else{var nu=Pa(zo,d,g,M,jr,Tl,tn,"center",jc,_o,ao,Zo.horizontal,!1,Es,Zi,bi);nu&&(ki.horizontal[jc]=nu,wl=nu.positionedLines.length===1)}}Vl()}else{$o==="auto"&&($o=nr(Za));var fl=Pa(zo,d,g,M,jr,Tl,tn,Za,$o,_o,ao,Zo.horizontal,!1,Es,Zi,bi);fl&&(ki.horizontal[$o]=fl),Vl(),Ff(xa)&&_n&&zn&&(ki.vertical=Pa(zo,d,g,M,jr,Tl,tn,Za,$o,_o,ao,Zo.vertical,!1,Es,Zi,bi))}}var Cc=void 0,Vu=!1;if(Br.icon&&Br.icon.name){var ac=A[Br.icon.name];ac&&(Cc=function(Ya,$s,Zs){var ms=Js(Zs),Hu=$s[0]-Ya.displaySize[0]*ms.horizontalAlign,du=$s[1]-Ya.displaySize[1]*ms.verticalAlign;return{image:Ya,top:du,bottom:du+Ya.displaySize[1],left:Hu,right:Hu+Ya.displaySize[0]}}(M[Br.icon.name],Q.get("icon-offset").evaluate(Br,{},V),Q.get("icon-anchor").evaluate(Br,{},V)),Vu=ac.sdf,c.sdfIcons===void 0?c.sdfIcons=ac.sdf:c.sdfIcons!==ac.sdf&&gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ac.pixelRatio!==c.pixelRatio||Q.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}var Oc=Zn(ki.horizontal)||ki.vertical;c.iconsInText=!!Oc&&Oc.iconsInText,(Oc||Cc)&&function(Ya,$s,Zs,ms,Hu,du,il,sc,Al,Ss,Bp){var uf=du.textMaxSize.evaluate($s,{});uf===void 0&&(uf=il);var Zu,Ql=Ya.layers[0].layout,ch=Ql.get("icon-offset").evaluate($s,{},Bp),Rf=Zn(Zs.horizontal),ap=il/24,Dd=Ya.tilePixelRatio*ap,wm=Ya.tilePixelRatio*uf/24,Nd=Ya.tilePixelRatio*sc,sp=Ya.tilePixelRatio*Ql.get("symbol-spacing"),Am=Ql.get("text-padding")*Ya.tilePixelRatio,Cm=Ql.get("icon-padding")*Ya.tilePixelRatio,h0=Ql.get("text-max-angle")/180*Math.PI,Om=Ql.get("text-rotation-alignment")==="map"&&Ql.get("symbol-placement")!=="point",wy=Ql.get("icon-rotation-alignment")==="map"&&Ql.get("symbol-placement")!=="point",od=Ql.get("symbol-placement"),Fp=sp/2,W0=Ql.get("icon-text-fit");ms&&W0!=="none"&&(Ya.allowVerticalPlacement&&Zs.vertical&&(Zu=Yl(ms,Zs.vertical,W0,Ql.get("icon-text-fit-padding"),ch,ap)),Rf&&(ms=Yl(ms,Rf,W0,Ql.get("icon-text-fit-padding"),ch,ap)));var d0=function(Cv,jp){jp.x<0||jp.x>=8192||jp.y<0||jp.y>=8192||function(Zl,ad,dg,Cu,Hf,uh,Ov,ff,pg,Rv,Vp,mg,vg,Cy,y0,N1,B1,F1,gg,Oy,fh,Mv,yg,Ph,_g){var Ry,_0,Vc,Fm,km,Y0=Zl.addToLineVertexArray(ad,dg),$0=0,k1=0,bg=0,z1=0,zm=-1,xg=-1,Ih={},Eg=cn(""),Sg=0,Tg=0;if(ff._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Sg=(Ry=ff.layout.get("text-offset").evaluate(fh,{},Ph).map(function(Hp){return 24*Hp}))[0],Tg=Ry[1]):(Sg=24*ff.layout.get("text-radial-offset").evaluate(fh,{},Ph),Tg=Vn),Zl.allowVerticalPlacement&&Cu.vertical){var Cl=ff.layout.get("text-rotate").evaluate(fh,{},Ph)+90;Fm=new as(pg,ad,Rv,Vp,mg,Cu.vertical,vg,Cy,y0,Cl),Ov&&(km=new as(pg,ad,Rv,Vp,mg,Ov,B1,F1,y0,Cl))}if(Hf){var My=ff.layout.get("icon-rotate").evaluate(fh,{}),Py=ff.layout.get("icon-text-fit")!=="none",Tb=dn(Hf,My,yg,Py),U1=Ov?dn(Ov,My,yg,Py):void 0;Vc=new as(pg,ad,Rv,Vp,mg,Hf,B1,F1,!1,My),$0=4*Tb.length;var Iy=Zl.iconSizeData,Um=null;Iy.kind==="source"?(Um=[128*ff.layout.get("icon-size").evaluate(fh,{})])[0]>32640&&gt(Zl.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Iy.kind==="composite"&&((Um=[128*Mv.compositeIconSizes[0].evaluate(fh,{},Ph),128*Mv.compositeIconSizes[1].evaluate(fh,{},Ph)])[0]>32640||Um[1]>32640)&&gt(Zl.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Zl.addSymbols(Zl.icon,Tb,Um,Oy,gg,fh,!1,ad,Y0.lineStartIndex,Y0.lineLength,-1,Ph),zm=Zl.icon.placedSymbolArray.length-1,U1&&(k1=4*U1.length,Zl.addSymbols(Zl.icon,U1,Um,Oy,gg,fh,Zo.vertical,ad,Y0.lineStartIndex,Y0.lineLength,-1,Ph),xg=Zl.icon.placedSymbolArray.length-1)}for(var j1 in Cu.horizontal){var Ts=Cu.horizontal[j1];if(!_0){Eg=cn(Ts.text);var V1=ff.layout.get("text-rotate").evaluate(fh,{},Ph);_0=new as(pg,ad,Rv,Vp,mg,Ts,vg,Cy,y0,V1)}var wb=Ts.positionedLines.length===1;if(bg+=bn(Zl,ad,Ts,uh,ff,y0,fh,N1,Y0,Cu.vertical?Zo.horizontal:Zo.horizontalOnly,wb?Object.keys(Cu.horizontal):[j1],Ih,zm,Mv,Ph),wb)break}Cu.vertical&&(z1+=bn(Zl,ad,Cu.vertical,uh,ff,y0,fh,N1,Y0,Zo.vertical,["vertical"],Ih,xg,Mv,Ph));var sd=_0?_0.boxStartIndex:Zl.collisionBoxArray.length,Pv=_0?_0.boxEndIndex:Zl.collisionBoxArray.length,wg=Fm?Fm.boxStartIndex:Zl.collisionBoxArray.length,H1=Fm?Fm.boxEndIndex:Zl.collisionBoxArray.length,Iv=Vc?Vc.boxStartIndex:Zl.collisionBoxArray.length,Ag=Vc?Vc.boxEndIndex:Zl.collisionBoxArray.length,Z1=km?km.boxStartIndex:Zl.collisionBoxArray.length,F2=km?km.boxEndIndex:Zl.collisionBoxArray.length,cp=-1,b0=function(Hp,K0){return Hp&&Hp.circleDiameter?Math.max(Hp.circleDiameter,K0):K0};cp=b0(_0,cp),cp=b0(Fm,cp),cp=b0(Vc,cp);var jm=(cp=b0(km,cp))>-1?1:0;jm&&(cp*=_g/24),Zl.glyphOffsetArray.length>=co.MAX_GLYPHS&&gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fh.sortKey!==void 0&&Zl.addToSortKeyRanges(Zl.symbolInstances.length,fh.sortKey),Zl.symbolInstances.emplaceBack(ad.x,ad.y,Ih.right>=0?Ih.right:-1,Ih.center>=0?Ih.center:-1,Ih.left>=0?Ih.left:-1,Ih.vertical||-1,zm,xg,Eg,sd,Pv,wg,H1,Iv,Ag,Z1,F2,Rv,bg,z1,$0,k1,jm,0,vg,Sg,Tg,cp)}(Ya,jp,Cv,Zs,ms,Hu,Zu,Ya.layers[0],Ya.collisionBoxArray,$s.index,$s.sourceLayerIndex,Ya.index,Dd,Am,Om,Al,Nd,Cm,wy,ch,$s,du,Ss,Bp,il)};if(od==="line")for(var Rm=0,kp=hu($s.geometry,0,0,8192,8192);Rm<kp.length;Rm+=1)for(var Mm=kp[Rm],Tv=0,zp=Dl(Mm,sp,h0,Zs.vertical||Rf,ms,24,wm,Ya.overscaling,8192);Tv<zp.length;Tv+=1){var Pm=zp[Tv];Rf&&nn(Ya,Rf.text,Fp,Pm)||d0(Mm,Pm)}else if(od==="line-center")for(var Im=0,p0=$s.geometry;Im<p0.length;Im+=1){var G0=p0[Im];if(G0.length>1){var Ay=us(G0,h0,Zs.vertical||Rf,ms,24,wm);Ay&&d0(G0,Ay)}}else if($s.type==="Polygon")for(var X0=0,m0=sh($s.geometry,0);X0<m0.length;X0+=1){var Lm=m0[X0],v0=In(Lm,16);d0(Lm[0],new ps(v0.x,v0.y,0))}else if($s.type==="LineString")for(var lp=0,g0=$s.geometry;lp<g0.length;lp+=1){var Up=g0[lp];d0(Up,new ps(Up[0].x,Up[0].y,0))}else if($s.type==="Point")for(var Dm=0,wv=$s.geometry;Dm<wv.length;Dm+=1)for(var Nm=0,Av=wv[Dm];Nm<Av.length;Nm+=1){var Bm=Av[Nm];d0([Bm],new ps(Bm.x,Bm.y,0))}}(c,Br,ki,Cc,A,Le,Zi,Ro,ao,Vu,V)},_r=0,Ir=c.features;_r<Ir.length;_r+=1)cr();B&&c.generateCollisionDebugBuffers()},E.perspective=function(c,d,g,A,M){var B,V=1/Math.tan(d/2);return c[0]=V/g,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=V,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,M!=null&&M!==1/0?(c[10]=(M+A)*(B=1/(A-M)),c[14]=2*M*A*B):(c[10]=-1,c[14]=-2*A),c},E.pick=function(c,d){for(var g={},A=0;A<d.length;A++){var M=d[A];M in c&&(g[M]=c[M])}return g},E.plugin=af,E.polygonIntersectsPolygon=Ch,E.postMapLoadEvent=hn,E.postTurnstileEvent=Gt,E.potpack=fa,E.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],E.register=io,E.registerForPluginStateChange=function(c){return c({pluginStatus:Gc,pluginURL:th}),k0.on("pluginStateChange",c),c},E.renderColorRamp=dm,E.rotate=function(c,d,g){var A=d[0],M=d[1],B=d[2],V=d[3],Q=Math.sin(g),me=Math.cos(g);return c[0]=A*me+B*Q,c[1]=M*me+V*Q,c[2]=A*-Q+B*me,c[3]=M*-Q+V*me,c},E.rotateX=function(c,d,g){var A=Math.sin(g),M=Math.cos(g),B=d[4],V=d[5],Q=d[6],me=d[7],Le=d[8],We=d[9],tt=d[10],Et=d[11];return d!==c&&(c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[4]=B*M+Le*A,c[5]=V*M+We*A,c[6]=Q*M+tt*A,c[7]=me*M+Et*A,c[8]=Le*M-B*A,c[9]=We*M-V*A,c[10]=tt*M-Q*A,c[11]=Et*M-me*A,c},E.rotateZ=function(c,d,g){var A=Math.sin(g),M=Math.cos(g),B=d[0],V=d[1],Q=d[2],me=d[3],Le=d[4],We=d[5],tt=d[6],Et=d[7];return d!==c&&(c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15]),c[0]=B*M+Le*A,c[1]=V*M+We*A,c[2]=Q*M+tt*A,c[3]=me*M+Et*A,c[4]=Le*M-B*A,c[5]=We*M-V*A,c[6]=tt*M-Q*A,c[7]=Et*M-me*A,c},E.scale=function(c,d,g){var A=g[0],M=g[1],B=g[2];return c[0]=d[0]*A,c[1]=d[1]*A,c[2]=d[2]*A,c[3]=d[3]*A,c[4]=d[4]*M,c[5]=d[5]*M,c[6]=d[6]*M,c[7]=d[7]*M,c[8]=d[8]*B,c[9]=d[9]*B,c[10]=d[10]*B,c[11]=d[11]*B,c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],c},E.scale$1=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c[3]=d[3]*g,c},E.scale$2=function(c,d,g){return c[0]=d[0]*g,c[1]=d[1]*g,c[2]=d[2]*g,c},E.setCacheLimits=function(c,d){ht=c,Ht=d},E.setRTLTextPlugin=function(c,d,g){if(g===void 0&&(g=!1),Gc==="deferred"||Gc==="loading"||Gc==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");th=jn.resolveURL(c),Gc="deferred",Sp=d,Sd(),g||su()},E.sphericalToCartesian=function(c){var d=c[0],g=c[1],A=c[2];return g+=90,g*=Math.PI/180,A*=Math.PI/180,{x:d*Math.cos(g)*Math.sin(A),y:d*Math.sin(g)*Math.sin(A),z:d*Math.cos(A)}},E.sqrLen=function(c){var d=c[0],g=c[1];return d*d+g*g},E.styleSpec=yt,E.sub=function(c,d,g){return c[0]=d[0]-g[0],c[1]=d[1]-g[1],c[2]=d[2]-g[2],c},E.symbolSize=Ca,E.transformMat3=function(c,d,g){var A=d[0],M=d[1],B=d[2];return c[0]=A*g[0]+M*g[3]+B*g[6],c[1]=A*g[1]+M*g[4]+B*g[7],c[2]=A*g[2]+M*g[5]+B*g[8],c},E.transformMat4=Tf,E.translate=function(c,d,g){var A,M,B,V,Q,me,Le,We,tt,Et,Nt,tn,_n=g[0],zn=g[1],Dn=g[2];return d===c?(c[12]=d[0]*_n+d[4]*zn+d[8]*Dn+d[12],c[13]=d[1]*_n+d[5]*zn+d[9]*Dn+d[13],c[14]=d[2]*_n+d[6]*zn+d[10]*Dn+d[14],c[15]=d[3]*_n+d[7]*zn+d[11]*Dn+d[15]):(M=d[1],B=d[2],V=d[3],Q=d[4],me=d[5],Le=d[6],We=d[7],tt=d[8],Et=d[9],Nt=d[10],tn=d[11],c[0]=A=d[0],c[1]=M,c[2]=B,c[3]=V,c[4]=Q,c[5]=me,c[6]=Le,c[7]=We,c[8]=tt,c[9]=Et,c[10]=Nt,c[11]=tn,c[12]=A*_n+Q*zn+tt*Dn+d[12],c[13]=M*_n+me*zn+Et*Dn+d[13],c[14]=B*_n+Le*zn+Nt*Dn+d[14],c[15]=V*_n+We*zn+tn*Dn+d[15]),c},E.triggerPluginCompletionEvent=i0,E.uniqueId=Ze,E.validateCustomStyleLayer=function(c){var d=[],g=c.id;return g===void 0&&d.push({message:"layers."+g+': missing required property "id"'}),c.render===void 0&&d.push({message:"layers."+g+': missing required method "render"'}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&d.push({message:"layers."+g+': property "renderingMode" must be either "2d" or "3d"'}),d},E.validateLight=Ki,E.validateStyle=mi,E.values=function(c){var d=[];for(var g in c)d.push(c[g]);return d},E.vectorTile=np,E.version="1.13.3",E.warnOnce=gt,E.webpSupported=Vt,E.window=oe,E.wrap=Te}),X(["./shared"],function(E){"use strict";function _e(Ae){var be=typeof Ae;if(be==="number"||be==="boolean"||be==="string"||Ae==null)return JSON.stringify(Ae);if(Array.isArray(Ae)){for(var Ne="[",et=0,wt=Ae;et<wt.length;et+=1)Ne+=_e(wt[et])+",";return Ne+"]"}for(var qt=Object.keys(Ae).sort(),vn="{",yt=0;yt<qt.length;yt++)vn+=JSON.stringify(qt[yt])+":"+_e(Ae[qt[yt]])+",";return vn+"}"}function re(Ae){for(var be="",Ne=0,et=E.refProperties;Ne<et.length;Ne+=1)be+="/"+_e(Ae[et[Ne]]);return be}var he=function(Ae){this.keyCache={},Ae&&this.replace(Ae)};he.prototype.replace=function(Ae){this._layerConfigs={},this._layers={},this.update(Ae,[])},he.prototype.update=function(Ae,be){for(var Ne=this,et=0,wt=Ae;et<wt.length;et+=1){var qt=wt[et];this._layerConfigs[qt.id]=qt;var vn=this._layers[qt.id]=E.createStyleLayer(qt);vn._featureFilter=E.featureFilter(vn.filter),this.keyCache[qt.id]&&delete this.keyCache[qt.id]}for(var yt=0,Jt=be;yt<Jt.length;yt+=1){var Qn=Jt[yt];delete this.keyCache[Qn],delete this._layerConfigs[Qn],delete this._layers[Qn]}this.familiesBySource={};for(var Er=0,Vr=function(hi,Qr){for(var Io={},Ii=0;Ii<hi.length;Ii++){var Fo=Qr&&Qr[hi[Ii].id]||re(hi[Ii]);Qr&&(Qr[hi[Ii].id]=Fo);var _a=Io[Fo];_a||(_a=Io[Fo]=[]),_a.push(hi[Ii])}var Co=[];for(var Qo in Io)Co.push(Io[Qo]);return Co}(E.values(this._layerConfigs),this.keyCache);Er<Vr.length;Er+=1){var mr=Vr[Er].map(function(hi){return Ne._layers[hi.id]}),kr=mr[0];if(kr.visibility!=="none"){var Ei=kr.source||"",Oi=this.familiesBySource[Ei];Oi||(Oi=this.familiesBySource[Ei]={});var ar=kr.sourceLayer||"_geojsonTileLayer",Kr=Oi[ar];Kr||(Kr=Oi[ar]=[]),Kr.push(mr)}}};var se=function(Ae){var be={},Ne=[];for(var et in Ae){var wt=Ae[et],qt=be[et]={};for(var vn in wt){var yt=wt[+vn];if(yt&&yt.bitmap.width!==0&&yt.bitmap.height!==0){var Jt={x:0,y:0,w:yt.bitmap.width+2,h:yt.bitmap.height+2};Ne.push(Jt),qt[vn]={rect:Jt,metrics:yt.metrics}}}}var Qn=E.potpack(Ne),Er=new E.AlphaImage({width:Qn.w||1,height:Qn.h||1});for(var Vr in Ae){var mr=Ae[Vr];for(var kr in mr){var Ei=mr[+kr];if(Ei&&Ei.bitmap.width!==0&&Ei.bitmap.height!==0){var Oi=be[Vr][kr].rect;E.AlphaImage.copy(Ei.bitmap,Er,{x:0,y:0},{x:Oi.x+1,y:Oi.y+1},Ei.bitmap)}}}this.image=Er,this.positions=be};E.register("GlyphAtlas",se);var Se=function(Ae){this.tileID=new E.OverscaledTileID(Ae.tileID.overscaledZ,Ae.tileID.wrap,Ae.tileID.canonical.z,Ae.tileID.canonical.x,Ae.tileID.canonical.y),this.uid=Ae.uid,this.zoom=Ae.zoom,this.pixelRatio=Ae.pixelRatio,this.tileSize=Ae.tileSize,this.source=Ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ae.showCollisionBoxes,this.collectResourceTiming=!!Ae.collectResourceTiming,this.returnDependencies=!!Ae.returnDependencies,this.promoteId=Ae.promoteId};function oe(Ae,be,Ne){for(var et=new E.EvaluationParameters(be),wt=0,qt=Ae;wt<qt.length;wt+=1)qt[wt].recalculate(et,Ne)}function je(Ae,be){var Ne=E.getArrayBuffer(Ae.request,function(et,wt,qt,vn){et?be(et):wt&&be(null,{vectorTile:new E.vectorTile.VectorTile(new E.pbf(wt)),rawData:wt,cacheControl:qt,expires:vn})});return function(){Ne.cancel(),be()}}Se.prototype.parse=function(Ae,be,Ne,et,wt){var qt=this;this.status="parsing",this.data=Ae,this.collisionBoxArray=new E.CollisionBoxArray;var vn=new E.DictionaryCoder(Object.keys(Ae.layers).sort()),yt=new E.FeatureIndex(this.tileID,this.promoteId);yt.bucketLayerIDs=[];var Jt,Qn,Er,Vr,mr={},kr={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ne},Ei=be.familiesBySource[this.source];for(var Oi in Ei){var ar=Ae.layers[Oi];if(ar){ar.version===1&&E.warnOnce('Vector tile source "'+this.source+'" layer "'+Oi+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Kr=vn.encode(Oi),hi=[],Qr=0;Qr<ar.length;Qr++){var Io=ar.feature(Qr),Ii=yt.getId(Io,Oi);hi.push({feature:Io,id:Ii,index:Qr,sourceLayerIndex:Kr})}for(var Fo=0,_a=Ei[Oi];Fo<_a.length;Fo+=1){var Co=_a[Fo],Qo=Co[0];Qo.minzoom&&this.zoom<Math.floor(Qo.minzoom)||Qo.maxzoom&&this.zoom>=Qo.maxzoom||Qo.visibility!=="none"&&(oe(Co,this.zoom,Ne),(mr[Qo.id]=Qo.createBucket({index:yt.bucketLayerIDs.length,layers:Co,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kr,sourceID:this.source})).populate(hi,kr,this.tileID.canonical),yt.bucketLayerIDs.push(Co.map(function(Bn){return Bn.id})))}}}var De=E.mapObject(kr.glyphDependencies,function(Bn){return Object.keys(Bn).map(Number)});Object.keys(De).length?et.send("getGlyphs",{uid:this.uid,stacks:De},function(Bn,kn){Jt||(Jt=Bn,Qn=kn,un.call(qt))}):Qn={};var Je=Object.keys(kr.iconDependencies);Je.length?et.send("getImages",{icons:Je,source:this.source,tileID:this.tileID,type:"icons"},function(Bn,kn){Jt||(Jt=Bn,Er=kn,un.call(qt))}):Er={};var kt=Object.keys(kr.patternDependencies);function un(){if(Jt)return wt(Jt);if(Qn&&Er&&Vr){var Bn=new se(Qn),kn=new E.ImageAtlas(Er,Vr);for(var pn in mr){var On=mr[pn];On instanceof E.SymbolBucket?(oe(On.layers,this.zoom,Ne),E.performSymbolLayout(On,Qn,Bn.positions,Er,kn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):On.hasPattern&&(On instanceof E.LineBucket||On instanceof E.FillBucket||On instanceof E.FillExtrusionBucket)&&(oe(On.layers,this.zoom,Ne),On.addFeatures(kr,this.tileID.canonical,kn.patternPositions))}this.status="done",wt(null,{buckets:E.values(mr).filter(function(vr){return!vr.isEmpty()}),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Bn.image,imageAtlas:kn,glyphMap:this.returnDependencies?Qn:null,iconMap:this.returnDependencies?Er:null,glyphPositions:this.returnDependencies?Bn.positions:null})}}kt.length?et.send("getImages",{icons:kt,source:this.source,tileID:this.tileID,type:"patterns"},function(Bn,kn){Jt||(Jt=Bn,Vr=kn,un.call(qt))}):Vr={},un.call(this)};var te=function(Ae,be,Ne,et){this.actor=Ae,this.layerIndex=be,this.availableImages=Ne,this.loadVectorData=et||je,this.loading={},this.loaded={}};te.prototype.loadTile=function(Ae,be){var Ne=this,et=Ae.uid;this.loading||(this.loading={});var wt=!!(Ae&&Ae.request&&Ae.request.collectResourceTiming)&&new E.RequestPerformance(Ae.request),qt=this.loading[et]=new Se(Ae);qt.abort=this.loadVectorData(Ae,function(vn,yt){if(delete Ne.loading[et],vn||!yt)return qt.status="done",Ne.loaded[et]=qt,be(vn);var Jt=yt.rawData,Qn={};yt.expires&&(Qn.expires=yt.expires),yt.cacheControl&&(Qn.cacheControl=yt.cacheControl);var Er={};if(wt){var Vr=wt.finish();Vr&&(Er.resourceTiming=JSON.parse(JSON.stringify(Vr)))}qt.vectorTile=yt.vectorTile,qt.parse(yt.vectorTile,Ne.layerIndex,Ne.availableImages,Ne.actor,function(mr,kr){if(mr||!kr)return be(mr);be(null,E.extend({rawTileData:Jt.slice(0)},kr,Qn,Er))}),Ne.loaded=Ne.loaded||{},Ne.loaded[et]=qt})},te.prototype.reloadTile=function(Ae,be){var Ne=this,et=this.loaded,wt=Ae.uid,qt=this;if(et&&et[wt]){var vn=et[wt];vn.showCollisionBoxes=Ae.showCollisionBoxes;var yt=function(Jt,Qn){var Er=vn.reloadCallback;Er&&(delete vn.reloadCallback,vn.parse(vn.vectorTile,qt.layerIndex,Ne.availableImages,qt.actor,Er)),be(Jt,Qn)};vn.status==="parsing"?vn.reloadCallback=yt:vn.status==="done"&&(vn.vectorTile?vn.parse(vn.vectorTile,this.layerIndex,this.availableImages,this.actor,yt):yt())}},te.prototype.abortTile=function(Ae,be){var Ne=this.loading,et=Ae.uid;Ne&&Ne[et]&&Ne[et].abort&&(Ne[et].abort(),delete Ne[et]),be()},te.prototype.removeTile=function(Ae,be){var Ne=this.loaded,et=Ae.uid;Ne&&Ne[et]&&delete Ne[et],be()};var ve=E.window.ImageBitmap,Be=function(){this.loaded={}};function Te(Ae,be){if(Ae.length!==0){we(Ae[0],be);for(var Ne=1;Ne<Ae.length;Ne++)we(Ae[Ne],!be)}}function we(Ae,be){for(var Ne=0,et=0,wt=0,qt=Ae.length,vn=qt-1;wt<qt;vn=wt++){var yt=(Ae[wt][0]-Ae[vn][0])*(Ae[vn][1]+Ae[wt][1]),Jt=Ne+yt;et+=Math.abs(Ne)>=Math.abs(yt)?Ne-Jt+yt:yt-Jt+Ne,Ne=Jt}Ne+et>=0!=!!be&&Ae.reverse()}Be.prototype.loadTile=function(Ae,be){var Ne=Ae.uid,et=Ae.encoding,wt=Ae.rawImageData,qt=ve&&wt instanceof ve?this.getImageData(wt):wt,vn=new E.DEMData(Ne,qt,et);this.loaded=this.loaded||{},this.loaded[Ne]=vn,be(null,vn)},Be.prototype.getImageData=function(Ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ae.width,Ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ae.width,this.offscreenCanvas.height=Ae.height,this.offscreenCanvasContext.drawImage(Ae,0,0,Ae.width,Ae.height);var be=this.offscreenCanvasContext.getImageData(-1,-1,Ae.width+2,Ae.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new E.RGBAImage({width:be.width,height:be.height},be.data)},Be.prototype.removeTile=function(Ae){var be=this.loaded,Ne=Ae.uid;be&&be[Ne]&&delete be[Ne]};var le=E.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ze=function(Ae){this._feature=Ae,this.extent=E.EXTENT,this.type=Ae.type,this.properties=Ae.tags,"id"in Ae&&!isNaN(Ae.id)&&(this.id=parseInt(Ae.id,10))};Ze.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ae=[],be=0,Ne=this._feature.geometry;be<Ne.length;be+=1){var et=Ne[be];Ae.push([new E.Point$1(et[0],et[1])])}return Ae}for(var wt=[],qt=0,vn=this._feature.geometry;qt<vn.length;qt+=1){for(var yt=[],Jt=0,Qn=vn[qt];Jt<Qn.length;Jt+=1){var Er=Qn[Jt];yt.push(new E.Point$1(Er[0],Er[1]))}wt.push(yt)}return wt},Ze.prototype.toGeoJSON=function(Ae,be,Ne){return le.call(this,Ae,be,Ne)};var xt=function(Ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.EXTENT,this.length=Ae.length,this._features=Ae};xt.prototype.feature=function(Ae){return new Ze(this._features[Ae])};var ft=E.vectorTile.VectorTileFeature,Zt=pt;function pt(Ae,be){this.options=be||{},this.features=Ae,this.length=Ae.length}function vt(Ae,be){this.id=typeof Ae.id=="number"?Ae.id:void 0,this.type=Ae.type,this.rawGeometry=Ae.type===1?[Ae.geometry]:Ae.geometry,this.properties=Ae.tags,this.extent=be||4096}pt.prototype.feature=function(Ae){return new vt(this.features[Ae],this.options.extent)},vt.prototype.loadGeometry=function(){var Ae=this.rawGeometry;this.geometry=[];for(var be=0;be<Ae.length;be++){for(var Ne=Ae[be],et=[],wt=0;wt<Ne.length;wt++)et.push(new E.Point$1(Ne[wt][0],Ne[wt][1]));this.geometry.push(et)}return this.geometry},vt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ae=this.geometry,be=1/0,Ne=-1/0,et=1/0,wt=-1/0,qt=0;qt<Ae.length;qt++)for(var vn=Ae[qt],yt=0;yt<vn.length;yt++){var Jt=vn[yt];be=Math.min(be,Jt.x),Ne=Math.max(Ne,Jt.x),et=Math.min(et,Jt.y),wt=Math.max(wt,Jt.y)}return[be,et,Ne,wt]},vt.prototype.toGeoJSON=ft.prototype.toGeoJSON;var ke=bt,Re=Zt;function bt(Ae){var be=new E.pbf;return function(Ne,et){for(var wt in Ne.layers)et.writeMessage(3,gt,Ne.layers[wt])}(Ae,be),be.finish()}function gt(Ae,be){var Ne;be.writeVarintField(15,Ae.version||1),be.writeStringField(1,Ae.name||""),be.writeVarintField(5,Ae.extent||4096);var et={keys:[],values:[],keycache:{},valuecache:{}};for(Ne=0;Ne<Ae.length;Ne++)et.feature=Ae.feature(Ne),be.writeMessage(2,Ct,et);var wt=et.keys;for(Ne=0;Ne<wt.length;Ne++)be.writeStringField(3,wt[Ne]);var qt=et.values;for(Ne=0;Ne<qt.length;Ne++)be.writeMessage(4,ot,qt[Ne])}function Ct(Ae,be){var Ne=Ae.feature;Ne.id!==void 0&&be.writeVarintField(1,Ne.id),be.writeMessage(2,Sn,Ae),be.writeVarintField(3,Ne.type),be.writeMessage(4,Ce,Ne)}function Sn(Ae,be){var Ne=Ae.feature,et=Ae.keys,wt=Ae.values,qt=Ae.keycache,vn=Ae.valuecache;for(var yt in Ne.properties){var Jt=qt[yt];Jt===void 0&&(et.push(yt),qt[yt]=Jt=et.length-1),be.writeVarint(Jt);var Qn=Ne.properties[yt],Er=typeof Qn;Er!=="string"&&Er!=="boolean"&&Er!=="number"&&(Qn=JSON.stringify(Qn));var Vr=Er+":"+Qn,mr=vn[Vr];mr===void 0&&(wt.push(Qn),vn[Vr]=mr=wt.length-1),be.writeVarint(mr)}}function He(Ae,be){return(be<<3)+(7&Ae)}function Ot(Ae){return Ae<<1^Ae>>31}function Ce(Ae,be){for(var Ne=Ae.loadGeometry(),et=Ae.type,wt=0,qt=0,vn=Ne.length,yt=0;yt<vn;yt++){var Jt=Ne[yt],Qn=1;et===1&&(Qn=Jt.length),be.writeVarint(He(1,Qn));for(var Er=et===3?Jt.length-1:Jt.length,Vr=0;Vr<Er;Vr++){Vr===1&&et!==1&&be.writeVarint(He(2,Er-1));var mr=Jt[Vr].x-wt,kr=Jt[Vr].y-qt;be.writeVarint(Ot(mr)),be.writeVarint(Ot(kr)),wt+=mr,qt+=kr}et===3&&be.writeVarint(He(7,1))}}function ot(Ae,be){var Ne=typeof Ae;Ne==="string"?be.writeStringField(1,Ae):Ne==="boolean"?be.writeBooleanField(7,Ae):Ne==="number"&&(Ae%1!=0?be.writeDoubleField(3,Ae):Ae<0?be.writeSVarintField(6,Ae):be.writeVarintField(5,Ae))}function $e(Ae,be,Ne,et){Xe(Ae,Ne,et),Xe(be,2*Ne,2*et),Xe(be,2*Ne+1,2*et+1)}function Xe(Ae,be,Ne){var et=Ae[be];Ae[be]=Ae[Ne],Ae[Ne]=et}function Rt(Ae,be,Ne,et){var wt=Ae-Ne,qt=be-et;return wt*wt+qt*qt}ke.fromVectorTileJs=bt,ke.fromGeojsonVt=function(Ae,be){be=be||{};var Ne={};for(var et in Ae)Ne[et]=new Zt(Ae[et].features,be),Ne[et].name=et,Ne[et].version=be.version,Ne[et].extent=be.extent;return bt({layers:Ne})},ke.GeoJSONWrapper=Re;var _t=function(Ae){return Ae[0]},Pe=function(Ae){return Ae[1]},Wt=function(Ae,be,Ne,et,wt){be===void 0&&(be=_t),Ne===void 0&&(Ne=Pe),et===void 0&&(et=64),wt===void 0&&(wt=Float64Array),this.nodeSize=et,this.points=Ae;for(var qt=Ae.length<65536?Uint16Array:Uint32Array,vn=this.ids=new qt(Ae.length),yt=this.coords=new wt(2*Ae.length),Jt=0;Jt<Ae.length;Jt++)vn[Jt]=Jt,yt[2*Jt]=be(Ae[Jt]),yt[2*Jt+1]=Ne(Ae[Jt]);(function Qn(Er,Vr,mr,kr,Ei,Oi){if(!(Ei-kr<=mr)){var ar=kr+Ei>>1;(function Kr(hi,Qr,Io,Ii,Fo,_a){for(;Fo>Ii;){if(Fo-Ii>600){var Co=Fo-Ii+1,Qo=Io-Ii+1,De=Math.log(Co),Je=.5*Math.exp(2*De/3),kt=.5*Math.sqrt(De*Je*(Co-Je)/Co)*(Qo-Co/2<0?-1:1);Kr(hi,Qr,Io,Math.max(Ii,Math.floor(Io-Qo*Je/Co+kt)),Math.min(Fo,Math.floor(Io+(Co-Qo)*Je/Co+kt)),_a)}var un=Qr[2*Io+_a],Bn=Ii,kn=Fo;for($e(hi,Qr,Ii,Io),Qr[2*Fo+_a]>un&&$e(hi,Qr,Ii,Fo);Bn<kn;){for($e(hi,Qr,Bn,kn),Bn++,kn--;Qr[2*Bn+_a]<un;)Bn++;for(;Qr[2*kn+_a]>un;)kn--}Qr[2*Ii+_a]===un?$e(hi,Qr,Ii,kn):$e(hi,Qr,++kn,Fo),kn<=Io&&(Ii=kn+1),Io<=kn&&(Fo=kn-1)}})(Er,Vr,ar,kr,Ei,Oi%2),Qn(Er,Vr,mr,kr,ar-1,Oi+1),Qn(Er,Vr,mr,ar+1,Ei,Oi+1)}})(vn,yt,et,0,vn.length-1,0)};Wt.prototype.range=function(Ae,be,Ne,et){return function(wt,qt,vn,yt,Jt,Qn,Er){for(var Vr,mr,kr=[0,wt.length-1,0],Ei=[];kr.length;){var Oi=kr.pop(),ar=kr.pop(),Kr=kr.pop();if(ar-Kr<=Er)for(var hi=Kr;hi<=ar;hi++)mr=qt[2*hi+1],(Vr=qt[2*hi])>=vn&&Vr<=Jt&&mr>=yt&&mr<=Qn&&Ei.push(wt[hi]);else{var Qr=Math.floor((Kr+ar)/2);mr=qt[2*Qr+1],(Vr=qt[2*Qr])>=vn&&Vr<=Jt&&mr>=yt&&mr<=Qn&&Ei.push(wt[Qr]);var Io=(Oi+1)%2;(Oi===0?vn<=Vr:yt<=mr)&&(kr.push(Kr),kr.push(Qr-1),kr.push(Io)),(Oi===0?Jt>=Vr:Qn>=mr)&&(kr.push(Qr+1),kr.push(ar),kr.push(Io))}}return Ei}(this.ids,this.coords,Ae,be,Ne,et,this.nodeSize)},Wt.prototype.within=function(Ae,be,Ne){return function(et,wt,qt,vn,yt,Jt){for(var Qn=[0,et.length-1,0],Er=[],Vr=yt*yt;Qn.length;){var mr=Qn.pop(),kr=Qn.pop(),Ei=Qn.pop();if(kr-Ei<=Jt)for(var Oi=Ei;Oi<=kr;Oi++)Rt(wt[2*Oi],wt[2*Oi+1],qt,vn)<=Vr&&Er.push(et[Oi]);else{var ar=Math.floor((Ei+kr)/2),Kr=wt[2*ar],hi=wt[2*ar+1];Rt(Kr,hi,qt,vn)<=Vr&&Er.push(et[ar]);var Qr=(mr+1)%2;(mr===0?qt-yt<=Kr:vn-yt<=hi)&&(Qn.push(Ei),Qn.push(ar-1),Qn.push(Qr)),(mr===0?qt+yt>=Kr:vn+yt>=hi)&&(Qn.push(ar+1),Qn.push(kr),Qn.push(Qr))}}return Er}(this.ids,this.coords,Ae,be,Ne,this.nodeSize)};var on={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ae){return Ae}},Nn=function(Ae){this.options=sn(Object.create(on),Ae),this.trees=new Array(this.options.maxZoom+1)};function jn(Ae,be,Ne,et,wt){return{x:Ae,y:be,zoom:1/0,id:Ne,parentId:-1,numPoints:et,properties:wt}}function lr(Ae,be){var Ne=Ae.geometry.coordinates,et=Ne[1];return{x:xn(Ne[0]),y:er(et),zoom:1/0,index:be,parentId:-1}}function Vt(Ae){return{type:"Feature",id:Ae.id,properties:en(Ae),geometry:{type:"Point",coordinates:[(et=Ae.x,360*(et-.5)),(be=Ae.y,Ne=(180-360*be)*Math.PI/180,360*Math.atan(Math.exp(Ne))/Math.PI-90)]}};var be,Ne,et}function en(Ae){var be=Ae.numPoints,Ne=be>=1e4?Math.round(be/1e3)+"k":be>=1e3?Math.round(be/100)/10+"k":be;return sn(sn({},Ae.properties),{cluster:!0,cluster_id:Ae.id,point_count:be,point_count_abbreviated:Ne})}function xn(Ae){return Ae/360+.5}function er(Ae){var be=Math.sin(Ae*Math.PI/180),Ne=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function sn(Ae,be){for(var Ne in be)Ae[Ne]=be[Ne];return Ae}function Ut(Ae){return Ae.x}function Dt(Ae){return Ae.y}function Me(Ae,be,Ne,et,wt,qt){var vn=wt-Ne,yt=qt-et;if(vn!==0||yt!==0){var Jt=((Ae-Ne)*vn+(be-et)*yt)/(vn*vn+yt*yt);Jt>1?(Ne=wt,et=qt):Jt>0&&(Ne+=vn*Jt,et+=yt*Jt)}return(vn=Ae-Ne)*vn+(yt=be-et)*yt}function Qe(Ae,be,Ne,et){var wt={id:Ae===void 0?null:Ae,type:be,geometry:Ne,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qt){var vn=qt.geometry,yt=qt.type;if(yt==="Point"||yt==="MultiPoint"||yt==="LineString")Ft(qt,vn);else if(yt==="Polygon"||yt==="MultiLineString")for(var Jt=0;Jt<vn.length;Jt++)Ft(qt,vn[Jt]);else if(yt==="MultiPolygon")for(Jt=0;Jt<vn.length;Jt++)for(var Qn=0;Qn<vn[Jt].length;Qn++)Ft(qt,vn[Jt][Qn])}(wt),wt}function Ft(Ae,be){for(var Ne=0;Ne<be.length;Ne+=3)Ae.minX=Math.min(Ae.minX,be[Ne]),Ae.minY=Math.min(Ae.minY,be[Ne+1]),Ae.maxX=Math.max(Ae.maxX,be[Ne]),Ae.maxY=Math.max(Ae.maxY,be[Ne+1])}function U(Ae,be,Ne,et){if(be.geometry){var wt=be.geometry.coordinates,qt=be.geometry.type,vn=Math.pow(Ne.tolerance/((1<<Ne.maxZoom)*Ne.extent),2),yt=[],Jt=be.id;if(Ne.promoteId?Jt=be.properties[Ne.promoteId]:Ne.generateId&&(Jt=et||0),qt==="Point")ue(wt,yt);else if(qt==="MultiPoint")for(var Qn=0;Qn<wt.length;Qn++)ue(wt[Qn],yt);else if(qt==="LineString")at(wt,yt,vn,!1);else if(qt==="MultiLineString"){if(Ne.lineMetrics){for(Qn=0;Qn<wt.length;Qn++)at(wt[Qn],yt=[],vn,!1),Ae.push(Qe(Jt,"LineString",yt,be.properties));return}ce(wt,yt,vn,!1)}else if(qt==="Polygon")ce(wt,yt,vn,!0);else{if(qt!=="MultiPolygon"){if(qt==="GeometryCollection"){for(Qn=0;Qn<be.geometry.geometries.length;Qn++)U(Ae,{id:Jt,geometry:be.geometry.geometries[Qn],properties:be.properties},Ne,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qn=0;Qn<wt.length;Qn++){var Er=[];ce(wt[Qn],Er,vn,!0),yt.push(Er)}}Ae.push(Qe(Jt,qt,yt,be.properties))}}function ue(Ae,be){be.push(j(Ae[0])),be.push(ln(Ae[1])),be.push(0)}function at(Ae,be,Ne,et){for(var wt,qt,vn=0,yt=0;yt<Ae.length;yt++){var Jt=j(Ae[yt][0]),Qn=ln(Ae[yt][1]);be.push(Jt),be.push(Qn),be.push(0),yt>0&&(vn+=et?(wt*Qn-Jt*qt)/2:Math.sqrt(Math.pow(Jt-wt,2)+Math.pow(Qn-qt,2))),wt=Jt,qt=Qn}var Er=be.length-3;be[2]=1,function Vr(mr,kr,Ei,Oi){for(var ar,Kr=Oi,hi=Ei-kr>>1,Qr=Ei-kr,Io=mr[kr],Ii=mr[kr+1],Fo=mr[Ei],_a=mr[Ei+1],Co=kr+3;Co<Ei;Co+=3){var Qo=Me(mr[Co],mr[Co+1],Io,Ii,Fo,_a);if(Qo>Kr)ar=Co,Kr=Qo;else if(Qo===Kr){var De=Math.abs(Co-hi);De<Qr&&(ar=Co,Qr=De)}}Kr>Oi&&(ar-kr>3&&Vr(mr,kr,ar,Oi),mr[ar+2]=Kr,Ei-ar>3&&Vr(mr,ar,Ei,Oi))}(be,0,Er,Ne),be[Er+2]=1,be.size=Math.abs(vn),be.start=0,be.end=be.size}function ce(Ae,be,Ne,et){for(var wt=0;wt<Ae.length;wt++){var qt=[];at(Ae[wt],qt,Ne,et),be.push(qt)}}function j(Ae){return Ae/360+.5}function ln(Ae){var be=Math.sin(Ae*Math.PI/180),Ne=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function fn(Ae,be,Ne,et,wt,qt,vn,yt){if(et/=be,qt>=(Ne/=be)&&vn<et)return Ae;if(vn<Ne||qt>=et)return null;for(var Jt=[],Qn=0;Qn<Ae.length;Qn++){var Er=Ae[Qn],Vr=Er.geometry,mr=Er.type,kr=wt===0?Er.minX:Er.minY,Ei=wt===0?Er.maxX:Er.maxY;if(kr>=Ne&&Ei<et)Jt.push(Er);else if(!(Ei<Ne||kr>=et)){var Oi=[];if(mr==="Point"||mr==="MultiPoint")mt(Vr,Oi,Ne,et,wt);else if(mr==="LineString")Gt(Vr,Oi,Ne,et,wt,!1,yt.lineMetrics);else if(mr==="MultiLineString")hn(Vr,Oi,Ne,et,wt,!1);else if(mr==="Polygon")hn(Vr,Oi,Ne,et,wt,!0);else if(mr==="MultiPolygon")for(var ar=0;ar<Vr.length;ar++){var Kr=[];hn(Vr[ar],Kr,Ne,et,wt,!0),Kr.length&&Oi.push(Kr)}if(Oi.length){if(yt.lineMetrics&&mr==="LineString"){for(ar=0;ar<Oi.length;ar++)Jt.push(Qe(Er.id,mr,Oi[ar],Er.tags));continue}mr!=="LineString"&&mr!=="MultiLineString"||(Oi.length===1?(mr="LineString",Oi=Oi[0]):mr="MultiLineString"),mr!=="Point"&&mr!=="MultiPoint"||(mr=Oi.length===3?"Point":"MultiPoint"),Jt.push(Qe(Er.id,mr,Oi,Er.tags))}}}return Jt.length?Jt:null}function mt(Ae,be,Ne,et,wt){for(var qt=0;qt<Ae.length;qt+=3){var vn=Ae[qt+wt];vn>=Ne&&vn<=et&&(be.push(Ae[qt]),be.push(Ae[qt+1]),be.push(Ae[qt+2]))}}function Gt(Ae,be,Ne,et,wt,qt,vn){for(var yt,Jt,Qn=Wn(Ae),Er=wt===0?Ht:Cn,Vr=Ae.start,mr=0;mr<Ae.length-3;mr+=3){var kr=Ae[mr],Ei=Ae[mr+1],Oi=Ae[mr+2],ar=Ae[mr+3],Kr=Ae[mr+4],hi=wt===0?kr:Ei,Qr=wt===0?ar:Kr,Io=!1;vn&&(yt=Math.sqrt(Math.pow(kr-ar,2)+Math.pow(Ei-Kr,2))),hi<Ne?Qr>Ne&&(Jt=Er(Qn,kr,Ei,ar,Kr,Ne),vn&&(Qn.start=Vr+yt*Jt)):hi>et?Qr<et&&(Jt=Er(Qn,kr,Ei,ar,Kr,et),vn&&(Qn.start=Vr+yt*Jt)):ht(Qn,kr,Ei,Oi),Qr<Ne&&hi>=Ne&&(Jt=Er(Qn,kr,Ei,ar,Kr,Ne),Io=!0),Qr>et&&hi<=et&&(Jt=Er(Qn,kr,Ei,ar,Kr,et),Io=!0),!qt&&Io&&(vn&&(Qn.end=Vr+yt*Jt),be.push(Qn),Qn=Wn(Ae)),vn&&(Vr+=yt)}var Ii=Ae.length-3;kr=Ae[Ii],Ei=Ae[Ii+1],Oi=Ae[Ii+2],(hi=wt===0?kr:Ei)>=Ne&&hi<=et&&ht(Qn,kr,Ei,Oi),Ii=Qn.length-3,qt&&Ii>=3&&(Qn[Ii]!==Qn[0]||Qn[Ii+1]!==Qn[1])&&ht(Qn,Qn[0],Qn[1],Qn[2]),Qn.length&&be.push(Qn)}function Wn(Ae){var be=[];return be.size=Ae.size,be.start=Ae.start,be.end=Ae.end,be}function hn(Ae,be,Ne,et,wt,qt){for(var vn=0;vn<Ae.length;vn++)Gt(Ae[vn],be,Ne,et,wt,qt,!1)}function ht(Ae,be,Ne,et){Ae.push(be),Ae.push(Ne),Ae.push(et)}function Ht(Ae,be,Ne,et,wt,qt){var vn=(qt-be)/(et-be);return Ae.push(qt),Ae.push(Ne+(wt-Ne)*vn),Ae.push(1),vn}function Cn(Ae,be,Ne,et,wt,qt){var vn=(qt-Ne)/(wt-Ne);return Ae.push(be+(et-be)*vn),Ae.push(qt),Ae.push(1),vn}function Ln(Ae,be){for(var Ne=[],et=0;et<Ae.length;et++){var wt,qt=Ae[et],vn=qt.type;if(vn==="Point"||vn==="MultiPoint"||vn==="LineString")wt=Gn(qt.geometry,be);else if(vn==="MultiLineString"||vn==="Polygon"){wt=[];for(var yt=0;yt<qt.geometry.length;yt++)wt.push(Gn(qt.geometry[yt],be))}else if(vn==="MultiPolygon")for(wt=[],yt=0;yt<qt.geometry.length;yt++){for(var Jt=[],Qn=0;Qn<qt.geometry[yt].length;Qn++)Jt.push(Gn(qt.geometry[yt][Qn],be));wt.push(Jt)}Ne.push(Qe(qt.id,vn,wt,qt.tags))}return Ne}function Gn(Ae,be){var Ne=[];Ne.size=Ae.size,Ae.start!==void 0&&(Ne.start=Ae.start,Ne.end=Ae.end);for(var et=0;et<Ae.length;et+=3)Ne.push(Ae[et]+be,Ae[et+1],Ae[et+2]);return Ne}function dt(Ae,be){if(Ae.transformed)return Ae;var Ne,et,wt,qt=1<<Ae.z,vn=Ae.x,yt=Ae.y;for(Ne=0;Ne<Ae.features.length;Ne++){var Jt=Ae.features[Ne],Qn=Jt.geometry,Er=Jt.type;if(Jt.geometry=[],Er===1)for(et=0;et<Qn.length;et+=2)Jt.geometry.push(ye(Qn[et],Qn[et+1],be,qt,vn,yt));else for(et=0;et<Qn.length;et++){var Vr=[];for(wt=0;wt<Qn[et].length;wt+=2)Vr.push(ye(Qn[et][wt],Qn[et][wt+1],be,qt,vn,yt));Jt.geometry.push(Vr)}}return Ae.transformed=!0,Ae}function ye(Ae,be,Ne,et,wt,qt){return[Math.round(Ne*(Ae*et-wt)),Math.round(Ne*(be*et-qt))]}function Fe(Ae,be,Ne,et,wt){for(var qt=be===wt.maxZoom?0:wt.tolerance/((1<<be)*wt.extent),vn={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ne,y:et,z:be,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},yt=0;yt<Ae.length;yt++){vn.numFeatures++,nt(vn,Ae[yt],qt,wt);var Jt=Ae[yt].minX,Qn=Ae[yt].minY,Er=Ae[yt].maxX,Vr=Ae[yt].maxY;Jt<vn.minX&&(vn.minX=Jt),Qn<vn.minY&&(vn.minY=Qn),Er>vn.maxX&&(vn.maxX=Er),Vr>vn.maxY&&(vn.maxY=Vr)}return vn}function nt(Ae,be,Ne,et){var wt=be.geometry,qt=be.type,vn=[];if(qt==="Point"||qt==="MultiPoint")for(var yt=0;yt<wt.length;yt+=3)vn.push(wt[yt]),vn.push(wt[yt+1]),Ae.numPoints++,Ae.numSimplified++;else if(qt==="LineString")Pt(vn,wt,Ae,Ne,!1,!1);else if(qt==="MultiLineString"||qt==="Polygon")for(yt=0;yt<wt.length;yt++)Pt(vn,wt[yt],Ae,Ne,qt==="Polygon",yt===0);else if(qt==="MultiPolygon")for(var Jt=0;Jt<wt.length;Jt++){var Qn=wt[Jt];for(yt=0;yt<Qn.length;yt++)Pt(vn,Qn[yt],Ae,Ne,!0,yt===0)}if(vn.length){var Er=be.tags||null;if(qt==="LineString"&&et.lineMetrics){for(var Vr in Er={},be.tags)Er[Vr]=be.tags[Vr];Er.mapbox_clip_start=wt.start/wt.size,Er.mapbox_clip_end=wt.end/wt.size}var mr={geometry:vn,type:qt==="Polygon"||qt==="MultiPolygon"?3:qt==="LineString"||qt==="MultiLineString"?2:1,tags:Er};be.id!==null&&(mr.id=be.id),Ae.features.push(mr)}}function Pt(Ae,be,Ne,et,wt,qt){var vn=et*et;if(et>0&&be.size<(wt?vn:et))Ne.numPoints+=be.length/3;else{for(var yt=[],Jt=0;Jt<be.length;Jt+=3)(et===0||be[Jt+2]>vn)&&(Ne.numSimplified++,yt.push(be[Jt]),yt.push(be[Jt+1])),Ne.numPoints++;wt&&function(Qn,Er){for(var Vr=0,mr=0,kr=Qn.length,Ei=kr-2;mr<kr;Ei=mr,mr+=2)Vr+=(Qn[mr]-Qn[Ei])*(Qn[mr+1]+Qn[Ei+1]);if(Vr>0===Er)for(mr=0,kr=Qn.length;mr<kr/2;mr+=2){var Oi=Qn[mr],ar=Qn[mr+1];Qn[mr]=Qn[kr-2-mr],Qn[mr+1]=Qn[kr-1-mr],Qn[kr-2-mr]=Oi,Qn[kr-1-mr]=ar}}(yt,qt),Ae.push(yt)}}function Mt(Ae,be){var Ne=(be=this.options=function(wt,qt){for(var vn in qt)wt[vn]=qt[vn];return wt}(Object.create(this.options),be)).debug;if(Ne&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");var et=function(wt,qt){var vn=[];if(wt.type==="FeatureCollection")for(var yt=0;yt<wt.features.length;yt++)U(vn,wt.features[yt],qt,yt);else U(vn,wt.type==="Feature"?wt:{geometry:wt},qt);return vn}(Ae,be);this.tiles={},this.tileCoords=[],Ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(et=function(wt,qt){var vn=qt.buffer/qt.extent,yt=wt,Jt=fn(wt,1,-1-vn,vn,0,-1,2,qt),Qn=fn(wt,1,1-vn,2+vn,0,-1,2,qt);return(Jt||Qn)&&(yt=fn(wt,1,-vn,1+vn,0,-1,2,qt)||[],Jt&&(yt=Ln(Jt,1).concat(yt)),Qn&&(yt=yt.concat(Ln(Qn,-1)))),yt}(et,be)).length&&this.splitTile(et,0,0,0),Ne&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Tn(Ae,be,Ne){return 32*((1<<Ae)*Ne+be)+Ae}function $n(Ae,be){var Ne=Ae.tileID.canonical;if(!this._geoJSONIndex)return be(null,null);var et=this._geoJSONIndex.getTile(Ne.z,Ne.x,Ne.y);if(!et)return be(null,null);var wt=new xt(et.features),qt=ke(wt);qt.byteOffset===0&&qt.byteLength===qt.buffer.byteLength||(qt=new Uint8Array(qt)),be(null,{vectorTile:wt,rawData:qt.buffer})}Nn.prototype.load=function(Ae){var be=this.options,Ne=be.log,et=be.minZoom,wt=be.maxZoom,qt=be.nodeSize;Ne&&console.time("total time");var vn="prepare "+Ae.length+" points";Ne&&console.time(vn),this.points=Ae;for(var yt=[],Jt=0;Jt<Ae.length;Jt++)Ae[Jt].geometry&&yt.push(lr(Ae[Jt],Jt));this.trees[wt+1]=new Wt(yt,Ut,Dt,qt,Float32Array),Ne&&console.timeEnd(vn);for(var Qn=wt;Qn>=et;Qn--){var Er=+Date.now();yt=this._cluster(yt,Qn),this.trees[Qn]=new Wt(yt,Ut,Dt,qt,Float32Array),Ne&&console.log("z%d: %d clusters in %dms",Qn,yt.length,+Date.now()-Er)}return Ne&&console.timeEnd("total time"),this},Nn.prototype.getClusters=function(Ae,be){var Ne=((Ae[0]+180)%360+360)%360-180,et=Math.max(-90,Math.min(90,Ae[1])),wt=Ae[2]===180?180:((Ae[2]+180)%360+360)%360-180,qt=Math.max(-90,Math.min(90,Ae[3]));if(Ae[2]-Ae[0]>=360)Ne=-180,wt=180;else if(Ne>wt){var vn=this.getClusters([Ne,et,180,qt],be),yt=this.getClusters([-180,et,wt,qt],be);return vn.concat(yt)}for(var Jt=this.trees[this._limitZoom(be)],Qn=[],Er=0,Vr=Jt.range(xn(Ne),er(qt),xn(wt),er(et));Er<Vr.length;Er+=1){var mr=Jt.points[Vr[Er]];Qn.push(mr.numPoints?Vt(mr):this.points[mr.index])}return Qn},Nn.prototype.getChildren=function(Ae){var be=this._getOriginId(Ae),Ne=this._getOriginZoom(Ae),et="No cluster with the specified id.",wt=this.trees[Ne];if(!wt)throw new Error(et);var qt=wt.points[be];if(!qt)throw new Error(et);for(var vn=this.options.radius/(this.options.extent*Math.pow(2,Ne-1)),yt=[],Jt=0,Qn=wt.within(qt.x,qt.y,vn);Jt<Qn.length;Jt+=1){var Er=wt.points[Qn[Jt]];Er.parentId===Ae&&yt.push(Er.numPoints?Vt(Er):this.points[Er.index])}if(yt.length===0)throw new Error(et);return yt},Nn.prototype.getLeaves=function(Ae,be,Ne){var et=[];return this._appendLeaves(et,Ae,be=be||10,Ne=Ne||0,0),et},Nn.prototype.getTile=function(Ae,be,Ne){var et=this.trees[this._limitZoom(Ae)],wt=Math.pow(2,Ae),qt=this.options,vn=qt.radius/qt.extent,yt=(Ne-vn)/wt,Jt=(Ne+1+vn)/wt,Qn={features:[]};return this._addTileFeatures(et.range((be-vn)/wt,yt,(be+1+vn)/wt,Jt),et.points,be,Ne,wt,Qn),be===0&&this._addTileFeatures(et.range(1-vn/wt,yt,1,Jt),et.points,wt,Ne,wt,Qn),be===wt-1&&this._addTileFeatures(et.range(0,yt,vn/wt,Jt),et.points,-1,Ne,wt,Qn),Qn.features.length?Qn:null},Nn.prototype.getClusterExpansionZoom=function(Ae){for(var be=this._getOriginZoom(Ae)-1;be<=this.options.maxZoom;){var Ne=this.getChildren(Ae);if(be++,Ne.length!==1)break;Ae=Ne[0].properties.cluster_id}return be},Nn.prototype._appendLeaves=function(Ae,be,Ne,et,wt){for(var qt=0,vn=this.getChildren(be);qt<vn.length;qt+=1){var yt=vn[qt],Jt=yt.properties;if(Jt&&Jt.cluster?wt+Jt.point_count<=et?wt+=Jt.point_count:wt=this._appendLeaves(Ae,Jt.cluster_id,Ne,et,wt):wt<et?wt++:Ae.push(yt),Ae.length===Ne)break}return wt},Nn.prototype._addTileFeatures=function(Ae,be,Ne,et,wt,qt){for(var vn=0,yt=Ae;vn<yt.length;vn+=1){var Jt=be[yt[vn]],Qn=Jt.numPoints,Er={type:1,geometry:[[Math.round(this.options.extent*(Jt.x*wt-Ne)),Math.round(this.options.extent*(Jt.y*wt-et))]],tags:Qn?en(Jt):this.points[Jt.index].properties},Vr=void 0;Qn?Vr=Jt.id:this.options.generateId?Vr=Jt.index:this.points[Jt.index].id&&(Vr=this.points[Jt.index].id),Vr!==void 0&&(Er.id=Vr),qt.features.push(Er)}},Nn.prototype._limitZoom=function(Ae){return Math.max(this.options.minZoom,Math.min(+Ae,this.options.maxZoom+1))},Nn.prototype._cluster=function(Ae,be){for(var Ne=[],et=this.options,wt=et.reduce,qt=et.minPoints,vn=et.radius/(et.extent*Math.pow(2,be)),yt=0;yt<Ae.length;yt++){var Jt=Ae[yt];if(!(Jt.zoom<=be)){Jt.zoom=be;for(var Qn=this.trees[be+1],Er=Qn.within(Jt.x,Jt.y,vn),Vr=Jt.numPoints||1,mr=Vr,kr=0,Ei=Er;kr<Ei.length;kr+=1){var Oi=Qn.points[Ei[kr]];Oi.zoom>be&&(mr+=Oi.numPoints||1)}if(mr>=qt){for(var ar=Jt.x*Vr,Kr=Jt.y*Vr,hi=wt&&Vr>1?this._map(Jt,!0):null,Qr=(yt<<5)+(be+1)+this.points.length,Io=0,Ii=Er;Io<Ii.length;Io+=1){var Fo=Qn.points[Ii[Io]];if(!(Fo.zoom<=be)){Fo.zoom=be;var _a=Fo.numPoints||1;ar+=Fo.x*_a,Kr+=Fo.y*_a,Fo.parentId=Qr,wt&&(hi||(hi=this._map(Jt,!0)),wt(hi,this._map(Fo)))}}Jt.parentId=Qr,Ne.push(jn(ar/mr,Kr/mr,Qr,mr,hi))}else if(Ne.push(Jt),mr>1)for(var Co=0,Qo=Er;Co<Qo.length;Co+=1){var De=Qn.points[Qo[Co]];De.zoom<=be||(De.zoom=be,Ne.push(De))}}}return Ne},Nn.prototype._getOriginId=function(Ae){return Ae-this.points.length>>5},Nn.prototype._getOriginZoom=function(Ae){return(Ae-this.points.length)%32},Nn.prototype._map=function(Ae,be){if(Ae.numPoints)return be?sn({},Ae.properties):Ae.properties;var Ne=this.points[Ae.index].properties,et=this.options.map(Ne);return be&&et===Ne?sn({},et):et},Mt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Mt.prototype.splitTile=function(Ae,be,Ne,et,wt,qt,vn){for(var yt=[Ae,be,Ne,et],Jt=this.options,Qn=Jt.debug;yt.length;){et=yt.pop(),Ne=yt.pop(),be=yt.pop(),Ae=yt.pop();var Er=1<<be,Vr=Tn(be,Ne,et),mr=this.tiles[Vr];if(!mr&&(Qn>1&&console.time("creation"),mr=this.tiles[Vr]=Fe(Ae,be,Ne,et,Jt),this.tileCoords.push({z:be,x:Ne,y:et}),Qn)){Qn>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,Ne,et,mr.numFeatures,mr.numPoints,mr.numSimplified),console.timeEnd("creation"));var kr="z"+be;this.stats[kr]=(this.stats[kr]||0)+1,this.total++}if(mr.source=Ae,wt){if(be===Jt.maxZoom||be===wt)continue;var Ei=1<<wt-be;if(Ne!==Math.floor(qt/Ei)||et!==Math.floor(vn/Ei))continue}else if(be===Jt.indexMaxZoom||mr.numPoints<=Jt.indexMaxPoints)continue;if(mr.source=null,Ae.length!==0){Qn>1&&console.time("clipping");var Oi,ar,Kr,hi,Qr,Io,Ii=.5*Jt.buffer/Jt.extent,Fo=.5-Ii,_a=.5+Ii,Co=1+Ii;Oi=ar=Kr=hi=null,Qr=fn(Ae,Er,Ne-Ii,Ne+_a,0,mr.minX,mr.maxX,Jt),Io=fn(Ae,Er,Ne+Fo,Ne+Co,0,mr.minX,mr.maxX,Jt),Ae=null,Qr&&(Oi=fn(Qr,Er,et-Ii,et+_a,1,mr.minY,mr.maxY,Jt),ar=fn(Qr,Er,et+Fo,et+Co,1,mr.minY,mr.maxY,Jt),Qr=null),Io&&(Kr=fn(Io,Er,et-Ii,et+_a,1,mr.minY,mr.maxY,Jt),hi=fn(Io,Er,et+Fo,et+Co,1,mr.minY,mr.maxY,Jt),Io=null),Qn>1&&console.timeEnd("clipping"),yt.push(Oi||[],be+1,2*Ne,2*et),yt.push(ar||[],be+1,2*Ne,2*et+1),yt.push(Kr||[],be+1,2*Ne+1,2*et),yt.push(hi||[],be+1,2*Ne+1,2*et+1)}}},Mt.prototype.getTile=function(Ae,be,Ne){var et=this.options,wt=et.extent,qt=et.debug;if(Ae<0||Ae>24)return null;var vn=1<<Ae,yt=Tn(Ae,be=(be%vn+vn)%vn,Ne);if(this.tiles[yt])return dt(this.tiles[yt],wt);qt>1&&console.log("drilling down to z%d-%d-%d",Ae,be,Ne);for(var Jt,Qn=Ae,Er=be,Vr=Ne;!Jt&&Qn>0;)Qn--,Er=Math.floor(Er/2),Vr=Math.floor(Vr/2),Jt=this.tiles[Tn(Qn,Er,Vr)];return Jt&&Jt.source?(qt>1&&console.log("found parent tile z%d-%d-%d",Qn,Er,Vr),qt>1&&console.time("drilling down"),this.splitTile(Jt.source,Qn,Er,Vr,Ae,be,Ne),qt>1&&console.timeEnd("drilling down"),this.tiles[yt]?dt(this.tiles[yt],wt):null):null};var xr=function(Ae){function be(Ne,et,wt,qt){Ae.call(this,Ne,et,wt,$n),qt&&(this.loadGeoJSON=qt)}return Ae&&(be.__proto__=Ae),(be.prototype=Object.create(Ae&&Ae.prototype)).constructor=be,be.prototype.loadData=function(Ne,et){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=et,this._pendingLoadDataParams=Ne,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},be.prototype._loadData=function(){var Ne=this;if(this._pendingCallback&&this._pendingLoadDataParams){var et=this._pendingCallback,wt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var qt=!!(wt&&wt.request&&wt.request.collectResourceTiming)&&new E.RequestPerformance(wt.request);this.loadGeoJSON(wt,function(vn,yt){if(vn||!yt)return et(vn);if(typeof yt!="object")return et(new Error("Input data given to '"+wt.source+"' is not a valid GeoJSON object."));(function mr(kr,Ei){var Oi,ar=kr&&kr.type;if(ar==="FeatureCollection")for(Oi=0;Oi<kr.features.length;Oi++)mr(kr.features[Oi],Ei);else if(ar==="GeometryCollection")for(Oi=0;Oi<kr.geometries.length;Oi++)mr(kr.geometries[Oi],Ei);else if(ar==="Feature")mr(kr.geometry,Ei);else if(ar==="Polygon")Te(kr.coordinates,Ei);else if(ar==="MultiPolygon")for(Oi=0;Oi<kr.coordinates.length;Oi++)Te(kr.coordinates[Oi],Ei);return kr})(yt,!0);try{if(wt.filter){var Jt=E.createExpression(wt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Jt.result==="error")throw new Error(Jt.value.map(function(mr){return mr.key+": "+mr.message}).join(", "));var Qn=yt.features.filter(function(mr){return Jt.value.evaluate({zoom:0},mr)});yt={type:"FeatureCollection",features:Qn}}Ne._geoJSONIndex=wt.cluster?new Nn(function(mr){var kr=mr.superclusterOptions,Ei=mr.clusterProperties;if(!Ei||!kr)return kr;for(var Oi={},ar={},Kr={accumulated:null,zoom:0},hi={properties:null},Qr=Object.keys(Ei),Io=0,Ii=Qr;Io<Ii.length;Io+=1){var Fo=Ii[Io],_a=Ei[Fo],Co=_a[0],Qo=E.createExpression(_a[1]),De=E.createExpression(typeof Co=="string"?[Co,["accumulated"],["get",Fo]]:Co);Oi[Fo]=Qo.value,ar[Fo]=De.value}return kr.map=function(Je){hi.properties=Je;for(var kt={},un=0,Bn=Qr;un<Bn.length;un+=1){var kn=Bn[un];kt[kn]=Oi[kn].evaluate(Kr,hi)}return kt},kr.reduce=function(Je,kt){hi.properties=kt;for(var un=0,Bn=Qr;un<Bn.length;un+=1){var kn=Bn[un];Kr.accumulated=Je[kn],Je[kn]=ar[kn].evaluate(Kr,hi)}},kr}(wt)).load(yt.features):function(mr,kr){return new Mt(mr,kr)}(yt,wt.geojsonVtOptions)}catch(mr){return et(mr)}Ne.loaded={};var Er={};if(qt){var Vr=qt.finish();Vr&&(Er.resourceTiming={},Er.resourceTiming[wt.source]=JSON.parse(JSON.stringify(Vr)))}et(null,Er)})}},be.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},be.prototype.reloadTile=function(Ne,et){var wt=this.loaded;return wt&&wt[Ne.uid]?Ae.prototype.reloadTile.call(this,Ne,et):this.loadTile(Ne,et)},be.prototype.loadGeoJSON=function(Ne,et){if(Ne.request)E.getJSON(Ne.request,et);else{if(typeof Ne.data!="string")return et(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."));try{return et(null,JSON.parse(Ne.data))}catch(wt){return et(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."))}}},be.prototype.removeSource=function(Ne,et){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),et()},be.prototype.getClusterExpansionZoom=function(Ne,et){try{et(null,this._geoJSONIndex.getClusterExpansionZoom(Ne.clusterId))}catch(wt){et(wt)}},be.prototype.getClusterChildren=function(Ne,et){try{et(null,this._geoJSONIndex.getChildren(Ne.clusterId))}catch(wt){et(wt)}},be.prototype.getClusterLeaves=function(Ne,et){try{et(null,this._geoJSONIndex.getLeaves(Ne.clusterId,Ne.limit,Ne.offset))}catch(wt){et(wt)}},be}(te),qn=function(Ae){var be=this;this.self=Ae,this.actor=new E.Actor(Ae,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:te,geojson:xr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Ne,et){if(be.workerSourceTypes[Ne])throw new Error('Worker source with name "'+Ne+'" already registered.');be.workerSourceTypes[Ne]=et},this.self.registerRTLTextPlugin=function(Ne){if(E.plugin.isParsed())throw new Error("RTL text plugin already registered.");E.plugin.applyArabicShaping=Ne.applyArabicShaping,E.plugin.processBidirectionalText=Ne.processBidirectionalText,E.plugin.processStyledBidirectionalText=Ne.processStyledBidirectionalText}};return qn.prototype.setReferrer=function(Ae,be){this.referrer=be},qn.prototype.setImages=function(Ae,be,Ne){for(var et in this.availableImages[Ae]=be,this.workerSources[Ae]){var wt=this.workerSources[Ae][et];for(var qt in wt)wt[qt].availableImages=be}Ne()},qn.prototype.setLayers=function(Ae,be,Ne){this.getLayerIndex(Ae).replace(be),Ne()},qn.prototype.updateLayers=function(Ae,be,Ne){this.getLayerIndex(Ae).update(be.layers,be.removedIds),Ne()},qn.prototype.loadTile=function(Ae,be,Ne){this.getWorkerSource(Ae,be.type,be.source).loadTile(be,Ne)},qn.prototype.loadDEMTile=function(Ae,be,Ne){this.getDEMWorkerSource(Ae,be.source).loadTile(be,Ne)},qn.prototype.reloadTile=function(Ae,be,Ne){this.getWorkerSource(Ae,be.type,be.source).reloadTile(be,Ne)},qn.prototype.abortTile=function(Ae,be,Ne){this.getWorkerSource(Ae,be.type,be.source).abortTile(be,Ne)},qn.prototype.removeTile=function(Ae,be,Ne){this.getWorkerSource(Ae,be.type,be.source).removeTile(be,Ne)},qn.prototype.removeDEMTile=function(Ae,be){this.getDEMWorkerSource(Ae,be.source).removeTile(be)},qn.prototype.removeSource=function(Ae,be,Ne){if(this.workerSources[Ae]&&this.workerSources[Ae][be.type]&&this.workerSources[Ae][be.type][be.source]){var et=this.workerSources[Ae][be.type][be.source];delete this.workerSources[Ae][be.type][be.source],et.removeSource!==void 0?et.removeSource(be,Ne):Ne()}},qn.prototype.loadWorkerSource=function(Ae,be,Ne){try{this.self.importScripts(be.url),Ne()}catch(et){Ne(et.toString())}},qn.prototype.syncRTLPluginState=function(Ae,be,Ne){try{E.plugin.setState(be);var et=E.plugin.getPluginURL();if(E.plugin.isLoaded()&&!E.plugin.isParsed()&&et!=null){this.self.importScripts(et);var wt=E.plugin.isParsed();Ne(wt?void 0:new Error("RTL Text Plugin failed to import scripts from "+et),wt)}}catch(qt){Ne(qt.toString())}},qn.prototype.getAvailableImages=function(Ae){var be=this.availableImages[Ae];return be||(be=[]),be},qn.prototype.getLayerIndex=function(Ae){var be=this.layerIndexes[Ae];return be||(be=this.layerIndexes[Ae]=new he),be},qn.prototype.getWorkerSource=function(Ae,be,Ne){var et=this;return this.workerSources[Ae]||(this.workerSources[Ae]={}),this.workerSources[Ae][be]||(this.workerSources[Ae][be]={}),this.workerSources[Ae][be][Ne]||(this.workerSources[Ae][be][Ne]=new this.workerSourceTypes[be]({send:function(wt,qt,vn){et.actor.send(wt,qt,vn,Ae)}},this.getLayerIndex(Ae),this.getAvailableImages(Ae))),this.workerSources[Ae][be][Ne]},qn.prototype.getDEMWorkerSource=function(Ae,be){return this.demWorkerSources[Ae]||(this.demWorkerSources[Ae]={}),this.demWorkerSources[Ae][be]||(this.demWorkerSources[Ae][be]=new Be),this.demWorkerSources[Ae][be]},qn.prototype.enforceCacheSizeLimit=function(Ae,be){E.enforceCacheSizeLimit(be)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new qn(self)),qn}),X(["./shared"],function(E){"use strict";var _e=E.createCommonjsModule(function(_){function S(k){return!x(k)}function x(k){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var q,de,ze=new Blob([""],{type:"text/javascript"}),it=URL.createObjectURL(ze);try{de=new Worker(it),q=!0}catch(Bt){q=!1}return de&&de.terminate(),URL.revokeObjectURL(it),q}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var q=document.createElement("canvas");q.width=q.height=1;var de=q.getContext("2d");if(!de)return!1;var ze=de.getImageData(0,0,1,1);return ze&&ze.width===q.width}()?(C[G=k&&k.failIfMajorPerformanceCaveat]===void 0&&(C[G]=function(q){var de=function(it){var Bt=document.createElement("canvas"),St=Object.create(S.webGLContextAttributes);return St.failIfMajorPerformanceCaveat=it,Bt.probablySupportsContext?Bt.probablySupportsContext("webgl",St)||Bt.probablySupportsContext("experimental-webgl",St):Bt.supportsContext?Bt.supportsContext("webgl",St)||Bt.supportsContext("experimental-webgl",St):Bt.getContext("webgl",St)||Bt.getContext("experimental-webgl",St)}(q);if(!de)return!1;var ze=de.createShader(de.VERTEX_SHADER);return!(!ze||de.isContextLost())&&(de.shaderSource(ze,"void main() {}"),de.compileShader(ze),de.getShaderParameter(ze,de.COMPILE_STATUS)===!0)}(G)),C[G]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var G}_.exports?_.exports=S:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=S,window.mapboxgl.notSupportedReason=x);var C={};S.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),re={create:function(_,S,x){var C=E.window.document.createElement(_);return S!==void 0&&(C.className=S),x&&x.appendChild(C),C},createNS:function(_,S){return E.window.document.createElementNS(_,S)}},he=E.window.document&&E.window.document.documentElement.style;function se(_){if(!he)return _[0];for(var S=0;S<_.length;S++)if(_[S]in he)return _[S];return _[0]}var Se,oe=se(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);re.disableDrag=function(){he&&oe&&(Se=he[oe],he[oe]="none")},re.enableDrag=function(){he&&oe&&(he[oe]=Se)};var je=se(["transform","WebkitTransform"]);re.setTransform=function(_,S){_.style[je]=S};var te=!1;try{var ve=Object.defineProperty({},"passive",{get:function(){te=!0}});E.window.addEventListener("test",ve,ve),E.window.removeEventListener("test",ve,ve)}catch(_){te=!1}re.addEventListener=function(_,S,x,C){C===void 0&&(C={}),_.addEventListener(S,x,"passive"in C&&te?C:C.capture)},re.removeEventListener=function(_,S,x,C){C===void 0&&(C={}),_.removeEventListener(S,x,"passive"in C&&te?C:C.capture)};var Be=function(_){_.preventDefault(),_.stopPropagation(),E.window.removeEventListener("click",Be,!0)};function Te(_){var S=_.userImage;return!!(S&&S.render&&S.render())&&(_.data.replace(new Uint8Array(S.data.buffer)),!0)}re.suppressClick=function(){E.window.addEventListener("click",Be,!0),E.window.setTimeout(function(){E.window.removeEventListener("click",Be,!0)},0)},re.mousePos=function(_,S){var x=_.getBoundingClientRect();return new E.Point(S.clientX-x.left-_.clientLeft,S.clientY-x.top-_.clientTop)},re.touchPos=function(_,S){for(var x=_.getBoundingClientRect(),C=[],k=0;k<S.length;k++)C.push(new E.Point(S[k].clientX-x.left-_.clientLeft,S[k].clientY-x.top-_.clientTop));return C},re.mouseButton=function(_){return E.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&E.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button},re.remove=function(_){_.parentNode&&_.parentNode.removeChild(_)};var we=function(_){function S(){_.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new E.RGBAImage({width:1,height:1}),this.dirty=!0}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.isLoaded=function(){return this.loaded},S.prototype.setLoaded=function(x){if(this.loaded!==x&&(this.loaded=x,x)){for(var C=0,k=this.requestors;C<k.length;C+=1){var G=k[C];this._notify(G.ids,G.callback)}this.requestors=[]}},S.prototype.getImage=function(x){return this.images[x]},S.prototype.addImage=function(x,C){this._validate(x,C)&&(this.images[x]=C)},S.prototype._validate=function(x,C){var k=!0;return this._validateStretch(C.stretchX,C.data&&C.data.width)||(this.fire(new E.ErrorEvent(new Error('Image "'+x+'" has invalid "stretchX" value'))),k=!1),this._validateStretch(C.stretchY,C.data&&C.data.height)||(this.fire(new E.ErrorEvent(new Error('Image "'+x+'" has invalid "stretchY" value'))),k=!1),this._validateContent(C.content,C)||(this.fire(new E.ErrorEvent(new Error('Image "'+x+'" has invalid "content" value'))),k=!1),k},S.prototype._validateStretch=function(x,C){if(!x)return!0;for(var k=0,G=0,q=x;G<q.length;G+=1){var de=q[G];if(de[0]<k||de[1]<de[0]||C<de[1])return!1;k=de[1]}return!0},S.prototype._validateContent=function(x,C){return!(x&&(x.length!==4||x[0]<0||C.data.width<x[0]||x[1]<0||C.data.height<x[1]||x[2]<0||C.data.width<x[2]||x[3]<0||C.data.height<x[3]||x[2]<x[0]||x[3]<x[1]))},S.prototype.updateImage=function(x,C){C.version=this.images[x].version+1,this.images[x]=C,this.updatedImages[x]=!0},S.prototype.removeImage=function(x){var C=this.images[x];delete this.images[x],delete this.patterns[x],C.userImage&&C.userImage.onRemove&&C.userImage.onRemove()},S.prototype.listImages=function(){return Object.keys(this.images)},S.prototype.getImages=function(x,C){var k=!0;if(!this.isLoaded())for(var G=0,q=x;G<q.length;G+=1)this.images[q[G]]||(k=!1);this.isLoaded()||k?this._notify(x,C):this.requestors.push({ids:x,callback:C})},S.prototype._notify=function(x,C){for(var k={},G=0,q=x;G<q.length;G+=1){var de=q[G];this.images[de]||this.fire(new E.Event("styleimagemissing",{id:de}));var ze=this.images[de];ze?k[de]={data:ze.data.clone(),pixelRatio:ze.pixelRatio,sdf:ze.sdf,version:ze.version,stretchX:ze.stretchX,stretchY:ze.stretchY,content:ze.content,hasRenderCallback:!!(ze.userImage&&ze.userImage.render)}:E.warnOnce('Image "'+de+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}C(null,k)},S.prototype.getPixelSize=function(){var x=this.atlasImage;return{width:x.width,height:x.height}},S.prototype.getPattern=function(x){var C=this.patterns[x],k=this.getImage(x);if(!k)return null;if(C&&C.position.version===k.version)return C.position;if(C)C.position.version=k.version;else{var G={w:k.data.width+2,h:k.data.height+2,x:0,y:0},q=new E.ImagePosition(G,k);this.patterns[x]={bin:G,position:q}}return this._updatePatternAtlas(),this.patterns[x].position},S.prototype.bind=function(x){var C=x.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new E.Texture(x,this.atlasImage,C.RGBA),this.atlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE)},S.prototype._updatePatternAtlas=function(){var x=[];for(var C in this.patterns)x.push(this.patterns[C].bin);var k=E.potpack(x),G=k.w,q=k.h,de=this.atlasImage;for(var ze in de.resize({width:G||1,height:q||1}),this.patterns){var it=this.patterns[ze].bin,Bt=it.x+1,St=it.y+1,Xt=this.images[ze].data,En=Xt.width,yn=Xt.height;E.RGBAImage.copy(Xt,de,{x:0,y:0},{x:Bt,y:St},{width:En,height:yn}),E.RGBAImage.copy(Xt,de,{x:0,y:yn-1},{x:Bt,y:St-1},{width:En,height:1}),E.RGBAImage.copy(Xt,de,{x:0,y:0},{x:Bt,y:St+yn},{width:En,height:1}),E.RGBAImage.copy(Xt,de,{x:En-1,y:0},{x:Bt-1,y:St},{width:1,height:yn}),E.RGBAImage.copy(Xt,de,{x:0,y:0},{x:Bt+En,y:St},{width:1,height:yn})}this.dirty=!0},S.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},S.prototype.dispatchRenderCallbacks=function(x){for(var C=0,k=x;C<k.length;C+=1){var G=k[C];if(!this.callbackDispatchedThisFrame[G]){this.callbackDispatchedThisFrame[G]=!0;var q=this.images[G];Te(q)&&this.updateImage(G,q)}}},S}(E.Evented),le=ft,Ze=ft,xt=1e20;function ft(_,S,x,C,k,G){this.fontSize=_||24,this.buffer=S===void 0?3:S,this.cutoff=C||.25,this.fontFamily=k||"sans-serif",this.fontWeight=G||"normal",this.radius=x||8;var q=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(q*q),this.gridInner=new Float64Array(q*q),this.f=new Float64Array(q),this.d=new Float64Array(q),this.z=new Float64Array(q+1),this.v=new Int16Array(q),this.middle=Math.round(q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Zt(_,S,x,C,k,G,q){for(var de=0;de<S;de++){for(var ze=0;ze<x;ze++)C[ze]=_[ze*S+de];for(pt(C,k,G,q,x),ze=0;ze<x;ze++)_[ze*S+de]=k[ze]}for(ze=0;ze<x;ze++){for(de=0;de<S;de++)C[de]=_[ze*S+de];for(pt(C,k,G,q,S),de=0;de<S;de++)_[ze*S+de]=Math.sqrt(k[de])}}function pt(_,S,x,C,k){x[0]=0,C[0]=-xt,C[1]=+xt;for(var G=1,q=0;G<k;G++){for(var de=(_[G]+G*G-(_[x[q]]+x[q]*x[q]))/(2*G-2*x[q]);de<=C[q];)q--,de=(_[G]+G*G-(_[x[q]]+x[q]*x[q]))/(2*G-2*x[q]);x[++q]=G,C[q]=de,C[q+1]=+xt}for(G=0,q=0;G<k;G++){for(;C[q+1]<G;)q++;S[G]=(G-x[q])*(G-x[q])+_[x[q]]}}ft.prototype.draw=function(_){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(_,this.buffer,this.middle);for(var S=this.ctx.getImageData(0,0,this.size,this.size),x=new Uint8ClampedArray(this.size*this.size),C=0;C<this.size*this.size;C++){var k=S.data[4*C+3]/255;this.gridOuter[C]=k===1?0:k===0?xt:Math.pow(Math.max(0,.5-k),2),this.gridInner[C]=k===1?xt:k===0?0:Math.pow(Math.max(0,k-.5),2)}for(Zt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Zt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),C=0;C<this.size*this.size;C++)x[C]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[C]-this.gridInner[C])/this.radius+this.cutoff))));return x},le.default=Ze;var vt=function(_,S){this.requestManager=_,this.localIdeographFontFamily=S,this.entries={}};vt.prototype.setURL=function(_){this.url=_},vt.prototype.getGlyphs=function(_,S){var x=this,C=[];for(var k in _)for(var G=0,q=_[k];G<q.length;G+=1)C.push({stack:k,id:q[G]});E.asyncAll(C,function(de,ze){var it=de.stack,Bt=de.id,St=x.entries[it];St||(St=x.entries[it]={glyphs:{},requests:{},ranges:{}});var Xt=St.glyphs[Bt];if(Xt===void 0){if(Xt=x._tinySDF(St,it,Bt))return St.glyphs[Bt]=Xt,void ze(null,{stack:it,id:Bt,glyph:Xt});var En=Math.floor(Bt/256);if(256*En>65535)ze(new Error("glyphs > 65535 not supported"));else if(St.ranges[En])ze(null,{stack:it,id:Bt,glyph:Xt});else{var yn=St.requests[En];yn||(yn=St.requests[En]=[],vt.loadGlyphRange(it,En,x.url,x.requestManager,function(Un,cn){if(cn){for(var Rn in cn)x._doesCharSupportLocalGlyph(+Rn)||(St.glyphs[+Rn]=cn[+Rn]);St.ranges[En]=!0}for(var Jn=0,hr=yn;Jn<hr.length;Jn+=1)(0,hr[Jn])(Un,cn);delete St.requests[En]})),yn.push(function(Un,cn){Un?ze(Un):cn&&ze(null,{stack:it,id:Bt,glyph:cn[Bt]||null})})}}else ze(null,{stack:it,id:Bt,glyph:Xt})},function(de,ze){if(de)S(de);else if(ze){for(var it={},Bt=0,St=ze;Bt<St.length;Bt+=1){var Xt=St[Bt],En=Xt.stack,yn=Xt.id,Un=Xt.glyph;(it[En]||(it[En]={}))[yn]=Un&&{id:Un.id,bitmap:Un.bitmap.clone(),metrics:Un.metrics}}S(null,it)}})},vt.prototype._doesCharSupportLocalGlyph=function(_){return!!this.localIdeographFontFamily&&(E.isChar["CJK Unified Ideographs"](_)||E.isChar["Hangul Syllables"](_)||E.isChar.Hiragana(_)||E.isChar.Katakana(_))},vt.prototype._tinySDF=function(_,S,x){var C=this.localIdeographFontFamily;if(C&&this._doesCharSupportLocalGlyph(x)){var k=_.tinySDF;if(!k){var G="400";/bold/i.test(S)?G="900":/medium/i.test(S)?G="500":/light/i.test(S)&&(G="200"),k=_.tinySDF=new vt.TinySDF(24,3,8,.25,C,G)}return{id:x,bitmap:new E.AlphaImage({width:30,height:30},k.draw(String.fromCharCode(x))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},vt.loadGlyphRange=function(_,S,x,C,k){var G=256*S,q=G+255,de=C.transformRequest(C.normalizeGlyphsURL(x).replace("{fontstack}",_).replace("{range}",G+"-"+q),E.ResourceType.Glyphs);E.getArrayBuffer(de,function(ze,it){if(ze)k(ze);else if(it){for(var Bt={},St=0,Xt=E.parseGlyphPBF(it);St<Xt.length;St+=1){var En=Xt[St];Bt[En.id]=En}k(null,Bt)}})},vt.TinySDF=le;var ke=function(){this.specification=E.styleSpec.light.position};ke.prototype.possiblyEvaluate=function(_,S){return E.sphericalToCartesian(_.expression.evaluate(S))},ke.prototype.interpolate=function(_,S,x){return{x:E.number(_.x,S.x,x),y:E.number(_.y,S.y,x),z:E.number(_.z,S.z,x)}};var Re=new E.Properties({anchor:new E.DataConstantProperty(E.styleSpec.light.anchor),position:new ke,color:new E.DataConstantProperty(E.styleSpec.light.color),intensity:new E.DataConstantProperty(E.styleSpec.light.intensity)}),bt=function(_){function S(x){_.call(this),this._transitionable=new E.Transitionable(Re),this.setLight(x),this._transitioning=this._transitionable.untransitioned()}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getLight=function(){return this._transitionable.serialize()},S.prototype.setLight=function(x,C){if(C===void 0&&(C={}),!this._validate(E.validateLight,x,C))for(var k in x){var G=x[k];E.endsWith(k,"-transition")?this._transitionable.setTransition(k.slice(0,-11),G):this._transitionable.setValue(k,G)}},S.prototype.updateTransitions=function(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)},S.prototype.hasTransition=function(){return this._transitioning.hasTransition()},S.prototype.recalculate=function(x){this.properties=this._transitioning.possiblyEvaluate(x)},S.prototype._validate=function(x,C,k){return(!k||k.validate!==!1)&&E.emitValidationErrors(this,x.call(E.validateStyle,E.extend({value:C,style:{glyphs:!0,sprite:!0},styleSpec:E.styleSpec})))},S}(E.Evented),gt=function(_,S){this.width=_,this.height=S,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};gt.prototype.getDash=function(_,S){var x=_.join(",")+String(S);return this.dashEntry[x]||(this.dashEntry[x]=this.addDash(_,S)),this.dashEntry[x]},gt.prototype.getDashRanges=function(_,S,x){var C=[],k=_.length%2==1?-_[_.length-1]*x:0,G=_[0]*x,q=!0;C.push({left:k,right:G,isDash:q,zeroLength:_[0]===0});for(var de=_[0],ze=1;ze<_.length;ze++){var it=_[ze];C.push({left:k=de*x,right:G=(de+=it)*x,isDash:q=!q,zeroLength:it===0})}return C},gt.prototype.addRoundDash=function(_,S,x){for(var C=S/2,k=-x;k<=x;k++)for(var G=this.width*(this.nextRow+x+k),q=0,de=_[q],ze=0;ze<this.width;ze++){ze/de.right>1&&(de=_[++q]);var it=Math.abs(ze-de.left),Bt=Math.abs(ze-de.right),St=Math.min(it,Bt),Xt=void 0,En=k/x*(C+1);if(de.isDash){var yn=C-Math.abs(En);Xt=Math.sqrt(St*St+yn*yn)}else Xt=C-Math.sqrt(St*St+En*En);this.data[G+ze]=Math.max(0,Math.min(255,Xt+128))}},gt.prototype.addRegularDash=function(_){for(var S=_.length-1;S>=0;--S){var x=_[S],C=_[S+1];x.zeroLength?_.splice(S,1):C&&C.isDash===x.isDash&&(C.left=x.left,_.splice(S,1))}var k=_[0],G=_[_.length-1];k.isDash===G.isDash&&(k.left=G.left-this.width,G.right=k.right+this.width);for(var q=this.width*this.nextRow,de=0,ze=_[de],it=0;it<this.width;it++){it/ze.right>1&&(ze=_[++de]);var Bt=Math.abs(it-ze.left),St=Math.abs(it-ze.right),Xt=Math.min(Bt,St);this.data[q+it]=Math.max(0,Math.min(255,(ze.isDash?Xt:-Xt)+128))}},gt.prototype.addDash=function(_,S){var x=S?7:0,C=2*x+1;if(this.nextRow+C>this.height)return E.warnOnce("LineAtlas out of space"),null;for(var k=0,G=0;G<_.length;G++)k+=_[G];if(k!==0){var q=this.width/k,de=this.getDashRanges(_,this.width,q);S?this.addRoundDash(de,q,x):this.addRegularDash(de)}var ze={y:(this.nextRow+x+.5)/this.height,height:2*x/this.height,width:k};return this.nextRow+=C,this.dirty=!0,ze},gt.prototype.bind=function(_){var S=_.gl;this.texture?(S.bindTexture(S.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,S.texSubImage2D(S.TEXTURE_2D,0,0,0,this.width,this.height,S.ALPHA,S.UNSIGNED_BYTE,this.data))):(this.texture=S.createTexture(),S.bindTexture(S.TEXTURE_2D,this.texture),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.REPEAT),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.REPEAT),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR),S.texImage2D(S.TEXTURE_2D,0,S.ALPHA,this.width,this.height,0,S.ALPHA,S.UNSIGNED_BYTE,this.data))};var Ct=function _(S,x){this.workerPool=S,this.actors=[],this.currentActor=0,this.id=E.uniqueId();for(var C=this.workerPool.acquire(this.id),k=0;k<C.length;k++){var G=new _.Actor(C[k],x,this.id);G.name="Worker "+k,this.actors.push(G)}};function Sn(_,S,x){var C=function(k,G){if(k)return x(k);if(G){var q=E.pick(E.extend(G,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);G.vector_layers&&(q.vectorLayers=G.vector_layers,q.vectorLayerIds=q.vectorLayers.map(function(de){return de.id})),q.tiles=S.canonicalizeTileset(q,_.url),x(null,q)}};return _.url?E.getJSON(S.transformRequest(S.normalizeSourceURL(_.url),E.ResourceType.Source),C):E.browser.frame(function(){return C(null,_)})}Ct.prototype.broadcast=function(_,S,x){E.asyncAll(this.actors,function(C,k){C.send(_,S,k)},x=x||function(){})},Ct.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ct.prototype.remove=function(){this.actors.forEach(function(_){_.remove()}),this.actors=[],this.workerPool.release(this.id)},Ct.Actor=E.Actor;var He=function(_,S,x){this.bounds=E.LngLatBounds.convert(this.validateBounds(_)),this.minzoom=S||0,this.maxzoom=x||24};He.prototype.validateBounds=function(_){return Array.isArray(_)&&_.length===4?[Math.max(-180,_[0]),Math.max(-90,_[1]),Math.min(180,_[2]),Math.min(90,_[3])]:[-180,-90,180,90]},He.prototype.contains=function(_){var S=Math.pow(2,_.z),x=Math.floor(E.mercatorXfromLng(this.bounds.getWest())*S),C=Math.floor(E.mercatorYfromLat(this.bounds.getNorth())*S),k=Math.ceil(E.mercatorXfromLng(this.bounds.getEast())*S),G=Math.ceil(E.mercatorYfromLat(this.bounds.getSouth())*S);return _.x>=x&&_.x<k&&_.y>=C&&_.y<G};var Ot=function(_){function S(x,C,k,G){if(_.call(this),this.id=x,this.dispatcher=k,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,E.extend(this,E.pick(C,["url","scheme","tileSize","promoteId"])),this._options=E.extend({type:"vector"},C),this._collectResourceTiming=C.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(G)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this._loaded=!1,this.fire(new E.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Sn(this._options,this.map._requestManager,function(C,k){x._tileJSONRequest=null,x._loaded=!0,C?x.fire(new E.ErrorEvent(C)):k&&(E.extend(x,k),k.bounds&&(x.tileBounds=new He(k.bounds,x.minzoom,x.maxzoom)),E.postTurnstileEvent(k.tiles,x.map._requestManager._customAccessToken),E.postMapLoadEvent(k.tiles,x.map._getMapId(),x.map._requestManager._skuToken,x.map._requestManager._customAccessToken),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"metadata"})),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"content"})))})},S.prototype.loaded=function(){return this._loaded},S.prototype.hasTile=function(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.setSourceProperty=function(x){this._tileJSONRequest&&this._tileJSONRequest.cancel(),x(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},S.prototype.setTiles=function(x){var C=this;return this.setSourceProperty(function(){C._options.tiles=x}),this},S.prototype.setUrl=function(x){var C=this;return this.setSourceProperty(function(){C.url=x,C._options.url=x}),this},S.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},S.prototype.serialize=function(){return E.extend({},this._options)},S.prototype.loadTile=function(x,C){var k=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme)),G={request:this.map._requestManager.transformRequest(k,E.ResourceType.Tile),uid:x.uid,tileID:x.tileID,zoom:x.tileID.overscaledZ,tileSize:this.tileSize*x.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:E.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function q(de,ze){return delete x.request,x.aborted?C(null):de&&de.status!==404?C(de):(ze&&ze.resourceTiming&&(x.resourceTiming=ze.resourceTiming),this.map._refreshExpiredTiles&&ze&&x.setExpiryData(ze),x.loadVectorData(ze,this.map.painter),E.cacheEntryPossiblyAdded(this.dispatcher),C(null),void(x.reloadCallback&&(this.loadTile(x,x.reloadCallback),x.reloadCallback=null)))}G.request.collectResourceTiming=this._collectResourceTiming,x.actor&&x.state!=="expired"?x.state==="loading"?x.reloadCallback=C:x.request=x.actor.send("reloadTile",G,q.bind(this)):(x.actor=this.dispatcher.getActor(),x.request=x.actor.send("loadTile",G,q.bind(this)))},S.prototype.abortTile=function(x){x.request&&(x.request.cancel(),delete x.request),x.actor&&x.actor.send("abortTile",{uid:x.uid,type:this.type,source:this.id},void 0)},S.prototype.unloadTile=function(x){x.unloadVectorData(),x.actor&&x.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id},void 0)},S.prototype.hasTransition=function(){return!1},S}(E.Evented),Ce=function(_){function S(x,C,k,G){_.call(this),this.id=x,this.dispatcher=k,this.setEventedParent(G),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=E.extend({type:"raster"},C),E.extend(this,E.pick(C,["url","scheme","tileSize"]))}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this._loaded=!1,this.fire(new E.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Sn(this._options,this.map._requestManager,function(C,k){x._tileJSONRequest=null,x._loaded=!0,C?x.fire(new E.ErrorEvent(C)):k&&(E.extend(x,k),k.bounds&&(x.tileBounds=new He(k.bounds,x.minzoom,x.maxzoom)),E.postTurnstileEvent(k.tiles),E.postMapLoadEvent(k.tiles,x.map._getMapId(),x.map._requestManager._skuToken),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"metadata"})),x.fire(new E.Event("data",{dataType:"source",sourceDataType:"content"})))})},S.prototype.loaded=function(){return this._loaded},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},S.prototype.serialize=function(){return E.extend({},this._options)},S.prototype.hasTile=function(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)},S.prototype.loadTile=function(x,C){var k=this,G=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);x.request=E.getImage(this.map._requestManager.transformRequest(G,E.ResourceType.Tile),function(q,de){if(delete x.request,x.aborted)x.state="unloaded",C(null);else if(q)x.state="errored",C(q);else if(de){k.map._refreshExpiredTiles&&x.setExpiryData(de),delete de.cacheControl,delete de.expires;var ze=k.map.painter.context,it=ze.gl;x.texture=k.map.painter.getTileTexture(de.width),x.texture?x.texture.update(de,{useMipmap:!0}):(x.texture=new E.Texture(ze,de,it.RGBA,{useMipmap:!0}),x.texture.bind(it.LINEAR,it.CLAMP_TO_EDGE,it.LINEAR_MIPMAP_NEAREST),ze.extTextureFilterAnisotropic&&it.texParameterf(it.TEXTURE_2D,ze.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ze.extTextureFilterAnisotropicMax)),x.state="loaded",E.cacheEntryPossiblyAdded(k.dispatcher),C(null)}})},S.prototype.abortTile=function(x,C){x.request&&(x.request.cancel(),delete x.request),C()},S.prototype.unloadTile=function(x,C){x.texture&&this.map.painter.saveTileTexture(x.texture),C()},S.prototype.hasTransition=function(){return!1},S}(E.Evented),ot=function(_){function S(x,C,k,G){_.call(this,x,C,k,G),this.type="raster-dem",this.maxzoom=22,this._options=E.extend({type:"raster-dem"},C),this.encoding=C.encoding||"mapbox"}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},S.prototype.loadTile=function(x,C){var k=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function G(q,de){q&&(x.state="errored",C(q)),de&&(x.dem=de,x.needsHillshadePrepare=!0,x.state="loaded",C(null))}x.request=E.getImage(this.map._requestManager.transformRequest(k,E.ResourceType.Tile),function(q,de){if(delete x.request,x.aborted)x.state="unloaded",C(null);else if(q)x.state="errored",C(q);else if(de){this.map._refreshExpiredTiles&&x.setExpiryData(de),delete de.cacheControl,delete de.expires;var ze=E.window.ImageBitmap&&de instanceof E.window.ImageBitmap&&E.offscreenCanvasSupported()?de:E.browser.getImageData(de,1),it={uid:x.uid,coord:x.tileID,source:this.id,rawImageData:ze,encoding:this.encoding};x.actor&&x.state!=="expired"||(x.actor=this.dispatcher.getActor(),x.actor.send("loadDEMTile",it,G.bind(this)))}}.bind(this)),x.neighboringTiles=this._getNeighboringTiles(x.tileID)},S.prototype._getNeighboringTiles=function(x){var C=x.canonical,k=Math.pow(2,C.z),G=(C.x-1+k)%k,q=C.x===0?x.wrap-1:x.wrap,de=(C.x+1+k)%k,ze=C.x+1===k?x.wrap+1:x.wrap,it={};return it[new E.OverscaledTileID(x.overscaledZ,q,C.z,G,C.y).key]={backfilled:!1},it[new E.OverscaledTileID(x.overscaledZ,ze,C.z,de,C.y).key]={backfilled:!1},C.y>0&&(it[new E.OverscaledTileID(x.overscaledZ,q,C.z,G,C.y-1).key]={backfilled:!1},it[new E.OverscaledTileID(x.overscaledZ,x.wrap,C.z,C.x,C.y-1).key]={backfilled:!1},it[new E.OverscaledTileID(x.overscaledZ,ze,C.z,de,C.y-1).key]={backfilled:!1}),C.y+1<k&&(it[new E.OverscaledTileID(x.overscaledZ,q,C.z,G,C.y+1).key]={backfilled:!1},it[new E.OverscaledTileID(x.overscaledZ,x.wrap,C.z,C.x,C.y+1).key]={backfilled:!1},it[new E.OverscaledTileID(x.overscaledZ,ze,C.z,de,C.y+1).key]={backfilled:!1}),it},S.prototype.unloadTile=function(x){x.demTexture&&this.map.painter.saveTileTexture(x.demTexture),x.fbo&&(x.fbo.destroy(),delete x.fbo),x.dem&&delete x.dem,delete x.neighboringTiles,x.state="unloaded",x.actor&&x.actor.send("removeDEMTile",{uid:x.uid,source:this.id})},S}(Ce),$e=function(_){function S(x,C,k,G){_.call(this),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=k.getActor(),this.setEventedParent(G),this._data=C.data,this._options=E.extend({},C),this._collectResourceTiming=C.collectResourceTiming,this._resourceTiming=[],C.maxzoom!==void 0&&(this.maxzoom=C.maxzoom),C.type&&(this.type=C.type),C.attribution&&(this.attribution=C.attribution),this.promoteId=C.promoteId;var q=E.EXTENT/this.tileSize;this.workerOptions=E.extend({source:this.id,cluster:C.cluster||!1,geojsonVtOptions:{buffer:(C.buffer!==void 0?C.buffer:128)*q,tolerance:(C.tolerance!==void 0?C.tolerance:.375)*q,extent:E.EXTENT,maxZoom:this.maxzoom,lineMetrics:C.lineMetrics||!1,generateId:C.generateId||!1},superclusterOptions:{maxZoom:C.clusterMaxZoom!==void 0?Math.min(C.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,C.clusterMinPoints||2),extent:E.EXTENT,radius:(C.clusterRadius||50)*q,log:!1,generateId:C.generateId||!1},clusterProperties:C.clusterProperties,filter:C.filter},C.workerOptions)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this.fire(new E.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(C){if(C)x.fire(new E.ErrorEvent(C));else{var k={dataType:"source",sourceDataType:"metadata"};x._collectResourceTiming&&x._resourceTiming&&x._resourceTiming.length>0&&(k.resourceTiming=x._resourceTiming,x._resourceTiming=[]),x.fire(new E.Event("data",k))}})},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.setData=function(x){var C=this;return this._data=x,this.fire(new E.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(k){if(k)C.fire(new E.ErrorEvent(k));else{var G={dataType:"source",sourceDataType:"content"};C._collectResourceTiming&&C._resourceTiming&&C._resourceTiming.length>0&&(G.resourceTiming=C._resourceTiming,C._resourceTiming=[]),C.fire(new E.Event("data",G))}}),this},S.prototype.getClusterExpansionZoom=function(x,C){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id},C),this},S.prototype.getClusterChildren=function(x,C){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id},C),this},S.prototype.getClusterLeaves=function(x,C,k,G){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:x,limit:C,offset:k},G),this},S.prototype._updateWorkerData=function(x){var C=this;this._loaded=!1;var k=E.extend({},this.workerOptions),G=this._data;typeof G=="string"?(k.request=this.map._requestManager.transformRequest(E.browser.resolveURL(G),E.ResourceType.Source),k.request.collectResourceTiming=this._collectResourceTiming):k.data=JSON.stringify(G),this.actor.send(this.type+".loadData",k,function(q,de){C._removed||de&&de.abandoned||(C._loaded=!0,de&&de.resourceTiming&&de.resourceTiming[C.id]&&(C._resourceTiming=de.resourceTiming[C.id].slice(0)),C.actor.send(C.type+".coalesce",{source:k.source},null),x(q))})},S.prototype.loaded=function(){return this._loaded},S.prototype.loadTile=function(x,C){var k=this,G=x.actor?"reloadTile":"loadTile";x.actor=this.actor,x.request=this.actor.send(G,{type:this.type,uid:x.uid,tileID:x.tileID,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:E.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(q,de){return delete x.request,x.unloadVectorData(),x.aborted?C(null):q?C(q):(x.loadVectorData(de,k.map.painter,G==="reloadTile"),C(null))})},S.prototype.abortTile=function(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0},S.prototype.unloadTile=function(x){x.unloadVectorData(),this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id})},S.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},S.prototype.serialize=function(){return E.extend({},this._options,{type:this.type,data:this._data})},S.prototype.hasTransition=function(){return!1},S}(E.Evented),Xe=E.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Rt=function(_){function S(x,C,k,G){_.call(this),this.id=x,this.dispatcher=k,this.coordinates=C.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(G),this.options=C}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(x,C){var k=this;this._loaded=!1,this.fire(new E.Event("dataloading",{dataType:"source"})),this.url=this.options.url,E.getImage(this.map._requestManager.transformRequest(this.url,E.ResourceType.Image),function(G,q){k._loaded=!0,G?k.fire(new E.ErrorEvent(G)):q&&(k.image=q,x&&(k.coordinates=x),C&&C(),k._finishLoading())})},S.prototype.loaded=function(){return this._loaded},S.prototype.updateImage=function(x){var C=this;return this.image&&x.url?(this.options.url=x.url,this.load(x.coordinates,function(){C.texture=null}),this):this},S.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new E.Event("data",{dataType:"source",sourceDataType:"metadata"})))},S.prototype.onAdd=function(x){this.map=x,this.load()},S.prototype.setCoordinates=function(x){var C=this;this.coordinates=x;var k=x.map(E.MercatorCoordinate.fromLngLat);this.tileID=function(q){for(var de=1/0,ze=1/0,it=-1/0,Bt=-1/0,St=0,Xt=q;St<Xt.length;St+=1){var En=Xt[St];de=Math.min(de,En.x),ze=Math.min(ze,En.y),it=Math.max(it,En.x),Bt=Math.max(Bt,En.y)}var yn=Math.max(it-de,Bt-ze),Un=Math.max(0,Math.floor(-Math.log(yn)/Math.LN2)),cn=Math.pow(2,Un);return new E.CanonicalTileID(Un,Math.floor((de+it)/2*cn),Math.floor((ze+Bt)/2*cn))}(k),this.minzoom=this.maxzoom=this.tileID.z;var G=k.map(function(q){return C.tileID.getTilePoint(q)._round()});return this._boundsArray=new E.StructArrayLayout4i8,this._boundsArray.emplaceBack(G[0].x,G[0].y,0,0),this._boundsArray.emplaceBack(G[1].x,G[1].y,E.EXTENT,0),this._boundsArray.emplaceBack(G[3].x,G[3].y,0,E.EXTENT),this._boundsArray.emplaceBack(G[2].x,G[2].y,E.EXTENT,E.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new E.Event("data",{dataType:"source",sourceDataType:"content"})),this},S.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var x=this.map.painter.context,C=x.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,Xe.members)),this.boundsSegments||(this.boundsSegments=E.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new E.Texture(x,this.image,C.RGBA),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE)),this.tiles){var G=this.tiles[k];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}}},S.prototype.loadTile=function(x,C){this.tileID&&this.tileID.equals(x.tileID.canonical)?(this.tiles[String(x.tileID.wrap)]=x,x.buckets={},C(null)):(x.state="errored",C(null))},S.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},S.prototype.hasTransition=function(){return!1},S}(E.Evented),_t=function(_){function S(x,C,k,G){_.call(this,x,C,k,G),this.roundZoom=!0,this.type="video",this.options=C}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){var x=this;this._loaded=!1;var C=this.options;this.urls=[];for(var k=0,G=C.urls;k<G.length;k+=1)this.urls.push(this.map._requestManager.transformRequest(G[k],E.ResourceType.Source).url);E.getVideo(this.urls,function(q,de){x._loaded=!0,q?x.fire(new E.ErrorEvent(q)):de&&(x.video=de,x.video.loop=!0,x.video.setAttribute("playsinline",""),x.video.addEventListener("playing",function(){x.map.triggerRepaint()}),x.map&&x.video.play(),x._finishLoading())})},S.prototype.pause=function(){this.video&&this.video.pause()},S.prototype.play=function(){this.video&&this.video.play()},S.prototype.seek=function(x){if(this.video){var C=this.video.seekable;x<C.start(0)||x>C.end(0)?this.fire(new E.ErrorEvent(new E.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+C.start(0)+" and "+C.end(0)+"-second mark."))):this.video.currentTime=x}},S.prototype.getVideo=function(){return this.video},S.prototype.onAdd=function(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},S.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var x=this.map.painter.context,C=x.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,Xe.members)),this.boundsSegments||(this.boundsSegments=E.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.texSubImage2D(C.TEXTURE_2D,0,0,0,C.RGBA,C.UNSIGNED_BYTE,this.video)):(this.texture=new E.Texture(x,this.video,C.RGBA),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE)),this.tiles){var G=this.tiles[k];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}}},S.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},S.prototype.hasTransition=function(){return this.video&&!this.video.paused},S}(Rt),Pe=function(_){function S(x,C,k,G){_.call(this,x,C,k,G),C.coordinates?Array.isArray(C.coordinates)&&C.coordinates.length===4&&!C.coordinates.some(function(q){return!Array.isArray(q)||q.length!==2||q.some(function(de){return typeof de!="number"})})||this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'missing required property "coordinates"'))),C.animate&&typeof C.animate!="boolean"&&this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'optional "animate" property must be a boolean value'))),C.canvas?typeof C.canvas=="string"||C.canvas instanceof E.window.HTMLCanvasElement||this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new E.ErrorEvent(new E.ValidationError("sources."+x,null,'missing required property "canvas"'))),this.options=C,this.animate=C.animate===void 0||C.animate}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof E.window.HTMLCanvasElement?this.options.canvas:E.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new E.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},S.prototype.getCanvas=function(){return this.canvas},S.prototype.onAdd=function(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()},S.prototype.onRemove=function(){this.pause()},S.prototype.prepare=function(){var x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var C=this.map.painter.context,k=C.gl;for(var G in this.boundsBuffer||(this.boundsBuffer=C.createVertexBuffer(this._boundsArray,Xe.members)),this.boundsSegments||(this.boundsSegments=E.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new E.Texture(C,this.canvas,k.RGBA,{premultiply:!0}),this.tiles){var q=this.tiles[G];q.state!=="loaded"&&(q.state="loaded",q.texture=this.texture)}}},S.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},S.prototype.hasTransition=function(){return this._playing},S.prototype._hasInvalidDimensions=function(){for(var x=0,C=[this.canvas.width,this.canvas.height];x<C.length;x+=1){var k=C[x];if(isNaN(k)||k<=0)return!0}return!1},S}(Rt),Wt={vector:Ot,raster:Ce,"raster-dem":ot,geojson:$e,video:_t,image:Rt,canvas:Pe};function on(_,S){var x=E.identity([]);return E.translate(x,x,[1,1,0]),E.scale(x,x,[.5*_.width,.5*_.height,1]),E.multiply(x,x,_.calculatePosMatrix(S.toUnwrapped()))}function Nn(_,S,x,C,k,G){var q=function(Un,cn,Rn){if(Un)for(var Jn=0,hr=Un;Jn<hr.length;Jn+=1){var Lr=cn[hr[Jn]];if(Lr&&Lr.source===Rn&&Lr.type==="fill-extrusion")return!0}else for(var gr in cn){var Dr=cn[gr];if(Dr.source===Rn&&Dr.type==="fill-extrusion")return!0}return!1}(k&&k.layers,S,_.id),de=G.maxPitchScaleFactor(),ze=_.tilesIn(C,de,q);ze.sort(jn);for(var it=[],Bt=0,St=ze;Bt<St.length;Bt+=1){var Xt=St[Bt];it.push({wrappedTileID:Xt.tileID.wrapped().key,queryResults:Xt.tile.queryRenderedFeatures(S,x,_._state,Xt.queryGeometry,Xt.cameraQueryGeometry,Xt.scale,k,G,de,on(_.transform,Xt.tileID))})}var En=function(Un){for(var cn={},Rn={},Jn=0,hr=Un;Jn<hr.length;Jn+=1){var Lr=hr[Jn],gr=Lr.queryResults,Dr=Lr.wrappedTileID,Fr=Rn[Dr]=Rn[Dr]||{};for(var Mi in gr)for(var Pi=gr[Mi],vi=Fr[Mi]=Fr[Mi]||{},Oo=cn[Mi]=cn[Mi]||[],yo=0,Ho=Pi;yo<Ho.length;yo+=1){var is=Ho[yo];vi[is.featureIndex]||(vi[is.featureIndex]=!0,Oo.push(is))}}return cn}(it);for(var yn in En)En[yn].forEach(function(Un){var cn=Un.feature,Rn=_.getFeatureState(cn.layer["source-layer"],cn.id);cn.source=cn.layer.source,cn.layer["source-layer"]&&(cn.sourceLayer=cn.layer["source-layer"]),cn.state=Rn});return En}function jn(_,S){var x=_.tileID,C=S.tileID;return x.overscaledZ-C.overscaledZ||x.canonical.y-C.canonical.y||x.wrap-C.wrap||x.canonical.x-C.canonical.x}var lr=function(_,S){this.max=_,this.onRemove=S,this.reset()};lr.prototype.reset=function(){for(var _ in this.data)for(var S=0,x=this.data[_];S<x.length;S+=1){var C=x[S];C.timeout&&clearTimeout(C.timeout),this.onRemove(C.value)}return this.data={},this.order=[],this},lr.prototype.add=function(_,S,x){var C=this,k=_.wrapped().key;this.data[k]===void 0&&(this.data[k]=[]);var G={value:S,timeout:void 0};if(x!==void 0&&(G.timeout=setTimeout(function(){C.remove(_,G)},x)),this.data[k].push(G),this.order.push(k),this.order.length>this.max){var q=this._getAndRemoveByKey(this.order[0]);q&&this.onRemove(q)}return this},lr.prototype.has=function(_){return _.wrapped().key in this.data},lr.prototype.getAndRemove=function(_){return this.has(_)?this._getAndRemoveByKey(_.wrapped().key):null},lr.prototype._getAndRemoveByKey=function(_){var S=this.data[_].shift();return S.timeout&&clearTimeout(S.timeout),this.data[_].length===0&&delete this.data[_],this.order.splice(this.order.indexOf(_),1),S.value},lr.prototype.getByKey=function(_){var S=this.data[_];return S?S[0].value:null},lr.prototype.get=function(_){return this.has(_)?this.data[_.wrapped().key][0].value:null},lr.prototype.remove=function(_,S){if(!this.has(_))return this;var x=_.wrapped().key,C=S===void 0?0:this.data[x].indexOf(S),k=this.data[x][C];return this.data[x].splice(C,1),k.timeout&&clearTimeout(k.timeout),this.data[x].length===0&&delete this.data[x],this.onRemove(k.value),this.order.splice(this.order.indexOf(x),1),this},lr.prototype.setMaxSize=function(_){for(this.max=_;this.order.length>this.max;){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},lr.prototype.filter=function(_){var S=[];for(var x in this.data)for(var C=0,k=this.data[x];C<k.length;C+=1){var G=k[C];_(G.value)||S.push(G)}for(var q=0,de=S;q<de.length;q+=1){var ze=de[q];this.remove(ze.value.tileID,ze)}};var Vt=function(_,S,x){this.context=_;var C=_.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),_.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete S.arrayBuffer};Vt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Vt.prototype.updateData=function(_){var S=this.context.gl;this.context.unbindVAO(),this.bind(),S.bufferSubData(S.ELEMENT_ARRAY_BUFFER,0,_.arrayBuffer)},Vt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var en={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},xn=function(_,S,x,C){this.length=S.length,this.attributes=x,this.itemSize=S.bytesPerElement,this.dynamicDraw=C,this.context=_;var k=_.gl;this.buffer=k.createBuffer(),_.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||delete S.arrayBuffer};xn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},xn.prototype.updateData=function(_){var S=this.context.gl;this.bind(),S.bufferSubData(S.ARRAY_BUFFER,0,_.arrayBuffer)},xn.prototype.enableAttributes=function(_,S){for(var x=0;x<this.attributes.length;x++){var C=S.attributes[this.attributes[x].name];C!==void 0&&_.enableVertexAttribArray(C)}},xn.prototype.setVertexAttribPointers=function(_,S,x){for(var C=0;C<this.attributes.length;C++){var k=this.attributes[C],G=S.attributes[k.name];G!==void 0&&_.vertexAttribPointer(G,k.components,_[en[k.type]],!1,this.itemSize,k.offset+this.itemSize*(x||0))}},xn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var er=function(_){this.gl=_.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};er.prototype.get=function(){return this.current},er.prototype.set=function(_){},er.prototype.getDefault=function(){return this.default},er.prototype.setDefault=function(){this.set(this.default)};var sn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return E.Color.transparent},S.prototype.set=function(x){var C=this.current;(x.r!==C.r||x.g!==C.g||x.b!==C.b||x.a!==C.a||this.dirty)&&(this.gl.clearColor(x.r,x.g,x.b,x.a),this.current=x,this.dirty=!1)},S}(er),Ut=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 1},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.clearDepth(x),this.current=x,this.dirty=!1)},S}(er),Dt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 0},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.clearStencil(x),this.current=x,this.dirty=!1)},S}(er),Me=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return[!0,!0,!0,!0]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||x[2]!==C[2]||x[3]!==C[3]||this.dirty)&&(this.gl.colorMask(x[0],x[1],x[2],x[3]),this.current=x,this.dirty=!1)},S}(er),Qe=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!0},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.depthMask(x),this.current=x,this.dirty=!1)},S}(er),Ft=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 255},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.stencilMask(x),this.current=x,this.dirty=!1)},S}(er),U=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},S.prototype.set=function(x){var C=this.current;(x.func!==C.func||x.ref!==C.ref||x.mask!==C.mask||this.dirty)&&(this.gl.stencilFunc(x.func,x.ref,x.mask),this.current=x,this.dirty=!1)},S}(er),ue=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){var x=this.gl;return[x.KEEP,x.KEEP,x.KEEP]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||x[2]!==C[2]||this.dirty)&&(this.gl.stencilOp(x[0],x[1],x[2]),this.current=x,this.dirty=!1)},S}(er),at=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.STENCIL_TEST):C.disable(C.STENCIL_TEST),this.current=x,this.dirty=!1}},S}(er),ce=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return[0,1]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||this.dirty)&&(this.gl.depthRange(x[0],x[1]),this.current=x,this.dirty=!1)},S}(er),j=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST),this.current=x,this.dirty=!1}},S}(er),ln=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.LESS},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.depthFunc(x),this.current=x,this.dirty=!1)},S}(er),fn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.BLEND):C.disable(C.BLEND),this.current=x,this.dirty=!1}},S}(er),mt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){var x=this.gl;return[x.ONE,x.ZERO]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||this.dirty)&&(this.gl.blendFunc(x[0],x[1]),this.current=x,this.dirty=!1)},S}(er),Gt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return E.Color.transparent},S.prototype.set=function(x){var C=this.current;(x.r!==C.r||x.g!==C.g||x.b!==C.b||x.a!==C.a||this.dirty)&&(this.gl.blendColor(x.r,x.g,x.b,x.a),this.current=x,this.dirty=!1)},S}(er),Wn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.FUNC_ADD},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.blendEquation(x),this.current=x,this.dirty=!1)},S}(er),hn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;x?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),this.current=x,this.dirty=!1}},S}(er),ht=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.BACK},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.cullFace(x),this.current=x,this.dirty=!1)},S}(er),Ht=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.CCW},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.frontFace(x),this.current=x,this.dirty=!1)},S}(er),Cn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.useProgram(x),this.current=x,this.dirty=!1)},S}(er),Ln=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return this.gl.TEXTURE0},S.prototype.set=function(x){(x!==this.current||this.dirty)&&(this.gl.activeTexture(x),this.current=x,this.dirty=!1)},S}(er),Gn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){var x=this.gl;return[0,0,x.drawingBufferWidth,x.drawingBufferHeight]},S.prototype.set=function(x){var C=this.current;(x[0]!==C[0]||x[1]!==C[1]||x[2]!==C[2]||x[3]!==C[3]||this.dirty)&&(this.gl.viewport(x[0],x[1],x[2],x[3]),this.current=x,this.dirty=!1)},S}(er),dt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindFramebuffer(C.FRAMEBUFFER,x),this.current=x,this.dirty=!1}},S}(er),ye=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindRenderbuffer(C.RENDERBUFFER,x),this.current=x,this.dirty=!1}},S}(er),Fe=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindTexture(C.TEXTURE_2D,x),this.current=x,this.dirty=!1}},S}(er),nt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.bindBuffer(C.ARRAY_BUFFER,x),this.current=x,this.dirty=!1}},S}(er),Pt=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){var C=this.gl;C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,x),this.current=x,this.dirty=!1},S}(er),Mt=function(_){function S(x){_.call(this,x),this.vao=x.extVertexArrayObject}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S.prototype.set=function(x){this.vao&&(x!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(x),this.current=x,this.dirty=!1)},S}(er),Tn=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return 4},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_ALIGNMENT,x),this.current=x,this.dirty=!1}},S}(er),$n=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,x),this.current=x,this.dirty=!1}},S}(er),xr=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return!1},S.prototype.set=function(x){if(x!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,x),this.current=x,this.dirty=!1}},S}(er),qn=function(_){function S(x,C){_.call(this,x),this.context=x,this.parent=C}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getDefault=function(){return null},S}(er),Ae=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.setDirty=function(){this.dirty=!0},S.prototype.set=function(x){if(x!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var C=this.gl;C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_2D,x,0),this.current=x,this.dirty=!1}},S}(qn),be=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.set=function(x){if(x!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var C=this.gl;C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,x),this.current=x,this.dirty=!1}},S}(qn),Ne=function(_,S,x,C){this.context=_,this.width=S,this.height=x;var k=this.framebuffer=_.gl.createFramebuffer();this.colorAttachment=new Ae(_,k),C&&(this.depthAttachment=new be(_,k))};Ne.prototype.destroy=function(){var _=this.context.gl,S=this.colorAttachment.get();if(S&&_.deleteTexture(S),this.depthAttachment){var x=this.depthAttachment.get();x&&_.deleteRenderbuffer(x)}_.deleteFramebuffer(this.framebuffer)};var et=function(_,S,x){this.func=_,this.mask=S,this.range=x};et.ReadOnly=!1,et.ReadWrite=!0,et.disabled=new et(519,et.ReadOnly,[0,1]);var wt=function(_,S,x,C,k,G){this.test=_,this.ref=S,this.mask=x,this.fail=C,this.depthFail=k,this.pass=G};wt.disabled=new wt({func:519,mask:0},0,0,7680,7680,7680);var qt=function(_,S,x){this.blendFunction=_,this.blendColor=S,this.mask=x};qt.disabled=new qt(qt.Replace=[1,0],E.Color.transparent,[!1,!1,!1,!1]),qt.unblended=new qt(qt.Replace,E.Color.transparent,[!0,!0,!0,!0]),qt.alphaBlended=new qt([1,771],E.Color.transparent,[!0,!0,!0,!0]);var vn=function(_,S,x){this.enable=_,this.mode=S,this.frontFace=x};vn.disabled=new vn(!1,1029,2305),vn.backCCW=new vn(!0,1029,2305);var yt=function(_){this.gl=_,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new sn(this),this.clearDepth=new Ut(this),this.clearStencil=new Dt(this),this.colorMask=new Me(this),this.depthMask=new Qe(this),this.stencilMask=new Ft(this),this.stencilFunc=new U(this),this.stencilOp=new ue(this),this.stencilTest=new at(this),this.depthRange=new ce(this),this.depthTest=new j(this),this.depthFunc=new ln(this),this.blend=new fn(this),this.blendFunc=new mt(this),this.blendColor=new Gt(this),this.blendEquation=new Wn(this),this.cullFace=new hn(this),this.cullFaceSide=new ht(this),this.frontFace=new Ht(this),this.program=new Cn(this),this.activeTexture=new Ln(this),this.viewport=new Gn(this),this.bindFramebuffer=new dt(this),this.bindRenderbuffer=new ye(this),this.bindTexture=new Fe(this),this.bindVertexBuffer=new nt(this),this.bindElementBuffer=new Pt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Mt(this),this.pixelStoreUnpack=new Tn(this),this.pixelStoreUnpackPremultiplyAlpha=new $n(this),this.pixelStoreUnpackFlipY=new xr(this),this.extTextureFilterAnisotropic=_.getExtension("EXT_texture_filter_anisotropic")||_.getExtension("MOZ_EXT_texture_filter_anisotropic")||_.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=_.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=_.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(_.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=_.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=_.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=_.getParameter(_.MAX_TEXTURE_SIZE)};yt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},yt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},yt.prototype.createIndexBuffer=function(_,S){return new Vt(this,_,S)},yt.prototype.createVertexBuffer=function(_,S,x){return new xn(this,_,S,x)},yt.prototype.createRenderbuffer=function(_,S,x){var C=this.gl,k=C.createRenderbuffer();return this.bindRenderbuffer.set(k),C.renderbufferStorage(C.RENDERBUFFER,_,S,x),this.bindRenderbuffer.set(null),k},yt.prototype.createFramebuffer=function(_,S,x){return new Ne(this,_,S,x)},yt.prototype.clear=function(_){var S=_.color,x=_.depth,C=this.gl,k=0;S&&(k|=C.COLOR_BUFFER_BIT,this.clearColor.set(S),this.colorMask.set([!0,!0,!0,!0])),x!==void 0&&(k|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(x),this.depthMask.set(!0)),C.clear(k)},yt.prototype.setCullFace=function(_){_.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(_.mode),this.frontFace.set(_.frontFace))},yt.prototype.setDepthMode=function(_){_.func!==this.gl.ALWAYS||_.mask?(this.depthTest.set(!0),this.depthFunc.set(_.func),this.depthMask.set(_.mask),this.depthRange.set(_.range)):this.depthTest.set(!1)},yt.prototype.setStencilMode=function(_){_.test.func!==this.gl.ALWAYS||_.mask?(this.stencilTest.set(!0),this.stencilMask.set(_.mask),this.stencilOp.set([_.fail,_.depthFail,_.pass]),this.stencilFunc.set({func:_.test.func,ref:_.ref,mask:_.test.mask})):this.stencilTest.set(!1)},yt.prototype.setColorMode=function(_){E.deepEqual(_.blendFunction,qt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(_.blendFunction),this.blendColor.set(_.blendColor)),this.colorMask.set(_.mask)},yt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Jt=function(_){function S(x,C,k){var G=this;_.call(this),this.id=x,this.dispatcher=k,this.on("data",function(q){q.dataType==="source"&&q.sourceDataType==="metadata"&&(G._sourceLoaded=!0),G._sourceLoaded&&!G._paused&&q.dataType==="source"&&q.sourceDataType==="content"&&(G.reload(),G.transform&&G.update(G.transform))}),this.on("error",function(){G._sourceErrored=!0}),this._source=function(q,de,ze,it){var Bt=new Wt[de.type](q,de,ze,it);if(Bt.id!==q)throw new Error("Expected Source id to be "+q+" instead of "+Bt.id);return E.bindAll(["load","abort","unload","serialize","prepare"],Bt),Bt}(x,C,k,this),this._tiles={},this._cache=new lr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new E.SourceFeatureState}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.onAdd=function(x){this.map=x,this._maxTileCacheSize=x?x._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(x)},S.prototype.onRemove=function(x){this._source&&this._source.onRemove&&this._source.onRemove(x)},S.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var x in this._tiles){var C=this._tiles[x];if(C.state!=="loaded"&&C.state!=="errored")return!1}return!0},S.prototype.getSource=function(){return this._source},S.prototype.pause=function(){this._paused=!0},S.prototype.resume=function(){if(this._paused){var x=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,x&&this.reload(),this.transform&&this.update(this.transform)}},S.prototype._loadTile=function(x,C){return this._source.loadTile(x,C)},S.prototype._unloadTile=function(x){if(this._source.unloadTile)return this._source.unloadTile(x,function(){})},S.prototype._abortTile=function(x){if(this._source.abortTile)return this._source.abortTile(x,function(){})},S.prototype.serialize=function(){return this._source.serialize()},S.prototype.prepare=function(x){for(var C in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var k=this._tiles[C];k.upload(x),k.prepare(this.map.style.imageManager)}},S.prototype.getIds=function(){return E.values(this._tiles).map(function(x){return x.tileID}).sort(Qn).map(function(x){return x.key})},S.prototype.getRenderableIds=function(x){var C=this,k=[];for(var G in this._tiles)this._isIdRenderable(G,x)&&k.push(this._tiles[G]);return x?k.sort(function(q,de){var ze=q.tileID,it=de.tileID,Bt=new E.Point(ze.canonical.x,ze.canonical.y)._rotate(C.transform.angle),St=new E.Point(it.canonical.x,it.canonical.y)._rotate(C.transform.angle);return ze.overscaledZ-it.overscaledZ||St.y-Bt.y||St.x-Bt.x}).map(function(q){return q.tileID.key}):k.map(function(q){return q.tileID}).sort(Qn).map(function(q){return q.key})},S.prototype.hasRenderableParent=function(x){var C=this.findLoadedParent(x,0);return!!C&&this._isIdRenderable(C.tileID.key)},S.prototype._isIdRenderable=function(x,C){return this._tiles[x]&&this._tiles[x].hasData()&&!this._coveredTiles[x]&&(C||!this._tiles[x].holdingForFade())},S.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var x in this._cache.reset(),this._tiles)this._tiles[x].state!=="errored"&&this._reloadTile(x,"reloading")},S.prototype._reloadTile=function(x,C){var k=this._tiles[x];k&&(k.state!=="loading"&&(k.state=C),this._loadTile(k,this._tileLoaded.bind(this,k,x,C)))},S.prototype._tileLoaded=function(x,C,k,G){if(G)return x.state="errored",void(G.status!==404?this._source.fire(new E.ErrorEvent(G,{tile:x})):this.update(this.transform));x.timeAdded=E.browser.now(),k==="expired"&&(x.refreshedUponExpiration=!0),this._setTileReloadTimer(C,x),this.getSource().type==="raster-dem"&&x.dem&&this._backfillDEM(x),this._state.initializeTileState(x,this.map?this.map.painter:null),this._source.fire(new E.Event("data",{dataType:"source",tile:x,coord:x.tileID}))},S.prototype._backfillDEM=function(x){for(var C=this.getRenderableIds(),k=0;k<C.length;k++){var G=C[k];if(x.neighboringTiles&&x.neighboringTiles[G]){var q=this.getTileByID(G);de(x,q),de(q,x)}}function de(ze,it){ze.needsHillshadePrepare=!0;var Bt=it.tileID.canonical.x-ze.tileID.canonical.x,St=it.tileID.canonical.y-ze.tileID.canonical.y,Xt=Math.pow(2,ze.tileID.canonical.z),En=it.tileID.key;Bt===0&&St===0||Math.abs(St)>1||(Math.abs(Bt)>1&&(Math.abs(Bt+Xt)===1?Bt+=Xt:Math.abs(Bt-Xt)===1&&(Bt-=Xt)),it.dem&&ze.dem&&(ze.dem.backfillBorder(it.dem,Bt,St),ze.neighboringTiles&&ze.neighboringTiles[En]&&(ze.neighboringTiles[En].backfilled=!0)))}},S.prototype.getTile=function(x){return this.getTileByID(x.key)},S.prototype.getTileByID=function(x){return this._tiles[x]},S.prototype._retainLoadedChildren=function(x,C,k,G){for(var q in this._tiles){var de=this._tiles[q];if(!(G[q]||!de.hasData()||de.tileID.overscaledZ<=C||de.tileID.overscaledZ>k)){for(var ze=de.tileID;de&&de.tileID.overscaledZ>C+1;){var it=de.tileID.scaledTo(de.tileID.overscaledZ-1);(de=this._tiles[it.key])&&de.hasData()&&(ze=it)}for(var Bt=ze;Bt.overscaledZ>C;)if(x[(Bt=Bt.scaledTo(Bt.overscaledZ-1)).key]){G[ze.key]=ze;break}}}},S.prototype.findLoadedParent=function(x,C){if(x.key in this._loadedParentTiles){var k=this._loadedParentTiles[x.key];return k&&k.tileID.overscaledZ>=C?k:null}for(var G=x.overscaledZ-1;G>=C;G--){var q=x.scaledTo(G),de=this._getLoadedTile(q);if(de)return de}},S.prototype._getLoadedTile=function(x){var C=this._tiles[x.key];return C&&C.hasData()?C:this._cache.getByKey(x.wrapped().key)},S.prototype.updateCacheSize=function(x){var C=Math.ceil(x.width/this._source.tileSize)+1,k=Math.ceil(x.height/this._source.tileSize)+1,G=Math.floor(C*k*5),q=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,G):G;this._cache.setMaxSize(q)},S.prototype.handleWrapJump=function(x){var C=Math.round((x-(this._prevLng===void 0?x:this._prevLng))/360);if(this._prevLng=x,C){var k={};for(var G in this._tiles){var q=this._tiles[G];q.tileID=q.tileID.unwrapTo(q.tileID.wrap+C),k[q.tileID.key]=q}for(var de in this._tiles=k,this._timers)clearTimeout(this._timers[de]),delete this._timers[de];for(var ze in this._tiles)this._setTileReloadTimer(ze,this._tiles[ze])}},S.prototype.update=function(x){var C=this;if(this.transform=x,this._sourceLoaded&&!this._paused){var k;this.updateCacheSize(x),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?k=x.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Fr){return new E.OverscaledTileID(Fr.canonical.z,Fr.wrap,Fr.canonical.z,Fr.canonical.x,Fr.canonical.y)}):(k=x.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(k=k.filter(function(Fr){return C._source.hasTile(Fr)}))):k=[];var G=x.coveringZoomLevel(this._source),q=Math.max(G-S.maxOverzooming,this._source.minzoom),de=Math.max(G+S.maxUnderzooming,this._source.minzoom),ze=this._updateRetainedTiles(k,G);if(Er(this._source.type)){for(var it={},Bt={},St=0,Xt=Object.keys(ze);St<Xt.length;St+=1){var En=Xt[St],yn=ze[En],Un=this._tiles[En];if(Un&&!(Un.fadeEndTime&&Un.fadeEndTime<=E.browser.now())){var cn=this.findLoadedParent(yn,q);cn&&(this._addTile(cn.tileID),it[cn.tileID.key]=cn.tileID),Bt[En]=yn}}for(var Rn in this._retainLoadedChildren(Bt,G,de,ze),it)ze[Rn]||(this._coveredTiles[Rn]=!0,ze[Rn]=it[Rn])}for(var Jn in ze)this._tiles[Jn].clearFadeHold();for(var hr=0,Lr=E.keysDifference(this._tiles,ze);hr<Lr.length;hr+=1){var gr=Lr[hr],Dr=this._tiles[gr];Dr.hasSymbolBuckets&&!Dr.holdingForFade()?Dr.setHoldDuration(this.map._fadeDuration):Dr.hasSymbolBuckets&&!Dr.symbolFadeFinished()||this._removeTile(gr)}this._updateLoadedParentTileCache()}},S.prototype.releaseSymbolFadeTiles=function(){for(var x in this._tiles)this._tiles[x].holdingForFade()&&this._removeTile(x)},S.prototype._updateRetainedTiles=function(x,C){for(var k={},G={},q=Math.max(C-S.maxOverzooming,this._source.minzoom),de=Math.max(C+S.maxUnderzooming,this._source.minzoom),ze={},it=0,Bt=x;it<Bt.length;it+=1){var St=Bt[it],Xt=this._addTile(St);k[St.key]=St,Xt.hasData()||C<this._source.maxzoom&&(ze[St.key]=St)}this._retainLoadedChildren(ze,C,de,k);for(var En=0,yn=x;En<yn.length;En+=1){var Un=yn[En],cn=this._tiles[Un.key];if(!cn.hasData()){if(C+1>this._source.maxzoom){var Rn=Un.children(this._source.maxzoom)[0],Jn=this.getTile(Rn);if(Jn&&Jn.hasData()){k[Rn.key]=Rn;continue}}else{var hr=Un.children(this._source.maxzoom);if(k[hr[0].key]&&k[hr[1].key]&&k[hr[2].key]&&k[hr[3].key])continue}for(var Lr=cn.wasRequested(),gr=Un.overscaledZ-1;gr>=q;--gr){var Dr=Un.scaledTo(gr);if(G[Dr.key]||(G[Dr.key]=!0,!(cn=this.getTile(Dr))&&Lr&&(cn=this._addTile(Dr)),cn&&(k[Dr.key]=Dr,Lr=cn.wasRequested(),cn.hasData())))break}}}return k},S.prototype._updateLoadedParentTileCache=function(){for(var x in this._loadedParentTiles={},this._tiles){for(var C=[],k=void 0,G=this._tiles[x].tileID;G.overscaledZ>0;){if(G.key in this._loadedParentTiles){k=this._loadedParentTiles[G.key];break}C.push(G.key);var q=G.scaledTo(G.overscaledZ-1);if(k=this._getLoadedTile(q))break;G=q}for(var de=0,ze=C;de<ze.length;de+=1)this._loadedParentTiles[ze[de]]=k}},S.prototype._addTile=function(x){var C=this._tiles[x.key];if(C)return C;(C=this._cache.getAndRemove(x))&&(this._setTileReloadTimer(x.key,C),C.tileID=x,this._state.initializeTileState(C,this.map?this.map.painter:null),this._cacheTimers[x.key]&&(clearTimeout(this._cacheTimers[x.key]),delete this._cacheTimers[x.key],this._setTileReloadTimer(x.key,C)));var k=!!C;return k||(C=new E.Tile(x,this._source.tileSize*x.overscaleFactor()),this._loadTile(C,this._tileLoaded.bind(this,C,x.key,C.state))),C?(C.uses++,this._tiles[x.key]=C,k||this._source.fire(new E.Event("dataloading",{tile:C,coord:C.tileID,dataType:"source"})),C):null},S.prototype._setTileReloadTimer=function(x,C){var k=this;x in this._timers&&(clearTimeout(this._timers[x]),delete this._timers[x]);var G=C.getExpiryTimeout();G&&(this._timers[x]=setTimeout(function(){k._reloadTile(x,"expired"),delete k._timers[x]},G))},S.prototype._removeTile=function(x){var C=this._tiles[x];C&&(C.uses--,delete this._tiles[x],this._timers[x]&&(clearTimeout(this._timers[x]),delete this._timers[x]),C.uses>0||(C.hasData()&&C.state!=="reloading"?this._cache.add(C.tileID,C,C.getExpiryTimeout()):(C.aborted=!0,this._abortTile(C),this._unloadTile(C))))},S.prototype.clearTiles=function(){for(var x in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(x);this._cache.reset()},S.prototype.tilesIn=function(x,C,k){var G=this,q=[],de=this.transform;if(!de)return q;for(var ze=k?de.getCameraQueryGeometry(x):x,it=x.map(function(gr){return de.pointCoordinate(gr)}),Bt=ze.map(function(gr){return de.pointCoordinate(gr)}),St=this.getIds(),Xt=1/0,En=1/0,yn=-1/0,Un=-1/0,cn=0,Rn=Bt;cn<Rn.length;cn+=1){var Jn=Rn[cn];Xt=Math.min(Xt,Jn.x),En=Math.min(En,Jn.y),yn=Math.max(yn,Jn.x),Un=Math.max(Un,Jn.y)}for(var hr=function(gr){var Dr=G._tiles[St[gr]];if(!Dr.holdingForFade()){var Fr=Dr.tileID,Mi=Math.pow(2,de.zoom-Dr.tileID.overscaledZ),Pi=C*Dr.queryPadding*E.EXTENT/Dr.tileSize/Mi,vi=[Fr.getTilePoint(new E.MercatorCoordinate(Xt,En)),Fr.getTilePoint(new E.MercatorCoordinate(yn,Un))];if(vi[0].x-Pi<E.EXTENT&&vi[0].y-Pi<E.EXTENT&&vi[1].x+Pi>=0&&vi[1].y+Pi>=0){var Oo=it.map(function(Ho){return Fr.getTilePoint(Ho)}),yo=Bt.map(function(Ho){return Fr.getTilePoint(Ho)});q.push({tile:Dr,tileID:Fr,queryGeometry:Oo,cameraQueryGeometry:yo,scale:Mi})}}},Lr=0;Lr<St.length;Lr++)hr(Lr);return q},S.prototype.getVisibleCoordinates=function(x){for(var C=this,k=this.getRenderableIds(x).map(function(ze){return C._tiles[ze].tileID}),G=0,q=k;G<q.length;G+=1){var de=q[G];de.posMatrix=this.transform.calculatePosMatrix(de.toUnwrapped())}return k},S.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Er(this._source.type))for(var x in this._tiles){var C=this._tiles[x];if(C.fadeEndTime!==void 0&&C.fadeEndTime>=E.browser.now())return!0}return!1},S.prototype.setFeatureState=function(x,C,k){this._state.updateState(x=x||"_geojsonTileLayer",C,k)},S.prototype.removeFeatureState=function(x,C,k){this._state.removeFeatureState(x=x||"_geojsonTileLayer",C,k)},S.prototype.getFeatureState=function(x,C){return this._state.getState(x=x||"_geojsonTileLayer",C)},S.prototype.setDependencies=function(x,C,k){var G=this._tiles[x];G&&G.setDependencies(C,k)},S.prototype.reloadTilesForDependencies=function(x,C){for(var k in this._tiles)this._tiles[k].hasDependency(x,C)&&this._reloadTile(k,"reloading");this._cache.filter(function(G){return!G.hasDependency(x,C)})},S}(E.Evented);function Qn(_,S){var x=Math.abs(2*_.wrap)-+(_.wrap<0),C=Math.abs(2*S.wrap)-+(S.wrap<0);return _.overscaledZ-S.overscaledZ||C-x||S.canonical.y-_.canonical.y||S.canonical.x-_.canonical.x}function Er(_){return _==="raster"||_==="image"||_==="video"}function Vr(){return new E.window.Worker(j0.workerUrl)}Jt.maxOverzooming=10,Jt.maxUnderzooming=3;var mr="mapboxgl_preloaded_worker_pool",kr=function(){this.active={}};kr.prototype.acquire=function(_){if(!this.workers)for(this.workers=[];this.workers.length<kr.workerCount;)this.workers.push(new Vr);return this.active[_]=!0,this.workers.slice()},kr.prototype.release=function(_){delete this.active[_],this.numActive()===0&&(this.workers.forEach(function(S){S.terminate()}),this.workers=null)},kr.prototype.isPreloaded=function(){return!!this.active[mr]},kr.prototype.numActive=function(){return Object.keys(this.active).length};var Ei,Oi=Math.floor(E.browser.hardwareConcurrency/2);function ar(){return Ei||(Ei=new kr),Ei}function Kr(_,S){var x={};for(var C in _)C!=="ref"&&(x[C]=_[C]);return E.refProperties.forEach(function(k){k in S&&(x[k]=S[k])}),x}function hi(_){_=_.slice();for(var S=Object.create(null),x=0;x<_.length;x++)S[_[x].id]=_[x];for(var C=0;C<_.length;C++)"ref"in _[C]&&(_[C]=Kr(_[C],S[_[C].ref]));return _}kr.workerCount=Math.max(Math.min(Oi,6),1);var Qr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Io(_,S,x){x.push({command:Qr.addSource,args:[_,S[_]]})}function Ii(_,S,x){S.push({command:Qr.removeSource,args:[_]}),x[_]=!0}function Fo(_,S,x,C){Ii(_,x,C),Io(_,S,x)}function _a(_,S,x){var C;for(C in _[x])if(_[x].hasOwnProperty(C)&&C!=="data"&&!E.deepEqual(_[x][C],S[x][C]))return!1;for(C in S[x])if(S[x].hasOwnProperty(C)&&C!=="data"&&!E.deepEqual(_[x][C],S[x][C]))return!1;return!0}function Co(_,S,x,C,k,G){var q;for(q in S=S||{},_=_||{})_.hasOwnProperty(q)&&(E.deepEqual(_[q],S[q])||x.push({command:G,args:[C,q,S[q],k]}));for(q in S)S.hasOwnProperty(q)&&!_.hasOwnProperty(q)&&(E.deepEqual(_[q],S[q])||x.push({command:G,args:[C,q,S[q],k]}))}function Qo(_){return _.id}function De(_,S){return _[S.id]=S,_}var Je=function(_,S){this.reset(_,S)};Je.prototype.reset=function(_,S){this.points=_||[],this._distances=[0];for(var x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(S||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Je.prototype.lerp=function(_){if(this.points.length===1)return this.points[0];_=E.clamp(_,0,1);for(var S=1,x=this._distances[S],C=_*this.paddedLength+this.padding;x<C&&S<this._distances.length;)x=this._distances[++S];var k=S-1,G=this._distances[k],q=x-G,de=q>0?(C-G)/q:0;return this.points[k].mult(1-de).add(this.points[S].mult(de))};var kt=function(_,S,x){var C=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(_/x),this.yCellCount=Math.ceil(S/x);for(var G=0;G<this.xCellCount*this.yCellCount;G++)C.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=_,this.height=S,this.xScale=this.xCellCount/_,this.yScale=this.yCellCount/S,this.boxUid=0,this.circleUid=0};function un(_,S,x,C,k){var G=E.create();return S?(E.scale(G,G,[1/k,1/k,1]),x||E.rotateZ(G,G,C.angle)):E.multiply(G,C.labelPlaneMatrix,_),G}function Bn(_,S,x,C,k){if(S){var G=E.clone(_);return E.scale(G,G,[k,k,1]),x||E.rotateZ(G,G,-C.angle),G}return C.glCoordMatrix}function kn(_,S){var x=[_.x,_.y,0,1];Gr(x,x,S);var C=x[3];return{point:new E.Point(x[0]/C,x[1]/C),signedDistanceFromCamera:C}}function pn(_,S){return .5+_/S*.5}function On(_,S){var x=_[0]/_[3],C=_[1]/_[3];return x>=-S[0]&&x<=S[0]&&C>=-S[1]&&C<=S[1]}function vr(_,S,x,C,k,G,q,de){var ze=C?_.textSizeData:_.iconSizeData,it=E.evaluateSizeForZoom(ze,x.transform.zoom),Bt=[256/x.width*2+1,256/x.height*2+1],St=C?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;St.clear();for(var Xt=_.lineVertexArray,En=C?_.text.placedSymbolArray:_.icon.placedSymbolArray,yn=x.transform.width/x.transform.height,Un=!1,cn=0;cn<En.length;cn++){var Rn=En.get(cn);if(Rn.hidden||Rn.writingMode===E.WritingMode.vertical&&!Un)Di(Rn.numGlyphs,St);else{Un=!1;var Jn=[Rn.anchorX,Rn.anchorY,0,1];if(E.transformMat4(Jn,Jn,S),On(Jn,Bt)){var hr=pn(x.transform.cameraToCenterDistance,Jn[3]),Lr=E.evaluateSizeForFeature(ze,it,Rn),gr=q?Lr/hr:Lr*hr,Dr=new E.Point(Rn.anchorX,Rn.anchorY),Fr=kn(Dr,k).point,Mi={},Pi=Gi(Rn,gr,!1,de,S,k,G,_.glyphOffsetArray,Xt,St,Fr,Dr,Mi,yn);Un=Pi.useVertical,(Pi.notEnoughRoom||Un||Pi.needsFlipping&&Gi(Rn,gr,!0,de,S,k,G,_.glyphOffsetArray,Xt,St,Fr,Dr,Mi,yn).notEnoughRoom)&&Di(Rn.numGlyphs,St)}else Di(Rn.numGlyphs,St)}}C?_.text.dynamicLayoutVertexBuffer.updateData(St):_.icon.dynamicLayoutVertexBuffer.updateData(St)}function fr(_,S,x,C,k,G,q,de,ze,it,Bt){var St=de.glyphStartIndex+de.numGlyphs,Xt=de.lineStartIndex,En=de.lineStartIndex+de.lineLength,yn=S.getoffsetX(de.glyphStartIndex),Un=S.getoffsetX(St-1),cn=Jr(_*yn,x,C,k,G,q,de.segment,Xt,En,ze,it,Bt);if(!cn)return null;var Rn=Jr(_*Un,x,C,k,G,q,de.segment,Xt,En,ze,it,Bt);return Rn?{first:cn,last:Rn}:null}function ci(_,S,x,C){return _===E.WritingMode.horizontal&&Math.abs(x.y-S.y)>Math.abs(x.x-S.x)*C?{useVertical:!0}:(_===E.WritingMode.vertical?S.y<x.y:S.x>x.x)?{needsFlipping:!0}:null}function Gi(_,S,x,C,k,G,q,de,ze,it,Bt,St,Xt,En){var yn,Un=S/24,cn=_.lineOffsetX*Un,Rn=_.lineOffsetY*Un;if(_.numGlyphs>1){var Jn=_.glyphStartIndex+_.numGlyphs,hr=_.lineStartIndex,Lr=_.lineStartIndex+_.lineLength,gr=fr(Un,de,cn,Rn,x,Bt,St,_,ze,G,Xt);if(!gr)return{notEnoughRoom:!0};var Dr=kn(gr.first.point,q).point,Fr=kn(gr.last.point,q).point;if(C&&!x){var Mi=ci(_.writingMode,Dr,Fr,En);if(Mi)return Mi}yn=[gr.first];for(var Pi=_.glyphStartIndex+1;Pi<Jn-1;Pi++)yn.push(Jr(Un*de.getoffsetX(Pi),cn,Rn,x,Bt,St,_.segment,hr,Lr,ze,G,Xt));yn.push(gr.last)}else{if(C&&!x){var vi=kn(St,k).point,Oo=_.lineStartIndex+_.segment+1,yo=new E.Point(ze.getx(Oo),ze.gety(Oo)),Ho=kn(yo,k),is=Ho.signedDistanceFromCamera>0?Ho.point:no(St,yo,vi,1,k),Cr=ci(_.writingMode,vi,is,En);if(Cr)return Cr}var Kt=Jr(Un*de.getoffsetX(_.glyphStartIndex),cn,Rn,x,Bt,St,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,ze,G,Xt);if(!Kt)return{notEnoughRoom:!0};yn=[Kt]}for(var Zr=0,ko=yn;Zr<ko.length;Zr+=1){var qo=ko[Zr];E.addDynamicAttributes(it,qo.point,qo.angle)}return{}}function no(_,S,x,C,k){var G=kn(_.add(_.sub(S)._unit()),k).point,q=x.sub(G);return x.add(q._mult(C/q.mag()))}function Jr(_,S,x,C,k,G,q,de,ze,it,Bt,St){var Xt=C?_-S:_+S,En=Xt>0?1:-1,yn=0;C&&(En*=-1,yn=Math.PI),En<0&&(yn+=Math.PI);for(var Un=En>0?de+q:de+q+1,cn=k,Rn=k,Jn=0,hr=0,Lr=Math.abs(Xt),gr=[];Jn+hr<=Lr;){if((Un+=En)<de||Un>=ze)return null;if(Rn=cn,gr.push(cn),(cn=St[Un])===void 0){var Dr=new E.Point(it.getx(Un),it.gety(Un)),Fr=kn(Dr,Bt);if(Fr.signedDistanceFromCamera>0)cn=St[Un]=Fr.point;else{var Mi=Un-En;cn=no(Jn===0?G:new E.Point(it.getx(Mi),it.gety(Mi)),Dr,Rn,Lr-Jn+1,Bt)}}Jn+=hr,hr=Rn.dist(cn)}var Pi=(Lr-Jn)/hr,vi=cn.sub(Rn),Oo=vi.mult(Pi)._add(Rn);Oo._add(vi._unit()._perp()._mult(x*En));var yo=yn+Math.atan2(cn.y-Rn.y,cn.x-Rn.x);return gr.push(Oo),{point:Oo,angle:yo,path:gr}}kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},kt.prototype.insert=function(_,S,x,C,k){this._forEachCell(S,x,C,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(_),this.bboxes.push(S),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(k)},kt.prototype.insertCircle=function(_,S,x,C){this._forEachCell(S-C,x-C,S+C,x+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(_),this.circles.push(S),this.circles.push(x),this.circles.push(C)},kt.prototype._insertBoxCell=function(_,S,x,C,k,G){this.boxCells[k].push(G)},kt.prototype._insertCircleCell=function(_,S,x,C,k,G){this.circleCells[k].push(G)},kt.prototype._query=function(_,S,x,C,k,G){if(x<0||_>this.width||C<0||S>this.height)return!k&&[];var q=[];if(_<=0&&S<=0&&this.width<=x&&this.height<=C){if(k)return!0;for(var de=0;de<this.boxKeys.length;de++)q.push({key:this.boxKeys[de],x1:this.bboxes[4*de],y1:this.bboxes[4*de+1],x2:this.bboxes[4*de+2],y2:this.bboxes[4*de+3]});for(var ze=0;ze<this.circleKeys.length;ze++){var it=this.circles[3*ze],Bt=this.circles[3*ze+1],St=this.circles[3*ze+2];q.push({key:this.circleKeys[ze],x1:it-St,y1:Bt-St,x2:it+St,y2:Bt+St})}return G?q.filter(G):q}return this._forEachCell(_,S,x,C,this._queryCell,q,{hitTest:k,seenUids:{box:{},circle:{}}},G),k?q.length>0:q},kt.prototype._queryCircle=function(_,S,x,C,k){var G=_-x,q=_+x,de=S-x,ze=S+x;if(q<0||G>this.width||ze<0||de>this.height)return!C&&[];var it=[];return this._forEachCell(G,de,q,ze,this._queryCellCircle,it,{hitTest:C,circle:{x:_,y:S,radius:x},seenUids:{box:{},circle:{}}},k),C?it.length>0:it},kt.prototype.query=function(_,S,x,C,k){return this._query(_,S,x,C,!1,k)},kt.prototype.hitTest=function(_,S,x,C,k){return this._query(_,S,x,C,!0,k)},kt.prototype.hitTestCircle=function(_,S,x,C){return this._queryCircle(_,S,x,!0,C)},kt.prototype._queryCell=function(_,S,x,C,k,G,q,de){var ze=q.seenUids,it=this.boxCells[k];if(it!==null)for(var Bt=this.bboxes,St=0,Xt=it;St<Xt.length;St+=1){var En=Xt[St];if(!ze.box[En]){ze.box[En]=!0;var yn=4*En;if(_<=Bt[yn+2]&&S<=Bt[yn+3]&&x>=Bt[yn+0]&&C>=Bt[yn+1]&&(!de||de(this.boxKeys[En]))){if(q.hitTest)return G.push(!0),!0;G.push({key:this.boxKeys[En],x1:Bt[yn],y1:Bt[yn+1],x2:Bt[yn+2],y2:Bt[yn+3]})}}}var Un=this.circleCells[k];if(Un!==null)for(var cn=this.circles,Rn=0,Jn=Un;Rn<Jn.length;Rn+=1){var hr=Jn[Rn];if(!ze.circle[hr]){ze.circle[hr]=!0;var Lr=3*hr;if(this._circleAndRectCollide(cn[Lr],cn[Lr+1],cn[Lr+2],_,S,x,C)&&(!de||de(this.circleKeys[hr]))){if(q.hitTest)return G.push(!0),!0;var gr=cn[Lr],Dr=cn[Lr+1],Fr=cn[Lr+2];G.push({key:this.circleKeys[hr],x1:gr-Fr,y1:Dr-Fr,x2:gr+Fr,y2:Dr+Fr})}}}},kt.prototype._queryCellCircle=function(_,S,x,C,k,G,q,de){var ze=q.circle,it=q.seenUids,Bt=this.boxCells[k];if(Bt!==null)for(var St=this.bboxes,Xt=0,En=Bt;Xt<En.length;Xt+=1){var yn=En[Xt];if(!it.box[yn]){it.box[yn]=!0;var Un=4*yn;if(this._circleAndRectCollide(ze.x,ze.y,ze.radius,St[Un+0],St[Un+1],St[Un+2],St[Un+3])&&(!de||de(this.boxKeys[yn])))return G.push(!0),!0}}var cn=this.circleCells[k];if(cn!==null)for(var Rn=this.circles,Jn=0,hr=cn;Jn<hr.length;Jn+=1){var Lr=hr[Jn];if(!it.circle[Lr]){it.circle[Lr]=!0;var gr=3*Lr;if(this._circlesCollide(Rn[gr],Rn[gr+1],Rn[gr+2],ze.x,ze.y,ze.radius)&&(!de||de(this.circleKeys[Lr])))return G.push(!0),!0}}},kt.prototype._forEachCell=function(_,S,x,C,k,G,q,de){for(var ze=this._convertToXCellCoord(_),it=this._convertToYCellCoord(S),Bt=this._convertToXCellCoord(x),St=this._convertToYCellCoord(C),Xt=ze;Xt<=Bt;Xt++)for(var En=it;En<=St;En++)if(k.call(this,_,S,x,C,this.xCellCount*En+Xt,G,q,de))return},kt.prototype._convertToXCellCoord=function(_){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(_*this.xScale)))},kt.prototype._convertToYCellCoord=function(_){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(_*this.yScale)))},kt.prototype._circlesCollide=function(_,S,x,C,k,G){var q=C-_,de=k-S,ze=x+G;return ze*ze>q*q+de*de},kt.prototype._circleAndRectCollide=function(_,S,x,C,k,G,q){var de=(G-C)/2,ze=Math.abs(_-(C+de));if(ze>de+x)return!1;var it=(q-k)/2,Bt=Math.abs(S-(k+it));if(Bt>it+x)return!1;if(ze<=de||Bt<=it)return!0;var St=ze-de,Xt=Bt-it;return St*St+Xt*Xt<=x*x};var ji=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Di(_,S){for(var x=0;x<_;x++){var C=S.length;S.resize(C+4),S.float32.set(ji,3*C)}}function Gr(_,S,x){var C=S[0],k=S[1];return _[0]=x[0]*C+x[4]*k+x[12],_[1]=x[1]*C+x[5]*k+x[13],_[3]=x[3]*C+x[7]*k+x[15],_}var fo=function(_,S,x){S===void 0&&(S=new kt(_.width+200,_.height+200,25)),x===void 0&&(x=new kt(_.width+200,_.height+200,25)),this.transform=_,this.grid=S,this.ignoredGrid=x,this.pitchfactor=Math.cos(_._pitch)*_.cameraToCenterDistance,this.screenRightBoundary=_.width+100,this.screenBottomBoundary=_.height+100,this.gridRightBoundary=_.width+200,this.gridBottomBoundary=_.height+200};function Ri(_,S,x){return S*(E.EXTENT/(_.tileSize*Math.pow(2,x-_.tileID.overscaledZ)))}fo.prototype.placeCollisionBox=function(_,S,x,C,k){var G=this.projectAndGetPerspectiveRatio(C,_.anchorPointX,_.anchorPointY),q=x*G.perspectiveRatio,de=_.x1*q+G.point.x,ze=_.y1*q+G.point.y,it=_.x2*q+G.point.x,Bt=_.y2*q+G.point.y;return!this.isInsideGrid(de,ze,it,Bt)||!S&&this.grid.hitTest(de,ze,it,Bt,k)?{box:[],offscreen:!1}:{box:[de,ze,it,Bt],offscreen:this.isOffscreen(de,ze,it,Bt)}},fo.prototype.placeCollisionCircles=function(_,S,x,C,k,G,q,de,ze,it,Bt,St,Xt){var En=[],yn=new E.Point(S.anchorX,S.anchorY),Un=kn(yn,G),cn=pn(this.transform.cameraToCenterDistance,Un.signedDistanceFromCamera),Rn=(it?k/cn:k*cn)/E.ONE_EM,Jn=kn(yn,q).point,hr=fr(Rn,C,S.lineOffsetX*Rn,S.lineOffsetY*Rn,!1,Jn,yn,S,x,q,{}),Lr=!1,gr=!1,Dr=!0;if(hr){for(var Fr=.5*St*cn+Xt,Mi=new E.Point(-100,-100),Pi=new E.Point(this.screenRightBoundary,this.screenBottomBoundary),vi=new Je,Oo=hr.first,yo=hr.last,Ho=[],is=Oo.path.length-1;is>=1;is--)Ho.push(Oo.path[is]);for(var Cr=1;Cr<yo.path.length;Cr++)Ho.push(yo.path[Cr]);var Kt=2.5*Fr;if(de){var Zr=Ho.map(function(pl){return kn(pl,de)});Ho=Zr.some(function(pl){return pl.signedDistanceFromCamera<=0})?[]:Zr.map(function(pl){return pl.point})}var ko=[];if(Ho.length>0){for(var qo=Ho[0].clone(),va=Ho[0].clone(),na=1;na<Ho.length;na++)qo.x=Math.min(qo.x,Ho[na].x),qo.y=Math.min(qo.y,Ho[na].y),va.x=Math.max(va.x,Ho[na].x),va.y=Math.max(va.y,Ho[na].y);ko=qo.x>=Mi.x&&va.x<=Pi.x&&qo.y>=Mi.y&&va.y<=Pi.y?[Ho]:va.x<Mi.x||qo.x>Pi.x||va.y<Mi.y||qo.y>Pi.y?[]:E.clipLine([Ho],Mi.x,Mi.y,Pi.x,Pi.y)}for(var Vo=0,sl=ko;Vo<sl.length;Vo+=1){var bl;vi.reset(sl[Vo],.25*Fr),bl=vi.length<=.5*Fr?1:Math.ceil(vi.paddedLength/Kt)+1;for(var zc=0;zc<bl;zc++){var ic=zc/Math.max(bl-1,1),Rs=vi.lerp(ic),ll=Rs.x+100,Qs=Rs.y+100;En.push(ll,Qs,Fr,0);var Tc=ll-Fr,Ch=Qs-Fr,Il=ll+Fr,cu=Qs+Fr;if(Dr=Dr&&this.isOffscreen(Tc,Ch,Il,cu),gr=gr||this.isInsideGrid(Tc,Ch,Il,cu),!_&&this.grid.hitTestCircle(ll,Qs,Fr,Bt)&&(Lr=!0,!ze))return{circles:[],offscreen:!1,collisionDetected:Lr}}}}return{circles:!ze&&Lr||!gr?[]:En,offscreen:Dr,collisionDetected:Lr}},fo.prototype.queryRenderedSymbols=function(_){if(_.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var S=[],x=1/0,C=1/0,k=-1/0,G=-1/0,q=0,de=_;q<de.length;q+=1){var ze=de[q],it=new E.Point(ze.x+100,ze.y+100);x=Math.min(x,it.x),C=Math.min(C,it.y),k=Math.max(k,it.x),G=Math.max(G,it.y),S.push(it)}for(var Bt={},St={},Xt=0,En=this.grid.query(x,C,k,G).concat(this.ignoredGrid.query(x,C,k,G));Xt<En.length;Xt+=1){var yn=En[Xt],Un=yn.key;if(Bt[Un.bucketInstanceId]===void 0&&(Bt[Un.bucketInstanceId]={}),!Bt[Un.bucketInstanceId][Un.featureIndex]){var cn=[new E.Point(yn.x1,yn.y1),new E.Point(yn.x2,yn.y1),new E.Point(yn.x2,yn.y2),new E.Point(yn.x1,yn.y2)];E.polygonIntersectsPolygon(S,cn)&&(Bt[Un.bucketInstanceId][Un.featureIndex]=!0,St[Un.bucketInstanceId]===void 0&&(St[Un.bucketInstanceId]=[]),St[Un.bucketInstanceId].push(Un.featureIndex))}}return St},fo.prototype.insertCollisionBox=function(_,S,x,C,k){(S?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:C,collisionGroupID:k},_[0],_[1],_[2],_[3])},fo.prototype.insertCollisionCircles=function(_,S,x,C,k){for(var G=S?this.ignoredGrid:this.grid,q={bucketInstanceId:x,featureIndex:C,collisionGroupID:k},de=0;de<_.length;de+=4)G.insertCircle(q,_[de],_[de+1],_[de+2])},fo.prototype.projectAndGetPerspectiveRatio=function(_,S,x){var C=[S,x,0,1];return Gr(C,C,_),{point:new E.Point((C[0]/C[3]+1)/2*this.transform.width+100,(-C[1]/C[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/C[3]*.5}},fo.prototype.isOffscreen=function(_,S,x,C){return x<100||_>=this.screenRightBoundary||C<100||S>this.screenBottomBoundary},fo.prototype.isInsideGrid=function(_,S,x,C){return x>=0&&_<this.gridRightBoundary&&C>=0&&S<this.gridBottomBoundary},fo.prototype.getViewportMatrix=function(){var _=E.identity([]);return E.translate(_,_,[-100,-100,0]),_};var bo=function(_,S,x,C){this.opacity=_?Math.max(0,Math.min(1,_.opacity+(_.placed?S:-S))):C&&x?1:0,this.placed=x};bo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var xi=function(_,S,x,C,k){this.text=new bo(_?_.text:null,S,x,k),this.icon=new bo(_?_.icon:null,S,C,k)};xi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var wo=function(_,S,x){this.text=_,this.icon=S,this.skipFade=x},ia=function(){this.invProjMatrix=E.create(),this.viewportMatrix=E.create(),this.circles=[]},Ga=function(_,S,x,C,k){this.bucketInstanceId=_,this.featureIndex=S,this.sourceLayerIndex=x,this.bucketIndex=C,this.tileID=k},Jo=function(_){this.crossSourceCollisions=_,this.maxGroupID=0,this.collisionGroups={}};function Wo(_,S,x,C,k){var G=E.getAnchorAlignment(_),q=-(G.horizontalAlign-.5)*S,de=-(G.verticalAlign-.5)*x,ze=E.evaluateVariableOffset(_,C);return new E.Point(q+ze[0]*k,de+ze[1]*k)}function Ha(_,S,x,C,k,G){var q=_.x1,de=_.x2,ze=_.y1,it=_.y2,Bt=_.anchorPointX,St=_.anchorPointY,Xt=new E.Point(S,x);return C&&Xt._rotate(k?G:-G),{x1:q+Xt.x,y1:ze+Xt.y,x2:de+Xt.x,y2:it+Xt.y,anchorPointX:Bt,anchorPointY:St}}Jo.prototype.get=function(_){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[_]){var S=++this.maxGroupID;this.collisionGroups[_]={ID:S,predicate:function(x){return x.collisionGroupID===S}}}return this.collisionGroups[_]};var ds=function(_,S,x,C){this.transform=_.clone(),this.collisionIndex=new fo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=S,this.retainedQueryData={},this.collisionGroups=new Jo(x),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}};function Tt(_,S,x,C,k){_.emplaceBack(S?1:0,x?1:0,C||0,k||0),_.emplaceBack(S?1:0,x?1:0,C||0,k||0),_.emplaceBack(S?1:0,x?1:0,C||0,k||0),_.emplaceBack(S?1:0,x?1:0,C||0,k||0)}ds.prototype.getBucketParts=function(_,S,x,C){var k=x.getBucket(S),G=x.latestFeatureIndex;if(k&&G&&S.id===k.layerIds[0]){var q=x.collisionBoxArray,de=k.layers[0].layout,ze=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),it=x.tileSize/E.EXTENT,Bt=this.transform.calculatePosMatrix(x.tileID.toUnwrapped()),St=de.get("text-pitch-alignment")==="map",Xt=de.get("text-rotation-alignment")==="map",En=Ri(x,1,this.transform.zoom),yn=un(Bt,St,Xt,this.transform,En),Un=null;if(St){var cn=Bn(Bt,St,Xt,this.transform,En);Un=E.multiply([],this.transform.labelPlaneMatrix,cn)}this.retainedQueryData[k.bucketInstanceId]=new Ga(k.bucketInstanceId,G,k.sourceLayerIndex,k.index,x.tileID);var Rn={bucket:k,layout:de,posMatrix:Bt,textLabelPlaneMatrix:yn,labelToScreenMatrix:Un,scale:ze,textPixelRatio:it,holdingForFade:x.holdingForFade(),collisionBoxArray:q,partiallyEvaluatedTextSize:E.evaluateSizeForZoom(k.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(C)for(var Jn=0,hr=k.sortKeyRanges;Jn<hr.length;Jn+=1){var Lr=hr[Jn];_.push({sortKey:Lr.sortKey,symbolInstanceStart:Lr.symbolInstanceStart,symbolInstanceEnd:Lr.symbolInstanceEnd,parameters:Rn})}else _.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:Rn})}},ds.prototype.attemptAnchorPlacement=function(_,S,x,C,k,G,q,de,ze,it,Bt,St,Xt,En,yn){var Un,cn=[St.textOffset0,St.textOffset1],Rn=Wo(_,x,C,cn,k),Jn=this.collisionIndex.placeCollisionBox(Ha(S,Rn.x,Rn.y,G,q,this.transform.angle),Bt,de,ze,it.predicate);if(!yn||this.collisionIndex.placeCollisionBox(Ha(yn,Rn.x,Rn.y,G,q,this.transform.angle),Bt,de,ze,it.predicate).box.length!==0)return Jn.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[St.crossTileID]&&this.prevPlacement.placements[St.crossTileID]&&this.prevPlacement.placements[St.crossTileID].text&&(Un=this.prevPlacement.variableOffsets[St.crossTileID].anchor),this.variableOffsets[St.crossTileID]={textOffset:cn,width:x,height:C,anchor:_,textBoxScale:k,prevAnchor:Un},this.markUsedJustification(Xt,_,St,En),Xt.allowVerticalPlacement&&(this.markUsedOrientation(Xt,En,St),this.placedOrientations[St.crossTileID]=En),{shift:Rn,placedGlyphBoxes:Jn}):void 0},ds.prototype.placeLayerBucketPart=function(_,S,x){var C=this,k=_.parameters,G=k.bucket,q=k.layout,de=k.posMatrix,ze=k.textLabelPlaneMatrix,it=k.labelToScreenMatrix,Bt=k.textPixelRatio,St=k.holdingForFade,Xt=k.collisionBoxArray,En=k.partiallyEvaluatedTextSize,yn=k.collisionGroup,Un=q.get("text-optional"),cn=q.get("icon-optional"),Rn=q.get("text-allow-overlap"),Jn=q.get("icon-allow-overlap"),hr=q.get("text-rotation-alignment")==="map",Lr=q.get("text-pitch-alignment")==="map",gr=q.get("icon-text-fit")!=="none",Dr=q.get("symbol-z-order")==="viewport-y",Fr=Rn&&(Jn||!G.hasIconData()||cn),Mi=Jn&&(Rn||!G.hasTextData()||Un);!G.collisionArrays&&Xt&&G.deserializeCollisionBoxes(Xt);var Pi=function(Cr,Kt){if(!S[Cr.crossTileID])if(St)C.placements[Cr.crossTileID]=new wo(!1,!1,!1);else{var Zr,ko=!1,qo=!1,va=!0,na=null,Vo={box:null,offscreen:null},sl={box:null,offscreen:null},bl=null,zc=null,ic=0,Rs=0,ll=0;Kt.textFeatureIndex?ic=Kt.textFeatureIndex:Cr.useRuntimeCollisionCircles&&(ic=Cr.featureIndex),Kt.verticalTextFeatureIndex&&(Rs=Kt.verticalTextFeatureIndex);var Qs=Kt.textBox;if(Qs){var Tc=function(ga){var xl=E.WritingMode.horizontal;if(G.allowVerticalPlacement&&!ga&&C.prevPlacement){var Ba=C.prevPlacement.placedOrientations[Cr.crossTileID];Ba&&(C.placedOrientations[Cr.crossTileID]=Ba,C.markUsedOrientation(G,xl=Ba,Cr))}return xl},Ch=function(ga,xl){if(G.allowVerticalPlacement&&Cr.numVerticalGlyphVertices>0&&Kt.verticalTextBox)for(var Ba=0,ih=G.writingModes;Ba<ih.length&&(ih[Ba]===E.WritingMode.vertical?(Vo=xl(),sl=Vo):Vo=ga(),!(Vo&&Vo.box&&Vo.box.length));Ba+=1);else Vo=ga()};if(q.get("text-variable-anchor")){var Il=q.get("text-variable-anchor");if(C.prevPlacement&&C.prevPlacement.variableOffsets[Cr.crossTileID]){var cu=C.prevPlacement.variableOffsets[Cr.crossTileID];Il.indexOf(cu.anchor)>0&&(Il=Il.filter(function(ga){return ga!==cu.anchor})).unshift(cu.anchor)}var pl=function(ga,xl,Ba){for(var ih=ga.x2-ga.x1,a0=ga.y2-ga.y1,Tf=Cr.textBoxScale,Kd=gr&&!Jn?xl:null,oh={box:[],offscreen:!1},wd=Rn?2*Il.length:Il.length,Vf=0;Vf<wd;++Vf){var zs=C.attemptAnchorPlacement(Il[Vf%Il.length],ga,ih,a0,Tf,hr,Lr,Bt,de,yn,Vf>=Il.length,Cr,G,Ba,Kd);if(zs&&(oh=zs.placedGlyphBoxes)&&oh.box&&oh.box.length){ko=!0,na=zs.shift;break}}return oh};Ch(function(){return pl(Qs,Kt.iconBox,E.WritingMode.horizontal)},function(){var ga=Kt.verticalTextBox;return G.allowVerticalPlacement&&!(Vo&&Vo.box&&Vo.box.length)&&Cr.numVerticalGlyphVertices>0&&ga?pl(ga,Kt.verticalIconBox,E.WritingMode.vertical):{box:null,offscreen:null}}),Vo&&(ko=Vo.box,va=Vo.offscreen);var $d=Tc(Vo&&Vo.box);if(!ko&&C.prevPlacement){var Td=C.prevPlacement.variableOffsets[Cr.crossTileID];Td&&(C.variableOffsets[Cr.crossTileID]=Td,C.markUsedJustification(G,Td.anchor,Cr,$d))}}else{var Oh=function(ga,xl){var Ba=C.collisionIndex.placeCollisionBox(ga,Rn,Bt,de,yn.predicate);return Ba&&Ba.box&&Ba.box.length&&(C.markUsedOrientation(G,xl,Cr),C.placedOrientations[Cr.crossTileID]=xl),Ba};Ch(function(){return Oh(Qs,E.WritingMode.horizontal)},function(){var ga=Kt.verticalTextBox;return G.allowVerticalPlacement&&Cr.numVerticalGlyphVertices>0&&ga?Oh(ga,E.WritingMode.vertical):{box:null,offscreen:null}}),Tc(Vo&&Vo.box&&Vo.box.length)}}if(ko=(Zr=Vo)&&Zr.box&&Zr.box.length>0,va=Zr&&Zr.offscreen,Cr.useRuntimeCollisionCircles){var Sf=G.text.placedSymbolArray.get(Cr.centerJustifiedTextSymbolIndex),Qh=E.evaluateSizeForFeature(G.textSizeData,En,Sf),Rh=q.get("text-padding");bl=C.collisionIndex.placeCollisionCircles(Rn,Sf,G.lineVertexArray,G.glyphOffsetArray,Qh,de,ze,it,x,Lr,yn.predicate,Cr.collisionCircleDiameter,Rh),ko=Rn||bl.circles.length>0&&!bl.collisionDetected,va=va&&bl.offscreen}if(Kt.iconFeatureIndex&&(ll=Kt.iconFeatureIndex),Kt.iconBox){var Ti=function(ga){var xl=gr&&na?Ha(ga,na.x,na.y,hr,Lr,C.transform.angle):ga;return C.collisionIndex.placeCollisionBox(xl,Jn,Bt,de,yn.predicate)};qo=sl&&sl.box&&sl.box.length&&Kt.verticalIconBox?(zc=Ti(Kt.verticalIconBox)).box.length>0:(zc=Ti(Kt.iconBox)).box.length>0,va=va&&zc.offscreen}var ml=Un||Cr.numHorizontalGlyphVertices===0&&Cr.numVerticalGlyphVertices===0,Ll=cn||Cr.numIconVertices===0;if(ml||Ll?Ll?ml||(qo=qo&&ko):ko=qo&&ko:qo=ko=qo&&ko,ko&&Zr&&Zr.box&&C.collisionIndex.insertCollisionBox(Zr.box,q.get("text-ignore-placement"),G.bucketInstanceId,sl&&sl.box&&Rs?Rs:ic,yn.ID),qo&&zc&&C.collisionIndex.insertCollisionBox(zc.box,q.get("icon-ignore-placement"),G.bucketInstanceId,ll,yn.ID),bl&&(ko&&C.collisionIndex.insertCollisionCircles(bl.circles,q.get("text-ignore-placement"),G.bucketInstanceId,ic,yn.ID),x)){var Kc=G.bucketInstanceId,os=C.collisionCircleArrays[Kc];os===void 0&&(os=C.collisionCircleArrays[Kc]=new ia);for(var Ns=0;Ns<bl.circles.length;Ns+=4)os.circles.push(bl.circles[Ns+0]),os.circles.push(bl.circles[Ns+1]),os.circles.push(bl.circles[Ns+2]),os.circles.push(bl.collisionDetected?1:0)}C.placements[Cr.crossTileID]=new wo(ko||Fr,qo||Mi,va||G.justReloaded),S[Cr.crossTileID]=!0}};if(Dr)for(var vi=G.getSortedSymbolIndexes(this.transform.angle),Oo=vi.length-1;Oo>=0;--Oo){var yo=vi[Oo];Pi(G.symbolInstances.get(yo),G.collisionArrays[yo])}else for(var Ho=_.symbolInstanceStart;Ho<_.symbolInstanceEnd;Ho++)Pi(G.symbolInstances.get(Ho),G.collisionArrays[Ho]);if(x&&G.bucketInstanceId in this.collisionCircleArrays){var is=this.collisionCircleArrays[G.bucketInstanceId];E.invert(is.invProjMatrix,de),is.viewportMatrix=this.collisionIndex.getViewportMatrix()}G.justReloaded=!1},ds.prototype.markUsedJustification=function(_,S,x,C){var k;k=C===E.WritingMode.vertical?x.verticalPlacedTextSymbolIndex:{left:x.leftJustifiedTextSymbolIndex,center:x.centerJustifiedTextSymbolIndex,right:x.rightJustifiedTextSymbolIndex}[E.getAnchorJustification(S)];for(var G=0,q=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex,x.verticalPlacedTextSymbolIndex];G<q.length;G+=1){var de=q[G];de>=0&&(_.text.placedSymbolArray.get(de).crossTileID=k>=0&&de!==k?0:x.crossTileID)}},ds.prototype.markUsedOrientation=function(_,S,x){for(var C=S===E.WritingMode.horizontal||S===E.WritingMode.horizontalOnly?S:0,k=S===E.WritingMode.vertical?S:0,G=0,q=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex];G<q.length;G+=1)_.text.placedSymbolArray.get(q[G]).placedOrientation=C;x.verticalPlacedTextSymbolIndex&&(_.text.placedSymbolArray.get(x.verticalPlacedTextSymbolIndex).placedOrientation=k)},ds.prototype.commit=function(_){this.commitTime=_,this.zoomAtLastRecencyCheck=this.transform.zoom;var S=this.prevPlacement,x=!1;this.prevZoomAdjustment=S?S.zoomAdjustment(this.transform.zoom):0;var C=S?S.symbolFadeChange(_):1,k=S?S.opacities:{},G=S?S.variableOffsets:{},q=S?S.placedOrientations:{};for(var de in this.placements){var ze=this.placements[de],it=k[de];it?(this.opacities[de]=new xi(it,C,ze.text,ze.icon),x=x||ze.text!==it.text.placed||ze.icon!==it.icon.placed):(this.opacities[de]=new xi(null,C,ze.text,ze.icon,ze.skipFade),x=x||ze.text||ze.icon)}for(var Bt in k){var St=k[Bt];if(!this.opacities[Bt]){var Xt=new xi(St,C,!1,!1);Xt.isHidden()||(this.opacities[Bt]=Xt,x=x||St.text.placed||St.icon.placed)}}for(var En in G)this.variableOffsets[En]||!this.opacities[En]||this.opacities[En].isHidden()||(this.variableOffsets[En]=G[En]);for(var yn in q)this.placedOrientations[yn]||!this.opacities[yn]||this.opacities[yn].isHidden()||(this.placedOrientations[yn]=q[yn]);x?this.lastPlacementChangeTime=_:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=S?S.lastPlacementChangeTime:_)},ds.prototype.updateLayerOpacities=function(_,S){for(var x={},C=0,k=S;C<k.length;C+=1){var G=k[C],q=G.getBucket(_);q&&G.latestFeatureIndex&&_.id===q.layerIds[0]&&this.updateBucketOpacities(q,x,G.collisionBoxArray)}},ds.prototype.updateBucketOpacities=function(_,S,x){var C=this;_.hasTextData()&&_.text.opacityVertexArray.clear(),_.hasIconData()&&_.icon.opacityVertexArray.clear(),_.hasIconCollisionBoxData()&&_.iconCollisionBox.collisionVertexArray.clear(),_.hasTextCollisionBoxData()&&_.textCollisionBox.collisionVertexArray.clear();var k=_.layers[0].layout,G=new xi(null,0,!1,!1,!0),q=k.get("text-allow-overlap"),de=k.get("icon-allow-overlap"),ze=k.get("text-variable-anchor"),it=k.get("text-rotation-alignment")==="map",Bt=k.get("text-pitch-alignment")==="map",St=k.get("icon-text-fit")!=="none",Xt=new xi(null,0,q&&(de||!_.hasIconData()||k.get("icon-optional")),de&&(q||!_.hasTextData()||k.get("text-optional")),!0);!_.collisionArrays&&x&&(_.hasIconCollisionBoxData()||_.hasTextCollisionBoxData())&&_.deserializeCollisionBoxes(x);for(var En=function(Rn,Jn,hr){for(var Lr=0;Lr<Jn/4;Lr++)Rn.opacityVertexArray.emplaceBack(hr)},yn=function(Rn){var Jn=_.symbolInstances.get(Rn),hr=Jn.numHorizontalGlyphVertices,Lr=Jn.numVerticalGlyphVertices,gr=Jn.crossTileID,Dr=C.opacities[gr];S[gr]?Dr=G:Dr||(C.opacities[gr]=Dr=Xt),S[gr]=!0;var Fr=Jn.numIconVertices>0,Mi=C.placedOrientations[Jn.crossTileID],Pi=Mi===E.WritingMode.vertical,vi=Mi===E.WritingMode.horizontal||Mi===E.WritingMode.horizontalOnly;if(hr>0||Lr>0){var Oo=ya(Dr.text);En(_.text,hr,Pi?vs:Oo),En(_.text,Lr,vi?vs:Oo);var yo=Dr.text.isHidden();[Jn.rightJustifiedTextSymbolIndex,Jn.centerJustifiedTextSymbolIndex,Jn.leftJustifiedTextSymbolIndex].forEach(function(Vo){Vo>=0&&(_.text.placedSymbolArray.get(Vo).hidden=yo||Pi?1:0)}),Jn.verticalPlacedTextSymbolIndex>=0&&(_.text.placedSymbolArray.get(Jn.verticalPlacedTextSymbolIndex).hidden=yo||vi?1:0);var Ho=C.variableOffsets[Jn.crossTileID];Ho&&C.markUsedJustification(_,Ho.anchor,Jn,Mi);var is=C.placedOrientations[Jn.crossTileID];is&&(C.markUsedJustification(_,"left",Jn,is),C.markUsedOrientation(_,is,Jn))}if(Fr){var Cr=ya(Dr.icon),Kt=!(St&&Jn.verticalPlacedIconSymbolIndex&&Pi);Jn.placedIconSymbolIndex>=0&&(En(_.icon,Jn.numIconVertices,Kt?Cr:vs),_.icon.placedSymbolArray.get(Jn.placedIconSymbolIndex).hidden=Dr.icon.isHidden()),Jn.verticalPlacedIconSymbolIndex>=0&&(En(_.icon,Jn.numVerticalIconVertices,Kt?vs:Cr),_.icon.placedSymbolArray.get(Jn.verticalPlacedIconSymbolIndex).hidden=Dr.icon.isHidden())}if(_.hasIconCollisionBoxData()||_.hasTextCollisionBoxData()){var Zr=_.collisionArrays[Rn];if(Zr){var ko=new E.Point(0,0);if(Zr.textBox||Zr.verticalTextBox){var qo=!0;if(ze){var va=C.variableOffsets[gr];va?(ko=Wo(va.anchor,va.width,va.height,va.textOffset,va.textBoxScale),it&&ko._rotate(Bt?C.transform.angle:-C.transform.angle)):qo=!1}Zr.textBox&&Tt(_.textCollisionBox.collisionVertexArray,Dr.text.placed,!qo||Pi,ko.x,ko.y),Zr.verticalTextBox&&Tt(_.textCollisionBox.collisionVertexArray,Dr.text.placed,!qo||vi,ko.x,ko.y)}var na=!!(!vi&&Zr.verticalIconBox);Zr.iconBox&&Tt(_.iconCollisionBox.collisionVertexArray,Dr.icon.placed,na,St?ko.x:0,St?ko.y:0),Zr.verticalIconBox&&Tt(_.iconCollisionBox.collisionVertexArray,Dr.icon.placed,!na,St?ko.x:0,St?ko.y:0)}}},Un=0;Un<_.symbolInstances.length;Un++)yn(Un);if(_.sortFeatures(this.transform.angle),this.retainedQueryData[_.bucketInstanceId]&&(this.retainedQueryData[_.bucketInstanceId].featureSortOrder=_.featureSortOrder),_.hasTextData()&&_.text.opacityVertexBuffer&&_.text.opacityVertexBuffer.updateData(_.text.opacityVertexArray),_.hasIconData()&&_.icon.opacityVertexBuffer&&_.icon.opacityVertexBuffer.updateData(_.icon.opacityVertexArray),_.hasIconCollisionBoxData()&&_.iconCollisionBox.collisionVertexBuffer&&_.iconCollisionBox.collisionVertexBuffer.updateData(_.iconCollisionBox.collisionVertexArray),_.hasTextCollisionBoxData()&&_.textCollisionBox.collisionVertexBuffer&&_.textCollisionBox.collisionVertexBuffer.updateData(_.textCollisionBox.collisionVertexArray),_.bucketInstanceId in this.collisionCircleArrays){var cn=this.collisionCircleArrays[_.bucketInstanceId];_.placementInvProjMatrix=cn.invProjMatrix,_.placementViewportMatrix=cn.viewportMatrix,_.collisionCircleArray=cn.circles,delete this.collisionCircleArrays[_.bucketInstanceId]}},ds.prototype.symbolFadeChange=function(_){return this.fadeDuration===0?1:(_-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ds.prototype.zoomAdjustment=function(_){return Math.max(0,(this.transform.zoom-_)/1.5)},ds.prototype.hasTransitions=function(_){return this.stale||_-this.lastPlacementChangeTime<this.fadeDuration},ds.prototype.stillRecent=function(_,S){var x=this.zoomAtLastRecencyCheck===S?1-this.zoomAdjustment(S):1;return this.zoomAtLastRecencyCheck=S,this.commitTime+this.fadeDuration*x>_},ds.prototype.setStale=function(){this.stale=!0};var Yt=Math.pow(2,25),Fn=Math.pow(2,24),dr=Math.pow(2,17),ai=Math.pow(2,16),Xr=Math.pow(2,9),Uo=Math.pow(2,8),Xo=Math.pow(2,1);function ya(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;var S=_.placed?1:0,x=Math.floor(127*_.opacity);return x*Yt+S*Fn+x*dr+S*ai+x*Xr+S*Uo+x*Xo+S}var vs=0,nl=function(_){this._sortAcrossTiles=_.layout.get("symbol-z-order")!=="viewport-y"&&_.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};nl.prototype.continuePlacement=function(_,S,x,C,k){for(var G=this._bucketParts;this._currentTileIndex<_.length;)if(S.getBucketParts(G,C,_[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,G.sort(function(q,de){return q.sortKey-de.sortKey}));this._currentPartIndex<G.length;)if(S.placeLayerBucketPart(G[this._currentPartIndex],this._seenCrossTileIDs,x),this._currentPartIndex++,k())return!0;return!1};var $f=function(_,S,x,C,k,G,q){this.placement=new ds(_,k,G,q),this._currentPlacementIndex=S.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=C,this._done=!1};$f.prototype.isDone=function(){return this._done},$f.prototype.continuePlacement=function(_,S,x){for(var C=this,k=E.browser.now(),G=function(){var ze=E.browser.now()-k;return!C._forceFullPlacement&&ze>2};this._currentPlacementIndex>=0;){var q=S[_[this._currentPlacementIndex]],de=this.placement.collisionIndex.transform.zoom;if(q.type==="symbol"&&(!q.minzoom||q.minzoom<=de)&&(!q.maxzoom||q.maxzoom>de)){if(this._inProgressLayer||(this._inProgressLayer=new nl(q)),this._inProgressLayer.continuePlacement(x[q.source],this.placement,this._showCollisionBoxes,q,G))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$f.prototype.commit=function(_){return this.placement.commit(_),this.placement};var jd=512/E.EXTENT/2,Uh=function(_,S,x){this.tileID=_,this.indexedSymbolInstances={},this.bucketInstanceId=x;for(var C=0;C<S.length;C++){var k=S.get(C),G=k.key;this.indexedSymbolInstances[G]||(this.indexedSymbolInstances[G]=[]),this.indexedSymbolInstances[G].push({crossTileID:k.crossTileID,coord:this.getScaledCoordinates(k,_)})}};Uh.prototype.getScaledCoordinates=function(_,S){var x=jd/Math.pow(2,S.canonical.z-this.tileID.canonical.z);return{x:Math.floor((S.canonical.x*E.EXTENT+_.anchorX)*x),y:Math.floor((S.canonical.y*E.EXTENT+_.anchorY)*x)}},Uh.prototype.findMatches=function(_,S,x){for(var C=this.tileID.canonical.z<S.canonical.z?1:Math.pow(2,this.tileID.canonical.z-S.canonical.z),k=0;k<_.length;k++){var G=_.get(k);if(!G.crossTileID){var q=this.indexedSymbolInstances[G.key];if(q)for(var de=this.getScaledCoordinates(G,S),ze=0,it=q;ze<it.length;ze+=1){var Bt=it[ze];if(Math.abs(Bt.coord.x-de.x)<=C&&Math.abs(Bt.coord.y-de.y)<=C&&!x[Bt.crossTileID]){x[Bt.crossTileID]=!0,G.crossTileID=Bt.crossTileID;break}}}}};var Pl=function(){this.maxCrossTileID=0};Pl.prototype.generate=function(){return++this.maxCrossTileID};var Df=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Df.prototype.handleWrapJump=function(_){var S=Math.round((_-this.lng)/360);if(S!==0)for(var x in this.indexes){var C=this.indexes[x],k={};for(var G in C){var q=C[G];q.tileID=q.tileID.unwrapTo(q.tileID.wrap+S),k[q.tileID.key]=q}this.indexes[x]=k}this.lng=_},Df.prototype.addBucket=function(_,S,x){if(this.indexes[_.overscaledZ]&&this.indexes[_.overscaledZ][_.key]){if(this.indexes[_.overscaledZ][_.key].bucketInstanceId===S.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(_.overscaledZ,this.indexes[_.overscaledZ][_.key])}for(var C=0;C<S.symbolInstances.length;C++)S.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[_.overscaledZ]||(this.usedCrossTileIDs[_.overscaledZ]={});var k=this.usedCrossTileIDs[_.overscaledZ];for(var G in this.indexes){var q=this.indexes[G];if(Number(G)>_.overscaledZ)for(var de in q){var ze=q[de];ze.tileID.isChildOf(_)&&ze.findMatches(S.symbolInstances,_,k)}else{var it=q[_.scaledTo(Number(G)).key];it&&it.findMatches(S.symbolInstances,_,k)}}for(var Bt=0;Bt<S.symbolInstances.length;Bt++){var St=S.symbolInstances.get(Bt);St.crossTileID||(St.crossTileID=x.generate(),k[St.crossTileID]=!0)}return this.indexes[_.overscaledZ]===void 0&&(this.indexes[_.overscaledZ]={}),this.indexes[_.overscaledZ][_.key]=new Uh(_,S.symbolInstances,S.bucketInstanceId),!0},Df.prototype.removeBucketCrossTileIDs=function(_,S){for(var x in S.indexedSymbolInstances)for(var C=0,k=S.indexedSymbolInstances[x];C<k.length;C+=1)delete this.usedCrossTileIDs[_][k[C].crossTileID]},Df.prototype.removeStaleBuckets=function(_){var S=!1;for(var x in this.indexes){var C=this.indexes[x];for(var k in C)_[C[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,C[k]),delete C[k],S=!0)}return S};var Nf=function(){this.layerIndexes={},this.crossTileIDs=new Pl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Nf.prototype.addLayer=function(_,S,x){var C=this.layerIndexes[_.id];C===void 0&&(C=this.layerIndexes[_.id]=new Df);var k=!1,G={};C.handleWrapJump(x);for(var q=0,de=S;q<de.length;q+=1){var ze=de[q],it=ze.getBucket(_);it&&_.id===it.layerIds[0]&&(it.bucketInstanceId||(it.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(ze.tileID,it,this.crossTileIDs)&&(k=!0),G[it.bucketInstanceId]=!0)}return C.removeStaleBuckets(G)&&(k=!0),k},Nf.prototype.pruneUnusedLayers=function(_){var S={};for(var x in _.forEach(function(C){S[C]=!0}),this.layerIndexes)S[x]||delete this.layerIndexes[x]};var rc=function(_,S){return E.emitValidationErrors(_,S&&S.filter(function(x){return x.identifier!=="source.canvas"}))},gu=E.pick(Qr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ou=E.pick(Qr,["setCenter","setZoom","setBearing","setPitch"]),qu=function(){var _={},S=E.styleSpec.$version;for(var x in E.styleSpec.$root){var C,k=E.styleSpec.$root[x];k.required&&(C=x==="version"?S:k.type==="array"?[]:{})!=null&&(_[x]=C)}return _}(),lc=function(_){function S(x,C){var k=this;C===void 0&&(C={}),_.call(this),this.map=x,this.dispatcher=new Ct(ar(),this),this.imageManager=new we,this.imageManager.setEventedParent(this),this.glyphManager=new vt(x._requestManager,C.localIdeographFontFamily),this.lineAtlas=new gt(256,512),this.crossTileSymbolIndex=new Nf,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new E.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",E.getReferrer());var G=this;this._rtlTextPluginCallback=S.registerForPluginStateChange(function(q){G.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:q.pluginStatus,pluginURL:q.pluginURL},function(de,ze){if(E.triggerPluginCompletionEvent(de),ze&&ze.every(function(Bt){return Bt}))for(var it in G.sourceCaches)G.sourceCaches[it].reload()})}),this.on("data",function(q){if(q.dataType==="source"&&q.sourceDataType==="metadata"){var de=k.sourceCaches[q.sourceId];if(de){var ze=de.getSource();if(ze&&ze.vectorLayerIds)for(var it in k._layers){var Bt=k._layers[it];Bt.source===ze.id&&k._validateLayer(Bt)}}}})}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.loadURL=function(x,C){var k=this;C===void 0&&(C={}),this.fire(new E.Event("dataloading",{dataType:"style"}));var G=typeof C.validate=="boolean"?C.validate:!E.isMapboxURL(x);x=this.map._requestManager.normalizeStyleURL(x,C.accessToken);var q=this.map._requestManager.transformRequest(x,E.ResourceType.Style);this._request=E.getJSON(q,function(de,ze){k._request=null,de?k.fire(new E.ErrorEvent(de)):ze&&k._load(ze,G)})},S.prototype.loadJSON=function(x,C){var k=this;C===void 0&&(C={}),this.fire(new E.Event("dataloading",{dataType:"style"})),this._request=E.browser.frame(function(){k._request=null,k._load(x,C.validate!==!1)})},S.prototype.loadEmpty=function(){this.fire(new E.Event("dataloading",{dataType:"style"})),this._load(qu,!1)},S.prototype._load=function(x,C){if(!C||!rc(this,E.validateStyle(x))){for(var k in this._loaded=!0,this.stylesheet=x,x.sources)this.addSource(k,x.sources[k],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs);var G=hi(this.stylesheet.layers);this._order=G.map(function(it){return it.id}),this._layers={},this._serializedLayers={};for(var q=0,de=G;q<de.length;q+=1){var ze=de[q];(ze=E.createStyleLayer(ze)).setEventedParent(this,{layer:{id:ze.id}}),this._layers[ze.id]=ze,this._serializedLayers[ze.id]=ze.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new bt(this.stylesheet.light),this.fire(new E.Event("data",{dataType:"style"})),this.fire(new E.Event("style.load"))}},S.prototype._loadSprite=function(x){var C=this;this._spriteRequest=function(k,G,q){var de,ze,it,Bt=E.browser.devicePixelRatio>1?"@2x":"",St=E.getJSON(G.transformRequest(G.normalizeSpriteURL(k,Bt,".json"),E.ResourceType.SpriteJSON),function(yn,Un){St=null,it||(it=yn,de=Un,En())}),Xt=E.getImage(G.transformRequest(G.normalizeSpriteURL(k,Bt,".png"),E.ResourceType.SpriteImage),function(yn,Un){Xt=null,it||(it=yn,ze=Un,En())});function En(){if(it)q(it);else if(de&&ze){var yn=E.browser.getImageData(ze),Un={};for(var cn in de){var Rn=de[cn],Jn=Rn.width,hr=Rn.height,Lr=Rn.x,gr=Rn.y,Dr=Rn.sdf,Fr=Rn.pixelRatio,Mi=Rn.stretchX,Pi=Rn.stretchY,vi=Rn.content,Oo=new E.RGBAImage({width:Jn,height:hr});E.RGBAImage.copy(yn,Oo,{x:Lr,y:gr},{x:0,y:0},{width:Jn,height:hr}),Un[cn]={data:Oo,pixelRatio:Fr,sdf:Dr,stretchX:Mi,stretchY:Pi,content:vi}}q(null,Un)}}return{cancel:function(){St&&(St.cancel(),St=null),Xt&&(Xt.cancel(),Xt=null)}}}(x,this.map._requestManager,function(k,G){if(C._spriteRequest=null,k)C.fire(new E.ErrorEvent(k));else if(G)for(var q in G)C.imageManager.addImage(q,G[q]);C.imageManager.setLoaded(!0),C._availableImages=C.imageManager.listImages(),C.dispatcher.broadcast("setImages",C._availableImages),C.fire(new E.Event("data",{dataType:"style"}))})},S.prototype._validateLayer=function(x){var C=this.sourceCaches[x.source];if(C){var k=x.sourceLayer;if(k){var G=C.getSource();(G.type==="geojson"||G.vectorLayerIds&&G.vectorLayerIds.indexOf(k)===-1)&&this.fire(new E.ErrorEvent(new Error('Source layer "'+k+'" does not exist on source "'+G.id+'" as specified by style layer "'+x.id+'"')))}}},S.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var x in this.sourceCaches)if(!this.sourceCaches[x].loaded())return!1;return!!this.imageManager.isLoaded()},S.prototype._serializeLayers=function(x){for(var C=[],k=0,G=x;k<G.length;k+=1){var q=this._layers[G[k]];q.type!=="custom"&&C.push(q.serialize())}return C},S.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var x in this.sourceCaches)if(this.sourceCaches[x].hasTransition())return!0;for(var C in this._layers)if(this._layers[C].hasTransition())return!0;return!1},S.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},S.prototype.update=function(x){if(this._loaded){var C=this._changed;if(this._changed){var k=Object.keys(this._updatedLayers),G=Object.keys(this._removedLayers);for(var q in(k.length||G.length)&&this._updateWorkerLayers(k,G),this._updatedSources){var de=this._updatedSources[q];de==="reload"?this._reloadSource(q):de==="clear"&&this._clearSource(q)}for(var ze in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ze].updateTransitions(x);this.light.updateTransitions(x),this._resetUpdates()}var it={};for(var Bt in this.sourceCaches){var St=this.sourceCaches[Bt];it[Bt]=St.used,St.used=!1}for(var Xt=0,En=this._order;Xt<En.length;Xt+=1){var yn=this._layers[En[Xt]];yn.recalculate(x,this._availableImages),!yn.isHidden(x.zoom)&&yn.source&&(this.sourceCaches[yn.source].used=!0)}for(var Un in it){var cn=this.sourceCaches[Un];it[Un]!==cn.used&&cn.fire(new E.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Un}))}this.light.recalculate(x),this.z=x.zoom,C&&this.fire(new E.Event("data",{dataType:"style"}))}},S.prototype._updateTilesForChangedImages=function(){var x=Object.keys(this._changedImages);if(x.length){for(var C in this.sourceCaches)this.sourceCaches[C].reloadTilesForDependencies(["icons","patterns"],x);this._changedImages={}}},S.prototype._updateWorkerLayers=function(x,C){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(x),removedIds:C})},S.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},S.prototype.setState=function(x){var C=this;if(this._checkLoaded(),rc(this,E.validateStyle(x)))return!1;(x=E.clone$1(x)).layers=hi(x.layers);var k=function(q,de){if(!q)return[{command:Qr.setStyle,args:[de]}];var ze=[];try{if(!E.deepEqual(q.version,de.version))return[{command:Qr.setStyle,args:[de]}];E.deepEqual(q.center,de.center)||ze.push({command:Qr.setCenter,args:[de.center]}),E.deepEqual(q.zoom,de.zoom)||ze.push({command:Qr.setZoom,args:[de.zoom]}),E.deepEqual(q.bearing,de.bearing)||ze.push({command:Qr.setBearing,args:[de.bearing]}),E.deepEqual(q.pitch,de.pitch)||ze.push({command:Qr.setPitch,args:[de.pitch]}),E.deepEqual(q.sprite,de.sprite)||ze.push({command:Qr.setSprite,args:[de.sprite]}),E.deepEqual(q.glyphs,de.glyphs)||ze.push({command:Qr.setGlyphs,args:[de.glyphs]}),E.deepEqual(q.transition,de.transition)||ze.push({command:Qr.setTransition,args:[de.transition]}),E.deepEqual(q.light,de.light)||ze.push({command:Qr.setLight,args:[de.light]});var it={},Bt=[];(function(Xt,En,yn,Un){var cn;for(cn in En=En||{},Xt=Xt||{})Xt.hasOwnProperty(cn)&&(En.hasOwnProperty(cn)||Ii(cn,yn,Un));for(cn in En)En.hasOwnProperty(cn)&&(Xt.hasOwnProperty(cn)?E.deepEqual(Xt[cn],En[cn])||(Xt[cn].type==="geojson"&&En[cn].type==="geojson"&&_a(Xt,En,cn)?yn.push({command:Qr.setGeoJSONSourceData,args:[cn,En[cn].data]}):Fo(cn,En,yn,Un)):Io(cn,En,yn))})(q.sources,de.sources,Bt,it);var St=[];q.layers&&q.layers.forEach(function(Xt){it[Xt.source]?ze.push({command:Qr.removeLayer,args:[Xt.id]}):St.push(Xt)}),ze=ze.concat(Bt),function(Xt,En,yn){En=En||[];var Un,cn,Rn,Jn,hr,Lr,gr,Dr=(Xt=Xt||[]).map(Qo),Fr=En.map(Qo),Mi=Xt.reduce(De,{}),Pi=En.reduce(De,{}),vi=Dr.slice(),Oo=Object.create(null);for(Un=0,cn=0;Un<Dr.length;Un++)Pi.hasOwnProperty(Rn=Dr[Un])?cn++:(yn.push({command:Qr.removeLayer,args:[Rn]}),vi.splice(vi.indexOf(Rn,cn),1));for(Un=0,cn=0;Un<Fr.length;Un++)vi[vi.length-1-Un]!==(Rn=Fr[Fr.length-1-Un])&&(Mi.hasOwnProperty(Rn)?(yn.push({command:Qr.removeLayer,args:[Rn]}),vi.splice(vi.lastIndexOf(Rn,vi.length-cn),1)):cn++,yn.push({command:Qr.addLayer,args:[Pi[Rn],Lr=vi[vi.length-Un]]}),vi.splice(vi.length-Un,0,Rn),Oo[Rn]=!0);for(Un=0;Un<Fr.length;Un++)if(Jn=Mi[Rn=Fr[Un]],hr=Pi[Rn],!Oo[Rn]&&!E.deepEqual(Jn,hr))if(E.deepEqual(Jn.source,hr.source)&&E.deepEqual(Jn["source-layer"],hr["source-layer"])&&E.deepEqual(Jn.type,hr.type)){for(gr in Co(Jn.layout,hr.layout,yn,Rn,null,Qr.setLayoutProperty),Co(Jn.paint,hr.paint,yn,Rn,null,Qr.setPaintProperty),E.deepEqual(Jn.filter,hr.filter)||yn.push({command:Qr.setFilter,args:[Rn,hr.filter]}),E.deepEqual(Jn.minzoom,hr.minzoom)&&E.deepEqual(Jn.maxzoom,hr.maxzoom)||yn.push({command:Qr.setLayerZoomRange,args:[Rn,hr.minzoom,hr.maxzoom]}),Jn)Jn.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?Co(Jn[gr],hr[gr],yn,Rn,gr.slice(6),Qr.setPaintProperty):E.deepEqual(Jn[gr],hr[gr])||yn.push({command:Qr.setLayerProperty,args:[Rn,gr,hr[gr]]}));for(gr in hr)hr.hasOwnProperty(gr)&&!Jn.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?Co(Jn[gr],hr[gr],yn,Rn,gr.slice(6),Qr.setPaintProperty):E.deepEqual(Jn[gr],hr[gr])||yn.push({command:Qr.setLayerProperty,args:[Rn,gr,hr[gr]]}))}else yn.push({command:Qr.removeLayer,args:[Rn]}),Lr=vi[vi.lastIndexOf(Rn)+1],yn.push({command:Qr.addLayer,args:[hr,Lr]})}(St,de.layers,ze)}catch(Xt){console.warn("Unable to compute style diff:",Xt),ze=[{command:Qr.setStyle,args:[de]}]}return ze}(this.serialize(),x).filter(function(q){return!(q.command in ou)});if(k.length===0)return!1;var G=k.filter(function(q){return!(q.command in gu)});if(G.length>0)throw new Error("Unimplemented: "+G.map(function(q){return q.command}).join(", ")+".");return k.forEach(function(q){q.command!=="setTransition"&&C[q.command].apply(C,q.args)}),this.stylesheet=x,!0},S.prototype.addImage=function(x,C){if(this.getImage(x))return this.fire(new E.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(x,C),this._afterImageUpdated(x)},S.prototype.updateImage=function(x,C){this.imageManager.updateImage(x,C)},S.prototype.getImage=function(x){return this.imageManager.getImage(x)},S.prototype.removeImage=function(x){if(!this.getImage(x))return this.fire(new E.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(x),this._afterImageUpdated(x)},S.prototype._afterImageUpdated=function(x){this._availableImages=this.imageManager.listImages(),this._changedImages[x]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new E.Event("data",{dataType:"style"}))},S.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},S.prototype.addSource=function(x,C,k){var G=this;if(k===void 0&&(k={}),this._checkLoaded(),this.sourceCaches[x]!==void 0)throw new Error("There is already a source with this ID");if(!C.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(C).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(C.type)>=0&&this._validate(E.validateStyle.source,"sources."+x,C,null,k))){this.map&&this.map._collectResourceTiming&&(C.collectResourceTiming=!0);var q=this.sourceCaches[x]=new Jt(x,C,this.dispatcher);q.style=this,q.setEventedParent(this,function(){return{isSourceLoaded:G.loaded(),source:q.serialize(),sourceId:x}}),q.onAdd(this.map),this._changed=!0}},S.prototype.removeSource=function(x){if(this._checkLoaded(),this.sourceCaches[x]===void 0)throw new Error("There is no source with this ID");for(var C in this._layers)if(this._layers[C].source===x)return this.fire(new E.ErrorEvent(new Error('Source "'+x+'" cannot be removed while layer "'+C+'" is using it.')));var k=this.sourceCaches[x];delete this.sourceCaches[x],delete this._updatedSources[x],k.fire(new E.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x})),k.setEventedParent(null),k.clearTiles(),k.onRemove&&k.onRemove(this.map),this._changed=!0},S.prototype.setGeoJSONSourceData=function(x,C){this._checkLoaded(),this.sourceCaches[x].getSource().setData(C),this._changed=!0},S.prototype.getSource=function(x){return this.sourceCaches[x]&&this.sourceCaches[x].getSource()},S.prototype.addLayer=function(x,C,k){k===void 0&&(k={}),this._checkLoaded();var G=x.id;if(this.getLayer(G))this.fire(new E.ErrorEvent(new Error('Layer with id "'+G+'" already exists on this map')));else{var q;if(x.type==="custom"){if(rc(this,E.validateCustomStyleLayer(x)))return;q=E.createStyleLayer(x)}else{if(typeof x.source=="object"&&(this.addSource(G,x.source),x=E.clone$1(x),x=E.extend(x,{source:G})),this._validate(E.validateStyle.layer,"layers."+G,x,{arrayIndex:-1},k))return;q=E.createStyleLayer(x),this._validateLayer(q),q.setEventedParent(this,{layer:{id:G}}),this._serializedLayers[q.id]=q.serialize()}var de=C?this._order.indexOf(C):this._order.length;if(C&&de===-1)this.fire(new E.ErrorEvent(new Error('Layer with id "'+C+'" does not exist on this map.')));else{if(this._order.splice(de,0,G),this._layerOrderChanged=!0,this._layers[G]=q,this._removedLayers[G]&&q.source&&q.type!=="custom"){var ze=this._removedLayers[G];delete this._removedLayers[G],ze.type!==q.type?this._updatedSources[q.source]="clear":(this._updatedSources[q.source]="reload",this.sourceCaches[q.source].pause())}this._updateLayer(q),q.onAdd&&q.onAdd(this.map)}}},S.prototype.moveLayer=function(x,C){if(this._checkLoaded(),this._changed=!0,this._layers[x]){if(x!==C){var k=this._order.indexOf(x);this._order.splice(k,1);var G=C?this._order.indexOf(C):this._order.length;C&&G===-1?this.fire(new E.ErrorEvent(new Error('Layer with id "'+C+'" does not exist on this map.'))):(this._order.splice(G,0,x),this._layerOrderChanged=!0)}}else this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be moved.")))},S.prototype.removeLayer=function(x){this._checkLoaded();var C=this._layers[x];if(C){C.setEventedParent(null);var k=this._order.indexOf(x);this._order.splice(k,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[x]=C,delete this._layers[x],delete this._serializedLayers[x],delete this._updatedLayers[x],delete this._updatedPaintProps[x],C.onRemove&&C.onRemove(this.map)}else this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be removed.")))},S.prototype.getLayer=function(x){return this._layers[x]},S.prototype.hasLayer=function(x){return x in this._layers},S.prototype.setLayerZoomRange=function(x,C,k){this._checkLoaded();var G=this.getLayer(x);G?G.minzoom===C&&G.maxzoom===k||(C!=null&&(G.minzoom=C),k!=null&&(G.maxzoom=k),this._updateLayer(G)):this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot have zoom extent.")))},S.prototype.setFilter=function(x,C,k){k===void 0&&(k={}),this._checkLoaded();var G=this.getLayer(x);if(G){if(!E.deepEqual(G.filter,C))return C==null?(G.filter=void 0,void this._updateLayer(G)):void(this._validate(E.validateStyle.filter,"layers."+G.id+".filter",C,null,k)||(G.filter=E.clone$1(C),this._updateLayer(G)))}else this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be filtered.")))},S.prototype.getFilter=function(x){return E.clone$1(this.getLayer(x).filter)},S.prototype.setLayoutProperty=function(x,C,k,G){G===void 0&&(G={}),this._checkLoaded();var q=this.getLayer(x);q?E.deepEqual(q.getLayoutProperty(C),k)||(q.setLayoutProperty(C,k,G),this._updateLayer(q)):this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be styled.")))},S.prototype.getLayoutProperty=function(x,C){var k=this.getLayer(x);if(k)return k.getLayoutProperty(C);this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style.")))},S.prototype.setPaintProperty=function(x,C,k,G){G===void 0&&(G={}),this._checkLoaded();var q=this.getLayer(x);q?E.deepEqual(q.getPaintProperty(C),k)||(q.setPaintProperty(C,k,G)&&this._updateLayer(q),this._changed=!0,this._updatedPaintProps[x]=!0):this.fire(new E.ErrorEvent(new Error("The layer '"+x+"' does not exist in the map's style and cannot be styled.")))},S.prototype.getPaintProperty=function(x,C){return this.getLayer(x).getPaintProperty(C)},S.prototype.setFeatureState=function(x,C){this._checkLoaded();var k=x.source,G=x.sourceLayer,q=this.sourceCaches[k];if(q!==void 0){var de=q.getSource().type;de==="geojson"&&G?this.fire(new E.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):de!=="vector"||G?(x.id===void 0&&this.fire(new E.ErrorEvent(new Error("The feature id parameter must be provided."))),q.setFeatureState(G,x.id,C)):this.fire(new E.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new E.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},S.prototype.removeFeatureState=function(x,C){this._checkLoaded();var k=x.source,G=this.sourceCaches[k];if(G!==void 0){var q=G.getSource().type,de=q==="vector"?x.sourceLayer:void 0;q!=="vector"||de?C&&typeof x.id!="string"&&typeof x.id!="number"?this.fire(new E.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):G.removeFeatureState(de,x.id,C):this.fire(new E.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new E.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},S.prototype.getFeatureState=function(x){this._checkLoaded();var C=x.source,k=x.sourceLayer,G=this.sourceCaches[C];if(G!==void 0){if(G.getSource().type!=="vector"||k)return x.id===void 0&&this.fire(new E.ErrorEvent(new Error("The feature id parameter must be provided."))),G.getFeatureState(k,x.id);this.fire(new E.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new E.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},S.prototype.getTransition=function(){return E.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},S.prototype.serialize=function(){return E.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:E.mapObject(this.sourceCaches,function(x){return x.serialize()}),layers:this._serializeLayers(this._order)},function(x){return x!==void 0})},S.prototype._updateLayer=function(x){this._updatedLayers[x.id]=!0,x.source&&!this._updatedSources[x.source]&&this.sourceCaches[x.source].getSource().type!=="raster"&&(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause()),this._changed=!0},S.prototype._flattenAndSortRenderedFeatures=function(x){for(var C=this,k=function(Mi){return C._layers[Mi].type==="fill-extrusion"},G={},q=[],de=this._order.length-1;de>=0;de--){var ze=this._order[de];if(k(ze)){G[ze]=de;for(var it=0,Bt=x;it<Bt.length;it+=1){var St=Bt[it][ze];if(St)for(var Xt=0,En=St;Xt<En.length;Xt+=1)q.push(En[Xt])}}}q.sort(function(Mi,Pi){return Pi.intersectionZ-Mi.intersectionZ});for(var yn=[],Un=this._order.length-1;Un>=0;Un--){var cn=this._order[Un];if(k(cn))for(var Rn=q.length-1;Rn>=0;Rn--){var Jn=q[Rn].feature;if(G[Jn.layer.id]<Un)break;yn.push(Jn),q.pop()}else for(var hr=0,Lr=x;hr<Lr.length;hr+=1){var gr=Lr[hr][cn];if(gr)for(var Dr=0,Fr=gr;Dr<Fr.length;Dr+=1)yn.push(Fr[Dr].feature)}}return yn},S.prototype.queryRenderedFeatures=function(x,C,k){C&&C.filter&&this._validate(E.validateStyle.filter,"queryRenderedFeatures.filter",C.filter,null,C);var G={};if(C&&C.layers){if(!Array.isArray(C.layers))return this.fire(new E.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var q=0,de=C.layers;q<de.length;q+=1){var ze=de[q],it=this._layers[ze];if(!it)return this.fire(new E.ErrorEvent(new Error("The layer '"+ze+"' does not exist in the map's style and cannot be queried for features."))),[];G[it.source]=!0}}var Bt=[];for(var St in C.availableImages=this._availableImages,this.sourceCaches)C.layers&&!G[St]||Bt.push(Nn(this.sourceCaches[St],this._layers,this._serializedLayers,x,C,k));return this.placement&&Bt.push(function(Xt,En,yn,Un,cn,Rn,Jn){for(var hr={},Lr=Rn.queryRenderedSymbols(Un),gr=[],Dr=0,Fr=Object.keys(Lr).map(Number);Dr<Fr.length;Dr+=1)gr.push(Jn[Fr[Dr]]);gr.sort(jn);for(var Mi=function(){var Ho=vi[Pi],is=Ho.featureIndex.lookupSymbolFeatures(Lr[Ho.bucketInstanceId],En,Ho.bucketIndex,Ho.sourceLayerIndex,cn.filter,cn.layers,cn.availableImages,Xt);for(var Cr in is){var Kt=hr[Cr]=hr[Cr]||[],Zr=is[Cr];Zr.sort(function(va,na){var Vo=Ho.featureSortOrder;if(Vo){var sl=Vo.indexOf(va.featureIndex);return Vo.indexOf(na.featureIndex)-sl}return na.featureIndex-va.featureIndex});for(var ko=0,qo=Zr;ko<qo.length;ko+=1)Kt.push(qo[ko])}},Pi=0,vi=gr;Pi<vi.length;Pi+=1)Mi();var Oo=function(Ho){hr[Ho].forEach(function(is){var Cr=is.feature,Kt=yn[Xt[Ho].source].getFeatureState(Cr.layer["source-layer"],Cr.id);Cr.source=Cr.layer.source,Cr.layer["source-layer"]&&(Cr.sourceLayer=Cr.layer["source-layer"]),Cr.state=Kt})};for(var yo in hr)Oo(yo);return hr}(this._layers,this._serializedLayers,this.sourceCaches,x,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Bt)},S.prototype.querySourceFeatures=function(x,C){C&&C.filter&&this._validate(E.validateStyle.filter,"querySourceFeatures.filter",C.filter,null,C);var k=this.sourceCaches[x];return k?function(G,q){for(var de=G.getRenderableIds().map(function(En){return G.getTileByID(En)}),ze=[],it={},Bt=0;Bt<de.length;Bt++){var St=de[Bt],Xt=St.tileID.canonical.key;it[Xt]||(it[Xt]=!0,St.querySourceFeatures(ze,q))}return ze}(k,C):[]},S.prototype.addSourceType=function(x,C,k){return S.getSourceType(x)?k(new Error('A source type called "'+x+'" already exists.')):(S.setSourceType(x,C),C.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:x,url:C.workerSourceURL},k):k(null,null))},S.prototype.getLight=function(){return this.light.getLight()},S.prototype.setLight=function(x,C){C===void 0&&(C={}),this._checkLoaded();var k=this.light.getLight(),G=!1;for(var q in x)if(!E.deepEqual(x[q],k[q])){G=!0;break}if(G){var de={now:E.browser.now(),transition:E.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(x,C),this.light.updateTransitions(de)}},S.prototype._validate=function(x,C,k,G,q){return q===void 0&&(q={}),(!q||q.validate!==!1)&&rc(this,x.call(E.validateStyle,E.extend({key:C,style:this.serialize(),value:k,styleSpec:E.styleSpec},G)))},S.prototype._remove=function(){for(var x in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),E.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[x].setEventedParent(null);for(var C in this.sourceCaches)this.sourceCaches[C].clearTiles(),this.sourceCaches[C].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},S.prototype._clearSource=function(x){this.sourceCaches[x].clearTiles()},S.prototype._reloadSource=function(x){this.sourceCaches[x].resume(),this.sourceCaches[x].reload()},S.prototype._updateSources=function(x){for(var C in this.sourceCaches)this.sourceCaches[C].update(x)},S.prototype._generateCollisionBoxes=function(){for(var x in this.sourceCaches)this._reloadSource(x)},S.prototype._updatePlacement=function(x,C,k,G,q){q===void 0&&(q=!1);for(var de=!1,ze=!1,it={},Bt=0,St=this._order;Bt<St.length;Bt+=1){var Xt=this._layers[St[Bt]];if(Xt.type==="symbol"){if(!it[Xt.source]){var En=this.sourceCaches[Xt.source];it[Xt.source]=En.getRenderableIds(!0).map(function(Jn){return En.getTileByID(Jn)}).sort(function(Jn,hr){return hr.tileID.overscaledZ-Jn.tileID.overscaledZ||(Jn.tileID.isLessThan(hr.tileID)?-1:1)})}var yn=this.crossTileSymbolIndex.addLayer(Xt,it[Xt.source],x.center.lng);de=de||yn}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((q=q||this._layerOrderChanged||k===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(E.browser.now(),x.zoom))&&(this.pauseablePlacement=new $f(x,this._order,q,C,k,G,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,it),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(E.browser.now()),ze=!0),de&&this.pauseablePlacement.placement.setStale()),ze||de)for(var Un=0,cn=this._order;Un<cn.length;Un+=1){var Rn=this._layers[cn[Un]];Rn.type==="symbol"&&this.placement.updateLayerOpacities(Rn,it[Rn.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(E.browser.now())},S.prototype._releaseSymbolFadeTiles=function(){for(var x in this.sourceCaches)this.sourceCaches[x].releaseSymbolFadeTiles()},S.prototype.getImages=function(x,C,k){this.imageManager.getImages(C.icons,k),this._updateTilesForChangedImages();var G=this.sourceCaches[C.source];G&&G.setDependencies(C.tileID.key,C.type,C.icons)},S.prototype.getGlyphs=function(x,C,k){this.glyphManager.getGlyphs(C.stacks,k)},S.prototype.getResource=function(x,C,k){return E.makeRequest(C,k)},S}(E.Evented);lc.getSourceType=function(_){return Wt[_]},lc.setSourceType=function(_,S){Wt[_]=S},lc.registerForPluginStateChange=E.registerForPluginStateChange;var Xs=E.createLayout([{name:"a_pos",type:"Int16",components:2}]),Lu=ns(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),gf=ns(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),jh=ns(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),bp=ns(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),vh=ns("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Kf=ns(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Du=ns(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),gh=ns("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Vh=ns("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),bd=ns("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),t0=ns(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),qf=ns(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),yu=ns(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Vd=ns(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),zl=ns(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),_u=ns(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Qu=ns(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),_s=ns(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),au=ns(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),xc=ns(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ju=ns(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),hl=ns(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Nu=ns(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ef=ns(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Hd=ns(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Hh=ns(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ns(_,S){var x=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,C=S.match(/attribute ([\w]+) ([\w]+)/g),k=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),G=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),q=G?G.concat(k):k,de={};return{fragmentSource:_=_.replace(x,function(ze,it,Bt,St,Xt){return de[Xt]=!0,it==="define"?`
#ifndef HAS_UNIFORM_u_`+Xt+`
varying `+Bt+" "+St+" "+Xt+`;
#else
uniform `+Bt+" "+St+" u_"+Xt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Xt+`
    `+Bt+" "+St+" "+Xt+" = u_"+Xt+`;
#endif
`}),vertexSource:S=S.replace(x,function(ze,it,Bt,St,Xt){var En=St==="float"?"vec2":"vec4",yn=Xt.match(/color/)?"color":En;return de[Xt]?it==="define"?`
#ifndef HAS_UNIFORM_u_`+Xt+`
uniform lowp float u_`+Xt+`_t;
attribute `+Bt+" "+En+" a_"+Xt+`;
varying `+Bt+" "+St+" "+Xt+`;
#else
uniform `+Bt+" "+St+" u_"+Xt+`;
#endif
`:yn==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Xt+`
    `+Xt+" = a_"+Xt+`;
#else
    `+Bt+" "+St+" "+Xt+" = u_"+Xt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Xt+`
    `+Xt+" = unpack_mix_"+yn+"(a_"+Xt+", u_"+Xt+`_t);
#else
    `+Bt+" "+St+" "+Xt+" = u_"+Xt+`;
#endif
`:it==="define"?`
#ifndef HAS_UNIFORM_u_`+Xt+`
uniform lowp float u_`+Xt+`_t;
attribute `+Bt+" "+En+" a_"+Xt+`;
#else
uniform `+Bt+" "+St+" u_"+Xt+`;
#endif
`:yn==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Xt+`
    `+Bt+" "+St+" "+Xt+" = a_"+Xt+`;
#else
    `+Bt+" "+St+" "+Xt+" = u_"+Xt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Xt+`
    `+Bt+" "+St+" "+Xt+" = unpack_mix_"+yn+"(a_"+Xt+", u_"+Xt+`_t);
#else
    `+Bt+" "+St+" "+Xt+" = u_"+Xt+`;
#endif
`}),staticAttributes:C,staticUniforms:q}}var yh=Object.freeze({__proto__:null,prelude:Lu,background:gf,backgroundPattern:jh,circle:bp,clippingMask:vh,heatmap:Kf,heatmapTexture:Du,collisionBox:gh,collisionCircle:Vh,debug:bd,fill:t0,fillOutline:qf,fillOutlinePattern:yu,fillPattern:Vd,fillExtrusion:zl,fillExtrusionPattern:_u,hillshadePrepare:Qu,hillshade:_s,line:au,lineGradient:xc,linePattern:Ju,lineSDF:hl,raster:Nu,symbolIcon:ef,symbolSDF:Hd,symbolTextAndIcon:Hh}),Zh=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Wh(_){for(var S=[],x=0;x<_.length;x++)if(_[x]!==null){var C=_[x].split(" ");S.push(C.pop())}return S}Zh.prototype.bind=function(_,S,x,C,k,G,q,de){this.context=_;for(var ze=this.boundPaintVertexBuffers.length!==C.length,it=0;!ze&&it<C.length;it++)this.boundPaintVertexBuffers[it]!==C[it]&&(ze=!0);_.extVertexArrayObject&&this.vao&&this.boundProgram===S&&this.boundLayoutVertexBuffer===x&&!ze&&this.boundIndexBuffer===k&&this.boundVertexOffset===G&&this.boundDynamicVertexBuffer===q&&this.boundDynamicVertexBuffer2===de?(_.bindVertexArrayOES.set(this.vao),q&&q.bind(),k&&k.dynamicDraw&&k.bind(),de&&de.bind()):this.freshBind(S,x,C,k,G,q,de)},Zh.prototype.freshBind=function(_,S,x,C,k,G,q){var de,ze=_.numAttributes,it=this.context,Bt=it.gl;if(it.extVertexArrayObject)this.vao&&this.destroy(),this.vao=it.extVertexArrayObject.createVertexArrayOES(),it.bindVertexArrayOES.set(this.vao),de=0,this.boundProgram=_,this.boundLayoutVertexBuffer=S,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=C,this.boundVertexOffset=k,this.boundDynamicVertexBuffer=G,this.boundDynamicVertexBuffer2=q;else{de=it.currentNumAttributes||0;for(var St=ze;St<de;St++)Bt.disableVertexAttribArray(St)}S.enableAttributes(Bt,_);for(var Xt=0,En=x;Xt<En.length;Xt+=1)En[Xt].enableAttributes(Bt,_);G&&G.enableAttributes(Bt,_),q&&q.enableAttributes(Bt,_),S.bind(),S.setVertexAttribPointers(Bt,_,k);for(var yn=0,Un=x;yn<Un.length;yn+=1){var cn=Un[yn];cn.bind(),cn.setVertexAttribPointers(Bt,_,k)}G&&(G.bind(),G.setVertexAttribPointers(Bt,_,k)),C&&C.bind(),q&&(q.bind(),q.setVertexAttribPointers(Bt,_,k)),it.currentNumAttributes=ze},Zh.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var rl=function(_,S,x,C,k,G){var q=_.gl;this.program=q.createProgram();for(var de=Wh(x.staticAttributes),ze=C?C.getBinderAttributes():[],it=de.concat(ze),Bt=x.staticUniforms?Wh(x.staticUniforms):[],St=C?C.getBinderUniforms():[],Xt=[],En=0,yn=Bt.concat(St);En<yn.length;En+=1){var Un=yn[En];Xt.indexOf(Un)<0&&Xt.push(Un)}var cn=C?C.defines():[];G&&cn.push("#define OVERDRAW_INSPECTOR;");var Rn=cn.concat(Lu.fragmentSource,x.fragmentSource).join(`
`),Jn=cn.concat(Lu.vertexSource,x.vertexSource).join(`
`),hr=q.createShader(q.FRAGMENT_SHADER);if(q.isContextLost())this.failedToCreate=!0;else{q.shaderSource(hr,Rn),q.compileShader(hr),q.attachShader(this.program,hr);var Lr=q.createShader(q.VERTEX_SHADER);if(q.isContextLost())this.failedToCreate=!0;else{q.shaderSource(Lr,Jn),q.compileShader(Lr),q.attachShader(this.program,Lr),this.attributes={};var gr={};this.numAttributes=it.length;for(var Dr=0;Dr<this.numAttributes;Dr++)it[Dr]&&(q.bindAttribLocation(this.program,Dr,it[Dr]),this.attributes[it[Dr]]=Dr);q.linkProgram(this.program),q.deleteShader(Lr),q.deleteShader(hr);for(var Fr=0;Fr<Xt.length;Fr++){var Mi=Xt[Fr];if(Mi&&!gr[Mi]){var Pi=q.getUniformLocation(this.program,Mi);Pi&&(gr[Mi]=Pi)}}this.fixedUniforms=k(_,gr),this.binderUniforms=C?C.getUniforms(_,gr):[]}}};function Bf(_,S,x){var C=1/Ri(x,1,S.transform.tileZoom),k=Math.pow(2,x.tileID.overscaledZ),G=x.tileSize*Math.pow(2,S.transform.tileZoom)/k,q=G*(x.tileID.canonical.x+x.tileID.wrap*k),de=G*x.tileID.canonical.y;return{u_image:0,u_texsize:x.imageAtlasTexture.size,u_scale:[C,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[q>>16,de>>16],u_pixel_coord_lower:[65535&q,65535&de]}}rl.prototype.draw=function(_,S,x,C,k,G,q,de,ze,it,Bt,St,Xt,En,yn,Un){var cn,Rn=_.gl;if(!this.failedToCreate){for(var Jn in _.program.set(this.program),_.setDepthMode(x),_.setStencilMode(C),_.setColorMode(k),_.setCullFace(G),this.fixedUniforms)this.fixedUniforms[Jn].set(q[Jn]);En&&En.setUniforms(_,this.binderUniforms,St,{zoom:Xt});for(var hr=(cn={},cn[Rn.LINES]=2,cn[Rn.TRIANGLES]=3,cn[Rn.LINE_STRIP]=1,cn)[S],Lr=0,gr=Bt.get();Lr<gr.length;Lr+=1){var Dr=gr[Lr],Fr=Dr.vaos||(Dr.vaos={});(Fr[de]||(Fr[de]=new Zh)).bind(_,this,ze,En?En.getPaintVertexBuffers():[],it,Dr.vertexOffset,yn,Un),Rn.drawElements(S,Dr.primitiveLength*hr,Rn.UNSIGNED_SHORT,Dr.primitiveOffset*hr*2)}}};var _h=function(_,S,x,C){var k=S.style.light,G=k.properties.get("position"),q=[G.x,G.y,G.z],de=E.create$1();k.properties.get("anchor")==="viewport"&&E.fromRotation(de,-S.transform.angle),E.transformMat3(q,q,de);var ze=k.properties.get("color");return{u_matrix:_,u_lightpos:q,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[ze.r,ze.g,ze.b],u_vertical_gradient:+x,u_opacity:C}},ne=function(_,S,x,C,k,G,q){return E.extend(_h(_,S,x,C),Bf(G,S,q),{u_height_factor:-Math.pow(2,k.overscaledZ)/q.tileSize/8})},ge=function(_){return{u_matrix:_}},qe=function(_,S,x,C){return E.extend(ge(_),Bf(x,S,C))},mn=function(_,S){return{u_matrix:_,u_world:S}},K=function(_,S,x,C,k){return E.extend(qe(_,S,x,C),{u_world:k})},tr=function(_,S,x,C){var k,G,q=_.transform;if(C.paint.get("circle-pitch-alignment")==="map"){var de=Ri(x,1,q.zoom);k=!0,G=[de,de]}else k=!1,G=q.pixelsToGLUnits;return{u_camera_to_center_distance:q.cameraToCenterDistance,u_scale_with_map:+(C.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(S.posMatrix,x,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_pitch_with_map:+k,u_device_pixel_ratio:E.browser.devicePixelRatio,u_extrude_scale:G}},Mr=function(_,S,x){var C=Ri(x,1,S.zoom),k=Math.pow(2,S.zoom-x.tileID.overscaledZ),G=x.tileID.overscaleFactor();return{u_matrix:_,u_camera_to_center_distance:S.cameraToCenterDistance,u_pixels_to_tile_units:C,u_extrude_scale:[S.pixelsToGLUnits[0]/(C*k),S.pixelsToGLUnits[1]/(C*k)],u_overscale_factor:G}},Bi=function(_,S,x){return{u_matrix:_,u_inv_matrix:S,u_camera_to_center_distance:x.cameraToCenterDistance,u_viewport_size:[x.width,x.height]}},zi=function(_,S,x){return x===void 0&&(x=1),{u_matrix:_,u_color:S,u_overlay:0,u_overlay_scale:x}},so=function(_){return{u_matrix:_}},Si=function(_,S,x,C){return{u_matrix:_,u_extrude_scale:Ri(S,1,x),u_intensity:C}},Sa=function(_,S,x){var C=_.transform;return{u_matrix:Aa(_,S,x),u_ratio:1/Ri(S,1,C.zoom),u_device_pixel_ratio:E.browser.devicePixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Do=function(_,S,x,C){return E.extend(Sa(_,S,x),{u_image:0,u_image_height:C})},ha=function(_,S,x,C){var k=_.transform,G=ua(S,k);return{u_matrix:Aa(_,S,x),u_texsize:S.imageAtlasTexture.size,u_ratio:1/Ri(S,1,k.zoom),u_device_pixel_ratio:E.browser.devicePixelRatio,u_image:0,u_scale:[G,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]]}},rs=function(_,S,x,C,k){var G=_.lineAtlas,q=ua(S,_.transform),de=x.layout.get("line-cap")==="round",ze=G.getDash(C.from,de),it=G.getDash(C.to,de),Bt=ze.width*k.fromScale,St=it.width*k.toScale;return E.extend(Sa(_,S,x),{u_patternscale_a:[q/Bt,-ze.height/2],u_patternscale_b:[q/St,-it.height/2],u_sdfgamma:G.width/(256*Math.min(Bt,St)*E.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:ze.y,u_tex_y_b:it.y,u_mix:k.t})};function ua(_,S){return 1/Ri(_,1,S.tileZoom)}function Aa(_,S,x){return _.translatePosMatrix(S.tileID.posMatrix,S,x.paint.get("line-translate"),x.paint.get("line-translate-anchor"))}var ls=function(_,S,x,C,k){return{u_matrix:_,u_tl_parent:S,u_scale_parent:x,u_buffer_scale:1,u_fade_t:C.mix,u_opacity:C.opacity*k.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:k.paint.get("raster-brightness-min"),u_brightness_high:k.paint.get("raster-brightness-max"),u_saturation_factor:(q=k.paint.get("raster-saturation"),q>0?1-1/(1.001-q):-q),u_contrast_factor:(G=k.paint.get("raster-contrast"),G>0?1/(1-G):1+G),u_spin_weights:Ma(k.paint.get("raster-hue-rotate"))};var G,q};function Ma(_){_*=Math.PI/180;var S=Math.sin(_),x=Math.cos(_);return[(2*x+1)/3,(-Math.sqrt(3)*S-x+1)/3,(Math.sqrt(3)*S-x+1)/3]}var Da,Xa=function(_,S,x,C,k,G,q,de,ze,it){var Bt=k.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:S?S.uSizeT:0,u_size:S?S.uSize:0,u_camera_to_center_distance:Bt.cameraToCenterDistance,u_pitch:Bt.pitch/360*2*Math.PI,u_rotate_symbol:+x,u_aspect_ratio:Bt.width/Bt.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:G,u_label_plane_matrix:q,u_coord_matrix:de,u_is_text:+ze,u_pitch_with_map:+C,u_texsize:it,u_texture:0}},Ls=function(_,S,x,C,k,G,q,de,ze,it,Bt){var St=k.transform;return E.extend(Xa(_,S,x,C,k,G,q,de,ze,it),{u_gamma_scale:C?Math.cos(St._pitch)*St.cameraToCenterDistance:1,u_device_pixel_ratio:E.browser.devicePixelRatio,u_is_halo:+Bt})},Qa=function(_,S,x,C,k,G,q,de,ze,it){return E.extend(Ls(_,S,x,C,k,G,q,de,!0,ze,!0),{u_texsize_icon:it,u_texture_icon:1})},Ec=function(_,S,x){return{u_matrix:_,u_opacity:S,u_color:x}},cs=function(_,S,x,C,k,G){return E.extend(function(q,de,ze,it){var Bt=ze.imageManager.getPattern(q.from.toString()),St=ze.imageManager.getPattern(q.to.toString()),Xt=ze.imageManager.getPixelSize(),En=Xt.width,yn=Xt.height,Un=Math.pow(2,it.tileID.overscaledZ),cn=it.tileSize*Math.pow(2,ze.transform.tileZoom)/Un,Rn=cn*(it.tileID.canonical.x+it.tileID.wrap*Un),Jn=cn*it.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Bt.tl,u_pattern_br_a:Bt.br,u_pattern_tl_b:St.tl,u_pattern_br_b:St.br,u_texsize:[En,yn],u_mix:de.t,u_pattern_size_a:Bt.displaySize,u_pattern_size_b:St.displaySize,u_scale_a:de.fromScale,u_scale_b:de.toScale,u_tile_units_to_pixels:1/Ri(it,1,ze.transform.tileZoom),u_pixel_coord_upper:[Rn>>16,Jn>>16],u_pixel_coord_lower:[65535&Rn,65535&Jn]}}(C,G,x,k),{u_matrix:_,u_opacity:S})},Bu={fillExtrusion:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_lightpos:new E.Uniform3f(_,S.u_lightpos),u_lightintensity:new E.Uniform1f(_,S.u_lightintensity),u_lightcolor:new E.Uniform3f(_,S.u_lightcolor),u_vertical_gradient:new E.Uniform1f(_,S.u_vertical_gradient),u_opacity:new E.Uniform1f(_,S.u_opacity)}},fillExtrusionPattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_lightpos:new E.Uniform3f(_,S.u_lightpos),u_lightintensity:new E.Uniform1f(_,S.u_lightintensity),u_lightcolor:new E.Uniform3f(_,S.u_lightcolor),u_vertical_gradient:new E.Uniform1f(_,S.u_vertical_gradient),u_height_factor:new E.Uniform1f(_,S.u_height_factor),u_image:new E.Uniform1i(_,S.u_image),u_texsize:new E.Uniform2f(_,S.u_texsize),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade),u_opacity:new E.Uniform1f(_,S.u_opacity)}},fill:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},fillPattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_image:new E.Uniform1i(_,S.u_image),u_texsize:new E.Uniform2f(_,S.u_texsize),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade)}},fillOutline:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_world:new E.Uniform2f(_,S.u_world)}},fillOutlinePattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_world:new E.Uniform2f(_,S.u_world),u_image:new E.Uniform1i(_,S.u_image),u_texsize:new E.Uniform2f(_,S.u_texsize),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade)}},circle:function(_,S){return{u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_scale_with_map:new E.Uniform1i(_,S.u_scale_with_map),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_extrude_scale:new E.Uniform2f(_,S.u_extrude_scale),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},collisionBox:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pixels_to_tile_units:new E.Uniform1f(_,S.u_pixels_to_tile_units),u_extrude_scale:new E.Uniform2f(_,S.u_extrude_scale),u_overscale_factor:new E.Uniform1f(_,S.u_overscale_factor)}},collisionCircle:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_inv_matrix:new E.UniformMatrix4f(_,S.u_inv_matrix),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_viewport_size:new E.Uniform2f(_,S.u_viewport_size)}},debug:function(_,S){return{u_color:new E.UniformColor(_,S.u_color),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_overlay:new E.Uniform1i(_,S.u_overlay),u_overlay_scale:new E.Uniform1f(_,S.u_overlay_scale)}},clippingMask:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},heatmap:function(_,S){return{u_extrude_scale:new E.Uniform1f(_,S.u_extrude_scale),u_intensity:new E.Uniform1f(_,S.u_intensity),u_matrix:new E.UniformMatrix4f(_,S.u_matrix)}},heatmapTexture:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_world:new E.Uniform2f(_,S.u_world),u_image:new E.Uniform1i(_,S.u_image),u_color_ramp:new E.Uniform1i(_,S.u_color_ramp),u_opacity:new E.Uniform1f(_,S.u_opacity)}},hillshade:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_image:new E.Uniform1i(_,S.u_image),u_latrange:new E.Uniform2f(_,S.u_latrange),u_light:new E.Uniform2f(_,S.u_light),u_shadow:new E.UniformColor(_,S.u_shadow),u_highlight:new E.UniformColor(_,S.u_highlight),u_accent:new E.UniformColor(_,S.u_accent)}},hillshadePrepare:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_image:new E.Uniform1i(_,S.u_image),u_dimension:new E.Uniform2f(_,S.u_dimension),u_zoom:new E.Uniform1f(_,S.u_zoom),u_unpack:new E.Uniform4f(_,S.u_unpack)}},line:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels)}},lineGradient:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels),u_image:new E.Uniform1i(_,S.u_image),u_image_height:new E.Uniform1f(_,S.u_image_height)}},linePattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_texsize:new E.Uniform2f(_,S.u_texsize),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_image:new E.Uniform1i(_,S.u_image),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels),u_scale:new E.Uniform3f(_,S.u_scale),u_fade:new E.Uniform1f(_,S.u_fade)}},lineSDF:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_ratio:new E.Uniform1f(_,S.u_ratio),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_units_to_pixels:new E.Uniform2f(_,S.u_units_to_pixels),u_patternscale_a:new E.Uniform2f(_,S.u_patternscale_a),u_patternscale_b:new E.Uniform2f(_,S.u_patternscale_b),u_sdfgamma:new E.Uniform1f(_,S.u_sdfgamma),u_image:new E.Uniform1i(_,S.u_image),u_tex_y_a:new E.Uniform1f(_,S.u_tex_y_a),u_tex_y_b:new E.Uniform1f(_,S.u_tex_y_b),u_mix:new E.Uniform1f(_,S.u_mix)}},raster:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_tl_parent:new E.Uniform2f(_,S.u_tl_parent),u_scale_parent:new E.Uniform1f(_,S.u_scale_parent),u_buffer_scale:new E.Uniform1f(_,S.u_buffer_scale),u_fade_t:new E.Uniform1f(_,S.u_fade_t),u_opacity:new E.Uniform1f(_,S.u_opacity),u_image0:new E.Uniform1i(_,S.u_image0),u_image1:new E.Uniform1i(_,S.u_image1),u_brightness_low:new E.Uniform1f(_,S.u_brightness_low),u_brightness_high:new E.Uniform1f(_,S.u_brightness_high),u_saturation_factor:new E.Uniform1f(_,S.u_saturation_factor),u_contrast_factor:new E.Uniform1f(_,S.u_contrast_factor),u_spin_weights:new E.Uniform3f(_,S.u_spin_weights)}},symbolIcon:function(_,S){return{u_is_size_zoom_constant:new E.Uniform1i(_,S.u_is_size_zoom_constant),u_is_size_feature_constant:new E.Uniform1i(_,S.u_is_size_feature_constant),u_size_t:new E.Uniform1f(_,S.u_size_t),u_size:new E.Uniform1f(_,S.u_size),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pitch:new E.Uniform1f(_,S.u_pitch),u_rotate_symbol:new E.Uniform1i(_,S.u_rotate_symbol),u_aspect_ratio:new E.Uniform1f(_,S.u_aspect_ratio),u_fade_change:new E.Uniform1f(_,S.u_fade_change),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_label_plane_matrix:new E.UniformMatrix4f(_,S.u_label_plane_matrix),u_coord_matrix:new E.UniformMatrix4f(_,S.u_coord_matrix),u_is_text:new E.Uniform1i(_,S.u_is_text),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_texsize:new E.Uniform2f(_,S.u_texsize),u_texture:new E.Uniform1i(_,S.u_texture)}},symbolSDF:function(_,S){return{u_is_size_zoom_constant:new E.Uniform1i(_,S.u_is_size_zoom_constant),u_is_size_feature_constant:new E.Uniform1i(_,S.u_is_size_feature_constant),u_size_t:new E.Uniform1f(_,S.u_size_t),u_size:new E.Uniform1f(_,S.u_size),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pitch:new E.Uniform1f(_,S.u_pitch),u_rotate_symbol:new E.Uniform1i(_,S.u_rotate_symbol),u_aspect_ratio:new E.Uniform1f(_,S.u_aspect_ratio),u_fade_change:new E.Uniform1f(_,S.u_fade_change),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_label_plane_matrix:new E.UniformMatrix4f(_,S.u_label_plane_matrix),u_coord_matrix:new E.UniformMatrix4f(_,S.u_coord_matrix),u_is_text:new E.Uniform1i(_,S.u_is_text),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_texsize:new E.Uniform2f(_,S.u_texsize),u_texture:new E.Uniform1i(_,S.u_texture),u_gamma_scale:new E.Uniform1f(_,S.u_gamma_scale),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_is_halo:new E.Uniform1i(_,S.u_is_halo)}},symbolTextAndIcon:function(_,S){return{u_is_size_zoom_constant:new E.Uniform1i(_,S.u_is_size_zoom_constant),u_is_size_feature_constant:new E.Uniform1i(_,S.u_is_size_feature_constant),u_size_t:new E.Uniform1f(_,S.u_size_t),u_size:new E.Uniform1f(_,S.u_size),u_camera_to_center_distance:new E.Uniform1f(_,S.u_camera_to_center_distance),u_pitch:new E.Uniform1f(_,S.u_pitch),u_rotate_symbol:new E.Uniform1i(_,S.u_rotate_symbol),u_aspect_ratio:new E.Uniform1f(_,S.u_aspect_ratio),u_fade_change:new E.Uniform1f(_,S.u_fade_change),u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_label_plane_matrix:new E.UniformMatrix4f(_,S.u_label_plane_matrix),u_coord_matrix:new E.UniformMatrix4f(_,S.u_coord_matrix),u_is_text:new E.Uniform1i(_,S.u_is_text),u_pitch_with_map:new E.Uniform1i(_,S.u_pitch_with_map),u_texsize:new E.Uniform2f(_,S.u_texsize),u_texsize_icon:new E.Uniform2f(_,S.u_texsize_icon),u_texture:new E.Uniform1i(_,S.u_texture),u_texture_icon:new E.Uniform1i(_,S.u_texture_icon),u_gamma_scale:new E.Uniform1f(_,S.u_gamma_scale),u_device_pixel_ratio:new E.Uniform1f(_,S.u_device_pixel_ratio),u_is_halo:new E.Uniform1i(_,S.u_is_halo)}},background:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_opacity:new E.Uniform1f(_,S.u_opacity),u_color:new E.UniformColor(_,S.u_color)}},backgroundPattern:function(_,S){return{u_matrix:new E.UniformMatrix4f(_,S.u_matrix),u_opacity:new E.Uniform1f(_,S.u_opacity),u_image:new E.Uniform1i(_,S.u_image),u_pattern_tl_a:new E.Uniform2f(_,S.u_pattern_tl_a),u_pattern_br_a:new E.Uniform2f(_,S.u_pattern_br_a),u_pattern_tl_b:new E.Uniform2f(_,S.u_pattern_tl_b),u_pattern_br_b:new E.Uniform2f(_,S.u_pattern_br_b),u_texsize:new E.Uniform2f(_,S.u_texsize),u_mix:new E.Uniform1f(_,S.u_mix),u_pattern_size_a:new E.Uniform2f(_,S.u_pattern_size_a),u_pattern_size_b:new E.Uniform2f(_,S.u_pattern_size_b),u_scale_a:new E.Uniform1f(_,S.u_scale_a),u_scale_b:new E.Uniform1f(_,S.u_scale_b),u_pixel_coord_upper:new E.Uniform2f(_,S.u_pixel_coord_upper),u_pixel_coord_lower:new E.Uniform2f(_,S.u_pixel_coord_lower),u_tile_units_to_pixels:new E.Uniform1f(_,S.u_tile_units_to_pixels)}}};function bu(_,S,x,C,k,G,q){for(var de=_.context,ze=de.gl,it=_.useProgram("collisionBox"),Bt=[],St=0,Xt=0,En=0;En<C.length;En++){var yn=C[En],Un=S.getTile(yn),cn=Un.getBucket(x);if(cn){var Rn=yn.posMatrix;k[0]===0&&k[1]===0||(Rn=_.translatePosMatrix(yn.posMatrix,Un,k,G));var Jn=q?cn.textCollisionBox:cn.iconCollisionBox,hr=cn.collisionCircleArray;if(hr.length>0){var Lr=E.create(),gr=Rn;E.mul(Lr,cn.placementInvProjMatrix,_.transform.glCoordMatrix),E.mul(Lr,Lr,cn.placementViewportMatrix),Bt.push({circleArray:hr,circleOffset:Xt,transform:gr,invTransform:Lr}),Xt=St+=hr.length/4}Jn&&it.draw(de,ze.LINES,et.disabled,wt.disabled,_.colorModeForRenderPass(),vn.disabled,Mr(Rn,_.transform,Un),x.id,Jn.layoutVertexBuffer,Jn.indexBuffer,Jn.segments,null,_.transform.zoom,null,null,Jn.collisionVertexBuffer)}}if(q&&Bt.length){var Dr=_.useProgram("collisionCircle"),Fr=new E.StructArrayLayout2f1f2i16;Fr.resize(4*St),Fr._trim();for(var Mi=0,Pi=0,vi=Bt;Pi<vi.length;Pi+=1)for(var Oo=vi[Pi],yo=0;yo<Oo.circleArray.length/4;yo++){var Ho=4*yo,is=Oo.circleArray[Ho+0],Cr=Oo.circleArray[Ho+1],Kt=Oo.circleArray[Ho+2],Zr=Oo.circleArray[Ho+3];Fr.emplace(Mi++,is,Cr,Kt,Zr,0),Fr.emplace(Mi++,is,Cr,Kt,Zr,1),Fr.emplace(Mi++,is,Cr,Kt,Zr,2),Fr.emplace(Mi++,is,Cr,Kt,Zr,3)}(!Da||Da.length<2*St)&&(Da=function(bl){var zc=2*bl,ic=new E.StructArrayLayout3ui6;ic.resize(zc),ic._trim();for(var Rs=0;Rs<zc;Rs++){var ll=6*Rs;ic.uint16[ll+0]=4*Rs+0,ic.uint16[ll+1]=4*Rs+1,ic.uint16[ll+2]=4*Rs+2,ic.uint16[ll+3]=4*Rs+2,ic.uint16[ll+4]=4*Rs+3,ic.uint16[ll+5]=4*Rs+0}return ic}(St));for(var ko=de.createIndexBuffer(Da,!0),qo=de.createVertexBuffer(Fr,E.collisionCircleLayout.members,!0),va=0,na=Bt;va<na.length;va+=1){var Vo=na[va],sl=Bi(Vo.transform,Vo.invTransform,_.transform);Dr.draw(de,ze.TRIANGLES,et.disabled,wt.disabled,_.colorModeForRenderPass(),vn.disabled,sl,x.id,qo,ko,E.SegmentVector.simpleSegment(0,2*Vo.circleOffset,Vo.circleArray.length,Vo.circleArray.length/2),null,_.transform.zoom,null,null,null)}qo.destroy(),ko.destroy()}}var Nc=E.identity(new Float32Array(16));function Qf(_,S,x,C,k,G){var q=E.getAnchorAlignment(_),de=-(q.horizontalAlign-.5)*S,ze=-(q.verticalAlign-.5)*x,it=E.evaluateVariableOffset(_,C);return new E.Point((de/k+it[0])*G,(ze/k+it[1])*G)}function xd(_,S,x,C,k,G,q,de,ze,it,Bt){var St=_.text.placedSymbolArray,Xt=_.text.dynamicLayoutVertexArray,En=_.icon.dynamicLayoutVertexArray,yn={};Xt.clear();for(var Un=0;Un<St.length;Un++){var cn=St.get(Un),Rn=cn.hidden||!cn.crossTileID||_.allowVerticalPlacement&&!cn.placedOrientation?null:C[cn.crossTileID];if(Rn){var Jn=new E.Point(cn.anchorX,cn.anchorY),hr=kn(Jn,x?de:q),Lr=pn(G.cameraToCenterDistance,hr.signedDistanceFromCamera),gr=k.evaluateSizeForFeature(_.textSizeData,it,cn)*Lr/E.ONE_EM;x&&(gr*=_.tilePixelRatio/ze);for(var Dr=Qf(Rn.anchor,Rn.width,Rn.height,Rn.textOffset,Rn.textBoxScale,gr),Fr=x?kn(Jn.add(Dr),q).point:hr.point.add(S?Dr.rotate(-G.angle):Dr),Mi=_.allowVerticalPlacement&&cn.placedOrientation===E.WritingMode.vertical?Math.PI/2:0,Pi=0;Pi<cn.numGlyphs;Pi++)E.addDynamicAttributes(Xt,Fr,Mi);Bt&&cn.associatedIconIndex>=0&&(yn[cn.associatedIconIndex]={shiftedAnchor:Fr,angle:Mi})}else Di(cn.numGlyphs,Xt)}if(Bt){En.clear();for(var vi=_.icon.placedSymbolArray,Oo=0;Oo<vi.length;Oo++){var yo=vi.get(Oo);if(yo.hidden)Di(yo.numGlyphs,En);else{var Ho=yn[Oo];if(Ho)for(var is=0;is<yo.numGlyphs;is++)E.addDynamicAttributes(En,Ho.shiftedAnchor,Ho.angle);else Di(yo.numGlyphs,En)}}_.icon.dynamicLayoutVertexBuffer.updateData(En)}_.text.dynamicLayoutVertexBuffer.updateData(Xt)}function bh(_,S,x){return x.iconsInText&&S?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function yf(_,S,x,C,k,G,q,de,ze,it,Bt,St){for(var Xt=_.context,En=Xt.gl,yn=_.transform,Un=de==="map",cn=ze==="map",Rn=Un&&x.layout.get("symbol-placement")!=="point",Jn=Un&&!cn&&!Rn,hr=x.layout.get("symbol-sort-key").constantOr(1)!==void 0,Lr=!1,gr=_.depthModeForSublayer(0,et.ReadOnly),Dr=x.layout.get("text-variable-anchor"),Fr=[],Mi=0,Pi=C;Mi<Pi.length;Mi+=1){var vi=Pi[Mi],Oo=S.getTile(vi),yo=Oo.getBucket(x);if(yo){var Ho=k?yo.text:yo.icon;if(Ho&&Ho.segments.get().length){var is=Ho.programConfigurations.get(x.id),Cr=k||yo.sdfIcons,Kt=k?yo.textSizeData:yo.iconSizeData,Zr=cn||yn.pitch!==0,ko=_.useProgram(bh(Cr,k,yo),is),qo=E.evaluateSizeForZoom(Kt,yn.zoom),va=void 0,na=[0,0],Vo=void 0,sl=void 0,bl=null,zc=void 0;if(k)Vo=Oo.glyphAtlasTexture,sl=En.LINEAR,va=Oo.glyphAtlasTexture.size,yo.iconsInText&&(na=Oo.imageAtlasTexture.size,bl=Oo.imageAtlasTexture,zc=Zr||_.options.rotating||_.options.zooming||Kt.kind==="composite"||Kt.kind==="camera"?En.LINEAR:En.NEAREST);else{var ic=x.layout.get("icon-size").constantOr(0)!==1||yo.iconsNeedLinear;Vo=Oo.imageAtlasTexture,sl=Cr||_.options.rotating||_.options.zooming||ic||Zr?En.LINEAR:En.NEAREST,va=Oo.imageAtlasTexture.size}var Rs=Ri(Oo,1,_.transform.zoom),ll=un(vi.posMatrix,cn,Un,_.transform,Rs),Qs=Bn(vi.posMatrix,cn,Un,_.transform,Rs),Tc=Dr&&yo.hasTextData(),Ch=x.layout.get("icon-text-fit")!=="none"&&Tc&&yo.hasIconData();Rn&&vr(yo,vi.posMatrix,_,k,ll,Qs,cn,it);var Il=_.translatePosMatrix(vi.posMatrix,Oo,G,q),cu=Rn||k&&Dr||Ch?Nc:ll,pl=_.translatePosMatrix(Qs,Oo,G,q,!0),$d=Cr&&x.paint.get(k?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Td={program:ko,buffers:Ho,uniformValues:Cr?yo.iconsInText?Qa(Kt.kind,qo,Jn,cn,_,Il,cu,pl,va,na):Ls(Kt.kind,qo,Jn,cn,_,Il,cu,pl,k,va,!0):Xa(Kt.kind,qo,Jn,cn,_,Il,cu,pl,k,va),atlasTexture:Vo,atlasTextureIcon:bl,atlasInterpolation:sl,atlasInterpolationIcon:zc,isSDF:Cr,hasHalo:$d};if(hr&&yo.canOverlap){Lr=!0;for(var Oh=0,Sf=Ho.segments.get();Oh<Sf.length;Oh+=1){var Qh=Sf[Oh];Fr.push({segments:new E.SegmentVector([Qh]),sortKey:Qh.sortKey,state:Td})}}else Fr.push({segments:Ho.segments,sortKey:0,state:Td})}}}Lr&&Fr.sort(function(os,Ns){return os.sortKey-Ns.sortKey});for(var Rh=0,Ti=Fr;Rh<Ti.length;Rh+=1){var ml=Ti[Rh],Ll=ml.state;if(Xt.activeTexture.set(En.TEXTURE0),Ll.atlasTexture.bind(Ll.atlasInterpolation,En.CLAMP_TO_EDGE),Ll.atlasTextureIcon&&(Xt.activeTexture.set(En.TEXTURE1),Ll.atlasTextureIcon&&Ll.atlasTextureIcon.bind(Ll.atlasInterpolationIcon,En.CLAMP_TO_EDGE)),Ll.isSDF){var Kc=Ll.uniformValues;Ll.hasHalo&&(Kc.u_is_halo=1,tf(Ll.buffers,ml.segments,x,_,Ll.program,gr,Bt,St,Kc)),Kc.u_is_halo=0}tf(Ll.buffers,ml.segments,x,_,Ll.program,gr,Bt,St,Ll.uniformValues)}}function tf(_,S,x,C,k,G,q,de,ze){var it=C.context;k.draw(it,it.gl.TRIANGLES,G,q,de,vn.disabled,ze,x.id,_.layoutVertexBuffer,_.indexBuffer,S,x.paint,C.transform.zoom,_.programConfigurations.get(x.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function Gh(_,S,x,C,k,G,q){var de,ze,it,Bt,St,Xt=_.context.gl,En=x.paint.get("fill-pattern"),yn=En&&En.constantOr(1),Un=x.getCrossfadeParameters();q?(ze=yn&&!x.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",de=Xt.LINES):(ze=yn?"fillPattern":"fill",de=Xt.TRIANGLES);for(var cn=0,Rn=C;cn<Rn.length;cn+=1){var Jn=Rn[cn],hr=S.getTile(Jn);if(!yn||hr.patternsLoaded()){var Lr=hr.getBucket(x);if(Lr){var gr=Lr.programConfigurations.get(x.id),Dr=_.useProgram(ze,gr);yn&&(_.context.activeTexture.set(Xt.TEXTURE0),hr.imageAtlasTexture.bind(Xt.LINEAR,Xt.CLAMP_TO_EDGE),gr.updatePaintBuffers(Un));var Fr=En.constantOr(null);if(Fr&&hr.imageAtlas){var Mi=hr.imageAtlas,Pi=Mi.patternPositions[Fr.to.toString()],vi=Mi.patternPositions[Fr.from.toString()];Pi&&vi&&gr.setConstantPatternPositions(Pi,vi)}var Oo=_.translatePosMatrix(Jn.posMatrix,hr,x.paint.get("fill-translate"),x.paint.get("fill-translate-anchor"));if(q){Bt=Lr.indexBuffer2,St=Lr.segments2;var yo=[Xt.drawingBufferWidth,Xt.drawingBufferHeight];it=ze==="fillOutlinePattern"&&yn?K(Oo,_,Un,hr,yo):mn(Oo,yo)}else Bt=Lr.indexBuffer,St=Lr.segments,it=yn?qe(Oo,_,Un,hr):ge(Oo);Dr.draw(_.context,de,k,_.stencilModeForClipping(Jn),G,vn.disabled,it,x.id,Lr.layoutVertexBuffer,Bt,St,x.paint,_.transform.zoom,gr)}}}}function xh(_,S,x,C,k,G,q){for(var de=_.context,ze=de.gl,it=x.paint.get("fill-extrusion-pattern"),Bt=it.constantOr(1),St=x.getCrossfadeParameters(),Xt=x.paint.get("fill-extrusion-opacity"),En=0,yn=C;En<yn.length;En+=1){var Un=yn[En],cn=S.getTile(Un),Rn=cn.getBucket(x);if(Rn){var Jn=Rn.programConfigurations.get(x.id),hr=_.useProgram(Bt?"fillExtrusionPattern":"fillExtrusion",Jn);Bt&&(_.context.activeTexture.set(ze.TEXTURE0),cn.imageAtlasTexture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),Jn.updatePaintBuffers(St));var Lr=it.constantOr(null);if(Lr&&cn.imageAtlas){var gr=cn.imageAtlas,Dr=gr.patternPositions[Lr.to.toString()],Fr=gr.patternPositions[Lr.from.toString()];Dr&&Fr&&Jn.setConstantPatternPositions(Dr,Fr)}var Mi=_.translatePosMatrix(Un.posMatrix,cn,x.paint.get("fill-extrusion-translate"),x.paint.get("fill-extrusion-translate-anchor")),Pi=x.paint.get("fill-extrusion-vertical-gradient"),vi=Bt?ne(Mi,_,Pi,Xt,Un,St,cn):_h(Mi,_,Pi,Xt);hr.draw(de,de.gl.TRIANGLES,k,G,q,vn.backCCW,vi,x.id,Rn.layoutVertexBuffer,Rn.indexBuffer,Rn.segments,x.paint,_.transform.zoom,Jn)}}}function Fu(_,S,x,C,k,G){var q=_.context,de=q.gl,ze=S.fbo;if(ze){var it=_.useProgram("hillshade");q.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,ze.colorAttachment.get());var Bt=function(St,Xt,En){var yn=En.paint.get("hillshade-shadow-color"),Un=En.paint.get("hillshade-highlight-color"),cn=En.paint.get("hillshade-accent-color"),Rn=En.paint.get("hillshade-illumination-direction")*(Math.PI/180);En.paint.get("hillshade-illumination-anchor")==="viewport"&&(Rn-=St.transform.angle);var Jn,hr,Lr,gr=!St.options.moving;return{u_matrix:St.transform.calculatePosMatrix(Xt.tileID.toUnwrapped(),gr),u_image:0,u_latrange:(Jn=Xt.tileID,hr=Math.pow(2,Jn.canonical.z),Lr=Jn.canonical.y,[new E.MercatorCoordinate(0,Lr/hr).toLngLat().lat,new E.MercatorCoordinate(0,(Lr+1)/hr).toLngLat().lat]),u_light:[En.paint.get("hillshade-exaggeration"),Rn],u_shadow:yn,u_highlight:Un,u_accent:cn}}(_,S,x);it.draw(q,de.TRIANGLES,C,k,G,vn.disabled,Bt,x.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}}function n0(_,S,x,C,k,G){var q=_.context,de=q.gl,ze=S.dem;if(ze&&ze.data){var it=ze.dim,Bt=ze.stride,St=ze.getPixels();if(q.activeTexture.set(de.TEXTURE1),q.pixelStoreUnpackPremultiplyAlpha.set(!1),S.demTexture=S.demTexture||_.getTileTexture(Bt),S.demTexture){var Xt=S.demTexture;Xt.update(St,{premultiply:!1}),Xt.bind(de.NEAREST,de.CLAMP_TO_EDGE)}else S.demTexture=new E.Texture(q,St,de.RGBA,{premultiply:!1}),S.demTexture.bind(de.NEAREST,de.CLAMP_TO_EDGE);q.activeTexture.set(de.TEXTURE0);var En=S.fbo;if(!En){var yn=new E.Texture(q,{width:it,height:it,data:null},de.RGBA);yn.bind(de.LINEAR,de.CLAMP_TO_EDGE),(En=S.fbo=q.createFramebuffer(it,it,!0)).colorAttachment.set(yn.texture)}q.bindFramebuffer.set(En.framebuffer),q.viewport.set([0,0,it,it]),_.useProgram("hillshadePrepare").draw(q,de.TRIANGLES,C,k,G,vn.disabled,function(Un,cn){var Rn=cn.stride,Jn=E.create();return E.ortho(Jn,0,E.EXTENT,-E.EXTENT,0,0,1),E.translate(Jn,Jn,[0,-E.EXTENT,0]),{u_matrix:Jn,u_image:1,u_dimension:[Rn,Rn],u_zoom:Un.overscaledZ,u_unpack:cn.getUnpackVector()}}(S.tileID,ze),x.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),S.needsHillshadePrepare=!1}}function Jf(_,S,x,C,k){var G=C.paint.get("raster-fade-duration");if(G>0){var q=E.browser.now(),de=(q-_.timeAdded)/G,ze=S?(q-S.timeAdded)/G:-1,it=x.getSource(),Bt=k.coveringZoomLevel({tileSize:it.tileSize,roundZoom:it.roundZoom}),St=!S||Math.abs(S.tileID.overscaledZ-Bt)>Math.abs(_.tileID.overscaledZ-Bt),Xt=St&&_.refreshedUponExpiration?1:E.clamp(St?de:1-ze,0,1);return _.refreshedUponExpiration&&de>=1&&(_.refreshedUponExpiration=!1),S?{opacity:1,mix:1-Xt}:{opacity:Xt,mix:0}}return{opacity:1,mix:0}}var xp=new E.Color(1,0,0,1),Ed=new E.Color(0,1,0,1),Bc=new E.Color(0,0,1,1),Xh=new E.Color(1,0,1,1),Zd=new E.Color(0,1,1,1);function Eh(_,S,x,C){xu(_,0,S+x/2,_.transform.width,x,C)}function Yh(_,S,x,C){xu(_,S-x/2,0,x,_.transform.height,C)}function xu(_,S,x,C,k,G){var q=_.context,de=q.gl;de.enable(de.SCISSOR_TEST),de.scissor(S*E.browser.devicePixelRatio,x*E.browser.devicePixelRatio,C*E.browser.devicePixelRatio,k*E.browser.devicePixelRatio),q.clear({color:G}),de.disable(de.SCISSOR_TEST)}function Sh(_,S,x){var C=_.context,k=C.gl,G=x.posMatrix,q=_.useProgram("debug"),de=et.disabled,ze=wt.disabled,it=_.colorModeForRenderPass();C.activeTexture.set(k.TEXTURE0),_.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),q.draw(C,k.LINE_STRIP,de,ze,it,vn.disabled,zi(G,E.Color.red),"$debug",_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments);var Bt=S.getTileByID(x.key).latestRawTileData,St=Math.floor((Bt&&Bt.byteLength||0)/1024),Xt=S.getTile(x).tileSize,En=512/Math.min(Xt,512)*(x.overscaledZ/_.transform.zoom)*.5,yn=x.canonical.toString();x.overscaledZ!==x.canonical.z&&(yn+=" => "+x.overscaledZ),function(Un,cn){Un.initDebugOverlayCanvas();var Rn=Un.debugOverlayCanvas,Jn=Un.context.gl,hr=Un.debugOverlayCanvas.getContext("2d");hr.clearRect(0,0,Rn.width,Rn.height),hr.shadowColor="white",hr.shadowBlur=2,hr.lineWidth=1.5,hr.strokeStyle="white",hr.textBaseline="top",hr.font="bold 36px Open Sans, sans-serif",hr.fillText(cn,5,5),hr.strokeText(cn,5,5),Un.debugOverlayTexture.update(Rn),Un.debugOverlayTexture.bind(Jn.LINEAR,Jn.CLAMP_TO_EDGE)}(_,yn+" "+St+"kb"),q.draw(C,k.TRIANGLES,de,ze,qt.alphaBlended,vn.disabled,zi(G,E.Color.transparent,En),"$debug",_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments)}var _f={symbol:function(_,S,x,C,k){if(_.renderPass==="translucent"){var G=wt.disabled,q=_.colorModeForRenderPass();x.layout.get("text-variable-anchor")&&function(de,ze,it,Bt,St,Xt,En){for(var yn=ze.transform,Un=St==="map",cn=Xt==="map",Rn=0,Jn=de;Rn<Jn.length;Rn+=1){var hr=Jn[Rn],Lr=Bt.getTile(hr),gr=Lr.getBucket(it);if(gr&&gr.text&&gr.text.segments.get().length){var Dr=E.evaluateSizeForZoom(gr.textSizeData,yn.zoom),Fr=Ri(Lr,1,ze.transform.zoom),Mi=un(hr.posMatrix,cn,Un,ze.transform,Fr),Pi=it.layout.get("icon-text-fit")!=="none"&&gr.hasIconData();if(Dr){var vi=Math.pow(2,yn.zoom-Lr.tileID.overscaledZ);xd(gr,Un,cn,En,E.symbolSize,yn,Mi,hr.posMatrix,vi,Dr,Pi)}}}}(C,_,x,S,x.layout.get("text-rotation-alignment"),x.layout.get("text-pitch-alignment"),k),x.paint.get("icon-opacity").constantOr(1)!==0&&yf(_,S,x,C,!1,x.paint.get("icon-translate"),x.paint.get("icon-translate-anchor"),x.layout.get("icon-rotation-alignment"),x.layout.get("icon-pitch-alignment"),x.layout.get("icon-keep-upright"),G,q),x.paint.get("text-opacity").constantOr(1)!==0&&yf(_,S,x,C,!0,x.paint.get("text-translate"),x.paint.get("text-translate-anchor"),x.layout.get("text-rotation-alignment"),x.layout.get("text-pitch-alignment"),x.layout.get("text-keep-upright"),G,q),S.map.showCollisionBoxes&&(bu(_,S,x,C,x.paint.get("text-translate"),x.paint.get("text-translate-anchor"),!0),bu(_,S,x,C,x.paint.get("icon-translate"),x.paint.get("icon-translate-anchor"),!1))}},circle:function(_,S,x,C){if(_.renderPass==="translucent"){var k=x.paint.get("circle-opacity"),G=x.paint.get("circle-stroke-width"),q=x.paint.get("circle-stroke-opacity"),de=x.layout.get("circle-sort-key").constantOr(1)!==void 0;if(k.constantOr(1)!==0||G.constantOr(1)!==0&&q.constantOr(1)!==0){for(var ze=_.context,it=ze.gl,Bt=_.depthModeForSublayer(0,et.ReadOnly),St=wt.disabled,Xt=_.colorModeForRenderPass(),En=[],yn=0;yn<C.length;yn++){var Un=C[yn],cn=S.getTile(Un),Rn=cn.getBucket(x);if(Rn){var Jn=Rn.programConfigurations.get(x.id),hr={programConfiguration:Jn,program:_.useProgram("circle",Jn),layoutVertexBuffer:Rn.layoutVertexBuffer,indexBuffer:Rn.indexBuffer,uniformValues:tr(_,Un,cn,x)};if(de)for(var Lr=0,gr=Rn.segments.get();Lr<gr.length;Lr+=1){var Dr=gr[Lr];En.push({segments:new E.SegmentVector([Dr]),sortKey:Dr.sortKey,state:hr})}else En.push({segments:Rn.segments,sortKey:0,state:hr})}}de&&En.sort(function(Oo,yo){return Oo.sortKey-yo.sortKey});for(var Fr=0,Mi=En;Fr<Mi.length;Fr+=1){var Pi=Mi[Fr],vi=Pi.state;vi.program.draw(ze,it.TRIANGLES,Bt,St,Xt,vn.disabled,vi.uniformValues,x.id,vi.layoutVertexBuffer,vi.indexBuffer,Pi.segments,x.paint,_.transform.zoom,vi.programConfiguration)}}}},heatmap:function(_,S,x,C){if(x.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){var k=_.context,G=k.gl,q=wt.disabled,de=new qt([G.ONE,G.ONE],E.Color.transparent,[!0,!0,!0,!0]);(function(En,yn,Un){var cn=En.gl;En.activeTexture.set(cn.TEXTURE1),En.viewport.set([0,0,yn.width/4,yn.height/4]);var Rn=Un.heatmapFbo;if(Rn)cn.bindTexture(cn.TEXTURE_2D,Rn.colorAttachment.get()),En.bindFramebuffer.set(Rn.framebuffer);else{var Jn=cn.createTexture();cn.bindTexture(cn.TEXTURE_2D,Jn),cn.texParameteri(cn.TEXTURE_2D,cn.TEXTURE_WRAP_S,cn.CLAMP_TO_EDGE),cn.texParameteri(cn.TEXTURE_2D,cn.TEXTURE_WRAP_T,cn.CLAMP_TO_EDGE),cn.texParameteri(cn.TEXTURE_2D,cn.TEXTURE_MIN_FILTER,cn.LINEAR),cn.texParameteri(cn.TEXTURE_2D,cn.TEXTURE_MAG_FILTER,cn.LINEAR),Rn=Un.heatmapFbo=En.createFramebuffer(yn.width/4,yn.height/4,!1),function(hr,Lr,gr,Dr){var Fr=hr.gl;Fr.texImage2D(Fr.TEXTURE_2D,0,Fr.RGBA,Lr.width/4,Lr.height/4,0,Fr.RGBA,hr.extRenderToTextureHalfFloat?hr.extTextureHalfFloat.HALF_FLOAT_OES:Fr.UNSIGNED_BYTE,null),Dr.colorAttachment.set(gr)}(En,yn,Jn,Rn)}})(k,_,x),k.clear({color:E.Color.transparent});for(var ze=0;ze<C.length;ze++){var it=C[ze];if(!S.hasRenderableParent(it)){var Bt=S.getTile(it),St=Bt.getBucket(x);if(St){var Xt=St.programConfigurations.get(x.id);_.useProgram("heatmap",Xt).draw(k,G.TRIANGLES,et.disabled,q,de,vn.disabled,Si(it.posMatrix,Bt,_.transform.zoom,x.paint.get("heatmap-intensity")),x.id,St.layoutVertexBuffer,St.indexBuffer,St.segments,x.paint,_.transform.zoom,Xt)}}}k.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(En,yn){var Un=En.context,cn=Un.gl,Rn=yn.heatmapFbo;if(Rn){Un.activeTexture.set(cn.TEXTURE0),cn.bindTexture(cn.TEXTURE_2D,Rn.colorAttachment.get()),Un.activeTexture.set(cn.TEXTURE1);var Jn=yn.colorRampTexture;Jn||(Jn=yn.colorRampTexture=new E.Texture(Un,yn.colorRamp,cn.RGBA)),Jn.bind(cn.LINEAR,cn.CLAMP_TO_EDGE),En.useProgram("heatmapTexture").draw(Un,cn.TRIANGLES,et.disabled,wt.disabled,En.colorModeForRenderPass(),vn.disabled,function(hr,Lr,gr,Dr){var Fr=E.create();E.ortho(Fr,0,hr.width,hr.height,0,0,1);var Mi=hr.context.gl;return{u_matrix:Fr,u_world:[Mi.drawingBufferWidth,Mi.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Lr.paint.get("heatmap-opacity")}}(En,yn),yn.id,En.viewportBuffer,En.quadTriangleIndexBuffer,En.viewportSegments,yn.paint,En.transform.zoom)}}(_,x))},line:function(_,S,x,C){if(_.renderPass==="translucent"){var k=x.paint.get("line-opacity"),G=x.paint.get("line-width");if(k.constantOr(1)!==0&&G.constantOr(1)!==0)for(var q=_.depthModeForSublayer(0,et.ReadOnly),de=_.colorModeForRenderPass(),ze=x.paint.get("line-dasharray"),it=x.paint.get("line-pattern"),Bt=it.constantOr(1),St=x.paint.get("line-gradient"),Xt=x.getCrossfadeParameters(),En=Bt?"linePattern":ze?"lineSDF":St?"lineGradient":"line",yn=_.context,Un=yn.gl,cn=!0,Rn=0,Jn=C;Rn<Jn.length;Rn+=1){var hr=Jn[Rn],Lr=S.getTile(hr);if(!Bt||Lr.patternsLoaded()){var gr=Lr.getBucket(x);if(gr){var Dr=gr.programConfigurations.get(x.id),Fr=_.context.program.get(),Mi=_.useProgram(En,Dr),Pi=cn||Mi.program!==Fr,vi=it.constantOr(null);if(vi&&Lr.imageAtlas){var Oo=Lr.imageAtlas,yo=Oo.patternPositions[vi.to.toString()],Ho=Oo.patternPositions[vi.from.toString()];yo&&Ho&&Dr.setConstantPatternPositions(yo,Ho)}var is=Bt?ha(_,Lr,x,Xt):ze?rs(_,Lr,x,ze,Xt):St?Do(_,Lr,x,gr.lineClipsArray.length):Sa(_,Lr,x);if(Bt)yn.activeTexture.set(Un.TEXTURE0),Lr.imageAtlasTexture.bind(Un.LINEAR,Un.CLAMP_TO_EDGE),Dr.updatePaintBuffers(Xt);else if(ze&&(Pi||_.lineAtlas.dirty))yn.activeTexture.set(Un.TEXTURE0),_.lineAtlas.bind(yn);else if(St){var Cr=gr.gradients[x.id],Kt=Cr.texture;if(x.gradientVersion!==Cr.version){var Zr=256;if(x.stepInterpolant){var ko=S.getSource().maxzoom,qo=hr.canonical.z===ko?Math.ceil(1<<_.transform.maxZoom-hr.canonical.z):1;Zr=E.clamp(E.nextPowerOfTwo(gr.maxLineLength/E.EXTENT*1024*qo),256,yn.maxTextureSize)}Cr.gradient=E.renderColorRamp({expression:x.gradientExpression(),evaluationKey:"lineProgress",resolution:Zr,image:Cr.gradient||void 0,clips:gr.lineClipsArray}),Cr.texture?Cr.texture.update(Cr.gradient):Cr.texture=new E.Texture(yn,Cr.gradient,Un.RGBA),Cr.version=x.gradientVersion,Kt=Cr.texture}yn.activeTexture.set(Un.TEXTURE0),Kt.bind(x.stepInterpolant?Un.NEAREST:Un.LINEAR,Un.CLAMP_TO_EDGE)}Mi.draw(yn,Un.TRIANGLES,q,_.stencilModeForClipping(hr),de,vn.disabled,is,x.id,gr.layoutVertexBuffer,gr.indexBuffer,gr.segments,x.paint,_.transform.zoom,Dr,gr.layoutVertexBuffer2),cn=!1}}}}},fill:function(_,S,x,C){var k=x.paint.get("fill-color"),G=x.paint.get("fill-opacity");if(G.constantOr(1)!==0){var q=_.colorModeForRenderPass(),de=x.paint.get("fill-pattern"),ze=_.opaquePassEnabledForLayer()&&!de.constantOr(1)&&k.constantOr(E.Color.transparent).a===1&&G.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===ze){var it=_.depthModeForSublayer(1,_.renderPass==="opaque"?et.ReadWrite:et.ReadOnly);Gh(_,S,x,C,it,q,!1)}if(_.renderPass==="translucent"&&x.paint.get("fill-antialias")){var Bt=_.depthModeForSublayer(x.getPaintProperty("fill-outline-color")?2:0,et.ReadOnly);Gh(_,S,x,C,Bt,q,!0)}}},"fill-extrusion":function(_,S,x,C){var k=x.paint.get("fill-extrusion-opacity");if(k!==0&&_.renderPass==="translucent"){var G=new et(_.context.gl.LEQUAL,et.ReadWrite,_.depthRangeFor3D);if(k!==1||x.paint.get("fill-extrusion-pattern").constantOr(1))xh(_,S,x,C,G,wt.disabled,qt.disabled),xh(_,S,x,C,G,_.stencilModeFor3D(),_.colorModeForRenderPass());else{var q=_.colorModeForRenderPass();xh(_,S,x,C,G,wt.disabled,q)}}},hillshade:function(_,S,x,C){if(_.renderPass==="offscreen"||_.renderPass==="translucent"){for(var k=_.context,G=_.depthModeForSublayer(0,et.ReadOnly),q=_.colorModeForRenderPass(),de=_.renderPass==="translucent"?_.stencilConfigForOverlap(C):[{},C],ze=de[0],it=0,Bt=de[1];it<Bt.length;it+=1){var St=Bt[it],Xt=S.getTile(St);Xt.needsHillshadePrepare&&_.renderPass==="offscreen"?n0(_,Xt,x,G,wt.disabled,q):_.renderPass==="translucent"&&Fu(_,Xt,x,G,ze[St.overscaledZ],q)}k.viewport.set([0,0,_.width,_.height])}},raster:function(_,S,x,C){if(_.renderPass==="translucent"&&x.paint.get("raster-opacity")!==0&&C.length)for(var k=_.context,G=k.gl,q=S.getSource(),de=_.useProgram("raster"),ze=_.colorModeForRenderPass(),it=q instanceof Rt?[{},C]:_.stencilConfigForOverlap(C),Bt=it[0],St=it[1],Xt=St[St.length-1].overscaledZ,En=!_.options.moving,yn=0,Un=St;yn<Un.length;yn+=1){var cn=Un[yn],Rn=_.depthModeForSublayer(cn.overscaledZ-Xt,x.paint.get("raster-opacity")===1?et.ReadWrite:et.ReadOnly,G.LESS),Jn=S.getTile(cn),hr=_.transform.calculatePosMatrix(cn.toUnwrapped(),En);Jn.registerFadeDuration(x.paint.get("raster-fade-duration"));var Lr=S.findLoadedParent(cn,0),gr=Jf(Jn,Lr,S,x,_.transform),Dr=void 0,Fr=void 0,Mi=x.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;k.activeTexture.set(G.TEXTURE0),Jn.texture.bind(Mi,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(G.TEXTURE1),Lr?(Lr.texture.bind(Mi,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),Dr=Math.pow(2,Lr.tileID.overscaledZ-Jn.tileID.overscaledZ),Fr=[Jn.tileID.canonical.x*Dr%1,Jn.tileID.canonical.y*Dr%1]):Jn.texture.bind(Mi,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST);var Pi=ls(hr,Fr||[0,0],Dr||1,gr,x);q instanceof Rt?de.draw(k,G.TRIANGLES,Rn,wt.disabled,ze,vn.disabled,Pi,x.id,q.boundsBuffer,_.quadTriangleIndexBuffer,q.boundsSegments):de.draw(k,G.TRIANGLES,Rn,Bt[cn.overscaledZ],ze,vn.disabled,Pi,x.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}},background:function(_,S,x){var C=x.paint.get("background-color"),k=x.paint.get("background-opacity");if(k!==0){var G=_.context,q=G.gl,de=_.transform,ze=de.tileSize,it=x.paint.get("background-pattern");if(!_.isPatternMissing(it)){var Bt=!it&&C.a===1&&k===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass===Bt){var St=wt.disabled,Xt=_.depthModeForSublayer(0,Bt==="opaque"?et.ReadWrite:et.ReadOnly),En=_.colorModeForRenderPass(),yn=_.useProgram(it?"backgroundPattern":"background"),Un=de.coveringTiles({tileSize:ze});it&&(G.activeTexture.set(q.TEXTURE0),_.imageManager.bind(_.context));for(var cn=x.getCrossfadeParameters(),Rn=0,Jn=Un;Rn<Jn.length;Rn+=1){var hr=Jn[Rn],Lr=_.transform.calculatePosMatrix(hr.toUnwrapped()),gr=it?cs(Lr,k,_,it,{tileID:hr,tileSize:ze},cn):Ec(Lr,k,C);yn.draw(G,q.TRIANGLES,Xt,St,En,vn.disabled,gr,x.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}}}},debug:function(_,S,x){for(var C=0;C<x.length;C++)Sh(_,S,x[C])},custom:function(_,S,x){var C=_.context,k=x.implementation;if(_.renderPass==="offscreen"){var G=k.prerender;G&&(_.setCustomLayerDefaults(),C.setColorMode(_.colorModeForRenderPass()),G.call(k,C.gl,_.transform.customLayerMatrix()),C.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),C.setColorMode(_.colorModeForRenderPass()),C.setStencilMode(wt.disabled);var q=k.renderingMode==="3d"?new et(_.context.gl.LEQUAL,et.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,et.ReadOnly);C.setDepthMode(q),k.render(C.gl,_.transform.customLayerMatrix()),C.setDirty(),_.setBaseState(),C.bindFramebuffer.set(null)}}},ks=function(_,S){this.context=new yt(_),this.transform=S,this._tileTextures={},this.setup(),this.numSublayers=Jt.maxUnderzooming+Jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Nf,this.gpuTimers={}};ks.prototype.resize=function(_,S){if(this.width=_*E.browser.devicePixelRatio,this.height=S*E.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var x=0,C=this.style._order;x<C.length;x+=1)this.style._layers[C[x]].resize()},ks.prototype.setup=function(){var _=this.context,S=new E.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(E.EXTENT,0),S.emplaceBack(0,E.EXTENT),S.emplaceBack(E.EXTENT,E.EXTENT),this.tileExtentBuffer=_.createVertexBuffer(S,Xs.members),this.tileExtentSegments=E.SegmentVector.simpleSegment(0,0,4,2);var x=new E.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(E.EXTENT,0),x.emplaceBack(0,E.EXTENT),x.emplaceBack(E.EXTENT,E.EXTENT),this.debugBuffer=_.createVertexBuffer(x,Xs.members),this.debugSegments=E.SegmentVector.simpleSegment(0,0,4,5);var C=new E.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(E.EXTENT,0,E.EXTENT,0),C.emplaceBack(0,E.EXTENT,0,E.EXTENT),C.emplaceBack(E.EXTENT,E.EXTENT,E.EXTENT,E.EXTENT),this.rasterBoundsBuffer=_.createVertexBuffer(C,Xe.members),this.rasterBoundsSegments=E.SegmentVector.simpleSegment(0,0,4,2);var k=new E.StructArrayLayout2i4;k.emplaceBack(0,0),k.emplaceBack(1,0),k.emplaceBack(0,1),k.emplaceBack(1,1),this.viewportBuffer=_.createVertexBuffer(k,Xs.members),this.viewportSegments=E.SegmentVector.simpleSegment(0,0,4,2);var G=new E.StructArrayLayout1ui2;G.emplaceBack(0),G.emplaceBack(1),G.emplaceBack(3),G.emplaceBack(2),G.emplaceBack(0),this.tileBorderIndexBuffer=_.createIndexBuffer(G);var q=new E.StructArrayLayout3ui6;q.emplaceBack(0,1,2),q.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=_.createIndexBuffer(q),this.emptyTexture=new E.Texture(_,{width:1,height:1,data:new Uint8Array([0,0,0,0])},_.gl.RGBA);var de=this.context.gl;this.stencilClearMode=new wt({func:de.ALWAYS,mask:0},0,255,de.ZERO,de.ZERO,de.ZERO)},ks.prototype.clearStencil=function(){var _=this.context,S=_.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var x=E.create();E.ortho(x,0,this.width,this.height,0,0,1),E.scale(x,x,[S.drawingBufferWidth,S.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(_,S.TRIANGLES,et.disabled,this.stencilClearMode,qt.disabled,vn.disabled,so(x),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ks.prototype._renderTileClippingMasks=function(_,S){if(this.currentStencilSource!==_.source&&_.isTileClipped()&&S&&S.length){this.currentStencilSource=_.source;var x=this.context,C=x.gl;this.nextStencilID+S.length>256&&this.clearStencil(),x.setColorMode(qt.disabled),x.setDepthMode(et.disabled);var k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var G=0,q=S;G<q.length;G+=1){var de=q[G],ze=this._tileClippingMaskIDs[de.key]=this.nextStencilID++;k.draw(x,C.TRIANGLES,et.disabled,new wt({func:C.ALWAYS,mask:0},ze,255,C.KEEP,C.KEEP,C.REPLACE),qt.disabled,vn.disabled,so(de.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ks.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var _=this.nextStencilID++,S=this.context.gl;return new wt({func:S.NOTEQUAL,mask:255},_,255,S.KEEP,S.KEEP,S.REPLACE)},ks.prototype.stencilModeForClipping=function(_){var S=this.context.gl;return new wt({func:S.EQUAL,mask:255},this._tileClippingMaskIDs[_.key],0,S.KEEP,S.KEEP,S.REPLACE)},ks.prototype.stencilConfigForOverlap=function(_){var S,x=this.context.gl,C=_.sort(function(ze,it){return it.overscaledZ-ze.overscaledZ}),k=C[C.length-1].overscaledZ,G=C[0].overscaledZ-k+1;if(G>1){this.currentStencilSource=void 0,this.nextStencilID+G>256&&this.clearStencil();for(var q={},de=0;de<G;de++)q[de+k]=new wt({func:x.GEQUAL,mask:255},de+this.nextStencilID,255,x.KEEP,x.KEEP,x.REPLACE);return this.nextStencilID+=G,[q,C]}return[(S={},S[k]=wt.disabled,S),C]},ks.prototype.colorModeForRenderPass=function(){var _=this.context.gl;return this._showOverdrawInspector?new qt([_.CONSTANT_COLOR,_.ONE],new E.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qt.unblended:qt.alphaBlended},ks.prototype.depthModeForSublayer=function(_,S,x){if(!this.opaquePassEnabledForLayer())return et.disabled;var C=1-((1+this.currentLayer)*this.numSublayers+_)*this.depthEpsilon;return new et(x||this.context.gl.LEQUAL,S,[C,C])},ks.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ks.prototype.render=function(_,S){var x=this;this.style=_,this.options=S,this.lineAtlas=_.lineAtlas,this.imageManager=_.imageManager,this.glyphManager=_.glyphManager,this.symbolFadeChange=_.placement.symbolFadeChange(E.browser.now()),this.imageManager.beginFrame();var C=this.style._order,k=this.style.sourceCaches;for(var G in k){var q=k[G];q.used&&q.prepare(this.context)}var de,ze,it={},Bt={},St={};for(var Xt in k){var En=k[Xt];it[Xt]=En.getVisibleCoordinates(),Bt[Xt]=it[Xt].slice().reverse(),St[Xt]=En.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var yn=0;yn<C.length;yn++)if(this.style._layers[C[yn]].is3D()){this.opaquePassCutoff=yn;break}this.renderPass="offscreen";for(var Un=0,cn=C;Un<cn.length;Un+=1){var Rn=this.style._layers[cn[Un]];if(Rn.hasOffscreenPass()&&!Rn.isHidden(this.transform.zoom)){var Jn=Bt[Rn.source];(Rn.type==="custom"||Jn.length)&&this.renderLayer(this,k[Rn.source],Rn,Jn)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:S.showOverdrawInspector?E.Color.black:E.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=S.showOverdrawInspector,this.depthRangeFor3D=[0,1-(_._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){var hr=this.style._layers[C[this.currentLayer]],Lr=k[hr.source],gr=it[hr.source];this._renderTileClippingMasks(hr,gr),this.renderLayer(this,Lr,hr,gr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){var Dr=this.style._layers[C[this.currentLayer]],Fr=k[Dr.source],Mi=(Dr.type==="symbol"?St:Bt)[Dr.source];this._renderTileClippingMasks(Dr,it[Dr.source]),this.renderLayer(this,Fr,Dr,Mi)}this.options.showTileBoundaries&&(E.values(this.style._layers).forEach(function(Pi){Pi.source&&!Pi.isHidden(x.transform.zoom)&&(Pi.source!==(ze&&ze.id)&&(ze=x.style.sourceCaches[Pi.source]),(!de||de.getSource().maxzoom<ze.getSource().maxzoom)&&(de=ze))}),de&&_f.debug(this,de,de.getVisibleCoordinates())),this.options.showPadding&&function(Pi){var vi=Pi.transform.padding;Eh(Pi,Pi.transform.height-(vi.top||0),3,xp),Eh(Pi,vi.bottom||0,3,Ed),Yh(Pi,vi.left||0,3,Bc),Yh(Pi,Pi.transform.width-(vi.right||0),3,Xh);var Oo=Pi.transform.centerPoint;(function(yo,Ho,is,Cr){xu(yo,Ho-1,is-10,2,20,Cr),xu(yo,Ho-10,is-1,20,2,Cr)})(Pi,Oo.x,Pi.transform.height-Oo.y,Zd)}(this),this.context.setDefault()},ks.prototype.renderLayer=function(_,S,x,C){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="custom"||C.length)&&(this.id=x.id,this.gpuTimingStart(x),_f[x.type](_,S,x,C,this.style.placement.variableOffsets),this.gpuTimingEnd())},ks.prototype.gpuTimingStart=function(_){if(this.options.gpuTiming){var S=this.context.extTimerQuery,x=this.gpuTimers[_.id];x||(x=this.gpuTimers[_.id]={calls:0,cpuTime:0,query:S.createQueryEXT()}),x.calls++,S.beginQueryEXT(S.TIME_ELAPSED_EXT,x.query)}},ks.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var _=this.context.extTimerQuery;_.endQueryEXT(_.TIME_ELAPSED_EXT)}},ks.prototype.collectGpuTimers=function(){var _=this.gpuTimers;return this.gpuTimers={},_},ks.prototype.queryGpuTimers=function(_){var S={};for(var x in _){var C=_[x],k=this.context.extTimerQuery,G=k.getQueryObjectEXT(C.query,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(C.query),S[x]=G}return S},ks.prototype.translatePosMatrix=function(_,S,x,C,k){if(!x[0]&&!x[1])return _;var G=k?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(G){var q=Math.sin(G),de=Math.cos(G);x=[x[0]*de-x[1]*q,x[0]*q+x[1]*de]}var ze=[k?x[0]:Ri(S,x[0],this.transform.zoom),k?x[1]:Ri(S,x[1],this.transform.zoom),0],it=new Float32Array(16);return E.translate(it,_,ze),it},ks.prototype.saveTileTexture=function(_){var S=this._tileTextures[_.size[0]];S?S.push(_):this._tileTextures[_.size[0]]=[_]},ks.prototype.getTileTexture=function(_){var S=this._tileTextures[_];return S&&S.length>0?S.pop():null},ks.prototype.isPatternMissing=function(_){if(!_)return!1;if(!_.from||!_.to)return!0;var S=this.imageManager.getPattern(_.from.toString()),x=this.imageManager.getPattern(_.to.toString());return!S||!x},ks.prototype.useProgram=function(_,S){this.cache=this.cache||{};var x=""+_+(S?S.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[x]||(this.cache[x]=new rl(this.context,_,yh[_],S,Bu[_],this._showOverdrawInspector)),this.cache[x]},ks.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ks.prototype.setBaseState=function(){var _=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(_.FUNC_ADD)},ks.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=E.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new E.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},ks.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Wd=function(_,S){this.points=_,this.planes=S};Wd.fromInvProjectionMatrix=function(_,S,x){var C=Math.pow(2,x),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(q){return E.transformMat4([],q,_)}).map(function(q){return E.scale$1([],q,1/q[3]/S*C)}),G=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(q){var de=E.sub([],k[q[0]],k[q[1]]),ze=E.sub([],k[q[2]],k[q[1]]),it=E.normalize([],E.cross([],de,ze)),Bt=-E.dot(it,k[q[1]]);return it.concat(Bt)});return new Wd(k,G)};var Gl=function(_,S){this.min=_,this.max=S,this.center=E.scale$2([],E.add([],this.min,this.max),.5)};Gl.prototype.quadrant=function(_){for(var S=[_%2==0,_<2],x=E.clone$2(this.min),C=E.clone$2(this.max),k=0;k<S.length;k++)x[k]=S[k]?this.min[k]:this.center[k],C[k]=S[k]?this.center[k]:this.max[k];return C[2]=this.max[2],new Gl(x,C)},Gl.prototype.distanceX=function(_){return Math.max(Math.min(this.max[0],_[0]),this.min[0])-_[0]},Gl.prototype.distanceY=function(_){return Math.max(Math.min(this.max[1],_[1]),this.min[1])-_[1]},Gl.prototype.intersects=function(_){for(var S=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],x=!0,C=0;C<_.planes.length;C++){for(var k=_.planes[C],G=0,q=0;q<S.length;q++)G+=E.dot$1(k,S[q])>=0;if(G===0)return 0;G!==S.length&&(x=!1)}if(x)return 2;for(var de=0;de<3;de++){for(var ze=Number.MAX_VALUE,it=-Number.MAX_VALUE,Bt=0;Bt<_.points.length;Bt++){var St=_.points[Bt][de]-this.min[de];ze=Math.min(ze,St),it=Math.max(it,St)}if(it<0||ze>this.max[de]-this.min[de])return 0}return 1};var fe=function(_,S,x,C){if(_===void 0&&(_=0),S===void 0&&(S=0),x===void 0&&(x=0),C===void 0&&(C=0),isNaN(_)||_<0||isNaN(S)||S<0||isNaN(x)||x<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=_,this.bottom=S,this.left=x,this.right=C};fe.prototype.interpolate=function(_,S,x){return S.top!=null&&_.top!=null&&(this.top=E.number(_.top,S.top,x)),S.bottom!=null&&_.bottom!=null&&(this.bottom=E.number(_.bottom,S.bottom,x)),S.left!=null&&_.left!=null&&(this.left=E.number(_.left,S.left,x)),S.right!=null&&_.right!=null&&(this.right=E.number(_.right,S.right,x)),this},fe.prototype.getCenter=function(_,S){var x=E.clamp((this.left+_-this.right)/2,0,_),C=E.clamp((this.top+S-this.bottom)/2,0,S);return new E.Point(x,C)},fe.prototype.equals=function(_){return this.top===_.top&&this.bottom===_.bottom&&this.left===_.left&&this.right===_.right},fe.prototype.clone=function(){return new fe(this.top,this.bottom,this.left,this.right)},fe.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ie=function(_,S,x,C,k){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=k===void 0||k,this._minZoom=_||0,this._maxZoom=S||22,this._minPitch=x==null?0:x,this._maxPitch=C==null?60:C,this.setMaxBounds(),this.width=0,this.height=0,this._center=new E.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fe,this._posMatrixCache={},this._alignedPosMatrixCache={}},ct={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ie.prototype.clone=function(){var _=new Ie(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return _.tileSize=this.tileSize,_.latRange=this.latRange,_.width=this.width,_.height=this.height,_._center=this._center,_.zoom=this.zoom,_.angle=this.angle,_._fov=this._fov,_._pitch=this._pitch,_._unmodified=this._unmodified,_._edgeInsets=this._edgeInsets.clone(),_._calcMatrices(),_},ct.minZoom.get=function(){return this._minZoom},ct.minZoom.set=function(_){this._minZoom!==_&&(this._minZoom=_,this.zoom=Math.max(this.zoom,_))},ct.maxZoom.get=function(){return this._maxZoom},ct.maxZoom.set=function(_){this._maxZoom!==_&&(this._maxZoom=_,this.zoom=Math.min(this.zoom,_))},ct.minPitch.get=function(){return this._minPitch},ct.minPitch.set=function(_){this._minPitch!==_&&(this._minPitch=_,this.pitch=Math.max(this.pitch,_))},ct.maxPitch.get=function(){return this._maxPitch},ct.maxPitch.set=function(_){this._maxPitch!==_&&(this._maxPitch=_,this.pitch=Math.min(this.pitch,_))},ct.renderWorldCopies.get=function(){return this._renderWorldCopies},ct.renderWorldCopies.set=function(_){_===void 0?_=!0:_===null&&(_=!1),this._renderWorldCopies=_},ct.worldSize.get=function(){return this.tileSize*this.scale},ct.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ct.size.get=function(){return new E.Point(this.width,this.height)},ct.bearing.get=function(){return-this.angle/Math.PI*180},ct.bearing.set=function(_){var S=-E.wrap(_,-180,180)*Math.PI/180;this.angle!==S&&(this._unmodified=!1,this.angle=S,this._calcMatrices(),this.rotationMatrix=E.create$2(),E.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ct.pitch.get=function(){return this._pitch/Math.PI*180},ct.pitch.set=function(_){var S=E.clamp(_,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==S&&(this._unmodified=!1,this._pitch=S,this._calcMatrices())},ct.fov.get=function(){return this._fov/Math.PI*180},ct.fov.set=function(_){_=Math.max(.01,Math.min(60,_)),this._fov!==_&&(this._unmodified=!1,this._fov=_/180*Math.PI,this._calcMatrices())},ct.zoom.get=function(){return this._zoom},ct.zoom.set=function(_){var S=Math.min(Math.max(_,this.minZoom),this.maxZoom);this._zoom!==S&&(this._unmodified=!1,this._zoom=S,this.scale=this.zoomScale(S),this.tileZoom=Math.floor(S),this.zoomFraction=S-this.tileZoom,this._constrain(),this._calcMatrices())},ct.center.get=function(){return this._center},ct.center.set=function(_){_.lat===this._center.lat&&_.lng===this._center.lng||(this._unmodified=!1,this._center=_,this._constrain(),this._calcMatrices())},ct.padding.get=function(){return this._edgeInsets.toJSON()},ct.padding.set=function(_){this._edgeInsets.equals(_)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,_,1),this._calcMatrices())},ct.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ie.prototype.isPaddingEqual=function(_){return this._edgeInsets.equals(_)},Ie.prototype.interpolatePadding=function(_,S,x){this._unmodified=!1,this._edgeInsets.interpolate(_,S,x),this._constrain(),this._calcMatrices()},Ie.prototype.coveringZoomLevel=function(_){var S=(_.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/_.tileSize));return Math.max(0,S)},Ie.prototype.getVisibleUnwrappedCoordinates=function(_){var S=[new E.UnwrappedTileID(0,_)];if(this._renderWorldCopies)for(var x=this.pointCoordinate(new E.Point(0,0)),C=this.pointCoordinate(new E.Point(this.width,0)),k=this.pointCoordinate(new E.Point(this.width,this.height)),G=this.pointCoordinate(new E.Point(0,this.height)),q=Math.floor(Math.min(x.x,C.x,k.x,G.x)),de=Math.floor(Math.max(x.x,C.x,k.x,G.x)),ze=q-1;ze<=de+1;ze++)ze!==0&&S.push(new E.UnwrappedTileID(ze,_));return S},Ie.prototype.coveringTiles=function(_){var S=this.coveringZoomLevel(_),x=S;if(_.minzoom!==void 0&&S<_.minzoom)return[];_.maxzoom!==void 0&&S>_.maxzoom&&(S=_.maxzoom);var C=E.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,S),G=[k*C.x,k*C.y,0],q=Wd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,S),de=_.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(de=S);var ze=function(Pi){return{aabb:new Gl([Pi*k,0,0],[(Pi+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Pi,fullyVisible:!1}},it=[],Bt=[],St=S,Xt=_.reparseOverscaled?x:S;if(this._renderWorldCopies)for(var En=1;En<=3;En++)it.push(ze(-En)),it.push(ze(En));for(it.push(ze(0));it.length>0;){var yn=it.pop(),Un=yn.x,cn=yn.y,Rn=yn.fullyVisible;if(!Rn){var Jn=yn.aabb.intersects(q);if(Jn===0)continue;Rn=Jn===2}var hr=yn.aabb.distanceX(G),Lr=yn.aabb.distanceY(G),gr=Math.max(Math.abs(hr),Math.abs(Lr));if(yn.zoom===St||gr>3+(1<<St-yn.zoom)-2&&yn.zoom>=de)Bt.push({tileID:new E.OverscaledTileID(yn.zoom===St?Xt:yn.zoom,yn.wrap,yn.zoom,Un,cn),distanceSq:E.sqrLen([G[0]-.5-Un,G[1]-.5-cn])});else for(var Dr=0;Dr<4;Dr++){var Fr=(Un<<1)+Dr%2,Mi=(cn<<1)+(Dr>>1);it.push({aabb:yn.aabb.quadrant(Dr),zoom:yn.zoom+1,x:Fr,y:Mi,wrap:yn.wrap,fullyVisible:Rn})}}return Bt.sort(function(Pi,vi){return Pi.distanceSq-vi.distanceSq}).map(function(Pi){return Pi.tileID})},Ie.prototype.resize=function(_,S){this.width=_,this.height=S,this.pixelsToGLUnits=[2/_,-2/S],this._constrain(),this._calcMatrices()},ct.unmodified.get=function(){return this._unmodified},Ie.prototype.zoomScale=function(_){return Math.pow(2,_)},Ie.prototype.scaleZoom=function(_){return Math.log(_)/Math.LN2},Ie.prototype.project=function(_){var S=E.clamp(_.lat,-this.maxValidLatitude,this.maxValidLatitude);return new E.Point(E.mercatorXfromLng(_.lng)*this.worldSize,E.mercatorYfromLat(S)*this.worldSize)},Ie.prototype.unproject=function(_){return new E.MercatorCoordinate(_.x/this.worldSize,_.y/this.worldSize).toLngLat()},ct.point.get=function(){return this.project(this.center)},Ie.prototype.setLocationAtPoint=function(_,S){var x=this.pointCoordinate(S),C=this.pointCoordinate(this.centerPoint),k=this.locationCoordinate(_),G=new E.MercatorCoordinate(k.x-(x.x-C.x),k.y-(x.y-C.y));this.center=this.coordinateLocation(G),this._renderWorldCopies&&(this.center=this.center.wrap())},Ie.prototype.locationPoint=function(_){return this.coordinatePoint(this.locationCoordinate(_))},Ie.prototype.pointLocation=function(_){return this.coordinateLocation(this.pointCoordinate(_))},Ie.prototype.locationCoordinate=function(_){return E.MercatorCoordinate.fromLngLat(_)},Ie.prototype.coordinateLocation=function(_){return _.toLngLat()},Ie.prototype.pointCoordinate=function(_){var S=[_.x,_.y,0,1],x=[_.x,_.y,1,1];E.transformMat4(S,S,this.pixelMatrixInverse),E.transformMat4(x,x,this.pixelMatrixInverse);var C=S[3],k=x[3],G=S[1]/C,q=x[1]/k,de=S[2]/C,ze=x[2]/k,it=de===ze?0:(0-de)/(ze-de);return new E.MercatorCoordinate(E.number(S[0]/C,x[0]/k,it)/this.worldSize,E.number(G,q,it)/this.worldSize)},Ie.prototype.coordinatePoint=function(_){var S=[_.x*this.worldSize,_.y*this.worldSize,0,1];return E.transformMat4(S,S,this.pixelMatrix),new E.Point(S[0]/S[3],S[1]/S[3])},Ie.prototype.getBounds=function(){return new E.LngLatBounds().extend(this.pointLocation(new E.Point(0,0))).extend(this.pointLocation(new E.Point(this.width,0))).extend(this.pointLocation(new E.Point(this.width,this.height))).extend(this.pointLocation(new E.Point(0,this.height)))},Ie.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new E.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ie.prototype.setMaxBounds=function(_){_?(this.lngRange=[_.getWest(),_.getEast()],this.latRange=[_.getSouth(),_.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ie.prototype.calculatePosMatrix=function(_,S){S===void 0&&(S=!1);var x=_.key,C=S?this._alignedPosMatrixCache:this._posMatrixCache;if(C[x])return C[x];var k=_.canonical,G=this.worldSize/this.zoomScale(k.z),q=k.x+Math.pow(2,k.z)*_.wrap,de=E.identity(new Float64Array(16));return E.translate(de,de,[q*G,k.y*G,0]),E.scale(de,de,[G/E.EXTENT,G/E.EXTENT,1]),E.multiply(de,S?this.alignedProjMatrix:this.projMatrix,de),C[x]=new Float32Array(de),C[x]},Ie.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ie.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var _,S,x,C,k=-90,G=90,q=-180,de=180,ze=this.size,it=this._unmodified;if(this.latRange){var Bt=this.latRange;k=E.mercatorYfromLat(Bt[1])*this.worldSize,_=(G=E.mercatorYfromLat(Bt[0])*this.worldSize)-k<ze.y?ze.y/(G-k):0}if(this.lngRange){var St=this.lngRange;q=E.mercatorXfromLng(St[0])*this.worldSize,S=(de=E.mercatorXfromLng(St[1])*this.worldSize)-q<ze.x?ze.x/(de-q):0}var Xt=this.point,En=Math.max(S||0,_||0);if(En)return this.center=this.unproject(new E.Point(S?(de+q)/2:Xt.x,_?(G+k)/2:Xt.y)),this.zoom+=this.scaleZoom(En),this._unmodified=it,void(this._constraining=!1);if(this.latRange){var yn=Xt.y,Un=ze.y/2;yn-Un<k&&(C=k+Un),yn+Un>G&&(C=G-Un)}if(this.lngRange){var cn=Xt.x,Rn=ze.x/2;cn-Rn<q&&(x=q+Rn),cn+Rn>de&&(x=de-Rn)}x===void 0&&C===void 0||(this.center=this.unproject(new E.Point(x!==void 0?x:Xt.x,C!==void 0?C:Xt.y))),this._unmodified=it,this._constraining=!1}},Ie.prototype._calcMatrices=function(){if(this.height){var _=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var S=Math.PI/2+this._pitch,x=this._fov*(.5+_.y/this.height),C=Math.sin(x)*this.cameraToCenterDistance/Math.sin(E.clamp(Math.PI-S-x,.01,Math.PI-.01)),k=this.point,G=k.x,q=k.y,de=1.01*(Math.cos(Math.PI/2-this._pitch)*C+this.cameraToCenterDistance),ze=this.height/50,it=new Float64Array(16);E.perspective(it,this._fov,this.width/this.height,ze,de),it[8]=2*-_.x/this.width,it[9]=2*_.y/this.height,E.scale(it,it,[1,-1,1]),E.translate(it,it,[0,0,-this.cameraToCenterDistance]),E.rotateX(it,it,this._pitch),E.rotateZ(it,it,this.angle),E.translate(it,it,[-G,-q,0]),this.mercatorMatrix=E.scale([],it,[this.worldSize,this.worldSize,this.worldSize]),E.scale(it,it,[1,1,E.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=it,this.invProjMatrix=E.invert([],this.projMatrix);var Bt=this.width%2/2,St=this.height%2/2,Xt=Math.cos(this.angle),En=Math.sin(this.angle),yn=G-Math.round(G)+Xt*Bt+En*St,Un=q-Math.round(q)+Xt*St+En*Bt,cn=new Float64Array(it);if(E.translate(cn,cn,[yn>.5?yn-1:yn,Un>.5?Un-1:Un,0]),this.alignedProjMatrix=cn,it=E.create(),E.scale(it,it,[this.width/2,-this.height/2,1]),E.translate(it,it,[1,-1,0]),this.labelPlaneMatrix=it,it=E.create(),E.scale(it,it,[1,-1,1]),E.translate(it,it,[-1,-1,0]),E.scale(it,it,[2/this.width,2/this.height,1]),this.glCoordMatrix=it,this.pixelMatrix=E.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(it=E.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=it,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ie.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var _=this.pointCoordinate(new E.Point(0,0)),S=[_.x*this.worldSize,_.y*this.worldSize,0,1];return E.transformMat4(S,S,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ie.prototype.getCameraPoint=function(){var _=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new E.Point(0,_))},Ie.prototype.getCameraQueryGeometry=function(_){var S=this.getCameraPoint();if(_.length===1)return[_[0],S];for(var x=S.x,C=S.y,k=S.x,G=S.y,q=0,de=_;q<de.length;q+=1){var ze=de[q];x=Math.min(x,ze.x),C=Math.min(C,ze.y),k=Math.max(k,ze.x),G=Math.max(G,ze.y)}return[new E.Point(x,C),new E.Point(k,C),new E.Point(k,G),new E.Point(x,G),new E.Point(x,C)]},Object.defineProperties(Ie.prototype,ct);var gn=function(_){var S,x,C,k;this._hashName=_&&encodeURIComponent(_),E.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(S=this._updateHashUnthrottled.bind(this),x=!1,C=null,k=function(){C=null,x&&(S(),C=setTimeout(k,300),x=!1)},function(){return x=!0,C||k(),C})};gn.prototype.addTo=function(_){return this._map=_,E.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},gn.prototype.remove=function(){return E.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},gn.prototype.getHashString=function(_){var S=this._map.getCenter(),x=Math.round(100*this._map.getZoom())/100,C=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,C),G=Math.round(S.lng*k)/k,q=Math.round(S.lat*k)/k,de=this._map.getBearing(),ze=this._map.getPitch(),it="";if(it+=_?"/"+G+"/"+q+"/"+x:x+"/"+q+"/"+G,(de||ze)&&(it+="/"+Math.round(10*de)/10),ze&&(it+="/"+Math.round(ze)),this._hashName){var Bt=this._hashName,St=!1,Xt=E.window.location.hash.slice(1).split("&").map(function(En){var yn=En.split("=")[0];return yn===Bt?(St=!0,yn+"="+it):En}).filter(function(En){return En});return St||Xt.push(Bt+"="+it),"#"+Xt.join("&")}return"#"+it},gn.prototype._getCurrentHash=function(){var _,S=this,x=E.window.location.hash.replace("#","");return this._hashName?(x.split("&").map(function(C){return C.split("=")}).forEach(function(C){C[0]===S._hashName&&(_=C)}),(_&&_[1]||"").split("/")):x.split("/")},gn.prototype._onHashChange=function(){var _=this._getCurrentHash();if(_.length>=3&&!_.some(function(x){return isNaN(x)})){var S=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(_[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+_[2],+_[1]],zoom:+_[0],bearing:S,pitch:+(_[4]||0)}),!0}return!1},gn.prototype._updateHashUnthrottled=function(){var _=E.window.location.href.replace(/(#.+)?$/,this.getHashString());try{E.window.history.replaceState(E.window.history.state,null,_)}catch(S){}};var ir={linearity:.3,easing:E.bezier(0,0,.3,1)},Ur=E.extend({deceleration:2500,maxSpeed:1400},ir),mi=E.extend({deceleration:20,maxSpeed:1400},ir),Ki=E.extend({deceleration:1e3,maxSpeed:360},ir),ma=E.extend({deceleration:1e3,maxSpeed:90},ir),ba=function(_){this._map=_,this.clear()};function bs(_,S){(!_.duration||_.duration<S.duration)&&(_.duration=S.duration,_.easing=S.easing)}function za(_,S,x){var C=x.maxSpeed,k=x.linearity,G=x.deceleration,q=E.clamp(_*k/(S/1e3),-C,C),de=Math.abs(q)/(G*k);return{easing:x.easing,duration:1e3*de,amount:q*(de/2)}}ba.prototype.clear=function(){this._inertiaBuffer=[]},ba.prototype.record=function(_){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:E.browser.now(),settings:_})},ba.prototype._drainInertiaBuffer=function(){for(var _=this._inertiaBuffer,S=E.browser.now();_.length>0&&S-_[0].time>160;)_.shift()},ba.prototype._onMoveEnd=function(_){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var S={zoom:0,bearing:0,pitch:0,pan:new E.Point(0,0),pinchAround:void 0,around:void 0},x=0,C=this._inertiaBuffer;x<C.length;x+=1){var k=C[x].settings;S.zoom+=k.zoomDelta||0,S.bearing+=k.bearingDelta||0,S.pitch+=k.pitchDelta||0,k.panDelta&&S.pan._add(k.panDelta),k.around&&(S.around=k.around),k.pinchAround&&(S.pinchAround=k.pinchAround)}var G=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,q={};if(S.pan.mag()){var de=za(S.pan.mag(),G,E.extend({},Ur,_||{}));q.offset=S.pan.mult(de.amount/S.pan.mag()),q.center=this._map.transform.center,bs(q,de)}if(S.zoom){var ze=za(S.zoom,G,mi);q.zoom=this._map.transform.zoom+ze.amount,bs(q,ze)}if(S.bearing){var it=za(S.bearing,G,Ki);q.bearing=this._map.transform.bearing+E.clamp(it.amount,-179,179),bs(q,it)}if(S.pitch){var Bt=za(S.pitch,G,ma);q.pitch=this._map.transform.pitch+Bt.amount,bs(q,Bt)}if(q.zoom||q.bearing){var St=S.pinchAround===void 0?S.around:S.pinchAround;q.around=St?this._map.unproject(St):this._map.getCenter()}return this.clear(),E.extend(q,{noMoveStart:!0})}};var Na=function(_){function S(C,k,G,q){q===void 0&&(q={});var de=re.mousePos(k.getCanvasContainer(),G),ze=k.unproject(de);_.call(this,C,E.extend({point:de,lngLat:ze,originalEvent:G},q)),this._defaultPrevented=!1,this.target=k}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={defaultPrevented:{configurable:!0}};return S.prototype.preventDefault=function(){this._defaultPrevented=!0},x.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(S.prototype,x),S}(E.Event),Sc=function(_){function S(C,k,G){var q=C==="touchend"?G.changedTouches:G.touches,de=re.touchPos(k.getCanvasContainer(),q),ze=de.map(function(St){return k.unproject(St)}),it=de.reduce(function(St,Xt,En,yn){return St.add(Xt.div(yn.length))},new E.Point(0,0)),Bt=k.unproject(it);_.call(this,C,{points:de,point:it,lngLats:ze,lngLat:Bt,originalEvent:G}),this._defaultPrevented=!1}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={defaultPrevented:{configurable:!0}};return S.prototype.preventDefault=function(){this._defaultPrevented=!0},x.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(S.prototype,x),S}(E.Event),nf=function(_){function S(C,k,G){_.call(this,C,{originalEvent:G}),this._defaultPrevented=!1}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={defaultPrevented:{configurable:!0}};return S.prototype.preventDefault=function(){this._defaultPrevented=!0},x.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(S.prototype,x),S}(E.Event),Ys=function(_,S){this._map=_,this._clickTolerance=S.clickTolerance};Ys.prototype.reset=function(){delete this._mousedownPos},Ys.prototype.wheel=function(_){return this._firePreventable(new nf(_.type,this._map,_))},Ys.prototype.mousedown=function(_,S){return this._mousedownPos=S,this._firePreventable(new Na(_.type,this._map,_))},Ys.prototype.mouseup=function(_){this._map.fire(new Na(_.type,this._map,_))},Ys.prototype.click=function(_,S){this._mousedownPos&&this._mousedownPos.dist(S)>=this._clickTolerance||this._map.fire(new Na(_.type,this._map,_))},Ys.prototype.dblclick=function(_){return this._firePreventable(new Na(_.type,this._map,_))},Ys.prototype.mouseover=function(_){this._map.fire(new Na(_.type,this._map,_))},Ys.prototype.mouseout=function(_){this._map.fire(new Na(_.type,this._map,_))},Ys.prototype.touchstart=function(_){return this._firePreventable(new Sc(_.type,this._map,_))},Ys.prototype.touchmove=function(_){this._map.fire(new Sc(_.type,this._map,_))},Ys.prototype.touchend=function(_){this._map.fire(new Sc(_.type,this._map,_))},Ys.prototype.touchcancel=function(_){this._map.fire(new Sc(_.type,this._map,_))},Ys.prototype._firePreventable=function(_){if(this._map.fire(_),_.defaultPrevented)return{}},Ys.prototype.isEnabled=function(){return!0},Ys.prototype.isActive=function(){return!1},Ys.prototype.enable=function(){},Ys.prototype.disable=function(){};var io=function(_){this._map=_};io.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},io.prototype.mousemove=function(_){this._map.fire(new Na(_.type,this._map,_))},io.prototype.mousedown=function(){this._delayContextMenu=!0},io.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Na("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},io.prototype.contextmenu=function(_){this._delayContextMenu?this._contextMenuEvent=_:this._map.fire(new Na(_.type,this._map,_)),this._map.listens("contextmenu")&&_.preventDefault()},io.prototype.isEnabled=function(){return!0},io.prototype.isActive=function(){return!1},io.prototype.enable=function(){},io.prototype.disable=function(){};var Wc=function(_,S){this._map=_,this._el=_.getCanvasContainer(),this._container=_.getContainer(),this._clickTolerance=S.clickTolerance||1};function Gd(_,S){for(var x={},C=0;C<_.length;C++)x[_[C].identifier]=S[C];return x}Wc.prototype.isEnabled=function(){return!!this._enabled},Wc.prototype.isActive=function(){return!!this._active},Wc.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Wc.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Wc.prototype.mousedown=function(_,S){this.isEnabled()&&_.shiftKey&&_.button===0&&(re.disableDrag(),this._startPos=this._lastPos=S,this._active=!0)},Wc.prototype.mousemoveWindow=function(_,S){if(this._active){var x=S;if(!(this._lastPos.equals(x)||!this._box&&x.dist(this._startPos)<this._clickTolerance)){var C=this._startPos;this._lastPos=x,this._box||(this._box=re.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",_));var k=Math.min(C.x,x.x),G=Math.max(C.x,x.x),q=Math.min(C.y,x.y),de=Math.max(C.y,x.y);re.setTransform(this._box,"translate("+k+"px,"+q+"px)"),this._box.style.width=G-k+"px",this._box.style.height=de-q+"px"}}},Wc.prototype.mouseupWindow=function(_,S){var x=this;if(this._active&&_.button===0){var C=this._startPos,k=S;if(this.reset(),re.suppressClick(),C.x!==k.x||C.y!==k.y)return this._map.fire(new E.Event("boxzoomend",{originalEvent:_})),{cameraAnimation:function(G){return G.fitScreenCoordinates(C,k,x._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",_)}},Wc.prototype.keydown=function(_){this._active&&_.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",_))},Wc.prototype.blur=function(){this.reset()},Wc.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(re.remove(this._box),this._box=null),re.enableDrag(),delete this._startPos,delete this._lastPos},Wc.prototype._fireEvent=function(_,S){return this._map.fire(new E.Event(_,{originalEvent:S}))};var $h=function(_){this.reset(),this.numTouches=_.numTouches};$h.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},$h.prototype.touchstart=function(_,S,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=_.timeStamp),x.length===this.numTouches&&(this.centroid=function(C){for(var k=new E.Point(0,0),G=0,q=C;G<q.length;G+=1)k._add(q[G]);return k.div(C.length)}(S),this.touches=Gd(x,S)))},$h.prototype.touchmove=function(_,S,x){if(!this.aborted&&this.centroid){var C=Gd(x,S);for(var k in this.touches){var G=C[k];(!G||G.dist(this.touches[k])>30)&&(this.aborted=!0)}}},$h.prototype.touchend=function(_,S,x){if((!this.centroid||_.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){var C=!this.aborted&&this.centroid;if(this.reset(),C)return C}};var _l=function(_){this.singleTap=new $h(_),this.numTaps=_.numTaps,this.reset()};_l.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},_l.prototype.touchstart=function(_,S,x){this.singleTap.touchstart(_,S,x)},_l.prototype.touchmove=function(_,S,x){this.singleTap.touchmove(_,S,x)},_l.prototype.touchend=function(_,S,x){var C=this.singleTap.touchend(_,S,x);if(C){var k=_.timeStamp-this.lastTime<500,G=!this.lastTap||this.lastTap.dist(C)<30;if(k&&G||this.reset(),this.count++,this.lastTime=_.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}};var Ja=function(){this._zoomIn=new _l({numTouches:1,numTaps:2}),this._zoomOut=new _l({numTouches:2,numTaps:1}),this.reset()};Ja.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Ja.prototype.touchstart=function(_,S,x){this._zoomIn.touchstart(_,S,x),this._zoomOut.touchstart(_,S,x)},Ja.prototype.touchmove=function(_,S,x){this._zoomIn.touchmove(_,S,x),this._zoomOut.touchmove(_,S,x)},Ja.prototype.touchend=function(_,S,x){var C=this,k=this._zoomIn.touchend(_,S,x),G=this._zoomOut.touchend(_,S,x);return k?(this._active=!0,_.preventDefault(),setTimeout(function(){return C.reset()},0),{cameraAnimation:function(q){return q.easeTo({duration:300,zoom:q.getZoom()+1,around:q.unproject(k)},{originalEvent:_})}}):G?(this._active=!0,_.preventDefault(),setTimeout(function(){return C.reset()},0),{cameraAnimation:function(q){return q.easeTo({duration:300,zoom:q.getZoom()-1,around:q.unproject(G)},{originalEvent:_})}}):void 0},Ja.prototype.touchcancel=function(){this.reset()},Ja.prototype.enable=function(){this._enabled=!0},Ja.prototype.disable=function(){this._enabled=!1,this.reset()},Ja.prototype.isEnabled=function(){return this._enabled},Ja.prototype.isActive=function(){return this._active};var r0={0:1,2:2},Xi=function(_){this.reset(),this._clickTolerance=_.clickTolerance||1};Xi.prototype.blur=function(){this.reset()},Xi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Xi.prototype._correctButton=function(_,S){return!1},Xi.prototype._move=function(_,S){return{}},Xi.prototype.mousedown=function(_,S){if(!this._lastPoint){var x=re.mouseButton(_);this._correctButton(_,x)&&(this._lastPoint=S,this._eventButton=x)}},Xi.prototype.mousemoveWindow=function(_,S){var x=this._lastPoint;if(x){if(_.preventDefault(),function(C,k){var G=r0[k];return C.buttons===void 0||(C.buttons&G)!==G}(_,this._eventButton))this.reset();else if(this._moved||!(S.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=S,this._move(x,S)}},Xi.prototype.mouseupWindow=function(_){this._lastPoint&&re.mouseButton(_)===this._eventButton&&(this._moved&&re.suppressClick(),this.reset())},Xi.prototype.enable=function(){this._enabled=!0},Xi.prototype.disable=function(){this._enabled=!1,this.reset()},Xi.prototype.isEnabled=function(){return this._enabled},Xi.prototype.isActive=function(){return this._active};var Ff=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.mousedown=function(x,C){_.prototype.mousedown.call(this,x,C),this._lastPoint&&(this._active=!0)},S.prototype._correctButton=function(x,C){return C===0&&!x.ctrlKey},S.prototype._move=function(x,C){return{around:C,panDelta:C.sub(x)}},S}(Xi),Eu=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype._correctButton=function(x,C){return C===0&&x.ctrlKey||C===2},S.prototype._move=function(x,C){var k=.8*(C.x-x.x);if(k)return this._active=!0,{bearingDelta:k}},S.prototype.contextmenu=function(x){x.preventDefault()},S}(Xi),Ep=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype._correctButton=function(x,C){return C===0&&x.ctrlKey||C===2},S.prototype._move=function(x,C){var k=-.5*(C.y-x.y);if(k)return this._active=!0,{pitchDelta:k}},S.prototype.contextmenu=function(x){x.preventDefault()},S}(Xi),rf=function(_){this._minTouches=1,this._clickTolerance=_.clickTolerance||1,this.reset()};rf.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new E.Point(0,0)},rf.prototype.touchstart=function(_,S,x){return this._calculateTransform(_,S,x)},rf.prototype.touchmove=function(_,S,x){if(this._active&&!(x.length<this._minTouches))return _.preventDefault(),this._calculateTransform(_,S,x)},rf.prototype.touchend=function(_,S,x){this._calculateTransform(_,S,x),this._active&&x.length<this._minTouches&&this.reset()},rf.prototype.touchcancel=function(){this.reset()},rf.prototype._calculateTransform=function(_,S,x){x.length>0&&(this._active=!0);var C=Gd(x,S),k=new E.Point(0,0),G=new E.Point(0,0),q=0;for(var de in C){var ze=C[de],it=this._touches[de];it&&(k._add(ze),G._add(ze.sub(it)),q++,C[de]=ze)}if(this._touches=C,!(q<this._minTouches)&&G.mag()){var Bt=G.div(q);if(this._sum._add(Bt),!(this._sum.mag()<this._clickTolerance))return{around:k.div(q),panDelta:Bt}}},rf.prototype.enable=function(){this._enabled=!0},rf.prototype.disable=function(){this._enabled=!1,this.reset()},rf.prototype.isEnabled=function(){return this._enabled},rf.prototype.isActive=function(){return this._active};var of=function(){this.reset()};function eh(_,S,x){for(var C=0;C<_.length;C++)if(_[C].identifier===x)return S[C]}function Sp(_,S){return Math.log(_/S)/Math.LN2}of.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},of.prototype._start=function(_){},of.prototype._move=function(_,S,x){return{}},of.prototype.touchstart=function(_,S,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([S[0],S[1]]))},of.prototype.touchmove=function(_,S,x){if(this._firstTwoTouches){_.preventDefault();var C=this._firstTwoTouches,k=C[1],G=eh(x,S,C[0]),q=eh(x,S,k);if(G&&q){var de=this._aroundCenter?null:G.add(q).div(2);return this._move([G,q],de,_)}}},of.prototype.touchend=function(_,S,x){if(this._firstTwoTouches){var C=this._firstTwoTouches,k=C[1],G=eh(x,S,C[0]),q=eh(x,S,k);G&&q||(this._active&&re.suppressClick(),this.reset())}},of.prototype.touchcancel=function(){this.reset()},of.prototype.enable=function(_){this._enabled=!0,this._aroundCenter=!!_&&_.around==="center"},of.prototype.disable=function(){this._enabled=!1,this.reset()},of.prototype.isEnabled=function(){return this._enabled},of.prototype.isActive=function(){return this._active};var Gc=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.reset=function(){_.prototype.reset.call(this),delete this._distance,delete this._startDistance},S.prototype._start=function(x){this._startDistance=this._distance=x[0].dist(x[1])},S.prototype._move=function(x,C){var k=this._distance;if(this._distance=x[0].dist(x[1]),this._active||!(Math.abs(Sp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sp(this._distance,k),pinchAround:C}},S}(of);function th(_,S){return 180*_.angleWith(S)/Math.PI}var i0=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.reset=function(){_.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},S.prototype._start=function(x){this._startVector=this._vector=x[0].sub(x[1]),this._minDiameter=x[0].dist(x[1])},S.prototype._move=function(x,C){var k=this._vector;if(this._vector=x[0].sub(x[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:th(this._vector,k),pinchAround:C}},S.prototype._isBelowThreshold=function(x){this._minDiameter=Math.min(this._minDiameter,x.mag());var C=25/(Math.PI*this._minDiameter)*360,k=th(x,this._startVector);return Math.abs(k)<C},S}(of);function Sd(_){return Math.abs(_.y)>Math.abs(_.x)}var k0=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.reset=function(){_.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},S.prototype._start=function(x){this._lastPoints=x,Sd(x[0].sub(x[1]))&&(this._valid=!1)},S.prototype._move=function(x,C,k){var G=x[0].sub(this._lastPoints[0]),q=x[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(G,q,k.timeStamp),this._valid)return this._lastPoints=x,this._active=!0,{pitchDelta:(G.y+q.y)/2*-.5}},S.prototype.gestureBeginsVertically=function(x,C,k){if(this._valid!==void 0)return this._valid;var G=x.mag()>=2,q=C.mag()>=2;if(G||q){if(!G||!q)return this._firstMove===void 0&&(this._firstMove=k),k-this._firstMove<100&&void 0;var de=x.y>0==C.y>0;return Sd(x)&&Sd(C)&&de}},S}(of),z0={panStep:100,bearingStep:15,pitchStep:10},su=function(){var _=z0;this._panStep=_.panStep,this._bearingStep=_.bearingStep,this._pitchStep=_.pitchStep,this._rotationDisabled=!1};function af(_){return _*(2-_)}su.prototype.blur=function(){this.reset()},su.prototype.reset=function(){this._active=!1},su.prototype.keydown=function(_){var S=this;if(!(_.altKey||_.ctrlKey||_.metaKey)){var x=0,C=0,k=0,G=0,q=0;switch(_.keyCode){case 61:case 107:case 171:case 187:x=1;break;case 189:case 109:case 173:x=-1;break;case 37:_.shiftKey?C=-1:(_.preventDefault(),G=-1);break;case 39:_.shiftKey?C=1:(_.preventDefault(),G=1);break;case 38:_.shiftKey?k=1:(_.preventDefault(),q=-1);break;case 40:_.shiftKey?k=-1:(_.preventDefault(),q=1);break;default:return}return this._rotationDisabled&&(C=0,k=0),{cameraAnimation:function(de){var ze=de.getZoom();de.easeTo({duration:300,easeId:"keyboardHandler",easing:af,zoom:x?Math.round(ze)+x*(_.shiftKey?2:1):ze,bearing:de.getBearing()+C*S._bearingStep,pitch:de.getPitch()+k*S._pitchStep,offset:[-G*S._panStep,-q*S._panStep],center:de.getCenter()},{originalEvent:_})}}}},su.prototype.enable=function(){this._enabled=!0},su.prototype.disable=function(){this._enabled=!1,this.reset()},su.prototype.isEnabled=function(){return this._enabled},su.prototype.isActive=function(){return this._active},su.prototype.disableRotation=function(){this._rotationDisabled=!0},su.prototype.enableRotation=function(){this._rotationDisabled=!1};var Ta=function(_,S){this._map=_,this._el=_.getCanvasContainer(),this._handler=S,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,E.bindAll(["_onTimeout"],this)};Ta.prototype.setZoomRate=function(_){this._defaultZoomRate=_},Ta.prototype.setWheelZoomRate=function(_){this._wheelZoomRate=_},Ta.prototype.isEnabled=function(){return!!this._enabled},Ta.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ta.prototype.isZooming=function(){return!!this._zooming},Ta.prototype.enable=function(_){this.isEnabled()||(this._enabled=!0,this._aroundCenter=_&&_.around==="center")},Ta.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ta.prototype.wheel=function(_){if(this.isEnabled()){var S=_.deltaMode===E.window.WheelEvent.DOM_DELTA_LINE?40*_.deltaY:_.deltaY,x=E.browser.now(),C=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,S!==0&&S%4.000244140625==0?this._type="wheel":S!==0&&Math.abs(S)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=S,this._timeout=setTimeout(this._onTimeout,40,_)):this._type||(this._type=Math.abs(C*S)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,S+=this._lastValue)),_.shiftKey&&S&&(S/=4),this._type&&(this._lastWheelEvent=_,this._delta-=S,this._active||this._start(_)),_.preventDefault()}},Ta.prototype._onTimeout=function(_){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(_)},Ta.prototype._start=function(_){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var S=re.mousePos(this._el,_);this._around=E.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(S)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ta.prototype.renderFrame=function(){var _=this;if(this._frameId&&(this._frameId=null,this.isActive())){var S=this._map.transform;if(this._delta!==0){var x=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,C=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&C!==0&&(C=1/C);var k=typeof this._targetZoom=="number"?S.zoomScale(this._targetZoom):S.scale;this._targetZoom=Math.min(S.maxZoom,Math.max(S.minZoom,S.scaleZoom(k*C))),this._type==="wheel"&&(this._startZoom=S.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var G,q=typeof this._targetZoom=="number"?this._targetZoom:S.zoom,de=this._startZoom,ze=this._easing,it=!1;if(this._type==="wheel"&&de&&ze){var Bt=Math.min((E.browser.now()-this._lastWheelEventTime)/200,1),St=ze(Bt);G=E.number(de,q,St),Bt<1?this._frameId||(this._frameId=!0):it=!0}else G=q,it=!0;return this._active=!0,it&&(this._active=!1,this._finishTimeout=setTimeout(function(){_._zooming=!1,_._handler._triggerRenderFrame(),delete _._targetZoom,delete _._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!it,zoomDelta:G-S.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ta.prototype._smoothOutEasing=function(_){var S=E.ease;if(this._prevEase){var x=this._prevEase,C=(E.browser.now()-x.start)/x.duration,k=x.easing(C+.01)-x.easing(C),G=.27/Math.sqrt(k*k+1e-4)*.01,q=Math.sqrt(.0729-G*G);S=E.bezier(G,q,.25,1)}return this._prevEase={start:E.browser.now(),duration:_,easing:S},S},Ta.prototype.blur=function(){this.reset()},Ta.prototype.reset=function(){this._active=!1};var ku=function(_,S){this._clickZoom=_,this._tapZoom=S};ku.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ku.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ku.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ku.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var zu=function(){this.reset()};zu.prototype.reset=function(){this._active=!1},zu.prototype.blur=function(){this.reset()},zu.prototype.dblclick=function(_,S){return _.preventDefault(),{cameraAnimation:function(x){x.easeTo({duration:300,zoom:x.getZoom()+(_.shiftKey?-1:1),around:x.unproject(S)},{originalEvent:_})}}},zu.prototype.enable=function(){this._enabled=!0},zu.prototype.disable=function(){this._enabled=!1,this.reset()},zu.prototype.isEnabled=function(){return this._enabled},zu.prototype.isActive=function(){return this._active};var cc=function(){this._tap=new _l({numTouches:1,numTaps:1}),this.reset()};cc.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},cc.prototype.touchstart=function(_,S,x){this._swipePoint||(this._tapTime&&_.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=S[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(_,S,x))},cc.prototype.touchmove=function(_,S,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;var C=S[0],k=C.y-this._swipePoint.y;return this._swipePoint=C,_.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(_,S,x)},cc.prototype.touchend=function(_,S,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(_,S,x)&&(this._tapTime=_.timeStamp)},cc.prototype.touchcancel=function(){this.reset()},cc.prototype.enable=function(){this._enabled=!0},cc.prototype.disable=function(){this._enabled=!1,this.reset()},cc.prototype.isEnabled=function(){return this._enabled},cc.prototype.isActive=function(){return this._active};var Th=function(_,S,x){this._el=_,this._mousePan=S,this._touchPan=x};Th.prototype.enable=function(_){this._inertiaOptions=_||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Th.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Th.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Th.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ul=function(_,S,x){this._pitchWithRotate=_.pitchWithRotate,this._mouseRotate=S,this._mousePitch=x};Ul.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ul.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ul.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ul.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Fc=function(_,S,x,C){this._el=_,this._touchZoom=S,this._touchRotate=x,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0};Fc.prototype.enable=function(_){this._touchZoom.enable(_),this._rotationDisabled||this._touchRotate.enable(_),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Fc.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Fc.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Fc.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Fc.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Fc.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Xc=function(_){return _.zoom||_.drag||_.pitch||_.rotate},Tp=function(_){function S(){_.apply(this,arguments)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S}(E.Event);function jo(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}var Eo=function(_,S){this._map=_,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ba(_),this._bearingSnap=S.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(S),E.bindAll(["handleEvent","handleWindowEvent"],this);var x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[E.window.document,"mousemove",{capture:!0}],[E.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[E.window,"blur",void 0]];for(var C=0,k=this._listeners;C<k.length;C+=1){var G=k[C],q=G[0];re.addEventListener(q,G[1],q===E.window.document?this.handleWindowEvent:this.handleEvent,G[2])}};Eo.prototype.destroy=function(){for(var _=0,S=this._listeners;_<S.length;_+=1){var x=S[_],C=x[0];re.removeEventListener(C,x[1],C===E.window.document?this.handleWindowEvent:this.handleEvent,x[2])}},Eo.prototype._addDefaultHandlers=function(_){var S=this._map,x=S.getCanvasContainer();this._add("mapEvent",new Ys(S,_));var C=S.boxZoom=new Wc(S,_);this._add("boxZoom",C);var k=new Ja,G=new zu;S.doubleClickZoom=new ku(G,k),this._add("tapZoom",k),this._add("clickZoom",G);var q=new cc;this._add("tapDragZoom",q);var de=S.touchPitch=new k0;this._add("touchPitch",de);var ze=new Eu(_),it=new Ep(_);S.dragRotate=new Ul(_,ze,it),this._add("mouseRotate",ze,["mousePitch"]),this._add("mousePitch",it,["mouseRotate"]);var Bt=new Ff(_),St=new rf(_);S.dragPan=new Th(x,Bt,St),this._add("mousePan",Bt),this._add("touchPan",St,["touchZoom","touchRotate"]);var Xt=new i0,En=new Gc;S.touchZoomRotate=new Fc(x,En,Xt,q),this._add("touchRotate",Xt,["touchPan","touchZoom"]),this._add("touchZoom",En,["touchPan","touchRotate"]);var yn=S.scrollZoom=new Ta(S,this);this._add("scrollZoom",yn,["mousePan"]);var Un=S.keyboard=new su;this._add("keyboard",Un),this._add("blockableMapEvent",new io(S));for(var cn=0,Rn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];cn<Rn.length;cn+=1){var Jn=Rn[cn];_.interactive&&_[Jn]&&S[Jn].enable(_[Jn])}},Eo.prototype._add=function(_,S,x){this._handlers.push({handlerName:_,handler:S,allowed:x}),this._handlersById[_]=S},Eo.prototype.stop=function(_){if(!this._updatingCamera){for(var S=0,x=this._handlers;S<x.length;S+=1)x[S].handler.reset();this._inertia.clear(),this._fireEvents({},{},_),this._changes=[]}},Eo.prototype.isActive=function(){for(var _=0,S=this._handlers;_<S.length;_+=1)if(S[_].handler.isActive())return!0;return!1},Eo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Eo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Eo.prototype.isMoving=function(){return!!Xc(this._eventsInProgress)||this.isZooming()},Eo.prototype._blockedByActive=function(_,S,x){for(var C in _)if(C!==x&&(!S||S.indexOf(C)<0))return!0;return!1},Eo.prototype.handleWindowEvent=function(_){this.handleEvent(_,_.type+"Window")},Eo.prototype._getMapTouches=function(_){for(var S=[],x=0,C=_;x<C.length;x+=1){var k=C[x];this._el.contains(k.target)&&S.push(k)}return S},Eo.prototype.handleEvent=function(_,S){this._updatingCamera=!0;for(var x=_.type==="renderFrame"?void 0:_,C={needsRenderFrame:!1},k={},G={},q=_.touches?this._getMapTouches(_.touches):void 0,de=q?re.touchPos(this._el,q):re.mousePos(this._el,_),ze=0,it=this._handlers;ze<it.length;ze+=1){var Bt=it[ze],St=Bt.handlerName,Xt=Bt.handler,En=Bt.allowed;if(Xt.isEnabled()){var yn=void 0;this._blockedByActive(G,En,St)?Xt.reset():Xt[S||_.type]&&(yn=Xt[S||_.type](_,de,q),this.mergeHandlerResult(C,k,yn,St,x),yn&&yn.needsRenderFrame&&this._triggerRenderFrame()),(yn||Xt.isActive())&&(G[St]=Xt)}}var Un={};for(var cn in this._previousActiveHandlers)G[cn]||(Un[cn]=x);this._previousActiveHandlers=G,(Object.keys(Un).length||jo(C))&&(this._changes.push([C,k,Un]),this._triggerRenderFrame()),(Object.keys(G).length||jo(C))&&this._map._stop(!0),this._updatingCamera=!1;var Rn=C.cameraAnimation;Rn&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Rn(this._map))},Eo.prototype.mergeHandlerResult=function(_,S,x,C,k){if(x){E.extend(_,x);var G={handlerName:C,originalEvent:x.originalEvent||k};x.zoomDelta!==void 0&&(S.zoom=G),x.panDelta!==void 0&&(S.drag=G),x.pitchDelta!==void 0&&(S.pitch=G),x.bearingDelta!==void 0&&(S.rotate=G)}},Eo.prototype._applyChanges=function(){for(var _={},S={},x={},C=0,k=this._changes;C<k.length;C+=1){var G=k[C],q=G[0],de=G[1],ze=G[2];q.panDelta&&(_.panDelta=(_.panDelta||new E.Point(0,0))._add(q.panDelta)),q.zoomDelta&&(_.zoomDelta=(_.zoomDelta||0)+q.zoomDelta),q.bearingDelta&&(_.bearingDelta=(_.bearingDelta||0)+q.bearingDelta),q.pitchDelta&&(_.pitchDelta=(_.pitchDelta||0)+q.pitchDelta),q.around!==void 0&&(_.around=q.around),q.pinchAround!==void 0&&(_.pinchAround=q.pinchAround),q.noInertia&&(_.noInertia=q.noInertia),E.extend(S,de),E.extend(x,ze)}this._updateMapTransform(_,S,x),this._changes=[]},Eo.prototype._updateMapTransform=function(_,S,x){var C=this._map,k=C.transform;if(!jo(_))return this._fireEvents(S,x,!0);var G=_.panDelta,q=_.zoomDelta,de=_.bearingDelta,ze=_.pitchDelta,it=_.around,Bt=_.pinchAround;Bt!==void 0&&(it=Bt),C._stop(!0),it=it||C.transform.centerPoint;var St=k.pointLocation(G?it.sub(G):it);de&&(k.bearing+=de),ze&&(k.pitch+=ze),q&&(k.zoom+=q),k.setLocationAtPoint(St,it),this._map._update(),_.noInertia||this._inertia.record(_),this._fireEvents(S,x,!0)},Eo.prototype._fireEvents=function(_,S,x){var C=this,k=Xc(this._eventsInProgress),G=Xc(_),q={};for(var de in _)this._eventsInProgress[de]||(q[de+"start"]=_[de].originalEvent),this._eventsInProgress[de]=_[de];for(var ze in!k&&G&&this._fireEvent("movestart",G.originalEvent),q)this._fireEvent(ze,q[ze]);for(var it in G&&this._fireEvent("move",G.originalEvent),_)this._fireEvent(it,_[it].originalEvent);var Bt,St={};for(var Xt in this._eventsInProgress){var En=this._eventsInProgress[Xt],yn=En.handlerName,Un=En.originalEvent;this._handlersById[yn].isActive()||(delete this._eventsInProgress[Xt],St[Xt+"end"]=Bt=S[yn]||Un)}for(var cn in St)this._fireEvent(cn,St[cn]);var Rn=Xc(this._eventsInProgress);if(x&&(k||G)&&!Rn){this._updatingCamera=!0;var Jn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),hr=function(Lr){return Lr!==0&&-C._bearingSnap<Lr&&Lr<C._bearingSnap};Jn?(hr(Jn.bearing||this._map.getBearing())&&(Jn.bearing=0),this._map.easeTo(Jn,{originalEvent:Bt})):(this._map.fire(new E.Event("moveend",{originalEvent:Bt})),hr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Eo.prototype._fireEvent=function(_,S){this._map.fire(new E.Event(_,S?{originalEvent:S}:{}))},Eo.prototype._requestFrame=function(){var _=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(S){delete _._frameId,_.handleEvent(new Tp("renderFrame",{timeStamp:S})),_._applyChanges()})},Eo.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var kc=function(_){function S(x,C){_.call(this),this._moving=!1,this._zooming=!1,this.transform=x,this._bearingSnap=C.bearingSnap,E.bindAll(["_renderFrameCallback"],this)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.getCenter=function(){return new E.LngLat(this.transform.center.lng,this.transform.center.lat)},S.prototype.setCenter=function(x,C){return this.jumpTo({center:x},C)},S.prototype.panBy=function(x,C,k){return x=E.Point.convert(x).mult(-1),this.panTo(this.transform.center,E.extend({offset:x},C),k)},S.prototype.panTo=function(x,C,k){return this.easeTo(E.extend({center:x},C),k)},S.prototype.getZoom=function(){return this.transform.zoom},S.prototype.setZoom=function(x,C){return this.jumpTo({zoom:x},C),this},S.prototype.zoomTo=function(x,C,k){return this.easeTo(E.extend({zoom:x},C),k)},S.prototype.zoomIn=function(x,C){return this.zoomTo(this.getZoom()+1,x,C),this},S.prototype.zoomOut=function(x,C){return this.zoomTo(this.getZoom()-1,x,C),this},S.prototype.getBearing=function(){return this.transform.bearing},S.prototype.setBearing=function(x,C){return this.jumpTo({bearing:x},C),this},S.prototype.getPadding=function(){return this.transform.padding},S.prototype.setPadding=function(x,C){return this.jumpTo({padding:x},C),this},S.prototype.rotateTo=function(x,C,k){return this.easeTo(E.extend({bearing:x},C),k)},S.prototype.resetNorth=function(x,C){return this.rotateTo(0,E.extend({duration:1e3},x),C),this},S.prototype.resetNorthPitch=function(x,C){return this.easeTo(E.extend({bearing:0,pitch:0,duration:1e3},x),C),this},S.prototype.snapToNorth=function(x,C){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(x,C):this},S.prototype.getPitch=function(){return this.transform.pitch},S.prototype.setPitch=function(x,C){return this.jumpTo({pitch:x},C),this},S.prototype.cameraForBounds=function(x,C){x=E.LngLatBounds.convert(x);var k=C&&C.bearing||0;return this._cameraForBoxAndBearing(x.getNorthWest(),x.getSouthEast(),k,C)},S.prototype._cameraForBoxAndBearing=function(x,C,k,G){var q={top:0,bottom:0,right:0,left:0};if(typeof(G=E.extend({padding:q,offset:[0,0],maxZoom:this.transform.maxZoom},G)).padding=="number"){var de=G.padding;G.padding={top:de,bottom:de,right:de,left:de}}G.padding=E.extend(q,G.padding);var ze=this.transform,it=ze.padding,Bt=ze.project(E.LngLat.convert(x)),St=ze.project(E.LngLat.convert(C)),Xt=Bt.rotate(-k*Math.PI/180),En=St.rotate(-k*Math.PI/180),yn=new E.Point(Math.max(Xt.x,En.x),Math.max(Xt.y,En.y)),Un=new E.Point(Math.min(Xt.x,En.x),Math.min(Xt.y,En.y)),cn=yn.sub(Un),Rn=(ze.width-(it.left+it.right+G.padding.left+G.padding.right))/cn.x,Jn=(ze.height-(it.top+it.bottom+G.padding.top+G.padding.bottom))/cn.y;if(!(Jn<0||Rn<0)){var hr=Math.min(ze.scaleZoom(ze.scale*Math.min(Rn,Jn)),G.maxZoom),Lr=typeof G.offset.x=="number"?new E.Point(G.offset.x,G.offset.y):E.Point.convert(G.offset),gr=new E.Point((G.padding.left-G.padding.right)/2,(G.padding.top-G.padding.bottom)/2).rotate(k*Math.PI/180),Dr=Lr.add(gr).mult(ze.scale/ze.zoomScale(hr));return{center:ze.unproject(Bt.add(St).div(2).sub(Dr)),zoom:hr,bearing:k}}E.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},S.prototype.fitBounds=function(x,C,k){return this._fitInternal(this.cameraForBounds(x,C),C,k)},S.prototype.fitScreenCoordinates=function(x,C,k,G,q){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(E.Point.convert(x)),this.transform.pointLocation(E.Point.convert(C)),k,G),G,q)},S.prototype._fitInternal=function(x,C,k){return x?(delete(C=E.extend(x,C)).padding,C.linear?this.easeTo(C,k):this.flyTo(C,k)):this},S.prototype.jumpTo=function(x,C){this.stop();var k=this.transform,G=!1,q=!1,de=!1;return"zoom"in x&&k.zoom!==+x.zoom&&(G=!0,k.zoom=+x.zoom),x.center!==void 0&&(k.center=E.LngLat.convert(x.center)),"bearing"in x&&k.bearing!==+x.bearing&&(q=!0,k.bearing=+x.bearing),"pitch"in x&&k.pitch!==+x.pitch&&(de=!0,k.pitch=+x.pitch),x.padding==null||k.isPaddingEqual(x.padding)||(k.padding=x.padding),this.fire(new E.Event("movestart",C)).fire(new E.Event("move",C)),G&&this.fire(new E.Event("zoomstart",C)).fire(new E.Event("zoom",C)).fire(new E.Event("zoomend",C)),q&&this.fire(new E.Event("rotatestart",C)).fire(new E.Event("rotate",C)).fire(new E.Event("rotateend",C)),de&&this.fire(new E.Event("pitchstart",C)).fire(new E.Event("pitch",C)).fire(new E.Event("pitchend",C)),this.fire(new E.Event("moveend",C))},S.prototype.easeTo=function(x,C){var k=this;this._stop(!1,x.easeId),((x=E.extend({offset:[0,0],duration:500,easing:E.ease},x)).animate===!1||!x.essential&&E.browser.prefersReducedMotion)&&(x.duration=0);var G=this.transform,q=this.getZoom(),de=this.getBearing(),ze=this.getPitch(),it=this.getPadding(),Bt="zoom"in x?+x.zoom:q,St="bearing"in x?this._normalizeBearing(x.bearing,de):de,Xt="pitch"in x?+x.pitch:ze,En="padding"in x?x.padding:G.padding,yn=E.Point.convert(x.offset),Un=G.centerPoint.add(yn),cn=G.pointLocation(Un),Rn=E.LngLat.convert(x.center||cn);this._normalizeCenter(Rn);var Jn,hr,Lr=G.project(cn),gr=G.project(Rn).sub(Lr),Dr=G.zoomScale(Bt-q);x.around&&(Jn=E.LngLat.convert(x.around),hr=G.locationPoint(Jn));var Fr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Bt!==q,this._rotating=this._rotating||de!==St,this._pitching=this._pitching||Xt!==ze,this._padding=!G.isPaddingEqual(En),this._easeId=x.easeId,this._prepareEase(C,x.noMoveStart,Fr),this._ease(function(Mi){if(k._zooming&&(G.zoom=E.number(q,Bt,Mi)),k._rotating&&(G.bearing=E.number(de,St,Mi)),k._pitching&&(G.pitch=E.number(ze,Xt,Mi)),k._padding&&(G.interpolatePadding(it,En,Mi),Un=G.centerPoint.add(yn)),Jn)G.setLocationAtPoint(Jn,hr);else{var Pi=G.zoomScale(G.zoom-q),vi=Bt>q?Math.min(2,Dr):Math.max(.5,Dr),Oo=Math.pow(vi,1-Mi),yo=G.unproject(Lr.add(gr.mult(Mi*Oo)).mult(Pi));G.setLocationAtPoint(G.renderWorldCopies?yo.wrap():yo,Un)}k._fireMoveEvents(C)},function(Mi){k._afterEase(C,Mi)},x),this},S.prototype._prepareEase=function(x,C,k){k===void 0&&(k={}),this._moving=!0,C||k.moving||this.fire(new E.Event("movestart",x)),this._zooming&&!k.zooming&&this.fire(new E.Event("zoomstart",x)),this._rotating&&!k.rotating&&this.fire(new E.Event("rotatestart",x)),this._pitching&&!k.pitching&&this.fire(new E.Event("pitchstart",x))},S.prototype._fireMoveEvents=function(x){this.fire(new E.Event("move",x)),this._zooming&&this.fire(new E.Event("zoom",x)),this._rotating&&this.fire(new E.Event("rotate",x)),this._pitching&&this.fire(new E.Event("pitch",x))},S.prototype._afterEase=function(x,C){if(!this._easeId||!C||this._easeId!==C){delete this._easeId;var k=this._zooming,G=this._rotating,q=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,k&&this.fire(new E.Event("zoomend",x)),G&&this.fire(new E.Event("rotateend",x)),q&&this.fire(new E.Event("pitchend",x)),this.fire(new E.Event("moveend",x))}},S.prototype.flyTo=function(x,C){var k=this;if(!x.essential&&E.browser.prefersReducedMotion){var G=E.pick(x,["center","zoom","bearing","pitch","around"]);return this.jumpTo(G,C)}this.stop(),x=E.extend({offset:[0,0],speed:1.2,curve:1.42,easing:E.ease},x);var q=this.transform,de=this.getZoom(),ze=this.getBearing(),it=this.getPitch(),Bt=this.getPadding(),St="zoom"in x?E.clamp(+x.zoom,q.minZoom,q.maxZoom):de,Xt="bearing"in x?this._normalizeBearing(x.bearing,ze):ze,En="pitch"in x?+x.pitch:it,yn="padding"in x?x.padding:q.padding,Un=q.zoomScale(St-de),cn=E.Point.convert(x.offset),Rn=q.centerPoint.add(cn),Jn=q.pointLocation(Rn),hr=E.LngLat.convert(x.center||Jn);this._normalizeCenter(hr);var Lr=q.project(Jn),gr=q.project(hr).sub(Lr),Dr=x.curve,Fr=Math.max(q.width,q.height),Mi=Fr/Un,Pi=gr.mag();if("minZoom"in x){var vi=E.clamp(Math.min(x.minZoom,de,St),q.minZoom,q.maxZoom),Oo=Fr/q.zoomScale(vi-de);Dr=Math.sqrt(Oo/Pi*2)}var yo=Dr*Dr;function Ho(na){var Vo=(Mi*Mi-Fr*Fr+(na?-1:1)*yo*yo*Pi*Pi)/(2*(na?Mi:Fr)*yo*Pi);return Math.log(Math.sqrt(Vo*Vo+1)-Vo)}function is(na){return(Math.exp(na)-Math.exp(-na))/2}function Cr(na){return(Math.exp(na)+Math.exp(-na))/2}var Kt=Ho(0),Zr=function(na){return Cr(Kt)/Cr(Kt+Dr*na)},ko=function(na){return Fr*((Cr(Kt)*(is(Vo=Kt+Dr*na)/Cr(Vo))-is(Kt))/yo)/Pi;var Vo},qo=(Ho(1)-Kt)/Dr;if(Math.abs(Pi)<1e-6||!isFinite(qo)){if(Math.abs(Fr-Mi)<1e-6)return this.easeTo(x,C);var va=Mi<Fr?-1:1;qo=Math.abs(Math.log(Mi/Fr))/Dr,ko=function(){return 0},Zr=function(na){return Math.exp(va*Dr*na)}}return x.duration="duration"in x?+x.duration:1e3*qo/("screenSpeed"in x?+x.screenSpeed/Dr:+x.speed),x.maxDuration&&x.duration>x.maxDuration&&(x.duration=0),this._zooming=!0,this._rotating=ze!==Xt,this._pitching=En!==it,this._padding=!q.isPaddingEqual(yn),this._prepareEase(C,!1),this._ease(function(na){var Vo=na*qo,sl=1/Zr(Vo);q.zoom=na===1?St:de+q.scaleZoom(sl),k._rotating&&(q.bearing=E.number(ze,Xt,na)),k._pitching&&(q.pitch=E.number(it,En,na)),k._padding&&(q.interpolatePadding(Bt,yn,na),Rn=q.centerPoint.add(cn));var bl=na===1?hr:q.unproject(Lr.add(gr.mult(ko(Vo))).mult(sl));q.setLocationAtPoint(q.renderWorldCopies?bl.wrap():bl,Rn),k._fireMoveEvents(C)},function(){return k._afterEase(C)},x),this},S.prototype.isEasing=function(){return!!this._easeFrameId},S.prototype.stop=function(){return this._stop()},S.prototype._stop=function(x,C){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var k=this._onEaseEnd;delete this._onEaseEnd,k.call(this,C)}if(!x){var G=this.handlers;G&&G.stop(!1)}return this},S.prototype._ease=function(x,C,k){k.animate===!1||k.duration===0?(x(1),C()):(this._easeStart=E.browser.now(),this._easeOptions=k,this._onEaseFrame=x,this._onEaseEnd=C,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},S.prototype._renderFrameCallback=function(){var x=Math.min((E.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},S.prototype._normalizeBearing=function(x,C){x=E.wrap(x,-180,180);var k=Math.abs(x-C);return Math.abs(x-360-C)<k&&(x-=360),Math.abs(x+360-C)<k&&(x+=360),x},S.prototype._normalizeCenter=function(x){var C=this.transform;if(C.renderWorldCopies&&!C.lngRange){var k=x.lng-C.center.lng;x.lng+=k>180?-360:k<-180?360:0}},S}(E.Evented),lu=function(_){_===void 0&&(_={}),this.options=_,E.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};lu.prototype.getDefaultPosition=function(){return"bottom-right"},lu.prototype.onAdd=function(_){var S=this.options&&this.options.compact;return this._map=_,this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=re.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=re.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),S&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),S===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},lu.prototype.onRemove=function(){re.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},lu.prototype._setElementTitle=function(_,S){var x=this._map._getUIString("AttributionControl."+S);_.title=x,_.setAttribute("aria-label",x)},lu.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},lu.prototype._updateEditLink=function(){var _=this._editLink;_||(_=this._editLink=this._container.querySelector(".mapbox-improve-map"));var S=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||E.config.ACCESS_TOKEN}];if(_){var x=S.reduce(function(C,k,G){return k.value&&(C+=k.key+"="+k.value+(G<S.length-1?"&":"")),C},"?");_.href=E.config.FEEDBACK_URL+"/"+x+(this._map._hash?this._map._hash.getHashString(!0):""),_.rel="noopener nofollow",this._setElementTitle(_,"MapFeedback")}},lu.prototype._updateData=function(_){!_||_.sourceDataType!=="metadata"&&_.sourceDataType!=="visibility"&&_.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},lu.prototype._updateAttributions=function(){if(this._map.style){var _=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?_=_.concat(this.options.customAttribution.map(function(de){return typeof de!="string"?"":de})):typeof this.options.customAttribution=="string"&&_.push(this.options.customAttribution)),this._map.style.stylesheet){var S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}var x=this._map.style.sourceCaches;for(var C in x){var k=x[C];if(k.used){var G=k.getSource();G.attribution&&_.indexOf(G.attribution)<0&&_.push(G.attribution)}}_.sort(function(de,ze){return de.length-ze.length});var q=(_=_.filter(function(de,ze){for(var it=ze+1;it<_.length;it++)if(_[it].indexOf(de)>=0)return!1;return!0})).join(" | ");q!==this._attribHTML&&(this._attribHTML=q,_.length?(this._innerContainer.innerHTML=q,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},lu.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var nh=function(){E.bindAll(["_updateLogo"],this),E.bindAll(["_updateCompact"],this)};nh.prototype.onAdd=function(_){this._map=_,this._container=re.create("div","mapboxgl-ctrl");var S=re.create("a","mapboxgl-ctrl-logo");return S.target="_blank",S.rel="noopener nofollow",S.href="https://www.mapbox.com/",S.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),S.setAttribute("rel","noopener nofollow"),this._container.appendChild(S),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},nh.prototype.onRemove=function(){re.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},nh.prototype.getDefaultPosition=function(){return"bottom-left"},nh.prototype._updateLogo=function(_){_&&_.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},nh.prototype._logoRequired=function(){if(this._map.style){var _=this._map.style.sourceCaches;for(var S in _)if(_[S].getSource().mapbox_logo)return!0;return!1}},nh.prototype._updateCompact=function(){var _=this._container.children;if(_.length){var S=_[0];this._map.getCanvasContainer().offsetWidth<250?S.classList.add("mapboxgl-compact"):S.classList.remove("mapboxgl-compact")}};var dl=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};dl.prototype.add=function(_){var S=++this._id;return this._queue.push({callback:_,id:S,cancelled:!1}),S},dl.prototype.remove=function(_){for(var S=this._currentlyRunning,x=0,C=S?this._queue.concat(S):this._queue;x<C.length;x+=1){var k=C[x];if(k.id===_)return void(k.cancelled=!0)}},dl.prototype.run=function(_){_===void 0&&(_=0);var S=this._currentlyRunning=this._queue;this._queue=[];for(var x=0,C=S;x<C.length;x+=1){var k=C[x];if(!k.cancelled&&(k.callback(_),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},dl.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var bf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},wh=E.window.HTMLImageElement,kf=E.window.HTMLElement,xs=E.window.ImageBitmap,uc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Xd=function(_){function S(C){var k=this;if((C=E.extend({},uc,C)).minZoom!=null&&C.maxZoom!=null&&C.minZoom>C.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(C.minPitch!=null&&C.maxPitch!=null&&C.minPitch>C.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(C.minPitch!=null&&C.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(C.maxPitch!=null&&C.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var G=new Ie(C.minZoom,C.maxZoom,C.minPitch,C.maxPitch,C.renderWorldCopies);if(_.call(this,G,C),this._interactive=C.interactive,this._maxTileCacheSize=C.maxTileCacheSize,this._failIfMajorPerformanceCaveat=C.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=C.preserveDrawingBuffer,this._antialias=C.antialias,this._trackResize=C.trackResize,this._bearingSnap=C.bearingSnap,this._refreshExpiredTiles=C.refreshExpiredTiles,this._fadeDuration=C.fadeDuration,this._crossSourceCollisions=C.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=C.collectResourceTiming,this._renderTaskQueue=new dl,this._controls=[],this._mapId=E.uniqueId(),this._locale=E.extend({},bf,C.locale),this._clickTolerance=C.clickTolerance,this._requestManager=new E.RequestManager(C.transformRequest,C.accessToken),typeof C.container=="string"){if(this._container=E.window.document.getElementById(C.container),!this._container)throw new Error("Container '"+C.container+"' not found.")}else{if(!(C.container instanceof kf))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=C.container}if(C.maxBounds&&this.setMaxBounds(C.maxBounds),E.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return k._update(!1)}),this.on("moveend",function(){return k._update(!1)}),this.on("zoom",function(){return k._update(!0)}),E.window!==void 0&&(E.window.addEventListener("online",this._onWindowOnline,!1),E.window.addEventListener("resize",this._onWindowResize,!1),E.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Eo(this,C),this._hash=C.hash&&new gn(typeof C.hash=="string"&&C.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}),C.bounds&&(this.resize(),this.fitBounds(C.bounds,E.extend({},C.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=C.localIdeographFontFamily,C.style&&this.setStyle(C.style,{localIdeographFontFamily:C.localIdeographFontFamily}),C.attributionControl&&this.addControl(new lu({customAttribution:C.customAttribution})),this.addControl(new nh,C.logoPosition),this.on("style.load",function(){k.transform.unmodified&&k.jumpTo(k.style.stylesheet)}),this.on("data",function(q){k._update(q.dataType==="style"),k.fire(new E.Event(q.dataType+"data",q))}),this.on("dataloading",function(q){k.fire(new E.Event(q.dataType+"dataloading",q))})}_&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S;var x={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return S.prototype._getMapId=function(){return this._mapId},S.prototype.addControl=function(C,k){if(k===void 0&&(k=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new E.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var G=C.onAdd(this);this._controls.push(C);var q=this._controlPositions[k];return k.indexOf("bottom")!==-1?q.insertBefore(G,q.firstChild):q.appendChild(G),this},S.prototype.removeControl=function(C){if(!C||!C.onRemove)return this.fire(new E.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var k=this._controls.indexOf(C);return k>-1&&this._controls.splice(k,1),C.onRemove(this),this},S.prototype.hasControl=function(C){return this._controls.indexOf(C)>-1},S.prototype.resize=function(C){var k=this._containerDimensions(),G=k[0],q=k[1];if(G===this.transform.width&&q===this.transform.height)return this;this._resizeCanvas(G,q),this.transform.resize(G,q),this.painter.resize(G,q);var de=!this._moving;return de&&this.fire(new E.Event("movestart",C)).fire(new E.Event("move",C)),this.fire(new E.Event("resize",C)),de&&this.fire(new E.Event("moveend",C)),this},S.prototype.getBounds=function(){return this.transform.getBounds()},S.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},S.prototype.setMaxBounds=function(C){return this.transform.setMaxBounds(E.LngLatBounds.convert(C)),this._update()},S.prototype.setMinZoom=function(C){if((C=C==null?-2:C)>=-2&&C<=this.transform.maxZoom)return this.transform.minZoom=C,this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},S.prototype.getMinZoom=function(){return this.transform.minZoom},S.prototype.setMaxZoom=function(C){if((C=C==null?22:C)>=this.transform.minZoom)return this.transform.maxZoom=C,this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")},S.prototype.getMaxZoom=function(){return this.transform.maxZoom},S.prototype.setMinPitch=function(C){if((C=C==null?0:C)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.minPitch=C,this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},S.prototype.getMinPitch=function(){return this.transform.minPitch},S.prototype.setMaxPitch=function(C){if((C=C==null?60:C)>60)throw new Error("maxPitch must be less than or equal to 60");if(C>=this.transform.minPitch)return this.transform.maxPitch=C,this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")},S.prototype.getMaxPitch=function(){return this.transform.maxPitch},S.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},S.prototype.setRenderWorldCopies=function(C){return this.transform.renderWorldCopies=C,this._update()},S.prototype.project=function(C){return this.transform.locationPoint(E.LngLat.convert(C))},S.prototype.unproject=function(C){return this.transform.pointLocation(E.Point.convert(C))},S.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},S.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},S.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},S.prototype._createDelegatedListener=function(C,k,G){var q,de=this;if(C==="mouseenter"||C==="mouseover"){var ze=!1;return{layer:k,listener:G,delegates:{mousemove:function(Bt){var St=de.getLayer(k)?de.queryRenderedFeatures(Bt.point,{layers:[k]}):[];St.length?ze||(ze=!0,G.call(de,new Na(C,de,Bt.originalEvent,{features:St}))):ze=!1},mouseout:function(){ze=!1}}}}if(C==="mouseleave"||C==="mouseout"){var it=!1;return{layer:k,listener:G,delegates:{mousemove:function(Bt){(de.getLayer(k)?de.queryRenderedFeatures(Bt.point,{layers:[k]}):[]).length?it=!0:it&&(it=!1,G.call(de,new Na(C,de,Bt.originalEvent)))},mouseout:function(Bt){it&&(it=!1,G.call(de,new Na(C,de,Bt.originalEvent)))}}}}return{layer:k,listener:G,delegates:(q={},q[C]=function(Bt){var St=de.getLayer(k)?de.queryRenderedFeatures(Bt.point,{layers:[k]}):[];St.length&&(Bt.features=St,G.call(de,Bt),delete Bt.features)},q)}},S.prototype.on=function(C,k,G){if(G===void 0)return _.prototype.on.call(this,C,k);var q=this._createDelegatedListener(C,k,G);for(var de in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(q),q.delegates)this.on(de,q.delegates[de]);return this},S.prototype.once=function(C,k,G){if(G===void 0)return _.prototype.once.call(this,C,k);var q=this._createDelegatedListener(C,k,G);for(var de in q.delegates)this.once(de,q.delegates[de]);return this},S.prototype.off=function(C,k,G){var q=this;return G===void 0?_.prototype.off.call(this,C,k):(this._delegatedListeners&&this._delegatedListeners[C]&&function(de){for(var ze=de[C],it=0;it<ze.length;it++){var Bt=ze[it];if(Bt.layer===k&&Bt.listener===G){for(var St in Bt.delegates)q.off(St,Bt.delegates[St]);return ze.splice(it,1),q}}}(this._delegatedListeners),this)},S.prototype.queryRenderedFeatures=function(C,k){if(!this.style)return[];var G;if(k!==void 0||C===void 0||C instanceof E.Point||Array.isArray(C)||(k=C,C=void 0),k=k||{},(C=C||[[0,0],[this.transform.width,this.transform.height]])instanceof E.Point||typeof C[0]=="number")G=[E.Point.convert(C)];else{var q=E.Point.convert(C[0]),de=E.Point.convert(C[1]);G=[q,new E.Point(de.x,q.y),de,new E.Point(q.x,de.y),q]}return this.style.queryRenderedFeatures(G,k,this.transform)},S.prototype.querySourceFeatures=function(C,k){return this.style.querySourceFeatures(C,k)},S.prototype.setStyle=function(C,k){return(k=E.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},k)).diff!==!1&&k.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&C?(this._diffStyle(C,k),this):(this._localIdeographFontFamily=k.localIdeographFontFamily,this._updateStyle(C,k))},S.prototype._getUIString=function(C){var k=this._locale[C];if(k==null)throw new Error("Missing UI string '"+C+"'");return k},S.prototype._updateStyle=function(C,k){return this.style&&(this.style.setEventedParent(null),this.style._remove()),C?(this.style=new lc(this,k||{}),this.style.setEventedParent(this,{style:this.style}),typeof C=="string"?this.style.loadURL(C):this.style.loadJSON(C),this):(delete this.style,this)},S.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new lc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},S.prototype._diffStyle=function(C,k){var G=this;if(typeof C=="string"){var q=this._requestManager.normalizeStyleURL(C),de=this._requestManager.transformRequest(q,E.ResourceType.Style);E.getJSON(de,function(ze,it){ze?G.fire(new E.ErrorEvent(ze)):it&&G._updateDiff(it,k)})}else typeof C=="object"&&this._updateDiff(C,k)},S.prototype._updateDiff=function(C,k){try{this.style.setState(C)&&this._update(!0)}catch(G){E.warnOnce("Unable to perform style diff: "+(G.message||G.error||G)+".  Rebuilding the style from scratch."),this._updateStyle(C,k)}},S.prototype.getStyle=function(){if(this.style)return this.style.serialize()},S.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():E.warnOnce("There is no style added to the map.")},S.prototype.addSource=function(C,k){return this._lazyInitEmptyStyle(),this.style.addSource(C,k),this._update(!0)},S.prototype.isSourceLoaded=function(C){var k=this.style&&this.style.sourceCaches[C];if(k!==void 0)return k.loaded();this.fire(new E.ErrorEvent(new Error("There is no source with ID '"+C+"'")))},S.prototype.areTilesLoaded=function(){var C=this.style&&this.style.sourceCaches;for(var k in C){var G=C[k]._tiles;for(var q in G){var de=G[q];if(de.state!=="loaded"&&de.state!=="errored")return!1}}return!0},S.prototype.addSourceType=function(C,k,G){return this._lazyInitEmptyStyle(),this.style.addSourceType(C,k,G)},S.prototype.removeSource=function(C){return this.style.removeSource(C),this._update(!0)},S.prototype.getSource=function(C){return this.style.getSource(C)},S.prototype.addImage=function(C,k,G){G===void 0&&(G={});var q=G.pixelRatio;q===void 0&&(q=1);var de=G.sdf;de===void 0&&(de=!1);var ze=G.stretchX,it=G.stretchY,Bt=G.content;if(this._lazyInitEmptyStyle(),k instanceof wh||xs&&k instanceof xs){var St=E.browser.getImageData(k);this.style.addImage(C,{data:new E.RGBAImage({width:St.width,height:St.height},St.data),pixelRatio:q,stretchX:ze,stretchY:it,content:Bt,sdf:de,version:0})}else{if(k.width===void 0||k.height===void 0)return this.fire(new E.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Xt=k;this.style.addImage(C,{data:new E.RGBAImage({width:k.width,height:k.height},new Uint8Array(k.data)),pixelRatio:q,stretchX:ze,stretchY:it,content:Bt,sdf:de,version:0,userImage:Xt}),Xt.onAdd&&Xt.onAdd(this,C)}},S.prototype.updateImage=function(C,k){var G=this.style.getImage(C);if(!G)return this.fire(new E.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var q=k instanceof wh||xs&&k instanceof xs?E.browser.getImageData(k):k,de=q.width,ze=q.height,it=q.data;return de===void 0||ze===void 0?this.fire(new E.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):de!==G.data.width||ze!==G.data.height?this.fire(new E.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(G.data.replace(it,!(k instanceof wh||xs&&k instanceof xs)),void this.style.updateImage(C,G))},S.prototype.hasImage=function(C){return C?!!this.style.getImage(C):(this.fire(new E.ErrorEvent(new Error("Missing required image id"))),!1)},S.prototype.removeImage=function(C){this.style.removeImage(C)},S.prototype.loadImage=function(C,k){E.getImage(this._requestManager.transformRequest(C,E.ResourceType.Image),k)},S.prototype.listImages=function(){return this.style.listImages()},S.prototype.addLayer=function(C,k){return this._lazyInitEmptyStyle(),this.style.addLayer(C,k),this._update(!0)},S.prototype.moveLayer=function(C,k){return this.style.moveLayer(C,k),this._update(!0)},S.prototype.removeLayer=function(C){return this.style.removeLayer(C),this._update(!0)},S.prototype.getLayer=function(C){return this.style.getLayer(C)},S.prototype.setLayerZoomRange=function(C,k,G){return this.style.setLayerZoomRange(C,k,G),this._update(!0)},S.prototype.setFilter=function(C,k,G){return G===void 0&&(G={}),this.style.setFilter(C,k,G),this._update(!0)},S.prototype.getFilter=function(C){return this.style.getFilter(C)},S.prototype.setPaintProperty=function(C,k,G,q){return q===void 0&&(q={}),this.style.setPaintProperty(C,k,G,q),this._update(!0)},S.prototype.getPaintProperty=function(C,k){return this.style.getPaintProperty(C,k)},S.prototype.setLayoutProperty=function(C,k,G,q){return q===void 0&&(q={}),this.style.setLayoutProperty(C,k,G,q),this._update(!0)},S.prototype.getLayoutProperty=function(C,k){return this.style.getLayoutProperty(C,k)},S.prototype.setLight=function(C,k){return k===void 0&&(k={}),this._lazyInitEmptyStyle(),this.style.setLight(C,k),this._update(!0)},S.prototype.getLight=function(){return this.style.getLight()},S.prototype.setFeatureState=function(C,k){return this.style.setFeatureState(C,k),this._update()},S.prototype.removeFeatureState=function(C,k){return this.style.removeFeatureState(C,k),this._update()},S.prototype.getFeatureState=function(C){return this.style.getFeatureState(C)},S.prototype.getContainer=function(){return this._container},S.prototype.getCanvasContainer=function(){return this._canvasContainer},S.prototype.getCanvas=function(){return this._canvas},S.prototype._containerDimensions=function(){var C=0,k=0;return this._container&&(C=this._container.clientWidth||400,k=this._container.clientHeight||300),[C,k]},S.prototype._detectMissingCSS=function(){E.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&E.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},S.prototype._setupContainer=function(){var C=this._container;C.classList.add("mapboxgl-map"),(this._missingCSSCanary=re.create("div","mapboxgl-canary",C)).style.visibility="hidden",this._detectMissingCSS();var k=this._canvasContainer=re.create("div","mapboxgl-canvas-container",C);this._interactive&&k.classList.add("mapboxgl-interactive"),this._canvas=re.create("canvas","mapboxgl-canvas",k),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var G=this._containerDimensions();this._resizeCanvas(G[0],G[1]);var q=this._controlContainer=re.create("div","mapboxgl-control-container",C),de=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ze){de[ze]=re.create("div","mapboxgl-ctrl-"+ze,q)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},S.prototype._resizeCanvas=function(C,k){var G=E.browser.devicePixelRatio||1;this._canvas.width=G*C,this._canvas.height=G*k,this._canvas.style.width=C+"px",this._canvas.style.height=k+"px"},S.prototype._setupPainter=function(){var C=E.extend({},_e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),k=this._canvas.getContext("webgl",C)||this._canvas.getContext("experimental-webgl",C);k?(this.painter=new ks(k,this.transform),E.webpSupported.testSupport(k)):this.fire(new E.ErrorEvent(new Error("Failed to initialize WebGL")))},S.prototype._contextLost=function(C){C.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new E.Event("webglcontextlost",{originalEvent:C}))},S.prototype._contextRestored=function(C){this._setupPainter(),this.resize(),this._update(),this.fire(new E.Event("webglcontextrestored",{originalEvent:C}))},S.prototype._onMapScroll=function(C){if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},S.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},S.prototype._update=function(C){return this.style?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this},S.prototype._requestRenderFrame=function(C){return this._update(),this._renderTaskQueue.add(C)},S.prototype._cancelRenderFrame=function(C){this._renderTaskQueue.remove(C)},S.prototype._render=function(C){var k,G=this,q=0,de=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(k=de.createQueryEXT(),de.beginQueryEXT(de.TIME_ELAPSED_EXT,k),q=E.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),!this._removed){var ze=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var it=this.transform.zoom,Bt=E.browser.now();this.style.zoomHistory.update(it,Bt);var St=new E.EvaluationParameters(it,{now:Bt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Xt=St.crossFadingFactor();Xt===1&&Xt===this._crossFadingFactor||(ze=!0,this._crossFadingFactor=Xt),this.style.update(St)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new E.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new E.Event("load"))),this.style&&(this.style.hasTransitions()||ze)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var En=E.browser.now()-q;de.endQueryEXT(de.TIME_ELAPSED_EXT,k),setTimeout(function(){var cn=de.getQueryObjectEXT(k,de.QUERY_RESULT_EXT)/1e6;de.deleteQueryEXT(k),G.fire(new E.Event("gpu-timing-frame",{cpuTime:En,gpuTime:cn}))},50)}if(this.listens("gpu-timing-layer")){var yn=this.painter.collectGpuTimers();setTimeout(function(){var cn=G.painter.queryGpuTimers(yn);G.fire(new E.Event("gpu-timing-layer",{layerTimes:cn}))},50)}var Un=this._sourcesDirty||this._styleDirty||this._placementDirty;return Un||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new E.Event("idle")),!this._loaded||this._fullyLoaded||Un||(this._fullyLoaded=!0),this}},S.prototype.remove=function(){this._hash&&this._hash.remove();for(var C=0,k=this._controls;C<k.length;C+=1)k[C].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),E.window!==void 0&&(E.window.removeEventListener("resize",this._onWindowResize,!1),E.window.removeEventListener("orientationchange",this._onWindowResize,!1),E.window.removeEventListener("online",this._onWindowOnline,!1));var G=this.painter.context.gl.getExtension("WEBGL_lose_context");G&&G.loseContext(),Kh(this._canvasContainer),Kh(this._controlContainer),Kh(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new E.Event("remove"))},S.prototype.triggerRepaint=function(){var C=this;this.style&&!this._frame&&(this._frame=E.browser.frame(function(k){C._frame=null,C._render(k)}))},S.prototype._onWindowOnline=function(){this._update()},S.prototype._onWindowResize=function(C){this._trackResize&&this.resize({originalEvent:C})._update()},x.showTileBoundaries.get=function(){return!!this._showTileBoundaries},x.showTileBoundaries.set=function(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())},x.showPadding.get=function(){return!!this._showPadding},x.showPadding.set=function(C){this._showPadding!==C&&(this._showPadding=C,this._update())},x.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},x.showCollisionBoxes.set=function(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())},x.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},x.showOverdrawInspector.set=function(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())},x.repaint.get=function(){return!!this._repaint},x.repaint.set=function(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())},x.vertices.get=function(){return!!this._vertices},x.vertices.set=function(C){this._vertices=C,this._update()},S.prototype._setCacheLimits=function(C,k){E.setCacheLimits(C,k)},x.version.get=function(){return E.version},Object.defineProperties(S.prototype,x),S}(kc);function Kh(_){_.parentNode&&_.parentNode.removeChild(_)}var U0={showCompass:!0,showZoom:!0,visualizePitch:!1},Ah=function(_){var S=this;this.options=E.extend({},U0,_),this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(x){return x.preventDefault()}),this.options.showZoom&&(E.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(x){return S._map.zoomIn({},{originalEvent:x})}),re.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(x){return S._map.zoomOut({},{originalEvent:x})}),re.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(E.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(x){S.options.visualizePitch?S._map.resetNorthPitch({},{originalEvent:x}):S._map.resetNorth({},{originalEvent:x})}),this._compassIcon=re.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ah.prototype._updateZoomButtons=function(){var _=this._map.getZoom(),S=_===this._map.getMaxZoom(),x=_===this._map.getMinZoom();this._zoomInButton.disabled=S,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",S.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())},Ah.prototype._rotateCompassArrow=function(){var _=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=_},Ah.prototype.onAdd=function(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Su(this._map,this._compass,this.options.visualizePitch)),this._container},Ah.prototype.onRemove=function(){re.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ah.prototype._createButton=function(_,S){var x=re.create("button",_,this._container);return x.type="button",x.addEventListener("click",S),x},Ah.prototype._setButtonTitle=function(_,S){var x=this._map._getUIString("NavigationControl."+S);_.title=x,_.setAttribute("aria-label",x)};var Su=function(_,S,x){x===void 0&&(x=!1),this._clickTolerance=10,this.element=S,this.mouseRotate=new Eu({clickTolerance:_.dragRotate._mouseRotate._clickTolerance}),this.map=_,x&&(this.mousePitch=new Ep({clickTolerance:_.dragRotate._mousePitch._clickTolerance})),E.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),re.addEventListener(S,"mousedown",this.mousedown),re.addEventListener(S,"touchstart",this.touchstart,{passive:!1}),re.addEventListener(S,"touchmove",this.touchmove),re.addEventListener(S,"touchend",this.touchend),re.addEventListener(S,"touchcancel",this.reset)};function Yd(_,S,x){if(_=new E.LngLat(_.lng,_.lat),S){var C=new E.LngLat(_.lng-360,_.lat),k=new E.LngLat(_.lng+360,_.lat),G=x.locationPoint(_).distSqr(S);x.locationPoint(C).distSqr(S)<G?_=C:x.locationPoint(k).distSqr(S)<G&&(_=k)}for(;Math.abs(_.lng-x.center.lng)>180;){var q=x.locationPoint(_);if(q.x>=0&&q.y>=0&&q.x<=x.width&&q.y<=x.height)break;_.lng>x.center.lng?_.lng-=360:_.lng+=360}return _}Su.prototype.down=function(_,S){this.mouseRotate.mousedown(_,S),this.mousePitch&&this.mousePitch.mousedown(_,S),re.disableDrag()},Su.prototype.move=function(_,S){var x=this.map,C=this.mouseRotate.mousemoveWindow(_,S);if(C&&C.bearingDelta&&x.setBearing(x.getBearing()+C.bearingDelta),this.mousePitch){var k=this.mousePitch.mousemoveWindow(_,S);k&&k.pitchDelta&&x.setPitch(x.getPitch()+k.pitchDelta)}},Su.prototype.off=function(){var _=this.element;re.removeEventListener(_,"mousedown",this.mousedown),re.removeEventListener(_,"touchstart",this.touchstart,{passive:!1}),re.removeEventListener(_,"touchmove",this.touchmove),re.removeEventListener(_,"touchend",this.touchend),re.removeEventListener(_,"touchcancel",this.reset),this.offTemp()},Su.prototype.offTemp=function(){re.enableDrag(),re.removeEventListener(E.window,"mousemove",this.mousemove),re.removeEventListener(E.window,"mouseup",this.mouseup)},Su.prototype.mousedown=function(_){this.down(E.extend({},_,{ctrlKey:!0,preventDefault:function(){return _.preventDefault()}}),re.mousePos(this.element,_)),re.addEventListener(E.window,"mousemove",this.mousemove),re.addEventListener(E.window,"mouseup",this.mouseup)},Su.prototype.mousemove=function(_){this.move(_,re.mousePos(this.element,_))},Su.prototype.mouseup=function(_){this.mouseRotate.mouseupWindow(_),this.mousePitch&&this.mousePitch.mouseupWindow(_),this.offTemp()},Su.prototype.touchstart=function(_){_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=re.touchPos(this.element,_.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return _.preventDefault()}},this._startPos))},Su.prototype.touchmove=function(_){_.targetTouches.length!==1?this.reset():(this._lastPos=re.touchPos(this.element,_.targetTouches)[0],this.move({preventDefault:function(){return _.preventDefault()}},this._lastPos))},Su.prototype.touchend=function(_){_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Su.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var zf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function wp(_,S,x){var C=_.classList;for(var k in zf)C.remove("mapboxgl-"+x+"-anchor-"+k);C.add("mapboxgl-"+x+"-anchor-"+S)}var Yr,Uf=function(_){function S(x,C){if(_.call(this),(x instanceof E.window.HTMLElement||C)&&(x=E.extend({element:x},C)),E.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=x&&x.anchor||"center",this._color=x&&x.color||"#3FB1CE",this._scale=x&&x.scale||1,this._draggable=x&&x.draggable||!1,this._clickTolerance=x&&x.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=x&&x.rotation||0,this._rotationAlignment=x&&x.rotationAlignment||"auto",this._pitchAlignment=x&&x.pitchAlignment&&x.pitchAlignment!=="auto"?x.pitchAlignment:this._rotationAlignment,x&&x.element)this._element=x.element,this._offset=E.Point.convert(x&&x.offset||[0,0]);else{this._defaultMarker=!0,this._element=re.create("div"),this._element.setAttribute("aria-label","Map marker");var k=re.createNS("http://www.w3.org/2000/svg","svg");k.setAttributeNS(null,"display","block"),k.setAttributeNS(null,"height","41px"),k.setAttributeNS(null,"width","27px"),k.setAttributeNS(null,"viewBox","0 0 27 41");var G=re.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"stroke","none"),G.setAttributeNS(null,"stroke-width","1"),G.setAttributeNS(null,"fill","none"),G.setAttributeNS(null,"fill-rule","evenodd");var q=re.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill-rule","nonzero");var de=re.createNS("http://www.w3.org/2000/svg","g");de.setAttributeNS(null,"transform","translate(3.0, 29.0)"),de.setAttributeNS(null,"fill","#000000");for(var ze=0,it=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ze<it.length;ze+=1){var Bt=it[ze],St=re.createNS("http://www.w3.org/2000/svg","ellipse");St.setAttributeNS(null,"opacity","0.04"),St.setAttributeNS(null,"cx","10.5"),St.setAttributeNS(null,"cy","5.80029008"),St.setAttributeNS(null,"rx",Bt.rx),St.setAttributeNS(null,"ry",Bt.ry),de.appendChild(St)}var Xt=re.createNS("http://www.w3.org/2000/svg","g");Xt.setAttributeNS(null,"fill",this._color);var En=re.createNS("http://www.w3.org/2000/svg","path");En.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Xt.appendChild(En);var yn=re.createNS("http://www.w3.org/2000/svg","g");yn.setAttributeNS(null,"opacity","0.25"),yn.setAttributeNS(null,"fill","#000000");var Un=re.createNS("http://www.w3.org/2000/svg","path");Un.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),yn.appendChild(Un);var cn=re.createNS("http://www.w3.org/2000/svg","g");cn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),cn.setAttributeNS(null,"fill","#FFFFFF");var Rn=re.createNS("http://www.w3.org/2000/svg","g");Rn.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Jn=re.createNS("http://www.w3.org/2000/svg","circle");Jn.setAttributeNS(null,"fill","#000000"),Jn.setAttributeNS(null,"opacity","0.25"),Jn.setAttributeNS(null,"cx","5.5"),Jn.setAttributeNS(null,"cy","5.5"),Jn.setAttributeNS(null,"r","5.4999962");var hr=re.createNS("http://www.w3.org/2000/svg","circle");hr.setAttributeNS(null,"fill","#FFFFFF"),hr.setAttributeNS(null,"cx","5.5"),hr.setAttributeNS(null,"cy","5.5"),hr.setAttributeNS(null,"r","5.4999962"),Rn.appendChild(Jn),Rn.appendChild(hr),q.appendChild(de),q.appendChild(Xt),q.appendChild(yn),q.appendChild(cn),q.appendChild(Rn),k.appendChild(q),k.setAttributeNS(null,"height",41*this._scale+"px"),k.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(k),this._offset=E.Point.convert(x&&x.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Lr){Lr.preventDefault()}),this._element.addEventListener("mousedown",function(Lr){Lr.preventDefault()}),wp(this._element,this._anchor,"marker"),this._popup=null}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.addTo=function(x){return this.remove(),this._map=x,x.getCanvasContainer().appendChild(this._element),x.on("move",this._update),x.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},S.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),re.remove(this._element),this._popup&&this._popup.remove(),this},S.prototype.getLngLat=function(){return this._lngLat},S.prototype.setLngLat=function(x){return this._lngLat=E.LngLat.convert(x),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},S.prototype.getElement=function(){return this._element},S.prototype.setPopup=function(x){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),x){if(!("offset"in x.options)){var C=Math.sqrt(Math.pow(13.5,2)/2);x.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(24.6+C)],"bottom-right":[-C,-1*(24.6+C)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=x,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},S.prototype._onKeyPress=function(x){var C=x.code,k=x.charCode||x.keyCode;C!=="Space"&&C!=="Enter"&&k!==32&&k!==13||this.togglePopup()},S.prototype._onMapClick=function(x){var C=x.originalEvent.target,k=this._element;this._popup&&(C===k||k.contains(C))&&this.togglePopup()},S.prototype.getPopup=function(){return this._popup},S.prototype.togglePopup=function(){var x=this._popup;return x?(x.isOpen()?x.remove():x.addTo(this._map),this):this},S.prototype._update=function(x){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Yd(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(C="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k="rotateX("+this._map.getPitch()+"deg)"),x&&x.type!=="moveend"||(this._pos=this._pos.round()),re.setTransform(this._element,zf[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+k+" "+C)}},S.prototype.getOffset=function(){return this._offset},S.prototype.setOffset=function(x){return this._offset=E.Point.convert(x),this._update(),this},S.prototype._onMove=function(x){if(!this._isDragging){var C=this._clickTolerance||this._map._clickTolerance;this._isDragging=x.point.dist(this._pointerdownPos)>=C}this._isDragging&&(this._pos=x.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new E.Event("dragstart"))),this.fire(new E.Event("drag")))},S.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new E.Event("dragend")),this._state="inactive"},S.prototype._addDragHandler=function(x){this._element.contains(x.originalEvent.target)&&(x.preventDefault(),this._positionDelta=x.point.sub(this._pos).add(this._offset),this._pointerdownPos=x.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},S.prototype.setDraggable=function(x){return this._draggable=!!x,this._map&&(x?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},S.prototype.isDraggable=function(){return this._draggable},S.prototype.setRotation=function(x){return this._rotation=x||0,this._update(),this},S.prototype.getRotation=function(){return this._rotation},S.prototype.setRotationAlignment=function(x){return this._rotationAlignment=x||"auto",this._update(),this},S.prototype.getRotationAlignment=function(){return this._rotationAlignment},S.prototype.setPitchAlignment=function(x){return this._pitchAlignment=x&&x!=="auto"?x:this._rotationAlignment,this._update(),this},S.prototype.getPitchAlignment=function(){return this._pitchAlignment},S}(E.Evented),jf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},qh=0,xf=!1,Ap=function(_){function S(x){_.call(this),this.options=E.extend({},jf,x),E.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.onAdd=function(x){var C;return this._map=x,this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),C=this._setupUI,Yr!==void 0?C(Yr):E.window.navigator.permissions!==void 0?E.window.navigator.permissions.query({name:"geolocation"}).then(function(k){C(Yr=k.state!=="denied")}):C(Yr=!!E.window.navigator.geolocation),this._container},S.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(E.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),re.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,qh=0,xf=!1},S.prototype._isOutOfMapMaxBounds=function(x){var C=this._map.getMaxBounds(),k=x.coords;return C&&(k.longitude<C.getWest()||k.longitude>C.getEast()||k.latitude<C.getSouth()||k.latitude>C.getNorth())},S.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},S.prototype._onSuccess=function(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new E.Event("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(x),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(x),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new E.Event("geolocate",x)),this._finish()}},S.prototype._updateCamera=function(x){var C=new E.LngLat(x.coords.longitude,x.coords.latitude),k=x.coords.accuracy,G=this._map.getBearing(),q=E.extend({bearing:G},this.options.fitBoundsOptions);this._map.fitBounds(C.toBounds(k),q,{geolocateSource:!0})},S.prototype._updateMarker=function(x){if(x){var C=new E.LngLat(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(C).addTo(this._map),this._userLocationDotMarker.setLngLat(C).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},S.prototype._updateCircleRadius=function(){var x=this._map._container.clientHeight/2,C=this._map.unproject([0,x]),k=this._map.unproject([1,x]),G=C.distanceTo(k),q=Math.ceil(2*this._accuracy/G);this._circleElement.style.width=q+"px",this._circleElement.style.height=q+"px"},S.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},S.prototype._onError=function(x){if(this._map){if(this.options.trackUserLocation)if(x.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(x.code===3&&xf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new E.Event("error",x)),this._finish()}},S.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},S.prototype._setupUI=function(x){var C=this;if(this._container.addEventListener("contextmenu",function(q){return q.preventDefault()}),this._geolocateButton=re.create("button","mapboxgl-ctrl-geolocate",this._container),re.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",x===!1){E.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}else{var G=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=G,this._geolocateButton.setAttribute("aria-label",G)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=re.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Uf(this._dotElement),this._circleElement=re.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Uf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(q){q.geolocateSource||C._watchState!=="ACTIVE_LOCK"||q.originalEvent&&q.originalEvent.type==="resize"||(C._watchState="BACKGROUND",C._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),C._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),C.fire(new E.Event("trackuserlocationend")))})},S.prototype.trigger=function(){if(!this._setup)return E.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new E.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qh--,xf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new E.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new E.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var x;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++qh>1?(x={maximumAge:6e5,timeout:0},xf=!0):(x=this.options.positionOptions,xf=!1),this._geolocationWatchID=E.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else E.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},S.prototype._clearWatch=function(){E.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},S}(E.Evented),sf={maxWidth:100,unit:"metric"},Ef=function(_){this.options=E.extend({},sf,_),E.bindAll(["_onMove","setUnit"],this)};function o0(_,S,x){var C=x&&x.maxWidth||100,k=_._container.clientHeight/2,G=_.unproject([0,k]),q=_.unproject([C,k]),de=G.distanceTo(q);if(x&&x.unit==="imperial"){var ze=3.2808*de;ze>5280?rh(S,C,ze/5280,_._getUIString("ScaleControl.Miles")):rh(S,C,ze,_._getUIString("ScaleControl.Feet"))}else x&&x.unit==="nautical"?rh(S,C,de/1852,_._getUIString("ScaleControl.NauticalMiles")):de>=1e3?rh(S,C,de/1e3,_._getUIString("ScaleControl.Kilometers")):rh(S,C,de,_._getUIString("ScaleControl.Meters"))}function rh(_,S,x,C){var k,G,q,de=(k=x,(G=Math.pow(10,(""+Math.floor(k)).length-1))*(q=(q=k/G)>=10?10:q>=5?5:q>=3?3:q>=2?2:q>=1?1:function(ze){var it=Math.pow(10,Math.ceil(-Math.log(ze)/Math.LN10));return Math.round(ze*it)/it}(q)));_.style.width=S*(de/x)+"px",_.innerHTML=de+"&nbsp;"+C}Ef.prototype.getDefaultPosition=function(){return"bottom-left"},Ef.prototype._onMove=function(){o0(this._map,this._container,this.options)},Ef.prototype.onAdd=function(_){return this._map=_,this._container=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ef.prototype.onRemove=function(){re.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ef.prototype.setUnit=function(_){this.options.unit=_,o0(this._map,this._container,this.options)};var Yc=function(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof E.window.HTMLElement?this._container=_.container:E.warnOnce("Full screen control 'container' must be a DOM element.")),E.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in E.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in E.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in E.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in E.window.document&&(this._fullscreenchange="MSFullscreenChange")};Yc.prototype.onAdd=function(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=re.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",E.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Yc.prototype.onRemove=function(){re.remove(this._controlContainer),this._map=null,E.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Yc.prototype._checkFullscreenSupport=function(){return!!(E.window.document.fullscreenEnabled||E.window.document.mozFullScreenEnabled||E.window.document.msFullscreenEnabled||E.window.document.webkitFullscreenEnabled)},Yc.prototype._setupUI=function(){var _=this._fullscreenButton=re.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);re.create("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden",!0),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),E.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Yc.prototype._updateTitle=function(){var _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_},Yc.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Yc.prototype._isFullscreen=function(){return this._fullscreen},Yc.prototype._changeIcon=function(){(E.window.document.fullscreenElement||E.window.document.mozFullScreenElement||E.window.document.webkitFullscreenElement||E.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Yc.prototype._onClickFullscreen=function(){this._isFullscreen()?E.window.document.exitFullscreen?E.window.document.exitFullscreen():E.window.document.mozCancelFullScreen?E.window.document.mozCancelFullScreen():E.window.document.msExitFullscreen?E.window.document.msExitFullscreen():E.window.document.webkitCancelFullScreen&&E.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var $c={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ds=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Tu=function(_){function S(x){_.call(this),this.options=E.extend(Object.create($c),x),E.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return _&&(S.__proto__=_),(S.prototype=Object.create(_&&_.prototype)).constructor=S,S.prototype.addTo=function(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new E.Event("open")),this},S.prototype.isOpen=function(){return!!this._map},S.prototype.remove=function(){return this._content&&re.remove(this._content),this._container&&(re.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new E.Event("close")),this},S.prototype.getLngLat=function(){return this._lngLat},S.prototype.setLngLat=function(x){return this._lngLat=E.LngLat.convert(x),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},S.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},S.prototype.getElement=function(){return this._container},S.prototype.setText=function(x){return this.setDOMContent(E.window.document.createTextNode(x))},S.prototype.setHTML=function(x){var C,k=E.window.document.createDocumentFragment(),G=E.window.document.createElement("body");for(G.innerHTML=x;C=G.firstChild;)k.appendChild(C);return this.setDOMContent(k)},S.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},S.prototype.setMaxWidth=function(x){return this.options.maxWidth=x,this._update(),this},S.prototype.setDOMContent=function(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=re.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this},S.prototype.addClassName=function(x){this._container&&this._container.classList.add(x)},S.prototype.removeClassName=function(x){this._container&&this._container.classList.remove(x)},S.prototype.setOffset=function(x){return this.options.offset=x,this._update(),this},S.prototype.toggleClassName=function(x){if(this._container)return this._container.classList.toggle(x)},S.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=re.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},S.prototype._onMouseUp=function(x){this._update(x.point)},S.prototype._onMouseMove=function(x){this._update(x.point)},S.prototype._onDrag=function(x){this._update(x.point)},S.prototype._update=function(x){var C=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=re.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=re.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(St){return C._container.classList.add(St)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Yd(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||x)){var k=this._pos=this._trackPointer&&x?x:this._map.project(this._lngLat),G=this.options.anchor,q=function St(Xt){if(Xt){if(typeof Xt=="number"){var En=Math.round(Math.sqrt(.5*Math.pow(Xt,2)));return{center:new E.Point(0,0),top:new E.Point(0,Xt),"top-left":new E.Point(En,En),"top-right":new E.Point(-En,En),bottom:new E.Point(0,-Xt),"bottom-left":new E.Point(En,-En),"bottom-right":new E.Point(-En,-En),left:new E.Point(Xt,0),right:new E.Point(-Xt,0)}}if(Xt instanceof E.Point||Array.isArray(Xt)){var yn=E.Point.convert(Xt);return{center:yn,top:yn,"top-left":yn,"top-right":yn,bottom:yn,"bottom-left":yn,"bottom-right":yn,left:yn,right:yn}}return{center:E.Point.convert(Xt.center||[0,0]),top:E.Point.convert(Xt.top||[0,0]),"top-left":E.Point.convert(Xt["top-left"]||[0,0]),"top-right":E.Point.convert(Xt["top-right"]||[0,0]),bottom:E.Point.convert(Xt.bottom||[0,0]),"bottom-left":E.Point.convert(Xt["bottom-left"]||[0,0]),"bottom-right":E.Point.convert(Xt["bottom-right"]||[0,0]),left:E.Point.convert(Xt.left||[0,0]),right:E.Point.convert(Xt.right||[0,0])}}return St(new E.Point(0,0))}(this.options.offset);if(!G){var de,ze=this._container.offsetWidth,it=this._container.offsetHeight;de=k.y+q.bottom.y<it?["top"]:k.y>this._map.transform.height-it?["bottom"]:[],k.x<ze/2?de.push("left"):k.x>this._map.transform.width-ze/2&&de.push("right"),G=de.length===0?"bottom":de.join("-")}var Bt=k.add(q[G]).round();re.setTransform(this._container,zf[G]+" translate("+Bt.x+"px,"+Bt.y+"px)"),wp(this._container,G,"popup")}},S.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var x=this._container.querySelector(Ds);x&&x.focus()}},S.prototype._onClose=function(){this.remove()},S}(E.Evented),j0={version:E.version,supported:_e,setRTLTextPlugin:E.setRTLTextPlugin,getRTLTextPluginStatus:E.getRTLTextPluginStatus,Map:Xd,NavigationControl:Ah,GeolocateControl:Ap,AttributionControl:lu,ScaleControl:Ef,FullscreenControl:Yc,Popup:Tu,Marker:Uf,Style:lc,LngLat:E.LngLat,LngLatBounds:E.LngLatBounds,Point:E.Point,MercatorCoordinate:E.MercatorCoordinate,Evented:E.Evented,config:E.config,prewarm:function(){ar().acquire(mr)},clearPrewarmedResources:function(){var _=Ei;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(mr),Ei=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return E.config.ACCESS_TOKEN},set accessToken(_){E.config.ACCESS_TOKEN=_},get baseApiUrl(){return E.config.API_URL},set baseApiUrl(_){E.config.API_URL=_},get workerCount(){return kr.workerCount},set workerCount(_){kr.workerCount=_},get maxParallelImageRequests(){return E.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){E.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage:function(_){E.clearTileCache(_)},workerUrl:""};return j0}),ee})},92077:function($t,W,D){var ee,X;(function(E,_e){ee=_e,X=typeof ee=="function"?ee.call(W,D,W,$t):ee,X!==void 0&&($t.exports=X)})(this,function(){var E,_e,re="2.0.6",he={},se={},Se={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},oe={currentLocale:Se.currentLocale,zeroFormat:Se.zeroFormat,nullFormat:Se.nullFormat,defaultFormat:Se.defaultFormat,scalePercentBy100:Se.scalePercentBy100};function je(te,ve){this._input=te,this._value=ve}return E=function(te){var ve,Be,Te,we;if(E.isNumeral(te))ve=te.value();else if(te===0||typeof te=="undefined")ve=0;else if(te===null||_e.isNaN(te))ve=null;else if(typeof te=="string")if(oe.zeroFormat&&te===oe.zeroFormat)ve=0;else if(oe.nullFormat&&te===oe.nullFormat||!te.replace(/[^0-9]+/g,"").length)ve=null;else{for(Be in he)if(we=typeof he[Be].regexps.unformat=="function"?he[Be].regexps.unformat():he[Be].regexps.unformat,we&&te.match(we)){Te=he[Be].unformat;break}Te=Te||E._.stringToNumber,ve=Te(te)}else ve=Number(te)||null;return new je(te,ve)},E.version=re,E.isNumeral=function(te){return te instanceof je},E._=_e={numberToFormat:function(te,ve,Be){var Te=se[E.options.currentLocale],we=!1,le=!1,Ze=0,xt="",ft=1e12,Zt=1e9,pt=1e6,vt=1e3,ke="",Re=!1,bt,gt,Ct,Sn,He,Ot,Ce,ot,$e,Xe;if(te=te||0,gt=Math.abs(te),E._.includes(ve,"(")?(we=!0,ve=ve.replace(/[\(|\)]/g,"")):(E._.includes(ve,"+")||E._.includes(ve,"-"))&&(ot=E._.includes(ve,"+")?ve.indexOf("+"):te<0?ve.indexOf("-"):-1,ve=ve.replace(/[\+|\-]/g,"")),E._.includes(ve,"a")&&(bt=ve.match(/a(k|m|b|t)?/),bt=bt?bt[1]:!1,E._.includes(ve," a")&&(xt=" "),ve=ve.replace(new RegExp(xt+"a[kmbt]?"),""),gt>=ft&&!bt||bt==="t"?(xt+=Te.abbreviations.trillion,te=te/ft):gt<ft&&gt>=Zt&&!bt||bt==="b"?(xt+=Te.abbreviations.billion,te=te/Zt):gt<Zt&&gt>=pt&&!bt||bt==="m"?(xt+=Te.abbreviations.million,te=te/pt):(gt<pt&&gt>=vt&&!bt||bt==="k")&&(xt+=Te.abbreviations.thousand,te=te/vt)),E._.includes(ve,"[.]")&&(le=!0,ve=ve.replace("[.]",".")),Ot=te.toString().split(".")[0],Ce=ve.split(".")[1],$e=ve.indexOf(","),Ze=(ve.split(".")[0].split(",")[0].match(/0/g)||[]).length,Ce?(E._.includes(Ce,"[")?(Ce=Ce.replace("]",""),Ce=Ce.split("["),ke=E._.toFixed(te,Ce[0].length+Ce[1].length,Be,Ce[1].length)):ke=E._.toFixed(te,Ce.length,Be),Ot=ke.split(".")[0],E._.includes(ke,".")?ke=Te.delimiters.decimal+ke.split(".")[1]:ke="",le&&Number(ke.slice(1))===0&&(ke="")):Ot=E._.toFixed(te,0,Be),xt&&!bt&&Number(Ot)>=1e3&&xt!==Te.abbreviations.trillion)switch(Ot=String(Number(Ot)/1e3),xt){case Te.abbreviations.thousand:xt=Te.abbreviations.million;break;case Te.abbreviations.million:xt=Te.abbreviations.billion;break;case Te.abbreviations.billion:xt=Te.abbreviations.trillion;break}if(E._.includes(Ot,"-")&&(Ot=Ot.slice(1),Re=!0),Ot.length<Ze)for(var Rt=Ze-Ot.length;Rt>0;Rt--)Ot="0"+Ot;return $e>-1&&(Ot=Ot.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+Te.delimiters.thousands)),ve.indexOf(".")===0&&(Ot=""),Xe=Ot+ke+(xt||""),we?Xe=(we&&Re?"(":"")+Xe+(we&&Re?")":""):ot>=0?Xe=ot===0?(Re?"-":"+")+Xe:Xe+(Re?"-":"+"):Re&&(Xe="-"+Xe),Xe},stringToNumber:function(te){var ve=se[oe.currentLocale],Be=te,Te={thousand:3,million:6,billion:9,trillion:12},we,le,Ze,xt;if(oe.zeroFormat&&te===oe.zeroFormat)le=0;else if(oe.nullFormat&&te===oe.nullFormat||!te.replace(/[^0-9]+/g,"").length)le=null;else{le=1,ve.delimiters.decimal!=="."&&(te=te.replace(/\./g,"").replace(ve.delimiters.decimal,"."));for(we in Te)if(xt=new RegExp("[^a-zA-Z]"+ve.abbreviations[we]+"(?:\\)|(\\"+ve.currency.symbol+")?(?:\\))?)?$"),Be.match(xt)){le*=Math.pow(10,Te[we]);break}le*=(te.split("-").length+Math.min(te.split("(").length-1,te.split(")").length-1))%2?1:-1,te=te.replace(/[^0-9\.]+/g,""),le*=Number(te)}return le},isNaN:function(te){return typeof te=="number"&&isNaN(te)},includes:function(te,ve){return te.indexOf(ve)!==-1},insert:function(te,ve,Be){return te.slice(0,Be)+ve+te.slice(Be)},reduce:function(te,ve){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof ve!="function")throw new TypeError(ve+" is not a function");var Be=Object(te),Te=Be.length>>>0,we=0,le;if(arguments.length===3)le=arguments[2];else{for(;we<Te&&!(we in Be);)we++;if(we>=Te)throw new TypeError("Reduce of empty array with no initial value");le=Be[we++]}for(;we<Te;we++)we in Be&&(le=ve(le,Be[we],we,Be));return le},multiplier:function(te){var ve=te.toString().split(".");return ve.length<2?1:Math.pow(10,ve[1].length)},correctionFactor:function(){var te=Array.prototype.slice.call(arguments);return te.reduce(function(ve,Be){var Te=_e.multiplier(Be);return ve>Te?ve:Te},1)},toFixed:function(te,ve,Be,Te){var we=te.toString().split("."),le=ve-(Te||0),Ze,xt,ft,Zt;return we.length===2?Ze=Math.min(Math.max(we[1].length,le),ve):Ze=le,ft=Math.pow(10,Ze),Zt=(Be(te+"e+"+Ze)/ft).toFixed(Ze),Te>ve-Ze&&(xt=new RegExp("\\.?0{1,"+(Te-(ve-Ze))+"}$"),Zt=Zt.replace(xt,"")),Zt}},E.options=oe,E.formats=he,E.locales=se,E.locale=function(te){return te&&(oe.currentLocale=te.toLowerCase()),oe.currentLocale},E.localeData=function(te){if(!te)return se[oe.currentLocale];if(te=te.toLowerCase(),!se[te])throw new Error("Unknown locale : "+te);return se[te]},E.reset=function(){for(var te in Se)oe[te]=Se[te]},E.zeroFormat=function(te){oe.zeroFormat=typeof te=="string"?te:null},E.nullFormat=function(te){oe.nullFormat=typeof te=="string"?te:null},E.defaultFormat=function(te){oe.defaultFormat=typeof te=="string"?te:"0.0"},E.register=function(te,ve,Be){if(ve=ve.toLowerCase(),this[te+"s"][ve])throw new TypeError(ve+" "+te+" already registered.");return this[te+"s"][ve]=Be,Be},E.validate=function(te,ve){var Be,Te,we,le,Ze,xt,ft,Zt;if(typeof te!="string"&&(te+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",te)),te=te.trim(),te.match(/^\d+$/))return!0;if(te==="")return!1;try{ft=E.localeData(ve)}catch(pt){ft=E.localeData(E.locale())}return we=ft.currency.symbol,Ze=ft.abbreviations,Be=ft.delimiters.decimal,ft.delimiters.thousands==="."?Te="\\.":Te=ft.delimiters.thousands,Zt=te.match(/^[^\d]+/),Zt!==null&&(te=te.substr(1),Zt[0]!==we)||(Zt=te.match(/[^\d]+$/),Zt!==null&&(te=te.slice(0,-1),Zt[0]!==Ze.thousand&&Zt[0]!==Ze.million&&Zt[0]!==Ze.billion&&Zt[0]!==Ze.trillion))?!1:(xt=new RegExp(Te+"{2}"),te.match(/[^\d.,]/g)?!1:(le=te.split(Be),le.length>2?!1:le.length<2?!!le[0].match(/^\d+.*\d$/)&&!le[0].match(xt):le[0].length===1?!!le[0].match(/^\d+$/)&&!le[0].match(xt)&&!!le[1].match(/^\d+$/):!!le[0].match(/^\d+.*\d$/)&&!le[0].match(xt)&&!!le[1].match(/^\d+$/)))},E.fn=je.prototype={clone:function(){return E(this)},format:function(te,ve){var Be=this._value,Te=te||oe.defaultFormat,we,le,Ze;if(ve=ve||Math.round,Be===0&&oe.zeroFormat!==null)le=oe.zeroFormat;else if(Be===null&&oe.nullFormat!==null)le=oe.nullFormat;else{for(we in he)if(Te.match(he[we].regexps.format)){Ze=he[we].format;break}Ze=Ze||E._.numberToFormat,le=Ze(Be,Te,ve)}return le},value:function(){return this._value},input:function(){return this._input},set:function(te){return this._value=Number(te),this},add:function(te){var ve=_e.correctionFactor.call(null,this._value,te);function Be(Te,we,le,Ze){return Te+Math.round(ve*we)}return this._value=_e.reduce([this._value,te],Be,0)/ve,this},subtract:function(te){var ve=_e.correctionFactor.call(null,this._value,te);function Be(Te,we,le,Ze){return Te-Math.round(ve*we)}return this._value=_e.reduce([te],Be,Math.round(this._value*ve))/ve,this},multiply:function(te){function ve(Be,Te,we,le){var Ze=_e.correctionFactor(Be,Te);return Math.round(Be*Ze)*Math.round(Te*Ze)/Math.round(Ze*Ze)}return this._value=_e.reduce([this._value,te],ve,1),this},divide:function(te){function ve(Be,Te,we,le){var Ze=_e.correctionFactor(Be,Te);return Math.round(Be*Ze)/Math.round(Te*Ze)}return this._value=_e.reduce([this._value,te],ve),this},difference:function(te){return Math.abs(E(this._value).subtract(te).value())}},E.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(te){var ve=te%10;return~~(te%100/10)===1?"th":ve===1?"st":ve===2?"nd":ve===3?"rd":"th"},currency:{symbol:"$"}}),function(){E.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(te,ve,Be){var Te=E._.includes(ve," BPS")?" ":"",we;return te=te*1e4,ve=ve.replace(/\s?BPS/,""),we=E._.numberToFormat(te,ve,Be),E._.includes(we,")")?(we=we.split(""),we.splice(-1,0,Te+"BPS"),we=we.join("")):we=we+Te+"BPS",we},unformat:function(te){return+(E._.stringToNumber(te)*1e-4).toFixed(15)}})}(),function(){var te={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},ve={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},Be=te.suffixes.concat(ve.suffixes.filter(function(we){return te.suffixes.indexOf(we)<0})),Te=Be.join("|");Te="("+Te.replace("B","B(?!PS)")+")",E.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(Te)},format:function(we,le,Ze){var xt,ft=E._.includes(le,"ib")?ve:te,Zt=E._.includes(le," b")||E._.includes(le," ib")?" ":"",pt,vt,ke;for(le=le.replace(/\s?i?b/,""),pt=0;pt<=ft.suffixes.length;pt++)if(vt=Math.pow(ft.base,pt),ke=Math.pow(ft.base,pt+1),we===null||we===0||we>=vt&&we<ke){Zt+=ft.suffixes[pt],vt>0&&(we=we/vt);break}return xt=E._.numberToFormat(we,le,Ze),xt+Zt},unformat:function(we){var le=E._.stringToNumber(we),Ze,xt;if(le){for(Ze=te.suffixes.length-1;Ze>=0;Ze--){if(E._.includes(we,te.suffixes[Ze])){xt=Math.pow(te.base,Ze);break}if(E._.includes(we,ve.suffixes[Ze])){xt=Math.pow(ve.base,Ze);break}}le*=xt||1}return le}})}(),function(){E.register("format","currency",{regexps:{format:/(\$)/},format:function(te,ve,Be){var Te=E.locales[E.options.currentLocale],we={before:ve.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:ve.match(/([\+|\-|\)|\s|\$]*)$/)[0]},le,Ze,xt;for(ve=ve.replace(/\s?\$\s?/,""),le=E._.numberToFormat(te,ve,Be),te>=0?(we.before=we.before.replace(/[\-\(]/,""),we.after=we.after.replace(/[\-\)]/,"")):te<0&&!E._.includes(we.before,"-")&&!E._.includes(we.before,"(")&&(we.before="-"+we.before),xt=0;xt<we.before.length;xt++)switch(Ze=we.before[xt],Ze){case"$":le=E._.insert(le,Te.currency.symbol,xt);break;case" ":le=E._.insert(le," ",xt+Te.currency.symbol.length-1);break}for(xt=we.after.length-1;xt>=0;xt--)switch(Ze=we.after[xt],Ze){case"$":le=xt===we.after.length-1?le+Te.currency.symbol:E._.insert(le,Te.currency.symbol,-(we.after.length-(1+xt)));break;case" ":le=xt===we.after.length-1?le+" ":E._.insert(le," ",-(we.after.length-(1+xt)+Te.currency.symbol.length-1));break}return le}})}(),function(){E.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(te,ve,Be){var Te,we=typeof te=="number"&&!E._.isNaN(te)?te.toExponential():"0e+0",le=we.split("e");return ve=ve.replace(/e[\+|\-]{1}0/,""),Te=E._.numberToFormat(Number(le[0]),ve,Be),Te+"e"+le[1]},unformat:function(te){var ve=E._.includes(te,"e+")?te.split("e+"):te.split("e-"),Be=Number(ve[0]),Te=Number(ve[1]);Te=E._.includes(te,"e-")?Te*=-1:Te;function we(le,Ze,xt,ft){var Zt=E._.correctionFactor(le,Ze),pt=le*Zt*(Ze*Zt)/(Zt*Zt);return pt}return E._.reduce([Be,Math.pow(10,Te)],we,1)}})}(),function(){E.register("format","ordinal",{regexps:{format:/(o)/},format:function(te,ve,Be){var Te=E.locales[E.options.currentLocale],we,le=E._.includes(ve," o")?" ":"";return ve=ve.replace(/\s?o/,""),le+=Te.ordinal(te),we=E._.numberToFormat(te,ve,Be),we+le}})}(),function(){E.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(te,ve,Be){var Te=E._.includes(ve," %")?" ":"",we;return E.options.scalePercentBy100&&(te=te*100),ve=ve.replace(/\s?\%/,""),we=E._.numberToFormat(te,ve,Be),E._.includes(we,")")?(we=we.split(""),we.splice(-1,0,Te+"%"),we=we.join("")):we=we+Te+"%",we},unformat:function(te){var ve=E._.stringToNumber(te);return E.options.scalePercentBy100?ve*.01:ve}})}(),function(){E.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(te,ve,Be){var Te=Math.floor(te/60/60),we=Math.floor((te-Te*60*60)/60),le=Math.round(te-Te*60*60-we*60);return Te+":"+(we<10?"0"+we:we)+":"+(le<10?"0"+le:le)},unformat:function(te){var ve=te.split(":"),Be=0;return ve.length===3?(Be=Be+Number(ve[0])*60*60,Be=Be+Number(ve[1])*60,Be=Be+Number(ve[2])):ve.length===2&&(Be=Be+Number(ve[0])*60,Be=Be+Number(ve[1])),Number(Be)}})}(),E})},3614:function($t,W,D){"use strict";$t.exports=X;var ee=D(80645);function X(He){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(He)?He:new Uint8Array(He||0),this.pos=0,this.type=0,this.length=this.buf.length}X.Varint=0,X.Fixed64=1,X.Bytes=2,X.Fixed32=5;var E=65536*65536,_e=1/E,re=12,he=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");X.prototype={destroy:function(){this.buf=null},readFields:function(He,Ot,Ce){for(Ce=Ce||this.length;this.pos<Ce;){var ot=this.readVarint(),$e=ot>>3,Xe=this.pos;this.type=ot&7,He($e,Ot,this),this.pos===Xe&&this.skip(ot)}return Ot},readMessage:function(He,Ot){return this.readFields(He,Ot,this.readVarint()+this.pos)},readFixed32:function(){var He=ke(this.buf,this.pos);return this.pos+=4,He},readSFixed32:function(){var He=bt(this.buf,this.pos);return this.pos+=4,He},readFixed64:function(){var He=ke(this.buf,this.pos)+ke(this.buf,this.pos+4)*E;return this.pos+=8,He},readSFixed64:function(){var He=ke(this.buf,this.pos)+bt(this.buf,this.pos+4)*E;return this.pos+=8,He},readFloat:function(){var He=ee.read(this.buf,this.pos,!0,23,4);return this.pos+=4,He},readDouble:function(){var He=ee.read(this.buf,this.pos,!0,52,8);return this.pos+=8,He},readVarint:function(He){var Ot=this.buf,Ce,ot;return ot=Ot[this.pos++],Ce=ot&127,ot<128||(ot=Ot[this.pos++],Ce|=(ot&127)<<7,ot<128)||(ot=Ot[this.pos++],Ce|=(ot&127)<<14,ot<128)||(ot=Ot[this.pos++],Ce|=(ot&127)<<21,ot<128)?Ce:(ot=Ot[this.pos],Ce|=(ot&15)<<28,se(Ce,He,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var He=this.readVarint();return He%2===1?(He+1)/-2:He/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var He=this.readVarint()+this.pos,Ot=this.pos;return this.pos=He,He-Ot>=re&&he?Ct(this.buf,Ot,He):gt(this.buf,Ot,He)},readBytes:function(){var He=this.readVarint()+this.pos,Ot=this.buf.subarray(this.pos,He);return this.pos=He,Ot},readPackedVarint:function(He,Ot){if(this.type!==X.Bytes)return He.push(this.readVarint(Ot));var Ce=Se(this);for(He=He||[];this.pos<Ce;)He.push(this.readVarint(Ot));return He},readPackedSVarint:function(He){if(this.type!==X.Bytes)return He.push(this.readSVarint());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readSVarint());return He},readPackedBoolean:function(He){if(this.type!==X.Bytes)return He.push(this.readBoolean());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readBoolean());return He},readPackedFloat:function(He){if(this.type!==X.Bytes)return He.push(this.readFloat());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readFloat());return He},readPackedDouble:function(He){if(this.type!==X.Bytes)return He.push(this.readDouble());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readDouble());return He},readPackedFixed32:function(He){if(this.type!==X.Bytes)return He.push(this.readFixed32());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readFixed32());return He},readPackedSFixed32:function(He){if(this.type!==X.Bytes)return He.push(this.readSFixed32());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readSFixed32());return He},readPackedFixed64:function(He){if(this.type!==X.Bytes)return He.push(this.readFixed64());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readFixed64());return He},readPackedSFixed64:function(He){if(this.type!==X.Bytes)return He.push(this.readSFixed64());var Ot=Se(this);for(He=He||[];this.pos<Ot;)He.push(this.readSFixed64());return He},skip:function(He){var Ot=He&7;if(Ot===X.Varint)for(;this.buf[this.pos++]>127;);else if(Ot===X.Bytes)this.pos=this.readVarint()+this.pos;else if(Ot===X.Fixed32)this.pos+=4;else if(Ot===X.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Ot)},writeTag:function(He,Ot){this.writeVarint(He<<3|Ot)},realloc:function(He){for(var Ot=this.length||16;Ot<this.pos+He;)Ot*=2;if(Ot!==this.length){var Ce=new Uint8Array(Ot);Ce.set(this.buf),this.buf=Ce,this.length=Ot}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(He){this.realloc(4),Re(this.buf,He,this.pos),this.pos+=4},writeSFixed32:function(He){this.realloc(4),Re(this.buf,He,this.pos),this.pos+=4},writeFixed64:function(He){this.realloc(8),Re(this.buf,He&-1,this.pos),Re(this.buf,Math.floor(He*_e),this.pos+4),this.pos+=8},writeSFixed64:function(He){this.realloc(8),Re(this.buf,He&-1,this.pos),Re(this.buf,Math.floor(He*_e),this.pos+4),this.pos+=8},writeVarint:function(He){if(He=+He||0,He>268435455||He<0){je(He,this);return}this.realloc(4),this.buf[this.pos++]=He&127|(He>127?128:0),!(He<=127)&&(this.buf[this.pos++]=(He>>>=7)&127|(He>127?128:0),!(He<=127)&&(this.buf[this.pos++]=(He>>>=7)&127|(He>127?128:0),!(He<=127)&&(this.buf[this.pos++]=He>>>7&127)))},writeSVarint:function(He){this.writeVarint(He<0?-He*2-1:He*2)},writeBoolean:function(He){this.writeVarint(!!He)},writeString:function(He){He=String(He),this.realloc(He.length*4),this.pos++;var Ot=this.pos;this.pos=Sn(this.buf,He,this.pos);var Ce=this.pos-Ot;Ce>=128&&Be(Ot,Ce,this),this.pos=Ot-1,this.writeVarint(Ce),this.pos+=Ce},writeFloat:function(He){this.realloc(4),ee.write(this.buf,He,this.pos,!0,23,4),this.pos+=4},writeDouble:function(He){this.realloc(8),ee.write(this.buf,He,this.pos,!0,52,8),this.pos+=8},writeBytes:function(He){var Ot=He.length;this.writeVarint(Ot),this.realloc(Ot);for(var Ce=0;Ce<Ot;Ce++)this.buf[this.pos++]=He[Ce]},writeRawMessage:function(He,Ot){this.pos++;var Ce=this.pos;He(Ot,this);var ot=this.pos-Ce;ot>=128&&Be(Ce,ot,this),this.pos=Ce-1,this.writeVarint(ot),this.pos+=ot},writeMessage:function(He,Ot,Ce){this.writeTag(He,X.Bytes),this.writeRawMessage(Ot,Ce)},writePackedVarint:function(He,Ot){Ot.length&&this.writeMessage(He,Te,Ot)},writePackedSVarint:function(He,Ot){Ot.length&&this.writeMessage(He,we,Ot)},writePackedBoolean:function(He,Ot){Ot.length&&this.writeMessage(He,xt,Ot)},writePackedFloat:function(He,Ot){Ot.length&&this.writeMessage(He,le,Ot)},writePackedDouble:function(He,Ot){Ot.length&&this.writeMessage(He,Ze,Ot)},writePackedFixed32:function(He,Ot){Ot.length&&this.writeMessage(He,ft,Ot)},writePackedSFixed32:function(He,Ot){Ot.length&&this.writeMessage(He,Zt,Ot)},writePackedFixed64:function(He,Ot){Ot.length&&this.writeMessage(He,pt,Ot)},writePackedSFixed64:function(He,Ot){Ot.length&&this.writeMessage(He,vt,Ot)},writeBytesField:function(He,Ot){this.writeTag(He,X.Bytes),this.writeBytes(Ot)},writeFixed32Field:function(He,Ot){this.writeTag(He,X.Fixed32),this.writeFixed32(Ot)},writeSFixed32Field:function(He,Ot){this.writeTag(He,X.Fixed32),this.writeSFixed32(Ot)},writeFixed64Field:function(He,Ot){this.writeTag(He,X.Fixed64),this.writeFixed64(Ot)},writeSFixed64Field:function(He,Ot){this.writeTag(He,X.Fixed64),this.writeSFixed64(Ot)},writeVarintField:function(He,Ot){this.writeTag(He,X.Varint),this.writeVarint(Ot)},writeSVarintField:function(He,Ot){this.writeTag(He,X.Varint),this.writeSVarint(Ot)},writeStringField:function(He,Ot){this.writeTag(He,X.Bytes),this.writeString(Ot)},writeFloatField:function(He,Ot){this.writeTag(He,X.Fixed32),this.writeFloat(Ot)},writeDoubleField:function(He,Ot){this.writeTag(He,X.Fixed64),this.writeDouble(Ot)},writeBooleanField:function(He,Ot){this.writeVarintField(He,!!Ot)}};function se(He,Ot,Ce){var ot=Ce.buf,$e,Xe;if(Xe=ot[Ce.pos++],$e=(Xe&112)>>4,Xe<128||(Xe=ot[Ce.pos++],$e|=(Xe&127)<<3,Xe<128)||(Xe=ot[Ce.pos++],$e|=(Xe&127)<<10,Xe<128)||(Xe=ot[Ce.pos++],$e|=(Xe&127)<<17,Xe<128)||(Xe=ot[Ce.pos++],$e|=(Xe&127)<<24,Xe<128)||(Xe=ot[Ce.pos++],$e|=(Xe&1)<<31,Xe<128))return oe(He,$e,Ot);throw new Error("Expected varint not more than 10 bytes")}function Se(He){return He.type===X.Bytes?He.readVarint()+He.pos:He.pos+1}function oe(He,Ot,Ce){return Ce?Ot*4294967296+(He>>>0):(Ot>>>0)*4294967296+(He>>>0)}function je(He,Ot){var Ce,ot;if(He>=0?(Ce=He%4294967296|0,ot=He/4294967296|0):(Ce=~(-He%4294967296),ot=~(-He/4294967296),Ce^4294967295?Ce=Ce+1|0:(Ce=0,ot=ot+1|0)),He>=18446744073709552e3||He<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Ot.realloc(10),te(Ce,ot,Ot),ve(ot,Ot)}function te(He,Ot,Ce){Ce.buf[Ce.pos++]=He&127|128,He>>>=7,Ce.buf[Ce.pos++]=He&127|128,He>>>=7,Ce.buf[Ce.pos++]=He&127|128,He>>>=7,Ce.buf[Ce.pos++]=He&127|128,He>>>=7,Ce.buf[Ce.pos]=He&127}function ve(He,Ot){var Ce=(He&7)<<4;Ot.buf[Ot.pos++]|=Ce|((He>>>=3)?128:0),He&&(Ot.buf[Ot.pos++]=He&127|((He>>>=7)?128:0),He&&(Ot.buf[Ot.pos++]=He&127|((He>>>=7)?128:0),He&&(Ot.buf[Ot.pos++]=He&127|((He>>>=7)?128:0),He&&(Ot.buf[Ot.pos++]=He&127|((He>>>=7)?128:0),He&&(Ot.buf[Ot.pos++]=He&127)))))}function Be(He,Ot,Ce){var ot=Ot<=16383?1:Ot<=2097151?2:Ot<=268435455?3:Math.floor(Math.log(Ot)/(Math.LN2*7));Ce.realloc(ot);for(var $e=Ce.pos-1;$e>=He;$e--)Ce.buf[$e+ot]=Ce.buf[$e]}function Te(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeVarint(He[Ce])}function we(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeSVarint(He[Ce])}function le(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeFloat(He[Ce])}function Ze(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeDouble(He[Ce])}function xt(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeBoolean(He[Ce])}function ft(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeFixed32(He[Ce])}function Zt(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeSFixed32(He[Ce])}function pt(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeFixed64(He[Ce])}function vt(He,Ot){for(var Ce=0;Ce<He.length;Ce++)Ot.writeSFixed64(He[Ce])}function ke(He,Ot){return(He[Ot]|He[Ot+1]<<8|He[Ot+2]<<16)+He[Ot+3]*16777216}function Re(He,Ot,Ce){He[Ce]=Ot,He[Ce+1]=Ot>>>8,He[Ce+2]=Ot>>>16,He[Ce+3]=Ot>>>24}function bt(He,Ot){return(He[Ot]|He[Ot+1]<<8|He[Ot+2]<<16)+(He[Ot+3]<<24)}function gt(He,Ot,Ce){for(var ot="",$e=Ot;$e<Ce;){var Xe=He[$e],Rt=null,_t=Xe>239?4:Xe>223?3:Xe>191?2:1;if($e+_t>Ce)break;var Pe,Wt,on;_t===1?Xe<128&&(Rt=Xe):_t===2?(Pe=He[$e+1],(Pe&192)===128&&(Rt=(Xe&31)<<6|Pe&63,Rt<=127&&(Rt=null))):_t===3?(Pe=He[$e+1],Wt=He[$e+2],(Pe&192)===128&&(Wt&192)===128&&(Rt=(Xe&15)<<12|(Pe&63)<<6|Wt&63,(Rt<=2047||Rt>=55296&&Rt<=57343)&&(Rt=null))):_t===4&&(Pe=He[$e+1],Wt=He[$e+2],on=He[$e+3],(Pe&192)===128&&(Wt&192)===128&&(on&192)===128&&(Rt=(Xe&15)<<18|(Pe&63)<<12|(Wt&63)<<6|on&63,(Rt<=65535||Rt>=1114112)&&(Rt=null))),Rt===null?(Rt=65533,_t=1):Rt>65535&&(Rt-=65536,ot+=String.fromCharCode(Rt>>>10&1023|55296),Rt=56320|Rt&1023),ot+=String.fromCharCode(Rt),$e+=_t}return ot}function Ct(He,Ot,Ce){return he.decode(He.subarray(Ot,Ce))}function Sn(He,Ot,Ce){for(var ot=0,$e,Xe;ot<Ot.length;ot++){if($e=Ot.charCodeAt(ot),$e>55295&&$e<57344)if(Xe)if($e<56320){He[Ce++]=239,He[Ce++]=191,He[Ce++]=189,Xe=$e;continue}else $e=Xe-55296<<10|$e-56320|65536,Xe=null;else{$e>56319||ot+1===Ot.length?(He[Ce++]=239,He[Ce++]=191,He[Ce++]=189):Xe=$e;continue}else Xe&&(He[Ce++]=239,He[Ce++]=191,He[Ce++]=189,Xe=null);$e<128?He[Ce++]=$e:($e<2048?He[Ce++]=$e>>6|192:($e<65536?He[Ce++]=$e>>12|224:(He[Ce++]=$e>>18|240,He[Ce++]=$e>>12&63|128),He[Ce++]=$e>>6&63|128),He[Ce++]=$e&63|128)}return Ce}},73807:function($t){"use strict";var W=$t.exports;$t.exports.isNumber=function(D){return typeof D=="number"},$t.exports.findMin=function(D){if(D.length===0)return 1/0;for(var ee=D[0],X=1;X<D.length;X++)ee=Math.min(ee,D[X]);return ee},$t.exports.findMax=function(D){if(D.length===0)return-1/0;for(var ee=D[0],X=1;X<D.length;X++)ee=Math.max(ee,D[X]);return ee},$t.exports.findMinMulti=function(D){for(var ee=W.findMin(D[0]),X=1;X<D.length;X++)ee=Math.min(ee,W.findMin(D[X]));return ee},$t.exports.findMaxMulti=function(D){for(var ee=W.findMax(D[0]),X=1;X<D.length;X++)ee=Math.max(ee,W.findMax(D[X]));return ee},$t.exports.inside=function(D,ee,X){return D<=X&&X<=ee}},53843:function($t,W,D){"use strict";var ee=50,X=2,E=Math.log(2),_e=$t.exports,re=D(73807);function he(Se){return 1-Math.abs(Se)}$t.exports.getUnifiedMinMax=function(Se,oe){return _e.getUnifiedMinMaxMulti([Se],oe)},$t.exports.getUnifiedMinMaxMulti=function(Se,oe){oe=oe||{};var je=!1,te=!1,ve=re.isNumber(oe.width)?oe.width:X,Be=re.isNumber(oe.size)?oe.size:ee,Te=re.isNumber(oe.min)?oe.min:(je=!0,re.findMinMulti(Se)),we=re.isNumber(oe.max)?oe.max:(te=!0,re.findMaxMulti(Se)),le=we-Te,Ze=le/(Be-1);return je&&(Te=Te-2*ve*Ze),te&&(we=we+2*ve*Ze),{min:Te,max:we}},$t.exports.create=function(Se,oe){if(oe=oe||{},!Se||Se.length===0)return[];var je=re.isNumber(oe.size)?oe.size:ee,te=re.isNumber(oe.width)?oe.width:X,ve=_e.getUnifiedMinMax(Se,{size:je,width:te,min:oe.min,max:oe.max}),Be=ve.min,Te=ve.max,we=Te-Be,le=we/(je-1);if(we===0)return[{x:Be,y:1}];for(var Ze=[],xt=0;xt<je;xt++)Ze.push({x:Be+xt*le,y:0});var ft=function(Ct){return Math.floor((Ct-Be)/le)},Zt=se(he,te),pt=Zt[te],vt=Zt[te-1]-Zt[te-2],ke=0;Se.forEach(function(Ct){var Sn=ft(Ct);if(!(Sn+te<0||Sn-te>=Ze.length)){var He=Math.max(Sn-te,0),Ot=Sn,Ce=Math.min(Sn+te,Ze.length-1),ot=He-(Sn-te),$e=Sn+te-Ce,Xe=Zt[-te-1+ot]||0,Rt=Zt[-te-1+$e]||0,_t=pt/(pt-Xe-Rt);ot>0&&(ke+=_t*(ot-1)*vt);var Pe=Math.max(0,Sn-te+1);re.inside(0,Ze.length-1,Pe)&&(Ze[Pe].y+=_t*1*vt),re.inside(0,Ze.length-1,Ot+1)&&(Ze[Ot+1].y-=_t*2*vt),re.inside(0,Ze.length-1,Ce+1)&&(Ze[Ce+1].y+=_t*1*vt)}});var Re=ke,bt=0,gt=0;return Ze.forEach(function(Ct){bt+=Ct.y,Re+=bt,Ct.y=Re,gt+=Re}),gt>0&&Ze.forEach(function(Ct){Ct.y/=gt}),Ze};function se(Se,oe){for(var je={},te=0,ve=-oe;ve<=oe;ve++)te+=Se(ve/oe),je[ve]=te;return je}$t.exports.getExpectedValueFromPdf=function(Se){if(!(!Se||Se.length===0)){var oe=0;return Se.forEach(function(je){oe+=je.x*je.y}),oe}},$t.exports.getXWithLeftTailArea=function(Se,oe){if(!(!Se||Se.length===0)){for(var je=0,te=0,ve=0;ve<Se.length&&(te=ve,je+=Se[ve].y,!(je>=oe));ve++);return Se[te].x}},$t.exports.getPerplexity=function(Se){if(!(!Se||Se.length===0)){var oe=0;return Se.forEach(function(je){var te=Math.log(je.y);isFinite(te)&&(oe+=je.y*te)}),oe=-oe/E,Math.pow(2,oe)}}},32676:function($t,W,D){var ee=D(34155);(function(X,E){$t.exports=E()})(this,function(){"use strict";function X(dt,ye){var Fe={label:0,sent:function(){if(Mt[0]&1)throw Mt[1];return Mt[1]},trys:[],ops:[]},nt,Pt,Mt,Tn;return Tn={next:$n(0),throw:$n(1),return:$n(2)},typeof Symbol=="function"&&(Tn[Symbol.iterator]=function(){return this}),Tn;function $n(qn){return function(Ae){return xr([qn,Ae])}}function xr(qn){if(nt)throw new TypeError("Generator is already executing.");for(;Fe;)try{if(nt=1,Pt&&(Mt=qn[0]&2?Pt.return:qn[0]?Pt.throw||((Mt=Pt.return)&&Mt.call(Pt),0):Pt.next)&&!(Mt=Mt.call(Pt,qn[1])).done)return Mt;switch(Pt=0,Mt&&(qn=[qn[0]&2,Mt.value]),qn[0]){case 0:case 1:Mt=qn;break;case 4:return Fe.label++,{value:qn[1],done:!1};case 5:Fe.label++,Pt=qn[1],qn=[0];continue;case 7:qn=Fe.ops.pop(),Fe.trys.pop();continue;default:if(Mt=Fe.trys,!(Mt=Mt.length>0&&Mt[Mt.length-1])&&(qn[0]===6||qn[0]===2)){Fe=0;continue}if(qn[0]===3&&(!Mt||qn[1]>Mt[0]&&qn[1]<Mt[3])){Fe.label=qn[1];break}if(qn[0]===6&&Fe.label<Mt[1]){Fe.label=Mt[1],Mt=qn;break}if(Mt&&Fe.label<Mt[2]){Fe.label=Mt[2],Fe.ops.push(qn);break}Mt[2]&&Fe.ops.pop(),Fe.trys.pop();continue}qn=ye.call(dt,Fe)}catch(Ae){qn=[6,Ae],Pt=0}finally{nt=Mt=0}if(qn[0]&5)throw qn[1];return{value:qn[0]?qn[1]:void 0,done:!0}}}var E=function(){function dt(ye,Fe){this.next=null,this.key=ye,this.data=Fe,this.left=null,this.right=null}return dt}();function _e(dt,ye){return dt>ye?1:dt<ye?-1:0}function re(dt,ye,Fe){for(var nt=new E(null,null),Pt=nt,Mt=nt;;){var Tn=Fe(dt,ye.key);if(Tn<0){if(ye.left===null)break;if(Fe(dt,ye.left.key)<0){var $n=ye.left;if(ye.left=$n.right,$n.right=ye,ye=$n,ye.left===null)break}Mt.left=ye,Mt=ye,ye=ye.left}else if(Tn>0){if(ye.right===null)break;if(Fe(dt,ye.right.key)>0){var $n=ye.right;if(ye.right=$n.left,$n.left=ye,ye=$n,ye.right===null)break}Pt.right=ye,Pt=ye,ye=ye.right}else break}return Pt.right=ye.left,Mt.left=ye.right,ye.left=nt.right,ye.right=nt.left,ye}function he(dt,ye,Fe,nt){var Pt=new E(dt,ye);if(Fe===null)return Pt.left=Pt.right=null,Pt;Fe=re(dt,Fe,nt);var Mt=nt(dt,Fe.key);return Mt<0?(Pt.left=Fe.left,Pt.right=Fe,Fe.left=null):Mt>=0&&(Pt.right=Fe.right,Pt.left=Fe,Fe.right=null),Pt}function se(dt,ye,Fe){var nt=null,Pt=null;if(ye){ye=re(dt,ye,Fe);var Mt=Fe(ye.key,dt);Mt===0?(nt=ye.left,Pt=ye.right):Mt<0?(Pt=ye.right,ye.right=null,nt=ye):(nt=ye.left,ye.left=null,Pt=ye)}return{left:nt,right:Pt}}function Se(dt,ye,Fe){return ye===null?dt:(dt===null||(ye=re(dt.key,ye,Fe),ye.left=dt),ye)}function oe(dt,ye,Fe,nt,Pt){if(dt){nt(""+ye+(Fe?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+Pt(dt)+`
`);var Mt=ye+(Fe?"    ":"\u2502   ");dt.left&&oe(dt.left,Mt,!1,nt,Pt),dt.right&&oe(dt.right,Mt,!0,nt,Pt)}}var je=function(){function dt(ye){ye===void 0&&(ye=_e),this._root=null,this._size=0,this._comparator=ye}return dt.prototype.insert=function(ye,Fe){return this._size++,this._root=he(ye,Fe,this._root,this._comparator)},dt.prototype.add=function(ye,Fe){var nt=new E(ye,Fe);this._root===null&&(nt.left=nt.right=null,this._size++,this._root=nt);var Pt=this._comparator,Mt=re(ye,this._root,Pt),Tn=Pt(ye,Mt.key);return Tn===0?this._root=Mt:(Tn<0?(nt.left=Mt.left,nt.right=Mt,Mt.left=null):Tn>0&&(nt.right=Mt.right,nt.left=Mt,Mt.right=null),this._size++,this._root=nt),this._root},dt.prototype.remove=function(ye){this._root=this._remove(ye,this._root,this._comparator)},dt.prototype._remove=function(ye,Fe,nt){var Pt;if(Fe===null)return null;Fe=re(ye,Fe,nt);var Mt=nt(ye,Fe.key);return Mt===0?(Fe.left===null?Pt=Fe.right:(Pt=re(ye,Fe.left,nt),Pt.right=Fe.right),this._size--,Pt):Fe},dt.prototype.pop=function(){var ye=this._root;if(ye){for(;ye.left;)ye=ye.left;return this._root=re(ye.key,this._root,this._comparator),this._root=this._remove(ye.key,this._root,this._comparator),{key:ye.key,data:ye.data}}return null},dt.prototype.findStatic=function(ye){for(var Fe=this._root,nt=this._comparator;Fe;){var Pt=nt(ye,Fe.key);if(Pt===0)return Fe;Pt<0?Fe=Fe.left:Fe=Fe.right}return null},dt.prototype.find=function(ye){return this._root&&(this._root=re(ye,this._root,this._comparator),this._comparator(ye,this._root.key)!==0)?null:this._root},dt.prototype.contains=function(ye){for(var Fe=this._root,nt=this._comparator;Fe;){var Pt=nt(ye,Fe.key);if(Pt===0)return!0;Pt<0?Fe=Fe.left:Fe=Fe.right}return!1},dt.prototype.forEach=function(ye,Fe){for(var nt=this._root,Pt=[],Mt=!1;!Mt;)nt!==null?(Pt.push(nt),nt=nt.left):Pt.length!==0?(nt=Pt.pop(),ye.call(Fe,nt),nt=nt.right):Mt=!0;return this},dt.prototype.range=function(ye,Fe,nt,Pt){for(var Mt=[],Tn=this._comparator,$n=this._root,xr;Mt.length!==0||$n;)if($n)Mt.push($n),$n=$n.left;else{if($n=Mt.pop(),xr=Tn($n.key,Fe),xr>0)break;if(Tn($n.key,ye)>=0&&nt.call(Pt,$n))return this;$n=$n.right}return this},dt.prototype.keys=function(){var ye=[];return this.forEach(function(Fe){var nt=Fe.key;return ye.push(nt)}),ye},dt.prototype.values=function(){var ye=[];return this.forEach(function(Fe){var nt=Fe.data;return ye.push(nt)}),ye},dt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},dt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},dt.prototype.minNode=function(ye){if(ye===void 0&&(ye=this._root),ye)for(;ye.left;)ye=ye.left;return ye},dt.prototype.maxNode=function(ye){if(ye===void 0&&(ye=this._root),ye)for(;ye.right;)ye=ye.right;return ye},dt.prototype.at=function(ye){for(var Fe=this._root,nt=!1,Pt=0,Mt=[];!nt;)if(Fe)Mt.push(Fe),Fe=Fe.left;else if(Mt.length>0){if(Fe=Mt.pop(),Pt===ye)return Fe;Pt++,Fe=Fe.right}else nt=!0;return null},dt.prototype.next=function(ye){var Fe=this._root,nt=null;if(ye.right){for(nt=ye.right;nt.left;)nt=nt.left;return nt}for(var Pt=this._comparator;Fe;){var Mt=Pt(ye.key,Fe.key);if(Mt===0)break;Mt<0?(nt=Fe,Fe=Fe.left):Fe=Fe.right}return nt},dt.prototype.prev=function(ye){var Fe=this._root,nt=null;if(ye.left!==null){for(nt=ye.left;nt.right;)nt=nt.right;return nt}for(var Pt=this._comparator;Fe;){var Mt=Pt(ye.key,Fe.key);if(Mt===0)break;Mt<0?Fe=Fe.left:(nt=Fe,Fe=Fe.right)}return nt},dt.prototype.clear=function(){return this._root=null,this._size=0,this},dt.prototype.toList=function(){return Be(this._root)},dt.prototype.load=function(ye,Fe,nt){Fe===void 0&&(Fe=[]),nt===void 0&&(nt=!1);var Pt=ye.length,Mt=this._comparator;if(nt&&le(ye,Fe,0,Pt-1,Mt),this._root===null)this._root=te(ye,Fe,0,Pt),this._size=Pt;else{var Tn=we(this.toList(),ve(ye,Fe),Mt);Pt=this._size+Pt,this._root=Te({head:Tn},0,Pt)}return this},dt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(dt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(dt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),dt.prototype.toString=function(ye){ye===void 0&&(ye=function(nt){return String(nt.key)});var Fe=[];return oe(this._root,"",!0,function(nt){return Fe.push(nt)},ye),Fe.join("")},dt.prototype.update=function(ye,Fe,nt){var Pt=this._comparator,Mt=se(ye,this._root,Pt),Tn=Mt.left,$n=Mt.right;Pt(ye,Fe)<0?$n=he(Fe,nt,$n,Pt):Tn=he(Fe,nt,Tn,Pt),this._root=Se(Tn,$n,Pt)},dt.prototype.split=function(ye){return se(ye,this._root,this._comparator)},dt.prototype[Symbol.iterator]=function(){var ye,Fe,nt;return X(this,function(Pt){switch(Pt.label){case 0:ye=this._root,Fe=[],nt=!1,Pt.label=1;case 1:return nt?[3,6]:ye===null?[3,2]:(Fe.push(ye),ye=ye.left,[3,5]);case 2:return Fe.length===0?[3,4]:(ye=Fe.pop(),[4,ye]);case 3:return Pt.sent(),ye=ye.right,[3,5];case 4:nt=!0,Pt.label=5;case 5:return[3,1];case 6:return[2]}})},dt}();function te(dt,ye,Fe,nt){var Pt=nt-Fe;if(Pt>0){var Mt=Fe+Math.floor(Pt/2),Tn=dt[Mt],$n=ye[Mt],xr=new E(Tn,$n);return xr.left=te(dt,ye,Fe,Mt),xr.right=te(dt,ye,Mt+1,nt),xr}return null}function ve(dt,ye){for(var Fe=new E(null,null),nt=Fe,Pt=0;Pt<dt.length;Pt++)nt=nt.next=new E(dt[Pt],ye[Pt]);return nt.next=null,Fe.next}function Be(dt){for(var ye=dt,Fe=[],nt=!1,Pt=new E(null,null),Mt=Pt;!nt;)ye?(Fe.push(ye),ye=ye.left):Fe.length>0?(ye=Mt=Mt.next=Fe.pop(),ye=ye.right):nt=!0;return Mt.next=null,Pt.next}function Te(dt,ye,Fe){var nt=Fe-ye;if(nt>0){var Pt=ye+Math.floor(nt/2),Mt=Te(dt,ye,Pt),Tn=dt.head;return Tn.left=Mt,dt.head=dt.head.next,Tn.right=Te(dt,Pt+1,Fe),Tn}return null}function we(dt,ye,Fe){for(var nt=new E(null,null),Pt=nt,Mt=dt,Tn=ye;Mt!==null&&Tn!==null;)Fe(Mt.key,Tn.key)<0?(Pt.next=Mt,Mt=Mt.next):(Pt.next=Tn,Tn=Tn.next),Pt=Pt.next;return Mt!==null?Pt.next=Mt:Tn!==null&&(Pt.next=Tn),nt.next}function le(dt,ye,Fe,nt,Pt){if(!(Fe>=nt)){for(var Mt=dt[Fe+nt>>1],Tn=Fe-1,$n=nt+1;;){do Tn++;while(Pt(dt[Tn],Mt)<0);do $n--;while(Pt(dt[$n],Mt)>0);if(Tn>=$n)break;var xr=dt[Tn];dt[Tn]=dt[$n],dt[$n]=xr,xr=ye[Tn],ye[Tn]=ye[$n],ye[$n]=xr}le(dt,ye,Fe,$n,Pt),le(dt,ye,$n+1,nt,Pt)}}const Ze=(dt,ye)=>dt.ll.x<=ye.x&&ye.x<=dt.ur.x&&dt.ll.y<=ye.y&&ye.y<=dt.ur.y,xt=(dt,ye)=>{if(ye.ur.x<dt.ll.x||dt.ur.x<ye.ll.x||ye.ur.y<dt.ll.y||dt.ur.y<ye.ll.y)return null;const Fe=dt.ll.x<ye.ll.x?ye.ll.x:dt.ll.x,nt=dt.ur.x<ye.ur.x?dt.ur.x:ye.ur.x,Pt=dt.ll.y<ye.ll.y?ye.ll.y:dt.ll.y,Mt=dt.ur.y<ye.ur.y?dt.ur.y:ye.ur.y;return{ll:{x:Fe,y:Pt},ur:{x:nt,y:Mt}}};let ft=Number.EPSILON;ft===void 0&&(ft=Math.pow(2,-52));const Zt=ft*ft,pt=(dt,ye)=>{if(-ft<dt&&dt<ft&&-ft<ye&&ye<ft)return 0;const Fe=dt-ye;return Fe*Fe<Zt*dt*ye?0:dt<ye?-1:1};class vt{constructor(){this.reset()}reset(){this.xRounder=new ke,this.yRounder=new ke}round(ye,Fe){return{x:this.xRounder.round(ye),y:this.yRounder.round(Fe)}}}class ke{constructor(){this.tree=new je,this.round(0)}round(ye){const Fe=this.tree.add(ye),nt=this.tree.prev(Fe);if(nt!==null&&pt(Fe.key,nt.key)===0)return this.tree.remove(ye),nt.key;const Pt=this.tree.next(Fe);return Pt!==null&&pt(Fe.key,Pt.key)===0?(this.tree.remove(ye),Pt.key):ye}}const Re=new vt,bt=11102230246251565e-32,gt=134217729,Ct=(3+8*bt)*bt;function Sn(dt,ye,Fe,nt,Pt){let Mt,Tn,$n,xr,qn=ye[0],Ae=nt[0],be=0,Ne=0;Ae>qn==Ae>-qn?(Mt=qn,qn=ye[++be]):(Mt=Ae,Ae=nt[++Ne]);let et=0;if(be<dt&&Ne<Fe)for(Ae>qn==Ae>-qn?(Tn=qn+Mt,$n=Mt-(Tn-qn),qn=ye[++be]):(Tn=Ae+Mt,$n=Mt-(Tn-Ae),Ae=nt[++Ne]),Mt=Tn,$n!==0&&(Pt[et++]=$n);be<dt&&Ne<Fe;)Ae>qn==Ae>-qn?(Tn=Mt+qn,xr=Tn-Mt,$n=Mt-(Tn-xr)+(qn-xr),qn=ye[++be]):(Tn=Mt+Ae,xr=Tn-Mt,$n=Mt-(Tn-xr)+(Ae-xr),Ae=nt[++Ne]),Mt=Tn,$n!==0&&(Pt[et++]=$n);for(;be<dt;)Tn=Mt+qn,xr=Tn-Mt,$n=Mt-(Tn-xr)+(qn-xr),qn=ye[++be],Mt=Tn,$n!==0&&(Pt[et++]=$n);for(;Ne<Fe;)Tn=Mt+Ae,xr=Tn-Mt,$n=Mt-(Tn-xr)+(Ae-xr),Ae=nt[++Ne],Mt=Tn,$n!==0&&(Pt[et++]=$n);return(Mt!==0||et===0)&&(Pt[et++]=Mt),et}function He(dt,ye){let Fe=ye[0];for(let nt=1;nt<dt;nt++)Fe+=ye[nt];return Fe}function Ot(dt){return new Float64Array(dt)}const Ce=(3+16*bt)*bt,ot=(2+12*bt)*bt,$e=(9+64*bt)*bt*bt,Xe=Ot(4),Rt=Ot(8),_t=Ot(12),Pe=Ot(16),Wt=Ot(4);function on(dt,ye,Fe,nt,Pt,Mt,Tn){let $n,xr,qn,Ae,be,Ne,et,wt,qt,vn,yt,Jt,Qn,Er,Vr,mr,kr,Ei;const Oi=dt-Pt,ar=Fe-Pt,Kr=ye-Mt,hi=nt-Mt;Er=Oi*hi,Ne=gt*Oi,et=Ne-(Ne-Oi),wt=Oi-et,Ne=gt*hi,qt=Ne-(Ne-hi),vn=hi-qt,Vr=wt*vn-(Er-et*qt-wt*qt-et*vn),mr=Kr*ar,Ne=gt*Kr,et=Ne-(Ne-Kr),wt=Kr-et,Ne=gt*ar,qt=Ne-(Ne-ar),vn=ar-qt,kr=wt*vn-(mr-et*qt-wt*qt-et*vn),yt=Vr-kr,be=Vr-yt,Xe[0]=Vr-(yt+be)+(be-kr),Jt=Er+yt,be=Jt-Er,Qn=Er-(Jt-be)+(yt-be),yt=Qn-mr,be=Qn-yt,Xe[1]=Qn-(yt+be)+(be-mr),Ei=Jt+yt,be=Ei-Jt,Xe[2]=Jt-(Ei-be)+(yt-be),Xe[3]=Ei;let Qr=He(4,Xe),Io=ot*Tn;if(Qr>=Io||-Qr>=Io||(be=dt-Oi,$n=dt-(Oi+be)+(be-Pt),be=Fe-ar,qn=Fe-(ar+be)+(be-Pt),be=ye-Kr,xr=ye-(Kr+be)+(be-Mt),be=nt-hi,Ae=nt-(hi+be)+(be-Mt),$n===0&&xr===0&&qn===0&&Ae===0)||(Io=$e*Tn+Ct*Math.abs(Qr),Qr+=Oi*Ae+hi*$n-(Kr*qn+ar*xr),Qr>=Io||-Qr>=Io))return Qr;Er=$n*hi,Ne=gt*$n,et=Ne-(Ne-$n),wt=$n-et,Ne=gt*hi,qt=Ne-(Ne-hi),vn=hi-qt,Vr=wt*vn-(Er-et*qt-wt*qt-et*vn),mr=xr*ar,Ne=gt*xr,et=Ne-(Ne-xr),wt=xr-et,Ne=gt*ar,qt=Ne-(Ne-ar),vn=ar-qt,kr=wt*vn-(mr-et*qt-wt*qt-et*vn),yt=Vr-kr,be=Vr-yt,Wt[0]=Vr-(yt+be)+(be-kr),Jt=Er+yt,be=Jt-Er,Qn=Er-(Jt-be)+(yt-be),yt=Qn-mr,be=Qn-yt,Wt[1]=Qn-(yt+be)+(be-mr),Ei=Jt+yt,be=Ei-Jt,Wt[2]=Jt-(Ei-be)+(yt-be),Wt[3]=Ei;const Ii=Sn(4,Xe,4,Wt,Rt);Er=Oi*Ae,Ne=gt*Oi,et=Ne-(Ne-Oi),wt=Oi-et,Ne=gt*Ae,qt=Ne-(Ne-Ae),vn=Ae-qt,Vr=wt*vn-(Er-et*qt-wt*qt-et*vn),mr=Kr*qn,Ne=gt*Kr,et=Ne-(Ne-Kr),wt=Kr-et,Ne=gt*qn,qt=Ne-(Ne-qn),vn=qn-qt,kr=wt*vn-(mr-et*qt-wt*qt-et*vn),yt=Vr-kr,be=Vr-yt,Wt[0]=Vr-(yt+be)+(be-kr),Jt=Er+yt,be=Jt-Er,Qn=Er-(Jt-be)+(yt-be),yt=Qn-mr,be=Qn-yt,Wt[1]=Qn-(yt+be)+(be-mr),Ei=Jt+yt,be=Ei-Jt,Wt[2]=Jt-(Ei-be)+(yt-be),Wt[3]=Ei;const Fo=Sn(Ii,Rt,4,Wt,_t);Er=$n*Ae,Ne=gt*$n,et=Ne-(Ne-$n),wt=$n-et,Ne=gt*Ae,qt=Ne-(Ne-Ae),vn=Ae-qt,Vr=wt*vn-(Er-et*qt-wt*qt-et*vn),mr=xr*qn,Ne=gt*xr,et=Ne-(Ne-xr),wt=xr-et,Ne=gt*qn,qt=Ne-(Ne-qn),vn=qn-qt,kr=wt*vn-(mr-et*qt-wt*qt-et*vn),yt=Vr-kr,be=Vr-yt,Wt[0]=Vr-(yt+be)+(be-kr),Jt=Er+yt,be=Jt-Er,Qn=Er-(Jt-be)+(yt-be),yt=Qn-mr,be=Qn-yt,Wt[1]=Qn-(yt+be)+(be-mr),Ei=Jt+yt,be=Ei-Jt,Wt[2]=Jt-(Ei-be)+(yt-be),Wt[3]=Ei;const _a=Sn(Fo,_t,4,Wt,Pe);return Pe[_a-1]}function Nn(dt,ye,Fe,nt,Pt,Mt){const Tn=(ye-Mt)*(Fe-Pt),$n=(dt-Pt)*(nt-Mt),xr=Tn-$n,qn=Math.abs(Tn+$n);return Math.abs(xr)>=Ce*qn?xr:-on(dt,ye,Fe,nt,Pt,Mt,qn)}const jn=(dt,ye)=>dt.x*ye.y-dt.y*ye.x,lr=(dt,ye)=>dt.x*ye.x+dt.y*ye.y,Vt=(dt,ye,Fe)=>{const nt=Nn(dt.x,dt.y,ye.x,ye.y,Fe.x,Fe.y);return nt>0?-1:nt<0?1:0},en=dt=>Math.sqrt(lr(dt,dt)),xn=(dt,ye,Fe)=>{const nt={x:ye.x-dt.x,y:ye.y-dt.y},Pt={x:Fe.x-dt.x,y:Fe.y-dt.y};return jn(Pt,nt)/en(Pt)/en(nt)},er=(dt,ye,Fe)=>{const nt={x:ye.x-dt.x,y:ye.y-dt.y},Pt={x:Fe.x-dt.x,y:Fe.y-dt.y};return lr(Pt,nt)/en(Pt)/en(nt)},sn=(dt,ye,Fe)=>ye.y===0?null:{x:dt.x+ye.x/ye.y*(Fe-dt.y),y:Fe},Ut=(dt,ye,Fe)=>ye.x===0?null:{x:Fe,y:dt.y+ye.y/ye.x*(Fe-dt.x)},Dt=(dt,ye,Fe,nt)=>{if(ye.x===0)return Ut(Fe,nt,dt.x);if(nt.x===0)return Ut(dt,ye,Fe.x);if(ye.y===0)return sn(Fe,nt,dt.y);if(nt.y===0)return sn(dt,ye,Fe.y);const Pt=jn(ye,nt);if(Pt==0)return null;const Mt={x:Fe.x-dt.x,y:Fe.y-dt.y},Tn=jn(Mt,ye)/Pt,$n=jn(Mt,nt)/Pt,xr=dt.x+$n*ye.x,qn=Fe.x+Tn*nt.x,Ae=dt.y+$n*ye.y,be=Fe.y+Tn*nt.y,Ne=(xr+qn)/2,et=(Ae+be)/2;return{x:Ne,y:et}};class Me{static compare(ye,Fe){const nt=Me.comparePoints(ye.point,Fe.point);return nt!==0?nt:(ye.point!==Fe.point&&ye.link(Fe),ye.isLeft!==Fe.isLeft?ye.isLeft?1:-1:Ft.compare(ye.segment,Fe.segment))}static comparePoints(ye,Fe){return ye.x<Fe.x?-1:ye.x>Fe.x?1:ye.y<Fe.y?-1:ye.y>Fe.y?1:0}constructor(ye,Fe){ye.events===void 0?ye.events=[this]:ye.events.push(this),this.point=ye,this.isLeft=Fe}link(ye){if(ye.point===this.point)throw new Error("Tried to link already linked events");const Fe=ye.point.events;for(let nt=0,Pt=Fe.length;nt<Pt;nt++){const Mt=Fe[nt];this.point.events.push(Mt),Mt.point=this.point}this.checkForConsuming()}checkForConsuming(){const ye=this.point.events.length;for(let Fe=0;Fe<ye;Fe++){const nt=this.point.events[Fe];if(nt.segment.consumedBy===void 0)for(let Pt=Fe+1;Pt<ye;Pt++){const Mt=this.point.events[Pt];Mt.consumedBy===void 0&&nt.otherSE.point.events===Mt.otherSE.point.events&&nt.segment.consume(Mt.segment)}}}getAvailableLinkedEvents(){const ye=[];for(let Fe=0,nt=this.point.events.length;Fe<nt;Fe++){const Pt=this.point.events[Fe];Pt!==this&&!Pt.segment.ringOut&&Pt.segment.isInResult()&&ye.push(Pt)}return ye}getLeftmostComparator(ye){const Fe=new Map,nt=Pt=>{const Mt=Pt.otherSE;Fe.set(Pt,{sine:xn(this.point,ye.point,Mt.point),cosine:er(this.point,ye.point,Mt.point)})};return(Pt,Mt)=>{Fe.has(Pt)||nt(Pt),Fe.has(Mt)||nt(Mt);const{sine:Tn,cosine:$n}=Fe.get(Pt),{sine:xr,cosine:qn}=Fe.get(Mt);return Tn>=0&&xr>=0?$n<qn?1:$n>qn?-1:0:Tn<0&&xr<0?$n<qn?-1:$n>qn?1:0:xr<Tn?-1:xr>Tn?1:0}}}let Qe=0;class Ft{static compare(ye,Fe){const nt=ye.leftSE.point.x,Pt=Fe.leftSE.point.x,Mt=ye.rightSE.point.x,Tn=Fe.rightSE.point.x;if(Tn<nt)return 1;if(Mt<Pt)return-1;const $n=ye.leftSE.point.y,xr=Fe.leftSE.point.y,qn=ye.rightSE.point.y,Ae=Fe.rightSE.point.y;if(nt<Pt){if(xr<$n&&xr<qn)return 1;if(xr>$n&&xr>qn)return-1;const be=ye.comparePoint(Fe.leftSE.point);if(be<0)return 1;if(be>0)return-1;const Ne=Fe.comparePoint(ye.rightSE.point);return Ne!==0?Ne:-1}if(nt>Pt){if($n<xr&&$n<Ae)return-1;if($n>xr&&$n>Ae)return 1;const be=Fe.comparePoint(ye.leftSE.point);if(be!==0)return be;const Ne=ye.comparePoint(Fe.rightSE.point);return Ne<0?1:Ne>0?-1:1}if($n<xr)return-1;if($n>xr)return 1;if(Mt<Tn){const be=Fe.comparePoint(ye.rightSE.point);if(be!==0)return be}if(Mt>Tn){const be=ye.comparePoint(Fe.rightSE.point);if(be<0)return 1;if(be>0)return-1}if(Mt!==Tn){const be=qn-$n,Ne=Mt-nt,et=Ae-xr,wt=Tn-Pt;if(be>Ne&&et<wt)return 1;if(be<Ne&&et>wt)return-1}return Mt>Tn?1:Mt<Tn||qn<Ae?-1:qn>Ae?1:ye.id<Fe.id?-1:ye.id>Fe.id?1:0}constructor(ye,Fe,nt,Pt){this.id=++Qe,this.leftSE=ye,ye.segment=this,ye.otherSE=Fe,this.rightSE=Fe,Fe.segment=this,Fe.otherSE=ye,this.rings=nt,this.windings=Pt}static fromRing(ye,Fe,nt){let Pt,Mt,Tn;const $n=Me.comparePoints(ye,Fe);if($n<0)Pt=ye,Mt=Fe,Tn=1;else if($n>0)Pt=Fe,Mt=ye,Tn=-1;else throw new Error(`Tried to create degenerate segment at [${ye.x}, ${ye.y}]`);const xr=new Me(Pt,!0),qn=new Me(Mt,!1);return new Ft(xr,qn,[nt],[Tn])}replaceRightSE(ye){this.rightSE=ye,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const ye=this.leftSE.point.y,Fe=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:ye<Fe?ye:Fe},ur:{x:this.rightSE.point.x,y:ye>Fe?ye:Fe}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(ye){return ye.x===this.leftSE.point.x&&ye.y===this.leftSE.point.y||ye.x===this.rightSE.point.x&&ye.y===this.rightSE.point.y}comparePoint(ye){if(this.isAnEndpoint(ye))return 0;const Fe=this.leftSE.point,nt=this.rightSE.point,Pt=this.vector();if(Fe.x===nt.x)return ye.x===Fe.x?0:ye.x<Fe.x?1:-1;const Mt=(ye.y-Fe.y)/Pt.y,Tn=Fe.x+Mt*Pt.x;if(ye.x===Tn)return 0;const $n=(ye.x-Fe.x)/Pt.x,xr=Fe.y+$n*Pt.y;return ye.y===xr?0:ye.y<xr?-1:1}getIntersection(ye){const Fe=this.bbox(),nt=ye.bbox(),Pt=xt(Fe,nt);if(Pt===null)return null;const Mt=this.leftSE.point,Tn=this.rightSE.point,$n=ye.leftSE.point,xr=ye.rightSE.point,qn=Ze(Fe,$n)&&this.comparePoint($n)===0,Ae=Ze(nt,Mt)&&ye.comparePoint(Mt)===0,be=Ze(Fe,xr)&&this.comparePoint(xr)===0,Ne=Ze(nt,Tn)&&ye.comparePoint(Tn)===0;if(Ae&&qn)return Ne&&!be?Tn:!Ne&&be?xr:null;if(Ae)return be&&Mt.x===xr.x&&Mt.y===xr.y?null:Mt;if(qn)return Ne&&Tn.x===$n.x&&Tn.y===$n.y?null:$n;if(Ne&&be)return null;if(Ne)return Tn;if(be)return xr;const et=Dt(Mt,this.vector(),$n,ye.vector());return et===null||!Ze(Pt,et)?null:Re.round(et.x,et.y)}split(ye){const Fe=[],nt=ye.events!==void 0,Pt=new Me(ye,!0),Mt=new Me(ye,!1),Tn=this.rightSE;this.replaceRightSE(Mt),Fe.push(Mt),Fe.push(Pt);const $n=new Ft(Pt,Tn,this.rings.slice(),this.windings.slice());return Me.comparePoints($n.leftSE.point,$n.rightSE.point)>0&&$n.swapEvents(),Me.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),nt&&(Pt.checkForConsuming(),Mt.checkForConsuming()),Fe}swapEvents(){const ye=this.rightSE;this.rightSE=this.leftSE,this.leftSE=ye,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let Fe=0,nt=this.windings.length;Fe<nt;Fe++)this.windings[Fe]*=-1}consume(ye){let Fe=this,nt=ye;for(;Fe.consumedBy;)Fe=Fe.consumedBy;for(;nt.consumedBy;)nt=nt.consumedBy;const Pt=Ft.compare(Fe,nt);if(Pt!==0){if(Pt>0){const Mt=Fe;Fe=nt,nt=Mt}if(Fe.prev===nt){const Mt=Fe;Fe=nt,nt=Mt}for(let Mt=0,Tn=nt.rings.length;Mt<Tn;Mt++){const $n=nt.rings[Mt],xr=nt.windings[Mt],qn=Fe.rings.indexOf($n);qn===-1?(Fe.rings.push($n),Fe.windings.push(xr)):Fe.windings[qn]+=xr}nt.rings=null,nt.windings=null,nt.consumedBy=Fe,nt.leftSE.consumedBy=Fe.leftSE,nt.rightSE.consumedBy=Fe.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const ye=this.prev.consumedBy||this.prev;this._beforeState=ye.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const ye=this.beforeState();this._afterState={rings:ye.rings.slice(0),windings:ye.windings.slice(0),multiPolys:[]};const Fe=this._afterState.rings,nt=this._afterState.windings,Pt=this._afterState.multiPolys;for(let $n=0,xr=this.rings.length;$n<xr;$n++){const qn=this.rings[$n],Ae=this.windings[$n],be=Fe.indexOf(qn);be===-1?(Fe.push(qn),nt.push(Ae)):nt[be]+=Ae}const Mt=[],Tn=[];for(let $n=0,xr=Fe.length;$n<xr;$n++){if(nt[$n]===0)continue;const qn=Fe[$n],Ae=qn.poly;if(Tn.indexOf(Ae)===-1)if(qn.isExterior)Mt.push(Ae);else{Tn.indexOf(Ae)===-1&&Tn.push(Ae);const be=Mt.indexOf(qn.poly);be!==-1&&Mt.splice(be,1)}}for(let $n=0,xr=Mt.length;$n<xr;$n++){const qn=Mt[$n].multiPoly;Pt.indexOf(qn)===-1&&Pt.push(qn)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const ye=this.beforeState().multiPolys,Fe=this.afterState().multiPolys;switch(hn.type){case"union":{const nt=ye.length===0,Pt=Fe.length===0;this._isInResult=nt!==Pt;break}case"intersection":{let nt,Pt;ye.length<Fe.length?(nt=ye.length,Pt=Fe.length):(nt=Fe.length,Pt=ye.length),this._isInResult=Pt===hn.numMultiPolys&&nt<Pt;break}case"xor":{const nt=Math.abs(ye.length-Fe.length);this._isInResult=nt%2===1;break}case"difference":{const nt=Pt=>Pt.length===1&&Pt[0].isSubject;this._isInResult=nt(ye)!==nt(Fe);break}default:throw new Error(`Unrecognized operation type found ${hn.type}`)}return this._isInResult}}class U{constructor(ye,Fe,nt){if(!Array.isArray(ye)||ye.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Fe,this.isExterior=nt,this.segments=[],typeof ye[0][0]!="number"||typeof ye[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const Pt=Re.round(ye[0][0],ye[0][1]);this.bbox={ll:{x:Pt.x,y:Pt.y},ur:{x:Pt.x,y:Pt.y}};let Mt=Pt;for(let Tn=1,$n=ye.length;Tn<$n;Tn++){if(typeof ye[Tn][0]!="number"||typeof ye[Tn][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let xr=Re.round(ye[Tn][0],ye[Tn][1]);xr.x===Mt.x&&xr.y===Mt.y||(this.segments.push(Ft.fromRing(Mt,xr,this)),xr.x<this.bbox.ll.x&&(this.bbox.ll.x=xr.x),xr.y<this.bbox.ll.y&&(this.bbox.ll.y=xr.y),xr.x>this.bbox.ur.x&&(this.bbox.ur.x=xr.x),xr.y>this.bbox.ur.y&&(this.bbox.ur.y=xr.y),Mt=xr)}(Pt.x!==Mt.x||Pt.y!==Mt.y)&&this.segments.push(Ft.fromRing(Mt,Pt,this))}getSweepEvents(){const ye=[];for(let Fe=0,nt=this.segments.length;Fe<nt;Fe++){const Pt=this.segments[Fe];ye.push(Pt.leftSE),ye.push(Pt.rightSE)}return ye}}class ue{constructor(ye,Fe){if(!Array.isArray(ye))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new U(ye[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let nt=1,Pt=ye.length;nt<Pt;nt++){const Mt=new U(ye[nt],this,!1);Mt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Mt.bbox.ll.x),Mt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Mt.bbox.ll.y),Mt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Mt.bbox.ur.x),Mt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Mt.bbox.ur.y),this.interiorRings.push(Mt)}this.multiPoly=Fe}getSweepEvents(){const ye=this.exteriorRing.getSweepEvents();for(let Fe=0,nt=this.interiorRings.length;Fe<nt;Fe++){const Pt=this.interiorRings[Fe].getSweepEvents();for(let Mt=0,Tn=Pt.length;Mt<Tn;Mt++)ye.push(Pt[Mt])}return ye}}class at{constructor(ye,Fe){if(!Array.isArray(ye))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof ye[0][0][0]=="number"&&(ye=[ye])}catch(nt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let nt=0,Pt=ye.length;nt<Pt;nt++){const Mt=new ue(ye[nt],this);Mt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Mt.bbox.ll.x),Mt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Mt.bbox.ll.y),Mt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Mt.bbox.ur.x),Mt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Mt.bbox.ur.y),this.polys.push(Mt)}this.isSubject=Fe}getSweepEvents(){const ye=[];for(let Fe=0,nt=this.polys.length;Fe<nt;Fe++){const Pt=this.polys[Fe].getSweepEvents();for(let Mt=0,Tn=Pt.length;Mt<Tn;Mt++)ye.push(Pt[Mt])}return ye}}class ce{static factory(ye){const Fe=[];for(let nt=0,Pt=ye.length;nt<Pt;nt++){const Mt=ye[nt];if(!Mt.isInResult()||Mt.ringOut)continue;let Tn=null,$n=Mt.leftSE,xr=Mt.rightSE;const qn=[$n],Ae=$n.point,be=[];for(;Tn=$n,$n=xr,qn.push($n),$n.point!==Ae;)for(;;){const Ne=$n.getAvailableLinkedEvents();if(Ne.length===0){const qt=qn[0].point,vn=qn[qn.length-1].point;throw new Error(`Unable to complete output ring starting at [${qt.x}, ${qt.y}]. Last matching segment found ends at [${vn.x}, ${vn.y}].`)}if(Ne.length===1){xr=Ne[0].otherSE;break}let et=null;for(let qt=0,vn=be.length;qt<vn;qt++)if(be[qt].point===$n.point){et=qt;break}if(et!==null){const qt=be.splice(et)[0],vn=qn.splice(qt.index);vn.unshift(vn[0].otherSE),Fe.push(new ce(vn.reverse()));continue}be.push({index:qn.length,point:$n.point});const wt=$n.getLeftmostComparator(Tn);xr=Ne.sort(wt)[0].otherSE;break}Fe.push(new ce(qn))}return Fe}constructor(ye){this.events=ye;for(let Fe=0,nt=ye.length;Fe<nt;Fe++)ye[Fe].segment.ringOut=this;this.poly=null}getGeom(){let ye=this.events[0].point;const Fe=[ye];for(let qn=1,Ae=this.events.length-1;qn<Ae;qn++){const be=this.events[qn].point,Ne=this.events[qn+1].point;Vt(be,ye,Ne)!==0&&(Fe.push(be),ye=be)}if(Fe.length===1)return null;const nt=Fe[0],Pt=Fe[1];Vt(nt,ye,Pt)===0&&Fe.shift(),Fe.push(Fe[0]);const Mt=this.isExteriorRing()?1:-1,Tn=this.isExteriorRing()?0:Fe.length-1,$n=this.isExteriorRing()?Fe.length:-1,xr=[];for(let qn=Tn;qn!=$n;qn+=Mt)xr.push([Fe[qn].x,Fe[qn].y]);return xr}isExteriorRing(){if(this._isExteriorRing===void 0){const ye=this.enclosingRing();this._isExteriorRing=ye?!ye.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let ye=this.events[0];for(let Pt=1,Mt=this.events.length;Pt<Mt;Pt++){const Tn=this.events[Pt];Me.compare(ye,Tn)>0&&(ye=Tn)}let Fe=ye.segment.prevInResult(),nt=Fe?Fe.prevInResult():null;for(;;){if(!Fe)return null;if(!nt)return Fe.ringOut;if(nt.ringOut!==Fe.ringOut)return nt.ringOut.enclosingRing()!==Fe.ringOut?Fe.ringOut:Fe.ringOut.enclosingRing();Fe=nt.prevInResult(),nt=Fe?Fe.prevInResult():null}}}class j{constructor(ye){this.exteriorRing=ye,ye.poly=this,this.interiorRings=[]}addInterior(ye){this.interiorRings.push(ye),ye.poly=this}getGeom(){const ye=[this.exteriorRing.getGeom()];if(ye[0]===null)return null;for(let Fe=0,nt=this.interiorRings.length;Fe<nt;Fe++){const Pt=this.interiorRings[Fe].getGeom();Pt!==null&&ye.push(Pt)}return ye}}class ln{constructor(ye){this.rings=ye,this.polys=this._composePolys(ye)}getGeom(){const ye=[];for(let Fe=0,nt=this.polys.length;Fe<nt;Fe++){const Pt=this.polys[Fe].getGeom();Pt!==null&&ye.push(Pt)}return ye}_composePolys(ye){const Fe=[];for(let nt=0,Pt=ye.length;nt<Pt;nt++){const Mt=ye[nt];if(!Mt.poly)if(Mt.isExteriorRing())Fe.push(new j(Mt));else{const Tn=Mt.enclosingRing();Tn.poly||Fe.push(new j(Tn)),Tn.poly.addInterior(Mt)}}return Fe}}class fn{constructor(ye){let Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ft.compare;this.queue=ye,this.tree=new je(Fe),this.segments=[]}process(ye){const Fe=ye.segment,nt=[];if(ye.consumedBy)return ye.isLeft?this.queue.remove(ye.otherSE):this.tree.remove(Fe),nt;const Pt=ye.isLeft?this.tree.add(Fe):this.tree.find(Fe);if(!Pt)throw new Error(`Unable to find segment #${Fe.id} [${Fe.leftSE.point.x}, ${Fe.leftSE.point.y}] -> [${Fe.rightSE.point.x}, ${Fe.rightSE.point.y}] in SweepLine tree.`);let Mt=Pt,Tn=Pt,$n,xr;for(;$n===void 0;)Mt=this.tree.prev(Mt),Mt===null?$n=null:Mt.key.consumedBy===void 0&&($n=Mt.key);for(;xr===void 0;)Tn=this.tree.next(Tn),Tn===null?xr=null:Tn.key.consumedBy===void 0&&(xr=Tn.key);if(ye.isLeft){let qn=null;if($n){const be=$n.getIntersection(Fe);if(be!==null&&(Fe.isAnEndpoint(be)||(qn=be),!$n.isAnEndpoint(be))){const Ne=this._splitSafely($n,be);for(let et=0,wt=Ne.length;et<wt;et++)nt.push(Ne[et])}}let Ae=null;if(xr){const be=xr.getIntersection(Fe);if(be!==null&&(Fe.isAnEndpoint(be)||(Ae=be),!xr.isAnEndpoint(be))){const Ne=this._splitSafely(xr,be);for(let et=0,wt=Ne.length;et<wt;et++)nt.push(Ne[et])}}if(qn!==null||Ae!==null){let be=null;qn===null?be=Ae:Ae===null?be=qn:be=Me.comparePoints(qn,Ae)<=0?qn:Ae,this.queue.remove(Fe.rightSE),nt.push(Fe.rightSE);const Ne=Fe.split(be);for(let et=0,wt=Ne.length;et<wt;et++)nt.push(Ne[et])}nt.length>0?(this.tree.remove(Fe),nt.push(ye)):(this.segments.push(Fe),Fe.prev=$n)}else{if($n&&xr){const qn=$n.getIntersection(xr);if(qn!==null){if(!$n.isAnEndpoint(qn)){const Ae=this._splitSafely($n,qn);for(let be=0,Ne=Ae.length;be<Ne;be++)nt.push(Ae[be])}if(!xr.isAnEndpoint(qn)){const Ae=this._splitSafely(xr,qn);for(let be=0,Ne=Ae.length;be<Ne;be++)nt.push(Ae[be])}}}this.tree.remove(Fe)}return nt}_splitSafely(ye,Fe){this.tree.remove(ye);const nt=ye.rightSE;this.queue.remove(nt);const Pt=ye.split(Fe);return Pt.push(nt),ye.consumedBy===void 0&&this.tree.add(ye),Pt}}const mt=typeof ee!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Gt=typeof ee!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Wn{run(ye,Fe,nt){hn.type=ye,Re.reset();const Pt=[new at(Fe,!0)];for(let be=0,Ne=nt.length;be<Ne;be++)Pt.push(new at(nt[be],!1));if(hn.numMultiPolys=Pt.length,hn.type==="difference"){const be=Pt[0];let Ne=1;for(;Ne<Pt.length;)xt(Pt[Ne].bbox,be.bbox)!==null?Ne++:Pt.splice(Ne,1)}if(hn.type==="intersection")for(let be=0,Ne=Pt.length;be<Ne;be++){const et=Pt[be];for(let wt=be+1,qt=Pt.length;wt<qt;wt++)if(xt(et.bbox,Pt[wt].bbox)===null)return[]}const Mt=new je(Me.compare);for(let be=0,Ne=Pt.length;be<Ne;be++){const et=Pt[be].getSweepEvents();for(let wt=0,qt=et.length;wt<qt;wt++)if(Mt.insert(et[wt]),Mt.size>mt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const Tn=new fn(Mt);let $n=Mt.size,xr=Mt.pop();for(;xr;){const be=xr.key;if(Mt.size===$n){const et=be.segment;throw new Error(`Unable to pop() ${be.isLeft?"left":"right"} SweepEvent [${be.point.x}, ${be.point.y}] from segment #${et.id} [${et.leftSE.point.x}, ${et.leftSE.point.y}] -> [${et.rightSE.point.x}, ${et.rightSE.point.y}] from queue.`)}if(Mt.size>mt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(Tn.segments.length>Gt)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const Ne=Tn.process(be);for(let et=0,wt=Ne.length;et<wt;et++){const qt=Ne[et];qt.consumedBy===void 0&&Mt.insert(qt)}$n=Mt.size,xr=Mt.pop()}Re.reset();const qn=ce.factory(Tn.segments);return new ln(qn).getGeom()}}const hn=new Wn;var Gn={union:function(dt){for(var ye=arguments.length,Fe=new Array(ye>1?ye-1:0),nt=1;nt<ye;nt++)Fe[nt-1]=arguments[nt];return hn.run("union",dt,Fe)},intersection:function(dt){for(var ye=arguments.length,Fe=new Array(ye>1?ye-1:0),nt=1;nt<ye;nt++)Fe[nt-1]=arguments[nt];return hn.run("intersection",dt,Fe)},xor:function(dt){for(var ye=arguments.length,Fe=new Array(ye>1?ye-1:0),nt=1;nt<ye;nt++)Fe[nt-1]=arguments[nt];return hn.run("xor",dt,Fe)},difference:function(dt){for(var ye=arguments.length,Fe=new Array(ye>1?ye-1:0),nt=1;nt<ye;nt++)Fe[nt-1]=arguments[nt];return hn.run("difference",dt,Fe)}};return Gn})},45598:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=_e;var X=ee(D(67294)),E=D(11805);function _e(re){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se=[];return X.default.Children.forEach(re,function(Se){Se==null&&!he.keepEmpty||(Array.isArray(Se)?se=se.concat(_e(Se)):(0,E.isFragment)(Se)&&Se.props?se=se.concat(_e(Se.props.children,he)):se.push(Se))}),se}},3481:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.isStyleSupport=re;var X=ee(D(19158)),E=function(se){if((0,X.default)()&&window.document.documentElement){var Se=Array.isArray(se)?se:[se],oe=window.document.documentElement;return Se.some(function(je){return je in oe.style})}return!1},_e=function(se,Se){if(!E(se))return!1;var oe=document.createElement("div"),je=oe.style[se];return oe.style[se]=Se,oe.style[se]!==je};function re(he,se){return!Array.isArray(he)&&se!==void 0?_e(he,se):E(he)}},27712:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var D={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(E){var _e=E.keyCode;if(E.altKey&&!E.ctrlKey||E.metaKey||_e>=D.F1&&_e<=D.F12)return!1;switch(_e){case D.ALT:case D.CAPS_LOCK:case D.CONTEXT_MENU:case D.CTRL:case D.DOWN:case D.END:case D.ESC:case D.HOME:case D.INSERT:case D.LEFT:case D.MAC_FF_META:case D.META:case D.NUMLOCK:case D.NUM_CENTER:case D.PAGE_DOWN:case D.PAGE_UP:case D.PAUSE:case D.PRINT_SCREEN:case D.RIGHT:case D.SHIFT:case D.UP:case D.WIN_KEY:case D.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(E){if(E>=D.ZERO&&E<=D.NINE||E>=D.NUM_ZERO&&E<=D.NUM_MULTIPLY||E>=D.A&&E<=D.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&E===0)return!0;switch(E){case D.SPACE:case D.QUESTION_MARK:case D.NUM_PLUS:case D.NUM_MINUS:case D.NUM_PERIOD:case D.NUM_DIVISION:case D.SEMICOLON:case D.DASH:case D.EQUALS:case D.COMMA:case D.PERIOD:case D.SLASH:case D.APOSTROPHE:case D.SINGLE_QUOTE:case D.OPEN_SQUARE_BRACKET:case D.BACKSLASH:case D.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},ee=W.default=D},18545:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(67294));function E(_e){var re=X.useRef();re.current=_e;var he=X.useCallback(function(){for(var se,Se=arguments.length,oe=new Array(Se),je=0;je<Se;je++)oe[je]=arguments[je];return(se=re.current)===null||se===void 0?void 0:se.call.apply(se,[re].concat(oe))},[]);return he}},82546:function($t,W,D){"use strict";var ee=D(64836).default,X=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.useLayoutUpdateEffect=W.default=void 0;var E=X(D(67294)),_e=ee(D(19158)),re=(0,_e.default)()?E.useLayoutEffect:E.useEffect,he=function(je,te){var ve=E.useRef(!0);re(function(){return je(ve.current)},te),re(function(){return ve.current=!1,function(){ve.current=!0}},[])},se=W.useLayoutUpdateEffect=function(je,te){he(function(ve){if(!ve)return je()},te)},Se=W.default=he},67265:function($t,W,D){"use strict";var ee=D(75263).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=E;var X=ee(D(67294));function E(_e,re,he){var se=X.useRef({});return(!("value"in se.current)||he(se.current.condition,re))&&(se.current.value=_e(),se.current.condition=re),se.current.value}},60869:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=se;var X=ee(D(27424)),E=ee(D(18545)),_e=D(82546),re=ee(D(78423));function he(Se){return Se!==void 0}function se(Se,oe){var je=oe||{},te=je.defaultValue,ve=je.value,Be=je.onChange,Te=je.postState,we=(0,re.default)(function(){return he(ve)?ve:he(te)?typeof te=="function"?te():te:typeof Se=="function"?Se():Se}),le=(0,X.default)(we,2),Ze=le[0],xt=le[1],ft=ve!==void 0?ve:Ze,Zt=Te?Te(ft):ft,pt=(0,E.default)(Be),vt=(0,re.default)([ft]),ke=(0,X.default)(vt,2),Re=ke[0],bt=ke[1];(0,_e.useLayoutUpdateEffect)(function(){var Ct=Re[0];Ze!==Ct&&pt(Ze,Ct)},[Re]),(0,_e.useLayoutUpdateEffect)(function(){he(ve)||xt(ve)},[ve]);var gt=(0,E.default)(function(Ct,Sn){xt(Ct,Sn),bt([ft],Sn)});return[Zt,gt]}},78423:function($t,W,D){"use strict";var ee=D(75263).default,X=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=re;var E=X(D(27424)),_e=ee(D(67294));function re(he){var se=_e.useRef(!1),Se=_e.useState(he),oe=(0,E.default)(Se,2),je=oe[0],te=oe[1];_e.useEffect(function(){return se.current=!1,function(){se.current=!0}},[]);function ve(Be,Te){Te&&se.current||te(Be)}return[je,ve]}},11102:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var X=ee(D(18698)),E=ee(D(45520));function _e(he,se){var Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,oe=new Set;function je(te,ve){var Be=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Te=oe.has(te);if((0,E.default)(!Te,"Warning: There may be circular references"),Te)return!1;if(te===ve)return!0;if(Se&&Be>1)return!1;oe.add(te);var we=Be+1;if(Array.isArray(te)){if(!Array.isArray(ve)||te.length!==ve.length)return!1;for(var le=0;le<te.length;le++)if(!je(te[le],ve[le],we))return!1;return!0}if(te&&ve&&(0,X.default)(te)==="object"&&(0,X.default)(ve)==="object"){var Ze=Object.keys(te);return Ze.length!==Object.keys(ve).length?!1:Ze.every(function(xt){return je(te[xt],ve[xt],we)})}return!1}return je(he,se)}var re=W.default=_e},18475:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=D;function D(ee,X){var E=Object.assign({},ee);return Array.isArray(X)&&X.forEach(function(_e){delete E[_e]}),E}},75531:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.useComposeRef=W.supportRef=W.supportNodeRef=W.getNodeRef=W.fillRef=W.composeRef=void 0;var X=ee(D(18698)),E=D(67294),_e=D(11805),re=ee(D(67265)),he=W.fillRef=function(Te,we){typeof Te=="function"?Te(we):(0,X.default)(Te)==="object"&&Te&&"current"in Te&&(Te.current=we)},se=W.composeRef=function(){for(var Te=arguments.length,we=new Array(Te),le=0;le<Te;le++)we[le]=arguments[le];var Ze=we.filter(Boolean);return Ze.length<=1?Ze[0]:function(xt){we.forEach(function(ft){he(ft,xt)})}},Se=W.useComposeRef=function(){for(var Te=arguments.length,we=new Array(Te),le=0;le<Te;le++)we[le]=arguments[le];return(0,re.default)(function(){return se.apply(void 0,we)},we,function(Ze,xt){return Ze.length!==xt.length||Ze.every(function(ft,Zt){return ft!==xt[Zt]})})},oe=W.supportRef=function(Te){var we,le,Ze=(0,_e.isMemo)(Te)?Te.type.type:Te.type;return!(typeof Ze=="function"&&!((we=Ze.prototype)!==null&&we!==void 0&&we.render)&&Ze.$$typeof!==_e.ForwardRef||typeof Te=="function"&&!((le=Te.prototype)!==null&&le!==void 0&&le.render)&&Te.$$typeof!==_e.ForwardRef)};function je(Be){return(0,E.isValidElement)(Be)&&!(0,_e.isFragment)(Be)}var te=W.supportNodeRef=function(Te){return je(Te)&&oe(Te)},ve=W.getNodeRef=Number(E.version.split(".")[0])>=19?function(Be){return je(Be)?Be.props.ref:null}:function(Be){return je(Be)?Be.ref:null}},94787:function($t,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0}),W.default=D;function D(ee,X){for(var E=ee,_e=0;_e<X.length;_e+=1){if(E==null)return;E=E[X[_e]]}return E}},20059:function($t,W,D){"use strict";var ee=D(64836).default;Object.defineProperty(W,"__esModule",{value:!0}),W.default=Se,W.merge=ve;var X=ee(D(18698)),E=ee(D(42122)),_e=ee(D(861)),re=ee(D(51589)),he=ee(D(94787));function se(Be,Te,we,le){if(!Te.length)return we;var Ze=(0,re.default)(Te),xt=Ze[0],ft=Ze.slice(1),Zt;return!Be&&typeof xt=="number"?Zt=[]:Array.isArray(Be)?Zt=(0,_e.default)(Be):Zt=(0,E.default)({},Be),le&&we===void 0&&ft.length===1?delete Zt[xt][ft[0]]:Zt[xt]=se(Zt[xt],ft,we,le),Zt}function Se(Be,Te,we){var le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Te.length&&le&&we===void 0&&!(0,he.default)(Be,Te.slice(0,-1))?Be:se(Be,Te,we,le)}function oe(Be){return(0,X.default)(Be)==="object"&&Be!==null&&Object.getPrototypeOf(Be)===Object.prototype}function je(Be){return Array.isArray(Be)?[]:{}}var te=typeof Reflect=="undefined"?Object.keys:Reflect.ownKeys;function ve(){for(var Be=arguments.length,Te=new Array(Be),we=0;we<Be;we++)Te[we]=arguments[we];var le=je(Te[0]);return Te.forEach(function(Ze){function xt(ft,Zt){var pt=new Set(Zt),vt=(0,he.default)(Ze,ft),ke=Array.isArray(vt);if(ke||oe(vt)){if(!pt.has(vt)){pt.add(vt);var Re=(0,he.default)(le,ft);ke?le=Se(le,ft,[]):(!Re||(0,X.default)(Re)!=="object")&&(le=Se(le,ft,je(vt))),te(vt).forEach(function(bt){xt([].concat((0,_e.default)(ft),[bt]),pt)})}}else le=Se(le,ft,vt)}xt([])}),le}},81550:function($t){(function(W,D){$t.exports=D()})(this,function(){"use strict";var W=function(Ue){return Ue instanceof Uint8Array||Ue instanceof Uint16Array||Ue instanceof Uint32Array||Ue instanceof Int8Array||Ue instanceof Int16Array||Ue instanceof Int32Array||Ue instanceof Float32Array||Ue instanceof Float64Array||Ue instanceof Uint8ClampedArray},D=function(Ue,Qt){for(var Mn=Object.keys(Qt),Ar=0;Ar<Mn.length;++Ar)Ue[Mn[Ar]]=Qt[Mn[Ar]];return Ue},ee=`
`;function X(Ue){return typeof atob!="undefined"?atob(Ue):"base64:"+Ue}function E(Ue){var Qt=new Error("(regl) "+Ue);throw console.error(Qt),Qt}function _e(Ue,Qt){Ue||E(Qt)}function re(Ue){return Ue?": "+Ue:""}function he(Ue,Qt,Mn){Ue in Qt||E("unknown parameter ("+Ue+")"+re(Mn)+". possible values: "+Object.keys(Qt).join())}function se(Ue,Qt){W(Ue)||E("invalid parameter type"+re(Qt)+". must be a typed array")}function Se(Ue,Qt){switch(Qt){case"number":return typeof Ue=="number";case"object":return typeof Ue=="object";case"string":return typeof Ue=="string";case"boolean":return typeof Ue=="boolean";case"function":return typeof Ue=="function";case"undefined":return typeof Ue=="undefined";case"symbol":return typeof Ue=="symbol"}}function oe(Ue,Qt,Mn){Se(Ue,Qt)||E("invalid parameter type"+re(Mn)+". expected "+Qt+", got "+typeof Ue)}function je(Ue,Qt){Ue>=0&&(Ue|0)===Ue||E("invalid parameter type, ("+Ue+")"+re(Qt)+". must be a nonnegative integer")}function te(Ue,Qt,Mn){Qt.indexOf(Ue)<0&&E("invalid value"+re(Mn)+". must be one of: "+Qt)}var ve=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Be(Ue){Object.keys(Ue).forEach(function(Qt){ve.indexOf(Qt)<0&&E('invalid regl constructor argument "'+Qt+'". must be one of '+ve)})}function Te(Ue,Qt){for(Ue=Ue+"";Ue.length<Qt;)Ue=" "+Ue;return Ue}function we(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function le(Ue,Qt){this.number=Ue,this.line=Qt,this.errors=[]}function Ze(Ue,Qt,Mn){this.file=Ue,this.line=Qt,this.message=Mn}function xt(){var Ue=new Error,Qt=(Ue.stack||Ue).toString(),Mn=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Qt);if(Mn)return Mn[1];var Ar=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Qt);return Ar?Ar[1]:"unknown"}function ft(){var Ue=new Error,Qt=(Ue.stack||Ue).toString(),Mn=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Qt);if(Mn)return Mn[1];var Ar=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Qt);return Ar?Ar[1]:"unknown"}function Zt(Ue,Qt){var Mn=Ue.split(`
`),Ar=1,$r=0,Or={unknown:new we,0:new we};Or.unknown.name=Or[0].name=Qt||xt(),Or.unknown.lines.push(new le(0,""));for(var yr=0;yr<Mn.length;++yr){var Ai=Mn[yr],fi=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ai);if(fi)switch(fi[1]){case"line":var Li=/(\d+)(\s+\d+)?/.exec(fi[2]);Li&&(Ar=Li[1]|0,Li[2]&&($r=Li[2]|0,$r in Or||(Or[$r]=new we)));break;case"define":var wi=/SHADER_NAME(_B64)?\s+(.*)$/.exec(fi[2]);wi&&(Or[$r].name=wi[1]?X(wi[2]):wi[2]);break}Or[$r].lines.push(new le(Ar++,Ai))}return Object.keys(Or).forEach(function(Ni){var Yi=Or[Ni];Yi.lines.forEach(function(pi){Yi.index[pi.number]=pi})}),Or}function pt(Ue){var Qt=[];return Ue.split(`
`).forEach(function(Mn){if(!(Mn.length<5)){var Ar=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Mn);Ar?Qt.push(new Ze(Ar[1]|0,Ar[2]|0,Ar[3].trim())):Mn.length>0&&Qt.push(new Ze("unknown",0,Mn))}}),Qt}function vt(Ue,Qt){Qt.forEach(function(Mn){var Ar=Ue[Mn.file];if(Ar){var $r=Ar.index[Mn.line];if($r){$r.errors.push(Mn),Ar.hasErrors=!0;return}}Ue.unknown.hasErrors=!0,Ue.unknown.lines[0].errors.push(Mn)})}function ke(Ue,Qt,Mn,Ar,$r){if(!Ue.getShaderParameter(Qt,Ue.COMPILE_STATUS)){var Or=Ue.getShaderInfoLog(Qt),yr=Ar===Ue.FRAGMENT_SHADER?"fragment":"vertex";Ot(Mn,"string",yr+" shader source must be a string",$r);var Ai=Zt(Mn,$r),fi=pt(Or);vt(Ai,fi),Object.keys(Ai).forEach(function(Li){var wi=Ai[Li];if(!wi.hasErrors)return;var Ni=[""],Yi=[""];function pi(Fi,ur){Ni.push(Fi),Yi.push(ur||"")}pi("file number "+Li+": "+wi.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),wi.lines.forEach(function(Fi){if(Fi.errors.length>0){pi(Te(Fi.number,4)+"|  ","background-color:yellow; font-weight:bold"),pi(Fi.line+ee,"color:red; background-color:yellow; font-weight:bold");var ur=0;Fi.errors.forEach(function(Nr){var Ci=Nr.message,Hi=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Ci);if(Hi){var ei=Hi[1];switch(Ci=Hi[2],ei){case"assign":ei="=";break}ur=Math.max(Fi.line.indexOf(ei,ur),0)}else ur=0;pi(Te("| ",6)),pi(Te("^^^",ur+3)+ee,"font-weight:bold"),pi(Te("| ",6)),pi(Ci+ee,"font-weight:bold")}),pi(Te("| ",6)+ee)}else pi(Te(Fi.number,4)+"|  "),pi(Fi.line+ee,"color:red")}),typeof document!="undefined"&&!window.chrome?(Yi[0]=Ni.join("%c"),console.log.apply(console,Yi)):console.log(Ni.join(""))}),_e.raise("Error compiling "+yr+" shader, "+Ai[0].name)}}function Re(Ue,Qt,Mn,Ar,$r){if(!Ue.getProgramParameter(Qt,Ue.LINK_STATUS)){var Or=Ue.getProgramInfoLog(Qt),yr=Zt(Mn,$r),Ai=Zt(Ar,$r),fi='Error linking program with vertex shader, "'+Ai[0].name+'", and fragment shader "'+yr[0].name+'"';typeof document!="undefined"?console.log("%c"+fi+ee+"%c"+Or,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(fi+ee+Or),_e.raise(fi)}}function bt(Ue){Ue._commandRef=xt()}function gt(Ue,Qt,Mn,Ar){bt(Ue);function $r(fi){return fi?Ar.id(fi):0}Ue._fragId=$r(Ue.static.frag),Ue._vertId=$r(Ue.static.vert);function Or(fi,Li){Object.keys(Li).forEach(function(wi){fi[Ar.id(wi)]=!0})}var yr=Ue._uniformSet={};Or(yr,Qt.static),Or(yr,Qt.dynamic);var Ai=Ue._attributeSet={};Or(Ai,Mn.static),Or(Ai,Mn.dynamic),Ue._hasCount="count"in Ue.static||"count"in Ue.dynamic||"elements"in Ue.static||"elements"in Ue.dynamic}function Ct(Ue,Qt){var Mn=ft();E(Ue+" in command "+(Qt||xt())+(Mn==="unknown"?"":" called from "+Mn))}function Sn(Ue,Qt,Mn){Ue||Ct(Qt,Mn||xt())}function He(Ue,Qt,Mn,Ar){Ue in Qt||Ct("unknown parameter ("+Ue+")"+re(Mn)+". possible values: "+Object.keys(Qt).join(),Ar||xt())}function Ot(Ue,Qt,Mn,Ar){Se(Ue,Qt)||Ct("invalid parameter type"+re(Mn)+". expected "+Qt+", got "+typeof Ue,Ar||xt())}function Ce(Ue){Ue()}function ot(Ue,Qt,Mn){Ue.texture?te(Ue.texture._texture.internalformat,Qt,"unsupported texture format for attachment"):te(Ue.renderbuffer._renderbuffer.format,Mn,"unsupported renderbuffer format for attachment")}var $e=33071,Xe=9728,Rt=9984,_t=9985,Pe=9986,Wt=9987,on=5120,Nn=5121,jn=5122,lr=5123,Vt=5124,en=5125,xn=5126,er=32819,sn=32820,Ut=33635,Dt=34042,Me=36193,Qe={};Qe[on]=Qe[Nn]=1,Qe[jn]=Qe[lr]=Qe[Me]=Qe[Ut]=Qe[er]=Qe[sn]=2,Qe[Vt]=Qe[en]=Qe[xn]=Qe[Dt]=4;function Ft(Ue,Qt){return Ue===sn||Ue===er||Ue===Ut?2:Ue===Dt?4:Qe[Ue]*Qt}function U(Ue){return!(Ue&Ue-1)&&!!Ue}function ue(Ue,Qt,Mn){var Ar,$r=Qt.width,Or=Qt.height,yr=Qt.channels;_e($r>0&&$r<=Mn.maxTextureSize&&Or>0&&Or<=Mn.maxTextureSize,"invalid texture shape"),(Ue.wrapS!==$e||Ue.wrapT!==$e)&&_e(U($r)&&U(Or),"incompatible wrap mode for texture, both width and height must be power of 2"),Qt.mipmask===1?$r!==1&&Or!==1&&_e(Ue.minFilter!==Rt&&Ue.minFilter!==Pe&&Ue.minFilter!==_t&&Ue.minFilter!==Wt,"min filter requires mipmap"):(_e(U($r)&&U(Or),"texture must be a square power of 2 to support mipmapping"),_e(Qt.mipmask===($r<<1)-1,"missing or incomplete mipmap data")),Qt.type===xn&&(Mn.extensions.indexOf("oes_texture_float_linear")<0&&_e(Ue.minFilter===Xe&&Ue.magFilter===Xe,"filter not supported, must enable oes_texture_float_linear"),_e(!Ue.genMipmaps,"mipmap generation not supported with float textures"));var Ai=Qt.images;for(Ar=0;Ar<16;++Ar)if(Ai[Ar]){var fi=$r>>Ar,Li=Or>>Ar;_e(Qt.mipmask&1<<Ar,"missing mipmap data");var wi=Ai[Ar];if(_e(wi.width===fi&&wi.height===Li,"invalid shape for mip images"),_e(wi.format===Qt.format&&wi.internalformat===Qt.internalformat&&wi.type===Qt.type,"incompatible type for mip image"),!wi.compressed)if(wi.data){var Ni=Math.ceil(Ft(wi.type,yr)*fi/wi.unpackAlignment)*wi.unpackAlignment;_e(wi.data.byteLength===Ni*Li,"invalid data for image, buffer size is inconsistent with image format")}else wi.element||wi.copy}else Ue.genMipmaps||_e((Qt.mipmask&1<<Ar)===0,"extra mipmap data");Qt.compressed&&_e(!Ue.genMipmaps,"mipmap generation for compressed images not supported")}function at(Ue,Qt,Mn,Ar){var $r=Ue.width,Or=Ue.height,yr=Ue.channels;_e($r>0&&$r<=Ar.maxTextureSize&&Or>0&&Or<=Ar.maxTextureSize,"invalid texture shape"),_e($r===Or,"cube map must be square"),_e(Qt.wrapS===$e&&Qt.wrapT===$e,"wrap mode not supported by cube map");for(var Ai=0;Ai<Mn.length;++Ai){var fi=Mn[Ai];_e(fi.width===$r&&fi.height===Or,"inconsistent cube map face shape"),Qt.genMipmaps&&(_e(!fi.compressed,"can not generate mipmap for compressed textures"),_e(fi.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Li=fi.images,wi=0;wi<16;++wi){var Ni=Li[wi];if(Ni){var Yi=$r>>wi,pi=Or>>wi;_e(fi.mipmask&1<<wi,"missing mipmap data"),_e(Ni.width===Yi&&Ni.height===pi,"invalid shape for mip images"),_e(Ni.format===Ue.format&&Ni.internalformat===Ue.internalformat&&Ni.type===Ue.type,"incompatible type for mip image"),Ni.compressed||(Ni.data?_e(Ni.data.byteLength===Yi*pi*Math.max(Ft(Ni.type,yr),Ni.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ni.element||Ni.copy)}}}}var ce=D(_e,{optional:Ce,raise:E,commandRaise:Ct,command:Sn,parameter:he,commandParameter:He,constructor:Be,type:oe,commandType:Ot,isTypedArray:se,nni:je,oneOf:te,shaderError:ke,linkError:Re,callSite:ft,saveCommandRef:bt,saveDrawInfo:gt,framebufferFormat:ot,guessCommand:xt,texture2D:ue,textureCube:at}),j=0,ln=0;function fn(Ue,Qt){this.id=j++,this.type=Ue,this.data=Qt}function mt(Ue){return Ue.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Gt(Ue){if(Ue.length===0)return[];var Qt=Ue.charAt(0),Mn=Ue.charAt(Ue.length-1);if(Ue.length>1&&Qt===Mn&&(Qt==='"'||Qt==="'"))return['"'+mt(Ue.substr(1,Ue.length-2))+'"'];var Ar=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Ue);if(Ar)return Gt(Ue.substr(0,Ar.index)).concat(Gt(Ar[1])).concat(Gt(Ue.substr(Ar.index+Ar[0].length)));var $r=Ue.split(".");if($r.length===1)return['"'+mt(Ue)+'"'];for(var Or=[],yr=0;yr<$r.length;++yr)Or=Or.concat(Gt($r[yr]));return Or}function Wn(Ue){return"["+Gt(Ue).join("][")+"]"}function hn(Ue,Qt){return new fn(Ue,Wn(Qt+""))}function ht(Ue){return typeof Ue=="function"&&!Ue._reglType||Ue instanceof fn}function Ht(Ue,Qt){return typeof Ue=="function"?new fn(ln,Ue):Ue}var Cn={DynamicVariable:fn,define:hn,isDynamic:ht,unbox:Ht,accessor:Wn},Ln={next:typeof requestAnimationFrame=="function"?function(Ue){return requestAnimationFrame(Ue)}:function(Ue){return setTimeout(Ue,16)},cancel:typeof cancelAnimationFrame=="function"?function(Ue){return cancelAnimationFrame(Ue)}:clearTimeout},Gn=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function dt(){var Ue={"":0},Qt=[""];return{id:function(Mn){var Ar=Ue[Mn];return Ar||(Ar=Ue[Mn]=Qt.length,Qt.push(Mn),Ar)},str:function(Mn){return Qt[Mn]}}}function ye(Ue,Qt,Mn){var Ar=document.createElement("canvas");D(Ar.style,{border:0,margin:0,padding:0,top:0,left:0}),Ue.appendChild(Ar),Ue===document.body&&(Ar.style.position="absolute",D(Ue.style,{margin:0,padding:0}));function $r(){var Ai=window.innerWidth,fi=window.innerHeight;if(Ue!==document.body){var Li=Ue.getBoundingClientRect();Ai=Li.right-Li.left,fi=Li.bottom-Li.top}Ar.width=Mn*Ai,Ar.height=Mn*fi,D(Ar.style,{width:Ai+"px",height:fi+"px"})}var Or;Ue!==document.body&&typeof ResizeObserver=="function"?(Or=new ResizeObserver(function(){setTimeout($r)}),Or.observe(Ue)):window.addEventListener("resize",$r,!1);function yr(){Or?Or.disconnect():window.removeEventListener("resize",$r),Ue.removeChild(Ar)}return $r(),{canvas:Ar,onDestroy:yr}}function Fe(Ue,Qt){function Mn(Ar){try{return Ue.getContext(Ar,Qt)}catch($r){return null}}return Mn("webgl")||Mn("experimental-webgl")||Mn("webgl-experimental")}function nt(Ue){return typeof Ue.nodeName=="string"&&typeof Ue.appendChild=="function"&&typeof Ue.getBoundingClientRect=="function"}function Pt(Ue){return typeof Ue.drawArrays=="function"||typeof Ue.drawElements=="function"}function Mt(Ue){return typeof Ue=="string"?Ue.split():(ce(Array.isArray(Ue),"invalid extension array"),Ue)}function Tn(Ue){return typeof Ue=="string"?(ce(typeof document!="undefined","not supported outside of DOM"),document.querySelector(Ue)):Ue}function $n(Ue){var Qt=Ue||{},Mn,Ar,$r,Or,yr={},Ai=[],fi=[],Li=typeof window=="undefined"?1:window.devicePixelRatio,wi=!1,Ni=function(Fi){Fi&&ce.raise(Fi)},Yi=function(){};if(typeof Qt=="string"?(ce(typeof document!="undefined","selector queries only supported in DOM enviroments"),Mn=document.querySelector(Qt),ce(Mn,"invalid query string for element")):typeof Qt=="object"?nt(Qt)?Mn=Qt:Pt(Qt)?(Or=Qt,$r=Or.canvas):(ce.constructor(Qt),"gl"in Qt?Or=Qt.gl:"canvas"in Qt?$r=Tn(Qt.canvas):"container"in Qt&&(Ar=Tn(Qt.container)),"attributes"in Qt&&(yr=Qt.attributes,ce.type(yr,"object","invalid context attributes")),"extensions"in Qt&&(Ai=Mt(Qt.extensions)),"optionalExtensions"in Qt&&(fi=Mt(Qt.optionalExtensions)),"onDone"in Qt&&(ce.type(Qt.onDone,"function","invalid or missing onDone callback"),Ni=Qt.onDone),"profile"in Qt&&(wi=!!Qt.profile),"pixelRatio"in Qt&&(Li=+Qt.pixelRatio,ce(Li>0,"invalid pixel ratio"))):ce.raise("invalid arguments to regl"),Mn&&(Mn.nodeName.toLowerCase()==="canvas"?$r=Mn:Ar=Mn),!Or){if(!$r){ce(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var pi=ye(Ar||document.body,Ni,Li);if(!pi)return null;$r=pi.canvas,Yi=pi.onDestroy}yr.premultipliedAlpha===void 0&&(yr.premultipliedAlpha=!0),Or=Fe($r,yr)}return Or?{gl:Or,canvas:$r,container:Ar,extensions:Ai,optionalExtensions:fi,pixelRatio:Li,profile:wi,onDone:Ni,onDestroy:Yi}:(Yi(),Ni("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function xr(Ue,Qt){var Mn={};function Ar(yr){ce.type(yr,"string","extension name must be string");var Ai=yr.toLowerCase(),fi;try{fi=Mn[Ai]=Ue.getExtension(Ai)}catch(Li){}return!!fi}for(var $r=0;$r<Qt.extensions.length;++$r){var Or=Qt.extensions[$r];if(!Ar(Or))return Qt.onDestroy(),Qt.onDone('"'+Or+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Qt.optionalExtensions.forEach(Ar),{extensions:Mn,restore:function(){Object.keys(Mn).forEach(function(yr){if(Mn[yr]&&!Ar(yr))throw new Error("(regl): error restoring extension "+yr)})}}}function qn(Ue,Qt){for(var Mn=Array(Ue),Ar=0;Ar<Ue;++Ar)Mn[Ar]=Qt(Ar);return Mn}var Ae=5120,be=5121,Ne=5122,et=5123,wt=5124,qt=5125,vn=5126;function yt(Ue){for(var Qt=16;Qt<=1<<28;Qt*=16)if(Ue<=Qt)return Qt;return 0}function Jt(Ue){var Qt,Mn;return Qt=(Ue>65535)<<4,Ue>>>=Qt,Mn=(Ue>255)<<3,Ue>>>=Mn,Qt|=Mn,Mn=(Ue>15)<<2,Ue>>>=Mn,Qt|=Mn,Mn=(Ue>3)<<1,Ue>>>=Mn,Qt|=Mn,Qt|Ue>>1}function Qn(){var Ue=qn(8,function(){return[]});function Qt(Or){var yr=yt(Or),Ai=Ue[Jt(yr)>>2];return Ai.length>0?Ai.pop():new ArrayBuffer(yr)}function Mn(Or){Ue[Jt(Or.byteLength)>>2].push(Or)}function Ar(Or,yr){var Ai=null;switch(Or){case Ae:Ai=new Int8Array(Qt(yr),0,yr);break;case be:Ai=new Uint8Array(Qt(yr),0,yr);break;case Ne:Ai=new Int16Array(Qt(2*yr),0,yr);break;case et:Ai=new Uint16Array(Qt(2*yr),0,yr);break;case wt:Ai=new Int32Array(Qt(4*yr),0,yr);break;case qt:Ai=new Uint32Array(Qt(4*yr),0,yr);break;case vn:Ai=new Float32Array(Qt(4*yr),0,yr);break;default:return null}return Ai.length!==yr?Ai.subarray(0,yr):Ai}function $r(Or){Mn(Or.buffer)}return{alloc:Qt,free:Mn,allocType:Ar,freeType:$r}}var Er=Qn();Er.zero=Qn();var Vr=3408,mr=3410,kr=3411,Ei=3412,Oi=3413,ar=3414,Kr=3415,hi=33901,Qr=33902,Io=3379,Ii=3386,Fo=34921,_a=36347,Co=36348,Qo=35661,De=35660,Je=34930,kt=36349,un=34076,Bn=34024,kn=7936,pn=7937,On=7938,vr=35724,fr=34047,ci=36063,Gi=34852,no=3553,Jr=34067,ji=34069,Di=33984,Gr=6408,fo=5126,Ri=5121,bo=36160,xi=36053,wo=36064,ia=16384,Ga=function(Ue,Qt){var Mn=1;Qt.ext_texture_filter_anisotropic&&(Mn=Ue.getParameter(fr));var Ar=1,$r=1;Qt.webgl_draw_buffers&&(Ar=Ue.getParameter(Gi),$r=Ue.getParameter(ci));var Or=!!Qt.oes_texture_float;if(Or){var yr=Ue.createTexture();Ue.bindTexture(no,yr),Ue.texImage2D(no,0,Gr,1,1,0,Gr,fo,null);var Ai=Ue.createFramebuffer();if(Ue.bindFramebuffer(bo,Ai),Ue.framebufferTexture2D(bo,wo,no,yr,0),Ue.bindTexture(no,null),Ue.checkFramebufferStatus(bo)!==xi)Or=!1;else{Ue.viewport(0,0,1,1),Ue.clearColor(1,0,0,1),Ue.clear(ia);var fi=Er.allocType(fo,4);Ue.readPixels(0,0,1,1,Gr,fo,fi),Ue.getError()?Or=!1:(Ue.deleteFramebuffer(Ai),Ue.deleteTexture(yr),Or=fi[0]===1),Er.freeType(fi)}}var Li=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),wi=!0;if(!Li){var Ni=Ue.createTexture(),Yi=Er.allocType(Ri,36);Ue.activeTexture(Di),Ue.bindTexture(Jr,Ni),Ue.texImage2D(ji,0,Gr,3,3,0,Gr,Ri,Yi),Er.freeType(Yi),Ue.bindTexture(Jr,null),Ue.deleteTexture(Ni),wi=!Ue.getError()}return{colorBits:[Ue.getParameter(mr),Ue.getParameter(kr),Ue.getParameter(Ei),Ue.getParameter(Oi)],depthBits:Ue.getParameter(ar),stencilBits:Ue.getParameter(Kr),subpixelBits:Ue.getParameter(Vr),extensions:Object.keys(Qt).filter(function(pi){return!!Qt[pi]}),maxAnisotropic:Mn,maxDrawbuffers:Ar,maxColorAttachments:$r,pointSizeDims:Ue.getParameter(hi),lineWidthDims:Ue.getParameter(Qr),maxViewportDims:Ue.getParameter(Ii),maxCombinedTextureUnits:Ue.getParameter(Qo),maxCubeMapSize:Ue.getParameter(un),maxRenderbufferSize:Ue.getParameter(Bn),maxTextureUnits:Ue.getParameter(Je),maxTextureSize:Ue.getParameter(Io),maxAttributes:Ue.getParameter(Fo),maxVertexUniforms:Ue.getParameter(_a),maxVertexTextureUnits:Ue.getParameter(De),maxVaryingVectors:Ue.getParameter(Co),maxFragmentUniforms:Ue.getParameter(kt),glsl:Ue.getParameter(vr),renderer:Ue.getParameter(pn),vendor:Ue.getParameter(kn),version:Ue.getParameter(On),readFloat:Or,npotTextureCube:wi}};function Jo(Ue){return!!Ue&&typeof Ue=="object"&&Array.isArray(Ue.shape)&&Array.isArray(Ue.stride)&&typeof Ue.offset=="number"&&Ue.shape.length===Ue.stride.length&&(Array.isArray(Ue.data)||W(Ue.data))}var Wo=function(Ue){return Object.keys(Ue).map(function(Qt){return Ue[Qt]})},Ha={shape:ai,flatten:dr};function ds(Ue,Qt,Mn){for(var Ar=0;Ar<Qt;++Ar)Mn[Ar]=Ue[Ar]}function Tt(Ue,Qt,Mn,Ar){for(var $r=0,Or=0;Or<Qt;++Or)for(var yr=Ue[Or],Ai=0;Ai<Mn;++Ai)Ar[$r++]=yr[Ai]}function Yt(Ue,Qt,Mn,Ar,$r,Or){for(var yr=Or,Ai=0;Ai<Qt;++Ai)for(var fi=Ue[Ai],Li=0;Li<Mn;++Li)for(var wi=fi[Li],Ni=0;Ni<Ar;++Ni)$r[yr++]=wi[Ni]}function Fn(Ue,Qt,Mn,Ar,$r){for(var Or=1,yr=Mn+1;yr<Qt.length;++yr)Or*=Qt[yr];var Ai=Qt[Mn];if(Qt.length-Mn===4){var fi=Qt[Mn+1],Li=Qt[Mn+2],wi=Qt[Mn+3];for(yr=0;yr<Ai;++yr)Yt(Ue[yr],fi,Li,wi,Ar,$r),$r+=Or}else for(yr=0;yr<Ai;++yr)Fn(Ue[yr],Qt,Mn+1,Ar,$r),$r+=Or}function dr(Ue,Qt,Mn,Ar){var $r=1;if(Qt.length)for(var Or=0;Or<Qt.length;++Or)$r*=Qt[Or];else $r=0;var yr=Ar||Er.allocType(Mn,$r);switch(Qt.length){case 0:break;case 1:ds(Ue,Qt[0],yr);break;case 2:Tt(Ue,Qt[0],Qt[1],yr);break;case 3:Yt(Ue,Qt[0],Qt[1],Qt[2],yr,0);break;default:Fn(Ue,Qt,0,yr,0)}return yr}function ai(Ue){for(var Qt=[],Mn=Ue;Mn.length;Mn=Mn[0])Qt.push(Mn.length);return Qt}var Xr={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Uo=5120,Xo=5122,ya=5124,vs=5121,nl=5123,$f=5125,jd=5126,Uh=5126,Pl={int8:Uo,int16:Xo,int32:ya,uint8:vs,uint16:nl,uint32:$f,float:jd,float32:Uh},Df=35048,Nf=35040,rc={dynamic:Df,stream:Nf,static:35044},gu=Ha.flatten,ou=Ha.shape,qu=35044,lc=35040,Xs=5121,Lu=5126,gf=[];gf[5120]=1,gf[5122]=2,gf[5124]=4,gf[5121]=1,gf[5123]=2,gf[5125]=4,gf[5126]=4;function jh(Ue){return Xr[Object.prototype.toString.call(Ue)]|0}function bp(Ue,Qt){for(var Mn=0;Mn<Qt.length;++Mn)Ue[Mn]=Qt[Mn]}function vh(Ue,Qt,Mn,Ar,$r,Or,yr){for(var Ai=0,fi=0;fi<Mn;++fi)for(var Li=0;Li<Ar;++Li)Ue[Ai++]=Qt[$r*fi+Or*Li+yr]}function Kf(Ue,Qt,Mn,Ar){var $r=0,Or={};function yr(ur){this.id=$r++,this.buffer=Ue.createBuffer(),this.type=ur,this.usage=qu,this.byteLength=0,this.dimension=1,this.dtype=Xs,this.persistentData=null,Mn.profile&&(this.stats={size:0})}yr.prototype.bind=function(){Ue.bindBuffer(this.type,this.buffer)},yr.prototype.destroy=function(){Yi(this)};var Ai=[];function fi(ur,Nr){var Ci=Ai.pop();return Ci||(Ci=new yr(ur)),Ci.bind(),Ni(Ci,Nr,lc,0,1,!1),Ci}function Li(ur){Ai.push(ur)}function wi(ur,Nr,Ci){ur.byteLength=Nr.byteLength,Ue.bufferData(ur.type,Nr,Ci)}function Ni(ur,Nr,Ci,Hi,ei,ro){var yi;if(ur.usage=Ci,Array.isArray(Nr)){if(ur.dtype=Hi||Lu,Nr.length>0){var to;if(Array.isArray(Nr[0])){yi=ou(Nr);for(var si=1,qi=1;qi<yi.length;++qi)si*=yi[qi];ur.dimension=si,to=gu(Nr,yi,ur.dtype),wi(ur,to,Ci),ro?ur.persistentData=to:Er.freeType(to)}else if(typeof Nr[0]=="number"){ur.dimension=ei;var Go=Er.allocType(ur.dtype,Nr.length);bp(Go,Nr),wi(ur,Go,Ci),ro?ur.persistentData=Go:Er.freeType(Go)}else W(Nr[0])?(ur.dimension=Nr[0].length,ur.dtype=Hi||jh(Nr[0])||Lu,to=gu(Nr,[Nr.length,Nr[0].length],ur.dtype),wi(ur,to,Ci),ro?ur.persistentData=to:Er.freeType(to)):ce.raise("invalid buffer data")}}else if(W(Nr))ur.dtype=Hi||jh(Nr),ur.dimension=ei,wi(ur,Nr,Ci),ro&&(ur.persistentData=new Uint8Array(new Uint8Array(Nr.buffer)));else if(Jo(Nr)){yi=Nr.shape;var fa=Nr.stride,$i=Nr.offset,_i=0,qr=0,Zo=0,Ua=0;yi.length===1?(_i=yi[0],qr=1,Zo=fa[0],Ua=0):yi.length===2?(_i=yi[0],qr=yi[1],Zo=fa[0],Ua=fa[1]):ce.raise("invalid shape"),ur.dtype=Hi||jh(Nr.data)||Lu,ur.dimension=qr;var oo=Er.allocType(ur.dtype,_i*qr);vh(oo,Nr.data,_i,qr,Zo,Ua,$i),wi(ur,oo,Ci),ro?ur.persistentData=oo:Er.freeType(oo)}else Nr instanceof ArrayBuffer?(ur.dtype=Xs,ur.dimension=ei,wi(ur,Nr,Ci),ro&&(ur.persistentData=new Uint8Array(new Uint8Array(Nr)))):ce.raise("invalid buffer data")}function Yi(ur){Qt.bufferCount--,Ar(ur);var Nr=ur.buffer;ce(Nr,"buffer must not be deleted already"),Ue.deleteBuffer(Nr),ur.buffer=null,delete Or[ur.id]}function pi(ur,Nr,Ci,Hi){Qt.bufferCount++;var ei=new yr(Nr);Or[ei.id]=ei;function ro(si){var qi=qu,Go=null,fa=0,$i=0,_i=1;return Array.isArray(si)||W(si)||Jo(si)||si instanceof ArrayBuffer?Go=si:typeof si=="number"?fa=si|0:si&&(ce.type(si,"object","buffer arguments must be an object, a number or an array"),"data"in si&&(ce(Go===null||Array.isArray(Go)||W(Go)||Jo(Go),"invalid data for buffer"),Go=si.data),"usage"in si&&(ce.parameter(si.usage,rc,"invalid buffer usage"),qi=rc[si.usage]),"type"in si&&(ce.parameter(si.type,Pl,"invalid buffer type"),$i=Pl[si.type]),"dimension"in si&&(ce.type(si.dimension,"number","invalid dimension"),_i=si.dimension|0),"length"in si&&(ce.nni(fa,"buffer length must be a nonnegative integer"),fa=si.length|0)),ei.bind(),Go?Ni(ei,Go,qi,$i,_i,Hi):(fa&&Ue.bufferData(ei.type,fa,qi),ei.dtype=$i||Xs,ei.usage=qi,ei.dimension=_i,ei.byteLength=fa),Mn.profile&&(ei.stats.size=ei.byteLength*gf[ei.dtype]),ro}function yi(si,qi){ce(qi+si.byteLength<=ei.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+si.byteLength+" starting from offset "+qi+" to a buffer of size "+ei.byteLength),Ue.bufferSubData(ei.type,qi,si)}function to(si,qi){var Go=(qi||0)|0,fa;if(ei.bind(),W(si)||si instanceof ArrayBuffer)yi(si,Go);else if(Array.isArray(si)){if(si.length>0)if(typeof si[0]=="number"){var $i=Er.allocType(ei.dtype,si.length);bp($i,si),yi($i,Go),Er.freeType($i)}else if(Array.isArray(si[0])||W(si[0])){fa=ou(si);var _i=gu(si,fa,ei.dtype);yi(_i,Go),Er.freeType(_i)}else ce.raise("invalid buffer data")}else if(Jo(si)){fa=si.shape;var qr=si.stride,Zo=0,Ua=0,oo=0,Pa=0;fa.length===1?(Zo=fa[0],Ua=1,oo=qr[0],Pa=0):fa.length===2?(Zo=fa[0],Ua=fa[1],oo=qr[0],Pa=qr[1]):ce.raise("invalid shape");var da=Array.isArray(si.data)?ei.dtype:jh(si.data),oa=Er.allocType(da,Zo*Ua);vh(oa,si.data,Zo,Ua,oo,Pa,si.offset),yi(oa,Go),Er.freeType(oa)}else ce.raise("invalid data for buffer subdata");return ro}return Ci||ro(ur),ro._reglType="buffer",ro._buffer=ei,ro.subdata=to,Mn.profile&&(ro.stats=ei.stats),ro.destroy=function(){Yi(ei)},ro}function Fi(){Wo(Or).forEach(function(ur){ur.buffer=Ue.createBuffer(),Ue.bindBuffer(ur.type,ur.buffer),Ue.bufferData(ur.type,ur.persistentData||ur.byteLength,ur.usage)})}return Mn.profile&&(Qt.getTotalBufferSize=function(){var ur=0;return Object.keys(Or).forEach(function(Nr){ur+=Or[Nr].stats.size}),ur}),{create:pi,createStream:fi,destroyStream:Li,clear:function(){Wo(Or).forEach(Yi),Ai.forEach(Yi)},getBuffer:function(ur){return ur&&ur._buffer instanceof yr?ur._buffer:null},restore:Fi,_initBuffer:Ni}}var Du=0,gh=0,Vh=1,bd=1,t0=4,qf=4,yu={points:Du,point:gh,lines:Vh,line:bd,triangles:t0,triangle:qf,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Vd=0,zl=1,_u=4,Qu=5120,_s=5121,au=5122,xc=5123,Ju=5124,hl=5125,Nu=34963,ef=35040,Hd=35044;function Hh(Ue,Qt,Mn,Ar){var $r={},Or=0,yr={uint8:_s,uint16:xc};Qt.oes_element_index_uint&&(yr.uint32=hl);function Ai(Fi){this.id=Or++,$r[this.id]=this,this.buffer=Fi,this.primType=_u,this.vertCount=0,this.type=0}Ai.prototype.bind=function(){this.buffer.bind()};var fi=[];function Li(Fi){var ur=fi.pop();return ur||(ur=new Ai(Mn.create(null,Nu,!0,!1)._buffer)),Ni(ur,Fi,ef,-1,-1,0,0),ur}function wi(Fi){fi.push(Fi)}function Ni(Fi,ur,Nr,Ci,Hi,ei,ro){Fi.buffer.bind();var yi;if(ur){var to=ro;!ro&&(!W(ur)||Jo(ur)&&!W(ur.data))&&(to=Qt.oes_element_index_uint?hl:xc),Mn._initBuffer(Fi.buffer,ur,Nr,to,3)}else Ue.bufferData(Nu,ei,Nr),Fi.buffer.dtype=yi||_s,Fi.buffer.usage=Nr,Fi.buffer.dimension=3,Fi.buffer.byteLength=ei;if(yi=ro,!ro){switch(Fi.buffer.dtype){case _s:case Qu:yi=_s;break;case xc:case au:yi=xc;break;case hl:case Ju:yi=hl;break;default:ce.raise("unsupported type for element array")}Fi.buffer.dtype=yi}Fi.type=yi,ce(yi!==hl||!!Qt.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var si=Hi;si<0&&(si=Fi.buffer.byteLength,yi===xc?si>>=1:yi===hl&&(si>>=2)),Fi.vertCount=si;var qi=Ci;if(Ci<0){qi=_u;var Go=Fi.buffer.dimension;Go===1&&(qi=Vd),Go===2&&(qi=zl),Go===3&&(qi=_u)}Fi.primType=qi}function Yi(Fi){Ar.elementsCount--,ce(Fi.buffer!==null,"must not double destroy elements"),delete $r[Fi.id],Fi.buffer.destroy(),Fi.buffer=null}function pi(Fi,ur){var Nr=Mn.create(null,Nu,!0),Ci=new Ai(Nr._buffer);Ar.elementsCount++;function Hi(ei){if(!ei)Nr(),Ci.primType=_u,Ci.vertCount=0,Ci.type=_s;else if(typeof ei=="number")Nr(ei),Ci.primType=_u,Ci.vertCount=ei|0,Ci.type=_s;else{var ro=null,yi=Hd,to=-1,si=-1,qi=0,Go=0;Array.isArray(ei)||W(ei)||Jo(ei)?ro=ei:(ce.type(ei,"object","invalid arguments for elements"),"data"in ei&&(ro=ei.data,ce(Array.isArray(ro)||W(ro)||Jo(ro),"invalid data for element buffer")),"usage"in ei&&(ce.parameter(ei.usage,rc,"invalid element buffer usage"),yi=rc[ei.usage]),"primitive"in ei&&(ce.parameter(ei.primitive,yu,"invalid element buffer primitive"),to=yu[ei.primitive]),"count"in ei&&(ce(typeof ei.count=="number"&&ei.count>=0,"invalid vertex count for elements"),si=ei.count|0),"type"in ei&&(ce.parameter(ei.type,yr,"invalid buffer type"),Go=yr[ei.type]),"length"in ei?qi=ei.length|0:(qi=si,Go===xc||Go===au?qi*=2:(Go===hl||Go===Ju)&&(qi*=4))),Ni(Ci,ro,yi,to,si,qi,Go)}return Hi}return Hi(Fi),Hi._reglType="elements",Hi._elements=Ci,Hi.subdata=function(ei,ro){return Nr.subdata(ei,ro),Hi},Hi.destroy=function(){Yi(Ci)},Hi}return{create:pi,createStream:Li,destroyStream:wi,getElements:function(Fi){return typeof Fi=="function"&&Fi._elements instanceof Ai?Fi._elements:null},clear:function(){Wo($r).forEach(Yi)}}}var ns=new Float32Array(1),yh=new Uint32Array(ns.buffer),Zh=5123;function Wh(Ue){for(var Qt=Er.allocType(Zh,Ue.length),Mn=0;Mn<Ue.length;++Mn)if(isNaN(Ue[Mn]))Qt[Mn]=65535;else if(Ue[Mn]===1/0)Qt[Mn]=31744;else if(Ue[Mn]===-1/0)Qt[Mn]=64512;else{ns[0]=Ue[Mn];var Ar=yh[0],$r=Ar>>>31<<15,Or=(Ar<<1>>>24)-127,yr=Ar>>13&1023;if(Or<-24)Qt[Mn]=$r;else if(Or<-14){var Ai=-14-Or;Qt[Mn]=$r+(yr+1024>>Ai)}else Or>15?Qt[Mn]=$r+31744:Qt[Mn]=$r+(Or+15<<10)+yr}return Qt}function rl(Ue){return Array.isArray(Ue)||W(Ue)}var Bf=function(Ue){return!(Ue&Ue-1)&&!!Ue},_h=34467,ne=3553,ge=34067,qe=34069,mn=6408,K=6406,tr=6407,Mr=6409,Bi=6410,zi=32854,so=32855,Si=36194,Sa=32819,Do=32820,ha=33635,rs=34042,ua=6402,Aa=34041,ls=35904,Ma=35906,Da=36193,Xa=33776,Ls=33777,Qa=33778,Ec=33779,cs=35986,Bu=35987,bu=34798,Nc=35840,Qf=35841,xd=35842,bh=35843,yf=36196,tf=5121,Gh=5123,xh=5125,Fu=5126,n0=10242,Jf=10243,xp=10497,Ed=33071,Bc=33648,Xh=10240,Zd=10241,Eh=9728,Yh=9729,xu=9984,Sh=9985,_f=9986,ks=9987,Wd=33170,Gl=4352,fe=4353,Ie=4354,ct=34046,gn=3317,ir=37440,Ur=37441,mi=37443,Ki=37444,ma=33984,ba=[xu,_f,Sh,ks],bs=[0,Mr,Bi,tr,mn],za={};za[Mr]=za[K]=za[ua]=1,za[Aa]=za[Bi]=2,za[tr]=za[ls]=3,za[mn]=za[Ma]=4;function Na(Ue){return"[object "+Ue+"]"}var Sc=Na("HTMLCanvasElement"),nf=Na("OffscreenCanvas"),Ys=Na("CanvasRenderingContext2D"),io=Na("ImageBitmap"),Wc=Na("HTMLImageElement"),Gd=Na("HTMLVideoElement"),$h=Object.keys(Xr).concat([Sc,nf,Ys,io,Wc,Gd]),_l=[];_l[tf]=1,_l[Fu]=4,_l[Da]=2,_l[Gh]=2,_l[xh]=4;var Ja=[];Ja[zi]=2,Ja[so]=2,Ja[Si]=2,Ja[Aa]=4,Ja[Xa]=.5,Ja[Ls]=.5,Ja[Qa]=1,Ja[Ec]=1,Ja[cs]=.5,Ja[Bu]=1,Ja[bu]=1,Ja[Nc]=.5,Ja[Qf]=.25,Ja[xd]=.5,Ja[bh]=.25,Ja[yf]=.5;function r0(Ue){return Array.isArray(Ue)&&(Ue.length===0||typeof Ue[0]=="number")}function Xi(Ue){if(!Array.isArray(Ue))return!1;var Qt=Ue.length;return!(Qt===0||!rl(Ue[0]))}function Ff(Ue){return Object.prototype.toString.call(Ue)}function Eu(Ue){return Ff(Ue)===Sc}function Ep(Ue){return Ff(Ue)===nf}function rf(Ue){return Ff(Ue)===Ys}function of(Ue){return Ff(Ue)===io}function eh(Ue){return Ff(Ue)===Wc}function Sp(Ue){return Ff(Ue)===Gd}function Gc(Ue){if(!Ue)return!1;var Qt=Ff(Ue);return $h.indexOf(Qt)>=0?!0:r0(Ue)||Xi(Ue)||Jo(Ue)}function th(Ue){return Xr[Object.prototype.toString.call(Ue)]|0}function i0(Ue,Qt){var Mn=Qt.length;switch(Ue.type){case tf:case Gh:case xh:case Fu:var Ar=Er.allocType(Ue.type,Mn);Ar.set(Qt),Ue.data=Ar;break;case Da:Ue.data=Wh(Qt);break;default:ce.raise("unsupported texture type, must specify a typed array")}}function Sd(Ue,Qt){return Er.allocType(Ue.type===Da?Fu:Ue.type,Qt)}function k0(Ue,Qt){Ue.type===Da?(Ue.data=Wh(Qt),Er.freeType(Qt)):Ue.data=Qt}function z0(Ue,Qt,Mn,Ar,$r,Or){for(var yr=Ue.width,Ai=Ue.height,fi=Ue.channels,Li=yr*Ai*fi,wi=Sd(Ue,Li),Ni=0,Yi=0;Yi<Ai;++Yi)for(var pi=0;pi<yr;++pi)for(var Fi=0;Fi<fi;++Fi)wi[Ni++]=Qt[Mn*pi+Ar*Yi+$r*Fi+Or];k0(Ue,wi)}function su(Ue,Qt,Mn,Ar,$r,Or){var yr;if(typeof Ja[Ue]!="undefined"?yr=Ja[Ue]:yr=za[Ue]*_l[Qt],Or&&(yr*=6),$r){for(var Ai=0,fi=Mn;fi>=1;)Ai+=yr*fi*fi,fi/=2;return Ai}else return yr*Mn*Ar}function af(Ue,Qt,Mn,Ar,$r,Or,yr){var Ai={"don't care":Gl,"dont care":Gl,nice:Ie,fast:fe},fi={repeat:xp,clamp:Ed,mirror:Bc},Li={nearest:Eh,linear:Yh},wi=D({mipmap:ks,"nearest mipmap nearest":xu,"linear mipmap nearest":Sh,"nearest mipmap linear":_f,"linear mipmap linear":ks},Li),Ni={none:0,browser:Ki},Yi={uint8:tf,rgba4:Sa,rgb565:ha,"rgb5 a1":Do},pi={alpha:K,luminance:Mr,"luminance alpha":Bi,rgb:tr,rgba:mn,rgba4:zi,"rgb5 a1":so,rgb565:Si},Fi={};Qt.ext_srgb&&(pi.srgb=ls,pi.srgba=Ma),Qt.oes_texture_float&&(Yi.float32=Yi.float=Fu),Qt.oes_texture_half_float&&(Yi.float16=Yi["half float"]=Da),Qt.webgl_depth_texture&&(D(pi,{depth:ua,"depth stencil":Aa}),D(Yi,{uint16:Gh,uint32:xh,"depth stencil":rs})),Qt.webgl_compressed_texture_s3tc&&D(Fi,{"rgb s3tc dxt1":Xa,"rgba s3tc dxt1":Ls,"rgba s3tc dxt3":Qa,"rgba s3tc dxt5":Ec}),Qt.webgl_compressed_texture_atc&&D(Fi,{"rgb atc":cs,"rgba atc explicit alpha":Bu,"rgba atc interpolated alpha":bu}),Qt.webgl_compressed_texture_pvrtc&&D(Fi,{"rgb pvrtc 4bppv1":Nc,"rgb pvrtc 2bppv1":Qf,"rgba pvrtc 4bppv1":xd,"rgba pvrtc 2bppv1":bh}),Qt.webgl_compressed_texture_etc1&&(Fi["rgb etc1"]=yf);var ur=Array.prototype.slice.call(Ue.getParameter(_h));Object.keys(Fi).forEach(function(dn){var Pr=Fi[dn];ur.indexOf(Pr)>=0&&(pi[dn]=Pr)});var Nr=Object.keys(pi);Mn.textureFormats=Nr;var Ci=[];Object.keys(pi).forEach(function(dn){var Pr=pi[dn];Ci[Pr]=dn});var Hi=[];Object.keys(Yi).forEach(function(dn){var Pr=Yi[dn];Hi[Pr]=dn});var ei=[];Object.keys(Li).forEach(function(dn){var Pr=Li[dn];ei[Pr]=dn});var ro=[];Object.keys(wi).forEach(function(dn){var Pr=wi[dn];ro[Pr]=dn});var yi=[];Object.keys(fi).forEach(function(dn){var Pr=fi[dn];yi[Pr]=dn});var to=Nr.reduce(function(dn,Pr){var pr=pi[Pr];return pr===Mr||pr===K||pr===Mr||pr===Bi||pr===ua||pr===Aa||Qt.ext_srgb&&(pr===ls||pr===Ma)?dn[pr]=pr:pr===so||Pr.indexOf("rgba")>=0?dn[pr]=mn:dn[pr]=tr,dn},{});function si(){this.internalformat=mn,this.format=mn,this.type=tf,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ki,this.width=0,this.height=0,this.channels=0}function qi(dn,Pr){dn.internalformat=Pr.internalformat,dn.format=Pr.format,dn.type=Pr.type,dn.compressed=Pr.compressed,dn.premultiplyAlpha=Pr.premultiplyAlpha,dn.flipY=Pr.flipY,dn.unpackAlignment=Pr.unpackAlignment,dn.colorSpace=Pr.colorSpace,dn.width=Pr.width,dn.height=Pr.height,dn.channels=Pr.channels}function Go(dn,Pr){if(!(typeof Pr!="object"||!Pr)){if("premultiplyAlpha"in Pr&&(ce.type(Pr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),dn.premultiplyAlpha=Pr.premultiplyAlpha),"flipY"in Pr&&(ce.type(Pr.flipY,"boolean","invalid texture flip"),dn.flipY=Pr.flipY),"alignment"in Pr&&(ce.oneOf(Pr.alignment,[1,2,4,8],"invalid texture unpack alignment"),dn.unpackAlignment=Pr.alignment),"colorSpace"in Pr&&(ce.parameter(Pr.colorSpace,Ni,"invalid colorSpace"),dn.colorSpace=Ni[Pr.colorSpace]),"type"in Pr){var pr=Pr.type;ce(Qt.oes_texture_float||!(pr==="float"||pr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),ce(Qt.oes_texture_half_float||!(pr==="half float"||pr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ce(Qt.webgl_depth_texture||!(pr==="uint16"||pr==="uint32"||pr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ce.parameter(pr,Yi,"invalid texture type"),dn.type=Yi[pr]}var lo=dn.width,Fa=dn.height,as=dn.channels,It=!1;"shape"in Pr?(ce(Array.isArray(Pr.shape)&&Pr.shape.length>=2,"shape must be an array"),lo=Pr.shape[0],Fa=Pr.shape[1],Pr.shape.length===3&&(as=Pr.shape[2],ce(as>0&&as<=4,"invalid number of channels"),It=!0),ce(lo>=0&&lo<=Mn.maxTextureSize,"invalid width"),ce(Fa>=0&&Fa<=Mn.maxTextureSize,"invalid height")):("radius"in Pr&&(lo=Fa=Pr.radius,ce(lo>=0&&lo<=Mn.maxTextureSize,"invalid radius")),"width"in Pr&&(lo=Pr.width,ce(lo>=0&&lo<=Mn.maxTextureSize,"invalid width")),"height"in Pr&&(Fa=Pr.height,ce(Fa>=0&&Fa<=Mn.maxTextureSize,"invalid height")),"channels"in Pr&&(as=Pr.channels,ce(as>0&&as<=4,"invalid number of channels"),It=!0)),dn.width=lo|0,dn.height=Fa|0,dn.channels=as|0;var rn=!1;if("format"in Pr){var In=Pr.format;ce(Qt.webgl_depth_texture||!(In==="depth"||In==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ce.parameter(In,pi,"invalid texture format");var wr=dn.internalformat=pi[In];dn.format=to[wr],In in Yi&&("type"in Pr||(dn.type=Yi[In])),In in Fi&&(dn.compressed=!0),rn=!0}!It&&rn?dn.channels=za[dn.format]:It&&!rn?dn.channels!==bs[dn.format]&&(dn.format=dn.internalformat=bs[dn.channels]):rn&&It&&ce(dn.channels===za[dn.format],"number of channels inconsistent with specified format")}}function fa(dn){Ue.pixelStorei(ir,dn.flipY),Ue.pixelStorei(Ur,dn.premultiplyAlpha),Ue.pixelStorei(mi,dn.colorSpace),Ue.pixelStorei(gn,dn.unpackAlignment)}function $i(){si.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function _i(dn,Pr){var pr=null;if(Gc(Pr)?pr=Pr:Pr&&(ce.type(Pr,"object","invalid pixel data type"),Go(dn,Pr),"x"in Pr&&(dn.xOffset=Pr.x|0),"y"in Pr&&(dn.yOffset=Pr.y|0),Gc(Pr.data)&&(pr=Pr.data)),ce(!dn.compressed||pr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Pr.copy){ce(!pr,"can not specify copy and data field for the same texture");var lo=$r.viewportWidth,Fa=$r.viewportHeight;dn.width=dn.width||lo-dn.xOffset,dn.height=dn.height||Fa-dn.yOffset,dn.needsCopy=!0,ce(dn.xOffset>=0&&dn.xOffset<lo&&dn.yOffset>=0&&dn.yOffset<Fa&&dn.width>0&&dn.width<=lo&&dn.height>0&&dn.height<=Fa,"copy texture read out of bounds")}else if(!pr)dn.width=dn.width||1,dn.height=dn.height||1,dn.channels=dn.channels||4;else if(W(pr))dn.channels=dn.channels||4,dn.data=pr,!("type"in Pr)&&dn.type===tf&&(dn.type=th(pr));else if(r0(pr))dn.channels=dn.channels||4,i0(dn,pr),dn.alignment=1,dn.needsFree=!0;else if(Jo(pr)){var as=pr.data;!Array.isArray(as)&&dn.type===tf&&(dn.type=th(as));var It=pr.shape,rn=pr.stride,In,wr,br,Vn,Kn,nr;It.length===3?(br=It[2],nr=rn[2]):(ce(It.length===2,"invalid ndarray pixel data, must be 2 or 3D"),br=1,nr=1),In=It[0],wr=It[1],Vn=rn[0],Kn=rn[1],dn.alignment=1,dn.width=In,dn.height=wr,dn.channels=br,dn.format=dn.internalformat=bs[br],dn.needsFree=!0,z0(dn,as,Vn,Kn,nr,pr.offset)}else if(Eu(pr)||Ep(pr)||rf(pr))Eu(pr)||Ep(pr)?dn.element=pr:dn.element=pr.canvas,dn.width=dn.element.width,dn.height=dn.element.height,dn.channels=4;else if(of(pr))dn.element=pr,dn.width=pr.width,dn.height=pr.height,dn.channels=4;else if(eh(pr))dn.element=pr,dn.width=pr.naturalWidth,dn.height=pr.naturalHeight,dn.channels=4;else if(Sp(pr))dn.element=pr,dn.width=pr.videoWidth,dn.height=pr.videoHeight,dn.channels=4;else if(Xi(pr)){var bn=dn.width||pr[0].length,Zn=dn.height||pr.length,nn=dn.channels;rl(pr[0][0])?nn=nn||pr[0][0].length:nn=nn||1;for(var Xn=Ha.shape(pr),Sr=1,zr=0;zr<Xn.length;++zr)Sr*=Xn[zr];var di=Sd(dn,Sr);Ha.flatten(pr,Xn,"",di),k0(dn,di),dn.alignment=1,dn.width=bn,dn.height=Zn,dn.channels=nn,dn.format=dn.internalformat=bs[nn],dn.needsFree=!0}dn.type===Fu?ce(Mn.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):dn.type===Da&&ce(Mn.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function qr(dn,Pr,pr){var lo=dn.element,Fa=dn.data,as=dn.internalformat,It=dn.format,rn=dn.type,In=dn.width,wr=dn.height;fa(dn),lo?Ue.texImage2D(Pr,pr,It,It,rn,lo):dn.compressed?Ue.compressedTexImage2D(Pr,pr,as,In,wr,0,Fa):dn.needsCopy?(Ar(),Ue.copyTexImage2D(Pr,pr,It,dn.xOffset,dn.yOffset,In,wr,0)):Ue.texImage2D(Pr,pr,It,In,wr,0,It,rn,Fa||null)}function Zo(dn,Pr,pr,lo,Fa){var as=dn.element,It=dn.data,rn=dn.internalformat,In=dn.format,wr=dn.type,br=dn.width,Vn=dn.height;fa(dn),as?Ue.texSubImage2D(Pr,Fa,pr,lo,In,wr,as):dn.compressed?Ue.compressedTexSubImage2D(Pr,Fa,pr,lo,rn,br,Vn,It):dn.needsCopy?(Ar(),Ue.copyTexSubImage2D(Pr,Fa,pr,lo,dn.xOffset,dn.yOffset,br,Vn)):Ue.texSubImage2D(Pr,Fa,pr,lo,br,Vn,In,wr,It)}var Ua=[];function oo(){return Ua.pop()||new $i}function Pa(dn){dn.needsFree&&Er.freeType(dn.data),$i.call(dn),Ua.push(dn)}function da(){si.call(this),this.genMipmaps=!1,this.mipmapHint=Gl,this.mipmask=0,this.images=Array(16)}function oa(dn,Pr,pr){var lo=dn.images[0]=oo();dn.mipmask=1,lo.width=dn.width=Pr,lo.height=dn.height=pr,lo.channels=dn.channels=4}function gs(dn,Pr){var pr=null;if(Gc(Pr))pr=dn.images[0]=oo(),qi(pr,dn),_i(pr,Pr),dn.mipmask=1;else if(Go(dn,Pr),Array.isArray(Pr.mipmap))for(var lo=Pr.mipmap,Fa=0;Fa<lo.length;++Fa)pr=dn.images[Fa]=oo(),qi(pr,dn),pr.width>>=Fa,pr.height>>=Fa,_i(pr,lo[Fa]),dn.mipmask|=1<<Fa;else pr=dn.images[0]=oo(),qi(pr,dn),_i(pr,Pr),dn.mipmask=1;qi(dn,dn.images[0]),dn.compressed&&(dn.internalformat===Xa||dn.internalformat===Ls||dn.internalformat===Qa||dn.internalformat===Ec)&&ce(dn.width%4===0&&dn.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function jl(dn,Pr){for(var pr=dn.images,lo=0;lo<pr.length;++lo){if(!pr[lo])return;qr(pr[lo],Pr,lo)}}var eu=[];function ja(){var dn=eu.pop()||new da;si.call(dn),dn.mipmask=0;for(var Pr=0;Pr<16;++Pr)dn.images[Pr]=null;return dn}function Xl(dn){for(var Pr=dn.images,pr=0;pr<Pr.length;++pr)Pr[pr]&&Pa(Pr[pr]),Pr[pr]=null;eu.push(dn)}function Js(){this.minFilter=Eh,this.magFilter=Eh,this.wrapS=Ed,this.wrapT=Ed,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Gl}function vl(dn,Pr){if("min"in Pr){var pr=Pr.min;ce.parameter(pr,wi),dn.minFilter=wi[pr],ba.indexOf(dn.minFilter)>=0&&!("faces"in Pr)&&(dn.genMipmaps=!0)}if("mag"in Pr){var lo=Pr.mag;ce.parameter(lo,Li),dn.magFilter=Li[lo]}var Fa=dn.wrapS,as=dn.wrapT;if("wrap"in Pr){var It=Pr.wrap;typeof It=="string"?(ce.parameter(It,fi),Fa=as=fi[It]):Array.isArray(It)&&(ce.parameter(It[0],fi),ce.parameter(It[1],fi),Fa=fi[It[0]],as=fi[It[1]])}else{if("wrapS"in Pr){var rn=Pr.wrapS;ce.parameter(rn,fi),Fa=fi[rn]}if("wrapT"in Pr){var In=Pr.wrapT;ce.parameter(In,fi),as=fi[In]}}if(dn.wrapS=Fa,dn.wrapT=as,"anisotropic"in Pr){var wr=Pr.anisotropic;ce(typeof wr=="number"&&wr>=1&&wr<=Mn.maxAnisotropic,"aniso samples must be between 1 and "),dn.anisotropic=Pr.anisotropic}if("mipmap"in Pr){var br=!1;switch(typeof Pr.mipmap){case"string":ce.parameter(Pr.mipmap,Ai,"invalid mipmap hint"),dn.mipmapHint=Ai[Pr.mipmap],dn.genMipmaps=!0,br=!0;break;case"boolean":br=dn.genMipmaps=Pr.mipmap;break;case"object":ce(Array.isArray(Pr.mipmap),"invalid mipmap type"),dn.genMipmaps=!1,br=!0;break;default:ce.raise("invalid mipmap type")}br&&!("min"in Pr)&&(dn.minFilter=xu)}}function Yl(dn,Pr){Ue.texParameteri(Pr,Zd,dn.minFilter),Ue.texParameteri(Pr,Xh,dn.magFilter),Ue.texParameteri(Pr,n0,dn.wrapS),Ue.texParameteri(Pr,Jf,dn.wrapT),Qt.ext_texture_filter_anisotropic&&Ue.texParameteri(Pr,ct,dn.anisotropic),dn.genMipmaps&&(Ue.hint(Wd,dn.mipmapHint),Ue.generateMipmap(Pr))}var ps=0,$l={},Kl=Mn.maxTextureUnits,dc=Array(Kl).map(function(){return null});function Ca(dn){si.call(this),this.mipmask=0,this.internalformat=mn,this.id=ps++,this.refCount=1,this.target=dn,this.texture=Ue.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Js,yr.profile&&(this.stats={size:0})}function Uc(dn){Ue.activeTexture(ma),Ue.bindTexture(dn.target,dn.texture)}function Ms(){var dn=dc[0];dn?Ue.bindTexture(dn.target,dn.texture):Ue.bindTexture(ne,null)}function Yo(dn){var Pr=dn.texture;ce(Pr,"must not double destroy texture");var pr=dn.unit,lo=dn.target;pr>=0&&(Ue.activeTexture(ma+pr),Ue.bindTexture(lo,null),dc[pr]=null),Ue.deleteTexture(Pr),dn.texture=null,dn.params=null,dn.pixels=null,dn.refCount=0,delete $l[dn.id],Or.textureCount--}D(Ca.prototype,{bind:function(){var dn=this;dn.bindCount+=1;var Pr=dn.unit;if(Pr<0){for(var pr=0;pr<Kl;++pr){var lo=dc[pr];if(lo){if(lo.bindCount>0)continue;lo.unit=-1}dc[pr]=dn,Pr=pr;break}Pr>=Kl&&ce.raise("insufficient number of texture units"),yr.profile&&Or.maxTextureUnits<Pr+1&&(Or.maxTextureUnits=Pr+1),dn.unit=Pr,Ue.activeTexture(ma+Pr),Ue.bindTexture(dn.target,dn.texture)}return Pr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Yo(this)}});function Ia(dn,Pr){var pr=new Ca(ne);$l[pr.id]=pr,Or.textureCount++;function lo(It,rn){var In=pr.texInfo;Js.call(In);var wr=ja();return typeof It=="number"?typeof rn=="number"?oa(wr,It|0,rn|0):oa(wr,It|0,It|0):It?(ce.type(It,"object","invalid arguments to regl.texture"),vl(In,It),gs(wr,It)):oa(wr,1,1),In.genMipmaps&&(wr.mipmask=(wr.width<<1)-1),pr.mipmask=wr.mipmask,qi(pr,wr),ce.texture2D(In,wr,Mn),pr.internalformat=wr.internalformat,lo.width=wr.width,lo.height=wr.height,Uc(pr),jl(wr,ne),Yl(In,ne),Ms(),Xl(wr),yr.profile&&(pr.stats.size=su(pr.internalformat,pr.type,wr.width,wr.height,In.genMipmaps,!1)),lo.format=Ci[pr.internalformat],lo.type=Hi[pr.type],lo.mag=ei[In.magFilter],lo.min=ro[In.minFilter],lo.wrapS=yi[In.wrapS],lo.wrapT=yi[In.wrapT],lo}function Fa(It,rn,In,wr){ce(!!It,"must specify image data");var br=rn|0,Vn=In|0,Kn=wr|0,nr=oo();return qi(nr,pr),nr.width=0,nr.height=0,_i(nr,It),nr.width=nr.width||(pr.width>>Kn)-br,nr.height=nr.height||(pr.height>>Kn)-Vn,ce(pr.type===nr.type&&pr.format===nr.format&&pr.internalformat===nr.internalformat,"incompatible format for texture.subimage"),ce(br>=0&&Vn>=0&&br+nr.width<=pr.width&&Vn+nr.height<=pr.height,"texture.subimage write out of bounds"),ce(pr.mipmask&1<<Kn,"missing mipmap data"),ce(nr.data||nr.element||nr.needsCopy,"missing image data"),Uc(pr),Zo(nr,ne,br,Vn,Kn),Ms(),Pa(nr),lo}function as(It,rn){var In=It|0,wr=rn|0||In;if(In===pr.width&&wr===pr.height)return lo;lo.width=pr.width=In,lo.height=pr.height=wr,Uc(pr);for(var br=0;pr.mipmask>>br;++br){var Vn=In>>br,Kn=wr>>br;if(!Vn||!Kn)break;Ue.texImage2D(ne,br,pr.format,Vn,Kn,0,pr.format,pr.type,null)}return Ms(),yr.profile&&(pr.stats.size=su(pr.internalformat,pr.type,In,wr,!1,!1)),lo}return lo(dn,Pr),lo.subimage=Fa,lo.resize=as,lo._reglType="texture2d",lo._texture=pr,yr.profile&&(lo.stats=pr.stats),lo.destroy=function(){pr.decRef()},lo}function us(dn,Pr,pr,lo,Fa,as){var It=new Ca(ge);$l[It.id]=It,Or.cubeCount++;var rn=new Array(6);function In(Vn,Kn,nr,bn,Zn,nn){var Xn,Sr=It.texInfo;for(Js.call(Sr),Xn=0;Xn<6;++Xn)rn[Xn]=ja();if(typeof Vn=="number"||!Vn){var zr=Vn|0||1;for(Xn=0;Xn<6;++Xn)oa(rn[Xn],zr,zr)}else if(typeof Vn=="object")if(Kn)gs(rn[0],Vn),gs(rn[1],Kn),gs(rn[2],nr),gs(rn[3],bn),gs(rn[4],Zn),gs(rn[5],nn);else if(vl(Sr,Vn),Go(It,Vn),"faces"in Vn){var di=Vn.faces;for(ce(Array.isArray(di)&&di.length===6,"cube faces must be a length 6 array"),Xn=0;Xn<6;++Xn)ce(typeof di[Xn]=="object"&&!!di[Xn],"invalid input for cube map face"),qi(rn[Xn],It),gs(rn[Xn],di[Xn])}else for(Xn=0;Xn<6;++Xn)gs(rn[Xn],Vn);else ce.raise("invalid arguments to cube map");for(qi(It,rn[0]),Mn.npotTextureCube||ce(Bf(It.width)&&Bf(It.height),"your browser does not support non power or two texture dimensions"),Sr.genMipmaps?It.mipmask=(rn[0].width<<1)-1:It.mipmask=rn[0].mipmask,ce.textureCube(It,Sr,rn,Mn),It.internalformat=rn[0].internalformat,In.width=rn[0].width,In.height=rn[0].height,Uc(It),Xn=0;Xn<6;++Xn)jl(rn[Xn],qe+Xn);for(Yl(Sr,ge),Ms(),yr.profile&&(It.stats.size=su(It.internalformat,It.type,In.width,In.height,Sr.genMipmaps,!0)),In.format=Ci[It.internalformat],In.type=Hi[It.type],In.mag=ei[Sr.magFilter],In.min=ro[Sr.minFilter],In.wrapS=yi[Sr.wrapS],In.wrapT=yi[Sr.wrapT],Xn=0;Xn<6;++Xn)Xl(rn[Xn]);return In}function wr(Vn,Kn,nr,bn,Zn){ce(!!Kn,"must specify image data"),ce(typeof Vn=="number"&&Vn===(Vn|0)&&Vn>=0&&Vn<6,"invalid face");var nn=nr|0,Xn=bn|0,Sr=Zn|0,zr=oo();return qi(zr,It),zr.width=0,zr.height=0,_i(zr,Kn),zr.width=zr.width||(It.width>>Sr)-nn,zr.height=zr.height||(It.height>>Sr)-Xn,ce(It.type===zr.type&&It.format===zr.format&&It.internalformat===zr.internalformat,"incompatible format for texture.subimage"),ce(nn>=0&&Xn>=0&&nn+zr.width<=It.width&&Xn+zr.height<=It.height,"texture.subimage write out of bounds"),ce(It.mipmask&1<<Sr,"missing mipmap data"),ce(zr.data||zr.element||zr.needsCopy,"missing image data"),Uc(It),Zo(zr,qe+Vn,nn,Xn,Sr),Ms(),Pa(zr),In}function br(Vn){var Kn=Vn|0;if(Kn!==It.width){In.width=It.width=Kn,In.height=It.height=Kn,Uc(It);for(var nr=0;nr<6;++nr)for(var bn=0;It.mipmask>>bn;++bn)Ue.texImage2D(qe+nr,bn,It.format,Kn>>bn,Kn>>bn,0,It.format,It.type,null);return Ms(),yr.profile&&(It.stats.size=su(It.internalformat,It.type,In.width,In.height,!1,!0)),In}}return In(dn,Pr,pr,lo,Fa,as),In.subimage=wr,In.resize=br,In._reglType="textureCube",In._texture=It,yr.profile&&(In.stats=It.stats),In.destroy=function(){It.decRef()},In}function Dl(){for(var dn=0;dn<Kl;++dn)Ue.activeTexture(ma+dn),Ue.bindTexture(ne,null),dc[dn]=null;Wo($l).forEach(Yo),Or.cubeCount=0,Or.textureCount=0}yr.profile&&(Or.getTotalTextureSize=function(){var dn=0;return Object.keys($l).forEach(function(Pr){dn+=$l[Pr].stats.size}),dn});function hu(){for(var dn=0;dn<Kl;++dn){var Pr=dc[dn];Pr&&(Pr.bindCount=0,Pr.unit=-1,dc[dn]=null)}Wo($l).forEach(function(pr){pr.texture=Ue.createTexture(),Ue.bindTexture(pr.target,pr.texture);for(var lo=0;lo<32;++lo)if(pr.mipmask&1<<lo)if(pr.target===ne)Ue.texImage2D(ne,lo,pr.internalformat,pr.width>>lo,pr.height>>lo,0,pr.internalformat,pr.type,null);else for(var Fa=0;Fa<6;++Fa)Ue.texImage2D(qe+Fa,lo,pr.internalformat,pr.width>>lo,pr.height>>lo,0,pr.internalformat,pr.type,null);Yl(pr.texInfo,pr.target)})}return{create2D:Ia,createCube:us,clear:Dl,getTexture:function(dn){return null},restore:hu}}var Ta=36161,ku=32854,zu=32855,cc=36194,Th=33189,Ul=36168,Fc=34041,Xc=35907,Tp=34836,jo=34842,Eo=34843,kc=[];kc[ku]=2,kc[zu]=2,kc[cc]=2,kc[Th]=2,kc[Ul]=1,kc[Fc]=4,kc[Xc]=4,kc[Tp]=16,kc[jo]=8,kc[Eo]=6;function lu(Ue,Qt,Mn){return kc[Ue]*Qt*Mn}var nh=function(Ue,Qt,Mn,Ar,$r){var Or={rgba4:ku,rgb565:cc,"rgb5 a1":zu,depth:Th,stencil:Ul,"depth stencil":Fc};Qt.ext_srgb&&(Or.srgba=Xc),Qt.ext_color_buffer_half_float&&(Or.rgba16f=jo,Or.rgb16f=Eo),Qt.webgl_color_buffer_float&&(Or.rgba32f=Tp);var yr=[];Object.keys(Or).forEach(function(pi){var Fi=Or[pi];yr[Fi]=pi});var Ai=0,fi={};function Li(pi){this.id=Ai++,this.refCount=1,this.renderbuffer=pi,this.format=ku,this.width=0,this.height=0,$r.profile&&(this.stats={size:0})}Li.prototype.decRef=function(){--this.refCount<=0&&wi(this)};function wi(pi){var Fi=pi.renderbuffer;ce(Fi,"must not double destroy renderbuffer"),Ue.bindRenderbuffer(Ta,null),Ue.deleteRenderbuffer(Fi),pi.renderbuffer=null,pi.refCount=0,delete fi[pi.id],Ar.renderbufferCount--}function Ni(pi,Fi){var ur=new Li(Ue.createRenderbuffer());fi[ur.id]=ur,Ar.renderbufferCount++;function Nr(Hi,ei){var ro=0,yi=0,to=ku;if(typeof Hi=="object"&&Hi){var si=Hi;if("shape"in si){var qi=si.shape;ce(Array.isArray(qi)&&qi.length>=2,"invalid renderbuffer shape"),ro=qi[0]|0,yi=qi[1]|0}else"radius"in si&&(ro=yi=si.radius|0),"width"in si&&(ro=si.width|0),"height"in si&&(yi=si.height|0);"format"in si&&(ce.parameter(si.format,Or,"invalid renderbuffer format"),to=Or[si.format])}else typeof Hi=="number"?(ro=Hi|0,typeof ei=="number"?yi=ei|0:yi=ro):Hi?ce.raise("invalid arguments to renderbuffer constructor"):ro=yi=1;if(ce(ro>0&&yi>0&&ro<=Mn.maxRenderbufferSize&&yi<=Mn.maxRenderbufferSize,"invalid renderbuffer size"),!(ro===ur.width&&yi===ur.height&&to===ur.format))return Nr.width=ur.width=ro,Nr.height=ur.height=yi,ur.format=to,Ue.bindRenderbuffer(Ta,ur.renderbuffer),Ue.renderbufferStorage(Ta,to,ro,yi),ce(Ue.getError()===0,"invalid render buffer format"),$r.profile&&(ur.stats.size=lu(ur.format,ur.width,ur.height)),Nr.format=yr[ur.format],Nr}function Ci(Hi,ei){var ro=Hi|0,yi=ei|0||ro;return ro===ur.width&&yi===ur.height||(ce(ro>0&&yi>0&&ro<=Mn.maxRenderbufferSize&&yi<=Mn.maxRenderbufferSize,"invalid renderbuffer size"),Nr.width=ur.width=ro,Nr.height=ur.height=yi,Ue.bindRenderbuffer(Ta,ur.renderbuffer),Ue.renderbufferStorage(Ta,ur.format,ro,yi),ce(Ue.getError()===0,"invalid render buffer format"),$r.profile&&(ur.stats.size=lu(ur.format,ur.width,ur.height))),Nr}return Nr(pi,Fi),Nr.resize=Ci,Nr._reglType="renderbuffer",Nr._renderbuffer=ur,$r.profile&&(Nr.stats=ur.stats),Nr.destroy=function(){ur.decRef()},Nr}$r.profile&&(Ar.getTotalRenderbufferSize=function(){var pi=0;return Object.keys(fi).forEach(function(Fi){pi+=fi[Fi].stats.size}),pi});function Yi(){Wo(fi).forEach(function(pi){pi.renderbuffer=Ue.createRenderbuffer(),Ue.bindRenderbuffer(Ta,pi.renderbuffer),Ue.renderbufferStorage(Ta,pi.format,pi.width,pi.height)}),Ue.bindRenderbuffer(Ta,null)}return{create:Ni,clear:function(){Wo(fi).forEach(wi)},restore:Yi}},dl=36160,bf=36161,wh=3553,kf=34069,xs=36064,uc=36096,Xd=36128,Kh=33306,U0=36053,Ah=36054,Su=36055,Yd=36057,zf=36061,wp=36193,Yr=5121,Uf=5126,jf=6407,qh=6408,xf=6402,Ap=[jf,qh],sf=[];sf[qh]=4,sf[jf]=3;var Ef=[];Ef[Yr]=1,Ef[Uf]=4,Ef[wp]=2;var o0=32854,rh=32855,Yc=36194,$c=33189,Ds=36168,Tu=34041,j0=35907,_=34836,S=34842,x=34843,C=[o0,rh,Yc,j0,S,x,_],k={};k[U0]="complete",k[Ah]="incomplete attachment",k[Yd]="incomplete dimensions",k[Su]="incomplete, missing attachment",k[zf]="unsupported";function G(Ue,Qt,Mn,Ar,$r,Or){var yr={cur:null,next:null,dirty:!1,setFBO:null},Ai=["rgba"],fi=["rgba4","rgb565","rgb5 a1"];Qt.ext_srgb&&fi.push("srgba"),Qt.ext_color_buffer_half_float&&fi.push("rgba16f","rgb16f"),Qt.webgl_color_buffer_float&&fi.push("rgba32f");var Li=["uint8"];Qt.oes_texture_half_float&&Li.push("half float","float16"),Qt.oes_texture_float&&Li.push("float","float32");function wi($i,_i,qr){this.target=$i,this.texture=_i,this.renderbuffer=qr;var Zo=0,Ua=0;_i?(Zo=_i.width,Ua=_i.height):qr&&(Zo=qr.width,Ua=qr.height),this.width=Zo,this.height=Ua}function Ni($i){$i&&($i.texture&&$i.texture._texture.decRef(),$i.renderbuffer&&$i.renderbuffer._renderbuffer.decRef())}function Yi($i,_i,qr){if($i)if($i.texture){var Zo=$i.texture._texture,Ua=Math.max(1,Zo.width),oo=Math.max(1,Zo.height);ce(Ua===_i&&oo===qr,"inconsistent width/height for supplied texture"),Zo.refCount+=1}else{var Pa=$i.renderbuffer._renderbuffer;ce(Pa.width===_i&&Pa.height===qr,"inconsistent width/height for renderbuffer"),Pa.refCount+=1}}function pi($i,_i){_i&&(_i.texture?Ue.framebufferTexture2D(dl,$i,_i.target,_i.texture._texture.texture,0):Ue.framebufferRenderbuffer(dl,$i,bf,_i.renderbuffer._renderbuffer.renderbuffer))}function Fi($i){var _i=wh,qr=null,Zo=null,Ua=$i;typeof $i=="object"&&(Ua=$i.data,"target"in $i&&(_i=$i.target|0)),ce.type(Ua,"function","invalid attachment data");var oo=Ua._reglType;return oo==="texture2d"?(qr=Ua,ce(_i===wh)):oo==="textureCube"?(qr=Ua,ce(_i>=kf&&_i<kf+6,"invalid cube map target")):oo==="renderbuffer"?(Zo=Ua,_i=bf):ce.raise("invalid regl object for attachment"),new wi(_i,qr,Zo)}function ur($i,_i,qr,Zo,Ua){if(qr){var oo=Ar.create2D({width:$i,height:_i,format:Zo,type:Ua});return oo._texture.refCount=0,new wi(wh,oo,null)}else{var Pa=$r.create({width:$i,height:_i,format:Zo});return Pa._renderbuffer.refCount=0,new wi(bf,null,Pa)}}function Nr($i){return $i&&($i.texture||$i.renderbuffer)}function Ci($i,_i,qr){$i&&($i.texture?$i.texture.resize(_i,qr):$i.renderbuffer&&$i.renderbuffer.resize(_i,qr),$i.width=_i,$i.height=qr)}var Hi=0,ei={};function ro(){this.id=Hi++,ei[this.id]=this,this.framebuffer=Ue.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function yi($i){$i.colorAttachments.forEach(Ni),Ni($i.depthAttachment),Ni($i.stencilAttachment),Ni($i.depthStencilAttachment)}function to($i){var _i=$i.framebuffer;ce(_i,"must not double destroy framebuffer"),Ue.deleteFramebuffer(_i),$i.framebuffer=null,Or.framebufferCount--,delete ei[$i.id]}function si($i){var _i;Ue.bindFramebuffer(dl,$i.framebuffer);var qr=$i.colorAttachments;for(_i=0;_i<qr.length;++_i)pi(xs+_i,qr[_i]);for(_i=qr.length;_i<Mn.maxColorAttachments;++_i)Ue.framebufferTexture2D(dl,xs+_i,wh,null,0);Ue.framebufferTexture2D(dl,Kh,wh,null,0),Ue.framebufferTexture2D(dl,uc,wh,null,0),Ue.framebufferTexture2D(dl,Xd,wh,null,0),pi(uc,$i.depthAttachment),pi(Xd,$i.stencilAttachment),pi(Kh,$i.depthStencilAttachment);var Zo=Ue.checkFramebufferStatus(dl);!Ue.isContextLost()&&Zo!==U0&&ce.raise("framebuffer configuration not supported, status = "+k[Zo]),Ue.bindFramebuffer(dl,yr.next?yr.next.framebuffer:null),yr.cur=yr.next,Ue.getError()}function qi($i,_i){var qr=new ro;Or.framebufferCount++;function Zo(oo,Pa){var da;ce(yr.next!==qr,"can not update framebuffer which is currently in use");var oa=0,gs=0,jl=!0,eu=!0,ja=null,Xl=!0,Js="rgba",vl="uint8",Yl=1,ps=null,$l=null,Kl=null,dc=!1;if(typeof oo=="number")oa=oo|0,gs=Pa|0||oa;else if(!oo)oa=gs=1;else{ce.type(oo,"object","invalid arguments for framebuffer");var Ca=oo;if("shape"in Ca){var Uc=Ca.shape;ce(Array.isArray(Uc)&&Uc.length>=2,"invalid shape for framebuffer"),oa=Uc[0],gs=Uc[1]}else"radius"in Ca&&(oa=gs=Ca.radius),"width"in Ca&&(oa=Ca.width),"height"in Ca&&(gs=Ca.height);("color"in Ca||"colors"in Ca)&&(ja=Ca.color||Ca.colors,Array.isArray(ja)&&ce(ja.length===1||Qt.webgl_draw_buffers,"multiple render targets not supported")),ja||("colorCount"in Ca&&(Yl=Ca.colorCount|0,ce(Yl>0,"invalid color buffer count")),"colorTexture"in Ca&&(Xl=!!Ca.colorTexture,Js="rgba4"),"colorType"in Ca&&(vl=Ca.colorType,Xl?(ce(Qt.oes_texture_float||!(vl==="float"||vl==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ce(Qt.oes_texture_half_float||!(vl==="half float"||vl==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vl==="half float"||vl==="float16"?(ce(Qt.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Js="rgba16f"):(vl==="float"||vl==="float32")&&(ce(Qt.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Js="rgba32f"),ce.oneOf(vl,Li,"invalid color type")),"colorFormat"in Ca&&(Js=Ca.colorFormat,Ai.indexOf(Js)>=0?Xl=!0:fi.indexOf(Js)>=0?Xl=!1:Xl?ce.oneOf(Ca.colorFormat,Ai,"invalid color format for texture"):ce.oneOf(Ca.colorFormat,fi,"invalid color format for renderbuffer"))),("depthTexture"in Ca||"depthStencilTexture"in Ca)&&(dc=!!(Ca.depthTexture||Ca.depthStencilTexture),ce(!dc||Qt.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ca&&(typeof Ca.depth=="boolean"?jl=Ca.depth:(ps=Ca.depth,eu=!1)),"stencil"in Ca&&(typeof Ca.stencil=="boolean"?eu=Ca.stencil:($l=Ca.stencil,jl=!1)),"depthStencil"in Ca&&(typeof Ca.depthStencil=="boolean"?jl=eu=Ca.depthStencil:(Kl=Ca.depthStencil,jl=!1,eu=!1))}var Ms=null,Yo=null,Ia=null,us=null;if(Array.isArray(ja))Ms=ja.map(Fi);else if(ja)Ms=[Fi(ja)];else for(Ms=new Array(Yl),da=0;da<Yl;++da)Ms[da]=ur(oa,gs,Xl,Js,vl);ce(Qt.webgl_draw_buffers||Ms.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ce(Ms.length<=Mn.maxColorAttachments,"too many color attachments, not supported"),oa=oa||Ms[0].width,gs=gs||Ms[0].height,ps?Yo=Fi(ps):jl&&!eu&&(Yo=ur(oa,gs,dc,"depth","uint32")),$l?Ia=Fi($l):eu&&!jl&&(Ia=ur(oa,gs,!1,"stencil","uint8")),Kl?us=Fi(Kl):!ps&&!$l&&eu&&jl&&(us=ur(oa,gs,dc,"depth stencil","depth stencil")),ce(!!ps+!!$l+!!Kl<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Dl=null;for(da=0;da<Ms.length;++da)if(Yi(Ms[da],oa,gs),ce(!Ms[da]||Ms[da].texture&&Ap.indexOf(Ms[da].texture._texture.format)>=0||Ms[da].renderbuffer&&C.indexOf(Ms[da].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+da+" is invalid"),Ms[da]&&Ms[da].texture){var hu=sf[Ms[da].texture._texture.format]*Ef[Ms[da].texture._texture.type];Dl===null?Dl=hu:ce(Dl===hu,"all color attachments much have the same number of bits per pixel.")}return Yi(Yo,oa,gs),ce(!Yo||Yo.texture&&Yo.texture._texture.format===xf||Yo.renderbuffer&&Yo.renderbuffer._renderbuffer.format===$c,"invalid depth attachment for framebuffer object"),Yi(Ia,oa,gs),ce(!Ia||Ia.renderbuffer&&Ia.renderbuffer._renderbuffer.format===Ds,"invalid stencil attachment for framebuffer object"),Yi(us,oa,gs),ce(!us||us.texture&&us.texture._texture.format===Tu||us.renderbuffer&&us.renderbuffer._renderbuffer.format===Tu,"invalid depth-stencil attachment for framebuffer object"),yi(qr),qr.width=oa,qr.height=gs,qr.colorAttachments=Ms,qr.depthAttachment=Yo,qr.stencilAttachment=Ia,qr.depthStencilAttachment=us,Zo.color=Ms.map(Nr),Zo.depth=Nr(Yo),Zo.stencil=Nr(Ia),Zo.depthStencil=Nr(us),Zo.width=qr.width,Zo.height=qr.height,si(qr),Zo}function Ua(oo,Pa){ce(yr.next!==qr,"can not resize a framebuffer which is currently in use");var da=Math.max(oo|0,1),oa=Math.max(Pa|0||da,1);if(da===qr.width&&oa===qr.height)return Zo;for(var gs=qr.colorAttachments,jl=0;jl<gs.length;++jl)Ci(gs[jl],da,oa);return Ci(qr.depthAttachment,da,oa),Ci(qr.stencilAttachment,da,oa),Ci(qr.depthStencilAttachment,da,oa),qr.width=Zo.width=da,qr.height=Zo.height=oa,si(qr),Zo}return Zo($i,_i),D(Zo,{resize:Ua,_reglType:"framebuffer",_framebuffer:qr,destroy:function(){to(qr),yi(qr)},use:function(oo){yr.setFBO({framebuffer:Zo},oo)}})}function Go($i){var _i=Array(6);function qr(Ua){var oo;ce(_i.indexOf(yr.next)<0,"can not update framebuffer which is currently in use");var Pa={color:null},da=0,oa=null,gs="rgba",jl="uint8",eu=1;if(typeof Ua=="number")da=Ua|0;else if(!Ua)da=1;else{ce.type(Ua,"object","invalid arguments for framebuffer");var ja=Ua;if("shape"in ja){var Xl=ja.shape;ce(Array.isArray(Xl)&&Xl.length>=2,"invalid shape for framebuffer"),ce(Xl[0]===Xl[1],"cube framebuffer must be square"),da=Xl[0]}else"radius"in ja&&(da=ja.radius|0),"width"in ja?(da=ja.width|0,"height"in ja&&ce(ja.height===da,"must be square")):"height"in ja&&(da=ja.height|0);("color"in ja||"colors"in ja)&&(oa=ja.color||ja.colors,Array.isArray(oa)&&ce(oa.length===1||Qt.webgl_draw_buffers,"multiple render targets not supported")),oa||("colorCount"in ja&&(eu=ja.colorCount|0,ce(eu>0,"invalid color buffer count")),"colorType"in ja&&(ce.oneOf(ja.colorType,Li,"invalid color type"),jl=ja.colorType),"colorFormat"in ja&&(gs=ja.colorFormat,ce.oneOf(ja.colorFormat,Ai,"invalid color format for texture"))),"depth"in ja&&(Pa.depth=ja.depth),"stencil"in ja&&(Pa.stencil=ja.stencil),"depthStencil"in ja&&(Pa.depthStencil=ja.depthStencil)}var Js;if(oa)if(Array.isArray(oa))for(Js=[],oo=0;oo<oa.length;++oo)Js[oo]=oa[oo];else Js=[oa];else{Js=Array(eu);var vl={radius:da,format:gs,type:jl};for(oo=0;oo<eu;++oo)Js[oo]=Ar.createCube(vl)}for(Pa.color=Array(Js.length),oo=0;oo<Js.length;++oo){var Yl=Js[oo];ce(typeof Yl=="function"&&Yl._reglType==="textureCube","invalid cube map"),da=da||Yl.width,ce(Yl.width===da&&Yl.height===da,"invalid cube map shape"),Pa.color[oo]={target:kf,data:Js[oo]}}for(oo=0;oo<6;++oo){for(var ps=0;ps<Js.length;++ps)Pa.color[ps].target=kf+oo;oo>0&&(Pa.depth=_i[0].depth,Pa.stencil=_i[0].stencil,Pa.depthStencil=_i[0].depthStencil),_i[oo]?_i[oo](Pa):_i[oo]=qi(Pa)}return D(qr,{width:da,height:da,color:Js})}function Zo(Ua){var oo,Pa=Ua|0;if(ce(Pa>0&&Pa<=Mn.maxCubeMapSize,"invalid radius for cube fbo"),Pa===qr.width)return qr;var da=qr.color;for(oo=0;oo<da.length;++oo)da[oo].resize(Pa);for(oo=0;oo<6;++oo)_i[oo].resize(Pa);return qr.width=qr.height=Pa,qr}return qr($i),D(qr,{faces:_i,resize:Zo,_reglType:"framebufferCube",destroy:function(){_i.forEach(function(Ua){Ua.destroy()})}})}function fa(){yr.cur=null,yr.next=null,yr.dirty=!0,Wo(ei).forEach(function($i){$i.framebuffer=Ue.createFramebuffer(),si($i)})}return D(yr,{getFramebuffer:function($i){if(typeof $i=="function"&&$i._reglType==="framebuffer"){var _i=$i._framebuffer;if(_i instanceof ro)return _i}return null},create:qi,createCube:Go,clear:function(){Wo(ei).forEach(to)},restore:fa})}var q=5126,de=34962;function ze(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=q,this.offset=0,this.stride=0,this.divisor=0}function it(Ue,Qt,Mn,Ar,$r){for(var Or=Mn.maxAttributes,yr=new Array(Or),Ai=0;Ai<Or;++Ai)yr[Ai]=new ze;var fi=0,Li={},wi={Record:ze,scope:{},state:yr,currentVAO:null,targetVAO:null,restore:Yi()?ei:function(){},createVAO:ro,getVAO:Fi,destroyBuffer:Ni,setVAO:Yi()?ur:Nr,clear:Yi()?Ci:function(){}};function Ni(yi){for(var to=0;to<yr.length;++to){var si=yr[to];si.buffer===yi&&(Ue.disableVertexAttribArray(to),si.buffer=null)}}function Yi(){return Qt.oes_vertex_array_object}function pi(){return Qt.angle_instanced_arrays}function Fi(yi){return typeof yi=="function"&&yi._vao?yi._vao:null}function ur(yi){if(yi!==wi.currentVAO){var to=Yi();yi?to.bindVertexArrayOES(yi.vao):to.bindVertexArrayOES(null),wi.currentVAO=yi}}function Nr(yi){if(yi!==wi.currentVAO){if(yi)yi.bindAttrs();else for(var to=pi(),si=0;si<yr.length;++si){var qi=yr[si];qi.buffer?(Ue.enableVertexAttribArray(si),Ue.vertexAttribPointer(si,qi.size,qi.type,qi.normalized,qi.stride,qi.offfset),to&&to.vertexAttribDivisorANGLE(si,qi.divisor)):(Ue.disableVertexAttribArray(si),Ue.vertexAttrib4f(si,qi.x,qi.y,qi.z,qi.w))}wi.currentVAO=yi}}function Ci(){Wo(Li).forEach(function(yi){yi.destroy()})}function Hi(){this.id=++fi,this.attributes=[];var yi=Yi();yi?this.vao=yi.createVertexArrayOES():this.vao=null,Li[this.id]=this,this.buffers=[]}Hi.prototype.bindAttrs=function(){for(var yi=pi(),to=this.attributes,si=0;si<to.length;++si){var qi=to[si];qi.buffer?(Ue.enableVertexAttribArray(si),Ue.bindBuffer(de,qi.buffer.buffer),Ue.vertexAttribPointer(si,qi.size,qi.type,qi.normalized,qi.stride,qi.offset),yi&&yi.vertexAttribDivisorANGLE(si,qi.divisor)):(Ue.disableVertexAttribArray(si),Ue.vertexAttrib4f(si,qi.x,qi.y,qi.z,qi.w))}for(var Go=to.length;Go<Or;++Go)Ue.disableVertexAttribArray(Go)},Hi.prototype.refresh=function(){var yi=Yi();yi&&(yi.bindVertexArrayOES(this.vao),this.bindAttrs(),wi.currentVAO=this)},Hi.prototype.destroy=function(){if(this.vao){var yi=Yi();this===wi.currentVAO&&(wi.currentVAO=null,yi.bindVertexArrayOES(null)),yi.deleteVertexArrayOES(this.vao),this.vao=null}Li[this.id]&&(delete Li[this.id],Ar.vaoCount-=1)};function ei(){var yi=Yi();yi&&Wo(Li).forEach(function(to){to.refresh()})}function ro(yi){var to=new Hi;Ar.vaoCount+=1;function si(qi){ce(Array.isArray(qi),"arguments to vertex array constructor must be an array"),ce(qi.length<Or,"too many attributes"),ce(qi.length>0,"must specify at least one attribute");for(var Go=0;Go<to.buffers.length;++Go)to.buffers[Go].destroy();to.buffers.length=0;var fa=to.attributes;fa.length=qi.length;for(var $i=0;$i<qi.length;++$i){var _i=qi[$i],qr=fa[$i]=new ze;if(Array.isArray(_i)||W(_i)||Jo(_i)){var Zo=$r.create(_i,de,!1,!0);qr.buffer=$r.getBuffer(Zo),qr.size=qr.buffer.dimension|0,qr.normalized=!1,qr.type=qr.buffer.dtype,qr.offset=0,qr.stride=0,qr.divisor=0,qr.state=1,to.buffers.push(Zo)}else $r.getBuffer(_i)?(qr.buffer=$r.getBuffer(_i),qr.size=qr.buffer.dimension|0,qr.normalized=!1,qr.type=qr.buffer.dtype,qr.offset=0,qr.stride=0,qr.divisor=0,qr.state=1):$r.getBuffer(_i.buffer)?(qr.buffer=$r.getBuffer(_i.buffer),qr.size=(+_i.size||qr.buffer.dimension)|0,qr.normalized=!!_i.normalized||!1,"type"in _i?(ce.parameter(_i.type,Pl,"invalid buffer type"),qr.type=Pl[_i.type]):qr.type=qr.buffer.dtype,qr.offset=(_i.offset||0)|0,qr.stride=(_i.stride||0)|0,qr.divisor=(_i.divisor||0)|0,qr.state=1,ce(qr.size>=1&&qr.size<=4,"size must be between 1 and 4"),ce(qr.offset>=0,"invalid offset"),ce(qr.stride>=0&&qr.stride<=255,"stride must be between 0 and 255"),ce(qr.divisor>=0,"divisor must be positive"),ce(!qr.divisor||!!Qt.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in _i?(ce($i>0,"first attribute must not be a constant"),qr.x=+_i.x||0,qr.y=+_i.y||0,qr.z=+_i.z||0,qr.w=+_i.w||0,qr.state=2):ce(!1,"invalid attribute spec for location "+$i)}return to.refresh(),si}return si.destroy=function(){to.destroy()},si._vao=to,si._reglType="vao",si(yi)}return wi}var Bt=35632,St=35633,Xt=35718,En=35721;function yn(Ue,Qt,Mn,Ar){var $r={},Or={};function yr(ur,Nr,Ci,Hi){this.name=ur,this.id=Nr,this.location=Ci,this.info=Hi}function Ai(ur,Nr){for(var Ci=0;Ci<ur.length;++Ci)if(ur[Ci].id===Nr.id){ur[Ci].location=Nr.location;return}ur.push(Nr)}function fi(ur,Nr,Ci){var Hi=ur===Bt?$r:Or,ei=Hi[Nr];if(!ei){var ro=Qt.str(Nr);ei=Ue.createShader(ur),Ue.shaderSource(ei,ro),Ue.compileShader(ei),ce.shaderError(Ue,ei,ro,ur,Ci),Hi[Nr]=ei}return ei}var Li={},wi=[],Ni=0;function Yi(ur,Nr){this.id=Ni++,this.fragId=ur,this.vertId=Nr,this.program=null,this.uniforms=[],this.attributes=[],Ar.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function pi(ur,Nr,Ci){var Hi,ei,ro=fi(Bt,ur.fragId),yi=fi(St,ur.vertId),to=ur.program=Ue.createProgram();if(Ue.attachShader(to,ro),Ue.attachShader(to,yi),Ci)for(Hi=0;Hi<Ci.length;++Hi){var si=Ci[Hi];Ue.bindAttribLocation(to,si[0],si[1])}Ue.linkProgram(to),ce.linkError(Ue,to,Qt.str(ur.fragId),Qt.str(ur.vertId),Nr);var qi=Ue.getProgramParameter(to,Xt);Ar.profile&&(ur.stats.uniformsCount=qi);var Go=ur.uniforms;for(Hi=0;Hi<qi;++Hi)if(ei=Ue.getActiveUniform(to,Hi),ei)if(ei.size>1)for(var fa=0;fa<ei.size;++fa){var $i=ei.name.replace("[0]","["+fa+"]");Ai(Go,new yr($i,Qt.id($i),Ue.getUniformLocation(to,$i),ei))}else Ai(Go,new yr(ei.name,Qt.id(ei.name),Ue.getUniformLocation(to,ei.name),ei));var _i=Ue.getProgramParameter(to,En);Ar.profile&&(ur.stats.attributesCount=_i);var qr=ur.attributes;for(Hi=0;Hi<_i;++Hi)ei=Ue.getActiveAttrib(to,Hi),ei&&Ai(qr,new yr(ei.name,Qt.id(ei.name),Ue.getAttribLocation(to,ei.name),ei))}Ar.profile&&(Mn.getMaxUniformsCount=function(){var ur=0;return wi.forEach(function(Nr){Nr.stats.uniformsCount>ur&&(ur=Nr.stats.uniformsCount)}),ur},Mn.getMaxAttributesCount=function(){var ur=0;return wi.forEach(function(Nr){Nr.stats.attributesCount>ur&&(ur=Nr.stats.attributesCount)}),ur});function Fi(){$r={},Or={};for(var ur=0;ur<wi.length;++ur)pi(wi[ur],null,wi[ur].attributes.map(function(Nr){return[Nr.location,Nr.name]}))}return{clear:function(){var ur=Ue.deleteShader.bind(Ue);Wo($r).forEach(ur),$r={},Wo(Or).forEach(ur),Or={},wi.forEach(function(Nr){Ue.deleteProgram(Nr.program)}),wi.length=0,Li={},Mn.shaderCount=0},program:function(ur,Nr,Ci,Hi){ce.command(ur>=0,"missing vertex shader",Ci),ce.command(Nr>=0,"missing fragment shader",Ci);var ei=Li[Nr];ei||(ei=Li[Nr]={});var ro=ei[ur];if(ro&&!Hi)return ro;var yi=new Yi(Nr,ur);return Mn.shaderCount++,pi(yi,Ci,Hi),ro||(ei[ur]=yi),wi.push(yi),yi},restore:Fi,shader:fi,frag:-1,vert:-1}}var Un=6408,cn=5121,Rn=3333,Jn=5126;function hr(Ue,Qt,Mn,Ar,$r,Or,yr){function Ai(wi){var Ni;Qt.next===null?(ce($r.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ni=cn):(ce(Qt.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ni=Qt.next.colorAttachments[0].texture._texture.type,Or.oes_texture_float?(ce(Ni===cn||Ni===Jn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ni===Jn&&ce(yr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):ce(Ni===cn,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Yi=0,pi=0,Fi=Ar.framebufferWidth,ur=Ar.framebufferHeight,Nr=null;W(wi)?Nr=wi:wi&&(ce.type(wi,"object","invalid arguments to regl.read()"),Yi=wi.x|0,pi=wi.y|0,ce(Yi>=0&&Yi<Ar.framebufferWidth,"invalid x offset for regl.read"),ce(pi>=0&&pi<Ar.framebufferHeight,"invalid y offset for regl.read"),Fi=(wi.width||Ar.framebufferWidth-Yi)|0,ur=(wi.height||Ar.framebufferHeight-pi)|0,Nr=wi.data||null),Nr&&(Ni===cn?ce(Nr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ni===Jn&&ce(Nr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ce(Fi>0&&Fi+Yi<=Ar.framebufferWidth,"invalid width for read pixels"),ce(ur>0&&ur+pi<=Ar.framebufferHeight,"invalid height for read pixels"),Mn();var Ci=Fi*ur*4;return Nr||(Ni===cn?Nr=new Uint8Array(Ci):Ni===Jn&&(Nr=Nr||new Float32Array(Ci))),ce.isTypedArray(Nr,"data buffer for regl.read() must be a typedarray"),ce(Nr.byteLength>=Ci,"data buffer for regl.read() too small"),Ue.pixelStorei(Rn,4),Ue.readPixels(Yi,pi,Fi,ur,Un,Ni,Nr),Nr}function fi(wi){var Ni;return Qt.setFBO({framebuffer:wi.framebuffer},function(){Ni=Ai(wi)}),Ni}function Li(wi){return!wi||!("framebuffer"in wi)?Ai(wi):fi(wi)}return Li}function Lr(Ue){return Array.prototype.slice.call(Ue)}function gr(Ue){return Lr(Ue).join("")}function Dr(){var Ue=0,Qt=[],Mn=[];function Ar(Ni){for(var Yi=0;Yi<Mn.length;++Yi)if(Mn[Yi]===Ni)return Qt[Yi];var pi="g"+Ue++;return Qt.push(pi),Mn.push(Ni),pi}function $r(){var Ni=[];function Yi(){Ni.push.apply(Ni,Lr(arguments))}var pi=[];function Fi(){var ur="v"+Ue++;return pi.push(ur),arguments.length>0&&(Ni.push(ur,"="),Ni.push.apply(Ni,Lr(arguments)),Ni.push(";")),ur}return D(Yi,{def:Fi,toString:function(){return gr([pi.length>0?"var "+pi.join(",")+";":"",gr(Ni)])}})}function Or(){var Ni=$r(),Yi=$r(),pi=Ni.toString,Fi=Yi.toString;function ur(Nr,Ci){Yi(Nr,Ci,"=",Ni.def(Nr,Ci),";")}return D(function(){Ni.apply(Ni,Lr(arguments))},{def:Ni.def,entry:Ni,exit:Yi,save:ur,set:function(Nr,Ci,Hi){ur(Nr,Ci),Ni(Nr,Ci,"=",Hi,";")},toString:function(){return pi()+Fi()}})}function yr(){var Ni=gr(arguments),Yi=Or(),pi=Or(),Fi=Yi.toString,ur=pi.toString;return D(Yi,{then:function(){return Yi.apply(Yi,Lr(arguments)),this},else:function(){return pi.apply(pi,Lr(arguments)),this},toString:function(){var Nr=ur();return Nr&&(Nr="else{"+Nr+"}"),gr(["if(",Ni,"){",Fi(),"}",Nr])}})}var Ai=$r(),fi={};function Li(Ni,Yi){var pi=[];function Fi(){var ei="a"+pi.length;return pi.push(ei),ei}Yi=Yi||0;for(var ur=0;ur<Yi;++ur)Fi();var Nr=Or(),Ci=Nr.toString,Hi=fi[Ni]=D(Nr,{arg:Fi,toString:function(){return gr(["function(",pi.join(),"){",Ci(),"}"])}});return Hi}function wi(){var Ni=['"use strict";',Ai,"return {"];Object.keys(fi).forEach(function(Fi){Ni.push('"',Fi,'":',fi[Fi].toString(),",")}),Ni.push("}");var Yi=gr(Ni).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),pi=Function.apply(null,Qt.concat(Yi));return pi.apply(null,Mn)}return{global:Ai,link:Ar,block:$r,proc:Li,scope:Or,cond:yr,compile:wi}}var Fr="xyzw".split(""),Mi=5121,Pi=1,vi=2,Oo=0,yo=1,Ho=2,is=3,Cr=4,Kt="dither",Zr="blend.enable",ko="blend.color",qo="blend.equation",va="blend.func",na="depth.enable",Vo="depth.func",sl="depth.range",bl="depth.mask",zc="colorMask",ic="cull.enable",Rs="cull.face",ll="frontFace",Qs="lineWidth",Tc="polygonOffset.enable",Ch="polygonOffset.offset",Il="sample.alpha",cu="sample.enable",pl="sample.coverage",$d="stencil.enable",Td="stencil.mask",Oh="stencil.func",Sf="stencil.opFront",Qh="stencil.opBack",Rh="scissor.enable",Ti="scissor.box",ml="viewport",Ll="profile",Kc="framebuffer",os="vert",Ns="frag",ga="elements",xl="primitive",Ba="count",ih="offset",a0="instances",Tf="vao",Kd="Width",oh="Height",wd=Kc+Kd,Vf=Kc+oh,zs=ml+Kd,s0=ml+oh,wf="drawingBuffer",uu=wf+Kd,vo=wf+oh,dm=[va,qo,Oh,Sf,Qh,pl,ml,Ti,Ch],Cp=34962,vy=34963,ig=35632,gy=35633,dv=3553,pm=34067,l0=2884,yy=3042,Op=3024,Rp=2960,pv=2929,mv=3089,og=32823,mm=32926,ag=32928,c0=5126,u0=35664,Af=35665,vm=35666,oc=5124,qd=35667,El=35668,Ad=35669,Mp=35670,ah=35671,Cd=35672,Jh=35673,Pp=35674,fc=35675,Uu=35676,Qd=35678,fu=35680,vv=4,ed=1028,Cf=1029,sh=2304,Od=2305,td=32775,Jd=32776,Of=519,nd=7680,gv=0,_y=1,yv=32774,sg=513,rd=36160,gm=36064,lh={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ep=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],tp={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Rd={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},_v={frag:ig,vert:gy},np={cw:sh,ccw:Od};function V0(Ue){return Array.isArray(Ue)||W(Ue)||Jo(Ue)}function Md(Ue){return Ue.sort(function(Qt,Mn){return Qt===ml?-1:Mn===ml?1:Qt<Mn?-1:1})}function qc(Ue,Qt,Mn,Ar){this.thisDep=Ue,this.contextDep=Qt,this.propDep=Mn,this.append=Ar}function Qc(Ue){return Ue&&!(Ue.thisDep||Ue.contextDep||Ue.propDep)}function hc(Ue){return new qc(!1,!1,!1,Ue)}function lf(Ue,Qt){var Mn=Ue.type;if(Mn===Oo){var Ar=Ue.data.length;return new qc(!0,Ar>=1,Ar>=2,Qt)}else if(Mn===Cr){var $r=Ue.data;return new qc($r.thisDep,$r.contextDep,$r.propDep,Qt)}else return new qc(Mn===is,Mn===Ho,Mn===yo,Qt)}var wu=new qc(!1,!1,!1,function(){});function rp(Ue,Qt,Mn,Ar,$r,Or,yr,Ai,fi,Li,wi,Ni,Yi,pi,Fi){var ur=Li.Record,Nr={add:32774,subtract:32778,"reverse subtract":32779};Mn.ext_blend_minmax&&(Nr.min=td,Nr.max=Jd);var Ci=Mn.angle_instanced_arrays,Hi=Mn.webgl_draw_buffers,ei={dirty:!0,profile:Fi.profile},ro={},yi=[],to={},si={};function qi(It){return It.replace(".","_")}function Go(It,rn,In){var wr=qi(It);yi.push(It),ro[wr]=ei[wr]=!!In,to[wr]=rn}function fa(It,rn,In){var wr=qi(It);yi.push(It),Array.isArray(In)?(ei[wr]=In.slice(),ro[wr]=In.slice()):ei[wr]=ro[wr]=In,si[wr]=rn}Go(Kt,Op),Go(Zr,yy),fa(ko,"blendColor",[0,0,0,0]),fa(qo,"blendEquationSeparate",[yv,yv]),fa(va,"blendFuncSeparate",[_y,gv,_y,gv]),Go(na,pv,!0),fa(Vo,"depthFunc",sg),fa(sl,"depthRange",[0,1]),fa(bl,"depthMask",!0),fa(zc,zc,[!0,!0,!0,!0]),Go(ic,l0),fa(Rs,"cullFace",Cf),fa(ll,ll,Od),fa(Qs,Qs,1),Go(Tc,og),fa(Ch,"polygonOffset",[0,0]),Go(Il,mm),Go(cu,ag),fa(pl,"sampleCoverage",[1,!1]),Go($d,Rp),fa(Td,"stencilMask",-1),fa(Oh,"stencilFunc",[Of,0,-1]),fa(Sf,"stencilOpSeparate",[ed,nd,nd,nd]),fa(Qh,"stencilOpSeparate",[Cf,nd,nd,nd]),Go(Rh,mv),fa(Ti,"scissor",[0,0,Ue.drawingBufferWidth,Ue.drawingBufferHeight]),fa(ml,ml,[0,0,Ue.drawingBufferWidth,Ue.drawingBufferHeight]);var $i={gl:Ue,context:Yi,strings:Qt,next:ro,current:ei,draw:Ni,elements:Or,buffer:$r,shader:wi,attributes:Li.state,vao:Li,uniforms:fi,framebuffer:Ai,extensions:Mn,timer:pi,isBufferArgs:V0},_i={primTypes:yu,compareFuncs:tp,blendFuncs:lh,blendEquations:Nr,stencilOps:Rd,glTypes:Pl,orientationType:np};ce.optional(function(){$i.isArrayLike=rl}),Hi&&(_i.backBuffer=[Cf],_i.drawBuffer=qn(Ar.maxDrawbuffers,function(It){return It===0?[0]:qn(It,function(rn){return gm+rn})}));var qr=0;function Zo(){var It=Dr(),rn=It.link,In=It.global;It.id=qr++,It.batchId="0";var wr=rn($i),br=It.shared={props:"a0"};Object.keys($i).forEach(function(Zn){br[Zn]=In.def(wr,".",Zn)}),ce.optional(function(){It.CHECK=rn(ce),It.commandStr=ce.guessCommand(),It.command=rn(It.commandStr),It.assert=function(Zn,nn,Xn){Zn("if(!(",nn,"))",this.CHECK,".commandRaise(",rn(Xn),",",this.command,");")},_i.invalidBlendCombinations=ep});var Vn=It.next={},Kn=It.current={};Object.keys(si).forEach(function(Zn){Array.isArray(ei[Zn])&&(Vn[Zn]=In.def(br.next,".",Zn),Kn[Zn]=In.def(br.current,".",Zn))});var nr=It.constants={};Object.keys(_i).forEach(function(Zn){nr[Zn]=In.def(JSON.stringify(_i[Zn]))}),It.invoke=function(Zn,nn){switch(nn.type){case Oo:var Xn=["this",br.context,br.props,It.batchId];return Zn.def(rn(nn.data),".call(",Xn.slice(0,Math.max(nn.data.length+1,4)),")");case yo:return Zn.def(br.props,nn.data);case Ho:return Zn.def(br.context,nn.data);case is:return Zn.def("this",nn.data);case Cr:return nn.data.append(It,Zn),nn.data.ref}},It.attribCache={};var bn={};return It.scopeAttrib=function(Zn){var nn=Qt.id(Zn);if(nn in bn)return bn[nn];var Xn=Li.scope[nn];Xn||(Xn=Li.scope[nn]=new ur);var Sr=bn[nn]=rn(Xn);return Sr},It}function Ua(It){var rn=It.static,In=It.dynamic,wr;if(Ll in rn){var br=!!rn[Ll];wr=hc(function(Kn,nr){return br}),wr.enable=br}else if(Ll in In){var Vn=In[Ll];wr=lf(Vn,function(Kn,nr){return Kn.invoke(nr,Vn)})}return wr}function oo(It,rn){var In=It.static,wr=It.dynamic;if(Kc in In){var br=In[Kc];return br?(br=Ai.getFramebuffer(br),ce.command(br,"invalid framebuffer object"),hc(function(Kn,nr){var bn=Kn.link(br),Zn=Kn.shared;nr.set(Zn.framebuffer,".next",bn);var nn=Zn.context;return nr.set(nn,"."+wd,bn+".width"),nr.set(nn,"."+Vf,bn+".height"),bn})):hc(function(Kn,nr){var bn=Kn.shared;nr.set(bn.framebuffer,".next","null");var Zn=bn.context;return nr.set(Zn,"."+wd,Zn+"."+uu),nr.set(Zn,"."+Vf,Zn+"."+vo),"null"})}else if(Kc in wr){var Vn=wr[Kc];return lf(Vn,function(Kn,nr){var bn=Kn.invoke(nr,Vn),Zn=Kn.shared,nn=Zn.framebuffer,Xn=nr.def(nn,".getFramebuffer(",bn,")");ce.optional(function(){Kn.assert(nr,"!"+bn+"||"+Xn,"invalid framebuffer object")}),nr.set(nn,".next",Xn);var Sr=Zn.context;return nr.set(Sr,"."+wd,Xn+"?"+Xn+".width:"+Sr+"."+uu),nr.set(Sr,"."+Vf,Xn+"?"+Xn+".height:"+Sr+"."+vo),Xn})}else return null}function Pa(It,rn,In){var wr=It.static,br=It.dynamic;function Vn(bn){if(bn in wr){var Zn=wr[bn];ce.commandType(Zn,"object","invalid "+bn,In.commandStr);var nn=!0,Xn=Zn.x|0,Sr=Zn.y|0,zr,di;return"width"in Zn?(zr=Zn.width|0,ce.command(zr>=0,"invalid "+bn,In.commandStr)):nn=!1,"height"in Zn?(di=Zn.height|0,ce.command(di>=0,"invalid "+bn,In.commandStr)):nn=!1,new qc(!nn&&rn&&rn.thisDep,!nn&&rn&&rn.contextDep,!nn&&rn&&rn.propDep,function(To,co){var So=To.shared.context,mo=zr;"width"in Zn||(mo=co.def(So,".",wd,"-",Xn));var aa=di;return"height"in Zn||(aa=co.def(So,".",Vf,"-",Sr)),[Xn,Sr,mo,aa]})}else if(bn in br){var ni=br[bn],gi=lf(ni,function(To,co){var So=To.invoke(co,ni);ce.optional(function(){To.assert(co,So+"&&typeof "+So+'==="object"',"invalid "+bn)});var mo=To.shared.context,aa=co.def(So,".x|0"),Cs=co.def(So,".y|0"),Ac=co.def('"width" in ',So,"?",So,".width|0:","(",mo,".",wd,"-",aa,")"),Au=co.def('"height" in ',So,"?",So,".height|0:","(",mo,".",Vf,"-",Cs,")");return ce.optional(function(){To.assert(co,Ac+">=0&&"+Au+">=0","invalid "+bn)}),[aa,Cs,Ac,Au]});return rn&&(gi.thisDep=gi.thisDep||rn.thisDep,gi.contextDep=gi.contextDep||rn.contextDep,gi.propDep=gi.propDep||rn.propDep),gi}else return rn?new qc(rn.thisDep,rn.contextDep,rn.propDep,function(To,co){var So=To.shared.context;return[0,0,co.def(So,".",wd),co.def(So,".",Vf)]}):null}var Kn=Vn(ml);if(Kn){var nr=Kn;Kn=new qc(Kn.thisDep,Kn.contextDep,Kn.propDep,function(bn,Zn){var nn=nr.append(bn,Zn),Xn=bn.shared.context;return Zn.set(Xn,"."+zs,nn[2]),Zn.set(Xn,"."+s0,nn[3]),nn})}return{viewport:Kn,scissor_box:Vn(Ti)}}function da(It,rn){var In=It.static,wr=typeof In[Ns]=="string"&&typeof In[os]=="string";if(wr){if(Object.keys(rn.dynamic).length>0)return null;var br=rn.static,Vn=Object.keys(br);if(Vn.length>0&&typeof br[Vn[0]]=="number"){for(var Kn=[],nr=0;nr<Vn.length;++nr)ce(typeof br[Vn[nr]]=="number","must specify all vertex attribute locations when using vaos"),Kn.push([br[Vn[nr]]|0,Vn[nr]]);return Kn}}return null}function oa(It,rn,In){var wr=It.static,br=It.dynamic;function Vn(nn){if(nn in wr){var Xn=Qt.id(wr[nn]);ce.optional(function(){wi.shader(_v[nn],Xn,ce.guessCommand())});var Sr=hc(function(){return Xn});return Sr.id=Xn,Sr}else if(nn in br){var zr=br[nn];return lf(zr,function(di,ni){var gi=di.invoke(ni,zr),To=ni.def(di.shared.strings,".id(",gi,")");return ce.optional(function(){ni(di.shared.shader,".shader(",_v[nn],",",To,",",di.command,");")}),To})}return null}var Kn=Vn(Ns),nr=Vn(os),bn=null,Zn;return Qc(Kn)&&Qc(nr)?(bn=wi.program(nr.id,Kn.id,null,In),Zn=hc(function(nn,Xn){return nn.link(bn)})):Zn=new qc(Kn&&Kn.thisDep||nr&&nr.thisDep,Kn&&Kn.contextDep||nr&&nr.contextDep,Kn&&Kn.propDep||nr&&nr.propDep,function(nn,Xn){var Sr=nn.shared.shader,zr;Kn?zr=Kn.append(nn,Xn):zr=Xn.def(Sr,".",Ns);var di;nr?di=nr.append(nn,Xn):di=Xn.def(Sr,".",os);var ni=Sr+".program("+di+","+zr;return ce.optional(function(){ni+=","+nn.command}),Xn.def(ni+")")}),{frag:Kn,vert:nr,progVar:Zn,program:bn}}function gs(It,rn){var In=It.static,wr=It.dynamic;function br(){if(ga in In){var nn=In[ga];V0(nn)?nn=Or.getElements(Or.create(nn,!0)):nn&&(nn=Or.getElements(nn),ce.command(nn,"invalid elements",rn.commandStr));var Xn=hc(function(zr,di){if(nn){var ni=zr.link(nn);return zr.ELEMENTS=ni,ni}return zr.ELEMENTS=null,null});return Xn.value=nn,Xn}else if(ga in wr){var Sr=wr[ga];return lf(Sr,function(zr,di){var ni=zr.shared,gi=ni.isBufferArgs,To=ni.elements,co=zr.invoke(di,Sr),So=di.def("null"),mo=di.def(gi,"(",co,")"),aa=zr.cond(mo).then(So,"=",To,".createStream(",co,");").else(So,"=",To,".getElements(",co,");");return ce.optional(function(){zr.assert(aa.else,"!"+co+"||"+So,"invalid elements")}),di.entry(aa),di.exit(zr.cond(mo).then(To,".destroyStream(",So,");")),zr.ELEMENTS=So,So})}return null}var Vn=br();function Kn(){if(xl in In){var nn=In[xl];return ce.commandParameter(nn,yu,"invalid primitve",rn.commandStr),hc(function(Sr,zr){return yu[nn]})}else if(xl in wr){var Xn=wr[xl];return lf(Xn,function(Sr,zr){var di=Sr.constants.primTypes,ni=Sr.invoke(zr,Xn);return ce.optional(function(){Sr.assert(zr,ni+" in "+di,"invalid primitive, must be one of "+Object.keys(yu))}),zr.def(di,"[",ni,"]")})}else if(Vn)return Qc(Vn)?Vn.value?hc(function(Sr,zr){return zr.def(Sr.ELEMENTS,".primType")}):hc(function(){return vv}):new qc(Vn.thisDep,Vn.contextDep,Vn.propDep,function(Sr,zr){var di=Sr.ELEMENTS;return zr.def(di,"?",di,".primType:",vv)});return null}function nr(nn,Xn){if(nn in In){var Sr=In[nn]|0;return ce.command(!Xn||Sr>=0,"invalid "+nn,rn.commandStr),hc(function(di,ni){return Xn&&(di.OFFSET=Sr),Sr})}else if(nn in wr){var zr=wr[nn];return lf(zr,function(di,ni){var gi=di.invoke(ni,zr);return Xn&&(di.OFFSET=gi,ce.optional(function(){di.assert(ni,gi+">=0","invalid "+nn)})),gi})}else if(Xn&&Vn)return hc(function(di,ni){return di.OFFSET="0",0});return null}var bn=nr(ih,!0);function Zn(){if(Ba in In){var nn=In[Ba]|0;return ce.command(typeof nn=="number"&&nn>=0,"invalid vertex count",rn.commandStr),hc(function(){return nn})}else if(Ba in wr){var Xn=wr[Ba];return lf(Xn,function(di,ni){var gi=di.invoke(ni,Xn);return ce.optional(function(){di.assert(ni,"typeof "+gi+'==="number"&&'+gi+">=0&&"+gi+"===("+gi+"|0)","invalid vertex count")}),gi})}else if(Vn)if(Qc(Vn)){if(Vn)return bn?new qc(bn.thisDep,bn.contextDep,bn.propDep,function(di,ni){var gi=ni.def(di.ELEMENTS,".vertCount-",di.OFFSET);return ce.optional(function(){di.assert(ni,gi+">=0","invalid vertex offset/element buffer too small")}),gi}):hc(function(di,ni){return ni.def(di.ELEMENTS,".vertCount")});var Sr=hc(function(){return-1});return ce.optional(function(){Sr.MISSING=!0}),Sr}else{var zr=new qc(Vn.thisDep||bn.thisDep,Vn.contextDep||bn.contextDep,Vn.propDep||bn.propDep,function(di,ni){var gi=di.ELEMENTS;return di.OFFSET?ni.def(gi,"?",gi,".vertCount-",di.OFFSET,":-1"):ni.def(gi,"?",gi,".vertCount:-1")});return ce.optional(function(){zr.DYNAMIC=!0}),zr}return null}return{elements:Vn,primitive:Kn(),count:Zn(),instances:nr(a0,!1),offset:bn}}function jl(It,rn){var In=It.static,wr=It.dynamic,br={};return yi.forEach(function(Vn){var Kn=qi(Vn);function nr(bn,Zn){if(Vn in In){var nn=bn(In[Vn]);br[Kn]=hc(function(){return nn})}else if(Vn in wr){var Xn=wr[Vn];br[Kn]=lf(Xn,function(Sr,zr){return Zn(Sr,zr,Sr.invoke(zr,Xn))})}}switch(Vn){case ic:case Zr:case Kt:case $d:case na:case Rh:case Tc:case Il:case cu:case bl:return nr(function(bn){return ce.commandType(bn,"boolean",Vn,rn.commandStr),bn},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,"typeof "+nn+'==="boolean"',"invalid flag "+Vn,bn.commandStr)}),nn});case Vo:return nr(function(bn){return ce.commandParameter(bn,tp,"invalid "+Vn,rn.commandStr),tp[bn]},function(bn,Zn,nn){var Xn=bn.constants.compareFuncs;return ce.optional(function(){bn.assert(Zn,nn+" in "+Xn,"invalid "+Vn+", must be one of "+Object.keys(tp))}),Zn.def(Xn,"[",nn,"]")});case sl:return nr(function(bn){return ce.command(rl(bn)&&bn.length===2&&typeof bn[0]=="number"&&typeof bn[1]=="number"&&bn[0]<=bn[1],"depth range is 2d array",rn.commandStr),bn},function(bn,Zn,nn){ce.optional(function(){bn.assert(Zn,bn.shared.isArrayLike+"("+nn+")&&"+nn+".length===2&&typeof "+nn+'[0]==="number"&&typeof '+nn+'[1]==="number"&&'+nn+"[0]<="+nn+"[1]","depth range must be a 2d array")});var Xn=Zn.def("+",nn,"[0]"),Sr=Zn.def("+",nn,"[1]");return[Xn,Sr]});case va:return nr(function(bn){ce.commandType(bn,"object","blend.func",rn.commandStr);var Zn="srcRGB"in bn?bn.srcRGB:bn.src,nn="srcAlpha"in bn?bn.srcAlpha:bn.src,Xn="dstRGB"in bn?bn.dstRGB:bn.dst,Sr="dstAlpha"in bn?bn.dstAlpha:bn.dst;return ce.commandParameter(Zn,lh,Kn+".srcRGB",rn.commandStr),ce.commandParameter(nn,lh,Kn+".srcAlpha",rn.commandStr),ce.commandParameter(Xn,lh,Kn+".dstRGB",rn.commandStr),ce.commandParameter(Sr,lh,Kn+".dstAlpha",rn.commandStr),ce.command(ep.indexOf(Zn+", "+Xn)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Zn+", "+Xn+")",rn.commandStr),[lh[Zn],lh[Xn],lh[nn],lh[Sr]]},function(bn,Zn,nn){var Xn=bn.constants.blendFuncs;ce.optional(function(){bn.assert(Zn,nn+"&&typeof "+nn+'==="object"',"invalid blend func, must be an object")});function Sr(So,mo){var aa=Zn.def('"',So,mo,'" in ',nn,"?",nn,".",So,mo,":",nn,".",So);return ce.optional(function(){bn.assert(Zn,aa+" in "+Xn,"invalid "+Vn+"."+So+mo+", must be one of "+Object.keys(lh))}),aa}var zr=Sr("src","RGB"),di=Sr("dst","RGB");ce.optional(function(){var So=bn.constants.invalidBlendCombinations;bn.assert(Zn,So+".indexOf("+zr+'+", "+'+di+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ni=Zn.def(Xn,"[",zr,"]"),gi=Zn.def(Xn,"[",Sr("src","Alpha"),"]"),To=Zn.def(Xn,"[",di,"]"),co=Zn.def(Xn,"[",Sr("dst","Alpha"),"]");return[ni,To,gi,co]});case qo:return nr(function(bn){if(typeof bn=="string")return ce.commandParameter(bn,Nr,"invalid "+Vn,rn.commandStr),[Nr[bn],Nr[bn]];if(typeof bn=="object")return ce.commandParameter(bn.rgb,Nr,Vn+".rgb",rn.commandStr),ce.commandParameter(bn.alpha,Nr,Vn+".alpha",rn.commandStr),[Nr[bn.rgb],Nr[bn.alpha]];ce.commandRaise("invalid blend.equation",rn.commandStr)},function(bn,Zn,nn){var Xn=bn.constants.blendEquations,Sr=Zn.def(),zr=Zn.def(),di=bn.cond("typeof ",nn,'==="string"');return ce.optional(function(){function ni(gi,To,co){bn.assert(gi,co+" in "+Xn,"invalid "+To+", must be one of "+Object.keys(Nr))}ni(di.then,Vn,nn),bn.assert(di.else,nn+"&&typeof "+nn+'==="object"',"invalid "+Vn),ni(di.else,Vn+".rgb",nn+".rgb"),ni(di.else,Vn+".alpha",nn+".alpha")}),di.then(Sr,"=",zr,"=",Xn,"[",nn,"];"),di.else(Sr,"=",Xn,"[",nn,".rgb];",zr,"=",Xn,"[",nn,".alpha];"),Zn(di),[Sr,zr]});case ko:return nr(function(bn){return ce.command(rl(bn)&&bn.length===4,"blend.color must be a 4d array",rn.commandStr),qn(4,function(Zn){return+bn[Zn]})},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,bn.shared.isArrayLike+"("+nn+")&&"+nn+".length===4","blend.color must be a 4d array")}),qn(4,function(Xn){return Zn.def("+",nn,"[",Xn,"]")})});case Td:return nr(function(bn){return ce.commandType(bn,"number",Kn,rn.commandStr),bn|0},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,"typeof "+nn+'==="number"',"invalid stencil.mask")}),Zn.def(nn,"|0")});case Oh:return nr(function(bn){ce.commandType(bn,"object",Kn,rn.commandStr);var Zn=bn.cmp||"keep",nn=bn.ref||0,Xn="mask"in bn?bn.mask:-1;return ce.commandParameter(Zn,tp,Vn+".cmp",rn.commandStr),ce.commandType(nn,"number",Vn+".ref",rn.commandStr),ce.commandType(Xn,"number",Vn+".mask",rn.commandStr),[tp[Zn],nn,Xn]},function(bn,Zn,nn){var Xn=bn.constants.compareFuncs;ce.optional(function(){function ni(){bn.assert(Zn,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ni(nn+"&&typeof ",nn,'==="object"'),ni('!("cmp" in ',nn,")||(",nn,".cmp in ",Xn,")")});var Sr=Zn.def('"cmp" in ',nn,"?",Xn,"[",nn,".cmp]",":",nd),zr=Zn.def(nn,".ref|0"),di=Zn.def('"mask" in ',nn,"?",nn,".mask|0:-1");return[Sr,zr,di]});case Sf:case Qh:return nr(function(bn){ce.commandType(bn,"object",Kn,rn.commandStr);var Zn=bn.fail||"keep",nn=bn.zfail||"keep",Xn=bn.zpass||"keep";return ce.commandParameter(Zn,Rd,Vn+".fail",rn.commandStr),ce.commandParameter(nn,Rd,Vn+".zfail",rn.commandStr),ce.commandParameter(Xn,Rd,Vn+".zpass",rn.commandStr),[Vn===Qh?Cf:ed,Rd[Zn],Rd[nn],Rd[Xn]]},function(bn,Zn,nn){var Xn=bn.constants.stencilOps;ce.optional(function(){bn.assert(Zn,nn+"&&typeof "+nn+'==="object"',"invalid "+Vn)});function Sr(zr){return ce.optional(function(){bn.assert(Zn,'!("'+zr+'" in '+nn+")||("+nn+"."+zr+" in "+Xn+")","invalid "+Vn+"."+zr+", must be one of "+Object.keys(Rd))}),Zn.def('"',zr,'" in ',nn,"?",Xn,"[",nn,".",zr,"]:",nd)}return[Vn===Qh?Cf:ed,Sr("fail"),Sr("zfail"),Sr("zpass")]});case Ch:return nr(function(bn){ce.commandType(bn,"object",Kn,rn.commandStr);var Zn=bn.factor|0,nn=bn.units|0;return ce.commandType(Zn,"number",Kn+".factor",rn.commandStr),ce.commandType(nn,"number",Kn+".units",rn.commandStr),[Zn,nn]},function(bn,Zn,nn){ce.optional(function(){bn.assert(Zn,nn+"&&typeof "+nn+'==="object"',"invalid "+Vn)});var Xn=Zn.def(nn,".factor|0"),Sr=Zn.def(nn,".units|0");return[Xn,Sr]});case Rs:return nr(function(bn){var Zn=0;return bn==="front"?Zn=ed:bn==="back"&&(Zn=Cf),ce.command(!!Zn,Kn,rn.commandStr),Zn},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,nn+'==="front"||'+nn+'==="back"',"invalid cull.face")}),Zn.def(nn,'==="front"?',ed,":",Cf)});case Qs:return nr(function(bn){return ce.command(typeof bn=="number"&&bn>=Ar.lineWidthDims[0]&&bn<=Ar.lineWidthDims[1],"invalid line width, must be a positive number between "+Ar.lineWidthDims[0]+" and "+Ar.lineWidthDims[1],rn.commandStr),bn},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,"typeof "+nn+'==="number"&&'+nn+">="+Ar.lineWidthDims[0]+"&&"+nn+"<="+Ar.lineWidthDims[1],"invalid line width")}),nn});case ll:return nr(function(bn){return ce.commandParameter(bn,np,Kn,rn.commandStr),np[bn]},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,nn+'==="cw"||'+nn+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Zn.def(nn+'==="cw"?'+sh+":"+Od)});case zc:return nr(function(bn){return ce.command(rl(bn)&&bn.length===4,"color.mask must be length 4 array",rn.commandStr),bn.map(function(Zn){return!!Zn})},function(bn,Zn,nn){return ce.optional(function(){bn.assert(Zn,bn.shared.isArrayLike+"("+nn+")&&"+nn+".length===4","invalid color.mask")}),qn(4,function(Xn){return"!!"+nn+"["+Xn+"]"})});case pl:return nr(function(bn){ce.command(typeof bn=="object"&&bn,Kn,rn.commandStr);var Zn="value"in bn?bn.value:1,nn=!!bn.invert;return ce.command(typeof Zn=="number"&&Zn>=0&&Zn<=1,"sample.coverage.value must be a number between 0 and 1",rn.commandStr),[Zn,nn]},function(bn,Zn,nn){ce.optional(function(){bn.assert(Zn,nn+"&&typeof "+nn+'==="object"',"invalid sample.coverage")});var Xn=Zn.def('"value" in ',nn,"?+",nn,".value:1"),Sr=Zn.def("!!",nn,".invert");return[Xn,Sr]})}}),br}function eu(It,rn){var In=It.static,wr=It.dynamic,br={};return Object.keys(In).forEach(function(Vn){var Kn=In[Vn],nr;if(typeof Kn=="number"||typeof Kn=="boolean")nr=hc(function(){return Kn});else if(typeof Kn=="function"){var bn=Kn._reglType;bn==="texture2d"||bn==="textureCube"?nr=hc(function(Zn){return Zn.link(Kn)}):bn==="framebuffer"||bn==="framebufferCube"?(ce.command(Kn.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Vn+'"',rn.commandStr),nr=hc(function(Zn){return Zn.link(Kn.color[0])})):ce.commandRaise('invalid data for uniform "'+Vn+'"',rn.commandStr)}else rl(Kn)?nr=hc(function(Zn){var nn=Zn.global.def("[",qn(Kn.length,function(Xn){return ce.command(typeof Kn[Xn]=="number"||typeof Kn[Xn]=="boolean","invalid uniform "+Vn,Zn.commandStr),Kn[Xn]}),"]");return nn}):ce.commandRaise('invalid or missing data for uniform "'+Vn+'"',rn.commandStr);nr.value=Kn,br[Vn]=nr}),Object.keys(wr).forEach(function(Vn){var Kn=wr[Vn];br[Vn]=lf(Kn,function(nr,bn){return nr.invoke(bn,Kn)})}),br}function ja(It,rn){var In=It.static,wr=It.dynamic,br={};return Object.keys(In).forEach(function(Vn){var Kn=In[Vn],nr=Qt.id(Vn),bn=new ur;if(V0(Kn))bn.state=Pi,bn.buffer=$r.getBuffer($r.create(Kn,Cp,!1,!0)),bn.type=0;else{var Zn=$r.getBuffer(Kn);if(Zn)bn.state=Pi,bn.buffer=Zn,bn.type=0;else if(ce.command(typeof Kn=="object"&&Kn,"invalid data for attribute "+Vn,rn.commandStr),"constant"in Kn){var nn=Kn.constant;bn.buffer="null",bn.state=vi,typeof nn=="number"?bn.x=nn:(ce.command(rl(nn)&&nn.length>0&&nn.length<=4,"invalid constant for attribute "+Vn,rn.commandStr),Fr.forEach(function(To,co){co<nn.length&&(bn[To]=nn[co])}))}else{V0(Kn.buffer)?Zn=$r.getBuffer($r.create(Kn.buffer,Cp,!1,!0)):Zn=$r.getBuffer(Kn.buffer),ce.command(!!Zn,'missing buffer for attribute "'+Vn+'"',rn.commandStr);var Xn=Kn.offset|0;ce.command(Xn>=0,'invalid offset for attribute "'+Vn+'"',rn.commandStr);var Sr=Kn.stride|0;ce.command(Sr>=0&&Sr<256,'invalid stride for attribute "'+Vn+'", must be integer betweeen [0, 255]',rn.commandStr);var zr=Kn.size|0;ce.command(!("size"in Kn)||zr>0&&zr<=4,'invalid size for attribute "'+Vn+'", must be 1,2,3,4',rn.commandStr);var di=!!Kn.normalized,ni=0;"type"in Kn&&(ce.commandParameter(Kn.type,Pl,"invalid type for attribute "+Vn,rn.commandStr),ni=Pl[Kn.type]);var gi=Kn.divisor|0;"divisor"in Kn&&(ce.command(gi===0||Ci,'cannot specify divisor for attribute "'+Vn+'", instancing not supported',rn.commandStr),ce.command(gi>=0,'invalid divisor for attribute "'+Vn+'"',rn.commandStr)),ce.optional(function(){var To=rn.commandStr,co=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Kn).forEach(function(So){ce.command(co.indexOf(So)>=0,'unknown parameter "'+So+'" for attribute pointer "'+Vn+'" (valid parameters are '+co+")",To)})}),bn.buffer=Zn,bn.state=Pi,bn.size=zr,bn.normalized=di,bn.type=ni||Zn.dtype,bn.offset=Xn,bn.stride=Sr,bn.divisor=gi}}br[Vn]=hc(function(To,co){var So=To.attribCache;if(nr in So)return So[nr];var mo={isStream:!1};return Object.keys(bn).forEach(function(aa){mo[aa]=bn[aa]}),bn.buffer&&(mo.buffer=To.link(bn.buffer),mo.type=mo.type||mo.buffer+".dtype"),So[nr]=mo,mo})}),Object.keys(wr).forEach(function(Vn){var Kn=wr[Vn];function nr(bn,Zn){var nn=bn.invoke(Zn,Kn),Xn=bn.shared,Sr=bn.constants,zr=Xn.isBufferArgs,di=Xn.buffer;ce.optional(function(){bn.assert(Zn,nn+"&&(typeof "+nn+'==="object"||typeof '+nn+'==="function")&&('+zr+"("+nn+")||"+di+".getBuffer("+nn+")||"+di+".getBuffer("+nn+".buffer)||"+zr+"("+nn+'.buffer)||("constant" in '+nn+"&&(typeof "+nn+'.constant==="number"||'+Xn.isArrayLike+"("+nn+".constant))))",'invalid dynamic attribute "'+Vn+'"')});var ni={isStream:Zn.def(!1)},gi=new ur;gi.state=Pi,Object.keys(gi).forEach(function(mo){ni[mo]=Zn.def(""+gi[mo])});var To=ni.buffer,co=ni.type;Zn("if(",zr,"(",nn,")){",ni.isStream,"=true;",To,"=",di,".createStream(",Cp,",",nn,");",co,"=",To,".dtype;","}else{",To,"=",di,".getBuffer(",nn,");","if(",To,"){",co,"=",To,".dtype;",'}else if("constant" in ',nn,"){",ni.state,"=",vi,";","if(typeof "+nn+'.constant === "number"){',ni[Fr[0]],"=",nn,".constant;",Fr.slice(1).map(function(mo){return ni[mo]}).join("="),"=0;","}else{",Fr.map(function(mo,aa){return ni[mo]+"="+nn+".constant.length>"+aa+"?"+nn+".constant["+aa+"]:0;"}).join(""),"}}else{","if(",zr,"(",nn,".buffer)){",To,"=",di,".createStream(",Cp,",",nn,".buffer);","}else{",To,"=",di,".getBuffer(",nn,".buffer);","}",co,'="type" in ',nn,"?",Sr.glTypes,"[",nn,".type]:",To,".dtype;",ni.normalized,"=!!",nn,".normalized;");function So(mo){Zn(ni[mo],"=",nn,".",mo,"|0;")}return So("size"),So("offset"),So("stride"),So("divisor"),Zn("}}"),Zn.exit("if(",ni.isStream,"){",di,".destroyStream(",To,");","}"),ni}br[Vn]=lf(Kn,nr)}),br}function Xl(It,rn){var In=It.static,wr=It.dynamic;if(Tf in In){var br=In[Tf];return br!==null&&Li.getVAO(br)===null&&(br=Li.createVAO(br)),hc(function(Kn){return Kn.link(Li.getVAO(br))})}else if(Tf in wr){var Vn=wr[Tf];return lf(Vn,function(Kn,nr){var bn=Kn.invoke(nr,Vn);return nr.def(Kn.shared.vao+".getVAO("+bn+")")})}return null}function Js(It){var rn=It.static,In=It.dynamic,wr={};return Object.keys(rn).forEach(function(br){var Vn=rn[br];wr[br]=hc(function(Kn,nr){return typeof Vn=="number"||typeof Vn=="boolean"?""+Vn:Kn.link(Vn)})}),Object.keys(In).forEach(function(br){var Vn=In[br];wr[br]=lf(Vn,function(Kn,nr){return Kn.invoke(nr,Vn)})}),wr}function vl(It,rn,In,wr,br){var Vn=It.static,Kn=It.dynamic;ce.optional(function(){var So=[Kc,os,Ns,ga,xl,ih,Ba,a0,Ll,Tf].concat(yi);function mo(aa){Object.keys(aa).forEach(function(Cs){ce.command(So.indexOf(Cs)>=0,'unknown parameter "'+Cs+'"',br.commandStr)})}mo(Vn),mo(Kn)});var nr=da(It,rn),bn=oo(It,br),Zn=Pa(It,bn,br),nn=gs(It,br),Xn=jl(It,br),Sr=oa(It,br,nr);function zr(So){var mo=Zn[So];mo&&(Xn[So]=mo)}zr(ml),zr(qi(Ti));var di=Object.keys(Xn).length>0,ni={framebuffer:bn,draw:nn,shader:Sr,state:Xn,dirty:di,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ni.profile=Ua(It,br),ni.uniforms=eu(In,br),ni.drawVAO=ni.scopeVAO=Xl(It,br),!ni.drawVAO&&Sr.program&&!nr&&Mn.angle_instanced_arrays){var gi=!0,To=Sr.program.attributes.map(function(So){var mo=rn.static[So];return gi=gi&&!!mo,mo});if(gi&&To.length>0){var co=Li.getVAO(Li.createVAO(To));ni.drawVAO=new qc(null,null,null,function(So,mo){return So.link(co)}),ni.useVAO=!0}}return nr?ni.useVAO=!0:ni.attributes=ja(rn,br),ni.context=Js(wr,br),ni}function Yl(It,rn,In){var wr=It.shared,br=wr.context,Vn=It.scope();Object.keys(In).forEach(function(Kn){rn.save(br,"."+Kn);var nr=In[Kn];Vn(br,".",Kn,"=",nr.append(It,rn),";")}),rn(Vn)}function ps(It,rn,In,wr){var br=It.shared,Vn=br.gl,Kn=br.framebuffer,nr;Hi&&(nr=rn.def(br.extensions,".webgl_draw_buffers"));var bn=It.constants,Zn=bn.drawBuffer,nn=bn.backBuffer,Xn;In?Xn=In.append(It,rn):Xn=rn.def(Kn,".next"),wr||rn("if(",Xn,"!==",Kn,".cur){"),rn("if(",Xn,"){",Vn,".bindFramebuffer(",rd,",",Xn,".framebuffer);"),Hi&&rn(nr,".drawBuffersWEBGL(",Zn,"[",Xn,".colorAttachments.length]);"),rn("}else{",Vn,".bindFramebuffer(",rd,",null);"),Hi&&rn(nr,".drawBuffersWEBGL(",nn,");"),rn("}",Kn,".cur=",Xn,";"),wr||rn("}")}function $l(It,rn,In){var wr=It.shared,br=wr.gl,Vn=It.current,Kn=It.next,nr=wr.current,bn=wr.next,Zn=It.cond(nr,".dirty");yi.forEach(function(nn){var Xn=qi(nn);if(!(Xn in In.state)){var Sr,zr;if(Xn in Kn){Sr=Kn[Xn],zr=Vn[Xn];var di=qn(ei[Xn].length,function(gi){return Zn.def(Sr,"[",gi,"]")});Zn(It.cond(di.map(function(gi,To){return gi+"!=="+zr+"["+To+"]"}).join("||")).then(br,".",si[Xn],"(",di,");",di.map(function(gi,To){return zr+"["+To+"]="+gi}).join(";"),";"))}else{Sr=Zn.def(bn,".",Xn);var ni=It.cond(Sr,"!==",nr,".",Xn);Zn(ni),Xn in to?ni(It.cond(Sr).then(br,".enable(",to[Xn],");").else(br,".disable(",to[Xn],");"),nr,".",Xn,"=",Sr,";"):ni(br,".",si[Xn],"(",Sr,");",nr,".",Xn,"=",Sr,";")}}}),Object.keys(In.state).length===0&&Zn(nr,".dirty=false;"),rn(Zn)}function Kl(It,rn,In,wr){var br=It.shared,Vn=It.current,Kn=br.current,nr=br.gl;Md(Object.keys(In)).forEach(function(bn){var Zn=In[bn];if(!(wr&&!wr(Zn))){var nn=Zn.append(It,rn);if(to[bn]){var Xn=to[bn];Qc(Zn)?nn?rn(nr,".enable(",Xn,");"):rn(nr,".disable(",Xn,");"):rn(It.cond(nn).then(nr,".enable(",Xn,");").else(nr,".disable(",Xn,");")),rn(Kn,".",bn,"=",nn,";")}else if(rl(nn)){var Sr=Vn[bn];rn(nr,".",si[bn],"(",nn,");",nn.map(function(zr,di){return Sr+"["+di+"]="+zr}).join(";"),";")}else rn(nr,".",si[bn],"(",nn,");",Kn,".",bn,"=",nn,";")}})}function dc(It,rn){Ci&&(It.instancing=rn.def(It.shared.extensions,".angle_instanced_arrays"))}function Ca(It,rn,In,wr,br){var Vn=It.shared,Kn=It.stats,nr=Vn.current,bn=Vn.timer,Zn=In.profile;function nn(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Xn,Sr;function zr(So){Xn=rn.def(),So(Xn,"=",nn(),";"),typeof br=="string"?So(Kn,".count+=",br,";"):So(Kn,".count++;"),pi&&(wr?(Sr=rn.def(),So(Sr,"=",bn,".getNumPendingQueries();")):So(bn,".beginQuery(",Kn,");"))}function di(So){So(Kn,".cpuTime+=",nn(),"-",Xn,";"),pi&&(wr?So(bn,".pushScopeStats(",Sr,",",bn,".getNumPendingQueries(),",Kn,");"):So(bn,".endQuery();"))}function ni(So){var mo=rn.def(nr,".profile");rn(nr,".profile=",So,";"),rn.exit(nr,".profile=",mo,";")}var gi;if(Zn){if(Qc(Zn)){Zn.enable?(zr(rn),di(rn.exit),ni("true")):ni("false");return}gi=Zn.append(It,rn),ni(gi)}else gi=rn.def(nr,".profile");var To=It.block();zr(To),rn("if(",gi,"){",To,"}");var co=It.block();di(co),rn.exit("if(",gi,"){",co,"}")}function Uc(It,rn,In,wr,br){var Vn=It.shared;function Kn(bn){switch(bn){case u0:case qd:case ah:return 2;case Af:case El:case Cd:return 3;case vm:case Ad:case Jh:return 4;default:return 1}}function nr(bn,Zn,nn){var Xn=Vn.gl,Sr=rn.def(bn,".location"),zr=rn.def(Vn.attributes,"[",Sr,"]"),di=nn.state,ni=nn.buffer,gi=[nn.x,nn.y,nn.z,nn.w],To=["buffer","normalized","offset","stride"];function co(){rn("if(!",zr,".buffer){",Xn,".enableVertexAttribArray(",Sr,");}");var mo=nn.type,aa;if(nn.size?aa=rn.def(nn.size,"||",Zn):aa=Zn,rn("if(",zr,".type!==",mo,"||",zr,".size!==",aa,"||",To.map(function(Ac){return zr+"."+Ac+"!=="+nn[Ac]}).join("||"),"){",Xn,".bindBuffer(",Cp,",",ni,".buffer);",Xn,".vertexAttribPointer(",[Sr,aa,mo,nn.normalized,nn.stride,nn.offset],");",zr,".type=",mo,";",zr,".size=",aa,";",To.map(function(Ac){return zr+"."+Ac+"="+nn[Ac]+";"}).join(""),"}"),Ci){var Cs=nn.divisor;rn("if(",zr,".divisor!==",Cs,"){",It.instancing,".vertexAttribDivisorANGLE(",[Sr,Cs],");",zr,".divisor=",Cs,";}")}}function So(){rn("if(",zr,".buffer){",Xn,".disableVertexAttribArray(",Sr,");",zr,".buffer=null;","}if(",Fr.map(function(mo,aa){return zr+"."+mo+"!=="+gi[aa]}).join("||"),"){",Xn,".vertexAttrib4f(",Sr,",",gi,");",Fr.map(function(mo,aa){return zr+"."+mo+"="+gi[aa]+";"}).join(""),"}")}di===Pi?co():di===vi?So():(rn("if(",di,"===",Pi,"){"),co(),rn("}else{"),So(),rn("}"))}wr.forEach(function(bn){var Zn=bn.name,nn=In.attributes[Zn],Xn;if(nn){if(!br(nn))return;Xn=nn.append(It,rn)}else{if(!br(wu))return;var Sr=It.scopeAttrib(Zn);ce.optional(function(){It.assert(rn,Sr+".state","missing attribute "+Zn)}),Xn={},Object.keys(new ur).forEach(function(zr){Xn[zr]=rn.def(Sr,".",zr)})}nr(It.link(bn),Kn(bn.info.type),Xn)})}function Ms(It,rn,In,wr,br){for(var Vn=It.shared,Kn=Vn.gl,nr,bn=0;bn<wr.length;++bn){var Zn=wr[bn],nn=Zn.name,Xn=Zn.info.type,Sr=In.uniforms[nn],zr=It.link(Zn),di=zr+".location",ni;if(Sr){if(!br(Sr))continue;if(Qc(Sr)){var gi=Sr.value;if(ce.command(gi!==null&&typeof gi!="undefined",'missing uniform "'+nn+'"',It.commandStr),Xn===Qd||Xn===fu){ce.command(typeof gi=="function"&&(Xn===Qd&&(gi._reglType==="texture2d"||gi._reglType==="framebuffer")||Xn===fu&&(gi._reglType==="textureCube"||gi._reglType==="framebufferCube")),"invalid texture for uniform "+nn,It.commandStr);var To=It.link(gi._texture||gi.color[0]._texture);rn(Kn,".uniform1i(",di,",",To+".bind());"),rn.exit(To,".unbind();")}else if(Xn===Pp||Xn===fc||Xn===Uu){ce.optional(function(){ce.command(rl(gi),"invalid matrix for uniform "+nn,It.commandStr),ce.command(Xn===Pp&&gi.length===4||Xn===fc&&gi.length===9||Xn===Uu&&gi.length===16,"invalid length for matrix uniform "+nn,It.commandStr)});var co=It.global.def("new Float32Array(["+Array.prototype.slice.call(gi)+"])"),So=2;Xn===fc?So=3:Xn===Uu&&(So=4),rn(Kn,".uniformMatrix",So,"fv(",di,",false,",co,");")}else{switch(Xn){case c0:ce.commandType(gi,"number","uniform "+nn,It.commandStr),nr="1f";break;case u0:ce.command(rl(gi)&&gi.length===2,"uniform "+nn,It.commandStr),nr="2f";break;case Af:ce.command(rl(gi)&&gi.length===3,"uniform "+nn,It.commandStr),nr="3f";break;case vm:ce.command(rl(gi)&&gi.length===4,"uniform "+nn,It.commandStr),nr="4f";break;case Mp:ce.commandType(gi,"boolean","uniform "+nn,It.commandStr),nr="1i";break;case oc:ce.commandType(gi,"number","uniform "+nn,It.commandStr),nr="1i";break;case ah:ce.command(rl(gi)&&gi.length===2,"uniform "+nn,It.commandStr),nr="2i";break;case qd:ce.command(rl(gi)&&gi.length===2,"uniform "+nn,It.commandStr),nr="2i";break;case Cd:ce.command(rl(gi)&&gi.length===3,"uniform "+nn,It.commandStr),nr="3i";break;case El:ce.command(rl(gi)&&gi.length===3,"uniform "+nn,It.commandStr),nr="3i";break;case Jh:ce.command(rl(gi)&&gi.length===4,"uniform "+nn,It.commandStr),nr="4i";break;case Ad:ce.command(rl(gi)&&gi.length===4,"uniform "+nn,It.commandStr),nr="4i";break}rn(Kn,".uniform",nr,"(",di,",",rl(gi)?Array.prototype.slice.call(gi):gi,");")}continue}else ni=Sr.append(It,rn)}else{if(!br(wu))continue;ni=rn.def(Vn.uniforms,"[",Qt.id(nn),"]")}Xn===Qd?rn("if(",ni,"&&",ni,'._reglType==="framebuffer"){',ni,"=",ni,".color[0];","}"):Xn===fu&&rn("if(",ni,"&&",ni,'._reglType==="framebufferCube"){',ni,"=",ni,".color[0];","}"),ce.optional(function(){function Au(Pd,ip){It.assert(rn,Pd,'bad data or missing for uniform "'+nn+'".  '+ip)}function Sm(Pd){Au("typeof "+ni+'==="'+Pd+'"',"invalid type, expected "+Pd)}function cf(Pd,ip){Au(Vn.isArrayLike+"("+ni+")&&"+ni+".length==="+Pd,"invalid vector, should have length "+Pd,It.commandStr)}function cg(Pd){Au("typeof "+ni+'==="function"&&'+ni+'._reglType==="texture'+(Pd===dv?"2d":"Cube")+'"',"invalid texture type",It.commandStr)}switch(Xn){case oc:Sm("number");break;case qd:cf(2,"number");break;case El:cf(3,"number");break;case Ad:cf(4,"number");break;case c0:Sm("number");break;case u0:cf(2,"number");break;case Af:cf(3,"number");break;case vm:cf(4,"number");break;case Mp:Sm("boolean");break;case ah:cf(2,"boolean");break;case Cd:cf(3,"boolean");break;case Jh:cf(4,"boolean");break;case Pp:cf(4,"number");break;case fc:cf(9,"number");break;case Uu:cf(16,"number");break;case Qd:cg(dv);break;case fu:cg(pm);break}});var mo=1;switch(Xn){case Qd:case fu:var aa=rn.def(ni,"._texture");rn(Kn,".uniform1i(",di,",",aa,".bind());"),rn.exit(aa,".unbind();");continue;case oc:case Mp:nr="1i";break;case qd:case ah:nr="2i",mo=2;break;case El:case Cd:nr="3i",mo=3;break;case Ad:case Jh:nr="4i",mo=4;break;case c0:nr="1f";break;case u0:nr="2f",mo=2;break;case Af:nr="3f",mo=3;break;case vm:nr="4f",mo=4;break;case Pp:nr="Matrix2fv";break;case fc:nr="Matrix3fv";break;case Uu:nr="Matrix4fv";break}if(rn(Kn,".uniform",nr,"(",di,","),nr.charAt(0)==="M"){var Cs=Math.pow(Xn-Pp+2,2),Ac=It.global.def("new Float32Array(",Cs,")");rn("false,(Array.isArray(",ni,")||",ni," instanceof Float32Array)?",ni,":(",qn(Cs,function(Au){return Ac+"["+Au+"]="+ni+"["+Au+"]"}),",",Ac,")")}else mo>1?rn(qn(mo,function(Au){return ni+"["+Au+"]"})):rn(ni);rn(");")}}function Yo(It,rn,In,wr){var br=It.shared,Vn=br.gl,Kn=br.draw,nr=wr.draw;function bn(){var aa=nr.elements,Cs,Ac=rn;return aa?((aa.contextDep&&wr.contextDynamic||aa.propDep)&&(Ac=In),Cs=aa.append(It,Ac)):Cs=Ac.def(Kn,".",ga),Cs&&Ac("if("+Cs+")"+Vn+".bindBuffer("+vy+","+Cs+".buffer.buffer);"),Cs}function Zn(){var aa=nr.count,Cs,Ac=rn;return aa?((aa.contextDep&&wr.contextDynamic||aa.propDep)&&(Ac=In),Cs=aa.append(It,Ac),ce.optional(function(){aa.MISSING&&It.assert(rn,"false","missing vertex count"),aa.DYNAMIC&&It.assert(Ac,Cs+">=0","missing vertex count")})):(Cs=Ac.def(Kn,".",Ba),ce.optional(function(){It.assert(Ac,Cs+">=0","missing vertex count")})),Cs}var nn=bn();function Xn(aa){var Cs=nr[aa];return Cs?Cs.contextDep&&wr.contextDynamic||Cs.propDep?Cs.append(It,In):Cs.append(It,rn):rn.def(Kn,".",aa)}var Sr=Xn(xl),zr=Xn(ih),di=Zn();if(typeof di=="number"){if(di===0)return}else In("if(",di,"){"),In.exit("}");var ni,gi;Ci&&(ni=Xn(a0),gi=It.instancing);var To=nn+".type",co=nr.elements&&Qc(nr.elements);function So(){function aa(){In(gi,".drawElementsInstancedANGLE(",[Sr,di,To,zr+"<<(("+To+"-"+Mi+")>>1)",ni],");")}function Cs(){In(gi,".drawArraysInstancedANGLE(",[Sr,zr,di,ni],");")}nn?co?aa():(In("if(",nn,"){"),aa(),In("}else{"),Cs(),In("}")):Cs()}function mo(){function aa(){In(Vn+".drawElements("+[Sr,di,To,zr+"<<(("+To+"-"+Mi+")>>1)"]+");")}function Cs(){In(Vn+".drawArrays("+[Sr,zr,di]+");")}nn?co?aa():(In("if(",nn,"){"),aa(),In("}else{"),Cs(),In("}")):Cs()}Ci&&(typeof ni!="number"||ni>=0)?typeof ni=="string"?(In("if(",ni,">0){"),So(),In("}else if(",ni,"<0){"),mo(),In("}")):So():mo()}function Ia(It,rn,In,wr,br){var Vn=Zo(),Kn=Vn.proc("body",br);return ce.optional(function(){Vn.commandStr=rn.commandStr,Vn.command=Vn.link(rn.commandStr)}),Ci&&(Vn.instancing=Kn.def(Vn.shared.extensions,".angle_instanced_arrays")),It(Vn,Kn,In,wr),Vn.compile().body}function us(It,rn,In,wr){dc(It,rn),In.useVAO?In.drawVAO?rn(It.shared.vao,".setVAO(",In.drawVAO.append(It,rn),");"):rn(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(rn(It.shared.vao,".setVAO(null);"),Uc(It,rn,In,wr.attributes,function(){return!0})),Ms(It,rn,In,wr.uniforms,function(){return!0}),Yo(It,rn,rn,In)}function Dl(It,rn){var In=It.proc("draw",1);dc(It,In),Yl(It,In,rn.context),ps(It,In,rn.framebuffer),$l(It,In,rn),Kl(It,In,rn.state),Ca(It,In,rn,!1,!0);var wr=rn.shader.progVar.append(It,In);if(In(It.shared.gl,".useProgram(",wr,".program);"),rn.shader.program)us(It,In,rn,rn.shader.program);else{In(It.shared.vao,".setVAO(null);");var br=It.global.def("{}"),Vn=In.def(wr,".id"),Kn=In.def(br,"[",Vn,"]");In(It.cond(Kn).then(Kn,".call(this,a0);").else(Kn,"=",br,"[",Vn,"]=",It.link(function(nr){return Ia(us,It,rn,nr,1)}),"(",wr,");",Kn,".call(this,a0);"))}Object.keys(rn.state).length>0&&In(It.shared.current,".dirty=true;")}function hu(It,rn,In,wr){It.batchId="a1",dc(It,rn);function br(){return!0}Uc(It,rn,In,wr.attributes,br),Ms(It,rn,In,wr.uniforms,br),Yo(It,rn,rn,In)}function dn(It,rn,In,wr){dc(It,rn);var br=In.contextDep,Vn=rn.def(),Kn="a0",nr="a1",bn=rn.def();It.shared.props=bn,It.batchId=Vn;var Zn=It.scope(),nn=It.scope();rn(Zn.entry,"for(",Vn,"=0;",Vn,"<",nr,";++",Vn,"){",bn,"=",Kn,"[",Vn,"];",nn,"}",Zn.exit);function Xn(To){return To.contextDep&&br||To.propDep}function Sr(To){return!Xn(To)}if(In.needsContext&&Yl(It,nn,In.context),In.needsFramebuffer&&ps(It,nn,In.framebuffer),Kl(It,nn,In.state,Xn),In.profile&&Xn(In.profile)&&Ca(It,nn,In,!1,!0),wr)In.useVAO?In.drawVAO?Xn(In.drawVAO)?nn(It.shared.vao,".setVAO(",In.drawVAO.append(It,nn),");"):Zn(It.shared.vao,".setVAO(",In.drawVAO.append(It,Zn),");"):Zn(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(Zn(It.shared.vao,".setVAO(null);"),Uc(It,Zn,In,wr.attributes,Sr),Uc(It,nn,In,wr.attributes,Xn)),Ms(It,Zn,In,wr.uniforms,Sr),Ms(It,nn,In,wr.uniforms,Xn),Yo(It,Zn,nn,In);else{var zr=It.global.def("{}"),di=In.shader.progVar.append(It,nn),ni=nn.def(di,".id"),gi=nn.def(zr,"[",ni,"]");nn(It.shared.gl,".useProgram(",di,".program);","if(!",gi,"){",gi,"=",zr,"[",ni,"]=",It.link(function(To){return Ia(hu,It,In,To,2)}),"(",di,");}",gi,".call(this,a0[",Vn,"],",Vn,");")}}function Pr(It,rn){var In=It.proc("batch",2);It.batchId="0",dc(It,In);var wr=!1,br=!0;Object.keys(rn.context).forEach(function(zr){wr=wr||rn.context[zr].propDep}),wr||(Yl(It,In,rn.context),br=!1);var Vn=rn.framebuffer,Kn=!1;Vn?(Vn.propDep?wr=Kn=!0:Vn.contextDep&&wr&&(Kn=!0),Kn||ps(It,In,Vn)):ps(It,In,null),rn.state.viewport&&rn.state.viewport.propDep&&(wr=!0);function nr(zr){return zr.contextDep&&wr||zr.propDep}$l(It,In,rn),Kl(It,In,rn.state,function(zr){return!nr(zr)}),(!rn.profile||!nr(rn.profile))&&Ca(It,In,rn,!1,"a1"),rn.contextDep=wr,rn.needsContext=br,rn.needsFramebuffer=Kn;var bn=rn.shader.progVar;if(bn.contextDep&&wr||bn.propDep)dn(It,In,rn,null);else{var Zn=bn.append(It,In);if(In(It.shared.gl,".useProgram(",Zn,".program);"),rn.shader.program)dn(It,In,rn,rn.shader.program);else{In(It.shared.vao,".setVAO(null);");var nn=It.global.def("{}"),Xn=In.def(Zn,".id"),Sr=In.def(nn,"[",Xn,"]");In(It.cond(Sr).then(Sr,".call(this,a0,a1);").else(Sr,"=",nn,"[",Xn,"]=",It.link(function(zr){return Ia(dn,It,rn,zr,2)}),"(",Zn,");",Sr,".call(this,a0,a1);"))}}Object.keys(rn.state).length>0&&In(It.shared.current,".dirty=true;")}function pr(It,rn){var In=It.proc("scope",3);It.batchId="a2";var wr=It.shared,br=wr.current;Yl(It,In,rn.context),rn.framebuffer&&rn.framebuffer.append(It,In),Md(Object.keys(rn.state)).forEach(function(Kn){var nr=rn.state[Kn],bn=nr.append(It,In);rl(bn)?bn.forEach(function(Zn,nn){In.set(It.next[Kn],"["+nn+"]",Zn)}):In.set(wr.next,"."+Kn,bn)}),Ca(It,In,rn,!0,!0),[ga,ih,Ba,a0,xl].forEach(function(Kn){var nr=rn.draw[Kn];nr&&In.set(wr.draw,"."+Kn,""+nr.append(It,In))}),Object.keys(rn.uniforms).forEach(function(Kn){In.set(wr.uniforms,"["+Qt.id(Kn)+"]",rn.uniforms[Kn].append(It,In))}),Object.keys(rn.attributes).forEach(function(Kn){var nr=rn.attributes[Kn].append(It,In),bn=It.scopeAttrib(Kn);Object.keys(new ur).forEach(function(Zn){In.set(bn,"."+Zn,nr[Zn])})}),rn.scopeVAO&&In.set(wr.vao,".targetVAO",rn.scopeVAO.append(It,In));function Vn(Kn){var nr=rn.shader[Kn];nr&&In.set(wr.shader,"."+Kn,nr.append(It,In))}Vn(os),Vn(Ns),Object.keys(rn.state).length>0&&(In(br,".dirty=true;"),In.exit(br,".dirty=true;")),In("a1(",It.shared.context,",a0,",It.batchId,");")}function lo(It){if(!(typeof It!="object"||rl(It))){for(var rn=Object.keys(It),In=0;In<rn.length;++In)if(Cn.isDynamic(It[rn[In]]))return!0;return!1}}function Fa(It,rn,In){var wr=rn.static[In];if(!wr||!lo(wr))return;var br=It.global,Vn=Object.keys(wr),Kn=!1,nr=!1,bn=!1,Zn=It.global.def("{}");Vn.forEach(function(Xn){var Sr=wr[Xn];if(Cn.isDynamic(Sr)){typeof Sr=="function"&&(Sr=wr[Xn]=Cn.unbox(Sr));var zr=lf(Sr,null);Kn=Kn||zr.thisDep,bn=bn||zr.propDep,nr=nr||zr.contextDep}else{switch(br(Zn,".",Xn,"="),typeof Sr){case"number":br(Sr);break;case"string":br('"',Sr,'"');break;case"object":Array.isArray(Sr)&&br("[",Sr.join(),"]");break;default:br(It.link(Sr));break}br(";")}});function nn(Xn,Sr){Vn.forEach(function(zr){var di=wr[zr];if(Cn.isDynamic(di)){var ni=Xn.invoke(Sr,di);Sr(Zn,".",zr,"=",ni,";")}})}rn.dynamic[In]=new Cn.DynamicVariable(Cr,{thisDep:Kn,contextDep:nr,propDep:bn,ref:Zn,append:nn}),delete rn.static[In]}function as(It,rn,In,wr,br){var Vn=Zo();Vn.stats=Vn.link(br),Object.keys(rn.static).forEach(function(nr){Fa(Vn,rn,nr)}),dm.forEach(function(nr){Fa(Vn,It,nr)});var Kn=vl(It,rn,In,wr,Vn);return Dl(Vn,Kn),pr(Vn,Kn),Pr(Vn,Kn),Vn.compile()}return{next:ro,current:ei,procs:function(){var It=Zo(),rn=It.proc("poll"),In=It.proc("refresh"),wr=It.block();rn(wr),In(wr);var br=It.shared,Vn=br.gl,Kn=br.next,nr=br.current;wr(nr,".dirty=false;"),ps(It,rn),ps(It,In,null,!0);var bn;Ci&&(bn=It.link(Ci)),Mn.oes_vertex_array_object&&In(It.link(Mn.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Zn=0;Zn<Ar.maxAttributes;++Zn){var nn=In.def(br.attributes,"[",Zn,"]"),Xn=It.cond(nn,".buffer");Xn.then(Vn,".enableVertexAttribArray(",Zn,");",Vn,".bindBuffer(",Cp,",",nn,".buffer.buffer);",Vn,".vertexAttribPointer(",Zn,",",nn,".size,",nn,".type,",nn,".normalized,",nn,".stride,",nn,".offset);").else(Vn,".disableVertexAttribArray(",Zn,");",Vn,".vertexAttrib4f(",Zn,",",nn,".x,",nn,".y,",nn,".z,",nn,".w);",nn,".buffer=null;"),In(Xn),Ci&&In(bn,".vertexAttribDivisorANGLE(",Zn,",",nn,".divisor);")}return In(It.shared.vao,".currentVAO=null;",It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"),Object.keys(to).forEach(function(Sr){var zr=to[Sr],di=wr.def(Kn,".",Sr),ni=It.block();ni("if(",di,"){",Vn,".enable(",zr,")}else{",Vn,".disable(",zr,")}",nr,".",Sr,"=",di,";"),In(ni),rn("if(",di,"!==",nr,".",Sr,"){",ni,"}")}),Object.keys(si).forEach(function(Sr){var zr=si[Sr],di=ei[Sr],ni,gi,To=It.block();if(To(Vn,".",zr,"("),rl(di)){var co=di.length;ni=It.global.def(Kn,".",Sr),gi=It.global.def(nr,".",Sr),To(qn(co,function(So){return ni+"["+So+"]"}),");",qn(co,function(So){return gi+"["+So+"]="+ni+"["+So+"];"}).join("")),rn("if(",qn(co,function(So){return ni+"["+So+"]!=="+gi+"["+So+"]"}).join("||"),"){",To,"}")}else ni=wr.def(Kn,".",Sr),gi=wr.def(nr,".",Sr),To(ni,");",nr,".",Sr,"=",ni,";"),rn("if(",ni,"!==",gi,"){",To,"}");In(To)}),It.compile()}(),compile:as}}function bv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var by=34918,lg=34919,ym=35007,_m=function(Ue,Qt){if(!Qt.ext_disjoint_timer_query)return null;var Mn=[];function Ar(){return Mn.pop()||Qt.ext_disjoint_timer_query.createQueryEXT()}function $r(Ci){Mn.push(Ci)}var Or=[];function yr(Ci){var Hi=Ar();Qt.ext_disjoint_timer_query.beginQueryEXT(ym,Hi),Or.push(Hi),pi(Or.length-1,Or.length,Ci)}function Ai(){Qt.ext_disjoint_timer_query.endQueryEXT(ym)}function fi(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Li=[];function wi(){return Li.pop()||new fi}function Ni(Ci){Li.push(Ci)}var Yi=[];function pi(Ci,Hi,ei){var ro=wi();ro.startQueryIndex=Ci,ro.endQueryIndex=Hi,ro.sum=0,ro.stats=ei,Yi.push(ro)}var Fi=[],ur=[];function Nr(){var Ci,Hi,ei=Or.length;if(ei!==0){ur.length=Math.max(ur.length,ei+1),Fi.length=Math.max(Fi.length,ei+1),Fi[0]=0,ur[0]=0;var ro=0;for(Ci=0,Hi=0;Hi<Or.length;++Hi){var yi=Or[Hi];Qt.ext_disjoint_timer_query.getQueryObjectEXT(yi,lg)?(ro+=Qt.ext_disjoint_timer_query.getQueryObjectEXT(yi,by),$r(yi)):Or[Ci++]=yi,Fi[Hi+1]=ro,ur[Hi+1]=Ci}for(Or.length=Ci,Ci=0,Hi=0;Hi<Yi.length;++Hi){var to=Yi[Hi],si=to.startQueryIndex,qi=to.endQueryIndex;to.sum+=Fi[qi]-Fi[si];var Go=ur[si],fa=ur[qi];fa===Go?(to.stats.gpuTime+=to.sum/1e6,Ni(to)):(to.startQueryIndex=Go,to.endQueryIndex=fa,Yi[Ci++]=to)}Yi.length=Ci}}return{beginQuery:yr,endQuery:Ai,pushScopeStats:pi,update:Nr,getNumPendingQueries:function(){return Or.length},clear:function(){Mn.push.apply(Mn,Or);for(var Ci=0;Ci<Mn.length;Ci++)Qt.ext_disjoint_timer_query.deleteQueryEXT(Mn[Ci]);Or.length=0,Mn.length=0},restore:function(){Or.length=0,Mn.length=0}}},xv=16384,Jc=256,bm=1024,H0=34962,Ev="webglcontextlost",Sl="webglcontextrestored",wc=1,Ip=2,xm=3;function Em(Ue,Qt){for(var Mn=0;Mn<Ue.length;++Mn)if(Ue[Mn]===Qt)return Mn;return-1}function Sv(Ue){var Qt=$n(Ue);if(!Qt)return null;var Mn=Qt.gl,Ar=Mn.getContextAttributes(),$r=Mn.isContextLost(),Or=xr(Mn,Qt);if(!Or)return null;var yr=dt(),Ai=bv(),fi=Or.extensions,Li=_m(Mn,fi),wi=Gn(),Ni=Mn.drawingBufferWidth,Yi=Mn.drawingBufferHeight,pi={tick:0,time:0,viewportWidth:Ni,viewportHeight:Yi,framebufferWidth:Ni,framebufferHeight:Yi,drawingBufferWidth:Ni,drawingBufferHeight:Yi,pixelRatio:Qt.pixelRatio},Fi={},ur={elements:null,primitive:4,count:-1,offset:0,instances:-1},Nr=Ga(Mn,fi),Ci=Kf(Mn,Ai,Qt,ei),Hi=it(Mn,fi,Nr,Ai,Ci);function ei(Yo){return Hi.destroyBuffer(Yo)}var ro=Hh(Mn,fi,Ci,Ai),yi=yn(Mn,yr,Ai,Qt),to=af(Mn,fi,Nr,function(){Go.procs.poll()},pi,Ai,Qt),si=nh(Mn,fi,Nr,Ai,Qt),qi=G(Mn,fi,Nr,to,si,Ai),Go=rp(Mn,yr,fi,Nr,Ci,ro,to,qi,Fi,Hi,yi,ur,pi,Li,Qt),fa=hr(Mn,qi,Go.procs.poll,pi,Ar,fi,Nr),$i=Go.next,_i=Mn.canvas,qr=[],Zo=[],Ua=[],oo=[Qt.onDestroy],Pa=null;function da(){if(qr.length===0){Li&&Li.update(),Pa=null;return}Pa=Ln.next(da),Kl();for(var Yo=qr.length-1;Yo>=0;--Yo){var Ia=qr[Yo];Ia&&Ia(pi,null,0)}Mn.flush(),Li&&Li.update()}function oa(){!Pa&&qr.length>0&&(Pa=Ln.next(da))}function gs(){Pa&&(Ln.cancel(da),Pa=null)}function jl(Yo){Yo.preventDefault(),$r=!0,gs(),Zo.forEach(function(Ia){Ia()})}function eu(Yo){Mn.getError(),$r=!1,Or.restore(),yi.restore(),Ci.restore(),to.restore(),si.restore(),qi.restore(),Hi.restore(),Li&&Li.restore(),Go.procs.refresh(),oa(),Ua.forEach(function(Ia){Ia()})}_i&&(_i.addEventListener(Ev,jl,!1),_i.addEventListener(Sl,eu,!1));function ja(){qr.length=0,gs(),_i&&(_i.removeEventListener(Ev,jl),_i.removeEventListener(Sl,eu)),yi.clear(),qi.clear(),si.clear(),to.clear(),ro.clear(),Ci.clear(),Hi.clear(),Li&&Li.clear(),oo.forEach(function(Yo){Yo()})}function Xl(Yo){ce(!!Yo,"invalid args to regl({...})"),ce.type(Yo,"object","invalid args to regl({...})");function Ia(br){var Vn=D({},br);delete Vn.uniforms,delete Vn.attributes,delete Vn.context,delete Vn.vao,"stencil"in Vn&&Vn.stencil.op&&(Vn.stencil.opBack=Vn.stencil.opFront=Vn.stencil.op,delete Vn.stencil.op);function Kn(nr){if(nr in Vn){var bn=Vn[nr];delete Vn[nr],Object.keys(bn).forEach(function(Zn){Vn[nr+"."+Zn]=bn[Zn]})}}return Kn("blend"),Kn("depth"),Kn("cull"),Kn("stencil"),Kn("polygonOffset"),Kn("scissor"),Kn("sample"),"vao"in br&&(Vn.vao=br.vao),Vn}function us(br){var Vn={},Kn={};return Object.keys(br).forEach(function(nr){var bn=br[nr];Cn.isDynamic(bn)?Kn[nr]=Cn.unbox(bn,nr):Vn[nr]=bn}),{dynamic:Kn,static:Vn}}var Dl=us(Yo.context||{}),hu=us(Yo.uniforms||{}),dn=us(Yo.attributes||{}),Pr=us(Ia(Yo)),pr={gpuTime:0,cpuTime:0,count:0},lo=Go.compile(Pr,dn,hu,Dl,pr),Fa=lo.draw,as=lo.batch,It=lo.scope,rn=[];function In(br){for(;rn.length<br;)rn.push(null);return rn}function wr(br,Vn){var Kn;if($r&&ce.raise("context lost"),typeof br=="function")return It.call(this,null,br,0);if(typeof Vn=="function")if(typeof br=="number")for(Kn=0;Kn<br;++Kn)It.call(this,null,Vn,Kn);else if(Array.isArray(br))for(Kn=0;Kn<br.length;++Kn)It.call(this,br[Kn],Vn,Kn);else return It.call(this,br,Vn,0);else if(typeof br=="number"){if(br>0)return as.call(this,In(br|0),br|0)}else if(Array.isArray(br)){if(br.length)return as.call(this,br,br.length)}else return Fa.call(this,br)}return D(wr,{stats:pr})}var Js=qi.setFBO=Xl({framebuffer:Cn.define.call(null,wc,"framebuffer")});function vl(Yo,Ia){var us=0;Go.procs.poll();var Dl=Ia.color;Dl&&(Mn.clearColor(+Dl[0]||0,+Dl[1]||0,+Dl[2]||0,+Dl[3]||0),us|=xv),"depth"in Ia&&(Mn.clearDepth(+Ia.depth),us|=Jc),"stencil"in Ia&&(Mn.clearStencil(Ia.stencil|0),us|=bm),ce(!!us,"called regl.clear with no buffer specified"),Mn.clear(us)}function Yl(Yo){if(ce(typeof Yo=="object"&&Yo,"regl.clear() takes an object as input"),"framebuffer"in Yo)if(Yo.framebuffer&&Yo.framebuffer_reglType==="framebufferCube")for(var Ia=0;Ia<6;++Ia)Js(D({framebuffer:Yo.framebuffer.faces[Ia]},Yo),vl);else Js(Yo,vl);else vl(null,Yo)}function ps(Yo){ce.type(Yo,"function","regl.frame() callback must be a function"),qr.push(Yo);function Ia(){var us=Em(qr,Yo);ce(us>=0,"cannot cancel a frame twice");function Dl(){var hu=Em(qr,Dl);qr[hu]=qr[qr.length-1],qr.length-=1,qr.length<=0&&gs()}qr[us]=Dl}return oa(),{cancel:Ia}}function $l(){var Yo=$i.viewport,Ia=$i.scissor_box;Yo[0]=Yo[1]=Ia[0]=Ia[1]=0,pi.viewportWidth=pi.framebufferWidth=pi.drawingBufferWidth=Yo[2]=Ia[2]=Mn.drawingBufferWidth,pi.viewportHeight=pi.framebufferHeight=pi.drawingBufferHeight=Yo[3]=Ia[3]=Mn.drawingBufferHeight}function Kl(){pi.tick+=1,pi.time=Ca(),$l(),Go.procs.poll()}function dc(){$l(),Go.procs.refresh(),Li&&Li.update()}function Ca(){return(Gn()-wi)/1e3}dc();function Uc(Yo,Ia){ce.type(Ia,"function","listener callback must be a function");var us;switch(Yo){case"frame":return ps(Ia);case"lost":us=Zo;break;case"restore":us=Ua;break;case"destroy":us=oo;break;default:ce.raise("invalid event, must be one of frame,lost,restore,destroy")}return us.push(Ia),{cancel:function(){for(var Dl=0;Dl<us.length;++Dl)if(us[Dl]===Ia){us[Dl]=us[us.length-1],us.pop();return}}}}var Ms=D(Xl,{clear:Yl,prop:Cn.define.bind(null,wc),context:Cn.define.bind(null,Ip),this:Cn.define.bind(null,xm),draw:Xl({}),buffer:function(Yo){return Ci.create(Yo,H0,!1,!1)},elements:function(Yo){return ro.create(Yo,!1)},texture:to.create2D,cube:to.createCube,renderbuffer:si.create,framebuffer:qi.create,framebufferCube:qi.createCube,vao:Hi.createVAO,attributes:Ar,frame:ps,on:Uc,limits:Nr,hasExtension:function(Yo){return Nr.extensions.indexOf(Yo.toLowerCase())>=0},read:fa,destroy:ja,_gl:Mn,_refresh:dc,poll:function(){Kl(),Li&&Li.update()},now:Ca,stats:Ai});return Qt.onDone(null,Ms),Ms}return Sv})},86851:function($t,W,D){"use strict";var ee=D(89594),X=Array.prototype.concat,E=Array.prototype.slice,_e=$t.exports=function(he){for(var se=[],Se=0,oe=he.length;Se<oe;Se++){var je=he[Se];ee(je)?se=X.call(se,E.call(je)):se.push(je)}return se};_e.wrap=function(re){return function(){return re(_e(arguments))}}},89594:function($t){$t.exports=function(D){return!D||typeof D=="string"?!1:D instanceof Array||Array.isArray(D)||D.length>=0&&(D.splice instanceof Function||Object.getOwnPropertyDescriptor(D,D.length-1)&&D.constructor.name!=="String")}},69848:function($t){(function(W,D){$t.exports=D()})(this,function(){"use strict";function W(ke,Re,bt,gt,Ct,Sn){if(!(Ct-gt<=bt)){var He=gt+Ct>>1;D(ke,Re,He,gt,Ct,Sn%2),W(ke,Re,bt,gt,He-1,Sn+1),W(ke,Re,bt,He+1,Ct,Sn+1)}}function D(ke,Re,bt,gt,Ct,Sn){for(;Ct>gt;){if(Ct-gt>600){var He=Ct-gt+1,Ot=bt-gt+1,Ce=Math.log(He),ot=.5*Math.exp(2*Ce/3),$e=.5*Math.sqrt(Ce*ot*(He-ot)/He)*(Ot-He/2<0?-1:1),Xe=Math.max(gt,Math.floor(bt-Ot*ot/He+$e)),Rt=Math.min(Ct,Math.floor(bt+(He-Ot)*ot/He+$e));D(ke,Re,bt,Xe,Rt,Sn)}var _t=Re[2*bt+Sn],Pe=gt,Wt=Ct;for(ee(ke,Re,gt,bt),Re[2*Ct+Sn]>_t&&ee(ke,Re,gt,Ct);Pe<Wt;){for(ee(ke,Re,Pe,Wt),Pe++,Wt--;Re[2*Pe+Sn]<_t;)Pe++;for(;Re[2*Wt+Sn]>_t;)Wt--}Re[2*gt+Sn]===_t?ee(ke,Re,gt,Wt):(Wt++,ee(ke,Re,Wt,Ct)),Wt<=bt&&(gt=Wt+1),bt<=Wt&&(Ct=Wt-1)}}function ee(ke,Re,bt,gt){X(ke,bt,gt),X(Re,2*bt,2*gt),X(Re,2*bt+1,2*gt+1)}function X(ke,Re,bt){var gt=ke[Re];ke[Re]=ke[bt],ke[bt]=gt}function E(ke,Re,bt,gt,Ct,Sn,He){for(var Ot=[0,ke.length-1,0],Ce=[],ot,$e;Ot.length;){var Xe=Ot.pop(),Rt=Ot.pop(),_t=Ot.pop();if(Rt-_t<=He){for(var Pe=_t;Pe<=Rt;Pe++)ot=Re[2*Pe],$e=Re[2*Pe+1],ot>=bt&&ot<=Ct&&$e>=gt&&$e<=Sn&&Ce.push(ke[Pe]);continue}var Wt=Math.floor((_t+Rt)/2);ot=Re[2*Wt],$e=Re[2*Wt+1],ot>=bt&&ot<=Ct&&$e>=gt&&$e<=Sn&&Ce.push(ke[Wt]);var on=(Xe+1)%2;(Xe===0?bt<=ot:gt<=$e)&&(Ot.push(_t),Ot.push(Wt-1),Ot.push(on)),(Xe===0?Ct>=ot:Sn>=$e)&&(Ot.push(Wt+1),Ot.push(Rt),Ot.push(on))}return Ce}function _e(ke,Re,bt,gt,Ct,Sn){for(var He=[0,ke.length-1,0],Ot=[],Ce=Ct*Ct;He.length;){var ot=He.pop(),$e=He.pop(),Xe=He.pop();if($e-Xe<=Sn){for(var Rt=Xe;Rt<=$e;Rt++)re(Re[2*Rt],Re[2*Rt+1],bt,gt)<=Ce&&Ot.push(ke[Rt]);continue}var _t=Math.floor((Xe+$e)/2),Pe=Re[2*_t],Wt=Re[2*_t+1];re(Pe,Wt,bt,gt)<=Ce&&Ot.push(ke[_t]);var on=(ot+1)%2;(ot===0?bt-Ct<=Pe:gt-Ct<=Wt)&&(He.push(Xe),He.push(_t-1),He.push(on)),(ot===0?bt+Ct>=Pe:gt+Ct>=Wt)&&(He.push(_t+1),He.push($e),He.push(on))}return Ot}function re(ke,Re,bt,gt){var Ct=ke-bt,Sn=Re-gt;return Ct*Ct+Sn*Sn}var he=function(ke){return ke[0]},se=function(ke){return ke[1]},Se=function(Re,bt,gt,Ct,Sn){bt===void 0&&(bt=he),gt===void 0&&(gt=se),Ct===void 0&&(Ct=64),Sn===void 0&&(Sn=Float64Array),this.nodeSize=Ct,this.points=Re;for(var He=Re.length<65536?Uint16Array:Uint32Array,Ot=this.ids=new He(Re.length),Ce=this.coords=new Sn(Re.length*2),ot=0;ot<Re.length;ot++)Ot[ot]=ot,Ce[2*ot]=bt(Re[ot]),Ce[2*ot+1]=gt(Re[ot]);W(Ot,Ce,Ct,0,Ot.length-1,0)};Se.prototype.range=function(Re,bt,gt,Ct){return E(this.ids,this.coords,Re,bt,gt,Ct,this.nodeSize)},Se.prototype.within=function(Re,bt,gt){return _e(this.ids,this.coords,Re,bt,gt,this.nodeSize)};var oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ke){return ke}},je=Math.fround||function(ke){return function(Re){return ke[0]=+Re,ke[0]}}(new Float32Array(1)),te=function(Re){this.options=Zt(Object.create(oe),Re),this.trees=new Array(this.options.maxZoom+1)};te.prototype.load=function(Re){var bt=this.options,gt=bt.log,Ct=bt.minZoom,Sn=bt.maxZoom,He=bt.nodeSize;gt&&console.time("total time");var Ot="prepare "+Re.length+" points";gt&&console.time(Ot),this.points=Re;for(var Ce=[],ot=0;ot<Re.length;ot++)Re[ot].geometry&&Ce.push(Be(Re[ot],ot));this.trees[Sn+1]=new Se(Ce,pt,vt,He,Float32Array),gt&&console.timeEnd(Ot);for(var $e=Sn;$e>=Ct;$e--){var Xe=+Date.now();Ce=this._cluster(Ce,$e),this.trees[$e]=new Se(Ce,pt,vt,He,Float32Array),gt&&console.log("z%d: %d clusters in %dms",$e,Ce.length,+Date.now()-Xe)}return gt&&console.timeEnd("total time"),this},te.prototype.getClusters=function(Re,bt){var gt=((Re[0]+180)%360+360)%360-180,Ct=Math.max(-90,Math.min(90,Re[1])),Sn=Re[2]===180?180:((Re[2]+180)%360+360)%360-180,He=Math.max(-90,Math.min(90,Re[3]));if(Re[2]-Re[0]>=360)gt=-180,Sn=180;else if(gt>Sn){var Ot=this.getClusters([gt,Ct,180,He],bt),Ce=this.getClusters([-180,Ct,Sn,He],bt);return Ot.concat(Ce)}for(var ot=this.trees[this._limitZoom(bt)],$e=ot.range(le(gt),Ze(He),le(Sn),Ze(Ct)),Xe=[],Rt=0,_t=$e;Rt<_t.length;Rt+=1){var Pe=_t[Rt],Wt=ot.points[Pe];Xe.push(Wt.numPoints?Te(Wt):this.points[Wt.index])}return Xe},te.prototype.getChildren=function(Re){var bt=this._getOriginId(Re),gt=this._getOriginZoom(Re),Ct="No cluster with the specified id.",Sn=this.trees[gt];if(!Sn)throw new Error(Ct);var He=Sn.points[bt];if(!He)throw new Error(Ct);for(var Ot=this.options.radius/(this.options.extent*Math.pow(2,gt-1)),Ce=Sn.within(He.x,He.y,Ot),ot=[],$e=0,Xe=Ce;$e<Xe.length;$e+=1){var Rt=Xe[$e],_t=Sn.points[Rt];_t.parentId===Re&&ot.push(_t.numPoints?Te(_t):this.points[_t.index])}if(ot.length===0)throw new Error(Ct);return ot},te.prototype.getLeaves=function(Re,bt,gt){bt=bt||10,gt=gt||0;var Ct=[];return this._appendLeaves(Ct,Re,bt,gt,0),Ct},te.prototype.getTile=function(Re,bt,gt){var Ct=this.trees[this._limitZoom(Re)],Sn=Math.pow(2,Re),He=this.options,Ot=He.extent,Ce=He.radius,ot=Ce/Ot,$e=(gt-ot)/Sn,Xe=(gt+1+ot)/Sn,Rt={features:[]};return this._addTileFeatures(Ct.range((bt-ot)/Sn,$e,(bt+1+ot)/Sn,Xe),Ct.points,bt,gt,Sn,Rt),bt===0&&this._addTileFeatures(Ct.range(1-ot/Sn,$e,1,Xe),Ct.points,Sn,gt,Sn,Rt),bt===Sn-1&&this._addTileFeatures(Ct.range(0,$e,ot/Sn,Xe),Ct.points,-1,gt,Sn,Rt),Rt.features.length?Rt:null},te.prototype.getClusterExpansionZoom=function(Re){for(var bt=this._getOriginZoom(Re)-1;bt<=this.options.maxZoom;){var gt=this.getChildren(Re);if(bt++,gt.length!==1)break;Re=gt[0].properties.cluster_id}return bt},te.prototype._appendLeaves=function(Re,bt,gt,Ct,Sn){for(var He=this.getChildren(bt),Ot=0,Ce=He;Ot<Ce.length;Ot+=1){var ot=Ce[Ot],$e=ot.properties;if($e&&$e.cluster?Sn+$e.point_count<=Ct?Sn+=$e.point_count:Sn=this._appendLeaves(Re,$e.cluster_id,gt,Ct,Sn):Sn<Ct?Sn++:Re.push(ot),Re.length===gt)break}return Sn},te.prototype._addTileFeatures=function(Re,bt,gt,Ct,Sn,He){for(var Ot=0,Ce=Re;Ot<Ce.length;Ot+=1){var ot=Ce[Ot],$e=bt[ot],Xe=$e.numPoints,Rt=void 0,_t=void 0,Pe=void 0;if(Xe)Rt=we($e),_t=$e.x,Pe=$e.y;else{var Wt=this.points[$e.index];Rt=Wt.properties,_t=le(Wt.geometry.coordinates[0]),Pe=Ze(Wt.geometry.coordinates[1])}var on={type:1,geometry:[[Math.round(this.options.extent*(_t*Sn-gt)),Math.round(this.options.extent*(Pe*Sn-Ct))]],tags:Rt},Nn=void 0;Xe?Nn=$e.id:this.options.generateId?Nn=$e.index:this.points[$e.index].id&&(Nn=this.points[$e.index].id),Nn!==void 0&&(on.id=Nn),He.features.push(on)}},te.prototype._limitZoom=function(Re){return Math.max(this.options.minZoom,Math.min(Math.floor(+Re),this.options.maxZoom+1))},te.prototype._cluster=function(Re,bt){for(var gt=[],Ct=this.options,Sn=Ct.radius,He=Ct.extent,Ot=Ct.reduce,Ce=Ct.minPoints,ot=Sn/(He*Math.pow(2,bt)),$e=0;$e<Re.length;$e++){var Xe=Re[$e];if(!(Xe.zoom<=bt)){Xe.zoom=bt;for(var Rt=this.trees[bt+1],_t=Rt.within(Xe.x,Xe.y,ot),Pe=Xe.numPoints||1,Wt=Pe,on=0,Nn=_t;on<Nn.length;on+=1){var jn=Nn[on],lr=Rt.points[jn];lr.zoom>bt&&(Wt+=lr.numPoints||1)}if(Wt>Pe&&Wt>=Ce){for(var Vt=Xe.x*Pe,en=Xe.y*Pe,xn=Ot&&Pe>1?this._map(Xe,!0):null,er=($e<<5)+(bt+1)+this.points.length,sn=0,Ut=_t;sn<Ut.length;sn+=1){var Dt=Ut[sn],Me=Rt.points[Dt];if(!(Me.zoom<=bt)){Me.zoom=bt;var Qe=Me.numPoints||1;Vt+=Me.x*Qe,en+=Me.y*Qe,Me.parentId=er,Ot&&(xn||(xn=this._map(Xe,!0)),Ot(xn,this._map(Me)))}}Xe.parentId=er,gt.push(ve(Vt/Wt,en/Wt,er,Wt,xn))}else if(gt.push(Xe),Wt>1)for(var Ft=0,U=_t;Ft<U.length;Ft+=1){var ue=U[Ft],at=Rt.points[ue];at.zoom<=bt||(at.zoom=bt,gt.push(at))}}}return gt},te.prototype._getOriginId=function(Re){return Re-this.points.length>>5},te.prototype._getOriginZoom=function(Re){return(Re-this.points.length)%32},te.prototype._map=function(Re,bt){if(Re.numPoints)return bt?Zt({},Re.properties):Re.properties;var gt=this.points[Re.index].properties,Ct=this.options.map(gt);return bt&&Ct===gt?Zt({},Ct):Ct};function ve(ke,Re,bt,gt,Ct){return{x:je(ke),y:je(Re),zoom:1/0,id:bt,parentId:-1,numPoints:gt,properties:Ct}}function Be(ke,Re){var bt=ke.geometry.coordinates,gt=bt[0],Ct=bt[1];return{x:je(le(gt)),y:je(Ze(Ct)),zoom:1/0,index:Re,parentId:-1}}function Te(ke){return{type:"Feature",id:ke.id,properties:we(ke),geometry:{type:"Point",coordinates:[xt(ke.x),ft(ke.y)]}}}function we(ke){var Re=ke.numPoints,bt=Re>=1e4?Math.round(Re/1e3)+"k":Re>=1e3?Math.round(Re/100)/10+"k":Re;return Zt(Zt({},ke.properties),{cluster:!0,cluster_id:ke.id,point_count:Re,point_count_abbreviated:bt})}function le(ke){return ke/360+.5}function Ze(ke){var Re=Math.sin(ke*Math.PI/180),bt=.5-.25*Math.log((1+Re)/(1-Re))/Math.PI;return bt<0?0:bt>1?1:bt}function xt(ke){return(ke-.5)*360}function ft(ke){var Re=(180-ke*360)*Math.PI/180;return 360*Math.atan(Math.exp(Re))/Math.PI-90}function Zt(ke,Re){for(var bt in Re)ke[bt]=Re[bt];return ke}function pt(ke){return ke.x}function vt(ke){return ke.y}return te})},63405:function($t,W,D){var ee=D(73897);function X(E){if(Array.isArray(E))return ee(E)}$t.exports=X,$t.exports.__esModule=!0,$t.exports.default=$t.exports},79498:function($t){function W(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}$t.exports=W,$t.exports.__esModule=!0,$t.exports.default=$t.exports},42281:function($t){function W(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}$t.exports=W,$t.exports.__esModule=!0,$t.exports.default=$t.exports},51589:function($t,W,D){var ee=D(85372),X=D(79498),E=D(86116),_e=D(12218);function re(he){return ee(he)||X(he)||E(he)||_e()}$t.exports=re,$t.exports.__esModule=!0,$t.exports.default=$t.exports},861:function($t,W,D){var ee=D(63405),X=D(79498),E=D(86116),_e=D(42281);function re(he){return ee(he)||X(he)||E(he)||_e()}$t.exports=re,$t.exports.__esModule=!0,$t.exports.default=$t.exports},1449:function($t,W,D){"use strict";D.d(W,{Tu:function(){return te},tw:function(){return le},uf:function(){return Be},yu:function(){return oe},zL:function(){return re}});var ee=63710088e-1,X={centimeters:ee*100,centimetres:ee*100,degrees:ee/111325,feet:ee*3.28084,inches:ee*39.37,kilometers:ee/1e3,kilometres:ee/1e3,meters:ee,metres:ee,miles:ee/1609.344,millimeters:ee*1e3,millimetres:ee*1e3,nauticalmiles:ee/1852,radians:1,yards:ee*1.0936},E={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ee,yards:1.0936133},_e={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function re(Ce,ot,$e){$e===void 0&&($e={});var Xe={type:"Feature"};return($e.id===0||$e.id)&&(Xe.id=$e.id),$e.bbox&&(Xe.bbox=$e.bbox),Xe.properties=ot||{},Xe.geometry=Ce,Xe}function he(Ce,ot,$e){switch($e===void 0&&($e={}),Ce){case"Point":return se(ot).geometry;case"LineString":return te(ot).geometry;case"Polygon":return oe(ot).geometry;case"MultiPoint":return we(ot).geometry;case"MultiLineString":return Te(ot).geometry;case"MultiPolygon":return le(ot).geometry;default:throw new Error(Ce+" is invalid")}}function se(Ce,ot,$e){if($e===void 0&&($e={}),!Ce)throw new Error("coordinates is required");if(!Array.isArray(Ce))throw new Error("coordinates must be an Array");if(Ce.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ct(Ce[0])||!Ct(Ce[1]))throw new Error("coordinates must contain numbers");var Xe={type:"Point",coordinates:Ce};return re(Xe,ot,$e)}function Se(Ce,ot,$e){return $e===void 0&&($e={}),Be(Ce.map(function(Xe){return se(Xe,ot)}),$e)}function oe(Ce,ot,$e){$e===void 0&&($e={});for(var Xe=0,Rt=Ce;Xe<Rt.length;Xe++){var _t=Rt[Xe];if(_t.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Pe=0;Pe<_t[_t.length-1].length;Pe++)if(_t[_t.length-1][Pe]!==_t[0][Pe])throw new Error("First and last Position are not equivalent.")}var Wt={type:"Polygon",coordinates:Ce};return re(Wt,ot,$e)}function je(Ce,ot,$e){return $e===void 0&&($e={}),Be(Ce.map(function(Xe){return oe(Xe,ot)}),$e)}function te(Ce,ot,$e){if($e===void 0&&($e={}),Ce.length<2)throw new Error("coordinates must be an array of two or more positions");var Xe={type:"LineString",coordinates:Ce};return re(Xe,ot,$e)}function ve(Ce,ot,$e){return $e===void 0&&($e={}),Be(Ce.map(function(Xe){return te(Xe,ot)}),$e)}function Be(Ce,ot){ot===void 0&&(ot={});var $e={type:"FeatureCollection"};return ot.id&&($e.id=ot.id),ot.bbox&&($e.bbox=ot.bbox),$e.features=Ce,$e}function Te(Ce,ot,$e){$e===void 0&&($e={});var Xe={type:"MultiLineString",coordinates:Ce};return re(Xe,ot,$e)}function we(Ce,ot,$e){$e===void 0&&($e={});var Xe={type:"MultiPoint",coordinates:Ce};return re(Xe,ot,$e)}function le(Ce,ot,$e){$e===void 0&&($e={});var Xe={type:"MultiPolygon",coordinates:Ce};return re(Xe,ot,$e)}function Ze(Ce,ot,$e){$e===void 0&&($e={});var Xe={type:"GeometryCollection",geometries:Ce};return re(Xe,ot,$e)}function xt(Ce,ot){if(ot===void 0&&(ot=0),ot&&!(ot>=0))throw new Error("precision must be a positive number");var $e=Math.pow(10,ot||0);return Math.round(Ce*$e)/$e}function ft(Ce,ot){ot===void 0&&(ot="kilometers");var $e=X[ot];if(!$e)throw new Error(ot+" units is invalid");return Ce*$e}function Zt(Ce,ot){ot===void 0&&(ot="kilometers");var $e=X[ot];if(!$e)throw new Error(ot+" units is invalid");return Ce/$e}function pt(Ce,ot){return ke(Zt(Ce,ot))}function vt(Ce){var ot=Ce%360;return ot<0&&(ot+=360),ot}function ke(Ce){var ot=Ce%(2*Math.PI);return ot*180/Math.PI}function Re(Ce){var ot=Ce%360;return ot*Math.PI/180}function bt(Ce,ot,$e){if(ot===void 0&&(ot="kilometers"),$e===void 0&&($e="kilometers"),!(Ce>=0))throw new Error("length must be a positive number");return ft(Zt(Ce,ot),$e)}function gt(Ce,ot,$e){if(ot===void 0&&(ot="meters"),$e===void 0&&($e="kilometers"),!(Ce>=0))throw new Error("area must be a positive number");var Xe=_e[ot];if(!Xe)throw new Error("invalid original units");var Rt=_e[$e];if(!Rt)throw new Error("invalid final units");return Ce/Xe*Rt}function Ct(Ce){return!isNaN(Ce)&&Ce!==null&&!Array.isArray(Ce)}function Sn(Ce){return!!Ce&&Ce.constructor===Object}function He(Ce){if(!Ce)throw new Error("bbox is required");if(!Array.isArray(Ce))throw new Error("bbox must be an Array");if(Ce.length!==4&&Ce.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Ce.forEach(function(ot){if(!Ct(ot))throw new Error("bbox must only contain numbers")})}function Ot(Ce){if(!Ce)throw new Error("id is required");if(["string","number"].indexOf(typeof Ce)===-1)throw new Error("id must be a number or a string")}},39034:function($t,W,D){"use strict";D.d(W,{nG:function(){return te},pZ:function(){return X}});var ee=D(1449);function X(ft,Zt,pt){if(ft!==null)for(var vt,ke,Re,bt,gt,Ct,Sn,He=0,Ot=0,Ce,ot=ft.type,$e=ot==="FeatureCollection",Xe=ot==="Feature",Rt=$e?ft.features.length:1,_t=0;_t<Rt;_t++){Sn=$e?ft.features[_t].geometry:Xe?ft.geometry:ft,Ce=Sn?Sn.type==="GeometryCollection":!1,gt=Ce?Sn.geometries.length:1;for(var Pe=0;Pe<gt;Pe++){var Wt=0,on=0;if(bt=Ce?Sn.geometries[Pe]:Sn,bt!==null){Ct=bt.coordinates;var Nn=bt.type;switch(He=pt&&(Nn==="Polygon"||Nn==="MultiPolygon")?1:0,Nn){case null:break;case"Point":if(Zt(Ct,Ot,_t,Wt,on)===!1)return!1;Ot++,Wt++;break;case"LineString":case"MultiPoint":for(vt=0;vt<Ct.length;vt++){if(Zt(Ct[vt],Ot,_t,Wt,on)===!1)return!1;Ot++,Nn==="MultiPoint"&&Wt++}Nn==="LineString"&&Wt++;break;case"Polygon":case"MultiLineString":for(vt=0;vt<Ct.length;vt++){for(ke=0;ke<Ct[vt].length-He;ke++){if(Zt(Ct[vt][ke],Ot,_t,Wt,on)===!1)return!1;Ot++}Nn==="MultiLineString"&&Wt++,Nn==="Polygon"&&on++}Nn==="Polygon"&&Wt++;break;case"MultiPolygon":for(vt=0;vt<Ct.length;vt++){for(on=0,ke=0;ke<Ct[vt].length;ke++){for(Re=0;Re<Ct[vt][ke].length-He;Re++){if(Zt(Ct[vt][ke][Re],Ot,_t,Wt,on)===!1)return!1;Ot++}on++}Wt++}break;case"GeometryCollection":for(vt=0;vt<bt.geometries.length;vt++)if(X(bt.geometries[vt],Zt,pt)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function E(ft,Zt,pt,vt){var ke=pt;return X(ft,function(Re,bt,gt,Ct,Sn){bt===0&&pt===void 0?ke=Re:ke=Zt(ke,Re,bt,gt,Ct,Sn)},vt),ke}function _e(ft,Zt){var pt;switch(ft.type){case"FeatureCollection":for(pt=0;pt<ft.features.length&&Zt(ft.features[pt].properties,pt)!==!1;pt++);break;case"Feature":Zt(ft.properties,0);break}}function re(ft,Zt,pt){var vt=pt;return _e(ft,function(ke,Re){Re===0&&pt===void 0?vt=ke:vt=Zt(vt,ke,Re)}),vt}function he(ft,Zt){if(ft.type==="Feature")Zt(ft,0);else if(ft.type==="FeatureCollection")for(var pt=0;pt<ft.features.length&&Zt(ft.features[pt],pt)!==!1;pt++);}function se(ft,Zt,pt){var vt=pt;return he(ft,function(ke,Re){Re===0&&pt===void 0?vt=ke:vt=Zt(vt,ke,Re)}),vt}function Se(ft){var Zt=[];return X(ft,function(pt){Zt.push(pt)}),Zt}function oe(ft,Zt){var pt,vt,ke,Re,bt,gt,Ct,Sn,He,Ot,Ce=0,ot=ft.type==="FeatureCollection",$e=ft.type==="Feature",Xe=ot?ft.features.length:1;for(pt=0;pt<Xe;pt++){for(gt=ot?ft.features[pt].geometry:$e?ft.geometry:ft,Sn=ot?ft.features[pt].properties:$e?ft.properties:{},He=ot?ft.features[pt].bbox:$e?ft.bbox:void 0,Ot=ot?ft.features[pt].id:$e?ft.id:void 0,Ct=gt?gt.type==="GeometryCollection":!1,bt=Ct?gt.geometries.length:1,ke=0;ke<bt;ke++){if(Re=Ct?gt.geometries[ke]:gt,Re===null){if(Zt(null,Ce,Sn,He,Ot)===!1)return!1;continue}switch(Re.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Zt(Re,Ce,Sn,He,Ot)===!1)return!1;break}case"GeometryCollection":{for(vt=0;vt<Re.geometries.length;vt++)if(Zt(Re.geometries[vt],Ce,Sn,He,Ot)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Ce++}}function je(ft,Zt,pt){var vt=pt;return oe(ft,function(ke,Re,bt,gt,Ct){Re===0&&pt===void 0?vt=ke:vt=Zt(vt,ke,Re,bt,gt,Ct)}),vt}function te(ft,Zt){oe(ft,function(pt,vt,ke,Re,bt){var gt=pt===null?null:pt.type;switch(gt){case null:case"Point":case"LineString":case"Polygon":return Zt((0,ee.zL)(pt,ke,{bbox:Re,id:bt}),vt,0)===!1?!1:void 0}var Ct;switch(gt){case"MultiPoint":Ct="Point";break;case"MultiLineString":Ct="LineString";break;case"MultiPolygon":Ct="Polygon";break}for(var Sn=0;Sn<pt.coordinates.length;Sn++){var He=pt.coordinates[Sn],Ot={type:Ct,coordinates:He};if(Zt((0,ee.zL)(Ot,ke),vt,Sn)===!1)return!1}})}function ve(ft,Zt,pt){var vt=pt;return te(ft,function(ke,Re,bt){Re===0&&bt===0&&pt===void 0?vt=ke:vt=Zt(vt,ke,Re,bt)}),vt}function Be(ft,Zt){te(ft,function(pt,vt,ke){var Re=0;if(pt.geometry){var bt=pt.geometry.type;if(!(bt==="Point"||bt==="MultiPoint")){var gt,Ct=0,Sn=0,He=0;if(X(pt,function(Ot,Ce,ot,$e,Xe){if(gt===void 0||vt>Ct||$e>Sn||Xe>He){gt=Ot,Ct=vt,Sn=$e,He=Xe,Re=0;return}var Rt=lineString([gt,Ot],pt.properties);if(Zt(Rt,vt,ke,Xe,Re)===!1)return!1;Re++,gt=Ot})===!1)return!1}}})}function Te(ft,Zt,pt){var vt=pt,ke=!1;return Be(ft,function(Re,bt,gt,Ct,Sn){ke===!1&&pt===void 0?vt=Re:vt=Zt(vt,Re,bt,gt,Ct,Sn),ke=!0}),vt}function we(ft,Zt){if(!ft)throw new Error("geojson is required");te(ft,function(pt,vt,ke){if(pt.geometry!==null){var Re=pt.geometry.type,bt=pt.geometry.coordinates;switch(Re){case"LineString":if(Zt(pt,vt,ke,0,0)===!1)return!1;break;case"Polygon":for(var gt=0;gt<bt.length;gt++)if(Zt(lineString(bt[gt],pt.properties),vt,ke,gt)===!1)return!1;break}}})}function le(ft,Zt,pt){var vt=pt;return we(ft,function(ke,Re,bt,gt){Re===0&&pt===void 0?vt=ke:vt=Zt(vt,ke,Re,bt,gt)}),vt}function Ze(ft,Zt){if(Zt=Zt||{},!isObject(Zt))throw new Error("options is invalid");var pt=Zt.featureIndex||0,vt=Zt.multiFeatureIndex||0,ke=Zt.geometryIndex||0,Re=Zt.segmentIndex||0,bt=Zt.properties,gt;switch(ft.type){case"FeatureCollection":pt<0&&(pt=ft.features.length+pt),bt=bt||ft.features[pt].properties,gt=ft.features[pt].geometry;break;case"Feature":bt=bt||ft.properties,gt=ft.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":gt=ft;break;default:throw new Error("geojson is invalid")}if(gt===null)return null;var Ct=gt.coordinates;switch(gt.type){case"Point":case"MultiPoint":return null;case"LineString":return Re<0&&(Re=Ct.length+Re-1),lineString([Ct[Re],Ct[Re+1]],bt,Zt);case"Polygon":return ke<0&&(ke=Ct.length+ke),Re<0&&(Re=Ct[ke].length+Re-1),lineString([Ct[ke][Re],Ct[ke][Re+1]],bt,Zt);case"MultiLineString":return vt<0&&(vt=Ct.length+vt),Re<0&&(Re=Ct[vt].length+Re-1),lineString([Ct[vt][Re],Ct[vt][Re+1]],bt,Zt);case"MultiPolygon":return vt<0&&(vt=Ct.length+vt),ke<0&&(ke=Ct[vt].length+ke),Re<0&&(Re=Ct[vt][ke].length-Re-1),lineString([Ct[vt][ke][Re],Ct[vt][ke][Re+1]],bt,Zt)}throw new Error("geojson is invalid")}function xt(ft,Zt){if(Zt=Zt||{},!isObject(Zt))throw new Error("options is invalid");var pt=Zt.featureIndex||0,vt=Zt.multiFeatureIndex||0,ke=Zt.geometryIndex||0,Re=Zt.coordIndex||0,bt=Zt.properties,gt;switch(ft.type){case"FeatureCollection":pt<0&&(pt=ft.features.length+pt),bt=bt||ft.features[pt].properties,gt=ft.features[pt].geometry;break;case"Feature":bt=bt||ft.properties,gt=ft.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":gt=ft;break;default:throw new Error("geojson is invalid")}if(gt===null)return null;var Ct=gt.coordinates;switch(gt.type){case"Point":return point(Ct,bt,Zt);case"MultiPoint":return vt<0&&(vt=Ct.length+vt),point(Ct[vt],bt,Zt);case"LineString":return Re<0&&(Re=Ct.length+Re),point(Ct[Re],bt,Zt);case"Polygon":return ke<0&&(ke=Ct.length+ke),Re<0&&(Re=Ct[ke].length+Re),point(Ct[ke][Re],bt,Zt);case"MultiLineString":return vt<0&&(vt=Ct.length+vt),Re<0&&(Re=Ct[vt].length+Re),point(Ct[vt][Re],bt,Zt);case"MultiPolygon":return vt<0&&(vt=Ct.length+vt),ke<0&&(ke=Ct[vt].length+ke),Re<0&&(Re=Ct[vt][ke].length-Re),point(Ct[vt][ke][Re],bt,Zt)}throw new Error("geojson is invalid")}},97582:function($t,W,D){"use strict";D.d(W,{CR:function(){return Ze},Jh:function(){return Be},Q_:function(){return He},XA:function(){return le},ZT:function(){return X},_T:function(){return _e},ev:function(){return Zt},mG:function(){return ve},pi:function(){return E}});var ee=function(_t,Pe){return ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Wt,on){Wt.__proto__=on}||function(Wt,on){for(var Nn in on)Object.prototype.hasOwnProperty.call(on,Nn)&&(Wt[Nn]=on[Nn])},ee(_t,Pe)};function X(_t,Pe){if(typeof Pe!="function"&&Pe!==null)throw new TypeError("Class extends value "+String(Pe)+" is not a constructor or null");ee(_t,Pe);function Wt(){this.constructor=_t}_t.prototype=Pe===null?Object.create(Pe):(Wt.prototype=Pe.prototype,new Wt)}var E=function(){return E=Object.assign||function(Pe){for(var Wt,on=1,Nn=arguments.length;on<Nn;on++){Wt=arguments[on];for(var jn in Wt)Object.prototype.hasOwnProperty.call(Wt,jn)&&(Pe[jn]=Wt[jn])}return Pe},E.apply(this,arguments)};function _e(_t,Pe){var Wt={};for(var on in _t)Object.prototype.hasOwnProperty.call(_t,on)&&Pe.indexOf(on)<0&&(Wt[on]=_t[on]);if(_t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nn=0,on=Object.getOwnPropertySymbols(_t);Nn<on.length;Nn++)Pe.indexOf(on[Nn])<0&&Object.prototype.propertyIsEnumerable.call(_t,on[Nn])&&(Wt[on[Nn]]=_t[on[Nn]]);return Wt}function re(_t,Pe,Wt,on){var Nn=arguments.length,jn=Nn<3?Pe:on===null?on=Object.getOwnPropertyDescriptor(Pe,Wt):on,lr;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")jn=Reflect.decorate(_t,Pe,Wt,on);else for(var Vt=_t.length-1;Vt>=0;Vt--)(lr=_t[Vt])&&(jn=(Nn<3?lr(jn):Nn>3?lr(Pe,Wt,jn):lr(Pe,Wt))||jn);return Nn>3&&jn&&Object.defineProperty(Pe,Wt,jn),jn}function he(_t,Pe){return function(Wt,on){Pe(Wt,on,_t)}}function se(_t,Pe,Wt,on,Nn,jn){function lr(U){if(U!==void 0&&typeof U!="function")throw new TypeError("Function expected");return U}for(var Vt=on.kind,en=Vt==="getter"?"get":Vt==="setter"?"set":"value",xn=!Pe&&_t?on.static?_t:_t.prototype:null,er=Pe||(xn?Object.getOwnPropertyDescriptor(xn,on.name):{}),sn,Ut=!1,Dt=Wt.length-1;Dt>=0;Dt--){var Me={};for(var Qe in on)Me[Qe]=Qe==="access"?{}:on[Qe];for(var Qe in on.access)Me.access[Qe]=on.access[Qe];Me.addInitializer=function(U){if(Ut)throw new TypeError("Cannot add initializers after decoration has completed");jn.push(lr(U||null))};var Ft=(0,Wt[Dt])(Vt==="accessor"?{get:er.get,set:er.set}:er[en],Me);if(Vt==="accessor"){if(Ft===void 0)continue;if(Ft===null||typeof Ft!="object")throw new TypeError("Object expected");(sn=lr(Ft.get))&&(er.get=sn),(sn=lr(Ft.set))&&(er.set=sn),(sn=lr(Ft.init))&&Nn.unshift(sn)}else(sn=lr(Ft))&&(Vt==="field"?Nn.unshift(sn):er[en]=sn)}xn&&Object.defineProperty(xn,on.name,er),Ut=!0}function Se(_t,Pe,Wt){for(var on=arguments.length>2,Nn=0;Nn<Pe.length;Nn++)Wt=on?Pe[Nn].call(_t,Wt):Pe[Nn].call(_t);return on?Wt:void 0}function oe(_t){return typeof _t=="symbol"?_t:"".concat(_t)}function je(_t,Pe,Wt){return typeof Pe=="symbol"&&(Pe=Pe.description?"[".concat(Pe.description,"]"):""),Object.defineProperty(_t,"name",{configurable:!0,value:Wt?"".concat(Wt," ",Pe):Pe})}function te(_t,Pe){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(_t,Pe)}function ve(_t,Pe,Wt,on){function Nn(jn){return jn instanceof Wt?jn:new Wt(function(lr){lr(jn)})}return new(Wt||(Wt=Promise))(function(jn,lr){function Vt(er){try{xn(on.next(er))}catch(sn){lr(sn)}}function en(er){try{xn(on.throw(er))}catch(sn){lr(sn)}}function xn(er){er.done?jn(er.value):Nn(er.value).then(Vt,en)}xn((on=on.apply(_t,Pe||[])).next())})}function Be(_t,Pe){var Wt={label:0,sent:function(){if(jn[0]&1)throw jn[1];return jn[1]},trys:[],ops:[]},on,Nn,jn,lr;return lr={next:Vt(0),throw:Vt(1),return:Vt(2)},typeof Symbol=="function"&&(lr[Symbol.iterator]=function(){return this}),lr;function Vt(xn){return function(er){return en([xn,er])}}function en(xn){if(on)throw new TypeError("Generator is already executing.");for(;lr&&(lr=0,xn[0]&&(Wt=0)),Wt;)try{if(on=1,Nn&&(jn=xn[0]&2?Nn.return:xn[0]?Nn.throw||((jn=Nn.return)&&jn.call(Nn),0):Nn.next)&&!(jn=jn.call(Nn,xn[1])).done)return jn;switch(Nn=0,jn&&(xn=[xn[0]&2,jn.value]),xn[0]){case 0:case 1:jn=xn;break;case 4:return Wt.label++,{value:xn[1],done:!1};case 5:Wt.label++,Nn=xn[1],xn=[0];continue;case 7:xn=Wt.ops.pop(),Wt.trys.pop();continue;default:if(jn=Wt.trys,!(jn=jn.length>0&&jn[jn.length-1])&&(xn[0]===6||xn[0]===2)){Wt=0;continue}if(xn[0]===3&&(!jn||xn[1]>jn[0]&&xn[1]<jn[3])){Wt.label=xn[1];break}if(xn[0]===6&&Wt.label<jn[1]){Wt.label=jn[1],jn=xn;break}if(jn&&Wt.label<jn[2]){Wt.label=jn[2],Wt.ops.push(xn);break}jn[2]&&Wt.ops.pop(),Wt.trys.pop();continue}xn=Pe.call(_t,Wt)}catch(er){xn=[6,er],Nn=0}finally{on=jn=0}if(xn[0]&5)throw xn[1];return{value:xn[0]?xn[1]:void 0,done:!0}}}var Te=Object.create?function(_t,Pe,Wt,on){on===void 0&&(on=Wt);var Nn=Object.getOwnPropertyDescriptor(Pe,Wt);(!Nn||("get"in Nn?!Pe.__esModule:Nn.writable||Nn.configurable))&&(Nn={enumerable:!0,get:function(){return Pe[Wt]}}),Object.defineProperty(_t,on,Nn)}:function(_t,Pe,Wt,on){on===void 0&&(on=Wt),_t[on]=Pe[Wt]};function we(_t,Pe){for(var Wt in _t)Wt!=="default"&&!Object.prototype.hasOwnProperty.call(Pe,Wt)&&Te(Pe,_t,Wt)}function le(_t){var Pe=typeof Symbol=="function"&&Symbol.iterator,Wt=Pe&&_t[Pe],on=0;if(Wt)return Wt.call(_t);if(_t&&typeof _t.length=="number")return{next:function(){return _t&&on>=_t.length&&(_t=void 0),{value:_t&&_t[on++],done:!_t}}};throw new TypeError(Pe?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ze(_t,Pe){var Wt=typeof Symbol=="function"&&_t[Symbol.iterator];if(!Wt)return _t;var on=Wt.call(_t),Nn,jn=[],lr;try{for(;(Pe===void 0||Pe-- >0)&&!(Nn=on.next()).done;)jn.push(Nn.value)}catch(Vt){lr={error:Vt}}finally{try{Nn&&!Nn.done&&(Wt=on.return)&&Wt.call(on)}finally{if(lr)throw lr.error}}return jn}function xt(){for(var _t=[],Pe=0;Pe<arguments.length;Pe++)_t=_t.concat(Ze(arguments[Pe]));return _t}function ft(){for(var _t=0,Pe=0,Wt=arguments.length;Pe<Wt;Pe++)_t+=arguments[Pe].length;for(var on=Array(_t),Nn=0,Pe=0;Pe<Wt;Pe++)for(var jn=arguments[Pe],lr=0,Vt=jn.length;lr<Vt;lr++,Nn++)on[Nn]=jn[lr];return on}function Zt(_t,Pe,Wt){if(Wt||arguments.length===2)for(var on=0,Nn=Pe.length,jn;on<Nn;on++)(jn||!(on in Pe))&&(jn||(jn=Array.prototype.slice.call(Pe,0,on)),jn[on]=Pe[on]);return _t.concat(jn||Array.prototype.slice.call(Pe))}function pt(_t){return this instanceof pt?(this.v=_t,this):new pt(_t)}function vt(_t,Pe,Wt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var on=Wt.apply(_t,Pe||[]),Nn,jn=[];return Nn={},Vt("next"),Vt("throw"),Vt("return",lr),Nn[Symbol.asyncIterator]=function(){return this},Nn;function lr(Dt){return function(Me){return Promise.resolve(Me).then(Dt,sn)}}function Vt(Dt,Me){on[Dt]&&(Nn[Dt]=function(Qe){return new Promise(function(Ft,U){jn.push([Dt,Qe,Ft,U])>1||en(Dt,Qe)})},Me&&(Nn[Dt]=Me(Nn[Dt])))}function en(Dt,Me){try{xn(on[Dt](Me))}catch(Qe){Ut(jn[0][3],Qe)}}function xn(Dt){Dt.value instanceof pt?Promise.resolve(Dt.value.v).then(er,sn):Ut(jn[0][2],Dt)}function er(Dt){en("next",Dt)}function sn(Dt){en("throw",Dt)}function Ut(Dt,Me){Dt(Me),jn.shift(),jn.length&&en(jn[0][0],jn[0][1])}}function ke(_t){var Pe,Wt;return Pe={},on("next"),on("throw",function(Nn){throw Nn}),on("return"),Pe[Symbol.iterator]=function(){return this},Pe;function on(Nn,jn){Pe[Nn]=_t[Nn]?function(lr){return(Wt=!Wt)?{value:pt(_t[Nn](lr)),done:!1}:jn?jn(lr):lr}:jn}}function Re(_t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Pe=_t[Symbol.asyncIterator],Wt;return Pe?Pe.call(_t):(_t=typeof le=="function"?le(_t):_t[Symbol.iterator](),Wt={},on("next"),on("throw"),on("return"),Wt[Symbol.asyncIterator]=function(){return this},Wt);function on(jn){Wt[jn]=_t[jn]&&function(lr){return new Promise(function(Vt,en){lr=_t[jn](lr),Nn(Vt,en,lr.done,lr.value)})}}function Nn(jn,lr,Vt,en){Promise.resolve(en).then(function(xn){jn({value:xn,done:Vt})},lr)}}function bt(_t,Pe){return Object.defineProperty?Object.defineProperty(_t,"raw",{value:Pe}):_t.raw=Pe,_t}var gt=Object.create?function(_t,Pe){Object.defineProperty(_t,"default",{enumerable:!0,value:Pe})}:function(_t,Pe){_t.default=Pe};function Ct(_t){if(_t&&_t.__esModule)return _t;var Pe={};if(_t!=null)for(var Wt in _t)Wt!=="default"&&Object.prototype.hasOwnProperty.call(_t,Wt)&&Te(Pe,_t,Wt);return gt(Pe,_t),Pe}function Sn(_t){return _t&&_t.__esModule?_t:{default:_t}}function He(_t,Pe,Wt,on){if(Wt==="a"&&!on)throw new TypeError("Private accessor was defined without a getter");if(typeof Pe=="function"?_t!==Pe||!on:!Pe.has(_t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Wt==="m"?on:Wt==="a"?on.call(_t):on?on.value:Pe.get(_t)}function Ot(_t,Pe,Wt,on,Nn){if(on==="m")throw new TypeError("Private method is not writable");if(on==="a"&&!Nn)throw new TypeError("Private accessor was defined without a setter");if(typeof Pe=="function"?_t!==Pe||!Nn:!Pe.has(_t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return on==="a"?Nn.call(_t,Wt):Nn?Nn.value=Wt:Pe.set(_t,Wt),Wt}function Ce(_t,Pe){if(Pe===null||typeof Pe!="object"&&typeof Pe!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof _t=="function"?Pe===_t:_t.has(Pe)}function ot(_t,Pe,Wt){if(Pe!=null){if(typeof Pe!="object"&&typeof Pe!="function")throw new TypeError("Object expected.");var on,Nn;if(Wt){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");on=Pe[Symbol.asyncDispose]}if(on===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");on=Pe[Symbol.dispose],Wt&&(Nn=on)}if(typeof on!="function")throw new TypeError("Object not disposable.");Nn&&(on=function(){try{Nn.call(this)}catch(jn){return Promise.reject(jn)}}),_t.stack.push({value:Pe,dispose:on,async:Wt})}else Wt&&_t.stack.push({async:!0});return Pe}var $e=typeof SuppressedError=="function"?SuppressedError:function(_t,Pe,Wt){var on=new Error(Wt);return on.name="SuppressedError",on.error=_t,on.suppressed=Pe,on};function Xe(_t){function Pe(on){_t.error=_t.hasError?new $e(on,_t.error,"An error was suppressed during disposal."):on,_t.hasError=!0}function Wt(){for(;_t.stack.length;){var on=_t.stack.pop();try{var Nn=on.dispose&&on.dispose.call(on.value);if(on.async)return Promise.resolve(Nn).then(Wt,function(jn){return Pe(jn),Wt()})}catch(jn){Pe(jn)}}if(_t.hasError)throw _t.error}return Wt()}var Rt={__extends:X,__assign:E,__rest:_e,__decorate:re,__param:he,__metadata:te,__awaiter:ve,__generator:Be,__createBinding:Te,__exportStar:we,__values:le,__read:Ze,__spread:xt,__spreadArrays:ft,__spreadArray:Zt,__await:pt,__asyncGenerator:vt,__asyncDelegator:ke,__asyncValues:Re,__makeTemplateObject:bt,__importStar:Ct,__importDefault:Sn,__classPrivateFieldGet:He,__classPrivateFieldSet:Ot,__classPrivateFieldIn:Ce,__addDisposableResource:ot,__disposeResources:Xe}}}]);
}());