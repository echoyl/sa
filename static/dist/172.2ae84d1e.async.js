!(function(){var qm=(Ze,E,_)=>new Promise((D,N)=>{var h=P=>{try{C(_.next(P))}catch(F){N(F)}},O=P=>{try{C(_.throw(P))}catch(F){N(F)}},C=P=>P.done?D(P.value):Promise.resolve(P.value).then(h,O);C((_=_.apply(Ze,E)).next())});(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[172],{25330:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var _={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};E.default=_},67303:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var _={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};E.default=_},83647:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var _={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};E.default=_},57583:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var _={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};E.default=_},29260:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var _={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"};E.default=_},64183:function(Ze,E,_){"use strict";var D=_(67294),N=_(15415),h=function(){return h=Object.assign||function(C){for(var P,F=1,Y=arguments.length;F<Y;F++){P=arguments[F];for(var V in P)Object.prototype.hasOwnProperty.call(P,V)&&(C[V]=P[V])}return C},h.apply(this,arguments)},O=function(C){return D.createElement(N.P,h({},C,{chartType:"Area"}))};E.Z=O},79611:function(Ze,E,_){"use strict";var D=_(67294),N=_(15415),h=function(){return h=Object.assign||function(C){for(var P,F=1,Y=arguments.length;F<Y;F++){P=arguments[F];for(var V in P)Object.prototype.hasOwnProperty.call(P,V)&&(C[V]=P[V])}return C},h.apply(this,arguments)},O=function(C){return D.createElement(N.P,h({},C,{chartType:"Bar"}))};E.Z=O},78677:function(Ze,E,_){"use strict";var D=_(67294),N=_(15415),h=function(){return h=Object.assign||function(C){for(var P,F=1,Y=arguments.length;F<Y;F++){P=arguments[F];for(var V in P)Object.prototype.hasOwnProperty.call(P,V)&&(C[V]=P[V])}return C},h.apply(this,arguments)},O=function(C){return D.createElement(N.P,h({},C,{chartType:"Column"}))};E.Z=O},63430:function(Ze,E,_){"use strict";var D=_(67294),N=_(15415),h=function(){return h=Object.assign||function(C){for(var P,F=1,Y=arguments.length;F<Y;F++){P=arguments[F];for(var V in P)Object.prototype.hasOwnProperty.call(P,V)&&(C[V]=P[V])}return C},h.apply(this,arguments)},O=function(C){return D.createElement(N.P,h({},C,{chartType:"Pie"}))};E.Z=O},6466:function(Ze,E,_){"use strict";_.d(E,{Z:function(){return Ae}});var D=_(4942),N=_(1413),h=_(45987),O=_(28459),C=_(93967),P=_.n(C),F=_(67294),Y=_(2338),V=_(44962),Q=_(98082),k=function(ee){return(0,D.Z)({},ee.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:ee.marginLG,marginInline:0,color:ee.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function K(ae){return(0,Q.Xj)("ProCardOperation",function(ee){var me=(0,N.Z)((0,N.Z)({},ee),{},{componentCls:".".concat(ae)});return[k(me)]})}var U=_(85893),Z=function(ee){var me=ee.className,ge=ee.style,fe=ge===void 0?{}:ge,Et=ee.children,xe=(0,F.useContext)(O.ZP.ConfigContext),je=xe.getPrefixCls,ue=je("pro-card-operation"),Pe=K(ue),we=Pe.wrapSSR,nt=Pe.hashId,at=P()(ue,me,nt);return we((0,U.jsx)("div",{className:at,style:fe,children:Et}))},J=Z,H=_(96604),ve=function(ee){return(0,D.Z)({},ee.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,D.Z)({flexDirection:"row"},"".concat(ee.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(ee.colorBorder)}})};function Te(ae){return(0,Q.Xj)("StatisticCard",function(ee){var me=(0,N.Z)((0,N.Z)({},ee),{},{componentCls:".".concat(ae)});return[ve(me)]})}var ye=["children","statistic","className","chart","chartPlacement","footer"],Ve=function(ee){var me=ee.children,ge=ee.statistic,fe=ee.className,Et=ee.chart,xe=ee.chartPlacement,je=ee.footer,ue=(0,h.Z)(ee,ye),Pe=(0,F.useContext)(O.ZP.ConfigContext),we=Pe.getPrefixCls,nt=we("pro-statistic-card"),at=Te(nt),vt=at.wrapSSR,Tt=at.hashId,ze=P()(nt,fe,Tt),gr=ge&&(0,U.jsx)(H.Z,(0,N.Z)({layout:"vertical"},ge)),At=P()("".concat(nt,"-chart"),Tt,(0,D.Z)((0,D.Z)({},"".concat(nt,"-chart-left"),xe==="left"&&Et&&ge),"".concat(nt,"-chart-right"),xe==="right"&&Et&&ge)),hn=Et&&(0,U.jsx)("div",{className:At,children:Et}),Wr=P()("".concat(nt,"-content "),Tt,(0,D.Z)({},"".concat(nt,"-content-horizontal"),xe==="left"||xe==="right")),vr=(hn||gr)&&(xe==="left"?(0,U.jsxs)("div",{className:Wr,children:[hn,gr]}):(0,U.jsxs)("div",{className:Wr,children:[gr,hn]})),dn=je&&(0,U.jsx)("div",{className:"".concat(nt,"-footer ").concat(Tt).trim(),children:je});return vt((0,U.jsxs)(Y.Z,(0,N.Z)((0,N.Z)({className:ze},ue),{},{children:[vr,me,dn]})))},Re=function(ee){return(0,U.jsx)(Ve,(0,N.Z)({bodyStyle:{padding:0}},ee))};Ve.Statistic=H.Z,Ve.Divider=V.Z,Ve.Operation=J,Ve.isProCard=!0,Ve.Group=Re;var Ae=Ve},96604:function(Ze,E,_){"use strict";_.d(E,{Z:function(){return un}});var D=_(1413),N=_(4942),h=_(45987),O=_(87462),C=_(67294),P=_(36688),F=_(5627),Y=function(Vt,dr){return C.createElement(F.Z,(0,O.Z)({},Vt,{ref:dr,icon:P.Z}))},V=C.forwardRef(Y),Q=_(28459),k=_(83062),K=_(40411),U=_(57838),Z=_(96159),J=_(93967),H=_.n(J),ve=_(64217),Te=_(53124),ye=_(87564),Re=yn=>{const{value:Vt,formatter:dr,precision:wt,decimalSeparator:He,groupSeparator:wr="",prefixCls:Ne}=yn;let Xr;if(typeof dr=="function")Xr=dr(Vt);else{const Er=String(Vt),Ue=Er.match(/^(-?)(\d*)(\.(\d+))?$/);if(!Ue||Er==="-")Xr=Er;else{const In=Ue[1];let an=Ue[2]||"0",Qr=Ue[4]||"";an=an.replace(/\B(?=(\d{3})+(?!\d))/g,wr),typeof wt=="number"&&(Qr=Qr.padEnd(wt,"0").slice(0,wt>0?wt:0)),Qr&&(Qr=`${He}${Qr}`),Xr=[C.createElement("span",{key:"int",className:`${Ne}-content-value-int`},In,an),Qr&&C.createElement("span",{key:"decimal",className:`${Ne}-content-value-decimal`},Qr)]}}return C.createElement("span",{className:`${Ne}-content-value`},Xr)},Ae=_(14747),ae=_(91945),ee=_(45503);const me=yn=>{const{componentCls:Vt,marginXXS:dr,padding:wt,colorTextDescription:He,titleFontSize:wr,colorTextHeading:Ne,contentFontSize:Xr,fontFamily:Er}=yn;return{[`${Vt}`]:Object.assign(Object.assign({},(0,Ae.Wf)(yn)),{[`${Vt}-title`]:{marginBottom:dr,color:He,fontSize:wr},[`${Vt}-skeleton`]:{paddingTop:wt},[`${Vt}-content`]:{color:Ne,fontSize:Xr,fontFamily:Er,[`${Vt}-content-value`]:{display:"inline-block",direction:"ltr"},[`${Vt}-content-prefix, ${Vt}-content-suffix`]:{display:"inline-block"},[`${Vt}-content-prefix`]:{marginInlineEnd:dr},[`${Vt}-content-suffix`]:{marginInlineStart:dr}}})}},ge=yn=>{const{fontSizeHeading3:Vt,fontSize:dr}=yn;return{titleFontSize:dr,contentFontSize:Vt}};var fe=(0,ae.I$)("Statistic",yn=>{const Vt=(0,ee.TS)(yn,{});return[me(Vt)]},ge),Et=function(yn,Vt){var dr={};for(var wt in yn)Object.prototype.hasOwnProperty.call(yn,wt)&&Vt.indexOf(wt)<0&&(dr[wt]=yn[wt]);if(yn!=null&&typeof Object.getOwnPropertySymbols=="function")for(var He=0,wt=Object.getOwnPropertySymbols(yn);He<wt.length;He++)Vt.indexOf(wt[He])<0&&Object.prototype.propertyIsEnumerable.call(yn,wt[He])&&(dr[wt[He]]=yn[wt[He]]);return dr},je=yn=>{const{prefixCls:Vt,className:dr,rootClassName:wt,style:He,valueStyle:wr,value:Ne=0,title:Xr,valueRender:Er,prefix:Ue,suffix:In,loading:an=!1,formatter:Qr,precision:Dn,decimalSeparator:On=".",groupSeparator:ri=",",onMouseEnter:zt,onMouseLeave:cr}=yn,Zr=Et(yn,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:Kr,direction:en,statistic:Wn}=C.useContext(Te.E_),De=Kr("statistic",Vt),[X,se,Be]=fe(De),Ye=C.createElement(Re,{decimalSeparator:On,groupSeparator:ri,prefixCls:De,formatter:Qr,precision:Dn,value:Ne}),ct=H()(De,{[`${De}-rtl`]:en==="rtl"},Wn==null?void 0:Wn.className,dr,wt,se,Be),sr=(0,ve.Z)(Zr,{aria:!0,data:!0});return X(C.createElement("div",Object.assign({},sr,{className:ct,style:Object.assign(Object.assign({},Wn==null?void 0:Wn.style),He),onMouseEnter:zt,onMouseLeave:cr}),Xr&&C.createElement("div",{className:`${De}-title`},Xr),C.createElement(ye.Z,{paragraph:!1,loading:an,className:`${De}-skeleton`},C.createElement("div",{style:wr,className:`${De}-content`},Ue&&C.createElement("span",{className:`${De}-content-prefix`},Ue),Er?Er(Ye):Ye,In&&C.createElement("span",{className:`${De}-content-suffix`},In)))))};const ue=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Pe(yn,Vt){let dr=yn;const wt=/\[[^\]]*]/g,He=(Vt.match(wt)||[]).map(Er=>Er.slice(1,-1)),wr=Vt.replace(wt,"[]"),Ne=ue.reduce((Er,Ue)=>{let[In,an]=Ue;if(Er.includes(In)){const Qr=Math.floor(dr/an);return dr-=Qr*an,Er.replace(new RegExp(`${In}+`,"g"),Dn=>{const On=Dn.length;return Qr.toString().padStart(On,"0")})}return Er},wr);let Xr=0;return Ne.replace(wt,()=>{const Er=He[Xr];return Xr+=1,Er})}function we(yn,Vt){const{format:dr=""}=Vt,wt=new Date(yn).getTime(),He=Date.now(),wr=Math.max(wt-He,0);return Pe(wr,dr)}var nt=function(yn,Vt){var dr={};for(var wt in yn)Object.prototype.hasOwnProperty.call(yn,wt)&&Vt.indexOf(wt)<0&&(dr[wt]=yn[wt]);if(yn!=null&&typeof Object.getOwnPropertySymbols=="function")for(var He=0,wt=Object.getOwnPropertySymbols(yn);He<wt.length;He++)Vt.indexOf(wt[He])<0&&Object.prototype.propertyIsEnumerable.call(yn,wt[He])&&(dr[wt[He]]=yn[wt[He]]);return dr};const at=1e3/30;function vt(yn){return new Date(yn).getTime()}const Tt=yn=>{const{value:Vt,format:dr="HH:mm:ss",onChange:wt,onFinish:He}=yn,wr=nt(yn,["value","format","onChange","onFinish"]),Ne=(0,U.Z)(),Xr=C.useRef(null),Er=()=>{He==null||He(),Xr.current&&(clearInterval(Xr.current),Xr.current=null)},Ue=()=>{const Qr=vt(Vt);Qr>=Date.now()&&(Xr.current=setInterval(()=>{Ne(),wt==null||wt(Qr-Date.now()),Qr<Date.now()&&Er()},at))};C.useEffect(()=>(Ue(),()=>{Xr.current&&(clearInterval(Xr.current),Xr.current=null)}),[Vt]);const In=(Qr,Dn)=>we(Qr,Object.assign(Object.assign({},Dn),{format:dr})),an=Qr=>(0,Z.Tm)(Qr,{title:void 0});return C.createElement(je,Object.assign({},wr,{value:Vt,valueRender:an,formatter:In}))};var ze=C.memo(Tt);je.Countdown=ze;var gr=je,At=_(98082),hn=function(Vt){return(0,N.Z)({},Vt.componentCls,(0,N.Z)((0,N.Z)((0,N.Z)((0,N.Z)((0,N.Z)({display:"flex",fontSize:Vt.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,N.Z)({display:"flex",width:"100%"},"".concat(Vt.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,N.Z)({width:"100%"},"".concat(Vt.antCls,"-statistic-content"),{"&-value-int":{fontSize:Vt.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat(Vt.antCls,"-statistic-title"),{color:Vt.colorText}),"&-trend-up",(0,N.Z)({},"".concat(Vt.antCls,"-statistic-content"),(0,N.Z)({color:"#f5222d"},"".concat(Vt.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,N.Z)({},"".concat(Vt.antCls,"-statistic-content"),(0,N.Z)({color:"#389e0d"},"".concat(Vt.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,N.Z)((0,N.Z)((0,N.Z)({display:"flex",justifyContent:"space-between"},"".concat(Vt.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(Vt.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(Vt.antCls,"-statistic-title,").concat(Vt.antCls,"-statistic-content,").concat(Vt.antCls,"-statistic-content-suffix,").concat(Vt.antCls,"-statistic-content-prefix,").concat(Vt.antCls,"-statistic-content-value-decimal"),{fontSize:Vt.fontSize})),"& &-layout-inline",(0,N.Z)((0,N.Z)((0,N.Z)({display:"inline-flex",color:Vt.colorTextSecondary},"".concat(Vt.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(Vt.antCls,"-statistic-content"),{color:Vt.colorTextSecondary}),"".concat(Vt.antCls,"-statistic-title,").concat(Vt.antCls,"-statistic-content,").concat(Vt.antCls,"-statistic-content-suffix,").concat(Vt.antCls,"-statistic-content-prefix,").concat(Vt.antCls,"-statistic-content-value-decimal"),{fontSize:Vt.fontSizeSM})))};function Wr(yn){return(0,At.Xj)("Statistic",function(Vt){var dr=(0,D.Z)((0,D.Z)({},Vt),{},{componentCls:".".concat(yn)});return[hn(dr)]})}var vr=_(85893),dn=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],tn=function(Vt){var dr=Vt.className,wt=Vt.layout,He=wt===void 0?"inline":wt,wr=Vt.style,Ne=Vt.description,Xr=Vt.children,Er=Vt.title,Ue=Vt.tip,In=Vt.status,an=Vt.trend,Qr=Vt.prefix,Dn=Vt.icon,On=(0,h.Z)(Vt,dn),ri=(0,C.useContext)(Q.ZP.ConfigContext),zt=ri.getPrefixCls,cr=zt("pro-card-statistic"),Zr=Wr(cr),Kr=Zr.wrapSSR,en=Zr.hashId,Wn=H()(cr,dr,en),De=H()("".concat(cr,"-status"),en),X=H()("".concat(cr,"-icon"),en),se=H()("".concat(cr,"-wrapper"),en),Be=H()("".concat(cr,"-content"),en),Ye=H()(en,(0,N.Z)((0,N.Z)({},"".concat(cr,"-layout-").concat(He),He),"".concat(cr,"-trend-").concat(an),an)),ct=Ue&&(0,vr.jsx)(k.Z,{title:Ue,children:(0,vr.jsx)(V,{className:"".concat(cr,"-tip ").concat(en).trim()})}),sr=H()("".concat(cr,"-trend-icon"),en,(0,N.Z)({},"".concat(cr,"-trend-icon-").concat(an),an)),ar=an&&(0,vr.jsx)("div",{className:sr}),or=In&&(0,vr.jsx)("div",{className:De,children:(0,vr.jsx)(K.Z,{status:In,text:null})}),Wt=Dn&&(0,vr.jsx)("div",{className:X,children:Dn});return Kr((0,vr.jsxs)("div",{className:Wn,style:wr,children:[Wt,(0,vr.jsxs)("div",{className:se,children:[or,(0,vr.jsxs)("div",{className:Be,children:[(0,vr.jsx)(gr,(0,D.Z)({title:(Er||ct)&&(0,vr.jsxs)(vr.Fragment,{children:[Er,ct]}),prefix:(ar||Qr)&&(0,vr.jsxs)(vr.Fragment,{children:[ar,Qr]}),className:Ye},On)),Ne&&(0,vr.jsx)("div",{className:"".concat(cr,"-description ").concat(en).trim(),children:Ne})]})]})]}))},un=tn},46343:function(Ze,E,_){"use strict";_.d(E,{S$:function(){return Vt},bf:function(){return dr},ni:function(){return ze},oI:function(){return un},sX:function(){return yn}});var D=_(34155);function N(wt,He,wr,Ne){function Xr(Er){return Er instanceof wr?Er:new wr(function(Ue){Ue(Er)})}return new(wr||(wr=Promise))(function(Er,Ue){function In(Dn){try{Qr(Ne.next(Dn))}catch(On){Ue(On)}}function an(Dn){try{Qr(Ne.throw(Dn))}catch(On){Ue(On)}}function Qr(Dn){Dn.done?Er(Dn.value):Xr(Dn.value).then(In,an)}Qr((Ne=Ne.apply(wt,He||[])).next())})}function h(wt,He){var wr={label:0,sent:function(){if(Er[0]&1)throw Er[1];return Er[1]},trys:[],ops:[]},Ne,Xr,Er,Ue;return Ue={next:In(0),throw:In(1),return:In(2)},typeof Symbol=="function"&&(Ue[Symbol.iterator]=function(){return this}),Ue;function In(Qr){return function(Dn){return an([Qr,Dn])}}function an(Qr){if(Ne)throw new TypeError("Generator is already executing.");for(;wr;)try{if(Ne=1,Xr&&(Er=Qr[0]&2?Xr.return:Qr[0]?Xr.throw||((Er=Xr.return)&&Er.call(Xr),0):Xr.next)&&!(Er=Er.call(Xr,Qr[1])).done)return Er;switch(Xr=0,Er&&(Qr=[Qr[0]&2,Er.value]),Qr[0]){case 0:case 1:Er=Qr;break;case 4:return wr.label++,{value:Qr[1],done:!1};case 5:wr.label++,Xr=Qr[1],Qr=[0];continue;case 7:Qr=wr.ops.pop(),wr.trys.pop();continue;default:if(Er=wr.trys,!(Er=Er.length>0&&Er[Er.length-1])&&(Qr[0]===6||Qr[0]===2)){wr=0;continue}if(Qr[0]===3&&(!Er||Qr[1]>Er[0]&&Qr[1]<Er[3])){wr.label=Qr[1];break}if(Qr[0]===6&&wr.label<Er[1]){wr.label=Er[1],Er=Qr;break}if(Er&&wr.label<Er[2]){wr.label=Er[2],wr.ops.push(Qr);break}Er[2]&&wr.ops.pop(),wr.trys.pop();continue}Qr=He.call(wt,wr)}catch(Dn){Qr=[6,Dn],Xr=0}finally{Ne=Er=0}if(Qr[0]&5)throw Qr[1];return{value:Qr[0]?Qr[1]:void 0,done:!0}}}function O(wt,He){var wr=typeof Symbol=="function"&&wt[Symbol.iterator];if(!wr)return wt;var Ne=wr.call(wt),Xr,Er=[],Ue;try{for(;(He===void 0||He-- >0)&&!(Xr=Ne.next()).done;)Er.push(Xr.value)}catch(In){Ue={error:In}}finally{try{Xr&&!Xr.done&&(wr=Ne.return)&&wr.call(Ne)}finally{if(Ue)throw Ue.error}}return Er}function C(wt,He,wr){if(wr||arguments.length===2)for(var Ne=0,Xr=He.length,Er;Ne<Xr;Ne++)(Er||!(Ne in He))&&(Er||(Er=Array.prototype.slice.call(He,0,Ne)),Er[Ne]=He[Ne]);return wt.concat(Er||Array.prototype.slice.call(He))}function P(wt){return wt&&wt.__esModule&&Object.prototype.hasOwnProperty.call(wt,"default")?wt.default:wt}var F={exports:{}},Y={exports:{}},V={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=wr;function wr(Ne){return Ne&&typeof Ne.length=="number"&&Ne.length>=0&&Ne.length%1===0}wt.exports=He.default})(V,V.exports);var Q={},k={exports:{}},K={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=function(wr){return function(){for(var Ne=[],Xr=arguments.length;Xr--;)Ne[Xr]=arguments[Xr];var Er=Ne.pop();return wr.call(this,Ne,Er)}},wt.exports=He.default})(K,K.exports);var U={};Object.defineProperty(U,"__esModule",{value:!0}),U.fallback=ve,U.wrap=Te;var Z=U.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,J=U.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,H=U.hasNextTick=typeof D=="object"&&typeof D.nextTick=="function";function ve(wt){setTimeout(wt,0)}function Te(wt){return function(He){for(var wr=[],Ne=arguments.length-1;Ne-- >0;)wr[Ne]=arguments[Ne+1];return wt(function(){return He.apply(void 0,wr)})}}var ye;Z?ye=queueMicrotask:J?ye=setImmediate:H?ye=D.nextTick:ye=ve,U.default=Te(ye),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=an;var wr=K.exports,Ne=In(wr),Xr=U,Er=In(Xr),Ue=Q;function In(On){return On&&On.__esModule?On:{default:On}}function an(On){return(0,Ue.isAsync)(On)?function(){for(var ri=[],zt=arguments.length;zt--;)ri[zt]=arguments[zt];var cr=ri.pop(),Zr=On.apply(this,ri);return Qr(Zr,cr)}:(0,Ne.default)(function(ri,zt){var cr;try{cr=On.apply(this,ri)}catch(Zr){return zt(Zr)}if(cr&&typeof cr.then=="function")return Qr(cr,zt);zt(null,cr)})}function Qr(On,ri){return On.then(function(zt){Dn(ri,null,zt)},function(zt){Dn(ri,zt&&zt.message?zt:new Error(zt))})}function Dn(On,ri,zt){try{On(ri,zt)}catch(cr){(0,Er.default)(function(Zr){throw Zr},cr)}}wt.exports=He.default}(k,k.exports),Object.defineProperty(Q,"__esModule",{value:!0}),Q.isAsyncIterable=Q.isAsyncGenerator=Q.isAsync=void 0;var Ve=k.exports,Re=Ae(Ve);function Ae(wt){return wt&&wt.__esModule?wt:{default:wt}}function ae(wt){return wt[Symbol.toStringTag]==="AsyncFunction"}function ee(wt){return wt[Symbol.toStringTag]==="AsyncGenerator"}function me(wt){return typeof wt[Symbol.asyncIterator]=="function"}function ge(wt){if(typeof wt!="function")throw new Error("expected a function");return ae(wt)?(0,Re.default)(wt):wt}Q.default=ge,Q.isAsync=ae,Q.isAsyncGenerator=ee,Q.isAsyncIterable=me;var fe={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=wr;function wr(Ne,Xr){if(Xr===void 0&&(Xr=Ne.length),!Xr)throw new Error("arity is undefined");function Er(){for(var Ue=this,In=[],an=arguments.length;an--;)In[an]=arguments[an];return typeof In[Xr-1]=="function"?Ne.apply(this,In):new Promise(function(Qr,Dn){In[Xr-1]=function(On){for(var ri=[],zt=arguments.length-1;zt-- >0;)ri[zt]=arguments[zt+1];if(On)return Dn(On);Qr(ri.length>1?ri:ri[0])},Ne.apply(Ue,In)})}return Er}wt.exports=He.default})(fe,fe.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr=V.exports,Ne=an(wr),Xr=Q,Er=an(Xr),Ue=fe.exports,In=an(Ue);function an(Qr){return Qr&&Qr.__esModule?Qr:{default:Qr}}He.default=(0,In.default)(function(Qr,Dn,On){var ri=(0,Ne.default)(Dn)?[]:{};Qr(Dn,function(zt,cr,Zr){(0,Er.default)(zt)(function(Kr){for(var en,Wn=[],De=arguments.length-1;De-- >0;)Wn[De]=arguments[De+1];Wn.length<2&&(en=Wn,Wn=en[0]),ri[cr]=Wn,Zr(Kr)})},function(zt){return On(zt,ri)})},3),wt.exports=He.default}(Y,Y.exports);var Et={exports:{}},xe={exports:{}},je={exports:{}},ue={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=wr;function wr(Ne){function Xr(){for(var Er=[],Ue=arguments.length;Ue--;)Er[Ue]=arguments[Ue];if(Ne!==null){var In=Ne;Ne=null,In.apply(this,Er)}}return Object.assign(Xr,Ne),Xr}wt.exports=He.default})(ue,ue.exports);var Pe={exports:{}},we={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=function(wr){return wr[Symbol.iterator]&&wr[Symbol.iterator]()},wt.exports=He.default})(we,we.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=Dn;var wr=V.exports,Ne=Ue(wr),Xr=we.exports,Er=Ue(Xr);function Ue(On){return On&&On.__esModule?On:{default:On}}function In(On){var ri=-1,zt=On.length;return function(){return++ri<zt?{value:On[ri],key:ri}:null}}function an(On){var ri=-1;return function(){var cr=On.next();return cr.done?null:(ri++,{value:cr.value,key:ri})}}function Qr(On){var ri=On?Object.keys(On):[],zt=-1,cr=ri.length;return function Zr(){var Kr=ri[++zt];return Kr==="__proto__"?Zr():zt<cr?{value:On[Kr],key:Kr}:null}}function Dn(On){if((0,Ne.default)(On))return In(On);var ri=(0,Er.default)(On);return ri?an(ri):Qr(On)}wt.exports=He.default}(Pe,Pe.exports);var nt={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=wr;function wr(Ne){return function(){for(var Xr=[],Er=arguments.length;Er--;)Xr[Er]=arguments[Er];if(Ne===null)throw new Error("Callback was already called.");var Ue=Ne;Ne=null,Ue.apply(this,Xr)}}wt.exports=He.default})(nt,nt.exports);var at={exports:{}},vt={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr={};He.default=wr,wt.exports=He.default})(vt,vt.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=Er;var wr=vt.exports,Ne=Xr(wr);function Xr(Ue){return Ue&&Ue.__esModule?Ue:{default:Ue}}function Er(Ue,In,an,Qr){var Dn=!1,On=!1,ri=!1,zt=0,cr=0;function Zr(){zt>=In||ri||Dn||(ri=!0,Ue.next().then(function(Wn){var De=Wn.value,X=Wn.done;if(!(On||Dn)){if(ri=!1,X){Dn=!0,zt<=0&&Qr(null);return}zt++,an(De,cr,Kr),cr++,Zr()}}).catch(en))}function Kr(Wn,De){if(zt-=1,!On){if(Wn)return en(Wn);if(Wn===!1){Dn=!0,On=!0;return}if(De===Ne.default||Dn&&zt<=0)return Dn=!0,Qr(null);Zr()}}function en(Wn){On||(ri=!1,Dn=!0,Qr(Wn))}Zr()}wt.exports=He.default}(at,at.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr=ue.exports,Ne=zt(wr),Xr=Pe.exports,Er=zt(Xr),Ue=nt.exports,In=zt(Ue),an=Q,Qr=at.exports,Dn=zt(Qr),On=vt.exports,ri=zt(On);function zt(cr){return cr&&cr.__esModule?cr:{default:cr}}He.default=function(cr){return function(Zr,Kr,en){if(en=(0,Ne.default)(en),cr<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Zr)return en(null);if((0,an.isAsyncGenerator)(Zr))return(0,Dn.default)(Zr,cr,Kr,en);if((0,an.isAsyncIterable)(Zr))return(0,Dn.default)(Zr[Symbol.asyncIterator](),cr,Kr,en);var Wn=(0,Er.default)(Zr),De=!1,X=!1,se=0,Be=!1;function Ye(sr,ar){if(!X)if(se-=1,sr)De=!0,en(sr);else if(sr===!1)De=!0,X=!0;else{if(ar===ri.default||De&&se<=0)return De=!0,en(null);Be||ct()}}function ct(){for(Be=!0;se<cr&&!De;){var sr=Wn();if(sr===null){De=!0,se<=0&&en(null);return}se+=1,Kr(sr.value,sr.key,(0,In.default)(Ye))}Be=!1}ct()}},wt.exports=He.default}(je,je.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr=je.exports,Ne=an(wr),Xr=Q,Er=an(Xr),Ue=fe.exports,In=an(Ue);function an(Dn){return Dn&&Dn.__esModule?Dn:{default:Dn}}function Qr(Dn,On,ri,zt){return(0,Ne.default)(On)(Dn,(0,Er.default)(ri),zt)}He.default=(0,In.default)(Qr,4),wt.exports=He.default}(xe,xe.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr=xe.exports,Ne=Ue(wr),Xr=fe.exports,Er=Ue(Xr);function Ue(an){return an&&an.__esModule?an:{default:an}}function In(an,Qr,Dn){return(0,Ne.default)(an,1,Qr,Dn)}He.default=(0,Er.default)(In,3),wt.exports=He.default}(Et,Et.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=In;var wr=Y.exports,Ne=Ue(wr),Xr=Et.exports,Er=Ue(Xr);function Ue(an){return an&&an.__esModule?an:{default:an}}function In(an,Qr){return(0,Ne.default)(Er.default,an,Qr)}wt.exports=He.default}(F,F.exports);var Tt=P(F.exports),ze=function(){function wt(){this.args=[],this.tasks=[]}return wt.prototype.call=function(){for(var He=arguments,wr=[],Ne=0;Ne<arguments.length;Ne++)wr[Ne]=He[Ne];return this.args=wr,Tt(this.tasks)},wt.prototype.tap=function(He,wr){var Ne=this;this.tasks.push(function(Xr){wr.apply(void 0,C([],O(Ne.args),!1)),Xr(null,He)})},wt}(),gr={exports:{}},At={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr=V.exports,Ne=Kr(wr),Xr=vt.exports,Er=Kr(Xr),Ue=xe.exports,In=Kr(Ue),an=ue.exports,Qr=Kr(an),Dn=nt.exports,On=Kr(Dn),ri=Q,zt=Kr(ri),cr=fe.exports,Zr=Kr(cr);function Kr(X){return X&&X.__esModule?X:{default:X}}function en(X,se,Be){Be=(0,Qr.default)(Be);var Ye=0,ct=0,sr=X.length,ar=!1;sr===0&&Be(null);function or(Wt,oe){Wt===!1&&(ar=!0),ar!==!0&&(Wt?Be(Wt):(++ct===sr||oe===Er.default)&&Be(null))}for(;Ye<sr;Ye++)se(X[Ye],Ye,(0,On.default)(or))}function Wn(X,se,Be){return(0,In.default)(X,1/0,se,Be)}function De(X,se,Be){var Ye=(0,Ne.default)(X)?en:Wn;return Ye(X,(0,zt.default)(se),Be)}He.default=(0,Zr.default)(De,3),wt.exports=He.default})(At,At.exports),function(wt,He){Object.defineProperty(He,"__esModule",{value:!0}),He.default=In;var wr=At.exports,Ne=Ue(wr),Xr=Y.exports,Er=Ue(Xr);function Ue(an){return an&&an.__esModule?an:{default:an}}function In(an,Qr){return(0,Er.default)(Ne.default,an,Qr)}wt.exports=He.default}(gr,gr.exports);var hn=P(gr.exports),Wr=function(){function wt(){this.tasks=[]}return wt.prototype.promise=function(){return hn(this.tasks)},wt.prototype.tapPromise=function(He,wr){var Ne=this;this.tasks.push(function(Xr){return N(Ne,void 0,void 0,function(){return h(this,function(Er){switch(Er.label){case 0:return[4,wr()];case 1:return Er.sent(),Xr(null,He),[2]}})})})},wt}(),vr={exports:{}};(function(wt,He){Object.defineProperty(He,"__esModule",{value:!0});var wr=ue.exports,Ne=Dn(wr),Xr=nt.exports,Er=Dn(Xr),Ue=Q,In=Dn(Ue),an=fe.exports,Qr=Dn(an);function Dn(ri){return ri&&ri.__esModule?ri:{default:ri}}function On(ri,zt){if(zt=(0,Ne.default)(zt),!Array.isArray(ri))return zt(new Error("First argument to waterfall must be an array of functions"));if(!ri.length)return zt();var cr=0;function Zr(en){var Wn=(0,In.default)(ri[cr++]);Wn.apply(void 0,en.concat([(0,Er.default)(Kr)]))}function Kr(en){for(var Wn=[],De=arguments.length-1;De-- >0;)Wn[De]=arguments[De+1];if(en!==!1){if(en||cr===ri.length)return zt.apply(void 0,[en].concat(Wn));Zr(Wn)}}Zr([])}He.default=(0,Qr.default)(On),wt.exports=He.default})(vr,vr.exports);var dn=P(vr.exports),tn=function(){function wt(){this.tasks=[]}return wt.prototype.call=function(){return dn(this.tasks)},wt.prototype.tap=function(He,wr){this.tasks.length===0?this.tasks.push(function(Ne){var Xr=wr();Ne(Xr?null:!1,Xr)}):this.tasks.push(function(Ne,Xr){var Er=wr.apply(void 0,C([],O(Ne),!1));Xr(Er?null:!1,He)})},wt}(),un=function(){function wt(){this.tasks=[]}return wt.prototype.call=function(){return Tt(this.tasks)},wt.prototype.tap=function(He,wr){this.tasks.push(function(Ne){var Xr=wr();Ne(Xr,He)})},wt}(),yn=function(){function wt(){this.args=[],this.tasks=[]}return wt.prototype.promise=function(){for(var He=arguments,wr=[],Ne=0;Ne<arguments.length;Ne++)wr[Ne]=He[Ne];return this.args=wr,Tt(this.tasks)},wt.prototype.tapPromise=function(He,wr){var Ne=this;this.tasks.push(function(Xr){return N(Ne,void 0,void 0,function(){return h(this,function(Er){switch(Er.label){case 0:return[4,wr.apply(void 0,C([],O(this.args),!1))];case 1:return Er.sent(),Xr(null,He),[2]}})})})},wt}(),Vt=function(){function wt(){this.args=[],this.tasks=[]}return wt.prototype.promise=function(){for(var He=arguments,wr=[],Ne=0;Ne<arguments.length;Ne++)wr[Ne]=He[Ne];return this.args=wr,Tt(this.tasks)},wt.prototype.tapPromise=function(He,wr){var Ne=this;this.tasks.push(function(Xr){return N(Ne,void 0,void 0,function(){var Er;return h(this,function(Ue){switch(Ue.label){case 0:return[4,wr.apply(void 0,C([],O(this.args),!1))];case 1:return Er=Ue.sent(),Xr(Er,He),[2]}})})})},wt}(),dr=function(){function wt(){this.tasks=[]}return wt.prototype.promise=function(){return dn(this.tasks)},wt.prototype.tapPromise=function(He,wr){this.tasks.length===0?this.tasks.push(function(Ne){wr().then(function(Xr){Ne(null,Xr)})}):this.tasks.push(function(Ne,Xr){wr(Ne).then(function(Er){Xr(null,Er)})})},wt}()},90857:function(Ze){"use strict";var E=Object.prototype.hasOwnProperty,_="~";function D(){}Object.create&&(D.prototype=Object.create(null),new D().__proto__||(_=!1));function N(P,F,Y){this.fn=P,this.context=F,this.once=Y||!1}function h(P,F,Y,V,Q){if(typeof Y!="function")throw new TypeError("The listener must be a function");var k=new N(Y,V||P,Q),K=_?_+F:F;return P._events[K]?P._events[K].fn?P._events[K]=[P._events[K],k]:P._events[K].push(k):(P._events[K]=k,P._eventsCount++),P}function O(P,F){--P._eventsCount===0?P._events=new D:delete P._events[F]}function C(){this._events=new D,this._eventsCount=0}C.prototype.eventNames=function(){var F=[],Y,V;if(this._eventsCount===0)return F;for(V in Y=this._events)E.call(Y,V)&&F.push(_?V.slice(1):V);return Object.getOwnPropertySymbols?F.concat(Object.getOwnPropertySymbols(Y)):F},C.prototype.listeners=function(F){var Y=_?_+F:F,V=this._events[Y];if(!V)return[];if(V.fn)return[V.fn];for(var Q=0,k=V.length,K=new Array(k);Q<k;Q++)K[Q]=V[Q].fn;return K},C.prototype.listenerCount=function(F){var Y=_?_+F:F,V=this._events[Y];return V?V.fn?1:V.length:0},C.prototype.emit=function(F,Y,V,Q,k,K){var U=_?_+F:F;if(!this._events[U])return!1;var Z=this._events[U],J=arguments.length,H,ve;if(Z.fn){switch(Z.once&&this.removeListener(F,Z.fn,void 0,!0),J){case 1:return Z.fn.call(Z.context),!0;case 2:return Z.fn.call(Z.context,Y),!0;case 3:return Z.fn.call(Z.context,Y,V),!0;case 4:return Z.fn.call(Z.context,Y,V,Q),!0;case 5:return Z.fn.call(Z.context,Y,V,Q,k),!0;case 6:return Z.fn.call(Z.context,Y,V,Q,k,K),!0}for(ve=1,H=new Array(J-1);ve<J;ve++)H[ve-1]=arguments[ve];Z.fn.apply(Z.context,H)}else{var Te=Z.length,ye;for(ve=0;ve<Te;ve++)switch(Z[ve].once&&this.removeListener(F,Z[ve].fn,void 0,!0),J){case 1:Z[ve].fn.call(Z[ve].context);break;case 2:Z[ve].fn.call(Z[ve].context,Y);break;case 3:Z[ve].fn.call(Z[ve].context,Y,V);break;case 4:Z[ve].fn.call(Z[ve].context,Y,V,Q);break;default:if(!H)for(ye=1,H=new Array(J-1);ye<J;ye++)H[ye-1]=arguments[ye];Z[ve].fn.apply(Z[ve].context,H)}}return!0},C.prototype.on=function(F,Y,V){return h(this,F,Y,V,!1)},C.prototype.once=function(F,Y,V){return h(this,F,Y,V,!0)},C.prototype.removeListener=function(F,Y,V,Q){var k=_?_+F:F;if(!this._events[k])return this;if(!Y)return O(this,k),this;var K=this._events[k];if(K.fn)K.fn===Y&&(!Q||K.once)&&(!V||K.context===V)&&O(this,k);else{for(var U=0,Z=[],J=K.length;U<J;U++)(K[U].fn!==Y||Q&&!K[U].once||V&&K[U].context!==V)&&Z.push(K[U]);Z.length?this._events[k]=Z.length===1?Z[0]:Z:O(this,k)}return this},C.prototype.removeAllListeners=function(F){var Y;return F?(Y=_?_+F:F,this._events[Y]&&O(this,Y)):(this._events=new D,this._eventsCount=0),this},C.prototype.off=C.prototype.removeListener,C.prototype.addListener=C.prototype.on,C.prefixed=_,C.EventEmitter=C,Ze.exports=C},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(Ze){try{let V=function(){C||(C=!0,h())},Q=function(){try{O.documentElement.doScroll("left")}catch(k){return void setTimeout(Q,50)}V()};var F=V,Y=Q,_=(_=document.getElementsByTagName("script"))[_.length-1],E=_.getAttribute("data-injectcss"),_=_.getAttribute("data-disable-injectsvg");if(!_){var D,N,h,O,C,P=function(K,U){U.parentNode.insertBefore(K,U)};if(E&&!Ze.__iconfont__svg__cssinject__){Ze.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(k){console&&console.log(k)}}D=function(){var K,U=document.createElement("div");U.innerHTML=Ze._iconfont_svg_string_3580659,(U=U.getElementsByTagName("svg")[0])&&(U.setAttribute("aria-hidden","true"),U.style.position="absolute",U.style.width=0,U.style.height=0,U.style.overflow="hidden",U=U,(K=document.body).firstChild?P(U,K.firstChild):K.appendChild(U))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(D,0):(N=function(){document.removeEventListener("DOMContentLoaded",N,!1),D()},document.addEventListener("DOMContentLoaded",N,!1)):document.attachEvent&&(h=D,O=Ze.document,C=!1,Q(),O.onreadystatechange=function(){O.readyState=="complete"&&(O.onreadystatechange=null,V())})}}catch(V){}}(window)},54095:function(Ze,E,_){"use strict";_.d(E,{GC:function(){return yh},h0:function(){return ie},lv:function(){return Jh},lo:function(){return Rn},kw:function(){return on},Or:function(){return Ed},KD:function(){return qe},I9:function(){return ed},lE:function(){return ke},d:function(){return Kr},n3:function(){return ah},vY:function(){return Zf},P7:function(){return Jc},yn:function(){return be},ee:function(){return np},vK:function(){return P},v2:function(){return ho},nC:function(){return ls},e7:function(){return Rs},Hp:function(){return Xo},gl:function(){return po},yT:function(){return da},Vb:function(){return _c}});var D=_(8520),N=_(26729),h=_.n(N),O=_(86700),C=_(84879),P={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),IDebugService:Symbol.for("IDebugService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},F=_(1413),Y=_(15671),V=_(43144),Q=_(97326),k=_(60136),K=_(82963),U=_(61120),Z=_(4942),J=_(57059),H=_(49296),ve=_.n(H);function Te(T,Ke){var he=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!he){if(Array.isArray(T)||(he=ye(T))||Ke&&T&&typeof T.length=="number"){he&&(T=he);var re=0,de=function(){};return{s:de,n:function(){return re>=T.length?{done:!0}:{done:!1,value:T[re++]}},e:function(jt){throw jt},f:de}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,dt=!1,Lt;return{s:function(){he=he.call(T)},n:function(){var jt=he.next();return Oe=jt.done,jt},e:function(jt){dt=!0,Lt=jt},f:function(){try{!Oe&&he.return!=null&&he.return()}finally{if(dt)throw Lt}}}}function ye(T,Ke){if(T){if(typeof T=="string")return Ve(T,Ke);var he=Object.prototype.toString.call(T).slice(8,-1);if(he==="Object"&&T.constructor&&(he=T.constructor.name),he==="Map"||he==="Set")return Array.from(T);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return Ve(T,Ke)}}function Ve(T,Ke){(Ke==null||Ke>T.length)&&(Ke=T.length);for(var he=0,re=new Array(Ke);he<Ke;he++)re[he]=T[he];return re}var Re=30;function Ae(T){var Ke=T.characterSet,he=T.getFontWidth,re=T.fontHeight,de=T.buffer,Oe=T.maxCanvasWidth,dt=T.mapping,Lt=dt===void 0?{}:dt,_t=T.xOffset,jt=_t===void 0?0:_t,Fr=T.yOffset,$r=Fr===void 0?0:Fr,Un=0,Hn=jt;Array.from(Ke).forEach(function(Pi,Jn){if(!Lt[Pi]){var Ei=he(Pi,Jn);Hn+Re>Oe&&(Hn=0,Un++),Lt[Pi]={x:Hn,y:$r+Un*Re,width:Re,height:Re,advance:Ei},Hn+=Re}});var _i=re+de*2;return{mapping:Lt,xOffset:Hn,yOffset:$r+Un*_i,canvasHeight:me($r+(Un+1)*_i)}}function ae(T,Ke,he){var re=0,de=0,Oe=0,dt=[],Lt={},_t=Te(T),jt;try{for(_t.s();!(jt=_t.n()).done;){var Fr=jt.value;if(!Lt[Fr.id]){var $r=Fr.size;re+$r+Ke>he&&(ee(Lt,dt,de),re=0,de=Oe+de+Ke,Oe=0,dt=[]),dt.push({icon:Fr,xOffset:re}),re=re+$r+Ke,Oe=Math.max(Oe,$r)}}}catch(Hn){_t.e(Hn)}finally{_t.f()}dt.length>0&&ee(Lt,dt,de);var Un=me(Oe+de+Ke);return{mapping:Lt,canvasHeight:Un}}function ee(T,Ke,he){var re=Te(Ke),de;try{for(re.s();!(de=re.n()).done;){var Oe=de.value,dt=Oe.icon,Lt=Oe.xOffset;T[dt.id]=(0,F.Z)((0,F.Z)({},dt),{},{x:Lt,y:he,image:dt.image,width:dt.width,height:dt.height})}}catch(_t){re.e(_t)}finally{re.f()}}function me(T){return Math.pow(2,Math.ceil(Math.log2(T)))}var ge,fe;function Et(T,Ke){var he=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!he){if(Array.isArray(T)||(he=xe(T))||Ke&&T&&typeof T.length=="number"){he&&(T=he);var re=0,de=function(){};return{s:de,n:function(){return re>=T.length?{done:!0}:{done:!1,value:T[re++]}},e:function(jt){throw jt},f:de}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,dt=!1,Lt;return{s:function(){he=he.call(T)},n:function(){var jt=he.next();return Oe=jt.done,jt},e:function(jt){dt=!0,Lt=jt},f:function(){try{!Oe&&he.return!=null&&he.return()}finally{if(dt)throw Lt}}}}function xe(T,Ke){if(T){if(typeof T=="string")return je(T,Ke);var he=Object.prototype.toString.call(T).slice(8,-1);if(he==="Object"&&T.constructor&&(he=T.constructor.name),he==="Map"||he==="Set")return Array.from(T);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return je(T,Ke)}}function je(T,Ke){(Ke==null||Ke>T.length)&&(Ke=T.length);for(var he=0,re=new Array(Ke);he<Ke;he++)re[he]=T[he];return re}function ue(T){var Ke=Pe();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Pe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var we=tn(),nt="sans-serif",at="normal",vt=24,Tt=3,ze=.25,gr=8,At=1024,hn=1,Wr=1,vr=3,dn=null;function tn(){for(var T=[],Ke=32;Ke<128;Ke++)T.push(String.fromCharCode(Ke));return T}function un(T,Ke,he,re){T.font="".concat(re," ").concat(he,"px ").concat(Ke),T.fillStyle="black",T.textBaseline="middle"}function yn(T,Ke){for(var he=0;he<T.length;he++)Ke.data[4*he+3]=T[he]}var Vt=(ge=(0,O.b2)(),ge(fe=function(T){(0,k.Z)(he,T);var Ke=ue(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,Z.Z)((0,Q.Z)(re),"fontAtlas",void 0),(0,Z.Z)((0,Q.Z)(re),"iconFontMap",void 0),(0,Z.Z)((0,Q.Z)(re),"iconFontGlyphs",{}),(0,Z.Z)((0,Q.Z)(re),"fontOptions",void 0),(0,Z.Z)((0,Q.Z)(re),"key",void 0),(0,Z.Z)((0,Q.Z)(re),"cache",new J.z6(vr)),re}return(0,V.Z)(he,[{key:"scale",get:function(){return Wr}},{key:"canvas",get:function(){var de=this.cache.get(this.key);return de&&de.data}},{key:"mapping",get:function(){var de=this.cache.get(this.key);return de&&de.mapping||{}}},{key:"getCanvasByKey",value:function(de){var Oe=this.cache.get(de);return Oe&&Oe.data}},{key:"getMappingByKey",value:function(de){var Oe=this.cache.get(de);return Oe&&Oe.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:nt,fontWeight:at,characterSet:we,fontSize:vt,buffer:Tt,sdf:!0,cutoff:ze,radius:gr,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(de){var Oe=this;de.forEach(function(dt){Oe.iconFontGlyphs[dt.name]=dt.unicode})}},{key:"addIconFont",value:function(de,Oe){this.iconFontMap.set(de,Oe)}},{key:"getIconFontKey",value:function(de){return this.iconFontMap.get(de)||de}},{key:"getGlyph",value:function(de){return this.iconFontGlyphs[de]?String.fromCharCode(parseInt(this.iconFontGlyphs[de],16)):""}},{key:"setFontOptions",value:function(de){this.fontOptions=(0,F.Z)((0,F.Z)({},this.fontOptions),de),this.key=this.getKey();var Oe=this.getNewChars(this.key,this.fontOptions.characterSet),dt=this.cache.get(this.key);if(!(dt&&Oe.length===0)){var Lt=this.generateFontAtlas(this.key,Oe,dt);this.fontAtlas=Lt,this.cache.set(this.key,Lt)}}},{key:"addFontFace",value:function(de,Oe){var dt=this,Lt=document.createElement("style");Lt.type="text/css",Lt.innerText=`
        @font-face{
            font-family: '`.concat(de,`';
            src: url('`).concat(Oe,`') format('woff2'),
            url('`).concat(Oe,`') format('woff'),
            url('`).concat(Oe,`') format('truetype');
        }`),Lt.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(de),"L7text"),document.fonts.ready.then(function(){dt.emit("fontloaded",{fontFamily:de})})}catch(_t){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(_t)}},document.getElementsByTagName("head")[0].appendChild(Lt)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(de,Oe,dt){var Lt=this.fontOptions,_t=Lt.fontFamily,jt=Lt.fontWeight,Fr=Lt.fontSize,$r=Lt.buffer,Un=Lt.sdf,Hn=Lt.radius,_i=Lt.cutoff,Pi=Lt.iconfont,Jn=dt&&dt.data;Jn||(Jn=window.document.createElement("canvas"),Jn.width=At);var Ei=Jn.getContext("2d",{willReadFrequently:!0});un(Ei,_t,Fr,jt);var ya=Ae((0,F.Z)({getFontWidth:function(ef){return Ei.measureText(ef).width},fontHeight:Fr*Wr,buffer:$r,characterSet:Oe,maxCanvasWidth:At},dt&&{mapping:dt.mapping,xOffset:dt.xOffset,yOffset:dt.yOffset})),ia=ya.mapping,zo=ya.canvasHeight,co=ya.xOffset,Eo=ya.yOffset,_a=Ei.getImageData(0,0,Jn.width,Jn.height);if(Jn.height=zo,Ei.putImageData(_a,0,0),un(Ei,_t,Fr,jt),Un){var Da=new(ve())(Fr,$r,Hn,_i,_t,jt),Io=Ei.getImageData(0,0,Da.size,Da.size),Zo=Et(Oe),ts;try{for(Zo.s();!(ts=Zo.n()).done;){var Oo=ts.value;if(Pi){var oo=String.fromCharCode(parseInt(Oo.replace("&#x","").replace(";",""),16)),fo=Da.draw(oo);yn(fo,Io)}else yn(Da.draw(Oo),Io);Ei.putImageData(Io,ia[Oo].x,ia[Oo].y)}}catch(Ac){Zo.e(Ac)}finally{Zo.f()}}else{var Dl=Et(Oe),Kl;try{for(Dl.s();!(Kl=Dl.n()).done;){var Af=Kl.value;Ei.fillText(Af,ia[Af].x,ia[Af].y+Fr*hn)}}catch(Ac){Dl.e(Ac)}finally{Dl.f()}}return{xOffset:co,yOffset:Eo,mapping:ia,data:Jn,width:Jn.width,height:Jn.height}}},{key:"getKey",value:function(){var de=this.fontOptions,Oe=de.fontFamily,dt=de.fontWeight;return"".concat(Oe,"_").concat(dt)}},{key:"getNewChars",value:function(de,Oe){var dt=this.cache.get(de);if(!dt)return Oe;var Lt=[],_t=dt.mapping,jt=new Set(Object.keys(_t)),Fr=new Set(Oe);return Fr.forEach(function($r){jt.has($r)||Lt.push($r)}),Lt}}]),he}(N.EventEmitter))||fe),dr=_(15861),wt=_(64687),He=_.n(wt),wr,Ne;function Xr(T){var Ke=Er();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Er(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Ue=3,In=1024,an=64,Qr=(wr=(0,O.b2)(),wr(Ne=function(T){(0,k.Z)(he,T);var Ke=Xr(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,Z.Z)((0,Q.Z)(re),"canvasHeight",128),(0,Z.Z)((0,Q.Z)(re),"texture",void 0),(0,Z.Z)((0,Q.Z)(re),"canvas",void 0),(0,Z.Z)((0,Q.Z)(re),"iconData",void 0),(0,Z.Z)((0,Q.Z)(re),"iconMap",void 0),(0,Z.Z)((0,Q.Z)(re),"ctx",void 0),(0,Z.Z)((0,Q.Z)(re),"loadingImageCount",0),re}return(0,V.Z)(he,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var re=(0,dr.Z)(He().mark(function Oe(dt,Lt){var _t,jt;return He().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return _t=new Image,this.loadingImageCount++,this.hasImage(dt)?console.warn("Image Id already exists"):this.iconData.push({id:dt,size:an}),this.updateIconMap(),$r.next=6,this.loadImage(Lt);case 6:_t=$r.sent,jt=this.iconData.find(function(Un){return Un.id===dt}),jt&&(jt.image=_t,jt.width=_t.width,jt.height=_t.height),this.update();case 10:case"end":return $r.stop()}},Oe,this)}));function de(Oe,dt){return re.apply(this,arguments)}return de}()},{key:"addImageMini",value:function(de,Oe,dt){var Lt=this,_t=dt.getSceneConfig().canvas,jt=_t.createImage();if(this.loadingImageCount++,this.hasImage(de))throw new Error("Image Id already exists");this.iconData.push({id:de,size:an}),this.updateIconMap(),this.loadImageMini(Oe,_t).then(function(Fr){jt=Fr;var $r=Lt.iconData.find(function(Un){return Un.id===de});$r&&($r.image=jt,$r.width=jt.width,$r.height=jt.height),Lt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(de){return this.iconMap.hasOwnProperty(de)}},{key:"removeImage",value:function(de){this.hasImage(de)&&(this.iconData=this.iconData.filter(function(Oe){return Oe.id!==de}),delete this.iconMap[de],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(de){return new Promise(function(Oe,dt){if(de instanceof HTMLImageElement){Oe(de);return}var Lt=new Image;Lt.crossOrigin="anonymous",Lt.onload=function(){Oe(Lt)},Lt.onerror=function(){dt(new Error("Could not load image at "+de))},Lt.src=de instanceof File?URL.createObjectURL(de):de})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var de=this;this.canvas.width=In,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(Oe){var dt=de.iconMap[Oe],Lt=dt.x,_t=dt.y,jt=dt.image,Fr=dt.width,$r=Fr===void 0?64:Fr,Un=dt.height,Hn=Un===void 0?64:Un,_i=Math.max($r,Hn),Pi=_i/an,Jn=Hn/Pi,Ei=$r/Pi;jt&&de.ctx.drawImage(jt,Lt+(an-Ei)/2,_t+(an-Jn)/2,Ei,Jn)})}},{key:"updateIconMap",value:function(){var de=ae(this.iconData,Ue,In),Oe=de.mapping,dt=de.canvasHeight;this.iconMap=Oe,this.canvasHeight=dt}},{key:"loadImageMini",value:function(de,Oe){return new Promise(function(dt,Lt){var _t=Oe.createImage();_t.crossOrigin="anonymous",_t.onload=function(){dt(_t)},_t.onerror=function(){Lt(new Error("Could not load image at "+de))},_t.src=de})}}]),he}(N.EventEmitter))||Ne),Dn=_(97685),On=_(85975),ri,zt,cr=(ri=(0,O.b2)(),ri(zt=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"viewport",void 0),(0,Z.Z)(this,"overridedViewProjectionMatrix",void 0),(0,Z.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,Z.Z)(this,"jitteredProjectionMatrix",void 0),(0,Z.Z)(this,"viewMatrixInverse",void 0),(0,Z.Z)(this,"cameraPosition",void 0)}return(0,V.Z)(T,[{key:"init",value:function(){}},{key:"update",value:function(he){this.viewport=he,this.viewMatrixInverse=On.create(),On.invert(this.viewMatrixInverse,he.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var he=this.viewport.getCenter(),re=(0,Dn.Z)(he,2),de=re[0],Oe=re[1];return[de,Oe]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(he,re){return this.viewport.projectFlat(he,re)}},{key:"setViewProjectionMatrix",value:function(he){this.overridedViewProjectionMatrix=he}},{key:"jitterProjectionMatrix",value:function(he,re){var de=On.fromTranslation(On.create(),[he,re,0]);this.jitteredProjectionMatrix=On.multiply(On.create(),de,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=On.multiply(On.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),T}())||zt),Zr=_(74902),Kr=function(T){return T.TOPRIGHT="topright",T.TOPLEFT="topleft",T.BOTTOMRIGHT="bottomright",T.BOTTOMLEFT="bottomleft",T.TOPCENTER="topcenter",T.BOTTOMCENTER="bottomcenter",T.LEFTCENTER="leftcenter",T.RIGHTCENTER="rightcenter",T.LEFTTOP="lefttop",T.RIGHTTOP="righttop",T.LEFTBOTTOM="leftbottom",T.RIGHTBOTTOM="rightbottom",T}({}),en,Wn;function De(T,Ke){var he=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!he){if(Array.isArray(T)||(he=X(T))||Ke&&T&&typeof T.length=="number"){he&&(T=he);var re=0,de=function(){};return{s:de,n:function(){return re>=T.length?{done:!0}:{done:!1,value:T[re++]}},e:function(jt){throw jt},f:de}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,dt=!1,Lt;return{s:function(){he=he.call(T)},n:function(){var jt=he.next();return Oe=jt.done,jt},e:function(jt){dt=!0,Lt=jt},f:function(){try{!Oe&&he.return!=null&&he.return()}finally{if(dt)throw Lt}}}}function X(T,Ke){if(T){if(typeof T=="string")return se(T,Ke);var he=Object.prototype.toString.call(T).slice(8,-1);if(he==="Object"&&T.constructor&&(he=T.constructor.name),he==="Map"||he==="Set")return Array.from(T);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return se(T,Ke)}}function se(T,Ke){(Ke==null||Ke>T.length)&&(Ke=T.length);for(var he=0,re=new Array(Ke);he<Ke;he++)re[he]=T[he];return re}var Be={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},Ye=(en=(0,O.b2)(),en(Wn=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"container",void 0),(0,Z.Z)(this,"controlCorners",void 0),(0,Z.Z)(this,"controlContainer",void 0),(0,Z.Z)(this,"scene",void 0),(0,Z.Z)(this,"mapsService",void 0),(0,Z.Z)(this,"controls",[]),(0,Z.Z)(this,"unAddControls",[])}return(0,V.Z)(T,[{key:"init",value:function(he,re){this.container=he.container,this.scene=re,this.mapsService=re.get(P.IMapService),this.initControlPos()}},{key:"addControl",value:function(he,re){var de=re.get(P.IMapService);de.map?(he.addTo(this.scene),this.controls.push(he)):this.unAddControls.push(he)}},{key:"getControlByName",value:function(he){return this.controls.find(function(re){return re.controlOption.name===he})}},{key:"removeControl",value:function(he){var re=this.controls.indexOf(he);return re>-1&&this.controls.splice(re,1),he.remove(),this}},{key:"addControls",value:function(){var he=this;this.unAddControls.forEach(function(re){re.addTo(he.scene),he.controls.push(re)}),this.unAddControls=[]}},{key:"destroy",value:function(){var he=De(this.controls),re;try{for(he.s();!(re=he.n()).done;){var de=re.value;de.remove()}}catch(Oe){he.e(Oe)}finally{he.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var he=this.controlCorners={},re="l7-",de=this.controlContainer=J.SO.create("div",re+"control-container",this.container);function Oe(){var Lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_t=Lt.map(function(jt){return re+jt}).join(" ");he[Lt.filter(function(jt){return!["row","column"].includes(jt)}).join("")]=J.SO.create("div",_t,de)}function dt(Lt){var _t=Lt.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,Zr.Z)(_t),[Be[Lt]])}Object.values(Kr).forEach(function(Lt){Oe(dt(Lt))}),this.checkCornerOverlap()}},{key:"clearControlPos",value:function(){for(var he in this.controlCorners)this.controlCorners[he]&&J.SO.remove(this.controlCorners[he]);this.controlContainer&&J.SO.remove(this.controlContainer)}},{key:"checkCornerOverlap",value:function(){var he=this,re=window.MutationObserver;if(re)for(var de=function(){var _t=dt[Oe],jt=_t.match(/^(top|bottom)(left|right)$/);if(jt){var Fr=(0,Dn.Z)(jt,3),$r=Fr[1],Un=Fr[2],Hn=he.controlCorners["".concat($r).concat(Un)],_i=new re(function(Pi){var Jn=(0,Dn.Z)(Pi,1),Ei=Jn[0].target;Hn&&(Hn.style[$r]=Ei.clientHeight+"px")});_i.observe(he.controlCorners["".concat(Un).concat($r)],{childList:!0,attributes:!0})}},Oe=0,dt=Object.keys(this.controlCorners);Oe<dt.length;Oe++)de()}}]),T}())||Wn),ct,sr,ar=(ct=(0,O.b2)(),ct(sr=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"container",void 0),(0,Z.Z)(this,"scene",void 0),(0,Z.Z)(this,"mapsService",void 0),(0,Z.Z)(this,"markers",[]),(0,Z.Z)(this,"markerLayers",[]),(0,Z.Z)(this,"unAddMarkers",[]),(0,Z.Z)(this,"unAddMarkerLayers",[])}return(0,V.Z)(T,[{key:"addMarkerLayer",value:function(he){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(he),he.addTo(this.scene)):this.unAddMarkerLayers.push(he)}},{key:"removeMarkerLayer",value:function(he){he.destroy(),this.markerLayers.indexOf(he);var re=this.markerLayers.indexOf(he);re>-1&&this.markerLayers.splice(re,1)}},{key:"addMarker",value:function(he){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(he),he.addTo(this.scene)):this.unAddMarkers.push(he)}},{key:"addMarkers",value:function(){var he=this;this.unAddMarkers.forEach(function(re){re.addTo(he.scene),he.markers.push(re)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var he=this;this.unAddMarkerLayers.forEach(function(re){he.markerLayers.push(re),re.addTo(he.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(he){he.remove(),this.markers.indexOf(he);var re=this.markers.indexOf(he);re>-1&&this.markers.splice(re,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(he){this.scene=he,this.mapsService=he.get(P.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(he){he.remove()}),this.markers=[],this.markerLayers.forEach(function(he){he.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(he){he.destroy()}}]),T}())||sr),or,Wt,oe=(or=(0,O.b2)(),or(Wt=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"scene",void 0),(0,Z.Z)(this,"mapsService",void 0),(0,Z.Z)(this,"popups",[]),(0,Z.Z)(this,"unAddPopups",[])}return(0,V.Z)(T,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(he){he!=null&&he.isOpen()&&he.remove();var re=this.popups.indexOf(he);re>-1&&this.popups.splice(re,1);var de=this.unAddPopups.indexOf(he);de>-1&&this.unAddPopups.splice(de,1)}},{key:"destroy",value:function(){this.popups.forEach(function(he){return he.remove()})}},{key:"addPopup",value:function(he){var re=this;he&&he.getOptions().autoClose&&[].concat((0,Zr.Z)(this.popups),(0,Zr.Z)(this.unAddPopups)).forEach(function(de){de.getOptions().autoClose&&re.removePopup(de)}),this.isMarkerReady?(he.addTo(this.scene),this.popups.push(he)):this.unAddPopups.push(he),he.on("close",function(){re.removePopup(he)})}},{key:"initPopup",value:function(){var he=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(re){he.addPopup(re),he.unAddPopups=[]})}},{key:"init",value:function(he){this.scene=he,this.mapsService=he.get(P.IMapService)}}]),T}())||Wt),ie=function(T){return T.normal="normal",T.additive="additive",T.subtractive="subtractive",T.min="min",T.max="max",T.none="none",T}({}),be=function(T){return T.MULTIPLE="MULTIPLE",T.SINGLE="SINGLE",T}({}),ke=function(T){return T.AND="and",T.OR="or",T}({}),qe=function(T){return T.INIT="init",T.UPDATE="update",T}({}),mt={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A \u9AD8\u5FB7\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox\u5730\u56FE\u7533\u8BF7\u5730\u5740 https://docs.mapbox.com/help/glossary/access-token/",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},kt=mt,$e,Ge,We=J.rU.merge,G={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},rt={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:ke.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},ft=($e=(0,O.b2)(),$e(Ge=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"sceneConfigCache",{}),(0,Z.Z)(this,"layerConfigCache",{}),(0,Z.Z)(this,"layerAttributeConfigCache",{})}return(0,V.Z)(T,[{key:"getSceneConfig",value:function(he){return this.sceneConfigCache[he]}},{key:"getSceneWarninfo",value:function(he){return kt[he]}},{key:"setSceneConfig",value:function(he,re){this.sceneConfigCache[he]=(0,F.Z)((0,F.Z)({},G),re)}},{key:"getLayerConfig",value:function(he){return this.layerConfigCache[he]}},{key:"setLayerConfig",value:function(he,re,de){this.layerConfigCache[re]=(0,F.Z)({},We({},this.sceneConfigCache[he],rt,de))}},{key:"getAttributeConfig",value:function(he){return this.layerAttributeConfigCache[he]}},{key:"setAttributeConfig",value:function(he,re){this.layerAttributeConfigCache[he]=(0,F.Z)((0,F.Z)({},this.layerAttributeConfigCache[he]),re)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),T}())||Ge),bt=_(43269),Gt=_(53229),lr=_(98333),Ht=Math.PI/180,Cr=512,hr=4003e4;function Dr(T){var Ke=T.latitude,he=Ke===void 0?0:Ke,re=T.zoom,de=re===void 0?0:re,Oe=T.scale,dt=T.highPrecision,Lt=dt===void 0?!1:dt,_t=T.flipY,jt=_t===void 0?!1:_t;Oe=Oe!==void 0?Oe:Math.pow(2,de);var Fr={},$r=Cr*Oe,Un=Math.cos(he*Ht),Hn=$r/360,_i=Hn/Un,Pi=$r/hr/Un;if(Fr.pixelsPerMeter=[Pi,-Pi,Pi],Fr.metersPerPixel=[1/Pi,-1/Pi,1/Pi],Fr.pixelsPerDegree=[Hn,-_i,Pi],Fr.degreesPerPixel=[1/Hn,-1/_i,1/Pi],Lt){var Jn=Ht*Math.tan(he*Ht)/Un,Ei=Hn*Jn/2,ya=$r/hr*Jn,ia=ya/_i*Pi;Fr.pixelsPerDegree2=[0,-Ei,ya],Fr.pixelsPerMeter2=[ia,0,ia],jt&&(Fr.pixelsPerDegree2[1]=-Fr.pixelsPerDegree2[1],Fr.pixelsPerMeter2[1]=-Fr.pixelsPerMeter2[1])}return jt&&(Fr.pixelsPerMeter[1]=-Fr.pixelsPerMeter[1],Fr.metersPerPixel[1]=-Fr.metersPerPixel[1],Fr.pixelsPerDegree[1]=-Fr.pixelsPerDegree[1],Fr.degreesPerPixel[1]=-Fr.degreesPerPixel[1]),Fr}var Rn=function(T){return T[T.LNGLAT=1]="LNGLAT",T[T.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",T[T.VECTOR_TILE=3]="VECTOR_TILE",T[T.IDENTITY=4]="IDENTITY",T[T.P20=5]="P20",T[T.P20_OFFSET=6]="P20_OFFSET",T[T.METER_OFFSET=7]="METER_OFFSET",T[T.P20_2=8]="P20_2",T}({}),on={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},fi,Mi,di,mn,Zn,sa=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],qi=(fi=(0,O.b2)(),Mi=(0,O.f3)(P.ICameraService),fi(di=(mn=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"needRefresh",!0),(0,bt.Z)(this,"cameraService",Zn,this),(0,Z.Z)(this,"coordinateSystem",void 0),(0,Z.Z)(this,"viewportCenter",void 0),(0,Z.Z)(this,"viewportCenterProjection",void 0),(0,Z.Z)(this,"pixelsPerDegree",void 0),(0,Z.Z)(this,"pixelsPerDegree2",void 0),(0,Z.Z)(this,"pixelsPerMeter",void 0)}return(0,V.Z)(T,[{key:"refresh",value:function(he){var re=this.cameraService.getZoom(),de=this.cameraService.getZoomScale(),Oe=he||this.cameraService.getCenter(),dt=Dr({latitude:Oe[1],zoom:re}),Lt=dt.pixelsPerMeter,_t=dt.pixelsPerDegree;this.viewportCenter=Oe,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Lt,this.pixelsPerDegree=_t,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Rn.LNGLAT||this.coordinateSystem===Rn.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Rn.LNGLAT_OFFSET?this.calculateLnglatOffset(Oe,re):this.coordinateSystem===Rn.P20_OFFSET&&this.calculateLnglatOffset(Oe,re,de,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(he){this.coordinateSystem=he}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(he,re,de,Oe){var dt=Dr({latitude:he[1],zoom:re,scale:de,flipY:Oe,highPrecision:!0}),Lt=dt.pixelsPerMeter,_t=dt.pixelsPerDegree,jt=dt.pixelsPerDegree2,Fr=this.cameraService.getViewMatrix(),$r=this.cameraService.getProjectionMatrix(),Un=On.multiply([],$r,Fr),Hn=this.cameraService.projectFlat([Math.fround(he[0]),Math.fround(he[1])],Math.pow(2,re));this.viewportCenterProjection=lr.fF([],[Hn[0],Hn[1],0,1],Un),Fr=this.cameraService.getViewMatrixUncentered()||Fr,Un=On.multiply([],$r,Fr),Un=On.multiply([],Un,sa),this.cameraService.setViewProjectionMatrix(Un),this.pixelsPerMeter=Lt,this.pixelsPerDegree=_t,this.pixelsPerDegree2=jt}}]),T}(),Zn=(0,Gt.Z)(mn.prototype,"cameraService",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn))||di),Sa=_(71002),Zi,Oi;function jr(T){var Ke=Fi();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Fi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Ls=(Zi=(0,O.b2)(),Zi(Oi=function(T){(0,k.Z)(he,T);var Ke=jr(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,Z.Z)((0,Q.Z)(re),"renderMap",new Map),(0,Z.Z)((0,Q.Z)(re),"enable",!1),(0,Z.Z)((0,Q.Z)(re),"renderEnable",!1),(0,Z.Z)((0,Q.Z)(re),"cacheLogs",{}),re}return(0,V.Z)(he,[{key:"setEnable",value:function(de){this.enable=!!de}},{key:"log",value:function(de,Oe){var dt=this;if(this.enable){var Lt=de.split("."),_t=null;Lt.forEach(function(jt,Fr){_t!==null?(_t[jt]||(_t[jt]={}),Fr!==Lt.length-1&&(_t=_t[jt])):(dt.cacheLogs[jt]||(dt.cacheLogs[jt]={}),Fr!==Lt.length-1&&(_t=dt.cacheLogs[jt])),Fr===Lt.length-1&&(_t[jt]=(0,F.Z)((0,F.Z)({time:Date.now()},_t[jt]),Oe))})}}},{key:"getLog",value:function(de){var Oe=this;switch((0,Sa.Z)(de)){case"string":return this.cacheLogs[de];case"object":return de.map(function(dt){return Oe.cacheLogs[dt]}).filter(function(dt){return dt!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(de){delete this.cacheLogs[de]}},{key:"generateRenderUid",value:function(){return this.renderEnable?(0,J.M8)():""}},{key:"renderDebug",value:function(de){this.renderEnable=de}},{key:"renderStart",value:function(de){if(!(!this.renderEnable||!this.enable)){var Oe=this.renderMap.get(de)||{};this.renderMap.set(de,(0,F.Z)((0,F.Z)({},Oe),{},{renderUid:de,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(de){if(!(!this.renderEnable||!this.enable)){var Oe=this.renderMap.get(de);if(Oe){var dt=Oe.renderStart,Lt=Date.now();this.emit("renderEnd",(0,F.Z)((0,F.Z)({},Oe),{},{renderEnd:Lt,renderDuration:Lt-dt})),this.renderMap.delete(de)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),he}(N.EventEmitter))||Oi),Ta=_(50840),Aa=_.n(Ta),go=function(T){return T.Hover="hover",T.Click="click",T.Select="select",T.Active="active",T.Drag="drag",T}({}),os,ka,Ao,za,Ja;function Oa(T){var Ke=Za();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Za(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var qo={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},Ca=(os=(0,O.b2)(),ka=(0,O.f3)(P.IMapService),os(Ao=(za=function(T){(0,k.Z)(he,T);var Ke=Oa(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,Z.Z)((0,Q.Z)(re),"indragging",!1),(0,bt.Z)((0,Q.Z)(re),"mapService",Ja,(0,Q.Z)(re)),(0,Z.Z)((0,Q.Z)(re),"hammertime",void 0),(0,Z.Z)((0,Q.Z)(re),"lastClickTime",0),(0,Z.Z)((0,Q.Z)(re),"lastClickXY",[-1,-1]),(0,Z.Z)((0,Q.Z)(re),"clickTimer",void 0),(0,Z.Z)((0,Q.Z)(re),"$containter",void 0),(0,Z.Z)((0,Q.Z)(re),"onDrag",function(Lt){var _t=re.interactionEvent(Lt);_t.type=qo[_t.type],_t.type==="dragging"?re.indragging=!0:re.indragging=!1,re.emit(go.Drag,_t)}),(0,Z.Z)((0,Q.Z)(re),"onHammer",function(Lt){Lt.srcEvent.stopPropagation();var _t=re.interactionEvent(Lt);re.emit(go.Hover,_t)}),(0,Z.Z)((0,Q.Z)(re),"onTouch",function(Lt){var _t=Lt.touches[0];re.onHover({clientX:_t.clientX,clientY:_t.clientY,type:"touchstart"})}),(0,Z.Z)((0,Q.Z)(re),"onTouchEnd",function(Lt){if(Lt.changedTouches.length>0){var _t=Lt.changedTouches[0];re.onHover({clientX:_t.clientX,clientY:_t.clientY,type:"touchend"})}}),(0,Z.Z)((0,Q.Z)(re),"onTouchMove",function(Lt){var _t=Lt.changedTouches[0];re.onHover({clientX:_t.clientX,clientY:_t.clientY,type:"touchmove"})}),(0,Z.Z)((0,Q.Z)(re),"onHover",function(Lt){var _t=Lt.clientX,jt=Lt.clientY,Fr=_t,$r=jt,Un=Lt.type,Hn=re.mapService.getMapContainer();if(Hn){var _i=Hn.getBoundingClientRect(),Pi=_i.top,Jn=_i.left;Fr=Fr-Jn-Hn.clientLeft,$r=$r-Pi-Hn.clientTop}var Ei=re.mapService.containerToLngLat([Fr,$r]);if(Un==="click"){re.isDoubleTap(Fr,$r,Ei);return}if(Un==="touch"){re.isDoubleTap(Fr,$r,Ei);return}Un!=="click"&&Un!=="dblclick"&&re.emit(go.Hover,{x:Fr,y:$r,lngLat:Ei,type:Un,target:Lt})}),re}return(0,V.Z)(he,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(go.Hover)}},{key:"triggerHover",value:function(de){var Oe=de.x,dt=de.y;this.emit(go.Hover,{x:Oe,y:dt})}},{key:"triggerSelect",value:function(de){this.emit(go.Select,{featureId:de})}},{key:"triggerActive",value:function(de){this.emit(go.Active,{featureId:de})}},{key:"addEventListenerOnMap",value:function(){var de=this.mapService.getMapContainer();if(de){var Oe=new(Aa()).Manager(de);Oe.add(new(Aa()).Tap({event:"dblclick",taps:2})),Oe.add(new(Aa()).Tap({event:"click"})),Oe.add(new(Aa()).Pan({threshold:0,pointers:0})),Oe.add(new(Aa()).Press({})),Oe.on("dblclick click",this.onHammer),Oe.on("panstart panmove panend pancancel",this.onDrag),de.addEventListener("touchstart",this.onTouch),de.addEventListener("touchend",this.onTouchEnd),de.addEventListener("mousemove",this.onHover),de.addEventListener("touchmove",this.onTouchMove),de.addEventListener("mousedown",this.onHover,!0),de.addEventListener("mouseup",this.onHover),de.addEventListener("contextmenu",this.onHover),this.hammertime=Oe}}},{key:"removeEventListenerOnMap",value:function(){var de=this.mapService.getMapContainer();de&&(de.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),de.removeEventListener("touchstart",this.onTouch),de.removeEventListener("touchend",this.onTouchEnd),de.removeEventListener("mousedown",this.onHover),de.removeEventListener("mouseup",this.onHover),de.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(de){var Oe=de.type,dt=de.pointerType,Lt,_t;dt==="touch"?(_t=Math.floor(de.pointers[0].clientY),Lt=Math.floor(de.pointers[0].clientX)):(_t=Math.floor(de.srcEvent.y),Lt=Math.floor(de.srcEvent.x));var jt=this.mapService.getMapContainer();if(jt){var Fr=jt.getBoundingClientRect(),$r=Fr.top,Un=Fr.left;Lt-=Un,_t-=$r}var Hn=this.mapService.containerToLngLat([Lt,_t]);return{x:Lt,y:_t,lngLat:Hn,type:Oe,target:de.srcEvent}}},{key:"isDoubleTap",value:function(de,Oe,dt){var Lt=this,_t=new Date().getTime(),jt="click";_t-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-de)<10&&Math.abs(this.lastClickXY[1]-Oe)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),jt="dblclick",this.emit(go.Hover,{x:de,y:Oe,lngLat:dt,type:jt})):(this.lastClickTime=_t,this.lastClickXY=[de,Oe],this.clickTimer=setTimeout(function(){jt="click",Lt.emit(go.Hover,{x:de,y:Oe,lngLat:dt,type:jt})},400))}}]),he}(h()),Ja=(0,Gt.Z)(za.prototype,"mapService",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),za))||Ao),io=0;function Do(T){var Ke=T;if(typeof T=="string"&&(Ke=document.getElementById(T)),Ke){var he=document.createElement("div");return he.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,he.id="l7-scene-".concat(io++),he.classList.add("l7-scene"),Ke.appendChild(he),he}return null}function $(T){var Ke,he=!0;if((T==null||(Ke=T.target)===null||Ke===void 0?void 0:Ke.target)instanceof HTMLElement)for(var re,de=T==null||(re=T.target)===null||re===void 0?void 0:re.target;de;){var Oe,dt=Array.from(de.classList);if(dt.includes("l7-marker")||dt.includes("l7-popup")){he=!1;break}de=(Oe=de)===null||Oe===void 0?void 0:Oe.parentElement}return he}var ho=function(T){return T[T.SAMPLED=0]="SAMPLED",T[T.RENDER_TARGET=1]="RENDER_TARGET",T}({}),ja,gs,Vo,Je,yt,Qt,Ur,Tn,mi,la,Ho,ss,ko;function gu(T,Ke){var he=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!he){if(Array.isArray(T)||(he=Ws(T))||Ke&&T&&typeof T.length=="number"){he&&(T=he);var re=0,de=function(){};return{s:de,n:function(){return re>=T.length?{done:!0}:{done:!1,value:T[re++]}},e:function(jt){throw jt},f:de}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,dt=!1,Lt;return{s:function(){he=he.call(T)},n:function(){var jt=he.next();return Oe=jt.done,jt},e:function(jt){dt=!0,Lt=jt},f:function(){try{!Oe&&he.return!=null&&he.return()}finally{if(dt)throw Lt}}}}function Ws(T,Ke){if(T){if(typeof T=="string")return cf(T,Ke);var he=Object.prototype.toString.call(T).slice(8,-1);if(he==="Object"&&T.constructor&&(he=T.constructor.name),he==="Map"||he==="Set")return Array.from(T);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return cf(T,Ke)}}function cf(T,Ke){(Ke==null||Ke>T.length)&&(Ke=T.length);for(var he=0,re=new Array(Ke);he<Ke;he++)re[he]=T[he];return re}var ff=(ja=(0,O.b2)(),gs=(0,O.f3)(P.IMapService),Vo=(0,O.f3)(P.IRendererService),Je=(0,O.f3)(P.IGlobalConfigService),yt=(0,O.f3)(P.IInteractionService),Qt=(0,O.f3)(P.ILayerService),ja(Ur=(Tn=function(){function T(){var Ke=this;(0,Y.Z)(this,T),(0,Z.Z)(this,"pickedColors",void 0),(0,Z.Z)(this,"pickedTileLayers",[]),(0,bt.Z)(this,"mapService",mi,this),(0,bt.Z)(this,"rendererService",la,this),(0,bt.Z)(this,"configService",Ho,this),(0,bt.Z)(this,"interactionService",ss,this),(0,bt.Z)(this,"layerService",ko,this),(0,Z.Z)(this,"pickingFBO",void 0),(0,Z.Z)(this,"width",0),(0,Z.Z)(this,"height",0),(0,Z.Z)(this,"alreadyInPicking",!1),(0,Z.Z)(this,"pickBufferScale",1),(0,Z.Z)(this,"pickFromPickingFBO",function(){var he=(0,dr.Z)(He().mark(function re(de,Oe){var dt,Lt,_t,jt,Fr,$r,Un,Hn,_i,Pi,Jn,Ei,ya,ia,zo,co,Eo,_a,Da,Io,Zo,ts,Oo;return He().wrap(function(fo){for(;;)switch(fo.prev=fo.next){case 0:if(dt=Oe.x,Lt=Oe.y,_t=Oe.lngLat,jt=Oe.type,Fr=Oe.target,$r=!1,Un=Ke.rendererService,Hn=Un.readPixelsAsync,_i=Un.getViewportSize,Pi=_i(),Jn=Pi.width,Ei=Pi.height,ya=de.getLayerConfig(),ia=ya.enableHighlight,zo=ya.enableSelect,co=dt*J.SO.DPR,Eo=Lt*J.SO.DPR,!(co>Jn-1*J.SO.DPR||co<0||Eo>Ei-1*J.SO.DPR||Eo<0)){fo.next=9;break}return fo.abrupt("return",!1);case 9:return fo.next=11,Hn({x:Math.floor(co/Ke.pickBufferScale),y:Math.floor((Ei-(Lt+1)*J.SO.DPR)/Ke.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:Ke.pickingFBO});case 11:return _a=fo.sent,Ke.pickedColors=_a,_a[0]!==0||_a[1]!==0||_a[2]!==0?(Da=(0,J.W0)(_a),Io=de.layerPickService.getFeatureById(Da),Da!==de.getCurrentPickId()&&jt==="mousemove"&&(jt="mouseenter"),Zo={x:dt,y:Lt,type:jt,lngLat:_t,featureId:Da,feature:Io,target:Fr},Io&&($r=!0,de.setCurrentPickId(Da),Ke.triggerHoverOnLayer(de,Zo))):(ts={x:dt,y:Lt,lngLat:_t,type:de.getCurrentPickId()!==null&&jt==="mousemove"?"mouseout":"un"+jt,featureId:null,target:Fr,feature:null},Ke.triggerHoverOnLayer(de,(0,F.Z)((0,F.Z)({},ts),{},{type:"unpick"})),Ke.triggerHoverOnLayer(de,ts),de.setCurrentPickId(null)),ia&&de.layerPickService.highlightPickedFeature(_a),zo&&jt==="click"&&(_a==null?void 0:_a.toString())!==[0,0,0,0].toString()&&(Oo=(0,J.W0)(_a),de.getCurrentSelectedId()===null||Oo!==de.getCurrentSelectedId()?(de.layerPickService.selectFeature(_a),de.setCurrentSelectedId(Oo)):(de.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),de.setCurrentSelectedId(null))),fo.abrupt("return",$r);case 17:case"end":return fo.stop()}},re)}));return function(re,de){return he.apply(this,arguments)}}())}return(0,V.Z)(T,[{key:"init",value:function(he){var re=this.rendererService,de=re.createTexture2D,Oe=re.createFramebuffer,dt=re.getViewportSize,Lt=dt(),_t=Lt.width,jt=Lt.height;this.pickBufferScale=this.configService.getSceneConfig(he).pickBufferScale||1,_t=Math.round(_t/this.pickBufferScale),jt=Math.round(jt/this.pickBufferScale);var Fr=de({width:_t,height:jt,usage:ho.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=Oe({color:Fr,depth:!0,width:_t,height:jt}),this.interactionService.on(go.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var Ke=(0,dr.Z)(He().mark(function re(de,Oe,dt){var Lt=this,_t,jt,Fr,$r;return He().wrap(function(Hn){for(;;)switch(Hn.prev=Hn.next){case 0:return _t=this.rendererService,jt=_t.useFramebufferAsync,Fr=_t.clear,this.resizePickingFBO(),de.hooks.beforePickingEncode.call(),Hn.next=5,jt(this.pickingFBO,(0,dr.Z)(He().mark(function _i(){return He().wrap(function(Jn){for(;;)switch(Jn.prev=Jn.next){case 0:Fr({framebuffer:Lt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),de.renderModels({ispick:!0});case 2:case"end":return Jn.stop()}},_i)})));case 5:return de.hooks.afterPickingEncode.call(),Hn.next=8,this.pickBox(de,Oe);case 8:$r=Hn.sent,dt($r);case 10:case"end":return Hn.stop()}},re,this)}));function he(re,de,Oe){return Ke.apply(this,arguments)}return he}()},{key:"pickBox",value:function(){var Ke=(0,dr.Z)(He().mark(function re(de,Oe){var dt=this,Lt,_t,jt,Fr,$r,Un,Hn,_i,Pi,Jn,Ei,ya,ia,zo,co,Eo,_a,Da,Io,Zo,ts;return He().wrap(function(oo){for(;;)switch(oo.prev=oo.next){case 0:if(Lt=Oe.map(function(fo){var Dl=fo<0?0:fo;return Math.floor(Dl*J.SO.DPR/dt.pickBufferScale)}),_t=(0,Dn.Z)(Lt,4),jt=_t[0],Fr=_t[1],$r=_t[2],Un=_t[3],Hn=this.rendererService,_i=Hn.readPixelsAsync,Pi=Hn.getViewportSize,Jn=Pi(),Ei=Jn.width,ya=Jn.height,!(jt>(Ei-1)*J.SO.DPR/this.pickBufferScale||$r<0||Fr>(ya-1)*J.SO.DPR/this.pickBufferScale||Un<0)){oo.next=5;break}return oo.abrupt("return",[]);case 5:return ia=Math.min(Ei/this.pickBufferScale,$r)-jt,zo=Math.min(ya/this.pickBufferScale,Un)-Fr,oo.next=9,_i({x:jt,y:Math.floor(ya/this.pickBufferScale-(Un+1)),width:ia,height:zo,data:new Uint8Array(ia*zo*4),framebuffer:this.pickingFBO});case 9:for(co=oo.sent,Eo=[],_a={},Da=0;Da<co.length/4;Da=Da+1)Io=co.slice(Da*4,Da*4+4),Zo=(0,J.W0)(Io),Zo!==-1&&!_a[Zo]&&(ts=de.layerPickService.getFeatureById(Zo),Eo.push((0,F.Z)((0,F.Z)({},ts),{},{pickedFeatureIdx:Zo})),_a[Zo]=!0);return oo.abrupt("return",Eo);case 14:case"end":return oo.stop()}},re,this)}));function he(re,de){return Ke.apply(this,arguments)}return he}()},{key:"handleCursor",value:function(he,re){var de=he.getLayerConfig(),Oe=de.cursor,dt=Oe===void 0?"":Oe,Lt=de.cursorEnabled;if(Lt){var _t=this.mapService.version,jt=_t==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),Fr=jt==null?void 0:jt.style.getPropertyValue("cursor");re==="unmousemove"&&Fr!==""?jt==null||jt.style.setProperty("cursor",""):re==="mousemove"&&(jt==null||jt.style.setProperty("cursor",dt))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(he){return he.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var Ke=(0,dr.Z)(He().mark(function re(de){return He().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:if(!(!this.layerService.needPick(de.type)||!this.isPickingAllLayer())){dt.next=2;break}return dt.abrupt("return");case 2:return this.alreadyInPicking=!0,dt.next=5,this.pickingLayers(de);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return dt.stop()}},re,this)}));function he(re){return Ke.apply(this,arguments)}return he}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var he=this.rendererService.getViewportSize,re=he(),de=re.width,Oe=re.height;(this.width!==de||this.height!==Oe)&&(this.pickingFBO.resize({width:Math.round(de/this.pickBufferScale),height:Math.round(Oe/this.pickBufferScale)}),this.width=de,this.height=Oe)}},{key:"pickingLayers",value:function(){var Ke=(0,dr.Z)(He().mark(function re(de){var Oe=this,dt,Lt,_t,jt,Fr,$r,Un;return He().wrap(function(_i){for(;;)switch(_i.prev=_i.next){case 0:dt=this.rendererService,Lt=dt.clear,_t=dt.useFramebufferAsync,this.resizePickingFBO(),jt=this.layerService.getRenderList(),Fr=gu(jt.filter(function(Pi){return Pi.needPick(de.type)}).reverse()),_i.prev=4,Un=He().mark(function Pi(){var Jn,Ei;return He().wrap(function(ia){for(;;)switch(ia.prev=ia.next){case 0:return Jn=$r.value,ia.next=3,_t(Oe.pickingFBO,(0,dr.Z)(He().mark(function zo(){return He().wrap(function(Eo){for(;;)switch(Eo.prev=Eo.next){case 0:Lt({framebuffer:Oe.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Jn.layerPickService.pickRender(de);case 2:case"end":return Eo.stop()}},zo)})));case 3:return ia.next=5,Oe.pickFromPickingFBO(Jn,de);case 5:if(Ei=ia.sent,Oe.layerService.pickedLayerId=Ei?+Jn.id:-1,!(Ei&&!Jn.getLayerConfig().enablePropagation)){ia.next=9;break}return ia.abrupt("return",1);case 9:case"end":return ia.stop()}},Pi)}),Fr.s();case 7:if(($r=Fr.n()).done){_i.next=13;break}return _i.delegateYield(Un(),"t0",9);case 9:if(!_i.t0){_i.next=11;break}return _i.abrupt("break",13);case 11:_i.next=7;break;case 13:_i.next=18;break;case 15:_i.prev=15,_i.t1=_i.catch(4),Fr.e(_i.t1);case 18:return _i.prev=18,Fr.f(),_i.finish(18);case 21:case"end":return _i.stop()}},re,this,[[4,15,18,21]])}));function he(re){return Ke.apply(this,arguments)}return he}()},{key:"triggerHoverOnLayer",value:function(he,re){$(re)&&(this.handleCursor(he,re.type),he.emit(re.type,re))}}]),T}(),mi=(0,Gt.Z)(Tn.prototype,"mapService",[gs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),la=(0,Gt.Z)(Tn.prototype,"rendererService",[Vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=(0,Gt.Z)(Tn.prototype,"configService",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ss=(0,Gt.Z)(Tn.prototype,"interactionService",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ko=(0,Gt.Z)(Tn.prototype,"layerService",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tn))||Ur),ys=function(){function T(){var Ke=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,Y.Z)(this,T),(0,Z.Z)(this,"autoStart",void 0),(0,Z.Z)(this,"startTime",0),(0,Z.Z)(this,"oldTime",0),(0,Z.Z)(this,"running",!1),(0,Z.Z)(this,"elapsedTime",0),this.autoStart=Ke}return(0,V.Z)(T,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var he=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var re=(typeof performance=="undefined"?Date:performance).now();he=(re-this.oldTime)/1e3,this.oldTime=re,this.elapsedTime+=he}return he}}]),T}(),bl,xl,ds,Qu,El,Fl,gn,Ai,Hi;function kn(T,Ke){var he=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!he){if(Array.isArray(T)||(he=us(T))||Ke&&T&&typeof T.length=="number"){he&&(T=he);var re=0,de=function(){};return{s:de,n:function(){return re>=T.length?{done:!0}:{done:!1,value:T[re++]}},e:function(jt){throw jt},f:de}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,dt=!1,Lt;return{s:function(){he=he.call(T)},n:function(){var jt=he.next();return Oe=jt.done,jt},e:function(jt){dt=!0,Lt=jt},f:function(){try{!Oe&&he.return!=null&&he.return()}finally{if(dt)throw Lt}}}}function us(T,Ke){if(T){if(typeof T=="string")return Sl(T,Ke);var he=Object.prototype.toString.call(T).slice(8,-1);if(he==="Object"&&T.constructor&&(he=T.constructor.name),he==="Map"||he==="Set")return Array.from(T);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return Sl(T,Ke)}}function Sl(T,Ke){(Ke==null||Ke>T.length)&&(Ke=T.length);for(var he=0,re=new Array(Ke);he<Ke;he++)re[he]=T[he];return re}function Ic(T){var Ke=hf();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function hf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Oc=J.rU.throttle,df=(bl=(0,O.b2)(),xl=(0,O.f3)(P.IRendererService),ds=(0,O.f3)(P.IMapService),Qu=(0,O.f3)(P.IDebugService),bl(El=(Fl=function(T){(0,k.Z)(he,T);var Ke=Ic(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,Z.Z)((0,Q.Z)(re),"pickedLayerId",-1),(0,Z.Z)((0,Q.Z)(re),"clock",new ys),(0,Z.Z)((0,Q.Z)(re),"alreadyInRendering",!1),(0,Z.Z)((0,Q.Z)(re),"layers",[]),(0,Z.Z)((0,Q.Z)(re),"layerList",[]),(0,Z.Z)((0,Q.Z)(re),"layerRenderID",void 0),(0,Z.Z)((0,Q.Z)(re),"sceneInited",!1),(0,Z.Z)((0,Q.Z)(re),"animateInstanceCount",0),(0,Z.Z)((0,Q.Z)(re),"shaderPicking",!0),(0,Z.Z)((0,Q.Z)(re),"enableRender",!0),(0,bt.Z)((0,Q.Z)(re),"renderService",gn,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"mapService",Ai,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"debugService",Hi,(0,Q.Z)(re)),(0,Z.Z)((0,Q.Z)(re),"reRender",Oc(function(){re.renderLayers()},32)),(0,Z.Z)((0,Q.Z)(re),"throttleRenderLayers",Oc(function(){re.renderLayers()},16)),re}return(0,V.Z)(he,[{key:"needPick",value:function(de){return this.updateLayerRenderList(),this.layerList.some(function(Oe){return Oe.needPick(de)})}},{key:"add",value:function(de){var Oe=this;this.layers.push(de),this.sceneInited&&de.init().then(function(){Oe.renderLayers()})}},{key:"addMask",value:function(de){var Oe=this;this.sceneInited&&de.init().then(function(){Oe.renderLayers()})}},{key:"initLayers",value:function(){var re=(0,dr.Z)(He().mark(function Oe(){var dt=this;return He().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var jt=(0,dr.Z)(He().mark(function Fr($r){return He().wrap(function(Hn){for(;;)switch(Hn.prev=Hn.next){case 0:if($r.startInit){Hn.next=4;break}return Hn.next=3,$r.init();case 3:dt.updateLayerRenderList();case 4:case"end":return Hn.stop()}},Fr)}));return function(Fr){return jt.apply(this,arguments)}}());case 2:case"end":return _t.stop()}},Oe,this)}));function de(){return re.apply(this,arguments)}return de}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(de){return this.layers.find(function(Oe){return Oe.id===de})}},{key:"getLayerByName",value:function(de){return this.layers.find(function(Oe){return Oe.name===de})}},{key:"remove",value:function(){var re=(0,dr.Z)(He().mark(function Oe(dt,Lt){var _t,jt;return He().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:Lt?(_t=Lt.layerChildren.indexOf(dt),_t>-1&&Lt.layerChildren.splice(_t,1)):(jt=this.layers.indexOf(dt),jt>-1&&this.layers.splice(jt,1)),dt.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 4:case"end":return $r.stop()}},Oe,this)}));function de(Oe,dt){return re.apply(this,arguments)}return de}()},{key:"removeAllLayers",value:function(){var re=(0,dr.Z)(He().mark(function Oe(){return He().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:this.destroy(),this.reRender();case 2:case"end":return Lt.stop()}},Oe,this)}));function de(){return re.apply(this,arguments)}return de}()},{key:"setEnableRender",value:function(de){this.enableRender=de}},{key:"renderLayers",value:function(){var re=(0,dr.Z)(He().mark(function Oe(){var dt,Lt,_t,jt,Fr,$r,Un,Hn,_i;return He().wrap(function(Jn){for(;;)switch(Jn.prev=Jn.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){Jn.next=2;break}return Jn.abrupt("return");case 2:this.updateLayerRenderList(),dt=this.debugService.generateRenderUid(),this.debugService.renderStart(dt),this.alreadyInRendering=!0,this.clear(),Lt=kn(this.layerList);try{for(Lt.s();!(_t=Lt.n()).done;)jt=_t.value,jt.prerender()}catch(Ei){Lt.e(Ei)}finally{Lt.f()}this.renderService.beginFrame(),Fr=kn(this.layerList),Jn.prev=11,Fr.s();case 13:if(($r=Fr.n()).done){Jn.next=25;break}if(Un=$r.value,Hn=Un.getLayerConfig(),_i=Hn.enableMask,Un.masks.filter(function(Ei){return Ei.inited}).length>0&&_i&&this.renderMask(Un.masks),!Un.getLayerConfig().enableMultiPassRenderer){Jn.next=22;break}return Jn.next=20,Un.renderMultiPass();case 20:Jn.next=23;break;case 22:Un.render();case 23:Jn.next=13;break;case 25:Jn.next=30;break;case 27:Jn.prev=27,Jn.t0=Jn.catch(11),Fr.e(Jn.t0);case 30:return Jn.prev=30,Fr.f(),Jn.finish(30);case 33:this.renderService.endFrame(),this.debugService.renderEnd(dt),this.alreadyInRendering=!1;case 36:case"end":return Jn.stop()}},Oe,this,[[11,27,30,33]])}));function de(){return re.apply(this,arguments)}return de}()},{key:"renderMask",value:function(de){var Oe=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});var dt=de.length>1?be.MULTIPLE:be.SINGLE,Lt=kn(de),_t;try{for(Lt.s();!(_t=Lt.n()).done;){var jt=_t.value;jt.render({isStencil:!0,stencilType:dt,stencilIndex:Oe++})}}catch(Fr){Lt.e(Fr)}finally{Lt.f()}}},{key:"beforeRenderData",value:function(){var re=(0,dr.Z)(He().mark(function Oe(dt){var Lt;return He().wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,dt.hooks.beforeRenderData.promise();case 2:Lt=jt.sent,Lt&&this.renderLayers();case 4:case"end":return jt.stop()}},Oe,this)}));function de(Oe){return re.apply(this,arguments)}return de}()},{key:"renderTileLayerMask",value:function(de){var Oe=0,dt=de.getLayerConfig(),Lt=dt.enableMask,_t=Lt===void 0?!0:Lt,jt=de.tileMask?1:0,Fr=de.masks.filter(function(Pi){return Pi.inited});jt=jt+(_t?Fr.length:1);var $r=jt>1?be.MULTIPLE:be.SINGLE;if((de.tileMask||Fr.length&&_t)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),Fr.length&&_t){var Un=kn(Fr),Hn;try{for(Un.s();!(Hn=Un.n()).done;){var _i=Hn.value;_i.render({isStencil:!0,stencilType:$r,stencilIndex:Oe++})}}catch(Pi){Un.e(Pi)}finally{Un.f()}}de.tileMask&&de.tileMask.render({isStencil:!0,stencilType:$r,stencilIndex:Oe++,stencilOperation:ke.OR})}},{key:"renderTileLayer",value:function(){var re=(0,dr.Z)(He().mark(function Oe(dt){return He().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:if(this.renderTileLayerMask(dt),!dt.getLayerConfig().enableMultiPassRenderer){_t.next=6;break}return _t.next=4,dt.renderMultiPass();case 4:_t.next=8;break;case 6:return _t.next=8,dt.render();case 8:case"end":return _t.stop()}},Oe,this)}));function de(Oe){return re.apply(this,arguments)}return de}()},{key:"updateLayerRenderList",value:function(){var de=this;this.layerList=[],this.layers.filter(function(Oe){return Oe.inited}).filter(function(Oe){return Oe.isVisible()}).sort(function(Oe,dt){return Oe.zIndex-dt.zIndex}).forEach(function(Oe){de.layerList.push(Oe)})}},{key:"destroy",value:function(){this.layers.forEach(function(de){de.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var de=(0,J.CI)(this.mapService.bgColor);this.renderService.clear({color:de,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){window.cancelAnimationFrame(this.layerRenderID)}}]),he}(N.EventEmitter),gn=(0,Gt.Z)(Fl.prototype,"renderService",[xl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=(0,Gt.Z)(Fl.prototype,"mapService",[ds],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi=(0,Gt.Z)(Fl.prototype,"debugService",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fl))||El),pf=_(45987),po=function(T){return T[T.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",T[T.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",T[T.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",T[T.POINTS=0]="POINTS",T[T.LINES=1]="LINES",T[T.LINE_LOOP=2]="LINE_LOOP",T[T.LINE_STRIP=3]="LINE_STRIP",T[T.TRIANGLES=4]="TRIANGLES",T[T.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",T[T.TRIANGLE_FAN=6]="TRIANGLE_FAN",T[T.ZERO=0]="ZERO",T[T.ONE=1]="ONE",T[T.SRC_COLOR=768]="SRC_COLOR",T[T.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",T[T.SRC_ALPHA=770]="SRC_ALPHA",T[T.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",T[T.DST_ALPHA=772]="DST_ALPHA",T[T.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",T[T.DST_COLOR=774]="DST_COLOR",T[T.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",T[T.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",T[T.FUNC_ADD=32774]="FUNC_ADD",T[T.BLEND_EQUATION=32777]="BLEND_EQUATION",T[T.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",T[T.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",T[T.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",T[T.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",T[T.MAX_EXT=32776]="MAX_EXT",T[T.MIN_EXT=32775]="MIN_EXT",T[T.BLEND_DST_RGB=32968]="BLEND_DST_RGB",T[T.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",T[T.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",T[T.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",T[T.CONSTANT_COLOR=32769]="CONSTANT_COLOR",T[T.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",T[T.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",T[T.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",T[T.BLEND_COLOR=32773]="BLEND_COLOR",T[T.ARRAY_BUFFER=34962]="ARRAY_BUFFER",T[T.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",T[T.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",T[T.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",T[T.STREAM_DRAW=35040]="STREAM_DRAW",T[T.STATIC_DRAW=35044]="STATIC_DRAW",T[T.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",T[T.BUFFER_SIZE=34660]="BUFFER_SIZE",T[T.BUFFER_USAGE=34661]="BUFFER_USAGE",T[T.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",T[T.FRONT=1028]="FRONT",T[T.BACK=1029]="BACK",T[T.FRONT_AND_BACK=1032]="FRONT_AND_BACK",T[T.CULL_FACE=2884]="CULL_FACE",T[T.BLEND=3042]="BLEND",T[T.DITHER=3024]="DITHER",T[T.STENCIL_TEST=2960]="STENCIL_TEST",T[T.DEPTH_TEST=2929]="DEPTH_TEST",T[T.SCISSOR_TEST=3089]="SCISSOR_TEST",T[T.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",T[T.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",T[T.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",T[T.NO_ERROR=0]="NO_ERROR",T[T.INVALID_ENUM=1280]="INVALID_ENUM",T[T.INVALID_VALUE=1281]="INVALID_VALUE",T[T.INVALID_OPERATION=1282]="INVALID_OPERATION",T[T.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",T[T.CW=2304]="CW",T[T.CCW=2305]="CCW",T[T.LINE_WIDTH=2849]="LINE_WIDTH",T[T.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",T[T.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",T[T.CULL_FACE_MODE=2885]="CULL_FACE_MODE",T[T.FRONT_FACE=2886]="FRONT_FACE",T[T.DEPTH_RANGE=2928]="DEPTH_RANGE",T[T.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",T[T.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",T[T.DEPTH_FUNC=2932]="DEPTH_FUNC",T[T.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",T[T.STENCIL_FUNC=2962]="STENCIL_FUNC",T[T.STENCIL_FAIL=2964]="STENCIL_FAIL",T[T.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",T[T.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",T[T.STENCIL_REF=2967]="STENCIL_REF",T[T.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",T[T.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",T[T.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",T[T.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",T[T.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",T[T.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",T[T.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",T[T.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",T[T.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",T[T.VIEWPORT=2978]="VIEWPORT",T[T.SCISSOR_BOX=3088]="SCISSOR_BOX",T[T.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",T[T.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",T[T.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",T[T.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",T[T.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",T[T.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",T[T.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",T[T.RED_BITS=3410]="RED_BITS",T[T.GREEN_BITS=3411]="GREEN_BITS",T[T.BLUE_BITS=3412]="BLUE_BITS",T[T.ALPHA_BITS=3413]="ALPHA_BITS",T[T.DEPTH_BITS=3414]="DEPTH_BITS",T[T.STENCIL_BITS=3415]="STENCIL_BITS",T[T.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",T[T.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",T[T.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",T[T.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",T[T.SAMPLES=32937]="SAMPLES",T[T.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",T[T.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",T[T.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",T[T.DONT_CARE=4352]="DONT_CARE",T[T.FASTEST=4353]="FASTEST",T[T.NICEST=4354]="NICEST",T[T.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",T[T.BYTE=5120]="BYTE",T[T.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",T[T.SHORT=5122]="SHORT",T[T.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",T[T.INT=5124]="INT",T[T.UNSIGNED_INT=5125]="UNSIGNED_INT",T[T.FLOAT=5126]="FLOAT",T[T.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",T[T.ALPHA=6406]="ALPHA",T[T.RGB=6407]="RGB",T[T.RGBA=6408]="RGBA",T[T.LUMINANCE=6409]="LUMINANCE",T[T.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",T[T.RED=6403]="RED",T[T.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",T[T.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",T[T.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",T[T.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",T[T.VERTEX_SHADER=35633]="VERTEX_SHADER",T[T.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",T[T.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",T[T.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",T[T.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",T[T.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",T[T.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",T[T.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",T[T.SHADER_TYPE=35663]="SHADER_TYPE",T[T.DELETE_STATUS=35712]="DELETE_STATUS",T[T.LINK_STATUS=35714]="LINK_STATUS",T[T.VALIDATE_STATUS=35715]="VALIDATE_STATUS",T[T.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",T[T.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",T[T.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",T[T.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",T[T.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",T[T.NEVER=512]="NEVER",T[T.LESS=513]="LESS",T[T.EQUAL=514]="EQUAL",T[T.LEQUAL=515]="LEQUAL",T[T.GREATER=516]="GREATER",T[T.NOTEQUAL=517]="NOTEQUAL",T[T.GEQUAL=518]="GEQUAL",T[T.ALWAYS=519]="ALWAYS",T[T.KEEP=7680]="KEEP",T[T.REPLACE=7681]="REPLACE",T[T.INCR=7682]="INCR",T[T.DECR=7683]="DECR",T[T.INVERT=5386]="INVERT",T[T.INCR_WRAP=34055]="INCR_WRAP",T[T.DECR_WRAP=34056]="DECR_WRAP",T[T.VENDOR=7936]="VENDOR",T[T.RENDERER=7937]="RENDERER",T[T.VERSION=7938]="VERSION",T[T.NEAREST=9728]="NEAREST",T[T.LINEAR=9729]="LINEAR",T[T.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",T[T.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",T[T.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",T[T.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",T[T.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",T[T.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",T[T.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",T[T.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",T[T.TEXTURE_2D=3553]="TEXTURE_2D",T[T.TEXTURE=5890]="TEXTURE",T[T.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",T[T.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",T[T.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",T[T.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",T[T.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",T[T.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",T[T.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",T[T.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",T[T.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",T[T.TEXTURE0=33984]="TEXTURE0",T[T.TEXTURE1=33985]="TEXTURE1",T[T.TEXTURE2=33986]="TEXTURE2",T[T.TEXTURE3=33987]="TEXTURE3",T[T.TEXTURE4=33988]="TEXTURE4",T[T.TEXTURE5=33989]="TEXTURE5",T[T.TEXTURE6=33990]="TEXTURE6",T[T.TEXTURE7=33991]="TEXTURE7",T[T.TEXTURE8=33992]="TEXTURE8",T[T.TEXTURE9=33993]="TEXTURE9",T[T.TEXTURE10=33994]="TEXTURE10",T[T.TEXTURE11=33995]="TEXTURE11",T[T.TEXTURE12=33996]="TEXTURE12",T[T.TEXTURE13=33997]="TEXTURE13",T[T.TEXTURE14=33998]="TEXTURE14",T[T.TEXTURE15=33999]="TEXTURE15",T[T.TEXTURE16=34e3]="TEXTURE16",T[T.TEXTURE17=34001]="TEXTURE17",T[T.TEXTURE18=34002]="TEXTURE18",T[T.TEXTURE19=34003]="TEXTURE19",T[T.TEXTURE20=34004]="TEXTURE20",T[T.TEXTURE21=34005]="TEXTURE21",T[T.TEXTURE22=34006]="TEXTURE22",T[T.TEXTURE23=34007]="TEXTURE23",T[T.TEXTURE24=34008]="TEXTURE24",T[T.TEXTURE25=34009]="TEXTURE25",T[T.TEXTURE26=34010]="TEXTURE26",T[T.TEXTURE27=34011]="TEXTURE27",T[T.TEXTURE28=34012]="TEXTURE28",T[T.TEXTURE29=34013]="TEXTURE29",T[T.TEXTURE30=34014]="TEXTURE30",T[T.TEXTURE31=34015]="TEXTURE31",T[T.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",T[T.REPEAT=10497]="REPEAT",T[T.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",T[T.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",T[T.FLOAT_VEC2=35664]="FLOAT_VEC2",T[T.FLOAT_VEC3=35665]="FLOAT_VEC3",T[T.FLOAT_VEC4=35666]="FLOAT_VEC4",T[T.INT_VEC2=35667]="INT_VEC2",T[T.INT_VEC3=35668]="INT_VEC3",T[T.INT_VEC4=35669]="INT_VEC4",T[T.BOOL=35670]="BOOL",T[T.BOOL_VEC2=35671]="BOOL_VEC2",T[T.BOOL_VEC3=35672]="BOOL_VEC3",T[T.BOOL_VEC4=35673]="BOOL_VEC4",T[T.FLOAT_MAT2=35674]="FLOAT_MAT2",T[T.FLOAT_MAT3=35675]="FLOAT_MAT3",T[T.FLOAT_MAT4=35676]="FLOAT_MAT4",T[T.SAMPLER_2D=35678]="SAMPLER_2D",T[T.SAMPLER_CUBE=35680]="SAMPLER_CUBE",T[T.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",T[T.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",T[T.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",T[T.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",T[T.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",T[T.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",T[T.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",T[T.COMPILE_STATUS=35713]="COMPILE_STATUS",T[T.LOW_FLOAT=36336]="LOW_FLOAT",T[T.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",T[T.HIGH_FLOAT=36338]="HIGH_FLOAT",T[T.LOW_INT=36339]="LOW_INT",T[T.MEDIUM_INT=36340]="MEDIUM_INT",T[T.HIGH_INT=36341]="HIGH_INT",T[T.FRAMEBUFFER=36160]="FRAMEBUFFER",T[T.RENDERBUFFER=36161]="RENDERBUFFER",T[T.RGBA4=32854]="RGBA4",T[T.RGB5_A1=32855]="RGB5_A1",T[T.RGB565=36194]="RGB565",T[T.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",T[T.STENCIL_INDEX=6401]="STENCIL_INDEX",T[T.STENCIL_INDEX8=36168]="STENCIL_INDEX8",T[T.DEPTH_STENCIL=34041]="DEPTH_STENCIL",T[T.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",T[T.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",T[T.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",T[T.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",T[T.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",T[T.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",T[T.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",T[T.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",T[T.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",T[T.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",T[T.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",T[T.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",T[T.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",T[T.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",T[T.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",T[T.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",T[T.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",T[T.NONE=0]="NONE",T[T.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",T[T.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",T[T.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",T[T.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",T[T.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",T[T.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",T[T.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",T[T.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",T[T.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",T[T.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",T[T.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",T[T.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",T[T.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",T[T.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",T}({}),Pf=J.rU.isNil,vc=function(){function T(Ke){var he=this;(0,Y.Z)(this,T),(0,Z.Z)(this,"name",void 0),(0,Z.Z)(this,"type",void 0),(0,Z.Z)(this,"scale",void 0),(0,Z.Z)(this,"descriptor",void 0),(0,Z.Z)(this,"featureBufferLayout",[]),(0,Z.Z)(this,"needRescale",!1),(0,Z.Z)(this,"needRemapping",!1),(0,Z.Z)(this,"needRegenerateVertices",!1),(0,Z.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,Z.Z)(this,"vertexAttribute",void 0),(0,Z.Z)(this,"defaultCallback",function(re){if(re.length===0){var de;return((de=he.scale)===null||de===void 0?void 0:de.defaultValues)||[]}return re.map(function(Oe,dt){var Lt,_t=(Lt=he.scale)===null||Lt===void 0?void 0:Lt.scalers[dt].func,jt=_t(Oe);return jt})}),this.setProps(Ke)}return(0,V.Z)(T,[{key:"setProps",value:function(he){Object.assign(this,he)}},{key:"mapping",value:function(he){var re;if((re=this.scale)!==null&&re!==void 0&&re.callback){var de,Oe=(de=this.scale)===null||de===void 0?void 0:de.callback.apply(de,(0,Zr.Z)(he));if(!Pf(Oe))return[Oe]}return this.defaultCallback(he)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),T}(),Ju=["buffer","update","name"],eh=["buffer","update","name"],Qo,Nl,Ul,iu,yu,_u,el=(Qo={},(0,Z.Z)(Qo,po.FLOAT,4),(0,Z.Z)(Qo,po.UNSIGNED_BYTE,1),(0,Z.Z)(Qo,po.UNSIGNED_SHORT,2),Qo),au=(Nl=(0,O.b2)(),Ul=(0,O.f3)(P.IRendererService),Nl(iu=(yu=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"attributesAndIndices",void 0),(0,bt.Z)(this,"rendererService",_u,this),(0,Z.Z)(this,"attributes",[]),(0,Z.Z)(this,"triangulation",void 0),(0,Z.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,V.Z)(T,[{key:"registerStyleAttribute",value:function(he){var re=this.getLayerStyleAttribute(he.name||"");return re?re.setProps(he):(re=new vc(he),this.attributes.push(re)),re}},{key:"unRegisterStyleAttribute",value:function(he){var re=this.attributes.findIndex(function(de){return de.name===he});re>-1&&this.attributes.splice(re,1)}},{key:"updateScaleAttribute",value:function(he){this.attributes.forEach(function(re){var de,Oe=re.name,dt=(de=re.scale)===null||de===void 0?void 0:de.field;(he[Oe]||dt&&he[dt])&&(re.needRescale=!0,re.needRemapping=!0,re.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(he,re,de){var Oe=this.getLayerStyleAttribute(he);Oe||(Oe=this.registerStyleAttribute((0,F.Z)((0,F.Z)({},re),{},{name:he})));var dt=re.scale;dt&&Oe&&(Oe.scale=dt,Oe.needRescale=!0,Oe.needRemapping=!0,Oe.needRegenerateVertices=!0,de&&de.featureRange&&(Oe.featureRange=de.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(he){return this.attributes.find(function(re){return re.name===he})}},{key:"getLayerAttributeScale",value:function(he){var re,de=this.getLayerStyleAttribute(he),Oe=de==null||(re=de.scale)===null||re===void 0?void 0:re.scalers;return Oe&&Oe[0]?Oe[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(he,re){var de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,Oe=arguments.length>3?arguments[3]:void 0,dt=arguments.length>4?arguments[4]:void 0,Lt=this.attributes.find(function(co){return co.name===he});if(Lt&&Lt.descriptor){var _t=Lt.descriptor,jt=_t.update,Fr=_t.buffer,$r=_t.size,Un=$r===void 0?0:$r,Hn=el[Fr.type||po.FLOAT];if(jt){var _i=this.featureLayout,Pi=_i.elements,Jn=_i.sizePerElement,Ei=Pi.slice(de,Oe);if(!Ei.length)return;var ya=Ei[0].offset,ia=ya*Un*Hn,zo=Ei.map(function(co,Eo){for(var _a=co.featureIdx,Da=co.vertices,Io=co.normals,Zo=Da.length/Jn,ts=[],Oo=0;Oo<Zo;Oo++){var oo=Io?Io.slice(Oo*3,Oo*3+3):[];ts.push.apply(ts,(0,Zr.Z)(jt(re[_a],_a,Da.slice(Oo*Jn,Oo*Jn+Jn),Eo,oo)))}return ts}).flat();Lt.vertexAttribute.updateBuffer({data:zo,offset:ia}),dt==null||dt.emit("legend:".concat(he),{type:he,attr:Lt})}}}},{key:"createAttributesAndIndices",value:function(he,re,de){var Oe=this;this.featureLayout={sizePerElement:0,elements:[]},re&&(this.triangulation=re);var dt=this.attributes.map(function(Ei){return Ei.resetDescriptor(),Ei.descriptor}),Lt=0,_t=0,jt=[],Fr=3;he.forEach(function(Ei,ya){var ia=Oe.triangulation(Ei,de),zo=ia.indices,co=ia.vertices,Eo=ia.normals,_a=ia.size,Da=ia.indexes,Io=ia.count;typeof Io=="number"&&(_t+=Io),zo.forEach(function(oo){jt.push(oo+Lt)}),Fr=_a;var Zo=co.length/_a;Oe.featureLayout.sizePerElement=Fr,Oe.featureLayout.elements.push({featureIdx:ya,vertices:co,normals:Eo,offset:Lt}),Lt+=Zo;for(var ts=function(fo){var Dl=(Eo==null?void 0:Eo.slice(fo*3,fo*3+3))||[],Kl=co.slice(fo*_a,fo*_a+_a),Af=0;Da&&Da[fo]!==void 0&&(Af=Da[fo]),dt.forEach(function(Ac,ef){if(Ac&&Ac.update){var td;(td=Ac.buffer.data).push.apply(td,(0,Zr.Z)(Ac.update(Ei,ya,Kl,fo,Dl,Af)))}})},Oo=0;Oo<Zo;Oo++)ts(Oo)});var $r=this.rendererService,Un=$r.createAttribute,Hn=$r.createBuffer,_i=$r.createElements,Pi={};dt.forEach(function(Ei,ya){if(Ei){var ia=Ei.buffer,zo=Ei.update,co=Ei.name,Eo=(0,pf.Z)(Ei,Ju),_a=Un((0,F.Z)({buffer:Hn(ia)},Eo));Pi[Ei.name||""]=_a,Oe.attributes[ya].vertexAttribute=_a}});var Jn=_i({data:jt,type:po.UNSIGNED_INT,count:jt.length});return this.attributesAndIndices={attributes:Pi,elements:Jn,count:_t},this.attributesAndIndices}},{key:"createAttributes",value:function(he,re){var de=this;this.featureLayout={sizePerElement:0,elements:[]},re&&(this.triangulation=re);var Oe=this.attributes.map(function(Hn){return Hn.resetDescriptor(),Hn.descriptor}),dt=0,Lt=[],_t=3;he.forEach(function(Hn,_i){var Pi=de.triangulation(Hn),Jn=Pi.indices,Ei=Pi.vertices,ya=Pi.normals,ia=Pi.size,zo=Pi.indexes;Jn.forEach(function(Da){Lt.push(Da+dt)}),_t=ia;var co=Ei.length/ia;de.featureLayout.sizePerElement=_t,de.featureLayout.elements.push({featureIdx:_i,vertices:Ei,normals:ya,offset:dt}),dt+=co;for(var Eo=function(Io){var Zo=(ya==null?void 0:ya.slice(Io*3,Io*3+3))||[],ts=Ei.slice(Io*ia,Io*ia+ia),Oo=0;zo&&zo[Io]!==void 0&&(Oo=zo[Io]),Oe.forEach(function(oo,fo){if(oo&&oo.update){var Dl;(Dl=oo.buffer.data).push.apply(Dl,(0,Zr.Z)(oo.update(Hn,_i,ts,Io,Zo,Oo)))}})},_a=0;_a<co;_a++)Eo(_a)});var jt=this.rendererService,Fr=jt.createAttribute,$r=jt.createBuffer,Un={};return Oe.forEach(function(Hn,_i){if(Hn){var Pi=Hn.buffer,Jn=Hn.update,Ei=Hn.name,ya=(0,pf.Z)(Hn,eh),ia=Fr((0,F.Z)({buffer:$r(Pi)},ya));Un[Hn.name||""]=ia,de.attributes[_i].vertexAttribute=ia}}),{attributes:Un}}},{key:"clearAllAttributes",value:function(){var he;this.attributes.forEach(function(re){re.vertexAttribute&&re.vertexAttribute.destroy()}),(he=this.attributesAndIndices)===null||he===void 0||he.elements.destroy(),this.attributes=[]}}]),T}(),_u=(0,Gt.Z)(yu.prototype,"rendererService",[Ul],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu))||iu),zl=_(46343),Tl=_(63844),vf=_.n(Tl),Vc,Va,th,Pc,Hc,bo,mf,gf,Jo,Zu,Mu,ju,mc,Zl,bu,gc,Al,ou,La,qa,so,Vu,Df,Cl,Dc,yc,Gs,Hu,Iu,tl,Ql,Jl,jl,kc,rl;function Xs(T){var Ke=kf();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function kf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var yf=(Vc=(0,O.b2)(),Va=(0,O.f3)(P.SceneID),th=(0,O.f3)(P.IIconService),Pc=(0,O.f3)(P.IFontService),Hc=(0,O.f3)(P.IControlService),bo=(0,O.f3)(P.IGlobalConfigService),mf=(0,O.f3)(P.IMapService),gf=(0,O.f3)(P.ICoordinateSystemService),Jo=(0,O.f3)(P.IRendererService),Zu=(0,O.f3)(P.ILayerService),Mu=(0,O.f3)(P.IDebugService),ju=(0,O.f3)(P.ICameraService),mc=(0,O.f3)(P.IInteractionService),Zl=(0,O.f3)(P.IPickingService),bu=(0,O.f3)(P.IShaderModuleService),gc=(0,O.f3)(P.IMarkerService),Al=(0,O.f3)(P.IPopupService),Vc(ou=(La=function(T){(0,k.Z)(he,T);var Ke=Xs(he);function he(){var re;return(0,Y.Z)(this,he),re=Ke.call(this),(0,Z.Z)((0,Q.Z)(re),"destroyed",!1),(0,Z.Z)((0,Q.Z)(re),"loaded",!1),(0,bt.Z)((0,Q.Z)(re),"id",qa,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"iconService",so,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"fontService",Vu,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"controlService",Df,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"configService",Cl,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"map",Dc,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"coordinateSystemService",yc,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"rendererService",Gs,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"layerService",Hu,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"debugService",Iu,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"cameraService",tl,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"interactionService",Ql,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"pickingService",Jl,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"shaderModuleService",jl,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"markerService",kc,(0,Q.Z)(re)),(0,bt.Z)((0,Q.Z)(re),"popupService",rl,(0,Q.Z)(re)),(0,Z.Z)((0,Q.Z)(re),"inited",!1),(0,Z.Z)((0,Q.Z)(re),"rendering",!1),(0,Z.Z)((0,Q.Z)(re),"$container",void 0),(0,Z.Z)((0,Q.Z)(re),"canvas",void 0),(0,Z.Z)((0,Q.Z)(re),"markerContainer",void 0),(0,Z.Z)((0,Q.Z)(re),"resizeDetector",void 0),(0,Z.Z)((0,Q.Z)(re),"hooks",void 0),(0,Z.Z)((0,Q.Z)(re),"handleWindowResized",function(){re.emit("resize"),re.$container&&(re.initContainer(),re.coordinateSystemService.needRefresh=!0,re.render())}),(0,Z.Z)((0,Q.Z)(re),"handleMapCameraChanged",function(de){re.cameraService.update(de),re.render()}),re.hooks={init:new zl.sX},re}return(0,V.Z)(he,[{key:"init",value:function(de){var Oe=this;this.configService.setSceneConfig(this.id,de),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return Oe.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,dr.Z)(He().mark(function dt(){return He().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:return Oe.debugService.log("map.mapInitStart",{type:Oe.map.version}),_t.next=3,new Promise(function(jt){Oe.map.onCameraChanged(function(Fr){Oe.cameraService.init(),Oe.cameraService.update(Fr),jt()}),Oe.map.init()});case 3:Oe.map.onCameraChanged(Oe.handleMapCameraChanged),Oe.map.addMarkerContainer(),Oe.markerService.addMarkers(),Oe.markerService.addMarkerLayers(),Oe.popupService.initPopup(),Oe.interactionService.init(),Oe.interactionService.on(go.Drag,Oe.addSceneEvent.bind(Oe));case 10:case"end":return _t.stop()}},dt)}))),this.hooks.init.tapPromise("initRenderer",(0,dr.Z)(He().mark(function dt(){var Lt,_t,jt;return He().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(_t=((Lt=Oe.map)===null||Lt===void 0?void 0:Lt.getOverlayContainer())||void 0,_t?Oe.$container=_t:Oe.$container=Do(Oe.configService.getSceneConfig(Oe.id).id||""),!Oe.$container){$r.next=14;break}return Oe.canvas=J.SO.create("canvas","",Oe.$container),Oe.setCanvas(),$r.next=7,Oe.rendererService.init(Oe.canvas,Oe.configService.getSceneConfig(Oe.id),de.gl);case 7:Oe.registerContextLost(),Oe.initContainer(),Oe.resizeDetector=vf()({strategy:"scroll"}),Oe.resizeDetector.listenTo(Oe.$container,Oe.handleWindowResized),window.matchMedia&&((jt=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||jt===void 0||jt.addListener(Oe.handleWindowResized.bind("screen"))),$r.next=15;break;case 14:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 15:Oe.pickingService.init(Oe.id);case 16:case"end":return $r.stop()}},dt)}))),this.render()}},{key:"registerContextLost",value:function(){var de=this,Oe=this.rendererService.getCanvas();Oe&&Oe.addEventListener("webglcontextlost",function(){return de.emit("webglcontextlost")})}},{key:"addLayer",value:function(de){this.layerService.sceneService=this,this.layerService.add(de)}},{key:"addMask",value:function(de){this.layerService.sceneService=this,this.layerService.addMask(de)}},{key:"render",value:function(){var re=(0,dr.Z)(He().mark(function Oe(){return He().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(!(this.rendering||this.destroyed)){Lt.next=2;break}return Lt.abrupt("return");case 2:if(this.rendering=!0,this.inited){Lt.next=16;break}return Lt.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),Lt.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,Lt.next=20;break;case 16:return Lt.next=18,this.layerService.initLayers();case 18:return Lt.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return Lt.stop()}},Oe,this)}));function de(){return re.apply(this,arguments)}return de}()},{key:"addFontFace",value:function(de,Oe){this.fontService.addFontFace(de,Oe)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var re=(0,dr.Z)(He().mark(function Oe(dt){var Lt,_t,jt;return He().wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return _t=(Lt=this.$container)===null||Lt===void 0?void 0:Lt.getElementsByTagName("canvas")[0],$r.next=3,this.render();case 3:return jt=dt==="jpg"?_t==null?void 0:_t.toDataURL("image/jpeg"):_t==null?void 0:_t.toDataURL("image/png"),$r.abrupt("return",jt);case 5:case"end":return $r.stop()}},Oe,this)}));function de(Oe){return re.apply(this,arguments)}return de}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var de=this.$container.parentElement;de!==null&&(this.markerContainer=J.SO.create("div","l7-marker-container",de))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var de=this,Oe;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var dt;(dt=de.$container)===null||dt===void 0||dt.removeChild(de.canvas),de.canvas=null,de.rendererService.destroy()}),(Oe=this.$container)===null||Oe===void 0||(Oe=Oe.parentNode)===null||Oe===void 0||Oe.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var de,Oe,dt=J.SO.DPR,Lt=((de=this.$container)===null||de===void 0?void 0:de.clientWidth)||400,_t=((Oe=this.$container)===null||Oe===void 0?void 0:Oe.clientHeight)||300,jt=this.canvas;jt&&(jt.width=Lt*dt,jt.height=_t*dt),this.rendererService.viewport({x:0,y:0,width:dt*Lt,height:dt*_t})}},{key:"setCanvas",value:function(){var de,Oe,dt=J.SO.DPR,Lt=((de=this.$container)===null||de===void 0?void 0:de.clientWidth)||400,_t=((Oe=this.$container)===null||Oe===void 0?void 0:Oe.clientHeight)||300,jt=this.canvas;jt.width=Lt*dt,jt.height=_t*dt,jt.style.width="100%",jt.style.height="100%"}},{key:"addSceneEvent",value:function(de){this.emit(de.type,de)}}]),he}(N.EventEmitter),qa=(0,Gt.Z)(La.prototype,"id",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so=(0,Gt.Z)(La.prototype,"iconService",[th],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vu=(0,Gt.Z)(La.prototype,"fontService",[Pc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Df=(0,Gt.Z)(La.prototype,"controlService",[Hc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cl=(0,Gt.Z)(La.prototype,"configService",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dc=(0,Gt.Z)(La.prototype,"map",[mf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yc=(0,Gt.Z)(La.prototype,"coordinateSystemService",[gf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gs=(0,Gt.Z)(La.prototype,"rendererService",[Jo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hu=(0,Gt.Z)(La.prototype,"layerService",[Zu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iu=(0,Gt.Z)(La.prototype,"debugService",[Mu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tl=(0,Gt.Z)(La.prototype,"cameraService",[ju],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ql=(0,Gt.Z)(La.prototype,"interactionService",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jl=(0,Gt.Z)(La.prototype,"pickingService",[Zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=(0,Gt.Z)(La.prototype,"shaderModuleService",[bu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kc=(0,Gt.Z)(La.prototype,"markerService",[gc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rl=(0,Gt.Z)(La.prototype,"popupService",[Al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),La))||ou);function Lf(T){var Ke=0;switch(T){case"vec2":case"ivec2":Ke=2;break;case"vec3":case"ivec3":Ke=3;break;case"vec4":case"ivec4":case"mat2":Ke=4;break;case"mat3":Ke=9;break;case"mat4":Ke=16;break;default:}return Ke}var Vl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function $u(T){var Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,he={};return T=T.replace(Vl,function(re,de,Oe){var dt=Oe.split(":"),Lt=dt[0].trim(),_t="";switch(dt.length>1&&(_t=dt[1].trim()),de){case"bool":_t=_t==="true";break;case"float":case"int":_t=Number(_t);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":_t?_t=_t.replace("[","").replace("]","").split(",").reduce(function(jt,Fr){return jt.push(Number(Fr.trim())),jt},[]):_t=new Array(Lf(de)).fill(0);break;default:}return he[Lt]=_t,"".concat(Ke?"uniform ":"").concat(de," ").concat(Lt,`;
`)}),{content:T,uniforms:he}}function Hl(T){var Ke=$u(T,!0),he=Ke.content,re=Ke.uniforms;return he=he.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,function(de,Oe,dt){dt=dt.trim().replace(/^.*$/gm,function(Fr){return"uniform ".concat(Fr)});var Lt=$u(dt),_t=Lt.content,jt=Lt.uniforms;return Object.assign(re,jt),"".concat(Oe,`{
`).concat(_t,`
};`)}),{content:he,uniforms:re}}function _c(T){var Ke={};return T.replace(Vl,function(he,re,de){var Oe=de.trim();return Ke[Oe]?"":(Ke[Oe]=!0,"uniform ".concat(re," ").concat(Oe,`;
`))})}var nl,Bf,$c=J.rU.uniq,_f="#define PI 3.14159265359",Wc=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,bf=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};

layout(std140) uniform LayerUniforms {
  mat4 u_Mvp;
  vec2 u_sceneCenterMercator;
};
`,bc=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_EnableSelect;
  float u_activeMix;
};`,Gc=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,xu=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,Wu=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,_s=`layout(location = 3) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,xf=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,$l=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)
#define EARTH_CIRCUMFERENCE 40.03e6

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
#pragma include "scene_uniforms"


// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
   if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return lnglat;
  }
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  // if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
 

  //    return vec4(
  //     position.xy,
  //     project_scale(position.z),
  //     position.w);
  // }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}



float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }

  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
   return meter;
  } else  {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

// \u652F\u6301 GaodeV2\u3001Mapbox
vec4 project_common_position_to_clipspace_v2(vec4 position) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    return u_Mvp * position;
  } else {
    return project_common_position_to_clipspace(position);
  }
}
`,uo=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,Ef=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Ys=/precision\s+(high|low|medium)p\s+float/,wl=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Ia=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,lo=/void\s+main\s*\([^)]*\)\s*\{\n?/,Ou=/}\n?[^{}]*$/,Xc=(nl=(0,O.b2)(),nl(Bf=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"moduleCache",{}),(0,Z.Z)(this,"rawContentCache",{})}return(0,V.Z)(T,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:_f,fs:_f}),this.registerModule("decode",{vs:Wc,fs:""}),this.registerModule("scene_uniforms",{vs:bf,fs:bf}),this.registerModule("picking_uniforms",{vs:bc,fs:bc}),this.registerModule("projection",{vs:$l,fs:$l}),this.registerModule("project",{vs:xf,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Ef}),this.registerModule("lighting",{vs:xu,fs:""}),this.registerModule("light",{vs:Gc,fs:""}),this.registerModule("picking",{vs:_s,fs:Wu}),this.registerModule("rotation_2d",{vs:uo,fs:""})}},{key:"registerModule",value:function(he,re){re.vs=re.vs.replace(/\r\n/g,`
`),re.fs=re.fs.replace(/\r\n/g,`
`);var de=re.vs,Oe=re.fs,dt=re.uniforms,Lt=re.inject,_t=Hl(de),jt=_t.content,Fr=_t.uniforms,$r=Hl(Oe),Un=$r.content,Hn=$r.uniforms;this.rawContentCache[he]={fs:Un,inject:Lt,uniforms:(0,F.Z)((0,F.Z)((0,F.Z)({},Fr),Hn),dt),vs:jt}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(he){var re=this,de=this.rawContentCache[he].vs,Oe=this.rawContentCache[he].fs,dt=this.rawContentCache[he].inject,Lt={};dt!=null&&dt["vs:#decl"]&&(de=(dt==null?void 0:dt["vs:#decl"])+de,Lt=Hl(dt==null?void 0:dt["vs:#decl"]).uniforms),dt!=null&&dt["vs:#main-start"]&&(de=de.replace(lo,function(Ei){return Ei+(dt==null?void 0:dt["vs:#main-start"])})),dt!=null&&dt["fs:#decl"]&&(Oe=(dt==null?void 0:dt["fs:#decl"])+Oe);var _t=this.processModule(de,[],"vs"),jt=_t.content,Fr=_t.includeList,$r=this.processModule(Oe,[],"fs"),Un=$r.content,Hn=$r.includeList,_i="",Pi=$c(Fr.concat(Hn).concat(he)).reduce(function(Ei,ya){return(0,F.Z)((0,F.Z)({},Ei),re.rawContentCache[ya].uniforms)},(0,F.Z)({},Lt));Ys.test(Un)||(_i=_i+wl),_i=_i+Un;var Jn="";return Ys.test(jt)||(Jn=Jn+wl),Jn=Jn+jt,this.moduleCache[he]={fs:_i.trim(),uniforms:Pi,vs:Jn.trim()},this.moduleCache[he]}},{key:"processModule",value:function(he,re,de){var Oe=this,dt=he.replace(Ia,function(Lt,_t){var jt=_t.split(" "),Fr=jt[0].replace(/"/g,"");if(re.indexOf(Fr)>-1)return"";var $r=Oe.rawContentCache[Fr][de];re.push(Fr);var Un=Oe.processModule($r,re,de),Hn=Un.content;return Hn});return{content:dt,includeList:re}}},{key:"injectDefines",value:function(he){var re=Object.keys(he).reduce(function(de,Oe){return de+"#define ".concat(Oe.toUpperCase()," ").concat(he[Oe],`;
`)},`
`);return re}}]),T}())||Bf),Pu=_(73237),Bs=function(T){return T.Normal="normal",T.PostProcessing="post-processing",T}({}),Ff,Yc,ec=(Ff=(0,O.b2)(),Ff(Yc=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"shaderModuleService",void 0),(0,Z.Z)(this,"rendererService",void 0),(0,Z.Z)(this,"cameraService",void 0),(0,Z.Z)(this,"mapService",void 0),(0,Z.Z)(this,"interactionService",void 0),(0,Z.Z)(this,"layerService",void 0),(0,Z.Z)(this,"config",void 0)}return(0,V.Z)(T,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Bs.Normal}},{key:"init",value:function(he,re){this.config=re,this.rendererService=he.getContainer().get(P.IRendererService),this.cameraService=he.getContainer().get(P.ICameraService),this.mapService=he.getContainer().get(P.IMapService),this.interactionService=he.getContainer().get(P.IInteractionService),this.layerService=he.getContainer().get(P.ILayerService),this.shaderModuleService=he.getContainer().get(P.IShaderModuleService)}},{key:"render",value:function(he){}}]),T}())||Yc),tc,ps;function Co(T){var Ke=xc();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function xc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Nf=(tc=(0,O.b2)(),tc(ps=function(T){(0,k.Z)(he,T);var Ke=Co(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(de,Oe){(0,Pu.Z)((0,U.Z)(he.prototype),"init",this).call(this,de,Oe)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),he}(ec))||ps),wo,oi,Ks,rc,nc;function Cs(T,Ke){var he=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!he){if(Array.isArray(T)||(he=wa(T))||Ke&&T&&typeof T.length=="number"){he&&(T=he);var re=0,de=function(){};return{s:de,n:function(){return re>=T.length?{done:!0}:{done:!1,value:T[re++]}},e:function(jt){throw jt},f:de}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,dt=!1,Lt;return{s:function(){he=he.call(T)},n:function(){var jt=he.next();return Oe=jt.done,jt},e:function(jt){dt=!0,Lt=jt},f:function(){try{!Oe&&he.return!=null&&he.return()}finally{if(dt)throw Lt}}}}function wa(T,Ke){if(T){if(typeof T=="string")return qs(T,Ke);var he=Object.prototype.toString.call(T).slice(8,-1);if(he==="Object"&&T.constructor&&(he=T.constructor.name),he==="Map"||he==="Set")return Array.from(T);if(he==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return qs(T,Ke)}}function qs(T,Ke){(Ke==null||Ke>T.length)&&(Ke=T.length);for(var he=0,re=new Array(Ke);he<Ke;he++)re[he]=T[he];return re}var zn=(wo=(0,O.b2)(),oi=(0,O.f3)(P.IPostProcessor),wo(Ks=(rc=function(){function T(){(0,Y.Z)(this,T),(0,Z.Z)(this,"passes",[]),(0,bt.Z)(this,"postProcessor",nc,this),(0,Z.Z)(this,"layer",void 0),(0,Z.Z)(this,"renderFlag",void 0),(0,Z.Z)(this,"width",0),(0,Z.Z)(this,"height",0)}return(0,V.Z)(T,[{key:"setLayer",value:function(he){this.layer=he}},{key:"setRenderFlag",value:function(he){this.renderFlag=he}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var Ke=(0,dr.Z)(He().mark(function re(){var de,Oe,dt;return He().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:de=Cs(this.passes),_t.prev=1,de.s();case 3:if((Oe=de.n()).done){_t.next=9;break}return dt=Oe.value,_t.next=7,dt.render(this.layer);case 7:_t.next=3;break;case 9:_t.next=14;break;case 11:_t.prev=11,_t.t0=_t.catch(1),de.e(_t.t0);case 14:return _t.prev=14,de.f(),_t.finish(14);case 17:return _t.next=19,this.postProcessor.render(this.layer);case 19:case"end":return _t.stop()}},re,this,[[1,11,14,17]])}));function he(){return Ke.apply(this,arguments)}return he}()},{key:"resize",value:function(he,re){(this.width!==he||this.height!==re)&&(this.postProcessor.resize(he,re),this.width=he,this.height=re)}},{key:"add",value:function(he,re){he.getType()===Bs.PostProcessing?this.postProcessor.add(he,this.layer,re):(he.init(this.layer,re),this.passes.push(he))}},{key:"insert",value:function(he,re,de){he.init(this.layer,re),this.passes.splice(de,0,he)}},{key:"destroy",value:function(){this.passes.length=0}}]),T}(),nc=(0,Gt.Z)(rc.prototype,"postProcessor",[oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rc))||Ks),Du,il;function Ec(T){var Ke=Eu();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Eu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var su=(Du=(0,O.b2)(),Du(il=function(T){(0,k.Z)(he,T);var Ke=Ec(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,Z.Z)((0,Q.Z)(re),"pickingFBO",void 0),(0,Z.Z)((0,Q.Z)(re),"layer",void 0),(0,Z.Z)((0,Q.Z)(re),"width",0),(0,Z.Z)((0,Q.Z)(re),"height",0),(0,Z.Z)((0,Q.Z)(re),"alreadyInRendering",!1),(0,Z.Z)((0,Q.Z)(re),"pickFromPickingFBO",function(Lt){var _t=Lt.x,jt=Lt.y,Fr=Lt.lngLat,$r=Lt.type;if(!(!re.layer.isVisible()||!re.layer.needPick($r))){var Un=re.rendererService,Hn=Un.getViewportSize,_i=Un.readPixelsAsync,Pi=Un.useFramebuffer,Jn=Hn(),Ei=Jn.width,ya=Jn.height,ia=re.layer.getLayerConfig(),zo=ia.enableHighlight,co=ia.enableSelect,Eo=_t*J.SO.DPR,_a=jt*J.SO.DPR;if(!(Eo>Ei||Eo<0||_a>ya||_a<0)){var Da;Pi(re.pickingFBO,(0,dr.Z)(He().mark(function Io(){var Zo,ts,Oo,oo,fo;return He().wrap(function(Kl){for(;;)switch(Kl.prev=Kl.next){case 0:return Kl.next=2,_i({x:Math.round(Eo),y:Math.round(ya-(jt+1)*J.SO.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:re.pickingFBO});case 2:Da=Kl.sent,Da[0]!==0||Da[1]!==0||Da[2]!==0?(ts=(0,J.W0)(Da),Oo=re.layer.getSource().getFeatureById(ts),oo={x:_t,y:jt,type:$r,lngLat:Fr,featureId:ts,feature:Oo},Oo&&(re.layer.setCurrentPickId(ts),re.triggerHoverOnLayer(oo))):(fo={x:_t,y:jt,lngLat:Fr,type:re.layer.getCurrentPickId()===null?"un"+$r:"mouseout",featureId:null,feature:null},re.triggerHoverOnLayer((0,F.Z)((0,F.Z)({},fo),{},{type:"unpick"})),re.triggerHoverOnLayer(fo),re.layer.setCurrentPickId(null)),zo&&re.highlightPickedFeature(Da),co&&$r==="click"&&((Zo=Da)===null||Zo===void 0?void 0:Zo.toString())!==[0,0,0,0].toString()&&re.selectFeature(Da);case 6:case"end":return Kl.stop()}},Io)})))}}}),re}return(0,V.Z)(he,[{key:"getType",value:function(){return Bs.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(de,Oe){(0,Pu.Z)((0,U.Z)(he.prototype),"init",this).call(this,de,Oe),this.layer=de;var dt=this.rendererService,Lt=dt.createTexture2D,_t=dt.createFramebuffer,jt=dt.getViewportSize,Fr=jt(),$r=Fr.width,Un=Fr.height,Hn=Lt({width:$r,height:Un,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=_t({color:Hn}),this.interactionService.on(go.Hover,this.pickFromPickingFBO),this.interactionService.on(go.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(go.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(de){var Oe=this;if(!this.alreadyInRendering){var dt=this.rendererService,Lt=dt.getViewportSize,_t=dt.useFramebuffer,jt=dt.clear,Fr=Lt(),$r=Fr.width,Un=Fr.height;this.alreadyInRendering=!0,(this.width!==$r||this.height!==Un)&&(this.pickingFBO.resize({width:$r,height:Un}),this.width=$r,this.height=Un),_t(this.pickingFBO,function(){jt({framebuffer:Oe.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var Hn=Oe.layer.multiPassRenderer.getRenderFlag();Oe.layer.multiPassRenderer.setRenderFlag(!1),de.hooks.beforePickingEncode.call(),de.render(),de.hooks.afterPickingEncode.call(),Oe.layer.multiPassRenderer.setRenderFlag(Hn),Oe.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(de){this.layer.emit(de.type,de)}},{key:"highlightPickedFeature",value:function(de){var Oe=(0,Dn.Z)(de,3),dt=Oe[0],Lt=Oe[1],_t=Oe[2];this.layer.hooks.beforeHighlight.call([dt,Lt,_t]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(de){var Oe=(0,Dn.Z)(de,3),dt=Oe[0],Lt=Oe[1],_t=Oe[2];this.layer.hooks.beforeSelect.call([dt,Lt,_t]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(de){var Oe=de.featureId,dt=(0,J.Z6)(Oe);this.selectFeature(new Uint8Array(dt))}},{key:"highlightFeatureHandle",value:function(de){var Oe=de.featureId,dt=(0,J.Z6)(Oe);this.highlightPickedFeature(new Uint8Array(dt))}}]),he}(ec))||il),Lc,Rl,vs,uu,Sf,Bc=J.rU.camelCase,Sc=J.rU.isNil,Tf=J.rU.upperFirst,Su=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$o=(Lc=(0,O.b2)(),Rl=(0,O.f3)(P.IShaderModuleService),Lc(vs=(uu=function(){function T(){(0,Y.Z)(this,T),(0,bt.Z)(this,"shaderModuleService",Sf,this),(0,Z.Z)(this,"rendererService",void 0),(0,Z.Z)(this,"config",void 0),(0,Z.Z)(this,"quad",Su),(0,Z.Z)(this,"enabled",!0),(0,Z.Z)(this,"renderToScreen",!1),(0,Z.Z)(this,"model",void 0),(0,Z.Z)(this,"name",void 0),(0,Z.Z)(this,"optionsToUpdate",{})}return(0,V.Z)(T,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(he){this.name=he}},{key:"getType",value:function(){return Bs.PostProcessing}},{key:"init",value:function(he,re){this.config=re,this.rendererService=he.getContainer().get(P.IRendererService),this.shaderModuleService=he.getContainer().get(P.IShaderModuleService);var de=this.rendererService,Oe=de.createAttribute,dt=de.createBuffer,Lt=de.createModel,_t=this.setupShaders(),jt=_t.vs,Fr=_t.fs,$r=_t.uniforms;this.model=Lt({vs:jt,fs:Fr,attributes:{a_Position:Oe({buffer:dt({data:[-4,-4,4,-4,0,4],type:po.FLOAT}),size:2})},uniforms:(0,F.Z)((0,F.Z)({u_Texture:null},$r),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(he,re){var de=this,Oe=he.multiPassRenderer.getPostProcessor(),dt=this.rendererService,Lt=dt.useFramebuffer,_t=dt.getViewportSize,jt=dt.clear,Fr=_t(),$r=Fr.width,Un=Fr.height;Lt(this.renderToScreen?null:Oe.getWriteFBO(),function(){jt({framebuffer:Oe.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var Hn=(0,F.Z)({u_BloomFinal:0,u_Texture:Oe.getReadFBO(),u_ViewportSize:[$r,Un]},de.convertOptionsToUniforms(de.optionsToUpdate));re&&(Hn.u_BloomFinal=1,Hn.u_Texture2=re),de.model.draw({uniforms:Hn})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(he){this.enabled=he}},{key:"setRenderToScreen",value:function(he){this.renderToScreen=he}},{key:"updateOptions",value:function(he){this.optionsToUpdate=(0,F.Z)((0,F.Z)({},this.optionsToUpdate),he)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(he){var re={};return Object.keys(he).forEach(function(de){Sc(he[de])||(re["u_".concat(Tf(Bc(de)))]=he[de])}),re}}]),T}(),Sf=(0,Gt.Z)(uu.prototype,"shaderModuleService",[Rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu))||vs),ea,Qs;function Tu(T){var Ke=Ga();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Ga(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Ml=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,al=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,lu=J.rU.isNil,es=(ea=(0,O.b2)(),ea(Qs=function(T){(0,k.Z)(he,T);var Ke=Tu(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:al,fs:Ml});var de=this.shaderModuleService.getModule("blur-pass"),Oe=de.vs,dt=de.fs,Lt=de.uniforms,_t=this.rendererService.getViewportSize(),jt=_t.width,Fr=_t.height;return{vs:Oe,fs:dt,uniforms:(0,F.Z)((0,F.Z)({},Lt),{},{u_ViewportSize:[jt,Fr]})}}},{key:"convertOptionsToUniforms",value:function(de){var Oe={};return lu(de.bloomRadius)||(Oe.u_radius=de.bloomRadius),lu(de.bloomIntensity)||(Oe.u_intensity=de.bloomIntensity),lu(de.bloomBaseRadio)||(Oe.u_baseRadio=de.bloomBaseRadio),Oe}}]),he}($o))||Qs),ic,Ci;function rn(T){var Ke=cu();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function cu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var ws=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,fu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ro=J.rU.isNil,Fs=(ic=(0,O.b2)(),ic(Ci=function(T){(0,k.Z)(he,T);var Ke=rn(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:fu,fs:ws});var de=this.shaderModuleService.getModule("blur-pass"),Oe=de.vs,dt=de.fs,Lt=de.uniforms,_t=this.rendererService.getViewportSize(),jt=_t.width,Fr=_t.height;return{vs:Oe,fs:dt,uniforms:(0,F.Z)((0,F.Z)({},Lt),{},{u_ViewportSize:[jt,Fr]})}}},{key:"convertOptionsToUniforms",value:function(de){var Oe={};return Ro(de.blurRadius)||(Oe.u_BlurDir=[de.blurRadius,0]),Oe}}]),he}($o))||Ci),ku,Il;function Na(T){var Ke=No();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function No(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var ao=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,ol=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,sl=J.rU.isNil,ul=(ku=(0,O.b2)(),ku(Il=function(T){(0,k.Z)(he,T);var Ke=Na(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:ol,fs:ao});var de=this.shaderModuleService.getModule("blur-pass"),Oe=de.vs,dt=de.fs,Lt=de.uniforms,_t=this.rendererService.getViewportSize(),jt=_t.width,Fr=_t.height;return{vs:Oe,fs:dt,uniforms:(0,F.Z)((0,F.Z)({},Lt),{},{u_ViewportSize:[jt,Fr]})}}},{key:"convertOptionsToUniforms",value:function(de){var Oe={};return sl(de.blurRadius)||(Oe.u_BlurDir=[0,de.blurRadius]),Oe}}]),he}($o))||Il),hu,Tc;function ll(T){var Ke=Kc();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Kc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var ac=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Vi=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ol=(hu=(0,O.b2)(),hu(Tc=function(T){(0,k.Z)(he,T);var Ke=ll(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Vi,fs:ac});var de=this.shaderModuleService.getModule("colorhalftone-pass"),Oe=de.vs,dt=de.fs,Lt=de.uniforms,_t=this.rendererService.getViewportSize(),jt=_t.width,Fr=_t.height;return{vs:Oe,fs:dt,uniforms:(0,F.Z)((0,F.Z)({},Lt),{},{u_ViewportSize:[jt,Fr]})}}}]),he}($o))||Tc),Pl,yo;function Gu(T){var Ke=Ii();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Ii(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Ns=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,cl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eo=(Pl=(0,O.b2)(),Pl(yo=function(T){(0,k.Z)(he,T);var Ke=Gu(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:cl,fs:Ns}),this.shaderModuleService.getModule("copy-pass")}}]),he}($o))||yo),Wo,Wl;function oc(T){var Ke=Ra();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Ra(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Gl=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,l=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,d=(Wo=(0,O.b2)(),Wo(Wl=function(T){(0,k.Z)(he,T);var Ke=oc(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:l,fs:Gl});var de=this.shaderModuleService.getModule("hexagonalpixelate-pass"),Oe=de.vs,dt=de.fs,Lt=de.uniforms,_t=this.rendererService.getViewportSize(),jt=_t.width,Fr=_t.height;return{vs:Oe,fs:dt,uniforms:(0,F.Z)((0,F.Z)({},Lt),{},{u_ViewportSize:[jt,Fr]})}}}]),he}($o))||Wl),f,m;function S(T){var Ke=R();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function R(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var L=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,q=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Se=(f=(0,O.b2)(),f(m=function(T){(0,k.Z)(he,T);var Ke=S(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:q,fs:L});var de=this.shaderModuleService.getModule("ink-pass"),Oe=de.vs,dt=de.fs,Lt=de.uniforms,_t=this.rendererService.getViewportSize(),jt=_t.width,Fr=_t.height;return{vs:Oe,fs:dt,uniforms:(0,F.Z)((0,F.Z)({},Lt),{},{u_ViewportSize:[jt,Fr]})}}}]),he}($o))||m),Le,et;function ot(T){var Ke=st();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function st(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var Rt=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Ct=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Xt=(Le=(0,O.b2)(),Le(et=function(T){(0,k.Z)(he,T);var Ke=ot(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Ct,fs:Rt}),this.shaderModuleService.getModule("noise-pass")}}]),he}($o))||et),St,$t;function tr(T){var Ke=br();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function br(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var kr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Or=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,Hr=(St=(0,O.b2)(),St($t=function(T){(0,k.Z)(he,T);var Ke=tr(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:kr,fs:Or}),this.shaderModuleService.getModule("sepia-pass")}}]),he}($o))||$t),nn,M,z,j,ne,ce,le=(nn=(0,O.b2)(),M=(0,O.f3)(P.IRendererService),z=(0,O.zY)(),nn(j=(ne=function(){function T(){(0,Y.Z)(this,T),(0,bt.Z)(this,"rendererService",ce,this),(0,Z.Z)(this,"passes",[]),(0,Z.Z)(this,"readFBO",void 0),(0,Z.Z)(this,"writeFBO",void 0)}return(0,V.Z)(T,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var he=this.rendererService,re=he.getViewportSize,de=he.createTexture2D,Oe=re(),dt=Oe.width,Lt=Oe.height;return de({x:0,y:0,width:dt,height:Lt,copy:!0})}},{key:"getReadFBOTex",value:function(){var he=this,re=this.rendererService.useFramebuffer;return new Promise(function(de){re(he.readFBO,(0,dr.Z)(He().mark(function Oe(){return He().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:de(he.getCurrentFBOTex());case 1:case"end":return Lt.stop()}},Oe)})))})}},{key:"renderBloomPass",value:function(){var Ke=(0,dr.Z)(He().mark(function re(de,Oe){var dt,Lt;return He().wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.getReadFBOTex();case 2:dt=jt.sent,Lt=0;case 4:if(!(Lt<4)){jt.next=11;break}return jt.next=7,Oe.render(de,dt);case 7:this.swap(),Lt++,jt.next=4;break;case 11:case"end":return jt.stop()}},re,this)}));function he(re,de){return Ke.apply(this,arguments)}return he}()},{key:"render",value:function(){var Ke=(0,dr.Z)(He().mark(function re(de){var Oe,dt;return He().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:Oe=0;case 1:if(!(Oe<this.passes.length)){_t.next=15;break}if(dt=this.passes[Oe],dt.setRenderToScreen(this.isLastEnabledPass(Oe)),dt.getName()!=="bloom"){_t.next=9;break}return _t.next=7,this.renderBloomPass(de,dt);case 7:_t.next=12;break;case 9:return _t.next=11,dt.render(de);case 11:Oe!==this.passes.length-1&&this.swap();case 12:Oe++,_t.next=1;break;case 15:case"end":return _t.stop()}},re,this)}));function he(re){return Ke.apply(this,arguments)}return he}()},{key:"resize",value:function(he,re){this.readFBO.resize({width:he,height:re}),this.writeFBO.resize({width:he,height:re})}},{key:"add",value:function(he,re,de){he.init(re,de),this.passes.push(he)}},{key:"insert",value:function(he,re,de,Oe){he.init(de,Oe),this.passes.splice(re,0,he)}},{key:"getPostProcessingPassByName",value:function(he){return this.passes.find(function(re){return re.getName()===he})}},{key:"init",value:function(){var he=this.rendererService,re=he.createFramebuffer,de=he.createTexture2D;this.readFBO=re({color:de({width:1,height:1,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE})}),this.writeFBO=re({color:de({width:1,height:1,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(he){for(var re=he+1;re<this.passes.length;re++)if(this.passes[re].isEnabled())return!1;return!0}},{key:"swap",value:function(){var he=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=he}}]),T}(),ce=(0,Gt.Z)(ne.prototype,"rendererService",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,Gt.Z)(ne.prototype,"init",[z],Object.getOwnPropertyDescriptor(ne.prototype,"init"),ne.prototype),ne))||j),lt,it;function Yt(T){var Ke=ht();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function ht(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var er=(lt=(0,O.b2)(),lt(it=function(T){(0,k.Z)(he,T);var Ke=Yt(he);function he(){return(0,Y.Z)(this,he),Ke.apply(this,arguments)}return(0,V.Z)(he,[{key:"getType",value:function(){return Bs.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(de,Oe){(0,Pu.Z)((0,U.Z)(he.prototype),"init",this).call(this,de,Oe)}},{key:"render",value:function(de){var Oe=this.rendererService,dt=Oe.useFramebuffer,Lt=Oe.clear,_t=de.multiPassRenderer.getPostProcessor().getReadFBO();dt(_t,function(){Lt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:_t}),de.multiPassRenderer.setRenderFlag(!1),de.models.forEach(function(jt){jt.draw({uniforms:de.layerModel.getUninforms()})}),de.multiPassRenderer.setRenderFlag(!0)})}}]),he}(ec))||it),yr,_n,vn,Jr,Gn;function Xn(T){var Ke=Yn();return function(){var re=(0,U.Z)(T),de;if(Ke){var Oe=(0,U.Z)(this).constructor;de=Reflect.construct(re,arguments,Oe)}else de=re.apply(this,arguments);return(0,K.Z)(this,de)}}function Yn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(T){return!1}}var gi=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,xi=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Ni=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Pa(T,Ke){for(var he=0,re=1/Ke,de=T;de>0;)he=he+re*(de%Ke),de=Math.floor(de/Ke),re=re/Ke;return he}var Ua=1,Mo=(yr=(0,O.b2)(),_n=(0,O.f3)(P.IShaderModuleService),yr(vn=(Jr=function(T){(0,k.Z)(he,T);var Ke=Xn(he);function he(){var re;(0,Y.Z)(this,he);for(var de=arguments.length,Oe=new Array(de),dt=0;dt<de;dt++)Oe[dt]=arguments[dt];return re=Ke.call.apply(Ke,[this].concat(Oe)),(0,bt.Z)((0,Q.Z)(re),"shaderModuleService",Gn,(0,Q.Z)(re)),(0,Z.Z)((0,Q.Z)(re),"haltonSequence",[]),(0,Z.Z)((0,Q.Z)(re),"accumulatingId",0),(0,Z.Z)((0,Q.Z)(re),"frame",0),(0,Z.Z)((0,Q.Z)(re),"timer",void 0),(0,Z.Z)((0,Q.Z)(re),"sampleRenderTarget",void 0),(0,Z.Z)((0,Q.Z)(re),"prevRenderTarget",void 0),(0,Z.Z)((0,Q.Z)(re),"outputRenderTarget",void 0),(0,Z.Z)((0,Q.Z)(re),"copyRenderTarget",void 0),(0,Z.Z)((0,Q.Z)(re),"blendModel",void 0),(0,Z.Z)((0,Q.Z)(re),"outputModel",void 0),(0,Z.Z)((0,Q.Z)(re),"copyModel",void 0),re}return(0,V.Z)(he,[{key:"getType",value:function(){return Bs.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(de,Oe){(0,Pu.Z)((0,U.Z)(he.prototype),"init",this).call(this,de,Oe);var dt=this.rendererService,Lt=dt.createFramebuffer,_t=dt.createTexture2D;this.sampleRenderTarget=Lt({color:_t({width:1,height:1,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE})}),this.prevRenderTarget=Lt({color:_t({width:1,height:1,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE})}),this.outputRenderTarget=Lt({color:_t({width:1,height:1,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE})}),this.copyRenderTarget=Lt({color:_t({width:1,height:1,wrapS:po.CLAMP_TO_EDGE,wrapT:po.CLAMP_TO_EDGE})});for(var jt=0;jt<30;jt++)this.haltonSequence.push([Pa(jt,2),Pa(jt,3)]);this.blendModel=this.createTriangleModel("blend-pass",gi),this.outputModel=this.createTriangleModel("copy-pass",xi,{blend:{enable:!0,func:{srcRGB:po.ONE,dstRGB:po.ONE_MINUS_SRC_ALPHA,srcAlpha:po.ONE,dstAlpha:po.ONE_MINUS_SRC_ALPHA},equation:{rgb:po.FUNC_ADD,alpha:po.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",xi)}},{key:"render",value:function(de){var Oe=this,dt=this.rendererService,Lt=dt.clear,_t=dt.getViewportSize,jt=dt.useFramebuffer,Fr=_t(),$r=Fr.width,Un=Fr.height;this.sampleRenderTarget.resize({width:$r,height:Un}),this.prevRenderTarget.resize({width:$r,height:Un}),this.outputRenderTarget.resize({width:$r,height:Un}),this.copyRenderTarget.resize({width:$r,height:Un}),this.resetFrame(),this.stopAccumulating();var Hn=de.multiPassRenderer.getPostProcessor().getReadFBO();jt(Hn,function(){Lt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Hn}),de.multiPassRenderer.setRenderFlag(!1),de.render(),de.multiPassRenderer.setRenderFlag(!0)});var _i=function Pi(Jn){!Oe.accumulatingId||Jn!==Oe.accumulatingId||Oe.isFinished()||(Oe.doRender(de),window.requestAnimationFrame(function(){Pi(Jn)}))};this.accumulatingId=Ua++,this.timer=window.setTimeout(function(){_i(Oe.accumulatingId)},50)}},{key:"doRender",value:function(de){var Oe=this,dt=this.rendererService,Lt=dt.clear,_t=dt.getViewportSize,jt=dt.useFramebuffer,Fr=_t(),$r=Fr.width,Un=Fr.height,Hn=de.getLayerConfig(),_i=Hn.jitterScale,Pi=_i===void 0?1:_i,Jn=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Jn[0]*2-1)/$r*Pi,(Jn[1]*2-1)/Un*Pi),de.multiPassRenderer.setRenderFlag(!1),de.hooks.beforeRender.call(),jt(this.sampleRenderTarget,function(){Lt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Oe.sampleRenderTarget}),de.render()}),de.hooks.afterRender.call(),de.multiPassRenderer.setRenderFlag(!0);var Ei=de.getLayerConfig();jt(this.outputRenderTarget,function(){Oe.blendModel.draw({uniforms:{u_opacity:Ei.opacity||1,u_MixRatio:Oe.frame===0?1:.9,u_Diffuse1:Oe.sampleRenderTarget,u_Diffuse2:Oe.frame===0?de.multiPassRenderer.getPostProcessor().getReadFBO():Oe.prevRenderTarget}})}),this.frame===0&&Lt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(jt(this.copyRenderTarget,function(){Oe.outputModel.draw({uniforms:{u_Texture:Oe.outputRenderTarget}})}),jt(de.multiPassRenderer.getPostProcessor().getReadFBO(),function(){Oe.copyModel.draw({uniforms:{u_Texture:Oe.copyRenderTarget}})}),de.multiPassRenderer.getPostProcessor().render(de));var ya=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=ya,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(de,Oe,dt){this.shaderModuleService.registerModule(de,{vs:Ni,fs:Oe});var Lt=this.shaderModuleService.getModule(de),_t=Lt.vs,jt=Lt.fs,Fr=Lt.uniforms,$r=this.rendererService,Un=$r.createAttribute,Hn=$r.createBuffer,_i=$r.createModel;return _i((0,F.Z)({vs:_t,fs:jt,attributes:{a_Position:Un({buffer:Hn({data:[-4,-4,4,-4,0,4],type:po.FLOAT}),size:2})},uniforms:(0,F.Z)({},Fr),depth:{enable:!1},count:3},dt))}}]),he}(ec),Gn=(0,Gt.Z)(Jr.prototype,"shaderModuleService",[_n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jr))||vn),ga=new O.W2;ga.bind(P.IGlobalConfigService).to(ft).inSingletonScope(),(0,O.GW)((0,O.b2)(),N.EventEmitter),ga.bind(P.IEventEmitter).to(N.EventEmitter);var Xi=(0,C.Z)(ga,!1),da=function(Ke){var he=Xi.lazyInject(Ke);return function(re,de,Oe){he.call(this,re,de),Oe&&(Oe.initializer=function(){return re[de]})}},Go=function(Ke){var he=Xi.lazyMultiInject(Ke);return function(re,de,Oe){he.call(this,re,de),Oe&&(Oe.initializer=function(){return re[de]})}},ls=ga,Uo=0;function Xo(){var T=new O.W2;return T.parent=ga,T.bind(P.SceneID).toConstantValue("".concat(Uo++)),T.bind(P.IShaderModuleService).to(Xc).inSingletonScope(),T.bind(P.ILayerService).to(df).inSingletonScope(),T.bind(P.IDebugService).to(Ls).inSingletonScope(),T.bind(P.ISceneService).to(yf).inSingletonScope(),T.bind(P.ICameraService).to(cr).inSingletonScope(),T.bind(P.ICoordinateSystemService).to(qi).inSingletonScope(),T.bind(P.IInteractionService).to(Ca).inSingletonScope(),T.bind(P.IPickingService).to(ff).inSingletonScope(),T.bind(P.IControlService).to(Ye).inSingletonScope(),T.bind(P.IMarkerService).to(ar).inSingletonScope(),T.bind(P.IIconService).to(Qr).inSingletonScope(),T.bind(P.IFontService).to(Vt).inSingletonScope(),T.bind(P.IPopupService).to(oe).inSingletonScope(),T.bind(P.INormalPass).to(Nf).whenTargetNamed("clear"),T.bind(P.INormalPass).to(su).whenTargetNamed("pixelPicking"),T.bind(P.INormalPass).to(er).whenTargetNamed("render"),T.bind(P.INormalPass).to(Mo).whenTargetNamed("taa"),T.bind(P.IFactoryNormalPass).toFactory(function(Ke){return function(he){return Ke.container.getNamed(P.INormalPass,he)}}),T.bind(P.IPostProcessingPass).to(eo).whenTargetNamed("copy"),T.bind(P.IPostProcessingPass).to(es).whenTargetNamed("bloom"),T.bind(P.IPostProcessingPass).to(Fs).whenTargetNamed("blurH"),T.bind(P.IPostProcessingPass).to(ul).whenTargetNamed("blurV"),T.bind(P.IPostProcessingPass).to(Xt).whenTargetNamed("noise"),T.bind(P.IPostProcessingPass).to(Hr).whenTargetNamed("sepia"),T.bind(P.IPostProcessingPass).to(Ol).whenTargetNamed("colorHalftone"),T.bind(P.IPostProcessingPass).to(d).whenTargetNamed("hexagonalPixelate"),T.bind(P.IPostProcessingPass).to(Se).whenTargetNamed("ink"),T.bind(P.IFactoryPostProcessingPass).toFactory(function(Ke){return function(he){var re=Ke.container.getNamed(P.IPostProcessingPass,he);return re.setName(he),re}}),T}function Rs(T){var Ke=new O.W2;return Ke.parent=T,Ke.bind(P.IStyleAttributeService).to(au).inSingletonScope(),Ke.bind(P.IMultiPassRenderer).to(zn).inSingletonScope(),Ke.bind(P.IPostProcessor).to(le).inSingletonScope(),Ke}var xo=null;function fl(T){return xo.indexOf(T)}var ms=J.rU.clamp,Yo=2,Lu=4,hl=64,Xl=128,Ma=256,bs=512,xs=8192,sc=16384,rh=32768,uc=null,Uf=131072,qc=262144,Fc=524288,Yl=1048576,zf=2097152,qh=4194304,Qc=8388608,Au=16777216,Qh=null;function nh(T,Ke){return T=ms(Math.floor(T),0,255),Ke=ms(Math.floor(Ke),0,255),256*T+Ke}function ih(T){var Ke=T.color,he=T.radius,re=T.tileX,de=T.tileY,Oe=T.shape,dt=T.opacity,Lt=T.stroke,_t=T.strokeWidth,jt=T.strokeOpacity,Fr=[],$r=[],Un=[],Hn=[nh(Ke[0],Ke[1]),nh(Ke[2],Ke[3])],_i=[nh(Lt[0],Lt[1]),nh(Lt[2],Lt[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(Pi){var Jn=_slicedToArray(Pi,2),Ei=Jn[0],ya=Jn[1];Fr.push([].concat(Hn,[(Ei+1)*Qc+(ya+1)*zf+getShapeIndex(Oe)*Uf+he,(re+512)*Fc+(de+512)*hl])),$r.push([].concat(_i,[_t,jt])),Un.push([dt,0,0,0])}),{packedBuffer:Fr,packedBuffer2:$r,packedBuffer3:Un}}function Vp(T,Ke){if(T===0&&!Ke)return 0;if(T===1&&Ke)return 4294967295;var he=Ke?1:0,re=Math.floor(T*127);return re*Qh+he*Au+re*Uf+he*uc+re*bs+he*Ma+re*Yo+he}var Jh={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},Ed={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},Zf=function(T){return T.LINEAR="linear",T.SEQUENTIAL="sequential",T.POWER="power",T.LOG="log",T.IDENTITY="identity",T.TIME="time",T.QUANTILE="quantile",T.QUANTIZE="quantize",T.THRESHOLD="threshold",T.CAT="cat",T.DIVERGING="diverging",T.CUSTOM="threshold",T}({}),np=function(T){return T.CONSTANT="constant",T.VARIABLE="variable",T}({}),yh=function(T){return T[T.Attribute=0]="Attribute",T[T.InstancedAttribute=1]="InstancedAttribute",T[T.Uniform=2]="Uniform",T}({}),ed=["mapload","mapchange","mapAfterFrameChange"],Jc=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],ah=function(T){return T.IMAGE="image",T.CUSTOMIMAGE="customImage",T.ARRAYBUFFER="arraybuffer",T.RGB="rgb",T.TERRAINRGB="terrainRGB",T.CUSTOMRGB="customRGB",T.CUSTOMARRAYBUFFER="customArrayBuffer",T.CUSTOMTERRAINRGB="customTerrainRGB",T}({})},83557:function(Ze,E,_){var D=_(34155);var N;(function(h){(function(O){var C=typeof _.g=="object"?_.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),P=F(h);typeof C.Reflect=="undefined"?C.Reflect=h:P=F(C.Reflect,P),O(P);function F(Y,V){return function(Q,k){typeof Y[Q]!="function"&&Object.defineProperty(Y,Q,{configurable:!0,writable:!0,value:k}),V&&V(Q,k)}}})(function(O){var C=Object.prototype.hasOwnProperty,P=typeof Symbol=="function",F=P&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",Y=P&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",V=typeof Object.create=="function",Q={__proto__:[]}instanceof Array,k=!V&&!Q,K={create:V?function(){return ri(Object.create(null))}:Q?function(){return ri({__proto__:null})}:function(){return ri({})},has:k?function(zt,cr){return C.call(zt,cr)}:function(zt,cr){return cr in zt},get:k?function(zt,cr){return C.call(zt,cr)?zt[cr]:void 0}:function(zt,cr){return zt[cr]}},U=Object.getPrototypeOf(Function),Z=typeof D=="object"&&D["env"]&&D["env"].REFLECT_METADATA_USE_MAP_POLYFILL==="true",J=!Z&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Qr(),H=!Z&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Dn(),ve=!Z&&typeof WeakMap=="function"?WeakMap:On(),Te=new ve;function ye(zt,cr,Zr,Kr){if(At(Zr)){if(!dr(zt))throw new TypeError;if(!He(cr))throw new TypeError;return xe(zt,cr)}else{if(!dr(zt))throw new TypeError;if(!vr(cr))throw new TypeError;if(!vr(Kr)&&!At(Kr)&&!hn(Kr))throw new TypeError;return hn(Kr)&&(Kr=void 0),Zr=Vt(Zr),je(zt,cr,Zr,Kr)}}O("decorate",ye);function Ve(zt,cr){function Zr(Kr,en){if(!vr(Kr))throw new TypeError;if(!At(en)&&!wr(en))throw new TypeError;vt(zt,cr,Kr,en)}return Zr}O("metadata",Ve);function Re(zt,cr,Zr,Kr){if(!vr(Zr))throw new TypeError;return At(Kr)||(Kr=Vt(Kr)),vt(zt,cr,Zr,Kr)}O("defineMetadata",Re);function Ae(zt,cr,Zr){if(!vr(cr))throw new TypeError;return At(Zr)||(Zr=Vt(Zr)),Pe(zt,cr,Zr)}O("hasMetadata",Ae);function ae(zt,cr,Zr){if(!vr(cr))throw new TypeError;return At(Zr)||(Zr=Vt(Zr)),we(zt,cr,Zr)}O("hasOwnMetadata",ae);function ee(zt,cr,Zr){if(!vr(cr))throw new TypeError;return At(Zr)||(Zr=Vt(Zr)),nt(zt,cr,Zr)}O("getMetadata",ee);function me(zt,cr,Zr){if(!vr(cr))throw new TypeError;return At(Zr)||(Zr=Vt(Zr)),at(zt,cr,Zr)}O("getOwnMetadata",me);function ge(zt,cr){if(!vr(zt))throw new TypeError;return At(cr)||(cr=Vt(cr)),Tt(zt,cr)}O("getMetadataKeys",ge);function fe(zt,cr){if(!vr(zt))throw new TypeError;return At(cr)||(cr=Vt(cr)),ze(zt,cr)}O("getOwnMetadataKeys",fe);function Et(zt,cr,Zr){if(!vr(cr))throw new TypeError;At(Zr)||(Zr=Vt(Zr));var Kr=ue(cr,Zr,!1);if(At(Kr)||!Kr.delete(zt))return!1;if(Kr.size>0)return!0;var en=Te.get(cr);return en.delete(Zr),en.size>0||Te.delete(cr),!0}O("deleteMetadata",Et);function xe(zt,cr){for(var Zr=zt.length-1;Zr>=0;--Zr){var Kr=zt[Zr],en=Kr(cr);if(!At(en)&&!hn(en)){if(!He(en))throw new TypeError;cr=en}}return cr}function je(zt,cr,Zr,Kr){for(var en=zt.length-1;en>=0;--en){var Wn=zt[en],De=Wn(cr,Zr,Kr);if(!At(De)&&!hn(De)){if(!vr(De))throw new TypeError;Kr=De}}return Kr}function ue(zt,cr,Zr){var Kr=Te.get(zt);if(At(Kr)){if(!Zr)return;Kr=new J,Te.set(zt,Kr)}var en=Kr.get(cr);if(At(en)){if(!Zr)return;en=new J,Kr.set(cr,en)}return en}function Pe(zt,cr,Zr){var Kr=we(zt,cr,Zr);if(Kr)return!0;var en=an(cr);return hn(en)?!1:Pe(zt,en,Zr)}function we(zt,cr,Zr){var Kr=ue(cr,Zr,!1);return At(Kr)?!1:un(Kr.has(zt))}function nt(zt,cr,Zr){var Kr=we(zt,cr,Zr);if(Kr)return at(zt,cr,Zr);var en=an(cr);if(!hn(en))return nt(zt,en,Zr)}function at(zt,cr,Zr){var Kr=ue(cr,Zr,!1);if(!At(Kr))return Kr.get(zt)}function vt(zt,cr,Zr,Kr){var en=ue(Zr,Kr,!0);en.set(zt,cr)}function Tt(zt,cr){var Zr=ze(zt,cr),Kr=an(zt);if(Kr===null)return Zr;var en=Tt(Kr,cr);if(en.length<=0)return Zr;if(Zr.length<=0)return en;for(var Wn=new H,De=[],X=0,se=Zr;X<se.length;X++){var Be=se[X],Ye=Wn.has(Be);Ye||(Wn.add(Be),De.push(Be))}for(var ct=0,sr=en;ct<sr.length;ct++){var Be=sr[ct],Ye=Wn.has(Be);Ye||(Wn.add(Be),De.push(Be))}return De}function ze(zt,cr){var Zr=[],Kr=ue(zt,cr,!1);if(At(Kr))return Zr;for(var en=Kr.keys(),Wn=Xr(en),De=0;;){var X=Ue(Wn);if(!X)return Zr.length=De,Zr;var se=Er(X);try{Zr[De]=se}catch(Be){try{In(Wn)}finally{throw Be}}De++}}function gr(zt){if(zt===null)return 1;switch(typeof zt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return zt===null?1:6;default:return 6}}function At(zt){return zt===void 0}function hn(zt){return zt===null}function Wr(zt){return typeof zt=="symbol"}function vr(zt){return typeof zt=="object"?zt!==null:typeof zt=="function"}function dn(zt,cr){switch(gr(zt)){case 0:return zt;case 1:return zt;case 2:return zt;case 3:return zt;case 4:return zt;case 5:return zt}var Zr=cr===3?"string":cr===5?"number":"default",Kr=Ne(zt,F);if(Kr!==void 0){var en=Kr.call(zt,Zr);if(vr(en))throw new TypeError;return en}return tn(zt,Zr==="default"?"number":Zr)}function tn(zt,cr){if(cr==="string"){var Zr=zt.toString;if(wt(Zr)){var Kr=Zr.call(zt);if(!vr(Kr))return Kr}var en=zt.valueOf;if(wt(en)){var Kr=en.call(zt);if(!vr(Kr))return Kr}}else{var en=zt.valueOf;if(wt(en)){var Kr=en.call(zt);if(!vr(Kr))return Kr}var Wn=zt.toString;if(wt(Wn)){var Kr=Wn.call(zt);if(!vr(Kr))return Kr}}throw new TypeError}function un(zt){return!!zt}function yn(zt){return""+zt}function Vt(zt){var cr=dn(zt,3);return Wr(cr)?cr:yn(cr)}function dr(zt){return Array.isArray?Array.isArray(zt):zt instanceof Object?zt instanceof Array:Object.prototype.toString.call(zt)==="[object Array]"}function wt(zt){return typeof zt=="function"}function He(zt){return typeof zt=="function"}function wr(zt){switch(gr(zt)){case 3:return!0;case 4:return!0;default:return!1}}function Ne(zt,cr){var Zr=zt[cr];if(Zr!=null){if(!wt(Zr))throw new TypeError;return Zr}}function Xr(zt){var cr=Ne(zt,Y);if(!wt(cr))throw new TypeError;var Zr=cr.call(zt);if(!vr(Zr))throw new TypeError;return Zr}function Er(zt){return zt.value}function Ue(zt){var cr=zt.next();return cr.done?!1:cr}function In(zt){var cr=zt.return;cr&&cr.call(zt)}function an(zt){var cr=Object.getPrototypeOf(zt);if(typeof zt!="function"||zt===U||cr!==U)return cr;var Zr=zt.prototype,Kr=Zr&&Object.getPrototypeOf(Zr);if(Kr==null||Kr===Object.prototype)return cr;var en=Kr.constructor;return typeof en!="function"||en===zt?cr:en}function Qr(){var zt={},cr=[],Zr=function(){function De(X,se,Be){this._index=0,this._keys=X,this._values=se,this._selector=Be}return De.prototype["@@iterator"]=function(){return this},De.prototype[Y]=function(){return this},De.prototype.next=function(){var X=this._index;if(X>=0&&X<this._keys.length){var se=this._selector(this._keys[X],this._values[X]);return X+1>=this._keys.length?(this._index=-1,this._keys=cr,this._values=cr):this._index++,{value:se,done:!1}}return{value:void 0,done:!0}},De.prototype.throw=function(X){throw this._index>=0&&(this._index=-1,this._keys=cr,this._values=cr),X},De.prototype.return=function(X){return this._index>=0&&(this._index=-1,this._keys=cr,this._values=cr),{value:X,done:!0}},De}();return function(){function De(){this._keys=[],this._values=[],this._cacheKey=zt,this._cacheIndex=-2}return Object.defineProperty(De.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),De.prototype.has=function(X){return this._find(X,!1)>=0},De.prototype.get=function(X){var se=this._find(X,!1);return se>=0?this._values[se]:void 0},De.prototype.set=function(X,se){var Be=this._find(X,!0);return this._values[Be]=se,this},De.prototype.delete=function(X){var se=this._find(X,!1);if(se>=0){for(var Be=this._keys.length,Ye=se+1;Ye<Be;Ye++)this._keys[Ye-1]=this._keys[Ye],this._values[Ye-1]=this._values[Ye];return this._keys.length--,this._values.length--,X===this._cacheKey&&(this._cacheKey=zt,this._cacheIndex=-2),!0}return!1},De.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=zt,this._cacheIndex=-2},De.prototype.keys=function(){return new Zr(this._keys,this._values,Kr)},De.prototype.values=function(){return new Zr(this._keys,this._values,en)},De.prototype.entries=function(){return new Zr(this._keys,this._values,Wn)},De.prototype["@@iterator"]=function(){return this.entries()},De.prototype[Y]=function(){return this.entries()},De.prototype._find=function(X,se){return this._cacheKey!==X&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=X)),this._cacheIndex<0&&se&&(this._cacheIndex=this._keys.length,this._keys.push(X),this._values.push(void 0)),this._cacheIndex},De}();function Kr(De,X){return De}function en(De,X){return X}function Wn(De,X){return[De,X]}}function Dn(){return function(){function zt(){this._map=new J}return Object.defineProperty(zt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),zt.prototype.has=function(cr){return this._map.has(cr)},zt.prototype.add=function(cr){return this._map.set(cr,cr),this},zt.prototype.delete=function(cr){return this._map.delete(cr)},zt.prototype.clear=function(){this._map.clear()},zt.prototype.keys=function(){return this._map.keys()},zt.prototype.values=function(){return this._map.values()},zt.prototype.entries=function(){return this._map.entries()},zt.prototype["@@iterator"]=function(){return this.keys()},zt.prototype[Y]=function(){return this.keys()},zt}()}function On(){var zt=16,cr=K.create(),Zr=Kr();return function(){function se(){this._key=Kr()}return se.prototype.has=function(Be){var Ye=en(Be,!1);return Ye!==void 0?K.has(Ye,this._key):!1},se.prototype.get=function(Be){var Ye=en(Be,!1);return Ye!==void 0?K.get(Ye,this._key):void 0},se.prototype.set=function(Be,Ye){var ct=en(Be,!0);return ct[this._key]=Ye,this},se.prototype.delete=function(Be){var Ye=en(Be,!1);return Ye!==void 0?delete Ye[this._key]:!1},se.prototype.clear=function(){this._key=Kr()},se}();function Kr(){var se;do se="@@WeakMap@@"+X();while(K.has(cr,se));return cr[se]=!0,se}function en(se,Be){if(!C.call(se,Zr)){if(!Be)return;Object.defineProperty(se,Zr,{value:K.create()})}return se[Zr]}function Wn(se,Be){for(var Ye=0;Ye<Be;++Ye)se[Ye]=Math.random()*255|0;return se}function De(se){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(se)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(se)):Wn(new Uint8Array(se),se):Wn(new Array(se),se)}function X(){var se=De(zt);se[6]=se[6]&79|64,se[8]=se[8]&191|128;for(var Be="",Ye=0;Ye<zt;++Ye){var ct=se[Ye];(Ye===4||Ye===6||Ye===8)&&(Be+="-"),ct<16&&(Be+="0"),Be+=ct.toString(16).toLowerCase()}return Be}}function ri(zt){return zt.__=void 0,delete zt.__,zt}})})(N||(N={}))},89826:function(Ze,E,_){"use strict";_.d(E,{Z:function(){return Ge}});var D=_(15671),N=_(43144),h=_(60136),O=_(82963),C=_(61120),P=_(1413),F=_(43269),Y=_(53229),V=_(54095),Q,k,K,U=(Q=(0,V.yT)(V.vK.IGlobalConfigService),k=function(){function We(G){(0,D.Z)(this,We),(0,F.Z)(this,"configService",K,this),this.config=G}return(0,N.Z)(We,[{key:"setContainer",value:function(rt,ft,bt){rt.bind(V.vK.MapConfig).toConstantValue((0,P.Z)((0,P.Z)({},this.config),{},{id:ft,canvas:bt})),rt.bind(V.vK.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),We}(),K=(0,Y.Z)(k.prototype,"configService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k),Z=_(45987),J=_(15861),H=_(97326),ve=_(4942),Te=_(64687),ye=_.n(Te),Ve=_(85975),Re=_(77160),Ae=_(86700),ae=_(6158),ee=_.n(ae),me=_(8520),ge=_(57059),fe=function(){function We(G){(0,D.Z)(this,We),(0,ve.Z)(this,"size",1e4),this.size=G||1e4}return(0,N.Z)(We,[{key:"setSize",value:function(rt){this.size=rt}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(rt){return(180+rt)/360*this.size}},{key:"mercatorYfromLat",value:function(rt){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+rt*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(rt){return rt/this.size*360-180}},{key:"latFromMercatorY",value:function(rt){var ft=180-(1-rt/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(ft*Math.PI/180))-90}},{key:"project",value:function(rt){var ft=this.mercatorXfromLng(rt[0]),bt=this.mercatorYfromLat(rt[1]);return[ft,bt]}},{key:"unproject",value:function(rt){var ft=this.lngFromMercatorX(rt[0]),bt=this.latFromMercatorY(rt[1]);return[ft,bt]}}]),We}(),Et={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},xe,je,ue,Pe,we,nt,at,vt,Tt,ze,gr,At={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},hn=12,Wr=(xe=(0,Ae.b2)(),je=(0,Ae.f3)(V.vK.MapConfig),ue=(0,Ae.f3)(V.vK.IGlobalConfigService),Pe=(0,Ae.f3)(V.vK.ICoordinateSystemService),we=(0,Ae.f3)(V.vK.IEventEmitter),xe(nt=(at=function(){function We(){var G=this;(0,D.Z)(this,We),(0,ve.Z)(this,"version","DEFAUlTMAP"),(0,ve.Z)(this,"simpleMapCoord",new fe),(0,ve.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,F.Z)(this,"config",vt,this),(0,F.Z)(this,"configService",Tt,this),(0,F.Z)(this,"coordinateSystemService",ze,this),(0,F.Z)(this,"eventEmitter",gr,this),(0,ve.Z)(this,"handleCameraChanged",function(rt){var ft=G.map.getCenter(),bt=ft.lat,Gt=ft.lng;G.emit("mapchange"),G.viewport.syncWithMapCamera({bearing:G.map.getBearing(),center:[Gt,bt],viewportHeight:G.map.transform.height,pitch:G.map.getPitch(),viewportWidth:G.map.transform.width,zoom:G.map.getZoom(),cameraHeight:0}),G.updateCoordinateSystemService(),G.cameraChangedCallback(G.viewport)})}return(0,N.Z)(We,[{key:"setBgColor",value:function(rt){this.bgColor=rt}},{key:"addMarkerContainer",value:function(){var rt=this.map.getCanvasContainer();this.markerContainer=ge.SO.create("div","l7-marker-container",rt),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"on",value:function(rt,ft){V.I9.indexOf(rt)!==-1?this.eventEmitter.on(rt,ft):this.map.on(At[rt]||rt,ft)}},{key:"off",value:function(rt,ft){this.map.off(At[rt]||rt,ft),this.eventEmitter.off(rt,ft)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();var rt=this.map.transform;return[rt.width,rt.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(rt){return this.map.setZoom(rt)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(rt){this.map.setCenter(rt)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(rt){this.map.setBearing(rt)}},{key:"zoomIn",value:function(rt,ft){this.map.zoomIn(rt,ft)}},{key:"zoomOut",value:function(rt,ft){this.map.zoomOut(rt,ft)}},{key:"setPitch",value:function(rt){return this.map.setPitch(rt)}},{key:"panTo",value:function(rt){this.map.panTo(rt)}},{key:"panBy",value:function(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy([rt,ft])}},{key:"fitBounds",value:function(rt,ft){this.map.fitBounds(rt,ft)}},{key:"setMaxZoom",value:function(rt){this.map.setMaxZoom(rt)}},{key:"setMinZoom",value:function(rt){this.map.setMinZoom(rt)}},{key:"setMapStatus",value:function(rt){rt.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),rt.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),rt.dragEnable===!1&&this.map.dragPan.disable(),rt.dragEnable===!0&&this.map.dragPan.enable(),rt.rotateEnable===!1&&this.map.dragRotate.disable(),rt.dragEnable===!0&&this.map.dragRotate.enable(),rt.keyboardEnable===!1&&this.map.keyboard.disable(),rt.keyboardEnable===!0&&this.map.keyboard.enable(),rt.zoomEnable===!1&&this.map.scrollZoom.disable(),rt.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(rt,ft){this.map.flyTo({zoom:rt,center:ft})}},{key:"setMapStyle",value:function(rt){this.map.setStyle(this.getMapStyleValue(rt))}},{key:"meterToCoord",value:function(rt,ft){return 1}},{key:"pixelToLngLat",value:function(rt){return this.map.unproject(rt)}},{key:"lngLatToPixel",value:function(rt){return this.map.project(rt)}},{key:"containerToLngLat",value:function(rt){return this.map.unproject(rt)}},{key:"lngLatToContainer",value:function(rt){return this.map.project(rt)}},{key:"getMapStyle",value:function(){try{var rt,ft=(rt=this.map.getStyle().sprite)!==null&&rt!==void 0?rt:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(ft)?ft==null?void 0:ft.replace(/\/\w+$/,"").replace(/sprites/,"styles"):ft}catch(bt){return""}}},{key:"getMapStyleConfig",value:function(){return Et}},{key:"getMapStyleValue",value:function(rt){var ft;return(ft=this.getMapStyleConfig()[rt])!==null&&ft!==void 0?ft:rt}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(rt){for(var ft,bt=arguments.length,Gt=new Array(bt>1?bt-1:0),lr=1;lr<bt;lr++)Gt[lr-1]=arguments[lr];(ft=this.eventEmitter).emit.apply(ft,[rt].concat(Gt))}},{key:"once",value:function(rt){for(var ft,bt=arguments.length,Gt=new Array(bt>1?bt-1:0),lr=1;lr<bt;lr++)Gt[lr-1]=arguments[lr];(ft=this.eventEmitter).once.apply(ft,[rt].concat(Gt))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(rt){var ft=this.map.getCanvas(),bt=rt==="jpg"?ft==null?void 0:ft.toDataURL("image/jpeg"):ft==null?void 0:ft.toDataURL("image/png");return bt}},{key:"onCameraChanged",value:function(rt){this.cameraChangedCallback=rt}},{key:"creatMapContainer",value:function(rt){var ft=rt;return typeof rt=="string"&&(ft=document.getElementById(rt)),ft}},{key:"updateView",value:function(rt){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:rt.bearing,center:rt.center,viewportHeight:rt.viewportHeight,pitch:rt.pitch,viewportWidth:rt.viewportWidth,zoom:rt.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var rt=this.config.offsetCoordinate,ft=rt===void 0?!0:rt;this.viewport.getZoom()>hn&&ft?this.coordinateSystemService.setCoordinateSystem(V.lo.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(V.lo.LNGLAT)}}]),We}(),vt=(0,Y.Z)(at.prototype,"config",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=(0,Y.Z)(at.prototype,"configService",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=(0,Y.Z)(at.prototype,"coordinateSystemService",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gr=(0,Y.Z)(at.prototype,"eventEmitter",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at))||nt),vr=_(97685),dn=_(98333);function tn(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function un(We,G){var rt=dn.fF([],G,We);return dn.bA(rt,rt,1/rt[3]),rt}function yn(We,G){var rt=We%G;return rt<0?G+rt:rt}function Vt(We,G,rt){return rt*G+(1-rt)*We}var dr=_(31437);function wt(We,G){if(!We)throw new Error(G||"viewport-mercator-project: assertion failed.")}var He=Math.PI,wr=He/4,Ne=He/180,Xr=180/He,Er=512,Ue=4003e4,In=1.5;function an(We){return Math.pow(2,We)}function Qr(We){return Math.log2(We)}function Dn(We,G){var rt=(0,vr.Z)(We,2),ft=rt[0],bt=rt[1];wt(Number.isFinite(ft)&&Number.isFinite(G)),wt(Number.isFinite(bt)&&bt>=-90&&bt<=90,"invalid latitude"),G*=Er;var Gt=ft*Ne,lr=bt*Ne,Ht=G*(Gt+He)/(2*He),Cr=G*(He-Math.log(Math.tan(wr+lr*.5)))/(2*He);return[Ht,Cr]}function On(We,G){var rt=(0,vr.Z)(We,2),ft=rt[0],bt=rt[1];G*=Er;var Gt=ft/G*(2*He)-He,lr=2*(Math.atan(Math.exp(He-bt/G*(2*He)))-wr);return[Gt*Xr,lr*Xr]}function ri(We){var G=We.latitude;assert(Number.isFinite(G));var rt=Math.cos(G*Ne);return Qr(Ue*rt)-9}function zt(We){var G=We.latitude,rt=We.longitude,ft=We.zoom,bt=We.scale,Gt=We.highPrecision,lr=Gt===void 0?!1:Gt;bt=bt!==void 0?bt:an(ft),wt(Number.isFinite(G)&&Number.isFinite(rt)&&Number.isFinite(bt));var Ht={},Cr=Er*bt,hr=Math.cos(G*Ne),Dr=Cr/360,Rn=Dr/hr,on=Cr/Ue/hr;if(Ht.pixelsPerMeter=[on,-on,on],Ht.metersPerPixel=[1/on,-1/on,1/on],Ht.pixelsPerDegree=[Dr,-Rn,on],Ht.degreesPerPixel=[1/Dr,-1/Rn,1/on],lr){var fi=Ne*Math.tan(G*Ne)/hr,Mi=Dr*fi/2,di=Cr/Ue*fi,mn=di/Rn*on;Ht.pixelsPerDegree2=[0,-Mi,di],Ht.pixelsPerMeter2=[mn,0,mn]}return Ht}function cr(We,G){var rt=_slicedToArray(We,3),ft=rt[0],bt=rt[1],Gt=rt[2],lr=_slicedToArray(G,3),Ht=lr[0],Cr=lr[1],hr=lr[2],Dr=1,Rn=zt({longitude:ft,latitude:bt,scale:Dr,highPrecision:!0}),on=Rn.pixelsPerMeter,fi=Rn.pixelsPerMeter2,Mi=Dn(We,Dr);Mi[0]+=Ht*(on[0]+fi[0]*Cr),Mi[1]+=Cr*(on[1]+fi[1]*Cr);var di=On(Mi,Dr),mn=(Gt||0)+(hr||0);return Number.isFinite(Gt)||Number.isFinite(hr)?[di[0],di[1],mn]:di}function Zr(We){var G=We.height,rt=We.pitch,ft=We.bearing,bt=We.altitude,Gt=We.center,lr=Gt===void 0?null:Gt,Ht=We.flipY,Cr=Ht===void 0?!1:Ht,hr=tn();return Ve.translate(hr,hr,[0,0,-bt]),Ve.scale(hr,hr,[1,1,1/G]),Ve.rotateX(hr,hr,-rt*Ne),Ve.rotateZ(hr,hr,ft*Ne),Cr&&Ve.scale(hr,hr,[1,-1,1]),lr&&Ve.translate(hr,hr,Re.negate([],lr)),hr}function Kr(We){var G=We.width,rt=We.height,ft=We.altitude,bt=ft===void 0?In:ft,Gt=We.pitch,lr=Gt===void 0?0:Gt,Ht=We.nearZMultiplier,Cr=Ht===void 0?1:Ht,hr=We.farZMultiplier,Dr=hr===void 0?1:hr,Rn=lr*Ne,on=Math.atan(.5/bt),fi=Math.sin(on)*bt/Math.sin(Math.PI/2-Rn-on),Mi=Math.cos(Math.PI/2-Rn)*fi+bt;return{fov:2*Math.atan(rt/2/bt),aspect:G/rt,focalDistance:bt,near:Cr,far:Mi*Dr}}function en(We){var G=We.width,rt=We.height,ft=We.pitch,bt=We.altitude,Gt=We.nearZMultiplier,lr=We.farZMultiplier,Ht=Kr({width:G,height:rt,altitude:bt,pitch:ft,nearZMultiplier:Gt,farZMultiplier:lr}),Cr=Ht.fov,hr=Ht.aspect,Dr=Ht.near,Rn=Ht.far,on=Ve.perspective([],Cr,hr,Dr,Rn);return on}function Wn(We,G){var rt=(0,vr.Z)(We,3),ft=rt[0],bt=rt[1],Gt=rt[2],lr=Gt===void 0?0:Gt;return wt(Number.isFinite(ft)&&Number.isFinite(bt)&&Number.isFinite(lr)),un(G,[ft,bt,lr,1])}function De(We,G){var rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ft=(0,vr.Z)(We,3),bt=ft[0],Gt=ft[1],lr=ft[2];if(wt(Number.isFinite(bt)&&Number.isFinite(Gt),"invalid pixel coordinate"),Number.isFinite(lr)){var Ht=un(G,[bt,Gt,lr,1]);return Ht}var Cr=un(G,[bt,Gt,0,1]),hr=un(G,[bt,Gt,1,1]),Dr=Cr[2],Rn=hr[2],on=Dr===Rn?0:((rt||0)-Dr)/(Rn-Dr);return dr.t7([],Cr,hr,on)}var X=tn(),se=function(){function We(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},rt=G.width,ft=G.height,bt=G.viewMatrix,Gt=bt===void 0?X:bt,lr=G.projectionMatrix,Ht=lr===void 0?X:lr;(0,D.Z)(this,We),this.width=rt||1,this.height=ft||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=Gt,this.projectionMatrix=Ht;var Cr=tn();Ve.multiply(Cr,Cr,this.projectionMatrix),Ve.multiply(Cr,Cr,this.viewMatrix),this.viewProjectionMatrix=Cr;var hr=tn();Ve.scale(hr,hr,[this.width/2,-this.height/2,1]),Ve.translate(hr,hr,[1,-1,0]),Ve.multiply(hr,hr,this.viewProjectionMatrix);var Dr=Ve.invert(tn(),hr);if(!Dr)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=hr,this.pixelUnprojectionMatrix=Dr,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,N.Z)(We,[{key:"equals",value:function(rt){return rt instanceof We?rt.width===this.width&&rt.height===this.height&&Ve.equals(rt.projectionMatrix,this.projectionMatrix)&&Ve.equals(rt.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(rt){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},bt=ft.topLeft,Gt=bt===void 0?!0:bt,lr=this.projectPosition(rt),Ht=Wn(lr,this.pixelProjectionMatrix),Cr=(0,vr.Z)(Ht,2),hr=Cr[0],Dr=Cr[1],Rn=Gt?Dr:this.height-Dr;return rt.length===2?[hr,Rn]:[hr,Rn,Ht[2]]}},{key:"unproject",value:function(rt){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},bt=ft.topLeft,Gt=bt===void 0?!0:bt,lr=ft.targetZ,Ht=(0,vr.Z)(rt,3),Cr=Ht[0],hr=Ht[1],Dr=Ht[2],Rn=Gt?hr:this.height-hr,on=lr&&lr*this.pixelsPerMeter,fi=De([Cr,Rn,Dr],this.pixelUnprojectionMatrix,on),Mi=this.unprojectPosition(fi),di=(0,vr.Z)(Mi,3),mn=di[0],Zn=di[1],sa=di[2];return Number.isFinite(Dr)?[mn,Zn,sa]:Number.isFinite(lr)?[mn,Zn,lr]:[mn,Zn]}},{key:"projectPosition",value:function(rt){var ft=this.projectFlat(rt),bt=(0,vr.Z)(ft,2),Gt=bt[0],lr=bt[1],Ht=(rt[2]||0)*this.pixelsPerMeter;return[Gt,lr,Ht]}},{key:"unprojectPosition",value:function(rt){var ft=this.unprojectFlat(rt),bt=(0,vr.Z)(ft,2),Gt=bt[0],lr=bt[1],Ht=(rt[2]||0)/this.pixelsPerMeter;return[Gt,lr,Ht]}},{key:"projectFlat",value:function(rt){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return rt}},{key:"unprojectFlat",value:function(rt){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return rt}}]),We}();function Be(We){var G=We.width,rt=We.height,ft=We.bounds,bt=We.minExtent,Gt=bt===void 0?0:bt,lr=We.maxZoom,Ht=lr===void 0?24:lr,Cr=We.padding,hr=Cr===void 0?0:Cr,Dr=We.offset,Rn=Dr===void 0?[0,0]:Dr,on=(0,vr.Z)(ft,2),fi=(0,vr.Z)(on[0],2),Mi=fi[0],di=fi[1],mn=(0,vr.Z)(on[1],2),Zn=mn[0],sa=mn[1];if(Number.isFinite(hr)){var qi=hr;hr={top:qi,bottom:qi,left:qi,right:qi}}else wt(Number.isFinite(hr.top)&&Number.isFinite(hr.bottom)&&Number.isFinite(hr.left)&&Number.isFinite(hr.right));var Sa=new Ye({width:G,height:rt,longitude:0,latitude:0,zoom:0}),Zi=Sa.project([Mi,sa]),Oi=Sa.project([Zn,di]),jr=[Math.max(Math.abs(Oi[0]-Zi[0]),Gt),Math.max(Math.abs(Oi[1]-Zi[1]),Gt)],Fi=[G-hr.left-hr.right-Math.abs(Rn[0])*2,rt-hr.top-hr.bottom-Math.abs(Rn[1])*2];wt(Fi[0]>0&&Fi[1]>0);var Ls=Fi[0]/jr[0],Ta=Fi[1]/jr[1],Aa=(hr.right-hr.left)/2/Ls,go=(hr.bottom-hr.top)/2/Ta,os=[(Oi[0]+Zi[0])/2+Aa,(Oi[1]+Zi[1])/2+go],ka=Sa.unproject(os),Ao=Sa.zoom+Math.log2(Math.abs(Math.min(Ls,Ta)));return{longitude:ka[0],latitude:ka[1],zoom:Math.min(Ao,Ht)}}var Ye=function(We){(0,h.Z)(G,We);function G(){var rt,ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},bt=ft.width,Gt=ft.height,lr=ft.latitude,Ht=lr===void 0?0:lr,Cr=ft.longitude,hr=Cr===void 0?0:Cr,Dr=ft.zoom,Rn=Dr===void 0?0:Dr,on=ft.pitch,fi=on===void 0?0:on,Mi=ft.bearing,di=Mi===void 0?0:Mi,mn=ft.altitude,Zn=mn===void 0?1.5:mn,sa=ft.nearZMultiplier,qi=ft.farZMultiplier;(0,D.Z)(this,G),bt=bt||1,Gt=Gt||1;var Sa=an(Rn);Zn=Math.max(.75,Zn);var Zi=Dn([hr,Ht],Sa);Zi[2]=0;var Oi=en({width:bt,height:Gt,pitch:fi,bearing:di,altitude:Zn,nearZMultiplier:sa||1/Gt,farZMultiplier:qi||1.01}),jr=Zr({height:Gt,center:Zi,pitch:fi,bearing:di,altitude:Zn,flipY:!0});return rt=(0,O.Z)(this,(0,C.Z)(G).call(this,{width:bt,height:Gt,viewMatrix:jr,projectionMatrix:Oi})),rt.latitude=Ht,rt.longitude=hr,rt.zoom=Rn,rt.pitch=fi,rt.bearing=di,rt.altitude=Zn,rt.scale=Sa,rt.center=Zi,rt.pixelsPerMeter=zt((0,H.Z)((0,H.Z)(rt))).pixelsPerMeter[2],Object.freeze((0,H.Z)((0,H.Z)(rt))),rt}return(0,N.Z)(G,[{key:"projectFlat",value:function(ft){var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Dn(ft,bt)}},{key:"unprojectFlat",value:function(ft){var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return On(ft,bt)}},{key:"getMapCenterByLngLatPosition",value:function(ft){var bt=ft.lngLat,Gt=ft.pos,lr=De(Gt,this.pixelUnprojectionMatrix),Ht=Dn(bt,this.scale),Cr=dr.IH([],Ht,dr.tk([],lr)),hr=dr.IH([],this.center,Cr);return On(hr,this.scale)}},{key:"getLocationAtPoint",value:function(ft){var bt=ft.lngLat,Gt=ft.pos;return this.getMapCenterByLngLatPosition({lngLat:bt,pos:Gt})}},{key:"fitBounds",value:function(ft){var bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Gt=this.width,lr=this.height,Ht=Be(Object.assign({width:Gt,height:lr,bounds:ft},bt)),Cr=Ht.longitude,hr=Ht.latitude,Dr=Ht.zoom;return new G({width:Gt,height:lr,longitude:Cr,latitude:hr,zoom:Dr})}}]),G}(se),ct=function(){function We(){(0,D.Z)(this,We)}return(0,N.Z)(We,[{key:"syncWithMapCamera",value:function(rt){var ft=rt.center,bt=rt.zoom,Gt=rt.pitch,lr=rt.bearing,Ht=rt.viewportHeight,Cr=rt.viewportWidth;this.viewport=new Ye({width:Cr,height:Ht,longitude:ft&&ft[0],latitude:ft&&ft[1],zoom:bt,pitch:Gt,bearing:lr})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(rt,ft){return this.viewport.projectFlat(rt,ft)}}]),We}(),sr=["id","attributionControl","style","token","rotation","mapInstance"],ar,or;function Wt(We){var G=oe();return function(){var ft=(0,C.Z)(We),bt;if(G){var Gt=(0,C.Z)(this).constructor;bt=Reflect.construct(ft,arguments,Gt)}else bt=ft.apply(this,arguments);return(0,O.Z)(this,bt)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(We){return!1}}function ie(We,G){var rt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ft=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(rt||ft)&&(G||(G=document),!!G)){var bt=G.head||G.getElementsByTagName("head")[0];if(!bt){bt=G.createElement("head");var Gt=G.body||G.getElementsByTagName("body")[0];Gt?Gt.parentNode.insertBefore(bt,Gt):G.documentElement.appendChild(bt)}var lr=G.createElement("style");return lr.type="text/css",lr.styleSheet?lr.styleSheet.cssText=We:lr.appendChild(G.createTextNode(We)),bt.appendChild(lr),lr}}ie(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=ee();var be=0,ke="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg",qe=(ar=(0,Ae.b2)(),ar(or=function(We){(0,h.Z)(rt,We);var G=Wt(rt);function rt(){var ft;(0,D.Z)(this,rt);for(var bt=arguments.length,Gt=new Array(bt),lr=0;lr<bt;lr++)Gt[lr]=arguments[lr];return ft=G.call.apply(G,[this].concat(Gt)),(0,ve.Z)((0,H.Z)(ft),"version","MAPBOX"),ft}return(0,N.Z)(rt,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(bt){var Gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},lr=this.lngLatToMercator(bt,0),Ht=lr.x,Cr=lr.y;return[Ht-Gt.x,Cr-Gt.y]}},{key:"lngLatToMercator",value:function(bt,Gt){var lr=window.mapboxgl.MercatorCoordinate.fromLngLat(bt,Gt),Ht=lr.x,Cr=Ht===void 0?0:Ht,hr=lr.y,Dr=hr===void 0?0:hr,Rn=lr.z,on=Rn===void 0?0:Rn;return{x:Cr,y:Dr,z:on}}},{key:"getModelMatrix",value:function(bt,Gt,lr){var Ht=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],Cr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},hr=window.mapboxgl.MercatorCoordinate.fromLngLat(bt,Gt),Dr=hr.meterInMercatorCoordinateUnits(),Rn=Ve.create();return Ve.translate(Rn,Rn,Re.fromValues(hr.x-Cr.x,hr.y-Cr.y,hr.z||0-Cr.z)),Ve.scale(Rn,Rn,Re.fromValues(Dr*Ht[0],-Dr*Ht[1],Dr*Ht[2])),Ve.rotateX(Rn,Rn,lr[0]),Ve.rotateY(Rn,Rn,lr[1]),Ve.rotateZ(Rn,Rn,lr[2]),Rn}},{key:"init",value:function(){var ft=(0,J.Z)(ye().mark(function Gt(){var lr=this,Ht,Cr,hr,Dr,Rn,on,fi,Mi,di,mn,Zn,sa,qi;return ye().wrap(function(Zi){for(;;)switch(Zi.prev=Zi.next){case 0:Ht=this.config,Cr=Ht.id,hr=Cr===void 0?"map":Cr,Dr=Ht.attributionControl,Rn=Dr===void 0?!1:Dr,on=Ht.style,fi=on===void 0?"light":on,Mi=Ht.token,di=Mi===void 0?ke:Mi,mn=Ht.rotation,Zn=mn===void 0?0:mn,sa=Ht.mapInstance,qi=(0,Z.Z)(Ht,sr),this.viewport=new ct,!sa&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),di===ke&&fi!=="blank"&&!window.mapboxgl.accessToken&&!sa&&console.warn(this.configService.getSceneWarninfo("MapToken")),!sa&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=di),sa?(this.map=sa,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(hr),this.map=new window.mapboxgl.Map((0,P.Z)({container:this.$mapContainer,style:this.getMapStyleValue(fi),attributionControl:Rn,bearing:Zn},qi))),this.map.on("load",function(){lr.handleCameraChanged()}),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Zi.stop()}},Gt,this)}));function bt(){return ft.apply(this,arguments)}return bt}()},{key:"destroy",value:function(){var bt;(bt=this.$mapContainer)===null||bt===void 0||(bt=bt.parentNode)===null||bt===void 0||bt.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(bt){for(var Gt,lr=arguments.length,Ht=new Array(lr>1?lr-1:0),Cr=1;Cr<lr;Cr++)Ht[Cr-1]=arguments[Cr];(Gt=this.eventEmitter).emit.apply(Gt,[bt].concat(Ht))}},{key:"once",value:function(bt){for(var Gt,lr=arguments.length,Ht=new Array(lr>1?lr-1:0),Cr=1;Cr<lr;Cr++)Ht[Cr-1]=arguments[Cr];(Gt=this.eventEmitter).once.apply(Gt,[bt].concat(Ht))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(bt,Gt){var lr=new(ee()).LngLat(bt[0],bt[1]),Ht=new(ee()).LngLat(Gt[0],Gt[1]),Cr=lr.distanceTo(Ht),hr=ee().MercatorCoordinate.fromLngLat({lng:bt[0],lat:bt[1]}),Dr=ee().MercatorCoordinate.fromLngLat({lng:Gt[0],lat:Gt[1]}),Rn=hr.x,on=hr.y,fi=Dr.x,Mi=Dr.y,di=Math.sqrt(Math.pow(Rn-fi,2)+Math.pow(on-Mi,2))*4194304*2;return di/Cr}},{key:"exportMap",value:function(bt){var Gt=this.map.getCanvas(),lr=bt==="jpg"?Gt==null?void 0:Gt.toDataURL("image/jpeg"):Gt==null?void 0:Gt.toDataURL("image/png");return lr}},{key:"creatMapContainer",value:function(bt){var Gt=bt;typeof bt=="string"&&(Gt=document.getElementById(bt));var lr=document.createElement("div");return lr.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,lr.id="l7_mapbox_div"+be++,Gt.appendChild(lr),lr}}]),rt}(Wr))||or);function mt(We){var G=kt();return function(){var ft=(0,C.Z)(We),bt;if(G){var Gt=(0,C.Z)(this).constructor;bt=Reflect.construct(ft,arguments,Gt)}else bt=ft.apply(this,arguments);return(0,O.Z)(this,bt)}}function kt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(We){return!1}}function $e(We,G){var rt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ft=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(rt||ft)&&(G||(G=document),!!G)){var bt=G.head||G.getElementsByTagName("head")[0];if(!bt){bt=G.createElement("head");var Gt=G.body||G.getElementsByTagName("body")[0];Gt?Gt.parentNode.insertBefore(bt,Gt):G.documentElement.appendChild(bt)}var lr=G.createElement("style");return lr.type="text/css",lr.styleSheet?lr.styleSheet.cssText=We:lr.appendChild(G.createTextNode(We)),bt.appendChild(lr),lr}}$e(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var Ge=function(We){(0,h.Z)(rt,We);var G=mt(rt);function rt(){return(0,D.Z)(this,rt),G.apply(this,arguments)}return(0,N.Z)(rt,[{key:"getServiceConstructor",value:function(){return qe}}]),rt}(U)},57059:function(Ze,E,_){"use strict";_.d(E,{SO:function(){return D},z6:function(){return Jo},sN:function(){return m},oX:function(){return S},a5:function(){return N},SA:function(){return Z},nx:function(){return wl},Z:function(){return ds},rQ:function(){return we},bV:function(){return Pe},zi:function(){return nt},ds:function(){return us},oO:function(){return kn},SI:function(){return Pf},Rx:function(){return vc},W0:function(){return ze},LS:function(){return nn},Z6:function(){return gr},We:function(){return ss},Co:function(){return ue},hj:function(){return Wr},Cl:function(){return At},Oc:function(){return dn},M4:function(){return hn},NJ:function(){return vr},ks:function(){return ae},Ol:function(){return Ju},fj:function(){return Vt},Yu:function(){return me},ZB:function(){return un},gJ:function(){return je},z0:function(){return Ou},jG:function(){return Xc},M8:function(){return Nl},fg:function(){return Ca},if:function(){return Ho},vP:function(){return cf},rU:function(){return Gt},LF:function(){return Ve},Fv:function(){return Sl},yA:function(){return Hi},yR:function(){return R},CI:function(){return Tt}});var D={};_.r(D),_.d(D,{DPR:function(){return Ls},addClass:function(){return fi},addStyle:function(){return Ta},appendElementType:function(){return Oa},clearChildren:function(){return za},create:function(){return Rn},css2Style:function(){return os},empty:function(){return qi},findParentElement:function(){return Za},getClass:function(){return sa},getContainer:function(){return Ht},getDiffRect:function(){return ka},getStyleList:function(){return Aa},getViewPortScale:function(){return Fi},hasClass:function(){return di},printCanvas:function(){return jr},remove:function(){return on},removeClass:function(){return Mi},removeStyle:function(){return go},setChecked:function(){return Ao},setClass:function(){return mn},setTransform:function(){return Zi},setUnDraggable:function(){return Ja},splitWords:function(){return hr},toggleClass:function(){return Zn},triggerResize:function(){return Oi},trim:function(){return Cr}});var N={};_.r(N),_.d(N,{getColumn:function(){return gc},getSatByColumn:function(){return Al},max:function(){return Zu},mean:function(){return mc},min:function(){return Mu},mode:function(){return Zl},statMap:function(){return bu},sum:function(){return ju}});var h=_(1413),O=_(43144),C=_(15671),P=_(60136),F=_(82963),Y=_(61120),V=_(89611);function Q(M){try{return Function.toString.call(M).indexOf("[native code]")!==-1}catch(z){return typeof M=="function"}}var k=_(78814);function K(M,z,j){if((0,k.Z)())return Reflect.construct.apply(null,arguments);var ne=[null];ne.push.apply(ne,z);var ce=new(M.bind.apply(M,ne));return j&&(0,V.Z)(ce,j.prototype),ce}function U(M){var z=typeof Map=="function"?new Map:void 0;return U=function(ne){if(ne===null||!Q(ne))return ne;if(typeof ne!="function")throw new TypeError("Super expression must either be null or a function");if(typeof z!="undefined"){if(z.has(ne))return z.get(ne);z.set(ne,ce)}function ce(){return K(ne,arguments,(0,Y.Z)(this).constructor)}return ce.prototype=Object.create(ne.prototype,{constructor:{value:ce,enumerable:!1,writable:!0,configurable:!0}}),(0,V.Z)(ce,ne)},U(M)}var Z={REGISTERED_PROTOCOLS:{}};function J(M){var z=H();return function(){var ne=(0,Y.Z)(M),ce;if(z){var le=(0,Y.Z)(this).constructor;ce=Reflect.construct(ne,arguments,le)}else ce=ne.apply(this,arguments);return(0,F.Z)(this,ce)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(M){return!1}}var ve=function(z){return Z.REGISTERED_PROTOCOLS[z.substring(0,z.indexOf("://"))]},Te=function(M){(0,P.Z)(j,M);var z=J(j);function j(ne,ce,le,lt){var it;return(0,C.Z)(this,j),it=z.call(this,"AJAXError: ".concat(ce," (").concat(ne,"): ").concat(le)),it.status=ne,it.statusText=ce,it.url=le,it.body=lt,it}return(0,O.Z)(j)}(U(Error));function ye(M,z){var j=new XMLHttpRequest,ne=Array.isArray(M.url)?M.url[0]:M.url;j.open(M.method||"GET",ne,!0),M.type==="arrayBuffer"&&(j.responseType="arraybuffer");for(var ce in M.headers)M.headers.hasOwnProperty(ce)&&j.setRequestHeader(ce,M.headers[ce]);return M.type==="json"&&(j.responseType="text",j.setRequestHeader("Accept","application/json")),j.withCredentials=M.credentials==="include",j.onerror=function(){z(new Error(j.statusText))},j.onload=function(){if((j.status>=200&&j.status<300||j.status===0)&&j.response!==null){var le=j.response;if(M.type==="json")try{le=JSON.parse(j.response)}catch(it){return z(it)}z(null,le,j.getResponseHeader("Cache-Control"),j.getResponseHeader("Expires"),j)}else{var lt=new Blob([j.response],{type:j.getResponseHeader("Content-Type")});z(new Te(j.status,j.statusText,ne.toString(),lt))}},j.cancel=j.abort,j.send(M.body),j}function Ve(M){return new Promise(function(z,j){ye(M,function(ne,ce,le,lt,it){ne?j({err:ne,data:null,xhr:it}):z({err:null,data:ce,cacheControl:le,expires:lt,xhr:it})})})}function Re(M,z){return ye(M,z)}var Ae=function(z,j){var ne=ve(z.url)||Re;return ne((0,h.Z)((0,h.Z)({},z),{},{type:"json"}),j)},ae=function(z,j){var ne=ve(z.url)||Re;return ne((0,h.Z)((0,h.Z)({},z),{},{type:"arrayBuffer"}),j)},ee=function(z,j){return Re(_objectSpread(_objectSpread({},z),{},{method:"POST"}),j)},me=function(z,j){return Re((0,h.Z)((0,h.Z)({},z),{},{method:"GET"}),j)};function ge(M){var z=window.document.createElement("a");return z.href=M,z.protocol===window.document.location.protocol&&z.host===window.document.location.host}var fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Et(M,z){var j=new window.Image,ne=window.URL||window.webkitURL;j.crossOrigin="anonymous",j.onload=function(){z(null,j),ne.revokeObjectURL(j.src),j.onload=null,window.requestAnimationFrame(function(){j.src=fe})},j.onerror=function(){return z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new Blob([new Uint8Array(M)],{type:"image/png"});j.src=M.byteLength?ne.createObjectURL(ce):fe}function xe(M,z){var j=new Blob([new Uint8Array(M)],{type:"image/png"});createImageBitmap(j).then(function(ne){z(null,ne)}).catch(function(ne){z(new Error("Could not load image because of ".concat(ne.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var je=function(z,j,ne){var ce=function(lt,it){if(lt)j(lt);else if(it){var Yt=typeof createImageBitmap=="function",ht=ne?ne(it):it;Yt?xe(ht,j):Et(ht,j)}};return z.type==="json"?Ae(z,ce):ae(z,ce)},ue=function(z,j){var ne=typeof createImageBitmap=="function";ne?xe(z,j):Et(z,j)},Pe=function(M){return M.CENTER="center",M.TOP="top",M["TOP-LEFT"]="top-left",M["TOP-RIGHT"]="top-right",M.BOTTOM="bottom",M["BOTTOM-LEFT"]="bottom-left",M["BOTTOM-RIGHT"]="bottom-right",M.LEFT="left",M.RIGHT="right",M}({}),we={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function nt(M,z,j){var ne=M.classList;for(var ce in we)we.hasOwnProperty(ce)&&ne.remove("l7-".concat(j,"-anchor-").concat(ce));ne.add("l7-".concat(j,"-anchor-").concat(z))}var at=_(37620);function vt(M){return typeof M=="string"?!!d3.color(M):!1}function Tt(M){var z=at.ZP(M),j=[0,0,0,0];return z!=null&&(j[0]=z.r/255,j[1]=z.g/255,j[2]=z.b/255,j[3]=z.opacity),j}function ze(M){var z=M&&M[0],j=M&&M[1],ne=M&&M[2],ce=z+j*256+ne*65536-1;return ce}function gr(M){return[M+1&255,M+1>>8&255,M+1>>8>>8&255]}function At(M){var z=window.document.createElement("canvas"),j=z.getContext("2d");z.width=256,z.height=1;for(var ne=null,ce=j.createLinearGradient(0,0,256,1),le=M.positions[0],lt=M.positions[M.positions.length-1],it=0;it<M.colors.length;++it){var Yt=(M.positions[it]-le)/(lt-le);ce.addColorStop(Yt,M.colors[it])}return j.fillStyle=ce,j.fillRect(0,0,256,1),ne=new Uint8ClampedArray(j.getImageData(0,0,256,1).data),z=null,j=null,{data:ne,width:256,height:1}}function hn(M,z){var j=window.document.createElement("canvas"),ne=j.getContext("2d");j.width=256,j.height=1,console.log("colorRamp",j);for(var ce=ne.createLinearGradient(0,0,256,1),le=z[1]-z[0],lt=0;lt<M.colors.length;++lt){var it=Math.max((M.positions[lt]-z[0])/le,0);ce.addColorStop(it,M.colors[lt])}ne.fillStyle=ce,ne.fillRect(0,0,256,1);var Yt=ne.getImageData(0,0,256,1).data,ht=tn(ne,Yt);return j=null,ne=null,ht}function Wr(M){var z=window.document.createElement("canvas"),j=z.getContext("2d");z.width=256,z.height=1;var ne=j.createImageData(256,1);return ne.data.fill(0),M.positions.forEach(function(ce,le){var lt=Tt(M.colors[le]);ne.data[ce*4+0]=lt[0]*255,ne.data[ce*4+1]=lt[1]*255,ne.data[ce*4+2]=lt[2]*255,ne.data[ce*4+3]=lt[3]*255}),z=null,j=null,ne}function vr(M){var z=window.document.createElement("canvas"),j=z.getContext("2d");j.globalAlpha=1,z.width=256,z.height=1;for(var ne=256/M.colors.length,ce=0;ce<M.colors.length;ce++)j.beginPath(),j.lineWidth=2,j.strokeStyle=M.colors[ce],j.moveTo(ce*ne,0),j.lineTo((ce+1)*ne,0),j.stroke();var le=j.getImageData(0,0,256,1).data,lt=tn(j,le);return z=null,j=null,lt}function dn(M,z){var j=window.document.createElement("canvas"),ne=j.getContext("2d");ne.globalAlpha=1,j.width=256,j.height=1;var ce=z[1]-z[0];M.positions.length-M.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var le=0;le<M.colors.length;le++)ne.beginPath(),ne.lineWidth=2,ne.strokeStyle=M.colors[le],ne.moveTo((M.positions[le]-z[0])/ce*255,0),ne.lineTo((M.positions[le+1]-z[0])/ce*255,0),ne.stroke();var lt=ne.getImageData(0,0,256,1).data,it=tn(ne,lt);return j=null,ne=null,it}function tn(M,z){for(var j=M.createImageData(256,1),ne=0;ne<j.data.length;ne+=4)j.data[ne+0]=z[ne+0],j.data[ne+1]=z[ne+1],j.data[ne+2]=z[ne+2],j.data[ne+3]=z[ne+3];return j}function un(M){switch(M.type){case"cat":return[0,255];default:return[0,1]}}var yn={BACK:1029,FRONT:1028};function Vt(M){switch(M){case"GAODE1.x":return yn.BACK;case"GAODE2.x":return yn.BACK;case"MAPBOX":return yn.FRONT;case"SIMPLE":return yn.FRONT;case"GLOBEL":return yn.BACK;case"DEBAULT":return yn.FRONT;default:return yn.FRONT}}var dr=_(74902),wt=_(97685),He=_(74691),wr=_.n(He),Ne=_(50361),Xr=_.n(Ne),Er=_(23279),Ue=_.n(Er),In=_(27361),an=_.n(In),Qr=_(51584),Dn=_.n(Qr),On=_(18446),ri=_.n(On),zt=_(14293),cr=_.n(zt),Zr=_(81763),Kr=_.n(Zr),en=_(68630),Wn=_.n(en),De=_(47037),X=_.n(De),se=_(36719),Be=_.n(se),Ye=_(82492),ct=_.n(Ye),sr=_(30236),ar=_.n(sr),or=_(97019),Wt=_.n(or),oe=_(23493),ie=_.n(oe),be=_(44908),ke=_.n(be),qe=_(11700),mt=_.n(qe),kt=_(23560),$e=_.n(kt),Ge=_(13218),We=_.n(Ge),G=_(52353),rt=_.n(G),ft=_(68929),bt=_.n(ft),Gt={isNil:cr(),merge:ct(),throttle:ie(),isString:X(),debounce:Ue(),pull:Wt(),isTypedArray:Be(),isPlainObject:Wn(),isNumber:Kr(),isBoolean:Dn(),isEqual:ri(),cloneDeep:Xr(),uniq:ke(),clamp:wr(),upperFirst:mt(),get:an(),mergeWith:ar(),isFunction:$e(),isObject:We(),isUndefined:rt(),camelCase:bt()},lr=Gt.pull;function Ht(M){var z=M;return typeof M=="string"&&(z=window.document.getElementById(M)),z}function Cr(M){return M.trim?M.trim():M.replace(/^\s+|\s+$/g,"")}function hr(M){return Cr(M).split(/\s+/)}function Dr(M){var z,j=(z=document)===null||z===void 0||(z=z.documentElement)===null||z===void 0?void 0:z.style;if(!j)return M[0];for(var ne in M)if(M[ne]&&M[ne]in j)return M[ne];return M[0]}function Rn(M,z,j){var ne=window.document.createElement(M);return z&&(ne.className=z||""),j&&j.appendChild(ne),ne}function on(M){var z=M.parentNode;z&&z.removeChild(M)}function fi(M,z){if(M.classList!==void 0)for(var j=hr(z),ne=0,ce=j.length;ne<ce;ne++)M.classList.add(j[ne]);else if(!di(M,z)){var le=sa(M);mn(M,(le?le+" ":"")+z)}}function Mi(M,z){if(M.classList!==void 0){var j=hr(z);j.forEach(function(ne){M.classList.remove(ne)})}else mn(M,Cr((" "+sa(M)+" ").replace(" "+z+" "," ")))}function di(M,z){if(M.classList!==void 0)return M.classList.contains(z);var j=sa(M);return j.length>0&&new RegExp("(^|\\s)"+z+"(\\s|$)").test(j)}function mn(M,z){M instanceof HTMLElement?M.className=z:M.className.baseVal=z}function Zn(M,z,j){j===void 0?di(M,z)?Mi(M,z):fi(M,z):j?fi(M,z):Mi(M,z)}function sa(M){return M instanceof SVGElement&&(M=M.correspondingElement),M.className.baseVal===void 0?M.className:M.className.baseVal}function qi(M){for(;M&&M.firstChild;)M.removeChild(M.firstChild)}var Sa=Dr(["transform","WebkitTransform"]);function Zi(M,z){M.style[Sa]=z}function Oi(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var M=window.document.createEvent("UIEvents");M.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(M)}}function jr(M){var z=["padding: "+(M.height/2-8)+"px "+M.width/2+"px;","line-height: "+M.height+"px;","background-image: url("+M.toDataURL()+");"];console.log(`%c
`,z.join(""))}function Fi(){var M,z=window.document.querySelector('meta[name="viewport"]');if(!z)return 1;var j=(M=z.content)===null||M===void 0?void 0:M.split(","),ne=j.find(function(ce){var le=ce.split("="),lt=(0,wt.Z)(le,1),it=lt[0];return it==="initial-scale"});return ne?ne.split("=")[1]*1:1}var Ls=Fi()<1?1:window.devicePixelRatio;function Ta(M,z){M.setAttribute("style","".concat(M.style.cssText).concat(z))}function Aa(M){return M.split(";").map(function(z){return z.trim()}).filter(function(z){return z})}function go(M,z){var j,ne=Aa((j=M.getAttribute("style"))!==null&&j!==void 0?j:""),ce=Aa(z),le=lr.apply(void 0,[ne].concat((0,dr.Z)(ce)));M.setAttribute("style",le.join(";"))}function os(M){return Object.entries(M).map(function(z){var j=(0,wt.Z)(z,2),ne=j[0],ce=j[1];return"".concat(ne,": ").concat(ce)}).join(";")}function ka(M,z){return{left:M.left-z.left,top:M.top-z.top,right:z.left+z.width-M.left-M.width,bottom:z.top+z.height-M.top-M.height}}function Ao(M,z){M.checked=z,z?M.setAttribute("checked","true"):M.removeAttribute("checked")}function za(M){M.innerHTML=""}function Ja(M){M.setAttribute("draggable","false")}function Oa(M,z){if(typeof z=="string"){var j=document.createElement("div");for(j.innerHTML=z;j.firstChild;)M.append(j.firstChild)}else Array.isArray(z)?M.append.apply(M,(0,dr.Z)(z)):M.append(z)}function Za(M,z){for(var j=Array.isArray(z)?z:[z],ne=M;ne instanceof Element&&ne!==window.document.body;){var ce,le;if(j.find(function(lt){var it;return(it=ne)===null||it===void 0?void 0:it.matches(lt)}))return ne;ne=(ce=(le=ne)===null||le===void 0?void 0:le.parentElement)!==null&&ce!==void 0?ce:null}}var qo;function Ca(M){return typeof ImageBitmap!="undefined"&&M instanceof ImageBitmap}function io(){return typeof importScripts=="function"}var Do=io()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},$=(qo=navigator)===null||qo===void 0?void 0:qo.userAgent,ho=!!$.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),ja=$.indexOf("Android")>-1||$.indexOf("Adr")>-1;function gs(){for(var M=$,z=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],j=!0,ne=0,ce=z;ne<ce.length;ne++){var le=ce[ne];if(M.indexOf(le)>0){j=!1;break}}return j}function Vo(M,z){M.forEach(function(j){z[j]&&(z[j]=z[j].bind(z))})}var Je=null,yt=_(39034);function Qt(M){var z=[1/0,1/0,-1/0,-1/0];return(0,yt.pZ)(M,function(j){z[0]>j[0]&&(z[0]=j[0]),z[1]>j[1]&&(z[1]=j[1]),z[2]<j[0]&&(z[2]=j[0]),z[3]<j[1]&&(z[3]=j[1])}),z}Qt.default=Qt;var Ur=Qt,Tn=_(1449);function mi(M){return typeof M=="number"}var la=2*Math.PI*6378137/2;function Ho(M,z){var j=(0,wt.Z)(z,4),ne=j[0],ce=j[1],le=j[2],lt=j[3];return M.lng>ne&&M.lng<=le&&M.lat>ce&&M.lat<=lt}function ss(M){var z=[1/0,1/0,-1/0,-1/0];return M.forEach(function(j){var ne=j.coordinates;ko(z,ne)}),z}function ko(M,z){return Array.isArray(z[0])?z.forEach(function(j){ko(M,j)}):(M[0]>z[0]&&(M[0]=z[0]),M[1]>z[1]&&(M[1]=z[1]),M[2]<z[0]&&(M[2]=z[0]),M[3]<z[1]&&(M[3]=z[1])),M}function gu(M,z){return Ws(M,z)}function Ws(M,z){return Array.isArray(M[0])?M.map(function(j){return Ws(j,z)}):z(M)}function cf(M){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};M=xl(M,z);var ne=M[0],ce=M[1],le=ne*la/180,lt=Math.log(Math.tan((90+ce)*Math.PI/360))/(Math.PI/180);return lt=lt*la/180,j.enable&&(le=Number(le.toFixed(j.decimal)),lt=Number(lt.toFixed(j.decimal))),M.length===3?[le,lt,M[2]]:[le,lt]}function ff(M){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,j=M[0],ne=M[1],ce=j/la*180,le=ne/la*180;return le=180/Math.PI*(2*Math.atan(Math.exp(le*Math.PI/180))-Math.PI/2),z!=null&&(ce=Number(ce.toFixed(z)),le=Number(le.toFixed(z))),M.length===3?[ce,le,M[2]]:[ce,le]}function ys(M){if(M==null)throw new Error("lng is required");return(M>180||M<-180)&&(M=M%360,M>180&&(M=-360+M),M<-180&&(M=360+M),M===0&&(M=0)),M}function bl(M){if(M==null)throw new Error("lat is required");return(M>90||M<-90)&&(M=M%180,M>90&&(M=-180+M),M<-90&&(M=180+M),M===0&&(M=0)),M}function xl(M,z){if(z===!1)return M;var j=ys(M[0]),ne=bl(M[1]);return ne>85&&(ne=85),ne<-85&&(ne=-85),M.length===3?[j,ne,M[2]]:[j,ne]}function ds(M){var z=85.0511287798,j=Math.max(Math.min(z,M[1]),-z),ne=256<<20,ce=Math.PI/180,le=M[0]*ce,lt=j*ce;lt=Math.log(Math.tan(Math.PI/4+lt/2));var it=.5/Math.PI,Yt=.5,ht=-.5/Math.PI;return ce=.5,le=ne*(it*le+Yt),lt=ne*(ht*lt+ce),[Math.floor(le),Math.floor(lt)]}function Qu(M){var z=.5/Math.PI,j=.5,ne=-.5/Math.PI,ce=.5,le=256<<20,lt=_slicedToArray(M,2),it=lt[0],Yt=lt[1];it=(it/le-j)/z,Yt=(Yt/le-ce)/ne,Yt=(Math.atan(Math.pow(Math.E,Yt))-Math.PI/4)*2,ce=Math.PI/180;var ht=Yt/ce,er=it/ce;return[er,ht]}function El(M,z){var j=85.0511287798,ne=Math.PI/180,ce=6378137;return z=Math.max(Math.min(j,z),-j),M*=ne,z*=ne,z=Math.log(Math.tan(Math.PI/4+z/2)),[M*ce,z*ce]}function Fl(M,z){var j=Math.PI/180,ne=6378137,ce=M/ne/j,le=2*(Math.atan(Math.exp(z/ne))-Math.PI/4)/j;return[ce,le]}function gn(M,z,j){var ne=degreesToRadians(z[1]-M[1]),ce=degreesToRadians(z[0]-M[0]),le=degreesToRadians(M[1]),lt=degreesToRadians(z[1]),it=Math.pow(Math.sin(ne/2),2)+Math.pow(Math.sin(ce/2),2)*Math.cos(le)*Math.cos(lt);return radiansToLength(2*Math.atan2(Math.sqrt(it),Math.sqrt(1-it)),j="meters")}function Ai(M){var z=Math.PI/180,j=85.0511287798,ne=6378137,ce=Math.max(Math.min(j,M[1]),-j),le=Math.sin(ce*z),lt=ne*M[0]*z,it=ne*Math.log((1+le)/(1-le))/2;return[lt,it]}function Hi(M,z){var j=Math.abs(M[1][1]-M[0][1])*z,ne=Math.abs(M[1][0]-M[0][0])*z;return[[M[0][0]-ne,M[0][1]-j],[M[1][0]+ne,M[1][1]+j]]}function kn(M,z){return M[0][0]<=z[0][0]&&M[0][1]<=z[0][1]&&M[1][0]>=z[1][0]&&M[1][1]>=z[1][1]}function us(M){return[[M[0],M[1]],[M[2],M[3]]]}function Sl(M){var z=Ic(M,[0,0]);return[M[0]/z,M[1]/z]}function Ic(M,z){return Math.sqrt(Math.pow(M[0]-z[0],2)+Math.pow(M[1]-z[1],2))}function hf(M,z){return M[0]*z[0]+M[1]*z[1]}function Oc(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])}function df(M,z){return Math.acos(hf(M,z)/(Oc(M)*Oc(z)))*180/Math.PI}function pf(M,z){return z[0]>0?z[1]>0?90-Math.atan(z[1]/z[0])*180/Math.PI:90+Math.atan(-z[1]/z[0])*180/Math.PI:z[1]<0?180+(90-Math.atan(z[1]/z[0])*180/Math.PI):270+Math.atan(z[1]/-z[0])*180/Math.PI}function po(M){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!M||M.length<2)){for(var j=[0,1],ne=0,ce=[],le=0;le<M.length-1;le++){var lt=M[le],it=M[le+1],Yt=Ic(lt,it);ne+=Yt;var ht=[lt[0]-it[0],lt[1]-it[1]],er=pf(j,ht);if(le>0){var yr=ce[le-1].rotation;yr-er>360-yr+er&&(er=er+360)}ce.push({start:lt,end:it,dis:Yt,rotation:er,duration:0})}return ce.map(function(_n){_n.duration=z*(_n.dis/ne)}),ce}}function Pf(M){if(mi(M[0]))return M;if(mi(M[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(mi(M[0][0][0])){var z=M,j=0,ne=0,ce=0;return z.forEach(function(le){le.forEach(function(lt){j+=lt[0],ne+=lt[1],ce++})}),[j/ce,ne/ce,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function vc(M){for(var z=M[0],j=M[1],ne=M[0],ce=M[1],le=0,lt=0,it=0,Yt=0;Yt<M.length;Yt+=2){var ht=M[Yt],er=M[Yt+1];ht&&er&&(z=Math.max(ht,z),j=Math.max(er,j),ne=Math.min(ht,ne),ce=Math.min(er,ce),le+=ht,lt+=er,it++)}return{center:[le/it,lt/it],radius:Math.sqrt(Math.pow(z-ne,2)+Math.pow(j-ce,2))/2}}function Ju(M){return Ur((0,Tn.uf)([(0,Tn.Tu)(M)]))}function eh(M){var z=131,j=137,ne=0;M+="x";for(var ce=Math.floor(9007199254740991/j),le=0;le<M.length;le++)ne>ce&&(ne=Math.floor(ne/j)),ne=ne*z+M.charCodeAt(le);return ne}function Qo(M){M=M.toString();for(var z=5381,j=M.length;j;)z=z*33^M.charCodeAt(--j);return z>>>0}function Nl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(M){var z=Math.random()*16|0,j=M==="x"?z:z&3|8;return j.toString(16)})}var Ul=function(M){return M["GAODE1.x"]="GAODE1.x",M["GAODE2.x"]="GAODE2.x",M.MAPBOX="MAPBOX",M.DEFAULT="DEFAUlTMAP",M.SIMPLE="SIMPLE",M.GLOBEL="GLOBEL",M}({});function iu(M,z,j,ne,ce){var le=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,lt=arguments.length>6?arguments[6]:void 0,it=j;return lt&&(it=Math.round(j*(le-1))/(le-1)),ne?au(M,z,it,ne,ce):au(M,z,it,.314,ce)}function yu(M,z){var j=1-z;return(M[0]*j+M[1]*z)*j+(M[1]*j+M[2]*z)*z}function _u(M,z){return Math.sqrt(Math.pow(M[0]-z[0],2)+Math.pow(M[1]-z[1],2))}function el(M,z,j){var ne=[z[0]-M[0],z[1]-M[1]],ce=_u(ne,[0,0]),le=Math.atan2(ne[1],ne[0]),lt=ce/2/Math.cos(j),it=le+j,Yt=[lt*Math.cos(it)+M[0],lt*Math.sin(it)+M[1]];return Yt}function au(M,z,j,ne,ce){if(ce===MapType["GAODE2.x"]){var le=amap2Project(M[0],M[1]),lt=amap2Project(z[0],z[1]),it=el(le,lt,ne),Yt=[le[0],it[0],lt[0]],ht=[le[1],it[1],lt[1]];return[].concat(_toConsumableArray(amap2UnProject(yu(Yt,j),yu(ht,j))),[0])}else{var er=el(M,z,ne),yr=[M[0],er[0],z[0]],_n=[M[1],er[1],z[1]];return[yu(yr,j),yu(_n,j),0]}}function zl(M,z,j,ne,ce){var le=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,lt=arguments.length>6?arguments[6]:void 0,it=j;return lt&&(it=Math.round(j*29)/29),Va(M,z,it,ce)}function Tl(M,z){var j=[z[0]-M[0],z[1]-M[1]],ne=calDistance(j,[0,0]),ce=Math.atan2(j[1],j[0]),le=.314,lt=ne/2/Math.cos(le),it=ce+le,Yt=[lt*Math.cos(it)+M[0],lt*Math.sin(it)+M[1]];return Yt}function vf(M,z){var j=1-z;return(M[0]*j+M[1]*z)*j+(M[1]*j+M[2]*z)*z}function Vc(M,z){var j=[M[0]-z[0],M[1]-z[1]],ne=[Math.sin(j[0]/2),Math.sin(j[1]/2)],ce=ne[1]*ne[1]+Math.cos(M[1])*Math.cos(z[1])*ne[0]*ne[0];return 2*Math.atan2(Math.sqrt(ce),Math.sqrt(1-ce))}function Va(M,z,j,ne){var ce=[degreesToRadians(M[0]),degreesToRadians(M[1])],le=[degreesToRadians(z[0]),degreesToRadians(z[1])];if(ne==="GAODE2.x"){var lt=Tl(ce,le),it=[ce[0],lt[0],le[0]],Yt=[ce[1],lt[1],le[1]];return[vf(it,j),vf(Yt,j),0]}else{var ht=Vc(ce,le);if(Math.abs(ht-Math.PI)<.001)return[(1-j)*ce[0]+j*le[0],(1-j)*ce[1]+j*le[1]];var er=Math.sin((1-j)*ht)/Math.sin(ht),yr=Math.sin(j*ht)/Math.sin(ht),_n=[Math.sin(ce[0]),Math.sin(ce[1])],vn=[Math.cos(ce[0]),Math.cos(ce[1])],Jr=[Math.sin(le[0]),Math.sin(le[1])],Gn=[Math.cos(le[0]),Math.cos(le[1])],Xn=er*vn[1]*vn[0]+yr*Gn[1]*Gn[0],Yn=er*vn[1]*_n[0]+yr*Gn[1]*Jr[0],gi=er*_n[1]+yr*Jr[1];return[radiansToDegrees(Math.atan2(Yn,Xn)),radiansToDegrees(Math.atan2(gi,Math.sqrt(Xn*Xn+Yn*Yn)))]}}function th(M,z){for(var j=0,ne=[],ce=0;ce<M.length-1;ce++){var le=M[ce],lt=M[ce+1],it=Hc(le,lt),Yt=j;j+=it,ne.push({p1:le,p2:lt,totalDistance:j,distance:it,lastTotalDistance:Yt})}for(var ht=j*z,er,yr,_n=0,vn=ne;_n<vn.length;_n++){var Jr=vn[_n],Gn=Jr.totalDistance;if(Gn>ht){var Xn=Jr.p1,Yn=Jr.p2,gi=(ht-Jr.lastTotalDistance)/Jr.distance,xi=Pc(Yn,Xn,gi);er=xi[0],yr=xi[1];break}}return{lng:er,lat:yr,height:0}}function Pc(M,z,j){return[M[0]*j+z[0]*(1-j),M[1]*j+z[1]*(1-j)]}function Hc(M,z){return Math.sqrt(Math.pow(M[0]-z[0],2)+Math.pow(M[1]-z[1],2))}function bo(M,z){var j=z.featureId,ne=M.data.dataArray;return typeof j=="number"&&(ne=ne.filter(function(ce){var le=ce.id;return le===j})),ne.map(function(ce){var le=gf(ce,z);return _objectSpread(_objectSpread({},ce),le)})}function mf(M,z){return new Promise(function(j){M.inited?j(bo(M,z)):M.once("update",function(){j(bo(M,z))})})}function gf(M,z){var j=z.offset,ne=z.shape,ce=z.thetaOffset,le=z.mapVersion,lt=z.segmentNumber,it=lt===void 0?30:lt,Yt=z.autoFit,ht=Yt===void 0?!0:Yt,er=M.coordinates;if(ne==="line")return pathLineAtOffset(er,j);var yr=er[0],_n=er[1],vn=typeof ce=="string"?M[ce]||0:ce,Jr;switch(ne){case"arc":Jr=arcLineAtOffset;break;case"greatcircle":Jr=greatCircleLineAtOffset;break;default:Jr=arcLineAtOffset}var Gn=Jr(yr,_n,j,vn,le,it,ht),Xn=_slicedToArray(Gn,3),Yn=Xn[0],gi=Xn[1],xi=Xn[2];return{lng:Yn,lat:gi,height:xi}}var Jo=function(){function M(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,j=arguments.length>1?arguments[1]:void 0;(0,C.Z)(this,M),this.limit=z,this.destroy=j||this.defaultDestroy,this.order=[],this.clear()}return(0,O.Z)(M,[{key:"clear",value:function(){var j=this;this.order.forEach(function(ne){j.delete(ne)}),this.cache={},this.order=[]}},{key:"get",value:function(j){var ne=this.cache[j];return ne&&(this.deleteOrder(j),this.appendOrder(j)),ne}},{key:"set",value:function(j,ne){this.cache[j]?(this.delete(j),this.cache[j]=ne,this.appendOrder(j)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[j]=ne,this.appendOrder(j))}},{key:"delete",value:function(j){var ne=this.cache[j];ne&&(this.deleteCache(j),this.deleteOrder(j),this.destroy(ne,j))}},{key:"deleteCache",value:function(j){delete this.cache[j]}},{key:"deleteOrder",value:function(j){var ne=this.order.findIndex(function(ce){return ce===j});ne>=0&&this.order.splice(ne,1)}},{key:"appendOrder",value:function(j){this.order.push(j)}},{key:"defaultDestroy",value:function(j,ne){return null}}]),M}();function Zu(M){if(M.length===0)throw new Error("max requires at least one data point");for(var z=M[0],j=1;j<M.length;j++)M[j]>z&&(z=M[j]);return z*1}function Mu(M){if(M.length===0)throw new Error("min requires at least one data point");for(var z=M[0],j=1;j<M.length;j++)M[j]<z&&(z=M[j]);return z*1}function ju(M){if(M.length===0)return 0;for(var z=M[0]*1,j=1;j<M.length;j++)z+=M[j]*1;return z}function mc(M){if(M.length===0)throw new Error("mean requires at least one data point");return ju(M)/M.length}function Zl(M){if(M.length===0)throw new Error("mean requires at least one data point");if(M.length<3)return M[0];M.sort();for(var z=M[0],j=NaN,ne=0,ce=1,le=1;le<M.length+1;le++)M[le]!==z?(ce>ne&&(ne=ce,j=z),ce=1,z=M[le]):ce++;return j*1}var bu={min:Mu,max:Zu,mean:mc,sum:ju,mode:Zl};function gc(M,z){return M.map(function(j){return j[z]})}function Al(M,z){return bu[M](z)}var ou=_(15861),La=_(97326),qa=_(4942),so=_(64687),Vu=_.n(so);function Df(M,z){z===void 0&&(z={});var j=Number(M[0]),ne=Number(M[1]),ce=Number(M[2]),le=Number(M[3]);if(M.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var lt=[j,ne],it=[j,le],Yt=[ce,le],ht=[ce,ne];return(0,Tn.yu)([[lt,ht,Yt,it,lt]],z.properties,{bbox:M,id:z.id})}var Cl=_(26729),Dc=_.n(Cl),yc=function(M){return M.Realtime="realtime",M.Overlap="overlap",M.Replace="replace",M}({}),Gs=function(M){return M.Loading="Loading",M.Loaded="Loaded",M.Failure="Failure",M.Cancelled="Cancelled",M}({}),Hu=0,Iu=1,tl=2;function Ql(M){M.forEach(function(z){z.isCurrent&&(z.isVisible=z.isLoaded)})}function Jl(M){M.forEach(function(z){z.properties.state=Hu}),M.forEach(function(z){z.isCurrent&&!kc(z)&&rl(z)}),M.forEach(function(z){z.isVisible=!!(z.properties.state&tl)})}function jl(M){M.forEach(function(j){j.properties.state=Hu}),M.forEach(function(j){j.isCurrent&&kc(j)});var z=M.slice().sort(function(j,ne){return j.z-ne.z});z.forEach(function(j){j.isVisible=!!(j.properties.state&tl),j.children.length&&(j.isVisible||j.properties.state&Iu)?j.children.forEach(function(ne){ne.properties.state=Iu}):j.isCurrent&&rl(j)})}function kc(M){for(;M;){if(M.isLoaded)return M.properties.state|=tl,!0;M=M.parent}return!1}function rl(M){M.children.forEach(function(z){z.isLoaded?z.properties.state|=tl:rl(z)})}var Xs,kf=256,yf=[-1/0,-1/0,1/0,1/0],Lf=.2,Vl=5,$u=(Xs={},(0,qa.Z)(Xs,yc.Realtime,Ql),(0,qa.Z)(Xs,yc.Overlap,Jl),(0,qa.Z)(Xs,yc.Replace,jl),Xs),Hl=function(){};function _c(M,z,j){var ne=Math.floor((M+180)/360*Math.pow(2,j)),ce=Math.floor((1-Math.log(Math.tan(z*Math.PI/180)+1/Math.cos(z*Math.PI/180))/Math.PI)/2*Math.pow(2,j));return[ne,ce]}function nl(M,z,j){var ne=M/Math.pow(2,j)*360-180,ce=Math.PI-2*Math.PI*z/Math.pow(2,j),le=180/Math.PI*Math.atan(.5*(Math.exp(ce)-Math.exp(-ce)));return[ne,le]}var Bf=function(z,j,ne){var ce=nl(z,j,ne),le=(0,wt.Z)(ce,2),lt=le[0],it=le[1],Yt=nl(z+1,j+1,ne),ht=(0,wt.Z)(Yt,2),er=ht[0],yr=ht[1];return[lt,yr,er,it]};function $c(M){var z=M.zoom,j=M.latLonBounds,ne=M.maxZoom,ce=ne===void 0?1/0:ne,le=M.minZoom,lt=le===void 0?0:le,it=M.zoomOffset,Yt=it===void 0?0:it,ht=M.extent,er=ht===void 0?yf:ht,yr=Math.ceil(z)+Yt;if(Number.isFinite(lt)&&yr<lt)return[];Number.isFinite(ce)&&yr>ce&&(yr=ce);for(var _n=(0,wt.Z)(j,4),vn=_n[0],Jr=_n[1],Gn=_n[2],Xn=_n[3],Yn=[Math.max(vn,er[0]),Math.max(Jr,er[1]),Math.min(Gn,er[2]),Math.min(Xn,er[3])],gi=[],xi=_c(Yn[0],Yn[1],yr),Ni=(0,wt.Z)(xi,2),Pa=Ni[0],Ua=Ni[1],Mo=_c(Yn[2],Yn[3],yr),ga=(0,wt.Z)(Mo,2),Xi=ga[0],da=ga[1],Go=Pa;Go<=Xi;Go++)for(var ls=da;ls<=Ua;ls++)gi.push({x:Go,y:ls,z:yr});var Uo=(Xi+Pa)/2,Xo=(Ua+da)/2,Rs=function(fl,ms){return Math.abs(fl-Uo)+Math.abs(ms-Xo)};return gi.sort(function(xo,fl){return Rs(xo.x,xo.y)-Rs(fl.x,fl.y)}),gi}var _f=function(z,j,ne){var ce=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,le=Math.pow(2,ne),lt=le-1,it=le,Yt=z,ht=j;return ce&&(Yt<0?Yt=Yt+it:Yt>lt&&(Yt=Yt%it)),{warpX:Yt,warpY:ht}};function Wc(M){var z=bf();return function(){var ne=(0,Y.Z)(M),ce;if(z){var le=(0,Y.Z)(this).constructor;ce=Reflect.construct(ne,arguments,le)}else ce=ne.apply(this,arguments);return(0,F.Z)(this,ce)}}function bf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(M){return!1}}var bc=function(M){(0,P.Z)(j,M);var z=Wc(j);function j(ne){var ce;(0,C.Z)(this,j),ce=z.call(this),(0,qa.Z)((0,La.Z)(ce),"tileSize",256),(0,qa.Z)((0,La.Z)(ce),"isVisible",!1),(0,qa.Z)((0,La.Z)(ce),"isCurrent",!1),(0,qa.Z)((0,La.Z)(ce),"isVisibleChange",!1),(0,qa.Z)((0,La.Z)(ce),"loadedLayers",0),(0,qa.Z)((0,La.Z)(ce),"isLayerLoaded",!1),(0,qa.Z)((0,La.Z)(ce),"isLoad",!1),(0,qa.Z)((0,La.Z)(ce),"isChildLoad",!1),(0,qa.Z)((0,La.Z)(ce),"parent",null),(0,qa.Z)((0,La.Z)(ce),"children",[]),(0,qa.Z)((0,La.Z)(ce),"data",null),(0,qa.Z)((0,La.Z)(ce),"properties",{}),(0,qa.Z)((0,La.Z)(ce),"loadDataId",0);var le=ne.x,lt=ne.y,it=ne.z,Yt=ne.tileSize,ht=ne.warp,er=ht===void 0?!0:ht;return ce.x=le,ce.y=lt,ce.z=it,ce.warp=er||!0,ce.tileSize=Yt,ce}return(0,O.Z)(j,[{key:"isLoading",get:function(){return this.loadStatus===Gs.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===Gs.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===Gs.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===Gs.Cancelled}},{key:"isDone",get:function(){return[Gs.Loaded,Gs.Cancelled,Gs.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return Bf(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var ce=(0,wt.Z)(this.bounds,4),le=ce[0],lt=ce[1],it=ce[2],Yt=ce[3],ht=[(it-le)/2,(Yt-lt)/2],er=Df(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:ht,meta:`
      `.concat(this.key,`
      `)}});return er}},{key:"key",get:function(){var ce="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return ce}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var ne=(0,ou.Z)(Vu().mark(function le(lt){var it,Yt,ht,er,yr,_n,vn,Jr,Gn,Xn,Yn,gi,xi,Ni,Pa,Ua,Mo;return Vu().wrap(function(Xi){for(;;)switch(Xi.prev=Xi.next){case 0:return it=lt.getData,Yt=lt.onLoad,ht=lt.onError,this.loadDataId++,er=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Gs.Loading,yr=null,Xi.prev=7,vn=this.x,Jr=this.y,Gn=this.z,Xn=this.bounds,Yn=this.tileSize,gi=this.warp,xi=_f(vn,Jr,Gn,gi),Ni=xi.warpX,Pa=xi.warpY,Ua=this.abortController.signal,Mo={x:Ni,y:Pa,z:Gn,bounds:Xn,tileSize:Yn,signal:Ua,warp:gi},Xi.next=14,it(Mo,this);case 14:yr=Xi.sent,Xi.next=20;break;case 17:Xi.prev=17,Xi.t0=Xi.catch(7),_n=Xi.t0;case 20:if(er===this.loadDataId){Xi.next=22;break}return Xi.abrupt("return");case 22:if(!(this.isCancelled&&!yr)){Xi.next=24;break}return Xi.abrupt("return");case 24:if(!(_n||!yr)){Xi.next=28;break}return this.loadStatus=Gs.Failure,ht(_n,this),Xi.abrupt("return");case 28:this.loadStatus=Gs.Loaded,this.data=yr,Yt(this);case 31:case"end":return Xi.stop()}},le,this,[[7,17]])}));function ce(le){return ne.apply(this,arguments)}return ce}()},{key:"reloadData",value:function(ce){this.isLoading&&this.abortLoad(),this.loadData(ce)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=Gs.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),j}(Cl.EventEmitter),Gc=function(z,j){var ne=us(z),ce=Hi(ne,j),le=360*3-180,lt=85.0511287798065,it=[Math.max(ce[0][0],-le),Math.max(ce[0][1],-lt),Math.min(ce[1][0],le),Math.min(ce[1][1],lt)];return it},xu=function(z,j){var ne=us(z),ce=us(j),le=kn(ne,ce);return le};function Wu(M,z){var j=typeof Symbol!="undefined"&&M[Symbol.iterator]||M["@@iterator"];if(!j){if(Array.isArray(M)||(j=_s(M))||z&&M&&typeof M.length=="number"){j&&(M=j);var ne=0,ce=function(){};return{s:ce,n:function(){return ne>=M.length?{done:!0}:{done:!1,value:M[ne++]}},e:function(ht){throw ht},f:ce}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var le=!0,lt=!1,it;return{s:function(){j=j.call(M)},n:function(){var ht=j.next();return le=ht.done,ht},e:function(ht){lt=!0,it=ht},f:function(){try{!le&&j.return!=null&&j.return()}finally{if(lt)throw it}}}}function _s(M,z){if(M){if(typeof M=="string")return xf(M,z);var j=Object.prototype.toString.call(M).slice(8,-1);if(j==="Object"&&M.constructor&&(j=M.constructor.name),j==="Map"||j==="Set")return Array.from(M);if(j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j))return xf(M,z)}}function xf(M,z){(z==null||z>M.length)&&(z=M.length);for(var j=0,ne=new Array(z);j<z;j++)ne[j]=M[j];return ne}function $l(M){var z=uo();return function(){var ne=(0,Y.Z)(M),ce;if(z){var le=(0,Y.Z)(this).constructor;ce=Reflect.construct(ne,arguments,le)}else ce=ne.apply(this,arguments);return(0,F.Z)(this,ce)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(M){return!1}}var Ef=Gt.throttle,Ys=function(M){return M.TilesLoadStart="tiles-load-start",M.TileLoaded="tile-loaded",M.TileError="tile-error",M.TileUnload="tile-unload",M.TileUpdate="tile-update",M.TilesLoadFinished="tiles-load-finished",M}({}),wl=function(M){(0,P.Z)(j,M);var z=$l(j);function j(ne){var ce;return(0,C.Z)(this,j),ce=z.call(this),(0,qa.Z)((0,La.Z)(ce),"currentTiles",[]),(0,qa.Z)((0,La.Z)(ce),"cacheTiles",new Map),(0,qa.Z)((0,La.Z)(ce),"throttleUpdate",Ef(function(le,lt){ce.update(le,lt)},16)),(0,qa.Z)((0,La.Z)(ce),"onTileLoad",function(le){ce.emit(Ys.TileLoaded,le),ce.updateTileVisible(),ce.loadFinished()}),(0,qa.Z)((0,La.Z)(ce),"onTileError",function(le,lt){ce.emit(Ys.TileError,{error:le,tile:lt}),ce.updateTileVisible(),ce.loadFinished()}),(0,qa.Z)((0,La.Z)(ce),"onTileUnload",function(le){ce.emit(Ys.TileUnload,le),ce.loadFinished()}),ce.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:yf,getTileData:Hl,warp:!0,updateStrategy:yc.Replace},ce.updateOptions(ne),ce}return(0,O.Z)(j,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(ce){return ce.isDone})}},{key:"tiles",get:function(){var ce=Array.from(this.cacheTiles.values()).sort(function(le,lt){return le.z-lt.z});return ce}},{key:"updateOptions",value:function(ce){var le=ce.minZoom===void 0?this.options.minZoom:Math.ceil(ce.minZoom),lt=ce.maxZoom===void 0?this.options.maxZoom:Math.floor(ce.maxZoom);this.options=(0,h.Z)((0,h.Z)((0,h.Z)({},this.options),ce),{},{minZoom:le,maxZoom:lt})}},{key:"update",value:function(ce,le){var lt=this,it=Math.max(0,Math.ceil(ce));if(!(this.lastViewStates&&this.lastViewStates.zoom===it&&xu(this.lastViewStates.latLonBoundsBuffer,le))){var Yt=Gc(le,Lf);this.lastViewStates={zoom:it,latLonBounds:le,latLonBoundsBuffer:Yt},this.currentZoom=it;var ht=!1,er=this.getTileIndices(it,Yt).filter(function(yr){return lt.options.warp||yr.x>=0&&yr.x<Math.pow(2,it)});this.emit(Ys.TilesLoadStart),this.currentTiles=er.map(function(yr){var _n=yr.x,vn=yr.y,Jr=yr.z,Gn=lt.getTile(_n,vn,Jr);if(Gn){var Xn,Yn,gi=((Xn=Gn)===null||Xn===void 0?void 0:Xn.isFailure)||((Yn=Gn)===null||Yn===void 0?void 0:Yn.isCancelled);return gi&&Gn.loadData({getData:lt.options.getTileData,onLoad:lt.onTileLoad,onError:lt.onTileError}),Gn}return Gn=lt.createTile(_n,vn,Jr),ht=!0,Gn}),ht&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var ce=Wu(this.cacheTiles),le;try{for(ce.s();!(le=ce.n()).done;){var lt=(0,wt.Z)(le.value,2),it=lt[0],Yt=lt[1];if(!this.currentTiles.includes(Yt)){this.cacheTiles.delete(it),this.onTileUnload(Yt);return}this.onTileUnload(Yt),Yt.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(ht){ce.e(ht)}finally{ce.f()}}},{key:"reloadTileById",value:function(ce,le,lt){var it=this.cacheTiles.get("".concat(le,",").concat(lt,",").concat(ce));it&&(this.onTileUnload(it),it.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}},{key:"reloadTileByLnglat",value:function(ce,le,lt){var it=this.getTileByLngLat(ce,le,lt);it&&this.reloadTileById(it.z,it.x,it.y)}},{key:"reloadTileByExtent",value:function(ce,le){var lt=this,it=this.getTileIndices(le,ce);it.forEach(function(Yt){lt.reloadTileById(Yt.z,Yt.x,Yt.y)})}},{key:"pruneRequests",value:function(){var ce=[],le=Wu(this.cacheTiles.values()),lt;try{for(le.s();!(lt=le.n()).done;){var it=lt.value;it.isLoading&&!it.isCurrent&&!it.isVisible&&ce.push(it)}}catch(ht){le.e(ht)}finally{le.f()}for(;ce.length>0;){var Yt=ce.shift();Yt.abortLoad()}}},{key:"getTileByLngLat",value:function(ce,le,lt){var it=this.options.zoomOffset,Yt=Math.ceil(lt)+it,ht=_c(ce,le,Yt),er=this.tiles.filter(function(yr){return yr.key==="".concat(ht[0],"_").concat(ht[1],"_").concat(Yt)});return er[0]}},{key:"getTileExtent",value:function(ce,le){return this.getTileIndices(le,ce)}},{key:"getTileByZXY",value:function(ce,le,lt){var it=this.tiles.filter(function(Yt){return Yt.key==="".concat(le,"_").concat(lt,"_").concat(ce)});return it[0]}},{key:"clear",value:function(){var ce=Wu(this.cacheTiles.values()),le;try{for(ce.s();!(le=ce.n()).done;){var lt=le.value;lt.isLoading?lt.abortLoad():this.onTileUnload(lt)}}catch(it){ce.e(it)}finally{ce.f()}this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var ce=this.options.updateStrategy,le=new Map,lt=Wu(this.cacheTiles.values()),it;try{for(lt.s();!(it=lt.n()).done;){var Yt=it.value;le.set(Yt.key,Yt.isVisible),Yt.isCurrent=!1,Yt.isVisible=!1}}catch(Jr){lt.e(Jr)}finally{lt.f()}var ht=Wu(this.currentTiles),er;try{for(ht.s();!(er=ht.n()).done;){var yr=er.value;yr.isCurrent=!0,yr.isVisible=!0}}catch(Jr){ht.e(Jr)}finally{ht.f()}var _n=Array.from(this.cacheTiles.values());typeof ce=="function"?ce(_n):$u[ce](_n);var vn=!1;Array.from(this.cacheTiles.values()).forEach(function(Jr){Jr.isVisible!==le.get(Jr.key)?(Jr.isVisibleChange=!0,vn=!0):Jr.isVisibleChange=!1}),vn&&this.emit(Ys.TileUpdate)}},{key:"getTileIndices",value:function(ce,le){var lt=this.options,it=lt.tileSize,Yt=lt.extent,ht=lt.zoomOffset,er=Math.floor(this.options.maxZoom),yr=Math.ceil(this.options.minZoom),_n=$c({maxZoom:er,minZoom:yr,zoomOffset:ht,tileSize:it,zoom:ce,latLonBounds:le,extent:Yt});return _n}},{key:"getTileId",value:function(ce,le,lt){var it="".concat(ce,",").concat(le,",").concat(lt);return it}},{key:"loadFinished",value:function(){var ce=!this.currentTiles.some(function(le){return!le.isDone});return ce&&this.emit(Ys.TilesLoadFinished),ce}},{key:"getTile",value:function(ce,le,lt){var it=this.getTileId(ce,le,lt),Yt=this.cacheTiles.get(it);return Yt}},{key:"createTile",value:function(ce,le,lt){var it=this.getTileId(ce,le,lt),Yt=new bc({x:ce,y:le,z:lt,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(it,Yt),Yt.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),Yt}},{key:"resizeCacheTiles",value:function(){var ce=Vl*this.currentTiles.length,le=this.cacheTiles.size>ce;if(le){var lt=Wu(this.cacheTiles),it;try{for(lt.s();!(it=lt.n()).done;){var Yt=(0,wt.Z)(it.value,2),ht=Yt[0],er=Yt[1];if(!er.isVisible&&!this.currentTiles.includes(er)&&(this.cacheTiles.delete(ht),this.onTileUnload(er)),this.cacheTiles.size<=ce)break}}catch(yr){lt.e(yr)}finally{lt.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var ce=Wu(this.cacheTiles.values()),le;try{for(ce.s();!(le=ce.n()).done;){var lt=le.value;lt.parent=null,lt.children.length=0}}catch(yr){ce.e(yr)}finally{ce.f()}var it=Wu(this.cacheTiles.values()),Yt;try{for(it.s();!(Yt=it.n()).done;){var ht=Yt.value,er=this.getNearestAncestor(ht.x,ht.y,ht.z);ht.parent=er,er!=null&&er.children&&er.children.push(ht)}}catch(yr){it.e(yr)}finally{it.f()}}},{key:"getNearestAncestor",value:function(ce,le,lt){for(;lt>this.options.minZoom;){ce=Math.floor(ce/2),le=Math.floor(le/2),lt=lt-1;var it=this.getTile(ce,le,lt);if(it)return it}return null}}]),j}(Dc());function Ia(M){return/(?=.*{box})(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(M)}function lo(M){var z=[],j=/\{([a-z])-([a-z])\}/.exec(M);if(j){var ne=j[1].charCodeAt(0),ce=j[2].charCodeAt(0),le;for(le=ne;le<=ce;++le)z.push(M.replace(j[0],String.fromCharCode(le)));return z}if(j=/\{(\d+)-(\d+)\}/.exec(M),j){for(var lt=parseInt(j[2],10),it=parseInt(j[1],10);it<=lt;it++)z.push(M.replace(j[0],it.toString()));return z}return z.push(M),z}function Ou(M,z){if(!M||!M.length)throw new Error("url is not allowed to be empty");var j=z.x,ne=z.y,ce=z.z,le=lo(M),lt=Math.abs(j+ne)%le.length,it=ve(le[lt])?"".concat(le[lt],"/{z}/{x}/{y}"):le[lt];return it.replace(/\{x\}/g,j.toString()).replace(/\{y\}/g,ne.toString()).replace(/\{z\}/g,ce.toString()).replace(/\{bbox\}/g,Bf(j,ne,ce).join(",")).replace(/\{-y\}/g,(Math.pow(2,ce)-ne-1).toString())}function Xc(M,z){var j=z.x,ne=z.y,ce=z.z,le=z.layer,lt=z.version,it=lt===void 0?"1.0.0":lt,Yt=z.style,ht=Yt===void 0?"default":Yt,er=z.format,yr=z.service,_n=yr===void 0?"WMTS":yr,vn=z.tileMatrixset,Jr=lo(M),Gn=Math.abs(j+ne)%Jr.length,Xn="".concat(Jr[Gn],"&SERVICE=").concat(_n,"&REQUEST=GetTile&VERSION=").concat(it,"&LAYER=").concat(le,"&STYLE=").concat(ht,"&TILEMATRIXSET=").concat(vn,"&FORMAT=").concat(er,"&TILECOL=").concat(j,"&TILEROW=").concat(ne,"&TILEMATRIX=").concat(ce);return Xn}function Pu(M,z){if(!M)throw new Error(z||"web worker helper assertion failed.")}var Bs={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},Ff=Bs.self||Bs.window||{},Yc=Bs.window||Bs.self||{},ec=Bs.self||Bs.window||{},tc=Bs.document||{},ps=typeof importScripts=="function",Co=typeof window!="undefined"&&typeof window.orientation!="undefined",xc=function(){function M(z,j){var ne=this;this.name=z,this.workerThread=j,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(ce,le){ne.resolve=ce,ne.reject=le})}return M.prototype.postMessage=function(z,j){this.workerThread.postMessage({source:"Main thread",type:z,payload:j})},M.prototype.done=function(z){Pu(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(z)},M.prototype.error=function(z){Pu(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(z)},M}(),Nf=xc,wo=new Map;function oi(M){Pu(M.source&&!M.url||!M.source&&M.url);var z=wo.get(M.source||M.url);return z||(M.url&&(z=Ks(M.url),wo.set(M.url,z)),M.source&&(z=rc(M.source),wo.set(M.source,z))),Pu(z),z}function Ks(M){if(!M.startsWith("http"))return M;var z=nc(M);return rc(z)}function rc(M){var z=new Blob([M],{type:"application/javascript"});return URL.createObjectURL(z)}function nc(M){return`try {
  importScripts('`+M+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Cs(M,z,j){z===void 0&&(z=!0);var ne=j||new Set;if(M){if(wa(M))ne.add(M);else if(wa(M.buffer))ne.add(M.buffer);else if(!ArrayBuffer.isView(M)){if(z&&typeof M=="object")for(var ce in M)Cs(M[ce],z,ne)}}return j===void 0?Array.from(ne):[]}function wa(M){return M?M instanceof ArrayBuffer||typeof MessagePort!="undefined"&&M instanceof MessagePort||typeof ImageBitmap!="undefined"&&M instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&M instanceof OffscreenCanvas:!1}var qs=function(){},zn=function(){function M(z){this.terminated=!1,this.loadableURL="";var j=z.name,ne=z.source,ce=z.url;Pu(ne||ce),this.name=j,this.source=ne,this.url=ce,this.onMessage=qs,this.onError=function(le){return console.log(le)},this.worker=this.createBrowserWorker()}return M.isSupported=function(){return typeof Worker!="undefined"},M.prototype.destroy=function(){this.onMessage=qs,this.onError=qs,this.worker.terminate(),this.terminated=!0},Object.defineProperty(M.prototype,"isRunning",{get:function(){return!!this.onMessage},enumerable:!1,configurable:!0}),M.prototype.postMessage=function(z,j){j=j||Cs(z),this.worker.postMessage(z,j)},M.prototype.getErrorFromErrorEvent=function(z){var j="Failed to load ";return j+="worker "+this.name+" from "+this.url+". ",z.message&&(j+=z.message+" in "),z.lineno&&(j+=":"+z.lineno+":"+z.colno),new Error(j)},M.prototype.createBrowserWorker=function(){var z=this;this.loadableURL=oi({source:this.source,url:this.url});var j=new Worker(this.loadableURL,{name:this.name});return j.onmessage=function(ne){ne.data?z.onMessage(ne.data):z.onError(new Error("No data received"))},j.onerror=function(ne){z.onError(z.getErrorFromErrorEvent(ne)),z.terminated=!0},j.onmessageerror=function(ne){return console.error("worker "+z.name+", message error: "+ne)},j},M}(),Du=zn,il=function(){return il=Object.assign||function(M){for(var z,j=1,ne=arguments.length;j<ne;j++){z=arguments[j];for(var ce in z)Object.prototype.hasOwnProperty.call(z,ce)&&(M[ce]=z[ce])}return M},il.apply(this,arguments)},Ec=function(M,z,j,ne){function ce(le){return le instanceof j?le:new j(function(lt){lt(le)})}return new(j||(j=Promise))(function(le,lt){function it(er){try{ht(ne.next(er))}catch(yr){lt(yr)}}function Yt(er){try{ht(ne.throw(er))}catch(yr){lt(yr)}}function ht(er){er.done?le(er.value):ce(er.value).then(it,Yt)}ht((ne=ne.apply(M,z||[])).next())})},Eu=function(M,z){var j={label:0,sent:function(){if(le[0]&1)throw le[1];return le[1]},trys:[],ops:[]},ne,ce,le,lt;return lt={next:it(0),throw:it(1),return:it(2)},typeof Symbol=="function"&&(lt[Symbol.iterator]=function(){return this}),lt;function it(ht){return function(er){return Yt([ht,er])}}function Yt(ht){if(ne)throw new TypeError("Generator is already executing.");for(;j;)try{if(ne=1,ce&&(le=ht[0]&2?ce.return:ht[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,ht[1])).done)return le;switch(ce=0,le&&(ht=[ht[0]&2,le.value]),ht[0]){case 0:case 1:le=ht;break;case 4:return j.label++,{value:ht[1],done:!1};case 5:j.label++,ce=ht[1],ht=[0];continue;case 7:ht=j.ops.pop(),j.trys.pop();continue;default:if(le=j.trys,!(le=le.length>0&&le[le.length-1])&&(ht[0]===6||ht[0]===2)){j=0;continue}if(ht[0]===3&&(!le||ht[1]>le[0]&&ht[1]<le[3])){j.label=ht[1];break}if(ht[0]===6&&j.label<le[1]){j.label=le[1],le=ht;break}if(le&&j.label<le[2]){j.label=le[2],j.ops.push(ht);break}le[2]&&j.ops.pop(),j.trys.pop();continue}ht=z.call(M,j)}catch(er){ht=[6,er],ce=0}finally{ne=le=0}if(ht[0]&5)throw ht[1];return{value:ht[0]?ht[1]:void 0,done:!0}}},su=function(){function M(z){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=z.source,this.url=z.url,this.setProps(z)}return M.prototype.destroy=function(){this.idleQueue.forEach(function(z){return z.destroy()}),this.isDestroyed=!0},M.prototype.setProps=function(z){this.props=il(il({},this.props),z),z.name!==void 0&&(this.name=z.name),z.maxConcurrency!==void 0&&(this.maxConcurrency=z.maxConcurrency),z.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=z.maxMobileConcurrency),z.reuseWorkers!==void 0&&(this.reuseWorkers=z.reuseWorkers),z.onDebug!==void 0&&(this.onDebug=z.onDebug)},M.prototype.startJob=function(z,j,ne){return j===void 0&&(j=function(ce,le,lt){return ce.done(lt)}),ne===void 0&&(ne=function(ce,le){return ce.error(le)}),Ec(this,void 0,void 0,function(){var ce,le=this;return Eu(this,function(lt){switch(lt.label){case 0:return ce=new Promise(function(it){return le.jobQueue.push({name:z,onMessage:j,onError:ne,onStart:it}),le}),this.startQueuedJob(),[4,ce];case 1:return[2,lt.sent()]}})})},M.prototype.startQueuedJob=function(){return Ec(this,void 0,void 0,function(){var z,j,ne;return Eu(this,function(ce){switch(ce.label){case 0:if(!this.jobQueue.length)return[2];if(z=this.getAvailableWorker(),!z)return[2];if(j=this.jobQueue.shift(),!j)return[3,4];this.onDebug({message:"Starting job",name:j.name,backlog:this.jobQueue.length,workerThread:z}),ne=new Nf(j.name,z),z.onMessage=function(le){return j.onMessage(ne,le.type,le.payload)},z.onError=function(le){return j.onError(ne,le)},j.onStart(ne),ce.label=1;case 1:return ce.trys.push([1,,3,4]),[4,ne.result];case 2:return ce.sent(),[3,4];case 3:return this.returnWorkerToQueue(z),[7];case 4:return[2]}})})},M.prototype.returnWorkerToQueue=function(z){var j=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();j?(z.destroy(),this.count--):this.idleQueue.push(z),this.isDestroyed||this.startQueuedJob()},M.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var z=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Du({name:z,source:this.source,url:this.url})}return null},M.prototype.getMaxConcurrency=function(){return Co?this.maxMobileConcurrency:this.maxConcurrency},M}(),Lc=su,Rl=function(){return Rl=Object.assign||function(M){for(var z,j=1,ne=arguments.length;j<ne;j++){z=arguments[j];for(var ce in z)Object.prototype.hasOwnProperty.call(z,ce)&&(M[ce]=z[ce])}return M},Rl.apply(this,arguments)},vs=function(M){var z=typeof Symbol=="function"&&Symbol.iterator,j=z&&M[z],ne=0;if(j)return j.call(M);if(M&&typeof M.length=="number")return{next:function(){return M&&ne>=M.length&&(M=void 0),{value:M&&M[ne++],done:!M}}};throw new TypeError(z?"Object is not iterable.":"Symbol.iterator is not defined.")},uu={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},Sf=function(){function M(z){this.workerPools=new Map,this.props=Rl({},uu),this.setProps(z),this.workerPools=new Map}return M.isSupported=function(){return Du.isSupported()},M.getWorkerFarm=function(z){return z===void 0&&(z={}),M.workerFarm=M.workerFarm||new M({}),M.workerFarm.setProps(z),M.workerFarm},M.prototype.destroy=function(){var z,j;try{for(var ne=vs(this.workerPools.values()),ce=ne.next();!ce.done;ce=ne.next()){var le=ce.value;le.destroy()}}catch(lt){z={error:lt}}finally{try{ce&&!ce.done&&(j=ne.return)&&j.call(ne)}finally{if(z)throw z.error}}},M.prototype.setProps=function(z){var j,ne;this.props=Rl(Rl({},this.props),z);try{for(var ce=vs(this.workerPools.values()),le=ce.next();!le.done;le=ce.next()){var lt=le.value;lt.setProps(this.getWorkerPoolProps())}}catch(it){j={error:it}}finally{try{le&&!le.done&&(ne=ce.return)&&ne.call(ce)}finally{if(j)throw j.error}}},M.prototype.getWorkerPool=function(z){var j=z.name,ne=z.source,ce=z.url,le=this.workerPools.get(j);return le||(le=new Lc({name:j,source:ne,url:ce}),le.setProps(this.getWorkerPoolProps()),this.workerPools.set(j,le)),le},M.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},M}(),Bc=null,Sc=new Map,Tf=function(){function M(){}return Object.defineProperty(M,"onmessage",{set:function(z){self.onmessage=function(j){if($o(j)){var ne=j.data,ce=ne.type,le=ne.payload;z(ce,le)}}},enumerable:!1,configurable:!0}),M.addEventListener=function(z){var j=Sc.get(z);j||(j=function(ne){if($o(ne)){var ce=ne.data,le=ce.type,lt=ce.payload;z(le,lt)}}),self.addEventListener("message",j)},M.removeEventListener=function(z){var j=Sc.get(z);Sc.delete(z),self.removeEventListener("message",j)},M.postMessage=function(z,j){if(self){var ne={source:"Worker thread",type:z,payload:j},ce=Cs(j);self.postMessage(ne,ce)}},M}(),Su=null;function $o(M){var z=M.type,j=M.data;return z==="message"&&j&&typeof j.source=="string"&&j.source==="Main thread"}function ea(M){return JSON.parse(Qs(M))}function Qs(M){var z=new Set;return JSON.stringify(M,function(j,ne){if(typeof ne=="object"&&ne!==null){if(z.has(ne))try{return JSON.parse(JSON.stringify(ne))}catch(ce){return}z.add(ne)}return ne})}function Tu(M){return""+M.name}function Ga(M,z){z===void 0&&(z={});var j=z[M.id]||{},ne=M.name+".worker.js",ce=j.workerUrl;return z._workerType==="test"&&(ce=M.module+"/dist/"+ne),ce||(ce="https://unpkg.com/"+M.module+"/dist/"+ne),assert(ce),ce}var Ml=function(M,z,j,ne){function ce(le){return le instanceof j?le:new j(function(lt){lt(le)})}return new(j||(j=Promise))(function(le,lt){function it(er){try{ht(ne.next(er))}catch(yr){lt(yr)}}function Yt(er){try{ht(ne.throw(er))}catch(yr){lt(yr)}}function ht(er){er.done?le(er.value):ce(er.value).then(it,Yt)}ht((ne=ne.apply(M,z||[])).next())})},al=function(M,z){var j={label:0,sent:function(){if(le[0]&1)throw le[1];return le[1]},trys:[],ops:[]},ne,ce,le,lt;return lt={next:it(0),throw:it(1),return:it(2)},typeof Symbol=="function"&&(lt[Symbol.iterator]=function(){return this}),lt;function it(ht){return function(er){return Yt([ht,er])}}function Yt(ht){if(ne)throw new TypeError("Generator is already executing.");for(;j;)try{if(ne=1,ce&&(le=ht[0]&2?ce.return:ht[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,ht[1])).done)return le;switch(ce=0,le&&(ht=[ht[0]&2,le.value]),ht[0]){case 0:case 1:le=ht;break;case 4:return j.label++,{value:ht[1],done:!1};case 5:j.label++,ce=ht[1],ht=[0];continue;case 7:ht=j.ops.pop(),j.trys.pop();continue;default:if(le=j.trys,!(le=le.length>0&&le[le.length-1])&&(ht[0]===6||ht[0]===2)){j=0;continue}if(ht[0]===3&&(!le||ht[1]>le[0]&&ht[1]<le[3])){j.label=ht[1];break}if(ht[0]===6&&j.label<le[1]){j.label=le[1],le=ht;break}if(le&&j.label<le[2]){j.label=le[2],j.ops.push(ht);break}le[2]&&j.ops.pop(),j.trys.pop();continue}ht=z.call(M,j)}catch(er){ht=[6,er],ce=0}finally{ne=le=0}if(ht[0]&5)throw ht[1];return{value:ht[0]?ht[1]:void 0,done:!0}}};function lu(M,z){return WorkerFarm.isSupported()?M.worker&&(z==null?void 0:z.worker):!1}function es(M,z,j,ne){return j===void 0&&(j={}),ne===void 0&&(ne={}),Ml(this,void 0,void 0,function(){var ce,le,lt,it,Yt,ht,er,yr;return al(this,function(_n){switch(_n.label){case 0:return ce=getWorkerName(M),le=getWorkerURL(M,j),lt=WorkerFarm.getWorkerFarm(j),it=lt.getWorkerPool({name:ce,url:le}),Yt=j.jobName||M.name,[4,it.startJob(Yt,ic.bind(null,ne))];case 1:return ht=_n.sent(),er=removeNontransferableOptions(j),ht.postMessage("process",{input:z,options:er}),[4,ht.result];case 2:return yr=_n.sent(),[2,yr.result]}})})}function ic(M,z,j,ne){return Ml(this,void 0,void 0,function(){var ce,le,lt,it,Yt,ht,er;return al(this,function(yr){switch(yr.label){case 0:switch(ce=j,ce){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return z.done(ne),[3,9];case 2:return z.error(new Error(ne.error)),[3,9];case 3:le=ne.id,lt=ne.input,it=ne.options,yr.label=4;case 4:return yr.trys.push([4,6,,7]),M.process?[4,M.process(lt,it)]:(z.postMessage("error",{id:le,error:"Worker not set up to process on main thread"}),[2]);case 5:return Yt=yr.sent(),z.postMessage("done",{id:le,result:Yt}),[3,7];case 6:return ht=yr.sent(),er=ht instanceof Error?ht.message:"unknown error",z.postMessage("error",{id:le,error:er}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+j),yr.label=9;case 9:return[2]}})})}var Ci=function(){function M(){this._values=[],this._settlers=[],this._closed=!1}return M.prototype[Symbol.asyncIterator]=function(){return this},M.prototype.push=function(z){return this.enqueue(z)},M.prototype.enqueue=function(z){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var j=this._settlers.shift();z instanceof Error?j.reject(z):j.resolve({value:z})}else this._values.push(z)},M.prototype.close=function(){for(;this._settlers.length>0;){var z=this._settlers.shift();z.resolve({done:!0})}this._closed=!0},M.prototype.next=function(){var z=this;if(this._values.length>0){var j=this._values.shift();return j instanceof Error?Promise.reject(j):Promise.resolve({done:!1,value:j})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(ne,ce){z._settlers.push({resolve:ne,reject:ce})})},M}(),rn=null,cu=function(M,z,j,ne){function ce(le){return le instanceof j?le:new j(function(lt){lt(le)})}return new(j||(j=Promise))(function(le,lt){function it(er){try{ht(ne.next(er))}catch(yr){lt(yr)}}function Yt(er){try{ht(ne.throw(er))}catch(yr){lt(yr)}}function ht(er){er.done?le(er.value):ce(er.value).then(it,Yt)}ht((ne=ne.apply(M,z||[])).next())})},ws=function(M,z){var j={label:0,sent:function(){if(le[0]&1)throw le[1];return le[1]},trys:[],ops:[]},ne,ce,le,lt;return lt={next:it(0),throw:it(1),return:it(2)},typeof Symbol=="function"&&(lt[Symbol.iterator]=function(){return this}),lt;function it(ht){return function(er){return Yt([ht,er])}}function Yt(ht){if(ne)throw new TypeError("Generator is already executing.");for(;j;)try{if(ne=1,ce&&(le=ht[0]&2?ce.return:ht[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,ht[1])).done)return le;switch(ce=0,le&&(ht=[ht[0]&2,le.value]),ht[0]){case 0:case 1:le=ht;break;case 4:return j.label++,{value:ht[1],done:!1};case 5:j.label++,ce=ht[1],ht=[0];continue;case 7:ht=j.ops.pop(),j.trys.pop();continue;default:if(le=j.trys,!(le=le.length>0&&le[le.length-1])&&(ht[0]===6||ht[0]===2)){j=0;continue}if(ht[0]===3&&(!le||ht[1]>le[0]&&ht[1]<le[3])){j.label=ht[1];break}if(ht[0]===6&&j.label<le[1]){j.label=le[1],le=ht;break}if(le&&j.label<le[2]){j.label=le[2],j.ops.push(ht);break}le[2]&&j.ops.pop(),j.trys.pop();continue}ht=z.call(M,j)}catch(er){ht=[6,er],ce=0}finally{ne=le=0}if(ht[0]&5)throw ht[1];return{value:ht[0]?ht[1]:void 0,done:!0}}},fu=function(M){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var z=M[Symbol.asyncIterator],j;return z?z.call(M):(M=typeof __values=="function"?__values(M):M[Symbol.iterator](),j={},ne("next"),ne("throw"),ne("return"),j[Symbol.asyncIterator]=function(){return this},j);function ne(le){j[le]=M[le]&&function(lt){return new Promise(function(it,Yt){lt=M[le](lt),ce(it,Yt,lt.done,lt.value)})}}function ce(le,lt,it,Yt){Promise.resolve(Yt).then(function(ht){le({value:ht,done:it})},lt)}},Ro=0,Fs,ku;function Il(M,z){var j=this;if(typeof self!="undefined"){var ne={process:Na};WorkerBody.onmessage=function(ce,le){return cu(j,void 0,void 0,function(){var lt,it,Yt,ht,er,yr,_n,vn,Jr,Gn,Xn;return ws(this,function(Yn){switch(Yn.label){case 0:switch(Yn.trys.push([0,19,,20]),lt=ce,lt){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!M)throw new Error("Worker does not support atomic processing");return[4,M(le.input,le.options||{},ne)];case 2:return it=Yn.sent(),WorkerBody.postMessage("done",{result:it}),[3,18];case 3:if(!z)throw new Error("Worker does not support batched processing");Fs=new AsyncQueue,ku=le.options||{},Yt=z(Fs,ku,ne),Yn.label=4;case 4:Yn.trys.push([4,9,10,15]),ht=fu(Yt),Yn.label=5;case 5:return[4,ht.next()];case 6:if(er=Yn.sent(),!!er.done)return[3,8];yr=er.value,WorkerBody.postMessage("output-batch",{result:yr}),Yn.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return _n=Yn.sent(),Gn={error:_n},[3,15];case 10:return Yn.trys.push([10,,13,14]),er&&!er.done&&(Xn=ht.return)?[4,Xn.call(ht)]:[3,12];case 11:Yn.sent(),Yn.label=12;case 12:return[3,14];case 13:if(Gn)throw Gn.error;return[7];case 14:return[7];case 15:return WorkerBody.postMessage("done",{}),[3,18];case 16:return Fs.push(le.input),[3,18];case 17:return Fs.close(),[3,18];case 18:return[3,20];case 19:return vn=Yn.sent(),Jr=vn instanceof Error?vn.message:"",WorkerBody.postMessage("error",{error:Jr}),[3,20];case 20:return[2]}})})}}}function Na(M,z){return z===void 0&&(z={}),new Promise(function(j,ne){var ce=Ro++,le=function(it,Yt){if(Yt.id===ce)switch(it){case"done":WorkerBody.removeEventListener(le),j(Yt.result);break;case"error":WorkerBody.removeEventListener(le),ne(Yt.error);break;default:}};WorkerBody.addEventListener(le);var lt={id:ce,input:M,options:z};WorkerBody.postMessage("process",lt)})}var No=function(M,z,j,ne){function ce(le){return le instanceof j?le:new j(function(lt){lt(le)})}return new(j||(j=Promise))(function(le,lt){function it(er){try{ht(ne.next(er))}catch(yr){lt(yr)}}function Yt(er){try{ht(ne.throw(er))}catch(yr){lt(yr)}}function ht(er){er.done?le(er.value):ce(er.value).then(it,Yt)}ht((ne=ne.apply(M,z||[])).next())})},ao=function(M,z){var j={label:0,sent:function(){if(le[0]&1)throw le[1];return le[1]},trys:[],ops:[]},ne,ce,le,lt;return lt={next:it(0),throw:it(1),return:it(2)},typeof Symbol=="function"&&(lt[Symbol.iterator]=function(){return this}),lt;function it(ht){return function(er){return Yt([ht,er])}}function Yt(ht){if(ne)throw new TypeError("Generator is already executing.");for(;j;)try{if(ne=1,ce&&(le=ht[0]&2?ce.return:ht[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,ht[1])).done)return le;switch(ce=0,le&&(ht=[ht[0]&2,le.value]),ht[0]){case 0:case 1:le=ht;break;case 4:return j.label++,{value:ht[1],done:!1};case 5:j.label++,ce=ht[1],ht=[0];continue;case 7:ht=j.ops.pop(),j.trys.pop();continue;default:if(le=j.trys,!(le=le.length>0&&le[le.length-1])&&(ht[0]===6||ht[0]===2)){j=0;continue}if(ht[0]===3&&(!le||ht[1]>le[0]&&ht[1]<le[3])){j.label=ht[1];break}if(ht[0]===6&&j.label<le[1]){j.label=le[1],le=ht;break}if(le&&j.label<le[2]){j.label=le[2],j.ops.push(ht);break}le[2]&&j.ops.pop(),j.trys.pop();continue}ht=z.call(M,j)}catch(er){ht=[6,er],ce=0}finally{ne=le=0}if(ht[0]&5)throw ht[1];return{value:ht[0]?ht[1]:void 0,done:!0}}},ol={};function sl(M,z,j){return z===void 0&&(z=null),j===void 0&&(j={}),No(this,void 0,void 0,function(){return ao(this,function(ne){switch(ne.label){case 0:return z&&(M=ul(M,z,j)),ol[M]=ol[M]||hu(M),[4,ol[M]];case 1:return[2,ne.sent()]}})})}function ul(M,z,j){if(M.startsWith("http"))return M;var ne=j.modules||{};return ne[M]?ne[M]:j.CDN?(assert(j.CDN.startsWith("http")),j.CDN+"/"+z+"/dist/libs/"+M):isWorker?"../src/libs/"+M:"modules/"+z+"/src/libs/"+M}function hu(M){return No(this,void 0,void 0,function(){var z,j,ne;return ao(this,function(ce){switch(ce.label){case 0:return M.endsWith("wasm")?[4,fetch(M)]:[3,3];case 1:return z=ce.sent(),[4,z.arrayBuffer()];case 2:return[2,ce.sent()];case 3:return isWorker?[2,importScripts(M)]:[4,fetch(M)];case 4:return j=ce.sent(),[4,j.text()];case 5:return ne=ce.sent(),[2,Tc(ne,M)]}})})}function Tc(M,z){if(isWorker)return eval.call(global,M),null;var j=document.createElement("script");j.id=z;try{j.appendChild(document.createTextNode(M))}catch(ne){j.text=M}return document.body.appendChild(j),null}var ll="0.0.3",Kc={id:"null",name:"null",module:"web-worker-helper",options:{}};function ac(M){var z=M.color;return!z||!z.length?[1,1,1,1]:z}function Vi(M,z,j){return j.length===2?[j[0],j[1],0]:[j[0],j[1],j[2]]}function Ol(M){var z=M.filter;return z?[1]:[0]}function Pl(M,z){return[z]}var yo=_(9187),Gu=_.n(yo),Ii=_(31437),Ns=Ii.Ue(),cl=Ii.Ue(),eo=Ii.Ue(),Wo=Ii.Ue(),Wl=Ii.Ue();function oc(M,z,j,ne,ce){Ii.IH(M,j,ne),Ii.Fv(M,M),z=Ii.al(-M[1],M[0]);var le=Ii.al(-j[1],j[0]);return[ce/Ii.AK(z,le),z]}function Ra(M,z){return Ii.t8(M,-z[1],z[0])}function Gl(M,z,j){return Ii.lu(M,z,j),Ii.Fv(M,M),M}function l(M,z){return M[0]===z[0]&&M[1]===z[1]}function d(M){for(var z=new Map,j=0;j<M.length;j++){var ne=M[0].toString()+"-"+M[1].toString();z.get(ne)?(M.splice(j,1),j++):z.set(ne,ne)}return M}var f=function(){function M(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,C.Z)(this,M),(0,qa.Z)(this,"lastFlip",-1),(0,qa.Z)(this,"miter",Ii.al(0,0)),(0,qa.Z)(this,"started",!1),(0,qa.Z)(this,"dash",!1),(0,qa.Z)(this,"totalDistance",0),(0,qa.Z)(this,"currentIndex",0),this.join=z.join||"miter",this.cap=z.cap||"butt",this.miterLimit=z.miterLimit||10,this.thickness=z.thickness||1,this.dash=z.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,O.Z)(M,[{key:"extrude_gaode2",value:function(j,ne){var ce=this.complex;if(j.length<=1)return ce;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var le=j.length,lt=ce.startIndex,it=1;it<le;it++){var Yt,ht,er,yr=j[it-1];yr.push((Yt=ne[it-1][2])!==null&&Yt!==void 0?Yt:0);var _n=ne[it-1],vn=j[it];vn.push((ht=ne[it][2])!==null&&ht!==void 0?ht:0);var Jr=ne[it],Gn=it<j.length-1?[].concat((0,dr.Z)(j[it+1]),[(er=ne[it+1][2])!==null&&er!==void 0?er:0]):null,Xn=it<ne.length-1?ne[it+1]:null,Yn=this.segment_gaode2(ce,lt,yr,vn,Gn,_n,Jr,Xn);lt+=Yn}if(this.dash)for(var gi=0;gi<ce.positions.length/6;gi++)ce.positions[gi*6+5]=this.totalDistance;return ce.startIndex=ce.positions.length/6,ce}},{key:"simpleExtrude_gaode2",value:function(j,ne){var ce=this.complex;if(j.length<=1)return ce;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var le=j.length,lt=ce.startIndex,it=1;it<le;it++){var Yt,ht,er,yr=j[it-1];yr.push((Yt=ne[it-1][2])!==null&&Yt!==void 0?Yt:0);var _n=ne[it-1],vn=j[it];vn.push((ht=ne[it][2])!==null&&ht!==void 0?ht:0);var Jr=ne[it],Gn=it<j.length-1?[].concat((0,dr.Z)(j[it+1]),[(er=ne[it+1][2])!==null&&er!==void 0?er:0]):null,Xn=it<ne.length-1?ne[it+1]:null,Yn=this.simpleSegment(ce,lt,yr,vn,Gn,_n,Jr,Xn);lt+=Yn}if(this.dash)for(var gi=0;gi<ce.positions.length/6;gi++)ce.positions[gi*6+5]=this.totalDistance;return ce.startIndex=ce.positions.length/6,ce}},{key:"extrude",value:function(j){var ne=this.complex;if(j.length<=1)return ne;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var ce=j.length,le=ne.startIndex,lt=1;lt<ce;lt++){var it=j[lt-1],Yt=j[lt],ht=lt<j.length-1?j[lt+1]:null,er=this.segment(ne,le,it,Yt,ht);le+=er}if(this.dash)for(var yr=0;yr<ne.positions.length/6;yr++)ne.positions[yr*6+5]=this.totalDistance;return ne.startIndex=ne.positions.length/6,ne}},{key:"simpleExtrude",value:function(j){var ne=this.complex;if(j.length<=1)return ne;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var ce=j.length,le=ne.startIndex,lt=1;lt<ce;lt++){var it=j[lt-1],Yt=j[lt],ht=lt<j.length-1?j[lt+1]:null,er=this.simpleSegment(ne,le,it,Yt,ht);le+=er}if(this.dash)for(var yr=0;yr<ne.positions.length/6;yr++)ne.positions[yr*6+5]=this.totalDistance;return ne.startIndex=ne.positions.length/6,ne}},{key:"segment_gaode2",value:function(j,ne,ce,le,lt,it,Yt,ht){var er=0,yr=j.indices,_n=j.positions,vn=j.normals,Jr=this.cap==="square",Gn=this.join==="bevel",Xn=ds([Yt[0],Yt[1]]),Yn=ds([it[0],it[1]]);Gl(eo,le,ce);var gi=0;if(this.dash&&(gi=this.lineSegmentDistance(Xn,Yn),this.totalDistance+=gi),this.normal||(this.normal=Ii.Ue(),Ra(this.normal,eo)),!this.started)if(this.started=!0,Jr){var xi=Ii.Ue(),Ni=Ii.Ue();Ii.IH(xi,this.normal,eo),Ii.IH(Ni,this.normal,eo),vn.push(Ni[0],Ni[1],0),vn.push(xi[0],xi[1],0),_n.push(ce[0],ce[1],ce[2]|0,this.totalDistance-gi,-this.thickness,ce[2]|0),this.complex.indexes.push(this.currentIndex),_n.push(ce[0],ce[1],ce[2]|0,this.totalDistance-gi,this.thickness,ce[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(_n,vn,ce,this.normal,this.thickness,this.totalDistance-gi);if(yr.push(ne+0,ne+1,ne+2),lt){l(le,lt)&&Ii.IH(lt,le,Ii.Fv(lt,Ii.$X(lt,le,ce))),Gl(Wo,lt,le);var Mo=oc(Wl,Ii.Ue(),eo,Wo,this.thickness),ga=(0,wt.Z)(Mo,2),Xi=ga[0],da=ga[1],Go=Ii.AK(Wl,this.normal)<0?-1:1,ls=Gn;if(!ls&&this.join==="miter"){var Uo=Xi;Uo>this.miterLimit&&(ls=!0)}ls?(vn.push(this.normal[0],this.normal[1],0),vn.push(da[0],da[1],0),_n.push(le[0],le[1],le[2]|0,this.totalDistance,-this.thickness*Go,le[2]|0),this.complex.indexes.push(this.currentIndex),_n.push(le[0],le[1],le[2]|0,this.totalDistance,this.thickness*Go,le[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,yr.push.apply(yr,(0,dr.Z)(this.lastFlip!==-Go?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),yr.push(ne+2,ne+3,ne+4),Ra(Ns,Wo),Ii.JG(this.normal,Ns),vn.push(this.normal[0],this.normal[1],0),_n.push(le[0],le[1],le[2]|0,this.totalDistance,-this.thickness*Go,le[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,er+=3):(this.extrusions(_n,vn,le,da,Xi,this.totalDistance),yr.push.apply(yr,(0,dr.Z)(this.lastFlip===1?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),Go=-1,Ii.JG(this.normal,da),er+=2),this.lastFlip=Go}else{if(Ra(this.normal,eo),Jr){var Pa=Ii.Ue(),Ua=Ii.Ue();Ii.lu(Ua,eo,this.normal),Ii.IH(Pa,eo,this.normal),vn.push(Ua[0],Ua[1],0),vn.push(Pa[0],Pa[1],0),_n.push(le[0],le[1],le[2]|0,this.totalDistance,this.thickness,le[2]|0),this.complex.indexes.push(this.currentIndex),_n.push(le[0],le[1],le[2]|0,this.totalDistance,this.thickness,le[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(_n,vn,le,this.normal,this.thickness,this.totalDistance);yr.push.apply(yr,(0,dr.Z)(this.lastFlip===1?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),er+=2}return er}},{key:"simpleSegment",value:function(j,ne,ce,le,lt){var it=0,Yt=j.indices,ht=j.positions,er=j.normals,yr=ds([le[0],le[1]]),_n=ds([ce[0],ce[1]]);Gl(eo,yr,_n);var vn=0;if(this.dash&&(vn=this.lineSegmentDistance(yr,_n),this.totalDistance+=vn),this.normal||(this.normal=Ii.Ue(),Ra(this.normal,eo)),this.started||(this.started=!0,this.extrusions(ht,er,ce,this.normal,this.thickness,this.totalDistance-vn)),Yt.push(ne+0,ne+1,ne+2),!lt)Ra(this.normal,eo),this.extrusions(ht,er,le,this.normal,this.thickness,this.totalDistance),Yt.push.apply(Yt,(0,dr.Z)(this.lastFlip===1?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),it+=2;else{var Jr=ds([lt[0],lt[1]]);l(yr,Jr)&&Ii.IH(Jr,yr,Ii.Fv(Jr,Ii.$X(Jr,yr,_n))),Gl(Wo,Jr,yr);var Gn=oc(Wl,Ii.Ue(),eo,Wo,this.thickness),Xn=(0,wt.Z)(Gn,2),Yn=Xn[0],gi=Xn[1],xi=Ii.AK(Wl,this.normal)<0?-1:1;this.extrusions(ht,er,le,gi,Yn,this.totalDistance),Yt.push.apply(Yt,(0,dr.Z)(this.lastFlip===1?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),xi=-1,Ii.JG(this.normal,gi),it+=2,this.lastFlip=xi}return it}},{key:"segment",value:function(j,ne,ce,le,lt){var it=0,Yt=j.indices,ht=j.positions,er=j.normals,yr=this.cap==="square",_n=this.join==="bevel",vn=ds([le[0],le[1]]),Jr=ds([ce[0],ce[1]]);Gl(eo,vn,Jr);var Gn=0;if(this.dash&&(Gn=this.lineSegmentDistance(vn,Jr),this.totalDistance+=Gn),this.normal||(this.normal=Ii.Ue(),Ra(this.normal,eo)),!this.started)if(this.started=!0,yr){var Xn=Ii.Ue(),Yn=Ii.Ue();Ii.IH(Xn,this.normal,eo),Ii.IH(Yn,this.normal,eo),er.push(Yn[0],Yn[1],0),er.push(Xn[0],Xn[1],0),ht.push(ce[0],ce[1],ce[2]|0,this.totalDistance-Gn,-this.thickness,ce[2]|0),this.complex.indexes.push(this.currentIndex),ht.push(ce[0],ce[1],ce[2]|0,this.totalDistance-Gn,this.thickness,ce[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(ht,er,ce,this.normal,this.thickness,this.totalDistance-Gn);if(Yt.push(ne+0,ne+1,ne+2),lt){var Ni=ds([lt[0],lt[1]]);l(vn,Ni)&&Ii.IH(Ni,vn,Ii.Fv(Ni,Ii.$X(Ni,vn,Jr))),Gl(Wo,Ni,vn);var Pa=oc(Wl,Ii.Ue(),eo,Wo,this.thickness),Ua=(0,wt.Z)(Pa,2),Mo=Ua[0],ga=Ua[1],Xi=Ii.AK(Wl,this.normal)<0?-1:1,da=_n;if(!da&&this.join==="miter"){var Go=Mo;Go>this.miterLimit&&(da=!0)}da?(er.push(this.normal[0],this.normal[1],0),er.push(ga[0],ga[1],0),ht.push(le[0],le[1],le[2]|0,this.totalDistance,-this.thickness*Xi,le[2]|0),this.complex.indexes.push(this.currentIndex),ht.push(le[0],le[1],le[2]|0,this.totalDistance,this.thickness*Xi,le[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,Yt.push.apply(Yt,(0,dr.Z)(this.lastFlip!==-Xi?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),Yt.push(ne+2,ne+3,ne+4),Ra(Ns,Wo),Ii.JG(this.normal,Ns),er.push(this.normal[0],this.normal[1],0),ht.push(le[0],le[1],le[2]|0,this.totalDistance,-this.thickness*Xi,le[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,it+=3):(this.extrusions(ht,er,le,ga,Mo,this.totalDistance),Yt.push.apply(Yt,(0,dr.Z)(this.lastFlip===1?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),Xi=-1,Ii.JG(this.normal,ga),it+=2),this.lastFlip=Xi}else{if(Ra(this.normal,eo),yr){var gi=Ii.Ue(),xi=Ii.Ue();Ii.lu(xi,eo,this.normal),Ii.IH(gi,eo,this.normal),er.push(xi[0],xi[1],0),er.push(gi[0],gi[1],0),ht.push(le[0],le[1],le[2]|0,this.totalDistance,this.thickness,le[2]|0),this.complex.indexes.push(this.currentIndex),ht.push(le[0],le[1],le[2]|0,this.totalDistance,this.thickness,le[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(ht,er,le,this.normal,this.thickness,this.totalDistance);Yt.push.apply(Yt,(0,dr.Z)(this.lastFlip===1?[ne,ne+2,ne+3]:[ne+2,ne+1,ne+3])),it+=2}return it}},{key:"extrusions",value:function(j,ne,ce,le,lt,it){ne.push(le[0],le[1],0),ne.push(le[0],le[1],0),j.push(ce[0],ce[1],ce[2]|0,it,-lt,ce[2]|0),this.complex.indexes.push(this.currentIndex),j.push(ce[0],ce[1],ce[2]|0,it,lt,ce[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(j,ne){var ce=ne[0]-j[0],le=ne[1]-j[1];return Math.sqrt(ce*ce+le*le)}}]),M}();function m(M){var z=M.coordinates,j=M.originCoordinates,ne=M.version,ce=new f({dash:!0,join:"bevel"});if(ne==="GAODE2.x"){var le=z;Array.isArray(le[0][0])||(le=[z]);var lt=j;Array.isArray(lt[0][0])||(lt=[j]);for(var it=0;it<le.length;it++){var Yt=le[it],ht=lt[it];ce.extrude_gaode2(Yt,ht)}}else{var er=z;er[0]&&!Array.isArray(er[0][0])&&(er=[z]),er.forEach(function(_n){ce.extrude(_n)})}var yr=ce.complex;return{vertices:yr.positions,indices:yr.indices,normals:yr.normals,indexes:yr.indexes,size:6}}function S(M){var z=Pf(M.coordinates);return{vertices:[].concat((0,dr.Z)(z),(0,dr.Z)(z),(0,dr.Z)(z),(0,dr.Z)(z)),indices:[0,1,2,2,3,0],size:z.length}}function R(M){var z=M.coordinates,j=Gu().flatten(z),ne=j.vertices,ce=j.dimensions,le=j.holes,lt=Gu()(ne,le,ce);return{indices:lt,vertices:ne,size:ce}}var L=function(){var M=(0,ou.Z)(Vu().mark(function z(j){var ne,ce,le,lt,it,Yt,ht,er,yr;return Vu().wrap(function(vn){for(;;)switch(vn.prev=vn.next){case 0:return ne=j.descriptors,ce=j.features,le=j.enablePicking,lt=j.iconMap,it={a_Color:ac,a_Position:Vi,filter:Ol,a_vertexId:Pl,a_PickingColor:function(Gn){var Xn=Gn.id;return le?gr(Xn):[0,0,0]},a_DistanceAndIndex:function(Gn,Xn,Yn,gi,xi,Ni){return Ni===void 0?[Yn[3],10]:[Yn[3],Ni]},a_Total_Distance:function(Gn,Xn,Yn){return[Yn[5]]},a_Size:function(Gn){var Xn=Gn.size,Yn=Xn===void 0?1:Xn;return Array.isArray(Yn)?[Yn[0],Yn[1]]:[Yn,0]},a_Normal:function(Gn,Xn,Yn,gi,xi){return xi},a_Miter:function(Gn,Xn,Yn){return[Yn[4]]},a_iconMapUV:function(Gn){var Xn=Gn.texture,Yn=lt[Xn]||{x:0,y:0},gi=Yn.x,xi=Yn.y;return[gi,xi]}},Yt={sizePerElement:0,elements:[]},ht=0,er=[],yr=3,ce.forEach(function(Jr,Gn){var Xn=m(Jr),Yn=Xn.indices,gi=Xn.vertices,xi=Xn.normals,Ni=Xn.size,Pa=Xn.indexes;Yn.forEach(function(Xi){er.push(Xi+ht)}),yr=Ni;var Ua=gi.length/Ni;Yt.sizePerElement=yr,Yt.elements.push({featureIdx:Gn,vertices:gi,normals:xi,offset:ht}),ht+=Ua;for(var Mo=function(da){var Go=(xi==null?void 0:xi.slice(da*3,da*3+3))||[],ls=gi.slice(da*Ni,da*Ni+Ni),Uo=0;Pa&&Pa[da]!==void 0&&(Uo=Pa[da]),ne.forEach(function(Xo){if(Xo&&it[Xo.name]){var Rs;(Rs=Xo.buffer.data).push.apply(Rs,(0,dr.Z)(it[Xo.name](Jr,Gn,ls,da,Go,Uo)))}})},ga=0;ga<Ua;ga++)Mo(ga)}),vn.abrupt("return",{descriptors:ne,featureLayout:Yt,indices:er});case 8:case"end":return vn.stop()}},z)}));return function(j){return M.apply(this,arguments)}}(),q=function(){var M=(0,ou.Z)(Vu().mark(function z(j){var ne,ce,le,lt,it,Yt,ht,er,yr;return Vu().wrap(function(vn){for(;;)switch(vn.prev=vn.next){case 0:return ne=j.descriptors,ce=j.features,le=j.enablePicking,lt=j.shape2d,it={a_Color:ac,a_Position:Vi,filter:Ol,a_vertexId:Pl,a_PickingColor:function(Gn){var Xn=Gn.id;return le?gr(Xn):[0,0,0]},a_Shape:function(Gn){var Xn=Gn.shape,Yn=Xn===void 0?2:Xn,gi=lt.indexOf(Yn);return[gi]},a_Extrude:function(Gn,Xn,Yn,gi){var xi=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],Ni=gi%4*3;return[xi[Ni],xi[Ni+1],xi[Ni+2]]},a_Size:function(Gn){var Xn=Gn.size,Yn=Xn===void 0?5:Xn;return Array.isArray(Yn)?[Yn[0]]:[Yn]}},Yt={sizePerElement:0,elements:[]},ht=0,er=[],yr=3,ce.forEach(function(Jr,Gn){var Xn=S(Jr),Yn=Xn.indices,gi=Xn.vertices,xi=Xn.normals,Ni=Xn.size,Pa=Xn.indexes;Yn.forEach(function(Xi){er.push(Xi+ht)}),yr=Ni;var Ua=gi.length/Ni;Yt.sizePerElement=yr,Yt.elements.push({featureIdx:Gn,vertices:gi,normals:xi,offset:ht}),ht+=Ua;for(var Mo=function(da){var Go=(xi==null?void 0:xi.slice(da*3,da*3+3))||[],ls=gi.slice(da*Ni,da*Ni+Ni),Uo=0;Pa&&Pa[da]!==void 0&&(Uo=Pa[da]),ne.forEach(function(Xo){if(Xo&&it[Xo.name]){var Rs;(Rs=Xo.buffer.data).push.apply(Rs,(0,dr.Z)(it[Xo.name](Jr,Gn,ls,da,Go,Uo)))}})},ga=0;ga<Ua;ga++)Mo(ga)}),vn.abrupt("return",{descriptors:ne,featureLayout:Yt,indices:er});case 8:case"end":return vn.stop()}},z)}));return function(j){return M.apply(this,arguments)}}(),Se=function(){var M=(0,ou.Z)(Vu().mark(function z(j){var ne,ce,le,lt,it,Yt,ht,er;return Vu().wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:return ne=j.descriptors,ce=j.features,le=j.enablePicking,lt={a_Color:ac,a_Position:Vi,filter:Ol,a_vertexId:Pl,a_PickingColor:function(Jr){var Gn=Jr.id;return le?gr(Gn):[0,0,0]}},it={sizePerElement:0,elements:[]},Yt=0,ht=[],er=3,ce.forEach(function(vn,Jr){var Gn=R(vn),Xn=Gn.indices,Yn=Gn.vertices,gi=Gn.normals,xi=Gn.size,Ni=Gn.indexes;Xn.forEach(function(ga){ht.push(ga+Yt)}),er=xi;var Pa=Yn.length/xi;it.sizePerElement=er,it.elements.push({featureIdx:Jr,vertices:Yn,normals:gi,offset:Yt}),Yt+=Pa;for(var Ua=function(Xi){var da=(gi==null?void 0:gi.slice(Xi*3,Xi*3+3))||[],Go=Yn.slice(Xi*xi,Xi*xi+xi),ls=0;Ni&&Ni[Xi]!==void 0&&(ls=Ni[Xi]),ne.forEach(function(Uo){if(Uo&&lt[Uo.name]){var Xo;(Xo=Uo.buffer.data).push.apply(Xo,(0,dr.Z)(lt[Uo.name](vn,Jr,Go,Xi,da,ls)))}})},Mo=0;Mo<Pa;Mo++)Ua(Mo)}),_n.abrupt("return",{descriptors:ne,featureLayout:it,indices:ht});case 8:case"end":return _n.stop()}},z)}));return function(j){return M.apply(this,arguments)}}(),Le={pointFill:q,line:L,polygonFill:Se},et=(0,h.Z)({},Le);function ot(M){return st.apply(this,arguments)}function st(){return st=_asyncToGenerator(_regeneratorRuntime.mark(function M(z){var j,ne;return _regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(j=z.workerType,ne=z.data,!et[j]){le.next=3;break}return le.abrupt("return",et[j](ne));case 3:return le.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(j,'" non-existent.'))));case 4:case"end":return le.stop()}},M)})),st.apply(this,arguments)}var Rt=new Map;function Ct(M,z){Rt.set(M,z)}function Xt(M){var z=Rt.get(M);return z}var St="l7-worker",$t=3,tr=!0;function br(M){registerWorkerSource(St,M)}function kr(){var M=getWorkerSource(St);if(!M)throw new Error("get worker failed by workerName: ".concat(St,"."));return M}function Or(M,z){return Hr.apply(this,arguments)}function Hr(){return Hr=_asyncToGenerator(_regeneratorRuntime.mark(function M(z,j){var ne,ce,le,lt,it;return _regeneratorRuntime.wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return ne=kr(),ce=WorkerFarm.getWorkerFarm({maxConcurrency:$t,reuseWorkers:tr}),le=ce.getWorkerPool({name:St,source:ne}),ht.next=5,le.startJob(St,function(er,yr,_n){return er.done(_n)});case 5:return lt=ht.sent,lt.postMessage("process",{input:{workerType:z,data:j}}),ht.next=9,lt.result;case 9:return it=ht.sent,ht.abrupt("return",it.result);case 11:case"end":return ht.stop()}},M)})),Hr.apply(this,arguments)}function nn(M,z){return M==null?z:M}},72284:function(Ze,E,_){"use strict";_.d(E,{oT:function(){return Iu},Ie:function(){return Ei},dW:function(){return ba},GI:function(){return Fb},xs:function(){return kS}});var D={},N={},h=function(r){return N[r]},O=function(r,n){N[r]=n},C=function(r){return D[r]},P=function(r,n){D[r]=n},F={},Y={},V=34,Q=10,k=13;function K(e){return new Function("d","return {"+e.map(function(r,n){return JSON.stringify(r)+": d["+n+'] || ""'}).join(",")+"}")}function U(e,r){var n=K(e);return function(i,a){return r(n(i),a,e)}}function Z(e){var r=Object.create(null),n=[];return e.forEach(function(i){for(var a in i)a in r||n.push(r[a]=a)}),n}function J(e,r){var n=e+"",i=n.length;return i<r?new Array(r-i+1).join(0)+n:n}function H(e){return e<0?"-"+J(-e,6):e>9999?"+"+J(e,6):J(e,4)}function ve(e){var r=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":H(e.getUTCFullYear(),4)+"-"+J(e.getUTCMonth()+1,2)+"-"+J(e.getUTCDate(),2)+(a?"T"+J(r,2)+":"+J(n,2)+":"+J(i,2)+"."+J(a,3)+"Z":i?"T"+J(r,2)+":"+J(n,2)+":"+J(i,2)+"Z":n||r?"T"+J(r,2)+":"+J(n,2)+"Z":"")}function Te(e){var r=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(I,W){var pe,Me,Fe=a(I,function(ut,Ot){if(pe)return pe(ut,Ot-1);Me=ut,pe=W?U(ut,W):K(ut)});return Fe.columns=Me||[],Fe}function a(I,W){var pe=[],Me=I.length,Fe=0,ut=0,Ot,Bt=Me<=0,ir=!1;I.charCodeAt(Me-1)===Q&&--Me,I.charCodeAt(Me-1)===k&&--Me;function xr(){if(Bt)return Y;if(ir)return ir=!1,F;var Ir,mr=Fe,sn;if(I.charCodeAt(mr)===V){for(;Fe++<Me&&I.charCodeAt(Fe)!==V||I.charCodeAt(++Fe)===V;);return(Ir=Fe)>=Me?Bt=!0:(sn=I.charCodeAt(Fe++))===Q?ir=!0:sn===k&&(ir=!0,I.charCodeAt(Fe)===Q&&++Fe),I.slice(mr+1,Ir-1).replace(/""/g,'"')}for(;Fe<Me;){if((sn=I.charCodeAt(Ir=Fe++))===Q)ir=!0;else if(sn===k)ir=!0,I.charCodeAt(Fe)===Q&&++Fe;else if(sn!==n)continue;return I.slice(mr,Ir)}return Bt=!0,I.slice(mr,Me)}for(;(Ot=xr())!==Y;){for(var qr=[];Ot!==F&&Ot!==Y;)qr.push(Ot),Ot=xr();W&&(qr=W(qr,ut++))==null||pe.push(qr)}return pe}function s(I,W){return I.map(function(pe){return W.map(function(Me){return w(pe[Me])}).join(e)})}function c(I,W){return W==null&&(W=Z(I)),[W.map(w).join(e)].concat(s(I,W)).join(`
`)}function p(I,W){return W==null&&(W=Z(I)),s(I,W).join(`
`)}function g(I){return I.map(b).join(`
`)}function b(I){return I.map(w).join(e)}function w(I){return I==null?"":I instanceof Date?ve(I):r.test(I+="")?'"'+I.replace(/"/g,'""')+'"':I}return{parse:i,parseRows:a,format:c,formatBody:p,formatRows:g,formatRow:b,formatValue:w}}var ye=Te(","),Ve=ye.parse,Re=ye.parseRows,Ae=ye.format,ae=ye.formatBody,ee=ye.formatRows,me=ye.formatRow,ge=ye.formatValue,fe=_(1413),Et=_(1449);function xe(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function je(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ue(e){if(e.length>1&&isNumber(e[0])&&isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return ue(e[0]);throw new Error("coordinates must only contain numbers")}function Pe(e,r,n){if(!r||!n)throw new Error("type and name required");if(!e||e.type!==r)throw new Error("Invalid input to "+n+": must be a "+r+", given "+e.type)}function we(e,r,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==r)throw new Error("Invalid input to "+n+": must be a "+r+", given "+e.geometry.type)}function nt(e,r,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0,a=e.features;i<a.length;i++){var s=a[i];if(!s||s.type!=="Feature"||!s.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!s.geometry||s.geometry.type!==r)throw new Error("Invalid input to "+n+": must be a "+r+", given "+s.geometry.type)}}function at(e){return e.type==="Feature"?e.geometry:e}function vt(e,r){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}var Tt=_(39034),ze=_(57059),gr=_(38163),At=_.n(gr);function hn(e,r){return e.map(function(n){return n[r]*1})}function Wr(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function vr(e){return Array.isArray(e)?e.length===0?!1:!!Wr(e[0]):!1}function dn(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function tn(e){var r=Object.isFrozen(e)?ze.rU.cloneDeep(e):e;return At()(r,!0),r}function un(e,r){var n=r.x,i=r.y,a=r.x1,s=r.y1,c=r.coordinates,p=r.geometry,g=[];if(!Array.isArray(e))return{dataArray:[]};if(p)return e.filter(function(Ot){return Ot[p]&&Ot[p].type&&Ot[p].coordinates&&Ot[p].coordinates.length>0}).forEach(function(Ot,Bt){var ir=tn(Ot[p]);(0,Tt.nG)(ir,function(xr){var qr=je(xr),Ir=(0,fe.Z)((0,fe.Z)({},Ot),{},{_id:Bt,coordinates:qr});g.push(Ir)})}),{dataArray:g};for(var b=0;b<e.length;b++){var w=e[b],I=[];if(c){var W="Polygon";Array.isArray(c[0])||(W="Point"),Array.isArray(c[0])&&!Array.isArray(c[0][0])&&(W="LineString");var pe=tn({type:W,coordinates:w[c]});I=pe.coordinates}else if(n&&i&&a&&s){var Me=[parseFloat(w[n]),parseFloat(w[i])],Fe=[parseFloat(w[a]),parseFloat(w[s])];I=[Me,Fe]}else n&&i&&(I=[parseFloat(w[n]),parseFloat(w[i])]);var ut=(0,fe.Z)((0,fe.Z)({},w),{},{_id:b,coordinates:I});g.push(ut)}return{dataArray:g}}function yn(e,r){var n=Ve(e);return un(n,r)}function Vt(e){for(var r=e.toString(),n=5381,i=r.length;i;)n=n*33^r.charCodeAt(--i);return n>>>0}function dr(e,r){return r===void 0?null:typeof(e.properties[r]*1)=="number"?e.properties[r]*1:e.properties&&e.properties[r]?Vt(e.properties[r]+"")%1000019:null}function wt(e,r){var n=[],i={};return e.features?(e.features=e.features.filter(function(a){var s=a.geometry;return a!=null&&s&&s.type&&s.coordinates&&s.coordinates.length>0}),e=tn(e),e.features.length===0?{dataArray:[],featureKeys:i}:((0,Tt.nG)(e,function(a,s){var c=dr(a,r==null?void 0:r.featureId);c===null&&(c=s);var p=c,g=je(a),b=(0,fe.Z)((0,fe.Z)({},a.properties),{},{coordinates:g,_id:p});n.push(b)}),{dataArray:n,featureKeys:i})):(e.features=[],{dataArray:[]})}var He=_(15861),wr=_(64687),Ne=_.n(wr);function Xr(e,r,n,i){for(var a=i,s=n-r>>1,c=n-r,p,g=e[r],b=e[r+1],w=e[n],I=e[n+1],W=r+3;W<n;W+=3){var pe=Er(e[W],e[W+1],g,b,w,I);if(pe>a)p=W,a=pe;else if(pe===a){var Me=Math.abs(W-s);Me<c&&(p=W,c=Me)}}a>i&&(p-r>3&&Xr(e,r,p,i),e[p+2]=a,n-p>3&&Xr(e,p,n,i))}function Er(e,r,n,i,a,s){var c=a-n,p=s-i;if(c!==0||p!==0){var g=((e-n)*c+(r-i)*p)/(c*c+p*p);g>1?(n=a,i=s):g>0&&(n+=c*g,i+=p*g)}return c=e-n,p=r-i,c*c+p*p}function Ue(e,r,n,i){var a={id:typeof e=="undefined"?null:e,type:r,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return In(a),a}function In(e){var r=e.geometry,n=e.type;if(n==="Point"||n==="MultiPoint"||n==="LineString")an(e,r);else if(n==="Polygon"||n==="MultiLineString")for(var i=0;i<r.length;i++)an(e,r[i]);else if(n==="MultiPolygon")for(i=0;i<r.length;i++)for(var a=0;a<r[i].length;a++)an(e,r[i][a])}function an(e,r){for(var n=0;n<r.length;n+=3)e.minX=Math.min(e.minX,r[n]),e.minY=Math.min(e.minY,r[n+1]),e.maxX=Math.max(e.maxX,r[n]),e.maxY=Math.max(e.maxY,r[n+1])}function Qr(e,r){var n=[];if(e.type==="FeatureCollection")for(var i=0;i<e.features.length;i++)Dn(n,e.features[i],r,i);else e.type==="Feature"?Dn(n,e,r):Dn(n,{geometry:e},r);return n}function Dn(e,r,n,i){if(r.geometry){var a=r.geometry.coordinates,s=r.geometry.type,c=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),p=[],g=r.id;if(n.promoteId?g=r.properties[n.promoteId]:n.generateId&&(g=i||0),s==="Point")On(a,p);else if(s==="MultiPoint")for(var b=0;b<a.length;b++)On(a[b],p);else if(s==="LineString")ri(a,p,c,!1);else if(s==="MultiLineString")if(n.lineMetrics){for(b=0;b<a.length;b++)p=[],ri(a[b],p,c,!1),e.push(Ue(g,"LineString",p,r.properties));return}else zt(a,p,c,!1);else if(s==="Polygon")zt(a,p,c,!0);else if(s==="MultiPolygon")for(b=0;b<a.length;b++){var w=[];zt(a[b],w,c,!0),p.push(w)}else if(s==="GeometryCollection"){for(b=0;b<r.geometry.geometries.length;b++)Dn(e,{id:g,geometry:r.geometry.geometries[b],properties:r.properties},n,i);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(Ue(g,s,p,r.properties))}}function On(e,r){r.push(cr(e[0])),r.push(Zr(e[1])),r.push(0)}function ri(e,r,n,i){for(var a,s,c=0,p=0;p<e.length;p++){var g=cr(e[p][0]),b=Zr(e[p][1]);r.push(g),r.push(b),r.push(0),p>0&&(i?c+=(a*b-g*s)/2:c+=Math.sqrt(Math.pow(g-a,2)+Math.pow(b-s,2))),a=g,s=b}var w=r.length-3;r[2]=1,Xr(r,0,w,n),r[w+2]=1,r.size=Math.abs(c),r.start=0,r.end=r.size}function zt(e,r,n,i){for(var a=0;a<e.length;a++){var s=[];ri(e[a],s,n,i),r.push(s)}}function cr(e){return e/360+.5}function Zr(e){var r=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+r)/(1-r))/Math.PI;return n<0?0:n>1?1:n}function Kr(e,r,n,i,a,s,c,p){if(n/=r,i/=r,s>=n&&c<i)return e;if(c<n||s>=i)return null;for(var g=[],b=0;b<e.length;b++){var w=e[b],I=w.geometry,W=w.type,pe=a===0?w.minX:w.minY,Me=a===0?w.maxX:w.maxY;if(pe>=n&&Me<i){g.push(w);continue}else if(Me<n||pe>=i)continue;var Fe=[];if(W==="Point"||W==="MultiPoint")en(I,Fe,n,i,a);else if(W==="LineString")Wn(I,Fe,n,i,a,!1,p.lineMetrics);else if(W==="MultiLineString")X(I,Fe,n,i,a,!1);else if(W==="Polygon")X(I,Fe,n,i,a,!0);else if(W==="MultiPolygon")for(var ut=0;ut<I.length;ut++){var Ot=[];X(I[ut],Ot,n,i,a,!0),Ot.length&&Fe.push(Ot)}if(Fe.length){if(p.lineMetrics&&W==="LineString"){for(ut=0;ut<Fe.length;ut++)g.push(Ue(w.id,W,Fe[ut],w.tags));continue}(W==="LineString"||W==="MultiLineString")&&(Fe.length===1?(W="LineString",Fe=Fe[0]):W="MultiLineString"),(W==="Point"||W==="MultiPoint")&&(W=Fe.length===3?"Point":"MultiPoint"),g.push(Ue(w.id,W,Fe,w.tags))}}return g.length?g:null}function en(e,r,n,i,a){for(var s=0;s<e.length;s+=3){var c=e[s+a];c>=n&&c<=i&&(r.push(e[s]),r.push(e[s+1]),r.push(e[s+2]))}}function Wn(e,r,n,i,a,s,c){for(var p=De(e),g=a===0?Be:Ye,b=e.start,w,I,W=0;W<e.length-3;W+=3){var pe=e[W],Me=e[W+1],Fe=e[W+2],ut=e[W+3],Ot=e[W+4],Bt=a===0?pe:Me,ir=a===0?ut:Ot,xr=!1;c&&(w=Math.sqrt(Math.pow(pe-ut,2)+Math.pow(Me-Ot,2))),Bt<n?ir>n&&(I=g(p,pe,Me,ut,Ot,n),c&&(p.start=b+w*I)):Bt>i?ir<i&&(I=g(p,pe,Me,ut,Ot,i),c&&(p.start=b+w*I)):se(p,pe,Me,Fe),ir<n&&Bt>=n&&(I=g(p,pe,Me,ut,Ot,n),xr=!0),ir>i&&Bt<=i&&(I=g(p,pe,Me,ut,Ot,i),xr=!0),!s&&xr&&(c&&(p.end=b+w*I),r.push(p),p=De(e)),c&&(b+=w)}var qr=e.length-3;pe=e[qr],Me=e[qr+1],Fe=e[qr+2],Bt=a===0?pe:Me,Bt>=n&&Bt<=i&&se(p,pe,Me,Fe),qr=p.length-3,s&&qr>=3&&(p[qr]!==p[0]||p[qr+1]!==p[1])&&se(p,p[0],p[1],p[2]),p.length&&r.push(p)}function De(e){var r=[];return r.size=e.size,r.start=e.start,r.end=e.end,r}function X(e,r,n,i,a,s){for(var c=0;c<e.length;c++)Wn(e[c],r,n,i,a,s,!1)}function se(e,r,n,i){e.push(r),e.push(n),e.push(i)}function Be(e,r,n,i,a,s){var c=(s-r)/(i-r);return e.push(s),e.push(n+(a-n)*c),e.push(1),c}function Ye(e,r,n,i,a,s){var c=(s-n)/(a-n);return e.push(r+(i-r)*c),e.push(s),e.push(1),c}function ct(e,r){var n=r.buffer/r.extent,i=e,a=Kr(e,1,-1-n,n,0,-1,2,r),s=Kr(e,1,1-n,2+n,0,-1,2,r);return(a||s)&&(i=Kr(e,1,-n,1+n,0,-1,2,r)||[],a&&(i=sr(a,1).concat(i)),s&&(i=i.concat(sr(s,-1)))),i}function sr(e,r){for(var n=[],i=0;i<e.length;i++){var a=e[i],s=a.type,c;if(s==="Point"||s==="MultiPoint"||s==="LineString")c=ar(a.geometry,r);else if(s==="MultiLineString"||s==="Polygon"){c=[];for(var p=0;p<a.geometry.length;p++)c.push(ar(a.geometry[p],r))}else if(s==="MultiPolygon")for(c=[],p=0;p<a.geometry.length;p++){for(var g=[],b=0;b<a.geometry[p].length;b++)g.push(ar(a.geometry[p][b],r));c.push(g)}n.push(Ue(a.id,s,c,a.tags))}return n}function ar(e,r){var n=[];n.size=e.size,e.start!==void 0&&(n.start=e.start,n.end=e.end);for(var i=0;i<e.length;i+=3)n.push(e[i]+r,e[i+1],e[i+2]);return n}function or(e,r){if(e.transformed)return e;var n=1<<e.z,i=e.x,a=e.y,s,c,p;for(s=0;s<e.features.length;s++){var g=e.features[s],b=g.geometry,w=g.type;if(g.geometry=[],w===1)for(c=0;c<b.length;c+=2)g.geometry.push(Wt(b[c],b[c+1],r,n,i,a));else for(c=0;c<b.length;c++){var I=[];for(p=0;p<b[c].length;p+=2)I.push(Wt(b[c][p],b[c][p+1],r,n,i,a));g.geometry.push(I)}}return e.transformed=!0,e}function Wt(e,r,n,i,a,s){return[Math.round(n*(e*i-a)),Math.round(n*(r*i-s))]}function oe(e,r,n,i,a){for(var s=r===a.maxZoom?0:a.tolerance/((1<<r)*a.extent),c={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:r,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},p=0;p<e.length;p++){c.numFeatures++,ie(c,e[p],s,a);var g=e[p].minX,b=e[p].minY,w=e[p].maxX,I=e[p].maxY;g<c.minX&&(c.minX=g),b<c.minY&&(c.minY=b),w>c.maxX&&(c.maxX=w),I>c.maxY&&(c.maxY=I)}return c}function ie(e,r,n,i){var a=r.geometry,s=r.type,c=[];if(s==="Point"||s==="MultiPoint")for(var p=0;p<a.length;p+=3)c.push(a[p]),c.push(a[p+1]),e.numPoints++,e.numSimplified++;else if(s==="LineString")be(c,a,e,n,!1,!1);else if(s==="MultiLineString"||s==="Polygon")for(p=0;p<a.length;p++)be(c,a[p],e,n,s==="Polygon",p===0);else if(s==="MultiPolygon")for(var g=0;g<a.length;g++){var b=a[g];for(p=0;p<b.length;p++)be(c,b[p],e,n,!0,p===0)}if(c.length){var w=r.tags||null;if(s==="LineString"&&i.lineMetrics){w={};for(var I in r.tags)w[I]=r.tags[I];w.mapbox_clip_start=a.start/a.size,w.mapbox_clip_end=a.end/a.size}var W={geometry:c,type:s==="Polygon"||s==="MultiPolygon"?3:s==="LineString"||s==="MultiLineString"?2:1,tags:w};r.id!==null&&(W.id=r.id),e.features.push(W)}}function be(e,r,n,i,a,s){var c=i*i;if(i>0&&r.size<(a?c:i)){n.numPoints+=r.length/3;return}for(var p=[],g=0;g<r.length;g+=3)(i===0||r[g+2]>c)&&(n.numSimplified++,p.push(r[g]),p.push(r[g+1])),n.numPoints++;a&&ke(p,s),e.push(p)}function ke(e,r){for(var n=0,i=0,a=e.length,s=a-2;i<a;s=i,i+=2)n+=(e[i]-e[s])*(e[i+1]+e[s+1]);if(n>0===r)for(i=0,a=e.length;i<a/2;i+=2){var c=e[i],p=e[i+1];e[i]=e[a-2-i],e[i+1]=e[a-1-i],e[a-2-i]=c,e[a-1-i]=p}}function qe(e,r){return new mt(e,r)}function mt(e,r){r=this.options=$e(Object.create(this.options),r);var n=r.debug;if(n&&console.time("preprocess data"),r.maxZoom<0||r.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(r.promoteId&&r.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=Qr(e,r);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",r.indexMaxZoom,r.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=ct(i,r),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}mt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},mt.prototype.splitTile=function(e,r,n,i,a,s,c){for(var p=[e,r,n,i],g=this.options,b=g.debug;p.length;){i=p.pop(),n=p.pop(),r=p.pop(),e=p.pop();var w=1<<r,I=kt(r,n,i),W=this.tiles[I];if(!W&&(b>1&&console.time("creation"),W=this.tiles[I]=oe(e,r,n,i,g),this.tileCoords.push({z:r,x:n,y:i}),b)){b>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",r,n,i,W.numFeatures,W.numPoints,W.numSimplified),console.timeEnd("creation"));var pe="z"+r;this.stats[pe]=(this.stats[pe]||0)+1,this.total++}if(W.source=e,a){if(r===g.maxZoom||r===a)continue;var Me=1<<a-r;if(n!==Math.floor(s/Me)||i!==Math.floor(c/Me))continue}else if(r===g.indexMaxZoom||W.numPoints<=g.indexMaxPoints)continue;if(W.source=null,e.length!==0){b>1&&console.time("clipping");var Fe=.5*g.buffer/g.extent,ut=.5-Fe,Ot=.5+Fe,Bt=1+Fe,ir,xr,qr,Ir,mr,sn;ir=xr=qr=Ir=null,mr=Kr(e,w,n-Fe,n+Ot,0,W.minX,W.maxX,g),sn=Kr(e,w,n+ut,n+Bt,0,W.minX,W.maxX,g),e=null,mr&&(ir=Kr(mr,w,i-Fe,i+Ot,1,W.minY,W.maxY,g),xr=Kr(mr,w,i+ut,i+Bt,1,W.minY,W.maxY,g),mr=null),sn&&(qr=Kr(sn,w,i-Fe,i+Ot,1,W.minY,W.maxY,g),Ir=Kr(sn,w,i+ut,i+Bt,1,W.minY,W.maxY,g),sn=null),b>1&&console.timeEnd("clipping"),p.push(ir||[],r+1,n*2,i*2),p.push(xr||[],r+1,n*2,i*2+1),p.push(qr||[],r+1,n*2+1,i*2),p.push(Ir||[],r+1,n*2+1,i*2+1)}}},mt.prototype.getTile=function(e,r,n){var i=this.options,a=i.extent,s=i.debug;if(e<0||e>24)return null;var c=1<<e;r=(r%c+c)%c;var p=kt(e,r,n);if(this.tiles[p])return or(this.tiles[p],a);s>1&&console.log("drilling down to z%d-%d-%d",e,r,n);for(var g=e,b=r,w=n,I;!I&&g>0;)g--,b=Math.floor(b/2),w=Math.floor(w/2),I=this.tiles[kt(g,b,w)];return!I||!I.source?null:(s>1&&console.log("found parent tile z%d-%d-%d",g,b,w),s>1&&console.time("drilling down"),this.splitTile(I.source,g,b,w,e,r,n),s>1&&console.timeEnd("drilling down"),this.tiles[p]?or(this.tiles[p],a):null)};function kt(e,r,n){return((1<<e)*n+r)*32+e}function $e(e,r){for(var n in r)e[n]=r[n];return e}var Ge=_(15671),We=_(43144),G=_(4942),rt=function(){function e(r,n,i,a){(0,Ge.Z)(this,e),(0,G.Z)(this,"vectorLayerCache",{}),this.x=n,this.y=i,this.z=a,this.vectorTile=r}return(0,We.Z)(e,[{key:"getTileData",value:function(n){if(!n||!this.vectorTile.layers[n])return[];if(this.vectorLayerCache[n])return this.vectorLayerCache[n];var i=this.vectorTile.layers[n];return i.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),ft={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function bt(e){for(var r=0,n=0,i=e.length,a=i-1,s,c;n<i;a=n++)s=e[n],c=e[a],r+=(c.x-s.x)*(s.y+c.y);return r}function Gt(e){var r=e.length;if(r<=1)return[e];for(var n=[],i,a,s=0;s<r;s++){var c=bt(e[s]);c!==0&&(a===void 0&&(a=c<0),a===c<0?(i&&n.push(i),i=[e[s]]):i.push(e[s]))}return i&&n.push(i),n}var lr=["Unknown","Point","LineString","Polygon"];function Ht(e,r,n,i,a){var s=a.geometry,c=a.type,p=a.tags,g=a.id,b=e*Math.pow(2,i),w=e*r,I=e*n,W=lr[c],pe,Me;function Fe(Bt){for(var ir=0;ir<Bt.length;ir++){var xr=Bt[ir];if(xr[3])break;var qr=180-(xr[1]+I)*360/b,Ir=(xr[0]+w)*360/b-180,mr=360/Math.PI*Math.atan(Math.exp(qr*Math.PI/180))-90;Bt[ir]=[Ir,mr,0,1]}}switch(c){case 1:var ut=[];for(pe=0;pe<s.length;pe++)ut[pe]=s[pe][0];s=ut,Fe(s);break;case 2:for(pe=0;pe<s.length;pe++)Fe(s[pe]);break;case 3:for(s=Gt(s),pe=0;pe<s.length;pe++)for(Me=0;Me<s[pe].length;Me++)Fe(s[pe][Me]);break}s.length===1?s=s[0]:W="Multi"+W;var Ot={type:"Feature",geometry:{type:W,coordinates:s},properties:p,id:g,tileOrigin:[0,0],coord:""};return Ot}var Cr=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",new Promise(function(g){var b=i.getTile(n.z,n.x,n.y),w=b?b.features.map(function(pe){return Ht(s,a.x,a.y,a.z,pe)}):[],I={layers:{defaultLayer:{features:w}}},W=new rt(I,n.x,n.y,n.z);g(W)}));case 1:case"end":return p.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}();function hr(e){var r={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?r:(0,fe.Z)((0,fe.Z)({},r),e.geojsonvtOptions)}function Dr(e,r){var n=hr(r),i=n.extent||4096,a=qe(e,n),s=function(g,b){return Cr(b,a,g,i)},c=(0,fe.Z)((0,fe.Z)((0,fe.Z)({},ft),r),{},{getTileData:s});return{data:e,dataArray:[],tilesetOptions:c,isTile:!0}}function Rn(e,r){var n=r.extent,i=n===void 0?[121.168,30.2828,121.384,30.4219]:n,a=r.requestParameters,s=a===void 0?{}:a,c=new Promise(function(g){e instanceof HTMLImageElement||(0,ze.fg)(e)?g([e]):on(e,s,function(b){g(b)})}),p={originData:e,images:c,_id:1,dataArray:[{_id:0,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]};return p}function on(e,r,n){var i=[];if(typeof e=="string")(0,ze.gJ)((0,fe.Z)((0,fe.Z)({},r),{},{url:e}),function(c,p){p&&(i.push(p),n(i))});else{var a=e.length,s=0;e.forEach(function(c){(0,ze.gJ)((0,fe.Z)((0,fe.Z)({},r),{},{url:c}),function(p,g){s++,g&&i.push(g),s===a&&n(i)})})}return Rn}var fi=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s){var c,p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c={x:i.x,y:i.y,z:i.z},p=(0,ze.z0)(n,c),b.abrupt("return",new Promise(function(w){s?s(c,function(I,W){if(I||!W){var pe={layers:{defaultLayer:{features:[]}}},Me=new rt(pe,i.x,i.y,i.z);w(Me)}else{var Fe={layers:{defaultLayer:{features:W.features}}},ut=new rt(Fe,i.x,i.y,i.z);w(ut)}}):(0,ze.Yu)((0,fe.Z)((0,fe.Z)({},a),{},{url:p}),function(I,W){if(I||!W){var pe={layers:{defaultLayer:{features:[]}}},Me=new rt(pe,i.x,i.y,i.z);w(Me)}else{var Fe=JSON.parse(W),ut={layers:{defaultLayer:{features:Fe}}},Ot=new rt(ut,i.x,i.y,i.z);w(Ot)}})}));case 3:case"end":return b.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}();function Mi(e,r){var n=function(s,c){return fi(e,c,r==null?void 0:r.requestParameters,r.getCustomData)},i=(0,fe.Z)((0,fe.Z)({},r),{},{getTileData:n});return{dataArray:[],tilesetOptions:i,isTile:!0}}var di=_(38929),mn=_(3614),Zn=_.n(mn),sa=function(){function e(r,n,i,a){(0,Ge.Z)(this,e),(0,G.Z)(this,"vectorLayerCache",{}),this.x=n,this.y=i,this.z=a,this.vectorTile=new di.VectorTile(new(Zn())(r))}return(0,We.Z)(e,[{key:"getTileData",value:function(n){if(!n||!this.vectorTile.layers[n])return[];if(this.vectorLayerCache[n])return this.vectorLayerCache[n];var i=this.vectorTile.layers[n];if(Array.isArray(i.features))return this.vectorLayerCache[n]=i.features,i.features;for(var a=[],s=0;s<i.length;s++){var c=i.feature(s),p=c.toGeoJSON(this.x,this.y,this.z);a.push((0,fe.Z)((0,fe.Z)({},p),{},{properties:(0,fe.Z)({id:p.id},p.properties)}))}return this.vectorLayerCache[n]=a,a}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),qi={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},Sa=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s,c){var p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return p=(0,ze.z0)(n,i),b.abrupt("return",new Promise(function(w){if(c)c({x:a.x,y:a.y,z:a.z},function(W,pe){if(W||!pe)w(void 0);else{var Me=new sa(pe,a.x,a.y,a.z);w(Me)}});else{var I=(0,ze.ks)((0,fe.Z)((0,fe.Z)({},s),{},{url:p}),function(W,pe){if(W||!pe)w(void 0);else{var Me=new sa(pe,a.x,a.y,a.z);w(Me)}});a.xhrCancel=function(){return I.cancel()}}}));case 2:case"end":return b.stop()}},r)}));return function(n,i,a,s,c){return e.apply(this,arguments)}}();function Zi(e,r){var n=Array.isArray(e)?e[0]:e,i=function(c,p){return Sa(n,c,p,r==null?void 0:r.requestParameters,r==null?void 0:r.getCustomData)},a=(0,fe.Z)((0,fe.Z)((0,fe.Z)({},qi),r),{},{getTileData:i});return{data:n,dataArray:[],tilesetOptions:a,isTile:!0}}var Oi=_(71002),jr=_(74902),Fi=_(97685);function Ls(e,r,n){switch(e){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":return r/n;case"%":return r%n;case"^":return Math.pow(r,n);case"abs":return Math.abs(r);case"floor":return Math.floor(r);case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"sin":return Math.sin(r);case"cos":return Math.cos(r);case"atan":return n===-1?Math.atan(r):Math.atan2(r,n);case"min":return Math.min(r,n);case"max":return Math.max(r,n);case"log10":return Math.log(r);case"log2":return Math.log2(r);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Ta(e,r){for(var n=r[0],i=n.width,a=n.height,s=r.map(function(pe){return pe.rasterData}),c=i*a,p=[],g=JSON.stringify(e),b=0;b<c;b++){var w=JSON.parse(g),I=Aa(w,s,b);if(typeof I=="number")p.push(I);else{var W=os(w);p.push(W)}}return p}function Aa(e,r,n){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return r[e[1]][n]}catch(i){return console.warn("Raster Data err!"),0}e.map(function(i,a){if(Array.isArray(i)&&i.length>0)switch(i[0]){case"band":try{e[a]=r[i[1]][n]}catch(s){console.warn("Raster Data err!"),e[a]=0}break;default:Aa(i,r,n)}})}function go(e){var r=(0,Fi.Z)(e,3),n=r[0],i=r[1],a=i===void 0?-1:i,s=r[2],c=s===void 0?-1:s;if(n===void 0)return console.warn("Express err!"),["+",0,0];var p=n.replace(/\s+/g,"");return[p,a,c]}function os(e){var r=go(e),n=r[0],i=r[1],a=r[2];return Array.isArray(i)&&(i=os(e[1])),Array.isArray(a)&&(a=os(e[2])),Ls(n,i,a)}var ka={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:Ao}};function Ao(e,r){for(var n=e[0].rasterData,i=e[1].rasterData,a=e[2].rasterData,s=[],c=(r==null?void 0:r.countCut)||[2,98],p=(0,Fi.Z)(c,2),g=p[0],b=p[1],w=(r==null?void 0:r.RMinMax)||za(n,g,b),I=(r==null?void 0:r.GMinMax)||za(i,g,b),W=(r==null?void 0:r.BMinMax)||za(a,g,b),pe=0;pe<n.length;pe++)s.push(Math.max(0,n[pe]-w[0])),s.push(Math.max(0,i[pe]-I[0])),s.push(Math.max(0,a[pe]-W[0]));return{rasterData:s,rMinMax:w,gMinMax:I,bMinMax:W}}function za(e,r,n){var i=e.slice().sort(function(p,g){return p-g}),a=i.length,s=i[Math.ceil(a*r/100)],c=i[Math.ceil(a*n/100)];return[s,c]}function Ja(e,r,n){return Oa.apply(this,arguments)}function Oa(){return Oa=(0,He.Z)(Ne().mark(function e(r,n,i){var a,s,c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(r.length!==0){I.next=2;break}return I.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return I.next=4,Promise.all(r.map(function(W){var pe=W.data,Me=W.bands,Fe=Me===void 0?[0]:Me;return n(pe,Fe)}));case 4:a=I.sent,s=[],a.forEach(function(W){Array.isArray(W)?s.push.apply(s,(0,jr.Z)(W)):s.push(W)}),c=s[0],p=c.width,g=c.height,I.t0=(0,Oi.Z)(i),I.next=I.t0==="function"?11:I.t0==="object"?13:15;break;case 11:return b=i(s),I.abrupt("break",16);case 13:return Array.isArray(i)?b={rasterData:Ta(i,s)}:b=Za(i,s),I.abrupt("break",16);case 15:b={rasterData:s[0].rasterData};case 16:return I.abrupt("return",(0,fe.Z)((0,fe.Z)({},b),{},{width:p,height:g}));case 17:case"end":return I.stop()}},e)})),Oa.apply(this,arguments)}function Za(e,r){var n=ka[e.type];if(n.type==="function")return n.method(r,e==null?void 0:e.options);if(n.type==="operation")return e.type==="rgb"?qo(n.expression,r):{rasterData:Ta(n.expression,r)}}function qo(e,r){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var n=Ta(e.r||["band",0],r),i=Ta(e.g||["band",0],r),a=Ta(e.b||["band",0],r);return[n,i,a]}function Ca(e,r,n,i){return io.apply(this,arguments)}function io(){return io=(0,He.Z)(Ne().mark(function e(r,n,i,a){var s;return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Ja(r,n,i);case 2:s=p.sent,a(null,{data:s});case 4:case"end":return p.stop()}},e)})),io.apply(this,arguments)}function Do(e,r){var n=r.extent,i=r.width,a=r.height,s=r.min,c=r.max,p=r.format,g=r.operation,b,w,I;if(p===void 0||dn(e))b=Array.from(e),w=i,I=a;else{var W=Array.isArray(e)?e:[e];b=Ja(W,p,g)}var pe={_id:1,dataArray:[{_id:1,data:b,width:w,height:I,min:s,max:c,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return pe}var $=_(54095),ho=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",new Promise(function(g,b){i({x:n.x,y:n.y,z:n.z},function(w,I){if(w||I.length===0){b(w);return}I&&Ca([{data:I,bands:[0]}],a,s,function(W,pe){W?b(W):pe&&g(pe)})})}));case 1:case"end":return p.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}(),ja=function(){var e=(0,He.Z)(Ne().mark(function r(n,i){return Ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise(function(c,p){i({x:n.x,y:n.y,z:n.z},function(g,b){if(g||!b){p(g);return}b instanceof ArrayBuffer?(0,ze.Co)(b,function(w,I){w&&p(w),c(I)}):b instanceof HTMLImageElement?c(b):p(g)})}));case 1:case"end":return s.stop()}},r)}));return function(n,i){return e.apply(this,arguments)}}();function gs(e,r){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(n){return(0,ze.z0)(n,r)}):e.map(function(n){return{url:(0,ze.z0)(n.url,r),bands:n.bands||[0]}}):(0,ze.z0)(e,r)}function Vo(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(r){return{url:r,bands:[0]}}):e}function Je(e,r){e.xhrCancel=function(){r.map(function(n){n.abort()})}}var yt=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s,c){var p,g,b,w,I,W;return Ne().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(p=Vo(i.url),!(p.length>1)){Me.next=15;break}return Me.next=4,Qt(p,i);case 4:if(g=Me.sent,b=g.rasterFiles,w=g.xhrList,I=g.errList,Je(n,w),!(I.length>0)){Me.next=12;break}return a(I,null),Me.abrupt("return");case 12:Ca(b,s,c,a),Me.next=17;break;case 15:W=(0,ze.ks)(i,function(Fe,ut){if(Fe)a(Fe);else if(ut){var Ot=[{data:ut,bands:p[0].bands}];Ca(Ot,s,c,a)}}),Je(n,[W]);case 17:case"end":return Me.stop()}},r)}));return function(n,i,a,s,c){return e.apply(this,arguments)}}();function Qt(e,r){return Ur.apply(this,arguments)}function Ur(){return Ur=(0,He.Z)(Ne().mark(function e(r,n){var i,a,s,c,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:i=[],a=[],s=[],c=0;case 4:if(!(c<r.length)){Fe.next=20;break}return p=r[c],g=(0,fe.Z)((0,fe.Z)({},n),{},{url:p.url}),b=p.bands,Fe.next=10,(0,ze.LF)((0,fe.Z)((0,fe.Z)({},g),{},{type:"arrayBuffer"}));case 10:w=Fe.sent,I=w.err,W=w.data,pe=w.xhr,I&&s.push(I),a.push(pe),i.push({data:W,bands:b});case 17:c++,Fe.next=4;break;case 20:return Fe.abrupt("return",{rasterFiles:i,xhrList:a,errList:s});case 21:case"end":return Fe.stop()}},e)})),Ur.apply(this,arguments)}var Tn=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s,c){var p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return p={url:gs(n,i)},b.abrupt("return",new Promise(function(w,I){yt(a,p,function(W,pe){W?I(W):pe&&w(pe)},s,c)}));case 2:case"end":return b.stop()}},r)}));return function(n,i,a,s,c){return e.apply(this,arguments)}}(),mi=function(){var e=(0,He.Z)(Ne().mark(function r(n,i,a,s){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return p=Array.isArray(n)?n[0]:n,s.wmtsOptions?(g=(s==null?void 0:s.getURLFromTemplate)||ze.jG,c=g(p,(0,fe.Z)((0,fe.Z)({},i),s.wmtsOptions))):(b=(s==null?void 0:s.getURLFromTemplate)||ze.z0,c=b(p,i)),I.abrupt("return",new Promise(function(W,pe){var Me,Fe=(0,ze.gJ)({url:c,type:(s==null||(Me=s.requestParameters)===null||Me===void 0?void 0:Me.type)||"arrayBuffer"},function(ut,Ot){ut?pe(ut):Ot&&W(Ot)},s.transformResponse);a.xhrCancel=function(){return Fe.cancel()}}));case 3:case"end":return I.stop()}},r)}));return function(n,i,a,s){return e.apply(this,arguments)}}(),la=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},Ho={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},ss=[$.n3.ARRAYBUFFER,$.n3.RGB];function ko(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function gu(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ko(e))throw new Error("tile server url is error");var n=(r==null?void 0:r.dataType)||$.n3.IMAGE;n===$.n3.RGB&&(n=$.n3.ARRAYBUFFER);var i=function(c,p){switch(n){case $.n3.IMAGE:return mi(e,c,p,r);case $.n3.CUSTOMIMAGE:case $.n3.CUSTOMTERRAINRGB:return ja(p,r==null?void 0:r.getCustomData);case $.n3.ARRAYBUFFER:return Tn(e,c,p,(r==null?void 0:r.format)||la,r==null?void 0:r.operation);case $.n3.CUSTOMARRAYBUFFER:case $.n3.CUSTOMRGB:return ho(p,r==null?void 0:r.getCustomData,(r==null?void 0:r.format)||la,r==null?void 0:r.operation);default:return mi(e,c,p,r)}},a=(0,fe.Z)((0,fe.Z)((0,fe.Z)({},Ho),r),{},{getTileData:i});return{data:e,dataArray:[],tilesetOptions:a,isTile:!0}}var Ws=_(45987),cf=["extent","min","max","width","height","format","operation"];function ff(e,r){var n=r.extent,i=r.min,a=r.max,s=r.width,c=r.height,p=r.format,g=r.operation,b=(0,Ws.Z)(r,cf),w;if(p===void 0||dn(e))w=Array.from(e);else{var I=Array.isArray(e)?e:[e];w=Ja(I,p,g)}var W={_id:1,dataArray:[(0,fe.Z)((0,fe.Z)({_id:1,data:w,width:s,height:c},b),{},{min:i,max:a,coordinates:[[n[0],n[1]],[n[2],n[3]]]})]};return W}var ys={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},bl=function(){var e=(0,He.Z)(Ne().mark(function r(n){return Ne().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(s){var c=(0,Fi.Z)(n.bounds,4),p=c[0],g=c[1],b=c[2],w=c[3],I={layers:{testTile:{features:[{type:"Feature",properties:{key:n.x+"/"+n.y+"/"+n.z,x:(p+b)/2,y:(g+w)/2},geometry:{type:"LineString",coordinates:[[b,w],[b,g],[p,g],[p,g]]}}]}}};s(I)}));case 1:case"end":return a.stop()}},r)}));return function(n){return e.apply(this,arguments)}}();function xl(e,r){var n=function(s){return bl(s)},i=(0,fe.Z)((0,fe.Z)((0,fe.Z)({},ys),r),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:i,isTile:!0}}var ds=["extent","width","height"];function Qu(e,r){var n=r.extent,i=r.width,a=r.height,s=(0,Ws.Z)(r,ds);e.length<3&&console.warn("RGB\u89E3\u6790\u9700\u8981\u4E09\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");for(var c=s.bands||[0,1,2],p=(0,Fi.Z)(c,3),g=p[0],b=p[1],w=p[2],I=[e[g],e[b],e[w]],W=[],pe=(s==null?void 0:s.countCut)||[2,98],Me=(0,Fi.Z)(pe,2),Fe=Me[0],ut=Me[1],Ot=(s==null?void 0:s.RMinMax)||za(I[0],Fe,ut),Bt=(s==null?void 0:s.GMinMax)||za(I[1],Fe,ut),ir=(s==null?void 0:s.BMinMax)||za(I[2],Fe,ut),xr=0;xr<I[0].length;xr++)W.push(Math.max(0,I[0][xr]-Ot[0])),W.push(Math.max(0,I[1][xr]-Bt[0])),W.push(Math.max(0,I[2][xr]-ir[0]));var qr={_id:1,dataArray:[(0,fe.Z)((0,fe.Z)({_id:1,data:W,width:i,height:a,rMinMax:Ot,gMinMax:Bt,bMinMax:ir},s),{},{coordinates:[[n[0],n[1]],[n[2],n[3]]]})]};return qr}var El=["extent","width","height"];function Fl(e,r){var n=r.extent,i=r.width,a=r.height,s=(0,Ws.Z)(r,El);e.length<2&&console.warn("RGB\u89E3\u6790\u9700\u89812\u4E2A\u6CE2\u6BB5\u7684\u6570\u636E");for(var c=s.bands||[0,1],p=(0,Fi.Z)(c,2),g=p[0],b=p[1],w=[e[g],e[b]],I=[],W=0;W<w[0].length;W++)I.push((w[1][W]-w[0][W])/(w[1][W]+w[0][W]));var pe={_id:1,dataArray:[(0,fe.Z)((0,fe.Z)({_id:1,data:I,width:i,height:a},s),{},{coordinates:[[n[0],n[1]],[n[2],n[3]]]})]};return pe}var gn=_(97326),Ai=_(60136),Hi=_(82963),kn=_(61120),us=_(46343),Sl=_(26729),Ic=_.n(Sl),hf=_(69848),Oc=_.n(hf);function df(e,r){var n=r.radius,i=n===void 0?40:n,a=r.maxZoom,s=a===void 0?18:a,c=r.minZoom,p=c===void 0?0:c,g=r.zoom,b=g===void 0?2:g;if(e.pointIndex){var w=e.pointIndex.getClusters(e.extent,Math.floor(b));return e.dataArray=pf(w),e}var I=new(Oc())({radius:i,minZoom:p,maxZoom:s}),W={type:"FeatureCollection",features:[]};return W.features=e.dataArray.map(function(pe){return{type:"Feature",geometry:{type:"Point",coordinates:pe.coordinates},properties:(0,fe.Z)({},pe)}}),I.load(W.features),I}function pf(e){return e.map(function(r,n){return(0,fe.Z)({coordinates:r.geometry.coordinates,_id:n+1},r.properties)})}function po(e){if(e.length===0)throw new Error("max requires at least one data point");for(var r=e[0],n=1;n<e.length;n++)e[n]>r&&(r=e[n]);return r}function Pf(e){if(e.length===0)throw new Error("min requires at least one data point");for(var r=e[0],n=1;n<e.length;n++)e[n]<r&&(r=e[n]);return r}function vc(e){if(e.length===0)return 0;for(var r=e[0],n=0,i,a=1;a<e.length;a++)i=r+e[a]*1,Math.abs(r)>=Math.abs(e[a])?n+=r-i+e[a]:n+=e[a]-i+r,r=i;return r+n*1}function Ju(e){if(e.length===0)throw new Error("mean requires at least one data point");return vc(e)/e.length}var eh={min:Pf,max:po,mean:Ju,sum:vc};function Qo(e){var r=Nl();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Nl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ul=ze.rU.cloneDeep,iu=ze.rU.isFunction,yu=ze.rU.isString,_u=ze.rU.mergeWith;function el(e,r){if(Array.isArray(r))return r}var au=function(e){(0,Ai.Z)(n,e);var r=Qo(n);function n(i,a){var s;return(0,Ge.Z)(this,n),s=r.call(this),(0,G.Z)((0,gn.Z)(s),"type","source"),(0,G.Z)((0,gn.Z)(s),"isTile",!1),(0,G.Z)((0,gn.Z)(s),"inited",!1),(0,G.Z)((0,gn.Z)(s),"hooks",{init:new us.ni}),(0,G.Z)((0,gn.Z)(s),"parser",{type:"geojson"}),(0,G.Z)((0,gn.Z)(s),"transforms",[]),(0,G.Z)((0,gn.Z)(s),"cluster",!1),(0,G.Z)((0,gn.Z)(s),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,G.Z)((0,gn.Z)(s),"invalidExtent",!1),(0,G.Z)((0,gn.Z)(s),"dataArrayChanged",!1),(0,G.Z)((0,gn.Z)(s),"cfg",{autoRender:!0}),s.originData=i,s.initCfg(a),s.init().then(function(){s.inited=!0,s.emit("update",{type:"inited"})}),s}return(0,We.Z)(n,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(a){return this.clusterIndex.getClusters(this.caculClusterExtent(2),a)}},{key:"getClustersLeaves",value:function(a){return this.clusterIndex.getLeaves(a,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(a){var s=this,c=this.clusterOptions,p=c.method,g=p===void 0?"sum":p,b=c.field,w=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(a));this.clusterOptions.zoom=a,w.forEach(function(I){I.id||(I.properties.point_count=1)}),(b||iu(g))&&(w=w.map(function(I){var W=I.id;if(W){var pe=s.clusterIndex.getLeaves(W,1/0),Me=pe.map(function(Ot){return Ot.properties}),Fe;if(yu(g)&&b){var ut=hn(Me,b);Fe=eh[g](ut)}iu(g)&&(Fe=g(Me)),I.properties.stat=Fe}else I.properties.point_count=1;return I})),this.data=h("geojson")({type:"FeatureCollection",features:w}),this.executeTrans()}},{key:"getFeatureById",value:function(a){var s=this.parser,c=s.type,p=c===void 0?"geojson":c,g=s.geometry;if(p==="geojson"&&!this.cluster){var b=a<this.originData.features.length?this.originData.features[a]:"null",w=Ul(b);if(w!=null&&w.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var I=this.data.dataArray.find(function(W){return W._id===a});w.properties=I}return w}else return p==="json"&&g?this.data.dataArray.find(function(W){return W._id===a}):a<this.data.dataArray.length?this.data.dataArray[a]:"null"}},{key:"updateFeaturePropertiesById",value:function(a,s){this.data.dataArray=this.data.dataArray.map(function(c){return c._id===a?(0,fe.Z)((0,fe.Z)({},c),s):c}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(a,s){var c=this.data.dataArray.find(function(p){return p[a]===s});return c==null?void 0:c._id}},{key:"setData",value:function(a,s){var c=this;this.originData=a,this.dataArrayChanged=!1,this.initCfg(s),this.init().then(function(){c.emit("update",{type:"update"})})}},{key:"reloadAllTile",value:function(){var a;(a=this.tileset)===null||a===void 0||a.reloadAll()}},{key:"reloadTilebyId",value:function(a,s,c){var p;(p=this.tileset)===null||p===void 0||p.reloadTileById(a,s,c)}},{key:"reloadTileByLnglat",value:function(a,s,c){var p;(p=this.tileset)===null||p===void 0||p.reloadTileByLnglat(a,s,c)}},{key:"getTileExtent",value:function(a,s){var c;return(c=this.tileset)===null||c===void 0?void 0:c.getTileExtent(a,s)}},{key:"getTileByZXY",value:function(a,s,c){var p;return(p=this.tileset)===null||p===void 0?void 0:p.getTileByZXY(a,s,c)}},{key:"reloadTileByExtent",value:function(a,s){var c;(c=this.tileset)===null||c===void 0||c.reloadTileByExtent(a,s)}},{key:"destroy",value:function(){var a;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(a=this.tileset)===null||a===void 0||a.destroy()}},{key:"processData",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c=this;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",new Promise(function(b,w){try{c.excuteParser(),c.initCluster(),c.executeTrans(),b({})}catch(I){w(I)}}));case 1:case"end":return g.stop()}},s)}));function a(){return i.apply(this,arguments)}return a}()},{key:"initCfg",value:function(a){this.cfg=_u(this.cfg,a,el);var s=this.cfg;s&&(s.parser&&(this.parser=s.parser),s.transforms&&(this.transforms=s.transforms),this.cluster=s.cluster||!1,s.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,fe.Z)((0,fe.Z)({},this.clusterOptions),s.clusterOptions)))}},{key:"init",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.inited=!1,p.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"excuteParser",value:function(){var a=this.parser,s=a.type||"geojson",c=h(s);this.data=c(this.originData,a),this.tileset=this.initTileset(),!a.cancelExtent&&(this.extent=(0,ze.We)(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(a){this.center=[(a[0]+a[2])/2,(a[1]+a[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var a=this.data.tilesetOptions;if(a){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(a),this.tileset;var s=new ze.nx((0,fe.Z)({},a));return s}}},{key:"executeTrans",value:function(){var a=this,s=this.transforms;s.forEach(function(c){var p=c.type,g=C(p)(a.data,c);Object.assign(a.data,g)})}},{key:"initCluster",value:function(){if(this.cluster){var a=this.clusterOptions||{};this.clusterIndex=df(this.data,a)}}},{key:"caculClusterExtent",value:function(a){var s=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(s=(0,ze.yA)((0,ze.ds)(this.extent),a)),s[0].concat(s[1])}}]),n}(Sl.EventEmitter);function zl(e,r){var n=r.callback;return n&&(e.dataArray=e.dataArray.filter(n)),e}function Tl(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=vf(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function vf(e,r){if(e){if(typeof e=="string")return Vc(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vc(e,r)}}function Vc(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}var Va=6378e3;function th(e,r){var n=e.dataArray,i=r.size,a=i===void 0?10:i,s=a/(2*Math.PI*Va)*(256<<20)/2,c=Pc(n,a),p=c.gridHash,g=c.gridOffset,b=gf(p,g,r);return{yOffset:s,xOffset:s,radius:s,type:"grid",dataArray:b}}function Pc(e,r){var n=1/0,i=-1/0,a,s=Tl(e),c;try{for(s.s();!(c=s.n()).done;){var p=c.value;a=p.coordinates[1],Number.isFinite(a)&&(n=a<n?a:n,i=a>i?a:i)}}catch(ir){s.e(ir)}finally{s.f()}var g=(n+i)/2,b=Hc(r,g);if(b.xOffset<=0||b.yOffset<=0)return{gridHash:{},gridOffset:b};var w={},I=Tl(e),W;try{for(I.s();!(W=I.n()).done;){var pe=W.value,Me=pe.coordinates[1],Fe=pe.coordinates[0];if(Number.isFinite(Me)&&Number.isFinite(Fe)){var ut=Math.floor((Me+90)/b.yOffset),Ot=Math.floor((Fe+180)/b.xOffset),Bt="".concat(ut,"-").concat(Ot);w[Bt]=w[Bt]||{count:0,points:[]},w[Bt].count+=1,w[Bt].points.push(pe)}}}catch(ir){I.e(ir)}finally{I.f()}return{gridHash:w,gridOffset:b}}function Hc(e,r){var n=bo(e),i=mf(r,e);return{yOffset:n,xOffset:i}}function bo(e){return e/Va*(180/Math.PI)}function mf(e,r){return r/Va*(180/Math.PI)/Math.cos(e*Math.PI/180)}function gf(e,r,n){return Object.keys(e).reduce(function(i,a,s){var c=a.split("-"),p=parseInt(c[0],10),g=parseInt(c[1],10),b={};if(n.field&&n.method){var w=ze.a5.getColumn(e[a].points,n.field);b[n.method]=ze.a5.statMap[n.method](w)}return Object.assign(b,{_id:s,coordinates:(0,ze.Z)([-180+r.xOffset*(g+.5),-90+r.yOffset*(p+.5)]),rawData:e[a].points,count:e[a].count}),i.push(b),i},[])}var Jo=Math.PI/3,Zu=[0,Jo,2*Jo,3*Jo,4*Jo,5*Jo];function Mu(e){return e[0]}function ju(e){return e[1]}function mc(){var e=0,r=0,n=1,i=1,a=Mu,s=ju,c,p,g;function b(I){var W={},pe=[],Me,Fe=I.length;for(Me=0;Me<Fe;++Me)if(!(isNaN(Ot=+a.call(null,ut=I[Me],Me,I))||isNaN(Bt=+s.call(null,ut,Me,I)))){var ut,Ot,Bt,ir=Math.round(Bt=Bt/g),xr=Math.round(Ot=Ot/p-(ir&1)/2),qr=Bt-ir;if(Math.abs(qr)*3>1){var Ir=Ot-xr,mr=xr+(Ot<xr?-1:1)/2,sn=ir+(Bt<ir?-1:1),ti=Ot-mr,Bi=Bt-sn;Ir*Ir+qr*qr>ti*ti+Bi*Bi&&(xr=mr+(ir&1?1:-1)/2,ir=sn)}var ai=xr+"-"+ir,ra=W[ai];ra?ra.push(ut):(pe.push(ra=W[ai]=[ut]),ra.x=(xr+(ir&1)/2)*p,ra.y=ir*g)}return pe}function w(I){var W=0,pe=0;return Zu.map(function(Me){var Fe=Math.sin(Me)*I,ut=-Math.cos(Me)*I,Ot=Fe-W,Bt=ut-pe;return W=Fe,pe=ut,[Ot,Bt]})}return b.hexagon=function(I){return"m"+w(I==null?c:+I).join("l")+"z"},b.centers=function(){for(var I=[],W=Math.round(r/g),pe=Math.round(e/p),Me=W*g;Me<i+c;Me+=g,++W)for(var Fe=pe*p+(W&1)*p/2;Fe<n+p/2;Fe+=p)I.push([Fe,Me]);return I},b.mesh=function(){var I=w(c).slice(0,4).join("l");return b.centers().map(function(W){return"M"+W+"m"+I}).join("")},b.x=function(I){return arguments.length?(a=I,b):a},b.y=function(I){return arguments.length?(s=I,b):s},b.radius=function(I){return arguments.length?(c=+I,p=c*2*Math.sin(Jo),g=c*1.5,b):c},b.size=function(I){return arguments.length?(e=r=0,n=+I[0],i=+I[1],b):[n-e,i-r]},b.extent=function(I){return arguments.length?(e=+I[0][0],r=+I[0][1],n=+I[1][0],i=+I[1][1],b):[[e,r],[n,i]]},b.radius(1)}var Zl=6378e3;function bu(e,r){var n=e.dataArray,i=r.size,a=i===void 0?10:i,s=r.method,c=s===void 0?"sum":s,p=a/(2*Math.PI*Zl)*(256<<20)/2,g=n.map(function(W){var pe=(0,ze.Z)(W.coordinates),Me=(0,Fi.Z)(pe,2),Fe=Me[0],ut=Me[1];return(0,fe.Z)((0,fe.Z)({},W),{},{coordinates:[Fe,ut]})}),b=mc().radius(p).x(function(W){return W.coordinates[0]}).y(function(W){return W.coordinates[1]}),w=b(g),I={dataArray:w.map(function(W,pe){var Me;if(r.field&&c){var Fe=ze.a5.getColumn(W,r.field);W[c]=ze.a5.statMap[c](Fe)}return Me={},(0,G.Z)(Me,r.method,W[c]),(0,G.Z)(Me,"count",W.length),(0,G.Z)(Me,"rawData",W),(0,G.Z)(Me,"coordinates",[W.x,W.y]),(0,G.Z)(Me,"_id",pe),Me}),radius:p,xOffset:p,yOffset:p,type:"hexagon"};return I}function gc(e,r){var n=r.sourceField,i=r.targetField,a=r.data,s={};return a.forEach(function(c){s[c[n]]=c}),e.dataArray=e.dataArray.map(function(c){var p=c[i];return(0,fe.Z)((0,fe.Z)({},c),s[p])}),e}function Al(e,r){var n=r.callback;return n&&(e.dataArray=e.dataArray.map(n)),e}O("rasterTile",gu),O("mvt",Zi),O("geojsonvt",Dr),O("testTile",xl),O("geojson",wt),O("jsonTile",Mi),O("image",Rn),O("csv",yn),O("json",un),O("raster",Do),O("rasterRgb",ff),O("rgb",Qu),O("ndi",Fl),P("cluster",df),P("filter",zl),P("join",gc),P("map",Al),P("grid",th),P("hexagon",bu);var ou=au;function La(e){var r=qa();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function qa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var so=null;function Vu(e){var r=Df();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Df(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Cl=ze.rU.merge,Dc=null,yc=_(4157);function Gs(e){var r=Hu();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Hu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Iu=function(e){(0,Ai.Z)(n,e);var r=Gs(n);function n(i){var a;return(0,Ge.Z)(this,n),a=r.call(this),n.controlCount++,a.controlOption=(0,fe.Z)((0,fe.Z)({},a.getDefault(i)),i||{}),a}return(0,We.Z)(n,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(a){var s=this.getDefault(a);Object.entries(a).forEach(function(c){var p=(0,Fi.Z)(c,2),g=p[0],b=p[1];b===void 0&&(a[g]=s[g])}),"position"in a&&this.setPosition(a.position),"className"in a&&this.setClassName(a.className),"style"in a&&this.setStyle(a.style),this.controlOption=(0,fe.Z)((0,fe.Z)({},this.controlOption),a)}},{key:"addTo",value:function(a){this.mapsService=a.get($.vK.IMapService),this.renderService=a.get($.vK.IRendererService),this.layerService=a.get($.vK.ILayerService),this.controlService=a.get($.vK.IControlService),this.configService=a.get($.vK.IGlobalConfigService),this.scene=a.get($.vK.ISceneService),this.sceneContainer=a,this.isShow=!0,this.container=this.onAdd(),ze.SO.addClass(this.container,"l7-control");var s=this.controlOption,c=s.className,p=s.style;return c&&this.setClassName(c),p&&this.setStyle(p),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;ze.SO.remove(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return ze.SO.create("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var a=this.container;ze.SO.removeClass(a,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var a=this.container;ze.SO.addClass(a,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(a){return{position:$.d.TOPRIGHT,name:"".concat(n.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(a){if(this.mapsService&&a&&a.screenX>0&&a.screenY>0){var s=this.mapsService.getContainer();s!==null&&s.focus()}}},{key:"setPosition",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$.d.TOPLEFT,s=this.controlService;return s&&s.removeControl(this),this.controlOption.position=a,s&&s.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(a){var s=this.container,c=this.controlOption.className;c&&ze.SO.removeClass(s,c),a&&ze.SO.addClass(s,a)}},{key:"setStyle",value:function(a){var s=this.container;a?s.setAttribute("style",a):s.removeAttribute("style")}},{key:"insertContainer",value:function(){var a=this.controlOption.position,s=this.container;if(a instanceof Element)a.appendChild(s);else{var c=this.controlService.controlCorners[a];["bottomleft","bottomright","righttop","rightbottom"].includes(a)?c.insertBefore(s,c.firstChild):c.appendChild(s)}}},{key:"checkUpdateOption",value:function(a,s){return s.some(function(c){return c in a})}}]),n}(Ic());(0,G.Z)(Iu,"controlCount",0);function tl(e){var r=Ql();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Ql(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jl=null;function jl(e){var r=kc();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function kc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rl=function(e){(0,Ai.Z)(n,e);var r=jl(n);function n(i,a){var s;return(0,Ge.Z)(this,n),s=r.call(this),(0,G.Z)((0,gn.Z)(s),"isShow",!1),(0,G.Z)((0,gn.Z)(s),"timeout",null),(0,G.Z)((0,gn.Z)(s),"show",function(){return s.isShow||!s.contentDOM.innerHTML||(s.resetPopperPosition(),ze.SO.removeClass(s.popperDOM,"l7-popper-hide"),s.isShow=!0,s.option.unique&&n.conflictPopperList.forEach(function(c){c!==(0,gn.Z)(s)&&c.isShow&&c.hide()}),s.emit("show"),window.addEventListener("pointerdown",s.onPopperUnClick)),(0,gn.Z)(s)}),(0,G.Z)((0,gn.Z)(s),"hide",function(){return s.isShow&&(ze.SO.addClass(s.popperDOM,"l7-popper-hide"),s.isShow=!1,s.emit("hide"),window.removeEventListener("pointerdown",s.onPopperUnClick)),(0,gn.Z)(s)}),(0,G.Z)((0,gn.Z)(s),"setHideTimeout",function(){s.timeout||(s.timeout=window.setTimeout(function(){s.isShow&&(s.hide(),s.timeout=null)},300))}),(0,G.Z)((0,gn.Z)(s),"clearHideTimeout",function(){s.timeout&&(window.clearTimeout(s.timeout),s.timeout=null)}),(0,G.Z)((0,gn.Z)(s),"onBtnClick",function(){s.isShow?s.hide():s.show()}),(0,G.Z)((0,gn.Z)(s),"onPopperUnClick",function(c){ze.SO.findParentElement(c.target,[".l7-button-control",".l7-popper-content"])||s.hide()}),(0,G.Z)((0,gn.Z)(s),"onBtnMouseLeave",function(){s.setHideTimeout()}),(0,G.Z)((0,gn.Z)(s),"onBtnMouseMove",function(){s.clearHideTimeout(),!s.isShow&&s.show()}),s.button=i,s.option=a,s.init(),a.unique&&n.conflictPopperList.push((0,gn.Z)(s)),s}return(0,We.Z)(n,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(a){typeof a=="string"?this.contentDOM.innerHTML=a:a instanceof HTMLElement&&(ze.SO.clearChildren(this.contentDOM),this.contentDOM.appendChild(a)),this.content=a}},{key:"init",value:function(){var a=this.option.trigger;this.popperDOM=this.createPopper(),a==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),ze.SO.remove(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var a={},s=this.option,c=s.container,p=s.offset,g=p===void 0?[0,0]:p,b=s.placement,w=(0,Fi.Z)(g,2),I=w[0],W=w[1],pe=this.button.getBoundingClientRect(),Me=c.getBoundingClientRect(),Fe=ze.SO.getDiffRect(pe,Me),ut=Fe.left,Ot=Fe.right,Bt=Fe.top,ir=Fe.bottom,xr=!1,qr=!1;/^(left|right)/.test(b)?(b.includes("left")?a.right="".concat(pe.width+Ot,"px"):b.includes("right")&&(a.left="".concat(pe.width+ut,"px")),b.includes("start")?a.top="".concat(Bt,"px"):b.includes("end")?a.bottom="".concat(ir,"px"):(a.top="".concat(Bt+pe.height/2,"px"),qr=!0,a.transform="translate(".concat(I,"px, calc(").concat(W,"px - 50%))"))):/^(top|bottom)/.test(b)&&(b.includes("top")?a.bottom="".concat(pe.height+ir,"px"):b.includes("bottom")&&(a.top="".concat(pe.height+Bt,"px")),b.includes("start")?a.left="".concat(ut,"px"):b.includes("end")?a.right="".concat(Ot,"px"):(a.left="".concat(ut+pe.width/2,"px"),xr=!0,a.transform="translate(calc(".concat(I,"px - 50%), ").concat(W,"px)"))),a.transform="translate(calc(".concat(I,"px - ").concat(xr?"50%":"0%","), calc(").concat(W,"px - ").concat(qr?"50%":"0%",")");var Ir=b.split("-");Ir.length&&ze.SO.addClass(this.popperDOM,Ir.map(function(mr){return"l7-popper-".concat(mr)}).join(" ")),ze.SO.addStyle(this.popperDOM,ze.SO.css2Style(a))}},{key:"createPopper",value:function(){var a=this.option,s=a.container,c=a.className,p=c===void 0?"":c,g=a.content,b=ze.SO.create("div","l7-popper l7-popper-hide ".concat(p)),w=ze.SO.create("div","l7-popper-content"),I=ze.SO.create("div","l7-popper-arrow");return b.appendChild(w),b.appendChild(I),s.appendChild(b),this.popperDOM=b,this.contentDOM=w,g&&this.setContent(g),b}}]),n}(Sl.EventEmitter);(0,G.Z)(rl,"conflictPopperList",[]);function Xs(e){var r=kf();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function kf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yf={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},Lf=null;function Vl(e){var r=$u();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function $u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Hl=function(e){return e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index",e}(Hl||{}),_c=null,nl=function(r){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.classList.add("l7-iconfont"),n.setAttribute("aria-hidden","true");var i=document.createElementNS("http://www.w3.org/2000/svg","use");return i.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(r)),n.appendChild(i),n};function Bf(e){var r=$c();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function $c(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _f=null;function Wc(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=bf(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function bf(e,r){if(e){if(typeof e=="string")return bc(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bc(e,r)}}function bc(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}var Gc=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],xu=function(){if(typeof document=="undefined")return!1;for(var e=Gc[0],r={},n=0,i=Gc;n<i.length;n++){var a=i[n],s=a==null?void 0:a[1];if(s in document){var c=Wc(a.entries()),p;try{for(c.s();!(p=c.n()).done;){var g=(0,Fi.Z)(p.value,2),b=g[0],w=g[1];r[e[b]]=w}}catch(I){c.e(I)}finally{c.f()}return r}}return!1}(),Wu={change:xu.fullscreenchange,error:xu.fullscreenerror},_s={request:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,n=arguments.length>1?arguments[1]:void 0;return new Promise(function(i,a){var s=function p(){_s.off("change",p),i()};_s.on("change",s);var c=r[xu.requestFullscreen](n);c instanceof Promise&&c.then(s).catch(a)})},exit:function(){return new Promise(function(r,n){if(!_s.isFullscreen){r();return}var i=function s(){_s.off("change",s),r()};_s.on("change",i);var a=document[xu.exitFullscreen]();a instanceof Promise&&a.then(i).catch(n)})},toggle:function(r,n){return _s.isFullscreen?_s.exit():_s.request(r,n)},onchange:function(r){_s.on("change",r)},onerror:function(r){_s.on("error",r)},on:function(r,n){var i=Wu[r];i&&document.addEventListener(i,n,!1)},off:function(r,n){var i=Wu[r];i&&document.removeEventListener(i,n,!1)},raw:xu};Object.defineProperties(_s,{isFullscreen:{get:function(){return!!document[xu.fullscreenElement]}},element:{enumerable:!0,get:function(){var r;return(r=document[xu.fullscreenElement])!==null&&r!==void 0?r:void 0}},isEnabled:{enumerable:!0,get:function(){return!!document[xu.fullscreenEnabled]}}}),xu||(_s={isEnabled:!1});var xf=null;function $l(e){var r=uo();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ef=null;function Ys(e){var r=wl();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function wl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ia=null;function lo(e){var r=Ou();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Ou(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Xc(e){return Object.keys(e!=null?e:{}).every(function(r){return["layer","name","img"].includes(r)})}var Pu=null,Bs=_(73237);function Ff(e){var r=Yc();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Yc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ec=function(e){(0,Ai.Z)(n,e);var r=Ff(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getDefault",value:function(){return{position:$.d.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var a=ze.SO.create("div","l7-control-logo");return this.setLogoContent(a),a}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(a){(0,Bs.Z)((0,kn.Z)(n.prototype),"setOptions",this).call(this,a),this.checkUpdateOption(a,["img","href"])&&(ze.SO.clearChildren(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(a){var s=this.controlOption,c=s.href,p=s.img,g=ze.SO.create("img");if(g.setAttribute("src",p),g.setAttribute("aria-label","AntV logo"),ze.SO.setUnDraggable(g),c){var b=ze.SO.create("a","l7-control-logo-link");b.target="_blank",b.href=c,b.rel="noopener nofollow",b.setAttribute("rel","noopener nofollow"),b.appendChild(g),a.appendChild(b)}else a.appendChild(g)}}]),n}(Iu),tc={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},ps={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function Co(e){var r=xc();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function xc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Nf=null;function wo(e){var r=oi();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function oi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ks=null;function rc(e){var r=nc();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function nc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Cs=null,wa=_(43269),qs=_(53229),zn,Du=(zn={},(0,G.Z)(zn,$.h0.additive,{enable:!0,func:{srcRGB:$.gl.ONE,dstRGB:$.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,G.Z)(zn,$.h0.none,{enable:!1}),(0,G.Z)(zn,$.h0.normal,{enable:!0,func:{srcRGB:$.gl.SRC_ALPHA,dstRGB:$.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,G.Z)(zn,$.h0.subtractive,{enable:!0,func:{srcRGB:$.gl.ONE,dstRGB:$.gl.ONE,srcAlpha:$.gl.ZERO,dstAlpha:$.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:$.gl.FUNC_SUBTRACT,alpha:$.gl.FUNC_SUBTRACT}}),(0,G.Z)(zn,$.h0.max,{enable:!0,func:{srcRGB:$.gl.ONE,dstRGB:$.gl.ONE},equation:{rgb:$.gl.MAX_EXT}}),(0,G.Z)(zn,$.h0.min,{enable:!0,func:{srcRGB:$.gl.ONE,dstRGB:$.gl.ONE},equation:{rgb:$.gl.MIN_EXT}}),zn);function il(e){return e.map(function(r){return typeof r=="string"&&(r=[r,{}]),r})}function Ec(e,r,n,i){var a=e.multiPassRenderer,s=e.getLayerConfig(),c=s.enableTAA;return c?a.add(i("taa")):a.add(i("render")),il(r).forEach(function(p){var g=(0,Fi.Z)(p,2),b=g[0],w=g[1];a.add(n(b),w)}),a.add(n("copy")),a}var Eu=function(){function e(r){(0,Ge.Z)(this,e),this.layer=r}return(0,We.Z)(e,[{key:"pickRender",value:function(n){var i=this.layer.getContainer(),a=i.get($.vK.ILayerService),s=this.layer;if(s.tileLayer)return s.tileLayer.pickRender(n);s.hooks.beforePickingEncode.call(),a.renderTileLayerMask(s),s.renderModels({ispick:!0}),s.hooks.afterPickingEncode.call()}},{key:"pick",value:function(){var r=(0,He.Z)(Ne().mark(function i(a,s){var c,p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(c=this.layer.getContainer(),p=c.get($.vK.IPickingService),a.type!=="RasterLayer"){b.next=4;break}return b.abrupt("return",this.pickRasterLayer(a,s));case 4:return this.pickRender(s),b.abrupt("return",p.pickFromPickingFBO(a,s));case 6:case"end":return b.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"pickRasterLayer",value:function(n,i,a){var s=this.layer.getContainer(),c=s.get($.vK.IPickingService),p=s.get($.vK.IMapService),g=this.layer.getSource().extent,b=(0,ze.if)(i.lngLat,g),w={x:i.x,y:i.y,type:i.type,lngLat:i.lngLat,target:i,rasterValue:null},I=a||n;if(b){var W=this.readRasterValue(n,g,p,i.x,i.y);return w.rasterValue=W,c.triggerHoverOnLayer(I,w),!0}else return w.type=i.type==="mousemove"?"mouseout":"un"+i.type,c.triggerHoverOnLayer(I,(0,fe.Z)((0,fe.Z)({},w),{},{type:"unpick"})),c.triggerHoverOnLayer(I,w),!1}},{key:"readRasterValue",value:function(n,i,a,s,c){var p=n.getSource().data.dataArray[0],g=(0,Fi.Z)(i,4),b=g[0],w=b===void 0?0:b,I=g[1],W=I===void 0?0:I,pe=g[2],Me=pe===void 0?10:pe,Fe=g[3],ut=Fe===void 0?-10:Fe,Ot=a.lngLatToContainer([w,W]),Bt=a.lngLatToContainer([Me,ut]),ir=Bt.x-Ot.x,xr=Ot.y-Bt.y,qr=[(s-Ot.x)/ir,(c-Bt.y)/xr],Ir=p.width||1,mr=p.height||1,sn=Math.floor(qr[0]*Ir),ti=Math.floor(qr[1]*mr),Bi=Math.max(0,ti-1)*Ir+sn,ai=p.data[Bi];return ai}},{key:"selectFeature",value:function(n){var i=this.layer,a=(0,Fi.Z)(n,3),s=a[0],c=a[1],p=a[2];i.hooks.beforeSelect.call([s,c,p])}},{key:"highlightPickedFeature",value:function(n){var i=(0,Fi.Z)(n,3),a=i[0],s=i[1],c=i[2];this.layer.hooks.beforeHighlight.call([a,s,c])}},{key:"getFeatureById",value:function(n){return this.layer.getSource().getFeatureById(n)}}]),e}(),su=function(){function e(r){(0,Ge.Z)(this,e),this.layer=r;var n=this.layer.getContainer();this.rendererService=n.get($.vK.IRendererService)}return(0,We.Z)(e,[{key:"getColorTexture",value:function(n,i){var a=this.getTextureKey(n,i);return this.key===a?this.colorTexture:(this.createColorTexture(n,i),this.key=a,this.colorTexture)}},{key:"createColorTexture",value:function(n,i){var a=this.rendererService.createTexture2D,s=this.getColorRampBar(n,i),c=a({data:new Uint8Array(s.data),width:s.width,height:s.height,flipY:!1,unorm:!0});return this.colorTexture=c,c}},{key:"setColorTexture",value:function(n,i,a){this.key=this.getTextureKey(i,a),this.colorTexture=n}},{key:"destroy",value:function(){var n;(n=this.colorTexture)===null||n===void 0||n.destroy()}},{key:"getColorRampBar",value:function(n,i){switch(n.type){case"cat":return(0,ze.hj)(n);case"quantize":return(0,ze.NJ)(n);case"custom":return(0,ze.Oc)(n,i);case"linear":return(0,ze.M4)(n,i);default:return(0,ze.Cl)(n)}}},{key:"getTextureKey",value:function(n,i){var a;return"".concat(n.colors.join("_"),"_").concat(n==null||(a=n.positions)===null||a===void 0?void 0:a.join("_"),"_").concat(n.type,"_").concat(i==null?void 0:i.join("_"))}}]),e}(),Lc=["passes"],Rl=["moduleName","vertexShader","fragmentShader","inject","triangulation","styleOption","pickingEnabled"],vs,uu,Sf;function Bc(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Sc(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function Sc(e,r){if(e){if(typeof e=="string")return Tf(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tf(e,r)}}function Tf(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function Su(e){var r=$o();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ea=ze.rU.isEqual,Qs=ze.rU.isFunction,Tu=ze.rU.isNumber,Ga=ze.rU.isObject,Ml=ze.rU.isPlainObject,al=ze.rU.isUndefined,lu=0,es=(vs=(0,$.yT)($.vK.IGlobalConfigService),uu=function(e){(0,Ai.Z)(n,e);var r=Su(n);function n(){var i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,Ge.Z)(this,n),i=r.call(this),(0,G.Z)((0,gn.Z)(i),"id","".concat(lu++)),(0,G.Z)((0,gn.Z)(i),"name","".concat(lu)),(0,G.Z)((0,gn.Z)(i),"visible",!0),(0,G.Z)((0,gn.Z)(i),"zIndex",0),(0,G.Z)((0,gn.Z)(i),"inited",!1),(0,G.Z)((0,gn.Z)(i),"layerModelNeedUpdate",!1),(0,G.Z)((0,gn.Z)(i),"pickedFeatureID",null),(0,G.Z)((0,gn.Z)(i),"selectedFeatureID",null),(0,G.Z)((0,gn.Z)(i),"styleNeedUpdate",!1),(0,G.Z)((0,gn.Z)(i),"forceRender",!1),(0,G.Z)((0,gn.Z)(i),"clusterZoom",0),(0,G.Z)((0,gn.Z)(i),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,G.Z)((0,gn.Z)(i),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,G.Z)((0,gn.Z)(i),"hooks",{init:new us.S$,afterInit:new us.oI,beforeRender:new us.oI,beforeRenderData:new us.bf,afterRender:new us.ni,beforePickingEncode:new us.ni,afterPickingEncode:new us.ni,beforeHighlight:new us.ni(["pickedColor"]),afterHighlight:new us.ni,beforeSelect:new us.ni(["pickedColor"]),afterSelect:new us.ni,beforeDestroy:new us.ni,afterDestroy:new us.ni}),(0,G.Z)((0,gn.Z)(i),"models",[]),(0,G.Z)((0,gn.Z)(i),"startInit",!1),(0,G.Z)((0,gn.Z)(i),"layerChildren",[]),(0,G.Z)((0,gn.Z)(i),"masks",[]),(0,wa.Z)((0,gn.Z)(i),"configService",Sf,(0,gn.Z)(i)),(0,G.Z)((0,gn.Z)(i),"animateOptions",{enable:!1}),(0,G.Z)((0,gn.Z)(i),"currentPickId",null),(0,G.Z)((0,gn.Z)(i),"encodeStyleAttribute",{}),(0,G.Z)((0,gn.Z)(i),"enableShaderEncodeStyles",[]),(0,G.Z)((0,gn.Z)(i),"enableDataEncodeStyles",[]),(0,G.Z)((0,gn.Z)(i),"pendingStyleAttributes",[]),(0,G.Z)((0,gn.Z)(i),"scaleOptions",{}),(0,G.Z)((0,gn.Z)(i),"animateStatus",!1),(0,G.Z)((0,gn.Z)(i),"isDestroyed",!1),(0,G.Z)((0,gn.Z)(i),"uniformBuffers",[]),(0,G.Z)((0,gn.Z)(i),"encodeDataLength",0),(0,G.Z)((0,gn.Z)(i),"sourceEvent",function(){i.dataState.dataSourceNeedUpdate=!0;var s=i.getLayerConfig();s&&s.autoFit&&i.fitBounds(s.fitBoundsOptions);var c=i.layerSource.getSourceCfg().autoRender;c&&setTimeout(function(){i.reRender()},10)}),i.name=a.name||i.id,i.zIndex=a.zIndex||0,i.rawConfig=a,i}return(0,We.Z)(n,[{key:"addMask",value:function(a){this.masks.push(a),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}},{key:"removeMask",value:function(a){var s=this.masks.indexOf(a);s>-1&&this.masks.splice(s,1),this.updateLayerConfig({maskLayers:this.masks})}},{key:"disableMask",value:function(){this.updateLayerConfig({enableMask:!1})}},{key:"enableMask",value:function(){this.updateLayerConfig({enableMask:!0})}},{key:"addMaskLayer",value:function(a){this.masks.push(a)}},{key:"removeMaskLayer",value:function(a){var s=this.masks.indexOf(a);s>-1&&this.masks.splice(s,1),a.destroy()}},{key:"getAttribute",value:function(a){return this.styleAttributeService.getLayerStyleAttribute(a)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(a){var s=this;if(Object.keys(a).map(function(p){p in s.rawConfig&&(s.rawConfig[p]=a[p])}),!this.startInit)this.needUpdateConfig=(0,fe.Z)((0,fe.Z)({},this.needUpdateConfig),a);else{var c=this.container.get($.vK.SceneID);this.configService.setLayerConfig(c,this.id,(0,fe.Z)((0,fe.Z)((0,fe.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),a)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(a,s){this.container=a,this.sceneContainer=s}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(a){return this.plugins.push(a),this}},{key:"init",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c=this,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:p=this.container.get($.vK.SceneID),this.startInit=!0,this.configService.setLayerConfig(p,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get($.vK.IIconService),this.fontService=this.container.get($.vK.IFontService),this.rendererService=this.container.get($.vK.IRendererService),this.layerService=this.container.get($.vK.ILayerService),this.debugService=this.container.get($.vK.IDebugService),this.interactionService=this.container.get($.vK.IInteractionService),this.pickingService=this.container.get($.vK.IPickingService),this.mapService=this.container.get($.vK.IMapService),g=this.getLayerConfig(),b=g.enableMultiPassRenderer,w=g.passes,b&&w!==null&&w!==void 0&&w.length&&w.length>0&&this.mapService.on("mapAfterFrameChange",function(){c.renderLayers()}),this.cameraService=this.container.get($.vK.ICameraService),this.coordinateService=this.container.get($.vK.ICoordinateSystemService),this.shaderModuleService=this.container.get($.vK.IShaderModuleService),this.postProcessingPassFactory=this.container.get($.vK.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get($.vK.IFactoryNormalPass),this.styleAttributeService=this.container.get($.vK.IStyleAttributeService),b&&(this.multiPassRenderer=this.container.get($.vK.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(ut){var Ot=ut.attributeName,Bt=ut.attributeField,ir=ut.attributeValues,xr=ut.updateOptions;c.styleAttributeService.updateStyleAttribute(Ot,{scale:(0,fe.Z)({field:Bt},c.splitValuesAndCallbackInAttribute(ir,Bt?void 0:c.getLayerConfig()[Ot]))},xr)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll($.vK.ILayerPlugin),I=Bc(this.plugins);try{for(I.s();!(W=I.n()).done;)pe=W.value,pe.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(ut){I.e(ut)}finally{I.f()}return this.layerPickService=new Eu(this),this.textureService=new su(this),this.log($.Or.LayerInitStart),Fe.next=31,this.hooks.init.promise();case 31:this.log($.Or.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 36:case"end":return Fe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"log",value:function(a){var s,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var p="".concat(this.id,".").concat(c,".").concat(a),g={id:this.id,type:this.type};(s=this.debugService)===null||s===void 0||s.log(p,g)}}},{key:"updateModelData",value:function(a){a.attributes&&a.elements?this.models.map(function(s){s.updateAttributesAndElements(a.attributes,a.elements)}):console.warn("data error")}},{key:"setLayerPickService",value:function(a){this.layerPickService=a}},{key:"prepareBuildModel",value:function(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});var a=this.getLayerConfig(),s=a.animateOption;s!=null&&s.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(a,s,c){return this.updateStyleAttribute("color",a,s,c),this}},{key:"texture",value:function(a,s,c){return this.updateStyleAttribute("texture",a,s,c),this}},{key:"rotate",value:function(a,s,c){return this.updateStyleAttribute("rotate",a,s,c),this}},{key:"size",value:function(a,s,c){return this.updateStyleAttribute("size",a,s,c),this}},{key:"filter",value:function(a,s,c){var p=this.updateStyleAttribute("filter",a,s,c);return this.dataState.dataSourceNeedUpdate=p&&this.inited,this}},{key:"shape",value:function(a,s,c){this.shapeOption={field:a,values:s};var p=this.updateStyleAttribute("shape",a,s,c);return this.dataState.dataSourceNeedUpdate=p&&this.inited,this}},{key:"label",value:function(a,s,c){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:a,attributeValues:s,updateOptions:c}),this}},{key:"animate",value:function(a){var s={};return Ga(a)?(s.enable=!0,s=(0,fe.Z)((0,fe.Z)({},s),a)):s.enable=a,this.updateLayerConfig({animateOption:s}),this}},{key:"source",value:function(a,s){return(a==null?void 0:a.type)==="source"?(this.setSource(a),this):(this.sourceOption={data:a,options:s},this.clusterZoom=0,this)}},{key:"setData",value:function(a,s){var c=this;return this.inited?(this.log($.Or.SourceInitStart,$.KD.UPDATE),this.layerSource.setData(a,s),this.log($.Or.SourceInitEnd,$.KD.UPDATE)):this.on("inited",function(){c.log($.Or.SourceInitStart,$.KD.UPDATE);var p=c.getSource();p?c.layerSource.setData(a,s):c.source(new ou(a,s)),c.layerSource.once("update",function(){c.log($.Or.SourceInitEnd,$.KD.UPDATE)})}),this}},{key:"style",value:function(a){var s=this,c=a.passes,p=(0,Ws.Z)(a,Lc);c&&il(c).forEach(function(b){var w=s.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(b[0]);w&&w.updateOptions(b[1])}),p.borderColor&&(p.stroke=p.borderColor),p.borderWidth&&(p.strokeWidth=p.borderWidth);var g=p;return Object.keys(p).forEach(function(b){var w=p[b];Array.isArray(w)&&w.length===2&&!Tu(w[0])&&!Tu(w[1])&&(g[b]={field:w[0],value:w[1]})}),this.encodeStyle(g),this.updateLayerConfig(g),this}},{key:"encodeStyle",value:function(a){var s=this;Object.keys(a).forEach(function(c){[].concat((0,jr.Z)(s.enableShaderEncodeStyles),(0,jr.Z)(s.enableDataEncodeStyles)).includes(c)&&Ml(a[c])&&(a[c].field||a[c].value)&&!ea(s.encodeStyleAttribute[c],a[c])?(s.encodeStyleAttribute[c]=a[c],s.updateStyleAttribute(c,a[c].field,a[c].value),s.inited&&(s.dataState.dataMappingNeedUpdate=!0)):s.encodeStyleAttribute[c]&&(delete s.encodeStyleAttribute[c],s.dataState.dataSourceNeedUpdate=!0)})}},{key:"scale",value:function(a,s){var c=(0,fe.Z)({},this.scaleOptions);if(Ga(a)?this.scaleOptions=(0,fe.Z)((0,fe.Z)({},this.scaleOptions),a):this.scaleOptions[a]=s,this.styleAttributeService&&!ea(c,this.scaleOptions)){var p=Ga(a)?a:(0,G.Z)({},a,s);this.styleAttributeService.updateScaleAttribute(p)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}},{key:"prerender",value:function(){}},{key:"render",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(a),this))}},{key:"renderMultiPass",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){p.next=2;break}return p.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){p.next=7;break}return p.next=5,this.multiPassRenderer.render();case 5:p.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"active",value:function(a){var s={};return s.enableHighlight=Ga(a)?!0:a,Ga(a)?(s.enableHighlight=!0,a.color&&(s.highlightColor=a.color),a.mix&&(s.activeMix=a.mix)):s.enableHighlight=!!a,this.updateLayerConfig(s),this}},{key:"setActive",value:function(a,s){var c=this;if(Ga(a)){var p=a.x,g=p===void 0?0:p,b=a.y,w=b===void 0?0:b;this.updateLayerConfig({highlightColor:Ga(s)?s.color:this.getLayerConfig().highlightColor,activeMix:Ga(s)?s.mix:this.getLayerConfig().activeMix}),this.pick({x:g,y:w})}else this.updateLayerConfig({pickedFeatureID:a,highlightColor:Ga(s)?s.color:this.getLayerConfig().highlightColor,activeMix:Ga(s)?s.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call((0,ze.Z6)(a)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"select",value:function(a){var s={};return s.enableSelect=Ga(a)?!0:a,Ga(a)?(s.enableSelect=!0,a.color&&(s.selectColor=a.color),a.mix&&(s.selectMix=a.mix)):s.enableSelect=!!a,this.updateLayerConfig(s),this}},{key:"setSelect",value:function(a,s){var c=this;if(Ga(a)){var p=a.x,g=p===void 0?0:p,b=a.y,w=b===void 0?0:b;this.updateLayerConfig({selectColor:Ga(s)?s.color:this.getLayerConfig().selectColor,selectMix:Ga(s)?s.mix:this.getLayerConfig().selectMix}),this.pick({x:g,y:w})}else this.updateLayerConfig({pickedFeatureID:a,selectColor:Ga(s)?s.color:this.getLayerConfig().selectColor,selectMix:Ga(s)?s.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,ze.Z6)(a)).then(function(){setTimeout(function(){c.reRender()},1)})}},{key:"setBlend",value:function(a){return this.updateLayerConfig({blend:a}),this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(a){return this.zIndex=a,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(a){this.currentPickId=a}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(a){this.selectedFeatureID=a}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var a=this.mapService.getZoom(),s=this.getLayerConfig(),c=s.visible,p=s.minZoom,g=p===void 0?-1/0:p,b=s.maxZoom,w=b===void 0?1/0:b;return!!c&&a>=g&&a<w}},{key:"setMultiPass",value:function(a,s){if(this.updateLayerConfig({enableMultiPassRenderer:a}),s&&this.updateLayerConfig({passes:s}),a){var c=this.getLayerConfig(),p=c.passes,g=p===void 0?[]:p;this.multiPassRenderer=Ec(this,g,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var b=this.rendererService.getViewportSize(),w=b.width,I=b.height;this.multiPassRenderer.resize(w,I)}return this}},{key:"setMinZoom",value:function(a){return this.updateLayerConfig({minZoom:a}),this}},{key:"getMinZoom",value:function(){var a=this.getLayerConfig(),s=a.minZoom;return s}},{key:"getMaxZoom",value:function(){var a=this.getLayerConfig(),s=a.maxZoom;return s}},{key:"get",value:function(a){var s=this.getLayerConfig();return s[a]}},{key:"setMaxZoom",value:function(a){return this.updateLayerConfig({maxZoom:a}),this}},{key:"setAutoFit",value:function(a){return this.updateLayerConfig({autoFit:a}),this}},{key:"fitBounds",value:function(a){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var s=this.getSource(),c=s.extent,p=c.some(function(g){return Math.abs(g)===1/0});return p?this:(this.mapService.fitBounds([[c[0],c[1]],[c[2],c[3]]],a),this)}},{key:"destroy",value:function(){var a,s,c,p,g,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.isDestroyed){(a=this.layerModel)===null||a===void 0||a.uniformBuffers.forEach(function(W){W.destroy()}),this.layerChildren.map(function(W){return W.destroy(!1)}),this.layerChildren=[];var w=this.getLayerConfig(),I=w.maskfence;I&&(this.masks.map(function(W){return W.destroy(!1)}),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(s=this.multiPassRenderer)===null||s===void 0||s.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(c=this.layerModel)===null||c===void 0||c.clearModels(b),(p=this.tileLayer)===null||p===void 0||p.destroy(),this.models=[],(g=this.debugService)===null||g===void 0||g.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var a;this.models.forEach(function(s){return s.destroy()}),(a=this.layerModel)===null||a===void 0||a.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(a){return a.needRescale||a.needRemapping||a.needRegenerateVertices}).length}},{key:"setSource",value:function(a){var s=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=a,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var c=this.mapService.getZoom();this.layerSource.updateClusterData(c)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(p){var g=p.type;if(s.coordCenter===void 0){var b,w=s.layerSource.center;s.coordCenter=w,(b=s.mapService)!==null&&b!==void 0&&b.setCoordCenter&&s.mapService.setCoordCenter(w)}if(g==="update"){if(s.tileLayer){s.tileLayer.reload();return}s.sourceEvent()}})}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(a){this.encodedData=a,this.encodeDataLength=a.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(a){return this.styleAttributeService.getLayerAttributeScale(a)}},{key:"getLegend",value:function(a){var s,c,p,g=this.styleAttributeService.getLayerStyleAttribute(a),b=(g==null||(s=g.scale)===null||s===void 0?void 0:s.scalers)||[];return{type:(c=b[0].option)===null||c===void 0?void 0:c.type,field:g==null||(p=g.scale)===null||p===void 0?void 0:p.field,items:this.getLegendItems(a)}}},{key:"getLegendItems",value:function(a){var s=this.styleAttributeService.getLayerAttributeScale(a);if(!s)return[];if(s.invertExtent){var c=s.range().map(function(b){return(0,G.Z)({value:s.invertExtent(b)},a,b)});return c}else if(s.ticks){var p=s.ticks().map(function(b){return(0,G.Z)({value:b},a,s(b))});return p}else if(s!=null&&s.domain){var g=s.domain().filter(function(b){return!al(b)}).map(function(b){return(0,G.Z)({value:b},a,s(b))});return g}return[]}},{key:"pick",value:function(a){var s=a.x,c=a.y;this.interactionService.triggerHover({x:s,y:c})}},{key:"boxSelect",value:function(a,s){this.pickingService.boxPickLayer(this,a,s)}},{key:"buildLayerModel",value:function(){var i=(0,He.Z)(Ne().mark(function s(c){var p=this,g,b,w,I,W,pe,Me,Fe,ut,Ot,Bt,ir,xr,qr;return Ne().wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:return g=c.moduleName,b=c.vertexShader,w=c.fragmentShader,I=c.inject,W=c.triangulation,pe=c.styleOption,Me=c.pickingEnabled,Fe=Me===void 0?!0:Me,ut=(0,Ws.Z)(c,Rl),this.shaderModuleService.registerModule(g,{vs:b,fs:w,inject:I}),Ot=this.shaderModuleService.getModule(g),Bt=Ot.vs,ir=Ot.fs,xr=Ot.uniforms,qr=this.rendererService.createModel,mr.abrupt("return",new Promise(function(sn){var ti=p.styleAttributeService.createAttributesAndIndices(p.encodedData,W,pe),Bi=ti.attributes,ai=ti.elements,ra=ti.count,fa=[].concat((0,jr.Z)(p.layerModel.uniformBuffers),(0,jr.Z)(p.rendererService.uniformBuffers),[p.getLayerUniformBuffer()]);Fe&&fa.push(p.getPickingUniformBuffer());var nu=(0,fe.Z)({attributes:Bi,uniforms:xr,fs:ir,vs:Bt,elements:ai,blend:Du[$.h0.normal],uniformBuffers:fa,textures:p.layerModel.textures},ut);ra&&(nu.count=ra);var yl=qr(nu);sn(yl)}));case 5:case"end":return mr.stop()}},s,this)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"createAttributes",value:function(a){var s=a.triangulation,c=this.styleAttributeService.createAttributes(this.encodedData,s),p=c.attributes;return p}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(a){var s=this.getLayerConfig(),c=s.enableHighlight,p=c===void 0?!0:c,g=s.enableSelect,b=g===void 0?!0:g,w=this.eventNames().indexOf(a)!==-1||this.eventNames().indexOf("un"+a)!==-1;return(a==="click"||a==="dblclick")&&b&&(w=!0),a==="mousemove"&&(p||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(w=!0),this.isVisible()&&w}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return p.stop()}},s)}));function a(){return i.apply(this,arguments)}return a}()},{key:"rebuildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.buildModels();case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"renderMulPass",value:function(){var i=(0,He.Z)(Ne().mark(function s(c){return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,c.render();case 2:case"end":return g.stop()}},s)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"renderModels",value:function(){var a=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(function(c){c.draw({uniforms:a.layerModel.getUninforms(),blend:a.layerModel.getBlend(),stencil:a.layerModel.getStencil(s),textures:a.layerModel.textures},(s==null?void 0:s.ispick)||!1)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(a,s,c,p){var g=this.configService.getAttributeConfig(this.id)||{};return ea(g[a],{field:s,values:c})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(a)!==-1&&this.configService.setAttributeConfig(this.id,(0,G.Z)({},a,{field:s,values:c})),this.startInit?this.styleAttributeService.updateStyleAttribute(a,{scale:(0,fe.Z)({field:s},this.splitValuesAndCallbackInAttribute(c,this.getLayerConfig()[s]))},p):this.pendingStyleAttributes.push({attributeName:a,attributeField:s,attributeValues:c,updateOptions:p}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(a){console.warn("empty fn")}},{key:"processData",value:function(a){return a}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return this.models.forEach(function(w){return w.destroy()}),this.models=[],this.uniformBuffers.forEach(function(w){w.destroy()}),this.uniformBuffers=[],c=this.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0}),this.uniformBuffers.push(c),p=this.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0}),this.uniformBuffers.push(p),b.next=10,this.layerModel.initModels();case 10:this.models=b.sent;case 11:case"end":return b.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getLayerUniformBuffer",value:function(){return this.uniformBuffers[0]}},{key:"getPickingUniformBuffer",value:function(){return this.uniformBuffers[1]}},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(a){return{values:Qs(a)?void 0:a,callback:Qs(a)?a:void 0}}}]),n}(Sl.EventEmitter),Sf=(0,qs.Z)(uu.prototype,"configService",[vs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu);function ic(e,r){return{enable:e,mask:255,func:{cmp:$.gl.EQUAL,ref:r?1:0,mask:1}}}function Ci(e){return e.maskOperation===$.lE.OR?{enable:!0,mask:255,func:{cmp:$.gl.ALWAYS,ref:1,mask:255},opFront:{fail:$.gl.KEEP,zfail:$.gl.REPLACE,zpass:$.gl.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===$.yn.SINGLE||e.stencilIndex===0?$.gl.ALWAYS:$.gl.LESS,ref:e.stencilType===$.yn.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:$.gl.KEEP,zfail:$.gl.REPLACE,zpass:$.gl.REPLACE}}}var rn=function(e){return e[e.POSITION=0]="POSITION",e[e.COLOR=1]="COLOR",e[e.VERTEX_ID=2]="VERTEX_ID",e[e.PICKING_COLOR=3]="PICKING_COLOR",e[e.STROKE=4]="STROKE",e[e.OPACITY=5]="OPACITY",e[e.OFFSETS=6]="OFFSETS",e[e.ROTATION=7]="ROTATION",e[e.EXTRUSION_BASE=8]="EXTRUSION_BASE",e[e.SIZE=9]="SIZE",e[e.SHAPE=10]="SHAPE",e[e.EXTRUDE=11]="EXTRUDE",e[e.MAX=12]="MAX",e[e.NORMAL=13]="NORMAL",e[e.UV=14]="UV",e[e.LINEAR=15]="LINEAR",e}({});function cu(e){switch(e){case"rotation":return{name:"Rotation",type:$.GC.Attribute,descriptor:{name:"a_Rotation",shaderLocation:rn.ROTATION,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(n){var i=n.rotation,a=i===void 0?0:i;return Array.isArray(a)?[a[0]]:[a]}}};case"stroke":return{name:"stroke",type:$.GC.Attribute,descriptor:{name:"a_Stroke",shaderLocation:rn.STROKE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(n){var i=n.stroke,a=i===void 0?[1,1,1,1]:i;return a}}};case"opacity":return{name:"opacity",type:$.GC.Attribute,descriptor:{name:"a_Opacity",shaderLocation:rn.OPACITY,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(n){var i=n.opacity,a=i===void 0?1:i;return[a]}}};case"extrusionBase":return{name:"extrusionBase",type:$.GC.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:rn.EXTRUSION_BASE,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(n){var i=n.extrusionBase,a=i===void 0?0:i;return[a]}}};case"offsets":return{name:"offsets",type:$.GC.Attribute,descriptor:{name:"a_Offsets",shaderLocation:rn.OFFSETS,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(n){var i=n.offsets;return i}}};case"thetaOffset":return{name:"thetaOffset",type:$.GC.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:15,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(n){var i=n.thetaOffset,a=i===void 0?1:i;return[a]}}};default:return}}var ws={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},fu={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};function Ro(e){var r="";return Object.keys(e).forEach(function(n){var i=e[n];Array.isArray(i)?r+="vec".concat(i.length," ").concat(n,`;
`):r+="flot ".concat(n,`;
`)}),r}function Fs(e){return Math.max(Math.ceil(e/4)*4,4)}var ku,Il,Na,No={opacity:rn.OPACITY,stroke:rn.STROKE,offsets:rn.OFFSETS,rotation:rn.ROTATION,extrusionBase:rn.EXTRUSION_BASE,thetaOffset:15},ao=(ku=(0,$.yT)($.vK.IGlobalConfigService),Il=function(){function e(r){(0,Ge.Z)(this,e),(0,G.Z)(this,"uniformBuffers",[]),(0,G.Z)(this,"textures",[]),(0,G.Z)(this,"preStyleAttribute",{}),(0,G.Z)(this,"encodeStyleAttribute",{}),(0,wa.Z)(this,"configService",Na,this),this.layer=r,this.rendererService=r.getContainer().get($.vK.IRendererService),this.pickingService=r.getContainer().get($.vK.IPickingService),this.shaderModuleService=r.getContainer().get($.vK.IShaderModuleService),this.styleAttributeService=r.getContainer().get($.vK.IStyleAttributeService),this.mapService=r.getContainer().get($.vK.IMapService),this.iconService=r.getContainer().get($.vK.IIconService),this.fontService=r.getContainer().get($.vK.IFontService),this.cameraService=r.getContainer().get($.vK.ICameraService),this.layerService=r.getContainer().get($.vK.ILayerService),this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();var n=this.rendererService.createTexture2D;this.createTexture2D=n}return(0,We.Z)(e,[{key:"getBlend",value:function(){var n=this.layer.getLayerConfig(),i=n.blend,a=i===void 0?"normal":i;return Du[$.h0[a]]}},{key:"getStencil",value:function(n){var i=this.layer.getLayerConfig(),a=i.mask,s=a===void 0?!1:a,c=i.maskInside,p=c===void 0?!0:c,g=i.enableMask,b=i.maskOperation,w=b===void 0?$.lE.AND:b;if(this.layer.type==="MaskLayer")return Ci({isStencil:!0,stencilType:$.yn.SINGLE});if(n.isStencil)return Ci((0,fe.Z)((0,fe.Z)({},n),{},{maskOperation:w}));var I=s||g&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return ic(I,p)}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){var n=this.getCommonUniformsInfo(),i=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();var a=(0,fe.Z)((0,fe.Z)({},i.uniformsOption),n.uniformsOption);return!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(a.u_texture=this.textures[0]),a}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var r=(0,He.Z)(Ne().mark(function i(){return Ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",!1);case 1:case"end":return s.stop()}},i)}));function n(){return r.apply(this,arguments)}return n}()},{key:"buildModels",value:function(){var r=(0,He.Z)(Ne().mark(function i(){return Ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return s.stop()}},i)}));function n(){return r.apply(this,arguments)}return n}()},{key:"initModels",value:function(){var r=(0,He.Z)(Ne().mark(function i(){return Ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return s.stop()}},i)}));function n(){return r.apply(this,arguments)}return n}()},{key:"clearModels",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"prerender",value:function(){}},{key:"render",value:function(n){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(n){return[n.enable?0:1,n.duration||4,n.interval||.2,n.trailLength||.1]}},{key:"startModelAnimate",value:function(){var n=this.layer.getLayerConfig(),i=n.animateOption;i.enable&&this.layer.setAnimateStartTime()}},{key:"getInject",value:function(){var n=this.layer.encodeStyleAttribute,i="",a=[];this.layer.enableShaderEncodeStyles.forEach(function(p){n[p]?i+="#define USE_ATTRIBUTE_".concat(p.toUpperCase(),` 0.0; 

`):a.push("  ".concat(fu[p]," u_").concat(p,";"));var g=No[p];!g&&p==="THETA_OFFSET"&&(g=15),i+=`
          #ifdef USE_ATTRIBUTE_`.concat(p.toUpperCase(),`
          layout(location = `).concat(No[p],") in ").concat(fu[p]," a_").concat(p.charAt(0).toUpperCase()+p.slice(1),`;
        #endif

        `)});var s=a.length?`
layout(std140) uniform AttributeUniforms {
`.concat(a.join(`
`),`
};
    `):"";i+=s;var c="";return this.layer.enableShaderEncodeStyles.forEach(function(p){c+=`

    #ifdef USE_ATTRIBUTE_`.concat(p.toUpperCase(),`
      `).concat(fu[p]," ").concat(p,"  = a_").concat(p.charAt(0).toUpperCase()+p.slice(1),`;
    #else
      `).concat(fu[p]," ").concat(p," = u_").concat(p,`;
    #endif

    `)}),{"vs:#decl":i,"fs:#decl":s,"vs:#main-start":c}}},{key:"getStyleAttribute",value:function(){var n=this,i={};return this.layer.enableShaderEncodeStyles.forEach(function(a){if(!n.layer.encodeStyleAttribute[a]){var s=n.layer.getLayerConfig()[a],c=typeof s=="undefined"?ws[a]:s;a==="stroke"&&(c=(0,ze.CI)(c)),i["u_"+a]=c}}),i}},{key:"registerStyleAttribute",value:function(){var n=this;Object.keys(this.layer.encodeStyleAttribute).forEach(function(i){var a=cu(i);a&&(n.styleAttributeService.registerStyleAttribute(a),a.descriptor&&(a.descriptor.shaderLocation=No[i]))})}},{key:"updateEncodeAttribute",value:function(n,i){this.encodeStyleAttribute[n]=i}},{key:"initUniformsBuffer",value:function(){var n=this.getUniformsBufferInfo(this.getStyleAttribute()),i=this.getCommonUniformsInfo();n.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(Fs(n.uniformsLength)).fill(0),isUBO:!0}),this.uniformBuffers.push(this.attributeUnifoms)),i.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(Fs(i.uniformsLength)).fill(0),isUBO:!0}),this.uniformBuffers.push(this.commonUnifoms))}},{key:"getUniformsBufferInfo",value:function(n){var i=0,a=[];return Object.values(n).forEach(function(s){Array.isArray(s)?(a.push.apply(a,(0,jr.Z)(s)),i+=s.length):typeof s=="number"?(a.push(s),i+=1):typeof s=="boolean"&&(a.push(Number(s)),i+=1)}),{uniformsOption:n,uniformsLength:i,uniformsArray:a}}},{key:"getCommonUniformsInfo",value:function(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}},{key:"updateStyleUnifoms",value:function(){var n,i,a=this.getUniformsBufferInfo(this.getStyleAttribute()),s=a.uniformsArray,c=this.getCommonUniformsInfo(),p=c.uniformsArray;(n=this.attributeUnifoms)===null||n===void 0||n.subData({offset:0,data:new Uint8Array(new Float32Array(s).buffer)}),(i=this.commonUnifoms)===null||i===void 0||i.subData({offset:0,data:new Uint8Array(new Float32Array(p).buffer)})}}]),e}(),Na=(0,qs.Z)(Il.prototype,"configService",[ku],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Il),ol=_(9187),sl=_.n(ol),ul=100,hu=36,Tc=40;function ll(e){return e/180*Math.acos(-1)}function Kc(e){var r=ll(e[0])+Math.PI/2,n=ll(e[1]),i=ul+Math.random()*.4,a=i*Math.cos(n)*Math.cos(r),s=i*Math.cos(n)*Math.sin(r),c=i*Math.sin(n);return[s,c,a]}function ac(e,r){var n=mat4.create(),i=mat4.create(),a=vec3.fromValues(0,1,0),s=vec3.fromValues(0,0,0);r=r||{},e=typeof e!="undefined"?e:1;for(var c=typeof r.segments!="undefined"?r.segments:32,p=2+c,g=2*p,b=[],w=[],I=[],W=[],pe=[],Me=[],Fe=0;Fe<=p;Fe++){for(var ut=Fe/p,Ot=ut*Math.PI,Bt=0;Bt<=g;Bt++){var ir=Bt/g,xr=ir*Math.PI*2;mat4.identity(i),mat4.rotateZ(i,i,-Ot),mat4.identity(n),mat4.rotateY(n,n,xr),vec3.transformMat4(s,a,i),vec3.transformMat4(s,s,n),vec3.scale(s,s,-e),I.push(s.slice()),W.push.apply(W,_toConsumableArray(s.slice())),vec3.normalize(s,s),pe.push.apply(pe,_toConsumableArray(s.slice())),Me.push([ir,1-ut]),W.push(ir,1-ut)}if(Fe>0)for(var qr=I.length,Ir=qr-2*(g+1);Ir+g+2<qr;Ir++)b.push([Ir,Ir+1,Ir+g+1]),w.push(Ir,Ir+1,Ir+g+1),b.push([Ir+g+1,Ir+1,Ir+g+2]),w.push(Ir+g+1,Ir+1,Ir+g+2)}return{cells:b,positions:I,uvs:Me,positionsArr:W,indicesArr:w,normalArr:pe}}var Vi=_(31437),Ol=Vi.Ue(),Pl=Vi.Ue(),yo=Vi.Ue(),Gu=Vi.Ue(),Ii=Vi.Ue();function Ns(e,r,n,i,a){Vi.IH(e,n,i),Vi.Fv(e,e),r=Vi.al(-e[1],e[0]);var s=Vi.al(-n[1],n[0]);return[a/Vi.AK(r,s),r]}function cl(e,r){return Vi.t8(e,-r[1],r[0])}function eo(e,r,n){return Vi.lu(e,r,n),Vi.Fv(e,e),e}function Wo(e,r){return e[0]===r[0]&&e[1]===r[1]}function Wl(e){for(var r=new Map,n=0;n<e.length;n++){var i=e[0].toString()+"-"+e[1].toString();r.get(i)?(e.splice(n,1),n++):r.set(i,i)}return e}var oc=function(){function e(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,Ge.Z)(this,e),(0,G.Z)(this,"lastFlip",-1),(0,G.Z)(this,"miter",Vi.al(0,0)),(0,G.Z)(this,"started",!1),(0,G.Z)(this,"dash",!1),(0,G.Z)(this,"totalDistance",0),(0,G.Z)(this,"currentIndex",0),this.join=r.join||"miter",this.cap=r.cap||"butt",this.miterLimit=r.miterLimit||10,this.thickness=r.thickness||1,this.dash=r.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,We.Z)(e,[{key:"simpleExtrude",value:function(n){var i=this.complex;if(n.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=n.length,s=i.startIndex,c=1;c<a;c++){var p=n[c-1],g=n[c],b=c<n.length-1?n[c+1]:null,w=this.simpleSegment(i,s,p,g,b);s+=w}if(this.dash)for(var I=0;I<i.positions.length/6;I++)i.positions[I*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleExtrude_gaode2",value:function(n,i){var a=this.complex;if(n.length<=1)return a;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=n.length,c=a.startIndex,p=1;p<s;p++){var g,b,w,I=n[p-1];I.push((g=i[p-1][2])!==null&&g!==void 0?g:0);var W=i[p-1],pe=n[p];pe.push((b=i[p][2])!==null&&b!==void 0?b:0);var Me=i[p],Fe=p<n.length-1?[].concat((0,jr.Z)(n[p+1]),[(w=i[p+1][2])!==null&&w!==void 0?w:0]):null,ut=p<i.length-1?i[p+1]:null,Ot=this.simpleSegment(a,c,I,pe,Fe,W,Me,ut);c+=Ot}if(this.dash)for(var Bt=0;Bt<a.positions.length/6;Bt++)a.positions[Bt*6+5]=this.totalDistance;return a.startIndex=a.positions.length/6,a}},{key:"extrude_gaode2",value:function(n,i){var a=this.complex;if(n.length<=1)return a;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var s=n.length,c=a.startIndex,p=1;p<s;p++){var g,b,w,I=n[p-1];I.push((g=i[p-1][2])!==null&&g!==void 0?g:0);var W=i[p-1],pe=n[p];pe.push((b=i[p][2])!==null&&b!==void 0?b:0);var Me=i[p],Fe=p<n.length-1?[].concat((0,jr.Z)(n[p+1]),[(w=i[p+1][2])!==null&&w!==void 0?w:0]):null,ut=p<i.length-1?i[p+1]:null,Ot=this.segment_gaode2(a,c,I,pe,Fe,W,Me,ut);c+=Ot}if(this.dash)for(var Bt=0;Bt<a.positions.length/6;Bt++)a.positions[Bt*6+5]=this.totalDistance;return a.startIndex=a.positions.length/6,a}},{key:"extrude",value:function(n){var i=this.complex;if(n.length<=1)return i;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=n.length,s=i.startIndex,c=1;c<a;c++){var p=n[c-1],g=n[c],b=c<n.length-1?n[c+1]:null,w=this.segment(i,s,p,g,b);s+=w}if(this.dash)for(var I=0;I<i.positions.length/6;I++)i.positions[I*6+5]=this.totalDistance;return i.startIndex=i.positions.length/6,i}},{key:"simpleSegment",value:function(n,i,a,s,c){var p=0,g=n.indices,b=n.positions,w=n.normals,I=(0,ze.Z)([s[0],s[1]]),W=(0,ze.Z)([a[0],a[1]]);eo(yo,I,W);var pe=0;if(this.dash&&(pe=this.lineSegmentDistance(I,W),this.totalDistance+=pe),this.normal||(this.normal=Vi.Ue(),cl(this.normal,yo)),this.started||(this.started=!0,this.extrusions(b,w,a,this.normal,this.thickness,this.totalDistance-pe)),g.push(i+0,i+1,i+2),!c)cl(this.normal,yo),this.extrusions(b,w,s,this.normal,this.thickness,this.totalDistance),g.push.apply(g,(0,jr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),p+=2;else{var Me=(0,ze.Z)([c[0],c[1]]);Wo(I,Me)&&Vi.IH(Me,I,Vi.Fv(Me,Vi.$X(Me,I,W))),eo(Gu,Me,I);var Fe=Ns(Ii,Vi.Ue(),yo,Gu,this.thickness),ut=(0,Fi.Z)(Fe,2),Ot=ut[0],Bt=ut[1],ir=Vi.AK(Ii,this.normal)<0?-1:1;this.extrusions(b,w,s,Bt,Ot,this.totalDistance),g.push.apply(g,(0,jr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),ir=-1,Vi.JG(this.normal,Bt),p+=2,this.lastFlip=ir}return p}},{key:"segment_gaode2",value:function(n,i,a,s,c,p,g,b){var w=0,I=n.indices,W=n.positions,pe=n.normals,Me=this.cap==="square",Fe=this.join==="bevel",ut=(0,ze.Z)([g[0],g[1]]),Ot=(0,ze.Z)([p[0],p[1]]);eo(yo,s,a);var Bt=0;if(this.dash&&(Bt=this.lineSegmentDistance(ut,Ot),this.totalDistance+=Bt),this.normal||(this.normal=Vi.Ue(),cl(this.normal,yo)),!this.started)if(this.started=!0,Me){var ir=Vi.Ue(),xr=Vi.Ue();Vi.IH(ir,this.normal,yo),Vi.IH(xr,this.normal,yo),pe.push(xr[0],xr[1],0),pe.push(ir[0],ir[1],0),W.push(a[0],a[1],a[2]|0,this.totalDistance-Bt,-this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),W.push(a[0],a[1],a[2]|0,this.totalDistance-Bt,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(W,pe,a,this.normal,this.thickness,this.totalDistance-Bt);if(I.push(i+0,i+1,i+2),c){Wo(s,c)&&Vi.IH(c,s,Vi.Fv(c,Vi.$X(c,s,a))),eo(Gu,c,s);var mr=Ns(Ii,Vi.Ue(),yo,Gu,this.thickness),sn=(0,Fi.Z)(mr,2),ti=sn[0],Bi=sn[1],ai=Vi.AK(Ii,this.normal)<0?-1:1,ra=Fe;if(!ra&&this.join==="miter"){var fa=ti;fa>this.miterLimit&&(ra=!0)}ra?(pe.push(this.normal[0],this.normal[1],0),pe.push(Bi[0],Bi[1],0),W.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*ai,s[2]|0),this.complex.indexes.push(this.currentIndex),W.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*ai,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,I.push.apply(I,(0,jr.Z)(this.lastFlip!==-ai?[i,i+2,i+3]:[i+2,i+1,i+3])),I.push(i+2,i+3,i+4),cl(Ol,Gu),Vi.JG(this.normal,Ol),pe.push(this.normal[0],this.normal[1],0),W.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*ai,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,w+=3):(this.extrusions(W,pe,s,Bi,ti,this.totalDistance),I.push.apply(I,(0,jr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),ai=-1,Vi.JG(this.normal,Bi),w+=2),this.lastFlip=ai}else{if(cl(this.normal,yo),Me){var qr=Vi.Ue(),Ir=Vi.Ue();Vi.lu(Ir,yo,this.normal),Vi.IH(qr,yo,this.normal),pe.push(Ir[0],Ir[1],0),pe.push(qr[0],qr[1],0),W.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),W.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(W,pe,s,this.normal,this.thickness,this.totalDistance);I.push.apply(I,(0,jr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),w+=2}return w}},{key:"segment",value:function(n,i,a,s,c){var p=0,g=n.indices,b=n.positions,w=n.normals,I=this.cap==="square",W=this.join==="bevel",pe=(0,ze.Z)([s[0],s[1]]),Me=(0,ze.Z)([a[0],a[1]]);eo(yo,pe,Me);var Fe=0;if(this.dash&&(Fe=this.lineSegmentDistance(pe,Me),this.totalDistance+=Fe),this.normal||(this.normal=Vi.Ue(),cl(this.normal,yo)),!this.started)if(this.started=!0,I){var ut=Vi.Ue(),Ot=Vi.Ue();Vi.IH(ut,this.normal,yo),Vi.IH(Ot,this.normal,yo),w.push(Ot[0],Ot[1],0),w.push(ut[0],ut[1],0),b.push(a[0],a[1],a[2]|0,this.totalDistance-Fe,-this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),b.push(a[0],a[1],a[2]|0,this.totalDistance-Fe,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(b,w,a,this.normal,this.thickness,this.totalDistance-Fe);if(g.push(i+0,i+1,i+2),c){var xr=(0,ze.Z)([c[0],c[1]]);Wo(pe,xr)&&Vi.IH(xr,pe,Vi.Fv(xr,Vi.$X(xr,pe,Me))),eo(Gu,xr,pe);var qr=Ns(Ii,Vi.Ue(),yo,Gu,this.thickness),Ir=(0,Fi.Z)(qr,2),mr=Ir[0],sn=Ir[1],ti=Vi.AK(Ii,this.normal)<0?-1:1,Bi=W;if(!Bi&&this.join==="miter"){var ai=mr;ai>this.miterLimit&&(Bi=!0)}Bi?(w.push(this.normal[0],this.normal[1],0),w.push(sn[0],sn[1],0),b.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*ti,s[2]|0),this.complex.indexes.push(this.currentIndex),b.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness*ti,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,g.push.apply(g,(0,jr.Z)(this.lastFlip!==-ti?[i,i+2,i+3]:[i+2,i+1,i+3])),g.push(i+2,i+3,i+4),cl(Ol,Gu),Vi.JG(this.normal,Ol),w.push(this.normal[0],this.normal[1],0),b.push(s[0],s[1],s[2]|0,this.totalDistance,-this.thickness*ti,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,p+=3):(this.extrusions(b,w,s,sn,mr,this.totalDistance),g.push.apply(g,(0,jr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),ti=-1,Vi.JG(this.normal,sn),p+=2),this.lastFlip=ti}else{if(cl(this.normal,yo),I){var Bt=Vi.Ue(),ir=Vi.Ue();Vi.lu(ir,yo,this.normal),Vi.IH(Bt,yo,this.normal),w.push(ir[0],ir[1],0),w.push(Bt[0],Bt[1],0),b.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),b.push(s[0],s[1],s[2]|0,this.totalDistance,this.thickness,s[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(b,w,s,this.normal,this.thickness,this.totalDistance);g.push.apply(g,(0,jr.Z)(this.lastFlip===1?[i,i+2,i+3]:[i+2,i+1,i+3])),p+=2}return p}},{key:"extrusions",value:function(n,i,a,s,c,p){i.push(s[0],s[1],0),i.push(s[0],s[1],0),n.push(a[0],a[1],a[2]|0,p,-c,a[2]|0),this.complex.indexes.push(this.currentIndex),n.push(a[0],a[1],a[2]|0,p,c,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(n,i){var a=i[0]-n[0],s=i[1]-n[1];return Math.sqrt(a*a+s*s)}}]),e}(),Ra=_(77160);function Gl(e){var r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,a=earcut.flatten(e),s=a.vertices,c=a.dimensions,p=[],g=[],b=0;b<s.length/c;b++)c===2?p.push(s[b*2],s[b*2+1],1):p.push(s[b*3],s[b*3+1],1);var w=earcut(a.vertices,a.holes,a.dimensions);g.push.apply(g,_toConsumableArray(w));for(var I=function(){var Me=a.vertices.slice(W*c,(W+1)*c),Fe=a.vertices.slice((W+1)*c,(W+2)*c);Fe.length===0&&(Fe=a.vertices.slice(0,c));var ut=p.length/3;p.push(Me[0],Me[1],1,Fe[0],Fe[1],1,Me[0],Me[1],0,Fe[0],Fe[1],0),g.push.apply(g,_toConsumableArray([0,2,1,2,3,1].map(function(Ot){return Ot+ut})))},W=0;W<i;W++)I();return{positions:p,index:g}}function l(e){var r=earcut.flatten(e),n=earcut(r.vertices,r.holes,r.dimensions);return{positions:r.vertices,index:n}}function d(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e[0][0],i=e[0][e[0].length-1];n[0]===i[0]&&n[1]===i[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var a=e[0].length,s=sl().flatten(e),c=s.vertices,p=s.dimensions,g=[],b=[],w=[],I=0;I<c.length/p;I++)g.push(c[I*p],c[I*p+1],1,-1,-1),w.push(0,0,1);var W=sl()(s.vertices,s.holes,s.dimensions);b.push.apply(b,(0,jr.Z)(W));for(var pe=function(){var ut=s.vertices.slice(Me*p,(Me+1)*p),Ot=s.vertices.slice((Me+1)*p,(Me+2)*p);Ot.length===0&&(Ot=s.vertices.slice(0,p));var Bt=g.length/5;g.push(ut[0],ut[1],1,0,0,Ot[0],Ot[1],1,.1,0,ut[0],ut[1],0,0,.8,Ot[0],Ot[1],0,.1,.8);var ir=f([Ot[0],Ot[1],1],[ut[0],ut[1],0],[ut[0],ut[1],1],r);w.push.apply(w,(0,jr.Z)(ir).concat((0,jr.Z)(ir),(0,jr.Z)(ir),(0,jr.Z)(ir))),b.push.apply(b,(0,jr.Z)([1,2,0,3,2,1].map(function(xr){return xr+Bt})))},Me=0;Me<a;Me++)pe();return{positions:g,index:b,normals:w}}function f(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=Ra.create(),s=Ra.create(),c=Ra.create();i&&(e=(0,ze.vP)(e),r=(0,ze.vP)(r),n=(0,ze.vP)(n));var p=Ra.fromValues.apply(Ra,(0,jr.Z)(e)),g=Ra.fromValues.apply(Ra,(0,jr.Z)(r)),b=Ra.fromValues.apply(Ra,(0,jr.Z)(n));Ra.sub(a,b,g),Ra.sub(s,p,g),Ra.cross(c,a,s);var w=Ra.create();return Ra.normalize(w,c),w}var m,S=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),R=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function L(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=Math.PI*2/e,i=[],a=0;a<e;a++)i.push(n*a+r*Math.PI/12);var s=i.map(function(c){var p=Math.sin(c+Math.PI/4),g=Math.cos(c+Math.PI/4);return[p,g,0]});return s}function q(){return L(30)}function Se(){return L(4)}function Le(){return L(3)}function et(){return L(6,1)}function ot(){return L(5)}var st=(m={},(0,G.Z)(m,R.CIRCLE,q),(0,G.Z)(m,R.HEXAGON,et),(0,G.Z)(m,R.TRIANGLE,Le),(0,G.Z)(m,R.SQUARE,Se),(0,G.Z)(m,R.PENTAGON,ot),(0,G.Z)(m,S.CYLINDER,q),(0,G.Z)(m,S.HEXAGONCOLUMN,et),(0,G.Z)(m,S.TRIANGLECOLUMN,Le),(0,G.Z)(m,S.SQUARECOLUMN,Se),(0,G.Z)(m,S.PENTAGONCOLUMN,ot),m),Rt={};function Ct(e){var r=(0,ze.SI)(e.coordinates);return{vertices:[].concat((0,jr.Z)(r),(0,jr.Z)(r),(0,jr.Z)(r),(0,jr.Z)(r)),indices:[0,1,2,2,3,0],size:r.length}}function Xt(e){var r=(0,ze.SI)(e.coordinates),n=Kc(r);return{vertices:[].concat((0,jr.Z)(n),(0,jr.Z)(n),(0,jr.Z)(n),(0,jr.Z)(n)),indices:[0,1,2,2,3,0],size:n.length}}function St(e){var r=e.shape,n=er(r,!1),i=n.positions,a=n.index,s=n.normals;return{vertices:i,indices:a,normals:s,size:5}}function $t(e){var r=(0,ze.SI)(e.coordinates);return{vertices:(0,jr.Z)(r),indices:[0],size:r.length}}function tr(e){var r=e.coordinates,n=e.originCoordinates,i=e.version,a=new oc({dash:!0,join:"bevel"});if(i==="GAODE2.x"){var s=r;Array.isArray(s[0][0])||(s=[r]);var c=n;Array.isArray(c[0][0])||(c=[n]);for(var p=0;p<s.length;p++){var g=s[p],b=c[p];a.extrude_gaode2(g,b)}}else{var w=r;w[0]&&!Array.isArray(w[0][0])&&(w=[r]),w.forEach(function(W){a.extrude(W)})}var I=a.complex;return{vertices:I.positions,indices:I.indices,normals:I.normals,indexes:I.indexes,size:6}}function br(e){var r=e.coordinates.flat(),n=1,i=1;return{vertices:[1,0,0].concat(_toConsumableArray(r),[1,2,-3],_toConsumableArray(r),[1,1,-3],_toConsumableArray(r),[0,1,0],_toConsumableArray(r),[0,0,0],_toConsumableArray(r),[1,0,0],_toConsumableArray(r),[1,2,-3],_toConsumableArray(r),[1,1,-3],_toConsumableArray(r),[0,1,0],_toConsumableArray(r),[0,0,0],_toConsumableArray(r)),normals:[-n,2*i,1,2*i,-i,1,i,-i,1,i,-i,1,-n,-i,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function kr(e){var r=e.coordinates,n=e.originCoordinates,i=[];if(!Array.isArray(r[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var a=M(r,n),s=a.results,c=a.totalDistance;return s.map(function(p){i.push(p[0],p[1],p[2],p[3],0,c)}),{vertices:i,indices:[],normals:[],size:6,count:s.length}}function Or(e){var r=e.coordinates,n=[];if(!Array.isArray(r[0]))return{vertices:[],indices:[],size:4,count:0};var i=z(r),a=i.results;return a.map(function(s){n.push(s[0],s[1],s[2],s[3])}),{vertices:n,indices:[],size:4,count:a.length}}function Hr(e,r){var n=r[0]-e[0],i=r[1]-e[1];return Math.sqrt(n*n+i*i)}function nn(e,r){return e.length<3&&e.push(0),r!==void 0&&e.push(r),e}function M(e,r){var n=e,i=r||e;Array.isArray(n)&&Array.isArray(n[0])&&Array.isArray(n[0][0])&&(n=r.flat(),i=r.flat());var a=0;if(n.length<2)return{results:n,totalDistance:0};var s=[],c=nn(n[0],a);s.push(c);for(var p=1;p<n.length-1;p++){var g=Hr((0,ze.Z)(i[p-1]),(0,ze.Z)(i[p]));a+=g;var b=nn(n[p],a);s.push(b),s.push(b)}var w=Hr((0,ze.Z)(i[i.length-2]),(0,ze.Z)(i[i.length-1]));return a+=w,s.push(nn(n[n.length-1],a)),{results:s,totalDistance:a}}function z(e){if(e.length<2)return{results:e};var r=[],n=nn(e[0]);r.push(n);for(var i=1;i<e.length-1;i++){var a=nn(e[i]);r.push(a),r.push(a)}return r.push(nn(e[e.length-1])),{results:r}}function j(e){var r=e.coordinates,n=sl().flatten(r),i=n.vertices,a=n.dimensions,s=n.holes;return{indices:sl()(i,s,a),vertices:i,size:a}}function ne(e){var r=e.coordinates,n=sl().flatten(r),i=n.vertices,a=n.dimensions,s=n.holes;return{indices:sl()(i,s,a),vertices:ce(i),size:a+4}}function ce(e){for(var r=[],n=(0,ze.Rx)(e),i=n.center,a=n.radius,s=0;s<e.length;s+=2){var c=e[s],p=e[s+1];r.push.apply(r,[c,p,0].concat((0,jr.Z)(i),[a]))}return r}function le(e){var r=e.coordinates,n=d(r,!0),i=n.positions,a=n.index,s=n.normals;return{vertices:i,indices:a,normals:s,size:5}}function lt(e){var r=e.shape,n=Jr(r),i=n.positions,a=n.index;return{vertices:i,indices:a,size:3}}function it(e){var r=e.coordinates,n=[].concat((0,jr.Z)(r[0]),[0,0,1,r[1][0],r[0][1],0,1,1],(0,jr.Z)(r[1]),[0,1,0],(0,jr.Z)(r[0]),[0,0,1],(0,jr.Z)(r[1]),[0,1,0,r[0][0],r[1][1],0,0,0]),i=[0,1,2,3,4,5];return{vertices:n,indices:i,size:5}}function Yt(e,r){for(var n=r.segmentNumber,i=n===void 0?30:n,a=e.coordinates,s=[],c=[],p=function(w){s.push(w,1,w,a[0][0],a[0][1],a[1][0],a[1][1],w,-1,w,a[0][0],a[0][1],a[1][0],a[1][1]),w!==i-1&&c.push.apply(c,(0,jr.Z)([0,1,2,1,3,2].map(function(I){return w*2+I})))},g=0;g<i;g++)p(g);return{vertices:s,indices:c,size:7}}function ht(e){var r=e.coordinates;r.length===2&&r.push(0);var n=Gn(-1,1),i=Gn(1,1),a=Gn(-1,-1),s=Gn(1,-1),c=[].concat(_toConsumableArray(r),_toConsumableArray(n),_toConsumableArray(r),_toConsumableArray(a),_toConsumableArray(r),_toConsumableArray(s),_toConsumableArray(r),_toConsumableArray(i)),p=[0,1,2,3,0,2];return{vertices:c,indices:p,size:5}}function er(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Rt&&Rt[e])return Rt[e];var n=st[e]?st[e]():st.cylinder(),i=d([n],r);return Rt[e]=i,i}function yr(e,r){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=new Float32Array(e.length/n*3),s,c,p,g=vec3.create(),b=vec3.create(),w=vec3.create(),I=0,W=r.length;I<W;I+=3){s=r[I+0]*3,c=r[I+1]*3,p=r[I+2]*3;var pe=[e[s],e[s+1]],Me=[e[c],e[c+1]],Fe=[e[p],e[p+1]];i&&(pe=lngLatToMeters(pe),Me=lngLatToMeters(Me),Fe=lngLatToMeters(Fe));var ut=pe,Ot=_slicedToArray(ut,2),Bt=Ot[0],ir=Ot[1],xr=vec3.fromValues(Bt,ir,e[s+2]),qr=Me,Ir=_slicedToArray(qr,2),mr=Ir[0],sn=Ir[1],ti=vec3.fromValues(mr,sn,e[c+2]),Bi=Fe,ai=_slicedToArray(Bi,2),ra=ai[0],fa=ai[1],nu=vec3.fromValues(ra,fa,e[p+2]);vec3.sub(g,nu,ti),vec3.sub(b,xr,ti),vec3.cross(w,g,b),a[s]+=g[0],a[s+1]+=g[1],a[s+2]+=g[2],a[c]+=g[0],a[c+1]+=g[1],a[c+2]+=g[2],a[p]+=g[0],a[p+1]+=g[1],a[p+2]+=g[2]}return _n(a),a}function _n(e){for(var r=0,n=e.length;r<n;r+=3){var i=vec3.fromValues(e[r],e[r+1],e[r+2]),a=vec3.create();vec3.normalize(a,i),e.set(a,r)}}function vn(e){var r=e[0][0],n=e[0][e[0].length-1];return r[0]===n[0]&&r[1]===n[1]}function Jr(e){var r=["cylinder","triangleColumn","hexagonColumn","squareColumn"],n=geometryShape[e]?geometryShape[e]():geometryShape.circle(),i=r.indexOf(e)===-1?fillPolygon([n]):extrudePolygon([n]);return i}function Gn(e,r){var n=(e+1)/2,i=(r+1)/2;return[n,i]}function Xn(){var e=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),r=e.positionsArr,n=e.indicesArr,i=e.normalArr;return{vertices:r,indices:n,size:5,normals:i}}function Yn(){var e=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),r=e.positionsArr,n=e.indicesArr,i=e.normalArr;return{vertices:r,indices:n,size:5,normals:i}}function gi(e){var r=xi();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function xi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ni=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,Pa=`#define Animate 0.0
#define LineTexture 1.0
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 14) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;


#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9



  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  //\u8BA1\u7B97dashArray\u548CdistanceRatio \u8F93\u51FA\u5230\u7247\u5143
  vec2 s = source;
  vec2 t = target;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, thetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, thetaOffset), 0.0, 1.0));

  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
    v_lineData.a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Ua={solid:0,dash:1},Mo=ze.rU.isNumber,ga=function(e){(0,Ai.Z)(n,e);var r=gi(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.NEAREST,min:$.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,p=a.textureBlend,g=p===void 0?"normal":p,b=a.lineType,w=b===void 0?"solid":b,I=a.dashArray,W=I===void 0?[10,5]:I,pe=a.forward,Me=pe===void 0?!0:pe,Fe=a.lineTexture,ut=Fe===void 0?!1:Fe,Ot=a.iconStep,Bt=Ot===void 0?100:Ot,ir=a.segmentNumber,xr=ir===void 0?30:ir,qr=this.layer.getLayerConfig(),Ir=qr.animateOption,mr=W;w!=="dash"&&(mr=[0,0]),mr.length===2&&mr.push(0,0);var sn=0,ti=[0,0,0,0],Bi=[0,0,0,0];s&&c&&(ti=(0,ze.CI)(s),Bi=(0,ze.CI)(c),sn=1),this.rendererService.getDirty()&&this.texture.bind();var ai={u_animate:this.animateOption2Array(Ir),u_dash_array:mr,u_sourceColor:ti,u_targetColor:Bi,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:xr,u_lineDir:Me?1:-1,u_icon_step:Bt,u_line_texture:ut?1:0,u_textureBlend:g==="normal"?0:1,u_blur:.9,u_line_type:Ua[w||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:sn},ra=this.getUniformsBufferInfo(ai);return ra}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),p.abrupt("return",this.buildModels());case 3:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){return{frag:Ni,vert:Pa,type:""}}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return this.initUniformsBuffer(),c=this.layer.getLayerConfig(),p=c.segmentNumber,g=p===void 0?30:p,b=this.getShaders(),w=b.frag,I=b.vert,W=b.type,Fe.next=5,this.layer.buildLayerModel({moduleName:"lineArc2d"+W,vertexShader:I,fragmentShader:w,inject:this.getInject(),triangulation:Yt,depth:{enable:!1},styleOption:{segmentNumber:g}});case 5:return pe=Fe.sent,Fe.abrupt("return",[pe]);case 7:case"end":return Fe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?1:p;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:$.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(c,p,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.texture,b=p[g]||{x:0,y:0},w=b.x,I=b.y;return[w,I]}}})}}]),n}(ao);function Xi(e){var r=da();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function da(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Go=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

// varying vec2 v_normal;
in vec4 v_dash_array;
in vec4 v_color;
in vec4 v_line_data;
in float v_segmentIndex;
in vec2 v_iconMapUV;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_line_data.g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,ls=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 14) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs\u4E2D\u8BA1\u7B97\u6E10\u53D8\u8272
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Uo={solid:0,dash:1},Xo=function(e){(0,Ai.Z)(n,e);var r=Xi(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.NEAREST,min:$.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,p=a.textureBlend,g=p===void 0?"normal":p,b=a.lineType,w=b===void 0?"solid":b,I=a.dashArray,W=I===void 0?[10,5]:I,pe=a.lineTexture,Me=pe===void 0?!1:pe,Fe=a.iconStep,ut=Fe===void 0?100:Fe,Ot=a.segmentNumber,Bt=Ot===void 0?30:Ot,ir=a.globalArcHeight,xr=ir===void 0?10:ir,qr=this.layer.getLayerConfig(),Ir=qr.animateOption;W.length===2&&W.push(0,0);var mr=0,sn=[0,0,0,0],ti=[0,0,0,0];s&&c&&(sn=(0,ze.CI)(s),ti=(0,ze.CI)(c),mr=1),this.rendererService.getDirty()&&this.texture.bind();var Bi={u_animate:this.animateOption2Array(Ir),u_dash_array:W,u_sourceColor:sn,u_targetColor:ti,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:ul,u_global_height:xr,segmentNumber:Bt,u_line_type:Uo[w]||0,u_icon_step:ut,u_line_texture:Me?1:0,u_textureBlend:g==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:mr},ai=this.getUniformsBufferInfo(Bi);return ai}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),p.abrupt("return",this.buildModels());case 4:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){return{frag:Go,vert:ls,type:""}}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return c=this.layer.getLayerConfig(),p=c.segmentNumber,g=p===void 0?30:p,b=this.getShaders(),w=b.frag,I=b.vert,W=b.type,Fe.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+W,vertexShader:I,fragmentShader:w,inject:this.getInject(),triangulation:Yt,styleOption:{segmentNumber:g}});case 4:return pe=Fe.sent,Fe.abrupt("return",[pe]);case 6:case"end":return Fe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?1:p;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:$.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(c,p,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.texture,b=p[g]||{x:0,y:0},w=b.x,I=b.y;return[w,I]}}})}}]),n}(ao),Rs={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},xo=1/2;function fl(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?1:a;return{vertices:[0,xo*e,1*e*i,-(s+xo)*e,1*e*i,(s-xo)*e,0,xo*e,1*e*i,-(s+xo)*e,1*e*i,(s-xo)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function ms(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?3:a;return{vertices:[0,0,1*e*i,1*s,1*e*i,-1*s,0,0,1*e*i,1*s,1*e*i,-1*s],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function Yo(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?2:a;return{vertices:[0,s/2,e*i*1,s/2,e*i*1,-s/2,0,-s/2,0,s/2,e*i*1,s/2,e*i*1,-s/2,0,-s/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Lu(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?3:a;return{vertices:[0,0,1*i*e,.5*s,2*i*e,0,1*i*e,-.5*s,0,0,1*i*e,.5*s,2*i*e,0,1*i*e,-.5*s],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function hl(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?3:a;return{vertices:[0,0,2*e*i,1*s,1.5*e*i,0,2*e*i,-1*s,0,0,2*e*i,1*s,1.5*e*i,0,2*e*i,-1*s],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function Xl(e,r){var n=r.width,i=n===void 0?2:n,a=r.height,s=a===void 0?2:a,c=q(),p=sl().flatten([c]),g=sl()(p.vertices,p.holes,p.dimensions),b=c.map(function(w){return[w[0]*i*e,w[1]*s]}).flat();return{vertices:[].concat((0,jr.Z)(b),(0,jr.Z)(b)),dimensions:2,indices:g.map(function(w){return w+c.length}),outLineIndices:g,normals:[].concat((0,jr.Z)(c.map(function(w){return[w[1]*s,w[0]*i*e,1]}).flat()),(0,jr.Z)(new Array(c.length*3).fill(0)))}}function Ma(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=(0,Oi.Z)(n.source)==="object"?n.source.type:n.source,a=(0,Oi.Z)(n.target)==="object"?n.target.type:n.target,s=(0,Oi.Z)(n.source)==="object"?n.source:{},c=s.width,p=c===void 0?i?Rs[i]:0:c,g=s.height,b=g===void 0?2:g,w=(0,Oi.Z)(n.target)==="object"?n.target:{},I=w.width,W=I===void 0?a?Rs[a]:0:I,pe=w.height,Me=pe===void 0?2:pe;return{vertices:[0,xo,1*p].concat((0,jr.Z)(e),[1,xo,-1*W],(0,jr.Z)(e),[1,-xo,-1*W],(0,jr.Z)(e),[0,-xo,1*p],(0,jr.Z)(e),[0,xo,1*p],(0,jr.Z)(e),[1,xo,-1*W],(0,jr.Z)(e),[1,-xo,-1*W],(0,jr.Z)(e),[0,-xo,1*p],(0,jr.Z)(e)),outLineIndices:[0,1,2,0,2,3].map(function(Fe){return Fe+r}),indices:[4,5,6,4,6,7].map(function(Fe){return Fe+r}),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function bs(e,r){var n=(0,Oi.Z)(e)==="object"?e.type:e,i=r==="source"?1:-1,a=(0,Oi.Z)(e)==="object"?e:{};switch(n){case"circle":return Xl(i,a);case"triangle":return ms(i,a);case"diamond":return Lu(i,a);case"rect":return Yo(i,a);case"classic":return hl(i,a);case"halfTriangle":return fl(i,a);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function xs(e){var r=e.coordinates.flat(),n=1,i=1;return{vertices:[1,0,0].concat((0,jr.Z)(r),[1,2,-3],(0,jr.Z)(r),[1,1,-3],(0,jr.Z)(r),[0,1,0],(0,jr.Z)(r),[0,0,0],(0,jr.Z)(r),[1,0,0],(0,jr.Z)(r),[1,2,-3],(0,jr.Z)(r),[1,1,-3],(0,jr.Z)(r),[0,1,0],(0,jr.Z)(r),[0,0,0],(0,jr.Z)(r)),normals:[-n,2*i,1,2*i,-i,1,i,-i,1,i,-i,1,-n,-i,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function sc(e,r){return r?rh(e,r):xs(e)}function rh(e,r){var n=e.coordinates.flat(),i=r,a=i.target,s=a===void 0?"classic":a,c=i.source,p=c===void 0?"circle":c,g=uc(bs(p,"source"),n,0,0),b=Ma(n,g.vertices.length/7,r),w=uc(bs(s,"target"),n,1,g.vertices.length/7+b.vertices.length/7),I={vertices:[].concat((0,jr.Z)(g.vertices),(0,jr.Z)(b.vertices),(0,jr.Z)(w.vertices)),indices:[].concat((0,jr.Z)(g.outLineIndices),(0,jr.Z)(b.outLineIndices),(0,jr.Z)(w.outLineIndices),(0,jr.Z)(g.indices),(0,jr.Z)(b.indices),(0,jr.Z)(w.indices)),normals:[].concat((0,jr.Z)(g.normals),(0,jr.Z)(b.normals),(0,jr.Z)(w.normals)),size:7};return I}function uc(e,r){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=[],s=e.vertices,c=e.indices,p=e.dimensions,g=e.outLineIndices,b=0;b<s.length;b+=p)a.push.apply(a,[n,s[b+1],s[b]].concat((0,jr.Z)(r)));return(0,fe.Z)((0,fe.Z)({},e),{},{vertices:a,indices:c.map(function(w){return w+i}),outLineIndices:g.map(function(w){return w+i})})}function Uf(e){var r=qc();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function qc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fc=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,Yl=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec2 a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 13) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {

   vec2 data = project_pixel(offsets);
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return data;
  }

  return vec2(data.x, -data.y);;
}

vec2 line_dir(vec2 target, vec2 source) {

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return normalize(target - source);
  }
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}

float flag_gap() {
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
     return 1.;
  }
  return -1.;

}


void main() {

// \u900F\u660E\u5EA6\u8BA1\u7B97
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  vec2 flowlineDir = line_dir(target,source);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x); // mapbox || \u9AD8\u5FB7
   
  vec2 position = mix(source, target, a_Position.x);
  
  float lengthCommon = length(project_position(vec4(target,0,1)) - project_position(vec4(source,0,1)));  //    
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || \u9AD8\u5FB7
  vec2 limitedOffsetDistances = clamp(   
   offsetDistances,
   project_pixel(-lengthCommon*.2), project_pixel(lengthCommon*.2)
  );


  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon*.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon*.2),
    a_Position.x
  );

  vec2 normalsCommon =  u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y)); // mapbox || \u9AD8\u5FB7

  float gapCommon = flag_gap() * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
    perpendicularDir *  (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0));

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));



  setPickingColor(a_PickingColor);
}
`,zf=function(e){(0,Ai.Z)(n,e);var r=Uf(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.gapWidth,c=s===void 0?2:s,p=a.strokeWidth,g=p===void 0?1:p,b=a.strokeOpacity,w=b===void 0?1:b,I={u_gap_width:c,u_stroke_width:g,u_stroke_opacity:w},W=this.getUniformsBufferInfo(I);return W}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),p.abrupt("return",this.buildModels());case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"flow_line",vertexShader:Yl,fragmentShader:Fc,inject:this.getInject(),triangulation:sc,styleOption:this.layer.getLayerConfig().symbol,primitive:$.gl.TRIANGLES,depth:{enable:!1},pick:!1});case 2:return c=g.sent,g.abrupt("return",[c]);case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s){var c=s.size,p=c===void 0?1:c;return Array.isArray(p)?[p[0],p[1]]:[p,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:$.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(s,c,p){return[p[3],p[4],p[5],p[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:$.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s,c,p,g,b){return b}}})}}]),n}(ao);function qh(e){var r=Qc();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Qc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Au=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_line_data;
in vec2 v_iconMapUV;
in vec4 v_dash_array;
in float v_distance_ratio;
in vec4 v_color;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,Qh=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 12) in vec4 a_Instance;
layout(location = 14) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
  mix(source, target, segmentRatio),
  sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }
  else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    v_line_data.b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    v_line_data.a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,nh={solid:0,dash:1},ih=function(e){(0,Ai.Z)(n,e);var r=qh(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.NEAREST,min:$.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,p=a.textureBlend,g=p===void 0?"normal":p,b=a.lineType,w=b===void 0?"solid":b,I=a.dashArray,W=I===void 0?[10,5]:I,pe=a.lineTexture,Me=pe===void 0?!1:pe,Fe=a.iconStep,ut=Fe===void 0?100:Fe,Ot=a.segmentNumber,Bt=Ot===void 0?30:Ot,ir=this.layer.getLayerConfig(),xr=ir.animateOption;W.length===2&&W.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var qr=0,Ir=[0,0,0,0],mr=[0,0,0,0];s&&c&&(Ir=(0,ze.CI)(s),mr=(0,ze.CI)(c),qr=1);var sn=this.layer.getLayerAnimateTime();isNaN(sn)&&(sn=0);var ti={u_animate:this.animateOption2Array(xr),u_dash_array:W,u_sourceColor:Ir,u_targetColor:mr,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:Bt,u_line_type:nh[w]||0,u_icon_step:ut,u_line_texture:Me?1:0,u_textureBlend:g==="normal"?0:1,u_time:sn,u_linearColor:qr},Bi=this.getUniformsBufferInfo(ti);return Bi}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),p.abrupt("return",this.buildModels());case 4:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.layer.getLayerConfig(),p=c.segmentNumber,g=p===void 0?30:p,I.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:Qh,fragmentShader:Au,triangulation:Yt,styleOption:{segmentNumber:g},inject:this.getInject(),depth:{enable:!1}});case 3:return b=I.sent,I.abrupt("return",[b]);case 5:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?1:p;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:$.GC.Attribute,descriptor:{name:"a_Instance",shaderLocation:12,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(c,p,g){return[g[3],g[4],g[5],g[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.texture,b=p[g]||{x:0,y:0},w=b.x,I=b.y;return[w,I]}}})}}]),n}(ao),Vp=function(e){return e[e.solid=0]="solid",e[e.dash=1]="dash",e}({}),Jh=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),Ed=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),Zf=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({}),np=function(e){return e.ALWAYS="always",e.DRAGEND="dragend",e}({});function yh(e){var r=ed();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function ed(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Jc=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_texture_data.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_texture_data.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // \u7ED8\u5236 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // \u5916\u4FA7
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,ah=`
#define Animate 0.0

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec2 a_Size;
layout(location = 10) in vec3 a_DistanceAndIndexAndMiter;
layout(location = 13) in vec4 a_Normal_Total_Distance;
layout(location = 14) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};


out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  
  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,T={solid:0,dash:1},Ke=function(e){(0,Ai.Z)(n,e);var r=yh(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"textureEventFlag",!1),(0,G.Z)((0,gn.Z)(i),"texture",i.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.textures.length===0&&(i.textures=[i.texture]),i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.NEAREST,min:$.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128})}),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,p=a.textureBlend,g=p===void 0?"normal":p,b=a.lineType,w=b===void 0?"solid":b,I=a.dashArray,W=I===void 0?[10,5,0,0]:I,pe=a.lineTexture,Me=pe===void 0?!1:pe,Fe=a.iconStep,ut=Fe===void 0?100:Fe,Ot=a.vertexHeightScale,Bt=Ot===void 0?20:Ot,ir=a.strokeWidth,xr=ir===void 0?0:ir,qr=a.raisingHeight,Ir=qr===void 0?0:qr,mr=a.heightfixed,sn=mr===void 0?!1:mr,ti=a.linearDir,Bi=ti===void 0?Jh.VERTICAL:ti,ai=a.blur,ra=ai===void 0?[1,1,1,0]:ai,fa=W;w!=="dash"&&(fa=[0,0,0,0]),fa.length===2&&fa.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var nu=this.layer.getLayerConfig(),yl=nu.animateOption,_l=0,Mf=[0,0,0,0],uf=[0,0,0,0];s&&c&&(Mf=(0,ze.CI)(s),uf=(0,ze.CI)(c),_l=1);var pc={u_animate:this.animateOption2Array(yl),u_dash_array:fa,u_blur:ra,u_sourceColor:Mf,u_targetColor:uf,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:ut,u_heightfixed:Number(sn),u_vertexScale:Bt,u_raisingHeight:Number(Ir),u_strokeWidth:xr,u_textureBlend:g===Ed.NORMAL?0:1,u_line_texture:Me?1:0,u_linearDir:Bi===Jh.VERTICAL?1:0,u_linearColor:_l,u_time:this.layer.getLayerAnimateTime()||0},Jf=this.getUniformsBufferInfo(pc);return Jf}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),p.abrupt("return",this.buildModels());case 3:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return c=this.layer.getLayerConfig(),p=c.depth,g=p===void 0?!1:p,b=this.getShaders(),w=b.frag,I=b.vert,W=b.type,this.layer.triangulation=ze.sN,Fe.next=5,this.layer.buildLayerModel({moduleName:"line"+W,vertexShader:I,fragmentShader:w,triangulation:ze.sN,inject:this.getInject(),depth:{enable:g}});case 5:return pe=Fe.sent,Fe.abrupt("return",[pe]);case 7:case"end":return Fe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:Jc,vert:ah,type:""}}},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:$.GC.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:10,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(c,p,g,b,w,I){return I===void 0?[g[3],10,g[4]]:[g[3],I,g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=c.size,g=p===void 0?1:p;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:$.GC.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(c,p,g,b,w){return[].concat((0,jr.Z)(w),[g[5]])}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.texture,b=p[g]||{x:0,y:0},w=b.x,I=b.y;return[w,I]}}})}}]),n}(ao);function he(e){var r=re();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function re(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var de=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  }
  else{
    outputColor = v_color;
  }
}
`,Oe=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash\u8F93\u51FA
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color; 
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_SizeDistanceAndTotalDistance.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_SizeDistanceAndTotalDistance.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,dt=ze.rU.isNumber,Lt=function(e){(0,Ai.Z)(n,e);var r=he(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,p=a.lineType,g=p===void 0?"solid":p,b=a.dashArray,w=b===void 0?[10,5,0,0]:b,I=a.vertexHeightScale,W=I===void 0?20:I,pe=w;g!=="dash"&&(pe=[0,0,0,0]),pe.length===2&&pe.push(0,0);var Me=0,Fe=[0,0,0,0],ut=[0,0,0,0];s&&c&&(Fe=(0,ze.CI)(s),ut=(0,ze.CI)(c),Me=1);var Ot={u_sourceColor:Fe,u_targetColor:ut,u_dash_array:pe,u_vertexScale:W,u_linearColor:Me},Bt=this.getUniformsBufferInfo(Ot);return Bt}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:de,vert:Oe,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return this.initUniformsBuffer(),c=this.getShaders(),p=c.frag,g=c.vert,b=c.type,W.next=4,this.layer.buildLayerModel({moduleName:b,vertexShader:g,fragmentShader:p,triangulation:kr,inject:this.getInject(),primitive:$.gl.LINES,depth:{enable:!1},pick:!1});case 4:return w=W.sent,W.abrupt("return",[w]);case 6:case"end":return W.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:$.GC.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:rn.SIZE,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(s,c,p){var g=s.size,b=g===void 0?1:g,w=Array.isArray(b)?[b[0],b[1]]:[b,0];return[w[0],w[1],p[3],p[5]]}}})}}]),n}(ao);function _t(e){var r=jt();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function jt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fr=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};
in vec2 v_iconMapUV;
in float v_blur;
in float v_radio;
in vec4 v_color;
in vec4 v_dataset;

out vec4 outputColor;
#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,$r=`#define Animate 0.0
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec2 a_Size;
layout(location = 10) in float a_Miter;
layout(location = 11) in float a_Total_Distance;
layout(location = 12) in vec4 a_Instance;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec2 a_iconMapUV;
layout(location = 15) in float a_Distance;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};
#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out float v_radio;
out vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {    
     originSize = project_float_meter(a_Size.x); // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
  }


  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Un=function(e){(0,Ai.Z)(n,e);var r=_t(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas()}),i.layer.render();return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.NEAREST,min:$.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128}),i.textures=[i.texture]}),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.sourceColor,c=a.targetColor,p=a.textureBlend,g=p===void 0?"normal":p,b=a.heightfixed,w=b===void 0?!1:b,I=a.lineTexture,W=I===void 0?!1:I,pe=a.iconStep,Me=pe===void 0?100:pe,Fe=a.iconStepCount,ut=Fe===void 0?1:Fe,Ot=this.layer.getLayerConfig(),Bt=Ot.animateOption;this.rendererService.getDirty()&&this.texture.bind();var ir=0,xr=[0,0,0,0],qr=[0,0,0,0];s&&c&&(xr=(0,ze.CI)(s),qr=(0,ze.CI)(c),ir=1);var Ir={u_animate:this.animateOption2Array(Bt),u_sourceColor:xr,u_targetColor:qr,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:Me,u_heightfixed:Number(w),u_linearColor:ir,u_line_texture:W?1:0,u_textureBlend:g==="normal"?0:1,u_iconStepCount:ut,u_time:this.layer.getLayerAnimateTime()||0},mr=this.getUniformsBufferInfo(Ir);return mr}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),p.abrupt("return",this.buildModels());case 4:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:$r,fragmentShader:Fr,triangulation:tr,inject:this.getInject(),depth:{enable:!1},blend:this.getBlend()});case 2:return c=g.sent,g.abrupt("return",[c]);case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:$.GC.Attribute,descriptor:{name:"a_Distance",shaderLocation:15,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c,p,g){return[g[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:$.GC.Attribute,descriptor:{name:"a_Total_Distance",shaderLocation:11,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c,p,g){return[g[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=c.size,g=p===void 0?1:p;return Array.isArray(g)?[g[0],g[1]]:[g,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:$.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(c,p,g,b,w){return w}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:$.GC.Attribute,descriptor:{name:"a_Miter",shaderLocation:10,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c,p,g){return[g[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:14,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.texture,b=p[g]||{x:0,y:0},w=b.x,I=b.y;return[w,I]}}})}}]),n}(ao),Hn={arc:ga,arc3d:Xo,greatcircle:ih,wall:Un,line:Ke,simple:Lt,flowline:zf,earthArc3d:Xo},_i=Hn;function Pi(e){var r=Jn();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Jn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ei=function(e){(0,Ai.Z)(n,e);var r=Pi(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"type","LineLayer"),(0,G.Z)((0,gn.Z)(i),"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),(0,G.Z)((0,gn.Z)(i),"arrowInsertCount",0),(0,G.Z)((0,gn.Z)(i),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),i}return(0,We.Z)(n,[{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new _i[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}};return s[a]}},{key:"getModelType",value:function(){var a;if(this.layerType)return this.layerType;var s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(a=s.scale)===null||a===void 0?void 0:a.field;return c||"line"}},{key:"processData",value:function(a){if(this.getModelType()!=="simple")return a;var s=[];return a.map(function(c){if(Array.isArray(c.coordinates)&&Array.isArray(c.coordinates[0])&&Array.isArray(c.coordinates[0][0])){var p=(0,fe.Z)({},c);c.coordinates.map(function(g){s.push((0,fe.Z)((0,fe.Z)({},p),{},{coordinates:g}))})}else s.push(c)}),s}}]),n}(es);function ya(e){var r=ia();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function ia(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zo=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,co=`#define pi 3.1415926535

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec3 a_Size;
layout(location = 11) in vec3 a_Extrude;
layout(location = 13) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {


  vec3 size = a_Size * a_Position;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB

  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Extrude.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;

  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

    // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a =  v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

    if(u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? (1.0 - a_Position.z): a_Position.z;
  }


  gl_Position = project_common_position_to_clipspace_v2(pos);

  setPickingColor(a_PickingColor);
}
`,Eo=function(e){(0,Ai.Z)(n,e);var r=ya(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"raiseCount",0),(0,G.Z)((0,gn.Z)(i),"raiseRepeat",0),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption,c=s===void 0?{enable:!1,speed:.01,repeat:!1}:s,p=a.sourceColor,g=a.targetColor,b=a.pickLight,w=b===void 0?!1:b,I=a.heightfixed,W=I===void 0?!1:I,pe=a.opacityLinear,Me=pe===void 0?{enable:!1,dir:"up"}:pe,Fe=a.lightEnable,ut=Fe===void 0?!0:Fe,Ot=0,Bt=[0,0,0,0],ir=[0,0,0,0];if(p&&g&&(Bt=(0,ze.CI)(p),ir=(0,ze.CI)(g),Ot=1),this.raiseCount<1&&this.raiseRepeat>0&&c.enable){var xr=c.speed,qr=xr===void 0?.01:xr;this.raiseCount+=qr,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}var Ir={u_pickLight:Number(w),u_heightfixed:Number(W),u_r:c.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:Ot,u_sourceColor:Bt,u_targetColor:ir,u_opacitylinear:Number(Me.enable),u_opacitylinear_dir:Me.dir==="up"?1:0,u_lightEnable:Number(ut)},mr=this.getUniformsBufferInfo(Ir);return mr}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I;return Ne().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return c=this.layer.getLayerConfig(),p=c.depth,g=p===void 0?!0:p,b=c.animateOption.repeat,w=b===void 0?1:b,this.raiseRepeat=w,this.initUniformsBuffer(),pe.next=5,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:co,fragmentShader:zo,triangulation:St,inject:this.getInject(),cull:{enable:!0,face:(0,ze.fj)(this.mapService.version)},depth:{enable:g}});case 5:return I=pe.sent,pe.abrupt("return",[I]);case 7:case"end":return pe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s){var c=s.size;if(c){var p=[];return Array.isArray(c)&&(p=c.length===2?[c[0],c[0],c[1]]:c),Array.isArray(c)||(p=[c,c,c]),p}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:$.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s,c,p,g,b){return b}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:$.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:rn.EXTRUDE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s){var c=(0,ze.SI)(s.coordinates);return[c[0],c[1],0]}}})}}]),n}(ao);function _a(e){var r=Da();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Da(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Io=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave\u76F8\u5173\u903B\u8F91
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,Zo=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 10) in float a_Shape;
layout(location = 11) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;   
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // \u900F\u660E\u5EA6\u8BA1\u7B97
   v_stroke = stroke;  
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }
  
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`,ts=function(e){(0,Ai.Z)(n,e);var r=_a(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.strokeOpacity,c=s===void 0?1:s,p=a.strokeWidth,g=p===void 0?0:p,b=a.blend,w=a.blur,I=w===void 0?0:w,W=a.raisingHeight,pe=W===void 0?0:W,Me=a.heightfixed,Fe=Me===void 0?!1:Me,ut=a.unit,Ot=ut===void 0?"pixel":ut,Bt=this.getAnimateUniforms().u_time;isNaN(Bt)&&(Bt=-1);var ir={u_blur_height_fixed:[I,Number(pe),Number(Fe)],u_stroke_width:g,u_additive:b==="additive"?1:0,u_stroke_opacity:c,u_size_unit:Zf[Ot],u_time:Bt,u_animate:this.getAnimateUniforms().u_animate},xr=this.getUniformsBufferInfo(ir);return xr}},{key:"getAnimateUniforms",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption,c=s===void 0?{enable:!1}:s;return{u_animate:this.animateOption2Array(c),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),ze.oX)}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return c=this.layer.getLayerConfig(),p=c.animateOption,g=p===void 0?{enable:!1}:p,b=this.getShaders(g),w=b.frag,I=b.vert,W=b.type,this.layer.triangulation=ze.oX,this.initUniformsBuffer(),Fe.next=6,this.layer.buildLayerModel({moduleName:W,vertexShader:I,fragmentShader:w,inject:this.getInject(),triangulation:ze.oX,depth:{enable:!1}});case 6:return pe=Fe.sent,Fe.abrupt("return",[pe]);case 8:case"end":return Fe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(a){return{frag:Io,vert:Zo,type:"pointFill"}}},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.speed||1,a.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:$.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:rn.EXTRUDE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(c,p,g,b){var w=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],I=b%4*3;return[w[I],w[I+1],w[I+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?5:p;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:$.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:rn.SHAPE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.shape,g=p===void 0?2:p,b=a.indexOf(g);return[b]}}})}}]),n}(ao);function Oo(e){var r=oo();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fo=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,Dl=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }


  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,Kl=function(e){(0,Ai.Z)(n,e);var r=Oo(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){i.layerService.throttleRenderLayers()});return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.LINEAR,min:$.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128,mipmap:!0})}),i}return(0,We.Z)(n,[{key:"getUninforms",value:function(){this.rendererService.getDirty()&&this.texture.bind();var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.raisingHeight,c=s===void 0?0:s,p=a.heightfixed,g=p===void 0?!1:p,b={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(c),u_heightfixed:Number(g),u_texture:this.texture};this.textures=[this.texture];var w=this.getUniformsBufferInfo(b);return w}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),p.abrupt("return",this.buildModels());case 3:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Dl,fragmentShader:fo,triangulation:$t,inject:this.getInject(),depth:{enable:!1},primitive:$.gl.POINTS});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?5:p;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.shape,b=p[g]||{x:-64,y:-64},w=b.x,I=b.y;return[w,I]}}})}}]),n}(ao);function Af(e){var r=Ac();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Ac(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ef=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,td=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2., -a_Size /2., 0., 0.);
    gl_Position = project_common_position_to_clipspace(project_pos);
  }

  gl_PointSize = a_Size * u_size_scale *  2.0  * u_DevicePixelRatio;
}
`;function Nc(e){var r=e.coordinates;return{vertices:(0,jr.Z)(r),indices:[0],size:r.length}}var rd=function(e){(0,Ai.Z)(n,e);var r=Af(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getCommonUniformsInfo",value:function(){var a={u_size_scale:.5},s=this.getUniformsBufferInfo(a);return s}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=Nc,this.initUniformsBuffer(),g.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:td,fragmentShader:ef,triangulation:Nc,inject:this.getInject(),depth:{enable:!1},primitive:$.gl.POINTS,pick:!1});case 4:return c=g.sent,g.abrupt("return",[c]);case 6:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(s){var c=s.size,p=c===void 0?1:c;return Array.isArray(p)?[p[0]]:[p]}}})}}]),n}(ao),Cf=_(98333),Cc=_(85975);function ip(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=jf(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function jf(e,r){if(e){if(typeof e=="string")return kh(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kh(e,r)}}function kh(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}var nd=function(){function e(r,n,i){(0,Ge.Z)(this,e),(0,G.Z)(this,"boxCells",[]);var a=this.boxCells;this.xCellCount=Math.ceil(r/i),this.yCellCount=Math.ceil(n/i);for(var s=0;s<this.xCellCount*this.yCellCount;s++)a.push([]);this.boxKeys=[],this.bboxes=[],this.width=r,this.height=n,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/n,this.boxUid=0}return(0,We.Z)(e,[{key:"insert",value:function(n,i,a,s,c){this.forEachCell(i,a,s,c,this.insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(s),this.bboxes.push(c)}},{key:"query",value:function(n,i,a,s,c){return this.queryHitTest(n,i,a,s,!1,c)}},{key:"hitTest",value:function(n,i,a,s,c){return this.queryHitTest(n,i,a,s,!0,c)}},{key:"insertBoxCell",value:function(n,i,a,s,c,p){this.boxCells[c].push(p)}},{key:"queryHitTest",value:function(n,i,a,s,c,p){if(a<0||n>this.width||s<0||i>this.height)return c?!1:[];var g=[];if(n<=0&&i<=0&&this.width<=a&&this.height<=s){if(c)return!0;for(var b=0;b<this.boxKeys.length;b++)g.push({key:this.boxKeys[b],x1:this.bboxes[b*4],y1:this.bboxes[b*4+1],x2:this.bboxes[b*4+2],y2:this.bboxes[b*4+3]});return p?g.filter(p):g}var w={hitTest:c,seenUids:{box:{},circle:{}}};return this.forEachCell(n,i,a,s,this.queryCell,g,w,p),c?g.length>0:g}},{key:"queryCell",value:function(n,i,a,s,c,p,g,b){var w=g.seenUids,I=this.boxCells[c];if(I!==null){var W=this.bboxes,pe=ip(I),Me;try{for(pe.s();!(Me=pe.n()).done;){var Fe=Me.value;if(!w.box[Fe]){w.box[Fe]=!0;var ut=Fe*4;if(n<=W[ut+2]&&i<=W[ut+3]&&a>=W[ut+0]&&s>=W[ut+1]&&(!b||b(this.boxKeys[Fe]))){if(g.hitTest)return p.push(!0),!0;p.push({key:this.boxKeys[Fe],x1:W[ut],y1:W[ut+1],x2:W[ut+2],y2:W[ut+3]})}}}}catch(Ot){pe.e(Ot)}finally{pe.f()}}return!1}},{key:"forEachCell",value:function(n,i,a,s,c,p,g,b){for(var w=this.convertToXCellCoord(n),I=this.convertToYCellCoord(i),W=this.convertToXCellCoord(a),pe=this.convertToYCellCoord(s),Me=w;Me<=W;Me++)for(var Fe=I;Fe<=pe;Fe++){var ut=this.xCellCount*Fe+Me;if(c.call(this,n,i,a,s,ut,p,g,b))return}}},{key:"convertToXCellCoord",value:function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}},{key:"convertToYCellCoord",value:function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}}]),e}(),Xu=nd,Bu=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"viewportPadding",100),this.width=r,this.height=n,this.viewportPadding=Math.max(r,n),this.grid=new Xu(r+this.viewportPadding,n+this.viewportPadding,25),this.screenRightBoundary=r+this.viewportPadding,this.screenBottomBoundary=n+this.viewportPadding,this.gridRightBoundary=r+2*this.viewportPadding,this.gridBottomBoundary=n+2*this.viewportPadding}return(0,We.Z)(e,[{key:"placeCollisionBox",value:function(n){var i=n.x1+n.anchorPointX+this.viewportPadding,a=n.y1+n.anchorPointY+this.viewportPadding,s=n.x2+n.anchorPointX+this.viewportPadding,c=n.y2+n.anchorPointY+this.viewportPadding;return!this.isInsideGrid(i,a,s,c)||this.grid.hitTest(i,a,s,c)?{box:[]}:{box:[i,a,s,c]}}},{key:"insertCollisionBox",value:function(n,i){var a={featureIndex:i};this.grid.insert(a,n[0],n[1],n[2],n[3])}},{key:"project",value:function(n,i,a){var s=Cf.al(i,a,0,1),c=Cf.Ue(),p=Cc.fromValues.apply(Cc,(0,jr.Z)(n));return Cf.fF(c,s,p),{x:(c[0]/c[3]+1)/2*this.width+this.viewportPadding,y:(-c[1]/c[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(n,i,a,s){return a>=0&&n<this.gridRightBoundary&&s>=0&&i<this.gridBottomBoundary}}]),e}();function Ms(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ql(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function ql(e,r){if(e){if(typeof e=="string")return Sd(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sd(e,r)}}function Sd(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function _h(e){var r=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0;break;default:r=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5}return{horizontalAlign:r,verticalAlign:n}}function Td(e,r,n,i,a){if(a){var s=e[i],c=s.glyph;if(c)for(var p=r[c].advance*s.scale,g=(e[i].x+p)*a,b=n;b<=i;b++)e[b].x-=g}}function ap(e,r,n,i,a,s,c){var p=(r-n)*a,g=(-i*c+.5)*s,b=Ms(e),w;try{for(b.s();!(w=b.n()).done;){var I=w.value;I.x+=p,I.y+=g}}catch(W){b.e(W)}finally{b.f()}}function Hp(e,r,n,i,a,s,c){var p=-8,g=0,b=p,w=0,I=e.positionedGlyphs,W=s==="right"?1:s==="left"?0:.5,pe=I.length;n.forEach(function(Bt){if(Bt.split("").forEach(function(xr){var qr=r[xr],Ir=0;qr&&(I.push({glyph:xr,x:g,y:b+Ir,vertical:!1,scale:1,metrics:qr}),g+=qr.advance+c)}),I.length!==pe){var ir=g-c;w=Math.max(ir,w),Td(I,r,pe,I.length-1,W)}g=0,b-=i+5});var Me=_h(a),Fe=Me.horizontalAlign,ut=Me.verticalAlign;ap(I,W,Fe,ut,w,i,n.length);var Ot=b-p;e.top+=-ut*Ot,e.bottom=e.top-Ot,e.left+=-Fe*w,e.right=e.left+w}function op(e,r,n,i,a,s,c){var p=-8,g=0,b=p,w=0,I=e.positionedGlyphs,W=s==="right"?1:s==="left"?0:.5,pe=I.length;n.forEach(function(Bt){var ir=r[Bt],xr=0;if(ir&&(I.push({glyph:Bt,x:ir.advance/2,y:b+xr,vertical:!1,scale:1,metrics:ir}),g+=ir.advance+c),I.length!==pe){var qr=g-c;w=Math.max(qr,w),Td(I,r,pe,I.length-1,W)}g=0,b-=i+5});var Me=_h(a),Fe=Me.horizontalAlign,ut=Me.verticalAlign;ap(I,W,Fe,ut,w,i,n.length);var Ot=b-p;e.top+=-ut*Ot,e.bottom=e.top-Ot,e.left+=-Fe*w,e.right=e.left+w}function $p(e,r,n,i,a,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],p=arguments.length>7?arguments[7]:void 0,g=e.split(`
`),b=[],w={positionedGlyphs:b,top:c[1],bottom:c[1],left:c[0],right:c[0],lineCount:g.length,text:e};return p?op(w,r,g,n,i,a,s):Hp(w,r,g,n,i,a,s),b.length?w:!1}function sp(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],n=arguments.length>2?arguments[2]:void 0,i=e.positionedGlyphs,a=i===void 0?[]:i,s=[],c=Ms(a),p;try{for(c.s();!(p=c.n()).done;){var g=p.value,b=g.metrics,w=4,I=b.advance*g.scale/2,W=n?[g.x+I,g.y]:[0,0],pe=n?[0,0]:[g.x+I+r[0],g.y+r[1]],Me=(0-w)*g.scale-I+pe[0],Fe=(0-w)*g.scale+pe[1],ut=Me+b.width*g.scale,Ot=Fe+b.height*g.scale,Bt={x:Me,y:Fe},ir={x:ut,y:Fe},xr={x:Me,y:Ot},qr={x:ut,y:Ot};s.push({tl:Bt,tr:ir,bl:xr,br:qr,tex:b,glyphOffset:W})}}catch(Ir){c.e(Ir)}finally{c.f()}return s}function Yu(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Wp(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function Wp(e,r){if(e){if(typeof e=="string")return Ad(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ad(e,r)}}function Ad(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function Cd(e){var r=up();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function up(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var id=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // \u4F5C\u4E3A mask \u6A21\u677F\u65F6\u9700\u8981\u4E22\u5F03\u900F\u660E\u7684\u50CF\u7D20
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,lp=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 10) in vec2 a_textOffsets;
layout(location = 14) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  
  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,Lh=ze.rU.isEqual;function wd(e){var r=this,n=e.id,i=[],a=[];if(!r.glyphInfoMap||!r.glyphInfoMap[n])return{vertices:[],indices:[],size:7};var s=r.glyphInfoMap[n].centroid,c=s.length===2?[s[0],s[1],0]:s;return r.glyphInfoMap[n].glyphQuads.forEach(function(p,g){i.push.apply(i,(0,jr.Z)(c).concat([p.tex.x,p.tex.y+p.tex.height,p.tl.x,p.tl.y],(0,jr.Z)(c),[p.tex.x+p.tex.width,p.tex.y+p.tex.height,p.tr.x,p.tr.y],(0,jr.Z)(c),[p.tex.x+p.tex.width,p.tex.y,p.br.x,p.br.y],(0,jr.Z)(c),[p.tex.x,p.tex.y,p.bl.x,p.bl.y])),a.push(0+g*4,1+g*4,2+g*4,2+g*4,3+g*4,0+g*4)}),{vertices:i,indices:a,size:7}}var Rd=function(e){(0,Ai.Z)(n,e);var r=Cd(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"glyphInfoMap",{}),(0,G.Z)((0,gn.Z)(i),"currentZoom",-1),(0,G.Z)((0,gn.Z)(i),"textureHeight",0),(0,G.Z)((0,gn.Z)(i),"textCount",0),(0,G.Z)((0,gn.Z)(i),"preTextStyle",{}),(0,G.Z)((0,gn.Z)(i),"mapping",(0,He.Z)(Ne().mark(function p(){return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return i.initGlyph(),i.updateTexture(),b.next=4,i.reBuildModel();case 4:case"end":return b.stop()}},p)}))),i}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption),{u_sdf_map:this.textures[0]})}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.stroke,c=s===void 0?"#fff":s,p=a.strokeWidth,g=p===void 0?0:p,b=a.halo,w=b===void 0?.5:b,I=a.gamma,W=I===void 0?2:I,pe=a.raisingHeight,Me=pe===void 0?0:pe,Fe=this.getFontServiceMapping(),ut=this.getFontServiceCanvas();Fe&&Object.keys(Fe).length!==this.textCount&&ut&&(this.updateTexture(),this.textCount=Object.keys(Fe).length),this.preTextStyle=this.getTextStyle();var Ot={u_stroke_color:(0,ze.CI)(c),u_sdf_map_size:[(ut==null?void 0:ut.width)||1,(ut==null?void 0:ut.height)||1],u_raisingHeight:Number(Me),u_stroke_width:g,u_gamma_scale:W,u_halo_blur:w},Bt=this.getUniformsBufferInfo(Ot);return Bt}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.rawEncodeData=this.layer.getEncodedData(),this.preTextStyle=this.getTextStyle(),this.initUniformsBuffer(),p.abrupt("return",this.buildModels());case 6:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.layer.getLayerConfig(),p=c.textAllowOverlap,g=p===void 0?!1:p,this.initGlyph(),this.updateTexture(),g||this.filterGlyphs(),I.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:lp,fragmentShader:id,inject:this.getInject(),triangulation:wd.bind(this),depth:{enable:!1}});case 6:return b=I.sent,I.abrupt("return",[b]);case 8:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"needUpdate",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe,Me,Fe,ut,Ot;return Ne().wrap(function(ir){for(;;)switch(ir.prev=ir.next){case 0:if(c=this.getTextStyle(),p=c.textAllowOverlap,g=p===void 0?!1:p,b=c.textAnchor,w=b===void 0?"center":b,I=c.textOffset,W=c.padding,pe=c.fontFamily,Me=c.fontWeight,!(!Lh(W,this.preTextStyle.padding)||!Lh(I,this.preTextStyle.textOffset)||!Lh(w,this.preTextStyle.textAnchor)||!Lh(pe,this.preTextStyle.fontFamily)||!Lh(Me,this.preTextStyle.fontWeight))){ir.next=5;break}return ir.next=4,this.mapping();case 4:return ir.abrupt("return",!0);case 5:if(!g){ir.next=7;break}return ir.abrupt("return",!1);case 7:if(Fe=this.mapService.getZoom(),ut=this.mapService.getBounds(),Ot=(0,ze.oO)(this.extent,ut),!(Math.abs(this.currentZoom-Fe)>.5||!Ot||g!==this.preTextStyle.textAllowOverlap)){ir.next=14;break}return ir.next=13,this.reBuildModel();case 13:return ir.abrupt("return",!0);case 14:return ir.abrupt("return",!1);case 15:case"end":return ir.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:$.GC.Attribute,descriptor:{shaderLocation:10,name:"a_textOffsets",buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s,c,p){return[p[5],p[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:$.GC.Attribute,descriptor:{name:"a_tex",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s,c,p){return[p[3],p[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(s){var c=s.size,p=c===void 0?12:c;return Array.isArray(p)?[p[0]]:[p]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var a=this.mapService.getBounds();return(0,ze.yA)(a,.5)}},{key:"initTextFont",value:function(){var a=this.getTextStyle(),s=a.fontWeight,c=a.fontFamily,p=this.rawEncodeData,g=[];p.forEach(function(b){var w=b.shape,I=w===void 0?"":w;I=I.toString();var W=Yu(I),pe;try{for(W.s();!(pe=W.n()).done;){var Me=pe.value;g.indexOf(Me)===-1&&g.push(Me)}}catch(Fe){W.e(Fe)}finally{W.f()}}),this.fontService.setFontOptions({characterSet:g,fontWeight:s,fontFamily:c,iconfont:!1})}},{key:"initIconFontTex",value:function(){var a=this.getTextStyle(),s=a.fontWeight,c=a.fontFamily,p=this.rawEncodeData,g=[];p.forEach(function(b){var w=b.shape,I=w===void 0?"":w;I="".concat(I),g.indexOf(I)===-1&&g.push(I)}),this.fontService.setFontOptions({characterSet:g,fontWeight:s,fontFamily:c,iconfont:!0})}},{key:"getTextStyle",value:function(){var a=this.layer.getLayerConfig(),s=a.fontWeight,c=s===void 0?"400":s,p=a.fontFamily,g=p===void 0?"sans-serif":p,b=a.textAllowOverlap,w=b===void 0?!1:b,I=a.padding,W=I===void 0?[0,0]:I,pe=a.textAnchor,Me=pe===void 0?"center":pe,Fe=a.textOffset,ut=Fe===void 0?[0,0]:Fe,Ot=a.opacity,Bt=Ot===void 0?1:Ot,ir=a.strokeOpacity,xr=ir===void 0?1:ir,qr=a.strokeWidth,Ir=qr===void 0?0:qr,mr=a.stroke,sn=mr===void 0?"#000":mr;return{fontWeight:c,fontFamily:g,textAllowOverlap:w,padding:W,textAnchor:Me,textOffset:ut,opacity:Bt,strokeOpacity:xr,strokeWidth:Ir,stroke:sn}}},{key:"generateGlyphLayout",value:function(a){var s=this,c=this.getFontServiceMapping(),p=this.layer.getLayerConfig(),g=p.spacing,b=g===void 0?2:g,w=p.textAnchor,I=w===void 0?"center":w,W=p.textOffset,pe=this.rawEncodeData;this.glyphInfo=pe.map(function(Me){var Fe=Me.shape,ut=Fe===void 0?"":Fe,Ot=Me.id,Bt=Me.size,ir=Bt===void 0?1:Bt,xr=Me.textOffset?Me.textOffset:W||[0,0],qr=Me.textAnchor?Me.textAnchor:I||"center",Ir=$p(ut.toString(),c,ir,qr,"left",b,xr,a),mr=sp(Ir,xr,!1);return Me.shaping=Ir,Me.glyphQuads=mr,Me.centroid=(0,ze.SI)(Me.coordinates),Me.originCentroid=Me.version==="GAODE2.x"?(0,ze.SI)(Me.originCoordinates):Me.originCentroid=Me.centroid,s.glyphInfoMap[Ot]={shaping:Ir,glyphQuads:mr,centroid:(0,ze.SI)(Me.coordinates)},Me})}},{key:"getFontServiceMapping",value:function(){var a=this.layer.getLayerConfig(),s=a.fontWeight,c=s===void 0?"400":s,p=a.fontFamily,g=p===void 0?"sans-serif":p;return this.fontService.getMappingByKey("".concat(g,"_").concat(c))}},{key:"getFontServiceCanvas",value:function(){var a=this.layer.getLayerConfig(),s=a.fontWeight,c=s===void 0?"400":s,p=a.fontFamily,g=p===void 0?"sans-serif":p;return this.fontService.getCanvasByKey("".concat(g,"_").concat(c))}},{key:"filterGlyphs",value:function(){var a=this,s=this.layer.getLayerConfig(),c=s.padding,p=c===void 0?[0,0]:c,g=s.textAllowOverlap,b=g===void 0?!1:g;if(!b){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var w=this.rendererService.getViewportSize(),I=w.width,W=w.height,pe=new Bu(I,W),Me=this.glyphInfo.filter(function(Fe){var ut=Fe.shaping,Ot=Fe.id,Bt=Ot===void 0?0:Ot,ir=Fe.version==="GAODE2.x"?Fe.originCentroid:Fe.centroid,xr=Fe.size,qr=xr/16,Ir=a.mapService.lngLatToContainer(ir),mr=pe.placeCollisionBox({x1:ut.left*qr-p[0],x2:ut.right*qr+p[0],y1:ut.top*qr-p[1],y2:ut.bottom*qr+p[1],anchorPointX:Ir.x,anchorPointY:Ir.y}),sn=mr.box;return sn&&sn.length?(pe.insertCollisionBox(sn,Bt),!0):!1});Me.forEach(function(Fe){a.glyphInfoMap[Fe.id]=Fe})}}},{key:"initGlyph",value:function(){var a=this.layer.getLayerConfig(),s=a.iconfont,c=s===void 0?!1:s;c?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(c)}},{key:"updateTexture",value:function(){var a=this.rendererService.createTexture2D,s=this.getFontServiceCanvas();this.textureHeight=s.height,this.texture&&this.texture.destroy(),this.texture=a({data:s,mag:$.gl.LINEAR,min:$.gl.LINEAR,width:s.width,height:s.height}),this.textures=[this.texture]}},{key:"reBuildModel",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.filterGlyphs(),g.next=3,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:lp,fragmentShader:id,triangulation:wd.bind(this),inject:this.getInject(),depth:{enable:!1}});case 3:c=g.sent,this.layer.models=[c];case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()}]),n}(ao);function Ee(e){return pt.apply(this,arguments)}function pt(){return pt=(0,He.Z)(Ne().mark(function e(r){var n,i,a;return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!window.createImageBitmap){c.next=14;break}return c.next=3,fetch(r);case 3:return n=c.sent,c.t0=createImageBitmap,c.next=7,n.blob();case 7:return c.t1=c.sent,c.next=10,(0,c.t0)(c.t1);case 10:return i=c.sent,c.abrupt("return",i);case 14:return a=new window.Image,c.abrupt("return",new Promise(function(p){a.onload=function(){return p(a)},a.src=r,a.crossOrigin="Anonymous"}));case 16:case"end":return c.stop()}},e)})),pt.apply(this,arguments)}function Ut(e){var r=Pr();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Pr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ln=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,Lr=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
float isSide = a_Position.z;
 float topU = a_uvs[0];
 float topV = 1.0 - a_uvs[1];
 float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);

  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


 gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);


  setPickingColor(a_PickingColor);
}
`,Tr=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if (isSide < 0.999) {// \u662F\u5426\u662F\u8FB9\u7F18
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,Ln=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec3 a_uvs;


layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  float lightWeight = calc_lighting(pos);
  vec4 project_pos = project_position(pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;
   
  v_texture_data = vec2(a_Position.z, lightWeight);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }


    gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));



  setPickingColor(a_PickingColor);
}
`,An=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,$n=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;
layout(location = 14) in vec3 a_uvs;


layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {


  v_uvs = a_uvs;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(pos);
  v_texture_data = vec2(a_Position.z,lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Fn=function(e){(0,Ai.Z)(n,e);var r=Ut(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.mapTexture,c=a.heightfixed,p=c===void 0?!1:c,g=a.raisingHeight,b=g===void 0?0:g,w=a.topsurface,I=w===void 0?!0:w,W=a.sidesurface,pe=W===void 0?!0:W,Me=a.sourceColor,Fe=a.targetColor,ut=0,Ot=[1,1,1,1],Bt=[1,1,1,1];Me&&Fe&&(Ot=(0,ze.CI)(Me),Bt=(0,ze.CI)(Fe),ut=1);var ir={u_sourceColor:Ot,u_targetColor:Bt,u_linearColor:ut,u_topsurface:Number(I),u_sidesurface:Number(pe),u_heightfixed:Number(p),u_raisingHeight:Number(b)};s&&this.texture&&(ir.u_texture=this.texture,this.textures=[this.texture]);var xr=this.getUniformsBufferInfo(ir);return xr}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.loadTexture();case 2:return p.abrupt("return",this.buildModels());case 3:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return c=this.getShaders(),p=c.frag,g=c.vert,b=c.type,this.initUniformsBuffer(),W.next=4,this.layer.buildLayerModel({moduleName:b,vertexShader:g,fragmentShader:p,depth:{enable:!0},inject:this.getInject(),triangulation:le});case 4:return w=W.sent,W.abrupt("return",[w]);case 6:case"end":return W.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){var a=this.layer.getLayerConfig(),s=a.pickLight,c=a.mapTexture;return c?{frag:Tr,vert:Ln,type:"polygonExtrudeTexture"}:s?{frag:An,vert:$n,type:"polygonExtrudePickLight"}:{frag:ln,vert:Lr,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy(),this.textures=[]}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getSource().extent,s=a,c=this.layer.coordCenter||this.layer.getSource().center,p=s[2]-s[0],g=s[3]-s[1];if(this.mapService.version==="GAODE2.x"){var b=this.mapService.coordToAMap2RelativeCoordinates([a[0],a[1]],c),w=(0,Fi.Z)(b,2),I=w[0],W=w[1],pe=this.mapService.coordToAMap2RelativeCoordinates([a[2],a[3]],c),Me=(0,Fi.Z)(pe,2),Fe=Me[0],ut=Me[1];p=Fe-I,g=ut-W,s=[I,W,Fe,ut]}this.styleAttributeService.registerStyleAttribute({name:"uvs",type:$.GC.Attribute,descriptor:{name:"a_uvs",shaderLocation:rn.UV,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(Bt,ir,xr){var qr=xr[0],Ir=xr[1];return[(qr-s[0])/p,(Ir-s[1])/g,xr[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:$.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(Bt,ir,xr,qr,Ir){return Ir}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(Bt){var ir=Bt.size,xr=ir===void 0?10:ir;return Array.isArray(xr)?[xr[0]]:[xr]}}})}},{key:"loadTexture",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(c=this.layer.getLayerConfig(),p=c.mapTexture,g=this.rendererService.createTexture2D,this.texture=g({height:1,width:1}),!p){I.next=8;break}return I.next=6,Ee(p);case 6:b=I.sent,this.texture=g({data:b,width:b.width,height:b.height,wrapS:$.gl.CLAMP_TO_EDGE,wrapT:$.gl.CLAMP_TO_EDGE,min:$.gl.LINEAR,mag:$.gl.LINEAR});case 8:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()}]),n}(ao);function jn(e){var r=Kn();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Kn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Cn=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,Vn=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 13) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
 
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos);
   float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`,_r=function(e){(0,Ai.Z)(n,e);var r=jn(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a={},s=this.getUniformsBufferInfo(a);return s}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return c=this.getShaders(),p=c.frag,g=c.vert,b=c.type,this.initUniformsBuffer(),W.next=4,this.layer.buildLayerModel({moduleName:b,vertexShader:g,fragmentShader:p,inject:this.getInject(),triangulation:le,depth:{enable:!0}});case 4:return w=W.sent,W.abrupt("return",[w]);case 6:case"end":return W.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getShaders",value:function(){return{frag:Cn,vert:Vn,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:$.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s,c,p,g,b){return b}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(s){var c=s.size,p=c===void 0?10:c;return Array.isArray(p)?[p[0]]:[p]}}})}}]),n}(ao);function Gr(e){var r=Bn();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Bn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ni=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,bn=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,si=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 15) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}`,Mn=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};


out vec4 v_color;


#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

 
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,ii=function(e){(0,Ai.Z)(n,e);var r=Gr(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.raisingHeight,c=s===void 0?0:s,p=a.opacityLinear,g=p===void 0?{enable:!1,dir:"in"}:p,b={u_raisingHeight:Number(c),u_opacitylinear:Number(g.enable),u_dir:g.dir==="in"?1:0},w=this.getUniformsBufferInfo(b);return w}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I;return Ne().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return c=this.getModelParams(),p=c.frag,g=c.vert,b=c.triangulation,w=c.type,this.initUniformsBuffer(),this.layer.triangulation=b,pe.next=5,this.layer.buildLayerModel({moduleName:w,vertexShader:g,fragmentShader:p,inject:this.getInject(),triangulation:b,primitive:$.gl.TRIANGLES,depth:{enable:!1}});case 5:return I=pe.sent,pe.abrupt("return",[I]);case 7:case"end":return pe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getLayerConfig(),s=a.opacityLinear,c=s===void 0?{enable:!1,dir:"in"}:s;c.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:$.GC.Attribute,descriptor:{name:"a_linear",shaderLocation:rn.LINEAR,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(g,b,w){return[w[3],w[4],w[5]]}}})}},{key:"getModelParams",value:function(){var a=this.layer.getLayerConfig(),s=a.opacityLinear,c=s===void 0?{enable:!1}:s;return c.enable?{frag:bn,vert:si,type:"polygonLinear",triangulation:ne}:{frag:ni,vert:Mn,type:"polygonFill",triangulation:ze.yR}}}]),n}(ao);function En(e){var r=Qn();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Qn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ui=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,oa=`layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};


out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,ei=ze.rU.isNumber,Pn=function(e){(0,Ai.Z)(n,e);var r=En(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.watercolor,c=s===void 0?"#6D99A8":s,p=a.watercolor2,g=p===void 0?"#0F121C":p,b={u_watercolor:(0,ze.CI)(c),u_watercolor2:(0,ze.CI)(g),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};this.textures=[this.texture1,this.texture2,this.texture3];var w=this.getUniformsBufferInfo(b);return w}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.loadTexture(),p.abrupt("return",this.buildModels());case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:oa,fragmentShader:Ui,inject:this.getInject(),triangulation:j,primitive:$.gl.TRIANGLES,depth:{enable:!1}});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a,s,c;(a=this.texture1)===null||a===void 0||a.destroy(),(s=this.texture2)===null||s===void 0||s.destroy(),(c=this.texture3)===null||c===void 0||c.destroy()}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getSource().extent,s=(0,Fi.Z)(a,4),c=s[0],p=s[1],g=s[2],b=s[3],w=g-c,I=b-p;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:$.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:rn.UV,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(pe,Me,Fe,ut){var Ot=pe.version==="GAODE2.x"?pe.originCoordinates[0][ut]:Fe,Bt=(0,Fi.Z)(Ot,2),ir=Bt[0],xr=Bt[1];return[(ir-c)/w,(xr-p)/I]}}})}},{key:"loadTexture",value:function(){var a=this,s=this.rendererService.createTexture2D,c={height:0,width:0};this.texture1=s(c),this.texture2=s(c),this.texture3=s(c),p(function(b){a.texture1=g(b[0]),a.texture2=g(b[1]),a.texture3=g(b[2]),a.layerService.reRender()});function p(b){var w=0,I=[],W=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];W.map(function(pe){var Me=new Image;Me.crossOrigin="",Me.src=pe,I.push(Me),Me.onload=function(){w++,w===3&&b(I)}})}function g(b){return s({data:b,width:b.width,height:b.height,wrapS:$.gl.MIRRORED_REPEAT,wrapT:$.gl.MIRRORED_REPEAT,min:$.gl.LINEAR,mag:$.gl.LINEAR})}}}]),n}(ao);function cn(e){var r=zi();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function zi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pa=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,ui=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 14) in vec2 a_uv;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;


#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xyz, 1.0));
}

`,va=ze.rU.isNumber,aa=function(e){(0,Ai.Z)(n,e);var r=cn(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.speed,c=s===void 0?.5:s,p={u_speed:c,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};this.textures=[this.texture];var g=this.getUniformsBufferInfo(p);return g}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.loadTexture(),p.abrupt("return",this.buildModels());case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:ui,fragmentShader:pa,triangulation:j,inject:this.getInject(),primitive:$.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var a=this.layer.getSource().extent,s=(0,Fi.Z)(a,4),c=s[0],p=s[1],g=s[2],b=s[3],w=g-c,I=b-p;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:$.GC.Attribute,descriptor:{name:"a_uv",shaderLocation:rn.UV,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(pe,Me,Fe,ut){var Ot=pe.version==="GAODE2.x"?pe.originCoordinates[0][ut]:Fe,Bt=(0,Fi.Z)(Ot,2),ir=Bt[0],xr=Bt[1];return[(ir-c)/w,(xr-p)/I]}}})}},{key:"loadTexture",value:function(){var a=this,s=this.layer.getLayerConfig(),c=s.waterTexture,p=this.rendererService.createTexture2D;this.texture=p({height:1,width:1});var g=new Image;g.crossOrigin="",c?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),g.src=c):g.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",g.onload=function(){a.texture=p({data:g,width:g.width,height:g.height,wrapS:$.gl.MIRRORED_REPEAT,wrapT:$.gl.MIRRORED_REPEAT,min:$.gl.LINEAR,mag:$.gl.LINEAR}),a.layerService.reRender()}}}]),n}(ao),Yi={fill:ii,line:Ke,extrude:Fn,text:Rd,point_fill:ts,point_image:Kl,point_normal:rd,point_extrude:Eo,water:aa,ocean:Pn,extrusion:_r},Qa=Yi;function Is(e){var r=du();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ba=function(e){(0,Ai.Z)(n,e);var r=Is(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"type","PolygonLayer"),(0,G.Z)((0,gn.Z)(i),"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"]),i}return(0,We.Z)(n,[{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new Qa[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getModelType",value:function(){var a,s=this.styleAttributeService.getLayerStyleAttribute("shape"),c=s==null||(a=s.scale)===null||a===void 0?void 0:a.field;return c==="fill"||!c?"fill":c==="extrude"?"extrude":c==="extrusion"?"extrusion":c==="water"?"water":c==="ocean"?"ocean":c==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var a=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,p=s.shape3d,g=this.iconService.getIconMap(),b=a.find(function(I){return I.hasOwnProperty("shape")});if(b){var w=b.shape;return w==="dot"?"point_normal":(c==null?void 0:c.indexOf(w))!==-1?"point_fill":(p==null?void 0:p.indexOf(w))!==-1?"point_extrude":g.hasOwnProperty(w)?"point_image":"text"}else return"fill"}}]),n}(es);function Os(e){var r=Lo();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Lo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Us=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,zs=`layout(location = 0) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,cs=function(e){(0,Ai.Z)(n,e);var r=Os(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=s===void 0?1:s,p=a.color,g=p===void 0?"#000":p,b={u_color:(0,ze.CI)(g),u_opacity:c||1},w=this.getUniformsBufferInfo(b);return w}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"mask",vertexShader:zs,fragmentShader:Us,triangulation:j,depth:{enable:!1},pick:!1});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;a&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),n}(ao),Js={fill:cs},Fu=Js;function Zs(e){var r=ca();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function ca(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pu=function(e){(0,Ai.Z)(n,e);var r=Zs(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"type","MaskLayer"),i}return(0,We.Z)(n,[{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new Fu[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getModelType",value:function(){return"fill"}}]),n}(es),ta=_(86700),$i=_(83557),xa,Ha,Es,wc,It,Nr,Rr,li=ze.rU.cloneDeep,ha=(xa=(0,ta.b2)(),Ha=(0,ta.f3)($.vK.IMapService),Es=(0,ta.f3)($.vK.IFontService),xa(wc=(It=function(){function e(){(0,Ge.Z)(this,e),(0,wa.Z)(this,"mapService",Nr,this),(0,wa.Z)(this,"fontService",Rr,this)}return(0,We.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("DataMappingPlugin",(0,He.Z)(Ne().mark(function c(){return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:n.log($.Or.MappingStart,$.KD.INIT),a.generateMaping(n,{styleAttributeService:s}),n.log($.Or.MappingEnd,$.KD.INIT);case 3:case"end":return g.stop()}},c)}))),n.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var c=(0,He.Z)(Ne().mark(function p(g){var b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(g){I.next=2;break}return I.abrupt("return",g);case 2:return n.dataState.dataMappingNeedUpdate=!1,n.log($.Or.MappingStart,$.KD.UPDATE),b=a.generateMaping(n,{styleAttributeService:s}),n.log($.Or.MappingEnd,$.KD.UPDATE),I.abrupt("return",b);case 7:case"end":return I.stop()}},p)}));return function(p){return c.apply(this,arguments)}}()),n.hooks.beforeRender.tap("DataMappingPlugin",function(){var c=n.getSource();if(!(n.layerModelNeedUpdate||!c||!c.inited)){var p=s.getLayerStyleAttributes()||[],g=s.getLayerStyleAttribute("filter"),b=c.data.dataArray;if(!(Array.isArray(b)&&b.length===0)){var w=p.filter(function(pe){return pe.needRemapping}),I=b;if(g!=null&&g.needRemapping&&g!==null&&g!==void 0&&g.scale&&(I=b.filter(function(pe){return a.applyAttributeMapping(g,pe)[0]})),w.length){var W=a.mapping(n,w,I,n.getEncodedData());n.setEncodedData(W)}}}})}},{key:"generateMaping",value:function(n,i){var a=this,s=i.styleAttributeService,c=s.getLayerStyleAttributes()||[],p=s.getLayerStyleAttribute("filter"),g=n.getSource().data.dataArray,b=g;p!=null&&p.scale&&(b=g.filter(function(I){return a.applyAttributeMapping(p,I)[0]})),b=n.processData(b);var w=this.mapping(n,c,b,void 0);return n.setEncodedData(w),n.emit("dataUpdate",null),!0}},{key:"mapping",value:function(n,i,a,s){var c=this,p=i.filter(function(b){return b.scale!==void 0}).filter(function(b){return b.name!=="filter"}),g=a.map(function(b,w){var I=s?s[w]:{},W=(0,fe.Z)({id:b._id,coordinates:b.coordinates},I);return p.forEach(function(pe){var Me=c.applyAttributeMapping(pe,b);(pe.name==="color"||pe.name==="stroke")&&(Me=Me.map(function(Fe){return(0,ze.CI)(Fe)})),W[pe.name]=Array.isArray(Me)&&Me.length===1?Me[0]:Me,pe.name==="shape"&&(W.shape=c.fontService.getIconFontKey(W[pe.name]))}),W});return i.forEach(function(b){b.needRemapping=!1}),this.adjustData2Amap2Coordinates(g,n),this.adjustData2SimpleCoordinates(g),g}},{key:"adjustData2Amap2Coordinates",value:function(n,i){var a=this;if(n.length>0&&this.mapService.version==="GAODE2.x"){var s=i.coordCenter||i.getSource().center;n.filter(function(c){return!c.originCoordinates}).map(function(c){c.version="GAODE2.x",c.originCoordinates=li(c.coordinates),c.coordinates=a.mapService.coordToAMap2RelativeCoordinates(c.coordinates,s)})}}},{key:"adjustData2SimpleCoordinates",value:function(n){var i=this;n.length>0&&this.mapService.version==="SIMPLE"&&n.map(function(a){a.simpleCoordinate||(a.coordinates=i.unProjectCoordinates(a.coordinates),a.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(n){var i=this;if(typeof n[0]=="number")return this.mapService.simpleMapCoord.unproject(n);if(n[0]&&n[0][0]instanceof Array){var a=[];return n.map(function(c){var p=[];c.map(function(g){p.push(i.mapService.simpleMapCoord.unproject(g))}),a.push(p)}),a}else{var s=[];return n.map(function(c){s.push(i.mapService.simpleMapCoord.unproject(c))}),s}}},{key:"applyAttributeMapping",value:function(n,i){var a;if(!n.scale)return[];var s=(n==null||(a=n.scale)===null||a===void 0?void 0:a.scalers)||[],c=[];s.forEach(function(g){var b,w=g.field;(i.hasOwnProperty(w)||((b=n.scale)===null||b===void 0?void 0:b.type)==="variable")&&c.push(i[w])});var p=n.mapping?n.mapping(c):[];return p}},{key:"getArrowPoints",value:function(n,i){var a=[i[0]-n[0],i[1]-n[1]],s=(0,ze.Fv)(a),c=[n[0]+s[0]*1e-4,n[1]+s[1]*1e-4];return c}}]),e}(),Nr=(0,qs.Z)(It.prototype,"mapService",[Ha],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=(0,qs.Z)(It.prototype,"fontService",[Es],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It))||wc),vo,Qe,xt=(vo=(0,ta.b2)(),vo(Qe=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n){var i=this;this.mapService=n.getContainer().get($.vK.IMapService),n.hooks.init.tapPromise("DataSourcePlugin",(0,He.Z)(Ne().mark(function a(){var s,c,p,g;return Ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(n.log($.Or.SourceInitStart,$.KD.INIT),s=n.getSource(),s||(c=n.sourceOption||n.defaultSourceConfig,p=c.data,g=c.options,s=new ou(p,g),n.setSource(s)),!s.inited){w.next=8;break}i.updateClusterData(n),n.log($.Or.SourceInitEnd,$.KD.INIT),w.next=10;break;case 8:return w.next=10,new Promise(function(I){s.on("update",function(W){W.type==="inited"&&(i.updateClusterData(n),n.log($.Or.SourceInitEnd,$.KD.INIT)),I(null)})});case 10:case"end":return w.stop()}},a)}))),n.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,He.Z)(Ne().mark(function a(){var s,c,p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=i.updateClusterData(n),c=n.dataState.dataSourceNeedUpdate,n.dataState.dataSourceNeedUpdate=!1,p=s||c,b.abrupt("return",p);case 5:case"end":return b.stop()}},a)})))}},{key:"updateClusterData",value:function(n){if(n.isTileLayer||n.tileLayer||!n.getSource())return!1;var i=n.getSource(),a=i.cluster,s=i.clusterOptions.zoom,c=s===void 0?0:s,p=this.mapService.getZoom()-1,g=n.dataState.dataSourceNeedUpdate;return a&&g&&i.updateClusterData(Math.floor(p)),a&&Math.abs(n.clusterZoom-p)>=1?(c!==Math.floor(p)&&i.updateClusterData(Math.floor(p)),n.clusterZoom=p,!0):!1}}]),e}())||Qe);function Nt(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function Mr(e){return e.length===1&&(e=Ar(e)),{left:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)<0?i=s+1:a=s}return i},right:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)>0?a=s:i=s+1}return i}}}function Ar(e){return function(r,n){return Nt(e(r),n)}}var Kt=Mr(Nt),nr=Kt.right,ur=Kt.left,Dt=null;function Jt(e,r){var n=e.length,i=-1,a,s,c;if(r==null){for(;++i<n;)if((a=e[i])!=null&&a>=a)for(s=c=a;++i<n;)(a=e[i])!=null&&(s>a&&(s=a),c<a&&(c=a))}else for(;++i<n;)if((a=r(e[i],i,e))!=null&&a>=a)for(s=c=a;++i<n;)(a=r(e[i],i,e))!=null&&(s>a&&(s=a),c<a&&(c=a));return[s,c]}var gt=Array.prototype,rr=gt.slice,zr=gt.map,Yr=Math.sqrt(50),Sn=Math.sqrt(10),pn=Math.sqrt(2);function wn(e,r,n){var i,a=-1,s,c,p;if(r=+r,e=+e,n=+n,e===r&&n>0)return[e];if((i=r<e)&&(s=e,e=r,r=s),(p=wi(e,r,n))===0||!isFinite(p))return[];if(p>0)for(e=Math.ceil(e/p),r=Math.floor(r/p),c=new Array(s=Math.ceil(r-e+1));++a<s;)c[a]=(e+a)*p;else for(e=Math.floor(e*p),r=Math.ceil(r*p),c=new Array(s=Math.ceil(e-r+1));++a<s;)c[a]=(e-a)/p;return i&&c.reverse(),c}function wi(e,r,n){var i=(r-e)/Math.max(0,n),a=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,a);return a>=0?(s>=Yr?10:s>=Sn?5:s>=pn?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(s>=Yr?10:s>=Sn?5:s>=pn?2:1)}function yi(e,r,n){var i=Math.abs(r-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/a;return s>=Yr?a*=10:s>=Sn?a*=5:s>=pn&&(a*=2),r<e?-a:a}function Si(){var e=identity,r=extent,n=sturges;function i(a){var s,c=a.length,p,g=new Array(c);for(s=0;s<c;++s)g[s]=e(a[s],s,a);var b=r(g),w=b[0],I=b[1],W=n(g,w,I);Array.isArray(W)||(W=tickStep(w,I,W),W=range(Math.ceil(w/W)*W,I,W));for(var pe=W.length;W[0]<=w;)W.shift(),--pe;for(;W[pe-1]>I;)W.pop(),--pe;var Me=new Array(pe+1),Fe;for(s=0;s<=pe;++s)Fe=Me[s]=[],Fe.x0=s>0?W[s-1]:w,Fe.x1=s<pe?W[s]:I;for(s=0;s<c;++s)p=g[s],w<=p&&p<=I&&Me[bisect(W,p,0,pe)].push(a[s]);return Me}return i.value=function(a){return arguments.length?(e=typeof a=="function"?a:constant(a),i):e},i.domain=function(a){return arguments.length?(r=typeof a=="function"?a:constant([a[0],a[1]]),i):r},i.thresholds=function(a){return arguments.length?(n=typeof a=="function"?a:Array.isArray(a)?constant(slice.call(a)):constant(a),i):n},i}function Wi(e,r,n){return e=map.call(e,number).sort(ascending),Math.ceil((n-r)/(2*(quantile(e,.75)-quantile(e,.25))*Math.pow(e.length,-1/3)))}var Ki=_(37620);function to(e,r,n,i,a){var s=e*e,c=s*e;return((1-3*e+3*s-c)*r+(4-6*s+3*c)*n+(1+3*e+3*s-3*c)*i+c*a)/6}function js(e){var r=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,r-1):Math.floor(n*r),a=e[i],s=e[i+1],c=i>0?e[i-1]:2*a-s,p=i<r-1?e[i+2]:2*s-a;return to((n-i/r)*r,c,a,s,p)}}function Uc(e){var r=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*r),a=e[(i+r-1)%r],s=e[i%r],c=e[(i+1)%r],p=e[(i+2)%r];return to((n-i/r)*r,a,s,c,p)}}function Bh(e){return function(){return e}}function lc(e,r){return function(n){return e+n*r}}function cp(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(i){return Math.pow(e+i*r,n)}}function Vf(e,r){var n=r-e;return n?lc(e,n>180||n<-180?n-360*Math.round(n/360):n):constant(isNaN(e)?r:e)}function Md(e){return(e=+e)==1?Gp:function(r,n){return n-r?cp(r,n,e):Bh(isNaN(r)?n:r)}}function Gp(e,r){var n=r-e;return n?lc(e,n):Bh(isNaN(e)?r:e)}var Xp=function e(r){var n=Md(r);function i(a,s){var c=n((a=(0,Ki.B8)(a)).r,(s=(0,Ki.B8)(s)).r),p=n(a.g,s.g),g=n(a.b,s.b),b=Gp(a.opacity,s.opacity);return function(w){return a.r=c(w),a.g=p(w),a.b=g(w),a.opacity=b(w),a+""}}return i.gamma=e,i}(1);function Yp(e){return function(r){var n=r.length,i=new Array(n),a=new Array(n),s=new Array(n),c,p;for(c=0;c<n;++c)p=(0,Ki.B8)(r[c]),i[c]=p.r||0,a[c]=p.g||0,s[c]=p.b||0;return i=e(i),a=e(a),s=e(s),p.opacity=1,function(g){return p.r=i(g),p.g=a(g),p.b=s(g),p+""}}}var fp=Yp(js),ad=Yp(Uc);function Id(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function Fh(e){return e.length===1&&(e=Lv(e)),{left:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)<0?i=s+1:a=s}return i},right:function(r,n,i,a){for(i==null&&(i=0),a==null&&(a=r.length);i<a;){var s=i+a>>>1;e(r[s],n)>0?a=s:i=s+1}return i}}}function Lv(e){return function(r,n){return Id(e(r),n)}}var Vs=Fh(Id),rs=Vs.right,Em=Vs.left,Od=rs,Kp=Array.prototype,Sm=Kp.slice,Tm=Kp.map,Pd=Math.sqrt(50),oh=Math.sqrt(10),sh=Math.sqrt(2);function qp(e,r,n){var i,a=-1,s,c,p;if(r=+r,e=+e,n=+n,e===r&&n>0)return[e];if((i=r<e)&&(s=e,e=r,r=s),(p=Ss(e,r,n))===0||!isFinite(p))return[];if(p>0)for(e=Math.ceil(e/p),r=Math.floor(r/p),c=new Array(s=Math.ceil(r-e+1));++a<s;)c[a]=(e+a)*p;else for(e=Math.floor(e*p),r=Math.ceil(r*p),c=new Array(s=Math.ceil(e-r+1));++a<s;)c[a]=(e-a)/p;return i&&c.reverse(),c}function Ss(e,r,n){var i=(r-e)/Math.max(0,n),a=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,a);return a>=0?(s>=Pd?10:s>=oh?5:s>=sh?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(s>=Pd?10:s>=oh?5:s>=sh?2:1)}function Nh(e,r,n){var i=Math.abs(r-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/a;return s>=Pd?a*=10:s>=oh?a*=5:s>=sh&&(a*=2),r<e?-a:a}function bh(){var e=identity,r=extent,n=sturges;function i(a){var s,c=a.length,p,g=new Array(c);for(s=0;s<c;++s)g[s]=e(a[s],s,a);var b=r(g),w=b[0],I=b[1],W=n(g,w,I);Array.isArray(W)||(W=tickStep(w,I,W),W=range(Math.ceil(w/W)*W,I,W));for(var pe=W.length;W[0]<=w;)W.shift(),--pe;for(;W[pe-1]>I;)W.pop(),--pe;var Me=new Array(pe+1),Fe;for(s=0;s<=pe;++s)Fe=Me[s]=[],Fe.x0=s>0?W[s-1]:w,Fe.x1=s<pe?W[s]:I;for(s=0;s<c;++s)p=g[s],w<=p&&p<=I&&Me[bisect(W,p,0,pe)].push(a[s]);return Me}return i.value=function(a){return arguments.length?(e=typeof a=="function"?a:constant(a),i):e},i.domain=function(a){return arguments.length?(r=typeof a=="function"?a:constant([a[0],a[1]]),i):r},i.thresholds=function(a){return arguments.length?(n=typeof a=="function"?a:Array.isArray(a)?constant(slice.call(a)):constant(a),i):n},i}function Qp(e,r,n){return e=map.call(e,number).sort(ascending),Math.ceil((n-r)/(2*(quantile(e,.75)-quantile(e,.25))*Math.pow(e.length,-1/3)))}function hp(e){return e===null?NaN:+e}function Jp(e,r,n){if(n==null&&(n=hp),!!(i=e.length)){if((r=+r)<=0||i<2)return+n(e[0],0,e);if(r>=1)return+n(e[i-1],i-1,e);var i,a=(i-1)*r,s=Math.floor(a),c=+n(e[s],s,e),p=+n(e[s+1],s+1,e);return c+(p-c)*(a-s)}}var kl="$";function tf(){}tf.prototype=ev.prototype={constructor:tf,has:function(e){return kl+e in this},get:function(e){return this[kl+e]},set:function(e,r){return this[kl+e]=r,this},remove:function(e){var r=kl+e;return r in this&&delete this[r]},clear:function(){for(var e in this)e[0]===kl&&delete this[e]},keys:function(){var e=[];for(var r in this)r[0]===kl&&e.push(r.slice(1));return e},values:function(){var e=[];for(var r in this)r[0]===kl&&e.push(this[r]);return e},entries:function(){var e=[];for(var r in this)r[0]===kl&&e.push({key:r.slice(1),value:this[r]});return e},size:function(){var e=0;for(var r in this)r[0]===kl&&++e;return e},empty:function(){for(var e in this)if(e[0]===kl)return!1;return!0},each:function(e){for(var r in this)r[0]===kl&&e(this[r],r.slice(1),this)}};function ev(e,r){var n=new tf;if(e instanceof tf)e.each(function(p,g){n.set(g,p)});else if(Array.isArray(e)){var i=-1,a=e.length,s;if(r==null)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(r(s=e[i],i,e),s)}else if(e)for(var c in e)n.set(c,e[c]);return n}var dp=ev;function Qm(){var e=[],r=[],n,i,a;function s(p,g,b,w){if(g>=e.length)return n!=null&&p.sort(n),i!=null?i(p):p;for(var I=-1,W=p.length,pe=e[g++],Me,Fe,ut=map(),Ot,Bt=b();++I<W;)(Ot=ut.get(Me=pe(Fe=p[I])+""))?Ot.push(Fe):ut.set(Me,[Fe]);return ut.each(function(ir,xr){w(Bt,xr,s(ir,g,b,w))}),Bt}function c(p,g){if(++g>e.length)return p;var b,w=r[g-1];return i!=null&&g>=e.length?b=p.entries():(b=[],p.each(function(I,W){b.push({key:W,values:c(I,g)})})),w!=null?b.sort(function(I,W){return w(I.key,W.key)}):b}return a={object:function(p){return s(p,0,Cu,xh)},map:function(p){return s(p,0,tv,t)},entries:function(p){return c(s(p,0,tv,t),0)},key:function(p){return e.push(p),a},sortKeys:function(p){return r[e.length-1]=p,a},sortValues:function(p){return n=p,a},rollup:function(p){return i=p,a}}}function Cu(){return{}}function xh(e,r,n){e[r]=n}function tv(){return map()}function t(e,r,n){e.set(r,n)}function o(){}var u=dp.prototype;o.prototype=v.prototype={constructor:o,has:u.has,add:function(e){return e+="",this[kl+e]=e,this},remove:u.remove,clear:u.clear,values:u.keys,size:u.size,empty:u.empty,each:u.each};function v(e,r){var n=new o;if(e instanceof o)e.each(function(s){n.add(s)});else if(e){var i=-1,a=e.length;if(r==null)for(;++i<a;)n.add(e[i]);else for(;++i<a;)n.add(r(e[i],i,e))}return n}var y=null,x=Array.prototype,A=x.map,B=x.slice;function te(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function _e(e,r){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(r).domain(e);break}return this}var Ce={name:"implicit"};function Ie(){var e=dp(),r=[],n=[],i=Ce;function a(s){var c=s+"",p=e.get(c);if(!p){if(i!==Ce)return i;e.set(c,p=r.push(s))}return n[(p-1)%n.length]}return a.domain=function(s){if(!arguments.length)return r.slice();r=[],e=dp();for(var c=-1,p=s.length,g,b;++c<p;)e.has(b=(g=s[c])+"")||e.set(b,r.push(g));return a},a.range=function(s){return arguments.length?(n=B.call(s),a):n.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return Ie(r,n).unknown(i)},te.apply(a,arguments),a}function Xe(){var e=ordinal().unknown(void 0),r=e.domain,n=e.range,i=[0,1],a,s,c=!1,p=0,g=0,b=.5;delete e.unknown;function w(){var I=r().length,W=i[1]<i[0],pe=i[W-0],Me=i[1-W];a=(Me-pe)/Math.max(1,I-p+g*2),c&&(a=Math.floor(a)),pe+=(Me-pe-a*(I-p))*b,s=a*(1-p),c&&(pe=Math.round(pe),s=Math.round(s));var Fe=sequence(I).map(function(ut){return pe+a*ut});return n(W?Fe.reverse():Fe)}return e.domain=function(I){return arguments.length?(r(I),w()):r()},e.range=function(I){return arguments.length?(i=[+I[0],+I[1]],w()):i.slice()},e.rangeRound=function(I){return i=[+I[0],+I[1]],c=!0,w()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(I){return arguments.length?(c=!!I,w()):c},e.padding=function(I){return arguments.length?(p=Math.min(1,g=+I),w()):p},e.paddingInner=function(I){return arguments.length?(p=Math.min(1,I),w()):p},e.paddingOuter=function(I){return arguments.length?(g=+I,w()):g},e.align=function(I){return arguments.length?(b=Math.max(0,Math.min(1,I)),w()):b},e.copy=function(){return Xe(r(),i).round(c).paddingInner(p).paddingOuter(g).align(b)},initRange.apply(w(),arguments)}function tt(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return tt(r())},e}function Mt(){return tt(Xe.apply(null,arguments).paddingInner(1))}function Pt(e,r){return(isNumberArray(r)?numberArray:qt)(e,r)}function qt(e,r){var n=r?r.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),s=new Array(n),c;for(c=0;c<i;++c)a[c]=ki(e[c],r[c]);for(;c<n;++c)s[c]=r[c];return function(p){for(c=0;c<i;++c)s[c]=a[c](p);return s}}function Zt(e,r){var n=new Date;return e=+e,r=+r,function(i){return n.setTime(e*(1-i)+r*i),n}}function pr(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function Sr(e,r){var n={},i={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?n[a]=ki(e[a],r[a]):i[a]=r[a];return function(s){for(a in n)i[a]=n[a](s);return i}}var Br=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vr=new RegExp(Br.source,"g");function fn(e){return function(){return e}}function Nn(e){return function(r){return e(r)+""}}function qn(e,r){var n=Br.lastIndex=Vr.lastIndex=0,i,a,s,c=-1,p=[],g=[];for(e=e+"",r=r+"";(i=Br.exec(e))&&(a=Vr.exec(r));)(s=a.index)>n&&(s=r.slice(n,s),p[c]?p[c]+=s:p[++c]=s),(i=i[0])===(a=a[0])?p[c]?p[c]+=a:p[++c]=a:(p[++c]=null,g.push({i:c,x:pr(i,a)})),n=Vr.lastIndex;return n<r.length&&(s=r.slice(n),p[c]?p[c]+=s:p[++c]=s),p.length<2?g[0]?Nn(g[0].x):fn(r):(r=g.length,function(b){for(var w=0,I;w<r;++w)p[(I=g[w]).i]=I.x(b);return p.join("")})}function Di(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,i=r.slice(),a;return function(s){for(a=0;a<n;++a)i[a]=e[a]*(1-s)+r[a]*s;return i}}function ci(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ki(e,r){var n=typeof r,i;return r==null||n==="boolean"?Bh(r):(n==="number"?pr:n==="string"?(i=(0,Ki.ZP)(r))?(r=i,Xp):qn:r instanceof Ki.ZP?Xp:r instanceof Date?Zt:ci(r)?Di:Array.isArray(r)?qt:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?Sr:pr)(e,r)}function hi(e,r){return e=+e,r=+r,function(n){return Math.round(e*(1-n)+r*n)}}function ma(e){return function(){return e}}function Qi(e){return+e}var Ti=[0,1];function Ji(e){return e}function ua(e,r){return(r-=e=+e)?function(n){return(n-e)/r}:ma(isNaN(r)?NaN:.5)}function $a(e){var r=e[0],n=e[e.length-1],i;return r>n&&(i=r,r=n,n=i),function(a){return Math.max(r,Math.min(n,a))}}function ji(e,r,n){var i=e[0],a=e[1],s=r[0],c=r[1];return a<i?(i=ua(a,i),s=n(c,s)):(i=ua(i,a),s=n(s,c)),function(p){return s(i(p))}}function no(e,r,n){var i=Math.min(e.length,r.length)-1,a=new Array(i),s=new Array(i),c=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++c<i;)a[c]=ua(e[c],e[c+1]),s[c]=n(r[c],r[c+1]);return function(p){var g=Od(e,p,1,i)-1;return s[g](a[g](p))}}function Bo(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function fs(){var e=Ti,r=Ti,n=ki,i,a,s,c=Ji,p,g,b;function w(){return p=Math.min(e.length,r.length)>2?no:ji,g=b=null,I}function I(W){return isNaN(W=+W)?s:(g||(g=p(e.map(i),r,n)))(i(c(W)))}return I.invert=function(W){return c(a((b||(b=p(r,e.map(i),pr)))(W)))},I.domain=function(W){return arguments.length?(e=A.call(W,Qi),c===Ji||(c=$a(e)),w()):e.slice()},I.range=function(W){return arguments.length?(r=B.call(W),w()):r.slice()},I.rangeRound=function(W){return r=B.call(W),n=hi,w()},I.clamp=function(W){return arguments.length?(c=W?$a(e):Ji,I):c!==Ji},I.interpolate=function(W){return arguments.length?(n=W,w()):n},I.unknown=function(W){return arguments.length?(s=W,I):s},function(W,pe){return i=W,a=pe,w()}}function hs(e,r){return fs()(e,r)}var ns=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function is(e){if(!(r=ns.exec(e)))throw new Error("invalid format: "+e);var r;return new Hs({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}is.prototype=Hs.prototype;function Hs(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Hs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function vu(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wu(e,r){if((n=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Ts(e){return e=wu(Math.abs(e)),e?e[1]:NaN}function dl(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ts(r)/3)))*3-Ts(Math.abs(e)))}function Ps(e,r){return function(n,i){for(var a=n.length,s=[],c=0,p=e[0],g=0;a>0&&p>0&&(g+p+1>i&&(p=Math.max(1,i-g)),s.push(n.substring(a-=p,a+p)),!((g+=p+1)>i));)p=e[c=(c+1)%e.length];return s.reverse().join(r)}}function Ru(e){return function(r){return r.replace(/[0-9]/g,function(n){return e[+n]})}}function Ba(e){e:for(var r=e.length,n=1,i=-1,a;n<r;++n)switch(e[n]){case".":i=a=n;break;case"0":i===0&&(i=n),a=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(a+1):e}var So;function _o(e,r){var n=wu(e,r);if(!n)return e+"";var i=n[0],a=n[1],s=a-(So=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,c=i.length;return s===c?i:s>c?i+new Array(s-c+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+wu(e,Math.max(0,r+s-1))[0]}function Xa(e,r){var n=wu(e,r);if(!n)return e+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}var pl={"%":function(e,r){return(e*100).toFixed(r)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:vu,e:function(e,r){return e.toExponential(r)},f:function(e,r){return e.toFixed(r)},g:function(e,r){return e.toPrecision(r)},o:function(e){return Math.round(e).toString(8)},p:function(e,r){return Xa(e*100,r)},r:Xa,s:_o,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Nu(e){return e}var jo=Array.prototype.map,Ds=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Ku(e){var r=e.grouping===void 0||e.thousands===void 0?Nu:Ps(jo.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Nu:Ru(jo.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",p=e.minus===void 0?"-":e.minus+"",g=e.nan===void 0?"NaN":e.nan+"";function b(I){I=is(I);var W=I.fill,pe=I.align,Me=I.sign,Fe=I.symbol,ut=I.zero,Ot=I.width,Bt=I.comma,ir=I.precision,xr=I.trim,qr=I.type;qr==="n"?(Bt=!0,qr="g"):pl[qr]||(ir===void 0&&(ir=12),xr=!0,qr="g"),(ut||W==="0"&&pe==="=")&&(ut=!0,W="0",pe="=");var Ir=Fe==="$"?n:Fe==="#"&&/[boxX]/.test(qr)?"0"+qr.toLowerCase():"",mr=Fe==="$"?i:/[%p]/.test(qr)?c:"",sn=pl[qr],ti=/[defgprs%]/.test(qr);ir=ir===void 0?6:/[gprs]/.test(qr)?Math.max(1,Math.min(21,ir)):Math.max(0,Math.min(20,ir));function Bi(ai){var ra=Ir,fa=mr,nu,yl,_l;if(qr==="c")fa=sn(ai)+fa,ai="";else{ai=+ai;var Mf=ai<0||1/ai<0;if(ai=isNaN(ai)?g:sn(Math.abs(ai),ir),xr&&(ai=Ba(ai)),Mf&&+ai==0&&Me!=="+"&&(Mf=!1),ra=(Mf?Me==="("?Me:p:Me==="-"||Me==="("?"":Me)+ra,fa=(qr==="s"?Ds[8+So/3]:"")+fa+(Mf&&Me==="("?")":""),ti){for(nu=-1,yl=ai.length;++nu<yl;)if(_l=ai.charCodeAt(nu),48>_l||_l>57){fa=(_l===46?a+ai.slice(nu+1):ai.slice(nu))+fa,ai=ai.slice(0,nu);break}}}Bt&&!ut&&(ai=r(ai,1/0));var uf=ra.length+ai.length+fa.length,pc=uf<Ot?new Array(Ot-uf+1).join(W):"";switch(Bt&&ut&&(ai=r(pc+ai,pc.length?Ot-fa.length:1/0),pc=""),pe){case"<":ai=ra+ai+fa+pc;break;case"=":ai=ra+pc+ai+fa;break;case"^":ai=pc.slice(0,uf=pc.length>>1)+ra+ai+fa+pc.slice(uf);break;default:ai=pc+ra+ai+fa;break}return s(ai)}return Bi.toString=function(){return I+""},Bi}function w(I,W){var pe=b((I=is(I),I.type="f",I)),Me=Math.max(-8,Math.min(8,Math.floor(Ts(W)/3)))*3,Fe=Math.pow(10,-Me),ut=Ds[8+Me/3];return function(Ot){return pe(Fe*Ot)+ut}}return{format:b,formatPrefix:w}}var Ya,rf,cc;Hf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Hf(e){return Ya=Ku(e),rf=Ya.format,cc=Ya.formatPrefix,Ya}function ks(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Ts(r)-Ts(e))+1}function $f(e){return Math.max(0,-Ts(Math.abs(e)))}function nf(e,r,n,i){var a=Nh(e,r,n),s;switch(i=is(i==null?",f":i),i.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(r));return i.precision==null&&!isNaN(s=dl(a,c))&&(i.precision=s),cc(i,c)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=ks(a,Math.max(Math.abs(e),Math.abs(r))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=$f(a))&&(i.precision=s-(i.type==="%")*2);break}}return rf(i)}function Wf(e){var r=e.domain;return e.ticks=function(n){var i=r();return qp(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var a=r();return nf(a[0],a[a.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=r(),a=0,s=i.length-1,c=i[a],p=i[s],g;return p<c&&(g=c,c=p,p=g,g=a,a=s,s=g),g=Ss(c,p,n),g>0?(c=Math.floor(c/g)*g,p=Math.ceil(p/g)*g,g=Ss(c,p,n)):g<0&&(c=Math.ceil(c*g)/g,p=Math.floor(p*g)/g,g=Ss(c,p,n)),g>0?(i[a]=Math.floor(c/g)*g,i[s]=Math.ceil(p/g)*g,r(i)):g<0&&(i[a]=Math.ceil(c*g)/g,i[s]=Math.floor(p*g)/g,r(i)),e},e}function Eh(){var e=hs(Ji,Ji);return e.copy=function(){return Bo(e,Eh())},te.apply(e,arguments),Wf(e)}function od(e){var r;function n(i){return isNaN(i=+i)?r:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=map.call(i,number),n):e.slice()},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return od(e).unknown(r)},e=arguments.length?map.call(e,number):[0,1],linearish(n)}function Gf(e,r){e=e.slice();var n=0,i=e.length-1,a=e[n],s=e[i],c;return s<a&&(c=n,n=i,i=c,c=a,a=s,s=c),e[n]=r.floor(a),e[i]=r.ceil(s),e}function Uh(e){return Math.log(e)}function Dd(e){return Math.exp(e)}function sd(e){return-Math.log(-e)}function kd(e){return-Math.exp(-e)}function pp(e){return isFinite(e)?+("1e"+e):e<0?0:e}function vp(e){return e===10?pp:e===Math.E?Math.exp:function(r){return Math.pow(e,r)}}function uh(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(r){return Math.log(r)/e})}function ud(e){return function(r){return-e(-r)}}function ld(e){var r=e(Uh,Dd),n=r.domain,i=10,a,s;function c(){return a=uh(i),s=vp(i),n()[0]<0?(a=ud(a),s=ud(s),e(sd,kd)):e(Uh,Dd),r}return r.base=function(p){return arguments.length?(i=+p,c()):i},r.domain=function(p){return arguments.length?(n(p),c()):n()},r.ticks=function(p){var g=n(),b=g[0],w=g[g.length-1],I;(I=w<b)&&(W=b,b=w,w=W);var W=a(b),pe=a(w),Me,Fe,ut,Ot=p==null?10:+p,Bt=[];if(!(i%1)&&pe-W<Ot){if(W=Math.round(W)-1,pe=Math.round(pe)+1,b>0){for(;W<pe;++W)for(Fe=1,Me=s(W);Fe<i;++Fe)if(ut=Me*Fe,!(ut<b)){if(ut>w)break;Bt.push(ut)}}else for(;W<pe;++W)for(Fe=i-1,Me=s(W);Fe>=1;--Fe)if(ut=Me*Fe,!(ut<b)){if(ut>w)break;Bt.push(ut)}}else Bt=qp(W,pe,Math.min(pe-W,Ot)).map(s);return I?Bt.reverse():Bt},r.tickFormat=function(p,g){if(g==null&&(g=i===10?".0e":","),typeof g!="function"&&(g=rf(g)),p===1/0)return g;p==null&&(p=10);var b=Math.max(1,i*p/r.ticks().length);return function(w){var I=w/s(Math.round(a(w)));return I*i<i-.5&&(I*=i),I<=b?g(w):""}},r.nice=function(){return n(Gf(n(),{floor:function(p){return s(Math.floor(a(p)))},ceil:function(p){return s(Math.ceil(a(p)))}}))},r}function lh(){var e=ld(fs()).domain([1,10]);return e.copy=function(){return Bo(e,lh()).base(e.base())},te.apply(e,arguments),e}function zh(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function Ld(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function mp(e){var r=1,n=e(zh(r),Ld(r));return n.constant=function(i){return arguments.length?e(zh(r=+i),Ld(r)):r},linearish(n)}function Bd(){var e=mp(transformer());return e.copy=function(){return copy(e,Bd()).constant(e.constant())},initRange.apply(e,arguments)}function cd(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function gp(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Fd(e){return e<0?-e*e:e*e}function Nd(e){var r=e(Ji,Ji),n=1;function i(){return n===1?e(Ji,Ji):n===.5?e(gp,Fd):e(cd(n),cd(1/n))}return r.exponent=function(a){return arguments.length?(n=+a,i()):n},Wf(r)}function Zh(){var e=Nd(fs());return e.copy=function(){return Bo(e,Zh()).exponent(e.exponent())},te.apply(e,arguments),e}function rv(){return Zh.apply(null,arguments).exponent(.5)}function jh(){var e=[],r=[],n=[],i;function a(){var c=0,p=Math.max(1,r.length);for(n=new Array(p-1);++c<p;)n[c-1]=Jp(e,c/p);return s}function s(c){return isNaN(c=+c)?i:r[Od(n,c)]}return s.invertExtent=function(c){var p=r.indexOf(c);return p<0?[NaN,NaN]:[p>0?n[p-1]:e[0],p<n.length?n[p]:e[e.length-1]]},s.domain=function(c){if(!arguments.length)return e.slice();e=[];for(var p=0,g=c.length,b;p<g;++p)b=c[p],b!=null&&!isNaN(b=+b)&&e.push(b);return e.sort(Id),a()},s.range=function(c){return arguments.length?(r=B.call(c),a()):r.slice()},s.unknown=function(c){return arguments.length?(i=c,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return jh().domain(e).range(r).unknown(i)},te.apply(s,arguments)}function Ud(){var e=0,r=1,n=1,i=[.5],a=[0,1],s;function c(g){return g<=g?a[Od(i,g,0,n)]:s}function p(){var g=-1;for(i=new Array(n);++g<n;)i[g]=((g+1)*r-(g-n)*e)/(n+1);return c}return c.domain=function(g){return arguments.length?(e=+g[0],r=+g[1],p()):[e,r]},c.range=function(g){return arguments.length?(n=(a=B.call(g)).length-1,p()):a.slice()},c.invertExtent=function(g){var b=a.indexOf(g);return b<0?[NaN,NaN]:b<1?[e,i[0]]:b>=n?[i[n-1],r]:[i[b-1],i[b]]},c.unknown=function(g){return arguments.length&&(s=g),c},c.thresholds=function(){return i.slice()},c.copy=function(){return Ud().domain([e,r]).range(a).unknown(s)},te.apply(Wf(c),arguments)}function Vh(){var e=[.5],r=[0,1],n,i=1;function a(s){return s<=s?r[Od(e,s,0,i)]:n}return a.domain=function(s){return arguments.length?(e=B.call(s),i=Math.min(e.length,r.length-1),a):e.slice()},a.range=function(s){return arguments.length?(r=B.call(s),i=Math.min(e.length,r.length-1),a):r.slice()},a.invertExtent=function(s){var c=r.indexOf(s);return[e[c-1],e[c]]},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return Vh().domain(e).range(r).unknown(n)},te.apply(a,arguments)}var Hh=new Date,ch=new Date;function qu(e,r,n,i){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=function(s){return e(s=new Date(+s)),s},a.ceil=function(s){return e(s=new Date(s-1)),r(s,1),e(s),s},a.round=function(s){var c=a(s),p=a.ceil(s);return s-c<p-s?c:p},a.offset=function(s,c){return r(s=new Date(+s),c==null?1:Math.floor(c)),s},a.range=function(s,c,p){var g=[],b;if(s=a.ceil(s),p=p==null?1:Math.floor(p),!(s<c)||!(p>0))return g;do g.push(b=new Date(+s)),r(s,p),e(s);while(b<s&&s<c);return g},a.filter=function(s){return qu(function(c){if(c>=c)for(;e(c),!s(c);)c.setTime(c-1)},function(c,p){if(c>=c)if(p<0)for(;++p<=0;)for(;r(c,-1),!s(c););else for(;--p>=0;)for(;r(c,1),!s(c););})},n&&(a.count=function(s,c){return Hh.setTime(+s),ch.setTime(+c),e(Hh),e(ch),Math.floor(n(Hh,ch))},a.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(i?function(c){return i(c)%s===0}:function(c){return a.count(0,c)%s===0}):a}),a}var Sh=qu(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r)},function(e,r){return r.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Sh.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:qu(function(r){r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},function(r,n){r.setFullYear(r.getFullYear()+n*e)})};var Th=Sh,Am=Sh.range,yp=qu(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,r){e.setMonth(e.getMonth()+r)},function(e,r){return r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),Bv=yp,Fv=yp.range,_p=1e3,fh=6e4,As=36e5,af=864e5,Nv=6048e5;function Rc(e){return qu(function(r){r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},function(r,n){r.setDate(r.getDate()+n*7)},function(r,n){return(n-r-(n.getTimezoneOffset()-r.getTimezoneOffset())*fh)/Nv})}var zd=Rc(0),Zd=Rc(1),bp=Rc(2),Xf=Rc(3),hh=Rc(4),jd=Rc(5),xp=Rc(6),nv=zd.range,Uv=Zd.range,Cm=bp.range,Ep=Xf.range,wm=hh.range,Rm=jd.range,Mm=xp.range,iv=qu(function(e){e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*fh)/af},function(e){return e.getDate()-1}),Sp=iv,zc=iv.range,Vd=qu(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*_p-e.getMinutes()*fh)},function(e,r){e.setTime(+e+r*As)},function(e,r){return(r-e)/As},function(e){return e.getHours()}),zv=Vd,dh=Vd.range,Zv=qu(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*_p)},function(e,r){e.setTime(+e+r*fh)},function(e,r){return(r-e)/fh},function(e){return e.getMinutes()}),jv=Zv,fd=Zv.range,$h=qu(function(e){e.setTime(e-e.getMilliseconds())},function(e,r){e.setTime(+e+r*_p)},function(e,r){return(r-e)/_p},function(e){return e.getUTCSeconds()}),hd=$h,Hd=$h.range,ph=qu(function(){},function(e,r){e.setTime(+e+r)},function(e,r){return r-e});ph.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?qu(function(r){r.setTime(Math.floor(r/e)*e)},function(r,n){r.setTime(+r+n*e)},function(r,n){return(n-r)/e}):ph};var Vv=ph,Im=ph.range;function Ah(e){return qu(function(r){r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCDate(r.getUTCDate()+n*7)},function(r,n){return(n-r)/Nv})}var av=Ah(0),dd=Ah(1),ov=Ah(2),vh=Ah(3),Wh=Ah(4),sv=Ah(5),uv=Ah(6),Om=av.range,Hv=dd.range,Pm=ov.range,Dm=vh.range,$v=Wh.range,km=sv.range,Tp=uv.range,lv=qu(function(e){e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r)},function(e,r){return(r-e)/af},function(e){return e.getUTCDate()-1}),$d=lv,Jm=lv.range,Ap=qu(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r)},function(e,r){return r.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Ap.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:qu(function(r){r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCFullYear(r.getUTCFullYear()+n*e)})};var Wd=Ap,eg=Ap.range;function cv(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function fv(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Gd(e,r,n){return{y:e,m:r,d:n,H:0,M:0,S:0,L:0}}function Lm(e){var r=e.dateTime,n=e.date,i=e.time,a=e.periods,s=e.days,c=e.shortDays,p=e.months,g=e.shortMonths,b=pd(a),w=hv(a),I=pd(s),W=hv(s),pe=pd(c),Me=hv(c),Fe=pd(p),ut=hv(p),Ot=pd(g),Bt=hv(g),ir={a:Mf,A:uf,b:pc,B:Jf,c:null,d:ag,e:ag,f:Ry,g:Ny,G:zy,H:Ay,I:Cy,j:wy,L:og,m:My,M:Iy,p:LS,q:BS,Q:hg,s:dg,S:Oy,u:Py,U:Dy,V:ky,w:Ly,W:By,x:null,X:null,y:Fy,Y:Uy,Z:Zy,"%":fg},xr={a:FS,A:NS,b:US,B:zS,c:null,d:ug,e:ug,f:$y,g:t_,G:n_,H:jy,I:Vy,j:Hy,L:lg,m:Wy,M:Gy,p:ZS,q:jS,Q:hg,s:dg,S:Xy,u:Yy,U:Ky,V:qy,w:Qy,W:Jy,x:null,X:null,y:e_,Y:r_,Z:i_,"%":fg},qr={a:Bi,A:ai,b:ra,B:fa,c:nu,d:ng,e:ng,f:xy,g:rg,G:tg,H:ig,I:ig,j:gy,L:by,m:vy,M:yy,p:ti,q:py,Q:Sy,s:Ty,S:_y,u:ly,U:cy,V:fy,w:uy,W:hy,x:yl,X:_l,y:rg,Y:tg,Z:dy,"%":Ey};ir.x=Ir(n,ir),ir.X=Ir(i,ir),ir.c=Ir(r,ir),xr.x=Ir(n,xr),xr.X=Ir(i,xr),xr.c=Ir(r,xr);function Ir(na,To){return function(Ko){var vi=[],lf=-1,$s=0,If=na.length,Of,rp,sy;for(Ko instanceof Date||(Ko=new Date(+Ko));++lf<If;)na.charCodeAt(lf)===37&&(vi.push(na.slice($s,lf)),(rp=Wv[Of=na.charAt(++lf)])!=null?Of=na.charAt(++lf):rp=Of==="e"?" ":"0",(sy=To[Of])&&(Of=sy(Ko,rp)),vi.push(Of),$s=lf+1);return vi.push(na.slice($s,lf)),vi.join("")}}function mr(na,To){return function(Ko){var vi=Gd(1900,void 0,1),lf=sn(vi,na,Ko+="",0),$s,If;if(lf!=Ko.length)return null;if("Q"in vi)return new Date(vi.Q);if("s"in vi)return new Date(vi.s*1e3+("L"in vi?vi.L:0));if(To&&!("Z"in vi)&&(vi.Z=0),"p"in vi&&(vi.H=vi.H%12+vi.p*12),vi.m===void 0&&(vi.m="q"in vi?vi.q:0),"V"in vi){if(vi.V<1||vi.V>53)return null;"w"in vi||(vi.w=1),"Z"in vi?($s=fv(Gd(vi.y,0,1)),If=$s.getUTCDay(),$s=If>4||If===0?dd.ceil($s):dd($s),$s=$d.offset($s,(vi.V-1)*7),vi.y=$s.getUTCFullYear(),vi.m=$s.getUTCMonth(),vi.d=$s.getUTCDate()+(vi.w+6)%7):($s=cv(Gd(vi.y,0,1)),If=$s.getDay(),$s=If>4||If===0?Zd.ceil($s):Zd($s),$s=Sp.offset($s,(vi.V-1)*7),vi.y=$s.getFullYear(),vi.m=$s.getMonth(),vi.d=$s.getDate()+(vi.w+6)%7)}else("W"in vi||"U"in vi)&&("w"in vi||(vi.w="u"in vi?vi.u%7:"W"in vi?1:0),If="Z"in vi?fv(Gd(vi.y,0,1)).getUTCDay():cv(Gd(vi.y,0,1)).getDay(),vi.m=0,vi.d="W"in vi?(vi.w+6)%7+vi.W*7-(If+5)%7:vi.w+vi.U*7-(If+6)%7);return"Z"in vi?(vi.H+=vi.Z/100|0,vi.M+=vi.Z%100,fv(vi)):cv(vi)}}function sn(na,To,Ko,vi){for(var lf=0,$s=To.length,If=Ko.length,Of,rp;lf<$s;){if(vi>=If)return-1;if(Of=To.charCodeAt(lf++),Of===37){if(Of=To.charAt(lf++),rp=qr[Of in Wv?To.charAt(lf++):Of],!rp||(vi=rp(na,Ko,vi))<0)return-1}else if(Of!=Ko.charCodeAt(vi++))return-1}return vi}function ti(na,To,Ko){var vi=b.exec(To.slice(Ko));return vi?(na.p=w[vi[0].toLowerCase()],Ko+vi[0].length):-1}function Bi(na,To,Ko){var vi=pe.exec(To.slice(Ko));return vi?(na.w=Me[vi[0].toLowerCase()],Ko+vi[0].length):-1}function ai(na,To,Ko){var vi=I.exec(To.slice(Ko));return vi?(na.w=W[vi[0].toLowerCase()],Ko+vi[0].length):-1}function ra(na,To,Ko){var vi=Ot.exec(To.slice(Ko));return vi?(na.m=Bt[vi[0].toLowerCase()],Ko+vi[0].length):-1}function fa(na,To,Ko){var vi=Fe.exec(To.slice(Ko));return vi?(na.m=ut[vi[0].toLowerCase()],Ko+vi[0].length):-1}function nu(na,To,Ko){return sn(na,r,To,Ko)}function yl(na,To,Ko){return sn(na,n,To,Ko)}function _l(na,To,Ko){return sn(na,i,To,Ko)}function Mf(na){return c[na.getDay()]}function uf(na){return s[na.getDay()]}function pc(na){return g[na.getMonth()]}function Jf(na){return p[na.getMonth()]}function LS(na){return a[+(na.getHours()>=12)]}function BS(na){return 1+~~(na.getMonth()/3)}function FS(na){return c[na.getUTCDay()]}function NS(na){return s[na.getUTCDay()]}function US(na){return g[na.getUTCMonth()]}function zS(na){return p[na.getUTCMonth()]}function ZS(na){return a[+(na.getUTCHours()>=12)]}function jS(na){return 1+~~(na.getUTCMonth()/3)}return{format:function(na){var To=Ir(na+="",ir);return To.toString=function(){return na},To},parse:function(na){var To=mr(na+="",!1);return To.toString=function(){return na},To},utcFormat:function(na){var To=Ir(na+="",xr);return To.toString=function(){return na},To},utcParse:function(na){var To=mr(na+="",!0);return To.toString=function(){return na},To}}}var Wv={"-":"",_:" ",0:"0"},vl=/^\s*\d+/,Yf=/^%/,Cp=/[\\^$*+?|[\]().{}]/g;function Po(e,r,n){var i=e<0?"-":"",a=(i?-e:e)+"",s=a.length;return i+(s<n?new Array(n-s+1).join(r)+a:a)}function Xd(e){return e.replace(Cp,"\\$&")}function pd(e){return new RegExp("^(?:"+e.map(Xd).join("|")+")","i")}function hv(e){for(var r={},n=-1,i=e.length;++n<i;)r[e[n].toLowerCase()]=n;return r}function uy(e,r,n){var i=vl.exec(r.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function ly(e,r,n){var i=vl.exec(r.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function cy(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function fy(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function hy(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function tg(e,r,n){var i=vl.exec(r.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function rg(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function dy(e,r,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function py(e,r,n){var i=vl.exec(r.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function vy(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function ng(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function gy(e,r,n){var i=vl.exec(r.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function ig(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function yy(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function _y(e,r,n){var i=vl.exec(r.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function by(e,r,n){var i=vl.exec(r.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function xy(e,r,n){var i=vl.exec(r.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Ey(e,r,n){var i=Yf.exec(r.slice(n,n+1));return i?n+i[0].length:-1}function Sy(e,r,n){var i=vl.exec(r.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Ty(e,r,n){var i=vl.exec(r.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function ag(e,r){return Po(e.getDate(),r,2)}function Ay(e,r){return Po(e.getHours(),r,2)}function Cy(e,r){return Po(e.getHours()%12||12,r,2)}function wy(e,r){return Po(1+Sp.count(Th(e),e),r,3)}function og(e,r){return Po(e.getMilliseconds(),r,3)}function Ry(e,r){return og(e,r)+"000"}function My(e,r){return Po(e.getMonth()+1,r,2)}function Iy(e,r){return Po(e.getMinutes(),r,2)}function Oy(e,r){return Po(e.getSeconds(),r,2)}function Py(e){var r=e.getDay();return r===0?7:r}function Dy(e,r){return Po(zd.count(Th(e)-1,e),r,2)}function sg(e){var r=e.getDay();return r>=4||r===0?hh(e):hh.ceil(e)}function ky(e,r){return e=sg(e),Po(hh.count(Th(e),e)+(Th(e).getDay()===4),r,2)}function Ly(e){return e.getDay()}function By(e,r){return Po(Zd.count(Th(e)-1,e),r,2)}function Fy(e,r){return Po(e.getFullYear()%100,r,2)}function Ny(e,r){return e=sg(e),Po(e.getFullYear()%100,r,2)}function Uy(e,r){return Po(e.getFullYear()%1e4,r,4)}function zy(e,r){var n=e.getDay();return e=n>=4||n===0?hh(e):hh.ceil(e),Po(e.getFullYear()%1e4,r,4)}function Zy(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+Po(r/60|0,"0",2)+Po(r%60,"0",2)}function ug(e,r){return Po(e.getUTCDate(),r,2)}function jy(e,r){return Po(e.getUTCHours(),r,2)}function Vy(e,r){return Po(e.getUTCHours()%12||12,r,2)}function Hy(e,r){return Po(1+$d.count(Wd(e),e),r,3)}function lg(e,r){return Po(e.getUTCMilliseconds(),r,3)}function $y(e,r){return lg(e,r)+"000"}function Wy(e,r){return Po(e.getUTCMonth()+1,r,2)}function Gy(e,r){return Po(e.getUTCMinutes(),r,2)}function Xy(e,r){return Po(e.getUTCSeconds(),r,2)}function Yy(e){var r=e.getUTCDay();return r===0?7:r}function Ky(e,r){return Po(av.count(Wd(e)-1,e),r,2)}function cg(e){var r=e.getUTCDay();return r>=4||r===0?Wh(e):Wh.ceil(e)}function qy(e,r){return e=cg(e),Po(Wh.count(Wd(e),e)+(Wd(e).getUTCDay()===4),r,2)}function Qy(e){return e.getUTCDay()}function Jy(e,r){return Po(dd.count(Wd(e)-1,e),r,2)}function e_(e,r){return Po(e.getUTCFullYear()%100,r,2)}function t_(e,r){return e=cg(e),Po(e.getUTCFullYear()%100,r,2)}function r_(e,r){return Po(e.getUTCFullYear()%1e4,r,4)}function n_(e,r){var n=e.getUTCDay();return e=n>=4||n===0?Wh(e):Wh.ceil(e),Po(e.getUTCFullYear()%1e4,r,4)}function i_(){return"+0000"}function fg(){return"%"}function hg(e){return+e}function dg(e){return Math.floor(+e/1e3)}var wp,pg,a_,o_,s_;u_({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function u_(e){return wp=Lm(e),pg=wp.format,a_=wp.parse,o_=wp.utcFormat,s_=wp.utcParse,wp}var dv=1e3,pv=dv*60,vv=pv*60,mv=vv*24,l_=mv*7,vg=mv*30,Bm=mv*365;function c_(e){return new Date(e)}function f_(e){return e instanceof Date?+e:+new Date(+e)}function mg(e,r,n,i,a,s,c,p,g){var b=hs(Ji,Ji),w=b.invert,I=b.domain,W=g(".%L"),pe=g(":%S"),Me=g("%I:%M"),Fe=g("%I %p"),ut=g("%a %d"),Ot=g("%b %d"),Bt=g("%B"),ir=g("%Y"),xr=[[c,1,dv],[c,5,5*dv],[c,15,15*dv],[c,30,30*dv],[s,1,pv],[s,5,5*pv],[s,15,15*pv],[s,30,30*pv],[a,1,vv],[a,3,3*vv],[a,6,6*vv],[a,12,12*vv],[i,1,mv],[i,2,2*mv],[n,1,l_],[r,1,vg],[r,3,3*vg],[e,1,Bm]];function qr(mr){return(c(mr)<mr?W:s(mr)<mr?pe:a(mr)<mr?Me:i(mr)<mr?Fe:r(mr)<mr?n(mr)<mr?ut:Ot:e(mr)<mr?Bt:ir)(mr)}function Ir(mr,sn,ti,Bi){if(mr==null&&(mr=10),typeof mr=="number"){var ai=Math.abs(ti-sn)/mr,ra=Fh(function(fa){return fa[2]}).right(xr,ai);ra===xr.length?(Bi=Nh(sn/Bm,ti/Bm,mr),mr=e):ra?(ra=xr[ai/xr[ra-1][2]<xr[ra][2]/ai?ra-1:ra],Bi=ra[1],mr=ra[0]):(Bi=Math.max(Nh(sn,ti,mr),1),mr=p)}return Bi==null?mr:mr.every(Bi)}return b.invert=function(mr){return new Date(w(mr))},b.domain=function(mr){return arguments.length?I(A.call(mr,f_)):I().map(c_)},b.ticks=function(mr,sn){var ti=I(),Bi=ti[0],ai=ti[ti.length-1],ra=ai<Bi,fa;return ra&&(fa=Bi,Bi=ai,ai=fa),fa=Ir(mr,Bi,ai,sn),fa=fa?fa.range(Bi,ai+1):[],ra?fa.reverse():fa},b.tickFormat=function(mr,sn){return sn==null?qr:g(sn)},b.nice=function(mr,sn){var ti=I();return(mr=Ir(mr,ti[0],ti[ti.length-1],sn))?I(Gf(ti,mr)):b},b.copy=function(){return Bo(b,mg(e,r,n,i,a,s,c,p,g))},b}function h_(){return te.apply(mg(Th,Bv,zd,Sp,zv,jv,hd,Vv,pg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function VS(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Gv(){var e=0,r=1,n,i,a,s,c=Ji,p=!1,g;function b(w){return isNaN(w=+w)?g:c(a===0?.5:(w=(s(w)-n)*a,p?Math.max(0,Math.min(1,w)):w))}return b.domain=function(w){return arguments.length?(n=s(e=+w[0]),i=s(r=+w[1]),a=n===i?0:1/(i-n),b):[e,r]},b.clamp=function(w){return arguments.length?(p=!!w,b):p},b.interpolator=function(w){return arguments.length?(c=w,b):c},b.unknown=function(w){return arguments.length?(g=w,b):g},function(w){return s=w,n=w(e),i=w(r),a=n===i?0:1/(i-n),b}}function gv(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function gg(){var e=Wf(Gv()(Ji));return e.copy=function(){return gv(e,gg())},_e.apply(e,arguments)}function d_(){var e=loggish(Gv()).domain([1,10]);return e.copy=function(){return gv(e,d_()).base(e.base())},initInterpolator.apply(e,arguments)}function p_(){var e=symlogish(Gv());return e.copy=function(){return gv(e,p_()).constant(e.constant())},initInterpolator.apply(e,arguments)}function yg(){var e=powish(Gv());return e.copy=function(){return gv(e,yg()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function HS(){return yg.apply(null,arguments).exponent(.5)}function v_(){var e=[],r=identity;function n(i){if(!isNaN(i=+i))return r((bisect(e,i)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(var a=0,s=i.length,c;a<s;++a)c=i[a],c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ascending),n},n.interpolator=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return v_(r).domain(e)},initInterpolator.apply(n,arguments)}function Xv(){var e=0,r=.5,n=1,i,a,s,c,p,g=Ji,b,w=!1,I;function W(pe){return isNaN(pe=+pe)?I:(pe=.5+((pe=+b(pe))-a)*(pe<a?c:p),g(w?Math.max(0,Math.min(1,pe)):pe))}return W.domain=function(pe){return arguments.length?(i=b(e=+pe[0]),a=b(r=+pe[1]),s=b(n=+pe[2]),c=i===a?0:.5/(a-i),p=a===s?0:.5/(s-a),W):[e,r,n]},W.clamp=function(pe){return arguments.length?(w=!!pe,W):w},W.interpolator=function(pe){return arguments.length?(g=pe,W):g},W.unknown=function(pe){return arguments.length?(I=pe,W):I},function(pe){return b=pe,i=pe(e),a=pe(r),s=pe(n),c=i===a?0:.5/(a-i),p=a===s?0:.5/(s-a),W}}function _g(){var e=Wf(Xv()(Ji));return e.copy=function(){return gv(e,_g())},_e.apply(e,arguments)}function m_(){var e=loggish(Xv()).domain([.1,1,10]);return e.copy=function(){return copy(e,m_()).base(e.base())},initInterpolator.apply(e,arguments)}function g_(){var e=symlogish(Xv());return e.copy=function(){return copy(e,g_()).constant(e.constant())},initInterpolator.apply(e,arguments)}function bg(){var e=powish(Xv());return e.copy=function(){return copy(e,bg()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function $S(){return bg.apply(null,arguments).exponent(.5)}function xg(e){var r,n=[];function i(a){return a==null?r:a}return i.invert=i,i.domain=i.range=function(a){return a?(n=a,a):n},i.unknown=function(a){return a?(r=a,a):r},i.copy=function(){return xg(e).unknown(r)},i}var wf,Eg,Sg,Fm=ze.rU.isNil,y_=ze.rU.isString,__=ze.rU.uniq,b_=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,x_=(wf={},(0,G.Z)(wf,$.vY.LINEAR,Eh),(0,G.Z)(wf,$.vY.POWER,Zh),(0,G.Z)(wf,$.vY.LOG,lh),(0,G.Z)(wf,$.vY.IDENTITY,xg),(0,G.Z)(wf,$.vY.SEQUENTIAL,gg),(0,G.Z)(wf,$.vY.TIME,h_),(0,G.Z)(wf,$.vY.QUANTILE,jh),(0,G.Z)(wf,$.vY.QUANTIZE,Ud),(0,G.Z)(wf,$.vY.THRESHOLD,Vh),(0,G.Z)(wf,$.vY.CAT,Ie),(0,G.Z)(wf,$.vY.DIVERGING,_g),wf),E_=(Eg=(0,ta.b2)(),Eg(Sg=function(){function e(){(0,Ge.Z)(this,e),(0,G.Z)(this,"scaleOptions",{})}return(0,We.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("FeatureScalePlugin",(0,He.Z)(Ne().mark(function c(){var p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(n.log($.Or.ScaleInitStart,$.KD.INIT),a.scaleOptions=n.getScaleOptions(),g=s.getLayerStyleAttributes(),b=(p=n.getSource())===null||p===void 0?void 0:p.data.dataArray,!(Array.isArray(b)&&b.length===0)){I.next=8;break}return I.abrupt("return");case 8:a.caculateScalesForAttributes(g||[],b);case 9:n.log($.Or.ScaleInitEnd,$.KD.INIT);case 10:case"end":return I.stop()}},c)}))),n.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var c=(0,He.Z)(Ne().mark(function p(g){var b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(g){W.next=2;break}return W.abrupt("return",g);case 2:if(n.log($.Or.ScaleInitStart,$.KD.UPDATE),a.scaleOptions=n.getScaleOptions(),b=s.getLayerStyleAttributes(),w=n.getSource().data.dataArray,!(Array.isArray(w)&&w.length===0)){W.next=8;break}return W.abrupt("return",!0);case 8:return a.caculateScalesForAttributes(b||[],w),n.log($.Or.ScaleInitEnd,$.KD.UPDATE),n.layerModelNeedUpdate=!0,W.abrupt("return",!0);case 12:case"end":return W.stop()}},p)}));return function(p){return c.apply(this,arguments)}}()),n.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!n.layerModelNeedUpdate){a.scaleOptions=n.getScaleOptions();var c=s.getLayerStyleAttributes(),p=n.getSource().data.dataArray;if(!(Array.isArray(p)&&p.length===0)&&c){var g=c.filter(function(b){return b.needRescale});g.length&&a.caculateScalesForAttributes(g,p)}}})}},{key:"isNumber",value:function(n){return!isNaN(parseFloat(n))&&isFinite(n)}},{key:"caculateScalesForAttributes",value:function(n,i){var a=this;n.forEach(function(s){if(s.scale){var c=s.scale,p=s.scale.field;c.names=a.parseFields(Fm(p)?[]:p);var g=[];c.names.forEach(function(b){var w;g.push(a.createScale(b,s.name,(w=s.scale)===null||w===void 0?void 0:w.values,i))}),g.some(function(b){return b.type===$.ee.VARIABLE})?(c.type=$.ee.VARIABLE,g.forEach(function(b){if(!c.callback&&c.values!=="text"){var w;switch((w=b.option)===null||w===void 0?void 0:w.type){case $.vY.LOG:case $.vY.LINEAR:case $.vY.POWER:if(c.values&&c.values.length>2){var I=b.scale.ticks(c.values.length);b.scale.domain(I)}c.values?b.scale.range(c.values):b.scale.range(b.option.domain);break;case $.vY.QUANTILE:case $.vY.QUANTIZE:case $.vY.THRESHOLD:b.scale.range(c.values);break;case $.vY.IDENTITY:break;case $.vY.CAT:c.values?b.scale.range(c.values):b.scale.range(b.option.domain);break;case $.vY.DIVERGING:case $.vY.SEQUENTIAL:b.scale.interpolator(fp(c.values));break}}if(c.values==="text"){var W;b.scale.range((W=b.option)===null||W===void 0?void 0:W.domain)}})):(c.type=$.ee.CONSTANT,c.defaultValues=g.map(function(b,w){return b.scale(c.names[w])})),c.scalers=g.map(function(b){return{field:b.field,func:b.scale,option:b.option}}),s.needRescale=!1}})}},{key:"parseFields",value:function(n){return Array.isArray(n)?n:y_(n)?n.split("*"):[n]}},{key:"createScale",value:function(n,i,a,s){var c,p,g=this.scaleOptions[i]&&((c=this.scaleOptions[i])===null||c===void 0?void 0:c.field)===n?this.scaleOptions[i]:this.scaleOptions[n],b={field:n,scale:void 0,type:$.ee.VARIABLE,option:g};if(!s||!s.length)return g&&g.type?b.scale=this.createDefaultScale(g):(b.scale=Ie([n]),b.type=$.ee.CONSTANT),b;var w=(p=s.find(function(pe){return!Fm(pe[n])}))===null||p===void 0?void 0:p[n];if(this.isNumber(n)||Fm(w)&&!g)b.scale=Ie([n]),b.type=$.ee.CONSTANT;else{var I=g&&g.type||this.getDefaultType(w);a==="text"&&(I=$.vY.CAT),a===void 0&&(I=$.vY.IDENTITY);var W=this.createScaleConfig(I,n,g,s);b.scale=this.createDefaultScale(W),b.option=W}return b}},{key:"getDefaultType",value:function(n){var i=$.vY.LINEAR;return typeof n=="string"&&(i=b_.test(n)?$.vY.TIME:$.vY.CAT),i}},{key:"createScaleConfig",value:function(n,i,a,s){var c={type:n},p=[];if(n===$.vY.QUANTILE){var g=new Map;s==null||s.forEach(function(I){g.set(I._id,I[i])}),p=Array.from(g.values())}else p=(s==null?void 0:s.map(function(I){return I[i]}))||[];if(a!=null&&a.domain)c.domain=a==null?void 0:a.domain;else if(n===$.vY.CAT||n===$.vY.IDENTITY)c.domain=__(p);else if(n===$.vY.QUANTILE)c.domain=p;else if(n===$.vY.DIVERGING){var b=Jt(p),w=(a==null?void 0:a.neutral)!==void 0?a==null?void 0:a.neutral:(b[0]+b[1])/2;c.domain=[b[0],w,b[1]]}else c.domain=Jt(p);return(0,fe.Z)((0,fe.Z)({},c),a)}},{key:"createDefaultScale",value:function(n){var i=n.type,a=n.domain,s=n.unknown,c=n.clamp,p=n.nice,g=x_[i]();return a&&g.domain&&g.domain(a),s&&g.unknown(s),c!==void 0&&g.clamp&&g.clamp(c),p!==void 0&&g.nice&&g.nice(p),g}}]),e}())||Sg),Tg,Ag,S_=(Tg=(0,ta.b2)(),Tg(Ag=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n){n.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var i=n.animateStatus;i&&n.models.forEach(function(a){a.addUniforms((0,fe.Z)({},n.layerModel.getAnimateUniforms()))})})}}]),e}())||Ag),Cg,wg,T_=(Cg=(0,ta.b2)(),Cg(wg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n){n.hooks.afterInit.tap("LayerMaskPlugin",function(){var i=n.getLayerConfig(),a=i.maskLayers,s=i.enableMask;if(!n.tileLayer&&a&&a.length>0){var c;(c=n.masks).push.apply(c,(0,jr.Z)(a)),n.updateLayerConfig({mask:s})}})}}]),e}())||wg),A_=function(){function e(r){var n=r.rendererService,i=r.layerService,a=r.parent;(0,Ge.Z)(this,e),(0,G.Z)(this,"tileResource",new Map),(0,G.Z)(this,"layerTiles",[]),this.rendererService=n,this.layerService=i,this.parent=a}return(0,We.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(n){return this.layerTiles.some(function(i){return i.key===n})}},{key:"addTile",value:function(n){this.layerTiles.push(n)}},{key:"getTile",value:function(n){return this.layerTiles.find(function(i){return i.key===n})}},{key:"getVisibleTileBylngLat",value:function(n){return this.layerTiles.find(function(i){return i.isLoaded&&i.visible&&i.lnglatInBounds(n)})}},{key:"removeTile",value:function(n){var i=this.layerTiles.findIndex(function(s){return s.key===n}),a=this.layerTiles.splice(i,1);a[0]&&a[0].destroy()}},{key:"updateTileVisible",value:function(n){var i=this.getTile(n.key);if(n.isVisible)if(n.parent){var a=this.isChildrenLoaded(n.parent);i==null||i.updateVisible(a)}else i==null||i.updateVisible(!0);else if(n.parent){var s=this.isChildrenLoaded(n.parent);i==null||i.updateVisible(!s)}else i==null||i.updateVisible(!1)}},{key:"isParentLoaded",value:function(n){var i=n.parent;if(!i)return!0;var a=this.getTile(i==null?void 0:i.key);return!!(a!=null&&a.isLoaded)}},{key:"isChildrenLoaded",value:function(n){var i=this,a=n==null?void 0:n.children;return a.length===0?!0:a.every(function(s){var c=i.getTile(s==null?void 0:s.key);return c?(c==null?void 0:c.isLoaded)===!0:!0})}},{key:"render",value:function(){var r=(0,He.Z)(Ne().mark(function i(){var a=this,s,c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return s=this.getRenderLayers(),c=s.map(function(){var b=(0,He.Z)(Ne().mark(function w(I){return Ne().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,a.layerService.renderTileLayer(I);case 2:case"end":return pe.stop()}},w)}));return function(w){return b.apply(this,arguments)}}()),g.next=4,Promise.all(c);case 4:case"end":return g.stop()}},i,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"getRenderLayers",value:function(){var n=this.layerTiles.filter(function(a){return a.visible&&a.isLoaded}),i=[];return n.map(function(a){return i.push.apply(i,(0,jr.Z)(a.getLayers()))}),i}},{key:"getLayers",value:function(){var n=this.layerTiles.filter(function(a){return a.isLoaded}),i=[];return n.map(function(a){return i.push.apply(i,(0,jr.Z)(a.getLayers()))}),i}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(n){return n.destroy()}),this.tileResource.clear()}}]),e}(),C_=_(32676);function w_(e,r,n){n===void 0&&(n={});var i=at(e),a=at(r),s=C_.union(i.coordinates,a.coordinates);return s.length===0?null:s.length===1?(0,Et.yu)(s[0],n.properties):(0,Et.tw)(s,n.properties)}var R_=w_,M_=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"getCombineFeature",value:function(n){var i=null,a=n[0];return n.map(function(s){var c=Et.yu(s.coordinates);i===null?i=c:i=R_(i,c)}),a&&(i.properties=(0,fe.Z)({},a)),i}}]),e}(),yv="select",_v="active",I_=function(){function e(r){var n=r.layerService,i=r.tileLayerService,a=r.parent;(0,Ge.Z)(this,e),(0,G.Z)(this,"tilePickID",new Map),this.layerService=n,this.tileLayerService=i,this.parent=a,this.tileSourceService=new M_}return(0,We.Z)(e,[{key:"pickRender",value:function(n){var i=this.tileLayerService.getVisibleTileBylngLat(n.lngLat);if(i){var a=i.getMainLayer();a==null||a.layerPickService.pickRender(n)}}},{key:"pick",value:function(){var r=(0,He.Z)(Ne().mark(function i(a,s){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(c=this.parent.getContainer(),p=c.get($.vK.IPickingService),a.type!=="RasterLayer"){I.next=8;break}if(g=this.tileLayerService.getVisibleTileBylngLat(s.lngLat),!(g&&g.getMainLayer()!==void 0)){I.next=7;break}return b=g.getMainLayer(),I.abrupt("return",b.layerPickService.pickRasterLayer(b,s,this.parent));case 7:return I.abrupt("return",!1);case 8:return this.pickRender(s),I.abrupt("return",p.pickFromPickingFBO(a,s));case 10:case"end":return I.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"selectFeature",value:function(n){var i=(0,Fi.Z)(n,3),a=i[0],s=i[1],c=i[2],p=this.color2PickId(a,s,c);this.tilePickID.set(yv,p),this.updateHighLight(a,s,c,yv)}},{key:"highlightPickedFeature",value:function(n){var i=(0,Fi.Z)(n,3),a=i[0],s=i[1],c=i[2],p=this.color2PickId(a,s,c);this.tilePickID.set(_v,p),this.updateHighLight(a,s,c,_v)}},{key:"updateHighLight",value:function(n,i,a,s){this.tileLayerService.tiles.map(function(c){var p=c.getMainLayer();switch(s){case yv:p==null||p.hooks.beforeSelect.call([n,i,a]);break;case _v:p==null||p.hooks.beforeHighlight.call([n,i,a]);break}})}},{key:"setPickState",value:function(){var n=this.tilePickID.get(yv),i=this.tilePickID.get(_v);if(n){var a=this.pickId2Color(n),s=(0,Fi.Z)(a,3),c=s[0],p=s[1],g=s[2];this.updateHighLight(c,p,g,yv);return}if(i){var b=this.pickId2Color(i),w=(0,Fi.Z)(b,3),I=w[0],W=w[1],pe=w[2];this.updateHighLight(I,W,pe,_v);return}}},{key:"color2PickId",value:function(n,i,a){return(0,ze.W0)(new Uint8Array([n,i,a]))}},{key:"pickId2Color",value:function(n){return(0,ze.Z6)(n)}},{key:"getFeatureById",value:function(n){var i=this.tileLayerService.getTiles().filter(function(s){return s.visible}),a=[];return i.forEach(function(s){a.push.apply(a,(0,jr.Z)(s.getFeatureById(n)))}),a}},{key:"pickRasterLayer",value:function(n,i,a){return!1}}]),e}();function O_(e){var r=P_();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function P_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var D_=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,k_=`
layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);
  
  vec2 offset = project_pixel(u_offsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }
  
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Rg(e){var r=e.coordinates;return{vertices:(0,jr.Z)(r),indices:[0],size:r.length}}var L_=function(e){(0,Ai.Z)(n,e);var r=O_(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,c=a.strokeOpacity,p=c===void 0?1:c,g=a.strokeWidth,b=g===void 0?0:g,w=a.stroke,I=w===void 0?"#fff":w,W={u_stroke_color:(0,ze.CI)(I),u_additive:s==="additive"?1:0,u_stroke_opacity:p,u_stroke_width:b},pe=this.getUniformsBufferInfo(W);return pe}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=Rg,this.initUniformsBuffer(),g.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:k_,fragmentShader:D_,inject:this.getInject(),triangulation:Rg,depth:{enable:!1},primitive:$.gl.POINTS});case 4:return c=g.sent,g.abrupt("return",[c]);case 6:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(s){var c=s.size,p=c===void 0?1:c;return Array.isArray(p)?[p[0]]:[p]}}})}}]),n}(ao);function B_(e){var r=F_();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function F_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var N_=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,U_=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in vec3 a_Size;
layout(location = 11) in vec3 a_Pos;
layout(location = 13) in vec3 a_Normal;


layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     v_color = a_Color;
  }
  v_color.a *= u_opacity;

    
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,z_=ze.rU.isNumber,Z_=function(e){(0,Ai.Z)(n,e);var r=B_(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"raiseCount",0),(0,G.Z)((0,gn.Z)(i),"raiseRepeat",0),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption,c=s===void 0?{enable:!1,speed:.01,repeat:!1}:s,p=a.opacity,g=p===void 0?1:p,b=a.sourceColor,w=a.targetColor,I=a.pickLight,W=I===void 0?!1:I,pe=a.heightfixed,Me=pe===void 0?!0:pe,Fe=a.opacityLinear,ut=Fe===void 0?{enable:!1,dir:"up"}:Fe,Ot=a.lightEnable,Bt=Ot===void 0?!0:Ot,ir=0,xr=[0,0,0,0],qr=[0,0,0,0];if(b&&w&&(xr=(0,ze.CI)(b),qr=(0,ze.CI)(w),ir=1),this.raiseCount<1&&this.raiseRepeat>0&&c.enable){var Ir=c.speed,mr=Ir===void 0?.01:Ir;this.raiseCount+=mr,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}var sn={u_sourceColor:xr,u_targetColor:qr,u_linearColor:ir,u_pickLight:Number(W),u_heightfixed:Number(Me),u_r:c.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:z_(g)?g:1,u_opacitylinear:Number(ut.enable),u_opacitylinear_dir:ut.dir==="up"?1:0,u_lightEnable:Number(Bt)},ti=this.getUniformsBufferInfo(sn);return ti}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),p.abrupt("return",this.buildModels());case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.layer.getLayerConfig(),p=c.animateOption.repeat,g=p===void 0?1:p,this.raiseRepeat=g,I.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:U_,fragmentShader:N_,triangulation:St,depth:{enable:!0},inject:this.getInject(),cull:{enable:!0,face:(0,ze.fj)(this.mapService.version)},blend:this.getBlend()});case 4:return b=I.sent,I.abrupt("return",[b]);case 6:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s){var c=s.size;if(c){var p=[];return Array.isArray(c)&&(p=c.length===2?[c[0],c[0],c[1]]:c),Array.isArray(c)||(p=[c,c,c]),p}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:$.GC.Attribute,descriptor:{name:"a_Normal",shaderLocation:rn.NORMAL,buffer:{usage:$.gl.STATIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s,c,p,g,b){return b}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:$.GC.Attribute,descriptor:{name:"a_Pos",shaderLocation:15,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s){var c=(0,ze.SI)(s.coordinates);return Kc([c[0],c[1]])}}})}}]),n}(ao);function j_(e){var r=V_();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function V_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H_=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,$_=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 10) in float a_Shape;
layout(location = 11) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}`,W_=function(e){(0,Ai.Z)(n,e);var r=j_(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.strokeOpacity,c=s===void 0?1:s,p=a.strokeWidth,g=p===void 0?0:p,b=a.blend,w=a.blur,I=w===void 0?0:w;this.layer.getLayerConfig();var W={u_additive:b==="additive"?1:0,u_stroke_opacity:c,u_stroke_width:g,u_blur:I},pe=this.getUniformsBufferInfo(W);return pe}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.initUniformsBuffer(),p.abrupt("return",this.buildModels());case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.layer.triangulation=Xt,g.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:$_,fragmentShader:H_,triangulation:Xt,inject:this.getInject(),depth:{enable:!0},blend:this.getBlend()});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.speed||1,a.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:$.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:rn.EXTRUDE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(c,p,g,b){var w=(0,Fi.Z)(g,3),I=w[0],W=w[1],pe=w[2],Me=Ra.fromValues(0,0,1),Fe=Ra.fromValues(I,0,pe),ut=I>=0?Ra.angle(Me,Fe):Math.PI*2-Ra.angle(Me,Fe),Ot=Math.PI*2-Math.asin(W/100),Bt=Cc.create();Cc.rotateY(Bt,Bt,ut),Cc.rotateX(Bt,Bt,Ot);var ir=Ra.fromValues(1,1,0);Ra.transformMat4(ir,ir,Bt),Ra.normalize(ir,ir);var xr=Ra.fromValues(-1,1,0);Ra.transformMat4(xr,xr,Bt),Ra.normalize(xr,xr);var qr=Ra.fromValues(-1,-1,0);Ra.transformMat4(qr,qr,Bt),Ra.normalize(qr,qr);var Ir=Ra.fromValues(1,-1,0);Ra.transformMat4(Ir,Ir,Bt),Ra.normalize(Ir,Ir);var mr=[].concat((0,jr.Z)(ir),(0,jr.Z)(xr),(0,jr.Z)(qr),(0,jr.Z)(Ir)),sn=b%4*3;return[mr[sn],mr[sn+1],mr[sn+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?5:p;return Array.isArray(g)?[g[0]]:[g]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:$.GC.Attribute,descriptor:{name:"a_Shape",shaderLocation:rn.SHAPE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.shape,g=p===void 0?2:p,b=a.layer.getLayerConfig().shape2d,w=b.indexOf(g);return[w]}}})}}]),n}(ao);function G_(e){var r=X_();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function X_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Y_=`in vec2 v_uv;// \u672C\u8EAB\u7684 uv \u5750\u6807
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,K_=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 11) in vec3 a_Extrude;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;


#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  
  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (extrude.xy * (newSize) + offsets);

  offset = rotate_matrix(offset,rotation);

  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,q_=function(e){(0,Ai.Z)(n,e);var r=G_(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"meter2coord",1),(0,G.Z)((0,gn.Z)(i),"isMeter",!1),(0,G.Z)((0,gn.Z)(i),"radian",0),(0,G.Z)((0,gn.Z)(i),"updateTexture",function(){var p=i.rendererService.createTexture2D;if(i.texture){i.texture.update({data:i.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),i.layerService.throttleRenderLayers();return}i.texture=p({data:i.iconService.getCanvas(),mag:$.gl.LINEAR,min:$.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:i.iconService.canvasHeight||128,mipmap:!0}),i.textures=[i.texture]}),i}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.raisingHeight,c=s===void 0?0:s,p=a.heightfixed,g=p===void 0?!1:p,b=a.unit,w=b===void 0?"pixel":b;this.rendererService.getDirty()&&this.texture.bind();var I={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(g),u_raisingHeight:Number(c),u_size_unit:Zf[w]},W=this.getUniformsBufferInfo(I);return W}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Ct)}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),p.abrupt("return",this.buildModels());case 3:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:K_,fragmentShader:Y_,triangulation:Ct,depth:{enable:!1},inject:this.getInject(),cull:{enable:!0,face:(0,ze.fj)(this.mapService.version)}});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;this.iconService.off("imageUpdate",this.updateTexture),(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var a=this;this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(c){var p=a.iconService.getIconMap(),g=c.shape,b=p[g]||{x:-64,y:-64},w=b.x,I=b.y;return[w,I]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:$.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:rn.EXTRUDE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(c,p,g,b){var w=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],I=b%4*3;return[w[I],w[I+1],w[I+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{name:"a_Size",shaderLocation:rn.SIZE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(c){var p=c.size,g=p===void 0?5:p;return Array.isArray(g)?[g[0]]:[g]}}})}}]),n}(ao);function Q_(e){var r=J_();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function J_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var e1=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,t1=`layout(location = 0) in vec3 a_Position;
layout(location = 1) in vec4 a_Color;
layout(location = 9) in float a_Size;
layout(location = 11) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
  offset = project_pixel(offset);
  
  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`,r1=function(e){(0,Ai.Z)(n,e);var r=Q_(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,c=a.speed,p=c===void 0?1:c,g=a.unit,b=g===void 0?"pixel":g,w={u_additive:s==="additive"?1:0,u_size_unit:Zf[b],u_speed:p,u_time:this.layer.getLayerAnimateTime()},I=this.getUniformsBufferInfo(w);return I}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Ct)}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:t1,fragmentShader:e1,triangulation:Ct,inject:this.getInject(),depth:{enable:!1}});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.speed||1,a.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:$.GC.Attribute,descriptor:{name:"a_Extrude",shaderLocation:rn.EXTRUDE,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:3,update:function(s,c,p,g){var b=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],w=g%4*3;return[b[w],b[w+1],b[w+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:$.GC.Attribute,descriptor:{shaderLocation:rn.SIZE,name:"a_Size",buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(s){var c=s.size,p=c===void 0?5:c;return Array.isArray(p)?[p[0]]:[p]}}})}}]),n}(ao),n1={fillImage:q_,fill:ts,radar:r1,image:Kl,normal:rd,simplePoint:L_,extrude:Eo,text:Rd,earthFill:W_,earthExtrude:Z_},i1=n1;function a1(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o1(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function o1(e,r){if(e){if(typeof e=="string")return Mg(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mg(e,r)}}function Mg(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function s1(e){var r=u1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function u1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Nm=function(e){(0,Ai.Z)(n,e);var r=s1(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"type","PointLayer"),(0,G.Z)((0,gn.Z)(i),"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),(0,G.Z)((0,gn.Z)(i),"enableDataEncodeStyles",["textOffset","textAnchor"]),(0,G.Z)((0,gn.Z)(i),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),i}return(0,We.Z)(n,[{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new i1[c](this),g.next=5,this.initLayerModels();case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"rebuildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.buildModels();case 2:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var a=this.shapeOption,s=a.field,c=a.values,p=this.getLayerConfig(),g=p.shape2d,b=this.iconService.getIconMap();if(s&&(g==null?void 0:g.indexOf(s))!==-1)return"fill";if(c==="text")return"text";if(c&&c instanceof Array){var w=a1(c),I;try{for(w.s();!(I=w.n()).done;){var W=I.value;if(typeof W=="string"&&b.hasOwnProperty(W))return"image"}}catch(pe){w.e(pe)}finally{w.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return s[a]}},{key:"getModelType",value:function(){var a=this.getEncodedData(),s=this.getLayerConfig(),c=s.shape2d,p=s.shape3d,g=s.billboard,b=g===void 0?!0:g,w=this.iconService.getIconMap(),I=a.find(function(pe){return pe.hasOwnProperty("shape")});if(I){var W=I.shape;return W==="dot"?"normal":W==="simple"?"simplePoint":W==="radar"?"radar":this.layerType==="fillImage"||b===!1?"fillImage":(c==null?void 0:c.indexOf(W))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(p==null?void 0:p.indexOf(W))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":w.hasOwnProperty(W)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),n}(es);function l1(e){return e==="PolygonLayer"?ba:e==="LineLayer"?Ei:Nm}function c1(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}function f1(e){var r=h1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function h1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yd=function(e){(0,Ai.Z)(n,e);var r=f1(n);function n(i,a){var s;return(0,Ge.Z)(this,n),s=r.call(this),(0,G.Z)((0,gn.Z)(s),"visible",!0),(0,G.Z)((0,gn.Z)(s),"layers",[]),(0,G.Z)((0,gn.Z)(s),"isLoaded",!1),(0,G.Z)((0,gn.Z)(s),"tileMaskLayers",[]),s.parent=a,s.sourceTile=i,s.x=i.x,s.y=i.y,s.z=i.z,s.key="".concat(s.x,"_").concat(s.y,"_").concat(s.z),s}return(0,We.Z)(n,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(a){var s=(0,Fi.Z)(this.sourceTile.bounds,4),c=s[0],p=s[1],g=s[2],b=s[3],w=a.lng,I=a.lat;return w>=c&&w<=g&&I>=p&&I<=b}},{key:"getLayerOptions",value:function(){var a,s=this.parent.getLayerConfig();return(0,fe.Z)((0,fe.Z)({},s),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:c1(this.parent.type),mask:s.mask||((a=s.maskLayers)===null||a===void 0?void 0:a.length)!==0&&s.enableMask})}},{key:"getMaskLayer",value:function(){var a=this,s=this.parent.getLayerConfig(),c=s.maskLayers,p=[];return c==null||c.forEach(function(g){if(!g.tileLayer)return p.push(g),g;var b=g.tileLayer,w=b.getTile(a.sourceTile.key),I=w==null?void 0:w.getLayers()[0];I&&p.push(I)}),p}},{key:"addTileMask",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g;return Ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=new ba({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),p=(0,$.e7)(this.parent.sceneContainer),c.setContainer(p,this.parent.sceneContainer),w.next=5,c.init();case 5:return this.tileMask=c,g=this.getMainLayer(),g!==void 0&&(g.tileMask=c),w.abrupt("return",c);case 9:case"end":return w.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"addMask",value:function(){var i=(0,He.Z)(Ne().mark(function s(c,p){var g;return Ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return g=(0,$.e7)(this.parent.sceneContainer),p.setContainer(g,this.parent.sceneContainer),w.next=4,p.init();case 4:c.addMask(p),this.tileMaskLayers.push(p);case 6:case"end":return w.stop()}},s,this)}));function a(s,c){return i.apply(this,arguments)}return a}()},{key:"addLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(c){var p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c.isTileLayer=!0,p=(0,$.e7)(this.parent.sceneContainer),c.setContainer(p,this.parent.sceneContainer),this.layers.push(c),b.next=6,c.init();case 6:case"end":return b.stop()}},s,this)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"updateVisible",value:function(a){this.visible=a,this.updateOptions("visible",a)}},{key:"updateOptions",value:function(a,s){this.layers.forEach(function(c){c.updateLayerConfig((0,G.Z)({},a,s))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(a){return[]}},{key:"getFeatureById",value:function(a){return[]}},{key:"destroy",value:function(){var a;(a=this.tileMask)===null||a===void 0||a.destroy(),this.layers.forEach(function(s){return s.destroy()})}}]),n}(Sl.EventEmitter);function d1(e){var r=p1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function p1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var v1=function(e){(0,Ai.Z)(n,e);var r=d1(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.getSourceOption(),p=c.data.features[0].properties,g=new Ei().source(c.data,c.options).size(1).shape("line").color("red"),b=new Nm({minZoom:this.z-1,maxZoom:this.z+1,textAllowOverlap:!0}).source([p],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),I.next=6,this.addLayer(g);case 6:return I.next=8,this.addLayer(b);case 8:this.isLoaded=!0;case 9:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:s},options:{parser:{type:"geojson"},transforms:a.transforms}}}}]),n}(Yd);function m1(e){var r=g1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function g1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var y1=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,_1=`layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
 
}
`,b1=function(e){(0,Ai.Z)(n,e);var r=m1(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=a.brightness,p=a.contrast,g=a.saturation,b=a.gamma,w={u_opacity:(0,ze.LS)(s,1),u_brightness:(0,ze.LS)(c,1),u_contrast:(0,ze.LS)(p,1),u_saturation:(0,ze.LS)(g,1),u_gamma:(0,ze.LS)(b,1)};this.textures=[this.texture];var I=this.getUniformsBufferInfo(w);return I}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.loadTexture();case 2:return p.abrupt("return",this.buildModels());case 3:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"loadTexture",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g;return Ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=this.rendererService.createTexture2D,this.texture=c({height:1,width:1}),p=this.layer.getSource(),w.next=5,p.data.images;case 5:g=w.sent,this.texture=c({data:g[0],width:g[0].width,height:g[0].height,mag:$.gl.LINEAR,min:$.gl.LINEAR});case 7:case"end":return w.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.initUniformsBuffer(),g.next=3,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:_1,fragmentShader:y1,triangulation:it,primitive:$.gl.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1});case 3:return c=g.sent,g.abrupt("return",[c]);case 5:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s,c,p){return[p[3],p[4]]}}})}}]),n}(ao),x1={image:b1},E1=x1;function S1(e){var r=T1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function T1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var A1=function(e){(0,Ai.Z)(n,e);var r=S1(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"type","ImageLayer"),i}return(0,We.Z)(n,[{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new E1[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={image:{}};return s[a]}},{key:"getModelType",value:function(){return"image"}}]),n}(es);function C1(e){var r=w1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function w1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var R1=function(e){(0,Ai.Z)(n,e);var r=C1(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.parent.getLayerAttributeConfig(),p=this.getLayerOptions(),g=this.getSourceOption(),b=new A1((0,fe.Z)({},p)).source(g.data,g.options),c&&Object.keys(c).forEach(function(W){var pe,Me,Fe=W;b[Fe]((pe=c[Fe])===null||pe===void 0?void 0:pe.field,(Me=c[Fe])===null||Me===void 0?void 0:Me.values)}),I.next=7,this.addLayer(b);case 7:this.isLoaded=!0;case 8:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:a.transforms}}}}]),n}(Yd);function M1(e){var r=I1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function I1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var O1=function(e){(0,Ai.Z)(n,e);var r=M1(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.parent.getLayerAttributeConfig(),p=this.getLayerOptions(),g=this.getSourceOption(),b=new pu((0,fe.Z)({},p)).source(g.data,g.options),c&&Object.keys(c).forEach(function(W){var pe,Me,Fe=W;b[Fe]((pe=c[Fe])===null||pe===void 0?void 0:pe.field,(Me=c[Fe])===null||Me===void 0?void 0:Me.values)}),I.next=7,this.addLayer(b);case 7:this.isLoaded=!0;case 8:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getFeatures",value:function(a){if(!a)return[];var s=this.sourceTile.data;return s.getTileData(a)}},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.parent.getLayerConfig(),c=s.sourceLayer,p=s.featureId,g=this.getFeatures(c);return{data:{type:"FeatureCollection",features:g},options:{parser:{type:"geojson",featureId:p},transforms:a.transforms}}}}]),n}(Yd);function P1(e){var r=D1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function D1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var k1=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,L1=`
layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,Ig=function(e){(0,Ai.Z)(n,e);var r=P1(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=s===void 0?1:s,p=a.clampLow,g=p===void 0?!0:p,b=a.clampHigh,w=b===void 0?!0:b,I=a.noDataValue,W=I===void 0?-9999999:I,pe=a.domain,Me=a.rampColors,Fe=pe||(0,ze.ZB)(Me);this.colorTexture=this.layer.textureService.getColorTexture(Me,Fe);var ut={u_domain:Fe,u_opacity:c||1,u_noDataValue:W,u_clampLow:g?1:0,u_clampHigh:(typeof w!="undefined"?w:g)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};this.textures=[this.texture,this.colorTexture];var Ot=this.getUniformsBufferInfo(ut);return Ot}},{key:"getRasterData",value:function(){var i=(0,He.Z)(Ne().mark(function s(c){var p,g,b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!Array.isArray(c.data)){W.next=4;break}return W.abrupt("return",{data:c.data,width:c.width,height:c.height});case 4:return W.next=6,c.data;case 6:return p=W.sent,g=p.rasterData,b=p.width,w=p.height,W.abrupt("return",{data:Array.from(g),width:b,height:w});case 11:case"end":return W.stop()}},s)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.buildModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe,Me,Fe;return Ne().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return this.initUniformsBuffer(),c=this.layer.getSource(),p=this.rendererService,g=p.createTexture2D,b=p.queryVerdorInfo,w=c.data.dataArray[0],Ot.next=6,this.getRasterData(w);case 6:return I=Ot.sent,W=I.data,pe=I.width,Me=I.height,this.texture=g({data:new Float32Array(W),width:pe,height:Me,format:b()==="WebGL1"?$.gl.LUMINANCE:$.gl.RED,type:$.gl.FLOAT,alignment:1}),Ot.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:L1,fragmentShader:k1,triangulation:it,primitive:$.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1});case 13:return Fe=Ot.sent,Ot.abrupt("return",[Fe]);case 15:case"end":return Ot.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a,s;(a=this.texture)===null||a===void 0||a.destroy(),(s=this.colorTexture)===null||s===void 0||s.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{shaderLocation:rn.UV,name:"a_Uv",buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s,c,p){return[p[3],p[4]]}}})}}]),n}(ao),B1=["data"],F1=["rasterData"];function N1(e){var r=U1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function U1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var z1=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,Z1=`
layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,j1=function(e){(0,Ai.Z)(n,e);var r=N1(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"dataOption",{}),i}return(0,We.Z)(n,[{key:"getUninforms",value:function(){var a=this.getCommonUniformsInfo(),s=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),(0,fe.Z)((0,fe.Z)({},a.uniformsOption),s.uniformsOption)}},{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=s===void 0?1:s,p=a.noDataValue,g=p===void 0?0:p,b=this.dataOption,w=b.rMinMax,I=w===void 0?[0,255]:w,W=b.gMinMax,pe=W===void 0?[0,255]:W,Me=b.bMinMax,Fe=Me===void 0?[0,255]:Me,ut={u_rminmax:I,u_gminmax:pe,u_bminmax:Fe,u_opacity:c||1,u_noDataValue:g,u_texture:this.texture};this.textures=[this.texture];var Ot=this.getUniformsBufferInfo(ut);return Ot}},{key:"getRasterData",value:function(){var i=(0,He.Z)(Ne().mark(function s(c){var p,g,b,w,I;return Ne().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(!Array.isArray(c.data)){pe.next=4;break}return p=c.data,g=(0,Ws.Z)(c,B1),this.dataOption=g,pe.abrupt("return",(0,fe.Z)({data:p},g));case 4:return pe.next=6,c.data;case 6:if(b=pe.sent,w=b.rasterData,I=(0,Ws.Z)(b,F1),this.dataOption=I,!Array.isArray(w)){pe.next=14;break}return pe.abrupt("return",(0,fe.Z)({data:w},I));case 14:return pe.abrupt("return",(0,fe.Z)({data:Array.from(w)},I));case 15:case"end":return pe.stop()}},s,this)}));function a(s){return i.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W,pe;return Ne().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return this.initUniformsBuffer(),c=this.layer.getSource(),p=this.rendererService.createTexture2D,g=c.data.dataArray[0],Fe.next=6,this.getRasterData(g);case 6:return b=Fe.sent,w=b.data,I=b.width,W=b.height,this.texture=p({data:new Float32Array(w),width:I,height:W,format:$.gl.RGB,type:$.gl.FLOAT}),Fe.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:Z1,fragmentShader:z1,triangulation:it,primitive:$.gl.TRIANGLES,depth:{enable:!1},pickingEnabled:!1});case 13:return pe=Fe.sent,Fe.abrupt("return",[pe]);case 15:case"end":return Fe.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.initModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s,c,p){return[p[3],p[4]]}}})}}]),n}(ao);function V1(e){var r=H1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function H1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $1=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,W1=`layout(location = 0) in vec3 a_Position;
layout(location = 14) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
   vec4 u_unpack;
   vec2 u_domain;
   float u_opacity;
   float u_noDataValue;
   float u_clampLow;
   float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace_v2(vec4(project_pos.xy,0., 1.0));
}
`,G1=function(e){(0,Ai.Z)(n,e);var r=V1(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"getCommonUniformsInfo",value:function(){var a=this.layer.getLayerConfig(),s=a.opacity,c=a.clampLow,p=c===void 0?!0:c,g=a.clampHigh,b=g===void 0?!0:g,w=a.noDataValue,I=w===void 0?-9999999:w,W=a.domain,pe=a.rampColors,Me=a.colorTexture,Fe=a.rScaler,ut=Fe===void 0?6553.6:Fe,Ot=a.gScaler,Bt=Ot===void 0?25.6:Ot,ir=a.bScaler,xr=ir===void 0?.1:ir,qr=a.offset,Ir=qr===void 0?1e4:qr,mr=W||(0,ze.ZB)(pe),sn=Me;Me?this.layer.textureService.setColorTexture(Me,pe,mr):sn=this.layer.textureService.getColorTexture(pe,mr);var ti={u_unpack:[ut,Bt,xr,Ir],u_domain:mr,u_opacity:s||1,u_noDataValue:I,u_clampLow:p,u_clampHigh:typeof b!="undefined"?b:p,u_texture:this.texture,u_colorTexture:sn};this.textures=[this.texture,sn];var Bi=this.getUniformsBufferInfo(ti);return Bi}},{key:"initModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return this.initUniformsBuffer(),c=this.layer.getSource(),p=this.rendererService.createTexture2D,I.next=5,c.data.images;case 5:return g=I.sent,this.texture=p({data:g[0],width:g[0].width,height:g[0].height,min:$.gl.LINEAR,mag:$.gl.LINEAR}),I.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:W1,fragmentShader:$1,triangulation:it,primitive:$.gl.TRIANGLES,depth:{enable:!1}});case 9:return b=I.sent,I.abrupt("return",[b]);case 11:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a;(a=this.texture)===null||a===void 0||a.destroy()}},{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.initModels());case 1:case"end":return p.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:$.GC.Attribute,descriptor:{name:"a_Uv",shaderLocation:rn.UV,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:2,update:function(s,c,p){return[p[3],p[4]]}}})}}]),n}(ao),X1={raster:Ig,rasterRgb:j1,raster3d:Ig,rasterTerrainRgb:G1},Y1=X1;function K1(e,r){return{type:e.type,field:"value",items:e.positions.map(function(n,i){var a;return a={},(0,G.Z)(a,r,i>=e.colors.length?null:e.colors[i]),(0,G.Z)(a,"value",n),a})}}function q1(e){var r=Q1();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Q1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Um=function(e){(0,Ai.Z)(n,e);var r=q1(n);function n(){var i;(0,Ge.Z)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return i=r.call.apply(r,[this].concat(s)),(0,G.Z)((0,gn.Z)(i),"type","RasterLayer"),i}return(0,We.Z)(n,[{key:"buildModels",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c;return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=this.getModelType(),this.layerModel=new Y1[c](this),g.next=4,this.initLayerModels();case 4:case"end":return g.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getDefaultConfig",value:function(){var a=this.getModelType(),s={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return s[a]}},{key:"getModelType",value:function(){var a=this.layerSource.getParserType();switch(a){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}},{key:"getLegend",value:function(a){if(a!=="color")return{type:void 0,field:void 0,items:[]};var s=this.getLayerConfig().rampColors;return K1(s,a)}}]),n}(es),J1=["rasterData"];function eb(e){var r=tb();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function tb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var rb=function(e){(0,Ai.Z)(n,e);var r=eb(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.parent.getLayerAttributeConfig(),p=this.getLayerOptions(),g=this.getSourceOption(),b=new Um((0,fe.Z)({},p)).source(g.data,g.options),c&&Object.keys(c).forEach(function(W){var pe,Me,Fe=W;b[Fe]((pe=c[Fe])===null||pe===void 0?void 0:pe.field,(Me=c[Fe])===null||Me===void 0?void 0:Me.values)}),I.next=7,this.addLayer(b);case 7:this.isLoaded=!0;case 8:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.sourceTile.data.data,c=s.rasterData,p=(0,Ws.Z)(s,J1);return{data:c,options:{parser:(0,fe.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},p),transforms:a.transforms}}}}]),n}(Yd);function nb(e){var r=ib();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function ib(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ab=function(e){(0,Ai.Z)(n,e);var r=nb(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b;return Ne().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=this.parent.getLayerAttributeConfig(),p=this.getLayerOptions(),g=this.getSourceOption(),b=new Um((0,fe.Z)({},p)).source(g.data,g.options),c&&Object.keys(c).forEach(function(W){var pe,Me,Fe=W;b[Fe]((pe=c[Fe])===null||pe===void 0?void 0:pe.field,(Me=c[Fe])===null||Me===void 0?void 0:Me.values)}),I.next=7,this.addLayer(b);case 7:this.isLoaded=!0;case 8:case"end":return I.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:a.transforms}}}}]),n}(Yd),ob=["rasterData"];function sb(e){var r=ub();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function ub(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var lb={positions:[0,1],colors:["#000","#fff"]},cb=function(e){(0,Ai.Z)(n,e);var r=sb(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w,I,W;return Ne().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return c=this.parent.getLayerAttributeConfig(),p=this.getLayerOptions(),g=this.getSourceOption(),b=this.getLayerOptions(),w=b.rampColors,I=b.domain,this.colorTexture=this.parent.textureService.getColorTexture(w,I),W=new Um((0,fe.Z)((0,fe.Z)({},p),{},{colorTexture:this.colorTexture})).source(g.data,g.options),c&&Object.keys(c).forEach(function(Fe){var ut,Ot,Bt=Fe;W[Bt]((ut=c[Bt])===null||ut===void 0?void 0:ut.field,(Ot=c[Bt])===null||Ot===void 0?void 0:Ot.values)}),Me.next=9,this.addLayer(W);case 9:this.isLoaded=!0;case 10:case"end":return Me.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.sourceTile.data.data,c=s.rasterData,p=(0,Ws.Z)(s,ob);return{data:c,options:{parser:(0,fe.Z)({type:"raster",extent:this.sourceTile.bounds},p),transforms:a.transforms}}}},{key:"styleUpdate",value:function(){for(var a=this,s=arguments.length,c=new Array(s),p=0;p<s;p++)c[p]=arguments[p];var g=c,b=g.rampColors,w=b===void 0?lb:b,I=g.domain;this.colorTexture=this.parent.textureService.getColorTexture(w,I||(0,ze.ZB)(w)),this.layers.forEach(function(W){return W.style({colorTexture:a.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(a){return a.destroy()})}}]),n}(Yd);function fb(e){var r=hb();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function hb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yv=function(e){(0,Ai.Z)(n,e);var r=fb(n);function n(){return(0,Ge.Z)(this,n),r.apply(this,arguments)}return(0,We.Z)(n,[{key:"initTileLayer",value:function(){var i=(0,He.Z)(Ne().mark(function s(){var c,p,g,b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(c=this.parent.getLayerAttributeConfig(),p=this.getLayerOptions(),g=l1(this.parent.type),b=this.getSourceOption(),b){W.next=8;break}return this.isLoaded=!0,this.emit("loaded"),W.abrupt("return");case 8:return w=new g((0,fe.Z)({},p)).source(b.data,b.options),Object.keys(c).forEach(function(pe){var Me,Fe,ut=pe;w[ut]((Me=c[ut])===null||Me===void 0?void 0:Me.field,(Fe=c[ut])===null||Fe===void 0?void 0:Fe.values)}),W.next=12,this.addLayer(w);case 12:if(!p.tileMask){W.next=15;break}return W.next=15,this.addTileMask();case 15:this.setLayerMinMaxZoom(w),this.isLoaded=!0,this.emit("loaded");case 18:case"end":return W.stop()}},s,this)}));function a(){return i.apply(this,arguments)}return a}()},{key:"getSourceOption",value:function(){var a=this.parent.getSource(),s=this.parent.getLayerConfig(),c=s.sourceLayer,p=c===void 0?"defaultLayer":c,g=s.featureId,b=g===void 0?"id":g,w=this.getFeatures(p);return{data:{type:"FeatureCollection",features:w},options:{parser:{type:"geojson",featureId:b},transforms:a.transforms}}}},{key:"setLayerMinMaxZoom",value:function(a){a.getModelType()==="text"&&a.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(a){var s=this.sourceTile.data;return s.getTileData(a)}},{key:"getFeatureById",value:function(a){var s=this.getMainLayer();if(!s)return[];var c=s.getSource().data.dataArray.filter(function(p){return p._id===a});return c}}]),n}(Yd);function db(e){var r=e.type;switch(r){case"PolygonLayer":return Yv;case"LineLayer":return Yv;case"PointLayer":return Yv;case"TileDebugLayer":return v1;case"MaskLayer":return O1;case"RasterLayer":var n=e.getSource().parser.dataType;switch(n){case $.n3.RGB:case $.n3.CUSTOMRGB:return rb;case $.n3.ARRAYBUFFER:case $.n3.CUSTOMARRAYBUFFER:return cb;case $.n3.TERRAINRGB:case $.n3.CUSTOMTERRAINRGB:return ab;default:return R1}default:return Yv}}var pb=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],vb=ze.rU.debounce,Og=function(){function e(r){var n=this;(0,Ge.Z)(this,e),(0,G.Z)(this,"initedTileset",!1),(0,G.Z)(this,"mapchange",function(){var a;if(n.parent.isVisible()!==!1){var s=n.getCurrentView(),c=s.latLonBounds,p=s.zoom;if(n.mapService.version==="GAODE1.x"){var g=n.parent.getLayerConfig(),b=g.visible;p<2&&b?(n.parent.updateLayerConfig({visible:!1}),n.layerService.reRender()):p>=2&&!b&&(n.parent.updateLayerConfig({visible:!0}),n.layerService.reRender())}n.lastViewStates&&n.lastViewStates.zoom===p&&n.lastViewStates.latLonBounds.toString()===c.toString()||(n.lastViewStates={zoom:p,latLonBounds:c},(a=n.tilesetManager)===null||a===void 0||a.throttleUpdate(p,c))}}),(0,G.Z)(this,"viewchange",vb(this.mapchange,24)),this.parent=r;var i=this.parent.getContainer();this.rendererService=i.get($.vK.IRendererService),this.layerService=i.get($.vK.ILayerService),this.mapService=i.get($.vK.IMapService),this.pickingService=i.get($.vK.IPickingService),this.tileLayerService=new A_({rendererService:this.rendererService,layerService:this.layerService,parent:r}),this.tilePickService=new I_({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:r}),this.parent.setLayerPickService(this.tilePickService),this.proxy(r),this.initTileSetManager()}return(0,We.Z)(e,[{key:"initTileSetManager",value:function(){var n,i=this.parent.getSource();if(this.tilesetManager=i.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()!==!1){var a=this.getCurrentView(),s=a.latLonBounds,c=a.zoom;(n=this.tilesetManager)===null||n===void 0||n.update(c,s)}}},{key:"getCurrentView",value:function(){var n=this.mapService.getBounds(),i=[n[0][0],n[0][1],n[1][0],n[1][1]],a=this.mapService.getZoom();return{latLonBounds:i,zoom:a}}},{key:"bindTilesetEvent",value:function(){var n=this;this.tilesetManager.on("tile-loaded",function(i){}),this.tilesetManager.on("tile-unload",function(i){n.tileUnLoad(i)}),this.tilesetManager.on("tile-error",function(i,a){n.tileError(i)}),this.tilesetManager.on("tile-update",function(){n.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"getTile",value:function(n){return this.tileLayerService.getTile(n)}},{key:"tileLoaded",value:function(n){}},{key:"tileError",value:function(n){console.warn("error:",n)}},{key:"destroy",value:function(){var n;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(n=this.tilesetManager)===null||n===void 0||n.destroy(),this.tileLayerService.destroy()}},{key:"reload",value:function(){var n;this.tilesetManager.clear();var i=this.getCurrentView(),a=i.latLonBounds,s=i.zoom;(n=this.tilesetManager)===null||n===void 0||n.update(s,a)}},{key:"tileUnLoad",value:function(n){this.tileLayerService.removeTile(n.key)}},{key:"tileUpdate",value:function(){var r=(0,He.Z)(Ne().mark(function i(){var a=this,s,c,p;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.tilesetManager){b.next=2;break}return b.abrupt("return");case 2:return s=this.parent.getMinZoom(),c=this.parent.getMaxZoom(),p=this.tilesetManager.tiles.filter(function(w){return w.isLoaded}).filter(function(w){return w.isVisibleChange}).filter(function(w){return w.data}).filter(function(w){return w.z>=s&&w.z<c}),b.next=7,Promise.all(p.map(function(){var w=(0,He.Z)(Ne().mark(function I(W){var pe,Me;return Ne().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:if(a.tileLayerService.hasTile(W.key)){ut.next=9;break}return pe=db(a.parent),Me=new pe(W,a.parent),ut.next=5,Me.initTileLayer();case 5:a.tilePickService.setPickState(),Me.getLayers().length!==0&&(a.tileLayerService.addTile(Me),a.tileLayerService.updateTileVisible(W),a.layerService.reRender()),ut.next=12;break;case 9:a.tileLayerService.updateTileVisible(W),a.tilePickService.setPickState(),a.layerService.reRender();case 12:case"end":return ut.stop()}},I)}));return function(I){return w.apply(this,arguments)}}()));case 7:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 8:case"end":return b.stop()}},i,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"setPickState",value:function(n){}},{key:"pickRender",value:function(n){this.tilePickService.pickRender(n)}},{key:"selectFeature",value:function(n){this.tilePickService.selectFeature(n)}},{key:"highlightPickedFeature",value:function(n){this.tilePickService.highlightPickedFeature(n)}},{key:"proxy",value:function(n){var i=this;pb.forEach(function(a){var s=n[a].bind(n);n[a]=function(){for(var c=arguments.length,p=new Array(c),g=0;g<c;g++)p[g]=arguments[g];return s.apply(void 0,p),i.getLayers().map(function(b){b[a].apply(b,p)}),a==="style"&&i.getTiles().forEach(function(b){return b.styleUpdate.apply(b,p)}),n}})}}]),e}(),Pg,Dg,mb=(Pg=(0,ta.b2)(),Pg(Dg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"build",value:function(){var r=(0,He.Z)(Ne().mark(function i(a){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a.prepareBuildModel(),c.next=3,a.buildModels();case 3:case"end":return c.stop()}},i)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"initLayerModel",value:function(){var r=(0,He.Z)(Ne().mark(function i(a){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.build(a);case 2:a.styleNeedUpdate=!1;case 3:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"prepareLayerModel",value:function(){var r=(0,He.Z)(Ne().mark(function i(a){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.build(a);case 2:a.styleNeedUpdate=!1;case 3:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"apply",value:function(n){var i=this;n.hooks.init.tapPromise("LayerModelPlugin",(0,He.Z)(Ne().mark(function a(){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!n.getSource().isTile){c.next=4;break}return n.prepareBuildModel(),n.tileLayer=new Og(n),c.abrupt("return");case 4:return n.log($.Or.BuildModelStart,$.KD.INIT),c.next=7,i.initLayerModel(n);case 7:n.log($.Or.BuildModelEnd,$.KD.INIT);case 8:case"end":return c.stop()}},a)}))),n.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var a=(0,He.Z)(Ne().mark(function s(c){return Ne().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(c){g.next=2;break}return g.abrupt("return",!1);case 2:if(!n.getSource().isTile){g.next=5;break}return n.tileLayer=new Og(n),g.abrupt("return",!1);case 5:return n.log($.Or.BuildModelStart,$.KD.UPDATE),g.next=8,i.prepareLayerModel(n);case 8:return n.log($.Or.BuildModelEnd,$.KD.UPDATE),g.abrupt("return",!0);case 10:case"end":return g.stop()}},s)}));return function(s){return a.apply(this,arguments)}}())}}]),e}())||Dg),kg,Lg,gb=(kg=(0,ta.b2)(),kg(Lg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n){n.hooks.afterInit.tap("LayerStylePlugin",function(){var i=n.getLayerConfig(),a=i.autoFit,s=i.fitBoundsOptions;a&&n.fitBounds(s),n.styleNeedUpdate=!1})}}]),e}())||Lg),Bg,Fg,yb=["type"],Ng={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},_b={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},bb={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},xb={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function Eb(e){var r={u_DirectionalLights:new Array(3).fill((0,fe.Z)({},bb)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,fe.Z)({},xb)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[_b]),e.forEach(function(n){var i=n.type,a=i===void 0?"directional":i,s=(0,Ws.Z)(n,yb),c=Ng[a].lights,p=Ng[a].num,g=r[p];r[c][g]=(0,fe.Z)((0,fe.Z)({},r[c][g]),s),r[p]++}),r}var Sb=(Bg=(0,ta.b2)(),Bg(Fg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n){n.hooks.beforeRender.tap("LightingPlugin",function(){var i=n.getLayerConfig(),a=i.enableLighting;a&&n.models.forEach(function(s){return s.addUniforms((0,fe.Z)({},Eb()))})})}}]),e}())||Fg),Ug,zg,Tb=(Ug=(0,ta.b2)(),Ug(zg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.rendererService,c=i.postProcessingPassFactory,p=i.normalPassFactory;n.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var g=n.getLayerConfig(),b=g.enableMultiPassRenderer,w=g.passes,I=w===void 0?[]:w;a.enabled=!!b&&n.getLayerConfig().enableMultiPassRenderer!==!1,a.enabled&&(n.multiPassRenderer=Ec(n,I,c,p),n.multiPassRenderer.setRenderFlag(!0))}),n.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(a.enabled){var g=s.getViewportSize(),b=g.width,w=g.height;n.multiPassRenderer.resize(b,w)}})}}]),e}())||zg),Zg,jg,Ab=ze.rU.isNumber,Rp={NONE:0,ENCODE:1,HIGHLIGHT:2},Cb=(Zg=(0,ta.b2)(),Zg(jg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"pickOption2Array",value:function(){var n=[];return this.pickingUniformMap.forEach(function(i,a){Ab(i)?n.push(i):n.push.apply(n,(0,jr.Z)(i))}),n}},{key:"updatePickOption",value:function(n,i){var a=this;Object.keys(n).forEach(function(g){a.pickingUniformMap.set(g,n[g])});var s=i.getLayerConfig().pickingBuffer||0,c=Number(i.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",s),this.pickingUniformMap.set("u_shaderPick",c);var p=i.getPickingUniformBuffer();p.subData({offset:0,data:this.pickOption2Array()})}},{key:"apply",value:function(n,i){var a=this,s=i.rendererService,c=i.styleAttributeService,p;this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_EnableSelect",0],["u_activeMix",0]]),n.hooks.init.tapPromise("PixelPickingPlugin",function(){var g=n.getLayerConfig(),b=g.enablePicking;c.registerStyleAttribute({name:"pickingColor",type:$.GC.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:rn.PICKING_COLOR,buffer:{data:[],type:$.gl.FLOAT},size:3,update:function(I){var W=I.id;return b?(0,ze.Z6)(W):[0,0,0]}}})}),n.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var g=n.getLayerConfig(),b=g.enablePicking;b&&n.isVisible()&&(a.updatePickOption({u_PickingStage:Rp.ENCODE},n),n.models.forEach(function(w){return w.addUniforms({u_PickingStage:Rp.ENCODE})}))}),n.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var g=n.getLayerConfig(),b=g.enablePicking;b&&n.isVisible()&&(a.updatePickOption({u_PickingStage:Rp.HIGHLIGHT},n),n.models.forEach(function(w){return w.addUniforms({u_PickingStage:Rp.HIGHLIGHT})}))}),n.hooks.beforeHighlight.tap("PixelPickingPlugin",function(g){var b=n.getLayerConfig(),w=b.highlightColor,I=b.activeMix,W=I===void 0?0:I,pe=typeof w=="string"?(0,ze.CI)(w):w||[1,0,0,1];n.updateLayerConfig({pickedFeatureID:(0,ze.W0)(new Uint8Array(g))});var Me={u_PickingStage:Rp.HIGHLIGHT,u_PickingColor:g,u_HighlightColor:pe.map(function(Fe){return Fe*255}),u_activeMix:W};a.updatePickOption(Me,n),n.models.forEach(function(Fe){return Fe.addUniforms(Me)})}),n.hooks.beforeSelect.tap("PixelPickingPlugin",function(g){var b=n.getLayerConfig(),w=b.selectColor,I=b.selectMix,W=I===void 0?0:I,pe=typeof w=="string"?(0,ze.CI)(w):w||[1,0,0,1];n.updateLayerConfig({pickedFeatureID:(0,ze.W0)(new Uint8Array(g))});var Me={u_PickingStage:Rp.HIGHLIGHT,u_PickingColor:g,u_HighlightColor:pe.map(function(Fe){return Fe*255}),u_activeMix:W,u_CurrentSelectedId:g,u_SelectColor:pe.map(function(Fe){return Fe*255}),u_EnableSelect:1};a.updatePickOption(Me,n),n.models.forEach(function(Fe){return Fe.addUniforms(Me)})})}}]),e}())||jg),wb=["mvt","geojsonvt","testTile"];function Rb(e){var r=e.getSource();return wb.includes(r.parser.type)}var Vg,Hg,Mb=(Vg=(0,ta.b2)(),Vg(Hg=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){Rb(n)||a.registerBuiltinAttributes(s,n)})}},{key:"registerBuiltinAttributes",value:function(n,i){if(i.type==="MaskLayer"){this.registerPositionAttribute(n);return}this.registerPositionAttribute(n),this.registerColorAttribute(n),this.registerVertexIdAttribute(n)}},{key:"registerPositionAttribute",value:function(n){n.registerStyleAttribute({name:"position",type:$.GC.Attribute,descriptor:{name:"a_Position",shaderLocation:rn.POSITION,buffer:{data:[],type:$.gl.FLOAT},size:3,update:function(a,s,c){return c.length===2?[c[0],c[1],0]:[c[0],c[1],c[2]]}}})}},{key:"registerColorAttribute",value:function(n){n.registerStyleAttribute({name:"color",type:$.GC.Attribute,descriptor:{name:"a_Color",shaderLocation:rn.COLOR,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:4,update:function(a){var s=a.color;return!s||!s.length?[1,1,1,1]:s}}})}},{key:"registerVertexIdAttribute",value:function(n){n.registerStyleAttribute({name:"vertexId",type:$.GC.Attribute,descriptor:{name:"a_vertexId",shaderLocation:rn.VERTEX_ID,buffer:{usage:$.gl.DYNAMIC_DRAW,data:[],type:$.gl.FLOAT},size:1,update:function(a,s){return[s]}}})}}]),e}())||Hg),$g,Wg,Gg,Xg,Yg,Kg,qg,Kd,Qg,Jg,e0,t0,r0,Ib=($g=(0,ta.b2)(),Wg=(0,ta.f3)($.vK.ICameraService),Gg=(0,ta.f3)($.vK.ICoordinateSystemService),Xg=(0,ta.f3)($.vK.IRendererService),Yg=(0,ta.f3)($.vK.IMapService),Kg=(0,ta.f3)($.vK.ILayerService),$g(qg=(Kd=function(){function e(){(0,Ge.Z)(this,e),(0,wa.Z)(this,"cameraService",Qg,this),(0,wa.Z)(this,"coordinateSystemService",Jg,this),(0,wa.Z)(this,"rendererService",e0,this),(0,wa.Z)(this,"mapService",t0,this),(0,wa.Z)(this,"layerService",r0,this)}return(0,We.Z)(e,[{key:"apply",value:function(n){var i=this,a=this.mapService.version,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=[0,0],p;this.rendererService.uniformBuffers[0]||(p=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0}),this.rendererService.uniformBuffers[0]=p),n.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var g=n.getLayerConfig().tileOrigin;if(i.coordinateSystemService.refresh(g),a==="GAODE2.x"){i.setLayerCenter(n),s=i.mapService.map.customCoords.getMVPMatrix(),c=i.mapService.getCustomCoordCenter();var b=n.getLayerUniformBuffer();b.subData({offset:0,data:new Uint8Array(new Float32Array([].concat((0,jr.Z)(s),(0,jr.Z)(c))).buffer)})}var w=i.rendererService.getViewportSize(),I=w.width,W=w.height,pe=i.generateUBO(s,c,I,W),Me=pe.data,Fe=pe.uniforms;if(i.layerService.alreadyInRendering&&i.rendererService.uniformBuffers[0]){var ut=i.rendererService.uniformBuffers[0];ut.subData({offset:0,data:Me})}var Ot=i.rendererService.queryVerdorInfo();Ot==="WebGL1"&&n.models.forEach(function(Bt){Bt.addUniforms((0,fe.Z)((0,fe.Z)({},Fe),{},{u_PickingBuffer:n.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(n.getShaderPickStat())}))})})}},{key:"setLayerCenter",value:function(n){n.coordCenter===void 0&&(n.coordCenter=n.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(n.coordCenter)}},{key:"generateUBO",value:function(n,i,a,s){var c,p=this.cameraService.getProjectionMatrix(),g=this.cameraService.getViewMatrix(),b=this.cameraService.getViewProjectionMatrix(),w=this.cameraService.getModelMatrix(),I=this.coordinateSystemService.getViewportCenterProjection(),W=this.coordinateSystemService.getPixelsPerDegree(),pe=this.cameraService.getZoom(),Me=this.coordinateSystemService.getPixelsPerDegree2(),Fe=this.cameraService.getZoomScale(),ut=this.coordinateSystemService.getPixelsPerMeter(),Ot=this.coordinateSystemService.getCoordinateSystem(),Bt=this.cameraService.getCameraPosition(),ir=window.devicePixelRatio,xr=this.coordinateSystemService.getViewportCenter(),qr=[a,s],Ir=this.cameraService.getFocalDistance(),mr=[].concat((0,jr.Z)(g),(0,jr.Z)(p),(0,jr.Z)(b),(0,jr.Z)(w),(0,jr.Z)(I),(0,jr.Z)(W),[pe],(0,jr.Z)(Me),[Fe],(0,jr.Z)(ut),[Ot],(0,jr.Z)(Bt),[ir],(0,jr.Z)(xr),qr,[Ir,0,0,0]);return{data:mr,uniforms:(c={},(0,G.Z)(c,$.lv.ProjectionMatrix,p),(0,G.Z)(c,$.lv.ViewMatrix,g),(0,G.Z)(c,$.lv.ViewProjectionMatrix,b),(0,G.Z)(c,$.lv.Zoom,pe),(0,G.Z)(c,$.lv.ZoomScale,Fe),(0,G.Z)(c,$.lv.FocalDistance,Ir),(0,G.Z)(c,$.lv.CameraPosition,Bt),(0,G.Z)(c,$.kw.CoordinateSystem,Ot),(0,G.Z)(c,$.kw.ViewportCenter,xr),(0,G.Z)(c,$.kw.ViewportCenterProjection,I),(0,G.Z)(c,$.kw.PixelsPerDegree,W),(0,G.Z)(c,$.kw.PixelsPerDegree2,Me),(0,G.Z)(c,$.kw.PixelsPerMeter,ut),(0,G.Z)(c,$.kw.Mvp,n),(0,G.Z)(c,"u_sceneCenterMercator",i),(0,G.Z)(c,"u_ViewportSize",qr),(0,G.Z)(c,"u_ModelMatrix",w),(0,G.Z)(c,"u_DevicePixelRatio",ir),c)}}}]),e}(),Qg=(0,qs.Z)(Kd.prototype,"cameraService",[Wg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jg=(0,qs.Z)(Kd.prototype,"coordinateSystemService",[Gg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e0=(0,qs.Z)(Kd.prototype,"rendererService",[Xg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t0=(0,qs.Z)(Kd.prototype,"mapService",[Yg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r0=(0,qs.Z)(Kd.prototype,"layerService",[Kg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kd))||qg),n0,i0,Ob=(n0=(0,ta.b2)(),n0(i0=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n){n.hooks.beforeRender.tap("UpdateModelPlugin",function(){n.layerModel&&n.layerModel.needUpdate().then(function(i){i&&n.renderLayers()})}),n.hooks.afterRender.tap("UpdateModelPlugin",function(){n.layerModelNeedUpdate=!1})}}]),e}())||i0),a0,o0,Pb=(a0=(0,ta.b2)(),a0(o0=function(){function e(){(0,Ge.Z)(this,e)}return(0,We.Z)(e,[{key:"apply",value:function(n,i){var a=this,s=i.styleAttributeService;n.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){a.initStyleAttribute(n,{styleAttributeService:s})}),n.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){n.layerModelNeedUpdate||n.inited&&a.updateStyleAttribute(n,{styleAttributeService:s})})}},{key:"updateStyleAttribute",value:function(n,i){var a=i.styleAttributeService,s=a.getLayerStyleAttributes()||[],c=a.getLayerStyleAttribute("filter");if(c&&c.needRegenerateVertices){n.layerModelNeedUpdate=!0,s.forEach(function(p){return p.needRegenerateVertices=!1});return}s.filter(function(p){return p.needRegenerateVertices}).forEach(function(p){a.updateAttributeByFeatureRange(p.name,n.getEncodedData(),p.featureRange.startIndex,p.featureRange.endIndex,n),p.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(n,i){var a=i.styleAttributeService,s=a.getLayerStyleAttributes()||[];s.filter(function(c){return c.needRegenerateVertices}).forEach(function(c){a.updateAttributeByFeatureRange(c.name,n.getEncodedData(),c.featureRange.startIndex,c.featureRange.endIndex),c.needRegenerateVertices=!1})}}]),e}())||o0);$.nC.bind($.vK.ILayerPlugin).to(xt).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Mb).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(E_).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(ha).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(gb).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(T_).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Pb).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Ob).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Tb).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Ib).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(S_).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Sb).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(Cb).inRequestScope(),$.nC.bind($.vK.ILayerPlugin).to(mb).inRequestScope();function WS(e){var r=Db();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Db(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var GS=null;function XS(e){var r=kb();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function kb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var YS=null;function Lb(e){var r=Bb();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function Bb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fb=function(e){(0,Ai.Z)(n,e);var r=Lb(n);function n(i){var a;(0,Ge.Z)(this,n),a=r.call(this),(0,G.Z)((0,gn.Z)(a),"isShow",!0),(0,G.Z)((0,gn.Z)(a),"onMouseMove",function(c){var p,g=a.mapsService.getMapContainer(),b=(p=g==null?void 0:g.getBoundingClientRect())!==null&&p!==void 0?p:{},w=b.left,I=w===void 0?0:w,W=b.top,pe=W===void 0?0:W;a.setPopupPosition(c.clientX-I,c.clientY-pe)}),(0,G.Z)((0,gn.Z)(a),"updateLngLatPosition",function(){if(!(!a.mapsService||a.popupOption.followCursor)){var c=a.lngLat,p=c.lng,g=c.lat,b=a.mapsService.lngLatToContainer([p,g]),w=b.x,I=b.y;a.setPopupPosition(w,I)}}),(0,G.Z)((0,gn.Z)(a),"updateLngLatPositionWhenZoom",function(c){if(!(!a.mapsService||a.popupOption.followCursor)){var p=a.lngLat,g=p.lng,b=p.lat,w=a.mapsService.lngLatToContainer([g,b]),I=w.x,W=w.y,pe=c.map,Me=pe.getSize();Me.x=Me.x/2,Me.y=Me.y/2;var Fe=c.center,ut=c.zoom,Ot=pe.DE(a.lngLat,ut,Fe);Ot.x=Math.round(Ot.x),Ot.y=Math.round(Ot.y),a.setPopupPosition(Ot.x,Ot.y,!0)}}),(0,G.Z)((0,gn.Z)(a),"onKeyDown",function(c){c.keyCode===27&&a.remove()}),(0,G.Z)((0,gn.Z)(a),"onCloseButtonClick",function(c){c.stopPropagation&&c.stopPropagation(),a.hide()}),(0,G.Z)((0,gn.Z)(a),"updatePosition",function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,g=!!a.lngLat,b=a.popupOption,w=b.className,I=b.style,W=b.maxWidth,pe=b.anchor,Me=b.stopPropagation;if(!(!a.mapsService||!g||!a.content)){var Fe=a.mapsService.getMarkerContainer();if(!a.container&&Fe&&(a.container=ze.SO.create("div","l7-popup ".concat(w!=null?w:""," ").concat(a.isShow?"":"l7-popup-hide"),Fe),I&&a.container.setAttribute("style",I),a.tip=ze.SO.create("div","l7-popup-tip",a.container),a.container.appendChild(a.content),Me&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Bt){a.container.addEventListener(Bt,function(ir){ir.stopPropagation()})}),a.container.style.whiteSpace="nowrap"),p?a.updateLngLatPositionWhenZoom(c):a.updateLngLatPosition(),ze.SO.setTransform(a.container,"".concat(ze.rQ[pe])),(0,ze.zi)(a.container,pe,"popup"),W){var ut=a.container.getBoundingClientRect(),Ot=ut.width;Ot>parseFloat(W)&&(a.container.style.width=W)}else a.container.style.removeProperty("width")}}),(0,G.Z)((0,gn.Z)(a),"updateWhenZoom",function(c){a.updatePosition(c,!0)}),(0,G.Z)((0,gn.Z)(a),"update",function(){a.updatePosition(null,!1)}),a.popupOption=(0,fe.Z)((0,fe.Z)({},a.getDefault(i!=null?i:{})),i);var s=a.popupOption.lngLat;return s&&(a.lngLat=s),a}return(0,We.Z)(n,[{key:"lngLat",get:function(){var a;return(a=this.popupOption.lngLat)!==null&&a!==void 0?a:{lng:0,lat:0}},set:function(a){this.popupOption.lngLat=a}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(a){this.mapsService=a.get($.vK.IMapService),this.sceneService=a.get($.vK.ISceneService),this.layerService=a.get($.vK.ILayerService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=a,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var s=this.popupOption,c=s.html,p=s.text,g=s.title;return c?this.setHTML(c):p&&this.setText(p),g&&this.setTitle(g),this.emit("open"),this}},{key:"remove",value:function(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&ze.SO.remove(this.content),this.container&&(ze.SO.remove(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(a){return this.show(),this.popupOption=(0,fe.Z)((0,fe.Z)({},this.popupOption),a),this.checkUpdateOption(a,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(ze.SO.remove(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(a,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(a,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(a,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(a,["html"])&&a.html?this.setHTML(a.html):this.checkUpdateOption(a,["text"])&&a.text&&this.setText(a.text),this.checkUpdateOption(a,["lngLat"])&&a.lngLat&&this.setLnglat(a.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&ze.SO.removeClass(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(this.isShow)return this.container&&ze.SO.addClass(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(a){return this.popupOption.html=a,this.setDOMContent(a)}},{key:"setText",value:function(a){return this.popupOption.text=a,this.setDOMContent(window.document.createTextNode(a))}},{key:"setTitle",value:function(a){this.show(),this.popupOption.title=a,a?(this.contentTitle||(this.contentTitle=ze.SO.create("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),ze.SO.clearChildren(this.contentTitle),ze.SO.appendElementType(this.contentTitle,a)):this.contentTitle&&(ze.SO.remove(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var a=this.lngLat,s=a.lng,c=a.lat;return this.popupOption.autoPan&&this.mapsService.panTo([s,c]),this}},{key:"setLngLat",value:function(a){return this.setLnglat(a)}},{key:"setLnglat",value:function(a){var s=this;return this.show(),this.lngLat=a,Array.isArray(a)&&(this.lngLat={lng:a[0],lat:a[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){s.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(a){return this.popupOption.maxWidth=a,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(a){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:ze.bV.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(a){return this.show(),this.createContent(),ze.SO.appendElementType(this.contentPanel,a),this.update(),this}},{key:"updateCloseOnClick",value:function(a){var s=this,c=this.mapsService;c&&(c==null||c.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!a&&requestAnimationFrame(function(){c==null||c.on("click",s.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(a){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!a&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(a){var s,c=(s=this.mapsService)===null||s===void 0?void 0:s.getContainer();c&&(c==null||c.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!a&&(c==null||c.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var a=this;if(this.content&&ze.SO.remove(this.content),this.contentTitle=void 0,this.content=ze.SO.create("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var s=nl("l7-icon-guanbi");ze.SO.addClass(s,"l7-popup-close-button"),this.content.appendChild(s),this.popupOption.closeButtonOffsets&&(s.style.right=this.popupOption.closeButtonOffsets[0]+"px",s.style.top=this.popupOption.closeButtonOffsets[1]+"px"),s.setAttribute("aria-label","Close popup"),s.addEventListener("click",function(){a.hide()}),s.addEventListener("pointerup",function(c){c.stopPropagation()}),s.addEventListener("pointerdown",function(c){c.stopPropagation()}),this.closeButton=s}else this.closeButton=void 0;this.contentPanel=ze.SO.create("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(a,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.container){var p=this.popupOption.offsets;this.container.style.left=a+p[0]+"px",this.container.style.top=s-p[1]+"px",c?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}},{key:"checkUpdateOption",value:function(a,s){return s.some(function(c){return c in a})}}]),n}(Sl.EventEmitter);function KS(e){var r=Nb();return function(){var i=_getPrototypeOf(e),a;if(r){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function Nb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qS=ze.rU.get,QS=null;function Ub(e,r){var n=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,i=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(n||i)&&(r||(r=document),!!r)){var a=r.head||r.getElementsByTagName("head")[0];if(!a){a=r.createElement("head");var s=r.body||r.getElementsByTagName("body")[0];s?s.parentNode.insertBefore(a,s):r.documentElement.appendChild(a)}var c=r.createElement("style");return c.type="text/css",c.styleSheet?c.styleSheet.cssText=e:c.appendChild(r.createTextNode(e)),a.appendChild(c),c}}Ub(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-flex: 0;
      -ms-flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
          flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item input[type='radio'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -ms-touch-action: none;
      touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);var JS=_(8520),zb=_(81550),Zb=_.n(zb),jb=function(){function e(r,n){(0,Ge.Z)(this,e);var i=n.buffer,a=n.offset,s=n.stride,c=n.normalized,p=n.size,g=n.divisor;this.buffer=i,this.attribute={buffer:i.get(),offset:a||0,stride:s||0,normalized:c||!1,divisor:g||0},p&&(this.attribute.size=p)}return(0,We.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Gh,bv,vd,Kf,xv,md,Ev,Kv,Ch,qd,fc,wh,Rh,qv,Vb=(Gh={},(0,G.Z)(Gh,$.gl.POINTS,"points"),(0,G.Z)(Gh,$.gl.LINES,"lines"),(0,G.Z)(Gh,$.gl.LINE_LOOP,"line loop"),(0,G.Z)(Gh,$.gl.LINE_STRIP,"line strip"),(0,G.Z)(Gh,$.gl.TRIANGLES,"triangles"),(0,G.Z)(Gh,$.gl.TRIANGLE_FAN,"triangle fan"),(0,G.Z)(Gh,$.gl.TRIANGLE_STRIP,"triangle strip"),Gh),s0=(bv={},(0,G.Z)(bv,$.gl.STATIC_DRAW,"static"),(0,G.Z)(bv,$.gl.DYNAMIC_DRAW,"dynamic"),(0,G.Z)(bv,$.gl.STREAM_DRAW,"stream"),bv),zm=(vd={},(0,G.Z)(vd,$.gl.BYTE,"int8"),(0,G.Z)(vd,$.gl.INT,"int32"),(0,G.Z)(vd,$.gl.UNSIGNED_BYTE,"uint8"),(0,G.Z)(vd,$.gl.UNSIGNED_SHORT,"uint16"),(0,G.Z)(vd,$.gl.UNSIGNED_INT,"uint32"),(0,G.Z)(vd,$.gl.FLOAT,"float"),vd),Hb=(Kf={},(0,G.Z)(Kf,$.gl.ALPHA,"alpha"),(0,G.Z)(Kf,$.gl.LUMINANCE,"luminance"),(0,G.Z)(Kf,$.gl.LUMINANCE_ALPHA,"luminance alpha"),(0,G.Z)(Kf,$.gl.RGB,"rgb"),(0,G.Z)(Kf,$.gl.RGBA,"rgba"),(0,G.Z)(Kf,$.gl.RGBA4,"rgba4"),(0,G.Z)(Kf,$.gl.RGB5_A1,"rgb5 a1"),(0,G.Z)(Kf,$.gl.RGB565,"rgb565"),(0,G.Z)(Kf,$.gl.DEPTH_COMPONENT,"depth"),(0,G.Z)(Kf,$.gl.DEPTH_STENCIL,"depth stencil"),Kf),$b=(xv={},(0,G.Z)(xv,$.gl.DONT_CARE,"dont care"),(0,G.Z)(xv,$.gl.NICEST,"nice"),(0,G.Z)(xv,$.gl.FASTEST,"fast"),xv),u0=(md={},(0,G.Z)(md,$.gl.NEAREST,"nearest"),(0,G.Z)(md,$.gl.LINEAR,"linear"),(0,G.Z)(md,$.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,G.Z)(md,$.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,G.Z)(md,$.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,G.Z)(md,$.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),md),l0=(Ev={},(0,G.Z)(Ev,$.gl.REPEAT,"repeat"),(0,G.Z)(Ev,$.gl.CLAMP_TO_EDGE,"clamp"),(0,G.Z)(Ev,$.gl.MIRRORED_REPEAT,"mirror"),Ev),Wb=(Kv={},(0,G.Z)(Kv,$.gl.NONE,"none"),(0,G.Z)(Kv,$.gl.BROWSER_DEFAULT_WEBGL,"browser"),Kv),Gb=(Ch={},(0,G.Z)(Ch,$.gl.NEVER,"never"),(0,G.Z)(Ch,$.gl.ALWAYS,"always"),(0,G.Z)(Ch,$.gl.LESS,"less"),(0,G.Z)(Ch,$.gl.LEQUAL,"lequal"),(0,G.Z)(Ch,$.gl.GREATER,"greater"),(0,G.Z)(Ch,$.gl.GEQUAL,"gequal"),(0,G.Z)(Ch,$.gl.EQUAL,"equal"),(0,G.Z)(Ch,$.gl.NOTEQUAL,"notequal"),Ch),c0=(qd={},(0,G.Z)(qd,$.gl.FUNC_ADD,"add"),(0,G.Z)(qd,$.gl.MIN_EXT,"min"),(0,G.Z)(qd,$.gl.MAX_EXT,"max"),(0,G.Z)(qd,$.gl.FUNC_SUBTRACT,"subtract"),(0,G.Z)(qd,$.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),qd),Qv=(fc={},(0,G.Z)(fc,$.gl.ZERO,"zero"),(0,G.Z)(fc,$.gl.ONE,"one"),(0,G.Z)(fc,$.gl.SRC_COLOR,"src color"),(0,G.Z)(fc,$.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,G.Z)(fc,$.gl.SRC_ALPHA,"src alpha"),(0,G.Z)(fc,$.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,G.Z)(fc,$.gl.DST_COLOR,"dst color"),(0,G.Z)(fc,$.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,G.Z)(fc,$.gl.DST_ALPHA,"dst alpha"),(0,G.Z)(fc,$.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,G.Z)(fc,$.gl.CONSTANT_COLOR,"constant color"),(0,G.Z)(fc,$.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,G.Z)(fc,$.gl.CONSTANT_ALPHA,"constant alpha"),(0,G.Z)(fc,$.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,G.Z)(fc,$.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),fc),Xb=(wh={},(0,G.Z)(wh,$.gl.NEVER,"never"),(0,G.Z)(wh,$.gl.ALWAYS,"always"),(0,G.Z)(wh,$.gl.LESS,"less"),(0,G.Z)(wh,$.gl.LEQUAL,"lequal"),(0,G.Z)(wh,$.gl.GREATER,"greater"),(0,G.Z)(wh,$.gl.GEQUAL,"gequal"),(0,G.Z)(wh,$.gl.EQUAL,"equal"),(0,G.Z)(wh,$.gl.NOTEQUAL,"notequal"),wh),Mp=(Rh={},(0,G.Z)(Rh,$.gl.ZERO,"zero"),(0,G.Z)(Rh,$.gl.KEEP,"keep"),(0,G.Z)(Rh,$.gl.REPLACE,"replace"),(0,G.Z)(Rh,$.gl.INVERT,"invert"),(0,G.Z)(Rh,$.gl.INCR,"increment"),(0,G.Z)(Rh,$.gl.DECR,"decrement"),(0,G.Z)(Rh,$.gl.INCR_WRAP,"increment wrap"),(0,G.Z)(Rh,$.gl.DECR_WRAP,"decrement wrap"),Rh),Yb=(qv={},(0,G.Z)(qv,$.gl.FRONT,"front"),(0,G.Z)(qv,$.gl.BACK,"back"),qv),Kb=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"isDestroyed",!1);var i=n.data,a=n.usage,s=n.type;this.buffer=r.buffer({data:i,usage:s0[a||$.gl.STATIC_DRAW],type:zm[s||$.gl.UNSIGNED_BYTE]})}return(0,We.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(n){var i=n.data,a=n.offset;this.buffer.subdata(i,a)}}]),e}(),qb=function(){function e(r,n){(0,Ge.Z)(this,e);var i=n.data,a=n.usage,s=n.type,c=n.count;this.elements=r.elements({data:i,usage:s0[a||$.gl.STATIC_DRAW],type:zm[s||$.gl.UNSIGNED_BYTE],count:c})}return(0,We.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var i=n.data;this.elements.subdata(i)}},{key:"destroy",value:function(){}}]),e}(),Qb=function(){function e(r,n){(0,Ge.Z)(this,e);var i=n.width,a=n.height,s=n.color,c=n.colors,p={width:i,height:a};Array.isArray(c)&&(p.colors=c.map(function(g){return g.get()})),s&&typeof s!="boolean"&&(p.color=s.get()),this.framebuffer=r.framebuffer(p)}return(0,We.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var i=n.width,a=n.height;this.framebuffer.resize(i,a)}}]),e}(),qf=_(95147),Ip=_(25897),Jb=_(81957),bi=_(97582),ex=_(90857),f0=ex,Ft;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.ALWAYS=519]="ALWAYS",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.GEQUAL=518]="GEQUAL",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",e[e.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",e[e.RGBA32F_EXT=34836]="RGBA32F_EXT",e[e.RGB32F_EXT=34837]="RGB32F_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",e[e.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.SRGB_EXT=35904]="SRGB_EXT",e[e.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",e[e.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",e[e.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",e[e.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",e[e.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",e[e.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",e[e.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",e[e.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",e[e.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",e[e.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",e[e.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",e[e.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",e[e.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",e[e.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",e[e.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",e[e.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",e[e.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",e[e.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",e[e.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",e[e.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",e[e.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",e[e.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",e[e.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",e[e.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",e[e.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",e[e.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",e[e.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",e[e.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",e[e.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",e[e.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",e[e.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",e[e.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",e[e.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",e[e.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",e[e.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",e[e.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",e[e.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(Ft||(Ft={}));var mo;(function(e){e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.RenderTarget=2]="RenderTarget",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.RenderPipeline=7]="RenderPipeline",e[e.ComputePipeline=8]="ComputePipeline",e[e.Readback=9]="Readback",e[e.QueryPool=10]="QueryPool",e[e.RenderBundle=11]="RenderBundle"})(mo||(mo={}));var Fa;(function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"})(Fa||(Fa={}));var Sv;(function(e){e[e.CCW=2305]="CCW",e[e.CW=2304]="CW"})(Sv||(Sv={}));var of;(function(e){e[e.NONE=0]="NONE",e[e.FRONT=1]="FRONT",e[e.BACK=2]="BACK",e[e.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(of||(of={}));var Ka;(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC=768]="SRC",e[e.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",e[e.DST=774]="DST",e[e.ONE_MINUS_DST=775]="ONE_MINUS_DST",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONST=32769]="CONST",e[e.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(Ka||(Ka={}));var Ll;(function(e){e[e.ADD=32774]="ADD",e[e.SUBSTRACT=32778]="SUBSTRACT",e[e.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX"})(Ll||(Ll={}));var Zc;(function(e){e[e.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",e[e.REPEAT=1]="REPEAT",e[e.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(Zc||(Zc={}));var mu;(function(e){e[e.POINT=0]="POINT",e[e.BILINEAR=1]="BILINEAR"})(mu||(mu={}));var ml;(function(e){e[e.NO_MIP=0]="NO_MIP",e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR"})(ml||(ml={}));var Uu;(function(e){e[e.POINTS=0]="POINTS",e[e.TRIANGLES=1]="TRIANGLES",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.LINES=3]="LINES",e[e.LINE_STRIP=4]="LINE_STRIP"})(Uu||(Uu={}));var as;(function(e){e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(as||(as={}));var mh;(function(e){e[e.STATIC=1]="STATIC",e[e.DYNAMIC=2]="DYNAMIC"})(mh||(mh={}));var Qd;(function(e){e[e.VERTEX=1]="VERTEX",e[e.INSTANCE=2]="INSTANCE"})(Qd||(Qd={}));var h0;(function(e){e.LOADED="loaded"})(h0||(h0={}));var Wa;(function(e){e[e.TEXTURE_2D=0]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=2]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(Wa||(Wa={}));var hc;(function(e){e[e.SAMPLED=1]="SAMPLED",e[e.RENDER_TARGET=2]="RENDER_TARGET",e[e.STORAGE=4]="STORAGE"})(hc||(hc={}));var Bl;(function(e){e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e[e.RGB=7]="RGB",e[e.ALL=15]="ALL"})(Bl||(Bl={}));var eu;(function(e){e[e.KEEP=7680]="KEEP",e[e.ZERO=0]="ZERO",e[e.REPLACE=7681]="REPLACE",e[e.INVERT=5386]="INVERT",e[e.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=34055]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(eu||(eu={}));function e2(e,r,n,i){var a=Wa.TEXTURE_2D,s=1,c=hc.SAMPLED;return{dimension:a,format:e,width:r,height:n,depthOrArrayLayers:s,mipLevelCount:i,usage:c}}var tu;(function(e){e[e.Float=0]="Float",e[e.UnfilterableFloat=1]="UnfilterableFloat",e[e.Uint=2]="Uint",e[e.Sint=3]="Sint",e[e.Depth=4]="Depth"})(tu||(tu={}));var Mh;(function(e){e[e.LOWER_LEFT=0]="LOWER_LEFT",e[e.UPPER_LEFT=1]="UPPER_LEFT"})(Mh||(Mh={}));var Op;(function(e){e[e.NEGATIVE_ONE=0]="NEGATIVE_ONE",e[e.ZERO=1]="ZERO"})(Op||(Op={}));var Jv;(function(e){e[e.OcclusionConservative=0]="OcclusionConservative"})(Jv||(Jv={}));var xn;(function(e){e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=3]="U32",e[e.S8=4]="S8",e[e.S16=5]="S16",e[e.S32=6]="S32",e[e.F16=7]="F16",e[e.F32=8]="F32",e[e.BC1=65]="BC1",e[e.BC2=66]="BC2",e[e.BC3=67]="BC3",e[e.BC4_UNORM=68]="BC4_UNORM",e[e.BC4_SNORM=69]="BC4_SNORM",e[e.BC5_UNORM=70]="BC5_UNORM",e[e.BC5_SNORM=71]="BC5_SNORM",e[e.U16_PACKED_5551=97]="U16_PACKED_5551",e[e.U16_PACKED_565=98]="U16_PACKED_565",e[e.D24=129]="D24",e[e.D32F=130]="D32F",e[e.D24S8=131]="D24S8",e[e.D32FS8=132]="D32FS8"})(xn||(xn={}));var Ri;(function(e){e[e.R=1]="R",e[e.RG=2]="RG",e[e.RGB=3]="RGB",e[e.RGBA=4]="RGBA",e[e.A=5]="A"})(Ri||(Ri={}));function t2(e){return e}var pi;(function(e){e[e.None=0]="None",e[e.Normalized=1]="Normalized",e[e.sRGB=2]="sRGB",e[e.Depth=4]="Depth",e[e.Stencil=8]="Stencil",e[e.RenderTarget=16]="RenderTarget",e[e.Luminance=32]="Luminance"})(pi||(pi={}));function Gi(e,r,n){return e<<16|r<<8|n}var fr;(function(e){e[e.ALPHA=Gi(xn.U8,Ri.A,pi.None)]="ALPHA",e[e.U8_LUMINANCE=Gi(xn.U8,Ri.A,pi.Luminance)]="U8_LUMINANCE",e[e.F16_LUMINANCE=Gi(xn.F16,Ri.A,pi.Luminance)]="F16_LUMINANCE",e[e.F32_LUMINANCE=Gi(xn.F32,Ri.A,pi.Luminance)]="F32_LUMINANCE",e[e.F16_R=Gi(xn.F16,Ri.R,pi.None)]="F16_R",e[e.F16_RG=Gi(xn.F16,Ri.RG,pi.None)]="F16_RG",e[e.F16_RGB=Gi(xn.F16,Ri.RGB,pi.None)]="F16_RGB",e[e.F16_RGBA=Gi(xn.F16,Ri.RGBA,pi.None)]="F16_RGBA",e[e.F32_R=Gi(xn.F32,Ri.R,pi.None)]="F32_R",e[e.F32_RG=Gi(xn.F32,Ri.RG,pi.None)]="F32_RG",e[e.F32_RGB=Gi(xn.F32,Ri.RGB,pi.None)]="F32_RGB",e[e.F32_RGBA=Gi(xn.F32,Ri.RGBA,pi.None)]="F32_RGBA",e[e.U8_R=Gi(xn.U8,Ri.R,pi.None)]="U8_R",e[e.U8_R_NORM=Gi(xn.U8,Ri.R,pi.Normalized)]="U8_R_NORM",e[e.U8_RG=Gi(xn.U8,Ri.RG,pi.None)]="U8_RG",e[e.U8_RG_NORM=Gi(xn.U8,Ri.RG,pi.Normalized)]="U8_RG_NORM",e[e.U8_RGB=Gi(xn.U8,Ri.RGB,pi.None)]="U8_RGB",e[e.U8_RGB_NORM=Gi(xn.U8,Ri.RGB,pi.Normalized)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=Gi(xn.U8,Ri.RGB,pi.sRGB|pi.Normalized)]="U8_RGB_SRGB",e[e.U8_RGBA=Gi(xn.U8,Ri.RGBA,pi.None)]="U8_RGBA",e[e.U8_RGBA_NORM=Gi(xn.U8,Ri.RGBA,pi.Normalized)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=Gi(xn.U8,Ri.RGBA,pi.sRGB|pi.Normalized)]="U8_RGBA_SRGB",e[e.U16_R=Gi(xn.U16,Ri.R,pi.None)]="U16_R",e[e.U16_R_NORM=Gi(xn.U16,Ri.R,pi.Normalized)]="U16_R_NORM",e[e.U16_RG_NORM=Gi(xn.U16,Ri.RG,pi.Normalized)]="U16_RG_NORM",e[e.U16_RGBA_NORM=Gi(xn.U16,Ri.RGBA,pi.Normalized)]="U16_RGBA_NORM",e[e.U16_RGBA=Gi(xn.U16,Ri.RGBA,pi.None)]="U16_RGBA",e[e.U16_RGB=Gi(xn.U16,Ri.RGB,pi.None)]="U16_RGB",e[e.U16_RG=Gi(xn.U16,Ri.RG,pi.None)]="U16_RG",e[e.U32_R=Gi(xn.U32,Ri.R,pi.None)]="U32_R",e[e.U32_RG=Gi(xn.U32,Ri.RG,pi.None)]="U32_RG",e[e.U32_RGB=Gi(xn.U32,Ri.RGB,pi.None)]="U32_RGB",e[e.U32_RGBA=Gi(xn.U32,Ri.RGBA,pi.None)]="U32_RGBA",e[e.S8_R=Gi(xn.S8,Ri.R,pi.None)]="S8_R",e[e.S8_R_NORM=Gi(xn.S8,Ri.R,pi.Normalized)]="S8_R_NORM",e[e.S8_RG_NORM=Gi(xn.S8,Ri.RG,pi.Normalized)]="S8_RG_NORM",e[e.S8_RGB_NORM=Gi(xn.S8,Ri.RGB,pi.Normalized)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=Gi(xn.S8,Ri.RGBA,pi.Normalized)]="S8_RGBA_NORM",e[e.S16_R=Gi(xn.S16,Ri.R,pi.None)]="S16_R",e[e.S16_RG=Gi(xn.S16,Ri.RG,pi.None)]="S16_RG",e[e.S16_RG_NORM=Gi(xn.S16,Ri.RG,pi.Normalized)]="S16_RG_NORM",e[e.S16_RGB_NORM=Gi(xn.S16,Ri.RGB,pi.Normalized)]="S16_RGB_NORM",e[e.S16_RGBA=Gi(xn.S16,Ri.RGBA,pi.None)]="S16_RGBA",e[e.S16_RGBA_NORM=Gi(xn.S16,Ri.RGBA,pi.Normalized)]="S16_RGBA_NORM",e[e.S32_R=Gi(xn.S32,Ri.R,pi.None)]="S32_R",e[e.S32_RG=Gi(xn.S32,Ri.RG,pi.None)]="S32_RG",e[e.S32_RGB=Gi(xn.S32,Ri.RGB,pi.None)]="S32_RGB",e[e.S32_RGBA=Gi(xn.S32,Ri.RGBA,pi.None)]="S32_RGBA",e[e.U16_RGBA_5551=Gi(xn.U16_PACKED_5551,Ri.RGBA,pi.Normalized)]="U16_RGBA_5551",e[e.U16_RGB_565=Gi(xn.U16_PACKED_565,Ri.RGB,pi.Normalized)]="U16_RGB_565",e[e.BC1=Gi(xn.BC1,Ri.RGBA,pi.Normalized)]="BC1",e[e.BC1_SRGB=Gi(xn.BC1,Ri.RGBA,pi.Normalized|pi.sRGB)]="BC1_SRGB",e[e.BC2=Gi(xn.BC2,Ri.RGBA,pi.Normalized)]="BC2",e[e.BC2_SRGB=Gi(xn.BC2,Ri.RGBA,pi.Normalized|pi.sRGB)]="BC2_SRGB",e[e.BC3=Gi(xn.BC3,Ri.RGBA,pi.Normalized)]="BC3",e[e.BC3_SRGB=Gi(xn.BC3,Ri.RGBA,pi.Normalized|pi.sRGB)]="BC3_SRGB",e[e.BC4_UNORM=Gi(xn.BC4_UNORM,Ri.R,pi.Normalized)]="BC4_UNORM",e[e.BC4_SNORM=Gi(xn.BC4_SNORM,Ri.R,pi.Normalized)]="BC4_SNORM",e[e.BC5_UNORM=Gi(xn.BC5_UNORM,Ri.RG,pi.Normalized)]="BC5_UNORM",e[e.BC5_SNORM=Gi(xn.BC5_SNORM,Ri.RG,pi.Normalized)]="BC5_SNORM",e[e.D24=Gi(xn.D24,Ri.R,pi.Depth)]="D24",e[e.D24_S8=Gi(xn.D24S8,Ri.RG,pi.Depth|pi.Stencil)]="D24_S8",e[e.D32F=Gi(xn.D32F,Ri.R,pi.Depth)]="D32F",e[e.D32F_S8=Gi(xn.D32FS8,Ri.RG,pi.Depth|pi.Stencil)]="D32F_S8",e[e.U8_RGB_RT=Gi(xn.U8,Ri.RGB,pi.RenderTarget|pi.Normalized)]="U8_RGB_RT",e[e.U8_RGBA_RT=Gi(xn.U8,Ri.RGBA,pi.RenderTarget|pi.Normalized)]="U8_RGBA_RT",e[e.U8_RGBA_RT_SRGB=Gi(xn.U8,Ri.RGBA,pi.RenderTarget|pi.Normalized|pi.sRGB)]="U8_RGBA_RT_SRGB"})(fr||(fr={}));function em(e){return e>>>8&255}function Ih(e){return e>>>16&255}function Pp(e){return e&255}function d0(e){switch(e){case xn.F32:case xn.U32:case xn.S32:return 4;case xn.U16:case xn.S16:case xn.F16:return 2;case xn.U8:case xn.S8:return 1;default:throw new Error("whoops")}}function p0(e){return d0(Ih(e))}function r2(e){return em(e)}function tx(e){var r=d0(Ih(e)),n=em(e);return r*n}function n2(e,r){return e&4294967040|r}function i2(e,r){return e&4294902015|r<<8}function v0(e){var r=Pp(e);if(r&pi.Depth)return tu.Depth;if(r&pi.Normalized)return tu.Float;var n=Ih(e);if(n===xn.F16||n===xn.F32)return tu.Float;if(n===xn.U8||n===xn.U16||n===xn.U32)return tu.Uint;if(n===xn.S8||n===xn.S16||n===xn.S32)return tu.Sint;throw new Error("whoops")}function Ea(e,r){if(r===void 0&&(r=""),!e)throw new Error("Assert fail: ".concat(r))}function Jd(e){if(e!=null)return e;throw new Error("Missing object")}function m0(e,r){return e.r===r.r&&e.g===r.g&&e.b===r.b&&e.a===r.a}function g0(e,r){e.r=r.r,e.g=r.g,e.b=r.b,e.a=r.a}function y0(e){var r=e.r,n=e.g,i=e.b,a=e.a;return{r,g:n,b:i,a}}function Tv(e,r,n,i){return i===void 0&&(i=1),{r:e,g:r,b:n,a:i}}var tm=Tv(0,0,0,0),a2=Tv(0,0,0,1),rx=Tv(1,1,1,0),o2=Tv(1,1,1,1),Dp=!0;function s2(e,r){r===void 0&&(r=Dp),r&&(e[10]=-e[10],e[14]=-e[14])}function u2(e,r){r===void 0&&(r=Dp),r&&(e[10]=-e[10],e[14]=-e[14]+1)}function nx(e,r){if(r===void 0&&(r=Dp),r)switch(e){case Fa.LESS:return Fa.GREATER;case Fa.LEQUAL:return Fa.GEQUAL;case Fa.GEQUAL:return Fa.LEQUAL;case Fa.GREATER:return Fa.LESS;default:return e}else return e}function l2(e,r){return r===void 0&&(r=Dp),r?1-e:e}function c2(e,r){return r===void 0&&(r=Dp),r?-e:e}function f2(e,r,n,i){if(i===void 0&&(i=Dp),n=nx(n,i),n===Fa.LESS)return e<r;if(n===Fa.LEQUAL)return e<=r;if(n===Fa.GREATER)return e>r;if(n===Fa.GEQUAL)return e>=r;throw new Error("whoops")}function rm(e){return!!(e&&!(e&e-1))}function kp(e,r){return e!=null?e:r}function ix(e){return e===void 0?null:e}function h2(e,r,n){e.length=r,e.fill(n)}function nm(e,r){var n=r-1;return e+n&~n}function d2(e,r){return((e+r-1)/r|0)*r}function ax(e,r,n){for(var i=0,a=e.length;i<a;){var s=i+(a-i>>>1),c=n(r,e[s]);c<0?a=s:i=s+1}return i}function p2(e,r,n){var i=ax(e,r,n);e.splice(i,0,r)}function v2(e,r,n){return n?e|=r:e&=~r,e}function ox(e,r){for(var n=new Array(e),i=0;i<e;i++)n[i]=r();return n}function sx(e,r){r===void 0&&(r=1);var n=e.split(`
`);return n.map(function(i,a){return"".concat(ux(""+(r+a),4," "),"  ").concat(i)}).join(`
`)}function ux(e,r,n){for(n===void 0&&(n="0");e.length<r;)e="".concat(n).concat(e);return e}function m2(e,r){for(var n=[],i=e;i<e+r;i++)n.push(i);return n}function _0(e,r){e.blendDstFactor=r.blendDstFactor,e.blendSrcFactor=r.blendSrcFactor,e.blendMode=r.blendMode}function im(e,r){return e===void 0&&(e={}),e.compare=r.compare,e.depthFailOp=r.depthFailOp,e.passOp=r.passOp,e.failOp=r.failOp,e.mask=r.mask,e}function b0(e,r){return e===void 0&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),_0(e.rgbBlendState,r.rgbBlendState),_0(e.alphaBlendState,r.alphaBlendState),e.channelWriteMask=r.channelWriteMask,e}function Zm(e,r){e.length!==r.length&&(e.length=r.length);for(var n=0;n<r.length;n++)e[n]=b0(e[n],r[n])}function lx(e,r){r.attachmentsState!==void 0&&Zm(e.attachmentsState,r.attachmentsState),e.blendConstant&&r.blendConstant&&g0(e.blendConstant,r.blendConstant),e.depthCompare=kp(r.depthCompare,e.depthCompare),e.depthWrite=kp(r.depthWrite,e.depthWrite),e.stencilWrite=kp(r.stencilWrite,e.stencilWrite),e.stencilFront&&r.stencilFront&&im(e.stencilFront,r.stencilFront),e.stencilBack&&r.stencilBack&&im(e.stencilBack,r.stencilBack),e.cullMode=kp(r.cullMode,e.cullMode),e.frontFace=kp(r.frontFace,e.frontFace),e.polygonOffset=kp(r.polygonOffset,e.polygonOffset)}function Lp(e){var r=Object.assign({},e);return r.attachmentsState=[],Zm(r.attachmentsState,e.attachmentsState),r.blendConstant=r.blendConstant&&y0(r.blendConstant),r.stencilFront=im(void 0,e.stencilFront),r.stencilBack=im(void 0,e.stencilBack),r}function cx(e,r){r.channelWriteMask!==void 0&&(e.channelWriteMask=r.channelWriteMask),r.rgbBlendMode!==void 0&&(e.rgbBlendState.blendMode=r.rgbBlendMode),r.alphaBlendMode!==void 0&&(e.alphaBlendState.blendMode=r.alphaBlendMode),r.rgbBlendSrcFactor!==void 0&&(e.rgbBlendState.blendSrcFactor=r.rgbBlendSrcFactor),r.alphaBlendSrcFactor!==void 0&&(e.alphaBlendState.blendSrcFactor=r.alphaBlendSrcFactor),r.rgbBlendDstFactor!==void 0&&(e.rgbBlendState.blendDstFactor=r.rgbBlendDstFactor),r.alphaBlendDstFactor!==void 0&&(e.alphaBlendState.blendDstFactor=r.alphaBlendDstFactor)}var x0={blendMode:Ll.ADD,blendSrcFactor:Ka.ONE,blendDstFactor:Ka.ZERO},ep={attachmentsState:[{channelWriteMask:Bl.ALL,rgbBlendState:x0,alphaBlendState:x0}],blendConstant:y0(tm),depthWrite:!0,depthCompare:Fa.LEQUAL,stencilWrite:!1,stencilFront:{compare:Fa.ALWAYS,passOp:eu.KEEP,depthFailOp:eu.KEEP,failOp:eu.KEEP},stencilBack:{compare:Fa.ALWAYS,passOp:eu.KEEP,depthFailOp:eu.KEEP,failOp:eu.KEEP},cullMode:of.NONE,frontFace:Sv.CCW,polygonOffset:!1};function fx(e,r){e===void 0&&(e=null),r===void 0&&(r=ep);var n=Lp(r);return e!==null&&lx(n,e),n}var g2=fx({depthCompare:Fa.ALWAYS,depthWrite:!1},ep);function y2(e,r){return e.attachmentsState===void 0&&(e.attachmentsState=[],Zm(e.attachmentsState,ep.attachmentsState)),cx(e.attachmentsState[0],r),e}var E0={texture:null,sampler:null,formatKind:tu.Float,dimension:Wa.TEXTURE_2D};function gd(e,r,n){if(e.length!==r.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],r[i]))return!1;return!0}function Bp(e,r){for(var n=Array(e.length),i=0;i<e.length;i++)n[i]=r(e[i]);return n}function hx(e,r){return e.texture===r.texture&&e.binding===r.binding}function S0(e,r){return e.buffer===r.buffer&&e.size===r.size&&e.binding===r.binding&&e.offset===r.offset}function dx(e,r){return e===null?r===null:r===null?!1:e.sampler===r.sampler&&e.texture===r.texture&&e.dimension===r.dimension&&e.formatKind===r.formatKind&&e.comparison===r.comparison}function px(e,r){return e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],e.storageBufferBindings=e.storageBufferBindings||[],e.storageTextureBindings=e.storageTextureBindings||[],r.samplerBindings=r.samplerBindings||[],r.uniformBufferBindings=r.uniformBufferBindings||[],r.storageBufferBindings=r.storageBufferBindings||[],r.storageTextureBindings=r.storageTextureBindings||[],!(e.samplerBindings.length!==r.samplerBindings.length||!gd(e.samplerBindings,r.samplerBindings,dx)||!gd(e.uniformBufferBindings,r.uniformBufferBindings,S0)||!gd(e.storageBufferBindings,r.storageBufferBindings,S0)||!gd(e.storageTextureBindings,r.storageTextureBindings,hx))}function T0(e,r){return e.blendMode==r.blendMode&&e.blendSrcFactor===r.blendSrcFactor&&e.blendDstFactor===r.blendDstFactor}function vx(e,r){return!(!T0(e.rgbBlendState,r.rgbBlendState)||!T0(e.alphaBlendState,r.alphaBlendState)||e.channelWriteMask!==r.channelWriteMask)}function am(e,r){return e.compare==r.compare&&e.depthFailOp===r.depthFailOp&&e.failOp===r.failOp&&e.passOp===r.passOp&&e.mask===r.mask}function mx(e,r){return!gd(e.attachmentsState,r.attachmentsState,vx)||e.blendConstant&&r.blendConstant&&!m0(e.blendConstant,r.blendConstant)||e.stencilFront&&r.stencilFront&&!am(e.stencilFront,r.stencilFront)||e.stencilBack&&r.stencilBack&&!am(e.stencilBack,r.stencilBack)?!1:e.depthCompare===r.depthCompare&&e.depthWrite===r.depthWrite&&e.stencilWrite===r.stencilWrite&&e.cullMode===r.cullMode&&e.frontFace===r.frontFace&&e.polygonOffset===r.polygonOffset}function A0(e,r){return e.id===r.id}function gx(e,r){return e===r}function yx(e,r){return!(e.topology!==r.topology||e.inputLayout!==r.inputLayout||e.sampleCount!==r.sampleCount||e.megaStateDescriptor&&r.megaStateDescriptor&&!mx(e.megaStateDescriptor,r.megaStateDescriptor)||!A0(e.program,r.program)||!gd(e.colorAttachmentFormats,r.colorAttachmentFormats,gx)||e.depthStencilAttachmentFormat!==r.depthStencilAttachmentFormat)}function _x(e,r){return e.offset===r.offset&&e.shaderLocation===r.shaderLocation&&e.format===r.format&&e.divisor===r.divisor}function bx(e,r){return(0,qf.Z)(e)?(0,qf.Z)(r):(0,qf.Z)(r)?!1:e.arrayStride===r.arrayStride&&e.stepMode===r.stepMode&&gd(e.attributes,r.attributes,_x)}function xx(e,r){return!(e.indexBufferFormat!==r.indexBufferFormat||!gd(e.vertexBufferDescriptors,r.vertexBufferDescriptors,bx)||!A0(e.program,r.program))}function _2(e,r){return e.addressModeU===r.addressModeU&&e.addressModeV===r.addressModeV&&e.minFilter===r.minFilter&&e.magFilter===r.magFilter&&e.mipmapFilter===r.mipmapFilter&&e.lodMinClamp===r.lodMinClamp&&e.lodMaxClamp===r.lodMaxClamp&&e.maxAnisotropy===r.maxAnisotropy&&e.compareFunction===r.compareFunction}function Ex(e){var r=e.sampler,n=e.texture,i=e.dimension,a=e.formatKind,s=e.comparison;return{sampler:r,texture:n,dimension:i,formatKind:a,comparison:s}}function C0(e){var r=e.buffer,n=e.size,i=e.binding,a=e.offset;return{binding:i,buffer:r,offset:a,size:n}}function Sx(e){var r=e.binding,n=e.texture;return{binding:r,texture:n}}function Tx(e){var r=e.samplerBindings&&Bp(e.samplerBindings,Ex),n=e.uniformBufferBindings&&Bp(e.uniformBufferBindings,C0),i=e.storageBufferBindings&&Bp(e.storageBufferBindings,C0),a=e.storageTextureBindings&&Bp(e.storageTextureBindings,Sx);return{samplerBindings:r,uniformBufferBindings:n,storageBufferBindings:i,storageTextureBindings:a,pipeline:e.pipeline}}function Ax(e){var r=e.inputLayout,n=e.program,i=e.topology,a=e.megaStateDescriptor&&Lp(e.megaStateDescriptor),s=e.colorAttachmentFormats.slice(),c=e.depthStencilAttachmentFormat,p=e.sampleCount;return{inputLayout:r,megaStateDescriptor:a,program:n,topology:i,colorAttachmentFormats:s,depthStencilAttachmentFormat:c,sampleCount:p}}function Cx(e){var r=e.shaderLocation,n=e.format,i=e.offset,a=e.divisor;return{shaderLocation:r,format:n,offset:i,divisor:a}}function Rx(e){if((0,qf.Z)(e))return e;var r=e.arrayStride,n=e.stepMode,i=Bp(e.attributes,Cx);return{arrayStride:r,stepMode:n,attributes:i}}function Mx(e){var r=Bp(e.vertexBufferDescriptors,Rx),n=e.indexBufferFormat,i=e.program;return{vertexBufferDescriptors:r,indexBufferFormat:n,program:i}}var ro,Ix=/([^[]*)(\[[0-9]+\])?/;function Ox(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};var r=e.match(Ix);if(!r||r.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:r[1],length:Number(r[2])||1,isArray:!!r[2]}}function jc(){var e=null;return function(r,n,i){var a=e!==i;return a&&(r.uniform1i(n,i),e=i),a}}function ru(e,r,n,i){var a=null,s=null;return function(c,p,g){var b=r(g,n),w=b.length,I=!1;if(a===null)a=new Float32Array(w),s=w,I=!0;else{Ea(s===w,"Uniform length cannot change.");for(var W=0;W<w;++W)if(b[W]!==a[W]){I=!0;break}}return I&&(i(c,e,p,b),a.set(b)),I}}function Mc(e,r,n,i){e[r](n,i)}function Xh(e,r,n,i){e[r](n,!1,i)}var Px={},Dx={},kx={},w0=[0];function jm(e,r,n,i){r===1&&typeof e=="boolean"&&(e=e?1:0),Number.isFinite(e)&&(w0[0]=e,e=w0);var a=e.length;if(e instanceof n)return e;var s=i[a];s||(s=new n(a),i[a]=s);for(var c=0;c<a;c++)s[c]=e[c];return s}function Rf(e,r){return jm(e,r,Float32Array,Px)}function yd(e,r){return jm(e,r,Int32Array,Dx)}function om(e,r){return jm(e,r,Uint32Array,kx)}var Lx=(ro={},ro[Ft.FLOAT]=ru.bind(null,"uniform1fv",Rf,1,Mc),ro[Ft.FLOAT_VEC2]=ru.bind(null,"uniform2fv",Rf,2,Mc),ro[Ft.FLOAT_VEC3]=ru.bind(null,"uniform3fv",Rf,3,Mc),ro[Ft.FLOAT_VEC4]=ru.bind(null,"uniform4fv",Rf,4,Mc),ro[Ft.INT]=ru.bind(null,"uniform1iv",yd,1,Mc),ro[Ft.INT_VEC2]=ru.bind(null,"uniform2iv",yd,2,Mc),ro[Ft.INT_VEC3]=ru.bind(null,"uniform3iv",yd,3,Mc),ro[Ft.INT_VEC4]=ru.bind(null,"uniform4iv",yd,4,Mc),ro[Ft.BOOL]=ru.bind(null,"uniform1iv",yd,1,Mc),ro[Ft.BOOL_VEC2]=ru.bind(null,"uniform2iv",yd,2,Mc),ro[Ft.BOOL_VEC3]=ru.bind(null,"uniform3iv",yd,3,Mc),ro[Ft.BOOL_VEC4]=ru.bind(null,"uniform4iv",yd,4,Mc),ro[Ft.FLOAT_MAT2]=ru.bind(null,"uniformMatrix2fv",Rf,4,Xh),ro[Ft.FLOAT_MAT3]=ru.bind(null,"uniformMatrix3fv",Rf,9,Xh),ro[Ft.FLOAT_MAT4]=ru.bind(null,"uniformMatrix4fv",Rf,16,Xh),ro[Ft.UNSIGNED_INT]=ru.bind(null,"uniform1uiv",om,1,Mc),ro[Ft.UNSIGNED_INT_VEC2]=ru.bind(null,"uniform2uiv",om,2,Mc),ro[Ft.UNSIGNED_INT_VEC3]=ru.bind(null,"uniform3uiv",om,3,Mc),ro[Ft.UNSIGNED_INT_VEC4]=ru.bind(null,"uniform4uiv",om,4,Mc),ro[Ft.FLOAT_MAT2x3]=ru.bind(null,"uniformMatrix2x3fv",Rf,6,Xh),ro[Ft.FLOAT_MAT2x4]=ru.bind(null,"uniformMatrix2x4fv",Rf,8,Xh),ro[Ft.FLOAT_MAT3x2]=ru.bind(null,"uniformMatrix3x2fv",Rf,6,Xh),ro[Ft.FLOAT_MAT3x4]=ru.bind(null,"uniformMatrix3x4fv",Rf,12,Xh),ro[Ft.FLOAT_MAT4x2]=ru.bind(null,"uniformMatrix4x2fv",Rf,8,Xh),ro[Ft.FLOAT_MAT4x3]=ru.bind(null,"uniformMatrix4x3fv",Rf,12,Xh),ro[Ft.SAMPLER_2D]=jc,ro[Ft.SAMPLER_CUBE]=jc,ro[Ft.SAMPLER_3D]=jc,ro[Ft.SAMPLER_2D_SHADOW]=jc,ro[Ft.SAMPLER_2D_ARRAY]=jc,ro[Ft.SAMPLER_2D_ARRAY_SHADOW]=jc,ro[Ft.SAMPLER_CUBE_SHADOW]=jc,ro[Ft.INT_SAMPLER_2D]=jc,ro[Ft.INT_SAMPLER_3D]=jc,ro[Ft.INT_SAMPLER_CUBE]=jc,ro[Ft.INT_SAMPLER_2D_ARRAY]=jc,ro[Ft.UNSIGNED_INT_SAMPLER_2D]=jc,ro[Ft.UNSIGNED_INT_SAMPLER_3D]=jc,ro[Ft.UNSIGNED_INT_SAMPLER_CUBE]=jc,ro[Ft.UNSIGNED_INT_SAMPLER_2D_ARRAY]=jc,ro);function R0(e,r,n){var i=Lx[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,e,r)}var Bx={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function Fx(e){return Object.prototype.toString.call(e)in Bx}function Av(e,r){return"#define ".concat(e," ").concat(r)}function Nx(e){var r={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(n,i,a){var s=Number(a);return r[i]=isNaN(s)?a:s,""}),r}function Ux(e,r){var n=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(i,a,s){var c=Number(a);return n.push({location:isNaN(c)?r[a]:c,name:s}),""}),n}function b2(e){var r=[],n=[];return e.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,function(i,a,s){var c=[];return s.trim().replace(`\r
`,`
`).split(`
`).forEach(function(p){var g=__read(p.trim().split(/\s+/),2),b=g[0],w=g[1];c.push({type:b.trim(),name:w.replace(";","").trim()})}),n.push({type:a.trim(),uniforms:c}),""}),e.replace(/\s*uniform(?:\s+)(?:\w+)(?:\s?){([^]*?)};?/g,function(i,a){return a.trim().replace(`\r
`,`
`).split(`
`).forEach(function(s){var c=s.trim().split(" "),p=c[0]||"",g=c[1]||"",b=g.indexOf("[")>-1;if(g=g.replace(";","").replace("[","").trim(),!p.startsWith("#")){if(p){var w=n.find(function(pe){return p===pe.type});if(w)if(b)for(var I=function(pe){w.uniforms.forEach(function(Me){r.push("".concat(g,"[").concat(pe,"].").concat(Me.name))})},W=0;W<5;W++)I(W);else w.uniforms.forEach(function(pe){r.push("".concat(g,".").concat(pe.name))})}g&&r.push(g)}}),""}),r}function M0(e){if(e===void 0)return null;var r=/binding\s*=\s*(\d+)/.exec(e);if(r!==null){var n=parseInt(r[1],10);if(!Number.isNaN(n))return n}return null}function zx(e){var r="",n=e;return[n,r]}function _d(e,r,n,i,a){var s;i===void 0&&(i=null),a===void 0&&(a=!0);var c=e.glslVersion==="#version 100",p=r==="frag"&&((s=n.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||s===void 0?void 0:s.length)>1,g=n.replace(`\r
`,`
`).split(`
`).map(function(Ir){return Ir.replace(/[/][/].*$/,"")}).filter(function(Ir){var mr=!Ir||/^\s+$/.test(Ir);return!mr}),b="";i!==null&&(b=Object.keys(i).map(function(Ir){return Av(Ir,i[Ir])}).join(`
`));var w=g.find(function(Ir){return Ir.startsWith("precision")})||"precision mediump float;",I=a?g.filter(function(Ir){return!Ir.startsWith("precision")}).join(`
`):g.join(`
`),W="";if(e.viewportOrigin===Mh.UPPER_LEFT&&(W+="".concat(Av("VIEWPORT_ORIGIN_TL","1"),`
`)),e.clipSpaceNearZ===Op.ZERO&&(W+="".concat(Av("CLIPSPACE_NEAR_ZERO","1"),`
`)),e.explicitBindingLocations){var pe=0,Me=0,Fe=0;I=I.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(Ir,mr,sn,ti){var Bi=sn?"".concat(sn,", "):"";return"layout(".concat(Bi,"set = ").concat(pe,", binding = ").concat(Me++,") uniform ").concat(ti)}),pe++,Me=0,Ea(e.separateSamplerTextures),I=I.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(Ir,mr,sn,ti,Bi){var ai=M0(sn);ai===null&&(ai=Me++);var ra=(0,bi.CR)(zx(ti),2),fa=ra[0],nu=ra[1];return r==="frag"?`
layout(set = `.concat(pe,", binding = ").concat(ai*2+0,") uniform texture").concat(fa," T_").concat(Bi,`;
layout(set = `).concat(pe,", binding = ").concat(ai*2+1,") uniform sampler").concat(nu," S_").concat(Bi,";").trim():""}),I=I.replace(r==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(Ir,mr){return"layout(location = ".concat(Fe++,") ").concat(mr)}),W+="".concat(Av("gl_VertexID","gl_VertexIndex"),`
`),W+="".concat(Av("gl_InstanceID","gl_InstanceIndex"),`
`),w=w.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var ut=0;I=I.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(Ir,mr,sn,ti,Bi){var ai=M0(sn);return ai===null&&(ai=ut++),"uniform sampler".concat(ti," ").concat(Bi,"; // BINDING=").concat(ai)})}if(e.separateSamplerTextures)I=I.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(Ir,mr,sn){return"sampler".concat(mr,"(T_").concat(sn,", S_").concat(sn,")")}),I=I.replace(/\bTEXTURE\((.*?)\)/g,function(Ir,mr){return"T_".concat(mr)});else{var Ot=[];I=I.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(Ir,mr,sn){return Ot.push([sn,mr]),sn}),c&&Ot.forEach(function(Ir){var mr=(0,bi.CR)(Ir,2),sn=mr[0],ti=mr[1];I=I.replace(new RegExp("texture\\(".concat(sn),"g"),function(){return"texture".concat(ti,"(").concat(sn)})}),I=I.replace(/\bTEXTURE\((.*?)\)/g,function(Ir,mr){return mr})}var Bt="".concat(c?"":e.glslVersion,`
`).concat(c&&p?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(c&&r==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(a?w:"",`
`).concat(W||"").concat(b?b+`
`:"",`
`).concat(I,`
`).trim();if(e.explicitBindingLocations&&r==="frag"&&(Bt=Bt.replace(/^\b(out)\b/g,function(Ir,mr){return"layout(location = 0) ".concat(mr)})),c){if(r==="frag"&&(Bt=Bt.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(Ir,mr,sn){return"varying ".concat(mr," ").concat(sn,`;
`)})),r==="vert"&&(Bt=Bt.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(Ir,mr,sn){return"varying ".concat(mr," ").concat(sn,`;
`)}),Bt=Bt.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(Ir,mr,sn){return"attribute ".concat(mr," ").concat(sn,`;
`)})),Bt=Bt.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(Ir,mr){return mr.trim().replace(/^.*$/gm,function(sn){var ti=sn.trim();return ti.startsWith("#")?ti:sn?"uniform ".concat(ti):""})}),r==="frag")if(p){var ir=[];Bt=Bt.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(Ir,mr){return ir.push(mr),"vec4 ".concat(mr,`;
`)});var xr=Bt.lastIndexOf("}");Bt=Bt.substring(0,xr)+`
    `.concat(ir.map(function(Ir,mr){return"gl_FragData[".concat(mr,"] = ").concat(Ir,`;
    `)}).join(`
`))+Bt.substring(xr)}else{var qr;if(Bt=Bt.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(Ir,mr,sn){return qr=sn,"".concat(mr," ").concat(sn,`;
`)}),qr){var xr=Bt.lastIndexOf("}");Bt=Bt.substring(0,xr)+`
  gl_FragColor = vec4(`.concat(qr,`);
`)+Bt.substring(xr)}}Bt=Bt.replace(/^\s*layout\((.*)\)/gm,"")}return Bt}function x2(e,r,n,i){i===void 0&&(i=null);var a=_d(e,"vert",r,i),s=_d(e,"frag",n,i);return{vert:r,frag:n,preprocessedVert:a,preprocessedFrag:s}}var Qf=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this)||this;return s.id=i,s.device=a,s.device.resourceCreationTracker!==null&&s.device.resourceCreationTracker.trackResourceCreated(s),s}return r.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},r}(f0),Zx=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.Bindings;var p=s.uniformBufferBindings,g=s.samplerBindings;return c.uniformBufferBindings=p||[],c.samplerBindings=g||[],c.bindingLayouts=c.createBindingLayouts(),c}return r.prototype.createBindingLayouts=function(){var n=0,i=0,a=[],s=this.uniformBufferBindings.length,c=this.samplerBindings.length;return a.push({firstUniformBuffer:n,numUniformBuffers:s,firstSampler:i,numSamplers:c}),n+=s,i+=c,{numUniformBuffers:n,numSamplers:i,bindingLayoutTables:a}},r}(Qf);function Li(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}function I0(e){var r=Ih(e);switch(r){case xn.BC1:case xn.BC2:case xn.BC3:case xn.BC4_UNORM:case xn.BC4_SNORM:case xn.BC5_UNORM:case xn.BC5_SNORM:return!0;default:return!1}}function O0(e){var r=Pp(e);if(r&pi.Normalized)return!1;var n=Ih(e);return n===xn.S8||n===xn.S16||n===xn.S32||n===xn.U8||n===xn.U16||n===xn.U32}function jx(e){switch(e){case mh.STATIC:return Ft.STATIC_DRAW;case mh.DYNAMIC:return Ft.DYNAMIC_DRAW}}function P0(e){if(e&as.INDEX)return Ft.ELEMENT_ARRAY_BUFFER;if(e&as.VERTEX)return Ft.ARRAY_BUFFER;if(e&as.UNIFORM)return Ft.UNIFORM_BUFFER}function Vx(e){switch(e){case Uu.TRIANGLES:return Ft.TRIANGLES;case Uu.POINTS:return Ft.POINTS;case Uu.TRIANGLE_STRIP:return Ft.TRIANGLE_STRIP;case Uu.LINES:return Ft.LINES;case Uu.LINE_STRIP:return Ft.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function Hx(e){switch(e){case xn.U8:return Ft.UNSIGNED_BYTE;case xn.U16:return Ft.UNSIGNED_SHORT;case xn.U32:return Ft.UNSIGNED_INT;case xn.S8:return Ft.BYTE;case xn.S16:return Ft.SHORT;case xn.S32:return Ft.INT;case xn.F16:return Ft.HALF_FLOAT;case xn.F32:return Ft.FLOAT;default:throw new Error("whoops")}}function $x(e){switch(e){case Ri.R:return 1;case Ri.RG:return 2;case Ri.RGB:return 3;case Ri.RGBA:return 4;default:return 1}}function Wx(e){var r=Ih(e),n=em(e),i=Pp(e),a=Hx(r),s=$x(n),c=!!(i&pi.Normalized);return{size:s,type:a,normalized:c}}function Gx(e){switch(e){case fr.U8_R:return Ft.UNSIGNED_BYTE;case fr.U16_R:return Ft.UNSIGNED_SHORT;case fr.U32_R:return Ft.UNSIGNED_INT;default:throw new Error("whoops")}}function Cv(e){switch(e){case Zc.CLAMP_TO_EDGE:return Ft.CLAMP_TO_EDGE;case Zc.REPEAT:return Ft.REPEAT;case Zc.MIRRORED_REPEAT:return Ft.MIRRORED_REPEAT;default:throw new Error("whoops")}}function sm(e,r){if(r===ml.LINEAR&&e===mu.BILINEAR)return Ft.LINEAR_MIPMAP_LINEAR;if(r===ml.LINEAR&&e===mu.POINT)return Ft.NEAREST_MIPMAP_LINEAR;if(r===ml.NEAREST&&e===mu.BILINEAR)return Ft.LINEAR_MIPMAP_NEAREST;if(r===ml.NEAREST&&e===mu.POINT)return Ft.NEAREST_MIPMAP_NEAREST;if(r===ml.NO_MIP&&e===mu.BILINEAR)return Ft.LINEAR;if(r===ml.NO_MIP&&e===mu.POINT)return Ft.NEAREST;throw new Error("Unknown texture filter mode")}function Fp(e,r){r===void 0&&(r=0);var n=e;return n.gl_buffer_pages[r/n.pageByteSize|0]}function Np(e){var r=e;return r.gl_texture}function Vm(e){var r=e;return r.gl_sampler}function wv(e,r){e.name=r,e.__SPECTOR_Metadata={name:r}}function D0(e,r){for(var n=[];;){var i=r.exec(e);if(!i)break;n.push(i)}return n}function bd(e){return e.blendMode==Ll.ADD&&e.blendSrcFactor==Ka.ONE&&e.blendDstFactor===Ka.ZERO}function Xx(e){switch(e){case Jv.OcclusionConservative:return Ft.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function Yx(e){if(e===Wa.TEXTURE_2D)return Ft.TEXTURE_2D;if(e===Wa.TEXTURE_2D_ARRAY)return Ft.TEXTURE_2D_ARRAY;if(e===Wa.TEXTURE_CUBE_MAP)return Ft.TEXTURE_CUBE_MAP;if(e===Wa.TEXTURE_3D)return Ft.TEXTURE_3D;throw new Error("whoops")}function Hm(e,r,n,i){return!(e%n!==0||r%i!==0)}var Kx=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.Buffer;var p=s.viewOrSize,g=s.usage,b=s.hint,w=b===void 0?mh.STATIC:b,I=a.uniformBufferMaxPageByteSize,W=a.gl,pe=g&as.UNIFORM;pe||(Li(W)?W.bindVertexArray(null):a.OES_vertex_array_object.bindVertexArrayOES(null));var Me=(0,Ip.Z)(p)?nm(p,4):nm(p.byteLength,4);c.gl_buffer_pages=[];var Fe;if(pe){for(var ut=Me;ut>0;)c.gl_buffer_pages.push(c.createBufferPage(Math.min(ut,I),g,w)),ut-=I;Fe=I}else c.gl_buffer_pages.push(c.createBufferPage(Me,g,w)),Fe=Me;return c.pageByteSize=Fe,c.byteSize=Me,c.usage=g,c.gl_target=P0(g),(0,Ip.Z)(p)||c.setSubData(0,new Uint8Array(p.buffer)),pe||(Li(W)?W.bindVertexArray(c.device.currentBoundVAO):a.OES_vertex_array_object.bindVertexArrayOES(c.device.currentBoundVAO)),c}return r.prototype.setSubData=function(n,i,a,s){a===void 0&&(a=0),s===void 0&&(s=i.byteLength-a);for(var c=this.device.gl,p=this.pageByteSize,g=n+s,b=n,w=n%p;b<g;){var I=Li(c)?c.COPY_WRITE_BUFFER:this.gl_target,W=Fp(this,b);if(W.ubo)return;c.bindBuffer(I,W),Li(c)?c.bufferSubData(I,w,i,a,Math.min(g-b,p)):c.bufferSubData(I,w,i),b+=p,w=0,a+=p,this.device.debugGroupStatisticsBufferUpload()}},r.prototype.destroy=function(){e.prototype.destroy.call(this);for(var n=0;n<this.gl_buffer_pages.length;n++)this.gl_buffer_pages[n].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[n]);this.gl_buffer_pages=[]},r.prototype.createBufferPage=function(n,i,a){var s=this.device.gl,c=i&as.UNIFORM;if(!Li(s)&&c)return{ubo:!0};var p=this.device.ensureResourceExists(s.createBuffer()),g=P0(i),b=jx(a);return s.bindBuffer(g,p),s.bufferData(g,n,b),p},r}(Qf),qx=function(e){(0,bi.ZT)(r,e);function r(n){var i,a,s,c,p=n.id,g=n.device,b=n.descriptor,w,I=e.call(this,{id:p,device:g})||this;I.type=mo.InputLayout;var W=b.vertexBufferDescriptors,pe=b.indexBufferFormat,Me=b.program;Ea(pe===fr.U16_R||pe===fr.U32_R||pe===null);var Fe=pe!==null?Gx(pe):null,ut=pe!==null?p0(pe):null,Ot=I.device.gl,Bt=I.device.ensureResourceExists(Li(Ot)?Ot.createVertexArray():g.OES_vertex_array_object.createVertexArrayOES());Li(Ot)?Ot.bindVertexArray(Bt):g.OES_vertex_array_object.bindVertexArrayOES(Bt),Ot.bindBuffer(Ot.ARRAY_BUFFER,Fp(I.device.fallbackVertexBuffer));try{for(var ir=(0,bi.XA)(b.vertexBufferDescriptors),xr=ir.next();!xr.done;xr=ir.next()){var qr=xr.value,Ir=qr.stepMode,mr=qr.attributes;try{for(var sn=(s=void 0,(0,bi.XA)(mr)),ti=sn.next();!ti.done;ti=sn.next()){var Bi=ti.value,ai=Bi.shaderLocation,ra=Bi.format,fa=Bi.divisor,nu=fa===void 0?1:fa,yl=Li(Ot)?ai:(w=Me.attributes[ai])===null||w===void 0?void 0:w.location,_l=Wx(ra);if(Bi.vertexFormat=_l,!(0,qf.Z)(yl)){O0(ra);var Mf=_l.size,uf=_l.type,pc=_l.normalized;Ot.vertexAttribPointer(yl,Mf,uf,pc,0,0),Ir===Qd.INSTANCE&&(Li(Ot)?Ot.vertexAttribDivisor(yl,nu):g.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(yl,nu)),Ot.enableVertexAttribArray(yl)}}}catch(Jf){s={error:Jf}}finally{try{ti&&!ti.done&&(c=sn.return)&&c.call(sn)}finally{if(s)throw s.error}}}}catch(Jf){i={error:Jf}}finally{try{xr&&!xr.done&&(a=ir.return)&&a.call(ir)}finally{if(i)throw i.error}}return Li(Ot)?Ot.bindVertexArray(null):g.OES_vertex_array_object.bindVertexArrayOES(null),I.vertexBufferDescriptors=W,I.vao=Bt,I.indexBufferFormat=pe,I.indexBufferType=Fe,I.indexBufferCompByteSize=ut,I.program=Me,I}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Li(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},r}(Qf),$m=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=n.fake,p=e.call(this,{id:i,device:a})||this;p.type=mo.Texture,s=(0,bi.pi)({dimension:Wa.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},s);var g=p.device.gl,b,w,I=p.clampmipLevelCount(s);if(p.immutable=s.usage===hc.RENDER_TARGET,p.pixelStore=s.pixelStore,p.format=s.format,p.dimension=s.dimension,p.formatKind=v0(s.format),p.width=s.width,p.height=s.height,p.depthOrArrayLayers=s.depthOrArrayLayers,p.mipmaps=I>=1,!c){w=p.device.ensureResourceExists(g.createTexture());var W=p.device.translateTextureType(s.format),pe=p.device.translateTextureInternalFormat(s.format);if(p.device.setActiveTexture(g.TEXTURE0),p.device.currentTextures[0]=null,p.preprocessImage(),s.dimension===Wa.TEXTURE_2D){if(b=Ft.TEXTURE_2D,g.bindTexture(b,w),p.immutable)if(Li(g))g.texStorage2D(b,I,pe,s.width,s.height);else{var Me=(pe===Ft.DEPTH_COMPONENT||p.isNPOT(),0);(p.format===fr.D32F||p.format===fr.D24_S8)&&!Li(g)&&!a.WEBGL_depth_texture||(g.texImage2D(b,Me,pe,s.width,s.height,0,pe,W,null),p.mipmaps&&(p.mipmaps=!1,g.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_MIN_FILTER,Ft.LINEAR),g.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_WRAP_S,Ft.CLAMP_TO_EDGE),g.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_WRAP_T,Ft.CLAMP_TO_EDGE)))}Ea(s.depthOrArrayLayers===1)}else if(s.dimension===Wa.TEXTURE_2D_ARRAY)b=Ft.TEXTURE_2D_ARRAY,g.bindTexture(b,w),p.immutable&&Li(g)&&g.texStorage3D(b,I,pe,s.width,s.height,s.depthOrArrayLayers);else if(s.dimension===Wa.TEXTURE_3D)b=Ft.TEXTURE_3D,g.bindTexture(b,w),p.immutable&&Li(g)&&g.texStorage3D(b,I,pe,s.width,s.height,s.depthOrArrayLayers);else if(s.dimension===Wa.TEXTURE_CUBE_MAP)b=Ft.TEXTURE_CUBE_MAP,g.bindTexture(b,w),p.immutable&&Li(g)&&g.texStorage2D(b,I,pe,s.width,s.height),Ea(s.depthOrArrayLayers===6);else throw new Error("whoops")}return p.gl_texture=w,p.gl_target=b,p.mipLevelCount=I,p}return r.prototype.setImageData=function(n,i){i===void 0&&(i=0);var a=this.device.gl;I0(this.format);var s=this.gl_target===Ft.TEXTURE_3D||this.gl_target===Ft.TEXTURE_2D_ARRAY,c=this.gl_target===Ft.TEXTURE_CUBE_MAP,p=Fx(n[0]);this.device.setActiveTexture(a.TEXTURE0),this.device.currentTextures[0]=null;var g=n[0],b,w;p?(b=this.width,w=this.height):(b=g.width,w=g.height,this.width=b,this.height=w),a.bindTexture(this.gl_target,this.gl_texture);var I=this.device.translateTextureFormat(this.format),W=Li(a)?this.device.translateInternalTextureFormat(this.format):I,pe=this.device.translateTextureType(this.format);this.preprocessImage();for(var Me=0;Me<this.depthOrArrayLayers;Me++){var Fe=n[Me],ut=this.gl_target;c&&(ut=Ft.TEXTURE_CUBE_MAP_POSITIVE_X+Me%6),this.immutable?a.texSubImage2D(ut,i,0,0,b,w,I,pe,Fe):Li(a)?s?a.texImage3D(ut,i,W,b,w,this.depthOrArrayLayers,0,I,pe,Fe):a.texImage2D(ut,i,W,b,w,0,I,pe,Fe):p?a.texImage2D(ut,i,I,b,w,0,I,pe,Fe):a.texImage2D(ut,i,I,I,pe,Fe)}this.mipmaps&&this.generateMipmap(s)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteTexture(Np(this))},r.prototype.clampmipLevelCount=function(n){if(n.dimension===Wa.TEXTURE_2D_ARRAY&&n.depthOrArrayLayers>1){var i=Ih(n.format);if(i===xn.BC1)for(var a=n.width,s=n.height,c=0;c<n.mipLevelCount;c++){if(a<=2||s<=2)return c-1;a=Math.max(a/2|0,1),s=Math.max(s/2|0,1)}}return n.mipLevelCount},r.prototype.preprocessImage=function(){var n=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&n.pixelStorei(Ft.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&n.pixelStorei(Ft.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&n.pixelStorei(Ft.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},r.prototype.generateMipmap=function(n){n===void 0&&(n=!1);var i=this.device.gl;return!Li(i)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(i.bindTexture(this.gl_target,this.gl_texture),n?(i.texParameteri(this.gl_target,Ft.TEXTURE_BASE_LEVEL,0),i.texParameteri(this.gl_target,Ft.TEXTURE_MAX_LEVEL,Math.log2(this.width)),i.texParameteri(this.gl_target,Ft.TEXTURE_MIN_FILTER,Ft.LINEAR_MIPMAP_LINEAR),i.texParameteri(this.gl_target,Ft.TEXTURE_MAG_FILTER,Ft.LINEAR)):i.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_MIN_FILTER,Ft.NEAREST_MIPMAP_LINEAR),i.generateMipmap(this.gl_target),i.bindTexture(this.gl_target,null)),this)},r.prototype.isNPOT=function(){var n=this.device.gl;return Li(n)?!1:!rm(this.width)||!rm(this.height)},r}(Qf),Qx=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.RenderTarget,c.gl_renderbuffer=null,c.texture=null;var p=c.device.gl,g=s.format,b=s.width,w=s.height,I=s.sampleCount,W=I===void 0?1:I,pe=s.texture,Me=!1;if((g===fr.D32F||g===fr.D24_S8)&&pe&&!Li(p)&&!a.WEBGL_depth_texture&&(pe.destroy(),c.texture=null,Me=!0),!Me&&pe)c.texture=pe;else{c.gl_renderbuffer=c.device.ensureResourceExists(p.createRenderbuffer()),p.bindRenderbuffer(p.RENDERBUFFER,c.gl_renderbuffer);var Fe=c.device.translateTextureInternalFormat(g,!0);Li(p)&&W>1?p.renderbufferStorageMultisample(Ft.RENDERBUFFER,W,Fe,b,w):p.renderbufferStorage(Ft.RENDERBUFFER,Fe,b,w)}return c.format=g,c.width=b,c.height=w,c.sampleCount=W,c}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},r}(Qf),sf;(function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"})(sf||(sf={}));var Jx=function(e){(0,bi.ZT)(r,e);function r(n,i){var a=n.id,s=n.device,c=n.descriptor,p=e.call(this,{id:a,device:s})||this;p.rawVertexGLSL=i,p.type=mo.Program,p.uniformSetters={},p.attributes=[];var g=p.device.gl;return p.descriptor=c,p.gl_program=p.device.ensureResourceExists(g.createProgram()),p.gl_shader_vert=null,p.gl_shader_frag=null,p.compileState=sf.NeedsCompile,p.tryCompileProgram(),p}return r.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},r.prototype.tryCompileProgram=function(){Ea(this.compileState===sf.NeedsCompile);var n=this.descriptor,i=n.vertex,a=n.fragment,s=this.device.gl;i!=null&&i.glsl&&(a!=null&&a.glsl)&&(this.gl_shader_vert=this.compileShader(i.postprocess?i.postprocess(i.glsl):i.glsl,s.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(a.postprocess?a.postprocess(a.glsl):a.glsl,s.FRAGMENT_SHADER),s.attachShader(this.gl_program,this.gl_shader_vert),s.attachShader(this.gl_program,this.gl_shader_frag),s.linkProgram(this.gl_program),this.compileState=sf.Compiling,Li(s)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},r.prototype.readAttributesFromLinkedProgram=function(){for(var n,i=this.device.gl,a=i.getProgramParameter(this.gl_program,i.ACTIVE_ATTRIBUTES),s=Nx(this.descriptor.vertex.glsl),c=Ux(this.rawVertexGLSL,s),p=function(w){var I=i.getActiveAttrib(g.gl_program,w),W=I.name,pe=I.type,Me=I.size,Fe=i.getAttribLocation(g.gl_program,W),ut=(n=c.find(function(Ot){return Ot.name===W}))===null||n===void 0?void 0:n.location;Fe>=0&&!(0,qf.Z)(ut)&&(g.attributes[ut]={name:W,location:Fe,type:pe,size:Me})},g=this,b=0;b<a;b++)p(b)},r.prototype.readUniformLocationsFromLinkedProgram=function(){for(var n=this.device.gl,i=n.getProgramParameter(this.gl_program,n.ACTIVE_UNIFORMS),a=0;a<i;a++){var s=n.getActiveUniform(this.gl_program,a),c=Ox(s.name).name,p=n.getUniformLocation(this.gl_program,c);if(this.uniformSetters[c]=R0(n,p,s),s&&s.size>1)for(var g=0;g<s.size;g++)p=n.getUniformLocation(this.gl_program,"".concat(c,"[").concat(g,"]")),this.uniformSetters["".concat(c,"[").concat(g,"]")]=R0(n,p,s)}},r.prototype.compileShader=function(n,i){var a=this.device.gl,s=this.device.ensureResourceExists(a.createShader(i));return a.shaderSource(s,n),a.compileShader(s),s},r.prototype.setUniformsLegacy=function(n){n===void 0&&(n={});var i=this.device.gl;if(!Li(i)){var a=!1;for(var s in n){a||(i.useProgram(this.gl_program),a=!0);var c=n[s],p=this.uniformSetters[s];if(p){var g=c;g instanceof $m&&(g=g.textureIndex),p(g)}}}return this},r}(Qf),eE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.QueryPool;var p=c.device.gl;if(Li(p)){var g=s.elemCount,b=s.type;c.gl_query=ox(g,function(){return c.device.ensureResourceExists(p.createQuery())}),c.gl_query_type=Xx(b)}return c}return r.prototype.queryResultOcclusion=function(n){var i=this.device.gl;if(Li(i)){var a=this.gl_query[n];return i.getQueryParameter(a,i.QUERY_RESULT_AVAILABLE)?!!i.getQueryParameter(a,i.QUERY_RESULT):null}return null},r.prototype.destroy=function(){e.prototype.destroy.call(this);var n=this.device.gl;if(Li(n))for(var i=0;i<this.gl_query.length;i++)n.deleteQuery(this.gl_query[i])},r}(Qf),tE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this,{id:i,device:a})||this;return s.type=mo.Readback,s.gl_pbo=null,s.gl_sync=null,s}return r.prototype.clientWaitAsync=function(n,i,a){i===void 0&&(i=0),a===void 0&&(a=10);var s=this.device.gl;return new Promise(function(c,p){function g(){var b=s.clientWaitSync(n,i,0);if(b==s.WAIT_FAILED){p();return}if(b==s.TIMEOUT_EXPIRED){setTimeout(g,(0,Jb.Z)(a,0,s.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}c()}g()})},r.prototype.getBufferSubDataAsync=function(n,i,a,s,c,p){return(0,bi.mG)(this,void 0,void 0,function(){var g;return(0,bi.Jh)(this,function(b){switch(b.label){case 0:return g=this.device.gl,Li(g)?(this.gl_sync=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0),g.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return b.sent(),g.bindBuffer(n,i),g.getBufferSubData(n,a,s,c,p),g.bindBuffer(n,null),[2,s];case 2:return[2]}})})},r.prototype.readTexture=function(n,i,a,s,c,p,g,b){return g===void 0&&(g=0),b===void 0&&(b=p.byteLength||0),(0,bi.mG)(this,void 0,void 0,function(){var w,I,W,pe,Me;return(0,bi.Jh)(this,function(Fe){return w=this.device.gl,I=n,W=this.device.translateTextureFormat(I.format),pe=this.device.translateTextureType(I.format),Me=tx(I.format),Li(w)?(this.gl_pbo=this.device.ensureResourceExists(w.createBuffer()),w.bindBuffer(w.PIXEL_PACK_BUFFER,this.gl_pbo),w.bufferData(w.PIXEL_PACK_BUFFER,b,w.STREAM_READ),w.bindBuffer(w.PIXEL_PACK_BUFFER,null),w.bindFramebuffer(Ft.READ_FRAMEBUFFER,this.device.readbackFramebuffer),w.framebufferTexture2D(Ft.READ_FRAMEBUFFER,Ft.COLOR_ATTACHMENT0,Ft.TEXTURE_2D,I.gl_texture,0),w.bindBuffer(w.PIXEL_PACK_BUFFER,this.gl_pbo),w.readPixels(i,a,s,c,W,pe,g*Me),w.bindBuffer(w.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(w.PIXEL_PACK_BUFFER,this.gl_pbo,0,p,g,0)]):[2,this.readTextureSync(n,i,a,s,c,p,g,b)]})})},r.prototype.readTextureSync=function(n,i,a,s,c,p,g,b){b===void 0&&(b=p.byteLength||0);var w=this.device.gl,I=n,W=this.device.translateTextureType(I.format);return w.bindFramebuffer(Ft.FRAMEBUFFER,this.device.readbackFramebuffer),w.framebufferTexture2D(Ft.FRAMEBUFFER,Ft.COLOR_ATTACHMENT0,Ft.TEXTURE_2D,I.gl_texture,0),w.pixelStorei(w.PACK_ALIGNMENT,4),w.readPixels(i,a,s,c,w.RGBA,W,p),p},r.prototype.readBuffer=function(n,i,a,s,c){return(0,bi.mG)(this,void 0,void 0,function(){var p;return(0,bi.Jh)(this,function(g){return p=this.device.gl,Li(p)?[2,this.getBufferSubDataAsync(p.ARRAY_BUFFER,Fp(n,i),i,a,s,c)]:[2,Promise.reject()]})})},r.prototype.destroy=function(){e.prototype.destroy.call(this),Li(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},r}(Qf),rE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,p,g=e.call(this,{id:i,device:a})||this;return g.type=mo.RenderPipeline,g.drawMode=Vx((c=s.topology)!==null&&c!==void 0?c:Uu.TRIANGLES),g.program=s.program,g.inputLayout=s.inputLayout,g.megaState=(0,bi.pi)((0,bi.pi)({},Lp(ep)),s.megaStateDescriptor),g.colorAttachmentFormats=s.colorAttachmentFormats.slice(),g.depthStencilAttachmentFormat=s.depthStencilAttachmentFormat,g.sampleCount=(p=s.sampleCount)!==null&&p!==void 0?p:1,g}return r}(Qf),nE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;return c.type=mo.ComputePipeline,c.descriptor=s,c}return r}(Qf),iE=function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(r){this.creationStacks.set(r,new Error().stack),this.liveObjects.add(r)},e.prototype.trackResourceDestroyed=function(r){this.deletionStacks.has(r)&&console.warn("Object double freed:",r,`

Creation stack: `,this.creationStacks.get(r),`

Deletion stack: `,this.deletionStacks.get(r),`

This stack: `,new Error().stack),this.deletionStacks.set(r,new Error().stack),this.liveObjects.delete(r)},e.prototype.checkForLeaks=function(){var r,n;try{for(var i=(0,bi.XA)(this.liveObjects.values()),a=i.next();!a.done;a=i.next()){var s=a.value;console.warn("Object leaked:",s,"Creation stack:",this.creationStacks.get(s))}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.setResourceLeakCheck=function(r,n){n?this.liveObjects.add(r):this.liveObjects.delete(r)},e}(),aE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,p,g=e.call(this,{id:i,device:a})||this;g.type=mo.Sampler;var b=g.device.gl;if(Li(b)){var w=g.device.ensureResourceExists(b.createSampler());b.samplerParameteri(w,Ft.TEXTURE_WRAP_S,Cv(s.addressModeU)),b.samplerParameteri(w,Ft.TEXTURE_WRAP_T,Cv(s.addressModeV)),b.samplerParameteri(w,Ft.TEXTURE_WRAP_R,Cv((c=s.addressModeW)!==null&&c!==void 0?c:s.addressModeU)),b.samplerParameteri(w,Ft.TEXTURE_MIN_FILTER,sm(s.minFilter,s.mipmapFilter)),b.samplerParameteri(w,Ft.TEXTURE_MAG_FILTER,sm(s.magFilter,ml.NO_MIP)),s.lodMinClamp!==void 0&&b.samplerParameterf(w,Ft.TEXTURE_MIN_LOD,s.lodMinClamp),s.lodMaxClamp!==void 0&&b.samplerParameterf(w,Ft.TEXTURE_MAX_LOD,s.lodMaxClamp),s.compareFunction!==void 0&&(b.samplerParameteri(w,b.TEXTURE_COMPARE_MODE,b.COMPARE_REF_TO_TEXTURE),b.samplerParameteri(w,b.TEXTURE_COMPARE_FUNC,s.compareFunction));var I=(p=s.maxAnisotropy)!==null&&p!==void 0?p:1;I>1&&g.device.EXT_texture_filter_anisotropic!==null&&(Ea(s.minFilter===mu.BILINEAR&&s.magFilter===mu.BILINEAR&&s.mipmapFilter===ml.LINEAR),b.samplerParameterf(w,g.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I)),g.gl_sampler=w}else g.descriptor=s;return g}return r.prototype.setTextureParameters=function(n,i,a){var s,c=this.device.gl,p=this.descriptor;this.isNPOT(i,a)?c.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_MIN_FILTER,Ft.LINEAR):c.texParameteri(n,Ft.TEXTURE_MIN_FILTER,sm(p.minFilter,p.mipmapFilter)),c.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_WRAP_S,Cv(p.addressModeU)),c.texParameteri(Ft.TEXTURE_2D,Ft.TEXTURE_WRAP_T,Cv(p.addressModeV)),c.texParameteri(n,Ft.TEXTURE_MAG_FILTER,sm(p.magFilter,ml.NO_MIP));var g=(s=p.maxAnisotropy)!==null&&s!==void 0?s:1;g>1&&this.device.EXT_texture_filter_anisotropic!==null&&(Ea(p.minFilter===mu.BILINEAR&&p.magFilter===mu.BILINEAR&&p.mipmapFilter===ml.LINEAR),c.texParameteri(n,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g))},r.prototype.destroy=function(){e.prototype.destroy.call(this),Li(this.device.gl)&&this.device.gl.deleteSampler(Vm(this))},r.prototype.isNPOT=function(n,i){return!rm(n)||!rm(i)},r}(Qf),oE=function(){function e(){}return e.prototype.dispatchWorkgroups=function(r,n,i){},e.prototype.dispatchWorkgroupsIndirect=function(r,n){},e.prototype.setPipeline=function(r){},e.prototype.setBindings=function(r){},e.prototype.pushDebugGroup=function(r){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(r){},e}(),sE=function(e){(0,bi.ZT)(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.type=mo.RenderBundle,n.commands=[],n}return r.prototype.push=function(n){this.commands.push(n)},r.prototype.replay=function(){this.commands.forEach(function(n){return n()})},r}(Qf),k0=65536,uE=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,lE=function(){function e(r,n){n===void 0&&(n={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=Lp(ep),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Mh.LOWER_LEFT,this.clipSpaceNearZ=Op.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=r,this.contextAttributes=Jd(r.getContextAttributes()),Li(r)?(this.EXT_texture_norm16=r.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=r.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=r.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=r.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=r.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=r.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=r.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=r.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=r.getExtension("EXT_color_buffer_half_float"),r.getExtension("EXT_frag_depth"),r.getExtension("OES_element_index_uint"),r.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=r.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=r.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=r.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=r.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=r.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=r.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=r.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=r.getExtension("KHR_parallel_shader_compile"),Li(r)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new $m({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:Wa.TEXTURE_2D,mipLevelCount:1,usage:hc.RENDER_TARGET,format:this.contextAttributes.alpha===!1?fr.U8_RGB_RT:fr.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=tu.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(r.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(Wa.TEXTURE_2D,tu.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(Wa.TEXTURE_2D,tu.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:as.VERTEX,hint:mh.STATIC}),Li(r)&&(this.fallbackTexture2DArray=this.createFallbackTexture(Wa.TEXTURE_2D_ARRAY,tu.Float),this.fallbackTexture3D=this.createFallbackTexture(Wa.TEXTURE_3D,tu.Float),this.fallbackTextureCube=this.createFallbackTexture(Wa.TEXTURE_CUBE_MAP,tu.Float)),this.currentMegaState.depthCompare=Fa.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=Bl.ALL,r.enable(r.DEPTH_TEST),r.enable(r.STENCIL_TEST),this.checkLimits(),n.shaderDebug&&(this.shaderDebug=!0),n.trackResources&&(this.resourceCreationTracker=new iE)}return e.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},e.prototype.createFallbackTexture=function(r,n){var i=r===Wa.TEXTURE_CUBE_MAP?6:1,a=n===tu.Depth?fr.D32F:fr.U8_RGBA_NORM,s=this.createTexture({dimension:r,format:a,usage:hc.SAMPLED,width:1,height:1,depthOrArrayLayers:i,mipLevelCount:1});return n===tu.Float&&s.setImageData([new Uint8Array(4*i)]),Np(s)},e.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},e.prototype.checkLimits=function(){var r=this.gl;if(this.maxVertexAttribs=r.getParameter(Ft.MAX_VERTEX_ATTRIBS),Li(r)){this.uniformBufferMaxPageByteSize=Math.min(r.getParameter(Ft.MAX_UNIFORM_BLOCK_SIZE),k0),this.uniformBufferWordAlignment=r.getParameter(r.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var n=r.getInternalformatParameter(r.RENDERBUFFER,r.DEPTH32F_STENCIL8,r.SAMPLES);this.supportedSampleCounts=n?(0,bi.ev)([],(0,bi.CR)(n),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=k0;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(i,a){return i-a})},e.prototype.configureSwapChain=function(r,n,i){var a=this.scTexture;a.width=r,a.height=n,this.scPlatformFramebuffer=ix(i)},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.gl.canvas},e.prototype.getOnscreenTexture=function(){return this.scTexture},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.translateTextureInternalFormat=function(r,n){switch(n===void 0&&(n=!1),r){case fr.ALPHA:return Ft.ALPHA;case fr.U8_LUMINANCE:case fr.F16_LUMINANCE:case fr.F32_LUMINANCE:return Ft.LUMINANCE;case fr.F16_R:return Ft.R16F;case fr.F16_RG:return Ft.RG16F;case fr.F16_RGB:return Ft.RGB16F;case fr.F16_RGBA:return Ft.RGBA16F;case fr.F32_R:return Ft.R32F;case fr.F32_RG:return Ft.RG32F;case fr.F32_RGB:return Ft.RGB32F;case fr.F32_RGBA:return Li(this.gl)?Ft.RGBA32F:n?this.WEBGL_color_buffer_float.RGBA32F_EXT:Ft.RGBA;case fr.U8_R_NORM:return Ft.R8;case fr.U8_RG_NORM:return Ft.RG8;case fr.U8_RGB_NORM:case fr.U8_RGB_RT:return Ft.RGB8;case fr.U8_RGB_SRGB:return Ft.SRGB8;case fr.U8_RGBA_NORM:case fr.U8_RGBA_RT:return Li(this.gl)?Ft.RGBA8:n?Ft.RGBA4:Ft.RGBA;case fr.U8_RGBA:return Ft.RGBA;case fr.U8_RGBA_SRGB:case fr.U8_RGBA_RT_SRGB:return Ft.SRGB8_ALPHA8;case fr.U16_R:return Ft.R16UI;case fr.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case fr.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case fr.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case fr.U16_RGBA_5551:return Ft.RGB5_A1;case fr.U16_RGB_565:return Ft.RGB565;case fr.U32_R:return Ft.R32UI;case fr.S8_RGBA_NORM:return Ft.RGBA8_SNORM;case fr.S8_RG_NORM:return Ft.RG8_SNORM;case fr.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case fr.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case fr.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case fr.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case fr.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case fr.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case fr.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case fr.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case fr.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case fr.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case fr.D32F_S8:return Li(this.gl)?Ft.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?Ft.DEPTH_STENCIL:Ft.DEPTH_COMPONENT16;case fr.D24_S8:return Li(this.gl)?Ft.DEPTH24_STENCIL8:this.WEBGL_depth_texture?Ft.DEPTH_STENCIL:Ft.DEPTH_COMPONENT16;case fr.D32F:return Li(this.gl)?Ft.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?Ft.DEPTH_COMPONENT:Ft.DEPTH_COMPONENT16;case fr.D24:return Li(this.gl)?Ft.DEPTH_COMPONENT24:this.WEBGL_depth_texture?Ft.DEPTH_COMPONENT:Ft.DEPTH_COMPONENT16;default:throw new Error("whoops")}},e.prototype.translateTextureType=function(r){var n=Ih(r);switch(n){case xn.U8:return Ft.UNSIGNED_BYTE;case xn.U16:return Ft.UNSIGNED_SHORT;case xn.U32:return Ft.UNSIGNED_INT;case xn.S8:return Ft.BYTE;case xn.F16:return Ft.HALF_FLOAT;case xn.F32:return Ft.FLOAT;case xn.U16_PACKED_5551:return Ft.UNSIGNED_SHORT_5_5_5_1;case xn.D32F:return Li(this.gl)?Ft.FLOAT:this.WEBGL_depth_texture?Ft.UNSIGNED_INT:Ft.UNSIGNED_BYTE;case xn.D24:return Li(this.gl)?Ft.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Ft.UNSIGNED_SHORT:Ft.UNSIGNED_BYTE;case xn.D24S8:return Li(this.gl)?Ft.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Ft.UNSIGNED_INT_24_8_WEBGL:Ft.UNSIGNED_BYTE;case xn.D32FS8:return Ft.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.prototype.translateInternalTextureFormat=function(r){switch(r){case fr.F32_R:return Ft.R32F;case fr.F32_RG:return Ft.RG32F;case fr.F32_RGB:return Ft.RGB32F;case fr.F32_RGBA:return Ft.RGBA32F;case fr.F16_R:return Ft.R16F;case fr.F16_RG:return Ft.RG16F;case fr.F16_RGB:return Ft.RGB16F;case fr.F16_RGBA:return Ft.RGBA16F}return this.translateTextureFormat(r)},e.prototype.translateTextureFormat=function(r){if(I0(r)||r===fr.F32_LUMINANCE||r===fr.U8_LUMINANCE)return this.translateTextureInternalFormat(r);var n=Li(this.gl)||!Li(this.gl)&&!!this.WEBGL_depth_texture;switch(r){case fr.D24_S8:case fr.D32F_S8:return n?Ft.DEPTH_STENCIL:Ft.RGBA;case fr.D24:case fr.D32F:return n?Ft.DEPTH_COMPONENT:Ft.RGBA}var i=O0(r),a=em(r);switch(a){case Ri.A:return Ft.ALPHA;case Ri.R:return i?Ft.RED_INTEGER:Ft.RED;case Ri.RG:return i?Ft.RG_INTEGER:Ft.RG;case Ri.RGB:return i?Ft.RGB_INTEGER:Ft.RGB;case Ri.RGBA:return Ft.RGBA}},e.prototype.setActiveTexture=function(r){this.currentActiveTexture!==r&&(this.gl.activeTexture(r),this.currentActiveTexture=r)},e.prototype.bindVAO=function(r){this.currentBoundVAO!==r&&(Li(this.gl)?this.gl.bindVertexArray(r):this.OES_vertex_array_object.bindVertexArrayOES(r),this.currentBoundVAO=r)},e.prototype.programCompiled=function(r){Ea(r.compileState!==sf.NeedsCompile),r.compileState===sf.Compiling&&(r.compileState=sf.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(r))},e.prototype.useProgram=function(r){this.currentProgram!==r&&(this.programCompiled(r),this.gl.useProgram(r.gl_program),this.currentProgram=r)},e.prototype.ensureResourceExists=function(r){if(r===null){var n=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(n))}else return r},e.prototype.createBuffer=function(r){return new Kx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createTexture=function(r){return new $m({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createSampler=function(r){return new aE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderTarget=function(r){return new Qx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderTargetFromTexture=function(r){var n=r,i=n.format,a=n.width,s=n.height,c=n.mipLevelCount;return Ea(c===1),this.createRenderTarget({format:i,width:a,height:s,sampleCount:1,texture:r})},e.prototype.createProgram=function(r){var n,i,a,s=(n=r.vertex)===null||n===void 0?void 0:n.glsl;return!((i=r.vertex)===null||i===void 0)&&i.glsl&&(r.vertex.glsl=_d(this.queryVendorInfo(),"vert",r.vertex.glsl)),!((a=r.fragment)===null||a===void 0)&&a.glsl&&(r.fragment.glsl=_d(this.queryVendorInfo(),"frag",r.fragment.glsl)),this.createProgramSimple(r,s)},e.prototype.createProgramSimple=function(r,n){var i=new Jx({id:this.getNextUniqueId(),device:this,descriptor:r},n);return i},e.prototype.createBindings=function(r){return new Zx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createInputLayout=function(r){return new qx({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderPipeline=function(r){return new rE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createComputePass=function(){return new oE},e.prototype.createComputePipeline=function(r){return new nE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createReadback=function(){return new tE({id:this.getNextUniqueId(),device:this})},e.prototype.createQueryPool=function(r,n){return new eE({id:this.getNextUniqueId(),device:this,descriptor:{type:r,elemCount:n}})},e.prototype.formatRenderPassDescriptor=function(r){var n,i,a,s,c,p,g=r.colorAttachment;r.depthClearValue=(n=r.depthClearValue)!==null&&n!==void 0?n:"load",r.stencilClearValue=(i=r.stencilClearValue)!==null&&i!==void 0?i:"load";for(var b=0;b<g.length;b++)r.colorAttachmentLevel||(r.colorAttachmentLevel=[]),r.colorAttachmentLevel[b]=(a=r.colorAttachmentLevel[b])!==null&&a!==void 0?a:0,r.colorResolveToLevel||(r.colorResolveToLevel=[]),r.colorResolveToLevel[b]=(s=r.colorResolveToLevel[b])!==null&&s!==void 0?s:0,r.colorClearColor||(r.colorClearColor=[]),r.colorClearColor[b]=(c=r.colorClearColor[b])!==null&&c!==void 0?c:"load",r.colorStore||(r.colorStore=[]),r.colorStore[b]=(p=r.colorStore[b])!==null&&p!==void 0?p:!1},e.prototype.createRenderBundle=function(){return new sE({id:this.getNextUniqueId(),device:this})},e.prototype.beginBundle=function(r){this.renderBundle=r},e.prototype.endBundle=function(){this.renderBundle=void 0},e.prototype.executeBundles=function(r){r.forEach(function(n){n.replay()})},e.prototype.createRenderPass=function(r){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=r,this.formatRenderPassDescriptor(r);var n=r.colorAttachment,i=r.colorAttachmentLevel,a=r.colorClearColor,s=r.colorResolveTo,c=r.colorResolveToLevel,p=r.depthStencilAttachment,g=r.depthClearValue,b=r.stencilClearValue,w=r.depthStencilResolveTo;this.setRenderPassParametersBegin(n.length);for(var I=0;I<n.length;I++)this.setRenderPassParametersColor(I,n[I],i[I],s[I],c[I]);this.setRenderPassParametersDepthStencil(p,w),this.validateCurrentAttachments();for(var I=0;I<n.length;I++){var W=a[I];W!=="load"&&this.setRenderPassParametersClearColor(I,W.r,W.g,W.b,W.a)}return this.setRenderPassParametersClearDepthStencil(g,b),this},e.prototype.submitPass=function(r){Ea(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},e.prototype.copySubTexture2D=function(r,n,i,a,s,c){var p=this.gl,g=r,b=a;if(Ea(b.mipLevelCount===1),Ea(g.mipLevelCount===1),Li(p))g===this.scTexture?p.bindFramebuffer(p.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(p.bindFramebuffer(p.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(p.DRAW_FRAMEBUFFER,p.COLOR_ATTACHMENT0,g,0)),p.bindFramebuffer(p.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(p.READ_FRAMEBUFFER,p.COLOR_ATTACHMENT0,b,0),p.blitFramebuffer(s,c,s+b.width,c+b.height,n,i,n+b.width,i+b.height,p.COLOR_BUFFER_BIT,p.LINEAR),p.bindFramebuffer(p.READ_FRAMEBUFFER,null),p.bindFramebuffer(p.DRAW_FRAMEBUFFER,null);else if(g===this.scTexture){var w=this.createRenderTargetFromTexture(a);this.submitBlitRenderPass(w,g)}},e.prototype.queryLimits=function(){return this},e.prototype.queryTextureFormatSupported=function(r,n,i){switch(r){case fr.BC1_SRGB:case fr.BC2_SRGB:case fr.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?Hm(n,i,4,4):!1;case fr.BC1:case fr.BC2:case fr.BC3:return this.WEBGL_compressed_texture_s3tc!==null?Hm(n,i,4,4):!1;case fr.BC4_UNORM:case fr.BC4_SNORM:case fr.BC5_UNORM:case fr.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?Hm(n,i,4,4):!1;case fr.U16_R_NORM:case fr.U16_RG_NORM:case fr.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case fr.F32_R:case fr.F32_RG:case fr.F32_RGB:case fr.F32_RGBA:return this.OES_texture_float_linear!==null;case fr.F16_R:case fr.F16_RG:case fr.F16_RGB:case fr.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},e.prototype.queryProgramReady=function(r){var n=this.gl;if(r.compileState===sf.NeedsCompile)throw new Error("whoops");if(r.compileState===sf.Compiling){var i=void 0;return this.KHR_parallel_shader_compile!==null?i=n.getProgramParameter(r.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):i=!0,i&&this.programCompiled(r),i}return r.compileState===sf.NeedsBind||r.compileState===sf.ReadyToUse},e.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(r){return this.currentRenderPassDescriptor},e.prototype.queryRenderTarget=function(r){var n=r;return n},e.prototype.setResourceName=function(r,n){if(r.name=n,r.type===mo.Buffer)for(var i=r.gl_buffer_pages,a=0;a<i.length;a++)wv(i[a],"".concat(n," Page ").concat(a));else if(r.type===mo.Texture)wv(Np(r),n);else if(r.type===mo.Sampler)wv(Vm(r),n);else if(r.type===mo.RenderTarget){var s=r.gl_renderbuffer;s!==null&&wv(s,n)}else r.type===mo.InputLayout&&wv(r.vao,n)},e.prototype.setResourceLeakCheck=function(r,n){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(r,n)},e.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},e.prototype.pushDebugGroup=function(r){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(r){},e.prototype.programPatched=function(r,n){Ea(this.shaderDebug)},e.prototype.getBufferData=function(r,n,i){i===void 0&&(i=0);var a=this.gl;Li(a)&&(a.bindBuffer(a.COPY_READ_BUFFER,Fp(r,i*4)),a.getBufferSubData(a.COPY_READ_BUFFER,i*4,n))},e.prototype.debugGroupStatisticsDrawCall=function(r){r===void 0&&(r=1);for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].drawCallCount+=r},e.prototype.debugGroupStatisticsBufferUpload=function(r){r===void 0&&(r=1);for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].bufferUploadCount+=r},e.prototype.debugGroupStatisticsTextureBind=function(r){r===void 0&&(r=1);for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].textureBindCount+=r},e.prototype.debugGroupStatisticsTriangles=function(r){for(var n=this.debugGroupStack.length-1;n>=0;n--)this.debugGroupStack[n].triangleCount+=r},e.prototype.reportShaderError=function(r,n){var i=this.gl,a=i.getShaderParameter(r,i.COMPILE_STATUS);if(!a){console.error(sx(n));var s=i.getExtension("WEBGL_debug_shaders");s&&console.error(s.getTranslatedShaderSource(r)),console.error(i.getShaderInfoLog(r))}return a},e.prototype.checkProgramCompilationForErrors=function(r){var n=this.gl,i=r.gl_program;if(!n.getProgramParameter(i,n.LINK_STATUS)){var a=r.descriptor;if(!this.reportShaderError(r.gl_shader_vert,a.vertex.glsl)||!this.reportShaderError(r.gl_shader_frag,a.fragment.glsl))return;console.error(n.getProgramInfoLog(r.gl_program))}},e.prototype.bindFramebufferAttachment=function(r,n,i,a){var s=this.gl;if((0,qf.Z)(i))s.framebufferRenderbuffer(r,n,s.RENDERBUFFER,null);else if(i.type===mo.RenderTarget)i.gl_renderbuffer!==null?s.framebufferRenderbuffer(r,n,s.RENDERBUFFER,i.gl_renderbuffer):i.texture!==null&&s.framebufferTexture2D(r,n,Ft.TEXTURE_2D,Np(i.texture),a);else if(i.type===mo.Texture){var c=Np(i);i.dimension===Wa.TEXTURE_2D?s.framebufferTexture2D(r,n,Ft.TEXTURE_2D,c,a):Li(s)&&(i.dimension,Wa.TEXTURE_2D_ARRAY)}},e.prototype.bindFramebufferDepthStencilAttachment=function(r,n){var i=this.gl,a=(0,qf.Z)(n)?pi.Depth|pi.Stencil:Pp(n.format),s=!!(a&pi.Depth),c=!!(a&pi.Stencil);if(s&&c){var p=Li(this.gl)||!Li(this.gl)&&!!this.WEBGL_depth_texture;p?this.bindFramebufferAttachment(r,i.DEPTH_STENCIL_ATTACHMENT,n,0):this.bindFramebufferAttachment(r,i.DEPTH_ATTACHMENT,n,0)}else s?(this.bindFramebufferAttachment(r,i.DEPTH_ATTACHMENT,n,0),this.bindFramebufferAttachment(r,i.STENCIL_ATTACHMENT,null,0)):c&&(this.bindFramebufferAttachment(r,i.STENCIL_ATTACHMENT,n,0),this.bindFramebufferAttachment(r,i.DEPTH_ATTACHMENT,null,0))},e.prototype.validateCurrentAttachments=function(){for(var r=-1,n=-1,i=-1,a=0;a<this.currentColorAttachments.length;a++){var s=this.currentColorAttachments[a];s!==null&&(r===-1?(r=s.sampleCount,n=s.width,i=s.height):(Ea(r===s.sampleCount),Ea(n===s.width),Ea(i===s.height)))}this.currentDepthStencilAttachment&&(r===-1?r=this.currentDepthStencilAttachment.sampleCount:(Ea(r===this.currentDepthStencilAttachment.sampleCount),Ea(n===this.currentDepthStencilAttachment.width),Ea(i===this.currentDepthStencilAttachment.height))),this.currentSampleCount=r},e.prototype.setRenderPassParametersBegin=function(r){var n=this.gl;if(Li(n)?n.bindFramebuffer(Ft.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||n.bindFramebuffer(Ft.FRAMEBUFFER,this.renderPassDrawFramebuffer),Li(n)?n.drawBuffers([Ft.COLOR_ATTACHMENT0,Ft.COLOR_ATTACHMENT1,Ft.COLOR_ATTACHMENT2,Ft.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([Ft.COLOR_ATTACHMENT0_WEBGL,Ft.COLOR_ATTACHMENT1_WEBGL,Ft.COLOR_ATTACHMENT2_WEBGL,Ft.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var i=r;i<this.currentColorAttachments.length;i++){var a=Li(n)?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,s=Li(n)?Ft.COLOR_ATTACHMENT0:Ft.COLOR_ATTACHMENT0_WEBGL;n.framebufferRenderbuffer(a,s+i,Ft.RENDERBUFFER,null),n.framebufferTexture2D(a,s+i,Ft.TEXTURE_2D,null,0)}this.currentColorAttachments.length=r},e.prototype.setRenderPassParametersColor=function(r,n,i,a,s){var c=this.gl,p=Li(c);(this.currentColorAttachments[r]!==n||this.currentColorAttachmentLevels[r]!==i)&&(this.currentColorAttachments[r]=n,this.currentColorAttachmentLevels[r]=i,(p||!p&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(p?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,(p?Ft.COLOR_ATTACHMENT0:Ft.COLOR_ATTACHMENT0_WEBGL)+r,n,i),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[r]!==a||this.currentColorResolveToLevels[r]!==s)&&(this.currentColorResolveTos[r]=a,this.currentColorResolveToLevels[r]=s,a!==null&&(this.resolveColorAttachmentsChanged=!0))},e.prototype.setRenderPassParametersDepthStencil=function(r,n){var i=this.gl;this.currentDepthStencilAttachment!==r&&(this.currentDepthStencilAttachment=r,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(Li(i)?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==n&&(this.currentDepthStencilResolveTo=n,n&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.prototype.setRenderPassParametersClearColor=function(r,n,i,a,s){var c=this.gl;if(this.OES_draw_buffers_indexed!==null){var p=this.currentMegaState.attachmentsState[r];p&&p.channelWriteMask!==Bl.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(r,!0,!0,!0,!0),p.channelWriteMask=Bl.ALL)}else{var p=this.currentMegaState.attachmentsState[0];p&&p.channelWriteMask!==Bl.ALL&&(c.colorMask(!0,!0,!0,!0),p.channelWriteMask=Bl.ALL)}this.setScissorRectEnabled(!1),Li(c)?c.clearBufferfv(c.COLOR,r,[n,i,a,s]):(c.clearColor(n,i,a,s),c.clear(c.COLOR_BUFFER_BIT))},e.prototype.setRenderPassParametersClearDepthStencil=function(r,n){r===void 0&&(r="load"),n===void 0&&(n="load");var i=this.gl;r!=="load"&&(Ea(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(i.depthMask(!0),this.currentMegaState.depthWrite=!0),Li(i)?i.clearBufferfv(i.DEPTH,0,[r]):(i.clearDepth(r),i.clear(i.DEPTH_BUFFER_BIT))),n!=="load"&&(Ea(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(i.enable(i.STENCIL_TEST),i.stencilMask(255),this.currentMegaState.stencilWrite=!0),Li(i)?i.clearBufferiv(i.STENCIL,0,[n]):(i.clearStencil(n),i.clear(i.STENCIL_BUFFER_BIT)))},e.prototype.setBindings=function(r){var n=this,i;if(this.renderBundle){this.renderBundle.push(function(){return n.setBindings(r)});return}var a=this.gl,s=r,c=s.uniformBufferBindings,p=s.samplerBindings,g=s.bindingLayouts;Ea(0<g.bindingLayoutTables.length);var b=g.bindingLayoutTables[0];Ea(c.length>=b.numUniformBuffers),Ea(p.length>=b.numSamplers);for(var w=0;w<c.length;w++){var I=c[w];if(I.size!==0){var W=b.firstUniformBuffer+w,pe=I.buffer,Me=I.offset||0,Fe=I.size||pe.byteSize;if(pe!==this.currentUniformBuffers[W]||Me!==this.currentUniformBufferByteOffsets[W]||Fe!==this.currentUniformBufferByteSizes[W]){var ut=Me%pe.pageByteSize,Ot=pe.gl_buffer_pages[Me/pe.pageByteSize|0];Ea(ut+Fe<=pe.pageByteSize),Li(a)&&a.bindBufferRange(a.UNIFORM_BUFFER,W,Ot,ut,Fe),this.currentUniformBuffers[W]=pe,this.currentUniformBufferByteOffsets[W]=Me,this.currentUniformBufferByteSizes[W]=Fe}}}for(var w=0;w<b.numSamplers;w++){var I=p[w],Bt=b.firstSampler+w,ir=I!==null&&I.sampler!==null?Vm(I.sampler):null,xr=I!==null&&I.texture!==null?Np(I.texture):null;if(this.currentSamplers[Bt]!==ir&&(Li(a)&&a.bindSampler(Bt,ir),this.currentSamplers[Bt]=ir),this.currentTextures[Bt]!==xr){if(this.setActiveTexture(a.TEXTURE0+Bt),xr!==null){var qr=Jd(I).texture,Ir=qr.gl_target,mr=qr.width,sn=qr.height;I.texture.textureIndex=Bt,a.bindTexture(Ir,xr),Li(a)||(i=I.sampler)===null||i===void 0||i.setTextureParameters(Ir,mr,sn),this.debugGroupStatisticsTextureBind()}else{var ti=(0,bi.pi)((0,bi.pi)({},I),E0),Bi=ti.dimension,ai=ti.formatKind,Ir=Yx(Bi);a.bindTexture(Ir,this.getFallbackTexture((0,bi.pi)({gl_target:Ir,formatKind:ai},ti)))}this.currentTextures[Bt]=xr}}},e.prototype.setViewport=function(r,n,i,a){var s=this.gl;s.viewport(r,n,i,a)},e.prototype.setScissorRect=function(r,n,i,a){var s=this.gl;this.setScissorRectEnabled(!0),s.scissor(r,n,i,a)},e.prototype.applyAttachmentStateIndexed=function(r,n,i){var a=this.gl,s=this.OES_draw_buffers_indexed;n.channelWriteMask!==i.channelWriteMask&&(s.colorMaskiOES(r,!!(i.channelWriteMask&Bl.RED),!!(i.channelWriteMask&Bl.GREEN),!!(i.channelWriteMask&Bl.BLUE),!!(i.channelWriteMask&Bl.ALPHA)),n.channelWriteMask=i.channelWriteMask);var c=n.rgbBlendState.blendMode!==i.rgbBlendState.blendMode||n.alphaBlendState.blendMode!==i.alphaBlendState.blendMode,p=n.rgbBlendState.blendSrcFactor!==i.rgbBlendState.blendSrcFactor||n.alphaBlendState.blendSrcFactor!==i.alphaBlendState.blendSrcFactor||n.rgbBlendState.blendDstFactor!==i.rgbBlendState.blendDstFactor||n.alphaBlendState.blendDstFactor!==i.alphaBlendState.blendDstFactor;(p||c)&&(bd(n.rgbBlendState)&&bd(n.alphaBlendState)?s.enableiOES(r,a.BLEND):bd(i.rgbBlendState)&&bd(i.alphaBlendState)&&s.disableiOES(r,a.BLEND)),c&&(s.blendEquationSeparateiOES(r,i.rgbBlendState.blendMode,i.alphaBlendState.blendMode),n.rgbBlendState.blendMode=i.rgbBlendState.blendMode,n.alphaBlendState.blendMode=i.alphaBlendState.blendMode),p&&(s.blendFuncSeparateiOES(r,i.rgbBlendState.blendSrcFactor,i.rgbBlendState.blendDstFactor,i.alphaBlendState.blendSrcFactor,i.alphaBlendState.blendDstFactor),n.rgbBlendState.blendSrcFactor=i.rgbBlendState.blendSrcFactor,n.alphaBlendState.blendSrcFactor=i.alphaBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor=i.rgbBlendState.blendDstFactor,n.alphaBlendState.blendDstFactor=i.alphaBlendState.blendDstFactor)},e.prototype.applyAttachmentState=function(r,n){var i=this.gl;r.channelWriteMask!==n.channelWriteMask&&(i.colorMask(!!(n.channelWriteMask&Bl.RED),!!(n.channelWriteMask&Bl.GREEN),!!(n.channelWriteMask&Bl.BLUE),!!(n.channelWriteMask&Bl.ALPHA)),r.channelWriteMask=n.channelWriteMask);var a=r.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,s=r.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(s||a)&&(bd(r.rgbBlendState)&&bd(r.alphaBlendState)?i.enable(i.BLEND):bd(n.rgbBlendState)&&bd(n.alphaBlendState)&&i.disable(i.BLEND)),a&&(i.blendEquationSeparate(n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),r.rgbBlendState.blendMode=n.rgbBlendState.blendMode,r.alphaBlendState.blendMode=n.alphaBlendState.blendMode),s&&(i.blendFuncSeparate(n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.prototype.setMegaState=function(r){var n=this.gl,i=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var a=0;a<r.attachmentsState.length;a++)this.applyAttachmentStateIndexed(a,i.attachmentsState[0],r.attachmentsState[0]);else Ea(r.attachmentsState.length===1),this.applyAttachmentState(i.attachmentsState[0],r.attachmentsState[0]);if(m0(i.blendConstant,r.blendConstant)||(n.blendColor(r.blendConstant.r,r.blendConstant.g,r.blendConstant.b,r.blendConstant.a),g0(i.blendConstant,r.blendConstant)),i.depthCompare!==r.depthCompare&&(n.depthFunc(r.depthCompare),i.depthCompare=r.depthCompare),!!i.depthWrite!=!!r.depthWrite&&(n.depthMask(r.depthWrite),i.depthWrite=r.depthWrite),!!i.stencilWrite!=!!r.stencilWrite&&(n.stencilMask(r.stencilWrite?255:0),i.stencilWrite=r.stencilWrite),!am(i.stencilFront,r.stencilFront)){var s=r.stencilFront,c=s.passOp,p=s.failOp,g=s.depthFailOp,b=s.compare;(i.stencilFront.passOp!==c||i.stencilFront.failOp!==p||i.stencilFront.depthFailOp!==g)&&(n.stencilOpSeparate(n.FRONT,p,g,c),i.stencilFront.passOp=c,i.stencilFront.failOp=p,i.stencilFront.depthFailOp=g),i.stencilFront.compare!==b&&(this.setStencilReference(0),i.stencilFront.compare=b)}if(!am(i.stencilBack,r.stencilBack)){var w=r.stencilBack,c=w.passOp,p=w.failOp,g=w.depthFailOp,b=w.compare;(i.stencilBack.passOp!==c||i.stencilBack.failOp!==p||i.stencilBack.depthFailOp!==g)&&(n.stencilOpSeparate(n.BACK,p,g,c),i.stencilBack.passOp=c,i.stencilBack.failOp=p,i.stencilBack.depthFailOp=g),i.stencilBack.compare!==b&&(this.setStencilReference(0),i.stencilBack.compare=b)}(i.stencilFront.mask!==r.stencilFront.mask||i.stencilBack.mask!==r.stencilBack.mask)&&(i.stencilFront.mask=r.stencilFront.mask,i.stencilBack.mask=r.stencilBack.mask,this.applyStencil()),i.cullMode!==r.cullMode&&(i.cullMode===of.NONE?n.enable(n.CULL_FACE):r.cullMode===of.NONE&&n.disable(n.CULL_FACE),r.cullMode===of.BACK?n.cullFace(n.BACK):r.cullMode===of.FRONT?n.cullFace(n.FRONT):r.cullMode===of.FRONT_AND_BACK&&n.cullFace(n.FRONT_AND_BACK),i.cullMode=r.cullMode),i.frontFace!==r.frontFace&&(n.frontFace(r.frontFace),i.frontFace=r.frontFace),i.polygonOffset!==r.polygonOffset&&(r.polygonOffset?(n.polygonOffset(1,1),n.enable(n.POLYGON_OFFSET_FILL)):n.disable(n.POLYGON_OFFSET_FILL),i.polygonOffset=r.polygonOffset)},e.prototype.validatePipelineFormats=function(r){for(var n=0;n<this.currentColorAttachments.length;n++)var i=this.currentColorAttachments[n];this.currentDepthStencilAttachment&&Ea(this.currentDepthStencilAttachment.format===r.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&Ea(this.currentSampleCount===r.sampleCount)},e.prototype.setPipeline=function(r){var n=this;if(this.renderBundle){this.renderBundle.push(function(){return n.setPipeline(r)});return}this.currentPipeline=r,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var i=this.currentPipeline.program;if(this.useProgram(i),i.compileState===sf.NeedsBind){var a=this.gl,s=i.gl_program,c=i.descriptor,p=D0(c.vertex.glsl,uE);if(Li(a))for(var g=0;g<p.length;g++){var b=(0,bi.CR)(p[g],2),w=b[1],I=a.getUniformBlockIndex(s,w);I!==-1&&I!==4294967295&&a.uniformBlockBinding(s,I,g)}for(var W=D0(c.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),g=0;g<W.length;g++){var pe=(0,bi.CR)(W[g],3),Me=pe[1],Fe=pe[2],ut=a.getUniformLocation(s,Me);a.uniform1i(ut,parseInt(Fe))}i.compileState=sf.ReadyToUse}},e.prototype.setVertexInput=function(r,n,i){var a,s,c=this,p;if(this.renderBundle){this.renderBundle.push(function(){return c.setVertexInput(r,n,i)});return}if(r!==null){Ea(this.currentPipeline.inputLayout===r);var g=r;this.bindVAO(g.vao);for(var b=this.gl,w=0;w<g.vertexBufferDescriptors.length;w++){var I=g.vertexBufferDescriptors[w],W=I.arrayStride,pe=I.attributes;try{for(var Me=(a=void 0,(0,bi.XA)(pe)),Fe=Me.next();!Fe.done;Fe=Me.next()){var ut=Fe.value,Ot=ut.shaderLocation,Bt=ut.offset,ir=Li(b)?Ot:(p=g.program.attributes[Ot])===null||p===void 0?void 0:p.location;if(!(0,qf.Z)(ir)){var xr=n[w];if(xr===null)continue;var qr=ut.vertexFormat;b.bindBuffer(b.ARRAY_BUFFER,Fp(xr.buffer));var Ir=(xr.offset||0)+Bt;b.vertexAttribPointer(ir,qr.size,qr.type,qr.normalized,W,Ir)}}}catch(sn){a={error:sn}}finally{try{Fe&&!Fe.done&&(s=Me.return)&&s.call(Me)}finally{if(a)throw a.error}}}if(Ea(i!==null==(g.indexBufferFormat!==null)),i!==null){var mr=i.buffer;Ea(mr.usage===as.INDEX),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,Fp(mr)),this.currentIndexBufferByteOffset=i.offset||0}else this.currentIndexBufferByteOffset=null}else Ea(this.currentPipeline.inputLayout===null),Ea(i===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},e.prototype.setStencilReference=function(r){this.currentStencilRef!==r&&(this.currentStencilRef=r,this.applyStencil())},e.prototype.draw=function(r,n,i,a){var s,c=this;if(this.renderBundle){this.renderBundle.push(function(){return c.draw(r,n,i,a)});return}var p=this.gl,g=this.currentPipeline;if(n){var b=[g.drawMode,i||0,r,n];Li(p)?p.drawArraysInstanced.apply(p,(0,bi.ev)([],(0,bi.CR)(b),!1)):(s=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(s,(0,bi.ev)([],(0,bi.CR)(b),!1))}else p.drawArrays(g.drawMode,i,r);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(r/3*Math.max(n,1))},e.prototype.drawIndexed=function(r,n,i,a,s){var c,p=this;if(this.renderBundle){this.renderBundle.push(function(){return p.drawIndexed(r,n,i,a,s)});return}var g=this.gl,b=this.currentPipeline,w=Jd(b.inputLayout),I=Jd(this.currentIndexBufferByteOffset)+i*w.indexBufferCompByteSize;if(n){var W=[b.drawMode,r,w.indexBufferType,I,n];Li(g)?g.drawElementsInstanced.apply(g,(0,bi.ev)([],(0,bi.CR)(W),!1)):(c=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(c,(0,bi.ev)([],(0,bi.CR)(W),!1))}else g.drawElements(b.drawMode,r,w.indexBufferType,I);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(r/3*Math.max(n,1))},e.prototype.drawIndirect=function(r,n){},e.prototype.drawIndexedIndirect=function(r,n){},e.prototype.beginOcclusionQuery=function(r){var n=this.gl;if(Li(n)){var i=this.currentRenderPassDescriptor.occlusionQueryPool;n.beginQuery(i.gl_query_type,i.gl_query[r])}},e.prototype.endOcclusionQuery=function(){var r=this.gl;if(Li(r)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;r.endQuery(n.gl_query_type)}},e.prototype.pipelineQueryReady=function(r){var n=r;return this.queryProgramReady(n.program)},e.prototype.pipelineForceReady=function(r){},e.prototype.endPass=function(){for(var r=this.gl,n=Li(r),i=!1,a=0;a<this.currentColorAttachments.length;a++){var s=this.currentColorAttachments[a];if(s!==null){var c=this.currentColorResolveTos[a],p=!1;c!==null&&(Ea(s.width===c.width&&s.height===c.height),this.setScissorRectEnabled(!1),n&&r.bindFramebuffer(r.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&n&&this.bindFramebufferAttachment(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[a]),p=!0,c===this.scTexture?r.bindFramebuffer(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,this.scPlatformFramebuffer):(r.bindFramebuffer(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&r.framebufferTexture2D(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,c.gl_texture,this.currentColorResolveToLevels[a])),n?(r.blitFramebuffer(0,0,s.width,s.height,0,0,c.width,c.height,r.COLOR_BUFFER_BIT,r.LINEAR),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(s,c),i=!0),this.currentRenderPassDescriptor.colorStore[a]||p||(r.bindFramebuffer(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,r.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[a])),r.bindFramebuffer(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var g=this.currentDepthStencilAttachment;if(g){var b=this.currentDepthStencilResolveTo,p=!1;b&&(Ea(g.width===b.width&&g.height===b.height),this.setScissorRectEnabled(!1),r.bindFramebuffer(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),r.bindFramebuffer(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,g),this.bindFramebufferDepthStencilAttachment(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,b)),p=!0,n&&r.blitFramebuffer(0,0,g.width,g.height,0,0,b.width,b.height,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,null),i=!0),this.currentRenderPassDescriptor.depthStencilStore||(p||(r.bindFramebuffer(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,g),p=!0),n&&r.invalidateFramebuffer(r.READ_FRAMEBUFFER,[r.DEPTH_STENCIL_ATTACHMENT])),p&&r.bindFramebuffer(n?Ft.READ_FRAMEBUFFER:Ft.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}i||r.bindFramebuffer(n?Ft.DRAW_FRAMEBUFFER:Ft.FRAMEBUFFER,null)},e.prototype.setScissorRectEnabled=function(r){if(this.currentScissorEnabled!==r){var n=this.gl;r?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST),this.currentScissorEnabled=r}},e.prototype.applyStencil=function(){(0,qf.Z)(this.currentStencilRef)||(this.gl.stencilFuncSeparate(Ft.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(Ft.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},e.prototype.getFallbackTexture=function(r){var n=r.gl_target,i=r.formatKind;if(n===Ft.TEXTURE_2D)return i===tu.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(n===Ft.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(n===Ft.TEXTURE_3D)return this.fallbackTexture3D;if(n===Ft.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.submitBlitRenderPass=function(r,n){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:as.VERTEX|as.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:Qd.VERTEX,attributes:[{format:fr.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:Uu.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[fr.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:Lp(ep)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:r.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:r}));var i=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var a=this.createRenderPass({colorAttachment:[r],colorResolveTo:[n],colorClearColor:[rx]}),s=this.getCanvas(),c=s.width,p=s.height;a.setPipeline(this.blitRenderPipeline),a.setBindings(this.blitBindings),a.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),a.setViewport(0,0,c,p),this.gl.disable(this.gl.BLEND),a.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=i,this.inBlitRenderPass=!1},e}(),cE=function(){function e(r){this.pluginOptions=r}return e.prototype.createSwapChain=function(r){return(0,bi.mG)(this,void 0,void 0,function(){var n,i,a,s,c,p,g,b,w,I,W,pe,Me;return(0,bi.Jh)(this,function(Fe){return n=this.pluginOptions,i=n.targets,a=n.xrCompatible,s=n.antialias,c=s===void 0?!1:s,p=n.preserveDrawingBuffer,g=p===void 0?!1:p,b=n.premultipliedAlpha,w=b===void 0?!0:b,I=n.shaderDebug,W=n.trackResources,pe={antialias:c,preserveDrawingBuffer:g,stencil:!0,premultipliedAlpha:w,xrCompatible:a},this.handleContextEvents(r),i.includes("webgl2")&&(Me=r.getContext("webgl2",pe)||r.getContext("experimental-webgl2",pe)),!Me&&i.includes("webgl1")&&(Me=r.getContext("webgl",pe)||r.getContext("experimental-webgl",pe)),[2,new lE(Me,{shaderDebug:I,trackResources:W})]})})},e.prototype.handleContextEvents=function(r){var n=this.pluginOptions,i=n.onContextLost,a=n.onContextRestored,s=n.onContextCreationError;s&&r.addEventListener("webglcontextcreationerror",s,!1),i&&r.addEventListener("webglcontextlost",i,!1),a&&r.addEventListener("webglcontextrestored",a,!1)},e}();let zu;const L0=typeof TextDecoder!="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder!="undefined"&&L0.decode();let Rv=null;function um(){return(Rv===null||Rv.byteLength===0)&&(Rv=new Uint8Array(zu.memory.buffer)),Rv}function lm(e,r){return e=e>>>0,L0.decode(um().subarray(e,e+r))}const Yh=new Array(128).fill(void 0);Yh.push(void 0,null,!0,!1);let Mv=Yh.length;function fE(e){Mv===Yh.length&&Yh.push(Yh.length+1);const r=Mv;return Mv=Yh[r],Yh[r]=e,r}function cm(e){return Yh[e]}function hE(e){e<132||(Yh[e]=Mv,Mv=e)}function dE(e){const r=cm(e);return hE(e),r}let Iv=0;const fm=typeof TextEncoder!="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},pE=typeof fm.encodeInto=="function"?function(e,r){return fm.encodeInto(e,r)}:function(e,r){const n=fm.encode(e);return r.set(n),{read:e.length,written:n.length}};function Wm(e,r,n){if(n===void 0){const p=fm.encode(e),g=r(p.length,1)>>>0;return um().subarray(g,g+p.length).set(p),Iv=p.length,g}let i=e.length,a=r(i,1)>>>0;const s=um();let c=0;for(;c<i;c++){const p=e.charCodeAt(c);if(p>127)break;s[a+c]=p}if(c!==i){c!==0&&(e=e.slice(c)),a=n(a,i,i=c+e.length*3,1)>>>0;const p=um().subarray(a+c,a+i),g=pE(e,p);c+=g.written}return Iv=c,a}let Ov=null;function hm(){return(Ov===null||Ov.byteLength===0)&&(Ov=new Int32Array(zu.memory.buffer)),Ov}function vE(e,r,n){let i,a;try{const p=zu.__wbindgen_add_to_stack_pointer(-16),g=Wm(e,zu.__wbindgen_malloc,zu.__wbindgen_realloc),b=Iv,w=Wm(r,zu.__wbindgen_malloc,zu.__wbindgen_realloc),I=Iv;zu.glsl_compile(p,g,b,w,I,n);var s=hm()[p/4+0],c=hm()[p/4+1];return i=s,a=c,lm(s,c)}finally{zu.__wbindgen_add_to_stack_pointer(16),zu.__wbindgen_free(i,a,1)}}class Pv{static __wrap(r){r=r>>>0;const n=Object.create(Pv.prototype);return n.__wbg_ptr=r,n}__destroy_into_raw(){const r=this.__wbg_ptr;return this.__wbg_ptr=0,r}free(){const r=this.__destroy_into_raw();zu.__wbg_wgslcomposer_free(r)}constructor(){const r=zu.wgslcomposer_new();return Pv.__wrap(r)}wgsl_compile(r){let n,i;try{const c=zu.__wbindgen_add_to_stack_pointer(-16),p=Wm(r,zu.__wbindgen_malloc,zu.__wbindgen_realloc),g=Iv;zu.wgslcomposer_wgsl_compile(c,this.__wbg_ptr,p,g);var a=hm()[c/4+0],s=hm()[c/4+1];return n=a,i=s,lm(a,s)}finally{zu.__wbindgen_add_to_stack_pointer(16),zu.__wbindgen_free(n,i,1)}}}function mE(e,r){return qm(this,null,function*(){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return yield WebAssembly.instantiateStreaming(e,r)}catch(i){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const n=yield e.arrayBuffer();return yield WebAssembly.instantiate(n,r)}else{const n=yield WebAssembly.instantiate(e,r);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}})}function gE(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(r,n){const i=lm(r,n);return fE(i)},e.wbg.__wbindgen_object_drop_ref=function(r){dE(r)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(r){console.log(cm(r))},e.wbg.__wbg_log_576ca876af0d4a77=function(r,n){console.log(cm(r),cm(n))},e.wbg.__wbindgen_throw=function(r,n){throw new Error(lm(r,n))},e}function yE(e,r){return zu=e.exports,B0.__wbindgen_wasm_module=r,Ov=null,Rv=null,zu}function B0(e){return qm(this,null,function*(){if(zu!==void 0)return zu;const r=gE();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:i}=yield mE(yield e,r);return yE(n,i)})}var gl;(function(e){e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(gl||(gl={}));var Gm;(function(e){e[e.READ=1]="READ",e[e.WRITE=2]="WRITE"})(Gm||(Gm={}));function _E(e){var r=0;return e&hc.SAMPLED&&(r|=gl.TEXTURE_BINDING|gl.COPY_DST|gl.COPY_SRC),e&hc.STORAGE&&(r|=gl.TEXTURE_BINDING|gl.STORAGE_BINDING|gl.COPY_SRC|gl.COPY_DST),e&hc.RENDER_TARGET&&(r|=gl.RENDER_ATTACHMENT|gl.TEXTURE_BINDING|gl.COPY_SRC|gl.COPY_DST),r}function Xm(e){if(e===fr.U8_R_NORM)return"r8unorm";if(e===fr.S8_R_NORM)return"r8snorm";if(e===fr.U8_RG_NORM)return"rg8unorm";if(e===fr.S8_RG_NORM)return"rg8snorm";if(e===fr.U32_R)return"r32uint";if(e===fr.S32_R)return"r32sint";if(e===fr.F32_R)return"r32float";if(e===fr.U16_RG)return"rg16uint";if(e===fr.S16_RG)return"rg16sint";if(e===fr.F16_RG)return"rg16float";if(e===fr.U8_RGBA_RT)return"bgra8unorm";if(e===fr.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(e===fr.U8_RGBA_NORM)return"rgba8unorm";if(e===fr.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(e===fr.S8_RGBA_NORM)return"rgba8snorm";if(e===fr.F32_RGB)return"rgb9e5ufloat";if(e===fr.U32_RG)return"rg32uint";if(e===fr.S32_RG)return"rg32sint";if(e===fr.F32_RG)return"rg32float";if(e===fr.U16_RGBA)return"rgba16uint";if(e===fr.S16_RGBA)return"rgba16sint";if(e===fr.F16_RGBA)return"rgba16float";if(e===fr.F32_RGBA)return"rgba32float";if(e===fr.U32_RGBA)return"rgba32uint";if(e===fr.S32_RGBA)return"rgba32sint";if(e===fr.D24)return"depth24plus";if(e===fr.D24_S8)return"depth24plus-stencil8";if(e===fr.D32F)return"depth32float";if(e===fr.D32F_S8)return"depth32float-stencil8";if(e===fr.BC1)return"bc1-rgba-unorm";if(e===fr.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(e===fr.BC2)return"bc2-rgba-unorm";if(e===fr.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(e===fr.BC3)return"bc3-rgba-unorm";if(e===fr.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(e===fr.BC4_SNORM)return"bc4-r-snorm";if(e===fr.BC4_UNORM)return"bc4-r-unorm";if(e===fr.BC5_SNORM)return"bc5-rg-snorm";if(e===fr.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function bE(e){if(e===Wa.TEXTURE_2D)return"2d";if(e===Wa.TEXTURE_CUBE_MAP)return"2d";if(e===Wa.TEXTURE_2D_ARRAY)return"2d";if(e===Wa.TEXTURE_3D)return"3d";throw new Error("whoops")}function xE(e){if(e===Wa.TEXTURE_2D)return"2d";if(e===Wa.TEXTURE_CUBE_MAP)return"cube";if(e===Wa.TEXTURE_2D_ARRAY)return"2d-array";if(e===Wa.TEXTURE_3D)return"3d";throw new Error("whoops")}function EE(e){var r=0;return e&as.INDEX&&(r|=GPUBufferUsage.INDEX),e&as.VERTEX&&(r|=GPUBufferUsage.VERTEX),e&as.UNIFORM&&(r|=GPUBufferUsage.UNIFORM),e&as.STORAGE&&(r|=GPUBufferUsage.STORAGE),e&as.COPY_SRC&&(r|=GPUBufferUsage.COPY_SRC),e&as.INDIRECT&&(r|=GPUBufferUsage.INDIRECT),r|=GPUBufferUsage.COPY_DST,r}function Ym(e){if(e===Zc.CLAMP_TO_EDGE)return"clamp-to-edge";if(e===Zc.REPEAT)return"repeat";if(e===Zc.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function F0(e){if(e===mu.BILINEAR)return"linear";if(e===mu.POINT)return"nearest";throw new Error("whoops")}function SE(e){if(e===ml.LINEAR)return"linear";if(e===ml.NEAREST)return"nearest";if(e===ml.NO_MIP)return"nearest";throw new Error("whoops")}function Up(e){var r=e;return r.gpuBuffer}function TE(e){var r=e;return r.gpuSampler}function AE(e){var r=e;return r.querySet}function CE(e){if(e===Jv.OcclusionConservative)return"occlusion";throw new Error("whoops")}function wE(e){switch(e){case Uu.TRIANGLES:return"triangle-list";case Uu.POINTS:return"point-list";case Uu.TRIANGLE_STRIP:return"triangle-strip";case Uu.LINES:return"line-list";case Uu.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function RE(e){if(e===of.NONE)return"none";if(e===of.FRONT)return"front";if(e===of.BACK)return"back";throw new Error("whoops")}function ME(e){if(e===Sv.CCW)return"ccw";if(e===Sv.CW)return"cw";throw new Error("whoops")}function IE(e,r){return{topology:wE(e),cullMode:RE(r.cullMode),frontFace:ME(r.frontFace)}}function N0(e){if(e===Ka.ZERO)return"zero";if(e===Ka.ONE)return"one";if(e===Ka.SRC)return"src";if(e===Ka.ONE_MINUS_SRC)return"one-minus-src";if(e===Ka.DST)return"dst";if(e===Ka.ONE_MINUS_DST)return"one-minus-dst";if(e===Ka.SRC_ALPHA)return"src-alpha";if(e===Ka.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===Ka.DST_ALPHA)return"dst-alpha";if(e===Ka.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(e===Ka.CONST)return"constant";if(e===Ka.ONE_MINUS_CONSTANT)return"one-minus-constant";if(e===Ka.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function OE(e){if(e===Ll.ADD)return"add";if(e===Ll.SUBSTRACT)return"subtract";if(e===Ll.REVERSE_SUBSTRACT)return"reverse-subtract";if(e===Ll.MIN)return"min";if(e===Ll.MAX)return"max";throw new Error("whoops")}function U0(e){return{operation:OE(e.blendMode),srcFactor:N0(e.blendSrcFactor),dstFactor:N0(e.blendDstFactor)}}function z0(e){return e.blendMode===Ll.ADD&&e.blendSrcFactor===Ka.ONE&&e.blendDstFactor===Ka.ZERO}function PE(e){if(!(z0(e.rgbBlendState)&&z0(e.alphaBlendState)))return{color:U0(e.rgbBlendState),alpha:U0(e.alphaBlendState)}}function DE(e,r){return{format:Xm(r),blend:PE(e),writeMask:e.channelWriteMask}}function kE(e,r){return r.attachmentsState.map(function(n,i){return DE(n,e[i])})}function dm(e){if(e===Fa.NEVER)return"never";if(e===Fa.LESS)return"less";if(e===Fa.EQUAL)return"equal";if(e===Fa.LEQUAL)return"less-equal";if(e===Fa.GREATER)return"greater";if(e===Fa.NOTEQUAL)return"not-equal";if(e===Fa.GEQUAL)return"greater-equal";if(e===Fa.ALWAYS)return"always";throw new Error("whoops")}function zp(e){if(e===eu.KEEP)return"keep";if(e===eu.REPLACE)return"replace";if(e===eu.ZERO)return"zero";if(e===eu.DECREMENT_CLAMP)return"decrement-clamp";if(e===eu.DECREMENT_WRAP)return"decrement-wrap";if(e===eu.INCREMENT_CLAMP)return"increment-clamp";if(e===eu.INCREMENT_WRAP)return"increment-wrap";if(e===eu.INVERT)return"invert";throw new Error("whoops")}function LE(e,r){if(!(0,qf.Z)(e))return{format:Xm(e),depthWriteEnabled:!!r.depthWrite,depthCompare:dm(r.depthCompare),depthBias:r.polygonOffset?1:0,depthBiasSlopeScale:r.polygonOffset?1:0,stencilFront:{compare:dm(r.stencilFront.compare),passOp:zp(r.stencilFront.passOp),failOp:zp(r.stencilFront.failOp),depthFailOp:zp(r.stencilFront.depthFailOp)},stencilBack:{compare:dm(r.stencilBack.compare),passOp:zp(r.stencilBack.passOp),failOp:zp(r.stencilBack.failOp),depthFailOp:zp(r.stencilBack.depthFailOp)},stencilReadMask:1,stencilWriteMask:1}}function BE(e){if(e!==null){if(e===fr.U16_R)return"uint16";if(e===fr.U32_R)return"uint32";throw new Error("whoops")}}function FE(e){if(e===Qd.VERTEX)return"vertex";if(e===Qd.INSTANCE)return"instance";throw new Error("whoops")}function NE(e){if(e===fr.U8_R)return"uint8x2";if(e===fr.U8_RG)return"uint8x2";if(e===fr.U8_RGB)return"uint8x4";if(e===fr.U8_RGBA)return"uint8x4";if(e===fr.U8_RG_NORM)return"unorm8x2";if(e===fr.U8_RGBA_NORM)return"unorm8x4";if(e===fr.S8_RGB_NORM)return"snorm8x4";if(e===fr.S8_RGBA_NORM)return"snorm8x4";if(e===fr.U16_RG_NORM)return"unorm16x2";if(e===fr.U16_RGBA_NORM)return"unorm16x4";if(e===fr.S16_RG_NORM)return"snorm16x2";if(e===fr.S16_RGBA_NORM)return"snorm16x4";if(e===fr.S16_RG)return"uint16x2";if(e===fr.F16_RG)return"float16x2";if(e===fr.F16_RGBA)return"float16x4";if(e===fr.F32_R)return"float32";if(e===fr.F32_RG)return"float32x2";if(e===fr.F32_RGB)return"float32x3";if(e===fr.F32_RGBA)return"float32x4";throw"whoops"}function UE(e){var r=Ih(e);switch(r){case xn.BC1:case xn.BC2:case xn.BC3:case xn.BC4_SNORM:case xn.BC4_UNORM:case xn.BC5_SNORM:case xn.BC5_UNORM:return!0;default:return!1}}function zE(e){var r=Ih(e);switch(r){case xn.BC1:case xn.BC2:case xn.BC3:case xn.BC4_SNORM:case xn.BC4_UNORM:case xn.BC5_SNORM:case xn.BC5_UNORM:return 4;default:return 1}}function Z0(e,r,n,i){switch(n===void 0&&(n=!1),e){case fr.S8_R:case fr.S8_R_NORM:case fr.S8_RG_NORM:case fr.S8_RGB_NORM:case fr.S8_RGBA_NORM:{var a=r instanceof ArrayBuffer?new Int8Array(r):new Int8Array(r);return i&&a.set(new Int8Array(i)),a}case fr.U8_R:case fr.U8_R_NORM:case fr.U8_RG:case fr.U8_RG_NORM:case fr.U8_RGB:case fr.U8_RGB_NORM:case fr.U8_RGB_SRGB:case fr.U8_RGBA:case fr.U8_RGBA_NORM:case fr.U8_RGBA_SRGB:{var s=r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r);return i&&s.set(new Uint8Array(i)),s}case fr.S16_R:case fr.S16_RG:case fr.S16_RG_NORM:case fr.S16_RGB_NORM:case fr.S16_RGBA:case fr.S16_RGBA_NORM:{var c=r instanceof ArrayBuffer?new Int16Array(r):new Int16Array(n?r/2:r);return i&&c.set(new Int16Array(i)),c}case fr.U16_R:case fr.U16_RGB:case fr.U16_RGBA_5551:case fr.U16_RGBA_NORM:case fr.U16_RG_NORM:case fr.U16_R_NORM:{var p=r instanceof ArrayBuffer?new Uint16Array(r):new Uint16Array(n?r/2:r);return i&&p.set(new Uint16Array(i)),p}case fr.S32_R:{var g=r instanceof ArrayBuffer?new Int32Array(r):new Int32Array(n?r/4:r);return i&&g.set(new Int32Array(i)),g}case fr.U32_R:case fr.U32_RG:{var b=r instanceof ArrayBuffer?new Uint32Array(r):new Uint32Array(n?r/4:r);return i&&b.set(new Uint32Array(i)),b}case fr.F32_R:case fr.F32_RG:case fr.F32_RGB:case fr.F32_RGBA:{var w=r instanceof ArrayBuffer?new Float32Array(r):new Float32Array(n?r/4:r);return i&&w.set(new Float32Array(i)),w}}var I=r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r);return i&&I.set(new Uint8Array(i)),I}function ZE(e){var r=(e&32768)>>15,n=(e&31744)>>10,i=e&1023;return n===0?(r?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):n==31?i?NaN:(r?-1:1)*(1/0):(r?-1:1)*Math.pow(2,n-15)*(1+i/Math.pow(2,10))}function j0(e){switch(e){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var gh=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this)||this;return s.id=i,s.device=a,s}return r.prototype.destroy=function(){},r}(f0),jE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,p,g=e.call(this,{id:i,device:a})||this;g.type=mo.Bindings;var b=s.pipeline;Ea(!!b);var w=s.uniformBufferBindings,I=s.storageBufferBindings,W=s.samplerBindings,pe=s.storageTextureBindings;g.numUniformBuffers=(w==null?void 0:w.length)||0;var Me=[[],[],[],[]],Fe=0;if(w&&w.length)for(var ut=0;ut<w.length;ut++){var Ot=s.uniformBufferBindings[ut],Bt=Ot.binding,ir=Ot.size,xr=Ot.offset,qr=Ot.buffer,Ir={buffer:Up(qr),offset:xr!=null?xr:0,size:ir};Me[0].push({binding:Bt!=null?Bt:Fe++,resource:Ir})}if(W&&W.length){Fe=0;for(var ut=0;ut<W.length;ut++){var mr=(0,bi.pi)((0,bi.pi)({},W[ut]),E0),Bt=s.samplerBindings[ut],sn=Bt.texture!==null?Bt.texture:g.device.getFallbackTexture(mr);mr.dimension=sn.dimension,mr.formatKind=v0(sn.format);var ti=sn.gpuTextureView;if(Me[1].push({binding:(c=Bt.textureBinding)!==null&&c!==void 0?c:Fe++,resource:ti}),Bt.samplerBinding!==-1){var Bi=Bt.sampler!==null?Bt.sampler:g.device.getFallbackSampler(mr),ai=TE(Bi);Me[1].push({binding:(p=Bt.samplerBinding)!==null&&p!==void 0?p:Fe++,resource:ai})}}}if(I&&I.length){Fe=0;for(var ut=0;ut<I.length;ut++){var ra=s.storageBufferBindings[ut],Bt=ra.binding,ir=ra.size,xr=ra.offset,qr=ra.buffer,Ir={buffer:Up(qr),offset:xr!=null?xr:0,size:ir};Me[2].push({binding:Bt!=null?Bt:Fe++,resource:Ir})}}if(pe&&pe.length){Fe=0;for(var ut=0;ut<pe.length;ut++){var fa=s.storageTextureBindings[ut],Bt=fa.binding,sn=fa.texture,ti=sn.gpuTextureView;Me[3].push({binding:Bt!=null?Bt:Fe++,resource:ti})}}var nu=Me.findLastIndex(function(yl){return!!yl.length});return g.gpuBindGroup=Me.map(function(yl,_l){return _l<=nu&&g.device.device.createBindGroup({layout:b.getBindGroupLayout(_l),entries:yl})}),g}return r}(gh),VE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.Buffer;var p=s.usage,g=s.viewOrSize,b=!!(p&as.MAP_READ);c.usage=EE(p),b&&(c.usage=as.MAP_READ|as.COPY_DST);var w=!(0,Ip.Z)(g);if(c.view=(0,Ip.Z)(g)?null:g,c.size=(0,Ip.Z)(g)?nm(g,4):nm(g.byteLength,4),(0,Ip.Z)(g))c.gpuBuffer=c.device.device.createBuffer({usage:c.usage,size:c.size,mappedAtCreation:b?w:!1});else{c.gpuBuffer=c.device.device.createBuffer({usage:c.usage,size:c.size,mappedAtCreation:!0});var I=g&&g.constructor||Float32Array;new I(c.gpuBuffer.getMappedRange()).set(g),c.gpuBuffer.unmap()}return c}return r.prototype.setSubData=function(n,i,a,s){a===void 0&&(a=0),s===void 0&&(s=0);var c=this.gpuBuffer;s=s||i.byteLength,s=Math.min(s,this.size-n);var p=i.byteOffset+a,g=p+s,b=s+3&-4;if(b!==s){var w=new Uint8Array(i.buffer.slice(p,g));i=new Uint8Array(b),i.set(w),a=0,p=0,g=b,s=b}for(var I=1024*1024*15,W=0;g-(p+W)>I;)this.device.device.queue.writeBuffer(c,n+W,i.buffer,p+W,I),W+=I;this.device.device.queue.writeBuffer(c,n+W,i.buffer,p+W,s-W)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuBuffer.destroy()},r}(gh),V0=function(){function e(){this.gpuComputePassEncoder=null}return e.prototype.dispatchWorkgroups=function(r,n,i){this.gpuComputePassEncoder.dispatchWorkgroups(r,n,i)},e.prototype.dispatchWorkgroupsIndirect=function(r,n){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(r.gpuBuffer,n)},e.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},e.prototype.beginComputePass=function(r){Ea(this.gpuComputePassEncoder===null),this.frameCommandEncoder=r,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},e.prototype.setPipeline=function(r){var n=r,i=Jd(n.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(i)},e.prototype.setBindings=function(r){var n=this,i=r;i.gpuBindGroup.forEach(function(a,s){a&&n.gpuComputePassEncoder.setBindGroup(s,i.gpuBindGroup[s])})},e.prototype.pushDebugGroup=function(r){this.gpuComputePassEncoder.pushDebugGroup(r)},e.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(r){this.gpuComputePassEncoder.insertDebugMarker(r)},e}(),HE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.ComputePipeline,c.gpuComputePipeline=null,c.descriptor=s;var p=s.program,g=p.computeStage;if(g===null)return c;var b={layout:"auto",compute:(0,bi.pi)({},g)};return c.gpuComputePipeline=c.device.device.createComputePipeline(b),c.name!==void 0&&(c.gpuComputePipeline.label=c.name),c}return r.prototype.getBindGroupLayout=function(n){return this.gpuComputePipeline.getBindGroupLayout(n)},r}(gh),$E=function(e){(0,bi.ZT)(r,e);function r(n){var i,a,s,c,p=n.id,g=n.device,b=n.descriptor,w=e.call(this,{id:p,device:g})||this;w.type=mo.InputLayout;var I=[];try{for(var W=(0,bi.XA)(b.vertexBufferDescriptors),pe=W.next();!pe.done;pe=W.next()){var Me=pe.value,Fe=Me.arrayStride,ut=Me.stepMode,Ot=Me.attributes;I.push({arrayStride:Fe,stepMode:FE(ut),attributes:[]});try{for(var Bt=(s=void 0,(0,bi.XA)(Ot)),ir=Bt.next();!ir.done;ir=Bt.next()){var xr=ir.value,qr=xr.shaderLocation,Ir=xr.format,mr=xr.offset;I[I.length-1].attributes.push({shaderLocation:qr,format:NE(Ir),offset:mr})}}catch(sn){s={error:sn}}finally{try{ir&&!ir.done&&(c=Bt.return)&&c.call(Bt)}finally{if(s)throw s.error}}}}catch(sn){i={error:sn}}finally{try{pe&&!pe.done&&(a=W.return)&&a.call(W)}finally{if(i)throw i.error}}return w.indexFormat=BE(b.indexBufferFormat),w.buffers=I,w}return r}(gh),H0=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;return c.type=mo.Program,c.vertexStage=null,c.fragmentStage=null,c.computeStage=null,c.descriptor=s,s.vertex&&(c.vertexStage=c.createShaderStage(s.vertex,"vertex")),s.fragment&&(c.fragmentStage=c.createShaderStage(s.fragment,"fragment")),s.compute&&(c.computeStage=c.createShaderStage(s.compute,"compute")),c}return r.prototype.setUniformsLegacy=function(n){},r.prototype.createShaderStage=function(n,i){var a,s,c=n.glsl,p=n.wgsl,g=n.entryPoint,b=n.postprocess,w=!1,I=p;if(!I)try{I=this.device.glsl_compile(c,i,w)}catch(Ot){throw console.error(Ot,c),new Error("whoops")}var W=function(Ot){if(!I.includes(Ot))return"continue";I=I.replace("var T_".concat(Ot,": texture_2d<f32>;"),"var T_".concat(Ot,": texture_depth_2d;")),I=I.replace(new RegExp("textureSample\\(T_".concat(Ot,"(.*)\\);$"),"gm"),function(Bt,ir){return"vec4<f32>(textureSample(T_".concat(Ot).concat(ir,"), 0.0, 0.0, 0.0);")})};try{for(var pe=(0,bi.XA)(["u_TextureFramebufferDepth"]),Me=pe.next();!Me.done;Me=pe.next()){var Fe=Me.value;W(Fe)}}catch(Ot){a={error:Ot}}finally{try{Me&&!Me.done&&(s=pe.return)&&s.call(pe)}finally{if(a)throw a.error}}b&&(I=b(I));var ut=this.device.device.createShaderModule({code:I});return{module:ut,entryPoint:g||"main"}},r}(gh),WE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;c.type=mo.QueryPool;var p=s.elemCount,g=s.type;return c.querySet=c.device.device.createQuerySet({type:CE(g),count:p}),c.resolveBuffer=c.device.device.createBuffer({size:p*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),c.cpuBuffer=c.device.device.createBuffer({size:p*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),c.results=null,c}return r.prototype.queryResultOcclusion=function(n){return this.results===null?null:this.results[n]!==BigInt(0)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},r}(gh),GE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this,{id:i,device:a})||this;return s.type=mo.Readback,s}return r.prototype.readTexture=function(n,i,a,s,c,p,g,b){return g===void 0&&(g=0),(0,bi.mG)(this,void 0,void 0,function(){var w,I,W,pe,Me,Fe,ut,Ot;return(0,bi.Jh)(this,function(Bt){return w=n,I=0,W=j0(w.gpuTextureformat),pe=Math.ceil(s/W.width)*W.length,Me=Math.ceil(pe/256)*256,Fe=Me*c,ut=this.device.createBuffer({usage:as.STORAGE|as.MAP_READ|as.COPY_DST,hint:mh.STATIC,viewOrSize:Fe}),Ot=this.device.device.createCommandEncoder(),Ot.copyTextureToBuffer({texture:w.gpuTexture,mipLevel:0,origin:{x:i,y:a,z:Math.max(I,0)}},{buffer:ut.gpuBuffer,offset:0,bytesPerRow:Me},{width:s,height:c,depthOrArrayLayers:1}),this.device.device.queue.submit([Ot.finish()]),[2,this.readBuffer(ut,0,p.byteLength===Fe?p:null,g,Fe,w.format,!0,!1,pe,Me,c)]})})},r.prototype.readTextureSync=function(n,i,a,s,c,p,g,b){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},r.prototype.readBuffer=function(n,i,a,s,c,p,g,b,w,I,W){var pe=this;i===void 0&&(i=0),a===void 0&&(a=null),c===void 0&&(c=0),p===void 0&&(p=fr.U8_RGB),g===void 0&&(g=!1),w===void 0&&(w=0),I===void 0&&(I=0),W===void 0&&(W=0);var Me=n,Fe=c||Me.size,ut=a||Me.view,Ot=ut&&ut.constructor&&ut.constructor.BYTES_PER_ELEMENT||p0(p),Bt=Me;if(!(Me.usage&as.MAP_READ&&Me.usage&as.COPY_DST)){var ir=this.device.device.createCommandEncoder();Bt=this.device.createBuffer({usage:as.STORAGE|as.MAP_READ|as.COPY_DST,hint:mh.STATIC,viewOrSize:Fe}),ir.copyBufferToBuffer(Me.gpuBuffer,i,Bt.gpuBuffer,0,Fe),this.device.device.queue.submit([ir.finish()])}return new Promise(function(xr,qr){Bt.gpuBuffer.mapAsync(Gm.READ,i,Fe).then(function(){var Ir=Bt.gpuBuffer.getMappedRange(i,Fe),mr=ut;if(g)mr===null?mr=Z0(p,Fe,!0,Ir):mr=Z0(p,mr.buffer,void 0,Ir);else if(mr===null)switch(Ot){case 1:mr=new Uint8Array(Fe),mr.set(new Uint8Array(Ir));break;case 2:mr=pe.getHalfFloatAsFloatRGBAArrayBuffer(Fe/2,Ir);break;case 4:mr=new Float32Array(Fe/4),mr.set(new Float32Array(Ir));break}else switch(Ot){case 1:mr=new Uint8Array(mr.buffer),mr.set(new Uint8Array(Ir));break;case 2:mr=pe.getHalfFloatAsFloatRGBAArrayBuffer(Fe/2,Ir,ut);break;case 4:var sn=ut&&ut.constructor||Float32Array;mr=new sn(mr.buffer),mr.set(new sn(Ir));break}if(w!==I){Ot===1&&!g&&(w*=2,I*=2);for(var ti=new Uint8Array(mr.buffer),Bi=w,ai=0,ra=1;ra<W;++ra){ai=ra*I;for(var fa=0;fa<w;++fa)ti[Bi++]=ti[ai++]}Ot!==0&&!g?mr=new Float32Array(ti.buffer,0,Bi/4):mr=new Uint8Array(ti.buffer,0,Bi)}Bt.gpuBuffer.unmap(),xr(mr)},function(Ir){return qr(Ir)})})},r.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(n,i,a){a||(a=new Float32Array(n));for(var s=new Uint16Array(i);n--;)a[n]=ZE(s[n]);return a},r}(gh),$0=function(){function e(r){this.device=r,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return e.prototype.getEncoder=function(){var r;return((r=this.renderBundle)===null||r===void 0?void 0:r.renderBundleEncoder)||this.gpuRenderPassEncoder},e.prototype.getTextureView=function(r,n){return Ea(n<r.mipLevelCount),r.mipLevelCount===1?r.gpuTextureView:r.gpuTexture.createView({baseMipLevel:n,mipLevelCount:1})},e.prototype.setRenderPassDescriptor=function(r){var n,i,a,s,c,p;this.descriptor=r,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var g=r.colorAttachment.length;this.gfxColorAttachment.length=g,this.gfxColorResolveTo.length=g;for(var b=0;b<r.colorAttachment.length;b++){var w=r.colorAttachment[b],I=r.colorResolveTo[b];if(w===null&&I!==null&&(w=I,I=null),this.gfxColorAttachment[b]=w,this.gfxColorResolveTo[b]=I,this.gfxColorAttachmentLevel[b]=((n=r.colorAttachmentLevel)===null||n===void 0?void 0:n[b])||0,this.gfxColorResolveToLevel[b]=((i=r.colorResolveToLevel)===null||i===void 0?void 0:i[b])||0,w!==null){this.gpuColorAttachments[b]===void 0&&(this.gpuColorAttachments[b]={});var W=this.gpuColorAttachments[b];W.view=this.getTextureView(w,((a=this.gfxColorAttachmentLevel)===null||a===void 0?void 0:a[b])||0);var pe=(c=(s=r.colorClearColor)===null||s===void 0?void 0:s[b])!==null&&c!==void 0?c:"load";pe==="load"?W.loadOp="load":(W.loadOp="clear",W.clearValue=pe),W.storeOp=!((p=r.colorStore)===null||p===void 0)&&p[b]?"store":"discard",W.resolveTarget=void 0,I!==null&&(w.sampleCount>1?W.resolveTarget=this.getTextureView(I,this.gfxColorResolveToLevel[b]):W.storeOp="store")}else{this.gpuColorAttachments.length=b,this.gfxColorAttachment.length=b,this.gfxColorResolveTo.length=b;break}}if(this.gfxDepthStencilAttachment=r.depthStencilAttachment,this.gfxDepthStencilResolveTo=r.depthStencilResolveTo,r.depthStencilAttachment){var Me=r.depthStencilAttachment,W=this.gpuDepthStencilAttachment;W.view=Me.gpuTextureView;var Fe=!!(Pp(Me.format)&pi.Depth);Fe?(r.depthClearValue==="load"?W.depthLoadOp="load":(W.depthLoadOp="clear",W.depthClearValue=r.depthClearValue),r.depthStencilStore||this.gfxDepthStencilResolveTo!==null?W.depthStoreOp="store":W.depthStoreOp="discard"):(W.depthLoadOp=void 0,W.depthStoreOp=void 0);var ut=!!(Pp(Me.format)&pi.Stencil);ut?(r.stencilClearValue==="load"?W.stencilLoadOp="load":(W.stencilLoadOp="clear",W.stencilClearValue=r.stencilClearValue),r.depthStencilStore||this.gfxDepthStencilResolveTo!==null?W.stencilStoreOp="store":W.stencilStoreOp="discard"):(W.stencilLoadOp=void 0,W.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=(0,qf.Z)(r.occlusionQueryPool)?void 0:AE(r.occlusionQueryPool)},e.prototype.beginRenderPass=function(r,n){Ea(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(n),this.frameCommandEncoder=r,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},e.prototype.flipY=function(r,n){var i=this.device.swapChainHeight;return i-r-n},e.prototype.setViewport=function(r,n,i,a,s,c){s===void 0&&(s=0),c===void 0&&(c=1),this.gpuRenderPassEncoder.setViewport(r,this.flipY(n,a),i,a,s,c)},e.prototype.setScissorRect=function(r,n,i,a){this.gpuRenderPassEncoder.setScissorRect(r,this.flipY(n,a),i,a)},e.prototype.setPipeline=function(r){var n=r,i=Jd(n.gpuRenderPipeline);this.getEncoder().setPipeline(i)},e.prototype.setVertexInput=function(r,n,i){if(r!==null){var a=this.getEncoder(),s=r;i!==null&&a.setIndexBuffer(Up(i.buffer),Jd(s.indexFormat),i.offset);for(var c=0;c<n.length;c++){var p=n[c];p!==null&&a.setVertexBuffer(c,Up(p.buffer),p.offset)}}},e.prototype.setBindings=function(r){var n=r,i=this.getEncoder();n.gpuBindGroup.forEach(function(a,s){a&&i.setBindGroup(s,n.gpuBindGroup[s])})},e.prototype.setStencilReference=function(r){this.gpuRenderPassEncoder.setStencilReference(r)},e.prototype.draw=function(r,n,i,a){this.getEncoder().draw(r,n,i,a)},e.prototype.drawIndexed=function(r,n,i,a,s){this.getEncoder().drawIndexed(r,n,i,a,s)},e.prototype.drawIndirect=function(r,n){this.getEncoder().drawIndirect(Up(r),n)},e.prototype.drawIndexedIndirect=function(r,n){this.getEncoder().drawIndexedIndirect(Up(r),n)},e.prototype.beginOcclusionQuery=function(r){this.gpuRenderPassEncoder.beginOcclusionQuery(r)},e.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},e.prototype.pushDebugGroup=function(r){this.gpuRenderPassEncoder.pushDebugGroup(r)},e.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(r){this.gpuRenderPassEncoder.insertDebugMarker(r)},e.prototype.beginBundle=function(r){this.renderBundle=r},e.prototype.endBundle=function(){this.renderBundle.finish()},e.prototype.executeBundles=function(r){this.gpuRenderPassEncoder.executeBundles(r.map(function(n){return n.renderBundle}))},e.prototype.finish=function(){var r;(r=this.gpuRenderPassEncoder)===null||r===void 0||r.end(),this.gpuRenderPassEncoder=null;for(var n=0;n<this.gfxColorAttachment.length;n++){var i=this.gfxColorAttachment[n],a=this.gfxColorResolveTo[n];i!==null&&a!==null&&i.sampleCount===1&&this.copyAttachment(a,this.gfxColorAttachmentLevel[n],i,this.gfxColorResolveToLevel[n])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},e.prototype.copyAttachment=function(r,n,i,a){Ea(i.sampleCount===1);var s={texture:i.gpuTexture,mipLevel:a},c={texture:r.gpuTexture,mipLevel:n};Ea(i.width>>>a===r.width>>>n),Ea(i.height>>>a===r.height>>>n),Ea(!!(i.usage&gl.COPY_SRC)),Ea(!!(r.usage&gl.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(s,c,[r.width,r.height,1])},e}(),XE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=e.call(this,{id:i,device:a})||this;return c.type=mo.RenderPipeline,c.isCreatingAsync=!1,c.gpuRenderPipeline=null,c.descriptor=s,c.device.createRenderPipelineInternal(c,!1),c}return r.prototype.getBindGroupLayout=function(n){return this.gpuRenderPipeline.getBindGroupLayout(n)},r}(gh),YE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c,p,g=e.call(this,{id:i,device:a})||this;g.type=mo.Sampler;var b=s.lodMinClamp,w=s.mipmapFilter===ml.NO_MIP?s.lodMinClamp:s.lodMaxClamp,I=(c=s.maxAnisotropy)!==null&&c!==void 0?c:1;return I>1&&Ea(s.minFilter===mu.BILINEAR&&s.magFilter===mu.BILINEAR&&s.mipmapFilter===ml.LINEAR),g.gpuSampler=g.device.device.createSampler({addressModeU:Ym(s.addressModeU),addressModeV:Ym(s.addressModeV),addressModeW:Ym((p=s.addressModeW)!==null&&p!==void 0?p:s.addressModeU),lodMinClamp:b,lodMaxClamp:w,minFilter:F0(s.minFilter),magFilter:F0(s.magFilter),mipmapFilter:SE(s.mipmapFilter),compare:s.compareFunction!==void 0?dm(s.compareFunction):void 0,maxAnisotropy:I}),g}return r}(gh),pm=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=n.descriptor,c=n.skipCreate,p=n.sampleCount,g=e.call(this,{id:i,device:a})||this;g.type=mo.Texture,g.flipY=!1;var b=s.format,w=s.dimension,I=s.width,W=s.height,pe=s.depthOrArrayLayers,Me=s.mipLevelCount,Fe=s.usage,ut=s.pixelStore;return g.flipY=!!(ut!=null&&ut.unpackFlipY),g.device.createTextureShared({format:b,dimension:w!=null?w:Wa.TEXTURE_2D,width:I,height:W,depthOrArrayLayers:pe!=null?pe:1,mipLevelCount:Me!=null?Me:1,usage:Fe,sampleCount:p!=null?p:1},g,c),g}return r.prototype.textureFromImageBitmapOrCanvas=function(n,i,a){for(var s=i[0].width,c=i[0].height,p={size:{width:s,height:c,depthOrArrayLayers:a},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},g=n.createTexture(p),b=0;b<i.length;b++)n.queue.copyExternalImageToTexture({source:i[b],flipY:this.flipY},{texture:g,origin:[0,0,b]},[s,c]);return[g,s,c]},r.prototype.isImageBitmapOrCanvases=function(n){var i=n[0];return i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof OffscreenCanvas},r.prototype.isVideo=function(n){var i=n[0];return i instanceof HTMLVideoElement},r.prototype.setImageData=function(n,i){var a,s=this,c=this.device.device,p,g,b;if(this.isImageBitmapOrCanvases(n))a=(0,bi.CR)(this.textureFromImageBitmapOrCanvas(c,n,this.depthOrArrayLayers),3),p=a[0],g=a[1],b=a[2];else if(this.isVideo(n))p=c.importExternalTexture({source:n[0]});else{var w=j0(this.gpuTextureformat),I=Math.ceil(this.width/w.width)*w.length;n.forEach(function(W){c.queue.writeTexture({texture:s.gpuTexture},W,{bytesPerRow:I},{width:s.width,height:s.height})})}this.width=g,this.height=b,p&&(this.gpuTexture=p),this.gpuTextureView=this.gpuTexture.createView({dimension:xE(this.dimension)})},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuTexture.destroy()},r}(gh),KE=function(e){(0,bi.ZT)(r,e);function r(n){var i=n.id,a=n.device,s=e.call(this,{id:i,device:a})||this;return s.type=mo.RenderBundle,s.renderBundleEncoder=s.device.device.createRenderBundleEncoder({colorFormats:[s.device.swapChainFormat]}),s}return r.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},r}(gh),qE=function(){function e(r,n,i,a,s,c){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=gl.RENDER_ATTACHMENT|gl.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Mh.UPPER_LEFT,this.clipSpaceNearZ=Op.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=n,this.canvas=i,this.canvasContext=a,this.glsl_compile=s,this.WGSLComposer=c,this.fallbackTexture2D=this.createFallbackTexture(Wa.TEXTURE_2D,tu.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(Wa.TEXTURE_2D,tu.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(Wa.TEXTURE_2D_ARRAY,tu.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(Wa.TEXTURE_3D,tu.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(Wa.TEXTURE_CUBE_MAP,tu.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:Zc.REPEAT,addressModeV:Zc.REPEAT,minFilter:mu.POINT,magFilter:mu.POINT,mipmapFilter:ml.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:Zc.REPEAT,addressModeV:Zc.REPEAT,minFilter:mu.POINT,magFilter:mu.POINT,mipmapFilter:ml.NEAREST,compareFunction:Fa.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(p){console.error(p.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return e.prototype.destroy=function(){},e.prototype.configureSwapChain=function(r,n){this.swapChainWidth===r&&this.swapChainHeight===n||(this.swapChainWidth=r,this.swapChainHeight=n)},e.prototype.getOnscreenTexture=function(){var r=this.canvasContext.getCurrentTexture(),n=r.createView(),i=new pm({id:0,device:this,descriptor:{format:fr.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:Wa.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return i.depthOrArrayLayers=1,i.sampleCount=1,i.gpuTexture=r,i.gpuTextureView=n,i.name="Onscreen",this.setResourceName(i,"Onscreen Texture"),i},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.canvas},e.prototype.beginFrame=function(){Ea(this.frameCommandEncoderPool.length===0)},e.prototype.endFrame=function(){Ea(this.frameCommandEncoderPool.every(function(r){return r!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(r){return r.finish()})),this.frameCommandEncoderPool=[]},e.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},e.prototype.createBuffer=function(r){return new VE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createTexture=function(r){return new pm({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createSampler=function(r){return new YE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderTarget=function(r){var n=new pm({id:this.getNextUniqueId(),device:this,descriptor:(0,bi.pi)((0,bi.pi)({},r),{dimension:Wa.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:hc.RENDER_TARGET}),sampleCount:r.sampleCount});return n.depthOrArrayLayers=1,n.type=mo.RenderTarget,n},e.prototype.createRenderTargetFromTexture=function(r){var n=r,i=n.format,a=n.width,s=n.height,c=n.depthOrArrayLayers,p=n.sampleCount,g=n.mipLevelCount,b=n.gpuTexture,w=n.gpuTextureView,I=n.usage;Ea(!!(I&gl.RENDER_ATTACHMENT));var W=new pm({id:this.getNextUniqueId(),device:this,descriptor:{format:i,width:a,height:s,depthOrArrayLayers:c,dimension:Wa.TEXTURE_2D,mipLevelCount:g,usage:I},skipCreate:!0});return W.depthOrArrayLayers=c,W.sampleCount=p,W.gpuTexture=b,W.gpuTextureView=w,W},e.prototype.createProgram=function(r){var n,i;return!((n=r.vertex)===null||n===void 0)&&n.glsl&&(r.vertex.glsl=_d(this.queryVendorInfo(),"vert",r.vertex.glsl)),!((i=r.fragment)===null||i===void 0)&&i.glsl&&(r.fragment.glsl=_d(this.queryVendorInfo(),"frag",r.fragment.glsl)),new H0({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createProgramSimple=function(r){return new H0({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createTextureShared=function(r,n,i){var a={width:r.width,height:r.height,depthOrArrayLayers:r.depthOrArrayLayers},s=r.mipLevelCount,c=Xm(r.format),p=bE(r.dimension),g=_E(r.usage);if(n.gpuTextureformat=c,n.dimension=r.dimension,n.format=r.format,n.width=r.width,n.height=r.height,n.depthOrArrayLayers=r.depthOrArrayLayers,n.mipLevelCount=s,n.usage=g,n.sampleCount=r.sampleCount,!i){var b=this.device.createTexture({size:a,mipLevelCount:s,format:c,dimension:p,sampleCount:r.sampleCount,usage:g}),w=b.createView();n.gpuTexture=b,n.gpuTextureView=w}},e.prototype.getFallbackSampler=function(r){var n=r.formatKind;return n===tu.Depth&&r.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},e.prototype.getFallbackTexture=function(r){var n=r.dimension,i=r.formatKind;if(n===Wa.TEXTURE_2D)return i===tu.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(n===Wa.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(n===Wa.TEXTURE_3D)return this.fallbackTexture3D;if(n===Wa.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.createFallbackTexture=function(r,n){var i=r===Wa.TEXTURE_CUBE_MAP?6:1,a=n===tu.Float?fr.U8_RGBA_NORM:fr.D24;return this.createTexture({dimension:r,format:a,usage:hc.SAMPLED,width:1,height:1,depthOrArrayLayers:i,mipLevelCount:1})},e.prototype.createBindings=function(r){return new jE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createInputLayout=function(r){return new $E({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createComputePipeline=function(r){return new HE({id:this.getNextUniqueId(),device:this,descriptor:r})},e.prototype.createRenderPipeline=function(r){return new XE({id:this.getNextUniqueId(),device:this,descriptor:(0,bi.pi)({},r)})},e.prototype.createQueryPool=function(r,n){return new WE({id:this.getNextUniqueId(),device:this,descriptor:{type:r,elemCount:n}})},e.prototype.createRenderPipelineInternal=function(r,n){var i;if(r.gpuRenderPipeline===null){var a=r.descriptor,s=a.program,c=s.vertexStage,p=s.fragmentStage;if(!(c===null||p===null)){var g=a.megaStateDescriptor||{},b=g.stencilBack,w=g.stencilFront,I=(0,bi._T)(g,["stencilBack","stencilFront"]),W=Lp(ep);a.megaStateDescriptor=(0,bi.pi)((0,bi.pi)((0,bi.pi)({},W),{stencilBack:(0,bi.pi)((0,bi.pi)({},W.stencilBack),b),stencilFront:(0,bi.pi)((0,bi.pi)({},W.stencilFront),w)}),I);var pe=a.megaStateDescriptor.attachmentsState[0];a.colorAttachmentFormats.forEach(function(xr,qr){a.megaStateDescriptor.attachmentsState[qr]||(a.megaStateDescriptor.attachmentsState[qr]=b0(void 0,pe))});var Me=IE((i=a.topology)!==null&&i!==void 0?i:Uu.TRIANGLES,a.megaStateDescriptor),Fe=kE(a.colorAttachmentFormats,a.megaStateDescriptor),ut=LE(a.depthStencilAttachmentFormat,a.megaStateDescriptor),Ot=void 0;a.inputLayout!==null&&(Ot=a.inputLayout.buffers);var Bt=a.sampleCount,ir={layout:"auto",vertex:(0,bi.pi)((0,bi.pi)({},c),{buffers:Ot}),primitive:Me,depthStencil:ut,multisample:{count:Bt},fragment:(0,bi.pi)((0,bi.pi)({},p),{targets:Fe})};r.gpuRenderPipeline=this.device.createRenderPipeline(ir)}}},e.prototype.createReadback=function(){return new GE({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderBundle=function(){return new KE({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderPass=function(r){var n=this.renderPassPool.pop();n===void 0&&(n=new $0(this));var i=this.frameCommandEncoderPool.pop();return i===void 0&&(i=this.device.createCommandEncoder()),n.beginRenderPass(i,r),n},e.prototype.createComputePass=function(){var r=this.computePassPool.pop();r===void 0&&(r=new V0);var n=this.frameCommandEncoderPool.pop();return n===void 0&&(n=this.device.createCommandEncoder()),r.beginComputePass(n),r},e.prototype.submitPass=function(r){var n=r;n instanceof $0?(this.frameCommandEncoderPool.push(n.frameCommandEncoder),n.finish(),this.renderPassPool.push(n)):n instanceof V0&&(this.frameCommandEncoderPool.push(n.frameCommandEncoder),n.finish(),this.computePassPool.push(n))},e.prototype.copySubTexture2D=function(r,n,i,a,s,c,p){var g=this.device.createCommandEncoder(),b=r,w=a,I={texture:w.gpuTexture,origin:[s,c,0],mipLevel:0,aspect:"all"},W={texture:b.gpuTexture,origin:[n,i,0],mipLevel:0,aspect:"all"};Ea(!!(w.usage&gl.COPY_SRC)),Ea(!!(b.usage&gl.COPY_DST)),g.copyTextureToTexture(I,W,[w.width,w.height,p||1]),this.device.queue.submit([g.finish()])},e.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},e.prototype.queryTextureFormatSupported=function(r,n,i){if(UE(r)){if(!this.featureTextureCompressionBC)return!1;var a=zE(r);return n%a!==0||i%a!==0?!1:this.featureTextureCompressionBC}switch(r){case fr.U16_RGBA_NORM:return!1;case fr.F32_RGBA:return!1}return!0},e.prototype.queryPlatformAvailable=function(){return!0},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(r){var n=r;return n.descriptor},e.prototype.queryRenderTarget=function(r){var n=r;return n},e.prototype.setResourceName=function(r,n){if(r.name=n,r.type===mo.Buffer){var i=r;i.gpuBuffer.label=n}else if(r.type===mo.Texture){var i=r;i.gpuTexture.label=n,i.gpuTextureView.label=n}else if(r.type===mo.RenderTarget){var i=r;i.gpuTexture.label=n,i.gpuTextureView.label=n}else if(r.type===mo.Sampler){var i=r;i.gpuSampler.label=n}else if(r.type===mo.RenderPipeline){var i=r;i.gpuRenderPipeline!==null&&(i.gpuRenderPipeline.label=n)}},e.prototype.setResourceLeakCheck=function(r,n){},e.prototype.checkForLeaks=function(){},e.prototype.programPatched=function(r){},e.prototype.pipelineQueryReady=function(r){var n=r;return n.gpuRenderPipeline!==null},e.prototype.pipelineForceReady=function(r){var n=r;this.createRenderPipelineInternal(n,!1)},e}(),QE=function(){function e(r){this.pluginOptions=r}return e.prototype.createSwapChain=function(r){return(0,bi.mG)(this,void 0,void 0,function(){var n,i,a,s,c,p,g,b;return(0,bi.Jh)(this,function(w){switch(w.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];n=null,w.label=1;case 1:return w.trys.push([1,3,,4]),i=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:i})];case 2:return n=w.sent(),[3,4];case 3:return a=w.sent(),console.log(a),[3,4];case 4:return n===null?[2,null]:(s=["depth32float-stencil8","texture-compression-bc","float32-filterable"],c=s.filter(function(I){return n.features.has(I)}),[4,n.requestDevice({requiredFeatures:c})]);case 5:if(p=w.sent(),p&&(g=this.pluginOptions.onContextLost,p.lost.then(function(){g&&g()})),p===null)return[2,null];if(b=r.getContext("webgpu"),!b)return[2,null];w.label=6;case 6:return w.trys.push([6,8,,9]),[4,B0(this.pluginOptions.shaderCompilerPath)];case 7:return w.sent(),[3,9];case 8:return w.sent(),[3,9];case 9:return[2,new qE(n,p,r,b,vE,Pv&&new Pv)]}})})},e}(),JE=ze.rU.isPlainObject,eS=ze.rU.isTypedArray,tS=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"destroyed",!1),(0,G.Z)(this,"uniforms",{}),this.reGl=r;var i=n.vs,a=n.fs,s=n.attributes,c=n.uniforms,p=n.primitive,g=n.count,b=n.elements,w=n.depth,I=n.cull,W=n.instances,pe={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Mh.LOWER_LEFT,clipSpaceNearZ:Op.NEGATIVE_ONE,supportMRT:!1},Me={};this.options=n,c&&(this.uniforms=this.extractUniforms(c),Object.keys(c).forEach(function(ir){Me[ir]=r.prop(ir)}));var Fe={};Object.keys(s).forEach(function(ir){Fe[ir]=s[ir].get()});var ut=(0,$.Vb)(_d(pe,"frag",a,null,!1)),Ot=(0,$.Vb)(_d(pe,"vert",i,null,!1)),Bt={attributes:Fe,frag:ut,uniforms:Me,vert:Ot,colorMask:r.prop("colorMask"),lineWidth:1,blend:{enable:r.prop("blend.enable"),func:r.prop("blend.func"),equation:r.prop("blend.equation"),color:r.prop("blend.color")},stencil:{enable:r.prop("stencil.enable"),mask:r.prop("stencil.mask"),func:r.prop("stencil.func"),opFront:r.prop("stencil.opFront"),opBack:r.prop("stencil.opBack")},primitive:Vb[p===void 0?$.gl.TRIANGLES:p]};W&&(Bt.instances=W),g?Bt.count=g:b&&(Bt.elements=b.get()),this.initDepthDrawParams({depth:w},Bt),this.initCullDrawParams({cull:I},Bt),this.drawCommand=r(Bt),this.drawParams=Bt}return(0,We.Z)(e,[{key:"updateAttributesAndElements",value:function(n,i){var a={};Object.keys(n).forEach(function(s){a[s]=n[s].get()}),this.drawParams.attributes=a,this.drawParams.elements=i.get(),this.drawCommand=this.reGl(this.drawParams)}},{key:"updateAttributes",value:function(n){var i={};Object.keys(n).forEach(function(a){i[a]=n[a].get()}),this.drawParams.attributes=i,this.drawCommand=this.reGl(this.drawParams)}},{key:"addUniforms",value:function(n){this.uniforms=(0,fe.Z)((0,fe.Z)({},this.uniforms),this.extractUniforms(n))}},{key:"draw",value:function(n,i){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var a=(0,fe.Z)((0,fe.Z)({},this.uniforms),this.extractUniforms(n.uniforms||{})),s={};Object.keys(a).forEach(function(c){var p=(0,Oi.Z)(a[c]);p==="boolean"||p==="number"||Array.isArray(a[c])||a[c].BYTES_PER_ELEMENT?s[c]=a[c]:s[c]=a[c].get()}),s.blend=i?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(n),s.stencil=this.getStencilDrawParams(n),s.colorMask=this.getColorMaskDrawParams(n,i),this.drawCommand(s)}}},{key:"destroy",value:function(){var n;(n=this.drawParams)===null||n===void 0||(n=n.elements)===null||n===void 0||n.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i==null||i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(n,i){var a=n.depth;a&&(i.depth={enable:a.enable===void 0?!0:!!a.enable,mask:a.mask===void 0?!0:!!a.mask,func:Gb[a.func||$.gl.LESS],range:a.range||[0,1]})}},{key:"getBlendDrawParams",value:function(n){var i=n.blend,a=i||{},s=a.enable,c=a.func,p=a.equation,g=a.color,b=g===void 0?[0,0,0,0]:g;return{enable:!!s,func:{srcRGB:Qv[c&&c.srcRGB||$.gl.SRC_ALPHA],srcAlpha:Qv[c&&c.srcAlpha||$.gl.SRC_ALPHA],dstRGB:Qv[c&&c.dstRGB||$.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Qv[c&&c.dstAlpha||$.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:c0[p&&p.rgb||$.gl.FUNC_ADD],alpha:c0[p&&p.alpha||$.gl.FUNC_ADD]},color:b}}},{key:"getStencilDrawParams",value:function(n){var i=n.stencil,a=i||{},s=a.enable,c=a.mask,p=c===void 0?-1:c,g=a.func,b=g===void 0?{cmp:$.gl.ALWAYS,ref:0,mask:-1}:g,w=a.opFront,I=w===void 0?{fail:$.gl.KEEP,zfail:$.gl.KEEP,zpass:$.gl.KEEP}:w,W=a.opBack,pe=W===void 0?{fail:$.gl.KEEP,zfail:$.gl.KEEP,zpass:$.gl.KEEP}:W;return{enable:!!s,mask:p,func:(0,fe.Z)((0,fe.Z)({},b),{},{cmp:Xb[b.cmp]}),opFront:{fail:Mp[I.fail],zfail:Mp[I.zfail],zpass:Mp[I.zpass]},opBack:{fail:Mp[pe.fail],zfail:Mp[pe.zfail],zpass:Mp[pe.zpass]}}}},{key:"getColorMaskDrawParams",value:function(n,i){var a=n.stencil,s=a!=null&&a.enable&&a.opFront&&!i?[!1,!1,!1,!1]:[!0,!0,!0,!0];return s}},{key:"initCullDrawParams",value:function(n,i){var a=n.cull;if(a){var s=a.enable,c=a.face,p=c===void 0?$.gl.BACK:c;i.cull={enable:!!s,face:Yb[p]}}}},{key:"extractUniforms",value:function(n){var i=this,a={};return Object.keys(n).forEach(function(s){i.extractUniformsRecursively(s,n[s],a,"")}),a}},{key:"extractUniformsRecursively",value:function(n,i,a,s){var c=this;if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||eS(i)||i===""||"resize"in i){a["".concat(s&&s+".").concat(n)]=i;return}JE(i)&&Object.keys(i).forEach(function(p){c.extractUniformsRecursively(p,i[p],a,"".concat(s&&s+".").concat(n))}),Array.isArray(i)&&i.forEach(function(p,g){Object.keys(p).forEach(function(b){c.extractUniformsRecursively(b,p[b],a,"".concat(s&&s+".").concat(n,"[").concat(g,"]"))})})}}]),e}(),rS=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"isDestroy",!1);var i=n.data,a=n.type,s=a===void 0?$.gl.UNSIGNED_BYTE:a,c=n.width,p=n.height,g=n.flipY,b=g===void 0?!1:g,w=n.format,I=w===void 0?$.gl.RGBA:w,W=n.mipmap,pe=W===void 0?!1:W,Me=n.wrapS,Fe=Me===void 0?$.gl.CLAMP_TO_EDGE:Me,ut=n.wrapT,Ot=ut===void 0?$.gl.CLAMP_TO_EDGE:ut,Bt=n.aniso,ir=Bt===void 0?0:Bt,xr=n.alignment,qr=xr===void 0?1:xr,Ir=n.premultiplyAlpha,mr=Ir===void 0?!1:Ir,sn=n.mag,ti=sn===void 0?$.gl.NEAREST:sn,Bi=n.min,ai=Bi===void 0?$.gl.NEAREST:Bi,ra=n.colorSpace,fa=ra===void 0?$.gl.BROWSER_DEFAULT_WEBGL:ra,nu=n.x,yl=nu===void 0?0:nu,_l=n.y,Mf=_l===void 0?0:_l,uf=n.copy,pc=uf===void 0?!1:uf;this.width=c,this.height=p;var Jf={width:c,height:p,type:zm[s],format:Hb[I],wrapS:l0[Fe],wrapT:l0[Ot],mag:u0[ti],min:u0[ai],alignment:qr,flipY:b,colorSpace:Wb[fa],premultiplyAlpha:mr,aniso:ir,x:yl,y:Mf,copy:pc};i&&(Jf.data=i),typeof pe=="number"?Jf.mipmap=$b[pe]:typeof pe=="boolean"&&(Jf.mipmap=pe),this.texture=r.texture(Jf)}return(0,We.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(n)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var i=n.width,a=n.height;this.texture.resize(i,a),this.width=i,this.height=a}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var n;(n=this.texture)===null||n===void 0||n.destroy()}this.isDestroy=!0}}]),e}(),W0,G0,nS=(W0=(0,ta.b2)(),W0(G0=function(){function e(){var r=this;(0,Ge.Z)(this,e),(0,G.Z)(this,"uniformBuffers",[]),(0,G.Z)(this,"queryVerdorInfo",function(){return"WebGL1"}),(0,G.Z)(this,"createModel",function(n){return new tS(r.gl,n)}),(0,G.Z)(this,"createAttribute",function(n){return new jb(r.gl,n)}),(0,G.Z)(this,"createBuffer",function(n){return new Kb(r.gl,n)}),(0,G.Z)(this,"createElements",function(n){return new qb(r.gl,n)}),(0,G.Z)(this,"createTexture2D",function(n){return new rS(r.gl,n)}),(0,G.Z)(this,"createFramebuffer",function(n){return new Qb(r.gl,n)}),(0,G.Z)(this,"useFramebuffer",function(n,i){r.gl({framebuffer:n?n.get():null})(i)}),(0,G.Z)(this,"useFramebufferAsync",function(){var n=(0,He.Z)(Ne().mark(function i(a,s){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:r.gl({framebuffer:a?a.get():null})(s);case 1:case"end":return p.stop()}},i)}));return function(i,a){return n.apply(this,arguments)}}()),(0,G.Z)(this,"clear",function(n){var i,a=n.color,s=n.depth,c=n.stencil,p=n.framebuffer,g=p===void 0?null:p,b={color:a,depth:s,stencil:c};b.framebuffer=g===null?g:g.get(),(i=r.gl)===null||i===void 0||i.clear(b)}),(0,G.Z)(this,"viewport",function(n){var i=n.x,a=n.y,s=n.width,c=n.height;r.gl._gl.viewport(i,a,s,c),r.width=s,r.height=c,r.gl._refresh()}),(0,G.Z)(this,"readPixels",function(n){var i=n.framebuffer,a=n.x,s=n.y,c=n.width,p=n.height,g={x:a,y:s,width:c,height:p};return i&&(g.framebuffer=i.get()),r.gl.read(g)}),(0,G.Z)(this,"readPixelsAsync",function(){var n=(0,He.Z)(Ne().mark(function i(a){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",r.readPixels(a));case 1:case"end":return c.stop()}},i)}));return function(i){return n.apply(this,arguments)}}()),(0,G.Z)(this,"getViewportSize",function(){return{width:r.gl._gl.drawingBufferWidth,height:r.gl._gl.drawingBufferHeight}}),(0,G.Z)(this,"getContainer",function(){var n;return(n=r.canvas)===null||n===void 0?void 0:n.parentElement}),(0,G.Z)(this,"getCanvas",function(){return r.canvas}),(0,G.Z)(this,"getGLContext",function(){return r.gl._gl}),(0,G.Z)(this,"destroy",function(){var n;r.canvas=null,(n=r.gl)===null||n===void 0||(n=n._gl)===null||n===void 0||(n=n.getExtension("WEBGL_lose_context"))===null||n===void 0||n.loseContext(),r.gl.destroy(),r.gl=null})}return(0,We.Z)(e,[{key:"init",value:function(){var r=(0,He.Z)(Ne().mark(function i(a,s,c){var p=this;return Ne().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.canvas=a,!c){b.next=5;break}this.gl=c,b.next=8;break;case 5:return b.next=7,new Promise(function(w,I){Zb()({canvas:p.canvas,attributes:{alpha:!0,antialias:s.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:s.preserveDrawingBuffer,stencil:s.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(pe,Me){(pe||!Me)&&I(pe),w(Me)}})});case 7:this.gl=b.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return b.stop()}},i,this)}));function n(i,a,s){return r.apply(this,arguments)}return n}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(n){return!!this.getGLContext().getExtension(n)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var n=this.getGLContext();n.disable(n.CULL_FACE)}},{key:"setDirty",value:function(n){this.isDirty=n}},{key:"getDirty",value:function(){return this.isDirty}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}())||G0),iS=function(){function e(r,n){(0,Ge.Z)(this,e);var i=n.buffer,a=n.offset,s=n.stride,c=n.normalized,p=n.size,g=n.divisor,b=n.shaderLocation;this.buffer=i,this.attribute={shaderLocation:b,buffer:i.get(),offset:a||0,stride:s||0,normalized:c||!1,divisor:g||0},p&&(this.attribute.size=p)}return(0,We.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),xd,Kh,Zp,Dv,kv,Oh,vm,tp,dc,Ph,Dh,mm=(xd={},(0,G.Z)(xd,$.gl.FLOAT,Float32Array),(0,G.Z)(xd,$.gl.UNSIGNED_BYTE,Uint8Array),(0,G.Z)(xd,$.gl.SHORT,Int16Array),(0,G.Z)(xd,$.gl.UNSIGNED_SHORT,Uint16Array),(0,G.Z)(xd,$.gl.INT,Int32Array),(0,G.Z)(xd,$.gl.UNSIGNED_INT,Uint32Array),xd),aS=(Kh={},(0,G.Z)(Kh,$.gl.POINTS,Uu.POINTS),(0,G.Z)(Kh,$.gl.LINES,Uu.LINES),(0,G.Z)(Kh,$.gl.LINE_LOOP,Uu.LINES),(0,G.Z)(Kh,$.gl.LINE_STRIP,Uu.LINE_STRIP),(0,G.Z)(Kh,$.gl.TRIANGLES,Uu.TRIANGLES),(0,G.Z)(Kh,$.gl.TRIANGLE_FAN,Uu.TRIANGLES),(0,G.Z)(Kh,$.gl.TRIANGLE_STRIP,Uu.TRIANGLE_STRIP),Kh),oS=(Zp={},(0,G.Z)(Zp,1,fr.F32_R),(0,G.Z)(Zp,2,fr.F32_RG),(0,G.Z)(Zp,3,fr.F32_RGB),(0,G.Z)(Zp,4,fr.F32_RGBA),Zp),sS=(Dv={},(0,G.Z)(Dv,$.gl.STATIC_DRAW,mh.STATIC),(0,G.Z)(Dv,$.gl.DYNAMIC_DRAW,mh.DYNAMIC),(0,G.Z)(Dv,$.gl.STREAM_DRAW,mh.DYNAMIC),Dv),X0=(kv={},(0,G.Z)(kv,$.gl.REPEAT,Zc.REPEAT),(0,G.Z)(kv,$.gl.CLAMP_TO_EDGE,Zc.CLAMP_TO_EDGE),(0,G.Z)(kv,$.gl.MIRRORED_REPEAT,Zc.MIRRORED_REPEAT),kv),uS=(Oh={},(0,G.Z)(Oh,$.gl.NEVER,Fa.NEVER),(0,G.Z)(Oh,$.gl.ALWAYS,Fa.ALWAYS),(0,G.Z)(Oh,$.gl.LESS,Fa.LESS),(0,G.Z)(Oh,$.gl.LEQUAL,Fa.LEQUAL),(0,G.Z)(Oh,$.gl.GREATER,Fa.GREATER),(0,G.Z)(Oh,$.gl.GEQUAL,Fa.GEQUAL),(0,G.Z)(Oh,$.gl.EQUAL,Fa.EQUAL),(0,G.Z)(Oh,$.gl.NOTEQUAL,Fa.NOTEQUAL),Oh),lS=(vm={},(0,G.Z)(vm,$.gl.FRONT,of.FRONT),(0,G.Z)(vm,$.gl.BACK,of.BACK),vm),Y0=(tp={},(0,G.Z)(tp,$.gl.FUNC_ADD,Ll.ADD),(0,G.Z)(tp,$.gl.MIN_EXT,Ll.MIN),(0,G.Z)(tp,$.gl.MAX_EXT,Ll.MAX),(0,G.Z)(tp,$.gl.FUNC_SUBTRACT,Ll.SUBSTRACT),(0,G.Z)(tp,$.gl.FUNC_REVERSE_SUBTRACT,Ll.REVERSE_SUBSTRACT),tp),gm=(dc={},(0,G.Z)(dc,$.gl.ZERO,Ka.ZERO),(0,G.Z)(dc,$.gl.ONE,Ka.ONE),(0,G.Z)(dc,$.gl.SRC_COLOR,Ka.SRC),(0,G.Z)(dc,$.gl.ONE_MINUS_SRC_COLOR,Ka.ONE_MINUS_SRC),(0,G.Z)(dc,$.gl.SRC_ALPHA,Ka.SRC_ALPHA),(0,G.Z)(dc,$.gl.ONE_MINUS_SRC_ALPHA,Ka.ONE_MINUS_SRC_ALPHA),(0,G.Z)(dc,$.gl.DST_COLOR,Ka.DST),(0,G.Z)(dc,$.gl.ONE_MINUS_DST_COLOR,Ka.ONE_MINUS_DST),(0,G.Z)(dc,$.gl.DST_ALPHA,Ka.DST_ALPHA),(0,G.Z)(dc,$.gl.ONE_MINUS_DST_ALPHA,Ka.ONE_MINUS_DST_ALPHA),(0,G.Z)(dc,$.gl.CONSTANT_COLOR,Ka.CONST),(0,G.Z)(dc,$.gl.ONE_MINUS_CONSTANT_COLOR,Ka.ONE_MINUS_CONSTANT),(0,G.Z)(dc,$.gl.CONSTANT_ALPHA,Ka.CONST),(0,G.Z)(dc,$.gl.ONE_MINUS_CONSTANT_ALPHA,Ka.ONE_MINUS_CONSTANT),(0,G.Z)(dc,$.gl.SRC_ALPHA_SATURATE,Ka.SRC_ALPHA_SATURATE),dc),jp=(Ph={},(0,G.Z)(Ph,$.gl.REPLACE,eu.REPLACE),(0,G.Z)(Ph,$.gl.KEEP,eu.KEEP),(0,G.Z)(Ph,$.gl.ZERO,eu.ZERO),(0,G.Z)(Ph,$.gl.INVERT,eu.INVERT),(0,G.Z)(Ph,$.gl.INCR,eu.INCREMENT_CLAMP),(0,G.Z)(Ph,$.gl.DECR,eu.DECREMENT_CLAMP),(0,G.Z)(Ph,$.gl.INCR_WRAP,eu.INCREMENT_WRAP),(0,G.Z)(Ph,$.gl.DECR_WRAP,eu.DECREMENT_WRAP),Ph),cS=(Dh={},(0,G.Z)(Dh,$.gl.ALWAYS,Fa.ALWAYS),(0,G.Z)(Dh,$.gl.EQUAL,Fa.EQUAL),(0,G.Z)(Dh,$.gl.GEQUAL,Fa.GEQUAL),(0,G.Z)(Dh,$.gl.GREATER,Fa.GREATER),(0,G.Z)(Dh,$.gl.LEQUAL,Fa.LEQUAL),(0,G.Z)(Dh,$.gl.LESS,Fa.LESS),(0,G.Z)(Dh,$.gl.NEVER,Fa.NEVER),(0,G.Z)(Dh,$.gl.NOTEQUAL,Fa.NOTEQUAL),Dh),fS={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function ym(e){return Object.prototype.toString.call(e)in fS}function hS(e,r){for(var n=e.length,i=Math.ceil(n/3),a=n+i,s=new Float32Array(a),c=0;c<a;c+=4)s[c]=e[c/4*3],s[c+1]=e[c/4*3+1],s[c+2]=e[c/4*3+2],s[c+3]=r;return s}var dS=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"isDestroyed",!1);var i=n.data,a=n.usage,s=n.type,c=n.isUBO,p=n.label,g;ym(i)?g=i:g=new mm[this.type||$.gl.FLOAT](i),this.type=s,this.size=g.byteLength,this.buffer=r.createBuffer({viewOrSize:g,usage:c?as.UNIFORM:as.VERTEX,hint:sS[a||$.gl.STATIC_DRAW]}),p&&r.setResourceName(this.buffer,p)}return(0,We.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}},{key:"subData",value:function(n){var i=n.data,a=n.offset,s;ym(i)?s=i:s=new mm[this.type||$.gl.FLOAT](i),this.buffer.setSubData(a,new Uint8Array(s.buffer))}}]),e}();function K0(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=pS(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function pS(e,r){if(e){if(typeof e=="string")return q0(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q0(e,r)}}function q0(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function Fo(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e+=r,e+=e<<10,e+=e>>>6,e>>>0}function Q0(e){return e+=e<<3,e^=e>>>11,e+=e<<15,e>>>0}function J0(e){return 0}var vS=(0,We.Z)(function e(){(0,Ge.Z)(this,e),(0,G.Z)(this,"keys",[]),(0,G.Z)(this,"values",[])}),_m=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"buckets",new Map),this.keyEqualFunc=r,this.keyHashFunc=n}return(0,We.Z)(e,[{key:"findBucketIndex",value:function(n,i){for(var a=0;a<n.keys.length;a++)if(this.keyEqualFunc(i,n.keys[a]))return a;return-1}},{key:"findBucket",value:function(n){var i=this.keyHashFunc(n);return this.buckets.get(i)}},{key:"get",value:function(n){var i=this.findBucket(n);if(i===void 0)return null;var a=this.findBucketIndex(i,n);return a<0?null:i.values[a]}},{key:"add",value:function(n,i){var a=this.keyHashFunc(n);this.buckets.get(a)===void 0&&this.buckets.set(a,new vS);var s=this.buckets.get(a);s.keys.push(n),s.values.push(i)}},{key:"delete",value:function(n){var i=this.findBucket(n);if(i!==void 0){var a=this.findBucketIndex(i,n);a!==-1&&(i.keys.splice(a,1),i.values.splice(a,1))}}},{key:"clear",value:function(){this.buckets.clear()}},{key:"size",value:function(){var n=0,i=K0(this.buckets.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;n+=s.values.length}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"values",value:Ne().mark(function r(){var n,i,a,s;return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:n=K0(this.buckets.values()),p.prev=1,n.s();case 3:if((i=n.n()).done){p.next=14;break}a=i.value,s=a.values.length-1;case 6:if(!(s>=0)){p.next=12;break}return p.next=9,a.values[s];case 9:s--,p.next=6;break;case 12:p.next=3;break;case 14:p.next=19;break;case 16:p.prev=16,p.t0=p.catch(1),n.e(p.t0);case 19:return p.prev=19,n.f(),p.finish(19);case 22:case"end":return p.stop()}},r,this,[[1,16,19,22]])})}]),e}();function bm(e,r){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=mS(e))||r&&e&&typeof e.length=="number"){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,c=!1,p;return{s:function(){n=n.call(e)},n:function(){var b=n.next();return s=b.done,b},e:function(b){c=!0,p=b},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(c)throw p}}}}function mS(e,r){if(e){if(typeof e=="string")return ey(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ey(e,r)}}function ey(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,i=new Array(r);n<r;n++)i[n]=e[n];return i}function ty(e,r){return e=Fo(e,r.blendMode),e=Fo(e,r.blendSrcFactor),e=Fo(e,r.blendDstFactor),e}function gS(e,r){return e=ty(e,r.rgbBlendState),e=ty(e,r.alphaBlendState),e=Fo(e,r.channelWriteMask),e}function yS(e,r){return e=Fo(e,r.r<<24|r.g<<16|r.b<<8|r.a),e}function _S(e,r){for(var n,i,a,s,c,p,g,b,w=0;w<r.attachmentsState.length;w++)e=gS(e,r.attachmentsState[w]);return e=yS(e,r.blendConstant||tm),e=Fo(e,r.depthCompare),e=Fo(e,r.depthWrite?1:0),e=Fo(e,(n=r.stencilFront)===null||n===void 0?void 0:n.compare),e=Fo(e,(i=r.stencilFront)===null||i===void 0?void 0:i.passOp),e=Fo(e,(a=r.stencilFront)===null||a===void 0?void 0:a.failOp),e=Fo(e,(s=r.stencilFront)===null||s===void 0?void 0:s.depthFailOp),e=Fo(e,(c=r.stencilBack)===null||c===void 0?void 0:c.compare),e=Fo(e,(p=r.stencilBack)===null||p===void 0?void 0:p.passOp),e=Fo(e,(g=r.stencilBack)===null||g===void 0?void 0:g.failOp),e=Fo(e,(b=r.stencilBack)===null||b===void 0?void 0:b.depthFailOp),e=Fo(e,r.stencilWrite?1:0),e=Fo(e,r.cullMode),e=Fo(e,r.frontFace?1:0),e=Fo(e,r.polygonOffset?1:0),e}function bS(e){var r=0;r=Fo(r,e.program.id),e.inputLayout!==null&&(r=Fo(r,e.inputLayout.id)),r=_S(r,e.megaStateDescriptor);for(var n=0;n<e.colorAttachmentFormats.length;n++)r=Fo(r,e.colorAttachmentFormats[n]||0);return r=Fo(r,e.depthStencilAttachmentFormat||0),Q0(r)}function xS(e){var r=0;if(e.samplerBindings)for(var n=0;n<e.samplerBindings.length;n++){var i=e.samplerBindings[n];i!==null&&i.texture!==null&&(r=Fo(r,i.texture.id))}if(e.uniformBufferBindings)for(var a=0;a<e.uniformBufferBindings.length;a++){var s=e.uniformBufferBindings[a];s!==null&&s.buffer!==null&&(r=Fo(r,s.buffer.id),r=Fo(r,s.binding),r=Fo(r,s.offset),r=Fo(r,s.size))}if(e.storageBufferBindings)for(var c=0;c<e.storageBufferBindings.length;c++){var p=e.storageBufferBindings[c];p!==null&&p.buffer!==null&&(r=Fo(r,p.buffer.id),r=Fo(r,p.binding),r=Fo(r,p.offset),r=Fo(r,p.size))}if(e.storageTextureBindings)for(var g=0;g<e.storageTextureBindings.length;g++){var b=e.storageTextureBindings[g];b!==null&&b.texture!==null&&(r=Fo(r,b.texture.id),r=Fo(r,b.binding))}return Q0(r)}function ES(e,r){var n,i,a,s;return((n=e.vertex)===null||n===void 0?void 0:n.glsl)===((i=r.vertex)===null||i===void 0?void 0:i.glsl)&&((a=e.fragment)===null||a===void 0?void 0:a.glsl)===((s=r.fragment)===null||s===void 0?void 0:s.glsl)}function SS(e){var r,n;return{vertex:{glsl:(r=e.vertex)===null||r===void 0?void 0:r.glsl},fragment:{glsl:(n=e.fragment)===null||n===void 0?void 0:n.glsl}}}var TS=function(){function e(r){(0,Ge.Z)(this,e),(0,G.Z)(this,"bindingsCache",new _m(px,xS)),(0,G.Z)(this,"renderPipelinesCache",new _m(yx,bS)),(0,G.Z)(this,"inputLayoutsCache",new _m(xx,J0)),(0,G.Z)(this,"programCache",new _m(ES,J0)),this.device=r}return(0,We.Z)(e,[{key:"createBindings",value:function(n){var i=this.bindingsCache.get(n);if(i===null){var a,s=Tx(n);s.uniformBufferBindings=(a=s.uniformBufferBindings)===null||a===void 0?void 0:a.filter(function(c){var p=c.size;return p&&p>0}),i=this.device.createBindings(s),this.bindingsCache.add(s,i)}return i}},{key:"createRenderPipeline",value:function(n){var i=this.renderPipelinesCache.get(n);if(i===null){var a=Ax(n);a.colorAttachmentFormats=a.colorAttachmentFormats.filter(function(s){return s}),i=this.device.createRenderPipeline(a),this.renderPipelinesCache.add(a,i)}return i}},{key:"createInputLayout",value:function(n){n.vertexBufferDescriptors=n.vertexBufferDescriptors.filter(function(s){return!!s});var i=this.inputLayoutsCache.get(n);if(i===null){var a=Mx(n);i=this.device.createInputLayout(a),this.inputLayoutsCache.add(a,i)}return i}},{key:"createProgram",value:function(n){var i=this.programCache.get(n);if(i===null){var a=SS(n);i=this.device.createProgram(n),this.programCache.add(a,i)}return i}},{key:"destroy",value:function(){var n=bm(this.bindingsCache.values()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a.destroy()}}catch(Me){n.e(Me)}finally{n.f()}var s=bm(this.renderPipelinesCache.values()),c;try{for(s.s();!(c=s.n()).done;){var p=c.value;p.destroy()}}catch(Me){s.e(Me)}finally{s.f()}var g=bm(this.inputLayoutsCache.values()),b;try{for(g.s();!(b=g.n()).done;){var w=b.value;w.destroy()}}catch(Me){g.e(Me)}finally{g.f()}var I=bm(this.programCache.values()),W;try{for(I.s();!(W=I.n()).done;){var pe=W.value;pe.destroy()}}catch(Me){I.e(Me)}finally{I.f()}this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}}]),e}(),AS=function(){function e(r,n){(0,Ge.Z)(this,e);var i=n.data,a=n.type,s=n.count,c=s===void 0?0:s,p;ym(i)?p=i:p=new mm[this.type||$.gl.UNSIGNED_INT](i),this.type=a,this.count=c,this.indexBuffer=r.createBuffer({viewOrSize:p,usage:as.INDEX})}return(0,We.Z)(e,[{key:"get",value:function(){return this.indexBuffer}},{key:"subData",value:function(n){var i=n.data,a;ym(i)?a=i:a=new mm[this.type||$.gl.UNSIGNED_INT](i),this.indexBuffer.setSubData(0,new Uint8Array(a.buffer))}},{key:"destroy",value:function(){this.indexBuffer.destroy()}}]),e}();function ry(e){return!!(e&&e.texture)}var ny=function(){function e(r,n){(0,Ge.Z)(this,e),(0,G.Z)(this,"isDestroy",!1),this.device=r,this.options=n;var i=n.wrapS,a=i===void 0?$.gl.CLAMP_TO_EDGE:i,s=n.wrapT,c=s===void 0?$.gl.CLAMP_TO_EDGE:s,p=n.aniso,g=n.mipmap,b=g===void 0?!1:g,w=n.mag,I=w===void 0?$.gl.NEAREST:w,W=n.min,pe=W===void 0?$.gl.NEAREST:W;this.createTexture(n),this.sampler=r.createSampler({addressModeU:X0[a],addressModeV:X0[c],minFilter:pe===$.gl.NEAREST?mu.POINT:mu.BILINEAR,magFilter:I===$.gl.NEAREST?mu.POINT:mu.BILINEAR,mipmapFilter:ml.NO_MIP,maxAnisotropy:p})}return(0,We.Z)(e,[{key:"createTexture",value:function(n){var i=n.type,a=i===void 0?$.gl.UNSIGNED_BYTE:i,s=n.width,c=n.height,p=n.flipY,g=p===void 0?!1:p,b=n.format,w=b===void 0?$.gl.RGBA:b,I=n.aniso,W=n.alignment,pe=W===void 0?1:W,Me=n.usage,Fe=Me===void 0?$.v2.SAMPLED:Me,ut=n.unorm,Ot=ut===void 0?!1:ut,Bt=n.label,ir=n.data;this.width=s,this.height=c;var xr=fr.U8_RGBA_RT;if(a===$.gl.UNSIGNED_BYTE&&w===$.gl.RGBA)xr=Ot?fr.U8_RGBA_NORM:fr.U8_RGBA_RT;else if(a===$.gl.UNSIGNED_BYTE&&w===$.gl.LUMINANCE)xr=fr.U8_LUMINANCE;else if(a===$.gl.FLOAT&&w===$.gl.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(ir&&(ir=hS(ir,0)),xr=fr.F32_RGBA):xr=fr.F32_RGB;else if(a===$.gl.FLOAT&&w===$.gl.RGBA)xr=fr.F32_RGBA;else if(a===$.gl.FLOAT&&w===$.gl.RED)xr=fr.F32_R;else throw new Error("create texture error, type: ".concat(a,", format: ").concat(w));this.texture=this.device.createTexture({format:xr,width:s,height:c,usage:Fe===$.v2.SAMPLED?hc.SAMPLED:hc.RENDER_TARGET,pixelStore:{unpackFlipY:g,packAlignment:pe},mipLevelCount:1}),Bt&&this.device.setResourceName(this.texture,Bt),ir&&this.texture.setImageData([ir])}},{key:"get",value:function(){return this.texture}},{key:"update",value:function(n){var i=n.data;this.texture.setImageData([i])}},{key:"bind",value:function(){}},{key:"resize",value:function(n){var i=n.width,a=n.height;(this.width!==i||this.height!==a)&&this.destroy(),this.options.width=i,this.options.height=a,this.createTexture(this.options),this.isDestroy=!1}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy&&!this.texture.destroyed){var n;(n=this.texture)===null||n===void 0||n.destroy()}this.isDestroy=!0}}]),e}(),iy=function(){function e(r,n){(0,Ge.Z)(this,e),this.device=r,this.options=n,this.createColorRenderTarget(),this.createDepthRenderTarget()}return(0,We.Z)(e,[{key:"createColorRenderTarget",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.options,a=i.width,s=i.height,c=i.color;c&&(ry(c)?(n&&c.resize({width:a,height:s}),this.colorTexture=c.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=c.width,this.height=c.height):a&&s&&(this.colorTexture=this.device.createTexture({format:fr.U8_RGBA_RT,usage:hc.RENDER_TARGET,width:a,height:s}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=a,this.height=s))}},{key:"createDepthRenderTarget",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.options,a=i.width,s=i.height,c=i.depth;c&&(ry(c)?(n&&c.resize({width:a,height:s}),this.depthTexture=c.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=c.width,this.height=c.height):a&&s&&(this.depthTexture=this.device.createTexture({format:fr.D24_S8,usage:hc.RENDER_TARGET,width:a,height:s}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=a,this.height=s))}},{key:"get",value:function(){return this.colorRenderTarget}},{key:"destroy",value:function(){var n,i;(n=this.colorRenderTarget)===null||n===void 0||n.destroy(),(i=this.depthRenderTarget)===null||i===void 0||i.destroy()}},{key:"resize",value:function(n){var i=n.width,a=n.height;(this.width!==i||this.height!==a)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=i,this.options.height=a,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}}]),e}(),CS=ze.rU.isPlainObject,wS=ze.rU.isTypedArray,RS=function(){function e(r,n,i){var a=this;(0,Ge.Z)(this,e),(0,G.Z)(this,"destroyed",!1),(0,G.Z)(this,"uniforms",{}),(0,G.Z)(this,"vertexBuffers",[]),this.device=r,this.options=n,this.service=i;var s=n.vs,c=n.fs,p=n.attributes,g=n.uniforms,b=n.count,w=n.elements,I=n.diagnosticDerivativeUniformityEnabled;this.options=n;var W=I?"":this.service.viewportOrigin===Mh.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=i.renderCache.createProgram({vertex:{glsl:s},fragment:{glsl:c,postprocess:function(Ot){return W+Ot}}}),g&&(this.uniforms=this.extractUniforms(g));var pe=[],Me=0;Object.keys(p).forEach(function(ut){var Ot=p[ut],Bt=Ot.get();a.vertexBuffers.push(Bt.get());var ir=Ot.attribute,xr=ir.offset,qr=xr===void 0?0:xr,Ir=ir.stride,mr=Ir===void 0?0:Ir,sn=ir.size,ti=sn===void 0?1:sn,Bi=ir.divisor,ai=Bi===void 0?0:Bi,ra=ir.shaderLocation,fa=ra===void 0?0:ra;pe.push({arrayStride:mr||ti*4,stepMode:Qd.VERTEX,attributes:[{format:oS[ti],shaderLocation:fa,offset:qr,divisor:ai}]}),Me=Bt.size/ti}),b||(this.options.count=Me),w&&(this.indexBuffer=w.get());var Fe=i.renderCache.createInputLayout({vertexBufferDescriptors:pe,indexBufferFormat:w?fr.U32_R:null,program:this.program});this.inputLayout=Fe,this.pipeline=this.createPipeline(n)}return(0,We.Z)(e,[{key:"createPipeline",value:function(n,i){var a=n.primitive,s=a===void 0?$.gl.TRIANGLES:a,c=n.depth,p=n.cull,g=n.blend,b=n.stencil,w=this.initDepthDrawParams({depth:c}),I=!!(w&&w.enable),W=this.initCullDrawParams({cull:p}),pe=!!(W&&W.enable),Me=this.getBlendDrawParams({blend:g}),Fe=!!(Me&&Me.enable),ut=this.getStencilDrawParams({stencil:b}),Ot=!!(ut&&ut.enable);return this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:aS[s],colorAttachmentFormats:[fr.U8_RGBA_RT],depthStencilAttachmentFormat:fr.D24_S8,megaStateDescriptor:{attachmentsState:[i?{channelWriteMask:Bl.ALL,rgbBlendState:{blendMode:Ll.ADD,blendSrcFactor:Ka.ONE,blendDstFactor:Ka.ZERO},alphaBlendState:{blendMode:Ll.ADD,blendSrcFactor:Ka.ONE,blendDstFactor:Ka.ZERO}}:{channelWriteMask:Ot&&ut.opFront.zpass===eu.REPLACE?Bl.NONE:Bl.ALL,rgbBlendState:{blendMode:Fe&&Me.equation.rgb||Ll.ADD,blendSrcFactor:Fe&&Me.func.srcRGB||Ka.SRC_ALPHA,blendDstFactor:Fe&&Me.func.dstRGB||Ka.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:Fe&&Me.equation.alpha||Ll.ADD,blendSrcFactor:Fe&&Me.func.srcAlpha||Ka.ONE,blendDstFactor:Fe&&Me.func.dstAlpha||Ka.ONE}}],blendConstant:Fe?tm:void 0,depthWrite:I,depthCompare:I&&w.func||Fa.LESS,cullMode:pe&&W.face||of.NONE,stencilWrite:Ot,stencilFront:{compare:Ot?ut.func.cmp:Fa.ALWAYS,passOp:ut.opFront.zpass,failOp:ut.opFront.fail,depthFailOp:ut.opFront.zfail,mask:ut.opFront.mask},stencilBack:{compare:Ot?ut.func.cmp:Fa.ALWAYS,passOp:ut.opBack.zpass,failOp:ut.opBack.fail,depthFailOp:ut.opBack.zfail,mask:ut.opBack.mask}}})}},{key:"updateAttributesAndElements",value:function(){}},{key:"updateAttributes",value:function(){}},{key:"addUniforms",value:function(n){this.uniforms=(0,fe.Z)((0,fe.Z)({},this.uniforms),this.extractUniforms(n))}},{key:"draw",value:function(n,i){var a=this,s=(0,fe.Z)((0,fe.Z)({},this.options),n),c=s.count,p=c===void 0?0:c,g=s.instances,b=s.elements,w=s.uniforms,I=w===void 0?{}:w,W=s.uniformBuffers,pe=s.textures;this.uniforms=(0,fe.Z)((0,fe.Z)({},this.uniforms),this.extractUniforms(I));var Me=this.service,Fe=Me.renderPass,ut=Me.currentFramebuffer,Ot=Me.width,Bt=Me.height,ir=Me.renderCache;this.pipeline=this.createPipeline(s,i);var xr=this.service.device,qr=xr.swapChainHeight;if(xr.swapChainHeight=(ut==null?void 0:ut.height)||Bt,Fe.setViewport(0,0,(ut==null?void 0:ut.width)||Ot,(ut==null?void 0:ut.height)||Bt),xr.swapChainHeight=qr,Fe.setPipeline(this.pipeline),Fe.setStencilReference(1),Fe.setVertexInput(this.inputLayout,this.vertexBuffers.map(function(mr){return{buffer:mr}}),b?{buffer:this.indexBuffer,offset:0}:null),W&&(this.bindings=ir.createBindings({pipeline:this.pipeline,uniformBufferBindings:W.map(function(mr,sn){var ti=mr;return{binding:sn,buffer:ti.get(),size:ti.size}}),samplerBindings:pe==null?void 0:pe.map(function(mr){return{texture:mr.texture,sampler:mr.sampler}})})),this.bindings&&(Fe.setBindings(this.bindings),Object.keys(this.uniforms).forEach(function(mr){var sn=a.uniforms[mr];sn instanceof ny?a.uniforms[mr]=sn.get():sn instanceof iy&&(a.uniforms[mr]=sn.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),b){var Ir=b.count;Ir===0?Fe.draw(p,g):Fe.drawIndexed(Ir,g)}else Fe.draw(p,g)}},{key:"destroy",value:function(){var n,i,a;this.program.destroy(),(n=this.vertexBuffers)===null||n===void 0||n.forEach(function(s){return s.destroy()}),(i=this.indexBuffer)===null||i===void 0||i.destroy(),(a=this.bindings)===null||a===void 0||a.destroy(),this.inputLayout.destroy(),this.pipeline.destroy(),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(n){var i=n.depth;if(i)return{enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:uS[i.func||$.gl.LESS],range:i.range||[0,1]}}},{key:"getBlendDrawParams",value:function(n){var i=n.blend,a=i||{},s=a.enable,c=a.func,p=a.equation,g=a.color,b=g===void 0?[0,0,0,0]:g;return{enable:!!s,func:{srcRGB:gm[c&&c.srcRGB||$.gl.SRC_ALPHA],srcAlpha:gm[c&&c.srcAlpha||$.gl.SRC_ALPHA],dstRGB:gm[c&&c.dstRGB||$.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:gm[c&&c.dstAlpha||$.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Y0[p&&p.rgb||$.gl.FUNC_ADD],alpha:Y0[p&&p.alpha||$.gl.FUNC_ADD]},color:b}}},{key:"getStencilDrawParams",value:function(n){var i=n.stencil,a=i||{},s=a.enable,c=a.mask,p=c===void 0?4294967295:c,g=a.func,b=g===void 0?{cmp:$.gl.ALWAYS,ref:0,mask:4294967295}:g,w=a.opFront,I=w===void 0?{fail:$.gl.KEEP,zfail:$.gl.KEEP,zpass:$.gl.KEEP}:w,W=a.opBack,pe=W===void 0?{fail:$.gl.KEEP,zfail:$.gl.KEEP,zpass:$.gl.KEEP}:W;return{enable:!!s,mask:p,func:(0,fe.Z)((0,fe.Z)({},b),{},{cmp:cS[b.cmp]}),opFront:{fail:jp[I.fail],zfail:jp[I.zfail],zpass:jp[I.zpass],mask:b.mask},opBack:{fail:jp[pe.fail],zfail:jp[pe.zfail],zpass:jp[pe.zpass],mask:b.mask}}}},{key:"initCullDrawParams",value:function(n){var i=n.cull;if(i){var a=i.enable,s=i.face,c=s===void 0?$.gl.BACK:s;return{enable:!!a,face:lS[c]}}}},{key:"extractUniforms",value:function(n){var i=this,a={};return Object.keys(n).forEach(function(s){i.extractUniformsRecursively(s,n[s],a,"")}),a}},{key:"extractUniformsRecursively",value:function(n,i,a,s){var c=this;if(i===null||typeof i=="number"||typeof i=="boolean"||Array.isArray(i)&&typeof i[0]=="number"||wS(i)||i===""||"resize"in i){a["".concat(s&&s+".").concat(n)]=i;return}CS(i)&&Object.keys(i).forEach(function(p){c.extractUniformsRecursively(p,i[p],a,"".concat(s&&s+".").concat(n))}),Array.isArray(i)&&i.forEach(function(p,g){Object.keys(p).forEach(function(b){c.extractUniformsRecursively(b,p[b],a,"".concat(s&&s+".").concat(n,"[").concat(g,"]"))})})}}]),e}();function MS(e){return typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}var ay,oy,xm=ze.rU.isUndefined,IS=(ay=(0,ta.b2)(),ay(oy=function(){function e(){var r=this;(0,Ge.Z)(this,e),(0,G.Z)(this,"uniformBuffers",[]),(0,G.Z)(this,"queryVerdorInfo",function(){return r.device.queryVendorInfo().platformString}),(0,G.Z)(this,"createModel",function(n){return new RS(r.device,n,r)}),(0,G.Z)(this,"createAttribute",function(n){return new iS(r.device,n)}),(0,G.Z)(this,"createBuffer",function(n){return new dS(r.device,n)}),(0,G.Z)(this,"createElements",function(n){return new AS(r.device,n)}),(0,G.Z)(this,"createTexture2D",function(n){return new ny(r.device,n)}),(0,G.Z)(this,"createFramebuffer",function(n){return new iy(r.device,n)}),(0,G.Z)(this,"useFramebuffer",function(n,i){r.currentFramebuffer=n,r.beginFrame(),i(),r.endFrame(),r.currentFramebuffer=null}),(0,G.Z)(this,"useFramebufferAsync",function(){var n=(0,He.Z)(Ne().mark(function i(a,s){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return r.currentFramebuffer=a,r.preRenderPass=r.renderPass,r.beginFrame(),p.next=5,s();case 5:r.endFrame(),r.currentFramebuffer=null,r.renderPass=r.preRenderPass;case 8:case"end":return p.stop()}},i)}));return function(i,a){return n.apply(this,arguments)}}()),(0,G.Z)(this,"clear",function(n){var i=n.color,a=n.depth,s=n.stencil,c=n.framebuffer,p=c===void 0?null:c;if(p)p.clearOptions={color:i,depth:a,stencil:s};else{var g=r.queryVerdorInfo();if(g==="WebGL1"){var b=r.getGLContext();xm(s)?xm(a)||(b.clearDepth(a),b.clear(b.DEPTH_BUFFER_BIT)):(b.clearStencil(s),b.clear(b.STENCIL_BUFFER_BIT))}else if(g==="WebGL2"){var w=r.getGLContext();xm(s)?xm(a)||w.clearBufferfv(w.DEPTH,0,[a]):w.clearBufferiv(w.STENCIL,0,[s])}}}),(0,G.Z)(this,"viewport",function(n){var i=n.width,a=n.height;r.swapChain.configureSwapChain(i,a),r.createMainColorDepthRT(i,a),r.width=i,r.height=a}),(0,G.Z)(this,"readPixels",function(n){var i=n.framebuffer,a=n.x,s=n.y,c=n.width,p=n.height,g=r.device.createReadback(),b=i.colorTexture,w=g.readTextureSync(b,a,r.viewportOrigin===Mh.LOWER_LEFT?s:r.height-s,c,p,new Uint8Array(c*p*4));return g.destroy(),w}),(0,G.Z)(this,"readPixelsAsync",function(){var n=(0,He.Z)(Ne().mark(function i(a){var s,c,p,g,b,w,I,W,pe,Me;return Ne().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:return s=a.framebuffer,c=a.x,p=a.y,g=a.width,b=a.height,w=r.device.createReadback(),I=s.colorTexture,ut.next=5,w.readTexture(I,c,r.viewportOrigin===Mh.LOWER_LEFT?p:r.height-p,g,b,new Uint8Array(g*b*4));case 5:if(W=ut.sent,r.viewportOrigin!==Mh.LOWER_LEFT)for(pe=0;pe<W.length;pe+=4)Me=W[pe],W[pe]=W[pe+2],W[pe+2]=Me;return w.destroy(),ut.abrupt("return",W);case 9:case"end":return ut.stop()}},i)}));return function(i){return n.apply(this,arguments)}}()),(0,G.Z)(this,"getViewportSize",function(){return{width:r.width,height:r.height}}),(0,G.Z)(this,"getContainer",function(){var n;return(n=r.canvas)===null||n===void 0?void 0:n.parentElement}),(0,G.Z)(this,"getCanvas",function(){return r.canvas}),(0,G.Z)(this,"getGLContext",function(){return r.device.gl}),(0,G.Z)(this,"destroy",function(){var n;r.canvas=null,(n=r.uniformBuffers)===null||n===void 0||n.forEach(function(i){i.destroy()}),r.device.destroy(),r.renderCache.destroy()})}return(0,We.Z)(e,[{key:"init",value:function(){var r=(0,He.Z)(Ne().mark(function i(a,s){var c,p,g,b,w;return Ne().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return c=s.enableWebGPU,p=s.shaderCompilerPath,this.canvas=a,g=c?new QE({shaderCompilerPath:p}):new cE({targets:["webgl2","webgl1"],onContextLost:function(Me){console.warn("context lost",Me)},onContextCreationError:function(Me){console.warn("context creation error",Me)},onContextRestored:function(Me){console.warn("context restored",Me)}}),W.next=5,g.createSwapChain(a);case 5:b=W.sent,b.configureSwapChain(a.width,a.height),this.device=b.getDevice(),this.swapChain=b,this.renderCache=new TS(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin,w=this.device.gl,this.extensionObject={OES_texture_float:!MS(w)&&this.device.OES_texture_float},this.createMainColorDepthRT(a.width,a.height);case 15:case"end":return W.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"createMainColorDepthRT",value:function(n,i){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:fr.U8_RGBA_RT,width:n,height:i,usage:hc.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:fr.D24_S8,width:n,height:i,usage:hc.RENDER_TARGET}))}},{key:"beginFrame",value:function(){this.device.beginFrame();var n=this.currentFramebuffer,i=this.swapChain,a=this.mainColorRT,s=this.mainDepthRT,c=n?n.colorRenderTarget:a,p=n?null:i.getOnscreenTexture(),g=n?n.depthRenderTarget:s,b=(n==null?void 0:n.clearOptions)||{},w=b.color,I=w===void 0?[0,0,0,0]:w,W=b.depth,pe=W===void 0?1:W,Me=b.stencil,Fe=Me===void 0?0:Me,ut=c?Tv(I[0]*255,I[1]*255,I[2]*255,I[3]):tm,Ot=g?pe:void 0,Bt=g?Fe:void 0,ir=this.device.createRenderPass({colorAttachment:[c],colorResolveTo:[p],colorClearColor:[ut],colorStore:[!0],depthStencilAttachment:g,depthClearValue:Ot,stencilClearValue:Bt});this.renderPass=ir}},{key:"endFrame",value:function(){this.device.submitPass(this.renderPass),this.device.endFrame()}},{key:"getPointSizeRange",value:function(){var n=this.device.gl;return n.getParameter(n.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(n){return!!this.getGLContext().getExtension(n)}},{key:"setState",value:function(){}},{key:"setBaseState",value:function(){}},{key:"setCustomLayerDefaults",value:function(){}},{key:"setDirty",value:function(n){this.isDirty=n}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||oy);function OS(e){var r=PS();return function(){var i=(0,kn.Z)(e),a;if(r){var s=(0,kn.Z)(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return(0,Hi.Z)(this,a)}}function PS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Km=["selectstart","selecting","selectend"],DS=function(e){(0,Ai.Z)(n,e);var r=OS(n);function n(i){var a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,Ge.Z)(this,n),a=r.call(this),(0,G.Z)((0,gn.Z)(a),"isEnable",!1),(0,G.Z)((0,gn.Z)(a),"onDragStart",function(c){a.box.style.display="block",a.startEvent=a.endEvent=c,a.syncBoxBound(),a.emit("selectstart",a.getLngLatBox(),a.startEvent,a.endEvent)}),(0,G.Z)((0,gn.Z)(a),"onDragging",function(c){a.endEvent=c,a.syncBoxBound(),a.emit("selecting",a.getLngLatBox(),a.startEvent,a.endEvent)}),(0,G.Z)((0,gn.Z)(a),"onDragEnd",function(c){a.endEvent=c,a.box.style.display="none",a.emit("selectend",a.getLngLatBox(),a.startEvent,a.endEvent)}),a.scene=i,a.options=s,a}return(0,We.Z)(n,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var a=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var s=ze.SO.create("div",void 0,this.container);s.classList.add("l7-select-box"),a&&s.classList.add(a),s.style.display="none",this.box=s}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var a=this.startEvent,s=a.x,c=a.y,p=this.endEvent,g=p.x,b=p.y,w=Math.min(s,g),I=Math.min(c,b),W=Math.abs(s-g),pe=Math.abs(c-b);this.box.style.top="".concat(I,"px"),this.box.style.left="".concat(w,"px"),this.box.style.width="".concat(W,"px"),this.box.style.height="".concat(pe,"px")}},{key:"getLngLatBox",value:function(){var a=this.startEvent.lngLat,s=a.lng,c=a.lat,p=this.endEvent.lngLat,g=p.lng,b=p.lat;return(0,ze.Ol)([[s,c],[g,b]])}}]),n}(Sl.EventEmitter),kS=function(){function e(r){(0,Ge.Z)(this,e);var n=r.id,i=r.map,a=r.canvas,s=r.renderer,c=s===void 0?"regl":s,p=(0,$.Hp)();this.container=p,i.setContainer(p,n,a),p.bind($.vK.IRendererService).to(c==="regl"?nS:IS).inSingletonScope(),this.sceneService=p.get($.vK.ISceneService),this.mapService=p.get($.vK.IMapService),this.iconService=p.get($.vK.IIconService),this.fontService=p.get($.vK.IFontService),this.controlService=p.get($.vK.IControlService),this.layerService=p.get($.vK.ILayerService),this.debugService=p.get($.vK.IDebugService),this.debugService.setEnable(r.debug),this.markerService=p.get($.vK.IMarkerService),this.interactionService=p.get($.vK.IInteractionService),this.popupService=p.get($.vK.IPopupService),this.boxSelect=new DS(this,{}),this.initComponent(n),this.sceneService.init(r),this.initControl()}return(0,We.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var r=(0,He.Z)(Ne().mark(function i(a){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.sceneService.exportPng(a));case 1:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"exportMap",value:function(){var r=(0,He.Z)(Ne().mark(function i(a){return Ne().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.sceneService.exportPng(a));case 1:case"end":return c.stop()}},i,this)}));function n(i){return r.apply(this,arguments)}return n}()},{key:"registerRenderService",value:function(n){var i=this;if(this.sceneService.loaded){var a=new n(this);a.init()}else this.on("loaded",function(){var s=new n(i);s.init()})}},{key:"setBgColor",value:function(n){this.mapService.setBgColor(n)}},{key:"addLayer",value:function(n){var i=this,a=(0,$.e7)(this.container);if(n.setContainer(a,this.container),this.sceneService.addLayer(n),n.inited){var s=this.initMask(n);this.addMask(s,n.id)}else n.on("inited",function(){var c=i.initMask(n);i.addMask(c,n.id)})}},{key:"initMask",value:function(n){var i=n.getLayerConfig(),a=i.mask,s=i.maskfence,c=i.maskColor,p=c===void 0?"#000":c,g=i.maskOpacity,b=g===void 0?0:g;if(!(!a||!s)){var w=new pu().source(s).shape("fill").style({color:p,opacity:b});return w}}},{key:"addMask",value:function(n,i){if(n){var a=this.getLayer(i);if(a){var s=(0,$.e7)(this.container);n.setContainer(s,this.container),a.addMaskLayer(n),this.sceneService.addMask(n)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(n){return this.layerService.getLayer(n)}},{key:"getLayerByName",value:function(n){return this.layerService.getLayerByName(n)}},{key:"removeLayer",value:function(){var r=(0,He.Z)(Ne().mark(function i(a,s){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.layerService.remove(a,s);case 2:case"end":return p.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"removeAllLayer",value:function(){var r=(0,He.Z)(Ne().mark(function i(){return Ne().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.layerService.removeAllLayers();case 2:case"end":return s.stop()}},i,this)}));function n(){return r.apply(this,arguments)}return n}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(n){this.layerService.setEnableRender(n)}},{key:"addIconFont",value:function(n,i){this.fontService.addIconFont(n,i)}},{key:"addIconFonts",value:function(n){var i=this;n.forEach(function(a){var s=(0,Fi.Z)(a,2),c=s[0],p=s[1];i.fontService.addIconFont(c,p)})}},{key:"addFontFace",value:function(n,i){var a=this;this.fontService.once("fontloaded",function(s){a.emit("fontloaded",s)}),this.fontService.addFontFace(n,i)}},{key:"addImage",value:function(){var r=(0,He.Z)(Ne().mark(function i(a,s){return Ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.iconService.addImage(a,s);case 2:case"end":return p.stop()}},i,this)}));function n(i,a){return r.apply(this,arguments)}return n}()},{key:"hasImage",value:function(n){return this.iconService.hasImage(n)}},{key:"removeImage",value:function(n){this.iconService.removeImage(n)}},{key:"addIconFontGlyphs",value:function(n,i){this.fontService.addIconGlyphs(i)}},{key:"addControl",value:function(n){this.controlService.addControl(n,this.container)}},{key:"removeControl",value:function(n){this.controlService.removeControl(n)}},{key:"getControlByName",value:function(n){return this.controlService.getControlByName(n)}},{key:"addMarker",value:function(n){this.markerService.addMarker(n)}},{key:"addMarkerLayer",value:function(n){this.markerService.addMarkerLayer(n)}},{key:"removeMarkerLayer",value:function(n){this.markerService.removeMarkerLayer(n)}},{key:"removeAllMarkers",value:function(){this.markerService.removeAllMarkers()}},{key:"removeAllMakers",value:function(){console.warn("removeAllMakers \u5DF2\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 removeAllMarkers"),this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(n){this.popupService.addPopup(n)}},{key:"removePopup",value:function(n){this.popupService.removePopup(n)}},{key:"on",value:function(n,i){if(Km.includes(n)){var a;(a=this.boxSelect)===null||a===void 0||a.on(n,i)}else $.P7.includes(n)?this.sceneService.on(n,i):this.mapService.on(n,i)}},{key:"once",value:function(n,i){if(Km.includes(n)){var a;(a=this.boxSelect)===null||a===void 0||a.once(n,i)}else $.P7.includes(n)?this.sceneService.once(n,i):this.mapService.once(n,i)}},{key:"emit",value:function(n,i){$.P7.indexOf(n)===-1?this.mapService.on(n,i):this.sceneService.emit(n,i)}},{key:"off",value:function(n,i){if(Km.includes(n)){var a;(a=this.boxSelect)===null||a===void 0||a.off(n,i)}else $.P7.includes(n)?this.sceneService.off(n,i):this.mapService.off(n,i)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(n){return this.mapService.getCenter(n)}},{key:"setCenter",value:function(n,i){return this.mapService.setCenter(n,i)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(n){return this.mapService.setPitch(n)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(n){this.mapService.setRotation(n)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(n){this.mapService.panTo(n)}},{key:"panBy",value:function(n,i){this.mapService.panBy(n,i)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(n){this.mapService.setZoom(n)}},{key:"fitBounds",value:function(n,i){var a=this.sceneService.getSceneConfig(),s=a.fitBoundsOptions,c=a.animate;this.mapService.fitBounds(n,i||(0,fe.Z)((0,fe.Z)({},s),{},{animate:c}))}},{key:"setZoomAndCenter",value:function(n,i){this.mapService.setZoomAndCenter(n,i)}},{key:"setMapStyle",value:function(n){this.mapService.setMapStyle(n)}},{key:"setMapStatus",value:function(n){this.mapService.setMapStatus(n)}},{key:"pixelToLngLat",value:function(n){return this.mapService.pixelToLngLat(n)}},{key:"lngLatToPixel",value:function(n){return this.mapService.lngLatToPixel(n)}},{key:"containerToLngLat",value:function(n){return this.mapService.containerToLngLat(n)}},{key:"lngLatToContainer",value:function(n){return this.mapService.lngLatToContainer(n)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(n,i){this.container.bind($.vK.IPostProcessingPass).to(n).whenTargetNamed(i)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),i&&this.boxSelect.once("selectend",function(){n.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getProtocol",value:function(n){return ze.SA.REGISTERED_PROTOCOLS[n]}},{key:"startAnimate",value:function(){this.layerService.startAnimate()}},{key:"stopAnimate",value:function(){this.layerService.stopAnimate()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(n){this.controlService.init({container:ze.SO.getContainer(n)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var n=this.sceneService.getSceneConfig(),i=n.logoVisible,a=n.logoPosition;i&&this.addControl(new ec({position:a}))}}],[{key:"addProtocol",value:function(n,i){ze.SA.REGISTERED_PROTOCOLS[n]=i}},{key:"removeProtocol",value:function(n){delete ze.SA.REGISTERED_PROTOCOLS[n]}}]),e}(),E2="2.20.20"},131:function(Ze,E,_){"use strict";_.r(E),_.d(E,{TinyColor:function(){return D.C},bounds:function(){return Re},convertDecimalToHex:function(){return P.Wl},convertHexToDecimal:function(){return P.T6},default:function(){return Ae},fromRatio:function(){return V},hslToRgb:function(){return P.ve},hsvToRgb:function(){return P.WE},inputToRGB:function(){return k.uA},isReadable:function(){return O},isValidCSSUnit:function(){return k.ky},legacyRandom:function(){return Q},mostReadable:function(){return C},names:function(){return N.R},numberInputToObject:function(){return P.Yt},parseIntFromHex:function(){return P.VD},random:function(){return K},readability:function(){return h},rgbToHex:function(){return P.vq},rgbToHsl:function(){return P.lC},rgbToHsv:function(){return P.py},rgbToRgb:function(){return P.rW},rgbaToArgbHex:function(){return P.GC},rgbaToHex:function(){return P.s},stringInputToObject:function(){return k.uz},tinycolor:function(){return D.H},toMsFilter:function(){return F}});var D=_(10274),N=_(48701);function h(ae,ee){var me=new D.C(ae),ge=new D.C(ee);return(Math.max(me.getLuminance(),ge.getLuminance())+.05)/(Math.min(me.getLuminance(),ge.getLuminance())+.05)}function O(ae,ee,me){var ge,fe;me===void 0&&(me={level:"AA",size:"small"});var Et=h(ae,ee);switch(((ge=me.level)!==null&&ge!==void 0?ge:"AA")+((fe=me.size)!==null&&fe!==void 0?fe:"small")){case"AAsmall":case"AAAlarge":return Et>=4.5;case"AAlarge":return Et>=3;case"AAAsmall":return Et>=7;default:return!1}}function C(ae,ee,me){me===void 0&&(me={includeFallbackColors:!1,level:"AA",size:"small"});for(var ge=null,fe=0,Et=me.includeFallbackColors,xe=me.level,je=me.size,ue=0,Pe=ee;ue<Pe.length;ue++){var we=Pe[ue],nt=h(ae,we);nt>fe&&(fe=nt,ge=new D.C(we))}return O(ae,ge,{level:xe,size:je})||!Et?ge:(me.includeFallbackColors=!1,C(ae,["#fff","#000"],me))}var P=_(86500);function F(ae,ee){var me=new D.C(ae),ge="#"+(0,P.GC)(me.r,me.g,me.b,me.a),fe=ge,Et=me.gradientType?"GradientType = 1, ":"";if(ee){var xe=new D.C(ee);fe="#"+(0,P.GC)(xe.r,xe.g,xe.b,xe.a)}return"progid:DXImageTransform.Microsoft.gradient(".concat(Et,"startColorstr=").concat(ge,",endColorstr=").concat(fe,")")}var Y=_(90279);function V(ae,ee){var me={r:(0,Y.JX)(ae.r),g:(0,Y.JX)(ae.g),b:(0,Y.JX)(ae.b)};return ae.a!==void 0&&(me.a=Number(ae.a)),new D.C(me,ee)}function Q(){return new D.C({r:Math.random(),g:Math.random(),b:Math.random()})}var k=_(1350);function K(ae){if(ae===void 0&&(ae={}),ae.count!==void 0&&ae.count!==null){var ee=ae.count,me=[];for(ae.count=void 0;ee>me.length;)ae.count=null,ae.seed&&(ae.seed+=1),me.push(K(ae));return ae.count=ee,me}var ge=U(ae.hue,ae.seed),fe=Z(ge,ae),Et=J(ge,fe,ae),xe={h:ge,s:fe,v:Et};return ae.alpha!==void 0&&(xe.a=ae.alpha),new D.C(xe)}function U(ae,ee){var me=ve(ae),ge=ye(me,ee);return ge<0&&(ge=360+ge),ge}function Z(ae,ee){if(ee.hue==="monochrome")return 0;if(ee.luminosity==="random")return ye([0,100],ee.seed);var me=Te(ae).saturationRange,ge=me[0],fe=me[1];switch(ee.luminosity){case"bright":ge=55;break;case"dark":ge=fe-10;break;case"light":fe=55;break;default:break}return ye([ge,fe],ee.seed)}function J(ae,ee,me){var ge=H(ae,ee),fe=100;switch(me.luminosity){case"dark":fe=ge+20;break;case"light":ge=(fe+ge)/2;break;case"random":ge=0,fe=100;break;default:break}return ye([ge,fe],me.seed)}function H(ae,ee){for(var me=Te(ae).lowerBounds,ge=0;ge<me.length-1;ge++){var fe=me[ge][0],Et=me[ge][1],xe=me[ge+1][0],je=me[ge+1][1];if(ee>=fe&&ee<=xe){var ue=(je-Et)/(xe-fe),Pe=Et-ue*fe;return ue*ee+Pe}}return 0}function ve(ae){var ee=parseInt(ae,10);if(!Number.isNaN(ee)&&ee<360&&ee>0)return[ee,ee];if(typeof ae=="string"){var me=Re.find(function(xe){return xe.name===ae});if(me){var ge=Ve(me);if(ge.hueRange)return ge.hueRange}var fe=new D.C(ae);if(fe.isValid){var Et=fe.toHsv().h;return[Et,Et]}}return[0,360]}function Te(ae){ae>=334&&ae<=360&&(ae-=360);for(var ee=0,me=Re;ee<me.length;ee++){var ge=me[ee],fe=Ve(ge);if(fe.hueRange&&ae>=fe.hueRange[0]&&ae<=fe.hueRange[1])return fe}throw Error("Color not found")}function ye(ae,ee){if(ee===void 0)return Math.floor(ae[0]+Math.random()*(ae[1]+1-ae[0]));var me=ae[1]||1,ge=ae[0]||0;ee=(ee*9301+49297)%233280;var fe=ee/233280;return Math.floor(ge+fe*(me-ge))}function Ve(ae){var ee=ae.lowerBounds[0][0],me=ae.lowerBounds[ae.lowerBounds.length-1][0],ge=ae.lowerBounds[ae.lowerBounds.length-1][1],fe=ae.lowerBounds[0][1];return{name:ae.name,hueRange:ae.hueRange,lowerBounds:ae.lowerBounds,saturationRange:[ee,me],brightnessRange:[ge,fe]}}var Re=[{name:"monochrome",hueRange:null,lowerBounds:[[0,0],[100,0]]},{name:"red",hueRange:[-26,18],lowerBounds:[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]},{name:"orange",hueRange:[19,46],lowerBounds:[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]},{name:"yellow",hueRange:[47,62],lowerBounds:[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]},{name:"green",hueRange:[63,178],lowerBounds:[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]},{name:"blue",hueRange:[179,257],lowerBounds:[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]},{name:"purple",hueRange:[258,282],lowerBounds:[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]},{name:"pink",hueRange:[283,334],lowerBounds:[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]}],Ae=D.H},38163:function(Ze){Ze.exports=E;function E(N,h){var O=N&&N.type,C;if(O==="FeatureCollection")for(C=0;C<N.features.length;C++)E(N.features[C],h);else if(O==="GeometryCollection")for(C=0;C<N.geometries.length;C++)E(N.geometries[C],h);else if(O==="Feature")E(N.geometry,h);else if(O==="Polygon")_(N.coordinates,h);else if(O==="MultiPolygon")for(C=0;C<N.coordinates.length;C++)_(N.coordinates[C],h);return N}function _(N,h){if(N.length!==0){D(N[0],h);for(var O=1;O<N.length;O++)D(N[O],!h)}}function D(N,h){for(var O=0,C=0,P=0,F=N.length,Y=F-1;P<F;Y=P++){var V=(N[P][0]-N[Y][0])*(N[Y][1]+N[P][1]),Q=O+V;C+=Math.abs(O)>=Math.abs(V)?O-Q+V:V-Q+O,O=Q}O+C>=0!=!!h&&N.reverse()}},75550:function(Ze){"use strict";Ze.exports=E;function E(_,D){this.x=_,this.y=D}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(_){return this.clone()._add(_)},sub:function(_){return this.clone()._sub(_)},multByPoint:function(_){return this.clone()._multByPoint(_)},divByPoint:function(_){return this.clone()._divByPoint(_)},mult:function(_){return this.clone()._mult(_)},div:function(_){return this.clone()._div(_)},rotate:function(_){return this.clone()._rotate(_)},rotateAround:function(_,D){return this.clone()._rotateAround(_,D)},matMult:function(_){return this.clone()._matMult(_)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(_){return this.x===_.x&&this.y===_.y},dist:function(_){return Math.sqrt(this.distSqr(_))},distSqr:function(_){var D=_.x-this.x,N=_.y-this.y;return D*D+N*N},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(_){return Math.atan2(this.y-_.y,this.x-_.x)},angleWith:function(_){return this.angleWithSep(_.x,_.y)},angleWithSep:function(_,D){return Math.atan2(this.x*D-this.y*_,this.x*_+this.y*D)},_matMult:function(_){var D=_[0]*this.x+_[1]*this.y,N=_[2]*this.x+_[3]*this.y;return this.x=D,this.y=N,this},_add:function(_){return this.x+=_.x,this.y+=_.y,this},_sub:function(_){return this.x-=_.x,this.y-=_.y,this},_mult:function(_){return this.x*=_,this.y*=_,this},_div:function(_){return this.x/=_,this.y/=_,this},_multByPoint:function(_){return this.x*=_.x,this.y*=_.y,this},_divByPoint:function(_){return this.x/=_.x,this.y/=_.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var _=this.y;return this.y=this.x,this.x=-_,this},_rotate:function(_){var D=Math.cos(_),N=Math.sin(_),h=D*this.x-N*this.y,O=N*this.x+D*this.y;return this.x=h,this.y=O,this},_rotateAround:function(_,D){var N=Math.cos(_),h=Math.sin(_),O=D.x+N*(this.x-D.x)-h*(this.y-D.y),C=D.y+h*(this.x-D.x)+N*(this.y-D.y);return this.x=O,this.y=C,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},E.convert=function(_){return _ instanceof E?_:Array.isArray(_)?new E(_[0],_[1]):_}},49296:function(Ze){"use strict";Ze.exports=_,Ze.exports.default=_;var E=1e20;function _(C,P,F,Y,V,Q){this.fontSize=C||24,this.buffer=P===void 0?3:P,this.cutoff=Y||.25,this.fontFamily=V||"sans-serif",this.fontWeight=Q||"normal",this.radius=F||8;var k=this.size=this.fontSize+this.buffer*2,K=k+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=k,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(K*K),this.gridInner=new Float64Array(K*K),this.f=new Float64Array(K),this.z=new Float64Array(K+1),this.v=new Uint16Array(K),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(k/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function D(C,P,F,Y,V,Q,k){Q.fill(E,0,P*F),k.fill(0,0,P*F);for(var K=(P-Y)/2,U=0;U<V;U++)for(var Z=0;Z<Y;Z++){var J=(U+K)*P+Z+K,H=C.data[4*(U*Y+Z)+3]/255;if(H===1)Q[J]=0,k[J]=E;else if(H===0)Q[J]=E,k[J]=0;else{var ve=Math.max(0,.5-H),Te=Math.max(0,H-.5);Q[J]=ve*ve,k[J]=Te*Te}}}function N(C,P,F,Y,V,Q,k){for(var K=0;K<P*F;K++){var U=Math.sqrt(Y[K])-Math.sqrt(V[K]);C[K]=Math.round(255-255*(U/Q+k))}}_.prototype._draw=function(C,P){var F=this.ctx.measureText(C),Y=F.width,V=2*this.buffer,Q,k,K,U,Z,J,H,ve;P&&this.useMetrics?(Z=Math.floor(F.actualBoundingBoxAscent),ve=this.buffer+Math.ceil(F.actualBoundingBoxAscent),J=this.buffer,H=this.buffer,k=Math.min(this.size,Math.ceil(F.actualBoundingBoxRight-F.actualBoundingBoxLeft)),U=Math.min(this.size-J,Math.ceil(F.actualBoundingBoxAscent+F.actualBoundingBoxDescent)),Q=k+V,K=U+V,this.ctx.textBaseline="alphabetic"):(Q=k=this.size,K=U=this.size,Z=19*this.fontSize/24,J=H=0,ve=this.middle,this.ctx.textBaseline="middle");var Te;k&&U&&(this.ctx.clearRect(H,J,k,U),this.ctx.fillText(C,this.buffer,ve),Te=this.ctx.getImageData(H,J,k,U));var ye=new Uint8ClampedArray(Q*K);return D(Te,Q,K,k,U,this.gridOuter,this.gridInner),h(this.gridOuter,Q,K,this.f,this.v,this.z),h(this.gridInner,Q,K,this.f,this.v,this.z),N(ye,Q,K,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ye,metrics:{width:k,height:U,sdfWidth:Q,sdfHeight:K,top:Z,left:0,advance:Y}}},_.prototype.draw=function(C){return this._draw(C,!1).data},_.prototype.drawWithMetrics=function(C){return this._draw(C,!0)};function h(C,P,F,Y,V,Q){for(var k=0;k<P;k++)O(C,k,P,F,Y,V,Q);for(var K=0;K<F;K++)O(C,K*P,1,P,Y,V,Q)}function O(C,P,F,Y,V,Q,k){var K,U,Z,J;for(Q[0]=0,k[0]=-E,k[1]=E,K=0;K<Y;K++)V[K]=C[P+K*F];for(K=1,U=0,Z=0;K<Y;K++){do J=Q[U],Z=(V[K]-V[J]+K*K-J*J)/(K-J)/2;while(Z<=k[U]&&--U>-1);U++,Q[U]=K,k[U]=Z,k[U+1]=E}for(K=0,U=0;K<Y;K++){for(;k[U+1]<K;)U++;J=Q[U],C[P+K*F]=V[J]+(K-J)*(K-J)}}},38929:function(Ze,E,_){Ze.exports.VectorTile=_(22779),_(66024),_(59701)},22779:function(Ze,E,_){"use strict";var D=_(59701);Ze.exports=N;function N(O,C){this.layers=O.readFields(h,{},C)}function h(O,C,P){if(O===3){var F=new D(P,P.readVarint()+P.pos);F.length&&(C[F.name]=F)}}},66024:function(Ze,E,_){"use strict";var D=_(75550);Ze.exports=N;function N(F,Y,V,Q,k){this.properties={},this.extent=V,this.type=0,this._pbf=F,this._geometry=-1,this._keys=Q,this._values=k,F.readFields(h,this,Y)}function h(F,Y,V){F==1?Y.id=V.readVarint():F==2?O(V,Y):F==3?Y.type=V.readVarint():F==4&&(Y._geometry=V.pos)}function O(F,Y){for(var V=F.readVarint()+F.pos;F.pos<V;){var Q=Y._keys[F.readVarint()],k=Y._values[F.readVarint()];Y.properties[Q]=k}}N.types=["Unknown","Point","LineString","Polygon"],N.prototype.loadGeometry=function(){var F=this._pbf;F.pos=this._geometry;for(var Y=F.readVarint()+F.pos,V=1,Q=0,k=0,K=0,U=[],Z;F.pos<Y;){if(Q<=0){var J=F.readVarint();V=J&7,Q=J>>3}if(Q--,V===1||V===2)k+=F.readSVarint(),K+=F.readSVarint(),V===1&&(Z&&U.push(Z),Z=[]),Z.push(new D(k,K));else if(V===7)Z&&Z.push(Z[0].clone());else throw new Error("unknown command "+V)}return Z&&U.push(Z),U},N.prototype.bbox=function(){var F=this._pbf;F.pos=this._geometry;for(var Y=F.readVarint()+F.pos,V=1,Q=0,k=0,K=0,U=1/0,Z=-1/0,J=1/0,H=-1/0;F.pos<Y;){if(Q<=0){var ve=F.readVarint();V=ve&7,Q=ve>>3}if(Q--,V===1||V===2)k+=F.readSVarint(),K+=F.readSVarint(),k<U&&(U=k),k>Z&&(Z=k),K<J&&(J=K),K>H&&(H=K);else if(V!==7)throw new Error("unknown command "+V)}return[U,J,Z,H]},N.prototype.toGeoJSON=function(F,Y,V){var Q=this.extent*Math.pow(2,V),k=this.extent*F,K=this.extent*Y,U=this.loadGeometry(),Z=N.types[this.type],J,H;function ve(Ve){for(var Re=0;Re<Ve.length;Re++){var Ae=Ve[Re],ae=180-(Ae.y+K)*360/Q;Ve[Re]=[(Ae.x+k)*360/Q-180,360/Math.PI*Math.atan(Math.exp(ae*Math.PI/180))-90]}}switch(this.type){case 1:var Te=[];for(J=0;J<U.length;J++)Te[J]=U[J][0];U=Te,ve(U);break;case 2:for(J=0;J<U.length;J++)ve(U[J]);break;case 3:for(U=C(U),J=0;J<U.length;J++)for(H=0;H<U[J].length;H++)ve(U[J][H]);break}U.length===1?U=U[0]:Z="Multi"+Z;var ye={type:"Feature",geometry:{type:Z,coordinates:U},properties:this.properties};return"id"in this&&(ye.id=this.id),ye};function C(F){var Y=F.length;if(Y<=1)return[F];for(var V=[],Q,k,K=0;K<Y;K++){var U=P(F[K]);U!==0&&(k===void 0&&(k=U<0),k===U<0?(Q&&V.push(Q),Q=[F[K]]):Q.push(F[K]))}return Q&&V.push(Q),V}function P(F){for(var Y=0,V=0,Q=F.length,k=Q-1,K,U;V<Q;k=V++)K=F[V],U=F[k],Y+=(U.x-K.x)*(K.y+U.y);return Y}},59701:function(Ze,E,_){"use strict";var D=_(66024);Ze.exports=N;function N(C,P){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=C,this._keys=[],this._values=[],this._features=[],C.readFields(h,this,P),this.length=this._features.length}function h(C,P,F){C===15?P.version=F.readVarint():C===1?P.name=F.readString():C===5?P.extent=F.readVarint():C===2?P._features.push(F.pos):C===3?P._keys.push(F.readString()):C===4&&P._values.push(O(F))}function O(C){for(var P=null,F=C.readVarint()+C.pos;C.pos<F;){var Y=C.readVarint()>>3;P=Y===1?C.readString():Y===2?C.readFloat():Y===3?C.readDouble():Y===4?C.readVarint64():Y===5?C.readVarint():Y===6?C.readSVarint():Y===7?C.readBoolean():null}return P}N.prototype.feature=function(C){if(C<0||C>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[C];var P=this._pbf.readVarint()+this._pbf.pos;return new D(this._pbf,P,this.extent,this._keys,this._values)}},45471:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.PresetStatusColorTypes=void 0,E.isPresetColor=P,E.isPresetStatusColor=F;var N=D(_(861)),h=_(36496);const O=h.PresetColors.map(Y=>`${Y}-inverse`),C=E.PresetStatusColorTypes=["success","processing","error","default","warning"];function P(Y){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat((0,N.default)(O),(0,N.default)(h.PresetColors)).includes(Y):h.PresetColors.includes(Y)}function F(Y){return C.includes(Y)}},49314:function(Ze,E,_){"use strict";"use client";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(67294)),h=D(_(43273));const O=P=>{let F;return typeof P=="object"&&(P!=null&&P.clearIcon)?F=P:P&&(F={clearIcon:N.default.createElement(h.default,null)}),F};var C=E.default=O},56333:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.containerBaseZIndexOffset=E.consumerBaseZIndexOffset=E.CONTAINER_MAX_OFFSET=void 0,E.useZIndex=k;var N=D(_(67294)),h=D(_(41401)),O=D(_(96877));const C=100,P=10,F=E.CONTAINER_MAX_OFFSET=C*P,Y=E.containerBaseZIndexOffset={Modal:C,Drawer:C,Popover:C,Popconfirm:C,Tooltip:C,Tour:C},V=E.consumerBaseZIndexOffset={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function Q(K){return K in Y}function k(K,U){const[,Z]=(0,h.default)(),J=N.default.useContext(O.default),H=Q(K);if(U!==void 0)return[U,U];let ve=J!=null?J:0;return H?(ve+=(J?0:Z.zIndexPopupBase)+Y[K],ve=Math.min(ve,Z.zIndexPopupBase+F)):ve+=V[K],[J===void 0?U:ve,ve]}},53683:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.getTransitionName=E.default=void 0;const _=()=>({height:0,opacity:0}),D=Y=>{const{scrollHeight:V}=Y;return{height:V,opacity:1}},N=Y=>({height:Y?Y.offsetHeight:0}),h=(Y,V)=>(V==null?void 0:V.deadline)===!0||V.propertyName==="height",O=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:_,onEnterStart:_,onAppearActive:D,onEnterActive:D,onLeaveStart:N,onLeaveActive:_,onAppearEnd:h,onEnterEnd:h,onLeaveEnd:h,motionDeadline:500}},C=null,P=(Y,V,Q)=>Q!==void 0?Q:`${Y}-${V}`;E.getTransitionName=P;var F=E.default=O},74132:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=P,E.getOverflowOptions=N;var D=_(9064);function N(F,Y,V,Q){if(Q===!1)return{adjustX:!1,adjustY:!1};const k=Q&&typeof Q=="object"?Q:{},K={};switch(F){case"top":case"bottom":K.shiftX=Y.arrowOffsetHorizontal*2+V,K.shiftY=!0,K.adjustY=!0;break;case"left":case"right":K.shiftY=Y.arrowOffsetVertical*2+V,K.shiftX=!0,K.adjustX=!0;break}const U=Object.assign(Object.assign({},K),k);return U.shiftX||(U.adjustX=!0),U.shiftY||(U.adjustY=!0),U}const h={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},O={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},C=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function P(F){const{arrowWidth:Y,autoAdjustOverflow:V,arrowPointAtCenter:Q,offset:k,borderRadius:K,visibleFirst:U}=F,Z=Y/2,J={};return Object.keys(h).forEach(H=>{const ve=Q&&O[H]||h[H],Te=Object.assign(Object.assign({},ve),{offset:[0,0],dynamicInset:!0});switch(J[H]=Te,C.has(H)&&(Te.autoArrow=!1),H){case"top":case"topLeft":case"topRight":Te.offset[1]=-Z-k;break;case"bottom":case"bottomLeft":case"bottomRight":Te.offset[1]=Z+k;break;case"left":case"leftTop":case"leftBottom":Te.offset[0]=-Z-k;break;case"right":case"rightTop":case"rightBottom":Te.offset[0]=Z+k;break}const ye=(0,D.getArrowOffsetToken)({contentRadius:K,limitVerticalRadius:!0});if(Q)switch(H){case"topLeft":case"bottomLeft":Te.offset[0]=-ye.arrowOffsetHorizontal-Z;break;case"topRight":case"bottomRight":Te.offset[0]=ye.arrowOffsetHorizontal+Z;break;case"leftTop":case"rightTop":Te.offset[1]=-ye.arrowOffsetHorizontal-Z;break;case"leftBottom":case"rightBottom":Te.offset[1]=ye.arrowOffsetHorizontal+Z;break}Te.overflow=N(H,ye,Y,V),U&&(Te.htmlRegion="visibleFirst")}),J}},47419:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.cloneElement=C,E.isFragment=h,E.replaceElement=void 0;var N=D(_(67294));function h(P){return P&&N.default.isValidElement(P)&&P.type===N.default.Fragment}const O=(P,F,Y)=>N.default.isValidElement(P)?N.default.cloneElement(P,typeof Y=="function"?Y(P.props||{}):Y):F;E.replaceElement=O;function C(P,F){return O(P,P,F)}},71434:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.getMergedStatus=void 0,E.getStatusClassNames=O;var N=D(_(93967));const h=null;function O(P,F,Y){return(0,N.default)({[`${P}-status-success`]:F==="success",[`${P}-status-warning`]:F==="warning",[`${P}-status-error`]:F==="error",[`${P}-status-validating`]:F==="validating",[`${P}-has-feedback`]:Y})}const C=(P,F)=>F||P;E.getMergedStatus=C},38882:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.canUseDocElement=void 0,Object.defineProperty(E,"isStyleSupport",{enumerable:!0,get:function(){return h.isStyleSupport}});var N=D(_(19158)),h=_(3481);const O=()=>(0,N.default)()&&window.document.documentElement;E.canUseDocElement=O},60938:function(Ze,E,_){"use strict";"use client";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(27712)),O=D(_(67294)),C=function(V,Q){var k={};for(var K in V)Object.prototype.hasOwnProperty.call(V,K)&&Q.indexOf(K)<0&&(k[K]=V[K]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var U=0,K=Object.getOwnPropertySymbols(V);U<K.length;U++)Q.indexOf(K[U])<0&&Object.prototype.propertyIsEnumerable.call(V,K[U])&&(k[K[U]]=V[K[U]]);return k};const P={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},F=O.forwardRef((V,Q)=>{const k=Te=>{const{keyCode:ye}=Te;ye===h.default.ENTER&&Te.preventDefault()},K=Te=>{const{keyCode:ye}=Te,{onClick:Ve}=V;ye===h.default.ENTER&&Ve&&Ve()},{style:U,noStyle:Z,disabled:J}=V,H=C(V,["style","noStyle","disabled"]);let ve={};return Z||(ve=Object.assign({},P)),J&&(ve.pointerEvents="none"),ve=Object.assign(Object.assign({},ve),U),O.createElement("div",Object.assign({role:"button",tabIndex:0,ref:Q},H,{onKeyDown:k,onKeyUp:K,style:ve}))});var Y=E.default=F},13594:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.devUseWarning=E.default=E.WarningContext=void 0,E.noop=O,E.resetWarned=P;var N=D(_(67294)),h=D(_(45520));function O(){}let C=null;function P(){C=null,(0,h.resetWarned)()}let F=O;const Y=E.WarningContext=N.createContext({}),V=E.devUseWarning=()=>{const k=()=>{};return k.deprecated=O,k};var Q=E.default=F},96877:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(67294));const h=N.default.createContext(void 0);var O=E.default=h},1028:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(25633)),h=E.default=N.default},93319:function(Ze,E,_){"use strict";"use client";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=E.DisabledContextProvider=void 0;var N=D(_(67294));const h=N.createContext(!1),O=P=>{let{children:F,disabled:Y}=P;const V=N.useContext(h);return N.createElement(h.Provider,{value:Y!=null?Y:V},F)};E.DisabledContextProvider=O;var C=E.default=h},16722:function(Ze,E,_){"use strict";"use client";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=C;var N=_(82225),h=D(_(67294)),O=_(3184);function C(P){const{children:F}=P,[,Y]=(0,O.useToken)(),{motion:V}=Y,Q=h.useRef(!1);return Q.current=Q.current||V===!1,Q.current?h.createElement(N.Provider,{motion:V},F):F}},11380:function(Ze,E,_){"use strict";"use client";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(67294)),h=_(13594);const O=null;var C=E.default=()=>null},3236:function(Ze,E,_){"use strict";"use client";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=E.SizeContextProvider=void 0;var N=D(_(67294));const h=N.createContext(void 0),O=P=>{let{children:F,size:Y}=P;const V=N.useContext(h);return N.createElement(h.Provider,{value:Y||V},F)};E.SizeContextProvider=O;var C=E.default=h},7177:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.defaultIconPrefixCls=E.ConfigContext=E.ConfigConsumer=void 0;var N=D(_(67294));const h=E.defaultIconPrefixCls="anticon",O=(F,Y)=>Y||(F?`ant-${F}`:"ant"),C=E.ConfigContext=N.createContext({getPrefixCls:O,iconPrefixCls:h}),{Consumer:P}=C;E.ConfigConsumer=P},56301:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.getStyle=Y,E.registerTheme=V;var N=_(78589),h=_(131),O=D(_(19158)),C=_(93399),P=D(_(13594));const F=`-ant-${Date.now()}-${Math.random()}`;function Y(Q,k){const K={},U=(H,ve)=>{let Te=H.clone();return Te=(ve==null?void 0:ve(Te))||Te,Te.toRgbString()},Z=(H,ve)=>{const Te=new h.TinyColor(H),ye=(0,N.generate)(Te.toRgbString());K[`${ve}-color`]=U(Te),K[`${ve}-color-disabled`]=ye[1],K[`${ve}-color-hover`]=ye[4],K[`${ve}-color-active`]=ye[6],K[`${ve}-color-outline`]=Te.clone().setAlpha(.2).toRgbString(),K[`${ve}-color-deprecated-bg`]=ye[0],K[`${ve}-color-deprecated-border`]=ye[2]};if(k.primaryColor){Z(k.primaryColor,"primary");const H=new h.TinyColor(k.primaryColor),ve=(0,N.generate)(H.toRgbString());ve.forEach((ye,Ve)=>{K[`primary-${Ve+1}`]=ye}),K["primary-color-deprecated-l-35"]=U(H,ye=>ye.lighten(35)),K["primary-color-deprecated-l-20"]=U(H,ye=>ye.lighten(20)),K["primary-color-deprecated-t-20"]=U(H,ye=>ye.tint(20)),K["primary-color-deprecated-t-50"]=U(H,ye=>ye.tint(50)),K["primary-color-deprecated-f-12"]=U(H,ye=>ye.setAlpha(ye.getAlpha()*.12));const Te=new h.TinyColor(ve[0]);K["primary-color-active-deprecated-f-30"]=U(Te,ye=>ye.setAlpha(ye.getAlpha()*.3)),K["primary-color-active-deprecated-d-02"]=U(Te,ye=>ye.darken(2))}return k.successColor&&Z(k.successColor,"success"),k.warningColor&&Z(k.warningColor,"warning"),k.errorColor&&Z(k.errorColor,"error"),k.infoColor&&Z(k.infoColor,"info"),`
  :root {
    ${Object.keys(K).map(H=>`--${Q}-${H}: ${K[H]};`).join(`
`)}
  }
  `.trim()}function V(Q,k){const K=Y(Q,k);(0,O.default)()&&(0,C.updateCSS)(K,`${F}-dynamic-theme`)}},14893:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var D=_(3184);const N=O=>{const[,,,,C]=(0,D.useToken)();return C?`${O}-css-var`:""};var h=E.default=N},5819:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=_(67294),h=D(_(93319)),O=D(_(3236));function C(){const F=(0,N.useContext)(h.default),Y=(0,N.useContext)(O.default);return{componentDisabled:F,componentSize:Y}}var P=E.default=C},65693:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(67294)),h=D(_(3236));const O=P=>{const F=N.default.useContext(h.default);return N.default.useMemo(()=>P?typeof P=="string"?P!=null?P:F:P instanceof Function?P(F):F:F,[P,F])};var C=E.default=O},25494:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=F;var N=D(_(67265)),h=D(_(11102)),O=_(3184),C=D(_(78459)),P=_(13594);function F(Y,V,Q){var k,K;const U=(0,P.devUseWarning)("ConfigProvider"),Z=Y||{},J=Z.inherit===!1||!V?Object.assign(Object.assign({},O.defaultConfig),{hashed:(k=V==null?void 0:V.hashed)!==null&&k!==void 0?k:O.defaultConfig.hashed,cssVar:V==null?void 0:V.cssVar}):V,H=(0,C.default)();return(0,N.default)(()=>{var ve,Te;if(!Y)return V;const ye=Object.assign({},J.components);Object.keys(Y.components||{}).forEach(Ae=>{ye[Ae]=Object.assign(Object.assign({},ye[Ae]),Y.components[Ae])});const Ve=`css-var-${H.replace(/:/g,"")}`,Re=((ve=Z.cssVar)!==null&&ve!==void 0?ve:J.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:Q==null?void 0:Q.prefixCls},typeof J.cssVar=="object"?J.cssVar:{}),typeof Z.cssVar=="object"?Z.cssVar:{}),{key:typeof Z.cssVar=="object"&&((Te=Z.cssVar)===null||Te===void 0?void 0:Te.key)||Ve});return Object.assign(Object.assign(Object.assign({},J),Z),{token:Object.assign(Object.assign({},J.token),Z.token),components:ye,cssVar:Re})},[Z,J],(ve,Te)=>ve.some((ye,Ve)=>{const Re=Te[Ve];return!(0,h.default)(ye,Re,!0)}))}},78459:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(67294));const h=Object.assign({},N),{useId:O}=h,P=typeof O=="undefined"?()=>"":O;var F=E.default=P},31929:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"ConfigConsumer",{enumerable:!0,get:function(){return J.ConfigConsumer}}),Object.defineProperty(E,"ConfigContext",{enumerable:!0,get:function(){return J.ConfigContext}}),E.default=E.configConsumerProps=void 0,Object.defineProperty(E,"defaultIconPrefixCls",{enumerable:!0,get:function(){return J.defaultIconPrefixCls}}),E.warnContext=E.globalConfig=E.defaultPrefixCls=void 0;var h=N(_(67294)),O=_(6731),C=D(_(13357)),P=D(_(67265)),F=_(20059),Y=N(_(13594)),V=D(_(2197)),Q=N(_(24522)),k=D(_(44805)),K=D(_(18253)),U=_(89329),Z=D(_(98411)),J=_(7177),H=_(56301),ve=_(93319),Te=D(_(5819)),ye=D(_(25494)),Ve=D(_(16722)),Re=D(_(11380)),Ae=N(_(3236)),ae=D(_(82932)),ee=function(Wr,vr){var dn={};for(var tn in Wr)Object.prototype.hasOwnProperty.call(Wr,tn)&&vr.indexOf(tn)<0&&(dn[tn]=Wr[tn]);if(Wr!=null&&typeof Object.getOwnPropertySymbols=="function")for(var un=0,tn=Object.getOwnPropertySymbols(Wr);un<tn.length;un++)vr.indexOf(tn[un])<0&&Object.prototype.propertyIsEnumerable.call(Wr,tn[un])&&(dn[tn[un]]=Wr[tn[un]]);return dn};let me=!1;const ge=E.warnContext=null,fe=E.configConsumerProps=["getTargetContainer","getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale"],Et=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"],xe=E.defaultPrefixCls="ant";let je,ue,Pe,we;function nt(){return je||xe}function at(){return ue||J.defaultIconPrefixCls}function vt(Wr){return Object.keys(Wr).some(vr=>vr.endsWith("Color"))}const Tt=Wr=>{const{prefixCls:vr,iconPrefixCls:dn,theme:tn,holderRender:un}=Wr;vr!==void 0&&(je=vr),dn!==void 0&&(ue=dn),"holderRender"in Wr&&(we=un),tn&&(vt(tn)?(0,H.registerTheme)(nt(),tn):Pe=tn)},ze=()=>({getPrefixCls:(Wr,vr)=>vr||(Wr?`${nt()}-${Wr}`:nt()),getIconPrefixCls:at,getRootPrefixCls:()=>je||nt(),getTheme:()=>Pe,holderRender:we});E.globalConfig=ze;const gr=Wr=>{const{children:vr,csp:dn,autoInsertSpaceInButton:tn,alert:un,anchor:yn,form:Vt,locale:dr,componentSize:wt,direction:He,space:wr,virtual:Ne,dropdownMatchSelectWidth:Xr,popupMatchSelectWidth:Er,popupOverflow:Ue,legacyLocale:In,parentContext:an,iconPrefixCls:Qr,theme:Dn,componentDisabled:On,segmented:ri,statistic:zt,spin:cr,calendar:Zr,carousel:Kr,cascader:en,collapse:Wn,typography:De,checkbox:X,descriptions:se,divider:Be,drawer:Ye,skeleton:ct,steps:sr,image:ar,layout:or,list:Wt,mentions:oe,modal:ie,progress:be,result:ke,slider:qe,breadcrumb:mt,menu:kt,pagination:$e,input:Ge,textArea:We,empty:G,badge:rt,radio:ft,rate:bt,switch:Gt,transfer:lr,avatar:Ht,message:Cr,tag:hr,table:Dr,card:Rn,tabs:on,timeline:fi,timePicker:Mi,upload:di,notification:mn,tree:Zn,colorPicker:sa,datePicker:qi,rangePicker:Sa,flex:Zi,wave:Oi,dropdown:jr,warning:Fi,tour:Ls}=Wr,Ta=h.useCallback((Ca,io)=>{const{prefixCls:Do}=Wr;if(io)return io;const $=Do||an.getPrefixCls("");return Ca?`${$}-${Ca}`:$},[an.getPrefixCls,Wr.prefixCls]),Aa=Qr||an.iconPrefixCls||J.defaultIconPrefixCls,go=dn||an.csp;(0,ae.default)(Aa,go);const os=(0,ye.default)(Dn,an.theme,{prefixCls:Ta("")}),ka={csp:go,autoInsertSpaceInButton:tn,alert:un,anchor:yn,locale:dr||In,direction:He,space:wr,virtual:Ne,popupMatchSelectWidth:Er!=null?Er:Xr,popupOverflow:Ue,getPrefixCls:Ta,iconPrefixCls:Aa,theme:os,segmented:ri,statistic:zt,spin:cr,calendar:Zr,carousel:Kr,cascader:en,collapse:Wn,typography:De,checkbox:X,descriptions:se,divider:Be,drawer:Ye,skeleton:ct,steps:sr,image:ar,input:Ge,textArea:We,layout:or,list:Wt,mentions:oe,modal:ie,progress:be,result:ke,slider:qe,breadcrumb:mt,menu:kt,pagination:$e,empty:G,badge:rt,radio:ft,rate:bt,switch:Gt,transfer:lr,avatar:Ht,message:Cr,tag:hr,table:Dr,card:Rn,tabs:on,timeline:fi,timePicker:Mi,upload:di,notification:mn,tree:Zn,colorPicker:sa,datePicker:qi,rangePicker:Sa,flex:Zi,wave:Oi,dropdown:jr,warning:Fi,tour:Ls},Ao=Object.assign({},an);Object.keys(ka).forEach(Ca=>{ka[Ca]!==void 0&&(Ao[Ca]=ka[Ca])}),Et.forEach(Ca=>{const io=Wr[Ca];io&&(Ao[Ca]=io)});const za=(0,P.default)(()=>Ao,Ao,(Ca,io)=>{const Do=Object.keys(Ca),$=Object.keys(io);return Do.length!==$.length||Do.some(ho=>Ca[ho]!==io[ho])}),Ja=h.useMemo(()=>({prefixCls:Aa,csp:go}),[Aa,go]);let Oa=h.createElement(h.Fragment,null,h.createElement(Re.default,{dropdownMatchSelectWidth:Xr}),vr);const Za=h.useMemo(()=>{var Ca,io,Do,$;return(0,F.merge)(((Ca=K.default.Form)===null||Ca===void 0?void 0:Ca.defaultValidateMessages)||{},((Do=(io=za.locale)===null||io===void 0?void 0:io.Form)===null||Do===void 0?void 0:Do.defaultValidateMessages)||{},(($=za.form)===null||$===void 0?void 0:$.validateMessages)||{},(Vt==null?void 0:Vt.validateMessages)||{})},[za,Vt==null?void 0:Vt.validateMessages]);Object.keys(Za).length>0&&(Oa=h.createElement(V.default.Provider,{value:Za},Oa)),dr&&(Oa=h.createElement(Q.default,{locale:dr,_ANT_MARK__:Q.ANT_MARK},Oa)),(Aa||go)&&(Oa=h.createElement(C.default.Provider,{value:Ja},Oa)),wt&&(Oa=h.createElement(Ae.SizeContextProvider,{size:wt},Oa)),Oa=h.createElement(Ve.default,null,Oa);const qo=h.useMemo(()=>{const Ca=os||{},{algorithm:io,token:Do,components:$,cssVar:ho}=Ca,ja=ee(Ca,["algorithm","token","components","cssVar"]),gs=io&&(!Array.isArray(io)||io.length>0)?(0,O.createTheme)(io):U.defaultTheme,Vo={};Object.entries($||{}).forEach(yt=>{let[Qt,Ur]=yt;const Tn=Object.assign({},Ur);"algorithm"in Tn&&(Tn.algorithm===!0?Tn.theme=gs:(Array.isArray(Tn.algorithm)||typeof Tn.algorithm=="function")&&(Tn.theme=(0,O.createTheme)(Tn.algorithm)),delete Tn.algorithm),Vo[Qt]=Tn});const Je=Object.assign(Object.assign({},Z.default),Do);return Object.assign(Object.assign({},ja),{theme:gs,token:Je,components:Vo,override:Object.assign({override:Je},Vo),cssVar:ho})},[os]);return Dn&&(Oa=h.createElement(U.DesignTokenContext.Provider,{value:qo},Oa)),za.warning&&(Oa=h.createElement(Y.WarningContext.Provider,{value:za.warning},Oa)),On!==void 0&&(Oa=h.createElement(ve.DisabledContextProvider,{disabled:On},Oa)),h.createElement(J.ConfigContext.Provider,{value:za},Oa)},At=Wr=>{const vr=h.useContext(J.ConfigContext),dn=h.useContext(k.default);return h.createElement(gr,Object.assign({parentContext:vr,legacyLocale:dn},Wr))};At.ConfigContext=J.ConfigContext,At.SizeContext=Ae.default,At.config=Tt,At.useConfig=Te.default,Object.defineProperty(At,"SizeContext",{get:()=>Ae.default});var hn=E.default=At},82932:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return D.useResetIconStyle}});var D=_(3184)},25633:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(27590)),h=D(_(52040));const O={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},N.default),timePickerLocale:Object.assign({},h.default)};var C=E.default=O},51130:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.VariantContext=E.NoStyleItemContext=E.NoFormStyle=E.FormProvider=E.FormItemPrefixContext=E.FormItemInputContext=E.FormContext=void 0;var h=N(_(67294)),O=h,C=_(43589),P=D(_(18475));const F=E.FormContext=O.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),Y=E.NoStyleItemContext=O.createContext(null),V=Z=>{const J=(0,P.default)(Z,["prefixCls"]);return O.createElement(C.FormProvider,Object.assign({},J))};E.FormProvider=V;const Q=E.FormItemPrefixContext=O.createContext({prefixCls:""}),k=E.FormItemInputContext=O.createContext({}),K=Z=>{let{children:J,status:H,override:ve}=Z;const Te=(0,h.useContext)(k),ye=(0,h.useMemo)(()=>{const Ve=Object.assign({},Te);return ve&&delete Ve.isFormItemInput,H&&(delete Ve.status,delete Ve.hasFeedback,delete Ve.feedbackIcon),Ve},[H,ve,Te]);return O.createElement(k.Provider,{value:ye},J)};E.NoFormStyle=K;const U=E.VariantContext=(0,h.createContext)(void 0)},96424:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=E.Variants=void 0;var D=_(67294),N=_(51130);const h=E.Variants=["outlined","borderless","filled"],O=function(P){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const Y=(0,D.useContext)(N.VariantContext);let V;typeof P!="undefined"?V=P:F===!1?V="borderless":V=Y!=null?Y:"outlined";const Q=h.includes(V);return[V,Q]};var C=E.default=O},2197:function(Ze,E,_){"use strict";"use client";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var D=_(67294),N=E.default=(0,D.createContext)(void 0)},10815:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0,E.triggerFocus=Re;var h=N(_(67294)),O=D(_(93967)),C=D(_(67656)),P=_(75531),F=D(_(49314)),Y=_(71434),V=_(13594),Q=_(31929),k=D(_(93319)),K=D(_(14893)),U=D(_(65693)),Z=_(51130),J=D(_(96424)),H=_(46549),ve=D(_(81722)),Te=D(_(89858)),ye=_(36714),Ve=function(ee,me){var ge={};for(var fe in ee)Object.prototype.hasOwnProperty.call(ee,fe)&&me.indexOf(fe)<0&&(ge[fe]=ee[fe]);if(ee!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Et=0,fe=Object.getOwnPropertySymbols(ee);Et<fe.length;Et++)me.indexOf(fe[Et])<0&&Object.prototype.propertyIsEnumerable.call(ee,fe[Et])&&(ge[fe[Et]]=ee[fe[Et]]);return ge};function Re(ee,me){if(!ee)return;ee.focus(me);const{cursor:ge}=me||{};if(ge){const fe=ee.value.length;switch(ge){case"start":ee.setSelectionRange(0,0);break;case"end":ee.setSelectionRange(fe,fe);break;default:ee.setSelectionRange(0,fe);break}}}const Ae=(0,h.forwardRef)((ee,me)=>{var ge;const{prefixCls:fe,bordered:Et=!0,status:xe,size:je,disabled:ue,onBlur:Pe,onFocus:we,suffix:nt,allowClear:at,addonAfter:vt,addonBefore:Tt,className:ze,style:gr,styles:At,rootClassName:hn,onChange:Wr,classNames:vr,variant:dn}=ee,tn=Ve(ee,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:un,direction:yn,input:Vt}=h.default.useContext(Q.ConfigContext),dr=un("input",fe),wt=(0,h.useRef)(null),He=(0,K.default)(dr),[wr,Ne,Xr]=(0,Te.default)(dr,He),{compactSize:Er,compactItemClassnames:Ue}=(0,H.useCompactItemContext)(dr,yn),In=(0,U.default)(ct=>{var sr;return(sr=je!=null?je:Er)!==null&&sr!==void 0?sr:ct}),an=h.default.useContext(k.default),Qr=ue!=null?ue:an,{status:Dn,hasFeedback:On,feedbackIcon:ri}=(0,h.useContext)(Z.FormItemInputContext),zt=(0,Y.getMergedStatus)(Dn,xe),cr=(0,ye.hasPrefixSuffix)(ee)||!!On,Zr=(0,h.useRef)(cr),Kr=(0,ve.default)(wt,!0),en=ct=>{Kr(),Pe==null||Pe(ct)},Wn=ct=>{Kr(),we==null||we(ct)},De=ct=>{Kr(),Wr==null||Wr(ct)},X=(On||nt)&&h.default.createElement(h.default.Fragment,null,nt,On&&ri),se=(0,F.default)(at!=null?at:Vt==null?void 0:Vt.allowClear),[Be,Ye]=(0,J.default)(dn,Et);return wr(h.default.createElement(C.default,Object.assign({ref:(0,P.composeRef)(me,wt),prefixCls:dr,autoComplete:Vt==null?void 0:Vt.autoComplete},tn,{disabled:Qr,onBlur:en,onFocus:Wn,style:Object.assign(Object.assign({},Vt==null?void 0:Vt.style),gr),styles:Object.assign(Object.assign({},Vt==null?void 0:Vt.styles),At),suffix:X,allowClear:se,className:(0,O.default)(ze,hn,Xr,He,Ue,Vt==null?void 0:Vt.className),onChange:De,addonAfter:vt&&h.default.createElement(H.NoCompactStyle,null,h.default.createElement(Z.NoFormStyle,{override:!0,status:!0},vt)),addonBefore:Tt&&h.default.createElement(H.NoCompactStyle,null,h.default.createElement(Z.NoFormStyle,{override:!0,status:!0},Tt)),classNames:Object.assign(Object.assign(Object.assign({},vr),Vt==null?void 0:Vt.classNames),{input:(0,O.default)({[`${dr}-sm`]:In==="small",[`${dr}-lg`]:In==="large",[`${dr}-rtl`]:yn==="rtl"},vr==null?void 0:vr.input,(ge=Vt==null?void 0:Vt.classNames)===null||ge===void 0?void 0:ge.input,Ne),variant:(0,O.default)({[`${dr}-${Be}`]:Ye},(0,Y.getStatusClassNames)(dr,zt)),affixWrapper:(0,O.default)({[`${dr}-affix-wrapper-sm`]:In==="small",[`${dr}-affix-wrapper-lg`]:In==="large",[`${dr}-affix-wrapper-rtl`]:yn==="rtl"},Ne),wrapper:(0,O.default)({[`${dr}-group-rtl`]:yn==="rtl"},Ne),groupWrapper:(0,O.default)({[`${dr}-group-wrapper-sm`]:In==="small",[`${dr}-group-wrapper-lg`]:In==="large",[`${dr}-group-wrapper-rtl`]:yn==="rtl",[`${dr}-group-wrapper-${Be}`]:Ye},(0,Y.getStatusClassNames)(`${dr}-group-wrapper`,zt,On),Ne)})})))});var ae=E.default=Ae},14104:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(67294)),O=h,C=D(_(93967)),P=D(_(43961)),F=D(_(49314)),Y=_(71434),V=_(13594),Q=_(31929),k=D(_(93319)),K=D(_(14893)),U=D(_(65693)),Z=_(51130),J=D(_(96424)),H=_(10815),ve=D(_(89858)),Te=function(Re,Ae){var ae={};for(var ee in Re)Object.prototype.hasOwnProperty.call(Re,ee)&&Ae.indexOf(ee)<0&&(ae[ee]=Re[ee]);if(Re!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,ee=Object.getOwnPropertySymbols(Re);me<ee.length;me++)Ae.indexOf(ee[me])<0&&Object.prototype.propertyIsEnumerable.call(Re,ee[me])&&(ae[ee[me]]=Re[ee[me]]);return ae};const ye=(0,h.forwardRef)((Re,Ae)=>{var ae,ee;const{prefixCls:me,bordered:ge=!0,size:fe,disabled:Et,status:xe,allowClear:je,classNames:ue,rootClassName:Pe,className:we,style:nt,styles:at,variant:vt}=Re,Tt=Te(Re,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant"]),{getPrefixCls:ze,direction:gr,textArea:At}=O.useContext(Q.ConfigContext),hn=(0,U.default)(fe),Wr=O.useContext(k.default),vr=Et!=null?Et:Wr,{status:dn,hasFeedback:tn,feedbackIcon:un}=O.useContext(Z.FormItemInputContext),yn=(0,Y.getMergedStatus)(dn,xe),Vt=O.useRef(null);O.useImperativeHandle(Ae,()=>{var In;return{resizableTextArea:(In=Vt.current)===null||In===void 0?void 0:In.resizableTextArea,focus:an=>{var Qr,Dn;(0,H.triggerFocus)((Dn=(Qr=Vt.current)===null||Qr===void 0?void 0:Qr.resizableTextArea)===null||Dn===void 0?void 0:Dn.textArea,an)},blur:()=>{var an;return(an=Vt.current)===null||an===void 0?void 0:an.blur()}}});const dr=ze("input",me),wt=(0,K.default)(dr),[He,wr,Ne]=(0,ve.default)(dr,wt),[Xr,Er]=(0,J.default)(vt,ge),Ue=(0,F.default)(je!=null?je:At==null?void 0:At.allowClear);return He(O.createElement(P.default,Object.assign({autoComplete:At==null?void 0:At.autoComplete},Tt,{style:Object.assign(Object.assign({},At==null?void 0:At.style),nt),styles:Object.assign(Object.assign({},At==null?void 0:At.styles),at),disabled:vr,allowClear:Ue,className:(0,C.default)(Ne,wt,we,Pe,At==null?void 0:At.className),classNames:Object.assign(Object.assign(Object.assign({},ue),At==null?void 0:At.classNames),{textarea:(0,C.default)({[`${dr}-sm`]:hn==="small",[`${dr}-lg`]:hn==="large"},wr,ue==null?void 0:ue.textarea,(ae=At==null?void 0:At.classNames)===null||ae===void 0?void 0:ae.textarea),variant:(0,C.default)({[`${dr}-${Xr}`]:Er},(0,Y.getStatusClassNames)(dr,yn)),affixWrapper:(0,C.default)(`${dr}-textarea-affix-wrapper`,{[`${dr}-affix-wrapper-rtl`]:gr==="rtl",[`${dr}-affix-wrapper-sm`]:hn==="small",[`${dr}-affix-wrapper-lg`]:hn==="large",[`${dr}-textarea-show-count`]:Re.showCount||((ee=Re.count)===null||ee===void 0?void 0:ee.show)},wr)}),prefixCls:dr,suffix:tn&&O.createElement("span",{className:`${dr}-textarea-suffix`},un),ref:Vt})))});var Ve=E.default=ye},81722:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=N;var D=_(67294);function N(h,O){const C=(0,D.useRef)([]),P=()=>{C.current.push(setTimeout(()=>{var F,Y,V,Q;!((F=h.current)===null||F===void 0)&&F.input&&((Y=h.current)===null||Y===void 0?void 0:Y.input.getAttribute("type"))==="password"&&(!((V=h.current)===null||V===void 0)&&V.input.hasAttribute("value"))&&((Q=h.current)===null||Q===void 0||Q.input.removeAttribute("value"))}))};return(0,D.useEffect)(()=>(O&&P(),()=>C.current.forEach(F=>{F&&clearTimeout(F)})),[]),P}},89858:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.genPlaceholderStyle=E.genInputSmallStyle=E.genInputGroupStyle=E.genBasicInputStyle=E.genActiveStyle=E.default=void 0,Object.defineProperty(E,"initComponentToken",{enumerable:!0,get:function(){return C.initComponentToken}}),Object.defineProperty(E,"initInputToken",{enumerable:!0,get:function(){return C.initInputToken}});var D=_(6731),N=_(98078),h=_(78793),O=_(3184),C=_(25735),P=_(58594);const F=Re=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:Re,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}});E.genPlaceholderStyle=F;const Y=Re=>({borderColor:Re.activeBorderColor,boxShadow:Re.activeShadow,outline:0,backgroundColor:Re.activeBg});E.genActiveStyle=Y;const V=Re=>{const{paddingBlockLG:Ae,lineHeightLG:ae,borderRadiusLG:ee,paddingInlineLG:me}=Re;return{padding:`${(0,D.unit)(Ae)} ${(0,D.unit)(me)}`,fontSize:Re.inputFontSizeLG,lineHeight:ae,borderRadius:ee}},Q=Re=>({padding:`${(0,D.unit)(Re.paddingBlockSM)} ${(0,D.unit)(Re.paddingInlineSM)}`,fontSize:Re.inputFontSizeSM,borderRadius:Re.borderRadiusSM});E.genInputSmallStyle=Q;const k=Re=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${(0,D.unit)(Re.paddingBlock)} ${(0,D.unit)(Re.paddingInline)}`,color:Re.colorText,fontSize:Re.inputFontSize,lineHeight:Re.lineHeight,borderRadius:Re.borderRadius,transition:`all ${Re.motionDurationMid}`},F(Re.colorTextPlaceholder)),{"textarea&":{maxWidth:"100%",height:"auto",minHeight:Re.controlHeight,lineHeight:Re.lineHeight,verticalAlign:"bottom",transition:`all ${Re.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},V(Re)),"&-sm":Object.assign({},Q(Re)),"&-rtl":{direction:"rtl"},"&-textarea-rtl":{direction:"rtl"}});E.genBasicInputStyle=k;const K=Re=>{const{componentCls:Ae,antCls:ae}=Re;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,["&[class*='col-']"]:{paddingInlineEnd:Re.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${Ae}, &-lg > ${Ae}-group-addon`]:Object.assign({},V(Re)),[`&-sm ${Ae}, &-sm > ${Ae}-group-addon`]:Object.assign({},Q(Re)),[`&-lg ${ae}-select-single ${ae}-select-selector`]:{height:Re.controlHeightLG},[`&-sm ${ae}-select-single ${ae}-select-selector`]:{height:Re.controlHeightSM},[`> ${Ae}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${Ae}-group`]:{["&-addon, &-wrap"]:{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${(0,D.unit)(Re.paddingInline)}`,color:Re.colorText,fontWeight:"normal",fontSize:Re.inputFontSize,textAlign:"center",borderRadius:Re.borderRadius,transition:`all ${Re.motionDurationSlow}`,lineHeight:1,[`${ae}-select`]:{margin:`${(0,D.unit)(Re.calc(Re.paddingBlock).add(1).mul(-1).equal())} ${(0,D.unit)(Re.calc(Re.paddingInline).mul(-1).equal())}`,[`&${ae}-select-single:not(${ae}-select-customize-input):not(${ae}-pagination-size-changer)`]:{[`${ae}-select-selector`]:{backgroundColor:"inherit",border:`${(0,D.unit)(Re.lineWidth)} ${Re.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${ae}-select-selector`]:{color:Re.colorPrimary}}},[`${ae}-cascader-picker`]:{margin:`-9px ${(0,D.unit)(Re.calc(Re.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${ae}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[`${Ae}`]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${Ae}-search-with-button &`]:{zIndex:0}}},[`> ${Ae}:first-child, ${Ae}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${ae}-select ${ae}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${Ae}-affix-wrapper`]:{[`&:not(:first-child) ${Ae}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${Ae}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${Ae}:last-child, ${Ae}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${ae}-select ${ae}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${Ae}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${Ae}-search &`]:{borderStartStartRadius:Re.borderRadius,borderEndStartRadius:Re.borderRadius}},[`&:not(:first-child), ${Ae}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${Ae}-group-compact`]:Object.assign(Object.assign({display:"block"},(0,N.clearFix)()),{[`${Ae}-group-addon, ${Ae}-group-wrap, > ${Ae}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:Re.lineWidth,"&:hover":{zIndex:1},"&:focus":{zIndex:1}}},"& > *":{display:"inline-block",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${Ae}-affix-wrapper,
        & > ${Ae}-number-affix-wrapper,
        & > ${ae}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:Re.calc(Re.lineWidth).mul(-1).equal(),borderInlineEndWidth:Re.lineWidth},[`${Ae}`]:{float:"none"},[`& > ${ae}-select > ${ae}-select-selector,
      & > ${ae}-select-auto-complete ${Ae},
      & > ${ae}-cascader-picker ${Ae},
      & > ${Ae}-group-wrapper ${Ae}`]:{borderInlineEndWidth:Re.lineWidth,borderRadius:0,"&:hover":{zIndex:1},"&:focus":{zIndex:1}},[`& > ${ae}-select-focused`]:{zIndex:1},[`& > ${ae}-select > ${ae}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${ae}-select:first-child > ${ae}-select-selector,
      & > ${ae}-select-auto-complete:first-child ${Ae},
      & > ${ae}-cascader-picker:first-child ${Ae}`]:{borderStartStartRadius:Re.borderRadius,borderEndStartRadius:Re.borderRadius},[`& > *:last-child,
      & > ${ae}-select:last-child > ${ae}-select-selector,
      & > ${ae}-cascader-picker:last-child ${Ae},
      & > ${ae}-cascader-picker-focused:last-child ${Ae}`]:{borderInlineEndWidth:Re.lineWidth,borderStartEndRadius:Re.borderRadius,borderEndEndRadius:Re.borderRadius},[`& > ${ae}-select-auto-complete ${Ae}`]:{verticalAlign:"top"},[`${Ae}-group-wrapper + ${Ae}-group-wrapper`]:{marginInlineStart:Re.calc(Re.lineWidth).mul(-1).equal(),[`${Ae}-affix-wrapper`]:{borderRadius:0}},[`${Ae}-group-wrapper:not(:last-child)`]:{[`&${Ae}-search > ${Ae}-group`]:{[`& > ${Ae}-group-addon > ${Ae}-search-button`]:{borderRadius:0},[`& > ${Ae}`]:{borderStartStartRadius:Re.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:Re.borderRadius}}}})}};E.genInputGroupStyle=K;const U=Re=>{const{componentCls:Ae,controlHeightSM:ae,lineWidth:ee,calc:me}=Re,ge=16,fe=me(ae).sub(me(ee).mul(2)).sub(ge).div(2).equal();return{[Ae]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,N.resetComponent)(Re)),k(Re)),(0,P.genOutlinedStyle)(Re)),(0,P.genFilledStyle)(Re)),(0,P.genBorderlessStyle)(Re)),{'&[type="color"]':{height:Re.controlHeight,[`&${Ae}-lg`]:{height:Re.controlHeightLG},[`&${Ae}-sm`]:{height:ae,paddingTop:fe,paddingBottom:fe}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},Z=Re=>{const{componentCls:Ae}=Re;return{[`${Ae}-clear-icon`]:{margin:0,color:Re.colorTextQuaternary,fontSize:Re.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${Re.motionDurationSlow}`,"&:hover":{color:Re.colorTextTertiary},"&:active":{color:Re.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${(0,D.unit)(Re.inputAffixPadding)}`}}}},J=Re=>{const{componentCls:Ae,inputAffixPadding:ae,colorTextDescription:ee,motionDurationSlow:me,colorIcon:ge,colorIconHover:fe,iconCls:Et}=Re;return{[`${Ae}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign({},k(Re)),{display:"inline-flex",[`&:not(${Ae}-disabled):hover`]:{zIndex:1,[`${Ae}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${Ae}`]:{padding:0,fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${Ae}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:Re.paddingXS}},"&-show-count-suffix":{color:ee},"&-show-count-has-suffix":{marginInlineEnd:Re.paddingXXS},"&-prefix":{marginInlineEnd:ae},"&-suffix":{marginInlineStart:ae}}}),Z(Re)),{[`${Et}${Ae}-password-icon`]:{color:ge,cursor:"pointer",transition:`all ${me}`,"&:hover":{color:fe}}})}},H=Re=>{const{componentCls:Ae,borderRadiusLG:ae,borderRadiusSM:ee}=Re;return{[`${Ae}-group`]:Object.assign(Object.assign(Object.assign({},(0,N.resetComponent)(Re)),K(Re)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${Ae}-group-addon`]:{borderRadius:ae,fontSize:Re.inputFontSizeLG}},"&-sm":{[`${Ae}-group-addon`]:{borderRadius:ee}}},(0,P.genOutlinedGroupStyle)(Re)),(0,P.genFilledGroupStyle)(Re)),{[`&:not(${Ae}-compact-first-item):not(${Ae}-compact-last-item)${Ae}-compact-item`]:{[`${Ae}, ${Ae}-group-addon`]:{borderRadius:0}},[`&:not(${Ae}-compact-last-item)${Ae}-compact-first-item`]:{[`${Ae}, ${Ae}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${Ae}-compact-first-item)${Ae}-compact-last-item`]:{[`${Ae}, ${Ae}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${Ae}-compact-last-item)${Ae}-compact-item`]:{[`${Ae}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}}})})}},ve=Re=>{const{componentCls:Ae,antCls:ae}=Re,ee=`${Ae}-search`;return{[ee]:{[`${Ae}`]:{"&:hover, &:focus":{borderColor:Re.colorPrimaryHover,[`+ ${Ae}-group-addon ${ee}-button:not(${ae}-btn-primary)`]:{borderInlineStartColor:Re.colorPrimaryHover}}},[`${Ae}-affix-wrapper`]:{borderRadius:0},[`${Ae}-lg`]:{lineHeight:Re.calc(Re.lineHeightLG).sub(2e-4).equal({unit:!1})},[`> ${Ae}-group`]:{[`> ${Ae}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${ee}-button`]:{marginInlineEnd:-1,paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:Re.borderRadius,borderEndEndRadius:Re.borderRadius,borderEndStartRadius:0,boxShadow:"none"},[`${ee}-button:not(${ae}-btn-primary)`]:{color:Re.colorTextDescription,"&:hover":{color:Re.colorPrimaryHover},"&:active":{color:Re.colorPrimaryActive},[`&${ae}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${ee}-button`]:{height:Re.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${ee}-button`]:{height:Re.controlHeightLG},[`&-small ${ee}-button`]:{height:Re.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${Ae}-compact-item`]:{[`&:not(${Ae}-compact-last-item)`]:{[`${Ae}-group-addon`]:{[`${Ae}-search-button`]:{marginInlineEnd:Re.calc(Re.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${Ae}-compact-first-item)`]:{[`${Ae},${Ae}-affix-wrapper`]:{borderRadius:0}},[`> ${Ae}-group-addon ${Ae}-search-button,
        > ${Ae},
        ${Ae}-affix-wrapper`]:{"&:hover,&:focus,&:active":{zIndex:2}},[`> ${Ae}-affix-wrapper-focused`]:{zIndex:2}}}}},Te=Re=>{const{componentCls:Ae,paddingLG:ae}=Re,ee=`${Ae}-textarea`;return{[ee]:{position:"relative","&-show-count":{[`> ${Ae}`]:{height:"100%"},[`${Ae}-data-count`]:{position:"absolute",bottom:Re.calc(Re.fontSize).mul(Re.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:Re.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},"&-allow-clear":{[`> ${Ae}`]:{paddingInlineEnd:ae}},[`&-affix-wrapper${ee}-has-feedback`]:{[`${Ae}`]:{paddingInlineEnd:ae}},[`&-affix-wrapper${Ae}-affix-wrapper`]:{padding:0,[`> textarea${Ae}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent","&:focus":{boxShadow:"none !important"}},[`${Ae}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${Ae}-clear-icon`]:{position:"absolute",insetInlineEnd:Re.paddingXS,insetBlockStart:Re.paddingXS},[`${ee}-suffix`]:{position:"absolute",top:0,insetInlineEnd:Re.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}}}}},ye=Re=>{const{componentCls:Ae}=Re;return{[`${Ae}-out-of-range`]:{[`&, & input, & textarea, ${Ae}-show-count-suffix, ${Ae}-data-count`]:{color:Re.colorError}}}};var Ve=E.default=(0,O.genStyleHooks)("Input",Re=>{const Ae=(0,O.mergeToken)(Re,(0,C.initInputToken)(Re));return[U(Ae),Te(Ae),J(Ae),H(Ae),ve(Ae),ye(Ae),(0,h.genCompactItemStyle)(Ae)]},C.initComponentToken)},25735:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.initComponentToken=void 0,E.initInputToken=N;var D=_(3184);function N(O){return(0,D.mergeToken)(O,{inputAffixPadding:O.paddingXXS})}const h=O=>{const{controlHeight:C,fontSize:P,lineHeight:F,lineWidth:Y,controlHeightSM:V,controlHeightLG:Q,fontSizeLG:k,lineHeightLG:K,paddingSM:U,controlPaddingHorizontalSM:Z,controlPaddingHorizontal:J,colorFillAlter:H,colorPrimaryHover:ve,colorPrimary:Te,controlOutlineWidth:ye,controlOutline:Ve,colorErrorOutline:Re,colorWarningOutline:Ae,colorBgContainer:ae}=O;return{paddingBlock:Math.max(Math.round((C-P*F)/2*10)/10-Y,0),paddingBlockSM:Math.max(Math.round((V-P*F)/2*10)/10-Y,0),paddingBlockLG:Math.ceil((Q-k*K)/2*10)/10-Y,paddingInline:U-Y,paddingInlineSM:Z-Y,paddingInlineLG:J-Y,addonBg:H,activeBorderColor:Te,hoverBorderColor:ve,activeShadow:`0 0 0 ${ye}px ${Ve}`,errorActiveShadow:`0 0 0 ${ye}px ${Re}`,warningActiveShadow:`0 0 0 ${ye}px ${Ae}`,hoverBg:ae,activeBg:ae,inputFontSize:P,inputFontSizeLG:k,inputFontSizeSM:P}};E.initComponentToken=h},58594:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.genOutlinedStyle=E.genOutlinedGroupStyle=E.genHoverStyle=E.genFilledStyle=E.genFilledGroupStyle=E.genDisabledStyle=E.genBorderlessStyle=E.genBaseOutlinedStyle=void 0;var D=_(6731),N=_(3184);const h=H=>({borderColor:H.hoverBorderColor,backgroundColor:H.hoverBg});E.genHoverStyle=h;const O=H=>({color:H.colorTextDisabled,backgroundColor:H.colorBgContainerDisabled,borderColor:H.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},h((0,N.mergeToken)(H,{hoverBorderColor:H.colorBorder,hoverBg:H.colorBgContainerDisabled})))});E.genDisabledStyle=O;const C=(H,ve)=>({background:H.colorBgContainer,borderWidth:H.lineWidth,borderStyle:H.lineType,borderColor:ve.borderColor,"&:hover":{borderColor:ve.hoverBorderColor,backgroundColor:H.hoverBg},"&:focus, &:focus-within":{borderColor:ve.activeBorderColor,boxShadow:ve.activeShadow,outline:0,backgroundColor:H.activeBg}});E.genBaseOutlinedStyle=C;const P=(H,ve)=>({[`&${H.componentCls}-status-${ve.status}:not(${H.componentCls}-disabled)`]:Object.assign(Object.assign({},C(H,ve)),{[`${H.componentCls}-prefix, ${H.componentCls}-suffix`]:{color:ve.affixColor}})}),F=(H,ve)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},C(H,{borderColor:H.colorBorder,hoverBorderColor:H.hoverBorderColor,activeBorderColor:H.activeBorderColor,activeShadow:H.activeShadow})),{[`&${H.componentCls}-disabled, &[disabled]`]:Object.assign({},O(H))}),P(H,{status:"error",borderColor:H.colorError,hoverBorderColor:H.colorErrorBorderHover,activeBorderColor:H.colorError,activeShadow:H.errorActiveShadow,affixColor:H.colorError})),P(H,{status:"warning",borderColor:H.colorWarning,hoverBorderColor:H.colorWarningBorderHover,activeBorderColor:H.colorWarning,activeShadow:H.warningActiveShadow,affixColor:H.colorWarning})),ve)});E.genOutlinedStyle=F;const Y=(H,ve)=>({[`&${H.componentCls}-group-wrapper-status-${ve.status}`]:{[`${H.componentCls}-group-addon`]:{borderColor:ve.addonBorderColor,color:ve.addonColor}}}),V=H=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${H.componentCls}-group`]:{"&-addon":{background:H.addonBg,border:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},Y(H,{status:"error",addonBorderColor:H.colorError,addonColor:H.colorErrorText})),Y(H,{status:"warning",addonBorderColor:H.colorWarning,addonColor:H.colorWarningText})),{[`&${H.componentCls}-group-wrapper-disabled`]:{[`${H.componentCls}-group-addon`]:Object.assign({},O(H))}})});E.genOutlinedGroupStyle=V;const Q=(H,ve)=>({"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${H.componentCls}-disabled, &[disabled]`]:{color:H.colorTextDisabled}},ve)});E.genBorderlessStyle=Q;const k=(H,ve)=>({background:ve.bg,borderWidth:H.lineWidth,borderStyle:H.lineType,borderColor:"transparent",["input&, & input, textarea&, & textarea"]:{color:ve==null?void 0:ve.inputColor},"&:hover":{background:ve.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:ve.activeBorderColor,backgroundColor:H.activeBg}}),K=(H,ve)=>({[`&${H.componentCls}-status-${ve.status}:not(${H.componentCls}-disabled)`]:Object.assign(Object.assign({},k(H,ve)),{[`${H.componentCls}-prefix, ${H.componentCls}-suffix`]:{color:ve.affixColor}})}),U=(H,ve)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},k(H,{bg:H.colorFillTertiary,hoverBg:H.colorFillSecondary,activeBorderColor:H.colorPrimary})),{[`&${H.componentCls}-disabled, &[disabled]`]:Object.assign({},O(H))}),K(H,{status:"error",bg:H.colorErrorBg,hoverBg:H.colorErrorBgHover,activeBorderColor:H.colorError,inputColor:H.colorErrorText,affixColor:H.colorError})),K(H,{status:"warning",bg:H.colorWarningBg,hoverBg:H.colorWarningBgHover,activeBorderColor:H.colorWarning,inputColor:H.colorWarningText,affixColor:H.colorWarning})),ve)});E.genFilledStyle=U;const Z=(H,ve)=>({[`&${H.componentCls}-group-wrapper-status-${ve.status}`]:{[`${H.componentCls}-group-addon`]:{background:ve.addonBg,color:ve.addonColor}}}),J=H=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${H.componentCls}-group`]:{"&-addon":{background:H.colorFillTertiary},[`${H.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorSplit}`}}}},Z(H,{status:"error",addonBg:H.colorErrorBg,addonColor:H.colorErrorText})),Z(H,{status:"warning",addonBg:H.colorWarningBg,addonColor:H.colorWarningText})),{[`&${H.componentCls}-group-wrapper-disabled`]:{[`${H.componentCls}-group`]:{"&-addon":{background:H.colorFillTertiary,color:H.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`,borderTop:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`,borderBottom:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`,borderTop:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`,borderBottom:`${(0,D.unit)(H.lineWidth)} ${H.lineType} ${H.colorBorder}`}}}})});E.genFilledGroupStyle=J},36714:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.hasPrefixSuffix=_;function _(D){return!!(D.prefix||D.suffix||D.allowClear||D.showCount)}},44805:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var D=_(67294);const N=(0,D.createContext)(void 0);var h=E.default=N},18253:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(62273)),h=D(_(1028)),O=D(_(25633)),C=D(_(52040));const P="${label} is not a valid ${type}",F={locale:"en",Pagination:N.default,DatePicker:O.default,TimePicker:C.default,Calendar:h.default,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:P,method:P,array:P,object:P,number:P,date:P,boolean:P,integer:P,float:P,regexp:P,email:P,url:P,hex:P},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty"}};var Y=E.default=F},24522:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=E.ANT_MARK=void 0,Object.defineProperty(E,"useLocale",{enumerable:!0,get:function(){return F.default}});var h=N(_(67294)),O=_(13594),C=_(10625),P=D(_(44805)),F=D(_(76647));const Y=E.ANT_MARK="internalMark",V=k=>{const{locale:K={},children:U,_ANT_MARK__:Z}=k;h.useEffect(()=>(0,C.changeConfirmLocale)(K&&K.Modal),[K]);const J=h.useMemo(()=>Object.assign(Object.assign({},K),{exist:!0}),[K]);return h.createElement(P.default.Provider,{value:J},U)};var Q=E.default=V},76647:function(Ze,E,_){"use strict";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(67294)),O=D(_(44805)),C=D(_(18253));const P=(Y,V)=>{const Q=h.useContext(O.default),k=h.useMemo(()=>{var U;const Z=V||C.default[Y],J=(U=Q==null?void 0:Q[Y])!==null&&U!==void 0?U:{};return Object.assign(Object.assign({},typeof Z=="function"?Z():Z),J||{})},[Y,V,Q]),K=h.useMemo(()=>{const U=Q==null?void 0:Q.locale;return Q!=null&&Q.exist&&!U?C.default.locale:U},[Q]);return[k,K]};var F=E.default=P},10625:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.changeConfirmLocale=P,E.getConfirmLocale=F;var N=D(_(18253));let h=Object.assign({},N.default.Modal),O=[];const C=()=>O.reduce((Y,V)=>Object.assign(Object.assign({},Y),V),N.default.Modal);function P(Y){if(Y){const V=Object.assign({},Y);return O.push(V),h=C(),()=>{O=O.filter(Q=>Q!==V),h=C()}}h=Object.assign({},N.default.Modal)}function F(){return h}},46549:function(Ze,E,_){"use strict";"use client";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.useCompactItemContext=E.default=E.SpaceCompactItemContext=E.NoCompactStyle=void 0;var h=N(_(93967)),O=N(_(45598)),C=D(_(67294)),P=_(31929),F=N(_(65693)),Y=N(_(54277)),V=function(H,ve){var Te={};for(var ye in H)Object.prototype.hasOwnProperty.call(H,ye)&&ve.indexOf(ye)<0&&(Te[ye]=H[ye]);if(H!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ve=0,ye=Object.getOwnPropertySymbols(H);Ve<ye.length;Ve++)ve.indexOf(ye[Ve])<0&&Object.prototype.propertyIsEnumerable.call(H,ye[Ve])&&(Te[ye[Ve]]=H[ye[Ve]]);return Te};const Q=E.SpaceCompactItemContext=C.createContext(null),k=(H,ve)=>{const Te=C.useContext(Q),ye=C.useMemo(()=>{if(!Te)return"";const{compactDirection:Ve,isFirstItem:Re,isLastItem:Ae}=Te,ae=Ve==="vertical"?"-vertical-":"-";return(0,h.default)(`${H}-compact${ae}item`,{[`${H}-compact${ae}first-item`]:Re,[`${H}-compact${ae}last-item`]:Ae,[`${H}-compact${ae}item-rtl`]:ve==="rtl"})},[H,ve,Te]);return{compactSize:Te==null?void 0:Te.compactSize,compactDirection:Te==null?void 0:Te.compactDirection,compactItemClassnames:ye}};E.useCompactItemContext=k;const K=H=>{let{children:ve}=H;return C.createElement(Q.Provider,{value:null},ve)};E.NoCompactStyle=K;const U=H=>{var{children:ve}=H,Te=V(H,["children"]);return C.createElement(Q.Provider,{value:Te},ve)},Z=H=>{const{getPrefixCls:ve,direction:Te}=C.useContext(P.ConfigContext),{size:ye,direction:Ve,block:Re,prefixCls:Ae,className:ae,rootClassName:ee,children:me}=H,ge=V(H,["size","direction","block","prefixCls","className","rootClassName","children"]),fe=(0,F.default)(at=>ye!=null?ye:at),Et=ve("space-compact",Ae),[xe,je]=(0,Y.default)(Et),ue=(0,h.default)(Et,je,{[`${Et}-rtl`]:Te==="rtl",[`${Et}-block`]:Re,[`${Et}-vertical`]:Ve==="vertical"},ae,ee),Pe=C.useContext(Q),we=(0,O.default)(me),nt=C.useMemo(()=>we.map((at,vt)=>{const Tt=at&&at.key||`${Et}-item-${vt}`;return C.createElement(U,{key:Tt,compactSize:fe,compactDirection:Ve,isFirstItem:vt===0&&(!Pe||(Pe==null?void 0:Pe.isFirstItem)),isLastItem:vt===we.length-1&&(!Pe||(Pe==null?void 0:Pe.isLastItem))},at)}),[ye,we,Pe]);return we.length===0?null:xe(C.createElement("div",Object.assign({className:ue},ge),nt))};var J=E.default=Z},35969:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const _=N=>{const{componentCls:h}=N;return{[h]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}};var D=E.default=_},54277:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.prepareComponentToken=E.default=void 0;var N=_(3184),h=D(_(35969));const O=Y=>{const{componentCls:V}=Y;return{[V]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${V}-item:empty`]:{display:"none"}}}},C=Y=>{const{componentCls:V}=Y;return{[V]:{"&-gap-row-small":{rowGap:Y.spaceGapSmallSize},"&-gap-row-middle":{rowGap:Y.spaceGapMiddleSize},"&-gap-row-large":{rowGap:Y.spaceGapLargeSize},"&-gap-col-small":{columnGap:Y.spaceGapSmallSize},"&-gap-col-middle":{columnGap:Y.spaceGapMiddleSize},"&-gap-col-large":{columnGap:Y.spaceGapLargeSize}}}},P=()=>({});E.prepareComponentToken=P;var F=E.default=(0,N.genStyleHooks)("Space",Y=>{const V=(0,N.mergeToken)(Y,{spaceGapSmallSize:Y.paddingXS,spaceGapMiddleSize:Y.padding,spaceGapLargeSize:Y.paddingLG});return[O(V),C(V),(0,h.default)(V)]},()=>({}),{resetStyle:!1})},78793:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.genCompactItemStyle=N;function _(h,O,C){const{focusElCls:P,focus:F,borderElCls:Y}=C,V=Y?"> *":"",Q=["hover",F?"focus":null,"active"].filter(Boolean).map(k=>`&:${k} ${V}`).join(",");return{[`&-item:not(${O}-last-item)`]:{marginInlineEnd:h.calc(h.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[Q]:{zIndex:2}},P?{[`&${P}`]:{zIndex:2}}:{}),{[`&[disabled] ${V}`]:{zIndex:0}})}}function D(h,O,C){const{borderElCls:P}=C,F=P?`> ${P}`:"";return{[`&-item:not(${O}-first-item):not(${O}-last-item) ${F}`]:{borderRadius:0},[`&-item:not(${O}-last-item)${O}-first-item`]:{[`& ${F}, &${h}-sm ${F}, &${h}-lg ${F}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${O}-first-item)${O}-last-item`]:{[`& ${F}, &${h}-sm ${F}, &${h}-lg ${F}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function N(h){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:C}=h,P=`${C}-compact`;return{[P]:Object.assign(Object.assign({},_(h,P,O)),D(C,P,O))}}},98078:function(Ze,E,_){"use strict";"use client";Object.defineProperty(E,"__esModule",{value:!0}),E.genLinkStyle=E.genFocusStyle=E.genFocusOutline=E.genCommonStyle=E.clearFix=void 0,Object.defineProperty(E,"operationUnit",{enumerable:!0,get:function(){return N.operationUnit}}),E.textEllipsis=E.resetIcon=E.resetComponent=void 0;var D=_(6731),N=_(22548);const h=E.textEllipsis={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},O=function(k){let K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:k.colorText,fontSize:k.fontSize,lineHeight:k.lineHeight,listStyle:"none",fontFamily:K?"inherit":k.fontFamily}};E.resetComponent=O;const C=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}});E.resetIcon=C;const P=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}});E.clearFix=P;const F=k=>({a:{color:k.colorLink,textDecoration:k.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${k.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:k.colorLinkHover},"&:active":{color:k.colorLinkActive},[`&:active,
  &:hover`]:{textDecoration:k.linkHoverDecoration,outline:0},"&:focus":{textDecoration:k.linkFocusDecoration,outline:0},"&[disabled]":{color:k.colorTextDisabled,cursor:"not-allowed"}}});E.genLinkStyle=F;const Y=(k,K,U)=>{const{fontFamily:Z,fontSize:J}=k,H=`[class^="${K}"], [class*=" ${K}"]`;return{[U?`.${U}`:H]:{fontFamily:Z,fontSize:J,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[H]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}};E.genCommonStyle=Y;const V=k=>({outline:`${(0,D.unit)(k.lineWidthFocus)} solid ${k.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"});E.genFocusOutline=V;const Q=k=>({"&:focus-visible":Object.assign({},V(k))});E.genFocusStyle=Q},57253:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const _=N=>({[N.componentCls]:{[`${N.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${N.motionDurationMid} ${N.motionEaseInOut},
        opacity ${N.motionDurationMid} ${N.motionEaseInOut} !important`}},[`${N.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${N.motionDurationMid} ${N.motionEaseInOut},
        opacity ${N.motionDurationMid} ${N.motionEaseInOut} !important`}}});var D=E.default=_},84460:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.initFadeMotion=E.fadeOut=E.fadeIn=void 0;var D=_(6731),N=_(94631);const h=E.fadeIn=new D.Keyframes("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),O=E.fadeOut=new D.Keyframes("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),C=function(P){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:Y}=P,V=`${Y}-fade`,Q=F?"&":"";return[(0,N.initMotion)(V,h,O,P.motionDurationMid,F),{[`
        ${Q}${V}-enter,
        ${Q}${V}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${Q}${V}-leave`]:{animationTimingFunction:"linear"}}]};E.initFadeMotion=C},42836:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"fadeIn",{enumerable:!0,get:function(){return N.fadeIn}}),Object.defineProperty(E,"fadeOut",{enumerable:!0,get:function(){return N.fadeOut}}),Object.defineProperty(E,"genCollapseMotion",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(E,"initFadeMotion",{enumerable:!0,get:function(){return N.initFadeMotion}}),Object.defineProperty(E,"initMoveMotion",{enumerable:!0,get:function(){return h.initMoveMotion}}),Object.defineProperty(E,"initSlideMotion",{enumerable:!0,get:function(){return O.initSlideMotion}}),Object.defineProperty(E,"initZoomMotion",{enumerable:!0,get:function(){return C.initZoomMotion}}),Object.defineProperty(E,"moveDownIn",{enumerable:!0,get:function(){return h.moveDownIn}}),Object.defineProperty(E,"moveDownOut",{enumerable:!0,get:function(){return h.moveDownOut}}),Object.defineProperty(E,"moveLeftIn",{enumerable:!0,get:function(){return h.moveLeftIn}}),Object.defineProperty(E,"moveLeftOut",{enumerable:!0,get:function(){return h.moveLeftOut}}),Object.defineProperty(E,"moveRightIn",{enumerable:!0,get:function(){return h.moveRightIn}}),Object.defineProperty(E,"moveRightOut",{enumerable:!0,get:function(){return h.moveRightOut}}),Object.defineProperty(E,"moveUpIn",{enumerable:!0,get:function(){return h.moveUpIn}}),Object.defineProperty(E,"moveUpOut",{enumerable:!0,get:function(){return h.moveUpOut}}),Object.defineProperty(E,"slideDownIn",{enumerable:!0,get:function(){return O.slideDownIn}}),Object.defineProperty(E,"slideDownOut",{enumerable:!0,get:function(){return O.slideDownOut}}),Object.defineProperty(E,"slideLeftIn",{enumerable:!0,get:function(){return O.slideLeftIn}}),Object.defineProperty(E,"slideLeftOut",{enumerable:!0,get:function(){return O.slideLeftOut}}),Object.defineProperty(E,"slideRightIn",{enumerable:!0,get:function(){return O.slideRightIn}}),Object.defineProperty(E,"slideRightOut",{enumerable:!0,get:function(){return O.slideRightOut}}),Object.defineProperty(E,"slideUpIn",{enumerable:!0,get:function(){return O.slideUpIn}}),Object.defineProperty(E,"slideUpOut",{enumerable:!0,get:function(){return O.slideUpOut}}),Object.defineProperty(E,"zoomBigIn",{enumerable:!0,get:function(){return C.zoomBigIn}}),Object.defineProperty(E,"zoomBigOut",{enumerable:!0,get:function(){return C.zoomBigOut}}),Object.defineProperty(E,"zoomDownIn",{enumerable:!0,get:function(){return C.zoomDownIn}}),Object.defineProperty(E,"zoomDownOut",{enumerable:!0,get:function(){return C.zoomDownOut}}),Object.defineProperty(E,"zoomIn",{enumerable:!0,get:function(){return C.zoomIn}}),Object.defineProperty(E,"zoomLeftIn",{enumerable:!0,get:function(){return C.zoomLeftIn}}),Object.defineProperty(E,"zoomLeftOut",{enumerable:!0,get:function(){return C.zoomLeftOut}}),Object.defineProperty(E,"zoomOut",{enumerable:!0,get:function(){return C.zoomOut}}),Object.defineProperty(E,"zoomRightIn",{enumerable:!0,get:function(){return C.zoomRightIn}}),Object.defineProperty(E,"zoomRightOut",{enumerable:!0,get:function(){return C.zoomRightOut}}),Object.defineProperty(E,"zoomUpIn",{enumerable:!0,get:function(){return C.zoomUpIn}}),Object.defineProperty(E,"zoomUpOut",{enumerable:!0,get:function(){return C.zoomUpOut}});var N=_(84460),h=_(17060),O=_(17581),C=_(99269),P=D(_(57253))},94631:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.initMotion=void 0;const _=h=>({animationDuration:h,animationFillMode:"both"}),D=h=>({animationDuration:h,animationFillMode:"both"}),N=function(h,O,C,P){const Y=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${Y}${h}-enter,
      ${Y}${h}-appear
    `]:Object.assign(Object.assign({},_(P)),{animationPlayState:"paused"}),[`${Y}${h}-leave`]:Object.assign(Object.assign({},D(P)),{animationPlayState:"paused"}),[`
      ${Y}${h}-enter${h}-enter-active,
      ${Y}${h}-appear${h}-appear-active
    `]:{animationName:O,animationPlayState:"running"},[`${Y}${h}-leave${h}-leave-active`]:{animationName:C,animationPlayState:"running",pointerEvents:"none"}}};E.initMotion=N},17060:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.moveUpOut=E.moveUpIn=E.moveRightOut=E.moveRightIn=E.moveLeftOut=E.moveLeftIn=E.moveDownOut=E.moveDownIn=E.initMoveMotion=void 0;var D=_(6731),N=_(94631);const h=E.moveDownIn=new D.Keyframes("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),O=E.moveDownOut=new D.Keyframes("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),C=E.moveLeftIn=new D.Keyframes("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),P=E.moveLeftOut=new D.Keyframes("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),F=E.moveRightIn=new D.Keyframes("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Y=E.moveRightOut=new D.Keyframes("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),V=E.moveUpIn=new D.Keyframes("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Q=E.moveUpOut=new D.Keyframes("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),k={"move-up":{inKeyframes:V,outKeyframes:Q},"move-down":{inKeyframes:h,outKeyframes:O},"move-left":{inKeyframes:C,outKeyframes:P},"move-right":{inKeyframes:F,outKeyframes:Y}},K=(U,Z)=>{const{antCls:J}=U,H=`${J}-${Z}`,{inKeyframes:ve,outKeyframes:Te}=k[Z];return[(0,N.initMotion)(H,ve,Te,U.motionDurationMid),{[`
        ${H}-enter,
        ${H}-appear
      `]:{opacity:0,animationTimingFunction:U.motionEaseOutCirc},[`${H}-leave`]:{animationTimingFunction:U.motionEaseInOutCirc}}]};E.initMoveMotion=K},17581:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.slideUpOut=E.slideUpIn=E.slideRightOut=E.slideRightIn=E.slideLeftOut=E.slideLeftIn=E.slideDownOut=E.slideDownIn=E.initSlideMotion=void 0;var D=_(6731),N=_(94631);const h=E.slideUpIn=new D.Keyframes("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),O=E.slideUpOut=new D.Keyframes("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),C=E.slideDownIn=new D.Keyframes("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),P=E.slideDownOut=new D.Keyframes("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),F=E.slideLeftIn=new D.Keyframes("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),Y=E.slideLeftOut=new D.Keyframes("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),V=E.slideRightIn=new D.Keyframes("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Q=E.slideRightOut=new D.Keyframes("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),k={"slide-up":{inKeyframes:h,outKeyframes:O},"slide-down":{inKeyframes:C,outKeyframes:P},"slide-left":{inKeyframes:F,outKeyframes:Y},"slide-right":{inKeyframes:V,outKeyframes:Q}},K=(U,Z)=>{const{antCls:J}=U,H=`${J}-${Z}`,{inKeyframes:ve,outKeyframes:Te}=k[Z];return[(0,N.initMotion)(H,ve,Te,U.motionDurationMid),{[`
      ${H}-enter,
      ${H}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:U.motionEaseOutQuint,["&-prepare"]:{transform:"scale(1)"}},[`${H}-leave`]:{animationTimingFunction:U.motionEaseInQuint}}]};E.initSlideMotion=K},99269:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.zoomUpOut=E.zoomUpIn=E.zoomRightOut=E.zoomRightIn=E.zoomOut=E.zoomLeftOut=E.zoomLeftIn=E.zoomIn=E.zoomDownOut=E.zoomDownIn=E.zoomBigOut=E.zoomBigIn=E.initZoomMotion=void 0;var D=_(6731),N=_(94631);const h=E.zoomIn=new D.Keyframes("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),O=E.zoomOut=new D.Keyframes("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),C=E.zoomBigIn=new D.Keyframes("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),P=E.zoomBigOut=new D.Keyframes("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),F=E.zoomUpIn=new D.Keyframes("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Y=E.zoomUpOut=new D.Keyframes("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),V=E.zoomLeftIn=new D.Keyframes("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Q=E.zoomLeftOut=new D.Keyframes("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),k=E.zoomRightIn=new D.Keyframes("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),K=E.zoomRightOut=new D.Keyframes("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),U=E.zoomDownIn=new D.Keyframes("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),Z=E.zoomDownOut=new D.Keyframes("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),J={zoom:{inKeyframes:h,outKeyframes:O},"zoom-big":{inKeyframes:C,outKeyframes:P},"zoom-big-fast":{inKeyframes:C,outKeyframes:P},"zoom-left":{inKeyframes:V,outKeyframes:Q},"zoom-right":{inKeyframes:k,outKeyframes:K},"zoom-up":{inKeyframes:F,outKeyframes:Y},"zoom-down":{inKeyframes:U,outKeyframes:Z}},H=(ve,Te)=>{const{antCls:ye}=ve,Ve=`${ye}-${Te}`,{inKeyframes:Re,outKeyframes:Ae}=J[Te];return[(0,N.initMotion)(Ve,Re,Ae,Te==="zoom-big-fast"?ve.motionDurationFast:ve.motionDurationMid),{[`
        ${Ve}-enter,
        ${Ve}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:ve.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${Ve}-leave`]:{animationTimingFunction:ve.motionEaseInOutCirc}}]};E.initZoomMotion=H},22548:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.operationUnit=void 0;const _=D=>({color:D.colorLink,textDecoration:"none",outline:"none",cursor:"pointer",transition:`color ${D.motionDurationSlow}`,"&:focus, &:hover":{color:D.colorLinkHover},"&:active":{color:D.colorLinkActive}});E.operationUnit=_},9064:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.MAX_VERTICAL_CONTENT_RADIUS=void 0,E.default=C,E.getArrowOffsetToken=h;var D=_(51337);const N=E.MAX_VERTICAL_CONTENT_RADIUS=8;function h(P){const{contentRadius:F,limitVerticalRadius:Y}=P,V=F>12?F+2:12;return{arrowOffsetHorizontal:V,arrowOffsetVertical:Y?N:V}}function O(P,F){return P?F:{}}function C(P,F,Y){const{componentCls:V,boxShadowPopoverArrow:Q,arrowOffsetVertical:k,arrowOffsetHorizontal:K}=P,{arrowDistance:U=0,arrowPlacement:Z={left:!0,right:!0,top:!0,bottom:!0}}=Y||{};return{[V]:Object.assign(Object.assign(Object.assign(Object.assign({[`${V}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},(0,D.genRoundedArrow)(P,F,Q)),{"&:before":{background:F}})]},O(!!Z.top,{[[`&-placement-top > ${V}-arrow`,`&-placement-topLeft > ${V}-arrow`,`&-placement-topRight > ${V}-arrow`].join(",")]:{bottom:U,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${V}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft > ${V}-arrow`]:{left:{_skip_check_:!0,value:K}},[`&-placement-topRight > ${V}-arrow`]:{right:{_skip_check_:!0,value:K}}})),O(!!Z.bottom,{[[`&-placement-bottom > ${V}-arrow`,`&-placement-bottomLeft > ${V}-arrow`,`&-placement-bottomRight > ${V}-arrow`].join(",")]:{top:U,transform:"translateY(-100%)"},[`&-placement-bottom > ${V}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft > ${V}-arrow`]:{left:{_skip_check_:!0,value:K}},[`&-placement-bottomRight > ${V}-arrow`]:{right:{_skip_check_:!0,value:K}}})),O(!!Z.left,{[[`&-placement-left > ${V}-arrow`,`&-placement-leftTop > ${V}-arrow`,`&-placement-leftBottom > ${V}-arrow`].join(",")]:{right:{_skip_check_:!0,value:U},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${V}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${V}-arrow`]:{top:k},[`&-placement-leftBottom > ${V}-arrow`]:{bottom:k}})),O(!!Z.right,{[[`&-placement-right > ${V}-arrow`,`&-placement-rightTop > ${V}-arrow`,`&-placement-rightBottom > ${V}-arrow`].join(",")]:{left:{_skip_check_:!0,value:U},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${V}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${V}-arrow`]:{top:k},[`&-placement-rightBottom > ${V}-arrow`]:{bottom:k}}))}}},51337:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.genRoundedArrow=void 0,E.getArrowToken=N;var D=_(6731);function N(O){const{sizePopupArrow:C,borderRadiusXS:P,borderRadiusOuter:F}=O,Y=C/2,V=0,Q=Y,k=F*1/Math.sqrt(2),K=Y-F*(1-1/Math.sqrt(2)),U=Y-P*(1/Math.sqrt(2)),Z=F*(Math.sqrt(2)-1)+P*(1/Math.sqrt(2)),J=2*Y-U,H=Z,ve=2*Y-k,Te=K,ye=2*Y-V,Ve=Q,Re=Y*Math.sqrt(2)+F*(Math.sqrt(2)-2),Ae=F*(Math.sqrt(2)-1),ae=`polygon(${Ae}px 100%, 50% ${Ae}px, ${2*Y-Ae}px 100%, ${Ae}px 100%)`,ee=`path('M ${V} ${Q} A ${F} ${F} 0 0 0 ${k} ${K} L ${U} ${Z} A ${P} ${P} 0 0 1 ${J} ${H} L ${ve} ${Te} A ${F} ${F} 0 0 0 ${ye} ${Ve} Z')`;return{arrowShadowWidth:Re,arrowPath:ee,arrowPolygon:ae}}const h=(O,C,P)=>{const{sizePopupArrow:F,arrowPolygon:Y,arrowPath:V,arrowShadowWidth:Q,borderRadiusXS:k,calc:K}=O;return{pointerEvents:"none",width:F,height:F,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:F,height:K(F).div(2).equal(),background:C,clipPath:{_multi_value_:!0,value:[Y,V]},content:'""'},"&::after":{content:'""',position:"absolute",width:Q,height:Q,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${(0,D.unit)(k)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:P,zIndex:0,background:"transparent"}}};E.genRoundedArrow=h},89329:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.defaultTheme=E.defaultConfig=E.DesignTokenContext=void 0;var N=D(_(67294)),h=_(6731),O=D(_(9924)),C=D(_(98411));const P=E.defaultTheme=(0,h.createTheme)(O.default),F=E.defaultConfig={token:C.default,override:{override:C.default},hashed:!0},Y=E.DesignTokenContext=N.default.createContext(F)},36496:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"PresetColors",{enumerable:!0,get:function(){return D.PresetColors}});var D=_(81342)},81342:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.PresetColors=void 0;const _=E.PresetColors=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"]},3184:function(Ze,E,_){"use strict";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"DesignTokenContext",{enumerable:!0,get:function(){return K.DesignTokenContext}}),Object.defineProperty(E,"PresetColors",{enumerable:!0,get:function(){return O.PresetColors}}),Object.defineProperty(E,"calc",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(E,"defaultConfig",{enumerable:!0,get:function(){return K.defaultConfig}}),Object.defineProperty(E,"genComponentStyleHook",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(E,"genPresetColor",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(E,"genStyleHooks",{enumerable:!0,get:function(){return P.genStyleHooks}}),Object.defineProperty(E,"genSubStyleComponent",{enumerable:!0,get:function(){return P.genSubStyleComponent}}),Object.defineProperty(E,"getLineHeight",{enumerable:!0,get:function(){return k.getLineHeight}}),Object.defineProperty(E,"mergeToken",{enumerable:!0,get:function(){return Y.merge}}),Object.defineProperty(E,"statisticToken",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(E,"useResetIconStyle",{enumerable:!0,get:function(){return V.default}}),Object.defineProperty(E,"useStyleRegister",{enumerable:!0,get:function(){return h.useStyleRegister}}),Object.defineProperty(E,"useToken",{enumerable:!0,get:function(){return C.default}});var h=_(6731),O=_(36496),C=N(_(41401)),P=D(_(3737)),F=N(_(36219)),Y=D(_(99636)),V=N(_(54894)),Q=N(_(22996)),k=_(62231),K=_(89329)},26162:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.getSolidColor=E.getAlphaColor=void 0;var D=_(131);const N=(O,C)=>new D.TinyColor(O).setAlpha(C).toRgbString();E.getAlphaColor=N;const h=(O,C)=>new D.TinyColor(O).darken(C).toHexString();E.getSolidColor=h},80373:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.generateNeutralColorPalettes=E.generateColorPalettes=void 0;var D=_(78589),N=_(26162);const h=C=>{const P=(0,D.generate)(C);return{1:P[0],2:P[1],3:P[2],4:P[3],5:P[4],6:P[5],7:P[6],8:P[4],9:P[5],10:P[6]}};E.generateColorPalettes=h;const O=(C,P)=>{const F=C||"#fff",Y=P||"#000";return{colorBgBase:F,colorTextBase:Y,colorText:(0,N.getAlphaColor)(Y,.88),colorTextSecondary:(0,N.getAlphaColor)(Y,.65),colorTextTertiary:(0,N.getAlphaColor)(Y,.45),colorTextQuaternary:(0,N.getAlphaColor)(Y,.25),colorFill:(0,N.getAlphaColor)(Y,.15),colorFillSecondary:(0,N.getAlphaColor)(Y,.06),colorFillTertiary:(0,N.getAlphaColor)(Y,.04),colorFillQuaternary:(0,N.getAlphaColor)(Y,.02),colorBgLayout:(0,N.getSolidColor)(F,4),colorBgContainer:(0,N.getSolidColor)(F,0),colorBgElevated:(0,N.getSolidColor)(F,0),colorBgSpotlight:(0,N.getAlphaColor)(Y,.85),colorBgBlur:"transparent",colorBorder:(0,N.getSolidColor)(F,15),colorBorderSecondary:(0,N.getSolidColor)(F,6)}};E.generateNeutralColorPalettes=O},9924:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=Q;var N=_(78589),h=D(_(54730)),O=D(_(19216)),C=_(98411),P=D(_(10805)),F=D(_(81594)),Y=_(80373),V=D(_(69853));function Q(k){const K=Object.keys(C.defaultPresetColors).map(U=>{const Z=(0,N.generate)(k[U]);return new Array(10).fill(1).reduce((J,H,ve)=>(J[`${U}-${ve+1}`]=Z[ve],J[`${U}${ve+1}`]=Z[ve],J),{})}).reduce((U,Z)=>(U=Object.assign(Object.assign({},U),Z),U),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},k),K),(0,P.default)(k,{generateColorPalettes:Y.generateColorPalettes,generateNeutralColorPalettes:Y.generateNeutralColorPalettes})),(0,V.default)(k.fontSize)),(0,O.default)(k)),(0,h.default)(k)),(0,F.default)(k))}},98411:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.defaultPresetColors=E.default=void 0;const _=E.defaultPresetColors={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},D=Object.assign(Object.assign({},_),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});var N=E.default=D},10805:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=N;var D=_(131);function N(h,O){let{generateColorPalettes:C,generateNeutralColorPalettes:P}=O;const{colorSuccess:F,colorWarning:Y,colorError:V,colorInfo:Q,colorPrimary:k,colorBgBase:K,colorTextBase:U}=h,Z=C(k),J=C(F),H=C(Y),ve=C(V),Te=C(Q),ye=P(K,U),Ve=h.colorLink||h.colorInfo,Re=C(Ve);return Object.assign(Object.assign({},ye),{colorPrimaryBg:Z[1],colorPrimaryBgHover:Z[2],colorPrimaryBorder:Z[3],colorPrimaryBorderHover:Z[4],colorPrimaryHover:Z[5],colorPrimary:Z[6],colorPrimaryActive:Z[7],colorPrimaryTextHover:Z[8],colorPrimaryText:Z[9],colorPrimaryTextActive:Z[10],colorSuccessBg:J[1],colorSuccessBgHover:J[2],colorSuccessBorder:J[3],colorSuccessBorderHover:J[4],colorSuccessHover:J[4],colorSuccess:J[6],colorSuccessActive:J[7],colorSuccessTextHover:J[8],colorSuccessText:J[9],colorSuccessTextActive:J[10],colorErrorBg:ve[1],colorErrorBgHover:ve[2],colorErrorBorder:ve[3],colorErrorBorderHover:ve[4],colorErrorHover:ve[5],colorError:ve[6],colorErrorActive:ve[7],colorErrorTextHover:ve[8],colorErrorText:ve[9],colorErrorTextActive:ve[10],colorWarningBg:H[1],colorWarningBgHover:H[2],colorWarningBorder:H[3],colorWarningBorderHover:H[4],colorWarningHover:H[4],colorWarning:H[6],colorWarningActive:H[7],colorWarningTextHover:H[8],colorWarningText:H[9],colorWarningTextActive:H[10],colorInfoBg:Te[1],colorInfoBgHover:Te[2],colorInfoBorder:Te[3],colorInfoBorderHover:Te[4],colorInfoHover:Te[4],colorInfo:Te[6],colorInfoActive:Te[7],colorInfoTextHover:Te[8],colorInfoText:Te[9],colorInfoTextActive:Te[10],colorLinkHover:Re[4],colorLink:Re[6],colorLinkActive:Re[7],colorBgMask:new D.TinyColor("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},81594:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=h;var N=D(_(78117));function h(O){const{motionUnit:C,motionBase:P,borderRadius:F,lineWidth:Y}=O;return Object.assign({motionDurationFast:`${(P+C).toFixed(1)}s`,motionDurationMid:`${(P+C*2).toFixed(1)}s`,motionDurationSlow:`${(P+C*3).toFixed(1)}s`,lineWidthBold:Y+1},(0,N.default)(F))}},54730:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const _=N=>{const{controlHeight:h}=N;return{controlHeightSM:h*.75,controlHeightXS:h*.5,controlHeightLG:h*1.25}};var D=E.default=_},69853:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(62231));const h=C=>{const P=(0,N.default)(C),F=P.map(J=>J.size),Y=P.map(J=>J.lineHeight),V=F[1],Q=F[0],k=F[2],K=Y[1],U=Y[0],Z=Y[2];return{fontSizeSM:Q,fontSize:V,fontSizeLG:k,fontSizeXL:F[3],fontSizeHeading1:F[6],fontSizeHeading2:F[5],fontSizeHeading3:F[4],fontSizeHeading4:F[3],fontSizeHeading5:F[2],lineHeight:K,lineHeightLG:Z,lineHeightSM:U,fontHeight:Math.round(K*V),fontHeightLG:Math.round(Z*k),fontHeightSM:Math.round(U*Q),lineHeightHeading1:Y[6],lineHeightHeading2:Y[5],lineHeightHeading3:Y[4],lineHeightHeading4:Y[3],lineHeightHeading5:Y[2]}};var O=E.default=h},62231:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=D,E.getLineHeight=_;function _(N){return(N+8)/N}function D(N){const h=new Array(10).fill(null).map((O,C)=>{const P=C-1,F=N*Math.pow(2.71828,P/5),Y=C>1?Math.floor(F):Math.ceil(F);return Math.floor(Y/2)*2});return h[1]=N,h.map(O=>({size:O,lineHeight:_(O)}))}},78117:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const _=N=>{let h=N,O=N,C=N,P=N;return N<6&&N>=5?h=N+1:N<16&&N>=6?h=N+2:N>=16&&(h=16),N<7&&N>=5?O=4:N<8&&N>=7?O=5:N<14&&N>=8?O=6:N<16&&N>=14?O=7:N>=16&&(O=8),N<6&&N>=2?C=1:N>=6&&(C=2),N>4&&N<8?P=4:N>=8&&(P=6),{borderRadius:N,borderRadiusXS:C,borderRadiusSM:O,borderRadiusLG:h,borderRadiusOuter:P}};var D=E.default=_},19216:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=_;function _(D){const{sizeUnit:N,sizeStep:h}=D;return{sizeXXL:N*(h+8),sizeXL:N*(h+4),sizeLG:N*(h+2),sizeMD:N*(h+1),sizeMS:N*h,size:N*h,sizeSM:N*(h-1),sizeXS:N*(h-2),sizeXXS:N*(h-3)}}},41401:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=U,E.unitless=E.ignore=E.getComputedToken=void 0;var N=D(_(67294)),h=_(6731),O=D(_(87629)),C=_(89329),P=D(_(98411)),F=D(_(27722)),Y=function(Z,J){var H={};for(var ve in Z)Object.prototype.hasOwnProperty.call(Z,ve)&&J.indexOf(ve)<0&&(H[ve]=Z[ve]);if(Z!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Te=0,ve=Object.getOwnPropertySymbols(Z);Te<ve.length;Te++)J.indexOf(ve[Te])<0&&Object.prototype.propertyIsEnumerable.call(Z,ve[Te])&&(H[ve[Te]]=Z[ve[Te]]);return H};const V=E.unitless={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0},Q=E.ignore={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},k={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},K=(Z,J,H)=>{const ve=H.getDerivativeToken(Z),{override:Te}=J,ye=Y(J,["override"]);let Ve=Object.assign(Object.assign({},ve),{override:Te});return Ve=(0,F.default)(Ve),ye&&Object.entries(ye).forEach(Re=>{let[Ae,ae]=Re;const{theme:ee}=ae,me=Y(ae,["theme"]);let ge=me;ee&&(ge=K(Object.assign(Object.assign({},Ve),me),{override:me},ee)),Ve[Ae]=ge}),Ve};E.getComputedToken=K;function U(){const{token:Z,hashed:J,theme:H,override:ve,cssVar:Te}=N.default.useContext(C.DesignTokenContext),ye=`${O.default}-${J||""}`,Ve=H||C.defaultTheme,[Re,Ae,ae]=(0,h.useCacheToken)(Ve,[P.default,Z],{salt:ye,override:ve,getComputedToken:K,formatToken:F.default,cssVar:Te&&{prefix:Te.prefix,key:Te.key,unitless:V,ignore:Q,preserve:k}});return[Ve,ae,J?Ae:"",Re,Te]}},27722:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=P;var N=_(131),h=D(_(98411)),O=D(_(83609)),C=function(F,Y){var V={};for(var Q in F)Object.prototype.hasOwnProperty.call(F,Q)&&Y.indexOf(Q)<0&&(V[Q]=F[Q]);if(F!=null&&typeof Object.getOwnPropertySymbols=="function")for(var k=0,Q=Object.getOwnPropertySymbols(F);k<Q.length;k++)Y.indexOf(Q[k])<0&&Object.prototype.propertyIsEnumerable.call(F,Q[k])&&(V[Q[k]]=F[Q[k]]);return V};function P(F){const{override:Y}=F,V=C(F,["override"]),Q=Object.assign({},Y);Object.keys(h.default).forEach(ye=>{delete Q[ye]});const k=Object.assign(Object.assign({},V),Q),K=480,U=576,Z=768,J=992,H=1200,ve=1600;if(k.motion===!1){const ye="0s";k.motionDurationFast=ye,k.motionDurationMid=ye,k.motionDurationSlow=ye}return Object.assign(Object.assign(Object.assign({},k),{colorFillContent:k.colorFillSecondary,colorFillContentHover:k.colorFill,colorFillAlter:k.colorFillQuaternary,colorBgContainerDisabled:k.colorFillTertiary,colorBorderBg:k.colorBgContainer,colorSplit:(0,O.default)(k.colorBorderSecondary,k.colorBgContainer),colorTextPlaceholder:k.colorTextQuaternary,colorTextDisabled:k.colorTextQuaternary,colorTextHeading:k.colorText,colorTextLabel:k.colorTextSecondary,colorTextDescription:k.colorTextTertiary,colorTextLightSolid:k.colorWhite,colorHighlight:k.colorError,colorBgTextHover:k.colorFillSecondary,colorBgTextActive:k.colorFill,colorIcon:k.colorTextTertiary,colorIconHover:k.colorText,colorErrorOutline:(0,O.default)(k.colorErrorBg,k.colorBgContainer),colorWarningOutline:(0,O.default)(k.colorWarningBg,k.colorBgContainer),fontSizeIcon:k.fontSizeSM,lineWidthFocus:k.lineWidth*4,lineWidth:k.lineWidth,controlOutlineWidth:k.lineWidth*2,controlInteractiveSize:k.controlHeight/2,controlItemBgHover:k.colorFillTertiary,controlItemBgActive:k.colorPrimaryBg,controlItemBgActiveHover:k.colorPrimaryBgHover,controlItemBgActiveDisabled:k.colorFill,controlTmpOutline:k.colorFillQuaternary,controlOutline:(0,O.default)(k.colorPrimaryBg,k.colorBgContainer),lineType:k.lineType,borderRadius:k.borderRadius,borderRadiusXS:k.borderRadiusXS,borderRadiusSM:k.borderRadiusSM,borderRadiusLG:k.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:k.sizeXXS,paddingXS:k.sizeXS,paddingSM:k.sizeSM,padding:k.size,paddingMD:k.sizeMD,paddingLG:k.sizeLG,paddingXL:k.sizeXL,paddingContentHorizontalLG:k.sizeLG,paddingContentVerticalLG:k.sizeMS,paddingContentHorizontal:k.sizeMS,paddingContentVertical:k.sizeSM,paddingContentHorizontalSM:k.size,paddingContentVerticalSM:k.sizeXS,marginXXS:k.sizeXXS,marginXS:k.sizeXS,marginSM:k.sizeSM,margin:k.size,marginMD:k.sizeMD,marginLG:k.sizeLG,marginXL:k.sizeXL,marginXXL:k.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:K,screenXSMin:K,screenXSMax:U-1,screenSM:U,screenSMMin:U,screenSMMax:Z-1,screenMD:Z,screenMDMin:Z,screenMDMax:J-1,screenLG:J,screenLGMin:J,screenLGMax:H-1,screenXL:H,screenXLMin:H,screenXLMax:ve-1,screenXXL:ve,screenXXLMin:ve,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new N.TinyColor("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new N.TinyColor("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new N.TinyColor("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),Q)}},24312:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(56690)),h=D(_(89728)),O=D(_(76976)),C=D(_(61655)),P=D(_(38194));const F="CALC_UNIT";function Y(Q){return typeof Q=="number"?`${Q}${F}`:Q}let V=E.default=function(Q){(0,C.default)(k,Q);function k(K){var U;return(0,N.default)(this,k),U=(0,O.default)(this,k),U.result="",K instanceof k?U.result=`(${K.result})`:typeof K=="number"?U.result=Y(K):typeof K=="string"&&(U.result=K),U}return(0,h.default)(k,[{key:"add",value:function(U){return U instanceof k?this.result=`${this.result} + ${U.getResult()}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} + ${Y(U)}`),this.lowPriority=!0,this}},{key:"sub",value:function(U){return U instanceof k?this.result=`${this.result} - ${U.getResult()}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} - ${Y(U)}`),this.lowPriority=!0,this}},{key:"mul",value:function(U){return this.lowPriority&&(this.result=`(${this.result})`),U instanceof k?this.result=`${this.result} * ${U.getResult(!0)}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} * ${U}`),this.lowPriority=!1,this}},{key:"div",value:function(U){return this.lowPriority&&(this.result=`(${this.result})`),U instanceof k?this.result=`${this.result} / ${U.getResult(!0)}`:(typeof U=="number"||typeof U=="string")&&(this.result=`${this.result} / ${U}`),this.lowPriority=!1,this}},{key:"getResult",value:function(U){return this.lowPriority||U?`(${this.result})`:this.result}},{key:"equal",value:function(U){const{unit:Z=!0}=U||{},J=new RegExp(`${F}`,"g");return this.result=this.result.replace(J,Z?"px":""),typeof this.lowPriority!="undefined"?`calc(${this.result})`:this.result}}]),k}(P.default)},14774:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(56690)),h=D(_(89728)),O=D(_(76976)),C=D(_(61655)),P=D(_(38194));let F=E.default=function(Y){(0,C.default)(V,Y);function V(Q){var k;return(0,N.default)(this,V),k=(0,O.default)(this,V),k.result=0,Q instanceof V?k.result=Q.result:typeof Q=="number"&&(k.result=Q),k}return(0,h.default)(V,[{key:"add",value:function(k){return k instanceof V?this.result+=k.result:typeof k=="number"&&(this.result+=k),this}},{key:"sub",value:function(k){return k instanceof V?this.result-=k.result:typeof k=="number"&&(this.result-=k),this}},{key:"mul",value:function(k){return k instanceof V?this.result*=k.result:typeof k=="number"&&(this.result*=k),this}},{key:"div",value:function(k){return k instanceof V?this.result/=k.result:typeof k=="number"&&(this.result/=k),this}},{key:"equal",value:function(){return this.result}}]),V}(P.default)},38194:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(89728)),h=D(_(56690));let O=(0,N.default)(function P(){(0,h.default)(this,P)});var C=E.default=O},22996:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(14774)),h=D(_(24312));const O=P=>{const F=P==="css"?h.default:N.default;return Y=>new F(Y)};var C=E.default=O},3737:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=H,E.genSubStyleComponent=E.genStyleHooks=void 0;var h=N(_(67294)),O=_(6731),C=_(56790),P=_(7177),F=_(98078),Y=N(_(41401)),V=D(_(22996)),Q=D(_(1657)),k=N(_(99636)),K=D(_(54894));const U=(Ve,Re,Ae)=>{var ae;return typeof Ae=="function"?Ae((0,k.merge)(Re,(ae=Re[Ve])!==null&&ae!==void 0?ae:{})):Ae!=null?Ae:{}},Z=(Ve,Re,Ae,ae)=>{const ee=Object.assign({},Re[Ve]);if(ae!=null&&ae.deprecatedTokens){const{deprecatedTokens:ge}=ae;ge.forEach(fe=>{let[Et,xe]=fe;var je;(ee!=null&&ee[Et]||ee!=null&&ee[xe])&&((je=ee[xe])!==null&&je!==void 0||(ee[xe]=ee==null?void 0:ee[Et]))})}const me=Object.assign(Object.assign({},Ae),ee);return Object.keys(me).forEach(ge=>{me[ge]===Re[ge]&&delete me[ge]}),me},J=(Ve,Re)=>`${[Re,Ve.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-")}`;function H(Ve,Re,Ae){let ae=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const ee=Array.isArray(Ve)?Ve:[Ve,Ve],[me]=ee,ge=ee.join("-");return function(fe){let Et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fe;const[xe,je,ue,Pe,we]=(0,Y.default)(),{getPrefixCls:nt,iconPrefixCls:at,csp:vt}=(0,h.useContext)(P.ConfigContext),Tt=nt(),ze=we?"css":"js",gr=(0,V.default)(ze),{max:At,min:hn}=(0,Q.default)(ze),Wr={theme:xe,token:Pe,hashId:ue,nonce:()=>vt==null?void 0:vt.nonce,clientOnly:ae.clientOnly,order:ae.order||-999};return(0,O.useStyleRegister)(Object.assign(Object.assign({},Wr),{clientOnly:!1,path:["Shared",Tt]}),()=>[{"&":(0,F.genLinkStyle)(Pe)}]),(0,K.default)(at,vt),[(0,O.useStyleRegister)(Object.assign(Object.assign({},Wr),{path:[ge,fe,at]}),()=>{if(ae.injectStyle===!1)return[];const{token:dn,flush:tn}=(0,k.default)(Pe),un=U(me,je,Ae),yn=`.${fe}`,Vt=Z(me,je,un,{deprecatedTokens:ae.deprecatedTokens});we&&Object.keys(un).forEach(He=>{un[He]=`var(${(0,O.token2CSSVar)(He,J(me,we.prefix))})`});const dr=(0,k.merge)(dn,{componentCls:yn,prefixCls:fe,iconCls:`.${at}`,antCls:`.${Tt}`,calc:gr,max:At,min:hn},we?un:Vt),wt=Re(dr,{hashId:ue,prefixCls:fe,rootPrefixCls:Tt,iconPrefixCls:at});return tn(me,Vt),[ae.resetStyle===!1?null:(0,F.genCommonStyle)(dr,fe,Et),wt]}),ue]}}const ve=(Ve,Re,Ae,ae)=>{const ee=H(Ve,Re,Ae,Object.assign({resetStyle:!1,order:-998},ae));return ge=>{let{prefixCls:fe,rootCls:Et=fe}=ge;return ee(fe,Et),null}};E.genSubStyleComponent=ve;const Te=(Ve,Re,Ae)=>{function ae(xe){return`${Ve}${xe.slice(0,1).toUpperCase()}${xe.slice(1)}`}const{unitless:ee={},injectStyle:me=!0}=Ae!=null?Ae:{},ge={[ae("zIndexPopup")]:!0};Object.keys(ee).forEach(xe=>{ge[ae(xe)]=ee[xe]});const fe=xe=>{let{rootCls:je,cssVar:ue}=xe;const[,Pe]=(0,Y.default)();return(0,O.useCSSVarRegister)({path:[Ve],prefix:ue.prefix,key:ue==null?void 0:ue.key,unitless:Object.assign(Object.assign({},Y.unitless),ge),ignore:Y.ignore,token:Pe,scope:je},()=>{const we=U(Ve,Pe,Re),nt=Z(Ve,Pe,we,{deprecatedTokens:Ae==null?void 0:Ae.deprecatedTokens});return Object.keys(we).forEach(at=>{nt[ae(at)]=nt[at],delete nt[at]}),nt}),null};return xe=>{const[,,,,je]=(0,Y.default)();return[ue=>me&&je?h.default.createElement(h.default.Fragment,null,h.default.createElement(fe,{rootCls:xe,cssVar:je,component:Ve}),ue):ue,je==null?void 0:je.key]}},ye=(Ve,Re,Ae,ae)=>{const ee=H(Ve,Re,Ae,ae),me=Te(Array.isArray(Ve)?Ve[0]:Ve,Ae,ae);return function(ge){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ge;const[,Et]=ee(ge,fe),[xe,je]=me(fe);return[xe,Et,je]}};E.genStyleHooks=ye},36219:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=N;var D=_(36496);function N(h,O){return D.PresetColors.reduce((C,P)=>{const F=h[`${P}1`],Y=h[`${P}3`],V=h[`${P}6`],Q=h[`${P}7`];return Object.assign(Object.assign({},C),O(P,{lightColor:F,lightBorderColor:Y,darkColor:V,textColor:Q}))},{})}},83609:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var D=_(131);function N(C){return C>=0&&C<=255}function h(C,P){const{r:F,g:Y,b:V,a:Q}=new D.TinyColor(C).toRgb();if(Q<1)return C;const{r:k,g:K,b:U}=new D.TinyColor(P).toRgb();for(let Z=.01;Z<=1;Z+=.01){const J=Math.round((F-k*(1-Z))/Z),H=Math.round((Y-K*(1-Z))/Z),ve=Math.round((V-U*(1-Z))/Z);if(N(J)&&N(H)&&N(ve))return new D.TinyColor({r:J,g:H,b:ve,a:Math.round(Z*100)/100}).toRgbString()}return new D.TinyColor({r:F,g:Y,b:V,a:1}).toRgbString()}var O=E.default=h},1657:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=N;var D=_(6731);function N(h){return h==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var O=arguments.length,C=new Array(O),P=0;P<O;P++)C[P]=arguments[P];return`max(${C.map(F=>(0,D.unit)(F)).join(",")})`},min:function(){for(var O=arguments.length,C=new Array(O),P=0;P<O;P++)C[P]=arguments[P];return`min(${C.map(F=>(0,D.unit)(F)).join(",")})`}}}},99636:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=E._statistic_build_=void 0,E.merge=N,E.statistic=void 0;const _=typeof CSSINJS_STATISTIC!="undefined";let D=!0;function N(){for(var Y=arguments.length,V=new Array(Y),Q=0;Q<Y;Q++)V[Q]=arguments[Q];if(!_)return Object.assign.apply(Object,[{}].concat(V));D=!1;const k={};return V.forEach(K=>{Object.keys(K).forEach(Z=>{Object.defineProperty(k,Z,{configurable:!0,enumerable:!0,get:()=>K[Z]})})}),D=!0,k}const h=E.statistic={},O=E._statistic_build_={};function C(){}const P=Y=>{let V,Q=Y,k=C;return _&&typeof Proxy!="undefined"&&(V=new Set,Q=new Proxy(Y,{get(K,U){return D&&V.add(U),K[U]}}),k=(K,U)=>{var Z;h[K]={global:Array.from(V),component:Object.assign(Object.assign({},(Z=h[K])===null||Z===void 0?void 0:Z.component),U)}}),{token:Q,keys:V,flush:k}};var F=E.default=P},54894:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=_(6731),h=_(98078),O=D(_(41401));const C=(F,Y)=>{const[V,Q]=(0,O.default)();return(0,N.useStyleRegister)({theme:V,token:Q,hashId:"",path:["ant-design-icons",F],nonce:()=>Y==null?void 0:Y.nonce},()=>[{[`.${F}`]:Object.assign(Object.assign({},(0,h.resetIcon)()),{[`.${F} .${F}-icon`]:{display:"block"}})}])};var P=E.default=C},52040:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const _={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};var D=E.default=_},92125:function(Ze,E,_){"use strict";"use client";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(93967)),O=_(92419),C=D(_(67294)),P=_(31929),F=N(_(15086)),Y=_(48125);const V=k=>{const{prefixCls:K,className:U,placement:Z="top",title:J,color:H,overlayInnerStyle:ve}=k,{getPrefixCls:Te}=C.useContext(P.ConfigContext),ye=Te("tooltip",K),[Ve,Re,Ae]=(0,F.default)(ye),ae=(0,Y.parseColor)(ye,H),ee=ae.arrowStyle,me=Object.assign(Object.assign({},ve),ae.overlayStyle),ge=(0,h.default)(Re,Ae,ye,`${ye}-pure`,`${ye}-placement-${Z}`,U,ae.className);return Ve(C.createElement("div",{className:ge,style:ee},C.createElement("div",{className:`${ye}-arrow`}),C.createElement(O.Popup,Object.assign({},k,{className:Re,prefixCls:ye,overlayInnerStyle:me}),J)))};var Q=E.default=V},94055:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(67294)),O=D(_(93967)),C=D(_(92419)),P=D(_(60869)),F=_(56333),Y=_(53683),V=D(_(74132)),Q=_(47419),k=_(13594),K=D(_(96877)),U=_(31929),Z=_(46549),J=_(3184),H=D(_(92125)),ve=D(_(15086)),Te=_(48125),ye=function(Ae,ae){var ee={};for(var me in Ae)Object.prototype.hasOwnProperty.call(Ae,me)&&ae.indexOf(me)<0&&(ee[me]=Ae[me]);if(Ae!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ge=0,me=Object.getOwnPropertySymbols(Ae);ge<me.length;ge++)ae.indexOf(me[ge])<0&&Object.prototype.propertyIsEnumerable.call(Ae,me[ge])&&(ee[me[ge]]=Ae[me[ge]]);return ee};const Ve=h.forwardRef((Ae,ae)=>{var ee,me;const{prefixCls:ge,openClassName:fe,getTooltipContainer:Et,overlayClassName:xe,color:je,overlayInnerStyle:ue,children:Pe,afterOpenChange:we,afterVisibleChange:nt,destroyTooltipOnHide:at,arrow:vt=!0,title:Tt,overlay:ze,builtinPlacements:gr,arrowPointAtCenter:At=!1,autoAdjustOverflow:hn=!0}=Ae,Wr=!!vt,[,vr]=(0,J.useToken)(),{getPopupContainer:dn,getPrefixCls:tn,direction:un}=h.useContext(U.ConfigContext),yn=(0,k.devUseWarning)("Tooltip"),Vt=h.useRef(null),dr=()=>{var be;(be=Vt.current)===null||be===void 0||be.forceAlign()};h.useImperativeHandle(ae,()=>({forceAlign:dr,forcePopupAlign:()=>{yn.deprecated(!1,"forcePopupAlign","forceAlign"),dr()}}));const[wt,He]=(0,P.default)(!1,{value:(ee=Ae.open)!==null&&ee!==void 0?ee:Ae.visible,defaultValue:(me=Ae.defaultOpen)!==null&&me!==void 0?me:Ae.defaultVisible}),wr=!Tt&&!ze&&Tt!==0,Ne=be=>{var ke,qe;He(wr?!1:be),wr||((ke=Ae.onOpenChange)===null||ke===void 0||ke.call(Ae,be),(qe=Ae.onVisibleChange)===null||qe===void 0||qe.call(Ae,be))},Xr=h.useMemo(()=>{var be,ke;let qe=At;return typeof vt=="object"&&(qe=(ke=(be=vt.pointAtCenter)!==null&&be!==void 0?be:vt.arrowPointAtCenter)!==null&&ke!==void 0?ke:At),gr||(0,V.default)({arrowPointAtCenter:qe,autoAdjustOverflow:hn,arrowWidth:Wr?vr.sizePopupArrow:0,borderRadius:vr.borderRadius,offset:vr.marginXXS,visibleFirst:!0})},[At,vt,gr,vr]),Er=h.useMemo(()=>Tt===0?Tt:ze||Tt||"",[ze,Tt]),Ue=h.createElement(Z.NoCompactStyle,null,typeof Er=="function"?Er():Er),{getPopupContainer:In,placement:an="top",mouseEnterDelay:Qr=.1,mouseLeaveDelay:Dn=.1,overlayStyle:On,rootClassName:ri}=Ae,zt=ye(Ae,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),cr=tn("tooltip",ge),Zr=tn(),Kr=Ae["data-popover-inject"];let en=wt;!("open"in Ae)&&!("visible"in Ae)&&wr&&(en=!1);const Wn=h.isValidElement(Pe)&&!(0,Q.isFragment)(Pe)?Pe:h.createElement("span",null,Pe),De=Wn.props,X=!De.className||typeof De.className=="string"?(0,O.default)(De.className,fe||`${cr}-open`):De.className,[se,Be,Ye]=(0,ve.default)(cr,!Kr),ct=(0,Te.parseColor)(cr,je),sr=ct.arrowStyle,ar=Object.assign(Object.assign({},ue),ct.overlayStyle),or=(0,O.default)(xe,{[`${cr}-rtl`]:un==="rtl"},ct.className,ri,Be,Ye),[Wt,oe]=(0,F.useZIndex)("Tooltip",zt.zIndex),ie=h.createElement(C.default,Object.assign({},zt,{zIndex:Wt,showArrow:Wr,placement:an,mouseEnterDelay:Qr,mouseLeaveDelay:Dn,prefixCls:cr,overlayClassName:or,overlayStyle:Object.assign(Object.assign({},sr),On),getTooltipContainer:In||Et||dn,ref:Vt,builtinPlacements:Xr,overlay:Ue,visible:en,onVisibleChange:Ne,afterVisibleChange:we!=null?we:nt,overlayInnerStyle:ar,arrowContent:h.createElement("span",{className:`${cr}-arrow-content`}),motion:{motionName:(0,Y.getTransitionName)(Zr,"zoom-big-fast",Ae.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!at}),en?(0,Q.cloneElement)(Wn,{className:X}):Wn);return se(h.createElement(K.default.Provider,{value:oe},ie))});Ve._InternalPanelDoNotUseOrYouWillBeFired=H.default;var Re=E.default=Ve},15086:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.prepareComponentToken=E.default=void 0;var N=_(98078),h=_(42836),O=D(_(9064)),C=_(3184),P=_(6731),F=_(51337);const Y=k=>{const{componentCls:K,tooltipMaxWidth:U,tooltipColor:Z,tooltipBg:J,tooltipBorderRadius:H,zIndexPopup:ve,controlHeight:Te,boxShadowSecondary:ye,paddingSM:Ve,paddingXS:Re}=k;return[{[K]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,N.resetComponent)(k)),{position:"absolute",zIndex:ve,display:"block",width:"max-content",maxWidth:U,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":J,[`${K}-inner`]:{minWidth:Te,minHeight:Te,padding:`${(0,P.unit)(k.calc(Ve).div(2).equal())} ${(0,P.unit)(Re)}`,color:Z,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:J,borderRadius:H,boxShadow:ye,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${K}-inner`]:{borderRadius:k.min(H,O.MAX_VERTICAL_CONTENT_RADIUS)}},[`${K}-content`]:{position:"relative"}}),(0,C.genPresetColor)(k,(Ae,ae)=>{let{darkColor:ee}=ae;return{[`&${K}-${Ae}`]:{[`${K}-inner`]:{backgroundColor:ee},[`${K}-arrow`]:{"--antd-arrow-background-color":ee}}}})),{"&-rtl":{direction:"rtl"}})},(0,O.default)(k,"var(--antd-arrow-background-color)"),{[`${K}-pure`]:{position:"relative",maxWidth:"none",margin:k.sizePopupArrow}}]},V=k=>Object.assign(Object.assign({zIndexPopup:k.zIndexPopupBase+70},(0,O.getArrowOffsetToken)({contentRadius:k.borderRadius,limitVerticalRadius:!0})),(0,F.getArrowToken)((0,C.mergeToken)(k,{borderRadiusOuter:Math.min(k.borderRadiusOuter,4)})));E.prepareComponentToken=V;var Q=E.default=function(K){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(0,C.genStyleHooks)("Tooltip",J=>{const{borderRadius:H,colorTextLightSolid:ve,colorBgSpotlight:Te}=J,ye=(0,C.mergeToken)(J,{tooltipMaxWidth:250,tooltipColor:ve,tooltipBorderRadius:H,tooltipBg:Te});return[Y(ye),(0,h.initZoomMotion)(J,"zoom-big-fast")]},V,{resetStyle:!1,injectStyle:U})(K)}},48125:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.parseColor=O;var N=D(_(93967)),h=_(45471);function O(C,P){const F=(0,h.isPresetColor)(P),Y=(0,N.default)({[`${C}-${P}`]:P&&F}),V={},Q={};return P&&!F&&(V.background=P,Q["--antd-arrow-background-color"]=P),{className:Y,overlayStyle:V,arrowStyle:Q}}},6847:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=Q;var h=N(_(67294)),O=D(_(83874)),C=D(_(90091)),P=D(_(93967)),F=D(_(60938)),Y=D(_(94055)),V=_(81410);function Q(k){const{prefixCls:K,copied:U,locale:Z={},onCopy:J,iconOnly:H,tooltips:ve,icon:Te}=k,ye=(0,V.toList)(ve),Ve=(0,V.toList)(Te),{copied:Re,copy:Ae}=Z,ae=U?(0,V.getNode)(ye[1],Re):(0,V.getNode)(ye[0],Ae),me=typeof ae=="string"?ae:U?Re:Ae;return h.createElement(Y.default,{key:"copy",title:ae},h.createElement(F.default,{className:(0,P.default)(`${K}-copy`,{[`${K}-copy-success`]:U,[`${K}-copy-icon-only`]:H}),onClick:J,"aria-label":me},U?(0,V.getNode)(Ve[1],h.createElement(O.default,null),!0):(0,V.getNode)(Ve[0],h.createElement(C.default,null),!0)))}},12385:function(Ze,E,_){"use strict";"use client";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=H;var h=N(_(861)),O=D(_(67294)),C=N(_(45598)),P=N(_(82546));const F=O.forwardRef((ve,Te)=>{let{style:ye,children:Ve}=ve;const Re=O.useRef(null);return O.useImperativeHandle(Te,()=>({isExceed:()=>{const Ae=Re.current;return Ae.scrollHeight>Ae.clientHeight},getHeight:()=>Re.current.clientHeight})),O.createElement("span",{"aria-hidden":!0,ref:Re,style:Object.assign({position:"fixed",display:"block",left:0,top:0,pointerEvents:"none",backgroundColor:"rgba(255, 0, 0, 0.65)"},ye)},Ve)});function Y(ve){const Te=typeof ve;return Te==="string"||Te==="number"}function V(ve){let Te=0;return ve.forEach(ye=>{Y(ye)?Te+=String(ye).length:Te+=1}),Te}function Q(ve,Te){let ye=0;const Ve=[];for(let Re=0;Re<ve.length;Re+=1){if(ye===Te)return Ve;const Ae=ve[Re],ee=Y(Ae)?String(Ae).length:1,me=ye+ee;if(me>Te){const ge=Te-ye;return Ve.push(String(Ae).slice(0,ge)),Ve}Ve.push(Ae),ye=me}return ve}const k=0,K=1,U=2,Z=3,J={display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical"};function H(ve){const{enableMeasure:Te,width:ye,text:Ve,children:Re,rows:Ae,miscDeps:ae,onEllipsis:ee}=ve,me=O.useMemo(()=>(0,C.default)(Ve),[Ve]),ge=O.useMemo(()=>V(me),[Ve]),fe=O.useMemo(()=>Re(me,!1,!1),[Ve]),[Et,xe]=O.useState(null),je=O.useRef(null),ue=O.useRef(null),[Pe,we]=O.useState(k),[nt,at]=O.useState(0);(0,P.default)(()=>{we(Te&&ye&&ge?K:k)},[ye,Ve,Ae,Te,me]),(0,P.default)(()=>{var gr,At;if(Pe===K){const hn=!!(!((gr=ue.current)===null||gr===void 0)&&gr.isExceed());we(hn?U:Z),xe(hn?[0,ge]:null),at((((At=ue.current)===null||At===void 0?void 0:At.getHeight())||0)+1),ee(hn)}},[Pe]);const vt=Et?Math.ceil((Et[0]+Et[1])/2):0;(0,P.default)(()=>{var gr;const[At,hn]=Et||[0,0];if(At!==hn){const vr=(((gr=je.current)===null||gr===void 0?void 0:gr.getHeight())||0)>nt;let dn=vt;hn-At===1&&(dn=vr?At:hn),xe(vr?[At,dn]:[dn,hn])}},[Et,vt]);const Tt=O.useMemo(()=>{if(Pe!==U||!Et||Et[0]!==Et[1]){const gr=Re(me,!1,!1);return Pe!==Z&&Pe!==k?O.createElement("span",{style:Object.assign(Object.assign({},J),{WebkitLineClamp:Ae})},gr):gr}return Re(Q(me,Et[0]),!0,!0)},[Pe,Et,me].concat((0,h.default)(ae))),ze={width:ye,whiteSpace:"normal",margin:0,padding:0};return O.createElement(O.Fragment,null,Tt,Pe===K&&O.createElement(F,{style:Object.assign(Object.assign(Object.assign({},ze),J),{WebkitLineClamp:Ae}),ref:ue},fe),Pe===U&&Et&&Et[0]!==Et[1]&&O.createElement(F,{style:Object.assign(Object.assign({},ze),{top:400}),ref:je},Re(Q(me,vt),!0,!0)))}},69274:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(67294)),O=D(_(94055));const C=F=>{let{enableEllipsis:Y,isEllipsis:V,children:Q,tooltipProps:k}=F;return!(k!=null&&k.title)||!Y?Q:h.createElement(O.default,Object.assign({open:V?void 0:!1},k),Q)};var P=E.default=C},28460:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(67294)),O=D(_(10875)),C=D(_(93967)),P=D(_(20640)),F=D(_(9220)),Y=D(_(45598)),V=D(_(82546)),Q=D(_(60869)),k=D(_(18475)),K=_(75531),U=_(38882),Z=D(_(60938)),J=_(31929),H=D(_(76647)),ve=D(_(94055)),Te=D(_(69425)),ye=D(_(92759)),Ve=D(_(67312)),Re=D(_(89652)),Ae=D(_(6847)),ae=D(_(12385)),ee=D(_(69274)),me=function(je,ue){var Pe={};for(var we in je)Object.prototype.hasOwnProperty.call(je,we)&&ue.indexOf(we)<0&&(Pe[we]=je[we]);if(je!=null&&typeof Object.getOwnPropertySymbols=="function")for(var nt=0,we=Object.getOwnPropertySymbols(je);nt<we.length;nt++)ue.indexOf(we[nt])<0&&Object.prototype.propertyIsEnumerable.call(je,we[nt])&&(Pe[we[nt]]=je[we[nt]]);return Pe};function ge(je,ue){let{mark:Pe,code:we,underline:nt,delete:at,strong:vt,keyboard:Tt,italic:ze}=je,gr=ue;function At(hn,Wr){Wr&&(gr=h.createElement(hn,{},gr))}return At("strong",vt),At("u",nt),At("del",at),At("code",we),At("mark",Pe),At("kbd",Tt),At("i",ze),gr}const fe="...",Et=h.forwardRef((je,ue)=>{var Pe,we,nt;const{prefixCls:at,className:vt,style:Tt,type:ze,disabled:gr,children:At,ellipsis:hn,editable:Wr,copyable:vr,component:dn,title:tn}=je,un=me(je,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:yn,direction:Vt}=h.useContext(J.ConfigContext),[dr]=(0,H.default)("Text"),wt=h.useRef(null),He=h.useRef(null),wr=yn("typography",at),Ne=(0,k.default)(un,["mark","code","delete","underline","strong","keyboard","italic"]),[Xr,Er]=(0,ye.default)(Wr),[Ue,In]=(0,Q.default)(!1,{value:Er.editing}),{triggerType:an=["icon"]}=Er,Qr=mn=>{var Zn;mn&&((Zn=Er.onStart)===null||Zn===void 0||Zn.call(Er)),In(mn)};(0,Ve.default)(()=>{var mn;Ue||(mn=He.current)===null||mn===void 0||mn.focus()},[Ue]);const Dn=mn=>{mn==null||mn.preventDefault(),Qr(!0)},On=mn=>{var Zn;(Zn=Er.onChange)===null||Zn===void 0||Zn.call(Er,mn),Qr(!1)},ri=()=>{var mn;(mn=Er.onCancel)===null||mn===void 0||mn.call(Er),Qr(!1)},[zt,cr]=(0,ye.default)(vr),[Zr,Kr]=h.useState(!1),en=h.useRef(null),Wn={};cr.format&&(Wn.format=cr.format);const De=()=>{en.current&&clearTimeout(en.current)},X=mn=>{var Zn;mn==null||mn.preventDefault(),mn==null||mn.stopPropagation(),(0,P.default)(cr.text||String(At)||"",Wn),Kr(!0),De(),en.current=setTimeout(()=>{Kr(!1)},3e3),(Zn=cr.onCopy)===null||Zn===void 0||Zn.call(cr,mn)};h.useEffect(()=>De,[]);const[se,Be]=h.useState(!1),[Ye,ct]=h.useState(!1),[sr,ar]=h.useState(!1),[or,Wt]=h.useState(!1),[oe,ie]=h.useState(!1),[be,ke]=h.useState(!0),[qe,mt]=(0,ye.default)(hn,{expandable:!1}),kt=qe&&!sr,{rows:$e=1}=mt,Ge=h.useMemo(()=>!kt||mt.suffix!==void 0||mt.onEllipsis||mt.expandable||Xr||zt,[kt,mt,Xr,zt]);(0,V.default)(()=>{qe&&!Ge&&(Be((0,U.isStyleSupport)("webkitLineClamp")),ct((0,U.isStyleSupport)("textOverflow")))},[Ge,qe]);const We=h.useMemo(()=>Ge?!1:$e===1?Ye:se,[Ge,Ye,se]),G=kt&&(We?oe:or),rt=kt&&$e===1&&We,ft=kt&&$e>1&&We,bt=mn=>{var Zn;ar(!0),(Zn=mt.onExpand)===null||Zn===void 0||Zn.call(mt,mn)},[Gt,lr]=h.useState(0),Ht=mn=>{let{offsetWidth:Zn}=mn;lr(Zn)},Cr=mn=>{var Zn;Wt(mn),or!==mn&&((Zn=mt.onEllipsis)===null||Zn===void 0||Zn.call(mt,mn))};h.useEffect(()=>{const mn=wt.current;if(qe&&We&&mn){const Zn=ft?mn.offsetHeight<mn.scrollHeight:mn.offsetWidth<mn.scrollWidth;oe!==Zn&&ie(Zn)}},[qe,We,At,ft,be,Gt]),h.useEffect(()=>{const mn=wt.current;if(typeof IntersectionObserver=="undefined"||!mn||!We||!kt)return;const Zn=new IntersectionObserver(()=>{ke(!!mn.offsetParent)});return Zn.observe(mn),()=>{Zn.disconnect()}},[We,kt]);let hr={};mt.tooltip===!0?hr={title:(Pe=Er.text)!==null&&Pe!==void 0?Pe:At}:h.isValidElement(mt.tooltip)?hr={title:mt.tooltip}:typeof mt.tooltip=="object"?hr=Object.assign({title:(we=Er.text)!==null&&we!==void 0?we:At},mt.tooltip):hr={title:mt.tooltip};const Dr=h.useMemo(()=>{const mn=Zn=>["string","number"].includes(typeof Zn);if(!(!qe||We)){if(mn(Er.text))return Er.text;if(mn(At))return At;if(mn(tn))return tn;if(mn(hr.title))return hr.title}},[qe,We,tn,hr.title,G]);if(Ue)return h.createElement(Te.default,{value:(nt=Er.text)!==null&&nt!==void 0?nt:typeof At=="string"?At:"",onSave:On,onCancel:ri,onEnd:Er.onEnd,prefixCls:wr,className:vt,style:Tt,direction:Vt,component:dn,maxLength:Er.maxLength,autoSize:Er.autoSize,enterIcon:Er.enterIcon});const Rn=()=>{const{expandable:mn,symbol:Zn}=mt;if(!mn)return null;let sa;return Zn?sa=Zn:sa=dr==null?void 0:dr.expand,h.createElement("a",{key:"expand",className:`${wr}-expand`,onClick:bt,"aria-label":dr==null?void 0:dr.expand},sa)},on=()=>{if(!Xr)return;const{icon:mn,tooltip:Zn}=Er,sa=(0,Y.default)(Zn)[0]||(dr==null?void 0:dr.edit),qi=typeof sa=="string"?sa:"";return an.includes("icon")?h.createElement(ve.default,{key:"edit",title:Zn===!1?"":sa},h.createElement(Z.default,{ref:He,className:`${wr}-edit`,onClick:Dn,"aria-label":qi},mn||h.createElement(O.default,{role:"button"}))):null},fi=()=>zt?h.createElement(Ae.default,Object.assign({key:"copy"},cr,{prefixCls:wr,copied:Zr,locale:dr,onCopy:X,iconOnly:At==null})):null,Mi=mn=>[mn&&Rn(),on(),fi()],di=mn=>[mn&&h.createElement("span",{"aria-hidden":!0,key:"ellipsis"},fe),mt.suffix,Mi(mn)];return h.createElement(F.default,{onResize:Ht,disabled:!kt},mn=>h.createElement(ee.default,{tooltipProps:hr,enableEllipsis:kt,isEllipsis:G},h.createElement(Re.default,Object.assign({className:(0,C.default)({[`${wr}-${ze}`]:ze,[`${wr}-disabled`]:gr,[`${wr}-ellipsis`]:qe,[`${wr}-single-line`]:kt&&$e===1,[`${wr}-ellipsis-single-line`]:rt,[`${wr}-ellipsis-multiple-line`]:ft},vt),prefixCls:at,style:Object.assign(Object.assign({},Tt),{WebkitLineClamp:ft?$e:void 0}),component:dn,ref:(0,K.composeRef)(mn,wt,ue),direction:Vt,onClick:an.includes("text")?Dn:void 0,"aria-label":Dr==null?void 0:Dr.toString(),title:tn},Ne),h.createElement(ae.default,{enableMeasure:kt&&!We,text:At,rows:$e,width:Gt,onEllipsis:Cr,miscDeps:[Zr,sr]},(Zn,sa)=>{let qi=Zn;return Zn.length&&sa&&Dr&&(qi=h.createElement("span",{key:"show-content","aria-hidden":!0},qi)),ge(je,h.createElement(h.Fragment,null,qi,di(sa)))}))))});var xe=E.default=Et},81410:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.getNode=D,E.toList=_;function _(N){return N===!1?[!1,!1]:Array.isArray(N)?N:[N]}function D(N,h,O){return N===!0||N===void 0?h:N||O&&h}},69425:function(Ze,E,_){"use strict";"use client";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(7224)),O=N(_(93967)),C=N(_(27712)),P=D(_(67294)),F=_(47419),Y=N(_(14104)),V=N(_(23461));const Q=K=>{const{prefixCls:U,"aria-label":Z,className:J,style:H,direction:ve,maxLength:Te,autoSize:ye=!0,value:Ve,onSave:Re,onCancel:Ae,onEnd:ae,component:ee,enterIcon:me=P.createElement(h.default,null)}=K,ge=P.useRef(null),fe=P.useRef(!1),Et=P.useRef(),[xe,je]=P.useState(Ve);P.useEffect(()=>{je(Ve)},[Ve]),P.useEffect(()=>{if(ge.current&&ge.current.resizableTextArea){const{textArea:vr}=ge.current.resizableTextArea;vr.focus();const{length:dn}=vr.value;vr.setSelectionRange(dn,dn)}},[]);const ue=vr=>{let{target:dn}=vr;je(dn.value.replace(/[\n\r]/g,""))},Pe=()=>{fe.current=!0},we=()=>{fe.current=!1},nt=vr=>{let{keyCode:dn}=vr;fe.current||(Et.current=dn)},at=()=>{Re(xe.trim())},vt=vr=>{let{keyCode:dn,ctrlKey:tn,altKey:un,metaKey:yn,shiftKey:Vt}=vr;Et.current===dn&&!fe.current&&!tn&&!un&&!yn&&!Vt&&(dn===C.default.ENTER?(at(),ae==null||ae()):dn===C.default.ESC&&Ae())},Tt=()=>{at()},ze=ee?`${U}-${ee}`:"",[gr,At,hn]=(0,V.default)(U),Wr=(0,O.default)(U,`${U}-edit-content`,{[`${U}-rtl`]:ve==="rtl"},J,ze,At,hn);return gr(P.createElement("div",{className:Wr,style:H},P.createElement(Y.default,{ref:ge,maxLength:Te,value:xe,onChange:ue,onKeyDown:nt,onKeyUp:vt,onCompositionStart:Pe,onCompositionEnd:we,onBlur:Tt,"aria-label":Z,rows:1,autoSize:ye}),me!==null?(0,F.cloneElement)(me,{className:`${U}-edit-content-confirm`}):null))};var k=E.default=Q},34528:function(Ze,E,_){"use strict";var D,N=_(64836).default,h=_(75263).default;D={value:!0},E.Z=void 0;var O=h(_(67294)),C=_(13594),P=N(_(28460)),F=function(k,K){var U={};for(var Z in k)Object.prototype.hasOwnProperty.call(k,Z)&&K.indexOf(Z)<0&&(U[Z]=k[Z]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function")for(var J=0,Z=Object.getOwnPropertySymbols(k);J<Z.length;J++)K.indexOf(Z[J])<0&&Object.prototype.propertyIsEnumerable.call(k,Z[J])&&(U[Z[J]]=k[Z[J]]);return U};const Y=[1,2,3,4,5],V=O.forwardRef((k,K)=>{const{level:U=1}=k,Z=F(k,["level"]);let J;return Y.includes(U)?J=`h${U}`:J="h1",O.createElement(P.default,Object.assign({ref:K},Z,{component:J}))});var Q=E.Z=V},89652:function(Ze,E,_){"use strict";"use client";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var h=N(_(67294)),O=D(_(93967)),C=_(75531),P=_(13594),F=_(31929),Y=D(_(23461)),V=function(K,U){var Z={};for(var J in K)Object.prototype.hasOwnProperty.call(K,J)&&U.indexOf(J)<0&&(Z[J]=K[J]);if(K!=null&&typeof Object.getOwnPropertySymbols=="function")for(var H=0,J=Object.getOwnPropertySymbols(K);H<J.length;H++)U.indexOf(J[H])<0&&Object.prototype.propertyIsEnumerable.call(K,J[H])&&(Z[J[H]]=K[J[H]]);return Z};const Q=h.forwardRef((K,U)=>{const{prefixCls:Z,component:J="article",className:H,rootClassName:ve,setContentRef:Te,children:ye,direction:Ve,style:Re}=K,Ae=V(K,["prefixCls","component","className","rootClassName","setContentRef","children","direction","style"]),{getPrefixCls:ae,direction:ee,typography:me}=h.useContext(F.ConfigContext),ge=Ve!=null?Ve:ee;let fe=U;Te&&(fe=(0,C.composeRef)(U,Te));const Et=ae("typography",Z),[xe,je,ue]=(0,Y.default)(Et),Pe=(0,O.default)(Et,me==null?void 0:me.className,{[`${Et}-rtl`]:ge==="rtl"},H,ve,je,ue),we=Object.assign(Object.assign({},me==null?void 0:me.style),Re);return xe(h.createElement(J,Object.assign({className:Pe,style:we,ref:fe},Ae),ye))});var k=E.default=Q},92759:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=h;var N=D(_(67294));function h(O,C){return N.useMemo(()=>{const P=!!O;return[P,Object.assign(Object.assign({},C),P&&typeof O=="object"?O:null)]},[O])}},67312:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(67294));const h=(C,P)=>{const F=N.useRef(!1);N.useEffect(()=>{F.current?C():F.current=!0},P)};var O=E.default=h},23461:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.prepareComponentToken=E.default=void 0;var D=_(98078),N=_(3184),h=_(48385);const O=F=>{const{componentCls:Y,titleMarginTop:V}=F;return{[Y]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:F.colorText,wordBreak:"break-word",lineHeight:F.lineHeight,[`&${Y}-secondary`]:{color:F.colorTextDescription},[`&${Y}-success`]:{color:F.colorSuccess},[`&${Y}-warning`]:{color:F.colorWarning},[`&${Y}-danger`]:{color:F.colorError,"a&:active, a&:focus":{color:F.colorErrorActive},"a&:hover":{color:F.colorErrorHover}},[`&${Y}-disabled`]:{color:F.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},[`
        div&,
        p
      `]:{marginBottom:"1em"}},(0,h.getTitleStyles)(F)),{[`
      & + h1${Y},
      & + h2${Y},
      & + h3${Y},
      & + h4${Y},
      & + h5${Y}
      `]:{marginTop:V},[`
      div,
      ul,
      li,
      p,
      h1,
      h2,
      h3,
      h4,
      h5`]:{[`
        + h1,
        + h2,
        + h3,
        + h4,
        + h5
        `]:{marginTop:V}}}),(0,h.getResetStyles)(F)),(0,h.getLinkStyles)(F)),{[`
        ${Y}-expand,
        ${Y}-edit,
        ${Y}-copy
      `]:Object.assign(Object.assign({},(0,D.operationUnit)(F)),{marginInlineStart:F.marginXXS})}),(0,h.getEditableStyles)(F)),(0,h.getCopyableStyles)(F)),(0,h.getEllipsisStyles)()),{"&-rtl":{direction:"rtl"}})}},C=()=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em"});E.prepareComponentToken=C;var P=E.default=(0,N.genStyleHooks)("Typography",F=>[O(F)],C)},48385:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.getTitleStyles=E.getResetStyles=E.getLinkStyles=E.getEllipsisStyles=E.getEditableStyles=E.getCopyableStyles=void 0;var D=_(78589),N=_(6731),h=_(98078);const O=(k,K,U,Z)=>{const{titleMarginBottom:J,fontWeightStrong:H}=Z;return{marginBottom:J,color:U,fontWeight:H,fontSize:k,lineHeight:K}},C=k=>{const K=[1,2,3,4,5],U={};return K.forEach(Z=>{U[`
      h${Z}&,
      div&-h${Z},
      div&-h${Z} > textarea,
      h${Z}
    `]=O(k[`fontSizeHeading${Z}`],k[`lineHeightHeading${Z}`],k.colorTextHeading,k)}),U};E.getTitleStyles=C;const P=k=>{const{componentCls:K}=k;return{"a&, a":Object.assign(Object.assign({},(0,h.operationUnit)(k)),{textDecoration:k.linkDecoration,"&:active, &:hover":{textDecoration:k.linkHoverDecoration},[`&[disabled], &${K}-disabled`]:{color:k.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:k.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}};E.getLinkStyles=P;const F=k=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:k.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:k.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:D.gold[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:k.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}});E.getResetStyles=F;const Y=k=>{const{componentCls:K,paddingSM:U}=k,Z=U;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:k.calc(k.paddingSM).mul(-1).equal(),marginTop:k.calc(Z).mul(-1).equal(),marginBottom:`calc(1em - ${(0,N.unit)(Z)})`},[`${K}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:k.calc(k.marginXS).add(2).equal(),insetBlockEnd:k.marginXS,color:k.colorTextDescription,fontWeight:"normal",fontSize:k.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}};E.getEditableStyles=Y;const V=k=>({[`${k.componentCls}-copy-success`]:{[`
    &,
    &:hover,
    &:focus`]:{color:k.colorSuccess}},[`${k.componentCls}-copy-icon-only`]:{marginInlineStart:0}});E.getCopyableStyles=V;const Q=()=>({[`
  a&-ellipsis,
  span&-ellipsis
  `]:{display:"inline-block",maxWidth:"100%"},"&-single-line":{whiteSpace:"nowrap"},"&-ellipsis-single-line":{overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"},"> code":{paddingBlock:0,maxWidth:"calc(100% - 1.2em)",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"bottom",boxSizing:"content-box"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}});E.getEllipsisStyles=Q},87629:function(Ze,E,_){"use strict";"use client";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(36245)),h=E.default=N.default},36245:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var _=E.default="5.15.2"},83874:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const D=N(_(71079));function N(O){return O&&O.__esModule?O:{default:O}}const h=D;E.default=h,Ze.exports=h},43273:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const D=N(_(72225));function N(O){return O&&O.__esModule?O:{default:O}}const h=D;E.default=h,Ze.exports=h},90091:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const D=N(_(29539));function N(O){return O&&O.__esModule?O:{default:O}}const h=D;E.default=h,Ze.exports=h},10875:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const D=N(_(54825));function N(O){return O&&O.__esModule?O:{default:O}}const h=D;E.default=h,Ze.exports=h},7224:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;const D=N(_(43552));function N(O){return O&&O.__esModule?O:{default:O}}const h=D;E.default=h,Ze.exports=h},26545:function(Ze,E,_){"use client";"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return ee}});var D=U(_(67294)),N=k(_(93967)),h=_(78589),O=k(_(13357)),C=k(_(46648)),P=_(46338),F=_(49458);function Y(me,ge){(ge==null||ge>me.length)&&(ge=me.length);for(var fe=0,Et=new Array(ge);fe<ge;fe++)Et[fe]=me[fe];return Et}function V(me){if(Array.isArray(me))return me}function Q(me,ge,fe){return ge in me?Object.defineProperty(me,ge,{value:fe,enumerable:!0,configurable:!0,writable:!0}):me[ge]=fe,me}function k(me){return me&&me.__esModule?me:{default:me}}function K(me){if(typeof WeakMap!="function")return null;var ge=new WeakMap,fe=new WeakMap;return(K=function(Et){return Et?fe:ge})(me)}function U(me,ge){if(!ge&&me&&me.__esModule)return me;if(me===null||typeof me!="object"&&typeof me!="function")return{default:me};var fe=K(ge);if(fe&&fe.has(me))return fe.get(me);var Et={__proto__:null},xe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var je in me)if(je!=="default"&&Object.prototype.hasOwnProperty.call(me,je)){var ue=xe?Object.getOwnPropertyDescriptor(me,je):null;ue&&(ue.get||ue.set)?Object.defineProperty(Et,je,ue):Et[je]=me[je]}return Et.default=me,fe&&fe.set(me,Et),Et}function Z(me,ge){var fe=me==null?null:typeof Symbol!="undefined"&&me[Symbol.iterator]||me["@@iterator"];if(fe!=null){var Et=[],xe=!0,je=!1,ue,Pe;try{for(fe=fe.call(me);!(xe=(ue=fe.next()).done)&&(Et.push(ue.value),!(ge&&Et.length===ge));xe=!0);}catch(we){je=!0,Pe=we}finally{try{!xe&&fe.return!=null&&fe.return()}finally{if(je)throw Pe}}return Et}}function J(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function H(me){for(var ge=1;ge<arguments.length;ge++){var fe=arguments[ge]!=null?arguments[ge]:{},Et=Object.keys(fe);typeof Object.getOwnPropertySymbols=="function"&&(Et=Et.concat(Object.getOwnPropertySymbols(fe).filter(function(xe){return Object.getOwnPropertyDescriptor(fe,xe).enumerable}))),Et.forEach(function(xe){Q(me,xe,fe[xe])})}return me}function ve(me,ge){var fe=Object.keys(me);if(Object.getOwnPropertySymbols){var Et=Object.getOwnPropertySymbols(me);ge&&(Et=Et.filter(function(xe){return Object.getOwnPropertyDescriptor(me,xe).enumerable})),fe.push.apply(fe,Et)}return fe}function Te(me,ge){return ge=ge!=null?ge:{},Object.getOwnPropertyDescriptors?Object.defineProperties(me,Object.getOwnPropertyDescriptors(ge)):ve(Object(ge)).forEach(function(fe){Object.defineProperty(me,fe,Object.getOwnPropertyDescriptor(ge,fe))}),me}function ye(me,ge){if(me==null)return{};var fe=Ve(me,ge),Et,xe;if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(me);for(xe=0;xe<je.length;xe++)Et=je[xe],!(ge.indexOf(Et)>=0)&&Object.prototype.propertyIsEnumerable.call(me,Et)&&(fe[Et]=me[Et])}return fe}function Ve(me,ge){if(me==null)return{};var fe={},Et=Object.keys(me),xe,je;for(je=0;je<Et.length;je++)xe=Et[je],!(ge.indexOf(xe)>=0)&&(fe[xe]=me[xe]);return fe}function Re(me,ge){return V(me)||Z(me,ge)||Ae(me,ge)||J()}function Ae(me,ge){if(me){if(typeof me=="string")return Y(me,ge);var fe=Object.prototype.toString.call(me).slice(8,-1);if(fe==="Object"&&me.constructor&&(fe=me.constructor.name),fe==="Map"||fe==="Set")return Array.from(fe);if(fe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(fe))return Y(me,ge)}}(0,P.setTwoToneColor)(h.blue.primary);var ae=D.forwardRef(function(me,ge){var fe=me.className,Et=me.icon,xe=me.spin,je=me.rotate,ue=me.tabIndex,Pe=me.onClick,we=me.twoToneColor,nt=ye(me,["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"]),at=D.useContext(O.default),vt=at.prefixCls,Tt=vt===void 0?"anticon":vt,ze=at.rootClassName,gr,At=(0,N.default)(ze,Tt,(gr={},Q(gr,"".concat(Tt,"-").concat(Et.name),!!Et.name),Q(gr,"".concat(Tt,"-spin"),!!xe||Et.name==="loading"),gr),fe),hn=ue;hn===void 0&&Pe&&(hn=-1);var Wr=je?{msTransform:"rotate(".concat(je,"deg)"),transform:"rotate(".concat(je,"deg)")}:void 0,vr=Re((0,F.normalizeTwoToneColors)(we),2),dn=vr[0],tn=vr[1];return D.createElement("span",Te(H({role:"img","aria-label":Et.name},nt),{ref:ge,tabIndex:hn,onClick:Pe,className:At}),D.createElement(C.default,{icon:Et,primaryColor:dn,secondaryColor:tn,style:Wr}))});ae.displayName="AntdIcon",ae.getTwoToneColor=P.getTwoToneColor,ae.setTwoToneColor=P.setTwoToneColor;var ee=ae},13357:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return h}});var D=_(67294),N=(0,D.createContext)({}),h=N},46648:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return J}});var D=C(_(67294)),N=_(49458);function h(H,ve,Te){return ve in H?Object.defineProperty(H,ve,{value:Te,enumerable:!0,configurable:!0,writable:!0}):H[ve]=Te,H}function O(H){if(typeof WeakMap!="function")return null;var ve=new WeakMap,Te=new WeakMap;return(O=function(ye){return ye?Te:ve})(H)}function C(H,ve){if(!ve&&H&&H.__esModule)return H;if(H===null||typeof H!="object"&&typeof H!="function")return{default:H};var Te=O(ve);if(Te&&Te.has(H))return Te.get(H);var ye={__proto__:null},Ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Re in H)if(Re!=="default"&&Object.prototype.hasOwnProperty.call(H,Re)){var Ae=Ve?Object.getOwnPropertyDescriptor(H,Re):null;Ae&&(Ae.get||Ae.set)?Object.defineProperty(ye,Re,Ae):ye[Re]=H[Re]}return ye.default=H,Te&&Te.set(H,ye),ye}function P(H){for(var ve=1;ve<arguments.length;ve++){var Te=arguments[ve]!=null?arguments[ve]:{},ye=Object.keys(Te);typeof Object.getOwnPropertySymbols=="function"&&(ye=ye.concat(Object.getOwnPropertySymbols(Te).filter(function(Ve){return Object.getOwnPropertyDescriptor(Te,Ve).enumerable}))),ye.forEach(function(Ve){h(H,Ve,Te[Ve])})}return H}function F(H,ve){var Te=Object.keys(H);if(Object.getOwnPropertySymbols){var ye=Object.getOwnPropertySymbols(H);ve&&(ye=ye.filter(function(Ve){return Object.getOwnPropertyDescriptor(H,Ve).enumerable})),Te.push.apply(Te,ye)}return Te}function Y(H,ve){return ve=ve!=null?ve:{},Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(ve)):F(Object(ve)).forEach(function(Te){Object.defineProperty(H,Te,Object.getOwnPropertyDescriptor(ve,Te))}),H}function V(H,ve){if(H==null)return{};var Te=Q(H,ve),ye,Ve;if(Object.getOwnPropertySymbols){var Re=Object.getOwnPropertySymbols(H);for(Ve=0;Ve<Re.length;Ve++)ye=Re[Ve],!(ve.indexOf(ye)>=0)&&Object.prototype.propertyIsEnumerable.call(H,ye)&&(Te[ye]=H[ye])}return Te}function Q(H,ve){if(H==null)return{};var Te={},ye=Object.keys(H),Ve,Re;for(Re=0;Re<ye.length;Re++)Ve=ye[Re],!(ve.indexOf(Ve)>=0)&&(Te[Ve]=H[Ve]);return Te}var k={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function K(H){var ve=H.primaryColor,Te=H.secondaryColor;k.primaryColor=ve,k.secondaryColor=Te||(0,N.getSecondaryColor)(ve),k.calculated=!!Te}function U(){return P({},k)}var Z=function(H){var ve=H.icon,Te=H.className,ye=H.onClick,Ve=H.style,Re=H.primaryColor,Ae=H.secondaryColor,ae=V(H,["icon","className","onClick","style","primaryColor","secondaryColor"]),ee=D.useRef(),me=k;if(Re&&(me={primaryColor:Re,secondaryColor:Ae||(0,N.getSecondaryColor)(Re)}),(0,N.useInsertStyles)(ee),(0,N.warning)((0,N.isIconDefinition)(ve),"icon should be icon definiton, but got ".concat(ve)),!(0,N.isIconDefinition)(ve))return null;var ge=ve;return ge&&typeof ge.icon=="function"&&(ge=Y(P({},ge),{icon:ge.icon(me.primaryColor,me.secondaryColor)})),(0,N.generate)(ge.icon,"svg-".concat(ge.name),Y(P({className:Te,onClick:ye,style:Ve,"data-icon":ge.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},ae),{ref:ee}))};Z.displayName="IconReact",Z.getTwoToneColors=U,Z.setTwoToneColors=K;var J=Z},46338:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0});function D(U,Z){for(var J in Z)Object.defineProperty(U,J,{enumerable:!0,get:Z[J]})}D(E,{getTwoToneColor:function(){return K},setTwoToneColor:function(){return k}});var N=P(_(46648)),h=_(49458);function O(U,Z){(Z==null||Z>U.length)&&(Z=U.length);for(var J=0,H=new Array(Z);J<Z;J++)H[J]=U[J];return H}function C(U){if(Array.isArray(U))return U}function P(U){return U&&U.__esModule?U:{default:U}}function F(U,Z){var J=U==null?null:typeof Symbol!="undefined"&&U[Symbol.iterator]||U["@@iterator"];if(J!=null){var H=[],ve=!0,Te=!1,ye,Ve;try{for(J=J.call(U);!(ve=(ye=J.next()).done)&&(H.push(ye.value),!(Z&&H.length===Z));ve=!0);}catch(Re){Te=!0,Ve=Re}finally{try{!ve&&J.return!=null&&J.return()}finally{if(Te)throw Ve}}return H}}function Y(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(U,Z){return C(U)||F(U,Z)||Q(U,Z)||Y()}function Q(U,Z){if(U){if(typeof U=="string")return O(U,Z);var J=Object.prototype.toString.call(U).slice(8,-1);if(J==="Object"&&U.constructor&&(J=U.constructor.name),J==="Map"||J==="Set")return Array.from(J);if(J==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(J))return O(U,Z)}}function k(U){var Z=V((0,h.normalizeTwoToneColors)(U),2),J=Z[0],H=Z[1];return N.default.setTwoToneColors({primaryColor:J,secondaryColor:H})}function K(){var U=N.default.getTwoToneColors();return U.calculated?[U.primaryColor,U.secondaryColor]:U.primaryColor}},71079:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return K}});var D=F(_(67294)),N=C(_(25330)),h=C(_(26545));function O(U,Z,J){return Z in U?Object.defineProperty(U,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}):U[Z]=J,U}function C(U){return U&&U.__esModule?U:{default:U}}function P(U){if(typeof WeakMap!="function")return null;var Z=new WeakMap,J=new WeakMap;return(P=function(H){return H?J:Z})(U)}function F(U,Z){if(!Z&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var J=P(Z);if(J&&J.has(U))return J.get(U);var H={__proto__:null},ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Te in U)if(Te!=="default"&&Object.prototype.hasOwnProperty.call(U,Te)){var ye=ve?Object.getOwnPropertyDescriptor(U,Te):null;ye&&(ye.get||ye.set)?Object.defineProperty(H,Te,ye):H[Te]=U[Te]}return H.default=U,J&&J.set(U,H),H}function Y(U){for(var Z=1;Z<arguments.length;Z++){var J=arguments[Z]!=null?arguments[Z]:{},H=Object.keys(J);typeof Object.getOwnPropertySymbols=="function"&&(H=H.concat(Object.getOwnPropertySymbols(J).filter(function(ve){return Object.getOwnPropertyDescriptor(J,ve).enumerable}))),H.forEach(function(ve){O(U,ve,J[ve])})}return U}function V(U,Z){var J=Object.keys(U);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(U);Z&&(H=H.filter(function(ve){return Object.getOwnPropertyDescriptor(U,ve).enumerable})),J.push.apply(J,H)}return J}function Q(U,Z){return Z=Z!=null?Z:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(Z)):V(Object(Z)).forEach(function(J){Object.defineProperty(U,J,Object.getOwnPropertyDescriptor(Z,J))}),U}var k=function(U,Z){return D.createElement(h.default,Q(Y({},U),{ref:Z,icon:N.default}))},K=D.forwardRef(k)},72225:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return K}});var D=F(_(67294)),N=C(_(67303)),h=C(_(26545));function O(U,Z,J){return Z in U?Object.defineProperty(U,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}):U[Z]=J,U}function C(U){return U&&U.__esModule?U:{default:U}}function P(U){if(typeof WeakMap!="function")return null;var Z=new WeakMap,J=new WeakMap;return(P=function(H){return H?J:Z})(U)}function F(U,Z){if(!Z&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var J=P(Z);if(J&&J.has(U))return J.get(U);var H={__proto__:null},ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Te in U)if(Te!=="default"&&Object.prototype.hasOwnProperty.call(U,Te)){var ye=ve?Object.getOwnPropertyDescriptor(U,Te):null;ye&&(ye.get||ye.set)?Object.defineProperty(H,Te,ye):H[Te]=U[Te]}return H.default=U,J&&J.set(U,H),H}function Y(U){for(var Z=1;Z<arguments.length;Z++){var J=arguments[Z]!=null?arguments[Z]:{},H=Object.keys(J);typeof Object.getOwnPropertySymbols=="function"&&(H=H.concat(Object.getOwnPropertySymbols(J).filter(function(ve){return Object.getOwnPropertyDescriptor(J,ve).enumerable}))),H.forEach(function(ve){O(U,ve,J[ve])})}return U}function V(U,Z){var J=Object.keys(U);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(U);Z&&(H=H.filter(function(ve){return Object.getOwnPropertyDescriptor(U,ve).enumerable})),J.push.apply(J,H)}return J}function Q(U,Z){return Z=Z!=null?Z:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(Z)):V(Object(Z)).forEach(function(J){Object.defineProperty(U,J,Object.getOwnPropertyDescriptor(Z,J))}),U}var k=function(U,Z){return D.createElement(h.default,Q(Y({},U),{ref:Z,icon:N.default}))},K=D.forwardRef(k)},29539:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return K}});var D=F(_(67294)),N=C(_(83647)),h=C(_(26545));function O(U,Z,J){return Z in U?Object.defineProperty(U,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}):U[Z]=J,U}function C(U){return U&&U.__esModule?U:{default:U}}function P(U){if(typeof WeakMap!="function")return null;var Z=new WeakMap,J=new WeakMap;return(P=function(H){return H?J:Z})(U)}function F(U,Z){if(!Z&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var J=P(Z);if(J&&J.has(U))return J.get(U);var H={__proto__:null},ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Te in U)if(Te!=="default"&&Object.prototype.hasOwnProperty.call(U,Te)){var ye=ve?Object.getOwnPropertyDescriptor(U,Te):null;ye&&(ye.get||ye.set)?Object.defineProperty(H,Te,ye):H[Te]=U[Te]}return H.default=U,J&&J.set(U,H),H}function Y(U){for(var Z=1;Z<arguments.length;Z++){var J=arguments[Z]!=null?arguments[Z]:{},H=Object.keys(J);typeof Object.getOwnPropertySymbols=="function"&&(H=H.concat(Object.getOwnPropertySymbols(J).filter(function(ve){return Object.getOwnPropertyDescriptor(J,ve).enumerable}))),H.forEach(function(ve){O(U,ve,J[ve])})}return U}function V(U,Z){var J=Object.keys(U);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(U);Z&&(H=H.filter(function(ve){return Object.getOwnPropertyDescriptor(U,ve).enumerable})),J.push.apply(J,H)}return J}function Q(U,Z){return Z=Z!=null?Z:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(Z)):V(Object(Z)).forEach(function(J){Object.defineProperty(U,J,Object.getOwnPropertyDescriptor(Z,J))}),U}var k=function(U,Z){return D.createElement(h.default,Q(Y({},U),{ref:Z,icon:N.default}))},K=D.forwardRef(k)},54825:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return K}});var D=F(_(67294)),N=C(_(57583)),h=C(_(26545));function O(U,Z,J){return Z in U?Object.defineProperty(U,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}):U[Z]=J,U}function C(U){return U&&U.__esModule?U:{default:U}}function P(U){if(typeof WeakMap!="function")return null;var Z=new WeakMap,J=new WeakMap;return(P=function(H){return H?J:Z})(U)}function F(U,Z){if(!Z&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var J=P(Z);if(J&&J.has(U))return J.get(U);var H={__proto__:null},ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Te in U)if(Te!=="default"&&Object.prototype.hasOwnProperty.call(U,Te)){var ye=ve?Object.getOwnPropertyDescriptor(U,Te):null;ye&&(ye.get||ye.set)?Object.defineProperty(H,Te,ye):H[Te]=U[Te]}return H.default=U,J&&J.set(U,H),H}function Y(U){for(var Z=1;Z<arguments.length;Z++){var J=arguments[Z]!=null?arguments[Z]:{},H=Object.keys(J);typeof Object.getOwnPropertySymbols=="function"&&(H=H.concat(Object.getOwnPropertySymbols(J).filter(function(ve){return Object.getOwnPropertyDescriptor(J,ve).enumerable}))),H.forEach(function(ve){O(U,ve,J[ve])})}return U}function V(U,Z){var J=Object.keys(U);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(U);Z&&(H=H.filter(function(ve){return Object.getOwnPropertyDescriptor(U,ve).enumerable})),J.push.apply(J,H)}return J}function Q(U,Z){return Z=Z!=null?Z:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(Z)):V(Object(Z)).forEach(function(J){Object.defineProperty(U,J,Object.getOwnPropertyDescriptor(Z,J))}),U}var k=function(U,Z){return D.createElement(h.default,Q(Y({},U),{ref:Z,icon:N.default}))},K=D.forwardRef(k)},43552:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),Object.defineProperty(E,"default",{enumerable:!0,get:function(){return K}});var D=F(_(67294)),N=C(_(29260)),h=C(_(26545));function O(U,Z,J){return Z in U?Object.defineProperty(U,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}):U[Z]=J,U}function C(U){return U&&U.__esModule?U:{default:U}}function P(U){if(typeof WeakMap!="function")return null;var Z=new WeakMap,J=new WeakMap;return(P=function(H){return H?J:Z})(U)}function F(U,Z){if(!Z&&U&&U.__esModule)return U;if(U===null||typeof U!="object"&&typeof U!="function")return{default:U};var J=P(Z);if(J&&J.has(U))return J.get(U);var H={__proto__:null},ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Te in U)if(Te!=="default"&&Object.prototype.hasOwnProperty.call(U,Te)){var ye=ve?Object.getOwnPropertyDescriptor(U,Te):null;ye&&(ye.get||ye.set)?Object.defineProperty(H,Te,ye):H[Te]=U[Te]}return H.default=U,J&&J.set(U,H),H}function Y(U){for(var Z=1;Z<arguments.length;Z++){var J=arguments[Z]!=null?arguments[Z]:{},H=Object.keys(J);typeof Object.getOwnPropertySymbols=="function"&&(H=H.concat(Object.getOwnPropertySymbols(J).filter(function(ve){return Object.getOwnPropertyDescriptor(J,ve).enumerable}))),H.forEach(function(ve){O(U,ve,J[ve])})}return U}function V(U,Z){var J=Object.keys(U);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(U);Z&&(H=H.filter(function(ve){return Object.getOwnPropertyDescriptor(U,ve).enumerable})),J.push.apply(J,H)}return J}function Q(U,Z){return Z=Z!=null?Z:{},Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(Z)):V(Object(Z)).forEach(function(J){Object.defineProperty(U,J,Object.getOwnPropertyDescriptor(Z,J))}),U}var k=function(U,Z){return D.createElement(h.default,Q(Y({},U),{ref:Z,icon:N.default}))},K=D.forwardRef(k)},49458:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0});function D(ae,ee){for(var me in ee)Object.defineProperty(ae,me,{enumerable:!0,get:ee[me]})}D(E,{generate:function(){return ve},getSecondaryColor:function(){return Te},iconStyles:function(){return Re},isIconDefinition:function(){return J},normalizeAttrs:function(){return H},normalizeTwoToneColors:function(){return ye},svgBaseProps:function(){return Ve},useInsertStyles:function(){return Ae},warning:function(){return Z}});var N=_(78589),h=_(93399),O=_(63298),C=V(_(45520)),P=k(_(67294)),F=V(_(13357));function Y(ae,ee,me){return ee in ae?Object.defineProperty(ae,ee,{value:me,enumerable:!0,configurable:!0,writable:!0}):ae[ee]=me,ae}function V(ae){return ae&&ae.__esModule?ae:{default:ae}}function Q(ae){if(typeof WeakMap!="function")return null;var ee=new WeakMap,me=new WeakMap;return(Q=function(ge){return ge?me:ee})(ae)}function k(ae,ee){if(!ee&&ae&&ae.__esModule)return ae;if(ae===null||typeof ae!="object"&&typeof ae!="function")return{default:ae};var me=Q(ee);if(me&&me.has(ae))return me.get(ae);var ge={__proto__:null},fe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Et in ae)if(Et!=="default"&&Object.prototype.hasOwnProperty.call(ae,Et)){var xe=fe?Object.getOwnPropertyDescriptor(ae,Et):null;xe&&(xe.get||xe.set)?Object.defineProperty(ge,Et,xe):ge[Et]=ae[Et]}return ge.default=ae,me&&me.set(ae,ge),ge}function K(ae){for(var ee=1;ee<arguments.length;ee++){var me=arguments[ee]!=null?arguments[ee]:{},ge=Object.keys(me);typeof Object.getOwnPropertySymbols=="function"&&(ge=ge.concat(Object.getOwnPropertySymbols(me).filter(function(fe){return Object.getOwnPropertyDescriptor(me,fe).enumerable}))),ge.forEach(function(fe){Y(ae,fe,me[fe])})}return ae}function U(ae){return ae.replace(/-(.)/g,function(ee,me){return me.toUpperCase()})}function Z(ae,ee){(0,C.default)(ae,"[@ant-design/icons] ".concat(ee))}function J(ae){return typeof ae=="object"&&typeof ae.name=="string"&&typeof ae.theme=="string"&&(typeof ae.icon=="object"||typeof ae.icon=="function")}function H(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(ae).reduce(function(ee,me){var ge=ae[me];switch(me){case"class":ee.className=ge,delete ee.class;break;default:delete ee[me],ee[U(me)]=ge}return ee},{})}function ve(ae,ee,me){return me?P.default.createElement(ae.tag,K({key:ee},H(ae.attrs),me),(ae.children||[]).map(function(ge,fe){return ve(ge,"".concat(ee,"-").concat(ae.tag,"-").concat(fe))})):P.default.createElement(ae.tag,K({key:ee},H(ae.attrs)),(ae.children||[]).map(function(ge,fe){return ve(ge,"".concat(ee,"-").concat(ae.tag,"-").concat(fe))}))}function Te(ae){return(0,N.generate)(ae)[0]}function ye(ae){return ae?Array.isArray(ae)?ae:[ae]:[]}var Ve={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},Re=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Ae=function(ae){var ee=(0,P.useContext)(F.default),me=ee.csp,ge=ee.prefixCls,fe=Re;ge&&(fe=fe.replace(/anticon/g,ge)),(0,P.useEffect)(function(){var Et=ae.current,xe=(0,O.getShadowRoot)(Et);(0,h.updateCSS)(fe,"@ant-design-icons",{prepend:!0,csp:me,attachTo:xe})},[])}},98129:function(Ze,E,_){"use strict";var D=_(60690);Ze.exports=function(O){O=O||{};var C=O.reporter,P=D.getOption(O,"async",!0),F=D.getOption(O,"auto",!0);F&&!P&&(C&&C.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),P=!0);var Y=N(),V,Q=!1;function k(Te,ye){!Q&&F&&P&&Y.size()===0&&Z(),Y.add(Te,ye)}function K(){for(Q=!0;Y.size();){var Te=Y;Y=N(),Te.process()}Q=!1}function U(Te){Q||(Te===void 0&&(Te=P),V&&(H(V),V=null),Te?Z():K())}function Z(){V=ve(K)}function J(){Y={},batchSize=0,topLevel=0,bottomLevel=0}function H(Te){var ye=clearTimeout;return ye(Te)}function ve(Te){var ye=function(Ve){return setTimeout(Ve,0)};return ye(Te)}return{add:k,force:U}};function N(){var h={},O=0,C=0,P=0;function F(Q,k){k||(k=Q,Q=0),Q>C?C=Q:Q<P&&(P=Q),h[Q]||(h[Q]=[]),h[Q].push(k),O++}function Y(){for(var Q=P;Q<=C;Q++)for(var k=h[Q],K=0;K<k.length;K++){var U=k[K];U()}}function V(){return O}return{add:F,process:Y,size:V}}},60690:function(Ze){"use strict";var E=Ze.exports={};E.getOption=_;function _(D,N,h){var O=D[N];return O==null&&h!==void 0?h:O}},9187:function(Ze){"use strict";Ze.exports=E,Ze.exports.default=E;function E(ue,Pe,we){we=we||2;var nt=Pe&&Pe.length,at=nt?Pe[0]*we:ue.length,vt=_(ue,0,at,we,!0),Tt=[];if(!vt||vt.next===vt.prev)return Tt;var ze,gr,At,hn,Wr,vr,dn;if(nt&&(vt=F(ue,Pe,vt,we)),ue.length>80*we){ze=At=ue[0],gr=hn=ue[1];for(var tn=we;tn<at;tn+=we)Wr=ue[tn],vr=ue[tn+1],Wr<ze&&(ze=Wr),vr<gr&&(gr=vr),Wr>At&&(At=Wr),vr>hn&&(hn=vr);dn=Math.max(At-ze,hn-gr),dn=dn!==0?32767/dn:0}return N(vt,Tt,we,ze,gr,dn,0),Tt}function _(ue,Pe,we,nt,at){var vt,Tt;if(at===je(ue,Pe,we,nt)>0)for(vt=Pe;vt<we;vt+=nt)Tt=fe(vt,ue[vt],ue[vt+1],Tt);else for(vt=we-nt;vt>=Pe;vt-=nt)Tt=fe(vt,ue[vt],ue[vt+1],Tt);return Tt&&ye(Tt,Tt.next)&&(Et(Tt),Tt=Tt.next),Tt}function D(ue,Pe){if(!ue)return ue;Pe||(Pe=ue);var we=ue,nt;do if(nt=!1,!we.steiner&&(ye(we,we.next)||Te(we.prev,we,we.next)===0)){if(Et(we),we=Pe=we.prev,we===we.next)break;nt=!0}else we=we.next;while(nt||we!==Pe);return Pe}function N(ue,Pe,we,nt,at,vt,Tt){if(ue){!Tt&&vt&&K(ue,nt,at,vt);for(var ze=ue,gr,At;ue.prev!==ue.next;){if(gr=ue.prev,At=ue.next,vt?O(ue,nt,at,vt):h(ue)){Pe.push(gr.i/we|0),Pe.push(ue.i/we|0),Pe.push(At.i/we|0),Et(ue),ue=At.next,ze=At.next;continue}if(ue=At,ue===ze){Tt?Tt===1?(ue=C(D(ue),Pe,we),N(ue,Pe,we,nt,at,vt,2)):Tt===2&&P(ue,Pe,we,nt,at,vt):N(D(ue),Pe,we,nt,at,vt,1);break}}}}function h(ue){var Pe=ue.prev,we=ue,nt=ue.next;if(Te(Pe,we,nt)>=0)return!1;for(var at=Pe.x,vt=we.x,Tt=nt.x,ze=Pe.y,gr=we.y,At=nt.y,hn=at<vt?at<Tt?at:Tt:vt<Tt?vt:Tt,Wr=ze<gr?ze<At?ze:At:gr<At?gr:At,vr=at>vt?at>Tt?at:Tt:vt>Tt?vt:Tt,dn=ze>gr?ze>At?ze:At:gr>At?gr:At,tn=nt.next;tn!==Pe;){if(tn.x>=hn&&tn.x<=vr&&tn.y>=Wr&&tn.y<=dn&&H(at,ze,vt,gr,Tt,At,tn.x,tn.y)&&Te(tn.prev,tn,tn.next)>=0)return!1;tn=tn.next}return!0}function O(ue,Pe,we,nt){var at=ue.prev,vt=ue,Tt=ue.next;if(Te(at,vt,Tt)>=0)return!1;for(var ze=at.x,gr=vt.x,At=Tt.x,hn=at.y,Wr=vt.y,vr=Tt.y,dn=ze<gr?ze<At?ze:At:gr<At?gr:At,tn=hn<Wr?hn<vr?hn:vr:Wr<vr?Wr:vr,un=ze>gr?ze>At?ze:At:gr>At?gr:At,yn=hn>Wr?hn>vr?hn:vr:Wr>vr?Wr:vr,Vt=Z(dn,tn,Pe,we,nt),dr=Z(un,yn,Pe,we,nt),wt=ue.prevZ,He=ue.nextZ;wt&&wt.z>=Vt&&He&&He.z<=dr;){if(wt.x>=dn&&wt.x<=un&&wt.y>=tn&&wt.y<=yn&&wt!==at&&wt!==Tt&&H(ze,hn,gr,Wr,At,vr,wt.x,wt.y)&&Te(wt.prev,wt,wt.next)>=0||(wt=wt.prevZ,He.x>=dn&&He.x<=un&&He.y>=tn&&He.y<=yn&&He!==at&&He!==Tt&&H(ze,hn,gr,Wr,At,vr,He.x,He.y)&&Te(He.prev,He,He.next)>=0))return!1;He=He.nextZ}for(;wt&&wt.z>=Vt;){if(wt.x>=dn&&wt.x<=un&&wt.y>=tn&&wt.y<=yn&&wt!==at&&wt!==Tt&&H(ze,hn,gr,Wr,At,vr,wt.x,wt.y)&&Te(wt.prev,wt,wt.next)>=0)return!1;wt=wt.prevZ}for(;He&&He.z<=dr;){if(He.x>=dn&&He.x<=un&&He.y>=tn&&He.y<=yn&&He!==at&&He!==Tt&&H(ze,hn,gr,Wr,At,vr,He.x,He.y)&&Te(He.prev,He,He.next)>=0)return!1;He=He.nextZ}return!0}function C(ue,Pe,we){var nt=ue;do{var at=nt.prev,vt=nt.next.next;!ye(at,vt)&&Ve(at,nt,nt.next,vt)&&ee(at,vt)&&ee(vt,at)&&(Pe.push(at.i/we|0),Pe.push(nt.i/we|0),Pe.push(vt.i/we|0),Et(nt),Et(nt.next),nt=ue=vt),nt=nt.next}while(nt!==ue);return D(nt)}function P(ue,Pe,we,nt,at,vt){var Tt=ue;do{for(var ze=Tt.next.next;ze!==Tt.prev;){if(Tt.i!==ze.i&&ve(Tt,ze)){var gr=ge(Tt,ze);Tt=D(Tt,Tt.next),gr=D(gr,gr.next),N(Tt,Pe,we,nt,at,vt,0),N(gr,Pe,we,nt,at,vt,0);return}ze=ze.next}Tt=Tt.next}while(Tt!==ue)}function F(ue,Pe,we,nt){var at=[],vt,Tt,ze,gr,At;for(vt=0,Tt=Pe.length;vt<Tt;vt++)ze=Pe[vt]*nt,gr=vt<Tt-1?Pe[vt+1]*nt:ue.length,At=_(ue,ze,gr,nt,!1),At===At.next&&(At.steiner=!0),at.push(J(At));for(at.sort(Y),vt=0;vt<at.length;vt++)we=V(at[vt],we);return we}function Y(ue,Pe){return ue.x-Pe.x}function V(ue,Pe){var we=Q(ue,Pe);if(!we)return Pe;var nt=ge(we,ue);return D(nt,nt.next),D(we,we.next)}function Q(ue,Pe){var we=Pe,nt=ue.x,at=ue.y,vt=-1/0,Tt;do{if(at<=we.y&&at>=we.next.y&&we.next.y!==we.y){var ze=we.x+(at-we.y)*(we.next.x-we.x)/(we.next.y-we.y);if(ze<=nt&&ze>vt&&(vt=ze,Tt=we.x<we.next.x?we:we.next,ze===nt))return Tt}we=we.next}while(we!==Pe);if(!Tt)return null;var gr=Tt,At=Tt.x,hn=Tt.y,Wr=1/0,vr;we=Tt;do nt>=we.x&&we.x>=At&&nt!==we.x&&H(at<hn?nt:vt,at,At,hn,at<hn?vt:nt,at,we.x,we.y)&&(vr=Math.abs(at-we.y)/(nt-we.x),ee(we,ue)&&(vr<Wr||vr===Wr&&(we.x>Tt.x||we.x===Tt.x&&k(Tt,we)))&&(Tt=we,Wr=vr)),we=we.next;while(we!==gr);return Tt}function k(ue,Pe){return Te(ue.prev,ue,Pe.prev)<0&&Te(Pe.next,ue,ue.next)<0}function K(ue,Pe,we,nt){var at=ue;do at.z===0&&(at.z=Z(at.x,at.y,Pe,we,nt)),at.prevZ=at.prev,at.nextZ=at.next,at=at.next;while(at!==ue);at.prevZ.nextZ=null,at.prevZ=null,U(at)}function U(ue){var Pe,we,nt,at,vt,Tt,ze,gr,At=1;do{for(we=ue,ue=null,vt=null,Tt=0;we;){for(Tt++,nt=we,ze=0,Pe=0;Pe<At&&(ze++,nt=nt.nextZ,!!nt);Pe++);for(gr=At;ze>0||gr>0&&nt;)ze!==0&&(gr===0||!nt||we.z<=nt.z)?(at=we,we=we.nextZ,ze--):(at=nt,nt=nt.nextZ,gr--),vt?vt.nextZ=at:ue=at,at.prevZ=vt,vt=at;we=nt}vt.nextZ=null,At*=2}while(Tt>1);return ue}function Z(ue,Pe,we,nt,at){return ue=(ue-we)*at|0,Pe=(Pe-nt)*at|0,ue=(ue|ue<<8)&16711935,ue=(ue|ue<<4)&252645135,ue=(ue|ue<<2)&858993459,ue=(ue|ue<<1)&1431655765,Pe=(Pe|Pe<<8)&16711935,Pe=(Pe|Pe<<4)&252645135,Pe=(Pe|Pe<<2)&858993459,Pe=(Pe|Pe<<1)&1431655765,ue|Pe<<1}function J(ue){var Pe=ue,we=ue;do(Pe.x<we.x||Pe.x===we.x&&Pe.y<we.y)&&(we=Pe),Pe=Pe.next;while(Pe!==ue);return we}function H(ue,Pe,we,nt,at,vt,Tt,ze){return(at-Tt)*(Pe-ze)>=(ue-Tt)*(vt-ze)&&(ue-Tt)*(nt-ze)>=(we-Tt)*(Pe-ze)&&(we-Tt)*(vt-ze)>=(at-Tt)*(nt-ze)}function ve(ue,Pe){return ue.next.i!==Pe.i&&ue.prev.i!==Pe.i&&!ae(ue,Pe)&&(ee(ue,Pe)&&ee(Pe,ue)&&me(ue,Pe)&&(Te(ue.prev,ue,Pe.prev)||Te(ue,Pe.prev,Pe))||ye(ue,Pe)&&Te(ue.prev,ue,ue.next)>0&&Te(Pe.prev,Pe,Pe.next)>0)}function Te(ue,Pe,we){return(Pe.y-ue.y)*(we.x-Pe.x)-(Pe.x-ue.x)*(we.y-Pe.y)}function ye(ue,Pe){return ue.x===Pe.x&&ue.y===Pe.y}function Ve(ue,Pe,we,nt){var at=Ae(Te(ue,Pe,we)),vt=Ae(Te(ue,Pe,nt)),Tt=Ae(Te(we,nt,ue)),ze=Ae(Te(we,nt,Pe));return!!(at!==vt&&Tt!==ze||at===0&&Re(ue,we,Pe)||vt===0&&Re(ue,nt,Pe)||Tt===0&&Re(we,ue,nt)||ze===0&&Re(we,Pe,nt))}function Re(ue,Pe,we){return Pe.x<=Math.max(ue.x,we.x)&&Pe.x>=Math.min(ue.x,we.x)&&Pe.y<=Math.max(ue.y,we.y)&&Pe.y>=Math.min(ue.y,we.y)}function Ae(ue){return ue>0?1:ue<0?-1:0}function ae(ue,Pe){var we=ue;do{if(we.i!==ue.i&&we.next.i!==ue.i&&we.i!==Pe.i&&we.next.i!==Pe.i&&Ve(we,we.next,ue,Pe))return!0;we=we.next}while(we!==ue);return!1}function ee(ue,Pe){return Te(ue.prev,ue,ue.next)<0?Te(ue,Pe,ue.next)>=0&&Te(ue,ue.prev,Pe)>=0:Te(ue,Pe,ue.prev)<0||Te(ue,ue.next,Pe)<0}function me(ue,Pe){var we=ue,nt=!1,at=(ue.x+Pe.x)/2,vt=(ue.y+Pe.y)/2;do we.y>vt!=we.next.y>vt&&we.next.y!==we.y&&at<(we.next.x-we.x)*(vt-we.y)/(we.next.y-we.y)+we.x&&(nt=!nt),we=we.next;while(we!==ue);return nt}function ge(ue,Pe){var we=new xe(ue.i,ue.x,ue.y),nt=new xe(Pe.i,Pe.x,Pe.y),at=ue.next,vt=Pe.prev;return ue.next=Pe,Pe.prev=ue,we.next=at,at.prev=we,nt.next=we,we.prev=nt,vt.next=nt,nt.prev=vt,nt}function fe(ue,Pe,we,nt){var at=new xe(ue,Pe,we);return nt?(at.next=nt.next,at.prev=nt,nt.next.prev=at,nt.next=at):(at.prev=at,at.next=at),at}function Et(ue){ue.next.prev=ue.prev,ue.prev.next=ue.next,ue.prevZ&&(ue.prevZ.nextZ=ue.nextZ),ue.nextZ&&(ue.nextZ.prevZ=ue.prevZ)}function xe(ue,Pe,we){this.i=ue,this.x=Pe,this.y=we,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}E.deviation=function(ue,Pe,we,nt){var at=Pe&&Pe.length,vt=at?Pe[0]*we:ue.length,Tt=Math.abs(je(ue,0,vt,we));if(at)for(var ze=0,gr=Pe.length;ze<gr;ze++){var At=Pe[ze]*we,hn=ze<gr-1?Pe[ze+1]*we:ue.length;Tt-=Math.abs(je(ue,At,hn,we))}var Wr=0;for(ze=0;ze<nt.length;ze+=3){var vr=nt[ze]*we,dn=nt[ze+1]*we,tn=nt[ze+2]*we;Wr+=Math.abs((ue[vr]-ue[tn])*(ue[dn+1]-ue[vr+1])-(ue[vr]-ue[dn])*(ue[tn+1]-ue[vr+1]))}return Tt===0&&Wr===0?0:Math.abs((Wr-Tt)/Tt)};function je(ue,Pe,we,nt){for(var at=0,vt=Pe,Tt=we-nt;vt<we;vt+=nt)at+=(ue[Tt]-ue[vt])*(ue[vt+1]+ue[Tt+1]),Tt=vt;return at}E.flatten=function(ue){for(var Pe=ue[0][0].length,we={vertices:[],holes:[],dimensions:Pe},nt=0,at=0;at<ue.length;at++){for(var vt=0;vt<ue[at].length;vt++)for(var Tt=0;Tt<Pe;Tt++)we.vertices.push(ue[at][vt][Tt]);at>0&&(nt+=ue[at-1].length,we.holes.push(nt))}return we}},2268:function(Ze){"use strict";var E=Ze.exports={};E.isIE=function(_){function D(){var h=navigator.userAgent.toLowerCase();return h.indexOf("msie")!==-1||h.indexOf("trident")!==-1||h.indexOf(" edge/")!==-1}if(!D())return!1;if(!_)return!0;var N=function(){var h,O=3,C=document.createElement("div"),P=C.getElementsByTagName("i");do C.innerHTML="<!--[if gt IE "+ ++O+"]><i></i><![endif]-->";while(P[0]);return O>4?O:h}();return _===N},E.isLegacyOpera=function(){return!!window.opera}},17900:function(Ze){"use strict";var E=Ze.exports={};E.forEach=function(_,D){for(var N=0;N<_.length;N++){var h=D(_[N]);if(h)return h}}},58229:function(Ze,E,_){"use strict";var D=_(2268);Ze.exports=function(N){N=N||{};var h=N.reporter,O=N.batchProcessor,C=N.stateHandler.getState;if(!h)throw new Error("Missing required dependency: reporter.");function P(k,K){function U(){K(k)}if(D.isIE(8))C(k).object={proxy:U},k.attachEvent("onresize",U);else{var Z=V(k);if(!Z)throw new Error("Element is not detectable by this strategy.");Z.contentDocument.defaultView.addEventListener("resize",U)}}function F(k){var K=N.important?" !important; ":"; ";return(k.join(K)+K).trim()}function Y(k,K,U){U||(U=K,K=k,k=null),k=k||{};var Z=k.debug;function J(H,ve){var Te=F(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),ye=!1,Ve=window.getComputedStyle(H),Re=H.offsetWidth,Ae=H.offsetHeight;C(H).startSize={width:Re,height:Ae};function ae(){function ee(){if(Ve.position==="static"){H.style.setProperty("position","relative",k.important?"important":"");var fe=function(Et,xe,je,ue){function Pe(nt){return nt.replace(/[^-\d\.]/g,"")}var we=je[ue];we!=="auto"&&Pe(we)!=="0"&&(Et.warn("An element that is positioned static has style."+ue+"="+we+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+ue+" will be set to 0. Element: ",xe),xe.style.setProperty(ue,"0",k.important?"important":""))};fe(h,H,Ve,"top"),fe(h,H,Ve,"right"),fe(h,H,Ve,"bottom"),fe(h,H,Ve,"left")}}function me(){ye||ee();function fe(xe,je){if(!xe.contentDocument){var ue=C(xe);ue.checkForObjectDocumentTimeoutId&&window.clearTimeout(ue.checkForObjectDocumentTimeoutId),ue.checkForObjectDocumentTimeoutId=setTimeout(function(){ue.checkForObjectDocumentTimeoutId=0,fe(xe,je)},100);return}je(xe.contentDocument)}var Et=this;fe(Et,function(je){ve(H)})}Ve.position!==""&&(ee(Ve),ye=!0);var ge=document.createElement("object");ge.style.cssText=Te,ge.tabIndex=-1,ge.type="text/html",ge.setAttribute("aria-hidden","true"),ge.onload=me,D.isIE()||(ge.data="about:blank"),C(H)&&(H.appendChild(ge),C(H).object=ge,D.isIE()&&(ge.data="about:blank"))}O?O.add(ae):ae()}D.isIE(8)?U(K):J(K,U)}function V(k){return C(k).object}function Q(k){if(C(k)){var K=V(k);K&&(D.isIE(8)?k.detachEvent("onresize",K.proxy):k.removeChild(K),C(k).checkForObjectDocumentTimeoutId&&window.clearTimeout(C(k).checkForObjectDocumentTimeoutId),delete C(k).object)}}return{makeDetectable:Y,addListener:P,uninstall:Q}}},60787:function(Ze,E,_){"use strict";var D=_(17900).forEach;Ze.exports=function(N){N=N||{};var h=N.reporter,O=N.batchProcessor,C=N.stateHandler.getState,P=N.stateHandler.hasState,F=N.idHandler;if(!O)throw new Error("Missing required dependency: batchProcessor");if(!h)throw new Error("Missing required dependency: reporter.");var Y=U(),V="erd_scroll_detection_scrollbar_style",Q="erd_scroll_detection_container";function k(ae){Z(ae,V,Q)}k(window.document);function K(ae){var ee=N.important?" !important; ":"; ";return(ae.join(ee)+ee).trim()}function U(){var ae=500,ee=500,me=document.createElement("div");me.style.cssText=K(["position: absolute","width: "+ae*2+"px","height: "+ee*2+"px","visibility: hidden","margin: 0","padding: 0"]);var ge=document.createElement("div");ge.style.cssText=K(["position: absolute","width: "+ae+"px","height: "+ee+"px","overflow: scroll","visibility: none","top: "+-ae*3+"px","left: "+-ee*3+"px","visibility: hidden","margin: 0","padding: 0"]),ge.appendChild(me),document.body.insertBefore(ge,document.body.firstChild);var fe=ae-ge.clientWidth,Et=ee-ge.clientHeight;return document.body.removeChild(ge),{width:fe,height:Et}}function Z(ae,ee,me){function ge(je,ue){ue=ue||function(we){ae.head.appendChild(we)};var Pe=ae.createElement("style");return Pe.innerHTML=je,Pe.id=ee,ue(Pe),Pe}if(!ae.getElementById(ee)){var fe=me+"_animation",Et=me+"_animation_active",xe=`/* Created by the element-resize-detector library. */
`;xe+="."+me+" > div::-webkit-scrollbar { "+K(["display: none"])+` }

`,xe+="."+Et+" { "+K(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+fe,"animation-name: "+fe])+` }
`,xe+="@-webkit-keyframes "+fe+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,xe+="@keyframes "+fe+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",ge(xe)}}function J(ae){ae.className+=" "+Q+"_animation_active"}function H(ae,ee,me){if(ae.addEventListener)ae.addEventListener(ee,me);else if(ae.attachEvent)ae.attachEvent("on"+ee,me);else return h.error("[scroll] Don't know how to add event listeners.")}function ve(ae,ee,me){if(ae.removeEventListener)ae.removeEventListener(ee,me);else if(ae.detachEvent)ae.detachEvent("on"+ee,me);else return h.error("[scroll] Don't know how to remove event listeners.")}function Te(ae){return C(ae).container.childNodes[0].childNodes[0].childNodes[0]}function ye(ae){return C(ae).container.childNodes[0].childNodes[0].childNodes[1]}function Ve(ae,ee){var me=C(ae).listeners;if(!me.push)throw new Error("Cannot add listener to an element that is not detectable.");C(ae).listeners.push(ee)}function Re(ae,ee,me){me||(me=ee,ee=ae,ae=null),ae=ae||{};function ge(){if(ae.debug){var Vt=Array.prototype.slice.call(arguments);if(Vt.unshift(F.get(ee),"Scroll: "),h.log.apply)h.log.apply(null,Vt);else for(var dr=0;dr<Vt.length;dr++)h.log(Vt[dr])}}function fe(Vt){function dr(wt){var He=wt.getRootNode&&wt.getRootNode().contains(wt);return wt===wt.ownerDocument.body||wt.ownerDocument.body.contains(wt)||He}return!dr(Vt)||window.getComputedStyle(Vt)===null}function Et(Vt){var dr=C(Vt).container.childNodes[0],wt=window.getComputedStyle(dr);return!wt.width||wt.width.indexOf("px")===-1}function xe(){var Vt=window.getComputedStyle(ee),dr={};return dr.position=Vt.position,dr.width=ee.offsetWidth,dr.height=ee.offsetHeight,dr.top=Vt.top,dr.right=Vt.right,dr.bottom=Vt.bottom,dr.left=Vt.left,dr.widthCSS=Vt.width,dr.heightCSS=Vt.height,dr}function je(){var Vt=xe();C(ee).startSize={width:Vt.width,height:Vt.height},ge("Element start size",C(ee).startSize)}function ue(){C(ee).listeners=[]}function Pe(){if(ge("storeStyle invoked."),!C(ee)){ge("Aborting because element has been uninstalled");return}var Vt=xe();C(ee).style=Vt}function we(Vt,dr,wt){C(Vt).lastWidth=dr,C(Vt).lastHeight=wt}function nt(Vt){return Te(Vt).childNodes[0]}function at(){return 2*Y.width+1}function vt(){return 2*Y.height+1}function Tt(Vt){return Vt+10+at()}function ze(Vt){return Vt+10+vt()}function gr(Vt){return Vt*2+at()}function At(Vt){return Vt*2+vt()}function hn(Vt,dr,wt){var He=Te(Vt),wr=ye(Vt),Ne=Tt(dr),Xr=ze(wt),Er=gr(dr),Ue=At(wt);He.scrollLeft=Ne,He.scrollTop=Xr,wr.scrollLeft=Er,wr.scrollTop=Ue}function Wr(){var Vt=C(ee).container;if(!Vt){Vt=document.createElement("div"),Vt.className=Q,Vt.style.cssText=K(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),C(ee).container=Vt,J(Vt),ee.appendChild(Vt);var dr=function(){C(ee).onRendered&&C(ee).onRendered()};H(Vt,"animationstart",dr),C(ee).onAnimationStart=dr}return Vt}function vr(){function Vt(){var en=C(ee).style;if(en.position==="static"){ee.style.setProperty("position","relative",ae.important?"important":"");var Wn=function(De,X,se,Be){function Ye(sr){return sr.replace(/[^-\d\.]/g,"")}var ct=se[Be];ct!=="auto"&&Ye(ct)!=="0"&&(De.warn("An element that is positioned static has style."+Be+"="+ct+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Be+" will be set to 0. Element: ",X),X.style[Be]=0)};Wn(h,ee,en,"top"),Wn(h,ee,en,"right"),Wn(h,ee,en,"bottom"),Wn(h,ee,en,"left")}}function dr(en,Wn,De,X){return en=en?en+"px":"0",Wn=Wn?Wn+"px":"0",De=De?De+"px":"0",X=X?X+"px":"0",["left: "+en,"top: "+Wn,"right: "+X,"bottom: "+De]}if(ge("Injecting elements"),!C(ee)){ge("Aborting because element has been uninstalled");return}Vt();var wt=C(ee).container;wt||(wt=Wr());var He=Y.width,wr=Y.height,Ne=K(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Xr=K(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(dr(-(1+He),-(1+wr),-wr,-He))),Er=K(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Ue=K(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),In=K(["position: absolute","left: 0","top: 0"]),an=K(["position: absolute","width: 200%","height: 200%"]),Qr=document.createElement("div"),Dn=document.createElement("div"),On=document.createElement("div"),ri=document.createElement("div"),zt=document.createElement("div"),cr=document.createElement("div");Qr.dir="ltr",Qr.style.cssText=Ne,Qr.className=Q,Dn.className=Q,Dn.style.cssText=Xr,On.style.cssText=Er,ri.style.cssText=In,zt.style.cssText=Ue,cr.style.cssText=an,On.appendChild(ri),zt.appendChild(cr),Dn.appendChild(On),Dn.appendChild(zt),Qr.appendChild(Dn),wt.appendChild(Qr);function Zr(){var en=C(ee);en&&en.onExpand?en.onExpand():ge("Aborting expand scroll handler: element has been uninstalled")}function Kr(){var en=C(ee);en&&en.onShrink?en.onShrink():ge("Aborting shrink scroll handler: element has been uninstalled")}H(On,"scroll",Zr),H(zt,"scroll",Kr),C(ee).onExpandScroll=Zr,C(ee).onShrinkScroll=Kr}function dn(){function Vt(Er,Ue,In){var an=nt(Er),Qr=Tt(Ue),Dn=ze(In);an.style.setProperty("width",Qr+"px",ae.important?"important":""),an.style.setProperty("height",Dn+"px",ae.important?"important":"")}function dr(Er){var Ue=ee.offsetWidth,In=ee.offsetHeight,an=Ue!==C(ee).lastWidth||In!==C(ee).lastHeight;ge("Storing current size",Ue,In),we(ee,Ue,In),O.add(0,function(){if(an){if(!C(ee)){ge("Aborting because element has been uninstalled");return}if(!wt()){ge("Aborting because element container has not been initialized");return}if(ae.debug){var Dn=ee.offsetWidth,On=ee.offsetHeight;(Dn!==Ue||On!==In)&&h.warn(F.get(ee),"Scroll: Size changed before updating detector elements.")}Vt(ee,Ue,In)}}),O.add(1,function(){if(!C(ee)){ge("Aborting because element has been uninstalled");return}if(!wt()){ge("Aborting because element container has not been initialized");return}hn(ee,Ue,In)}),an&&Er&&O.add(2,function(){if(!C(ee)){ge("Aborting because element has been uninstalled");return}if(!wt()){ge("Aborting because element container has not been initialized");return}Er()})}function wt(){return!!C(ee).container}function He(){function Er(){return C(ee).lastNotifiedWidth===void 0}ge("notifyListenersIfNeeded invoked");var Ue=C(ee);if(Er()&&Ue.lastWidth===Ue.startSize.width&&Ue.lastHeight===Ue.startSize.height)return ge("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(Ue.lastWidth===Ue.lastNotifiedWidth&&Ue.lastHeight===Ue.lastNotifiedHeight)return ge("Not notifying: Size already notified");ge("Current size not notified, notifying..."),Ue.lastNotifiedWidth=Ue.lastWidth,Ue.lastNotifiedHeight=Ue.lastHeight,D(C(ee).listeners,function(In){In(ee)})}function wr(){if(ge("startanimation triggered."),Et(ee)){ge("Ignoring since element is still unrendered...");return}ge("Element rendered.");var Er=Te(ee),Ue=ye(ee);(Er.scrollLeft===0||Er.scrollTop===0||Ue.scrollLeft===0||Ue.scrollTop===0)&&(ge("Scrollbars out of sync. Updating detector elements..."),dr(He))}function Ne(){if(ge("Scroll detected."),Et(ee)){ge("Scroll event fired while unrendered. Ignoring...");return}dr(He)}if(ge("registerListenersAndPositionElements invoked."),!C(ee)){ge("Aborting because element has been uninstalled");return}C(ee).onRendered=wr,C(ee).onExpand=Ne,C(ee).onShrink=Ne;var Xr=C(ee).style;Vt(ee,Xr.width,Xr.height)}function tn(){if(ge("finalizeDomMutation invoked."),!C(ee)){ge("Aborting because element has been uninstalled");return}var Vt=C(ee).style;we(ee,Vt.width,Vt.height),hn(ee,Vt.width,Vt.height)}function un(){me(ee)}function yn(){ge("Installing..."),ue(),je(),O.add(0,Pe),O.add(1,vr),O.add(2,dn),O.add(3,tn),O.add(4,un)}ge("Making detectable..."),fe(ee)?(ge("Element is detached"),Wr(),ge("Waiting until element is attached..."),C(ee).onRendered=function(){ge("Element is now attached"),yn()}):yn()}function Ae(ae){var ee=C(ae);ee&&(ee.onExpandScroll&&ve(Te(ae),"scroll",ee.onExpandScroll),ee.onShrinkScroll&&ve(ye(ae),"scroll",ee.onShrinkScroll),ee.onAnimationStart&&ve(ee.container,"animationstart",ee.onAnimationStart),ee.container&&ae.removeChild(ee.container))}return{makeDetectable:Re,addListener:Ve,uninstall:Ae,initDocument:k}}},63844:function(Ze,E,_){"use strict";var D=_(17900).forEach,N=_(68452),h=_(96199),O=_(75805),C=_(79799),P=_(71724),F=_(2268),Y=_(98129),V=_(21931),Q=_(58229),k=_(60787);function K(H){return Array.isArray(H)||H.length!==void 0}function U(H){if(Array.isArray(H))return H;var ve=[];return D(H,function(Te){ve.push(Te)}),ve}function Z(H){return H&&H.nodeType===1}Ze.exports=function(H){H=H||{};var ve;if(H.idHandler)ve={get:function(nt){return H.idHandler.get(nt,!0)},set:H.idHandler.set};else{var Te=O(),ye=C({idGenerator:Te,stateHandler:V});ve=ye}var Ve=H.reporter;if(!Ve){var Re=Ve===!1;Ve=P(Re)}var Ae=J(H,"batchProcessor",Y({reporter:Ve})),ae={};ae.callOnAdd=!!J(H,"callOnAdd",!0),ae.debug=!!J(H,"debug",!1);var ee=h(ve),me=N({stateHandler:V}),ge,fe=J(H,"strategy","object"),Et=J(H,"important",!1),xe={reporter:Ve,batchProcessor:Ae,stateHandler:V,idHandler:ve,important:Et};if(fe==="scroll"&&(F.isLegacyOpera()?(Ve.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),fe="object"):F.isIE(9)&&(Ve.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),fe="object")),fe==="scroll")ge=k(xe);else if(fe==="object")ge=Q(xe);else throw new Error("Invalid strategy name: "+fe);var je={};function ue(nt,at,vt){function Tt(vr){var dn=ee.get(vr);D(dn,function(un){un(vr)})}function ze(vr,dn,tn){ee.add(dn,tn),vr&&tn(dn)}if(vt||(vt=at,at=nt,nt={}),!at)throw new Error("At least one element required.");if(!vt)throw new Error("Listener required.");if(Z(at))at=[at];else if(K(at))at=U(at);else return Ve.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var gr=0,At=J(nt,"callOnAdd",ae.callOnAdd),hn=J(nt,"onReady",function(){}),Wr=J(nt,"debug",ae.debug);D(at,function(dn){V.getState(dn)||(V.initState(dn),ve.set(dn));var tn=ve.get(dn);if(Wr&&Ve.log("Attaching listener to element",tn,dn),!me.isDetectable(dn)){if(Wr&&Ve.log(tn,"Not detectable."),me.isBusy(dn)){Wr&&Ve.log(tn,"System busy making it detectable"),ze(At,dn,vt),je[tn]=je[tn]||[],je[tn].push(function(){gr++,gr===at.length&&hn()});return}return Wr&&Ve.log(tn,"Making detectable..."),me.markBusy(dn,!0),ge.makeDetectable({debug:Wr,important:Et},dn,function(yn){if(Wr&&Ve.log(tn,"onElementDetectable"),V.getState(yn)){me.markAsDetectable(yn),me.markBusy(yn,!1),ge.addListener(yn,Tt),ze(At,yn,vt);var Vt=V.getState(yn);if(Vt&&Vt.startSize){var dr=yn.offsetWidth,wt=yn.offsetHeight;(Vt.startSize.width!==dr||Vt.startSize.height!==wt)&&Tt(yn)}je[tn]&&D(je[tn],function(He){He()})}else Wr&&Ve.log(tn,"Element uninstalled before being detectable.");delete je[tn],gr++,gr===at.length&&hn()})}Wr&&Ve.log(tn,"Already detecable, adding listener."),ze(At,dn,vt),gr++}),gr===at.length&&hn()}function Pe(nt){if(!nt)return Ve.error("At least one element is required.");if(Z(nt))nt=[nt];else if(K(nt))nt=U(nt);else return Ve.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");D(nt,function(at){ee.removeAllListeners(at),ge.uninstall(at),V.cleanState(at)})}function we(nt){ge.initDocument&&ge.initDocument(nt)}return{listenTo:ue,removeListener:ee.removeListener,removeAllListeners:ee.removeAllListeners,uninstall:Pe,initDocument:we}};function J(H,ve,Te){var ye=H[ve];return ye==null&&Te!==void 0?Te:ye}},68452:function(Ze){"use strict";Ze.exports=function(E){var _=E.stateHandler.getState;function D(C){var P=_(C);return P&&!!P.isDetectable}function N(C){_(C).isDetectable=!0}function h(C){return!!_(C).busy}function O(C,P){_(C).busy=!!P}return{isDetectable:D,markAsDetectable:N,isBusy:h,markBusy:O}}},75805:function(Ze){"use strict";Ze.exports=function(){var E=1;function _(){return E++}return{generate:_}}},79799:function(Ze){"use strict";Ze.exports=function(E){var _=E.idGenerator,D=E.stateHandler.getState;function N(O){var C=D(O);return C&&C.id!==void 0?C.id:null}function h(O){var C=D(O);if(!C)throw new Error("setId required the element to have a resize detection state.");var P=_.generate();return C.id=P,P}return{get:N,set:h}}},96199:function(Ze){"use strict";Ze.exports=function(E){var _={};function D(C){var P=E.get(C);return P===void 0?[]:_[P]||[]}function N(C,P){var F=E.get(C);_[F]||(_[F]=[]),_[F].push(P)}function h(C,P){for(var F=D(C),Y=0,V=F.length;Y<V;++Y)if(F[Y]===P){F.splice(Y,1);break}}function O(C){var P=D(C);P&&(P.length=0)}return{get:D,add:N,removeListener:h,removeAllListeners:O}}},71724:function(Ze){"use strict";Ze.exports=function(E){function _(){}var D={log:_,warn:_,error:_};if(!E&&window.console){var N=function(h,O){h[O]=function(){var P=console[O];if(P.apply)P.apply(console,arguments);else for(var F=0;F<arguments.length;F++)P(arguments[F])}};N(D,"log"),N(D,"warn"),N(D,"error")}return D}},21931:function(Ze){"use strict";var E="_erd";function _(h){return h[E]={},D(h)}function D(h){return h[E]}function N(h){delete h[E]}Ze.exports={initState:_,getState:D,cleanState:N}},26729:function(Ze){"use strict";var E=Object.prototype.hasOwnProperty,_="~";function D(){}Object.create&&(D.prototype=Object.create(null),new D().__proto__||(_=!1));function N(P,F,Y){this.fn=P,this.context=F,this.once=Y||!1}function h(P,F,Y,V,Q){if(typeof Y!="function")throw new TypeError("The listener must be a function");var k=new N(Y,V||P,Q),K=_?_+F:F;return P._events[K]?P._events[K].fn?P._events[K]=[P._events[K],k]:P._events[K].push(k):(P._events[K]=k,P._eventsCount++),P}function O(P,F){--P._eventsCount===0?P._events=new D:delete P._events[F]}function C(){this._events=new D,this._eventsCount=0}C.prototype.eventNames=function(){var F=[],Y,V;if(this._eventsCount===0)return F;for(V in Y=this._events)E.call(Y,V)&&F.push(_?V.slice(1):V);return Object.getOwnPropertySymbols?F.concat(Object.getOwnPropertySymbols(Y)):F},C.prototype.listeners=function(F){var Y=_?_+F:F,V=this._events[Y];if(!V)return[];if(V.fn)return[V.fn];for(var Q=0,k=V.length,K=new Array(k);Q<k;Q++)K[Q]=V[Q].fn;return K},C.prototype.listenerCount=function(F){var Y=_?_+F:F,V=this._events[Y];return V?V.fn?1:V.length:0},C.prototype.emit=function(F,Y,V,Q,k,K){var U=_?_+F:F;if(!this._events[U])return!1;var Z=this._events[U],J=arguments.length,H,ve;if(Z.fn){switch(Z.once&&this.removeListener(F,Z.fn,void 0,!0),J){case 1:return Z.fn.call(Z.context),!0;case 2:return Z.fn.call(Z.context,Y),!0;case 3:return Z.fn.call(Z.context,Y,V),!0;case 4:return Z.fn.call(Z.context,Y,V,Q),!0;case 5:return Z.fn.call(Z.context,Y,V,Q,k),!0;case 6:return Z.fn.call(Z.context,Y,V,Q,k,K),!0}for(ve=1,H=new Array(J-1);ve<J;ve++)H[ve-1]=arguments[ve];Z.fn.apply(Z.context,H)}else{var Te=Z.length,ye;for(ve=0;ve<Te;ve++)switch(Z[ve].once&&this.removeListener(F,Z[ve].fn,void 0,!0),J){case 1:Z[ve].fn.call(Z[ve].context);break;case 2:Z[ve].fn.call(Z[ve].context,Y);break;case 3:Z[ve].fn.call(Z[ve].context,Y,V);break;case 4:Z[ve].fn.call(Z[ve].context,Y,V,Q);break;default:if(!H)for(ye=1,H=new Array(J-1);ye<J;ye++)H[ye-1]=arguments[ye];Z[ve].fn.apply(Z[ve].context,H)}}return!0},C.prototype.on=function(F,Y,V){return h(this,F,Y,V,!1)},C.prototype.once=function(F,Y,V){return h(this,F,Y,V,!0)},C.prototype.removeListener=function(F,Y,V,Q){var k=_?_+F:F;if(!this._events[k])return this;if(!Y)return O(this,k),this;var K=this._events[k];if(K.fn)K.fn===Y&&(!Q||K.once)&&(!V||K.context===V)&&O(this,k);else{for(var U=0,Z=[],J=K.length;U<J;U++)(K[U].fn!==Y||Q&&!K[U].once||V&&K[U].context!==V)&&Z.push(K[U]);Z.length?this._events[k]=Z.length===1?Z[0]:Z:O(this,k)}return this},C.prototype.removeAllListeners=function(F){var Y;return F?(Y=_?_+F:F,this._events[Y]&&O(this,Y)):(this._events=new D,this._eventsCount=0),this},C.prototype.off=C.prototype.removeListener,C.prototype.addListener=C.prototype.on,C.prefixed=_,C.EventEmitter=C,Ze.exports=C},50840:function(Ze,E,_){var D;(function(N,h,O,C){"use strict";var P=["","webkit","Moz","MS","ms","o"],F=h.createElement("div"),Y="function",V=Math.round,Q=Math.abs,k=Date.now;function K(Je,yt,Qt){return setTimeout(Ve(Je,Qt),yt)}function U(Je,yt,Qt){return Array.isArray(Je)?(Z(Je,Qt[yt],Qt),!0):!1}function Z(Je,yt,Qt){var Ur;if(Je)if(Je.forEach)Je.forEach(yt,Qt);else if(Je.length!==C)for(Ur=0;Ur<Je.length;)yt.call(Qt,Je[Ur],Ur,Je),Ur++;else for(Ur in Je)Je.hasOwnProperty(Ur)&&yt.call(Qt,Je[Ur],Ur,Je)}function J(Je,yt,Qt){var Ur="DEPRECATED METHOD: "+yt+`
`+Qt+` AT 
`;return function(){var Tn=new Error("get-stack-trace"),mi=Tn&&Tn.stack?Tn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",la=N.console&&(N.console.warn||N.console.log);return la&&la.call(N.console,Ur,mi),Je.apply(this,arguments)}}var H;typeof Object.assign!="function"?H=function(yt){if(yt===C||yt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Qt=Object(yt),Ur=1;Ur<arguments.length;Ur++){var Tn=arguments[Ur];if(Tn!==C&&Tn!==null)for(var mi in Tn)Tn.hasOwnProperty(mi)&&(Qt[mi]=Tn[mi])}return Qt}:H=Object.assign;var ve=J(function(yt,Qt,Ur){for(var Tn=Object.keys(Qt),mi=0;mi<Tn.length;)(!Ur||Ur&&yt[Tn[mi]]===C)&&(yt[Tn[mi]]=Qt[Tn[mi]]),mi++;return yt},"extend","Use `assign`."),Te=J(function(yt,Qt){return ve(yt,Qt,!0)},"merge","Use `assign`.");function ye(Je,yt,Qt){var Ur=yt.prototype,Tn;Tn=Je.prototype=Object.create(Ur),Tn.constructor=Je,Tn._super=Ur,Qt&&H(Tn,Qt)}function Ve(Je,yt){return function(){return Je.apply(yt,arguments)}}function Re(Je,yt){return typeof Je==Y?Je.apply(yt&&yt[0]||C,yt):Je}function Ae(Je,yt){return Je===C?yt:Je}function ae(Je,yt,Qt){Z(fe(yt),function(Ur){Je.addEventListener(Ur,Qt,!1)})}function ee(Je,yt,Qt){Z(fe(yt),function(Ur){Je.removeEventListener(Ur,Qt,!1)})}function me(Je,yt){for(;Je;){if(Je==yt)return!0;Je=Je.parentNode}return!1}function ge(Je,yt){return Je.indexOf(yt)>-1}function fe(Je){return Je.trim().split(/\s+/g)}function Et(Je,yt,Qt){if(Je.indexOf&&!Qt)return Je.indexOf(yt);for(var Ur=0;Ur<Je.length;){if(Qt&&Je[Ur][Qt]==yt||!Qt&&Je[Ur]===yt)return Ur;Ur++}return-1}function xe(Je){return Array.prototype.slice.call(Je,0)}function je(Je,yt,Qt){for(var Ur=[],Tn=[],mi=0;mi<Je.length;){var la=yt?Je[mi][yt]:Je[mi];Et(Tn,la)<0&&Ur.push(Je[mi]),Tn[mi]=la,mi++}return Qt&&(yt?Ur=Ur.sort(function(ss,ko){return ss[yt]>ko[yt]}):Ur=Ur.sort()),Ur}function ue(Je,yt){for(var Qt,Ur,Tn=yt[0].toUpperCase()+yt.slice(1),mi=0;mi<P.length;){if(Qt=P[mi],Ur=Qt?Qt+Tn:yt,Ur in Je)return Ur;mi++}return C}var Pe=1;function we(){return Pe++}function nt(Je){var yt=Je.ownerDocument||Je;return yt.defaultView||yt.parentWindow||N}var at=/mobile|tablet|ip(ad|hone|od)|android/i,vt="ontouchstart"in N,Tt=ue(N,"PointerEvent")!==C,ze=vt&&at.test(navigator.userAgent),gr="touch",At="pen",hn="mouse",Wr="kinect",vr=25,dn=1,tn=2,un=4,yn=8,Vt=1,dr=2,wt=4,He=8,wr=16,Ne=dr|wt,Xr=He|wr,Er=Ne|Xr,Ue=["x","y"],In=["clientX","clientY"];function an(Je,yt){var Qt=this;this.manager=Je,this.callback=yt,this.element=Je.element,this.target=Je.options.inputTarget,this.domHandler=function(Ur){Re(Je.options.enable,[Je])&&Qt.handler(Ur)},this.init()}an.prototype={handler:function(){},init:function(){this.evEl&&ae(this.element,this.evEl,this.domHandler),this.evTarget&&ae(this.target,this.evTarget,this.domHandler),this.evWin&&ae(nt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ee(this.element,this.evEl,this.domHandler),this.evTarget&&ee(this.target,this.evTarget,this.domHandler),this.evWin&&ee(nt(this.element),this.evWin,this.domHandler)}};function Qr(Je){var yt,Qt=Je.options.inputClass;return Qt?yt=Qt:Tt?yt=ie:ze?yt=We:vt?yt=bt:yt=sr,new yt(Je,Dn)}function Dn(Je,yt,Qt){var Ur=Qt.pointers.length,Tn=Qt.changedPointers.length,mi=yt&dn&&Ur-Tn===0,la=yt&(un|yn)&&Ur-Tn===0;Qt.isFirst=!!mi,Qt.isFinal=!!la,mi&&(Je.session={}),Qt.eventType=yt,On(Je,Qt),Je.emit("hammer.input",Qt),Je.recognize(Qt),Je.session.prevInput=Qt}function On(Je,yt){var Qt=Je.session,Ur=yt.pointers,Tn=Ur.length;Qt.firstInput||(Qt.firstInput=cr(yt)),Tn>1&&!Qt.firstMultiple?Qt.firstMultiple=cr(yt):Tn===1&&(Qt.firstMultiple=!1);var mi=Qt.firstInput,la=Qt.firstMultiple,Ho=la?la.center:mi.center,ss=yt.center=Zr(Ur);yt.timeStamp=k(),yt.deltaTime=yt.timeStamp-mi.timeStamp,yt.angle=De(Ho,ss),yt.distance=Wn(Ho,ss),ri(Qt,yt),yt.offsetDirection=en(yt.deltaX,yt.deltaY);var ko=Kr(yt.deltaTime,yt.deltaX,yt.deltaY);yt.overallVelocityX=ko.x,yt.overallVelocityY=ko.y,yt.overallVelocity=Q(ko.x)>Q(ko.y)?ko.x:ko.y,yt.scale=la?se(la.pointers,Ur):1,yt.rotation=la?X(la.pointers,Ur):0,yt.maxPointers=Qt.prevInput?yt.pointers.length>Qt.prevInput.maxPointers?yt.pointers.length:Qt.prevInput.maxPointers:yt.pointers.length,zt(Qt,yt);var gu=Je.element;me(yt.srcEvent.target,gu)&&(gu=yt.srcEvent.target),yt.target=gu}function ri(Je,yt){var Qt=yt.center,Ur=Je.offsetDelta||{},Tn=Je.prevDelta||{},mi=Je.prevInput||{};(yt.eventType===dn||mi.eventType===un)&&(Tn=Je.prevDelta={x:mi.deltaX||0,y:mi.deltaY||0},Ur=Je.offsetDelta={x:Qt.x,y:Qt.y}),yt.deltaX=Tn.x+(Qt.x-Ur.x),yt.deltaY=Tn.y+(Qt.y-Ur.y)}function zt(Je,yt){var Qt=Je.lastInterval||yt,Ur=yt.timeStamp-Qt.timeStamp,Tn,mi,la,Ho;if(yt.eventType!=yn&&(Ur>vr||Qt.velocity===C)){var ss=yt.deltaX-Qt.deltaX,ko=yt.deltaY-Qt.deltaY,gu=Kr(Ur,ss,ko);mi=gu.x,la=gu.y,Tn=Q(gu.x)>Q(gu.y)?gu.x:gu.y,Ho=en(ss,ko),Je.lastInterval=yt}else Tn=Qt.velocity,mi=Qt.velocityX,la=Qt.velocityY,Ho=Qt.direction;yt.velocity=Tn,yt.velocityX=mi,yt.velocityY=la,yt.direction=Ho}function cr(Je){for(var yt=[],Qt=0;Qt<Je.pointers.length;)yt[Qt]={clientX:V(Je.pointers[Qt].clientX),clientY:V(Je.pointers[Qt].clientY)},Qt++;return{timeStamp:k(),pointers:yt,center:Zr(yt),deltaX:Je.deltaX,deltaY:Je.deltaY}}function Zr(Je){var yt=Je.length;if(yt===1)return{x:V(Je[0].clientX),y:V(Je[0].clientY)};for(var Qt=0,Ur=0,Tn=0;Tn<yt;)Qt+=Je[Tn].clientX,Ur+=Je[Tn].clientY,Tn++;return{x:V(Qt/yt),y:V(Ur/yt)}}function Kr(Je,yt,Qt){return{x:yt/Je||0,y:Qt/Je||0}}function en(Je,yt){return Je===yt?Vt:Q(Je)>=Q(yt)?Je<0?dr:wt:yt<0?He:wr}function Wn(Je,yt,Qt){Qt||(Qt=Ue);var Ur=yt[Qt[0]]-Je[Qt[0]],Tn=yt[Qt[1]]-Je[Qt[1]];return Math.sqrt(Ur*Ur+Tn*Tn)}function De(Je,yt,Qt){Qt||(Qt=Ue);var Ur=yt[Qt[0]]-Je[Qt[0]],Tn=yt[Qt[1]]-Je[Qt[1]];return Math.atan2(Tn,Ur)*180/Math.PI}function X(Je,yt){return De(yt[1],yt[0],In)+De(Je[1],Je[0],In)}function se(Je,yt){return Wn(yt[0],yt[1],In)/Wn(Je[0],Je[1],In)}var Be={mousedown:dn,mousemove:tn,mouseup:un},Ye="mousedown",ct="mousemove mouseup";function sr(){this.evEl=Ye,this.evWin=ct,this.pressed=!1,an.apply(this,arguments)}ye(sr,an,{handler:function(yt){var Qt=Be[yt.type];Qt&dn&&yt.button===0&&(this.pressed=!0),Qt&tn&&yt.which!==1&&(Qt=un),this.pressed&&(Qt&un&&(this.pressed=!1),this.callback(this.manager,Qt,{pointers:[yt],changedPointers:[yt],pointerType:hn,srcEvent:yt}))}});var ar={pointerdown:dn,pointermove:tn,pointerup:un,pointercancel:yn,pointerout:yn},or={2:gr,3:At,4:hn,5:Wr},Wt="pointerdown",oe="pointermove pointerup pointercancel";N.MSPointerEvent&&!N.PointerEvent&&(Wt="MSPointerDown",oe="MSPointerMove MSPointerUp MSPointerCancel");function ie(){this.evEl=Wt,this.evWin=oe,an.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ye(ie,an,{handler:function(yt){var Qt=this.store,Ur=!1,Tn=yt.type.toLowerCase().replace("ms",""),mi=ar[Tn],la=or[yt.pointerType]||yt.pointerType,Ho=la==gr,ss=Et(Qt,yt.pointerId,"pointerId");mi&dn&&(yt.button===0||Ho)?ss<0&&(Qt.push(yt),ss=Qt.length-1):mi&(un|yn)&&(Ur=!0),!(ss<0)&&(Qt[ss]=yt,this.callback(this.manager,mi,{pointers:Qt,changedPointers:[yt],pointerType:la,srcEvent:yt}),Ur&&Qt.splice(ss,1))}});var be={touchstart:dn,touchmove:tn,touchend:un,touchcancel:yn},ke="touchstart",qe="touchstart touchmove touchend touchcancel";function mt(){this.evTarget=ke,this.evWin=qe,this.started=!1,an.apply(this,arguments)}ye(mt,an,{handler:function(yt){var Qt=be[yt.type];if(Qt===dn&&(this.started=!0),!!this.started){var Ur=kt.call(this,yt,Qt);Qt&(un|yn)&&Ur[0].length-Ur[1].length===0&&(this.started=!1),this.callback(this.manager,Qt,{pointers:Ur[0],changedPointers:Ur[1],pointerType:gr,srcEvent:yt})}}});function kt(Je,yt){var Qt=xe(Je.touches),Ur=xe(Je.changedTouches);return yt&(un|yn)&&(Qt=je(Qt.concat(Ur),"identifier",!0)),[Qt,Ur]}var $e={touchstart:dn,touchmove:tn,touchend:un,touchcancel:yn},Ge="touchstart touchmove touchend touchcancel";function We(){this.evTarget=Ge,this.targetIds={},an.apply(this,arguments)}ye(We,an,{handler:function(yt){var Qt=$e[yt.type],Ur=G.call(this,yt,Qt);Ur&&this.callback(this.manager,Qt,{pointers:Ur[0],changedPointers:Ur[1],pointerType:gr,srcEvent:yt})}});function G(Je,yt){var Qt=xe(Je.touches),Ur=this.targetIds;if(yt&(dn|tn)&&Qt.length===1)return Ur[Qt[0].identifier]=!0,[Qt,Qt];var Tn,mi,la=xe(Je.changedTouches),Ho=[],ss=this.target;if(mi=Qt.filter(function(ko){return me(ko.target,ss)}),yt===dn)for(Tn=0;Tn<mi.length;)Ur[mi[Tn].identifier]=!0,Tn++;for(Tn=0;Tn<la.length;)Ur[la[Tn].identifier]&&Ho.push(la[Tn]),yt&(un|yn)&&delete Ur[la[Tn].identifier],Tn++;if(Ho.length)return[je(mi.concat(Ho),"identifier",!0),Ho]}var rt=2500,ft=25;function bt(){an.apply(this,arguments);var Je=Ve(this.handler,this);this.touch=new We(this.manager,Je),this.mouse=new sr(this.manager,Je),this.primaryTouch=null,this.lastTouches=[]}ye(bt,an,{handler:function(yt,Qt,Ur){var Tn=Ur.pointerType==gr,mi=Ur.pointerType==hn;if(!(mi&&Ur.sourceCapabilities&&Ur.sourceCapabilities.firesTouchEvents)){if(Tn)Gt.call(this,Qt,Ur);else if(mi&&Ht.call(this,Ur))return;this.callback(yt,Qt,Ur)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Gt(Je,yt){Je&dn?(this.primaryTouch=yt.changedPointers[0].identifier,lr.call(this,yt)):Je&(un|yn)&&lr.call(this,yt)}function lr(Je){var yt=Je.changedPointers[0];if(yt.identifier===this.primaryTouch){var Qt={x:yt.clientX,y:yt.clientY};this.lastTouches.push(Qt);var Ur=this.lastTouches,Tn=function(){var mi=Ur.indexOf(Qt);mi>-1&&Ur.splice(mi,1)};setTimeout(Tn,rt)}}function Ht(Je){for(var yt=Je.srcEvent.clientX,Qt=Je.srcEvent.clientY,Ur=0;Ur<this.lastTouches.length;Ur++){var Tn=this.lastTouches[Ur],mi=Math.abs(yt-Tn.x),la=Math.abs(Qt-Tn.y);if(mi<=ft&&la<=ft)return!0}return!1}var Cr=ue(F.style,"touchAction"),hr=Cr!==C,Dr="compute",Rn="auto",on="manipulation",fi="none",Mi="pan-x",di="pan-y",mn=qi();function Zn(Je,yt){this.manager=Je,this.set(yt)}Zn.prototype={set:function(Je){Je==Dr&&(Je=this.compute()),hr&&this.manager.element.style&&mn[Je]&&(this.manager.element.style[Cr]=Je),this.actions=Je.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Je=[];return Z(this.manager.recognizers,function(yt){Re(yt.options.enable,[yt])&&(Je=Je.concat(yt.getTouchAction()))}),sa(Je.join(" "))},preventDefaults:function(Je){var yt=Je.srcEvent,Qt=Je.offsetDirection;if(this.manager.session.prevented){yt.preventDefault();return}var Ur=this.actions,Tn=ge(Ur,fi)&&!mn[fi],mi=ge(Ur,di)&&!mn[di],la=ge(Ur,Mi)&&!mn[Mi];if(Tn){var Ho=Je.pointers.length===1,ss=Je.distance<2,ko=Je.deltaTime<250;if(Ho&&ss&&ko)return}if(!(la&&mi)&&(Tn||mi&&Qt&Ne||la&&Qt&Xr))return this.preventSrc(yt)},preventSrc:function(Je){this.manager.session.prevented=!0,Je.preventDefault()}};function sa(Je){if(ge(Je,fi))return fi;var yt=ge(Je,Mi),Qt=ge(Je,di);return yt&&Qt?fi:yt||Qt?yt?Mi:di:ge(Je,on)?on:Rn}function qi(){if(!hr)return!1;var Je={},yt=N.CSS&&N.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Qt){Je[Qt]=yt?N.CSS.supports("touch-action",Qt):!0}),Je}var Sa=1,Zi=2,Oi=4,jr=8,Fi=jr,Ls=16,Ta=32;function Aa(Je){this.options=H({},this.defaults,Je||{}),this.id=we(),this.manager=null,this.options.enable=Ae(this.options.enable,!0),this.state=Sa,this.simultaneous={},this.requireFail=[]}Aa.prototype={defaults:{},set:function(Je){return H(this.options,Je),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Je){if(U(Je,"recognizeWith",this))return this;var yt=this.simultaneous;return Je=ka(Je,this),yt[Je.id]||(yt[Je.id]=Je,Je.recognizeWith(this)),this},dropRecognizeWith:function(Je){return U(Je,"dropRecognizeWith",this)?this:(Je=ka(Je,this),delete this.simultaneous[Je.id],this)},requireFailure:function(Je){if(U(Je,"requireFailure",this))return this;var yt=this.requireFail;return Je=ka(Je,this),Et(yt,Je)===-1&&(yt.push(Je),Je.requireFailure(this)),this},dropRequireFailure:function(Je){if(U(Je,"dropRequireFailure",this))return this;Je=ka(Je,this);var yt=Et(this.requireFail,Je);return yt>-1&&this.requireFail.splice(yt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Je){return!!this.simultaneous[Je.id]},emit:function(Je){var yt=this,Qt=this.state;function Ur(Tn){yt.manager.emit(Tn,Je)}Qt<jr&&Ur(yt.options.event+go(Qt)),Ur(yt.options.event),Je.additionalEvent&&Ur(Je.additionalEvent),Qt>=jr&&Ur(yt.options.event+go(Qt))},tryEmit:function(Je){if(this.canEmit())return this.emit(Je);this.state=Ta},canEmit:function(){for(var Je=0;Je<this.requireFail.length;){if(!(this.requireFail[Je].state&(Ta|Sa)))return!1;Je++}return!0},recognize:function(Je){var yt=H({},Je);if(!Re(this.options.enable,[this,yt])){this.reset(),this.state=Ta;return}this.state&(Fi|Ls|Ta)&&(this.state=Sa),this.state=this.process(yt),this.state&(Zi|Oi|jr|Ls)&&this.tryEmit(yt)},process:function(Je){},getTouchAction:function(){},reset:function(){}};function go(Je){return Je&Ls?"cancel":Je&jr?"end":Je&Oi?"move":Je&Zi?"start":""}function os(Je){return Je==wr?"down":Je==He?"up":Je==dr?"left":Je==wt?"right":""}function ka(Je,yt){var Qt=yt.manager;return Qt?Qt.get(Je):Je}function Ao(){Aa.apply(this,arguments)}ye(Ao,Aa,{defaults:{pointers:1},attrTest:function(Je){var yt=this.options.pointers;return yt===0||Je.pointers.length===yt},process:function(Je){var yt=this.state,Qt=Je.eventType,Ur=yt&(Zi|Oi),Tn=this.attrTest(Je);return Ur&&(Qt&yn||!Tn)?yt|Ls:Ur||Tn?Qt&un?yt|jr:yt&Zi?yt|Oi:Zi:Ta}});function za(){Ao.apply(this,arguments),this.pX=null,this.pY=null}ye(za,Ao,{defaults:{event:"pan",threshold:10,pointers:1,direction:Er},getTouchAction:function(){var Je=this.options.direction,yt=[];return Je&Ne&&yt.push(di),Je&Xr&&yt.push(Mi),yt},directionTest:function(Je){var yt=this.options,Qt=!0,Ur=Je.distance,Tn=Je.direction,mi=Je.deltaX,la=Je.deltaY;return Tn&yt.direction||(yt.direction&Ne?(Tn=mi===0?Vt:mi<0?dr:wt,Qt=mi!=this.pX,Ur=Math.abs(Je.deltaX)):(Tn=la===0?Vt:la<0?He:wr,Qt=la!=this.pY,Ur=Math.abs(Je.deltaY))),Je.direction=Tn,Qt&&Ur>yt.threshold&&Tn&yt.direction},attrTest:function(Je){return Ao.prototype.attrTest.call(this,Je)&&(this.state&Zi||!(this.state&Zi)&&this.directionTest(Je))},emit:function(Je){this.pX=Je.deltaX,this.pY=Je.deltaY;var yt=os(Je.direction);yt&&(Je.additionalEvent=this.options.event+yt),this._super.emit.call(this,Je)}});function Ja(){Ao.apply(this,arguments)}ye(Ja,Ao,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[fi]},attrTest:function(Je){return this._super.attrTest.call(this,Je)&&(Math.abs(Je.scale-1)>this.options.threshold||this.state&Zi)},emit:function(Je){if(Je.scale!==1){var yt=Je.scale<1?"in":"out";Je.additionalEvent=this.options.event+yt}this._super.emit.call(this,Je)}});function Oa(){Aa.apply(this,arguments),this._timer=null,this._input=null}ye(Oa,Aa,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Rn]},process:function(Je){var yt=this.options,Qt=Je.pointers.length===yt.pointers,Ur=Je.distance<yt.threshold,Tn=Je.deltaTime>yt.time;if(this._input=Je,!Ur||!Qt||Je.eventType&(un|yn)&&!Tn)this.reset();else if(Je.eventType&dn)this.reset(),this._timer=K(function(){this.state=Fi,this.tryEmit()},yt.time,this);else if(Je.eventType&un)return Fi;return Ta},reset:function(){clearTimeout(this._timer)},emit:function(Je){this.state===Fi&&(Je&&Je.eventType&un?this.manager.emit(this.options.event+"up",Je):(this._input.timeStamp=k(),this.manager.emit(this.options.event,this._input)))}});function Za(){Ao.apply(this,arguments)}ye(Za,Ao,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[fi]},attrTest:function(Je){return this._super.attrTest.call(this,Je)&&(Math.abs(Je.rotation)>this.options.threshold||this.state&Zi)}});function qo(){Ao.apply(this,arguments)}ye(qo,Ao,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ne|Xr,pointers:1},getTouchAction:function(){return za.prototype.getTouchAction.call(this)},attrTest:function(Je){var yt=this.options.direction,Qt;return yt&(Ne|Xr)?Qt=Je.overallVelocity:yt&Ne?Qt=Je.overallVelocityX:yt&Xr&&(Qt=Je.overallVelocityY),this._super.attrTest.call(this,Je)&&yt&Je.offsetDirection&&Je.distance>this.options.threshold&&Je.maxPointers==this.options.pointers&&Q(Qt)>this.options.velocity&&Je.eventType&un},emit:function(Je){var yt=os(Je.offsetDirection);yt&&this.manager.emit(this.options.event+yt,Je),this.manager.emit(this.options.event,Je)}});function Ca(){Aa.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ye(Ca,Aa,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[on]},process:function(Je){var yt=this.options,Qt=Je.pointers.length===yt.pointers,Ur=Je.distance<yt.threshold,Tn=Je.deltaTime<yt.time;if(this.reset(),Je.eventType&dn&&this.count===0)return this.failTimeout();if(Ur&&Tn&&Qt){if(Je.eventType!=un)return this.failTimeout();var mi=this.pTime?Je.timeStamp-this.pTime<yt.interval:!0,la=!this.pCenter||Wn(this.pCenter,Je.center)<yt.posThreshold;this.pTime=Je.timeStamp,this.pCenter=Je.center,!la||!mi?this.count=1:this.count+=1,this._input=Je;var Ho=this.count%yt.taps;if(Ho===0)return this.hasRequireFailures()?(this._timer=K(function(){this.state=Fi,this.tryEmit()},yt.interval,this),Zi):Fi}return Ta},failTimeout:function(){return this._timer=K(function(){this.state=Ta},this.options.interval,this),Ta},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Fi&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function io(Je,yt){return yt=yt||{},yt.recognizers=Ae(yt.recognizers,io.defaults.preset),new ho(Je,yt)}io.VERSION="2.0.7",io.defaults={domEvents:!1,touchAction:Dr,enable:!0,inputTarget:null,inputClass:null,preset:[[Za,{enable:!1}],[Ja,{enable:!1},["rotate"]],[qo,{direction:Ne}],[za,{direction:Ne},["swipe"]],[Ca],[Ca,{event:"doubletap",taps:2},["tap"]],[Oa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Do=1,$=2;function ho(Je,yt){this.options=H({},io.defaults,yt||{}),this.options.inputTarget=this.options.inputTarget||Je,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Je,this.input=Qr(this),this.touchAction=new Zn(this,this.options.touchAction),ja(this,!0),Z(this.options.recognizers,function(Qt){var Ur=this.add(new Qt[0](Qt[1]));Qt[2]&&Ur.recognizeWith(Qt[2]),Qt[3]&&Ur.requireFailure(Qt[3])},this)}ho.prototype={set:function(Je){return H(this.options,Je),Je.touchAction&&this.touchAction.update(),Je.inputTarget&&(this.input.destroy(),this.input.target=Je.inputTarget,this.input.init()),this},stop:function(Je){this.session.stopped=Je?$:Do},recognize:function(Je){var yt=this.session;if(!yt.stopped){this.touchAction.preventDefaults(Je);var Qt,Ur=this.recognizers,Tn=yt.curRecognizer;(!Tn||Tn&&Tn.state&Fi)&&(Tn=yt.curRecognizer=null);for(var mi=0;mi<Ur.length;)Qt=Ur[mi],yt.stopped!==$&&(!Tn||Qt==Tn||Qt.canRecognizeWith(Tn))?Qt.recognize(Je):Qt.reset(),!Tn&&Qt.state&(Zi|Oi|jr)&&(Tn=yt.curRecognizer=Qt),mi++}},get:function(Je){if(Je instanceof Aa)return Je;for(var yt=this.recognizers,Qt=0;Qt<yt.length;Qt++)if(yt[Qt].options.event==Je)return yt[Qt];return null},add:function(Je){if(U(Je,"add",this))return this;var yt=this.get(Je.options.event);return yt&&this.remove(yt),this.recognizers.push(Je),Je.manager=this,this.touchAction.update(),Je},remove:function(Je){if(U(Je,"remove",this))return this;if(Je=this.get(Je),Je){var yt=this.recognizers,Qt=Et(yt,Je);Qt!==-1&&(yt.splice(Qt,1),this.touchAction.update())}return this},on:function(Je,yt){if(Je!==C&&yt!==C){var Qt=this.handlers;return Z(fe(Je),function(Ur){Qt[Ur]=Qt[Ur]||[],Qt[Ur].push(yt)}),this}},off:function(Je,yt){if(Je!==C){var Qt=this.handlers;return Z(fe(Je),function(Ur){yt?Qt[Ur]&&Qt[Ur].splice(Et(Qt[Ur],yt),1):delete Qt[Ur]}),this}},emit:function(Je,yt){this.options.domEvents&&gs(Je,yt);var Qt=this.handlers[Je]&&this.handlers[Je].slice();if(!(!Qt||!Qt.length)){yt.type=Je,yt.preventDefault=function(){yt.srcEvent.preventDefault()};for(var Ur=0;Ur<Qt.length;)Qt[Ur](yt),Ur++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ja(Je,yt){var Qt=Je.element;if(Qt.style){var Ur;Z(Je.options.cssProps,function(Tn,mi){Ur=ue(Qt.style,mi),yt?(Je.oldCssProps[Ur]=Qt.style[Ur],Qt.style[Ur]=Tn):Qt.style[Ur]=Je.oldCssProps[Ur]||""}),yt||(Je.oldCssProps={})}}function gs(Je,yt){var Qt=h.createEvent("Event");Qt.initEvent(Je,!0,!0),Qt.gesture=yt,yt.target.dispatchEvent(Qt)}H(io,{INPUT_START:dn,INPUT_MOVE:tn,INPUT_END:un,INPUT_CANCEL:yn,STATE_POSSIBLE:Sa,STATE_BEGAN:Zi,STATE_CHANGED:Oi,STATE_ENDED:jr,STATE_RECOGNIZED:Fi,STATE_CANCELLED:Ls,STATE_FAILED:Ta,DIRECTION_NONE:Vt,DIRECTION_LEFT:dr,DIRECTION_RIGHT:wt,DIRECTION_UP:He,DIRECTION_DOWN:wr,DIRECTION_HORIZONTAL:Ne,DIRECTION_VERTICAL:Xr,DIRECTION_ALL:Er,Manager:ho,Input:an,TouchAction:Zn,TouchInput:We,MouseInput:sr,PointerEventInput:ie,TouchMouseInput:bt,SingleTouchInput:mt,Recognizer:Aa,AttrRecognizer:Ao,Tap:Ca,Pan:za,Swipe:qo,Pinch:Ja,Rotate:Za,Press:Oa,on:ae,off:ee,each:Z,merge:Te,extend:ve,assign:H,inherit:ye,bindFn:Ve,prefixed:ue});var Vo=typeof N!="undefined"?N:typeof self!="undefined"?self:{};Vo.Hammer=io,D=function(){return io}.call(E,_,E,Ze),D!==C&&(Ze.exports=D)})(window,document,"Hammer")},7375:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var _=Symbol.for("INJECTION");function D(P,F,Y,V){function Q(){return V&&!Reflect.hasMetadata(_,this,F)&&Reflect.defineMetadata(_,Y(),this,F),Reflect.hasMetadata(_,this,F)?Reflect.getMetadata(_,this,F):Y()}function k(K){Reflect.defineMetadata(_,K,this,F)}Object.defineProperty(P,F,{configurable:!0,enumerable:!0,get:Q,set:k})}function N(P,F){return function(Y){return function(V,Q){var k=function(){return P.get(Y)};D(V,Q,k,F)}}}E.makePropertyInjectDecorator=N;function h(P,F){return function(Y,V){return function(Q,k){var K=function(){return P.getNamed(Y,V)};D(Q,k,K,F)}}}E.makePropertyInjectNamedDecorator=h;function O(P,F){return function(Y,V,Q){return function(k,K){var U=function(){return P.getTagged(Y,V,Q)};D(k,K,U,F)}}}E.makePropertyInjectTaggedDecorator=O;function C(P,F){return function(Y){return function(V,Q){var k=function(){return P.getAll(Y)};D(V,Q,k,F)}}}E.makePropertyMultiInjectDecorator=C},84879:function(Ze,E,_){"use strict";var D;D={value:!0};var N=_(7375);function h(O,C){C===void 0&&(C=!0);var P=N.makePropertyInjectDecorator(O,C),F=N.makePropertyInjectNamedDecorator(O,C),Y=N.makePropertyInjectTaggedDecorator(O,C),V=N.makePropertyMultiInjectDecorator(O,C);return{lazyInject:P,lazyInjectNamed:F,lazyInjectTagged:Y,lazyMultiInject:V}}E.Z=h},99934:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.tagProperty=E.tagParameter=E.decorate=void 0;var D=_(16674),N=_(6867);function h(V,Q,k,K){var U=N.TAGGED;C(U,V,Q,K,k)}E.tagParameter=h;function O(V,Q,k){var K=N.TAGGED_PROP;C(K,V.constructor,Q,k)}E.tagProperty=O;function C(V,Q,k,K,U){var Z={},J=typeof U=="number",H=U!==void 0&&J?U.toString():k;if(J&&k!==void 0)throw new Error(D.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(V,Q)&&(Z=Reflect.getMetadata(V,Q));var ve=Z[H];if(!Array.isArray(ve))ve=[];else for(var Te=0,ye=ve;Te<ye.length;Te++){var Ve=ye[Te];if(Ve.key===K.key)throw new Error(D.DUPLICATED_METADATA+" "+Ve.key.toString())}ve.push(K),Z[H]=ve,Reflect.defineMetadata(V,Z,Q)}function P(V,Q){Reflect.decorate(V,Q)}function F(V,Q){return function(k,K){Q(k,K,V)}}function Y(V,Q,k){typeof k=="number"?P([F(k,V)],Q):typeof k=="string"?Reflect.decorate([V],Q,k):P([V],Q)}E.decorate=Y},5744:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.inject=E.LazyServiceIdentifer=void 0;var D=_(16674),N=_(6867),h=_(47738),O=_(99934),C=function(){function F(Y){this._cb=Y}return F.prototype.unwrap=function(){return this._cb()},F}();E.LazyServiceIdentifer=C;function P(F){return function(Y,V,Q){if(F===void 0)throw new Error(D.UNDEFINED_INJECT_ANNOTATION(Y.name));var k=new h.Metadata(N.INJECT_TAG,F);typeof Q=="number"?O.tagParameter(Y,V,Q,k):O.tagProperty(Y,V,k)}}E.inject=P},64315:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.injectable=void 0;var D=_(16674),N=_(6867);function h(){return function(O){if(Reflect.hasOwnMetadata(N.PARAM_TYPES,O))throw new Error(D.DUPLICATED_INJECTABLE_DECORATOR);var C=Reflect.getMetadata(N.DESIGN_PARAM_TYPES,O)||[];return Reflect.defineMetadata(N.PARAM_TYPES,C,O),O}}E.injectable=h},71693:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.multiInject=void 0;var D=_(6867),N=_(47738),h=_(99934);function O(C){return function(P,F,Y){var V=new N.Metadata(D.MULTI_INJECT_TAG,C);typeof Y=="number"?h.tagParameter(P,F,Y,V):h.tagProperty(P,F,V)}}E.multiInject=O},38085:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.named=void 0;var D=_(6867),N=_(47738),h=_(99934);function O(C){return function(P,F,Y){var V=new N.Metadata(D.NAMED_TAG,C);typeof Y=="number"?h.tagParameter(P,F,Y,V):h.tagProperty(P,F,V)}}E.named=O},6515:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.optional=void 0;var D=_(6867),N=_(47738),h=_(99934);function O(){return function(C,P,F){var Y=new N.Metadata(D.OPTIONAL_TAG,!0);typeof F=="number"?h.tagParameter(C,P,F,Y):h.tagProperty(C,P,Y)}}E.optional=O},7014:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.postConstruct=void 0;var D=_(16674),N=_(6867),h=_(47738);function O(){return function(C,P,F){var Y=new h.Metadata(N.POST_CONSTRUCT,P);if(Reflect.hasOwnMetadata(N.POST_CONSTRUCT,C.constructor))throw new Error(D.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(N.POST_CONSTRUCT,Y,C.constructor)}}E.postConstruct=O},32052:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.tagged=void 0;var D=_(47738),N=_(99934);function h(O,C){return function(P,F,Y){var V=new D.Metadata(O,C);typeof Y=="number"?N.tagParameter(P,F,Y,V):N.tagProperty(P,F,V)}}E.tagged=h},55638:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.targetName=void 0;var D=_(6867),N=_(47738),h=_(99934);function O(C){return function(P,F,Y){var V=new N.Metadata(D.NAME_TAG,C);h.tagParameter(P,F,Y,V)}}E.targetName=O},86757:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.unmanaged=void 0;var D=_(6867),N=_(47738),h=_(99934);function O(){return function(C,P,F){var Y=new N.Metadata(D.UNMANAGED_TAG,!0);h.tagParameter(C,P,F,Y)}}E.unmanaged=O},44290:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Binding=void 0;var D=_(28421),N=_(37791),h=function(){function O(C,P){this.id=N.id(),this.activated=!1,this.serviceIdentifier=C,this.scope=P,this.type=D.BindingTypeEnum.Invalid,this.constraint=function(F){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return O.prototype.clone=function(){var C=new O(this.serviceIdentifier,this.scope);return C.activated=C.scope===D.BindingScopeEnum.Singleton?this.activated:!1,C.implementationType=this.implementationType,C.dynamicValue=this.dynamicValue,C.scope=this.scope,C.type=this.type,C.factory=this.factory,C.provider=this.provider,C.constraint=this.constraint,C.onActivation=this.onActivation,C.cache=this.cache,C},O}();E.Binding=h},23184:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingCount=void 0;var _={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};E.BindingCount=_},16674:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.STACK_OVERFLOW=E.CIRCULAR_DEPENDENCY_IN_FACTORY=E.POST_CONSTRUCT_ERROR=E.MULTIPLE_POST_CONSTRUCT_METHODS=E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=E.ARGUMENTS_LENGTH_MISMATCH=E.INVALID_DECORATOR_OPERATION=E.INVALID_TO_SELF_VALUE=E.INVALID_FUNCTION_BINDING=E.INVALID_MIDDLEWARE_RETURN=E.NO_MORE_SNAPSHOTS_AVAILABLE=E.INVALID_BINDING_TYPE=E.NOT_IMPLEMENTED=E.CIRCULAR_DEPENDENCY=E.UNDEFINED_INJECT_ANNOTATION=E.MISSING_INJECT_ANNOTATION=E.MISSING_INJECTABLE_ANNOTATION=E.NOT_REGISTERED=E.CANNOT_UNBIND=E.AMBIGUOUS_MATCH=E.KEY_NOT_FOUND=E.NULL_ARGUMENT=E.DUPLICATED_METADATA=E.DUPLICATED_INJECTABLE_DECORATOR=void 0,E.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",E.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",E.NULL_ARGUMENT="NULL argument",E.KEY_NOT_FOUND="Key Not Found",E.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",E.CANNOT_UNBIND="Could not unbind serviceIdentifier:",E.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",E.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",E.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var _=function(O){return"@inject called with undefined this could mean that the class "+O+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};E.UNDEFINED_INJECT_ANNOTATION=_,E.CIRCULAR_DEPENDENCY="Circular dependency found:",E.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",E.INVALID_BINDING_TYPE="Invalid binding type:",E.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",E.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",E.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",E.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",E.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var D=function(){for(var O=[],C=0;C<arguments.length;C++)O[C]=arguments[C];return"The number of constructor arguments in the derived class "+(O[0]+" must be >= than the number of constructor arguments of its base class.")};E.ARGUMENTS_LENGTH_MISMATCH=D,E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",E.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var N=function(){for(var O=[],C=0;C<arguments.length;C++)O[C]=arguments[C];return"@postConstruct error in class "+O[0]+": "+O[1]};E.POST_CONSTRUCT_ERROR=N;var h=function(){for(var O=[],C=0;C<arguments.length;C++)O[C]=arguments[C];return"It looks like there is a circular dependency "+("in one of the '"+O[0]+"' bindings. Please investigate bindings with")+("service identifier '"+O[1]+"'.")};E.CIRCULAR_DEPENDENCY_IN_FACTORY=h,E.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.TargetTypeEnum=E.BindingTypeEnum=E.BindingScopeEnum=void 0;var _={Request:"Request",Singleton:"Singleton",Transient:"Transient"};E.BindingScopeEnum=_;var D={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};E.BindingTypeEnum=D;var N={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};E.TargetTypeEnum=N},6867:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.NON_CUSTOM_TAG_KEYS=E.POST_CONSTRUCT=E.DESIGN_PARAM_TYPES=E.PARAM_TYPES=E.TAGGED_PROP=E.TAGGED=E.MULTI_INJECT_TAG=E.INJECT_TAG=E.OPTIONAL_TAG=E.UNMANAGED_TAG=E.NAME_TAG=E.NAMED_TAG=void 0,E.NAMED_TAG="named",E.NAME_TAG="name",E.UNMANAGED_TAG="unmanaged",E.OPTIONAL_TAG="optional",E.INJECT_TAG="inject",E.MULTI_INJECT_TAG="multi_inject",E.TAGGED="inversify:tagged",E.TAGGED_PROP="inversify:tagged_props",E.PARAM_TYPES="inversify:paramtypes",E.DESIGN_PARAM_TYPES="design:paramtypes",E.POST_CONSTRUCT="post_construct";function _(){return[E.INJECT_TAG,E.MULTI_INJECT_TAG,E.NAME_TAG,E.UNMANAGED_TAG,E.NAMED_TAG,E.OPTIONAL_TAG]}E.NON_CUSTOM_TAG_KEYS=_()},51389:function(Ze,E,_){"use strict";var D=this&&this.__awaiter||function(ve,Te,ye,Ve){function Re(Ae){return Ae instanceof ye?Ae:new ye(function(ae){ae(Ae)})}return new(ye||(ye=Promise))(function(Ae,ae){function ee(fe){try{ge(Ve.next(fe))}catch(Et){ae(Et)}}function me(fe){try{ge(Ve.throw(fe))}catch(Et){ae(Et)}}function ge(fe){fe.done?Ae(fe.value):Re(fe.value).then(ee,me)}ge((Ve=Ve.apply(ve,Te||[])).next())})},N=this&&this.__generator||function(ve,Te){var ye={label:0,sent:function(){if(Ae[0]&1)throw Ae[1];return Ae[1]},trys:[],ops:[]},Ve,Re,Ae,ae;return ae={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(ae[Symbol.iterator]=function(){return this}),ae;function ee(ge){return function(fe){return me([ge,fe])}}function me(ge){if(Ve)throw new TypeError("Generator is already executing.");for(;ye;)try{if(Ve=1,Re&&(Ae=ge[0]&2?Re.return:ge[0]?Re.throw||((Ae=Re.return)&&Ae.call(Re),0):Re.next)&&!(Ae=Ae.call(Re,ge[1])).done)return Ae;switch(Re=0,Ae&&(ge=[ge[0]&2,Ae.value]),ge[0]){case 0:case 1:Ae=ge;break;case 4:return ye.label++,{value:ge[1],done:!1};case 5:ye.label++,Re=ge[1],ge=[0];continue;case 7:ge=ye.ops.pop(),ye.trys.pop();continue;default:if(Ae=ye.trys,!(Ae=Ae.length>0&&Ae[Ae.length-1])&&(ge[0]===6||ge[0]===2)){ye=0;continue}if(ge[0]===3&&(!Ae||ge[1]>Ae[0]&&ge[1]<Ae[3])){ye.label=ge[1];break}if(ge[0]===6&&ye.label<Ae[1]){ye.label=Ae[1],Ae=ge;break}if(Ae&&ye.label<Ae[2]){ye.label=Ae[2],ye.ops.push(ge);break}Ae[2]&&ye.ops.pop(),ye.trys.pop();continue}ge=Te.call(ve,ye)}catch(fe){ge=[6,fe],Re=0}finally{Ve=Ae=0}if(ge[0]&5)throw ge[1];return{value:ge[0]?ge[1]:void 0,done:!0}}},h=this&&this.__spreadArray||function(ve,Te){for(var ye=0,Ve=Te.length,Re=ve.length;ye<Ve;ye++,Re++)ve[Re]=Te[ye];return ve};Object.defineProperty(E,"__esModule",{value:!0}),E.Container=void 0;var O=_(44290),C=_(16674),P=_(28421),F=_(6867),Y=_(51377),V=_(86311),Q=_(7478),k=_(51860),K=_(37791),U=_(55800),Z=_(85700),J=_(80175),H=function(){function ve(Te){this._appliedMiddleware=[];var ye=Te||{};if(typeof ye!="object")throw new Error(""+C.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(ye.defaultScope===void 0)ye.defaultScope=P.BindingScopeEnum.Transient;else if(ye.defaultScope!==P.BindingScopeEnum.Singleton&&ye.defaultScope!==P.BindingScopeEnum.Transient&&ye.defaultScope!==P.BindingScopeEnum.Request)throw new Error(""+C.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(ye.autoBindInjectable===void 0)ye.autoBindInjectable=!1;else if(typeof ye.autoBindInjectable!="boolean")throw new Error(""+C.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(ye.skipBaseClassChecks===void 0)ye.skipBaseClassChecks=!1;else if(typeof ye.skipBaseClassChecks!="boolean")throw new Error(""+C.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:ye.autoBindInjectable,defaultScope:ye.defaultScope,skipBaseClassChecks:ye.skipBaseClassChecks},this.id=K.id(),this._bindingDictionary=new J.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Y.MetadataReader}return ve.merge=function(Te,ye){for(var Ve=[],Re=2;Re<arguments.length;Re++)Ve[Re-2]=arguments[Re];var Ae=new ve,ae=h([Te,ye],Ve).map(function(ge){return V.getBindingDictionary(ge)}),ee=V.getBindingDictionary(Ae);function me(ge,fe){ge.traverse(function(Et,xe){xe.forEach(function(je){fe.add(je.serviceIdentifier,je.clone())})})}return ae.forEach(function(ge){me(ge,ee)}),Ae},ve.prototype.load=function(){for(var Te=[],ye=0;ye<arguments.length;ye++)Te[ye]=arguments[ye];for(var Ve=this._getContainerModuleHelpersFactory(),Re=0,Ae=Te;Re<Ae.length;Re++){var ae=Ae[Re],ee=Ve(ae.id);ae.registry(ee.bindFunction,ee.unbindFunction,ee.isboundFunction,ee.rebindFunction)}},ve.prototype.loadAsync=function(){for(var Te=[],ye=0;ye<arguments.length;ye++)Te[ye]=arguments[ye];return D(this,void 0,void 0,function(){var Ve,Re,Ae,ae,ee;return N(this,function(me){switch(me.label){case 0:Ve=this._getContainerModuleHelpersFactory(),Re=0,Ae=Te,me.label=1;case 1:return Re<Ae.length?(ae=Ae[Re],ee=Ve(ae.id),[4,ae.registry(ee.bindFunction,ee.unbindFunction,ee.isboundFunction,ee.rebindFunction)]):[3,4];case 2:me.sent(),me.label=3;case 3:return Re++,[3,1];case 4:return[2]}})})},ve.prototype.unload=function(){for(var Te=this,ye=[],Ve=0;Ve<arguments.length;Ve++)ye[Ve]=arguments[Ve];var Re=function(Ae){return function(ae){return ae.moduleId===Ae}};ye.forEach(function(Ae){var ae=Re(Ae.id);Te._bindingDictionary.removeByCondition(ae)})},ve.prototype.bind=function(Te){var ye=this.options.defaultScope||P.BindingScopeEnum.Transient,Ve=new O.Binding(Te,ye);return this._bindingDictionary.add(Te,Ve),new k.BindingToSyntax(Ve)},ve.prototype.rebind=function(Te){return this.unbind(Te),this.bind(Te)},ve.prototype.unbind=function(Te){try{this._bindingDictionary.remove(Te)}catch(ye){throw new Error(C.CANNOT_UNBIND+" "+U.getServiceIdentifierAsString(Te))}},ve.prototype.unbindAll=function(){this._bindingDictionary=new J.Lookup},ve.prototype.isBound=function(Te){var ye=this._bindingDictionary.hasKey(Te);return!ye&&this.parent&&(ye=this.parent.isBound(Te)),ye},ve.prototype.isBoundNamed=function(Te,ye){return this.isBoundTagged(Te,F.NAMED_TAG,ye)},ve.prototype.isBoundTagged=function(Te,ye,Ve){var Re=!1;if(this._bindingDictionary.hasKey(Te)){var Ae=this._bindingDictionary.get(Te),ae=V.createMockRequest(this,Te,ye,Ve);Re=Ae.some(function(ee){return ee.constraint(ae)})}return!Re&&this.parent&&(Re=this.parent.isBoundTagged(Te,ye,Ve)),Re},ve.prototype.snapshot=function(){this._snapshots.push(Z.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},ve.prototype.restore=function(){var Te=this._snapshots.pop();if(Te===void 0)throw new Error(C.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Te.bindings,this._middleware=Te.middleware},ve.prototype.createChild=function(Te){var ye=new ve(Te||this.options);return ye.parent=this,ye},ve.prototype.applyMiddleware=function(){for(var Te=[],ye=0;ye<arguments.length;ye++)Te[ye]=arguments[ye];this._appliedMiddleware=this._appliedMiddleware.concat(Te);var Ve=this._middleware?this._middleware:this._planAndResolve();this._middleware=Te.reduce(function(Re,Ae){return Ae(Re)},Ve)},ve.prototype.applyCustomMetadataReader=function(Te){this._metadataReader=Te},ve.prototype.get=function(Te){return this._get(!1,!1,P.TargetTypeEnum.Variable,Te)},ve.prototype.getTagged=function(Te,ye,Ve){return this._get(!1,!1,P.TargetTypeEnum.Variable,Te,ye,Ve)},ve.prototype.getNamed=function(Te,ye){return this.getTagged(Te,F.NAMED_TAG,ye)},ve.prototype.getAll=function(Te){return this._get(!0,!0,P.TargetTypeEnum.Variable,Te)},ve.prototype.getAllTagged=function(Te,ye,Ve){return this._get(!1,!0,P.TargetTypeEnum.Variable,Te,ye,Ve)},ve.prototype.getAllNamed=function(Te,ye){return this.getAllTagged(Te,F.NAMED_TAG,ye)},ve.prototype.resolve=function(Te){var ye=this.createChild();return ye.bind(Te).toSelf(),this._appliedMiddleware.forEach(function(Ve){ye.applyMiddleware(Ve)}),ye.get(Te)},ve.prototype._getContainerModuleHelpersFactory=function(){var Te=this,ye=function(ee,me){ee._binding.moduleId=me},Ve=function(ee){return function(me){var ge=Te.bind.bind(Te),fe=ge(me);return ye(fe,ee),fe}},Re=function(ee){return function(me){var ge=Te.unbind.bind(Te);ge(me)}},Ae=function(ee){return function(me){var ge=Te.isBound.bind(Te);return ge(me)}},ae=function(ee){return function(me){var ge=Te.rebind.bind(Te),fe=ge(me);return ye(fe,ee),fe}};return function(ee){return{bindFunction:Ve(ee),isboundFunction:Ae(ee),rebindFunction:ae(ee),unbindFunction:Re(ee)}}},ve.prototype._get=function(Te,ye,Ve,Re,Ae,ae){var ee=null,me={avoidConstraints:Te,contextInterceptor:function(ge){return ge},isMultiInject:ye,key:Ae,serviceIdentifier:Re,targetType:Ve,value:ae};if(this._middleware){if(ee=this._middleware(me),ee==null)throw new Error(C.INVALID_MIDDLEWARE_RETURN)}else ee=this._planAndResolve()(me);return ee},ve.prototype._planAndResolve=function(){var Te=this;return function(ye){var Ve=V.plan(Te._metadataReader,Te,ye.isMultiInject,ye.targetType,ye.serviceIdentifier,ye.key,ye.value,ye.avoidConstraints);Ve=ye.contextInterceptor(Ve);var Re=Q.resolve(Ve);return Re}},ve}();E.Container=H},33244:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.AsyncContainerModule=E.ContainerModule=void 0;var D=_(37791),N=function(){function O(C){this.id=D.id(),this.registry=C}return O}();E.ContainerModule=N;var h=function(){function O(C){this.id=D.id(),this.registry=C}return O}();E.AsyncContainerModule=h},85700:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.ContainerSnapshot=void 0;var _=function(){function D(){}return D.of=function(N,h){var O=new D;return O.bindings=N,O.middleware=h,O},D}();E.ContainerSnapshot=_},80175:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Lookup=void 0;var D=_(16674),N=function(){function h(){this._map=new Map}return h.prototype.getMap=function(){return this._map},h.prototype.add=function(O,C){if(O==null)throw new Error(D.NULL_ARGUMENT);if(C==null)throw new Error(D.NULL_ARGUMENT);var P=this._map.get(O);P!==void 0?(P.push(C),this._map.set(O,P)):this._map.set(O,[C])},h.prototype.get=function(O){if(O==null)throw new Error(D.NULL_ARGUMENT);var C=this._map.get(O);if(C!==void 0)return C;throw new Error(D.KEY_NOT_FOUND)},h.prototype.remove=function(O){if(O==null)throw new Error(D.NULL_ARGUMENT);if(!this._map.delete(O))throw new Error(D.KEY_NOT_FOUND)},h.prototype.removeByCondition=function(O){var C=this;this._map.forEach(function(P,F){var Y=P.filter(function(V){return!O(V)});Y.length>0?C._map.set(F,Y):C._map.delete(F)})},h.prototype.hasKey=function(O){if(O==null)throw new Error(D.NULL_ARGUMENT);return this._map.has(O)},h.prototype.clone=function(){var O=new h;return this._map.forEach(function(C,P){C.forEach(function(F){return O.add(P,F.clone())})}),O},h.prototype.traverse=function(O){this._map.forEach(function(C,P){O(P,C)})},h}();E.Lookup=N},86700:function(Ze,E,_){"use strict";var D;D={value:!0},D=D=D=D=D=D=E.GW=D=D=E.zY=D=D=D=D=D=E.f3=D=D=E.b2=D=D=D=D=D=E.W2=D=void 0;var N=_(6867);D=N;var h=_(51389);Object.defineProperty(E,"W2",{enumerable:!0,get:function(){return h.Container}});var O=_(28421);D={enumerable:!0,get:function(){return O.BindingScopeEnum}},D={enumerable:!0,get:function(){return O.BindingTypeEnum}},D={enumerable:!0,get:function(){return O.TargetTypeEnum}};var C=_(33244);D={enumerable:!0,get:function(){return C.AsyncContainerModule}},D={enumerable:!0,get:function(){return C.ContainerModule}};var P=_(64315);Object.defineProperty(E,"b2",{enumerable:!0,get:function(){return P.injectable}});var F=_(32052);D={enumerable:!0,get:function(){return F.tagged}};var Y=_(38085);D={enumerable:!0,get:function(){return Y.named}};var V=_(5744);Object.defineProperty(E,"f3",{enumerable:!0,get:function(){return V.inject}}),D={enumerable:!0,get:function(){return V.LazyServiceIdentifer}};var Q=_(6515);D={enumerable:!0,get:function(){return Q.optional}};var k=_(86757);D={enumerable:!0,get:function(){return k.unmanaged}};var K=_(71693);D={enumerable:!0,get:function(){return K.multiInject}};var U=_(55638);D={enumerable:!0,get:function(){return U.targetName}};var Z=_(7014);Object.defineProperty(E,"zY",{enumerable:!0,get:function(){return Z.postConstruct}});var J=_(51377);D={enumerable:!0,get:function(){return J.MetadataReader}};var H=_(37791);D={enumerable:!0,get:function(){return H.id}};var ve=_(99934);Object.defineProperty(E,"GW",{enumerable:!0,get:function(){return ve.decorate}});var Te=_(80758);D={enumerable:!0,get:function(){return Te.traverseAncerstors}},D={enumerable:!0,get:function(){return Te.taggedConstraint}},D={enumerable:!0,get:function(){return Te.namedConstraint}},D={enumerable:!0,get:function(){return Te.typeConstraint}};var ye=_(55800);D={enumerable:!0,get:function(){return ye.getServiceIdentifierAsString}};var Ve=_(70600);D={enumerable:!0,get:function(){return Ve.multiBindToService}}},95228:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Context=void 0;var D=_(37791),N=function(){function h(O){this.id=D.id(),this.container=O}return h.prototype.addPlan=function(O){this.plan=O},h.prototype.setCurrentRequest=function(O){this.currentRequest=O},h}();E.Context=N},47738:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Metadata=void 0;var D=_(6867),N=function(){function h(O,C){this.key=O,this.value=C}return h.prototype.toString=function(){return this.key===D.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},h}();E.Metadata=N},51377:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.MetadataReader=void 0;var D=_(6867),N=function(){function h(){}return h.prototype.getConstructorMetadata=function(O){var C=Reflect.getMetadata(D.PARAM_TYPES,O),P=Reflect.getMetadata(D.TAGGED,O);return{compilerGeneratedMetadata:C,userGeneratedMetadata:P||{}}},h.prototype.getPropertiesMetadata=function(O){var C=Reflect.getMetadata(D.TAGGED_PROP,O)||[];return C},h}();E.MetadataReader=N},55314:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Plan=void 0;var _=function(){function D(N,h){this.parentContext=N,this.rootRequest=h}return D}();E.Plan=_},86311:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.getBindingDictionary=E.createMockRequest=E.plan=void 0;var D=_(23184),N=_(16674),h=_(28421),O=_(6867),C=_(54623),P=_(55800),F=_(95228),Y=_(47738),V=_(55314),Q=_(6e3),k=_(6748),K=_(18924);function U(Re){return Re._bindingDictionary}E.getBindingDictionary=U;function Z(Re,Ae,ae,ee,me,ge){var fe=Re?O.MULTI_INJECT_TAG:O.INJECT_TAG,Et=new Y.Metadata(fe,ae),xe=new K.Target(Ae,ee,ae,Et);if(me!==void 0){var je=new Y.Metadata(me,ge);xe.metadata.push(je)}return xe}function J(Re,Ae,ae,ee,me){var ge=Te(ae.container,me.serviceIdentifier),fe=[];return ge.length===D.BindingCount.NoBindingsAvailable&&ae.container.options.autoBindInjectable&&typeof me.serviceIdentifier=="function"&&Re.getConstructorMetadata(me.serviceIdentifier).compilerGeneratedMetadata&&(ae.container.bind(me.serviceIdentifier).toSelf(),ge=Te(ae.container,me.serviceIdentifier)),Ae?fe=ge:fe=ge.filter(function(Et){var xe=new k.Request(Et.serviceIdentifier,ae,ee,Et,me);return Et.constraint(xe)}),H(me.serviceIdentifier,fe,me,ae.container),fe}function H(Re,Ae,ae,ee){switch(Ae.length){case D.BindingCount.NoBindingsAvailable:if(ae.isOptional())return Ae;var me=P.getServiceIdentifierAsString(Re),ge=N.NOT_REGISTERED;throw ge+=P.listMetadataForTarget(me,ae),ge+=P.listRegisteredBindingsForServiceIdentifier(ee,me,Te),new Error(ge);case D.BindingCount.OnlyOneBindingAvailable:if(!ae.isArray())return Ae;case D.BindingCount.MultipleBindingsAvailable:default:if(ae.isArray())return Ae;var me=P.getServiceIdentifierAsString(Re),ge=N.AMBIGUOUS_MATCH+" "+me;throw ge+=P.listRegisteredBindingsForServiceIdentifier(ee,me,Te),new Error(ge)}}function ve(Re,Ae,ae,ee,me,ge){var fe,Et;if(me===null){fe=J(Re,Ae,ee,null,ge),Et=new k.Request(ae,ee,null,fe,ge);var xe=new V.Plan(ee,Et);ee.addPlan(xe)}else fe=J(Re,Ae,ee,me,ge),Et=me.addChildRequest(ge.serviceIdentifier,fe,ge);fe.forEach(function(je){var ue=null;if(ge.isArray())ue=Et.addChildRequest(je.serviceIdentifier,je,ge);else{if(je.cache)return;ue=Et}if(je.type===h.BindingTypeEnum.Instance&&je.implementationType!==null){var Pe=Q.getDependencies(Re,je.implementationType);if(!ee.container.options.skipBaseClassChecks){var we=Q.getBaseClassDependencyCount(Re,je.implementationType);if(Pe.length<we){var nt=N.ARGUMENTS_LENGTH_MISMATCH(Q.getFunctionName(je.implementationType));throw new Error(nt)}}Pe.forEach(function(at){ve(Re,!1,at.serviceIdentifier,ee,ue,at)})}})}function Te(Re,Ae){var ae=[],ee=U(Re);return ee.hasKey(Ae)?ae=ee.get(Ae):Re.parent!==null&&(ae=Te(Re.parent,Ae)),ae}function ye(Re,Ae,ae,ee,me,ge,fe,Et){Et===void 0&&(Et=!1);var xe=new F.Context(Ae),je=Z(ae,ee,me,"",ge,fe);try{return ve(Re,Et,me,xe,null,je),xe}catch(ue){throw C.isStackOverflowExeption(ue)&&xe.plan&&P.circularDependencyToException(xe.plan.rootRequest),ue}}E.plan=ye;function Ve(Re,Ae,ae,ee){var me=new K.Target(h.TargetTypeEnum.Variable,"",Ae,new Y.Metadata(ae,ee)),ge=new F.Context(Re),fe=new k.Request(Ae,ge,null,[],me);return fe}E.createMockRequest=Ve},88460:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.QueryableString=void 0;var _=function(){function D(N){this.str=N}return D.prototype.startsWith=function(N){return this.str.indexOf(N)===0},D.prototype.endsWith=function(N){var h="",O=N.split("").reverse().join("");return h=this.str.split("").reverse().join(""),this.startsWith.call({str:h},O)},D.prototype.contains=function(N){return this.str.indexOf(N)!==-1},D.prototype.equals=function(N){return this.str===N},D.prototype.value=function(){return this.str},D}();E.QueryableString=_},6e3:function(Ze,E,_){"use strict";var D=this&&this.__spreadArray||function(J,H){for(var ve=0,Te=H.length,ye=J.length;ve<Te;ve++,ye++)J[ye]=H[ve];return J};Object.defineProperty(E,"__esModule",{value:!0}),E.getFunctionName=E.getBaseClassDependencyCount=E.getDependencies=void 0;var N=_(5744),h=_(16674),O=_(28421),C=_(6867),P=_(55800);Object.defineProperty(E,"getFunctionName",{enumerable:!0,get:function(){return P.getFunctionName}});var F=_(18924);function Y(J,H){var ve=P.getFunctionName(H),Te=V(J,ve,H,!1);return Te}E.getDependencies=Y;function V(J,H,ve,Te){var ye=J.getConstructorMetadata(ve),Ve=ye.compilerGeneratedMetadata;if(Ve===void 0){var Re=h.MISSING_INJECTABLE_ANNOTATION+" "+H+".";throw new Error(Re)}var Ae=ye.userGeneratedMetadata,ae=Object.keys(Ae),ee=ve.length===0&&ae.length>0,me=ae.length>ve.length,ge=ee||me?ae.length:ve.length,fe=k(Te,H,Ve,Ae,ge),Et=K(J,ve),xe=D(D([],fe),Et);return xe}function Q(J,H,ve,Te,ye){var Ve=ye[J.toString()]||[],Re=Z(Ve),Ae=Re.unmanaged!==!0,ae=Te[J],ee=Re.inject||Re.multiInject;if(ae=ee||ae,ae instanceof N.LazyServiceIdentifer&&(ae=ae.unwrap()),Ae){var me=ae===Object,ge=ae===Function,fe=ae===void 0,Et=me||ge||fe;if(!H&&Et){var xe=h.MISSING_INJECT_ANNOTATION+" argument "+J+" in class "+ve+".";throw new Error(xe)}var je=new F.Target(O.TargetTypeEnum.ConstructorArgument,Re.targetName,ae);return je.metadata=Ve,je}return null}function k(J,H,ve,Te,ye){for(var Ve=[],Re=0;Re<ye;Re++){var Ae=Re,ae=Q(Ae,J,H,ve,Te);ae!==null&&Ve.push(ae)}return Ve}function K(J,H){for(var ve=J.getPropertiesMetadata(H),Te=[],ye=Object.keys(ve),Ve=0,Re=ye;Ve<Re.length;Ve++){var Ae=Re[Ve],ae=ve[Ae],ee=Z(ve[Ae]),me=ee.targetName||Ae,ge=ee.inject||ee.multiInject,fe=new F.Target(O.TargetTypeEnum.ClassProperty,me,ge);fe.metadata=ae,Te.push(fe)}var Et=Object.getPrototypeOf(H.prototype).constructor;if(Et!==Object){var xe=K(J,Et);Te=D(D([],Te),xe)}return Te}function U(J,H){var ve=Object.getPrototypeOf(H.prototype).constructor;if(ve!==Object){var Te=P.getFunctionName(ve),ye=V(J,Te,ve,!0),Ve=ye.map(function(ae){return ae.metadata.filter(function(ee){return ee.key===C.UNMANAGED_TAG})}),Re=[].concat.apply([],Ve).length,Ae=ye.length-Re;return Ae>0?Ae:U(J,ve)}else return 0}E.getBaseClassDependencyCount=U;function Z(J){var H={};return J.forEach(function(ve){H[ve.key.toString()]=ve.value}),{inject:H[C.INJECT_TAG],multiInject:H[C.MULTI_INJECT_TAG],targetName:H[C.NAME_TAG],unmanaged:H[C.UNMANAGED_TAG]}}},6748:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Request=void 0;var D=_(37791),N=function(){function h(O,C,P,F,Y){this.id=D.id(),this.serviceIdentifier=O,this.parentContext=C,this.parentRequest=P,this.target=Y,this.childRequests=[],this.bindings=Array.isArray(F)?F:[F],this.requestScope=P===null?new Map:null}return h.prototype.addChildRequest=function(O,C,P){var F=new h(O,this.parentContext,this,C,P);return this.childRequests.push(F),F},h}();E.Request=N},18924:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.Target=void 0;var D=_(6867),N=_(37791),h=_(47738),O=_(88460),C=function(){function P(F,Y,V,Q){this.id=N.id(),this.type=F,this.serviceIdentifier=V,this.name=new O.QueryableString(Y||""),this.metadata=new Array;var k=null;typeof Q=="string"?k=new h.Metadata(D.NAMED_TAG,Q):Q instanceof h.Metadata&&(k=Q),k!==null&&this.metadata.push(k)}return P.prototype.hasTag=function(F){for(var Y=0,V=this.metadata;Y<V.length;Y++){var Q=V[Y];if(Q.key===F)return!0}return!1},P.prototype.isArray=function(){return this.hasTag(D.MULTI_INJECT_TAG)},P.prototype.matchesArray=function(F){return this.matchesTag(D.MULTI_INJECT_TAG)(F)},P.prototype.isNamed=function(){return this.hasTag(D.NAMED_TAG)},P.prototype.isTagged=function(){return this.metadata.some(function(F){return D.NON_CUSTOM_TAG_KEYS.every(function(Y){return F.key!==Y})})},P.prototype.isOptional=function(){return this.matchesTag(D.OPTIONAL_TAG)(!0)},P.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(F){return F.key===D.NAMED_TAG})[0]:null},P.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(F){return D.NON_CUSTOM_TAG_KEYS.every(function(Y){return F.key!==Y})}):null},P.prototype.matchesNamedTag=function(F){return this.matchesTag(D.NAMED_TAG)(F)},P.prototype.matchesTag=function(F){var Y=this;return function(V){for(var Q=0,k=Y.metadata;Q<k.length;Q++){var K=k[Q];if(K.key===F&&K.value===V)return!0}return!1}},P}();E.Target=C},52279:function(Ze,E,_){"use strict";var D=this&&this.__spreadArray||function(V,Q){for(var k=0,K=Q.length,U=V.length;k<K;k++,U++)V[U]=Q[k];return V};Object.defineProperty(E,"__esModule",{value:!0}),E.resolveInstance=void 0;var N=_(16674),h=_(28421),O=_(6867);function C(V,Q,k){var K=Q.filter(function(Z){return Z.target!==null&&Z.target.type===h.TargetTypeEnum.ClassProperty}),U=K.map(k);return K.forEach(function(Z,J){var H="";H=Z.target.name.value();var ve=U[J];V[H]=ve}),V}function P(V,Q){return new(V.bind.apply(V,D([void 0],Q)))}function F(V,Q){if(Reflect.hasMetadata(O.POST_CONSTRUCT,V)){var k=Reflect.getMetadata(O.POST_CONSTRUCT,V);try{Q[k.value]()}catch(K){throw new Error(N.POST_CONSTRUCT_ERROR(V.name,K.message))}}}function Y(V,Q,k){var K=null;if(Q.length>0){var U=Q.filter(function(J){return J.target!==null&&J.target.type===h.TargetTypeEnum.ConstructorArgument}),Z=U.map(k);K=P(V,Z),K=C(K,Q,k)}else K=new V;return F(V,K),K}E.resolveInstance=Y},7478:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.resolve=void 0;var D=_(16674),N=_(28421),h=_(54623),O=_(55800),C=_(52279),P=function(V,Q,k){try{return k()}catch(K){throw h.isStackOverflowExeption(K)?new Error(D.CIRCULAR_DEPENDENCY_IN_FACTORY(V,Q.toString())):K}},F=function(V){return function(Q){Q.parentContext.setCurrentRequest(Q);var k=Q.bindings,K=Q.childRequests,U=Q.target&&Q.target.isArray(),Z=!Q.parentRequest||!Q.parentRequest.target||!Q.target||!Q.parentRequest.target.matchesArray(Q.target.serviceIdentifier);if(U&&Z)return K.map(function(Ve){var Re=F(V);return Re(Ve)});var J=null;if(Q.target.isOptional()&&k.length===0)return;var H=k[0],ve=H.scope===N.BindingScopeEnum.Singleton,Te=H.scope===N.BindingScopeEnum.Request;if(ve&&H.activated)return H.cache;if(Te&&V!==null&&V.has(H.id))return V.get(H.id);if(H.type===N.BindingTypeEnum.ConstantValue)J=H.cache,H.activated=!0;else if(H.type===N.BindingTypeEnum.Function)J=H.cache,H.activated=!0;else if(H.type===N.BindingTypeEnum.Constructor)J=H.implementationType;else if(H.type===N.BindingTypeEnum.DynamicValue&&H.dynamicValue!==null)J=P("toDynamicValue",H.serviceIdentifier,function(){return H.dynamicValue(Q.parentContext)});else if(H.type===N.BindingTypeEnum.Factory&&H.factory!==null)J=P("toFactory",H.serviceIdentifier,function(){return H.factory(Q.parentContext)});else if(H.type===N.BindingTypeEnum.Provider&&H.provider!==null)J=P("toProvider",H.serviceIdentifier,function(){return H.provider(Q.parentContext)});else if(H.type===N.BindingTypeEnum.Instance&&H.implementationType!==null)J=C.resolveInstance(H.implementationType,K,F(V));else{var ye=O.getServiceIdentifierAsString(Q.serviceIdentifier);throw new Error(D.INVALID_BINDING_TYPE+" "+ye)}return typeof H.onActivation=="function"&&(J=H.onActivation(Q.parentContext,J)),ve&&(H.cache=J,H.activated=!0),Te&&V!==null&&!V.has(H.id)&&V.set(H.id,J),J}};function Y(V){var Q=F(V.plan.rootRequest.requestScope);return Q(V.plan.rootRequest)}E.resolve=Y},83366:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingInSyntax=void 0;var D=_(28421),N=_(71325),h=function(){function O(C){this._binding=C}return O.prototype.inRequestScope=function(){return this._binding.scope=D.BindingScopeEnum.Request,new N.BindingWhenOnSyntax(this._binding)},O.prototype.inSingletonScope=function(){return this._binding.scope=D.BindingScopeEnum.Singleton,new N.BindingWhenOnSyntax(this._binding)},O.prototype.inTransientScope=function(){return this._binding.scope=D.BindingScopeEnum.Transient,new N.BindingWhenOnSyntax(this._binding)},O}();E.BindingInSyntax=h},99812:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingInWhenOnSyntax=void 0;var D=_(83366),N=_(51811),h=_(98370),O=function(){function C(P){this._binding=P,this._bindingWhenSyntax=new h.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new N.BindingOnSyntax(this._binding),this._bindingInSyntax=new D.BindingInSyntax(P)}return C.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},C.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},C.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},C.prototype.when=function(P){return this._bindingWhenSyntax.when(P)},C.prototype.whenTargetNamed=function(P){return this._bindingWhenSyntax.whenTargetNamed(P)},C.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},C.prototype.whenTargetTagged=function(P,F){return this._bindingWhenSyntax.whenTargetTagged(P,F)},C.prototype.whenInjectedInto=function(P){return this._bindingWhenSyntax.whenInjectedInto(P)},C.prototype.whenParentNamed=function(P){return this._bindingWhenSyntax.whenParentNamed(P)},C.prototype.whenParentTagged=function(P,F){return this._bindingWhenSyntax.whenParentTagged(P,F)},C.prototype.whenAnyAncestorIs=function(P){return this._bindingWhenSyntax.whenAnyAncestorIs(P)},C.prototype.whenNoAncestorIs=function(P){return this._bindingWhenSyntax.whenNoAncestorIs(P)},C.prototype.whenAnyAncestorNamed=function(P){return this._bindingWhenSyntax.whenAnyAncestorNamed(P)},C.prototype.whenAnyAncestorTagged=function(P,F){return this._bindingWhenSyntax.whenAnyAncestorTagged(P,F)},C.prototype.whenNoAncestorNamed=function(P){return this._bindingWhenSyntax.whenNoAncestorNamed(P)},C.prototype.whenNoAncestorTagged=function(P,F){return this._bindingWhenSyntax.whenNoAncestorTagged(P,F)},C.prototype.whenAnyAncestorMatches=function(P){return this._bindingWhenSyntax.whenAnyAncestorMatches(P)},C.prototype.whenNoAncestorMatches=function(P){return this._bindingWhenSyntax.whenNoAncestorMatches(P)},C.prototype.onActivation=function(P){return this._bindingOnSyntax.onActivation(P)},C}();E.BindingInWhenOnSyntax=O},51811:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingOnSyntax=void 0;var D=_(98370),N=function(){function h(O){this._binding=O}return h.prototype.onActivation=function(O){return this._binding.onActivation=O,new D.BindingWhenSyntax(this._binding)},h}();E.BindingOnSyntax=N},51860:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingToSyntax=void 0;var D=_(16674),N=_(28421),h=_(99812),O=_(71325),C=function(){function P(F){this._binding=F}return P.prototype.to=function(F){return this._binding.type=N.BindingTypeEnum.Instance,this._binding.implementationType=F,new h.BindingInWhenOnSyntax(this._binding)},P.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+D.INVALID_TO_SELF_VALUE);var F=this._binding.serviceIdentifier;return this.to(F)},P.prototype.toConstantValue=function(F){return this._binding.type=N.BindingTypeEnum.ConstantValue,this._binding.cache=F,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=N.BindingScopeEnum.Singleton,new O.BindingWhenOnSyntax(this._binding)},P.prototype.toDynamicValue=function(F){return this._binding.type=N.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=F,this._binding.implementationType=null,new h.BindingInWhenOnSyntax(this._binding)},P.prototype.toConstructor=function(F){return this._binding.type=N.BindingTypeEnum.Constructor,this._binding.implementationType=F,this._binding.scope=N.BindingScopeEnum.Singleton,new O.BindingWhenOnSyntax(this._binding)},P.prototype.toFactory=function(F){return this._binding.type=N.BindingTypeEnum.Factory,this._binding.factory=F,this._binding.scope=N.BindingScopeEnum.Singleton,new O.BindingWhenOnSyntax(this._binding)},P.prototype.toFunction=function(F){if(typeof F!="function")throw new Error(D.INVALID_FUNCTION_BINDING);var Y=this.toConstantValue(F);return this._binding.type=N.BindingTypeEnum.Function,this._binding.scope=N.BindingScopeEnum.Singleton,Y},P.prototype.toAutoFactory=function(F){return this._binding.type=N.BindingTypeEnum.Factory,this._binding.factory=function(Y){var V=function(){return Y.container.get(F)};return V},this._binding.scope=N.BindingScopeEnum.Singleton,new O.BindingWhenOnSyntax(this._binding)},P.prototype.toProvider=function(F){return this._binding.type=N.BindingTypeEnum.Provider,this._binding.provider=F,this._binding.scope=N.BindingScopeEnum.Singleton,new O.BindingWhenOnSyntax(this._binding)},P.prototype.toService=function(F){this.toDynamicValue(function(Y){return Y.container.get(F)})},P}();E.BindingToSyntax=C},71325:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingWhenOnSyntax=void 0;var D=_(51811),N=_(98370),h=function(){function O(C){this._binding=C,this._bindingWhenSyntax=new N.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new D.BindingOnSyntax(this._binding)}return O.prototype.when=function(C){return this._bindingWhenSyntax.when(C)},O.prototype.whenTargetNamed=function(C){return this._bindingWhenSyntax.whenTargetNamed(C)},O.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},O.prototype.whenTargetTagged=function(C,P){return this._bindingWhenSyntax.whenTargetTagged(C,P)},O.prototype.whenInjectedInto=function(C){return this._bindingWhenSyntax.whenInjectedInto(C)},O.prototype.whenParentNamed=function(C){return this._bindingWhenSyntax.whenParentNamed(C)},O.prototype.whenParentTagged=function(C,P){return this._bindingWhenSyntax.whenParentTagged(C,P)},O.prototype.whenAnyAncestorIs=function(C){return this._bindingWhenSyntax.whenAnyAncestorIs(C)},O.prototype.whenNoAncestorIs=function(C){return this._bindingWhenSyntax.whenNoAncestorIs(C)},O.prototype.whenAnyAncestorNamed=function(C){return this._bindingWhenSyntax.whenAnyAncestorNamed(C)},O.prototype.whenAnyAncestorTagged=function(C,P){return this._bindingWhenSyntax.whenAnyAncestorTagged(C,P)},O.prototype.whenNoAncestorNamed=function(C){return this._bindingWhenSyntax.whenNoAncestorNamed(C)},O.prototype.whenNoAncestorTagged=function(C,P){return this._bindingWhenSyntax.whenNoAncestorTagged(C,P)},O.prototype.whenAnyAncestorMatches=function(C){return this._bindingWhenSyntax.whenAnyAncestorMatches(C)},O.prototype.whenNoAncestorMatches=function(C){return this._bindingWhenSyntax.whenNoAncestorMatches(C)},O.prototype.onActivation=function(C){return this._bindingOnSyntax.onActivation(C)},O}();E.BindingWhenOnSyntax=h},98370:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.BindingWhenSyntax=void 0;var D=_(51811),N=_(80758),h=function(){function O(C){this._binding=C}return O.prototype.when=function(C){return this._binding.constraint=C,new D.BindingOnSyntax(this._binding)},O.prototype.whenTargetNamed=function(C){return this._binding.constraint=N.namedConstraint(C),new D.BindingOnSyntax(this._binding)},O.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(C){var P=C.target!==null&&!C.target.isNamed()&&!C.target.isTagged();return P},new D.BindingOnSyntax(this._binding)},O.prototype.whenTargetTagged=function(C,P){return this._binding.constraint=N.taggedConstraint(C)(P),new D.BindingOnSyntax(this._binding)},O.prototype.whenInjectedInto=function(C){return this._binding.constraint=function(P){return N.typeConstraint(C)(P.parentRequest)},new D.BindingOnSyntax(this._binding)},O.prototype.whenParentNamed=function(C){return this._binding.constraint=function(P){return N.namedConstraint(C)(P.parentRequest)},new D.BindingOnSyntax(this._binding)},O.prototype.whenParentTagged=function(C,P){return this._binding.constraint=function(F){return N.taggedConstraint(C)(P)(F.parentRequest)},new D.BindingOnSyntax(this._binding)},O.prototype.whenAnyAncestorIs=function(C){return this._binding.constraint=function(P){return N.traverseAncerstors(P,N.typeConstraint(C))},new D.BindingOnSyntax(this._binding)},O.prototype.whenNoAncestorIs=function(C){return this._binding.constraint=function(P){return!N.traverseAncerstors(P,N.typeConstraint(C))},new D.BindingOnSyntax(this._binding)},O.prototype.whenAnyAncestorNamed=function(C){return this._binding.constraint=function(P){return N.traverseAncerstors(P,N.namedConstraint(C))},new D.BindingOnSyntax(this._binding)},O.prototype.whenNoAncestorNamed=function(C){return this._binding.constraint=function(P){return!N.traverseAncerstors(P,N.namedConstraint(C))},new D.BindingOnSyntax(this._binding)},O.prototype.whenAnyAncestorTagged=function(C,P){return this._binding.constraint=function(F){return N.traverseAncerstors(F,N.taggedConstraint(C)(P))},new D.BindingOnSyntax(this._binding)},O.prototype.whenNoAncestorTagged=function(C,P){return this._binding.constraint=function(F){return!N.traverseAncerstors(F,N.taggedConstraint(C)(P))},new D.BindingOnSyntax(this._binding)},O.prototype.whenAnyAncestorMatches=function(C){return this._binding.constraint=function(P){return N.traverseAncerstors(P,C)},new D.BindingOnSyntax(this._binding)},O.prototype.whenNoAncestorMatches=function(C){return this._binding.constraint=function(P){return!N.traverseAncerstors(P,C)},new D.BindingOnSyntax(this._binding)},O}();E.BindingWhenSyntax=h},80758:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.typeConstraint=E.namedConstraint=E.taggedConstraint=E.traverseAncerstors=void 0;var D=_(6867),N=_(47738),h=function(F,Y){var V=F.parentRequest;return V!==null?Y(V)?!0:h(V,Y):!1};E.traverseAncerstors=h;var O=function(F){return function(Y){var V=function(Q){return Q!==null&&Q.target!==null&&Q.target.matchesTag(F)(Y)};return V.metaData=new N.Metadata(F,Y),V}};E.taggedConstraint=O;var C=O(D.NAMED_TAG);E.namedConstraint=C;var P=function(F){return function(Y){var V=null;if(Y!==null)if(V=Y.bindings[0],typeof F=="string"){var Q=V.serviceIdentifier;return Q===F}else{var k=Y.bindings[0].implementationType;return F===k}return!1}};E.typeConstraint=P},70600:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.multiBindToService=void 0;var _=function(D){return function(N){return function(){for(var h=[],O=0;O<arguments.length;O++)h[O]=arguments[O];return h.forEach(function(C){return D.bind(C).toService(N)})}}};E.multiBindToService=_},54623:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.isStackOverflowExeption=void 0;var D=_(16674);function N(h){return h instanceof RangeError||h.message===D.STACK_OVERFLOW}E.isStackOverflowExeption=N},37791:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.id=void 0;var _=0;function D(){return _++}E.id=D},55800:function(Ze,E,_){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.circularDependencyToException=E.listMetadataForTarget=E.listRegisteredBindingsForServiceIdentifier=E.getServiceIdentifierAsString=E.getFunctionName=void 0;var D=_(16674);function N(V){if(typeof V=="function"){var Q=V;return Q.name}else{if(typeof V=="symbol")return V.toString();var Q=V;return Q}}E.getServiceIdentifierAsString=N;function h(V,Q,k){var K="",U=k(V,Q);return U.length!==0&&(K=`
Registered bindings:`,U.forEach(function(Z){var J="Object";Z.implementationType!==null&&(J=Y(Z.implementationType)),K=K+`
 `+J,Z.constraint.metaData&&(K=K+" - "+Z.constraint.metaData)})),K}E.listRegisteredBindingsForServiceIdentifier=h;function O(V,Q){return V.parentRequest===null?!1:V.parentRequest.serviceIdentifier===Q?!0:O(V.parentRequest,Q)}function C(V){function Q(K,U){U===void 0&&(U=[]);var Z=N(K.serviceIdentifier);return U.push(Z),K.parentRequest!==null?Q(K.parentRequest,U):U}var k=Q(V);return k.reverse().join(" --> ")}function P(V){V.childRequests.forEach(function(Q){if(O(Q,Q.serviceIdentifier)){var k=C(Q);throw new Error(D.CIRCULAR_DEPENDENCY+" "+k)}else P(Q)})}E.circularDependencyToException=P;function F(V,Q){if(Q.isTagged()||Q.isNamed()){var k="",K=Q.getNamedTag(),U=Q.getCustomTags();return K!==null&&(k+=K.toString()+`
`),U!==null&&U.forEach(function(Z){k+=Z.toString()+`
`})," "+V+`
 `+V+" - "+k}else return" "+V}E.listMetadataForTarget=F;function Y(V){if(V.name)return V.name;var Q=V.toString(),k=Q.match(/^function\s*([^\s(]+)/);return k?k[1]:"Anonymous function: "+Q}E.getFunctionName=Y},47443:function(Ze,E,_){var D=_(42118);function N(h,O){var C=h==null?0:h.length;return!!C&&D(h,O,0)>-1}Ze.exports=N},1196:function(Ze){function E(_,D,N){for(var h=-1,O=_==null?0:_.length;++h<O;)if(N(D,_[h]))return!0;return!1}Ze.exports=E},29750:function(Ze){function E(_,D,N){return _===_&&(N!==void 0&&(_=_<=N?_:N),D!==void 0&&(_=_>=D?_:D)),_}Ze.exports=E},41848:function(Ze){function E(_,D,N,h){for(var O=_.length,C=N+(h?1:-1);h?C--:++C<O;)if(D(_[C],C,_))return C;return-1}Ze.exports=E},42118:function(Ze,E,_){var D=_(41848),N=_(62722),h=_(39375);function O(C,P,F){return P===P?h(C,P,F):D(C,N,F)}Ze.exports=O},74221:function(Ze){function E(_,D,N,h){for(var O=N-1,C=_.length;++O<C;)if(h(_[O],D))return O;return-1}Ze.exports=E},62722:function(Ze){function E(_){return _!==_}Ze.exports=E},65464:function(Ze,E,_){var D=_(29932),N=_(42118),h=_(74221),O=_(51717),C=_(6450),P=Array.prototype,F=P.splice;function Y(V,Q,k,K){var U=K?h:N,Z=-1,J=Q.length,H=V;for(V===Q&&(Q=C(Q)),k&&(H=D(V,O(k)));++Z<J;)for(var ve=0,Te=Q[Z],ye=k?k(Te):Te;(ve=U(H,ye,ve,K))>-1;)H!==V&&F.call(H,ve,1),F.call(V,ve,1);return V}Ze.exports=Y},45652:function(Ze,E,_){var D=_(88668),N=_(47443),h=_(1196),O=_(74757),C=_(23593),P=_(21814),F=200;function Y(V,Q,k){var K=-1,U=N,Z=V.length,J=!0,H=[],ve=H;if(k)J=!1,U=h;else if(Z>=F){var Te=Q?null:C(V);if(Te)return P(Te);J=!1,U=O,ve=new D}else ve=Q?[]:H;e:for(;++K<Z;){var ye=V[K],Ve=Q?Q(ye):ye;if(ye=k||ye!==0?ye:0,J&&Ve===Ve){for(var Re=ve.length;Re--;)if(ve[Re]===Ve)continue e;Q&&ve.push(Ve),H.push(ye)}else U(ve,Ve,k)||(ve!==H&&ve.push(Ve),H.push(ye))}return H}Ze.exports=Y},23593:function(Ze,E,_){var D=_(58525),N=_(28117),h=_(21814),O=1/0,C=D&&1/h(new D([,-0]))[1]==O?function(P){return new D(P)}:N;Ze.exports=C},39375:function(Ze){function E(_,D,N){for(var h=N-1,O=_.length;++h<O;)if(_[h]===D)return h;return-1}Ze.exports=E},74691:function(Ze,E,_){var D=_(29750),N=_(14841);function h(O,C,P){return P===void 0&&(P=C,C=void 0),P!==void 0&&(P=N(P),P=P===P?P:0),C!==void 0&&(C=N(C),C=C===C?C:0),D(N(O),C,P)}Ze.exports=h},51584:function(Ze,E,_){var D=_(44239),N=_(37005),h="[object Boolean]";function O(C){return C===!0||C===!1||N(C)&&D(C)==h}Ze.exports=O},18446:function(Ze,E,_){var D=_(90939);function N(h,O){return D(h,O)}Ze.exports=N},14293:function(Ze){function E(_){return _==null}Ze.exports=E},81763:function(Ze,E,_){var D=_(44239),N=_(37005),h="[object Number]";function O(C){return typeof C=="number"||N(C)&&D(C)==h}Ze.exports=O},52353:function(Ze){function E(_){return _===void 0}Ze.exports=E},30236:function(Ze,E,_){var D=_(42980),N=_(21463),h=N(function(O,C,P,F){D(O,C,P,F)});Ze.exports=h},28117:function(Ze){function E(){}Ze.exports=E},97019:function(Ze,E,_){var D=_(5976),N=_(45604),h=D(N);Ze.exports=h},45604:function(Ze,E,_){var D=_(65464);function N(h,O){return h&&h.length&&O&&O.length?D(h,O):h}Ze.exports=N},44908:function(Ze,E,_){var D=_(45652);function N(h){return h&&h.length?D(h):[]}Ze.exports=N},6158:function(Ze){(function(E,_){Ze.exports=_()})(this,function(){"use strict";var E,_,D;function N(h,O){if(!E)E=O;else if(!_)_=O;else{var C="var sharedChunk = {}; ("+E+")(sharedChunk); ("+_+")(sharedChunk);",P={};E(P),D=O(P),typeof window!="undefined"&&(D.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}return N(["exports"],function(h){"use strict";function O(t,o){return t(o={exports:{}},o.exports),o.exports}var C=P;function P(t,o,u,v){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(v-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=v,this.p2x=u,this.p2y=v}P.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},P.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},P.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},P.prototype.solveCurveX=function(t,o){var u,v,y,x,A;for(o===void 0&&(o=1e-6),y=t,A=0;A<8;A++){if(x=this.sampleCurveX(y)-t,Math.abs(x)<o)return y;var B=this.sampleCurveDerivativeX(y);if(Math.abs(B)<1e-6)break;y-=x/B}if((y=t)<(u=0))return u;if(y>(v=1))return v;for(;u<v;){if(x=this.sampleCurveX(y),Math.abs(x-t)<o)return y;t>x?u=y:v=y,y=.5*(v-u)+u}return y},P.prototype.solve=function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))};var F=Y;function Y(t,o){this.x=t,this.y=o}Y.prototype={clone:function(){return new Y(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,o){return this.clone()._rotateAround(t,o)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var o=t.x-this.x,u=t.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,o){return Math.atan2(this.x*o-this.y*t,this.x*t+this.y*o)},_matMult:function(t){var o=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=o,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var o=Math.cos(t),u=Math.sin(t),v=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=v,this},_rotateAround:function(t,o){var u=Math.cos(t),v=Math.sin(t),y=o.y+v*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-v*(this.y-o.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Y.convert=function(t){return t instanceof Y?t:Array.isArray(t)?new Y(t[0],t[1]):t};var V=typeof self!="undefined"?self:{},Q=Math.pow(2,53)-1;function k(t,o,u,v){var y=new C(t,o,u,v);return function(x){return y.solve(x)}}var K=k(.25,.1,.25,1);function U(t,o,u){return Math.min(u,Math.max(o,t))}function Z(t,o,u){var v=u-o,y=((t-o)%v+v)%v+o;return y===o?u:y}function J(t){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var v=0,y=o;v<y.length;v+=1){var x=y[v];for(var A in x)t[A]=x[A]}return t}var H=1;function ve(){return H++}function Te(){return function t(o){return o?(o^16*Math.random()>>o/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function ye(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Ve(t,o){t.forEach(function(u){o[u]&&(o[u]=o[u].bind(o))})}function Re(t,o){return t.indexOf(o,t.length-o.length)!==-1}function Ae(t,o,u){var v={};for(var y in t)v[y]=o.call(u||this,t[y],y,t);return v}function ae(t,o,u){var v={};for(var y in t)o.call(u||this,t[y],y,t)&&(v[y]=t[y]);return v}function ee(t){return Array.isArray(t)?t.map(ee):typeof t=="object"&&t?Ae(t,ee):t}var me={};function ge(t){me[t]||(typeof console!="undefined"&&console.warn(t),me[t]=!0)}function fe(t,o,u){return(u.y-t.y)*(o.x-t.x)>(o.y-t.y)*(u.x-t.x)}function Et(t){for(var o=0,u=0,v=t.length,y=v-1,x=void 0,A=void 0;u<v;y=u++)o+=((A=t[y]).x-(x=t[u]).x)*(x.y+A.y);return o}function xe(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function je(t){var o={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(v,y,x,A){var B=x||A;return o[y]=!B||B.toLowerCase(),""}),o["max-age"]){var u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}var ue=null;function Pe(t){if(ue==null){var o=t.navigator?t.navigator.userAgent:null;ue=!!t.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return ue}function we(t){try{var o=V[t];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch(u){return!1}}var nt,at,vt,Tt,ze=V.performance&&V.performance.now?V.performance.now.bind(V.performance):Date.now.bind(Date),gr=V.requestAnimationFrame||V.mozRequestAnimationFrame||V.webkitRequestAnimationFrame||V.msRequestAnimationFrame,At=V.cancelAnimationFrame||V.mozCancelAnimationFrame||V.webkitCancelAnimationFrame||V.msCancelAnimationFrame,hn={now:ze,frame:function(t){var o=gr(t);return{cancel:function(){return At(o)}}},getImageData:function(t,o){o===void 0&&(o=0);var u=V.document.createElement("canvas"),v=u.getContext("2d");if(!v)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,v.drawImage(t,0,0,t.width,t.height),v.getImageData(-o,-o,t.width+2*o,t.height+2*o)},resolveURL:function(t){return nt||(nt=V.document.createElement("a")),nt.href=t,nt.href},hardwareConcurrency:V.navigator&&V.navigator.hardwareConcurrency||4,get devicePixelRatio(){return V.devicePixelRatio},get prefersReducedMotion(){return!!V.matchMedia&&(at==null&&(at=V.matchMedia("(prefers-reduced-motion: reduce)")),at.matches)}},Wr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},vr={supported:!1,testSupport:function(t){!dn&&Tt&&(tn?un(t):vt=t)}},dn=!1,tn=!1;function un(t){var o=t.createTexture();t.bindTexture(t.TEXTURE_2D,o);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Tt),t.isContextLost())return;vr.supported=!0}catch(u){}t.deleteTexture(o),dn=!0}V.document&&((Tt=V.document.createElement("img")).onload=function(){vt&&un(vt),vt=null,tn=!0},Tt.onerror=function(){dn=!0,vt=null},Tt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var yn="01",Vt=function(t,o){this._transformRequestFn=t,this._customAccessToken=o,this._createSkuToken()};function dr(t){return t.indexOf("mapbox:")===0}Vt.prototype._createSkuToken=function(){var t=function(){for(var o="",u=0;u<10;u++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",yn,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},Vt.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Vt.prototype.transformRequest=function(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}},Vt.prototype.normalizeStyleURL=function(t,o){if(!dr(t))return t;var u=Ne(t);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},Vt.prototype.normalizeGlyphsURL=function(t,o){if(!dr(t))return t;var u=Ne(t);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||o)},Vt.prototype.normalizeSourceURL=function(t,o){if(!dr(t))return t;var u=Ne(t);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||o)},Vt.prototype.normalizeSpriteURL=function(t,o,u,v){var y=Ne(t);return dr(t)?(y.path="/styles/v1"+y.path+"/sprite"+o+u,this._makeAPIURL(y,this._customAccessToken||v)):(y.path+=""+o+u,Xr(y))},Vt.prototype.normalizeTileURL=function(t,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!dr(t))return t;var u=Ne(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(hn.devicePixelRatio>=2||o===512?"@2x":"")+(vr.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var v=this._customAccessToken||function(y){for(var x=0,A=y;x<A.length;x+=1){var B=A[x].match(/^access_token=(.*)$/);if(B)return B[1]}return null}(u.params)||Wr.ACCESS_TOKEN;return Wr.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,v)},Vt.prototype.canonicalizeTileURL=function(t,o){var u=Ne(t);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return t;var v="mapbox://tiles/";v+=u.path.replace("/v4/","");var y=u.params;return o&&(y=y.filter(function(x){return!x.match(/^access_token=/)})),y.length&&(v+="?"+y.join("&")),v},Vt.prototype.canonicalizeTileset=function(t,o){for(var u=!!o&&dr(o),v=[],y=0,x=t.tiles||[];y<x.length;y+=1){var A=x[y];He(A)?v.push(this.canonicalizeTileURL(A,u)):v.push(A)}return v},Vt.prototype._makeAPIURL=function(t,o){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",v=Ne(Wr.API_URL);if(t.protocol=v.protocol,t.authority=v.authority,t.protocol==="http"){var y=t.params.indexOf("secure");y>=0&&t.params.splice(y,1)}if(v.path!=="/"&&(t.path=""+v.path+t.path),!Wr.REQUIRE_ACCESS_TOKEN)return Xr(t);if(!(o=o||Wr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if(o[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return t.params=t.params.filter(function(x){return x.indexOf("access_token")===-1}),t.params.push("access_token="+o),Xr(t)};var wt=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function He(t){return wt.test(t)}var wr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ne(t){var o=t.match(wr);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Xr(t){var o=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+o}function Er(t){if(!t)return null;var o=t.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(decodeURIComponent(V.atob(o[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(u){return null}}var Ue=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ue.prototype.getStorageKey=function(t){var o,u=Er(Wr.ACCESS_TOKEN);return o=u&&u.u?V.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(v,y){return String.fromCharCode(+("0x"+y))})):Wr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+o:"mapbox.eventData:"+o},Ue.prototype.fetchEventData=function(){var t=we("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{var v=V.localStorage.getItem(o);v&&(this.eventData=JSON.parse(v));var y=V.localStorage.getItem(u);y&&(this.anonId=y)}catch(x){ge("Unable to read from LocalStorage")}},Ue.prototype.saveEventData=function(){var t=we("localStorage"),o=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{V.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&V.localStorage.setItem(o,JSON.stringify(this.eventData))}catch(v){ge("Unable to write to LocalStorage")}},Ue.prototype.processRequests=function(t){},Ue.prototype.postEvent=function(t,o,u,v){var y=this;if(Wr.EVENTS_URL){var x=Ne(Wr.EVENTS_URL);x.params.push("access_token="+(v||Wr.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:yn,userId:this.anonId},B=o?J(A,o):A,te={url:Xr(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([B])};this.pendingRequest=Wt(te,function(_e){y.pendingRequest=null,u(_e),y.saveEventData(),y.processRequests(v)})}},Ue.prototype.queueRequest=function(t,o){this.queue.push(t),this.processRequests(o)};var In,an,Qr=function(t){function o(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.postMapLoadEvent=function(u,v,y,x){this.skuToken=y;var A=!(!x&&!Wr.ACCESS_TOKEN),B=Array.isArray(u)&&u.some(function(te){return dr(te)||He(te)});Wr.EVENTS_URL&&A&&B&&this.queueRequest({id:v,timestamp:Date.now()},x)},o.prototype.processRequests=function(u){var v=this;if(!this.pendingRequest&&this.queue.length!==0){var y=this.queue.shift(),x=y.id,A=y.timestamp;x&&this.success[x]||(this.anonId||this.fetchEventData(),ye(this.anonId)||(this.anonId=Te()),this.postEvent(A,{skuToken:this.skuToken},function(B){B||x&&(v.success[x]=!0)},u))}},o}(Ue),Dn=new(function(t){function o(u){t.call(this,"appUserTurnstile"),this._customAccessToken=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.postTurnstileEvent=function(u,v){Wr.EVENTS_URL&&Wr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(y){return dr(y)||He(y)})&&this.queueRequest(Date.now(),v)},o.prototype.processRequests=function(u){var v=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var y=Er(Wr.ACCESS_TOKEN),x=y?y.u:Wr.ACCESS_TOKEN,A=x!==this.eventData.tokenU;ye(this.anonId)||(this.anonId=Te(),A=!0);var B=this.queue.shift();if(this.eventData.lastSuccess){var te=new Date(this.eventData.lastSuccess),_e=new Date(B),Ce=(B-this.eventData.lastSuccess)/864e5;A=A||Ce>=1||Ce<-1||te.getDate()!==_e.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(B,{"enabled.telemetry":!1},function(Ie){Ie||(v.eventData.lastSuccess=B,v.eventData.tokenU=x)},u)}},o}(Ue)),On=Dn.postTurnstileEvent.bind(Dn),ri=new Qr,zt=ri.postMapLoadEvent.bind(ri),cr=500,Zr=50;function Kr(){V.caches&&!In&&(In=V.caches.open("mapbox-tiles"))}function en(t){var o=t.indexOf("?");return o<0?t:t.slice(0,o)}var Wn,De=1/0;function X(){return Wn==null&&(Wn=V.OffscreenCanvas&&new V.OffscreenCanvas(1,1).getContext("2d")&&typeof V.createImageBitmap=="function"),Wn}var se={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(se);var Be=function(t){function o(u,v,y){v===401&&He(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,u),this.status=v,this.url=y,this.name=this.constructor.name,this.message=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},o}(Error),Ye=xe()?function(){return self.worker&&self.worker.referrer}:function(){return(V.location.protocol==="blob:"?V.parent:V).location.href},ct,sr,ar=function(t,o){if(!(/^file:/.test(u=t.url)||/^file:/.test(Ye())&&!/^\w+:/.test(u))){if(V.fetch&&V.Request&&V.AbortController&&V.Request.prototype.hasOwnProperty("signal"))return function(v,y){var x,A=new V.AbortController,B=new V.Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,referrer:Ye(),signal:A.signal}),te=!1,_e=!1,Ce=(x=B.url).indexOf("sku=")>0&&He(x);v.type==="json"&&B.headers.set("Accept","application/json");var Ie=function(tt,Mt,Pt){if(!_e){if(tt&&tt.message!=="SecurityError"&&ge(tt),Mt&&Pt)return Xe(Mt);var qt=Date.now();V.fetch(B).then(function(Zt){if(Zt.ok){var pr=Ce?Zt.clone():null;return Xe(Zt,pr,qt)}return y(new Be(Zt.statusText,Zt.status,v.url))}).catch(function(Zt){Zt.code!==20&&y(new Error(Zt.message))})}},Xe=function(tt,Mt,Pt){(v.type==="arrayBuffer"?tt.arrayBuffer():v.type==="json"?tt.json():tt.text()).then(function(qt){_e||(Mt&&Pt&&function(Zt,pr,Sr){if(Kr(),In){var Br={status:pr.status,statusText:pr.statusText,headers:new V.Headers};pr.headers.forEach(function(fn,Nn){return Br.headers.set(Nn,fn)});var Vr=je(pr.headers.get("Cache-Control")||"");Vr["no-store"]||(Vr["max-age"]&&Br.headers.set("Expires",new Date(Sr+1e3*Vr["max-age"]).toUTCString()),new Date(Br.headers.get("Expires")).getTime()-Sr<42e4||function(fn,Nn){if(an===void 0)try{new Response(new ReadableStream),an=!0}catch(qn){an=!1}an?Nn(fn.body):fn.blob().then(Nn)}(pr,function(fn){var Nn=new V.Response(fn,Br);Kr(),In&&In.then(function(qn){return qn.put(en(Zt.url),Nn)}).catch(function(qn){return ge(qn.message)})}))}}(B,Mt,Pt),te=!0,y(null,qt,tt.headers.get("Cache-Control"),tt.headers.get("Expires")))}).catch(function(qt){_e||y(new Error(qt.message))})};return Ce?function(tt,Mt){if(Kr(),!In)return Mt(null);var Pt=en(tt.url);In.then(function(qt){qt.match(Pt).then(function(Zt){var pr=function(Sr){if(!Sr)return!1;var Br=new Date(Sr.headers.get("Expires")||0),Vr=je(Sr.headers.get("Cache-Control")||"");return Br>Date.now()&&!Vr["no-cache"]}(Zt);qt.delete(Pt),pr&&qt.put(Pt,Zt.clone()),Mt(null,Zt,pr)}).catch(Mt)}).catch(Mt)}(B,Ie):Ie(null,null),{cancel:function(){_e=!0,te||A.abort()}}}(t,o);if(xe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,o,void 0,!0)}var u;return function(v,y){var x=new V.XMLHttpRequest;for(var A in x.open(v.method||"GET",v.url,!0),v.type==="arrayBuffer"&&(x.responseType="arraybuffer"),v.headers)x.setRequestHeader(A,v.headers[A]);return v.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=v.credentials==="include",x.onerror=function(){y(new Error(x.statusText))},x.onload=function(){if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){var B=x.response;if(v.type==="json")try{B=JSON.parse(x.response)}catch(te){return y(te)}y(null,B,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else y(new Be(x.statusText,x.status,v.url))},x.send(v.body),{cancel:function(){return x.abort()}}}(t,o)},or=function(t,o){return ar(J(t,{type:"arrayBuffer"}),o)},Wt=function(t,o){return ar(J(t,{method:"POST"}),o)},oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ct=[],sr=0;var ie=function(t,o){if(vr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),sr>=Wr.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:o,cancelled:!1,cancel:function(){this.cancelled=!0}};return ct.push(u),u}sr++;var v=!1,y=function(){if(!v)for(v=!0,sr--;ct.length&&sr<Wr.MAX_PARALLEL_IMAGE_REQUESTS;){var A=ct.shift();A.cancelled||(A.cancel=ie(A.requestParameters,A.callback).cancel)}},x=or(t,function(A,B,te,_e){y(),A?o(A):B&&(X()?function(Ce,Ie){var Xe=new V.Blob([new Uint8Array(Ce)],{type:"image/png"});V.createImageBitmap(Xe).then(function(tt){Ie(null,tt)}).catch(function(tt){Ie(new Error("Could not load image because of "+tt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(B,o):function(Ce,Ie,Xe,tt){var Mt=new V.Image,Pt=V.URL;Mt.onload=function(){Ie(null,Mt),Pt.revokeObjectURL(Mt.src),Mt.onload=null,V.requestAnimationFrame(function(){Mt.src=oe})},Mt.onerror=function(){return Ie(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var qt=new V.Blob([new Uint8Array(Ce)],{type:"image/png"});Mt.cacheControl=Xe,Mt.expires=tt,Mt.src=Ce.byteLength?Pt.createObjectURL(qt):oe}(B,o,te,_e))});return{cancel:function(){x.cancel(),y()}}};function be(t,o,u){u[t]&&u[t].indexOf(o)!==-1||(u[t]=u[t]||[],u[t].push(o))}function ke(t,o,u){if(u&&u[t]){var v=u[t].indexOf(o);v!==-1&&u[t].splice(v,1)}}var qe=function(t,o){o===void 0&&(o={}),J(this,o),this.type=t},mt=function(t){function o(u,v){v===void 0&&(v={}),t.call(this,"error",J({error:u},v))}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(qe),kt=function(){};kt.prototype.on=function(t,o){return this._listeners=this._listeners||{},be(t,o,this._listeners),this},kt.prototype.off=function(t,o){return ke(t,o,this._listeners),ke(t,o,this._oneTimeListeners),this},kt.prototype.once=function(t,o){return this._oneTimeListeners=this._oneTimeListeners||{},be(t,o,this._oneTimeListeners),this},kt.prototype.fire=function(t,o){typeof t=="string"&&(t=new qe(t,o||{}));var u=t.type;if(this.listens(u)){t.target=this;for(var v=0,y=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];v<y.length;v+=1)y[v].call(this,t);for(var x=0,A=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];x<A.length;x+=1){var B=A[x];ke(u,B,this._oneTimeListeners),B.call(this,t)}var te=this._eventedParent;te&&(J(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),te.fire(t))}else t instanceof mt&&console.error(t.error);return this},kt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},kt.prototype.setEventedParent=function(t,o){return this._eventedParent=t,this._eventedParentData=o,this};var $e={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ge=function(t,o,u,v){this.message=(t?t+": ":"")+u,v&&(this.identifier=v),o!=null&&o.__line__&&(this.line=o.__line__)};function We(t){var o=t.value;return o?[new Ge(t.key,o,"constants have been deprecated as of v8")]:[]}function G(t){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];for(var v=0,y=o;v<y.length;v+=1){var x=y[v];for(var A in x)t[A]=x[A]}return t}function rt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function ft(t){if(Array.isArray(t))return t.map(ft);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var o={};for(var u in t)o[u]=ft(t[u]);return o}return rt(t)}var bt=function(t){function o(u,v){t.call(this,v),this.message=v,this.key=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Error),Gt=function(t,o){o===void 0&&(o=[]),this.parent=t,this.bindings={};for(var u=0,v=o;u<v.length;u+=1){var y=v[u];this.bindings[y[0]]=y[1]}};Gt.prototype.concat=function(t){return new Gt(this,t)},Gt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Gt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var lr={kind:"null"},Ht={kind:"number"},Cr={kind:"string"},hr={kind:"boolean"},Dr={kind:"color"},Rn={kind:"object"},on={kind:"value"},fi={kind:"collator"},Mi={kind:"formatted"},di={kind:"resolvedImage"};function mn(t,o){return{kind:"array",itemType:t,N:o}}function Zn(t){if(t.kind==="array"){var o=Zn(t.itemType);return typeof t.N=="number"?"array<"+o+", "+t.N+">":t.itemType.kind==="value"?"array":"array<"+o+">"}return t.kind}var sa=[lr,Ht,Cr,hr,Dr,Mi,Rn,mn(on),di];function qi(t,o){if(o.kind==="error")return null;if(t.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!qi(t.itemType,o.itemType))&&(typeof t.N!="number"||t.N===o.N))return null}else{if(t.kind===o.kind)return null;if(t.kind==="value"){for(var u=0,v=sa;u<v.length;u+=1)if(!qi(v[u],o))return null}}return"Expected "+Zn(t)+" but found "+Zn(o)+" instead."}function Sa(t,o){return o.some(function(u){return u.kind===t.kind})}function Zi(t,o){return o.some(function(u){return u==="null"?t===null:u==="array"?Array.isArray(t):u==="object"?t&&!Array.isArray(t)&&typeof t=="object":u===typeof t})}var Oi=O(function(t,o){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function v(B){return(B=Math.round(B))<0?0:B>255?255:B}function y(B){return v(B[B.length-1]==="%"?parseFloat(B)/100*255:parseInt(B))}function x(B){return(te=B[B.length-1]==="%"?parseFloat(B)/100:parseFloat(B))<0?0:te>1?1:te;var te}function A(B,te,_e){return _e<0?_e+=1:_e>1&&(_e-=1),6*_e<1?B+(te-B)*_e*6:2*_e<1?te:3*_e<2?B+(te-B)*(2/3-_e)*6:B}try{o.parseCSSColor=function(B){var te,_e=B.replace(/ /g,"").toLowerCase();if(_e in u)return u[_e].slice();if(_e[0]==="#")return _e.length===4?(te=parseInt(_e.substr(1),16))>=0&&te<=4095?[(3840&te)>>4|(3840&te)>>8,240&te|(240&te)>>4,15&te|(15&te)<<4,1]:null:_e.length===7&&(te=parseInt(_e.substr(1),16))>=0&&te<=16777215?[(16711680&te)>>16,(65280&te)>>8,255&te,1]:null;var Ce=_e.indexOf("("),Ie=_e.indexOf(")");if(Ce!==-1&&Ie+1===_e.length){var Xe=_e.substr(0,Ce),tt=_e.substr(Ce+1,Ie-(Ce+1)).split(","),Mt=1;switch(Xe){case"rgba":if(tt.length!==4)return null;Mt=x(tt.pop());case"rgb":return tt.length!==3?null:[y(tt[0]),y(tt[1]),y(tt[2]),Mt];case"hsla":if(tt.length!==4)return null;Mt=x(tt.pop());case"hsl":if(tt.length!==3)return null;var Pt=(parseFloat(tt[0])%360+360)%360/360,qt=x(tt[1]),Zt=x(tt[2]),pr=Zt<=.5?Zt*(qt+1):Zt+qt-Zt*qt,Sr=2*Zt-pr;return[v(255*A(Sr,pr,Pt+1/3)),v(255*A(Sr,pr,Pt)),v(255*A(Sr,pr,Pt-1/3)),Mt];default:return null}}return null}}catch(B){}}).parseCSSColor,jr=function(t,o,u,v){v===void 0&&(v=1),this.r=t,this.g=o,this.b=u,this.a=v};jr.parse=function(t){if(t){if(t instanceof jr)return t;if(typeof t=="string"){var o=Oi(t);if(o)return new jr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3])}}},jr.prototype.toString=function(){var t=this.toArray(),o=t[1],u=t[2],v=t[3];return"rgba("+Math.round(t[0])+","+Math.round(o)+","+Math.round(u)+","+v+")"},jr.prototype.toArray=function(){var t=this.a;return t===0?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},jr.black=new jr(0,0,0,1),jr.white=new jr(1,1,1,1),jr.transparent=new jr(0,0,0,0),jr.red=new jr(1,0,0,1);var Fi=function(t,o,u){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Fi.prototype.compare=function(t,o){return this.collator.compare(t,o)},Fi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ls=function(t,o,u,v,y){this.text=t,this.image=o,this.scale=u,this.fontStack=v,this.textColor=y},Ta=function(t){this.sections=t};Ta.fromString=function(t){return new Ta([new Ls(t,null,null,null,null)])},Ta.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(t){return t.text.length!==0||t.image&&t.image.name.length!==0})},Ta.factory=function(t){return t instanceof Ta?t:Ta.fromString(t)},Ta.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(t){return t.text}).join("")},Ta.prototype.serialize=function(){for(var t=["format"],o=0,u=this.sections;o<u.length;o+=1){var v=u[o];if(v.image)t.push(["image",v.image.name]);else{t.push(v.text);var y={};v.fontStack&&(y["text-font"]=["literal",v.fontStack.split(",")]),v.scale&&(y["font-scale"]=v.scale),v.textColor&&(y["text-color"]=["rgba"].concat(v.textColor.toArray())),t.push(y)}}return t};var Aa=function(t){this.name=t.name,this.available=t.available};function go(t,o,u,v){return typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:"Invalid rgba value ["+[t,o,u,v].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof v=="number"?[t,o,u,v]:[t,o,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function os(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof jr||t instanceof Fi||t instanceof Ta||t instanceof Aa)return!0;if(Array.isArray(t)){for(var o=0,u=t;o<u.length;o+=1)if(!os(u[o]))return!1;return!0}if(typeof t=="object"){for(var v in t)if(!os(t[v]))return!1;return!0}return!1}function ka(t){if(t===null)return lr;if(typeof t=="string")return Cr;if(typeof t=="boolean")return hr;if(typeof t=="number")return Ht;if(t instanceof jr)return Dr;if(t instanceof Fi)return fi;if(t instanceof Ta)return Mi;if(t instanceof Aa)return di;if(Array.isArray(t)){for(var o,u=t.length,v=0,y=t;v<y.length;v+=1){var x=ka(y[v]);if(o){if(o===x)continue;o=on;break}o=x}return mn(o||on,u)}return Rn}function Ao(t){var o=typeof t;return t===null?"":o==="string"||o==="number"||o==="boolean"?String(t):t instanceof jr||t instanceof Ta||t instanceof Aa?t.toString():JSON.stringify(t)}Aa.prototype.toString=function(){return this.name},Aa.fromString=function(t){return t?new Aa({name:t,available:!1}):null},Aa.prototype.serialize=function(){return["image",this.name]};var za=function(t,o){this.type=t,this.value=o};za.parse=function(t,o){if(t.length!==2)return o.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!os(t[1]))return o.error("invalid value");var u=t[1],v=ka(u),y=o.expectedType;return v.kind!=="array"||v.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(v=y),new za(v,u)},za.prototype.evaluate=function(){return this.value},za.prototype.eachChild=function(){},za.prototype.outputDefined=function(){return!0},za.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof jr?["rgba"].concat(this.value.toArray()):this.value instanceof Ta?this.value.serialize():this.value};var Ja=function(t){this.name="ExpressionEvaluationError",this.message=t};Ja.prototype.toJSON=function(){return this.message};var Oa={string:Cr,number:Ht,boolean:hr,object:Rn},Za=function(t,o){this.type=t,this.args=o};Za.parse=function(t,o){if(t.length<2)return o.error("Expected at least one argument.");var u,v=1,y=t[0];if(y==="array"){var x,A;if(t.length>2){var B=t[1];if(typeof B!="string"||!(B in Oa)||B==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);x=Oa[B],v++}else x=on;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);A=t[2],v++}u=mn(x,A)}else u=Oa[y];for(var te=[];v<t.length;v++){var _e=o.parse(t[v],v,on);if(!_e)return null;te.push(_e)}return new Za(u,te)},Za.prototype.evaluate=function(t){for(var o=0;o<this.args.length;o++){var u=this.args[o].evaluate(t);if(!qi(this.type,ka(u)))return u;if(o===this.args.length-1)throw new Ja("Expected value to be of type "+Zn(this.type)+", but found "+Zn(ka(u))+" instead.")}return null},Za.prototype.eachChild=function(t){this.args.forEach(t)},Za.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Za.prototype.serialize=function(){var t=this.type,o=[t.kind];if(t.kind==="array"){var u=t.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);var v=t.N;(typeof v=="number"||this.args.length>1)&&o.push(v)}}return o.concat(this.args.map(function(y){return y.serialize()}))};var qo=function(t){this.type=Mi,this.sections=t};qo.parse=function(t,o){if(t.length<2)return o.error("Expected at least one argument.");var u=t[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");for(var v=[],y=!1,x=1;x<=t.length-1;++x){var A=t[x];if(y&&typeof A=="object"&&!Array.isArray(A)){y=!1;var B=null;if(A["font-scale"]&&!(B=o.parse(A["font-scale"],1,Ht)))return null;var te=null;if(A["text-font"]&&!(te=o.parse(A["text-font"],1,mn(Cr))))return null;var _e=null;if(A["text-color"]&&!(_e=o.parse(A["text-color"],1,Dr)))return null;var Ce=v[v.length-1];Ce.scale=B,Ce.font=te,Ce.textColor=_e}else{var Ie=o.parse(t[x],1,on);if(!Ie)return null;var Xe=Ie.type.kind;if(Xe!=="string"&&Xe!=="value"&&Xe!=="null"&&Xe!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,v.push({content:Ie,scale:null,font:null,textColor:null})}}return new qo(v)},qo.prototype.evaluate=function(t){return new Ta(this.sections.map(function(o){var u=o.content.evaluate(t);return ka(u)===di?new Ls("",u,null,null,null):new Ls(Ao(u),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))},qo.prototype.eachChild=function(t){for(var o=0,u=this.sections;o<u.length;o+=1){var v=u[o];t(v.content),v.scale&&t(v.scale),v.font&&t(v.font),v.textColor&&t(v.textColor)}},qo.prototype.outputDefined=function(){return!1},qo.prototype.serialize=function(){for(var t=["format"],o=0,u=this.sections;o<u.length;o+=1){var v=u[o];t.push(v.content.serialize());var y={};v.scale&&(y["font-scale"]=v.scale.serialize()),v.font&&(y["text-font"]=v.font.serialize()),v.textColor&&(y["text-color"]=v.textColor.serialize()),t.push(y)}return t};var Ca=function(t){this.type=di,this.input=t};Ca.parse=function(t,o){if(t.length!==2)return o.error("Expected two arguments.");var u=o.parse(t[1],1,Cr);return u?new Ca(u):o.error("No image name provided.")},Ca.prototype.evaluate=function(t){var o=this.input.evaluate(t),u=Aa.fromString(o);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(o)>-1),u},Ca.prototype.eachChild=function(t){t(this.input)},Ca.prototype.outputDefined=function(){return!1},Ca.prototype.serialize=function(){return["image",this.input.serialize()]};var io={"to-boolean":hr,"to-color":Dr,"to-number":Ht,"to-string":Cr},Do=function(t,o){this.type=t,this.args=o};Do.parse=function(t,o){if(t.length<2)return o.error("Expected at least one argument.");var u=t[0];if((u==="to-boolean"||u==="to-string")&&t.length!==2)return o.error("Expected one argument.");for(var v=io[u],y=[],x=1;x<t.length;x++){var A=o.parse(t[x],x,on);if(!A)return null;y.push(A)}return new Do(v,y)},Do.prototype.evaluate=function(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){for(var o,u,v=0,y=this.args;v<y.length;v+=1){if(u=null,(o=y[v].evaluate(t))instanceof jr)return o;if(typeof o=="string"){var x=t.parseColor(o);if(x)return x}else if(Array.isArray(o)&&!(u=o.length<3||o.length>4?"Invalid rbga value "+JSON.stringify(o)+": expected an array containing either three or four numeric values.":go(o[0],o[1],o[2],o[3])))return new jr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Ja(u||"Could not parse color from value '"+(typeof o=="string"?o:String(JSON.stringify(o)))+"'")}if(this.type.kind==="number"){for(var A=null,B=0,te=this.args;B<te.length;B+=1){if((A=te[B].evaluate(t))===null)return 0;var _e=Number(A);if(!isNaN(_e))return _e}throw new Ja("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?Ta.fromString(Ao(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Aa.fromString(Ao(this.args[0].evaluate(t))):Ao(this.args[0].evaluate(t))},Do.prototype.eachChild=function(t){this.args.forEach(t)},Do.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Do.prototype.serialize=function(){if(this.type.kind==="formatted")return new qo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ca(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(o){t.push(o.serialize())}),t};var $=["Unknown","Point","LineString","Polygon"],ho=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ho.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ho.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?$[this.feature.type]:this.feature.type:null},ho.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ho.prototype.canonicalID=function(){return this.canonical},ho.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ho.prototype.parseColor=function(t){var o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=jr.parse(t)),o};var ja=function(t,o,u,v){this.name=t,this.type=o,this._evaluate=u,this.args=v};ja.prototype.evaluate=function(t){return this._evaluate(t,this.args)},ja.prototype.eachChild=function(t){this.args.forEach(t)},ja.prototype.outputDefined=function(){return!1},ja.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},ja.parse=function(t,o){var u,v=t[0],y=ja.definitions[v];if(!y)return o.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0);for(var x=Array.isArray(y)?y[0]:y.type,A=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,B=A.filter(function(ki){var hi=ki[0];return!Array.isArray(hi)||hi.length===t.length-1}),te=null,_e=0,Ce=B;_e<Ce.length;_e+=1){var Ie=Ce[_e],Xe=Ie[0],tt=Ie[1];te=new El(o.registry,o.path,null,o.scope);for(var Mt=[],Pt=!1,qt=1;qt<t.length;qt++){var Zt=t[qt],pr=Array.isArray(Xe)?Xe[qt-1]:Xe.type,Sr=te.parse(Zt,1+Mt.length,pr);if(!Sr){Pt=!0;break}Mt.push(Sr)}if(!Pt)if(Array.isArray(Xe)&&Xe.length!==Mt.length)te.error("Expected "+Xe.length+" arguments, but found "+Mt.length+" instead.");else{for(var Br=0;Br<Mt.length;Br++){var Vr=Array.isArray(Xe)?Xe[Br]:Xe.type,fn=Mt[Br];te.concat(Br+1).checkSubtype(Vr,fn.type)}if(te.errors.length===0)return new ja(v,x,tt,Mt)}}if(B.length===1)(u=o.errors).push.apply(u,te.errors);else{for(var Nn=(B.length?B:A).map(function(ki){var hi;return hi=ki[0],Array.isArray(hi)?"("+hi.map(Zn).join(", ")+")":"("+Zn(hi.type)+"...)"}).join(" | "),qn=[],Di=1;Di<t.length;Di++){var ci=o.parse(t[Di],1+qn.length);if(!ci)return null;qn.push(Zn(ci.type))}o.error("Expected arguments of type "+Nn+", but found ("+qn.join(", ")+") instead.")}return null},ja.register=function(t,o){for(var u in ja.definitions=o,o)t[u]=ja};var gs=function(t,o,u){this.type=fi,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=o};function Vo(t,o){t[0]=Math.min(t[0],o[0]),t[1]=Math.min(t[1],o[1]),t[2]=Math.max(t[2],o[0]),t[3]=Math.max(t[3],o[1])}function Je(t,o){return!(t[0]<=o[0]||t[2]>=o[2]||t[1]<=o[1]||t[3]>=o[3])}function yt(t,o){var u=(180+t[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,y=Math.pow(2,o.z);return[Math.round(u*y*8192),Math.round(v*y*8192)]}function Qt(t,o,u){return o[1]>t[1]!=u[1]>t[1]&&t[0]<(u[0]-o[0])*(t[1]-o[1])/(u[1]-o[1])+o[0]}function Ur(t,o){for(var u,v,y,x,A,B,te,_e=!1,Ce=0,Ie=o.length;Ce<Ie;Ce++)for(var Xe=o[Ce],tt=0,Mt=Xe.length;tt<Mt-1;tt++){if((x=(u=t)[0]-(v=Xe[tt])[0])*(te=u[1]-(y=Xe[tt+1])[1])-(B=u[0]-y[0])*(A=u[1]-v[1])==0&&x*B<=0&&A*te<=0)return!1;Qt(t,Xe[tt],Xe[tt+1])&&(_e=!_e)}return _e}function Tn(t,o){for(var u=0;u<o.length;u++)if(Ur(t,o[u]))return!0;return!1}function mi(t,o,u,v){var y=v[0]-u[0],x=v[1]-u[1],A=(t[0]-u[0])*x-y*(t[1]-u[1]),B=(o[0]-u[0])*x-y*(o[1]-u[1]);return A>0&&B<0||A<0&&B>0}function la(t,o,u){for(var v=0,y=u;v<y.length;v+=1)for(var x=y[v],A=0;A<x.length-1;++A)if((Ie=[(Ce=x[A+1])[0]-(_e=x[A])[0],Ce[1]-_e[1]])[0]*(Xe=[(te=o)[0]-(B=t)[0],te[1]-B[1]])[1]-Ie[1]*Xe[0]!=0&&mi(B,te,_e,Ce)&&mi(_e,Ce,B,te))return!0;var B,te,_e,Ce,Ie,Xe;return!1}function Ho(t,o){for(var u=0;u<t.length;++u)if(!Ur(t[u],o))return!1;for(var v=0;v<t.length-1;++v)if(la(t[v],t[v+1],o))return!1;return!0}function ss(t,o){for(var u=0;u<o.length;u++)if(Ho(t,o[u]))return!0;return!1}function ko(t,o,u){for(var v=[],y=0;y<t.length;y++){for(var x=[],A=0;A<t[y].length;A++){var B=yt(t[y][A],u);Vo(o,B),x.push(B)}v.push(x)}return v}function gu(t,o,u){for(var v=[],y=0;y<t.length;y++){var x=ko(t[y],o,u);v.push(x)}return v}function Ws(t,o,u,v){if(t[0]<u[0]||t[0]>u[2]){var y=.5*v,x=t[0]-u[0]>y?-v:u[0]-t[0]>y?v:0;x===0&&(x=t[0]-u[2]>y?-v:u[2]-t[0]>y?v:0),t[0]+=x}Vo(o,t)}function cf(t,o,u,v){for(var y=8192*Math.pow(2,v.z),x=[8192*v.x,8192*v.y],A=[],B=0,te=t;B<te.length;B+=1)for(var _e=0,Ce=te[B];_e<Ce.length;_e+=1){var Ie=Ce[_e],Xe=[Ie.x+x[0],Ie.y+x[1]];Ws(Xe,o,u,y),A.push(Xe)}return A}function ff(t,o,u,v){for(var y,x=8192*Math.pow(2,v.z),A=[8192*v.x,8192*v.y],B=[],te=0,_e=t;te<_e.length;te+=1){for(var Ce=[],Ie=0,Xe=_e[te];Ie<Xe.length;Ie+=1){var tt=Xe[Ie],Mt=[tt.x+A[0],tt.y+A[1]];Vo(o,Mt),Ce.push(Mt)}B.push(Ce)}if(o[2]-o[0]<=x/2){(y=o)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(var Pt=0,qt=B;Pt<qt.length;Pt+=1)for(var Zt=0,pr=qt[Pt];Zt<pr.length;Zt+=1)Ws(pr[Zt],o,u,x)}return B}gs.parse=function(t,o){if(t.length!==2)return o.error("Expected one argument.");var u=t[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");var v=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,hr);if(!v)return null;var y=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,hr);if(!y)return null;var x=null;return u.locale&&!(x=o.parse(u.locale,1,Cr))?null:new gs(v,y,x)},gs.prototype.evaluate=function(t){return new Fi(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},gs.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},gs.prototype.outputDefined=function(){return!1},gs.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ys=function(t,o){this.type=hr,this.geojson=t,this.geometries=o};function bl(t){if(t instanceof ja&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof ys)return!1;var o=!0;return t.eachChild(function(u){o&&!bl(u)&&(o=!1)}),o}function xl(t){if(t instanceof ja&&t.name==="feature-state")return!1;var o=!0;return t.eachChild(function(u){o&&!xl(u)&&(o=!1)}),o}function ds(t,o){if(t instanceof ja&&o.indexOf(t.name)>=0)return!1;var u=!0;return t.eachChild(function(v){u&&!ds(v,o)&&(u=!1)}),u}ys.parse=function(t,o){if(t.length!==2)return o.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(os(t[1])){var u=t[1];if(u.type==="FeatureCollection")for(var v=0;v<u.features.length;++v){var y=u.features[v].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new ys(u,u.features[v].geometry)}else if(u.type==="Feature"){var x=u.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new ys(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new ys(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ys.prototype.evaluate=function(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,u){var v=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){var A=ko(u.coordinates,y,x),B=cf(o.geometry(),v,y,x);if(!Je(v,y))return!1;for(var te=0,_e=B;te<_e.length;te+=1)if(!Ur(_e[te],A))return!1}if(u.type==="MultiPolygon"){var Ce=gu(u.coordinates,y,x),Ie=cf(o.geometry(),v,y,x);if(!Je(v,y))return!1;for(var Xe=0,tt=Ie;Xe<tt.length;Xe+=1)if(!Tn(tt[Xe],Ce))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,u){var v=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){var A=ko(u.coordinates,y,x),B=ff(o.geometry(),v,y,x);if(!Je(v,y))return!1;for(var te=0,_e=B;te<_e.length;te+=1)if(!Ho(_e[te],A))return!1}if(u.type==="MultiPolygon"){var Ce=gu(u.coordinates,y,x),Ie=ff(o.geometry(),v,y,x);if(!Je(v,y))return!1;for(var Xe=0,tt=Ie;Xe<tt.length;Xe+=1)if(!ss(tt[Xe],Ce))return!1}return!0}(t,this.geometries)}return!1},ys.prototype.eachChild=function(){},ys.prototype.outputDefined=function(){return!0},ys.prototype.serialize=function(){return["within",this.geojson]};var Qu=function(t,o){this.type=o.type,this.name=t,this.boundExpression=o};Qu.parse=function(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");var u=t[1];return o.scope.has(u)?new Qu(u,o.scope.get(u)):o.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},Qu.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Qu.prototype.eachChild=function(){},Qu.prototype.outputDefined=function(){return!1},Qu.prototype.serialize=function(){return["var",this.name]};var El=function(t,o,u,v,y){o===void 0&&(o=[]),v===void 0&&(v=new Gt),y===void 0&&(y=[]),this.registry=t,this.path=o,this.key=o.map(function(x){return"["+x+"]"}).join(""),this.scope=v,this.errors=y,this.expectedType=u};function Fl(t,o){for(var u,v=t.length-1,y=0,x=v,A=0;y<=x;)if((u=t[A=Math.floor((y+x)/2)])<=o){if(A===v||o<t[A+1])return A;y=A+1}else{if(!(u>o))throw new Ja("Input is not a number.");x=A-1}return 0}El.prototype.parse=function(t,o,u,v,y){return y===void 0&&(y={}),o?this.concat(o,u,v)._parse(t,y):this._parse(t,y)},El.prototype._parse=function(t,o){function u(_e,Ce,Ie){return Ie==="assert"?new Za(Ce,[_e]):Ie==="coerce"?new Do(Ce,[_e]):_e}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var v=t[0];if(typeof v!="string")return this.error("Expression name must be a string, but found "+typeof v+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var y=this.registry[v];if(y){var x=y.parse(t,this);if(!x)return null;if(this.expectedType){var A=this.expectedType,B=x.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||B.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||B.kind!=="value"&&B.kind!=="string"){if(this.checkSubtype(A,B))return null}else x=u(x,A,o.typeAnnotation||"coerce");else x=u(x,A,o.typeAnnotation||"assert")}if(!(x instanceof za)&&x.type.kind!=="resolvedImage"&&function _e(Ce){if(Ce instanceof Qu)return _e(Ce.boundExpression);if(Ce instanceof ja&&Ce.name==="error"||Ce instanceof gs||Ce instanceof ys)return!1;var Ie=Ce instanceof Do||Ce instanceof Za,Xe=!0;return Ce.eachChild(function(tt){Xe=Ie?Xe&&_e(tt):Xe&&tt instanceof za}),!!Xe&&bl(Ce)&&ds(Ce,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(x)){var te=new ho;try{x=new za(x.type,x.evaluate(te))}catch(_e){return this.error(_e.message),null}}return x}return this.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},El.prototype.concat=function(t,o,u){var v=typeof t=="number"?this.path.concat(t):this.path,y=u?this.scope.concat(u):this.scope;return new El(this.registry,v,o||null,y,this.errors)},El.prototype.error=function(t){for(var o=[],u=arguments.length-1;u-- >0;)o[u]=arguments[u+1];var v=""+this.key+o.map(function(y){return"["+y+"]"}).join("");this.errors.push(new bt(v,t))},El.prototype.checkSubtype=function(t,o){var u=qi(t,o);return u&&this.error(u),u};var gn=function(t,o,u){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(var v=0,y=u;v<y.length;v+=1){var x=y[v],A=x[1];this.labels.push(x[0]),this.outputs.push(A)}};function Ai(t,o,u){return t*(1-u)+o*u}gn.parse=function(t,o){if(t.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");var u=o.parse(t[1],1,Ht);if(!u)return null;var v=[],y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(var x=1;x<t.length;x+=2){var A=x===1?-1/0:t[x],B=t[x+1],te=x,_e=x+1;if(typeof A!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',te);if(v.length&&v[v.length-1][0]>=A)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',te);var Ce=o.parse(B,_e,y);if(!Ce)return null;y=y||Ce.type,v.push([A,Ce])}return new gn(y,u,v)},gn.prototype.evaluate=function(t){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);var v=this.input.evaluate(t);if(v<=o[0])return u[0].evaluate(t);var y=o.length;return v>=o[y-1]?u[y-1].evaluate(t):u[Fl(o,v)].evaluate(t)},gn.prototype.eachChild=function(t){t(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)t(u[o])},gn.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},gn.prototype.serialize=function(){for(var t=["step",this.input.serialize()],o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t};var Hi=Object.freeze({__proto__:null,number:Ai,color:function(t,o,u){return new jr(Ai(t.r,o.r,u),Ai(t.g,o.g,u),Ai(t.b,o.b,u),Ai(t.a,o.a,u))},array:function(t,o,u){return t.map(function(v,y){return Ai(v,o[y],u)})}}),kn=6/29*3*(6/29),us=Math.PI/180,Sl=180/Math.PI;function Ic(t){return t>.008856451679035631?Math.pow(t,1/3):t/kn+4/29}function hf(t){return t>6/29?t*t*t:kn*(t-4/29)}function Oc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function df(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pf(t){var o=df(t.r),u=df(t.g),v=df(t.b),y=Ic((.4124564*o+.3575761*u+.1804375*v)/.95047),x=Ic((.2126729*o+.7151522*u+.072175*v)/1);return{l:116*x-16,a:500*(y-x),b:200*(x-Ic((.0193339*o+.119192*u+.9503041*v)/1.08883)),alpha:t.a}}function po(t){var o=(t.l+16)/116,u=isNaN(t.a)?o:o+t.a/500,v=isNaN(t.b)?o:o-t.b/200;return o=1*hf(o),u=.95047*hf(u),v=1.08883*hf(v),new jr(Oc(3.2404542*u-1.5371385*o-.4985314*v),Oc(-.969266*u+1.8760108*o+.041556*v),Oc(.0556434*u-.2040259*o+1.0572252*v),t.alpha)}function Pf(t,o,u){var v=o-t;return t+u*(v>180||v<-180?v-360*Math.round(v/360):v)}var vc={forward:pf,reverse:po,interpolate:function(t,o,u){return{l:Ai(t.l,o.l,u),a:Ai(t.a,o.a,u),b:Ai(t.b,o.b,u),alpha:Ai(t.alpha,o.alpha,u)}}},Ju={forward:function(t){var o=pf(t),u=o.l,v=o.a,y=o.b,x=Math.atan2(y,v)*Sl;return{h:x<0?x+360:x,c:Math.sqrt(v*v+y*y),l:u,alpha:t.a}},reverse:function(t){var o=t.h*us,u=t.c;return po({l:t.l,a:Math.cos(o)*u,b:Math.sin(o)*u,alpha:t.alpha})},interpolate:function(t,o,u){return{h:Pf(t.h,o.h,u),c:Ai(t.c,o.c,u),l:Ai(t.l,o.l,u),alpha:Ai(t.alpha,o.alpha,u)}}},eh=Object.freeze({__proto__:null,lab:vc,hcl:Ju}),Qo=function(t,o,u,v,y){this.type=t,this.operator=o,this.interpolation=u,this.input=v,this.labels=[],this.outputs=[];for(var x=0,A=y;x<A.length;x+=1){var B=A[x],te=B[1];this.labels.push(B[0]),this.outputs.push(te)}};function Nl(t,o,u,v){var y=v-u,x=t-u;return y===0?0:o===1?x/y:(Math.pow(o,x)-1)/(Math.pow(o,y)-1)}Qo.interpolationFactor=function(t,o,u,v){var y=0;if(t.name==="exponential")y=Nl(o,t.base,u,v);else if(t.name==="linear")y=Nl(o,1,u,v);else if(t.name==="cubic-bezier"){var x=t.controlPoints;y=new C(x[0],x[1],x[2],x[3]).solve(Nl(o,1,u,v))}return y},Qo.parse=function(t,o){var u=t[0],v=t[1],y=t[2],x=t.slice(3);if(!Array.isArray(v)||v.length===0)return o.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){var A=v[1];if(typeof A!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:A}}else{if(v[0]!=="cubic-bezier")return o.error("Unknown interpolation type "+String(v[0]),1,0);var B=v.slice(1);if(B.length!==4||B.some(function(qt){return typeof qt!="number"||qt<0||qt>1}))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:B}}if(t.length-1<4)return o.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(!(y=o.parse(y,2,Ht)))return null;var te=[],_e=null;u==="interpolate-hcl"||u==="interpolate-lab"?_e=Dr:o.expectedType&&o.expectedType.kind!=="value"&&(_e=o.expectedType);for(var Ce=0;Ce<x.length;Ce+=2){var Ie=x[Ce],Xe=x[Ce+1],tt=Ce+3,Mt=Ce+4;if(typeof Ie!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',tt);if(te.length&&te[te.length-1][0]>=Ie)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',tt);var Pt=o.parse(Xe,Mt,_e);if(!Pt)return null;_e=_e||Pt.type,te.push([Ie,Pt])}return _e.kind==="number"||_e.kind==="color"||_e.kind==="array"&&_e.itemType.kind==="number"&&typeof _e.N=="number"?new Qo(_e,u,v,y,te):o.error("Type "+Zn(_e)+" is not interpolatable.")},Qo.prototype.evaluate=function(t){var o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);var v=this.input.evaluate(t);if(v<=o[0])return u[0].evaluate(t);var y=o.length;if(v>=o[y-1])return u[y-1].evaluate(t);var x=Fl(o,v),A=Qo.interpolationFactor(this.interpolation,v,o[x],o[x+1]),B=u[x].evaluate(t),te=u[x+1].evaluate(t);return this.operator==="interpolate"?Hi[this.type.kind.toLowerCase()](B,te,A):this.operator==="interpolate-hcl"?Ju.reverse(Ju.interpolate(Ju.forward(B),Ju.forward(te),A)):vc.reverse(vc.interpolate(vc.forward(B),vc.forward(te),A))},Qo.prototype.eachChild=function(t){t(this.input);for(var o=0,u=this.outputs;o<u.length;o+=1)t(u[o])},Qo.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Qo.prototype.serialize=function(){var t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var o=[this.operator,t,this.input.serialize()],u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o};var Ul=function(t,o){this.type=t,this.args=o};Ul.parse=function(t,o){if(t.length<2)return o.error("Expectected at least one argument.");var u=null,v=o.expectedType;v&&v.kind!=="value"&&(u=v);for(var y=[],x=0,A=t.slice(1);x<A.length;x+=1){var B=o.parse(A[x],1+y.length,u,void 0,{typeAnnotation:"omit"});if(!B)return null;u=u||B.type,y.push(B)}var te=v&&y.some(function(_e){return qi(v,_e.type)});return new Ul(te?on:u,y)},Ul.prototype.evaluate=function(t){for(var o,u=null,v=0,y=0,x=this.args;y<x.length&&(v++,(u=x[y].evaluate(t))&&u instanceof Aa&&!u.available&&(o||(o=u.name),u=null,v===this.args.length&&(u=o)),u===null);y+=1);return u},Ul.prototype.eachChild=function(t){this.args.forEach(t)},Ul.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Ul.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(o){t.push(o.serialize())}),t};var iu=function(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o};iu.prototype.evaluate=function(t){return this.result.evaluate(t)},iu.prototype.eachChild=function(t){for(var o=0,u=this.bindings;o<u.length;o+=1)t(u[o][1]);t(this.result)},iu.parse=function(t,o){if(t.length<4)return o.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var u=[],v=1;v<t.length-1;v+=2){var y=t[v];if(typeof y!="string")return o.error("Expected string, but found "+typeof y+" instead.",v);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",v);var x=o.parse(t[v+1],v+1);if(!x)return null;u.push([y,x])}var A=o.parse(t[t.length-1],t.length-1,o.expectedType,u);return A?new iu(u,A):null},iu.prototype.outputDefined=function(){return this.result.outputDefined()},iu.prototype.serialize=function(){for(var t=["let"],o=0,u=this.bindings;o<u.length;o+=1){var v=u[o];t.push(v[0],v[1].serialize())}return t.push(this.result.serialize()),t};var yu=function(t,o,u){this.type=t,this.index=o,this.input=u};yu.parse=function(t,o){if(t.length!==3)return o.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,Ht),v=o.parse(t[2],2,mn(o.expectedType||on));return u&&v?new yu(v.type.itemType,u,v):null},yu.prototype.evaluate=function(t){var o=this.index.evaluate(t),u=this.input.evaluate(t);if(o<0)throw new Ja("Array index out of bounds: "+o+" < 0.");if(o>=u.length)throw new Ja("Array index out of bounds: "+o+" > "+(u.length-1)+".");if(o!==Math.floor(o))throw new Ja("Array index must be an integer, but found "+o+" instead.");return u[o]},yu.prototype.eachChild=function(t){t(this.index),t(this.input)},yu.prototype.outputDefined=function(){return!1},yu.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var _u=function(t,o){this.type=hr,this.needle=t,this.haystack=o};_u.parse=function(t,o){if(t.length!==3)return o.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,on),v=o.parse(t[2],2,on);return u&&v?Sa(u.type,[hr,Cr,Ht,lr,on])?new _u(u,v):o.error("Expected first argument to be of type boolean, string, number or null, but found "+Zn(u.type)+" instead"):null},_u.prototype.evaluate=function(t){var o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Zi(o,["boolean","string","number","null"]))throw new Ja("Expected first argument to be of type boolean, string, number or null, but found "+Zn(ka(o))+" instead.");if(!Zi(u,["string","array"]))throw new Ja("Expected second argument to be of type array or string, but found "+Zn(ka(u))+" instead.");return u.indexOf(o)>=0},_u.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},_u.prototype.outputDefined=function(){return!0},_u.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var el=function(t,o,u){this.type=Ht,this.needle=t,this.haystack=o,this.fromIndex=u};el.parse=function(t,o){if(t.length<=2||t.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,on),v=o.parse(t[2],2,on);if(!u||!v)return null;if(!Sa(u.type,[hr,Cr,Ht,lr,on]))return o.error("Expected first argument to be of type boolean, string, number or null, but found "+Zn(u.type)+" instead");if(t.length===4){var y=o.parse(t[3],3,Ht);return y?new el(u,v,y):null}return new el(u,v)},el.prototype.evaluate=function(t){var o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Zi(o,["boolean","string","number","null"]))throw new Ja("Expected first argument to be of type boolean, string, number or null, but found "+Zn(ka(o))+" instead.");if(!Zi(u,["string","array"]))throw new Ja("Expected second argument to be of type array or string, but found "+Zn(ka(u))+" instead.");if(this.fromIndex){var v=this.fromIndex.evaluate(t);return u.indexOf(o,v)}return u.indexOf(o)},el.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},el.prototype.outputDefined=function(){return!1},el.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var au=function(t,o,u,v,y,x){this.inputType=t,this.type=o,this.input=u,this.cases=v,this.outputs=y,this.otherwise=x};au.parse=function(t,o){if(t.length<5)return o.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return o.error("Expected an even number of arguments.");var u,v;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);for(var y={},x=[],A=2;A<t.length-1;A+=2){var B=t[A],te=t[A+1];Array.isArray(B)||(B=[B]);var _e=o.concat(A);if(B.length===0)return _e.error("Expected at least one branch label.");for(var Ce=0,Ie=B;Ce<Ie.length;Ce+=1){var Xe=Ie[Ce];if(typeof Xe!="number"&&typeof Xe!="string")return _e.error("Branch labels must be numbers or strings.");if(typeof Xe=="number"&&Math.abs(Xe)>Number.MAX_SAFE_INTEGER)return _e.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Xe=="number"&&Math.floor(Xe)!==Xe)return _e.error("Numeric branch labels must be integer values.");if(u){if(_e.checkSubtype(u,ka(Xe)))return null}else u=ka(Xe);if(y[String(Xe)]!==void 0)return _e.error("Branch labels must be unique.");y[String(Xe)]=x.length}var tt=o.parse(te,A,v);if(!tt)return null;v=v||tt.type,x.push(tt)}var Mt=o.parse(t[1],1,on);if(!Mt)return null;var Pt=o.parse(t[t.length-1],t.length-1,v);return Pt?Mt.type.kind!=="value"&&o.concat(1).checkSubtype(u,Mt.type)?null:new au(u,v,Mt,y,x,Pt):null},au.prototype.evaluate=function(t){var o=this.input.evaluate(t);return(ka(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)},au.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},au.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},au.prototype.serialize=function(){for(var t=this,o=["match",this.input.serialize()],u=[],v={},y=0,x=Object.keys(this.cases).sort();y<x.length;y+=1){var A=x[y];(Ie=v[this.cases[A]])===void 0?(v[this.cases[A]]=u.length,u.push([this.cases[A],[A]])):u[Ie][1].push(A)}for(var B=function(tt){return t.inputType.kind==="number"?Number(tt):tt},te=0,_e=u;te<_e.length;te+=1){var Ce=_e[te],Ie=Ce[0],Xe=Ce[1];o.push(Xe.length===1?B(Xe[0]):Xe.map(B)),o.push(this.outputs[outputIndex$1].serialize())}return o.push(this.otherwise.serialize()),o};var zl=function(t,o,u){this.type=t,this.branches=o,this.otherwise=u};zl.parse=function(t,o){if(t.length<4)return o.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return o.error("Expected an odd number of arguments.");var u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);for(var v=[],y=1;y<t.length-1;y+=2){var x=o.parse(t[y],y,hr);if(!x)return null;var A=o.parse(t[y+1],y+1,u);if(!A)return null;v.push([x,A]),u=u||A.type}var B=o.parse(t[t.length-1],t.length-1,u);return B?new zl(u,v,B):null},zl.prototype.evaluate=function(t){for(var o=0,u=this.branches;o<u.length;o+=1){var v=u[o],y=v[1];if(v[0].evaluate(t))return y.evaluate(t)}return this.otherwise.evaluate(t)},zl.prototype.eachChild=function(t){for(var o=0,u=this.branches;o<u.length;o+=1){var v=u[o],y=v[1];t(v[0]),t(y)}t(this.otherwise)},zl.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},zl.prototype.serialize=function(){var t=["case"];return this.eachChild(function(o){t.push(o.serialize())}),t};var Tl=function(t,o,u,v){this.type=t,this.input=o,this.beginIndex=u,this.endIndex=v};function vf(t,o){return t==="=="||t==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function Vc(t,o,u,v){return v.compare(o,u)===0}function Va(t,o,u){var v=t!=="=="&&t!=="!=";return function(){function y(x,A,B){this.type=hr,this.lhs=x,this.rhs=A,this.collator=B,this.hasUntypedArgument=x.type.kind==="value"||A.type.kind==="value"}return y.parse=function(x,A){if(x.length!==3&&x.length!==4)return A.error("Expected two or three arguments.");var B=x[0],te=A.parse(x[1],1,on);if(!te)return null;if(!vf(B,te.type))return A.concat(1).error('"'+B+`" comparisons are not supported for type '`+Zn(te.type)+"'.");var _e=A.parse(x[2],2,on);if(!_e)return null;if(!vf(B,_e.type))return A.concat(2).error('"'+B+`" comparisons are not supported for type '`+Zn(_e.type)+"'.");if(te.type.kind!==_e.type.kind&&te.type.kind!=="value"&&_e.type.kind!=="value")return A.error("Cannot compare types '"+Zn(te.type)+"' and '"+Zn(_e.type)+"'.");v&&(te.type.kind==="value"&&_e.type.kind!=="value"?te=new Za(_e.type,[te]):te.type.kind!=="value"&&_e.type.kind==="value"&&(_e=new Za(te.type,[_e])));var Ce=null;if(x.length===4){if(te.type.kind!=="string"&&_e.type.kind!=="string"&&te.type.kind!=="value"&&_e.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(Ce=A.parse(x[3],3,fi)))return null}return new y(te,_e,Ce)},y.prototype.evaluate=function(x){var A=this.lhs.evaluate(x),B=this.rhs.evaluate(x);if(v&&this.hasUntypedArgument){var te=ka(A),_e=ka(B);if(te.kind!==_e.kind||te.kind!=="string"&&te.kind!=="number")throw new Ja('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+te.kind+", "+_e.kind+") instead.")}if(this.collator&&!v&&this.hasUntypedArgument){var Ce=ka(A),Ie=ka(B);if(Ce.kind!=="string"||Ie.kind!=="string")return o(x,A,B)}return this.collator?u(x,A,B,this.collator.evaluate(x)):o(x,A,B)},y.prototype.eachChild=function(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)},y.prototype.outputDefined=function(){return!0},y.prototype.serialize=function(){var x=[t];return this.eachChild(function(A){x.push(A.serialize())}),x},y}()}Tl.parse=function(t,o){if(t.length<=2||t.length>=5)return o.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1,on),v=o.parse(t[2],2,Ht);if(!u||!v)return null;if(!Sa(u.type,[mn(on),Cr,on]))return o.error("Expected first argument to be of type array or string, but found "+Zn(u.type)+" instead");if(t.length===4){var y=o.parse(t[3],3,Ht);return y?new Tl(u.type,u,v,y):null}return new Tl(u.type,u,v)},Tl.prototype.evaluate=function(t){var o=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Zi(o,["string","array"]))throw new Ja("Expected first argument to be of type array or string, but found "+Zn(ka(o))+" instead.");if(this.endIndex){var v=this.endIndex.evaluate(t);return o.slice(u,v)}return o.slice(u)},Tl.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Tl.prototype.outputDefined=function(){return!1},Tl.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var th=Va("==",function(t,o,u){return o===u},Vc),Pc=Va("!=",function(t,o,u){return o!==u},function(t,o,u,v){return!Vc(0,o,u,v)}),Hc=Va("<",function(t,o,u){return o<u},function(t,o,u,v){return v.compare(o,u)<0}),bo=Va(">",function(t,o,u){return o>u},function(t,o,u,v){return v.compare(o,u)>0}),mf=Va("<=",function(t,o,u){return o<=u},function(t,o,u,v){return v.compare(o,u)<=0}),gf=Va(">=",function(t,o,u){return o>=u},function(t,o,u,v){return v.compare(o,u)>=0}),Jo=function(t,o,u,v,y){this.type=Cr,this.number=t,this.locale=o,this.currency=u,this.minFractionDigits=v,this.maxFractionDigits=y};Jo.parse=function(t,o){if(t.length!==3)return o.error("Expected two arguments.");var u=o.parse(t[1],1,Ht);if(!u)return null;var v=t[2];if(typeof v!="object"||Array.isArray(v))return o.error("NumberFormat options argument must be an object.");var y=null;if(v.locale&&!(y=o.parse(v.locale,1,Cr)))return null;var x=null;if(v.currency&&!(x=o.parse(v.currency,1,Cr)))return null;var A=null;if(v["min-fraction-digits"]&&!(A=o.parse(v["min-fraction-digits"],1,Ht)))return null;var B=null;return v["max-fraction-digits"]&&!(B=o.parse(v["max-fraction-digits"],1,Ht))?null:new Jo(u,y,x,A,B)},Jo.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Jo.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Jo.prototype.outputDefined=function(){return!1},Jo.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Zu=function(t){this.type=Ht,this.input=t};Zu.parse=function(t,o){if(t.length!==2)return o.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var u=o.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error("Expected argument of type string or array, but found "+Zn(u.type)+" instead."):new Zu(u):null},Zu.prototype.evaluate=function(t){var o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Ja("Expected value to be of type string or array, but found "+Zn(ka(o))+" instead.")},Zu.prototype.eachChild=function(t){t(this.input)},Zu.prototype.outputDefined=function(){return!1},Zu.prototype.serialize=function(){var t=["length"];return this.eachChild(function(o){t.push(o.serialize())}),t};var Mu={"==":th,"!=":Pc,">":bo,"<":Hc,">=":gf,"<=":mf,array:Za,at:yu,boolean:Za,case:zl,coalesce:Ul,collator:gs,format:qo,image:Ca,in:_u,"index-of":el,interpolate:Qo,"interpolate-hcl":Qo,"interpolate-lab":Qo,length:Zu,let:iu,literal:za,match:au,number:Za,"number-format":Jo,object:Za,slice:Tl,step:gn,string:Za,"to-boolean":Do,"to-color":Do,"to-number":Do,"to-string":Do,var:Qu,within:ys};function ju(t,o){var u=o[0],v=o[1],y=o[2],x=o[3];u=u.evaluate(t),v=v.evaluate(t),y=y.evaluate(t);var A=x?x.evaluate(t):1,B=go(u,v,y,A);if(B)throw new Ja(B);return new jr(u/255*A,v/255*A,y/255*A,A)}function mc(t,o){return t in o}function Zl(t,o){var u=o[t];return u===void 0?null:u}function bu(t){return{type:t}}function gc(t){return{result:"success",value:t}}function Al(t){return{result:"error",value:t}}function ou(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function La(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function qa(t){return!!t.expression&&t.expression.interpolated}function so(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Vu(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Df(t){return t}function Cl(t,o,u){return t!==void 0?t:o!==void 0?o:u!==void 0?u:void 0}function Dc(t,o,u,v,y){return Cl(typeof u===y?v[u]:void 0,t.default,o.default)}function yc(t,o,u){if(so(u)!=="number")return Cl(t.default,o.default);var v=t.stops.length;if(v===1||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[v-1][0])return t.stops[v-1][1];var y=Fl(t.stops.map(function(x){return x[0]}),u);return t.stops[y][1]}function Gs(t,o,u){var v=t.base!==void 0?t.base:1;if(so(u)!=="number")return Cl(t.default,o.default);var y=t.stops.length;if(y===1||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[y-1][0])return t.stops[y-1][1];var x=Fl(t.stops.map(function(Ie){return Ie[0]}),u),A=function(Ie,Xe,tt,Mt){var Pt=Mt-tt,qt=Ie-tt;return Pt===0?0:Xe===1?qt/Pt:(Math.pow(Xe,qt)-1)/(Math.pow(Xe,Pt)-1)}(u,v,t.stops[x][0],t.stops[x+1][0]),B=t.stops[x][1],te=t.stops[x+1][1],_e=Hi[o.type]||Df;if(t.colorSpace&&t.colorSpace!=="rgb"){var Ce=eh[t.colorSpace];_e=function(Ie,Xe){return Ce.reverse(Ce.interpolate(Ce.forward(Ie),Ce.forward(Xe),A))}}return typeof B.evaluate=="function"?{evaluate:function(){for(var Ie=[],Xe=arguments.length;Xe--;)Ie[Xe]=arguments[Xe];var tt=B.evaluate.apply(void 0,Ie),Mt=te.evaluate.apply(void 0,Ie);if(tt!==void 0&&Mt!==void 0)return _e(tt,Mt,A)}}:_e(B,te,A)}function Hu(t,o,u){return o.type==="color"?u=jr.parse(u):o.type==="formatted"?u=Ta.fromString(u.toString()):o.type==="resolvedImage"?u=Aa.fromString(u.toString()):so(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0),Cl(u,t.default,o.default)}ja.register(Mu,{error:[{kind:"error"},[Cr],function(t,o){throw new Ja(o[0].evaluate(t))}],typeof:[Cr,[on],function(t,o){return Zn(ka(o[0].evaluate(t)))}],"to-rgba":[mn(Ht,4),[Dr],function(t,o){return o[0].evaluate(t).toArray()}],rgb:[Dr,[Ht,Ht,Ht],ju],rgba:[Dr,[Ht,Ht,Ht,Ht],ju],has:{type:hr,overloads:[[[Cr],function(t,o){return mc(o[0].evaluate(t),t.properties())}],[[Cr,Rn],function(t,o){var u=o[1];return mc(o[0].evaluate(t),u.evaluate(t))}]]},get:{type:on,overloads:[[[Cr],function(t,o){return Zl(o[0].evaluate(t),t.properties())}],[[Cr,Rn],function(t,o){var u=o[1];return Zl(o[0].evaluate(t),u.evaluate(t))}]]},"feature-state":[on,[Cr],function(t,o){return Zl(o[0].evaluate(t),t.featureState||{})}],properties:[Rn,[],function(t){return t.properties()}],"geometry-type":[Cr,[],function(t){return t.geometryType()}],id:[on,[],function(t){return t.id()}],zoom:[Ht,[],function(t){return t.globals.zoom}],"heatmap-density":[Ht,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Ht,[],function(t){return t.globals.lineProgress||0}],accumulated:[on,[],function(t){return t.globals.accumulated===void 0?null:t.globals.accumulated}],"+":[Ht,bu(Ht),function(t,o){for(var u=0,v=0,y=o;v<y.length;v+=1)u+=y[v].evaluate(t);return u}],"*":[Ht,bu(Ht),function(t,o){for(var u=1,v=0,y=o;v<y.length;v+=1)u*=y[v].evaluate(t);return u}],"-":{type:Ht,overloads:[[[Ht,Ht],function(t,o){var u=o[1];return o[0].evaluate(t)-u.evaluate(t)}],[[Ht],function(t,o){return-o[0].evaluate(t)}]]},"/":[Ht,[Ht,Ht],function(t,o){var u=o[1];return o[0].evaluate(t)/u.evaluate(t)}],"%":[Ht,[Ht,Ht],function(t,o){var u=o[1];return o[0].evaluate(t)%u.evaluate(t)}],ln2:[Ht,[],function(){return Math.LN2}],pi:[Ht,[],function(){return Math.PI}],e:[Ht,[],function(){return Math.E}],"^":[Ht,[Ht,Ht],function(t,o){var u=o[1];return Math.pow(o[0].evaluate(t),u.evaluate(t))}],sqrt:[Ht,[Ht],function(t,o){return Math.sqrt(o[0].evaluate(t))}],log10:[Ht,[Ht],function(t,o){return Math.log(o[0].evaluate(t))/Math.LN10}],ln:[Ht,[Ht],function(t,o){return Math.log(o[0].evaluate(t))}],log2:[Ht,[Ht],function(t,o){return Math.log(o[0].evaluate(t))/Math.LN2}],sin:[Ht,[Ht],function(t,o){return Math.sin(o[0].evaluate(t))}],cos:[Ht,[Ht],function(t,o){return Math.cos(o[0].evaluate(t))}],tan:[Ht,[Ht],function(t,o){return Math.tan(o[0].evaluate(t))}],asin:[Ht,[Ht],function(t,o){return Math.asin(o[0].evaluate(t))}],acos:[Ht,[Ht],function(t,o){return Math.acos(o[0].evaluate(t))}],atan:[Ht,[Ht],function(t,o){return Math.atan(o[0].evaluate(t))}],min:[Ht,bu(Ht),function(t,o){return Math.min.apply(Math,o.map(function(u){return u.evaluate(t)}))}],max:[Ht,bu(Ht),function(t,o){return Math.max.apply(Math,o.map(function(u){return u.evaluate(t)}))}],abs:[Ht,[Ht],function(t,o){return Math.abs(o[0].evaluate(t))}],round:[Ht,[Ht],function(t,o){var u=o[0].evaluate(t);return u<0?-Math.round(-u):Math.round(u)}],floor:[Ht,[Ht],function(t,o){return Math.floor(o[0].evaluate(t))}],ceil:[Ht,[Ht],function(t,o){return Math.ceil(o[0].evaluate(t))}],"filter-==":[hr,[Cr,on],function(t,o){var u=o[0],v=o[1];return t.properties()[u.value]===v.value}],"filter-id-==":[hr,[on],function(t,o){var u=o[0];return t.id()===u.value}],"filter-type-==":[hr,[Cr],function(t,o){var u=o[0];return t.geometryType()===u.value}],"filter-<":[hr,[Cr,on],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],x=v.value;return typeof y==typeof x&&y<x}],"filter-id-<":[hr,[on],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v<y}],"filter->":[hr,[Cr,on],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],x=v.value;return typeof y==typeof x&&y>x}],"filter-id->":[hr,[on],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v>y}],"filter-<=":[hr,[Cr,on],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],x=v.value;return typeof y==typeof x&&y<=x}],"filter-id-<=":[hr,[on],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v<=y}],"filter->=":[hr,[Cr,on],function(t,o){var u=o[0],v=o[1],y=t.properties()[u.value],x=v.value;return typeof y==typeof x&&y>=x}],"filter-id->=":[hr,[on],function(t,o){var u=o[0],v=t.id(),y=u.value;return typeof v==typeof y&&v>=y}],"filter-has":[hr,[on],function(t,o){return o[0].value in t.properties()}],"filter-has-id":[hr,[],function(t){return t.id()!==null&&t.id()!==void 0}],"filter-type-in":[hr,[mn(Cr)],function(t,o){return o[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[hr,[mn(on)],function(t,o){return o[0].value.indexOf(t.id())>=0}],"filter-in-small":[hr,[Cr,mn(on)],function(t,o){var u=o[0];return o[1].value.indexOf(t.properties()[u.value])>=0}],"filter-in-large":[hr,[Cr,mn(on)],function(t,o){var u=o[0],v=o[1];return function(y,x,A,B){for(;A<=B;){var te=A+B>>1;if(x[te]===y)return!0;x[te]>y?B=te-1:A=te+1}return!1}(t.properties()[u.value],v.value,0,v.value.length-1)}],all:{type:hr,overloads:[[[hr,hr],function(t,o){var u=o[1];return o[0].evaluate(t)&&u.evaluate(t)}],[bu(hr),function(t,o){for(var u=0,v=o;u<v.length;u+=1)if(!v[u].evaluate(t))return!1;return!0}]]},any:{type:hr,overloads:[[[hr,hr],function(t,o){var u=o[1];return o[0].evaluate(t)||u.evaluate(t)}],[bu(hr),function(t,o){for(var u=0,v=o;u<v.length;u+=1)if(v[u].evaluate(t))return!0;return!1}]]},"!":[hr,[hr],function(t,o){return!o[0].evaluate(t)}],"is-supported-script":[hr,[Cr],function(t,o){var u=t.globals&&t.globals.isSupportedScript;return!u||u(o[0].evaluate(t))}],upcase:[Cr,[Cr],function(t,o){return o[0].evaluate(t).toUpperCase()}],downcase:[Cr,[Cr],function(t,o){return o[0].evaluate(t).toLowerCase()}],concat:[Cr,bu(on),function(t,o){return o.map(function(u){return Ao(u.evaluate(t))}).join("")}],"resolved-locale":[Cr,[fi],function(t,o){return o[0].evaluate(t).resolvedLocale()}]});var Iu=function(t,o){this.expression=t,this._warningHistory={},this._evaluator=new ho,this._defaultValue=o?function(u){return u.type==="color"&&Vu(u.default)?new jr(0,0,0,0):u.type==="color"?jr.parse(u.default)||null:u.default===void 0?null:u.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null};function tl(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Mu}function Ql(t,o){var u=new El(Mu,[],o?function(y){var x={color:Dr,string:Cr,number:Ht,enum:Cr,boolean:hr,formatted:Mi,resolvedImage:di};return y.type==="array"?mn(x[y.value]||on,y.length):x[y.type]}(o):void 0),v=u.parse(t,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?gc(new Iu(v,o)):Al(u.errors)}Iu.prototype.evaluateWithoutErrorHandling=function(t,o,u,v,y,x){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=v,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)},Iu.prototype.evaluate=function(t,o,u,v,y,x){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=v,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Ja("Expected value to be one of "+Object.keys(this._enumValues).map(function(B){return JSON.stringify(B)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console!="undefined"&&console.warn(B.message)),this._defaultValue}};var Jl=function(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!xl(o.expression)};Jl.prototype.evaluateWithoutErrorHandling=function(t,o,u,v,y,x){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,v,y,x)},Jl.prototype.evaluate=function(t,o,u,v,y,x){return this._styleExpression.evaluate(t,o,u,v,y,x)};var jl=function(t,o,u,v){this.kind=t,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!xl(o.expression),this.interpolationType=v};function kc(t,o){if((t=Ql(t,o)).result==="error")return t;var u=t.value.expression,v=bl(u);if(!v&&!ou(o))return Al([new bt("","data expressions not supported")]);var y=ds(u,["zoom"]);if(!y&&!La(o))return Al([new bt("","zoom expressions not supported")]);var x=function A(B){var te=null;if(B instanceof iu)te=A(B.result);else if(B instanceof Ul)for(var _e=0,Ce=B.args;_e<Ce.length&&!(te=A(Ce[_e]));_e+=1);else(B instanceof gn||B instanceof Qo)&&B.input instanceof ja&&B.input.name==="zoom"&&(te=B);return te instanceof bt||B.eachChild(function(Ie){var Xe=A(Ie);Xe instanceof bt?te=Xe:!te&&Xe?te=new bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):te&&Xe&&te!==Xe&&(te=new bt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),te}(u);return x||y?x instanceof bt?Al([x]):x instanceof Qo&&!qa(o)?Al([new bt("",'"interpolate" expressions cannot be used with this property')]):gc(x?new jl(v?"camera":"composite",t.value,x.labels,x instanceof Qo?x.interpolation:void 0):new Jl(v?"constant":"source",t.value)):Al([new bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}jl.prototype.evaluateWithoutErrorHandling=function(t,o,u,v,y,x){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,v,y,x)},jl.prototype.evaluate=function(t,o,u,v,y,x){return this._styleExpression.evaluate(t,o,u,v,y,x)},jl.prototype.interpolationFactor=function(t,o,u){return this.interpolationType?Qo.interpolationFactor(this.interpolationType,t,o,u):0};var rl=function(t,o){this._parameters=t,this._specification=o,G(this,function u(v,y){var x,A,B,te=y.type==="color",_e=v.stops&&typeof v.stops[0][0]=="object",Ce=_e||!(_e||v.property!==void 0),Ie=v.type||(qa(y)?"exponential":"interval");if(te&&((v=G({},v)).stops&&(v.stops=v.stops.map(function(ci){return[ci[0],jr.parse(ci[1])]})),v.default=jr.parse(v.default?v.default:y.default)),v.colorSpace&&v.colorSpace!=="rgb"&&!eh[v.colorSpace])throw new Error("Unknown color space: "+v.colorSpace);if(Ie==="exponential")x=Gs;else if(Ie==="interval")x=yc;else if(Ie==="categorical"){x=Dc,A=Object.create(null);for(var Xe=0,tt=v.stops;Xe<tt.length;Xe+=1){var Mt=tt[Xe];A[Mt[0]]=Mt[1]}B=typeof v.stops[0][0]}else{if(Ie!=="identity")throw new Error('Unknown function type "'+Ie+'"');x=Hu}if(_e){for(var Pt={},qt=[],Zt=0;Zt<v.stops.length;Zt++){var pr=v.stops[Zt],Sr=pr[0].zoom;Pt[Sr]===void 0&&(Pt[Sr]={zoom:Sr,type:v.type,property:v.property,default:v.default,stops:[]},qt.push(Sr)),Pt[Sr].stops.push([pr[0].value,pr[1]])}for(var Br=[],Vr=0,fn=qt;Vr<fn.length;Vr+=1){var Nn=fn[Vr];Br.push([Pt[Nn].zoom,u(Pt[Nn],y)])}var qn={name:"linear"};return{kind:"composite",interpolationType:qn,interpolationFactor:Qo.interpolationFactor.bind(void 0,qn),zoomStops:Br.map(function(ci){return ci[0]}),evaluate:function(ci,ki){var hi=ci.zoom;return Gs({stops:Br,base:v.base},y,hi).evaluate(hi,ki)}}}if(Ce){var Di=Ie==="exponential"?{name:"exponential",base:v.base!==void 0?v.base:1}:null;return{kind:"camera",interpolationType:Di,interpolationFactor:Qo.interpolationFactor.bind(void 0,Di),zoomStops:v.stops.map(function(ci){return ci[0]}),evaluate:function(ci){return x(v,y,ci.zoom,A,B)}}}return{kind:"source",evaluate:function(ci,ki){var hi=ki&&ki.properties?ki.properties[v.property]:void 0;return hi===void 0?Cl(v.default,y.default):x(v,y,hi,A,B)}}}(this._parameters,this._specification))};function Xs(t){var o=t.key,u=t.value,v=t.valueSpec||{},y=t.objectElementValidators||{},x=t.style,A=t.styleSpec,B=[],te=so(u);if(te!=="object")return[new Ge(o,u,"object expected, "+te+" found")];for(var _e in u){var Ce=_e.split(".")[0],Ie=v[Ce]||v["*"],Xe=void 0;if(y[Ce])Xe=y[Ce];else if(v[Ce])Xe=Ia;else if(y["*"])Xe=y["*"];else{if(!v["*"]){B.push(new Ge(o,u[_e],'unknown property "'+_e+'"'));continue}Xe=Ia}B=B.concat(Xe({key:(o&&o+".")+_e,value:u[_e],valueSpec:Ie,style:x,styleSpec:A,object:u,objectKey:_e},u))}for(var tt in v)y[tt]||v[tt].required&&v[tt].default===void 0&&u[tt]===void 0&&B.push(new Ge(o,u,'missing required property "'+tt+'"'));return B}function kf(t){var o=t.value,u=t.valueSpec,v=t.style,y=t.styleSpec,x=t.key,A=t.arrayElementValidator||Ia;if(so(o)!=="array")return[new Ge(x,o,"array expected, "+so(o)+" found")];if(u.length&&o.length!==u.length)return[new Ge(x,o,"array length "+u.length+" expected, length "+o.length+" found")];if(u["min-length"]&&o.length<u["min-length"])return[new Ge(x,o,"array length at least "+u["min-length"]+" expected, length "+o.length+" found")];var B={type:u.value,values:u.values};y.$version<7&&(B.function=u.function),so(u.value)==="object"&&(B=u.value);for(var te=[],_e=0;_e<o.length;_e++)te=te.concat(A({array:o,arrayIndex:_e,value:o[_e],valueSpec:B,style:v,styleSpec:y,key:x+"["+_e+"]"}));return te}function yf(t){var o=t.key,u=t.value,v=t.valueSpec,y=so(u);return y==="number"&&u!=u&&(y="NaN"),y!=="number"?[new Ge(o,u,"number expected, "+y+" found")]:"minimum"in v&&u<v.minimum?[new Ge(o,u,u+" is less than the minimum value "+v.minimum)]:"maximum"in v&&u>v.maximum?[new Ge(o,u,u+" is greater than the maximum value "+v.maximum)]:[]}function Lf(t){var o,u,v,y=t.valueSpec,x=rt(t.value.type),A={},B=x!=="categorical"&&t.value.property===void 0,te=!B,_e=so(t.value.stops)==="array"&&so(t.value.stops[0])==="array"&&so(t.value.stops[0][0])==="object",Ce=Xs({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(tt){if(x==="identity")return[new Ge(tt.key,tt.value,'identity function may not have a "stops" property')];var Mt=[],Pt=tt.value;return Mt=Mt.concat(kf({key:tt.key,value:Pt,valueSpec:tt.valueSpec,style:tt.style,styleSpec:tt.styleSpec,arrayElementValidator:Ie})),so(Pt)==="array"&&Pt.length===0&&Mt.push(new Ge(tt.key,Pt,"array must have at least one stop")),Mt},default:function(tt){return Ia({key:tt.key,value:tt.value,valueSpec:y,style:tt.style,styleSpec:tt.styleSpec})}}});return x==="identity"&&B&&Ce.push(new Ge(t.key,t.value,'missing required property "property"')),x==="identity"||t.value.stops||Ce.push(new Ge(t.key,t.value,'missing required property "stops"')),x==="exponential"&&t.valueSpec.expression&&!qa(t.valueSpec)&&Ce.push(new Ge(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(te&&!ou(t.valueSpec)?Ce.push(new Ge(t.key,t.value,"property functions not supported")):B&&!La(t.valueSpec)&&Ce.push(new Ge(t.key,t.value,"zoom functions not supported"))),x!=="categorical"&&!_e||t.value.property!==void 0||Ce.push(new Ge(t.key,t.value,'"property" property is required')),Ce;function Ie(tt){var Mt=[],Pt=tt.value,qt=tt.key;if(so(Pt)!=="array")return[new Ge(qt,Pt,"array expected, "+so(Pt)+" found")];if(Pt.length!==2)return[new Ge(qt,Pt,"array length 2 expected, length "+Pt.length+" found")];if(_e){if(so(Pt[0])!=="object")return[new Ge(qt,Pt,"object expected, "+so(Pt[0])+" found")];if(Pt[0].zoom===void 0)return[new Ge(qt,Pt,"object stop key must have zoom")];if(Pt[0].value===void 0)return[new Ge(qt,Pt,"object stop key must have value")];if(v&&v>rt(Pt[0].zoom))return[new Ge(qt,Pt[0].zoom,"stop zoom values must appear in ascending order")];rt(Pt[0].zoom)!==v&&(v=rt(Pt[0].zoom),u=void 0,A={}),Mt=Mt.concat(Xs({key:qt+"[0]",value:Pt[0],valueSpec:{zoom:{}},style:tt.style,styleSpec:tt.styleSpec,objectElementValidators:{zoom:yf,value:Xe}}))}else Mt=Mt.concat(Xe({key:qt+"[0]",value:Pt[0],valueSpec:{},style:tt.style,styleSpec:tt.styleSpec},Pt));return tl(ft(Pt[1]))?Mt.concat([new Ge(qt+"[1]",Pt[1],"expressions are not allowed in function stops.")]):Mt.concat(Ia({key:qt+"[1]",value:Pt[1],valueSpec:y,style:tt.style,styleSpec:tt.styleSpec}))}function Xe(tt,Mt){var Pt=so(tt.value),qt=rt(tt.value),Zt=tt.value!==null?tt.value:Mt;if(o){if(Pt!==o)return[new Ge(tt.key,Zt,Pt+" stop domain type must match previous stop domain type "+o)]}else o=Pt;if(Pt!=="number"&&Pt!=="string"&&Pt!=="boolean")return[new Ge(tt.key,Zt,"stop domain value must be a number, string, or boolean")];if(Pt!=="number"&&x!=="categorical"){var pr="number expected, "+Pt+" found";return ou(y)&&x===void 0&&(pr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ge(tt.key,Zt,pr)]}return x!=="categorical"||Pt!=="number"||isFinite(qt)&&Math.floor(qt)===qt?x!=="categorical"&&Pt==="number"&&u!==void 0&&qt<u?[new Ge(tt.key,Zt,"stop domain values must appear in ascending order")]:(u=qt,x==="categorical"&&qt in A?[new Ge(tt.key,Zt,"stop domain values must be unique")]:(A[qt]=!0,[])):[new Ge(tt.key,Zt,"integer expected, found "+qt)]}}function Vl(t){var o=(t.expressionContext==="property"?kc:Ql)(ft(t.value),t.valueSpec);if(o.result==="error")return o.value.map(function(v){return new Ge(""+t.key+v.key,t.value,v.message)});var u=o.value.expression||o.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!u.outputDefined())return[new Ge(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!xl(u))return[new Ge(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!xl(u))return[new Ge(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!ds(u,["zoom","feature-state"]))return[new Ge(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!bl(u))return[new Ge(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $u(t){var o=t.key,u=t.value,v=t.valueSpec,y=[];return Array.isArray(v.values)?v.values.indexOf(rt(u))===-1&&y.push(new Ge(o,u,"expected one of ["+v.values.join(", ")+"], "+JSON.stringify(u)+" found")):Object.keys(v.values).indexOf(rt(u))===-1&&y.push(new Ge(o,u,"expected one of ["+Object.keys(v.values).join(", ")+"], "+JSON.stringify(u)+" found")),y}function Hl(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var o=0,u=t.slice(1);o<u.length;o+=1){var v=u[o];if(!Hl(v)&&typeof v!="boolean")return!1}return!0;default:return!0}}rl.deserialize=function(t){return new rl(t._parameters,t._specification)},rl.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var _c={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function nl(t){if(t==null)return{filter:function(){return!0},needGeometry:!1};Hl(t)||(t=$c(t));var o=Ql(t,_c);if(o.result==="error")throw new Error(o.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,v,y){return o.value.evaluate(u,v,{},y)},needGeometry:function u(v){if(!Array.isArray(v))return!1;if(v[0]==="within")return!0;for(var y=1;y<v.length;y++)if(u(v[y]))return!0;return!1}(t)}}function Bf(t,o){return t<o?-1:t>o?1:0}function $c(t){if(!t)return!0;var o,u=t[0];return t.length<=1?u!=="any":u==="=="?_f(t[1],t[2],"=="):u==="!="?bc(_f(t[1],t[2],"==")):u==="<"||u===">"||u==="<="||u===">="?_f(t[1],t[2],u):u==="any"?(o=t.slice(1),["any"].concat(o.map($c))):u==="all"?["all"].concat(t.slice(1).map($c)):u==="none"?["all"].concat(t.slice(1).map($c).map(bc)):u==="in"?Wc(t[1],t.slice(2)):u==="!in"?bc(Wc(t[1],t.slice(2))):u==="has"?bf(t[1]):u==="!has"?bc(bf(t[1])):u!=="within"||t}function _f(t,o,u){switch(t){case"$type":return["filter-type-"+u,o];case"$id":return["filter-id-"+u,o];default:return["filter-"+u,t,o]}}function Wc(t,o){if(o.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(function(u){return typeof u!=typeof o[0]})?["filter-in-large",t,["literal",o.sort(Bf)]]:["filter-in-small",t,["literal",o]]}}function bf(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function bc(t){return["!",t]}function Gc(t){return Hl(ft(t.value))?Vl(G({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function o(u){var v=u.value,y=u.key;if(so(v)!=="array")return[new Ge(y,v,"array expected, "+so(v)+" found")];var x,A=u.styleSpec,B=[];if(v.length<1)return[new Ge(y,v,"filter array must have at least 1 element")];switch(B=B.concat($u({key:y+"[0]",value:v[0],valueSpec:A.filter_operator,style:u.style,styleSpec:u.styleSpec})),rt(v[0])){case"<":case"<=":case">":case">=":v.length>=2&&rt(v[1])==="$type"&&B.push(new Ge(y,v,'"$type" cannot be use with operator "'+v[0]+'"'));case"==":case"!=":v.length!==3&&B.push(new Ge(y,v,'filter array for operator "'+v[0]+'" must have 3 elements'));case"in":case"!in":v.length>=2&&(x=so(v[1]))!=="string"&&B.push(new Ge(y+"[1]",v[1],"string expected, "+x+" found"));for(var te=2;te<v.length;te++)x=so(v[te]),rt(v[1])==="$type"?B=B.concat($u({key:y+"["+te+"]",value:v[te],valueSpec:A.geometry_type,style:u.style,styleSpec:u.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&B.push(new Ge(y+"["+te+"]",v[te],"string, number, or boolean expected, "+x+" found"));break;case"any":case"all":case"none":for(var _e=1;_e<v.length;_e++)B=B.concat(o({key:y+"["+_e+"]",value:v[_e],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":x=so(v[1]),v.length!==2?B.push(new Ge(y,v,'filter array for "'+v[0]+'" operator must have 2 elements')):x!=="string"&&B.push(new Ge(y+"[1]",v[1],"string expected, "+x+" found"));break;case"within":x=so(v[1]),v.length!==2?B.push(new Ge(y,v,'filter array for "'+v[0]+'" operator must have 2 elements')):x!=="object"&&B.push(new Ge(y+"[1]",v[1],"object expected, "+x+" found"))}return B}(t)}function xu(t,o){var u=t.key,v=t.style,y=t.styleSpec,x=t.value,A=t.objectKey,B=y[o+"_"+t.layerType];if(!B)return[];var te=A.match(/^(.*)-transition$/);if(o==="paint"&&te&&B[te[1]]&&B[te[1]].transition)return Ia({key:u,value:x,valueSpec:y.transition,style:v,styleSpec:y});var _e,Ce=t.valueSpec||B[A];if(!Ce)return[new Ge(u,x,'unknown property "'+A+'"')];if(so(x)==="string"&&ou(Ce)&&!Ce.tokens&&(_e=/^{([^}]+)}$/.exec(x)))return[new Ge(u,x,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(_e[1])+" }`.")];var Ie=[];return t.layerType==="symbol"&&(A==="text-field"&&v&&!v.glyphs&&Ie.push(new Ge(u,x,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&Vu(ft(x))&&rt(x.type)==="identity"&&Ie.push(new Ge(u,x,'"text-font" does not support identity functions'))),Ie.concat(Ia({key:t.key,value:x,valueSpec:Ce,style:v,styleSpec:y,expressionContext:"property",propertyType:o,propertyKey:A}))}function Wu(t){return xu(t,"paint")}function _s(t){return xu(t,"layout")}function xf(t){var o=[],u=t.value,v=t.key,y=t.style,x=t.styleSpec;u.type||u.ref||o.push(new Ge(v,u,'either "type" or "ref" is required'));var A,B=rt(u.type),te=rt(u.ref);if(u.id)for(var _e=rt(u.id),Ce=0;Ce<t.arrayIndex;Ce++){var Ie=y.layers[Ce];rt(Ie.id)===_e&&o.push(new Ge(v,u.id,'duplicate layer id "'+u.id+'", previously used at line '+Ie.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(Mt){Mt in u&&o.push(new Ge(v,u[Mt],'"'+Mt+'" is prohibited for ref layers'))}),y.layers.forEach(function(Mt){rt(Mt.id)===te&&(A=Mt)}),A?A.ref?o.push(new Ge(v,u.ref,"ref cannot reference another ref layer")):B=rt(A.type):o.push(new Ge(v,u.ref,'ref layer "'+te+'" not found'));else if(B!=="background")if(u.source){var Xe=y.sources&&y.sources[u.source],tt=Xe&&rt(Xe.type);Xe?tt==="vector"&&B==="raster"?o.push(new Ge(v,u.source,'layer "'+u.id+'" requires a raster source')):tt==="raster"&&B!=="raster"?o.push(new Ge(v,u.source,'layer "'+u.id+'" requires a vector source')):tt!=="vector"||u["source-layer"]?tt==="raster-dem"&&B!=="hillshade"?o.push(new Ge(v,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="line"||!u.paint||!u.paint["line-gradient"]||tt==="geojson"&&Xe.lineMetrics||o.push(new Ge(v,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):o.push(new Ge(v,u,'layer "'+u.id+'" must specify a "source-layer"')):o.push(new Ge(v,u.source,'source "'+u.source+'" not found'))}else o.push(new Ge(v,u,'missing required property "source"'));return o=o.concat(Xs({key:v,value:u,valueSpec:x.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ia({key:v+".type",value:u.type,valueSpec:x.layer.type,style:t.style,styleSpec:t.styleSpec,object:u,objectKey:"type"})},filter:Gc,layout:function(Mt){return Xs({layer:u,key:Mt.key,value:Mt.value,style:Mt.style,styleSpec:Mt.styleSpec,objectElementValidators:{"*":function(Pt){return _s(G({layerType:B},Pt))}}})},paint:function(Mt){return Xs({layer:u,key:Mt.key,value:Mt.value,style:Mt.style,styleSpec:Mt.styleSpec,objectElementValidators:{"*":function(Pt){return Wu(G({layerType:B},Pt))}}})}}}))}function $l(t){var o=t.value,u=t.key,v=so(o);return v!=="string"?[new Ge(u,o,"string expected, "+v+" found")]:[]}var uo={promoteId:function(t){var o=t.key,u=t.value;if(so(u)==="string")return $l({key:o,value:u});var v=[];for(var y in u)v.push.apply(v,$l({key:o+"."+y,value:u[y]}));return v}};function Ef(t){var o=t.value,u=t.key,v=t.styleSpec,y=t.style;if(!o.type)return[new Ge(u,o,'"type" is required')];var x,A=rt(o.type);switch(A){case"vector":case"raster":case"raster-dem":return Xs({key:u,value:o,valueSpec:v["source_"+A.replace("-","_")],style:t.style,styleSpec:v,objectElementValidators:uo});case"geojson":if(x=Xs({key:u,value:o,valueSpec:v.source_geojson,style:y,styleSpec:v,objectElementValidators:uo}),o.cluster)for(var B in o.clusterProperties){var te=o.clusterProperties[B],_e=te[0],Ce=typeof _e=="string"?[_e,["accumulated"],["get",B]]:_e;x.push.apply(x,Vl({key:u+"."+B+".map",value:te[1],expressionContext:"cluster-map"})),x.push.apply(x,Vl({key:u+"."+B+".reduce",value:Ce,expressionContext:"cluster-reduce"}))}return x;case"video":return Xs({key:u,value:o,valueSpec:v.source_video,style:y,styleSpec:v});case"image":return Xs({key:u,value:o,valueSpec:v.source_image,style:y,styleSpec:v});case"canvas":return[new Ge(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return $u({key:u+".type",value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:v})}}function Ys(t){var o=t.value,u=t.styleSpec,v=u.light,y=t.style,x=[],A=so(o);if(o===void 0)return x;if(A!=="object")return x.concat([new Ge("light",o,"object expected, "+A+" found")]);for(var B in o){var te=B.match(/^(.*)-transition$/);x=x.concat(te&&v[te[1]]&&v[te[1]].transition?Ia({key:B,value:o[B],valueSpec:u.transition,style:y,styleSpec:u}):v[B]?Ia({key:B,value:o[B],valueSpec:v[B],style:y,styleSpec:u}):[new Ge(B,o[B],'unknown property "'+B+'"')])}return x}var wl={"*":function(){return[]},array:kf,boolean:function(t){var o=t.value,u=t.key,v=so(o);return v!=="boolean"?[new Ge(u,o,"boolean expected, "+v+" found")]:[]},number:yf,color:function(t){var o=t.key,u=t.value,v=so(u);return v!=="string"?[new Ge(o,u,"color expected, "+v+" found")]:Oi(u)===null?[new Ge(o,u,'color expected, "'+u+'" found')]:[]},constants:We,enum:$u,filter:Gc,function:Lf,layer:xf,object:Xs,source:Ef,light:Ys,string:$l,formatted:function(t){return $l(t).length===0?[]:Vl(t)},resolvedImage:function(t){return $l(t).length===0?[]:Vl(t)}};function Ia(t){var o=t.value,u=t.valueSpec,v=t.styleSpec;return u.expression&&Vu(rt(o))?Lf(t):u.expression&&tl(ft(o))?Vl(t):u.type&&wl[u.type]?wl[u.type](t):Xs(G({},t,{valueSpec:u.type?v[u.type]:u}))}function lo(t){var o=t.value,u=t.key,v=$l(t);return v.length||(o.indexOf("{fontstack}")===-1&&v.push(new Ge(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&v.push(new Ge(u,o,'"glyphs" url must include a "{range}" token'))),v}function Ou(t,o){o===void 0&&(o=$e);var u=[];return u=u.concat(Ia({key:"",value:t,valueSpec:o.$root,styleSpec:o,style:t,objectElementValidators:{glyphs:lo,"*":function(){return[]}}})),t.constants&&(u=u.concat(We({key:"constants",value:t.constants,style:t,styleSpec:o}))),Xc(u)}function Xc(t){return[].concat(t).sort(function(o,u){return o.line-u.line})}function Pu(t){return function(){for(var o=[],u=arguments.length;u--;)o[u]=arguments[u];return Xc(t.apply(this,o))}}Ou.source=Pu(Ef),Ou.light=Pu(Ys),Ou.layer=Pu(xf),Ou.filter=Pu(Gc),Ou.paintProperty=Pu(Wu),Ou.layoutProperty=Pu(_s);var Bs=Ou,Ff=Bs.light,Yc=Bs.paintProperty,ec=Bs.layoutProperty;function tc(t,o){var u=!1;if(o&&o.length)for(var v=0,y=o;v<y.length;v+=1)t.fire(new mt(new Error(y[v].message))),u=!0;return u}var ps=Co;function Co(t,o,u){var v=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(o=y[1])+2*(u=y[2]);for(var x=0;x<this.d*this.d;x++){var A=y[3+x],B=y[3+x+1];v.push(A===B?null:y.subarray(A,B))}var te=y[3+v.length+1];this.keys=y.subarray(y[3+v.length],te),this.bboxes=y.subarray(te),this.insert=this._insertReadonly}else{this.d=o+2*u;for(var _e=0;_e<this.d*this.d;_e++)v.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=u,this.scale=o/t,this.uid=0;var Ce=u/o*t;this.min=-Ce,this.max=t+Ce}Co.prototype.insert=function(t,o,u,v,y){this._forEachCell(o,u,v,y,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(v),this.bboxes.push(y)},Co.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Co.prototype._insertCell=function(t,o,u,v,y,x){this.cells[y].push(x)},Co.prototype.query=function(t,o,u,v,y){var x=this.min,A=this.max;if(t<=x&&o<=x&&A<=u&&A<=v&&!y)return Array.prototype.slice.call(this.keys);var B=[];return this._forEachCell(t,o,u,v,this._queryCell,B,{},y),B},Co.prototype._queryCell=function(t,o,u,v,y,x,A,B){var te=this.cells[y];if(te!==null)for(var _e=this.keys,Ce=this.bboxes,Ie=0;Ie<te.length;Ie++){var Xe=te[Ie];if(A[Xe]===void 0){var tt=4*Xe;(B?B(Ce[tt+0],Ce[tt+1],Ce[tt+2],Ce[tt+3]):t<=Ce[tt+2]&&o<=Ce[tt+3]&&u>=Ce[tt+0]&&v>=Ce[tt+1])?(A[Xe]=!0,x.push(_e[Xe])):A[Xe]=!1}}},Co.prototype._forEachCell=function(t,o,u,v,y,x,A,B){for(var te=this._convertToCellCoord(t),_e=this._convertToCellCoord(o),Ce=this._convertToCellCoord(u),Ie=this._convertToCellCoord(v),Xe=te;Xe<=Ce;Xe++)for(var tt=_e;tt<=Ie;tt++){var Mt=this.d*tt+Xe;if((!B||B(this._convertFromCellCoord(Xe),this._convertFromCellCoord(tt),this._convertFromCellCoord(Xe+1),this._convertFromCellCoord(tt+1)))&&y.call(this,t,o,u,v,Mt,x,A,B))return}},Co.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Co.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Co.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,o=3+this.cells.length+1+1,u=0,v=0;v<this.cells.length;v++)u+=this.cells[v].length;var y=new Int32Array(o+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var x=o,A=0;A<t.length;A++){var B=t[A];y[3+A]=x,y.set(B,x),x+=B.length}return y[3+t.length]=x,y.set(this.keys,x),y[3+t.length+1]=x+=this.keys.length,y.set(this.bboxes,x),x+=this.bboxes.length,y.buffer};var xc=V.ImageData,Nf=V.ImageBitmap,wo={};function oi(t,o,u){u===void 0&&(u={}),Object.defineProperty(o,"_classRegistryKey",{value:t,writeable:!1}),wo[t]={klass:o,omit:u.omit||[],shallow:u.shallow||[]}}for(var Ks in oi("Object",Object),ps.serialize=function(t,o){var u=t.toArrayBuffer();return o&&o.push(u),{buffer:u}},ps.deserialize=function(t){return new ps(t.buffer)},oi("Grid",ps),oi("Color",jr),oi("Error",Error),oi("ResolvedImage",Aa),oi("StylePropertyFunction",rl),oi("StyleExpression",Iu,{omit:["_evaluator"]}),oi("ZoomDependentExpression",jl),oi("ZoomConstantExpression",Jl),oi("CompoundExpression",ja,{omit:["_evaluate"]}),Mu)Mu[Ks]._classRegistryKey||oi("Expression_"+Ks,Mu[Ks]);function rc(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function nc(t){return Nf&&t instanceof Nf}function Cs(t,o){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(rc(t)||nc(t))return o&&o.push(t),t;if(ArrayBuffer.isView(t)){var u=t;return o&&o.push(u.buffer),u}if(t instanceof xc)return o&&o.push(t.data.buffer),t;if(Array.isArray(t)){for(var v=[],y=0,x=t;y<x.length;y+=1)v.push(Cs(x[y],o));return v}if(typeof t=="object"){var A=t.constructor,B=A._classRegistryKey;if(!B)throw new Error("can't serialize object of unregistered class");var te=A.serialize?A.serialize(t,o):{};if(!A.serialize){for(var _e in t)if(t.hasOwnProperty(_e)&&!(wo[B].omit.indexOf(_e)>=0)){var Ce=t[_e];te[_e]=wo[B].shallow.indexOf(_e)>=0?Ce:Cs(Ce,o)}t instanceof Error&&(te.message=t.message)}if(te.$name)throw new Error("$name property is reserved for worker serialization logic.");return B!=="Object"&&(te.$name=B),te}throw new Error("can't serialize object of type "+typeof t)}function wa(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||rc(t)||nc(t)||ArrayBuffer.isView(t)||t instanceof xc)return t;if(Array.isArray(t))return t.map(wa);if(typeof t=="object"){var o=t.$name||"Object",u=wo[o].klass;if(!u)throw new Error("can't deserialize unregistered class "+o);if(u.deserialize)return u.deserialize(t);for(var v=Object.create(u.prototype),y=0,x=Object.keys(t);y<x.length;y+=1){var A=x[y];if(A!=="$name"){var B=t[A];v[A]=wo[o].shallow.indexOf(A)>=0?B:wa(B)}}return v}throw new Error("can't deserialize object of type "+typeof t)}var qs=function(){this.first=!0};qs.prototype.update=function(t,o){var u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))};var zn={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Du(t){for(var o=0,u=t;o<u.length;o+=1)if(il(u[o].charCodeAt(0)))return!0;return!1}function il(t){return!(t!==746&&t!==747&&(t<4352||!(zn["Bopomofo Extended"](t)||zn.Bopomofo(t)||zn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||zn["CJK Compatibility Ideographs"](t)||zn["CJK Compatibility"](t)||zn["CJK Radicals Supplement"](t)||zn["CJK Strokes"](t)||!(!zn["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||zn["CJK Unified Ideographs Extension A"](t)||zn["CJK Unified Ideographs"](t)||zn["Enclosed CJK Letters and Months"](t)||zn["Hangul Compatibility Jamo"](t)||zn["Hangul Jamo Extended-A"](t)||zn["Hangul Jamo Extended-B"](t)||zn["Hangul Jamo"](t)||zn["Hangul Syllables"](t)||zn.Hiragana(t)||zn["Ideographic Description Characters"](t)||zn.Kanbun(t)||zn["Kangxi Radicals"](t)||zn["Katakana Phonetic Extensions"](t)||zn.Katakana(t)&&t!==12540||!(!zn["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!zn["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||zn["Unified Canadian Aboriginal Syllabics"](t)||zn["Unified Canadian Aboriginal Syllabics Extended"](t)||zn["Vertical Forms"](t)||zn["Yijing Hexagram Symbols"](t)||zn["Yi Syllables"](t)||zn["Yi Radicals"](t))))}function Ec(t){return!(il(t)||function(o){return!!(zn["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||zn["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||zn["Letterlike Symbols"](o)||zn["Number Forms"](o)||zn["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||zn["Control Pictures"](o)&&o!==9251||zn["Optical Character Recognition"](o)||zn["Enclosed Alphanumerics"](o)||zn["Geometric Shapes"](o)||zn["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||zn["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||zn["CJK Symbols and Punctuation"](o)||zn.Katakana(o)||zn["Private Use Area"](o)||zn["CJK Compatibility Forms"](o)||zn["Small Form Variants"](o)||zn["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(t))}function Eu(t){return t>=1424&&t<=2303||zn["Arabic Presentation Forms-A"](t)||zn["Arabic Presentation Forms-B"](t)}function su(t,o){return!(!o&&Eu(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||zn.Khmer(t))}function Lc(t){for(var o=0,u=t;o<u.length;o+=1)if(Eu(u[o].charCodeAt(0)))return!0;return!1}var Rl=null,vs="unavailable",uu=null,Sf=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(vs="error"),Rl&&Rl(t)};function Bc(){Sc.fire(new qe("pluginStateChange",{pluginStatus:vs,pluginURL:uu}))}var Sc=new kt,Tf=function(){return vs},Su=function(){if(vs!=="deferred"||!uu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vs="loading",Bc(),uu&&or({url:uu},function(t){t?Sf(t):(vs="loaded",Bc())})},$o={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return vs==="loaded"||$o.applyArabicShaping!=null},isLoading:function(){return vs==="loading"},setState:function(t){vs=t.pluginStatus,uu=t.pluginURL},isParsed:function(){return $o.applyArabicShaping!=null&&$o.processBidirectionalText!=null&&$o.processStyledBidirectionalText!=null},getPluginURL:function(){return uu}},ea=function(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qs,this.transition={})};ea.prototype.isSupportedScript=function(t){return function(o,u){for(var v=0,y=o;v<y.length;v+=1)if(!su(y[v].charCodeAt(0),u))return!1;return!0}(t,$o.isLoaded())},ea.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ea.prototype.getCrossfadeParameters=function(){var t=this.zoom,o=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}};var Qs=function(t,o){this.property=t,this.value=o,this.expression=function(u,v){if(Vu(u))return new rl(u,v);if(tl(u)){var y=kc(u,v);if(y.result==="error")throw new Error(y.value.map(function(A){return A.key+": "+A.message}).join(", "));return y.value}var x=u;return typeof u=="string"&&v.type==="color"&&(x=jr.parse(u)),{kind:"constant",evaluate:function(){return x}}}(o===void 0?t.specification.default:o,t.specification)};Qs.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Qs.prototype.possiblyEvaluate=function(t,o,u){return this.property.possiblyEvaluate(this,t,o,u)};var Tu=function(t){this.property=t,this.value=new Qs(t,void 0)};Tu.prototype.transitioned=function(t,o){return new Ml(this.property,this.value,o,J({},t.transition,this.transition),t.now)},Tu.prototype.untransitioned=function(){return new Ml(this.property,this.value,null,{},0)};var Ga=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Ga.prototype.getValue=function(t){return ee(this._values[t].value.value)},Ga.prototype.setValue=function(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new Tu(this._values[t].property)),this._values[t].value=new Qs(this._values[t].property,o===null?void 0:ee(o))},Ga.prototype.getTransition=function(t){return ee(this._values[t].transition)},Ga.prototype.setTransition=function(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new Tu(this._values[t].property)),this._values[t].transition=ee(o)||void 0},Ga.prototype.serialize=function(){for(var t={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o],y=this.getValue(v);y!==void 0&&(t[v]=y);var x=this.getTransition(v);x!==void 0&&(t[v+"-transition"]=x)}return t},Ga.prototype.transitioned=function(t,o){for(var u=new al(this._properties),v=0,y=Object.keys(this._values);v<y.length;v+=1){var x=y[v];u._values[x]=this._values[x].transitioned(t,o._values[x])}return u},Ga.prototype.untransitioned=function(){for(var t=new al(this._properties),o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o];t._values[v]=this._values[v].untransitioned()}return t};var Ml=function(t,o,u,v,y){this.property=t,this.value=o,this.begin=y+v.delay||0,this.end=this.begin+v.duration||0,t.specification.transition&&(v.delay||v.duration)&&(this.prior=u)};Ml.prototype.possiblyEvaluate=function(t,o,u){var v=t.now||0,y=this.value.possiblyEvaluate(t,o,u),x=this.prior;if(x){if(v>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(v<this.begin)return x.possiblyEvaluate(t,o,u);var A=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(t,o,u),y,function(B){if(B<=0)return 0;if(B>=1)return 1;var te=B*B,_e=te*B;return 4*(B<.5?_e:3*(B-te)+_e-.75)}(A))}return y};var al=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};al.prototype.possiblyEvaluate=function(t,o,u){for(var v=new ic(this._properties),y=0,x=Object.keys(this._values);y<x.length;y+=1){var A=x[y];v._values[A]=this._values[A].possiblyEvaluate(t,o,u)}return v},al.prototype.hasTransition=function(){for(var t=0,o=Object.keys(this._values);t<o.length;t+=1)if(this._values[o[t]].prior)return!0;return!1};var lu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};lu.prototype.getValue=function(t){return ee(this._values[t].value)},lu.prototype.setValue=function(t,o){this._values[t]=new Qs(this._values[t].property,o===null?void 0:ee(o))},lu.prototype.serialize=function(){for(var t={},o=0,u=Object.keys(this._values);o<u.length;o+=1){var v=u[o],y=this.getValue(v);y!==void 0&&(t[v]=y)}return t},lu.prototype.possiblyEvaluate=function(t,o,u){for(var v=new ic(this._properties),y=0,x=Object.keys(this._values);y<x.length;y+=1){var A=x[y];v._values[A]=this._values[A].possiblyEvaluate(t,o,u)}return v};var es=function(t,o,u){this.property=t,this.value=o,this.parameters=u};es.prototype.isConstant=function(){return this.value.kind==="constant"},es.prototype.constantOr=function(t){return this.value.kind==="constant"?this.value.value:t},es.prototype.evaluate=function(t,o,u,v){return this.property.evaluate(this.value,this.parameters,t,o,u,v)};var ic=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};ic.prototype.get=function(t){return this._values[t]};var Ci=function(t){this.specification=t};Ci.prototype.possiblyEvaluate=function(t,o){return t.expression.evaluate(o)},Ci.prototype.interpolate=function(t,o,u){var v=Hi[this.specification.type];return v?v(t,o,u):t};var rn=function(t,o){this.specification=t,this.overrides=o};rn.prototype.possiblyEvaluate=function(t,o,u,v){return new es(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},u,v)}:t.expression,o)},rn.prototype.interpolate=function(t,o,u){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new es(this,{kind:"constant",value:void 0},t.parameters);var v=Hi[this.specification.type];return v?new es(this,{kind:"constant",value:v(t.value.value,o.value.value,u)},t.parameters):t},rn.prototype.evaluate=function(t,o,u,v,y,x){return t.kind==="constant"?t.value:t.evaluate(o,u,v,y,x)};var cu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,v,y,x){if(u.value===void 0)return new es(this,{kind:"constant",value:void 0},v);if(u.expression.kind==="constant"){var A=u.expression.evaluate(v,null,{},y,x),B=u.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,te=this._calculate(B,B,B,v);return new es(this,{kind:"constant",value:te},v)}if(u.expression.kind==="camera"){var _e=this._calculate(u.expression.evaluate({zoom:v.zoom-1}),u.expression.evaluate({zoom:v.zoom}),u.expression.evaluate({zoom:v.zoom+1}),v);return new es(this,{kind:"constant",value:_e},v)}return new es(this,u.expression,v)},o.prototype.evaluate=function(u,v,y,x,A,B){if(u.kind==="source"){var te=u.evaluate(v,y,x,A,B);return this._calculate(te,te,te,v)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(v.zoom)-1},y,x),u.evaluate({zoom:Math.floor(v.zoom)},y,x),u.evaluate({zoom:Math.floor(v.zoom)+1},y,x),v):u.value},o.prototype._calculate=function(u,v,y,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:u,to:v}:{from:y,to:v}},o.prototype.interpolate=function(u){return u},o}(rn),ws=function(t){this.specification=t};ws.prototype.possiblyEvaluate=function(t,o,u,v){if(t.value!==void 0){if(t.expression.kind==="constant"){var y=t.expression.evaluate(o,null,{},u,v);return this._calculate(y,y,y,o)}return this._calculate(t.expression.evaluate(new ea(Math.floor(o.zoom-1),o)),t.expression.evaluate(new ea(Math.floor(o.zoom),o)),t.expression.evaluate(new ea(Math.floor(o.zoom+1),o)),o)}},ws.prototype._calculate=function(t,o,u,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:u,to:o}},ws.prototype.interpolate=function(t){return t};var fu=function(t){this.specification=t};fu.prototype.possiblyEvaluate=function(t,o,u,v){return!!t.expression.evaluate(o,null,{},u,v)},fu.prototype.interpolate=function(){return!1};var Ro=function(t){for(var o in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[o];u.specification.overridable&&this.overridableProperties.push(o);var v=this.defaultPropertyValues[o]=new Qs(u,void 0),y=this.defaultTransitionablePropertyValues[o]=new Tu(u);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=v.possiblyEvaluate({})}};oi("DataDrivenProperty",rn),oi("DataConstantProperty",Ci),oi("CrossFadedDataDrivenProperty",cu),oi("CrossFadedProperty",ws),oi("ColorRampProperty",fu);var Fs=function(t){function o(u,v){if(t.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},u.type!=="custom"&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),v.layout&&(this._unevaluatedLayout=new lu(v.layout)),v.paint)){for(var y in this._transitionablePaint=new Ga(v.paint),u.paint)this.setPaintProperty(y,u.paint[y],{validate:!1});for(var x in u.layout)this.setLayoutProperty(x,u.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ic(v.paint)}}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},o.prototype.getLayoutProperty=function(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)},o.prototype.setLayoutProperty=function(u,v,y){y===void 0&&(y={}),v!=null&&this._validate(ec,"layers."+this.id+".layout."+u,u,v,y)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,v):this.visibility=v)},o.prototype.getPaintProperty=function(u){return Re(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},o.prototype.setPaintProperty=function(u,v,y){if(y===void 0&&(y={}),v!=null&&this._validate(Yc,"layers."+this.id+".paint."+u,u,v,y))return!1;if(Re(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),v||void 0),!1;var x=this._transitionablePaint._values[u],A=x.property.specification["property-type"]==="cross-faded-data-driven",B=x.value.isDataDriven(),te=x.value;this._transitionablePaint.setValue(u,v),this._handleSpecialPaintPropertyUpdate(u);var _e=this._transitionablePaint._values[u].value;return _e.isDataDriven()||B||A||this._handleOverridablePaintPropertyUpdate(u,te,_e)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){},o.prototype._handleOverridablePaintPropertyUpdate=function(u,v,y){return!1},o.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"},o.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},o.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},o.prototype.recalculate=function(u,v){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,v)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,v)},o.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),ae(u,function(v,y){return!(v===void 0||y==="layout"&&!Object.keys(v).length||y==="paint"&&!Object.keys(v).length)})},o.prototype._validate=function(u,v,y,x,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&tc(this,u.call(Bs,{key:v,layerType:this.type,objectKey:y,value:x,styleSpec:$e,style:{glyphs:!0,sprite:!0}}))},o.prototype.is3D=function(){return!1},o.prototype.isTileClipped=function(){return!1},o.prototype.hasOffscreenPass=function(){return!1},o.prototype.resize=function(){},o.prototype.isStateDependent=function(){for(var u in this.paint._values){var v=this.paint.get(u);if(v instanceof es&&ou(v.property.specification)&&(v.value.kind==="source"||v.value.kind==="composite")&&v.value.isStateDependent)return!0}return!1},o}(kt),ku={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Il=function(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Na=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function No(t,o){o===void 0&&(o=1);var u=0,v=0;return{members:t.map(function(y){var x=ku[y.type].BYTES_PER_ELEMENT,A=u=ao(u,Math.max(o,x)),B=y.components||1;return v=Math.max(v,x),u+=x*B,{name:y.name,type:y.type,components:B,offset:A}}),size:ao(u,Math.max(v,o)),alignment:o}}function ao(t,o){return Math.ceil(t/o)*o}Na.serialize=function(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Na.deserialize=function(t){var o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o},Na.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Na.prototype.clear=function(){this.length=0},Na.prototype.resize=function(t){this.reserve(t),this.length=t},Na.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}},Na.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ol=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var y=this.length;return this.resize(y+1),this.emplace(y,u,v)},o.prototype.emplace=function(u,v,y){var x=2*u;return this.int16[x+0]=v,this.int16[x+1]=y,u},o}(Na);ol.prototype.bytesPerElement=4,oi("StructArrayLayout2i4",ol);var sl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x){var A=this.length;return this.resize(A+1),this.emplace(A,u,v,y,x)},o.prototype.emplace=function(u,v,y,x,A){var B=4*u;return this.int16[B+0]=v,this.int16[B+1]=y,this.int16[B+2]=x,this.int16[B+3]=A,u},o}(Na);sl.prototype.bytesPerElement=8,oi("StructArrayLayout4i8",sl);var ul=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B){var te=this.length;return this.resize(te+1),this.emplace(te,u,v,y,x,A,B)},o.prototype.emplace=function(u,v,y,x,A,B,te){var _e=6*u;return this.int16[_e+0]=v,this.int16[_e+1]=y,this.int16[_e+2]=x,this.int16[_e+3]=A,this.int16[_e+4]=B,this.int16[_e+5]=te,u},o}(Na);ul.prototype.bytesPerElement=12,oi("StructArrayLayout2i4i12",ul);var hu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B){var te=this.length;return this.resize(te+1),this.emplace(te,u,v,y,x,A,B)},o.prototype.emplace=function(u,v,y,x,A,B,te){var _e=4*u,Ce=8*u;return this.int16[_e+0]=v,this.int16[_e+1]=y,this.uint8[Ce+4]=x,this.uint8[Ce+5]=A,this.uint8[Ce+6]=B,this.uint8[Ce+7]=te,u},o}(Na);hu.prototype.bytesPerElement=8,oi("StructArrayLayout2i4ub8",hu);var Tc=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var y=this.length;return this.resize(y+1),this.emplace(y,u,v)},o.prototype.emplace=function(u,v,y){var x=2*u;return this.float32[x+0]=v,this.float32[x+1]=y,u},o}(Na);Tc.prototype.bytesPerElement=8,oi("StructArrayLayout2f8",Tc);var ll=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B,te,_e,Ce,Ie){var Xe=this.length;return this.resize(Xe+1),this.emplace(Xe,u,v,y,x,A,B,te,_e,Ce,Ie)},o.prototype.emplace=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe){var tt=10*u;return this.uint16[tt+0]=v,this.uint16[tt+1]=y,this.uint16[tt+2]=x,this.uint16[tt+3]=A,this.uint16[tt+4]=B,this.uint16[tt+5]=te,this.uint16[tt+6]=_e,this.uint16[tt+7]=Ce,this.uint16[tt+8]=Ie,this.uint16[tt+9]=Xe,u},o}(Na);ll.prototype.bytesPerElement=20,oi("StructArrayLayout10ui20",ll);var Kc=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt){var Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt)},o.prototype.emplace=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt){var Pt=12*u;return this.int16[Pt+0]=v,this.int16[Pt+1]=y,this.int16[Pt+2]=x,this.int16[Pt+3]=A,this.uint16[Pt+4]=B,this.uint16[Pt+5]=te,this.uint16[Pt+6]=_e,this.uint16[Pt+7]=Ce,this.int16[Pt+8]=Ie,this.int16[Pt+9]=Xe,this.int16[Pt+10]=tt,this.int16[Pt+11]=Mt,u},o}(Na);Kc.prototype.bytesPerElement=24,oi("StructArrayLayout4i4ui4i24",Kc);var ac=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var x=this.length;return this.resize(x+1),this.emplace(x,u,v,y)},o.prototype.emplace=function(u,v,y,x){var A=3*u;return this.float32[A+0]=v,this.float32[A+1]=y,this.float32[A+2]=x,u},o}(Na);ac.prototype.bytesPerElement=12,oi("StructArrayLayout3f12",ac);var Vi=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.uint32[1*u+0]=v,u},o}(Na);Vi.prototype.bytesPerElement=4,oi("StructArrayLayout1ul4",Vi);var Ol=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B,te,_e,Ce){var Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,u,v,y,x,A,B,te,_e,Ce)},o.prototype.emplace=function(u,v,y,x,A,B,te,_e,Ce,Ie){var Xe=10*u,tt=5*u;return this.int16[Xe+0]=v,this.int16[Xe+1]=y,this.int16[Xe+2]=x,this.int16[Xe+3]=A,this.int16[Xe+4]=B,this.int16[Xe+5]=te,this.uint32[tt+3]=_e,this.uint16[Xe+8]=Ce,this.uint16[Xe+9]=Ie,u},o}(Na);Ol.prototype.bytesPerElement=20,oi("StructArrayLayout6i1ul2ui20",Ol);var Pl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B){var te=this.length;return this.resize(te+1),this.emplace(te,u,v,y,x,A,B)},o.prototype.emplace=function(u,v,y,x,A,B,te){var _e=6*u;return this.int16[_e+0]=v,this.int16[_e+1]=y,this.int16[_e+2]=x,this.int16[_e+3]=A,this.int16[_e+4]=B,this.int16[_e+5]=te,u},o}(Na);Pl.prototype.bytesPerElement=12,oi("StructArrayLayout2i2i2i12",Pl);var yo=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A){var B=this.length;return this.resize(B+1),this.emplace(B,u,v,y,x,A)},o.prototype.emplace=function(u,v,y,x,A,B){var te=4*u,_e=8*u;return this.float32[te+0]=v,this.float32[te+1]=y,this.float32[te+2]=x,this.int16[_e+6]=A,this.int16[_e+7]=B,u},o}(Na);yo.prototype.bytesPerElement=16,oi("StructArrayLayout2f1f2i16",yo);var Gu=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x){var A=this.length;return this.resize(A+1),this.emplace(A,u,v,y,x)},o.prototype.emplace=function(u,v,y,x,A){var B=12*u,te=3*u;return this.uint8[B+0]=v,this.uint8[B+1]=y,this.float32[te+1]=x,this.float32[te+2]=A,u},o}(Na);Gu.prototype.bytesPerElement=12,oi("StructArrayLayout2ub2f12",Gu);var Ii=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var x=this.length;return this.resize(x+1),this.emplace(x,u,v,y)},o.prototype.emplace=function(u,v,y,x){var A=3*u;return this.uint16[A+0]=v,this.uint16[A+1]=y,this.uint16[A+2]=x,u},o}(Na);Ii.prototype.bytesPerElement=6,oi("StructArrayLayout3ui6",Ii);var Ns=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt,qt,Zt,pr){var Sr=this.length;return this.resize(Sr+1),this.emplace(Sr,u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt,qt,Zt,pr)},o.prototype.emplace=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt,qt,Zt,pr,Sr){var Br=24*u,Vr=12*u,fn=48*u;return this.int16[Br+0]=v,this.int16[Br+1]=y,this.uint16[Br+2]=x,this.uint16[Br+3]=A,this.uint32[Vr+2]=B,this.uint32[Vr+3]=te,this.uint32[Vr+4]=_e,this.uint16[Br+10]=Ce,this.uint16[Br+11]=Ie,this.uint16[Br+12]=Xe,this.float32[Vr+7]=tt,this.float32[Vr+8]=Mt,this.uint8[fn+36]=Pt,this.uint8[fn+37]=qt,this.uint8[fn+38]=Zt,this.uint32[Vr+10]=pr,this.int16[Br+22]=Sr,u},o}(Na);Ns.prototype.bytesPerElement=48,oi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ns);var cl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt,qt,Zt,pr,Sr,Br,Vr,fn,Nn,qn,Di,ci,ki,hi,ma){var Qi=this.length;return this.resize(Qi+1),this.emplace(Qi,u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt,qt,Zt,pr,Sr,Br,Vr,fn,Nn,qn,Di,ci,ki,hi,ma)},o.prototype.emplace=function(u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt,qt,Zt,pr,Sr,Br,Vr,fn,Nn,qn,Di,ci,ki,hi,ma,Qi){var Ti=34*u,Ji=17*u;return this.int16[Ti+0]=v,this.int16[Ti+1]=y,this.int16[Ti+2]=x,this.int16[Ti+3]=A,this.int16[Ti+4]=B,this.int16[Ti+5]=te,this.int16[Ti+6]=_e,this.int16[Ti+7]=Ce,this.uint16[Ti+8]=Ie,this.uint16[Ti+9]=Xe,this.uint16[Ti+10]=tt,this.uint16[Ti+11]=Mt,this.uint16[Ti+12]=Pt,this.uint16[Ti+13]=qt,this.uint16[Ti+14]=Zt,this.uint16[Ti+15]=pr,this.uint16[Ti+16]=Sr,this.uint16[Ti+17]=Br,this.uint16[Ti+18]=Vr,this.uint16[Ti+19]=fn,this.uint16[Ti+20]=Nn,this.uint16[Ti+21]=qn,this.uint16[Ti+22]=Di,this.uint32[Ji+12]=ci,this.float32[Ji+13]=ki,this.float32[Ji+14]=hi,this.float32[Ji+15]=ma,this.float32[Ji+16]=Qi,u},o}(Na);cl.prototype.bytesPerElement=68,oi("StructArrayLayout8i15ui1ul4f68",cl);var eo=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.float32[1*u+0]=v,u},o}(Na);eo.prototype.bytesPerElement=4,oi("StructArrayLayout1f4",eo);var Wo=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var x=this.length;return this.resize(x+1),this.emplace(x,u,v,y)},o.prototype.emplace=function(u,v,y,x){var A=3*u;return this.int16[A+0]=v,this.int16[A+1]=y,this.int16[A+2]=x,u},o}(Na);Wo.prototype.bytesPerElement=6,oi("StructArrayLayout3i6",Wo);var Wl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y){var x=this.length;return this.resize(x+1),this.emplace(x,u,v,y)},o.prototype.emplace=function(u,v,y,x){var A=4*u;return this.uint32[2*u+0]=v,this.uint16[A+2]=y,this.uint16[A+3]=x,u},o}(Na);Wl.prototype.bytesPerElement=8,oi("StructArrayLayout1ul2ui8",Wl);var oc=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v){var y=this.length;return this.resize(y+1),this.emplace(y,u,v)},o.prototype.emplace=function(u,v,y){var x=2*u;return this.uint16[x+0]=v,this.uint16[x+1]=y,u},o}(Na);oc.prototype.bytesPerElement=4,oi("StructArrayLayout2ui4",oc);var Ra=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u){var v=this.length;return this.resize(v+1),this.emplace(v,u)},o.prototype.emplace=function(u,v){return this.uint16[1*u+0]=v,u},o}(Na);Ra.prototype.bytesPerElement=2,oi("StructArrayLayout1ui2",Ra);var Gl=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},o.prototype.emplaceBack=function(u,v,y,x){var A=this.length;return this.resize(A+1),this.emplace(A,u,v,y,x)},o.prototype.emplace=function(u,v,y,x,A){var B=4*u;return this.float32[B+0]=v,this.float32[B+1]=y,this.float32[B+2]=x,this.float32[B+3]=A,u},o}(Na);Gl.prototype.bytesPerElement=16,oi("StructArrayLayout4f16",Gl);var l=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(o.prototype,u),o}(Il);l.prototype.size=20;var d=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new l(this,u)},o}(Ol);oi("CollisionBoxArray",d);var f=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(v){this._structArray.uint8[this._pos1+37]=v},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(v){this._structArray.uint8[this._pos1+38]=v},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(v){this._structArray.uint32[this._pos4+10]=v},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(o.prototype,u),o}(Il);f.prototype.size=48;var m=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new f(this,u)},o}(Ns);oi("PlacedSymbolArray",m);var S=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(v){this._structArray.uint32[this._pos4+12]=v},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(o.prototype,u),o}(Il);S.prototype.size=68;var R=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new S(this,u)},o}(cl);oi("SymbolInstanceArray",R);var L=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getoffsetX=function(u){return this.float32[1*u+0]},o}(eo);oi("GlyphOffsetArray",L);var q=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getx=function(u){return this.int16[3*u+0]},o.prototype.gety=function(u){return this.int16[3*u+1]},o.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},o}(Wo);oi("SymbolLineVertexArray",q);var Se=function(t){function o(){t.apply(this,arguments)}t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(o.prototype,u),o}(Il);Se.prototype.size=8;var Le=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.get=function(u){return new Se(this,u)},o}(Wl);oi("FeatureIndexArray",Le);var et=No([{name:"a_pos",components:2,type:"Int16"}],4).members,ot=function(t){t===void 0&&(t=[]),this.segments=t};function st(t,o){return 256*(t=U(Math.floor(t),0,255))+U(Math.floor(o),0,255)}ot.prototype.prepareSegment=function(t,o,u,v){var y=this.segments[this.segments.length-1];return t>ot.MAX_VERTEX_ARRAY_LENGTH&&ge("Max vertices per segment is "+ot.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!y||y.vertexLength+t>ot.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==v)&&(y={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},v!==void 0&&(y.sortKey=v),this.segments.push(y)),y},ot.prototype.get=function(){return this.segments},ot.prototype.destroy=function(){for(var t=0,o=this.segments;t<o.length;t+=1){var u=o[t];for(var v in u.vaos)u.vaos[v].destroy()}},ot.simpleSegment=function(t,o,u,v){return new ot([{vertexOffset:t,primitiveOffset:o,vertexLength:u,primitiveLength:v,vaos:{},sortKey:0}])},ot.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,oi("SegmentVector",ot);var Rt=No([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ct=O(function(t){t.exports=function(o,u){var v,y,x,A,B,te,_e,Ce;for(y=o.length-(v=3&o.length),x=u,B=3432918353,te=461845907,Ce=0;Ce<y;)_e=255&o.charCodeAt(Ce)|(255&o.charCodeAt(++Ce))<<8|(255&o.charCodeAt(++Ce))<<16|(255&o.charCodeAt(++Ce))<<24,++Ce,x=27492+(65535&(A=5*(65535&(x=(x^=_e=(65535&(_e=(_e=(65535&_e)*B+(((_e>>>16)*B&65535)<<16)&4294967295)<<15|_e>>>17))*te+(((_e>>>16)*te&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(_e=0,v){case 3:_e^=(255&o.charCodeAt(Ce+2))<<16;case 2:_e^=(255&o.charCodeAt(Ce+1))<<8;case 1:x^=_e=(65535&(_e=(_e=(65535&(_e^=255&o.charCodeAt(Ce)))*B+(((_e>>>16)*B&65535)<<16)&4294967295)<<15|_e>>>17))*te+(((_e>>>16)*te&65535)<<16)&4294967295}return x^=o.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}}),Xt=O(function(t){t.exports=function(o,u){for(var v,y=o.length,x=u^y,A=0;y>=4;)v=1540483477*(65535&(v=255&o.charCodeAt(A)|(255&o.charCodeAt(++A))<<8|(255&o.charCodeAt(++A))<<16|(255&o.charCodeAt(++A))<<24))+((1540483477*(v>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),y-=4,++A;switch(y){case 3:x^=(255&o.charCodeAt(A+2))<<16;case 2:x^=(255&o.charCodeAt(A+1))<<8;case 1:x=1540483477*(65535&(x^=255&o.charCodeAt(A)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}}),St=Ct,$t=Xt;St.murmur3=Ct,St.murmur2=$t;var tr=function(){this.ids=[],this.positions=[],this.indexed=!1};tr.prototype.add=function(t,o,u,v){this.ids.push(kr(t)),this.positions.push(o,u,v)},tr.prototype.getPositions=function(t){for(var o=kr(t),u=0,v=this.ids.length-1;u<v;){var y=u+v>>1;this.ids[y]>=o?v=y:u=y+1}for(var x=[];this.ids[u]===o;)x.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return x},tr.serialize=function(t,o){var u=new Float64Array(t.ids),v=new Uint32Array(t.positions);return function y(x,A,B,te){for(;B<te;){for(var _e=x[B+te>>1],Ce=B-1,Ie=te+1;;){do Ce++;while(x[Ce]<_e);do Ie--;while(x[Ie]>_e);if(Ce>=Ie)break;Or(x,Ce,Ie),Or(A,3*Ce,3*Ie),Or(A,3*Ce+1,3*Ie+1),Or(A,3*Ce+2,3*Ie+2)}Ie-B<te-Ie?(y(x,A,B,Ie),B=Ie+1):(y(x,A,Ie+1,te),te=Ie)}}(u,v,0,u.length-1),o&&o.push(u.buffer,v.buffer),{ids:u,positions:v}},tr.deserialize=function(t){var o=new tr;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o};var br=Math.pow(2,53)-1;function kr(t){var o=+t;return!isNaN(o)&&o<=br?o:St(String(t))}function Or(t,o,u){var v=t[o];t[o]=t[u],t[u]=v}oi("FeaturePositionMap",tr);var Hr=function(t,o){this.gl=t.gl,this.location=o},nn=function(t){function o(u,v){t.call(this,u,v),this.current=0}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},o}(Hr),M=function(t){function o(u,v){t.call(this,u,v),this.current=0}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},o}(Hr),z=function(t){function o(u,v){t.call(this,u,v),this.current=[0,0]}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},o}(Hr),j=function(t){function o(u,v){t.call(this,u,v),this.current=[0,0,0]}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},o}(Hr),ne=function(t){function o(u,v){t.call(this,u,v),this.current=[0,0,0,0]}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},o}(Hr),ce=function(t){function o(u,v){t.call(this,u,v),this.current=jr.transparent}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},o}(Hr),le=new Float32Array(16),lt=function(t){function o(u,v){t.call(this,u,v),this.current=le}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var v=1;v<16;v++)if(u[v]!==this.current[v]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},o}(Hr);function it(t){return[st(255*t.r,255*t.g),st(255*t.b,255*t.a)]}var Yt=function(t,o,u){this.value=t,this.uniformNames=o.map(function(v){return"u_"+v}),this.type=u};Yt.prototype.setUniform=function(t,o,u){t.set(u.constantOr(this.value))},Yt.prototype.getBinding=function(t,o,u){return this.type==="color"?new ce(t,o):new M(t,o)};var ht=function(t,o){this.uniformNames=o.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ht.prototype.setConstantPatternPositions=function(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr},ht.prototype.setUniform=function(t,o,u,v){var y=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&t.set(y)},ht.prototype.getBinding=function(t,o,u){return u.substr(0,9)==="u_pattern"?new ne(t,o):new M(t,o)};var er=function(t,o,u,v){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(function(y){return{name:"a_"+y,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new v};er.prototype.populatePaintArray=function(t,o,u,v,y){var x=this.paintVertexArray.length,A=this.expression.evaluate(new ea(0),o,{},v,[],y);this.paintVertexArray.resize(t),this._setPaintValue(x,t,A)},er.prototype.updatePaintArray=function(t,o,u,v){var y=this.expression.evaluate({zoom:0},u,v);this._setPaintValue(t,o,y)},er.prototype._setPaintValue=function(t,o,u){if(this.type==="color")for(var v=it(u),y=t;y<o;y++)this.paintVertexArray.emplace(y,v[0],v[1]);else{for(var x=t;x<o;x++)this.paintVertexArray.emplace(x,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},er.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},er.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var yr=function(t,o,u,v,y,x){this.expression=t,this.uniformNames=o.map(function(A){return"u_"+A+"_t"}),this.type=u,this.useIntegerZoom=v,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(function(A){return{name:"a_"+A,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new x};yr.prototype.populatePaintArray=function(t,o,u,v,y){var x=this.expression.evaluate(new ea(this.zoom),o,{},v,[],y),A=this.expression.evaluate(new ea(this.zoom+1),o,{},v,[],y),B=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(B,t,x,A)},yr.prototype.updatePaintArray=function(t,o,u,v){var y=this.expression.evaluate({zoom:this.zoom},u,v),x=this.expression.evaluate({zoom:this.zoom+1},u,v);this._setPaintValue(t,o,y,x)},yr.prototype._setPaintValue=function(t,o,u,v){if(this.type==="color")for(var y=it(u),x=it(v),A=t;A<o;A++)this.paintVertexArray.emplace(A,y[0],y[1],x[0],x[1]);else{for(var B=t;B<o;B++)this.paintVertexArray.emplace(B,u,v);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(v))}},yr.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},yr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},yr.prototype.setUniform=function(t,o){var u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,v=U(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(v)},yr.prototype.getBinding=function(t,o,u){return new M(t,o)};var _n=function(t,o,u,v,y,x){this.expression=t,this.type=o,this.useIntegerZoom=u,this.zoom=v,this.layerId=x,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y};_n.prototype.populatePaintArray=function(t,o,u){var v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(v,t,o.patterns&&o.patterns[this.layerId],u)},_n.prototype.updatePaintArray=function(t,o,u,v,y){this._setPaintValues(t,o,u.patterns&&u.patterns[this.layerId],y)},_n.prototype._setPaintValues=function(t,o,u,v){if(v&&u){var y=v[u.min],x=v[u.mid],A=v[u.max];if(y&&x&&A)for(var B=t;B<o;B++)this.zoomInPaintVertexArray.emplace(B,x.tl[0],x.tl[1],x.br[0],x.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],x.pixelRatio,y.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,x.tl[0],x.tl[1],x.br[0],x.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],x.pixelRatio,A.pixelRatio)}},_n.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Rt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Rt.members,this.expression.isStateDependent))},_n.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var vn=function(t,o,u){this.binders={},this._buffers=[];var v=[];for(var y in t.paint._values)if(u(y)){var x=t.paint.get(y);if(x instanceof es&&ou(x.property.specification)){var A=Gn(y,t.type),B=x.value,te=x.property.specification.type,_e=x.property.useIntegerZoom,Ce=x.property.specification["property-type"],Ie=Ce==="cross-faded"||Ce==="cross-faded-data-driven";if(B.kind==="constant")this.binders[y]=Ie?new ht(B.value,A):new Yt(B.value,A,te),v.push("/u_"+y);else if(B.kind==="source"||Ie){var Xe=Xn(y,te,"source");this.binders[y]=Ie?new _n(B,te,_e,o,Xe,t.id):new er(B,A,te,Xe),v.push("/a_"+y)}else{var tt=Xn(y,te,"composite");this.binders[y]=new yr(B,A,te,_e,o,tt),v.push("/z_"+y)}}}this.cacheKey=v.sort().join("")};vn.prototype.getMaxValue=function(t){var o=this.binders[t];return o instanceof er||o instanceof yr?o.maxValue:0},vn.prototype.populatePaintArrays=function(t,o,u,v,y){for(var x in this.binders){var A=this.binders[x];(A instanceof er||A instanceof yr||A instanceof _n)&&A.populatePaintArray(t,o,u,v,y)}},vn.prototype.setConstantPatternPositions=function(t,o){for(var u in this.binders){var v=this.binders[u];v instanceof ht&&v.setConstantPatternPositions(t,o)}},vn.prototype.updatePaintArrays=function(t,o,u,v,y){var x=!1;for(var A in t)for(var B=0,te=o.getPositions(A);B<te.length;B+=1){var _e=te[B],Ce=u.feature(_e.index);for(var Ie in this.binders){var Xe=this.binders[Ie];if((Xe instanceof er||Xe instanceof yr||Xe instanceof _n)&&Xe.expression.isStateDependent===!0){var tt=v.paint.get(Ie);Xe.expression=tt.value,Xe.updatePaintArray(_e.start,_e.end,Ce,t[A],y),x=!0}}}return x},vn.prototype.defines=function(){var t=[];for(var o in this.binders){var u=this.binders[o];(u instanceof Yt||u instanceof ht)&&t.push.apply(t,u.uniformNames.map(function(v){return"#define HAS_UNIFORM_"+v}))}return t},vn.prototype.getBinderAttributes=function(){var t=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof er||u instanceof yr)for(var v=0;v<u.paintVertexAttributes.length;v++)t.push(u.paintVertexAttributes[v].name);else if(u instanceof _n)for(var y=0;y<Rt.members.length;y++)t.push(Rt.members[y].name)}return t},vn.prototype.getBinderUniforms=function(){var t=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof Yt||u instanceof ht||u instanceof yr)for(var v=0,y=u.uniformNames;v<y.length;v+=1)t.push(y[v])}return t},vn.prototype.getPaintVertexBuffers=function(){return this._buffers},vn.prototype.getUniforms=function(t,o){var u=[];for(var v in this.binders){var y=this.binders[v];if(y instanceof Yt||y instanceof ht||y instanceof yr)for(var x=0,A=y.uniformNames;x<A.length;x+=1){var B=A[x];if(o[B]){var te=y.getBinding(t,o[B],B);u.push({name:B,property:v,binding:te})}}}return u},vn.prototype.setUniforms=function(t,o,u,v){for(var y=0,x=o;y<x.length;y+=1){var A=x[y],B=A.name,te=A.property;this.binders[te].setUniform(A.binding,v,u.get(te),B)}},vn.prototype.updatePaintBuffers=function(t){for(var o in this._buffers=[],this.binders){var u=this.binders[o];if(t&&u instanceof _n){var v=t.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(u instanceof er||u instanceof yr)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},vn.prototype.upload=function(t){for(var o in this.binders){var u=this.binders[o];(u instanceof er||u instanceof yr||u instanceof _n)&&u.upload(t)}this.updatePaintBuffers()},vn.prototype.destroy=function(){for(var t in this.binders){var o=this.binders[t];(o instanceof er||o instanceof yr||o instanceof _n)&&o.destroy()}};var Jr=function(t,o,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var v=0,y=t;v<y.length;v+=1){var x=y[v];this.programConfigurations[x.id]=new vn(x,o,u)}this.needsUpload=!1,this._featureMap=new tr,this._bufferOffset=0};function Gn(t,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(o+"-","").replace(/-/g,"_")]}function Xn(t,o,u){var v={color:{source:Tc,composite:Gl},number:{source:eo,composite:Tc}},y=function(x){return{"line-pattern":{source:ll,composite:ll},"fill-pattern":{source:ll,composite:ll},"fill-extrusion-pattern":{source:ll,composite:ll}}[x]}(t);return y&&y[u]||v[o][u]}Jr.prototype.populatePaintArrays=function(t,o,u,v,y,x){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(t,o,v,y,x);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Jr.prototype.updatePaintArrays=function(t,o,u,v){for(var y=0,x=u;y<x.length;y+=1){var A=x[y];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(t,this._featureMap,o,A,v)||this.needsUpload}},Jr.prototype.get=function(t){return this.programConfigurations[t]},Jr.prototype.upload=function(t){if(this.needsUpload){for(var o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}},Jr.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},oi("ConstantBinder",Yt),oi("CrossFadedConstantBinder",ht),oi("SourceExpressionBinder",er),oi("CrossFadedCompositeBinder",_n),oi("CompositeExpressionBinder",yr),oi("ProgramConfiguration",vn,{omit:["_buffers"]}),oi("ProgramConfigurationSet",Jr);var Yn=Math.pow(2,14)-1,gi=-Yn-1;function xi(t){for(var o=8192/t.extent,u=t.loadGeometry(),v=0;v<u.length;v++)for(var y=u[v],x=0;x<y.length;x++){var A=y[x],B=Math.round(A.x*o),te=Math.round(A.y*o);A.x=U(B,gi,Yn),A.y=U(te,gi,Yn),(B<A.x||B>A.x+1||te<A.y||te>A.y+1)&&ge("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Ni(t,o){return{type:t.type,id:t.id,properties:t.properties,geometry:o?xi(t):[]}}function Pa(t,o,u,v,y){t.emplaceBack(2*o+(v+1)/2,2*u+(y+1)/2)}var Ua=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ol,this.indexArray=new Ii,this.segments=new ot,this.programConfigurations=new Jr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id})};function Mo(t,o){for(var u=0;u<t.length;u++)if(xo(o,t[u]))return!0;for(var v=0;v<o.length;v++)if(xo(t,o[v]))return!0;return!!Go(t,o)}function ga(t,o,u){return!!xo(t,o)||!!Uo(o,t,u)}function Xi(t,o){if(t.length===1)return Rs(o,t[0]);for(var u=0;u<o.length;u++)for(var v=o[u],y=0;y<v.length;y++)if(xo(t,v[y]))return!0;for(var x=0;x<t.length;x++)if(Rs(o,t[x]))return!0;for(var A=0;A<o.length;A++)if(Go(t,o[A]))return!0;return!1}function da(t,o,u){if(t.length>1){if(Go(t,o))return!0;for(var v=0;v<o.length;v++)if(Uo(o[v],t,u))return!0}for(var y=0;y<t.length;y++)if(Uo(t[y],o,u))return!0;return!1}function Go(t,o){if(t.length===0||o.length===0)return!1;for(var u=0;u<t.length-1;u++)for(var v=t[u],y=t[u+1],x=0;x<o.length-1;x++)if(ls(v,y,o[x],o[x+1]))return!0;return!1}function ls(t,o,u,v){return fe(t,u,v)!==fe(o,u,v)&&fe(t,o,u)!==fe(t,o,v)}function Uo(t,o,u){var v=u*u;if(o.length===1)return t.distSqr(o[0])<v;for(var y=1;y<o.length;y++)if(Xo(t,o[y-1],o[y])<v)return!0;return!1}function Xo(t,o,u){var v=o.distSqr(u);if(v===0)return t.distSqr(o);var y=((t.x-o.x)*(u.x-o.x)+(t.y-o.y)*(u.y-o.y))/v;return t.distSqr(y<0?o:y>1?u:u.sub(o)._mult(y)._add(o))}function Rs(t,o){for(var u,v,y,x=!1,A=0;A<t.length;A++)for(var B=0,te=(u=t[A]).length-1;B<u.length;te=B++)(v=u[B]).y>o.y!=(y=u[te]).y>o.y&&o.x<(y.x-v.x)*(o.y-v.y)/(y.y-v.y)+v.x&&(x=!x);return x}function xo(t,o){for(var u=!1,v=0,y=t.length-1;v<t.length;y=v++){var x=t[v],A=t[y];x.y>o.y!=A.y>o.y&&o.x<(A.x-x.x)*(o.y-x.y)/(A.y-x.y)+x.x&&(u=!u)}return u}function fl(t,o,u){var v=u[0],y=u[2];if(t.x<v.x&&o.x<v.x||t.x>y.x&&o.x>y.x||t.y<v.y&&o.y<v.y||t.y>y.y&&o.y>y.y)return!1;var x=fe(t,o,u[0]);return x!==fe(t,o,u[1])||x!==fe(t,o,u[2])||x!==fe(t,o,u[3])}function ms(t,o,u){var v=o.paint.get(t).value;return v.kind==="constant"?v.value:u.programConfigurations.get(o.id).getMaxValue(t)}function Yo(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Lu(t,o,u,v,y){if(!o[0]&&!o[1])return t;var x=F.convert(o)._mult(y);u==="viewport"&&x._rotate(-v);for(var A=[],B=0;B<t.length;B++)A.push(t[B].sub(x));return A}Ua.prototype.populate=function(t,o,u){var v=this.layers[0],y=[],x=null;v.type==="circle"&&(x=v.layout.get("circle-sort-key"));for(var A=0,B=t;A<B.length;A+=1){var te=B[A],_e=te.feature,Ce=te.id,Ie=te.index,Xe=te.sourceLayerIndex,tt=this.layers[0]._featureFilter.needGeometry,Mt=Ni(_e,tt);if(this.layers[0]._featureFilter.filter(new ea(this.zoom),Mt,u)){var Pt=x?x.evaluate(Mt,{},u):void 0,qt={id:Ce,properties:_e.properties,type:_e.type,sourceLayerIndex:Xe,index:Ie,geometry:tt?Mt.geometry:xi(_e),patterns:{},sortKey:Pt};y.push(qt)}}x&&y.sort(function(qn,Di){return qn.sortKey-Di.sortKey});for(var Zt=0,pr=y;Zt<pr.length;Zt+=1){var Sr=pr[Zt],Br=Sr.geometry,Vr=Sr.index,fn=Sr.sourceLayerIndex,Nn=t[Vr].feature;this.addFeature(Sr,Br,Vr,u),o.featureIndex.insert(Nn,Br,Vr,fn,this.index)}},Ua.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Ua.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ua.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ua.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,et),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ua.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ua.prototype.addFeature=function(t,o,u,v){for(var y=0,x=o;y<x.length;y+=1)for(var A=0,B=x[y];A<B.length;A+=1){var te=B[A],_e=te.x,Ce=te.y;if(!(_e<0||_e>=8192||Ce<0||Ce>=8192)){var Ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),Xe=Ie.vertexLength;Pa(this.layoutVertexArray,_e,Ce,-1,-1),Pa(this.layoutVertexArray,_e,Ce,1,-1),Pa(this.layoutVertexArray,_e,Ce,1,1),Pa(this.layoutVertexArray,_e,Ce,-1,1),this.indexArray.emplaceBack(Xe,Xe+1,Xe+2),this.indexArray.emplaceBack(Xe,Xe+3,Xe+2),Ie.vertexLength+=4,Ie.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},v)},oi("CircleBucket",Ua,{omit:["layers"]});var hl=new Ro({"circle-sort-key":new rn($e.layout_circle["circle-sort-key"])}),Xl={paint:new Ro({"circle-radius":new rn($e.paint_circle["circle-radius"]),"circle-color":new rn($e.paint_circle["circle-color"]),"circle-blur":new rn($e.paint_circle["circle-blur"]),"circle-opacity":new rn($e.paint_circle["circle-opacity"]),"circle-translate":new Ci($e.paint_circle["circle-translate"]),"circle-translate-anchor":new Ci($e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ci($e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ci($e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rn($e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rn($e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rn($e.paint_circle["circle-stroke-opacity"])}),layout:hl},Ma=typeof Float32Array!="undefined"?Float32Array:Array;function bs(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xs(t,o,u){var v=o[0],y=o[1],x=o[2],A=o[3],B=o[4],te=o[5],_e=o[6],Ce=o[7],Ie=o[8],Xe=o[9],tt=o[10],Mt=o[11],Pt=o[12],qt=o[13],Zt=o[14],pr=o[15],Sr=u[0],Br=u[1],Vr=u[2],fn=u[3];return t[0]=Sr*v+Br*B+Vr*Ie+fn*Pt,t[1]=Sr*y+Br*te+Vr*Xe+fn*qt,t[2]=Sr*x+Br*_e+Vr*tt+fn*Zt,t[3]=Sr*A+Br*Ce+Vr*Mt+fn*pr,t[4]=(Sr=u[4])*v+(Br=u[5])*B+(Vr=u[6])*Ie+(fn=u[7])*Pt,t[5]=Sr*y+Br*te+Vr*Xe+fn*qt,t[6]=Sr*x+Br*_e+Vr*tt+fn*Zt,t[7]=Sr*A+Br*Ce+Vr*Mt+fn*pr,t[8]=(Sr=u[8])*v+(Br=u[9])*B+(Vr=u[10])*Ie+(fn=u[11])*Pt,t[9]=Sr*y+Br*te+Vr*Xe+fn*qt,t[10]=Sr*x+Br*_e+Vr*tt+fn*Zt,t[11]=Sr*A+Br*Ce+Vr*Mt+fn*pr,t[12]=(Sr=u[12])*v+(Br=u[13])*B+(Vr=u[14])*Ie+(fn=u[15])*Pt,t[13]=Sr*y+Br*te+Vr*Xe+fn*qt,t[14]=Sr*x+Br*_e+Vr*tt+fn*Zt,t[15]=Sr*A+Br*Ce+Vr*Mt+fn*pr,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,o=0,u=arguments.length;u--;)o+=t[u]*t[u];return Math.sqrt(o)});var sc,rh=xs;function uc(t,o,u){var v=o[0],y=o[1],x=o[2],A=o[3];return t[0]=u[0]*v+u[4]*y+u[8]*x+u[12]*A,t[1]=u[1]*v+u[5]*y+u[9]*x+u[13]*A,t[2]=u[2]*v+u[6]*y+u[10]*x+u[14]*A,t[3]=u[3]*v+u[7]*y+u[11]*x+u[15]*A,t}sc=new Ma(3),Ma!=Float32Array&&(sc[0]=0,sc[1]=0,sc[2]=0),function(){var t=new Ma(4);Ma!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var Uf=(function(){var t=new Ma(2);Ma!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function o(u){t.call(this,u,Xl)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Ua(u)},o.prototype.queryRadius=function(u){var v=u;return ms("circle-radius",this,v)+ms("circle-stroke-width",this,v)+Yo(this.paint.get("circle-translate"))},o.prototype.queryIntersectsFeature=function(u,v,y,x,A,B,te,_e){for(var Ce=Lu(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),B.angle,te),Ie=this.paint.get("circle-radius").evaluate(v,y)+this.paint.get("circle-stroke-width").evaluate(v,y),Xe=this.paint.get("circle-pitch-alignment")==="map",tt=Xe?Ce:function(Nn,qn){return Nn.map(function(Di){return qc(Di,qn)})}(Ce,_e),Mt=Xe?Ie*te:Ie,Pt=0,qt=x;Pt<qt.length;Pt+=1)for(var Zt=0,pr=qt[Pt];Zt<pr.length;Zt+=1){var Sr=pr[Zt],Br=Xe?Sr:qc(Sr,_e),Vr=Mt,fn=uc([],[Sr.x,Sr.y,0,1],_e);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Vr*=fn[3]/B.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Vr*=B.cameraToCenterDistance/fn[3]),ga(tt,Br,Vr))return!0}return!1},o}(Fs));function qc(t,o){var u=uc([],[t.x,t.y,0,1],o);return new F(u[0]/u[3],u[1]/u[3])}var Fc=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Ua);function Yl(t,o,u,v){var y=o.width,x=o.height;if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==y*x*u)throw new RangeError("mismatched image size")}else v=new Uint8Array(y*x*u);return t.width=y,t.height=x,t.data=v,t}function zf(t,o,u){var v=o.width,y=o.height;if(v!==t.width||y!==t.height){var x=Yl({},{width:v,height:y},u);qh(t,x,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,v),height:Math.min(t.height,y)},u),t.width=v,t.height=y,t.data=x.data}}function qh(t,o,u,v,y,x){if(y.width===0||y.height===0)return o;if(y.width>t.width||y.height>t.height||u.x>t.width-y.width||u.y>t.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>o.width||y.height>o.height||v.x>o.width-y.width||v.y>o.height-y.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=t.data,B=o.data,te=0;te<y.height;te++)for(var _e=((u.y+te)*t.width+u.x)*x,Ce=((v.y+te)*o.width+v.x)*x,Ie=0;Ie<y.width*x;Ie++)B[Ce+Ie]=A[_e+Ie];return o}oi("HeatmapBucket",Fc,{omit:["layers"]});var Qc=function(t,o){Yl(this,t,1,o)};Qc.prototype.resize=function(t){zf(this,t,1)},Qc.prototype.clone=function(){return new Qc({width:this.width,height:this.height},new Uint8Array(this.data))},Qc.copy=function(t,o,u,v,y){qh(t,o,u,v,y,1)};var Au=function(t,o){Yl(this,t,4,o)};Au.prototype.resize=function(t){zf(this,t,4)},Au.prototype.replace=function(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},Au.prototype.clone=function(){return new Au({width:this.width,height:this.height},new Uint8Array(this.data))},Au.copy=function(t,o,u,v,y){qh(t,o,u,v,y,4)},oi("AlphaImage",Qc),oi("RGBAImage",Au);var Qh={paint:new Ro({"heatmap-radius":new rn($e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rn($e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ci($e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fu($e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ci($e.paint_heatmap["heatmap-opacity"])})};function nh(t){var o={},u=t.resolution||256,v=t.clips?t.clips.length:1,y=t.image||new Au({width:u,height:v}),x=function(Mt,Pt,qt){o[t.evaluationKey]=qt;var Zt=t.expression.evaluate(o);y.data[Mt+Pt+0]=Math.floor(255*Zt.r/Zt.a),y.data[Mt+Pt+1]=Math.floor(255*Zt.g/Zt.a),y.data[Mt+Pt+2]=Math.floor(255*Zt.b/Zt.a),y.data[Mt+Pt+3]=Math.floor(255*Zt.a)};if(t.clips)for(var A=0,B=0;A<v;++A,B+=4*u)for(var te=0,_e=0;te<u;te++,_e+=4){var Ce=te/(u-1),Ie=t.clips[A];x(B,_e,Ie.start*(1-Ce)+Ie.end*Ce)}else for(var Xe=0,tt=0;Xe<u;Xe++,tt+=4)x(0,tt,Xe/(u-1));return y}var ih=function(t){function o(u){t.call(this,u,Qh),this._updateColorRamp()}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Fc(u)},o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="heatmap-color"&&this._updateColorRamp()},o.prototype._updateColorRamp=function(){this.colorRamp=nh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},o.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},o}(Fs),Vp={paint:new Ro({"hillshade-illumination-direction":new Ci($e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ci($e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ci($e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ci($e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ci($e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ci($e.paint_hillshade["hillshade-accent-color"])})},Jh=function(t){function o(u){t.call(this,u,Vp)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},o}(Fs),Ed=No([{name:"a_pos",components:2,type:"Int16"}],4).members,Zf=yh,np=yh;function yh(t,o,u){u=u||2;var v,y,x,A,B,te,_e,Ce=o&&o.length,Ie=Ce?o[0]*u:t.length,Xe=ed(t,0,Ie,u,!0),tt=[];if(!Xe||Xe.next===Xe.prev)return tt;if(Ce&&(Xe=function(Pt,qt,Zt,pr){var Sr,Br,Vr,fn=[];for(Sr=0,Br=qt.length;Sr<Br;Sr++)(Vr=ed(Pt,qt[Sr]*pr,Sr<Br-1?qt[Sr+1]*pr:Pt.length,pr,!1))===Vr.next&&(Vr.steiner=!0),fn.push(_t(Vr));for(fn.sort(de),Sr=0;Sr<fn.length;Sr++)Oe(fn[Sr],Zt),Zt=Jc(Zt,Zt.next);return Zt}(t,o,Xe,u)),t.length>80*u){v=x=t[0],y=A=t[1];for(var Mt=u;Mt<Ie;Mt+=u)(B=t[Mt])<v&&(v=B),(te=t[Mt+1])<y&&(y=te),B>x&&(x=B),te>A&&(A=te);_e=(_e=Math.max(x-v,A-y))!==0?1/_e:0}return ah(Xe,tt,u,v,y,_e),tt}function ed(t,o,u,v,y){var x,A;if(y===co(t,o,u,v)>0)for(x=o;x<u;x+=v)A=ya(x,t[x],t[x+1],A);else for(x=u-v;x>=o;x-=v)A=ya(x,t[x],t[x+1],A);return A&&Un(A,A.next)&&(ia(A),A=A.next),A}function Jc(t,o){if(!t)return t;o||(o=t);var u,v=t;do if(u=!1,v.steiner||!Un(v,v.next)&&$r(v.prev,v,v.next)!==0)v=v.next;else{if(ia(v),(v=o=v.prev)===v.next)break;u=!0}while(u||v!==o);return o}function ah(t,o,u,v,y,x,A){if(t){!A&&x&&function(Ce,Ie,Xe,tt){var Mt=Ce;do Mt.z===null&&(Mt.z=Lt(Mt.x,Mt.y,Ie,Xe,tt)),Mt.prevZ=Mt.prev,Mt.nextZ=Mt.next,Mt=Mt.next;while(Mt!==Ce);Mt.prevZ.nextZ=null,Mt.prevZ=null,function(Pt){var qt,Zt,pr,Sr,Br,Vr,fn,Nn,qn=1;do{for(Zt=Pt,Pt=null,Br=null,Vr=0;Zt;){for(Vr++,pr=Zt,fn=0,qt=0;qt<qn&&(fn++,pr=pr.nextZ);qt++);for(Nn=qn;fn>0||Nn>0&&pr;)fn!==0&&(Nn===0||!pr||Zt.z<=pr.z)?(Sr=Zt,Zt=Zt.nextZ,fn--):(Sr=pr,pr=pr.nextZ,Nn--),Br?Br.nextZ=Sr:Pt=Sr,Sr.prevZ=Br,Br=Sr;Zt=pr}Br.nextZ=null,qn*=2}while(Vr>1)}(Mt)}(t,v,y,x);for(var B,te,_e=t;t.prev!==t.next;)if(B=t.prev,te=t.next,x?Ke(t,v,y,x):T(t))o.push(B.i/u),o.push(t.i/u),o.push(te.i/u),ia(t),t=te.next,_e=te.next;else if((t=te)===_e){A?A===1?ah(t=he(Jc(t),o,u),o,u,v,y,x,2):A===2&&re(t,o,u,v,y,x):ah(Jc(t),o,u,v,y,x,1);break}}}function T(t){var o=t.prev,u=t,v=t.next;if($r(o,u,v)>=0)return!1;for(var y=t.next.next;y!==t.prev;){if(jt(o.x,o.y,u.x,u.y,v.x,v.y,y.x,y.y)&&$r(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function Ke(t,o,u,v){var y=t.prev,x=t,A=t.next;if($r(y,x,A)>=0)return!1;for(var B=y.x>x.x?y.x>A.x?y.x:A.x:x.x>A.x?x.x:A.x,te=y.y>x.y?y.y>A.y?y.y:A.y:x.y>A.y?x.y:A.y,_e=Lt(y.x<x.x?y.x<A.x?y.x:A.x:x.x<A.x?x.x:A.x,y.y<x.y?y.y<A.y?y.y:A.y:x.y<A.y?x.y:A.y,o,u,v),Ce=Lt(B,te,o,u,v),Ie=t.prevZ,Xe=t.nextZ;Ie&&Ie.z>=_e&&Xe&&Xe.z<=Ce;){if(Ie!==t.prev&&Ie!==t.next&&jt(y.x,y.y,x.x,x.y,A.x,A.y,Ie.x,Ie.y)&&$r(Ie.prev,Ie,Ie.next)>=0||(Ie=Ie.prevZ,Xe!==t.prev&&Xe!==t.next&&jt(y.x,y.y,x.x,x.y,A.x,A.y,Xe.x,Xe.y)&&$r(Xe.prev,Xe,Xe.next)>=0))return!1;Xe=Xe.nextZ}for(;Ie&&Ie.z>=_e;){if(Ie!==t.prev&&Ie!==t.next&&jt(y.x,y.y,x.x,x.y,A.x,A.y,Ie.x,Ie.y)&&$r(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.prevZ}for(;Xe&&Xe.z<=Ce;){if(Xe!==t.prev&&Xe!==t.next&&jt(y.x,y.y,x.x,x.y,A.x,A.y,Xe.x,Xe.y)&&$r(Xe.prev,Xe,Xe.next)>=0)return!1;Xe=Xe.nextZ}return!0}function he(t,o,u){var v=t;do{var y=v.prev,x=v.next.next;!Un(y,x)&&Hn(y,v,v.next,x)&&Jn(y,x)&&Jn(x,y)&&(o.push(y.i/u),o.push(v.i/u),o.push(x.i/u),ia(v),ia(v.next),v=t=x),v=v.next}while(v!==t);return Jc(v)}function re(t,o,u,v,y,x){var A=t;do{for(var B=A.next.next;B!==A.prev;){if(A.i!==B.i&&Fr(A,B)){var te=Ei(A,B);return A=Jc(A,A.next),te=Jc(te,te.next),ah(A,o,u,v,y,x),void ah(te,o,u,v,y,x)}B=B.next}A=A.next}while(A!==t)}function de(t,o){return t.x-o.x}function Oe(t,o){if(o=function(v,y){var x,A=y,B=v.x,te=v.y,_e=-1/0;do{if(te<=A.y&&te>=A.next.y&&A.next.y!==A.y){var Ce=A.x+(te-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(Ce<=B&&Ce>_e){if(_e=Ce,Ce===B){if(te===A.y)return A;if(te===A.next.y)return A.next}x=A.x<A.next.x?A:A.next}}A=A.next}while(A!==y);if(!x)return null;if(B===_e)return x;var Ie,Xe=x,tt=x.x,Mt=x.y,Pt=1/0;A=x;do B>=A.x&&A.x>=tt&&B!==A.x&&jt(te<Mt?B:_e,te,tt,Mt,te<Mt?_e:B,te,A.x,A.y)&&(Ie=Math.abs(te-A.y)/(B-A.x),Jn(A,v)&&(Ie<Pt||Ie===Pt&&(A.x>x.x||A.x===x.x&&dt(x,A)))&&(x=A,Pt=Ie)),A=A.next;while(A!==Xe);return x}(t,o)){var u=Ei(o,t);Jc(o,o.next),Jc(u,u.next)}}function dt(t,o){return $r(t.prev,t,o.prev)<0&&$r(o.next,t,t.next)<0}function Lt(t,o,u,v,y){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*y)|t<<8))|t<<4))|t<<2))|t<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-v)*y)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function _t(t){var o=t,u=t;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==t);return u}function jt(t,o,u,v,y,x,A,B){return(y-A)*(o-B)-(t-A)*(x-B)>=0&&(t-A)*(v-B)-(u-A)*(o-B)>=0&&(u-A)*(x-B)-(y-A)*(v-B)>=0}function Fr(t,o){return t.next.i!==o.i&&t.prev.i!==o.i&&!function(u,v){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==v.i&&y.next.i!==v.i&&Hn(y,y.next,u,v))return!0;y=y.next}while(y!==u);return!1}(t,o)&&(Jn(t,o)&&Jn(o,t)&&function(u,v){var y=u,x=!1,A=(u.x+v.x)/2,B=(u.y+v.y)/2;do y.y>B!=y.next.y>B&&y.next.y!==y.y&&A<(y.next.x-y.x)*(B-y.y)/(y.next.y-y.y)+y.x&&(x=!x),y=y.next;while(y!==u);return x}(t,o)&&($r(t.prev,t,o.prev)||$r(t,o.prev,o))||Un(t,o)&&$r(t.prev,t,t.next)>0&&$r(o.prev,o,o.next)>0)}function $r(t,o,u){return(o.y-t.y)*(u.x-o.x)-(o.x-t.x)*(u.y-o.y)}function Un(t,o){return t.x===o.x&&t.y===o.y}function Hn(t,o,u,v){var y=Pi($r(t,o,u)),x=Pi($r(t,o,v)),A=Pi($r(u,v,t)),B=Pi($r(u,v,o));return y!==x&&A!==B||!(y!==0||!_i(t,u,o))||!(x!==0||!_i(t,v,o))||!(A!==0||!_i(u,t,v))||!(B!==0||!_i(u,o,v))}function _i(t,o,u){return o.x<=Math.max(t.x,u.x)&&o.x>=Math.min(t.x,u.x)&&o.y<=Math.max(t.y,u.y)&&o.y>=Math.min(t.y,u.y)}function Pi(t){return t>0?1:t<0?-1:0}function Jn(t,o){return $r(t.prev,t,t.next)<0?$r(t,o,t.next)>=0&&$r(t,t.prev,o)>=0:$r(t,o,t.prev)<0||$r(t,t.next,o)<0}function Ei(t,o){var u=new zo(t.i,t.x,t.y),v=new zo(o.i,o.x,o.y),y=t.next,x=o.prev;return t.next=o,o.prev=t,u.next=y,y.prev=u,v.next=u,u.prev=v,x.next=v,v.prev=x,v}function ya(t,o,u,v){var y=new zo(t,o,u);return v?(y.next=v.next,y.prev=v,v.next.prev=y,v.next=y):(y.prev=y,y.next=y),y}function ia(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function zo(t,o,u){this.i=t,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function co(t,o,u,v){for(var y=0,x=o,A=u-v;x<u;x+=v)y+=(t[A]-t[x])*(t[x+1]+t[A+1]),A=x;return y}function Eo(t,o,u,v,y){(function x(A,B,te,_e,Ce){for(;_e>te;){if(_e-te>600){var Ie=_e-te+1,Xe=B-te+1,tt=Math.log(Ie),Mt=.5*Math.exp(2*tt/3),Pt=.5*Math.sqrt(tt*Mt*(Ie-Mt)/Ie)*(Xe-Ie/2<0?-1:1);x(A,B,Math.max(te,Math.floor(B-Xe*Mt/Ie+Pt)),Math.min(_e,Math.floor(B+(Ie-Xe)*Mt/Ie+Pt)),Ce)}var qt=A[B],Zt=te,pr=_e;for(_a(A,te,B),Ce(A[_e],qt)>0&&_a(A,te,_e);Zt<pr;){for(_a(A,Zt,pr),Zt++,pr--;Ce(A[Zt],qt)<0;)Zt++;for(;Ce(A[pr],qt)>0;)pr--}Ce(A[te],qt)===0?_a(A,te,pr):_a(A,++pr,_e),pr<=B&&(te=pr+1),B<=pr&&(_e=pr-1)}})(t,o,u||0,v||t.length-1,y||Da)}function _a(t,o,u){var v=t[o];t[o]=t[u],t[u]=v}function Da(t,o){return t<o?-1:t>o?1:0}function Io(t,o){var u=t.length;if(u<=1)return[t];for(var v,y,x=[],A=0;A<u;A++){var B=Et(t[A]);B!==0&&(t[A].area=Math.abs(B),y===void 0&&(y=B<0),y===B<0?(v&&x.push(v),v=[t[A]]):v.push(t[A]))}if(v&&x.push(v),o>1)for(var te=0;te<x.length;te++)x[te].length<=o||(Eo(x[te],o,1,x[te].length-1,Zo),x[te]=x[te].slice(0,o));return x}function Zo(t,o){return o.area-t.area}function ts(t,o,u){for(var v=u.patternDependencies,y=!1,x=0,A=o;x<A.length;x+=1){var B=A[x].paint.get(t+"-pattern");B.isConstant()||(y=!0);var te=B.constantOr(null);te&&(y=!0,v[te.to]=!0,v[te.from]=!0)}return y}function Oo(t,o,u,v,y){for(var x=y.patternDependencies,A=0,B=o;A<B.length;A+=1){var te=B[A],_e=te.paint.get(t+"-pattern").value;if(_e.kind!=="constant"){var Ce=_e.evaluate({zoom:v-1},u,{},y.availableImages),Ie=_e.evaluate({zoom:v},u,{},y.availableImages),Xe=_e.evaluate({zoom:v+1},u,{},y.availableImages);Ie=Ie&&Ie.name?Ie.name:Ie,Xe=Xe&&Xe.name?Xe.name:Xe,x[Ce=Ce&&Ce.name?Ce.name:Ce]=!0,x[Ie]=!0,x[Xe]=!0,u.patterns[te.id]={min:Ce,mid:Ie,max:Xe}}}return u}yh.deviation=function(t,o,u,v){var y=o&&o.length,x=Math.abs(co(t,0,y?o[0]*u:t.length,u));if(y)for(var A=0,B=o.length;A<B;A++)x-=Math.abs(co(t,o[A]*u,A<B-1?o[A+1]*u:t.length,u));var te=0;for(A=0;A<v.length;A+=3){var _e=v[A]*u,Ce=v[A+1]*u,Ie=v[A+2]*u;te+=Math.abs((t[_e]-t[Ie])*(t[Ce+1]-t[_e+1])-(t[_e]-t[Ce])*(t[Ie+1]-t[_e+1]))}return x===0&&te===0?0:Math.abs((te-x)/x)},yh.flatten=function(t){for(var o=t[0][0].length,u={vertices:[],holes:[],dimensions:o},v=0,y=0;y<t.length;y++){for(var x=0;x<t[y].length;x++)for(var A=0;A<o;A++)u.vertices.push(t[y][x][A]);y>0&&u.holes.push(v+=t[y-1].length)}return u},Zf.default=np;var oo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ol,this.indexArray=new Ii,this.indexArray2=new oc,this.programConfigurations=new Jr(t.layers,t.zoom),this.segments=new ot,this.segments2=new ot,this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id})};oo.prototype.populate=function(t,o,u){this.hasPattern=ts("fill",this.layers,o);for(var v=this.layers[0].layout.get("fill-sort-key"),y=[],x=0,A=t;x<A.length;x+=1){var B=A[x],te=B.feature,_e=B.id,Ce=B.index,Ie=B.sourceLayerIndex,Xe=this.layers[0]._featureFilter.needGeometry,tt=Ni(te,Xe);if(this.layers[0]._featureFilter.filter(new ea(this.zoom),tt,u)){var Mt=v?v.evaluate(tt,{},u,o.availableImages):void 0,Pt={id:_e,properties:te.properties,type:te.type,sourceLayerIndex:Ie,index:Ce,geometry:Xe?tt.geometry:xi(te),patterns:{},sortKey:Mt};y.push(Pt)}}v&&y.sort(function(Nn,qn){return Nn.sortKey-qn.sortKey});for(var qt=0,Zt=y;qt<Zt.length;qt+=1){var pr=Zt[qt],Sr=pr.geometry,Br=pr.index,Vr=pr.sourceLayerIndex;if(this.hasPattern){var fn=Oo("fill",this.layers,pr,this.zoom,o);this.patternFeatures.push(fn)}else this.addFeature(pr,Sr,Br,u,{});o.featureIndex.insert(t[Br].feature,Sr,Br,Vr,this.index)}},oo.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},oo.prototype.addFeatures=function(t,o,u){for(var v=0,y=this.patternFeatures;v<y.length;v+=1){var x=y[v];this.addFeature(x,x.geometry,x.index,o,u)}},oo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},oo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},oo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ed),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},oo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},oo.prototype.addFeature=function(t,o,u,v,y){for(var x=0,A=Io(o,500);x<A.length;x+=1){for(var B=A[x],te=0,_e=0,Ce=B;_e<Ce.length;_e+=1)te+=Ce[_e].length;for(var Ie=this.segments.prepareSegment(te,this.layoutVertexArray,this.indexArray),Xe=Ie.vertexLength,tt=[],Mt=[],Pt=0,qt=B;Pt<qt.length;Pt+=1){var Zt=qt[Pt];if(Zt.length!==0){Zt!==B[0]&&Mt.push(tt.length/2);var pr=this.segments2.prepareSegment(Zt.length,this.layoutVertexArray,this.indexArray2),Sr=pr.vertexLength;this.layoutVertexArray.emplaceBack(Zt[0].x,Zt[0].y),this.indexArray2.emplaceBack(Sr+Zt.length-1,Sr),tt.push(Zt[0].x),tt.push(Zt[0].y);for(var Br=1;Br<Zt.length;Br++)this.layoutVertexArray.emplaceBack(Zt[Br].x,Zt[Br].y),this.indexArray2.emplaceBack(Sr+Br-1,Sr+Br),tt.push(Zt[Br].x),tt.push(Zt[Br].y);pr.vertexLength+=Zt.length,pr.primitiveLength+=Zt.length}}for(var Vr=Zf(tt,Mt),fn=0;fn<Vr.length;fn+=3)this.indexArray.emplaceBack(Xe+Vr[fn],Xe+Vr[fn+1],Xe+Vr[fn+2]);Ie.vertexLength+=te,Ie.primitiveLength+=Vr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,y,v)},oi("FillBucket",oo,{omit:["layers","patternFeatures"]});var fo=new Ro({"fill-sort-key":new rn($e.layout_fill["fill-sort-key"])}),Dl={paint:new Ro({"fill-antialias":new Ci($e.paint_fill["fill-antialias"]),"fill-opacity":new rn($e.paint_fill["fill-opacity"]),"fill-color":new rn($e.paint_fill["fill-color"]),"fill-outline-color":new rn($e.paint_fill["fill-outline-color"]),"fill-translate":new Ci($e.paint_fill["fill-translate"]),"fill-translate-anchor":new Ci($e.paint_fill["fill-translate-anchor"]),"fill-pattern":new cu($e.paint_fill["fill-pattern"])}),layout:fo},Kl=function(t){function o(u){t.call(this,u,Dl)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.recalculate=function(u,v){t.prototype.recalculate.call(this,u,v);var y=this.paint._values["fill-outline-color"];y.value.kind==="constant"&&y.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},o.prototype.createBucket=function(u){return new oo(u)},o.prototype.queryRadius=function(){return Yo(this.paint.get("fill-translate"))},o.prototype.queryIntersectsFeature=function(u,v,y,x,A,B,te){return Xi(Lu(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),B.angle,te),x)},o.prototype.isTileClipped=function(){return!0},o}(Fs),Af=No([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Ac=ef;function ef(t,o,u,v,y){this.properties={},this.extent=u,this.type=0,this._pbf=t,this._geometry=-1,this._keys=v,this._values=y,t.readFields(td,this,o)}function td(t,o,u){t==1?o.id=u.readVarint():t==2?function(v,y){for(var x=v.readVarint()+v.pos;v.pos<x;){var A=y._keys[v.readVarint()],B=y._values[v.readVarint()];y.properties[A]=B}}(u,o):t==3?o.type=u.readVarint():t==4&&(o._geometry=u.pos)}function Nc(t){for(var o,u,v=0,y=0,x=t.length,A=x-1;y<x;A=y++)v+=((u=t[A]).x-(o=t[y]).x)*(o.y+u.y);return v}ef.types=["Unknown","Point","LineString","Polygon"],ef.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var o,u=t.readVarint()+t.pos,v=1,y=0,x=0,A=0,B=[];t.pos<u;){if(y<=0){var te=t.readVarint();v=7&te,y=te>>3}if(y--,v===1||v===2)x+=t.readSVarint(),A+=t.readSVarint(),v===1&&(o&&B.push(o),o=[]),o.push(new F(x,A));else{if(v!==7)throw new Error("unknown command "+v);o&&o.push(o[0].clone())}}return o&&B.push(o),B},ef.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var o=t.readVarint()+t.pos,u=1,v=0,y=0,x=0,A=1/0,B=-1/0,te=1/0,_e=-1/0;t.pos<o;){if(v<=0){var Ce=t.readVarint();u=7&Ce,v=Ce>>3}if(v--,u===1||u===2)(y+=t.readSVarint())<A&&(A=y),y>B&&(B=y),(x+=t.readSVarint())<te&&(te=x),x>_e&&(_e=x);else if(u!==7)throw new Error("unknown command "+u)}return[A,te,B,_e]},ef.prototype.toGeoJSON=function(t,o,u){var v,y,x=this.extent*Math.pow(2,u),A=this.extent*t,B=this.extent*o,te=this.loadGeometry(),_e=ef.types[this.type];function Ce(tt){for(var Mt=0;Mt<tt.length;Mt++){var Pt=tt[Mt];tt[Mt]=[360*(Pt.x+A)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(Pt.y+B)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var Ie=[];for(v=0;v<te.length;v++)Ie[v]=te[v][0];Ce(te=Ie);break;case 2:for(v=0;v<te.length;v++)Ce(te[v]);break;case 3:for(te=function(tt){var Mt=tt.length;if(Mt<=1)return[tt];for(var Pt,qt,Zt=[],pr=0;pr<Mt;pr++){var Sr=Nc(tt[pr]);Sr!==0&&(qt===void 0&&(qt=Sr<0),qt===Sr<0?(Pt&&Zt.push(Pt),Pt=[tt[pr]]):Pt.push(tt[pr]))}return Pt&&Zt.push(Pt),Zt}(te),v=0;v<te.length;v++)for(y=0;y<te[v].length;y++)Ce(te[v][y])}te.length===1?te=te[0]:_e="Multi"+_e;var Xe={type:"Feature",geometry:{type:_e,coordinates:te},properties:this.properties};return"id"in this&&(Xe.id=this.id),Xe};var rd=Cf;function Cf(t,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Cc,this,o),this.length=this._features.length}function Cc(t,o,u){t===15?o.version=u.readVarint():t===1?o.name=u.readString():t===5?o.extent=u.readVarint():t===2?o._features.push(u.pos):t===3?o._keys.push(u.readString()):t===4&&o._values.push(function(v){for(var y=null,x=v.readVarint()+v.pos;v.pos<x;){var A=v.readVarint()>>3;y=A===1?v.readString():A===2?v.readFloat():A===3?v.readDouble():A===4?v.readVarint64():A===5?v.readVarint():A===6?v.readSVarint():A===7?v.readBoolean():null}return y}(u))}function ip(t,o,u){if(t===3){var v=new rd(u,u.readVarint()+u.pos);v.length&&(o[v.name]=v)}}Cf.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var o=this._pbf.readVarint()+this._pbf.pos;return new Ac(this._pbf,o,this.extent,this._keys,this._values)};var jf={VectorTile:function(t,o){this.layers=t.readFields(ip,{},o)},VectorTileFeature:Ac,VectorTileLayer:rd},kh=jf.VectorTileFeature.types,nd=Math.pow(2,13);function Xu(t,o,u,v,y,x,A,B){t.emplaceBack(o,u,2*Math.floor(v*nd)+A,y*nd*2,x*nd*2,Math.round(B))}var Bu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ul,this.indexArray=new Ii,this.programConfigurations=new Jr(t.layers,t.zoom),this.segments=new ot,this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id})};function Ms(t,o){return t.x===o.x&&(t.x<0||t.x>8192)||t.y===o.y&&(t.y<0||t.y>8192)}Bu.prototype.populate=function(t,o,u){this.features=[],this.hasPattern=ts("fill-extrusion",this.layers,o);for(var v=0,y=t;v<y.length;v+=1){var x=y[v],A=x.feature,B=x.id,te=x.index,_e=x.sourceLayerIndex,Ce=this.layers[0]._featureFilter.needGeometry,Ie=Ni(A,Ce);if(this.layers[0]._featureFilter.filter(new ea(this.zoom),Ie,u)){var Xe={id:B,sourceLayerIndex:_e,index:te,geometry:Ce?Ie.geometry:xi(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(Oo("fill-extrusion",this.layers,Xe,this.zoom,o)):this.addFeature(Xe,Xe.geometry,te,u,{}),o.featureIndex.insert(A,Xe.geometry,te,_e,this.index,!0)}}},Bu.prototype.addFeatures=function(t,o,u){for(var v=0,y=this.features;v<y.length;v+=1){var x=y[v];this.addFeature(x,x.geometry,x.index,o,u)}},Bu.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Bu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Bu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Bu.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Af),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Bu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Bu.prototype.addFeature=function(t,o,u,v,y){for(var x=0,A=Io(o,500);x<A.length;x+=1){for(var B=A[x],te=0,_e=0,Ce=B;_e<Ce.length;_e+=1)te+=Ce[_e].length;for(var Ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Xe=0,tt=B;Xe<tt.length;Xe+=1){var Mt=tt[Xe];if(Mt.length!==0&&!((Ji=Mt).every(function(ua){return ua.x<0})||Ji.every(function(ua){return ua.x>8192})||Ji.every(function(ua){return ua.y<0})||Ji.every(function(ua){return ua.y>8192})))for(var Pt=0,qt=0;qt<Mt.length;qt++){var Zt=Mt[qt];if(qt>=1){var pr=Mt[qt-1];if(!Ms(Zt,pr)){Ie.vertexLength+4>ot.MAX_VERTEX_ARRAY_LENGTH&&(Ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Sr=Zt.sub(pr)._perp()._unit(),Br=pr.dist(Zt);Pt+Br>32768&&(Pt=0),Xu(this.layoutVertexArray,Zt.x,Zt.y,Sr.x,Sr.y,0,0,Pt),Xu(this.layoutVertexArray,Zt.x,Zt.y,Sr.x,Sr.y,0,1,Pt),Xu(this.layoutVertexArray,pr.x,pr.y,Sr.x,Sr.y,0,0,Pt+=Br),Xu(this.layoutVertexArray,pr.x,pr.y,Sr.x,Sr.y,0,1,Pt);var Vr=Ie.vertexLength;this.indexArray.emplaceBack(Vr,Vr+2,Vr+1),this.indexArray.emplaceBack(Vr+1,Vr+2,Vr+3),Ie.vertexLength+=4,Ie.primitiveLength+=2}}}}if(Ie.vertexLength+te>ot.MAX_VERTEX_ARRAY_LENGTH&&(Ie=this.segments.prepareSegment(te,this.layoutVertexArray,this.indexArray)),kh[t.type]==="Polygon"){for(var fn=[],Nn=[],qn=Ie.vertexLength,Di=0,ci=B;Di<ci.length;Di+=1){var ki=ci[Di];if(ki.length!==0){ki!==B[0]&&Nn.push(fn.length/2);for(var hi=0;hi<ki.length;hi++){var ma=ki[hi];Xu(this.layoutVertexArray,ma.x,ma.y,0,0,1,1,0),fn.push(ma.x),fn.push(ma.y)}}}for(var Qi=Zf(fn,Nn),Ti=0;Ti<Qi.length;Ti+=3)this.indexArray.emplaceBack(qn+Qi[Ti],qn+Qi[Ti+2],qn+Qi[Ti+1]);Ie.primitiveLength+=Qi.length/3,Ie.vertexLength+=te}}var Ji;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,y,v)},oi("FillExtrusionBucket",Bu,{omit:["layers","features"]});var ql={paint:new Ro({"fill-extrusion-opacity":new Ci($e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rn($e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ci($e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ci($e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cu($e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rn($e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rn($e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ci($e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Sd=function(t){function o(u){t.call(this,u,ql)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.createBucket=function(u){return new Bu(u)},o.prototype.queryRadius=function(){return Yo(this.paint.get("fill-extrusion-translate"))},o.prototype.is3D=function(){return!0},o.prototype.queryIntersectsFeature=function(u,v,y,x,A,B,te,_e){var Ce=Lu(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),B.angle,te),Ie=this.paint.get("fill-extrusion-height").evaluate(v,y),Xe=this.paint.get("fill-extrusion-base").evaluate(v,y),tt=function(Pt,qt,Zt,pr){for(var Sr=[],Br=0,Vr=Pt;Br<Vr.length;Br+=1){var fn=Vr[Br],Nn=[fn.x,fn.y,0,1];uc(Nn,Nn,qt),Sr.push(new F(Nn[0]/Nn[3],Nn[1]/Nn[3]))}return Sr}(Ce,_e),Mt=function(Pt,qt,Zt,pr){for(var Sr=[],Br=[],Vr=pr[8]*qt,fn=pr[9]*qt,Nn=pr[10]*qt,qn=pr[11]*qt,Di=pr[8]*Zt,ci=pr[9]*Zt,ki=pr[10]*Zt,hi=pr[11]*Zt,ma=0,Qi=Pt;ma<Qi.length;ma+=1){for(var Ti=[],Ji=[],ua=0,$a=Qi[ma];ua<$a.length;ua+=1){var ji=$a[ua],no=ji.x,Bo=ji.y,fs=pr[0]*no+pr[4]*Bo+pr[12],hs=pr[1]*no+pr[5]*Bo+pr[13],ns=pr[2]*no+pr[6]*Bo+pr[14],is=pr[3]*no+pr[7]*Bo+pr[15],Hs=ns+Nn,vu=is+qn,wu=fs+Di,Ts=hs+ci,dl=ns+ki,Ps=is+hi,Ru=new F((fs+Vr)/vu,(hs+fn)/vu);Ru.z=Hs/vu,Ti.push(Ru);var Ba=new F(wu/Ps,Ts/Ps);Ba.z=dl/Ps,Ji.push(Ba)}Sr.push(Ti),Br.push(Ji)}return[Sr,Br]}(x,Xe,Ie,_e);return function(Pt,qt,Zt){var pr=1/0;Xi(Zt,qt)&&(pr=Td(Zt,qt[0]));for(var Sr=0;Sr<qt.length;Sr++)for(var Br=qt[Sr],Vr=Pt[Sr],fn=0;fn<Br.length-1;fn++){var Nn=Br[fn],qn=[Nn,Br[fn+1],Vr[fn+1],Vr[fn],Nn];Mo(Zt,qn)&&(pr=Math.min(pr,Td(Zt,qn)))}return pr!==1/0&&pr}(Mt[0],Mt[1],tt)},o}(Fs);function _h(t,o){return t.x*o.x+t.y*o.y}function Td(t,o){if(t.length===1){for(var u,v=0,y=o[v++];!u||y.equals(u);)if(!(u=o[v++]))return 1/0;for(;v<o.length;v++){var x=o[v],A=t[0],B=u.sub(y),te=x.sub(y),_e=A.sub(y),Ce=_h(B,B),Ie=_h(B,te),Xe=_h(te,te),tt=_h(_e,B),Mt=_h(_e,te),Pt=Ce*Xe-Ie*Ie,qt=(Xe*tt-Ie*Mt)/Pt,Zt=(Ce*Mt-Ie*tt)/Pt,pr=y.z*(1-qt-Zt)+u.z*qt+x.z*Zt;if(isFinite(pr))return pr}return 1/0}for(var Sr=1/0,Br=0,Vr=o;Br<Vr.length;Br+=1)Sr=Math.min(Sr,Vr[Br].z);return Sr}var ap=No([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Hp=No([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,op=jf.VectorTileFeature.types,$p=Math.cos(Math.PI/180*37.5),sp=Math.pow(2,14)/.5,Yu=function(t){var o=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){o.gradients[u.id]={}}),this.layoutVertexArray=new hu,this.layoutVertexArray2=new Tc,this.indexArray=new Ii,this.programConfigurations=new Jr(t.layers,t.zoom),this.segments=new ot,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Yu.prototype.populate=function(t,o,u){this.hasPattern=ts("line",this.layers,o);for(var v=this.layers[0].layout.get("line-sort-key"),y=[],x=0,A=t;x<A.length;x+=1){var B=A[x],te=B.feature,_e=B.id,Ce=B.index,Ie=B.sourceLayerIndex,Xe=this.layers[0]._featureFilter.needGeometry,tt=Ni(te,Xe);if(this.layers[0]._featureFilter.filter(new ea(this.zoom),tt,u)){var Mt=v?v.evaluate(tt,{},u):void 0,Pt={id:_e,properties:te.properties,type:te.type,sourceLayerIndex:Ie,index:Ce,geometry:Xe?tt.geometry:xi(te),patterns:{},sortKey:Mt};y.push(Pt)}}v&&y.sort(function(Nn,qn){return Nn.sortKey-qn.sortKey});for(var qt=0,Zt=y;qt<Zt.length;qt+=1){var pr=Zt[qt],Sr=pr.geometry,Br=pr.index,Vr=pr.sourceLayerIndex;if(this.hasPattern){var fn=Oo("line",this.layers,pr,this.zoom,o);this.patternFeatures.push(fn)}else this.addFeature(pr,Sr,Br,u,{});o.featureIndex.insert(t[Br].feature,Sr,Br,Vr,this.index)}},Yu.prototype.update=function(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)},Yu.prototype.addFeatures=function(t,o,u){for(var v=0,y=this.patternFeatures;v<y.length;v+=1){var x=y[v];this.addFeature(x,x.geometry,x.index,o,u)}},Yu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Yu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Yu.prototype.upload=function(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Hp)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ap),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Yu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Yu.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},Yu.prototype.addFeature=function(t,o,u,v,y){var x=this.layers[0].layout,A=x.get("line-join").evaluate(t,{}),B=x.get("line-cap"),te=x.get("line-miter-limit"),_e=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var Ce=0,Ie=o;Ce<Ie.length;Ce+=1)this.addLine(Ie[Ce],t,A,B,te,_e);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,y,v)},Yu.prototype.addLine=function(t,o,u,v,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<t.length-1;A++)this.totalDistance+=t[A].dist(t[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var B=op[o.type]==="Polygon",te=t.length;te>=2&&t[te-1].equals(t[te-2]);)te--;for(var _e=0;_e<te-1&&t[_e].equals(t[_e+1]);)_e++;if(!(te<(B?3:2))){u==="bevel"&&(y=1.05);var Ce,Ie=this.overscaling<=16?122880/(512*this.overscaling):0,Xe=this.segments.prepareSegment(10*te,this.layoutVertexArray,this.indexArray),tt=void 0,Mt=void 0,Pt=void 0,qt=void 0;this.e1=this.e2=-1,B&&(qt=t[_e].sub(Ce=t[te-2])._unit()._perp());for(var Zt=_e;Zt<te;Zt++)if(!(Mt=Zt===te-1?B?t[_e+1]:void 0:t[Zt+1])||!t[Zt].equals(Mt)){qt&&(Pt=qt),Ce&&(tt=Ce),Ce=t[Zt],qt=Mt?Mt.sub(Ce)._unit()._perp():Pt;var pr=(Pt=Pt||qt).add(qt);pr.x===0&&pr.y===0||pr._unit();var Sr=Pt.x*qt.x+Pt.y*qt.y,Br=pr.x*qt.x+pr.y*qt.y,Vr=Br!==0?1/Br:1/0,fn=2*Math.sqrt(2-2*Br),Nn=Br<$p&&tt&&Mt,qn=Pt.x*qt.y-Pt.y*qt.x>0;if(Nn&&Zt>_e){var Di=Ce.dist(tt);if(Di>2*Ie){var ci=Ce.sub(Ce.sub(tt)._mult(Ie/Di)._round());this.updateDistance(tt,ci),this.addCurrentVertex(ci,Pt,0,0,Xe),tt=ci}}var ki=tt&&Mt,hi=ki?u:B?"butt":v;if(ki&&hi==="round"&&(Vr<x?hi="miter":Vr<=2&&(hi="fakeround")),hi==="miter"&&Vr>y&&(hi="bevel"),hi==="bevel"&&(Vr>2&&(hi="flipbevel"),Vr<y&&(hi="miter")),tt&&this.updateDistance(tt,Ce),hi==="miter")pr._mult(Vr),this.addCurrentVertex(Ce,pr,0,0,Xe);else if(hi==="flipbevel"){if(Vr>100)pr=qt.mult(-1);else{var ma=Vr*Pt.add(qt).mag()/Pt.sub(qt).mag();pr._perp()._mult(ma*(qn?-1:1))}this.addCurrentVertex(Ce,pr,0,0,Xe),this.addCurrentVertex(Ce,pr.mult(-1),0,0,Xe)}else if(hi==="bevel"||hi==="fakeround"){var Qi=-Math.sqrt(Vr*Vr-1),Ti=qn?Qi:0,Ji=qn?0:Qi;if(tt&&this.addCurrentVertex(Ce,Pt,Ti,Ji,Xe),hi==="fakeround")for(var ua=Math.round(180*fn/Math.PI/20),$a=1;$a<ua;$a++){var ji=$a/ua;if(ji!==.5){var no=ji-.5;ji+=ji*no*(ji-1)*((1.0904+Sr*(Sr*(3.55645-1.43519*Sr)-3.2452))*no*no+(.848013+Sr*(.215638*Sr-1.06021)))}var Bo=qt.sub(Pt)._mult(ji)._add(Pt)._unit()._mult(qn?-1:1);this.addHalfVertex(Ce,Bo.x,Bo.y,!1,qn,0,Xe)}Mt&&this.addCurrentVertex(Ce,qt,-Ti,-Ji,Xe)}else if(hi==="butt")this.addCurrentVertex(Ce,pr,0,0,Xe);else if(hi==="square"){var fs=tt?1:-1;this.addCurrentVertex(Ce,pr,fs,fs,Xe)}else hi==="round"&&(tt&&(this.addCurrentVertex(Ce,Pt,0,0,Xe),this.addCurrentVertex(Ce,Pt,1,1,Xe,!0)),Mt&&(this.addCurrentVertex(Ce,qt,-1,-1,Xe,!0),this.addCurrentVertex(Ce,qt,0,0,Xe)));if(Nn&&Zt<te-1){var hs=Ce.dist(Mt);if(hs>2*Ie){var ns=Ce.add(Mt.sub(Ce)._mult(Ie/hs)._round());this.updateDistance(Ce,ns),this.addCurrentVertex(ns,qt,0,0,Xe),Ce=ns}}}}},Yu.prototype.addCurrentVertex=function(t,o,u,v,y,x){x===void 0&&(x=!1);var A=o.y*v-o.x,B=-o.y-o.x*v;this.addHalfVertex(t,o.x+o.y*u,o.y-o.x*u,x,!1,u,y),this.addHalfVertex(t,A,B,x,!0,-v,y),this.distance>sp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,o,u,v,y,x))},Yu.prototype.addHalfVertex=function(t,o,u,v,y,x,A){var B=.5*(this.lineClips?this.scaledDistance*(sp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(v?1:0),(t.y<<1)+(y?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(x===0?0:x<0?-1:1)|(63&B)<<2,B>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var te=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,te),A.primitiveLength++),y?this.e2=te:this.e1=te},Yu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Yu.prototype.updateDistance=function(t,o){this.distance+=t.dist(o),this.updateScaledDistance()},oi("LineBucket",Yu,{omit:["layers","patternFeatures"]});var Wp=new Ro({"line-cap":new Ci($e.layout_line["line-cap"]),"line-join":new rn($e.layout_line["line-join"]),"line-miter-limit":new Ci($e.layout_line["line-miter-limit"]),"line-round-limit":new Ci($e.layout_line["line-round-limit"]),"line-sort-key":new rn($e.layout_line["line-sort-key"])}),Ad={paint:new Ro({"line-opacity":new rn($e.paint_line["line-opacity"]),"line-color":new rn($e.paint_line["line-color"]),"line-translate":new Ci($e.paint_line["line-translate"]),"line-translate-anchor":new Ci($e.paint_line["line-translate-anchor"]),"line-width":new rn($e.paint_line["line-width"]),"line-gap-width":new rn($e.paint_line["line-gap-width"]),"line-offset":new rn($e.paint_line["line-offset"]),"line-blur":new rn($e.paint_line["line-blur"]),"line-dasharray":new ws($e.paint_line["line-dasharray"]),"line-pattern":new cu($e.paint_line["line-pattern"]),"line-gradient":new fu($e.paint_line["line-gradient"])}),layout:Wp},Cd=new(function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.possiblyEvaluate=function(u,v){return v=new ea(Math.floor(v.zoom),{now:v.now,fadeDuration:v.fadeDuration,zoomHistory:v.zoomHistory,transition:v.transition}),t.prototype.possiblyEvaluate.call(this,u,v)},o.prototype.evaluate=function(u,v,y,x){return v=J({},v,{zoom:Math.floor(v.zoom)}),t.prototype.evaluate.call(this,u,v,y,x)},o}(rn))(Ad.paint.properties["line-width"].specification);Cd.useIntegerZoom=!0;var up=function(t){function o(u){t.call(this,u,Ad),this.gradientVersion=0}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof gn,this.gradientVersion=(this.gradientVersion+1)%Q)},o.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},o.prototype.recalculate=function(u,v){t.prototype.recalculate.call(this,u,v),this.paint._values["line-floorwidth"]=Cd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},o.prototype.createBucket=function(u){return new Yu(u)},o.prototype.queryRadius=function(u){var v=u,y=id(ms("line-width",this,v),ms("line-gap-width",this,v)),x=ms("line-offset",this,v);return y/2+Math.abs(x)+Yo(this.paint.get("line-translate"))},o.prototype.queryIntersectsFeature=function(u,v,y,x,A,B,te){var _e=Lu(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),B.angle,te),Ce=te/2*id(this.paint.get("line-width").evaluate(v,y),this.paint.get("line-gap-width").evaluate(v,y)),Ie=this.paint.get("line-offset").evaluate(v,y);return Ie&&(x=function(Xe,tt){for(var Mt=[],Pt=new F(0,0),qt=0;qt<Xe.length;qt++){for(var Zt=Xe[qt],pr=[],Sr=0;Sr<Zt.length;Sr++){var Br=Zt[Sr],Vr=Zt[Sr+1],fn=Sr===0?Pt:Br.sub(Zt[Sr-1])._unit()._perp(),Nn=Sr===Zt.length-1?Pt:Vr.sub(Br)._unit()._perp(),qn=fn._add(Nn)._unit();qn._mult(1/(qn.x*Nn.x+qn.y*Nn.y)),pr.push(qn._mult(tt)._add(Br))}Mt.push(pr)}return Mt}(x,Ie*te)),function(Xe,tt,Mt){for(var Pt=0;Pt<tt.length;Pt++){var qt=tt[Pt];if(Xe.length>=3){for(var Zt=0;Zt<qt.length;Zt++)if(xo(Xe,qt[Zt]))return!0}if(da(Xe,qt,Mt))return!0}return!1}(_e,x,Ce)},o.prototype.isTileClipped=function(){return!0},o}(Fs);function id(t,o){return o>0?o+2*t:t}var lp=No([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Lh=No([{name:"a_projected_pos",components:3,type:"Float32"}],4),wd=(No([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),No([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Rd=(No([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),No([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ee=No([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function pt(t,o,u){return t.sections.forEach(function(v){v.text=function(y,x,A){var B=x.layout.get("text-transform").evaluate(A,{});return B==="uppercase"?y=y.toLocaleUpperCase():B==="lowercase"&&(y=y.toLocaleLowerCase()),$o.applyArabicShaping&&(y=$o.applyArabicShaping(y)),y}(v.text,o,u)}),t}No([{name:"triangle",components:3,type:"Uint16"}]),No([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),No([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),No([{type:"Float32",name:"offsetX"}]),No([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ut={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Pr=function(t,o,u,v,y){var x,A,B=8*y-v-1,te=(1<<B)-1,_e=te>>1,Ce=-7,Ie=u?y-1:0,Xe=u?-1:1,tt=t[o+Ie];for(Ie+=Xe,x=tt&(1<<-Ce)-1,tt>>=-Ce,Ce+=B;Ce>0;x=256*x+t[o+Ie],Ie+=Xe,Ce-=8);for(A=x&(1<<-Ce)-1,x>>=-Ce,Ce+=v;Ce>0;A=256*A+t[o+Ie],Ie+=Xe,Ce-=8);if(x===0)x=1-_e;else{if(x===te)return A?NaN:1/0*(tt?-1:1);A+=Math.pow(2,v),x-=_e}return(tt?-1:1)*A*Math.pow(2,x-v)},ln=function(t,o,u,v,y,x){var A,B,te,_e=8*x-y-1,Ce=(1<<_e)-1,Ie=Ce>>1,Xe=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,tt=v?0:x-1,Mt=v?1:-1,Pt=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(B=isNaN(o)?1:0,A=Ce):(A=Math.floor(Math.log(o)/Math.LN2),o*(te=Math.pow(2,-A))<1&&(A--,te*=2),(o+=A+Ie>=1?Xe/te:Xe*Math.pow(2,1-Ie))*te>=2&&(A++,te/=2),A+Ie>=Ce?(B=0,A=Ce):A+Ie>=1?(B=(o*te-1)*Math.pow(2,y),A+=Ie):(B=o*Math.pow(2,Ie-1)*Math.pow(2,y),A=0));y>=8;t[u+tt]=255&B,tt+=Mt,B/=256,y-=8);for(A=A<<y|B,_e+=y;_e>0;t[u+tt]=255&A,tt+=Mt,A/=256,_e-=8);t[u+tt-Mt]|=128*Pt},Lr=Tr;function Tr(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Tr.Varint=0,Tr.Fixed64=1,Tr.Bytes=2,Tr.Fixed32=5;var Ln=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function An(t){return t.type===Tr.Bytes?t.readVarint()+t.pos:t.pos+1}function $n(t,o,u){return u?4294967296*o+(t>>>0):4294967296*(o>>>0)+(t>>>0)}function Fn(t,o,u){var v=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(v);for(var y=u.pos-1;y>=t;y--)u.buf[y+v]=u.buf[y]}function jn(t,o){for(var u=0;u<t.length;u++)o.writeVarint(t[u])}function Kn(t,o){for(var u=0;u<t.length;u++)o.writeSVarint(t[u])}function Cn(t,o){for(var u=0;u<t.length;u++)o.writeFloat(t[u])}function Vn(t,o){for(var u=0;u<t.length;u++)o.writeDouble(t[u])}function _r(t,o){for(var u=0;u<t.length;u++)o.writeBoolean(t[u])}function Gr(t,o){for(var u=0;u<t.length;u++)o.writeFixed32(t[u])}function Bn(t,o){for(var u=0;u<t.length;u++)o.writeSFixed32(t[u])}function ni(t,o){for(var u=0;u<t.length;u++)o.writeFixed64(t[u])}function bn(t,o){for(var u=0;u<t.length;u++)o.writeSFixed64(t[u])}function si(t,o){return(t[o]|t[o+1]<<8|t[o+2]<<16)+16777216*t[o+3]}function Mn(t,o,u){t[u]=o,t[u+1]=o>>>8,t[u+2]=o>>>16,t[u+3]=o>>>24}function ii(t,o){return(t[o]|t[o+1]<<8|t[o+2]<<16)+(t[o+3]<<24)}function En(t,o,u){t===1&&u.readMessage(Qn,o)}function Qn(t,o,u){if(t===3){var v=u.readMessage(Ui,{}),y=v.width,x=v.height,A=v.left,B=v.top,te=v.advance;o.push({id:v.id,bitmap:new Qc({width:y+6,height:x+6},v.bitmap),metrics:{width:y,height:x,left:A,top:B,advance:te}})}}function Ui(t,o,u){t===1?o.id=u.readVarint():t===2?o.bitmap=u.readBytes():t===3?o.width=u.readVarint():t===4?o.height=u.readVarint():t===5?o.left=u.readSVarint():t===6?o.top=u.readSVarint():t===7&&(o.advance=u.readVarint())}function oa(t){for(var o=0,u=0,v=0,y=t;v<y.length;v+=1){var x=y[v];o+=x.w*x.h,u=Math.max(u,x.w)}t.sort(function(Pt,qt){return qt.h-Pt.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}],B=0,te=0,_e=0,Ce=t;_e<Ce.length;_e+=1)for(var Ie=Ce[_e],Xe=A.length-1;Xe>=0;Xe--){var tt=A[Xe];if(!(Ie.w>tt.w||Ie.h>tt.h)){if(Ie.x=tt.x,Ie.y=tt.y,te=Math.max(te,Ie.y+Ie.h),B=Math.max(B,Ie.x+Ie.w),Ie.w===tt.w&&Ie.h===tt.h){var Mt=A.pop();Xe<A.length&&(A[Xe]=Mt)}else Ie.h===tt.h?(tt.x+=Ie.w,tt.w-=Ie.w):Ie.w===tt.w?(tt.y+=Ie.h,tt.h-=Ie.h):(A.push({x:tt.x+Ie.w,y:tt.y,w:tt.w-Ie.w,h:Ie.h}),tt.y+=Ie.h,tt.h-=Ie.h);break}}return{w:B,h:te,fill:o/(B*te)||0}}Tr.prototype={destroy:function(){this.buf=null},readFields:function(t,o,u){for(u=u||this.length;this.pos<u;){var v=this.readVarint(),y=v>>3,x=this.pos;this.type=7&v,t(y,o,this),this.pos===x&&this.skip(v)}return o},readMessage:function(t,o){return this.readFields(t,o,this.readVarint()+this.pos)},readFixed32:function(){var t=si(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ii(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=si(this.buf,this.pos)+4294967296*si(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=si(this.buf,this.pos)+4294967296*ii(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Pr(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Pr(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var o,u,v=this.buf;return o=127&(u=v[this.pos++]),u<128?o:(o|=(127&(u=v[this.pos++]))<<7,u<128?o:(o|=(127&(u=v[this.pos++]))<<14,u<128?o:(o|=(127&(u=v[this.pos++]))<<21,u<128?o:function(y,x,A){var B,te,_e=A.buf;if(B=(112&(te=_e[A.pos++]))>>4,te<128||(B|=(127&(te=_e[A.pos++]))<<3,te<128)||(B|=(127&(te=_e[A.pos++]))<<10,te<128)||(B|=(127&(te=_e[A.pos++]))<<17,te<128)||(B|=(127&(te=_e[A.pos++]))<<24,te<128)||(B|=(1&(te=_e[A.pos++]))<<31,te<128))return $n(y,B,x);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(u=v[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,o=this.pos;return this.pos=t,t-o>=12&&Ln?function(u,v,y){return Ln.decode(u.subarray(v,y))}(this.buf,o,t):function(u,v,y){for(var x="",A=v;A<y;){var B,te,_e,Ce=u[A],Ie=null,Xe=Ce>239?4:Ce>223?3:Ce>191?2:1;if(A+Xe>y)break;Xe===1?Ce<128&&(Ie=Ce):Xe===2?(192&(B=u[A+1]))==128&&(Ie=(31&Ce)<<6|63&B)<=127&&(Ie=null):Xe===3?(te=u[A+2],(192&(B=u[A+1]))==128&&(192&te)==128&&((Ie=(15&Ce)<<12|(63&B)<<6|63&te)<=2047||Ie>=55296&&Ie<=57343)&&(Ie=null)):Xe===4&&(te=u[A+2],_e=u[A+3],(192&(B=u[A+1]))==128&&(192&te)==128&&(192&_e)==128&&((Ie=(15&Ce)<<18|(63&B)<<12|(63&te)<<6|63&_e)<=65535||Ie>=1114112)&&(Ie=null)),Ie===null?(Ie=65533,Xe=1):Ie>65535&&(Ie-=65536,x+=String.fromCharCode(Ie>>>10&1023|55296),Ie=56320|1023&Ie),x+=String.fromCharCode(Ie),A+=Xe}return x}(this.buf,o,t)},readBytes:function(){var t=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,t);return this.pos=t,o},readPackedVarint:function(t,o){if(this.type!==Tr.Bytes)return t.push(this.readVarint(o));var u=An(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(o));return t},readPackedSVarint:function(t){if(this.type!==Tr.Bytes)return t.push(this.readSVarint());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Tr.Bytes)return t.push(this.readBoolean());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Tr.Bytes)return t.push(this.readFloat());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Tr.Bytes)return t.push(this.readDouble());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Tr.Bytes)return t.push(this.readFixed32());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Tr.Bytes)return t.push(this.readSFixed32());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Tr.Bytes)return t.push(this.readFixed64());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Tr.Bytes)return t.push(this.readSFixed64());var o=An(this);for(t=t||[];this.pos<o;)t.push(this.readSFixed64());return t},skip:function(t){var o=7&t;if(o===Tr.Varint)for(;this.buf[this.pos++]>127;);else if(o===Tr.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Tr.Fixed32)this.pos+=4;else{if(o!==Tr.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(t,o){this.writeVarint(t<<3|o)},realloc:function(t){for(var o=this.length||16;o<this.pos+t;)o*=2;if(o!==this.length){var u=new Uint8Array(o);u.set(this.buf),this.buf=u,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Mn(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Mn(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Mn(this.buf,-1&t,this.pos),Mn(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Mn(this.buf,-1&t,this.pos),Mn(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(o,u){var v,y;if(o>=0?(v=o%4294967296|0,y=o/4294967296|0):(y=~(-o/4294967296),4294967295^(v=~(-o%4294967296))?v=v+1|0:(v=0,y=y+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,A,B){B.buf[B.pos++]=127&x|128,x>>>=7,B.buf[B.pos++]=127&x|128,x>>>=7,B.buf[B.pos++]=127&x|128,x>>>=7,B.buf[B.pos++]=127&x|128,B.buf[B.pos]=127&(x>>>=7)}(v,0,u),function(x,A){var B=(7&x)<<4;A.buf[A.pos++]|=B|((x>>>=3)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x)))))}(y,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var o=this.pos;this.pos=function(v,y,x){for(var A,B,te=0;te<y.length;te++){if((A=y.charCodeAt(te))>55295&&A<57344){if(!B){A>56319||te+1===y.length?(v[x++]=239,v[x++]=191,v[x++]=189):B=A;continue}if(A<56320){v[x++]=239,v[x++]=191,v[x++]=189,B=A;continue}A=B-55296<<10|A-56320|65536,B=null}else B&&(v[x++]=239,v[x++]=191,v[x++]=189,B=null);A<128?v[x++]=A:(A<2048?v[x++]=A>>6|192:(A<65536?v[x++]=A>>12|224:(v[x++]=A>>18|240,v[x++]=A>>12&63|128),v[x++]=A>>6&63|128),v[x++]=63&A|128)}return x}(this.buf,t,this.pos);var u=this.pos-o;u>=128&&Fn(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),ln(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ln(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var o=t.length;this.writeVarint(o),this.realloc(o);for(var u=0;u<o;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,o){this.pos++;var u=this.pos;t(o,this);var v=this.pos-u;v>=128&&Fn(u,v,this),this.pos=u-1,this.writeVarint(v),this.pos+=v},writeMessage:function(t,o,u){this.writeTag(t,Tr.Bytes),this.writeRawMessage(o,u)},writePackedVarint:function(t,o){o.length&&this.writeMessage(t,jn,o)},writePackedSVarint:function(t,o){o.length&&this.writeMessage(t,Kn,o)},writePackedBoolean:function(t,o){o.length&&this.writeMessage(t,_r,o)},writePackedFloat:function(t,o){o.length&&this.writeMessage(t,Cn,o)},writePackedDouble:function(t,o){o.length&&this.writeMessage(t,Vn,o)},writePackedFixed32:function(t,o){o.length&&this.writeMessage(t,Gr,o)},writePackedSFixed32:function(t,o){o.length&&this.writeMessage(t,Bn,o)},writePackedFixed64:function(t,o){o.length&&this.writeMessage(t,ni,o)},writePackedSFixed64:function(t,o){o.length&&this.writeMessage(t,bn,o)},writeBytesField:function(t,o){this.writeTag(t,Tr.Bytes),this.writeBytes(o)},writeFixed32Field:function(t,o){this.writeTag(t,Tr.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(t,o){this.writeTag(t,Tr.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(t,o){this.writeTag(t,Tr.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(t,o){this.writeTag(t,Tr.Fixed64),this.writeSFixed64(o)},writeVarintField:function(t,o){this.writeTag(t,Tr.Varint),this.writeVarint(o)},writeSVarintField:function(t,o){this.writeTag(t,Tr.Varint),this.writeSVarint(o)},writeStringField:function(t,o){this.writeTag(t,Tr.Bytes),this.writeString(o)},writeFloatField:function(t,o){this.writeTag(t,Tr.Fixed32),this.writeFloat(o)},writeDoubleField:function(t,o){this.writeTag(t,Tr.Fixed64),this.writeDouble(o)},writeBooleanField:function(t,o){this.writeVarintField(t,!!o)}};var ei=function(t,o){var u=o.pixelRatio,v=o.version,y=o.stretchX,x=o.stretchY,A=o.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=y,this.stretchY=x,this.content=A,this.version=v},Pn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Pn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Pn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Pn.tlbr.get=function(){return this.tl.concat(this.br)},Pn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(ei.prototype,Pn);var cn=function(t,o){var u={},v={};this.haveRenderCallbacks=[];var y=[];this.addImages(t,u,y),this.addImages(o,v,y);var x=oa(y),A=new Au({width:x.w||1,height:x.h||1});for(var B in t){var te=t[B],_e=u[B].paddedRect;Au.copy(te.data,A,{x:0,y:0},{x:_e.x+1,y:_e.y+1},te.data)}for(var Ce in o){var Ie=o[Ce],Xe=v[Ce].paddedRect,tt=Xe.x+1,Mt=Xe.y+1,Pt=Ie.data.width,qt=Ie.data.height;Au.copy(Ie.data,A,{x:0,y:0},{x:tt,y:Mt},Ie.data),Au.copy(Ie.data,A,{x:0,y:qt-1},{x:tt,y:Mt-1},{width:Pt,height:1}),Au.copy(Ie.data,A,{x:0,y:0},{x:tt,y:Mt+qt},{width:Pt,height:1}),Au.copy(Ie.data,A,{x:Pt-1,y:0},{x:tt-1,y:Mt},{width:1,height:qt}),Au.copy(Ie.data,A,{x:0,y:0},{x:tt+Pt,y:Mt},{width:1,height:qt})}this.image=A,this.iconPositions=u,this.patternPositions=v};cn.prototype.addImages=function(t,o,u){for(var v in t){var y=t[v],x={x:0,y:0,w:y.data.width+2,h:y.data.height+2};u.push(x),o[v]=new ei(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(v)}},cn.prototype.patchUpdatedImages=function(t,o){for(var u in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),o)},cn.prototype.patchUpdatedImage=function(t,o,u){if(t&&o&&t.version!==o.version){t.version=o.version;var v=t.tl;u.update(o.data,void 0,{x:v[0],y:v[1]})}},oi("ImagePosition",ei),oi("ImageAtlas",cn);var zi={horizontal:1,vertical:2,horizontalOnly:3},pa=function(){this.scale=1,this.fontStack="",this.imageName=null};pa.forText=function(t,o){var u=new pa;return u.scale=t||1,u.fontStack=o,u},pa.forImage=function(t){var o=new pa;return o.imageName=t,o};var ui=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function va(t,o,u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt){var qt,Zt=ui.fromFeature(t,y);Ie===zi.vertical&&Zt.verticalizePunctuation();var pr=$o.processBidirectionalText,Sr=$o.processStyledBidirectionalText;if(pr&&Zt.sections.length===1){qt=[];for(var Br=0,Vr=pr(Zt.toString(),Os(Zt,_e,x,o,v,tt,Mt));Br<Vr.length;Br+=1){var fn=Vr[Br],Nn=new ui;Nn.text=fn,Nn.sections=Zt.sections;for(var qn=0;qn<fn.length;qn++)Nn.sectionIndex.push(0);qt.push(Nn)}}else if(Sr){qt=[];for(var Di=0,ci=Sr(Zt.text,Zt.sectionIndex,Os(Zt,_e,x,o,v,tt,Mt));Di<ci.length;Di+=1){var ki=ci[Di],hi=new ui;hi.text=ki[0],hi.sectionIndex=ki[1],hi.sections=Zt.sections,qt.push(hi)}}else qt=function(Ti,Ji){for(var ua=[],$a=Ti.text,ji=0,no=0,Bo=Ji;no<Bo.length;no+=1){var fs=Bo[no];ua.push(Ti.substring(ji,fs)),ji=fs}return ji<$a.length&&ua.push(Ti.substring(ji,$a.length)),ua}(Zt,Os(Zt,_e,x,o,v,tt,Mt));var ma=[],Qi={positionedLines:ma,text:Zt.toString(),top:Ce[1],bottom:Ce[1],left:Ce[0],right:Ce[0],writingMode:Ie,iconsInText:!1,verticalizable:!1};return function(Ti,Ji,ua,$a,ji,no,Bo,fs,hs,ns,is,Hs){for(var vu=0,wu=-17,Ts=0,dl=0,Ps=fs==="right"?1:fs==="left"?0:.5,Ru=0,Ba=0,So=ji;Ba<So.length;Ba+=1){var _o=So[Ba];_o.trim();var Xa=_o.getMaxScale(),pl=24*(Xa-1),Nu={positionedGlyphs:[],lineOffset:0};Ti.positionedLines[Ru]=Nu;var jo=Nu.positionedGlyphs,Ds=0;if(_o.length()){for(var Ku=0;Ku<_o.length();Ku++){var Ya=_o.getSection(Ku),rf=_o.getSectionIndex(Ku),cc=_o.getCharCode(Ku),Hf=0,ks=null,$f=null,nf=null,Wf=24,Eh=!(hs===zi.horizontal||!is&&!il(cc)||is&&(aa[cc]||(uh=cc,zn.Arabic(uh)||zn["Arabic Supplement"](uh)||zn["Arabic Extended-A"](uh)||zn["Arabic Presentation Forms-A"](uh)||zn["Arabic Presentation Forms-B"](uh))));if(Ya.imageName){var od=$a[Ya.imageName];if(!od)continue;nf=Ya.imageName,Ti.iconsInText=Ti.iconsInText||!0,$f=od.paddedRect;var Gf=od.displaySize;Ya.scale=24*Ya.scale/Hs,Hf=pl+(24-Gf[1]*Ya.scale),Wf=(ks={width:Gf[0],height:Gf[1],left:1,top:-3,advance:Eh?Gf[1]:Gf[0]}).advance;var Uh=Eh?Gf[0]*Ya.scale-24*Xa:Gf[1]*Ya.scale-24*Xa;Uh>0&&Uh>Ds&&(Ds=Uh)}else{var Dd=ua[Ya.fontStack],sd=Dd&&Dd[cc];if(sd&&sd.rect)$f=sd.rect,ks=sd.metrics;else{var kd=Ji[Ya.fontStack],pp=kd&&kd[cc];if(!pp)continue;ks=pp.metrics}Hf=24*(Xa-Ya.scale)}Eh?(Ti.verticalizable=!0,jo.push({glyph:cc,imageName:nf,x:vu,y:wu+Hf,vertical:Eh,scale:Ya.scale,fontStack:Ya.fontStack,sectionIndex:rf,metrics:ks,rect:$f}),vu+=Wf*Ya.scale+ns):(jo.push({glyph:cc,imageName:nf,x:vu,y:wu+Hf,vertical:Eh,scale:Ya.scale,fontStack:Ya.fontStack,sectionIndex:rf,metrics:ks,rect:$f}),vu+=ks.advance*Ya.scale+ns)}jo.length!==0&&(Ts=Math.max(vu-ns,Ts),Us(jo,0,jo.length-1,Ps,Ds)),vu=0;var vp=no*Xa+Ds;Nu.lineOffset=Math.max(Ds,pl),wu+=vp,dl=Math.max(vp,dl),++Ru}else wu+=no,++Ru}var uh,ud=wu- -17,ld=Lo(Bo),lh=ld.horizontalAlign,zh=ld.verticalAlign;(function(Ld,mp,Bd,cd,gp,Fd,Nd,Zh,rv){var jh,Ud=(mp-Bd)*gp;jh=Fd!==Nd?-Zh*cd- -17:(-cd*rv+.5)*Nd;for(var Vh=0,Hh=Ld;Vh<Hh.length;Vh+=1)for(var ch=0,qu=Hh[Vh].positionedGlyphs;ch<qu.length;ch+=1){var Sh=qu[ch];Sh.x+=Ud,Sh.y+=jh}})(Ti.positionedLines,Ps,lh,zh,Ts,dl,no,ud,ji.length),Ti.top+=-zh*ud,Ti.bottom=Ti.top+ud,Ti.left+=-lh*Ts,Ti.right=Ti.left+Ts}(Qi,o,u,v,qt,A,B,te,Ie,_e,Xe,Pt),!function(Ti){for(var Ji=0,ua=Ti;Ji<ua.length;Ji+=1)if(ua[Ji].positionedGlyphs.length!==0)return!1;return!0}(ma)&&Qi}ui.fromFeature=function(t,o){for(var u=new ui,v=0;v<t.sections.length;v++){var y=t.sections[v];y.image?u.addImageSection(y):u.addTextSection(y,o)}return u},ui.prototype.length=function(){return this.text.length},ui.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ui.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ui.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ui.prototype.verticalizePunctuation=function(){this.text=function(t){for(var o="",u=0;u<t.length;u++){var v=t.charCodeAt(u+1)||null,y=t.charCodeAt(u-1)||null;o+=v&&Ec(v)&&!Ut[t[u+1]]||y&&Ec(y)&&!Ut[t[u-1]]||!Ut[t[u]]?t[u]:Ut[t[u]]}return o}(this.text)},ui.prototype.trim=function(){for(var t=0,o=0;o<this.text.length&&aa[this.text.charCodeAt(o)];o++)t++;for(var u=this.text.length,v=this.text.length-1;v>=0&&v>=t&&aa[this.text.charCodeAt(v)];v--)u--;this.text=this.text.substring(t,u),this.sectionIndex=this.sectionIndex.slice(t,u)},ui.prototype.substring=function(t,o){var u=new ui;return u.text=this.text.substring(t,o),u.sectionIndex=this.sectionIndex.slice(t,o),u.sections=this.sections,u},ui.prototype.toString=function(){return this.text},ui.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(o,u){return Math.max(o,t.sections[u].scale)},0)},ui.prototype.addTextSection=function(t,o){this.text+=t.text,this.sections.push(pa.forText(t.scale,t.fontStack||o));for(var u=this.sections.length-1,v=0;v<t.text.length;++v)this.sectionIndex.push(u)},ui.prototype.addImageSection=function(t){var o=t.image?t.image.name:"";if(o.length!==0){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(pa.forImage(o)),this.sectionIndex.push(this.sections.length-1)):ge("Reached maximum number of images 6401")}else ge("Can't add FormattedSection with an empty image.")},ui.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var aa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Yi={};function Qa(t,o,u,v,y,x){if(o.imageName){var A=v[o.imageName];return A?A.displaySize[0]*o.scale*24/x+y:0}var B=u[o.fontStack],te=B&&B[t];return te?te.metrics.advance*o.scale+y:0}function Is(t,o,u,v){var y=Math.pow(t-o,2);return v?t<o?y/2:2*y:y+Math.abs(u)*u}function du(t,o,u){var v=0;return t===10&&(v-=1e4),u&&(v+=150),t!==40&&t!==65288||(v+=50),o!==41&&o!==65289||(v+=50),v}function ba(t,o,u,v,y,x){for(var A=null,B=Is(o,u,y,x),te=0,_e=v;te<_e.length;te+=1){var Ce=_e[te],Ie=Is(o-Ce.x,u,y,x)+Ce.badness;Ie<=B&&(A=Ce,B=Ie)}return{index:t,x:o,priorBreak:A,badness:B}}function Os(t,o,u,v,y,x,A){if(x!=="point")return[];if(!t)return[];for(var B,te=[],_e=function(qt,Zt,pr,Sr,Br,Vr){for(var fn=0,Nn=0;Nn<qt.length();Nn++){var qn=qt.getSection(Nn);fn+=Qa(qt.getCharCode(Nn),qn,Sr,Br,Zt,Vr)}return fn/Math.max(1,Math.ceil(fn/pr))}(t,o,u,v,y,A),Ce=t.text.indexOf("\u200B")>=0,Ie=0,Xe=0;Xe<t.length();Xe++){var tt=t.getSection(Xe),Mt=t.getCharCode(Xe);if(aa[Mt]||(Ie+=Qa(Mt,tt,v,y,o,A)),Xe<t.length()-1){var Pt=!((B=Mt)<11904||!(zn["Bopomofo Extended"](B)||zn.Bopomofo(B)||zn["CJK Compatibility Forms"](B)||zn["CJK Compatibility Ideographs"](B)||zn["CJK Compatibility"](B)||zn["CJK Radicals Supplement"](B)||zn["CJK Strokes"](B)||zn["CJK Symbols and Punctuation"](B)||zn["CJK Unified Ideographs Extension A"](B)||zn["CJK Unified Ideographs"](B)||zn["Enclosed CJK Letters and Months"](B)||zn["Halfwidth and Fullwidth Forms"](B)||zn.Hiragana(B)||zn["Ideographic Description Characters"](B)||zn["Kangxi Radicals"](B)||zn["Katakana Phonetic Extensions"](B)||zn.Katakana(B)||zn["Vertical Forms"](B)||zn["Yi Radicals"](B)||zn["Yi Syllables"](B)));(Yi[Mt]||Pt||tt.imageName)&&te.push(ba(Xe+1,Ie,_e,te,du(Mt,t.getCharCode(Xe+1),Pt&&Ce),!1))}}return function qt(Zt){return Zt?qt(Zt.priorBreak).concat(Zt.index):[]}(ba(t.length(),Ie,_e,te,0,!0))}function Lo(t){var o=.5,u=.5;switch(t){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function Us(t,o,u,v,y){if(v||y)for(var x=t[u],A=(t[u].x+x.metrics.advance*x.scale)*v,B=o;B<=u;B++)t[B].x-=A,t[B].y+=y}function zs(t,o,u,v,y,x){var A,B=t.image;if(B.content){var te=B.content,_e=B.pixelRatio||1;A=[te[0]/_e,te[1]/_e,B.displaySize[0]-te[2]/_e,B.displaySize[1]-te[3]/_e]}var Ce,Ie,Xe,tt,Mt=o.left*x,Pt=o.right*x;u==="width"||u==="both"?(tt=y[0]+Mt-v[3],Ie=y[0]+Pt+v[1]):Ie=(tt=y[0]+(Mt+Pt-B.displaySize[0])/2)+B.displaySize[0];var qt=o.top*x,Zt=o.bottom*x;return u==="height"||u==="both"?(Ce=y[1]+qt-v[0],Xe=y[1]+Zt+v[2]):Xe=(Ce=y[1]+(qt+Zt-B.displaySize[1])/2)+B.displaySize[1],{image:B,top:Ce,right:Ie,bottom:Xe,left:tt,collisionPadding:A}}Yi[10]=!0,Yi[32]=!0,Yi[38]=!0,Yi[40]=!0,Yi[41]=!0,Yi[43]=!0,Yi[45]=!0,Yi[47]=!0,Yi[173]=!0,Yi[183]=!0,Yi[8203]=!0,Yi[8208]=!0,Yi[8211]=!0,Yi[8231]=!0;var cs=function(t){function o(u,v,y,x){t.call(this,u,v),this.angle=y,x!==void 0&&(this.segment=x)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.clone=function(){return new o(this.x,this.y,this.angle,this.segment)},o}(F);function Js(t,o){var u=o.expression;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new ea(t+1))};if(u.kind==="source")return{kind:"source"};for(var v=u.zoomStops,y=u.interpolationType,x=0;x<v.length&&v[x]<=t;)x++;for(var A=x=Math.max(0,x-1);A<v.length&&v[A]<t+1;)A++;A=Math.min(v.length-1,A);var B=v[x],te=v[A];return u.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:te,interpolationType:y}:{kind:"camera",minZoom:B,maxZoom:te,minSize:u.evaluate(new ea(B)),maxSize:u.evaluate(new ea(te)),interpolationType:y}}function Fu(t,o,u){var v=o.uSize,y=u.lowerSize;return t.kind==="source"?y/128:t.kind==="composite"?Ai(y/128,u.upperSize/128,o.uSizeT):v}function Zs(t,o){var u=0,v=0;if(t.kind==="constant")v=t.layoutSize;else if(t.kind!=="source"){var y=t.interpolationType,x=y?U(Qo.interpolationFactor(y,o,t.minZoom,t.maxZoom),0,1):0;t.kind==="camera"?v=Ai(t.minSize,t.maxSize,x):u=x}return{uSizeT:u,uSize:v}}oi("Anchor",cs);var ca=Object.freeze({__proto__:null,getSizeData:Js,evaluateSizeForFeature:Fu,evaluateSizeForZoom:Zs,SIZE_PACK_FACTOR:128});function pu(t,o,u,v,y){if(o.segment===void 0)return!0;for(var x=o,A=o.segment+1,B=0;B>-u/2;){if(--A<0)return!1;B-=t[A].dist(x),x=t[A]}B+=t[A].dist(t[A+1]),A++;for(var te=[],_e=0;B<u/2;){var Ce=t[A],Ie=t[A+1];if(!Ie)return!1;var Xe=t[A-1].angleTo(Ce)-Ce.angleTo(Ie);for(Xe=Math.abs((Xe+3*Math.PI)%(2*Math.PI)-Math.PI),te.push({distance:B,angleDelta:Xe}),_e+=Xe;B-te[0].distance>v;)_e-=te.shift().angleDelta;if(_e>y)return!1;A++,B+=Ce.dist(Ie)}return!0}function ta(t){for(var o=0,u=0;u<t.length-1;u++)o+=t[u].dist(t[u+1]);return o}function $i(t,o,u){return t?.6*o*u:0}function xa(t,o){return Math.max(t?t.right-t.left:0,o?o.right-o.left:0)}function Ha(t,o,u,v,y,x){for(var A=$i(u,y,x),B=xa(u,v)*x,te=0,_e=ta(t)/2,Ce=0;Ce<t.length-1;Ce++){var Ie=t[Ce],Xe=t[Ce+1],tt=Ie.dist(Xe);if(te+tt>_e){var Mt=(_e-te)/tt,Pt=Ai(Ie.x,Xe.x,Mt),qt=Ai(Ie.y,Xe.y,Mt),Zt=new cs(Pt,qt,Xe.angleTo(Ie),Ce);return Zt._round(),!A||pu(t,Zt,B,A,o)?Zt:void 0}te+=tt}}function Es(t,o,u,v,y,x,A,B,te){var _e=$i(v,x,A),Ce=xa(v,y),Ie=Ce*A,Xe=t[0].x===0||t[0].x===te||t[0].y===0||t[0].y===te;return o-Ie<o/4&&(o=Ie+o/4),function tt(Mt,Pt,qt,Zt,pr,Sr,Br,Vr,fn){for(var Nn=Sr/2,qn=ta(Mt),Di=0,ci=Pt-qt,ki=[],hi=0;hi<Mt.length-1;hi++){for(var ma=Mt[hi],Qi=Mt[hi+1],Ti=ma.dist(Qi),Ji=Qi.angleTo(ma);ci+qt<Di+Ti;){var ua=((ci+=qt)-Di)/Ti,$a=Ai(ma.x,Qi.x,ua),ji=Ai(ma.y,Qi.y,ua);if($a>=0&&$a<fn&&ji>=0&&ji<fn&&ci-Nn>=0&&ci+Nn<=qn){var no=new cs($a,ji,Ji,hi);no._round(),Zt&&!pu(Mt,no,Sr,Zt,pr)||ki.push(no)}}Di+=Ti}return Vr||ki.length||Br||(ki=tt(Mt,Di/2,qt,Zt,pr,Sr,Br,!0,fn)),ki}(t,Xe?o/2*B%o:(Ce/2+2*x)*A*B%o,o,_e,u,Ie,Xe,!1,te)}function wc(t,o,u,v,y){for(var x=[],A=0;A<t.length;A++)for(var B=t[A],te=void 0,_e=0;_e<B.length-1;_e++){var Ce=B[_e],Ie=B[_e+1];Ce.x<o&&Ie.x<o||(Ce.x<o?Ce=new F(o,Ce.y+(o-Ce.x)/(Ie.x-Ce.x)*(Ie.y-Ce.y))._round():Ie.x<o&&(Ie=new F(o,Ce.y+(o-Ce.x)/(Ie.x-Ce.x)*(Ie.y-Ce.y))._round()),Ce.y<u&&Ie.y<u||(Ce.y<u?Ce=new F(Ce.x+(u-Ce.y)/(Ie.y-Ce.y)*(Ie.x-Ce.x),u)._round():Ie.y<u&&(Ie=new F(Ce.x+(u-Ce.y)/(Ie.y-Ce.y)*(Ie.x-Ce.x),u)._round()),Ce.x>=v&&Ie.x>=v||(Ce.x>=v?Ce=new F(v,Ce.y+(v-Ce.x)/(Ie.x-Ce.x)*(Ie.y-Ce.y))._round():Ie.x>=v&&(Ie=new F(v,Ce.y+(v-Ce.x)/(Ie.x-Ce.x)*(Ie.y-Ce.y))._round()),Ce.y>=y&&Ie.y>=y||(Ce.y>=y?Ce=new F(Ce.x+(y-Ce.y)/(Ie.y-Ce.y)*(Ie.x-Ce.x),y)._round():Ie.y>=y&&(Ie=new F(Ce.x+(y-Ce.y)/(Ie.y-Ce.y)*(Ie.x-Ce.x),y)._round()),te&&Ce.equals(te[te.length-1])||x.push(te=[Ce]),te.push(Ie)))))}return x}function It(t,o,u,v){var y=[],x=t.image,A=x.pixelRatio,B=x.paddedRect.w-2,te=x.paddedRect.h-2,_e=t.right-t.left,Ce=t.bottom-t.top,Ie=x.stretchX||[[0,B]],Xe=x.stretchY||[[0,te]],tt=function($a,ji){return $a+ji[1]-ji[0]},Mt=Ie.reduce(tt,0),Pt=Xe.reduce(tt,0),qt=B-Mt,Zt=te-Pt,pr=0,Sr=Mt,Br=0,Vr=Pt,fn=0,Nn=qt,qn=0,Di=Zt;if(x.content&&v){var ci=x.content;pr=Nr(Ie,0,ci[0]),Br=Nr(Xe,0,ci[1]),Sr=Nr(Ie,ci[0],ci[2]),Vr=Nr(Xe,ci[1],ci[3]),fn=ci[0]-pr,qn=ci[1]-Br,Nn=ci[2]-ci[0]-Sr,Di=ci[3]-ci[1]-Vr}var ki=function($a,ji,no,Bo){var fs=li($a.stretch-pr,Sr,_e,t.left),hs=ha($a.fixed-fn,Nn,$a.stretch,Mt),ns=li(ji.stretch-Br,Vr,Ce,t.top),is=ha(ji.fixed-qn,Di,ji.stretch,Pt),Hs=li(no.stretch-pr,Sr,_e,t.left),vu=ha(no.fixed-fn,Nn,no.stretch,Mt),wu=li(Bo.stretch-Br,Vr,Ce,t.top),Ts=ha(Bo.fixed-qn,Di,Bo.stretch,Pt),dl=new F(fs,ns),Ps=new F(Hs,ns),Ru=new F(Hs,wu),Ba=new F(fs,wu),So=new F(hs/A,is/A),_o=new F(vu/A,Ts/A),Xa=o*Math.PI/180;if(Xa){var pl=Math.sin(Xa),Nu=Math.cos(Xa),jo=[Nu,-pl,pl,Nu];dl._matMult(jo),Ps._matMult(jo),Ba._matMult(jo),Ru._matMult(jo)}var Ds=$a.stretch+$a.fixed,Ku=ji.stretch+ji.fixed;return{tl:dl,tr:Ps,bl:Ba,br:Ru,tex:{x:x.paddedRect.x+1+Ds,y:x.paddedRect.y+1+Ku,w:no.stretch+no.fixed-Ds,h:Bo.stretch+Bo.fixed-Ku},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:So,pixelOffsetBR:_o,minFontScaleX:Nn/A/_e,minFontScaleY:Di/A/Ce,isSDF:u}};if(v&&(x.stretchX||x.stretchY))for(var hi=Rr(Ie,qt,Mt),ma=Rr(Xe,Zt,Pt),Qi=0;Qi<hi.length-1;Qi++)for(var Ti=hi[Qi],Ji=hi[Qi+1],ua=0;ua<ma.length-1;ua++)y.push(ki(Ti,ma[ua],Ji,ma[ua+1]));else y.push(ki({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:te+1}));return y}function Nr(t,o,u){for(var v=0,y=0,x=t;y<x.length;y+=1){var A=x[y];v+=Math.max(o,Math.min(u,A[1]))-Math.max(o,Math.min(u,A[0]))}return v}function Rr(t,o,u){for(var v=[{fixed:-1,stretch:0}],y=0,x=t;y<x.length;y+=1){var A=x[y],B=A[0],te=A[1],_e=v[v.length-1];v.push({fixed:B-_e.stretch,stretch:_e.stretch}),v.push({fixed:B-_e.stretch,stretch:_e.stretch+(te-B)})}return v.push({fixed:o+1,stretch:u}),v}function li(t,o,u,v){return t/o*u+v}function ha(t,o,u,v){return t-o*u/v}var vo=function(t,o,u,v,y,x,A,B,te,_e){if(this.boxStartIndex=t.length,te){var Ce=x.top,Ie=x.bottom,Xe=x.collisionPadding;Xe&&(Ce-=Xe[1],Ie+=Xe[3]);var tt=Ie-Ce;tt>0&&(tt=Math.max(10,tt),this.circleDiameter=tt)}else{var Mt=x.top*A-B,Pt=x.bottom*A+B,qt=x.left*A-B,Zt=x.right*A+B,pr=x.collisionPadding;if(pr&&(qt-=pr[0]*A,Mt-=pr[1]*A,Zt+=pr[2]*A,Pt+=pr[3]*A),_e){var Sr=new F(qt,Mt),Br=new F(Zt,Mt),Vr=new F(qt,Pt),fn=new F(Zt,Pt),Nn=_e*Math.PI/180;Sr._rotate(Nn),Br._rotate(Nn),Vr._rotate(Nn),fn._rotate(Nn),qt=Math.min(Sr.x,Br.x,Vr.x,fn.x),Zt=Math.max(Sr.x,Br.x,Vr.x,fn.x),Mt=Math.min(Sr.y,Br.y,Vr.y,fn.y),Pt=Math.max(Sr.y,Br.y,Vr.y,fn.y)}t.emplaceBack(o.x,o.y,qt,Mt,Zt,Pt,u,v,y)}this.boxEndIndex=t.length},Qe=function(t,o){if(t===void 0&&(t=[]),o===void 0&&(o=xt),this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function xt(t,o){return t<o?-1:t>o?1:0}function Nt(t,o,u){o===void 0&&(o=1),u===void 0&&(u=!1);for(var v=1/0,y=1/0,x=-1/0,A=-1/0,B=t[0],te=0;te<B.length;te++){var _e=B[te];(!te||_e.x<v)&&(v=_e.x),(!te||_e.y<y)&&(y=_e.y),(!te||_e.x>x)&&(x=_e.x),(!te||_e.y>A)&&(A=_e.y)}var Ce=Math.min(x-v,A-y),Ie=Ce/2,Xe=new Qe([],Mr);if(Ce===0)return new F(v,y);for(var tt=v;tt<x;tt+=Ce)for(var Mt=y;Mt<A;Mt+=Ce)Xe.push(new Ar(tt+Ie,Mt+Ie,Ie,t));for(var Pt=function(pr){for(var Sr=0,Br=0,Vr=0,fn=pr[0],Nn=0,qn=fn.length,Di=qn-1;Nn<qn;Di=Nn++){var ci=fn[Nn],ki=fn[Di],hi=ci.x*ki.y-ki.x*ci.y;Br+=(ci.x+ki.x)*hi,Vr+=(ci.y+ki.y)*hi,Sr+=3*hi}return new Ar(Br/Sr,Vr/Sr,0,pr)}(t),qt=Xe.length;Xe.length;){var Zt=Xe.pop();(Zt.d>Pt.d||!Pt.d)&&(Pt=Zt,u&&console.log("found best %d after %d probes",Math.round(1e4*Zt.d)/1e4,qt)),Zt.max-Pt.d<=o||(Xe.push(new Ar(Zt.p.x-(Ie=Zt.h/2),Zt.p.y-Ie,Ie,t)),Xe.push(new Ar(Zt.p.x+Ie,Zt.p.y-Ie,Ie,t)),Xe.push(new Ar(Zt.p.x-Ie,Zt.p.y+Ie,Ie,t)),Xe.push(new Ar(Zt.p.x+Ie,Zt.p.y+Ie,Ie,t)),qt+=4)}return u&&(console.log("num probes: "+qt),console.log("best distance: "+Pt.d)),Pt.p}function Mr(t,o){return o.max-t.max}function Ar(t,o,u,v){this.p=new F(t,o),this.h=u,this.d=function(y,x){for(var A=!1,B=1/0,te=0;te<x.length;te++)for(var _e=x[te],Ce=0,Ie=_e.length,Xe=Ie-1;Ce<Ie;Xe=Ce++){var tt=_e[Ce],Mt=_e[Xe];tt.y>y.y!=Mt.y>y.y&&y.x<(Mt.x-tt.x)*(y.y-tt.y)/(Mt.y-tt.y)+tt.x&&(A=!A),B=Math.min(B,Xo(y,tt,Mt))}return(A?1:-1)*Math.sqrt(B)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}Qe.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Qe.prototype.pop=function(){if(this.length!==0){var t=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),t}},Qe.prototype.peek=function(){return this.data[0]},Qe.prototype._up=function(t){for(var o=this.data,u=this.compare,v=o[t];t>0;){var y=t-1>>1,x=o[y];if(u(v,x)>=0)break;o[t]=x,t=y}o[t]=v},Qe.prototype._down=function(t){for(var o=this.data,u=this.compare,v=this.length>>1,y=o[t];t<v;){var x=1+(t<<1),A=o[x],B=x+1;if(B<this.length&&u(o[B],A)<0&&(x=B,A=o[B]),u(A,y)>=0)break;o[t]=A,t=x}o[t]=y};var Kt=Number.POSITIVE_INFINITY;function nr(t,o){return o[1]!==Kt?function(u,v,y){var x=0,A=0;switch(v=Math.abs(v),y=Math.abs(y),u){case"top-right":case"top-left":case"top":A=y-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-y}switch(u){case"top-right":case"bottom-right":case"right":x=-v;break;case"top-left":case"bottom-left":case"left":x=v}return[x,A]}(t,o[0],o[1]):function(u,v){var y=0,x=0;v<0&&(v=0);var A=v/Math.sqrt(2);switch(u){case"top-right":case"top-left":x=A-7;break;case"bottom-right":case"bottom-left":x=7-A;break;case"bottom":x=7-v;break;case"top":x=v-7}switch(u){case"top-right":case"bottom-right":y=-A;break;case"top-left":case"bottom-left":y=A;break;case"left":y=v;break;case"right":y=-v}return[y,x]}(t,o[0])}function ur(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Dt(t,o,u,v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt){var Pt=function(Br,Vr,fn,Nn,qn,Di,ci,ki){for(var hi=Nn.layout.get("text-rotate").evaluate(Di,{})*Math.PI/180,ma=[],Qi=0,Ti=Vr.positionedLines;Qi<Ti.length;Qi+=1)for(var Ji=Ti[Qi],ua=0,$a=Ji.positionedGlyphs;ua<$a.length;ua+=1){var ji=$a[ua];if(ji.rect){var no=ji.rect||{},Bo=4,fs=!0,hs=1,ns=0,is=(qn||ki)&&ji.vertical,Hs=ji.metrics.advance*ji.scale/2;if(ki&&Vr.verticalizable&&(ns=Ji.lineOffset/2-(ji.imageName?-(24-ji.metrics.width*ji.scale)/2:24*(ji.scale-1))),ji.imageName){var vu=ci[ji.imageName];fs=vu.sdf,Bo=1/(hs=vu.pixelRatio)}var wu=qn?[ji.x+Hs,ji.y]:[0,0],Ts=qn?[0,0]:[ji.x+Hs+fn[0],ji.y+fn[1]-ns],dl=[0,0];is&&(dl=Ts,Ts=[0,0]);var Ps=(ji.metrics.left-Bo)*ji.scale-Hs+Ts[0],Ru=(-ji.metrics.top-Bo)*ji.scale+Ts[1],Ba=Ps+no.w*ji.scale/hs,So=Ru+no.h*ji.scale/hs,_o=new F(Ps,Ru),Xa=new F(Ba,Ru),pl=new F(Ps,So),Nu=new F(Ba,So);if(is){var jo=new F(-Hs,Hs- -17),Ds=-Math.PI/2,Ku=12-Hs,Ya=new F(22-Ku,-(ji.imageName?Ku:0)),rf=new(Function.prototype.bind.apply(F,[null].concat(dl)));_o._rotateAround(Ds,jo)._add(Ya)._add(rf),Xa._rotateAround(Ds,jo)._add(Ya)._add(rf),pl._rotateAround(Ds,jo)._add(Ya)._add(rf),Nu._rotateAround(Ds,jo)._add(Ya)._add(rf)}if(hi){var cc=Math.sin(hi),Hf=Math.cos(hi),ks=[Hf,-cc,cc,Hf];_o._matMult(ks),Xa._matMult(ks),pl._matMult(ks),Nu._matMult(ks)}var $f=new F(0,0),nf=new F(0,0);ma.push({tl:_o,tr:Xa,bl:pl,br:Nu,tex:no,writingMode:Vr.writingMode,glyphOffset:wu,sectionIndex:ji.sectionIndex,isSDF:fs,pixelOffsetTL:$f,pixelOffsetBR:nf,minFontScaleX:0,minFontScaleY:0})}}return ma}(0,u,B,y,x,A,v,t.allowVerticalPlacement),qt=t.textSizeData,Zt=null;qt.kind==="source"?(Zt=[128*y.layout.get("text-size").evaluate(A,{})])[0]>32640&&ge(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):qt.kind==="composite"&&((Zt=[128*tt.compositeTextSizes[0].evaluate(A,{},Mt),128*tt.compositeTextSizes[1].evaluate(A,{},Mt)])[0]>32640||Zt[1]>32640)&&ge(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Pt,Zt,B,x,A,_e,o,te.lineStartIndex,te.lineLength,Xe,Mt);for(var pr=0,Sr=Ce;pr<Sr.length;pr+=1)Ie[Sr[pr]]=t.text.placedSymbolArray.length-1;return 4*Pt.length}function Jt(t){for(var o in t)return t[o];return null}function gt(t,o,u,v){var y=t.compareText;if(o in y){for(var x=y[o],A=x.length-1;A>=0;A--)if(v.dist(x[A])<u)return!0}else y[o]=[];return y[o].push(v),!1}var rr=jf.VectorTileFeature.types,zr=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yr(t,o,u,v,y,x,A,B,te,_e,Ce,Ie,Xe){var tt=B?Math.min(32640,Math.round(B[0])):0,Mt=B?Math.min(32640,Math.round(B[1])):0;t.emplaceBack(o,u,Math.round(32*v),Math.round(32*y),x,A,(tt<<1)+(te?1:0),Mt,16*_e,16*Ce,256*Ie,256*Xe)}function Sn(t,o,u){t.emplaceBack(o.x,o.y,u),t.emplaceBack(o.x,o.y,u),t.emplaceBack(o.x,o.y,u),t.emplaceBack(o.x,o.y,u)}function pn(t){for(var o=0,u=t.sections;o<u.length;o+=1)if(Lc(u[o].text))return!0;return!1}var wn=function(t){this.layoutVertexArray=new Kc,this.indexArray=new Ii,this.programConfigurations=t,this.segments=new ot,this.dynamicLayoutVertexArray=new ac,this.opacityVertexArray=new Vi,this.placedSymbolArray=new m};wn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},wn.prototype.upload=function(t,o,u,v){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Lh.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,zr,!0),this.opacityVertexBuffer.itemSize=1),(u||v)&&this.programConfigurations.upload(t))},wn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},oi("SymbolBuffers",wn);var wi=function(t,o,u){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new u,this.segments=new ot,this.collisionVertexArray=new Gu};wi.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,wd.members,!0)},wi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},oi("CollisionBuffers",wi);var yi=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(x){return x.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bs([]),this.placementViewportMatrix=bs([]);var o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Js(this.zoom,o["text-size"]),this.iconSizeData=Js(this.zoom,o["icon-size"]);var u=this.layers[0].layout,v=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(x){return zi[x]})),this.stateDependentLayerIds=this.layers.filter(function(x){return x.isStateDependent()}).map(function(x){return x.id}),this.sourceID=t.sourceID};yi.prototype.createArrays=function(){this.text=new wn(new Jr(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new wn(new Jr(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new L,this.lineVertexArray=new q,this.symbolInstances=new R},yi.prototype.calculateGlyphDependencies=function(t,o,u,v,y){for(var x=0;x<t.length;x++)if(o[t.charCodeAt(x)]=!0,(u||v)&&y){var A=Ut[t.charAt(x)];A&&(o[A.charCodeAt(0)]=!0)}},yi.prototype.populate=function(t,o,u){var v=this.layers[0],y=v.layout,x=y.get("text-font"),A=y.get("text-field"),B=y.get("icon-image"),te=(A.value.kind!=="constant"||A.value.value instanceof Ta&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),_e=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,Ce=y.get("symbol-sort-key");if(this.features=[],te||_e){for(var Ie=o.iconDependencies,Xe=o.glyphDependencies,tt=o.availableImages,Mt=new ea(this.zoom),Pt=0,qt=t;Pt<qt.length;Pt+=1){var Zt=qt[Pt],pr=Zt.feature,Sr=Zt.id,Br=Zt.index,Vr=Zt.sourceLayerIndex,fn=v._featureFilter.needGeometry,Nn=Ni(pr,fn);if(v._featureFilter.filter(Mt,Nn,u)){fn||(Nn.geometry=xi(pr));var qn=void 0;if(te){var Di=v.getValueAndResolveTokens("text-field",Nn,u,tt),ci=Ta.factory(Di);pn(ci)&&(this.hasRTLText=!0),(!this.hasRTLText||Tf()==="unavailable"||this.hasRTLText&&$o.isParsed())&&(qn=pt(ci,v,Nn))}var ki=void 0;if(_e){var hi=v.getValueAndResolveTokens("icon-image",Nn,u,tt);ki=hi instanceof Aa?hi:Aa.fromString(hi)}if(qn||ki){var ma=this.sortFeaturesByKey?Ce.evaluate(Nn,{},u):void 0;if(this.features.push({id:Sr,text:qn,icon:ki,index:Br,sourceLayerIndex:Vr,geometry:Nn.geometry,properties:pr.properties,type:rr[pr.type],sortKey:ma}),ki&&(Ie[ki.name]=!0),qn){var Qi=x.evaluate(Nn,{},u).join(","),Ti=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(zi.vertical)>=0;for(var Ji=0,ua=qn.sections;Ji<ua.length;Ji+=1){var $a=ua[Ji];if($a.image)Ie[$a.image.name]=!0;else{var ji=Du(qn.toString()),no=$a.fontStack||Qi,Bo=Xe[no]=Xe[no]||{};this.calculateGlyphDependencies($a.text,Bo,Ti,this.allowVerticalPlacement,ji)}}}}}}y.get("symbol-placement")==="line"&&(this.features=function(fs){var hs={},ns={},is=[],Hs=0;function vu(jo){is.push(fs[jo]),Hs++}function wu(jo,Ds,Ku){var Ya=ns[jo];return delete ns[jo],ns[Ds]=Ya,is[Ya].geometry[0].pop(),is[Ya].geometry[0]=is[Ya].geometry[0].concat(Ku[0]),Ya}function Ts(jo,Ds,Ku){var Ya=hs[Ds];return delete hs[Ds],hs[jo]=Ya,is[Ya].geometry[0].shift(),is[Ya].geometry[0]=Ku[0].concat(is[Ya].geometry[0]),Ya}function dl(jo,Ds,Ku){var Ya=Ku?Ds[0][Ds[0].length-1]:Ds[0][0];return jo+":"+Ya.x+":"+Ya.y}for(var Ps=0;Ps<fs.length;Ps++){var Ru=fs[Ps],Ba=Ru.geometry,So=Ru.text?Ru.text.toString():null;if(So){var _o=dl(So,Ba),Xa=dl(So,Ba,!0);if(_o in ns&&Xa in hs&&ns[_o]!==hs[Xa]){var pl=Ts(_o,Xa,Ba),Nu=wu(_o,Xa,is[pl].geometry);delete hs[_o],delete ns[Xa],ns[dl(So,is[Nu].geometry,!0)]=Nu,is[pl].geometry=null}else _o in ns?wu(_o,Xa,Ba):Xa in hs?Ts(_o,Xa,Ba):(vu(Ps),hs[_o]=Hs-1,ns[Xa]=Hs-1)}else vu(Ps)}return is.filter(function(jo){return jo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(fs,hs){return fs.sortKey-hs.sortKey})}},yi.prototype.update=function(t,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,u))},yi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},yi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},yi.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},yi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},yi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},yi.prototype.addToLineVertexArray=function(t,o){var u=this.lineVertexArray.length;if(t.segment!==void 0){for(var v=t.dist(o[t.segment+1]),y=t.dist(o[t.segment]),x={},A=t.segment+1;A<o.length;A++)x[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:v},A<o.length-1&&(v+=o[A+1].dist(o[A]));for(var B=t.segment||0;B>=0;B--)x[B]={x:o[B].x,y:o[B].y,tileUnitDistanceFromAnchor:y},B>0&&(y+=o[B-1].dist(o[B]));for(var te=0;te<o.length;te++){var _e=x[te];this.lineVertexArray.emplaceBack(_e.x,_e.y,_e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},yi.prototype.addSymbols=function(t,o,u,v,y,x,A,B,te,_e,Ce,Ie){for(var Xe=t.indexArray,tt=t.layoutVertexArray,Mt=t.segments.prepareSegment(4*o.length,tt,Xe,this.canOverlap?x.sortKey:void 0),Pt=this.glyphOffsetArray.length,qt=Mt.vertexLength,Zt=this.allowVerticalPlacement&&A===zi.vertical?Math.PI/2:0,pr=x.text&&x.text.sections,Sr=0;Sr<o.length;Sr++){var Br=o[Sr],Vr=Br.tl,fn=Br.tr,Nn=Br.bl,qn=Br.br,Di=Br.tex,ci=Br.pixelOffsetTL,ki=Br.pixelOffsetBR,hi=Br.minFontScaleX,ma=Br.minFontScaleY,Qi=Br.glyphOffset,Ti=Br.isSDF,Ji=Br.sectionIndex,ua=Mt.vertexLength,$a=Qi[1];Yr(tt,B.x,B.y,Vr.x,$a+Vr.y,Di.x,Di.y,u,Ti,ci.x,ci.y,hi,ma),Yr(tt,B.x,B.y,fn.x,$a+fn.y,Di.x+Di.w,Di.y,u,Ti,ki.x,ci.y,hi,ma),Yr(tt,B.x,B.y,Nn.x,$a+Nn.y,Di.x,Di.y+Di.h,u,Ti,ci.x,ki.y,hi,ma),Yr(tt,B.x,B.y,qn.x,$a+qn.y,Di.x+Di.w,Di.y+Di.h,u,Ti,ki.x,ki.y,hi,ma),Sn(t.dynamicLayoutVertexArray,B,Zt),Xe.emplaceBack(ua,ua+1,ua+2),Xe.emplaceBack(ua+1,ua+2,ua+3),Mt.vertexLength+=4,Mt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qi[0]),Sr!==o.length-1&&Ji===o[Sr+1].sectionIndex||t.programConfigurations.populatePaintArrays(tt.length,x,x.index,{},Ie,pr&&pr[Ji])}t.placedSymbolArray.emplaceBack(B.x,B.y,Pt,this.glyphOffsetArray.length-Pt,qt,te,_e,B.segment,u?u[0]:0,u?u[1]:0,v[0],v[1],A,0,!1,0,Ce)},yi.prototype._addCollisionDebugVertex=function(t,o,u,v,y,x){return o.emplaceBack(0,0),t.emplaceBack(u.x,u.y,v,y,Math.round(x.x),Math.round(x.y))},yi.prototype.addCollisionDebugVertices=function(t,o,u,v,y,x,A){var B=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),te=B.vertexLength,_e=y.layoutVertexArray,Ce=y.collisionVertexArray,Ie=A.anchorX,Xe=A.anchorY;this._addCollisionDebugVertex(_e,Ce,x,Ie,Xe,new F(t,o)),this._addCollisionDebugVertex(_e,Ce,x,Ie,Xe,new F(u,o)),this._addCollisionDebugVertex(_e,Ce,x,Ie,Xe,new F(u,v)),this._addCollisionDebugVertex(_e,Ce,x,Ie,Xe,new F(t,v)),B.vertexLength+=4;var tt=y.indexArray;tt.emplaceBack(te,te+1),tt.emplaceBack(te+1,te+2),tt.emplaceBack(te+2,te+3),tt.emplaceBack(te+3,te),B.primitiveLength+=4},yi.prototype.addDebugCollisionBoxes=function(t,o,u,v){for(var y=t;y<o;y++){var x=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,v?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}},yi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wi(Pl,Rd.members,oc),this.iconCollisionBox=new wi(Pl,Rd.members,oc);for(var t=0;t<this.symbolInstances.length;t++){var o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}},yi.prototype._deserializeCollisionBoxesForSymbol=function(t,o,u,v,y,x,A,B,te){for(var _e={},Ce=o;Ce<u;Ce++){var Ie=t.get(Ce);_e.textBox={x1:Ie.x1,y1:Ie.y1,x2:Ie.x2,y2:Ie.y2,anchorPointX:Ie.anchorPointX,anchorPointY:Ie.anchorPointY},_e.textFeatureIndex=Ie.featureIndex;break}for(var Xe=v;Xe<y;Xe++){var tt=t.get(Xe);_e.verticalTextBox={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2,anchorPointX:tt.anchorPointX,anchorPointY:tt.anchorPointY},_e.verticalTextFeatureIndex=tt.featureIndex;break}for(var Mt=x;Mt<A;Mt++){var Pt=t.get(Mt);_e.iconBox={x1:Pt.x1,y1:Pt.y1,x2:Pt.x2,y2:Pt.y2,anchorPointX:Pt.anchorPointX,anchorPointY:Pt.anchorPointY},_e.iconFeatureIndex=Pt.featureIndex;break}for(var qt=B;qt<te;qt++){var Zt=t.get(qt);_e.verticalIconBox={x1:Zt.x1,y1:Zt.y1,x2:Zt.x2,y2:Zt.y2,anchorPointX:Zt.anchorPointX,anchorPointY:Zt.anchorPointY},_e.verticalIconFeatureIndex=Zt.featureIndex;break}return _e},yi.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var o=0;o<this.symbolInstances.length;o++){var u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},yi.prototype.hasTextData=function(){return this.text.segments.get().length>0},yi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},yi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},yi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},yi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},yi.prototype.addIndicesForPlacedSymbol=function(t,o){for(var u=t.placedSymbolArray.get(o),v=u.vertexStartIndex+4*u.numGlyphs,y=u.vertexStartIndex;y<v;y+=4)t.indexArray.emplaceBack(y,y+1,y+2),t.indexArray.emplaceBack(y+1,y+2,y+3)},yi.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var o=Math.sin(t),u=Math.cos(t),v=[],y=[],x=[],A=0;A<this.symbolInstances.length;++A){x.push(A);var B=this.symbolInstances.get(A);v.push(0|Math.round(o*B.anchorX+u*B.anchorY)),y.push(B.featureIndex)}return x.sort(function(te,_e){return v[te]-v[_e]||y[_e]-y[te]}),x},yi.prototype.addToSortKeyRanges=function(t,o){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})},yi.prototype.sortFeatures=function(t){var o=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,v=this.symbolInstanceIndexes;u<v.length;u+=1){var y=this.symbolInstances.get(v[u]);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(function(x,A,B){x>=0&&B.indexOf(x)===A&&o.addIndicesForPlacedSymbol(o.text,x)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},oi("SymbolBucket",yi,{omit:["layers","collisionBoxArray","features","compareText"]}),yi.MAX_GLYPHS=65535,yi.addDynamicAttributes=Sn;var Si=new Ro({"symbol-placement":new Ci($e.layout_symbol["symbol-placement"]),"symbol-spacing":new Ci($e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ci($e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rn($e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ci($e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ci($e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ci($e.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ci($e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ci($e.layout_symbol["icon-rotation-alignment"]),"icon-size":new rn($e.layout_symbol["icon-size"]),"icon-text-fit":new Ci($e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ci($e.layout_symbol["icon-text-fit-padding"]),"icon-image":new rn($e.layout_symbol["icon-image"]),"icon-rotate":new rn($e.layout_symbol["icon-rotate"]),"icon-padding":new Ci($e.layout_symbol["icon-padding"]),"icon-keep-upright":new Ci($e.layout_symbol["icon-keep-upright"]),"icon-offset":new rn($e.layout_symbol["icon-offset"]),"icon-anchor":new rn($e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ci($e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ci($e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ci($e.layout_symbol["text-rotation-alignment"]),"text-field":new rn($e.layout_symbol["text-field"]),"text-font":new rn($e.layout_symbol["text-font"]),"text-size":new rn($e.layout_symbol["text-size"]),"text-max-width":new rn($e.layout_symbol["text-max-width"]),"text-line-height":new Ci($e.layout_symbol["text-line-height"]),"text-letter-spacing":new rn($e.layout_symbol["text-letter-spacing"]),"text-justify":new rn($e.layout_symbol["text-justify"]),"text-radial-offset":new rn($e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ci($e.layout_symbol["text-variable-anchor"]),"text-anchor":new rn($e.layout_symbol["text-anchor"]),"text-max-angle":new Ci($e.layout_symbol["text-max-angle"]),"text-writing-mode":new Ci($e.layout_symbol["text-writing-mode"]),"text-rotate":new rn($e.layout_symbol["text-rotate"]),"text-padding":new Ci($e.layout_symbol["text-padding"]),"text-keep-upright":new Ci($e.layout_symbol["text-keep-upright"]),"text-transform":new rn($e.layout_symbol["text-transform"]),"text-offset":new rn($e.layout_symbol["text-offset"]),"text-allow-overlap":new Ci($e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ci($e.layout_symbol["text-ignore-placement"]),"text-optional":new Ci($e.layout_symbol["text-optional"])}),Wi={paint:new Ro({"icon-opacity":new rn($e.paint_symbol["icon-opacity"]),"icon-color":new rn($e.paint_symbol["icon-color"]),"icon-halo-color":new rn($e.paint_symbol["icon-halo-color"]),"icon-halo-width":new rn($e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rn($e.paint_symbol["icon-halo-blur"]),"icon-translate":new Ci($e.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ci($e.paint_symbol["icon-translate-anchor"]),"text-opacity":new rn($e.paint_symbol["text-opacity"]),"text-color":new rn($e.paint_symbol["text-color"],{runtimeType:Dr,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new rn($e.paint_symbol["text-halo-color"]),"text-halo-width":new rn($e.paint_symbol["text-halo-width"]),"text-halo-blur":new rn($e.paint_symbol["text-halo-blur"]),"text-translate":new Ci($e.paint_symbol["text-translate"]),"text-translate-anchor":new Ci($e.paint_symbol["text-translate-anchor"])}),layout:Si},Ki=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:lr,this.defaultValue=t};Ki.prototype.evaluate=function(t){if(t.formattedSection){var o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Ki.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Ki.prototype.outputDefined=function(){return!1},Ki.prototype.serialize=function(){return null},oi("FormatSectionOverride",Ki,{omit:["defaultValue"]});var to=function(t){function o(u){t.call(this,u,Wi)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.recalculate=function(u,v){if(t.prototype.recalculate.call(this,u,v),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var y=this.layout.get("text-writing-mode");if(y){for(var x=[],A=0,B=y;A<B.length;A+=1){var te=B[A];x.indexOf(te)<0&&x.push(te)}this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},o.prototype.getValueAndResolveTokens=function(u,v,y,x){var A=this.layout.get(u).evaluate(v,{},y,x),B=this._unevaluatedLayout._values[u];return B.isDataDriven()||tl(B.value)||!A?A:function(te,_e){return _e.replace(/{([^{}]+)}/g,function(Ce,Ie){return Ie in te?String(te[Ie]):""})}(v.properties,A)},o.prototype.createBucket=function(u){return new yi(u)},o.prototype.queryRadius=function(){return 0},o.prototype.queryIntersectsFeature=function(){return!1},o.prototype._setPaintOverrides=function(){for(var u=0,v=Wi.paint.overridableProperties;u<v.length;u+=1){var y=v[u];if(o.hasPaintOverride(this.layout,y)){var x,A=this.paint.get(y),B=new Ki(A),te=new Iu(B,A.property.specification);x=A.value.kind==="constant"||A.value.kind==="source"?new Jl("source",te):new jl("composite",te,A.value.zoomStops,A.value._interpolationType),this.paint._values[y]=new es(A.property,x,A.parameters)}}},o.prototype._handleOverridablePaintPropertyUpdate=function(u,v,y){return!(!this.layout||v.isDataDriven()||y.isDataDriven())&&o.hasPaintOverride(this.layout,u)},o.hasPaintOverride=function(u,v){var y=u.get("text-field"),x=Wi.paint.properties[v],A=!1,B=function(Ce){for(var Ie=0,Xe=Ce;Ie<Xe.length;Ie+=1)if(x.overrides&&x.overrides.hasOverride(Xe[Ie]))return void(A=!0)};if(y.value.kind==="constant"&&y.value.value instanceof Ta)B(y.value.value.sections);else if(y.value.kind==="source"){var te=function(Ce){A||(Ce instanceof za&&ka(Ce.value)===Mi?B(Ce.value.sections):Ce instanceof qo?B(Ce.sections):Ce.eachChild(te))},_e=y.value;_e._styleExpression&&te(_e._styleExpression.expression)}return A},o}(Fs),js={paint:new Ro({"background-color":new Ci($e.paint_background["background-color"]),"background-pattern":new ws($e.paint_background["background-pattern"]),"background-opacity":new Ci($e.paint_background["background-opacity"])})},Uc=function(t){function o(u){t.call(this,u,js)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Fs),Bh={paint:new Ro({"raster-opacity":new Ci($e.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ci($e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ci($e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ci($e.paint_raster["raster-brightness-max"]),"raster-saturation":new Ci($e.paint_raster["raster-saturation"]),"raster-contrast":new Ci($e.paint_raster["raster-contrast"]),"raster-resampling":new Ci($e.paint_raster["raster-resampling"]),"raster-fade-duration":new Ci($e.paint_raster["raster-fade-duration"])})},lc=function(t){function o(u){t.call(this,u,Bh)}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o}(Fs),cp=function(t){function o(u){t.call(this,u,{}),this.implementation=u}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},o.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},o.prototype.recalculate=function(){},o.prototype.updateTransitions=function(){},o.prototype.hasTransition=function(){},o.prototype.serialize=function(){},o.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},o.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},o}(Fs),Vf={circle:Uf,heatmap:ih,hillshade:Jh,fill:Kl,"fill-extrusion":Sd,line:up,symbol:to,background:Uc,raster:lc},Md=V.HTMLImageElement,Gp=V.HTMLCanvasElement,Xp=V.HTMLVideoElement,Yp=V.ImageData,fp=V.ImageBitmap,ad=function(t,o,u,v){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(o,v)};ad.prototype.update=function(t,o,u){var v=t.width,y=t.height,x=!(this.size&&this.size[0]===v&&this.size[1]===y||u),A=this.context,B=A.gl;if(this.useMipmap=!!(o&&o.useMipmap),B.bindTexture(B.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===B.RGBA&&(!o||o.premultiply!==!1)),x)this.size=[v,y],t instanceof Md||t instanceof Gp||t instanceof Xp||t instanceof Yp||fp&&t instanceof fp?B.texImage2D(B.TEXTURE_2D,0,this.format,this.format,B.UNSIGNED_BYTE,t):B.texImage2D(B.TEXTURE_2D,0,this.format,v,y,0,this.format,B.UNSIGNED_BYTE,t.data);else{var te=u||{x:0,y:0},_e=te.x,Ce=te.y;t instanceof Md||t instanceof Gp||t instanceof Xp||t instanceof Yp||fp&&t instanceof fp?B.texSubImage2D(B.TEXTURE_2D,0,_e,Ce,B.RGBA,B.UNSIGNED_BYTE,t):B.texSubImage2D(B.TEXTURE_2D,0,_e,Ce,v,y,B.RGBA,B.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&B.generateMipmap(B.TEXTURE_2D)},ad.prototype.bind=function(t,o,u){var v=this.context.gl;v.bindTexture(v.TEXTURE_2D,this.texture),u!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=v.LINEAR),t!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,t),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,u||t),this.filter=t),o!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,o),this.wrap=o)},ad.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ad.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Id=function(t){var o=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){o._triggered=!1,o._callback()})};Id.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Id.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Fh=function(t,o,u){this.target=t,this.parent=o,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ve(["receive","process"],this),this.invoker=new Id(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=xe()?t:V};function Lv(t,o,u){var v=2*Math.PI*6378137/256/Math.pow(2,u);return[t*v-2*Math.PI*6378137/2,o*v-2*Math.PI*6378137/2]}Fh.prototype.send=function(t,o,u,v,y){var x=this;y===void 0&&(y=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[A]=u);var B=Pe(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:t,hasCallback:!!u,targetMapId:v,mustQueue:y,sourceMapId:this.mapId,data:Cs(o,B)},B),{cancel:function(){u&&delete x.callbacks[A],x.target.postMessage({id:A,type:"<cancel>",targetMapId:v,sourceMapId:x.mapId})}}},Fh.prototype.receive=function(t){var o=t.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[u];var v=this.cancelCallbacks[u];delete this.cancelCallbacks[u],v&&v()}else xe()||o.mustQueue?(this.tasks[u]=o,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,o)},Fh.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),o=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(t,o)}},Fh.prototype.processTask=function(t,o){var u=this;if(o.type==="<response>"){var v=this.callbacks[t];delete this.callbacks[t],v&&(o.error?v(wa(o.error)):v(null,wa(o.data)))}else{var y=!1,x=Pe(this.globalScope)?void 0:[],A=o.hasCallback?function(Ce,Ie){y=!0,delete u.cancelCallbacks[t],u.target.postMessage({id:t,type:"<response>",sourceMapId:u.mapId,error:Ce?Cs(Ce):null,data:Cs(Ie,x)},x)}:function(Ce){y=!0},B=null,te=wa(o.data);if(this.parent[o.type])B=this.parent[o.type](o.sourceMapId,te,A);else if(this.parent.getWorkerSource){var _e=o.type.split(".");B=this.parent.getWorkerSource(o.sourceMapId,_e[0],te.source)[_e[1]](te,A)}else A(new Error("Could not find function "+o.type));!y&&B&&B.cancel&&(this.cancelCallbacks[t]=B.cancel)}},Fh.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Vs=function(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Vs.prototype.setNorthEast=function(t){return this._ne=t instanceof rs?new rs(t.lng,t.lat):rs.convert(t),this},Vs.prototype.setSouthWest=function(t){return this._sw=t instanceof rs?new rs(t.lng,t.lat):rs.convert(t),this},Vs.prototype.extend=function(t){var o,u,v=this._sw,y=this._ne;if(t instanceof rs)o=t,u=t;else{if(!(t instanceof Vs))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Vs.convert(t)):this.extend(rs.convert(t)):this;if(u=t._ne,!(o=t._sw)||!u)return this}return v||y?(v.lng=Math.min(o.lng,v.lng),v.lat=Math.min(o.lat,v.lat),y.lng=Math.max(u.lng,y.lng),y.lat=Math.max(u.lat,y.lat)):(this._sw=new rs(o.lng,o.lat),this._ne=new rs(u.lng,u.lat)),this},Vs.prototype.getCenter=function(){return new rs((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Vs.prototype.getSouthWest=function(){return this._sw},Vs.prototype.getNorthEast=function(){return this._ne},Vs.prototype.getNorthWest=function(){return new rs(this.getWest(),this.getNorth())},Vs.prototype.getSouthEast=function(){return new rs(this.getEast(),this.getSouth())},Vs.prototype.getWest=function(){return this._sw.lng},Vs.prototype.getSouth=function(){return this._sw.lat},Vs.prototype.getEast=function(){return this._ne.lng},Vs.prototype.getNorth=function(){return this._ne.lat},Vs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Vs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Vs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Vs.prototype.contains=function(t){var o=rs.convert(t),u=o.lng,v=o.lat,y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&y},Vs.convert=function(t){return!t||t instanceof Vs?t:new Vs(t)};var rs=function(t,o){if(isNaN(t)||isNaN(o))throw new Error("Invalid LngLat object: ("+t+", "+o+")");if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};rs.prototype.wrap=function(){return new rs(Z(this.lng,-180,180),this.lat)},rs.prototype.toArray=function(){return[this.lng,this.lat]},rs.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},rs.prototype.distanceTo=function(t){var o=Math.PI/180,u=this.lat*o,v=t.lat*o,y=Math.sin(u)*Math.sin(v)+Math.cos(u)*Math.cos(v)*Math.cos((t.lng-this.lng)*o);return 63710088e-1*Math.acos(Math.min(y,1))},rs.prototype.toBounds=function(t){t===void 0&&(t=0);var o=360*t/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new Vs(new rs(this.lng-u,this.lat-o),new rs(this.lng+u,this.lat+o))},rs.convert=function(t){if(t instanceof rs)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new rs(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new rs(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Em=2*Math.PI*63710088e-1;function Od(t){return Em*Math.cos(t*Math.PI/180)}function Kp(t){return(180+t)/360}function Sm(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Tm(t,o){return t/Od(o)}function Pd(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var oh=function(t,o,u){u===void 0&&(u=0),this.x=+t,this.y=+o,this.z=+u};oh.fromLngLat=function(t,o){o===void 0&&(o=0);var u=rs.convert(t);return new oh(Kp(u.lng),Sm(u.lat),Tm(o,u.lat))},oh.prototype.toLngLat=function(){return new rs(360*this.x-180,Pd(this.y))},oh.prototype.toAltitude=function(){return this.z*Od(Pd(this.y))},oh.prototype.meterInMercatorCoordinateUnits=function(){return 1/Em*(t=Pd(this.y),1/Math.cos(t*Math.PI/180));var t};var sh=function(t,o,u){this.z=t,this.x=o,this.y=u,this.key=Nh(0,t,t,o,u)};sh.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},sh.prototype.url=function(t,o){var u,v,y,x,A,B=(v=this.y,y=this.z,x=Lv(256*(u=this.x),256*(v=Math.pow(2,y)-v-1),y),A=Lv(256*(u+1),256*(v+1),y),x[0]+","+x[1]+","+A[0]+","+A[1]),te=function(_e,Ce,Ie){for(var Xe,tt="",Mt=_e;Mt>0;Mt--)tt+=(Ce&(Xe=1<<Mt-1)?1:0)+(Ie&Xe?2:0);return tt}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",te).replace("{bbox-epsg-3857}",B)},sh.prototype.getTilePoint=function(t){var o=Math.pow(2,this.z);return new F(8192*(t.x*o-this.x),8192*(t.y*o-this.y))},sh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qp=function(t,o){this.wrap=t,this.canonical=o,this.key=Nh(t,o.z,o.z,o.x,o.y)},Ss=function(t,o,u,v,y){this.overscaledZ=t,this.wrap=o,this.canonical=new sh(u,+v,+y),this.key=Nh(o,t,u,v,y)};function Nh(t,o,u,v,y){(t*=2)<0&&(t=-1*t-1);var x=1<<u;return(x*x*t+x*y+v).toString(36)+u.toString(36)+o.toString(36)}Ss.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Ss.prototype.scaledTo=function(t){var o=this.canonical.z-t;return t>this.canonical.z?new Ss(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ss(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)},Ss.prototype.calculateScaledKey=function(t,o){var u=this.canonical.z-t;return t>this.canonical.z?Nh(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):Nh(this.wrap*+o,t,t,this.canonical.x>>u,this.canonical.y>>u)},Ss.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o},Ss.prototype.children=function(t){if(this.overscaledZ>=t)return[new Ss(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var o=this.canonical.z+1,u=2*this.canonical.x,v=2*this.canonical.y;return[new Ss(o,this.wrap,o,u,v),new Ss(o,this.wrap,o,u+1,v),new Ss(o,this.wrap,o,u,v+1),new Ss(o,this.wrap,o,u+1,v+1)]},Ss.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Ss.prototype.wrapped=function(){return new Ss(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ss.prototype.unwrapTo=function(t){return new Ss(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Ss.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ss.prototype.toUnwrapped=function(){return new qp(this.wrap,this.canonical)},Ss.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ss.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new oh(t.x-this.wrap,t.y))},oi("CanonicalTileID",sh),oi("OverscaledTileID",Ss,{omit:["posMatrix"]});var bh=function(t,o,u){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return ge('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=o.height;var v=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=u||"mapbox";for(var y=0;y<v;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(v,y)]=this.data[this._idx(v-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,v)]=this.data[this._idx(y,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)]};bh.prototype.get=function(t,o){var u=new Uint8Array(this.data.buffer),v=4*this._idx(t,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[v],u[v+1],u[v+2])},bh.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},bh.prototype._idx=function(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)},bh.prototype._unpackMapbox=function(t,o,u){return(256*t*256+256*o+u)/10-1e4},bh.prototype._unpackTerrarium=function(t,o,u){return 256*t+o+u/256-32768},bh.prototype.getPixels=function(){return new Au({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},bh.prototype.backfillBorder=function(t,o,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var v=o*this.dim,y=o*this.dim+this.dim,x=u*this.dim,A=u*this.dim+this.dim;switch(o){case-1:v=y-1;break;case 1:y=v+1}switch(u){case-1:x=A-1;break;case 1:A=x+1}for(var B=-o*this.dim,te=-u*this.dim,_e=x;_e<A;_e++)for(var Ce=v;Ce<y;Ce++)this.data[this._idx(Ce,_e)]=t.data[this._idx(Ce+B,_e+te)]},oi("DEMData",bh);var Qp=function(t){this._stringToNumber={},this._numberToString=[];for(var o=0;o<t.length;o++){var u=t[o];this._stringToNumber[u]=o,this._numberToString[o]=u}};Qp.prototype.encode=function(t){return this._stringToNumber[t]},Qp.prototype.decode=function(t){return this._numberToString[t]};var hp=function(t,o,u,v,y){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=u,t._y=v,this.properties=t.properties,this.id=y},Jp={geometry:{configurable:!0}};Jp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Jp.geometry.set=function(t){this._geometry=t},hp.prototype.toJSON=function(){var t={geometry:this.geometry};for(var o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t},Object.defineProperties(hp.prototype,Jp);var kl=function(){this.state={},this.stateChanges={},this.deletedStates={}};kl.prototype.updateState=function(t,o,u){var v=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][v]=this.stateChanges[t][v]||{},J(this.stateChanges[t][v],u),this.deletedStates[t]===null)for(var y in this.deletedStates[t]={},this.state[t])y!==v&&(this.deletedStates[t][y]=null);else if(this.deletedStates[t]&&this.deletedStates[t][v]===null)for(var x in this.deletedStates[t][v]={},this.state[t][v])u[x]||(this.deletedStates[t][v][x]=null);else for(var A in u)this.deletedStates[t]&&this.deletedStates[t][v]&&this.deletedStates[t][v][A]===null&&delete this.deletedStates[t][v][A]},kl.prototype.removeFeatureState=function(t,o,u){if(this.deletedStates[t]!==null){var v=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&o!==void 0)this.deletedStates[t][v]!==null&&(this.deletedStates[t][v]=this.deletedStates[t][v]||{},this.deletedStates[t][v][u]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][v])for(u in this.deletedStates[t][v]={},this.stateChanges[t][v])this.deletedStates[t][v][u]=null;else this.deletedStates[t][v]=null;else this.deletedStates[t]=null}},kl.prototype.getState=function(t,o){var u=String(o),v=J({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){var y=this.deletedStates[t][o];if(y===null)return{};for(var x in y)delete v[x]}return v},kl.prototype.initializeTileState=function(t,o){t.setFeatureState(this.state,o)},kl.prototype.coalesceChanges=function(t,o){var u={};for(var v in this.stateChanges){this.state[v]=this.state[v]||{};var y={};for(var x in this.stateChanges[v])this.state[v][x]||(this.state[v][x]={}),J(this.state[v][x],this.stateChanges[v][x]),y[x]=this.state[v][x];u[v]=y}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var B={};if(this.deletedStates[A]===null)for(var te in this.state[A])B[te]={},this.state[A][te]={};else for(var _e in this.deletedStates[A]){if(this.deletedStates[A][_e]===null)this.state[A][_e]={};else for(var Ce=0,Ie=Object.keys(this.deletedStates[A][_e]);Ce<Ie.length;Ce+=1)delete this.state[A][_e][Ie[Ce]];B[_e]=this.state[A][_e]}u[A]=u[A]||{},J(u[A],B)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(var Xe in t)t[Xe].setFeatureState(u,o)};var tf=function(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ps(8192,16,0),this.grid3D=new ps(8192,16,0),this.featureIndexArray=new Le,this.promoteId=o};function ev(t,o,u,v,y){return Ae(t,function(x,A){var B=o instanceof ic?o.get(A):null;return B&&B.evaluate?B.evaluate(u,v,y):B})}function dp(t){for(var o=1/0,u=1/0,v=-1/0,y=-1/0,x=0,A=t;x<A.length;x+=1){var B=A[x];o=Math.min(o,B.x),u=Math.min(u,B.y),v=Math.max(v,B.x),y=Math.max(y,B.y)}return{minX:o,minY:u,maxX:v,maxY:y}}function Qm(t,o){return o-t}tf.prototype.insert=function(t,o,u,v,y,x){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,v,y);for(var B=x?this.grid3D:this.grid,te=0;te<o.length;te++){for(var _e=o[te],Ce=[1/0,1/0,-1/0,-1/0],Ie=0;Ie<_e.length;Ie++){var Xe=_e[Ie];Ce[0]=Math.min(Ce[0],Xe.x),Ce[1]=Math.min(Ce[1],Xe.y),Ce[2]=Math.max(Ce[2],Xe.x),Ce[3]=Math.max(Ce[3],Xe.y)}Ce[0]<8192&&Ce[1]<8192&&Ce[2]>=0&&Ce[3]>=0&&B.insert(A,Ce[0],Ce[1],Ce[2],Ce[3])}},tf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new jf.VectorTile(new Lr(this.rawTileData)).layers,this.sourceLayerCoder=new Qp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},tf.prototype.query=function(t,o,u,v){var y=this;this.loadVTLayers();for(var x=t.params||{},A=8192/t.tileSize/t.scale,B=nl(x.filter),te=t.queryGeometry,_e=t.queryPadding*A,Ce=dp(te),Ie=this.grid.query(Ce.minX-_e,Ce.minY-_e,Ce.maxX+_e,Ce.maxY+_e),Xe=dp(t.cameraQueryGeometry),tt=this.grid3D.query(Xe.minX-_e,Xe.minY-_e,Xe.maxX+_e,Xe.maxY+_e,function(Br,Vr,fn,Nn){return function(qn,Di,ci,ki,hi){for(var ma=0,Qi=qn;ma<Qi.length;ma+=1){var Ti=Qi[ma];if(Di<=Ti.x&&ci<=Ti.y&&ki>=Ti.x&&hi>=Ti.y)return!0}var Ji=[new F(Di,ci),new F(Di,hi),new F(ki,hi),new F(ki,ci)];if(qn.length>2){for(var ua=0,$a=Ji;ua<$a.length;ua+=1)if(xo(qn,$a[ua]))return!0}for(var ji=0;ji<qn.length-1;ji++)if(fl(qn[ji],qn[ji+1],Ji))return!0;return!1}(t.cameraQueryGeometry,Br-_e,Vr-_e,fn+_e,Nn+_e)}),Mt=0,Pt=tt;Mt<Pt.length;Mt+=1)Ie.push(Pt[Mt]);Ie.sort(Qm);for(var qt,Zt={},pr=function(Br){var Vr=Ie[Br];if(Vr!==qt){qt=Vr;var fn=y.featureIndexArray.get(Vr),Nn=null;y.loadMatchingFeature(Zt,fn.bucketIndex,fn.sourceLayerIndex,fn.featureIndex,B,x.layers,x.availableImages,o,u,v,function(qn,Di,ci){return Nn||(Nn=xi(qn)),Di.queryIntersectsFeature(te,qn,ci,Nn,y.z,t.transform,A,t.pixelPosMatrix)})}},Sr=0;Sr<Ie.length;Sr++)pr(Sr);return Zt},tf.prototype.loadMatchingFeature=function(t,o,u,v,y,x,A,B,te,_e,Ce){var Ie=this.bucketLayerIDs[o];if(!x||function(qn,Di){for(var ci=0;ci<qn.length;ci++)if(Di.indexOf(qn[ci])>=0)return!0;return!1}(x,Ie)){var Xe=this.sourceLayerCoder.decode(u),tt=this.vtLayers[Xe].feature(v);if(y.needGeometry){var Mt=Ni(tt,!0);if(!y.filter(new ea(this.tileID.overscaledZ),Mt,this.tileID.canonical))return}else if(!y.filter(new ea(this.tileID.overscaledZ),tt))return;for(var Pt=this.getId(tt,Xe),qt=0;qt<Ie.length;qt++){var Zt=Ie[qt];if(!(x&&x.indexOf(Zt)<0)){var pr=B[Zt];if(pr){var Sr={};Pt!==void 0&&_e&&(Sr=_e.getState(pr.sourceLayer||"_geojsonTileLayer",Pt));var Br=J({},te[Zt]);Br.paint=ev(Br.paint,pr.paint,tt,Sr,A),Br.layout=ev(Br.layout,pr.layout,tt,Sr,A);var Vr=!Ce||Ce(tt,pr,Sr);if(Vr){var fn=new hp(tt,this.z,this.x,this.y,Pt);fn.layer=Br;var Nn=t[Zt];Nn===void 0&&(Nn=t[Zt]=[]),Nn.push({featureIndex:v,feature:fn,intersectionZ:Vr})}}}}}},tf.prototype.lookupSymbolFeatures=function(t,o,u,v,y,x,A,B){var te={};this.loadVTLayers();for(var _e=nl(y),Ce=0,Ie=t;Ce<Ie.length;Ce+=1)this.loadMatchingFeature(te,u,v,Ie[Ce],_e,x,A,B,o);return te},tf.prototype.hasLayer=function(t){for(var o=0,u=this.bucketLayerIDs;o<u.length;o+=1)for(var v=0,y=u[o];v<y.length;v+=1)if(t===y[v])return!0;return!1},tf.prototype.getId=function(t,o){var u=t.id;return this.promoteId&&typeof(u=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]])=="boolean"&&(u=Number(u)),u},oi("FeatureIndex",tf,{omit:["rawTileData","sourceLayerCoder"]});var Cu=function(t,o){this.tileID=t,this.uid=ve(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Cu.prototype.registerFadeDuration=function(t){var o=t+this.timeAdded;o<hn.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)},Cu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Cu.prototype.loadVectorData=function(t,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var v in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(_e,Ce){var Ie={};if(!Ce)return Ie;for(var Xe=function(){var Pt=Mt[tt],qt=Pt.layerIds.map(function(Sr){return Ce.getLayer(Sr)}).filter(Boolean);if(qt.length!==0){Pt.layers=qt,Pt.stateDependentLayerIds&&(Pt.stateDependentLayers=Pt.stateDependentLayerIds.map(function(Sr){return qt.filter(function(Br){return Br.id===Sr})[0]}));for(var Zt=0,pr=qt;Zt<pr.length;Zt+=1)Ie[pr[Zt].id]=Pt}},tt=0,Mt=_e;tt<Mt.length;tt+=1)Xe();return Ie}(t.buckets,o.style),this.hasSymbolBuckets=!1,this.buckets){var y=this.buckets[v];if(y instanceof yi){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var x in this.buckets){var A=this.buckets[x];if(A instanceof yi&&A.hasRTLText){this.hasRTLText=!0,$o.isLoading()||$o.isLoaded()||Tf()!=="deferred"||Su();break}}for(var B in this.queryPadding=0,this.buckets){var te=this.buckets[B];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(B).queryRadius(te))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new d},Cu.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Cu.prototype.getBucket=function(t){return this.buckets[t.id]},Cu.prototype.upload=function(t){for(var o in this.buckets){var u=this.buckets[o];u.uploadPending()&&u.upload(t)}var v=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ad(t,this.imageAtlas.image,v.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ad(t,this.glyphAtlasImage,v.ALPHA),this.glyphAtlasImage=null)},Cu.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Cu.prototype.queryRenderedFeatures=function(t,o,u,v,y,x,A,B,te,_e){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:y,scale:x,tileSize:this.tileSize,pixelPosMatrix:_e,transform:B,params:A,queryPadding:this.queryPadding*te},t,o,u):{}},Cu.prototype.querySourceFeatures=function(t,o){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var v=u.loadVTLayers(),y=o?o.sourceLayer:"",x=v._geojsonTileLayer||v[y];if(x)for(var A=nl(o&&o.filter),B=this.tileID.canonical,te=B.z,_e=B.x,Ce=B.y,Ie={z:te,x:_e,y:Ce},Xe=0;Xe<x.length;Xe++){var tt=x.feature(Xe);if(A.needGeometry){var Mt=Ni(tt,!0);if(!A.filter(new ea(this.tileID.overscaledZ),Mt,this.tileID.canonical))continue}else if(!A.filter(new ea(this.tileID.overscaledZ),tt))continue;var Pt=u.getId(tt,y),qt=new hp(tt,te,_e,Ce,Pt);qt.tile=Ie,t.push(qt)}}},Cu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Cu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Cu.prototype.setExpiryData=function(t){var o=this.expirationTime;if(t.cacheControl){var u=je(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var v=Date.now(),y=!1;if(this.expirationTime>v)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{var x=this.expirationTime-o;x?this.expirationTime=v+Math.max(x,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Cu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Cu.prototype.setFeatureState=function(t,o){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0){var u=this.latestFeatureIndex.loadVTLayers();for(var v in this.buckets)if(o.style.hasLayer(v)){var y=this.buckets[v],x=y.layers[0].sourceLayer||"_geojsonTileLayer",A=u[x],B=t[x];if(A&&B&&Object.keys(B).length!==0){y.update(B,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var te=o&&o.style&&o.style.getLayer(v);te&&(this.queryPadding=Math.max(this.queryPadding,te.queryRadius(y)))}}}},Cu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Cu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<hn.now()},Cu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Cu.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=hn.now()+t},Cu.prototype.setDependencies=function(t,o){for(var u={},v=0,y=o;v<y.length;v+=1)u[y[v]]=!0;this.dependencies[t]=u},Cu.prototype.hasDependency=function(t,o){for(var u=0,v=t;u<v.length;u+=1){var y=this.dependencies[v[u]];if(y){for(var x=0,A=o;x<A.length;x+=1)if(y[A[x]])return!0}}return!1};var xh=V.performance,tv=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},xh.mark(this._marks.start)};tv.prototype.finish=function(){xh.mark(this._marks.end);var t=xh.getEntriesByName(this._marks.measure);return t.length===0&&(xh.measure(this._marks.measure,this._marks.start,this._marks.end),t=xh.getEntriesByName(this._marks.measure),xh.clearMarks(this._marks.start),xh.clearMarks(this._marks.end),xh.clearMeasures(this._marks.measure)),t},h.Actor=Fh,h.AlphaImage=Qc,h.CanonicalTileID=sh,h.CollisionBoxArray=d,h.Color=jr,h.DEMData=bh,h.DataConstantProperty=Ci,h.DictionaryCoder=Qp,h.EXTENT=8192,h.ErrorEvent=mt,h.EvaluationParameters=ea,h.Event=qe,h.Evented=kt,h.FeatureIndex=tf,h.FillBucket=oo,h.FillExtrusionBucket=Bu,h.ImageAtlas=cn,h.ImagePosition=ei,h.LineBucket=Yu,h.LngLat=rs,h.LngLatBounds=Vs,h.MercatorCoordinate=oh,h.ONE_EM=24,h.OverscaledTileID=Ss,h.Point=F,h.Point$1=F,h.Properties=Ro,h.Protobuf=Lr,h.RGBAImage=Au,h.RequestManager=Vt,h.RequestPerformance=tv,h.ResourceType=se,h.SegmentVector=ot,h.SourceFeatureState=kl,h.StructArrayLayout1ui2=Ra,h.StructArrayLayout2f1f2i16=yo,h.StructArrayLayout2i4=ol,h.StructArrayLayout3ui6=Ii,h.StructArrayLayout4i8=sl,h.SymbolBucket=yi,h.Texture=ad,h.Tile=Cu,h.Transitionable=Ga,h.Uniform1f=M,h.Uniform1i=nn,h.Uniform2f=z,h.Uniform3f=j,h.Uniform4f=ne,h.UniformColor=ce,h.UniformMatrix4f=lt,h.UnwrappedTileID=qp,h.ValidationError=Ge,h.WritingMode=zi,h.ZoomHistory=qs,h.add=function(t,o,u){return t[0]=o[0]+u[0],t[1]=o[1]+u[1],t[2]=o[2]+u[2],t},h.addDynamicAttributes=Sn,h.asyncAll=function(t,o,u){if(!t.length)return u(null,[]);var v=t.length,y=new Array(t.length),x=null;t.forEach(function(A,B){o(A,function(te,_e){te&&(x=te),y[B]=_e,--v==0&&u(x,y)})})},h.bezier=k,h.bindAll=Ve,h.browser=hn,h.cacheEntryPossiblyAdded=function(t){++De>Zr&&(t.getActor().send("enforceCacheSizeLimit",cr),De=0)},h.clamp=U,h.clearTileCache=function(t){var o=V.caches.delete("mapbox-tiles");t&&o.catch(t).then(function(){return t()})},h.clipLine=wc,h.clone=function(t){var o=new Ma(16);return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},h.clone$1=ee,h.clone$2=function(t){var o=new Ma(3);return o[0]=t[0],o[1]=t[1],o[2]=t[2],o},h.collisionCircleLayout=Ee,h.config=Wr,h.create=function(){var t=new Ma(16);return Ma!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},h.create$1=function(){var t=new Ma(9);return Ma!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},h.create$2=function(){var t=new Ma(4);return Ma!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},h.createCommonjsModule=O,h.createExpression=Ql,h.createLayout=No,h.createStyleLayer=function(t){return t.type==="custom"?new cp(t):new Vf[t.type](t)},h.cross=function(t,o,u){var v=o[0],y=o[1],x=o[2],A=u[0],B=u[1],te=u[2];return t[0]=y*te-x*B,t[1]=x*A-v*te,t[2]=v*B-y*A,t},h.deepEqual=function t(o,u){if(Array.isArray(o)){if(!Array.isArray(u)||o.length!==u.length)return!1;for(var v=0;v<o.length;v++)if(!t(o[v],u[v]))return!1;return!0}if(typeof o=="object"&&o!==null&&u!==null){if(typeof u!="object"||Object.keys(o).length!==Object.keys(u).length)return!1;for(var y in o)if(!t(o[y],u[y]))return!1;return!0}return o===u},h.dot=function(t,o){return t[0]*o[0]+t[1]*o[1]+t[2]*o[2]},h.dot$1=function(t,o){return t[0]*o[0]+t[1]*o[1]+t[2]*o[2]+t[3]*o[3]},h.ease=K,h.emitValidationErrors=tc,h.endsWith=Re,h.enforceCacheSizeLimit=function(t){Kr(),In&&In.then(function(o){o.keys().then(function(u){for(var v=0;v<u.length-t;v++)o.delete(u[v])})})},h.evaluateSizeForFeature=Fu,h.evaluateSizeForZoom=Zs,h.evaluateVariableOffset=nr,h.evented=Sc,h.extend=J,h.featureFilter=nl,h.filterObject=ae,h.fromRotation=function(t,o){var u=Math.sin(o),v=Math.cos(o);return t[0]=v,t[1]=u,t[2]=0,t[3]=-u,t[4]=v,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.getAnchorAlignment=Lo,h.getAnchorJustification=ur,h.getArrayBuffer=or,h.getImage=ie,h.getJSON=function(t,o){return ar(J(t,{type:"json"}),o)},h.getRTLTextPluginStatus=Tf,h.getReferrer=Ye,h.getVideo=function(t,o){var u,v,y=V.document.createElement("video");y.muted=!0,y.onloadstart=function(){o(null,y)};for(var x=0;x<t.length;x++){var A=V.document.createElement("source");u=t[x],v=void 0,(v=V.document.createElement("a")).href=u,(v.protocol!==V.document.location.protocol||v.host!==V.document.location.host)&&(y.crossOrigin="Anonymous"),A.src=t[x],y.appendChild(A)}return{cancel:function(){}}},h.identity=bs,h.invert=function(t,o){var u=o[0],v=o[1],y=o[2],x=o[3],A=o[4],B=o[5],te=o[6],_e=o[7],Ce=o[8],Ie=o[9],Xe=o[10],tt=o[11],Mt=o[12],Pt=o[13],qt=o[14],Zt=o[15],pr=u*B-v*A,Sr=u*te-y*A,Br=u*_e-x*A,Vr=v*te-y*B,fn=v*_e-x*B,Nn=y*_e-x*te,qn=Ce*Pt-Ie*Mt,Di=Ce*qt-Xe*Mt,ci=Ce*Zt-tt*Mt,ki=Ie*qt-Xe*Pt,hi=Ie*Zt-tt*Pt,ma=Xe*Zt-tt*qt,Qi=pr*ma-Sr*hi+Br*ki+Vr*ci-fn*Di+Nn*qn;return Qi?(t[0]=(B*ma-te*hi+_e*ki)*(Qi=1/Qi),t[1]=(y*hi-v*ma-x*ki)*Qi,t[2]=(Pt*Nn-qt*fn+Zt*Vr)*Qi,t[3]=(Xe*fn-Ie*Nn-tt*Vr)*Qi,t[4]=(te*ci-A*ma-_e*Di)*Qi,t[5]=(u*ma-y*ci+x*Di)*Qi,t[6]=(qt*Br-Mt*Nn-Zt*Sr)*Qi,t[7]=(Ce*Nn-Xe*Br+tt*Sr)*Qi,t[8]=(A*hi-B*ci+_e*qn)*Qi,t[9]=(v*ci-u*hi-x*qn)*Qi,t[10]=(Mt*fn-Pt*Br+Zt*pr)*Qi,t[11]=(Ie*Br-Ce*fn-tt*pr)*Qi,t[12]=(B*Di-A*ki-te*qn)*Qi,t[13]=(u*ki-v*Di+y*qn)*Qi,t[14]=(Pt*Sr-Mt*Vr-qt*pr)*Qi,t[15]=(Ce*Vr-Ie*Sr+Xe*pr)*Qi,t):null},h.isChar=zn,h.isMapboxURL=dr,h.keysDifference=function(t,o){var u=[];for(var v in t)v in o||u.push(v);return u},h.makeRequest=ar,h.mapObject=Ae,h.mercatorXfromLng=Kp,h.mercatorYfromLat=Sm,h.mercatorZfromAltitude=Tm,h.mul=rh,h.multiply=xs,h.mvt=jf,h.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},h.normalize=function(t,o){var u=o[0],v=o[1],y=o[2],x=u*u+v*v+y*y;return x>0&&(x=1/Math.sqrt(x)),t[0]=o[0]*x,t[1]=o[1]*x,t[2]=o[2]*x,t},h.number=Ai,h.offscreenCanvasSupported=X,h.ortho=function(t,o,u,v,y,x,A){var B=1/(o-u),te=1/(v-y),_e=1/(x-A);return t[0]=-2*B,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*te,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_e,t[11]=0,t[12]=(o+u)*B,t[13]=(y+v)*te,t[14]=(A+x)*_e,t[15]=1,t},h.parseGlyphPBF=function(t){return new Lr(t).readFields(En,[])},h.pbf=Lr,h.performSymbolLayout=function(t,o,u,v,y,x,A){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var B=t.layers[0].layout,te=t.layers[0]._unevaluatedLayout._values,_e={};if(t.textSizeData.kind==="composite"){var Ce=t.textSizeData,Ie=Ce.maxZoom;_e.compositeTextSizes=[te["text-size"].possiblyEvaluate(new ea(Ce.minZoom),A),te["text-size"].possiblyEvaluate(new ea(Ie),A)]}if(t.iconSizeData.kind==="composite"){var Xe=t.iconSizeData,tt=Xe.maxZoom;_e.compositeIconSizes=[te["icon-size"].possiblyEvaluate(new ea(Xe.minZoom),A),te["icon-size"].possiblyEvaluate(new ea(tt),A)]}_e.layoutTextSize=te["text-size"].possiblyEvaluate(new ea(t.zoom+1),A),_e.layoutIconSize=te["icon-size"].possiblyEvaluate(new ea(t.zoom+1),A),_e.textMaxSize=te["text-size"].possiblyEvaluate(new ea(18));for(var Mt=24*B.get("text-line-height"),Pt=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",qt=B.get("text-keep-upright"),Zt=B.get("text-size"),pr=function(){var Vr=Br[Sr],fn=B.get("text-font").evaluate(Vr,{},A).join(","),Nn=Zt.evaluate(Vr,{},A),qn=_e.layoutTextSize.evaluate(Vr,{},A),Di=_e.layoutIconSize.evaluate(Vr,{},A),ci={horizontal:{},vertical:void 0},ki=Vr.text,hi=[0,0];if(ki){var ma=ki.toString(),Qi=24*B.get("text-letter-spacing").evaluate(Vr,{},A),Ti=function(Ba){for(var So=0,_o=Ba;So<_o.length;So+=1)if(Xa=_o[So].charCodeAt(0),zn.Arabic(Xa)||zn["Arabic Supplement"](Xa)||zn["Arabic Extended-A"](Xa)||zn["Arabic Presentation Forms-A"](Xa)||zn["Arabic Presentation Forms-B"](Xa))return!1;var Xa;return!0}(ma)?Qi:0,Ji=B.get("text-anchor").evaluate(Vr,{},A),ua=B.get("text-variable-anchor");if(!ua){var $a=B.get("text-radial-offset").evaluate(Vr,{},A);hi=$a?nr(Ji,[24*$a,Kt]):B.get("text-offset").evaluate(Vr,{},A).map(function(Ba){return 24*Ba})}var ji=Pt?"center":B.get("text-justify").evaluate(Vr,{},A),no=B.get("symbol-placement"),Bo=no==="point"?24*B.get("text-max-width").evaluate(Vr,{},A):0,fs=function(){t.allowVerticalPlacement&&Du(ma)&&(ci.vertical=va(ki,o,u,y,fn,Bo,Mt,Ji,"left",Ti,hi,zi.vertical,!0,no,qn,Nn))};if(!Pt&&ua){for(var hs=ji==="auto"?ua.map(function(Ba){return ur(Ba)}):[ji],ns=!1,is=0;is<hs.length;is++){var Hs=hs[is];if(!ci.horizontal[Hs])if(ns)ci.horizontal[Hs]=ci.horizontal[0];else{var vu=va(ki,o,u,y,fn,Bo,Mt,"center",Hs,Ti,hi,zi.horizontal,!1,no,qn,Nn);vu&&(ci.horizontal[Hs]=vu,ns=vu.positionedLines.length===1)}}fs()}else{ji==="auto"&&(ji=ur(Ji));var wu=va(ki,o,u,y,fn,Bo,Mt,Ji,ji,Ti,hi,zi.horizontal,!1,no,qn,Nn);wu&&(ci.horizontal[ji]=wu),fs(),Du(ma)&&Pt&&qt&&(ci.vertical=va(ki,o,u,y,fn,Bo,Mt,Ji,ji,Ti,hi,zi.vertical,!1,no,qn,Nn))}}var Ts=void 0,dl=!1;if(Vr.icon&&Vr.icon.name){var Ps=v[Vr.icon.name];Ps&&(Ts=function(Ba,So,_o){var Xa=Lo(_o),pl=So[0]-Ba.displaySize[0]*Xa.horizontalAlign,Nu=So[1]-Ba.displaySize[1]*Xa.verticalAlign;return{image:Ba,top:Nu,bottom:Nu+Ba.displaySize[1],left:pl,right:pl+Ba.displaySize[0]}}(y[Vr.icon.name],B.get("icon-offset").evaluate(Vr,{},A),B.get("icon-anchor").evaluate(Vr,{},A)),dl=Ps.sdf,t.sdfIcons===void 0?t.sdfIcons=Ps.sdf:t.sdfIcons!==Ps.sdf&&ge("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ps.pixelRatio!==t.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}var Ru=Jt(ci.horizontal)||ci.vertical;t.iconsInText=!!Ru&&Ru.iconsInText,(Ru||Ts)&&function(Ba,So,_o,Xa,pl,Nu,jo,Ds,Ku,Ya,rf){var cc=Nu.textMaxSize.evaluate(So,{});cc===void 0&&(cc=jo);var Hf,ks=Ba.layers[0].layout,$f=ks.get("icon-offset").evaluate(So,{},rf),nf=Jt(_o.horizontal),Wf=jo/24,Eh=Ba.tilePixelRatio*Wf,od=Ba.tilePixelRatio*cc/24,Gf=Ba.tilePixelRatio*Ds,Uh=Ba.tilePixelRatio*ks.get("symbol-spacing"),Dd=ks.get("text-padding")*Ba.tilePixelRatio,sd=ks.get("icon-padding")*Ba.tilePixelRatio,kd=ks.get("text-max-angle")/180*Math.PI,pp=ks.get("text-rotation-alignment")==="map"&&ks.get("symbol-placement")!=="point",vp=ks.get("icon-rotation-alignment")==="map"&&ks.get("symbol-placement")!=="point",uh=ks.get("symbol-placement"),ud=Uh/2,ld=ks.get("icon-text-fit");Xa&&ld!=="none"&&(Ba.allowVerticalPlacement&&_o.vertical&&(Hf=zs(Xa,_o.vertical,ld,ks.get("icon-text-fit-padding"),$f,Wf)),nf&&(Xa=zs(Xa,nf,ld,ks.get("icon-text-fit-padding"),$f,Wf)));var lh=function(_p,fh){fh.x<0||fh.x>=8192||fh.y<0||fh.y>=8192||function(As,af,Nv,Rc,zd,Zd,bp,Xf,hh,jd,xp,nv,Uv,Cm,Ep,wm,Rm,Mm,iv,Sp,zc,Vd,zv,dh,Zv){var jv,fd,$h,hd,Hd,ph=As.addToLineVertexArray(af,Nv),Vv=0,Im=0,Ah=0,av=0,dd=-1,ov=-1,vh={},Wh=St(""),sv=0,uv=0;if(Xf._unevaluatedLayout.getValue("text-radial-offset")===void 0?(sv=(jv=Xf.layout.get("text-offset").evaluate(zc,{},dh).map(function(Xd){return 24*Xd}))[0],uv=jv[1]):(sv=24*Xf.layout.get("text-radial-offset").evaluate(zc,{},dh),uv=Kt),As.allowVerticalPlacement&&Rc.vertical){var Om=Xf.layout.get("text-rotate").evaluate(zc,{},dh)+90;hd=new vo(hh,af,jd,xp,nv,Rc.vertical,Uv,Cm,Ep,Om),bp&&(Hd=new vo(hh,af,jd,xp,nv,bp,Rm,Mm,Ep,Om))}if(zd){var Hv=Xf.layout.get("icon-rotate").evaluate(zc,{}),Pm=Xf.layout.get("icon-text-fit")!=="none",Dm=It(zd,Hv,zv,Pm),$v=bp?It(bp,Hv,zv,Pm):void 0;$h=new vo(hh,af,jd,xp,nv,zd,Rm,Mm,!1,Hv),Vv=4*Dm.length;var km=As.iconSizeData,Tp=null;km.kind==="source"?(Tp=[128*Xf.layout.get("icon-size").evaluate(zc,{})])[0]>32640&&ge(As.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):km.kind==="composite"&&((Tp=[128*Vd.compositeIconSizes[0].evaluate(zc,{},dh),128*Vd.compositeIconSizes[1].evaluate(zc,{},dh)])[0]>32640||Tp[1]>32640)&&ge(As.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),As.addSymbols(As.icon,Dm,Tp,Sp,iv,zc,!1,af,ph.lineStartIndex,ph.lineLength,-1,dh),dd=As.icon.placedSymbolArray.length-1,$v&&(Im=4*$v.length,As.addSymbols(As.icon,$v,Tp,Sp,iv,zc,zi.vertical,af,ph.lineStartIndex,ph.lineLength,-1,dh),ov=As.icon.placedSymbolArray.length-1)}for(var lv in Rc.horizontal){var $d=Rc.horizontal[lv];if(!fd){Wh=St($d.text);var Jm=Xf.layout.get("text-rotate").evaluate(zc,{},dh);fd=new vo(hh,af,jd,xp,nv,$d,Uv,Cm,Ep,Jm)}var Ap=$d.positionedLines.length===1;if(Ah+=Dt(As,af,$d,Zd,Xf,Ep,zc,wm,ph,Rc.vertical?zi.horizontal:zi.horizontalOnly,Ap?Object.keys(Rc.horizontal):[lv],vh,dd,Vd,dh),Ap)break}Rc.vertical&&(av+=Dt(As,af,Rc.vertical,Zd,Xf,Ep,zc,wm,ph,zi.vertical,["vertical"],vh,ov,Vd,dh));var Wd=fd?fd.boxStartIndex:As.collisionBoxArray.length,eg=fd?fd.boxEndIndex:As.collisionBoxArray.length,cv=hd?hd.boxStartIndex:As.collisionBoxArray.length,fv=hd?hd.boxEndIndex:As.collisionBoxArray.length,Gd=$h?$h.boxStartIndex:As.collisionBoxArray.length,Lm=$h?$h.boxEndIndex:As.collisionBoxArray.length,Wv=Hd?Hd.boxStartIndex:As.collisionBoxArray.length,vl=Hd?Hd.boxEndIndex:As.collisionBoxArray.length,Yf=-1,Cp=function(Xd,pd){return Xd&&Xd.circleDiameter?Math.max(Xd.circleDiameter,pd):pd};Yf=Cp(fd,Yf),Yf=Cp(hd,Yf),Yf=Cp($h,Yf);var Po=(Yf=Cp(Hd,Yf))>-1?1:0;Po&&(Yf*=Zv/24),As.glyphOffsetArray.length>=yi.MAX_GLYPHS&&ge("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zc.sortKey!==void 0&&As.addToSortKeyRanges(As.symbolInstances.length,zc.sortKey),As.symbolInstances.emplaceBack(af.x,af.y,vh.right>=0?vh.right:-1,vh.center>=0?vh.center:-1,vh.left>=0?vh.left:-1,vh.vertical||-1,dd,ov,Wh,Wd,eg,cv,fv,Gd,Lm,Wv,vl,jd,Ah,av,Vv,Im,Po,0,Uv,sv,uv,Yf)}(Ba,fh,_p,_o,Xa,pl,Hf,Ba.layers[0],Ba.collisionBoxArray,So.index,So.sourceLayerIndex,Ba.index,Eh,Dd,pp,Ku,Gf,sd,vp,$f,So,Nu,Ya,rf,jo)};if(uh==="line")for(var zh=0,Ld=wc(So.geometry,0,0,8192,8192);zh<Ld.length;zh+=1)for(var mp=Ld[zh],Bd=0,cd=Es(mp,Uh,kd,_o.vertical||nf,Xa,24,od,Ba.overscaling,8192);Bd<cd.length;Bd+=1){var gp=cd[Bd];nf&&gt(Ba,nf.text,ud,gp)||lh(mp,gp)}else if(uh==="line-center")for(var Fd=0,Nd=So.geometry;Fd<Nd.length;Fd+=1){var Zh=Nd[Fd];if(Zh.length>1){var rv=Ha(Zh,kd,_o.vertical||nf,Xa,24,od);rv&&lh(Zh,rv)}}else if(So.type==="Polygon")for(var jh=0,Ud=Io(So.geometry,0);jh<Ud.length;jh+=1){var Vh=Ud[jh],Hh=Nt(Vh,16);lh(Vh[0],new cs(Hh.x,Hh.y,0))}else if(So.type==="LineString")for(var ch=0,qu=So.geometry;ch<qu.length;ch+=1){var Sh=qu[ch];lh(Sh,new cs(Sh[0].x,Sh[0].y,0))}else if(So.type==="Point")for(var Th=0,Am=So.geometry;Th<Am.length;Th+=1)for(var yp=0,Bv=Am[Th];yp<Bv.length;yp+=1){var Fv=Bv[yp];lh([Fv],new cs(Fv.x,Fv.y,0))}}(t,Vr,ci,Ts,v,_e,qn,Di,hi,dl,A)},Sr=0,Br=t.features;Sr<Br.length;Sr+=1)pr();x&&t.generateCollisionDebugBuffers()},h.perspective=function(t,o,u,v,y){var x,A=1/Math.tan(o/2);return t[0]=A/u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,y!=null&&y!==1/0?(t[10]=(y+v)*(x=1/(v-y)),t[14]=2*y*v*x):(t[10]=-1,t[14]=-2*v),t},h.pick=function(t,o){for(var u={},v=0;v<o.length;v++){var y=o[v];y in t&&(u[y]=t[y])}return u},h.plugin=$o,h.polygonIntersectsPolygon=Mo,h.postMapLoadEvent=zt,h.postTurnstileEvent=On,h.potpack=oa,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=oi,h.registerForPluginStateChange=function(t){return t({pluginStatus:vs,pluginURL:uu}),Sc.on("pluginStateChange",t),t},h.renderColorRamp=nh,h.rotate=function(t,o,u){var v=o[0],y=o[1],x=o[2],A=o[3],B=Math.sin(u),te=Math.cos(u);return t[0]=v*te+x*B,t[1]=y*te+A*B,t[2]=v*-B+x*te,t[3]=y*-B+A*te,t},h.rotateX=function(t,o,u){var v=Math.sin(u),y=Math.cos(u),x=o[4],A=o[5],B=o[6],te=o[7],_e=o[8],Ce=o[9],Ie=o[10],Xe=o[11];return o!==t&&(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15]),t[4]=x*y+_e*v,t[5]=A*y+Ce*v,t[6]=B*y+Ie*v,t[7]=te*y+Xe*v,t[8]=_e*y-x*v,t[9]=Ce*y-A*v,t[10]=Ie*y-B*v,t[11]=Xe*y-te*v,t},h.rotateZ=function(t,o,u){var v=Math.sin(u),y=Math.cos(u),x=o[0],A=o[1],B=o[2],te=o[3],_e=o[4],Ce=o[5],Ie=o[6],Xe=o[7];return o!==t&&(t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15]),t[0]=x*y+_e*v,t[1]=A*y+Ce*v,t[2]=B*y+Ie*v,t[3]=te*y+Xe*v,t[4]=_e*y-x*v,t[5]=Ce*y-A*v,t[6]=Ie*y-B*v,t[7]=Xe*y-te*v,t},h.scale=function(t,o,u){var v=u[0],y=u[1],x=u[2];return t[0]=o[0]*v,t[1]=o[1]*v,t[2]=o[2]*v,t[3]=o[3]*v,t[4]=o[4]*y,t[5]=o[5]*y,t[6]=o[6]*y,t[7]=o[7]*y,t[8]=o[8]*x,t[9]=o[9]*x,t[10]=o[10]*x,t[11]=o[11]*x,t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},h.scale$1=function(t,o,u){return t[0]=o[0]*u,t[1]=o[1]*u,t[2]=o[2]*u,t[3]=o[3]*u,t},h.scale$2=function(t,o,u){return t[0]=o[0]*u,t[1]=o[1]*u,t[2]=o[2]*u,t},h.setCacheLimits=function(t,o){cr=t,Zr=o},h.setRTLTextPlugin=function(t,o,u){if(u===void 0&&(u=!1),vs==="deferred"||vs==="loading"||vs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");uu=hn.resolveURL(t),vs="deferred",Rl=o,Bc(),u||Su()},h.sphericalToCartesian=function(t){var o=t[0],u=t[1],v=t[2];return u+=90,u*=Math.PI/180,v*=Math.PI/180,{x:o*Math.cos(u)*Math.sin(v),y:o*Math.sin(u)*Math.sin(v),z:o*Math.cos(v)}},h.sqrLen=function(t){var o=t[0],u=t[1];return o*o+u*u},h.styleSpec=$e,h.sub=function(t,o,u){return t[0]=o[0]-u[0],t[1]=o[1]-u[1],t[2]=o[2]-u[2],t},h.symbolSize=ca,h.transformMat3=function(t,o,u){var v=o[0],y=o[1],x=o[2];return t[0]=v*u[0]+y*u[3]+x*u[6],t[1]=v*u[1]+y*u[4]+x*u[7],t[2]=v*u[2]+y*u[5]+x*u[8],t},h.transformMat4=uc,h.translate=function(t,o,u){var v,y,x,A,B,te,_e,Ce,Ie,Xe,tt,Mt,Pt=u[0],qt=u[1],Zt=u[2];return o===t?(t[12]=o[0]*Pt+o[4]*qt+o[8]*Zt+o[12],t[13]=o[1]*Pt+o[5]*qt+o[9]*Zt+o[13],t[14]=o[2]*Pt+o[6]*qt+o[10]*Zt+o[14],t[15]=o[3]*Pt+o[7]*qt+o[11]*Zt+o[15]):(y=o[1],x=o[2],A=o[3],B=o[4],te=o[5],_e=o[6],Ce=o[7],Ie=o[8],Xe=o[9],tt=o[10],Mt=o[11],t[0]=v=o[0],t[1]=y,t[2]=x,t[3]=A,t[4]=B,t[5]=te,t[6]=_e,t[7]=Ce,t[8]=Ie,t[9]=Xe,t[10]=tt,t[11]=Mt,t[12]=v*Pt+B*qt+Ie*Zt+o[12],t[13]=y*Pt+te*qt+Xe*Zt+o[13],t[14]=x*Pt+_e*qt+tt*Zt+o[14],t[15]=A*Pt+Ce*qt+Mt*Zt+o[15]),t},h.triggerPluginCompletionEvent=Sf,h.uniqueId=ve,h.validateCustomStyleLayer=function(t){var o=[],u=t.id;return u===void 0&&o.push({message:"layers."+u+': missing required property "id"'}),t.render===void 0&&o.push({message:"layers."+u+': missing required method "render"'}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&o.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),o},h.validateLight=Ff,h.validateStyle=Bs,h.values=function(t){var o=[];for(var u in t)o.push(t[u]);return o},h.vectorTile=jf,h.version="1.13.3",h.warnOnce=ge,h.webpSupported=vr,h.window=V,h.wrap=Z}),N(["./shared"],function(h){"use strict";function O(oe){var ie=typeof oe;if(ie==="number"||ie==="boolean"||ie==="string"||oe==null)return JSON.stringify(oe);if(Array.isArray(oe)){for(var be="[",ke=0,qe=oe;ke<qe.length;ke+=1)be+=O(qe[ke])+",";return be+"]"}for(var mt=Object.keys(oe).sort(),kt="{",$e=0;$e<mt.length;$e++)kt+=JSON.stringify(mt[$e])+":"+O(oe[mt[$e]])+",";return kt+"}"}function C(oe){for(var ie="",be=0,ke=h.refProperties;be<ke.length;be+=1)ie+="/"+O(oe[ke[be]]);return ie}var P=function(oe){this.keyCache={},oe&&this.replace(oe)};P.prototype.replace=function(oe){this._layerConfigs={},this._layers={},this.update(oe,[])},P.prototype.update=function(oe,ie){for(var be=this,ke=0,qe=oe;ke<qe.length;ke+=1){var mt=qe[ke];this._layerConfigs[mt.id]=mt;var kt=this._layers[mt.id]=h.createStyleLayer(mt);kt._featureFilter=h.featureFilter(kt.filter),this.keyCache[mt.id]&&delete this.keyCache[mt.id]}for(var $e=0,Ge=ie;$e<Ge.length;$e+=1){var We=Ge[$e];delete this.keyCache[We],delete this._layerConfigs[We],delete this._layers[We]}this.familiesBySource={};for(var G=0,rt=function(hr,Dr){for(var Rn={},on=0;on<hr.length;on++){var fi=Dr&&Dr[hr[on].id]||C(hr[on]);Dr&&(Dr[hr[on].id]=fi);var Mi=Rn[fi];Mi||(Mi=Rn[fi]=[]),Mi.push(hr[on])}var di=[];for(var mn in Rn)di.push(Rn[mn]);return di}(h.values(this._layerConfigs),this.keyCache);G<rt.length;G+=1){var ft=rt[G].map(function(hr){return be._layers[hr.id]}),bt=ft[0];if(bt.visibility!=="none"){var Gt=bt.source||"",lr=this.familiesBySource[Gt];lr||(lr=this.familiesBySource[Gt]={});var Ht=bt.sourceLayer||"_geojsonTileLayer",Cr=lr[Ht];Cr||(Cr=lr[Ht]=[]),Cr.push(ft)}}};var F=function(oe){var ie={},be=[];for(var ke in oe){var qe=oe[ke],mt=ie[ke]={};for(var kt in qe){var $e=qe[+kt];if($e&&$e.bitmap.width!==0&&$e.bitmap.height!==0){var Ge={x:0,y:0,w:$e.bitmap.width+2,h:$e.bitmap.height+2};be.push(Ge),mt[kt]={rect:Ge,metrics:$e.metrics}}}}var We=h.potpack(be),G=new h.AlphaImage({width:We.w||1,height:We.h||1});for(var rt in oe){var ft=oe[rt];for(var bt in ft){var Gt=ft[+bt];if(Gt&&Gt.bitmap.width!==0&&Gt.bitmap.height!==0){var lr=ie[rt][bt].rect;h.AlphaImage.copy(Gt.bitmap,G,{x:0,y:0},{x:lr.x+1,y:lr.y+1},Gt.bitmap)}}}this.image=G,this.positions=ie};h.register("GlyphAtlas",F);var Y=function(oe){this.tileID=new h.OverscaledTileID(oe.tileID.overscaledZ,oe.tileID.wrap,oe.tileID.canonical.z,oe.tileID.canonical.x,oe.tileID.canonical.y),this.uid=oe.uid,this.zoom=oe.zoom,this.pixelRatio=oe.pixelRatio,this.tileSize=oe.tileSize,this.source=oe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=oe.showCollisionBoxes,this.collectResourceTiming=!!oe.collectResourceTiming,this.returnDependencies=!!oe.returnDependencies,this.promoteId=oe.promoteId};function V(oe,ie,be){for(var ke=new h.EvaluationParameters(ie),qe=0,mt=oe;qe<mt.length;qe+=1)mt[qe].recalculate(ke,be)}function Q(oe,ie){var be=h.getArrayBuffer(oe.request,function(ke,qe,mt,kt){ke?ie(ke):qe&&ie(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(qe)),rawData:qe,cacheControl:mt,expires:kt})});return function(){be.cancel(),ie()}}Y.prototype.parse=function(oe,ie,be,ke,qe){var mt=this;this.status="parsing",this.data=oe,this.collisionBoxArray=new h.CollisionBoxArray;var kt=new h.DictionaryCoder(Object.keys(oe.layers).sort()),$e=new h.FeatureIndex(this.tileID,this.promoteId);$e.bucketLayerIDs=[];var Ge,We,G,rt,ft={},bt={featureIndex:$e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:be},Gt=ie.familiesBySource[this.source];for(var lr in Gt){var Ht=oe.layers[lr];if(Ht){Ht.version===1&&h.warnOnce('Vector tile source "'+this.source+'" layer "'+lr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Cr=kt.encode(lr),hr=[],Dr=0;Dr<Ht.length;Dr++){var Rn=Ht.feature(Dr),on=$e.getId(Rn,lr);hr.push({feature:Rn,id:on,index:Dr,sourceLayerIndex:Cr})}for(var fi=0,Mi=Gt[lr];fi<Mi.length;fi+=1){var di=Mi[fi],mn=di[0];mn.minzoom&&this.zoom<Math.floor(mn.minzoom)||mn.maxzoom&&this.zoom>=mn.maxzoom||mn.visibility!=="none"&&(V(di,this.zoom,be),(ft[mn.id]=mn.createBucket({index:$e.bucketLayerIDs.length,layers:di,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Cr,sourceID:this.source})).populate(hr,bt,this.tileID.canonical),$e.bucketLayerIDs.push(di.map(function(Zi){return Zi.id})))}}}var Zn=h.mapObject(bt.glyphDependencies,function(Zi){return Object.keys(Zi).map(Number)});Object.keys(Zn).length?ke.send("getGlyphs",{uid:this.uid,stacks:Zn},function(Zi,Oi){Ge||(Ge=Zi,We=Oi,Sa.call(mt))}):We={};var sa=Object.keys(bt.iconDependencies);sa.length?ke.send("getImages",{icons:sa,source:this.source,tileID:this.tileID,type:"icons"},function(Zi,Oi){Ge||(Ge=Zi,G=Oi,Sa.call(mt))}):G={};var qi=Object.keys(bt.patternDependencies);function Sa(){if(Ge)return qe(Ge);if(We&&G&&rt){var Zi=new F(We),Oi=new h.ImageAtlas(G,rt);for(var jr in ft){var Fi=ft[jr];Fi instanceof h.SymbolBucket?(V(Fi.layers,this.zoom,be),h.performSymbolLayout(Fi,We,Zi.positions,G,Oi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Fi.hasPattern&&(Fi instanceof h.LineBucket||Fi instanceof h.FillBucket||Fi instanceof h.FillExtrusionBucket)&&(V(Fi.layers,this.zoom,be),Fi.addFeatures(bt,this.tileID.canonical,Oi.patternPositions))}this.status="done",qe(null,{buckets:h.values(ft).filter(function(Ls){return!Ls.isEmpty()}),featureIndex:$e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Zi.image,imageAtlas:Oi,glyphMap:this.returnDependencies?We:null,iconMap:this.returnDependencies?G:null,glyphPositions:this.returnDependencies?Zi.positions:null})}}qi.length?ke.send("getImages",{icons:qi,source:this.source,tileID:this.tileID,type:"patterns"},function(Zi,Oi){Ge||(Ge=Zi,rt=Oi,Sa.call(mt))}):rt={},Sa.call(this)};var k=function(oe,ie,be,ke){this.actor=oe,this.layerIndex=ie,this.availableImages=be,this.loadVectorData=ke||Q,this.loading={},this.loaded={}};k.prototype.loadTile=function(oe,ie){var be=this,ke=oe.uid;this.loading||(this.loading={});var qe=!!(oe&&oe.request&&oe.request.collectResourceTiming)&&new h.RequestPerformance(oe.request),mt=this.loading[ke]=new Y(oe);mt.abort=this.loadVectorData(oe,function(kt,$e){if(delete be.loading[ke],kt||!$e)return mt.status="done",be.loaded[ke]=mt,ie(kt);var Ge=$e.rawData,We={};$e.expires&&(We.expires=$e.expires),$e.cacheControl&&(We.cacheControl=$e.cacheControl);var G={};if(qe){var rt=qe.finish();rt&&(G.resourceTiming=JSON.parse(JSON.stringify(rt)))}mt.vectorTile=$e.vectorTile,mt.parse($e.vectorTile,be.layerIndex,be.availableImages,be.actor,function(ft,bt){if(ft||!bt)return ie(ft);ie(null,h.extend({rawTileData:Ge.slice(0)},bt,We,G))}),be.loaded=be.loaded||{},be.loaded[ke]=mt})},k.prototype.reloadTile=function(oe,ie){var be=this,ke=this.loaded,qe=oe.uid,mt=this;if(ke&&ke[qe]){var kt=ke[qe];kt.showCollisionBoxes=oe.showCollisionBoxes;var $e=function(Ge,We){var G=kt.reloadCallback;G&&(delete kt.reloadCallback,kt.parse(kt.vectorTile,mt.layerIndex,be.availableImages,mt.actor,G)),ie(Ge,We)};kt.status==="parsing"?kt.reloadCallback=$e:kt.status==="done"&&(kt.vectorTile?kt.parse(kt.vectorTile,this.layerIndex,this.availableImages,this.actor,$e):$e())}},k.prototype.abortTile=function(oe,ie){var be=this.loading,ke=oe.uid;be&&be[ke]&&be[ke].abort&&(be[ke].abort(),delete be[ke]),ie()},k.prototype.removeTile=function(oe,ie){var be=this.loaded,ke=oe.uid;be&&be[ke]&&delete be[ke],ie()};var K=h.window.ImageBitmap,U=function(){this.loaded={}};function Z(oe,ie){if(oe.length!==0){J(oe[0],ie);for(var be=1;be<oe.length;be++)J(oe[be],!ie)}}function J(oe,ie){for(var be=0,ke=0,qe=0,mt=oe.length,kt=mt-1;qe<mt;kt=qe++){var $e=(oe[qe][0]-oe[kt][0])*(oe[kt][1]+oe[qe][1]),Ge=be+$e;ke+=Math.abs(be)>=Math.abs($e)?be-Ge+$e:$e-Ge+be,be=Ge}be+ke>=0!=!!ie&&oe.reverse()}U.prototype.loadTile=function(oe,ie){var be=oe.uid,ke=oe.encoding,qe=oe.rawImageData,mt=K&&qe instanceof K?this.getImageData(qe):qe,kt=new h.DEMData(be,mt,ke);this.loaded=this.loaded||{},this.loaded[be]=kt,ie(null,kt)},U.prototype.getImageData=function(oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(oe.width,oe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=oe.width,this.offscreenCanvas.height=oe.height,this.offscreenCanvasContext.drawImage(oe,0,0,oe.width,oe.height);var ie=this.offscreenCanvasContext.getImageData(-1,-1,oe.width+2,oe.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:ie.width,height:ie.height},ie.data)},U.prototype.removeTile=function(oe){var ie=this.loaded,be=oe.uid;ie&&ie[be]&&delete ie[be]};var H=h.vectorTile.VectorTileFeature.prototype.toGeoJSON,ve=function(oe){this._feature=oe,this.extent=h.EXTENT,this.type=oe.type,this.properties=oe.tags,"id"in oe&&!isNaN(oe.id)&&(this.id=parseInt(oe.id,10))};ve.prototype.loadGeometry=function(){if(this._feature.type===1){for(var oe=[],ie=0,be=this._feature.geometry;ie<be.length;ie+=1){var ke=be[ie];oe.push([new h.Point$1(ke[0],ke[1])])}return oe}for(var qe=[],mt=0,kt=this._feature.geometry;mt<kt.length;mt+=1){for(var $e=[],Ge=0,We=kt[mt];Ge<We.length;Ge+=1){var G=We[Ge];$e.push(new h.Point$1(G[0],G[1]))}qe.push($e)}return qe},ve.prototype.toGeoJSON=function(oe,ie,be){return H.call(this,oe,ie,be)};var Te=function(oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=oe.length,this._features=oe};Te.prototype.feature=function(oe){return new ve(this._features[oe])};var ye=h.vectorTile.VectorTileFeature,Ve=Re;function Re(oe,ie){this.options=ie||{},this.features=oe,this.length=oe.length}function Ae(oe,ie){this.id=typeof oe.id=="number"?oe.id:void 0,this.type=oe.type,this.rawGeometry=oe.type===1?[oe.geometry]:oe.geometry,this.properties=oe.tags,this.extent=ie||4096}Re.prototype.feature=function(oe){return new Ae(this.features[oe],this.options.extent)},Ae.prototype.loadGeometry=function(){var oe=this.rawGeometry;this.geometry=[];for(var ie=0;ie<oe.length;ie++){for(var be=oe[ie],ke=[],qe=0;qe<be.length;qe++)ke.push(new h.Point$1(be[qe][0],be[qe][1]));this.geometry.push(ke)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var oe=this.geometry,ie=1/0,be=-1/0,ke=1/0,qe=-1/0,mt=0;mt<oe.length;mt++)for(var kt=oe[mt],$e=0;$e<kt.length;$e++){var Ge=kt[$e];ie=Math.min(ie,Ge.x),be=Math.max(be,Ge.x),ke=Math.min(ke,Ge.y),qe=Math.max(qe,Ge.y)}return[ie,ke,be,qe]},Ae.prototype.toGeoJSON=ye.prototype.toGeoJSON;var ae=me,ee=Ve;function me(oe){var ie=new h.pbf;return function(be,ke){for(var qe in be.layers)ke.writeMessage(3,ge,be.layers[qe])}(oe,ie),ie.finish()}function ge(oe,ie){var be;ie.writeVarintField(15,oe.version||1),ie.writeStringField(1,oe.name||""),ie.writeVarintField(5,oe.extent||4096);var ke={keys:[],values:[],keycache:{},valuecache:{}};for(be=0;be<oe.length;be++)ke.feature=oe.feature(be),ie.writeMessage(2,fe,ke);var qe=ke.keys;for(be=0;be<qe.length;be++)ie.writeStringField(3,qe[be]);var mt=ke.values;for(be=0;be<mt.length;be++)ie.writeMessage(4,Pe,mt[be])}function fe(oe,ie){var be=oe.feature;be.id!==void 0&&ie.writeVarintField(1,be.id),ie.writeMessage(2,Et,oe),ie.writeVarintField(3,be.type),ie.writeMessage(4,ue,be)}function Et(oe,ie){var be=oe.feature,ke=oe.keys,qe=oe.values,mt=oe.keycache,kt=oe.valuecache;for(var $e in be.properties){var Ge=mt[$e];Ge===void 0&&(ke.push($e),mt[$e]=Ge=ke.length-1),ie.writeVarint(Ge);var We=be.properties[$e],G=typeof We;G!=="string"&&G!=="boolean"&&G!=="number"&&(We=JSON.stringify(We));var rt=G+":"+We,ft=kt[rt];ft===void 0&&(qe.push(We),kt[rt]=ft=qe.length-1),ie.writeVarint(ft)}}function xe(oe,ie){return(ie<<3)+(7&oe)}function je(oe){return oe<<1^oe>>31}function ue(oe,ie){for(var be=oe.loadGeometry(),ke=oe.type,qe=0,mt=0,kt=be.length,$e=0;$e<kt;$e++){var Ge=be[$e],We=1;ke===1&&(We=Ge.length),ie.writeVarint(xe(1,We));for(var G=ke===3?Ge.length-1:Ge.length,rt=0;rt<G;rt++){rt===1&&ke!==1&&ie.writeVarint(xe(2,G-1));var ft=Ge[rt].x-qe,bt=Ge[rt].y-mt;ie.writeVarint(je(ft)),ie.writeVarint(je(bt)),qe+=ft,mt+=bt}ke===3&&ie.writeVarint(xe(7,1))}}function Pe(oe,ie){var be=typeof oe;be==="string"?ie.writeStringField(1,oe):be==="boolean"?ie.writeBooleanField(7,oe):be==="number"&&(oe%1!=0?ie.writeDoubleField(3,oe):oe<0?ie.writeSVarintField(6,oe):ie.writeVarintField(5,oe))}function we(oe,ie,be,ke){nt(oe,be,ke),nt(ie,2*be,2*ke),nt(ie,2*be+1,2*ke+1)}function nt(oe,ie,be){var ke=oe[ie];oe[ie]=oe[be],oe[be]=ke}function at(oe,ie,be,ke){var qe=oe-be,mt=ie-ke;return qe*qe+mt*mt}ae.fromVectorTileJs=me,ae.fromGeojsonVt=function(oe,ie){ie=ie||{};var be={};for(var ke in oe)be[ke]=new Ve(oe[ke].features,ie),be[ke].name=ke,be[ke].version=ie.version,be[ke].extent=ie.extent;return me({layers:be})},ae.GeoJSONWrapper=ee;var vt=function(oe){return oe[0]},Tt=function(oe){return oe[1]},ze=function(oe,ie,be,ke,qe){ie===void 0&&(ie=vt),be===void 0&&(be=Tt),ke===void 0&&(ke=64),qe===void 0&&(qe=Float64Array),this.nodeSize=ke,this.points=oe;for(var mt=oe.length<65536?Uint16Array:Uint32Array,kt=this.ids=new mt(oe.length),$e=this.coords=new qe(2*oe.length),Ge=0;Ge<oe.length;Ge++)kt[Ge]=Ge,$e[2*Ge]=ie(oe[Ge]),$e[2*Ge+1]=be(oe[Ge]);(function We(G,rt,ft,bt,Gt,lr){if(!(Gt-bt<=ft)){var Ht=bt+Gt>>1;(function Cr(hr,Dr,Rn,on,fi,Mi){for(;fi>on;){if(fi-on>600){var di=fi-on+1,mn=Rn-on+1,Zn=Math.log(di),sa=.5*Math.exp(2*Zn/3),qi=.5*Math.sqrt(Zn*sa*(di-sa)/di)*(mn-di/2<0?-1:1);Cr(hr,Dr,Rn,Math.max(on,Math.floor(Rn-mn*sa/di+qi)),Math.min(fi,Math.floor(Rn+(di-mn)*sa/di+qi)),Mi)}var Sa=Dr[2*Rn+Mi],Zi=on,Oi=fi;for(we(hr,Dr,on,Rn),Dr[2*fi+Mi]>Sa&&we(hr,Dr,on,fi);Zi<Oi;){for(we(hr,Dr,Zi,Oi),Zi++,Oi--;Dr[2*Zi+Mi]<Sa;)Zi++;for(;Dr[2*Oi+Mi]>Sa;)Oi--}Dr[2*on+Mi]===Sa?we(hr,Dr,on,Oi):we(hr,Dr,++Oi,fi),Oi<=Rn&&(on=Oi+1),Rn<=Oi&&(fi=Oi-1)}})(G,rt,Ht,bt,Gt,lr%2),We(G,rt,ft,bt,Ht-1,lr+1),We(G,rt,ft,Ht+1,Gt,lr+1)}})(kt,$e,ke,0,kt.length-1,0)};ze.prototype.range=function(oe,ie,be,ke){return function(qe,mt,kt,$e,Ge,We,G){for(var rt,ft,bt=[0,qe.length-1,0],Gt=[];bt.length;){var lr=bt.pop(),Ht=bt.pop(),Cr=bt.pop();if(Ht-Cr<=G)for(var hr=Cr;hr<=Ht;hr++)ft=mt[2*hr+1],(rt=mt[2*hr])>=kt&&rt<=Ge&&ft>=$e&&ft<=We&&Gt.push(qe[hr]);else{var Dr=Math.floor((Cr+Ht)/2);ft=mt[2*Dr+1],(rt=mt[2*Dr])>=kt&&rt<=Ge&&ft>=$e&&ft<=We&&Gt.push(qe[Dr]);var Rn=(lr+1)%2;(lr===0?kt<=rt:$e<=ft)&&(bt.push(Cr),bt.push(Dr-1),bt.push(Rn)),(lr===0?Ge>=rt:We>=ft)&&(bt.push(Dr+1),bt.push(Ht),bt.push(Rn))}}return Gt}(this.ids,this.coords,oe,ie,be,ke,this.nodeSize)},ze.prototype.within=function(oe,ie,be){return function(ke,qe,mt,kt,$e,Ge){for(var We=[0,ke.length-1,0],G=[],rt=$e*$e;We.length;){var ft=We.pop(),bt=We.pop(),Gt=We.pop();if(bt-Gt<=Ge)for(var lr=Gt;lr<=bt;lr++)at(qe[2*lr],qe[2*lr+1],mt,kt)<=rt&&G.push(ke[lr]);else{var Ht=Math.floor((Gt+bt)/2),Cr=qe[2*Ht],hr=qe[2*Ht+1];at(Cr,hr,mt,kt)<=rt&&G.push(ke[Ht]);var Dr=(ft+1)%2;(ft===0?mt-$e<=Cr:kt-$e<=hr)&&(We.push(Gt),We.push(Ht-1),We.push(Dr)),(ft===0?mt+$e>=Cr:kt+$e>=hr)&&(We.push(Ht+1),We.push(bt),We.push(Dr))}}return G}(this.ids,this.coords,oe,ie,be,this.nodeSize)};var gr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(oe){return oe}},At=function(oe){this.options=yn(Object.create(gr),oe),this.trees=new Array(this.options.maxZoom+1)};function hn(oe,ie,be,ke,qe){return{x:oe,y:ie,zoom:1/0,id:be,parentId:-1,numPoints:ke,properties:qe}}function Wr(oe,ie){var be=oe.geometry.coordinates,ke=be[1];return{x:tn(be[0]),y:un(ke),zoom:1/0,index:ie,parentId:-1}}function vr(oe){return{type:"Feature",id:oe.id,properties:dn(oe),geometry:{type:"Point",coordinates:[(ke=oe.x,360*(ke-.5)),(ie=oe.y,be=(180-360*ie)*Math.PI/180,360*Math.atan(Math.exp(be))/Math.PI-90)]}};var ie,be,ke}function dn(oe){var ie=oe.numPoints,be=ie>=1e4?Math.round(ie/1e3)+"k":ie>=1e3?Math.round(ie/100)/10+"k":ie;return yn(yn({},oe.properties),{cluster:!0,cluster_id:oe.id,point_count:ie,point_count_abbreviated:be})}function tn(oe){return oe/360+.5}function un(oe){var ie=Math.sin(oe*Math.PI/180),be=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return be<0?0:be>1?1:be}function yn(oe,ie){for(var be in ie)oe[be]=ie[be];return oe}function Vt(oe){return oe.x}function dr(oe){return oe.y}function wt(oe,ie,be,ke,qe,mt){var kt=qe-be,$e=mt-ke;if(kt!==0||$e!==0){var Ge=((oe-be)*kt+(ie-ke)*$e)/(kt*kt+$e*$e);Ge>1?(be=qe,ke=mt):Ge>0&&(be+=kt*Ge,ke+=$e*Ge)}return(kt=oe-be)*kt+($e=ie-ke)*$e}function He(oe,ie,be,ke){var qe={id:oe===void 0?null:oe,type:ie,geometry:be,tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(mt){var kt=mt.geometry,$e=mt.type;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")wr(mt,kt);else if($e==="Polygon"||$e==="MultiLineString")for(var Ge=0;Ge<kt.length;Ge++)wr(mt,kt[Ge]);else if($e==="MultiPolygon")for(Ge=0;Ge<kt.length;Ge++)for(var We=0;We<kt[Ge].length;We++)wr(mt,kt[Ge][We])}(qe),qe}function wr(oe,ie){for(var be=0;be<ie.length;be+=3)oe.minX=Math.min(oe.minX,ie[be]),oe.minY=Math.min(oe.minY,ie[be+1]),oe.maxX=Math.max(oe.maxX,ie[be]),oe.maxY=Math.max(oe.maxY,ie[be+1])}function Ne(oe,ie,be,ke){if(ie.geometry){var qe=ie.geometry.coordinates,mt=ie.geometry.type,kt=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2),$e=[],Ge=ie.id;if(be.promoteId?Ge=ie.properties[be.promoteId]:be.generateId&&(Ge=ke||0),mt==="Point")Xr(qe,$e);else if(mt==="MultiPoint")for(var We=0;We<qe.length;We++)Xr(qe[We],$e);else if(mt==="LineString")Er(qe,$e,kt,!1);else if(mt==="MultiLineString"){if(be.lineMetrics){for(We=0;We<qe.length;We++)Er(qe[We],$e=[],kt,!1),oe.push(He(Ge,"LineString",$e,ie.properties));return}Ue(qe,$e,kt,!1)}else if(mt==="Polygon")Ue(qe,$e,kt,!0);else{if(mt!=="MultiPolygon"){if(mt==="GeometryCollection"){for(We=0;We<ie.geometry.geometries.length;We++)Ne(oe,{id:Ge,geometry:ie.geometry.geometries[We],properties:ie.properties},be,ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(We=0;We<qe.length;We++){var G=[];Ue(qe[We],G,kt,!0),$e.push(G)}}oe.push(He(Ge,mt,$e,ie.properties))}}function Xr(oe,ie){ie.push(In(oe[0])),ie.push(an(oe[1])),ie.push(0)}function Er(oe,ie,be,ke){for(var qe,mt,kt=0,$e=0;$e<oe.length;$e++){var Ge=In(oe[$e][0]),We=an(oe[$e][1]);ie.push(Ge),ie.push(We),ie.push(0),$e>0&&(kt+=ke?(qe*We-Ge*mt)/2:Math.sqrt(Math.pow(Ge-qe,2)+Math.pow(We-mt,2))),qe=Ge,mt=We}var G=ie.length-3;ie[2]=1,function rt(ft,bt,Gt,lr){for(var Ht,Cr=lr,hr=Gt-bt>>1,Dr=Gt-bt,Rn=ft[bt],on=ft[bt+1],fi=ft[Gt],Mi=ft[Gt+1],di=bt+3;di<Gt;di+=3){var mn=wt(ft[di],ft[di+1],Rn,on,fi,Mi);if(mn>Cr)Ht=di,Cr=mn;else if(mn===Cr){var Zn=Math.abs(di-hr);Zn<Dr&&(Ht=di,Dr=Zn)}}Cr>lr&&(Ht-bt>3&&rt(ft,bt,Ht,lr),ft[Ht+2]=Cr,Gt-Ht>3&&rt(ft,Ht,Gt,lr))}(ie,0,G,be),ie[G+2]=1,ie.size=Math.abs(kt),ie.start=0,ie.end=ie.size}function Ue(oe,ie,be,ke){for(var qe=0;qe<oe.length;qe++){var mt=[];Er(oe[qe],mt,be,ke),ie.push(mt)}}function In(oe){return oe/360+.5}function an(oe){var ie=Math.sin(oe*Math.PI/180),be=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return be<0?0:be>1?1:be}function Qr(oe,ie,be,ke,qe,mt,kt,$e){if(ke/=ie,mt>=(be/=ie)&&kt<ke)return oe;if(kt<be||mt>=ke)return null;for(var Ge=[],We=0;We<oe.length;We++){var G=oe[We],rt=G.geometry,ft=G.type,bt=qe===0?G.minX:G.minY,Gt=qe===0?G.maxX:G.maxY;if(bt>=be&&Gt<ke)Ge.push(G);else if(!(Gt<be||bt>=ke)){var lr=[];if(ft==="Point"||ft==="MultiPoint")Dn(rt,lr,be,ke,qe);else if(ft==="LineString")On(rt,lr,be,ke,qe,!1,$e.lineMetrics);else if(ft==="MultiLineString")zt(rt,lr,be,ke,qe,!1);else if(ft==="Polygon")zt(rt,lr,be,ke,qe,!0);else if(ft==="MultiPolygon")for(var Ht=0;Ht<rt.length;Ht++){var Cr=[];zt(rt[Ht],Cr,be,ke,qe,!0),Cr.length&&lr.push(Cr)}if(lr.length){if($e.lineMetrics&&ft==="LineString"){for(Ht=0;Ht<lr.length;Ht++)Ge.push(He(G.id,ft,lr[Ht],G.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(lr.length===1?(ft="LineString",lr=lr[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=lr.length===3?"Point":"MultiPoint"),Ge.push(He(G.id,ft,lr,G.tags))}}}return Ge.length?Ge:null}function Dn(oe,ie,be,ke,qe){for(var mt=0;mt<oe.length;mt+=3){var kt=oe[mt+qe];kt>=be&&kt<=ke&&(ie.push(oe[mt]),ie.push(oe[mt+1]),ie.push(oe[mt+2]))}}function On(oe,ie,be,ke,qe,mt,kt){for(var $e,Ge,We=ri(oe),G=qe===0?Zr:Kr,rt=oe.start,ft=0;ft<oe.length-3;ft+=3){var bt=oe[ft],Gt=oe[ft+1],lr=oe[ft+2],Ht=oe[ft+3],Cr=oe[ft+4],hr=qe===0?bt:Gt,Dr=qe===0?Ht:Cr,Rn=!1;kt&&($e=Math.sqrt(Math.pow(bt-Ht,2)+Math.pow(Gt-Cr,2))),hr<be?Dr>be&&(Ge=G(We,bt,Gt,Ht,Cr,be),kt&&(We.start=rt+$e*Ge)):hr>ke?Dr<ke&&(Ge=G(We,bt,Gt,Ht,Cr,ke),kt&&(We.start=rt+$e*Ge)):cr(We,bt,Gt,lr),Dr<be&&hr>=be&&(Ge=G(We,bt,Gt,Ht,Cr,be),Rn=!0),Dr>ke&&hr<=ke&&(Ge=G(We,bt,Gt,Ht,Cr,ke),Rn=!0),!mt&&Rn&&(kt&&(We.end=rt+$e*Ge),ie.push(We),We=ri(oe)),kt&&(rt+=$e)}var on=oe.length-3;bt=oe[on],Gt=oe[on+1],lr=oe[on+2],(hr=qe===0?bt:Gt)>=be&&hr<=ke&&cr(We,bt,Gt,lr),on=We.length-3,mt&&on>=3&&(We[on]!==We[0]||We[on+1]!==We[1])&&cr(We,We[0],We[1],We[2]),We.length&&ie.push(We)}function ri(oe){var ie=[];return ie.size=oe.size,ie.start=oe.start,ie.end=oe.end,ie}function zt(oe,ie,be,ke,qe,mt){for(var kt=0;kt<oe.length;kt++)On(oe[kt],ie,be,ke,qe,mt,!1)}function cr(oe,ie,be,ke){oe.push(ie),oe.push(be),oe.push(ke)}function Zr(oe,ie,be,ke,qe,mt){var kt=(mt-ie)/(ke-ie);return oe.push(mt),oe.push(be+(qe-be)*kt),oe.push(1),kt}function Kr(oe,ie,be,ke,qe,mt){var kt=(mt-be)/(qe-be);return oe.push(ie+(ke-ie)*kt),oe.push(mt),oe.push(1),kt}function en(oe,ie){for(var be=[],ke=0;ke<oe.length;ke++){var qe,mt=oe[ke],kt=mt.type;if(kt==="Point"||kt==="MultiPoint"||kt==="LineString")qe=Wn(mt.geometry,ie);else if(kt==="MultiLineString"||kt==="Polygon"){qe=[];for(var $e=0;$e<mt.geometry.length;$e++)qe.push(Wn(mt.geometry[$e],ie))}else if(kt==="MultiPolygon")for(qe=[],$e=0;$e<mt.geometry.length;$e++){for(var Ge=[],We=0;We<mt.geometry[$e].length;We++)Ge.push(Wn(mt.geometry[$e][We],ie));qe.push(Ge)}be.push(He(mt.id,kt,qe,mt.tags))}return be}function Wn(oe,ie){var be=[];be.size=oe.size,oe.start!==void 0&&(be.start=oe.start,be.end=oe.end);for(var ke=0;ke<oe.length;ke+=3)be.push(oe[ke]+ie,oe[ke+1],oe[ke+2]);return be}function De(oe,ie){if(oe.transformed)return oe;var be,ke,qe,mt=1<<oe.z,kt=oe.x,$e=oe.y;for(be=0;be<oe.features.length;be++){var Ge=oe.features[be],We=Ge.geometry,G=Ge.type;if(Ge.geometry=[],G===1)for(ke=0;ke<We.length;ke+=2)Ge.geometry.push(X(We[ke],We[ke+1],ie,mt,kt,$e));else for(ke=0;ke<We.length;ke++){var rt=[];for(qe=0;qe<We[ke].length;qe+=2)rt.push(X(We[ke][qe],We[ke][qe+1],ie,mt,kt,$e));Ge.geometry.push(rt)}}return oe.transformed=!0,oe}function X(oe,ie,be,ke,qe,mt){return[Math.round(be*(oe*ke-qe)),Math.round(be*(ie*ke-mt))]}function se(oe,ie,be,ke,qe){for(var mt=ie===qe.maxZoom?0:qe.tolerance/((1<<ie)*qe.extent),kt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:be,y:ke,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$e=0;$e<oe.length;$e++){kt.numFeatures++,Be(kt,oe[$e],mt,qe);var Ge=oe[$e].minX,We=oe[$e].minY,G=oe[$e].maxX,rt=oe[$e].maxY;Ge<kt.minX&&(kt.minX=Ge),We<kt.minY&&(kt.minY=We),G>kt.maxX&&(kt.maxX=G),rt>kt.maxY&&(kt.maxY=rt)}return kt}function Be(oe,ie,be,ke){var qe=ie.geometry,mt=ie.type,kt=[];if(mt==="Point"||mt==="MultiPoint")for(var $e=0;$e<qe.length;$e+=3)kt.push(qe[$e]),kt.push(qe[$e+1]),oe.numPoints++,oe.numSimplified++;else if(mt==="LineString")Ye(kt,qe,oe,be,!1,!1);else if(mt==="MultiLineString"||mt==="Polygon")for($e=0;$e<qe.length;$e++)Ye(kt,qe[$e],oe,be,mt==="Polygon",$e===0);else if(mt==="MultiPolygon")for(var Ge=0;Ge<qe.length;Ge++){var We=qe[Ge];for($e=0;$e<We.length;$e++)Ye(kt,We[$e],oe,be,!0,$e===0)}if(kt.length){var G=ie.tags||null;if(mt==="LineString"&&ke.lineMetrics){for(var rt in G={},ie.tags)G[rt]=ie.tags[rt];G.mapbox_clip_start=qe.start/qe.size,G.mapbox_clip_end=qe.end/qe.size}var ft={geometry:kt,type:mt==="Polygon"||mt==="MultiPolygon"?3:mt==="LineString"||mt==="MultiLineString"?2:1,tags:G};ie.id!==null&&(ft.id=ie.id),oe.features.push(ft)}}function Ye(oe,ie,be,ke,qe,mt){var kt=ke*ke;if(ke>0&&ie.size<(qe?kt:ke))be.numPoints+=ie.length/3;else{for(var $e=[],Ge=0;Ge<ie.length;Ge+=3)(ke===0||ie[Ge+2]>kt)&&(be.numSimplified++,$e.push(ie[Ge]),$e.push(ie[Ge+1])),be.numPoints++;qe&&function(We,G){for(var rt=0,ft=0,bt=We.length,Gt=bt-2;ft<bt;Gt=ft,ft+=2)rt+=(We[ft]-We[Gt])*(We[ft+1]+We[Gt+1]);if(rt>0===G)for(ft=0,bt=We.length;ft<bt/2;ft+=2){var lr=We[ft],Ht=We[ft+1];We[ft]=We[bt-2-ft],We[ft+1]=We[bt-1-ft],We[bt-2-ft]=lr,We[bt-1-ft]=Ht}}($e,mt),oe.push($e)}}function ct(oe,ie){var be=(ie=this.options=function(qe,mt){for(var kt in mt)qe[kt]=mt[kt];return qe}(Object.create(this.options),ie)).debug;if(be&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var ke=function(qe,mt){var kt=[];if(qe.type==="FeatureCollection")for(var $e=0;$e<qe.features.length;$e++)Ne(kt,qe.features[$e],mt,$e);else Ne(kt,qe.type==="Feature"?qe:{geometry:qe},mt);return kt}(oe,ie);this.tiles={},this.tileCoords=[],be&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ke=function(qe,mt){var kt=mt.buffer/mt.extent,$e=qe,Ge=Qr(qe,1,-1-kt,kt,0,-1,2,mt),We=Qr(qe,1,1-kt,2+kt,0,-1,2,mt);return(Ge||We)&&($e=Qr(qe,1,-kt,1+kt,0,-1,2,mt)||[],Ge&&($e=en(Ge,1).concat($e)),We&&($e=$e.concat(en(We,-1)))),$e}(ke,ie)).length&&this.splitTile(ke,0,0,0),be&&(ke.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function sr(oe,ie,be){return 32*((1<<oe)*be+ie)+oe}function ar(oe,ie){var be=oe.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);var ke=this._geoJSONIndex.getTile(be.z,be.x,be.y);if(!ke)return ie(null,null);var qe=new Te(ke.features),mt=ae(qe);mt.byteOffset===0&&mt.byteLength===mt.buffer.byteLength||(mt=new Uint8Array(mt)),ie(null,{vectorTile:qe,rawData:mt.buffer})}At.prototype.load=function(oe){var ie=this.options,be=ie.log,ke=ie.minZoom,qe=ie.maxZoom,mt=ie.nodeSize;be&&console.time("total time");var kt="prepare "+oe.length+" points";be&&console.time(kt),this.points=oe;for(var $e=[],Ge=0;Ge<oe.length;Ge++)oe[Ge].geometry&&$e.push(Wr(oe[Ge],Ge));this.trees[qe+1]=new ze($e,Vt,dr,mt,Float32Array),be&&console.timeEnd(kt);for(var We=qe;We>=ke;We--){var G=+Date.now();$e=this._cluster($e,We),this.trees[We]=new ze($e,Vt,dr,mt,Float32Array),be&&console.log("z%d: %d clusters in %dms",We,$e.length,+Date.now()-G)}return be&&console.timeEnd("total time"),this},At.prototype.getClusters=function(oe,ie){var be=((oe[0]+180)%360+360)%360-180,ke=Math.max(-90,Math.min(90,oe[1])),qe=oe[2]===180?180:((oe[2]+180)%360+360)%360-180,mt=Math.max(-90,Math.min(90,oe[3]));if(oe[2]-oe[0]>=360)be=-180,qe=180;else if(be>qe){var kt=this.getClusters([be,ke,180,mt],ie),$e=this.getClusters([-180,ke,qe,mt],ie);return kt.concat($e)}for(var Ge=this.trees[this._limitZoom(ie)],We=[],G=0,rt=Ge.range(tn(be),un(mt),tn(qe),un(ke));G<rt.length;G+=1){var ft=Ge.points[rt[G]];We.push(ft.numPoints?vr(ft):this.points[ft.index])}return We},At.prototype.getChildren=function(oe){var ie=this._getOriginId(oe),be=this._getOriginZoom(oe),ke="No cluster with the specified id.",qe=this.trees[be];if(!qe)throw new Error(ke);var mt=qe.points[ie];if(!mt)throw new Error(ke);for(var kt=this.options.radius/(this.options.extent*Math.pow(2,be-1)),$e=[],Ge=0,We=qe.within(mt.x,mt.y,kt);Ge<We.length;Ge+=1){var G=qe.points[We[Ge]];G.parentId===oe&&$e.push(G.numPoints?vr(G):this.points[G.index])}if($e.length===0)throw new Error(ke);return $e},At.prototype.getLeaves=function(oe,ie,be){var ke=[];return this._appendLeaves(ke,oe,ie=ie||10,be=be||0,0),ke},At.prototype.getTile=function(oe,ie,be){var ke=this.trees[this._limitZoom(oe)],qe=Math.pow(2,oe),mt=this.options,kt=mt.radius/mt.extent,$e=(be-kt)/qe,Ge=(be+1+kt)/qe,We={features:[]};return this._addTileFeatures(ke.range((ie-kt)/qe,$e,(ie+1+kt)/qe,Ge),ke.points,ie,be,qe,We),ie===0&&this._addTileFeatures(ke.range(1-kt/qe,$e,1,Ge),ke.points,qe,be,qe,We),ie===qe-1&&this._addTileFeatures(ke.range(0,$e,kt/qe,Ge),ke.points,-1,be,qe,We),We.features.length?We:null},At.prototype.getClusterExpansionZoom=function(oe){for(var ie=this._getOriginZoom(oe)-1;ie<=this.options.maxZoom;){var be=this.getChildren(oe);if(ie++,be.length!==1)break;oe=be[0].properties.cluster_id}return ie},At.prototype._appendLeaves=function(oe,ie,be,ke,qe){for(var mt=0,kt=this.getChildren(ie);mt<kt.length;mt+=1){var $e=kt[mt],Ge=$e.properties;if(Ge&&Ge.cluster?qe+Ge.point_count<=ke?qe+=Ge.point_count:qe=this._appendLeaves(oe,Ge.cluster_id,be,ke,qe):qe<ke?qe++:oe.push($e),oe.length===be)break}return qe},At.prototype._addTileFeatures=function(oe,ie,be,ke,qe,mt){for(var kt=0,$e=oe;kt<$e.length;kt+=1){var Ge=ie[$e[kt]],We=Ge.numPoints,G={type:1,geometry:[[Math.round(this.options.extent*(Ge.x*qe-be)),Math.round(this.options.extent*(Ge.y*qe-ke))]],tags:We?dn(Ge):this.points[Ge.index].properties},rt=void 0;We?rt=Ge.id:this.options.generateId?rt=Ge.index:this.points[Ge.index].id&&(rt=this.points[Ge.index].id),rt!==void 0&&(G.id=rt),mt.features.push(G)}},At.prototype._limitZoom=function(oe){return Math.max(this.options.minZoom,Math.min(+oe,this.options.maxZoom+1))},At.prototype._cluster=function(oe,ie){for(var be=[],ke=this.options,qe=ke.reduce,mt=ke.minPoints,kt=ke.radius/(ke.extent*Math.pow(2,ie)),$e=0;$e<oe.length;$e++){var Ge=oe[$e];if(!(Ge.zoom<=ie)){Ge.zoom=ie;for(var We=this.trees[ie+1],G=We.within(Ge.x,Ge.y,kt),rt=Ge.numPoints||1,ft=rt,bt=0,Gt=G;bt<Gt.length;bt+=1){var lr=We.points[Gt[bt]];lr.zoom>ie&&(ft+=lr.numPoints||1)}if(ft>=mt){for(var Ht=Ge.x*rt,Cr=Ge.y*rt,hr=qe&&rt>1?this._map(Ge,!0):null,Dr=($e<<5)+(ie+1)+this.points.length,Rn=0,on=G;Rn<on.length;Rn+=1){var fi=We.points[on[Rn]];if(!(fi.zoom<=ie)){fi.zoom=ie;var Mi=fi.numPoints||1;Ht+=fi.x*Mi,Cr+=fi.y*Mi,fi.parentId=Dr,qe&&(hr||(hr=this._map(Ge,!0)),qe(hr,this._map(fi)))}}Ge.parentId=Dr,be.push(hn(Ht/ft,Cr/ft,Dr,ft,hr))}else if(be.push(Ge),ft>1)for(var di=0,mn=G;di<mn.length;di+=1){var Zn=We.points[mn[di]];Zn.zoom<=ie||(Zn.zoom=ie,be.push(Zn))}}}return be},At.prototype._getOriginId=function(oe){return oe-this.points.length>>5},At.prototype._getOriginZoom=function(oe){return(oe-this.points.length)%32},At.prototype._map=function(oe,ie){if(oe.numPoints)return ie?yn({},oe.properties):oe.properties;var be=this.points[oe.index].properties,ke=this.options.map(be);return ie&&ke===be?yn({},ke):ke},ct.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ct.prototype.splitTile=function(oe,ie,be,ke,qe,mt,kt){for(var $e=[oe,ie,be,ke],Ge=this.options,We=Ge.debug;$e.length;){ke=$e.pop(),be=$e.pop(),ie=$e.pop(),oe=$e.pop();var G=1<<ie,rt=sr(ie,be,ke),ft=this.tiles[rt];if(!ft&&(We>1&&console.time("creation"),ft=this.tiles[rt]=se(oe,ie,be,ke,Ge),this.tileCoords.push({z:ie,x:be,y:ke}),We)){We>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,be,ke,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));var bt="z"+ie;this.stats[bt]=(this.stats[bt]||0)+1,this.total++}if(ft.source=oe,qe){if(ie===Ge.maxZoom||ie===qe)continue;var Gt=1<<qe-ie;if(be!==Math.floor(mt/Gt)||ke!==Math.floor(kt/Gt))continue}else if(ie===Ge.indexMaxZoom||ft.numPoints<=Ge.indexMaxPoints)continue;if(ft.source=null,oe.length!==0){We>1&&console.time("clipping");var lr,Ht,Cr,hr,Dr,Rn,on=.5*Ge.buffer/Ge.extent,fi=.5-on,Mi=.5+on,di=1+on;lr=Ht=Cr=hr=null,Dr=Qr(oe,G,be-on,be+Mi,0,ft.minX,ft.maxX,Ge),Rn=Qr(oe,G,be+fi,be+di,0,ft.minX,ft.maxX,Ge),oe=null,Dr&&(lr=Qr(Dr,G,ke-on,ke+Mi,1,ft.minY,ft.maxY,Ge),Ht=Qr(Dr,G,ke+fi,ke+di,1,ft.minY,ft.maxY,Ge),Dr=null),Rn&&(Cr=Qr(Rn,G,ke-on,ke+Mi,1,ft.minY,ft.maxY,Ge),hr=Qr(Rn,G,ke+fi,ke+di,1,ft.minY,ft.maxY,Ge),Rn=null),We>1&&console.timeEnd("clipping"),$e.push(lr||[],ie+1,2*be,2*ke),$e.push(Ht||[],ie+1,2*be,2*ke+1),$e.push(Cr||[],ie+1,2*be+1,2*ke),$e.push(hr||[],ie+1,2*be+1,2*ke+1)}}},ct.prototype.getTile=function(oe,ie,be){var ke=this.options,qe=ke.extent,mt=ke.debug;if(oe<0||oe>24)return null;var kt=1<<oe,$e=sr(oe,ie=(ie%kt+kt)%kt,be);if(this.tiles[$e])return De(this.tiles[$e],qe);mt>1&&console.log("drilling down to z%d-%d-%d",oe,ie,be);for(var Ge,We=oe,G=ie,rt=be;!Ge&&We>0;)We--,G=Math.floor(G/2),rt=Math.floor(rt/2),Ge=this.tiles[sr(We,G,rt)];return Ge&&Ge.source?(mt>1&&console.log("found parent tile z%d-%d-%d",We,G,rt),mt>1&&console.time("drilling down"),this.splitTile(Ge.source,We,G,rt,oe,ie,be),mt>1&&console.timeEnd("drilling down"),this.tiles[$e]?De(this.tiles[$e],qe):null):null};var or=function(oe){function ie(be,ke,qe,mt){oe.call(this,be,ke,qe,ar),mt&&(this.loadGeoJSON=mt)}return oe&&(ie.__proto__=oe),(ie.prototype=Object.create(oe&&oe.prototype)).constructor=ie,ie.prototype.loadData=function(be,ke){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ke,this._pendingLoadDataParams=be,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},ie.prototype._loadData=function(){var be=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ke=this._pendingCallback,qe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var mt=!!(qe&&qe.request&&qe.request.collectResourceTiming)&&new h.RequestPerformance(qe.request);this.loadGeoJSON(qe,function(kt,$e){if(kt||!$e)return ke(kt);if(typeof $e!="object")return ke(new Error("Input data given to '"+qe.source+"' is not a valid GeoJSON object."));(function ft(bt,Gt){var lr,Ht=bt&&bt.type;if(Ht==="FeatureCollection")for(lr=0;lr<bt.features.length;lr++)ft(bt.features[lr],Gt);else if(Ht==="GeometryCollection")for(lr=0;lr<bt.geometries.length;lr++)ft(bt.geometries[lr],Gt);else if(Ht==="Feature")ft(bt.geometry,Gt);else if(Ht==="Polygon")Z(bt.coordinates,Gt);else if(Ht==="MultiPolygon")for(lr=0;lr<bt.coordinates.length;lr++)Z(bt.coordinates[lr],Gt);return bt})($e,!0);try{if(qe.filter){var Ge=h.createExpression(qe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(function(ft){return ft.key+": "+ft.message}).join(", "));var We=$e.features.filter(function(ft){return Ge.value.evaluate({zoom:0},ft)});$e={type:"FeatureCollection",features:We}}be._geoJSONIndex=qe.cluster?new At(function(ft){var bt=ft.superclusterOptions,Gt=ft.clusterProperties;if(!Gt||!bt)return bt;for(var lr={},Ht={},Cr={accumulated:null,zoom:0},hr={properties:null},Dr=Object.keys(Gt),Rn=0,on=Dr;Rn<on.length;Rn+=1){var fi=on[Rn],Mi=Gt[fi],di=Mi[0],mn=h.createExpression(Mi[1]),Zn=h.createExpression(typeof di=="string"?[di,["accumulated"],["get",fi]]:di);lr[fi]=mn.value,Ht[fi]=Zn.value}return bt.map=function(sa){hr.properties=sa;for(var qi={},Sa=0,Zi=Dr;Sa<Zi.length;Sa+=1){var Oi=Zi[Sa];qi[Oi]=lr[Oi].evaluate(Cr,hr)}return qi},bt.reduce=function(sa,qi){hr.properties=qi;for(var Sa=0,Zi=Dr;Sa<Zi.length;Sa+=1){var Oi=Zi[Sa];Cr.accumulated=sa[Oi],sa[Oi]=Ht[Oi].evaluate(Cr,hr)}},bt}(qe)).load($e.features):function(ft,bt){return new ct(ft,bt)}($e,qe.geojsonVtOptions)}catch(ft){return ke(ft)}be.loaded={};var G={};if(mt){var rt=mt.finish();rt&&(G.resourceTiming={},G.resourceTiming[qe.source]=JSON.parse(JSON.stringify(rt)))}ke(null,G)})}},ie.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},ie.prototype.reloadTile=function(be,ke){var qe=this.loaded;return qe&&qe[be.uid]?oe.prototype.reloadTile.call(this,be,ke):this.loadTile(be,ke)},ie.prototype.loadGeoJSON=function(be,ke){if(be.request)h.getJSON(be.request,ke);else{if(typeof be.data!="string")return ke(new Error("Input data given to '"+be.source+"' is not a valid GeoJSON object."));try{return ke(null,JSON.parse(be.data))}catch(qe){return ke(new Error("Input data given to '"+be.source+"' is not a valid GeoJSON object."))}}},ie.prototype.removeSource=function(be,ke){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ke()},ie.prototype.getClusterExpansionZoom=function(be,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(be.clusterId))}catch(qe){ke(qe)}},ie.prototype.getClusterChildren=function(be,ke){try{ke(null,this._geoJSONIndex.getChildren(be.clusterId))}catch(qe){ke(qe)}},ie.prototype.getClusterLeaves=function(be,ke){try{ke(null,this._geoJSONIndex.getLeaves(be.clusterId,be.limit,be.offset))}catch(qe){ke(qe)}},ie}(k),Wt=function(oe){var ie=this;this.self=oe,this.actor=new h.Actor(oe,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:k,geojson:or},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(be,ke){if(ie.workerSourceTypes[be])throw new Error('Worker source with name "'+be+'" already registered.');ie.workerSourceTypes[be]=ke},this.self.registerRTLTextPlugin=function(be){if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=be.applyArabicShaping,h.plugin.processBidirectionalText=be.processBidirectionalText,h.plugin.processStyledBidirectionalText=be.processStyledBidirectionalText}};return Wt.prototype.setReferrer=function(oe,ie){this.referrer=ie},Wt.prototype.setImages=function(oe,ie,be){for(var ke in this.availableImages[oe]=ie,this.workerSources[oe]){var qe=this.workerSources[oe][ke];for(var mt in qe)qe[mt].availableImages=ie}be()},Wt.prototype.setLayers=function(oe,ie,be){this.getLayerIndex(oe).replace(ie),be()},Wt.prototype.updateLayers=function(oe,ie,be){this.getLayerIndex(oe).update(ie.layers,ie.removedIds),be()},Wt.prototype.loadTile=function(oe,ie,be){this.getWorkerSource(oe,ie.type,ie.source).loadTile(ie,be)},Wt.prototype.loadDEMTile=function(oe,ie,be){this.getDEMWorkerSource(oe,ie.source).loadTile(ie,be)},Wt.prototype.reloadTile=function(oe,ie,be){this.getWorkerSource(oe,ie.type,ie.source).reloadTile(ie,be)},Wt.prototype.abortTile=function(oe,ie,be){this.getWorkerSource(oe,ie.type,ie.source).abortTile(ie,be)},Wt.prototype.removeTile=function(oe,ie,be){this.getWorkerSource(oe,ie.type,ie.source).removeTile(ie,be)},Wt.prototype.removeDEMTile=function(oe,ie){this.getDEMWorkerSource(oe,ie.source).removeTile(ie)},Wt.prototype.removeSource=function(oe,ie,be){if(this.workerSources[oe]&&this.workerSources[oe][ie.type]&&this.workerSources[oe][ie.type][ie.source]){var ke=this.workerSources[oe][ie.type][ie.source];delete this.workerSources[oe][ie.type][ie.source],ke.removeSource!==void 0?ke.removeSource(ie,be):be()}},Wt.prototype.loadWorkerSource=function(oe,ie,be){try{this.self.importScripts(ie.url),be()}catch(ke){be(ke.toString())}},Wt.prototype.syncRTLPluginState=function(oe,ie,be){try{h.plugin.setState(ie);var ke=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&ke!=null){this.self.importScripts(ke);var qe=h.plugin.isParsed();be(qe?void 0:new Error("RTL Text Plugin failed to import scripts from "+ke),qe)}}catch(mt){be(mt.toString())}},Wt.prototype.getAvailableImages=function(oe){var ie=this.availableImages[oe];return ie||(ie=[]),ie},Wt.prototype.getLayerIndex=function(oe){var ie=this.layerIndexes[oe];return ie||(ie=this.layerIndexes[oe]=new P),ie},Wt.prototype.getWorkerSource=function(oe,ie,be){var ke=this;return this.workerSources[oe]||(this.workerSources[oe]={}),this.workerSources[oe][ie]||(this.workerSources[oe][ie]={}),this.workerSources[oe][ie][be]||(this.workerSources[oe][ie][be]=new this.workerSourceTypes[ie]({send:function(qe,mt,kt){ke.actor.send(qe,mt,kt,oe)}},this.getLayerIndex(oe),this.getAvailableImages(oe))),this.workerSources[oe][ie][be]},Wt.prototype.getDEMWorkerSource=function(oe,ie){return this.demWorkerSources[oe]||(this.demWorkerSources[oe]={}),this.demWorkerSources[oe][ie]||(this.demWorkerSources[oe][ie]=new U),this.demWorkerSources[oe][ie]},Wt.prototype.enforceCacheSizeLimit=function(oe,ie){h.enforceCacheSizeLimit(ie)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Wt(self)),Wt}),N(["./shared"],function(h){"use strict";var O=h.createCommonjsModule(function(l){function d(S){return!f(S)}function f(S){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,q,Se=new Blob([""],{type:"text/javascript"}),Le=URL.createObjectURL(Se);try{q=new Worker(Le),L=!0}catch(et){L=!1}return q&&q.terminate(),URL.revokeObjectURL(Le),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var q=L.getContext("2d");if(!q)return!1;var Se=q.getImageData(0,0,1,1);return Se&&Se.width===L.width}()?(m[R=S&&S.failIfMajorPerformanceCaveat]===void 0&&(m[R]=function(L){var q=function(Le){var et=document.createElement("canvas"),ot=Object.create(d.webGLContextAttributes);return ot.failIfMajorPerformanceCaveat=Le,et.probablySupportsContext?et.probablySupportsContext("webgl",ot)||et.probablySupportsContext("experimental-webgl",ot):et.supportsContext?et.supportsContext("webgl",ot)||et.supportsContext("experimental-webgl",ot):et.getContext("webgl",ot)||et.getContext("experimental-webgl",ot)}(L);if(!q)return!1;var Se=q.createShader(q.VERTEX_SHADER);return!(!Se||q.isContextLost())&&(q.shaderSource(Se,"void main() {}"),q.compileShader(Se),q.getShaderParameter(Se,q.COMPILE_STATUS)===!0)}(R)),m[R]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var R}l.exports?l.exports=d:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=d,window.mapboxgl.notSupportedReason=f);var m={};d.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),C={create:function(l,d,f){var m=h.window.document.createElement(l);return d!==void 0&&(m.className=d),f&&f.appendChild(m),m},createNS:function(l,d){return h.window.document.createElementNS(l,d)}},P=h.window.document&&h.window.document.documentElement.style;function F(l){if(!P)return l[0];for(var d=0;d<l.length;d++)if(l[d]in P)return l[d];return l[0]}var Y,V=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);C.disableDrag=function(){P&&V&&(Y=P[V],P[V]="none")},C.enableDrag=function(){P&&V&&(P[V]=Y)};var Q=F(["transform","WebkitTransform"]);C.setTransform=function(l,d){l.style[Q]=d};var k=!1;try{var K=Object.defineProperty({},"passive",{get:function(){k=!0}});h.window.addEventListener("test",K,K),h.window.removeEventListener("test",K,K)}catch(l){k=!1}C.addEventListener=function(l,d,f,m){m===void 0&&(m={}),l.addEventListener(d,f,"passive"in m&&k?m:m.capture)},C.removeEventListener=function(l,d,f,m){m===void 0&&(m={}),l.removeEventListener(d,f,"passive"in m&&k?m:m.capture)};var U=function(l){l.preventDefault(),l.stopPropagation(),h.window.removeEventListener("click",U,!0)};function Z(l){var d=l.userImage;return!!(d&&d.render&&d.render())&&(l.data.replace(new Uint8Array(d.data.buffer)),!0)}C.suppressClick=function(){h.window.addEventListener("click",U,!0),h.window.setTimeout(function(){h.window.removeEventListener("click",U,!0)},0)},C.mousePos=function(l,d){var f=l.getBoundingClientRect();return new h.Point(d.clientX-f.left-l.clientLeft,d.clientY-f.top-l.clientTop)},C.touchPos=function(l,d){for(var f=l.getBoundingClientRect(),m=[],S=0;S<d.length;S++)m.push(new h.Point(d[S].clientX-f.left-l.clientLeft,d[S].clientY-f.top-l.clientTop));return m},C.mouseButton=function(l){return h.window.InstallTrigger!==void 0&&l.button===2&&l.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},C.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var J=function(l){function d(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.isLoaded=function(){return this.loaded},d.prototype.setLoaded=function(f){if(this.loaded!==f&&(this.loaded=f,f)){for(var m=0,S=this.requestors;m<S.length;m+=1){var R=S[m];this._notify(R.ids,R.callback)}this.requestors=[]}},d.prototype.getImage=function(f){return this.images[f]},d.prototype.addImage=function(f,m){this._validate(f,m)&&(this.images[f]=m)},d.prototype._validate=function(f,m){var S=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new h.ErrorEvent(new Error('Image "'+f+'" has invalid "stretchX" value'))),S=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new h.ErrorEvent(new Error('Image "'+f+'" has invalid "stretchY" value'))),S=!1),this._validateContent(m.content,m)||(this.fire(new h.ErrorEvent(new Error('Image "'+f+'" has invalid "content" value'))),S=!1),S},d.prototype._validateStretch=function(f,m){if(!f)return!0;for(var S=0,R=0,L=f;R<L.length;R+=1){var q=L[R];if(q[0]<S||q[1]<q[0]||m<q[1])return!1;S=q[1]}return!0},d.prototype._validateContent=function(f,m){return!(f&&(f.length!==4||f[0]<0||m.data.width<f[0]||f[1]<0||m.data.height<f[1]||f[2]<0||m.data.width<f[2]||f[3]<0||m.data.height<f[3]||f[2]<f[0]||f[3]<f[1]))},d.prototype.updateImage=function(f,m){m.version=this.images[f].version+1,this.images[f]=m,this.updatedImages[f]=!0},d.prototype.removeImage=function(f){var m=this.images[f];delete this.images[f],delete this.patterns[f],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()},d.prototype.listImages=function(){return Object.keys(this.images)},d.prototype.getImages=function(f,m){var S=!0;if(!this.isLoaded())for(var R=0,L=f;R<L.length;R+=1)this.images[L[R]]||(S=!1);this.isLoaded()||S?this._notify(f,m):this.requestors.push({ids:f,callback:m})},d.prototype._notify=function(f,m){for(var S={},R=0,L=f;R<L.length;R+=1){var q=L[R];this.images[q]||this.fire(new h.Event("styleimagemissing",{id:q}));var Se=this.images[q];Se?S[q]={data:Se.data.clone(),pixelRatio:Se.pixelRatio,sdf:Se.sdf,version:Se.version,stretchX:Se.stretchX,stretchY:Se.stretchY,content:Se.content,hasRenderCallback:!!(Se.userImage&&Se.userImage.render)}:h.warnOnce('Image "'+q+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}m(null,S)},d.prototype.getPixelSize=function(){var f=this.atlasImage;return{width:f.width,height:f.height}},d.prototype.getPattern=function(f){var m=this.patterns[f],S=this.getImage(f);if(!S)return null;if(m&&m.position.version===S.version)return m.position;if(m)m.position.version=S.version;else{var R={w:S.data.width+2,h:S.data.height+2,x:0,y:0},L=new h.ImagePosition(R,S);this.patterns[f]={bin:R,position:L}}return this._updatePatternAtlas(),this.patterns[f].position},d.prototype.bind=function(f){var m=f.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(f,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)},d.prototype._updatePatternAtlas=function(){var f=[];for(var m in this.patterns)f.push(this.patterns[m].bin);var S=h.potpack(f),R=S.w,L=S.h,q=this.atlasImage;for(var Se in q.resize({width:R||1,height:L||1}),this.patterns){var Le=this.patterns[Se].bin,et=Le.x+1,ot=Le.y+1,st=this.images[Se].data,Rt=st.width,Ct=st.height;h.RGBAImage.copy(st,q,{x:0,y:0},{x:et,y:ot},{width:Rt,height:Ct}),h.RGBAImage.copy(st,q,{x:0,y:Ct-1},{x:et,y:ot-1},{width:Rt,height:1}),h.RGBAImage.copy(st,q,{x:0,y:0},{x:et,y:ot+Ct},{width:Rt,height:1}),h.RGBAImage.copy(st,q,{x:Rt-1,y:0},{x:et-1,y:ot},{width:1,height:Ct}),h.RGBAImage.copy(st,q,{x:0,y:0},{x:et+Rt,y:ot},{width:1,height:Ct})}this.dirty=!0},d.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},d.prototype.dispatchRenderCallbacks=function(f){for(var m=0,S=f;m<S.length;m+=1){var R=S[m];if(!this.callbackDispatchedThisFrame[R]){this.callbackDispatchedThisFrame[R]=!0;var L=this.images[R];Z(L)&&this.updateImage(R,L)}}},d}(h.Evented),H=ye,ve=ye,Te=1e20;function ye(l,d,f,m,S,R){this.fontSize=l||24,this.buffer=d===void 0?3:d,this.cutoff=m||.25,this.fontFamily=S||"sans-serif",this.fontWeight=R||"normal",this.radius=f||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Ve(l,d,f,m,S,R,L){for(var q=0;q<d;q++){for(var Se=0;Se<f;Se++)m[Se]=l[Se*d+q];for(Re(m,S,R,L,f),Se=0;Se<f;Se++)l[Se*d+q]=S[Se]}for(Se=0;Se<f;Se++){for(q=0;q<d;q++)m[q]=l[Se*d+q];for(Re(m,S,R,L,d),q=0;q<d;q++)l[Se*d+q]=Math.sqrt(S[q])}}function Re(l,d,f,m,S){f[0]=0,m[0]=-Te,m[1]=+Te;for(var R=1,L=0;R<S;R++){for(var q=(l[R]+R*R-(l[f[L]]+f[L]*f[L]))/(2*R-2*f[L]);q<=m[L];)L--,q=(l[R]+R*R-(l[f[L]]+f[L]*f[L]))/(2*R-2*f[L]);f[++L]=R,m[L]=q,m[L+1]=+Te}for(R=0,L=0;R<S;R++){for(;m[L+1]<R;)L++;d[R]=(R-f[L])*(R-f[L])+l[f[L]]}}ye.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var d=this.ctx.getImageData(0,0,this.size,this.size),f=new Uint8ClampedArray(this.size*this.size),m=0;m<this.size*this.size;m++){var S=d.data[4*m+3]/255;this.gridOuter[m]=S===1?0:S===0?Te:Math.pow(Math.max(0,.5-S),2),this.gridInner[m]=S===1?Te:S===0?0:Math.pow(Math.max(0,S-.5),2)}for(Ve(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Ve(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),m=0;m<this.size*this.size;m++)f[m]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[m]-this.gridInner[m])/this.radius+this.cutoff))));return f},H.default=ve;var Ae=function(l,d){this.requestManager=l,this.localIdeographFontFamily=d,this.entries={}};Ae.prototype.setURL=function(l){this.url=l},Ae.prototype.getGlyphs=function(l,d){var f=this,m=[];for(var S in l)for(var R=0,L=l[S];R<L.length;R+=1)m.push({stack:S,id:L[R]});h.asyncAll(m,function(q,Se){var Le=q.stack,et=q.id,ot=f.entries[Le];ot||(ot=f.entries[Le]={glyphs:{},requests:{},ranges:{}});var st=ot.glyphs[et];if(st===void 0){if(st=f._tinySDF(ot,Le,et))return ot.glyphs[et]=st,void Se(null,{stack:Le,id:et,glyph:st});var Rt=Math.floor(et/256);if(256*Rt>65535)Se(new Error("glyphs > 65535 not supported"));else if(ot.ranges[Rt])Se(null,{stack:Le,id:et,glyph:st});else{var Ct=ot.requests[Rt];Ct||(Ct=ot.requests[Rt]=[],Ae.loadGlyphRange(Le,Rt,f.url,f.requestManager,function(Xt,St){if(St){for(var $t in St)f._doesCharSupportLocalGlyph(+$t)||(ot.glyphs[+$t]=St[+$t]);ot.ranges[Rt]=!0}for(var tr=0,br=Ct;tr<br.length;tr+=1)(0,br[tr])(Xt,St);delete ot.requests[Rt]})),Ct.push(function(Xt,St){Xt?Se(Xt):St&&Se(null,{stack:Le,id:et,glyph:St[et]||null})})}}else Se(null,{stack:Le,id:et,glyph:st})},function(q,Se){if(q)d(q);else if(Se){for(var Le={},et=0,ot=Se;et<ot.length;et+=1){var st=ot[et],Rt=st.stack,Ct=st.id,Xt=st.glyph;(Le[Rt]||(Le[Rt]={}))[Ct]=Xt&&{id:Xt.id,bitmap:Xt.bitmap.clone(),metrics:Xt.metrics}}d(null,Le)}})},Ae.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(h.isChar["CJK Unified Ideographs"](l)||h.isChar["Hangul Syllables"](l)||h.isChar.Hiragana(l)||h.isChar.Katakana(l))},Ae.prototype._tinySDF=function(l,d,f){var m=this.localIdeographFontFamily;if(m&&this._doesCharSupportLocalGlyph(f)){var S=l.tinySDF;if(!S){var R="400";/bold/i.test(d)?R="900":/medium/i.test(d)?R="500":/light/i.test(d)&&(R="200"),S=l.tinySDF=new Ae.TinySDF(24,3,8,.25,m,R)}return{id:f,bitmap:new h.AlphaImage({width:30,height:30},S.draw(String.fromCharCode(f))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ae.loadGlyphRange=function(l,d,f,m,S){var R=256*d,L=R+255,q=m.transformRequest(m.normalizeGlyphsURL(f).replace("{fontstack}",l).replace("{range}",R+"-"+L),h.ResourceType.Glyphs);h.getArrayBuffer(q,function(Se,Le){if(Se)S(Se);else if(Le){for(var et={},ot=0,st=h.parseGlyphPBF(Le);ot<st.length;ot+=1){var Rt=st[ot];et[Rt.id]=Rt}S(null,et)}})},Ae.TinySDF=H;var ae=function(){this.specification=h.styleSpec.light.position};ae.prototype.possiblyEvaluate=function(l,d){return h.sphericalToCartesian(l.expression.evaluate(d))},ae.prototype.interpolate=function(l,d,f){return{x:h.number(l.x,d.x,f),y:h.number(l.y,d.y,f),z:h.number(l.z,d.z,f)}};var ee=new h.Properties({anchor:new h.DataConstantProperty(h.styleSpec.light.anchor),position:new ae,color:new h.DataConstantProperty(h.styleSpec.light.color),intensity:new h.DataConstantProperty(h.styleSpec.light.intensity)}),me=function(l){function d(f){l.call(this),this._transitionable=new h.Transitionable(ee),this.setLight(f),this._transitioning=this._transitionable.untransitioned()}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getLight=function(){return this._transitionable.serialize()},d.prototype.setLight=function(f,m){if(m===void 0&&(m={}),!this._validate(h.validateLight,f,m))for(var S in f){var R=f[S];h.endsWith(S,"-transition")?this._transitionable.setTransition(S.slice(0,-11),R):this._transitionable.setValue(S,R)}},d.prototype.updateTransitions=function(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)},d.prototype.hasTransition=function(){return this._transitioning.hasTransition()},d.prototype.recalculate=function(f){this.properties=this._transitioning.possiblyEvaluate(f)},d.prototype._validate=function(f,m,S){return(!S||S.validate!==!1)&&h.emitValidationErrors(this,f.call(h.validateStyle,h.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:h.styleSpec})))},d}(h.Evented),ge=function(l,d){this.width=l,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ge.prototype.getDash=function(l,d){var f=l.join(",")+String(d);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(l,d)),this.dashEntry[f]},ge.prototype.getDashRanges=function(l,d,f){var m=[],S=l.length%2==1?-l[l.length-1]*f:0,R=l[0]*f,L=!0;m.push({left:S,right:R,isDash:L,zeroLength:l[0]===0});for(var q=l[0],Se=1;Se<l.length;Se++){var Le=l[Se];m.push({left:S=q*f,right:R=(q+=Le)*f,isDash:L=!L,zeroLength:Le===0})}return m},ge.prototype.addRoundDash=function(l,d,f){for(var m=d/2,S=-f;S<=f;S++)for(var R=this.width*(this.nextRow+f+S),L=0,q=l[L],Se=0;Se<this.width;Se++){Se/q.right>1&&(q=l[++L]);var Le=Math.abs(Se-q.left),et=Math.abs(Se-q.right),ot=Math.min(Le,et),st=void 0,Rt=S/f*(m+1);if(q.isDash){var Ct=m-Math.abs(Rt);st=Math.sqrt(ot*ot+Ct*Ct)}else st=m-Math.sqrt(ot*ot+Rt*Rt);this.data[R+Se]=Math.max(0,Math.min(255,st+128))}},ge.prototype.addRegularDash=function(l){for(var d=l.length-1;d>=0;--d){var f=l[d],m=l[d+1];f.zeroLength?l.splice(d,1):m&&m.isDash===f.isDash&&(m.left=f.left,l.splice(d,1))}var S=l[0],R=l[l.length-1];S.isDash===R.isDash&&(S.left=R.left-this.width,R.right=S.right+this.width);for(var L=this.width*this.nextRow,q=0,Se=l[q],Le=0;Le<this.width;Le++){Le/Se.right>1&&(Se=l[++q]);var et=Math.abs(Le-Se.left),ot=Math.abs(Le-Se.right),st=Math.min(et,ot);this.data[L+Le]=Math.max(0,Math.min(255,(Se.isDash?st:-st)+128))}},ge.prototype.addDash=function(l,d){var f=d?7:0,m=2*f+1;if(this.nextRow+m>this.height)return h.warnOnce("LineAtlas out of space"),null;for(var S=0,R=0;R<l.length;R++)S+=l[R];if(S!==0){var L=this.width/S,q=this.getDashRanges(l,this.width,L);d?this.addRoundDash(q,L,f):this.addRegularDash(q)}var Se={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:S};return this.nextRow+=m,this.dirty=!0,Se},ge.prototype.bind=function(l){var d=l.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))};var fe=function l(d,f){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=h.uniqueId();for(var m=this.workerPool.acquire(this.id),S=0;S<m.length;S++){var R=new l.Actor(m[S],f,this.id);R.name="Worker "+S,this.actors.push(R)}};function Et(l,d,f){var m=function(S,R){if(S)return f(S);if(R){var L=h.pick(h.extend(R,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(L.vectorLayers=R.vector_layers,L.vectorLayerIds=L.vectorLayers.map(function(q){return q.id})),L.tiles=d.canonicalizeTileset(L,l.url),f(null,L)}};return l.url?h.getJSON(d.transformRequest(d.normalizeSourceURL(l.url),h.ResourceType.Source),m):h.browser.frame(function(){return m(null,l)})}fe.prototype.broadcast=function(l,d,f){h.asyncAll(this.actors,function(m,S){m.send(l,d,S)},f=f||function(){})},fe.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},fe.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},fe.Actor=h.Actor;var xe=function(l,d,f){this.bounds=h.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=f||24};xe.prototype.validateBounds=function(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},xe.prototype.contains=function(l){var d=Math.pow(2,l.z),f=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*d),m=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*d),S=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*d),R=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*d);return l.x>=f&&l.x<S&&l.y>=m&&l.y<R};var je=function(l){function d(f,m,S,R){if(l.call(this),this.id=f,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(m,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(R)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var f=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Et(this._options,this.map._requestManager,function(m,S){f._tileJSONRequest=null,f._loaded=!0,m?f.fire(new h.ErrorEvent(m)):S&&(h.extend(f,S),S.bounds&&(f.tileBounds=new xe(S.bounds,f.minzoom,f.maxzoom)),h.postTurnstileEvent(S.tiles,f.map._requestManager._customAccessToken),h.postMapLoadEvent(S.tiles,f.map._getMapId(),f.map._requestManager._skuToken,f.map._requestManager._customAccessToken),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},d.prototype.loaded=function(){return this._loaded},d.prototype.hasTile=function(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)},d.prototype.onAdd=function(f){this.map=f,this.load()},d.prototype.setSourceProperty=function(f){this._tileJSONRequest&&this._tileJSONRequest.cancel(),f(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},d.prototype.setTiles=function(f){var m=this;return this.setSourceProperty(function(){m._options.tiles=f}),this},d.prototype.setUrl=function(f){var m=this;return this.setSourceProperty(function(){m.url=f,m._options.url=f}),this},d.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},d.prototype.serialize=function(){return h.extend({},this._options)},d.prototype.loadTile=function(f,m){var S=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),R={request:this.map._requestManager.transformRequest(S,h.ResourceType.Tile),uid:f.uid,tileID:f.tileID,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(q,Se){return delete f.request,f.aborted?m(null):q&&q.status!==404?m(q):(Se&&Se.resourceTiming&&(f.resourceTiming=Se.resourceTiming),this.map._refreshExpiredTiles&&Se&&f.setExpiryData(Se),f.loadVectorData(Se,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}R.request.collectResourceTiming=this._collectResourceTiming,f.actor&&f.state!=="expired"?f.state==="loading"?f.reloadCallback=m:f.request=f.actor.send("reloadTile",R,L.bind(this)):(f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",R,L.bind(this)))},d.prototype.abortTile=function(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id},void 0)},d.prototype.unloadTile=function(f){f.unloadVectorData(),f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id},void 0)},d.prototype.hasTransition=function(){return!1},d}(h.Evented),ue=function(l){function d(f,m,S,R){l.call(this),this.id=f,this.dispatcher=S,this.setEventedParent(R),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},m),h.extend(this,h.pick(m,["url","scheme","tileSize"]))}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var f=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Et(this._options,this.map._requestManager,function(m,S){f._tileJSONRequest=null,f._loaded=!0,m?f.fire(new h.ErrorEvent(m)):S&&(h.extend(f,S),S.bounds&&(f.tileBounds=new xe(S.bounds,f.minzoom,f.maxzoom)),h.postTurnstileEvent(S.tiles),h.postMapLoadEvent(S.tiles,f.map._getMapId(),f.map._requestManager._skuToken),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),f.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},d.prototype.loaded=function(){return this._loaded},d.prototype.onAdd=function(f){this.map=f,this.load()},d.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},d.prototype.serialize=function(){return h.extend({},this._options)},d.prototype.hasTile=function(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)},d.prototype.loadTile=function(f,m){var S=this,R=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);f.request=h.getImage(this.map._requestManager.transformRequest(R,h.ResourceType.Tile),function(L,q){if(delete f.request,f.aborted)f.state="unloaded",m(null);else if(L)f.state="errored",m(L);else if(q){S.map._refreshExpiredTiles&&f.setExpiryData(q),delete q.cacheControl,delete q.expires;var Se=S.map.painter.context,Le=Se.gl;f.texture=S.map.painter.getTileTexture(q.width),f.texture?f.texture.update(q,{useMipmap:!0}):(f.texture=new h.Texture(Se,q,Le.RGBA,{useMipmap:!0}),f.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE,Le.LINEAR_MIPMAP_NEAREST),Se.extTextureFilterAnisotropic&&Le.texParameterf(Le.TEXTURE_2D,Se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Se.extTextureFilterAnisotropicMax)),f.state="loaded",h.cacheEntryPossiblyAdded(S.dispatcher),m(null)}})},d.prototype.abortTile=function(f,m){f.request&&(f.request.cancel(),delete f.request),m()},d.prototype.unloadTile=function(f,m){f.texture&&this.map.painter.saveTileTexture(f.texture),m()},d.prototype.hasTransition=function(){return!1},d}(h.Evented),Pe=function(l){function d(f,m,S,R){l.call(this,f,m,S,R),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},d.prototype.loadTile=function(f,m){var S=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function R(L,q){L&&(f.state="errored",m(L)),q&&(f.dem=q,f.needsHillshadePrepare=!0,f.state="loaded",m(null))}f.request=h.getImage(this.map._requestManager.transformRequest(S,h.ResourceType.Tile),function(L,q){if(delete f.request,f.aborted)f.state="unloaded",m(null);else if(L)f.state="errored",m(L);else if(q){this.map._refreshExpiredTiles&&f.setExpiryData(q),delete q.cacheControl,delete q.expires;var Se=h.window.ImageBitmap&&q instanceof h.window.ImageBitmap&&h.offscreenCanvasSupported()?q:h.browser.getImageData(q,1),Le={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:Se,encoding:this.encoding};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",Le,R.bind(this)))}}.bind(this)),f.neighboringTiles=this._getNeighboringTiles(f.tileID)},d.prototype._getNeighboringTiles=function(f){var m=f.canonical,S=Math.pow(2,m.z),R=(m.x-1+S)%S,L=m.x===0?f.wrap-1:f.wrap,q=(m.x+1+S)%S,Se=m.x+1===S?f.wrap+1:f.wrap,Le={};return Le[new h.OverscaledTileID(f.overscaledZ,L,m.z,R,m.y).key]={backfilled:!1},Le[new h.OverscaledTileID(f.overscaledZ,Se,m.z,q,m.y).key]={backfilled:!1},m.y>0&&(Le[new h.OverscaledTileID(f.overscaledZ,L,m.z,R,m.y-1).key]={backfilled:!1},Le[new h.OverscaledTileID(f.overscaledZ,f.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},Le[new h.OverscaledTileID(f.overscaledZ,Se,m.z,q,m.y-1).key]={backfilled:!1}),m.y+1<S&&(Le[new h.OverscaledTileID(f.overscaledZ,L,m.z,R,m.y+1).key]={backfilled:!1},Le[new h.OverscaledTileID(f.overscaledZ,f.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},Le[new h.OverscaledTileID(f.overscaledZ,Se,m.z,q,m.y+1).key]={backfilled:!1}),Le},d.prototype.unloadTile=function(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded",f.actor&&f.actor.send("removeDEMTile",{uid:f.uid,source:this.id})},d}(ue),we=function(l){function d(f,m,S,R){l.call(this),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=S.getActor(),this.setEventedParent(R),this._data=m.data,this._options=h.extend({},m),this._collectResourceTiming=m.collectResourceTiming,this._resourceTiming=[],m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;var L=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*L,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*L,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?Math.min(m.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:h.EXTENT,radius:(m.clusterRadius||50)*L,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var f=this;this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)f.fire(new h.ErrorEvent(m));else{var S={dataType:"source",sourceDataType:"metadata"};f._collectResourceTiming&&f._resourceTiming&&f._resourceTiming.length>0&&(S.resourceTiming=f._resourceTiming,f._resourceTiming=[]),f.fire(new h.Event("data",S))}})},d.prototype.onAdd=function(f){this.map=f,this.load()},d.prototype.setData=function(f){var m=this;return this._data=f,this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(S){if(S)m.fire(new h.ErrorEvent(S));else{var R={dataType:"source",sourceDataType:"content"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(R.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new h.Event("data",R))}}),this},d.prototype.getClusterExpansionZoom=function(f,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},m),this},d.prototype.getClusterChildren=function(f,m){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},m),this},d.prototype.getClusterLeaves=function(f,m,S,R){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:m,offset:S},R),this},d.prototype._updateWorkerData=function(f){var m=this;this._loaded=!1;var S=h.extend({},this.workerOptions),R=this._data;typeof R=="string"?(S.request=this.map._requestManager.transformRequest(h.browser.resolveURL(R),h.ResourceType.Source),S.request.collectResourceTiming=this._collectResourceTiming):S.data=JSON.stringify(R),this.actor.send(this.type+".loadData",S,function(L,q){m._removed||q&&q.abandoned||(m._loaded=!0,q&&q.resourceTiming&&q.resourceTiming[m.id]&&(m._resourceTiming=q.resourceTiming[m.id].slice(0)),m.actor.send(m.type+".coalesce",{source:S.source},null),f(L))})},d.prototype.loaded=function(){return this._loaded},d.prototype.loadTile=function(f,m){var S=this,R=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(R,{type:this.type,uid:f.uid,tileID:f.tileID,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,q){return delete f.request,f.unloadVectorData(),f.aborted?m(null):L?m(L):(f.loadVectorData(q,S.map.painter,R==="reloadTile"),m(null))})},d.prototype.abortTile=function(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0},d.prototype.unloadTile=function(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})},d.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},d.prototype.serialize=function(){return h.extend({},this._options,{type:this.type,data:this._data})},d.prototype.hasTransition=function(){return!1},d}(h.Evented),nt=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),at=function(l){function d(f,m,S,R){l.call(this),this.id=f,this.dispatcher=S,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(R),this.options=m}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(f,m){var S=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),function(R,L){S._loaded=!0,R?S.fire(new h.ErrorEvent(R)):L&&(S.image=L,f&&(S.coordinates=f),m&&m(),S._finishLoading())})},d.prototype.loaded=function(){return this._loaded},d.prototype.updateImage=function(f){var m=this;return this.image&&f.url?(this.options.url=f.url,this.load(f.coordinates,function(){m.texture=null}),this):this},d.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))},d.prototype.onAdd=function(f){this.map=f,this.load()},d.prototype.setCoordinates=function(f){var m=this;this.coordinates=f;var S=f.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var q=1/0,Se=1/0,Le=-1/0,et=-1/0,ot=0,st=L;ot<st.length;ot+=1){var Rt=st[ot];q=Math.min(q,Rt.x),Se=Math.min(Se,Rt.y),Le=Math.max(Le,Rt.x),et=Math.max(et,Rt.y)}var Ct=Math.max(Le-q,et-Se),Xt=Math.max(0,Math.floor(-Math.log(Ct)/Math.LN2)),St=Math.pow(2,Xt);return new h.CanonicalTileID(Xt,Math.floor((q+Le)/2*St),Math.floor((Se+et)/2*St))}(S),this.minzoom=this.maxzoom=this.tileID.z;var R=S.map(function(L){return m.tileID.getTilePoint(L)._round()});return this._boundsArray=new h.StructArrayLayout4i8,this._boundsArray.emplaceBack(R[0].x,R[0].y,0,0),this._boundsArray.emplaceBack(R[1].x,R[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(R[3].x,R[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(R[2].x,R[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this},d.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var f=this.map.painter.context,m=f.gl;for(var S in this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,nt.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new h.Texture(f,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var R=this.tiles[S];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},d.prototype.loadTile=function(f,m){this.tileID&&this.tileID.equals(f.tileID.canonical)?(this.tiles[String(f.tileID.wrap)]=f,f.buckets={},m(null)):(f.state="errored",m(null))},d.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},d.prototype.hasTransition=function(){return!1},d}(h.Evented),vt=function(l){function d(f,m,S,R){l.call(this,f,m,S,R),this.roundZoom=!0,this.type="video",this.options=m}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var f=this;this._loaded=!1;var m=this.options;this.urls=[];for(var S=0,R=m.urls;S<R.length;S+=1)this.urls.push(this.map._requestManager.transformRequest(R[S],h.ResourceType.Source).url);h.getVideo(this.urls,function(L,q){f._loaded=!0,L?f.fire(new h.ErrorEvent(L)):q&&(f.video=q,f.video.loop=!0,f.video.setAttribute("playsinline",""),f.video.addEventListener("playing",function(){f.map.triggerRepaint()}),f.map&&f.video.play(),f._finishLoading())})},d.prototype.pause=function(){this.video&&this.video.pause()},d.prototype.play=function(){this.video&&this.video.play()},d.prototype.seek=function(f){if(this.video){var m=this.video.seekable;f<m.start(0)||f>m.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+m.start(0)+" and "+m.end(0)+"-second mark."))):this.video.currentTime=f}},d.prototype.getVideo=function(){return this.video},d.prototype.onAdd=function(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},d.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var f=this.map.painter.context,m=f.gl;for(var S in this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,nt.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(f,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var R=this.tiles[S];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},d.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},d.prototype.hasTransition=function(){return this.video&&!this.video.paused},d}(at),Tt=function(l){function d(f,m,S,R){l.call(this,f,m,S,R),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(function(L){return!Array.isArray(L)||L.length!==2||L.some(function(q){return typeof q!="number"})})||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+f,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},d.prototype.getCanvas=function(){return this.canvas},d.prototype.onAdd=function(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()},d.prototype.onRemove=function(){this.pause()},d.prototype.prepare=function(){var f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var m=this.map.painter.context,S=m.gl;for(var R in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,nt.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(m,this.canvas,S.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[R];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},d.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},d.prototype.hasTransition=function(){return this._playing},d.prototype._hasInvalidDimensions=function(){for(var f=0,m=[this.canvas.width,this.canvas.height];f<m.length;f+=1){var S=m[f];if(isNaN(S)||S<=0)return!0}return!1},d}(at),ze={vector:je,raster:ue,"raster-dem":Pe,geojson:we,video:vt,image:at,canvas:Tt};function gr(l,d){var f=h.identity([]);return h.translate(f,f,[1,1,0]),h.scale(f,f,[.5*l.width,.5*l.height,1]),h.multiply(f,f,l.calculatePosMatrix(d.toUnwrapped()))}function At(l,d,f,m,S,R){var L=function(Xt,St,$t){if(Xt)for(var tr=0,br=Xt;tr<br.length;tr+=1){var kr=St[br[tr]];if(kr&&kr.source===$t&&kr.type==="fill-extrusion")return!0}else for(var Or in St){var Hr=St[Or];if(Hr.source===$t&&Hr.type==="fill-extrusion")return!0}return!1}(S&&S.layers,d,l.id),q=R.maxPitchScaleFactor(),Se=l.tilesIn(m,q,L);Se.sort(hn);for(var Le=[],et=0,ot=Se;et<ot.length;et+=1){var st=ot[et];Le.push({wrappedTileID:st.tileID.wrapped().key,queryResults:st.tile.queryRenderedFeatures(d,f,l._state,st.queryGeometry,st.cameraQueryGeometry,st.scale,S,R,q,gr(l.transform,st.tileID))})}var Rt=function(Xt){for(var St={},$t={},tr=0,br=Xt;tr<br.length;tr+=1){var kr=br[tr],Or=kr.queryResults,Hr=kr.wrappedTileID,nn=$t[Hr]=$t[Hr]||{};for(var M in Or)for(var z=Or[M],j=nn[M]=nn[M]||{},ne=St[M]=St[M]||[],ce=0,le=z;ce<le.length;ce+=1){var lt=le[ce];j[lt.featureIndex]||(j[lt.featureIndex]=!0,ne.push(lt))}}return St}(Le);for(var Ct in Rt)Rt[Ct].forEach(function(Xt){var St=Xt.feature,$t=l.getFeatureState(St.layer["source-layer"],St.id);St.source=St.layer.source,St.layer["source-layer"]&&(St.sourceLayer=St.layer["source-layer"]),St.state=$t});return Rt}function hn(l,d){var f=l.tileID,m=d.tileID;return f.overscaledZ-m.overscaledZ||f.canonical.y-m.canonical.y||f.wrap-m.wrap||f.canonical.x-m.canonical.x}var Wr=function(l,d){this.max=l,this.onRemove=d,this.reset()};Wr.prototype.reset=function(){for(var l in this.data)for(var d=0,f=this.data[l];d<f.length;d+=1){var m=f[d];m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value)}return this.data={},this.order=[],this},Wr.prototype.add=function(l,d,f){var m=this,S=l.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);var R={value:d,timeout:void 0};if(f!==void 0&&(R.timeout=setTimeout(function(){m.remove(l,R)},f)),this.data[S].push(R),this.order.push(S),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},Wr.prototype.has=function(l){return l.wrapped().key in this.data},Wr.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},Wr.prototype._getAndRemoveByKey=function(l){var d=this.data[l].shift();return d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),d.value},Wr.prototype.getByKey=function(l){var d=this.data[l];return d?d[0].value:null},Wr.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},Wr.prototype.remove=function(l,d){if(!this.has(l))return this;var f=l.wrapped().key,m=d===void 0?0:this.data[f].indexOf(d),S=this.data[f][m];return this.data[f].splice(m,1),S.timeout&&clearTimeout(S.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(S.value),this.order.splice(this.order.indexOf(f),1),this},Wr.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this},Wr.prototype.filter=function(l){var d=[];for(var f in this.data)for(var m=0,S=this.data[f];m<S.length;m+=1){var R=S[m];l(R.value)||d.push(R)}for(var L=0,q=d;L<q.length;L+=1){var Se=q[L];this.remove(Se.value.tileID,Se)}};var vr=function(l,d,f){this.context=l;var m=l.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer};vr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},vr.prototype.updateData=function(l){var d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},vr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var dn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},tn=function(l,d,f,m){this.length=d.length,this.attributes=f,this.itemSize=d.bytesPerElement,this.dynamicDraw=m,this.context=l;var S=l.gl;this.buffer=S.createBuffer(),l.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer};tn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},tn.prototype.updateData=function(l){var d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)},tn.prototype.enableAttributes=function(l,d){for(var f=0;f<this.attributes.length;f++){var m=d.attributes[this.attributes[f].name];m!==void 0&&l.enableVertexAttribArray(m)}},tn.prototype.setVertexAttribPointers=function(l,d,f){for(var m=0;m<this.attributes.length;m++){var S=this.attributes[m],R=d.attributes[S.name];R!==void 0&&l.vertexAttribPointer(R,S.components,l[dn[S.type]],!1,this.itemSize,S.offset+this.itemSize*(f||0))}},tn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var un=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};un.prototype.get=function(){return this.current},un.prototype.set=function(l){},un.prototype.getDefault=function(){return this.default},un.prototype.setDefault=function(){this.set(this.default)};var yn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return h.Color.transparent},d.prototype.set=function(f){var m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.clearColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)},d}(un),Vt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 1},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.clearDepth(f),this.current=f,this.dirty=!1)},d}(un),dr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 0},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.clearStencil(f),this.current=f,this.dirty=!1)},d}(un),wt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return[!0,!0,!0,!0]},d.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.colorMask(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)},d}(un),He=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!0},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.depthMask(f),this.current=f,this.dirty=!1)},d}(un),wr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 255},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.stencilMask(f),this.current=f,this.dirty=!1)},d}(un),Ne=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},d.prototype.set=function(f){var m=this.current;(f.func!==m.func||f.ref!==m.ref||f.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(f.func,f.ref,f.mask),this.current=f,this.dirty=!1)},d}(un),Xr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){var f=this.gl;return[f.KEEP,f.KEEP,f.KEEP]},d.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(f[0],f[1],f[2]),this.current=f,this.dirty=!1)},d}(un),Er=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=f,this.dirty=!1}},d}(un),Ue=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return[0,1]},d.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.depthRange(f[0],f[1]),this.current=f,this.dirty=!1)},d}(un),In=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=f,this.dirty=!1}},d}(un),an=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.LESS},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.depthFunc(f),this.current=f,this.dirty=!1)},d}(un),Qr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.BLEND):m.disable(m.BLEND),this.current=f,this.dirty=!1}},d}(un),Dn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){var f=this.gl;return[f.ONE,f.ZERO]},d.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(f[0],f[1]),this.current=f,this.dirty=!1)},d}(un),On=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return h.Color.transparent},d.prototype.set=function(f){var m=this.current;(f.r!==m.r||f.g!==m.g||f.b!==m.b||f.a!==m.a||this.dirty)&&(this.gl.blendColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)},d}(un),ri=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.FUNC_ADD},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.blendEquation(f),this.current=f,this.dirty=!1)},d}(un),zt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;f?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=f,this.dirty=!1}},d}(un),cr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.BACK},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.cullFace(f),this.current=f,this.dirty=!1)},d}(un),Zr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.CCW},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.frontFace(f),this.current=f,this.dirty=!1)},d}(un),Kr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)},d}(un),en=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.TEXTURE0},d.prototype.set=function(f){(f!==this.current||this.dirty)&&(this.gl.activeTexture(f),this.current=f,this.dirty=!1)},d}(un),Wn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){var f=this.gl;return[0,0,f.drawingBufferWidth,f.drawingBufferHeight]},d.prototype.set=function(f){var m=this.current;(f[0]!==m[0]||f[1]!==m[1]||f[2]!==m[2]||f[3]!==m[3]||this.dirty)&&(this.gl.viewport(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)},d}(un),De=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,f),this.current=f,this.dirty=!1}},d}(un),X=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,f),this.current=f,this.dirty=!1}},d}(un),se=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindTexture(m.TEXTURE_2D,f),this.current=f,this.dirty=!1}},d}(un),Be=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,f),this.current=f,this.dirty=!1}},d}(un),Ye=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){var m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,f),this.current=f,this.dirty=!1},d}(un),ct=function(l){function d(f){l.call(this,f),this.vao=f.extVertexArrayObject}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(f){this.vao&&(f!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(f),this.current=f,this.dirty=!1)},d}(un),sr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 4},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,f),this.current=f,this.dirty=!1}},d}(un),ar=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),this.current=f,this.dirty=!1}},d}(un),or=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(f){if(f!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,f),this.current=f,this.dirty=!1}},d}(un),Wt=function(l){function d(f,m){l.call(this,f),this.context=f,this.parent=m}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d}(un),oe=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.setDirty=function(){this.dirty=!0},d.prototype.set=function(f){if(f!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,f,0),this.current=f,this.dirty=!1}},d}(Wt),ie=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(f){if(f!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,f),this.current=f,this.dirty=!1}},d}(Wt),be=function(l,d,f,m){this.context=l,this.width=d,this.height=f;var S=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new oe(l,S),m&&(this.depthAttachment=new ie(l,S))};be.prototype.destroy=function(){var l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){var f=this.depthAttachment.get();f&&l.deleteRenderbuffer(f)}l.deleteFramebuffer(this.framebuffer)};var ke=function(l,d,f){this.func=l,this.mask=d,this.range=f};ke.ReadOnly=!1,ke.ReadWrite=!0,ke.disabled=new ke(519,ke.ReadOnly,[0,1]);var qe=function(l,d,f,m,S,R){this.test=l,this.ref=d,this.mask=f,this.fail=m,this.depthFail=S,this.pass=R};qe.disabled=new qe({func:519,mask:0},0,0,7680,7680,7680);var mt=function(l,d,f){this.blendFunction=l,this.blendColor=d,this.mask=f};mt.disabled=new mt(mt.Replace=[1,0],h.Color.transparent,[!1,!1,!1,!1]),mt.unblended=new mt(mt.Replace,h.Color.transparent,[!0,!0,!0,!0]),mt.alphaBlended=new mt([1,771],h.Color.transparent,[!0,!0,!0,!0]);var kt=function(l,d,f){this.enable=l,this.mode=d,this.frontFace=f};kt.disabled=new kt(!1,1029,2305),kt.backCCW=new kt(!0,1029,2305);var $e=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new yn(this),this.clearDepth=new Vt(this),this.clearStencil=new dr(this),this.colorMask=new wt(this),this.depthMask=new He(this),this.stencilMask=new wr(this),this.stencilFunc=new Ne(this),this.stencilOp=new Xr(this),this.stencilTest=new Er(this),this.depthRange=new Ue(this),this.depthTest=new In(this),this.depthFunc=new an(this),this.blend=new Qr(this),this.blendFunc=new Dn(this),this.blendColor=new On(this),this.blendEquation=new ri(this),this.cullFace=new zt(this),this.cullFaceSide=new cr(this),this.frontFace=new Zr(this),this.program=new Kr(this),this.activeTexture=new en(this),this.viewport=new Wn(this),this.bindFramebuffer=new De(this),this.bindRenderbuffer=new X(this),this.bindTexture=new se(this),this.bindVertexBuffer=new Be(this),this.bindElementBuffer=new Ye(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ct(this),this.pixelStoreUnpack=new sr(this),this.pixelStoreUnpackPremultiplyAlpha=new ar(this),this.pixelStoreUnpackFlipY=new or(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};$e.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},$e.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},$e.prototype.createIndexBuffer=function(l,d){return new vr(this,l,d)},$e.prototype.createVertexBuffer=function(l,d,f){return new tn(this,l,d,f)},$e.prototype.createRenderbuffer=function(l,d,f){var m=this.gl,S=m.createRenderbuffer();return this.bindRenderbuffer.set(S),m.renderbufferStorage(m.RENDERBUFFER,l,d,f),this.bindRenderbuffer.set(null),S},$e.prototype.createFramebuffer=function(l,d,f){return new be(this,l,d,f)},$e.prototype.clear=function(l){var d=l.color,f=l.depth,m=this.gl,S=0;d&&(S|=m.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(S|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),m.clear(S)},$e.prototype.setCullFace=function(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},$e.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},$e.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},$e.prototype.setColorMode=function(l){h.deepEqual(l.blendFunction,mt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},$e.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ge=function(l){function d(f,m,S){var R=this;l.call(this),this.id=f,this.dispatcher=S,this.on("data",function(L){L.dataType==="source"&&L.sourceDataType==="metadata"&&(R._sourceLoaded=!0),R._sourceLoaded&&!R._paused&&L.dataType==="source"&&L.sourceDataType==="content"&&(R.reload(),R.transform&&R.update(R.transform))}),this.on("error",function(){R._sourceErrored=!0}),this._source=function(L,q,Se,Le){var et=new ze[q.type](L,q,Se,Le);if(et.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+et.id);return h.bindAll(["load","abort","unload","serialize","prepare"],et),et}(f,m,S,this),this._tiles={},this._cache=new Wr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new h.SourceFeatureState}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.onAdd=function(f){this.map=f,this._maxTileCacheSize=f?f._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(f)},d.prototype.onRemove=function(f){this._source&&this._source.onRemove&&this._source.onRemove(f)},d.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var f in this._tiles){var m=this._tiles[f];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0},d.prototype.getSource=function(){return this._source},d.prototype.pause=function(){this._paused=!0},d.prototype.resume=function(){if(this._paused){var f=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,f&&this.reload(),this.transform&&this.update(this.transform)}},d.prototype._loadTile=function(f,m){return this._source.loadTile(f,m)},d.prototype._unloadTile=function(f){if(this._source.unloadTile)return this._source.unloadTile(f,function(){})},d.prototype._abortTile=function(f){if(this._source.abortTile)return this._source.abortTile(f,function(){})},d.prototype.serialize=function(){return this._source.serialize()},d.prototype.prepare=function(f){for(var m in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var S=this._tiles[m];S.upload(f),S.prepare(this.map.style.imageManager)}},d.prototype.getIds=function(){return h.values(this._tiles).map(function(f){return f.tileID}).sort(We).map(function(f){return f.key})},d.prototype.getRenderableIds=function(f){var m=this,S=[];for(var R in this._tiles)this._isIdRenderable(R,f)&&S.push(this._tiles[R]);return f?S.sort(function(L,q){var Se=L.tileID,Le=q.tileID,et=new h.Point(Se.canonical.x,Se.canonical.y)._rotate(m.transform.angle),ot=new h.Point(Le.canonical.x,Le.canonical.y)._rotate(m.transform.angle);return Se.overscaledZ-Le.overscaledZ||ot.y-et.y||ot.x-et.x}).map(function(L){return L.tileID.key}):S.map(function(L){return L.tileID}).sort(We).map(function(L){return L.key})},d.prototype.hasRenderableParent=function(f){var m=this.findLoadedParent(f,0);return!!m&&this._isIdRenderable(m.tileID.key)},d.prototype._isIdRenderable=function(f,m){return this._tiles[f]&&this._tiles[f].hasData()&&!this._coveredTiles[f]&&(m||!this._tiles[f].holdingForFade())},d.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var f in this._cache.reset(),this._tiles)this._tiles[f].state!=="errored"&&this._reloadTile(f,"reloading")},d.prototype._reloadTile=function(f,m){var S=this._tiles[f];S&&(S.state!=="loading"&&(S.state=m),this._loadTile(S,this._tileLoaded.bind(this,S,f,m)))},d.prototype._tileLoaded=function(f,m,S,R){if(R)return f.state="errored",void(R.status!==404?this._source.fire(new h.ErrorEvent(R,{tile:f})):this.update(this.transform));f.timeAdded=h.browser.now(),S==="expired"&&(f.refreshedUponExpiration=!0),this._setTileReloadTimer(m,f),this.getSource().type==="raster-dem"&&f.dem&&this._backfillDEM(f),this._state.initializeTileState(f,this.map?this.map.painter:null),this._source.fire(new h.Event("data",{dataType:"source",tile:f,coord:f.tileID}))},d.prototype._backfillDEM=function(f){for(var m=this.getRenderableIds(),S=0;S<m.length;S++){var R=m[S];if(f.neighboringTiles&&f.neighboringTiles[R]){var L=this.getTileByID(R);q(f,L),q(L,f)}}function q(Se,Le){Se.needsHillshadePrepare=!0;var et=Le.tileID.canonical.x-Se.tileID.canonical.x,ot=Le.tileID.canonical.y-Se.tileID.canonical.y,st=Math.pow(2,Se.tileID.canonical.z),Rt=Le.tileID.key;et===0&&ot===0||Math.abs(ot)>1||(Math.abs(et)>1&&(Math.abs(et+st)===1?et+=st:Math.abs(et-st)===1&&(et-=st)),Le.dem&&Se.dem&&(Se.dem.backfillBorder(Le.dem,et,ot),Se.neighboringTiles&&Se.neighboringTiles[Rt]&&(Se.neighboringTiles[Rt].backfilled=!0)))}},d.prototype.getTile=function(f){return this.getTileByID(f.key)},d.prototype.getTileByID=function(f){return this._tiles[f]},d.prototype._retainLoadedChildren=function(f,m,S,R){for(var L in this._tiles){var q=this._tiles[L];if(!(R[L]||!q.hasData()||q.tileID.overscaledZ<=m||q.tileID.overscaledZ>S)){for(var Se=q.tileID;q&&q.tileID.overscaledZ>m+1;){var Le=q.tileID.scaledTo(q.tileID.overscaledZ-1);(q=this._tiles[Le.key])&&q.hasData()&&(Se=Le)}for(var et=Se;et.overscaledZ>m;)if(f[(et=et.scaledTo(et.overscaledZ-1)).key]){R[Se.key]=Se;break}}}},d.prototype.findLoadedParent=function(f,m){if(f.key in this._loadedParentTiles){var S=this._loadedParentTiles[f.key];return S&&S.tileID.overscaledZ>=m?S:null}for(var R=f.overscaledZ-1;R>=m;R--){var L=f.scaledTo(R),q=this._getLoadedTile(L);if(q)return q}},d.prototype._getLoadedTile=function(f){var m=this._tiles[f.key];return m&&m.hasData()?m:this._cache.getByKey(f.wrapped().key)},d.prototype.updateCacheSize=function(f){var m=Math.ceil(f.width/this._source.tileSize)+1,S=Math.ceil(f.height/this._source.tileSize)+1,R=Math.floor(m*S*5),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,R):R;this._cache.setMaxSize(L)},d.prototype.handleWrapJump=function(f){var m=Math.round((f-(this._prevLng===void 0?f:this._prevLng))/360);if(this._prevLng=f,m){var S={};for(var R in this._tiles){var L=this._tiles[R];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+m),S[L.tileID.key]=L}for(var q in this._tiles=S,this._timers)clearTimeout(this._timers[q]),delete this._timers[q];for(var Se in this._tiles)this._setTileReloadTimer(Se,this._tiles[Se])}},d.prototype.update=function(f){var m=this;if(this.transform=f,this._sourceLoaded&&!this._paused){var S;this.updateCacheSize(f),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?S=f.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(nn){return new h.OverscaledTileID(nn.canonical.z,nn.wrap,nn.canonical.z,nn.canonical.x,nn.canonical.y)}):(S=f.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(S=S.filter(function(nn){return m._source.hasTile(nn)}))):S=[];var R=f.coveringZoomLevel(this._source),L=Math.max(R-d.maxOverzooming,this._source.minzoom),q=Math.max(R+d.maxUnderzooming,this._source.minzoom),Se=this._updateRetainedTiles(S,R);if(G(this._source.type)){for(var Le={},et={},ot=0,st=Object.keys(Se);ot<st.length;ot+=1){var Rt=st[ot],Ct=Se[Rt],Xt=this._tiles[Rt];if(Xt&&!(Xt.fadeEndTime&&Xt.fadeEndTime<=h.browser.now())){var St=this.findLoadedParent(Ct,L);St&&(this._addTile(St.tileID),Le[St.tileID.key]=St.tileID),et[Rt]=Ct}}for(var $t in this._retainLoadedChildren(et,R,q,Se),Le)Se[$t]||(this._coveredTiles[$t]=!0,Se[$t]=Le[$t])}for(var tr in Se)this._tiles[tr].clearFadeHold();for(var br=0,kr=h.keysDifference(this._tiles,Se);br<kr.length;br+=1){var Or=kr[br],Hr=this._tiles[Or];Hr.hasSymbolBuckets&&!Hr.holdingForFade()?Hr.setHoldDuration(this.map._fadeDuration):Hr.hasSymbolBuckets&&!Hr.symbolFadeFinished()||this._removeTile(Or)}this._updateLoadedParentTileCache()}},d.prototype.releaseSymbolFadeTiles=function(){for(var f in this._tiles)this._tiles[f].holdingForFade()&&this._removeTile(f)},d.prototype._updateRetainedTiles=function(f,m){for(var S={},R={},L=Math.max(m-d.maxOverzooming,this._source.minzoom),q=Math.max(m+d.maxUnderzooming,this._source.minzoom),Se={},Le=0,et=f;Le<et.length;Le+=1){var ot=et[Le],st=this._addTile(ot);S[ot.key]=ot,st.hasData()||m<this._source.maxzoom&&(Se[ot.key]=ot)}this._retainLoadedChildren(Se,m,q,S);for(var Rt=0,Ct=f;Rt<Ct.length;Rt+=1){var Xt=Ct[Rt],St=this._tiles[Xt.key];if(!St.hasData()){if(m+1>this._source.maxzoom){var $t=Xt.children(this._source.maxzoom)[0],tr=this.getTile($t);if(tr&&tr.hasData()){S[$t.key]=$t;continue}}else{var br=Xt.children(this._source.maxzoom);if(S[br[0].key]&&S[br[1].key]&&S[br[2].key]&&S[br[3].key])continue}for(var kr=St.wasRequested(),Or=Xt.overscaledZ-1;Or>=L;--Or){var Hr=Xt.scaledTo(Or);if(R[Hr.key]||(R[Hr.key]=!0,!(St=this.getTile(Hr))&&kr&&(St=this._addTile(Hr)),St&&(S[Hr.key]=Hr,kr=St.wasRequested(),St.hasData())))break}}}return S},d.prototype._updateLoadedParentTileCache=function(){for(var f in this._loadedParentTiles={},this._tiles){for(var m=[],S=void 0,R=this._tiles[f].tileID;R.overscaledZ>0;){if(R.key in this._loadedParentTiles){S=this._loadedParentTiles[R.key];break}m.push(R.key);var L=R.scaledTo(R.overscaledZ-1);if(S=this._getLoadedTile(L))break;R=L}for(var q=0,Se=m;q<Se.length;q+=1)this._loadedParentTiles[Se[q]]=S}},d.prototype._addTile=function(f){var m=this._tiles[f.key];if(m)return m;(m=this._cache.getAndRemove(f))&&(this._setTileReloadTimer(f.key,m),m.tileID=f,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[f.key]&&(clearTimeout(this._cacheTimers[f.key]),delete this._cacheTimers[f.key],this._setTileReloadTimer(f.key,m)));var S=!!m;return S||(m=new h.Tile(f,this._source.tileSize*f.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,f.key,m.state))),m?(m.uses++,this._tiles[f.key]=m,S||this._source.fire(new h.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null},d.prototype._setTileReloadTimer=function(f,m){var S=this;f in this._timers&&(clearTimeout(this._timers[f]),delete this._timers[f]);var R=m.getExpiryTimeout();R&&(this._timers[f]=setTimeout(function(){S._reloadTile(f,"expired"),delete S._timers[f]},R))},d.prototype._removeTile=function(f){var m=this._tiles[f];m&&(m.uses--,delete this._tiles[f],this._timers[f]&&(clearTimeout(this._timers[f]),delete this._timers[f]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))},d.prototype.clearTiles=function(){for(var f in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(f);this._cache.reset()},d.prototype.tilesIn=function(f,m,S){var R=this,L=[],q=this.transform;if(!q)return L;for(var Se=S?q.getCameraQueryGeometry(f):f,Le=f.map(function(Or){return q.pointCoordinate(Or)}),et=Se.map(function(Or){return q.pointCoordinate(Or)}),ot=this.getIds(),st=1/0,Rt=1/0,Ct=-1/0,Xt=-1/0,St=0,$t=et;St<$t.length;St+=1){var tr=$t[St];st=Math.min(st,tr.x),Rt=Math.min(Rt,tr.y),Ct=Math.max(Ct,tr.x),Xt=Math.max(Xt,tr.y)}for(var br=function(Or){var Hr=R._tiles[ot[Or]];if(!Hr.holdingForFade()){var nn=Hr.tileID,M=Math.pow(2,q.zoom-Hr.tileID.overscaledZ),z=m*Hr.queryPadding*h.EXTENT/Hr.tileSize/M,j=[nn.getTilePoint(new h.MercatorCoordinate(st,Rt)),nn.getTilePoint(new h.MercatorCoordinate(Ct,Xt))];if(j[0].x-z<h.EXTENT&&j[0].y-z<h.EXTENT&&j[1].x+z>=0&&j[1].y+z>=0){var ne=Le.map(function(le){return nn.getTilePoint(le)}),ce=et.map(function(le){return nn.getTilePoint(le)});L.push({tile:Hr,tileID:nn,queryGeometry:ne,cameraQueryGeometry:ce,scale:M})}}},kr=0;kr<ot.length;kr++)br(kr);return L},d.prototype.getVisibleCoordinates=function(f){for(var m=this,S=this.getRenderableIds(f).map(function(Se){return m._tiles[Se].tileID}),R=0,L=S;R<L.length;R+=1){var q=L[R];q.posMatrix=this.transform.calculatePosMatrix(q.toUnwrapped())}return S},d.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(G(this._source.type))for(var f in this._tiles){var m=this._tiles[f];if(m.fadeEndTime!==void 0&&m.fadeEndTime>=h.browser.now())return!0}return!1},d.prototype.setFeatureState=function(f,m,S){this._state.updateState(f=f||"_geojsonTileLayer",m,S)},d.prototype.removeFeatureState=function(f,m,S){this._state.removeFeatureState(f=f||"_geojsonTileLayer",m,S)},d.prototype.getFeatureState=function(f,m){return this._state.getState(f=f||"_geojsonTileLayer",m)},d.prototype.setDependencies=function(f,m,S){var R=this._tiles[f];R&&R.setDependencies(m,S)},d.prototype.reloadTilesForDependencies=function(f,m){for(var S in this._tiles)this._tiles[S].hasDependency(f,m)&&this._reloadTile(S,"reloading");this._cache.filter(function(R){return!R.hasDependency(f,m)})},d}(h.Evented);function We(l,d){var f=Math.abs(2*l.wrap)-+(l.wrap<0),m=Math.abs(2*d.wrap)-+(d.wrap<0);return l.overscaledZ-d.overscaledZ||m-f||d.canonical.y-l.canonical.y||d.canonical.x-l.canonical.x}function G(l){return l==="raster"||l==="image"||l==="video"}function rt(){return new h.window.Worker(Gl.workerUrl)}Ge.maxOverzooming=10,Ge.maxUnderzooming=3;var ft="mapboxgl_preloaded_worker_pool",bt=function(){this.active={}};bt.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<bt.workerCount;)this.workers.push(new rt);return this.active[l]=!0,this.workers.slice()},bt.prototype.release=function(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(function(d){d.terminate()}),this.workers=null)},bt.prototype.isPreloaded=function(){return!!this.active[ft]},bt.prototype.numActive=function(){return Object.keys(this.active).length};var Gt,lr=Math.floor(h.browser.hardwareConcurrency/2);function Ht(){return Gt||(Gt=new bt),Gt}function Cr(l,d){var f={};for(var m in l)m!=="ref"&&(f[m]=l[m]);return h.refProperties.forEach(function(S){S in d&&(f[S]=d[S])}),f}function hr(l){l=l.slice();for(var d=Object.create(null),f=0;f<l.length;f++)d[l[f].id]=l[f];for(var m=0;m<l.length;m++)"ref"in l[m]&&(l[m]=Cr(l[m],d[l[m].ref]));return l}bt.workerCount=Math.max(Math.min(lr,6),1);var Dr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Rn(l,d,f){f.push({command:Dr.addSource,args:[l,d[l]]})}function on(l,d,f){d.push({command:Dr.removeSource,args:[l]}),f[l]=!0}function fi(l,d,f,m){on(l,f,m),Rn(l,d,f)}function Mi(l,d,f){var m;for(m in l[f])if(l[f].hasOwnProperty(m)&&m!=="data"&&!h.deepEqual(l[f][m],d[f][m]))return!1;for(m in d[f])if(d[f].hasOwnProperty(m)&&m!=="data"&&!h.deepEqual(l[f][m],d[f][m]))return!1;return!0}function di(l,d,f,m,S,R){var L;for(L in d=d||{},l=l||{})l.hasOwnProperty(L)&&(h.deepEqual(l[L],d[L])||f.push({command:R,args:[m,L,d[L],S]}));for(L in d)d.hasOwnProperty(L)&&!l.hasOwnProperty(L)&&(h.deepEqual(l[L],d[L])||f.push({command:R,args:[m,L,d[L],S]}))}function mn(l){return l.id}function Zn(l,d){return l[d.id]=d,l}var sa=function(l,d){this.reset(l,d)};sa.prototype.reset=function(l,d){this.points=l||[],this._distances=[0];for(var f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding},sa.prototype.lerp=function(l){if(this.points.length===1)return this.points[0];l=h.clamp(l,0,1);for(var d=1,f=this._distances[d],m=l*this.paddedLength+this.padding;f<m&&d<this._distances.length;)f=this._distances[++d];var S=d-1,R=this._distances[S],L=f-R,q=L>0?(m-R)/L:0;return this.points[S].mult(1-q).add(this.points[d].mult(q))};var qi=function(l,d,f){var m=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(l/f),this.yCellCount=Math.ceil(d/f);for(var R=0;R<this.xCellCount*this.yCellCount;R++)m.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0};function Sa(l,d,f,m,S){var R=h.create();return d?(h.scale(R,R,[1/S,1/S,1]),f||h.rotateZ(R,R,m.angle)):h.multiply(R,m.labelPlaneMatrix,l),R}function Zi(l,d,f,m,S){if(d){var R=h.clone(l);return h.scale(R,R,[S,S,1]),f||h.rotateZ(R,R,-m.angle),R}return m.glCoordMatrix}function Oi(l,d){var f=[l.x,l.y,0,1];Ja(f,f,d);var m=f[3];return{point:new h.Point(f[0]/m,f[1]/m),signedDistanceFromCamera:m}}function jr(l,d){return .5+l/d*.5}function Fi(l,d){var f=l[0]/l[3],m=l[1]/l[3];return f>=-d[0]&&f<=d[0]&&m>=-d[1]&&m<=d[1]}function Ls(l,d,f,m,S,R,L,q){var Se=m?l.textSizeData:l.iconSizeData,Le=h.evaluateSizeForZoom(Se,f.transform.zoom),et=[256/f.width*2+1,256/f.height*2+1],ot=m?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;ot.clear();for(var st=l.lineVertexArray,Rt=m?l.text.placedSymbolArray:l.icon.placedSymbolArray,Ct=f.transform.width/f.transform.height,Xt=!1,St=0;St<Rt.length;St++){var $t=Rt.get(St);if($t.hidden||$t.writingMode===h.WritingMode.vertical&&!Xt)za($t.numGlyphs,ot);else{Xt=!1;var tr=[$t.anchorX,$t.anchorY,0,1];if(h.transformMat4(tr,tr,d),Fi(tr,et)){var br=jr(f.transform.cameraToCenterDistance,tr[3]),kr=h.evaluateSizeForFeature(Se,Le,$t),Or=L?kr/br:kr*br,Hr=new h.Point($t.anchorX,$t.anchorY),nn=Oi(Hr,S).point,M={},z=go($t,Or,!1,q,d,S,R,l.glyphOffsetArray,st,ot,nn,Hr,M,Ct);Xt=z.useVertical,(z.notEnoughRoom||Xt||z.needsFlipping&&go($t,Or,!0,q,d,S,R,l.glyphOffsetArray,st,ot,nn,Hr,M,Ct).notEnoughRoom)&&za($t.numGlyphs,ot)}else za($t.numGlyphs,ot)}}m?l.text.dynamicLayoutVertexBuffer.updateData(ot):l.icon.dynamicLayoutVertexBuffer.updateData(ot)}function Ta(l,d,f,m,S,R,L,q,Se,Le,et){var ot=q.glyphStartIndex+q.numGlyphs,st=q.lineStartIndex,Rt=q.lineStartIndex+q.lineLength,Ct=d.getoffsetX(q.glyphStartIndex),Xt=d.getoffsetX(ot-1),St=ka(l*Ct,f,m,S,R,L,q.segment,st,Rt,Se,Le,et);if(!St)return null;var $t=ka(l*Xt,f,m,S,R,L,q.segment,st,Rt,Se,Le,et);return $t?{first:St,last:$t}:null}function Aa(l,d,f,m){return l===h.WritingMode.horizontal&&Math.abs(f.y-d.y)>Math.abs(f.x-d.x)*m?{useVertical:!0}:(l===h.WritingMode.vertical?d.y<f.y:d.x>f.x)?{needsFlipping:!0}:null}function go(l,d,f,m,S,R,L,q,Se,Le,et,ot,st,Rt){var Ct,Xt=d/24,St=l.lineOffsetX*Xt,$t=l.lineOffsetY*Xt;if(l.numGlyphs>1){var tr=l.glyphStartIndex+l.numGlyphs,br=l.lineStartIndex,kr=l.lineStartIndex+l.lineLength,Or=Ta(Xt,q,St,$t,f,et,ot,l,Se,R,st);if(!Or)return{notEnoughRoom:!0};var Hr=Oi(Or.first.point,L).point,nn=Oi(Or.last.point,L).point;if(m&&!f){var M=Aa(l.writingMode,Hr,nn,Rt);if(M)return M}Ct=[Or.first];for(var z=l.glyphStartIndex+1;z<tr-1;z++)Ct.push(ka(Xt*q.getoffsetX(z),St,$t,f,et,ot,l.segment,br,kr,Se,R,st));Ct.push(Or.last)}else{if(m&&!f){var j=Oi(ot,S).point,ne=l.lineStartIndex+l.segment+1,ce=new h.Point(Se.getx(ne),Se.gety(ne)),le=Oi(ce,S),lt=le.signedDistanceFromCamera>0?le.point:os(ot,ce,j,1,S),it=Aa(l.writingMode,j,lt,Rt);if(it)return it}var Yt=ka(Xt*q.getoffsetX(l.glyphStartIndex),St,$t,f,et,ot,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,Se,R,st);if(!Yt)return{notEnoughRoom:!0};Ct=[Yt]}for(var ht=0,er=Ct;ht<er.length;ht+=1){var yr=er[ht];h.addDynamicAttributes(Le,yr.point,yr.angle)}return{}}function os(l,d,f,m,S){var R=Oi(l.add(l.sub(d)._unit()),S).point,L=f.sub(R);return f.add(L._mult(m/L.mag()))}function ka(l,d,f,m,S,R,L,q,Se,Le,et,ot){var st=m?l-d:l+d,Rt=st>0?1:-1,Ct=0;m&&(Rt*=-1,Ct=Math.PI),Rt<0&&(Ct+=Math.PI);for(var Xt=Rt>0?q+L:q+L+1,St=S,$t=S,tr=0,br=0,kr=Math.abs(st),Or=[];tr+br<=kr;){if((Xt+=Rt)<q||Xt>=Se)return null;if($t=St,Or.push(St),(St=ot[Xt])===void 0){var Hr=new h.Point(Le.getx(Xt),Le.gety(Xt)),nn=Oi(Hr,et);if(nn.signedDistanceFromCamera>0)St=ot[Xt]=nn.point;else{var M=Xt-Rt;St=os(tr===0?R:new h.Point(Le.getx(M),Le.gety(M)),Hr,$t,kr-tr+1,et)}}tr+=br,br=$t.dist(St)}var z=(kr-tr)/br,j=St.sub($t),ne=j.mult(z)._add($t);ne._add(j._unit()._perp()._mult(f*Rt));var ce=Ct+Math.atan2(St.y-$t.y,St.x-$t.x);return Or.push(ne),{point:ne,angle:ce,path:Or}}qi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},qi.prototype.insert=function(l,d,f,m,S){this._forEachCell(d,f,m,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(S)},qi.prototype.insertCircle=function(l,d,f,m){this._forEachCell(d-m,f-m,d+m,f+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(f),this.circles.push(m)},qi.prototype._insertBoxCell=function(l,d,f,m,S,R){this.boxCells[S].push(R)},qi.prototype._insertCircleCell=function(l,d,f,m,S,R){this.circleCells[S].push(R)},qi.prototype._query=function(l,d,f,m,S,R){if(f<0||l>this.width||m<0||d>this.height)return!S&&[];var L=[];if(l<=0&&d<=0&&this.width<=f&&this.height<=m){if(S)return!0;for(var q=0;q<this.boxKeys.length;q++)L.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(var Se=0;Se<this.circleKeys.length;Se++){var Le=this.circles[3*Se],et=this.circles[3*Se+1],ot=this.circles[3*Se+2];L.push({key:this.circleKeys[Se],x1:Le-ot,y1:et-ot,x2:Le+ot,y2:et+ot})}return R?L.filter(R):L}return this._forEachCell(l,d,f,m,this._queryCell,L,{hitTest:S,seenUids:{box:{},circle:{}}},R),S?L.length>0:L},qi.prototype._queryCircle=function(l,d,f,m,S){var R=l-f,L=l+f,q=d-f,Se=d+f;if(L<0||R>this.width||Se<0||q>this.height)return!m&&[];var Le=[];return this._forEachCell(R,q,L,Se,this._queryCellCircle,Le,{hitTest:m,circle:{x:l,y:d,radius:f},seenUids:{box:{},circle:{}}},S),m?Le.length>0:Le},qi.prototype.query=function(l,d,f,m,S){return this._query(l,d,f,m,!1,S)},qi.prototype.hitTest=function(l,d,f,m,S){return this._query(l,d,f,m,!0,S)},qi.prototype.hitTestCircle=function(l,d,f,m){return this._queryCircle(l,d,f,!0,m)},qi.prototype._queryCell=function(l,d,f,m,S,R,L,q){var Se=L.seenUids,Le=this.boxCells[S];if(Le!==null)for(var et=this.bboxes,ot=0,st=Le;ot<st.length;ot+=1){var Rt=st[ot];if(!Se.box[Rt]){Se.box[Rt]=!0;var Ct=4*Rt;if(l<=et[Ct+2]&&d<=et[Ct+3]&&f>=et[Ct+0]&&m>=et[Ct+1]&&(!q||q(this.boxKeys[Rt]))){if(L.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[Rt],x1:et[Ct],y1:et[Ct+1],x2:et[Ct+2],y2:et[Ct+3]})}}}var Xt=this.circleCells[S];if(Xt!==null)for(var St=this.circles,$t=0,tr=Xt;$t<tr.length;$t+=1){var br=tr[$t];if(!Se.circle[br]){Se.circle[br]=!0;var kr=3*br;if(this._circleAndRectCollide(St[kr],St[kr+1],St[kr+2],l,d,f,m)&&(!q||q(this.circleKeys[br]))){if(L.hitTest)return R.push(!0),!0;var Or=St[kr],Hr=St[kr+1],nn=St[kr+2];R.push({key:this.circleKeys[br],x1:Or-nn,y1:Hr-nn,x2:Or+nn,y2:Hr+nn})}}}},qi.prototype._queryCellCircle=function(l,d,f,m,S,R,L,q){var Se=L.circle,Le=L.seenUids,et=this.boxCells[S];if(et!==null)for(var ot=this.bboxes,st=0,Rt=et;st<Rt.length;st+=1){var Ct=Rt[st];if(!Le.box[Ct]){Le.box[Ct]=!0;var Xt=4*Ct;if(this._circleAndRectCollide(Se.x,Se.y,Se.radius,ot[Xt+0],ot[Xt+1],ot[Xt+2],ot[Xt+3])&&(!q||q(this.boxKeys[Ct])))return R.push(!0),!0}}var St=this.circleCells[S];if(St!==null)for(var $t=this.circles,tr=0,br=St;tr<br.length;tr+=1){var kr=br[tr];if(!Le.circle[kr]){Le.circle[kr]=!0;var Or=3*kr;if(this._circlesCollide($t[Or],$t[Or+1],$t[Or+2],Se.x,Se.y,Se.radius)&&(!q||q(this.circleKeys[kr])))return R.push(!0),!0}}},qi.prototype._forEachCell=function(l,d,f,m,S,R,L,q){for(var Se=this._convertToXCellCoord(l),Le=this._convertToYCellCoord(d),et=this._convertToXCellCoord(f),ot=this._convertToYCellCoord(m),st=Se;st<=et;st++)for(var Rt=Le;Rt<=ot;Rt++)if(S.call(this,l,d,f,m,this.xCellCount*Rt+st,R,L,q))return},qi.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},qi.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},qi.prototype._circlesCollide=function(l,d,f,m,S,R){var L=m-l,q=S-d,Se=f+R;return Se*Se>L*L+q*q},qi.prototype._circleAndRectCollide=function(l,d,f,m,S,R,L){var q=(R-m)/2,Se=Math.abs(l-(m+q));if(Se>q+f)return!1;var Le=(L-S)/2,et=Math.abs(d-(S+Le));if(et>Le+f)return!1;if(Se<=q||et<=Le)return!0;var ot=Se-q,st=et-Le;return ot*ot+st*st<=f*f};var Ao=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function za(l,d){for(var f=0;f<l;f++){var m=d.length;d.resize(m+4),d.float32.set(Ao,3*m)}}function Ja(l,d,f){var m=d[0],S=d[1];return l[0]=f[0]*m+f[4]*S+f[12],l[1]=f[1]*m+f[5]*S+f[13],l[3]=f[3]*m+f[7]*S+f[15],l}var Oa=function(l,d,f){d===void 0&&(d=new qi(l.width+200,l.height+200,25)),f===void 0&&(f=new qi(l.width+200,l.height+200,25)),this.transform=l,this.grid=d,this.ignoredGrid=f,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function Za(l,d,f){return d*(h.EXTENT/(l.tileSize*Math.pow(2,f-l.tileID.overscaledZ)))}Oa.prototype.placeCollisionBox=function(l,d,f,m,S){var R=this.projectAndGetPerspectiveRatio(m,l.anchorPointX,l.anchorPointY),L=f*R.perspectiveRatio,q=l.x1*L+R.point.x,Se=l.y1*L+R.point.y,Le=l.x2*L+R.point.x,et=l.y2*L+R.point.y;return!this.isInsideGrid(q,Se,Le,et)||!d&&this.grid.hitTest(q,Se,Le,et,S)?{box:[],offscreen:!1}:{box:[q,Se,Le,et],offscreen:this.isOffscreen(q,Se,Le,et)}},Oa.prototype.placeCollisionCircles=function(l,d,f,m,S,R,L,q,Se,Le,et,ot,st){var Rt=[],Ct=new h.Point(d.anchorX,d.anchorY),Xt=Oi(Ct,R),St=jr(this.transform.cameraToCenterDistance,Xt.signedDistanceFromCamera),$t=(Le?S/St:S*St)/h.ONE_EM,tr=Oi(Ct,L).point,br=Ta($t,m,d.lineOffsetX*$t,d.lineOffsetY*$t,!1,tr,Ct,d,f,L,{}),kr=!1,Or=!1,Hr=!0;if(br){for(var nn=.5*ot*St+st,M=new h.Point(-100,-100),z=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),j=new sa,ne=br.first,ce=br.last,le=[],lt=ne.path.length-1;lt>=1;lt--)le.push(ne.path[lt]);for(var it=1;it<ce.path.length;it++)le.push(ce.path[it]);var Yt=2.5*nn;if(q){var ht=le.map(function(da){return Oi(da,q)});le=ht.some(function(da){return da.signedDistanceFromCamera<=0})?[]:ht.map(function(da){return da.point})}var er=[];if(le.length>0){for(var yr=le[0].clone(),_n=le[0].clone(),vn=1;vn<le.length;vn++)yr.x=Math.min(yr.x,le[vn].x),yr.y=Math.min(yr.y,le[vn].y),_n.x=Math.max(_n.x,le[vn].x),_n.y=Math.max(_n.y,le[vn].y);er=yr.x>=M.x&&_n.x<=z.x&&yr.y>=M.y&&_n.y<=z.y?[le]:_n.x<M.x||yr.x>z.x||_n.y<M.y||yr.y>z.y?[]:h.clipLine([le],M.x,M.y,z.x,z.y)}for(var Jr=0,Gn=er;Jr<Gn.length;Jr+=1){var Xn;j.reset(Gn[Jr],.25*nn),Xn=j.length<=.5*nn?1:Math.ceil(j.paddedLength/Yt)+1;for(var Yn=0;Yn<Xn;Yn++){var gi=Yn/Math.max(Xn-1,1),xi=j.lerp(gi),Ni=xi.x+100,Pa=xi.y+100;Rt.push(Ni,Pa,nn,0);var Ua=Ni-nn,Mo=Pa-nn,ga=Ni+nn,Xi=Pa+nn;if(Hr=Hr&&this.isOffscreen(Ua,Mo,ga,Xi),Or=Or||this.isInsideGrid(Ua,Mo,ga,Xi),!l&&this.grid.hitTestCircle(Ni,Pa,nn,et)&&(kr=!0,!Se))return{circles:[],offscreen:!1,collisionDetected:kr}}}}return{circles:!Se&&kr||!Or?[]:Rt,offscreen:Hr,collisionDetected:kr}},Oa.prototype.queryRenderedSymbols=function(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var d=[],f=1/0,m=1/0,S=-1/0,R=-1/0,L=0,q=l;L<q.length;L+=1){var Se=q[L],Le=new h.Point(Se.x+100,Se.y+100);f=Math.min(f,Le.x),m=Math.min(m,Le.y),S=Math.max(S,Le.x),R=Math.max(R,Le.y),d.push(Le)}for(var et={},ot={},st=0,Rt=this.grid.query(f,m,S,R).concat(this.ignoredGrid.query(f,m,S,R));st<Rt.length;st+=1){var Ct=Rt[st],Xt=Ct.key;if(et[Xt.bucketInstanceId]===void 0&&(et[Xt.bucketInstanceId]={}),!et[Xt.bucketInstanceId][Xt.featureIndex]){var St=[new h.Point(Ct.x1,Ct.y1),new h.Point(Ct.x2,Ct.y1),new h.Point(Ct.x2,Ct.y2),new h.Point(Ct.x1,Ct.y2)];h.polygonIntersectsPolygon(d,St)&&(et[Xt.bucketInstanceId][Xt.featureIndex]=!0,ot[Xt.bucketInstanceId]===void 0&&(ot[Xt.bucketInstanceId]=[]),ot[Xt.bucketInstanceId].push(Xt.featureIndex))}}return ot},Oa.prototype.insertCollisionBox=function(l,d,f,m,S){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:m,collisionGroupID:S},l[0],l[1],l[2],l[3])},Oa.prototype.insertCollisionCircles=function(l,d,f,m,S){for(var R=d?this.ignoredGrid:this.grid,L={bucketInstanceId:f,featureIndex:m,collisionGroupID:S},q=0;q<l.length;q+=4)R.insertCircle(L,l[q],l[q+1],l[q+2])},Oa.prototype.projectAndGetPerspectiveRatio=function(l,d,f){var m=[d,f,0,1];return Ja(m,m,l),{point:new h.Point((m[0]/m[3]+1)/2*this.transform.width+100,(-m[1]/m[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}},Oa.prototype.isOffscreen=function(l,d,f,m){return f<100||l>=this.screenRightBoundary||m<100||d>this.screenBottomBoundary},Oa.prototype.isInsideGrid=function(l,d,f,m){return f>=0&&l<this.gridRightBoundary&&m>=0&&d<this.gridBottomBoundary},Oa.prototype.getViewportMatrix=function(){var l=h.identity([]);return h.translate(l,l,[-100,-100,0]),l};var qo=function(l,d,f,m){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):m&&f?1:0,this.placed=f};qo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Ca=function(l,d,f,m,S){this.text=new qo(l?l.text:null,d,f,S),this.icon=new qo(l?l.icon:null,d,m,S)};Ca.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var io=function(l,d,f){this.text=l,this.icon=d,this.skipFade=f},Do=function(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]},$=function(l,d,f,m,S){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=f,this.bucketIndex=m,this.tileID=S},ho=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function ja(l,d,f,m,S){var R=h.getAnchorAlignment(l),L=-(R.horizontalAlign-.5)*d,q=-(R.verticalAlign-.5)*f,Se=h.evaluateVariableOffset(l,m);return new h.Point(L+Se[0]*S,q+Se[1]*S)}function gs(l,d,f,m,S,R){var L=l.x1,q=l.x2,Se=l.y1,Le=l.y2,et=l.anchorPointX,ot=l.anchorPointY,st=new h.Point(d,f);return m&&st._rotate(S?R:-R),{x1:L+st.x,y1:Se+st.y,x2:q+st.x,y2:Le+st.y,anchorPointX:et,anchorPointY:ot}}ho.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:function(f){return f.collisionGroupID===d}}}return this.collisionGroups[l]};var Vo=function(l,d,f,m){this.transform=l.clone(),this.collisionIndex=new Oa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new ho(f),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}};function Je(l,d,f,m,S){l.emplaceBack(d?1:0,f?1:0,m||0,S||0),l.emplaceBack(d?1:0,f?1:0,m||0,S||0),l.emplaceBack(d?1:0,f?1:0,m||0,S||0),l.emplaceBack(d?1:0,f?1:0,m||0,S||0)}Vo.prototype.getBucketParts=function(l,d,f,m){var S=f.getBucket(d),R=f.latestFeatureIndex;if(S&&R&&d.id===S.layerIds[0]){var L=f.collisionBoxArray,q=S.layers[0].layout,Se=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),Le=f.tileSize/h.EXTENT,et=this.transform.calculatePosMatrix(f.tileID.toUnwrapped()),ot=q.get("text-pitch-alignment")==="map",st=q.get("text-rotation-alignment")==="map",Rt=Za(f,1,this.transform.zoom),Ct=Sa(et,ot,st,this.transform,Rt),Xt=null;if(ot){var St=Zi(et,ot,st,this.transform,Rt);Xt=h.multiply([],this.transform.labelPlaneMatrix,St)}this.retainedQueryData[S.bucketInstanceId]=new $(S.bucketInstanceId,R,S.sourceLayerIndex,S.index,f.tileID);var $t={bucket:S,layout:q,posMatrix:et,textLabelPlaneMatrix:Ct,labelToScreenMatrix:Xt,scale:Se,textPixelRatio:Le,holdingForFade:f.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(m)for(var tr=0,br=S.sortKeyRanges;tr<br.length;tr+=1){var kr=br[tr];l.push({sortKey:kr.sortKey,symbolInstanceStart:kr.symbolInstanceStart,symbolInstanceEnd:kr.symbolInstanceEnd,parameters:$t})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:$t})}},Vo.prototype.attemptAnchorPlacement=function(l,d,f,m,S,R,L,q,Se,Le,et,ot,st,Rt,Ct){var Xt,St=[ot.textOffset0,ot.textOffset1],$t=ja(l,f,m,St,S),tr=this.collisionIndex.placeCollisionBox(gs(d,$t.x,$t.y,R,L,this.transform.angle),et,q,Se,Le.predicate);if(!Ct||this.collisionIndex.placeCollisionBox(gs(Ct,$t.x,$t.y,R,L,this.transform.angle),et,q,Se,Le.predicate).box.length!==0)return tr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ot.crossTileID]&&this.prevPlacement.placements[ot.crossTileID]&&this.prevPlacement.placements[ot.crossTileID].text&&(Xt=this.prevPlacement.variableOffsets[ot.crossTileID].anchor),this.variableOffsets[ot.crossTileID]={textOffset:St,width:f,height:m,anchor:l,textBoxScale:S,prevAnchor:Xt},this.markUsedJustification(st,l,ot,Rt),st.allowVerticalPlacement&&(this.markUsedOrientation(st,Rt,ot),this.placedOrientations[ot.crossTileID]=Rt),{shift:$t,placedGlyphBoxes:tr}):void 0},Vo.prototype.placeLayerBucketPart=function(l,d,f){var m=this,S=l.parameters,R=S.bucket,L=S.layout,q=S.posMatrix,Se=S.textLabelPlaneMatrix,Le=S.labelToScreenMatrix,et=S.textPixelRatio,ot=S.holdingForFade,st=S.collisionBoxArray,Rt=S.partiallyEvaluatedTextSize,Ct=S.collisionGroup,Xt=L.get("text-optional"),St=L.get("icon-optional"),$t=L.get("text-allow-overlap"),tr=L.get("icon-allow-overlap"),br=L.get("text-rotation-alignment")==="map",kr=L.get("text-pitch-alignment")==="map",Or=L.get("icon-text-fit")!=="none",Hr=L.get("symbol-z-order")==="viewport-y",nn=$t&&(tr||!R.hasIconData()||St),M=tr&&($t||!R.hasTextData()||Xt);!R.collisionArrays&&st&&R.deserializeCollisionBoxes(st);var z=function(it,Yt){if(!d[it.crossTileID])if(ot)m.placements[it.crossTileID]=new io(!1,!1,!1);else{var ht,er=!1,yr=!1,_n=!0,vn=null,Jr={box:null,offscreen:null},Gn={box:null,offscreen:null},Xn=null,Yn=null,gi=0,xi=0,Ni=0;Yt.textFeatureIndex?gi=Yt.textFeatureIndex:it.useRuntimeCollisionCircles&&(gi=it.featureIndex),Yt.verticalTextFeatureIndex&&(xi=Yt.verticalTextFeatureIndex);var Pa=Yt.textBox;if(Pa){var Ua=function(Ma){var bs=h.WritingMode.horizontal;if(R.allowVerticalPlacement&&!Ma&&m.prevPlacement){var xs=m.prevPlacement.placedOrientations[it.crossTileID];xs&&(m.placedOrientations[it.crossTileID]=xs,m.markUsedOrientation(R,bs=xs,it))}return bs},Mo=function(Ma,bs){if(R.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Yt.verticalTextBox)for(var xs=0,sc=R.writingModes;xs<sc.length&&(sc[xs]===h.WritingMode.vertical?(Jr=bs(),Gn=Jr):Jr=Ma(),!(Jr&&Jr.box&&Jr.box.length));xs+=1);else Jr=Ma()};if(L.get("text-variable-anchor")){var ga=L.get("text-variable-anchor");if(m.prevPlacement&&m.prevPlacement.variableOffsets[it.crossTileID]){var Xi=m.prevPlacement.variableOffsets[it.crossTileID];ga.indexOf(Xi.anchor)>0&&(ga=ga.filter(function(Ma){return Ma!==Xi.anchor})).unshift(Xi.anchor)}var da=function(Ma,bs,xs){for(var sc=Ma.x2-Ma.x1,rh=Ma.y2-Ma.y1,uc=it.textBoxScale,Uf=Or&&!tr?bs:null,qc={box:[],offscreen:!1},Fc=$t?2*ga.length:ga.length,Yl=0;Yl<Fc;++Yl){var zf=m.attemptAnchorPlacement(ga[Yl%ga.length],Ma,sc,rh,uc,br,kr,et,q,Ct,Yl>=ga.length,it,R,xs,Uf);if(zf&&(qc=zf.placedGlyphBoxes)&&qc.box&&qc.box.length){er=!0,vn=zf.shift;break}}return qc};Mo(function(){return da(Pa,Yt.iconBox,h.WritingMode.horizontal)},function(){var Ma=Yt.verticalTextBox;return R.allowVerticalPlacement&&!(Jr&&Jr.box&&Jr.box.length)&&it.numVerticalGlyphVertices>0&&Ma?da(Ma,Yt.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),Jr&&(er=Jr.box,_n=Jr.offscreen);var Go=Ua(Jr&&Jr.box);if(!er&&m.prevPlacement){var ls=m.prevPlacement.variableOffsets[it.crossTileID];ls&&(m.variableOffsets[it.crossTileID]=ls,m.markUsedJustification(R,ls.anchor,it,Go))}}else{var Uo=function(Ma,bs){var xs=m.collisionIndex.placeCollisionBox(Ma,$t,et,q,Ct.predicate);return xs&&xs.box&&xs.box.length&&(m.markUsedOrientation(R,bs,it),m.placedOrientations[it.crossTileID]=bs),xs};Mo(function(){return Uo(Pa,h.WritingMode.horizontal)},function(){var Ma=Yt.verticalTextBox;return R.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Ma?Uo(Ma,h.WritingMode.vertical):{box:null,offscreen:null}}),Ua(Jr&&Jr.box&&Jr.box.length)}}if(er=(ht=Jr)&&ht.box&&ht.box.length>0,_n=ht&&ht.offscreen,it.useRuntimeCollisionCircles){var Xo=R.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),Rs=h.evaluateSizeForFeature(R.textSizeData,Rt,Xo),xo=L.get("text-padding");Xn=m.collisionIndex.placeCollisionCircles($t,Xo,R.lineVertexArray,R.glyphOffsetArray,Rs,q,Se,Le,f,kr,Ct.predicate,it.collisionCircleDiameter,xo),er=$t||Xn.circles.length>0&&!Xn.collisionDetected,_n=_n&&Xn.offscreen}if(Yt.iconFeatureIndex&&(Ni=Yt.iconFeatureIndex),Yt.iconBox){var fl=function(Ma){var bs=Or&&vn?gs(Ma,vn.x,vn.y,br,kr,m.transform.angle):Ma;return m.collisionIndex.placeCollisionBox(bs,tr,et,q,Ct.predicate)};yr=Gn&&Gn.box&&Gn.box.length&&Yt.verticalIconBox?(Yn=fl(Yt.verticalIconBox)).box.length>0:(Yn=fl(Yt.iconBox)).box.length>0,_n=_n&&Yn.offscreen}var ms=Xt||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,Yo=St||it.numIconVertices===0;if(ms||Yo?Yo?ms||(yr=yr&&er):er=yr&&er:yr=er=yr&&er,er&&ht&&ht.box&&m.collisionIndex.insertCollisionBox(ht.box,L.get("text-ignore-placement"),R.bucketInstanceId,Gn&&Gn.box&&xi?xi:gi,Ct.ID),yr&&Yn&&m.collisionIndex.insertCollisionBox(Yn.box,L.get("icon-ignore-placement"),R.bucketInstanceId,Ni,Ct.ID),Xn&&(er&&m.collisionIndex.insertCollisionCircles(Xn.circles,L.get("text-ignore-placement"),R.bucketInstanceId,gi,Ct.ID),f)){var Lu=R.bucketInstanceId,hl=m.collisionCircleArrays[Lu];hl===void 0&&(hl=m.collisionCircleArrays[Lu]=new Do);for(var Xl=0;Xl<Xn.circles.length;Xl+=4)hl.circles.push(Xn.circles[Xl+0]),hl.circles.push(Xn.circles[Xl+1]),hl.circles.push(Xn.circles[Xl+2]),hl.circles.push(Xn.collisionDetected?1:0)}m.placements[it.crossTileID]=new io(er||nn,yr||M,_n||R.justReloaded),d[it.crossTileID]=!0}};if(Hr)for(var j=R.getSortedSymbolIndexes(this.transform.angle),ne=j.length-1;ne>=0;--ne){var ce=j[ne];z(R.symbolInstances.get(ce),R.collisionArrays[ce])}else for(var le=l.symbolInstanceStart;le<l.symbolInstanceEnd;le++)z(R.symbolInstances.get(le),R.collisionArrays[le]);if(f&&R.bucketInstanceId in this.collisionCircleArrays){var lt=this.collisionCircleArrays[R.bucketInstanceId];h.invert(lt.invProjMatrix,q),lt.viewportMatrix=this.collisionIndex.getViewportMatrix()}R.justReloaded=!1},Vo.prototype.markUsedJustification=function(l,d,f,m){var S;S=m===h.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(d)];for(var R=0,L=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];R<L.length;R+=1){var q=L[R];q>=0&&(l.text.placedSymbolArray.get(q).crossTileID=S>=0&&q!==S?0:f.crossTileID)}},Vo.prototype.markUsedOrientation=function(l,d,f){for(var m=d===h.WritingMode.horizontal||d===h.WritingMode.horizontalOnly?d:0,S=d===h.WritingMode.vertical?d:0,R=0,L=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];R<L.length;R+=1)l.text.placedSymbolArray.get(L[R]).placedOrientation=m;f.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=S)},Vo.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var d=this.prevPlacement,f=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;var m=d?d.symbolFadeChange(l):1,S=d?d.opacities:{},R=d?d.variableOffsets:{},L=d?d.placedOrientations:{};for(var q in this.placements){var Se=this.placements[q],Le=S[q];Le?(this.opacities[q]=new Ca(Le,m,Se.text,Se.icon),f=f||Se.text!==Le.text.placed||Se.icon!==Le.icon.placed):(this.opacities[q]=new Ca(null,m,Se.text,Se.icon,Se.skipFade),f=f||Se.text||Se.icon)}for(var et in S){var ot=S[et];if(!this.opacities[et]){var st=new Ca(ot,m,!1,!1);st.isHidden()||(this.opacities[et]=st,f=f||ot.text.placed||ot.icon.placed)}}for(var Rt in R)this.variableOffsets[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.variableOffsets[Rt]=R[Rt]);for(var Ct in L)this.placedOrientations[Ct]||!this.opacities[Ct]||this.opacities[Ct].isHidden()||(this.placedOrientations[Ct]=L[Ct]);f?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)},Vo.prototype.updateLayerOpacities=function(l,d){for(var f={},m=0,S=d;m<S.length;m+=1){var R=S[m],L=R.getBucket(l);L&&R.latestFeatureIndex&&l.id===L.layerIds[0]&&this.updateBucketOpacities(L,f,R.collisionBoxArray)}},Vo.prototype.updateBucketOpacities=function(l,d,f){var m=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var S=l.layers[0].layout,R=new Ca(null,0,!1,!1,!0),L=S.get("text-allow-overlap"),q=S.get("icon-allow-overlap"),Se=S.get("text-variable-anchor"),Le=S.get("text-rotation-alignment")==="map",et=S.get("text-pitch-alignment")==="map",ot=S.get("icon-text-fit")!=="none",st=new Ca(null,0,L&&(q||!l.hasIconData()||S.get("icon-optional")),q&&(L||!l.hasTextData()||S.get("text-optional")),!0);!l.collisionArrays&&f&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(f);for(var Rt=function($t,tr,br){for(var kr=0;kr<tr/4;kr++)$t.opacityVertexArray.emplaceBack(br)},Ct=function($t){var tr=l.symbolInstances.get($t),br=tr.numHorizontalGlyphVertices,kr=tr.numVerticalGlyphVertices,Or=tr.crossTileID,Hr=m.opacities[Or];d[Or]?Hr=R:Hr||(m.opacities[Or]=Hr=st),d[Or]=!0;var nn=tr.numIconVertices>0,M=m.placedOrientations[tr.crossTileID],z=M===h.WritingMode.vertical,j=M===h.WritingMode.horizontal||M===h.WritingMode.horizontalOnly;if(br>0||kr>0){var ne=ss(Hr.text);Rt(l.text,br,z?ko:ne),Rt(l.text,kr,j?ko:ne);var ce=Hr.text.isHidden();[tr.rightJustifiedTextSymbolIndex,tr.centerJustifiedTextSymbolIndex,tr.leftJustifiedTextSymbolIndex].forEach(function(Jr){Jr>=0&&(l.text.placedSymbolArray.get(Jr).hidden=ce||z?1:0)}),tr.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(tr.verticalPlacedTextSymbolIndex).hidden=ce||j?1:0);var le=m.variableOffsets[tr.crossTileID];le&&m.markUsedJustification(l,le.anchor,tr,M);var lt=m.placedOrientations[tr.crossTileID];lt&&(m.markUsedJustification(l,"left",tr,lt),m.markUsedOrientation(l,lt,tr))}if(nn){var it=ss(Hr.icon),Yt=!(ot&&tr.verticalPlacedIconSymbolIndex&&z);tr.placedIconSymbolIndex>=0&&(Rt(l.icon,tr.numIconVertices,Yt?it:ko),l.icon.placedSymbolArray.get(tr.placedIconSymbolIndex).hidden=Hr.icon.isHidden()),tr.verticalPlacedIconSymbolIndex>=0&&(Rt(l.icon,tr.numVerticalIconVertices,Yt?ko:it),l.icon.placedSymbolArray.get(tr.verticalPlacedIconSymbolIndex).hidden=Hr.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var ht=l.collisionArrays[$t];if(ht){var er=new h.Point(0,0);if(ht.textBox||ht.verticalTextBox){var yr=!0;if(Se){var _n=m.variableOffsets[Or];_n?(er=ja(_n.anchor,_n.width,_n.height,_n.textOffset,_n.textBoxScale),Le&&er._rotate(et?m.transform.angle:-m.transform.angle)):yr=!1}ht.textBox&&Je(l.textCollisionBox.collisionVertexArray,Hr.text.placed,!yr||z,er.x,er.y),ht.verticalTextBox&&Je(l.textCollisionBox.collisionVertexArray,Hr.text.placed,!yr||j,er.x,er.y)}var vn=!!(!j&&ht.verticalIconBox);ht.iconBox&&Je(l.iconCollisionBox.collisionVertexArray,Hr.icon.placed,vn,ot?er.x:0,ot?er.y:0),ht.verticalIconBox&&Je(l.iconCollisionBox.collisionVertexArray,Hr.icon.placed,!vn,ot?er.x:0,ot?er.y:0)}}},Xt=0;Xt<l.symbolInstances.length;Xt++)Ct(Xt);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var St=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=St.invProjMatrix,l.placementViewportMatrix=St.viewportMatrix,l.collisionCircleArray=St.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},Vo.prototype.symbolFadeChange=function(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Vo.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},Vo.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},Vo.prototype.stillRecent=function(l,d){var f=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*f>l},Vo.prototype.setStale=function(){this.stale=!0};var yt=Math.pow(2,25),Qt=Math.pow(2,24),Ur=Math.pow(2,17),Tn=Math.pow(2,16),mi=Math.pow(2,9),la=Math.pow(2,8),Ho=Math.pow(2,1);function ss(l){if(l.opacity===0&&!l.placed)return 0;if(l.opacity===1&&l.placed)return 4294967295;var d=l.placed?1:0,f=Math.floor(127*l.opacity);return f*yt+d*Qt+f*Ur+d*Tn+f*mi+d*la+f*Ho+d}var ko=0,gu=function(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};gu.prototype.continuePlacement=function(l,d,f,m,S){for(var R=this._bucketParts;this._currentTileIndex<l.length;)if(d.getBucketParts(R,m,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort(function(L,q){return L.sortKey-q.sortKey}));this._currentPartIndex<R.length;)if(d.placeLayerBucketPart(R[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,S())return!0;return!1};var Ws=function(l,d,f,m,S,R,L){this.placement=new Vo(l,S,R,L),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=m,this._done=!1};Ws.prototype.isDone=function(){return this._done},Ws.prototype.continuePlacement=function(l,d,f){for(var m=this,S=h.browser.now(),R=function(){var Se=h.browser.now()-S;return!m._forceFullPlacement&&Se>2};this._currentPlacementIndex>=0;){var L=d[l[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=q)&&(!L.maxzoom||L.maxzoom>q)){if(this._inProgressLayer||(this._inProgressLayer=new gu(L)),this._inProgressLayer.continuePlacement(f[L.source],this.placement,this._showCollisionBoxes,L,R))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ws.prototype.commit=function(l){return this.placement.commit(l),this.placement};var cf=512/h.EXTENT/2,ff=function(l,d,f){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(var m=0;m<d.length;m++){var S=d.get(m),R=S.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,l)})}};ff.prototype.getScaledCoordinates=function(l,d){var f=cf/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*h.EXTENT+l.anchorX)*f),y:Math.floor((d.canonical.y*h.EXTENT+l.anchorY)*f)}},ff.prototype.findMatches=function(l,d,f){for(var m=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),S=0;S<l.length;S++){var R=l.get(S);if(!R.crossTileID){var L=this.indexedSymbolInstances[R.key];if(L)for(var q=this.getScaledCoordinates(R,d),Se=0,Le=L;Se<Le.length;Se+=1){var et=Le[Se];if(Math.abs(et.coord.x-q.x)<=m&&Math.abs(et.coord.y-q.y)<=m&&!f[et.crossTileID]){f[et.crossTileID]=!0,R.crossTileID=et.crossTileID;break}}}}};var ys=function(){this.maxCrossTileID=0};ys.prototype.generate=function(){return++this.maxCrossTileID};var bl=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};bl.prototype.handleWrapJump=function(l){var d=Math.round((l-this.lng)/360);if(d!==0)for(var f in this.indexes){var m=this.indexes[f],S={};for(var R in m){var L=m[R];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+d),S[L.tileID.key]=L}this.indexes[f]=S}this.lng=l},bl.prototype.addBucket=function(l,d,f){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var m=0;m<d.symbolInstances.length;m++)d.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var S=this.usedCrossTileIDs[l.overscaledZ];for(var R in this.indexes){var L=this.indexes[R];if(Number(R)>l.overscaledZ)for(var q in L){var Se=L[q];Se.tileID.isChildOf(l)&&Se.findMatches(d.symbolInstances,l,S)}else{var Le=L[l.scaledTo(Number(R)).key];Le&&Le.findMatches(d.symbolInstances,l,S)}}for(var et=0;et<d.symbolInstances.length;et++){var ot=d.symbolInstances.get(et);ot.crossTileID||(ot.crossTileID=f.generate(),S[ot.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new ff(l,d.symbolInstances,d.bucketInstanceId),!0},bl.prototype.removeBucketCrossTileIDs=function(l,d){for(var f in d.indexedSymbolInstances)for(var m=0,S=d.indexedSymbolInstances[f];m<S.length;m+=1)delete this.usedCrossTileIDs[l][S[m].crossTileID]},bl.prototype.removeStaleBuckets=function(l){var d=!1;for(var f in this.indexes){var m=this.indexes[f];for(var S in m)l[m[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,m[S]),delete m[S],d=!0)}return d};var xl=function(){this.layerIndexes={},this.crossTileIDs=new ys,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};xl.prototype.addLayer=function(l,d,f){var m=this.layerIndexes[l.id];m===void 0&&(m=this.layerIndexes[l.id]=new bl);var S=!1,R={};m.handleWrapJump(f);for(var L=0,q=d;L<q.length;L+=1){var Se=q[L],Le=Se.getBucket(l);Le&&l.id===Le.layerIds[0]&&(Le.bucketInstanceId||(Le.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(Se.tileID,Le,this.crossTileIDs)&&(S=!0),R[Le.bucketInstanceId]=!0)}return m.removeStaleBuckets(R)&&(S=!0),S},xl.prototype.pruneUnusedLayers=function(l){var d={};for(var f in l.forEach(function(m){d[m]=!0}),this.layerIndexes)d[f]||delete this.layerIndexes[f]};var ds=function(l,d){return h.emitValidationErrors(l,d&&d.filter(function(f){return f.identifier!=="source.canvas"}))},Qu=h.pick(Dr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),El=h.pick(Dr,["setCenter","setZoom","setBearing","setPitch"]),Fl=function(){var l={},d=h.styleSpec.$version;for(var f in h.styleSpec.$root){var m,S=h.styleSpec.$root[f];S.required&&(m=f==="version"?d:S.type==="array"?[]:{})!=null&&(l[f]=m)}return l}(),gn=function(l){function d(f,m){var S=this;m===void 0&&(m={}),l.call(this),this.map=f,this.dispatcher=new fe(Ht(),this),this.imageManager=new J,this.imageManager.setEventedParent(this),this.glyphManager=new Ae(f._requestManager,m.localIdeographFontFamily),this.lineAtlas=new ge(256,512),this.crossTileSymbolIndex=new xl,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());var R=this;this._rtlTextPluginCallback=d.registerForPluginStateChange(function(L){R.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(q,Se){if(h.triggerPluginCompletionEvent(q),Se&&Se.every(function(et){return et}))for(var Le in R.sourceCaches)R.sourceCaches[Le].reload()})}),this.on("data",function(L){if(L.dataType==="source"&&L.sourceDataType==="metadata"){var q=S.sourceCaches[L.sourceId];if(q){var Se=q.getSource();if(Se&&Se.vectorLayerIds)for(var Le in S._layers){var et=S._layers[Le];et.source===Se.id&&S._validateLayer(et)}}}})}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.loadURL=function(f,m){var S=this;m===void 0&&(m={}),this.fire(new h.Event("dataloading",{dataType:"style"}));var R=typeof m.validate=="boolean"?m.validate:!h.isMapboxURL(f);f=this.map._requestManager.normalizeStyleURL(f,m.accessToken);var L=this.map._requestManager.transformRequest(f,h.ResourceType.Style);this._request=h.getJSON(L,function(q,Se){S._request=null,q?S.fire(new h.ErrorEvent(q)):Se&&S._load(Se,R)})},d.prototype.loadJSON=function(f,m){var S=this;m===void 0&&(m={}),this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.browser.frame(function(){S._request=null,S._load(f,m.validate!==!1)})},d.prototype.loadEmpty=function(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Fl,!1)},d.prototype._load=function(f,m){if(!m||!ds(this,h.validateStyle(f))){for(var S in this._loaded=!0,this.stylesheet=f,f.sources)this.addSource(S,f.sources[S],{validate:!1});f.sprite?this._loadSprite(f.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(f.glyphs);var R=hr(this.stylesheet.layers);this._order=R.map(function(Le){return Le.id}),this._layers={},this._serializedLayers={};for(var L=0,q=R;L<q.length;L+=1){var Se=q[L];(Se=h.createStyleLayer(Se)).setEventedParent(this,{layer:{id:Se.id}}),this._layers[Se.id]=Se,this._serializedLayers[Se.id]=Se.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new me(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}},d.prototype._loadSprite=function(f){var m=this;this._spriteRequest=function(S,R,L){var q,Se,Le,et=h.browser.devicePixelRatio>1?"@2x":"",ot=h.getJSON(R.transformRequest(R.normalizeSpriteURL(S,et,".json"),h.ResourceType.SpriteJSON),function(Ct,Xt){ot=null,Le||(Le=Ct,q=Xt,Rt())}),st=h.getImage(R.transformRequest(R.normalizeSpriteURL(S,et,".png"),h.ResourceType.SpriteImage),function(Ct,Xt){st=null,Le||(Le=Ct,Se=Xt,Rt())});function Rt(){if(Le)L(Le);else if(q&&Se){var Ct=h.browser.getImageData(Se),Xt={};for(var St in q){var $t=q[St],tr=$t.width,br=$t.height,kr=$t.x,Or=$t.y,Hr=$t.sdf,nn=$t.pixelRatio,M=$t.stretchX,z=$t.stretchY,j=$t.content,ne=new h.RGBAImage({width:tr,height:br});h.RGBAImage.copy(Ct,ne,{x:kr,y:Or},{x:0,y:0},{width:tr,height:br}),Xt[St]={data:ne,pixelRatio:nn,sdf:Hr,stretchX:M,stretchY:z,content:j}}L(null,Xt)}}return{cancel:function(){ot&&(ot.cancel(),ot=null),st&&(st.cancel(),st=null)}}}(f,this.map._requestManager,function(S,R){if(m._spriteRequest=null,S)m.fire(new h.ErrorEvent(S));else if(R)for(var L in R)m.imageManager.addImage(L,R[L]);m.imageManager.setLoaded(!0),m._availableImages=m.imageManager.listImages(),m.dispatcher.broadcast("setImages",m._availableImages),m.fire(new h.Event("data",{dataType:"style"}))})},d.prototype._validateLayer=function(f){var m=this.sourceCaches[f.source];if(m){var S=f.sourceLayer;if(S){var R=m.getSource();(R.type==="geojson"||R.vectorLayerIds&&R.vectorLayerIds.indexOf(S)===-1)&&this.fire(new h.ErrorEvent(new Error('Source layer "'+S+'" does not exist on source "'+R.id+'" as specified by style layer "'+f.id+'"')))}}},d.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var f in this.sourceCaches)if(!this.sourceCaches[f].loaded())return!1;return!!this.imageManager.isLoaded()},d.prototype._serializeLayers=function(f){for(var m=[],S=0,R=f;S<R.length;S+=1){var L=this._layers[R[S]];L.type!=="custom"&&m.push(L.serialize())}return m},d.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(var m in this._layers)if(this._layers[m].hasTransition())return!0;return!1},d.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},d.prototype.update=function(f){if(this._loaded){var m=this._changed;if(this._changed){var S=Object.keys(this._updatedLayers),R=Object.keys(this._removedLayers);for(var L in(S.length||R.length)&&this._updateWorkerLayers(S,R),this._updatedSources){var q=this._updatedSources[L];q==="reload"?this._reloadSource(L):q==="clear"&&this._clearSource(L)}for(var Se in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Se].updateTransitions(f);this.light.updateTransitions(f),this._resetUpdates()}var Le={};for(var et in this.sourceCaches){var ot=this.sourceCaches[et];Le[et]=ot.used,ot.used=!1}for(var st=0,Rt=this._order;st<Rt.length;st+=1){var Ct=this._layers[Rt[st]];Ct.recalculate(f,this._availableImages),!Ct.isHidden(f.zoom)&&Ct.source&&(this.sourceCaches[Ct.source].used=!0)}for(var Xt in Le){var St=this.sourceCaches[Xt];Le[Xt]!==St.used&&St.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Xt}))}this.light.recalculate(f),this.z=f.zoom,m&&this.fire(new h.Event("data",{dataType:"style"}))}},d.prototype._updateTilesForChangedImages=function(){var f=Object.keys(this._changedImages);if(f.length){for(var m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],f);this._changedImages={}}},d.prototype._updateWorkerLayers=function(f,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(f),removedIds:m})},d.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},d.prototype.setState=function(f){var m=this;if(this._checkLoaded(),ds(this,h.validateStyle(f)))return!1;(f=h.clone$1(f)).layers=hr(f.layers);var S=function(L,q){if(!L)return[{command:Dr.setStyle,args:[q]}];var Se=[];try{if(!h.deepEqual(L.version,q.version))return[{command:Dr.setStyle,args:[q]}];h.deepEqual(L.center,q.center)||Se.push({command:Dr.setCenter,args:[q.center]}),h.deepEqual(L.zoom,q.zoom)||Se.push({command:Dr.setZoom,args:[q.zoom]}),h.deepEqual(L.bearing,q.bearing)||Se.push({command:Dr.setBearing,args:[q.bearing]}),h.deepEqual(L.pitch,q.pitch)||Se.push({command:Dr.setPitch,args:[q.pitch]}),h.deepEqual(L.sprite,q.sprite)||Se.push({command:Dr.setSprite,args:[q.sprite]}),h.deepEqual(L.glyphs,q.glyphs)||Se.push({command:Dr.setGlyphs,args:[q.glyphs]}),h.deepEqual(L.transition,q.transition)||Se.push({command:Dr.setTransition,args:[q.transition]}),h.deepEqual(L.light,q.light)||Se.push({command:Dr.setLight,args:[q.light]});var Le={},et=[];(function(st,Rt,Ct,Xt){var St;for(St in Rt=Rt||{},st=st||{})st.hasOwnProperty(St)&&(Rt.hasOwnProperty(St)||on(St,Ct,Xt));for(St in Rt)Rt.hasOwnProperty(St)&&(st.hasOwnProperty(St)?h.deepEqual(st[St],Rt[St])||(st[St].type==="geojson"&&Rt[St].type==="geojson"&&Mi(st,Rt,St)?Ct.push({command:Dr.setGeoJSONSourceData,args:[St,Rt[St].data]}):fi(St,Rt,Ct,Xt)):Rn(St,Rt,Ct))})(L.sources,q.sources,et,Le);var ot=[];L.layers&&L.layers.forEach(function(st){Le[st.source]?Se.push({command:Dr.removeLayer,args:[st.id]}):ot.push(st)}),Se=Se.concat(et),function(st,Rt,Ct){Rt=Rt||[];var Xt,St,$t,tr,br,kr,Or,Hr=(st=st||[]).map(mn),nn=Rt.map(mn),M=st.reduce(Zn,{}),z=Rt.reduce(Zn,{}),j=Hr.slice(),ne=Object.create(null);for(Xt=0,St=0;Xt<Hr.length;Xt++)z.hasOwnProperty($t=Hr[Xt])?St++:(Ct.push({command:Dr.removeLayer,args:[$t]}),j.splice(j.indexOf($t,St),1));for(Xt=0,St=0;Xt<nn.length;Xt++)j[j.length-1-Xt]!==($t=nn[nn.length-1-Xt])&&(M.hasOwnProperty($t)?(Ct.push({command:Dr.removeLayer,args:[$t]}),j.splice(j.lastIndexOf($t,j.length-St),1)):St++,Ct.push({command:Dr.addLayer,args:[z[$t],kr=j[j.length-Xt]]}),j.splice(j.length-Xt,0,$t),ne[$t]=!0);for(Xt=0;Xt<nn.length;Xt++)if(tr=M[$t=nn[Xt]],br=z[$t],!ne[$t]&&!h.deepEqual(tr,br))if(h.deepEqual(tr.source,br.source)&&h.deepEqual(tr["source-layer"],br["source-layer"])&&h.deepEqual(tr.type,br.type)){for(Or in di(tr.layout,br.layout,Ct,$t,null,Dr.setLayoutProperty),di(tr.paint,br.paint,Ct,$t,null,Dr.setPaintProperty),h.deepEqual(tr.filter,br.filter)||Ct.push({command:Dr.setFilter,args:[$t,br.filter]}),h.deepEqual(tr.minzoom,br.minzoom)&&h.deepEqual(tr.maxzoom,br.maxzoom)||Ct.push({command:Dr.setLayerZoomRange,args:[$t,br.minzoom,br.maxzoom]}),tr)tr.hasOwnProperty(Or)&&Or!=="layout"&&Or!=="paint"&&Or!=="filter"&&Or!=="metadata"&&Or!=="minzoom"&&Or!=="maxzoom"&&(Or.indexOf("paint.")===0?di(tr[Or],br[Or],Ct,$t,Or.slice(6),Dr.setPaintProperty):h.deepEqual(tr[Or],br[Or])||Ct.push({command:Dr.setLayerProperty,args:[$t,Or,br[Or]]}));for(Or in br)br.hasOwnProperty(Or)&&!tr.hasOwnProperty(Or)&&Or!=="layout"&&Or!=="paint"&&Or!=="filter"&&Or!=="metadata"&&Or!=="minzoom"&&Or!=="maxzoom"&&(Or.indexOf("paint.")===0?di(tr[Or],br[Or],Ct,$t,Or.slice(6),Dr.setPaintProperty):h.deepEqual(tr[Or],br[Or])||Ct.push({command:Dr.setLayerProperty,args:[$t,Or,br[Or]]}))}else Ct.push({command:Dr.removeLayer,args:[$t]}),kr=j[j.lastIndexOf($t)+1],Ct.push({command:Dr.addLayer,args:[br,kr]})}(ot,q.layers,Se)}catch(st){console.warn("Unable to compute style diff:",st),Se=[{command:Dr.setStyle,args:[q]}]}return Se}(this.serialize(),f).filter(function(L){return!(L.command in El)});if(S.length===0)return!1;var R=S.filter(function(L){return!(L.command in Qu)});if(R.length>0)throw new Error("Unimplemented: "+R.map(function(L){return L.command}).join(", ")+".");return S.forEach(function(L){L.command!=="setTransition"&&m[L.command].apply(m,L.args)}),this.stylesheet=f,!0},d.prototype.addImage=function(f,m){if(this.getImage(f))return this.fire(new h.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(f,m),this._afterImageUpdated(f)},d.prototype.updateImage=function(f,m){this.imageManager.updateImage(f,m)},d.prototype.getImage=function(f){return this.imageManager.getImage(f)},d.prototype.removeImage=function(f){if(!this.getImage(f))return this.fire(new h.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(f),this._afterImageUpdated(f)},d.prototype._afterImageUpdated=function(f){this._availableImages=this.imageManager.listImages(),this._changedImages[f]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))},d.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},d.prototype.addSource=function(f,m,S){var R=this;if(S===void 0&&(S={}),this._checkLoaded(),this.sourceCaches[f]!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(m).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(h.validateStyle.source,"sources."+f,m,null,S))){this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);var L=this.sourceCaches[f]=new Ge(f,m,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:R.loaded(),source:L.serialize(),sourceId:f}}),L.onAdd(this.map),this._changed=!0}},d.prototype.removeSource=function(f){if(this._checkLoaded(),this.sourceCaches[f]===void 0)throw new Error("There is no source with this ID");for(var m in this._layers)if(this._layers[m].source===f)return this.fire(new h.ErrorEvent(new Error('Source "'+f+'" cannot be removed while layer "'+m+'" is using it.')));var S=this.sourceCaches[f];delete this.sourceCaches[f],delete this._updatedSources[f],S.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:f})),S.setEventedParent(null),S.clearTiles(),S.onRemove&&S.onRemove(this.map),this._changed=!0},d.prototype.setGeoJSONSourceData=function(f,m){this._checkLoaded(),this.sourceCaches[f].getSource().setData(m),this._changed=!0},d.prototype.getSource=function(f){return this.sourceCaches[f]&&this.sourceCaches[f].getSource()},d.prototype.addLayer=function(f,m,S){S===void 0&&(S={}),this._checkLoaded();var R=f.id;if(this.getLayer(R))this.fire(new h.ErrorEvent(new Error('Layer with id "'+R+'" already exists on this map')));else{var L;if(f.type==="custom"){if(ds(this,h.validateCustomStyleLayer(f)))return;L=h.createStyleLayer(f)}else{if(typeof f.source=="object"&&(this.addSource(R,f.source),f=h.clone$1(f),f=h.extend(f,{source:R})),this._validate(h.validateStyle.layer,"layers."+R,f,{arrayIndex:-1},S))return;L=h.createStyleLayer(f),this._validateLayer(L),L.setEventedParent(this,{layer:{id:R}}),this._serializedLayers[L.id]=L.serialize()}var q=m?this._order.indexOf(m):this._order.length;if(m&&q===-1)this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.')));else{if(this._order.splice(q,0,R),this._layerOrderChanged=!0,this._layers[R]=L,this._removedLayers[R]&&L.source&&L.type!=="custom"){var Se=this._removedLayers[R];delete this._removedLayers[R],Se.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},d.prototype.moveLayer=function(f,m){if(this._checkLoaded(),this._changed=!0,this._layers[f]){if(f!==m){var S=this._order.indexOf(f);this._order.splice(S,1);var R=m?this._order.indexOf(m):this._order.length;m&&R===-1?this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.'))):(this._order.splice(R,0,f),this._layerOrderChanged=!0)}}else this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be moved.")))},d.prototype.removeLayer=function(f){this._checkLoaded();var m=this._layers[f];if(m){m.setEventedParent(null);var S=this._order.indexOf(f);this._order.splice(S,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[f]=m,delete this._layers[f],delete this._serializedLayers[f],delete this._updatedLayers[f],delete this._updatedPaintProps[f],m.onRemove&&m.onRemove(this.map)}else this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be removed.")))},d.prototype.getLayer=function(f){return this._layers[f]},d.prototype.hasLayer=function(f){return f in this._layers},d.prototype.setLayerZoomRange=function(f,m,S){this._checkLoaded();var R=this.getLayer(f);R?R.minzoom===m&&R.maxzoom===S||(m!=null&&(R.minzoom=m),S!=null&&(R.maxzoom=S),this._updateLayer(R)):this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot have zoom extent.")))},d.prototype.setFilter=function(f,m,S){S===void 0&&(S={}),this._checkLoaded();var R=this.getLayer(f);if(R){if(!h.deepEqual(R.filter,m))return m==null?(R.filter=void 0,void this._updateLayer(R)):void(this._validate(h.validateStyle.filter,"layers."+R.id+".filter",m,null,S)||(R.filter=h.clone$1(m),this._updateLayer(R)))}else this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be filtered.")))},d.prototype.getFilter=function(f){return h.clone$1(this.getLayer(f).filter)},d.prototype.setLayoutProperty=function(f,m,S,R){R===void 0&&(R={}),this._checkLoaded();var L=this.getLayer(f);L?h.deepEqual(L.getLayoutProperty(m),S)||(L.setLayoutProperty(m,S,R),this._updateLayer(L)):this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be styled.")))},d.prototype.getLayoutProperty=function(f,m){var S=this.getLayer(f);if(S)return S.getLayoutProperty(m);this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style.")))},d.prototype.setPaintProperty=function(f,m,S,R){R===void 0&&(R={}),this._checkLoaded();var L=this.getLayer(f);L?h.deepEqual(L.getPaintProperty(m),S)||(L.setPaintProperty(m,S,R)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[f]=!0):this.fire(new h.ErrorEvent(new Error("The layer '"+f+"' does not exist in the map's style and cannot be styled.")))},d.prototype.getPaintProperty=function(f,m){return this.getLayer(f).getPaintProperty(m)},d.prototype.setFeatureState=function(f,m){this._checkLoaded();var S=f.source,R=f.sourceLayer,L=this.sourceCaches[S];if(L!==void 0){var q=L.getSource().type;q==="geojson"&&R?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):q!=="vector"||R?(f.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(R,f.id,m)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+S+"' does not exist in the map's style.")))},d.prototype.removeFeatureState=function(f,m){this._checkLoaded();var S=f.source,R=this.sourceCaches[S];if(R!==void 0){var L=R.getSource().type,q=L==="vector"?f.sourceLayer:void 0;L!=="vector"||q?m&&typeof f.id!="string"&&typeof f.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):R.removeFeatureState(q,f.id,m):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+S+"' does not exist in the map's style.")))},d.prototype.getFeatureState=function(f){this._checkLoaded();var m=f.source,S=f.sourceLayer,R=this.sourceCaches[m];if(R!==void 0){if(R.getSource().type!=="vector"||S)return f.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),R.getFeatureState(S,f.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},d.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},d.prototype.serialize=function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(f){return f.serialize()}),layers:this._serializeLayers(this._order)},function(f){return f!==void 0})},d.prototype._updateLayer=function(f){this._updatedLayers[f.id]=!0,f.source&&!this._updatedSources[f.source]&&this.sourceCaches[f.source].getSource().type!=="raster"&&(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause()),this._changed=!0},d.prototype._flattenAndSortRenderedFeatures=function(f){for(var m=this,S=function(M){return m._layers[M].type==="fill-extrusion"},R={},L=[],q=this._order.length-1;q>=0;q--){var Se=this._order[q];if(S(Se)){R[Se]=q;for(var Le=0,et=f;Le<et.length;Le+=1){var ot=et[Le][Se];if(ot)for(var st=0,Rt=ot;st<Rt.length;st+=1)L.push(Rt[st])}}}L.sort(function(M,z){return z.intersectionZ-M.intersectionZ});for(var Ct=[],Xt=this._order.length-1;Xt>=0;Xt--){var St=this._order[Xt];if(S(St))for(var $t=L.length-1;$t>=0;$t--){var tr=L[$t].feature;if(R[tr.layer.id]<Xt)break;Ct.push(tr),L.pop()}else for(var br=0,kr=f;br<kr.length;br+=1){var Or=kr[br][St];if(Or)for(var Hr=0,nn=Or;Hr<nn.length;Hr+=1)Ct.push(nn[Hr].feature)}}return Ct},d.prototype.queryRenderedFeatures=function(f,m,S){m&&m.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);var R={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,q=m.layers;L<q.length;L+=1){var Se=q[L],Le=this._layers[Se];if(!Le)return this.fire(new h.ErrorEvent(new Error("The layer '"+Se+"' does not exist in the map's style and cannot be queried for features."))),[];R[Le.source]=!0}}var et=[];for(var ot in m.availableImages=this._availableImages,this.sourceCaches)m.layers&&!R[ot]||et.push(At(this.sourceCaches[ot],this._layers,this._serializedLayers,f,m,S));return this.placement&&et.push(function(st,Rt,Ct,Xt,St,$t,tr){for(var br={},kr=$t.queryRenderedSymbols(Xt),Or=[],Hr=0,nn=Object.keys(kr).map(Number);Hr<nn.length;Hr+=1)Or.push(tr[nn[Hr]]);Or.sort(hn);for(var M=function(){var le=j[z],lt=le.featureIndex.lookupSymbolFeatures(kr[le.bucketInstanceId],Rt,le.bucketIndex,le.sourceLayerIndex,St.filter,St.layers,St.availableImages,st);for(var it in lt){var Yt=br[it]=br[it]||[],ht=lt[it];ht.sort(function(_n,vn){var Jr=le.featureSortOrder;if(Jr){var Gn=Jr.indexOf(_n.featureIndex);return Jr.indexOf(vn.featureIndex)-Gn}return vn.featureIndex-_n.featureIndex});for(var er=0,yr=ht;er<yr.length;er+=1)Yt.push(yr[er])}},z=0,j=Or;z<j.length;z+=1)M();var ne=function(le){br[le].forEach(function(lt){var it=lt.feature,Yt=Ct[st[le].source].getFeatureState(it.layer["source-layer"],it.id);it.source=it.layer.source,it.layer["source-layer"]&&(it.sourceLayer=it.layer["source-layer"]),it.state=Yt})};for(var ce in br)ne(ce);return br}(this._layers,this._serializedLayers,this.sourceCaches,f,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(et)},d.prototype.querySourceFeatures=function(f,m){m&&m.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);var S=this.sourceCaches[f];return S?function(R,L){for(var q=R.getRenderableIds().map(function(Rt){return R.getTileByID(Rt)}),Se=[],Le={},et=0;et<q.length;et++){var ot=q[et],st=ot.tileID.canonical.key;Le[st]||(Le[st]=!0,ot.querySourceFeatures(Se,L))}return Se}(S,m):[]},d.prototype.addSourceType=function(f,m,S){return d.getSourceType(f)?S(new Error('A source type called "'+f+'" already exists.')):(d.setSourceType(f,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:f,url:m.workerSourceURL},S):S(null,null))},d.prototype.getLight=function(){return this.light.getLight()},d.prototype.setLight=function(f,m){m===void 0&&(m={}),this._checkLoaded();var S=this.light.getLight(),R=!1;for(var L in f)if(!h.deepEqual(f[L],S[L])){R=!0;break}if(R){var q={now:h.browser.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(f,m),this.light.updateTransitions(q)}},d.prototype._validate=function(f,m,S,R,L){return L===void 0&&(L={}),(!L||L.validate!==!1)&&ds(this,f.call(h.validateStyle,h.extend({key:m,style:this.serialize(),value:S,styleSpec:h.styleSpec},R)))},d.prototype._remove=function(){for(var f in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[f].setEventedParent(null);for(var m in this.sourceCaches)this.sourceCaches[m].clearTiles(),this.sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},d.prototype._clearSource=function(f){this.sourceCaches[f].clearTiles()},d.prototype._reloadSource=function(f){this.sourceCaches[f].resume(),this.sourceCaches[f].reload()},d.prototype._updateSources=function(f){for(var m in this.sourceCaches)this.sourceCaches[m].update(f)},d.prototype._generateCollisionBoxes=function(){for(var f in this.sourceCaches)this._reloadSource(f)},d.prototype._updatePlacement=function(f,m,S,R,L){L===void 0&&(L=!1);for(var q=!1,Se=!1,Le={},et=0,ot=this._order;et<ot.length;et+=1){var st=this._layers[ot[et]];if(st.type==="symbol"){if(!Le[st.source]){var Rt=this.sourceCaches[st.source];Le[st.source]=Rt.getRenderableIds(!0).map(function(tr){return Rt.getTileByID(tr)}).sort(function(tr,br){return br.tileID.overscaledZ-tr.tileID.overscaledZ||(tr.tileID.isLessThan(br.tileID)?-1:1)})}var Ct=this.crossTileSymbolIndex.addLayer(st,Le[st.source],f.center.lng);q=q||Ct}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||S===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.browser.now(),f.zoom))&&(this.pauseablePlacement=new Ws(f,this._order,L,m,S,R,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Le),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.browser.now()),Se=!0),q&&this.pauseablePlacement.placement.setStale()),Se||q)for(var Xt=0,St=this._order;Xt<St.length;Xt+=1){var $t=this._layers[St[Xt]];$t.type==="symbol"&&this.placement.updateLayerOpacities($t,Le[$t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.browser.now())},d.prototype._releaseSymbolFadeTiles=function(){for(var f in this.sourceCaches)this.sourceCaches[f].releaseSymbolFadeTiles()},d.prototype.getImages=function(f,m,S){this.imageManager.getImages(m.icons,S),this._updateTilesForChangedImages();var R=this.sourceCaches[m.source];R&&R.setDependencies(m.tileID.key,m.type,m.icons)},d.prototype.getGlyphs=function(f,m,S){this.glyphManager.getGlyphs(m.stacks,S)},d.prototype.getResource=function(f,m,S){return h.makeRequest(m,S)},d}(h.Evented);gn.getSourceType=function(l){return ze[l]},gn.setSourceType=function(l,d){ze[l]=d},gn.registerForPluginStateChange=h.registerForPluginStateChange;var Ai=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),Hi=Va(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),kn=Va(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),us=Va(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Sl=Va(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ic=Va("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),hf=Va(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Oc=Va(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),df=Va("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),pf=Va("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),po=Va("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Pf=Va(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),vc=Va(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ju=Va(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),eh=Va(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Qo=Va(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Nl=Va(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ul=Va(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),iu=Va(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),yu=Va(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_u=Va(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),el=Va(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),au=Va(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),zl=Va(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Tl=Va(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),vf=Va(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Vc=Va(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Va(l,d){var f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=d.match(/attribute ([\w]+) ([\w]+)/g),S=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=R?R.concat(S):S,q={};return{fragmentSource:l=l.replace(f,function(Se,Le,et,ot,st){return q[st]=!0,Le==="define"?`
#ifndef HAS_UNIFORM_u_`+st+`
varying `+et+" "+ot+" "+st+`;
#else
uniform `+et+" "+ot+" u_"+st+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+st+`
    `+et+" "+ot+" "+st+" = u_"+st+`;
#endif
`}),vertexSource:d=d.replace(f,function(Se,Le,et,ot,st){var Rt=ot==="float"?"vec2":"vec4",Ct=st.match(/color/)?"color":Rt;return q[st]?Le==="define"?`
#ifndef HAS_UNIFORM_u_`+st+`
uniform lowp float u_`+st+`_t;
attribute `+et+" "+Rt+" a_"+st+`;
varying `+et+" "+ot+" "+st+`;
#else
uniform `+et+" "+ot+" u_"+st+`;
#endif
`:Ct==="vec4"?`
#ifndef HAS_UNIFORM_u_`+st+`
    `+st+" = a_"+st+`;
#else
    `+et+" "+ot+" "+st+" = u_"+st+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+st+`
    `+st+" = unpack_mix_"+Ct+"(a_"+st+", u_"+st+`_t);
#else
    `+et+" "+ot+" "+st+" = u_"+st+`;
#endif
`:Le==="define"?`
#ifndef HAS_UNIFORM_u_`+st+`
uniform lowp float u_`+st+`_t;
attribute `+et+" "+Rt+" a_"+st+`;
#else
uniform `+et+" "+ot+" u_"+st+`;
#endif
`:Ct==="vec4"?`
#ifndef HAS_UNIFORM_u_`+st+`
    `+et+" "+ot+" "+st+" = a_"+st+`;
#else
    `+et+" "+ot+" "+st+" = u_"+st+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+st+`
    `+et+" "+ot+" "+st+" = unpack_mix_"+Ct+"(a_"+st+", u_"+st+`_t);
#else
    `+et+" "+ot+" "+st+" = u_"+st+`;
#endif
`}),staticAttributes:m,staticUniforms:L}}var th=Object.freeze({__proto__:null,prelude:Hi,background:kn,backgroundPattern:us,circle:Sl,clippingMask:Ic,heatmap:hf,heatmapTexture:Oc,collisionBox:df,collisionCircle:pf,debug:po,fill:Pf,fillOutline:vc,fillOutlinePattern:Ju,fillPattern:eh,fillExtrusion:Qo,fillExtrusionPattern:Nl,hillshadePrepare:Ul,hillshade:iu,line:yu,lineGradient:_u,linePattern:el,lineSDF:au,raster:zl,symbolIcon:Tl,symbolSDF:vf,symbolTextAndIcon:Vc}),Pc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Hc(l){for(var d=[],f=0;f<l.length;f++)if(l[f]!==null){var m=l[f].split(" ");d.push(m.pop())}return d}Pc.prototype.bind=function(l,d,f,m,S,R,L,q){this.context=l;for(var Se=this.boundPaintVertexBuffers.length!==m.length,Le=0;!Se&&Le<m.length;Le++)this.boundPaintVertexBuffers[Le]!==m[Le]&&(Se=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===d&&this.boundLayoutVertexBuffer===f&&!Se&&this.boundIndexBuffer===S&&this.boundVertexOffset===R&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===q?(l.bindVertexArrayOES.set(this.vao),L&&L.bind(),S&&S.dynamicDraw&&S.bind(),q&&q.bind()):this.freshBind(d,f,m,S,R,L,q)},Pc.prototype.freshBind=function(l,d,f,m,S,R,L){var q,Se=l.numAttributes,Le=this.context,et=Le.gl;if(Le.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Le.extVertexArrayObject.createVertexArrayOES(),Le.bindVertexArrayOES.set(this.vao),q=0,this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=m,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=L;else{q=Le.currentNumAttributes||0;for(var ot=Se;ot<q;ot++)et.disableVertexAttribArray(ot)}d.enableAttributes(et,l);for(var st=0,Rt=f;st<Rt.length;st+=1)Rt[st].enableAttributes(et,l);R&&R.enableAttributes(et,l),L&&L.enableAttributes(et,l),d.bind(),d.setVertexAttribPointers(et,l,S);for(var Ct=0,Xt=f;Ct<Xt.length;Ct+=1){var St=Xt[Ct];St.bind(),St.setVertexAttribPointers(et,l,S)}R&&(R.bind(),R.setVertexAttribPointers(et,l,S)),m&&m.bind(),L&&(L.bind(),L.setVertexAttribPointers(et,l,S)),Le.currentNumAttributes=Se},Pc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var bo=function(l,d,f,m,S,R){var L=l.gl;this.program=L.createProgram();for(var q=Hc(f.staticAttributes),Se=m?m.getBinderAttributes():[],Le=q.concat(Se),et=f.staticUniforms?Hc(f.staticUniforms):[],ot=m?m.getBinderUniforms():[],st=[],Rt=0,Ct=et.concat(ot);Rt<Ct.length;Rt+=1){var Xt=Ct[Rt];st.indexOf(Xt)<0&&st.push(Xt)}var St=m?m.defines():[];R&&St.push("#define OVERDRAW_INSPECTOR;");var $t=St.concat(Hi.fragmentSource,f.fragmentSource).join(`
`),tr=St.concat(Hi.vertexSource,f.vertexSource).join(`
`),br=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(br,$t),L.compileShader(br),L.attachShader(this.program,br);var kr=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(kr,tr),L.compileShader(kr),L.attachShader(this.program,kr),this.attributes={};var Or={};this.numAttributes=Le.length;for(var Hr=0;Hr<this.numAttributes;Hr++)Le[Hr]&&(L.bindAttribLocation(this.program,Hr,Le[Hr]),this.attributes[Le[Hr]]=Hr);L.linkProgram(this.program),L.deleteShader(kr),L.deleteShader(br);for(var nn=0;nn<st.length;nn++){var M=st[nn];if(M&&!Or[M]){var z=L.getUniformLocation(this.program,M);z&&(Or[M]=z)}}this.fixedUniforms=S(l,Or),this.binderUniforms=m?m.getUniforms(l,Or):[]}}};function mf(l,d,f){var m=1/Za(f,1,d.transform.tileZoom),S=Math.pow(2,f.tileID.overscaledZ),R=f.tileSize*Math.pow(2,d.transform.tileZoom)/S,L=R*(f.tileID.canonical.x+f.tileID.wrap*S),q=R*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[m,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[L>>16,q>>16],u_pixel_coord_lower:[65535&L,65535&q]}}bo.prototype.draw=function(l,d,f,m,S,R,L,q,Se,Le,et,ot,st,Rt,Ct,Xt){var St,$t=l.gl;if(!this.failedToCreate){for(var tr in l.program.set(this.program),l.setDepthMode(f),l.setStencilMode(m),l.setColorMode(S),l.setCullFace(R),this.fixedUniforms)this.fixedUniforms[tr].set(L[tr]);Rt&&Rt.setUniforms(l,this.binderUniforms,ot,{zoom:st});for(var br=(St={},St[$t.LINES]=2,St[$t.TRIANGLES]=3,St[$t.LINE_STRIP]=1,St)[d],kr=0,Or=et.get();kr<Or.length;kr+=1){var Hr=Or[kr],nn=Hr.vaos||(Hr.vaos={});(nn[q]||(nn[q]=new Pc)).bind(l,this,Se,Rt?Rt.getPaintVertexBuffers():[],Le,Hr.vertexOffset,Ct,Xt),$t.drawElements(d,Hr.primitiveLength*br,$t.UNSIGNED_SHORT,Hr.primitiveOffset*br*2)}}};var gf=function(l,d,f,m){var S=d.style.light,R=S.properties.get("position"),L=[R.x,R.y,R.z],q=h.create$1();S.properties.get("anchor")==="viewport"&&h.fromRotation(q,-d.transform.angle),h.transformMat3(L,L,q);var Se=S.properties.get("color");return{u_matrix:l,u_lightpos:L,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[Se.r,Se.g,Se.b],u_vertical_gradient:+f,u_opacity:m}},Jo=function(l,d,f,m,S,R,L){return h.extend(gf(l,d,f,m),mf(R,d,L),{u_height_factor:-Math.pow(2,S.overscaledZ)/L.tileSize/8})},Zu=function(l){return{u_matrix:l}},Mu=function(l,d,f,m){return h.extend(Zu(l),mf(f,d,m))},ju=function(l,d){return{u_matrix:l,u_world:d}},mc=function(l,d,f,m,S){return h.extend(Mu(l,d,f,m),{u_world:S})},Zl=function(l,d,f,m){var S,R,L=l.transform;if(m.paint.get("circle-pitch-alignment")==="map"){var q=Za(f,1,L.zoom);S=!0,R=[q,q]}else S=!1,R=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:l.translatePosMatrix(d.posMatrix,f,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+S,u_device_pixel_ratio:h.browser.devicePixelRatio,u_extrude_scale:R}},bu=function(l,d,f){var m=Za(f,1,d.zoom),S=Math.pow(2,d.zoom-f.tileID.overscaledZ),R=f.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:d.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[d.pixelsToGLUnits[0]/(m*S),d.pixelsToGLUnits[1]/(m*S)],u_overscale_factor:R}},gc=function(l,d,f){return{u_matrix:l,u_inv_matrix:d,u_camera_to_center_distance:f.cameraToCenterDistance,u_viewport_size:[f.width,f.height]}},Al=function(l,d,f){return f===void 0&&(f=1),{u_matrix:l,u_color:d,u_overlay:0,u_overlay_scale:f}},ou=function(l){return{u_matrix:l}},La=function(l,d,f,m){return{u_matrix:l,u_extrude_scale:Za(d,1,f),u_intensity:m}},qa=function(l,d,f){var m=l.transform;return{u_matrix:Dc(l,d,f),u_ratio:1/Za(d,1,m.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},so=function(l,d,f,m){return h.extend(qa(l,d,f),{u_image:0,u_image_height:m})},Vu=function(l,d,f,m){var S=l.transform,R=Cl(d,S);return{u_matrix:Dc(l,d,f),u_texsize:d.imageAtlasTexture.size,u_ratio:1/Za(d,1,S.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_image:0,u_scale:[R,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Df=function(l,d,f,m,S){var R=l.lineAtlas,L=Cl(d,l.transform),q=f.layout.get("line-cap")==="round",Se=R.getDash(m.from,q),Le=R.getDash(m.to,q),et=Se.width*S.fromScale,ot=Le.width*S.toScale;return h.extend(qa(l,d,f),{u_patternscale_a:[L/et,-Se.height/2],u_patternscale_b:[L/ot,-Le.height/2],u_sdfgamma:R.width/(256*Math.min(et,ot)*h.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Se.y,u_tex_y_b:Le.y,u_mix:S.t})};function Cl(l,d){return 1/Za(l,1,d.tileZoom)}function Dc(l,d,f){return l.translatePosMatrix(d.tileID.posMatrix,d,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}var yc=function(l,d,f,m,S){return{u_matrix:l,u_tl_parent:d,u_scale_parent:f,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(L=S.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(R=S.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:Gs(S.paint.get("raster-hue-rotate"))};var R,L};function Gs(l){l*=Math.PI/180;var d=Math.sin(l),f=Math.cos(l);return[(2*f+1)/3,(-Math.sqrt(3)*d-f+1)/3,(Math.sqrt(3)*d-f+1)/3]}var Hu,Iu=function(l,d,f,m,S,R,L,q,Se,Le){var et=S.transform;return{u_is_size_zoom_constant:+(l==="constant"||l==="source"),u_is_size_feature_constant:+(l==="constant"||l==="camera"),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:et.cameraToCenterDistance,u_pitch:et.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:et.width/et.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:R,u_label_plane_matrix:L,u_coord_matrix:q,u_is_text:+Se,u_pitch_with_map:+m,u_texsize:Le,u_texture:0}},tl=function(l,d,f,m,S,R,L,q,Se,Le,et){var ot=S.transform;return h.extend(Iu(l,d,f,m,S,R,L,q,Se,Le),{u_gamma_scale:m?Math.cos(ot._pitch)*ot.cameraToCenterDistance:1,u_device_pixel_ratio:h.browser.devicePixelRatio,u_is_halo:+et})},Ql=function(l,d,f,m,S,R,L,q,Se,Le){return h.extend(tl(l,d,f,m,S,R,L,q,!0,Se,!0),{u_texsize_icon:Le,u_texture_icon:1})},Jl=function(l,d,f){return{u_matrix:l,u_opacity:d,u_color:f}},jl=function(l,d,f,m,S,R){return h.extend(function(L,q,Se,Le){var et=Se.imageManager.getPattern(L.from.toString()),ot=Se.imageManager.getPattern(L.to.toString()),st=Se.imageManager.getPixelSize(),Rt=st.width,Ct=st.height,Xt=Math.pow(2,Le.tileID.overscaledZ),St=Le.tileSize*Math.pow(2,Se.transform.tileZoom)/Xt,$t=St*(Le.tileID.canonical.x+Le.tileID.wrap*Xt),tr=St*Le.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:et.tl,u_pattern_br_a:et.br,u_pattern_tl_b:ot.tl,u_pattern_br_b:ot.br,u_texsize:[Rt,Ct],u_mix:q.t,u_pattern_size_a:et.displaySize,u_pattern_size_b:ot.displaySize,u_scale_a:q.fromScale,u_scale_b:q.toScale,u_tile_units_to_pixels:1/Za(Le,1,Se.transform.tileZoom),u_pixel_coord_upper:[$t>>16,tr>>16],u_pixel_coord_lower:[65535&$t,65535&tr]}}(m,R,f,S),{u_matrix:l,u_opacity:d})},kc={fillExtrusion:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_lightpos:new h.Uniform3f(l,d.u_lightpos),u_lightintensity:new h.Uniform1f(l,d.u_lightintensity),u_lightcolor:new h.Uniform3f(l,d.u_lightcolor),u_vertical_gradient:new h.Uniform1f(l,d.u_vertical_gradient),u_opacity:new h.Uniform1f(l,d.u_opacity)}},fillExtrusionPattern:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_lightpos:new h.Uniform3f(l,d.u_lightpos),u_lightintensity:new h.Uniform1f(l,d.u_lightintensity),u_lightcolor:new h.Uniform3f(l,d.u_lightcolor),u_vertical_gradient:new h.Uniform1f(l,d.u_vertical_gradient),u_height_factor:new h.Uniform1f(l,d.u_height_factor),u_image:new h.Uniform1i(l,d.u_image),u_texsize:new h.Uniform2f(l,d.u_texsize),u_pixel_coord_upper:new h.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,d.u_pixel_coord_lower),u_scale:new h.Uniform3f(l,d.u_scale),u_fade:new h.Uniform1f(l,d.u_fade),u_opacity:new h.Uniform1f(l,d.u_opacity)}},fill:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix)}},fillPattern:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_image:new h.Uniform1i(l,d.u_image),u_texsize:new h.Uniform2f(l,d.u_texsize),u_pixel_coord_upper:new h.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,d.u_pixel_coord_lower),u_scale:new h.Uniform3f(l,d.u_scale),u_fade:new h.Uniform1f(l,d.u_fade)}},fillOutline:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_world:new h.Uniform2f(l,d.u_world)}},fillOutlinePattern:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_world:new h.Uniform2f(l,d.u_world),u_image:new h.Uniform1i(l,d.u_image),u_texsize:new h.Uniform2f(l,d.u_texsize),u_pixel_coord_upper:new h.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,d.u_pixel_coord_lower),u_scale:new h.Uniform3f(l,d.u_scale),u_fade:new h.Uniform1f(l,d.u_fade)}},circle:function(l,d){return{u_camera_to_center_distance:new h.Uniform1f(l,d.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(l,d.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(l,d.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(l,d.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(l,d.u_matrix)}},collisionBox:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_camera_to_center_distance:new h.Uniform1f(l,d.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(l,d.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(l,d.u_extrude_scale),u_overscale_factor:new h.Uniform1f(l,d.u_overscale_factor)}},collisionCircle:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_inv_matrix:new h.UniformMatrix4f(l,d.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(l,d.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(l,d.u_viewport_size)}},debug:function(l,d){return{u_color:new h.UniformColor(l,d.u_color),u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_overlay:new h.Uniform1i(l,d.u_overlay),u_overlay_scale:new h.Uniform1f(l,d.u_overlay_scale)}},clippingMask:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix)}},heatmap:function(l,d){return{u_extrude_scale:new h.Uniform1f(l,d.u_extrude_scale),u_intensity:new h.Uniform1f(l,d.u_intensity),u_matrix:new h.UniformMatrix4f(l,d.u_matrix)}},heatmapTexture:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_world:new h.Uniform2f(l,d.u_world),u_image:new h.Uniform1i(l,d.u_image),u_color_ramp:new h.Uniform1i(l,d.u_color_ramp),u_opacity:new h.Uniform1f(l,d.u_opacity)}},hillshade:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_image:new h.Uniform1i(l,d.u_image),u_latrange:new h.Uniform2f(l,d.u_latrange),u_light:new h.Uniform2f(l,d.u_light),u_shadow:new h.UniformColor(l,d.u_shadow),u_highlight:new h.UniformColor(l,d.u_highlight),u_accent:new h.UniformColor(l,d.u_accent)}},hillshadePrepare:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_image:new h.Uniform1i(l,d.u_image),u_dimension:new h.Uniform2f(l,d.u_dimension),u_zoom:new h.Uniform1f(l,d.u_zoom),u_unpack:new h.Uniform4f(l,d.u_unpack)}},line:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_ratio:new h.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(l,d.u_units_to_pixels)}},lineGradient:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_ratio:new h.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(l,d.u_units_to_pixels),u_image:new h.Uniform1i(l,d.u_image),u_image_height:new h.Uniform1f(l,d.u_image_height)}},linePattern:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_texsize:new h.Uniform2f(l,d.u_texsize),u_ratio:new h.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_image:new h.Uniform1i(l,d.u_image),u_units_to_pixels:new h.Uniform2f(l,d.u_units_to_pixels),u_scale:new h.Uniform3f(l,d.u_scale),u_fade:new h.Uniform1f(l,d.u_fade)}},lineSDF:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_ratio:new h.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(l,d.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(l,d.u_patternscale_a),u_patternscale_b:new h.Uniform2f(l,d.u_patternscale_b),u_sdfgamma:new h.Uniform1f(l,d.u_sdfgamma),u_image:new h.Uniform1i(l,d.u_image),u_tex_y_a:new h.Uniform1f(l,d.u_tex_y_a),u_tex_y_b:new h.Uniform1f(l,d.u_tex_y_b),u_mix:new h.Uniform1f(l,d.u_mix)}},raster:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_tl_parent:new h.Uniform2f(l,d.u_tl_parent),u_scale_parent:new h.Uniform1f(l,d.u_scale_parent),u_buffer_scale:new h.Uniform1f(l,d.u_buffer_scale),u_fade_t:new h.Uniform1f(l,d.u_fade_t),u_opacity:new h.Uniform1f(l,d.u_opacity),u_image0:new h.Uniform1i(l,d.u_image0),u_image1:new h.Uniform1i(l,d.u_image1),u_brightness_low:new h.Uniform1f(l,d.u_brightness_low),u_brightness_high:new h.Uniform1f(l,d.u_brightness_high),u_saturation_factor:new h.Uniform1f(l,d.u_saturation_factor),u_contrast_factor:new h.Uniform1f(l,d.u_contrast_factor),u_spin_weights:new h.Uniform3f(l,d.u_spin_weights)}},symbolIcon:function(l,d){return{u_is_size_zoom_constant:new h.Uniform1i(l,d.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(l,d.u_is_size_feature_constant),u_size_t:new h.Uniform1f(l,d.u_size_t),u_size:new h.Uniform1f(l,d.u_size),u_camera_to_center_distance:new h.Uniform1f(l,d.u_camera_to_center_distance),u_pitch:new h.Uniform1f(l,d.u_pitch),u_rotate_symbol:new h.Uniform1i(l,d.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(l,d.u_aspect_ratio),u_fade_change:new h.Uniform1f(l,d.u_fade_change),u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(l,d.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(l,d.u_coord_matrix),u_is_text:new h.Uniform1i(l,d.u_is_text),u_pitch_with_map:new h.Uniform1i(l,d.u_pitch_with_map),u_texsize:new h.Uniform2f(l,d.u_texsize),u_texture:new h.Uniform1i(l,d.u_texture)}},symbolSDF:function(l,d){return{u_is_size_zoom_constant:new h.Uniform1i(l,d.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(l,d.u_is_size_feature_constant),u_size_t:new h.Uniform1f(l,d.u_size_t),u_size:new h.Uniform1f(l,d.u_size),u_camera_to_center_distance:new h.Uniform1f(l,d.u_camera_to_center_distance),u_pitch:new h.Uniform1f(l,d.u_pitch),u_rotate_symbol:new h.Uniform1i(l,d.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(l,d.u_aspect_ratio),u_fade_change:new h.Uniform1f(l,d.u_fade_change),u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(l,d.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(l,d.u_coord_matrix),u_is_text:new h.Uniform1i(l,d.u_is_text),u_pitch_with_map:new h.Uniform1i(l,d.u_pitch_with_map),u_texsize:new h.Uniform2f(l,d.u_texsize),u_texture:new h.Uniform1i(l,d.u_texture),u_gamma_scale:new h.Uniform1f(l,d.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(l,d.u_is_halo)}},symbolTextAndIcon:function(l,d){return{u_is_size_zoom_constant:new h.Uniform1i(l,d.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(l,d.u_is_size_feature_constant),u_size_t:new h.Uniform1f(l,d.u_size_t),u_size:new h.Uniform1f(l,d.u_size),u_camera_to_center_distance:new h.Uniform1f(l,d.u_camera_to_center_distance),u_pitch:new h.Uniform1f(l,d.u_pitch),u_rotate_symbol:new h.Uniform1i(l,d.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(l,d.u_aspect_ratio),u_fade_change:new h.Uniform1f(l,d.u_fade_change),u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(l,d.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(l,d.u_coord_matrix),u_is_text:new h.Uniform1i(l,d.u_is_text),u_pitch_with_map:new h.Uniform1i(l,d.u_pitch_with_map),u_texsize:new h.Uniform2f(l,d.u_texsize),u_texsize_icon:new h.Uniform2f(l,d.u_texsize_icon),u_texture:new h.Uniform1i(l,d.u_texture),u_texture_icon:new h.Uniform1i(l,d.u_texture_icon),u_gamma_scale:new h.Uniform1f(l,d.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(l,d.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(l,d.u_is_halo)}},background:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_opacity:new h.Uniform1f(l,d.u_opacity),u_color:new h.UniformColor(l,d.u_color)}},backgroundPattern:function(l,d){return{u_matrix:new h.UniformMatrix4f(l,d.u_matrix),u_opacity:new h.Uniform1f(l,d.u_opacity),u_image:new h.Uniform1i(l,d.u_image),u_pattern_tl_a:new h.Uniform2f(l,d.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(l,d.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(l,d.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(l,d.u_pattern_br_b),u_texsize:new h.Uniform2f(l,d.u_texsize),u_mix:new h.Uniform1f(l,d.u_mix),u_pattern_size_a:new h.Uniform2f(l,d.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(l,d.u_pattern_size_b),u_scale_a:new h.Uniform1f(l,d.u_scale_a),u_scale_b:new h.Uniform1f(l,d.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(l,d.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(l,d.u_tile_units_to_pixels)}}};function rl(l,d,f,m,S,R,L){for(var q=l.context,Se=q.gl,Le=l.useProgram("collisionBox"),et=[],ot=0,st=0,Rt=0;Rt<m.length;Rt++){var Ct=m[Rt],Xt=d.getTile(Ct),St=Xt.getBucket(f);if(St){var $t=Ct.posMatrix;S[0]===0&&S[1]===0||($t=l.translatePosMatrix(Ct.posMatrix,Xt,S,R));var tr=L?St.textCollisionBox:St.iconCollisionBox,br=St.collisionCircleArray;if(br.length>0){var kr=h.create(),Or=$t;h.mul(kr,St.placementInvProjMatrix,l.transform.glCoordMatrix),h.mul(kr,kr,St.placementViewportMatrix),et.push({circleArray:br,circleOffset:st,transform:Or,invTransform:kr}),st=ot+=br.length/4}tr&&Le.draw(q,Se.LINES,ke.disabled,qe.disabled,l.colorModeForRenderPass(),kt.disabled,bu($t,l.transform,Xt),f.id,tr.layoutVertexBuffer,tr.indexBuffer,tr.segments,null,l.transform.zoom,null,null,tr.collisionVertexBuffer)}}if(L&&et.length){var Hr=l.useProgram("collisionCircle"),nn=new h.StructArrayLayout2f1f2i16;nn.resize(4*ot),nn._trim();for(var M=0,z=0,j=et;z<j.length;z+=1)for(var ne=j[z],ce=0;ce<ne.circleArray.length/4;ce++){var le=4*ce,lt=ne.circleArray[le+0],it=ne.circleArray[le+1],Yt=ne.circleArray[le+2],ht=ne.circleArray[le+3];nn.emplace(M++,lt,it,Yt,ht,0),nn.emplace(M++,lt,it,Yt,ht,1),nn.emplace(M++,lt,it,Yt,ht,2),nn.emplace(M++,lt,it,Yt,ht,3)}(!Hu||Hu.length<2*ot)&&(Hu=function(Xn){var Yn=2*Xn,gi=new h.StructArrayLayout3ui6;gi.resize(Yn),gi._trim();for(var xi=0;xi<Yn;xi++){var Ni=6*xi;gi.uint16[Ni+0]=4*xi+0,gi.uint16[Ni+1]=4*xi+1,gi.uint16[Ni+2]=4*xi+2,gi.uint16[Ni+3]=4*xi+2,gi.uint16[Ni+4]=4*xi+3,gi.uint16[Ni+5]=4*xi+0}return gi}(ot));for(var er=q.createIndexBuffer(Hu,!0),yr=q.createVertexBuffer(nn,h.collisionCircleLayout.members,!0),_n=0,vn=et;_n<vn.length;_n+=1){var Jr=vn[_n],Gn=gc(Jr.transform,Jr.invTransform,l.transform);Hr.draw(q,Se.TRIANGLES,ke.disabled,qe.disabled,l.colorModeForRenderPass(),kt.disabled,Gn,f.id,yr,er,h.SegmentVector.simpleSegment(0,2*Jr.circleOffset,Jr.circleArray.length,Jr.circleArray.length/2),null,l.transform.zoom,null,null,null)}yr.destroy(),er.destroy()}}var Xs=h.identity(new Float32Array(16));function kf(l,d,f,m,S,R){var L=h.getAnchorAlignment(l),q=-(L.horizontalAlign-.5)*d,Se=-(L.verticalAlign-.5)*f,Le=h.evaluateVariableOffset(l,m);return new h.Point((q/S+Le[0])*R,(Se/S+Le[1])*R)}function yf(l,d,f,m,S,R,L,q,Se,Le,et){var ot=l.text.placedSymbolArray,st=l.text.dynamicLayoutVertexArray,Rt=l.icon.dynamicLayoutVertexArray,Ct={};st.clear();for(var Xt=0;Xt<ot.length;Xt++){var St=ot.get(Xt),$t=St.hidden||!St.crossTileID||l.allowVerticalPlacement&&!St.placedOrientation?null:m[St.crossTileID];if($t){var tr=new h.Point(St.anchorX,St.anchorY),br=Oi(tr,f?q:L),kr=jr(R.cameraToCenterDistance,br.signedDistanceFromCamera),Or=S.evaluateSizeForFeature(l.textSizeData,Le,St)*kr/h.ONE_EM;f&&(Or*=l.tilePixelRatio/Se);for(var Hr=kf($t.anchor,$t.width,$t.height,$t.textOffset,$t.textBoxScale,Or),nn=f?Oi(tr.add(Hr),L).point:br.point.add(d?Hr.rotate(-R.angle):Hr),M=l.allowVerticalPlacement&&St.placedOrientation===h.WritingMode.vertical?Math.PI/2:0,z=0;z<St.numGlyphs;z++)h.addDynamicAttributes(st,nn,M);et&&St.associatedIconIndex>=0&&(Ct[St.associatedIconIndex]={shiftedAnchor:nn,angle:M})}else za(St.numGlyphs,st)}if(et){Rt.clear();for(var j=l.icon.placedSymbolArray,ne=0;ne<j.length;ne++){var ce=j.get(ne);if(ce.hidden)za(ce.numGlyphs,Rt);else{var le=Ct[ne];if(le)for(var lt=0;lt<ce.numGlyphs;lt++)h.addDynamicAttributes(Rt,le.shiftedAnchor,le.angle);else za(ce.numGlyphs,Rt)}}l.icon.dynamicLayoutVertexBuffer.updateData(Rt)}l.text.dynamicLayoutVertexBuffer.updateData(st)}function Lf(l,d,f){return f.iconsInText&&d?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function Vl(l,d,f,m,S,R,L,q,Se,Le,et,ot){for(var st=l.context,Rt=st.gl,Ct=l.transform,Xt=q==="map",St=Se==="map",$t=Xt&&f.layout.get("symbol-placement")!=="point",tr=Xt&&!St&&!$t,br=f.layout.get("symbol-sort-key").constantOr(1)!==void 0,kr=!1,Or=l.depthModeForSublayer(0,ke.ReadOnly),Hr=f.layout.get("text-variable-anchor"),nn=[],M=0,z=m;M<z.length;M+=1){var j=z[M],ne=d.getTile(j),ce=ne.getBucket(f);if(ce){var le=S?ce.text:ce.icon;if(le&&le.segments.get().length){var lt=le.programConfigurations.get(f.id),it=S||ce.sdfIcons,Yt=S?ce.textSizeData:ce.iconSizeData,ht=St||Ct.pitch!==0,er=l.useProgram(Lf(it,S,ce),lt),yr=h.evaluateSizeForZoom(Yt,Ct.zoom),_n=void 0,vn=[0,0],Jr=void 0,Gn=void 0,Xn=null,Yn=void 0;if(S)Jr=ne.glyphAtlasTexture,Gn=Rt.LINEAR,_n=ne.glyphAtlasTexture.size,ce.iconsInText&&(vn=ne.imageAtlasTexture.size,Xn=ne.imageAtlasTexture,Yn=ht||l.options.rotating||l.options.zooming||Yt.kind==="composite"||Yt.kind==="camera"?Rt.LINEAR:Rt.NEAREST);else{var gi=f.layout.get("icon-size").constantOr(0)!==1||ce.iconsNeedLinear;Jr=ne.imageAtlasTexture,Gn=it||l.options.rotating||l.options.zooming||gi||ht?Rt.LINEAR:Rt.NEAREST,_n=ne.imageAtlasTexture.size}var xi=Za(ne,1,l.transform.zoom),Ni=Sa(j.posMatrix,St,Xt,l.transform,xi),Pa=Zi(j.posMatrix,St,Xt,l.transform,xi),Ua=Hr&&ce.hasTextData(),Mo=f.layout.get("icon-text-fit")!=="none"&&Ua&&ce.hasIconData();$t&&Ls(ce,j.posMatrix,l,S,Ni,Pa,St,Le);var ga=l.translatePosMatrix(j.posMatrix,ne,R,L),Xi=$t||S&&Hr||Mo?Xs:Ni,da=l.translatePosMatrix(Pa,ne,R,L,!0),Go=it&&f.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ls={program:er,buffers:le,uniformValues:it?ce.iconsInText?Ql(Yt.kind,yr,tr,St,l,ga,Xi,da,_n,vn):tl(Yt.kind,yr,tr,St,l,ga,Xi,da,S,_n,!0):Iu(Yt.kind,yr,tr,St,l,ga,Xi,da,S,_n),atlasTexture:Jr,atlasTextureIcon:Xn,atlasInterpolation:Gn,atlasInterpolationIcon:Yn,isSDF:it,hasHalo:Go};if(br&&ce.canOverlap){kr=!0;for(var Uo=0,Xo=le.segments.get();Uo<Xo.length;Uo+=1){var Rs=Xo[Uo];nn.push({segments:new h.SegmentVector([Rs]),sortKey:Rs.sortKey,state:ls})}}else nn.push({segments:le.segments,sortKey:0,state:ls})}}}kr&&nn.sort(function(hl,Xl){return hl.sortKey-Xl.sortKey});for(var xo=0,fl=nn;xo<fl.length;xo+=1){var ms=fl[xo],Yo=ms.state;if(st.activeTexture.set(Rt.TEXTURE0),Yo.atlasTexture.bind(Yo.atlasInterpolation,Rt.CLAMP_TO_EDGE),Yo.atlasTextureIcon&&(st.activeTexture.set(Rt.TEXTURE1),Yo.atlasTextureIcon&&Yo.atlasTextureIcon.bind(Yo.atlasInterpolationIcon,Rt.CLAMP_TO_EDGE)),Yo.isSDF){var Lu=Yo.uniformValues;Yo.hasHalo&&(Lu.u_is_halo=1,$u(Yo.buffers,ms.segments,f,l,Yo.program,Or,et,ot,Lu)),Lu.u_is_halo=0}$u(Yo.buffers,ms.segments,f,l,Yo.program,Or,et,ot,Yo.uniformValues)}}function $u(l,d,f,m,S,R,L,q,Se){var Le=m.context;S.draw(Le,Le.gl.TRIANGLES,R,L,q,kt.disabled,Se,f.id,l.layoutVertexBuffer,l.indexBuffer,d,f.paint,m.transform.zoom,l.programConfigurations.get(f.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function Hl(l,d,f,m,S,R,L){var q,Se,Le,et,ot,st=l.context.gl,Rt=f.paint.get("fill-pattern"),Ct=Rt&&Rt.constantOr(1),Xt=f.getCrossfadeParameters();L?(Se=Ct&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=st.LINES):(Se=Ct?"fillPattern":"fill",q=st.TRIANGLES);for(var St=0,$t=m;St<$t.length;St+=1){var tr=$t[St],br=d.getTile(tr);if(!Ct||br.patternsLoaded()){var kr=br.getBucket(f);if(kr){var Or=kr.programConfigurations.get(f.id),Hr=l.useProgram(Se,Or);Ct&&(l.context.activeTexture.set(st.TEXTURE0),br.imageAtlasTexture.bind(st.LINEAR,st.CLAMP_TO_EDGE),Or.updatePaintBuffers(Xt));var nn=Rt.constantOr(null);if(nn&&br.imageAtlas){var M=br.imageAtlas,z=M.patternPositions[nn.to.toString()],j=M.patternPositions[nn.from.toString()];z&&j&&Or.setConstantPatternPositions(z,j)}var ne=l.translatePosMatrix(tr.posMatrix,br,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(L){et=kr.indexBuffer2,ot=kr.segments2;var ce=[st.drawingBufferWidth,st.drawingBufferHeight];Le=Se==="fillOutlinePattern"&&Ct?mc(ne,l,Xt,br,ce):ju(ne,ce)}else et=kr.indexBuffer,ot=kr.segments,Le=Ct?Mu(ne,l,Xt,br):Zu(ne);Hr.draw(l.context,q,S,l.stencilModeForClipping(tr),R,kt.disabled,Le,f.id,kr.layoutVertexBuffer,et,ot,f.paint,l.transform.zoom,Or)}}}}function _c(l,d,f,m,S,R,L){for(var q=l.context,Se=q.gl,Le=f.paint.get("fill-extrusion-pattern"),et=Le.constantOr(1),ot=f.getCrossfadeParameters(),st=f.paint.get("fill-extrusion-opacity"),Rt=0,Ct=m;Rt<Ct.length;Rt+=1){var Xt=Ct[Rt],St=d.getTile(Xt),$t=St.getBucket(f);if($t){var tr=$t.programConfigurations.get(f.id),br=l.useProgram(et?"fillExtrusionPattern":"fillExtrusion",tr);et&&(l.context.activeTexture.set(Se.TEXTURE0),St.imageAtlasTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),tr.updatePaintBuffers(ot));var kr=Le.constantOr(null);if(kr&&St.imageAtlas){var Or=St.imageAtlas,Hr=Or.patternPositions[kr.to.toString()],nn=Or.patternPositions[kr.from.toString()];Hr&&nn&&tr.setConstantPatternPositions(Hr,nn)}var M=l.translatePosMatrix(Xt.posMatrix,St,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),z=f.paint.get("fill-extrusion-vertical-gradient"),j=et?Jo(M,l,z,st,Xt,ot,St):gf(M,l,z,st);br.draw(q,q.gl.TRIANGLES,S,R,L,kt.backCCW,j,f.id,$t.layoutVertexBuffer,$t.indexBuffer,$t.segments,f.paint,l.transform.zoom,tr)}}}function nl(l,d,f,m,S,R){var L=l.context,q=L.gl,Se=d.fbo;if(Se){var Le=l.useProgram("hillshade");L.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,Se.colorAttachment.get());var et=function(ot,st,Rt){var Ct=Rt.paint.get("hillshade-shadow-color"),Xt=Rt.paint.get("hillshade-highlight-color"),St=Rt.paint.get("hillshade-accent-color"),$t=Rt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Rt.paint.get("hillshade-illumination-anchor")==="viewport"&&($t-=ot.transform.angle);var tr,br,kr,Or=!ot.options.moving;return{u_matrix:ot.transform.calculatePosMatrix(st.tileID.toUnwrapped(),Or),u_image:0,u_latrange:(tr=st.tileID,br=Math.pow(2,tr.canonical.z),kr=tr.canonical.y,[new h.MercatorCoordinate(0,kr/br).toLngLat().lat,new h.MercatorCoordinate(0,(kr+1)/br).toLngLat().lat]),u_light:[Rt.paint.get("hillshade-exaggeration"),$t],u_shadow:Ct,u_highlight:Xt,u_accent:St}}(l,d,f);Le.draw(L,q.TRIANGLES,m,S,R,kt.disabled,et,f.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function Bf(l,d,f,m,S,R){var L=l.context,q=L.gl,Se=d.dem;if(Se&&Se.data){var Le=Se.dim,et=Se.stride,ot=Se.getPixels();if(L.activeTexture.set(q.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||l.getTileTexture(et),d.demTexture){var st=d.demTexture;st.update(ot,{premultiply:!1}),st.bind(q.NEAREST,q.CLAMP_TO_EDGE)}else d.demTexture=new h.Texture(L,ot,q.RGBA,{premultiply:!1}),d.demTexture.bind(q.NEAREST,q.CLAMP_TO_EDGE);L.activeTexture.set(q.TEXTURE0);var Rt=d.fbo;if(!Rt){var Ct=new h.Texture(L,{width:Le,height:Le,data:null},q.RGBA);Ct.bind(q.LINEAR,q.CLAMP_TO_EDGE),(Rt=d.fbo=L.createFramebuffer(Le,Le,!0)).colorAttachment.set(Ct.texture)}L.bindFramebuffer.set(Rt.framebuffer),L.viewport.set([0,0,Le,Le]),l.useProgram("hillshadePrepare").draw(L,q.TRIANGLES,m,S,R,kt.disabled,function(Xt,St){var $t=St.stride,tr=h.create();return h.ortho(tr,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(tr,tr,[0,-h.EXTENT,0]),{u_matrix:tr,u_image:1,u_dimension:[$t,$t],u_zoom:Xt.overscaledZ,u_unpack:St.getUnpackVector()}}(d.tileID,Se),f.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),d.needsHillshadePrepare=!1}}function $c(l,d,f,m,S){var R=m.paint.get("raster-fade-duration");if(R>0){var L=h.browser.now(),q=(L-l.timeAdded)/R,Se=d?(L-d.timeAdded)/R:-1,Le=f.getSource(),et=S.coveringZoomLevel({tileSize:Le.tileSize,roundZoom:Le.roundZoom}),ot=!d||Math.abs(d.tileID.overscaledZ-et)>Math.abs(l.tileID.overscaledZ-et),st=ot&&l.refreshedUponExpiration?1:h.clamp(ot?q:1-Se,0,1);return l.refreshedUponExpiration&&q>=1&&(l.refreshedUponExpiration=!1),d?{opacity:1,mix:1-st}:{opacity:st,mix:0}}return{opacity:1,mix:0}}var _f=new h.Color(1,0,0,1),Wc=new h.Color(0,1,0,1),bf=new h.Color(0,0,1,1),bc=new h.Color(1,0,1,1),Gc=new h.Color(0,1,1,1);function xu(l,d,f,m){_s(l,0,d+f/2,l.transform.width,f,m)}function Wu(l,d,f,m){_s(l,d-f/2,0,f,l.transform.height,m)}function _s(l,d,f,m,S,R){var L=l.context,q=L.gl;q.enable(q.SCISSOR_TEST),q.scissor(d*h.browser.devicePixelRatio,f*h.browser.devicePixelRatio,m*h.browser.devicePixelRatio,S*h.browser.devicePixelRatio),L.clear({color:R}),q.disable(q.SCISSOR_TEST)}function xf(l,d,f){var m=l.context,S=m.gl,R=f.posMatrix,L=l.useProgram("debug"),q=ke.disabled,Se=qe.disabled,Le=l.colorModeForRenderPass();m.activeTexture.set(S.TEXTURE0),l.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),L.draw(m,S.LINE_STRIP,q,Se,Le,kt.disabled,Al(R,h.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var et=d.getTileByID(f.key).latestRawTileData,ot=Math.floor((et&&et.byteLength||0)/1024),st=d.getTile(f).tileSize,Rt=512/Math.min(st,512)*(f.overscaledZ/l.transform.zoom)*.5,Ct=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Ct+=" => "+f.overscaledZ),function(Xt,St){Xt.initDebugOverlayCanvas();var $t=Xt.debugOverlayCanvas,tr=Xt.context.gl,br=Xt.debugOverlayCanvas.getContext("2d");br.clearRect(0,0,$t.width,$t.height),br.shadowColor="white",br.shadowBlur=2,br.lineWidth=1.5,br.strokeStyle="white",br.textBaseline="top",br.font="bold 36px Open Sans, sans-serif",br.fillText(St,5,5),br.strokeText(St,5,5),Xt.debugOverlayTexture.update($t),Xt.debugOverlayTexture.bind(tr.LINEAR,tr.CLAMP_TO_EDGE)}(l,Ct+" "+ot+"kb"),L.draw(m,S.TRIANGLES,q,Se,mt.alphaBlended,kt.disabled,Al(R,h.Color.transparent,Rt),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var $l={symbol:function(l,d,f,m,S){if(l.renderPass==="translucent"){var R=qe.disabled,L=l.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(q,Se,Le,et,ot,st,Rt){for(var Ct=Se.transform,Xt=ot==="map",St=st==="map",$t=0,tr=q;$t<tr.length;$t+=1){var br=tr[$t],kr=et.getTile(br),Or=kr.getBucket(Le);if(Or&&Or.text&&Or.text.segments.get().length){var Hr=h.evaluateSizeForZoom(Or.textSizeData,Ct.zoom),nn=Za(kr,1,Se.transform.zoom),M=Sa(br.posMatrix,St,Xt,Se.transform,nn),z=Le.layout.get("icon-text-fit")!=="none"&&Or.hasIconData();if(Hr){var j=Math.pow(2,Ct.zoom-kr.tileID.overscaledZ);yf(Or,Xt,St,Rt,h.symbolSize,Ct,M,br.posMatrix,j,Hr,z)}}}}(m,l,f,d,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),S),f.paint.get("icon-opacity").constantOr(1)!==0&&Vl(l,d,f,m,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),R,L),f.paint.get("text-opacity").constantOr(1)!==0&&Vl(l,d,f,m,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),R,L),d.map.showCollisionBoxes&&(rl(l,d,f,m,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),rl(l,d,f,m,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))}},circle:function(l,d,f,m){if(l.renderPass==="translucent"){var S=f.paint.get("circle-opacity"),R=f.paint.get("circle-stroke-width"),L=f.paint.get("circle-stroke-opacity"),q=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)!==0||R.constantOr(1)!==0&&L.constantOr(1)!==0){for(var Se=l.context,Le=Se.gl,et=l.depthModeForSublayer(0,ke.ReadOnly),ot=qe.disabled,st=l.colorModeForRenderPass(),Rt=[],Ct=0;Ct<m.length;Ct++){var Xt=m[Ct],St=d.getTile(Xt),$t=St.getBucket(f);if($t){var tr=$t.programConfigurations.get(f.id),br={programConfiguration:tr,program:l.useProgram("circle",tr),layoutVertexBuffer:$t.layoutVertexBuffer,indexBuffer:$t.indexBuffer,uniformValues:Zl(l,Xt,St,f)};if(q)for(var kr=0,Or=$t.segments.get();kr<Or.length;kr+=1){var Hr=Or[kr];Rt.push({segments:new h.SegmentVector([Hr]),sortKey:Hr.sortKey,state:br})}else Rt.push({segments:$t.segments,sortKey:0,state:br})}}q&&Rt.sort(function(ne,ce){return ne.sortKey-ce.sortKey});for(var nn=0,M=Rt;nn<M.length;nn+=1){var z=M[nn],j=z.state;j.program.draw(Se,Le.TRIANGLES,et,ot,st,kt.disabled,j.uniformValues,f.id,j.layoutVertexBuffer,j.indexBuffer,z.segments,f.paint,l.transform.zoom,j.programConfiguration)}}}},heatmap:function(l,d,f,m){if(f.paint.get("heatmap-opacity")!==0)if(l.renderPass==="offscreen"){var S=l.context,R=S.gl,L=qe.disabled,q=new mt([R.ONE,R.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(Rt,Ct,Xt){var St=Rt.gl;Rt.activeTexture.set(St.TEXTURE1),Rt.viewport.set([0,0,Ct.width/4,Ct.height/4]);var $t=Xt.heatmapFbo;if($t)St.bindTexture(St.TEXTURE_2D,$t.colorAttachment.get()),Rt.bindFramebuffer.set($t.framebuffer);else{var tr=St.createTexture();St.bindTexture(St.TEXTURE_2D,tr),St.texParameteri(St.TEXTURE_2D,St.TEXTURE_WRAP_S,St.CLAMP_TO_EDGE),St.texParameteri(St.TEXTURE_2D,St.TEXTURE_WRAP_T,St.CLAMP_TO_EDGE),St.texParameteri(St.TEXTURE_2D,St.TEXTURE_MIN_FILTER,St.LINEAR),St.texParameteri(St.TEXTURE_2D,St.TEXTURE_MAG_FILTER,St.LINEAR),$t=Xt.heatmapFbo=Rt.createFramebuffer(Ct.width/4,Ct.height/4,!1),function(br,kr,Or,Hr){var nn=br.gl;nn.texImage2D(nn.TEXTURE_2D,0,nn.RGBA,kr.width/4,kr.height/4,0,nn.RGBA,br.extRenderToTextureHalfFloat?br.extTextureHalfFloat.HALF_FLOAT_OES:nn.UNSIGNED_BYTE,null),Hr.colorAttachment.set(Or)}(Rt,Ct,tr,$t)}})(S,l,f),S.clear({color:h.Color.transparent});for(var Se=0;Se<m.length;Se++){var Le=m[Se];if(!d.hasRenderableParent(Le)){var et=d.getTile(Le),ot=et.getBucket(f);if(ot){var st=ot.programConfigurations.get(f.id);l.useProgram("heatmap",st).draw(S,R.TRIANGLES,ke.disabled,L,q,kt.disabled,La(Le.posMatrix,et,l.transform.zoom,f.paint.get("heatmap-intensity")),f.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,f.paint,l.transform.zoom,st)}}}S.viewport.set([0,0,l.width,l.height])}else l.renderPass==="translucent"&&(l.context.setColorMode(l.colorModeForRenderPass()),function(Rt,Ct){var Xt=Rt.context,St=Xt.gl,$t=Ct.heatmapFbo;if($t){Xt.activeTexture.set(St.TEXTURE0),St.bindTexture(St.TEXTURE_2D,$t.colorAttachment.get()),Xt.activeTexture.set(St.TEXTURE1);var tr=Ct.colorRampTexture;tr||(tr=Ct.colorRampTexture=new h.Texture(Xt,Ct.colorRamp,St.RGBA)),tr.bind(St.LINEAR,St.CLAMP_TO_EDGE),Rt.useProgram("heatmapTexture").draw(Xt,St.TRIANGLES,ke.disabled,qe.disabled,Rt.colorModeForRenderPass(),kt.disabled,function(br,kr,Or,Hr){var nn=h.create();h.ortho(nn,0,br.width,br.height,0,0,1);var M=br.context.gl;return{u_matrix:nn,u_world:[M.drawingBufferWidth,M.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:kr.paint.get("heatmap-opacity")}}(Rt,Ct),Ct.id,Rt.viewportBuffer,Rt.quadTriangleIndexBuffer,Rt.viewportSegments,Ct.paint,Rt.transform.zoom)}}(l,f))},line:function(l,d,f,m){if(l.renderPass==="translucent"){var S=f.paint.get("line-opacity"),R=f.paint.get("line-width");if(S.constantOr(1)!==0&&R.constantOr(1)!==0)for(var L=l.depthModeForSublayer(0,ke.ReadOnly),q=l.colorModeForRenderPass(),Se=f.paint.get("line-dasharray"),Le=f.paint.get("line-pattern"),et=Le.constantOr(1),ot=f.paint.get("line-gradient"),st=f.getCrossfadeParameters(),Rt=et?"linePattern":Se?"lineSDF":ot?"lineGradient":"line",Ct=l.context,Xt=Ct.gl,St=!0,$t=0,tr=m;$t<tr.length;$t+=1){var br=tr[$t],kr=d.getTile(br);if(!et||kr.patternsLoaded()){var Or=kr.getBucket(f);if(Or){var Hr=Or.programConfigurations.get(f.id),nn=l.context.program.get(),M=l.useProgram(Rt,Hr),z=St||M.program!==nn,j=Le.constantOr(null);if(j&&kr.imageAtlas){var ne=kr.imageAtlas,ce=ne.patternPositions[j.to.toString()],le=ne.patternPositions[j.from.toString()];ce&&le&&Hr.setConstantPatternPositions(ce,le)}var lt=et?Vu(l,kr,f,st):Se?Df(l,kr,f,Se,st):ot?so(l,kr,f,Or.lineClipsArray.length):qa(l,kr,f);if(et)Ct.activeTexture.set(Xt.TEXTURE0),kr.imageAtlasTexture.bind(Xt.LINEAR,Xt.CLAMP_TO_EDGE),Hr.updatePaintBuffers(st);else if(Se&&(z||l.lineAtlas.dirty))Ct.activeTexture.set(Xt.TEXTURE0),l.lineAtlas.bind(Ct);else if(ot){var it=Or.gradients[f.id],Yt=it.texture;if(f.gradientVersion!==it.version){var ht=256;if(f.stepInterpolant){var er=d.getSource().maxzoom,yr=br.canonical.z===er?Math.ceil(1<<l.transform.maxZoom-br.canonical.z):1;ht=h.clamp(h.nextPowerOfTwo(Or.maxLineLength/h.EXTENT*1024*yr),256,Ct.maxTextureSize)}it.gradient=h.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:ht,image:it.gradient||void 0,clips:Or.lineClipsArray}),it.texture?it.texture.update(it.gradient):it.texture=new h.Texture(Ct,it.gradient,Xt.RGBA),it.version=f.gradientVersion,Yt=it.texture}Ct.activeTexture.set(Xt.TEXTURE0),Yt.bind(f.stepInterpolant?Xt.NEAREST:Xt.LINEAR,Xt.CLAMP_TO_EDGE)}M.draw(Ct,Xt.TRIANGLES,L,l.stencilModeForClipping(br),q,kt.disabled,lt,f.id,Or.layoutVertexBuffer,Or.indexBuffer,Or.segments,f.paint,l.transform.zoom,Hr,Or.layoutVertexBuffer2),St=!1}}}}},fill:function(l,d,f,m){var S=f.paint.get("fill-color"),R=f.paint.get("fill-opacity");if(R.constantOr(1)!==0){var L=l.colorModeForRenderPass(),q=f.paint.get("fill-pattern"),Se=l.opaquePassEnabledForLayer()&&!q.constantOr(1)&&S.constantOr(h.Color.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(l.renderPass===Se){var Le=l.depthModeForSublayer(1,l.renderPass==="opaque"?ke.ReadWrite:ke.ReadOnly);Hl(l,d,f,m,Le,L,!1)}if(l.renderPass==="translucent"&&f.paint.get("fill-antialias")){var et=l.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,ke.ReadOnly);Hl(l,d,f,m,et,L,!0)}}},"fill-extrusion":function(l,d,f,m){var S=f.paint.get("fill-extrusion-opacity");if(S!==0&&l.renderPass==="translucent"){var R=new ke(l.context.gl.LEQUAL,ke.ReadWrite,l.depthRangeFor3D);if(S!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))_c(l,d,f,m,R,qe.disabled,mt.disabled),_c(l,d,f,m,R,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var L=l.colorModeForRenderPass();_c(l,d,f,m,R,qe.disabled,L)}}},hillshade:function(l,d,f,m){if(l.renderPass==="offscreen"||l.renderPass==="translucent"){for(var S=l.context,R=l.depthModeForSublayer(0,ke.ReadOnly),L=l.colorModeForRenderPass(),q=l.renderPass==="translucent"?l.stencilConfigForOverlap(m):[{},m],Se=q[0],Le=0,et=q[1];Le<et.length;Le+=1){var ot=et[Le],st=d.getTile(ot);st.needsHillshadePrepare&&l.renderPass==="offscreen"?Bf(l,st,f,R,qe.disabled,L):l.renderPass==="translucent"&&nl(l,st,f,R,Se[ot.overscaledZ],L)}S.viewport.set([0,0,l.width,l.height])}},raster:function(l,d,f,m){if(l.renderPass==="translucent"&&f.paint.get("raster-opacity")!==0&&m.length)for(var S=l.context,R=S.gl,L=d.getSource(),q=l.useProgram("raster"),Se=l.colorModeForRenderPass(),Le=L instanceof at?[{},m]:l.stencilConfigForOverlap(m),et=Le[0],ot=Le[1],st=ot[ot.length-1].overscaledZ,Rt=!l.options.moving,Ct=0,Xt=ot;Ct<Xt.length;Ct+=1){var St=Xt[Ct],$t=l.depthModeForSublayer(St.overscaledZ-st,f.paint.get("raster-opacity")===1?ke.ReadWrite:ke.ReadOnly,R.LESS),tr=d.getTile(St),br=l.transform.calculatePosMatrix(St.toUnwrapped(),Rt);tr.registerFadeDuration(f.paint.get("raster-fade-duration"));var kr=d.findLoadedParent(St,0),Or=$c(tr,kr,d,f,l.transform),Hr=void 0,nn=void 0,M=f.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;S.activeTexture.set(R.TEXTURE0),tr.texture.bind(M,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),S.activeTexture.set(R.TEXTURE1),kr?(kr.texture.bind(M,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),Hr=Math.pow(2,kr.tileID.overscaledZ-tr.tileID.overscaledZ),nn=[tr.tileID.canonical.x*Hr%1,tr.tileID.canonical.y*Hr%1]):tr.texture.bind(M,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);var z=yc(br,nn||[0,0],Hr||1,Or,f);L instanceof at?q.draw(S,R.TRIANGLES,$t,qe.disabled,Se,kt.disabled,z,f.id,L.boundsBuffer,l.quadTriangleIndexBuffer,L.boundsSegments):q.draw(S,R.TRIANGLES,$t,et[St.overscaledZ],Se,kt.disabled,z,f.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,d,f){var m=f.paint.get("background-color"),S=f.paint.get("background-opacity");if(S!==0){var R=l.context,L=R.gl,q=l.transform,Se=q.tileSize,Le=f.paint.get("background-pattern");if(!l.isPatternMissing(Le)){var et=!Le&&m.a===1&&S===1&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===et){var ot=qe.disabled,st=l.depthModeForSublayer(0,et==="opaque"?ke.ReadWrite:ke.ReadOnly),Rt=l.colorModeForRenderPass(),Ct=l.useProgram(Le?"backgroundPattern":"background"),Xt=q.coveringTiles({tileSize:Se});Le&&(R.activeTexture.set(L.TEXTURE0),l.imageManager.bind(l.context));for(var St=f.getCrossfadeParameters(),$t=0,tr=Xt;$t<tr.length;$t+=1){var br=tr[$t],kr=l.transform.calculatePosMatrix(br.toUnwrapped()),Or=Le?jl(kr,S,l,Le,{tileID:br,tileSize:Se},St):Jl(kr,S,m);Ct.draw(R,L.TRIANGLES,st,ot,Rt,kt.disabled,Or,f.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,d,f){for(var m=0;m<f.length;m++)xf(l,d,f[m])},custom:function(l,d,f){var m=l.context,S=f.implementation;if(l.renderPass==="offscreen"){var R=S.prerender;R&&(l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),R.call(S,m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState())}else if(l.renderPass==="translucent"){l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),m.setStencilMode(qe.disabled);var L=S.renderingMode==="3d"?new ke(l.context.gl.LEQUAL,ke.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,ke.ReadOnly);m.setDepthMode(L),S.render(m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState(),m.bindFramebuffer.set(null)}}},uo=function(l,d){this.context=new $e(l),this.transform=d,this._tileTextures={},this.setup(),this.numSublayers=Ge.maxUnderzooming+Ge.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new xl,this.gpuTimers={}};uo.prototype.resize=function(l,d){if(this.width=l*h.browser.devicePixelRatio,this.height=d*h.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var f=0,m=this.style._order;f<m.length;f+=1)this.style._layers[m[f]].resize()},uo.prototype.setup=function(){var l=this.context,d=new h.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(h.EXTENT,0),d.emplaceBack(0,h.EXTENT),d.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(d,Ai.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);var f=new h.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(h.EXTENT,0),f.emplaceBack(0,h.EXTENT),f.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=l.createVertexBuffer(f,Ai.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);var m=new h.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(h.EXTENT,0,h.EXTENT,0),m.emplaceBack(0,h.EXTENT,0,h.EXTENT),m.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(m,nt.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);var S=new h.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(S,Ai.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);var R=new h.StructArrayLayout1ui2;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(R);var L=new h.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(L),this.emptyTexture=new h.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var q=this.context.gl;this.stencilClearMode=new qe({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO)},uo.prototype.clearStencil=function(){var l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var f=h.create();h.ortho(f,0,this.width,this.height,0,0,1),h.scale(f,f,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,d.TRIANGLES,ke.disabled,this.stencilClearMode,mt.disabled,kt.disabled,ou(f),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},uo.prototype._renderTileClippingMasks=function(l,d){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&d&&d.length){this.currentStencilSource=l.source;var f=this.context,m=f.gl;this.nextStencilID+d.length>256&&this.clearStencil(),f.setColorMode(mt.disabled),f.setDepthMode(ke.disabled);var S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var R=0,L=d;R<L.length;R+=1){var q=L[R],Se=this._tileClippingMaskIDs[q.key]=this.nextStencilID++;S.draw(f,m.TRIANGLES,ke.disabled,new qe({func:m.ALWAYS,mask:0},Se,255,m.KEEP,m.KEEP,m.REPLACE),mt.disabled,kt.disabled,ou(q.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},uo.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,d=this.context.gl;return new qe({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)},uo.prototype.stencilModeForClipping=function(l){var d=this.context.gl;return new qe({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)},uo.prototype.stencilConfigForOverlap=function(l){var d,f=this.context.gl,m=l.sort(function(Se,Le){return Le.overscaledZ-Se.overscaledZ}),S=m[m.length-1].overscaledZ,R=m[0].overscaledZ-S+1;if(R>1){this.currentStencilSource=void 0,this.nextStencilID+R>256&&this.clearStencil();for(var L={},q=0;q<R;q++)L[q+S]=new qe({func:f.GEQUAL,mask:255},q+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=R,[L,m]}return[(d={},d[S]=qe.disabled,d),m]},uo.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new mt([l.CONSTANT_COLOR,l.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mt.unblended:mt.alphaBlended},uo.prototype.depthModeForSublayer=function(l,d,f){if(!this.opaquePassEnabledForLayer())return ke.disabled;var m=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new ke(f||this.context.gl.LEQUAL,d,[m,m])},uo.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},uo.prototype.render=function(l,d){var f=this;this.style=l,this.options=d,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(h.browser.now()),this.imageManager.beginFrame();var m=this.style._order,S=this.style.sourceCaches;for(var R in S){var L=S[R];L.used&&L.prepare(this.context)}var q,Se,Le={},et={},ot={};for(var st in S){var Rt=S[st];Le[st]=Rt.getVisibleCoordinates(),et[st]=Le[st].slice().reverse(),ot[st]=Rt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ct=0;Ct<m.length;Ct++)if(this.style._layers[m[Ct]].is3D()){this.opaquePassCutoff=Ct;break}this.renderPass="offscreen";for(var Xt=0,St=m;Xt<St.length;Xt+=1){var $t=this.style._layers[St[Xt]];if($t.hasOffscreenPass()&&!$t.isHidden(this.transform.zoom)){var tr=et[$t.source];($t.type==="custom"||tr.length)&&this.renderLayer(this,S[$t.source],$t,tr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){var br=this.style._layers[m[this.currentLayer]],kr=S[br.source],Or=Le[br.source];this._renderTileClippingMasks(br,Or),this.renderLayer(this,kr,br,Or)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){var Hr=this.style._layers[m[this.currentLayer]],nn=S[Hr.source],M=(Hr.type==="symbol"?ot:et)[Hr.source];this._renderTileClippingMasks(Hr,Le[Hr.source]),this.renderLayer(this,nn,Hr,M)}this.options.showTileBoundaries&&(h.values(this.style._layers).forEach(function(z){z.source&&!z.isHidden(f.transform.zoom)&&(z.source!==(Se&&Se.id)&&(Se=f.style.sourceCaches[z.source]),(!q||q.getSource().maxzoom<Se.getSource().maxzoom)&&(q=Se))}),q&&$l.debug(this,q,q.getVisibleCoordinates())),this.options.showPadding&&function(z){var j=z.transform.padding;xu(z,z.transform.height-(j.top||0),3,_f),xu(z,j.bottom||0,3,Wc),Wu(z,j.left||0,3,bf),Wu(z,z.transform.width-(j.right||0),3,bc);var ne=z.transform.centerPoint;(function(ce,le,lt,it){_s(ce,le-1,lt-10,2,20,it),_s(ce,le-10,lt-1,20,2,it)})(z,ne.x,z.transform.height-ne.y,Gc)}(this),this.context.setDefault()},uo.prototype.renderLayer=function(l,d,f,m){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||m.length)&&(this.id=f.id,this.gpuTimingStart(f),$l[f.type](l,d,f,m,this.style.placement.variableOffsets),this.gpuTimingEnd())},uo.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var d=this.context.extTimerQuery,f=this.gpuTimers[l.id];f||(f=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),f.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,f.query)}},uo.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},uo.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},uo.prototype.queryGpuTimers=function(l){var d={};for(var f in l){var m=l[f],S=this.context.extTimerQuery,R=S.getQueryObjectEXT(m.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(m.query),d[f]=R}return d},uo.prototype.translatePosMatrix=function(l,d,f,m,S){if(!f[0]&&!f[1])return l;var R=S?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(R){var L=Math.sin(R),q=Math.cos(R);f=[f[0]*q-f[1]*L,f[0]*L+f[1]*q]}var Se=[S?f[0]:Za(d,f[0],this.transform.zoom),S?f[1]:Za(d,f[1],this.transform.zoom),0],Le=new Float32Array(16);return h.translate(Le,l,Se),Le},uo.prototype.saveTileTexture=function(l){var d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]},uo.prototype.getTileTexture=function(l){var d=this._tileTextures[l];return d&&d.length>0?d.pop():null},uo.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var d=this.imageManager.getPattern(l.from.toString()),f=this.imageManager.getPattern(l.to.toString());return!d||!f},uo.prototype.useProgram=function(l,d){this.cache=this.cache||{};var f=""+l+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[f]||(this.cache[f]=new bo(this.context,l,th[l],d,kc[l],this._showOverdrawInspector)),this.cache[f]},uo.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},uo.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},uo.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},uo.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ef=function(l,d){this.points=l,this.planes=d};Ef.fromInvProjectionMatrix=function(l,d,f){var m=Math.pow(2,f),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return h.transformMat4([],L,l)}).map(function(L){return h.scale$1([],L,1/L[3]/d*m)}),R=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var q=h.sub([],S[L[0]],S[L[1]]),Se=h.sub([],S[L[2]],S[L[1]]),Le=h.normalize([],h.cross([],q,Se)),et=-h.dot(Le,S[L[1]]);return Le.concat(et)});return new Ef(S,R)};var Ys=function(l,d){this.min=l,this.max=d,this.center=h.scale$2([],h.add([],this.min,this.max),.5)};Ys.prototype.quadrant=function(l){for(var d=[l%2==0,l<2],f=h.clone$2(this.min),m=h.clone$2(this.max),S=0;S<d.length;S++)f[S]=d[S]?this.min[S]:this.center[S],m[S]=d[S]?this.center[S]:this.max[S];return m[2]=this.max[2],new Ys(f,m)},Ys.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},Ys.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},Ys.prototype.intersects=function(l){for(var d=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],f=!0,m=0;m<l.planes.length;m++){for(var S=l.planes[m],R=0,L=0;L<d.length;L++)R+=h.dot$1(S,d[L])>=0;if(R===0)return 0;R!==d.length&&(f=!1)}if(f)return 2;for(var q=0;q<3;q++){for(var Se=Number.MAX_VALUE,Le=-Number.MAX_VALUE,et=0;et<l.points.length;et++){var ot=l.points[et][q]-this.min[q];Se=Math.min(Se,ot),Le=Math.max(Le,ot)}if(Le<0||Se>this.max[q]-this.min[q])return 0}return 1};var wl=function(l,d,f,m){if(l===void 0&&(l=0),d===void 0&&(d=0),f===void 0&&(f=0),m===void 0&&(m=0),isNaN(l)||l<0||isNaN(d)||d<0||isNaN(f)||f<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=f,this.right=m};wl.prototype.interpolate=function(l,d,f){return d.top!=null&&l.top!=null&&(this.top=h.number(l.top,d.top,f)),d.bottom!=null&&l.bottom!=null&&(this.bottom=h.number(l.bottom,d.bottom,f)),d.left!=null&&l.left!=null&&(this.left=h.number(l.left,d.left,f)),d.right!=null&&l.right!=null&&(this.right=h.number(l.right,d.right,f)),this},wl.prototype.getCenter=function(l,d){var f=h.clamp((this.left+l-this.right)/2,0,l),m=h.clamp((this.top+d-this.bottom)/2,0,d);return new h.Point(f,m)},wl.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},wl.prototype.clone=function(){return new wl(this.top,this.bottom,this.left,this.right)},wl.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ia=function(l,d,f,m,S){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=S===void 0||S,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=f==null?0:f,this._maxPitch=m==null?60:m,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wl,this._posMatrixCache={},this._alignedPosMatrixCache={}},lo={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ia.prototype.clone=function(){var l=new Ia(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},lo.minZoom.get=function(){return this._minZoom},lo.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},lo.maxZoom.get=function(){return this._maxZoom},lo.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},lo.minPitch.get=function(){return this._minPitch},lo.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},lo.maxPitch.get=function(){return this._maxPitch},lo.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},lo.renderWorldCopies.get=function(){return this._renderWorldCopies},lo.renderWorldCopies.set=function(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l},lo.worldSize.get=function(){return this.tileSize*this.scale},lo.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},lo.size.get=function(){return new h.Point(this.width,this.height)},lo.bearing.get=function(){return-this.angle/Math.PI*180},lo.bearing.set=function(l){var d=-h.wrap(l,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},lo.pitch.get=function(){return this._pitch/Math.PI*180},lo.pitch.set=function(l){var d=h.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())},lo.fov.get=function(){return this._fov/Math.PI*180},lo.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},lo.zoom.get=function(){return this._zoom},lo.zoom.set=function(l){var d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this._constrain(),this._calcMatrices())},lo.center.get=function(){return this._center},lo.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},lo.padding.get=function(){return this._edgeInsets.toJSON()},lo.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},lo.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ia.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},Ia.prototype.interpolatePadding=function(l,d,f){this._unmodified=!1,this._edgeInsets.interpolate(l,d,f),this._constrain(),this._calcMatrices()},Ia.prototype.coveringZoomLevel=function(l){var d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)},Ia.prototype.getVisibleUnwrappedCoordinates=function(l){var d=[new h.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var f=this.pointCoordinate(new h.Point(0,0)),m=this.pointCoordinate(new h.Point(this.width,0)),S=this.pointCoordinate(new h.Point(this.width,this.height)),R=this.pointCoordinate(new h.Point(0,this.height)),L=Math.floor(Math.min(f.x,m.x,S.x,R.x)),q=Math.floor(Math.max(f.x,m.x,S.x,R.x)),Se=L-1;Se<=q+1;Se++)Se!==0&&d.push(new h.UnwrappedTileID(Se,l));return d},Ia.prototype.coveringTiles=function(l){var d=this.coveringZoomLevel(l),f=d;if(l.minzoom!==void 0&&d<l.minzoom)return[];l.maxzoom!==void 0&&d>l.maxzoom&&(d=l.maxzoom);var m=h.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,d),R=[S*m.x,S*m.y,0],L=Ef.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d),q=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(q=d);var Se=function(z){return{aabb:new Ys([z*S,0,0],[(z+1)*S,S,0]),zoom:0,x:0,y:0,wrap:z,fullyVisible:!1}},Le=[],et=[],ot=d,st=l.reparseOverscaled?f:d;if(this._renderWorldCopies)for(var Rt=1;Rt<=3;Rt++)Le.push(Se(-Rt)),Le.push(Se(Rt));for(Le.push(Se(0));Le.length>0;){var Ct=Le.pop(),Xt=Ct.x,St=Ct.y,$t=Ct.fullyVisible;if(!$t){var tr=Ct.aabb.intersects(L);if(tr===0)continue;$t=tr===2}var br=Ct.aabb.distanceX(R),kr=Ct.aabb.distanceY(R),Or=Math.max(Math.abs(br),Math.abs(kr));if(Ct.zoom===ot||Or>3+(1<<ot-Ct.zoom)-2&&Ct.zoom>=q)et.push({tileID:new h.OverscaledTileID(Ct.zoom===ot?st:Ct.zoom,Ct.wrap,Ct.zoom,Xt,St),distanceSq:h.sqrLen([R[0]-.5-Xt,R[1]-.5-St])});else for(var Hr=0;Hr<4;Hr++){var nn=(Xt<<1)+Hr%2,M=(St<<1)+(Hr>>1);Le.push({aabb:Ct.aabb.quadrant(Hr),zoom:Ct.zoom+1,x:nn,y:M,wrap:Ct.wrap,fullyVisible:$t})}}return et.sort(function(z,j){return z.distanceSq-j.distanceSq}).map(function(z){return z.tileID})},Ia.prototype.resize=function(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()},lo.unmodified.get=function(){return this._unmodified},Ia.prototype.zoomScale=function(l){return Math.pow(2,l)},Ia.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},Ia.prototype.project=function(l){var d=h.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.Point(h.mercatorXfromLng(l.lng)*this.worldSize,h.mercatorYfromLat(d)*this.worldSize)},Ia.prototype.unproject=function(l){return new h.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},lo.point.get=function(){return this.project(this.center)},Ia.prototype.setLocationAtPoint=function(l,d){var f=this.pointCoordinate(d),m=this.pointCoordinate(this.centerPoint),S=this.locationCoordinate(l),R=new h.MercatorCoordinate(S.x-(f.x-m.x),S.y-(f.y-m.y));this.center=this.coordinateLocation(R),this._renderWorldCopies&&(this.center=this.center.wrap())},Ia.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},Ia.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},Ia.prototype.locationCoordinate=function(l){return h.MercatorCoordinate.fromLngLat(l)},Ia.prototype.coordinateLocation=function(l){return l.toLngLat()},Ia.prototype.pointCoordinate=function(l){var d=[l.x,l.y,0,1],f=[l.x,l.y,1,1];h.transformMat4(d,d,this.pixelMatrixInverse),h.transformMat4(f,f,this.pixelMatrixInverse);var m=d[3],S=f[3],R=d[1]/m,L=f[1]/S,q=d[2]/m,Se=f[2]/S,Le=q===Se?0:(0-q)/(Se-q);return new h.MercatorCoordinate(h.number(d[0]/m,f[0]/S,Le)/this.worldSize,h.number(R,L,Le)/this.worldSize)},Ia.prototype.coordinatePoint=function(l){var d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return h.transformMat4(d,d,this.pixelMatrix),new h.Point(d[0]/d[3],d[1]/d[3])},Ia.prototype.getBounds=function(){return new h.LngLatBounds().extend(this.pointLocation(new h.Point(0,0))).extend(this.pointLocation(new h.Point(this.width,0))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))},Ia.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ia.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ia.prototype.calculatePosMatrix=function(l,d){d===void 0&&(d=!1);var f=l.key,m=d?this._alignedPosMatrixCache:this._posMatrixCache;if(m[f])return m[f];var S=l.canonical,R=this.worldSize/this.zoomScale(S.z),L=S.x+Math.pow(2,S.z)*l.wrap,q=h.identity(new Float64Array(16));return h.translate(q,q,[L*R,S.y*R,0]),h.scale(q,q,[R/h.EXTENT,R/h.EXTENT,1]),h.multiply(q,d?this.alignedProjMatrix:this.projMatrix,q),m[f]=new Float32Array(q),m[f]},Ia.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ia.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,d,f,m,S=-90,R=90,L=-180,q=180,Se=this.size,Le=this._unmodified;if(this.latRange){var et=this.latRange;S=h.mercatorYfromLat(et[1])*this.worldSize,l=(R=h.mercatorYfromLat(et[0])*this.worldSize)-S<Se.y?Se.y/(R-S):0}if(this.lngRange){var ot=this.lngRange;L=h.mercatorXfromLng(ot[0])*this.worldSize,d=(q=h.mercatorXfromLng(ot[1])*this.worldSize)-L<Se.x?Se.x/(q-L):0}var st=this.point,Rt=Math.max(d||0,l||0);if(Rt)return this.center=this.unproject(new h.Point(d?(q+L)/2:st.x,l?(R+S)/2:st.y)),this.zoom+=this.scaleZoom(Rt),this._unmodified=Le,void(this._constraining=!1);if(this.latRange){var Ct=st.y,Xt=Se.y/2;Ct-Xt<S&&(m=S+Xt),Ct+Xt>R&&(m=R-Xt)}if(this.lngRange){var St=st.x,$t=Se.x/2;St-$t<L&&(f=L+$t),St+$t>q&&(f=q-$t)}f===void 0&&m===void 0||(this.center=this.unproject(new h.Point(f!==void 0?f:st.x,m!==void 0?m:st.y))),this._unmodified=Le,this._constraining=!1}},Ia.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var d=Math.PI/2+this._pitch,f=this._fov*(.5+l.y/this.height),m=Math.sin(f)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-d-f,.01,Math.PI-.01)),S=this.point,R=S.x,L=S.y,q=1.01*(Math.cos(Math.PI/2-this._pitch)*m+this.cameraToCenterDistance),Se=this.height/50,Le=new Float64Array(16);h.perspective(Le,this._fov,this.width/this.height,Se,q),Le[8]=2*-l.x/this.width,Le[9]=2*l.y/this.height,h.scale(Le,Le,[1,-1,1]),h.translate(Le,Le,[0,0,-this.cameraToCenterDistance]),h.rotateX(Le,Le,this._pitch),h.rotateZ(Le,Le,this.angle),h.translate(Le,Le,[-R,-L,0]),this.mercatorMatrix=h.scale([],Le,[this.worldSize,this.worldSize,this.worldSize]),h.scale(Le,Le,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Le,this.invProjMatrix=h.invert([],this.projMatrix);var et=this.width%2/2,ot=this.height%2/2,st=Math.cos(this.angle),Rt=Math.sin(this.angle),Ct=R-Math.round(R)+st*et+Rt*ot,Xt=L-Math.round(L)+st*ot+Rt*et,St=new Float64Array(Le);if(h.translate(St,St,[Ct>.5?Ct-1:Ct,Xt>.5?Xt-1:Xt,0]),this.alignedProjMatrix=St,Le=h.create(),h.scale(Le,Le,[this.width/2,-this.height/2,1]),h.translate(Le,Le,[1,-1,0]),this.labelPlaneMatrix=Le,Le=h.create(),h.scale(Le,Le,[1,-1,1]),h.translate(Le,Le,[-1,-1,0]),h.scale(Le,Le,[2/this.width,2/this.height,1]),this.glCoordMatrix=Le,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Le=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Le,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ia.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new h.Point(0,0)),d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return h.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ia.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,l))},Ia.prototype.getCameraQueryGeometry=function(l){var d=this.getCameraPoint();if(l.length===1)return[l[0],d];for(var f=d.x,m=d.y,S=d.x,R=d.y,L=0,q=l;L<q.length;L+=1){var Se=q[L];f=Math.min(f,Se.x),m=Math.min(m,Se.y),S=Math.max(S,Se.x),R=Math.max(R,Se.y)}return[new h.Point(f,m),new h.Point(S,m),new h.Point(S,R),new h.Point(f,R),new h.Point(f,m)]},Object.defineProperties(Ia.prototype,lo);var Ou=function(l){var d,f,m,S;this._hashName=l&&encodeURIComponent(l),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(d=this._updateHashUnthrottled.bind(this),f=!1,m=null,S=function(){m=null,f&&(d(),m=setTimeout(S,300),f=!1)},function(){return f=!0,m||S(),m})};Ou.prototype.addTo=function(l){return this._map=l,h.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ou.prototype.remove=function(){return h.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ou.prototype.getHashString=function(l){var d=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,m=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,m),R=Math.round(d.lng*S)/S,L=Math.round(d.lat*S)/S,q=this._map.getBearing(),Se=this._map.getPitch(),Le="";if(Le+=l?"/"+R+"/"+L+"/"+f:f+"/"+L+"/"+R,(q||Se)&&(Le+="/"+Math.round(10*q)/10),Se&&(Le+="/"+Math.round(Se)),this._hashName){var et=this._hashName,ot=!1,st=h.window.location.hash.slice(1).split("&").map(function(Rt){var Ct=Rt.split("=")[0];return Ct===et?(ot=!0,Ct+"="+Le):Rt}).filter(function(Rt){return Rt});return ot||st.push(et+"="+Le),"#"+st.join("&")}return"#"+Le},Ou.prototype._getCurrentHash=function(){var l,d=this,f=h.window.location.hash.replace("#","");return this._hashName?(f.split("&").map(function(m){return m.split("=")}).forEach(function(m){m[0]===d._hashName&&(l=m)}),(l&&l[1]||"").split("/")):f.split("/")},Ou.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(f){return isNaN(f)})){var d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:d,pitch:+(l[4]||0)}),!0}return!1},Ou.prototype._updateHashUnthrottled=function(){var l=h.window.location.href.replace(/(#.+)?$/,this.getHashString());try{h.window.history.replaceState(h.window.history.state,null,l)}catch(d){}};var Xc={linearity:.3,easing:h.bezier(0,0,.3,1)},Pu=h.extend({deceleration:2500,maxSpeed:1400},Xc),Bs=h.extend({deceleration:20,maxSpeed:1400},Xc),Ff=h.extend({deceleration:1e3,maxSpeed:360},Xc),Yc=h.extend({deceleration:1e3,maxSpeed:90},Xc),ec=function(l){this._map=l,this.clear()};function tc(l,d){(!l.duration||l.duration<d.duration)&&(l.duration=d.duration,l.easing=d.easing)}function ps(l,d,f){var m=f.maxSpeed,S=f.linearity,R=f.deceleration,L=h.clamp(l*S/(d/1e3),-m,m),q=Math.abs(L)/(R*S);return{easing:f.easing,duration:1e3*q,amount:L*(q/2)}}ec.prototype.clear=function(){this._inertiaBuffer=[]},ec.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.browser.now(),settings:l})},ec.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,d=h.browser.now();l.length>0&&d-l[0].time>160;)l.shift()},ec.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var d={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0},f=0,m=this._inertiaBuffer;f<m.length;f+=1){var S=m[f].settings;d.zoom+=S.zoomDelta||0,d.bearing+=S.bearingDelta||0,d.pitch+=S.pitchDelta||0,S.panDelta&&d.pan._add(S.panDelta),S.around&&(d.around=S.around),S.pinchAround&&(d.pinchAround=S.pinchAround)}var R=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(d.pan.mag()){var q=ps(d.pan.mag(),R,h.extend({},Pu,l||{}));L.offset=d.pan.mult(q.amount/d.pan.mag()),L.center=this._map.transform.center,tc(L,q)}if(d.zoom){var Se=ps(d.zoom,R,Bs);L.zoom=this._map.transform.zoom+Se.amount,tc(L,Se)}if(d.bearing){var Le=ps(d.bearing,R,Ff);L.bearing=this._map.transform.bearing+h.clamp(Le.amount,-179,179),tc(L,Le)}if(d.pitch){var et=ps(d.pitch,R,Yc);L.pitch=this._map.transform.pitch+et.amount,tc(L,et)}if(L.zoom||L.bearing){var ot=d.pinchAround===void 0?d.around:d.pinchAround;L.around=ot?this._map.unproject(ot):this._map.getCenter()}return this.clear(),h.extend(L,{noMoveStart:!0})}};var Co=function(l){function d(m,S,R,L){L===void 0&&(L={});var q=C.mousePos(S.getCanvasContainer(),R),Se=S.unproject(q);l.call(this,m,h.extend({point:q,lngLat:Se,originalEvent:R},L)),this._defaultPrevented=!1,this.target=S}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var f={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},f.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,f),d}(h.Event),xc=function(l){function d(m,S,R){var L=m==="touchend"?R.changedTouches:R.touches,q=C.touchPos(S.getCanvasContainer(),L),Se=q.map(function(ot){return S.unproject(ot)}),Le=q.reduce(function(ot,st,Rt,Ct){return ot.add(st.div(Ct.length))},new h.Point(0,0)),et=S.unproject(Le);l.call(this,m,{points:q,point:Le,lngLats:Se,lngLat:et,originalEvent:R}),this._defaultPrevented=!1}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var f={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},f.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,f),d}(h.Event),Nf=function(l){function d(m,S,R){l.call(this,m,{originalEvent:R}),this._defaultPrevented=!1}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var f={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},f.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,f),d}(h.Event),wo=function(l,d){this._map=l,this._clickTolerance=d.clickTolerance};wo.prototype.reset=function(){delete this._mousedownPos},wo.prototype.wheel=function(l){return this._firePreventable(new Nf(l.type,this._map,l))},wo.prototype.mousedown=function(l,d){return this._mousedownPos=d,this._firePreventable(new Co(l.type,this._map,l))},wo.prototype.mouseup=function(l){this._map.fire(new Co(l.type,this._map,l))},wo.prototype.click=function(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Co(l.type,this._map,l))},wo.prototype.dblclick=function(l){return this._firePreventable(new Co(l.type,this._map,l))},wo.prototype.mouseover=function(l){this._map.fire(new Co(l.type,this._map,l))},wo.prototype.mouseout=function(l){this._map.fire(new Co(l.type,this._map,l))},wo.prototype.touchstart=function(l){return this._firePreventable(new xc(l.type,this._map,l))},wo.prototype.touchmove=function(l){this._map.fire(new xc(l.type,this._map,l))},wo.prototype.touchend=function(l){this._map.fire(new xc(l.type,this._map,l))},wo.prototype.touchcancel=function(l){this._map.fire(new xc(l.type,this._map,l))},wo.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},wo.prototype.isEnabled=function(){return!0},wo.prototype.isActive=function(){return!1},wo.prototype.enable=function(){},wo.prototype.disable=function(){};var oi=function(l){this._map=l};oi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},oi.prototype.mousemove=function(l){this._map.fire(new Co(l.type,this._map,l))},oi.prototype.mousedown=function(){this._delayContextMenu=!0},oi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Co("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},oi.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new Co(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},oi.prototype.isEnabled=function(){return!0},oi.prototype.isActive=function(){return!1},oi.prototype.enable=function(){},oi.prototype.disable=function(){};var Ks=function(l,d){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1};function rc(l,d){for(var f={},m=0;m<l.length;m++)f[l[m].identifier]=d[m];return f}Ks.prototype.isEnabled=function(){return!!this._enabled},Ks.prototype.isActive=function(){return!!this._active},Ks.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ks.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ks.prototype.mousedown=function(l,d){this.isEnabled()&&l.shiftKey&&l.button===0&&(C.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)},Ks.prototype.mousemoveWindow=function(l,d){if(this._active){var f=d;if(!(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=f,this._box||(this._box=C.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var S=Math.min(m.x,f.x),R=Math.max(m.x,f.x),L=Math.min(m.y,f.y),q=Math.max(m.y,f.y);C.setTransform(this._box,"translate("+S+"px,"+L+"px)"),this._box.style.width=R-S+"px",this._box.style.height=q-L+"px"}}},Ks.prototype.mouseupWindow=function(l,d){var f=this;if(this._active&&l.button===0){var m=this._startPos,S=d;if(this.reset(),C.suppressClick(),m.x!==S.x||m.y!==S.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(R){return R.fitScreenCoordinates(m,S,f._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},Ks.prototype.keydown=function(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))},Ks.prototype.blur=function(){this.reset()},Ks.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(C.remove(this._box),this._box=null),C.enableDrag(),delete this._startPos,delete this._lastPos},Ks.prototype._fireEvent=function(l,d){return this._map.fire(new h.Event(l,{originalEvent:d}))};var nc=function(l){this.reset(),this.numTouches=l.numTouches};nc.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},nc.prototype.touchstart=function(l,d,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),f.length===this.numTouches&&(this.centroid=function(m){for(var S=new h.Point(0,0),R=0,L=m;R<L.length;R+=1)S._add(L[R]);return S.div(m.length)}(d),this.touches=rc(f,d)))},nc.prototype.touchmove=function(l,d,f){if(!this.aborted&&this.centroid){var m=rc(f,d);for(var S in this.touches){var R=m[S];(!R||R.dist(this.touches[S])>30)&&(this.aborted=!0)}}},nc.prototype.touchend=function(l,d,f){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){var m=!this.aborted&&this.centroid;if(this.reset(),m)return m}};var Cs=function(l){this.singleTap=new nc(l),this.numTaps=l.numTaps,this.reset()};Cs.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Cs.prototype.touchstart=function(l,d,f){this.singleTap.touchstart(l,d,f)},Cs.prototype.touchmove=function(l,d,f){this.singleTap.touchmove(l,d,f)},Cs.prototype.touchend=function(l,d,f){var m=this.singleTap.touchend(l,d,f);if(m){var S=l.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(m)<30;if(S&&R||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}};var wa=function(){this._zoomIn=new Cs({numTouches:1,numTaps:2}),this._zoomOut=new Cs({numTouches:2,numTaps:1}),this.reset()};wa.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},wa.prototype.touchstart=function(l,d,f){this._zoomIn.touchstart(l,d,f),this._zoomOut.touchstart(l,d,f)},wa.prototype.touchmove=function(l,d,f){this._zoomIn.touchmove(l,d,f),this._zoomOut.touchmove(l,d,f)},wa.prototype.touchend=function(l,d,f){var m=this,S=this._zoomIn.touchend(l,d,f),R=this._zoomOut.touchend(l,d,f);return S?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(S)},{originalEvent:l})}}):R?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(R)},{originalEvent:l})}}):void 0},wa.prototype.touchcancel=function(){this.reset()},wa.prototype.enable=function(){this._enabled=!0},wa.prototype.disable=function(){this._enabled=!1,this.reset()},wa.prototype.isEnabled=function(){return this._enabled},wa.prototype.isActive=function(){return this._active};var qs={0:1,2:2},zn=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};zn.prototype.blur=function(){this.reset()},zn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},zn.prototype._correctButton=function(l,d){return!1},zn.prototype._move=function(l,d){return{}},zn.prototype.mousedown=function(l,d){if(!this._lastPoint){var f=C.mouseButton(l);this._correctButton(l,f)&&(this._lastPoint=d,this._eventButton=f)}},zn.prototype.mousemoveWindow=function(l,d){var f=this._lastPoint;if(f){if(l.preventDefault(),function(m,S){var R=qs[S];return m.buttons===void 0||(m.buttons&R)!==R}(l,this._eventButton))this.reset();else if(this._moved||!(d.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(f,d)}},zn.prototype.mouseupWindow=function(l){this._lastPoint&&C.mouseButton(l)===this._eventButton&&(this._moved&&C.suppressClick(),this.reset())},zn.prototype.enable=function(){this._enabled=!0},zn.prototype.disable=function(){this._enabled=!1,this.reset()},zn.prototype.isEnabled=function(){return this._enabled},zn.prototype.isActive=function(){return this._active};var Du=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.mousedown=function(f,m){l.prototype.mousedown.call(this,f,m),this._lastPoint&&(this._active=!0)},d.prototype._correctButton=function(f,m){return m===0&&!f.ctrlKey},d.prototype._move=function(f,m){return{around:m,panDelta:m.sub(f)}},d}(zn),il=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._correctButton=function(f,m){return m===0&&f.ctrlKey||m===2},d.prototype._move=function(f,m){var S=.8*(m.x-f.x);if(S)return this._active=!0,{bearingDelta:S}},d.prototype.contextmenu=function(f){f.preventDefault()},d}(zn),Ec=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._correctButton=function(f,m){return m===0&&f.ctrlKey||m===2},d.prototype._move=function(f,m){var S=-.5*(m.y-f.y);if(S)return this._active=!0,{pitchDelta:S}},d.prototype.contextmenu=function(f){f.preventDefault()},d}(zn),Eu=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};Eu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)},Eu.prototype.touchstart=function(l,d,f){return this._calculateTransform(l,d,f)},Eu.prototype.touchmove=function(l,d,f){if(this._active&&!(f.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,d,f)},Eu.prototype.touchend=function(l,d,f){this._calculateTransform(l,d,f),this._active&&f.length<this._minTouches&&this.reset()},Eu.prototype.touchcancel=function(){this.reset()},Eu.prototype._calculateTransform=function(l,d,f){f.length>0&&(this._active=!0);var m=rc(f,d),S=new h.Point(0,0),R=new h.Point(0,0),L=0;for(var q in m){var Se=m[q],Le=this._touches[q];Le&&(S._add(Se),R._add(Se.sub(Le)),L++,m[q]=Se)}if(this._touches=m,!(L<this._minTouches)&&R.mag()){var et=R.div(L);if(this._sum._add(et),!(this._sum.mag()<this._clickTolerance))return{around:S.div(L),panDelta:et}}},Eu.prototype.enable=function(){this._enabled=!0},Eu.prototype.disable=function(){this._enabled=!1,this.reset()},Eu.prototype.isEnabled=function(){return this._enabled},Eu.prototype.isActive=function(){return this._active};var su=function(){this.reset()};function Lc(l,d,f){for(var m=0;m<l.length;m++)if(l[m].identifier===f)return d[m]}function Rl(l,d){return Math.log(l/d)/Math.LN2}su.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},su.prototype._start=function(l){},su.prototype._move=function(l,d,f){return{}},su.prototype.touchstart=function(l,d,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([d[0],d[1]]))},su.prototype.touchmove=function(l,d,f){if(this._firstTwoTouches){l.preventDefault();var m=this._firstTwoTouches,S=m[1],R=Lc(f,d,m[0]),L=Lc(f,d,S);if(R&&L){var q=this._aroundCenter?null:R.add(L).div(2);return this._move([R,L],q,l)}}},su.prototype.touchend=function(l,d,f){if(this._firstTwoTouches){var m=this._firstTwoTouches,S=m[1],R=Lc(f,d,m[0]),L=Lc(f,d,S);R&&L||(this._active&&C.suppressClick(),this.reset())}},su.prototype.touchcancel=function(){this.reset()},su.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"},su.prototype.disable=function(){this._enabled=!1,this.reset()},su.prototype.isEnabled=function(){return this._enabled},su.prototype.isActive=function(){return this._active};var vs=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},d.prototype._start=function(f){this._startDistance=this._distance=f[0].dist(f[1])},d.prototype._move=function(f,m){var S=this._distance;if(this._distance=f[0].dist(f[1]),this._active||!(Math.abs(Rl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Rl(this._distance,S),pinchAround:m}},d}(su);function uu(l,d){return 180*l.angleWith(d)/Math.PI}var Sf=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},d.prototype._start=function(f){this._startVector=this._vector=f[0].sub(f[1]),this._minDiameter=f[0].dist(f[1])},d.prototype._move=function(f,m){var S=this._vector;if(this._vector=f[0].sub(f[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:uu(this._vector,S),pinchAround:m}},d.prototype._isBelowThreshold=function(f){this._minDiameter=Math.min(this._minDiameter,f.mag());var m=25/(Math.PI*this._minDiameter)*360,S=uu(f,this._startVector);return Math.abs(S)<m},d}(su);function Bc(l){return Math.abs(l.y)>Math.abs(l.x)}var Sc=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},d.prototype._start=function(f){this._lastPoints=f,Bc(f[0].sub(f[1]))&&(this._valid=!1)},d.prototype._move=function(f,m,S){var R=f[0].sub(this._lastPoints[0]),L=f[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(R,L,S.timeStamp),this._valid)return this._lastPoints=f,this._active=!0,{pitchDelta:(R.y+L.y)/2*-.5}},d.prototype.gestureBeginsVertically=function(f,m,S){if(this._valid!==void 0)return this._valid;var R=f.mag()>=2,L=m.mag()>=2;if(R||L){if(!R||!L)return this._firstMove===void 0&&(this._firstMove=S),S-this._firstMove<100&&void 0;var q=f.y>0==m.y>0;return Bc(f)&&Bc(m)&&q}},d}(su),Tf={panStep:100,bearingStep:15,pitchStep:10},Su=function(){var l=Tf;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function $o(l){return l*(2-l)}Su.prototype.blur=function(){this.reset()},Su.prototype.reset=function(){this._active=!1},Su.prototype.keydown=function(l){var d=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var f=0,m=0,S=0,R=0,L=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?m=-1:(l.preventDefault(),R=-1);break;case 39:l.shiftKey?m=1:(l.preventDefault(),R=1);break;case 38:l.shiftKey?S=1:(l.preventDefault(),L=-1);break;case 40:l.shiftKey?S=-1:(l.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(m=0,S=0),{cameraAnimation:function(q){var Se=q.getZoom();q.easeTo({duration:300,easeId:"keyboardHandler",easing:$o,zoom:f?Math.round(Se)+f*(l.shiftKey?2:1):Se,bearing:q.getBearing()+m*d._bearingStep,pitch:q.getPitch()+S*d._pitchStep,offset:[-R*d._panStep,-L*d._panStep],center:q.getCenter()},{originalEvent:l})}}}},Su.prototype.enable=function(){this._enabled=!0},Su.prototype.disable=function(){this._enabled=!1,this.reset()},Su.prototype.isEnabled=function(){return this._enabled},Su.prototype.isActive=function(){return this._active},Su.prototype.disableRotation=function(){this._rotationDisabled=!0},Su.prototype.enableRotation=function(){this._rotationDisabled=!1};var ea=function(l,d){this._map=l,this._el=l.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,h.bindAll(["_onTimeout"],this)};ea.prototype.setZoomRate=function(l){this._defaultZoomRate=l},ea.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},ea.prototype.isEnabled=function(){return!!this._enabled},ea.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ea.prototype.isZooming=function(){return!!this._zooming},ea.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")},ea.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ea.prototype.wheel=function(l){if(this.isEnabled()){var d=l.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,f=h.browser.now(),m=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,d!==0&&d%4.000244140625==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(m*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}},ea.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},ea.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var d=C.mousePos(this._el,l);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(d)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ea.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var d=this._map.transform;if(this._delta!==0){var f=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,m=2/(1+Math.exp(-Math.abs(this._delta*f)));this._delta<0&&m!==0&&(m=1/m);var S=typeof this._targetZoom=="number"?d.zoomScale(this._targetZoom):d.scale;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(S*m))),this._type==="wheel"&&(this._startZoom=d.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var R,L=typeof this._targetZoom=="number"?this._targetZoom:d.zoom,q=this._startZoom,Se=this._easing,Le=!1;if(this._type==="wheel"&&q&&Se){var et=Math.min((h.browser.now()-this._lastWheelEventTime)/200,1),ot=Se(et);R=h.number(q,L,ot),et<1?this._frameId||(this._frameId=!0):Le=!0}else R=L,Le=!0;return this._active=!0,Le&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Le,zoomDelta:R-d.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ea.prototype._smoothOutEasing=function(l){var d=h.ease;if(this._prevEase){var f=this._prevEase,m=(h.browser.now()-f.start)/f.duration,S=f.easing(m+.01)-f.easing(m),R=.27/Math.sqrt(S*S+1e-4)*.01,L=Math.sqrt(.0729-R*R);d=h.bezier(R,L,.25,1)}return this._prevEase={start:h.browser.now(),duration:l,easing:d},d},ea.prototype.blur=function(){this.reset()},ea.prototype.reset=function(){this._active=!1};var Qs=function(l,d){this._clickZoom=l,this._tapZoom=d};Qs.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Qs.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Qs.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Qs.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Tu=function(){this.reset()};Tu.prototype.reset=function(){this._active=!1},Tu.prototype.blur=function(){this.reset()},Tu.prototype.dblclick=function(l,d){return l.preventDefault(),{cameraAnimation:function(f){f.easeTo({duration:300,zoom:f.getZoom()+(l.shiftKey?-1:1),around:f.unproject(d)},{originalEvent:l})}}},Tu.prototype.enable=function(){this._enabled=!0},Tu.prototype.disable=function(){this._enabled=!1,this.reset()},Tu.prototype.isEnabled=function(){return this._enabled},Tu.prototype.isActive=function(){return this._active};var Ga=function(){this._tap=new Cs({numTouches:1,numTaps:1}),this.reset()};Ga.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ga.prototype.touchstart=function(l,d,f){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=d[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(l,d,f))},Ga.prototype.touchmove=function(l,d,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;var m=d[0],S=m.y-this._swipePoint.y;return this._swipePoint=m,l.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(l,d,f)},Ga.prototype.touchend=function(l,d,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(l,d,f)&&(this._tapTime=l.timeStamp)},Ga.prototype.touchcancel=function(){this.reset()},Ga.prototype.enable=function(){this._enabled=!0},Ga.prototype.disable=function(){this._enabled=!1,this.reset()},Ga.prototype.isEnabled=function(){return this._enabled},Ga.prototype.isActive=function(){return this._active};var Ml=function(l,d,f){this._el=l,this._mousePan=d,this._touchPan=f};Ml.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Ml.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Ml.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ml.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var al=function(l,d,f){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=f};al.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},al.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},al.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},al.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var lu=function(l,d,f,m){this._el=l,this._touchZoom=d,this._touchRotate=f,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0};lu.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},lu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},lu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},lu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},lu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},lu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var es=function(l){return l.zoom||l.drag||l.pitch||l.rotate},ic=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(h.Event);function Ci(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var rn=function(l,d){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ec(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d),h.bindAll(["handleEvent","handleWindowEvent"],this);var f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[h.window,"blur",void 0]];for(var m=0,S=this._listeners;m<S.length;m+=1){var R=S[m],L=R[0];C.addEventListener(L,R[1],L===h.window.document?this.handleWindowEvent:this.handleEvent,R[2])}};rn.prototype.destroy=function(){for(var l=0,d=this._listeners;l<d.length;l+=1){var f=d[l],m=f[0];C.removeEventListener(m,f[1],m===h.window.document?this.handleWindowEvent:this.handleEvent,f[2])}},rn.prototype._addDefaultHandlers=function(l){var d=this._map,f=d.getCanvasContainer();this._add("mapEvent",new wo(d,l));var m=d.boxZoom=new Ks(d,l);this._add("boxZoom",m);var S=new wa,R=new Tu;d.doubleClickZoom=new Qs(R,S),this._add("tapZoom",S),this._add("clickZoom",R);var L=new Ga;this._add("tapDragZoom",L);var q=d.touchPitch=new Sc;this._add("touchPitch",q);var Se=new il(l),Le=new Ec(l);d.dragRotate=new al(l,Se,Le),this._add("mouseRotate",Se,["mousePitch"]),this._add("mousePitch",Le,["mouseRotate"]);var et=new Du(l),ot=new Eu(l);d.dragPan=new Ml(f,et,ot),this._add("mousePan",et),this._add("touchPan",ot,["touchZoom","touchRotate"]);var st=new Sf,Rt=new vs;d.touchZoomRotate=new lu(f,Rt,st,L),this._add("touchRotate",st,["touchPan","touchZoom"]),this._add("touchZoom",Rt,["touchPan","touchRotate"]);var Ct=d.scrollZoom=new ea(d,this);this._add("scrollZoom",Ct,["mousePan"]);var Xt=d.keyboard=new Su;this._add("keyboard",Xt),this._add("blockableMapEvent",new oi(d));for(var St=0,$t=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];St<$t.length;St+=1){var tr=$t[St];l.interactive&&l[tr]&&d[tr].enable(l[tr])}},rn.prototype._add=function(l,d,f){this._handlers.push({handlerName:l,handler:d,allowed:f}),this._handlersById[l]=d},rn.prototype.stop=function(l){if(!this._updatingCamera){for(var d=0,f=this._handlers;d<f.length;d+=1)f[d].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},rn.prototype.isActive=function(){for(var l=0,d=this._handlers;l<d.length;l+=1)if(d[l].handler.isActive())return!0;return!1},rn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},rn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},rn.prototype.isMoving=function(){return!!es(this._eventsInProgress)||this.isZooming()},rn.prototype._blockedByActive=function(l,d,f){for(var m in l)if(m!==f&&(!d||d.indexOf(m)<0))return!0;return!1},rn.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},rn.prototype._getMapTouches=function(l){for(var d=[],f=0,m=l;f<m.length;f+=1){var S=m[f];this._el.contains(S.target)&&d.push(S)}return d},rn.prototype.handleEvent=function(l,d){this._updatingCamera=!0;for(var f=l.type==="renderFrame"?void 0:l,m={needsRenderFrame:!1},S={},R={},L=l.touches?this._getMapTouches(l.touches):void 0,q=L?C.touchPos(this._el,L):C.mousePos(this._el,l),Se=0,Le=this._handlers;Se<Le.length;Se+=1){var et=Le[Se],ot=et.handlerName,st=et.handler,Rt=et.allowed;if(st.isEnabled()){var Ct=void 0;this._blockedByActive(R,Rt,ot)?st.reset():st[d||l.type]&&(Ct=st[d||l.type](l,q,L),this.mergeHandlerResult(m,S,Ct,ot,f),Ct&&Ct.needsRenderFrame&&this._triggerRenderFrame()),(Ct||st.isActive())&&(R[ot]=st)}}var Xt={};for(var St in this._previousActiveHandlers)R[St]||(Xt[St]=f);this._previousActiveHandlers=R,(Object.keys(Xt).length||Ci(m))&&(this._changes.push([m,S,Xt]),this._triggerRenderFrame()),(Object.keys(R).length||Ci(m))&&this._map._stop(!0),this._updatingCamera=!1;var $t=m.cameraAnimation;$t&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$t(this._map))},rn.prototype.mergeHandlerResult=function(l,d,f,m,S){if(f){h.extend(l,f);var R={handlerName:m,originalEvent:f.originalEvent||S};f.zoomDelta!==void 0&&(d.zoom=R),f.panDelta!==void 0&&(d.drag=R),f.pitchDelta!==void 0&&(d.pitch=R),f.bearingDelta!==void 0&&(d.rotate=R)}},rn.prototype._applyChanges=function(){for(var l={},d={},f={},m=0,S=this._changes;m<S.length;m+=1){var R=S[m],L=R[0],q=R[1],Se=R[2];L.panDelta&&(l.panDelta=(l.panDelta||new h.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+L.pitchDelta),L.around!==void 0&&(l.around=L.around),L.pinchAround!==void 0&&(l.pinchAround=L.pinchAround),L.noInertia&&(l.noInertia=L.noInertia),h.extend(d,q),h.extend(f,Se)}this._updateMapTransform(l,d,f),this._changes=[]},rn.prototype._updateMapTransform=function(l,d,f){var m=this._map,S=m.transform;if(!Ci(l))return this._fireEvents(d,f,!0);var R=l.panDelta,L=l.zoomDelta,q=l.bearingDelta,Se=l.pitchDelta,Le=l.around,et=l.pinchAround;et!==void 0&&(Le=et),m._stop(!0),Le=Le||m.transform.centerPoint;var ot=S.pointLocation(R?Le.sub(R):Le);q&&(S.bearing+=q),Se&&(S.pitch+=Se),L&&(S.zoom+=L),S.setLocationAtPoint(ot,Le),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,f,!0)},rn.prototype._fireEvents=function(l,d,f){var m=this,S=es(this._eventsInProgress),R=es(l),L={};for(var q in l)this._eventsInProgress[q]||(L[q+"start"]=l[q].originalEvent),this._eventsInProgress[q]=l[q];for(var Se in!S&&R&&this._fireEvent("movestart",R.originalEvent),L)this._fireEvent(Se,L[Se]);for(var Le in R&&this._fireEvent("move",R.originalEvent),l)this._fireEvent(Le,l[Le].originalEvent);var et,ot={};for(var st in this._eventsInProgress){var Rt=this._eventsInProgress[st],Ct=Rt.handlerName,Xt=Rt.originalEvent;this._handlersById[Ct].isActive()||(delete this._eventsInProgress[st],ot[st+"end"]=et=d[Ct]||Xt)}for(var St in ot)this._fireEvent(St,ot[St]);var $t=es(this._eventsInProgress);if(f&&(S||R)&&!$t){this._updatingCamera=!0;var tr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),br=function(kr){return kr!==0&&-m._bearingSnap<kr&&kr<m._bearingSnap};tr?(br(tr.bearing||this._map.getBearing())&&(tr.bearing=0),this._map.easeTo(tr,{originalEvent:et})):(this._map.fire(new h.Event("moveend",{originalEvent:et})),br(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},rn.prototype._fireEvent=function(l,d){this._map.fire(new h.Event(l,d?{originalEvent:d}:{}))},rn.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(d){delete l._frameId,l.handleEvent(new ic("renderFrame",{timeStamp:d})),l._applyChanges()})},rn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var cu=function(l){function d(f,m){l.call(this),this._moving=!1,this._zooming=!1,this.transform=f,this._bearingSnap=m.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getCenter=function(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)},d.prototype.setCenter=function(f,m){return this.jumpTo({center:f},m)},d.prototype.panBy=function(f,m,S){return f=h.Point.convert(f).mult(-1),this.panTo(this.transform.center,h.extend({offset:f},m),S)},d.prototype.panTo=function(f,m,S){return this.easeTo(h.extend({center:f},m),S)},d.prototype.getZoom=function(){return this.transform.zoom},d.prototype.setZoom=function(f,m){return this.jumpTo({zoom:f},m),this},d.prototype.zoomTo=function(f,m,S){return this.easeTo(h.extend({zoom:f},m),S)},d.prototype.zoomIn=function(f,m){return this.zoomTo(this.getZoom()+1,f,m),this},d.prototype.zoomOut=function(f,m){return this.zoomTo(this.getZoom()-1,f,m),this},d.prototype.getBearing=function(){return this.transform.bearing},d.prototype.setBearing=function(f,m){return this.jumpTo({bearing:f},m),this},d.prototype.getPadding=function(){return this.transform.padding},d.prototype.setPadding=function(f,m){return this.jumpTo({padding:f},m),this},d.prototype.rotateTo=function(f,m,S){return this.easeTo(h.extend({bearing:f},m),S)},d.prototype.resetNorth=function(f,m){return this.rotateTo(0,h.extend({duration:1e3},f),m),this},d.prototype.resetNorthPitch=function(f,m){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},f),m),this},d.prototype.snapToNorth=function(f,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(f,m):this},d.prototype.getPitch=function(){return this.transform.pitch},d.prototype.setPitch=function(f,m){return this.jumpTo({pitch:f},m),this},d.prototype.cameraForBounds=function(f,m){f=h.LngLatBounds.convert(f);var S=m&&m.bearing||0;return this._cameraForBoxAndBearing(f.getNorthWest(),f.getSouthEast(),S,m)},d.prototype._cameraForBoxAndBearing=function(f,m,S,R){var L={top:0,bottom:0,right:0,left:0};if(typeof(R=h.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},R)).padding=="number"){var q=R.padding;R.padding={top:q,bottom:q,right:q,left:q}}R.padding=h.extend(L,R.padding);var Se=this.transform,Le=Se.padding,et=Se.project(h.LngLat.convert(f)),ot=Se.project(h.LngLat.convert(m)),st=et.rotate(-S*Math.PI/180),Rt=ot.rotate(-S*Math.PI/180),Ct=new h.Point(Math.max(st.x,Rt.x),Math.max(st.y,Rt.y)),Xt=new h.Point(Math.min(st.x,Rt.x),Math.min(st.y,Rt.y)),St=Ct.sub(Xt),$t=(Se.width-(Le.left+Le.right+R.padding.left+R.padding.right))/St.x,tr=(Se.height-(Le.top+Le.bottom+R.padding.top+R.padding.bottom))/St.y;if(!(tr<0||$t<0)){var br=Math.min(Se.scaleZoom(Se.scale*Math.min($t,tr)),R.maxZoom),kr=typeof R.offset.x=="number"?new h.Point(R.offset.x,R.offset.y):h.Point.convert(R.offset),Or=new h.Point((R.padding.left-R.padding.right)/2,(R.padding.top-R.padding.bottom)/2).rotate(S*Math.PI/180),Hr=kr.add(Or).mult(Se.scale/Se.zoomScale(br));return{center:Se.unproject(et.add(ot).div(2).sub(Hr)),zoom:br,bearing:S}}h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},d.prototype.fitBounds=function(f,m,S){return this._fitInternal(this.cameraForBounds(f,m),m,S)},d.prototype.fitScreenCoordinates=function(f,m,S,R,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(f)),this.transform.pointLocation(h.Point.convert(m)),S,R),R,L)},d.prototype._fitInternal=function(f,m,S){return f?(delete(m=h.extend(f,m)).padding,m.linear?this.easeTo(m,S):this.flyTo(m,S)):this},d.prototype.jumpTo=function(f,m){this.stop();var S=this.transform,R=!1,L=!1,q=!1;return"zoom"in f&&S.zoom!==+f.zoom&&(R=!0,S.zoom=+f.zoom),f.center!==void 0&&(S.center=h.LngLat.convert(f.center)),"bearing"in f&&S.bearing!==+f.bearing&&(L=!0,S.bearing=+f.bearing),"pitch"in f&&S.pitch!==+f.pitch&&(q=!0,S.pitch=+f.pitch),f.padding==null||S.isPaddingEqual(f.padding)||(S.padding=f.padding),this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),R&&this.fire(new h.Event("zoomstart",m)).fire(new h.Event("zoom",m)).fire(new h.Event("zoomend",m)),L&&this.fire(new h.Event("rotatestart",m)).fire(new h.Event("rotate",m)).fire(new h.Event("rotateend",m)),q&&this.fire(new h.Event("pitchstart",m)).fire(new h.Event("pitch",m)).fire(new h.Event("pitchend",m)),this.fire(new h.Event("moveend",m))},d.prototype.easeTo=function(f,m){var S=this;this._stop(!1,f.easeId),((f=h.extend({offset:[0,0],duration:500,easing:h.ease},f)).animate===!1||!f.essential&&h.browser.prefersReducedMotion)&&(f.duration=0);var R=this.transform,L=this.getZoom(),q=this.getBearing(),Se=this.getPitch(),Le=this.getPadding(),et="zoom"in f?+f.zoom:L,ot="bearing"in f?this._normalizeBearing(f.bearing,q):q,st="pitch"in f?+f.pitch:Se,Rt="padding"in f?f.padding:R.padding,Ct=h.Point.convert(f.offset),Xt=R.centerPoint.add(Ct),St=R.pointLocation(Xt),$t=h.LngLat.convert(f.center||St);this._normalizeCenter($t);var tr,br,kr=R.project(St),Or=R.project($t).sub(kr),Hr=R.zoomScale(et-L);f.around&&(tr=h.LngLat.convert(f.around),br=R.locationPoint(tr));var nn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||et!==L,this._rotating=this._rotating||q!==ot,this._pitching=this._pitching||st!==Se,this._padding=!R.isPaddingEqual(Rt),this._easeId=f.easeId,this._prepareEase(m,f.noMoveStart,nn),this._ease(function(M){if(S._zooming&&(R.zoom=h.number(L,et,M)),S._rotating&&(R.bearing=h.number(q,ot,M)),S._pitching&&(R.pitch=h.number(Se,st,M)),S._padding&&(R.interpolatePadding(Le,Rt,M),Xt=R.centerPoint.add(Ct)),tr)R.setLocationAtPoint(tr,br);else{var z=R.zoomScale(R.zoom-L),j=et>L?Math.min(2,Hr):Math.max(.5,Hr),ne=Math.pow(j,1-M),ce=R.unproject(kr.add(Or.mult(M*ne)).mult(z));R.setLocationAtPoint(R.renderWorldCopies?ce.wrap():ce,Xt)}S._fireMoveEvents(m)},function(M){S._afterEase(m,M)},f),this},d.prototype._prepareEase=function(f,m,S){S===void 0&&(S={}),this._moving=!0,m||S.moving||this.fire(new h.Event("movestart",f)),this._zooming&&!S.zooming&&this.fire(new h.Event("zoomstart",f)),this._rotating&&!S.rotating&&this.fire(new h.Event("rotatestart",f)),this._pitching&&!S.pitching&&this.fire(new h.Event("pitchstart",f))},d.prototype._fireMoveEvents=function(f){this.fire(new h.Event("move",f)),this._zooming&&this.fire(new h.Event("zoom",f)),this._rotating&&this.fire(new h.Event("rotate",f)),this._pitching&&this.fire(new h.Event("pitch",f))},d.prototype._afterEase=function(f,m){if(!this._easeId||!m||this._easeId!==m){delete this._easeId;var S=this._zooming,R=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new h.Event("zoomend",f)),R&&this.fire(new h.Event("rotateend",f)),L&&this.fire(new h.Event("pitchend",f)),this.fire(new h.Event("moveend",f))}},d.prototype.flyTo=function(f,m){var S=this;if(!f.essential&&h.browser.prefersReducedMotion){var R=h.pick(f,["center","zoom","bearing","pitch","around"]);return this.jumpTo(R,m)}this.stop(),f=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},f);var L=this.transform,q=this.getZoom(),Se=this.getBearing(),Le=this.getPitch(),et=this.getPadding(),ot="zoom"in f?h.clamp(+f.zoom,L.minZoom,L.maxZoom):q,st="bearing"in f?this._normalizeBearing(f.bearing,Se):Se,Rt="pitch"in f?+f.pitch:Le,Ct="padding"in f?f.padding:L.padding,Xt=L.zoomScale(ot-q),St=h.Point.convert(f.offset),$t=L.centerPoint.add(St),tr=L.pointLocation($t),br=h.LngLat.convert(f.center||tr);this._normalizeCenter(br);var kr=L.project(tr),Or=L.project(br).sub(kr),Hr=f.curve,nn=Math.max(L.width,L.height),M=nn/Xt,z=Or.mag();if("minZoom"in f){var j=h.clamp(Math.min(f.minZoom,q,ot),L.minZoom,L.maxZoom),ne=nn/L.zoomScale(j-q);Hr=Math.sqrt(ne/z*2)}var ce=Hr*Hr;function le(vn){var Jr=(M*M-nn*nn+(vn?-1:1)*ce*ce*z*z)/(2*(vn?M:nn)*ce*z);return Math.log(Math.sqrt(Jr*Jr+1)-Jr)}function lt(vn){return(Math.exp(vn)-Math.exp(-vn))/2}function it(vn){return(Math.exp(vn)+Math.exp(-vn))/2}var Yt=le(0),ht=function(vn){return it(Yt)/it(Yt+Hr*vn)},er=function(vn){return nn*((it(Yt)*(lt(Jr=Yt+Hr*vn)/it(Jr))-lt(Yt))/ce)/z;var Jr},yr=(le(1)-Yt)/Hr;if(Math.abs(z)<1e-6||!isFinite(yr)){if(Math.abs(nn-M)<1e-6)return this.easeTo(f,m);var _n=M<nn?-1:1;yr=Math.abs(Math.log(M/nn))/Hr,er=function(){return 0},ht=function(vn){return Math.exp(_n*Hr*vn)}}return f.duration="duration"in f?+f.duration:1e3*yr/("screenSpeed"in f?+f.screenSpeed/Hr:+f.speed),f.maxDuration&&f.duration>f.maxDuration&&(f.duration=0),this._zooming=!0,this._rotating=Se!==st,this._pitching=Rt!==Le,this._padding=!L.isPaddingEqual(Ct),this._prepareEase(m,!1),this._ease(function(vn){var Jr=vn*yr,Gn=1/ht(Jr);L.zoom=vn===1?ot:q+L.scaleZoom(Gn),S._rotating&&(L.bearing=h.number(Se,st,vn)),S._pitching&&(L.pitch=h.number(Le,Rt,vn)),S._padding&&(L.interpolatePadding(et,Ct,vn),$t=L.centerPoint.add(St));var Xn=vn===1?br:L.unproject(kr.add(Or.mult(er(Jr))).mult(Gn));L.setLocationAtPoint(L.renderWorldCopies?Xn.wrap():Xn,$t),S._fireMoveEvents(m)},function(){return S._afterEase(m)},f),this},d.prototype.isEasing=function(){return!!this._easeFrameId},d.prototype.stop=function(){return this._stop()},d.prototype._stop=function(f,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var S=this._onEaseEnd;delete this._onEaseEnd,S.call(this,m)}if(!f){var R=this.handlers;R&&R.stop(!1)}return this},d.prototype._ease=function(f,m,S){S.animate===!1||S.duration===0?(f(1),m()):(this._easeStart=h.browser.now(),this._easeOptions=S,this._onEaseFrame=f,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},d.prototype._renderFrameCallback=function(){var f=Math.min((h.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},d.prototype._normalizeBearing=function(f,m){f=h.wrap(f,-180,180);var S=Math.abs(f-m);return Math.abs(f-360-m)<S&&(f-=360),Math.abs(f+360-m)<S&&(f+=360),f},d.prototype._normalizeCenter=function(f){var m=this.transform;if(m.renderWorldCopies&&!m.lngRange){var S=f.lng-m.center.lng;f.lng+=S>180?-360:S<-180?360:0}},d}(h.Evented),ws=function(l){l===void 0&&(l={}),this.options=l,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ws.prototype.getDefaultPosition=function(){return"bottom-right"},ws.prototype.onAdd=function(l){var d=this.options&&this.options.compact;return this._map=l,this._container=C.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=C.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=C.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ws.prototype.onRemove=function(){C.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ws.prototype._setElementTitle=function(l,d){var f=this._map._getUIString("AttributionControl."+d);l.title=f,l.setAttribute("aria-label",f)},ws.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ws.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(l){var f=d.reduce(function(m,S,R){return S.value&&(m+=S.key+"="+S.value+(R<d.length-1?"&":"")),m},"?");l.href=h.config.FEEDBACK_URL+"/"+f+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},ws.prototype._updateData=function(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ws.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(q){return typeof q!="string"?"":q})):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}var f=this._map.style.sourceCaches;for(var m in f){var S=f[m];if(S.used){var R=S.getSource();R.attribution&&l.indexOf(R.attribution)<0&&l.push(R.attribution)}}l.sort(function(q,Se){return q.length-Se.length});var L=(l=l.filter(function(q,Se){for(var Le=Se+1;Le<l.length;Le++)if(l[Le].indexOf(q)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,l.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ws.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var fu=function(){h.bindAll(["_updateLogo"],this),h.bindAll(["_updateCompact"],this)};fu.prototype.onAdd=function(l){this._map=l,this._container=C.create("div","mapboxgl-ctrl");var d=C.create("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},fu.prototype.onRemove=function(){C.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},fu.prototype.getDefaultPosition=function(){return"bottom-left"},fu.prototype._updateLogo=function(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},fu.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var d in l)if(l[d].getSource().mapbox_logo)return!0;return!1}},fu.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var d=l[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}};var Ro=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ro.prototype.add=function(l){var d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d},Ro.prototype.remove=function(l){for(var d=this._currentlyRunning,f=0,m=d?this._queue.concat(d):this._queue;f<m.length;f+=1){var S=m[f];if(S.id===l)return void(S.cancelled=!0)}},Ro.prototype.run=function(l){l===void 0&&(l=0);var d=this._currentlyRunning=this._queue;this._queue=[];for(var f=0,m=d;f<m.length;f+=1){var S=m[f];if(!S.cancelled&&(S.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ro.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Fs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ku=h.window.HTMLImageElement,Il=h.window.HTMLElement,Na=h.window.ImageBitmap,No={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ao=function(l){function d(m){var S=this;if((m=h.extend({},No,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var R=new Ia(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies);if(l.call(this,R,m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Ro,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},Fs,m.locale),this._clickTolerance=m.clickTolerance,this._requestManager=new h.RequestManager(m.transformRequest,m.accessToken),typeof m.container=="string"){if(this._container=h.window.document.getElementById(m.container),!this._container)throw new Error("Container '"+m.container+"' not found.")}else{if(!(m.container instanceof Il))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return S._update(!1)}),this.on("moveend",function(){return S._update(!1)}),this.on("zoom",function(){return S._update(!0)}),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new rn(this,m),this._hash=m.hash&&new Ou(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,h.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new ws({customAttribution:m.customAttribution})),this.addControl(new fu,m.logoPosition),this.on("style.load",function(){S.transform.unmodified&&S.jumpTo(S.style.stylesheet)}),this.on("data",function(L){S._update(L.dataType==="style"),S.fire(new h.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){S.fire(new h.Event(L.dataType+"dataloading",L))})}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var f={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return d.prototype._getMapId=function(){return this._mapId},d.prototype.addControl=function(m,S){if(S===void 0&&(S=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var R=m.onAdd(this);this._controls.push(m);var L=this._controlPositions[S];return S.indexOf("bottom")!==-1?L.insertBefore(R,L.firstChild):L.appendChild(R),this},d.prototype.removeControl=function(m){if(!m||!m.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var S=this._controls.indexOf(m);return S>-1&&this._controls.splice(S,1),m.onRemove(this),this},d.prototype.hasControl=function(m){return this._controls.indexOf(m)>-1},d.prototype.resize=function(m){var S=this._containerDimensions(),R=S[0],L=S[1];if(R===this.transform.width&&L===this.transform.height)return this;this._resizeCanvas(R,L),this.transform.resize(R,L),this.painter.resize(R,L);var q=!this._moving;return q&&this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),this.fire(new h.Event("resize",m)),q&&this.fire(new h.Event("moveend",m)),this},d.prototype.getBounds=function(){return this.transform.getBounds()},d.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},d.prototype.setMaxBounds=function(m){return this.transform.setMaxBounds(h.LngLatBounds.convert(m)),this._update()},d.prototype.setMinZoom=function(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},d.prototype.getMinZoom=function(){return this.transform.minZoom},d.prototype.setMaxZoom=function(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")},d.prototype.getMaxZoom=function(){return this.transform.maxZoom},d.prototype.setMinPitch=function(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},d.prototype.getMinPitch=function(){return this.transform.minPitch},d.prototype.setMaxPitch=function(m){if((m=m==null?60:m)>60)throw new Error("maxPitch must be less than or equal to 60");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")},d.prototype.getMaxPitch=function(){return this.transform.maxPitch},d.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},d.prototype.setRenderWorldCopies=function(m){return this.transform.renderWorldCopies=m,this._update()},d.prototype.project=function(m){return this.transform.locationPoint(h.LngLat.convert(m))},d.prototype.unproject=function(m){return this.transform.pointLocation(h.Point.convert(m))},d.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},d.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},d.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},d.prototype._createDelegatedListener=function(m,S,R){var L,q=this;if(m==="mouseenter"||m==="mouseover"){var Se=!1;return{layer:S,listener:R,delegates:{mousemove:function(et){var ot=q.getLayer(S)?q.queryRenderedFeatures(et.point,{layers:[S]}):[];ot.length?Se||(Se=!0,R.call(q,new Co(m,q,et.originalEvent,{features:ot}))):Se=!1},mouseout:function(){Se=!1}}}}if(m==="mouseleave"||m==="mouseout"){var Le=!1;return{layer:S,listener:R,delegates:{mousemove:function(et){(q.getLayer(S)?q.queryRenderedFeatures(et.point,{layers:[S]}):[]).length?Le=!0:Le&&(Le=!1,R.call(q,new Co(m,q,et.originalEvent)))},mouseout:function(et){Le&&(Le=!1,R.call(q,new Co(m,q,et.originalEvent)))}}}}return{layer:S,listener:R,delegates:(L={},L[m]=function(et){var ot=q.getLayer(S)?q.queryRenderedFeatures(et.point,{layers:[S]}):[];ot.length&&(et.features=ot,R.call(q,et),delete et.features)},L)}},d.prototype.on=function(m,S,R){if(R===void 0)return l.prototype.on.call(this,m,S);var L=this._createDelegatedListener(m,S,R);for(var q in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(L),L.delegates)this.on(q,L.delegates[q]);return this},d.prototype.once=function(m,S,R){if(R===void 0)return l.prototype.once.call(this,m,S);var L=this._createDelegatedListener(m,S,R);for(var q in L.delegates)this.once(q,L.delegates[q]);return this},d.prototype.off=function(m,S,R){var L=this;return R===void 0?l.prototype.off.call(this,m,S):(this._delegatedListeners&&this._delegatedListeners[m]&&function(q){for(var Se=q[m],Le=0;Le<Se.length;Le++){var et=Se[Le];if(et.layer===S&&et.listener===R){for(var ot in et.delegates)L.off(ot,et.delegates[ot]);return Se.splice(Le,1),L}}}(this._delegatedListeners),this)},d.prototype.queryRenderedFeatures=function(m,S){if(!this.style)return[];var R;if(S!==void 0||m===void 0||m instanceof h.Point||Array.isArray(m)||(S=m,m=void 0),S=S||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof h.Point||typeof m[0]=="number")R=[h.Point.convert(m)];else{var L=h.Point.convert(m[0]),q=h.Point.convert(m[1]);R=[L,new h.Point(q.x,L.y),q,new h.Point(L.x,q.y),L]}return this.style.queryRenderedFeatures(R,S,this.transform)},d.prototype.querySourceFeatures=function(m,S){return this.style.querySourceFeatures(m,S)},d.prototype.setStyle=function(m,S){return(S=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},S)).diff!==!1&&S.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,S),this):(this._localIdeographFontFamily=S.localIdeographFontFamily,this._updateStyle(m,S))},d.prototype._getUIString=function(m){var S=this._locale[m];if(S==null)throw new Error("Missing UI string '"+m+"'");return S},d.prototype._updateStyle=function(m,S){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new gn(this,S||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)},d.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new gn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},d.prototype._diffStyle=function(m,S){var R=this;if(typeof m=="string"){var L=this._requestManager.normalizeStyleURL(m),q=this._requestManager.transformRequest(L,h.ResourceType.Style);h.getJSON(q,function(Se,Le){Se?R.fire(new h.ErrorEvent(Se)):Le&&R._updateDiff(Le,S)})}else typeof m=="object"&&this._updateDiff(m,S)},d.prototype._updateDiff=function(m,S){try{this.style.setState(m)&&this._update(!0)}catch(R){h.warnOnce("Unable to perform style diff: "+(R.message||R.error||R)+".  Rebuilding the style from scratch."),this._updateStyle(m,S)}},d.prototype.getStyle=function(){if(this.style)return this.style.serialize()},d.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")},d.prototype.addSource=function(m,S){return this._lazyInitEmptyStyle(),this.style.addSource(m,S),this._update(!0)},d.prototype.isSourceLoaded=function(m){var S=this.style&&this.style.sourceCaches[m];if(S!==void 0)return S.loaded();this.fire(new h.ErrorEvent(new Error("There is no source with ID '"+m+"'")))},d.prototype.areTilesLoaded=function(){var m=this.style&&this.style.sourceCaches;for(var S in m){var R=m[S]._tiles;for(var L in R){var q=R[L];if(q.state!=="loaded"&&q.state!=="errored")return!1}}return!0},d.prototype.addSourceType=function(m,S,R){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,S,R)},d.prototype.removeSource=function(m){return this.style.removeSource(m),this._update(!0)},d.prototype.getSource=function(m){return this.style.getSource(m)},d.prototype.addImage=function(m,S,R){R===void 0&&(R={});var L=R.pixelRatio;L===void 0&&(L=1);var q=R.sdf;q===void 0&&(q=!1);var Se=R.stretchX,Le=R.stretchY,et=R.content;if(this._lazyInitEmptyStyle(),S instanceof ku||Na&&S instanceof Na){var ot=h.browser.getImageData(S);this.style.addImage(m,{data:new h.RGBAImage({width:ot.width,height:ot.height},ot.data),pixelRatio:L,stretchX:Se,stretchY:Le,content:et,sdf:q,version:0})}else{if(S.width===void 0||S.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var st=S;this.style.addImage(m,{data:new h.RGBAImage({width:S.width,height:S.height},new Uint8Array(S.data)),pixelRatio:L,stretchX:Se,stretchY:Le,content:et,sdf:q,version:0,userImage:st}),st.onAdd&&st.onAdd(this,m)}},d.prototype.updateImage=function(m,S){var R=this.style.getImage(m);if(!R)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=S instanceof ku||Na&&S instanceof Na?h.browser.getImageData(S):S,q=L.width,Se=L.height,Le=L.data;return q===void 0||Se===void 0?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):q!==R.data.width||Se!==R.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(R.data.replace(Le,!(S instanceof ku||Na&&S instanceof Na)),void this.style.updateImage(m,R))},d.prototype.hasImage=function(m){return m?!!this.style.getImage(m):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)},d.prototype.removeImage=function(m){this.style.removeImage(m)},d.prototype.loadImage=function(m,S){h.getImage(this._requestManager.transformRequest(m,h.ResourceType.Image),S)},d.prototype.listImages=function(){return this.style.listImages()},d.prototype.addLayer=function(m,S){return this._lazyInitEmptyStyle(),this.style.addLayer(m,S),this._update(!0)},d.prototype.moveLayer=function(m,S){return this.style.moveLayer(m,S),this._update(!0)},d.prototype.removeLayer=function(m){return this.style.removeLayer(m),this._update(!0)},d.prototype.getLayer=function(m){return this.style.getLayer(m)},d.prototype.setLayerZoomRange=function(m,S,R){return this.style.setLayerZoomRange(m,S,R),this._update(!0)},d.prototype.setFilter=function(m,S,R){return R===void 0&&(R={}),this.style.setFilter(m,S,R),this._update(!0)},d.prototype.getFilter=function(m){return this.style.getFilter(m)},d.prototype.setPaintProperty=function(m,S,R,L){return L===void 0&&(L={}),this.style.setPaintProperty(m,S,R,L),this._update(!0)},d.prototype.getPaintProperty=function(m,S){return this.style.getPaintProperty(m,S)},d.prototype.setLayoutProperty=function(m,S,R,L){return L===void 0&&(L={}),this.style.setLayoutProperty(m,S,R,L),this._update(!0)},d.prototype.getLayoutProperty=function(m,S){return this.style.getLayoutProperty(m,S)},d.prototype.setLight=function(m,S){return S===void 0&&(S={}),this._lazyInitEmptyStyle(),this.style.setLight(m,S),this._update(!0)},d.prototype.getLight=function(){return this.style.getLight()},d.prototype.setFeatureState=function(m,S){return this.style.setFeatureState(m,S),this._update()},d.prototype.removeFeatureState=function(m,S){return this.style.removeFeatureState(m,S),this._update()},d.prototype.getFeatureState=function(m){return this.style.getFeatureState(m)},d.prototype.getContainer=function(){return this._container},d.prototype.getCanvasContainer=function(){return this._canvasContainer},d.prototype.getCanvas=function(){return this._canvas},d.prototype._containerDimensions=function(){var m=0,S=0;return this._container&&(m=this._container.clientWidth||400,S=this._container.clientHeight||300),[m,S]},d.prototype._detectMissingCSS=function(){h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},d.prototype._setupContainer=function(){var m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=C.create("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();var S=this._canvasContainer=C.create("div","mapboxgl-canvas-container",m);this._interactive&&S.classList.add("mapboxgl-interactive"),this._canvas=C.create("canvas","mapboxgl-canvas",S),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var R=this._containerDimensions();this._resizeCanvas(R[0],R[1]);var L=this._controlContainer=C.create("div","mapboxgl-control-container",m),q=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Se){q[Se]=C.create("div","mapboxgl-ctrl-"+Se,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},d.prototype._resizeCanvas=function(m,S){var R=h.browser.devicePixelRatio||1;this._canvas.width=R*m,this._canvas.height=R*S,this._canvas.style.width=m+"px",this._canvas.style.height=S+"px"},d.prototype._setupPainter=function(){var m=h.extend({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),S=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);S?(this.painter=new uo(S,this.transform),h.webpSupported.testSupport(S)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))},d.prototype._contextLost=function(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:m}))},d.prototype._contextRestored=function(m){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:m}))},d.prototype._onMapScroll=function(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},d.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},d.prototype._update=function(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this},d.prototype._requestRenderFrame=function(m){return this._update(),this._renderTaskQueue.add(m)},d.prototype._cancelRenderFrame=function(m){this._renderTaskQueue.remove(m)},d.prototype._render=function(m){var S,R=this,L=0,q=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(S=q.createQueryEXT(),q.beginQueryEXT(q.TIME_ELAPSED_EXT,S),L=h.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),!this._removed){var Se=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Le=this.transform.zoom,et=h.browser.now();this.style.zoomHistory.update(Le,et);var ot=new h.EvaluationParameters(Le,{now:et,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),st=ot.crossFadingFactor();st===1&&st===this._crossFadingFactor||(Se=!0,this._crossFadingFactor=st),this.style.update(ot)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||Se)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Rt=h.browser.now()-L;q.endQueryEXT(q.TIME_ELAPSED_EXT,S),setTimeout(function(){var St=q.getQueryObjectEXT(S,q.QUERY_RESULT_EXT)/1e6;q.deleteQueryEXT(S),R.fire(new h.Event("gpu-timing-frame",{cpuTime:Rt,gpuTime:St}))},50)}if(this.listens("gpu-timing-layer")){var Ct=this.painter.collectGpuTimers();setTimeout(function(){var St=R.painter.queryGpuTimers(Ct);R.fire(new h.Event("gpu-timing-layer",{layerTimes:St}))},50)}var Xt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Xt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||Xt||(this._fullyLoaded=!0),this}},d.prototype.remove=function(){this._hash&&this._hash.remove();for(var m=0,S=this._controls;m<S.length;m+=1)S[m].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1));var R=this.painter.context.gl.getExtension("WEBGL_lose_context");R&&R.loseContext(),ol(this._canvasContainer),ol(this._controlContainer),ol(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new h.Event("remove"))},d.prototype.triggerRepaint=function(){var m=this;this.style&&!this._frame&&(this._frame=h.browser.frame(function(S){m._frame=null,m._render(S)}))},d.prototype._onWindowOnline=function(){this._update()},d.prototype._onWindowResize=function(m){this._trackResize&&this.resize({originalEvent:m})._update()},f.showTileBoundaries.get=function(){return!!this._showTileBoundaries},f.showTileBoundaries.set=function(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())},f.showPadding.get=function(){return!!this._showPadding},f.showPadding.set=function(m){this._showPadding!==m&&(this._showPadding=m,this._update())},f.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},f.showCollisionBoxes.set=function(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())},f.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},f.showOverdrawInspector.set=function(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())},f.repaint.get=function(){return!!this._repaint},f.repaint.set=function(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())},f.vertices.get=function(){return!!this._vertices},f.vertices.set=function(m){this._vertices=m,this._update()},d.prototype._setCacheLimits=function(m,S){h.setCacheLimits(m,S)},f.version.get=function(){return h.version},Object.defineProperties(d.prototype,f),d}(cu);function ol(l){l.parentNode&&l.parentNode.removeChild(l)}var sl={showCompass:!0,showZoom:!0,visualizePitch:!1},ul=function(l){var d=this;this.options=h.extend({},sl,l),this._container=C.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(f){return f.preventDefault()}),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(f){return d._map.zoomIn({},{originalEvent:f})}),C.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(f){return d._map.zoomOut({},{originalEvent:f})}),C.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(f){d.options.visualizePitch?d._map.resetNorthPitch({},{originalEvent:f}):d._map.resetNorth({},{originalEvent:f})}),this._compassIcon=C.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ul.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),d=l===this._map.getMaxZoom(),f=l===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},ul.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},ul.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new hu(this._map,this._compass,this.options.visualizePitch)),this._container},ul.prototype.onRemove=function(){C.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ul.prototype._createButton=function(l,d){var f=C.create("button",l,this._container);return f.type="button",f.addEventListener("click",d),f},ul.prototype._setButtonTitle=function(l,d){var f=this._map._getUIString("NavigationControl."+d);l.title=f,l.setAttribute("aria-label",f)};var hu=function(l,d,f){f===void 0&&(f=!1),this._clickTolerance=10,this.element=d,this.mouseRotate=new il({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,f&&(this.mousePitch=new Ec({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),C.addEventListener(d,"mousedown",this.mousedown),C.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),C.addEventListener(d,"touchmove",this.touchmove),C.addEventListener(d,"touchend",this.touchend),C.addEventListener(d,"touchcancel",this.reset)};function Tc(l,d,f){if(l=new h.LngLat(l.lng,l.lat),d){var m=new h.LngLat(l.lng-360,l.lat),S=new h.LngLat(l.lng+360,l.lat),R=f.locationPoint(l).distSqr(d);f.locationPoint(m).distSqr(d)<R?l=m:f.locationPoint(S).distSqr(d)<R&&(l=S)}for(;Math.abs(l.lng-f.center.lng)>180;){var L=f.locationPoint(l);if(L.x>=0&&L.y>=0&&L.x<=f.width&&L.y<=f.height)break;l.lng>f.center.lng?l.lng-=360:l.lng+=360}return l}hu.prototype.down=function(l,d){this.mouseRotate.mousedown(l,d),this.mousePitch&&this.mousePitch.mousedown(l,d),C.disableDrag()},hu.prototype.move=function(l,d){var f=this.map,m=this.mouseRotate.mousemoveWindow(l,d);if(m&&m.bearingDelta&&f.setBearing(f.getBearing()+m.bearingDelta),this.mousePitch){var S=this.mousePitch.mousemoveWindow(l,d);S&&S.pitchDelta&&f.setPitch(f.getPitch()+S.pitchDelta)}},hu.prototype.off=function(){var l=this.element;C.removeEventListener(l,"mousedown",this.mousedown),C.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),C.removeEventListener(l,"touchmove",this.touchmove),C.removeEventListener(l,"touchend",this.touchend),C.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},hu.prototype.offTemp=function(){C.enableDrag(),C.removeEventListener(h.window,"mousemove",this.mousemove),C.removeEventListener(h.window,"mouseup",this.mouseup)},hu.prototype.mousedown=function(l){this.down(h.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),C.mousePos(this.element,l)),C.addEventListener(h.window,"mousemove",this.mousemove),C.addEventListener(h.window,"mouseup",this.mouseup)},hu.prototype.mousemove=function(l){this.move(l,C.mousePos(this.element,l))},hu.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},hu.prototype.touchstart=function(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=C.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},hu.prototype.touchmove=function(l){l.targetTouches.length!==1?this.reset():(this._lastPos=C.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},hu.prototype.touchend=function(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},hu.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ll={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Kc(l,d,f){var m=l.classList;for(var S in ll)m.remove("mapboxgl-"+f+"-anchor-"+S);m.add("mapboxgl-"+f+"-anchor-"+d)}var ac,Vi=function(l){function d(f,m){if(l.call(this),(f instanceof h.window.HTMLElement||m)&&(f=h.extend({element:f},m)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=f&&f.anchor||"center",this._color=f&&f.color||"#3FB1CE",this._scale=f&&f.scale||1,this._draggable=f&&f.draggable||!1,this._clickTolerance=f&&f.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=f&&f.rotation||0,this._rotationAlignment=f&&f.rotationAlignment||"auto",this._pitchAlignment=f&&f.pitchAlignment&&f.pitchAlignment!=="auto"?f.pitchAlignment:this._rotationAlignment,f&&f.element)this._element=f.element,this._offset=h.Point.convert(f&&f.offset||[0,0]);else{this._defaultMarker=!0,this._element=C.create("div"),this._element.setAttribute("aria-label","Map marker");var S=C.createNS("http://www.w3.org/2000/svg","svg");S.setAttributeNS(null,"display","block"),S.setAttributeNS(null,"height","41px"),S.setAttributeNS(null,"width","27px"),S.setAttributeNS(null,"viewBox","0 0 27 41");var R=C.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"stroke","none"),R.setAttributeNS(null,"stroke-width","1"),R.setAttributeNS(null,"fill","none"),R.setAttributeNS(null,"fill-rule","evenodd");var L=C.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var q=C.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(3.0, 29.0)"),q.setAttributeNS(null,"fill","#000000");for(var Se=0,Le=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Se<Le.length;Se+=1){var et=Le[Se],ot=C.createNS("http://www.w3.org/2000/svg","ellipse");ot.setAttributeNS(null,"opacity","0.04"),ot.setAttributeNS(null,"cx","10.5"),ot.setAttributeNS(null,"cy","5.80029008"),ot.setAttributeNS(null,"rx",et.rx),ot.setAttributeNS(null,"ry",et.ry),q.appendChild(ot)}var st=C.createNS("http://www.w3.org/2000/svg","g");st.setAttributeNS(null,"fill",this._color);var Rt=C.createNS("http://www.w3.org/2000/svg","path");Rt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),st.appendChild(Rt);var Ct=C.createNS("http://www.w3.org/2000/svg","g");Ct.setAttributeNS(null,"opacity","0.25"),Ct.setAttributeNS(null,"fill","#000000");var Xt=C.createNS("http://www.w3.org/2000/svg","path");Xt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ct.appendChild(Xt);var St=C.createNS("http://www.w3.org/2000/svg","g");St.setAttributeNS(null,"transform","translate(6.0, 7.0)"),St.setAttributeNS(null,"fill","#FFFFFF");var $t=C.createNS("http://www.w3.org/2000/svg","g");$t.setAttributeNS(null,"transform","translate(8.0, 8.0)");var tr=C.createNS("http://www.w3.org/2000/svg","circle");tr.setAttributeNS(null,"fill","#000000"),tr.setAttributeNS(null,"opacity","0.25"),tr.setAttributeNS(null,"cx","5.5"),tr.setAttributeNS(null,"cy","5.5"),tr.setAttributeNS(null,"r","5.4999962");var br=C.createNS("http://www.w3.org/2000/svg","circle");br.setAttributeNS(null,"fill","#FFFFFF"),br.setAttributeNS(null,"cx","5.5"),br.setAttributeNS(null,"cy","5.5"),br.setAttributeNS(null,"r","5.4999962"),$t.appendChild(tr),$t.appendChild(br),L.appendChild(q),L.appendChild(st),L.appendChild(Ct),L.appendChild(St),L.appendChild($t),S.appendChild(L),S.setAttributeNS(null,"height",41*this._scale+"px"),S.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(S),this._offset=h.Point.convert(f&&f.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(kr){kr.preventDefault()}),this._element.addEventListener("mousedown",function(kr){kr.preventDefault()}),Kc(this._element,this._anchor,"marker"),this._popup=null}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.addTo=function(f){return this.remove(),this._map=f,f.getCanvasContainer().appendChild(this._element),f.on("move",this._update),f.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},d.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),C.remove(this._element),this._popup&&this._popup.remove(),this},d.prototype.getLngLat=function(){return this._lngLat},d.prototype.setLngLat=function(f){return this._lngLat=h.LngLat.convert(f),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},d.prototype.getElement=function(){return this._element},d.prototype.setPopup=function(f){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),f){if(!("offset"in f.options)){var m=Math.sqrt(Math.pow(13.5,2)/2);f.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=f,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},d.prototype._onKeyPress=function(f){var m=f.code,S=f.charCode||f.keyCode;m!=="Space"&&m!=="Enter"&&S!==32&&S!==13||this.togglePopup()},d.prototype._onMapClick=function(f){var m=f.originalEvent.target,S=this._element;this._popup&&(m===S||S.contains(m))&&this.togglePopup()},d.prototype.getPopup=function(){return this._popup},d.prototype.togglePopup=function(){var f=this._popup;return f?(f.isOpen()?f.remove():f.addTo(this._map),this):this},d.prototype._update=function(f){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Tc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(m="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S="rotateX("+this._map.getPitch()+"deg)"),f&&f.type!=="moveend"||(this._pos=this._pos.round()),C.setTransform(this._element,ll[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+S+" "+m)}},d.prototype.getOffset=function(){return this._offset},d.prototype.setOffset=function(f){return this._offset=h.Point.convert(f),this._update(),this},d.prototype._onMove=function(f){if(!this._isDragging){var m=this._clickTolerance||this._map._clickTolerance;this._isDragging=f.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=f.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))},d.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"},d.prototype._addDragHandler=function(f){this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(this._pos).add(this._offset),this._pointerdownPos=f.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},d.prototype.setDraggable=function(f){return this._draggable=!!f,this._map&&(f?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},d.prototype.isDraggable=function(){return this._draggable},d.prototype.setRotation=function(f){return this._rotation=f||0,this._update(),this},d.prototype.getRotation=function(){return this._rotation},d.prototype.setRotationAlignment=function(f){return this._rotationAlignment=f||"auto",this._update(),this},d.prototype.getRotationAlignment=function(){return this._rotationAlignment},d.prototype.setPitchAlignment=function(f){return this._pitchAlignment=f&&f!=="auto"?f:this._rotationAlignment,this._update(),this},d.prototype.getPitchAlignment=function(){return this._pitchAlignment},d}(h.Evented),Ol={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Pl=0,yo=!1,Gu=function(l){function d(f){l.call(this),this.options=h.extend({},Ol,f),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.onAdd=function(f){var m;return this._map=f,this._container=C.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,ac!==void 0?m(ac):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then(function(S){m(ac=S.state!=="denied")}):m(ac=!!h.window.navigator.geolocation),this._container},d.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),C.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Pl=0,yo=!1},d.prototype._isOutOfMapMaxBounds=function(f){var m=this._map.getMaxBounds(),S=f.coords;return m&&(S.longitude<m.getWest()||S.longitude>m.getEast()||S.latitude<m.getSouth()||S.latitude>m.getNorth())},d.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},d.prototype._onSuccess=function(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",f)),this._finish()}},d.prototype._updateCamera=function(f){var m=new h.LngLat(f.coords.longitude,f.coords.latitude),S=f.coords.accuracy,R=this._map.getBearing(),L=h.extend({bearing:R},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(S),L,{geolocateSource:!0})},d.prototype._updateMarker=function(f){if(f){var m=new h.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},d.prototype._updateCircleRadius=function(){var f=this._map._container.clientHeight/2,m=this._map.unproject([0,f]),S=this._map.unproject([1,f]),R=m.distanceTo(S),L=Math.ceil(2*this._accuracy/R);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},d.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},d.prototype._onError=function(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&yo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",f)),this._finish()}},d.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},d.prototype._setupUI=function(f){var m=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=C.create("button","mapboxgl-ctrl-geolocate",this._container),C.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",f===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var S=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S)}else{var R=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=R,this._geolocateButton.setAttribute("aria-label",R)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=C.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Vi(this._dotElement),this._circleElement=C.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||m._watchState!=="ACTIVE_LOCK"||L.originalEvent&&L.originalEvent.type==="resize"||(m._watchState="BACKGROUND",m._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),m._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),m.fire(new h.Event("trackuserlocationend")))})},d.prototype.trigger=function(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Pl--,yo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Pl>1?(f={maximumAge:6e5,timeout:0},yo=!0):(f=this.options.positionOptions,yo=!1),this._geolocationWatchID=h.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else h.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},d.prototype._clearWatch=function(){h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},d}(h.Evented),Ii={maxWidth:100,unit:"metric"},Ns=function(l){this.options=h.extend({},Ii,l),h.bindAll(["_onMove","setUnit"],this)};function cl(l,d,f){var m=f&&f.maxWidth||100,S=l._container.clientHeight/2,R=l.unproject([0,S]),L=l.unproject([m,S]),q=R.distanceTo(L);if(f&&f.unit==="imperial"){var Se=3.2808*q;Se>5280?eo(d,m,Se/5280,l._getUIString("ScaleControl.Miles")):eo(d,m,Se,l._getUIString("ScaleControl.Feet"))}else f&&f.unit==="nautical"?eo(d,m,q/1852,l._getUIString("ScaleControl.NauticalMiles")):q>=1e3?eo(d,m,q/1e3,l._getUIString("ScaleControl.Kilometers")):eo(d,m,q,l._getUIString("ScaleControl.Meters"))}function eo(l,d,f,m){var S,R,L,q=(S=f,(R=Math.pow(10,(""+Math.floor(S)).length-1))*(L=(L=S/R)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(Se){var Le=Math.pow(10,Math.ceil(-Math.log(Se)/Math.LN10));return Math.round(Se*Le)/Le}(L)));l.style.width=d*(q/f)+"px",l.innerHTML=q+"&nbsp;"+m}Ns.prototype.getDefaultPosition=function(){return"bottom-left"},Ns.prototype._onMove=function(){cl(this._map,this._container,this.options)},Ns.prototype.onAdd=function(l){return this._map=l,this._container=C.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ns.prototype.onRemove=function(){C.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ns.prototype.setUnit=function(l){this.options.unit=l,cl(this._map,this._container,this.options)};var Wo=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof h.window.HTMLElement?this._container=l.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in h.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in h.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in h.window.document&&(this._fullscreenchange="MSFullscreenChange")};Wo.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=C.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Wo.prototype.onRemove=function(){C.remove(this._controlContainer),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Wo.prototype._checkFullscreenSupport=function(){return!!(h.window.document.fullscreenEnabled||h.window.document.mozFullScreenEnabled||h.window.document.msFullscreenEnabled||h.window.document.webkitFullscreenEnabled)},Wo.prototype._setupUI=function(){var l=this._fullscreenButton=C.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);C.create("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Wo.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},Wo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Wo.prototype._isFullscreen=function(){return this._fullscreen},Wo.prototype._changeIcon=function(){(h.window.document.fullscreenElement||h.window.document.mozFullScreenElement||h.window.document.webkitFullscreenElement||h.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Wo.prototype._onClickFullscreen=function(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.mozCancelFullScreen?h.window.document.mozCancelFullScreen():h.window.document.msExitFullscreen?h.window.document.msExitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Wl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},oc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ra=function(l){function d(f){l.call(this),this.options=h.extend(Object.create(Wl),f),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.addTo=function(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this},d.prototype.isOpen=function(){return!!this._map},d.prototype.remove=function(){return this._content&&C.remove(this._content),this._container&&(C.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this},d.prototype.getLngLat=function(){return this._lngLat},d.prototype.setLngLat=function(f){return this._lngLat=h.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},d.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},d.prototype.getElement=function(){return this._container},d.prototype.setText=function(f){return this.setDOMContent(h.window.document.createTextNode(f))},d.prototype.setHTML=function(f){var m,S=h.window.document.createDocumentFragment(),R=h.window.document.createElement("body");for(R.innerHTML=f;m=R.firstChild;)S.appendChild(m);return this.setDOMContent(S)},d.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},d.prototype.setMaxWidth=function(f){return this.options.maxWidth=f,this._update(),this},d.prototype.setDOMContent=function(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=C.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this},d.prototype.addClassName=function(f){this._container&&this._container.classList.add(f)},d.prototype.removeClassName=function(f){this._container&&this._container.classList.remove(f)},d.prototype.setOffset=function(f){return this.options.offset=f,this._update(),this},d.prototype.toggleClassName=function(f){if(this._container)return this._container.classList.toggle(f)},d.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=C.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},d.prototype._onMouseUp=function(f){this._update(f.point)},d.prototype._onMouseMove=function(f){this._update(f.point)},d.prototype._onDrag=function(f){this._update(f.point)},d.prototype._update=function(f){var m=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=C.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=C.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ot){return m._container.classList.add(ot)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||f)){var S=this._pos=this._trackPointer&&f?f:this._map.project(this._lngLat),R=this.options.anchor,L=function ot(st){if(st){if(typeof st=="number"){var Rt=Math.round(Math.sqrt(.5*Math.pow(st,2)));return{center:new h.Point(0,0),top:new h.Point(0,st),"top-left":new h.Point(Rt,Rt),"top-right":new h.Point(-Rt,Rt),bottom:new h.Point(0,-st),"bottom-left":new h.Point(Rt,-Rt),"bottom-right":new h.Point(-Rt,-Rt),left:new h.Point(st,0),right:new h.Point(-st,0)}}if(st instanceof h.Point||Array.isArray(st)){var Ct=h.Point.convert(st);return{center:Ct,top:Ct,"top-left":Ct,"top-right":Ct,bottom:Ct,"bottom-left":Ct,"bottom-right":Ct,left:Ct,right:Ct}}return{center:h.Point.convert(st.center||[0,0]),top:h.Point.convert(st.top||[0,0]),"top-left":h.Point.convert(st["top-left"]||[0,0]),"top-right":h.Point.convert(st["top-right"]||[0,0]),bottom:h.Point.convert(st.bottom||[0,0]),"bottom-left":h.Point.convert(st["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(st["bottom-right"]||[0,0]),left:h.Point.convert(st.left||[0,0]),right:h.Point.convert(st.right||[0,0])}}return ot(new h.Point(0,0))}(this.options.offset);if(!R){var q,Se=this._container.offsetWidth,Le=this._container.offsetHeight;q=S.y+L.bottom.y<Le?["top"]:S.y>this._map.transform.height-Le?["bottom"]:[],S.x<Se/2?q.push("left"):S.x>this._map.transform.width-Se/2&&q.push("right"),R=q.length===0?"bottom":q.join("-")}var et=S.add(L[R]).round();C.setTransform(this._container,ll[R]+" translate("+et.x+"px,"+et.y+"px)"),Kc(this._container,R,"popup")}},d.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var f=this._container.querySelector(oc);f&&f.focus()}},d.prototype._onClose=function(){this.remove()},d}(h.Evented),Gl={version:h.version,supported:O,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:ao,NavigationControl:ul,GeolocateControl:Gu,AttributionControl:ws,ScaleControl:Ns,FullscreenControl:Wo,Popup:Ra,Marker:Vi,Style:gn,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,config:h.config,prewarm:function(){Ht().acquire(ft)},clearPrewarmedResources:function(){var l=Gt;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(ft),Gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(l){h.config.ACCESS_TOKEN=l},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(l){h.config.API_URL=l},get workerCount(){return bt.workerCount},set workerCount(l){bt.workerCount=l},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){h.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){h.clearTileCache(l)},workerUrl:""};return Gl}),D})},92077:function(Ze,E,_){var D,N;(function(h,O){D=O,N=typeof D=="function"?D.call(E,_,E,Ze):D,N!==void 0&&(Ze.exports=N)})(this,function(){var h,O,C="2.0.6",P={},F={},Y={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},V={currentLocale:Y.currentLocale,zeroFormat:Y.zeroFormat,nullFormat:Y.nullFormat,defaultFormat:Y.defaultFormat,scalePercentBy100:Y.scalePercentBy100};function Q(k,K){this._input=k,this._value=K}return h=function(k){var K,U,Z,J;if(h.isNumeral(k))K=k.value();else if(k===0||typeof k=="undefined")K=0;else if(k===null||O.isNaN(k))K=null;else if(typeof k=="string")if(V.zeroFormat&&k===V.zeroFormat)K=0;else if(V.nullFormat&&k===V.nullFormat||!k.replace(/[^0-9]+/g,"").length)K=null;else{for(U in P)if(J=typeof P[U].regexps.unformat=="function"?P[U].regexps.unformat():P[U].regexps.unformat,J&&k.match(J)){Z=P[U].unformat;break}Z=Z||h._.stringToNumber,K=Z(k)}else K=Number(k)||null;return new Q(k,K)},h.version=C,h.isNumeral=function(k){return k instanceof Q},h._=O={numberToFormat:function(k,K,U){var Z=F[h.options.currentLocale],J=!1,H=!1,ve=0,Te="",ye=1e12,Ve=1e9,Re=1e6,Ae=1e3,ae="",ee=!1,me,ge,fe,Et,xe,je,ue,Pe,we,nt;if(k=k||0,ge=Math.abs(k),h._.includes(K,"(")?(J=!0,K=K.replace(/[\(|\)]/g,"")):(h._.includes(K,"+")||h._.includes(K,"-"))&&(Pe=h._.includes(K,"+")?K.indexOf("+"):k<0?K.indexOf("-"):-1,K=K.replace(/[\+|\-]/g,"")),h._.includes(K,"a")&&(me=K.match(/a(k|m|b|t)?/),me=me?me[1]:!1,h._.includes(K," a")&&(Te=" "),K=K.replace(new RegExp(Te+"a[kmbt]?"),""),ge>=ye&&!me||me==="t"?(Te+=Z.abbreviations.trillion,k=k/ye):ge<ye&&ge>=Ve&&!me||me==="b"?(Te+=Z.abbreviations.billion,k=k/Ve):ge<Ve&&ge>=Re&&!me||me==="m"?(Te+=Z.abbreviations.million,k=k/Re):(ge<Re&&ge>=Ae&&!me||me==="k")&&(Te+=Z.abbreviations.thousand,k=k/Ae)),h._.includes(K,"[.]")&&(H=!0,K=K.replace("[.]",".")),je=k.toString().split(".")[0],ue=K.split(".")[1],we=K.indexOf(","),ve=(K.split(".")[0].split(",")[0].match(/0/g)||[]).length,ue?(h._.includes(ue,"[")?(ue=ue.replace("]",""),ue=ue.split("["),ae=h._.toFixed(k,ue[0].length+ue[1].length,U,ue[1].length)):ae=h._.toFixed(k,ue.length,U),je=ae.split(".")[0],h._.includes(ae,".")?ae=Z.delimiters.decimal+ae.split(".")[1]:ae="",H&&Number(ae.slice(1))===0&&(ae="")):je=h._.toFixed(k,0,U),Te&&!me&&Number(je)>=1e3&&Te!==Z.abbreviations.trillion)switch(je=String(Number(je)/1e3),Te){case Z.abbreviations.thousand:Te=Z.abbreviations.million;break;case Z.abbreviations.million:Te=Z.abbreviations.billion;break;case Z.abbreviations.billion:Te=Z.abbreviations.trillion;break}if(h._.includes(je,"-")&&(je=je.slice(1),ee=!0),je.length<ve)for(var at=ve-je.length;at>0;at--)je="0"+je;return we>-1&&(je=je.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+Z.delimiters.thousands)),K.indexOf(".")===0&&(je=""),nt=je+ae+(Te||""),J?nt=(J&&ee?"(":"")+nt+(J&&ee?")":""):Pe>=0?nt=Pe===0?(ee?"-":"+")+nt:nt+(ee?"-":"+"):ee&&(nt="-"+nt),nt},stringToNumber:function(k){var K=F[V.currentLocale],U=k,Z={thousand:3,million:6,billion:9,trillion:12},J,H,ve,Te;if(V.zeroFormat&&k===V.zeroFormat)H=0;else if(V.nullFormat&&k===V.nullFormat||!k.replace(/[^0-9]+/g,"").length)H=null;else{H=1,K.delimiters.decimal!=="."&&(k=k.replace(/\./g,"").replace(K.delimiters.decimal,"."));for(J in Z)if(Te=new RegExp("[^a-zA-Z]"+K.abbreviations[J]+"(?:\\)|(\\"+K.currency.symbol+")?(?:\\))?)?$"),U.match(Te)){H*=Math.pow(10,Z[J]);break}H*=(k.split("-").length+Math.min(k.split("(").length-1,k.split(")").length-1))%2?1:-1,k=k.replace(/[^0-9\.]+/g,""),H*=Number(k)}return H},isNaN:function(k){return typeof k=="number"&&isNaN(k)},includes:function(k,K){return k.indexOf(K)!==-1},insert:function(k,K,U){return k.slice(0,U)+K+k.slice(U)},reduce:function(k,K){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof K!="function")throw new TypeError(K+" is not a function");var U=Object(k),Z=U.length>>>0,J=0,H;if(arguments.length===3)H=arguments[2];else{for(;J<Z&&!(J in U);)J++;if(J>=Z)throw new TypeError("Reduce of empty array with no initial value");H=U[J++]}for(;J<Z;J++)J in U&&(H=K(H,U[J],J,U));return H},multiplier:function(k){var K=k.toString().split(".");return K.length<2?1:Math.pow(10,K[1].length)},correctionFactor:function(){var k=Array.prototype.slice.call(arguments);return k.reduce(function(K,U){var Z=O.multiplier(U);return K>Z?K:Z},1)},toFixed:function(k,K,U,Z){var J=k.toString().split("."),H=K-(Z||0),ve,Te,ye,Ve;return J.length===2?ve=Math.min(Math.max(J[1].length,H),K):ve=H,ye=Math.pow(10,ve),Ve=(U(k+"e+"+ve)/ye).toFixed(ve),Z>K-ve&&(Te=new RegExp("\\.?0{1,"+(Z-(K-ve))+"}$"),Ve=Ve.replace(Te,"")),Ve}},h.options=V,h.formats=P,h.locales=F,h.locale=function(k){return k&&(V.currentLocale=k.toLowerCase()),V.currentLocale},h.localeData=function(k){if(!k)return F[V.currentLocale];if(k=k.toLowerCase(),!F[k])throw new Error("Unknown locale : "+k);return F[k]},h.reset=function(){for(var k in Y)V[k]=Y[k]},h.zeroFormat=function(k){V.zeroFormat=typeof k=="string"?k:null},h.nullFormat=function(k){V.nullFormat=typeof k=="string"?k:null},h.defaultFormat=function(k){V.defaultFormat=typeof k=="string"?k:"0.0"},h.register=function(k,K,U){if(K=K.toLowerCase(),this[k+"s"][K])throw new TypeError(K+" "+k+" already registered.");return this[k+"s"][K]=U,U},h.validate=function(k,K){var U,Z,J,H,ve,Te,ye,Ve;if(typeof k!="string"&&(k+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",k)),k=k.trim(),k.match(/^\d+$/))return!0;if(k==="")return!1;try{ye=h.localeData(K)}catch(Re){ye=h.localeData(h.locale())}return J=ye.currency.symbol,ve=ye.abbreviations,U=ye.delimiters.decimal,ye.delimiters.thousands==="."?Z="\\.":Z=ye.delimiters.thousands,Ve=k.match(/^[^\d]+/),Ve!==null&&(k=k.substr(1),Ve[0]!==J)||(Ve=k.match(/[^\d]+$/),Ve!==null&&(k=k.slice(0,-1),Ve[0]!==ve.thousand&&Ve[0]!==ve.million&&Ve[0]!==ve.billion&&Ve[0]!==ve.trillion))?!1:(Te=new RegExp(Z+"{2}"),k.match(/[^\d.,]/g)?!1:(H=k.split(U),H.length>2?!1:H.length<2?!!H[0].match(/^\d+.*\d$/)&&!H[0].match(Te):H[0].length===1?!!H[0].match(/^\d+$/)&&!H[0].match(Te)&&!!H[1].match(/^\d+$/):!!H[0].match(/^\d+.*\d$/)&&!H[0].match(Te)&&!!H[1].match(/^\d+$/)))},h.fn=Q.prototype={clone:function(){return h(this)},format:function(k,K){var U=this._value,Z=k||V.defaultFormat,J,H,ve;if(K=K||Math.round,U===0&&V.zeroFormat!==null)H=V.zeroFormat;else if(U===null&&V.nullFormat!==null)H=V.nullFormat;else{for(J in P)if(Z.match(P[J].regexps.format)){ve=P[J].format;break}ve=ve||h._.numberToFormat,H=ve(U,Z,K)}return H},value:function(){return this._value},input:function(){return this._input},set:function(k){return this._value=Number(k),this},add:function(k){var K=O.correctionFactor.call(null,this._value,k);function U(Z,J,H,ve){return Z+Math.round(K*J)}return this._value=O.reduce([this._value,k],U,0)/K,this},subtract:function(k){var K=O.correctionFactor.call(null,this._value,k);function U(Z,J,H,ve){return Z-Math.round(K*J)}return this._value=O.reduce([k],U,Math.round(this._value*K))/K,this},multiply:function(k){function K(U,Z,J,H){var ve=O.correctionFactor(U,Z);return Math.round(U*ve)*Math.round(Z*ve)/Math.round(ve*ve)}return this._value=O.reduce([this._value,k],K,1),this},divide:function(k){function K(U,Z,J,H){var ve=O.correctionFactor(U,Z);return Math.round(U*ve)/Math.round(Z*ve)}return this._value=O.reduce([this._value,k],K),this},difference:function(k){return Math.abs(h(this._value).subtract(k).value())}},h.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(k){var K=k%10;return~~(k%100/10)===1?"th":K===1?"st":K===2?"nd":K===3?"rd":"th"},currency:{symbol:"$"}}),function(){h.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(k,K,U){var Z=h._.includes(K," BPS")?" ":"",J;return k=k*1e4,K=K.replace(/\s?BPS/,""),J=h._.numberToFormat(k,K,U),h._.includes(J,")")?(J=J.split(""),J.splice(-1,0,Z+"BPS"),J=J.join("")):J=J+Z+"BPS",J},unformat:function(k){return+(h._.stringToNumber(k)*1e-4).toFixed(15)}})}(),function(){var k={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},K={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},U=k.suffixes.concat(K.suffixes.filter(function(J){return k.suffixes.indexOf(J)<0})),Z=U.join("|");Z="("+Z.replace("B","B(?!PS)")+")",h.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(Z)},format:function(J,H,ve){var Te,ye=h._.includes(H,"ib")?K:k,Ve=h._.includes(H," b")||h._.includes(H," ib")?" ":"",Re,Ae,ae;for(H=H.replace(/\s?i?b/,""),Re=0;Re<=ye.suffixes.length;Re++)if(Ae=Math.pow(ye.base,Re),ae=Math.pow(ye.base,Re+1),J===null||J===0||J>=Ae&&J<ae){Ve+=ye.suffixes[Re],Ae>0&&(J=J/Ae);break}return Te=h._.numberToFormat(J,H,ve),Te+Ve},unformat:function(J){var H=h._.stringToNumber(J),ve,Te;if(H){for(ve=k.suffixes.length-1;ve>=0;ve--){if(h._.includes(J,k.suffixes[ve])){Te=Math.pow(k.base,ve);break}if(h._.includes(J,K.suffixes[ve])){Te=Math.pow(K.base,ve);break}}H*=Te||1}return H}})}(),function(){h.register("format","currency",{regexps:{format:/(\$)/},format:function(k,K,U){var Z=h.locales[h.options.currentLocale],J={before:K.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:K.match(/([\+|\-|\)|\s|\$]*)$/)[0]},H,ve,Te;for(K=K.replace(/\s?\$\s?/,""),H=h._.numberToFormat(k,K,U),k>=0?(J.before=J.before.replace(/[\-\(]/,""),J.after=J.after.replace(/[\-\)]/,"")):k<0&&!h._.includes(J.before,"-")&&!h._.includes(J.before,"(")&&(J.before="-"+J.before),Te=0;Te<J.before.length;Te++)switch(ve=J.before[Te],ve){case"$":H=h._.insert(H,Z.currency.symbol,Te);break;case" ":H=h._.insert(H," ",Te+Z.currency.symbol.length-1);break}for(Te=J.after.length-1;Te>=0;Te--)switch(ve=J.after[Te],ve){case"$":H=Te===J.after.length-1?H+Z.currency.symbol:h._.insert(H,Z.currency.symbol,-(J.after.length-(1+Te)));break;case" ":H=Te===J.after.length-1?H+" ":h._.insert(H," ",-(J.after.length-(1+Te)+Z.currency.symbol.length-1));break}return H}})}(),function(){h.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(k,K,U){var Z,J=typeof k=="number"&&!h._.isNaN(k)?k.toExponential():"0e+0",H=J.split("e");return K=K.replace(/e[\+|\-]{1}0/,""),Z=h._.numberToFormat(Number(H[0]),K,U),Z+"e"+H[1]},unformat:function(k){var K=h._.includes(k,"e+")?k.split("e+"):k.split("e-"),U=Number(K[0]),Z=Number(K[1]);Z=h._.includes(k,"e-")?Z*=-1:Z;function J(H,ve,Te,ye){var Ve=h._.correctionFactor(H,ve),Re=H*Ve*(ve*Ve)/(Ve*Ve);return Re}return h._.reduce([U,Math.pow(10,Z)],J,1)}})}(),function(){h.register("format","ordinal",{regexps:{format:/(o)/},format:function(k,K,U){var Z=h.locales[h.options.currentLocale],J,H=h._.includes(K," o")?" ":"";return K=K.replace(/\s?o/,""),H+=Z.ordinal(k),J=h._.numberToFormat(k,K,U),J+H}})}(),function(){h.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(k,K,U){var Z=h._.includes(K," %")?" ":"",J;return h.options.scalePercentBy100&&(k=k*100),K=K.replace(/\s?\%/,""),J=h._.numberToFormat(k,K,U),h._.includes(J,")")?(J=J.split(""),J.splice(-1,0,Z+"%"),J=J.join("")):J=J+Z+"%",J},unformat:function(k){var K=h._.stringToNumber(k);return h.options.scalePercentBy100?K*.01:K}})}(),function(){h.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(k,K,U){var Z=Math.floor(k/60/60),J=Math.floor((k-Z*60*60)/60),H=Math.round(k-Z*60*60-J*60);return Z+":"+(J<10?"0"+J:J)+":"+(H<10?"0"+H:H)},unformat:function(k){var K=k.split(":"),U=0;return K.length===3?(U=U+Number(K[0])*60*60,U=U+Number(K[1])*60,U=U+Number(K[2])):K.length===2&&(U=U+Number(K[0])*60,U=U+Number(K[1])),Number(U)}})}(),h})},3614:function(Ze,E,_){"use strict";Ze.exports=N;var D=_(80645);function N(xe){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(xe)?xe:new Uint8Array(xe||0),this.pos=0,this.type=0,this.length=this.buf.length}N.Varint=0,N.Fixed64=1,N.Bytes=2,N.Fixed32=5;var h=65536*65536,O=1/h,C=12,P=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");N.prototype={destroy:function(){this.buf=null},readFields:function(xe,je,ue){for(ue=ue||this.length;this.pos<ue;){var Pe=this.readVarint(),we=Pe>>3,nt=this.pos;this.type=Pe&7,xe(we,je,this),this.pos===nt&&this.skip(Pe)}return je},readMessage:function(xe,je){return this.readFields(xe,je,this.readVarint()+this.pos)},readFixed32:function(){var xe=ae(this.buf,this.pos);return this.pos+=4,xe},readSFixed32:function(){var xe=me(this.buf,this.pos);return this.pos+=4,xe},readFixed64:function(){var xe=ae(this.buf,this.pos)+ae(this.buf,this.pos+4)*h;return this.pos+=8,xe},readSFixed64:function(){var xe=ae(this.buf,this.pos)+me(this.buf,this.pos+4)*h;return this.pos+=8,xe},readFloat:function(){var xe=D.read(this.buf,this.pos,!0,23,4);return this.pos+=4,xe},readDouble:function(){var xe=D.read(this.buf,this.pos,!0,52,8);return this.pos+=8,xe},readVarint:function(xe){var je=this.buf,ue,Pe;return Pe=je[this.pos++],ue=Pe&127,Pe<128||(Pe=je[this.pos++],ue|=(Pe&127)<<7,Pe<128)||(Pe=je[this.pos++],ue|=(Pe&127)<<14,Pe<128)||(Pe=je[this.pos++],ue|=(Pe&127)<<21,Pe<128)?ue:(Pe=je[this.pos],ue|=(Pe&15)<<28,F(ue,xe,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var xe=this.readVarint();return xe%2===1?(xe+1)/-2:xe/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var xe=this.readVarint()+this.pos,je=this.pos;return this.pos=xe,xe-je>=C&&P?fe(this.buf,je,xe):ge(this.buf,je,xe)},readBytes:function(){var xe=this.readVarint()+this.pos,je=this.buf.subarray(this.pos,xe);return this.pos=xe,je},readPackedVarint:function(xe,je){if(this.type!==N.Bytes)return xe.push(this.readVarint(je));var ue=Y(this);for(xe=xe||[];this.pos<ue;)xe.push(this.readVarint(je));return xe},readPackedSVarint:function(xe){if(this.type!==N.Bytes)return xe.push(this.readSVarint());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readSVarint());return xe},readPackedBoolean:function(xe){if(this.type!==N.Bytes)return xe.push(this.readBoolean());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readBoolean());return xe},readPackedFloat:function(xe){if(this.type!==N.Bytes)return xe.push(this.readFloat());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readFloat());return xe},readPackedDouble:function(xe){if(this.type!==N.Bytes)return xe.push(this.readDouble());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readDouble());return xe},readPackedFixed32:function(xe){if(this.type!==N.Bytes)return xe.push(this.readFixed32());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readFixed32());return xe},readPackedSFixed32:function(xe){if(this.type!==N.Bytes)return xe.push(this.readSFixed32());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readSFixed32());return xe},readPackedFixed64:function(xe){if(this.type!==N.Bytes)return xe.push(this.readFixed64());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readFixed64());return xe},readPackedSFixed64:function(xe){if(this.type!==N.Bytes)return xe.push(this.readSFixed64());var je=Y(this);for(xe=xe||[];this.pos<je;)xe.push(this.readSFixed64());return xe},skip:function(xe){var je=xe&7;if(je===N.Varint)for(;this.buf[this.pos++]>127;);else if(je===N.Bytes)this.pos=this.readVarint()+this.pos;else if(je===N.Fixed32)this.pos+=4;else if(je===N.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+je)},writeTag:function(xe,je){this.writeVarint(xe<<3|je)},realloc:function(xe){for(var je=this.length||16;je<this.pos+xe;)je*=2;if(je!==this.length){var ue=new Uint8Array(je);ue.set(this.buf),this.buf=ue,this.length=je}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(xe){this.realloc(4),ee(this.buf,xe,this.pos),this.pos+=4},writeSFixed32:function(xe){this.realloc(4),ee(this.buf,xe,this.pos),this.pos+=4},writeFixed64:function(xe){this.realloc(8),ee(this.buf,xe&-1,this.pos),ee(this.buf,Math.floor(xe*O),this.pos+4),this.pos+=8},writeSFixed64:function(xe){this.realloc(8),ee(this.buf,xe&-1,this.pos),ee(this.buf,Math.floor(xe*O),this.pos+4),this.pos+=8},writeVarint:function(xe){if(xe=+xe||0,xe>268435455||xe<0){Q(xe,this);return}this.realloc(4),this.buf[this.pos++]=xe&127|(xe>127?128:0),!(xe<=127)&&(this.buf[this.pos++]=(xe>>>=7)&127|(xe>127?128:0),!(xe<=127)&&(this.buf[this.pos++]=(xe>>>=7)&127|(xe>127?128:0),!(xe<=127)&&(this.buf[this.pos++]=xe>>>7&127)))},writeSVarint:function(xe){this.writeVarint(xe<0?-xe*2-1:xe*2)},writeBoolean:function(xe){this.writeVarint(!!xe)},writeString:function(xe){xe=String(xe),this.realloc(xe.length*4),this.pos++;var je=this.pos;this.pos=Et(this.buf,xe,this.pos);var ue=this.pos-je;ue>=128&&U(je,ue,this),this.pos=je-1,this.writeVarint(ue),this.pos+=ue},writeFloat:function(xe){this.realloc(4),D.write(this.buf,xe,this.pos,!0,23,4),this.pos+=4},writeDouble:function(xe){this.realloc(8),D.write(this.buf,xe,this.pos,!0,52,8),this.pos+=8},writeBytes:function(xe){var je=xe.length;this.writeVarint(je),this.realloc(je);for(var ue=0;ue<je;ue++)this.buf[this.pos++]=xe[ue]},writeRawMessage:function(xe,je){this.pos++;var ue=this.pos;xe(je,this);var Pe=this.pos-ue;Pe>=128&&U(ue,Pe,this),this.pos=ue-1,this.writeVarint(Pe),this.pos+=Pe},writeMessage:function(xe,je,ue){this.writeTag(xe,N.Bytes),this.writeRawMessage(je,ue)},writePackedVarint:function(xe,je){je.length&&this.writeMessage(xe,Z,je)},writePackedSVarint:function(xe,je){je.length&&this.writeMessage(xe,J,je)},writePackedBoolean:function(xe,je){je.length&&this.writeMessage(xe,Te,je)},writePackedFloat:function(xe,je){je.length&&this.writeMessage(xe,H,je)},writePackedDouble:function(xe,je){je.length&&this.writeMessage(xe,ve,je)},writePackedFixed32:function(xe,je){je.length&&this.writeMessage(xe,ye,je)},writePackedSFixed32:function(xe,je){je.length&&this.writeMessage(xe,Ve,je)},writePackedFixed64:function(xe,je){je.length&&this.writeMessage(xe,Re,je)},writePackedSFixed64:function(xe,je){je.length&&this.writeMessage(xe,Ae,je)},writeBytesField:function(xe,je){this.writeTag(xe,N.Bytes),this.writeBytes(je)},writeFixed32Field:function(xe,je){this.writeTag(xe,N.Fixed32),this.writeFixed32(je)},writeSFixed32Field:function(xe,je){this.writeTag(xe,N.Fixed32),this.writeSFixed32(je)},writeFixed64Field:function(xe,je){this.writeTag(xe,N.Fixed64),this.writeFixed64(je)},writeSFixed64Field:function(xe,je){this.writeTag(xe,N.Fixed64),this.writeSFixed64(je)},writeVarintField:function(xe,je){this.writeTag(xe,N.Varint),this.writeVarint(je)},writeSVarintField:function(xe,je){this.writeTag(xe,N.Varint),this.writeSVarint(je)},writeStringField:function(xe,je){this.writeTag(xe,N.Bytes),this.writeString(je)},writeFloatField:function(xe,je){this.writeTag(xe,N.Fixed32),this.writeFloat(je)},writeDoubleField:function(xe,je){this.writeTag(xe,N.Fixed64),this.writeDouble(je)},writeBooleanField:function(xe,je){this.writeVarintField(xe,!!je)}};function F(xe,je,ue){var Pe=ue.buf,we,nt;if(nt=Pe[ue.pos++],we=(nt&112)>>4,nt<128||(nt=Pe[ue.pos++],we|=(nt&127)<<3,nt<128)||(nt=Pe[ue.pos++],we|=(nt&127)<<10,nt<128)||(nt=Pe[ue.pos++],we|=(nt&127)<<17,nt<128)||(nt=Pe[ue.pos++],we|=(nt&127)<<24,nt<128)||(nt=Pe[ue.pos++],we|=(nt&1)<<31,nt<128))return V(xe,we,je);throw new Error("Expected varint not more than 10 bytes")}function Y(xe){return xe.type===N.Bytes?xe.readVarint()+xe.pos:xe.pos+1}function V(xe,je,ue){return ue?je*4294967296+(xe>>>0):(je>>>0)*4294967296+(xe>>>0)}function Q(xe,je){var ue,Pe;if(xe>=0?(ue=xe%4294967296|0,Pe=xe/4294967296|0):(ue=~(-xe%4294967296),Pe=~(-xe/4294967296),ue^4294967295?ue=ue+1|0:(ue=0,Pe=Pe+1|0)),xe>=18446744073709552e3||xe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");je.realloc(10),k(ue,Pe,je),K(Pe,je)}function k(xe,je,ue){ue.buf[ue.pos++]=xe&127|128,xe>>>=7,ue.buf[ue.pos++]=xe&127|128,xe>>>=7,ue.buf[ue.pos++]=xe&127|128,xe>>>=7,ue.buf[ue.pos++]=xe&127|128,xe>>>=7,ue.buf[ue.pos]=xe&127}function K(xe,je){var ue=(xe&7)<<4;je.buf[je.pos++]|=ue|((xe>>>=3)?128:0),xe&&(je.buf[je.pos++]=xe&127|((xe>>>=7)?128:0),xe&&(je.buf[je.pos++]=xe&127|((xe>>>=7)?128:0),xe&&(je.buf[je.pos++]=xe&127|((xe>>>=7)?128:0),xe&&(je.buf[je.pos++]=xe&127|((xe>>>=7)?128:0),xe&&(je.buf[je.pos++]=xe&127)))))}function U(xe,je,ue){var Pe=je<=16383?1:je<=2097151?2:je<=268435455?3:Math.floor(Math.log(je)/(Math.LN2*7));ue.realloc(Pe);for(var we=ue.pos-1;we>=xe;we--)ue.buf[we+Pe]=ue.buf[we]}function Z(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeVarint(xe[ue])}function J(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeSVarint(xe[ue])}function H(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeFloat(xe[ue])}function ve(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeDouble(xe[ue])}function Te(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeBoolean(xe[ue])}function ye(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeFixed32(xe[ue])}function Ve(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeSFixed32(xe[ue])}function Re(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeFixed64(xe[ue])}function Ae(xe,je){for(var ue=0;ue<xe.length;ue++)je.writeSFixed64(xe[ue])}function ae(xe,je){return(xe[je]|xe[je+1]<<8|xe[je+2]<<16)+xe[je+3]*16777216}function ee(xe,je,ue){xe[ue]=je,xe[ue+1]=je>>>8,xe[ue+2]=je>>>16,xe[ue+3]=je>>>24}function me(xe,je){return(xe[je]|xe[je+1]<<8|xe[je+2]<<16)+(xe[je+3]<<24)}function ge(xe,je,ue){for(var Pe="",we=je;we<ue;){var nt=xe[we],at=null,vt=nt>239?4:nt>223?3:nt>191?2:1;if(we+vt>ue)break;var Tt,ze,gr;vt===1?nt<128&&(at=nt):vt===2?(Tt=xe[we+1],(Tt&192)===128&&(at=(nt&31)<<6|Tt&63,at<=127&&(at=null))):vt===3?(Tt=xe[we+1],ze=xe[we+2],(Tt&192)===128&&(ze&192)===128&&(at=(nt&15)<<12|(Tt&63)<<6|ze&63,(at<=2047||at>=55296&&at<=57343)&&(at=null))):vt===4&&(Tt=xe[we+1],ze=xe[we+2],gr=xe[we+3],(Tt&192)===128&&(ze&192)===128&&(gr&192)===128&&(at=(nt&15)<<18|(Tt&63)<<12|(ze&63)<<6|gr&63,(at<=65535||at>=1114112)&&(at=null))),at===null?(at=65533,vt=1):at>65535&&(at-=65536,Pe+=String.fromCharCode(at>>>10&1023|55296),at=56320|at&1023),Pe+=String.fromCharCode(at),we+=vt}return Pe}function fe(xe,je,ue){return P.decode(xe.subarray(je,ue))}function Et(xe,je,ue){for(var Pe=0,we,nt;Pe<je.length;Pe++){if(we=je.charCodeAt(Pe),we>55295&&we<57344)if(nt)if(we<56320){xe[ue++]=239,xe[ue++]=191,xe[ue++]=189,nt=we;continue}else we=nt-55296<<10|we-56320|65536,nt=null;else{we>56319||Pe+1===je.length?(xe[ue++]=239,xe[ue++]=191,xe[ue++]=189):nt=we;continue}else nt&&(xe[ue++]=239,xe[ue++]=191,xe[ue++]=189,nt=null);we<128?xe[ue++]=we:(we<2048?xe[ue++]=we>>6|192:(we<65536?xe[ue++]=we>>12|224:(xe[ue++]=we>>18|240,xe[ue++]=we>>12&63|128),xe[ue++]=we>>6&63|128),xe[ue++]=we&63|128)}return ue}},32676:function(Ze,E,_){var D=_(34155);(function(N,h){Ze.exports=h()})(this,function(){"use strict";function N(De,X){var se={label:0,sent:function(){if(ct[0]&1)throw ct[1];return ct[1]},trys:[],ops:[]},Be,Ye,ct,sr;return sr={next:ar(0),throw:ar(1),return:ar(2)},typeof Symbol=="function"&&(sr[Symbol.iterator]=function(){return this}),sr;function ar(Wt){return function(oe){return or([Wt,oe])}}function or(Wt){if(Be)throw new TypeError("Generator is already executing.");for(;se;)try{if(Be=1,Ye&&(ct=Wt[0]&2?Ye.return:Wt[0]?Ye.throw||((ct=Ye.return)&&ct.call(Ye),0):Ye.next)&&!(ct=ct.call(Ye,Wt[1])).done)return ct;switch(Ye=0,ct&&(Wt=[Wt[0]&2,ct.value]),Wt[0]){case 0:case 1:ct=Wt;break;case 4:return se.label++,{value:Wt[1],done:!1};case 5:se.label++,Ye=Wt[1],Wt=[0];continue;case 7:Wt=se.ops.pop(),se.trys.pop();continue;default:if(ct=se.trys,!(ct=ct.length>0&&ct[ct.length-1])&&(Wt[0]===6||Wt[0]===2)){se=0;continue}if(Wt[0]===3&&(!ct||Wt[1]>ct[0]&&Wt[1]<ct[3])){se.label=Wt[1];break}if(Wt[0]===6&&se.label<ct[1]){se.label=ct[1],ct=Wt;break}if(ct&&se.label<ct[2]){se.label=ct[2],se.ops.push(Wt);break}ct[2]&&se.ops.pop(),se.trys.pop();continue}Wt=X.call(De,se)}catch(oe){Wt=[6,oe],Ye=0}finally{Be=ct=0}if(Wt[0]&5)throw Wt[1];return{value:Wt[0]?Wt[1]:void 0,done:!0}}}var h=function(){function De(X,se){this.next=null,this.key=X,this.data=se,this.left=null,this.right=null}return De}();function O(De,X){return De>X?1:De<X?-1:0}function C(De,X,se){for(var Be=new h(null,null),Ye=Be,ct=Be;;){var sr=se(De,X.key);if(sr<0){if(X.left===null)break;if(se(De,X.left.key)<0){var ar=X.left;if(X.left=ar.right,ar.right=X,X=ar,X.left===null)break}ct.left=X,ct=X,X=X.left}else if(sr>0){if(X.right===null)break;if(se(De,X.right.key)>0){var ar=X.right;if(X.right=ar.left,ar.left=X,X=ar,X.right===null)break}Ye.right=X,Ye=X,X=X.right}else break}return Ye.right=X.left,ct.left=X.right,X.left=Be.right,X.right=Be.left,X}function P(De,X,se,Be){var Ye=new h(De,X);if(se===null)return Ye.left=Ye.right=null,Ye;se=C(De,se,Be);var ct=Be(De,se.key);return ct<0?(Ye.left=se.left,Ye.right=se,se.left=null):ct>=0&&(Ye.right=se.right,Ye.left=se,se.right=null),Ye}function F(De,X,se){var Be=null,Ye=null;if(X){X=C(De,X,se);var ct=se(X.key,De);ct===0?(Be=X.left,Ye=X.right):ct<0?(Ye=X.right,X.right=null,Be=X):(Be=X.left,X.left=null,Ye=X)}return{left:Be,right:Ye}}function Y(De,X,se){return X===null?De:(De===null||(X=C(De.key,X,se),X.left=De),X)}function V(De,X,se,Be,Ye){if(De){Be(""+X+(se?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+Ye(De)+`
`);var ct=X+(se?"    ":"\u2502   ");De.left&&V(De.left,ct,!1,Be,Ye),De.right&&V(De.right,ct,!0,Be,Ye)}}var Q=function(){function De(X){X===void 0&&(X=O),this._root=null,this._size=0,this._comparator=X}return De.prototype.insert=function(X,se){return this._size++,this._root=P(X,se,this._root,this._comparator)},De.prototype.add=function(X,se){var Be=new h(X,se);this._root===null&&(Be.left=Be.right=null,this._size++,this._root=Be);var Ye=this._comparator,ct=C(X,this._root,Ye),sr=Ye(X,ct.key);return sr===0?this._root=ct:(sr<0?(Be.left=ct.left,Be.right=ct,ct.left=null):sr>0&&(Be.right=ct.right,Be.left=ct,ct.right=null),this._size++,this._root=Be),this._root},De.prototype.remove=function(X){this._root=this._remove(X,this._root,this._comparator)},De.prototype._remove=function(X,se,Be){var Ye;if(se===null)return null;se=C(X,se,Be);var ct=Be(X,se.key);return ct===0?(se.left===null?Ye=se.right:(Ye=C(X,se.left,Be),Ye.right=se.right),this._size--,Ye):se},De.prototype.pop=function(){var X=this._root;if(X){for(;X.left;)X=X.left;return this._root=C(X.key,this._root,this._comparator),this._root=this._remove(X.key,this._root,this._comparator),{key:X.key,data:X.data}}return null},De.prototype.findStatic=function(X){for(var se=this._root,Be=this._comparator;se;){var Ye=Be(X,se.key);if(Ye===0)return se;Ye<0?se=se.left:se=se.right}return null},De.prototype.find=function(X){return this._root&&(this._root=C(X,this._root,this._comparator),this._comparator(X,this._root.key)!==0)?null:this._root},De.prototype.contains=function(X){for(var se=this._root,Be=this._comparator;se;){var Ye=Be(X,se.key);if(Ye===0)return!0;Ye<0?se=se.left:se=se.right}return!1},De.prototype.forEach=function(X,se){for(var Be=this._root,Ye=[],ct=!1;!ct;)Be!==null?(Ye.push(Be),Be=Be.left):Ye.length!==0?(Be=Ye.pop(),X.call(se,Be),Be=Be.right):ct=!0;return this},De.prototype.range=function(X,se,Be,Ye){for(var ct=[],sr=this._comparator,ar=this._root,or;ct.length!==0||ar;)if(ar)ct.push(ar),ar=ar.left;else{if(ar=ct.pop(),or=sr(ar.key,se),or>0)break;if(sr(ar.key,X)>=0&&Be.call(Ye,ar))return this;ar=ar.right}return this},De.prototype.keys=function(){var X=[];return this.forEach(function(se){var Be=se.key;return X.push(Be)}),X},De.prototype.values=function(){var X=[];return this.forEach(function(se){var Be=se.data;return X.push(Be)}),X},De.prototype.min=function(){return this._root?this.minNode(this._root).key:null},De.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},De.prototype.minNode=function(X){if(X===void 0&&(X=this._root),X)for(;X.left;)X=X.left;return X},De.prototype.maxNode=function(X){if(X===void 0&&(X=this._root),X)for(;X.right;)X=X.right;return X},De.prototype.at=function(X){for(var se=this._root,Be=!1,Ye=0,ct=[];!Be;)if(se)ct.push(se),se=se.left;else if(ct.length>0){if(se=ct.pop(),Ye===X)return se;Ye++,se=se.right}else Be=!0;return null},De.prototype.next=function(X){var se=this._root,Be=null;if(X.right){for(Be=X.right;Be.left;)Be=Be.left;return Be}for(var Ye=this._comparator;se;){var ct=Ye(X.key,se.key);if(ct===0)break;ct<0?(Be=se,se=se.left):se=se.right}return Be},De.prototype.prev=function(X){var se=this._root,Be=null;if(X.left!==null){for(Be=X.left;Be.right;)Be=Be.right;return Be}for(var Ye=this._comparator;se;){var ct=Ye(X.key,se.key);if(ct===0)break;ct<0?se=se.left:(Be=se,se=se.right)}return Be},De.prototype.clear=function(){return this._root=null,this._size=0,this},De.prototype.toList=function(){return U(this._root)},De.prototype.load=function(X,se,Be){se===void 0&&(se=[]),Be===void 0&&(Be=!1);var Ye=X.length,ct=this._comparator;if(Be&&H(X,se,0,Ye-1,ct),this._root===null)this._root=k(X,se,0,Ye),this._size=Ye;else{var sr=J(this.toList(),K(X,se),ct);Ye=this._size+Ye,this._root=Z({head:sr},0,Ye)}return this},De.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(De.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(De.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),De.prototype.toString=function(X){X===void 0&&(X=function(Be){return String(Be.key)});var se=[];return V(this._root,"",!0,function(Be){return se.push(Be)},X),se.join("")},De.prototype.update=function(X,se,Be){var Ye=this._comparator,ct=F(X,this._root,Ye),sr=ct.left,ar=ct.right;Ye(X,se)<0?ar=P(se,Be,ar,Ye):sr=P(se,Be,sr,Ye),this._root=Y(sr,ar,Ye)},De.prototype.split=function(X){return F(X,this._root,this._comparator)},De.prototype[Symbol.iterator]=function(){var X,se,Be;return N(this,function(Ye){switch(Ye.label){case 0:X=this._root,se=[],Be=!1,Ye.label=1;case 1:return Be?[3,6]:X===null?[3,2]:(se.push(X),X=X.left,[3,5]);case 2:return se.length===0?[3,4]:(X=se.pop(),[4,X]);case 3:return Ye.sent(),X=X.right,[3,5];case 4:Be=!0,Ye.label=5;case 5:return[3,1];case 6:return[2]}})},De}();function k(De,X,se,Be){var Ye=Be-se;if(Ye>0){var ct=se+Math.floor(Ye/2),sr=De[ct],ar=X[ct],or=new h(sr,ar);return or.left=k(De,X,se,ct),or.right=k(De,X,ct+1,Be),or}return null}function K(De,X){for(var se=new h(null,null),Be=se,Ye=0;Ye<De.length;Ye++)Be=Be.next=new h(De[Ye],X[Ye]);return Be.next=null,se.next}function U(De){for(var X=De,se=[],Be=!1,Ye=new h(null,null),ct=Ye;!Be;)X?(se.push(X),X=X.left):se.length>0?(X=ct=ct.next=se.pop(),X=X.right):Be=!0;return ct.next=null,Ye.next}function Z(De,X,se){var Be=se-X;if(Be>0){var Ye=X+Math.floor(Be/2),ct=Z(De,X,Ye),sr=De.head;return sr.left=ct,De.head=De.head.next,sr.right=Z(De,Ye+1,se),sr}return null}function J(De,X,se){for(var Be=new h(null,null),Ye=Be,ct=De,sr=X;ct!==null&&sr!==null;)se(ct.key,sr.key)<0?(Ye.next=ct,ct=ct.next):(Ye.next=sr,sr=sr.next),Ye=Ye.next;return ct!==null?Ye.next=ct:sr!==null&&(Ye.next=sr),Be.next}function H(De,X,se,Be,Ye){if(!(se>=Be)){for(var ct=De[se+Be>>1],sr=se-1,ar=Be+1;;){do sr++;while(Ye(De[sr],ct)<0);do ar--;while(Ye(De[ar],ct)>0);if(sr>=ar)break;var or=De[sr];De[sr]=De[ar],De[ar]=or,or=X[sr],X[sr]=X[ar],X[ar]=or}H(De,X,se,ar,Ye),H(De,X,ar+1,Be,Ye)}}const ve=(De,X)=>De.ll.x<=X.x&&X.x<=De.ur.x&&De.ll.y<=X.y&&X.y<=De.ur.y,Te=(De,X)=>{if(X.ur.x<De.ll.x||De.ur.x<X.ll.x||X.ur.y<De.ll.y||De.ur.y<X.ll.y)return null;const se=De.ll.x<X.ll.x?X.ll.x:De.ll.x,Be=De.ur.x<X.ur.x?De.ur.x:X.ur.x,Ye=De.ll.y<X.ll.y?X.ll.y:De.ll.y,ct=De.ur.y<X.ur.y?De.ur.y:X.ur.y;return{ll:{x:se,y:Ye},ur:{x:Be,y:ct}}};let ye=Number.EPSILON;ye===void 0&&(ye=Math.pow(2,-52));const Ve=ye*ye,Re=(De,X)=>{if(-ye<De&&De<ye&&-ye<X&&X<ye)return 0;const se=De-X;return se*se<Ve*De*X?0:De<X?-1:1};class Ae{constructor(){this.reset()}reset(){this.xRounder=new ae,this.yRounder=new ae}round(X,se){return{x:this.xRounder.round(X),y:this.yRounder.round(se)}}}class ae{constructor(){this.tree=new Q,this.round(0)}round(X){const se=this.tree.add(X),Be=this.tree.prev(se);if(Be!==null&&Re(se.key,Be.key)===0)return this.tree.remove(X),Be.key;const Ye=this.tree.next(se);return Ye!==null&&Re(se.key,Ye.key)===0?(this.tree.remove(X),Ye.key):X}}const ee=new Ae,me=11102230246251565e-32,ge=134217729,fe=(3+8*me)*me;function Et(De,X,se,Be,Ye){let ct,sr,ar,or,Wt=X[0],oe=Be[0],ie=0,be=0;oe>Wt==oe>-Wt?(ct=Wt,Wt=X[++ie]):(ct=oe,oe=Be[++be]);let ke=0;if(ie<De&&be<se)for(oe>Wt==oe>-Wt?(sr=Wt+ct,ar=ct-(sr-Wt),Wt=X[++ie]):(sr=oe+ct,ar=ct-(sr-oe),oe=Be[++be]),ct=sr,ar!==0&&(Ye[ke++]=ar);ie<De&&be<se;)oe>Wt==oe>-Wt?(sr=ct+Wt,or=sr-ct,ar=ct-(sr-or)+(Wt-or),Wt=X[++ie]):(sr=ct+oe,or=sr-ct,ar=ct-(sr-or)+(oe-or),oe=Be[++be]),ct=sr,ar!==0&&(Ye[ke++]=ar);for(;ie<De;)sr=ct+Wt,or=sr-ct,ar=ct-(sr-or)+(Wt-or),Wt=X[++ie],ct=sr,ar!==0&&(Ye[ke++]=ar);for(;be<se;)sr=ct+oe,or=sr-ct,ar=ct-(sr-or)+(oe-or),oe=Be[++be],ct=sr,ar!==0&&(Ye[ke++]=ar);return(ct!==0||ke===0)&&(Ye[ke++]=ct),ke}function xe(De,X){let se=X[0];for(let Be=1;Be<De;Be++)se+=X[Be];return se}function je(De){return new Float64Array(De)}const ue=(3+16*me)*me,Pe=(2+12*me)*me,we=(9+64*me)*me*me,nt=je(4),at=je(8),vt=je(12),Tt=je(16),ze=je(4);function gr(De,X,se,Be,Ye,ct,sr){let ar,or,Wt,oe,ie,be,ke,qe,mt,kt,$e,Ge,We,G,rt,ft,bt,Gt;const lr=De-Ye,Ht=se-Ye,Cr=X-ct,hr=Be-ct;G=lr*hr,be=ge*lr,ke=be-(be-lr),qe=lr-ke,be=ge*hr,mt=be-(be-hr),kt=hr-mt,rt=qe*kt-(G-ke*mt-qe*mt-ke*kt),ft=Cr*Ht,be=ge*Cr,ke=be-(be-Cr),qe=Cr-ke,be=ge*Ht,mt=be-(be-Ht),kt=Ht-mt,bt=qe*kt-(ft-ke*mt-qe*mt-ke*kt),$e=rt-bt,ie=rt-$e,nt[0]=rt-($e+ie)+(ie-bt),Ge=G+$e,ie=Ge-G,We=G-(Ge-ie)+($e-ie),$e=We-ft,ie=We-$e,nt[1]=We-($e+ie)+(ie-ft),Gt=Ge+$e,ie=Gt-Ge,nt[2]=Ge-(Gt-ie)+($e-ie),nt[3]=Gt;let Dr=xe(4,nt),Rn=Pe*sr;if(Dr>=Rn||-Dr>=Rn||(ie=De-lr,ar=De-(lr+ie)+(ie-Ye),ie=se-Ht,Wt=se-(Ht+ie)+(ie-Ye),ie=X-Cr,or=X-(Cr+ie)+(ie-ct),ie=Be-hr,oe=Be-(hr+ie)+(ie-ct),ar===0&&or===0&&Wt===0&&oe===0)||(Rn=we*sr+fe*Math.abs(Dr),Dr+=lr*oe+hr*ar-(Cr*Wt+Ht*or),Dr>=Rn||-Dr>=Rn))return Dr;G=ar*hr,be=ge*ar,ke=be-(be-ar),qe=ar-ke,be=ge*hr,mt=be-(be-hr),kt=hr-mt,rt=qe*kt-(G-ke*mt-qe*mt-ke*kt),ft=or*Ht,be=ge*or,ke=be-(be-or),qe=or-ke,be=ge*Ht,mt=be-(be-Ht),kt=Ht-mt,bt=qe*kt-(ft-ke*mt-qe*mt-ke*kt),$e=rt-bt,ie=rt-$e,ze[0]=rt-($e+ie)+(ie-bt),Ge=G+$e,ie=Ge-G,We=G-(Ge-ie)+($e-ie),$e=We-ft,ie=We-$e,ze[1]=We-($e+ie)+(ie-ft),Gt=Ge+$e,ie=Gt-Ge,ze[2]=Ge-(Gt-ie)+($e-ie),ze[3]=Gt;const on=Et(4,nt,4,ze,at);G=lr*oe,be=ge*lr,ke=be-(be-lr),qe=lr-ke,be=ge*oe,mt=be-(be-oe),kt=oe-mt,rt=qe*kt-(G-ke*mt-qe*mt-ke*kt),ft=Cr*Wt,be=ge*Cr,ke=be-(be-Cr),qe=Cr-ke,be=ge*Wt,mt=be-(be-Wt),kt=Wt-mt,bt=qe*kt-(ft-ke*mt-qe*mt-ke*kt),$e=rt-bt,ie=rt-$e,ze[0]=rt-($e+ie)+(ie-bt),Ge=G+$e,ie=Ge-G,We=G-(Ge-ie)+($e-ie),$e=We-ft,ie=We-$e,ze[1]=We-($e+ie)+(ie-ft),Gt=Ge+$e,ie=Gt-Ge,ze[2]=Ge-(Gt-ie)+($e-ie),ze[3]=Gt;const fi=Et(on,at,4,ze,vt);G=ar*oe,be=ge*ar,ke=be-(be-ar),qe=ar-ke,be=ge*oe,mt=be-(be-oe),kt=oe-mt,rt=qe*kt-(G-ke*mt-qe*mt-ke*kt),ft=or*Wt,be=ge*or,ke=be-(be-or),qe=or-ke,be=ge*Wt,mt=be-(be-Wt),kt=Wt-mt,bt=qe*kt-(ft-ke*mt-qe*mt-ke*kt),$e=rt-bt,ie=rt-$e,ze[0]=rt-($e+ie)+(ie-bt),Ge=G+$e,ie=Ge-G,We=G-(Ge-ie)+($e-ie),$e=We-ft,ie=We-$e,ze[1]=We-($e+ie)+(ie-ft),Gt=Ge+$e,ie=Gt-Ge,ze[2]=Ge-(Gt-ie)+($e-ie),ze[3]=Gt;const Mi=Et(fi,vt,4,ze,Tt);return Tt[Mi-1]}function At(De,X,se,Be,Ye,ct){const sr=(X-ct)*(se-Ye),ar=(De-Ye)*(Be-ct),or=sr-ar,Wt=Math.abs(sr+ar);return Math.abs(or)>=ue*Wt?or:-gr(De,X,se,Be,Ye,ct,Wt)}const hn=(De,X)=>De.x*X.y-De.y*X.x,Wr=(De,X)=>De.x*X.x+De.y*X.y,vr=(De,X,se)=>{const Be=At(De.x,De.y,X.x,X.y,se.x,se.y);return Be>0?-1:Be<0?1:0},dn=De=>Math.sqrt(Wr(De,De)),tn=(De,X,se)=>{const Be={x:X.x-De.x,y:X.y-De.y},Ye={x:se.x-De.x,y:se.y-De.y};return hn(Ye,Be)/dn(Ye)/dn(Be)},un=(De,X,se)=>{const Be={x:X.x-De.x,y:X.y-De.y},Ye={x:se.x-De.x,y:se.y-De.y};return Wr(Ye,Be)/dn(Ye)/dn(Be)},yn=(De,X,se)=>X.y===0?null:{x:De.x+X.x/X.y*(se-De.y),y:se},Vt=(De,X,se)=>X.x===0?null:{x:se,y:De.y+X.y/X.x*(se-De.x)},dr=(De,X,se,Be)=>{if(X.x===0)return Vt(se,Be,De.x);if(Be.x===0)return Vt(De,X,se.x);if(X.y===0)return yn(se,Be,De.y);if(Be.y===0)return yn(De,X,se.y);const Ye=hn(X,Be);if(Ye==0)return null;const ct={x:se.x-De.x,y:se.y-De.y},sr=hn(ct,X)/Ye,ar=hn(ct,Be)/Ye,or=De.x+ar*X.x,Wt=se.x+sr*Be.x,oe=De.y+ar*X.y,ie=se.y+sr*Be.y,be=(or+Wt)/2,ke=(oe+ie)/2;return{x:be,y:ke}};class wt{static compare(X,se){const Be=wt.comparePoints(X.point,se.point);return Be!==0?Be:(X.point!==se.point&&X.link(se),X.isLeft!==se.isLeft?X.isLeft?1:-1:wr.compare(X.segment,se.segment))}static comparePoints(X,se){return X.x<se.x?-1:X.x>se.x?1:X.y<se.y?-1:X.y>se.y?1:0}constructor(X,se){X.events===void 0?X.events=[this]:X.events.push(this),this.point=X,this.isLeft=se}link(X){if(X.point===this.point)throw new Error("Tried to link already linked events");const se=X.point.events;for(let Be=0,Ye=se.length;Be<Ye;Be++){const ct=se[Be];this.point.events.push(ct),ct.point=this.point}this.checkForConsuming()}checkForConsuming(){const X=this.point.events.length;for(let se=0;se<X;se++){const Be=this.point.events[se];if(Be.segment.consumedBy===void 0)for(let Ye=se+1;Ye<X;Ye++){const ct=this.point.events[Ye];ct.consumedBy===void 0&&Be.otherSE.point.events===ct.otherSE.point.events&&Be.segment.consume(ct.segment)}}}getAvailableLinkedEvents(){const X=[];for(let se=0,Be=this.point.events.length;se<Be;se++){const Ye=this.point.events[se];Ye!==this&&!Ye.segment.ringOut&&Ye.segment.isInResult()&&X.push(Ye)}return X}getLeftmostComparator(X){const se=new Map,Be=Ye=>{const ct=Ye.otherSE;se.set(Ye,{sine:tn(this.point,X.point,ct.point),cosine:un(this.point,X.point,ct.point)})};return(Ye,ct)=>{se.has(Ye)||Be(Ye),se.has(ct)||Be(ct);const{sine:sr,cosine:ar}=se.get(Ye),{sine:or,cosine:Wt}=se.get(ct);return sr>=0&&or>=0?ar<Wt?1:ar>Wt?-1:0:sr<0&&or<0?ar<Wt?-1:ar>Wt?1:0:or<sr?-1:or>sr?1:0}}}let He=0;class wr{static compare(X,se){const Be=X.leftSE.point.x,Ye=se.leftSE.point.x,ct=X.rightSE.point.x,sr=se.rightSE.point.x;if(sr<Be)return 1;if(ct<Ye)return-1;const ar=X.leftSE.point.y,or=se.leftSE.point.y,Wt=X.rightSE.point.y,oe=se.rightSE.point.y;if(Be<Ye){if(or<ar&&or<Wt)return 1;if(or>ar&&or>Wt)return-1;const ie=X.comparePoint(se.leftSE.point);if(ie<0)return 1;if(ie>0)return-1;const be=se.comparePoint(X.rightSE.point);return be!==0?be:-1}if(Be>Ye){if(ar<or&&ar<oe)return-1;if(ar>or&&ar>oe)return 1;const ie=se.comparePoint(X.leftSE.point);if(ie!==0)return ie;const be=X.comparePoint(se.rightSE.point);return be<0?1:be>0?-1:1}if(ar<or)return-1;if(ar>or)return 1;if(ct<sr){const ie=se.comparePoint(X.rightSE.point);if(ie!==0)return ie}if(ct>sr){const ie=X.comparePoint(se.rightSE.point);if(ie<0)return 1;if(ie>0)return-1}if(ct!==sr){const ie=Wt-ar,be=ct-Be,ke=oe-or,qe=sr-Ye;if(ie>be&&ke<qe)return 1;if(ie<be&&ke>qe)return-1}return ct>sr?1:ct<sr||Wt<oe?-1:Wt>oe?1:X.id<se.id?-1:X.id>se.id?1:0}constructor(X,se,Be,Ye){this.id=++He,this.leftSE=X,X.segment=this,X.otherSE=se,this.rightSE=se,se.segment=this,se.otherSE=X,this.rings=Be,this.windings=Ye}static fromRing(X,se,Be){let Ye,ct,sr;const ar=wt.comparePoints(X,se);if(ar<0)Ye=X,ct=se,sr=1;else if(ar>0)Ye=se,ct=X,sr=-1;else throw new Error(`Tried to create degenerate segment at [${X.x}, ${X.y}]`);const or=new wt(Ye,!0),Wt=new wt(ct,!1);return new wr(or,Wt,[Be],[sr])}replaceRightSE(X){this.rightSE=X,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const X=this.leftSE.point.y,se=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:X<se?X:se},ur:{x:this.rightSE.point.x,y:X>se?X:se}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(X){return X.x===this.leftSE.point.x&&X.y===this.leftSE.point.y||X.x===this.rightSE.point.x&&X.y===this.rightSE.point.y}comparePoint(X){if(this.isAnEndpoint(X))return 0;const se=this.leftSE.point,Be=this.rightSE.point,Ye=this.vector();if(se.x===Be.x)return X.x===se.x?0:X.x<se.x?1:-1;const ct=(X.y-se.y)/Ye.y,sr=se.x+ct*Ye.x;if(X.x===sr)return 0;const ar=(X.x-se.x)/Ye.x,or=se.y+ar*Ye.y;return X.y===or?0:X.y<or?-1:1}getIntersection(X){const se=this.bbox(),Be=X.bbox(),Ye=Te(se,Be);if(Ye===null)return null;const ct=this.leftSE.point,sr=this.rightSE.point,ar=X.leftSE.point,or=X.rightSE.point,Wt=ve(se,ar)&&this.comparePoint(ar)===0,oe=ve(Be,ct)&&X.comparePoint(ct)===0,ie=ve(se,or)&&this.comparePoint(or)===0,be=ve(Be,sr)&&X.comparePoint(sr)===0;if(oe&&Wt)return be&&!ie?sr:!be&&ie?or:null;if(oe)return ie&&ct.x===or.x&&ct.y===or.y?null:ct;if(Wt)return be&&sr.x===ar.x&&sr.y===ar.y?null:ar;if(be&&ie)return null;if(be)return sr;if(ie)return or;const ke=dr(ct,this.vector(),ar,X.vector());return ke===null||!ve(Ye,ke)?null:ee.round(ke.x,ke.y)}split(X){const se=[],Be=X.events!==void 0,Ye=new wt(X,!0),ct=new wt(X,!1),sr=this.rightSE;this.replaceRightSE(ct),se.push(ct),se.push(Ye);const ar=new wr(Ye,sr,this.rings.slice(),this.windings.slice());return wt.comparePoints(ar.leftSE.point,ar.rightSE.point)>0&&ar.swapEvents(),wt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Be&&(Ye.checkForConsuming(),ct.checkForConsuming()),se}swapEvents(){const X=this.rightSE;this.rightSE=this.leftSE,this.leftSE=X,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let se=0,Be=this.windings.length;se<Be;se++)this.windings[se]*=-1}consume(X){let se=this,Be=X;for(;se.consumedBy;)se=se.consumedBy;for(;Be.consumedBy;)Be=Be.consumedBy;const Ye=wr.compare(se,Be);if(Ye!==0){if(Ye>0){const ct=se;se=Be,Be=ct}if(se.prev===Be){const ct=se;se=Be,Be=ct}for(let ct=0,sr=Be.rings.length;ct<sr;ct++){const ar=Be.rings[ct],or=Be.windings[ct],Wt=se.rings.indexOf(ar);Wt===-1?(se.rings.push(ar),se.windings.push(or)):se.windings[Wt]+=or}Be.rings=null,Be.windings=null,Be.consumedBy=se,Be.leftSE.consumedBy=se.leftSE,Be.rightSE.consumedBy=se.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const X=this.prev.consumedBy||this.prev;this._beforeState=X.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const X=this.beforeState();this._afterState={rings:X.rings.slice(0),windings:X.windings.slice(0),multiPolys:[]};const se=this._afterState.rings,Be=this._afterState.windings,Ye=this._afterState.multiPolys;for(let ar=0,or=this.rings.length;ar<or;ar++){const Wt=this.rings[ar],oe=this.windings[ar],ie=se.indexOf(Wt);ie===-1?(se.push(Wt),Be.push(oe)):Be[ie]+=oe}const ct=[],sr=[];for(let ar=0,or=se.length;ar<or;ar++){if(Be[ar]===0)continue;const Wt=se[ar],oe=Wt.poly;if(sr.indexOf(oe)===-1)if(Wt.isExterior)ct.push(oe);else{sr.indexOf(oe)===-1&&sr.push(oe);const ie=ct.indexOf(Wt.poly);ie!==-1&&ct.splice(ie,1)}}for(let ar=0,or=ct.length;ar<or;ar++){const Wt=ct[ar].multiPoly;Ye.indexOf(Wt)===-1&&Ye.push(Wt)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const X=this.beforeState().multiPolys,se=this.afterState().multiPolys;switch(zt.type){case"union":{const Be=X.length===0,Ye=se.length===0;this._isInResult=Be!==Ye;break}case"intersection":{let Be,Ye;X.length<se.length?(Be=X.length,Ye=se.length):(Be=se.length,Ye=X.length),this._isInResult=Ye===zt.numMultiPolys&&Be<Ye;break}case"xor":{const Be=Math.abs(X.length-se.length);this._isInResult=Be%2===1;break}case"difference":{const Be=Ye=>Ye.length===1&&Ye[0].isSubject;this._isInResult=Be(X)!==Be(se);break}default:throw new Error(`Unrecognized operation type found ${zt.type}`)}return this._isInResult}}class Ne{constructor(X,se,Be){if(!Array.isArray(X)||X.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=se,this.isExterior=Be,this.segments=[],typeof X[0][0]!="number"||typeof X[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const Ye=ee.round(X[0][0],X[0][1]);this.bbox={ll:{x:Ye.x,y:Ye.y},ur:{x:Ye.x,y:Ye.y}};let ct=Ye;for(let sr=1,ar=X.length;sr<ar;sr++){if(typeof X[sr][0]!="number"||typeof X[sr][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let or=ee.round(X[sr][0],X[sr][1]);or.x===ct.x&&or.y===ct.y||(this.segments.push(wr.fromRing(ct,or,this)),or.x<this.bbox.ll.x&&(this.bbox.ll.x=or.x),or.y<this.bbox.ll.y&&(this.bbox.ll.y=or.y),or.x>this.bbox.ur.x&&(this.bbox.ur.x=or.x),or.y>this.bbox.ur.y&&(this.bbox.ur.y=or.y),ct=or)}(Ye.x!==ct.x||Ye.y!==ct.y)&&this.segments.push(wr.fromRing(ct,Ye,this))}getSweepEvents(){const X=[];for(let se=0,Be=this.segments.length;se<Be;se++){const Ye=this.segments[se];X.push(Ye.leftSE),X.push(Ye.rightSE)}return X}}class Xr{constructor(X,se){if(!Array.isArray(X))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ne(X[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let Be=1,Ye=X.length;Be<Ye;Be++){const ct=new Ne(X[Be],this,!1);ct.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ct.bbox.ll.x),ct.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ct.bbox.ll.y),ct.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ct.bbox.ur.x),ct.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ct.bbox.ur.y),this.interiorRings.push(ct)}this.multiPoly=se}getSweepEvents(){const X=this.exteriorRing.getSweepEvents();for(let se=0,Be=this.interiorRings.length;se<Be;se++){const Ye=this.interiorRings[se].getSweepEvents();for(let ct=0,sr=Ye.length;ct<sr;ct++)X.push(Ye[ct])}return X}}class Er{constructor(X,se){if(!Array.isArray(X))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof X[0][0][0]=="number"&&(X=[X])}catch(Be){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let Be=0,Ye=X.length;Be<Ye;Be++){const ct=new Xr(X[Be],this);ct.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ct.bbox.ll.x),ct.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ct.bbox.ll.y),ct.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ct.bbox.ur.x),ct.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ct.bbox.ur.y),this.polys.push(ct)}this.isSubject=se}getSweepEvents(){const X=[];for(let se=0,Be=this.polys.length;se<Be;se++){const Ye=this.polys[se].getSweepEvents();for(let ct=0,sr=Ye.length;ct<sr;ct++)X.push(Ye[ct])}return X}}class Ue{static factory(X){const se=[];for(let Be=0,Ye=X.length;Be<Ye;Be++){const ct=X[Be];if(!ct.isInResult()||ct.ringOut)continue;let sr=null,ar=ct.leftSE,or=ct.rightSE;const Wt=[ar],oe=ar.point,ie=[];for(;sr=ar,ar=or,Wt.push(ar),ar.point!==oe;)for(;;){const be=ar.getAvailableLinkedEvents();if(be.length===0){const mt=Wt[0].point,kt=Wt[Wt.length-1].point;throw new Error(`Unable to complete output ring starting at [${mt.x}, ${mt.y}]. Last matching segment found ends at [${kt.x}, ${kt.y}].`)}if(be.length===1){or=be[0].otherSE;break}let ke=null;for(let mt=0,kt=ie.length;mt<kt;mt++)if(ie[mt].point===ar.point){ke=mt;break}if(ke!==null){const mt=ie.splice(ke)[0],kt=Wt.splice(mt.index);kt.unshift(kt[0].otherSE),se.push(new Ue(kt.reverse()));continue}ie.push({index:Wt.length,point:ar.point});const qe=ar.getLeftmostComparator(sr);or=be.sort(qe)[0].otherSE;break}se.push(new Ue(Wt))}return se}constructor(X){this.events=X;for(let se=0,Be=X.length;se<Be;se++)X[se].segment.ringOut=this;this.poly=null}getGeom(){let X=this.events[0].point;const se=[X];for(let Wt=1,oe=this.events.length-1;Wt<oe;Wt++){const ie=this.events[Wt].point,be=this.events[Wt+1].point;vr(ie,X,be)!==0&&(se.push(ie),X=ie)}if(se.length===1)return null;const Be=se[0],Ye=se[1];vr(Be,X,Ye)===0&&se.shift(),se.push(se[0]);const ct=this.isExteriorRing()?1:-1,sr=this.isExteriorRing()?0:se.length-1,ar=this.isExteriorRing()?se.length:-1,or=[];for(let Wt=sr;Wt!=ar;Wt+=ct)or.push([se[Wt].x,se[Wt].y]);return or}isExteriorRing(){if(this._isExteriorRing===void 0){const X=this.enclosingRing();this._isExteriorRing=X?!X.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let X=this.events[0];for(let Ye=1,ct=this.events.length;Ye<ct;Ye++){const sr=this.events[Ye];wt.compare(X,sr)>0&&(X=sr)}let se=X.segment.prevInResult(),Be=se?se.prevInResult():null;for(;;){if(!se)return null;if(!Be)return se.ringOut;if(Be.ringOut!==se.ringOut)return Be.ringOut.enclosingRing()!==se.ringOut?se.ringOut:se.ringOut.enclosingRing();se=Be.prevInResult(),Be=se?se.prevInResult():null}}}class In{constructor(X){this.exteriorRing=X,X.poly=this,this.interiorRings=[]}addInterior(X){this.interiorRings.push(X),X.poly=this}getGeom(){const X=[this.exteriorRing.getGeom()];if(X[0]===null)return null;for(let se=0,Be=this.interiorRings.length;se<Be;se++){const Ye=this.interiorRings[se].getGeom();Ye!==null&&X.push(Ye)}return X}}class an{constructor(X){this.rings=X,this.polys=this._composePolys(X)}getGeom(){const X=[];for(let se=0,Be=this.polys.length;se<Be;se++){const Ye=this.polys[se].getGeom();Ye!==null&&X.push(Ye)}return X}_composePolys(X){const se=[];for(let Be=0,Ye=X.length;Be<Ye;Be++){const ct=X[Be];if(!ct.poly)if(ct.isExteriorRing())se.push(new In(ct));else{const sr=ct.enclosingRing();sr.poly||se.push(new In(sr)),sr.poly.addInterior(ct)}}return se}}class Qr{constructor(X){let se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wr.compare;this.queue=X,this.tree=new Q(se),this.segments=[]}process(X){const se=X.segment,Be=[];if(X.consumedBy)return X.isLeft?this.queue.remove(X.otherSE):this.tree.remove(se),Be;const Ye=X.isLeft?this.tree.add(se):this.tree.find(se);if(!Ye)throw new Error(`Unable to find segment #${se.id} [${se.leftSE.point.x}, ${se.leftSE.point.y}] -> [${se.rightSE.point.x}, ${se.rightSE.point.y}] in SweepLine tree.`);let ct=Ye,sr=Ye,ar,or;for(;ar===void 0;)ct=this.tree.prev(ct),ct===null?ar=null:ct.key.consumedBy===void 0&&(ar=ct.key);for(;or===void 0;)sr=this.tree.next(sr),sr===null?or=null:sr.key.consumedBy===void 0&&(or=sr.key);if(X.isLeft){let Wt=null;if(ar){const ie=ar.getIntersection(se);if(ie!==null&&(se.isAnEndpoint(ie)||(Wt=ie),!ar.isAnEndpoint(ie))){const be=this._splitSafely(ar,ie);for(let ke=0,qe=be.length;ke<qe;ke++)Be.push(be[ke])}}let oe=null;if(or){const ie=or.getIntersection(se);if(ie!==null&&(se.isAnEndpoint(ie)||(oe=ie),!or.isAnEndpoint(ie))){const be=this._splitSafely(or,ie);for(let ke=0,qe=be.length;ke<qe;ke++)Be.push(be[ke])}}if(Wt!==null||oe!==null){let ie=null;Wt===null?ie=oe:oe===null?ie=Wt:ie=wt.comparePoints(Wt,oe)<=0?Wt:oe,this.queue.remove(se.rightSE),Be.push(se.rightSE);const be=se.split(ie);for(let ke=0,qe=be.length;ke<qe;ke++)Be.push(be[ke])}Be.length>0?(this.tree.remove(se),Be.push(X)):(this.segments.push(se),se.prev=ar)}else{if(ar&&or){const Wt=ar.getIntersection(or);if(Wt!==null){if(!ar.isAnEndpoint(Wt)){const oe=this._splitSafely(ar,Wt);for(let ie=0,be=oe.length;ie<be;ie++)Be.push(oe[ie])}if(!or.isAnEndpoint(Wt)){const oe=this._splitSafely(or,Wt);for(let ie=0,be=oe.length;ie<be;ie++)Be.push(oe[ie])}}}this.tree.remove(se)}return Be}_splitSafely(X,se){this.tree.remove(X);const Be=X.rightSE;this.queue.remove(Be);const Ye=X.split(se);return Ye.push(Be),X.consumedBy===void 0&&this.tree.add(X),Ye}}const Dn=typeof D!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,On=typeof D!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/antadmin/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class ri{run(X,se,Be){zt.type=X,ee.reset();const Ye=[new Er(se,!0)];for(let ie=0,be=Be.length;ie<be;ie++)Ye.push(new Er(Be[ie],!1));if(zt.numMultiPolys=Ye.length,zt.type==="difference"){const ie=Ye[0];let be=1;for(;be<Ye.length;)Te(Ye[be].bbox,ie.bbox)!==null?be++:Ye.splice(be,1)}if(zt.type==="intersection")for(let ie=0,be=Ye.length;ie<be;ie++){const ke=Ye[ie];for(let qe=ie+1,mt=Ye.length;qe<mt;qe++)if(Te(ke.bbox,Ye[qe].bbox)===null)return[]}const ct=new Q(wt.compare);for(let ie=0,be=Ye.length;ie<be;ie++){const ke=Ye[ie].getSweepEvents();for(let qe=0,mt=ke.length;qe<mt;qe++)if(ct.insert(ke[qe]),ct.size>Dn)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const sr=new Qr(ct);let ar=ct.size,or=ct.pop();for(;or;){const ie=or.key;if(ct.size===ar){const ke=ie.segment;throw new Error(`Unable to pop() ${ie.isLeft?"left":"right"} SweepEvent [${ie.point.x}, ${ie.point.y}] from segment #${ke.id} [${ke.leftSE.point.x}, ${ke.leftSE.point.y}] -> [${ke.rightSE.point.x}, ${ke.rightSE.point.y}] from queue.`)}if(ct.size>Dn)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(sr.segments.length>On)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const be=sr.process(ie);for(let ke=0,qe=be.length;ke<qe;ke++){const mt=be[ke];mt.consumedBy===void 0&&ct.insert(mt)}ar=ct.size,or=ct.pop()}ee.reset();const Wt=Ue.factory(sr.segments);return new an(Wt).getGeom()}}const zt=new ri;var Wn={union:function(De){for(var X=arguments.length,se=new Array(X>1?X-1:0),Be=1;Be<X;Be++)se[Be-1]=arguments[Be];return zt.run("union",De,se)},intersection:function(De){for(var X=arguments.length,se=new Array(X>1?X-1:0),Be=1;Be<X;Be++)se[Be-1]=arguments[Be];return zt.run("intersection",De,se)},xor:function(De){for(var X=arguments.length,se=new Array(X>1?X-1:0),Be=1;Be<X;Be++)se[Be-1]=arguments[Be];return zt.run("xor",De,se)},difference:function(De){for(var X=arguments.length,se=new Array(X>1?X-1:0),Be=1;Be<X;Be++)se[Be-1]=arguments[Be];return zt.run("difference",De,se)}};return Wn})},62273:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var _={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},D=E.default=_},27590:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var _={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},D=E.default=_},45598:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=O;var N=D(_(67294)),h=_(11805);function O(C){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},F=[];return N.default.Children.forEach(C,function(Y){Y==null&&!P.keepEmpty||(Array.isArray(Y)?F=F.concat(O(Y)):(0,h.isFragment)(Y)&&Y.props?F=F.concat(O(Y.props.children,P)):F.push(Y))}),F}},3481:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.isStyleSupport=C;var N=D(_(19158)),h=function(F){if((0,N.default)()&&window.document.documentElement){var Y=Array.isArray(F)?F:[F],V=window.document.documentElement;return Y.some(function(Q){return Q in V.style})}return!1},O=function(F,Y){if(!h(F))return!1;var V=document.createElement("div"),Q=V.style[F];return V.style[F]=Y,V.style[F]!==Q};function C(P,F){return!Array.isArray(P)&&F!==void 0?O(P,F):h(P)}},27712:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var _={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(h){var O=h.keyCode;if(h.altKey&&!h.ctrlKey||h.metaKey||O>=_.F1&&O<=_.F12)return!1;switch(O){case _.ALT:case _.CAPS_LOCK:case _.CONTEXT_MENU:case _.CTRL:case _.DOWN:case _.END:case _.ESC:case _.HOME:case _.INSERT:case _.LEFT:case _.MAC_FF_META:case _.META:case _.NUMLOCK:case _.NUM_CENTER:case _.PAGE_DOWN:case _.PAGE_UP:case _.PAUSE:case _.PRINT_SCREEN:case _.RIGHT:case _.SHIFT:case _.UP:case _.WIN_KEY:case _.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(h){if(h>=_.ZERO&&h<=_.NINE||h>=_.NUM_ZERO&&h<=_.NUM_MULTIPLY||h>=_.A&&h<=_.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&h===0)return!0;switch(h){case _.SPACE:case _.QUESTION_MARK:case _.NUM_PLUS:case _.NUM_MINUS:case _.NUM_PERIOD:case _.NUM_DIVISION:case _.SEMICOLON:case _.DASH:case _.EQUALS:case _.COMMA:case _.PERIOD:case _.SLASH:case _.APOSTROPHE:case _.SINGLE_QUOTE:case _.OPEN_SQUARE_BRACKET:case _.BACKSLASH:case _.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},D=E.default=_},18545:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=h;var N=D(_(67294));function h(O){var C=N.useRef();C.current=O;var P=N.useCallback(function(){for(var F,Y=arguments.length,V=new Array(Y),Q=0;Q<Y;Q++)V[Q]=arguments[Q];return(F=C.current)===null||F===void 0?void 0:F.call.apply(F,[C].concat(V))},[]);return P}},82546:function(Ze,E,_){"use strict";var D=_(64836).default,N=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.useLayoutUpdateEffect=E.default=void 0;var h=N(_(67294)),O=D(_(19158)),C=(0,O.default)()?h.useLayoutEffect:h.useEffect,P=function(Q,k){var K=h.useRef(!0);C(function(){return Q(K.current)},k),C(function(){return K.current=!1,function(){K.current=!0}},[])},F=E.useLayoutUpdateEffect=function(Q,k){P(function(K){if(!K)return Q()},k)},Y=E.default=P},67265:function(Ze,E,_){"use strict";var D=_(75263).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=h;var N=D(_(67294));function h(O,C,P){var F=N.useRef({});return(!("value"in F.current)||P(F.current.condition,C))&&(F.current.value=O(),F.current.condition=C),F.current.value}},60869:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=F;var N=D(_(27424)),h=D(_(18545)),O=_(82546),C=D(_(78423));function P(Y){return Y!==void 0}function F(Y,V){var Q=V||{},k=Q.defaultValue,K=Q.value,U=Q.onChange,Z=Q.postState,J=(0,C.default)(function(){return P(K)?K:P(k)?typeof k=="function"?k():k:typeof Y=="function"?Y():Y}),H=(0,N.default)(J,2),ve=H[0],Te=H[1],ye=K!==void 0?K:ve,Ve=Z?Z(ye):ye,Re=(0,h.default)(U),Ae=(0,C.default)([ye]),ae=(0,N.default)(Ae,2),ee=ae[0],me=ae[1];(0,O.useLayoutUpdateEffect)(function(){var fe=ee[0];ve!==fe&&Re(ve,fe)},[ee]),(0,O.useLayoutUpdateEffect)(function(){P(K)||Te(K)},[K]);var ge=(0,h.default)(function(fe,Et){Te(fe,Et),me([ye],Et)});return[Ve,ge]}},78423:function(Ze,E,_){"use strict";var D=_(75263).default,N=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=C;var h=N(_(27424)),O=D(_(67294));function C(P){var F=O.useRef(!1),Y=O.useState(P),V=(0,h.default)(Y,2),Q=V[0],k=V[1];O.useEffect(function(){return F.current=!1,function(){F.current=!0}},[]);function K(U,Z){Z&&F.current||k(U)}return[Q,K]}},11102:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var N=D(_(18698)),h=D(_(45520));function O(P,F){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,V=new Set;function Q(k,K){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Z=V.has(k);if((0,h.default)(!Z,"Warning: There may be circular references"),Z)return!1;if(k===K)return!0;if(Y&&U>1)return!1;V.add(k);var J=U+1;if(Array.isArray(k)){if(!Array.isArray(K)||k.length!==K.length)return!1;for(var H=0;H<k.length;H++)if(!Q(k[H],K[H],J))return!1;return!0}if(k&&K&&(0,N.default)(k)==="object"&&(0,N.default)(K)==="object"){var ve=Object.keys(k);return ve.length!==Object.keys(K).length?!1:ve.every(function(Te){return Q(k[Te],K[Te],J)})}return!1}return Q(P,F)}var C=E.default=O},18475:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=h;var N=D(_(42122));function h(O,C){var P=(0,N.default)({},O);return Array.isArray(C)&&C.forEach(function(F){delete P[F]}),P}},75531:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.composeRef=F,E.fillRef=P,E.supportNodeRef=Q,E.supportRef=V,E.useComposeRef=Y;var N=D(_(18698)),h=_(67294),O=_(11805),C=D(_(67265));function P(k,K){typeof k=="function"?k(K):(0,N.default)(k)==="object"&&k&&"current"in k&&(k.current=K)}function F(){for(var k=arguments.length,K=new Array(k),U=0;U<k;U++)K[U]=arguments[U];var Z=K.filter(function(J){return J});return Z.length<=1?Z[0]:function(J){K.forEach(function(H){P(H,J)})}}function Y(){for(var k=arguments.length,K=new Array(k),U=0;U<k;U++)K[U]=arguments[U];return(0,C.default)(function(){return F.apply(void 0,K)},K,function(Z,J){return Z.length!==J.length||Z.every(function(H,ve){return H!==J[ve]})})}function V(k){var K,U,Z=(0,O.isMemo)(k)?k.type.type:k.type;return!(typeof Z=="function"&&!((K=Z.prototype)!==null&&K!==void 0&&K.render)&&Z.$$typeof!==O.ForwardRef||typeof k=="function"&&!((U=k.prototype)!==null&&U!==void 0&&U.render)&&k.$$typeof!==O.ForwardRef)}function Q(k){return!(0,h.isValidElement)(k)||(0,O.isFragment)(k)?!1:V(k)}},94787:function(Ze,E){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=_;function _(D,N){for(var h=D,O=0;O<N.length;O+=1){if(h==null)return;h=h[N[O]]}return h}},20059:function(Ze,E,_){"use strict";var D=_(64836).default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=Y,E.merge=K;var N=D(_(18698)),h=D(_(42122)),O=D(_(861)),C=D(_(51589)),P=D(_(94787));function F(U,Z,J,H){if(!Z.length)return J;var ve=(0,C.default)(Z),Te=ve[0],ye=ve.slice(1),Ve;return!U&&typeof Te=="number"?Ve=[]:Array.isArray(U)?Ve=(0,O.default)(U):Ve=(0,h.default)({},U),H&&J===void 0&&ye.length===1?delete Ve[Te][ye[0]]:Ve[Te]=F(Ve[Te],ye,J,H),Ve}function Y(U,Z,J){var H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Z.length&&H&&J===void 0&&!(0,P.default)(U,Z.slice(0,-1))?U:F(U,Z,J,H)}function V(U){return(0,N.default)(U)==="object"&&U!==null&&Object.getPrototypeOf(U)===Object.prototype}function Q(U){return Array.isArray(U)?[]:{}}var k=typeof Reflect=="undefined"?Object.keys:Reflect.ownKeys;function K(){for(var U=arguments.length,Z=new Array(U),J=0;J<U;J++)Z[J]=arguments[J];var H=Q(Z[0]);return Z.forEach(function(ve){function Te(ye,Ve){var Re=new Set(Ve),Ae=(0,P.default)(ve,ye),ae=Array.isArray(Ae);if(ae||V(Ae)){if(!Re.has(Ae)){Re.add(Ae);var ee=(0,P.default)(H,ye);ae?H=Y(H,ye,[]):(!ee||(0,N.default)(ee)!=="object")&&(H=Y(H,ye,Q(Ae))),k(Ae).forEach(function(me){Te([].concat((0,O.default)(ye),[me]),Re)})}}else H=Y(H,ye,Ae)}Te([])}),H}},81550:function(Ze){(function(E,_){Ze.exports=_()})(this,function(){"use strict";var E=function(Ee){return Ee instanceof Uint8Array||Ee instanceof Uint16Array||Ee instanceof Uint32Array||Ee instanceof Int8Array||Ee instanceof Int16Array||Ee instanceof Int32Array||Ee instanceof Float32Array||Ee instanceof Float64Array||Ee instanceof Uint8ClampedArray},_=function(Ee,pt){for(var Ut=Object.keys(pt),Pr=0;Pr<Ut.length;++Pr)Ee[Ut[Pr]]=pt[Ut[Pr]];return Ee},D=`
`;function N(Ee){return typeof atob!="undefined"?atob(Ee):"base64:"+Ee}function h(Ee){var pt=new Error("(regl) "+Ee);throw console.error(pt),pt}function O(Ee,pt){Ee||h(pt)}function C(Ee){return Ee?": "+Ee:""}function P(Ee,pt,Ut){Ee in pt||h("unknown parameter ("+Ee+")"+C(Ut)+". possible values: "+Object.keys(pt).join())}function F(Ee,pt){E(Ee)||h("invalid parameter type"+C(pt)+". must be a typed array")}function Y(Ee,pt){switch(pt){case"number":return typeof Ee=="number";case"object":return typeof Ee=="object";case"string":return typeof Ee=="string";case"boolean":return typeof Ee=="boolean";case"function":return typeof Ee=="function";case"undefined":return typeof Ee=="undefined";case"symbol":return typeof Ee=="symbol"}}function V(Ee,pt,Ut){Y(Ee,pt)||h("invalid parameter type"+C(Ut)+". expected "+pt+", got "+typeof Ee)}function Q(Ee,pt){Ee>=0&&(Ee|0)===Ee||h("invalid parameter type, ("+Ee+")"+C(pt)+". must be a nonnegative integer")}function k(Ee,pt,Ut){pt.indexOf(Ee)<0&&h("invalid value"+C(Ut)+". must be one of: "+pt)}var K=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function U(Ee){Object.keys(Ee).forEach(function(pt){K.indexOf(pt)<0&&h('invalid regl constructor argument "'+pt+'". must be one of '+K)})}function Z(Ee,pt){for(Ee=Ee+"";Ee.length<pt;)Ee=" "+Ee;return Ee}function J(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function H(Ee,pt){this.number=Ee,this.line=pt,this.errors=[]}function ve(Ee,pt,Ut){this.file=Ee,this.line=pt,this.message=Ut}function Te(){var Ee=new Error,pt=(Ee.stack||Ee).toString(),Ut=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(pt);if(Ut)return Ut[1];var Pr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(pt);return Pr?Pr[1]:"unknown"}function ye(){var Ee=new Error,pt=(Ee.stack||Ee).toString(),Ut=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(pt);if(Ut)return Ut[1];var Pr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(pt);return Pr?Pr[1]:"unknown"}function Ve(Ee,pt){var Ut=Ee.split(`
`),Pr=1,ln=0,Lr={unknown:new J,0:new J};Lr.unknown.name=Lr[0].name=pt||Te(),Lr.unknown.lines.push(new H(0,""));for(var Tr=0;Tr<Ut.length;++Tr){var Ln=Ut[Tr],An=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ln);if(An)switch(An[1]){case"line":var $n=/(\d+)(\s+\d+)?/.exec(An[2]);$n&&(Pr=$n[1]|0,$n[2]&&(ln=$n[2]|0,ln in Lr||(Lr[ln]=new J)));break;case"define":var Fn=/SHADER_NAME(_B64)?\s+(.*)$/.exec(An[2]);Fn&&(Lr[ln].name=Fn[1]?N(Fn[2]):Fn[2]);break}Lr[ln].lines.push(new H(Pr++,Ln))}return Object.keys(Lr).forEach(function(jn){var Kn=Lr[jn];Kn.lines.forEach(function(Cn){Kn.index[Cn.number]=Cn})}),Lr}function Re(Ee){var pt=[];return Ee.split(`
`).forEach(function(Ut){if(!(Ut.length<5)){var Pr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ut);Pr?pt.push(new ve(Pr[1]|0,Pr[2]|0,Pr[3].trim())):Ut.length>0&&pt.push(new ve("unknown",0,Ut))}}),pt}function Ae(Ee,pt){pt.forEach(function(Ut){var Pr=Ee[Ut.file];if(Pr){var ln=Pr.index[Ut.line];if(ln){ln.errors.push(Ut),Pr.hasErrors=!0;return}}Ee.unknown.hasErrors=!0,Ee.unknown.lines[0].errors.push(Ut)})}function ae(Ee,pt,Ut,Pr,ln){if(!Ee.getShaderParameter(pt,Ee.COMPILE_STATUS)){var Lr=Ee.getShaderInfoLog(pt),Tr=Pr===Ee.FRAGMENT_SHADER?"fragment":"vertex";je(Ut,"string",Tr+" shader source must be a string",ln);var Ln=Ve(Ut,ln),An=Re(Lr);Ae(Ln,An),Object.keys(Ln).forEach(function($n){var Fn=Ln[$n];if(!Fn.hasErrors)return;var jn=[""],Kn=[""];function Cn(Vn,_r){jn.push(Vn),Kn.push(_r||"")}Cn("file number "+$n+": "+Fn.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Fn.lines.forEach(function(Vn){if(Vn.errors.length>0){Cn(Z(Vn.number,4)+"|  ","background-color:yellow; font-weight:bold"),Cn(Vn.line+D,"color:red; background-color:yellow; font-weight:bold");var _r=0;Vn.errors.forEach(function(Gr){var Bn=Gr.message,ni=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Bn);if(ni){var bn=ni[1];switch(Bn=ni[2],bn){case"assign":bn="=";break}_r=Math.max(Vn.line.indexOf(bn,_r),0)}else _r=0;Cn(Z("| ",6)),Cn(Z("^^^",_r+3)+D,"font-weight:bold"),Cn(Z("| ",6)),Cn(Bn+D,"font-weight:bold")}),Cn(Z("| ",6)+D)}else Cn(Z(Vn.number,4)+"|  "),Cn(Vn.line+D,"color:red")}),typeof document!="undefined"&&!window.chrome?(Kn[0]=jn.join("%c"),console.log.apply(console,Kn)):console.log(jn.join(""))}),O.raise("Error compiling "+Tr+" shader, "+Ln[0].name)}}function ee(Ee,pt,Ut,Pr,ln){if(!Ee.getProgramParameter(pt,Ee.LINK_STATUS)){var Lr=Ee.getProgramInfoLog(pt),Tr=Ve(Ut,ln),Ln=Ve(Pr,ln),An='Error linking program with vertex shader, "'+Ln[0].name+'", and fragment shader "'+Tr[0].name+'"';typeof document!="undefined"?console.log("%c"+An+D+"%c"+Lr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(An+D+Lr),O.raise(An)}}function me(Ee){Ee._commandRef=Te()}function ge(Ee,pt,Ut,Pr){me(Ee);function ln(An){return An?Pr.id(An):0}Ee._fragId=ln(Ee.static.frag),Ee._vertId=ln(Ee.static.vert);function Lr(An,$n){Object.keys($n).forEach(function(Fn){An[Pr.id(Fn)]=!0})}var Tr=Ee._uniformSet={};Lr(Tr,pt.static),Lr(Tr,pt.dynamic);var Ln=Ee._attributeSet={};Lr(Ln,Ut.static),Lr(Ln,Ut.dynamic),Ee._hasCount="count"in Ee.static||"count"in Ee.dynamic||"elements"in Ee.static||"elements"in Ee.dynamic}function fe(Ee,pt){var Ut=ye();h(Ee+" in command "+(pt||Te())+(Ut==="unknown"?"":" called from "+Ut))}function Et(Ee,pt,Ut){Ee||fe(pt,Ut||Te())}function xe(Ee,pt,Ut,Pr){Ee in pt||fe("unknown parameter ("+Ee+")"+C(Ut)+". possible values: "+Object.keys(pt).join(),Pr||Te())}function je(Ee,pt,Ut,Pr){Y(Ee,pt)||fe("invalid parameter type"+C(Ut)+". expected "+pt+", got "+typeof Ee,Pr||Te())}function ue(Ee){Ee()}function Pe(Ee,pt,Ut){Ee.texture?k(Ee.texture._texture.internalformat,pt,"unsupported texture format for attachment"):k(Ee.renderbuffer._renderbuffer.format,Ut,"unsupported renderbuffer format for attachment")}var we=33071,nt=9728,at=9984,vt=9985,Tt=9986,ze=9987,gr=5120,At=5121,hn=5122,Wr=5123,vr=5124,dn=5125,tn=5126,un=32819,yn=32820,Vt=33635,dr=34042,wt=36193,He={};He[gr]=He[At]=1,He[hn]=He[Wr]=He[wt]=He[Vt]=He[un]=He[yn]=2,He[vr]=He[dn]=He[tn]=He[dr]=4;function wr(Ee,pt){return Ee===yn||Ee===un||Ee===Vt?2:Ee===dr?4:He[Ee]*pt}function Ne(Ee){return!(Ee&Ee-1)&&!!Ee}function Xr(Ee,pt,Ut){var Pr,ln=pt.width,Lr=pt.height,Tr=pt.channels;O(ln>0&&ln<=Ut.maxTextureSize&&Lr>0&&Lr<=Ut.maxTextureSize,"invalid texture shape"),(Ee.wrapS!==we||Ee.wrapT!==we)&&O(Ne(ln)&&Ne(Lr),"incompatible wrap mode for texture, both width and height must be power of 2"),pt.mipmask===1?ln!==1&&Lr!==1&&O(Ee.minFilter!==at&&Ee.minFilter!==Tt&&Ee.minFilter!==vt&&Ee.minFilter!==ze,"min filter requires mipmap"):(O(Ne(ln)&&Ne(Lr),"texture must be a square power of 2 to support mipmapping"),O(pt.mipmask===(ln<<1)-1,"missing or incomplete mipmap data")),pt.type===tn&&(Ut.extensions.indexOf("oes_texture_float_linear")<0&&O(Ee.minFilter===nt&&Ee.magFilter===nt,"filter not supported, must enable oes_texture_float_linear"),O(!Ee.genMipmaps,"mipmap generation not supported with float textures"));var Ln=pt.images;for(Pr=0;Pr<16;++Pr)if(Ln[Pr]){var An=ln>>Pr,$n=Lr>>Pr;O(pt.mipmask&1<<Pr,"missing mipmap data");var Fn=Ln[Pr];if(O(Fn.width===An&&Fn.height===$n,"invalid shape for mip images"),O(Fn.format===pt.format&&Fn.internalformat===pt.internalformat&&Fn.type===pt.type,"incompatible type for mip image"),!Fn.compressed)if(Fn.data){var jn=Math.ceil(wr(Fn.type,Tr)*An/Fn.unpackAlignment)*Fn.unpackAlignment;O(Fn.data.byteLength===jn*$n,"invalid data for image, buffer size is inconsistent with image format")}else Fn.element||Fn.copy}else Ee.genMipmaps||O((pt.mipmask&1<<Pr)===0,"extra mipmap data");pt.compressed&&O(!Ee.genMipmaps,"mipmap generation for compressed images not supported")}function Er(Ee,pt,Ut,Pr){var ln=Ee.width,Lr=Ee.height,Tr=Ee.channels;O(ln>0&&ln<=Pr.maxTextureSize&&Lr>0&&Lr<=Pr.maxTextureSize,"invalid texture shape"),O(ln===Lr,"cube map must be square"),O(pt.wrapS===we&&pt.wrapT===we,"wrap mode not supported by cube map");for(var Ln=0;Ln<Ut.length;++Ln){var An=Ut[Ln];O(An.width===ln&&An.height===Lr,"inconsistent cube map face shape"),pt.genMipmaps&&(O(!An.compressed,"can not generate mipmap for compressed textures"),O(An.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var $n=An.images,Fn=0;Fn<16;++Fn){var jn=$n[Fn];if(jn){var Kn=ln>>Fn,Cn=Lr>>Fn;O(An.mipmask&1<<Fn,"missing mipmap data"),O(jn.width===Kn&&jn.height===Cn,"invalid shape for mip images"),O(jn.format===Ee.format&&jn.internalformat===Ee.internalformat&&jn.type===Ee.type,"incompatible type for mip image"),jn.compressed||(jn.data?O(jn.data.byteLength===Kn*Cn*Math.max(wr(jn.type,Tr),jn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):jn.element||jn.copy)}}}}var Ue=_(O,{optional:ue,raise:h,commandRaise:fe,command:Et,parameter:P,commandParameter:xe,constructor:U,type:V,commandType:je,isTypedArray:F,nni:Q,oneOf:k,shaderError:ae,linkError:ee,callSite:ye,saveCommandRef:me,saveDrawInfo:ge,framebufferFormat:Pe,guessCommand:Te,texture2D:Xr,textureCube:Er}),In=0,an=0;function Qr(Ee,pt){this.id=In++,this.type=Ee,this.data=pt}function Dn(Ee){return Ee.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function On(Ee){if(Ee.length===0)return[];var pt=Ee.charAt(0),Ut=Ee.charAt(Ee.length-1);if(Ee.length>1&&pt===Ut&&(pt==='"'||pt==="'"))return['"'+Dn(Ee.substr(1,Ee.length-2))+'"'];var Pr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Ee);if(Pr)return On(Ee.substr(0,Pr.index)).concat(On(Pr[1])).concat(On(Ee.substr(Pr.index+Pr[0].length)));var ln=Ee.split(".");if(ln.length===1)return['"'+Dn(Ee)+'"'];for(var Lr=[],Tr=0;Tr<ln.length;++Tr)Lr=Lr.concat(On(ln[Tr]));return Lr}function ri(Ee){return"["+On(Ee).join("][")+"]"}function zt(Ee,pt){return new Qr(Ee,ri(pt+""))}function cr(Ee){return typeof Ee=="function"&&!Ee._reglType||Ee instanceof Qr}function Zr(Ee,pt){return typeof Ee=="function"?new Qr(an,Ee):Ee}var Kr={DynamicVariable:Qr,define:zt,isDynamic:cr,unbox:Zr,accessor:ri},en={next:typeof requestAnimationFrame=="function"?function(Ee){return requestAnimationFrame(Ee)}:function(Ee){return setTimeout(Ee,16)},cancel:typeof cancelAnimationFrame=="function"?function(Ee){return cancelAnimationFrame(Ee)}:clearTimeout},Wn=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function De(){var Ee={"":0},pt=[""];return{id:function(Ut){var Pr=Ee[Ut];return Pr||(Pr=Ee[Ut]=pt.length,pt.push(Ut),Pr)},str:function(Ut){return pt[Ut]}}}function X(Ee,pt,Ut){var Pr=document.createElement("canvas");_(Pr.style,{border:0,margin:0,padding:0,top:0,left:0}),Ee.appendChild(Pr),Ee===document.body&&(Pr.style.position="absolute",_(Ee.style,{margin:0,padding:0}));function ln(){var Ln=window.innerWidth,An=window.innerHeight;if(Ee!==document.body){var $n=Ee.getBoundingClientRect();Ln=$n.right-$n.left,An=$n.bottom-$n.top}Pr.width=Ut*Ln,Pr.height=Ut*An,_(Pr.style,{width:Ln+"px",height:An+"px"})}var Lr;Ee!==document.body&&typeof ResizeObserver=="function"?(Lr=new ResizeObserver(function(){setTimeout(ln)}),Lr.observe(Ee)):window.addEventListener("resize",ln,!1);function Tr(){Lr?Lr.disconnect():window.removeEventListener("resize",ln),Ee.removeChild(Pr)}return ln(),{canvas:Pr,onDestroy:Tr}}function se(Ee,pt){function Ut(Pr){try{return Ee.getContext(Pr,pt)}catch(ln){return null}}return Ut("webgl")||Ut("experimental-webgl")||Ut("webgl-experimental")}function Be(Ee){return typeof Ee.nodeName=="string"&&typeof Ee.appendChild=="function"&&typeof Ee.getBoundingClientRect=="function"}function Ye(Ee){return typeof Ee.drawArrays=="function"||typeof Ee.drawElements=="function"}function ct(Ee){return typeof Ee=="string"?Ee.split():(Ue(Array.isArray(Ee),"invalid extension array"),Ee)}function sr(Ee){return typeof Ee=="string"?(Ue(typeof document!="undefined","not supported outside of DOM"),document.querySelector(Ee)):Ee}function ar(Ee){var pt=Ee||{},Ut,Pr,ln,Lr,Tr={},Ln=[],An=[],$n=typeof window=="undefined"?1:window.devicePixelRatio,Fn=!1,jn=function(Vn){Vn&&Ue.raise(Vn)},Kn=function(){};if(typeof pt=="string"?(Ue(typeof document!="undefined","selector queries only supported in DOM enviroments"),Ut=document.querySelector(pt),Ue(Ut,"invalid query string for element")):typeof pt=="object"?Be(pt)?Ut=pt:Ye(pt)?(Lr=pt,ln=Lr.canvas):(Ue.constructor(pt),"gl"in pt?Lr=pt.gl:"canvas"in pt?ln=sr(pt.canvas):"container"in pt&&(Pr=sr(pt.container)),"attributes"in pt&&(Tr=pt.attributes,Ue.type(Tr,"object","invalid context attributes")),"extensions"in pt&&(Ln=ct(pt.extensions)),"optionalExtensions"in pt&&(An=ct(pt.optionalExtensions)),"onDone"in pt&&(Ue.type(pt.onDone,"function","invalid or missing onDone callback"),jn=pt.onDone),"profile"in pt&&(Fn=!!pt.profile),"pixelRatio"in pt&&($n=+pt.pixelRatio,Ue($n>0,"invalid pixel ratio"))):Ue.raise("invalid arguments to regl"),Ut&&(Ut.nodeName.toLowerCase()==="canvas"?ln=Ut:Pr=Ut),!Lr){if(!ln){Ue(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Cn=X(Pr||document.body,jn,$n);if(!Cn)return null;ln=Cn.canvas,Kn=Cn.onDestroy}Tr.premultipliedAlpha===void 0&&(Tr.premultipliedAlpha=!0),Lr=se(ln,Tr)}return Lr?{gl:Lr,canvas:ln,container:Pr,extensions:Ln,optionalExtensions:An,pixelRatio:$n,profile:Fn,onDone:jn,onDestroy:Kn}:(Kn(),jn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function or(Ee,pt){var Ut={};function Pr(Tr){Ue.type(Tr,"string","extension name must be string");var Ln=Tr.toLowerCase(),An;try{An=Ut[Ln]=Ee.getExtension(Ln)}catch($n){}return!!An}for(var ln=0;ln<pt.extensions.length;++ln){var Lr=pt.extensions[ln];if(!Pr(Lr))return pt.onDestroy(),pt.onDone('"'+Lr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return pt.optionalExtensions.forEach(Pr),{extensions:Ut,restore:function(){Object.keys(Ut).forEach(function(Tr){if(Ut[Tr]&&!Pr(Tr))throw new Error("(regl): error restoring extension "+Tr)})}}}function Wt(Ee,pt){for(var Ut=Array(Ee),Pr=0;Pr<Ee;++Pr)Ut[Pr]=pt(Pr);return Ut}var oe=5120,ie=5121,be=5122,ke=5123,qe=5124,mt=5125,kt=5126;function $e(Ee){for(var pt=16;pt<=1<<28;pt*=16)if(Ee<=pt)return pt;return 0}function Ge(Ee){var pt,Ut;return pt=(Ee>65535)<<4,Ee>>>=pt,Ut=(Ee>255)<<3,Ee>>>=Ut,pt|=Ut,Ut=(Ee>15)<<2,Ee>>>=Ut,pt|=Ut,Ut=(Ee>3)<<1,Ee>>>=Ut,pt|=Ut,pt|Ee>>1}function We(){var Ee=Wt(8,function(){return[]});function pt(Lr){var Tr=$e(Lr),Ln=Ee[Ge(Tr)>>2];return Ln.length>0?Ln.pop():new ArrayBuffer(Tr)}function Ut(Lr){Ee[Ge(Lr.byteLength)>>2].push(Lr)}function Pr(Lr,Tr){var Ln=null;switch(Lr){case oe:Ln=new Int8Array(pt(Tr),0,Tr);break;case ie:Ln=new Uint8Array(pt(Tr),0,Tr);break;case be:Ln=new Int16Array(pt(2*Tr),0,Tr);break;case ke:Ln=new Uint16Array(pt(2*Tr),0,Tr);break;case qe:Ln=new Int32Array(pt(4*Tr),0,Tr);break;case mt:Ln=new Uint32Array(pt(4*Tr),0,Tr);break;case kt:Ln=new Float32Array(pt(4*Tr),0,Tr);break;default:return null}return Ln.length!==Tr?Ln.subarray(0,Tr):Ln}function ln(Lr){Ut(Lr.buffer)}return{alloc:pt,free:Ut,allocType:Pr,freeType:ln}}var G=We();G.zero=We();var rt=3408,ft=3410,bt=3411,Gt=3412,lr=3413,Ht=3414,Cr=3415,hr=33901,Dr=33902,Rn=3379,on=3386,fi=34921,Mi=36347,di=36348,mn=35661,Zn=35660,sa=34930,qi=36349,Sa=34076,Zi=34024,Oi=7936,jr=7937,Fi=7938,Ls=35724,Ta=34047,Aa=36063,go=34852,os=3553,ka=34067,Ao=34069,za=33984,Ja=6408,Oa=5126,Za=5121,qo=36160,Ca=36053,io=36064,Do=16384,$=function(Ee,pt){var Ut=1;pt.ext_texture_filter_anisotropic&&(Ut=Ee.getParameter(Ta));var Pr=1,ln=1;pt.webgl_draw_buffers&&(Pr=Ee.getParameter(go),ln=Ee.getParameter(Aa));var Lr=!!pt.oes_texture_float;if(Lr){var Tr=Ee.createTexture();Ee.bindTexture(os,Tr),Ee.texImage2D(os,0,Ja,1,1,0,Ja,Oa,null);var Ln=Ee.createFramebuffer();if(Ee.bindFramebuffer(qo,Ln),Ee.framebufferTexture2D(qo,io,os,Tr,0),Ee.bindTexture(os,null),Ee.checkFramebufferStatus(qo)!==Ca)Lr=!1;else{Ee.viewport(0,0,1,1),Ee.clearColor(1,0,0,1),Ee.clear(Do);var An=G.allocType(Oa,4);Ee.readPixels(0,0,1,1,Ja,Oa,An),Ee.getError()?Lr=!1:(Ee.deleteFramebuffer(Ln),Ee.deleteTexture(Tr),Lr=An[0]===1),G.freeType(An)}}var $n=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Fn=!0;if(!$n){var jn=Ee.createTexture(),Kn=G.allocType(Za,36);Ee.activeTexture(za),Ee.bindTexture(ka,jn),Ee.texImage2D(Ao,0,Ja,3,3,0,Ja,Za,Kn),G.freeType(Kn),Ee.bindTexture(ka,null),Ee.deleteTexture(jn),Fn=!Ee.getError()}return{colorBits:[Ee.getParameter(ft),Ee.getParameter(bt),Ee.getParameter(Gt),Ee.getParameter(lr)],depthBits:Ee.getParameter(Ht),stencilBits:Ee.getParameter(Cr),subpixelBits:Ee.getParameter(rt),extensions:Object.keys(pt).filter(function(Cn){return!!pt[Cn]}),maxAnisotropic:Ut,maxDrawbuffers:Pr,maxColorAttachments:ln,pointSizeDims:Ee.getParameter(hr),lineWidthDims:Ee.getParameter(Dr),maxViewportDims:Ee.getParameter(on),maxCombinedTextureUnits:Ee.getParameter(mn),maxCubeMapSize:Ee.getParameter(Sa),maxRenderbufferSize:Ee.getParameter(Zi),maxTextureUnits:Ee.getParameter(sa),maxTextureSize:Ee.getParameter(Rn),maxAttributes:Ee.getParameter(fi),maxVertexUniforms:Ee.getParameter(Mi),maxVertexTextureUnits:Ee.getParameter(Zn),maxVaryingVectors:Ee.getParameter(di),maxFragmentUniforms:Ee.getParameter(qi),glsl:Ee.getParameter(Ls),renderer:Ee.getParameter(jr),vendor:Ee.getParameter(Oi),version:Ee.getParameter(Fi),readFloat:Lr,npotTextureCube:Fn}};function ho(Ee){return!!Ee&&typeof Ee=="object"&&Array.isArray(Ee.shape)&&Array.isArray(Ee.stride)&&typeof Ee.offset=="number"&&Ee.shape.length===Ee.stride.length&&(Array.isArray(Ee.data)||E(Ee.data))}var ja=function(Ee){return Object.keys(Ee).map(function(pt){return Ee[pt]})},gs={shape:Tn,flatten:Ur};function Vo(Ee,pt,Ut){for(var Pr=0;Pr<pt;++Pr)Ut[Pr]=Ee[Pr]}function Je(Ee,pt,Ut,Pr){for(var ln=0,Lr=0;Lr<pt;++Lr)for(var Tr=Ee[Lr],Ln=0;Ln<Ut;++Ln)Pr[ln++]=Tr[Ln]}function yt(Ee,pt,Ut,Pr,ln,Lr){for(var Tr=Lr,Ln=0;Ln<pt;++Ln)for(var An=Ee[Ln],$n=0;$n<Ut;++$n)for(var Fn=An[$n],jn=0;jn<Pr;++jn)ln[Tr++]=Fn[jn]}function Qt(Ee,pt,Ut,Pr,ln){for(var Lr=1,Tr=Ut+1;Tr<pt.length;++Tr)Lr*=pt[Tr];var Ln=pt[Ut];if(pt.length-Ut===4){var An=pt[Ut+1],$n=pt[Ut+2],Fn=pt[Ut+3];for(Tr=0;Tr<Ln;++Tr)yt(Ee[Tr],An,$n,Fn,Pr,ln),ln+=Lr}else for(Tr=0;Tr<Ln;++Tr)Qt(Ee[Tr],pt,Ut+1,Pr,ln),ln+=Lr}function Ur(Ee,pt,Ut,Pr){var ln=1;if(pt.length)for(var Lr=0;Lr<pt.length;++Lr)ln*=pt[Lr];else ln=0;var Tr=Pr||G.allocType(Ut,ln);switch(pt.length){case 0:break;case 1:Vo(Ee,pt[0],Tr);break;case 2:Je(Ee,pt[0],pt[1],Tr);break;case 3:yt(Ee,pt[0],pt[1],pt[2],Tr,0);break;default:Qt(Ee,pt,0,Tr,0)}return Tr}function Tn(Ee){for(var pt=[],Ut=Ee;Ut.length;Ut=Ut[0])pt.push(Ut.length);return pt}var mi={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},la=5120,Ho=5122,ss=5124,ko=5121,gu=5123,Ws=5125,cf=5126,ff=5126,ys={int8:la,int16:Ho,int32:ss,uint8:ko,uint16:gu,uint32:Ws,float:cf,float32:ff},bl=35048,xl=35040,ds={dynamic:bl,stream:xl,static:35044},Qu=gs.flatten,El=gs.shape,Fl=35044,gn=35040,Ai=5121,Hi=5126,kn=[];kn[5120]=1,kn[5122]=2,kn[5124]=4,kn[5121]=1,kn[5123]=2,kn[5125]=4,kn[5126]=4;function us(Ee){return mi[Object.prototype.toString.call(Ee)]|0}function Sl(Ee,pt){for(var Ut=0;Ut<pt.length;++Ut)Ee[Ut]=pt[Ut]}function Ic(Ee,pt,Ut,Pr,ln,Lr,Tr){for(var Ln=0,An=0;An<Ut;++An)for(var $n=0;$n<Pr;++$n)Ee[Ln++]=pt[ln*An+Lr*$n+Tr]}function hf(Ee,pt,Ut,Pr){var ln=0,Lr={};function Tr(_r){this.id=ln++,this.buffer=Ee.createBuffer(),this.type=_r,this.usage=Fl,this.byteLength=0,this.dimension=1,this.dtype=Ai,this.persistentData=null,Ut.profile&&(this.stats={size:0})}Tr.prototype.bind=function(){Ee.bindBuffer(this.type,this.buffer)},Tr.prototype.destroy=function(){Kn(this)};var Ln=[];function An(_r,Gr){var Bn=Ln.pop();return Bn||(Bn=new Tr(_r)),Bn.bind(),jn(Bn,Gr,gn,0,1,!1),Bn}function $n(_r){Ln.push(_r)}function Fn(_r,Gr,Bn){_r.byteLength=Gr.byteLength,Ee.bufferData(_r.type,Gr,Bn)}function jn(_r,Gr,Bn,ni,bn,si){var Mn;if(_r.usage=Bn,Array.isArray(Gr)){if(_r.dtype=ni||Hi,Gr.length>0){var ii;if(Array.isArray(Gr[0])){Mn=El(Gr);for(var En=1,Qn=1;Qn<Mn.length;++Qn)En*=Mn[Qn];_r.dimension=En,ii=Qu(Gr,Mn,_r.dtype),Fn(_r,ii,Bn),si?_r.persistentData=ii:G.freeType(ii)}else if(typeof Gr[0]=="number"){_r.dimension=bn;var Ui=G.allocType(_r.dtype,Gr.length);Sl(Ui,Gr),Fn(_r,Ui,Bn),si?_r.persistentData=Ui:G.freeType(Ui)}else E(Gr[0])?(_r.dimension=Gr[0].length,_r.dtype=ni||us(Gr[0])||Hi,ii=Qu(Gr,[Gr.length,Gr[0].length],_r.dtype),Fn(_r,ii,Bn),si?_r.persistentData=ii:G.freeType(ii)):Ue.raise("invalid buffer data")}}else if(E(Gr))_r.dtype=ni||us(Gr),_r.dimension=bn,Fn(_r,Gr,Bn),si&&(_r.persistentData=new Uint8Array(new Uint8Array(Gr.buffer)));else if(ho(Gr)){Mn=Gr.shape;var oa=Gr.stride,ei=Gr.offset,Pn=0,cn=0,zi=0,pa=0;Mn.length===1?(Pn=Mn[0],cn=1,zi=oa[0],pa=0):Mn.length===2?(Pn=Mn[0],cn=Mn[1],zi=oa[0],pa=oa[1]):Ue.raise("invalid shape"),_r.dtype=ni||us(Gr.data)||Hi,_r.dimension=cn;var ui=G.allocType(_r.dtype,Pn*cn);Ic(ui,Gr.data,Pn,cn,zi,pa,ei),Fn(_r,ui,Bn),si?_r.persistentData=ui:G.freeType(ui)}else Gr instanceof ArrayBuffer?(_r.dtype=Ai,_r.dimension=bn,Fn(_r,Gr,Bn),si&&(_r.persistentData=new Uint8Array(new Uint8Array(Gr)))):Ue.raise("invalid buffer data")}function Kn(_r){pt.bufferCount--,Pr(_r);var Gr=_r.buffer;Ue(Gr,"buffer must not be deleted already"),Ee.deleteBuffer(Gr),_r.buffer=null,delete Lr[_r.id]}function Cn(_r,Gr,Bn,ni){pt.bufferCount++;var bn=new Tr(Gr);Lr[bn.id]=bn;function si(En){var Qn=Fl,Ui=null,oa=0,ei=0,Pn=1;return Array.isArray(En)||E(En)||ho(En)||En instanceof ArrayBuffer?Ui=En:typeof En=="number"?oa=En|0:En&&(Ue.type(En,"object","buffer arguments must be an object, a number or an array"),"data"in En&&(Ue(Ui===null||Array.isArray(Ui)||E(Ui)||ho(Ui),"invalid data for buffer"),Ui=En.data),"usage"in En&&(Ue.parameter(En.usage,ds,"invalid buffer usage"),Qn=ds[En.usage]),"type"in En&&(Ue.parameter(En.type,ys,"invalid buffer type"),ei=ys[En.type]),"dimension"in En&&(Ue.type(En.dimension,"number","invalid dimension"),Pn=En.dimension|0),"length"in En&&(Ue.nni(oa,"buffer length must be a nonnegative integer"),oa=En.length|0)),bn.bind(),Ui?jn(bn,Ui,Qn,ei,Pn,ni):(oa&&Ee.bufferData(bn.type,oa,Qn),bn.dtype=ei||Ai,bn.usage=Qn,bn.dimension=Pn,bn.byteLength=oa),Ut.profile&&(bn.stats.size=bn.byteLength*kn[bn.dtype]),si}function Mn(En,Qn){Ue(Qn+En.byteLength<=bn.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+En.byteLength+" starting from offset "+Qn+" to a buffer of size "+bn.byteLength),Ee.bufferSubData(bn.type,Qn,En)}function ii(En,Qn){var Ui=(Qn||0)|0,oa;if(bn.bind(),E(En)||En instanceof ArrayBuffer)Mn(En,Ui);else if(Array.isArray(En)){if(En.length>0)if(typeof En[0]=="number"){var ei=G.allocType(bn.dtype,En.length);Sl(ei,En),Mn(ei,Ui),G.freeType(ei)}else if(Array.isArray(En[0])||E(En[0])){oa=El(En);var Pn=Qu(En,oa,bn.dtype);Mn(Pn,Ui),G.freeType(Pn)}else Ue.raise("invalid buffer data")}else if(ho(En)){oa=En.shape;var cn=En.stride,zi=0,pa=0,ui=0,va=0;oa.length===1?(zi=oa[0],pa=1,ui=cn[0],va=0):oa.length===2?(zi=oa[0],pa=oa[1],ui=cn[0],va=cn[1]):Ue.raise("invalid shape");var aa=Array.isArray(En.data)?bn.dtype:us(En.data),Yi=G.allocType(aa,zi*pa);Ic(Yi,En.data,zi,pa,ui,va,En.offset),Mn(Yi,Ui),G.freeType(Yi)}else Ue.raise("invalid data for buffer subdata");return si}return Bn||si(_r),si._reglType="buffer",si._buffer=bn,si.subdata=ii,Ut.profile&&(si.stats=bn.stats),si.destroy=function(){Kn(bn)},si}function Vn(){ja(Lr).forEach(function(_r){_r.buffer=Ee.createBuffer(),Ee.bindBuffer(_r.type,_r.buffer),Ee.bufferData(_r.type,_r.persistentData||_r.byteLength,_r.usage)})}return Ut.profile&&(pt.getTotalBufferSize=function(){var _r=0;return Object.keys(Lr).forEach(function(Gr){_r+=Lr[Gr].stats.size}),_r}),{create:Cn,createStream:An,destroyStream:$n,clear:function(){ja(Lr).forEach(Kn),Ln.forEach(Kn)},getBuffer:function(_r){return _r&&_r._buffer instanceof Tr?_r._buffer:null},restore:Vn,_initBuffer:jn}}var Oc=0,df=0,pf=1,po=1,Pf=4,vc=4,Ju={points:Oc,point:df,lines:pf,line:po,triangles:Pf,triangle:vc,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},eh=0,Qo=1,Nl=4,Ul=5120,iu=5121,yu=5122,_u=5123,el=5124,au=5125,zl=34963,Tl=35040,vf=35044;function Vc(Ee,pt,Ut,Pr){var ln={},Lr=0,Tr={uint8:iu,uint16:_u};pt.oes_element_index_uint&&(Tr.uint32=au);function Ln(Vn){this.id=Lr++,ln[this.id]=this,this.buffer=Vn,this.primType=Nl,this.vertCount=0,this.type=0}Ln.prototype.bind=function(){this.buffer.bind()};var An=[];function $n(Vn){var _r=An.pop();return _r||(_r=new Ln(Ut.create(null,zl,!0,!1)._buffer)),jn(_r,Vn,Tl,-1,-1,0,0),_r}function Fn(Vn){An.push(Vn)}function jn(Vn,_r,Gr,Bn,ni,bn,si){Vn.buffer.bind();var Mn;if(_r){var ii=si;!si&&(!E(_r)||ho(_r)&&!E(_r.data))&&(ii=pt.oes_element_index_uint?au:_u),Ut._initBuffer(Vn.buffer,_r,Gr,ii,3)}else Ee.bufferData(zl,bn,Gr),Vn.buffer.dtype=Mn||iu,Vn.buffer.usage=Gr,Vn.buffer.dimension=3,Vn.buffer.byteLength=bn;if(Mn=si,!si){switch(Vn.buffer.dtype){case iu:case Ul:Mn=iu;break;case _u:case yu:Mn=_u;break;case au:case el:Mn=au;break;default:Ue.raise("unsupported type for element array")}Vn.buffer.dtype=Mn}Vn.type=Mn,Ue(Mn!==au||!!pt.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var En=ni;En<0&&(En=Vn.buffer.byteLength,Mn===_u?En>>=1:Mn===au&&(En>>=2)),Vn.vertCount=En;var Qn=Bn;if(Bn<0){Qn=Nl;var Ui=Vn.buffer.dimension;Ui===1&&(Qn=eh),Ui===2&&(Qn=Qo),Ui===3&&(Qn=Nl)}Vn.primType=Qn}function Kn(Vn){Pr.elementsCount--,Ue(Vn.buffer!==null,"must not double destroy elements"),delete ln[Vn.id],Vn.buffer.destroy(),Vn.buffer=null}function Cn(Vn,_r){var Gr=Ut.create(null,zl,!0),Bn=new Ln(Gr._buffer);Pr.elementsCount++;function ni(bn){if(!bn)Gr(),Bn.primType=Nl,Bn.vertCount=0,Bn.type=iu;else if(typeof bn=="number")Gr(bn),Bn.primType=Nl,Bn.vertCount=bn|0,Bn.type=iu;else{var si=null,Mn=vf,ii=-1,En=-1,Qn=0,Ui=0;Array.isArray(bn)||E(bn)||ho(bn)?si=bn:(Ue.type(bn,"object","invalid arguments for elements"),"data"in bn&&(si=bn.data,Ue(Array.isArray(si)||E(si)||ho(si),"invalid data for element buffer")),"usage"in bn&&(Ue.parameter(bn.usage,ds,"invalid element buffer usage"),Mn=ds[bn.usage]),"primitive"in bn&&(Ue.parameter(bn.primitive,Ju,"invalid element buffer primitive"),ii=Ju[bn.primitive]),"count"in bn&&(Ue(typeof bn.count=="number"&&bn.count>=0,"invalid vertex count for elements"),En=bn.count|0),"type"in bn&&(Ue.parameter(bn.type,Tr,"invalid buffer type"),Ui=Tr[bn.type]),"length"in bn?Qn=bn.length|0:(Qn=En,Ui===_u||Ui===yu?Qn*=2:(Ui===au||Ui===el)&&(Qn*=4))),jn(Bn,si,Mn,ii,En,Qn,Ui)}return ni}return ni(Vn),ni._reglType="elements",ni._elements=Bn,ni.subdata=function(bn,si){return Gr.subdata(bn,si),ni},ni.destroy=function(){Kn(Bn)},ni}return{create:Cn,createStream:$n,destroyStream:Fn,getElements:function(Vn){return typeof Vn=="function"&&Vn._elements instanceof Ln?Vn._elements:null},clear:function(){ja(ln).forEach(Kn)}}}var Va=new Float32Array(1),th=new Uint32Array(Va.buffer),Pc=5123;function Hc(Ee){for(var pt=G.allocType(Pc,Ee.length),Ut=0;Ut<Ee.length;++Ut)if(isNaN(Ee[Ut]))pt[Ut]=65535;else if(Ee[Ut]===1/0)pt[Ut]=31744;else if(Ee[Ut]===-1/0)pt[Ut]=64512;else{Va[0]=Ee[Ut];var Pr=th[0],ln=Pr>>>31<<15,Lr=(Pr<<1>>>24)-127,Tr=Pr>>13&1024-1;if(Lr<-24)pt[Ut]=ln;else if(Lr<-14){var Ln=-14-Lr;pt[Ut]=ln+(Tr+1024>>Ln)}else Lr>15?pt[Ut]=ln+31744:pt[Ut]=ln+(Lr+15<<10)+Tr}return pt}function bo(Ee){return Array.isArray(Ee)||E(Ee)}var mf=function(Ee){return!(Ee&Ee-1)&&!!Ee},gf=34467,Jo=3553,Zu=34067,Mu=34069,ju=6408,mc=6406,Zl=6407,bu=6409,gc=6410,Al=32854,ou=32855,La=36194,qa=32819,so=32820,Vu=33635,Df=34042,Cl=6402,Dc=34041,yc=35904,Gs=35906,Hu=36193,Iu=33776,tl=33777,Ql=33778,Jl=33779,jl=35986,kc=35987,rl=34798,Xs=35840,kf=35841,yf=35842,Lf=35843,Vl=36196,$u=5121,Hl=5123,_c=5125,nl=5126,Bf=10242,$c=10243,_f=10497,Wc=33071,bf=33648,bc=10240,Gc=10241,xu=9728,Wu=9729,_s=9984,xf=9985,$l=9986,uo=9987,Ef=33170,Ys=4352,wl=4353,Ia=4354,lo=34046,Ou=3317,Xc=37440,Pu=37441,Bs=37443,Ff=37444,Yc=33984,ec=[_s,$l,xf,uo],tc=[0,bu,gc,Zl,ju],ps={};ps[bu]=ps[mc]=ps[Cl]=1,ps[Dc]=ps[gc]=2,ps[Zl]=ps[yc]=3,ps[ju]=ps[Gs]=4;function Co(Ee){return"[object "+Ee+"]"}var xc=Co("HTMLCanvasElement"),Nf=Co("OffscreenCanvas"),wo=Co("CanvasRenderingContext2D"),oi=Co("ImageBitmap"),Ks=Co("HTMLImageElement"),rc=Co("HTMLVideoElement"),nc=Object.keys(mi).concat([xc,Nf,wo,oi,Ks,rc]),Cs=[];Cs[$u]=1,Cs[nl]=4,Cs[Hu]=2,Cs[Hl]=2,Cs[_c]=4;var wa=[];wa[Al]=2,wa[ou]=2,wa[La]=2,wa[Dc]=4,wa[Iu]=.5,wa[tl]=.5,wa[Ql]=1,wa[Jl]=1,wa[jl]=.5,wa[kc]=1,wa[rl]=1,wa[Xs]=.5,wa[kf]=.25,wa[yf]=.5,wa[Lf]=.25,wa[Vl]=.5;function qs(Ee){return Array.isArray(Ee)&&(Ee.length===0||typeof Ee[0]=="number")}function zn(Ee){if(!Array.isArray(Ee))return!1;var pt=Ee.length;return!(pt===0||!bo(Ee[0]))}function Du(Ee){return Object.prototype.toString.call(Ee)}function il(Ee){return Du(Ee)===xc}function Ec(Ee){return Du(Ee)===Nf}function Eu(Ee){return Du(Ee)===wo}function su(Ee){return Du(Ee)===oi}function Lc(Ee){return Du(Ee)===Ks}function Rl(Ee){return Du(Ee)===rc}function vs(Ee){if(!Ee)return!1;var pt=Du(Ee);return nc.indexOf(pt)>=0?!0:qs(Ee)||zn(Ee)||ho(Ee)}function uu(Ee){return mi[Object.prototype.toString.call(Ee)]|0}function Sf(Ee,pt){var Ut=pt.length;switch(Ee.type){case $u:case Hl:case _c:case nl:var Pr=G.allocType(Ee.type,Ut);Pr.set(pt),Ee.data=Pr;break;case Hu:Ee.data=Hc(pt);break;default:Ue.raise("unsupported texture type, must specify a typed array")}}function Bc(Ee,pt){return G.allocType(Ee.type===Hu?nl:Ee.type,pt)}function Sc(Ee,pt){Ee.type===Hu?(Ee.data=Hc(pt),G.freeType(pt)):Ee.data=pt}function Tf(Ee,pt,Ut,Pr,ln,Lr){for(var Tr=Ee.width,Ln=Ee.height,An=Ee.channels,$n=Tr*Ln*An,Fn=Bc(Ee,$n),jn=0,Kn=0;Kn<Ln;++Kn)for(var Cn=0;Cn<Tr;++Cn)for(var Vn=0;Vn<An;++Vn)Fn[jn++]=pt[Ut*Cn+Pr*Kn+ln*Vn+Lr];Sc(Ee,Fn)}function Su(Ee,pt,Ut,Pr,ln,Lr){var Tr;if(typeof wa[Ee]!="undefined"?Tr=wa[Ee]:Tr=ps[Ee]*Cs[pt],Lr&&(Tr*=6),ln){for(var Ln=0,An=Ut;An>=1;)Ln+=Tr*An*An,An/=2;return Ln}else return Tr*Ut*Pr}function $o(Ee,pt,Ut,Pr,ln,Lr,Tr){var Ln={"don't care":Ys,"dont care":Ys,nice:Ia,fast:wl},An={repeat:_f,clamp:Wc,mirror:bf},$n={nearest:xu,linear:Wu},Fn=_({mipmap:uo,"nearest mipmap nearest":_s,"linear mipmap nearest":xf,"nearest mipmap linear":$l,"linear mipmap linear":uo},$n),jn={none:0,browser:Ff},Kn={uint8:$u,rgba4:qa,rgb565:Vu,"rgb5 a1":so},Cn={alpha:mc,luminance:bu,"luminance alpha":gc,rgb:Zl,rgba:ju,rgba4:Al,"rgb5 a1":ou,rgb565:La},Vn={};pt.ext_srgb&&(Cn.srgb=yc,Cn.srgba=Gs),pt.oes_texture_float&&(Kn.float32=Kn.float=nl),pt.oes_texture_half_float&&(Kn.float16=Kn["half float"]=Hu),pt.webgl_depth_texture&&(_(Cn,{depth:Cl,"depth stencil":Dc}),_(Kn,{uint16:Hl,uint32:_c,"depth stencil":Df})),pt.webgl_compressed_texture_s3tc&&_(Vn,{"rgb s3tc dxt1":Iu,"rgba s3tc dxt1":tl,"rgba s3tc dxt3":Ql,"rgba s3tc dxt5":Jl}),pt.webgl_compressed_texture_atc&&_(Vn,{"rgb atc":jl,"rgba atc explicit alpha":kc,"rgba atc interpolated alpha":rl}),pt.webgl_compressed_texture_pvrtc&&_(Vn,{"rgb pvrtc 4bppv1":Xs,"rgb pvrtc 2bppv1":kf,"rgba pvrtc 4bppv1":yf,"rgba pvrtc 2bppv1":Lf}),pt.webgl_compressed_texture_etc1&&(Vn["rgb etc1"]=Vl);var _r=Array.prototype.slice.call(Ee.getParameter(gf));Object.keys(Vn).forEach(function(It){var Nr=Vn[It];_r.indexOf(Nr)>=0&&(Cn[It]=Nr)});var Gr=Object.keys(Cn);Ut.textureFormats=Gr;var Bn=[];Object.keys(Cn).forEach(function(It){var Nr=Cn[It];Bn[Nr]=It});var ni=[];Object.keys(Kn).forEach(function(It){var Nr=Kn[It];ni[Nr]=It});var bn=[];Object.keys($n).forEach(function(It){var Nr=$n[It];bn[Nr]=It});var si=[];Object.keys(Fn).forEach(function(It){var Nr=Fn[It];si[Nr]=It});var Mn=[];Object.keys(An).forEach(function(It){var Nr=An[It];Mn[Nr]=It});var ii=Gr.reduce(function(It,Nr){var Rr=Cn[Nr];return Rr===bu||Rr===mc||Rr===bu||Rr===gc||Rr===Cl||Rr===Dc||pt.ext_srgb&&(Rr===yc||Rr===Gs)?It[Rr]=Rr:Rr===ou||Nr.indexOf("rgba")>=0?It[Rr]=ju:It[Rr]=Zl,It},{});function En(){this.internalformat=ju,this.format=ju,this.type=$u,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ff,this.width=0,this.height=0,this.channels=0}function Qn(It,Nr){It.internalformat=Nr.internalformat,It.format=Nr.format,It.type=Nr.type,It.compressed=Nr.compressed,It.premultiplyAlpha=Nr.premultiplyAlpha,It.flipY=Nr.flipY,It.unpackAlignment=Nr.unpackAlignment,It.colorSpace=Nr.colorSpace,It.width=Nr.width,It.height=Nr.height,It.channels=Nr.channels}function Ui(It,Nr){if(!(typeof Nr!="object"||!Nr)){if("premultiplyAlpha"in Nr&&(Ue.type(Nr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),It.premultiplyAlpha=Nr.premultiplyAlpha),"flipY"in Nr&&(Ue.type(Nr.flipY,"boolean","invalid texture flip"),It.flipY=Nr.flipY),"alignment"in Nr&&(Ue.oneOf(Nr.alignment,[1,2,4,8],"invalid texture unpack alignment"),It.unpackAlignment=Nr.alignment),"colorSpace"in Nr&&(Ue.parameter(Nr.colorSpace,jn,"invalid colorSpace"),It.colorSpace=jn[Nr.colorSpace]),"type"in Nr){var Rr=Nr.type;Ue(pt.oes_texture_float||!(Rr==="float"||Rr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),Ue(pt.oes_texture_half_float||!(Rr==="half float"||Rr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Ue(pt.webgl_depth_texture||!(Rr==="uint16"||Rr==="uint32"||Rr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Ue.parameter(Rr,Kn,"invalid texture type"),It.type=Kn[Rr]}var li=It.width,ha=It.height,vo=It.channels,Qe=!1;"shape"in Nr?(Ue(Array.isArray(Nr.shape)&&Nr.shape.length>=2,"shape must be an array"),li=Nr.shape[0],ha=Nr.shape[1],Nr.shape.length===3&&(vo=Nr.shape[2],Ue(vo>0&&vo<=4,"invalid number of channels"),Qe=!0),Ue(li>=0&&li<=Ut.maxTextureSize,"invalid width"),Ue(ha>=0&&ha<=Ut.maxTextureSize,"invalid height")):("radius"in Nr&&(li=ha=Nr.radius,Ue(li>=0&&li<=Ut.maxTextureSize,"invalid radius")),"width"in Nr&&(li=Nr.width,Ue(li>=0&&li<=Ut.maxTextureSize,"invalid width")),"height"in Nr&&(ha=Nr.height,Ue(ha>=0&&ha<=Ut.maxTextureSize,"invalid height")),"channels"in Nr&&(vo=Nr.channels,Ue(vo>0&&vo<=4,"invalid number of channels"),Qe=!0)),It.width=li|0,It.height=ha|0,It.channels=vo|0;var xt=!1;if("format"in Nr){var Nt=Nr.format;Ue(pt.webgl_depth_texture||!(Nt==="depth"||Nt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Ue.parameter(Nt,Cn,"invalid texture format");var Mr=It.internalformat=Cn[Nt];It.format=ii[Mr],Nt in Kn&&("type"in Nr||(It.type=Kn[Nt])),Nt in Vn&&(It.compressed=!0),xt=!0}!Qe&&xt?It.channels=ps[It.format]:Qe&&!xt?It.channels!==tc[It.format]&&(It.format=It.internalformat=tc[It.channels]):xt&&Qe&&Ue(It.channels===ps[It.format],"number of channels inconsistent with specified format")}}function oa(It){Ee.pixelStorei(Xc,It.flipY),Ee.pixelStorei(Pu,It.premultiplyAlpha),Ee.pixelStorei(Bs,It.colorSpace),Ee.pixelStorei(Ou,It.unpackAlignment)}function ei(){En.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Pn(It,Nr){var Rr=null;if(vs(Nr)?Rr=Nr:Nr&&(Ue.type(Nr,"object","invalid pixel data type"),Ui(It,Nr),"x"in Nr&&(It.xOffset=Nr.x|0),"y"in Nr&&(It.yOffset=Nr.y|0),vs(Nr.data)&&(Rr=Nr.data)),Ue(!It.compressed||Rr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Nr.copy){Ue(!Rr,"can not specify copy and data field for the same texture");var li=ln.viewportWidth,ha=ln.viewportHeight;It.width=It.width||li-It.xOffset,It.height=It.height||ha-It.yOffset,It.needsCopy=!0,Ue(It.xOffset>=0&&It.xOffset<li&&It.yOffset>=0&&It.yOffset<ha&&It.width>0&&It.width<=li&&It.height>0&&It.height<=ha,"copy texture read out of bounds")}else if(!Rr)It.width=It.width||1,It.height=It.height||1,It.channels=It.channels||4;else if(E(Rr))It.channels=It.channels||4,It.data=Rr,!("type"in Nr)&&It.type===$u&&(It.type=uu(Rr));else if(qs(Rr))It.channels=It.channels||4,Sf(It,Rr),It.alignment=1,It.needsFree=!0;else if(ho(Rr)){var vo=Rr.data;!Array.isArray(vo)&&It.type===$u&&(It.type=uu(vo));var Qe=Rr.shape,xt=Rr.stride,Nt,Mr,Ar,Kt,nr,ur;Qe.length===3?(Ar=Qe[2],ur=xt[2]):(Ue(Qe.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Ar=1,ur=1),Nt=Qe[0],Mr=Qe[1],Kt=xt[0],nr=xt[1],It.alignment=1,It.width=Nt,It.height=Mr,It.channels=Ar,It.format=It.internalformat=tc[Ar],It.needsFree=!0,Tf(It,vo,Kt,nr,ur,Rr.offset)}else if(il(Rr)||Ec(Rr)||Eu(Rr))il(Rr)||Ec(Rr)?It.element=Rr:It.element=Rr.canvas,It.width=It.element.width,It.height=It.element.height,It.channels=4;else if(su(Rr))It.element=Rr,It.width=Rr.width,It.height=Rr.height,It.channels=4;else if(Lc(Rr))It.element=Rr,It.width=Rr.naturalWidth,It.height=Rr.naturalHeight,It.channels=4;else if(Rl(Rr))It.element=Rr,It.width=Rr.videoWidth,It.height=Rr.videoHeight,It.channels=4;else if(zn(Rr)){var Dt=It.width||Rr[0].length,Jt=It.height||Rr.length,gt=It.channels;bo(Rr[0][0])?gt=gt||Rr[0][0].length:gt=gt||1;for(var rr=gs.shape(Rr),zr=1,Yr=0;Yr<rr.length;++Yr)zr*=rr[Yr];var Sn=Bc(It,zr);gs.flatten(Rr,rr,"",Sn),Sc(It,Sn),It.alignment=1,It.width=Dt,It.height=Jt,It.channels=gt,It.format=It.internalformat=tc[gt],It.needsFree=!0}It.type===nl?Ue(Ut.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):It.type===Hu&&Ue(Ut.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function cn(It,Nr,Rr){var li=It.element,ha=It.data,vo=It.internalformat,Qe=It.format,xt=It.type,Nt=It.width,Mr=It.height;oa(It),li?Ee.texImage2D(Nr,Rr,Qe,Qe,xt,li):It.compressed?Ee.compressedTexImage2D(Nr,Rr,vo,Nt,Mr,0,ha):It.needsCopy?(Pr(),Ee.copyTexImage2D(Nr,Rr,Qe,It.xOffset,It.yOffset,Nt,Mr,0)):Ee.texImage2D(Nr,Rr,Qe,Nt,Mr,0,Qe,xt,ha||null)}function zi(It,Nr,Rr,li,ha){var vo=It.element,Qe=It.data,xt=It.internalformat,Nt=It.format,Mr=It.type,Ar=It.width,Kt=It.height;oa(It),vo?Ee.texSubImage2D(Nr,ha,Rr,li,Nt,Mr,vo):It.compressed?Ee.compressedTexSubImage2D(Nr,ha,Rr,li,xt,Ar,Kt,Qe):It.needsCopy?(Pr(),Ee.copyTexSubImage2D(Nr,ha,Rr,li,It.xOffset,It.yOffset,Ar,Kt)):Ee.texSubImage2D(Nr,ha,Rr,li,Ar,Kt,Nt,Mr,Qe)}var pa=[];function ui(){return pa.pop()||new ei}function va(It){It.needsFree&&G.freeType(It.data),ei.call(It),pa.push(It)}function aa(){En.call(this),this.genMipmaps=!1,this.mipmapHint=Ys,this.mipmask=0,this.images=Array(16)}function Yi(It,Nr,Rr){var li=It.images[0]=ui();It.mipmask=1,li.width=It.width=Nr,li.height=It.height=Rr,li.channels=It.channels=4}function Qa(It,Nr){var Rr=null;if(vs(Nr))Rr=It.images[0]=ui(),Qn(Rr,It),Pn(Rr,Nr),It.mipmask=1;else if(Ui(It,Nr),Array.isArray(Nr.mipmap))for(var li=Nr.mipmap,ha=0;ha<li.length;++ha)Rr=It.images[ha]=ui(),Qn(Rr,It),Rr.width>>=ha,Rr.height>>=ha,Pn(Rr,li[ha]),It.mipmask|=1<<ha;else Rr=It.images[0]=ui(),Qn(Rr,It),Pn(Rr,Nr),It.mipmask=1;Qn(It,It.images[0]),It.compressed&&(It.internalformat===Iu||It.internalformat===tl||It.internalformat===Ql||It.internalformat===Jl)&&Ue(It.width%4===0&&It.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Is(It,Nr){for(var Rr=It.images,li=0;li<Rr.length;++li){if(!Rr[li])return;cn(Rr[li],Nr,li)}}var du=[];function ba(){var It=du.pop()||new aa;En.call(It),It.mipmask=0;for(var Nr=0;Nr<16;++Nr)It.images[Nr]=null;return It}function Os(It){for(var Nr=It.images,Rr=0;Rr<Nr.length;++Rr)Nr[Rr]&&va(Nr[Rr]),Nr[Rr]=null;du.push(It)}function Lo(){this.minFilter=xu,this.magFilter=xu,this.wrapS=Wc,this.wrapT=Wc,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ys}function Us(It,Nr){if("min"in Nr){var Rr=Nr.min;Ue.parameter(Rr,Fn),It.minFilter=Fn[Rr],ec.indexOf(It.minFilter)>=0&&!("faces"in Nr)&&(It.genMipmaps=!0)}if("mag"in Nr){var li=Nr.mag;Ue.parameter(li,$n),It.magFilter=$n[li]}var ha=It.wrapS,vo=It.wrapT;if("wrap"in Nr){var Qe=Nr.wrap;typeof Qe=="string"?(Ue.parameter(Qe,An),ha=vo=An[Qe]):Array.isArray(Qe)&&(Ue.parameter(Qe[0],An),Ue.parameter(Qe[1],An),ha=An[Qe[0]],vo=An[Qe[1]])}else{if("wrapS"in Nr){var xt=Nr.wrapS;Ue.parameter(xt,An),ha=An[xt]}if("wrapT"in Nr){var Nt=Nr.wrapT;Ue.parameter(Nt,An),vo=An[Nt]}}if(It.wrapS=ha,It.wrapT=vo,"anisotropic"in Nr){var Mr=Nr.anisotropic;Ue(typeof Mr=="number"&&Mr>=1&&Mr<=Ut.maxAnisotropic,"aniso samples must be between 1 and "),It.anisotropic=Nr.anisotropic}if("mipmap"in Nr){var Ar=!1;switch(typeof Nr.mipmap){case"string":Ue.parameter(Nr.mipmap,Ln,"invalid mipmap hint"),It.mipmapHint=Ln[Nr.mipmap],It.genMipmaps=!0,Ar=!0;break;case"boolean":Ar=It.genMipmaps=Nr.mipmap;break;case"object":Ue(Array.isArray(Nr.mipmap),"invalid mipmap type"),It.genMipmaps=!1,Ar=!0;break;default:Ue.raise("invalid mipmap type")}Ar&&!("min"in Nr)&&(It.minFilter=_s)}}function zs(It,Nr){Ee.texParameteri(Nr,Gc,It.minFilter),Ee.texParameteri(Nr,bc,It.magFilter),Ee.texParameteri(Nr,Bf,It.wrapS),Ee.texParameteri(Nr,$c,It.wrapT),pt.ext_texture_filter_anisotropic&&Ee.texParameteri(Nr,lo,It.anisotropic),It.genMipmaps&&(Ee.hint(Ef,It.mipmapHint),Ee.generateMipmap(Nr))}var cs=0,Js={},Fu=Ut.maxTextureUnits,Zs=Array(Fu).map(function(){return null});function ca(It){En.call(this),this.mipmask=0,this.internalformat=ju,this.id=cs++,this.refCount=1,this.target=It,this.texture=Ee.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Lo,Tr.profile&&(this.stats={size:0})}function pu(It){Ee.activeTexture(Yc),Ee.bindTexture(It.target,It.texture)}function ta(){var It=Zs[0];It?Ee.bindTexture(It.target,It.texture):Ee.bindTexture(Jo,null)}function $i(It){var Nr=It.texture;Ue(Nr,"must not double destroy texture");var Rr=It.unit,li=It.target;Rr>=0&&(Ee.activeTexture(Yc+Rr),Ee.bindTexture(li,null),Zs[Rr]=null),Ee.deleteTexture(Nr),It.texture=null,It.params=null,It.pixels=null,It.refCount=0,delete Js[It.id],Lr.textureCount--}_(ca.prototype,{bind:function(){var It=this;It.bindCount+=1;var Nr=It.unit;if(Nr<0){for(var Rr=0;Rr<Fu;++Rr){var li=Zs[Rr];if(li){if(li.bindCount>0)continue;li.unit=-1}Zs[Rr]=It,Nr=Rr;break}Nr>=Fu&&Ue.raise("insufficient number of texture units"),Tr.profile&&Lr.maxTextureUnits<Nr+1&&(Lr.maxTextureUnits=Nr+1),It.unit=Nr,Ee.activeTexture(Yc+Nr),Ee.bindTexture(It.target,It.texture)}return Nr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$i(this)}});function xa(It,Nr){var Rr=new ca(Jo);Js[Rr.id]=Rr,Lr.textureCount++;function li(Qe,xt){var Nt=Rr.texInfo;Lo.call(Nt);var Mr=ba();return typeof Qe=="number"?typeof xt=="number"?Yi(Mr,Qe|0,xt|0):Yi(Mr,Qe|0,Qe|0):Qe?(Ue.type(Qe,"object","invalid arguments to regl.texture"),Us(Nt,Qe),Qa(Mr,Qe)):Yi(Mr,1,1),Nt.genMipmaps&&(Mr.mipmask=(Mr.width<<1)-1),Rr.mipmask=Mr.mipmask,Qn(Rr,Mr),Ue.texture2D(Nt,Mr,Ut),Rr.internalformat=Mr.internalformat,li.width=Mr.width,li.height=Mr.height,pu(Rr),Is(Mr,Jo),zs(Nt,Jo),ta(),Os(Mr),Tr.profile&&(Rr.stats.size=Su(Rr.internalformat,Rr.type,Mr.width,Mr.height,Nt.genMipmaps,!1)),li.format=Bn[Rr.internalformat],li.type=ni[Rr.type],li.mag=bn[Nt.magFilter],li.min=si[Nt.minFilter],li.wrapS=Mn[Nt.wrapS],li.wrapT=Mn[Nt.wrapT],li}function ha(Qe,xt,Nt,Mr){Ue(!!Qe,"must specify image data");var Ar=xt|0,Kt=Nt|0,nr=Mr|0,ur=ui();return Qn(ur,Rr),ur.width=0,ur.height=0,Pn(ur,Qe),ur.width=ur.width||(Rr.width>>nr)-Ar,ur.height=ur.height||(Rr.height>>nr)-Kt,Ue(Rr.type===ur.type&&Rr.format===ur.format&&Rr.internalformat===ur.internalformat,"incompatible format for texture.subimage"),Ue(Ar>=0&&Kt>=0&&Ar+ur.width<=Rr.width&&Kt+ur.height<=Rr.height,"texture.subimage write out of bounds"),Ue(Rr.mipmask&1<<nr,"missing mipmap data"),Ue(ur.data||ur.element||ur.needsCopy,"missing image data"),pu(Rr),zi(ur,Jo,Ar,Kt,nr),ta(),va(ur),li}function vo(Qe,xt){var Nt=Qe|0,Mr=xt|0||Nt;if(Nt===Rr.width&&Mr===Rr.height)return li;li.width=Rr.width=Nt,li.height=Rr.height=Mr,pu(Rr);for(var Ar=0;Rr.mipmask>>Ar;++Ar){var Kt=Nt>>Ar,nr=Mr>>Ar;if(!Kt||!nr)break;Ee.texImage2D(Jo,Ar,Rr.format,Kt,nr,0,Rr.format,Rr.type,null)}return ta(),Tr.profile&&(Rr.stats.size=Su(Rr.internalformat,Rr.type,Nt,Mr,!1,!1)),li}return li(It,Nr),li.subimage=ha,li.resize=vo,li._reglType="texture2d",li._texture=Rr,Tr.profile&&(li.stats=Rr.stats),li.destroy=function(){Rr.decRef()},li}function Ha(It,Nr,Rr,li,ha,vo){var Qe=new ca(Zu);Js[Qe.id]=Qe,Lr.cubeCount++;var xt=new Array(6);function Nt(Kt,nr,ur,Dt,Jt,gt){var rr,zr=Qe.texInfo;for(Lo.call(zr),rr=0;rr<6;++rr)xt[rr]=ba();if(typeof Kt=="number"||!Kt){var Yr=Kt|0||1;for(rr=0;rr<6;++rr)Yi(xt[rr],Yr,Yr)}else if(typeof Kt=="object")if(nr)Qa(xt[0],Kt),Qa(xt[1],nr),Qa(xt[2],ur),Qa(xt[3],Dt),Qa(xt[4],Jt),Qa(xt[5],gt);else if(Us(zr,Kt),Ui(Qe,Kt),"faces"in Kt){var Sn=Kt.faces;for(Ue(Array.isArray(Sn)&&Sn.length===6,"cube faces must be a length 6 array"),rr=0;rr<6;++rr)Ue(typeof Sn[rr]=="object"&&!!Sn[rr],"invalid input for cube map face"),Qn(xt[rr],Qe),Qa(xt[rr],Sn[rr])}else for(rr=0;rr<6;++rr)Qa(xt[rr],Kt);else Ue.raise("invalid arguments to cube map");for(Qn(Qe,xt[0]),Ut.npotTextureCube||Ue(mf(Qe.width)&&mf(Qe.height),"your browser does not support non power or two texture dimensions"),zr.genMipmaps?Qe.mipmask=(xt[0].width<<1)-1:Qe.mipmask=xt[0].mipmask,Ue.textureCube(Qe,zr,xt,Ut),Qe.internalformat=xt[0].internalformat,Nt.width=xt[0].width,Nt.height=xt[0].height,pu(Qe),rr=0;rr<6;++rr)Is(xt[rr],Mu+rr);for(zs(zr,Zu),ta(),Tr.profile&&(Qe.stats.size=Su(Qe.internalformat,Qe.type,Nt.width,Nt.height,zr.genMipmaps,!0)),Nt.format=Bn[Qe.internalformat],Nt.type=ni[Qe.type],Nt.mag=bn[zr.magFilter],Nt.min=si[zr.minFilter],Nt.wrapS=Mn[zr.wrapS],Nt.wrapT=Mn[zr.wrapT],rr=0;rr<6;++rr)Os(xt[rr]);return Nt}function Mr(Kt,nr,ur,Dt,Jt){Ue(!!nr,"must specify image data"),Ue(typeof Kt=="number"&&Kt===(Kt|0)&&Kt>=0&&Kt<6,"invalid face");var gt=ur|0,rr=Dt|0,zr=Jt|0,Yr=ui();return Qn(Yr,Qe),Yr.width=0,Yr.height=0,Pn(Yr,nr),Yr.width=Yr.width||(Qe.width>>zr)-gt,Yr.height=Yr.height||(Qe.height>>zr)-rr,Ue(Qe.type===Yr.type&&Qe.format===Yr.format&&Qe.internalformat===Yr.internalformat,"incompatible format for texture.subimage"),Ue(gt>=0&&rr>=0&&gt+Yr.width<=Qe.width&&rr+Yr.height<=Qe.height,"texture.subimage write out of bounds"),Ue(Qe.mipmask&1<<zr,"missing mipmap data"),Ue(Yr.data||Yr.element||Yr.needsCopy,"missing image data"),pu(Qe),zi(Yr,Mu+Kt,gt,rr,zr),ta(),va(Yr),Nt}function Ar(Kt){var nr=Kt|0;if(nr!==Qe.width){Nt.width=Qe.width=nr,Nt.height=Qe.height=nr,pu(Qe);for(var ur=0;ur<6;++ur)for(var Dt=0;Qe.mipmask>>Dt;++Dt)Ee.texImage2D(Mu+ur,Dt,Qe.format,nr>>Dt,nr>>Dt,0,Qe.format,Qe.type,null);return ta(),Tr.profile&&(Qe.stats.size=Su(Qe.internalformat,Qe.type,Nt.width,Nt.height,!1,!0)),Nt}}return Nt(It,Nr,Rr,li,ha,vo),Nt.subimage=Mr,Nt.resize=Ar,Nt._reglType="textureCube",Nt._texture=Qe,Tr.profile&&(Nt.stats=Qe.stats),Nt.destroy=function(){Qe.decRef()},Nt}function Es(){for(var It=0;It<Fu;++It)Ee.activeTexture(Yc+It),Ee.bindTexture(Jo,null),Zs[It]=null;ja(Js).forEach($i),Lr.cubeCount=0,Lr.textureCount=0}Tr.profile&&(Lr.getTotalTextureSize=function(){var It=0;return Object.keys(Js).forEach(function(Nr){It+=Js[Nr].stats.size}),It});function wc(){for(var It=0;It<Fu;++It){var Nr=Zs[It];Nr&&(Nr.bindCount=0,Nr.unit=-1,Zs[It]=null)}ja(Js).forEach(function(Rr){Rr.texture=Ee.createTexture(),Ee.bindTexture(Rr.target,Rr.texture);for(var li=0;li<32;++li)if(Rr.mipmask&1<<li)if(Rr.target===Jo)Ee.texImage2D(Jo,li,Rr.internalformat,Rr.width>>li,Rr.height>>li,0,Rr.internalformat,Rr.type,null);else for(var ha=0;ha<6;++ha)Ee.texImage2D(Mu+ha,li,Rr.internalformat,Rr.width>>li,Rr.height>>li,0,Rr.internalformat,Rr.type,null);zs(Rr.texInfo,Rr.target)})}return{create2D:xa,createCube:Ha,clear:Es,getTexture:function(It){return null},restore:wc}}var ea=36161,Qs=32854,Tu=32855,Ga=36194,Ml=33189,al=36168,lu=34041,es=35907,ic=34836,Ci=34842,rn=34843,cu=[];cu[Qs]=2,cu[Tu]=2,cu[Ga]=2,cu[Ml]=2,cu[al]=1,cu[lu]=4,cu[es]=4,cu[ic]=16,cu[Ci]=8,cu[rn]=6;function ws(Ee,pt,Ut){return cu[Ee]*pt*Ut}var fu=function(Ee,pt,Ut,Pr,ln){var Lr={rgba4:Qs,rgb565:Ga,"rgb5 a1":Tu,depth:Ml,stencil:al,"depth stencil":lu};pt.ext_srgb&&(Lr.srgba=es),pt.ext_color_buffer_half_float&&(Lr.rgba16f=Ci,Lr.rgb16f=rn),pt.webgl_color_buffer_float&&(Lr.rgba32f=ic);var Tr=[];Object.keys(Lr).forEach(function(Cn){var Vn=Lr[Cn];Tr[Vn]=Cn});var Ln=0,An={};function $n(Cn){this.id=Ln++,this.refCount=1,this.renderbuffer=Cn,this.format=Qs,this.width=0,this.height=0,ln.profile&&(this.stats={size:0})}$n.prototype.decRef=function(){--this.refCount<=0&&Fn(this)};function Fn(Cn){var Vn=Cn.renderbuffer;Ue(Vn,"must not double destroy renderbuffer"),Ee.bindRenderbuffer(ea,null),Ee.deleteRenderbuffer(Vn),Cn.renderbuffer=null,Cn.refCount=0,delete An[Cn.id],Pr.renderbufferCount--}function jn(Cn,Vn){var _r=new $n(Ee.createRenderbuffer());An[_r.id]=_r,Pr.renderbufferCount++;function Gr(ni,bn){var si=0,Mn=0,ii=Qs;if(typeof ni=="object"&&ni){var En=ni;if("shape"in En){var Qn=En.shape;Ue(Array.isArray(Qn)&&Qn.length>=2,"invalid renderbuffer shape"),si=Qn[0]|0,Mn=Qn[1]|0}else"radius"in En&&(si=Mn=En.radius|0),"width"in En&&(si=En.width|0),"height"in En&&(Mn=En.height|0);"format"in En&&(Ue.parameter(En.format,Lr,"invalid renderbuffer format"),ii=Lr[En.format])}else typeof ni=="number"?(si=ni|0,typeof bn=="number"?Mn=bn|0:Mn=si):ni?Ue.raise("invalid arguments to renderbuffer constructor"):si=Mn=1;if(Ue(si>0&&Mn>0&&si<=Ut.maxRenderbufferSize&&Mn<=Ut.maxRenderbufferSize,"invalid renderbuffer size"),!(si===_r.width&&Mn===_r.height&&ii===_r.format))return Gr.width=_r.width=si,Gr.height=_r.height=Mn,_r.format=ii,Ee.bindRenderbuffer(ea,_r.renderbuffer),Ee.renderbufferStorage(ea,ii,si,Mn),Ue(Ee.getError()===0,"invalid render buffer format"),ln.profile&&(_r.stats.size=ws(_r.format,_r.width,_r.height)),Gr.format=Tr[_r.format],Gr}function Bn(ni,bn){var si=ni|0,Mn=bn|0||si;return si===_r.width&&Mn===_r.height||(Ue(si>0&&Mn>0&&si<=Ut.maxRenderbufferSize&&Mn<=Ut.maxRenderbufferSize,"invalid renderbuffer size"),Gr.width=_r.width=si,Gr.height=_r.height=Mn,Ee.bindRenderbuffer(ea,_r.renderbuffer),Ee.renderbufferStorage(ea,_r.format,si,Mn),Ue(Ee.getError()===0,"invalid render buffer format"),ln.profile&&(_r.stats.size=ws(_r.format,_r.width,_r.height))),Gr}return Gr(Cn,Vn),Gr.resize=Bn,Gr._reglType="renderbuffer",Gr._renderbuffer=_r,ln.profile&&(Gr.stats=_r.stats),Gr.destroy=function(){_r.decRef()},Gr}ln.profile&&(Pr.getTotalRenderbufferSize=function(){var Cn=0;return Object.keys(An).forEach(function(Vn){Cn+=An[Vn].stats.size}),Cn});function Kn(){ja(An).forEach(function(Cn){Cn.renderbuffer=Ee.createRenderbuffer(),Ee.bindRenderbuffer(ea,Cn.renderbuffer),Ee.renderbufferStorage(ea,Cn.format,Cn.width,Cn.height)}),Ee.bindRenderbuffer(ea,null)}return{create:jn,clear:function(){ja(An).forEach(Fn)},restore:Kn}},Ro=36160,Fs=36161,ku=3553,Il=34069,Na=36064,No=36096,ao=36128,ol=33306,sl=36053,ul=36054,hu=36055,Tc=36057,ll=36061,Kc=36193,ac=5121,Vi=5126,Ol=6407,Pl=6408,yo=6402,Gu=[Ol,Pl],Ii=[];Ii[Pl]=4,Ii[Ol]=3;var Ns=[];Ns[ac]=1,Ns[Vi]=4,Ns[Kc]=2;var cl=32854,eo=32855,Wo=36194,Wl=33189,oc=36168,Ra=34041,Gl=35907,l=34836,d=34842,f=34843,m=[cl,eo,Wo,Gl,d,f,l],S={};S[sl]="complete",S[ul]="incomplete attachment",S[Tc]="incomplete dimensions",S[hu]="incomplete, missing attachment",S[ll]="unsupported";function R(Ee,pt,Ut,Pr,ln,Lr){var Tr={cur:null,next:null,dirty:!1,setFBO:null},Ln=["rgba"],An=["rgba4","rgb565","rgb5 a1"];pt.ext_srgb&&An.push("srgba"),pt.ext_color_buffer_half_float&&An.push("rgba16f","rgb16f"),pt.webgl_color_buffer_float&&An.push("rgba32f");var $n=["uint8"];pt.oes_texture_half_float&&$n.push("half float","float16"),pt.oes_texture_float&&$n.push("float","float32");function Fn(ei,Pn,cn){this.target=ei,this.texture=Pn,this.renderbuffer=cn;var zi=0,pa=0;Pn?(zi=Pn.width,pa=Pn.height):cn&&(zi=cn.width,pa=cn.height),this.width=zi,this.height=pa}function jn(ei){ei&&(ei.texture&&ei.texture._texture.decRef(),ei.renderbuffer&&ei.renderbuffer._renderbuffer.decRef())}function Kn(ei,Pn,cn){if(ei)if(ei.texture){var zi=ei.texture._texture,pa=Math.max(1,zi.width),ui=Math.max(1,zi.height);Ue(pa===Pn&&ui===cn,"inconsistent width/height for supplied texture"),zi.refCount+=1}else{var va=ei.renderbuffer._renderbuffer;Ue(va.width===Pn&&va.height===cn,"inconsistent width/height for renderbuffer"),va.refCount+=1}}function Cn(ei,Pn){Pn&&(Pn.texture?Ee.framebufferTexture2D(Ro,ei,Pn.target,Pn.texture._texture.texture,0):Ee.framebufferRenderbuffer(Ro,ei,Fs,Pn.renderbuffer._renderbuffer.renderbuffer))}function Vn(ei){var Pn=ku,cn=null,zi=null,pa=ei;typeof ei=="object"&&(pa=ei.data,"target"in ei&&(Pn=ei.target|0)),Ue.type(pa,"function","invalid attachment data");var ui=pa._reglType;return ui==="texture2d"?(cn=pa,Ue(Pn===ku)):ui==="textureCube"?(cn=pa,Ue(Pn>=Il&&Pn<Il+6,"invalid cube map target")):ui==="renderbuffer"?(zi=pa,Pn=Fs):Ue.raise("invalid regl object for attachment"),new Fn(Pn,cn,zi)}function _r(ei,Pn,cn,zi,pa){if(cn){var ui=Pr.create2D({width:ei,height:Pn,format:zi,type:pa});return ui._texture.refCount=0,new Fn(ku,ui,null)}else{var va=ln.create({width:ei,height:Pn,format:zi});return va._renderbuffer.refCount=0,new Fn(Fs,null,va)}}function Gr(ei){return ei&&(ei.texture||ei.renderbuffer)}function Bn(ei,Pn,cn){ei&&(ei.texture?ei.texture.resize(Pn,cn):ei.renderbuffer&&ei.renderbuffer.resize(Pn,cn),ei.width=Pn,ei.height=cn)}var ni=0,bn={};function si(){this.id=ni++,bn[this.id]=this,this.framebuffer=Ee.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Mn(ei){ei.colorAttachments.forEach(jn),jn(ei.depthAttachment),jn(ei.stencilAttachment),jn(ei.depthStencilAttachment)}function ii(ei){var Pn=ei.framebuffer;Ue(Pn,"must not double destroy framebuffer"),Ee.deleteFramebuffer(Pn),ei.framebuffer=null,Lr.framebufferCount--,delete bn[ei.id]}function En(ei){var Pn;Ee.bindFramebuffer(Ro,ei.framebuffer);var cn=ei.colorAttachments;for(Pn=0;Pn<cn.length;++Pn)Cn(Na+Pn,cn[Pn]);for(Pn=cn.length;Pn<Ut.maxColorAttachments;++Pn)Ee.framebufferTexture2D(Ro,Na+Pn,ku,null,0);Ee.framebufferTexture2D(Ro,ol,ku,null,0),Ee.framebufferTexture2D(Ro,No,ku,null,0),Ee.framebufferTexture2D(Ro,ao,ku,null,0),Cn(No,ei.depthAttachment),Cn(ao,ei.stencilAttachment),Cn(ol,ei.depthStencilAttachment);var zi=Ee.checkFramebufferStatus(Ro);!Ee.isContextLost()&&zi!==sl&&Ue.raise("framebuffer configuration not supported, status = "+S[zi]),Ee.bindFramebuffer(Ro,Tr.next?Tr.next.framebuffer:null),Tr.cur=Tr.next,Ee.getError()}function Qn(ei,Pn){var cn=new si;Lr.framebufferCount++;function zi(ui,va){var aa;Ue(Tr.next!==cn,"can not update framebuffer which is currently in use");var Yi=0,Qa=0,Is=!0,du=!0,ba=null,Os=!0,Lo="rgba",Us="uint8",zs=1,cs=null,Js=null,Fu=null,Zs=!1;if(typeof ui=="number")Yi=ui|0,Qa=va|0||Yi;else if(!ui)Yi=Qa=1;else{Ue.type(ui,"object","invalid arguments for framebuffer");var ca=ui;if("shape"in ca){var pu=ca.shape;Ue(Array.isArray(pu)&&pu.length>=2,"invalid shape for framebuffer"),Yi=pu[0],Qa=pu[1]}else"radius"in ca&&(Yi=Qa=ca.radius),"width"in ca&&(Yi=ca.width),"height"in ca&&(Qa=ca.height);("color"in ca||"colors"in ca)&&(ba=ca.color||ca.colors,Array.isArray(ba)&&Ue(ba.length===1||pt.webgl_draw_buffers,"multiple render targets not supported")),ba||("colorCount"in ca&&(zs=ca.colorCount|0,Ue(zs>0,"invalid color buffer count")),"colorTexture"in ca&&(Os=!!ca.colorTexture,Lo="rgba4"),"colorType"in ca&&(Us=ca.colorType,Os?(Ue(pt.oes_texture_float||!(Us==="float"||Us==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Ue(pt.oes_texture_half_float||!(Us==="half float"||Us==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Us==="half float"||Us==="float16"?(Ue(pt.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Lo="rgba16f"):(Us==="float"||Us==="float32")&&(Ue(pt.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Lo="rgba32f"),Ue.oneOf(Us,$n,"invalid color type")),"colorFormat"in ca&&(Lo=ca.colorFormat,Ln.indexOf(Lo)>=0?Os=!0:An.indexOf(Lo)>=0?Os=!1:Os?Ue.oneOf(ca.colorFormat,Ln,"invalid color format for texture"):Ue.oneOf(ca.colorFormat,An,"invalid color format for renderbuffer"))),("depthTexture"in ca||"depthStencilTexture"in ca)&&(Zs=!!(ca.depthTexture||ca.depthStencilTexture),Ue(!Zs||pt.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ca&&(typeof ca.depth=="boolean"?Is=ca.depth:(cs=ca.depth,du=!1)),"stencil"in ca&&(typeof ca.stencil=="boolean"?du=ca.stencil:(Js=ca.stencil,Is=!1)),"depthStencil"in ca&&(typeof ca.depthStencil=="boolean"?Is=du=ca.depthStencil:(Fu=ca.depthStencil,Is=!1,du=!1))}var ta=null,$i=null,xa=null,Ha=null;if(Array.isArray(ba))ta=ba.map(Vn);else if(ba)ta=[Vn(ba)];else for(ta=new Array(zs),aa=0;aa<zs;++aa)ta[aa]=_r(Yi,Qa,Os,Lo,Us);Ue(pt.webgl_draw_buffers||ta.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Ue(ta.length<=Ut.maxColorAttachments,"too many color attachments, not supported"),Yi=Yi||ta[0].width,Qa=Qa||ta[0].height,cs?$i=Vn(cs):Is&&!du&&($i=_r(Yi,Qa,Zs,"depth","uint32")),Js?xa=Vn(Js):du&&!Is&&(xa=_r(Yi,Qa,!1,"stencil","uint8")),Fu?Ha=Vn(Fu):!cs&&!Js&&du&&Is&&(Ha=_r(Yi,Qa,Zs,"depth stencil","depth stencil")),Ue(!!cs+!!Js+!!Fu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Es=null;for(aa=0;aa<ta.length;++aa)if(Kn(ta[aa],Yi,Qa),Ue(!ta[aa]||ta[aa].texture&&Gu.indexOf(ta[aa].texture._texture.format)>=0||ta[aa].renderbuffer&&m.indexOf(ta[aa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+aa+" is invalid"),ta[aa]&&ta[aa].texture){var wc=Ii[ta[aa].texture._texture.format]*Ns[ta[aa].texture._texture.type];Es===null?Es=wc:Ue(Es===wc,"all color attachments much have the same number of bits per pixel.")}return Kn($i,Yi,Qa),Ue(!$i||$i.texture&&$i.texture._texture.format===yo||$i.renderbuffer&&$i.renderbuffer._renderbuffer.format===Wl,"invalid depth attachment for framebuffer object"),Kn(xa,Yi,Qa),Ue(!xa||xa.renderbuffer&&xa.renderbuffer._renderbuffer.format===oc,"invalid stencil attachment for framebuffer object"),Kn(Ha,Yi,Qa),Ue(!Ha||Ha.texture&&Ha.texture._texture.format===Ra||Ha.renderbuffer&&Ha.renderbuffer._renderbuffer.format===Ra,"invalid depth-stencil attachment for framebuffer object"),Mn(cn),cn.width=Yi,cn.height=Qa,cn.colorAttachments=ta,cn.depthAttachment=$i,cn.stencilAttachment=xa,cn.depthStencilAttachment=Ha,zi.color=ta.map(Gr),zi.depth=Gr($i),zi.stencil=Gr(xa),zi.depthStencil=Gr(Ha),zi.width=cn.width,zi.height=cn.height,En(cn),zi}function pa(ui,va){Ue(Tr.next!==cn,"can not resize a framebuffer which is currently in use");var aa=Math.max(ui|0,1),Yi=Math.max(va|0||aa,1);if(aa===cn.width&&Yi===cn.height)return zi;for(var Qa=cn.colorAttachments,Is=0;Is<Qa.length;++Is)Bn(Qa[Is],aa,Yi);return Bn(cn.depthAttachment,aa,Yi),Bn(cn.stencilAttachment,aa,Yi),Bn(cn.depthStencilAttachment,aa,Yi),cn.width=zi.width=aa,cn.height=zi.height=Yi,En(cn),zi}return zi(ei,Pn),_(zi,{resize:pa,_reglType:"framebuffer",_framebuffer:cn,destroy:function(){ii(cn),Mn(cn)},use:function(ui){Tr.setFBO({framebuffer:zi},ui)}})}function Ui(ei){var Pn=Array(6);function cn(pa){var ui;Ue(Pn.indexOf(Tr.next)<0,"can not update framebuffer which is currently in use");var va={color:null},aa=0,Yi=null,Qa="rgba",Is="uint8",du=1;if(typeof pa=="number")aa=pa|0;else if(!pa)aa=1;else{Ue.type(pa,"object","invalid arguments for framebuffer");var ba=pa;if("shape"in ba){var Os=ba.shape;Ue(Array.isArray(Os)&&Os.length>=2,"invalid shape for framebuffer"),Ue(Os[0]===Os[1],"cube framebuffer must be square"),aa=Os[0]}else"radius"in ba&&(aa=ba.radius|0),"width"in ba?(aa=ba.width|0,"height"in ba&&Ue(ba.height===aa,"must be square")):"height"in ba&&(aa=ba.height|0);("color"in ba||"colors"in ba)&&(Yi=ba.color||ba.colors,Array.isArray(Yi)&&Ue(Yi.length===1||pt.webgl_draw_buffers,"multiple render targets not supported")),Yi||("colorCount"in ba&&(du=ba.colorCount|0,Ue(du>0,"invalid color buffer count")),"colorType"in ba&&(Ue.oneOf(ba.colorType,$n,"invalid color type"),Is=ba.colorType),"colorFormat"in ba&&(Qa=ba.colorFormat,Ue.oneOf(ba.colorFormat,Ln,"invalid color format for texture"))),"depth"in ba&&(va.depth=ba.depth),"stencil"in ba&&(va.stencil=ba.stencil),"depthStencil"in ba&&(va.depthStencil=ba.depthStencil)}var Lo;if(Yi)if(Array.isArray(Yi))for(Lo=[],ui=0;ui<Yi.length;++ui)Lo[ui]=Yi[ui];else Lo=[Yi];else{Lo=Array(du);var Us={radius:aa,format:Qa,type:Is};for(ui=0;ui<du;++ui)Lo[ui]=Pr.createCube(Us)}for(va.color=Array(Lo.length),ui=0;ui<Lo.length;++ui){var zs=Lo[ui];Ue(typeof zs=="function"&&zs._reglType==="textureCube","invalid cube map"),aa=aa||zs.width,Ue(zs.width===aa&&zs.height===aa,"invalid cube map shape"),va.color[ui]={target:Il,data:Lo[ui]}}for(ui=0;ui<6;++ui){for(var cs=0;cs<Lo.length;++cs)va.color[cs].target=Il+ui;ui>0&&(va.depth=Pn[0].depth,va.stencil=Pn[0].stencil,va.depthStencil=Pn[0].depthStencil),Pn[ui]?Pn[ui](va):Pn[ui]=Qn(va)}return _(cn,{width:aa,height:aa,color:Lo})}function zi(pa){var ui,va=pa|0;if(Ue(va>0&&va<=Ut.maxCubeMapSize,"invalid radius for cube fbo"),va===cn.width)return cn;var aa=cn.color;for(ui=0;ui<aa.length;++ui)aa[ui].resize(va);for(ui=0;ui<6;++ui)Pn[ui].resize(va);return cn.width=cn.height=va,cn}return cn(ei),_(cn,{faces:Pn,resize:zi,_reglType:"framebufferCube",destroy:function(){Pn.forEach(function(pa){pa.destroy()})}})}function oa(){Tr.cur=null,Tr.next=null,Tr.dirty=!0,ja(bn).forEach(function(ei){ei.framebuffer=Ee.createFramebuffer(),En(ei)})}return _(Tr,{getFramebuffer:function(ei){if(typeof ei=="function"&&ei._reglType==="framebuffer"){var Pn=ei._framebuffer;if(Pn instanceof si)return Pn}return null},create:Qn,createCube:Ui,clear:function(){ja(bn).forEach(ii)},restore:oa})}var L=5126,q=34962;function Se(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=L,this.offset=0,this.stride=0,this.divisor=0}function Le(Ee,pt,Ut,Pr,ln){for(var Lr=Ut.maxAttributes,Tr=new Array(Lr),Ln=0;Ln<Lr;++Ln)Tr[Ln]=new Se;var An=0,$n={},Fn={Record:Se,scope:{},state:Tr,currentVAO:null,targetVAO:null,restore:Kn()?bn:function(){},createVAO:si,getVAO:Vn,destroyBuffer:jn,setVAO:Kn()?_r:Gr,clear:Kn()?Bn:function(){}};function jn(Mn){for(var ii=0;ii<Tr.length;++ii){var En=Tr[ii];En.buffer===Mn&&(Ee.disableVertexAttribArray(ii),En.buffer=null)}}function Kn(){return pt.oes_vertex_array_object}function Cn(){return pt.angle_instanced_arrays}function Vn(Mn){return typeof Mn=="function"&&Mn._vao?Mn._vao:null}function _r(Mn){if(Mn!==Fn.currentVAO){var ii=Kn();Mn?ii.bindVertexArrayOES(Mn.vao):ii.bindVertexArrayOES(null),Fn.currentVAO=Mn}}function Gr(Mn){if(Mn!==Fn.currentVAO){if(Mn)Mn.bindAttrs();else for(var ii=Cn(),En=0;En<Tr.length;++En){var Qn=Tr[En];Qn.buffer?(Ee.enableVertexAttribArray(En),Ee.vertexAttribPointer(En,Qn.size,Qn.type,Qn.normalized,Qn.stride,Qn.offfset),ii&&ii.vertexAttribDivisorANGLE(En,Qn.divisor)):(Ee.disableVertexAttribArray(En),Ee.vertexAttrib4f(En,Qn.x,Qn.y,Qn.z,Qn.w))}Fn.currentVAO=Mn}}function Bn(){ja($n).forEach(function(Mn){Mn.destroy()})}function ni(){this.id=++An,this.attributes=[];var Mn=Kn();Mn?this.vao=Mn.createVertexArrayOES():this.vao=null,$n[this.id]=this,this.buffers=[]}ni.prototype.bindAttrs=function(){for(var Mn=Cn(),ii=this.attributes,En=0;En<ii.length;++En){var Qn=ii[En];Qn.buffer?(Ee.enableVertexAttribArray(En),Ee.bindBuffer(q,Qn.buffer.buffer),Ee.vertexAttribPointer(En,Qn.size,Qn.type,Qn.normalized,Qn.stride,Qn.offset),Mn&&Mn.vertexAttribDivisorANGLE(En,Qn.divisor)):(Ee.disableVertexAttribArray(En),Ee.vertexAttrib4f(En,Qn.x,Qn.y,Qn.z,Qn.w))}for(var Ui=ii.length;Ui<Lr;++Ui)Ee.disableVertexAttribArray(Ui)},ni.prototype.refresh=function(){var Mn=Kn();Mn&&(Mn.bindVertexArrayOES(this.vao),this.bindAttrs(),Fn.currentVAO=this)},ni.prototype.destroy=function(){if(this.vao){var Mn=Kn();this===Fn.currentVAO&&(Fn.currentVAO=null,Mn.bindVertexArrayOES(null)),Mn.deleteVertexArrayOES(this.vao),this.vao=null}$n[this.id]&&(delete $n[this.id],Pr.vaoCount-=1)};function bn(){var Mn=Kn();Mn&&ja($n).forEach(function(ii){ii.refresh()})}function si(Mn){var ii=new ni;Pr.vaoCount+=1;function En(Qn){Ue(Array.isArray(Qn),"arguments to vertex array constructor must be an array"),Ue(Qn.length<Lr,"too many attributes"),Ue(Qn.length>0,"must specify at least one attribute");for(var Ui=0;Ui<ii.buffers.length;++Ui)ii.buffers[Ui].destroy();ii.buffers.length=0;var oa=ii.attributes;oa.length=Qn.length;for(var ei=0;ei<Qn.length;++ei){var Pn=Qn[ei],cn=oa[ei]=new Se;if(Array.isArray(Pn)||E(Pn)||ho(Pn)){var zi=ln.create(Pn,q,!1,!0);cn.buffer=ln.getBuffer(zi),cn.size=cn.buffer.dimension|0,cn.normalized=!1,cn.type=cn.buffer.dtype,cn.offset=0,cn.stride=0,cn.divisor=0,cn.state=1,ii.buffers.push(zi)}else ln.getBuffer(Pn)?(cn.buffer=ln.getBuffer(Pn),cn.size=cn.buffer.dimension|0,cn.normalized=!1,cn.type=cn.buffer.dtype,cn.offset=0,cn.stride=0,cn.divisor=0,cn.state=1):ln.getBuffer(Pn.buffer)?(cn.buffer=ln.getBuffer(Pn.buffer),cn.size=(+Pn.size||cn.buffer.dimension)|0,cn.normalized=!!Pn.normalized||!1,"type"in Pn?(Ue.parameter(Pn.type,ys,"invalid buffer type"),cn.type=ys[Pn.type]):cn.type=cn.buffer.dtype,cn.offset=(Pn.offset||0)|0,cn.stride=(Pn.stride||0)|0,cn.divisor=(Pn.divisor||0)|0,cn.state=1,Ue(cn.size>=1&&cn.size<=4,"size must be between 1 and 4"),Ue(cn.offset>=0,"invalid offset"),Ue(cn.stride>=0&&cn.stride<=255,"stride must be between 0 and 255"),Ue(cn.divisor>=0,"divisor must be positive"),Ue(!cn.divisor||!!pt.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Pn?(Ue(ei>0,"first attribute must not be a constant"),cn.x=+Pn.x||0,cn.y=+Pn.y||0,cn.z=+Pn.z||0,cn.w=+Pn.w||0,cn.state=2):Ue(!1,"invalid attribute spec for location "+ei)}return ii.refresh(),En}return En.destroy=function(){ii.destroy()},En._vao=ii,En._reglType="vao",En(Mn)}return Fn}var et=35632,ot=35633,st=35718,Rt=35721;function Ct(Ee,pt,Ut,Pr){var ln={},Lr={};function Tr(_r,Gr,Bn,ni){this.name=_r,this.id=Gr,this.location=Bn,this.info=ni}function Ln(_r,Gr){for(var Bn=0;Bn<_r.length;++Bn)if(_r[Bn].id===Gr.id){_r[Bn].location=Gr.location;return}_r.push(Gr)}function An(_r,Gr,Bn){var ni=_r===et?ln:Lr,bn=ni[Gr];if(!bn){var si=pt.str(Gr);bn=Ee.createShader(_r),Ee.shaderSource(bn,si),Ee.compileShader(bn),Ue.shaderError(Ee,bn,si,_r,Bn),ni[Gr]=bn}return bn}var $n={},Fn=[],jn=0;function Kn(_r,Gr){this.id=jn++,this.fragId=_r,this.vertId=Gr,this.program=null,this.uniforms=[],this.attributes=[],Pr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Cn(_r,Gr,Bn){var ni,bn,si=An(et,_r.fragId),Mn=An(ot,_r.vertId),ii=_r.program=Ee.createProgram();if(Ee.attachShader(ii,si),Ee.attachShader(ii,Mn),Bn)for(ni=0;ni<Bn.length;++ni){var En=Bn[ni];Ee.bindAttribLocation(ii,En[0],En[1])}Ee.linkProgram(ii),Ue.linkError(Ee,ii,pt.str(_r.fragId),pt.str(_r.vertId),Gr);var Qn=Ee.getProgramParameter(ii,st);Pr.profile&&(_r.stats.uniformsCount=Qn);var Ui=_r.uniforms;for(ni=0;ni<Qn;++ni)if(bn=Ee.getActiveUniform(ii,ni),bn)if(bn.size>1)for(var oa=0;oa<bn.size;++oa){var ei=bn.name.replace("[0]","["+oa+"]");Ln(Ui,new Tr(ei,pt.id(ei),Ee.getUniformLocation(ii,ei),bn))}else Ln(Ui,new Tr(bn.name,pt.id(bn.name),Ee.getUniformLocation(ii,bn.name),bn));var Pn=Ee.getProgramParameter(ii,Rt);Pr.profile&&(_r.stats.attributesCount=Pn);var cn=_r.attributes;for(ni=0;ni<Pn;++ni)bn=Ee.getActiveAttrib(ii,ni),bn&&Ln(cn,new Tr(bn.name,pt.id(bn.name),Ee.getAttribLocation(ii,bn.name),bn))}Pr.profile&&(Ut.getMaxUniformsCount=function(){var _r=0;return Fn.forEach(function(Gr){Gr.stats.uniformsCount>_r&&(_r=Gr.stats.uniformsCount)}),_r},Ut.getMaxAttributesCount=function(){var _r=0;return Fn.forEach(function(Gr){Gr.stats.attributesCount>_r&&(_r=Gr.stats.attributesCount)}),_r});function Vn(){ln={},Lr={};for(var _r=0;_r<Fn.length;++_r)Cn(Fn[_r],null,Fn[_r].attributes.map(function(Gr){return[Gr.location,Gr.name]}))}return{clear:function(){var _r=Ee.deleteShader.bind(Ee);ja(ln).forEach(_r),ln={},ja(Lr).forEach(_r),Lr={},Fn.forEach(function(Gr){Ee.deleteProgram(Gr.program)}),Fn.length=0,$n={},Ut.shaderCount=0},program:function(_r,Gr,Bn,ni){Ue.command(_r>=0,"missing vertex shader",Bn),Ue.command(Gr>=0,"missing fragment shader",Bn);var bn=$n[Gr];bn||(bn=$n[Gr]={});var si=bn[_r];if(si&&!ni)return si;var Mn=new Kn(Gr,_r);return Ut.shaderCount++,Cn(Mn,Bn,ni),si||(bn[_r]=Mn),Fn.push(Mn),Mn},restore:Vn,shader:An,frag:-1,vert:-1}}var Xt=6408,St=5121,$t=3333,tr=5126;function br(Ee,pt,Ut,Pr,ln,Lr,Tr){function Ln(Fn){var jn;pt.next===null?(Ue(ln.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),jn=St):(Ue(pt.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),jn=pt.next.colorAttachments[0].texture._texture.type,Lr.oes_texture_float?(Ue(jn===St||jn===tr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),jn===tr&&Ue(Tr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Ue(jn===St,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Kn=0,Cn=0,Vn=Pr.framebufferWidth,_r=Pr.framebufferHeight,Gr=null;E(Fn)?Gr=Fn:Fn&&(Ue.type(Fn,"object","invalid arguments to regl.read()"),Kn=Fn.x|0,Cn=Fn.y|0,Ue(Kn>=0&&Kn<Pr.framebufferWidth,"invalid x offset for regl.read"),Ue(Cn>=0&&Cn<Pr.framebufferHeight,"invalid y offset for regl.read"),Vn=(Fn.width||Pr.framebufferWidth-Kn)|0,_r=(Fn.height||Pr.framebufferHeight-Cn)|0,Gr=Fn.data||null),Gr&&(jn===St?Ue(Gr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):jn===tr&&Ue(Gr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Ue(Vn>0&&Vn+Kn<=Pr.framebufferWidth,"invalid width for read pixels"),Ue(_r>0&&_r+Cn<=Pr.framebufferHeight,"invalid height for read pixels"),Ut();var Bn=Vn*_r*4;return Gr||(jn===St?Gr=new Uint8Array(Bn):jn===tr&&(Gr=Gr||new Float32Array(Bn))),Ue.isTypedArray(Gr,"data buffer for regl.read() must be a typedarray"),Ue(Gr.byteLength>=Bn,"data buffer for regl.read() too small"),Ee.pixelStorei($t,4),Ee.readPixels(Kn,Cn,Vn,_r,Xt,jn,Gr),Gr}function An(Fn){var jn;return pt.setFBO({framebuffer:Fn.framebuffer},function(){jn=Ln(Fn)}),jn}function $n(Fn){return!Fn||!("framebuffer"in Fn)?Ln(Fn):An(Fn)}return $n}function kr(Ee){return Array.prototype.slice.call(Ee)}function Or(Ee){return kr(Ee).join("")}function Hr(){var Ee=0,pt=[],Ut=[];function Pr(jn){for(var Kn=0;Kn<Ut.length;++Kn)if(Ut[Kn]===jn)return pt[Kn];var Cn="g"+Ee++;return pt.push(Cn),Ut.push(jn),Cn}function ln(){var jn=[];function Kn(){jn.push.apply(jn,kr(arguments))}var Cn=[];function Vn(){var _r="v"+Ee++;return Cn.push(_r),arguments.length>0&&(jn.push(_r,"="),jn.push.apply(jn,kr(arguments)),jn.push(";")),_r}return _(Kn,{def:Vn,toString:function(){return Or([Cn.length>0?"var "+Cn.join(",")+";":"",Or(jn)])}})}function Lr(){var jn=ln(),Kn=ln(),Cn=jn.toString,Vn=Kn.toString;function _r(Gr,Bn){Kn(Gr,Bn,"=",jn.def(Gr,Bn),";")}return _(function(){jn.apply(jn,kr(arguments))},{def:jn.def,entry:jn,exit:Kn,save:_r,set:function(Gr,Bn,ni){_r(Gr,Bn),jn(Gr,Bn,"=",ni,";")},toString:function(){return Cn()+Vn()}})}function Tr(){var jn=Or(arguments),Kn=Lr(),Cn=Lr(),Vn=Kn.toString,_r=Cn.toString;return _(Kn,{then:function(){return Kn.apply(Kn,kr(arguments)),this},else:function(){return Cn.apply(Cn,kr(arguments)),this},toString:function(){var Gr=_r();return Gr&&(Gr="else{"+Gr+"}"),Or(["if(",jn,"){",Vn(),"}",Gr])}})}var Ln=ln(),An={};function $n(jn,Kn){var Cn=[];function Vn(){var bn="a"+Cn.length;return Cn.push(bn),bn}Kn=Kn||0;for(var _r=0;_r<Kn;++_r)Vn();var Gr=Lr(),Bn=Gr.toString,ni=An[jn]=_(Gr,{arg:Vn,toString:function(){return Or(["function(",Cn.join(),"){",Bn(),"}"])}});return ni}function Fn(){var jn=['"use strict";',Ln,"return {"];Object.keys(An).forEach(function(Vn){jn.push('"',Vn,'":',An[Vn].toString(),",")}),jn.push("}");var Kn=Or(jn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Cn=Function.apply(null,pt.concat(Kn));return Cn.apply(null,Ut)}return{global:Ln,link:Pr,block:ln,proc:$n,scope:Lr,cond:Tr,compile:Fn}}var nn="xyzw".split(""),M=5121,z=1,j=2,ne=0,ce=1,le=2,lt=3,it=4,Yt="dither",ht="blend.enable",er="blend.color",yr="blend.equation",_n="blend.func",vn="depth.enable",Jr="depth.func",Gn="depth.range",Xn="depth.mask",Yn="colorMask",gi="cull.enable",xi="cull.face",Ni="frontFace",Pa="lineWidth",Ua="polygonOffset.enable",Mo="polygonOffset.offset",ga="sample.alpha",Xi="sample.enable",da="sample.coverage",Go="stencil.enable",ls="stencil.mask",Uo="stencil.func",Xo="stencil.opFront",Rs="stencil.opBack",xo="scissor.enable",fl="scissor.box",ms="viewport",Yo="profile",Lu="framebuffer",hl="vert",Xl="frag",Ma="elements",bs="primitive",xs="count",sc="offset",rh="instances",uc="vao",Uf="Width",qc="Height",Fc=Lu+Uf,Yl=Lu+qc,zf=ms+Uf,qh=ms+qc,Qc="drawingBuffer",Au=Qc+Uf,Qh=Qc+qc,nh=[_n,yr,Uo,Xo,Rs,da,ms,fl,Mo],ih=34962,Vp=34963,Jh=35632,Ed=35633,Zf=3553,np=34067,yh=2884,ed=3042,Jc=3024,ah=2960,T=2929,Ke=3089,he=32823,re=32926,de=32928,Oe=5126,dt=35664,Lt=35665,_t=35666,jt=5124,Fr=35667,$r=35668,Un=35669,Hn=35670,_i=35671,Pi=35672,Jn=35673,Ei=35674,ya=35675,ia=35676,zo=35678,co=35680,Eo=4,_a=1028,Da=1029,Io=2304,Zo=2305,ts=32775,Oo=32776,oo=519,fo=7680,Dl=0,Kl=1,Af=32774,Ac=513,ef=36160,td=36064,Nc={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},rd=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Cf={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Cc={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ip={frag:Jh,vert:Ed},jf={cw:Io,ccw:Zo};function kh(Ee){return Array.isArray(Ee)||E(Ee)||ho(Ee)}function nd(Ee){return Ee.sort(function(pt,Ut){return pt===ms?-1:Ut===ms?1:pt<Ut?-1:1})}function Xu(Ee,pt,Ut,Pr){this.thisDep=Ee,this.contextDep=pt,this.propDep=Ut,this.append=Pr}function Bu(Ee){return Ee&&!(Ee.thisDep||Ee.contextDep||Ee.propDep)}function Ms(Ee){return new Xu(!1,!1,!1,Ee)}function ql(Ee,pt){var Ut=Ee.type;if(Ut===ne){var Pr=Ee.data.length;return new Xu(!0,Pr>=1,Pr>=2,pt)}else if(Ut===it){var ln=Ee.data;return new Xu(ln.thisDep,ln.contextDep,ln.propDep,pt)}else return new Xu(Ut===lt,Ut===le,Ut===ce,pt)}var Sd=new Xu(!1,!1,!1,function(){});function _h(Ee,pt,Ut,Pr,ln,Lr,Tr,Ln,An,$n,Fn,jn,Kn,Cn,Vn){var _r=$n.Record,Gr={add:32774,subtract:32778,"reverse subtract":32779};Ut.ext_blend_minmax&&(Gr.min=ts,Gr.max=Oo);var Bn=Ut.angle_instanced_arrays,ni=Ut.webgl_draw_buffers,bn={dirty:!0,profile:Vn.profile},si={},Mn=[],ii={},En={};function Qn(Qe){return Qe.replace(".","_")}function Ui(Qe,xt,Nt){var Mr=Qn(Qe);Mn.push(Qe),si[Mr]=bn[Mr]=!!Nt,ii[Mr]=xt}function oa(Qe,xt,Nt){var Mr=Qn(Qe);Mn.push(Qe),Array.isArray(Nt)?(bn[Mr]=Nt.slice(),si[Mr]=Nt.slice()):bn[Mr]=si[Mr]=Nt,En[Mr]=xt}Ui(Yt,Jc),Ui(ht,ed),oa(er,"blendColor",[0,0,0,0]),oa(yr,"blendEquationSeparate",[Af,Af]),oa(_n,"blendFuncSeparate",[Kl,Dl,Kl,Dl]),Ui(vn,T,!0),oa(Jr,"depthFunc",Ac),oa(Gn,"depthRange",[0,1]),oa(Xn,"depthMask",!0),oa(Yn,Yn,[!0,!0,!0,!0]),Ui(gi,yh),oa(xi,"cullFace",Da),oa(Ni,Ni,Zo),oa(Pa,Pa,1),Ui(Ua,he),oa(Mo,"polygonOffset",[0,0]),Ui(ga,re),Ui(Xi,de),oa(da,"sampleCoverage",[1,!1]),Ui(Go,ah),oa(ls,"stencilMask",-1),oa(Uo,"stencilFunc",[oo,0,-1]),oa(Xo,"stencilOpSeparate",[_a,fo,fo,fo]),oa(Rs,"stencilOpSeparate",[Da,fo,fo,fo]),Ui(xo,Ke),oa(fl,"scissor",[0,0,Ee.drawingBufferWidth,Ee.drawingBufferHeight]),oa(ms,ms,[0,0,Ee.drawingBufferWidth,Ee.drawingBufferHeight]);var ei={gl:Ee,context:Kn,strings:pt,next:si,current:bn,draw:jn,elements:Lr,buffer:ln,shader:Fn,attributes:$n.state,vao:$n,uniforms:An,framebuffer:Ln,extensions:Ut,timer:Cn,isBufferArgs:kh},Pn={primTypes:Ju,compareFuncs:Cf,blendFuncs:Nc,blendEquations:Gr,stencilOps:Cc,glTypes:ys,orientationType:jf};Ue.optional(function(){ei.isArrayLike=bo}),ni&&(Pn.backBuffer=[Da],Pn.drawBuffer=Wt(Pr.maxDrawbuffers,function(Qe){return Qe===0?[0]:Wt(Qe,function(xt){return td+xt})}));var cn=0;function zi(){var Qe=Hr(),xt=Qe.link,Nt=Qe.global;Qe.id=cn++,Qe.batchId="0";var Mr=xt(ei),Ar=Qe.shared={props:"a0"};Object.keys(ei).forEach(function(Jt){Ar[Jt]=Nt.def(Mr,".",Jt)}),Ue.optional(function(){Qe.CHECK=xt(Ue),Qe.commandStr=Ue.guessCommand(),Qe.command=xt(Qe.commandStr),Qe.assert=function(Jt,gt,rr){Jt("if(!(",gt,"))",this.CHECK,".commandRaise(",xt(rr),",",this.command,");")},Pn.invalidBlendCombinations=rd});var Kt=Qe.next={},nr=Qe.current={};Object.keys(En).forEach(function(Jt){Array.isArray(bn[Jt])&&(Kt[Jt]=Nt.def(Ar.next,".",Jt),nr[Jt]=Nt.def(Ar.current,".",Jt))});var ur=Qe.constants={};Object.keys(Pn).forEach(function(Jt){ur[Jt]=Nt.def(JSON.stringify(Pn[Jt]))}),Qe.invoke=function(Jt,gt){switch(gt.type){case ne:var rr=["this",Ar.context,Ar.props,Qe.batchId];return Jt.def(xt(gt.data),".call(",rr.slice(0,Math.max(gt.data.length+1,4)),")");case ce:return Jt.def(Ar.props,gt.data);case le:return Jt.def(Ar.context,gt.data);case lt:return Jt.def("this",gt.data);case it:return gt.data.append(Qe,Jt),gt.data.ref}},Qe.attribCache={};var Dt={};return Qe.scopeAttrib=function(Jt){var gt=pt.id(Jt);if(gt in Dt)return Dt[gt];var rr=$n.scope[gt];rr||(rr=$n.scope[gt]=new _r);var zr=Dt[gt]=xt(rr);return zr},Qe}function pa(Qe){var xt=Qe.static,Nt=Qe.dynamic,Mr;if(Yo in xt){var Ar=!!xt[Yo];Mr=Ms(function(nr,ur){return Ar}),Mr.enable=Ar}else if(Yo in Nt){var Kt=Nt[Yo];Mr=ql(Kt,function(nr,ur){return nr.invoke(ur,Kt)})}return Mr}function ui(Qe,xt){var Nt=Qe.static,Mr=Qe.dynamic;if(Lu in Nt){var Ar=Nt[Lu];return Ar?(Ar=Ln.getFramebuffer(Ar),Ue.command(Ar,"invalid framebuffer object"),Ms(function(nr,ur){var Dt=nr.link(Ar),Jt=nr.shared;ur.set(Jt.framebuffer,".next",Dt);var gt=Jt.context;return ur.set(gt,"."+Fc,Dt+".width"),ur.set(gt,"."+Yl,Dt+".height"),Dt})):Ms(function(nr,ur){var Dt=nr.shared;ur.set(Dt.framebuffer,".next","null");var Jt=Dt.context;return ur.set(Jt,"."+Fc,Jt+"."+Au),ur.set(Jt,"."+Yl,Jt+"."+Qh),"null"})}else if(Lu in Mr){var Kt=Mr[Lu];return ql(Kt,function(nr,ur){var Dt=nr.invoke(ur,Kt),Jt=nr.shared,gt=Jt.framebuffer,rr=ur.def(gt,".getFramebuffer(",Dt,")");Ue.optional(function(){nr.assert(ur,"!"+Dt+"||"+rr,"invalid framebuffer object")}),ur.set(gt,".next",rr);var zr=Jt.context;return ur.set(zr,"."+Fc,rr+"?"+rr+".width:"+zr+"."+Au),ur.set(zr,"."+Yl,rr+"?"+rr+".height:"+zr+"."+Qh),rr})}else return null}function va(Qe,xt,Nt){var Mr=Qe.static,Ar=Qe.dynamic;function Kt(Dt){if(Dt in Mr){var Jt=Mr[Dt];Ue.commandType(Jt,"object","invalid "+Dt,Nt.commandStr);var gt=!0,rr=Jt.x|0,zr=Jt.y|0,Yr,Sn;return"width"in Jt?(Yr=Jt.width|0,Ue.command(Yr>=0,"invalid "+Dt,Nt.commandStr)):gt=!1,"height"in Jt?(Sn=Jt.height|0,Ue.command(Sn>=0,"invalid "+Dt,Nt.commandStr)):gt=!1,new Xu(!gt&&xt&&xt.thisDep,!gt&&xt&&xt.contextDep,!gt&&xt&&xt.propDep,function(wi,yi){var Si=wi.shared.context,Wi=Yr;"width"in Jt||(Wi=yi.def(Si,".",Fc,"-",rr));var Ki=Sn;return"height"in Jt||(Ki=yi.def(Si,".",Yl,"-",zr)),[rr,zr,Wi,Ki]})}else if(Dt in Ar){var pn=Ar[Dt],wn=ql(pn,function(wi,yi){var Si=wi.invoke(yi,pn);Ue.optional(function(){wi.assert(yi,Si+"&&typeof "+Si+'==="object"',"invalid "+Dt)});var Wi=wi.shared.context,Ki=yi.def(Si,".x|0"),to=yi.def(Si,".y|0"),js=yi.def('"width" in ',Si,"?",Si,".width|0:","(",Wi,".",Fc,"-",Ki,")"),Uc=yi.def('"height" in ',Si,"?",Si,".height|0:","(",Wi,".",Yl,"-",to,")");return Ue.optional(function(){wi.assert(yi,js+">=0&&"+Uc+">=0","invalid "+Dt)}),[Ki,to,js,Uc]});return xt&&(wn.thisDep=wn.thisDep||xt.thisDep,wn.contextDep=wn.contextDep||xt.contextDep,wn.propDep=wn.propDep||xt.propDep),wn}else return xt?new Xu(xt.thisDep,xt.contextDep,xt.propDep,function(wi,yi){var Si=wi.shared.context;return[0,0,yi.def(Si,".",Fc),yi.def(Si,".",Yl)]}):null}var nr=Kt(ms);if(nr){var ur=nr;nr=new Xu(nr.thisDep,nr.contextDep,nr.propDep,function(Dt,Jt){var gt=ur.append(Dt,Jt),rr=Dt.shared.context;return Jt.set(rr,"."+zf,gt[2]),Jt.set(rr,"."+qh,gt[3]),gt})}return{viewport:nr,scissor_box:Kt(fl)}}function aa(Qe,xt){var Nt=Qe.static,Mr=typeof Nt[Xl]=="string"&&typeof Nt[hl]=="string";if(Mr){if(Object.keys(xt.dynamic).length>0)return null;var Ar=xt.static,Kt=Object.keys(Ar);if(Kt.length>0&&typeof Ar[Kt[0]]=="number"){for(var nr=[],ur=0;ur<Kt.length;++ur)Ue(typeof Ar[Kt[ur]]=="number","must specify all vertex attribute locations when using vaos"),nr.push([Ar[Kt[ur]]|0,Kt[ur]]);return nr}}return null}function Yi(Qe,xt,Nt){var Mr=Qe.static,Ar=Qe.dynamic;function Kt(gt){if(gt in Mr){var rr=pt.id(Mr[gt]);Ue.optional(function(){Fn.shader(ip[gt],rr,Ue.guessCommand())});var zr=Ms(function(){return rr});return zr.id=rr,zr}else if(gt in Ar){var Yr=Ar[gt];return ql(Yr,function(Sn,pn){var wn=Sn.invoke(pn,Yr),wi=pn.def(Sn.shared.strings,".id(",wn,")");return Ue.optional(function(){pn(Sn.shared.shader,".shader(",ip[gt],",",wi,",",Sn.command,");")}),wi})}return null}var nr=Kt(Xl),ur=Kt(hl),Dt=null,Jt;return Bu(nr)&&Bu(ur)?(Dt=Fn.program(ur.id,nr.id,null,Nt),Jt=Ms(function(gt,rr){return gt.link(Dt)})):Jt=new Xu(nr&&nr.thisDep||ur&&ur.thisDep,nr&&nr.contextDep||ur&&ur.contextDep,nr&&nr.propDep||ur&&ur.propDep,function(gt,rr){var zr=gt.shared.shader,Yr;nr?Yr=nr.append(gt,rr):Yr=rr.def(zr,".",Xl);var Sn;ur?Sn=ur.append(gt,rr):Sn=rr.def(zr,".",hl);var pn=zr+".program("+Sn+","+Yr;return Ue.optional(function(){pn+=","+gt.command}),rr.def(pn+")")}),{frag:nr,vert:ur,progVar:Jt,program:Dt}}function Qa(Qe,xt){var Nt=Qe.static,Mr=Qe.dynamic;function Ar(){if(Ma in Nt){var gt=Nt[Ma];kh(gt)?gt=Lr.getElements(Lr.create(gt,!0)):gt&&(gt=Lr.getElements(gt),Ue.command(gt,"invalid elements",xt.commandStr));var rr=Ms(function(Yr,Sn){if(gt){var pn=Yr.link(gt);return Yr.ELEMENTS=pn,pn}return Yr.ELEMENTS=null,null});return rr.value=gt,rr}else if(Ma in Mr){var zr=Mr[Ma];return ql(zr,function(Yr,Sn){var pn=Yr.shared,wn=pn.isBufferArgs,wi=pn.elements,yi=Yr.invoke(Sn,zr),Si=Sn.def("null"),Wi=Sn.def(wn,"(",yi,")"),Ki=Yr.cond(Wi).then(Si,"=",wi,".createStream(",yi,");").else(Si,"=",wi,".getElements(",yi,");");return Ue.optional(function(){Yr.assert(Ki.else,"!"+yi+"||"+Si,"invalid elements")}),Sn.entry(Ki),Sn.exit(Yr.cond(Wi).then(wi,".destroyStream(",Si,");")),Yr.ELEMENTS=Si,Si})}return null}var Kt=Ar();function nr(){if(bs in Nt){var gt=Nt[bs];return Ue.commandParameter(gt,Ju,"invalid primitve",xt.commandStr),Ms(function(zr,Yr){return Ju[gt]})}else if(bs in Mr){var rr=Mr[bs];return ql(rr,function(zr,Yr){var Sn=zr.constants.primTypes,pn=zr.invoke(Yr,rr);return Ue.optional(function(){zr.assert(Yr,pn+" in "+Sn,"invalid primitive, must be one of "+Object.keys(Ju))}),Yr.def(Sn,"[",pn,"]")})}else if(Kt)return Bu(Kt)?Kt.value?Ms(function(zr,Yr){return Yr.def(zr.ELEMENTS,".primType")}):Ms(function(){return Eo}):new Xu(Kt.thisDep,Kt.contextDep,Kt.propDep,function(zr,Yr){var Sn=zr.ELEMENTS;return Yr.def(Sn,"?",Sn,".primType:",Eo)});return null}function ur(gt,rr){if(gt in Nt){var zr=Nt[gt]|0;return Ue.command(!rr||zr>=0,"invalid "+gt,xt.commandStr),Ms(function(Sn,pn){return rr&&(Sn.OFFSET=zr),zr})}else if(gt in Mr){var Yr=Mr[gt];return ql(Yr,function(Sn,pn){var wn=Sn.invoke(pn,Yr);return rr&&(Sn.OFFSET=wn,Ue.optional(function(){Sn.assert(pn,wn+">=0","invalid "+gt)})),wn})}else if(rr&&Kt)return Ms(function(Sn,pn){return Sn.OFFSET="0",0});return null}var Dt=ur(sc,!0);function Jt(){if(xs in Nt){var gt=Nt[xs]|0;return Ue.command(typeof gt=="number"&&gt>=0,"invalid vertex count",xt.commandStr),Ms(function(){return gt})}else if(xs in Mr){var rr=Mr[xs];return ql(rr,function(Sn,pn){var wn=Sn.invoke(pn,rr);return Ue.optional(function(){Sn.assert(pn,"typeof "+wn+'==="number"&&'+wn+">=0&&"+wn+"===("+wn+"|0)","invalid vertex count")}),wn})}else if(Kt)if(Bu(Kt)){if(Kt)return Dt?new Xu(Dt.thisDep,Dt.contextDep,Dt.propDep,function(Sn,pn){var wn=pn.def(Sn.ELEMENTS,".vertCount-",Sn.OFFSET);return Ue.optional(function(){Sn.assert(pn,wn+">=0","invalid vertex offset/element buffer too small")}),wn}):Ms(function(Sn,pn){return pn.def(Sn.ELEMENTS,".vertCount")});var zr=Ms(function(){return-1});return Ue.optional(function(){zr.MISSING=!0}),zr}else{var Yr=new Xu(Kt.thisDep||Dt.thisDep,Kt.contextDep||Dt.contextDep,Kt.propDep||Dt.propDep,function(Sn,pn){var wn=Sn.ELEMENTS;return Sn.OFFSET?pn.def(wn,"?",wn,".vertCount-",Sn.OFFSET,":-1"):pn.def(wn,"?",wn,".vertCount:-1")});return Ue.optional(function(){Yr.DYNAMIC=!0}),Yr}return null}return{elements:Kt,primitive:nr(),count:Jt(),instances:ur(rh,!1),offset:Dt}}function Is(Qe,xt){var Nt=Qe.static,Mr=Qe.dynamic,Ar={};return Mn.forEach(function(Kt){var nr=Qn(Kt);function ur(Dt,Jt){if(Kt in Nt){var gt=Dt(Nt[Kt]);Ar[nr]=Ms(function(){return gt})}else if(Kt in Mr){var rr=Mr[Kt];Ar[nr]=ql(rr,function(zr,Yr){return Jt(zr,Yr,zr.invoke(Yr,rr))})}}switch(Kt){case gi:case ht:case Yt:case Go:case vn:case xo:case Ua:case ga:case Xi:case Xn:return ur(function(Dt){return Ue.commandType(Dt,"boolean",Kt,xt.commandStr),Dt},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,"typeof "+gt+'==="boolean"',"invalid flag "+Kt,Dt.commandStr)}),gt});case Jr:return ur(function(Dt){return Ue.commandParameter(Dt,Cf,"invalid "+Kt,xt.commandStr),Cf[Dt]},function(Dt,Jt,gt){var rr=Dt.constants.compareFuncs;return Ue.optional(function(){Dt.assert(Jt,gt+" in "+rr,"invalid "+Kt+", must be one of "+Object.keys(Cf))}),Jt.def(rr,"[",gt,"]")});case Gn:return ur(function(Dt){return Ue.command(bo(Dt)&&Dt.length===2&&typeof Dt[0]=="number"&&typeof Dt[1]=="number"&&Dt[0]<=Dt[1],"depth range is 2d array",xt.commandStr),Dt},function(Dt,Jt,gt){Ue.optional(function(){Dt.assert(Jt,Dt.shared.isArrayLike+"("+gt+")&&"+gt+".length===2&&typeof "+gt+'[0]==="number"&&typeof '+gt+'[1]==="number"&&'+gt+"[0]<="+gt+"[1]","depth range must be a 2d array")});var rr=Jt.def("+",gt,"[0]"),zr=Jt.def("+",gt,"[1]");return[rr,zr]});case _n:return ur(function(Dt){Ue.commandType(Dt,"object","blend.func",xt.commandStr);var Jt="srcRGB"in Dt?Dt.srcRGB:Dt.src,gt="srcAlpha"in Dt?Dt.srcAlpha:Dt.src,rr="dstRGB"in Dt?Dt.dstRGB:Dt.dst,zr="dstAlpha"in Dt?Dt.dstAlpha:Dt.dst;return Ue.commandParameter(Jt,Nc,nr+".srcRGB",xt.commandStr),Ue.commandParameter(gt,Nc,nr+".srcAlpha",xt.commandStr),Ue.commandParameter(rr,Nc,nr+".dstRGB",xt.commandStr),Ue.commandParameter(zr,Nc,nr+".dstAlpha",xt.commandStr),Ue.command(rd.indexOf(Jt+", "+rr)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Jt+", "+rr+")",xt.commandStr),[Nc[Jt],Nc[rr],Nc[gt],Nc[zr]]},function(Dt,Jt,gt){var rr=Dt.constants.blendFuncs;Ue.optional(function(){Dt.assert(Jt,gt+"&&typeof "+gt+'==="object"',"invalid blend func, must be an object")});function zr(Si,Wi){var Ki=Jt.def('"',Si,Wi,'" in ',gt,"?",gt,".",Si,Wi,":",gt,".",Si);return Ue.optional(function(){Dt.assert(Jt,Ki+" in "+rr,"invalid "+Kt+"."+Si+Wi+", must be one of "+Object.keys(Nc))}),Ki}var Yr=zr("src","RGB"),Sn=zr("dst","RGB");Ue.optional(function(){var Si=Dt.constants.invalidBlendCombinations;Dt.assert(Jt,Si+".indexOf("+Yr+'+", "+'+Sn+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var pn=Jt.def(rr,"[",Yr,"]"),wn=Jt.def(rr,"[",zr("src","Alpha"),"]"),wi=Jt.def(rr,"[",Sn,"]"),yi=Jt.def(rr,"[",zr("dst","Alpha"),"]");return[pn,wi,wn,yi]});case yr:return ur(function(Dt){if(typeof Dt=="string")return Ue.commandParameter(Dt,Gr,"invalid "+Kt,xt.commandStr),[Gr[Dt],Gr[Dt]];if(typeof Dt=="object")return Ue.commandParameter(Dt.rgb,Gr,Kt+".rgb",xt.commandStr),Ue.commandParameter(Dt.alpha,Gr,Kt+".alpha",xt.commandStr),[Gr[Dt.rgb],Gr[Dt.alpha]];Ue.commandRaise("invalid blend.equation",xt.commandStr)},function(Dt,Jt,gt){var rr=Dt.constants.blendEquations,zr=Jt.def(),Yr=Jt.def(),Sn=Dt.cond("typeof ",gt,'==="string"');return Ue.optional(function(){function pn(wn,wi,yi){Dt.assert(wn,yi+" in "+rr,"invalid "+wi+", must be one of "+Object.keys(Gr))}pn(Sn.then,Kt,gt),Dt.assert(Sn.else,gt+"&&typeof "+gt+'==="object"',"invalid "+Kt),pn(Sn.else,Kt+".rgb",gt+".rgb"),pn(Sn.else,Kt+".alpha",gt+".alpha")}),Sn.then(zr,"=",Yr,"=",rr,"[",gt,"];"),Sn.else(zr,"=",rr,"[",gt,".rgb];",Yr,"=",rr,"[",gt,".alpha];"),Jt(Sn),[zr,Yr]});case er:return ur(function(Dt){return Ue.command(bo(Dt)&&Dt.length===4,"blend.color must be a 4d array",xt.commandStr),Wt(4,function(Jt){return+Dt[Jt]})},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,Dt.shared.isArrayLike+"("+gt+")&&"+gt+".length===4","blend.color must be a 4d array")}),Wt(4,function(rr){return Jt.def("+",gt,"[",rr,"]")})});case ls:return ur(function(Dt){return Ue.commandType(Dt,"number",nr,xt.commandStr),Dt|0},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,"typeof "+gt+'==="number"',"invalid stencil.mask")}),Jt.def(gt,"|0")});case Uo:return ur(function(Dt){Ue.commandType(Dt,"object",nr,xt.commandStr);var Jt=Dt.cmp||"keep",gt=Dt.ref||0,rr="mask"in Dt?Dt.mask:-1;return Ue.commandParameter(Jt,Cf,Kt+".cmp",xt.commandStr),Ue.commandType(gt,"number",Kt+".ref",xt.commandStr),Ue.commandType(rr,"number",Kt+".mask",xt.commandStr),[Cf[Jt],gt,rr]},function(Dt,Jt,gt){var rr=Dt.constants.compareFuncs;Ue.optional(function(){function pn(){Dt.assert(Jt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}pn(gt+"&&typeof ",gt,'==="object"'),pn('!("cmp" in ',gt,")||(",gt,".cmp in ",rr,")")});var zr=Jt.def('"cmp" in ',gt,"?",rr,"[",gt,".cmp]",":",fo),Yr=Jt.def(gt,".ref|0"),Sn=Jt.def('"mask" in ',gt,"?",gt,".mask|0:-1");return[zr,Yr,Sn]});case Xo:case Rs:return ur(function(Dt){Ue.commandType(Dt,"object",nr,xt.commandStr);var Jt=Dt.fail||"keep",gt=Dt.zfail||"keep",rr=Dt.zpass||"keep";return Ue.commandParameter(Jt,Cc,Kt+".fail",xt.commandStr),Ue.commandParameter(gt,Cc,Kt+".zfail",xt.commandStr),Ue.commandParameter(rr,Cc,Kt+".zpass",xt.commandStr),[Kt===Rs?Da:_a,Cc[Jt],Cc[gt],Cc[rr]]},function(Dt,Jt,gt){var rr=Dt.constants.stencilOps;Ue.optional(function(){Dt.assert(Jt,gt+"&&typeof "+gt+'==="object"',"invalid "+Kt)});function zr(Yr){return Ue.optional(function(){Dt.assert(Jt,'!("'+Yr+'" in '+gt+")||("+gt+"."+Yr+" in "+rr+")","invalid "+Kt+"."+Yr+", must be one of "+Object.keys(Cc))}),Jt.def('"',Yr,'" in ',gt,"?",rr,"[",gt,".",Yr,"]:",fo)}return[Kt===Rs?Da:_a,zr("fail"),zr("zfail"),zr("zpass")]});case Mo:return ur(function(Dt){Ue.commandType(Dt,"object",nr,xt.commandStr);var Jt=Dt.factor|0,gt=Dt.units|0;return Ue.commandType(Jt,"number",nr+".factor",xt.commandStr),Ue.commandType(gt,"number",nr+".units",xt.commandStr),[Jt,gt]},function(Dt,Jt,gt){Ue.optional(function(){Dt.assert(Jt,gt+"&&typeof "+gt+'==="object"',"invalid "+Kt)});var rr=Jt.def(gt,".factor|0"),zr=Jt.def(gt,".units|0");return[rr,zr]});case xi:return ur(function(Dt){var Jt=0;return Dt==="front"?Jt=_a:Dt==="back"&&(Jt=Da),Ue.command(!!Jt,nr,xt.commandStr),Jt},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,gt+'==="front"||'+gt+'==="back"',"invalid cull.face")}),Jt.def(gt,'==="front"?',_a,":",Da)});case Pa:return ur(function(Dt){return Ue.command(typeof Dt=="number"&&Dt>=Pr.lineWidthDims[0]&&Dt<=Pr.lineWidthDims[1],"invalid line width, must be a positive number between "+Pr.lineWidthDims[0]+" and "+Pr.lineWidthDims[1],xt.commandStr),Dt},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,"typeof "+gt+'==="number"&&'+gt+">="+Pr.lineWidthDims[0]+"&&"+gt+"<="+Pr.lineWidthDims[1],"invalid line width")}),gt});case Ni:return ur(function(Dt){return Ue.commandParameter(Dt,jf,nr,xt.commandStr),jf[Dt]},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,gt+'==="cw"||'+gt+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Jt.def(gt+'==="cw"?'+Io+":"+Zo)});case Yn:return ur(function(Dt){return Ue.command(bo(Dt)&&Dt.length===4,"color.mask must be length 4 array",xt.commandStr),Dt.map(function(Jt){return!!Jt})},function(Dt,Jt,gt){return Ue.optional(function(){Dt.assert(Jt,Dt.shared.isArrayLike+"("+gt+")&&"+gt+".length===4","invalid color.mask")}),Wt(4,function(rr){return"!!"+gt+"["+rr+"]"})});case da:return ur(function(Dt){Ue.command(typeof Dt=="object"&&Dt,nr,xt.commandStr);var Jt="value"in Dt?Dt.value:1,gt=!!Dt.invert;return Ue.command(typeof Jt=="number"&&Jt>=0&&Jt<=1,"sample.coverage.value must be a number between 0 and 1",xt.commandStr),[Jt,gt]},function(Dt,Jt,gt){Ue.optional(function(){Dt.assert(Jt,gt+"&&typeof "+gt+'==="object"',"invalid sample.coverage")});var rr=Jt.def('"value" in ',gt,"?+",gt,".value:1"),zr=Jt.def("!!",gt,".invert");return[rr,zr]})}}),Ar}function du(Qe,xt){var Nt=Qe.static,Mr=Qe.dynamic,Ar={};return Object.keys(Nt).forEach(function(Kt){var nr=Nt[Kt],ur;if(typeof nr=="number"||typeof nr=="boolean")ur=Ms(function(){return nr});else if(typeof nr=="function"){var Dt=nr._reglType;Dt==="texture2d"||Dt==="textureCube"?ur=Ms(function(Jt){return Jt.link(nr)}):Dt==="framebuffer"||Dt==="framebufferCube"?(Ue.command(nr.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Kt+'"',xt.commandStr),ur=Ms(function(Jt){return Jt.link(nr.color[0])})):Ue.commandRaise('invalid data for uniform "'+Kt+'"',xt.commandStr)}else bo(nr)?ur=Ms(function(Jt){var gt=Jt.global.def("[",Wt(nr.length,function(rr){return Ue.command(typeof nr[rr]=="number"||typeof nr[rr]=="boolean","invalid uniform "+Kt,Jt.commandStr),nr[rr]}),"]");return gt}):Ue.commandRaise('invalid or missing data for uniform "'+Kt+'"',xt.commandStr);ur.value=nr,Ar[Kt]=ur}),Object.keys(Mr).forEach(function(Kt){var nr=Mr[Kt];Ar[Kt]=ql(nr,function(ur,Dt){return ur.invoke(Dt,nr)})}),Ar}function ba(Qe,xt){var Nt=Qe.static,Mr=Qe.dynamic,Ar={};return Object.keys(Nt).forEach(function(Kt){var nr=Nt[Kt],ur=pt.id(Kt),Dt=new _r;if(kh(nr))Dt.state=z,Dt.buffer=ln.getBuffer(ln.create(nr,ih,!1,!0)),Dt.type=0;else{var Jt=ln.getBuffer(nr);if(Jt)Dt.state=z,Dt.buffer=Jt,Dt.type=0;else if(Ue.command(typeof nr=="object"&&nr,"invalid data for attribute "+Kt,xt.commandStr),"constant"in nr){var gt=nr.constant;Dt.buffer="null",Dt.state=j,typeof gt=="number"?Dt.x=gt:(Ue.command(bo(gt)&&gt.length>0&&gt.length<=4,"invalid constant for attribute "+Kt,xt.commandStr),nn.forEach(function(wi,yi){yi<gt.length&&(Dt[wi]=gt[yi])}))}else{kh(nr.buffer)?Jt=ln.getBuffer(ln.create(nr.buffer,ih,!1,!0)):Jt=ln.getBuffer(nr.buffer),Ue.command(!!Jt,'missing buffer for attribute "'+Kt+'"',xt.commandStr);var rr=nr.offset|0;Ue.command(rr>=0,'invalid offset for attribute "'+Kt+'"',xt.commandStr);var zr=nr.stride|0;Ue.command(zr>=0&&zr<256,'invalid stride for attribute "'+Kt+'", must be integer betweeen [0, 255]',xt.commandStr);var Yr=nr.size|0;Ue.command(!("size"in nr)||Yr>0&&Yr<=4,'invalid size for attribute "'+Kt+'", must be 1,2,3,4',xt.commandStr);var Sn=!!nr.normalized,pn=0;"type"in nr&&(Ue.commandParameter(nr.type,ys,"invalid type for attribute "+Kt,xt.commandStr),pn=ys[nr.type]);var wn=nr.divisor|0;"divisor"in nr&&(Ue.command(wn===0||Bn,'cannot specify divisor for attribute "'+Kt+'", instancing not supported',xt.commandStr),Ue.command(wn>=0,'invalid divisor for attribute "'+Kt+'"',xt.commandStr)),Ue.optional(function(){var wi=xt.commandStr,yi=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(nr).forEach(function(Si){Ue.command(yi.indexOf(Si)>=0,'unknown parameter "'+Si+'" for attribute pointer "'+Kt+'" (valid parameters are '+yi+")",wi)})}),Dt.buffer=Jt,Dt.state=z,Dt.size=Yr,Dt.normalized=Sn,Dt.type=pn||Jt.dtype,Dt.offset=rr,Dt.stride=zr,Dt.divisor=wn}}Ar[Kt]=Ms(function(wi,yi){var Si=wi.attribCache;if(ur in Si)return Si[ur];var Wi={isStream:!1};return Object.keys(Dt).forEach(function(Ki){Wi[Ki]=Dt[Ki]}),Dt.buffer&&(Wi.buffer=wi.link(Dt.buffer),Wi.type=Wi.type||Wi.buffer+".dtype"),Si[ur]=Wi,Wi})}),Object.keys(Mr).forEach(function(Kt){var nr=Mr[Kt];function ur(Dt,Jt){var gt=Dt.invoke(Jt,nr),rr=Dt.shared,zr=Dt.constants,Yr=rr.isBufferArgs,Sn=rr.buffer;Ue.optional(function(){Dt.assert(Jt,gt+"&&(typeof "+gt+'==="object"||typeof '+gt+'==="function")&&('+Yr+"("+gt+")||"+Sn+".getBuffer("+gt+")||"+Sn+".getBuffer("+gt+".buffer)||"+Yr+"("+gt+'.buffer)||("constant" in '+gt+"&&(typeof "+gt+'.constant==="number"||'+rr.isArrayLike+"("+gt+".constant))))",'invalid dynamic attribute "'+Kt+'"')});var pn={isStream:Jt.def(!1)},wn=new _r;wn.state=z,Object.keys(wn).forEach(function(Wi){pn[Wi]=Jt.def(""+wn[Wi])});var wi=pn.buffer,yi=pn.type;Jt("if(",Yr,"(",gt,")){",pn.isStream,"=true;",wi,"=",Sn,".createStream(",ih,",",gt,");",yi,"=",wi,".dtype;","}else{",wi,"=",Sn,".getBuffer(",gt,");","if(",wi,"){",yi,"=",wi,".dtype;",'}else if("constant" in ',gt,"){",pn.state,"=",j,";","if(typeof "+gt+'.constant === "number"){',pn[nn[0]],"=",gt,".constant;",nn.slice(1).map(function(Wi){return pn[Wi]}).join("="),"=0;","}else{",nn.map(function(Wi,Ki){return pn[Wi]+"="+gt+".constant.length>"+Ki+"?"+gt+".constant["+Ki+"]:0;"}).join(""),"}}else{","if(",Yr,"(",gt,".buffer)){",wi,"=",Sn,".createStream(",ih,",",gt,".buffer);","}else{",wi,"=",Sn,".getBuffer(",gt,".buffer);","}",yi,'="type" in ',gt,"?",zr.glTypes,"[",gt,".type]:",wi,".dtype;",pn.normalized,"=!!",gt,".normalized;");function Si(Wi){Jt(pn[Wi],"=",gt,".",Wi,"|0;")}return Si("size"),Si("offset"),Si("stride"),Si("divisor"),Jt("}}"),Jt.exit("if(",pn.isStream,"){",Sn,".destroyStream(",wi,");","}"),pn}Ar[Kt]=ql(nr,ur)}),Ar}function Os(Qe,xt){var Nt=Qe.static,Mr=Qe.dynamic;if(uc in Nt){var Ar=Nt[uc];return Ar!==null&&$n.getVAO(Ar)===null&&(Ar=$n.createVAO(Ar)),Ms(function(nr){return nr.link($n.getVAO(Ar))})}else if(uc in Mr){var Kt=Mr[uc];return ql(Kt,function(nr,ur){var Dt=nr.invoke(ur,Kt);return ur.def(nr.shared.vao+".getVAO("+Dt+")")})}return null}function Lo(Qe){var xt=Qe.static,Nt=Qe.dynamic,Mr={};return Object.keys(xt).forEach(function(Ar){var Kt=xt[Ar];Mr[Ar]=Ms(function(nr,ur){return typeof Kt=="number"||typeof Kt=="boolean"?""+Kt:nr.link(Kt)})}),Object.keys(Nt).forEach(function(Ar){var Kt=Nt[Ar];Mr[Ar]=ql(Kt,function(nr,ur){return nr.invoke(ur,Kt)})}),Mr}function Us(Qe,xt,Nt,Mr,Ar){var Kt=Qe.static,nr=Qe.dynamic;Ue.optional(function(){var Si=[Lu,hl,Xl,Ma,bs,sc,xs,rh,Yo,uc].concat(Mn);function Wi(Ki){Object.keys(Ki).forEach(function(to){Ue.command(Si.indexOf(to)>=0,'unknown parameter "'+to+'"',Ar.commandStr)})}Wi(Kt),Wi(nr)});var ur=aa(Qe,xt),Dt=ui(Qe,Ar),Jt=va(Qe,Dt,Ar),gt=Qa(Qe,Ar),rr=Is(Qe,Ar),zr=Yi(Qe,Ar,ur);function Yr(Si){var Wi=Jt[Si];Wi&&(rr[Si]=Wi)}Yr(ms),Yr(Qn(fl));var Sn=Object.keys(rr).length>0,pn={framebuffer:Dt,draw:gt,shader:zr,state:rr,dirty:Sn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(pn.profile=pa(Qe,Ar),pn.uniforms=du(Nt,Ar),pn.drawVAO=pn.scopeVAO=Os(Qe,Ar),!pn.drawVAO&&zr.program&&!ur&&Ut.angle_instanced_arrays){var wn=!0,wi=zr.program.attributes.map(function(Si){var Wi=xt.static[Si];return wn=wn&&!!Wi,Wi});if(wn&&wi.length>0){var yi=$n.getVAO($n.createVAO(wi));pn.drawVAO=new Xu(null,null,null,function(Si,Wi){return Si.link(yi)}),pn.useVAO=!0}}return ur?pn.useVAO=!0:pn.attributes=ba(xt,Ar),pn.context=Lo(Mr,Ar),pn}function zs(Qe,xt,Nt){var Mr=Qe.shared,Ar=Mr.context,Kt=Qe.scope();Object.keys(Nt).forEach(function(nr){xt.save(Ar,"."+nr);var ur=Nt[nr];Kt(Ar,".",nr,"=",ur.append(Qe,xt),";")}),xt(Kt)}function cs(Qe,xt,Nt,Mr){var Ar=Qe.shared,Kt=Ar.gl,nr=Ar.framebuffer,ur;ni&&(ur=xt.def(Ar.extensions,".webgl_draw_buffers"));var Dt=Qe.constants,Jt=Dt.drawBuffer,gt=Dt.backBuffer,rr;Nt?rr=Nt.append(Qe,xt):rr=xt.def(nr,".next"),Mr||xt("if(",rr,"!==",nr,".cur){"),xt("if(",rr,"){",Kt,".bindFramebuffer(",ef,",",rr,".framebuffer);"),ni&&xt(ur,".drawBuffersWEBGL(",Jt,"[",rr,".colorAttachments.length]);"),xt("}else{",Kt,".bindFramebuffer(",ef,",null);"),ni&&xt(ur,".drawBuffersWEBGL(",gt,");"),xt("}",nr,".cur=",rr,";"),Mr||xt("}")}function Js(Qe,xt,Nt){var Mr=Qe.shared,Ar=Mr.gl,Kt=Qe.current,nr=Qe.next,ur=Mr.current,Dt=Mr.next,Jt=Qe.cond(ur,".dirty");Mn.forEach(function(gt){var rr=Qn(gt);if(!(rr in Nt.state)){var zr,Yr;if(rr in nr){zr=nr[rr],Yr=Kt[rr];var Sn=Wt(bn[rr].length,function(wn){return Jt.def(zr,"[",wn,"]")});Jt(Qe.cond(Sn.map(function(wn,wi){return wn+"!=="+Yr+"["+wi+"]"}).join("||")).then(Ar,".",En[rr],"(",Sn,");",Sn.map(function(wn,wi){return Yr+"["+wi+"]="+wn}).join(";"),";"))}else{zr=Jt.def(Dt,".",rr);var pn=Qe.cond(zr,"!==",ur,".",rr);Jt(pn),rr in ii?pn(Qe.cond(zr).then(Ar,".enable(",ii[rr],");").else(Ar,".disable(",ii[rr],");"),ur,".",rr,"=",zr,";"):pn(Ar,".",En[rr],"(",zr,");",ur,".",rr,"=",zr,";")}}}),Object.keys(Nt.state).length===0&&Jt(ur,".dirty=false;"),xt(Jt)}function Fu(Qe,xt,Nt,Mr){var Ar=Qe.shared,Kt=Qe.current,nr=Ar.current,ur=Ar.gl;nd(Object.keys(Nt)).forEach(function(Dt){var Jt=Nt[Dt];if(!(Mr&&!Mr(Jt))){var gt=Jt.append(Qe,xt);if(ii[Dt]){var rr=ii[Dt];Bu(Jt)?gt?xt(ur,".enable(",rr,");"):xt(ur,".disable(",rr,");"):xt(Qe.cond(gt).then(ur,".enable(",rr,");").else(ur,".disable(",rr,");")),xt(nr,".",Dt,"=",gt,";")}else if(bo(gt)){var zr=Kt[Dt];xt(ur,".",En[Dt],"(",gt,");",gt.map(function(Yr,Sn){return zr+"["+Sn+"]="+Yr}).join(";"),";")}else xt(ur,".",En[Dt],"(",gt,");",nr,".",Dt,"=",gt,";")}})}function Zs(Qe,xt){Bn&&(Qe.instancing=xt.def(Qe.shared.extensions,".angle_instanced_arrays"))}function ca(Qe,xt,Nt,Mr,Ar){var Kt=Qe.shared,nr=Qe.stats,ur=Kt.current,Dt=Kt.timer,Jt=Nt.profile;function gt(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var rr,zr;function Yr(Si){rr=xt.def(),Si(rr,"=",gt(),";"),typeof Ar=="string"?Si(nr,".count+=",Ar,";"):Si(nr,".count++;"),Cn&&(Mr?(zr=xt.def(),Si(zr,"=",Dt,".getNumPendingQueries();")):Si(Dt,".beginQuery(",nr,");"))}function Sn(Si){Si(nr,".cpuTime+=",gt(),"-",rr,";"),Cn&&(Mr?Si(Dt,".pushScopeStats(",zr,",",Dt,".getNumPendingQueries(),",nr,");"):Si(Dt,".endQuery();"))}function pn(Si){var Wi=xt.def(ur,".profile");xt(ur,".profile=",Si,";"),xt.exit(ur,".profile=",Wi,";")}var wn;if(Jt){if(Bu(Jt)){Jt.enable?(Yr(xt),Sn(xt.exit),pn("true")):pn("false");return}wn=Jt.append(Qe,xt),pn(wn)}else wn=xt.def(ur,".profile");var wi=Qe.block();Yr(wi),xt("if(",wn,"){",wi,"}");var yi=Qe.block();Sn(yi),xt.exit("if(",wn,"){",yi,"}")}function pu(Qe,xt,Nt,Mr,Ar){var Kt=Qe.shared;function nr(Dt){switch(Dt){case dt:case Fr:case _i:return 2;case Lt:case $r:case Pi:return 3;case _t:case Un:case Jn:return 4;default:return 1}}function ur(Dt,Jt,gt){var rr=Kt.gl,zr=xt.def(Dt,".location"),Yr=xt.def(Kt.attributes,"[",zr,"]"),Sn=gt.state,pn=gt.buffer,wn=[gt.x,gt.y,gt.z,gt.w],wi=["buffer","normalized","offset","stride"];function yi(){xt("if(!",Yr,".buffer){",rr,".enableVertexAttribArray(",zr,");}");var Wi=gt.type,Ki;if(gt.size?Ki=xt.def(gt.size,"||",Jt):Ki=Jt,xt("if(",Yr,".type!==",Wi,"||",Yr,".size!==",Ki,"||",wi.map(function(js){return Yr+"."+js+"!=="+gt[js]}).join("||"),"){",rr,".bindBuffer(",ih,",",pn,".buffer);",rr,".vertexAttribPointer(",[zr,Ki,Wi,gt.normalized,gt.stride,gt.offset],");",Yr,".type=",Wi,";",Yr,".size=",Ki,";",wi.map(function(js){return Yr+"."+js+"="+gt[js]+";"}).join(""),"}"),Bn){var to=gt.divisor;xt("if(",Yr,".divisor!==",to,"){",Qe.instancing,".vertexAttribDivisorANGLE(",[zr,to],");",Yr,".divisor=",to,";}")}}function Si(){xt("if(",Yr,".buffer){",rr,".disableVertexAttribArray(",zr,");",Yr,".buffer=null;","}if(",nn.map(function(Wi,Ki){return Yr+"."+Wi+"!=="+wn[Ki]}).join("||"),"){",rr,".vertexAttrib4f(",zr,",",wn,");",nn.map(function(Wi,Ki){return Yr+"."+Wi+"="+wn[Ki]+";"}).join(""),"}")}Sn===z?yi():Sn===j?Si():(xt("if(",Sn,"===",z,"){"),yi(),xt("}else{"),Si(),xt("}"))}Mr.forEach(function(Dt){var Jt=Dt.name,gt=Nt.attributes[Jt],rr;if(gt){if(!Ar(gt))return;rr=gt.append(Qe,xt)}else{if(!Ar(Sd))return;var zr=Qe.scopeAttrib(Jt);Ue.optional(function(){Qe.assert(xt,zr+".state","missing attribute "+Jt)}),rr={},Object.keys(new _r).forEach(function(Yr){rr[Yr]=xt.def(zr,".",Yr)})}ur(Qe.link(Dt),nr(Dt.info.type),rr)})}function ta(Qe,xt,Nt,Mr,Ar){for(var Kt=Qe.shared,nr=Kt.gl,ur,Dt=0;Dt<Mr.length;++Dt){var Jt=Mr[Dt],gt=Jt.name,rr=Jt.info.type,zr=Nt.uniforms[gt],Yr=Qe.link(Jt),Sn=Yr+".location",pn;if(zr){if(!Ar(zr))continue;if(Bu(zr)){var wn=zr.value;if(Ue.command(wn!==null&&typeof wn!="undefined",'missing uniform "'+gt+'"',Qe.commandStr),rr===zo||rr===co){Ue.command(typeof wn=="function"&&(rr===zo&&(wn._reglType==="texture2d"||wn._reglType==="framebuffer")||rr===co&&(wn._reglType==="textureCube"||wn._reglType==="framebufferCube")),"invalid texture for uniform "+gt,Qe.commandStr);var wi=Qe.link(wn._texture||wn.color[0]._texture);xt(nr,".uniform1i(",Sn,",",wi+".bind());"),xt.exit(wi,".unbind();")}else if(rr===Ei||rr===ya||rr===ia){Ue.optional(function(){Ue.command(bo(wn),"invalid matrix for uniform "+gt,Qe.commandStr),Ue.command(rr===Ei&&wn.length===4||rr===ya&&wn.length===9||rr===ia&&wn.length===16,"invalid length for matrix uniform "+gt,Qe.commandStr)});var yi=Qe.global.def("new Float32Array(["+Array.prototype.slice.call(wn)+"])"),Si=2;rr===ya?Si=3:rr===ia&&(Si=4),xt(nr,".uniformMatrix",Si,"fv(",Sn,",false,",yi,");")}else{switch(rr){case Oe:Ue.commandType(wn,"number","uniform "+gt,Qe.commandStr),ur="1f";break;case dt:Ue.command(bo(wn)&&wn.length===2,"uniform "+gt,Qe.commandStr),ur="2f";break;case Lt:Ue.command(bo(wn)&&wn.length===3,"uniform "+gt,Qe.commandStr),ur="3f";break;case _t:Ue.command(bo(wn)&&wn.length===4,"uniform "+gt,Qe.commandStr),ur="4f";break;case Hn:Ue.commandType(wn,"boolean","uniform "+gt,Qe.commandStr),ur="1i";break;case jt:Ue.commandType(wn,"number","uniform "+gt,Qe.commandStr),ur="1i";break;case _i:Ue.command(bo(wn)&&wn.length===2,"uniform "+gt,Qe.commandStr),ur="2i";break;case Fr:Ue.command(bo(wn)&&wn.length===2,"uniform "+gt,Qe.commandStr),ur="2i";break;case Pi:Ue.command(bo(wn)&&wn.length===3,"uniform "+gt,Qe.commandStr),ur="3i";break;case $r:Ue.command(bo(wn)&&wn.length===3,"uniform "+gt,Qe.commandStr),ur="3i";break;case Jn:Ue.command(bo(wn)&&wn.length===4,"uniform "+gt,Qe.commandStr),ur="4i";break;case Un:Ue.command(bo(wn)&&wn.length===4,"uniform "+gt,Qe.commandStr),ur="4i";break}xt(nr,".uniform",ur,"(",Sn,",",bo(wn)?Array.prototype.slice.call(wn):wn,");")}continue}else pn=zr.append(Qe,xt)}else{if(!Ar(Sd))continue;pn=xt.def(Kt.uniforms,"[",pt.id(gt),"]")}rr===zo?xt("if(",pn,"&&",pn,'._reglType==="framebuffer"){',pn,"=",pn,".color[0];","}"):rr===co&&xt("if(",pn,"&&",pn,'._reglType==="framebufferCube"){',pn,"=",pn,".color[0];","}"),Ue.optional(function(){function Uc(Vf,Md){Qe.assert(xt,Vf,'bad data or missing for uniform "'+gt+'".  '+Md)}function Bh(Vf){Uc("typeof "+pn+'==="'+Vf+'"',"invalid type, expected "+Vf)}function lc(Vf,Md){Uc(Kt.isArrayLike+"("+pn+")&&"+pn+".length==="+Vf,"invalid vector, should have length "+Vf,Qe.commandStr)}function cp(Vf){Uc("typeof "+pn+'==="function"&&'+pn+'._reglType==="texture'+(Vf===Zf?"2d":"Cube")+'"',"invalid texture type",Qe.commandStr)}switch(rr){case jt:Bh("number");break;case Fr:lc(2,"number");break;case $r:lc(3,"number");break;case Un:lc(4,"number");break;case Oe:Bh("number");break;case dt:lc(2,"number");break;case Lt:lc(3,"number");break;case _t:lc(4,"number");break;case Hn:Bh("boolean");break;case _i:lc(2,"boolean");break;case Pi:lc(3,"boolean");break;case Jn:lc(4,"boolean");break;case Ei:lc(4,"number");break;case ya:lc(9,"number");break;case ia:lc(16,"number");break;case zo:cp(Zf);break;case co:cp(np);break}});var Wi=1;switch(rr){case zo:case co:var Ki=xt.def(pn,"._texture");xt(nr,".uniform1i(",Sn,",",Ki,".bind());"),xt.exit(Ki,".unbind();");continue;case jt:case Hn:ur="1i";break;case Fr:case _i:ur="2i",Wi=2;break;case $r:case Pi:ur="3i",Wi=3;break;case Un:case Jn:ur="4i",Wi=4;break;case Oe:ur="1f";break;case dt:ur="2f",Wi=2;break;case Lt:ur="3f",Wi=3;break;case _t:ur="4f",Wi=4;break;case Ei:ur="Matrix2fv";break;case ya:ur="Matrix3fv";break;case ia:ur="Matrix4fv";break}if(xt(nr,".uniform",ur,"(",Sn,","),ur.charAt(0)==="M"){var to=Math.pow(rr-Ei+2,2),js=Qe.global.def("new Float32Array(",to,")");xt("false,(Array.isArray(",pn,")||",pn," instanceof Float32Array)?",pn,":(",Wt(to,function(Uc){return js+"["+Uc+"]="+pn+"["+Uc+"]"}),",",js,")")}else Wi>1?xt(Wt(Wi,function(Uc){return pn+"["+Uc+"]"})):xt(pn);xt(");")}}function $i(Qe,xt,Nt,Mr){var Ar=Qe.shared,Kt=Ar.gl,nr=Ar.draw,ur=Mr.draw;function Dt(){var Ki=ur.elements,to,js=xt;return Ki?((Ki.contextDep&&Mr.contextDynamic||Ki.propDep)&&(js=Nt),to=Ki.append(Qe,js)):to=js.def(nr,".",Ma),to&&js("if("+to+")"+Kt+".bindBuffer("+Vp+","+to+".buffer.buffer);"),to}function Jt(){var Ki=ur.count,to,js=xt;return Ki?((Ki.contextDep&&Mr.contextDynamic||Ki.propDep)&&(js=Nt),to=Ki.append(Qe,js),Ue.optional(function(){Ki.MISSING&&Qe.assert(xt,"false","missing vertex count"),Ki.DYNAMIC&&Qe.assert(js,to+">=0","missing vertex count")})):(to=js.def(nr,".",xs),Ue.optional(function(){Qe.assert(js,to+">=0","missing vertex count")})),to}var gt=Dt();function rr(Ki){var to=ur[Ki];return to?to.contextDep&&Mr.contextDynamic||to.propDep?to.append(Qe,Nt):to.append(Qe,xt):xt.def(nr,".",Ki)}var zr=rr(bs),Yr=rr(sc),Sn=Jt();if(typeof Sn=="number"){if(Sn===0)return}else Nt("if(",Sn,"){"),Nt.exit("}");var pn,wn;Bn&&(pn=rr(rh),wn=Qe.instancing);var wi=gt+".type",yi=ur.elements&&Bu(ur.elements);function Si(){function Ki(){Nt(wn,".drawElementsInstancedANGLE(",[zr,Sn,wi,Yr+"<<(("+wi+"-"+M+")>>1)",pn],");")}function to(){Nt(wn,".drawArraysInstancedANGLE(",[zr,Yr,Sn,pn],");")}gt?yi?Ki():(Nt("if(",gt,"){"),Ki(),Nt("}else{"),to(),Nt("}")):to()}function Wi(){function Ki(){Nt(Kt+".drawElements("+[zr,Sn,wi,Yr+"<<(("+wi+"-"+M+")>>1)"]+");")}function to(){Nt(Kt+".drawArrays("+[zr,Yr,Sn]+");")}gt?yi?Ki():(Nt("if(",gt,"){"),Ki(),Nt("}else{"),to(),Nt("}")):to()}Bn&&(typeof pn!="number"||pn>=0)?typeof pn=="string"?(Nt("if(",pn,">0){"),Si(),Nt("}else if(",pn,"<0){"),Wi(),Nt("}")):Si():Wi()}function xa(Qe,xt,Nt,Mr,Ar){var Kt=zi(),nr=Kt.proc("body",Ar);return Ue.optional(function(){Kt.commandStr=xt.commandStr,Kt.command=Kt.link(xt.commandStr)}),Bn&&(Kt.instancing=nr.def(Kt.shared.extensions,".angle_instanced_arrays")),Qe(Kt,nr,Nt,Mr),Kt.compile().body}function Ha(Qe,xt,Nt,Mr){Zs(Qe,xt),Nt.useVAO?Nt.drawVAO?xt(Qe.shared.vao,".setVAO(",Nt.drawVAO.append(Qe,xt),");"):xt(Qe.shared.vao,".setVAO(",Qe.shared.vao,".targetVAO);"):(xt(Qe.shared.vao,".setVAO(null);"),pu(Qe,xt,Nt,Mr.attributes,function(){return!0})),ta(Qe,xt,Nt,Mr.uniforms,function(){return!0}),$i(Qe,xt,xt,Nt)}function Es(Qe,xt){var Nt=Qe.proc("draw",1);Zs(Qe,Nt),zs(Qe,Nt,xt.context),cs(Qe,Nt,xt.framebuffer),Js(Qe,Nt,xt),Fu(Qe,Nt,xt.state),ca(Qe,Nt,xt,!1,!0);var Mr=xt.shader.progVar.append(Qe,Nt);if(Nt(Qe.shared.gl,".useProgram(",Mr,".program);"),xt.shader.program)Ha(Qe,Nt,xt,xt.shader.program);else{Nt(Qe.shared.vao,".setVAO(null);");var Ar=Qe.global.def("{}"),Kt=Nt.def(Mr,".id"),nr=Nt.def(Ar,"[",Kt,"]");Nt(Qe.cond(nr).then(nr,".call(this,a0);").else(nr,"=",Ar,"[",Kt,"]=",Qe.link(function(ur){return xa(Ha,Qe,xt,ur,1)}),"(",Mr,");",nr,".call(this,a0);"))}Object.keys(xt.state).length>0&&Nt(Qe.shared.current,".dirty=true;")}function wc(Qe,xt,Nt,Mr){Qe.batchId="a1",Zs(Qe,xt);function Ar(){return!0}pu(Qe,xt,Nt,Mr.attributes,Ar),ta(Qe,xt,Nt,Mr.uniforms,Ar),$i(Qe,xt,xt,Nt)}function It(Qe,xt,Nt,Mr){Zs(Qe,xt);var Ar=Nt.contextDep,Kt=xt.def(),nr="a0",ur="a1",Dt=xt.def();Qe.shared.props=Dt,Qe.batchId=Kt;var Jt=Qe.scope(),gt=Qe.scope();xt(Jt.entry,"for(",Kt,"=0;",Kt,"<",ur,";++",Kt,"){",Dt,"=",nr,"[",Kt,"];",gt,"}",Jt.exit);function rr(wi){return wi.contextDep&&Ar||wi.propDep}function zr(wi){return!rr(wi)}if(Nt.needsContext&&zs(Qe,gt,Nt.context),Nt.needsFramebuffer&&cs(Qe,gt,Nt.framebuffer),Fu(Qe,gt,Nt.state,rr),Nt.profile&&rr(Nt.profile)&&ca(Qe,gt,Nt,!1,!0),Mr)Nt.useVAO?Nt.drawVAO?rr(Nt.drawVAO)?gt(Qe.shared.vao,".setVAO(",Nt.drawVAO.append(Qe,gt),");"):Jt(Qe.shared.vao,".setVAO(",Nt.drawVAO.append(Qe,Jt),");"):Jt(Qe.shared.vao,".setVAO(",Qe.shared.vao,".targetVAO);"):(Jt(Qe.shared.vao,".setVAO(null);"),pu(Qe,Jt,Nt,Mr.attributes,zr),pu(Qe,gt,Nt,Mr.attributes,rr)),ta(Qe,Jt,Nt,Mr.uniforms,zr),ta(Qe,gt,Nt,Mr.uniforms,rr),$i(Qe,Jt,gt,Nt);else{var Yr=Qe.global.def("{}"),Sn=Nt.shader.progVar.append(Qe,gt),pn=gt.def(Sn,".id"),wn=gt.def(Yr,"[",pn,"]");gt(Qe.shared.gl,".useProgram(",Sn,".program);","if(!",wn,"){",wn,"=",Yr,"[",pn,"]=",Qe.link(function(wi){return xa(wc,Qe,Nt,wi,2)}),"(",Sn,");}",wn,".call(this,a0[",Kt,"],",Kt,");")}}function Nr(Qe,xt){var Nt=Qe.proc("batch",2);Qe.batchId="0",Zs(Qe,Nt);var Mr=!1,Ar=!0;Object.keys(xt.context).forEach(function(Yr){Mr=Mr||xt.context[Yr].propDep}),Mr||(zs(Qe,Nt,xt.context),Ar=!1);var Kt=xt.framebuffer,nr=!1;Kt?(Kt.propDep?Mr=nr=!0:Kt.contextDep&&Mr&&(nr=!0),nr||cs(Qe,Nt,Kt)):cs(Qe,Nt,null),xt.state.viewport&&xt.state.viewport.propDep&&(Mr=!0);function ur(Yr){return Yr.contextDep&&Mr||Yr.propDep}Js(Qe,Nt,xt),Fu(Qe,Nt,xt.state,function(Yr){return!ur(Yr)}),(!xt.profile||!ur(xt.profile))&&ca(Qe,Nt,xt,!1,"a1"),xt.contextDep=Mr,xt.needsContext=Ar,xt.needsFramebuffer=nr;var Dt=xt.shader.progVar;if(Dt.contextDep&&Mr||Dt.propDep)It(Qe,Nt,xt,null);else{var Jt=Dt.append(Qe,Nt);if(Nt(Qe.shared.gl,".useProgram(",Jt,".program);"),xt.shader.program)It(Qe,Nt,xt,xt.shader.program);else{Nt(Qe.shared.vao,".setVAO(null);");var gt=Qe.global.def("{}"),rr=Nt.def(Jt,".id"),zr=Nt.def(gt,"[",rr,"]");Nt(Qe.cond(zr).then(zr,".call(this,a0,a1);").else(zr,"=",gt,"[",rr,"]=",Qe.link(function(Yr){return xa(It,Qe,xt,Yr,2)}),"(",Jt,");",zr,".call(this,a0,a1);"))}}Object.keys(xt.state).length>0&&Nt(Qe.shared.current,".dirty=true;")}function Rr(Qe,xt){var Nt=Qe.proc("scope",3);Qe.batchId="a2";var Mr=Qe.shared,Ar=Mr.current;zs(Qe,Nt,xt.context),xt.framebuffer&&xt.framebuffer.append(Qe,Nt),nd(Object.keys(xt.state)).forEach(function(nr){var ur=xt.state[nr],Dt=ur.append(Qe,Nt);bo(Dt)?Dt.forEach(function(Jt,gt){Nt.set(Qe.next[nr],"["+gt+"]",Jt)}):Nt.set(Mr.next,"."+nr,Dt)}),ca(Qe,Nt,xt,!0,!0),[Ma,sc,xs,rh,bs].forEach(function(nr){var ur=xt.draw[nr];ur&&Nt.set(Mr.draw,"."+nr,""+ur.append(Qe,Nt))}),Object.keys(xt.uniforms).forEach(function(nr){Nt.set(Mr.uniforms,"["+pt.id(nr)+"]",xt.uniforms[nr].append(Qe,Nt))}),Object.keys(xt.attributes).forEach(function(nr){var ur=xt.attributes[nr].append(Qe,Nt),Dt=Qe.scopeAttrib(nr);Object.keys(new _r).forEach(function(Jt){Nt.set(Dt,"."+Jt,ur[Jt])})}),xt.scopeVAO&&Nt.set(Mr.vao,".targetVAO",xt.scopeVAO.append(Qe,Nt));function Kt(nr){var ur=xt.shader[nr];ur&&Nt.set(Mr.shader,"."+nr,ur.append(Qe,Nt))}Kt(hl),Kt(Xl),Object.keys(xt.state).length>0&&(Nt(Ar,".dirty=true;"),Nt.exit(Ar,".dirty=true;")),Nt("a1(",Qe.shared.context,",a0,",Qe.batchId,");")}function li(Qe){if(!(typeof Qe!="object"||bo(Qe))){for(var xt=Object.keys(Qe),Nt=0;Nt<xt.length;++Nt)if(Kr.isDynamic(Qe[xt[Nt]]))return!0;return!1}}function ha(Qe,xt,Nt){var Mr=xt.static[Nt];if(!Mr||!li(Mr))return;var Ar=Qe.global,Kt=Object.keys(Mr),nr=!1,ur=!1,Dt=!1,Jt=Qe.global.def("{}");Kt.forEach(function(rr){var zr=Mr[rr];if(Kr.isDynamic(zr)){typeof zr=="function"&&(zr=Mr[rr]=Kr.unbox(zr));var Yr=ql(zr,null);nr=nr||Yr.thisDep,Dt=Dt||Yr.propDep,ur=ur||Yr.contextDep}else{switch(Ar(Jt,".",rr,"="),typeof zr){case"number":Ar(zr);break;case"string":Ar('"',zr,'"');break;case"object":Array.isArray(zr)&&Ar("[",zr.join(),"]");break;default:Ar(Qe.link(zr));break}Ar(";")}});function gt(rr,zr){Kt.forEach(function(Yr){var Sn=Mr[Yr];if(Kr.isDynamic(Sn)){var pn=rr.invoke(zr,Sn);zr(Jt,".",Yr,"=",pn,";")}})}xt.dynamic[Nt]=new Kr.DynamicVariable(it,{thisDep:nr,contextDep:ur,propDep:Dt,ref:Jt,append:gt}),delete xt.static[Nt]}function vo(Qe,xt,Nt,Mr,Ar){var Kt=zi();Kt.stats=Kt.link(Ar),Object.keys(xt.static).forEach(function(ur){ha(Kt,xt,ur)}),nh.forEach(function(ur){ha(Kt,Qe,ur)});var nr=Us(Qe,xt,Nt,Mr,Kt);return Es(Kt,nr),Rr(Kt,nr),Nr(Kt,nr),Kt.compile()}return{next:si,current:bn,procs:function(){var Qe=zi(),xt=Qe.proc("poll"),Nt=Qe.proc("refresh"),Mr=Qe.block();xt(Mr),Nt(Mr);var Ar=Qe.shared,Kt=Ar.gl,nr=Ar.next,ur=Ar.current;Mr(ur,".dirty=false;"),cs(Qe,xt),cs(Qe,Nt,null,!0);var Dt;Bn&&(Dt=Qe.link(Bn)),Ut.oes_vertex_array_object&&Nt(Qe.link(Ut.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Jt=0;Jt<Pr.maxAttributes;++Jt){var gt=Nt.def(Ar.attributes,"[",Jt,"]"),rr=Qe.cond(gt,".buffer");rr.then(Kt,".enableVertexAttribArray(",Jt,");",Kt,".bindBuffer(",ih,",",gt,".buffer.buffer);",Kt,".vertexAttribPointer(",Jt,",",gt,".size,",gt,".type,",gt,".normalized,",gt,".stride,",gt,".offset);").else(Kt,".disableVertexAttribArray(",Jt,");",Kt,".vertexAttrib4f(",Jt,",",gt,".x,",gt,".y,",gt,".z,",gt,".w);",gt,".buffer=null;"),Nt(rr),Bn&&Nt(Dt,".vertexAttribDivisorANGLE(",Jt,",",gt,".divisor);")}return Nt(Qe.shared.vao,".currentVAO=null;",Qe.shared.vao,".setVAO(",Qe.shared.vao,".targetVAO);"),Object.keys(ii).forEach(function(zr){var Yr=ii[zr],Sn=Mr.def(nr,".",zr),pn=Qe.block();pn("if(",Sn,"){",Kt,".enable(",Yr,")}else{",Kt,".disable(",Yr,")}",ur,".",zr,"=",Sn,";"),Nt(pn),xt("if(",Sn,"!==",ur,".",zr,"){",pn,"}")}),Object.keys(En).forEach(function(zr){var Yr=En[zr],Sn=bn[zr],pn,wn,wi=Qe.block();if(wi(Kt,".",Yr,"("),bo(Sn)){var yi=Sn.length;pn=Qe.global.def(nr,".",zr),wn=Qe.global.def(ur,".",zr),wi(Wt(yi,function(Si){return pn+"["+Si+"]"}),");",Wt(yi,function(Si){return wn+"["+Si+"]="+pn+"["+Si+"];"}).join("")),xt("if(",Wt(yi,function(Si){return pn+"["+Si+"]!=="+wn+"["+Si+"]"}).join("||"),"){",wi,"}")}else pn=Mr.def(nr,".",zr),wn=Mr.def(ur,".",zr),wi(pn,");",ur,".",zr,"=",pn,";"),xt("if(",pn,"!==",wn,"){",wi,"}");Nt(wi)}),Qe.compile()}(),compile:vo}}function Td(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var ap=34918,Hp=34919,op=35007,$p=function(Ee,pt){if(!pt.ext_disjoint_timer_query)return null;var Ut=[];function Pr(){return Ut.pop()||pt.ext_disjoint_timer_query.createQueryEXT()}function ln(Bn){Ut.push(Bn)}var Lr=[];function Tr(Bn){var ni=Pr();pt.ext_disjoint_timer_query.beginQueryEXT(op,ni),Lr.push(ni),Cn(Lr.length-1,Lr.length,Bn)}function Ln(){pt.ext_disjoint_timer_query.endQueryEXT(op)}function An(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var $n=[];function Fn(){return $n.pop()||new An}function jn(Bn){$n.push(Bn)}var Kn=[];function Cn(Bn,ni,bn){var si=Fn();si.startQueryIndex=Bn,si.endQueryIndex=ni,si.sum=0,si.stats=bn,Kn.push(si)}var Vn=[],_r=[];function Gr(){var Bn,ni,bn=Lr.length;if(bn!==0){_r.length=Math.max(_r.length,bn+1),Vn.length=Math.max(Vn.length,bn+1),Vn[0]=0,_r[0]=0;var si=0;for(Bn=0,ni=0;ni<Lr.length;++ni){var Mn=Lr[ni];pt.ext_disjoint_timer_query.getQueryObjectEXT(Mn,Hp)?(si+=pt.ext_disjoint_timer_query.getQueryObjectEXT(Mn,ap),ln(Mn)):Lr[Bn++]=Mn,Vn[ni+1]=si,_r[ni+1]=Bn}for(Lr.length=Bn,Bn=0,ni=0;ni<Kn.length;++ni){var ii=Kn[ni],En=ii.startQueryIndex,Qn=ii.endQueryIndex;ii.sum+=Vn[Qn]-Vn[En];var Ui=_r[En],oa=_r[Qn];oa===Ui?(ii.stats.gpuTime+=ii.sum/1e6,jn(ii)):(ii.startQueryIndex=Ui,ii.endQueryIndex=oa,Kn[Bn++]=ii)}Kn.length=Bn}}return{beginQuery:Tr,endQuery:Ln,pushScopeStats:Cn,update:Gr,getNumPendingQueries:function(){return Lr.length},clear:function(){Ut.push.apply(Ut,Lr);for(var Bn=0;Bn<Ut.length;Bn++)pt.ext_disjoint_timer_query.deleteQueryEXT(Ut[Bn]);Lr.length=0,Ut.length=0},restore:function(){Lr.length=0,Ut.length=0}}},sp=16384,Yu=256,Wp=1024,Ad=34962,Cd="webglcontextlost",up="webglcontextrestored",id=1,lp=2,Lh=3;function wd(Ee,pt){for(var Ut=0;Ut<Ee.length;++Ut)if(Ee[Ut]===pt)return Ut;return-1}function Rd(Ee){var pt=ar(Ee);if(!pt)return null;var Ut=pt.gl,Pr=Ut.getContextAttributes(),ln=Ut.isContextLost(),Lr=or(Ut,pt);if(!Lr)return null;var Tr=De(),Ln=Td(),An=Lr.extensions,$n=$p(Ut,An),Fn=Wn(),jn=Ut.drawingBufferWidth,Kn=Ut.drawingBufferHeight,Cn={tick:0,time:0,viewportWidth:jn,viewportHeight:Kn,framebufferWidth:jn,framebufferHeight:Kn,drawingBufferWidth:jn,drawingBufferHeight:Kn,pixelRatio:pt.pixelRatio},Vn={},_r={elements:null,primitive:4,count:-1,offset:0,instances:-1},Gr=$(Ut,An),Bn=hf(Ut,Ln,pt,bn),ni=Le(Ut,An,Gr,Ln,Bn);function bn($i){return ni.destroyBuffer($i)}var si=Vc(Ut,An,Bn,Ln),Mn=Ct(Ut,Tr,Ln,pt),ii=$o(Ut,An,Gr,function(){Ui.procs.poll()},Cn,Ln,pt),En=fu(Ut,An,Gr,Ln,pt),Qn=R(Ut,An,Gr,ii,En,Ln),Ui=_h(Ut,Tr,An,Gr,Bn,si,ii,Qn,Vn,ni,Mn,_r,Cn,$n,pt),oa=br(Ut,Qn,Ui.procs.poll,Cn,Pr,An,Gr),ei=Ui.next,Pn=Ut.canvas,cn=[],zi=[],pa=[],ui=[pt.onDestroy],va=null;function aa(){if(cn.length===0){$n&&$n.update(),va=null;return}va=en.next(aa),Fu();for(var $i=cn.length-1;$i>=0;--$i){var xa=cn[$i];xa&&xa(Cn,null,0)}Ut.flush(),$n&&$n.update()}function Yi(){!va&&cn.length>0&&(va=en.next(aa))}function Qa(){va&&(en.cancel(aa),va=null)}function Is($i){$i.preventDefault(),ln=!0,Qa(),zi.forEach(function(xa){xa()})}function du($i){Ut.getError(),ln=!1,Lr.restore(),Mn.restore(),Bn.restore(),ii.restore(),En.restore(),Qn.restore(),ni.restore(),$n&&$n.restore(),Ui.procs.refresh(),Yi(),pa.forEach(function(xa){xa()})}Pn&&(Pn.addEventListener(Cd,Is,!1),Pn.addEventListener(up,du,!1));function ba(){cn.length=0,Qa(),Pn&&(Pn.removeEventListener(Cd,Is),Pn.removeEventListener(up,du)),Mn.clear(),Qn.clear(),En.clear(),ii.clear(),si.clear(),Bn.clear(),ni.clear(),$n&&$n.clear(),ui.forEach(function($i){$i()})}function Os($i){Ue(!!$i,"invalid args to regl({...})"),Ue.type($i,"object","invalid args to regl({...})");function xa(Ar){var Kt=_({},Ar);delete Kt.uniforms,delete Kt.attributes,delete Kt.context,delete Kt.vao,"stencil"in Kt&&Kt.stencil.op&&(Kt.stencil.opBack=Kt.stencil.opFront=Kt.stencil.op,delete Kt.stencil.op);function nr(ur){if(ur in Kt){var Dt=Kt[ur];delete Kt[ur],Object.keys(Dt).forEach(function(Jt){Kt[ur+"."+Jt]=Dt[Jt]})}}return nr("blend"),nr("depth"),nr("cull"),nr("stencil"),nr("polygonOffset"),nr("scissor"),nr("sample"),"vao"in Ar&&(Kt.vao=Ar.vao),Kt}function Ha(Ar){var Kt={},nr={};return Object.keys(Ar).forEach(function(ur){var Dt=Ar[ur];Kr.isDynamic(Dt)?nr[ur]=Kr.unbox(Dt,ur):Kt[ur]=Dt}),{dynamic:nr,static:Kt}}var Es=Ha($i.context||{}),wc=Ha($i.uniforms||{}),It=Ha($i.attributes||{}),Nr=Ha(xa($i)),Rr={gpuTime:0,cpuTime:0,count:0},li=Ui.compile(Nr,It,wc,Es,Rr),ha=li.draw,vo=li.batch,Qe=li.scope,xt=[];function Nt(Ar){for(;xt.length<Ar;)xt.push(null);return xt}function Mr(Ar,Kt){var nr;if(ln&&Ue.raise("context lost"),typeof Ar=="function")return Qe.call(this,null,Ar,0);if(typeof Kt=="function")if(typeof Ar=="number")for(nr=0;nr<Ar;++nr)Qe.call(this,null,Kt,nr);else if(Array.isArray(Ar))for(nr=0;nr<Ar.length;++nr)Qe.call(this,Ar[nr],Kt,nr);else return Qe.call(this,Ar,Kt,0);else if(typeof Ar=="number"){if(Ar>0)return vo.call(this,Nt(Ar|0),Ar|0)}else if(Array.isArray(Ar)){if(Ar.length)return vo.call(this,Ar,Ar.length)}else return ha.call(this,Ar)}return _(Mr,{stats:Rr})}var Lo=Qn.setFBO=Os({framebuffer:Kr.define.call(null,id,"framebuffer")});function Us($i,xa){var Ha=0;Ui.procs.poll();var Es=xa.color;Es&&(Ut.clearColor(+Es[0]||0,+Es[1]||0,+Es[2]||0,+Es[3]||0),Ha|=sp),"depth"in xa&&(Ut.clearDepth(+xa.depth),Ha|=Yu),"stencil"in xa&&(Ut.clearStencil(xa.stencil|0),Ha|=Wp),Ue(!!Ha,"called regl.clear with no buffer specified"),Ut.clear(Ha)}function zs($i){if(Ue(typeof $i=="object"&&$i,"regl.clear() takes an object as input"),"framebuffer"in $i)if($i.framebuffer&&$i.framebuffer_reglType==="framebufferCube")for(var xa=0;xa<6;++xa)Lo(_({framebuffer:$i.framebuffer.faces[xa]},$i),Us);else Lo($i,Us);else Us(null,$i)}function cs($i){Ue.type($i,"function","regl.frame() callback must be a function"),cn.push($i);function xa(){var Ha=wd(cn,$i);Ue(Ha>=0,"cannot cancel a frame twice");function Es(){var wc=wd(cn,Es);cn[wc]=cn[cn.length-1],cn.length-=1,cn.length<=0&&Qa()}cn[Ha]=Es}return Yi(),{cancel:xa}}function Js(){var $i=ei.viewport,xa=ei.scissor_box;$i[0]=$i[1]=xa[0]=xa[1]=0,Cn.viewportWidth=Cn.framebufferWidth=Cn.drawingBufferWidth=$i[2]=xa[2]=Ut.drawingBufferWidth,Cn.viewportHeight=Cn.framebufferHeight=Cn.drawingBufferHeight=$i[3]=xa[3]=Ut.drawingBufferHeight}function Fu(){Cn.tick+=1,Cn.time=ca(),Js(),Ui.procs.poll()}function Zs(){Js(),Ui.procs.refresh(),$n&&$n.update()}function ca(){return(Wn()-Fn)/1e3}Zs();function pu($i,xa){Ue.type(xa,"function","listener callback must be a function");var Ha;switch($i){case"frame":return cs(xa);case"lost":Ha=zi;break;case"restore":Ha=pa;break;case"destroy":Ha=ui;break;default:Ue.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ha.push(xa),{cancel:function(){for(var Es=0;Es<Ha.length;++Es)if(Ha[Es]===xa){Ha[Es]=Ha[Ha.length-1],Ha.pop();return}}}}var ta=_(Os,{clear:zs,prop:Kr.define.bind(null,id),context:Kr.define.bind(null,lp),this:Kr.define.bind(null,Lh),draw:Os({}),buffer:function($i){return Bn.create($i,Ad,!1,!1)},elements:function($i){return si.create($i,!1)},texture:ii.create2D,cube:ii.createCube,renderbuffer:En.create,framebuffer:Qn.create,framebufferCube:Qn.createCube,vao:ni.createVAO,attributes:Pr,frame:cs,on:pu,limits:Gr,hasExtension:function($i){return Gr.extensions.indexOf($i.toLowerCase())>=0},read:oa,destroy:ba,_gl:Ut,_refresh:Zs,poll:function(){Fu(),$n&&$n.update()},now:ca,stats:Ln});return pt.onDone(null,ta),ta}return Rd})},69848:function(Ze){(function(E,_){Ze.exports=_()})(this,function(){"use strict";function E(ae,ee,me,ge,fe,Et){if(!(fe-ge<=me)){var xe=ge+fe>>1;_(ae,ee,xe,ge,fe,Et%2),E(ae,ee,me,ge,xe-1,Et+1),E(ae,ee,me,xe+1,fe,Et+1)}}function _(ae,ee,me,ge,fe,Et){for(;fe>ge;){if(fe-ge>600){var xe=fe-ge+1,je=me-ge+1,ue=Math.log(xe),Pe=.5*Math.exp(2*ue/3),we=.5*Math.sqrt(ue*Pe*(xe-Pe)/xe)*(je-xe/2<0?-1:1),nt=Math.max(ge,Math.floor(me-je*Pe/xe+we)),at=Math.min(fe,Math.floor(me+(xe-je)*Pe/xe+we));_(ae,ee,me,nt,at,Et)}var vt=ee[2*me+Et],Tt=ge,ze=fe;for(D(ae,ee,ge,me),ee[2*fe+Et]>vt&&D(ae,ee,ge,fe);Tt<ze;){for(D(ae,ee,Tt,ze),Tt++,ze--;ee[2*Tt+Et]<vt;)Tt++;for(;ee[2*ze+Et]>vt;)ze--}ee[2*ge+Et]===vt?D(ae,ee,ge,ze):(ze++,D(ae,ee,ze,fe)),ze<=me&&(ge=ze+1),me<=ze&&(fe=ze-1)}}function D(ae,ee,me,ge){N(ae,me,ge),N(ee,2*me,2*ge),N(ee,2*me+1,2*ge+1)}function N(ae,ee,me){var ge=ae[ee];ae[ee]=ae[me],ae[me]=ge}function h(ae,ee,me,ge,fe,Et,xe){for(var je=[0,ae.length-1,0],ue=[],Pe,we;je.length;){var nt=je.pop(),at=je.pop(),vt=je.pop();if(at-vt<=xe){for(var Tt=vt;Tt<=at;Tt++)Pe=ee[2*Tt],we=ee[2*Tt+1],Pe>=me&&Pe<=fe&&we>=ge&&we<=Et&&ue.push(ae[Tt]);continue}var ze=Math.floor((vt+at)/2);Pe=ee[2*ze],we=ee[2*ze+1],Pe>=me&&Pe<=fe&&we>=ge&&we<=Et&&ue.push(ae[ze]);var gr=(nt+1)%2;(nt===0?me<=Pe:ge<=we)&&(je.push(vt),je.push(ze-1),je.push(gr)),(nt===0?fe>=Pe:Et>=we)&&(je.push(ze+1),je.push(at),je.push(gr))}return ue}function O(ae,ee,me,ge,fe,Et){for(var xe=[0,ae.length-1,0],je=[],ue=fe*fe;xe.length;){var Pe=xe.pop(),we=xe.pop(),nt=xe.pop();if(we-nt<=Et){for(var at=nt;at<=we;at++)C(ee[2*at],ee[2*at+1],me,ge)<=ue&&je.push(ae[at]);continue}var vt=Math.floor((nt+we)/2),Tt=ee[2*vt],ze=ee[2*vt+1];C(Tt,ze,me,ge)<=ue&&je.push(ae[vt]);var gr=(Pe+1)%2;(Pe===0?me-fe<=Tt:ge-fe<=ze)&&(xe.push(nt),xe.push(vt-1),xe.push(gr)),(Pe===0?me+fe>=Tt:ge+fe>=ze)&&(xe.push(vt+1),xe.push(we),xe.push(gr))}return je}function C(ae,ee,me,ge){var fe=ae-me,Et=ee-ge;return fe*fe+Et*Et}var P=function(ae){return ae[0]},F=function(ae){return ae[1]},Y=function(ee,me,ge,fe,Et){me===void 0&&(me=P),ge===void 0&&(ge=F),fe===void 0&&(fe=64),Et===void 0&&(Et=Float64Array),this.nodeSize=fe,this.points=ee;for(var xe=ee.length<65536?Uint16Array:Uint32Array,je=this.ids=new xe(ee.length),ue=this.coords=new Et(ee.length*2),Pe=0;Pe<ee.length;Pe++)je[Pe]=Pe,ue[2*Pe]=me(ee[Pe]),ue[2*Pe+1]=ge(ee[Pe]);E(je,ue,fe,0,je.length-1,0)};Y.prototype.range=function(ee,me,ge,fe){return h(this.ids,this.coords,ee,me,ge,fe,this.nodeSize)},Y.prototype.within=function(ee,me,ge){return O(this.ids,this.coords,ee,me,ge,this.nodeSize)};var V={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ae){return ae}},Q=Math.fround||function(ae){return function(ee){return ae[0]=+ee,ae[0]}}(new Float32Array(1)),k=function(ee){this.options=Ve(Object.create(V),ee),this.trees=new Array(this.options.maxZoom+1)};k.prototype.load=function(ee){var me=this.options,ge=me.log,fe=me.minZoom,Et=me.maxZoom,xe=me.nodeSize;ge&&console.time("total time");var je="prepare "+ee.length+" points";ge&&console.time(je),this.points=ee;for(var ue=[],Pe=0;Pe<ee.length;Pe++)ee[Pe].geometry&&ue.push(U(ee[Pe],Pe));this.trees[Et+1]=new Y(ue,Re,Ae,xe,Float32Array),ge&&console.timeEnd(je);for(var we=Et;we>=fe;we--){var nt=+Date.now();ue=this._cluster(ue,we),this.trees[we]=new Y(ue,Re,Ae,xe,Float32Array),ge&&console.log("z%d: %d clusters in %dms",we,ue.length,+Date.now()-nt)}return ge&&console.timeEnd("total time"),this},k.prototype.getClusters=function(ee,me){var ge=((ee[0]+180)%360+360)%360-180,fe=Math.max(-90,Math.min(90,ee[1])),Et=ee[2]===180?180:((ee[2]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ge=-180,Et=180;else if(ge>Et){var je=this.getClusters([ge,fe,180,xe],me),ue=this.getClusters([-180,fe,Et,xe],me);return je.concat(ue)}for(var Pe=this.trees[this._limitZoom(me)],we=Pe.range(H(ge),ve(xe),H(Et),ve(fe)),nt=[],at=0,vt=we;at<vt.length;at+=1){var Tt=vt[at],ze=Pe.points[Tt];nt.push(ze.numPoints?Z(ze):this.points[ze.index])}return nt},k.prototype.getChildren=function(ee){var me=this._getOriginId(ee),ge=this._getOriginZoom(ee),fe="No cluster with the specified id.",Et=this.trees[ge];if(!Et)throw new Error(fe);var xe=Et.points[me];if(!xe)throw new Error(fe);for(var je=this.options.radius/(this.options.extent*Math.pow(2,ge-1)),ue=Et.within(xe.x,xe.y,je),Pe=[],we=0,nt=ue;we<nt.length;we+=1){var at=nt[we],vt=Et.points[at];vt.parentId===ee&&Pe.push(vt.numPoints?Z(vt):this.points[vt.index])}if(Pe.length===0)throw new Error(fe);return Pe},k.prototype.getLeaves=function(ee,me,ge){me=me||10,ge=ge||0;var fe=[];return this._appendLeaves(fe,ee,me,ge,0),fe},k.prototype.getTile=function(ee,me,ge){var fe=this.trees[this._limitZoom(ee)],Et=Math.pow(2,ee),xe=this.options,je=xe.extent,ue=xe.radius,Pe=ue/je,we=(ge-Pe)/Et,nt=(ge+1+Pe)/Et,at={features:[]};return this._addTileFeatures(fe.range((me-Pe)/Et,we,(me+1+Pe)/Et,nt),fe.points,me,ge,Et,at),me===0&&this._addTileFeatures(fe.range(1-Pe/Et,we,1,nt),fe.points,Et,ge,Et,at),me===Et-1&&this._addTileFeatures(fe.range(0,we,Pe/Et,nt),fe.points,-1,ge,Et,at),at.features.length?at:null},k.prototype.getClusterExpansionZoom=function(ee){for(var me=this._getOriginZoom(ee)-1;me<=this.options.maxZoom;){var ge=this.getChildren(ee);if(me++,ge.length!==1)break;ee=ge[0].properties.cluster_id}return me},k.prototype._appendLeaves=function(ee,me,ge,fe,Et){for(var xe=this.getChildren(me),je=0,ue=xe;je<ue.length;je+=1){var Pe=ue[je],we=Pe.properties;if(we&&we.cluster?Et+we.point_count<=fe?Et+=we.point_count:Et=this._appendLeaves(ee,we.cluster_id,ge,fe,Et):Et<fe?Et++:ee.push(Pe),ee.length===ge)break}return Et},k.prototype._addTileFeatures=function(ee,me,ge,fe,Et,xe){for(var je=0,ue=ee;je<ue.length;je+=1){var Pe=ue[je],we=me[Pe],nt=we.numPoints,at=void 0,vt=void 0,Tt=void 0;if(nt)at=J(we),vt=we.x,Tt=we.y;else{var ze=this.points[we.index];at=ze.properties,vt=H(ze.geometry.coordinates[0]),Tt=ve(ze.geometry.coordinates[1])}var gr={type:1,geometry:[[Math.round(this.options.extent*(vt*Et-ge)),Math.round(this.options.extent*(Tt*Et-fe))]],tags:at},At=void 0;nt?At=we.id:this.options.generateId?At=we.index:this.points[we.index].id&&(At=this.points[we.index].id),At!==void 0&&(gr.id=At),xe.features.push(gr)}},k.prototype._limitZoom=function(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))},k.prototype._cluster=function(ee,me){for(var ge=[],fe=this.options,Et=fe.radius,xe=fe.extent,je=fe.reduce,ue=fe.minPoints,Pe=Et/(xe*Math.pow(2,me)),we=0;we<ee.length;we++){var nt=ee[we];if(!(nt.zoom<=me)){nt.zoom=me;for(var at=this.trees[me+1],vt=at.within(nt.x,nt.y,Pe),Tt=nt.numPoints||1,ze=Tt,gr=0,At=vt;gr<At.length;gr+=1){var hn=At[gr],Wr=at.points[hn];Wr.zoom>me&&(ze+=Wr.numPoints||1)}if(ze>Tt&&ze>=ue){for(var vr=nt.x*Tt,dn=nt.y*Tt,tn=je&&Tt>1?this._map(nt,!0):null,un=(we<<5)+(me+1)+this.points.length,yn=0,Vt=vt;yn<Vt.length;yn+=1){var dr=Vt[yn],wt=at.points[dr];if(!(wt.zoom<=me)){wt.zoom=me;var He=wt.numPoints||1;vr+=wt.x*He,dn+=wt.y*He,wt.parentId=un,je&&(tn||(tn=this._map(nt,!0)),je(tn,this._map(wt)))}}nt.parentId=un,ge.push(K(vr/ze,dn/ze,un,ze,tn))}else if(ge.push(nt),ze>1)for(var wr=0,Ne=vt;wr<Ne.length;wr+=1){var Xr=Ne[wr],Er=at.points[Xr];Er.zoom<=me||(Er.zoom=me,ge.push(Er))}}}return ge},k.prototype._getOriginId=function(ee){return ee-this.points.length>>5},k.prototype._getOriginZoom=function(ee){return(ee-this.points.length)%32},k.prototype._map=function(ee,me){if(ee.numPoints)return me?Ve({},ee.properties):ee.properties;var ge=this.points[ee.index].properties,fe=this.options.map(ge);return me&&fe===ge?Ve({},fe):fe};function K(ae,ee,me,ge,fe){return{x:Q(ae),y:Q(ee),zoom:1/0,id:me,parentId:-1,numPoints:ge,properties:fe}}function U(ae,ee){var me=ae.geometry.coordinates,ge=me[0],fe=me[1];return{x:Q(H(ge)),y:Q(ve(fe)),zoom:1/0,index:ee,parentId:-1}}function Z(ae){return{type:"Feature",id:ae.id,properties:J(ae),geometry:{type:"Point",coordinates:[Te(ae.x),ye(ae.y)]}}}function J(ae){var ee=ae.numPoints,me=ee>=1e4?Math.round(ee/1e3)+"k":ee>=1e3?Math.round(ee/100)/10+"k":ee;return Ve(Ve({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:ee,point_count_abbreviated:me})}function H(ae){return ae/360+.5}function ve(ae){var ee=Math.sin(ae*Math.PI/180),me=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return me<0?0:me>1?1:me}function Te(ae){return(ae-.5)*360}function ye(ae){var ee=(180-ae*360)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Ve(ae,ee){for(var me in ee)ae[me]=ee[me];return ae}function Re(ae){return ae.x}function Ae(ae){return ae.y}return k})},73897:function(Ze){function E(_,D){(D==null||D>_.length)&&(D=_.length);for(var N=0,h=new Array(D);N<D;N++)h[N]=_[N];return h}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},85372:function(Ze){function E(_){if(Array.isArray(_))return _}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},63405:function(Ze,E,_){var D=_(73897);function N(h){if(Array.isArray(h))return D(h)}Ze.exports=N,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},66115:function(Ze){function E(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},76976:function(Ze,E,_){var D=_(73808),N=_(69617),h=_(94993);function O(C,P,F){return P=D(P),h(C,N()?Reflect.construct(P,F||[],D(C).constructor):P.apply(C,F))}Ze.exports=O,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},56690:function(Ze){function E(_,D){if(!(_ instanceof D))throw new TypeError("Cannot call a class as a function")}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},89728:function(Ze,E,_){var D=_(64062);function N(O,C){for(var P=0;P<C.length;P++){var F=C[P];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(O,D(F.key),F)}}function h(O,C,P){return C&&N(O.prototype,C),P&&N(O,P),Object.defineProperty(O,"prototype",{writable:!1}),O}Ze.exports=h,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},73808:function(Ze){function E(_){return Ze.exports=E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports,E(_)}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},61655:function(Ze,E,_){var D=_(6015);function N(h,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(O&&O.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),Object.defineProperty(h,"prototype",{writable:!1}),O&&D(h,O)}Ze.exports=N,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},75263:function(Ze,E,_){var D=_(18698).default;function N(O){if(typeof WeakMap!="function")return null;var C=new WeakMap,P=new WeakMap;return(N=function(Y){return Y?P:C})(O)}function h(O,C){if(!C&&O&&O.__esModule)return O;if(O===null||D(O)!="object"&&typeof O!="function")return{default:O};var P=N(C);if(P&&P.has(O))return P.get(O);var F={__proto__:null},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in O)if(V!=="default"&&Object.prototype.hasOwnProperty.call(O,V)){var Q=Y?Object.getOwnPropertyDescriptor(O,V):null;Q&&(Q.get||Q.set)?Object.defineProperty(F,V,Q):F[V]=O[V]}return F.default=O,P&&P.set(O,F),F}Ze.exports=h,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},69617:function(Ze){function E(){try{var _=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(D){}return(Ze.exports=E=function(){return!!_},Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports)()}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},79498:function(Ze){function E(_){if(typeof Symbol!="undefined"&&_[Symbol.iterator]!=null||_["@@iterator"]!=null)return Array.from(_)}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},68872:function(Ze){function E(_,D){var N=_==null?null:typeof Symbol!="undefined"&&_[Symbol.iterator]||_["@@iterator"];if(N!=null){var h,O,C,P,F=[],Y=!0,V=!1;try{if(C=(N=N.call(_)).next,D===0){if(Object(N)!==N)return;Y=!1}else for(;!(Y=(h=C.call(N)).done)&&(F.push(h.value),F.length!==D);Y=!0);}catch(Q){V=!0,O=Q}finally{try{if(!Y&&N.return!=null&&(P=N.return(),Object(P)!==P))return}finally{if(V)throw O}}return F}}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},12218:function(Ze){function E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},42281:function(Ze){function E(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},94993:function(Ze,E,_){var D=_(18698).default,N=_(66115);function h(O,C){if(C&&(D(C)==="object"||typeof C=="function"))return C;if(C!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N(O)}Ze.exports=h,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},17061:function(Ze,E,_){var D=_(18698).default;function N(){"use strict";Ze.exports=N=function(){return O},Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports;var h,O={},C=Object.prototype,P=C.hasOwnProperty,F=Object.defineProperty||function(at,vt,Tt){at[vt]=Tt.value},Y=typeof Symbol=="function"?Symbol:{},V=Y.iterator||"@@iterator",Q=Y.asyncIterator||"@@asyncIterator",k=Y.toStringTag||"@@toStringTag";function K(at,vt,Tt){return Object.defineProperty(at,vt,{value:Tt,enumerable:!0,configurable:!0,writable:!0}),at[vt]}try{K({},"")}catch(at){K=function(Tt,ze,gr){return Tt[ze]=gr}}function U(at,vt,Tt,ze){var gr=vt&&vt.prototype instanceof Ve?vt:Ve,At=Object.create(gr.prototype),hn=new we(ze||[]);return F(At,"_invoke",{value:xe(at,Tt,hn)}),At}function Z(at,vt,Tt){try{return{type:"normal",arg:at.call(vt,Tt)}}catch(ze){return{type:"throw",arg:ze}}}O.wrap=U;var J="suspendedStart",H="suspendedYield",ve="executing",Te="completed",ye={};function Ve(){}function Re(){}function Ae(){}var ae={};K(ae,V,function(){return this});var ee=Object.getPrototypeOf,me=ee&&ee(ee(nt([])));me&&me!==C&&P.call(me,V)&&(ae=me);var ge=Ae.prototype=Ve.prototype=Object.create(ae);function fe(at){["next","throw","return"].forEach(function(vt){K(at,vt,function(Tt){return this._invoke(vt,Tt)})})}function Et(at,vt){function Tt(gr,At,hn,Wr){var vr=Z(at[gr],at,At);if(vr.type!=="throw"){var dn=vr.arg,tn=dn.value;return tn&&D(tn)=="object"&&P.call(tn,"__await")?vt.resolve(tn.__await).then(function(un){Tt("next",un,hn,Wr)},function(un){Tt("throw",un,hn,Wr)}):vt.resolve(tn).then(function(un){dn.value=un,hn(dn)},function(un){return Tt("throw",un,hn,Wr)})}Wr(vr.arg)}var ze;F(this,"_invoke",{value:function(At,hn){function Wr(){return new vt(function(vr,dn){Tt(At,hn,vr,dn)})}return ze=ze?ze.then(Wr,Wr):Wr()}})}function xe(at,vt,Tt){var ze=J;return function(gr,At){if(ze===ve)throw new Error("Generator is already running");if(ze===Te){if(gr==="throw")throw At;return{value:h,done:!0}}for(Tt.method=gr,Tt.arg=At;;){var hn=Tt.delegate;if(hn){var Wr=je(hn,Tt);if(Wr){if(Wr===ye)continue;return Wr}}if(Tt.method==="next")Tt.sent=Tt._sent=Tt.arg;else if(Tt.method==="throw"){if(ze===J)throw ze=Te,Tt.arg;Tt.dispatchException(Tt.arg)}else Tt.method==="return"&&Tt.abrupt("return",Tt.arg);ze=ve;var vr=Z(at,vt,Tt);if(vr.type==="normal"){if(ze=Tt.done?Te:H,vr.arg===ye)continue;return{value:vr.arg,done:Tt.done}}vr.type==="throw"&&(ze=Te,Tt.method="throw",Tt.arg=vr.arg)}}}function je(at,vt){var Tt=vt.method,ze=at.iterator[Tt];if(ze===h)return vt.delegate=null,Tt==="throw"&&at.iterator.return&&(vt.method="return",vt.arg=h,je(at,vt),vt.method==="throw")||Tt!=="return"&&(vt.method="throw",vt.arg=new TypeError("The iterator does not provide a '"+Tt+"' method")),ye;var gr=Z(ze,at.iterator,vt.arg);if(gr.type==="throw")return vt.method="throw",vt.arg=gr.arg,vt.delegate=null,ye;var At=gr.arg;return At?At.done?(vt[at.resultName]=At.value,vt.next=at.nextLoc,vt.method!=="return"&&(vt.method="next",vt.arg=h),vt.delegate=null,ye):At:(vt.method="throw",vt.arg=new TypeError("iterator result is not an object"),vt.delegate=null,ye)}function ue(at){var vt={tryLoc:at[0]};1 in at&&(vt.catchLoc=at[1]),2 in at&&(vt.finallyLoc=at[2],vt.afterLoc=at[3]),this.tryEntries.push(vt)}function Pe(at){var vt=at.completion||{};vt.type="normal",delete vt.arg,at.completion=vt}function we(at){this.tryEntries=[{tryLoc:"root"}],at.forEach(ue,this),this.reset(!0)}function nt(at){if(at||at===""){var vt=at[V];if(vt)return vt.call(at);if(typeof at.next=="function")return at;if(!isNaN(at.length)){var Tt=-1,ze=function gr(){for(;++Tt<at.length;)if(P.call(at,Tt))return gr.value=at[Tt],gr.done=!1,gr;return gr.value=h,gr.done=!0,gr};return ze.next=ze}}throw new TypeError(D(at)+" is not iterable")}return Re.prototype=Ae,F(ge,"constructor",{value:Ae,configurable:!0}),F(Ae,"constructor",{value:Re,configurable:!0}),Re.displayName=K(Ae,k,"GeneratorFunction"),O.isGeneratorFunction=function(at){var vt=typeof at=="function"&&at.constructor;return!!vt&&(vt===Re||(vt.displayName||vt.name)==="GeneratorFunction")},O.mark=function(at){return Object.setPrototypeOf?Object.setPrototypeOf(at,Ae):(at.__proto__=Ae,K(at,k,"GeneratorFunction")),at.prototype=Object.create(ge),at},O.awrap=function(at){return{__await:at}},fe(Et.prototype),K(Et.prototype,Q,function(){return this}),O.AsyncIterator=Et,O.async=function(at,vt,Tt,ze,gr){gr===void 0&&(gr=Promise);var At=new Et(U(at,vt,Tt,ze),gr);return O.isGeneratorFunction(vt)?At:At.next().then(function(hn){return hn.done?hn.value:At.next()})},fe(ge),K(ge,k,"Generator"),K(ge,V,function(){return this}),K(ge,"toString",function(){return"[object Generator]"}),O.keys=function(at){var vt=Object(at),Tt=[];for(var ze in vt)Tt.push(ze);return Tt.reverse(),function gr(){for(;Tt.length;){var At=Tt.pop();if(At in vt)return gr.value=At,gr.done=!1,gr}return gr.done=!0,gr}},O.values=nt,we.prototype={constructor:we,reset:function(vt){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(Pe),!vt)for(var Tt in this)Tt.charAt(0)==="t"&&P.call(this,Tt)&&!isNaN(+Tt.slice(1))&&(this[Tt]=h)},stop:function(){this.done=!0;var vt=this.tryEntries[0].completion;if(vt.type==="throw")throw vt.arg;return this.rval},dispatchException:function(vt){if(this.done)throw vt;var Tt=this;function ze(dn,tn){return hn.type="throw",hn.arg=vt,Tt.next=dn,tn&&(Tt.method="next",Tt.arg=h),!!tn}for(var gr=this.tryEntries.length-1;gr>=0;--gr){var At=this.tryEntries[gr],hn=At.completion;if(At.tryLoc==="root")return ze("end");if(At.tryLoc<=this.prev){var Wr=P.call(At,"catchLoc"),vr=P.call(At,"finallyLoc");if(Wr&&vr){if(this.prev<At.catchLoc)return ze(At.catchLoc,!0);if(this.prev<At.finallyLoc)return ze(At.finallyLoc)}else if(Wr){if(this.prev<At.catchLoc)return ze(At.catchLoc,!0)}else{if(!vr)throw new Error("try statement without catch or finally");if(this.prev<At.finallyLoc)return ze(At.finallyLoc)}}}},abrupt:function(vt,Tt){for(var ze=this.tryEntries.length-1;ze>=0;--ze){var gr=this.tryEntries[ze];if(gr.tryLoc<=this.prev&&P.call(gr,"finallyLoc")&&this.prev<gr.finallyLoc){var At=gr;break}}At&&(vt==="break"||vt==="continue")&&At.tryLoc<=Tt&&Tt<=At.finallyLoc&&(At=null);var hn=At?At.completion:{};return hn.type=vt,hn.arg=Tt,At?(this.method="next",this.next=At.finallyLoc,ye):this.complete(hn)},complete:function(vt,Tt){if(vt.type==="throw")throw vt.arg;return vt.type==="break"||vt.type==="continue"?this.next=vt.arg:vt.type==="return"?(this.rval=this.arg=vt.arg,this.method="return",this.next="end"):vt.type==="normal"&&Tt&&(this.next=Tt),ye},finish:function(vt){for(var Tt=this.tryEntries.length-1;Tt>=0;--Tt){var ze=this.tryEntries[Tt];if(ze.finallyLoc===vt)return this.complete(ze.completion,ze.afterLoc),Pe(ze),ye}},catch:function(vt){for(var Tt=this.tryEntries.length-1;Tt>=0;--Tt){var ze=this.tryEntries[Tt];if(ze.tryLoc===vt){var gr=ze.completion;if(gr.type==="throw"){var At=gr.arg;Pe(ze)}return At}}throw new Error("illegal catch attempt")},delegateYield:function(vt,Tt,ze){return this.delegate={iterator:nt(vt),resultName:Tt,nextLoc:ze},this.method==="next"&&(this.arg=h),ye}},O}Ze.exports=N,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},6015:function(Ze){function E(_,D){return Ze.exports=E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,O){return h.__proto__=O,h},Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports,E(_,D)}Ze.exports=E,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},27424:function(Ze,E,_){var D=_(85372),N=_(68872),h=_(86116),O=_(12218);function C(P,F){return D(P)||N(P,F)||h(P,F)||O()}Ze.exports=C,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},51589:function(Ze,E,_){var D=_(85372),N=_(79498),h=_(86116),O=_(12218);function C(P){return D(P)||N(P)||h(P)||O()}Ze.exports=C,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},861:function(Ze,E,_){var D=_(63405),N=_(79498),h=_(86116),O=_(42281);function C(P){return D(P)||N(P)||h(P)||O()}Ze.exports=C,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},86116:function(Ze,E,_){var D=_(73897);function N(h,O){if(h){if(typeof h=="string")return D(h,O);var C=Object.prototype.toString.call(h).slice(8,-1);if(C==="Object"&&h.constructor&&(C=h.constructor.name),C==="Map"||C==="Set")return Array.from(h);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return D(h,O)}}Ze.exports=N,Ze.exports.__esModule=!0,Ze.exports.default=Ze.exports},64687:function(Ze,E,_){var D=_(17061)();Ze.exports=D;try{regeneratorRuntime=D}catch(N){typeof globalThis=="object"?globalThis.regeneratorRuntime=D:Function("r","regeneratorRuntime = r")(D)}},8520:function(Ze,E,_){var D;(function(N){(function(h){var O=typeof globalThis=="object"?globalThis:typeof _.g=="object"?_.g:typeof self=="object"?self:typeof this=="object"?this:V(),C=P(N);typeof O.Reflect!="undefined"&&(C=P(O.Reflect,C)),h(C,O),typeof O.Reflect=="undefined"&&(O.Reflect=N);function P(Q,k){return function(K,U){Object.defineProperty(Q,K,{configurable:!0,writable:!0,value:U}),k&&k(K,U)}}function F(){try{return Function("return this;")()}catch(Q){}}function Y(){try{return(0,eval)("(function() { return this; })()")}catch(Q){}}function V(){return F()||Y()}})(function(h,O){var C=Object.prototype.hasOwnProperty,P=typeof Symbol=="function",F=P&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",Y=P&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",V=typeof Object.create=="function",Q={__proto__:[]}instanceof Array,k=!V&&!Q,K={create:V?function(){return Wn(Object.create(null))}:Q?function(){return Wn({__proto__:null})}:function(){return Wn({})},has:k?function(De,X){return C.call(De,X)}:function(De,X){return X in De},get:k?function(De,X){return C.call(De,X)?De[X]:void 0}:function(De,X){return De[X]}},U=Object.getPrototypeOf(Function),Z=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Zr(),J=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Kr(),H=typeof WeakMap=="function"?WeakMap:en(),ve=P?Symbol.for("@reflect-metadata:registry"):void 0,Te=On(),ye=ri(Te);function Ve(De,X,se,Be){if(At(se)){if(!dr(De))throw new TypeError;if(!He(X))throw new TypeError;return je(De,X)}else{if(!dr(De))throw new TypeError;if(!vr(X))throw new TypeError;if(!vr(Be)&&!At(Be)&&!hn(Be))throw new TypeError;return hn(Be)&&(Be=void 0),se=Vt(se),ue(De,X,se,Be)}}h("decorate",Ve);function Re(De,X){function se(Be,Ye){if(!vr(Be))throw new TypeError;if(!At(Ye)&&!wr(Ye))throw new TypeError;vt(De,X,Be,Ye)}return se}h("metadata",Re);function Ae(De,X,se,Be){if(!vr(se))throw new TypeError;return At(Be)||(Be=Vt(Be)),vt(De,X,se,Be)}h("defineMetadata",Ae);function ae(De,X,se){if(!vr(X))throw new TypeError;return At(se)||(se=Vt(se)),Pe(De,X,se)}h("hasMetadata",ae);function ee(De,X,se){if(!vr(X))throw new TypeError;return At(se)||(se=Vt(se)),we(De,X,se)}h("hasOwnMetadata",ee);function me(De,X,se){if(!vr(X))throw new TypeError;return At(se)||(se=Vt(se)),nt(De,X,se)}h("getMetadata",me);function ge(De,X,se){if(!vr(X))throw new TypeError;return At(se)||(se=Vt(se)),at(De,X,se)}h("getOwnMetadata",ge);function fe(De,X){if(!vr(De))throw new TypeError;return At(X)||(X=Vt(X)),Tt(De,X)}h("getMetadataKeys",fe);function Et(De,X){if(!vr(De))throw new TypeError;return At(X)||(X=Vt(X)),ze(De,X)}h("getOwnMetadataKeys",Et);function xe(De,X,se){if(!vr(X))throw new TypeError;if(At(se)||(se=Vt(se)),!vr(X))throw new TypeError;At(se)||(se=Vt(se));var Be=cr(X,se,!1);return At(Be)?!1:Be.OrdinaryDeleteMetadata(De,X,se)}h("deleteMetadata",xe);function je(De,X){for(var se=De.length-1;se>=0;--se){var Be=De[se],Ye=Be(X);if(!At(Ye)&&!hn(Ye)){if(!He(Ye))throw new TypeError;X=Ye}}return X}function ue(De,X,se,Be){for(var Ye=De.length-1;Ye>=0;--Ye){var ct=De[Ye],sr=ct(X,se,Be);if(!At(sr)&&!hn(sr)){if(!vr(sr))throw new TypeError;Be=sr}}return Be}function Pe(De,X,se){var Be=we(De,X,se);if(Be)return!0;var Ye=Qr(X);return hn(Ye)?!1:Pe(De,Ye,se)}function we(De,X,se){var Be=cr(X,se,!1);return At(Be)?!1:un(Be.OrdinaryHasOwnMetadata(De,X,se))}function nt(De,X,se){var Be=we(De,X,se);if(Be)return at(De,X,se);var Ye=Qr(X);if(!hn(Ye))return nt(De,Ye,se)}function at(De,X,se){var Be=cr(X,se,!1);if(!At(Be))return Be.OrdinaryGetOwnMetadata(De,X,se)}function vt(De,X,se,Be){var Ye=cr(se,Be,!0);Ye.OrdinaryDefineOwnMetadata(De,X,se,Be)}function Tt(De,X){var se=ze(De,X),Be=Qr(De);if(Be===null)return se;var Ye=Tt(Be,X);if(Ye.length<=0)return se;if(se.length<=0)return Ye;for(var ct=new J,sr=[],ar=0,or=se;ar<or.length;ar++){var Wt=or[ar],oe=ct.has(Wt);oe||(ct.add(Wt),sr.push(Wt))}for(var ie=0,be=Ye;ie<be.length;ie++){var Wt=be[ie],oe=ct.has(Wt);oe||(ct.add(Wt),sr.push(Wt))}return sr}function ze(De,X){var se=cr(De,X,!1);return se?se.OrdinaryOwnMetadataKeys(De,X):[]}function gr(De){if(De===null)return 1;switch(typeof De){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return De===null?1:6;default:return 6}}function At(De){return De===void 0}function hn(De){return De===null}function Wr(De){return typeof De=="symbol"}function vr(De){return typeof De=="object"?De!==null:typeof De=="function"}function dn(De,X){switch(gr(De)){case 0:return De;case 1:return De;case 2:return De;case 3:return De;case 4:return De;case 5:return De}var se=X===3?"string":X===5?"number":"default",Be=Xr(De,F);if(Be!==void 0){var Ye=Be.call(De,se);if(vr(Ye))throw new TypeError;return Ye}return tn(De,se==="default"?"number":se)}function tn(De,X){if(X==="string"){var se=De.toString;if(wt(se)){var Be=se.call(De);if(!vr(Be))return Be}var Ye=De.valueOf;if(wt(Ye)){var Be=Ye.call(De);if(!vr(Be))return Be}}else{var Ye=De.valueOf;if(wt(Ye)){var Be=Ye.call(De);if(!vr(Be))return Be}var ct=De.toString;if(wt(ct)){var Be=ct.call(De);if(!vr(Be))return Be}}throw new TypeError}function un(De){return!!De}function yn(De){return""+De}function Vt(De){var X=dn(De,3);return Wr(X)?X:yn(X)}function dr(De){return Array.isArray?Array.isArray(De):De instanceof Object?De instanceof Array:Object.prototype.toString.call(De)==="[object Array]"}function wt(De){return typeof De=="function"}function He(De){return typeof De=="function"}function wr(De){switch(gr(De)){case 3:return!0;case 4:return!0;default:return!1}}function Ne(De,X){return De===X||De!==De&&X!==X}function Xr(De,X){var se=De[X];if(se!=null){if(!wt(se))throw new TypeError;return se}}function Er(De){var X=Xr(De,Y);if(!wt(X))throw new TypeError;var se=X.call(De);if(!vr(se))throw new TypeError;return se}function Ue(De){return De.value}function In(De){var X=De.next();return X.done?!1:X}function an(De){var X=De.return;X&&X.call(De)}function Qr(De){var X=Object.getPrototypeOf(De);if(typeof De!="function"||De===U||X!==U)return X;var se=De.prototype,Be=se&&Object.getPrototypeOf(se);if(Be==null||Be===Object.prototype)return X;var Ye=Be.constructor;return typeof Ye!="function"||Ye===De?X:Ye}function Dn(){var De;!At(ve)&&typeof O.Reflect!="undefined"&&!(ve in O.Reflect)&&typeof O.Reflect.defineMetadata=="function"&&(De=zt(O.Reflect));var X,se,Be,Ye=new H,ct={registerProvider:sr,getProvider:or,setProvider:oe};return ct;function sr(ie){if(!Object.isExtensible(ct))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case De===ie:break;case At(X):X=ie;break;case X===ie:break;case At(se):se=ie;break;case se===ie:break;default:Be===void 0&&(Be=new J),Be.add(ie);break}}function ar(ie,be){if(!At(X)){if(X.isProviderFor(ie,be))return X;if(!At(se)){if(se.isProviderFor(ie,be))return X;if(!At(Be))for(var ke=Er(Be);;){var qe=In(ke);if(!qe)return;var mt=Ue(qe);if(mt.isProviderFor(ie,be))return an(ke),mt}}}if(!At(De)&&De.isProviderFor(ie,be))return De}function or(ie,be){var ke=Ye.get(ie),qe;return At(ke)||(qe=ke.get(be)),At(qe)&&(qe=ar(ie,be),At(qe)||(At(ke)&&(ke=new Z,Ye.set(ie,ke)),ke.set(be,qe))),qe}function Wt(ie){if(At(ie))throw new TypeError;return X===ie||se===ie||!At(Be)&&Be.has(ie)}function oe(ie,be,ke){if(!Wt(ke))throw new Error("Metadata provider not registered.");var qe=or(ie,be);if(qe!==ke){if(!At(qe))return!1;var mt=Ye.get(ie);At(mt)&&(mt=new Z,Ye.set(ie,mt)),mt.set(be,ke)}return!0}}function On(){var De;return!At(ve)&&vr(O.Reflect)&&Object.isExtensible(O.Reflect)&&(De=O.Reflect[ve]),At(De)&&(De=Dn()),!At(ve)&&vr(O.Reflect)&&Object.isExtensible(O.Reflect)&&Object.defineProperty(O.Reflect,ve,{enumerable:!1,configurable:!1,writable:!1,value:De}),De}function ri(De){var X=new H,se={isProviderFor:function(Wt,oe){var ie=X.get(Wt);return At(ie)?!1:ie.has(oe)},OrdinaryDefineOwnMetadata:sr,OrdinaryHasOwnMetadata:Ye,OrdinaryGetOwnMetadata:ct,OrdinaryOwnMetadataKeys:ar,OrdinaryDeleteMetadata:or};return Te.registerProvider(se),se;function Be(Wt,oe,ie){var be=X.get(Wt),ke=!1;if(At(be)){if(!ie)return;be=new Z,X.set(Wt,be),ke=!0}var qe=be.get(oe);if(At(qe)){if(!ie)return;if(qe=new Z,be.set(oe,qe),!De.setProvider(Wt,oe,se))throw be.delete(oe),ke&&X.delete(Wt),new Error("Wrong provider for target.")}return qe}function Ye(Wt,oe,ie){var be=Be(oe,ie,!1);return At(be)?!1:un(be.has(Wt))}function ct(Wt,oe,ie){var be=Be(oe,ie,!1);if(!At(be))return be.get(Wt)}function sr(Wt,oe,ie,be){var ke=Be(ie,be,!0);ke.set(Wt,oe)}function ar(Wt,oe){var ie=[],be=Be(Wt,oe,!1);if(At(be))return ie;for(var ke=be.keys(),qe=Er(ke),mt=0;;){var kt=In(qe);if(!kt)return ie.length=mt,ie;var $e=Ue(kt);try{ie[mt]=$e}catch(Ge){try{an(qe)}finally{throw Ge}}mt++}}function or(Wt,oe,ie){var be=Be(oe,ie,!1);if(At(be)||!be.delete(Wt))return!1;if(be.size===0){var ke=X.get(oe);At(ke)||(ke.delete(ie),ke.size===0&&X.delete(ke))}return!0}}function zt(De){var X=De.defineMetadata,se=De.hasOwnMetadata,Be=De.getOwnMetadata,Ye=De.getOwnMetadataKeys,ct=De.deleteMetadata,sr=new H,ar={isProviderFor:function(or,Wt){var oe=sr.get(or);return At(oe)?Ye(or,Wt).length?(At(oe)&&(oe=new J,sr.set(or,oe)),oe.add(Wt),!0):!1:oe.has(Wt)},OrdinaryDefineOwnMetadata:X,OrdinaryHasOwnMetadata:se,OrdinaryGetOwnMetadata:Be,OrdinaryOwnMetadataKeys:Ye,OrdinaryDeleteMetadata:ct};return ar}function cr(De,X,se){var Be=Te.getProvider(De,X);if(!At(Be))return Be;if(se){if(Te.setProvider(De,X,ye))return ye;throw new Error("Illegal state.")}}function Zr(){var De={},X=[],se=function(){function ar(or,Wt,oe){this._index=0,this._keys=or,this._values=Wt,this._selector=oe}return ar.prototype["@@iterator"]=function(){return this},ar.prototype[Y]=function(){return this},ar.prototype.next=function(){var or=this._index;if(or>=0&&or<this._keys.length){var Wt=this._selector(this._keys[or],this._values[or]);return or+1>=this._keys.length?(this._index=-1,this._keys=X,this._values=X):this._index++,{value:Wt,done:!1}}return{value:void 0,done:!0}},ar.prototype.throw=function(or){throw this._index>=0&&(this._index=-1,this._keys=X,this._values=X),or},ar.prototype.return=function(or){return this._index>=0&&(this._index=-1,this._keys=X,this._values=X),{value:or,done:!0}},ar}(),Be=function(){function ar(){this._keys=[],this._values=[],this._cacheKey=De,this._cacheIndex=-2}return Object.defineProperty(ar.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),ar.prototype.has=function(or){return this._find(or,!1)>=0},ar.prototype.get=function(or){var Wt=this._find(or,!1);return Wt>=0?this._values[Wt]:void 0},ar.prototype.set=function(or,Wt){var oe=this._find(or,!0);return this._values[oe]=Wt,this},ar.prototype.delete=function(or){var Wt=this._find(or,!1);if(Wt>=0){for(var oe=this._keys.length,ie=Wt+1;ie<oe;ie++)this._keys[ie-1]=this._keys[ie],this._values[ie-1]=this._values[ie];return this._keys.length--,this._values.length--,Ne(or,this._cacheKey)&&(this._cacheKey=De,this._cacheIndex=-2),!0}return!1},ar.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=De,this._cacheIndex=-2},ar.prototype.keys=function(){return new se(this._keys,this._values,Ye)},ar.prototype.values=function(){return new se(this._keys,this._values,ct)},ar.prototype.entries=function(){return new se(this._keys,this._values,sr)},ar.prototype["@@iterator"]=function(){return this.entries()},ar.prototype[Y]=function(){return this.entries()},ar.prototype._find=function(or,Wt){if(!Ne(this._cacheKey,or)){this._cacheIndex=-1;for(var oe=0;oe<this._keys.length;oe++)if(Ne(this._keys[oe],or)){this._cacheIndex=oe;break}}return this._cacheIndex<0&&Wt&&(this._cacheIndex=this._keys.length,this._keys.push(or),this._values.push(void 0)),this._cacheIndex},ar}();return Be;function Ye(ar,or){return ar}function ct(ar,or){return or}function sr(ar,or){return[ar,or]}}function Kr(){var De=function(){function X(){this._map=new Z}return Object.defineProperty(X.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),X.prototype.has=function(se){return this._map.has(se)},X.prototype.add=function(se){return this._map.set(se,se),this},X.prototype.delete=function(se){return this._map.delete(se)},X.prototype.clear=function(){this._map.clear()},X.prototype.keys=function(){return this._map.keys()},X.prototype.values=function(){return this._map.keys()},X.prototype.entries=function(){return this._map.entries()},X.prototype["@@iterator"]=function(){return this.keys()},X.prototype[Y]=function(){return this.keys()},X}();return De}function en(){var De=16,X=K.create(),se=Be();return function(){function or(){this._key=Be()}return or.prototype.has=function(Wt){var oe=Ye(Wt,!1);return oe!==void 0?K.has(oe,this._key):!1},or.prototype.get=function(Wt){var oe=Ye(Wt,!1);return oe!==void 0?K.get(oe,this._key):void 0},or.prototype.set=function(Wt,oe){var ie=Ye(Wt,!0);return ie[this._key]=oe,this},or.prototype.delete=function(Wt){var oe=Ye(Wt,!1);return oe!==void 0?delete oe[this._key]:!1},or.prototype.clear=function(){this._key=Be()},or}();function Be(){var or;do or="@@WeakMap@@"+ar();while(K.has(X,or));return X[or]=!0,or}function Ye(or,Wt){if(!C.call(or,se)){if(!Wt)return;Object.defineProperty(or,se,{value:K.create()})}return or[se]}function ct(or,Wt){for(var oe=0;oe<Wt;++oe)or[oe]=Math.random()*255|0;return or}function sr(or){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(or)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(or)):ct(new Uint8Array(or),or):ct(new Array(or),or)}function ar(){var or=sr(De);or[6]=or[6]&79|64,or[8]=or[8]&191|128;for(var Wt="",oe=0;oe<De;++oe){var ie=or[oe];(oe===4||oe===6||oe===8)&&(Wt+="-"),ie<16&&(Wt+="0"),Wt+=ie.toString(16).toLowerCase()}return Wt}}function Wn(De){return De.__=void 0,delete De.__,De}})})(D||(D={}))},53229:function(Ze,E,_){"use strict";_.d(E,{Z:function(){return D}});function D(N,h,O,C,P){var F={};return Object.keys(C).forEach(function(Y){F[Y]=C[Y]}),F.enumerable=!!F.enumerable,F.configurable=!!F.configurable,("value"in F||F.initializer)&&(F.writable=!0),F=O.slice().reverse().reduce(function(Y,V){return V(N,h,Y)||Y},F),P&&F.initializer!==void 0&&(F.value=F.initializer?F.initializer.call(P):void 0,F.initializer=void 0),F.initializer===void 0&&(Object.defineProperty(N,h,F),F=null),F}},73237:function(Ze,E,_){"use strict";_.d(E,{Z:function(){return h}});var D=_(61120);function N(O,C){for(;!Object.prototype.hasOwnProperty.call(O,C)&&(O=(0,D.Z)(O),O!==null););return O}function h(){return typeof Reflect!="undefined"&&Reflect.get?h=Reflect.get.bind():h=function(C,P,F){var Y=N(C,P);if(Y){var V=Object.getOwnPropertyDescriptor(Y,P);return V.get?V.get.call(arguments.length<3?C:F):V.value}},h.apply(this,arguments)}},43269:function(Ze,E,_){"use strict";_.d(E,{Z:function(){return D}});function D(N,h,O,C){O&&Object.defineProperty(N,h,{enumerable:O.enumerable,configurable:O.configurable,writable:O.writable,value:O.initializer?O.initializer.call(C):void 0})}},1449:function(Ze,E,_){"use strict";_.d(E,{Tu:function(){return k},tw:function(){return H},uf:function(){return U},yu:function(){return V},zL:function(){return C}});var D=63710088e-1,N={centimeters:D*100,centimetres:D*100,degrees:D/111325,feet:D*3.28084,inches:D*39.37,kilometers:D/1e3,kilometres:D/1e3,meters:D,metres:D,miles:D/1609.344,millimeters:D*1e3,millimetres:D*1e3,nauticalmiles:D/1852,radians:1,yards:D*1.0936},h={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/D,yards:1.0936133},O={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function C(ue,Pe,we){we===void 0&&(we={});var nt={type:"Feature"};return(we.id===0||we.id)&&(nt.id=we.id),we.bbox&&(nt.bbox=we.bbox),nt.properties=Pe||{},nt.geometry=ue,nt}function P(ue,Pe,we){switch(we===void 0&&(we={}),ue){case"Point":return F(Pe).geometry;case"LineString":return k(Pe).geometry;case"Polygon":return V(Pe).geometry;case"MultiPoint":return J(Pe).geometry;case"MultiLineString":return Z(Pe).geometry;case"MultiPolygon":return H(Pe).geometry;default:throw new Error(ue+" is invalid")}}function F(ue,Pe,we){if(we===void 0&&(we={}),!ue)throw new Error("coordinates is required");if(!Array.isArray(ue))throw new Error("coordinates must be an Array");if(ue.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fe(ue[0])||!fe(ue[1]))throw new Error("coordinates must contain numbers");var nt={type:"Point",coordinates:ue};return C(nt,Pe,we)}function Y(ue,Pe,we){return we===void 0&&(we={}),U(ue.map(function(nt){return F(nt,Pe)}),we)}function V(ue,Pe,we){we===void 0&&(we={});for(var nt=0,at=ue;nt<at.length;nt++){var vt=at[nt];if(vt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Tt=0;Tt<vt[vt.length-1].length;Tt++)if(vt[vt.length-1][Tt]!==vt[0][Tt])throw new Error("First and last Position are not equivalent.")}var ze={type:"Polygon",coordinates:ue};return C(ze,Pe,we)}function Q(ue,Pe,we){return we===void 0&&(we={}),U(ue.map(function(nt){return V(nt,Pe)}),we)}function k(ue,Pe,we){if(we===void 0&&(we={}),ue.length<2)throw new Error("coordinates must be an array of two or more positions");var nt={type:"LineString",coordinates:ue};return C(nt,Pe,we)}function K(ue,Pe,we){return we===void 0&&(we={}),U(ue.map(function(nt){return k(nt,Pe)}),we)}function U(ue,Pe){Pe===void 0&&(Pe={});var we={type:"FeatureCollection"};return Pe.id&&(we.id=Pe.id),Pe.bbox&&(we.bbox=Pe.bbox),we.features=ue,we}function Z(ue,Pe,we){we===void 0&&(we={});var nt={type:"MultiLineString",coordinates:ue};return C(nt,Pe,we)}function J(ue,Pe,we){we===void 0&&(we={});var nt={type:"MultiPoint",coordinates:ue};return C(nt,Pe,we)}function H(ue,Pe,we){we===void 0&&(we={});var nt={type:"MultiPolygon",coordinates:ue};return C(nt,Pe,we)}function ve(ue,Pe,we){we===void 0&&(we={});var nt={type:"GeometryCollection",geometries:ue};return C(nt,Pe,we)}function Te(ue,Pe){if(Pe===void 0&&(Pe=0),Pe&&!(Pe>=0))throw new Error("precision must be a positive number");var we=Math.pow(10,Pe||0);return Math.round(ue*we)/we}function ye(ue,Pe){Pe===void 0&&(Pe="kilometers");var we=N[Pe];if(!we)throw new Error(Pe+" units is invalid");return ue*we}function Ve(ue,Pe){Pe===void 0&&(Pe="kilometers");var we=N[Pe];if(!we)throw new Error(Pe+" units is invalid");return ue/we}function Re(ue,Pe){return ae(Ve(ue,Pe))}function Ae(ue){var Pe=ue%360;return Pe<0&&(Pe+=360),Pe}function ae(ue){var Pe=ue%(2*Math.PI);return Pe*180/Math.PI}function ee(ue){var Pe=ue%360;return Pe*Math.PI/180}function me(ue,Pe,we){if(Pe===void 0&&(Pe="kilometers"),we===void 0&&(we="kilometers"),!(ue>=0))throw new Error("length must be a positive number");return ye(Ve(ue,Pe),we)}function ge(ue,Pe,we){if(Pe===void 0&&(Pe="meters"),we===void 0&&(we="kilometers"),!(ue>=0))throw new Error("area must be a positive number");var nt=O[Pe];if(!nt)throw new Error("invalid original units");var at=O[we];if(!at)throw new Error("invalid final units");return ue/nt*at}function fe(ue){return!isNaN(ue)&&ue!==null&&!Array.isArray(ue)}function Et(ue){return!!ue&&ue.constructor===Object}function xe(ue){if(!ue)throw new Error("bbox is required");if(!Array.isArray(ue))throw new Error("bbox must be an Array");if(ue.length!==4&&ue.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");ue.forEach(function(Pe){if(!fe(Pe))throw new Error("bbox must only contain numbers")})}function je(ue){if(!ue)throw new Error("id is required");if(["string","number"].indexOf(typeof ue)===-1)throw new Error("id must be a number or a string")}},39034:function(Ze,E,_){"use strict";_.d(E,{nG:function(){return k},pZ:function(){return N}});var D=_(1449);function N(ye,Ve,Re){if(ye!==null)for(var Ae,ae,ee,me,ge,fe,Et,xe=0,je=0,ue,Pe=ye.type,we=Pe==="FeatureCollection",nt=Pe==="Feature",at=we?ye.features.length:1,vt=0;vt<at;vt++){Et=we?ye.features[vt].geometry:nt?ye.geometry:ye,ue=Et?Et.type==="GeometryCollection":!1,ge=ue?Et.geometries.length:1;for(var Tt=0;Tt<ge;Tt++){var ze=0,gr=0;if(me=ue?Et.geometries[Tt]:Et,me!==null){fe=me.coordinates;var At=me.type;switch(xe=Re&&(At==="Polygon"||At==="MultiPolygon")?1:0,At){case null:break;case"Point":if(Ve(fe,je,vt,ze,gr)===!1)return!1;je++,ze++;break;case"LineString":case"MultiPoint":for(Ae=0;Ae<fe.length;Ae++){if(Ve(fe[Ae],je,vt,ze,gr)===!1)return!1;je++,At==="MultiPoint"&&ze++}At==="LineString"&&ze++;break;case"Polygon":case"MultiLineString":for(Ae=0;Ae<fe.length;Ae++){for(ae=0;ae<fe[Ae].length-xe;ae++){if(Ve(fe[Ae][ae],je,vt,ze,gr)===!1)return!1;je++}At==="MultiLineString"&&ze++,At==="Polygon"&&gr++}At==="Polygon"&&ze++;break;case"MultiPolygon":for(Ae=0;Ae<fe.length;Ae++){for(gr=0,ae=0;ae<fe[Ae].length;ae++){for(ee=0;ee<fe[Ae][ae].length-xe;ee++){if(Ve(fe[Ae][ae][ee],je,vt,ze,gr)===!1)return!1;je++}gr++}ze++}break;case"GeometryCollection":for(Ae=0;Ae<me.geometries.length;Ae++)if(N(me.geometries[Ae],Ve,Re)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function h(ye,Ve,Re,Ae){var ae=Re;return N(ye,function(ee,me,ge,fe,Et){me===0&&Re===void 0?ae=ee:ae=Ve(ae,ee,me,ge,fe,Et)},Ae),ae}function O(ye,Ve){var Re;switch(ye.type){case"FeatureCollection":for(Re=0;Re<ye.features.length&&Ve(ye.features[Re].properties,Re)!==!1;Re++);break;case"Feature":Ve(ye.properties,0);break}}function C(ye,Ve,Re){var Ae=Re;return O(ye,function(ae,ee){ee===0&&Re===void 0?Ae=ae:Ae=Ve(Ae,ae,ee)}),Ae}function P(ye,Ve){if(ye.type==="Feature")Ve(ye,0);else if(ye.type==="FeatureCollection")for(var Re=0;Re<ye.features.length&&Ve(ye.features[Re],Re)!==!1;Re++);}function F(ye,Ve,Re){var Ae=Re;return P(ye,function(ae,ee){ee===0&&Re===void 0?Ae=ae:Ae=Ve(Ae,ae,ee)}),Ae}function Y(ye){var Ve=[];return N(ye,function(Re){Ve.push(Re)}),Ve}function V(ye,Ve){var Re,Ae,ae,ee,me,ge,fe,Et,xe,je,ue=0,Pe=ye.type==="FeatureCollection",we=ye.type==="Feature",nt=Pe?ye.features.length:1;for(Re=0;Re<nt;Re++){for(ge=Pe?ye.features[Re].geometry:we?ye.geometry:ye,Et=Pe?ye.features[Re].properties:we?ye.properties:{},xe=Pe?ye.features[Re].bbox:we?ye.bbox:void 0,je=Pe?ye.features[Re].id:we?ye.id:void 0,fe=ge?ge.type==="GeometryCollection":!1,me=fe?ge.geometries.length:1,ae=0;ae<me;ae++){if(ee=fe?ge.geometries[ae]:ge,ee===null){if(Ve(null,ue,Et,xe,je)===!1)return!1;continue}switch(ee.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Ve(ee,ue,Et,xe,je)===!1)return!1;break}case"GeometryCollection":{for(Ae=0;Ae<ee.geometries.length;Ae++)if(Ve(ee.geometries[Ae],ue,Et,xe,je)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ue++}}function Q(ye,Ve,Re){var Ae=Re;return V(ye,function(ae,ee,me,ge,fe){ee===0&&Re===void 0?Ae=ae:Ae=Ve(Ae,ae,ee,me,ge,fe)}),Ae}function k(ye,Ve){V(ye,function(Re,Ae,ae,ee,me){var ge=Re===null?null:Re.type;switch(ge){case null:case"Point":case"LineString":case"Polygon":return Ve((0,D.zL)(Re,ae,{bbox:ee,id:me}),Ae,0)===!1?!1:void 0}var fe;switch(ge){case"MultiPoint":fe="Point";break;case"MultiLineString":fe="LineString";break;case"MultiPolygon":fe="Polygon";break}for(var Et=0;Et<Re.coordinates.length;Et++){var xe=Re.coordinates[Et],je={type:fe,coordinates:xe};if(Ve((0,D.zL)(je,ae),Ae,Et)===!1)return!1}})}function K(ye,Ve,Re){var Ae=Re;return k(ye,function(ae,ee,me){ee===0&&me===0&&Re===void 0?Ae=ae:Ae=Ve(Ae,ae,ee,me)}),Ae}function U(ye,Ve){k(ye,function(Re,Ae,ae){var ee=0;if(Re.geometry){var me=Re.geometry.type;if(!(me==="Point"||me==="MultiPoint")){var ge,fe=0,Et=0,xe=0;if(N(Re,function(je,ue,Pe,we,nt){if(ge===void 0||Ae>fe||we>Et||nt>xe){ge=je,fe=Ae,Et=we,xe=nt,ee=0;return}var at=lineString([ge,je],Re.properties);if(Ve(at,Ae,ae,nt,ee)===!1)return!1;ee++,ge=je})===!1)return!1}}})}function Z(ye,Ve,Re){var Ae=Re,ae=!1;return U(ye,function(ee,me,ge,fe,Et){ae===!1&&Re===void 0?Ae=ee:Ae=Ve(Ae,ee,me,ge,fe,Et),ae=!0}),Ae}function J(ye,Ve){if(!ye)throw new Error("geojson is required");k(ye,function(Re,Ae,ae){if(Re.geometry!==null){var ee=Re.geometry.type,me=Re.geometry.coordinates;switch(ee){case"LineString":if(Ve(Re,Ae,ae,0,0)===!1)return!1;break;case"Polygon":for(var ge=0;ge<me.length;ge++)if(Ve(lineString(me[ge],Re.properties),Ae,ae,ge)===!1)return!1;break}}})}function H(ye,Ve,Re){var Ae=Re;return J(ye,function(ae,ee,me,ge){ee===0&&Re===void 0?Ae=ae:Ae=Ve(Ae,ae,ee,me,ge)}),Ae}function ve(ye,Ve){if(Ve=Ve||{},!isObject(Ve))throw new Error("options is invalid");var Re=Ve.featureIndex||0,Ae=Ve.multiFeatureIndex||0,ae=Ve.geometryIndex||0,ee=Ve.segmentIndex||0,me=Ve.properties,ge;switch(ye.type){case"FeatureCollection":Re<0&&(Re=ye.features.length+Re),me=me||ye.features[Re].properties,ge=ye.features[Re].geometry;break;case"Feature":me=me||ye.properties,ge=ye.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ge=ye;break;default:throw new Error("geojson is invalid")}if(ge===null)return null;var fe=ge.coordinates;switch(ge.type){case"Point":case"MultiPoint":return null;case"LineString":return ee<0&&(ee=fe.length+ee-1),lineString([fe[ee],fe[ee+1]],me,Ve);case"Polygon":return ae<0&&(ae=fe.length+ae),ee<0&&(ee=fe[ae].length+ee-1),lineString([fe[ae][ee],fe[ae][ee+1]],me,Ve);case"MultiLineString":return Ae<0&&(Ae=fe.length+Ae),ee<0&&(ee=fe[Ae].length+ee-1),lineString([fe[Ae][ee],fe[Ae][ee+1]],me,Ve);case"MultiPolygon":return Ae<0&&(Ae=fe.length+Ae),ae<0&&(ae=fe[Ae].length+ae),ee<0&&(ee=fe[Ae][ae].length-ee-1),lineString([fe[Ae][ae][ee],fe[Ae][ae][ee+1]],me,Ve)}throw new Error("geojson is invalid")}function Te(ye,Ve){if(Ve=Ve||{},!isObject(Ve))throw new Error("options is invalid");var Re=Ve.featureIndex||0,Ae=Ve.multiFeatureIndex||0,ae=Ve.geometryIndex||0,ee=Ve.coordIndex||0,me=Ve.properties,ge;switch(ye.type){case"FeatureCollection":Re<0&&(Re=ye.features.length+Re),me=me||ye.features[Re].properties,ge=ye.features[Re].geometry;break;case"Feature":me=me||ye.properties,ge=ye.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ge=ye;break;default:throw new Error("geojson is invalid")}if(ge===null)return null;var fe=ge.coordinates;switch(ge.type){case"Point":return point(fe,me,Ve);case"MultiPoint":return Ae<0&&(Ae=fe.length+Ae),point(fe[Ae],me,Ve);case"LineString":return ee<0&&(ee=fe.length+ee),point(fe[ee],me,Ve);case"Polygon":return ae<0&&(ae=fe.length+ae),ee<0&&(ee=fe[ae].length+ee),point(fe[ae][ee],me,Ve);case"MultiLineString":return Ae<0&&(Ae=fe.length+Ae),ee<0&&(ee=fe[Ae].length+ee),point(fe[Ae][ee],me,Ve);case"MultiPolygon":return Ae<0&&(Ae=fe.length+Ae),ae<0&&(ae=fe[Ae].length+ae),ee<0&&(ee=fe[Ae][ae].length-ee),point(fe[Ae][ae][ee],me,Ve)}throw new Error("geojson is invalid")}}}]);
}());