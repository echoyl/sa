"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{92594:function(bt,me,t){t.r(me),t.d(me,{default:function(){return yt}});var ze=t(15009),M=t.n(ze),ke=t(99289),te=t.n(ke),we=t(97857),w=t.n(we),$e=t(5574),F=t.n($e),Ge=t(56034),ge=t(45360),pe=t(42075),Se=t(55102),xe=t(14726),We=t(75081),r=t(67294),ne=t(33067),e=t(85893),Me=function(i){var u=i.value,T=u===void 0?{}:u,g=i.onChange,C=i.reload,B=C===void 0?0:C,R=i.placeholder,D=R===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":R,L=(0,r.useState)(""),A=F()(L,2),p=A[0],H=A[1],V=(0,r.useState)(""),E=F()(V,2),$=E[0],G=E[1],W=(0,r.useState)(""),y=F()(W,2),S=y[0],N=y[1],X=(0,r.useState)(!1),z=F()(X,2),K=z[0],k=z[1],v=function(){var O=te()(M()().mark(function n(){var I;return M()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,(0,ne.xx)({key:$});case 3:if(I=x.sent,I.code!==0){x.next=6;break}return x.abrupt("return",I.data);case 6:x.next=12;break;case 8:return x.prev=8,x.t0=x.catch(0),ge.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),x.abrupt("return",[]);case 12:return ge.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),x.abrupt("return",[]);case 14:case"end":return x.stop()}},n,null,[[0,8]])}));return function(){return O.apply(this,arguments)}}(),f=function(n){g&&g(w()(w()({captchaCode:p,captchaKey:$},T),n))},h=function(n){k(!0),v().then(function(I){k(!1),G(I.key),N(I.img),n&&f({captchaKey:I.key})})};(0,r.useEffect)(function(){h(!1)},[]),(0,r.useEffect)(function(){B>0&&h(!0)},[B]);var d=function(n){var I=n.target.value||"";I&&H(I),f({captchaCode:I})},Z=function(){h(!0)};return(0,e.jsxs)(pe.Z,{children:[(0,e.jsx)(Se.Z,{prefix:(0,e.jsx)(Ge.Z,{}),size:"large",placeholder:D,onChange:d}),(0,e.jsx)(xe.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)(We.Z,{spinning:K,size:"small",children:(0,e.jsx)("img",{src:S,onClick:Z})})})]})},ce=Me,He=t(99702),Ke=t(62871),Oe=t(64182),ae=t(19179),Ue=t(74700),ye=t(87547),Ce=t(94149),Qe=t(71356),Ve=t(84517),de=t(5966),re=t(34994),Xe=t(97462),l=t(1413),ie=t(74165),Ze=t(15861),ve=t(45987),fe=t(97685),Ye=t(8232),je=t(90789),Je=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],qe=r.forwardRef(function(a,i){var u=Ye.Z.useFormInstance(),T=(0,r.useState)(a.countDown||60),g=(0,fe.Z)(T,2),C=g[0],B=g[1],R=(0,r.useState)(!1),D=(0,fe.Z)(R,2),L=D[0],A=D[1],p=(0,r.useState)(),H=(0,fe.Z)(p,2),V=H[0],E=H[1],$=a.rules,G=a.name,W=a.phoneName,y=a.fieldProps,S=a.onTiming,N=a.captchaTextRender,X=N===void 0?function(v,f){return v?"".concat(f," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:N,z=a.captchaProps,K=(0,ve.Z)(a,Je),k=function(){var v=(0,Ze.Z)((0,ie.Z)().mark(function f(h){return(0,ie.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,E(!0),Z.next=4,K.onGetCaptcha(h);case 4:E(!1),A(!0),Z.next=13;break;case 8:Z.prev=8,Z.t0=Z.catch(0),A(!1),E(!1),console.log(Z.t0);case 13:case"end":return Z.stop()}},f,null,[[0,8]])}));return function(h){return v.apply(this,arguments)}}();return(0,r.useImperativeHandle)(i,function(){return{startTiming:function(){return A(!0)},endTiming:function(){return A(!1)}}}),(0,r.useEffect)(function(){var v=0,f=a.countDown;return L&&(v=window.setInterval(function(){B(function(h){return h<=1?(A(!1),clearInterval(v),f||60):h-1})},1e3)),function(){return clearInterval(v)}},[L]),(0,r.useEffect)(function(){S&&S(C)},[C,S]),(0,e.jsxs)("div",{style:(0,l.Z)((0,l.Z)({},y==null?void 0:y.style),{},{display:"flex",alignItems:"center"}),ref:i,children:[(0,e.jsx)(Se.Z,(0,l.Z)((0,l.Z)({},y),{},{style:(0,l.Z)({flex:1,transition:"width .3s",marginRight:8},y==null?void 0:y.style)})),(0,e.jsx)(xe.ZP,(0,l.Z)((0,l.Z)({style:{display:"block"},disabled:L,loading:V},z),{},{onClick:(0,Ze.Z)((0,ie.Z)().mark(function v(){var f;return(0,ie.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,!W){d.next=9;break}return d.next=4,u.validateFields([W].flat(1));case 4:return f=u.getFieldValue([W].flat(1)),d.next=7,k(f);case 7:d.next=11;break;case 9:return d.next=11,k("");case 11:d.next=16;break;case 13:d.prev=13,d.t0=d.catch(0),console.log(d.t0);case 16:case"end":return d.stop()}},v,null,[[0,13]])})),children:X(L,C)}))]})}),_e=(0,je.G)(qe),et=_e,Pe=t(98082),tt=t(10915),nt=t(28459),at=t(93967),rt=t.n(at),he=t(4942),it=function(i){return(0,he.Z)((0,he.Z)({},i.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:i.colorTextSecondary,fontSize:i.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),"@media (min-width: @screen-md-min)",(0,he.Z)({},"".concat(i.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}))};function ot(a){return(0,Pe.Xj)("LoginForm",function(i){var u=(0,l.Z)((0,l.Z)({},i),{},{componentCls:".".concat(a)});return[it(u)]})}var st=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function lt(a){var i,u=a.logo,T=a.message,g=a.contentStyle,C=a.title,B=a.subTitle,R=a.actions,D=a.children,L=a.containerStyle,A=a.otherStyle,p=(0,ve.Z)(a,st),H=(0,tt.YB)(),V=p.submitter===!1?!1:(0,l.Z)((0,l.Z)({searchConfig:{submitText:H.getMessage("loginForm.submitText","\u767B\u5F55")}},p.submitter),{},{submitButtonProps:(0,l.Z)({size:"large",style:{width:"100%"}},(i=p.submitter)===null||i===void 0?void 0:i.submitButtonProps),render:function(z,K){var k,v=K.pop();if(typeof(p==null||(k=p.submitter)===null||k===void 0?void 0:k.render)=="function"){var f,h;return p==null||(f=p.submitter)===null||f===void 0||(h=f.render)===null||h===void 0?void 0:h.call(f,z,K)}return v}}),E=(0,r.useContext)(nt.ZP.ConfigContext),$=E.getPrefixCls("pro-form-login"),G=ot($),W=G.wrapSSR,y=G.hashId,S=function(z){return"".concat($,"-").concat(z," ").concat(y)},N=(0,r.useMemo)(function(){return u?typeof u=="string"?(0,e.jsx)("img",{src:u}):u:null},[u]);return W((0,e.jsxs)("div",{className:rt()(S("container"),y),style:L,children:[(0,e.jsxs)("div",{className:"".concat(S("top")," ").concat(y).trim(),children:[C||N?(0,e.jsxs)("div",{className:"".concat(S("header")),children:[N?(0,e.jsx)("span",{className:S("logo"),children:N}):null,C?(0,e.jsx)("span",{className:S("title"),children:C}):null]}):null,B?(0,e.jsx)("div",{className:S("desc"),children:B}):null]}),(0,e.jsxs)("div",{className:S("main"),style:(0,l.Z)({width:328},g),children:[(0,e.jsxs)(re.A,(0,l.Z)((0,l.Z)({isKeyPressSubmit:!0},p),{},{submitter:V,children:[T,D]})),R?(0,e.jsx)("div",{className:S("main-other"),style:A,children:R}):null]})]}))}var Fe=t(22270),ut=t(84567),Te=t(20677),ct=["options","fieldProps","proFieldProps","valueEnum"],dt=r.forwardRef(function(a,i){var u=a.options,T=a.fieldProps,g=a.proFieldProps,C=a.valueEnum,B=(0,ve.Z)(a,ct);return(0,e.jsx)(Te.Z,(0,l.Z)({ref:i,valueType:"checkbox",valueEnum:(0,Fe.h)(C,void 0),fieldProps:(0,l.Z)({options:u},T),lightProps:(0,l.Z)({labelFormatter:function(){return(0,e.jsx)(Te.Z,(0,l.Z)({ref:i,valueType:"checkbox",mode:"read",valueEnum:(0,Fe.h)(C,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,l.Z)({options:u},T),proFieldProps:g},B))}},B.lightProps),proFieldProps:g},B))}),vt=r.forwardRef(function(a,i){var u=a.fieldProps,T=a.children;return(0,e.jsx)(ut.Z,(0,l.Z)((0,l.Z)({ref:i},u),{},{children:T}))}),ft=(0,je.G)(vt,{valuePropName:"checked"}),Be=ft;Be.Group=dt;var ht=Be,oe=t(7837),mt=t(9361),gt=t(10397),pt=t(48096),Ie=t(73935),J={container:"container___ldtvs",lang:"lang___qrAB8",content:"content___wB3e_","ant-pro-form-login-container":"ant-pro-form-login-container___Z1bnX",icon:"icon___CBYA8"},St=function(){return(0,e.jsx)(xt,{})},xt=function(){var i,u,T=(0,oe.useModel)("@@initialState"),g=T.initialState,C=T.setInitialState,B=(0,r.useState)(0),R=F()(B,2),D=R[0],L=R[1],A=(0,r.useState)(0),p=F()(A,2),H=p[0],V=p[1],E=(0,r.useState)(!1),$=F()(E,2),G=$[0],W=$[1],y=(0,r.useState)(!1),S=F()(y,2),N=S[0],X=S[1],z=(0,oe.useSearchParams)(),K=F()(z,1),k=K[0],v=(0,r.useContext)(Oe.DN),f=v.clientId,h=v.messageData,d=v.bind,Z=(0,r.useState)(),O=F()(Z,2),n=O[0],I=O[1],Ae=(0,r.useState)(),x=F()(Ae,2),q=x[0],Re=x[1];(0,r.useEffect)(function(){(0,Ue.A)().then(function(o){I(o),Re(o==null?void 0:o.loginTypeDefault)})},[]);var De=function(s){localStorage.setItem(ne.lH,s.access_token),d==null||d(),C(function(m){return w()(w()({},m),{},{currentUser:s.userinfo,settings:w()(w()({},m==null?void 0:m.settings),s.setting)})}).then(function(){var m,U="/",c="/";if(s.userinfo.redirect)c=s.userinfo.redirect;else if(g!=null&&(m=g.settings)!==null&&m!==void 0&&m.baseurl){var b;c=U.replace(g==null||(b=g.settings)===null||b===void 0?void 0:b.baseurl,"/")}oe.history.push(c)})};(0,r.useEffect)(function(){if(h){var o=h.data;(o==null?void 0:o.action)=="login"&&(localStorage.setItem("Sa-Remember","1"),ae.yw.success({content:o.msg,duration:1,onClose:function(){(0,Ie.flushSync)(function(){De(o)})}}))}},[h]);var Ct=function(){var o=te()(M()().mark(function s(m){return M()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ne.ZP.post("login",{data:w()(w()({},m),{},{loginType:q}),duration:1,then:function(j){var Y=j.code,Q=j.msg,_=j.data;j.code?(ae.t6.error({description:Q,message:"\u63D0\u793A"}),q=="phone"&&j.code==3&&V(D+1),G&&L(D+1),(j.code==3||j.code==2)&&W(!0)):(m.autoLogin?localStorage.setItem("Sa-Remember","1"):localStorage.setItem("Sa-Remember","0"),ae.yw.success({content:Q,duration:1,onClose:function(){(0,Ie.flushSync)(function(){De(j.data)})}}))}});case 2:return c.abrupt("return");case 3:case"end":return c.stop()}},s)}));return function(m){return o.apply(this,arguments)}}(),se={};n!=null&&n.loginBgImgage&&(se.backgroundImage='url("'+n.loginBgImgage+'")');var be=(0,r.useRef)(),Zt=[{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"phone",children:q!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(de.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(ye.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"},{pattern:/^1\d{10}$/,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"}]}),(0,e.jsx)(re.A.Item,{name:"captchaPhone",rules:[{required:!0,message:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ce,{reload:H,placeholder:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"})}),(0,e.jsx)(Xe.Z,{name:["captchaPhone"],children:function(s){var m=s.captchaPhone;return(0,e.jsx)(et,{fieldProps:{size:"large",prefix:(0,e.jsx)(Ce.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(c,b){return c?"".concat(b," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"mobilecode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"}],onGetCaptcha:function(){var U=te()(M()().mark(function c(b){var j,Y,Q,_;return M()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,P.next=3,(j=be.current)===null||j===void 0?void 0:j.validateFields(["captcha"]);case 3:P.next=8;break;case 5:throw P.prev=5,P.t0=P.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return P.next=10,ne.ZP.post("sms",{data:{mobile:b,captcha:m}});case 10:if(Y=P.sent,Q=Y.code,_=Y.msg,!Q){P.next=15;break}throw new Error(_);case 15:case"end":return P.stop()}},c,null,[[0,5]])}));return function(c){return U.apply(this,arguments)}}()})}}),G&&(0,e.jsx)(re.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ce,{reload:D})})]})},{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"password",children:q!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(de.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(ye.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]}),(0,e.jsx)(de.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(Ce.Z,{className:J.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),G&&(0,e.jsx)(re.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(ce,{reload:D})})]})}],jt=mt.Z.useToken(),Pt=jt.token,Ft={marginInlineStart:"16px",color:(0,Pe.uK)(Pt.colorTextBase,.2),fontSize:"24px",verticalAlign:"middle",cursor:"pointer"},Tt=function(s){var m=s.type,U=(0,r.useState)(Date.now()),c=F()(U,2),b=c[0],j=c[1],Y=(0,r.useState)("active"),Q=F()(Y,2),_=Q[0],le=Q[1],P=3*60,ue,Le=function Ne(ee){var Dt=Date.now();Dt>ee+P*1e3?le("expired"):ue=setTimeout(function(){return Ne(ee)},1e3)},Bt=function(){var ee=Date.now();j(ee),le("active"),ue=setTimeout(function(){return Le(ee)},1e3)};if((0,r.useEffect)(function(){return ue=setTimeout(function(){return Le(b)},1e3),function(){return clearTimeout(ue)}},[]),m=="wechat"){var Ee=n==null?void 0:n.loginWechat,It=Ee.url,At=Ee.desc,Rt=It+"?client_id="+f+"&timestamp="+b;return(0,e.jsxs)("div",{style:{textAlign:"center"},children:[(0,e.jsx)(gt.Z,{style:{margin:"0 auto"},value:Rt,status:_,onRefresh:Bt}),(0,e.jsx)("div",{style:{marginTop:20},children:At})]})}return null};return n?(0,e.jsxs)("div",{className:J.container,style:w()({},se),children:[(0,e.jsx)(oe.Helmet,{children:(0,e.jsxs)("title",{children:["\u767B\u5F55 - ",n==null?void 0:n.title]})}),(0,e.jsx)("div",{className:J.content,style:se.backgroundImage?{}:{padding:0},children:(0,e.jsx)(Ve.ZP,{style:{margin:"0px auto",padding:"20px 0",background:se.backgroundImage?"#fff":"none"},children:(0,e.jsxs)(lt,{contentStyle:{minWidth:280,maxWidth:"75vw"},containerStyle:{paddingInline:0},formRef:be,logo:n==null?void 0:n.logo,title:n==null?void 0:n.title,subTitle:n!=null&&n.subtitle?(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:n==null?void 0:n.subtitle}}):null,initialValues:{autoLogin:!0},onFinish:function(){var o=te()(M()().mark(function s(m){return M()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Ct(m);case 2:case"end":return c.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),actions:n!=null&&n.loginActions?(0,e.jsxs)(pe.Z,{children:["\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F",(0,e.jsx)(Ke.Z,{trigger:(0,e.jsx)(Qe.Z,{style:Ft}),width:350,title:"\u626B\u7801\u767B\u5F55",children:n==null||(i=n.loginActions)===null||i===void 0?void 0:i.map(function(o,s){return(0,e.jsx)(Tt,{type:o},s)})})]}):null,children:[(0,e.jsx)(pt.Z,{centered:!0,activeKey:q,onChange:function(s){Re(s),X(s=="phone")},items:(u=n.loginType)===null||u===void 0?void 0:u.map(function(o){return Zt.find(function(s){return s.key==o})})}),N?null:(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(ht,{noStyle:!0,name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){ae.yw.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:"\u5FD8\u8BB0\u5BC6\u7801"})]})]})})}),(0,e.jsx)(He.Z,{})]}):null},yt=St}}]);
